/*! For license information please see chunkoffice1js.js.LICENSE.txt */
"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([["chunkoffice1js"],{52891:(e,t,n)=>{n.d(t,{b:()=>s});var o=n(79490),r=n(33467),i=n(23379),a=n(77909),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"altText",{get:function(){return this.getValue(t.altTextProperty)},set:function(e){this.setValue(t.altTextProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getEffectiveTooltip=function(){var t=e.prototype.getEffectiveTooltip.call(this);return t?"".concat(t,"\n").concat(this.url):this.url},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,r.iV.PropertyCantBeNull,i.D.errors.propertyMustBeSet("url")),this.altText||t.addFailure(this,r.iV.PropertyCantBeNull,i.D.errors.propertyMustBeSet("altText"))},t.urlProperty=new a.XB(a.uq.v1_5,"url").setContentType("imageUrl"),t.altTextProperty=new a.XB(a.uq.v1_5,"altText").setContentType("text"),t.JsonTypeName="Action.InsertImage",t}(n(74842).rc)},93609:(e,t,n)=>{n.d(t,{c:()=>a,n:()=>s});var o=n(79490),r=n(33467),i=n(77909),a=function(e){function t(t,n,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.call(this,t,n,void 0)||this;return i.targetVersion=t,i.name=n,i.forbiddenActionTypes=o,i.allowedActionTypes=r,i}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=e;return n.parseAction(o,t[this.name],this.forbiddenActionTypes,o.isDesignMode())},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,n?n.toJSON(o):void 0,void 0,!0)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"object",validValues:e.actionRegistry.getDescriptors(e,this.forbiddenActionTypes,this.allowedActionTypes).sort((function(e,t){return e.name.localeCompare(t.name)}))}],isArray:!1}},t}(i.BG),s=function(e){function t(t,n,o){void 0===o&&(o=[]);var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r.forbiddenActionTypes=o,r}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var i,a,s=e,l=t[this.name];if(void 0!==l&&Array.isArray(l)){var c=[];if(Array.isArray(l))try{for(var u=(0,o.__values)(l),d=u.next();!d.done;d=u.next()){var p=d.value,h=n.parseAction(s,p,this.forbiddenActionTypes,s.isDesignMode());h?c.push(h):n.logParseEvent(e,r.iV.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(p),'" of type Action, hence ignored.'))}}catch(e){i={error:e}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}return c}},t.prototype.toJSON=function(e,t,n,r){var i,a;if(n)try{for(var s=(0,o.__values)(n),l=s.next();!l.done;l=s.next()){var c=l.value;r.serializeValue(t,this.name,c?c.toJSON(r):void 0,void 0,!0)}}catch(e){i={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(i)throw i.error}}},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"object",validValues:e.actionRegistry.getDescriptors(e,this.forbiddenActionTypes).sort((function(e,t){return e.name.localeCompare(t.name)}))}],isArray:!0}},t}(i.BG)},23489:(e,t,n)=>{n.d(t,{e:()=>i});var o=n(79490),r=n(77909),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"verb",{get:function(){return this.getValue(t.verbProperty)},set:function(e){this.setValue(t.verbProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Execute",t.verbProperty=new r.XB(r.uq.v1_4,"verb"),t}(n(42228)._Z)},70512:(e,t,n)=>{n.d(t,{o:()=>s});var o=n(79490),r=n(33467),i=n(23379),a=n(77909),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getEffectiveTooltip=function(){var t=e.prototype.getEffectiveTooltip.call(this);return t?"".concat(t,"\n").concat(this.getHref()):this.getHref()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.getAriaRole=function(){return"link"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,r.iV.PropertyCantBeNull,i.D.errors.propertyMustBeSet("url"))},t.prototype.getHref=function(){return this.url},t.urlProperty=new a.XB(a.uq.v1_0,"url").setContentType("link"),t.JsonTypeName="Action.OpenUrl",t}(n(74842).rc)},42228:(e,t,n)=>{n.d(t,{_Z:()=>s,tV:()=>u});var o=n(79490),r=n(95312),i=n(77909),a=n(74842),s=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._isPrepared=!1,t._areReferencedInputsDirty=!1,t}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"_originalData",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"associatedInputs",{get:function(){return this.getValue(t.associatedInputsProperty)},set:function(e){this.setValue(t.associatedInputsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"conditionallyEnabled",{get:function(){return this.getValue(t.conditionallyEnabledProperty)},set:function(e){this.setValue(t.conditionallyEnabledProperty,e)},enumerable:!1,configurable:!0}),t.prototype.updateReferencedInputsDirtyState=function(){var e,t;this._areReferencedInputsDirty=!1;var n=this.getReferencedInputs();if(n)try{for(var r=(0,o.__values)(Object.keys(n)),i=r.next();!i.done;i=r.next()){if(n[i.value].isDirty()){this._areReferencedInputsDirty=!0;break}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.internalGetReferencedInputs=function(){var e,t,n={};if("none"!==this.associatedInputs){for(var r=this.parent,i=[];r;)i.push.apply(i,(0,o.__spreadArray)([],(0,o.__read)(r.getAllInputs(!1)),!1)),r=r.parent;try{for(var a=(0,o.__values)(i),s=a.next();!s.done;s=a.next()){var l=s.value;l.id&&(n[l.id]=l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}return n},t.prototype.internalPrepareForExecution=function(e){var t,n;if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&"object"==typeof this._processedData&&e)try{for(var r=(0,o.__values)(Object.keys(e)),i=r.next();!i.done;i=r.next()){var a=e[i.value];a.id&&a.isSet()&&(this._processedData[a.id]=a.valueAsString)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}this._isPrepared=!0},t.prototype.internalAfterExecute=function(){r.h$.resetInputsDirtyStateAfterActionExecution&&this.resetReferencedInputsDirtyState()},t.prototype.resetReferencedInputsDirtyState=function(){var e,t,n=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,n)try{for(var r=(0,o.__values)(Object.keys(n)),i=r.next();!i.done;i=r.next()){n[i.value].resetDirtyState()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.updateEnabledState=function(){var e,t,n=this._areReferencedInputsDirty;this.updateReferencedInputsDirtyState();var r=this.getReferencedInputs();if(r)try{for(var i=(0,o.__values)(Object.keys(r)),a=i.next();!a.done;a=i.next()){if(r[a.value].isDirty()){this._areReferencedInputsDirty=!0;break}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}this._areReferencedInputsDirty!==n&&this.updateLayout()},t.prototype.isEffectivelyEnabled=function(){var t=e.prototype.isEffectivelyEnabled.call(this);return this.updateReferencedInputsDirtyState(),this.conditionallyEnabled?t&&this._areReferencedInputsDirty:t},Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new i.BG(i.uq.v1_0,"data"),t.associatedInputsProperty=new a.XC(i.uq.v1_3,"associatedInputs"),t.conditionallyEnabledProperty=new i.gV(i.uq.v1_5,"conditionallyEnabled",!1),t}(a.rc),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"hide",{get:function(){return this.getValue(t.hideProperty)},set:function(e){this.setValue(t.hideProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"TeamsSubmitActionFeedback"},t.hideProperty=new i.gV(i.uq.v1_0,"hide"),t}(i.jB),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"feedback",{get:function(){return this.getValue(t.feedbackProperty)},set:function(e){this.setValue(t.feedbackProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"TeamsSubmitActionProperties"},t.feedbackProperty=new i.kR(i.uq.v1_0,"feedback",(function(e){return new l})),t}(i.jB),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Submit",t.msTeamsProperty=new i.kR(i.uq.v1_0,"msTeams",(function(e){return new c})),t}(s)},80832:(e,t,n)=>{n.d(t,{L:()=>h});var o=n(79490),r=n(8520),i=n(23379),a=n(74842),s=function(e){function t(t){var n=e.call(this)||this;return n._actions=t,n.title=n.localizeString(i.D.overflowButtonText),n.tooltip=n.localizeString(i.D.overflowButtonTooltip),n}return(0,o.__extends)(t,e),t.prototype.shouldDisplayBuiltInOverflowActionMenu=function(){return!this.onShouldDisplayBuiltInOverflowActionMenu||this.onShouldDisplayBuiltInOverflowActionMenu(this)},t.prototype.displayOverflowActionMenu=function(e){this.onDisplayOverflowActionMenu&&this.onDisplayOverflowActionMenu(this,e)},t.prototype.getButtonMenuItems=function(){if(this.shouldDisplayBuiltInOverflowActionMenu()){var e=[];return this._actions.forEach((function(t,n){"click"===t.applicationMode&&e.push(t.asMenuItem(n.toString()))})),e.length>0?e:void 0}},t.prototype.getActions=function(){return this._actions},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(this._actions),!1)),t},t.prototype.getJsonTypeName=function(){return"Internal_Action.Overflow"},t.prototype.execute=function(){this.shouldDisplayBuiltInOverflowActionMenu()||this.displayOverflowActionMenu(this.domElement)},t.prototype.setupElementForAccessibility=function(t,n){void 0===n&&(n=!1),e.prototype.setupElementForAccessibility.call(this,t,n),t["aria-label"]=this.localizeString(i.D.overflowButtonTooltip)},t.JsonTypeName="Action.Overflow",t}(a.rc),l=function(e){function t(t){var n=e.call(this)||this;return n._overflowActions=t.menuActions?t.menuActions:[],n.title=t.title,n.tooltip=t.tooltip,n.style=t.style,n.iconUrl=t.iconUrl,n.isEnabled=t.isEnabled,n.setParent(t.parent),n.themedIconUrls=t.themedIconUrls,n._primaryAction=t,n}return(0,o.__extends)(t,e),t.prototype.getJsonTypeName=function(){return"Internal_Action.primaryOverflowSplit"},t.prototype.getButtonMenuItems=function(){return this._overflowActions&&this._overflowActions.length>0?this._overflowActions.map((function(e,t){return e.asMenuItem(t.toString())})):void 0},t.prototype.getFlattenedActionsList=function(){return this._overflowActions?(0,o.__spreadArray)([this._primaryAction],(0,o.__read)(this._overflowActions),!1):[this._primaryAction]},t.prototype.setupElementForAccessibility=function(t,n){void 0===n&&(n=!1),e.prototype.setupElementForAccessibility.call(this,t,n),t.isSplitButton=!0},t.prototype.execute=function(e){e?this._primaryAction.execute(e):this._primaryAction.execute()},t}(a.rc),c=n(33467),u=n(77909),d=n(95312),p=n(11512),h=function(){function e(e){this._items=[],this._renderedActions=[],this._owner=e}return e.getActionsPropertyDescriptor=function(e,t){return{name:"actions",valueTypes:[{type:"object",validValues:e.actionRegistry.getDescriptors(e).sort((function(e,t){return e.name.localeCompare(t.name)}))}],isArray:!0,declaringClassName:t,schemaVersion:u.uq.v1_0,suggestedSchemaTypeName:"ActionArray"}},e.prototype.renderInlineAdaptiveCard=function(e,t){return t?r.createElement(e.Render,null):r.createElement("div",{style:{marginTop:"".concat(this._owner.hostConfig.actions.showCard.inlineTopMargin,"px")},key:e.key},r.createElement(e.Render,null))},e.prototype.updateLayout=function(){this._owner.getRootObject().updateLayout()},e.prototype.collapseExpandedAction=function(){var e,t,n,r;try{for(var i=(0,o.__values)(this._renderedActions),a=i.next();!a.done;a=i.next()){var l=a.value;if(l instanceof s)try{for(var u=(n=void 0,(0,o.__values)(l.getActions())),d=u.next();!d.done;d=u.next()){d.value.state=c.kj.Normal}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}l.state=c.kj.Normal}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}var p=this._expandedAction;this._expandedAction=void 0,p&&(p.collapse(),this.updateLayout())},e.prototype.shouldDisplayBuiltInOverflowActionButton=function(e){return!this.onShouldDisplayBuiltInOverflowActionButton||this.onShouldDisplayBuiltInOverflowActionButton(e)},e.prototype.shouldDisplayBuiltInOverflowActionMenu=function(e){return!this.onShouldDisplayBuiltInOverflowActionMenu||this.onShouldDisplayBuiltInOverflowActionMenu(e)},e.prototype.displayOverflowActionMenu=function(e,t){this.onDisplayOverflowActionMenu&&this.onDisplayOverflowActionMenu(e,t)},e.prototype.releaseDOMResources=function(){var e,t;try{for(var n=(0,o.__values)(this._renderedActions),r=n.next();!r.done;r=n.next()){r.value.releaseDOMResources()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},e.prototype.actionExecuted=function(e){var t,n,r,i;if(e.isExpandable){if(e===this._expandedAction)this.collapseExpandedAction();else if(this._owner.hostConfig.actions.showCard.actionMode===c.l1.Inline){try{for(var a=(0,o.__values)(this._renderedActions),l=a.next();!l.done;l=a.next()){var u=l.value;if(u instanceof s)try{for(var d=(r=void 0,(0,o.__values)(u.getActions())),p=d.next();!p.done;p=d.next()){var h=p.value;h.state=h!==e?c.kj.Subdued:c.kj.Expanded}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}else u.state=u!==e?c.kj.Subdued:c.kj.Expanded}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}this._expandedAction=e,e.expand(!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),!0)}}else this.collapseExpandedAction();this.updateLayout()},e.prototype.parse=function(e,t){var n,r;if(this.clear(),Array.isArray(e))try{for(var i=(0,o.__values)(e),a=i.next();!a.done;a=i.next()){var s=a.value,l=t.parseAction(this._owner,s,[],!0);l&&this.addAction(l)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this._items)},e.prototype.getActionAt=function(e){return this._items[e]},e.prototype.getActionCount=function(){return this._items.length},e.prototype.getActionById=function(e){var t,n,r;try{for(var i=(0,o.__values)(this._items),a=i.next();!a.done;a=i.next()){if(r=a.value.getActionById(e))break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.getElementById=function(e){var t,n,r;try{for(var i=(0,o.__values)(this._items),a=i.next();!a.done;a=i.next()){if(r=a.value.getElementById(e))break}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.validateProperties=function(e){var t,n;this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,c.iV.TooManyActions,i.D.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,c.iV.InteractivityNotAllowed,i.D.errors.interactivityNotAllowed());try{for(var r=(0,o.__values)(this._items),a=r.next();!a.done;a=r.next()){a.value.internalValidateProperties(e)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.render=function(e){var t,n,i=this,a=this._owner.hostConfig;if(!a.supportsInteractivity)return null;var u=a.actions.maxActions?Math.min(a.actions.maxActions,this._items.length):this._items.length;this._renderedActions=[];var h=[],g=1===u?this._items[0].getInlineContent():void 0;if(a.actions.preExpandSingleShowCardAction&&g)this._renderedActions.push(this._items[0]),h.push(this.renderInlineAdaptiveCard(g,!0));else{var f=(0,p.xg)();if(f.className=a.makeCssClassName("ac-actionSet"),f.style.display="flex",f.style.gap=a.actions.buttonSpacing,e===c.t4.Horizontal)if(f.style.flexDirection="row",a.actions.allowButtonsToWrap&&(f.style.flexWrap="wrap"),this._owner.horizontalAlignment&&a.actions.actionAlignment!==c.i.Stretch)switch(this._owner.horizontalAlignment){case c.OD.Center:f.style.justifyContent="center";break;case c.OD.Right:f.style.justifyContent="flex-end";break;default:f.style.justifyContent="flex-start"}else switch(a.actions.actionAlignment){case c.i.Center:f.style.justifyContent="center";break;case c.i.Right:f.style.justifyContent="flex-end";break;default:f.style.justifyContent="flex-start"}else if(f.style.flexDirection="column",this._owner.horizontalAlignment&&a.actions.actionAlignment!==c.i.Stretch)switch(this._owner.horizontalAlignment){case c.OD.Center:f.style.alignItems="center";break;case c.OD.Right:f.style.alignItems="flex-end";break;default:f.style.alignItems="flex-start"}else switch(a.actions.actionAlignment){case c.i.Center:f.style.alignItems="center";break;case c.i.Right:f.style.alignItems="flex-end";break;case c.i.Stretch:f.style.alignItems="stretch";break;default:f.style.alignItems="flex-start"}var m=[],y=[];if(this._owner.isDesignMode())m.push.apply(m,(0,o.__spreadArray)([],(0,o.__read)(this._items),!1));else{this._items.forEach((function(e){e.menuActions&&"wrap"!==e.applicationMode?m.push(new l(e)):e.mode===c.yG.Secondary?y.push(e):m.push(e)}));var v=m.splice(a.actions.maxActions);d.h$.allowMoreThanMaxActionsInOverflowMenu&&v.forEach((function(e){e instanceof l?y.push.apply(y,(0,o.__spreadArray)([],(0,o.__read)(e.getFlattenedActionsList()),!1)):y.push(e)}));var C=!0;y.length>0&&(this._overflowAction||(this._overflowAction=new s(y),this._overflowAction.onShouldDisplayBuiltInOverflowActionMenu=function(e){return i.shouldDisplayBuiltInOverflowActionMenu(e)},this._overflowAction.onDisplayOverflowActionMenu=function(e,t){i.displayOverflowActionMenu(e,t)},this._overflowAction.setParent(this._owner)),C=this.shouldDisplayBuiltInOverflowActionButton(this._overflowAction)),this._overflowAction&&C&&m.push(this._overflowAction)}var b=m.map((function(e){var t=r.createElement(e.Render,{key:e.key});if(t)return i._renderedActions.push(e),t})).filter((function(e){return void 0!==e}));b.length>0&&h.push(r.createElement("div",{style:{overflow:"hidden"},key:"buttonStripContainer"},r.createElement("div",f,b)))}try{for(var E=(0,o.__values)(this._renderedActions),A=E.next();!A.done;A=E.next()){var S=A.value;if(S instanceof s){var I=S.getActions().find((function(e){return e.state===c.kj.Expanded})),P=null==I?void 0:I.getInlineContent();P&&h.push(this.renderInlineAdaptiveCard(P,!1));break}if(S.state===c.kj.Expanded){var T=S.getInlineContent();T&&h.push(this.renderInlineAdaptiveCard(T,!1));break}}}catch(e){t={error:e}}finally{try{A&&!A.done&&(n=E.return)&&n.call(E)}finally{if(t)throw t.error}}return h.length>0?r.createElement(r.Fragment,null,h):null},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this._items.indexOf(e)<0))throw new Error(i.D.errors.actionAlreadyParented());this._items.push(e),e._owner=this,e.parent||e.setParent(this._owner)},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction===e&&this.collapseExpandedAction();var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1),e.setParent(void 0);for(var n=0;n<this._renderedActions.length;n++)if(this._renderedActions[n]===e){this._renderedActions.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this._items=[],this._renderedActions=[],this._expandedAction=void 0},e.prototype.getAllInputs=function(e){var t,n;void 0===e&&(e=!0);var r=[];if(e)try{for(var i=(0,o.__values)(this._items),a=i.next();!a.done;a=i.next()){var s=a.value;r.push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(s.getAllInputs()),!1))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.getResourceInformation=function(){var e,t,n=[];try{for(var r=(0,o.__values)(this._items),i=r.next();!i.done;i=r.next()){var a=i.value;n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(a.getResourceInformation()),!1))}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e.prototype.hasResponsiveElements=function(){var e,t;try{for(var n=(0,o.__values)(this._items),r=n.next();!r.done;r=n.next()){if(r.value.hasResponsiveElements())return!0}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActions.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}()},74842:(e,t,n)=>{n.d(t,{rc:()=>I,On:()=>x,XC:()=>A,hA:()=>E,lX:()=>T,v7:()=>w,Au:()=>P,n7:()=>b,x$:()=>m,JM:()=>C});var o=n(79490),r=n(8520),i=n(93609),a=n(47328),s=n(33467),l=n(49399),c=n(25142),u=n(57014),d=n(77909),p=n(95312),h=n(23379),g=n(11512),f=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:s.Fg.Validation,source:e,event:t,message:n})},e}(),m=function(e){function t(t,n){void 0===t&&(t=s.V6.Light);var o=e.call(this)||this;return o.theme=t,o.url=n,o}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"theme",{get:function(){return this.getValue(t.themeProperty)},set:function(e){this.setValue(t.themeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"ThemedUrl"},t.themeProperty=new d.fX(d.uq.v1_5,"theme",s.V6,s.V6.Light),t.urlProperty=new d.XB(d.uq.v1_5,"url").setContentType("imageUrl"),t}(d.jB),y=function(e){function t(t,n){var o=e.call(this,t,n,(function(e){return new c.B}),!1,new c.B)||this;return o.targetVersion=t,o.name=n,o.allowAdditionalProperties=!0,o}return(0,o.__extends)(t,e),t}(d.kR),v=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._disableAutomaticReRenderCount=0,t.Render=function(e){return t._state=r.useState(0),r.useEffect((function(){return t.mounted(),function(){t._state=void 0,t.unmounted()}}),[]),t.render(e.args)},t}return(0,o.__extends)(t,e),t.prototype.invalidate=function(){this._state&&this._state[1]((function(e){return e+1}))},t.prototype.afterParse=function(){e.prototype.afterParse.call(this),this.invalidate()},t.prototype.propertyChanged=function(t,n){e.prototype.propertyChanged.call(this,t,n),0===this._disableAutomaticReRenderCount&&this.invalidate()},t.prototype.mounted=function(){this.onMounted&&this.onMounted(this)},t.prototype.unmounted=function(){},t.prototype.renderedElementChanged=function(e,t){this.onRenderedElementChanged&&this.onRenderedElementChanged(e,t)},t.prototype.updateLayout=function(t){void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),this.invalidate()},t.prototype.disableAutomaticReRender=function(){this._disableAutomaticReRenderCount++},t.prototype.enableAutomaticReRender=function(){this._disableAutomaticReRenderCount>0&&this._disableAutomaticReRenderCount--},Object.defineProperty(t.prototype,"hasBeenRendered",{get:function(){return void 0!==this._state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){},enumerable:!1,configurable:!0}),t}(function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._shouldFallback=!1,t._openPopoverCount=0,t}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.actionExecuted=function(e){},t.prototype.getDefaultSerializationContext=function(){return new P},t.prototype.mediaPlaybackStarted=function(e){this.onMediaPlaybackStarted?this.onMediaPlaybackStarted(e):this.parent&&this.parent.mediaPlaybackStarted(e)},t.prototype.getAdditionalValidSchemaProperties=function(){return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalValidSchemaProperties.call(this)),!1),["fallback"],!1)},t.prototype.getSerializationContext=function(){var e;return null!==(e=this._serializationContext)&&void 0!==e?e:this.getDefaultSerializationContext()},t.prototype.setSerializationContext=function(e){this._serializationContext=e},t.prototype.localizeString=function(e,t){var n;return this.onLocalizeString?n=this.onLocalizeString(e.key,t):this.parent&&(n=this.parent.localizeString(e,t)),void 0===n?(0,g.zl)(e.defaultValue,t):n},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(p.h$.allowPreProcessingPropertyValues){for(var o=this;o&&!o.onPreProcessPropertyValue;)o=o.parent;if(o&&o.onPreProcessPropertyValue)return o.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.hasAsParent=function(e){for(var t=this.parent;t;){if(t===e)return!0;t=t.parent}return!1},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,s.iV.DuplicateId,h.D.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.isAtTheVeryLeft=function(){return!1},t.prototype.isAtTheVeryRight=function(){return!1},t.prototype.isAtTheVeryTop=function(){return!1},t.prototype.isAtTheVeryBottom=function(){return!1},t.prototype.isDesignMode=function(){return this.hostConfig.designMode},t.prototype.validateProperties=function(){var e=new f;return this.internalValidateProperties(e),e},t.prototype.releaseDOMResources=function(){},t.prototype.updateActionsEnabledState=function(){},t.prototype.updateLayout=function(e){void 0===e&&(e=!1)},t.prototype.renderAnchor=function(e,t){return this.parent?this.parent.renderAnchor(e,t):function(e,t){return r.createElement("a",t,null!=e?e:t.href)}(e,t)},t.prototype.renderImage=function(e,t){return this.parent?this.parent.renderImage(e,t):function(e,t){return r.createElement("img",(0,o.__assign)({},t))}(0,t)},t.prototype.formatDate=function(e){return this.parent?this.parent.formatDate(e):e.toLocaleDateString(void 0,{dateStyle:"long"})},t.prototype.processUrl=function(e){return!!this.parent&&this.parent.processUrl(e)},t.prototype.dataQuery=function(e){return!!this.parent&&this.parent.dataQuery(e)},t.prototype.popoverOpened=function(){this._openPopoverCount++,this.parent&&this.parent.popoverOpened()},t.prototype.popoverClosed=function(){this._openPopoverCount>0&&(this._openPopoverCount--,0===this._openPopoverCount&&this.getRootObject().updateLayout()),this.parent&&this.parent.popoverClosed()},Object.defineProperty(t.prototype,"groupId",{get:function(){return this._groupId?this._groupId:this.parent?this.parent.groupId:void 0},set:function(e){this._groupId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInSubCard",{get:function(){return!!this.parent&&this.parent.isInSubCard},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.prototype.getSize=function(){},t.idProperty=new d.XB(d.uq.v1_0,"id"),t.requiresProperty=new y(d.uq.v1_2,"requires"),t}(d.bU));function C(e,t,n,i,a){if(t.spacing>0||void 0!==t.lineThickness&&t.lineThickness>0){var l=(0,g.xg)();l.className=e.makeCssClassName("ac-".concat(n===s.t4.Horizontal?"horizontal":"vertical","-separator")),l["aria-hidden"]=!0,l.style.overflow="hidden",l.style.flex="0 0 auto";var c=t.lineColor?(0,g.zS)(t.lineColor):"";return n===s.t4.Horizontal?(t.lineThickness?(l.style.paddingTop="".concat(t.spacing/2,"px"),l.style.marginBottom="".concat(t.spacing/2,"px"),l.style.borderBottom="".concat(t.lineThickness,"px solid ").concat(c)):l.style.height="".concat(t.spacing,"px"),l.style.marginLeft=i.margin.left,l.style.marginRight=i.margin.right):t.lineThickness?(l.style.paddingLeft="".concat(t.spacing/2,"px"),l.style.marginRight="".concat(t.spacing/2,"px"),l.style.borderRight="".concat(t.lineThickness,"px solid ").concat(c)):l.style.width="".concat(t.spacing,"px"),r.createElement("div",(0,o.__assign)({},l,{ref:a}))}return null}var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name];return"string"==typeof o?p.gH.parse(o):this.defaultValue},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,n?n.toString():void 0,void 0,!0)},t.prototype.getDescriptor=function(e){var t=(0,a.a)(s.RK),n=(0,o.__spreadArray)([],(0,o.__read)(t),!1);return t.forEach((function(e){n.push("atLeast:".concat(e),"atMost:".concat(e))})),{valueTypes:[{type:"string",validValues:n}],defaultValue:void 0!==this.defaultValue?s.RK[this.defaultValue]:void 0,isArray:!1}},t}(d.BG),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this.getValue(t.horizontalAlignmentProperty)},set:function(e){this.setValue(t.horizontalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"spacing",{get:function(){return this.getValue(t.spacingProperty)},set:function(e){this.setValue(t.spacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this.getValue(t.separatorProperty)},set:function(e){this.setValue(t.separatorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.getValue(t.heightProperty)},set:function(e){this.setValue(t.heightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){if(this.isVisible!==e){this.disableAutomaticReRender();try{this.setValue(t.isVisibleProperty,e)}finally{this.enableAutomaticReRender()}0===this._openPopoverCount&&this.getRootElement().updateLayout(),this.elementVisibilityChanged(this)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetWidth",{get:function(){return this.getValue(t.targetWidthProperty)},set:function(e){this.setValue(t.targetWidthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.createPlaceholderElement=function(e){var t=this.getEffectiveStyleDefinition(),n=(0,g.zS)(t.foregroundColors.default.subtle),o=null!=e?e:this.localizeString(h.D.emptyElementText,{elementType:this.getJsonTypeName()});return r.createElement("div",{style:{border:"1px dashed "+n,padding:"4px",minHeight:"32px",fontSize:"10px",color:n}},o)},t.prototype.providesDesignModeElement=function(){return!1},t.prototype.getSeparatorColor=function(e){if(this.separator){var t=null!=e?e:this.getEffectiveStyleDefinition(),n=p.h$.useBorderColorForSeparator?t.borderColor:void 0;return null!=n?n:this.hostConfig.separator.lineColor}},t.prototype.getAttachableProperties=function(t){return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAttachableProperties.call(this,t)),!1),(0,o.__read)(t.getAttachableElementProperties()),!1)},t.prototype.render=function(e){var t,n=this,i=this.isVisible||this.isDesignMode()?this.internalRender(e):null,a=null,s=!this.parent||this.parent.allowSpaceBetweenElements;if(i&&this.hasVisibleSeparator&&s){var l={padding:{},margin:{}};this.getSeparatorSpacings(l),a=C(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.getSeparatorColor()},this.separatorOrientation,l,this.isDesignMode()?function(e){return n._renderedSeparatorElement=null!=e?e:void 0}:void 0)}if(this.isDesignMode()&&this.isStandalone&&!this.providesDesignModeElement()){var c={className:"designer-wrapper",style:{display:"flex",flexDirection:"column"}};return this.adjustSize(c.style),(null===(t=null==i?void 0:i.props)||void 0===t?void 0:t.style)&&this.adjustSize(i.props.style),r.createElement(r.Fragment,null,a,r.createElement("div",(0,o.__assign)({},c,{ref:function(e){return n.renderedElement=null!=e?e:void 0}}),i))}(null==i?void 0:i.props.style)&&this.adjustSize(i.props.style);var u=this.getMainAction();return i&&u&&(i=u.applyTo(i)),r.createElement(r.Fragment,null,a,i)},t.prototype.elementVisibilityChanged=function(e){this.getRootElement().elementVisibilityChanged(e)},t.prototype.adjustSize=function(e){"auto"===this.height?e.flex="0 0 auto":e.flex="1 1 auto"},t.prototype.getSpacings=function(e){},t.prototype.getSeparatorSpacings=function(e){if(this.separatorOrientation===s.t4.Horizontal)if(p.h$.alwaysBleedSeparators&&!this.isBleeding()){var t=new p.pT;this.getImmediateSurroundingPadding(t);var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t);e.margin.left=-n.left,e.margin.right=-n.right}else e.margin.right=0,e.margin.left=0},t.prototype.getDefaultPadding=function(){return new p.pT},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!1},t.prototype.getHasBorder=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},t.prototype.getMainAction=function(){},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return s.t4.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return s.xO.Default},enumerable:!1,configurable:!0}),t.prototype.processMarkdown=function(e){return this.parent?this.parent.processMarkdown(e):{didProcess:!1}},t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getImmediateSurroundingPadding=function(e,t,n,o,r){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===r&&(r=!0),this.parent){var i=t&&this.parent.isTopElement(this),a=n&&this.parent.isRightMostElement(this),l=o&&this.parent.isBottomElement(this),c=r&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(i&&u.top!==s.Kz.None&&(e.top=u.top,i=!1),a&&u.right!==s.Kz.None&&(e.right=u.right,a=!1),l&&u.bottom!==s.Kz.None&&(e.bottom=u.bottom,l=!1),c&&u.left!==s.Kz.None&&(e.left=u.left,c=!1)),(i||a||l||c)&&this.parent.getImmediateSurroundingPadding(e,i,a,l,c)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(h.D.errors.indexOutOfRange(e))},t.prototype.indexOfAction=function(e){for(var t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1},t.prototype.updateActionsEnabledState=function(){var e,t,n=this.getRootElement().getAllActions();try{for(var r=(0,o.__values)(n),i=r.next();!i.done;i=r.next()){i.value.updateEnabledState()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.indexOf=function(e){return-1},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isResponsive=function(){var e,t;return null!==(t=null===(e=this.getMainAction())||void 0===e?void 0:e.hasResponsiveElements())&&void 0!==t&&t||void 0!==this.targetWidth},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getAllActions=function(){for(var e=[],t=0;t<this.getActionCount();t++){var n=this.getActionAt(t);n&&e.push(n)}return e},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e||this.getDefaultPadding()},t.prototype.getEffectiveHorizontalAlignment=function(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():s.OD.Left},t.prototype.focusFirstFocusableElement=function(){var e,t,n,r,i=this.getAllInputs(!0);try{for(var a=(0,o.__values)(i),s=a.next();!s.done;s=a.next()){if(s.value.focus())return!0}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}var l=this.getAllActions();try{for(var c=(0,o.__values)(l),u=c.next();!u.done;u=c.next()){return!!u.value.focus()}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return!1},t.prototype.shouldRender=function(e){return this.isDesignMode()||this._openPopoverCount>0||this.isVisible&&this.shouldRenderForTargetWidth(e)},t.prototype.shouldRenderForTargetWidth=function(e){var t=null!=e?e:this.hostWidth;return void 0===this.targetWidth||this.targetWidth.matches(t)},t.prototype.removeItem=function(e){return!1},t.prototype.remove=function(){return!!this.parent&&this.parent.removeItem(this)},t.prototype.getAdditionalPropertyDescriptors=function(t){var n=t.elementRegistry.getDescriptors(t,[],[],!0);return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"fallback",valueTypes:[{type:"object",validValues:n},{type:"string",validValues:["drop"]}],isArray:!1,declaringClassName:"CardElement",schemaVersion:d.uq.v1_2,suggestedSchemaTypeName:"FallbackElementArray"}],!1)},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowChildContainersToBleed",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostWidth",{get:function(){return void 0!==this._hostWidth?this._hostWidth:this.parent?this.parent.hostWidth:s.RK.Wide},set:function(e){this._hostWidth=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:u._f},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this._theme?this._theme:this.parent?this.parent.theme:s.V6.Light},set:function(e){this._theme=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){var e=this.getValue(t.isEnabledProperty);return void 0!==e?e:!this.parent||this.parent.isEnabled},set:function(e){this.setValue(t.isEnabledProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandableInlineElement",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!this.isInline&&(!!this.parent&&(!this.parent.isFirstElement(this)&&this.shouldRender()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},set:function(e){var t=this._renderedElement;this._renderedElement=e,this.renderedElementChanged(t,this._renderedElement)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedSeparatorElement",{get:function(){return this._renderedSeparatorElement},enumerable:!1,configurable:!0}),t.langProperty=new d.XB(d.uq.v1_1,"lang",/^[a-z]{2,3}$/gi),t.isVisibleProperty=new d.gV(d.uq.v1_2,"isVisible",!0),t.separatorProperty=new d.gV(d.uq.v1_0,"separator",!1),t.heightProperty=new d.XY(d.uq.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new d.fX(d.uq.v1_0,"horizontalAlignment",s.OD),t.spacingProperty=new d.fX(d.uq.v1_0,"spacing",s.Kz,s.Kz.Default),t.targetWidthProperty=new b(d.uq.v1_0,"targetWidth"),t.isEnabledProperty=new d.gV(d.uq.v1_0,"isEnabled").setEnableSerialization(!1),t}(v),A=function(e){function t(t,n){var o=e.call(this,t,n,void 0)||this;return o.targetVersion=t,o.name=n,o}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name];if(void 0!==o&&"string"==typeof o)return"none"===o.toLowerCase()?"none":"auto"},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:["auto","none"]}],isArray:!1}},t}(d.BG);function S(e,t){return void 0!==e?e:t}var I=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._isFocusable=!0,t.state=s.kj.Normal,t}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"themedIconUrls",{get:function(){return this.getValue(t.themedIconUrlsProperty)},set:function(e){this.setValue(t.themedIconUrlsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"menuActions",{get:function(){return this.getValue(t.menuActionsProperty)},set:function(e){this.setValue(t.menuActionsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iconUrl",{get:function(){return this.getValue(t.iconUrlProperty)},set:function(e){this.setValue(t.iconUrlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.getValue(t.modeProperty)},set:function(e){this.setValue(t.modeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tooltip",{get:function(){return this.getValue(t.tooltipProperty)},set:function(e){this.setValue(t.tooltipProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.getValue(t.isEnabledProperty)},set:function(e){this.setValue(t.isEnabledProperty,e)},enumerable:!1,configurable:!0}),t.prototype.renderTitle=function(e){var t;void 0===e&&(e=!1);var n=this._actionButton&&null!==(t=this._actionButton.renderTitle(this.title))&&void 0!==t?t:void 0;if(n)return n;if(this.title){var o=this.hostConfig,i=(0,g.xg)();return i.style.overflow="hidden",i.style.textOverflow="ellipsis",o.actions.iconPlacement===s.dC.AboveTitle||o.actions.allowTitleToWrap||e||(i.style.whiteSpace="nowrap"),r.createElement(r.Fragment,{key:"title"},r.createElement("div",i,this.title))}return null},t.prototype.getEffectiveIconUrl=function(){var e,t;if(this.themedIconUrls)try{for(var n=(0,o.__values)(this.themedIconUrls),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.url&&this.theme===i.theme)return i.url}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return this.iconUrl},t.prototype.renderIcon=function(){var e=null,t=this.getEffectiveIconUrl();if(t){var n=t.match(/^icon:([\w\d_-]+)(?:,(regular|filled)){0,1}$/i);if(n){if(p.h$.enableIconSupportForActionButtons){var o=void 0!==n[2]&&"filled"===n[2].toLowerCase()?s.pO.Filled:s.pO.Regular;e=r.createElement(l.FW,{name:n[1],iconSize:s.lK.xSmall,iconStyle:o,showPlaceholder:!1,allowFallback:!1})}}else{var i=this.hostConfig,a={style:{}};a.src=t,a.style.width="".concat(i.actions.iconSize,"px"),a.style.height="".concat(i.actions.iconSize,"px"),a.style.flex="0 0 auto",i.actions.iconPlacement!==s.dC.AboveTitle&&(a.style.maxHeight="100%"),e=this.renderImage({allowExpand:!1,isSelectable:!1},a)}}return r.createElement(r.Fragment,{key:"icon"},e)},t.prototype.renderButtonContent=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var i,a=this.hostConfig,l=(0,g.xg)();switch(l.className="ac-pushButton-content",l.style.display="flex",l.style.gap="6px",l.style.alignItems="center",t&&(l.style.justifyContent="center"),l.style.minWidth="0",this.iconUrl?e?((0,g.iQ)(l,"iconOnly"),i=[this.renderIcon()]):(a.actions.iconPlacement===s.dC.AboveTitle?((0,g.iQ)(l,"iconAbove"),l.style.flexDirection="column"):(0,g.iQ)(l,"iconLeft"),i=[this.renderIcon(),this.renderTitle(n)]):((0,g.iQ)(l,"noIcon"),i=[this.renderTitle(n)]),a.actions.actionsOrientation===s.t4.Horizontal&&a.actions.actionAlignment===s.i.Stretch?l.style.flex="0 1 100%":l.style.flex="0 1 auto",this.state){case s.kj.Normal:break;case s.kj.Expanded:(0,g.iQ)(l,a.makeCssClassName("expanded"));break;case s.kj.Subdued:(0,g.iQ)(l,a.makeCssClassName("subdued"))}return this.style&&this.isEffectivelyEnabled()&&(this.style===s.s9.Positive?g.iQ.apply(void 0,(0,o.__spreadArray)([l],(0,o.__read)(a.makeCssClassNames("primary","style-positive")),!1)):g.iQ.apply(void 0,(0,o.__spreadArray)([l],(0,o.__read)(a.makeCssClassNames("style-".concat(this.style.toLowerCase()))),!1))),this.isExpandable&&((0,g.iQ)(l,this.hostConfig.makeCssClassName("expandable")),l["aria-expanded"]=this.state===s.kj.Expanded),r.createElement("div",(0,o.__assign)({},l),i)},t.prototype.getButtonMenuItems=function(){},t.prototype.getAriaControlsAttribute=function(){},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t,n,r=[];if(e)try{for(var i=(0,o.__values)(Object.keys(e)),a=i.next();!a.done;a=i.next()){var s=e[a.value];s.validateValue()||r.push(s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.getEffectiveTooltip=function(){return this.tooltip||this.hostConfig.actions.defaultActionTooltip},t.prototype.internalExecute=function(){this._owner&&this._owner.actionExecuted(this),this.prepareForExecution()&&(this.onExecute&&this.onExecute(this),this.getRootObject().actionExecuted(this)),this.internalAfterExecute()},t.prototype.internalAfterExecute=function(){this.getRootObject().updateActionsEnabledState()},t.prototype.render=function(e){var t=this,n={};this.setupElementForAccessibility(n);var o=!!e&&e.isInline,r={forcePrimary:!1,renderedContent:this.renderButtonContent(o),isInline:o,onClick:"click"===this.applicationMode?function(e){t.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),t.execute())}:void 0};!this._actionButton&&w.actionButtonRenderer&&(this._actionButton=new w.actionButtonRenderer(this,this.getButtonMenuItems()),this._actionButton.onDomElementChanged=function(e,n){t.renderedElementChanged(e,n)});var i=this._actionButton?this._actionButton.render(n,r):null;return"wrap"===this.applicationMode&&i&&(i=this.wrapElement(i)),i},Object.defineProperty(t.prototype,"domElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.wrapElement=function(e){return e},t.prototype.applyTo=function(e,t){var n=this;if(this.isEffectivelyEnabled()&&this.hostConfig.supportsInteractivity){var i={handleKeyboard:S(null==t?void 0:t.handleKeyboard,!0),promoteTooltipToLabel:S(null==t?void 0:t.promoteTooltipToLabel,!1),updateClassName:S(null==t?void 0:t.updateClassName,!0)},a=(0,o.__assign)({},e.props);return this.setupElementForAccessibility(a,i.promoteTooltipToLabel,i.updateClassName),"click"===this.applicationMode?(i.handleKeyboard&&(a.onKeyPress=function(e){"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),e.stopPropagation(),n.execute())}),a.onClick=function(e){e.preventDefault(),e.stopPropagation(),n.execute()},r.cloneElement(r.createElement("div",{style:{display:"contents"}},e),a)):this.wrapElement(r.cloneElement(e,a))}return e},t.prototype.setupElementForAccessibility=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.tabIndex=this.isEffectivelyEnabled()?0:-1,e.role=this.getAriaRole(),this.isEffectivelyEnabled()?n&&(0,g.iQ)(e,this.hostConfig.makeCssClassName("ac-selectable")):(e.disabled=!0,e["aria-disabled"]=!0),e["aria-label"]=this.title,e["aria-controls"]=this.getAriaControlsAttribute(),e.title=this.title;var o=this.getEffectiveTooltip();o&&(e[t?this.title?"aria-describedby":"aria-label":"aria-describedby"]=o,e.title=o)},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new P)},t.prototype.execute=function(e){var t=this;null!=e&&null!=e&&e>0?(this._executeTimer&&clearTimeout(this._executeTimer),this._executeTimer=setTimeout((function(){return t.internalExecute()}),e)):this.internalExecute()},t.prototype.focus=function(){var e;return!(!this._isFocusable||!(null===(e=this._actionButton)||void 0===e?void 0:e.domElement))&&(this._actionButton.domElement.focus(),!0)},t.prototype.expand=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1)},t.prototype.collapse=function(){},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.asMenuItem=function(e){var t=this;return{key:e,text:this.title,tooltip:this.getEffectiveTooltip(),disabled:!this.isEffectivelyEnabled(),iconUrl:this.iconUrl,renderedContent:this.renderButtonContent(!1,!1,!0),onClick:function(){t.execute()}}},t.prototype.getAdditionalPropertyDescriptors=function(t){var n=t.actionRegistry.getDescriptors(t);return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"fallback",valueTypes:[{type:"object",validValues:n},{type:"string",validValues:["drop"]}],isArray:!1,declaringClassName:"Action",schemaVersion:d.uq.v1_2,suggestedSchemaTypeName:"FallbackActionArray"}],!1)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getAllActions=function(){return[this]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getElementById=function(e){},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.getInlineContent=function(){},t.prototype.hasResponsiveElements=function(){return!1},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.updateEnabledState=function(){},t.prototype.isEffectivelyEnabled=function(){return this.isEnabled&&(!this.parent||this.parent.isEnabled)},t.prototype.shouldRaiseOnExecuteEvent=function(){return!0},t.prototype.remove=function(){return!!this._owner&&this._owner.removeAction(this)},Object.defineProperty(t.prototype,"applicationMode",{get:function(){return"click"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style===s.s9.Positive},set:function(e){e?this.style=s.s9.Positive:this.style===s.s9.Positive&&(this.style=s.s9.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:u._f},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this.parent?this.parent.theme:s.V6.Light},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return this._isFocusable},set:function(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateLayout())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpanded",{get:function(){return this.state===s.kj.Expanded},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAtRootLevel",{get:function(){var e;return!(null===(e=this.parent)||void 0===e?void 0:e.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){var e,t;return null!==(t=null===(e=this._actionButton)||void 0===e?void 0:e.domElement)&&void 0!==t?t:void 0},enumerable:!1,configurable:!0}),t.titleProperty=new d.XB(d.uq.v1_0,"title").setContentType("text"),t.iconUrlProperty=new d.XB(d.uq.v1_1,"iconUrl").setContentType("imageUrl"),t.styleProperty=new d.XY(d.uq.v1_2,"style",[{value:s.s9.Default},{value:s.s9.Positive},{value:s.s9.Destructive}],s.s9.Default),t.modeProperty=new d.XY(d.uq.v1_5,"mode",[{value:s.yG.Primary},{value:s.yG.Secondary}],s.yG.Primary),t.tooltipProperty=new d.XB(d.uq.v1_5,"tooltip").setContentType("text"),t.isEnabledProperty=new d.gV(d.uq.v1_5,"isEnabled",!0),t.menuActionsProperty=new i.n(d.uq.v1_5,"menuActions",["Action.ShowCard","Action.Popover"]),t.themedIconUrlsProperty=new d.m2(d.uq.v1_5,"themedIconUrls",(function(e){return new m})),t}(v),P=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._forbiddenTypes=new Set,t.allowExtensionElementInGeneratedSchema=!1,t}return(0,o.__extends)(t,e),t.prototype.internalParseCardObject=function(e,t,n,o,r,i){var a,l=this;if(t&&"object"==typeof t){var c=new Set;this._forbiddenTypes.forEach((function(e){c.add(e)})),n.forEach((function(e){l._forbiddenTypes.add(e)}));var u=(0,g.$l)(t.type);if(u)if(this._forbiddenTypes.has(u))i(u,s.lS.ForbiddenType);else{var d=!1;if((a=r(u))?(a.setParent(e),a.parse(t,this),d=p.h$.enableFallback&&o&&a.shouldFallback()):(d=p.h$.enableFallback&&o,i(u,s.lS.UnknownType)),d){var h=t.fallback;void 0===h&&e&&e.setShouldFallback(!0),a="string"==typeof h&&"drop"===h.toLowerCase()?void 0:"object"==typeof h?this.internalParseCardObject(e,h,n,!0,r,i):void 0}}this._forbiddenTypes=c}return a},t.prototype.cardObjectParsed=function(e,t){e instanceof I&&this.onParseAction?this.onParseAction(e,t,this):e instanceof E&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof I?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof E)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,o,r,i){var a=new Set(n),s=this.internalParseCardObject(e,t,a,o,r,i);return void 0!==s&&this.cardObjectParsed(s,t),s},t.prototype.parseElement=function(e,n,o,r){var i=this;return this.parseCardObject(e,n,o,r,(function(e){var o=e===t.componentTypeName&&"name"in n&&"string"==typeof n.name?"".concat(e,".").concat(n.name):e;return i.elementRegistry.createInstance({context:i,typeName:o,payload:n,targetVersion:i.targetVersion})}),(function(e,t){t===s.lS.UnknownType?i.logParseEvent(void 0,s.iV.UnknownElementType,h.D.errors.unknownElementType(e)):i.logParseEvent(void 0,s.iV.ElementTypeNotAllowed,h.D.errors.elementTypeNotAllowed(e))}))},t.prototype.parseAction=function(e,t,n,o){var r=this;return this.parseCardObject(e,t,n,o,(function(e){return r.actionRegistry.createInstance({context:r,typeName:e,payload:t,targetVersion:r.targetVersion})}),(function(e,t){t===s.lS.UnknownType?r.logParseEvent(void 0,s.iV.UnknownActionType,h.D.errors.unknownActionType(e)):r.logParseEvent(void 0,s.iV.ActionTypeNotAllowed,h.D.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:w.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:w.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t.prototype.getAttachableElementProperties=function(){return this.elementRegistry.getAttachableProperties()},t.prototype.getAttachableElementProperty=function(e){return this.elementRegistry.getAttachableProperty(e)},t.componentTypeName="Component",t}(d.js),T=function(){function e(){this._items={},this._attachableProperties=new Map}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.copyTo=function(e){var t,n,r,i,a=Object.keys(this._items);try{for(var s=(0,o.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=this._items[c];e.register(u.typeName,u.createInstance,u.schemaVersion,u.metadata)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}try{for(var d=(0,o.__values)(this._attachableProperties),p=d.next();!p.done;p=d.next()){var h=(0,o.__read)(p.value,2)[1];e.registerAttachableProperty(h)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}},e.prototype.register=function(e,t,n,o){void 0===n&&(n=d.uq.v1_0);var r=this.findByName(e);void 0!==r?r.createInstance=t:r={typeName:e,createInstance:t,schemaVersion:n,metadata:o},this._items[e]=r},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.registerAttachableProperty=function(e){e.origin={declaringClass:d.jB,isInherited:!1,schemaVersion:d.uq.v1_5},this._attachableProperties.set(e.name,e)},e.prototype.unregisterAttachableProperty=function(e){this._attachableProperties.delete(e)},e.prototype.getAttachableProperty=function(e){return this._attachableProperties.get(e)},e.prototype.getAttachableProperties=function(){return Array.from(this._attachableProperties.values())},e.prototype.createInstance=function(e){var t=this.findByName(e.typeName);return t&&t.schemaVersion.compareTo(e.targetVersion)<=0?t.createInstance(e):void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e.prototype.getDescriptors=function(e,t,n,o,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===o&&(o=!1),void 0===r&&(r=!1);for(var i=[],a=0;a<this.getItemCount();a++){var s=this.getItemAt(a);if(n.includes(s.typeName)||!t.includes(s.typeName)){var l=s.createInstance({context:e,typeName:s.typeName,targetVersion:e.targetVersion}),c=!(l instanceof E)||l.isStandalone;o&&!c||i.push(new d.E$(l))}}if(r){var u=new d.FZ("ExtensionObject",[{name:"type",isArray:!1,valueTypes:[{type:"string",validValues:[{regEx:/^[Xx]-[\w\d]+$/,displayText:"X-"}]}]}]);u.preserveAdditionalProperties=!0,i.push(u)}return i},e}(),x=function(){function e(e,t){this.action=e,this.menuItems=t}return e.prototype.renderTitle=function(e){return null},e}(),w=function(){function e(){}return e.populateWithDefaultElements=function(t){t.clear(),e.defaultElements.copyTo(t)},e.populateWithDefaultActions=function(t){t.clear(),e.defaultActions.copyTo(t)},Object.defineProperty(e,"elements",{get:function(){return e._elements||(e._elements=new T,e.populateWithDefaultElements(e._elements)),e._elements},enumerable:!1,configurable:!0}),Object.defineProperty(e,"actions",{get:function(){return e._actions||(e._actions=new T,e.populateWithDefaultActions(e._actions)),e._actions},enumerable:!1,configurable:!0}),e.reset=function(){e._elements=void 0,e._actions=void 0},e.defaultElements=new T,e.defaultActions=new T,e}()},47328:(e,t,n)=>{function o(e,t){for(var n in e){var o=parseInt(n,10);if(o>=0){var r=e[n];if(r&&"string"==typeof r&&r.toLowerCase()===t.toLowerCase())return o}}}function r(e){var t=[];for(var n in e){if(parseInt(n,10)>=0){var o=e[n];o&&"string"==typeof o&&t.push(o)}}return t}n.d(t,{a:()=>r,l:()=>o})},33467:(e,t,n)=>{n.d(t,{$C:()=>u,Fg:()=>P,Kz:()=>h,Ln:()=>I,OD:()=>f,RK:()=>k,V6:()=>w,VZ:()=>E,Y2:()=>c,bs:()=>v,dC:()=>S,g7:()=>p,hJ:()=>a,i:()=>y,iV:()=>T,jh:()=>_,kj:()=>A,l1:()=>C,lK:()=>s,lS:()=>x,or:()=>i,pO:()=>l,r7:()=>g,s9:()=>o,sx:()=>m,t4:()=>b,uL:()=>d,xO:()=>D,yG:()=>r});var o,r,i,a,s,l,c,u,d,p,h,g,f,m,y,v,C,b,E,A,S,I,P,T,x,w,k,_,D=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();!function(e){e.Default="default",e.Positive="positive",e.Destructive="destructive"}(o||(o={})),function(e){e.Primary="primary",e.Secondary="secondary"}(r||(r={})),function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(i||(i={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(a||(a={})),function(e){e[e.xxSmall=0]="xxSmall",e[e.xSmall=1]="xSmall",e[e.Small=2]="Small",e[e.Standard=3]="Standard",e[e.Medium=4]="Medium",e[e.Large=5]="Large",e[e.xLarge=6]="xLarge",e[e.xxLarge=7]="xxLarge"}(s||(s={})),function(e){e[e.Regular=0]="Regular",e[e.Filled=1]="Filled"}(l||(l={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(c||(c={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(u||(u={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(d||(d={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(p||(p={})),function(e){e[e.None=0]="None",e[e.ExtraSmall=1]="ExtraSmall",e[e.Small=2]="Small",e[e.Default=3]="Default",e[e.Medium=4]="Medium",e[e.Large=5]="Large",e[e.ExtraLarge=6]="ExtraLarge",e[e.Padding=7]="Padding"}(h||(h={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(g||(g={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(f||(f={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(m||(m={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(y||(y={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person",e[e.RoundedCorners=2]="RoundedCorners"}(v||(v={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(C||(C={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(b||(b={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(E||(E={})),function(e){e[e.Normal=0]="Normal",e[e.Expanded=1]="Expanded",e[e.Subdued=2]="Subdued"}(A||(A={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(S||(S={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(I||(I={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(P||(P={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.PropertyShouldBeSet=9]="PropertyShouldBeSet",e[e.TooManyActions=10]="TooManyActions",e[e.UnknownActionType=11]="UnknownActionType",e[e.UnknownElementType=12]="UnknownElementType",e[e.UnsupportedCardVersion=13]="UnsupportedCardVersion",e[e.DuplicateId=14]="DuplicateId",e[e.UnsupportedProperty=15]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=16]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=17]="RequiredInputsShouldHaveErrorMessage",e[e.Other=18]="Other",e[e.UnknownProperty=19]="UnknownProperty"}(T||(T={})),function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(x||(x={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(w||(w={})),function(e){e[e.VeryNarrow=0]="VeryNarrow",e[e.Narrow=1]="Narrow",e[e.Standard=2]="Standard",e[e.Wide=3]="Wide"}(k||(k={})),function(e){e[e.AtLeast=0]="AtLeast",e[e.AtMost=1]="AtMost"}(_||(_={}))},49399:(e,t,n)=>{n.d(t,{FW:()=>y,Zo:()=>p,bi:()=>d});var o,r=n(79490),i=n(54932),a=n(8520),s=n(74842),l=n(33467),c=n(95312),u=["12","16","20","24","28","32","40","48"],d=/^([\w\d_-]+)(?:,(regular|filled)){0,1}$/i;function p(e){var t=e.match(d);if(t)return{name:t[1],style:void 0!==t[2]&&"filled"===t[2].toLowerCase()?l.pO.Filled:l.pO.Regular}}var h=((o={})[l.lK.xxSmall]=16,o[l.lK.xSmall]=20,o[l.lK.Small]=24,o[l.lK.Standard]=32,o[l.lK.Medium]=48,o[l.lK.Large]=56,o[l.lK.xLarge]=72,o[l.lK.xxLarge]=96,o);function g(e,t){var n=[];for(var o in t)n.push({rawSize:parseInt(o),icon:t[o]});for(var r=n.sort((function(e,t){return e.rawSize-t.rawSize})),i=0;i<r.length;i++){if(e<=r[i].rawSize)return(i>0?e-r[i-1].rawSize:1/0)<r[i].rawSize-e?r[i-1].icon:r[i].icon}return r[r.length-1].icon}function f(e){var t="".concat(e,"px");return a.createElement("div",{style:{width:t,height:t}})}function m(e){return"".concat(c.h$.fluentIconCdnBasePath).concat(e,"/").concat(e,".json")}var y=function(e){var t=h[l.lK.Standard],n=l.lK.Standard;if("number"==typeof e.iconSize)t=h[e.iconSize],n=e.iconSize;else if("string"==typeof e.iconSize)try{var o=c.zg.parse(e.iconSize,!0);o.unit===l.Y2.Pixel&&(t=o.physicalSize,n=function(e){for(var t in l.lK){var n=parseInt(t);if("number"==typeof n){var o=n;if(h[o]>=e)return o}}return l.lK.xxLarge}(t))}catch(e){}var i=(0,r.__read)(a.useState(E.getIconOrState(e.name,n,e.iconStyle)),2),u=i[0],d=i[1];switch(a.useEffect((function(){"notLoaded"===u&&E.getIcon(e.name,n,e.iconStyle,e.rawIconSet).then((function(e){d(null!=e?e:"unavailable")}))}),[u,e.name,n,e.iconStyle,e.rawIconSet]),u){case"notLoaded":return void 0===e.showPlaceholder||e.showPlaceholder?f(t):null;case"unavailable":return void 0===e.allowFallback||e.allowFallback?s.v7.imagePlaceholderRenderer?s.v7.imagePlaceholderRenderer({width:t+"px",height:t+"px"}):t?f(t):null:null;default:return a.createElement(u,{style:{color:e.iconColor,width:"".concat(t,"px"),height:"".concat(t,"px"),flex:"0 0 auto"}})}};function v(e){return"object"==typeof e&&u.every((function(t){return function(e){return null==e||Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}(e[t])}))}function C(e){return"object"==typeof e&&v(e.regular)&&v(e.filled)}function b(e,t,n){var o,a,s={};try{for(var l=(0,r.__values)(Object.entries(t)),c=l.next();!c.done;c=l.next()){var u=(0,r.__read)(c.value,2),d=u[0],p=u[1];s[d]=(0,i.U)(e,d,p,{flipInRtl:n})}}catch(e){o={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(o)throw o.error}}return s}var E=function(){function e(){}return e.getIconFromSet=function(e,t,n){var o,i,a=n===l.pO.Regular?[e.regular,e.filled]:[e.filled,e.regular];try{for(var s=(0,r.__values)(a),c=s.next();!c.done;c=s.next()){var u=c.value;if(Object.keys(u).length>0)return g(h[t],u)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}},e.getIcon=function(t,n,o,i){return(0,r.__awaiter)(this,void 0,void 0,(function(){var a,s,l,c;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return this._invalidIconNames.has(t)?[2,void 0]:(a=this._loadedIcons.get(t))?[3,7]:(s=void 0,i&&C(i)?(s=i,[3,6]):[3,1]);case 1:return r.trys.push([1,5,,6]),[4,fetch(m(t))];case 2:return(l=r.sent()).ok?[4,l.json()]:[3,4];case 3:C(c=r.sent())&&(s=c),r.label=4;case 4:return[3,6];case 5:return r.sent(),[3,6];case 6:s&&(a={regular:b(t,s.regular,s.flipInRtl),filled:b(t,s.filled,s.flipInRtl),flipInRtl:s.flipInRtl},this._loadedIcons.set(t,a)),r.label=7;case 7:return a?[2,e.getIconFromSet(a,n,o)]:(this._invalidIconNames.add(t),[2,void 0])}}))}))},e.getIconOrState=function(t,n,o){var r;if(this._invalidIconNames.has(t))return"unavailable";var i=this._loadedIcons.get(t);return i?null!==(r=e.getIconFromSet(i,n,o))&&void 0!==r?r:"unavailable":"notLoaded"},e._loadedIcons=new Map,e._invalidIconNames=new Set,e}()},25142:(e,t,n)=>{n.d(t,{B:()=>i});var o=n(79490),r=n(77909),i=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._capabilities={},t}return(0,o.__extends)(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var o in t){var i=t[o];if("string"==typeof i)if("*"===i)this.addCapability(o,"*");else{var a=r.Rx.parse(i,n);(null==a?void 0:a.isValid)&&this.addCapability(o,a)}}},t.prototype.internalToJSON=function(t,n){for(var o in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[o]=this._capabilities[o]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(r.jB)},57014:(e,t,n)=>{n.d(t,{Pv:()=>M,_f:()=>B});var o=n(79490),r=n(33467),i=n(25142),a=n(95312),s=n(11512);function l(e,t,n){if("string"==typeof t){var o=(0,s.nL)(e,t,n);return void 0!==o?o:n}return"number"==typeof t?t:n}var c=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}(),u=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t.highlightColors=new c("#22000000","#11000000"),t}return(0,o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(c),d=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)},p=function(){function e(t){this.imageSize=r.or.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=(0,s.$J)(t.maxImageHeight,e.defaultMaxImageHeight))}return e.prototype.toJSON=function(){return{imageSize:r.or[this.imageSize],maxImageHeight:this.maxImageHeight}},e.defaultMaxImageHeight=100,e}(),h=function(){function e(e){this.useHTML5PlayerAsFallback=!1,this.placeholderHeights={veryNarrow:120,narrow:175,standard:250,wide:300},e&&(this.defaultPoster=e.defaultPoster,this.useHTML5PlayerAsFallback=e.useHTML5PlayerAsFallback||this.useHTML5PlayerAsFallback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster}},e}(),g=function(){function e(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}return e.prototype.toJSON=function(){return{cellSpacing:this.cellSpacing}},e}(),f=function(){function e(e){this.size=r.$C.Default,this.color=r.r7.Default,this.isSubtle=!1,this.weight=r.uL.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=l(r.$C,e.size,this.size),this.color=l(r.r7,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=l(r.uL,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return r.uL.Default},e.prototype.toJSON=function(){return{size:r.$C[this.size],color:r.r7[this.color],isSubtle:this.isSubtle,weight:r.uL[this.weight]}},e}(),m=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t.fontType=r.g7.Default,t}return(0,o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=l(r.g7,t.fontType,this.fontType))},t}(f),y=function(){function e(e){this.default=new m,this.heading=new m({size:"Large",weight:"Bolder"}),this.columnHeader=new m({weight:"Bolder"}),this.label=new m({weight:"Bolder"}),this.captionLabel=new m({size:"Small",weight:"Bolder"}),this.caption=new m({size:"Small"}),this.captionSubtle=new m({size:"Small",weight:"Bolder",isSubtle:!0}),this.captionSubtleLabel=new m({size:"Small",isSubtle:!0}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader),this.label.parse(e.label),this.captionLabel.parse(e.captionLabel),this.caption.parse(e.caption),this.captionSubtle.parse(e.captionSubtle),this.captionSubtleLabel.parse(e.captionSubtleLabel))}return e.prototype.getStyleByName=function(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}},e}(),v=function(e){e&&(this.headingLevel=(0,s.$J)(e.headingLevel))},C=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t.suffix=" *",t.suffixColor=r.r7.Attention,t}return(0,o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=l(r.r7,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=r.r7[this.suffixColor],t},t}(f),b=function(e){this.inputSpacing=r.Kz.ExtraSmall,this.requiredInputs=new C,this.optionalInputs=new f,e&&(this.inputSpacing=l(r.Kz,e.inputSpacing,this.inputSpacing),this.requiredInputs=new C(e.requiredInputs),this.optionalInputs=new f(e.optionalInputs))},E=function(e){this.label=new b,this.errorMessage=new f({color:r.r7.Attention}),e&&(this.label=new b(e.label),this.errorMessage=new f(e.errorMessage))},A=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t.wrap=!0,t}return(0,o.__extends)(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(f),S=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=r.uL.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=l(r.uL,t.weight,r.uL.Bolder)),n}return(0,o.__extends)(t,e),t.prototype.getDefaultWeight=function(){return r.uL.Bolder},t}(A),I=function(e){this.rowGap=10,"object"==typeof e&&(this.rowGap="number"==typeof e.rowGap?Math.max(e.rowGap,0):this.rowGap)},P=function(e){function t(t){var n=e.call(this,t)||this;return n.columnGap=10,"object"==typeof t&&(n.columnGap="number"==typeof t.columnGap?Math.max(t.columnGap,0):n.columnGap),n}return(0,o.__extends)(t,e),t}(I),T=function(e){function t(t){var n=e.call(this,t)||this;return n.titleValueGap=0,"object"==typeof t&&(n.titleValueGap="number"==typeof t.titleValueGap?Math.max(t.titleValueGap,0):n.titleValueGap),n}return(0,o.__extends)(t,e),t}(I),x=function(e){this.title=new S,this.value=new A,this.tableLayout=new P,this.stackLayout=new T,this.layoutSwitchBreakpoint=r.RK.Standard,"object"==typeof e&&(this.title=new S(e.title),this.value=new A(e.value),this.tableLayout=new P(e.tableLayout),this.stackLayout=new T(e.stackLayout),this.layoutSwitchBreakpoint=l(r.RK,e.layoutSwitchBreakpoint,r.RK.Standard))},w=function(){function e(e){this.actionMode=r.l1.Inline,this.inlineTopMargin=16,this.style=r.xO.Emphasis,e&&(this.actionMode=l(r.l1,e.actionMode,r.l1.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:r.xO.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:r.l1[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}(),k=function(){function e(e){if(this.maxActions=5,this.spacing=r.Kz.Default,this.buttonSpacing=20,this.showCard=new w,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=r.t4.Horizontal,this.actionAlignment=r.i.Left,this.iconPlacement=r.dC.LeftOfTitle,this.allowTitleToWrap=!1,this.allowButtonsToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=l(r.Kz,e.spacing&&e.spacing,r.Kz.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new w(e.showCard),this.preExpandSingleShowCardAction=(0,s.q6)(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=l(r.t4,e.actionsOrientation,r.t4.Horizontal),this.actionAlignment=l(r.i,e.actionAlignment,r.i.Left),this.iconPlacement=l(r.dC,e.iconPlacement,r.dC.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap,this.allowButtonsToWrap=null!=e.allowButtonsToWrap?e.allowButtonsToWrap:this.allowTitleToWrap;try{var t=a.zg.parse(e.iconSize);t.unit===r.Y2.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:r.Kz[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:r.t4[this.actionsOrientation],actionAlignment:r.i[this.actionAlignment]}},e}(),_=function(){function e(e){this.default=new u,this.dark=new u,this.light=new u,this.accent=new u,this.good=new u,this.warning=new u,this.attention=new u,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e.prototype.getColorDefinition=function(e){switch(e){case r.r7.Accent:return this.accent;case r.r7.Dark:return this.dark;case r.r7.Light:return this.light;case r.r7.Good:return this.good;case r.r7.Warning:return this.warning;case r.r7.Attention:return this.attention;default:return this.default}},e}(),D=function(){function e(e){this.foregroundColors=new _({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(D),L=function(){function e(e){var t,n;if(this._allStyles={},this._allStyles[r.xO.Default]=new F,this._allStyles[r.xO.Emphasis]=new F,this._allStyles[r.xO.Accent]=new F,this._allStyles[r.xO.Good]=new F,this._allStyles[r.xO.Attention]=new F,this._allStyles[r.xO.Warning]=new F,e){this._allStyles[r.xO.Default].parse(e[r.xO.Default]),this._allStyles[r.xO.Emphasis].parse(e[r.xO.Emphasis]),this._allStyles[r.xO.Accent].parse(e[r.xO.Accent]),this._allStyles[r.xO.Good].parse(e[r.xO.Good]),this._allStyles[r.xO.Attention].parse(e[r.xO.Attention]),this._allStyles[r.xO.Warning].parse(e[r.xO.Warning]);var i=e.customStyles;if(i&&Array.isArray(i))try{for(var a=(0,o.__values)(i),s=a.next();!s.done;s=a.next()){var l=s.value;if(l){var c=l.name;c&&"string"==typeof c&&(this._allStyles.hasOwnProperty(c)?this._allStyles[c].parse(l.style):this._allStyles[c]=new D(l.style))}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[r.xO.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[r.xO.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[r.xO.Emphasis]},enumerable:!1,configurable:!0}),e}(),O=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.prototype.getFontSize=function(e){switch(e){case r.$C.Small:return this.fontSizes.small;case r.$C.Medium:return this.fontSizes.medium;case r.$C.Large:return this.fontSizes.large;case r.$C.ExtraLarge:return this.fontSizes.extraLarge;default:return this.fontSizes.default}},e.monospace=new e("'Courier New', Courier, monospace"),e}(),R=function(){function e(e){this.default=new O,this.monospace=new O("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case r.g7.Monospace:return this.monospace;case r.g7.Default:default:return this.default}},e}(),M=function(){function e(e){this.hostCapabilities=new i.B,this.designMode=!1,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.hostWidthBreakpoints={veryNarrow:216,narrow:345,standard:500},this.spacing={extraSmall:4,small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.roundedCornerRadius=6,this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new L,this.inputs=new E,this.actions=new k,this.adaptiveCard=new d,this.imageSet=new p,this.media=new h,this.factSet=new x,this.table=new g,this.textStyles=new y,this.textBlock=new v,this.alwaysAllowBleed=!1,this._legacyFontType=new O,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new R(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new L(e.containerStyles),this.spacing={extraSmall:e.spacing&&e.spacing.extraSmall||this.spacing.extraSmall,small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new E(e.inputs||this.inputs),this.actions=new k(e.actions||this.actions),this.adaptiveCard=new d(e.adaptiveCard||this.adaptiveCard),this.imageSet=new p(e.imageSet),this.factSet=new x(e.factSet),this.textStyles=new y(e.textStyles),this.textBlock=new v(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===r.g7.Monospace?O.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case r.Kz.ExtraSmall:return this.spacing.extraSmall;case r.Kz.Small:return this.spacing.small;case r.Kz.Default:return this.spacing.default;case r.Kz.Medium:return this.spacing.medium;case r.Kz.Large:return this.spacing.large;case r.Kz.ExtraLarge:return this.spacing.extraLarge;case r.Kz.Padding:return this.spacing.padding;default:return 0}},e.prototype.getHostWidthForPixelWidth=function(e){return e<=this.hostWidthBreakpoints.veryNarrow?r.RK.VeryNarrow:e<=this.hostWidthBreakpoints.narrow?r.RK.Narrow:e<=this.hostWidthBreakpoints.standard?r.RK.Standard:r.RK.Wide},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new a.$i(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=[];try{for(var a=(0,o.__values)(n),s=a.next();!s.done;s=a.next()){var l=s.value;i.push((this.cssClassNamePrefix?"".concat(this.cssClassNamePrefix,"-"):"")+l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return i},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,(0,o.__spreadArray)([],(0,o.__read)(e),!1)).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}(),B=new M({preExpandSingleShowCardAction:!0,supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:40,medium:80,large:160},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{borderColor:"#CCCCCC",backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{borderColor:"#666666",backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:"default",buttonSpacing:10,showCard:{actionMode:"inline",inlineTopMargin:16},actionsOrientation:"horizontal",actionAlignment:"left"},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:"medium",maxImageHeight:100},factSet:{title:{color:"default",size:"default",isSubtle:!1,weight:"bolder",wrap:!0,maxWidth:150},value:{color:"default",size:"default",isSubtle:!1,weight:"default",wrap:!0},tableLayout:{columnGap:10,rowGap:6},stackLayout:{rowGap:10},layoutSwitchBreakpoint:"standard"}})},77909:(e,t,n)=>{n.d(t,{BG:()=>h,E$:()=>D,FZ:()=>_,Rx:()=>c,Uy:()=>m,XB:()=>g,XY:()=>C,Zn:()=>I,a7:()=>A,bU:()=>w,fX:()=>b,g7:()=>v,gV:()=>f,jB:()=>x,js:()=>d,kR:()=>E,l5:()=>y,m2:()=>S,uq:()=>u});var o=n(79490),r=n(47328),i=n(33467),a=n(95312),s=n(23379),l=n(11512),c=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var o=new e;o._versionString=t;var r=/(\d+).(\d+)/gi.exec(t);return null!=r&&3===r.length?(o._major=parseInt(r[1],10),o._minor=parseInt(r[2],10)):o._isValid=!1,o._isValid||n.logParseEvent(void 0,i.iV.InvalidPropertyValue,s.D.errors.invalidVersionString(o._versionString)),o}},e.prototype.toString=function(){return this._isValid?"".concat(this._major,".").concat(this._minor):this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}(),u=function(){function e(){}return e.getAllDeclaredVersions=function(){var t=[];for(var n in e)if(n.match(/^v[0-9_]*$/))try{var o=e[n];o instanceof c&&t.push(o)}catch(e){}return t.sort((function(e,t){return e.compareTo(t)}))},e.v1_0=new c(1,0),e.v1_1=new c(1,1),e.v1_2=new c(1,2),e.v1_3=new c(1,3),e.v1_4=new c(1,4),e.v1_5=new c(1,5),e.v1_6=new c(1,6,"1.6 Preview"),e.latest=e.v1_5,e}();var d=function(){function e(e){void 0===e&&(e=u.latest),this._validationEvents=[],this.targetVersion=e}return e.prototype.postProcessParsedPropertyValue=function(t,n){var o,r=null!==(o=this.onPostProcessParsedPropertyValue)&&void 0!==o?o:e.onPostProcessParsedPropertyValue;return r?r(t,n):n},e.prototype.serializeValue=function(e,t,n,o,r){void 0===o&&(o=void 0),void 0===r&&(r=!1),null==n||n===o?r&&delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,o){null==n||n===o?delete e[t]:e[t]=n},e.prototype.serializeDate=function(e,t,n,o){null==n||n===o?delete e[t]:e[t]=(0,l.$T)(n)},e.prototype.serializeBool=function(e,t,n,o){null==n||n===o?delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,o){null==n||isNaN(n)||n===o?delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,o,r){void 0===r&&(r=void 0),null==o||o===r?delete t[n]:t[n]=e[o]},e.prototype.serializeArray=function(e,t,n){var r,i,a=[];if(n)try{for(var s=(0,o.__values)(n),l=s.next();!l.done;l=s.next()){var c=l.value,u=void 0;void 0!==(u=c instanceof x?c.toJSON(this):c.toJSON?c.toJSON():c)&&a.push(u)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}0===a.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,a)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,o){this._validationEvents.push({source:e,phase:t,event:n,message:o})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,i.Fg.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e.prototype.shouldFailRendering=function(){return a.h$.failRenderingWhenUnknownPropertiesAreFound&&this._validationEvents.some((function(e){return e.event===i.iV.UnknownProperty}))||a.h$.failRenderingWhenInvalidPropertyValuesAreFound&&this._validationEvents.some((function(e){return e.event===i.iV.InvalidPropertyValue}))},e.prototype.hasEvent=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._validationEvents.some((function(t){return e.includes(t.event)}))},e.prototype.getAttachableElementProperties=function(){return[]},e.prototype.getAttachableElementProperty=function(e){},e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t}(d),h=function(){function e(t,n,o,r){this.targetVersion=t,this.name=n,this.defaultValue=o,this.onGetInitialValue=r,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getValueMetadata=function(e){},e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,n,this.defaultValue)},e.prototype.preProcessValue=function(e){return e},e.prototype.getDescriptor=function(e){return{valueTypes:[{type:"any"}],isArray:!1,defaultValue:this.defaultValue}},e.prototype.setContentType=function(e){return this.contentType=e,this},e.prototype.setEnableSerialization=function(e){return this.isSerializationEnabled=e,this},e._sequentialNumber=0,e}(),g=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,r,i)||this;return s.targetVersion=t,s.name=n,s.regEx=o,s.defaultValue=r,s.onGetInitialValue=i,s.allowEmptyString=a,s}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=(0,l.$l)(t[this.name],this.defaultValue);if((""!==o||this.allowEmptyString||(o=void 0),o&&void 0!==this.regEx)&&!this.regEx.exec(o))return void n.logParseEvent(e,i.iV.InvalidPropertyValue,s.D.errors.invalidPropertyValue(o,this.name));return o},t.prototype.toJSON=function(e,t,n,o){o.serializeString(t,this.name,""===n?void 0:n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"}],defaultValue:this.defaultValue,isArray:!1,contentType:this.contentType}},t}(h),f=function(e){function t(t,n,o,r){var i=e.call(this,t,n,o,r)||this;return i.targetVersion=t,i.name=n,i.defaultValue=o,i.onGetInitialValue=r,i}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){return(0,l.q6)(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,o){o.serializeBool(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"boolean"}],defaultValue:this.defaultValue,isArray:!1}},t}(h),m=function(e){function t(t,n,o,r){var i=e.call(this,t,n,o,r)||this;return i.targetVersion=t,i.name=n,i.defaultValue=o,i.onGetInitialValue=r,i}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){return(0,l.$J)(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,o){o.serializeNumber(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"number"}],defaultValue:this.defaultValue,isArray:!1}},t}(h),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,r=t[this.name];if("string"==typeof r){var l=!1;try{var c=a.zg.parse(r,!0);c.unit===i.Y2.Pixel&&(o=c.physicalSize,l=!0)}catch(e){}l||n.logParseEvent(e,i.iV.InvalidPropertyValue,s.D.errors.invalidPropertyValue(t[this.name],"minHeight"))}return o},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:"".concat(n,"px"))},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:[a.IO]}],defaultValue:this.defaultValue,isArray:!1}},t}(h),v=function(e){function t(t,n,o,r){var i=e.call(this,t,n,o,r)||this;return i.targetVersion=t,i.name=n,i.defaultValue=o,i.onGetInitialValue=r,i}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,a,s=t[this.name];if(void 0===s||!Array.isArray(s))return this.defaultValue;var l=[];try{for(var c=(0,o.__values)(s),u=c.next();!u.done;u=c.next()){var d=u.value;"string"==typeof d?l.push(d):n.logParseEvent(e,i.iV.InvalidPropertyValue,'Invalid array value "'.concat(JSON.stringify(d),'" of type "').concat(typeof d,'" ignored for "').concat(this.name,'".'))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}return l},t.prototype.toJSON=function(e,t,n,o){o.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"}],defaultValue:this.defaultValue,isArray:!0}},t}(h),C=function(e){function t(t,n,o,r,i){var a=e.call(this,t,n,r,i)||this;return a.targetVersion=t,a.name=n,a.values=o,a.defaultValue=r,a.onGetInitialValue=i,a}return(0,o.__extends)(t,e),t.prototype.isValidValue=function(e,t){var n,r;try{for(var i=(0,o.__values)(this.values),a=i.next();!a.done;a=i.next()){var s=a.value;if(e.toLowerCase()===s.value.toLowerCase())return(s.targetVersion?s.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1},t.prototype.parse=function(e,t,n){var r,a,l=t[this.name];if(void 0===l)return this.defaultValue;if("string"==typeof l)try{for(var c=(0,o.__values)(this.values),u=c.next();!u.done;u=c.next()){var d=u.value;if(l.toLowerCase()===d.value.toLowerCase()){var p=d.targetVersion?d.targetVersion:this.targetVersion;return p.compareTo(n.targetVersion)<=0?d.value:(n.logParseEvent(e,i.iV.InvalidPropertyValue,s.D.errors.propertyValueNotSupported(l,this.name,p.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(r)throw r.error}}return n.logParseEvent(e,i.iV.InvalidPropertyValue,s.D.errors.invalidPropertyValue(l,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){var a,l,c=!1;if(void 0!==n){c=!0;try{for(var u=(0,o.__values)(this.values),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.value===n){var h=p.targetVersion?p.targetVersion:this.targetVersion;if(h.compareTo(r.targetVersion)<=0){c=!1;break}r.logEvent(e,i.Fg.ToJSON,i.iV.InvalidPropertyValue,s.D.errors.propertyValueNotSupported(n,this.name,h.toString(),r.targetVersion.toString()))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}c||r.serializeValue(t,this.name,n,this.defaultValue,!0)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:this.values.map((function(e){return e.value}))}],defaultValue:this.defaultValue,isArray:!1}},t}(h),b=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,r,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=o,s.defaultValue=r,s.onGetInitialValue=a,s._values=[],i)s._values=i;else for(var l in o){var c=parseInt(l,10);c>=0&&s._values.push({value:c})}return s}return(0,o.__extends)(t,e),t.prototype.getValueMetadata=function(e){if("number"==typeof e&&this.valuesMetadata)return this.valuesMetadata[e]},t.prototype.parse=function(e,t,n){var a,l,c=t[this.name];if("string"!=typeof c)return this.defaultValue;var u=(0,r.l)(this.enumType,c);if(void 0!==u)try{for(var d=(0,o.__values)(this.values),p=d.next();!p.done;p=d.next()){var h=p.value;if(h.value===u){var g=h.targetVersion?h.targetVersion:this.targetVersion;return g.compareTo(n.targetVersion)<=0?u:(n.logParseEvent(e,i.iV.InvalidPropertyValue,s.D.errors.propertyValueNotSupported(c,this.name,g.toString(),n.targetVersion.toString())),this.defaultValue)}}}catch(e){a={error:e}}finally{try{p&&!p.done&&(l=d.return)&&l.call(d)}finally{if(a)throw a.error}}return n.logParseEvent(e,i.iV.InvalidPropertyValue,s.D.errors.invalidPropertyValue(c,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){var a,l,c=!1;if(void 0!==n){c=!0;try{for(var u=(0,o.__values)(this.values),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.value===n){if((p.targetVersion?p.targetVersion:this.targetVersion).compareTo(r.targetVersion)<=0){c=!1;break}r.logEvent(e,i.Fg.ToJSON,i.iV.InvalidPropertyValue,s.D.errors.invalidPropertyValue(n,this.name))}}}catch(e){a={error:e}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(a)throw a.error}}}c||r.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){var t,n,i=(0,r.a)(this.enumType),a={};try{for(var s=(0,o.__values)(i),l=s.next();!l.done;l=s.next()){var c=l.value,u=(0,r.l)(this.enumType,c),d=this.getValueMetadata(u);d&&(a[c]=d)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return{valueTypes:[{type:"string",validValues:(0,r.a)(this.enumType)}],valuesMetadata:Object.keys(a).length>0?a:void 0,defaultValue:void 0!==this.defaultValue?this.enumType[this.defaultValue]:void 0,isArray:!1}},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(h),E=function(e){function t(t,n,o,r,i){void 0===r&&(r=!1);var a=e.call(this,t,n,i,(function(e){return a.nullable?void 0:a.createInstance()}))||this;return a.targetVersion=t,a.name=n,a.createInstance=o,a.nullable=r,a.allowAdditionalProperties=!0,a}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name];if(void 0===o)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var r=this.createInstance(t);return r.parse(o,n),r},t.prototype.toJSON=function(e,t,n,o){var r;void 0===n||n.hasAllDefaultValues()||(r=n.toJSON(o)),"object"==typeof r&&0===Object.keys(r).length&&(r=void 0),o.serializeValue(t,this.name,r,this.defaultValue,!0)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"object",validValues:[new D(this.createInstance(),this.allowAdditionalProperties)]}],defaultValue:this.defaultValue,isArray:!1}},t}(h),A=function(e){function t(t,n,o,r,i,a){void 0===i&&(i=!1);var s=e.call(this,t,n,r,i,a)||this;return s.targetVersion=t,s.name=n,s.objectTypeName=o,s.createInstance=r,s.nullable=i,s}return(0,o.__extends)(t,e),t.prototype.parse=function(t,n,o){var r=n[this.name];if("object"==typeof r&&"type"in r&&r.type===this.objectTypeName)return e.prototype.parse.call(this,t,n,o)},t}(E),S=function(e){function t(t,n,o,r){var i=e.call(this,t,n,void 0,(function(e){return[]}))||this;return i.targetVersion=t,i.name=n,i.createInstance=o,i.onItemAdded=r,i}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var r,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=(0,o.__values)(s),c=l.next();!c.done;c=l.next()){var u=c.value,d=this.createInstance(u);d&&(d.parse(u,n),a.push(d),this.onItemAdded&&this.onItemAdded(e,d))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}return a.length>0?a:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,o){o.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){var t=this.createInstance();return{valueTypes:[{type:"object",validValues:t?[new D(t)]:void 0}],defaultValue:this.defaultValue,isArray:!0}},t}(h),I=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,i,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=o,s.onToJSON=r,s.defaultValue=i,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,o){this.onToJSON(e,this,t,n,o)},t}(h),P=function(){function e(e){this.owner=e,this._properties=new Map}return e.prototype.determinePropertyOrigins=function(){var e=new T(this.owner);for(var t in this.owner.constructor)try{var n=this.owner.constructor[t];if(n instanceof h){var o=e.getDeclaringClass(t);o&&(n.origin={declaringClass:o,isInherited:o!==this.owner.constructor,schemaVersion:n.targetVersion})}}catch(e){}},e.prototype.add=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var i=(0,o.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;this._properties.has(s.name)||this._properties.set(s.name,s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.remove=function(){for(var e,t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];try{for(var i=(0,o.__values)(n),a=i.next();!a.done;a=i.next()){var s=a.value;this._properties.has(s.name)&&this._properties.delete(s.name)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.getItem=function(e){return this._properties.get(e)},Object.defineProperty(e.prototype,"key",{get:function(){return this.owner.getSchemaKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties.values()},enumerable:!1,configurable:!0}),e}(),T=function(){function e(e){this._serializableObject=e;var t,n=[this._serializableObject.constructor];do{t=Object.getPrototypeOf(n[0].prototype).constructor,(Object.prototype.isPrototypeOf.call(x,t)||t===x)&&(n=(0,o.__spreadArray)([t],(0,o.__read)(n),!1))}while(t!==x);this._constructorHierarchy=n}return e.prototype.getDeclaringClass=function(e){var t,n;try{for(var r=(0,o.__values)(this._constructorHierarchy),i=r.next();!i.done;i=r.next()){var a=i.value;if(e in a)return a}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e}(),x=function(){function e(){var t,n;this._isParsing=!1,this._propertyBag={},this._rawProperties={},this.key=e.currentKey++,this.maxVersion=e.defaultMaxVersion;var r=this.getSchema();try{for(var i=(0,o.__values)(r.properties),a=i.next();!a.done;a=i.next()){var s=a.value;s.onGetInitialValue&&this.setValue(s,s.onGetInitialValue(this))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}return e.prototype.propertyChanged=function(e,t){this.onPropertyChanged&&this.onPropertyChanged(this,e,t)},e.prototype.afterParse=function(){},e.prototype.getDefaultSerializationContext=function(){return new p},e.prototype.populateSchema=function(t){var n=[];for(var r in this.constructor)try{var i=this.constructor[r];i instanceof h&&n.push(i)}catch(e){}if(n.length>0){var a=n.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,(0,o.__spreadArray)([],(0,o.__read)(a),!1))}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getAttachableProperties=function(e){return[]},e.prototype.internalParse=function(e,t){var n,r;if(!this._isParsing){this._isParsing=!0;try{if(this._propertyBag={},this._rawProperties=a.h$.enableFullJsonRoundTrip&&e||{},e){var l=this.getSchema(),c=this.getAdditionalValidSchemaProperties();for(var u in e)l.getItem(u)||c.includes(u)||t.getAttachableElementProperty(u)||t.logParseEvent(this,i.iV.UnknownProperty,s.D.errors.unknownProperty(u));var d=Array.from(l.properties).concat(this.getAttachableProperties(t));try{for(var p=(0,o.__values)(d),h=p.next();!h.done;h=p.next()){var g=h.value;if(g.isSerializationEnabled){var f=g.onGetInitialValue?g.onGetInitialValue(this):void 0;e.hasOwnProperty(g.name)&&(g.targetVersion.compareTo(t.targetVersion)<=0?f=t.postProcessParsedPropertyValue(g,g.parse(this,e,t)):t.logParseEvent(this,i.iV.UnsupportedProperty,s.D.errors.propertyNotSupported(g.name,g.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(g,f)}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}}else this.resetDefaultValues()}finally{this._isParsing=!1,this.afterParse()}}},e.prototype.internalToJSON=function(e,t){var n,r,i=this.getSchema(),a=[];try{for(var s=(0,o.__values)(i.properties),l=s.next();!l.done;l=s.next()){var c=l.value;c.isSerializationEnabled&&c.targetVersion.compareTo(t.targetVersion)<=0&&-1===a.indexOf(c.name)&&(c.toJSON(this,e,this.getValue(c),t),a.push(c.name))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.getAdditionalPropertyDescriptors=function(e){return[]},e.prototype.reflect=function(e){var t,n,r,i,a,s,l=this.getSchema();l.determinePropertyOrigins();var c=this.getAdditionalPropertyDescriptors(e),u=new Map,d=(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(l.properties),!1),(0,o.__read)(this.getAttachableProperties(e)),!1);try{for(var p=(0,o.__values)(d),h=p.next();!h.done;h=p.next()){var g=h.value;g.isSerializationEnabled&&u.set(g.name,(0,o.__assign)((0,o.__assign)({name:g.name},g.getDescriptor(e)),{declaringClassName:null===(a=g.origin)||void 0===a?void 0:a.declaringClass.name,schemaVersion:null===(s=g.origin)||void 0===s?void 0:s.schemaVersion,metadata:g.metadata}))}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}try{for(var f=(0,o.__values)(c),m=f.next();!m.done;m=f.next()){var y=m.value;y.declaringClassName||(y.declaringClassName=this.constructor.name),u.set(y.name,y)}}catch(e){r={error:e}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}return(0,o.__spreadArray)([],(0,o.__read)(u.values()),!1)},e.prototype.getAdditionalValidSchemaProperties=function(){return[]},e.prototype.getSerializationContext=function(){return this.getDefaultSerializationContext()},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){var n=this,o=function(e,t){n._isParsing||n.propertyChanged(e,t)};if(null==t)this._propertyBag.hasOwnProperty(e.getInternalName())&&(delete this._propertyBag[e.getInternalName()],o(e,t));else{var r=e.preProcessValue(t);this._propertyBag[e.getInternalName()]!==r&&(this._propertyBag[e.getInternalName()]=r,o(e,r))}},e.prototype.parse=function(e,t){var n=null!=t?t:this.getSerializationContext();this.internalParse(e,n),n.onAfterObjectParsed&&n.onAfterObjectParsed(this,e)},e.prototype.toJSON=function(e){var t=e&&e instanceof d?e:this.getSerializationContext();if(this.shouldSerialize(t)){var n=void 0;return n=a.h$.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){var e,t,n=this.getSchema();try{for(var r=(0,o.__values)(n.properties),i=r.next();!i.done;i=r.next()){var a=i.value;if(!this.hasDefaultValue(a))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return!0},e.prototype.resetDefaultValues=function(){var e,t,n=this.getSchema();try{for(var r=(0,o.__values)(n.properties),i=r.next();!i.done;i=r.next()){var a=i.value;this.setValue(a,a.defaultValue)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new P(this),this.populateSchema(t),e._schemaCache[t.key]=t),t},e.currentKey=0,e.defaultMaxVersion=u.latest,e._schemaCache={},e}(),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"type",valueTypes:[{type:"string"}],requiredValue:this.getJsonTypeName(),isArray:!1,declaringClassName:this.constructor.name,schemaVersion:u.v1_0}],!1)},t.typeNameProperty=new g(u.v1_0,"type",void 0,void 0,(function(e){return e.getJsonTypeName()})),t}(x),k=function(e){this.allowAdditionalProperties=e,this.preserveAdditionalProperties=!1},_=function(e){function t(t,n,r){var i,a;void 0===r&&(r=!0);var s=e.call(this,r)||this;s._name=t,s._properties=n;try{for(var l=(0,o.__values)(s._properties),c=l.next();!c.done;c=l.next()){c.value.declaringClassName=s._name}}catch(e){i={error:e}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(i)throw i.error}}return s}return(0,o.__extends)(t,e),t.prototype.getProperties=function(e){return this._properties},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}(k),D=function(e){function t(t,n){void 0===n&&(n=!0);var o=e.call(this,n)||this;return o._objectToReflect=t,o}return(0,o.__extends)(t,e),t.prototype.getProperties=function(e){return this._properties||(this._properties=this._objectToReflect.reflect(e)),this._properties},Object.defineProperty(t.prototype,"name",{get:function(){return this._objectToReflect.getSchemaKey()},enumerable:!1,configurable:!0}),t}(k)},95312:(e,t,n)=>{n.d(t,{$i:()=>a,IO:()=>l,bK:()=>u,gH:()=>d,h$:()=>i,kk:()=>p,pT:()=>s,zg:()=>c});var o=n(47328),r=n(33467),i=function(){function e(){}return e.useMarkdownInRadioButtonAndCheckbox=!0,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!0,e.removePaddingFromContainersWithBackgroundImage=!1,e.resetInputsDirtyStateAfterActionExecution=!1,e.defaultUnlocalizableStringFallback="Undefined",e.allowDelayedContainerRendering=!0,e.useBorderColorForSeparator=!1,e.failRenderingWhenUnknownPropertiesAreFound=!1,e.failRenderingWhenInvalidPropertyValuesAreFound=!1,e.fluentIconCdnBasePath="https://res-1.cdn.office.net/assets/fluentui-react-icons/2.0.226/",e.enableIconSupportForActionButtons=!1,e.allowSimultaneousVideoPlayback=!1,e}(),a=function(e,t,n,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=o},s=function(e,t,n,o){void 0===e&&(e=r.Kz.None),void 0===t&&(t=r.Kz.None),void 0===n&&(n=r.Kz.None),void 0===o&&(o=r.Kz.None),this.top=r.Kz.None,this.right=r.Kz.None,this.bottom=r.Kz.None,this.left=r.Kz.None,this.top=e,this.right=t,this.bottom=n,this.left=o},l={regEx:/^\d+px$/,displayText:"<number>px"},c=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var o=new e(0,r.Y2.Weight);if("number"==typeof t)return o.physicalSize=t,o;if("string"==typeof t){var i=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(i&&i.length>=a)return o.physicalSize=parseInt(i[1],10),3===i.length&&"px"===i[2]&&(o.unit=r.Y2.Pixel),o}throw new Error("Invalid size: ".concat(t))},e}();function u(e,t){return e===t?0:e<t?-1:1}var d=function(){function e(e,t){void 0===e&&(e=r.RK.Wide),this.width=e,this.condition=t}return e.parse=function(t){var n,i,a=(0,o.a)(r.jh).join("|"),s=(0,o.a)(r.RK).join("|"),l=new RegExp("^(?:(".concat(a,"):)?(").concat(s,")$"),"i").exec(t);if(l&&l.length>=3){var c=new e,u=null===(n=l[1])||void 0===n?void 0:n.toLowerCase();if(void 0!==u){var d=(0,o.l)(r.jh,u);if(void 0===d)return;c.condition=d}var p=null===(i=l[2])||void 0===i?void 0:i.toLowerCase();if(void 0!==p){var h=(0,o.l)(r.RK,p);if(void 0===h)return;return c.width=h,c}}},e.prototype.matches=function(e){return void 0===this.condition?this.width===e:this.condition===r.jh.AtLeast?this.width<=e:e<=this.width},e.prototype.toString=function(){return void 0!==this.condition?"".concat(r.jh[this.condition],":").concat(r.RK[this.width]):r.RK[this.width]},e}(),p=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,o=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&o|128]+e.lut[o>>8&255]+"-"+e.lut[o>>16&255]+e.lut[o>>24&255]+e.lut[255&r]+e.lut[r>>8&255]+e.lut[r>>16&255]+e.lut[r>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();p.initialize()},23379:(e,t,n)=>{n.d(t,{D:()=>o});var o=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'.concat(e,'". Fallback will be used if present.')},unknownActionType:function(e){return'Unknown action type "'.concat(e,'". Fallback will be used if present.')},elementTypeNotAllowed:function(e){return'Element type "'.concat(e,'" is not allowed in this context.')},actionTypeNotAllowed:function(e){return'Action type "'.concat(e,'" is not allowed in this context.')},invalidPropertyValue:function(e,t){return'Invalid value "'.concat(e,'" for property "').concat(t,'".')},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'.concat(e,'" - defaulting to "auto".')},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'.concat(e,'".')},invalidVersionString:function(e){return'Invalid version string "'.concat(e,'".')},propertyValueNotSupported:function(e,t,n,o){return'Value "'.concat(e,'" for property "').concat(t,'" is supported in version ').concat(n,", but you are using version ").concat(o,".")},propertyNotSupported:function(e,t,n){return'Property "'.concat(e,'" is supported in version ').concat(t,", but you are using version ").concat(n,".")},indexOutOfRange:function(e){return"Index out of range (".concat(e,").")},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'.concat(e,'" must be set.')},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded (".concat(e,").")},tooLittleTimeDelay:function(e){return"Autoplay Delay is too short (".concat(e,").")},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version (".concat(e,") is not supported or still in preview. The latest released card version is ").concat(t,".")},duplicateId:function(e){return'Duplicate Id "'.concat(e,'".')},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type ".concat(e," cannot be used as standalone elements.")},unknownProperty:function(e){return'Unknown property "'.concat(e,'"')},speakPropertyShouldBeSet:function(){return'The "speak" property should always be set as it provides a way for screen readers to describe the card to an end-user that relies on assistive technologies.'}},e.hints={dontUseWeightedAndStretchedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.overflowButtonText={key:"overflowButtonText",defaultValue:"..."},e.overflowButtonTooltip={key:"overflowButtonTooltip",defaultValue:"More options"},e.mediaPlayerAriaLabel={key:"mediaPlayerAriaLabel",defaultValue:"Media content"},e.mediaPlayerPlayMedia={key:"mediaPlayerPlayMedia",defaultValue:"Play media"},e.youTubeVideoPlayer={key:"youTubeVideoPlayer",defaultValue:"YouTube video player"},e.vimeoVideoPlayer={key:"vimeoVideoPlayer",defaultValue:"Vimeo video player"},e.dailymotionVideoPlayer={key:"dailymotionVideoPlayer",defaultValue:"Dailymotion video player"},e.mediaPlayerPosterAltText={key:"mediaPlayerPosterAltText",defaultValue:"Video poster"},e.emptyElementText={key:"emptyElementText",defaultValue:"Empty {{elementType}}"},e}()},14492:(e,t,n)=>{n.d(t,{v:()=>s});var o=n(79490),r=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){var n;if(t){for(var o=t;null!=(n=this._regularExpression.exec(t));)o=o.replace(n[0],this.internalFormat(e,n));return o}return t},e}(),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),o=void 0!==t[2]?t[2].toLowerCase():"compact";return"compact"!==o?n.toLocaleDateString(e,{day:"numeric",weekday:o,month:o,year:"numeric"}):n.toLocaleDateString()},t}(r),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(r);function s(e,t){var n,r,s=[new i(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)],l=t;try{for(var c=(0,o.__values)(s),u=c.next();!u.done;u=c.next()){l=u.value.format(e,l)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return l}},11512:(e,t,n)=>{n.d(t,{$J:()=>d,$T:()=>f,$l:()=>u,Ij:()=>c,R8:()=>l,_U:()=>g,iQ:()=>a,nL:()=>m,q6:()=>p,xg:()=>s,zS:()=>y,zl:()=>v});var o=n(79490),r=n(47328),i=n(95312);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e.className?e.className.split(/\s+/g):[];r.push.apply(r,(0,o.__spreadArray)([],(0,o.__read)(t),!1)),e.className=r.join(" ")}function s(){return{style:{}}}function l(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)}function c(){return"__ac-".concat(i.kk.generate())}function u(e,t){return"string"==typeof e?e:t}function d(e,t){return"number"==typeof e?e:t}function p(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t}function h(e,t,n){for(var o=e;o.length<n;)o=t+o;return o}function g(e){var t=/^(\d{4})-(\d{2})-(\d{2})$/.exec(e);if(t&&4===t.length){var n=parseInt(t[1],10),o=parseInt(t[2],10)-1,r=parseInt(t[3],10);return new Date(n,o,r)}}function f(e){var t=e.getFullYear(),n=h((e.getMonth()+1).toString(),"0",2),o=h(e.getDate().toString(),"0",2);return"".concat(t,"-").concat(n,"-").concat(o)}function m(e,t,n){if(!t)return n;var o=(0,r.l)(e,t);return void 0!==o?o:n}function y(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255,o=parseInt(t[2],16),r=parseInt(t[3],16),i=parseInt(t[4],16);return"rgba(".concat(o,",").concat(r,",").concat(i,",").concat(n,")")}}return e}function v(e,t){return void 0===t&&(t={}),Object.entries(t).forEach((function(t){var n=(0,o.__read)(t,2),r=n[0],i=n[1],a=void 0!==i?i.toString():"";e=e.replace(new RegExp("{{".concat(r,"}}"),"g"),a)})),e}},69323:(e,t,n)=>{n.d(t,{hq:()=>k,Ht:()=>P});var o=n(79490),r=n(23489),i=n(33467),a=n(23379),s=n(77909),l=n(74842),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t}(s.bU),u=function(){function e(){}return e.createInstance=function(t){var n=e._entries.get(t);return n?new n:void 0},e.registerEntityType=function(t){e._entries.set(t.jsonTypeName,t)},e.unregisterEntityType=function(t){var n="string"==typeof t?t:t.jsonTypeName;e._entries.delete(n)},e.getDescriptors=function(){var t,n,r=[];try{for(var i=(0,o.__values)(e._entries.values()),a=i.next();!a.done;a=i.next()){var l=a.value;r.push(new s.E$(new l))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e._entries=new Map,e}(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.getValue(t.nameProperty)},set:function(e){this.setValue(t.nameProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"MentionedPerson"},t.idProperty=new s.XB(s.uq.v1_0,"id"),t.nameProperty=new s.XB(s.uq.v1_0,"name").setContentType("text"),t}(s.jB),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setValue(t.textProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mentioned",{get:function(){return this.getValue(t.mentionedProperty)},set:function(e){this.setValue(t.mentionedProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="mention",t.textProperty=new s.XB(s.uq.v1_0,"text"),t.mentionedProperty=new s.kR(s.uq.v1_0,"mentioned",(function(e){return new d})),t}(c),h=n(11512),g=n(95312),f=function(e){function t(t,n){var o=e.call(this,t,n,(function(e){if(e){var t=e.type;if("string"==typeof t)return t?u.createInstance(t):void 0}}))||this;return o.targetVersion=t,o.name=n,o}return(0,o.__extends)(t,e),t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"object",validValues:u.getDescriptors().sort((function(e,t){return e.name.localeCompare(t.name)}))}],isArray:!0}},t}(s.m2),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.getValue(t.widthProperty)},set:function(e){this.setValue(t.widthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entities",{get:function(){return this.getValue(t.entitiesProperty)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"TeamsCardProperties"},t.widthProperty=new s.XY(s.uq.v1_0,"width",[{value:"full"}]),t.entitiesProperty=new f(s.uq.v1_0,"entities"),t}(s.jB);u.registerEntityType(p);var y=n(80832),v=n(90996),C=n(8520),b=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new y.L(t),t._actionCollection.onShouldDisplayBuiltInOverflowActionButton=function(e){return t.shouldDisplayBuiltInOverflowActionButton(e)},t._actionCollection.onShouldDisplayBuiltInOverflowActionMenu=function(e){return t.shouldDisplayBuiltInOverflowActionMenu(e)},t._actionCollection.onDisplayOverflowActionMenu=function(e,n){t.displayOverflowActionMenu(e,n)},t}return(0,o.__extends)(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.parseActions(t,n)},t.prototype.parseActions=function(e,t){this._actionCollection.parse(e.actions,t)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRenderActions=function(){var e=this._actionCollection.render(this.hostConfig.actions.actionsOrientation);return e?C.createElement(C.Fragment,{key:"actions".concat(this.key)},(0,l.JM)(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},i.t4.Horizontal,{padding:{},margin:{}}),e):null},t.prototype.getHasExpandedAction=function(){return 0!==this.renderedActionCount&&(1===this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(v.mc.maxHeightProperty)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0===this._actionCollection.getActionCount()||t.parent===this&&t.isExpandableInlineElement},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var n=e.prototype.getAllInputs.call(this,t);return t&&n.push.apply(n,(0,o.__spreadArray)([],(0,o.__read)(this._actionCollection.getAllInputs(t)),!1)),n},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(this._actionCollection.getResourceInformation()),!1)),t},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);return n||(n=this._actionCollection.getElementById(t)),n},t.prototype.isResponsive=function(){var t=e.prototype.isResponsive.call(this);return t||(t=this._actionCollection.hasResponsiveElements()),t},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(t),!1),["actions"],!1)},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(v.mc),E=function(e){function t(t,n){var o=e.call(this,t,n,void 0)||this;return o.targetVersion=t,o.name=n,o}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==o){if(o instanceof r.e)return o;n.logParseEvent(e,i.iV.ActionTypeNotAllowed,a.D.errors.actionTypeNotAllowed(o.getJsonTypeName()))}n.logParseEvent(e,i.iV.PropertyCantBeNull,a.D.errors.propertyMustBeSet("action"))},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,n?n.toJSON(o):void 0,void 0,!0)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"object",validValues:[new s.E$(new r.e)]}],isArray:!1}},t}(s.BG),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e),e&&e.setParent(this.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userIds",{get:function(){return this.getValue(t.userIdsProperty)},set:function(e){this.setValue(t.userIdsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"RefreshDefinition"},t.actionProperty=new E(s.uq.v1_4,"action"),t.userIdsProperty=new s.g7(s.uq.v1_4,"userIds"),t}(s.jB),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getSchemaKey=function(){return"AuthCardButton"},Object.defineProperty(t.prototype,"type",{get:function(){return this.getValue(t.typeProperty)},set:function(e){this.setValue(t.typeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"image",{get:function(){return this.getValue(t.imageProperty)},set:function(e){this.setValue(t.imageProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),t.typeProperty=new s.XB(s.uq.v1_4,"type"),t.titleProperty=new s.XB(s.uq.v1_4,"title").setContentType("text"),t.imageProperty=new s.XB(s.uq.v1_4,"image"),t.valueProperty=new s.XB(s.uq.v1_4,"value"),t}(s.jB),I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getSchemaKey=function(){return"TokenExchangeResource"},Object.defineProperty(t.prototype,"id",{get:function(){return this.getValue(t.idProperty)},set:function(e){this.setValue(t.idProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uri",{get:function(){return this.getValue(t.uriProperty)},set:function(e){this.setValue(t.uriProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"providerId",{get:function(){return this.getValue(t.providerIdProperty)},set:function(e){this.setValue(t.providerIdProperty,e)},enumerable:!1,configurable:!0}),t.idProperty=new s.XB(s.uq.v1_4,"id"),t.uriProperty=new s.XB(s.uq.v1_4,"uri"),t.providerIdProperty=new s.XB(s.uq.v1_4,"providerId"),t}(s.jB),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getSchemaKey=function(){return"Authentication"},Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setValue(t.textProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connectionName",{get:function(){return this.getValue(t.connectionNameProperty)},set:function(e){this.setValue(t.connectionNameProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"buttons",{get:function(){return this.getValue(t.buttonsProperty)},set:function(e){this.setValue(t.buttonsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this.getValue(t.tokenExchangeResourceProperty)},set:function(e){this.setValue(t.tokenExchangeResourceProperty,e)},enumerable:!1,configurable:!0}),t.textProperty=new s.XB(s.uq.v1_4,"text").setContentType("text"),t.connectionNameProperty=new s.XB(s.uq.v1_4,"connectionName"),t.buttonsProperty=new s.m2(s.uq.v1_4,"buttons",(function(e){return new S})),t.tokenExchangeResourceProperty=new s.kR(s.uq.v1_4,"tokenExchangeResource",(function(e){return new I}),!0),t}(s.jB),T=function(e){function t(t,n){var o=e.call(this,t,n,s.uq.v1_0)||this;return o.targetVersion=t,o.name=n,o}return(0,o.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=s.Rx.parse(t[this.name],n);return void 0===o&&(o=s.uq.latest,n.logParseEvent(e,i.iV.InvalidPropertyValue,a.D.errors.invalidCardVersion(o.toString()))),o},t.prototype.toJSON=function(e,t,n,o){void 0!==n&&o.serializeValue(t,this.name,n.toString())},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:s.uq.getAllDeclaredVersions().map((function(e){return e.toString()}))}],defaultValue:this.defaultValue.toString(),isArray:!1}},t}(s.BG),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"}],isArray:!1}},t}(s.Zn),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.getSchemaKey=function(){return"CardMetadata"},t.webUrlProperty=new s.XB(s.uq.v1_4,"webUrl").setContentType("link"),t}(s.jB),k=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._mentionsMap=new Map,t.isFocusable=!0,t}return(0,o.__extends)(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(v.XP.bleedProperty),t.remove(v.XP.showBorderProperty),t.remove(v.XP.roundedCornersProperty),t.remove(l.hA.heightProperty),t.remove(l.hA.horizontalAlignmentProperty),t.remove(l.hA.separatorProperty),t.remove(l.hA.spacingProperty),t.remove(l.hA.targetWidthProperty),t.remove(l.hA.targetWidthProperty)},Object.defineProperty(t.prototype,"version",{get:function(){return this.getValue(t.versionProperty)},set:function(e){this.setValue(t.versionProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fallbackText",{get:function(){return this.getValue(t.fallbackTextProperty)},set:function(e){this.setValue(t.fallbackTextProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"speak",{get:function(){return this.getValue(t.speakProperty)},set:function(e){this.setValue(t.speakProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e),e&&(e.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"authentication",{get:function(){return this.getValue(t.authenticationProperty)},set:function(e){this.setValue(t.authenticationProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"msTeams",{get:function(){return this.getValue(t.msTeamsProperty)},set:function(e){this.setValue(t.msTeamsProperty,e),this.computeMentionsMap()},enumerable:!1,configurable:!0}),t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major===this.version.major&&this.maxVersion.minor<this.version.minor)},t.prototype.getRootCard=function(){if(!this.parent)return this;var e=this.getRootObject();return e instanceof t?e:this},t.prototype.getCardPayloadMentionEntities=function(){var e,t,n=null!==(t=null===(e=this.msTeams)||void 0===e?void 0:e.entities)&&void 0!==t?t:[];return n.length>0?n.filter((function(e){return e instanceof p})):[]},t.prototype.computeMentionsMap=function(){var e=this;this._mentionsMap=new Map,this.getCardPayloadMentionEntities().forEach((function(t){t.text&&e._mentionsMap.set(t.text,t)}))},t.prototype.shouldDisplayBuiltInOverflowActionButton=function(e){var n,o=null!==(n=this.getRootCard().onShouldDisplayBuiltInOverflowActionButton)&&void 0!==n?n:t.onShouldDisplayBuiltInOverflowActionButton;return void 0===o||o(e.getActions(),e.isAtRootLevel)},t.prototype.shouldDisplayBuiltInOverflowActionMenu=function(e){var n,o=null!==(n=this.getRootCard().onShouldDisplayBuiltInOverflowActionMenu)&&void 0!==n?n:t.onShouldDisplayBuiltInOverflowActionMenu;return void 0===o||o(e.isAtRootLevel)},t.prototype.displayOverflowActionMenu=function(e,n){var o,r=null!==(o=this.getRootCard().onDisplayOverflowActionMenu)&&void 0!==o?o:t.onDisplayOverflowActionMenu;void 0!==r&&r(e.getActions(),n)},t.prototype.actionExecuted=function(e){var n,o=null!==(n=this.getRootCard().onExecuteAction)&&void 0!==n?n:t.onExecuteAction;o&&o(e)},t.prototype.elementVisibilityChanged=function(e){var n,o=null!==(n=this.getRootCard().onElementVisibilityChanged)&&void 0!==n?n:t.onElementVisibilityChanged;o&&o(e)},t.prototype.internalRender=function(t){return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,this._fallbackCard.render()):e.prototype.internalRender.call(this)},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),(0,h.iQ)(t,this.hostConfig.makeCssClassName("ac-adaptiveCard")),this.isFocusable&&(t.tabIndex=0),this.speak&&(t["aria-label"]=this.speak)},t.prototype.getDefaultSerializationContext=function(){return new l.Au(this.version)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.internalParse=function(n,o){this._fallbackCard=void 0;var r=o.parseElement(void 0,n.fallback,this.forbiddenChildElements(),!this.isDesignMode());r&&(this._fallbackCard=new t,this._fallbackCard.addItem(r)),e.prototype.internalParse.call(this,n,o),this.computeMentionsMap()},t.prototype.internalToJSON=function(n,o){this.setValue(t.versionProperty,o.targetVersion),e.prototype.internalToJSON.call(this,n,o)},t.prototype.getHasBackground=function(e){return void 0===e&&(e=!1),!0},t.prototype.getHasBorder=function(){return!1},t.prototype.getHasRoundedCorners=function(){return!1},t.prototype.getDefaultPadding=function(){return new g.pT(i.Kz.Padding,i.Kz.Padding,i.Kz.Padding,i.Kz.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.processMarkdown=function(e){var n;if(this.markdownProcessor){var r=(0,o.__assign)((0,o.__assign)({},e),{mentionsMap:this._mentionsMap});return{didProcess:!0,output:this.markdownProcessor.processMarkdown(r)}}var i={didProcess:!1},a=null!==(n=this.onProcessMarkdown)&&void 0!==n?n:t.onProcessMarkdown;return a&&a(e.text,e.properties,i),i},t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[y.L.getActionsPropertyDescriptor(t,this.getJsonTypeName())],!1)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!==this.getValue(l.hA.typeNameProperty)&&t.addFailure(this,i.iV.MissingCardType,a.D.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,i.iV.UnsupportedCardVersion,a.D.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):t.addFailure(this,i.iV.PropertyCantBeNull,a.D.errors.propertyMustBeSet("version")),this.speak||t.addFailure(this,i.iV.PropertyShouldBeSet,a.D.errors.speakPropertyShouldBeSet())},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},t.prototype.renderImage=function(n,o){var r;if(this.parent)return this.parent.renderImage(n,o);var i=null!==(r=this.onRenderImage)&&void 0!==r?r:t.onRenderImage;return i?i(n,o):e.prototype.renderImage.call(this,n,o)},t.prototype.renderAnchor=function(n,o){var r;if(this.parent)return this.parent.renderAnchor(n,o);var i=null!==(r=this.onRenderAnchor)&&void 0!==r?r:t.onRenderAnchor;return i?i(n,o):e.prototype.renderAnchor.call(this,n,o)},t.prototype.formatDate=function(n){var o;if(this.parent)return this.parent.formatDate(n);var r=null!==(o=this.onFormatDate)&&void 0!==o?o:t.onFormatDate;return r?r(n):e.prototype.formatDate.call(this,n)},t.prototype.processUrl=function(n){var o;if(this.parent)return this.parent.processUrl(n);var r=null!==(o=this.onProcessUrl)&&void 0!==o?o:t.onProcessUrl;return r?r(n):e.prototype.processUrl.call(this,n)},t.prototype.dataQuery=function(n){var o;if(this.parent)return this.parent.dataQuery(n);var r=null!==(o=this.onDataQuery)&&void 0!==o?o:t.onDataQuery;return r?r(n):e.prototype.dataQuery.call(this,n)},Object.defineProperty(t.prototype,"isInSubCard",{get:function(){return!!this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="https://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new x(s.uq.v1_0,"$schema",(function(e,n,o,r){return t.schemaUrl}),(function(e,n,o,r,i){i.serializeValue(o,n.name,t.schemaUrl)})),t.versionProperty=new T(s.uq.v1_0,"version"),t.fallbackTextProperty=new s.XB(s.uq.v1_0,"fallbackText").setContentType("text"),t.speakProperty=new s.XB(s.uq.v1_0,"speak").setContentType("text"),t.refreshProperty=new s.kR(s.uq.v1_4,"refresh",(function(e){return new A}),!0),t.authenticationProperty=new s.kR(s.uq.v1_4,"authentication",(function(e){return new P}),!0),t.msTeamsProperty=new s.kR(s.uq.v1_0,"msTeams",(function(e){return new m})),t.metadataProperty=new s.kR(s.uq.v1_4,"metadata",(function(e){return new w})),t}(b)},65518:(e,t,n)=>{n.d(t,{y:()=>c});var o=n(79490),r=n(93609),i=n(95312),a=n(33467),s=n(23379),l=n(77909),c=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t.allowVerticalOverflow=!1,t}return(0,o.__extends)(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),this.isSelectable||n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"_selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive},t.prototype.getSpacings=function(t){e.prototype.getSpacings.call(this,t);var n=new i.$i;this.getEffectivePadding()&&(n=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),t.padding={top:n.top,right:n.right,bottom:n.bottom,left:n.left}},t.prototype.getMainAction=function(){return this._selectAction},t.prototype.customizeProps=function(e){},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.forbiddenChildElements=function(){return[]},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this);for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).releaseDOMResources()},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var o=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&o.isInteractive&&t.addFailure(this,a.iV.InteractivityNotAllowed,s.D.errors.interactivityNotAllowed()),this.isElementAllowed(o)||t.addFailure(this,a.iV.InteractivityNotAllowed,s.D.errors.elementTypeNotAllowed(o.getJsonTypeName())),o.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<this.getItemCount();n++){var r=this.getItemAt(n);r.shouldRenderForTargetWidth()&&t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(r.getAllInputs(e)),!1))}return t},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getItemCount();n++){var r=this.getItemAt(n);r.shouldRenderForTargetWidth()&&t.push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(r.getAllActions()),!1))}return this._selectAction&&t.push(this._selectAction),t},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e.push.apply(e,(0,o.__spreadArray)([],(0,o.__read)(this.getItemAt(t).getResourceInformation()),!1));return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var o=0;o<this.getItemCount();o++){var r=this.getItemAt(o);if(r.shouldRenderForTargetWidth()&&(n=r.getElementById(t)),n)break}return n},t.prototype.isResponsive=function(){if(e.prototype.isResponsive.call(this))return!0;for(var t=0;t<this.getItemCount();t++){if(this.getItemAt(t).isResponsive())return!0}return!1},t.selectActionProperty=new r.c(l.uq.v1_1,"selectAction",["Action.ShowCard"]),t}(n(74842).hA)},90996:(e,t,n)=>{n.d(t,{mc:()=>w,XP:()=>P,_I:()=>g,oC:()=>I,zh:()=>v});var o,r=n(79490),i=n(8520),a=n(33467),s=n(77909),l=n(74842),c=n(95312),u=n(11512),d=n(23379),p=function(){function e(){this._observedElements=new Map}return e.prototype.getResizeObserver=function(){var e=this;return this._resizeObserver||(this._resizeObserver=new ResizeObserver((function(t){return e.resizeObserverCallback(t)}))),this._resizeObserver},e.prototype.resizeObserverCallback=function(e){var t,n;try{for(var o=(0,r.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value,s=this._observedElements.get(a.target);s&&s(a.target,{left:a.contentRect.left,top:a.contentRect.top,width:a.contentRect.width,height:a.contentRect.height})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}},e.prototype.observe=function(e,t){this.unobserve(e),this._observedElements.set(e,t),this.getResizeObserver().observe(e)},e.prototype.unobserve=function(e){var t=this.getResizeObserver();this._observedElements.has(e)&&(this._observedElements.delete(e),t.unobserve(e))},e.prototype.disconnect=function(){this.getResizeObserver().disconnect(),this._observedElements.clear()},e.prototype.setResizeObserver=function(e){this._resizeObserver!==e&&(this._resizeObserver&&this._resizeObserver.disconnect(),this._resizeObserver=e)},e}(),h=n(65518),g=function(e){function t(t,n,o,r){var i=e.call(this,t,n,[{value:a.xO.Default},{value:a.xO.Emphasis},{targetVersion:s.uq.v1_2,value:a.xO.Accent},{targetVersion:s.uq.v1_2,value:a.xO.Good},{targetVersion:s.uq.v1_2,value:a.xO.Attention},{targetVersion:s.uq.v1_2,value:a.xO.Warning}],o,r)||this;return i.targetVersion=t,i.name=n,i.defaultValue=o,i.onGetInitialValue=r,i}return(0,r.__extends)(t,e),t}(s.XY),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"targetWidth",{get:function(){return this.getValue(t.targetWidthProperty)},set:function(e){this.setValue(t.targetWidthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"type",valueTypes:[{type:"string"}],isArray:!1,requiredValue:this.getSchemaKey(),schemaVersion:s.uq.v1_5}],!1)},t.prototype.renderItem=function(e,t){return i.createElement(t.Render,{key:t.key})},t.prototype.isResponsive=function(){return void 0!==this.targetWidth},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowContainersToBleed",{get:function(){return!0},enumerable:!1,configurable:!0}),t.targetWidthProperty=new l.n7(s.uq.v1_5,"targetWidth"),t}(s.bU),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.prototype.apply=function(e,t){switch(t.style.display="flex",t.style.flexDirection="column",e.getEffectiveVerticalContentAlignment()){case a.sx.Center:t.style.justifyContent="center";break;case a.sx.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}},t.jsonTypeName="Layout.Stack",t}(f),y=function(e){function t(t,n,o){var r=e.call(this,t,n,o)||this;return r.targetVersion=t,r.name=n,r.defaultValue=o,r}return(0,r.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=(0,r.__values)(s),u=l.next();!u.done;u=l.next()){var d=u.value;try{a.push(c.zg.parse(d))}catch(e){"auto"!==d&&"stretch"!==d||a.push(d)}}}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return a},t.prototype.toJSON=function(e,t,n,o){var i,s,l=[];if(Array.isArray(n))try{for(var u=(0,r.__values)(n),d=u.next();!d.done;d=u.next()){var p=d.value;p instanceof c.zg?p.unit===a.Y2.Pixel?l.push("".concat(p.physicalSize,"px")):l.push(p.physicalSize):"auto"!==p&&"stretch"!==p||l.push(p)}}catch(e){i={error:e}}finally{try{d&&!d.done&&(s=u.return)&&s.call(u)}finally{if(i)throw i.error}}o.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"number"},{type:"string"}],isArray:!0}},t}(s.BG),v=new s.XB(s.uq.v1_5,"grid.area"),C=function(e){function t(t){var n=e.call(this)||this;return n.name=t,n}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this.getValue(t.nameProperty)},set:function(e){this.setValue(t.nameProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"column",{get:function(){return this.getValue(t.columnProperty)},set:function(e){this.setValue(t.columnProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return this.getValue(t.columnSpanProperty)},set:function(e){this.setValue(t.columnSpanProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"row",{get:function(){return this.getValue(t.rowProperty)},set:function(e){this.setValue(t.rowProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSpan",{get:function(){return this.getValue(t.rowSpanProperty)},set:function(e){this.setValue(t.rowSpanProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return t.jsonTypeName},t.jsonTypeName="GridArea",t.nameProperty=new s.XB(s.uq.v1_5,"name"),t.columnProperty=new s.Uy(s.uq.v1_5,"column",1),t.columnSpanProperty=new s.Uy(s.uq.v1_5,"columnSpan",1),t.rowProperty=new s.Uy(s.uq.v1_5,"row",1),t.rowSpanProperty=new s.Uy(s.uq.v1_5,"rowSpan",1),t}(s.jB),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"columns",{get:function(){return this.getValue(t.columnsProperty)},set:function(e){this.setValue(t.columnsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"areas",{get:function(){return this.getValue(t.areasProperty)},set:function(e){this.setValue(t.areasProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnSpacing",{get:function(){return this.getValue(t.columnSpacingProperty)},set:function(e){this.setValue(t.columnSpacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSpacing",{get:function(){return this.getValue(t.rowSpacingProperty)},set:function(e){this.setValue(t.rowSpacingProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.prototype.getEffectiveAreas=function(){return 0===this.areas.length?[t.defaultArea]:this.areas},t.prototype.apply=function(e,n){var o,i,s,l;n.style.display="grid",n.style.columnGap=e.hostConfig.getEffectiveSpacing(this.columnSpacing)+"px",n.style.rowGap=e.hostConfig.getEffectiveSpacing(this.rowSpacing)+"px";var c=this.columns.map((function(e){return"auto"===e?e:e.physicalSize<=0?"auto":e.unit===a.Y2.Pixel?"minmax(0, ".concat(e.physicalSize,"px)"):"minmax(0, ".concat(Math.min(100,e.physicalSize),"%)")})),u=this.getEffectiveAreas(),d=1;u.forEach((function(e){var t=e.row+e.rowSpan-1;t>d&&(d=t)}));for(var p=[],h=0;h<d;h++)p.push(new Array(c.length).fill(t.defaultArea.name));try{for(var g=(0,r.__values)(u),f=g.next();!f.done;f=g.next()){var m=f.value;if(m.name){var y=m.row-1,v=y+m.rowSpan,C=m.column-1,b=C+m.columnSpan;for(h=y;h<v;h++)for(var E=C;E<b;E++)p[h][E]=m.name}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}var A="";try{for(var S=(0,r.__values)(p),I=S.next();!I.done;I=S.next()){var P=I.value;A+='"'.concat(P.join(" "),'"\n')}}catch(e){s={error:e}}finally{try{I&&!I.done&&(l=S.return)&&l.call(S)}finally{if(s)throw s.error}}n.style.gridTemplateColumns=c.join(" "),n.style.gridTemplateAreas=A},t.prototype.renderItem=function(e,t){var n,o=this.getEffectiveAreas(),r=t.getValue(v),a=null!==(n=this.areas.find((function(e){return e.name===r})))&&void 0!==n?n:o[0];return i.createElement("div",{style:{overflow:"hidden",display:"flex",flexDirection:"column",gridArea:a.name},key:t.key},i.createElement(t.Render,null))},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowContainersToBleed",{get:function(){return!1},enumerable:!1,configurable:!0}),t.defaultArea=new C("."),t.jsonTypeName="Layout.AreaGrid",t.columnsProperty=new y(s.uq.v1_5,"columns",[]),t.areasProperty=new s.m2(s.uq.v1_5,"areas",(function(){return new C})),t.columnSpacingProperty=new s.fX(s.uq.v1_5,"columnSpacing",a.Kz,a.Kz.Default),t.rowSpacingProperty=new s.fX(s.uq.v1_5,"rowSpacing",a.Kz,a.Kz.Default),t}(f);!function(e){e[e.Fit=0]="Fit",e[e.Fill=1]="Fill"}(o||(o={}));var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalItemsAlignment",{get:function(){return this.getValue(t.horizontalItemsAlignmentProperty)},set:function(e){this.setValue(t.horizontalItemsAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalItemsAlignment",{get:function(){return this.getValue(t.verticalItemsAlignmentProperty)},set:function(e){this.setValue(t.verticalItemsAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemFit",{get:function(){return this.getValue(t.itemFitProperty)},set:function(e){this.setValue(t.itemFitProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minItemWidth",{get:function(){return this.getValue(t.minItemWidthProperty)},set:function(e){this.setValue(t.minItemWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxItemWidth",{get:function(){return this.getValue(t.maxItemWidthProperty)},set:function(e){this.setValue(t.maxItemWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"itemWidth",{get:function(){return this.getValue(t.itemWidthProperty)},set:function(e){this.setValue(t.itemWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnSpacing",{get:function(){return this.getValue(t.columnSpacingProperty)},set:function(e){this.setValue(t.columnSpacingProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rowSpacing",{get:function(){return this.getValue(t.rowSpacingProperty)},set:function(e){this.setValue(t.rowSpacingProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.prototype.renderItem=function(e,t){var n,r=Math.max(this.minItemWidth,0),a=void 0!==this.maxItemWidth&&this.maxItemWidth>r?this.maxItemWidth:void 0,s=void 0!==this.itemWidth&&this.itemWidth>r?this.itemWidth:void 0,l=this.minItemWidth?"calc(min(".concat(r,"px, 100%))"):"0";if(this.itemFit===o.Fill)n="1 1 auto";else n=void 0;return i.createElement("div",{style:{minWidth:l,maxWidth:a?"".concat(a,"px"):void 0,width:s?"".concat(s,"px"):void 0,overflow:"hidden",flex:n,display:"flex",flexDirection:"column"},key:t.key},i.createElement(t.Render,null))},t.prototype.apply=function(e,t){switch(t.style.display="flex",t.style.flexWrap="wrap",t.style.justifyContent="center",t.style.columnGap=e.hostConfig.getEffectiveSpacing(this.columnSpacing)+"px",t.style.rowGap=e.hostConfig.getEffectiveSpacing(this.rowSpacing)+"px",e.getEffectiveVerticalContentAlignment()){case a.sx.Center:t.style.alignContent="center";break;case a.sx.Bottom:t.style.alignContent="flex-end";break;default:t.style.alignContent="flex-start"}switch(this.horizontalItemsAlignment){case a.OD.Center:t.style.justifyContent="center";break;case a.OD.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}switch(this.verticalItemsAlignment){case a.sx.Center:t.style.alignItems="center";break;case a.sx.Bottom:t.style.alignItems="flex-end";break;default:t.style.alignItems="flex-start"}},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowContainersToBleed",{get:function(){return!1},enumerable:!1,configurable:!0}),t.jsonTypeName="Layout.Flow",t.horizontalItemsAlignmentProperty=new s.fX(s.uq.v1_5,"horizontalItemsAlignment",a.OD,a.OD.Center),t.verticalItemsAlignmentProperty=new s.fX(s.uq.v1_5,"verticalItemsAlignment",a.sx,a.sx.Top),t.itemFitProperty=new s.fX(s.uq.v1_5,"itemFit",o,o.Fit),t.minItemWidthProperty=new s.l5(s.uq.v1_5,"minItemWidth",0),t.maxItemWidthProperty=new s.l5(s.uq.v1_5,"maxItemWidth"),t.itemWidthProperty=new s.l5(s.uq.v1_5,"itemWidth"),t.columnSpacingProperty=new s.fX(s.uq.v1_5,"columnSpacing",a.Kz,a.Kz.Default),t.rowSpacingProperty=new s.fX(s.uq.v1_5,"rowSpacing",a.Kz,a.Kz.Default),t}(f),A=new Map([[m.jsonTypeName,function(){return new m}],[E.jsonTypeName,function(){return new E}],[b.jsonTypeName,function(){return new b}]]),S=function(e){function t(t,n){var o=e.call(this,t,n,void 0)||this;return o.targetVersion=t,o.name=n,o}return(0,r.__extends)(t,e),t.prototype.parse=function(e,t,n){var o,i,a=[],s=t[this.name];if(Array.isArray(s))try{for(var l=(0,r.__values)(s),c=l.next();!c.done;c=l.next()){var u=c.value,d=A.get(u.type);if(d){var p=d();p.parse(u,n),a.push(p)}}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return a.length>0?a:void 0},t.prototype.toJSON=function(e,t,n,o){o.serializeArray(t,this.name,n)},t.prototype.getDescriptor=function(e){var t,n,o=[];try{for(var i=(0,r.__values)(A.values()),a=i.next();!a.done;a=i.next()){var l=(0,a.value)(),c=new s.E$(l);o.push(c)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{valueTypes:[{type:"object",validValues:o}],isArray:!0}},t}(s.BG),I=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t._resizeManager=new p,t._isFirstRender=!0,t._containerSize=void 0,t.enableAutomaticReflow=!1,t}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showBorder",{get:function(){return this.getValue(t.showBorderProperty)},set:function(e){this.setValue(t.showBorderProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"roundedCorners",{get:function(){return this.getValue(t.roundedCornersProperty)},set:function(e){this.setValue(t.roundedCornersProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layouts",{get:function(){return this.getValue(t.layoutsProperty)},set:function(e){this.setValue(t.layoutsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isResizeTracked",{get:function(){return this.enableAutomaticReflow&&this.isResponsive()},enumerable:!1,configurable:!0}),t.prototype.onRef=function(e){var t=this;this.resizeManager.disconnect(),this.isResizeTracked?(this.renderedElement=null!=e?e:void 0,this.renderedElement&&this.enableAutomaticReflow&&this.resizeManager.observe(this.renderedElement,(function(e,n){var o=t._isFirstRender,r=t.hostConfig.getHostWidthForPixelWidth(n.width);t._isFirstRender=!1,t._containerSize=n,(t.hostWidth!==r||o&&c.h$.allowDelayedContainerRendering)&&(t.hostWidth=r,t.updateLayout())}))):this.renderedElement=null!=e?e:void 0},Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(t.styleProperty)},enumerable:!1,configurable:!0}),t.prototype.providesDesignModeElement=function(){return!0},t.prototype.getEffectiveLayout=function(){var e,n=this,o=null!==(e=this.layouts)&&void 0!==e?e:[],r=o.find((function(e){return!!e.targetWidth&&e.targetWidth.matches(n.hostWidth)}));return r||(r=o.find((function(e){return!e.targetWidth}))),null!=r?r:t._defaultLayout},t.prototype.applyBorder=function(e){if(this.getHasBorder()&&!this.isBleeding()){var t=this.getEffectiveStyleDefinition();t.borderColor&&(e.style.border="1px solid ".concat((0,u.zS)(t.borderColor)))}},t.prototype.applyRoundedCorners=function(e){this.getHasRoundedCorners()&&(e.style.borderRadius="".concat(this.hostConfig.roundedCornerRadius,"px"),e.style.overflow="hidden")},t.prototype.applyBackground=function(e){if(this.getHasBackground()){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(t.backgroundColor){var n=(0,u.zS)(t.backgroundColor);n&&(e.style.backgroundColor=n)}}},t.prototype.getSpacings=function(t){if(e.prototype.getSpacings.call(this,t),this.getEffectivePadding()&&(t.padding=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.isBleeding()){var n=new c.pT;this.getImmediateSurroundingPadding(n);var o=this.hostConfig.paddingDefinitionToSpacingDefinition(n);t.margin={right:-o.right,left:-o.left,top:this.isDesignMode()?void 0:-o.top,bottom:this.isDesignMode()?void 0:-o.bottom}}},t.prototype.getSeparatorSpacings=function(t){if(e.prototype.getSeparatorSpacings.call(this,t),this.isBleeding()){var n=new c.pT;this.getImmediateSurroundingPadding(n);var o=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.separatorOrientation===a.t4.Horizontal&&(t.margin.left=-o.left,t.margin.right=-o.right)}else this.separatorOrientation===a.t4.Horizontal&&(t.margin.left=0,t.margin.right=0)},t.prototype.getSeparatorColor=function(t){return t||!this.parent?e.prototype.getSeparatorColor.call(this,t):e.prototype.getSeparatorColor.call(this,this.parent.getEffectiveStyleDefinition())},t.prototype.getHasBackground=function(e){void 0===e&&(e=!1);for(var n=this.parent;n;){var o=!1;if(o=!e&&(n instanceof w&&n.backgroundImage.isValid()),n instanceof t&&this.hasExplicitStyle&&(n.getEffectiveStyle()!==this.getEffectiveStyle()||o))return!0;n=n.parent}return!1},t.prototype.getHasBorder=function(){return"boolean"==typeof this.showBorder&&this.showBorder},t.prototype.getHasRoundedCorners=function(){return"boolean"==typeof this.roundedCorners&&this.roundedCorners},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new c.pT(a.Kz.Padding,a.Kz.Padding,a.Kz.Padding,a.Kz.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.internalRenderActions=function(){return null},t.prototype.applyLayout=function(e){this.getEffectiveLayout().apply(this,e)},t.prototype.internalRender=function(e){var t=this,n=this.hostConfig,o=(0,u.xg)();o.className=n.makeCssClassName("ac-container"),o.style.display="flex",o.style.flexDirection="column";var a=this.renderItems(),s={padding:{},margin:{}};if(this.getSpacings(s),o.style.paddingLeft=s.padding.left,o.style.paddingRight=s.padding.right,o.style.paddingTop=s.padding.top,o.style.paddingBottom=s.padding.bottom,o.style.marginLeft=s.margin.left,o.style.marginRight=s.margin.right,o.style.marginTop=s.margin.top,o.style.marginBottom=s.margin.bottom,this.applyBackground(o),this.applyBorder(o),this.applyRoundedCorners(o),this.customizeProps(o),0===a.length&&!this.isDesignMode()&&!this.renderIfEmpty)return null;var l=null;a.length>0?l=this.isResizeTracked&&this._isFirstRender&&c.h$.allowDelayedContainerRendering?null:a:this.isDesignMode()&&(l=this.createPlaceholderElement(this.localizeString(d.D.emptyElementText,{elementType:this.getJsonTypeName()})));var p=(0,u.xg)();return p.style.flex="1",this.applyLayout(p),i.createElement("div",(0,r.__assign)({},o,{ref:this.isDesignMode()||this.isResizeTracked?function(e){return t.onRef(e)}:void 0}),i.createElement("div",(0,r.__assign)({},p),l),this.internalRenderActions())},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var o=this.getValue(t.styleProperty);void 0!==o&&(this.hostConfig.containerStyles.getStyleByName(o)||n.addFailure(this,a.iV.InvalidPropertyValue,d.D.errors.invalidPropertyValue(o,"style")))},t.prototype.isResponsive=function(){var t,n;if(void 0!==this.layouts&&this.layouts.length>0)try{for(var o=(0,r.__values)(this.layouts),i=o.next();!i.done;i=o.next()){if(i.value.isResponsive())return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return e.prototype.isResponsive.call(this)},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){return a.sx.Top},Object.defineProperty(t.prototype,"resizeManager",{get:function(){return this._resizeManager},enumerable:!1,configurable:!0}),t.prototype.getSize=function(){return this._containerSize},t.styleProperty=new g(s.uq.v1_0,"style"),t.showBorderProperty=new s.gV(s.uq.v1_5,"showBorder",!1),t.roundedCornersProperty=new s.gV(s.uq.v1_5,"roundedCorners",!1),t.layoutsProperty=new S(s.uq.v1_5,"layouts"),t._defaultLayout=new m,t}(h.y),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"_bleed",{get:function(){return this.getValue(t.bleedProperty)},set:function(e){this.setValue(t.bleedProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minPixelHeight",{get:function(){return this.getValue(t.minHeightProperty)},set:function(e){this.setValue(t.minHeightProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalInsertItemAt=function(e,t,n){if(!n){if(e.parent)throw new Error(d.D.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(d.D.errors.elementTypeNotStandalone(e.getJsonTypeName()))}e.setParent(this);var o=this.getRawItems();t>=o.length||0===o.length?o.push(e):o.splice(t>=0?t:0,0,e)},t.prototype.adjustSize=function(t){e.prototype.adjustSize.call(this,t),void 0!==this.minPixelHeight&&(t.minHeight="".concat(this.minPixelHeight,"px"))},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return(!this.parent||this.parent.allowChildContainersToBleed)&&this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),t.prototype.addItem=function(e){this.internalInsertItemAt(e,this.getRawItems().length,!1)},t.prototype.insertItemAt=function(e,t){this.internalInsertItemAt(e,t,!1)},t.prototype.insertItemBefore=function(e,t){var n=this.getRawItems().indexOf(t);this.internalInsertItemAt(e,n,!1)},t.prototype.insertItemAfter=function(e,t){this.internalInsertItemAt(e,this.getRawItems().indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this.getRawItems(),n=t.indexOf(e);return n>=0&&(t.splice(n,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.isBleeding=function(){return(this.getHasBackground()||this.getHasBorder()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t),!1),[this.getItemsCollectionPropertyName()],!1)},t.bleedProperty=new s.gV(s.uq.v1_2,"bleed",!1),t.minHeightProperty=new s.l5(s.uq.v1_2,"minHeight"),t}(I),T=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t.isProcessed=!1,t}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillMode",{get:function(){return this.getValue(t.fillModeProperty)},set:function(e){this.setValue(t.fillModeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalAlignment",{get:function(){return this.getValue(t.horizontalAlignmentProperty)},set:function(e){this.setValue(t.horizontalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalAlignment",{get:function(){return this.getValue(t.verticalAlignmentProperty)},set:function(e){this.setValue(t.verticalAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"themedUrls",{get:function(){return this.getValue(t.themedUrlsProperty)},set:function(e){this.setValue(t.themedUrlsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.propertyChanged=function(n,o){e.prototype.propertyChanged.call(this,n,o),n===t.urlProperty&&(this.isProcessed=!1)},t.prototype.getSchemaKey=function(){return"BackgroundImage"},t.prototype.internalParse=function(t,n){if("string"!=typeof t)return e.prototype.internalParse.call(this,t,n);this.resetDefaultValues(),this.url=t},t.prototype.apply=function(e,n){var o,i,s=this.url;if(this.themedUrls)try{for(var l=(0,r.__values)(this.themedUrls),c=l.next();!c.done;c=l.next()){var u=c.value;if(u.url&&e.theme===u.theme){s=u.url;break}}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}if(this.url){switch(n.style.backgroundImage="url('".concat(e.preProcessPropertyValue(t.urlProperty,s),"')"),this.fillMode){case a.VZ.Repeat:n.style.backgroundRepeat="repeat";break;case a.VZ.RepeatHorizontally:n.style.backgroundRepeat="repeat-x";break;case a.VZ.RepeatVertically:n.style.backgroundRepeat="repeat-y";break;case a.VZ.Cover:default:n.style.backgroundRepeat="no-repeat",n.style.backgroundSize="cover"}switch(this.horizontalAlignment){case a.OD.Left:break;case a.OD.Center:n.style.backgroundPositionX="center";break;case a.OD.Right:n.style.backgroundPositionX="right"}switch(this.verticalAlignment){case a.sx.Top:break;case a.sx.Center:n.style.backgroundPositionY="center";break;case a.sx.Bottom:n.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){var e,t;if(this.url)return!0;if(this.themedUrls)try{for(var n=(0,r.__values)(this.themedUrls),o=n.next();!o.done;o=n.next()){if(o.value.url)return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},t.urlProperty=new s.XB(s.uq.v1_0,"url").setContentType("imageUrl"),t.fillModeProperty=new s.fX(s.uq.v1_2,"fillMode",a.VZ,a.VZ.Cover),t.horizontalAlignmentProperty=new s.fX(s.uq.v1_2,"horizontalAlignment",a.OD,a.OD.Left),t.verticalAlignmentProperty=new s.fX(s.uq.v1_2,"verticalAlignment",a.sx,a.sx.Top),t.themedUrlsProperty=new s.m2(s.uq.v1_5,"themedUrls",(function(e){return new l.x$})),t}(s.jB),x=function(e){function t(t,n){var o=e.call(this,t,n,(function(e){return new T}))||this;return o.targetVersion=t,o.name=n,o}return(0,r.__extends)(t,e),t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",contentType:"imageUrl"},{type:"object",validValues:[new s.E$(this.createInstance(),this.allowAdditionalProperties)]}],defaultValue:this.defaultValue,isArray:!1}},t}(s.kR),w=function(e){function t(){var t=e.apply(this,(0,r.__spreadArray)([],(0,r.__read)(arguments),!1))||this;return t._items=[],t._renderedItems=[],t}return(0,r.__extends)(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalContentAlignment",{get:function(){return this.getValue(t.verticalContentAlignmentProperty)},set:function(e){this.setValue(t.verticalContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rtl",{get:function(){return this.getValue(t.rtlProperty)},set:function(e){this.setValue(t.rtlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxPixelHeight",{get:function(){return this.getValue(t.maxHeightProperty)},set:function(e){this.setValue(t.maxHeightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!(!this.minPixelHeight||!this.backgroundImage.isValid())},enumerable:!1,configurable:!0}),t.prototype.getRawItems=function(){return this._items},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(t){var n=this;this.backgroundImage.isValid()&&(!this.backgroundImage.isProcessed&&this.processUrl({unprocessedUrl:this.backgroundImage.url,setProcessedUrl:function(e){n.backgroundImage.url=e,n.backgroundImage.isProcessed=!0,n.updateLayout()}})||this.backgroundImage.apply(this,t));e.prototype.applyBackground.call(this,t)},t.prototype.renderItem=function(e){return this.getEffectiveLayout().renderItem(this,e)},t.prototype.renderItems=function(){var e,t,n=[];this._renderedItems=[];try{for(var o=(0,r.__values)(this._items),i=o.next();!i.done;i=o.next()){var a=i.value;if(a.shouldRender()&&this.isElementAllowed(a)){var s=this.renderItem(a);s&&(n.push(s),this._renderedItems.push(a))}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return n},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),t.dir=this.isRtl()?"rtl":"ltr"},t.prototype.getHasBackground=function(t){return void 0===t&&(t=!1),!t&&this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this,t)},t.prototype.internalParse=function(t,n){var o,i;e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var a=t[this.getItemsCollectionPropertyName()];if(Array.isArray(a))try{for(var s=(0,r.__values)(a),l=s.next();!l.done;l=s.next()){var c=l.value,u=n.parseElement(this,c,this.forbiddenChildElements(),!this.isDesignMode());u&&this.internalInsertItemAt(u,this._items.length,!0)}}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);var o=this.getItemsCollectionPropertyName();n.serializeArray(t,o,this._items)},t.prototype.adjustSize=function(t){if(e.prototype.adjustSize.call(this,t),void 0!==this.maxPixelHeight){var n=void 0!==this.minPixelHeight?Math.max(this.minPixelHeight,this.maxPixelHeight):this.maxPixelHeight;t.maxHeight="".concat(n,"px"),t.overflowY="auto"}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getAdditionalPropertyDescriptors=function(t){var n=t.elementRegistry.getDescriptors(t,this.forbiddenChildElements(),[],!0,t.allowExtensionElementInGeneratedSchema);return(0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:this.getItemsCollectionPropertyName(),valueTypes:[{type:"object",validValues:n.sort((function(e,t){return e.name.localeCompare(t.name)}))}],isArray:!0,declaringClassName:this.constructor.name,schemaVersion:s.uq.v1_0,suggestedSchemaTypeName:"CardElementArray"}],!1)},t.prototype.getEffectivePadding=function(){return c.h$.removePaddingFromContainersWithBackgroundImage&&!this.getHasBackground(!0)?new c.pT:e.prototype.getEffectivePadding.call(this)},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof t)return e;e=e.parent}},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;var e=this.getParentContainer();return e?e.getEffectiveVerticalContentAlignment():a.sx.Top},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){var e,t;if(this._renderedItems&&this._renderedItems.length>0)try{for(var n=(0,r.__values)(this._renderedItems),o=n.next();!o.done;o=n.next()){var i=o.value;if(i.isVisible)return i}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.getLastVisibleRenderedItem=function(){if(this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){var t,n;try{for(var o=(0,r.__values)(this._items),i=o.next();!i.done;i=o.next()){var a=i.value;if(a.shouldRender())return a===e}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1},t.prototype.isLastElement=function(e){for(var t=this._items.length-1;t>=0;t--)if(this._items[t].shouldRender())return this._items[t]===e;return!1},t.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()===this.getEffectiveStyle())},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.clear=function(){this._items=[],this._renderedItems=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n,o,i=e.prototype.getActionById.call(this,t);if(!i&&(this.selectAction&&(i=this.selectAction.getActionById(t)),!i))try{for(var a=(0,r.__values)(this._items),s=a.next();!s.done;s=a.next()){var l=s.value;if(l.shouldRenderForTargetWidth()&&(i=l.getActionById(t)),i)break}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return i},Object.defineProperty(t.prototype,"allowSpaceBetweenElements",{get:function(){return this.getEffectiveLayout().allowSpaceBetweenElements},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowChildContainersToBleed",{get:function(){return this.getEffectiveLayout().allowContainersToBleed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new x(s.uq.v1_0,"backgroundImage"),t.verticalContentAlignmentProperty=new s.fX(s.uq.v1_1,"verticalContentAlignment",a.sx),t.rtlProperty=new s.gV(s.uq.v1_0,"rtl"),t.maxHeightProperty=new s.l5(s.uq.v1_5,"maxHeight"),t}(P)},70114:(e,t,n)=>{n.d(t,{_:()=>h});var o=n(79490),r=n(93609),i=n(95312),a=n(33467),s=n(23379),l=n(77909),c=n(74842),u=n(11512),d=function(e){function t(t,n,o,r){var i=e.call(this,t,n)||this;return i.targetVersion=t,i.name=n,i.internalName=o,i.fallbackProperty=r,i}return(0,o.__extends)(t,e),t.prototype.getInternalName=function(){return this.internalName},t.prototype.parse=function(e,t,n){var o,r=t[this.name];if(void 0===r)return this.defaultValue;var l=!1;if("string"==typeof r){try{var c=i.zg.parse(r,!0);c.unit===a.Y2.Pixel&&(o=c.physicalSize,l=!0)}catch(e){}!l&&this.fallbackProperty&&(l=this.fallbackProperty.isValidValue(r,n))}return l||n.logParseEvent(e,a.iV.InvalidPropertyValue,s.D.errors.invalidPropertyValue(r,this.name)),o},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:"".concat(n,"px"))},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:["auto","stretch",i.IO]}],defaultValue:"auto",isArray:!1}},t}(l.BG),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"allowExpand",{get:function(){return this.getValue(t.allowExpand)},set:function(e){this.setValue(t.allowExpand,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"TeamsImageProperties"},t.allowExpand=new l.gV(l.uq.v1_0,"allowExpand"),t}(l.jB),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(c.hA.heightProperty),n.add(t.pixelHeightProperty)},Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"altText",{get:function(){return this.getValue(t.altTextProperty)},set:function(e){this.setValue(t.altTextProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this.getValue(t.backgroundColorProperty)},set:function(e){this.setValue(t.backgroundColorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pixelWidth",{get:function(){return this.getValue(t.pixelWidthProperty)},set:function(e){this.setValue(t.pixelWidthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pixelHeight",{get:function(){return this.getValue(t.pixelHeightProperty)},set:function(e){this.setValue(t.pixelHeightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowExpand",{get:function(){return this.getValue(t.allowExpandProperty)},set:function(e){this.setValue(t.allowExpandProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"themedUrls",{get:function(){return this.getValue(t.themedUrlsProperty)},set:function(e){this.setValue(t.themedUrlsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width="".concat(this.pixelWidth,"px")),this.pixelHeight&&(e.style.height="".concat(this.pixelHeight,"px"));else if(this.maxHeight){switch(this.size){case a.or.Small:e.style.height="".concat(this.hostConfig.imageSizes.small,"px");break;case a.or.Large:e.style.height="".concat(this.hostConfig.imageSizes.large,"px");break;default:e.style.height="".concat(this.hostConfig.imageSizes.medium,"px")}e.style.maxHeight="".concat(this.maxHeight,"px")}else{switch(this.size){case a.or.Stretch:e.style.width="100%";break;case a.or.Auto:e.style.maxWidth="100%";break;case a.or.Small:e.style.width="".concat(this.hostConfig.imageSizes.small,"px");break;case a.or.Large:e.style.width="".concat(this.hostConfig.imageSizes.large,"px");break;case a.or.Medium:e.style.width="".concat(this.hostConfig.imageSizes.medium,"px")}e.style.maxHeight="100%"}},t.prototype.getEffectiveUrl=function(){var e,t;if(this.themedUrls)try{for(var n=(0,o.__values)(this.themedUrls),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.url&&this.theme===i.theme)return i.url}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return this.url},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getMainAction=function(){return this.selectAction},t.prototype.internalRender=function(e){var n=this.getEffectiveUrl();if(n){var o=this.hostConfig,r={style:({},{minWidth:"0"})};switch(r.className=o.makeCssClassName("ac-image"),this.applySize(r),this.style!==a.bs.Default&&(r.style.borderRadius=this.style===a.bs.Person?"50%":"".concat(this.hostConfig.roundedCornerRadius,"px"),r.style.backgroundPosition="50% 50%",r.style.backgroundRepeat="no-repeat"),this.getEffectiveHorizontalAlignment()){case a.OD.Center:r.style.alignSelf="center";break;case a.OD.Right:r.style.alignSelf="flex-end";break;default:r.style.alignSelf="flex-start"}var i=(0,u.zS)(this.backgroundColor);i&&(r.style.backgroundColor=i),r.src=this.preProcessPropertyValue(c.x$.urlProperty,n);var s=this.preProcessPropertyValue(t.altTextProperty);return s&&(r.alt=s),this.renderImage({allowExpand:this.allowExpand,isSelectable:void 0!==this.selectAction},r)}return this.isDesignMode()?this.createPlaceholderElement():null},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=function(){var e=this.getEffectiveUrl();return e?[{url:e,mimeType:"image"}]:[]},t.urlProperty=new l.XB(l.uq.v1_0,"url").setContentType("imageUrl"),t.altTextProperty=new l.XB(l.uq.v1_0,"altText",void 0,void 0,void 0,!0).setContentType("text"),t.backgroundColorProperty=new l.XB(l.uq.v1_1,"backgroundColor"),t.styleProperty=new l.fX(l.uq.v1_0,"style",a.bs,a.bs.Default),t.sizeProperty=new l.fX(l.uq.v1_0,"size",a.or,a.or.Auto),t.pixelWidthProperty=new d(l.uq.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new d(l.uq.v1_1,"height","pixelHeight",c.hA.heightProperty),t.selectActionProperty=new r.c(l.uq.v1_1,"selectAction",["Action.ShowCard"]),t.allowExpandProperty=new l.gV(l.uq.v1_2,"allowExpand",!1),t.msTeamsProperty=new l.kR(l.uq.v1_2,"msTeams",(function(e){return new p})),t.themedUrlsProperty=new l.m2(l.uq.v1_5,"themedUrls",(function(e){return new c.x$})),t}(c.hA)},40097:(e,t,n)=>{n.d(t,{r:()=>d});var o=n(79490),r=n(8520),i=n(23379),a=n(11512),s=n(33467),l=n(77909),c=n(74842),u=n(12328),d=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t._inlines=[],t}return(0,o.__extends)(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(i.D.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!==this)throw new Error(i.D.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=function(t,n){var r,i;if(e.prototype.internalParse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))try{for(var a=(0,o.__values)(t.inlines),s=a.next();!s.done;s=a.next()){var l=s.value,c=void 0;if("string"==typeof l){var d=new u.N;d.text=l,c=d}else c=n.parseElement(this,l,[],!1);c&&this.internalAddInline(c,!0)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}},t.prototype.internalToJSON=function(t,n){var r,i;if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){var a=[];try{for(var s=(0,o.__values)(this._inlines),l=s.next();!l.done;l=s.next()){var c=l.value;a.push(c.toJSON(n))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}n.serializeValue(t,"inlines",a)}},t.prototype.internalRender=function(e){if(this._inlines.length>0){var t=(0,a.xg)();switch(t.id=this.id,t.htmlFor=this.forElementId,t.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),t.style.margin=0,t.style.padding=0,this.getEffectiveHorizontalAlignment()){case s.OD.Center:t.style.textAlign="center";break;case s.OD.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this._inlines.map((function(e){return r.createElement(e.Render,{key:e.key})}));if(n.length>0)return r.createElement(this.forElementId?"label":"div",t,n)}return null},t.prototype.asString=function(){var e,t,n="";try{for(var r=(0,o.__values)(this._inlines),i=r.next();!i.done;i=r.next()){n+=i.value.asString()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getAdditionalValidSchemaProperties=function(){return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalValidSchemaProperties.call(this)),!1),["inlines"],!1)},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"inlines",valueTypes:[{type:"object",validValues:[new l.E$(new u.N)]},{type:"string",contentType:"text"}],isArray:!0,schemaVersion:l.uq.v1_2,suggestedSchemaTypeName:"RichTextBlockInlineArray"}],!1)},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(i.D.errors.indexOutOfRange(e))},t.prototype.addInline=function(e){"string"==typeof e?this.internalAddInline(new u.N(e)):this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)},t}(c.hA)},52580:(e,t,n)=>{n.d(t,{E:()=>p,V:()=>h});var o=n(79490),r=n(8520),i=n(93609),a=n(33467),s=n(11512),l=n(77909),c=n(74842),u=n(14492),d=n(95312),p=function(e){function t(t){var n=e.call(this)||this;return n.ariaHidden=!1,t&&(n.text=t),n}return(0,o.__extends)(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this.getValue(t.weightProperty)},set:function(e){this.setValue(t.weightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontType",{get:function(){return this.getValue(t.fontTypeProperty)},set:function(e){this.setValue(t.fontTypeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSubtle",{get:function(){return this.getValue(t.isSubtleProperty)},set:function(e){this.setValue(t.isSubtleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getFontSize=function(e){switch(this.effectiveSize){case a.$C.Small:return e.fontSizes.small;case a.$C.Medium:return e.fontSizes.medium;case a.$C.Large:return e.fontSizes.large;case a.$C.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.setText=function(e){this.setValue(t.textProperty,e)},t.prototype.init=function(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle},t.prototype.asString=function(){return this.text},t.prototype.applyStylesTo=function(e){var t=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);t.fontFamily&&(e.style.fontFamily=t.fontFamily),e.style.fontSize="".concat(t.getFontSize(this.effectiveSize),"px");var n=this.getEffectiveStyleDefinition().foregroundColors.getColorDefinition(this.effectiveColor),o=(0,s.zS)(this.effectiveIsSubtle?n.subtle:n.default);switch(o&&(e.style.color=o),this.effectiveWeight){case a.uL.Lighter:e.style.fontWeight=t.fontWeights.lighter;break;case a.uL.Bolder:e.style.fontWeight=t.fontWeights.bolder;break;default:e.style.fontWeight=t.fontWeights.default}this.ariaHidden&&(e["aria-hidden"]="true")},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.selectAction&&t.push(this.selectAction),t},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveFontType",{get:function(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveIsSubtle",{get:function(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveSize",{get:function(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveWeight",{get:function(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight},enumerable:!1,configurable:!0}),t.textProperty=new l.XB(l.uq.v1_0,"text").setContentType("text"),t.sizeProperty=new l.fX(l.uq.v1_0,"size",a.$C),t.weightProperty=new l.fX(l.uq.v1_0,"weight",a.uL),t.colorProperty=new l.fX(l.uq.v1_0,"color",a.r7),t.isSubtleProperty=new l.gV(l.uq.v1_0,"isSubtle"),t.fontTypeProperty=new l.fX(l.uq.v1_2,"fontType",a.g7),t.selectActionProperty=new i.c(l.uq.v1_1,"selectAction",["Action.ShowCard"]),t}(c.hA),h=function(e){function t(){var t=e.apply(this,(0,o.__spreadArray)([],(0,o.__read)(arguments),!1))||this;return t.useMarkdown=!0,t}return(0,o.__extends)(t,e),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getValue(t.wrapProperty)},set:function(e){this.setValue(t.wrapProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLines",{get:function(){return this.getValue(t.maxLinesProperty)},set:function(e){this.setValue(t.maxLinesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(p.selectActionProperty)},t.prototype.internalRender=function(e){if(this.text){var t=this.preProcessPropertyValue(p.textProperty),n=this.hostConfig,o={style:{}};if(o.id=this.id,o.htmlFor=this.forElementId,o.className=n.makeCssClassName("ac-textBlock"),o.style.overflow="hidden",o.style.margin=0,o.style.padding=0,this.applyStylesTo(o),"heading"===this.style){o.role="heading";var i=this.hostConfig.textBlock.headingLevel;void 0!==i&&i>0&&(o["aria-level"]=i)}var a=(0,u.v)(this.lang,t),s=this.useMarkdown&&a?this.processMarkdown({text:a,properties:this}):{didProcess:!1};return s.didProcess&&s.output?o.children=s.output:o.children=a,this.wrap?(o.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(o.style.overflow="hidden",d.h$.useWebkitLineClamp?(o.style.lineHeight=void 0,o.style.display="-webkit-box",o.style.WebkitBoxOrient="vertical",o.style.WebkitLineClamp=this.maxLines):o.style.maxHeight="".concat(this._computedLineHeight*this.maxLines,"px"))):o.style.whiteSpace="nowrap",o.style.textOverflow="ellipsis",r.createElement(this.forElementId?"label":"div",o)}return null},t.prototype.applyStylesTo=function(t){switch(e.prototype.applyStylesTo.call(this,t),this.getEffectiveHorizontalAlignment()){case a.OD.Center:t.style.textAlign="center";break;case a.OD.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this.hostConfig.lineHeights;if(n)switch(this.effectiveSize){case a.$C.Small:this._computedLineHeight=n.small;break;case a.$C.Medium:this._computedLineHeight=n.medium;break;case a.$C.Large:this._computedLineHeight=n.large;break;case a.$C.ExtraLarge:this._computedLineHeight=n.extraLarge;break;default:this._computedLineHeight=n.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));t.style.lineHeight="".concat(this._computedLineHeight,"px")},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.getEffectiveTextStyleDefinition=function(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):e.prototype.getEffectiveTextStyleDefinition.call(this)},t.wrapProperty=new l.gV(l.uq.v1_0,"wrap",!1),t.maxLinesProperty=new l.Uy(l.uq.v1_0,"maxLines"),t.styleProperty=new l.XY(l.uq.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),t}(p)},12328:(e,t,n)=>{n.d(t,{N:()=>u});var o=n(79490),r=n(8520),i=n(74842),a=n(14492),s=n(11512),l=n(77909),c=n(52580),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,o.__extends)(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(i.hA.targetWidthProperty),t.remove(i.hA.horizontalAlignmentProperty),t.remove(i.hA.heightProperty),t.remove(i.hA.separatorProperty),t.remove(i.hA.spacingProperty),t.remove(i.hA.requiresProperty),t.add(c.E.selectActionProperty)},Object.defineProperty(t.prototype,"italic",{get:function(){return this.getValue(t.italicProperty)},set:function(e){this.setValue(t.italicProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strikethrough",{get:function(){return this.getValue(t.strikethroughProperty)},set:function(e){this.setValue(t.strikethroughProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highlight",{get:function(){return this.getValue(t.highlightProperty)},set:function(e){this.setValue(t.highlightProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return this.getValue(t.underlineProperty)},set:function(e){this.setValue(t.underlineProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var t,n=this;if(this.text){var o=this.preProcessPropertyValue(c.E.textProperty),i=this.hostConfig,l=(0,a.v)(this.lang,o),u=null!=l?l:"";if((null===(t=this.selectAction)||void 0===t?void 0:t.isEffectivelyEnabled())&&i.supportsInteractivity){var d={style:{}};d.className=i.makeCssClassName("ac-anchor"),d.href=this.selectAction.getHref(),d.target="_blank",d.rel="noopener noreferrer",d.onClick=function(e){var t,o;e.preventDefault(),e.stopPropagation(),"click"===(null===(t=n.selectAction)||void 0===t?void 0:t.applicationMode)&&(null===(o=n.selectAction)||void 0===o||o.execute())};var p=this.renderAnchor(l,d);null!==p&&(u=this.selectAction.applyTo(p))}var h=(0,s.xg)();return h.className=i.makeCssClassName("ac-textRun"),h.style.whiteSpace="pre-wrap",this.applyStylesTo(h),r.createElement("span",h,u)}return null},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getEffectiveStyleDefinition().foregroundColors.getColorDefinition(this.effectiveColor),o=(0,s.zS)(this.effectiveIsSubtle?n.highlightColors.subtle:n.highlightColors.default);o&&(t.style.backgroundColor=o)}this.underline&&(t.style.textDecoration="underline")},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),t.italicProperty=new l.gV(l.uq.v1_2,"italic",!1),t.strikethroughProperty=new l.gV(l.uq.v1_2,"strikethrough",!1),t.highlightProperty=new l.gV(l.uq.v1_2,"highlight",!1),t.underlineProperty=new l.gV(l.uq.v1_3,"underline",!1),t}(c.E)},87417:(e,t,n)=>{n.d(t,{n_x:()=>Z});var o=n(74842),r=n(77909),i=n(23489),a=n(70512),s=n(42228),l=n(79490),c=n(33467),u=n(23379),d=n(11512),p=new r.FZ("TargetElement",[{name:"elementId",valueTypes:[{type:"string"}],isArray:!1,schemaVersion:r.uq.v1_5},{name:"isVisible",valueTypes:[{type:"boolean"}],isArray:!1,schemaVersion:r.uq.v1_5}]),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"},{type:"object",validValues:[p]}],isArray:!0}},t}(r.Zn),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"targetElements",{get:function(){return this.getValue(t.targetElementsProperty)},set:function(e){this.setValue(t.targetElementsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);if(e.length>0)return e.join(" ")}},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.targetElements||t.addFailure(this,c.iV.PropertyCantBeNull,u.D.errors.propertyMustBeSet("targetElements"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.execute=function(){var t,n,r;e.prototype.execute.call(this);var i=null===(r=this.parent)||void 0===r?void 0:r.getRootObject();if(i&&i instanceof o.hA)try{for(var a=(0,l.__values)(Object.keys(this.targetElements)),s=a.next();!s.done;s=a.next()){var c=s.value,u=i.getElementById(c);u&&("boolean"==typeof this.targetElements[c]?u.isVisible=this.targetElements[c]:u.isVisible=!u.isVisible)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t},t.prototype.removeTargetElement=function(e){delete this.targetElements[e]},t.targetElementsProperty=new h(r.uq.v1_2,"targetElements",(function(e,t,n,o){var r,i,a={};if(Array.isArray(n[t.name]))try{for(var s=(0,l.__values)(n[t.name]),c=s.next();!c.done;c=s.next()){var u=c.value;if("string"==typeof u)a[u]=void 0;else if("object"==typeof u){var p=u.elementId;"string"==typeof p&&(a[p]=(0,d.q6)(u.isVisible))}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return a}),(function(e,t,n,o,r){var i,a,s=[];try{for(var c=(0,l.__values)(Object.keys(o)),u=c.next();!u.done;u=c.next()){var d=u.value;"boolean"==typeof o[d]?s.push({elementId:d,isVisible:o[d]}):s.push(d)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}r.serializeArray(n,t.name,s)}),{},(function(e){return{}})),t.JsonTypeName="Action.ToggleVisibility",t}(o.rc);var f,m=n(80832),y=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new m.L(t),t}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"orientation",{get:function(){return this.getValue(t.orientationProperty)},set:function(e){this.setValue(t.orientationProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.orientationProperty)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(e){var t;return null!==(t=this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation))&&void 0!==t?t:this.isDesignMode()?this.createPlaceholderElement():null},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._actionCollection.releaseDOMResources()},t.prototype.isBleedingAtBottom=function(){return 0===this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.getElementById=function(t){var n=this._actionCollection.getElementById(t);return n||e.prototype.getElementById.call(this,t)},t.prototype.getAllActions=function(){for(var t=e.prototype.getAllActions.call(this),n=0;n<this.getActionCount();n++){var o=this.getActionAt(n);o&&t.push(o)}return t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),e?this._actionCollection.getAllInputs():[]},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(t),!1),["actions"],!1)},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[m.L.getActionsPropertyDescriptor(t,this.getJsonTypeName())],!1)},t.prototype.isLastElement=function(e){return e.parent===this&&e.isExpandableInlineElement},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new r.fX(r.uq.v1_1,"orientation",c.t4),t}(o.hA),v=n(8520),C=n(95312),b=n(90996),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=this.defaultValue,r=t[this.name],i=!1;if("number"!=typeof r||isNaN(r))if("auto"===r||"stretch"===r)o=r;else if("string"==typeof r)try{(o=C.zg.parse(r)).unit===c.Y2.Pixel&&this.targetVersion.compareTo(n.targetVersion)>0&&(i=!0)}catch(e){i=!0}else i=!0;else o=new C.zg(r,c.Y2.Weight);return i&&(n.logParseEvent(e,c.iV.InvalidPropertyValue,u.D.errors.invalidColumnWidth(r)),o="auto"),o},t.prototype.toJSON=function(e,t,n,o){n instanceof C.zg?n.unit===c.Y2.Pixel?o.serializeValue(t,"width","".concat(n.physicalSize,"px")):o.serializeNumber(t,"width",n.physicalSize):o.serializeValue(t,"width",n)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:["auto","stretch",C.IO]},{type:"number"}],defaultValue:this.defaultValue,isArray:!1}},t}(r.BG),A=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n._computedWeight=0,n.width=t,n}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this.getValue(t.widthProperty)},set:function(e){this.setValue(t.widthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.adjustSize=function(e){this.isDesignMode()?(e.minWidth="20px",e.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.minWidth="0",this.minPixelHeight&&(e.minHeight="".concat(this.minPixelHeight,"px"))),"auto"===this.width?e.flex="0 1 auto":"stretch"===this.width?e.flex="1 1 50px":this.width instanceof C.zg&&(this.width.unit===c.Y2.Pixel?(e.flex="0 0 auto",e.width="".concat(this.width.physicalSize,"px")):e.flex="1 1 ".concat(this._computedWeight>0?this._computedWeight:this.width.physicalSize,"%"))},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return c.t4.Vertical},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof S)&&(!this.parent.isFirstElement(this)&&this.shouldRender())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new E(r.uq.v1_0,"width","stretch"),t}(b.mc),S=function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t._columns=[],t}return(0,l.__extends)(t,e),t.prototype.createColumnInstance=function(e,t){return"object"!=typeof e||"type"in e||(e.type="Column"),t.parseCardObject(this,e,[],!this.isDesignMode(),(function(e){return e&&"Column"!==e?void 0:new A}),(function(e,n){t.logParseEvent(void 0,c.iV.ElementTypeNotAllowed,u.D.errors.elementTypeNotAllowed(e))}))},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(b.oC.layoutsProperty)},t.prototype.getRawItems=function(){return this._columns},t.prototype.renderItems=function(){var e,t,n,o,r=this._columns.filter((function(e){return e.shouldRender()})),i=0;try{for(var a=(0,l.__values)(r),s=a.next();!s.done;s=a.next()){(h=s.value).width instanceof C.zg&&h.width.unit===c.Y2.Weight&&(i+=h.width.physicalSize)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}var u=[];this._renderedColumns=[];try{for(var d=(0,l.__values)(r),p=d.next();!p.done;p=d.next()){var h;if((h=p.value).width instanceof C.zg&&h.width.unit===c.Y2.Weight&&i>0){var g=100/i*h.width.physicalSize;h._computedWeight=g}var f=v.createElement(h.Render,{key:h.key});f&&(u.push(f),this._renderedColumns.push(h))}}catch(e){n={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}return u},t.prototype.applyLayout=function(e){switch(e.style.display="flex",e.style.flexDirection="row",this.getEffectiveHorizontalAlignment()){case c.OD.Center:e.style.justifyContent="center";break;case c.OD.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}},t.prototype.internalParse=function(t,n){var o,r;e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var i=t[this.getItemsCollectionPropertyName()];if(Array.isArray(i))try{for(var a=(0,l.__values)(i),s=a.next();!s.done;s=a.next()){var c=s.value,u=this.createColumnInstance(c,n);u&&this._columns.push(u)}}catch(e){o={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getItemsCollectionPropertyName(),this._columns)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:this.getItemsCollectionPropertyName(),valueTypes:[{type:"object",validValues:[new r.E$(new A)]}],isArray:!0,declaringClassName:this.constructor.name,schemaVersion:r.uq.v1_0,suggestedSchemaTypeName:"ColumnArray"}],!1)},t.prototype.getItemsCollectionPropertyName=function(){return"columns"},t.prototype.isFirstElement=function(e){var t,n;try{for(var o=(0,l.__values)(this._columns),r=o.next();!r.done;r=o.next()){var i=r.value;if(i.shouldRender())return i===e}}catch(e){t={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!1},t.prototype.isBleedingAtTop=function(){var e,t;if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)try{for(var n=(0,l.__values)(this._columns),o=n.next();!o.done;o=n.next()){if(o.value.isBleedingAtTop())return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.isBleedingAtBottom=function(){var e,t;if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)try{for(var n=(0,l.__values)(this._columns),o=n.next();!o.done;o=n.next()){if(o.value.isBleedingAtBottom())return!0}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=function(){return this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=function(t){var n,o;e.prototype.internalValidateProperties.call(this,t);var r=0,i=0;try{for(var a=(0,l.__values)(this._columns),s=a.next();!s.done;s=a.next()){var d=s.value;"number"==typeof d.width?r++:"stretch"===d.width&&i++}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}r>0&&i>0&&t.addFailure(this,c.iV.Hint,u.D.hints.dontUseWeightedAndStretchedColumnsInSameSet())},t.prototype.addColumn=function(e){this.internalInsertItemAt(e,this._columns.length,!0)},t.prototype.removeItem=function(e){if(e instanceof A){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof A?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0===this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)===this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){var t,n,o;try{for(var r=(0,l.__values)(this._columns),i=r.next();!i.done;i=r.next()){if(o=i.value.getActionById(e))break}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return o},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(b.XP),I=n(52580),P=function(e){function t(t,n){var o=e.call(this)||this;return o.name=t,o.value=n,o}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new r.XB(r.uq.v1_0,"title").setContentType("text"),t.valueProperty=new r.XB(r.uq.v1_0,"value").setContentType("text"),t}(r.jB),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"facts",{get:function(){return this.getValue(t.factsProperty)},set:function(e){this.setValue(t.factsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(o.hA.horizontalAlignmentProperty)},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var t=this,n=this.hostConfig,o=function(e){var n=new I.V;return n.setParent(t),n.text=e.value,n.size=e.style.size,n.color=e.style.color,n.isSubtle=e.style.isSubtle,n.weight=e.style.weight,n.wrap=e.style.wrap,n.spacing=c.Kz.None,v.createElement(n.Render,null)};if(this.facts.length>0){var r=(0,C.bK)(this.hostWidth,n.factSet.layoutSwitchBreakpoint)<0,i=void 0!==n.factSet.title.maxWidth?n.factSet.title.maxWidth:150,a=n.makeCssClassName("ac-fact-title"),s=n.makeCssClassName("ac-fact-value");return v.createElement("div",{style:{display:"grid",overflow:"hidden",gridTemplateColumns:r?"auto":"minmax(min-content, max-content) auto",gap:"".concat(r?n.factSet.stackLayout.rowGap:n.factSet.tableLayout.rowGap,"px ").concat(n.factSet.tableLayout.columnGap,"px")}},this.facts.map((function(e){var t=v.createElement(o,{value:e.name,style:n.factSet.title}),l=v.createElement(o,{value:e.value,style:n.factSet.value});return r?v.createElement("div",{key:e.key,style:{display:"grid",gridAutoColumns:"auto",gap:"".concat(n.factSet.stackLayout.titleValueGap,"px")}},v.createElement("div",{className:a},t),v.createElement("div",{className:s},l)):v.createElement(v.Fragment,null,v.createElement("div",{key:e.key+"_title",className:a,style:{maxWidth:"".concat(i,"px")}},t),v.createElement("div",{key:e.key+"_value",className:s,style:{gridColumn:2}},l))})))}return null},t.prototype.isResponsive=function(){return!0},t.prototype.getJsonTypeName=function(){return"FactSet"},t.factsProperty=new r.m2(r.uq.v1_0,"facts",(function(e){return new P})),t}(o.hA),x=n(70114),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"_images",{get:function(){return this.getValue(t.imagesProperty)},set:function(e){this.setValue(t.imagesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"imageSize",{get:function(){return this.getValue(t.imageSizeProperty)},set:function(e){this.setValue(t.imageSizeProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(e){var t,n;if(this._images.length>0){var o=[];try{for(var r=(0,l.__values)(this._images),i=r.next();!i.done;i=r.next()){var a=i.value;switch(this.imageSize){case c.hJ.Small:a.size=c.or.Small;break;case c.hJ.Large:a.size=c.or.Large;break;default:a.size=c.or.Medium}a.maxHeight=this.hostConfig.imageSet.maxImageHeight,o.push(v.createElement(a.Render,{key:a.key}))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}var s=void 0;switch(this.horizontalAlignment){case c.OD.Right:s="flex-end";break;case c.OD.Center:s="center"}return v.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"10px",justifyContent:s}},o)}return this.isDesignMode()?this.createPlaceholderElement():null},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},t.prototype.removeItem=function(e){if(e instanceof x._){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof x._?this._images.indexOf(e):-1},t.imagesProperty=new r.m2(r.uq.v1_0,"images",(function(e){return new x._}),(function(e,t){t.setParent(e)})),t.imageSizeProperty=new r.fX(r.uq.v1_0,"imageSize",c.hJ,c.hJ.Medium),t}(n(65518).y),k=n(49399),_=function(e){function t(t,n){var o=e.call(this)||this;return o.url=t,o.mimeType=n,o}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"mimeType",{get:function(){return this.getValue(t.mimeTypeProperty)},set:function(e){this.setValue(t.mimeTypeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this.getValue(t.urlProperty)},set:function(e){this.setValue(t.urlProperty,e)},enumerable:!1,configurable:!0}),t.prototype.isValid=function(){return!(!this.mimeType||!this.url)},t.mimeTypeProperty=new r.XB(r.uq.v1_1,"mimeType"),t.urlProperty=new r.XB(r.uq.v1_1,"url").setContentType("mediaUrl"),t}(r.jB),D=function(e){function t(t,n,o){var r=e.call(this,t,n)||this;return r.label=o,r}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return this.getValue(t.labelProperty)},set:function(e){this.setValue(t.labelProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"CaptionSource"},t.prototype.render=function(e){return this.isValid()?v.createElement("track",{src:this.url,kind:"captions",label:this.label}):null},t.labelProperty=new r.XB(r.uq.v1_6,"label").setContentType("text"),t}(_),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.prototype.getSchemaKey=function(){return"MediaSource"},t.prototype.render=function(){return this.isValid()?v.createElement("source",{src:this.url,type:this.mimeType}):null},t}(_),L=function(){function e(){this.isPlaying=!1}return e.prototype.play=function(){},Object.defineProperty(e.prototype,"selectedMediaType",{get:function(){},enumerable:!1,configurable:!0}),e}(),O=function(e){function t(t){var n=e.call(this)||this;return n.owner=t,n._selectedSources=[],n._captionSources=[],n.processSources(),n}return(0,l.__extends)(t,e),t.prototype.processSources=function(){var e,n,o;this._selectedSources=[],this._captionSources=[],this._selectedMediaType=void 0;try{for(var r=(0,l.__values)(this.owner.sources),i=r.next();!i.done;i=r.next()){var a=i.value,s=a.mimeType?a.mimeType.split("/"):[];if(2===s.length){if(!this._selectedMediaType){var c=t.supportedMediaTypes.indexOf(s[0]);c>=0&&(this._selectedMediaType=t.supportedMediaTypes[c])}s[0]===this._selectedMediaType&&this._selectedSources.push(a)}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}(o=this._captionSources).push.apply(o,(0,l.__spreadArray)([],(0,l.__read)(this.owner.captionSources),!1))},t.prototype.canPlay=function(){return this._selectedSources.length>0},t.prototype.fetchVideoDetails=function(){return(0,l.__awaiter)(this,void 0,void 0,(function(){return(0,l.__generator)(this,(function(e){return[2]}))}))},t.prototype.render=function(){"video"===this._selectedMediaType?this._mediaElement=document.createElement("video"):this._mediaElement=document.createElement("audio");var e=(0,d.xg)();e["aria-label"]=this.owner.altText?this.owner.altText:this.owner.localizeString(u.D.mediaPlayerAriaLabel),e.playsInline=!0,e.crossOrigin="",e.autoPlay=!0,e.controls=!0,e.preload="none",e.style.width="100%",(0,d.R8)()&&(e.muted=!0);var t=this.owner.sources.map((function(e){return e.render()})).filter((function(e){return void 0!==e})),n=this.owner.captionSources.filter((function(e){return"vtt"===e.mimeType})).map((function(e){return e.render()})).filter((function(e){return void 0!==e}));return v.createElement("video"===this._selectedMediaType?"video":"audio",e,t,n)},t.prototype.play=function(){this._mediaElement&&this._mediaElement.play()},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.supportedMediaTypes=["audio","video"],t}(L),R=function(e){function t(t,n,o){var r=e.call(this,n)||this;return r.owner=t,r.matches=n,r.iFrameTitle=o,n.length>=2&&(r._videoId=n[1]),r}return(0,l.__extends)(t,e),t.prototype.canPlay=function(){return void 0!==this._videoId},t.prototype.render=function(){return v.createElement("div",{style:{position:"relative",width:"100%",height:"0",paddingBottom:"56.25%"}},v.createElement("iframe",{sandbox:"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},src:this.getEmbedVideoUrl(),frameBorder:"0",title:this.iFrameTitle?this.owner.localizeString(this.iFrameTitle):void 0,allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}))},Object.defineProperty(t.prototype,"videoId",{get:function(){return this._videoId},enumerable:!1,configurable:!0}),t}(function(e){function t(t){return e.call(this)||this}return(0,l.__extends)(t,e),t}(L));(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,l.__extends)(t,e),t.prototype.fetchVideoDetails=function(){return(0,l.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,l.__generator)(this,(function(o){switch(o.label){case 0:return e="https://vimeo.com/api/oembed.json?url=".concat(this.getEmbedVideoUrl()),[4,fetch(e)];case 1:return(t=o.sent()).ok?[4,t.json()]:[3,3];case 2:n=o.sent(),this.posterUrl=n.thumbnail_url,o.label=3;case 3:return[2]}}))}))},t.prototype.getEmbedVideoUrl=function(){return"https://player.vimeo.com/video/".concat(this.videoId,"?autoplay=1")}})(R),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}(0,l.__extends)(t,e),t.prototype.fetchVideoDetails=function(){return(0,l.__awaiter)(this,void 0,void 0,(function(){var e,t,n;return(0,l.__generator)(this,(function(o){switch(o.label){case 0:return e="https://api.dailymotion.com/video/".concat(this.videoId,"?fields=thumbnail_720_url"),[4,fetch(e)];case 1:return(t=o.sent()).ok?[4,t.json()]:[3,3];case 2:n=o.sent(),this.posterUrl=n.thumbnail_720_url,o.label=3;case 3:return[2]}}))}))},t.prototype.getEmbedVideoUrl=function(){return"https://www.dailymotion.com/embed/video/".concat(this.videoId,"?autoplay=1")}}(R),function(e){function t(t,n,o){var r=e.call(this,t,n,o)||this;return r.owner=t,r.matches=n,r.iFrameTitle=o,n.length>=3&&void 0!==n[2]&&(r._startTimeIndex=parseInt(n[2],10)),r}(0,l.__extends)(t,e),t.prototype.fetchVideoDetails=function(){return(0,l.__awaiter)(this,void 0,void 0,(function(){return(0,l.__generator)(this,(function(e){return this.posterUrl=this.videoId?"https://img.youtube.com/vi/".concat(this.videoId,"/maxresdefault.jpg"):void 0,[2]}))}))},t.prototype.getEmbedVideoUrl=function(){var e="https://www.youtube.com/embed/".concat(this.videoId,"?autoplay=1");return void 0!==this._startTimeIndex&&(e+="&start=".concat(this._startTimeIndex)),e}}(R);!function(e){e[e.Loading=0]="Loading",e[e.ShowPoster=1]="ShowPoster",e[e.ShowPlayer=2]="ShowPlayer"}(f||(f={}));var M=function(e){return v.createElement("div",{tabIndex:0,role:"button","aria-label":e.ariaLabel,onClick:function(t){t.preventDefault(),t.stopPropagation(),e.startPlayback()},onKeyDown:function(t){"Enter"!==t.code&&"Space"!==t.code||(t.preventDefault(),t.stopPropagation(),e.startPlayback())},style:{position:"absolute",transform:"translate(-50%, -50%)",top:"50%",left:"50%",display:"flex",alignItems:"center",justifyContent:"center",width:"".concat(56,"px"),height:"".concat(56,"px"),border:"1px solid #eeeeee",borderRadius:"".concat(28,"px"),boxShadow:"0px 0px 10px #eeeeee",backgroundColor:"rgba(255, 255, 255, 0.9)",color:"black",cursor:"pointer"}},v.createElement(k.FW,{name:"Play",iconSize:112/3,iconStyle:c.pO.Filled,iconColor:"black"}))},B=function(){function e(){}return e.registerMediaElement=function(t){var n,o=null!==(n=t.groupId)&&void 0!==n?n:e.defaultGroupId,r=e._groupedMediaElements.get(o);r||(r=new Set,e._groupedMediaElements.set(o,r)),r.add(t)},e.unregisterMediaElement=function(t){var n,o;try{for(var r=(0,l.__values)(e._groupedMediaElements.values()),i=r.next();!i.done;i=r.next()){i.value.delete(t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}},e.stopPlayback=function(t,n){var o,r,i,a,s,c;if(t){if(g=e._groupedMediaElements.get(t))try{for(var u=(0,l.__values)(g),d=u.next();!d.done;d=u.next()){(y=d.value)!==n&&y.releaseDOMResources()}}catch(e){o={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(o)throw o.error}}}else try{for(var p=(0,l.__values)(e._groupedMediaElements),h=p.next();!h.done;h=p.next()){var g=(0,l.__read)(h.value,2)[1];if(!n||g.has(n))try{for(var f=(s=void 0,(0,l.__values)(g)),m=f.next();!m.done;m=f.next()){var y;(y=m.value)!==n&&y.releaseDOMResources()}}catch(e){s={error:e}}finally{try{m&&!m.done&&(c=f.return)&&c.call(f)}finally{if(s)throw s.error}}}}catch(e){i={error:e}}finally{try{h&&!h.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}},e.stopPlaybackInChildren=function(t){var n,o,r,i;try{for(var a=(0,l.__values)(e._groupedMediaElements),s=a.next();!s.done;s=a.next()){var c=(0,l.__read)(s.value,2)[1];try{for(var u=(r=void 0,(0,l.__values)(c)),d=u.next();!d.done;d=u.next()){var p=d.value;p.hasAsParent(t)&&p.releaseDOMResources()}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}},e.defaultGroupId="__defaultGroupId__",e._groupedMediaElements=new Map,e}(),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.stopPlayback=function(e){B.stopPlayback(e)},t.stopPlaybackInChildren=function(e){B.stopPlaybackInChildren(e)},Object.defineProperty(t.prototype,"sources",{get:function(){return this.getValue(t.sourcesProperty)},set:function(e){this.setValue(t.sourcesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"captionSources",{get:function(){return this.getValue(t.captionSourcesProperty)},set:function(e){this.setValue(t.captionSourcesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"poster",{get:function(){return this.getValue(t.posterProperty)},set:function(e){this.setValue(t.posterProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"altText",{get:function(){return this.getValue(t.altTextProperty)},set:function(e){this.setValue(t.altTextProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(o.hA.horizontalAlignmentProperty)},t.prototype.mounted=function(){e.prototype.mounted.call(this),B.registerMediaElement(this)},t.prototype.unmounted=function(){e.prototype.unmounted.call(this),B.unregisterMediaElement(this)},t.prototype.getJsonTypeName=function(){return"Media"},t.sourcesProperty=new r.m2(r.uq.v1_1,"sources",(function(e){return new F})),t.captionSourcesProperty=new r.m2(r.uq.v1_6,"captionSources",(function(e){return new D})),t.posterProperty=new r.XB(r.uq.v1_1,"poster").setContentType("imageUrl"),t.altTextProperty=new r.XB(r.uq.v1_1,"altText").setContentType("text"),t}(o.hA),V=function(e){var t,n=(0,l.__read)(v.useState(f.Loading),2),r=n[0],i=n[1];v.useEffect((function(){var t;(null===(t=e.mediaPlayer)||void 0===t?void 0:t.isPlaying)||(i(f.Loading),e.mediaPlayer&&e.mediaPlayer.fetchVideoDetails().then((function(){i(f.ShowPoster)})))}),[e.mediaPlayer,null===(t=e.mediaPlayer)||void 0===t?void 0:t.isPlaying]);switch(r){case f.Loading:return v.createElement("div",{style:{height:"".concat(e.placeholderHeight,"px")}});case f.ShowPoster:return function(){var t,n,r,a=null!==(r=null!==(t=e.posterUrl)&&void 0!==t?t:null===(n=e.mediaPlayer)||void 0===n?void 0:n.posterUrl)&&void 0!==r?r:e.defaultPosterUrl,s=null,c=void 0;if(a){var d={src:a,alt:e.localizeString(u.D.mediaPlayerPosterAltText),style:{width:"100%",height:"100%"}};s=e.renderImage({isSelectable:!1,allowExpand:!1},d)}else c="".concat(e.placeholderHeight,"px");var p=function(){e.startPlayback(),i(f.ShowPlayer)};return v.createElement("div",{role:"contentinfo","aria-label":e.ariaLabel,style:{position:"relative",display:"flex",height:c}},s,function(){if(e.mediaPlayer&&e.mediaPlayer.canPlay()){var t={ariaLabel:e.localizeString(u.D.mediaPlayerAriaLabel),startPlayback:p};return o.v7.mediaPlayButtonRenderer?o.v7.mediaPlayButtonRenderer(t):v.createElement(M,(0,l.__assign)({},t))}return null}())}();case f.ShowPlayer:return e.mediaPlayer?e.mediaPlayer.render():null}},H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.registerCustomMediaPlayers=function(){for(var e,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];(e=t._customMediaPlayers).push.apply(e,(0,l.__spreadArray)([],(0,l.__read)(n),!1))},t.prototype.createMediaPlayerFromRegistry=function(){var e,n,o,r,i,a;try{for(var s=(0,l.__values)(t._customMediaPlayers),c=s.next();!c.done;c=s.next()){var u=c.value;try{for(var d=(o=void 0,(0,l.__values)(this.sources)),p=d.next();!p.done;p=d.next()){var h=p.value;if(h.url)try{for(var g=(i=void 0,(0,l.__values)(u.urlPatterns)),f=g.next();!f.done;f=g.next()){var m=f.value.exec(h.url);if(null!==m)return u.createMediaPlayer(this,m)}}catch(e){i={error:e}}finally{try{f&&!f.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}}}catch(e){o={error:e}}finally{try{p&&!p.done&&(r=d.return)&&r.call(d)}finally{if(o)throw o.error}}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}},t.prototype.propertyChanged=function(t,n){this._mediaPlayer=void 0,e.prototype.propertyChanged.call(this,t,n)},t.prototype.internalRender=function(e){var t,n=this;void 0===this._mediaPlayer&&(this._mediaPlayer=this.createMediaPlayerFromRegistry(),!this._mediaPlayer&&this.hostConfig.media.useHTML5PlayerAsFallback&&(this._mediaPlayer=new O(this)));return v.createElement(V,{mediaPlayer:this._mediaPlayer,posterUrl:this.poster,defaultPosterUrl:this.hostConfig.media.defaultPoster,placeholderHeight:function(){switch(n.hostWidth){case c.RK.VeryNarrow:return n.hostConfig.media.placeholderHeights.veryNarrow;case c.RK.Narrow:return n.hostConfig.media.placeholderHeights.narrow;case c.RK.Standard:return n.hostConfig.media.placeholderHeights.standard;default:return n.hostConfig.media.placeholderHeights.wide}}(),ariaLabel:null!==(t=this.altText)&&void 0!==t?t:this.localizeString(u.D.mediaPlayerAriaLabel),renderImage:function(e,t){return n.renderImage(e,t)},localizeString:function(e,t){return n.localizeString(e,t)},startPlayback:function(){n._mediaPlayer&&(n._mediaPlayer.isPlaying=!0),C.h$.allowSimultaneousVideoPlayback||B.stopPlayback(void 0,n),n.mediaPlaybackStarted(n)}})},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this._mediaPlayer&&(this._mediaPlayer.isPlaying=!1),this.updateLayout()},t.prototype.getResourceInformation=function(){var e,t,n,o,r=[];if(this._mediaPlayer){var i=this.poster?this.poster:this.hostConfig.media.defaultPoster;i&&r.push({url:i,mimeType:"image"})}try{for(var a=(0,l.__values)(this.sources),s=a.next();!s.done;s=a.next()){var c=s.value;c.isValid()&&r.push({url:c.url,mimeType:c.mimeType})}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}try{for(var u=(0,l.__values)(this.captionSources),d=u.next();!d.done;d=u.next()){var p=d.value;p.isValid()&&r.push({url:p.url,mimeType:p.mimeType})}}catch(e){n={error:e}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return r},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){var e;return null===(e=this._mediaPlayer)||void 0===e?void 0:e.selectedMediaType},enumerable:!1,configurable:!0}),t._customMediaPlayers=[],t}(N),U=n(40097),j=n(69323),z=function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t.suppressStyle=!1,t}return(0,l.__extends)(t,e),t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(t),!1),["$schema","version"],!1)},t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},t.prototype.getDefaultPadding=function(){var e=this.suppressStyle?c.Kz.None:c.Kz.Padding;return new C.pT(e,e,e,e)},t.prototype.getSpacings=function(t){if(e.prototype.getSpacings.call(this,t),!this.suppressStyle){var n=new C.pT;this.getImmediateSurroundingPadding(n);var o=this.hostConfig.paddingDefinitionToSpacingDefinition(n);t.padding.left=o.left,t.padding.right=o.right,t.margin.left=-o.left,t.margin.right=-o.right,0!==o.bottom&&(t.padding.bottom=o.bottom,t.margin.bottom=-o.bottom)}},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),t["aria-live"]="polite",t.tabIndex=void 0},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?c.xO.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:c.xO.Emphasis},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExpandableInlineElement",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(j.hq),G=function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t.card=new z,t}return(0,l.__extends)(t,e),t.prototype.inlineCardExpanded=function(e){var t,n=null===(t=this.parent)||void 0===t?void 0:t.getRootObject(),o=n instanceof j.hq&&n.onInlineCardExpanded?n.onInlineCardExpanded:j.hq.onInlineCardExpanded;o&&o(this,e)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var o=t.card;o?this.card.parse(o,n):n.logParseEvent(this,c.iV.PropertyCantBeNull,u.D.errors.showCardMustHaveCard())},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this.card&&n.serializeValue(t,"card",this.card.toJSON(n))},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"card",valueTypes:[{type:"object",validValues:[new r.E$(new j.hq)]}],isArray:!1,schemaVersion:r.uq.v1_0}],!1)},t.prototype.expand=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.card.suppressStyle=e,t&&this.inlineCardExpanded(!0)},t.prototype.collapse=function(){this.inlineCardExpanded(!1)},t.prototype.releaseDOMResources=function(){e.prototype.releaseDOMResources.call(this),this.card.releaseDOMResources()},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),this.card.getAllInputs(e)},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return t.push.apply(t,(0,l.__spreadArray)([],(0,l.__read)(this.card.getAllActions()),!1)),t},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return t.push.apply(t,(0,l.__spreadArray)([],(0,l.__read)(this.card.getResourceInformation()),!1)),t},t.prototype.getInlineContent=function(){return this.card},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);return n||(n=this.card.getElementById(t)),n},t.prototype.hasResponsiveElements=function(){return this.card.isResponsive()},t.prototype.shouldRaiseOnExecuteEvent=function(){return this.hostConfig.actions.showCard.actionMode===c.l1.Popup},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(t),!1),["card"],!1)},Object.defineProperty(t.prototype,"isExpandable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.JsonTypeName="Action.ShowCard",t}(o.rc),W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string",validValues:[C.IO]},{type:"number"}],isArray:!1}},t}(r.Zn),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalCellContentAlignment",{get:function(){return this.getValue(t.horizontalCellContentAlignmentProperty)},set:function(e){this.setValue(t.horizontalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCellContentAlignment",{get:function(){return this.getValue(t.verticalCellContentAlignmentProperty)},set:function(e){this.setValue(t.verticalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.getValue(t.widthProperty)},set:function(e){this.setValue(t.widthProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"ColumnDefinition"},t.horizontalCellContentAlignmentProperty=new r.fX(r.uq.v1_5,"horizontalCellContentAlignment",c.OD),t.verticalCellContentAlignmentProperty=new r.fX(r.uq.v1_5,"verticalCellContentAlignment",c.sx),t.widthProperty=new W(r.uq.v1_5,"width",(function(e,t,n,o){var r=t.defaultValue,i=n[t.name],a=!1;if("number"!=typeof i||isNaN(i))if("string"==typeof i)try{r=C.zg.parse(i)}catch(e){a=!0}else a=!0;else r=new C.zg(i,c.Y2.Weight);return a&&o.logParseEvent(e,c.iV.InvalidPropertyValue,u.D.errors.invalidColumnWidth(i)),r}),(function(e,t,n,o,r){o.unit===c.Y2.Pixel?r.serializeValue(n,"width","".concat(o.physicalSize,"px")):r.serializeNumber(n,"width",o.physicalSize)}),new C.zg(1,c.Y2.Weight)),t}(r.jB),Q=function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t._items=[],t}return(0,l.__extends)(t,e),t.prototype.parseItem=function(e,t){var n=this;return t.parseCardObject(this,e,[],!0,(function(e){return n.createItemInstance(e)}),(function(e,n){t.logParseEvent(void 0,c.iV.ElementTypeNotAllowed,u.D.errors.elementTypeNotAllowed(e))}))},t.prototype.internalAddItem=function(e){if(e.parent)throw new Error(u.D.errors.elementAlreadyParented());this._items.push(e),e.setParent(this)},t.prototype.internalRemoveItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.internalIndexOf=function(e){return this._items.indexOf(e)},t.prototype.internalParse=function(t,n){var o,r;e.prototype.internalParse.call(this,t,n),this._items=[];var i=t[this.getCollectionPropertyName()];if(Array.isArray(i))try{for(var a=(0,l.__values)(i),s=a.next();!s.done;s=a.next()){var c=s.value,u=this.parseItem(c,n);u&&this._items.push(u)}}catch(e){o={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getCollectionPropertyName(),this._items)},t.prototype.removeItem=function(e){return this.internalRemoveItem(e)},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(0):void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.getItemCount()>0?this.getItemAt(this.getItemCount()-1):void 0},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(t),!1),[this.getCollectionPropertyName()],!1)},t}(b.oC),K=function(e){function t(){var t=e.apply(this,(0,l.__spreadArray)([],(0,l.__read)(arguments),!1))||this;return t._columnIndex=-1,t._cellType="data",t}return(0,l.__extends)(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(b.oC.horizontalAlignmentProperty),t.remove(b.mc.showBorderProperty),t.remove(b.mc.roundedCornersProperty)},t.prototype.getHasBorder=function(){return this.parentRow.parentTable.showGridLines},t.prototype.applyBorder=function(e){if(this.getHasBorder()){var t=this.hostConfig.containerStyles.getStyleByName(this.parentRow.parentTable.gridStyle);if(t.borderColor){var n=(0,d.zS)(t.borderColor);n&&this.parentRow.parentTable.showGridLines&&this.parentRow.indexOf(this)>0&&(e.style.borderLeft="1px solid ".concat(n))}}},t.prototype.getDefaultPadding=function(){return this.getHasBackground()||this.getHasBorder()?new C.pT(c.Kz.Small,c.Kz.Small,c.Kz.Small,c.Kz.Small):e.prototype.getDefaultPadding.call(this)},t.prototype.adjustSize=function(e){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex);t.computedWidth.unit===c.Y2.Pixel?e.flex="0 0 ".concat(t.computedWidth.physicalSize,"px"):e.flex="1 1 ".concat(t.computedWidth.physicalSize,"%")},t.prototype.customizeProps=function(t){e.prototype.customizeProps.call(this,t),t.role="data"===this.cellType?"cell":"columnheader",t.style.minWidth=0,"header"===this.cellType&&(t.scope="col")},t.prototype.shouldSerialize=function(e){return!0},t.prototype.getJsonTypeName=function(){return"TableCell"},t.prototype.getEffectiveTextStyleDefinition=function(){return"header"===this.cellType?this.hostConfig.textStyles.columnHeader:e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.getEffectiveHorizontalAlignment=function(){if(void 0!==this.horizontalAlignment)return this.horizontalAlignment;if(void 0!==this.parentRow.horizontalCellContentAlignment)return this.parentRow.horizontalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).horizontalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.horizontalCellContentAlignment?this.parentRow.parentTable.horizontalCellContentAlignment:e.prototype.getEffectiveHorizontalAlignment.call(this)},t.prototype.getEffectiveVerticalContentAlignment=function(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;if(void 0!==this.parentRow.verticalCellContentAlignment)return this.parentRow.verticalCellContentAlignment;if(this.columnIndex>=0){var t=this.parentRow.parentTable.getColumnAt(this.columnIndex).verticalCellContentAlignment;if(void 0!==t)return t}return void 0!==this.parentRow.parentTable.verticalCellContentAlignment?this.parentRow.parentTable.verticalCellContentAlignment:e.prototype.getEffectiveVerticalContentAlignment.call(this)},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cellType",{get:function(){return this._cellType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentRow",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(b.mc),Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"horizontalCellContentAlignment",{get:function(){return this.getValue(t.horizontalCellContentAlignmentProperty)},set:function(e){this.setValue(t.horizontalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCellContentAlignment",{get:function(){return this.getValue(t.verticalCellContentAlignmentProperty)},set:function(e){this.setValue(t.verticalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(b.oC.layoutsProperty)},t.prototype.getDefaultPadding=function(){return new C.pT(c.Kz.None,c.Kz.None,c.Kz.None,c.Kz.None)},t.prototype.applyBackground=function(e){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(t.backgroundColor){var n=(0,d.zS)(t.backgroundColor);n&&(e.style.backgroundColor=n)}},t.prototype.getCollectionPropertyName=function(){return"cells"},t.prototype.createItemInstance=function(e){return e&&"TableCell"!==e?void 0:new K},t.prototype.renderItems=function(){for(var e=[],t=this.getIsFirstRow(),n=0;n<Math.min(this.getItemCount(),this.parentTable.getColumnCount());n++){var o=this.getItemAt(n);o._columnIndex=n,o._cellType=this.parentTable.firstRowAsHeaders&&t?"header":"data";var r=v.createElement(o.Render,{key:o.key});r&&e.push(r)}return e},t.prototype.customizeProps=function(e){e.role="row"},t.prototype.applyLayout=function(e){e.style.display="flex",e.style.flexDirection="row";var t=this.hostConfig.table.cellSpacing;if(!this.parentTable.showGridLines&&t>0&&(e.style.gap=t),this.parentTable.showGridLines&&this.parentTable.indexOf(this)>0){var n=this.hostConfig.containerStyles.getStyleByName(this.parentTable.gridStyle);if(n.borderColor){var o=(0,d.zS)(n.borderColor);o&&(e.style.borderTop="1px solid ".concat(o))}}},t.prototype.shouldSerialize=function(e){return!0},t.prototype.addCell=function(e){this.internalAddItem(e)},t.prototype.removeCellAt=function(e){return e>=0&&e<this.getItemCount()&&this.removeItem(this.getItemAt(e))},t.prototype.indexOf=function(e){return e instanceof K?this.internalIndexOf(e):-1},t.prototype.ensureHasEnoughCells=function(e){for(;this.getItemCount()<e;)this.addCell(new K)},t.prototype.getJsonTypeName=function(){return"TableRow"},t.prototype.getIsFirstRow=function(){return this.parentTable.getItemAt(0)===this},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:this.getCollectionPropertyName(),valueTypes:[{type:"object",validValues:[new r.E$(new K)]}],isArray:!0,schemaVersion:r.uq.v1_5,suggestedSchemaTypeName:"TableCellArray"}],!1)},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentTable",{get:function(){return this.parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.styleProperty=new b._I(r.uq.v1_5,"style"),t.horizontalCellContentAlignmentProperty=new r.fX(r.uq.v1_5,"horizontalCellContentAlignment",c.OD),t.verticalCellContentAlignmentProperty=new r.fX(r.uq.v1_5,"verticalCellContentAlignment",c.sx),t}(Q),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,l.__extends)(t,e),Object.defineProperty(t.prototype,"_columns",{get:function(){return this.getValue(t._columnsProperty)},set:function(e){this.setValue(t._columnsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"firstRowAsHeaders",{get:function(){return this.getValue(t.firstRowAsHeadersProperty)},set:function(e){this.setValue(t.firstRowAsHeadersProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showGridLines",{get:function(){return this.getValue(t.showGridLinesProperty)},set:function(e){this.setValue(t.showGridLinesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gridStyle",{get:function(){var e=this.getValue(t.gridStyleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e},set:function(e){this.setValue(t.gridStyleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontalCellContentAlignment",{get:function(){return this.getValue(t.horizontalCellContentAlignmentProperty)},set:function(e){this.setValue(t.horizontalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"verticalCellContentAlignment",{get:function(){return this.getValue(t.verticalCellContentAlignmentProperty)},set:function(e){this.setValue(t.verticalCellContentAlignmentProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(b.oC.layoutsProperty)},t.prototype.ensureRowsHaveEnoughCells=function(){for(var e=0;e<this.getItemCount();e++)this.getItemAt(e).ensureHasEnoughCells(this.getColumnCount())},t.prototype.removeCellsFromColumn=function(e){for(var t=0;t<this.getItemCount();t++)this.getItemAt(t).removeCellAt(e)},t.prototype.getCollectionPropertyName=function(){return"rows"},t.prototype.createItemInstance=function(e){return e&&"TableRow"!==e?void 0:new Y},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.ensureRowsHaveEnoughCells()},t.prototype.renderItems=function(){for(var e=[],t=0;t<this.getItemCount();t++){var n=this.getItemAt(t),o=v.createElement(n.Render,{key:n.key});o&&e.push(o)}return e},t.prototype.applyLayout=function(e){var t,n,o,r,i=0;try{for(var a=(0,l.__values)(this._columns),s=a.next();!s.done;s=a.next()){(h=s.value).width.unit===c.Y2.Weight&&(i+=h.width.physicalSize)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}try{for(var u=(0,l.__values)(this._columns),p=u.next();!p.done;p=u.next()){var h;(h=p.value).width.unit===c.Y2.Pixel?h.computedWidth=new C.zg(h.width.physicalSize,c.Y2.Pixel):h.computedWidth=new C.zg(100/i*h.width.physicalSize,c.Y2.Weight)}}catch(e){o={error:e}}finally{try{p&&!p.done&&(r=u.return)&&r.call(u)}finally{if(o)throw o.error}}e.role="table",e.style.display="flex",e.style.flexDirection="column",e.style.overflow="hidden";var g=this.hostConfig.table.cellSpacing;if(this.showGridLines){var f=this.hostConfig.containerStyles.getStyleByName(this.gridStyle);if(f.borderColor){var m=(0,d.zS)(f.borderColor);m&&(e.style.border="1px solid ".concat(m),this.applyRoundedCorners(e))}}else e.style.gap=g>0?g:void 0},t.prototype.getDefaultPadding=function(){return this.getHasBackground()?new C.pT(c.Kz.Padding,c.Kz.Padding,c.Kz.Padding,c.Kz.Padding):new C.pT},t.prototype.getHasBorder=function(){return this.showGridLines&&this.getHasBackground()||e.prototype.getHasBorder.call(this)},t.prototype.addColumn=function(e){this._columns.push(e),this.ensureRowsHaveEnoughCells()},t.prototype.removeColumn=function(e){var t=this._columns.indexOf(e);t>=0&&(this.removeCellsFromColumn(t),this._columns.splice(t,1))},t.prototype.getColumnCount=function(){return this._columns.length},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.addRow=function(e){this.internalAddItem(e),e.ensureHasEnoughCells(this.getColumnCount())},t.prototype.indexOf=function(e){return e instanceof Y?this.internalIndexOf(e):-1},t.prototype.getJsonTypeName=function(){return"Table"},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:this.getCollectionPropertyName(),valueTypes:[{type:"object",validValues:[new r.E$(new Y)]}],isArray:!0,schemaVersion:r.uq.v1_5,suggestedSchemaTypeName:"TableRowArray"}],!1)},t.prototype.getAdditionalValidSchemaProperties=function(){var t=e.prototype.getAdditionalValidSchemaProperties.call(this);return(0,l.__spreadArray)((0,l.__spreadArray)([],(0,l.__read)(t),!1),["columns"],!1)},t._columnsProperty=new r.m2(r.uq.v1_5,"columns",(function(e){return new q})),t.firstRowAsHeadersProperty=new r.gV(r.uq.v1_5,"firstRowAsHeaders",!0),t.showGridLinesProperty=new r.gV(r.uq.v1_5,"showGridLines",!0),t.gridStyleProperty=new b._I(r.uq.v1_5,"gridStyle"),t.horizontalCellContentAlignmentProperty=new r.fX(r.uq.v1_5,"horizontalCellContentAlignment",c.OD),t.verticalCellContentAlignmentProperty=new r.fX(r.uq.v1_5,"verticalCellContentAlignment",c.sx),t}(Q),J=n(12328);var X=!1;function Z(){X||(o.v7.defaultActions.register(s.tV.JsonTypeName,(function(e){return new s.tV})),o.v7.defaultActions.register(a.o.JsonTypeName,(function(e){return new a.o})),o.v7.defaultActions.register(i.e.JsonTypeName,(function(e){return new i.e}),r.uq.v1_4),o.v7.defaultActions.register(g.JsonTypeName,(function(e){return new g}),r.uq.v1_2),o.v7.defaultElements.register("Container",(function(e){return new b.mc})),o.v7.defaultElements.register("ActionSet",(function(e){return new y}),r.uq.v1_2),o.v7.defaultElements.register("ColumnSet",(function(e){return new S})),o.v7.defaultElements.register("Media",(function(e){return new H}),r.uq.v1_1),o.v7.defaultElements.register("RichTextBlock",(function(e){return new U.r}),r.uq.v1_2),o.v7.defaultElements.register("Table",(function(e){return new $}),r.uq.v1_5),o.v7.defaultElements.register("TextBlock",(function(e){return new I.V})),o.v7.defaultElements.register("TextRun",(function(e){return new J.N}),r.uq.v1_2),o.v7.defaultElements.register("FactSet",(function(e){return new T})),o.v7.defaultElements.register("ImageSet",(function(e){return new w})),o.v7.defaultElements.register("Image",(function(e){return new x._})),o.v7.defaultActions.register(G.JsonTypeName,(function(e){return new G})),o.v7.defaultElements.registerAttachableProperty(b.zh),X=!0)}},6552:(e,t,n)=>{n.d(t,{Jv:()=>C});var o=n(79490),r=n(18878),i=n(99154),a=n(29946),s=n(63369),l=n(42387),c=n(27420),u=n(76916),d=n(26529),p=n(54127),h=n(14743),g=function(){function e(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}return e.prototype.add=function(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)},e.prototype.getAverages=function(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}},e}(),f=function(){function e(e,t){this.finals=new g,this.partials=new g,this.getNow=Date.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=null!=t?t:Date.now}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),e.prototype.getChunk=function(e){return this.list[e]},e.prototype.track=function(e,t,n){var o={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:n},r=this.list.length-1;if(-1===r||o.audioStart>=this.list[r].audioEnd)this.list.push(o);else if(o.audioEnd<=this.list[0].audioStart)this.list.unshift(o);else{for(;r>0&&o.audioEnd<this.list[r].audioStart;)r--;if(r>=0&&o.audioStart===this.list[r].audioStart)throw new Error("Why are we double tracking the same chunk of audio? newChunk: ".concat(JSON.stringify(o),", existing chunk: ").concat(JSON.stringify(this.list[r])));this.list.splice(r,0,o)}if(this.list.length>this.maxListLength){var i=this.list.length-this.maxListLength;this.list.splice(0,i),c.Hv.sendTraceTag(523568153,u.n.msoulscat_Wac_Dictation,d.k.Warning,"AudioStreamPerfTracker.track: list length has exceeded max by ".concat(i," items!"))}else this.list.length>=this.warnListLength&&c.Hv.sendTraceTag(523568154,u.n.msoulscat_Wac_Dictation,d.k.Warning,"AudioStreamPerfTracker.track: list length: ".concat(this.list.length," approaching max: ").concat(this.maxListLength))},e.prototype.trimBefore=function(e){if(0!==this.list.length){for(var t="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),n=0;n<this.list.length&&this.list[n].audioEnd<e;)n++;n===this.list.length&&c.Hv.sendTraceTag(523568156,u.n.msoulscat_Wac_Dictation,d.k.Warning,"AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ".concat(e,". List length: ").concat(this.list.length,", audio span: ").concat(t));var o=this.list.splice(0,n),r=o.length>0?"".concat(o[0].audioStart," to ").concat(o[o.length-1].audioEnd):"none",i=this.list.length>0?"".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd):"none";c.Hv.sendTraceTag(523568157,u.n.msoulscat_Wac_Dictation,d.k.Info,"AudioStreamPerfTracker.trimBefore: audioEnd: ".concat(e,", culling ").concat(o.length," chunks (audio span ").concat(r,"), new list.length: ").concat(this.list.length,". Audio span was: ").concat(t,", now: ").concat(i))}else c.Hv.sendTraceTag(523568155,u.n.msoulscat_Wac_Dictation,d.k.Info,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!")},e.prototype.getChunksFrom=function(e,t){for(var n,o,r=e+t,i=0;i<this.list.length&&(!n||!o);){var a=this.list[i];!n&&e>=a.audioStart&&e<=a.audioEnd&&(n=a),!o&&r>=a.audioStart&&r<=a.audioEnd&&(o=a),i++}return[n,o]},e.prototype.measureLatency=function(e,t,n){var o=this.getNow(),r=e+t,i=this.getChunksFrom(e,t),a=i[0],s=i[1];if(!a&&!s)return c.Hv.sendTraceTag(523568158,u.n.msoulscat_Wac_Dictation,d.k.Warning,"AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ".concat(r," (").concat(e," + ").concat(t,")")),{service:-1,perceived:-1};if(!a||!s){var l=a?"end":"start",p="none",h=NaN;this.list.length>0&&(p="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),h=a?r-this.list[this.list.length-1].audioEnd:r-this.list[0].audioStart),c.Hv.sendTraceTag(523568159,u.n.msoulscat_Wac_Dictation,d.k.Warning,"AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ".concat(l," of audio, for speechEnd: ").concat(r," (").concat(e," + ").concat(t,"), tracked audio span: ").concat(p,", delta: ").concat(h))}var g=o-Math.max((null==a?void 0:a.localEnd)||0,(null==s?void 0:s.localEnd)||0),f=a?this.getLatencyForChunk(a,e,t,o):-1,m=s?this.getLatencyForChunk(s,r,0,o):-1,y={service:g,perceived:Math.max(f,m)};return(n?this.finals:this.partials).add(y),y},e.prototype.getLatencyForChunk=function(e,t,n,o){return o-(e.localEnd-(e.audioEnd-t))-n},e}(),m=n(7837),y=function(){return(0,h.iP)("Microsoft.Office.WordOnline.DictationUserPerceivedLatencies",!0)||(0,h.iP)("Microsoft.Office.OneNoteOnline.DictationUserPerceivedLatencies",!0)};function v(e,t){return new Promise((function(n,o){t.decodeAudioData(e,n,o)}))}var C=function(){function e(e,t,n,o,r,i,l){void 0===n&&(n=!1),void 0===i&&(i=a.A.Dictation),this.audioContext=null,this.microphoneSessionState=null,this.responseVersion=s.wM.version2,this.fileBytes=null,this._wavFileAudioChunkSize=16e3,this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,this.resolveSendVoiceTilesUsingVoicePacketsPromise=null,l&&(this.augloopSessionUtil=new m.g(l)),this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,y()?(this.audioPerfTracker=new f(1e3),r&&(this.sessionTelemetry=r,r.audioPerfTracker=this.audioPerfTracker)):r&&(this.sessionTelemetry=r),o&&(this.commandTelemetry=o),this.speechToTextProfile=i}return e.prototype.startVoiceSessionFromMicrophoneInput=function(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function(){var a=this;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,[4,this.startAudioCaptureAsync((function(t){if(!a.endVoiceSessionCalled){e&&e(t.inputBuffer);var o,s=a.audioContext?a.audioContext.sampleRate:t.inputBuffer.sampleRate,c=(0,i.eG)(t.inputBuffer.getChannelData(0),s);if(o=a.augloopSessionUtil?a.augloopSessionUtil.submitVoiceTile(c,i.b2,a.useFrontdoorWorkflow,l.A.dictationSettings,a.responseVersion,a.speechToTextProfile,a.sessionTelemetry,null==n?void 0:n.getCommandSet()):r.vh(a.runtimeManager,c,i.b2,a.useFrontdoorWorkflow,l.A.dictationSettings,a.responseVersion,a.speechToTextProfile,a.sessionTelemetry,null==n?void 0:n.getCommandSet()),y()){var u=1e3*t.inputBuffer.duration;a.totalAudioInputDurationMs+=u,a.audioPerfTracker.track(a.totalAudioInputDurationMs,u,o.seq)}a.fdSpeechClientObserver.onAudioData&&a.fdSpeechClientObserver.onAudioData(new Int16Array(c.buffer))}}),t).catch((function(e){return Promise.reject(e)}))];case 1:return o.sent(),[2]}}))}))},e.prototype.sendVoiceTilesUsingVoicePackets=function(e,t){var n=this;return new Promise((function(a,s){return(0,o.__awaiter)(n,void 0,void 0,(function(){var n,c,u,d,p,h,g,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:o.trys.push([0,4,,5]),null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&s(new Error("Please finish sending an audio file (i.e. call endVoiceSession) before sending another one.")),this.resolveSendVoiceTilesUsingVoicePacketsPromise=a,n=this._wavFileAudioChunkSize,c=0,u=n,d=!1,o.label=1;case 1:return c<e.byteLength?this.endVoiceSessionCalled?[3,3]:(p=e.slice(c,u),h=new DataView(p),this.augloopSessionUtil?this.augloopSessionUtil.submitVoiceTile(h,i.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry):r.vh(this.runtimeManager,h,i.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry),g=t&&t.audioFileStreamDelay||300,[4,this.wait(+g)]):[3,3];case 2:return o.sent(),d?[3,3]:(c=u,(u+=n)>e.byteLength&&(u=e.byteLength,d=!0),[3,1]);case 3:return null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null),[3,5];case 4:return f=o.sent(),s(f),[3,5];case 5:return[2]}}))}))}))},e.prototype.resendFileFromTimeOffset=function(e,t){if(!this.fileBytes)throw new Error("Can't resend a file if startVoiceSessionFromAudioFile (or equivalent) has not been called.");if(!this.endVoiceSessionCalled||null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise)throw new Error("Can't resend a file when we are currently sending one. End the voice session first.");var n=e/1e3*i.b2*(i.FA/8),o=t?t/1e3*i.b2*(i.FA/8):void 0;return this.fileBytes=this.fileBytes.slice(n,o),this.endVoiceSessionCalled=!1,this.sendVoiceTilesUsingVoicePackets(this.fileBytes)},e.prototype.startVoiceSessionFromAudioFileFromServer=function(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(n){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),this.fileBytes=e,[2,this.sendVoiceTilesUsingVoicePackets(this.fileBytes,t)]}))}))},e.prototype.readAndSendFile=function(e,t,n){var r=this;void 0===t&&(t=!1);var a=new FileReader,s=new Promise((function(e,s){a.onload=function(){return(0,o.__awaiter)(r,void 0,void 0,(function(){var r,l,c,u,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,4,,5]),this.fileBytes=a.result,!t)return[3,2];if(r=Date.now(),null==(l=new OfflineAudioContext(1,1,i.b2)).decodeAudioData)throw new Error("Browser does not support decodeAudioData");return[4,v(this.fileBytes,l)];case 1:c=o.sent(),this.fileBytes=(0,i.eG)(c.getChannelData(0),i.b2).buffer,u=c.duration,n&&n(Date.now()-r,u),o.label=2;case 2:return[4,this.sendVoiceTilesUsingVoicePackets(this.fileBytes)];case 3:return o.sent(),e(),[3,5];case 4:return d=o.sent(),s(d),[3,5];case 5:return[2]}}))}))},a.onabort=function(){s(new Error("Aborted fileReader"))},a.onerror=function(){s(a.error)}}));return a.readAsArrayBuffer(e),s},e.prototype.startVoiceSessionFromAudioFile=function(e,t,n){return void 0===t&&(t=!1),(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(o){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),[2,this.readAndSendFile(e,t,n)]}))}))},e.prototype.stopVoiceSession=function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this.stopMicrophoneInputAsync()];case 1:return e.sent(),this.endVoiceSession(),[2]}}))}))},e.prototype.endVoiceSession=function(){this.augloopSessionUtil?this.augloopSessionUtil.endAudioProcessor(this.useFrontdoorWorkflow,l.A.dictationSettings,this.sessionTelemetry):r.Yf(this.runtimeManager,this.useFrontdoorWorkflow,l.A.dictationSettings,this.sessionTelemetry),this.endVoiceSessionCalled=!0,null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null)},e.prototype.stopMicrophoneInputAsync=function(){return(0,o.__awaiter)(this,void 0,void 0,(function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:if(this.microphoneSessionState&&(this.microphoneSessionState.mediaStream.getAudioTracks().map((function(e){e.stop()})),this.microphoneSessionState=null),!this.audioContext||"closed"===this.audioContext.state)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.audioContext.close()];case 2:return t.sent(),[3,4];case 3:if(e=t.sent(),c.Hv.sendTraceTag(528871704,u.n.msoulscat_Wac_Dictation,d.k.Warning,"Error closing audioContext: ".concat(e)),"InvalidStateError"!==e.name)throw e;return[3,4];case 4:return[2]}}))}))},e.prototype.startAudioCaptureAsync=function(e,t){var n,r;return(0,o.__awaiter)(this,void 0,void 0,(function(){var i,a,s,l,h,g,f,m;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:i=Date.now(),a=!1,o.label=1;case 1:return o.trys.push([1,7,8,9]),[4,this.createAudioContextAndMicrophoneSessionState(t)];case 2:return s=o.sent(),l=s.context,h=s.sessionState,a=!0,null===(n=this.sessionTelemetry)||void 0===n||n.setRecordingStartTime(Date.now()),null===(r=this.commandTelemetry)||void 0===r||r.setRecordingStartTime(Date.now()),this.endVoiceSessionCalled?[3,5]:(this.audioContext=l,this.microphoneSessionState=h,h.processor.onaudioprocess=e,h.source.connect(h.processor),h.processor.connect(l.destination),window.self.document.hasFocus()?[3,4]:[4,this.waitForWindowFocus(20)]);case 3:o.sent(),o.label=4;case 4:return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),[3,6];case 5:c.Hv.sendTraceTag(573391628,u.n.msoulscat_Wac_Dictation,d.k.Warning,"Audio Capture is cancelled due to VoiceSession closed"),o.label=6;case 6:return[3,9];case 7:return g=o.sent(),f=this.parseMicrophoneErrorMessage(g),this.fdSpeechClientObserver.onError(f),f===p.J.ErrorAudioCaptureAsync?[2,Promise.reject(g)]:[2,Promise.reject(f)];case 8:return m=Date.now()-i,c.Hv.sendTraceTag(589886626,u.n.msoulscat_Wac_Dictation,d.k.Info,"Mic enablement - success: ".concat(a,", duration: ").concat(m)),[7];case 9:return[2]}}))}))},e.prototype.waitForWindowFocus=function(e){void 0===e&&(e=20);var t=Date.now(),n=e;return new Promise((function(e,o){var r=function(){if(n-=1,window.self.document.hasFocus()||n<0){var o=Date.now()-t;c.Hv.sendTraceTag(553747910,u.n.msoulscat_Wac_Dictation,d.k.Info,"waitForWindowFocus duration: ".concat(o,", count: ").concat(n,", window has focus: ").concat(window.self.document.hasFocus())),e()}else setTimeout(r,50)};r()}))},e.prototype.parseMicrophoneErrorMessage=function(e){var t=(0,r.rq)(e);return t.startsWith("NotAllowedError")||t.endsWith("PermissionDeniedError")||t.startsWith("PermissionDeniedError")?p.J.ErrorAudioPermissionDeniedError:t.endsWith("NotFoundError")||t.startsWith("NotFoundError")||t.startsWith("DevicesNotFoundError")?p.J.ErrorAudioDevicesNotFoundError:t.endsWith("MediaDeviceNotSupported")||t.startsWith("NotSupportedError")||t.startsWith("NotReadableError")||t.startsWith("TrackStartError")?p.J.ErrorAudioNotReadableError:(c.Hv.sendTraceTag(538481308,u.n.msoulscat_Wac_Dictation,d.k.Error,"Unexpected microphone error: ".concat(t," (").concat(null==e?void 0:e.name,"-").concat(null==e?void 0:e.message,")")),p.J.ErrorAudioCaptureAsync)},e.prototype.wait=function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},e.prototype.createAudioContextAndMicrophoneSessionState=function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,a,s=this;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=0,o.label=1;case 1:return o.trys.push([1,,3,4]),t=window.setTimeout((function(){t=0,s.fdSpeechClientObserver.showPermissionPrompt&&s.fdSpeechClientObserver.showPermissionPrompt()}),2e3),n=!e||{deviceId:e},[4,navigator.mediaDevices.getUserMedia({audio:n})];case 2:return r=o.sent(),null===(i=window.AudioContext||window.webkitAudioContext)?[2,Promise.reject("Browser doesn't support AudioContext")]:[2,{context:a=new i,sessionState:{mediaStream:r,source:a.createMediaStreamSource(r),processor:a.createScriptProcessor(16384,1,1)}}];case 3:return t>0&&window.clearTimeout(t),[7];case 4:return[2]}}))}))},e}()},35620:(e,t,n)=>{n.d(t,{mp:()=>T,qW:()=>E});var o,r,i=n(79490),a=n(18878),s=n(29946),l=n(42387),c=n(16248),u=n(63369),d=n(79715),p=n(71446),h=n(27420),g=n(76916),f=n(26529),m=!1,y=[],v=2e4;function C(e){b({kind:"event",event:e,timestamp:(new Date).getTime()})}function b(e){m&&(o?o(e):y.length<=v?y.push(e):1)}!function(e){e.Count="Count",e.Avg="Avg",e.Sum="Sum"}(r||(r={}));var E,A=n(14743),S=n(7837),I=n(58651),P=function(){return(0,A.iP)("Microsoft.Office.WordOnline.DictationUserPerceivedLatencies",!0)||(0,A.iP)("Microsoft.Office.OneNoteOnline.DictationUserPerceivedLatencies",!0)};!function(e){e[e.FinalResult=0]="FinalResult",e[e.PartialResult=1]="PartialResult"}(E||(E={}));var T=function(){function e(e,t,n,o,r,i,a){void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===i&&(i=s.A.Dictation);var c,u,d=this;this.initialized=!1,this.speechSessionEventToken=null,this.speechToTextPartialResultToken=null,this.speechToTextFinalResultToken=null,this.speechErrorEventToken=null,this.speechQualityEventToken=null,this.useDebugDictation=!1,a&&(this.augloopSessionUtil=new S.g(a)),this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,this.speechToTextProfile=i,this.startRecognitionInSpeechToTextClient=o,this.enableSetAnnotationsFromALVoiceClient=!!r,this.annotationObserver={onAnnotationResult:function(e){d.onAnnotationResult(e)}};var p=new URLSearchParams(null===(c=window.location.search)||void 0===c?void 0:c.toLowerCase()),h=null!==(u=l.A.dictationSettings.properties)&&void 0!==u?u:{};this.useDebugDictation="true"===p.get("wddictationdebugmode"),this.useDebugDictation&&(h.EnableAudioLogging="true");var g=p.get("wdspeechdomain");g&&(h.wdSpeechDomain=decodeURIComponent(g)),l.A.dictationSettings={properties:h}}return e.logPhraseId_old=function(e,t,n,o){e&&C({name:"Office.Voice.Online.PhraseReceived",dataFields:[{name:"PhraseID",string:e},{name:"ConnectionID",string:t},{name:"SessionID",string:n},{name:"MessageType",string:o}]})},e.logPhraseId=function(e,t,n){var o,r=null===(o=n.properties.JsonResult)||void 0===o?void 0:o.Id;if(r&&t&&n){var i={name:"Office.Voice.Online.PhraseReceived",dataFields:[{name:"PhraseID",string:r},{name:"ConnectionID",string:t.connectionID},{name:"SessionID",string:t.sessionID},{name:"MessageType",string:e},{name:"voiceLatency",int64:n.properties.audioLatency}]};if(n.properties.commandLatency&&i.dataFields.push({name:"commandLatency",int64:n.properties.commandLatency}),t.audioPerfTracker&&n.properties.JsonResult&&n.properties.JsonResult.Offset&&n.properties.JsonResult.Duration){var a=n.properties.JsonResult.Offset/1e4,s=n.properties.JsonResult.Duration/1e4,l="final"===e,c=t.audioPerfTracker.measureLatency(a,s,l);i.dataFields.push({name:"perceivedLatency",int64:c.perceived}),i.dataFields.push({name:"serviceLatency",int64:c.service})}C(i)}},e.prototype.initializeAsync=function(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,o,r,s,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=this.checkAnnotationActive(),h.Hv.sendTraceTag(521417154,g.n.msoulscat_Wac_Dictation,f.k.Info,"SpeechToTextClient.initializeAsync - initialized: ".concat(this.initialized,", annotationsActive: ").concat(n)),n?(h.Hv.sendTraceTag(521417153,g.n.msoulscat_Wac_Dictation,f.k.Warning,"Releasing old annotations"),[4,this.uninitializeAsync()]):[3,2];case 1:i.sent(),i.label=2;case 2:t&&(this.sessionTelemetry=t),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.activateAnnotations(e)];case 4:return i.sent(),this.warmUpAugloop(),this.initialized=!0,[3,6];case 5:if(o=i.sent(),r="SpeechToTextClient.initializeAsync - Activate Annotations - "+o.message,s={errorType:a.yA.ErrorAugloopActivateAnnotations,errorMsg:r+" - Error stack: "+o.stack},!o.message)try{l={},Object.getOwnPropertyNames(o).forEach((function(e){return l[e]=o[e]})),h.Hv.sendTraceTag(509745299,g.n.msoulscat_Wac_Dictation,f.k.Error,"Odd error: "+JSON.stringify(l))}catch(e){h.Hv.sendTraceTag(509745298,g.n.msoulscat_Wac_Dictation,f.k.Error,"Failed to diagnose odd error: "+a.rq(e))}return r.includes("Timeout waiting for response")?this.fdSpeechClientObserver.onWarning(s):this.fdSpeechClientObserver.onError(s),[3,6];case 6:return[2]}}))}))},e.prototype.uninitializeAsync=function(){var e;return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r,s,l=this;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:t=this.checkAnnotationActive(),h.Hv.sendTraceTag(521417152,g.n.msoulscat_Wac_Dictation,f.k.Info,"SpeechToTextClient.uninitializeAsync - initialized: ".concat(this.initialized,", annotationsActive: ").concat(t)),this.initialized=!1,o=(n=["speechSessionEventToken","speechToTextPartialResultToken","speechToTextFinalResultToken","speechQualityEventToken","speechErrorEventToken"]).map((function(e){return l[e]})).filter((function(e){return!!e})),i.label=1;case 1:return i.trys.push([1,6,,7]),this.augloopSessionUtil?[4,this.augloopSessionUtil.releaseAnnotations(o)]:[3,3];case 2:return i.sent(),[3,5];case 3:return[4,a.yw(this.runtimeManager,o)];case 4:i.sent(),i.label=5;case 5:return[3,7];case 6:return r=i.sent(),s="SpeechToTextClient.uninitializeAsync - Release Annotations - "+r.message,null===(e=this.sessionTelemetry)||void 0===e||e.onAugloopError(s),h.Hv.sendTraceTag(521417123,g.n.msoulscat_Wac_Dictation,f.k.Error,"SpeechToTextClient.uninitializeAsync - Release Annotations - Error message: "+s+" - Error stack: "+r.stack),[3,7];case 7:return n.forEach((function(e){return l[e]=null})),[2]}}))}))},e.prototype.checkAnnotationActive=function(){return null!==this.speechSessionEventToken||null!==this.speechToTextPartialResultToken||null!==this.speechToTextFinalResultToken||null!==this.speechQualityEventToken||null!==this.speechErrorEventToken},e.prototype.getAnnotationObserver=function(){return this.annotationObserver},e.prototype.activateAnnotations=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return this.augloopSessionUtil?[4,this.activateAnnotationsUsingALSession(e)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,this.activateAnnotationsUsingRuntimeManager(e)];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},e.prototype.activateAnnotationsUsingRuntimeManager=function(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n,o,r,s,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=a.Rd(this.runtimeManager,c.lM.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),n=a.Rd(this.runtimeManager,c.D_.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),o=null,e.indexOf(E.PartialResult)>=0&&(o=a.Rd(this.runtimeManager,c.ZF.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),r=null,e.indexOf(E.FinalResult)>=0&&(r=a.Rd(this.runtimeManager,c.mh.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),s=a.Rd(this.runtimeManager,c._K.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.useDebugDictation&&I.warn("This dictation session will be logging audio"),[4,Promise.all([n,o,r,s,t])];case 1:return l=i.sent(),this.speechSessionEventToken=l[0],this.speechToTextPartialResultToken=l[1],this.speechToTextFinalResultToken=l[2],this.speechQualityEventToken=l[3],this.speechErrorEventToken=l[4],[2]}}))}))},e.prototype.warmUpAugloop=function(){this.augloopSessionUtil?this.augloopSessionUtil.startAudioProcessor(this.useFrontdoorWorkflow,l.A.dictationSettings,u.wM.version2,this.speechToTextProfile,this.sessionTelemetry):a.j9(this.runtimeManager,this.useFrontdoorWorkflow,l.A.dictationSettings,u.wM.version2,this.speechToTextProfile,this.sessionTelemetry)},e.prototype.onAnnotationResult=function(e){var t=this;a.Jh(e,c.lM.getTypeName()).map((function(e){t.handleSpeechErrorEvent(e.body)})),a.Jh(e,c.D_.getTypeName()).map((function(e){t.handleSpeechSessionEvent(e.body)})),a.Jh(e,c.ZF.getTypeName()).map((function(e){t.handleSpeechToTextPartialResult(e.body)})),a.Jh(e,c.mh.getTypeName()).map((function(e){var n=e.body,o=n.text;x(t.fdSpeechClientObserver,n,o,t.sessionTelemetry)})),a.Jh(e,c._K.getTypeName()).map((function(e){var n=e.body;n.eventInfo&&n.eventInfo.eventName===d.$O.QualityStatusUpdate&&t.handleSpeechQualityEvent(n.eventInfo)}))},e.prototype.handleSpeechErrorEvent=function(e){e&&(h.Hv.sendTraceTag(521417122,g.n.msoulscat_Wac_Dictation,f.k.Warning,JSON.stringify(e)),e.ErrorState===u.o2.FINAL&&e.ErrorImpact===u.$O.NO_DICTATION?(h.Hv.sendTraceTag(521417121,g.n.msoulscat_Wac_Dictation,f.k.Error,JSON.stringify(e)),this.fdSpeechClientObserver.onError(e.ErrorCode)):e.ErrorState===u.o2.INTERMITTENT&&e.ErrorImpact===u.$O.NO_DICTATION?h.Hv.sendTraceTag(521417120,g.n.msoulscat_Wac_Dictation,f.k.Warning,JSON.stringify(e)):e.ErrorState===u.o2.FINAL&&e.ErrorImpact===u.$O.NO_COMMANDING&&(h.Hv.sendTraceTag(521417119,g.n.msoulscat_Wac_Dictation,f.k.Warning,JSON.stringify(e)),this.fdSpeechClientObserver.showDictationWarning(e.ErrorCode,e.ErrorImpact)))},e.prototype.handleSpeechSessionEvent=function(e){var t;switch(e.eventId){case p.P_.SpeechRecognitionStarted:this.transcriberId=e.sessionId,this.useDebugDictation&&I.warn("Speech transcriberId: ".concat(this.transcriberId)),this.startRecognitionInSpeechToTextClient&&this.fdSpeechClientObserver.onSpeechRecognitionStarted();break;case p.P_.SpeechRecognitionStopped:null===(t=this.sessionTelemetry)||void 0===t||t.setEndReason("SpeechRecognitionStopped"),this.fdSpeechClientObserver.onSpeechEnd();break;case p.P_.SpeechSessionStarted:if(this.speechSessionId=e.sessionId,this.useDebugDictation&&I.warn("Speech speechSessionId: ".concat(this.speechSessionId)),this.fdSpeechClientObserver.onSpeechSessionStarted&&this.speechSessionId){var n={speechSessionId:this.speechSessionId,transcriptionSignature:""};this.fdSpeechClientObserver.onSpeechSessionStarted(n)}break;case p.P_.SpeechSessionStopped:this.fdSpeechClientObserver.onSpeechSessionStopped&&this.fdSpeechClientObserver.onSpeechSessionStopped();break;default:I.warn("Unexpected speechSessionEventId: ".concat(e.eventId))}},e.prototype.handleSpeechToTextPartialResult=function(t){var n,o,r,i,a,s;if(""!==t.text){var l=new Map([[t.language,t.text]]);null===(n=this.sessionTelemetry)||void 0===n||n.onPartialResultAnnotationResponse(Date.now(),null===(o=t.properties.JsonResult)||void 0===o?void 0:o.Offset,null===(r=t.properties.JsonResult)||void 0===r?void 0:r.Duration);var c=new Map;c.set("JsonResult",JSON.stringify(t.properties.JsonResult)),this.fdSpeechClientObserver.onFragmentText(l,c),P()?this.sessionTelemetry&&e.logPhraseId("partial",this.sessionTelemetry,t):e.logPhraseId_old(null===(i=t.properties.JsonResult)||void 0===i?void 0:i.Id,null===(a=this.sessionTelemetry)||void 0===a?void 0:a.connectionID,null===(s=this.sessionTelemetry)||void 0===s?void 0:s.sessionID,"partial")}},e.prototype.handleSpeechQualityEvent=function(e){this.fdSpeechClientObserver.onEventUpdate(e)},e.prototype.activateAnnotationsUsingALSession=function(e){var t,n,o,r,a;return(0,i.__awaiter)(this,void 0,void 0,(function(){var s,l,u,d,p,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return s=null===(t=this.augloopSessionUtil)||void 0===t?void 0:t.activateAnnotationAsync(c.lM.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),l=null===(n=this.augloopSessionUtil)||void 0===n?void 0:n.activateAnnotationAsync(c.D_.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),u=null,e.indexOf(E.PartialResult)>=0&&(u=null===(o=this.augloopSessionUtil)||void 0===o?void 0:o.activateAnnotationAsync(c.ZF.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),d=null,e.indexOf(E.FinalResult)>=0&&(d=null===(r=this.augloopSessionUtil)||void 0===r?void 0:r.activateAnnotationAsync(c.mh.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient)),p=null===(a=this.augloopSessionUtil)||void 0===a?void 0:a.activateAnnotationAsync(c._K.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.useDebugDictation&&I.warn("This dictation session will be logging audio"),[4,Promise.all([l,u,d,p,s])];case 1:return h=i.sent(),this.speechSessionEventToken=h[0],this.speechToTextPartialResultToken=h[1],this.speechToTextFinalResultToken=h[2],this.speechQualityEventToken=h[3],this.speechErrorEventToken=h[4],[2]}}))}))},e}();function x(e,t,n,o){var r,i,a,s=new Map([[t.language,n]]);o&&""!==n&&o.onFinalResultAnnotationResponse(Date.now(),null===(r=t.properties.JsonResult)||void 0===r?void 0:r.Offset,null===(i=t.properties.JsonResult)||void 0===i?void 0:i.Duration);var l=new Map;l.set("JsonResult",JSON.stringify(t.properties.JsonResult)),e.onFinalText(s,l),P()?o&&""!==n&&T.logPhraseId("final",o,t):T.logPhraseId_old(null===(a=t.properties.JsonResult)||void 0===a?void 0:a.Id,null==o?void 0:o.connectionID,null==o?void 0:o.sessionID,"final")}},54127:(e,t,n)=>{var o;n.d(t,{J:()=>o}),function(e){e.ErrorAudioPermissionDeniedError="ErrorAudioPermissionDeniedError",e.ErrorAudioDevicesNotFoundError="ErrorAudioDevicesNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioCaptureAsync="ErrorAudioCaptureAsync"}(o||(o={}))},99154:(e,t,n)=>{n.d(t,{FA:()=>r,b2:()=>o,eG:()=>i});var o=16e3,r=16,i=function(e,t){var n=a(e,t,o),r=new ArrayBuffer(2*n.length),i=new DataView(r);return s(i,0,n),i},a=function(e,t,n){if(n===t||n>t)return e;if(null==e)return new Float32Array(0);for(var o=t/n,r=Math.round(e.length/o),i=new Float32Array(r),a=0,s=0;s<r;){for(var l=Math.round((s+1)*o),c=0,u=0;a<l&&a<e.length;)c+=e[a],a+=1,u+=1;i[s]=c/u,s+=1}return i},s=function(e,t,n){for(var o=0,r=t;o<n.length;o+=1,r+=2){var i=Math.max(-1,Math.min(1,n[o]));e.setInt16(r,i<0?32768*i:32767*i,!0)}}},18878:(e,t,n)=>{n.d(t,{Jh:()=>E,Rd:()=>f,Yf:()=>v,bU:()=>A,j9:()=>y,rq:()=>b,vh:()=>C,yA:()=>o,yw:()=>m});var o,r=n(79490),i=n(67001),a=n(61158),s=n(26115),l=n(84623),c=n(99154),u=n(27420),d=n(76916),p=n(26529),h=0;!function(e){e.ErrorAugloopActivateAnnotations="ErrorAugloopActivateAnnotations"}(o||(o={}));var g=function(e,t,n){var o=new i.VR({item:{id:h.toString(),body:t}});e.submitCustomMessage({message:o}).catch((function(e){A(e,n)}))},f=function(e,t,n,o){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var i,a;return(0,r.__generator)(this,(function(r){switch(r.label){case 0:return u.Hv.sendTraceTag(508151006,d.n.msoulscat_Wac_Dictation,p.k.Info,"Start to activate annotations of: "+t),o?[4,e.activateAnnotation({annotationType:t,handler:function(e){n&&n.onAnnotationResult(e)}})]:[3,2];case 1:return a=r.sent(),[3,4];case 2:return[4,e.activateAnnotation({annotationType:t})];case 3:a=r.sent(),r.label=4;case 4:return(i=a)||u.Hv.sendTraceTag(508151005,d.n.msoulscat_Wac_Dictation,p.k.Error,"activateAnnotationAsync: Missing activationResult!"),[2,null==i?void 0:i.token]}}))}))},m=function(e,t){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var n;return(0,r.__generator)(this,(function(o){switch(o.label){case 0:return u.Hv.sendTraceTag(508151004,d.n.msoulscat_Wac_Dictation,p.k.Info,"Releasing annotation tokens: ".concat(t)),n=t.map((function(t){return u.Hv.sendTraceTag(508151003,d.n.msoulscat_Wac_Dictation,p.k.Info,"Start to release annotation of: "+t),t?e.releaseAnnotation({token:t}).catch((function(e){u.Hv.sendTraceTag(508151002,d.n.msoulscat_Wac_Dictation,p.k.Error,"Failed to release annotation ".concat(t,": ").concat(e.message))})):Promise.resolve()})),[4,Promise.all(n)];case 1:return o.sent(),[2]}}))}))},y=function(e,t,n,o,r,i){var a=n.dictationLanguage,s=n.useAutoPunctuation,f=n.useCorrections,m=n.useVoiceCommands;u.Hv.sendTraceTag(508151001,d.n.msoulscat_Wac_Dictation,p.k.Info,"Sending empty warm-up tile, seq: ".concat(h,", dictationLanguage: ").concat(a,", useAutoPunctuation: ").concat(s,", useCorrections: ").concat(f,", useVoiceCommands: ").concat(m,", speechToTextProfile: ").concat(r));var y=new l.jP({sampleRate:c.b2,useFrontdoorWorkflow:t,seq:h,dictationSettings:n,responseVersion:o,speechToTextProfile:r,commandSet:["warm-up"]});g(e,y,i),h+=1},v=function(e,t,n,o){u.Hv.sendTraceTag(508151e3,d.n.msoulscat_Wac_Dictation,p.k.Info,"Sending empty tile with endVoiceSession:true, seq: ".concat(h));var r=new l.jP({endVoiceSession:!0,sampleRate:c.b2,useFrontdoorWorkflow:t,seq:h,dictationSettings:n});g(e,r,o),h+=1},C=function(e,t,n,o,r,i,a,s,c){void 0===c&&(c=[]);var u=new l.jP({sampleRate:n,useFrontdoorWorkflow:o,seq:h,dictationSettings:r,responseVersion:i,data:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),speechToTextProfile:a,commandSet:c});return g(e,u,s),h+=1,u},b=function(e){var t="".concat(e).trimLeft();if(t.startsWith("[object "))try{var n=(null==e?void 0:e.name)&&(null==e?void 0:e.message)?"".concat(e.name,": ").concat(e.message):(null==e?void 0:e.message)?e.message:(null==e?void 0:e.name)?e.name:JSON.stringify(e);return n?t+" "+n:t}catch(e){var o="stringifyException error: ".concat(e.name,": ").concat(e.message);return u.Hv.sendTraceTag(508150999,d.n.msoulscat_Wac_Dictation,p.k.Error,o),t+" "+o}return t};var E=function(e,t){return a.h.getTypeNameFor(e)!==s.Xr.getTypeName()&&a.h.getTypeNameFor(e)!==s.fZ.getTypeName()||0===e.items.length?[]:e.items.filter((function(e){return e.body&&a.h.getTypeNameFor(e.body)===t}))};function A(e,t){var n,o;(null==t?void 0:t.onTileSubmitFailed)&&t.onTileSubmitFailed();var r=null!==(o=null!==(n=null==e?void 0:e.error)&&void 0!==n?n:null==e?void 0:e.message)&&void 0!==o?o:null==e?void 0:e.toString();switch(r){case"Timeout waiting for response":case"Cancelled":case"Message is dropped as oldest in full queue":return;default:u.Hv.sendTraceTag(508150998,d.n.msoulscat_Wac_Dictation,p.k.Error,"submitVoiceTile error: ".concat(b(r)))}}},7837:(e,t,n)=>{n.d(t,{g:()=>d});var o=n(79490),r=n(27420),i=n(76916),a=n(26529),s=n(84623),l=n(99154),c=n(67001),u=n(18878),d=function(){function e(e){var t=this;this.tileSequence=0,this.releaseAnnotations=function(e){return(0,o.__awaiter)(t,void 0,void 0,(function(){var t,n=this;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return r.Hv.sendTraceTag(508151298,i.n.msoulscat_Wac_Dictation,a.k.Info,"Releasing annotation tokens: ".concat(e)),t=e.map((function(e){var t;return r.Hv.sendTraceTag(508151297,i.n.msoulscat_Wac_Dictation,a.k.Info,"Start to release annotation of: "+e),e?null===(t=n.alSession)||void 0===t?void 0:t.releaseAnnotation(e).catch((function(t){r.Hv.sendTraceTag(508151296,i.n.msoulscat_Wac_Dictation,a.k.Error,"Failed to release annotation ".concat(e,": ").concat(t.message))})):Promise.resolve()})),[4,Promise.all(t)];case 1:return o.sent(),[2]}}))}))},this.startAudioProcessor=function(e,n,o,c,u){var d=n.dictationLanguage,p=n.useAutoPunctuation,h=n.useCorrections,g=n.useVoiceCommands;r.Hv.sendTraceTag(508151267,i.n.msoulscat_Wac_Dictation,a.k.Info,"Sending empty warm-up tile, seq: ".concat(t.tileSequence,", dictationLanguage: ").concat(d,", useAutoPunctuation: ").concat(p,", useCorrections: ").concat(h,", useVoiceCommands: ").concat(g,", speechToTextProfile: ").concat(c));var f=new s.jP({sampleRate:l.b2,useFrontdoorWorkflow:e,seq:t.tileSequence,dictationSettings:n,responseVersion:o,speechToTextProfile:c,commandSet:["warm-up"]});t.submitMicroSync(f,u),t.tileSequence+=1},this.activateAnnotationAsync=function(e,n,s){return(0,o.__awaiter)(t,void 0,void 0,(function(){var t,l,c,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return r.Hv.sendTraceTag(508151266,i.n.msoulscat_Wac_Dictation,a.k.Info,"Start to activate annotations of: "+e),s?[4,null===(c=this.alSession)||void 0===c?void 0:c.activateAnnotation(e,{callback:function(e){n&&n.onAnnotationResult(e)}})]:[3,2];case 1:return l=o.sent(),[3,4];case 2:return[4,null===(u=this.alSession)||void 0===u?void 0:u.activateAnnotation(e)];case 3:l=o.sent(),o.label=4;case 4:return(t=l)||r.Hv.sendTraceTag(508151265,i.n.msoulscat_Wac_Dictation,a.k.Error,"activateAnnotationAsync: Missing activationResult!"),[2,null==t?void 0:t.token]}}))}))},this.endAudioProcessor=function(e,n,o){r.Hv.sendTraceTag(508151264,i.n.msoulscat_Wac_Dictation,a.k.Info,"Sending empty tile with endVoiceSession:true, seq: ".concat(t.tileSequence));var c=new s.jP({endVoiceSession:!0,sampleRate:l.b2,useFrontdoorWorkflow:e,seq:t.tileSequence,dictationSettings:n});t.submitMicroSync(c,o),t.tileSequence+=1},this.submitVoiceTile=function(e,n,o,r,i,a,l,c){void 0===c&&(c=[]);var u=new s.jP({sampleRate:n,useFrontdoorWorkflow:o,seq:t.tileSequence,dictationSettings:r,responseVersion:i,data:new Uint8Array(e.buffer,e.byteOffset,e.byteLength),speechToTextProfile:a,commandSet:c});return t.submitMicroSync(u,l),t.tileSequence+=1,u},this.alSession=e}return e.prototype.submitMicroSync=function(e,t){var n,o=new c.VR({item:{id:this.tileSequence.toString(),body:e}});null===(n=this.alSession)||void 0===n||n.submitCustomMessage(o).catch((function(e){(0,u.bU)(e,t)}))},e}()},55076:(e,t,n)=>{n.d(t,{eM:()=>r});n(52288);var o="MidgardClipboardUtilsHiddenInput",r=function(e,t,n){var o=t||document;return navigator.clipboard?navigator.clipboard.writeText(e).then((function(){return!0})).catch((function(){return i(e,o,n)})):i(e,o,n)},i=function(e,t,n){var r=t.activeElement,i=t.createElement("textarea");i.tabIndex=-1,i.readOnly=!0,i.style.opacity="0",i.style.position="fixed",i.style.right="-9999px",i.style.bottom="-9999px",i.id=o;var a=t.createElement("div");a.onselectstart=function(e){return e.stopPropagation()},a.appendChild(i);var s,l=n||t.body;l.appendChild(a),i.value=e,i.focus(),i.select();try{t.execCommand("copy"),s=!0}catch(e){s=!1}return r&&r.focus&&r.focus(),l.removeChild(a),Promise.resolve(s)}},21278:(e,t,n)=>{n.d(t,{Q:()=>l,m:()=>c});var o=n(79490),r=n(70898),i=n(30112),a=n(8520),s=(0,r.m)([],"ComponentStylingPureFluentOverrides");function l(e,t){function n(){var n=t(),r=(0,a.useContext)(s).map((function(t){return t[e]})).filter((function(e){return!!e})),l=(0,o.__assign)({},n),c=function(e){if(Object.prototype.hasOwnProperty.call(n,e)){var t=n[e],a=r.map((function(t){return t[e]})).filter((function(e){return!!e})),s=i.z.apply(void 0,(0,o.__spreadArray)([t],(0,o.__read)(a),!1));l[e]=s}};for(var u in n)c(u);return l}return n.componentName=e,n.__version="fluent",n}function c(e){var t=s.Consumer,n=s.Provider;return function(r){var i=r.children,s={};for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var c=e[l];c&&(s[l]=c())}return a.createElement(t,null,(function(e){var t=(0,o.__spreadArray)([s],(0,o.__read)(e),!1);return a.createElement(n,{value:t},i)}))}}},67621:(e,t,n)=>{n.d(t,{I:()=>s});var o=n(21278),r=n(658),i=n(62653),a=n(16895);const s=(0,o.Q)("AuthButton",(0,r.n)({authButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({width:"auto",height:"32px",backgroundColor:i.L.colorNeutralBackground1},a.Pt.borderRadius("4px")),a.Pt.borderWidth("1px")),a.Pt.borderColor(i.L.colorNeutralStroke1)),a.Pt.gap("4px")),a.Pt.padding("5px 12px 5px 12px")),errorText:{marginBottom:"12px",lineHeight:"20px"}}))},21394:(e,t,n)=>{n.d(t,{N:()=>V});var o=n(6837);const r=3e5;class i{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({eventId:o.Bw.AuthSDK,type:o.FY.LogMetric,tag:this.tag,name:this.name,success:o.YE.Failure,duration:r,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),r)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({eventId:o.Bw.AuthSDK},e),{type:o.FY.LogMetric,tag:this.tag,name:this.name,success:o.YE.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({eventId:o.Bw.AuthSDK},e),{type:o.FY.LogMetric,tag:this.tag,name:this.name,success:o.YE.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}var a=n(89685),s=n(18850),l=n(21491),c=n(30112),u=n(93536),d=n(21137),p=n(50083),h=n(8520),g=n(6775),f=n(79417),m=n(76321);function y(e){if(e){if(e.startsWith("P_"))return e;if(e.startsWith("T_"))return"T_";if(e.startsWith("U_"))return"U_"}return""}var v=n(82794),C=n(86122);const b=Object.assign({},v.o),E=Object.assign({},C.C);var A=n(70558);var S=n(67621),I=n(92153),P=n(21278),T=n(658),x=n(16895);const w=(0,P.Q)("AuthButtonAppIcon",(0,T.n)({appIconContainer:Object.assign({},x.Pt.margin("auto")),appIcon:Object.assign({width:"20px",height:"20px"},x.Pt.borderRadius("4px"))})),k=e=>{const{appIcon:t}=e,n=w();return h.createElement("div",{className:n.appIconContainer},h.createElement(I._,{src:t,className:n.appIcon}))};var _=n(65593),D=n(10145);const F=(0,s.qP)("copilot-ext-auth-sdk.pluginAuthTextWithAppName"),L=(0,s.Ex)("copilot-ext-auth-sdk.pluginAuthTextWithoutAppName"),O=(0,s.qP)("copilot-ext-auth-sdk.pluginConfigTextWithAppName"),R=(0,s.Ex)("copilot-ext-auth-sdk.pluginConfigTextWithoutAppName"),M=(0,P.Q)("AuthButtonTitle",(0,T.n)({titleContainer:Object.assign(Object.assign({},x.Pt.padding("0px 0px 2px 2px")),{display:"flex",flexDirection:"column",alignItems:"flex-start"}),title:Object.assign({fontWeight:"600",fontSize:"14px",lineHeight:"20px",textOverflow:"ellipsis"},x.Pt.overflow("ellipsis"))})),B=e=>{const{appName:t,requestType:n}=e,o=(0,_.mY)({pluginAuthTextWithAppName:F,pluginConfigTextWithAppName:O}),r=(0,_.kQ)({pluginAuthTextWithoutAppName:L,pluginConfigTextWithoutAppName:R});let i;i="auth"===n||"silentAuth"===n||"APIPluginAuth"===n||"TypeAPowerPlatformAuth"===n?t?o.pluginAuthTextWithAppName({appName:t}):r.pluginAuthTextWithoutAppName():t?o.pluginConfigTextWithAppName({appName:t}):r.pluginConfigTextWithoutAppName();const a=M();return h.createElement("div",{className:a.titleContainer},h.createElement(D.E,{className:a.title},i))},N=412,V=e=>{const{requestType:t,url:n,originalBotInvokeRequest:r,originalAPIPluginAuthRequest:v,activityProvider:C,resultCallBack:I,appService:P,theme:T,locale:x,telemetryService:w,scenarioName:_,customStyles:D,isAPIPluginsAuthEnabled:F,appId:L,onInterstitialAuthCompletionCallback:O,apiPluginsAuthSkillEnabled:R,enableTimedOutPromiseForAuth:M,msgExtAuthSkillEnabled:V,isAPIPlugin:H}=e,[U,j]=h.useState(!0);h.useEffect((()=>{F&&H&&async function(e,t,n,r,i,a){var s,c,u,d,p,h,g,f,m,v,C,b,E,A,S,I,P,T,x,w,k,_,D,F,L;try{const o={id:e},r=await t.getApp(o),l=null===(c=null===(s=r.titleInfo)||void 0===s?void 0:s.titleDefinition)||void 0===c?void 0:c.elementDefinitions;if(!l)return{referenceId:void 0,appName:void 0,appIcon:void 0};const y=null===(u=l.gpts)||void 0===u?void 0:u.find((e=>e.id===i)),O=null===(d=null==y?void 0:y.actions)||void 0===d?void 0:d.find((e=>e.id===a)),R=null===(p=l.declarativeCopilots)||void 0===p?void 0:p.find((e=>e.id===i)),M=null===(h=null==R?void 0:R.actions)||void 0===h?void 0:h.find((e=>e.id===a)),B=null!==(g=null!=M?M:O)&&void 0!==g?g:null===(f=l.plugins)||void 0===f?void 0:f[0],N=null!==(b=null===(C=null===(v=null===(m=r.titleInfo)||void 0===m?void 0:m.titleDefinition)||void 0===v?void 0:v.iconLarge)||void 0===C?void 0:C.uri)&&void 0!==b?b:null===(S=null===(A=null===(E=r.titleInfo)||void 0===E?void 0:E.titleDefinition)||void 0===A?void 0:A.iconSmall)||void 0===S?void 0:S.uri,V=null===(P=null===(I=r.titleInfo)||void 0===I?void 0:I.titleDefinition)||void 0===P?void 0:P.validDomains;return{referenceId:null===(w=null===(x=null===(T=null==B?void 0:B.runtimes)||void 0===T?void 0:T[n])||void 0===x?void 0:x.auth)||void 0===w?void 0:w.referenceId,appName:null!==(D=null!==(_=null!==(k=null==B?void 0:B.nameForHuman)&&void 0!==k?k:null==R?void 0:R.name)&&void 0!==_?_:null==y?void 0:y.name)&&void 0!==D?D:null===(L=null===(F=r.titleInfo)||void 0===F?void 0:F.titleDefinition)||void 0===L?void 0:L.name,appIcon:N,validDomains:V}}catch(t){return null==r||r.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:l.kA.GetAppDataForAPIPlugins,tag:l.d7.GetAppDataForAPIPlugins,success:o.YE.Failure,titleId:y(e),diagnosticsData:`Error while getting app data ${(null==t?void 0:t.message)||t}`}),{referenceId:void 0,appName:void 0,appIcon:void 0,validDomains:void 0}}}(L,P,(null==v?void 0:v.pluginRuntimeId)||0,w,null==v?void 0:v.gptId,null==v?void 0:v.gptActionId).then((e=>{K(e),j(!1),G({type:t,titleId:(null==v?void 0:v.titleId)||"",oauthConfigId:e.referenceId||"",url:n||"",onActivityCompletion:e=>Promise.resolve(!0)})}))}),[L,P]);const[z,G]=h.useState(H?F?{type:t,titleId:(null==v?void 0:v.titleId)||"",oauthConfigId:"",url:n||"",onActivityCompletion:e=>Promise.resolve(!0)}:void 0:{type:t,url:n||"",isSilent:!0,originalInvokeRequest:r,onActivityCompletion:e=>Promise.resolve(!0)}),W=(0,S.I)(),q=h.useMemo((()=>function(e){let t;return t=e?"light"===e?b:E:b,t}(T)),[T]),[Q,K]=h.useState({appName:void 0,appIcon:void 0}),[Y,$]=h.useState(void 0);h.useEffect((()=>{!H&&(0,m.Y)(L,P,w).then((e=>{K(e),j(!1)}))}),[L,P]),h.useEffect((()=>{const e=x?(0,s.U5)(x):(0,s.U5)("en-us");(0,s.ex)().then((t=>{t!==x&&(0,s.Gd)(e)}))}),[x]);const J=h.useCallback((()=>{if(!z)return;j(!0);const e=new i(l.FG.AuthRenderingTime,l.Ih.AuthRenderingTime,w),t={};t[l.kn.AuthScenario]=_,t[l.kn.AuthType]=(e=>{switch(e.type){case"auth":return l.hT.Auth;case"config":return l.hT.Config;case"silentAuth":return l.hT.SilentAuth;case"botInvoke":return l.hT.BotInvoke;case"APIPluginAuth":return l.hT.APIPluginAuth;default:return l.hT.Unknown}})(z),t[l.kn.InterstitialAuth]=R||V?1:0;const n=new g.B(C,w),r=M?function(e,t,n=6e4){return new Promise(((r,i)=>{const a=setTimeout((()=>{null==t||t.LogInfo({eventId:o.Bw.AuthSDK,type:o.FY.LogMetric,tag:l.d7.TimedOutBasedPromise,name:l.Ih.AuthRenderingTime}),r()}),n);e.then((e=>{clearTimeout(a),r(e)})).catch((e=>{clearTimeout(a),i(e)}))}))}(n.execute(z),w):n.execute(z);r.then((n=>{if(j(!1),"object"==typeof n){let o;switch((0,f.u)(n)){case"result":G(void 0),e.logMetricEnd({props:t},(0,a.DA)()),null==I||I(n),O&&V&&O();break;case void 0:e.logMetricEndWithError({props:t,diagnosticsData:"unknown auth response type"},(0,a.DA)()),null==I||I(n);break;default:e.logMetricEnd({props:t,message:l.NZ.PartialAuthSuccess},(0,a.DA)()),o=(0,A.UX)(z,n),G(o)}}else e.logMetricEnd({props:t},(0,a.DA)()),G(void 0),$(void 0),O&&R&&O()})).catch((n=>{if(j(!1),n instanceof Response&&n.status===N&&Y!==N&&"silentAuth"===z.type&&z.url)return $(N),G(Object.assign(Object.assign({},z),{type:"auth"})),void e.logMetricEndWithError({props:t,diagnosticsData:"Auth Request failed due to reconsent required [status: 412]"},(0,a.DA)());$(void 0),e.logMetricEndWithError({props:t,diagnosticsData:`Error while handling auth response ${(null==n?void 0:n.message)||JSON.stringify(n)}`},(0,a.DA)())}))}),[C,z,I,_,w,Y]);h.useEffect((()=>{"auth"===(null==z?void 0:z.type)&&Y===N&&J()}),[z,Y,J]);const X=D?{useButtonStyles_unstable:e=>{var t;const n=e;n.root.className=(0,c.z)(n.root.className,null===(t=D())||void 0===t?void 0:t.authButton)},useImageStyles_unstable:e=>{var t;const n=e;n.root.className=(0,c.z)(n.root.className,null===(t=D())||void 0===t?void 0:t.appIcon)},useTextStyles_unstable:e=>{var t;const n=e;n.root.className=(0,c.z)(n.root.className,null===(t=D())||void 0===t?void 0:t.title)}}:{};return z?h.createElement(u.q,{theme:q,customStyleHooks_unstable:X},h.createElement("div",null,h.createElement(d.$,{className:W.authButton,onClick:J,disabled:!z||U},U?h.createElement(p.y,{size:"tiny"}):h.createElement(k,{appIcon:Q.appIcon}),h.createElement(B,{appName:Q.appName,requestType:z.type})))):null}},6775:(e,t,n)=>{n.d(t,{B:()=>a});var o=n(6837),r=n(21491),i=n(70558);class a{constructor(e,t){this.activityProvider=e,this.telemetryService=t}async executeActivity(e){var t,n,i;try{switch(e.type){case"auth":case"config":return this.activityProvider.authConfigActivity.execute(e);case"silentAuth":return this.activityProvider.silentAuthActivity.execute(e);case"botInvoke":return this.activityProvider.botInvokeActivity.execute(e);case"TypeAPowerPlatformAuth":case"APIPluginAuth":return this.activityProvider.apiPluginAuthActivity.execute(e);case"CEAOAuth":return this.activityProvider.ceaOAuthActivity.execute(e);case"CEASSO":return this.activityProvider.ceaSSOActivity.execute(e);default:return null===(t=this.telemetryService)||void 0===t||t.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:r.kA.ExecuteActivity,tag:r.d7.AuthRuntime,success:o.YE.Failure,diagnosticsData:"Invalid auth request type"}),Promise.reject({code:"UnsupportedRequestType",errorMessage:"Invalid request type"})}}catch(e){return null===(n=this.telemetryService)||void 0===n||n.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:r.kA.ExecuteActivity,tag:r.d7.AuthRuntime,success:o.YE.Failure,diagnosticsData:`Error while executing auth activity ${(null==e?void 0:e.message)||e}`}),Promise.reject({code:"ActivityExecutionError",errorMessage:null!==(i=null==e?void 0:e.message)&&void 0!==i?i:"Error executing activity"})}}async execute(e){var t,n,a;try{let a,s=e,l=3;for(;s&&"result"!==s.type&&l-- >0;){if(a=await this.executeActivity(s),"object"!=typeof a)return;if(!a)return null===(t=this.telemetryService)||void 0===t||t.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:r.kA.Execute,tag:r.d7.AuthRuntime,success:o.YE.Failure,diagnosticsData:"Activity response is undefined"}),Promise.reject({code:"ActivityExecutionError",errorMessage:"Activity response is undefined"});if(e.onActivityCompletion){if(await e.onActivityCompletion(a))return a}s=(0,i.XW)(s,a)}return a||(null===(n=this.telemetryService)||void 0===n||n.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:r.kA.Execute,tag:r.d7.AuthRuntime,success:o.YE.Failure,diagnosticsData:"Activity response is undefined"}),Promise.reject("Activity response is undefined"))}catch(e){return null===(a=this.telemetryService)||void 0===a||a.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:r.kA.Execute,tag:r.d7.AuthRuntime,success:o.YE.Failure,diagnosticsData:`Error while getting auth activity response ${e}`}),Promise.reject(e)}}}},79417:(e,t,n)=>{function o(e,t,n,o){switch(n){case"auth":return{type:"auth",url:i(o),originalInvokeRequest:t};case"config":return{type:"config",url:i(o),originalInvokeRequest:t};case"silentAuth":return{type:"silentAuth",resource:a(o),originalInvokeRequest:t,isSilent:e.isSilent};default:return}}function r(e){return function(e){var t,n,o,r,i;return 200===e.value.statusCode||void 0!==(null===(t=e.value)||void 0===t?void 0:t.task)||"result"===(null===(o=null===(n=e.value)||void 0===n?void 0:n.composeExtension)||void 0===o?void 0:o.type)||"message"===(null===(i=null===(r=e.value)||void 0===r?void 0:r.composeExtension)||void 0===i?void 0:i.type)}(e)?"result":function(e){var t,n;return"config"===e.value.type||"config"===(null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.type)}(e)?"config":function(e){var t,n;return 401===e.value.statusCode||"auth"===(null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.type)}(e)?"auth":function(e){var t,n;return 401===e.value.statusCode||"silentAuth"===(null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.type)}(e)?"silentAuth":void 0}function i(e){var t,n,o,r,i,a,s,l,c;return null!==(a=null===(i=null===(r=null===(o=null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.suggestedActions)||void 0===o?void 0:o.actions)||void 0===r?void 0:r[0])||void 0===i?void 0:i.value)&&void 0!==a?a:null===(c=null===(l=null===(s=e.value)||void 0===s?void 0:s.value)||void 0===l?void 0:l.buttons[0])||void 0===c?void 0:c.value}function a(e){var t,n,o,r,i,a,s,l;return null!==(a=null===(i=null===(r=null===(o=null===(n=null===(t=e.value)||void 0===t?void 0:t.composeExtension)||void 0===n?void 0:n.suggestedActions)||void 0===o?void 0:o.actions)||void 0===r?void 0:r[0])||void 0===i?void 0:i.value)&&void 0!==a?a:null===(l=null===(s=e.value)||void 0===s?void 0:s.value)||void 0===l?void 0:l.tokenExchangeResource.uri}n.d(t,{W:()=>o,u:()=>r})},76321:(e,t,n)=>{n.d(t,{Y:()=>i});var o=n(6837),r=n(21491);async function i(e,t,n){var i,a,s,l,c,u,d,p,h;try{const n={id:e},o=await t.getApp(n),r=null!==(l=null===(s=null===(a=null===(i=o.titleInfo)||void 0===i?void 0:i.titleDefinition)||void 0===a?void 0:a.iconLarge)||void 0===s?void 0:s.uri)&&void 0!==l?l:null===(d=null===(u=null===(c=o.titleInfo)||void 0===c?void 0:c.titleDefinition)||void 0===u?void 0:u.iconSmall)||void 0===d?void 0:d.uri;return{appName:null===(h=null===(p=o.titleInfo)||void 0===p?void 0:p.titleDefinition)||void 0===h?void 0:h.name,appIcon:r}}catch(e){return null==n||n.LogError({eventId:o.Bw.AuthSDK,type:o.FY.LogError,name:r.kA.GetAppData,tag:r.d7.GetAppData,success:o.YE.Failure,diagnosticsData:`Error while getting app data ${(null==e?void 0:e.message)||e}`}),{appName:void 0,appIcon:void 0}}}},70558:(e,t,n)=>{n.d(t,{UX:()=>r,XW:()=>i});var o=n(79417);function r(e,t){const n=i(e,t);if(n)return Object.assign(Object.assign({},n),{onActivityCompletion:e.onActivityCompletion})}function i(e,t){if("object"==typeof t){const n=function(e){if("botInvoke"===e.type)return e;if("auth"===e.type||"config"===e.type)return e.originalInvokeRequest;if("silentAuth"===e.type)return e.originalInvokeRequest;throw new Error("Unsupported activity request type")}(e),r=(0,o.u)(t);if(!r)throw new Error("Invalid bot invoke response type");const i=(0,o.W)(e,n,r,t);if(i)return Object.assign({},i)}}},39993:(e,t,n)=>{var o,r,i,a,s,l,c,u,d,p,h;n.d(t,{FG:()=>o,FY:()=>r,Lj:()=>d,QE:()=>h,YE:()=>c,_$:()=>p,m2:()=>i,ru:()=>s,vP:()=>u,xe:()=>l,yx:()=>a}),function(e){e[e.None=0]="None",e[e.TokenFetchFailed=1]="TokenFetchFailed",e[e.ErrorResponse=2]="ErrorResponse",e[e.PluginStateUpdateFailed=3]="PluginStateUpdateFailed",e[e.PluginFetchFailed=4]="PluginFetchFailed",e[e.GetHeaderFailed=5]="GetHeaderFailed",e[e.AuthFlowFailedOnPluginToggle=6]="AuthFlowFailedOnPluginToggle",e[e.AuthExecutionFailedOnPluginToggle=7]="AuthExecutionFailedOnPluginToggle",e[e.MorePluginsClickFailed=8]="MorePluginsClickFailed",e[e.MorePluginsClickHostHandled=9]="MorePluginsClickHostHandled",e[e.ManagePluginsClickFailed=10]="ManagePluginsClickFailed",e[e.ManagePluginsClickHostHandled=11]="ManagePluginsClickHostHandled",e[e.GetCopilotPluginsIdsFailed=12]="GetCopilotPluginsIdsFailed",e[e.StoreFrontPluginsFetchFailed=13]="StoreFrontPluginsFetchFailed",e[e.StoreFrontCopilotPluginPermissionsClickHostHandled=14]="StoreFrontCopilotPluginPermissionsClickHostHandled",e[e.StoreFrontCopilotPluginPermissionsClickFailed=15]="StoreFrontCopilotPluginPermissionsClickFailed",e[e.StoreFrontCopilotPluginItemInstallSucceeded=16]="StoreFrontCopilotPluginItemInstallSucceeded",e[e.StoreFrontCopilotPluginItemInstallFailed=17]="StoreFrontCopilotPluginItemInstallFailed",e[e.PowerPlatformConnectorFlyoutDismissed=18]="PowerPlatformConnectorFlyoutDismissed",e[e.PowerPlatformConnectorFlyoutOpen=19]="PowerPlatformConnectorFlyoutOpen",e[e.SetPluginsHandled=20]="SetPluginsHandled",e[e.SetPluginsFailed=21]="SetPluginsFailed"}(o||(o={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(r||(r={})),function(e){e[e.PluginDataProvider=0]="PluginDataProvider",e[e.MsgExtViewModel=1]="MsgExtViewModel",e[e.CopilotPluginFlyoutTeachingPopover=2]="CopilotPluginFlyoutTeachingPopover",e[e.CopilotPluginFlyoutTeachingUI=3]="CopilotPluginFlyoutTeachingUI",e[e.CopilotPluginStoreFrontUI=4]="CopilotPluginStoreFrontUI"}(i||(i={})),function(e){e[e.LaunchPluginFlyout=0]="LaunchPluginFlyout",e[e.TogglePlugin=1]="TogglePlugin",e[e.GetPluginsState=2]="GetPluginsState",e[e.PluginRender=3]="PluginRender",e[e.InstalledPlugins=4]="InstalledPlugins",e[e.SelectedPlugins=5]="SelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePlugins=7]="MorePlugins",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePlugins=10]="ManagePlugins",e[e.StoreFrontCopilotPluginPermissions=11]="StoreFrontCopilotPluginPermissions",e[e.StoreFrontCopilotPluginIds=12]="StoreFrontCopilotPluginIds",e[e.StoreFrontCopilotPlugins=13]="StoreFrontCopilotPlugins",e[e.GetStoreFrontPluginsState=14]="GetStoreFrontPluginsState",e[e.InstallStoreFrontCopilotPlugin=15]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginItem=16]="StoreFrontCopilotPluginItem",e[e.PowerPlatformConnector=17]="PowerPlatformConnector",e[e.SetPlugins=18]="SetPlugins",e[e.UserSettings=19]="UserSettings",e[e.GetExtensions=20]="GetExtensions"}(a||(a={})),function(e){e[e.getHeader=0]="getHeader",e[e.getPlugins=2]="getPlugins",e[e.getAppDefinition=3]="getAppDefinition",e[e.getBotInvokeRequest=4]="getBotInvokeRequest",e[e.handleAuthLinkClick=5]="handleAuthLinkClick",e[e.onToggle=6]="onToggle",e[e.nextButtonClick=7]="nextButtonClick",e[e.gotItButtonClick=8]="gotItButtonClick",e[e.getStoreFrontPlugins=9]="getStoreFrontPlugins"}(s||(s={})),function(e){e[e.CopilotPluginFlyout=0]="CopilotPluginFlyout",e[e.OnToggle=1]="OnToggle",e[e.GetPlugins=2]="GetPlugins",e[e.PluginFlyoutItemRender=3]="PluginFlyoutItemRender",e[e.getInstalledPlugins=4]="getInstalledPlugins",e[e.getSelectedPlugins=5]="getSelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePluginsClick=7]="MorePluginsClick",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePluginsClick=10]="ManagePluginsClick",e[e.GetStoreFrontCopilotPluginIds=11]="GetStoreFrontCopilotPluginIds",e[e.GetStoreFrontCopilotPlugins=12]="GetStoreFrontCopilotPlugins",e[e.GetStoreFrontPlugins=13]="GetStoreFrontPlugins",e[e.InstallStoreFrontCopilotPlugin=14]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginPermissionClick=15]="StoreFrontCopilotPluginPermissionClick",e[e.StoreFrontCopilotPluginItemClick=16]="StoreFrontCopilotPluginItemClick",e[e.PowerPlatformConnectorClick=17]="PowerPlatformConnectorClick",e[e.SetPlugins=18]="SetPlugins",e[e.GetSelectedPluginsFromUserSettings=19]="GetSelectedPluginsFromUserSettings",e[e.WriteSelectedPluginsToUserSettings=20]="WriteSelectedPluginsToUserSettings",e[e.GetExtensionsFromUserConfig=21]="GetExtensionsFromUserConfig"}(l||(l={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(c||(c={})),function(e){e.IsCached="IsCached",e.FetchByNetwork="FetchByNetwork",e.TotalPluginCount="TotalPluginCount",e.TypeOfOperation="TypeOfOperation",e.TypeOfAuthFlow="TypeOfAuthFlow",e.isAuthFlowAutomatic="isAuthFlowAutomatic",e.PluginType="PluginType",e.SelectedPluginCount="SelectedPluginsCount",e.UnselectedPluginCount="UnselectedPluginsCount",e.UnsupportedPluginCount="UnsupportedPluginsCount",e.IsPluginIconAvailable="IsPluginIconAvailable",e.IsPluginGroupsAvailable="IsPluginGroupsAvailable",e.SelectedISVPluginCount="SelectedISVPluginCount",e.TotalISVPluginCount="TotalISVPluginCount",e.TotalMEPluginCount="TotalMEPluginCount",e.SelectedMEPluginCount="SelectedMEPluginCount",e.TotalPPConnectorsCount="TotalPPConnectorsCount",e.SelectedPPConnectorsCount="SelectedPPConnectorsCount",e.ConnectedPPConnectorsCount="ConnectedPPConnectorsCount",e.IsStoreFrontCopilotPluginIdsAvailable="IsStoreFrontCopilotPluginIdsAvailable",e.IsStoreFrontPluginInstallSuccess="IsStoreFrontCopilotPluginInstallationSuccess",e.IsStoreFrontCopilotPluginsAvailable="IsStoreFrontCopilotPluginsAvailable",e.TotalStoreFrontPluginsCount="TotalStoreFrontPluginsCount",e.NewlyInstalledPlugins="NewlyInstalledPlugins",e.MetaOSAppId="MetaOSAppId",e.PluginId="PluginId",e.PowerPlatformConnectionExists="PowerPlatformConnectionExists"}(u||(u={})),function(e){e[e.EnablePlugin=0]="EnablePlugin",e[e.DisablePlugin=1]="DisablePlugin"}(d||(d={})),function(e){e[e.Auth=0]="Auth",e[e.Config=1]="Config",e[e.SilentAuth=2]="SilentAuth",e[e.BotInvokeForAuthCheck=3]="BotInvokeForAuthCheck",e[e.Unknown=4]="Unknown"}(p||(p={})),function(e){e[e.MsgExt=0]="MsgExt",e[e.FirstParty=1]="FirstParty",e[e.Unsupported=2]="Unsupported",e[e.PowerPlatform=3]="PowerPlatform",e[e.DataVerse=4]="DataVerse",e[e.Undefined=5]="Undefined"}(h||(h={}))},9567:(e,t,n)=>{function o(e){var t;return(null!==(t=e.titleId)&&void 0!==t?t:"").startsWith("P_")}n.d(t,{W:()=>o})},13045:(e,t,n)=>{n.d(t,{k:()=>h});var o,r,i,a,s,l,c,u,d,p=n(39993);!function(e){e[e.None=0]="None",e[e.TokenFetchFailed=1]="TokenFetchFailed",e[e.ErrorResponse=2]="ErrorResponse",e[e.PluginStateUpdateFailed=3]="PluginStateUpdateFailed",e[e.PluginFetchFailed=4]="PluginFetchFailed",e[e.GetHeaderFailed=5]="GetHeaderFailed",e[e.AuthFlowFailedOnPluginToggle=6]="AuthFlowFailedOnPluginToggle",e[e.AuthExecutionFailedOnPluginToggle=7]="AuthExecutionFailedOnPluginToggle",e[e.MorePluginsClickFailed=8]="MorePluginsClickFailed",e[e.MorePluginsClickHostHandled=9]="MorePluginsClickHostHandled",e[e.ManagePluginsClickFailed=10]="ManagePluginsClickFailed",e[e.ManagePluginsClickHostHandled=11]="ManagePluginsClickHostHandled",e[e.GetCopilotPluginsIdsFailed=12]="GetCopilotPluginsIdsFailed",e[e.StoreFrontPluginsFetchFailed=13]="StoreFrontPluginsFetchFailed",e[e.StoreFrontCopilotPluginPermissionsClickHostHandled=14]="StoreFrontCopilotPluginPermissionsClickHostHandled",e[e.StoreFrontCopilotPluginPermissionsClickFailed=15]="StoreFrontCopilotPluginPermissionsClickFailed",e[e.StoreFrontCopilotPluginItemInstallSucceeded=16]="StoreFrontCopilotPluginItemInstallSucceeded",e[e.StoreFrontCopilotPluginItemInstallFailed=17]="StoreFrontCopilotPluginItemInstallFailed",e[e.PowerPlatformConnectorFlyoutDismissed=18]="PowerPlatformConnectorFlyoutDismissed",e[e.PowerPlatformConnectorFlyoutOpen=19]="PowerPlatformConnectorFlyoutOpen",e[e.SetPluginsHandled=20]="SetPluginsHandled",e[e.SetPluginsFailed=21]="SetPluginsFailed"}(o||(o={})),function(e){e[e.PluginDataProvider=0]="PluginDataProvider",e[e.MsgExtViewModel=1]="MsgExtViewModel",e[e.CopilotPluginFlyoutTeachingPopover=2]="CopilotPluginFlyoutTeachingPopover",e[e.CopilotPluginFlyoutTeachingUI=3]="CopilotPluginFlyoutTeachingUI",e[e.CopilotPluginStoreFrontUI=4]="CopilotPluginStoreFrontUI"}(r||(r={})),function(e){e[e.LaunchPluginFlyout=0]="LaunchPluginFlyout",e[e.TogglePlugin=1]="TogglePlugin",e[e.GetPluginsState=2]="GetPluginsState",e[e.PluginRender=3]="PluginRender",e[e.InstalledPlugins=4]="InstalledPlugins",e[e.SelectedPlugins=5]="SelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePlugins=7]="MorePlugins",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePlugins=10]="ManagePlugins",e[e.StoreFrontCopilotPluginPermissions=11]="StoreFrontCopilotPluginPermissions",e[e.StoreFrontCopilotPluginIds=12]="StoreFrontCopilotPluginIds",e[e.StoreFrontCopilotPlugins=13]="StoreFrontCopilotPlugins",e[e.GetStoreFrontPluginsState=14]="GetStoreFrontPluginsState",e[e.InstallStoreFrontCopilotPlugin=15]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginItem=16]="StoreFrontCopilotPluginItem",e[e.PowerPlatformConnector=17]="PowerPlatformConnector",e[e.SetPlugins=18]="SetPlugins",e[e.ExtensionSettings=19]="ExtensionSettings"}(i||(i={})),function(e){e[e.GetHeader=0]="GetHeader",e[e.GetPlugins=2]="GetPlugins",e[e.GetAppDefinition=3]="GetAppDefinition",e[e.GetBotInvokeRequest=4]="GetBotInvokeRequest",e[e.HandleAuthLinkClick=5]="HandleAuthLinkClick",e[e.OnToggle=6]="OnToggle",e[e.NextButtonClick=7]="NextButtonClick",e[e.GotItButtonClick=8]="GotItButtonClick",e[e.GetStoreFrontPlugins=9]="GetStoreFrontPlugins"}(a||(a={})),function(e){e[e.CopilotPluginFlyout=0]="CopilotPluginFlyout",e[e.OnToggle=1]="OnToggle",e[e.GetPlugins=2]="GetPlugins",e[e.PluginFlyoutItemRender=3]="PluginFlyoutItemRender",e[e.GetInstalledPlugins=4]="GetInstalledPlugins",e[e.GetSelectedPlugins=5]="GetSelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePluginsClick=7]="MorePluginsClick",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePluginsClick=10]="ManagePluginsClick",e[e.GetStoreFrontCopilotPluginIds=11]="GetStoreFrontCopilotPluginIds",e[e.GetStoreFrontCopilotPlugins=12]="GetStoreFrontCopilotPlugins",e[e.GetStoreFrontPlugins=13]="GetStoreFrontPlugins",e[e.InstallStoreFrontCopilotPlugin=14]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginPermissionClick=15]="StoreFrontCopilotPluginPermissionClick",e[e.StoreFrontCopilotPluginItemClick=16]="StoreFrontCopilotPluginItemClick",e[e.PowerPlatformConnectorClick=17]="PowerPlatformConnectorClick",e[e.SetPlugins=18]="SetPlugins",e[e.GetSelectedPluginsFromExtensionSettings=19]="GetSelectedPluginsFromExtensionSettings",e[e.WriteSelectedPluginsToExtensionSettings=20]="WriteSelectedPluginsToExtensionSettings"}(s||(s={})),function(e){e.IsCached="IsCached",e.FetchByNetwork="FetchByNetwork",e.TotalPluginCount="TotalPluginCount",e.TypeOfOperation="TypeOfOperation",e.TypeOfAuthFlow="TypeOfAuthFlow",e.IsAuthFlowAutomatic="isAuthFlowAutomatic",e.PluginType="PluginType",e.SelectedPluginCount="SelectedPluginsCount",e.UnselectedPluginCount="UnselectedPluginsCount",e.UnsupportedPluginCount="UnsupportedPluginsCount",e.IsPluginIconAvailable="IsPluginIconAvailable",e.IsPluginGroupsAvailable="IsPluginGroupsAvailable",e.SelectedISVPluginCount="SelectedISVPluginCount",e.TotalISVPluginCount="TotalISVPluginCount",e.TotalMEPluginCount="TotalMEPluginCount",e.SelectedMEPluginCount="SelectedMEPluginCount",e.IsStoreFrontCopilotPluginIdsAvailable="IsStoreFrontCopilotPluginIdsAvailable",e.IsStoreFrontPluginInstallSuccess="IsStoreFrontCopilotPluginInstallationSuccess",e.IsStoreFrontCopilotPluginsAvailable="IsStoreFrontCopilotPluginsAvailable",e.TotalStoreFrontPluginsCount="TotalStoreFrontPluginsCount",e.NewlyInstalledPlugins="NewlyInstalledPlugins"}(l||(l={})),function(e){e[e.EnablePlugin=0]="EnablePlugin",e[e.DisablePlugin=1]="DisablePlugin"}(c||(c={})),function(e){e[e.MsgExt=0]="MsgExt",e[e.FirstParty=1]="FirstParty",e[e.Unsupported=2]="Unsupported",e[e.PowerPlatform=3]="PowerPlatform",e[e.DataVerse=4]="DataVerse",e[e.Undefined=5]="Undefined"}(u||(u={})),function(e){e[e.Default=0]="Default",e[e.UserSettingsForGetSelectedPlugins=1]="UserSettingsForGetSelectedPlugins",e[e.TokenFetchForGetSelectedPlugins=2]="TokenFetchForGetSelectedPlugins",e[e.GetChatsForGetSelectedPlugins=3]="GetChatsForGetSelectedPlugins",e[e.TokenFetchForGetSelectedPluginsFromUserSettings=4]="TokenFetchForGetSelectedPluginsFromUserSettings",e[e.GetUserSettingsUrlForGetSelectedPluginsFromUserSettings=5]="GetUserSettingsUrlForGetSelectedPluginsFromUserSettings"}(d||(d={}));class h{constructor(e,t,n,o){this.tag=e,this.name=t,this.telemetryService=n,this.correlationVector=o,this.scenario=d.Default,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:p.FY.LogMetric,tag:this.tag,name:this.name,success:p.YE.Timeout,duration:6e4,diagnosticsData:`Ended with Timeout, Scenario: ${this.scenario}`,correlationVector:this.correlationVector}),this.isTimeout=!0}),6e4)}setScenario(e){this.scenario=e}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:p.FY.LogMetric,tag:this.tag,name:this.name,success:p.YE.Successful,duration:n,correlationVector:t||this.correlationVector}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:p.FY.LogMetric,tag:this.tag,name:this.name,success:p.YE.Failure,duration:n,correlationVector:t||this.correlationVector}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}},70898:(e,t,n)=>{n.d(t,{m:()=>i});var o=n(8520),r=(0,n(3679).D)("@1js/create-shared-react-context",{});function i(e,t){var n=r.get();return n[t]||(n[t]=o.createContext(e))}},15342:(e,t,n)=>{n.r(t),n.d(t,{filterOutNull:()=>r});var o=n(93564);function r(e){return e.filter(o.O)}},43278:(e,t,n)=>{function o(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(t(o))return o}}n.d(t,{I:()=>o})},5624:(e,t,n)=>{n.d(t,{AM:()=>h,D_:()=>g,Q$:()=>c,TN:()=>i,Vv:()=>f,cG:()=>d,d$:()=>p,fd:()=>a,mQ:()=>u,t0:()=>s});var o=n(66113),r=[];function i(e){return e||r}function a(e){return l(e,(function(e){return null!=e&&""!==e&&(!(e instanceof Array)||e.length>0)}))}function s(e){return l(e,(function(e){return null!==e}))}function l(e,t){if(null==e)return e;for(var n={},r=0,i=(0,o.H)(e);r<i.length;r++){var a=i[r];t(e[a])&&(n[a]=e[a])}return n}function c(e,t){return Object.assign({},e,t)}function u(e,t){return e.hasOwnProperty(t)}function d(e){var t=void 0;return function(n){if(t&&n===t.arg)return t.result;var o=e(n);return t={arg:n,result:o},o}}function p(e){return void 0===e?null:e}function h(e,t){var n=[];if(e>0&&e<Number.MAX_VALUE)for(var o=0;o<e;o+=1)n.push(t(o));return n}function g(e){return e}function f(e,t,n){return void 0===n&&(n=1e-5),Math.abs(e-t)<n}},6795:(e,t,n)=>{n.d(t,{A:()=>o});const o=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}},93882:(e,t,n)=>{n.r(t),n.d(t,{areEqualNumbers:()=>m.Vv,backfillUndefined:()=>r,cacheLatest:()=>m.cG,countStringOccurrences:()=>a,createArrayAndFillWith:()=>m.AM,deepMapKeysToCamelCase:()=>c,defaultToEmptyArray:()=>m.TN,endsWith:()=>V.d5,filterOutNull:()=>u.filterOutNull,find:()=>d.I,flattenJoin:()=>h,generateGuid:()=>y.A,getLocalISOTimeWithOffset:()=>s,getTimeUntil:()=>v,hasOwnProperty:()=>m.mQ,identity:()=>m.D_,isDefined:()=>C.O,isEmpty:()=>E,isEqualish:()=>P,isSafeInteger:()=>T.A,isString:()=>V.Kg,keys:()=>x.H,lowerFirst:()=>V.oZ,makeObject:()=>w._,matchAll:()=>k.H,memoizeFunction:()=>o.J,memoizeFunctionProperties:()=>D,memoizeSelector:()=>O,merge:()=>R,neverGuard:()=>g,neverGuardDefault:()=>f,omitEmpty:()=>m.fd,omitNull:()=>m.t0,poll:()=>M,range:()=>B,safeJoinStrings:()=>V.Cz,sortObjectBy:()=>N,startsWith:()=>V.w1,throwError:()=>H.throwError,undefinedToNull:()=>m.d$,uniq:()=>j,uniqBy:()=>U,updateWith:()=>m.Q$,upperFirst:()=>V.Zb});var o=n(58274);function r(e,t){return void 0===e?t:e}var i=n(79490);function a(e){return e.reduce((function(e,t){var n;return(0,i.__assign)((0,i.__assign)({},e),((n={})[t]=(e[t]||0)+1,n))}),{})}function s(e){var t=e.getTimezoneOffset(),n=6e4*t,o=new Date(e.valueOf()-n).toISOString().slice(0,-1),r=function(e){var t=parseInt(Math.abs(e).toString(),0).toString();return t.length>1?t:"0".concat(t)},i="".concat(t>0?"-":"+").concat(r(t/60),":").concat(r(t%60));return"".concat(o).concat(0===t?"Z":i)}var l=n(1026),c=function(e){return Array.isArray(e)?e.map((function(e){return c(e)})):null!=e&&e.constructor===Object?Object.keys(e).reduce((function(t,n){var o;return(0,i.__assign)((0,i.__assign)({},t),((o={})[(0,l.A)(n)]=c(e[n]),o))}),{}):e},u=n(15342),d=n(43278),p=n(61101);function h(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,p.A)((0,u.filterOutNull)(e)).join(",")}function g(e){return e}function f(e,t){return t}var m=n(5624),y=n(6795);function v(e){var t=(e||new Date).getTime()-(new Date).getTime();return t<=0?{days:0,hours:0,minutes:0}:{days:Math.floor(t/864e5),hours:Math.floor(t%864e5/36e5),minutes:Math.floor(t%36e5/6e4)}}var C=n(93564),b=n(7806);function E(e){return(0,b.A)(e)}var A=n(81227);function S(e){switch(typeof e){case"number":case"string":case"boolean":case"bigint":case"symbol":case"undefined":return!0;default:return!1}}function I(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=""),null===e?null:Object.entries(e).reduce((function(e,o){var r=o[0],i=o[1],a=n?"".concat(n,".").concat(r):r;return Array.isArray(i)?t?i.forEach((function(n,o){var r="".concat(a,".").concat(o);S(n)||null===n?e[r]=n:Object.assign(e,I(n,t,r))})):e[a]=i.map((function(e){return S(e)?e:I(e,t)})):S(i)||null==i?e[a]=i:Object.assign(e,I(i,t,a)),e}),{})}function P(e,t){var n=function(e){var t=I(e,!0);return null===t?null:(0,m.fd)(t)},o=n(e),r=n(t);return(0,A.A)(o,r)}var T=n(87250),x=n(66113),w=n(95812),k=n(33009),_=Object.keys;function D(e){var t,n,r={};try{for(var a=(0,i.__values)(_(e)),s=a.next();!s.done;s=a.next()){var l=s.value,c=e[l];if("function"==typeof c){var u=c;r[l]=(0,o.J)(u.bind(r))}else r[l]=c}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}var F=Object.keys,L=function(e,t){if(!e||!t||e===t)return e===t;var n=F(e);return n.length===F(t).length&&n.every((function(n){return t.hasOwnProperty(n)&&e[n]===t[n]}))},O=function(e,t){var n,o,r=(n=t,o=[],function(e){var t=void 0;if(o.forEach((function(n){var o=(0,i.__read)(n,2),r=o[0],a=o[1];return L(r,e)&&(t=a)})),t)return t;var r=n(e);return o.unshift([e,r]),o=o.slice(0,25),r}),a=void 0;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=r(e.apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(t),!1)));if(void 0!==a&&a!==o)if(Array.isArray(o)&&Array.isArray(a)){var s=a;if(o.length===s.length&&o.every((function(e,t){return e===s[t]})))return a}else if("object"==typeof o&&"object"==typeof a&&L(a,o))return a;return a=o,o}};function R(e,t,n){if(0===t.length)return e;if(0===e.length)return t;for(var o=0,r=0,i=[];o<e.length&&r<t.length;)if(1===n(e[o],t[r]))i.push(t[r++]);else i.push(e[o++]);return o===e.length&&i.push.apply(i,t.slice(r)),r===t.length&&i.push.apply(i,e.slice(o)),i}function M(e){return new Promise((function(t,n){!function e(o,r){void 0===r&&(r=0);var a=o.condition,s=o.maxAttempts,l=o.baseIntervalInMs,c=o.additionalIntervalPerAttemptInMs;if(a())return t();if(!(++r<s))return n("".concat(s," attempts exhausted"));var u=(0,i.__assign)((0,i.__assign)({},o),{baseIntervalInMs:l+(c||0)});setTimeout((function(){return e(u,r)}),l)}(e)}))}function B(e,t,n){return(0,i.__spreadArray)([],Array(e),!0).map((function(e,o){return(t||0)+o*(n||1)}))}function N(e,t){var n=(0,x.H)(e).sort((function(e,n){return t(e.toString()).localeCompare(t(n.toString()))})),o={};return n.forEach((function(t){o[t]=e[t]})),o}var V=n(98355),H=n(53987);function U(e,t){var n=e.map(t);return e.filter((function(e,o){return n.indexOf(t(e))===o}))}function j(e){return U(e,(function(e){return e}))}},93564:(e,t,n)=>{function o(e){return null!=e}n.d(t,{O:()=>o})},66113:(e,t,n)=>{function o(e){return"string"==typeof e?Object.keys(e.split("")):"number"==typeof e||"boolean"==typeof e?[]:Object.keys(e)}n.d(t,{H:()=>o})},95812:(e,t,n)=>{function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o={};return t.forEach((function(t){return o[t]=e(t)})),o}n.d(t,{_:()=>o})},33009:(e,t,n)=>{function o(e,t){var n=[];if(!t.global)throw new Error("regular expression must have the global flag set");var o=null;do{(o=t.exec(e))&&n.push(o)}while(o&&o[0]);return n}n.d(t,{H:()=>o})},98355:(e,t,n)=>{function o(e){return"string"==typeof e}function r(e){return e.length?e[0].toUpperCase()+e.slice(1):e}function i(e){return e.length?e[0].toLowerCase()+e.slice(1):e}function a(e,t){return e.slice(0,t.length)===t}function s(e,t){return e.slice(0-t.length)===t}function l(e,t){return e.join(t)}n.d(t,{Cz:()=>l,Kg:()=>o,Zb:()=>r,d5:()=>s,oZ:()=>i,w1:()=>a})},53987:(e,t,n)=>{function o(e){throw new Error(e)}n.r(t),n.d(t,{throwError:()=>o})},89685:(e,t,n)=>{function o(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}n.d(t,{DA:()=>r});function r(){for(var e=o(),t=0,n="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[r-t]%4+8).toString(16);break;default:n+=(e[r-t]%16).toString(16)}return n}},98466:(e,t,n)=>{n.r(t),n.d(t,{isSupportedLocale:()=>r,supportedLocales:()=>o,toSupportedLocale:()=>i});var o=["af","am","ar","as-in","az-latn-az","be-by","bg","bn-in","bn-bd","bs-latn-ba","ca","ca-es-valencia","cs","cy","da","de","el","en-gb","en-us","es","es-mx","et","eu","fa","fi","fil","fr","fr-ca","ga-ie","gd-gb","gl","gu","ha-latn-ng","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-kh","kn","ko","kok","ky","lb-lu","lo-la","lt","lv","mi-nz","mk","ml","mn-mn","mr","ms","mt-mt","ne-np","nl","nn-no","no","or","pa-in","pl","prs","pt","pt-pt","quz-pe","ro","ru","sd-arab-pk","si-lk","sk","sl","sq","sr","sr-cyrl","sr-cyrl-ba","sv","sw","ta","te","th","tk-tm","tr","tt","ug-cn","uk","ur","uz","vi","zh-hans","zh-hant","zu-za"];function r(e){return o.indexOf(e)>=0}function i(e,t){if(e){var n=e.toLowerCase().replace("_","-"),i=a(n);if(i)return i;if(r(n))return n;var s=n.split("-");if(s.length>2){var l=s.slice(0,s.length-1).join("-");if(r(l))return l;var c=a(l);if(c)return c}if(s.length>1){var u=s[0];if(r(u))return u}var d=n.substr(0,2);if(r(d))return d;var p=a(d);if(p)return p;for(var h=0,g=o;h<g.length;h++){var f=g[h];if(0===f.indexOf(d))return f}}if(t)return t;throw new Error("".concat(e," cannot be mapped to a supported locale"))}function a(e){if(0===e.indexOf("es-")&&"es-es"!==e)return"es-mx";if(0===e.indexOf("en-")&&"en-us"!==e)return"en-gb";if(0===e.indexOf("ja-"))return"ja";switch(e){case"zh-hk":case"zh-mo":case"zh-rhk":case"zh-rtw":case"zh-sg":case"zh-tw":return"zh-hant";case"zh-rcn":return"zh-hans";case"be":return"nl";case"ga":return"ga-ie";case"in":return"id";case"iw":return"he";case"nb":return"no";default:return}}},93141:(e,t,n)=>{n.d(t,{G:()=>i});var o=n(8520),r=n(36317);function i(e){var t=e.lookupString,n=e.children,i=(0,r.eO)(),a=o.useMemo((function(){return{lookupString:(e=t,n=i.lookupString,function(t){return function(o){var r=e(t)(o);if(r!==t)return r;var i=n(t)(o);return i!==t?i:t}})};var e,n}),[t,i]);return o.createElement(r.d7,{value:a},n)}},36317:(e,t,n)=>{n.d(t,{d7:()=>a,eO:()=>s});var o=n(70898),r=n(8520),i=(0,o.m)({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider"),a=i.Provider;function s(){return r.useContext(i)}},31153:(e,t,n)=>{n.d(t,{A:()=>r,c:()=>i});var o=n(18850);function r(e,t){return(0,o.l6)()?t():e.lookupString(t.key)()}function i(e,t,n){return(0,o.l6)()?t(n):e.lookupString(t.key)(n)}},65593:(e,t,n)=>{n.d(t,{Lh:()=>u,kQ:()=>l,mY:()=>c});var o=n(8520),r=n(36317),i=n(31153),a=function(){return a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},s=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};function l(e){var t=(0,r.eO)(),n=Object.keys(e),l=n.map((function(t){return e[t]}));return(0,o.useMemo)((function(){return n.reduce((function(n,o){var r;return a(a({},n),((r={})[o]=function(){return(0,i.A)(t,e[o])},r))}),{})}),s(s([t],n,!0),l,!0))}function c(e){var t=(0,r.eO)(),n=Object.keys(e),l=n.map((function(t){return e[t]}));return(0,o.useMemo)((function(){return n.reduce((function(n,o){var r;return a(a({},n),((r={})[o]=function(n){return(0,i.c)(t,e[o],n)},r))}),{})}),s(s([t],n,!0),l,!0))}function u(e){var t=(0,r.eO)();return(0,i.A)(t,e)}},46047:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapStringsWithPlaceholdersToStandardFormat=t.mapStringsToStandardFormat=t.declarePluralStringWithPlaceholders=t.declarePluralString=void 0;var o=n(63158),r=n(25061),i=n(43056),a=n(9810),s=n(9701),l=n(86519);function c(e){var t=e.comment,n=e.placeholders,i=e.strings,s={comment:t,placeholders:n,text:function(e){return(0,o.createICUString)((0,a.doPseudoLocalization)()?(0,r.pseudoLocalizePluralWithPlaceholders)(i,e):i(e))}};return s}t.declarePluralString=function(e,t){var n=t&&{text:(0,o.createICUString)(t.strings),comment:t.comment},a=function(t){return void 0===t&&(t=(0,i.getDefaultStringProvider)()),(0,r.resolveString)(e,n,t)};return a.toString=a,a.key=e,a},t.declarePluralStringWithPlaceholders=function(e,t){var n=t&&c(t),o=function(t,o){return void 0===o&&(o=(0,i.getDefaultStringProvider)()),(0,r.resolveStringWithPlaceholders)(e,n,o,{alreadyPseudoLocalized:!0})(t)};return o.toString=function(t){return void 0===t&&(t=(0,i.getDefaultStringProvider)()),(0,a.isDevLocalization)()&&n||!(0,l.stringExists)(e,t)&&n?(0,s.getStringDescriptionWithPlaceholders)(e,n).stringToBeLocalized:(0,l.lookUpString)(e,t)},o.key=e,o},t.mapStringsToStandardFormat=function(e){var t=e.comment,n=e.strings;return{text:(0,o.createICUString)(n),comment:t}},t.mapStringsWithPlaceholdersToStandardFormat=c},25061:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pseudoLocalizePluralWithPlaceholders=t.declareStringWithPlaceholders=t.declareString=t.lookupStringInStringProvider=t.resolveStringWithPlaceholders=t.resolveString=void 0;var o=n(93882),r=n(43056),i=n(9810),a=n(9701),s=n(83277),l=n(86519),c=/\\{\\d+\\}/g,u=(0,o.memoizeFunction)((function(e){return new RegExp("\\{".concat(e,"\\}"),"g")}));function d(e,t,n){try{return(0,i.isDevLocalization)()&&t?(0,i.doPseudoLocalization)()?function(e){var t={},n={};(e.match(/({.+?})/g)||[]).forEach((function(e,o){var r="".concat(g,"_").concat(o);t[e]=r,n[r]=e}));var o=Object.keys(t).reduce((function(e,n){return e.replace(n,t[n])}),y(e)),r=(0,s.pseudoLocalize)(o);return Object.keys(n).reduce((function(e,t){return e.replace(t,n[t])}),v(r))}(t.text):t.text:!(0,l.stringExists)(e,n)&&t?t.text:(0,l.lookUpString)(e,n)}catch(e){return(0,l.handleLocalizationError)(e,n),""}}t.resolveString=d;var p=function(e,t){return function(n){try{return e(n)}catch(e){return(0,l.handleLocalizationError)(e,t),""}}};function h(e,t,n,r){try{return(0,i.isDevLocalization)()&&t&&t.text&&!(null==r?void 0:r.alreadyPseudoLocalized)?p((function(e){return(0,i.doPseudoLocalization)()?function(e,t){var n={},r={};(0,o.keys)(t).forEach((function(e,o){var i="".concat(g,"_").concat(o);n[e]=i,r[i]=t[e]}));var i=(0,s.pseudoLocalize)(y(e.text(n)));return(0,o.keys)(r).reduce((function(e,t){return e.replace(new RegExp(C(t),"g"),r[t])}),v(i))}(t,e):t.text(e)}),n):!(0,l.stringExists)(e,n)&&t&&t.text?p(t.text,n):p((function(t){return(0,o.keys)(t).sort().reduce((function(e,n,o){var r=t[n],i=("string"==typeof r&&r||r&&r.toString&&r.toString()||"").replace(c,"");return(e||"").replace(u(o),i)}),(0,l.lookUpString)(e,n))}),n)}catch(e){return(0,l.handleLocalizationError)(e,n),function(){return""}}}t.resolveStringWithPlaceholders=h,t.lookupStringInStringProvider=function(e){return function(t){return function(n){return n?h(t,void 0,e)(n):d(t,void 0,e)}}},t.declareString=function(e,t){var n=function(n){return void 0===n&&(n=(0,r.getDefaultStringProvider)()),d(e,t,n)};return n.toString=n,n.key=e,n},t.declareStringWithPlaceholders=function(e,t){var n=function(n,o){return void 0===o&&(o=(0,r.getDefaultStringProvider)()),h(e,t,o)(n)};return n.toString=function(n){return void 0===n&&(n=(0,r.getDefaultStringProvider)()),(0,i.isDevLocalization)()&&t||!(0,l.stringExists)(e,n)&&t?(0,a.getStringDescriptionWithPlaceholders)(e,t).stringToBeLocalized:(0,l.lookUpString)(e,n)},n.key=e,n};var g="0.7059175321136157";var f="->INF::",m="".concat(g,"_-1");function y(e){return e.replace(new RegExp(f,"g"),m)}function v(e){return e.replace(new RegExp(m,"g"),f)}function C(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}t.pseudoLocalizePluralWithPlaceholders=function(e,t){var n={},r={};(0,o.keys)(t).forEach((function(e,o){var i="".concat(g,"_").concat(o);n[e]=i,r[i]=t[e]}));var i=e(n);return(0,o.keys)(i).forEach((function(e){var t=(0,s.pseudoLocalize)(y(i[e]));i[e]=(0,o.keys)(r).reduce((function(e,t){return e.replace(new RegExp(C(t),"g"),r[t])}),v(t))})),i}},43056:(e,t,n)=>{var o=n(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.lookupStringInDefaultStringProvider=t.clearStringMapLoadersForDefaultStringProvider=t.setCurrentLocaleForDefaultStringProvider=t.getCurrentLocaleForDefaultStringProvider=t.addStringMapLoaderForDefaultStringProvider=t.addStringMapForDefaultStringProvider=t.setLocalizationErrorHandlerForDefaultStringProvider=t.getDefaultStringProvider=void 0;var r=n(79490),i=n(9810),a=n(86519),s={currentLocale:void 0,strings:{},errorHandler:function(e){return o.error(e)},loaders:[],stringMapInitialized:!1,suppressEmptyStringMapErrors:(0,i.isTest)()};function l(){return s}t.getDefaultStringProvider=l,t.setLocalizationErrorHandlerForDefaultStringProvider=function(e){s=(0,a.setLocalizationErrorHandler)(e,s)},t.addStringMapForDefaultStringProvider=function(e,t){s=(0,a.addStringMap)(e,t,s)},t.addStringMapLoaderForDefaultStringProvider=function(e){s=(0,a.addStringMapLoader)(e,s)},t.getCurrentLocaleForDefaultStringProvider=function(){return(0,a.getCurrentLocale)(l())},t.setCurrentLocaleForDefaultStringProvider=function(e){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(t){switch(t.label){case 0:return[4,(0,a.setCurrentLocale)(e,s)];case 1:return[2,(s=t.sent()).currentLocale]}}))}))},t.clearStringMapLoadersForDefaultStringProvider=function(){return r.__awaiter(this,void 0,void 0,(function(){return r.__generator(this,(function(e){switch(e.label){case 0:return[4,(0,a.clearStringMapLoaders)(l())];case 1:return s=e.sent(),[2]}}))}))},t.lookupStringInDefaultStringProvider=function(e){return(0,a.lookUpString)(e,l())}},9810:(e,t,n)=>{var o=n(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.doPseudoLocalization=t.disableDevModeForLocalization=t.enableDevModeForLocalization=t.enablePseudoLocalization=t.disablePseudoLocalization=t.togglePseudoLocalization=t.isTest=t.isDevLocalization=t.skipLocalization=t.isDev=void 0;var r=!1,i=!1;function a(){return"undefined"!=typeof __DEV__&&__DEV__&&!i}function s(){return"undefined"!=typeof __SKIP_LOC__&&__SKIP_LOC__}t.isDev=a,t.skipLocalization=s,t.isDevLocalization=function(){return a()||s()},t.isTest=function(){return Boolean(void 0!==o&&o.env&&!1)},t.togglePseudoLocalization=function(){r=!r},t.disablePseudoLocalization=function(){r=!0},t.enablePseudoLocalization=function(){r=!1},t.enableDevModeForLocalization=function(){i=!1},t.disableDevModeForLocalization=function(){i=!0},t.doPseudoLocalization=function(){return!("undefined"==typeof __DEV__||!__DEV__||i)&&!("undefined"!=typeof __DISABLE_PSEUDO_LOC__&&__DISABLE_PSEUDO_LOC__||r)}},9701:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getStringDescriptionWithPlaceholders=t.getStringDescriptionWithoutPlaceholders=t.getStringDescriptionWithOnlyKey=void 0;var o=n(79490),r=n(93882),i=n(15342),a=n(53987);function s(e){return(e=(0,r.upperFirst)(e.trim()))&&!(0,r.endsWith)(e,".")&&(e+="."),e}t.getStringDescriptionWithOnlyKey=function(e){return{key:e,stringToBeLocalized:"",comment:"",placeholderNames:[]}},t.getStringDescriptionWithoutPlaceholders=function(e,t){return{key:e,stringToBeLocalized:t.text,comment:t.comment,placeholderNames:[]}},t.getStringDescriptionWithPlaceholders=function(e,t){for(var n=(0,r.keys)(t.placeholders).filter(r.isString).sort(),l={},c=0,u=(0,r.keys)(t.placeholders);c<u.length;c++){var d=u[c];l[d]=(0,r.isString)(d)?"{".concat(n.indexOf(d),"}"):(0,a.throwError)("Placeholder name ".concat(d," is not a string"))}var p=t.text(l),h=o.__spreadArray([t.comment],n.map((function(e,n){var o=t.placeholders[e].trim();return o?"{".concat(n,"} is a placeholder for ").concat((0,r.lowerFirst)(o)):null})),!0),g=(0,i.filterOutNull)(h).map(s).filter(Boolean).join(" ");return n.forEach((function(e,t){g=g.replace("{"+e+"}","{"+t+"}")})),{key:e,stringToBeLocalized:p,comment:g,placeholderNames:n}}},18850:(e,t,n)=>{t.U5=t._c=t.Au=t.mL=t.l6=t.Gd=t.ex=t.zB=t.qP=t.Ex=void 0;var o=n(46047);var r=n(25061);Object.defineProperty(t,"Ex",{enumerable:!0,get:function(){return r.declareString}}),Object.defineProperty(t,"qP",{enumerable:!0,get:function(){return r.declareStringWithPlaceholders}}),Object.defineProperty(t,"zB",{enumerable:!0,get:function(){return r.lookupStringInStringProvider}});var i=n(43056);Object.defineProperty(t,"ex",{enumerable:!0,get:function(){return i.getCurrentLocaleForDefaultStringProvider}}),Object.defineProperty(t,"Gd",{enumerable:!0,get:function(){return i.setCurrentLocaleForDefaultStringProvider}});var a=n(9810);Object.defineProperty(t,"l6",{enumerable:!0,get:function(){return a.isDevLocalization}});var s=n(9701);var l=n(36280);var c=n(86519);Object.defineProperty(t,"mL",{enumerable:!0,get:function(){return c.addStringMapLoader}}),Object.defineProperty(t,"Au",{enumerable:!0,get:function(){return c.setCurrentLocale}}),Object.defineProperty(t,"_c",{enumerable:!0,get:function(){return c.setLocalizationErrorHandler}});var u=n(70361);Object.defineProperty(t,"U5",{enumerable:!0,get:function(){return u.toSupportedLocale}})},36280:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetStringMapLoader=void 0;var o=n(70361);t.makeGetStringMapLoader=function(e){return function(t){var n=function(t){return e((0,o.toSupportedLocale)(t,"en-us"))};return t?e((0,o.toSupportedLocale)(t,"en-us")).catch((function(){})).then((function(){return n})):Promise.resolve(n)}}},83277:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pseudoLocalize=void 0;var n={a:"",A:"",b:"",B:"",c:"",C:"",d:"",D:"",e:"",E:"",f:"",F:"",g:"",G:"",h:"",H:"",i:"",I:"",j:"",J:"",k:"",K:"",l:"",L:"",m:"",M:"",n:"",N:"",o:"",O:"",p:"",P:"",q:"",Q:"",r:"",R:"",s:"",S:"",t:"",T:"",v:"",V:"",u:"",U:"",w:"",W:"",x:"",X:"",y:"",Y:"",z:"",Z:""};t.pseudoLocalize=function(e){return e.split("").reduce((function(e,t){var o=n[t]||t,r=o+(function(e){return"aeiou".indexOf(e.toLowerCase())>=0}(t)?o:"");return e+r}),"")}},86519:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lookUpString=t.stringExists=t.flattenStringMap=t.clearStringMapLoaders=t.setCurrentLocale=t.getCurrentLocale=t.addStringMapLoader=t.addStringMap=t.handleLocalizationError=t.setLocalizationErrorHandler=void 0;var o=n(79490),r=n(93882),i=n(9810);t.setLocalizationErrorHandler=function(e,t){return o.__assign(o.__assign({},t),{errorHandler:e})},t.handleLocalizationError=function(e,t){t.errorHandler(e)};var a,s=(0,r.memoizeFunction)((function(e,t){var n=c(t);return function(t){return Promise.resolve(e===t?n:{})}}));function l(e,t){return-1===t.loaders.indexOf(e)?o.__assign(o.__assign({},t),{loaders:t.loaders.concat(e)}):t}function c(e){var t={};return e&&function e(n,o){for(var i=0,a=(0,r.keys)(o);i<a.length;i++){var s=a[i];if("string"==typeof s){var l=o[s];"string"==typeof l?t[n+s]=l:"object"==typeof l&&e(n+s+".",l)}}}("",e),t}t.addStringMap=function(e,t,n){if(n.currentLocale===e||void 0===n.currentLocale){var r=c(t);return o.__assign(o.__assign({},n),{currentLocale:void 0===n.currentLocale?e:n.currentLocale,strings:o.__assign(o.__assign({},n.strings),r),stringMapInitialized:!0})}return l(s(e,t),n)},t.addStringMapLoader=l,t.getCurrentLocale=function(e){return a?a.then((function(e){return e.currentLocale})):Promise.resolve(e.currentLocale)},t.setCurrentLocale=function(e,t){var n=function(e,t){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i=this;return o.__generator(this,(function(a){switch(a.label){case 0:return n=function(n){return o.__awaiter(i,void 0,void 0,(function(){var r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,n(e)];case 1:return[2,o.sent()];case 2:return r=o.sent(),i=r.message||"unknown error",t.errorHandler("Async string map loader failed: ".concat(i)),[2,{}];case 3:return[2]}}))}))},r=t.loaders.map(n),[4,Promise.all(r)];case 1:return[2,a.sent().map(c).reduce((function(e,t){return o.__assign(o.__assign({},e),t)}),{})]}}))}))}(e,t).then((function(n){return o.__assign(o.__assign({},t),{strings:n,currentLocale:e,stringMapInitialized:!0})}));return a=a?a.then((function(){return n})):n},t.clearStringMapLoaders=function(e){return o.__awaiter(this,void 0,void 0,(function(){return o.__generator(this,(function(t){switch(t.label){case 0:return a?[4,a]:[3,2];case 1:t.sent(),t.label=2;case 2:return a=void 0,[2,o.__assign(o.__assign({},e),{loaders:[],strings:{},currentLocale:void 0})]}}))}))},t.flattenStringMap=c,t.stringExists=function(e,t){return"string"==typeof t.strings[e]},t.lookUpString=function(e,t){var n=t.strings[e];if(!n||"string"!=typeof n){var o=(0,i.isDev)()||(0,i.isTest)()?e:"";return!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(t.strings)?t.errorHandler("Key ".concat(e," does not exist in string map"),{stringsLoaded:!!t.stringMapInitialized}):!t.suppressEmptyStringMapErrors&&t.errorHandler("The current string map is empty. The string is probably resolved too early, at import time. Key: ".concat(e)),o}return n}},70361:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toSupportedLocale=t.supportedLocales=t.isSupportedLocale=void 0;var o=n(98466);Object.defineProperty(t,"isSupportedLocale",{enumerable:!0,get:function(){return o.isSupportedLocale}}),Object.defineProperty(t,"supportedLocales",{enumerable:!0,get:function(){return o.supportedLocales}}),Object.defineProperty(t,"toSupportedLocale",{enumerable:!0,get:function(){return o.toSupportedLocale}})},9768:(e,t,n)=>{n.d(t,{m:()=>S});var o=n(66636),r=n(23913),i=n(47063),a=n(8520),s=n(79490),l=n(16177),c=n(9923),u=n(11120),d=n(85489),p=n(71086),h=n(77373),g=n(82420),f=n(30185),m=n(25510),y=n(31414);class v{constructor(e,t,n,o){this.hostService=e,this.channelService=t,this.dialogActions=n,this.telemetryService=o}getAppDefinition(e){throw new Error("Method not implemented.")}handleOpenUrl(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){var t,n,o,r,i,a,s,c,p,h,g,y,v,C;const b=new f.k(this.telemetryService,u.yx.CardService,u.xe.OpenUrl),E={};try{let f,y={type:l.p.Unhandled,params:{url:new URL(e.url)}};switch(e.disableDeepLinkProcessing||(y=(0,l.G)(null==e?void 0:e.url)),y.type){case l.p.StageView:E[u.vP.ModalViewType]=u.lp.StageView,f={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:y.params.appId,stageInfo:y.params.stageInfo},e.conversationId&&(f.conversationId=e.conversationId),yield null===(n=this.hostService)||void 0===n?void 0:n.openStageView(f);break;case l.p.TaskModule:E[u.vP.ModalViewType]=u.lp.TaskModule,f={cardData:e.cardData,botId:null!==(o=e.botId)&&void 0!==o?o:"",appId:y.params.appId,taskInfo:y.params.taskInfo},e.conversationId&&(f.conversationId=e.conversationId),yield null===(r=this.hostService)||void 0===r?void 0:r.openTaskModule(f);break;default:f={cardData:e.cardData,url:e.url},e.conversationId&&(f.conversationId=e.conversationId),yield this.hostService.openUrl(f)}return b.logMetricEnd({props:E,diagnosticsData:`TypeOfCard: ${null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.contentType}, cardId : ${null===(a=null==e?void 0:e.cardData)||void 0===a?void 0:a.cardId}, cardsize: ${null===(c=null===(s=null==e?void 0:e.cardData)||void 0===s?void 0:s.content)||void 0===c?void 0:c.length}, Appid: ${(0,m.n)(null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.titleId,null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.appId)}`},null===(g=e.cardData)||void 0===g?void 0:g.cardId),{status:d.yl.Success,linkType:y.type}}catch(t){return b.logMetricEndWithError({props:E,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t},  Appid: ${(0,m.n)(null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.titleId,null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.appId)}`},null===(C=e.cardData)||void 0===C?void 0:C.cardId),{status:d.yl.Error}}}))}handleActionExecute(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){var t,n,o,r,i,a,s,l,c,d,g,v,C,b,E,A,S,I,P,T,x,w,k,_,D;const F=new f.k(this.telemetryService,u.yx.CardService,u.xe.ActionExecute),L={},O={cardData:e.cardData,botId:e.botId,appId:e.appId,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:e.actionId,verb:e.actionVerb,data:e.actionData},trigger:null!==(t=e.trigger)&&void 0!==t?t:"manual"}}};e.conversationId&&(O.requestBody=Object.assign(Object.assign({},O.requestBody),{conversation:{id:e.conversationId}})),e.authCode&&(O.requestBody.value.state=e.authCode),e.authToken&&(O.requestBody.value.authentication={token:e.authToken});const R=yield null===(n=this.channelService)||void 0===n?void 0:n.botInvoke(O);let M;if((null==R?void 0:R.type)===p.t.Error||!(null==R?void 0:R.value)){const e=R.value;return new h.H0(e.errorCode,e.errorMessage)}const B=R.value;switch(null==B?void 0:B.statusCode){case 200:M=new h.G3(JSON.stringify(B.value),B.type),L[u.vP.ActionExecuteResponseType]=u.Ve.Result,F.logMetricEnd({props:L,diagnosticsData:`TypeOfCard: ${null===(o=null==e?void 0:e.cardData)||void 0===o?void 0:o.contentType}, cardId : ${null===(r=null==e?void 0:e.cardData)||void 0===r?void 0:r.cardId}, cardsize: ${null===(a=null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.content)||void 0===a?void 0:a.length}, Appid: ${(0,m.n)(null===(s=null==e?void 0:e.cardData)||void 0===s?void 0:s.titleId,null===(l=null==e?void 0:e.cardData)||void 0===l?void 0:l.appId)}, actionabilityStatus: ${(0,y.BP)(null===(c=null==e?void 0:e.cardData)||void 0===c?void 0:c.cardId)}`},null===(d=e.cardData)||void 0===d?void 0:d.cardId);break;case 401:if(R.value){M=new h.BF(JSON.stringify(B.value),B.type),L[u.vP.ActionExecuteResponseType]=u.Ve.AuthError,F.logMetricEnd({props:L,diagnosticsData:`TypeOfCard: ${null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.contentType}, cardId : ${null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.cardId}, cardsize: ${null===(b=null===(C=null==e?void 0:e.cardData)||void 0===C?void 0:C.content)||void 0===b?void 0:b.length}, Appid: ${(0,m.n)(null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.titleId,null===(A=null==e?void 0:e.cardData)||void 0===A?void 0:A.appId)}, actionabilityStatus: ${(0,y.BP)(null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.cardId)}`},null===(I=e.cardData)||void 0===I?void 0:I.cardId);break}M=new h.H0(500,"response is empty"),L[u.vP.ActionExecuteResponseType]=u.Ve.Error,F.logMetricEndWithError({props:L,diagnosticsData:`Error: Action Execute failed. Bot response is empty or error, Appid: ${(0,m.n)(null===(P=null==e?void 0:e.cardData)||void 0===P?void 0:P.titleId,null===(T=null==e?void 0:e.cardData)||void 0===T?void 0:T.appId)}`},null===(x=e.cardData)||void 0===x?void 0:x.cardId);break;default:M=new h.H0(null!==(w=null==B?void 0:B.statusCode)&&void 0!==w?w:500,JSON.stringify(null==B?void 0:B.value)),L[u.vP.ActionExecuteResponseType]=u.Ve.Error,F.logMetricEndWithError({props:L,diagnosticsData:`Error: Action Execute failed. Bot response status code is not supported, Appid: ${(0,m.n)(null===(k=null==e?void 0:e.cardData)||void 0===k?void 0:k.titleId,null===(_=null==e?void 0:e.cardData)||void 0===_?void 0:_.appId)}`},null===(D=e.cardData)||void 0===D?void 0:D.cardId)}return M}))}handleActionSubmit(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){var t,n,o,r,i,a;const s=new f.k(this.telemetryService,u.yx.CardService,u.xe.ActionSubmit),l={};try{return(0,c.R1)(e)?(this.dialogActions.submit(e.data),{status:d.yl.Success}):(s.logMetricEndWithError({props:l,diagnosticsData:`Error: ActionSubmit failed as passed action submit type is not supported, Appid: ${(0,m.n)(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},null===(o=e.cardData)||void 0===o?void 0:o.cardId),new g.O(d.yl.Error,400,"Error: ActionSubmit failed as passed action submit type is not supported"))}catch(t){return s.logMetricEndWithError({props:l,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${(0,m.n)(null===(r=null==e?void 0:e.cardData)||void 0===r?void 0:r.titleId,null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.appId)}`},null===(a=e.cardData)||void 0===a?void 0:a.cardId),new g.O(d.yl.Error,400,"Error: ActionSubmit failed")}}))}}var C=n(89797);const b=e=>new C.a(e,{choiceSetInputValueSeparator:",",supportsInteractivity:!0,spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},imageSizes:{small:32,medium:52,large:100},containerStyles:{default:{foregroundColors:{default:{default:"#ffffffff",subtle:"#f0f0f0"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}},borderColor:"#CCCCCC",backgroundColor:"#1f1f1f"},emphasis:{foregroundColors:{default:{default:"#ffffffff",subtle:"#bfffffff"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}},borderColor:"#666666",backgroundColor:"#ff292828"},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#ff201f1f",subtle:"#ff2d2c2c"},dark:{default:"#ff201f1f",subtle:"#ff2d2c2c"},light:{default:"#ffffffff",subtle:"#bfffffff"},accent:{default:"#1890f1",subtle:"#ff8b8cc7"},good:{default:"#ff92c353",subtle:"#e592c353"},warning:{default:"#fff8d22a",subtle:"#e5f8d22a"},attention:{default:"#ffd74654",subtle:"#e5d74654"}}}},actions:{maxActions:6,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Right",allowButtonsToWrap:!0},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:16}},void 0,void 0,"dark"),E=e=>new C.a(e,{choiceSetInputValueSeparator:",",supportsInteractivity:!0,spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:32,medium:52,large:100},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{foregroundColors:{default:{default:"#1f1f1f",subtle:"#424242"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}},borderColor:"#CCCCCC",backgroundColor:"#fafafa"},emphasis:{foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}},borderColor:"#666666",backgroundColor:"#fff9f8f7"},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#1890f1",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}}},actions:{maxActions:6,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Right",allowButtonsToWrap:!0},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:16}},void 0,void 0,"light"),A=[o.r.Execute,o.r.Submit,o.r.OpenUrl];function S(e){var t;const n=a.useMemo((()=>new i.e),[]),{cardDetails:o,postActionExecute:s,channelService:l,dialogActions:c,telemetryService:u,supportedActions:d=A,theme:p,featureFlags:h,hostService:g}=e,f=a.useMemo((()=>"dark"===p?b(h):E(h)),[h,p]),m=JSON.parse(o.content),y=Object.assign(Object.assign({},o),{content:JSON.stringify(m.content),botId:null!==(t=m.botId)&&void 0!==t?t:o.botId}),C={cardService:new v(g,l,c,u),channelService:l,telemetryService:u,hostService:g},S=A.filter((e=>-1==d.indexOf(e)));return a.createElement(r.v,{cardData:y,hostConfig:f,uxRegistry:n,serviceProvider:C,onRuntimeActivityResponse:s,forbiddenActionTypes:S})}},57160:(e,t,n)=>{n.d(t,{y:()=>a});var o=n(79490),r=n(55141);class i extends r.U{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==o?void 0:o.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class a extends i{constructor(e,t,n,o,r){super(n,o),this.notifySuccess=e,this.notifyFailure=t,this.externalAuthService=r}}},26260:(e,t,n)=>{n.d(t,{j:()=>o});const o=(0,n(18850).Ex)("m365-ext-dialog-modal.m365chat.closeButton")},64056:(e,t,n)=>{n.d(t,{c:()=>u});var o=n(82017),r=n(42407),i=n(10145),a=n(8520),s=n(21278),l=n(658);const c=(0,s.Q)("DialogHeader",(0,l.n)({appNameLarge:{fontWeight:"bold",fontSize:"18px"},appName:{fontWeight:"bold",fontSize:"14px"},title:{fontSize:"12px"},dialogIcon:{minWidth:"24px",minHeight:"24px",maxHeight:"32px",maxWidth:"32px",marginRight:"16px",alignSelf:"center"},dialogIconContainer:{display:"flex",flexDirection:"row","&:focus-visible, & > *:focus-visible":{outline:"none",border:"none"}},dialogTitleContainer:{display:"flex",flexDirection:"column"}}));function u(e){const t=c(),{appDefinition:n,title:s}=e,l=a.useMemo((()=>({src:n.largeImageUrl,imageFit:o.N_.contain})),[n.largeImageUrl]);return a.createElement("div",{className:t.dialogIconContainer},l.src&&a.createElement(r.x,{className:t.dialogIcon,imageProps:l}),a.createElement("div",{className:t.dialogTitleContainer},a.createElement(i.E,{className:s?t.appName:t.appNameLarge},n.name),s&&a.createElement(i.E,{className:t.title},s)))}},10877:(e,t,n)=>{n.d(t,{S:()=>O});var o,r,i,a,s,l,c,u,d=n(89685),p=n(65593),h=n(57160),g=n(8520),f=n(58651);class m{getLoadingUi(){return g.createElement(g.Fragment,null)}getErrorUiData(e){return{localizedErrorStrings:{errorHeading:"Error",errorSubtitle:"An error occurred",bubbleHeading:"Error",bubbleSubtitle:"An error occurred",openInDesktopButtonTitle:"Open in Desktop",openInWebBrowserButtonTitle:"Open in Web Browser",openInLegacyBrowserButtonTitle:"Open in Legacy Browser",retryButtonTitle:"Retry"},errorImage:{image:"https://example.com/error.png",altText:"Error Image"},openDesktopApp:()=>{f.log("Open Desktop App")},openBrowser:()=>{f.log("Open Browser")},openLegacyUrl:()=>{f.log("Open Legacy URL")},retry:()=>{f.log("Retry")}}}}!function(e){e[e.None=0]="None",e[e.AppStoreLaunchHandled=1]="AppStoreLaunchHandled",e[e.AppStoreLaunchFailed=2]="AppStoreLaunchFailed",e[e.NavigateToApp=3]="NavigateToApp",e[e.DeepLinkParsingFailed=4]="DeepLinkParsingFailed",e[e.UnhandledDeepLink=5]="UnhandledDeepLink",e[e.UnHandledPostInstall=6]="UnHandledPostInstall",e[e.GptPostInstall=7]="GptPostInstall",e[e.PluginPostInstall=8]="PluginPostInstall"}(o||(o={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(r||(r={})),function(e){e[e.LinkService=0]="LinkService",e[e.AppStoreExtProvider=1]="AppStoreExtProvider",e[e.M365ExtAppStoreDialogTelemetryService=2]="M365ExtAppStoreDialogTelemetryService"}(i||(i={})),function(e){e[e.LaunchAppStore=0]="LaunchAppStore",e[e.DeepLinkHandler=1]="DeepLinkHandler",e[e.PostInstall=2]="PostInstall"}(a||(a={})),function(e){e[e.openAppStore=0]="openAppStore"}(s||(s={})),function(e){e[e.M365ExtDialog=0]="M365ExtDialog",e[e.M365ExtAppStore=1]="M365ExtAppStore",e[e.DeepLinkHandler=2]="DeepLinkHandler",e[e.PostInstall=3]="PostInstall"}(l||(l={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(c||(c={})),function(e){e.AppId="AppId",e.DeepLink="DeepLink"}(u||(u={}));class y{constructor(e,t,n){this.tag=e,this.name=t,this.telemetryService=n,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:r.LogMetric,tag:this.tag,name:this.name,success:c.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isTimeout=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogMetric,tag:this.tag,name:this.name,success:c.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:r.LogMetric,tag:this.tag,name:this.name,success:c.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}var v,C=n(74487);function b(e,t){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:v.Unhandled,params:{url:new URL(e)}};const n=new URL(e);return n.pathname&&"https://teams.microsoft.com"===n.origin?function(e,t){try{if(t===C.UH.office){const[t,n,o,r]=e.pathname.split("/");if(""!==t||"m365Apps"!==n)throw new Error("Invalid Teams url format for App");if(!o)throw new Error("Invalid appId");return A(e,o,r)}{const[t,n,o,r,i]=e.pathname.split("/");if(""!==t||"l"!==n||"entity"!==o&&"app"!==o)throw new Error("Invalid Teams url format for App");if(!r)throw new Error("Invalid appId");return A(e,r,i)}}catch(e){return}}(n,t)||function(e){var t,n,o,r,i,a,s;try{if(!e)return;const l=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==l?void 0:l.length)||!l[1])throw new Error("Invalid Teams url format for TaskModule");const c={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},u={url:null!==(o=e.searchParams.get("url"))&&void 0!==o?o:void 0,fallbackUrl:null!==(r=e.searchParams.get("fallbackUrl"))&&void 0!==r?r:void 0,card:null!==(i=JSON.stringify(e.searchParams.get("card")))&&void 0!==i?i:void 0,width:c.width,height:c.height,title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,completionBotId:null!==(s=e.searchParams.get("completionBotId"))&&void 0!==s?s:void 0};return{type:v.TaskModule,params:{appId:l[1],taskInfo:u}}}catch(e){return}}(n)||S(n)||I(n)||E(n):{type:v.Unhandled,params:{url:new URL(e)}}}!function(e){e.TaskModule="taskModule",e.StageView="stageView",e.NavigateToApp="app",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(v||(v={}));const E=e=>({type:v.Unhandled,params:{url:e}});function A(e,t,n){var o;const r=null!==(o=new URLSearchParams(e.search).get("webUrl"))&&void 0!==o?o:void 0;return{type:v.NavigateToApp,params:{appId:t,pageId:null!=n?n:"",webUrl:r}}}const S=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const o=t.searchParams.get("context");let r={};const i=decodeURIComponent(null!=o?o:"");return r=JSON.parse(i),{type:v.StageView,params:{appId:n[1],stageInfo:r}}}catch(e){return}},I=e=>{var t,n;try{const o=/^\/l\/entity\/([^/]+)\/([^/]+)$/,r=e,i=r.pathname.match(o);if(3!==(null==i?void 0:i.length))throw new Error("Invalid Teams url format for Tab");const a=i[1];let s;if(r.searchParams.has("context")){const e=r.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");s=JSON.parse(t)}const l={entityId:i[2],webUrl:null!==(t=r.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=r.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==s?void 0:s.subEntityId};return{type:v.LaunchPage,params:{appId:a,tabInfo:l}}}catch(e){return}};class P{constructor(e,t,n,o,r){this.hubName=e,this.actions=t,this.onNavigateToApp=n,this.telemetryService=o,this.correlationVector=r}openLink(e){var t,n;const r=new y(a.DeepLinkHandler,l.DeepLinkHandler,this.telemetryService),i=b(e,this.hubName);if(!i)return r.logMetricEndWithError({message:o.DeepLinkParsingFailed,diagnosticsData:`Failed to parse the deep link: ${e}`},this.correlationVector),Promise.reject();if((null==i?void 0:i.type)===v.NavigateToApp){const e=null!==(t=i.params.appId)&&void 0!==t?t:"";r.logMetricEnd({message:o.NavigateToApp,props:{AppId:e}},this.correlationVector),null===(n=this.onNavigateToApp)||void 0===n||n.call(this,e),this.actions.close()}else r.logMetricEnd({message:o.UnhandledDeepLink,props:{DeepLink:e}},this.correlationVector);return Promise.resolve()}}var T=n(55141);class x extends T.U{returnFocus(e){throw new Error("Method not implemented.")}setCurrentFrame(e){throw new Error("Method not implemented.")}navigateToApp(e){throw new Error("Method not implemented.")}shareDeepLink(e){throw new Error("Method not implemented.")}getConfig(){throw new Error("Method not implemented.")}}class w{constructor(e){this.dialogActions=e,this.urlService=new k(e)}}class k extends T.U{constructor(e){super(),this.dialogActions=e,this.open=e=>{throw new Error("Method not implemented.")},this.submit=(e,t)=>(this.dialogActions.submit(e),Promise.resolve()),this.messageForParent=e=>{throw new Error("Method not implemented.")},this.messageForChild=e=>{throw new Error("Method not implemented.")}}}var _=n(83453),D=n(18850);const F=(0,D.qP)("m365-ext-dialog.dialogWithTitle"),L=(0,D.Ex)("m365-ext-dialog.dialogWithoutTitle");function O(e){var t,n;const o=g.useMemo((()=>(0,d.DA)()),[]),r={authenticationService:new h.y((()=>Promise.resolve()),(()=>Promise.resolve()),e.tokenService,e.userContext,e.externalAuthService),hubUiService:new m,linkService:new P(e.hostContext.host.name,e.dialogActions,e.onNavigateToApp,e.dialogTelemetryService,o),pageService:new x,dialogService:null!==(t=e.dialogService)&&void 0!==t?t:new w(e.dialogActions),logger:{log:function(e,t,n,o){}}},i={user:e.userContext,app:e.hostContext,page:{id:(null===(n=e.appDefinition)||void 0===n?void 0:n.id)||"",frameContext:null!=e.dialogParameters?C.E2.task:C.E2.content,sourceOrigin:"https://teams.microsoft.com",subPageId:e.subEntityId},dialogParameters:e.dialogParameters},a=(0,p.mY)({dialogWithTitle:F}),s=(0,p.kQ)({dialogWithoutTitle:L}),l=void 0!==e.createAndSendSignalsToSubstrate&&null!==e.createAndSendSignalsToSubstrate?{createAndSendSignalsToSubstrate:e.createAndSendSignalsToSubstrate}:void 0;return g.createElement(_.SW,{hostWindow:window,hubServices:r,contentUrl:e.content.url,appDefinition:e.appDefinition,context:i,title:e.content.title?a.dialogWithTitle({title:e.content.title}):s.dialogWithoutTitle(),featureFlags:l})}},53075:(e,t,n)=>{n.d(t,{w:()=>i});var o=n(90763),r=n(71086);const i=(e,t,n,o)=>n?Object.assign({submit:a(n,e,t,o)},e):Object.assign({},e);function a(e,t,n,i){return a=>{var l;if(!a)return void t.close();const c={botId:(0,o.L)(n),appId:null!==(l=n.id)&&void 0!==l?l:"",requestBody:{name:"task/submit",value:{data:a}}};i&&(c.requestBody.conversation={id:i}),e.botInvoke(c).then((e=>function(e,t){switch(e.type){case r.t.Result:{const n=e.value;n.composeExtension?function(e,t){var n;switch(e.type){case"message":return s(null!==(n=e.text)&&void 0!==n?n:"",t);case"result":return void t.close({taskModuleClosedReason:"Done",resultType:"card",attachmentLayout:e.attachmentLayout,attachments:e.attachments});default:s("",t)}}(n.composeExtension,t):n.task?function(e,t){switch(e.type){case"message":return s(e.value,t);case"continue":{const n=e.value,o=null!=n.card?"card":"url",r=(n.height,n.height),i=(n.width,n.width);return t.update({type:o,card:"string"==typeof n.card?n.card:JSON.stringify(n.card),url:n.url,completionBotId:n.completionBotId,fallbackUrl:n.fallbackUrl,height:r,width:i})}default:s("",t)}}(n.task,t):s("",t);break}case r.t.Error:s("Something went wrong",t);break;default:s("",t)}}(e,t))).catch((e=>{t.close()}))}}function s(e,t){t.close({taskModuleClosedReason:"Done",resultType:"text",text:e})}},21491:(e,t,n)=>{var o,r,i,a,s,l,c,u;n.d(t,{FG:()=>i,Ih:()=>a,NZ:()=>o,d7:()=>r,hT:()=>c,kA:()=>s,kn:()=>l}),function(e){e[e.None=0]="None",e[e.PartialAuthSuccess=1]="PartialAuthSuccess"}(o||(o={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.AuthRuntime=2]="AuthRuntime",e[e.AuthConfigRuntimeActivity=3]="AuthConfigRuntimeActivity",e[e.BotInvokeRuntimeActivity=4]="BotInvokeRuntimeActivity",e[e.SilentAuthRuntimeActivity=5]="SilentAuthRuntimeActivity",e[e.GetAppData=6]="GetAppData",e[e.GetAppDataForAPIPlugins=7]="GetAppDataForAPIPlugins",e[e.TimedOutBasedPromise=8]="TimedOutBasedPromise"}(r||(r={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(i||(i={})),function(e){e[e.None=0]="None",e[e.AuthRenderingTime=1]="AuthRenderingTime"}(a||(a={})),function(e){e[e.None=0]="None",e[e.AuthButton=1]="AuthButton",e[e.ExecuteActivity=2]="ExecuteActivity",e[e.Execute=3]="Execute",e[e.ExecuteConfigOrAuthRequest=4]="ExecuteConfigOrAuthRequest",e[e.GetAppData=5]="GetAppData",e[e.GetAppDataForAPIPlugins=6]="GetAppDataForAPIPlugins"}(s||(s={})),function(e){e.AuthScenario="AuthScenario",e.AuthType="AuthType",e.InterstitialAuth="InterstitialAuth"}(l||(l={})),function(e){e[e.Auth=0]="Auth",e[e.Config=1]="Config",e[e.SilentAuth=2]="SilentAuth",e[e.BotInvoke=3]="BotInvoke",e[e.Unknown=4]="Unknown",e[e.APIPluginAuth=6]="APIPluginAuth"}(c||(c={})),function(e){e[e.PluginFlyout=1]="PluginFlyout",e[e.InChat=2]="InChat",e[e.CardAction=3]="CardAction",e[e.Unknown=4]="Unknown"}(u||(u={}))},6837:(e,t,n)=>{var o,r,i;n.d(t,{Bw:()=>i,FY:()=>o,YE:()=>r}),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(o||(o={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(r||(r={})),function(e){e.AuthSDK="AuthSDK",e.EntityRepresentation="EntityRepresentation",e.PluginManagement="PluginManagement",e.ClientSkill="ClientSkill.Execute",e.SystemMessage="SystemMessage"}(i||(i={}))},70734:(e,t,n)=>{n.d(t,{J:()=>s});var o=n(87868),r=n(8520),i=n(24926),a=5e3;function s(e){var t=e.message,n=e.messageType,s=e.dismissType,l=e.action,c=e.onDismiss,u=e.autoDismissTimer;return r.useEffect((function(){if(s!==i.U.Manual){var e=setTimeout((function(){null==c||c()}),null!=u?u:a);return function(){return clearTimeout(e)}}}),[s,u,c]),t?"0"==n?r.createElement(o.F,{intent:"error",action:{title:null==l?void 0:l.title,onClick:null==l?void 0:l.onClick}},t):"1"==n?r.createElement(o.F,{intent:"info",action:{title:null==l?void 0:l.title,onClick:null==l?void 0:l.onClick}},t):"2"==n?r.createElement(o.F,{intent:"success",action:{title:null==l?void 0:l.title,onClick:null==l?void 0:l.onClick}},t):"3"==n?r.createElement(o.F,{intent:"warning",action:{title:null==l?void 0:l.title,onClick:null==l?void 0:l.onClick}},t):r.createElement(r.Fragment,null):null}},24926:(e,t,n)=>{var o;n.d(t,{U:()=>o}),function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(o||(o={}))},87789:(e,t,n)=>{n.d(t,{D:()=>w});var o=n(30112),r=n(8520),i=n(65593),a=n(92153),s=n(10145),l=n(18850),c=(0,l.Ex)("m365card-header-v9.Copied"),u=(0,l.qP)("m365card-header-v9.appIconText"),d=n(79490),p=n(21278),h=n(16895),g=n(658),f=n(62653),m=(0,p.Q)("M365AppTile",(0,g.n)({appName:{fontSize:"12px",fontWeight:600,letterSpacing:"normal",textOverflow:"ellipsis",marginLeft:"12px",overflowY:"hidden",overflowX:"hidden",textAlign:"left",whiteSpace:"nowrap",color:f.L.colorNeutralForeground2},appIcon:(0,d.__assign)({height:"24px",width:"24px",maxWidth:"32px",maxHeight:"32px",overflowX:"hidden",overflowY:"hidden"},h.Pt.borderRadius("3px")),appTile:(0,d.__assign)({paddingTop:"12px",paddingRight:"5px",paddingLeft:"16px"},h.Pt.overflow("hidden")),flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"2px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1}})),y=24,v=24,C="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIyLjAuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxOTIgMTkyIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAxOTIgMTkyOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+CjxyZWN0IHN0eWxlPSJmaWxsOiNFREVCRTk7IiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIvPgo8cGF0aCBzdHlsZT0iZmlsbDojNjA1RTVDOyIgZD0iTTY4LjA2MjUsNTQuODg4N2MwLjU5MzMsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NGMwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NAoJYy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtM2MtMC44MTMsMC0xLjUxNjEsMC4yOTc0LTIuMTA5NCwwLjg5MDZjLTAuNTkzOCwwLjU5MzgtMC44OTA2LDEuMjk2OS0wLjg5MDYsMi4xMDk0Cgl2M2MwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZjLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0di0zYzAtMS42MjQ1LDAuNDA1OC0zLjEyNDUsMS4yMTg4LTQuNWMwLjgxMjUtMS4zNzUsMS45MDU4LTIuNDY4MywzLjI4MTItMy4yODEyCgljMS4zNzUtMC44MTI1LDIuODc1LTEuMjE4OCw0LjUtMS4yMTg4aDNDNjYuNzY1Niw1My45OTgsNjcuNDY4OCw1NC4yOTU0LDY4LjA2MjUsNTQuODg4N3ogTTU5LjA2MjUsNzguODg4NwoJYzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djZjMCwwLjgxMy0wLjI5NzQsMS41MTYxLTAuODkwNiwyLjEwOTRjLTAuNTkzOCwwLjU5MzgtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2CgljLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2Yy0wLjU5MzgtMC41OTMzLTAuODkwNi0xLjI5NjQtMC44OTA2LTIuMTA5NHYtNmMwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTQKCWMwLjU5MzMtMC41OTMzLDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNkM1Ny43NjU2LDc3Ljk5OCw1OC40Njg4LDc4LjI5NTQsNTkuMDYyNSw3OC44ODg3eiBNNTkuMDYyNSwxMDIuODg4NwoJYzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djZjMCwwLjgxMjUtMC4yOTc0LDEuNTE1Ni0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNgoJYy0wLjgxMywwLTEuNTE2MS0wLjI5NjktMi4xMDk0LTAuODkwNmMtMC41OTM4LTAuNTkzOC0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTR2LTZjMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0CgljMC41OTMzLTAuNTkzOCwxLjI5NjQtMC44OTA2LDIuMTA5NC0wLjg5MDZDNTcuNzY1NiwxMDEuOTk4LDU4LjQ2ODgsMTAyLjI5NDksNTkuMDYyNSwxMDIuODg4N3ogTTU5LjA2MjUsMTIzLjg4ODcKCWMwLjU5MzMsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NHYzYzAsMC44MTI1LDAuMjk2OSwxLjUxNTYsMC44OTA2LDIuMTA5NGMwLjU5MzMsMC41OTM4LDEuMjk2NCwwLjg5MDYsMi4xMDk0LDAuODkwNmgzCgljMC44MTI1LDAsMS41MTU2LDAuMjk2OSwyLjEwOTQsMC44OTA2YzAuNTkzMywwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0cy0wLjI5NzQsMS41MTU2LTAuODkwNiwyLjEwOTQKCWMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZoLTNjLTEuNjI1LDAtMy4xMjUtMC40MDYyLTQuNS0xLjIxODhjLTEuMzc1NS0wLjgxMjUtMi40Njg4LTEuOTA2Mi0zLjI4MTItMy4yODEyCgljLTAuODEzLTEuMzc1LTEuMjE4OC0yLjg3NS0xLjIxODgtNC41di0zYzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzMtMC41OTM4LDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNgoJQzU3Ljc2NTYsMTIyLjk5OCw1OC40Njg4LDEyMy4yOTQ5LDU5LjA2MjUsMTIzLjg4ODd6IE04OS4wNjI1LDU0Ljg4ODdjMC41OTMzLDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTQKCWMwLDAuODEzLTAuMjk3NCwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZoLTZjLTAuODEzLDAtMS41MTYxLTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0YzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzMtMC41OTMzLDEuMjk2NC0wLjg5MDYsMi4xMDk0LTAuODkwNmg2CglDODcuNzY1Niw1My45OTgsODguNDY4OCw1NC4yOTU0LDg5LjA2MjUsNTQuODg4N3ogTTg5LjA2MjUsMTMyLjg4ODdjMC41OTMzLDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTQKCXMtMC4yOTc0LDEuNTE1Ni0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtNmMtMC44MTMsMC0xLjUxNjEtMC4yOTY5LTIuMTA5NC0wLjg5MDYKCWMtMC41OTM4LTAuNTkzOC0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTRzMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0YzAuNTkzMy0wLjU5MzgsMS4yOTY0LTAuODkwNiwyLjEwOTQtMC44OTA2aDYKCUM4Ny43NjU2LDEzMS45OTgsODguNDY4OCwxMzIuMjk0OSw4OS4wNjI1LDEzMi44ODg3eiBNMTEzLjA2MjUsNTQuODg4N2MwLjU5MzgsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NAoJYzAsMC44MTMtMC4yOTY5LDEuNTE2MS0wLjg5MDYsMi4xMDk0Yy0wLjU5MzgsMC41OTM4LTEuMjk2OSwwLjg5MDYtMi4xMDk0LDAuODkwNmgtNmMtMC44MTI1LDAtMS41MTU2LTAuMjk2OS0yLjEwOTQtMC44OTA2CgljLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0YzAtMC44MTI1LDAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NGMwLjU5MzgtMC41OTMzLDEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNmg2CglDMTExLjc2NTYsNTMuOTk4LDExMi40Njg4LDU0LjI5NTQsMTEzLjA2MjUsNTQuODg4N3ogTTExMy4wNjI1LDEzMi44ODg3YzAuNTkzOCwwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0CglzLTAuMjk2OSwxLjUxNTYtMC44OTA2LDIuMTA5NHMtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2aC02Yy0wLjgxMjUsMC0xLjUxNTYtMC4yOTY5LTIuMTA5NC0wLjg5MDYKCXMtMC44OTA2LTEuMjk2OS0wLjg5MDYtMi4xMDk0czAuMjk2OS0xLjUxNTYsMC44OTA2LTIuMTA5NHMxLjI5NjktMC44OTA2LDIuMTA5NC0wLjg5MDZoNgoJQzExMS43NjU2LDEzMS45OTgsMTEyLjQ2ODgsMTMyLjI5NDksMTEzLjA2MjUsMTMyLjg4ODd6IE0xMzMuNDUzMSw1NS4yMTY4YzEuMzc1LDAuODEzLDIuNDY4OCwxLjkwNjIsMy4yODEyLDMuMjgxMgoJYzAuODEyNSwxLjM3NTUsMS4yMTg4LDIuODc1NSwxLjIxODgsNC41djNjMCwwLjgxMy0wLjI5NjksMS41MTYxLTAuODkwNiwyLjEwOTRjLTAuNTkzOCwwLjU5MzgtMS4yOTY5LDAuODkwNi0yLjEwOTQsMC44OTA2CglzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNmMtMC41OTM4LTAuNTkzMy0wLjg5MDYtMS4yOTY0LTAuODkwNi0yLjEwOTR2LTNjMC0wLjgxMjUtMC4yOTY5LTEuNTE1Ni0wLjg5MDYtMi4xMDk0CgljLTAuNTkzOC0wLjU5MzMtMS4yOTY5LTAuODkwNi0yLjEwOTQtMC44OTA2aC0zYy0wLjgxMjUsMC0xLjUxNTYtMC4yOTY5LTIuMTA5NC0wLjg5MDZjLTAuNTkzOC0wLjU5MzMtMC44OTA2LTEuMjk2NC0wLjg5MDYtMi4xMDk0CgljMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0YzAuNTkzOC0wLjU5MzMsMS4yOTY5LTAuODkwNiwyLjEwOTQtMC44OTA2aDMKCUMxMzAuNTc4MSw1My45OTgsMTMyLjA3ODEsNTQuNDA0MywxMzMuNDUzMSw1NS4yMTY4eiBNMTM3LjA2MjUsMTIzLjg4ODdjMC41OTM4LDAuNTkzOCwwLjg5MDYsMS4yOTY5LDAuODkwNiwyLjEwOTR2MwoJYzAsMS42MjUtMC40MDYyLDMuMTI1LTEuMjE4OCw0LjVzLTEuOTA2MiwyLjQ2ODgtMy4yODEyLDMuMjgxMnMtMi44NzUsMS4yMTg4LTQuNSwxLjIxODhoLTNjLTAuODEyNSwwLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNgoJcy0wLjg5MDYtMS4yOTY5LTAuODkwNi0yLjEwOTRzMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0czEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNmgzYzAuODEyNSwwLDEuNTE1Ni0wLjI5NjksMi4xMDk0LTAuODkwNgoJczAuODkwNi0xLjI5NjksMC44OTA2LTIuMTA5NHYtM2MwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTRzMS4yOTY5LTAuODkwNiwyLjEwOTQtMC44OTA2CglTMTM2LjQ2ODgsMTIzLjI5NDksMTM3LjA2MjUsMTIzLjg4ODd6IE0xMzcuMDYyNSw3OC44ODg3YzAuNTkzOCwwLjU5MzgsMC44OTA2LDEuMjk2OSwwLjg5MDYsMi4xMDk0djYKCWMwLDAuODEzLTAuMjk2OSwxLjUxNjEtMC44OTA2LDIuMTA5NGMtMC41OTM4LDAuNTkzOC0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNgoJYy0wLjU5MzgtMC41OTMzLTAuODkwNi0xLjI5NjQtMC44OTA2LTIuMTA5NHYtNmMwLTAuODEyNSwwLjI5NjktMS41MTU2LDAuODkwNi0yLjEwOTRjMC41OTM4LTAuNTkzMywxLjI5NjktMC44OTA2LDIuMTA5NC0wLjg5MDYKCVMxMzYuNDY4OCw3OC4yOTU0LDEzNy4wNjI1LDc4Ljg4ODd6IE0xMzcuMDYyNSwxMDIuODg4N2MwLjU5MzgsMC41OTM4LDAuODkwNiwxLjI5NjksMC44OTA2LDIuMTA5NHY2CgljMCwwLjgxMjUtMC4yOTY5LDEuNTE1Ni0wLjg5MDYsMi4xMDk0cy0xLjI5NjksMC44OTA2LTIuMTA5NCwwLjg5MDZzLTEuNTE1Ni0wLjI5NjktMi4xMDk0LTAuODkwNnMtMC44OTA2LTEuMjk2OS0wLjg5MDYtMi4xMDk0di02CgljMC0wLjgxMjUsMC4yOTY5LTEuNTE1NiwwLjg5MDYtMi4xMDk0czEuMjk2OS0wLjg5MDYsMi4xMDk0LTAuODkwNlMxMzYuNDY4OCwxMDIuMjk0OSwxMzcuMDYyNSwxMDIuODg4N3oiLz4KPC9zdmc+Cg==";function b(e){var t=e.appIcon,n=e.appName,l=null!=t?t:C,c=m(),d=(0,o.z)(c.flex,c.appTile),p=(0,i.mY)({appIconText:u});return r.createElement("div",{className:d},r.createElement("div",{className:"styles.flexItem"},r.createElement(a._,{alt:p.appIconText({appName:n}),className:c.appIcon,src:l,height:y,width:v})),r.createElement("div",{className:"styles.flexItem"},r.createElement(s.E,{className:c.appName},n)))}var E=n(68779),A=n(21137),S=n(79689),I=n(88700),P=(0,p.Q)("M365CardHeaderOptions",(0,g.n)({cardOptions:{paddingTop:"12px"},optionsStack:{paddingRight:"16px"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1},button:{backgroundColor:f.L.colorNeutralCardBackground,":hover":{backgroundColor:f.L.colorNeutralCardBackground}}}));function T(e){var t=e.options,n=P(),a=(0,o.z)(n.flex,n.optionsStack),s=(0,o.z)(n.flexItem,n.cardOptions),l=(0,d.__read)(r.useState(!1),2),u=l[0],p=l[1],h=(0,i.Lh)(c);return r.createElement("div",{className:a},t.map((function(e){var t;return r.createElement("div",{key:null===(t=null==e?void 0:e.iconProps)||void 0===t?void 0:t.iconName,className:s},r.createElement(E.m,{content:h,relationship:"label",visible:u},r.createElement(A.$,{className:n.button,size:"small",style:{border:"none"},icon:u?r.createElement(S.c6S,null):r.createElement(I.k8e,null),onClick:function(){var t;null===(t=null==e?void 0:e.onMenuClick)||void 0===t||t.call(e),setTimeout((function(){p(!1)}),5e3),p(!0)}})))})))}var x=(0,p.Q)("M365CardHeader",(0,g.n)({cardAppHeader:{justifyContent:"space-between"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1},backgroundColor:f.L.colorNeutralCardBackground},flexItem:{height:"auto",width:"auto",flexShrink:1}}));function w(e){var t=e.appName,n=e.appIcon,i=e.options,a=e.optionsComponents,s=x(),l=(0,o.z)(s.flex,s.cardAppHeader);return r.createElement("div",{className:l},r.createElement("div",{className:s.flexItem},t&&r.createElement(b,{appIcon:n,appName:t})),r.createElement("div",{className:s.flexItem},i&&r.createElement(T,{options:i})),r.createElement("div",{className:s.flexItem},a&&a))}},21120:(e,t,n)=>{n.d(t,{g:()=>p});var o=n(79490);const r="https://outlook.office365.com/connectors",i="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",a="/actionsb2netcore",s="https://urlp.asm.skype.com/v1/url/content?url=",l="https://urlp-v2.asm.skype.com",c="https://outlook.office.com/actionsb2netcore",u="Orange",d="Office";function p(e,t,n,p,h){return(0,o.__awaiter)(this,void 0,void 0,(function*(){var o;const g=n.host.name===u||n.host.name===d?c:a,f=yield caches.open("image-cache"),m=function(e){return e.url}(e),y=yield f.match(m);if(y){const e=URL.createObjectURL(yield y.blob());return Promise.resolve({url:e,isCachedImage:!0})}if(void 0===(null==t?void 0:t.userPrincipalName))return Promise.reject(new Error("User principal name is not available"));let v,C;h?(v=e.url.includes(s)?e.url:`${s}${encodeURIComponent(e.url)}`,C=yield p.getToken({resource:l})):(v=t.userPrincipalName?`${g}/${t.userPrincipalName}/th?u=${encodeURIComponent(e.url)}`:`${g}/th?u=${encodeURIComponent(e.url)}`,C=yield p.getToken({resource:r}));const b=new Headers;C&&(null==C?void 0:C.authToken)&&b.set("Authorization",`Bearer ${C.authToken}`),t.userPrincipalName&&(b.set("X-RoutingParameter-SessionKey",t.userPrincipalName),b.set("X-AnchorMailbox",t.userPrincipalName));const E={method:"GET",headers:b};try{const e=yield fetch(v,E);if(e.ok&&0===(null===(o=e.headers.get("Content-Type"))||void 0===o?void 0:o.indexOf("image"))){yield f.put(m,e.clone());const t=URL.createObjectURL(yield e.blob());return Promise.resolve({url:t,isCachedImage:!1})}return Promise.resolve({url:i,isCachedImage:!1})}catch(e){return Promise.reject(new Error("Failed to get image. Error: "+String(e)))}}))}},11120:(e,t,n)=>{var o,r,i,a,s,l,c,u,d,p,h,g,f,m;n.d(t,{FG:()=>o,FY:()=>r,Pk:()=>g,Ve:()=>m,X2:()=>p,YE:()=>c,lp:()=>f,m2:()=>i,mU:()=>h,ru:()=>s,vP:()=>u,xe:()=>l,yx:()=>a}),function(e){e[e.None=0]="None",e[e.AppDefinitionIsUndefined=1]="AppDefinitionIsUndefined",e[e.AttributedDataNotFound=2]="AttributedDataNotFound",e[e.UserPrincipalNameIsNotAvailable=3]="UserPrincipalNameIsNotAvailable",e[e.HostLocaleIsUndefined=4]="HostLocaleIsUndefined",e[e.cardContentParseError=5]="cardContentParseError"}(o||(o={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(r||(r={})),function(e){e[e.None=0]="None",e[e.MsgExtCardHeader=1]="MsgExtCardHeader",e[e.getAppDataException=2]="getAppDataException",e[e.verifyCardException=3]="verifyCardException",e[e.createMsgExtContext=4]="createMsgExtContext",e[e.getAppDataForAPIPlugins=5]="getAppDataForAPIPlugins",e[e.getCECDetails=6]="getCECDetails",e[e.CECCard=7]="CECCard",e[e.getCECBotId=8]="getCECBotId",e[e.APIPluginCard=9]="APIPluginCard"}(i||(i={})),function(e){e[e.None=0]="None",e[e.CardRender=1]="CardRender",e[e.CardActions=2]="CardActions",e[e.BotInvoke=3]="BotInvoke",e[e.GetApp=4]="GetApp",e[e.GetImage=5]="GetImage",e[e.OpenDialog=6]="OpenDialog",e[e.CitationOrEntityControl=7]="CitationOrEntityControl",e[e.ReferenceContainer=8]="ReferenceContainer",e[e.GetUserConfig=9]="GetUserConfig",e[e.FindAcquisition=10]="FindAcquisition",e[e.GetAndCacheAcquisition=11]="GetAndCacheAcquisition",e[e.CardService=12]="CardService",e[e.BrokeredCardService=13]="BrokeredCardService",e[e.APIPluginCardService=14]="APIPluginCardService",e[e.APIPluginHostService=15]="APIPluginHostService",e[e.APIPluginOAuth2Service=16]="APIPluginOAuth2Service",e[e.CECCardService=17]="CECCardService",e[e.CECAuthService=18]="CECAuthService"}(a||(a={})),function(e){e[e.None=0]="None",e[e.getHeaderOptions=1]="getHeaderOptions",e[e.MsgExtCardReference=2]="MsgExtCardReference",e[e.MsgExtCard=3]="MsgExtCard",e[e.APIPluginCardReference=4]="APIPluginCardReference",e[e.APIPluginCard=5]="APIPluginCard",e[e.getAppDataForAPIPlugins=6]="getAppDataForAPIPlugins",e[e.getCECDetails=7]="getCECDetails",e[e.CECCard=8]="CECCard",e[e.getCECBotId=9]="getCECBotId"}(s||(s={})),function(e){e[e.None=0]="None",e[e.M365CardRenderer=1]="M365CardRenderer",e[e.OpenUrlActivityRequest=2]="OpenUrlActivityRequest",e[e.ActionExecuteActivityRequest=3]="ActionExecuteActivityRequest",e[e.SigninActionActivityRequest=4]="SigninActionActivityRequest",e[e.SubmitActionActivityRequest=5]="SubmitActionActivityRequest",e[e.BotInvokeRequest=6]="BotInvokeRequest",e[e.BotInvokeFetchToken=7]="BotInvokeFetchToken",e[e.GetAppFromMOS3=8]="GetAppFromMOS3",e[e.GetImageProxyUrl=9]="GetImageProxyUrl",e[e.OpenStageView=10]="OpenStageView",e[e.OpenTaskModule=11]="OpenTaskModule",e[e.MsgExtCardPreview=12]="MsgExtCardPreview",e[e.MsgExtCitationOrEntityControl=13]="MsgExtCitationOrEntityControl",e[e.MsgExtCardReferenceContainer=14]="MsgExtCardReferenceContainer",e[e.GetUserConfigFrom3S=15]="GetUserConfigFrom3S",e[e.FindAcquisitionforMOS=16]="FindAcquisitionforMOS",e[e.GetAndCacheAcquisitionFromMOS3=17]="GetAndCacheAcquisitionFromMOS3",e[e.M365CardParser=18]="M365CardParser",e[e.OpenUrl=19]="OpenUrl",e[e.ActionSubmit=20]="ActionSubmit",e[e.ActionExecute=21]="ActionExecute",e[e.CopyCard=22]="CopyCard",e[e.APIPluginCardReferenceContainer=23]="APIPluginCardReferenceContainer",e[e.APIPluginSignInButton=24]="APIPluginSignInButton",e[e.GetAndCacheAcquisitionFromLaunchInfo=25]="GetAndCacheAcquisitionFromLaunchInfo",e[e.GetAppFromHybrid=26]="GetAppFromHybrid",e[e.ExternalAppChannelServiceCEA=27]="ExternalAppChannelServiceCEA",e[e.APIPluginCard=28]="APIPluginCard",e[e.APIPluginCitationOrEntityControl=29]="APIPluginCitationOrEntityControl",e[e.ExternalCardActionServiceCEA=30]="ExternalCardActionServiceCEA",e[e.InsertImageActionActivityRequest=31]="InsertImageActionActivityRequest",e[e.ActionInsertImage=32]="ActionInsertImage"}(l||(l={})),function(e){e.Successful="true",e.Failure="false",e.Timeout="timeout"}(c||(c={})),function(e){e.Intent="Intent",e.Client="Client",e.AppId="AppId",e.ActionType="ActionType",e.RetryCount="RetryCount",e.RuntimeActivityResponseMethod="RuntimeActivityResponseMethod",e.RequestName="RequestName",e.HttpStatusCode="HttpStatusCode",e.DialogContentType="DialogContentType",e.HasURL="HasURL",e.citationIndex="citationIndex",e.ActionErrorType="ActionErrorType",e.ModalViewType="ModalViewType",e.IsTaskFetch="IsTaskFetch",e.ActionExecuteResponseType="ActionExecuteResponseType",e.CardRendered="CardRendered"}(u||(u={})),function(e){e[e.HeroCard=0]="HeroCard",e[e.ThumbnailCard=1]="ThumbnailCard",e[e.ConnectorCard=2]="ConnectorCard",e[e.AdaptiveCard=3]="AdaptiveCard",e[e.SignInCard=5]="SignInCard",e[e.ConfigCard=6]="ConfigCard",e[e.ErrorCard=7]="ErrorCard"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.OpenUrl=1]="OpenUrl",e[e.Execute=2]="Execute",e[e.SignIn=3]="SignIn",e[e.Submit=4]="Submit",e[e.Auth=5]="Auth",e[e.ImBack=6]="ImBack",e[e.MessageBack=7]="MessageBack",e[e.InsertImage=8]="InsertImage"}(p||(p={})),function(e){e[e.Execute=0]="Execute",e[e.OnCompletion=1]="OnCompletion"}(h||(h={})),function(e){e[e.Others=0]="Others",e[e.BotInvokeError=1]="BotInvokeError"}(g||(g={})),function(e){e[e.Unknown=0]="Unknown",e[e.StageView=1]="StageView",e[e.TaskModule=2]="TaskModule"}(f||(f={})),function(e){e[e.Result=0]="Result",e[e.AuthError=1]="AuthError",e[e.Error=2]="Error"}(m||(m={}))},90763:(e,t,n)=>{function o(e){const t=e.inputExtensions;if(!t||0===t.length)return;let n;return t.forEach((e=>{var t;const o=null===(t=null==e?void 0:e.commands)||void 0===t?void 0:t.find((e=>e.initialRun));o&&(n=o.id)})),n}function r(e){var t,n;if(e.composeExtensions){const t=e.composeExtensions.find((e=>!!e.botId));if(t&&t.botId)return t.botId}if(e.inputExtensions){const t=e.inputExtensions.find((e=>!!e.botId));if(t&&t.botId)return t.botId}return null!==(n=null===(t=e.webApplicationInfo)||void 0===t?void 0:t.id)&&void 0!==n?n:""}n.d(t,{L:()=>r,V:()=>o})},15666:(e,t,n)=>{function o(e){var t,n,o,r,i,a,s,l,c,u;const d=null!==(t=e.titleDefinition)&&void 0!==t?t:e.unfurlingTitlePreviewDefinition;let p,h,g,f,m,y,v;if(Array.isArray(null==d?void 0:d.elementDefinitions)){const e=null===(n=null==d?void 0:d.elementDefinitions)||void 0===n?void 0:n.find((e=>"ComposeExtensions"===e.elementType));e&&e.definition&&(p=JSON.parse(e.definition),Array.isArray(p)||(p=[p])),p&&(v=p.map((e=>{var t;return{botId:null!==(t=null==e?void 0:e.botId)&&void 0!==t?t:"",type:"BotBased",commands:null==e?void 0:e.commands}})))}else p=null===(o=d.elementDefinitions)||void 0===o?void 0:o.composeExtensions,h=null===(r=d.elementDefinitions)||void 0===r?void 0:r.plugins,g=null===(i=d.elementDefinitions)||void 0===i?void 0:i.openAiPlugins,f=null===(a=d.elementDefinitions)||void 0===a?void 0:a.gpts,null==f||f.map((t=>{t.id=e.titleId+"."+t.id})),m=null===(s=d.elementDefinitions)||void 0===s?void 0:s.declarativeCopilots,null==m||m.map((t=>{t.id=e.titleId+"."+t.id})),y=null===(l=d.elementDefinitions)||void 0===l?void 0:l.customEngineCopilots,p&&(v=p.map((e=>{var t;return{botId:null!==(t=null==e?void 0:e.botId)&&void 0!==t?t:"",type:"ApiBased",commands:null==e?void 0:e.commands}})));let C="NotInstalled";if(e.acquisitionState)switch(e.acquisitionState.toLowerCase()){case"acquired":C="Installed";break;case"blocked":C="Blocked";break;case"needsconsentforupgrade":C="RequireConsent";break;default:C="NotInstalled"}return{id:e.appId,name:null==d?void 0:d.name,manifestVersion:d.manifestVersion,developerName:d.developerName,isFullTrust:d.isFullTrust,devicePermissions:d.devicePermissions,inputExtensions:p,webApplicationInfo:d.webApplicationInfo,showLoadingIndicator:d.showLoadingIndicator,shortDescription:d.shortDescription,largeImageUrl:null===(c=d.iconLarge)||void 0===c?void 0:c.uri,smallImageUrl:null===(u=d.iconSmall)||void 0===u?void 0:u.uri,state:C,version:d.version,validDomains:d.validDomains,privacyUrl:d.privacyUrl,plugins:h,openAiPlugins:g,gpts:f,declarativeCopilots:m,composeExtensions:v,customEngineCopilots:y}}n.d(t,{P:()=>o})},77373:(e,t,n)=>{n.d(t,{BF:()=>a,G3:()=>r,H0:()=>i});var o=n(69323);class r{constructor(e,t){this.content=e,this.type=t}}class i{constructor(e,t){this.code=e,this.message=t,this.type="Error"}}class a{constructor(e,t){this._rawContent=e,this.type=t;try{const e=JSON.parse(this._rawContent);this._auth=new o.Ht,this._auth.parse(e);for(const e of this._auth.buttons)if("signin"===e.type&&e.value){new URL(e.value),this.signInButton=e;break}}catch(e){}}get tokenExchangeResource(){var e;return null===(e=this._auth)||void 0===e?void 0:e.tokenExchangeResource}}},82420:(e,t,n)=>{n.d(t,{O:()=>r,P:()=>o});class o{constructor(e,t){this.response=e,this.status=t}}class r{constructor(e,t,n){this.status=e,this.code=t,this.message=n,this.type="Error"}}},66636:(e,t,n)=>{var o;n.d(t,{r:()=>o}),function(e){e.OpenUrl="Action.OpenUrl",e.Execute="Action.Execute",e.Submit="Action.Submit"}(o||(o={}))},71086:(e,t,n)=>{var o;n.d(t,{t:()=>o}),function(e){e.Result="result",e.Error="error"}(o||(o={}))},85489:(e,t,n)=>{var o,r,i;n.d(t,{yl:()=>o}),function(e){e.Success="Success",e.Failure="Failure",e.Error="Error",e.Unknown="Unknown"}(o||(o={})),function(e){e.TaskModule="TaskModule",e.StageView="StageView"}(r||(r={})),function(e){e.InvalidOrigin="InvalidOrigin",e.AppDefNotFound="AppDefNotFound",e.AppIdMissing="AppIdMissing"}(i||(i={}))},51986:(e,t,n)=>{n.d(t,{o:()=>f});var o,r,i=n(79490),a=n(11120),s=n(85489),l=n(71086),c=n(30185),u=n(25510),d=n(9923),p=n(16177),h=n(77373);!function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Ok=200]="Ok",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.Moved=301]="Moved",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.Redirect=302]="Redirect",e[e.RedirectMethod=303]="RedirectMethod",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.Conflict=409]="Conflict",e[e.TooManyRequests=429]="TooManyRequests",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout"}(o||(o={})),function(e){e.TeamsHubCopilot3sInvoke="TeamsHubCopilot3sInvoke",e.OfficeWebCopilot3sInvoke="OfficeWebCopilot3sInvoke",e.OutlookWebCopilot3sInvoke="OutlookWebCopilot3sInvoke",e.CibCopilot3sInvoke="cibCopilot3sInvoke",e.M365CardSDK="M365CardSDK"}(r||(r={}));class g{constructor(e,t,n){this.channelService=e,this.appService=t,this.telemetryService=n}handleActionExecute(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,i,s,d,p,g,f,m,y,v,C,b,E,A,S,I,P,T,x,w,k;const _=new c.k(this.telemetryService,a.yx.CardService,a.xe.ActionExecute),D={},F={cardData:e.cardData,botId:e.botId,appId:e.appId,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:e.actionId,verb:e.actionVerb,data:e.actionData},trigger:null!==(t=e.trigger)&&void 0!==t?t:"manual"}}};e.authCode&&(F.requestBody.value.state=e.authCode),e.authToken&&(F.requestBody.value.authentication={token:e.authToken});const L=yield null===(n=this.channelService)||void 0===n?void 0:n.botInvoke(F);let O;if((null==L?void 0:L.type)===l.t.Error||!(null==L?void 0:L.value)){const e=L.value;return new h.H0(e.errorCode,e.errorMessage)}const R=L.value;switch(null==R?void 0:R.statusCode){case o.Ok:O=new h.G3(JSON.stringify(R.value),R.type),D[a.vP.ActionExecuteResponseType]=a.Ve.Result,_.logMetricEnd({props:D,diagnosticsData:`TypeOfCard: ${null===(r=null==e?void 0:e.cardData)||void 0===r?void 0:r.contentType}, cardId : ${null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.cardId}, cardsize: ${null===(d=null===(s=null==e?void 0:e.cardData)||void 0===s?void 0:s.content)||void 0===d?void 0:d.length}, Appid: ${(0,u.n)(null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.titleId,null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.appId)}`},null===(f=e.cardData)||void 0===f?void 0:f.cardId);break;case o.Unauthorized:if(L.value){O=new h.BF(JSON.stringify(R.value),R.type),D[a.vP.ActionExecuteResponseType]=a.Ve.AuthError,_.logMetricEnd({props:D,diagnosticsData:`TypeOfCard: ${null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.contentType}, cardId : ${null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.cardId}, cardsize: ${null===(C=null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.content)||void 0===C?void 0:C.length}, Appid: ${(0,u.n)(null===(b=null==e?void 0:e.cardData)||void 0===b?void 0:b.titleId,null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.appId)}`},null===(A=e.cardData)||void 0===A?void 0:A.cardId);break}O=new h.H0(500,"response is empty"),D[a.vP.ActionExecuteResponseType]=a.Ve.Error,_.logMetricEndWithError({props:D,diagnosticsData:`Error: Action Execute failed. Bot response is empty or error, Appid: ${(0,u.n)(null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.titleId,null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.appId)}`},null===(P=e.cardData)||void 0===P?void 0:P.cardId);break;default:O=new h.H0(null!==(T=null==R?void 0:R.statusCode)&&void 0!==T?T:500,JSON.stringify(null==R?void 0:R.value)),D[a.vP.ActionExecuteResponseType]=a.Ve.Error,_.logMetricEndWithError({props:D,diagnosticsData:`Error: Action Execute failed. Bot response status code is not supported, Appid: ${(0,u.n)(null===(x=null==e?void 0:e.cardData)||void 0===x?void 0:x.titleId,null===(w=null==e?void 0:e.cardData)||void 0===w?void 0:w.appId)}`},null===(k=e.cardData)||void 0===k?void 0:k.cardId)}return O}))}getAppDefinition(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){return yield this.appService.getApp({id:e.id})}))}}class f extends g{constructor(e,t,n,o){super(t,n,o),this.hostService=e,this.channelService=t,this.appService=n,this.telemetryService=o}handleOpenUrl(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,o,r,i,l,d,h,g,f,m,y,v,C;const b=new c.k(this.telemetryService,a.yx.CardService,a.xe.OpenUrl),E={};try{let c,y={type:p.p.Unhandled,params:{url:new URL(e.url)}};switch(e.disableDeepLinkProcessing||(y=(0,p.G)(null==e?void 0:e.url)),y.type){case p.p.StageView:E[a.vP.ModalViewType]=a.lp.StageView,c={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:y.params.appId,stageInfo:y.params.stageInfo},e.conversationId&&(c.conversationId=e.conversationId),yield null===(n=this.hostService)||void 0===n?void 0:n.openStageView(c);break;case p.p.TaskModule:E[a.vP.ModalViewType]=a.lp.TaskModule,c={cardData:e.cardData,botId:null!==(o=e.botId)&&void 0!==o?o:"",appId:y.params.appId,taskInfo:y.params.taskInfo},e.conversationId&&(c.conversationId=e.conversationId),yield null===(r=this.hostService)||void 0===r?void 0:r.openTaskModule(c);break;default:c={cardData:e.cardData,url:e.url},e.conversationId&&(c.conversationId=e.conversationId),yield this.hostService.openUrl(c)}return b.logMetricEnd({props:E,diagnosticsData:`TypeOfCard: ${null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.contentType}, cardId : ${null===(l=null==e?void 0:e.cardData)||void 0===l?void 0:l.cardId}, cardsize: ${null===(h=null===(d=null==e?void 0:e.cardData)||void 0===d?void 0:d.content)||void 0===h?void 0:h.length}, Appid: ${(0,u.n)(null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.titleId,null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.appId)}`},null===(m=e.cardData)||void 0===m?void 0:m.cardId),{status:s.yl.Success,linkType:y.type}}catch(t){return b.logMetricEndWithError({props:E,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t},  Appid: ${(0,u.n)(null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.titleId,null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.appId)}`},null===(C=e.cardData)||void 0===C?void 0:C.cardId),Promise.reject(t)}}))}handleActionSubmit(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,o,r,p,h,g,f,m,y,v,C,b,E,A,S,I,P,T,x,w,k,_,D,F,L,O,R,M,B,N,V,H;const U=new c.k(this.telemetryService,a.yx.CardService,a.xe.ActionSubmit),j={};try{if(!e.data||!e.appId)return U.logMetricEndWithError({props:j,diagnosticsData:`Error: ActionSubmit failed as data or appId is undefined, Appid: ${(0,u.n)(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},null===(o=e.cardData)||void 0===o?void 0:o.cardId),Promise.reject("Data or appId is undefined");if((0,d.Kl)(e.data)&&(null===(r=e.data)||void 0===r?void 0:r.msteams.value.tabInfo)){j[a.vP.ModalViewType]=a.lp.StageView;const t=Object.assign(Object.assign({},e.data.msteams.value.tabInfo),{triggeringActionTitle:e.triggeringActionTitle}),n={cardData:e.cardData,botId:e.botId,appId:e.appId,stageInfo:t};e.conversationId&&(n.conversationId=e.conversationId),yield this.hostService.openStageView(n)}else if((0,d.wY)(e.data)){j[a.vP.ActionType]=a.X2.ImBack;const t={type:"imBack",cardData:e.cardData,prompt:e.data.msteams.value};yield this.channelService.botMessage(t)}else{if(!(0,d.Sr)(e.data)&&!(0,d.R1)(e))return U.logMetricEndWithError({props:j,diagnosticsData:`Error: ActionSubmit failed as passed action submit type is not supported, Appid: ${(0,u.n)(null===(w=null==e?void 0:e.cardData)||void 0===w?void 0:w.titleId,null===(k=null==e?void 0:e.cardData)||void 0===k?void 0:k.appId)}`},null===(_=e.cardData)||void 0===_?void 0:_.cardId),{status:s.yl.Failure};{let t;if(j[a.vP.ModalViewType]=a.lp.TaskModule,null===(g=null===(h=null===(p=e.data)||void 0===p?void 0:p.msteams)||void 0===h?void 0:h.value)||void 0===g?void 0:g.tabInfo){const n=Object.assign(Object.assign({},e.data.msteams.value.tabInfo),{triggeringActionTitle:e.triggeringActionTitle});t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:n},e.conversationId&&(t.conversationId=e.conversationId)}else if("task/fetch"===(null===(y=null===(m=null===(f=e.data)||void 0===f?void 0:f.msteams)||void 0===m?void 0:m.value)||void 0===y?void 0:y.type)||"task/fetch"===(null===(C=null===(v=e.data)||void 0===v?void 0:v.msteams)||void 0===C?void 0:C.type)||(0,d.R1)(e)){j[a.vP.IsTaskFetch]=1;const n=e.data,{msteams:o}=n,r=(0,i.__rest)(n,["msteams"]),s=(0,d.Sr)(e.data)?"task/fetch":"task/submit",c={appId:e.appId,botId:e.botId,requestBody:{name:s,value:{data:Object.assign(Object.assign({},null==o?void 0:o.value),r)}}};e.conversationId&&c.requestBody&&(c.requestBody.conversation={id:e.conversationId});const p=yield this.channelService.botInvoke(c);if(p.type===l.t.Error||!p.value)return U.logMetricEndWithError({props:j,diagnosticsData:`Error: Bot invoke failed. Bot response is empty or error, Appid: ${(0,u.n)(null===(b=null==e?void 0:e.cardData)||void 0===b?void 0:b.titleId,null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.appId)}`},null===(A=e.cardData)||void 0===A?void 0:A.cardId),Promise.reject("Bot invoke failed");if((null==p?void 0:p.type)===l.t.Result){const n=p.value;if(!(null===(S=n.task)||void 0===S?void 0:S.value))return U.logMetricEndWithError({props:j,diagnosticsData:`Error: Task info is not present in bot response, Appid: ${(0,u.n)(null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.titleId,null===(P=null==e?void 0:e.cardData)||void 0===P?void 0:P.appId)}`},null===(T=e.cardData)||void 0===T?void 0:T.cardId),Promise.reject("Task info is not present in bot response");const o=Object.assign(Object.assign({},null===(x=n.task)||void 0===x?void 0:x.value),{triggeringActionTitle:e.triggeringActionTitle});t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:o},e.conversationId&&(t.conversationId=e.conversationId)}}t&&(yield this.hostService.openTaskModule(t))}}U.logMetricEnd({props:j,diagnosticsData:`TypeOfCard: ${null===(D=null==e?void 0:e.cardData)||void 0===D?void 0:D.contentType}, cardId : ${null===(F=null==e?void 0:e.cardData)||void 0===F?void 0:F.cardId}, cardsize: ${null===(O=null===(L=null==e?void 0:e.cardData)||void 0===L?void 0:L.content)||void 0===O?void 0:O.length}, Appid: ${(0,u.n)(null===(R=null==e?void 0:e.cardData)||void 0===R?void 0:R.titleId,null===(M=null==e?void 0:e.cardData)||void 0===M?void 0:M.appId)}`},null===(B=e.cardData)||void 0===B?void 0:B.cardId)}catch(t){return U.logMetricEndWithError({props:j,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${(0,u.n)(null===(N=null==e?void 0:e.cardData)||void 0===N?void 0:N.titleId,null===(V=null==e?void 0:e.cardData)||void 0===V?void 0:V.appId)}`},null===(H=e.cardData)||void 0===H?void 0:H.cardId),{status:s.yl.Error}}return{status:s.yl.Success}}))}}},9923:(e,t,n)=>{n.d(t,{Kl:()=>r,R1:()=>s,Sr:()=>i,wY:()=>a});var o=n(11404);function r(e){var t,n,o,r,i;return"invoke"===(null===(t=e.msteams)||void 0===t?void 0:t.type)&&"tab/tabInfoAction"===(null===(o=null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.value)||void 0===o?void 0:o.type)&&!!(null===(i=null===(r=null==e?void 0:e.msteams)||void 0===r?void 0:r.value)||void 0===i?void 0:i.tabInfo)}function i(e){var t,n,o,r;return"task/fetch"===(null===(t=null==e?void 0:e.msteams)||void 0===t?void 0:t.type)||"invoke"===(null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.type)&&"task/fetch"===(null===(r=null===(o=null==e?void 0:e.msteams)||void 0===o?void 0:o.value)||void 0===r?void 0:r.type)}function a(e){var t,n;return"imback"===(null===(t=null==e?void 0:e.msteams)||void 0===t?void 0:t.type.toLowerCase())&&(null===(n=null==e?void 0:e.msteams)||void 0===n?void 0:n.value)}function s(e){var t;return e.appId&&(null===(t=e.cardData)||void 0===t?void 0:t.contentType)===o.z.AdaptiveCard&&e.data}},16177:(e,t,n)=>{var o;function r(e){if(!function(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every((e=>e))}catch(e){return!1}}(e))return{type:o.Unhandled,params:{url:new URL(e)}};const t=new URL(e);if(!t.pathname)return{type:o.Unhandled,params:{url:new URL(e)}};return"https://teams.microsoft.com"===t.origin&&/^\/l\//.test(t.pathname)?function(e){var t,n,r,i,a,s;try{if(!e)return;const l=e.pathname.match(/^\/l\/task\/([^/]+)$/);if(2!==(null==l?void 0:l.length)||!l[1])throw new Error("Invalid Teams url format for TaskModule");const c={height:null!==(t=e.searchParams.get("width"))&&void 0!==t?t:void 0,width:null!==(n=e.searchParams.get("height"))&&void 0!==n?n:void 0},u={url:null!==(r=e.searchParams.get("url"))&&void 0!==r?r:void 0,fallbackUrl:null!==(i=e.searchParams.get("fallbackUrl"))&&void 0!==i?i:void 0,card:e.searchParams.get("card")?JSON.stringify(e.searchParams.get("card")):void 0,width:c.width,height:c.height,title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,completionBotId:null!==(s=e.searchParams.get("completionBotId"))&&void 0!==s?s:void 0};return{type:o.TaskModule,params:{appId:l[1],taskInfo:u}}}catch(e){return}}(t)||a(t)||s(t)||i(t):{type:o.Unhandled,params:{url:new URL(e)}}}n.d(t,{G:()=>r,p:()=>o}),function(e){e.TaskModule="taskModule",e.StageView="stageView",e.LaunchPage="launchPage",e.Unhandled="unhandled"}(o||(o={}));const i=e=>({type:o.Unhandled,params:{url:e}});const a=e=>{try{const t=e,n=t.pathname.match(/^\/l\/stage\/([^/]+)\/([^/]+)$/);if(3!==(null==n?void 0:n.length)||!n[1])throw new Error("Invalid Teams url format for StageView");const r=t.searchParams.get("context");let i={};const a=decodeURIComponent(null!=r?r:"");return i=JSON.parse(a),{type:o.StageView,params:{appId:n[1],stageInfo:i}}}catch(e){return}},s=e=>{var t,n;try{const r=/^\/l\/entity\/([^/]+)\/([^/]+)$/,i=e,a=i.pathname.match(r);if(3!==(null==a?void 0:a.length))throw new Error("Invalid Teams url format for Tab");const s=a[1];let l;if(i.searchParams.has("context")){const e=i.searchParams.get("context"),t=decodeURIComponent(null!=e?e:"");l=JSON.parse(t)}const c={entityId:a[2],webUrl:null!==(t=i.searchParams.get("webUrl"))&&void 0!==t?t:void 0,label:null!==(n=i.searchParams.get("label"))&&void 0!==n?n:void 0,subEntityId:null==l?void 0:l.subEntityId};return{type:o.LaunchPage,params:{appId:s,tabInfo:c}}}catch(e){return}}},72994:(e,t,n)=>{n.d(t,{s:()=>r});var o=n(1026);const r=e=>Array.isArray(e)?e.map((e=>r(e))):null!=e&&e.constructor===Object?Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[(0,o.A)(n)]:r(e[n])})),{}):e},11404:(e,t,n)=>{var o,r;n.d(t,{x:()=>o,z:()=>r}),function(e){e.Automatic="automatic",e.Manual="manual"}(o||(o={})),function(e){e.Error="error",e.HeroCard="application/vnd.microsoft.card.hero",e.ThumbnailCard="application/vnd.microsoft.card.thumbnail",e.ConnectorCard="application/vnd.microsoft.teams.card.o365connector",e.AdaptiveCard="application/vnd.microsoft.card.adaptive",e.SignInCard="signincard",e.AppInstallCard="appinstallcard"}(r||(r={}))},89797:(e,t,n)=>{n.d(t,{a:()=>i});var o=n(57014),r=n(33467);class i extends o.Pv{constructor(e,t,n,o,i,a=r.RK.Standard){super(t),this.featureFlags=e,this.locale=n,this.correlationId=o,this.themeMode=i,this.hostWidth=a}}},23913:(e,t,n)=>{n.d(t,{v:()=>Ti});var o=n(89685),r=n(11120),i=n(30185),a=n(25510),s=n(31414),l=n(8520),c=n(86654),u=n(11404),d=n(52891),p=n(70512),h=n(23489),g=n(42228),f=n(74842),m=n(77909);class y extends f.rc{get url(){return this.getValue(y.url)}set url(e){this.setValue(y.url,e)}get data(){return this.getValue(y.data)}set data(e){this.setValue(y.data,e)}getJsonTypeName(){return y.JsonTypeName}getHref(){return this.url}}y.url=new m.XB(m.uq.v1_0,"url"),y.data=new m.BG(m.uq.v1_0,"data"),y.JsonTypeName="Action.SignIn";var v=n(36713);class C{constructor(e,t,n,o,r){this.cardData=e,this.appId=t,this.botId=n,this.serviceProvider=o,this.action=r}async execute(){var e,t,n,o,s,l,c,u,d;const p=new i.k(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,r.yx.CardActions,r.xe.InsertImageActionActivityRequest),h={};h[r.vP.ActionType]=r.X2.InsertImage,h[r.vP.Intent]=void 0,h[r.vP.RuntimeActivityResponseMethod]=r.mU.Execute;try{const e={id:this.action.id,cardData:this.cardData,botId:this.botId,url:null!==(t=this.action.url)&&void 0!==t?t:"",altText:null!==(n=this.action.altText)&&void 0!==n?n:"",appId:this.appId,triggeringActionTitle:this.action.title};await(null===(s=(o=this.serviceProvider.cardService).handleActionInsertImage)||void 0===s?void 0:s.call(o,e)),p.logMetricEnd({props:h,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Appid: ${(0,a.n)(null===(l=this.cardData)||void 0===l?void 0:l.titleId,null===(c=this.cardData)||void 0===c?void 0:c.appId)}`})}catch(e){p.logMetricEndWithError({props:h,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${(null==e?void 0:e.message)||e}, Appid: ${(0,a.n)(null===(u=this.cardData)||void 0===u?void 0:u.titleId,null===(d=this.cardData)||void 0===d?void 0:d.appId)}`})}return{request:this}}onCompletion(e){}}var b=n(71427),E=n(15666);class A{constructor(e,t,n,o){this.cardData=e,this.serviceProvider=t,this.signInUrl=n,this.data=o}onCompletion(e){var t,n,o;const s=new i.k(null===(t=this.serviceProvider)||void 0===t?void 0:t.telemetryService,r.yx.CardActions,r.xe.SigninActionActivityRequest),l={};if(l[r.vP.ActionType]=r.X2.SignIn,l[r.vP.Intent]=void 0,l[r.vP.RuntimeActivityResponseMethod]=r.mU.OnCompletion,!this.data)return void s.logMetricEndWithError({props:l,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Data not present, Appid: ${(0,a.n)(null===(n=this.cardData)||void 0===n?void 0:n.titleId,null===(o=this.cardData)||void 0===o?void 0:o.appId)} `});const c=new h.e,d=JSON.parse(this.data);c.id=d.id,c.verb=d.verb,c.data=d.data;const p=e.code,g=Object.assign(Object.assign({},this.cardData),{content:d.originalCard}),f=new v.q(g,this.serviceProvider,c,u.x.Manual,void 0,void 0,p);f.execute().then((e=>{var t,n;f.onCompletion(e),s.logMetricEnd({props:l,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${(0,a.n)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)}`})})).catch((e=>{var t,n;s.logMetricEndWithError({props:l,diagnosticsData:`Error: ${e.message||e}}, TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${(0,a.n)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)} `})}))}async execute(){var e,t,n,o,s,l,c,u,d,p;if(!this.signInUrl||!this.data)return{request:this};const h=new i.k(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,r.yx.CardActions,r.xe.SigninActionActivityRequest),g={};g[r.vP.ActionType]=r.X2.SignIn,g[r.vP.Intent]=void 0,g[r.vP.RuntimeActivityResponseMethod]=r.mU.Execute;if(!JSON.parse(this.data))return h.logMetricEndWithError({props:g,message:r.FG.AttributedDataNotFound,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Data not present, Appid: ${(0,a.n)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)} `}),Promise.reject(r.FG.AttributedDataNotFound);const f=this.cardData.appId,m=await this.getAppDefinition(f);if(!m)return h.logMetricEndWithError({message:r.FG.AppDefinitionIsUndefined,props:g,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId} , Error: app definition not present, Appid: ${(0,a.n)(null===(o=this.cardData)||void 0===o?void 0:o.titleId,null===(s=this.cardData)||void 0===s?void 0:s.appId)} `}),Promise.reject(r.FG.AppDefinitionIsUndefined);const y={cardData:this.cardData,appDefinition:m,signInUrl:this.signInUrl};try{const e=await(null===(l=this.serviceProvider.hostService)||void 0===l?void 0:l.handleAuth(y));return e?{code:e.code}:(h.logMetricEnd({props:g,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Appid: ${(0,a.n)(null===(c=this.cardData)||void 0===c?void 0:c.titleId,null===(u=this.cardData)||void 0===u?void 0:u.appId)}`}),{request:this})}catch(e){return h.logMetricEndWithError({props:g,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error : ${null==e?void 0:e.message}, Appid: ${(0,a.n)(null===(d=this.cardData)||void 0===d?void 0:d.titleId,null===(p=this.cardData)||void 0===p?void 0:p.appId)} `}),{request:this}}}async getAppDefinition(e){var t;try{const n=await(null===(t=this.serviceProvider.appService)||void 0===t?void 0:t.getApp({id:e}));let o=null==n?void 0:n.appDefinition;return!o&&(null==n?void 0:n.titleInfo)&&(o=(0,E.P)(n.titleInfo)),o}catch(e){return}}}var S=n(82420);class I{constructor(e,t,n){this.request=e,this.response=t,this.status=n}}class P{constructor(e,t,n,o){this.request=e,this.status=t,this.code=n,this.message=o}}class T{constructor(e,t,n,o,r){this.cardData=e,this.appId=t,this.botId=n,this.serviceProvider=o,this.action=r}async execute(){var e,t,n,o,s,l,c;const u=new i.k(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,r.yx.CardActions,r.xe.SubmitActionActivityRequest),d={};let p;d[r.vP.ActionType]=r.X2.Submit,d[r.vP.Intent]=void 0,d[r.vP.RuntimeActivityResponseMethod]=r.mU.Execute;try{const e={id:this.action.id,cardData:this.cardData,botId:this.botId,data:this.action.data,appId:this.appId,triggeringActionTitle:this.action.title},i=await this.serviceProvider.cardService.handleActionSubmit(e);i&&(p=i instanceof S.P?new I(this,i.response,i.status):new P(this,i.status,i.code,i.message)),p instanceof P?(d[r.vP.ActionErrorType]=r.Pk.BotInvokeError,u.logMetricEndWithError({props:d,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Bot Invoke failed with error code: ${p.code} and message: ${p.message}, Appid: ${(0,a.n)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)}`})):u.logMetricEnd({props:d,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Appid: ${(0,a.n)(null===(o=this.cardData)||void 0===o?void 0:o.titleId,null===(s=this.cardData)||void 0===s?void 0:s.appId)}`})}catch(e){u.logMetricEndWithError({props:d,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${(null==e?void 0:e.message)||e}, Appid: ${(0,a.n)(null===(l=this.cardData)||void 0===l?void 0:l.titleId,null===(c=this.cardData)||void 0===c?void 0:c.appId)}`})}return null!=p?p:{request:this}}onCompletion(e){}}class x{constructor(e,t,n,o){this.cardData=e,this.serviceProvider=t,this.onPrepareRuntimeActivityRequest=n,this.onRuntimeActivityResponse=o}get handleAction(){return e=>{const t=this.createRequest(e);this.triggerActivityRequest(t).catch((e=>{}))}}get handleAnchorClicked(){return(e,t)=>{const n=new b.G(this.cardData,e,this.serviceProvider);return this.triggerActivityRequest(n).catch((e=>{})),!0}}async triggerActivityRequest(e){var t,n;if(e){if(!await(null===(t=this.onPrepareRuntimeActivityRequest)||void 0===t?void 0:t.call(this,e))){const t=await e.execute();await(null===(n=this.onRuntimeActivityResponse)||void 0===n?void 0:n.call(this,t))||e.onCompletion(t)}}}createRequest(e,t){var n,o;let r,i,a;return e instanceof p.o?(i=e.getHref(),i&&(r=new b.G(this.cardData,i,this.serviceProvider,this.cardData.botId))):e instanceof h.e?r=new v.q(this.cardData,this.serviceProvider,e,null!=t?t:u.x.Manual):e instanceof y?(i=e.getHref(),a=JSON.stringify(e.data),r=new A(this.cardData,this.serviceProvider,i,a)):e instanceof g.tV?r=new T(this.cardData,this.cardData.appId,null!==(n=this.cardData.botId)&&void 0!==n?n:"",this.serviceProvider,e):e instanceof d.b&&(r=new C(this.cardData,this.cardData.appId,null!==(o=this.cardData.botId)&&void 0!==o?o:"",this.serviceProvider,e)),r}}var w,k=n(79490),_=n(33467),D=n(5594),F=n(28506),L="#107C10",O="#FFC300",R="#D13438",M="#CCCCCC",B="#c50f1f",N="#80215d",V="#3f3682",H="#2461ca",U="#0078d4",j="#00b7c3",z="#00cc6a",G="#a4cd6c",W="#f3c761",q="#333357",Q="#4f52b2",K="#5b5fc7",Y="#7f85f5",$="#9299f7",J="#aab1fa",X="#c5cbfa",Z="#dce0fa",ee="#13458f",te="#2c72a8",ne="#92b6d1",oe="#9bd9db",re="#ffe69e",ie="#f4beaa",ae="#e37d81",se="#d33f4c",le="#950c17",ce="#4b5356",ue={name:"Categorical",lightTheme:[B,N,V,H,U,j,z,G,W],darkTheme:[B,N,V,H,U,j,z,G,W]},de={name:"Sequential",lightTheme:[q,Q,K,Y,$,J,X,Z],darkTheme:[q,Q,K,Y,$,J,X,Z]},pe={name:"Diverging",lightTheme:[ee,te,ne,oe,re,ie,ae,se,le],darkTheme:[oe,ne,te,ee,ce,le,se,ae,ie]},he=["good","warning","attention","neutral","categoricalRed","categoricalPurple","categoricalLavender","categoricalBlue","categoricalLightBlue","categoricalTeal","categoricalGreen","categoricalLime","categoricalMarigold","sequential1","sequential2","sequential3","sequential4","sequential5","sequential6","sequential7","sequential8","divergingBlue","divergingLightBlue","divergingCyan","divergingTeal","divergingYellow","divergingPeach","divergingLightRed","divergingRed","divergingMaroon","divergingGray"],ge=de,fe=function(){function e(){}return e.addColorSet=function(e){this._colorSets.set(e.name.toLowerCase(),e)},e.removeColorSet=function(e){this._colorSets.delete(e.toLowerCase())},e.getColor=function(e,t,n){var o,r=e&&null!==(o=this._colorSets.get(e))&&void 0!==o?o:ge,i=t===_.V6.Dark?r.darkTheme:r.lightTheme;return i[(n>=0?n:0)%i.length]},e.getColors=function(e,t){var n,o=e&&null!==(n=this._colorSets.get(e.toLowerCase()))&&void 0!==n?n:ge;return t===_.V6.Dark?o.darkTheme:o.lightTheme},e.getWellKnownColor=function(e){return e?this._wellKnownChartColors[e]:this._wellKnownChartColors.sequential3},e._colorSets=new Map([[ue.name.toLowerCase(),ue],[de.name.toLowerCase(),de],[pe.name.toLowerCase(),pe]]),e._wellKnownChartColors={good:L,warning:O,attention:R,neutral:M,categoricalRed:B,categoricalPurple:N,categoricalLavender:V,categoricalBlue:H,categoricalLightBlue:U,categoricalTeal:j,categoricalGreen:z,categoricalLime:G,categoricalMarigold:W,sequential1:q,sequential2:Q,sequential3:K,sequential4:Y,sequential5:$,sequential6:J,sequential7:X,sequential8:Z,divergingBlue:ee,divergingLightBlue:te,divergingCyan:ne,divergingTeal:oe,divergingYellow:re,divergingPeach:ie,divergingLightRed:ae,divergingRed:se,divergingMaroon:le,divergingGray:ce},e.defaultLoadingSkeletonHeight=200,e.wideVerticalBarWidth=30,e.narrowVerticalBarWidth=20,e.verticalChartHeight=300,e.lineChartHeight=300,e.pieAndDonutChartHeight=300,e.gaugeChartHeight=150,e.donutChartInnerRadiusRatio=.3,e.fluentV9DarkTheme=D.k,e.fluentV9LightTheme=F.u,e.overrideThemeBackgroundColor=!0,e}(),me=function(){function e(){}return e.chartCannotBeDisplayed={key:"ac_chart_chartCannotBeDisplayed",defaultValue:"The chart cannot be displayed."},e}(),ye=n(49399),ve=n(69323),Ce=n(67528),be=n(73789),Ee=n(87354),Ae=n(71961),Se=function(e){var t;return l.createElement(Ee.E,(0,k.__assign)({},e),l.createElement(Ae.H,{style:{height:"".concat(null!==(t=e.height)&&void 0!==t?t:fe.defaultLoadingSkeletonHeight,"px")}}))},Ie={10:"",20:"",30:"",40:"",50:"",60:"",70:"",80:"",90:"",100:"",110:"",120:"",130:"",140:"",150:"",160:""},Pe=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return(0,k.__extends)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?l.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",gap:"10px"}},l.createElement(ye.FW,{name:"PollOff",iconSize:_.lK.Large,iconStyle:_.pO.Regular,showPlaceholder:!1,allowFallback:!1}),this.props.localizeStringFn(me.chartCannotBeDisplayed)):this.props.children},t}(l.Component),Te=function(e){var t=(0,k.__read)(l.useState(0),2)[1],n=l.useCallback((function(){t((function(e){return e+1}))}),[]);return l.useEffect((function(){return e.addResizeListener(n),function(){e.removeResizeListener(n)}}),[]),l.createElement(Pe,{localizeStringFn:e.localizeString},e.renderChartComponent())},xe=function(e){function t(t,n,o){var r=this,i=he.map((function(e){return{value:e}}));return(r=e.call(this,t,n,i)||this).targetVersion=t,r.name=n,r.defaultValue=o,r}return(0,k.__extends)(t,e),t}(m.XY),we=function(e){function t(){var t=e.apply(this,(0,k.__spreadArray)([],(0,k.__read)(arguments),!1))||this;return t._resizeListeners=new Set,t}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"colorSet",{get:function(){return this.getValue(t.colorSetProperty)},set:function(e){this.setValue(t.colorSetProperty,e)},enumerable:!1,configurable:!0}),t.getV8Theme=function(e){return e===_.V6.Dark?(t.darkV8Theme||(t.darkV8Theme=(0,be.W)(Ie,fe.fluentV9DarkTheme,!0)),t.darkV8Theme):(t.lightV8Theme||(t.lightV8Theme=(0,be.W)(Ie,fe.fluentV9LightTheme,!1)),t.lightV8Theme)},t.prototype.addResizeListener=function(e){this._resizeListeners.add(e)},t.prototype.removeResizeListener=function(e){this._resizeListeners.delete(e)},t.prototype.getResizeManager=function(){var e=this.getRootElement();return e instanceof ve.hq?e.resizeManager:void 0},t.prototype.onRef=function(e){var t=this,n=this.getResizeManager();n&&(this._chartHost&&n.unobserve(this._chartHost),this._chartHost=null!=e?e:void 0,this._chartHost&&n.observe(this._chartHost,(function(e,n){var o;0!==n.width&&n.width!==(null===(o=t._currentSize)||void 0===o?void 0:o.width)&&(t._currentSize=(0,k.__assign)({},n),t._resizeListeners.forEach((function(e){return e()})))})))},Object.defineProperty(t.prototype,"chartHeight",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHost",{get:function(){return this._chartHost},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this,n=fe.overrideThemeBackgroundColor?{backgroundColor:"unset"}:void 0;return l.createElement(l.Suspense,{fallback:l.createElement(Se,{height:this.chartHeight})},l.createElement(Ce.N,{theme:t.getV8Theme(this.theme),style:n},l.createElement("div",{ref:function(t){return e.onRef(t)},style:void 0!==this.chartHeight?{height:"".concat(this.chartHeight,"px")}:void 0},l.createElement(Te,{addResizeListener:function(t){return e.addResizeListener(t)},removeResizeListener:function(t){return e.removeResizeListener(t)},renderChartComponent:function(){return e.renderChartComponent()},localizeString:function(t,n){return e.localizeString(t,n)}}))))},Object.defineProperty(t.prototype,"currentSize",{get:function(){return this._currentSize},enumerable:!1,configurable:!0}),t.titleProperty=new m.XB(m.uq.v1_5,"title").setContentType("text"),t.colorSetProperty=new m.XB(m.uq.v1_5,"colorSet"),t}(f.hA),ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"legend",{get:function(){return this.getValue(t.legendProperty)},set:function(e){this.setValue(t.legendProperty,e)},enumerable:!1,configurable:!0}),t.legendProperty=new m.XB(m.uq.v1_5,"legend").setContentType("text"),t}(m.jB),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"DonutChartData"},t.valueProperty=new m.Uy(m.uq.v1_5,"value"),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(ke),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return fe.pieAndDonutChartHeight},enumerable:!1,configurable:!0}),t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new _e})),t}(we),Fe=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.DonutChart}}))})),Le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this,n={chartTitle:this.title,chartData:this.data.map((function(e,n){return{color:e.color?fe.getWellKnownColor(e.color):fe.getColor(t.colorSet,t.theme,n),legend:e.legend,data:e.value}}))},o=void 0;return this.currentSize&&(o=this.currentSize.height>this.currentSize.width?this.currentSize.width*fe.donutChartInnerRadiusRatio:this.currentSize.height*fe.donutChartInnerRadiusRatio),l.createElement(Fe,{data:n,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,innerRadius:o})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Donut",t}(De),Oe=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.DonutChart}}))})),Re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this,n={chartTitle:this.title,chartData:this.data.map((function(e,n){return{color:e.color?fe.getWellKnownColor(e.color):fe.getColor(t.colorSet,t.theme,n),legend:e.legend,data:e.value}}))};return l.createElement(Oe,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,data:n})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Pie",t}(De),Me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"BarChartDataValue"},t.xProperty=new m.XB(m.uq.v1_5,"x").setContentType("text"),t.yProperty=new m.Uy(m.uq.v1_5,"y"),t}(m.jB),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"xAxisTitle",{get:function(){return this.getValue(t.xAxisTitleProperty)},set:function(e){this.setValue(t.xAxisTitleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"yAxisTitle",{get:function(){return this.getValue(t.yAxisTitleProperty)},set:function(e){this.setValue(t.yAxisTitleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.xAxisTitleProperty=new m.XB(m.uq.v1_5,"xAxisTitle").setContentType("text"),t.yAxisTitleProperty=new m.XB(m.uq.v1_5,"yAxisTitle").setContentType("text"),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(we),Ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"values",{get:function(){return this.getValue(t.valuesProperty)},set:function(e){this.setValue(t.valuesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"GroupedVerticalBarChartData"},t.valuesProperty=new m.m2(m.uq.v1_5,"values",(function(e){return new Me})),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(ke),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"stacked",{get:function(){return this.getValue(t.stackedProperty)},set:function(e){this.setValue(t.stackedProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showBarValues",{get:function(){return this.getValue(t.showBarValuesProperty)},set:function(e){this.setValue(t.showBarValuesProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,_.iV.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,_.iV.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.stackedProperty=new m.gV(m.uq.v1_5,"stacked",!1),t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new Ne})),t.showBarValuesProperty=new m.gV(m.uq.v1_5,"showBarValues",!1),t}(Be),He=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.GroupedVerticalBarChart}}))})),Ue=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.VerticalStackedBarChart}}))})),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderGroupedVerticalBarChart=function(){var e,t=this,n=[];return this.data.forEach((function(e,o){e.values.forEach((function(r){var i=n.find((function(e){return e.name===r.x})),a={key:e.legend,data:r.y,color:e.color?fe.getWellKnownColor(e.color):fe.getColor(t.colorSet,t.theme,o),legend:e.legend,xAxisCalloutData:r.x};i?i.series.push(a):n.push({name:r.x,series:[a]})}))})),l.createElement(He,{chartTitle:this.title,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,data:n,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLabels:!0,showXAxisLablesTooltip:!1,barwidth:fe.wideVerticalBarWidth,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.renderStackedVerticalBarChart=function(){var e,t=this,n=[];return this.data.forEach((function(e,o){e.values.forEach((function(r){var i=n.find((function(e){return e.xAxisPoint===r.x})),a={data:r.y,color:e.color?fe.getWellKnownColor(e.color):fe.getColor(t.colorSet,t.theme,o),legend:e.legend,xAxisCalloutData:r.x};i?i.chartData.push(a):n.push({xAxisPoint:r.x,chartData:[a]})}))})),l.createElement(Ue,{chartTitle:this.title,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,data:n,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLabels:!this.showBarValues,isCalloutForStack:!0,showXAxisLablesTooltip:!1,barWidth:fe.wideVerticalBarWidth,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.renderChartComponent=function(){return this.stacked?this.renderStackedVerticalBarChart():this.renderGroupedVerticalBarChart()},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.VerticalBar.Grouped",t}(Ve),ze=function(e){function t(t,n,o){return e.call(this,t,n,o)||this}return(0,k.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name];return"string"==typeof o||"number"==typeof o?o:this.defaultValue},t.prototype.serialize=function(e,t,n,o){"string"==typeof n?o.serializeString(t,this.name,n):"number"==typeof n&&o.serializeNumber(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"},{type:"number"}],isArray:!1}},t}(m.BG),Ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"VerticalBarChartDataValue"},t.xProperty=new ze(m.uq.v1_5,"x",0).setContentType("text"),t.yProperty=new m.Uy(m.uq.v1_5,"y"),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(m.jB),We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showBarValues",{get:function(){return this.getValue(t.showBarValuesProperty)},set:function(e){this.setValue(t.showBarValuesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return fe.verticalChartHeight},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,_.iV.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,_.iV.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new Ge})),t.colorProperty=new xe(m.uq.v1_5,"color"),t.showBarValuesProperty=new m.gV(m.uq.v1_5,"showBarValues",!1),t}(Be),qe=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.VerticalBarChart}}))})),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this;if(0===this.data.length)return null;var n=this.data.map((function(e,n){var o;return{x:e.x,y:e.y,color:t.colorSet?fe.getColor(t.colorSet,t.theme,n):fe.getWellKnownColor(null!==(o=e.color)&&void 0!==o?o:t.color)}}));return l.createElement(qe,{chartTitle:this.title,data:n,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,showXAxisLablesTooltip:!1,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLegend:!0,hideLabels:!this.showBarValues,barWidth:fe.wideVerticalBarWidth,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.VerticalBar",t}(We),Ke=n(95312),Ye=n(84998);!function(e){e[e.AbsoluteWithAxis=0]="AbsoluteWithAxis",e[e.AbsoluteNoAxis=1]="AbsoluteNoAxis",e[e.PartToWhole=2]="PartToWhole"}(w||(w={}));var $e,Je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"HorizontalBarChartDataValue"},t.xProperty=new m.XB(m.uq.v1_5,"x").setContentType("text"),t.yProperty=new m.Uy(m.uq.v1_5,"y"),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(m.jB),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayMode",{get:function(){return this.getValue(t.displayModeProperty)},set:function(e){this.setValue(t.displayModeProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,_.iV.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,_.iV.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new Je})),t.displayModeProperty=new m.fX(m.uq.v1_5,"displayMode",w,w.AbsoluteWithAxis),t}(Be),Ze=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.HorizontalBarChart}}))})),et=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.HorizontalBarChartWithAxis}}))})),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderHorizontalBarChart=function(){var e,t=this,n=this.data.reduce((function(e,t){return e+t.y}),0),o=Math.max.apply(Math,(0,k.__spreadArray)([],(0,k.__read)(this.data.map((function(e){return e.y}))),!1)),r=this.data.map((function(e,r){var i;return{chartTitle:e.x,chartData:[{legend:e.x,horizontalBarChartdata:{x:e.y,y:t.displayMode===w.PartToWhole?n:o},color:t.colorSet?fe.getColor(t.colorSet,t.theme,r):fe.getWellKnownColor(null!==(i=e.color)&&void 0!==i?i:t.color),yAxisCalloutData:t.displayMode===w.PartToWhole?"".concat(e.y," (").concat((e.y/n*100).toFixed(0),"%)"):void 0}]}}));return l.createElement(Ze,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,data:r,chartDataMode:"default",variant:this.displayMode===w.PartToWhole?Ye.r.PartToWhole:Ye.r.AbsoluteScale})},t.prototype.renderHorizontalBarChartWithAxis=function(){var e,t=this,n=this.data.map((function(e,n){var o;return{color:t.colorSet?fe.getColor(t.colorSet,t.theme,n):fe.getWellKnownColor(null!==(o=e.color)&&void 0!==o?o:t.color),x:e.y,y:e.x}})),o=(0,Ke.bK)(this.hostWidth,_.RK.Standard)>=0;return l.createElement(et,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,data:n,showYAxisLablesTooltip:!o,showYAxisLables:o,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,hideLegend:!0,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.renderChartComponent=function(){return this.displayMode===w.AbsoluteWithAxis?this.renderHorizontalBarChartWithAxis():this.renderHorizontalBarChart()},t.prototype.isResponsive=function(){return!0},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.HorizontalBar",t}(Xe),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0===this.data.length&&t.addFailure(this,_.iV.InvalidPropertyValue,"No data sets provided."),this.data.length>4&&t.addFailure(this,_.iV.InvalidPropertyValue,"Invalid number of data sets. Maximum of 4 data sets allowed.")},t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new ot})),t}(Be),ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"StackedHorizontalBarChartData"},t.titleProperty=new m.XB(m.uq.v1_5,"title").setContentType("text"),t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new rt})),t}(m.jB),rt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"legend",{get:function(){return this.getValue(t.legendProperty)},set:function(e){this.setValue(t.legendProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"StackedHorizontalBarChartDataPoint"},t.legendProperty=new m.XB(m.uq.v1_5,"legend").setContentType("text"),t.valueProperty=new m.Uy(m.uq.v1_5,"value"),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(m.jB),it=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.MultiStackedBarChart}}))})),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderChartComponent=function(){var e=this,t=[];return this.data.forEach((function(n){var o=n.data.map((function(t,n){return{data:t.value,color:t.color?fe.getWellKnownColor(t.color):fe.getColor(e.colorSet,e.theme,n),legend:t.legend}}));t.push({chartTitle:n.title,chartData:o})})),l.createElement(it,{data:t})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.HorizontalBar.Stacked",t}(nt),st=n(11512),lt=function(e){function t(t,n,o){return e.call(this,t,n,o)||this}return(0,k.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name];if("string"==typeof o){var r=(0,st._U)(o);if(r)return r}else if("number"==typeof o)return o;return this.defaultValue},t.prototype.toJSON=function(e,t,n,o){n instanceof Date?o.serializeDate(t,this.name,n):"number"==typeof n&&o.serializeNumber(t,this.name,n)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"number"},{type:"string"}],isArray:!1}},t}(m.BG),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this.getValue(t.xProperty)},set:function(e){this.setValue(t.xProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.getValue(t.yProperty)},set:function(e){this.setValue(t.yProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"LineChartValue"},t.xProperty=new lt(m.uq.v1_5,"x",0),t.yProperty=new m.Uy(m.uq.v1_5,"y"),t}(m.jB),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"values",{get:function(){return this.getValue(t.valuesProperty)},set:function(e){this.setValue(t.valuesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"LineChartData"},t.valuesProperty=new m.m2(m.uq.v1_5,"values",(function(e){return new ct})),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(ke),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.getValue(t.dataProperty)},set:function(e){this.setValue(t.dataProperty,e)},enumerable:!1,configurable:!0}),t.dataProperty=new m.m2(m.uq.v1_5,"data",(function(e){return new ut})),t}(Be),pt=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.LineChart}}))})),ht=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return fe.lineChartHeight},enumerable:!1,configurable:!0}),t.prototype.renderChartComponent=function(){var e,t=this;if(0===this.data.length||0===this.data[0].values.length)return null;var n=this.data.map((function(e,n){return{legend:e.legend,data:e.values.map((function(e){return{x:e.x,y:e.y}})),color:e.color?fe.getWellKnownColor(e.color):fe.getColor(t.colorSet,t.theme,n)}})),o={chartTitle:this.title,lineChartData:n};return l.createElement(pt,{data:o,height:this.chartHeight,width:null===(e=this.currentSize)||void 0===e?void 0:e.width,xAxisTitle:this.xAxisTitle,yAxisTitle:this.yAxisTitle,enableReflow:!1,styles:{chartWrapper:{overflow:"hidden"}}})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Line",t}(dt);!function(e){e[e.Percentage=0]="Percentage",e[e.Fraction=1]="Fraction"}($e||($e={}));var gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"legend",{get:function(){return this.getValue(t.legendProperty)},set:function(e){this.setValue(t.legendProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"GaugeChartLegend"},t.sizeProperty=new m.Uy(m.uq.v1_5,"size",0),t.legendProperty=new m.XB(m.uq.v1_5,"legend").setContentType("text"),t.colorProperty=new xe(m.uq.v1_5,"color"),t}(m.jB),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subLabel",{get:function(){return this.getValue(t.subLabelProperty)},set:function(e){this.setValue(t.subLabelProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showMinMax",{get:function(){return this.getValue(t.showMinMaxProperty)},set:function(e){this.setValue(t.showMinMaxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showLegend",{get:function(){return this.getValue(t.showLegendProperty)},set:function(e){this.setValue(t.showLegendProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"segments",{get:function(){return this.getValue(t.segmentsProperty)},set:function(e){this.setValue(t.segmentsProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueFormat",{get:function(){return this.getValue(t.valueFormatProperty)},set:function(e){this.setValue(t.valueFormatProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartHeight",{get:function(){return fe.gaugeChartHeight+(this.showLegend?20:0)+(this.title?20:0)},enumerable:!1,configurable:!0}),t.minProperty=new m.Uy(m.uq.v1_5,"min",0),t.maxProperty=new m.Uy(m.uq.v1_5,"max"),t.subLabelProperty=new m.XB(m.uq.v1_5,"subLabel").setContentType("text"),t.showMinMaxProperty=new m.gV(m.uq.v1_5,"showMinMax",!0),t.showLegendProperty=new m.gV(m.uq.v1_5,"showLegend",!0),t.segmentsProperty=new m.m2(m.uq.v1_5,"segments",(function(e){return new gt})),t.valueProperty=new m.Uy(m.uq.v1_5,"value",0),t.valueFormatProperty=new m.fX(m.uq.v1_5,"valueFormat",$e,$e.Percentage),t}(we),mt=l.lazy((function(){return n.e("vendors~shared").then(n.bind(n,33359)).then((function(e){return{default:e.GaugeChart}}))})),yt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.renderChartComponent=function(){var e,t=this,n=this.segments.map((function(e,n){var o;return{legend:null!==(o=e.legend)&&void 0!==o?o:"",size:e.size,color:t.colorSet?fe.getColor(t.colorSet,t.theme,n):fe.getWellKnownColor(e.color)}}));return l.createElement(mt,{width:null===(e=this.currentSize)||void 0===e?void 0:e.width,height:this.chartHeight,segments:n,chartTitle:this.title,sublabel:this.subLabel,chartValueFormat:this.valueFormat===$e.Percentage?"percentage":"fraction",chartValue:this.value,hideMinMax:!this.showMinMax,hideLegend:!this.showLegend,minValue:this.min,maxValue:this.max})},t.prototype.getJsonTypeName=function(){return t.jsonTypeName},t.jsonTypeName="Chart.Gauge",t}(ft);function vt(e,t){e.register(Le.jsonTypeName,(function(){return new Le})),e.register(Re.jsonTypeName,(function(){return new Re})),e.register(je.jsonTypeName,(function(){return new je})),e.register(Qe.jsonTypeName,(function(){return new Qe})),e.register(tt.jsonTypeName,(function(){return new tt})),e.register(at.jsonTypeName,(function(){return new at})),e.register(ht.jsonTypeName,(function(){return new ht})),e.register(yt.jsonTypeName,(function(){return new yt}))}var Ct,bt=n(8235),Et=n(20447),At=n(23522),St=n(73563),It=n(41883),Pt=n(17255),Tt=n(71173),xt=n(62112),wt=n(91038),kt=n(68311),_t=n(48482),Dt=n(14079),Ft=n(74870),Lt=n(63472),Ot=n(37401),Rt=n(75582),Mt=n(40853),Bt=n(76957),Nt=n(35586),Vt=n(19034),Ht=n(10047),Ut=n(81497),jt=n(78848),zt=n(48730),Gt=n(68691);!function(e){e[e.Bash=0]="Bash",e[e.C=1]="C",e[e.Cpp=2]="Cpp",e[e.CSharp=3]="CSharp",e[e.Css=4]="Css",e[e.Dos=5]="Dos",e[e.Go=6]="Go",e[e.Graphql=7]="Graphql",e[e.Html=8]="Html",e[e.Java=9]="Java",e[e.JavaScript=10]="JavaScript",e[e.Json=11]="Json",e[e.ObjectiveC=12]="ObjectiveC",e[e.Perl=13]="Perl",e[e.Php=14]="Php",e[e.PlainText=15]="PlainText",e[e.PowerShell=16]="PowerShell",e[e.Python=17]="Python",e[e.Sql=18]="Sql",e[e.TypeScript=19]="TypeScript",e[e.VbNet=20]="VbNet",e[e.Verilog=21]="Verilog",e[e.Vhdl=22]="Vhdl",e[e.Xml=23]="Xml"}(Ct||(Ct={}));var Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"codeSnippet",{get:function(){return this.getValue(t.codeSnippetProperty)},set:function(e){this.setValue(t.codeSnippetProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){var e;return null!==(e=this.getValue(t.languageProperty))&&void 0!==e?e:Ct.PlainText},set:function(e){this.setValue(t.languageProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startLineNumber",{get:function(){return this.getValue(t.startLineNumberProperty)},set:function(e){this.setValue(t.startLineNumberProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"CodeBlock"},t.codeSnippetProperty=new m.XB(m.uq.v1_5,"codeSnippet").setContentType("text"),t.languageProperty=new m.fX(m.uq.v1_5,"language",Ct,Ct.PlainText),t.startLineNumberProperty=new m.Uy(m.uq.v1_5,"startLineNumber",1),t}(f.hA),qt=function(){function e(){}return e.applyHighlighting=function(t,n){var o,r;return e.initializeHighlighter(),null!==(r=null===(o=e._highlighter)||void 0===o?void 0:o.highlight(t,{language:n}).value)&&void 0!==r?r:t},e.dispose=function(){e._highlighter=null},e.initializeHighlighter=function(){e._highlighter||(e._highlighter=Et.A,e._highlighter.registerLanguage(Qt(Ct.Bash),At.A),e._highlighter.registerLanguage(Qt(Ct.C),St.A),e._highlighter.registerLanguage(Qt(Ct.Cpp),It.A),e._highlighter.registerLanguage(Qt(Ct.CSharp),Pt.A),e._highlighter.registerLanguage(Qt(Ct.Css),Tt.A),e._highlighter.registerLanguage(Qt(Ct.Dos),xt.A),e._highlighter.registerLanguage(Qt(Ct.Go),wt.A),e._highlighter.registerLanguage(Qt(Ct.Graphql),kt.A),e._highlighter.registerLanguage(Qt(Ct.Java),_t.A),e._highlighter.registerLanguage(Qt(Ct.JavaScript),Dt.A),e._highlighter.registerLanguage(Qt(Ct.Json),Ft.A),e._highlighter.registerLanguage(Qt(Ct.ObjectiveC),Lt.A),e._highlighter.registerLanguage(Qt(Ct.Perl),Ot.A),e._highlighter.registerLanguage(Qt(Ct.Php),Rt.A),e._highlighter.registerLanguage(Qt(Ct.PlainText),Mt.A),e._highlighter.registerLanguage(Qt(Ct.PowerShell),Bt.A),e._highlighter.registerLanguage(Qt(Ct.Python),Nt.A),e._highlighter.registerLanguage(Qt(Ct.Sql),Vt.A),e._highlighter.registerLanguage(Qt(Ct.TypeScript),Ht.A),e._highlighter.registerLanguage(Qt(Ct.VbNet),Ut.A),e._highlighter.registerLanguage(Qt(Ct.Verilog),jt.A),e._highlighter.registerLanguage(Qt(Ct.Vhdl),zt.A),e._highlighter.registerLanguage(Qt(Ct.Xml),Gt.A))},e}();function Qt(e){var t=Ct[e].toLowerCase();return"html"===t&&(t="xml"),t}var Kt=n(98226),Yt="span",$t="language-",Jt="\n",Xt=function(){function e(){}return e.collapseStateAriaLabel={key:"ac_codeBlock_collapseStateAriaLabel",defaultValue:"Collapse"},e.expandStateAriaLabel={key:"ac_codeBlock_expandStateAriaLabel",defaultValue:"Expand ({{totalLines}} lines)"},e}();function Zt(e){return e.nodeType===Node.ELEMENT_NODE&&e.tagName.toLowerCase()===Yt}function en(e,t){return void 0===t&&(t=1),e.split(Jt).map((function(e,n){return'<div class="code-div"><div class="code-line-number">'.concat(n+t,'</div><code class="ac-cb code-line">').concat(e,"</code></div>")})).join("")}var tn,nn=function(){function e(){}return e.prototype.format=function(e){var t=this;return e.flatMap((function(e){return t._processNode(e)}))},e.prototype._processNode=function(e){return Zt(e)?this._handleSpanElement(e):[e]},e.prototype._handleSpanElement=function(e){var t=e.className.split(" ");if(t.some((function(e){return e.startsWith($t)}))){var n=t.filter((function(e){return!e.startsWith($t)}));return n.length>0?(e.className=n.join(" "),[e]):Array.from(e.childNodes)}return[e]},e}(),on=function(){function e(){}return e.prototype.format=function(e){var t=this;return e.flatMap((function(e){return t._processNode(e)}))},e.prototype._processNode=function(e){return Zt(e)?this._handleSpanElement(e):[e]},e.prototype._handleSpanElement=function(e){var t=this;return Array.from(e.childNodes).flatMap((function(n){return t._processChildNode(n,e.className)}))},e.prototype._processChildNode=function(e,t){return e.nodeType===Node.TEXT_NODE?this._handleTextNode(e,t):e.nodeType===Node.ELEMENT_NODE?this._handleElementNode(e,t):[e]},e.prototype._handleTextNode=function(e,t){var n,o=this,r=(null===(n=e.textContent)||void 0===n?void 0:n.split(Jt))||[];return r.map((function(e,n){return o._createSpan(e,t,n<r.length-1)}))},e.prototype._handleElementNode=function(e,t){return e.tagName.toLowerCase()===Yt?(e.className="".concat(t).concat(" ").concat(e.className),this._handleSpanElement(e)):[e]},e.prototype._createSpan=function(e,t,n){var o=document.createElement(Yt);return o.className=t,o.textContent=n?"".concat(e).concat(Jt):e,o},e}(),rn=function(){function e(){this.formatterList=[new nn,new on]}return e.prototype.format=function(e){var t=(0,bt.sanitize)(e,{RETURN_DOM:!0});return this._getFormattedHtmlOutput(t)},e.prototype._getFormattedHtmlOutput=function(e){return this._applyFormatters(e).map((function(e){return e instanceof HTMLElement?e.outerHTML:e.nodeValue})).join("")},e.prototype._applyFormatters=function(e){return this.formatterList.reduce((function(e,t){return t.format(e)}),Array.from(e.childNodes))},e}(),an={backgroundColor:"#ffffff",borderColor:"#242424",textColor:"#242424",syntaxColor:{default:"#4f52b2",string:"#107c10",keyword:"#5b5fc7",function:"#bc2f32",comment:"#707070"}},sn=function(){function e(e){this.default=an.syntaxColor.default,e&&(this.default=e.default,this.string=e.string,this.keyword=e.keyword,this.function=e.function,this.comment=e.comment)}return e.prototype.toJSON=function(){return{default:this.default,string:this.string,keyword:this.keyword,function:this.function,comment:this.comment}},e}(),ln=function(){function e(e){this.textColor=an.textColor,this.syntaxColor=new sn,e&&(this.backgroundColor=e.backgroundColor,this.borderColor=e.borderColor,this.textColor=e.textColor,this.syntaxColor=new sn(e.syntaxColor))}return e.prototype.toJSON=function(){return{backgroundColor:this.backgroundColor,borderColor:this.borderColor,textColor:this.textColor,syntaxColor:this.syntaxColor.toJSON()}},e}(),cn={backgroundColor:"#ffffff",borderColor:"#242424",textColor:"#242424",syntaxColor:{default:"#4f52b2",string:"#107c10",keyword:"#5b5fc7",function:"#bc2f32",comment:"#707070"}},un={backgroundColor:"#292929",borderColor:"#242424",textColor:"#fafafa",syntaxColor:{default:"#7579eb",string:"#107c10",keyword:"#7f85f5",function:"#e37d80",comment:"#999999"}},dn=function(){function e(){}return Object.defineProperty(e,"colorSettings",{get:function(){return this._colorSettings.toJSON()},set:function(e){this._colorSettings=new ln(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"lightThemeColorSettings",{get:function(){return this._lightThemeColorSettings?this._lightThemeColorSettings.toJSON():cn},set:function(e){this._lightThemeColorSettings=e?new ln(e):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"darkThemeColorSettings",{get:function(){return this._darkThemeColorSettings?this._darkThemeColorSettings.toJSON():un},set:function(e){this._darkThemeColorSettings=e?new ln(e):void 0},enumerable:!1,configurable:!0}),e._colorSettings=new ln(an),e}();!function(e){e.Invisible="INVISIBLE",e.Expanded="EXPANDED",e.Collapsed="COLLAPSED"}(tn||(tn={}));var pn=l.memo((function(e){var t,n,o=Qt(e.language),r=en((t=e.codeSnippet,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},t.replace(/[&<>"']/g,(function(e){return n[e]}))),e.startIndex),i=(0,k.__read)(l.useState(r),2),a=i[0],s=i[1];return l.useEffect((function(){var t=qt.applyHighlighting(e.codeSnippet,o),n=(new rn).format(t);return s(en(n,e.startIndex)),function(){qt.dispose()}}),[e,o]),l.createElement("pre",{className:"ac-cb",style:{margin:0}},l.createElement("code",{className:"ac-cb hljs ".concat($t).concat(o),dangerouslySetInnerHTML:{__html:(0,bt.sanitize)(a,{RETURN_TRUSTED_TYPE:!0})}}))}));pn.displayName="HighlightCodeBlock";var hn=l.memo((function(e){var t,n=function(e){var t=0;return e.split(Jt).map((function(e){return t++})),t}(e.codeSnippet),o=n<=10?tn.Invisible:tn.Collapsed,r=(0,k.__read)(l.useState(o),2),i=r[0],a=r[1],s=function(){a(i===tn.Collapsed?tn.Expanded:tn.Collapsed)},c=i===tn.Invisible?n:i===tn.Collapsed?10:20,u=function(e,t,n){return(0,Kt.Zq)({"pre code.hljs":{display:"block",padding:"8px",overflowX:"auto",overflowY:"".concat(20===n&&t>n?"scroll":"hidden"),maxHeight:"".concat(20*Math.min(t,n)+12,"px"),"::-webkit-scrollbar":{display:"none"},":hover::-webkit-scrollbar":{display:"block"}},".code-div":{display:"flex",flexDirection:"row"},".code-line":{overflowWrap:"normal"},".code-line-number":{display:"inline-block",textAlign:"left",marginRight:"20px"},".displayState":{cursor:"pointer",fontSize:"12px",marginTop:"8px",color:e.syntaxColor.keyword}},{".hljs":{background:e.backgroundColor,border:"1px solid ".concat(e.borderColor),color:e.textColor,borderRadius:"4px"},".hljs-default":{color:e.syntaxColor.default},".hljs-string, .hljs-number, .hljs-symbol, .hljs-link":{color:e.syntaxColor.string},".hljs-title:not(.class_, .function_), .hljs-keyword, .hljs-meta, .hljs-name, .hljs-type":{color:e.syntaxColor.keyword},".hljs-function, .hljs-title.class_, .hljs-title.function_, .hljs-built_in, .hljs-attr, .hljs-attribute":{color:e.syntaxColor.function},".hljs-comment, .hljs-quote, .hljs-doctag":{color:e.syntaxColor.comment},".hljs-emphasis":{fontStyle:"italic"},".hljs-strong":{fontWeight:"bold"}})}(null!==(t=e.themeName===_.V6.Light?dn.lightThemeColorSettings:dn.darkThemeColorSettings)&&void 0!==t?t:dn.colorSettings,n,c);return l.createElement("div",{className:"ac-codeBlock ".concat(u)},l.createElement(pn,(0,k.__assign)({},e)),i!==tn.Invisible&&l.createElement("span",{onClick:s,onKeyDown:function(e){return"Enter"===e.key&&s()},className:"displayState",role:"button",tabIndex:0},i===tn.Collapsed?e.localizeStringFn(Xt.expandStateAriaLabel,{totalLines:n}):e.localizeStringFn(Xt.collapseStateAriaLabel)))}));hn.displayName="CodeBlockElement";var gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.internalRender=function(){var e=this,t=this,n=t.codeSnippet,o=t.language,r=t.startLineNumber;return n?l.createElement(hn,{codeSnippet:n,language:o,startIndex:r,localizeStringFn:function(t,n){return e.localizeString(t,n)},themeName:this.theme}):this.isDesignMode()?this.createPlaceholderElement():null},t.jsonTypeName="CodeBlock",t}(Wt);function fn(e,t){e.register("CodeBlock",(function(){return new gn}))}var mn=n(30112),yn=n(21137),vn=n(89270),Cn=n(30921),bn=n(19800),En=n(96895),An=n(19399),Sn=n(19385),In=n(94794),Pn=n(62653),Tn=n(16895),xn=n(658);class wn{}wn.basicInputAppearance="outline",wn.comboboxAppearance="outline",wn.textareaAppearance="outline",wn.numberInputAppearance="outline",wn.timeInputAppearance="outline",wn.shouldUseInlinePopup=!1,wn.destructiveActionButton=Object.assign(Object.assign({backgroundColor:Pn.L.colorStatusDangerBackground3,color:Pn.L.colorNeutralForegroundOnBrand},Tn.Pt.borderColor(Pn.L.colorStatusDangerBackground3)),{"&:hover":Object.assign({backgroundColor:Pn.L.colorStatusDangerBackground3Hover,color:Pn.L.colorNeutralForegroundOnBrand},Tn.Pt.borderColor(Pn.L.colorStatusDangerBackground3Hover)),"&:focus:active":Object.assign({backgroundColor:Pn.L.colorStatusDangerBackground3Pressed,color:Pn.L.colorNeutralForegroundOnBrand},Tn.Pt.borderColor(Pn.L.colorStatusDangerBackground3Pressed))});const kn={width:"100%",minWidth:"0"},_n={overflow:"hidden"},Dn={textInput:Object.assign(Object.assign({},kn),wn.textInput),multilineTextInput:Object.assign(Object.assign(Object.assign({},kn),{minHeight:"90px"}),wn.multilineTextInput),multilineTextInputTextArea:Object.assign(Object.assign({},kn),{maxHeight:"unset"}),passwordInputHideRevealButton:{"::-ms-reveal":{display:"none"}},dateInput:Object.assign(Object.assign(Object.assign({},kn),wn.dateInput),{"& + .fui-DatePicker__popupSurface":{zIndex:1,"& td.fui-CalendarDayGrid__dayCell":{paddingLeft:"0",paddingRight:"0"},"& th.fui-CalendarDayGrid__dayCell":{paddingLeft:"0",paddingRight:"0"}}}),numberInput:Object.assign(Object.assign({},kn),wn.numberInput),timeInput:Object.assign(Object.assign({},kn),wn.timeInput),toggleInput:Object.assign(Object.assign({},kn),wn.toggleInput),toggleInputLabelNoWrap:Object.assign(Object.assign({},_n),{whiteSpace:"nowrap",textOverflow:"ellipsis"}),toggleInputLabelWrap:Object.assign({},_n),compactChoiceSetInput:Object.assign(Object.assign({},kn),wn.compactChoiceSetInput),actionButton:Object.assign({minWidth:"0"},wn.actionButton),destructiveActionButton:Object.assign({},wn.destructiveActionButton),splitActionButtonDestructive:{borderRightColor:Pn.L.colorNeutralBackground1,"&:hover":{borderRightColor:Pn.L.colorNeutralBackground1},"&:focus:active":{borderRightColor:Pn.L.colorNeutralBackground1}},splitMenuButton:{alignItems:"unset"},inlineActionButton:Object.assign({minWidth:"0",flexShrink:0,flexGrow:0,flexBasis:"auto"},wn.actionButton)},Fn=(0,xn.n)(Dn);class Ln extends f.On{constructor(){super(...arguments),this._domElement=null}render(e,t){let n;switch(this.action.style){case _.s9.Positive:n=_.s9.Positive;break;case _.s9.Destructive:n=_.s9.Destructive;break;default:n=this.action.isExpanded||this.action.isInSubCard||t.forcePrimary?_.s9.Positive:_.s9.Default}return l.createElement(On,Object.assign({buttonProps:e},t,{style:n,isInline:t.isInline,onRef:e=>{var t;const n=this._domElement;this._domElement=e,this.onDomElementChanged&&this.onDomElementChanged(null!=n?n:void 0,null!==(t=this._domElement)&&void 0!==t?t:void 0)},menuItems:this.menuItems,isExpanded:this.action.isExpandable?this.action.isExpanded:void 0,onPopupMenuOpenedOrClosed:e=>{const t=this.action.parent;t&&(e?t.popoverOpened():t.popoverClosed())}}))}get domElement(){return this._domElement}}const On=l.forwardRef(((e,t)=>{const n=Fn(),o=e.isInline?n.inlineActionButton:n.actionButton,r=e.style!==_.s9.Destructive||e.buttonProps.disabled?o:(0,mn.z)(o,n.destructiveActionButton);if(!e.menuItems||0===e.menuItems.length)return l.createElement("div",{ref:t},l.createElement(yn.$,Object.assign({},e.buttonProps,{className:r,ref:e.onRef,appearance:e.style===_.s9.Positive?"primary":void 0,onClick:e.onClick,"aria-expanded":e.isExpanded}),e.renderedContent));return l.createElement(En.W,Object.assign({},e.buttonProps.isSplitButton?{}:{onOpenChange:(t,n)=>{e.onPopupMenuOpenedOrClosed(n.open)}}),l.createElement(An.c,{disableButtonEnhancement:!0},e.buttonProps.isSplitButton?(()=>{const t=(0,mn.z)(r,e.style===_.s9.Destructive?n.splitActionButtonDestructive:void 0),o=Object.assign(Object.assign({},e.buttonProps),{className:t,onClick:e.onClick}),i=(0,mn.z)(r,n.splitMenuButton),a=Object.assign(Object.assign({},e.buttonProps),{className:i});return l.createElement(bn.f,Object.assign({},e.buttonProps,{ref:e.onRef,appearance:e.style===_.s9.Positive?"primary":void 0,primaryActionButton:o,menuButton:a}),e.renderedContent)})():l.createElement(Cn.I,Object.assign({},e.buttonProps,{className:n.actionButton,ref:e.onRef,appearance:e.style===_.s9.Positive?"primary":void 0,menuIcon:e.renderedContent}))),l.createElement(Sn.b,null,l.createElement(In.c,null,null===(i=e.menuItems)||void 0===i?void 0:i.map((e=>{var t;return l.createElement(vn.D,{key:e.key,disabled:e.disabled,title:e.tooltip,onClick:()=>{e.onClick&&e.onClick()}},null!==(t=e.renderedContent)&&void 0!==t?t:e.text)})))));var i}));On.displayName="ActionButtonComponent";var Rn,Mn=function(e){function t(t,n,o){void 0===o&&(o=[]);var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r.forbiddenElementTypes=o,r}return(0,k.__extends)(t,e),t.prototype.parse=function(e,t,n){for(var o=e;o&&!(o instanceof f.hA);)o=o.parent;if(o)return n.parseElement(o,t[this.name],this.forbiddenElementTypes,!0)},t.prototype.toJSON=function(e,t,n,o){o.serializeValue(t,this.name,n?n.toJSON(o):void 0,void 0,!0)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"object",validValues:e.elementRegistry.getDescriptors(e,this.forbiddenElementTypes).sort((function(e,t){return e.name.localeCompare(t.name)}))}],isArray:!1}},t}(m.BG),Bn=n(18603),Nn=n(38879),Vn=n(58325);!function(e){e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Before=2]="Before",e[e.After=3]="After"}(Rn||(Rn={}));const Hn={[Rn.Above]:"above",[Rn.Below]:"below",[Rn.Before]:"before",[Rn.After]:"after"};class Un extends f.rc{populateSchema(e){super.populateSchema(e),e.remove(f.rc.menuActionsProperty)}get content(){return this.getValue(Un.contentProperty)}set content(e){this.setValue(Un.contentProperty,e)}get displayArrow(){return this.getValue(Un.displayArrowProperty)}set displayArrow(e){this.setValue(Un.displayArrowProperty,e)}get position(){return this.getValue(Un.positionProperty)}set position(e){this.setValue(Un.positionProperty,e)}get maxPopoverWidth(){return this.getValue(Un.maxPopoverWidthProperty)}set maxPopoverWidth(e){this.setValue(Un.maxPopoverWidthProperty,e)}getJsonTypeName(){return Un.JsonTypeName}wrapElement(e){var t,n;if(this.content){this.content.separator=!1,this.content.spacing=_.Kz.None;const o=(e,t)=>{var n,o;t.open?null===(n=this.parent)||void 0===n||n.popoverOpened():null===(o=this.parent)||void 0===o||o.popoverClosed()},r=this.maxPopoverWidth&&this.maxPopoverWidth>0?this.maxPopoverWidth:null===(n=null===(t=this.getRootObject())||void 0===t?void 0:t.getSize())||void 0===n?void 0:n.width;return l.createElement(Bn.A,{withArrow:this.displayArrow,trapFocus:!0,positioning:Hn[this.position],onOpenChange:o,size:"medium"},l.createElement(Nn.W,{disableButtonEnhancement:!0},e),l.createElement(Vn.H,{tabIndex:-1,style:{maxWidth:r}},l.createElement(this.content.Render,null)))}return e}get applicationMode(){return"wrap"}hasResponsiveElements(){return!0}}Un.contentProperty=new Mn(m.uq.v1_5,"content"),Un.displayArrowProperty=new m.gV(m.uq.v1_5,"displayArrow",!0),Un.positionProperty=new m.fX(m.uq.v1_5,"position",Rn,Rn.Above),Un.maxPopoverWidthProperty=new m.l5(m.uq.v1_5,"maxPopoverWidth"),Un.JsonTypeName="Action.Popover";var jn,zn,Gn,Wn,qn,Qn=n(68779);!function(e){e[e.Filled=0]="Filled",e[e.Tint=1]="Tint"}(jn||(jn={})),function(e){e[e.Before=0]="Before",e[e.After=1]="After"}(zn||(zn={})),function(e){e[e.Square=0]="Square",e[e.Rounded=1]="Rounded",e[e.Circular=2]="Circular"}(Gn||(Gn={})),function(e){e[e.Medium=0]="Medium",e[e.Large=1]="Large",e[e.ExtraLarge=2]="ExtraLarge"}(Wn||(Wn={})),function(e){e[e.Default=0]="Default",e[e.Subtle=1]="Subtle",e[e.Informative=2]="Informative",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Attention=5]="Attention",e[e.Warning=6]="Warning"}(qn||(qn={}));const Kn={[Wn.Medium]:{fontSize:10,iconSize:12,height:20,columnGap:2},[Wn.Large]:{fontSize:12,iconSize:16,height:24,columnGap:2},[Wn.ExtraLarge]:{fontSize:12,iconSize:20,height:28,columnGap:4}},Yn={[Wn.Medium]:{textOnly:6,iconAndText:{left:4,right:6}},[Wn.Large]:{textOnly:6,iconAndText:{left:4,right:6}},[Wn.ExtraLarge]:{textOnly:8,iconAndText:{left:6,right:6}}},$n={[qn.Default]:{[jn.Filled]:{backgroundColor:Pn.L.colorNeutralForeground1,textColor:Pn.L.colorNeutralBackground1},[jn.Tint]:{backgroundColor:Pn.L.colorNeutralStencil1,textColor:Pn.L.colorNeutralForeground3Hover,strokeColor:Pn.L.colorNeutralStroke1}},[qn.Subtle]:{[jn.Filled]:{backgroundColor:Pn.L.colorNeutralBackground5,textColor:Pn.L.colorNeutralForeground3,strokeColor:Pn.L.colorTransparentStroke},[jn.Tint]:{backgroundColor:Pn.L.colorNeutralBackground4,textColor:Pn.L.colorNeutralForeground3,strokeColor:Pn.L.colorNeutralStroke2}},[qn.Informative]:{[jn.Filled]:{backgroundColor:Pn.L.colorNeutralBackground1,textColor:Pn.L.colorNeutralForeground1,strokeColor:Pn.L.colorTransparentStroke},[jn.Tint]:{backgroundColor:Pn.L.colorNeutralBackground1,textColor:Pn.L.colorNeutralForeground3,strokeColor:Pn.L.colorNeutralStroke2}},[qn.Accent]:{[jn.Filled]:{backgroundColor:Pn.L.colorBrandBackground,textColor:Pn.L.colorNeutralForegroundOnBrand},[jn.Tint]:{backgroundColor:{dark:"#00061d",light:"#f2f4fc",highContrast:"#000000"},textColor:Pn.L.colorBrandForeground2,strokeColor:Pn.L.colorBrandStroke2}},[qn.Good]:{[jn.Filled]:{backgroundColor:Pn.L.colorStatusSuccessBackground3,textColor:Pn.L.colorNeutralForegroundOnBrand},[jn.Tint]:{backgroundColor:Pn.L.colorPaletteGreenBackground1,textColor:Pn.L.colorStatusSuccessForeground1,strokeColor:Pn.L.colorStatusSuccessBorder1}},[qn.Attention]:{[jn.Filled]:{backgroundColor:Pn.L.colorPaletteRedBackground3,textColor:Pn.L.colorNeutralForegroundOnBrand},[jn.Tint]:{backgroundColor:Pn.L.colorStatusDangerBackground1,textColor:Pn.L.colorStatusDangerForeground3,strokeColor:Pn.L.colorStatusDangerBorder1}},[qn.Warning]:{[jn.Filled]:{backgroundColor:Pn.L.colorPaletteMarigoldBackground3,textColor:Pn.L.colorNeutralForeground1Static},[jn.Tint]:{backgroundColor:Pn.L.colorPaletteMarigoldBackground1,textColor:Pn.L.colorPaletteMarigoldForeground2,strokeColor:Pn.L.colorPaletteMarigoldBorder1}}};class Jn extends f.hA{get text(){return this.getValue(Jn.textProperty)}set text(e){this.setValue(Jn.textProperty,e)}get icon(){return this.getValue(Jn.iconProperty)}set icon(e){this.setValue(Jn.iconProperty,e)}get iconPosition(){return this.getValue(Jn.iconPositionProperty)}set iconPosition(e){this.setValue(Jn.iconPositionProperty,e)}get appearance(){return this.getValue(Jn.appearanceProperty)}set appearance(e){this.setValue(Jn.appearanceProperty,e)}get size(){return this.getValue(Jn.sizeProperty)}set size(e){this.setValue(Jn.sizeProperty,e)}get shape(){return this.getValue(Jn.shapeProperty)}set shape(e){this.setValue(Jn.shapeProperty,e)}get style(){return this.getValue(Jn.styleProperty)}set style(e){this.setValue(Jn.styleProperty,e)}get tooltip(){return this.getValue(Jn.tooltipProperty)}set tooltip(e){this.setValue(Jn.tooltipProperty,e)}getJsonTypeName(){return Jn.jsonTypeName}internalRender(e){var t;const n=this.icon?(0,ye.Zo)(this.icon):void 0,o=$n[this.style][this.appearance],r=this.getBackgroundColor(o);let i;switch(this.shape){case Gn.Circular:i="10000px";break;case Gn.Rounded:i="4px";break;default:i=void 0}const a=Kn[this.size],s=this.getBadgePadding(),c=this.text?l.createElement("div",{key:"text",style:{flex:"1 1 auto",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",fontFamily:null===(t=this.hostConfig.fontTypes)||void 0===t?void 0:t.default.fontFamily,fontSize:a.fontSize,fontWeight:600}},this.text):null,u=n?l.createElement(ye.FW,{key:"icon",name:n.name,iconStyle:n.style,iconSize:`${a.iconSize}px`,showPlaceholder:!1,allowFallback:!1}):null,d=this.iconPosition===zn.Before?[u,c]:[c,u];let p;switch(this.horizontalAlignment){case _.OD.Center:p="center";break;case _.OD.Right:p="flex-end";break;default:p="flex-start"}const h=l.createElement("div",{style:Object.assign(Object.assign({boxSizing:"border-box",alignSelf:p,display:"flex",alignItems:"center",justifyContent:"center",columnGap:`${a.columnGap}px`,color:o.textColor,backgroundColor:r,paddingLeft:`${s.left}px`,paddingRight:`${s.right}px`,borderRadius:i,height:`${a.height}px`,minWidth:`${a.height}px`},o.strokeColor?{border:`1px solid ${o.strokeColor}`}:{}),{cursor:"default"})},d);return this.tooltip?l.createElement(Qn.m,{content:this.tooltip,relationship:"description"},h):h}getBackgroundColor(e){const t=e.backgroundColor;if("string"==typeof t)return t;switch(this.theme){case _.V6.Dark:return t.dark;case _.V6.Light:return t.light;default:return t.highContrast}}getBadgePadding(){const e=this.icon&&!this.text,t=this.text&&!this.icon,n=!this.text&&!this.icon,o=Yn[this.size];return e||n?{left:0,right:0}:t?{left:o.textOnly,right:o.textOnly}:this.iconPosition===zn.Before?o.iconAndText:{left:o.iconAndText.right,right:o.iconAndText.left}}}Jn.jsonTypeName="Badge",Jn.textProperty=new m.XB(m.uq.v1_5,"text").setContentType("text"),Jn.iconProperty=new m.XB(m.uq.v1_5,"icon",ye.bi),Jn.iconPositionProperty=new m.fX(m.uq.v1_5,"iconPosition",zn,zn.Before),Jn.appearanceProperty=new m.fX(m.uq.v1_5,"appearance",jn,jn.Filled),Jn.sizeProperty=new m.fX(m.uq.v1_5,"size",Wn,Wn.Medium),Jn.shapeProperty=new m.fX(m.uq.v1_5,"shape",Gn,Gn.Circular),Jn.styleProperty=new m.fX(m.uq.v1_5,"style",qn,qn.Default),Jn.tooltipProperty=new m.XB(m.uq.v1_5,"tooltip").setContentType("text");var Xn=n(52580),Zn=n(90996),eo=n(23379),to=n(52556),no=n(79689);class oo{}oo.carouselPageDotButtonTooltip={key:"carouselPageDotButtonTooltip",defaultValue:"Go to page {{pageIndex}}"},oo.carouselPageNOfTotal={key:"carouselAriaLive",defaultValue:"Page {{pageIndex}} of {{pageCount}}"},oo.carouselAriaRoleDescription={key:"carouselAriaRoleDescription",defaultValue:"Slide"},oo.carouselNextPageButtonAriaLabel={key:"carouselNextPageButtonAriaLabel",defaultValue:"Next page"},oo.carouselPreviousPageButtonAriaLabel={key:"carouselPreviousPageButtonAriaLabel",defaultValue:"Previous page"};const ro=250,io=160,ao=24,so=6,lo=16,co=0,uo=Object.assign(Object.assign({},Tn.Pt.padding(0)),{minWidth:0,flex:"0 0 auto","&:focus":{outline:0}}),po={height:"8px",borderRadius:"4px"},ho={animationDuration:`.${ro}s`},go=(0,xn.n)({slideInFromLeft:Object.assign(Object.assign({},ho),{animationName:{from:{transform:"translateX(-100%)"},to:{transform:"translateX(0)"}}}),slideOutToRight:Object.assign(Object.assign({},ho),{animationName:{from:{transform:"translateX(0)"},to:{transform:"translateX(100%)"}}}),slideInFromRight:Object.assign(Object.assign({},ho),{animationName:{from:{transform:"translateX(100%)"},to:{transform:"translateX(0)"}}}),slideOutToLeft:Object.assign(Object.assign({},ho),{animationName:{from:{transform:"translateX(0)"},to:{transform:"translateX(-100%)"}}}),fadeIn:Object.assign(Object.assign({},ho),{animationName:{from:{opacity:0},to:{opacity:1}}}),fadeOut:Object.assign(Object.assign({},ho),{animationName:{from:{opacity:1},to:{opacity:0}}}),navigationButton:Object.assign(Object.assign({},uo),{width:`${ao}px`,height:`${ao}px`}),pageDotsHost:{display:"flex",justifyContent:"center",flex:"0 1 auto",overflow:"hidden",columnGap:`${co}px`},navigationBar:{display:"flex",justifyContent:"center",columnGap:`${so}px`},pageDot:Object.assign(Object.assign({},po),{backgroundColor:Pn.L.colorNeutralForeground1,opacity:.65,"&:hover":{opacity:.75},"&:active":{opacity:1},width:"8px"}),selectedPageDot:Object.assign(Object.assign({},po),{backgroundColor:Pn.L.colorNeutralForeground1,width:"16px"}),pageNumberLabelContainer:{overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"center"}});var fo;!function(e){e[e.Slide=0]="Slide",e[e.CrossFade=1]="CrossFade",e[e.None=2]="None"}(fo||(fo={}));const mo=e=>{const t=go();let n=(0,to.i)({axis:"horizontal",circular:!0});e.displayPageDots||(n={});const o=[];if(e.displayPageDots){const n=t=>{e.goToPage(t,e.pageInfo.currentIndex,t<e.pageInfo.currentIndex?"rightToLeft":"leftToRight")};for(let r=0;r<e.pageCount;r++)o.push(l.createElement(yn.$,{key:r,className:t.navigationButton,appearance:"transparent",title:e.localizeString(oo.carouselPageDotButtonTooltip,{pageIndex:r+1}),onClick:()=>n(r)},l.createElement("div",{tabIndex:-1,"aria-hidden":!0,className:r===e.pageInfo.currentIndex?t.selectedPageDot:t.pageDot})))}else{const n=e.localizeString(oo.carouselPageNOfTotal,{pageIndex:e.pageInfo.currentIndex+1,pageCount:e.pageCount}),r=new Xn.V;r.text=n,r.useMarkdown=!1,r.spacing=_.Kz.None,r.setParent(e.parent),o.push(l.createElement("div",{className:t.pageNumberLabelContainer},l.createElement(r.Render,null)))}return l.createElement("div",Object.assign({className:t.pageDotsHost},n),o)},yo=e=>{const[t,n]=l.useState({currentIndex:0}),[o,r]=l.useState(!1),[i,a]=l.useState(!0),s=l.useRef(null),c=l.useRef(null),u=go();l.useEffect((()=>{const e=()=>{r(!1)};if(s.current){const t=s.current;return s.current.addEventListener("animationend",e),()=>{t.removeEventListener("animationend",e)}}}),[t]),l.useEffect((()=>{if(c.current&&e.resizeManager)return e.resizeManager.observe(c.current,((t,n)=>{const o=(r=e.children.length,3*ao+4*so+(r-1)*(lo+co));var r;a(o<=n.width&&o<=io)})),()=>{e.resizeManager.unobserve(c.current)}}));const d=(e,t,o)=>{e!==t&&(r(o),n({currentIndex:e,previousIndex:t}))},p=e.localizeString(oo.carouselNextPageButtonAriaLabel),h=e.localizeString(oo.carouselPreviousPageButtonAriaLabel),g=e.localizeString(oo.carouselPageNOfTotal,{pageIndex:t.currentIndex+1,pageCount:e.children.length});return l.createElement(l.Fragment,null,l.createElement("div",{"aria-live":"polite",style:{position:"absolute",left:"-99999px",width:0,height:0}},g),l.createElement("section",{ref:e.pageAnimation!==fo.None?s:void 0,style:{display:"grid"},tabIndex:0,"aria-roledescription":e.localizeString(oo.carouselAriaRoleDescription)},(()=>{let n,r;return!1!==o&&(e.pageAnimation===fo.CrossFade?(n=u.fadeOut,r=u.fadeIn):e.pageAnimation===fo.Slide&&("leftToRight"===o?(n=u.slideOutToLeft,r=u.slideInFromRight):"rightToLeft"===o&&(n=u.slideOutToRight,r=u.slideInFromLeft))),e.children.map(((i,a)=>{const s=e.pageAnimation===fo.None||!1===o?a===t.currentIndex:a===t.currentIndex||a===t.previousIndex;let c;return a===t.previousIndex?c=n:a===t.currentIndex&&(c=r),l.createElement("div",{className:c,key:a,style:{gridColumn:1,gridRow:1,visibility:s?"visible":"hidden"},"aria-hidden":s},i)}))})()),e.children.length>1&&l.createElement(l.Fragment,null,(0,f.JM)(e.parent.hostConfig,{spacing:e.parent.hostConfig.getEffectiveSpacing(_.Kz.Default)},_.t4.Horizontal,{padding:{},margin:{}}),l.createElement("div",{className:u.navigationBar,ref:c},l.createElement(yn.$,{className:u.navigationButton,appearance:"subtle",icon:l.createElement(no.nbA,null),title:h,onClick:()=>{let n=t.currentIndex-1;n<0&&(n=e.children.length-1),d(n,t.currentIndex,"rightToLeft")},"aria-label":h}),l.createElement(mo,{parent:e.parent,pageCount:e.children.length,pageInfo:t,goToPage:d,displayPageDots:i,localizeString:e.localizeString}),l.createElement(yn.$,{className:u.navigationButton,appearance:"subtle",icon:l.createElement(no.qGP,null),title:p,onClick:()=>{let n=t.currentIndex+1;n>=e.children.length&&(n=0),d(n,t.currentIndex,"leftToRight")},"aria-label":p}))))};class vo extends Zn.mc{populateSchema(e){super.populateSchema(e),e.remove(vo.bleedProperty),e.remove(vo.horizontalAlignmentProperty),e.remove(vo.separatorProperty),e.remove(vo.spacingProperty)}shouldSerialize(e){return!0}adjustSize(e){e.height="100%"}get renderIfEmpty(){return!0}getJsonTypeName(){return"CarouselPage"}getEffectivePadding(){const e=super.getEffectivePadding();let t=!1,n=!1;if(this.parent){const e=this.parent.getHasBackground()||this.parent.isBleeding();t=e&&this.parent.isAtTheVeryLeft(),n=e&&this.parent.isAtTheVeryRight()}return{top:e.top,right:n?_.Kz.Padding:e.right,bottom:e.bottom,left:t?_.Kz.Padding:e.left}}isResponsive(){return!0}get hasVisibleSeparator(){return!1}get isStandalone(){return!1}}class Co extends Zn.XP{constructor(){super(...arguments),this._pages=[]}get pageAnimation(){return this.getValue(Co.pageAnimationProperty)}set pageAnimation(e){this.setValue(Co.pageAnimationProperty,e)}createPageInstance(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),(e=>e&&"CarouselPage"!==e?void 0:new vo),((e,n)=>{t.logParseEvent(void 0,_.iV.ElementTypeNotAllowed,eo.D.errors.elementTypeNotAllowed(e))}))}getPagesToRender(){return this._pages.filter((e=>e.shouldRender()))}getResizeManager(){const e=this.getRootElement();return e instanceof ve.hq?e.resizeManager:void 0}populateSchema(e){super.populateSchema(e),e.remove(Co.layoutsProperty),e.remove(Co.horizontalAlignmentProperty),e.remove(Co.styleProperty),e.remove(Co.showBorderProperty),e.remove(Co.roundedCornersProperty),e.remove(Co.selectActionProperty)}getRawItems(){return this._pages}renderItems(){const e=this.getPagesToRender().map((e=>l.createElement(e.Render,{key:e.key})));return[l.createElement(yo,{key:this.key,parent:this,pageAnimation:this.pageAnimation,resizeManager:this.getResizeManager(),localizeString:this.localizeString},e)]}applyLayout(e){e.style.display="flex",e.style.flexDirection="column",e.style.overflowX="hidden"}internalParse(e,t){super.internalParse(e,t),this._pages=[];const n=e[this.getItemsCollectionPropertyName()];if(Array.isArray(n))for(const e of n){const n=this.createPageInstance(e,t);n&&this._pages.push(n)}else t.logParseEvent(this,_.iV.InvalidPropertyValue,eo.D.errors.invalidPropertyValue(n,"pages"))}internalToJSON(e,t){super.internalToJSON(e,t),t.serializeArray(e,this.getItemsCollectionPropertyName(),this._pages)}getAdditionalPropertyDescriptors(e){return[...super.getAdditionalPropertyDescriptors(e),{name:this.getItemsCollectionPropertyName(),valueTypes:[{type:"object",validValues:[new m.E$(new vo)]}],isArray:!0}]}isBleeding(){return this.getBleed()}getItemsCollectionPropertyName(){return"pages"}getEffectivePadding(){const e=super.getEffectivePadding(),t=this.getPagesToRender();return{top:e.top,right:_.Kz.None,bottom:this.isAtTheVeryBottom()&&t.length>1?_.Kz.Padding:e.bottom,left:_.Kz.None}}getHasBackground(e=!1){return super.getHasBackground(e)}isFirstElement(e){return e instanceof vo&&this._pages.includes(e)&&e.shouldRender()}getItemCount(){return this._pages.length}getFirstVisibleRenderedItem(){}getLastVisibleRenderedItem(){}getPageAt(e){return this._pages[e]}getItemAt(e){return this.getPageAt(e)}getJsonTypeName(){return"Carousel"}addPage(e){this.internalInsertItemAt(e,this._pages.length,!0)}removeItem(e){if(e instanceof vo){const t=this._pages.indexOf(e);if(t>=0)return this._pages.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1}indexOf(e){return e instanceof vo?this._pages.indexOf(e):-1}getActionById(e){let t;for(const n of this._pages)if(t=n.getActionById(e),t)break;return t}get bleed(){return this.getBleed()}set bleed(e){this.setBleed(e)}get padding(){return this.getPadding()}set padding(e){this.setPadding(e)}}Co.pageAnimationProperty=new m.fX(m.uq.v1_5,"pageAnimation",fo,fo.Slide);var bo=n(93609),Eo=n(40097),Ao=n(12328),So=function(e){function t(){var t=e.apply(this,(0,k.__spreadArray)([],(0,k.__read)(arguments),!1))||this;return t._hasError=!1,t.internalId=(0,st.Ij)(),t.labelId=(0,st.Ij)(),t.errorId=(0,st.Ij)(),t}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"label",{get:function(){return this.getValue(t.labelProperty)},set:function(e){this.setValue(t.labelProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRequired",{get:function(){return this.getValue(t.isRequiredProperty)},set:function(e){this.setValue(t.isRequiredProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"errorMessage",{get:function(){return this.getValue(t.errorMessageProperty)},set:function(e){this.setValue(t.errorMessageProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueChangedAction",{get:function(){return this.getValue(t.valueChangedActionProperty)},set:function(e){this.setValue(t.valueChangedActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(f.hA.horizontalAlignmentProperty)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._value=this.defaultValue},t.prototype.getAllLabelIds=function(){var e=[];return this.labelledBy&&e.push(this.labelledBy),e.push(this.labelId,this.errorId),e},t.prototype.getAriaLabelledBy=function(){var e=this.getAllLabelIds();return e.length>0?e.join(" "):void 0},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(){var e=this.hostConfig;if(this.label){var t=new Eo.r;t.id=this.labelId,t.setParent(this),t.forElementId=this.internalId;var n=new Ao.N(this.label);if(t.addInline(n),this.isRequired&&this.isEnabled){n.init(e.inputs.label.requiredInputs);var o=new Ao.N(e.inputs.label.requiredInputs.suffix);o.color=e.inputs.label.requiredInputs.suffixColor,o.ariaHidden=!0,t.addInline(o)}else n.init(e.inputs.label.optionalInputs);return l.createElement(t.Render,null)}return null},t.prototype.renderExtraContent=function(){return null},t.prototype.internalRender=function(e){var t=this.hostConfig,n=this.renderExtraContent(),o={display:"flex",flexDirection:"row",gap:n?"10px":void 0,flex:"stretch"===this.height?"1 1 auto":void 0};return l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"".concat(t.getEffectiveSpacing(t.inputs.label.inputSpacing),"px")}},this.renderLabel(),l.createElement("div",{className:this.hostConfig.makeCssClassName("ac-input-container"),style:o},this.renderInputControl(),n),this.renderValidationError())},t.prototype.renderValidationError=function(){if(this.hasError&&this.errorMessage&&Ke.h$.displayInputValidationErrors){var e=new Xn.V;return e.id=this.errorId,e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),l.createElement(e.Render,null)}return null},t.prototype.executeValueChangedAction=function(){var e;null===(e=this.valueChangedAction)||void 0===e||e.execute()},t.prototype.valueChanged=function(e){this._value=e,this.getRootElement().updateActionsEnabledState(),this.executeValueChangedAction(),!this.isValid()||(this.hasError=!1),this.onValueChanged&&this.onValueChanged(this);var t=this.getRootElement(),n=t&&t.onInputValueChanged?t.onInputValueChanged:ve.hq.onInputValueChanged;n&&n(this)},t.prototype.focus=function(){return!1},t.prototype.resetValue=function(){this.isSet()&&(this.value=this.defaultValue,this.updateLayout())},t.prototype.isValid=function(){return!0},t.prototype.isDirty=function(){return this.isSet()&&this.value!==this._oldValue},t.prototype.resetDirtyState=function(){this._oldValue=this.value},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.id||t.addFailure(this,_.iV.PropertyCantBeNull,eo.D.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||t.addFailure(this,_.iV.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||t.addFailure(this,_.iV.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},t.prototype.validateValue=function(){if(!this.isEnabled)return!0;var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return this.hasError=!e,e},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[this]},Object.defineProperty(t.prototype,"valueAsString",{get:function(){return void 0!==this.value&&null!==this.value?this.value.toString():void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasError",{get:function(){return this._hasError},set:function(e){this._hasError!==e&&(this._hasError=e,this.updateLayout())},enumerable:!1,configurable:!0}),t.labelProperty=new m.XB(m.uq.v1_3,"label").setContentType("text"),t.isRequiredProperty=new m.gV(m.uq.v1_3,"isRequired",!1),t.errorMessageProperty=new m.XB(m.uq.v1_3,"errorMessage").setContentType("text"),t.valueChangedActionProperty=new bo.c(m.uq.v1_5,"valueChangedAction",["Action.ToggleVisibility","Action.Execute","Action.Submit","Action.OpenUrl","Action.Overflow","Action.Http","Action.ShowCard"]),t}(f.hA),Io=function(e){function t(t,n){var o=e.call(this)||this;return o.title=t,o.value=n,o}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"Choice"},t.titleProperty=new m.XB(m.uq.v1_0,"title").setContentType("text"),t.valueProperty=new m.XB(m.uq.v1_0,"value"),t}(m.jB),Po=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"dataset",{get:function(){return this.getValue(t.datasetProperty)},set:function(e){this.setValue(t.datasetProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.getValue(t.countProperty)},set:function(e){this.setValue(t.countProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skip",{get:function(){return this.getValue(t.skipProperty)},set:function(e){this.setValue(t.skipProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"associatedInputs",{get:function(){return this.getValue(t.associatedInputsProperty)},set:function(e){this.setValue(t.associatedInputsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Data.Query"},t.prototype.getAdditionalPropertyDescriptors=function(t){return(0,k.__spreadArray)((0,k.__spreadArray)([],(0,k.__read)(e.prototype.getAdditionalPropertyDescriptors.call(this,t)),!1),[{name:"type",valueTypes:[{type:"string"}],requiredValue:this.getJsonTypeName(),isArray:!1,schemaVersion:m.uq.v1_0}],!1)},t.datasetProperty=new m.XB(m.uq.v1_0,"dataset"),t.associatedInputsProperty=new f.XC(m.uq.v1_0,"associatedInputs"),t.countProperty=new m.Uy(m.uq.v1_0,"count"),t.skipProperty=new m.Uy(m.uq.v1_0,"skip"),t}(m.bU),To=function(e){function t(){var t=e.apply(this,(0,k.__spreadArray)([],(0,k.__read)(arguments),!1))||this;return t.selectedValues=new Set,t}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMultiSelect",{get:function(){return this.getValue(t.isMultiSelectProperty)},set:function(e){this.setValue(t.isMultiSelectProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getValue(t.wrapProperty)},set:function(e){this.setValue(t.wrapProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choices",{get:function(){return this.getValue(t.choicesProperty)},set:function(e){this.setValue(t.choicesProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"choicesData",{get:function(){return this.getValue(t.choicesDataProperty)},set:function(e){this.setValue(t.choicesDataProperty,e)},enumerable:!1,configurable:!0}),t.prototype.propertyChanged=function(n,o){var r=this;if(e.prototype.propertyChanged.call(this,n,o),n===t.valueProperty){var i=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):[];this.selectedValues.clear(),i.forEach((function(e){return r.selectedValues.add(e)}))}},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.internalValidateProperties=function(t){var n,o;e.prototype.internalValidateProperties.call(this,t),0===this.choices.length&&t.addFailure(this,_.iV.CollectionCantBeEmpty,eo.D.errors.choiceSetMustHaveAtLeastOneChoice());try{for(var r=(0,k.__values)(this.choices),i=r.next();!i.done;i=r.next()){var a=i.value;a.title&&a.value||t.addFailure(this,_.iV.PropertyCantBeNull,eo.D.errors.choiceSetChoicesMustHaveTitleAndValue())}}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){var e,t;if(this.choicesData)return!0;if(""===this.value||void 0===this.value)return!this.isRequired;var n=this.isMultiSelect?this.value.split(this.hostConfig.choiceSetInputValueSeparator):[this.value],o=this.choices.map((function(e){return e.value}));try{for(var r=(0,k.__values)(n),i=r.next();!i.done;i=r.next()){var a=i.value;if(!o.includes(a))return!1}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return!0},t.prototype.isValidValue=function(e){var t,n;if(this.choicesData)return!0;var o=this.isMultiSelect?e.split(this.hostConfig.choiceSetInputValueSeparator):[e],r=this.choices.map((function(e){return e.value}));try{for(var i=(0,k.__values)(o),a=i.next();!a.done;a=i.next()){var s=a.value;if(!r.includes(s))return!1}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!0},t.prototype.getAssociatedInputs=function(){return this.choicesData&&"none"!==this.choicesData.associatedInputs?this.getRootElement().getAllInputs():[]},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value===t||void 0!==t&&!this.isValidValue(t)||e.prototype.valueChanged.call(this,t)},enumerable:!1,configurable:!0}),t.valueProperty=new m.XB(m.uq.v1_0,"value"),t.choicesProperty=new m.m2(m.uq.v1_0,"choices",(function(e){return new Io})),t.choicesDataProperty=new m.a7(m.uq.v1_5,"choices.data","Data.Query",(function(e){return new Po}),!0),t.styleProperty=new m.XY(m.uq.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:m.uq.v1_5}],"compact"),t.isMultiSelectProperty=new m.gV(m.uq.v1_0,"isMultiSelect",!1),t.placeholderProperty=new m.XB(m.uq.v1_0,"placeholder").setContentType("text"),t.wrapProperty=new m.gV(m.uq.v1_2,"wrap",!0),t}(So),xo=n(82761),wo=n(5919),ko=n(60041),_o=n(43117),Do=n(34904),Fo=n(45218);const Lo=(e,t,n,o,r)=>(0,k.__awaiter)(void 0,void 0,void 0,(function*(){o(n({searchString:e,dataQuery:t,onDataQueryCompleted:e=>{r(e),o(!1)}}))})),Oo=(e,t)=>{let n;return function(...o){n&&clearTimeout(n),n=setTimeout((()=>{e(...o)}),t)}},Ro=e=>{const{title:t,value:n}=e,o=(0,k.__rest)(e,["title","value"]);return l.createElement(Do.c,Object.assign({key:t+n,text:t,value:n},o),t)},Mo=l.forwardRef(((e,t)=>{const{staticChoices:n,choicesData:o,internalId:r,placeholder:i,ariaLabelledBy:a,isRequired:s,valueChanged:c,onDataQuery:u,value:d}=e,p=Fn(),h=e=>e.map(((e,t)=>e.title&&e.value?l.createElement(Ro,{key:t,title:e.title,value:e.value}):null)).filter((e=>null!==e)),[g,f]=l.useState(0),[m,y]=l.useState(""),[v,C]=l.useState(!1),b=l.useCallback((e=>{C(e)}),[C]),E=((e,t,n,o)=>{const[r,i]=l.useState(void 0),a=l.useCallback((e=>{i(e)}),[i]),s=l.useCallback((e=>{t(e)}),[t]),c=l.useMemo((()=>Oo(Lo,250)),[]);return l.useEffect((()=>{e&&o&&n&&c(e,n,o,s,a)}),[e,n,o,s,a,c]),r})(m,b,o,u);let A=[];E&&(null==E?void 0:E.query)===m&&(A=h((e=>{const t=[];return e&&Array.isArray(e)&&e.map((e=>{e.title&&e.value&&t.push(new Io(e.title,e.value))})),t})(E.data)));let S=null;v?S=l.createElement(Fo.z,{label:e.strings.loadingResults}):(null==E?void 0:E.error)&&(S=l.createElement(Fo.z,{label:e.strings.errorLoadingResults}));const I=l.useRef(void 0);l.useEffect((()=>{d!==I.current&&(d!==I.current&&(I.current=d),null!=d&&0!==d.length?y(d.join(",")):y(""))}),[d]);const P={id:r,appearance:wn.comboboxAppearance,className:p.compactChoiceSetInput,placeholder:i,multiselect:!1,selectedOptions:d,value:m,disabled:!e.isEnabled,onOptionSelect:(e,t)=>{c(t.selectedOptions)},onChange:e=>{const t=e.target.value.trim();y(t)},"aria-label":i,"aria-labelledby":a,"aria-required":s,onOpenChange(e,t){t.open&&f(e.currentTarget.clientWidth)},input:{style:{minWidth:0}},listbox:{style:{maxHeight:"200px",width:`${g}px`}}};return l.createElement(_o.G,Object.assign({ref:t},P),(()=>{if(m){const e=n.filter((e=>e.title&&0===e.title.toLowerCase().indexOf(m.toLowerCase())));return h(e)}return[]})(),A,S)}));Mo.displayName="DynamicTypeahead";class Bo{}Bo.passwordInputHidePasswordAriaLabel={key:"passwordInputHidePasswordAriaLabel",defaultValue:"Hide password"},Bo.passwordInputRevealPasswordAriaLabel={key:"passwordInputRevealPasswordAriaLabel",defaultValue:"Reveal password"},Bo.dateInputDefaultPlaceholder={key:"dateInputDefaultPlaceholder",defaultValue:"Select a date..."},Bo.timeInputDefaultPlaceholder={key:"timeInputDefaultPlaceholder",defaultValue:"Select a time..."},Bo.noResults={key:"noResults",defaultValue:"No results"},Bo.selectMultipleOptions={key:"selectMultipleOptions",defaultValue:"Select multiple options"},Bo.selectAnOption={key:"selectAnOption",defaultValue:"Select an option"},Bo.comboBoxClearButtonAriaLabel={key:"comboBoxClearButtonAriaLabel",defaultValue:"Clear"},Bo.loadingResults={key:"loadingResults",defaultValue:"Loading..."},Bo.errorLoadingResults={key:"errorLoadingResults",defaultValue:"Results couldn't be loaded"},Bo.sliderInputCurrentValue={key:"sliderInputCurrentValue",defaultValue:"Current value: {{value}}"},Bo.checkboxGroupLabel={key:"checkboxGroupLabel",defaultValue:"Select at least one"},Bo.january={key:"january",defaultValue:"January"},Bo.february={key:"february",defaultValue:"February"},Bo.march={key:"march",defaultValue:"March"},Bo.april={key:"april",defaultValue:"April"},Bo.may={key:"may",defaultValue:"May"},Bo.june={key:"june",defaultValue:"June"},Bo.july={key:"july",defaultValue:"July"},Bo.august={key:"august",defaultValue:"August"},Bo.september={key:"september",defaultValue:"September"},Bo.october={key:"october",defaultValue:"October"},Bo.november={key:"november",defaultValue:"November"},Bo.december={key:"december",defaultValue:"December"},Bo.januaryShort={key:"januaryShort",defaultValue:"Jan"},Bo.februaryShort={key:"februaryShort",defaultValue:"Feb"},Bo.marchShort={key:"marchShort",defaultValue:"Mar"},Bo.aprilShort={key:"aprilShort",defaultValue:"Apr"},Bo.mayShort={key:"mayShort",defaultValue:"May"},Bo.juneShort={key:"juneShort",defaultValue:"Jun"},Bo.julyShort={key:"julyShort",defaultValue:"Jul"},Bo.augustShort={key:"augustShort",defaultValue:"Aug"},Bo.septemberShort={key:"septemberShort",defaultValue:"Sep"},Bo.octoberShort={key:"octoberShort",defaultValue:"Oct"},Bo.novemberShort={key:"novemberShort",defaultValue:"Nov"},Bo.decemberShort={key:"decemberShort",defaultValue:"Dec"},Bo.sunday={key:"sunday",defaultValue:"Sunday"},Bo.monday={key:"monday",defaultValue:"Monday"},Bo.tuesday={key:"tuesday",defaultValue:"Tuesday"},Bo.wednesday={key:"wednesday",defaultValue:"Wednesday"},Bo.thursday={key:"thursday",defaultValue:"Thursday"},Bo.friday={key:"friday",defaultValue:"Friday"},Bo.saturday={key:"saturday",defaultValue:"Saturday"},Bo.sundayShort={key:"sundayShort",defaultValue:"Sun"},Bo.mondayShort={key:"mondayShort",defaultValue:"Mon"},Bo.tuesdayShort={key:"tuesdayShort",defaultValue:"Tue"},Bo.wednesdayShort={key:"wednesdayShort",defaultValue:"Wed"},Bo.thursdayShort={key:"thursdayShort",defaultValue:"Thu"},Bo.fridayShort={key:"fridayShort",defaultValue:"Fri"},Bo.saturdayShort={key:"saturdayShort",defaultValue:"Sat"},Bo.calendarWeekNumberFormatString={key:"calendarWeekNumberFormatString",defaultValue:"Week number {0}"},Bo.calendarPreviousMonthAriaLabel={key:"calendarPreviousMonthAriaLabel",defaultValue:"Previous month"},Bo.calendarNextMonthAriaLabel={key:"calendarNextMonthAriaLabel",defaultValue:"Next month"},Bo.calendarGoToToday={key:"calendarGoToToday",defaultValue:"Go to today"};const No=l.forwardRef(((e,t)=>{const n=Fn(),o=new Set(e.choices.filter((e=>e.isSelected)).map((e=>e.value))),r=e.localizeString(Bo.checkboxGroupLabel);return l.createElement("div",{id:e.internalId,ref:t,style:{display:"flex",flexDirection:"column",overflow:"hidden"},"aria-label":e.isRequired?r:""},e.choices.map(((t,r)=>{const i=`${e.internalId}-${r}`;let a=t.title;if(Ke.h$.useMarkdownInRadioButtonAndCheckbox&&e.parent){const n=new Xn.V(t.title);n.wrap=e.wrap,n.setParent(e.parent),a=l.createElement(n.Render,null)}return l.createElement(xo.S,{key:r,id:i,className:n.toggleInput,label:{className:e.wrap?n.toggleInputLabelWrap:n.toggleInputLabelNoWrap,children:a},checked:t.isSelected,disabled:!e.isEnabled,input:{"aria-label":t.title},onChange:(n,r)=>{"boolean"==typeof r.checked&&(r.checked?o.add(t.value):o.delete(t.value),e.valueChanged([...o.values()]))},"aria-labelledby":`${e.ariaLabelledBy} ${i}`})})))}));No.displayName="CheckboxGroupComponent";const Vo=l.forwardRef(((e,t)=>l.createElement(wo.z,{id:e.internalId,ref:t,onChange:(t,n)=>{e.valueChanged(n.value)},value:e.value,disabled:!e.isEnabled,"aria-label":e.label,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},e.choices.map(((t,n)=>{let o=t.title;if(Ke.h$.useMarkdownInRadioButtonAndCheckbox&&e.parent){const n=new Xn.V(t.title);n.wrap=e.wrap,n.setParent(e.parent),o=l.createElement(n.Render,null)}return l.createElement(ko.s,{key:n,value:t.value,label:o})})))));Vo.displayName="RadioGroupComponent";const Ho=l.forwardRef(((e,t)=>{const n=Fn(),o=e.choices.filter((e=>e.isSelected)).map((e=>e.value)),[r,i]=l.useState(e.choices),a=l.useMemo((()=>{const t=[];return o.forEach((n=>{const o=e.choices.find((e=>e.value===n));o&&t.push(o)})),t.map((e=>e.title)).join(", ")}),[e.choices,o]),[s,c]=l.useState(a);l.useEffect((()=>{c(a)}),[a]);const u=()=>{c(""),i(e.choices)},d=()=>{c(a)},p=t=>{if(e.isFiltered){const n=e.choices.filter((e=>e.title.toLowerCase().includes(t.target.value.toLowerCase())));i(n)}c(t.target.value)},h={id:e.internalId,appearance:wn.comboboxAppearance,className:n.compactChoiceSetInput,placeholder:e.placeholder,multiselect:e.isMultiSelect,onOptionSelect:(t,n)=>{e.valueChanged(n.selectedOptions)},selectedOptions:o,onInput:p,value:s,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired,disabled:!e.isEnabled,input:{style:{minWidth:0}}};return(e.isFiltered||e.isMultiSelect)&&(h.onChange=p,h.onFocus=u,h.onBlur=d),l.createElement(_o.G,Object.assign({ref:t},h),r.map(((e,t)=>l.createElement(Do.c,{key:t,value:e.value},e.title))),0===r.length&&e.isFiltered?l.createElement(Fo.z,{label:e.strings.noResults}):null)}));function Uo(e,t=["radio","checkbox"]){for(let n=0;n<e.children.length;n++){const o=e.children[n];if(o instanceof HTMLInputElement){if("INPUT"===o.tagName&&t.includes(o.type))return o}else{const e=Uo(o);if(e)return e}}}Ho.displayName="ComboboxComponent";class jo extends To{constructor(){super(...arguments),this._inputRef=l.createRef(),this.checkboxLabelId=(0,st.Ij)(),this.onDataQueryRequest=e=>this.dataQuery(e)}focus(){if(this._inputRef.current){if("expanded"!==this.style)return this._inputRef.current.focus(),!0;{const e=Uo(this._inputRef.current);if(e)return e.focus(),!0}}return!1}getAllLabelIds(){const e=[];return this.labelledBy&&e.push(this.labelledBy),e.push(this.labelId,this.checkboxLabelId,this.errorId),e}isValid(){if(""===this.value||void 0===this.value||this.isDynamicTypeahead())return!0;const e=this.isMultiSelect?this.value.split(this.hostConfig.choiceSetInputValueSeparator):[this.value],t=this.choices.map((e=>e.value));for(const n of e)if(!t.includes(n))return!1;return!0}renderInputControl(){this.ensureValidValue();const e=this.value,t=e?this.isMultiSelect?e.split(this.hostConfig.choiceSetInputValueSeparator):[e]:[],n=this.choices.map(((e,n)=>{var o,r;return{title:null!==(o=e.title)&&void 0!==o?o:n.toString(),value:null!==(r=e.value)&&void 0!==r?r:n.toString(),isSelected:!!e.value&&t.includes(e.value)}}));return this.isDynamicTypeahead()?this.renderAsDynamicTypeahead(t):"compact"===this.style||"filtered"===this.style?this.renderAsComboBox(n,t):this.isMultiSelect?this.renderAsCheckboxGroup(n,t):this.renderAsRadioGroup(n)}isDynamicTypeahead(){var e;return void 0!==(null===(e=this.choicesData)||void 0===e?void 0:e.dataset)}ensureValidValue(){if(this.isDynamicTypeahead())return;const e=this.value;if(e){const t=this.isMultiSelect?e.split(this.hostConfig.choiceSetInputValueSeparator):[e],n=this.choices.map((e=>e.value)),o=[];for(const e of t)n.indexOf(e)>=0&&o.push(e);this._value=o.length>0?o.join(this.hostConfig.choiceSetInputValueSeparator):void 0}}renderAsDynamicTypeahead(e){return l.createElement(Mo,{ref:this._inputRef,staticChoices:this.choices,choicesData:this.choicesData,internalId:this.internalId,placeholder:this.placeholder,isEnabled:this.isEnabled,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),valueChanged:e=>{e&&e.length>0?this.valueChanged(e.join(this.hostConfig.choiceSetInputValueSeparator)):this.valueChanged(void 0),this.updateLayout()},onDataQuery:this.onDataQueryRequest,isMultiSelect:this.isMultiSelect,value:e,strings:{dropdownPlaceholder:this.localizeString(Bo.selectAnOption),noResults:this.localizeString(Bo.noResults),loadingResults:this.localizeString(Bo.loadingResults),errorLoadingResults:this.localizeString(Bo.errorLoadingResults)}})}renderAsComboBox(e,t){return l.createElement(Ho,{ref:this._inputRef,internalId:this.internalId,choices:e,value:t,isMultiSelect:this.isMultiSelect,isFiltered:"filtered"===this.style,placeholder:this.placeholder,isEnabled:this.isEnabled,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),strings:{dropdownPlaceholder:this.isMultiSelect?this.localizeString(Bo.selectMultipleOptions):this.localizeString(Bo.selectAnOption),noResults:this.localizeString(Bo.noResults),clearButtonAriaLabel:this.localizeString(Bo.comboBoxClearButtonAriaLabel)},valueChanged:e=>{e&&e.length>0?this.valueChanged(e.join(this.hostConfig.choiceSetInputValueSeparator)):this.valueChanged(void 0),this.updateLayout()}})}renderAsRadioGroup(e){var t;return l.createElement(Vo,{ref:this._inputRef,internalId:this.internalId,choices:e,value:null!==(t=this.value)&&void 0!==t?t:"",isEnabled:this.isEnabled,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),valueChanged:e=>{this.valueChanged(e),this.updateLayout()},wrap:this.wrap,parent:this,localizeString:(e,t)=>this.localizeString(e,t)})}renderAsCheckboxGroup(e,t){return l.createElement(No,{ref:this._inputRef,internalId:this.internalId,choices:e,value:t,isEnabled:this.isEnabled,isRequired:this.isRequired,ariaLabelledBy:this.getAriaLabelledBy(),valueChanged:e=>{e&&e.length>0?this.valueChanged(e.join(this.hostConfig.choiceSetInputValueSeparator)):this.valueChanged(void 0),this.updateLayout()},wrap:this.wrap,label:this.label,localizeString:(e,t)=>this.localizeString(e,t),parent:this})}}var zo=n(94768);const Go={gridColumn:2,lineHeight:Pn.L.lineHeightBase300,fontSize:Pn.L.fontSizeBase300,fontFamily:Pn.L.fontFamilyBase,paddingTop:"2px",overflow:"hidden"},Wo=(0,xn.n)({root:{display:"grid",gridTemplateColumns:"auto 1fr",padding:"6px 8px 8px 8px",rowGap:Pn.L.spacingHorizontalXS,columnGap:Pn.L.spacingHorizontalS,textAlign:"start",minWidth:0},icon:{alignSelf:"baseline",marginTop:"1px",gridRowStart:1},textContainerSingleRow:Object.assign({},Go),textContainerMultiRow:Object.assign(Object.assign({},Go),{display:"flex",flexDirection:"column",gap:Pn.L.spacingHorizontalXS}),titleAndBadgeContainer:{display:"flex",flexWrap:"wrap",gap:Pn.L.spacingHorizontalXS},category:{fontWeight:Pn.L.fontWeightSemibold},prompt:{fontWeight:Pn.L.fontWeightRegular}}),qo=l.forwardRef(((e,t)=>{const n=Wo(),o=e.badge?l.createElement(zo.E,{appearance:"tint"},e.badge):null,r=e.category?l.createElement("span",{className:n.category},e.category):null,i=r&&o?l.createElement("div",{className:n.titleAndBadgeContainer},r,o):r||o,a=i&&e.description?n.textContainerMultiRow:n.textContainerSingleRow;return l.createElement(yn.$,Object.assign({},e,{ref:t,className:n.root,icon:void 0}),l.createElement(l.Fragment,null,l.createElement("span",{className:n.icon},e.icon),l.createElement("div",{className:a},i,e.description&&l.createElement("span",{className:n.prompt},e.description))))}));qo.displayName="PromptStarterWrapper";class Qo extends m.jB{get name(){return this.getValue(Qo.nameProperty)}set name(e){this.setValue(Qo.nameProperty,e)}get size(){return this.getValue(Qo.sizeProperty)}set size(e){this.setValue(Qo.sizeProperty,e)}get style(){return this.getValue(Qo.styleProperty)}set style(e){this.setValue(Qo.styleProperty,e)}get color(){return this.getValue(Qo.colorProperty)}set color(e){this.setValue(Qo.colorProperty,e)}getSchemaKey(){return"IconInfo"}constructor(e,t,n,o){super(),this.name=e,void 0!==t&&(this.size=t),void 0!==n&&(this.style=n),void 0!==o&&(this.color=o)}render(e){var t;return l.createElement(ye.FW,{name:null!==(t=this.name)&&void 0!==t?t:Ko.defaultIconName,iconSize:this.size,iconStyle:this.style,iconColor:this.color?(0,st.zS)(e.foregroundColors.getColorDefinition(this.color).default):void 0})}}Qo.nameProperty=new m.XB(m.uq.v1_5,"name"),Qo.sizeProperty=new m.fX(m.uq.v1_5,"size",_.lK,_.lK.xSmall),Qo.styleProperty=new m.fX(m.uq.v1_5,"style",_.pO,_.pO.Regular),Qo.colorProperty=new m.fX(m.uq.v1_5,"color",_.r7,_.r7.Default);class Ko extends f.hA{static getDefaultIcon(){return Ko._defaultIcon||(Ko._defaultIcon=new Qo("Info",_.lK.xSmall,_.pO.Regular,_.r7.Default)),Ko._defaultIcon}get icon(){return this.getValue(Ko.iconProperty)}set icon(e){this.setValue(Ko.iconProperty,e)}get title(){return this.getValue(Ko.titleProperty)}set title(e){this.setValue(Ko.titleProperty,e)}get badge(){return this.getValue(Ko.badgeProperty)}set badge(e){this.setValue(Ko.badgeProperty,e)}get description(){return this.getValue(Ko.descriptionProperty)}set description(e){this.setValue(Ko.descriptionProperty,e)}get selectAction(){return this.getValue(Ko.selectActionProperty)}set selectAction(e){this.setValue(Ko.selectActionProperty,e)}getMainAction(){return this.selectAction}internalRender(e){var t;const n={icon:(null!==(t=this.icon)&&void 0!==t?t:Ko.getDefaultIcon()).render(this.getEffectiveStyleDefinition()),category:this.title,description:this.description,badge:this.badge,disabled:!this.isEnabled};return this.selectAction&&this.hostConfig.supportsInteractivity&&(n.onKeyPress=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.stopPropagation(),this.selectAction.execute())},n.onClick=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.stopPropagation(),this.selectAction.execute())},this.selectAction.setupElementForAccessibility(n,!1,!1)),l.createElement(qo,Object.assign({},n))}getJsonTypeName(){return"CompoundButton"}}Ko.defaultIconName="Info",Ko.iconProperty=new m.kR(m.uq.v1_5,"icon",(()=>new Qo),!0),Ko.badgeProperty=new m.XB(m.uq.v1_5,"badge").setContentType("text"),Ko.titleProperty=new m.XB(m.uq.v1_5,"title").setContentType("text"),Ko.descriptionProperty=new m.XB(m.uq.v1_5,"description").setContentType("text"),Ko.selectActionProperty=new bo.c(m.uq.v1_5,"selectAction",["Action.ShowCard"]);var Yo=function(e){function t(t,n,o){var r=e.call(this,t,n,o)||this;return r.targetVersion=t,r.name=n,r.defaultValue=o,r}return(0,k.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name],r=!1;if("string"!=typeof o)r=!0;else{var i=(0,st._U)(o);if(i)return i;r=!0}return r&&n.logParseEvent(e,_.iV.InvalidPropertyValue,eo.D.errors.invalidPropertyValue(o,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,o){o.serializeDate(t,this.name,n,this.defaultValue)},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"}],isArray:!1}},t}(m.BG),$o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},set:function(e){this.setValue(t.maxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return this.value?this.isValidValue(this.value):!this.isRequired},t.prototype.isValidValue=function(e){var t=!0;return this.min&&(t=t&&e>=this.min),this.max&&(t=t&&e<=this.max),t},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueAsString",{get:function(){if(void 0!==this.value)return(0,st.$T)(this.value)},enumerable:!1,configurable:!0}),t.valueProperty=new Yo(m.uq.v1_0,"value"),t.placeholderProperty=new m.XB(m.uq.v1_0,"placeholder").setContentType("text"),t.minProperty=new Yo(m.uq.v1_0,"min"),t.maxProperty=new Yo(m.uq.v1_0,"max"),t}(So),Jo=n(87227);const Xo=l.forwardRef(((e,t)=>{var n;const o=Fn();return l.createElement(Jo.l,{id:e.internalId,strings:e.strings,appearance:wn.basicInputAppearance,className:o.dateInput,onSelectDate:t=>{e.valueChanged(null!=t?t:void 0)},allowTextInput:!0,value:null!==(n=e.value)&&void 0!==n?n:null,placeholder:e.placeholder,showGoToToday:!1,showMonthPickerAsOverlay:!0,formatDate:e.formatDate,disabled:!e.isEnabled,inlinePopup:wn.shouldUseInlinePopup,input:{ref:t,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired}})}));Xo.displayName="DateInputComponent";class Zo extends $o{constructor(){super(...arguments),this._inputRef=l.createRef()}getStrings(){return{months:[this.localizeString(Bo.january),this.localizeString(Bo.february),this.localizeString(Bo.march),this.localizeString(Bo.april),this.localizeString(Bo.may),this.localizeString(Bo.june),this.localizeString(Bo.july),this.localizeString(Bo.august),this.localizeString(Bo.september),this.localizeString(Bo.october),this.localizeString(Bo.november),this.localizeString(Bo.december)],shortMonths:[this.localizeString(Bo.januaryShort),this.localizeString(Bo.februaryShort),this.localizeString(Bo.marchShort),this.localizeString(Bo.aprilShort),this.localizeString(Bo.mayShort),this.localizeString(Bo.juneShort),this.localizeString(Bo.julyShort),this.localizeString(Bo.augustShort),this.localizeString(Bo.septemberShort),this.localizeString(Bo.octoberShort),this.localizeString(Bo.novemberShort),this.localizeString(Bo.decemberShort)],days:[this.localizeString(Bo.sunday),this.localizeString(Bo.monday),this.localizeString(Bo.tuesday),this.localizeString(Bo.wednesday),this.localizeString(Bo.thursday),this.localizeString(Bo.friday),this.localizeString(Bo.saturday)],shortDays:[this.localizeString(Bo.sundayShort),this.localizeString(Bo.mondayShort),this.localizeString(Bo.tuesdayShort),this.localizeString(Bo.wednesdayShort),this.localizeString(Bo.thursdayShort),this.localizeString(Bo.fridayShort),this.localizeString(Bo.saturdayShort)],weekNumberFormatString:this.localizeString(Bo.calendarWeekNumberFormatString),prevMonthAriaLabel:this.localizeString(Bo.calendarPreviousMonthAriaLabel),nextMonthAriaLabel:this.localizeString(Bo.calendarNextMonthAriaLabel),goToToday:this.localizeString(Bo.calendarGoToToday)}}focus(){return!!this._inputRef.current&&(this._inputRef.current.focus(),!0)}renderInputControl(){const e=this.placeholder||this.localizeString(Bo.dateInputDefaultPlaceholder),t=e=>e?this.formatDate(e):"";return l.createElement(Xo,{strings:this.getStrings(),internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},value:this.value,placeholder:e,ariaLabelledBy:this.getAriaLabelledBy(),isEnabled:this.isEnabled,isRequired:this.isRequired,formatDate:e=>t(e),ref:this._inputRef})}}var er=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.parse=function(e,t,n){var o=t[this.name];return"string"==typeof o?Number(o):(0,st.$J)(o,this.defaultValue)},t}(m.Uy),tr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},set:function(e){this.setValue(t.maxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},t.prototype.isValid=function(){return void 0===this.value?!this.isRequired:this.isValidValue(this.value)},t.prototype.isValidValue=function(e){var t=!0;return void 0!==this.min&&(t=t&&e>=this.min),void 0!==this.max&&(t=t&&e<=this.max),t},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),t.valueProperty=new er(m.uq.v1_0,"value"),t.placeholderProperty=new m.XB(m.uq.v1_0,"placeholder").setContentType("text"),t.minProperty=new m.Uy(m.uq.v1_0,"min"),t.maxProperty=new m.Uy(m.uq.v1_0,"max"),t}(So),nr=n(9702);const or=l.forwardRef(((e,t)=>{const n=Fn();return l.createElement(nr.h,{id:e.internalId,appearance:wn.numberInputAppearance,className:n.numberInput,ref:t,placeholder:e.placeholder,value:void 0!==e.value?e.value:null,min:e.min,max:e.max,precision:10,disabled:!e.isEnabled,input:{"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:(t,n)=>{let o;if(void 0===n.value){if(n.displayValue){const t=Number(n.displayValue);isNaN(t)||(o=void 0!==e.min&&t<e.min?e.min:void 0!==e.max&&t>e.max?e.max:t)}}else o=null!==n.value?n.value:void 0;e.valueChanged(o)}})}));or.displayName="NumberInputComponent";class rr extends tr{constructor(){super(...arguments),this._inputRef=l.createRef()}focus(){var e,t;return!!(null===(e=this._inputRef)||void 0===e?void 0:e.current)&&(null===(t=this._inputRef)||void 0===t||t.current.focus(),!0)}renderInputControl(){return l.createElement(or,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},placeholder:this.placeholder,value:this.value,ariaLabelledBy:this.getAriaLabelledBy(),isEnabled:this.isEnabled,isRequired:this.isRequired,min:this.min,max:this.max,ref:this._inputRef})}}var ir,ar,sr,lr=n(27582);!function(e){e[e.Medium=0]="Medium",e[e.Large=1]="Large"}(ir||(ir={})),function(e){e[e.Neutral=0]="Neutral",e[e.Marigold=1]="Marigold"}(ar||(ar={})),function(e){e[e.Default=0]="Default",e[e.Compact=1]="Compact"}(sr||(sr={}));const cr={[ir.Medium]:"medium",[ir.Large]:"large"},ur={[ar.Neutral]:"neutral",[ar.Marigold]:"marigold"};class dr extends f.hA{get value(){return this.getValue(dr.valueProperty)}set value(e){this.setValue(dr.valueProperty,e)}get count(){return this.getValue(dr.countProperty)}set count(e){this.setValue(dr.countProperty,e)}get max(){return this.getValue(dr.maxProperty)}set max(e){this.setValue(dr.maxProperty,e)}get size(){return this.getValue(dr.sizeProperty)}set size(e){this.setValue(dr.sizeProperty,e)}get color(){return this.getValue(dr.colorProperty)}set color(e){this.setValue(dr.colorProperty,e)}get style(){return this.getValue(dr.styleProperty)}set style(e){this.setValue(dr.styleProperty,e)}internalRender(e){const t=this.max>0?Math.min(this.max,dr.maxMax):dr.defaultMax;let n;switch(this.horizontalAlignment){case _.OD.Right:n="flex-end";break;case _.OD.Center:n="center"}return l.createElement("div",{style:{display:"flex",justifyContent:n}},l.createElement(lr.e,{value:this.value,max:t,size:cr[this.size],color:ur[this.color],count:this.count,compact:this.style===sr.Compact}))}getJsonTypeName(){return"Rating"}}dr.defaultMax=5,dr.maxMax=5,dr.valueProperty=new m.Uy(m.uq.v1_5,"value"),dr.countProperty=new m.Uy(m.uq.v1_5,"count"),dr.maxProperty=new m.Uy(m.uq.v1_5,"max",dr.defaultMax),dr.sizeProperty=new m.fX(m.uq.v1_5,"size",ir,ir.Large),dr.colorProperty=new m.fX(m.uq.v1_5,"color",ar,ar.Neutral),dr.styleProperty=new m.fX(m.uq.v1_5,"style",sr,sr.Default);var pr=n(40917);const hr=l.forwardRef(((e,t)=>e.isEnabled?l.createElement(pr.G,{ref:t,step:e.step,id:e.internalId,max:e.max,size:e.size,color:e.color,value:e.value,onChange:(t,n)=>{e.valueChanged(n.value)}}):l.createElement(lr.e,{value:e.value,max:e.max,size:e.size,color:e.color,valueText:""})));hr.displayName="RatingInputComponent";const gr={[ir.Medium]:"medium",[ir.Large]:"large"},fr={[ar.Neutral]:"neutral",[ar.Marigold]:"marigold"};class mr extends So{constructor(){super(...arguments),this._inputRef=l.createRef()}get defaultValue(){return this.getValue(mr.valueProperty)}set defaultValue(e){this.setValue(mr.valueProperty,e)}get max(){return this.getValue(mr.maxProperty)}set max(e){this.setValue(mr.maxProperty,e)}get allowHalfSteps(){return this.getValue(mr.allowHalfStepsProperty)}set allowHalfSteps(e){this.setValue(mr.allowHalfStepsProperty,e)}get size(){return this.getValue(mr.sizeProperty)}set size(e){this.setValue(mr.sizeProperty,e)}get color(){return this.getValue(mr.colorProperty)}set color(e){this.setValue(mr.colorProperty,e)}focus(){var e;if(null===(e=this._inputRef)||void 0===e?void 0:e.current){const e=this._inputRef.current,t=e.querySelector("input[type=radio]:checked")||e.querySelector("input[type=radio]:enabled");if(t)return null==t||t.focus(),!0}return!1}internalParse(e,t){super.internalParse(e,t),this.max>0&&this._value>this.max&&(this._value=this.max)}renderInputControl(){const e=this.max>0?Math.min(this.max,mr.maxMax):mr.defaultMax;return l.createElement(hr,{ref:this._inputRef,internalId:this.internalId,isEnabled:this.isEnabled,isRequired:this.isRequired,max:e,step:this.allowHalfSteps?.5:1,size:gr[this.size],color:fr[this.color],value:this.value,valueChanged:e=>{this.valueChanged(e),this.updateLayout()}})}getJsonTypeName(){return"Input.Rating"}isSet(){return void 0!==this.value&&!isNaN(this.value)}isValid(){return void 0===this.value?!this.isRequired:this.isValidValue(this.value)}isValidValue(e){let t=!0;return void 0!==this.max&&(t=t&&e<=this.max),t}get value(){return this._value}set value(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)}}mr.defaultMax=5,mr.maxMax=5,mr.valueProperty=new m.Uy(m.uq.v1_5,"value"),mr.maxProperty=new m.Uy(m.uq.v1_5,"max",mr.defaultMax),mr.allowHalfStepsProperty=new m.gV(m.uq.v1_5,"allowHalfSteps",!1),mr.sizeProperty=new m.fX(m.uq.v1_5,"size",ir,ir.Large),mr.colorProperty=new m.fX(m.uq.v1_5,"color",ar,ar.Neutral);var yr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxLength",{get:function(){return this.getValue(t.maxLengthProperty)},set:function(e){this.setValue(t.maxLengthProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMultiline",{get:function(){return this.getValue(t.isMultilineProperty)},set:function(e){this.setValue(t.isMultilineProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inlineAction",{get:function(){return this.getValue(t.inlineActionProperty)},set:function(e){this.setValue(t.inlineActionProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"regex",{get:function(){return this.getValue(t.regexProperty)},set:function(e){this.setValue(t.regexProperty,e)},enumerable:!1,configurable:!0}),t.prototype.renderExtraContent=function(){return this.inlineAction?l.createElement(this.inlineAction.Render,{args:{isInline:!0}}):null},t.prototype.executeValueChangedAction=function(){var e;null===(e=this.valueChangedAction)||void 0===e||e.execute(t.valueChangedActionExecutionDelay)},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getAllActions=function(){var t=e.prototype.getAllActions.call(this);return this.inlineAction&&t.push(this.inlineAction),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.isDirty=function(){var e=""!==this.value?this.value:void 0,t=""!==this._oldValue?this._oldValue:void 0;return this.isSet()&&e!==t},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return this.value?this.isValidValue(this.value):!this.isRequired},t.prototype.isValidValue=function(e){return!this.regex||new RegExp(this.regex,"g").test(e)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),t.valueChangedActionExecutionDelay=1e3,t.valueProperty=new m.XB(m.uq.v1_0,"value").setContentType("text"),t.maxLengthProperty=new m.Uy(m.uq.v1_0,"maxLength"),t.isMultilineProperty=new m.gV(m.uq.v1_0,"isMultiline",!1),t.placeholderProperty=new m.XB(m.uq.v1_0,"placeholder").setContentType("text"),t.styleProperty=new m.fX(m.uq.v1_0,"style",_.Ln,_.Ln.Text,[{value:_.Ln.Text},{value:_.Ln.Tel},{value:_.Ln.Url},{value:_.Ln.Email},{value:_.Ln.Password,targetVersion:m.uq.v1_5}]),t.inlineActionProperty=new bo.c(m.uq.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new m.XB(m.uq.v1_3,"regex"),t}(So),vr=n(23044),Cr=n(12760),br=n(64934);const Er=l.forwardRef(((e,t)=>{var n,o;const[r,i]=l.useState(!1),a=Fn(),s=(t,n)=>{e.valueChanged(n.value)},c=t=>{t.ctrlKey&&"Enter"===t.key&&e.inlineAction&&e.inlineAction.isEffectivelyEnabled()&&e.inlineAction.execute()},u=e.maxLength&&e.maxLength>0?e.maxLength:void 0,d=e.style===_.Ln.Password;if(!e.isMultiline){const o=d?r?"text":"password":_.Ln[e.style].toLowerCase();let p;if(d){let t,n;r?(t=l.createElement(br.x3b,null),n=e.strings.passwordInputIconHideAriaLabel):(t=l.createElement(br.E3C,null),n=e.strings.passwordInputIconRevealAriaLabel);const o=()=>{i(!r)};p=l.createElement(yn.$,{icon:t,appearance:"transparent",disabled:!e.isEnabled,"aria-label":n,onClick:o})}const h=d?a.passwordInputHideRevealButton:void 0;return l.createElement(vr.p,{id:e.internalId,className:a.textInput,appearance:wn.basicInputAppearance,type:o,ref:t,placeholder:e.placeholder,value:null!==(n=e.value)&&void 0!==n?n:"",maxLength:u,contentAfter:p,disabled:!e.isEnabled,input:{className:h,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:s,onKeyDown:c})}return l.createElement(Cr.T,{id:e.internalId,className:a.multilineTextInput,appearance:wn.textareaAppearance,ref:t,placeholder:e.placeholder,maxLength:u,value:null!==(o=e.value)&&void 0!==o?o:"",disabled:!e.isEnabled,textarea:{className:a.multilineTextInputTextArea,"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:s,onKeyDown:c})}));Er.displayName="TextInputComponent";class Ar extends yr{constructor(){super(...arguments),this._inputRef=l.createRef()}focus(){var e,t;return!!(null===(e=this._inputRef)||void 0===e?void 0:e.current)&&(null===(t=this._inputRef)||void 0===t||t.current.focus(),!0)}internalParse(e,t){super.internalParse(e,t),this.style===_.Ln.Password&&this.isMultiline&&(this.style=_.Ln.Text)}renderInputControl(){return l.createElement(Er,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},value:this.value,inlineAction:this.inlineAction,maxLength:this.maxLength,style:this.style,isMultiline:this.isMultiline,placeholder:this.placeholder,ariaLabelledBy:this.getAriaLabelledBy(),isEnabled:this.isEnabled,isRequired:this.isRequired,strings:{passwordInputIconHideAriaLabel:this.localizeString(Bo.passwordInputHidePasswordAriaLabel),passwordInputIconRevealAriaLabel:this.localizeString(Bo.passwordInputRevealPasswordAriaLabel)},ref:this._inputRef})}}var Sr=function(e){function t(n,o){var r=e.call(this,n,o,(function(e,n,o,r){var i=o[n.name];if("string"==typeof i&&i&&t.validateTimeString(i))return i}),(function(e,t,n,o,r){r.serializeValue(n,t.name,o)}))||this;return r.targetVersion=n,r.name=o,r}return(0,k.__extends)(t,e),t.validateTimeString=function(e){return void 0===e||t.validationRegEx.test(e)},t.timeStringToDate=function(e){var n=t.validationRegEx.exec(e);if(null!==n){var o=parseInt(n[1],10),r=parseInt(n[2],10);return new Date(t.referenceDate.getFullYear(),t.referenceDate.getMonth(),t.referenceDate.getDay(),o,r,0,0)}},t.dateToTimeString=function(e){var t=e.getHours(),n=e.getMinutes();return"".concat(t<10?"0":"").concat(t,":").concat(n<10?"0":"").concat(n)},t.prototype.preProcessValue=function(e){return t.validateTimeString(e)?e:void 0},t.prototype.getDescriptor=function(e){return{valueTypes:[{type:"string"}],isArray:!1}},t.referenceDate=new Date(1973,9,4,0,0,0,0),t.validationRegEx=/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/,t}(m.Zn),Ir=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return this.getValue(t.minProperty)},set:function(e){this.setValue(t.minProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.getValue(t.maxProperty)},set:function(e){this.setValue(t.maxProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this.getValue(t.placeholderProperty)},set:function(e){this.setValue(t.placeholderProperty,e)},enumerable:!1,configurable:!0}),t.prototype.valueChanged=function(t){e.prototype.valueChanged.call(this,t?Sr.dateToTimeString(t):void 0)},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return void 0===this.valueAsDate?!this.isRequired:this.isValidValue(this.valueAsDate)},t.prototype.isValidValue=function(e){var t="string"==typeof e?Sr.timeStringToDate(e):e;if(void 0===t)return!1;var n=!0;return this.minAsDate&&(n=n&&t>=this.minAsDate),this.maxAsDate&&(n=n&&t<=this.maxAsDate),n},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value===t||void 0!==t&&!this.isValidValue(t)||e.prototype.valueChanged.call(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueAsDate",{get:function(){return this.value?Sr.timeStringToDate(this.value):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minAsDate",{get:function(){return this.min?Sr.timeStringToDate(this.min):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxAsDate",{get:function(){return this.max?Sr.timeStringToDate(this.max):void 0},enumerable:!1,configurable:!0}),t.valueProperty=new Sr(m.uq.v1_0,"value"),t.placeholderProperty=new m.XB(m.uq.v1_0,"placeholder").setContentType("text"),t.minProperty=new Sr(m.uq.v1_0,"min"),t.maxProperty=new Sr(m.uq.v1_0,"max"),t}(So),Pr=n(12100),Tr=n(50820);function xr(e){return e?(0,Pr.Bb)(e):""}const wr=l.forwardRef(((e,t)=>{var n;const[o,r]=l.useState(xr(e.value));l.useEffect((()=>{r(xr(e.value))}),[e.value]);const i=Fn();return l.createElement(Tr.A,{id:e.internalId,className:i.timeInput,appearance:wn.timeInputAppearance,ref:t,placeholder:e.placeholder,dateAnchor:Sr.referenceDate,selectedTime:e.value,value:o,startHour:null===(n=e.min)||void 0===n?void 0:n.getHours(),endHour:e.max?e.max.getHours()+1:void 0,freeform:!0,disabled:!e.isEnabled,required:!1,input:{"aria-label":e.placeholder,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onInput:e=>{r(e.target.value)},onTimeChange:(t,n)=>{if("required-input"===n.errorType)r(""),e.valueChanged(void 0);else if(void 0!==n.errorType)r(xr(e.value));else{let t=null!==n.selectedTime?n.selectedTime:void 0;void 0!==t&&(void 0!==e.min&&t<e.min?t=e.min:void 0!==e.max&&t>e.max&&(t=e.max)),r(xr(t)),e.valueChanged(t)}},inlinePopup:wn.shouldUseInlinePopup})}));wr.displayName="TimeInputComponent";class kr extends Ir{constructor(){super(...arguments),this._inputRef=l.createRef()}focus(){var e,t;return!!(null===(e=this._inputRef)||void 0===e?void 0:e.current)&&(null===(t=this._inputRef)||void 0===t||t.current.focus(),!0)}renderInputControl(){const e=this.placeholder||this.localizeString(Bo.timeInputDefaultPlaceholder);return l.createElement(wr,{internalId:this.internalId,valueChanged:e=>{this.valueChanged(e),this.updateLayout()},placeholder:e,value:this.valueAsDate,ariaLabelledBy:this.getAriaLabelledBy(),isEnabled:this.isEnabled,isRequired:this.isRequired,min:this.minAsDate,max:this.maxAsDate,ref:this._inputRef})}}var _r="true",Dr="false",Fr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this.getValue(t.valueProperty)},set:function(e){this.setValue(t.valueProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.getValue(t.titleProperty)},set:function(e){this.setValue(t.titleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueOn",{get:function(){return this.getValue(t.valueOnProperty)},set:function(e){this.setValue(t.valueOnProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valueOff",{get:function(){return this.getValue(t.valueOffProperty)},set:function(e){this.setValue(t.valueOffProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrap",{get:function(){return this.getValue(t.wrapProperty)},set:function(e){this.setValue(t.wrapProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},t.prototype.isValidValue=function(e){return e===this.valueOn||e===this.valueOff},Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value===e||void 0!==e&&!this.isValidValue(e)||this.valueChanged(e)},enumerable:!1,configurable:!0}),t.valueProperty=new m.XB(m.uq.v1_0,"value",void 0,Dr),t.titleProperty=new m.XB(m.uq.v1_0,"title").setContentType("text"),t.valueOnProperty=new m.XB(m.uq.v1_0,"valueOn",void 0,_r,(function(e){return _r})),t.valueOffProperty=new m.XB(m.uq.v1_0,"valueOff",void 0,Dr,(function(e){return Dr})),t.wrapProperty=new m.gV(m.uq.v1_2,"wrap",!0),t}(So);const Lr=l.forwardRef(((e,t)=>{const n=Fn(),o=e.wrap?n.toggleInputLabelWrap:n.toggleInputLabelNoWrap;let r=e.title;if(Ke.h$.useMarkdownInRadioButtonAndCheckbox&&e.parent){const t=new Xn.V(e.title);t.wrap=e.wrap,t.setParent(e.parent),r=l.createElement(t.Render,null)}return l.createElement(xo.S,{id:e.internalId,ref:t,className:n.toggleInput,label:{id:e.checkboxLabelId,className:o,children:r},disabled:!e.isEnabled,checked:e.value,input:{"aria-label":e.title,"aria-labelledby":e.ariaLabelledBy,"aria-required":e.isRequired},onChange:(t,n)=>{"boolean"==typeof n.checked&&e.valueChanged(n.checked)}})}));Lr.displayName="ToggleInputComponent";class Or extends Fr{constructor(){super(...arguments),this._inputRef=l.createRef(),this.checkboxLabelId=(0,st.Ij)()}focus(){return!!this._inputRef.current&&(this._inputRef.current.focus(),!0)}getAllLabelIds(){const e=[];return this.labelledBy&&e.push(this.labelledBy),e.push(this.labelId,this.checkboxLabelId,this.errorId),e}renderInputControl(){return l.createElement(Lr,{internalId:this.internalId,checkboxLabelId:this.checkboxLabelId,ref:this._inputRef,isEnabled:this.isEnabled,title:this.title,value:this.value===this.valueOn,valueChanged:e=>{const t=e?this.valueOn:this.valueOff;this.valueChanged(t),this.updateLayout()},isRequired:this.isRequired,wrap:this.wrap,ariaLabelledBy:this.getAriaLabelledBy(),parent:this})}}var Rr=n(87417),Mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(f.hA.heightProperty)},Object.defineProperty(t.prototype,"name",{get:function(){return this.getValue(t.nameProperty)},set:function(e){this.setValue(t.nameProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.getValue(t.sizeProperty)},set:function(e){this.setValue(t.sizeProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.getValue(t.styleProperty)},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.getValue(t.colorProperty)},set:function(e){this.setValue(t.colorProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getValue(t.selectActionProperty)},set:function(e){this.setValue(t.selectActionProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getMainAction=function(){return this.selectAction},t.prototype.internalRender=function(e){var t=this.hostConfig;if(!this.name&&this.isDesignMode())return this.createPlaceholderElement();var n=void 0;switch(this.horizontalAlignment){case _.OD.Center:n="center";break;case _.OD.Right:n="flex-end"}var o={style:{display:"flex",width:"fit-content",alignSelf:n}};o.className=t.makeCssClassName("ac-icon");var r=this.getEffectiveStyleDefinition().foregroundColors.getColorDefinition(this.color);return l.createElement("div",(0,k.__assign)({},o),l.createElement(ye.FW,{name:this.name,iconSize:this.size,iconStyle:this.style,iconColor:(0,st.zS)(r.default)}))},t.prototype.getJsonTypeName=function(){return"Icon"},t.nameProperty=new m.XB(m.uq.v1_5,"name"),t.sizeProperty=new m.fX(m.uq.v1_5,"size",_.lK,_.lK.Standard),t.styleProperty=new m.fX(m.uq.v1_5,"style",_.pO,_.pO.Regular),t.colorProperty=new m.fX(m.uq.v1_5,"color",_.r7,_.r7.Default),t.selectActionProperty=new bo.c(m.uq.v1_5,"selectAction",["Action.ShowCard"]),t}(f.hA),Br=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,k.__extends)(t,e),Object.defineProperty(t.prototype,"targetInputIds",{get:function(){return this.getValue(t.targetInputIdsProperty)},set:function(e){this.setValue(t.targetInputIdsProperty,e)},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Action.ResetInputs"},t.prototype.isValid=function(){var e;return null!=this.targetInputIds&&(null===(e=this.targetInputIds)||void 0===e?void 0:e.length)>0},t.prototype.execute=function(t){var n,o,r,i;if(e.prototype.execute.call(this,t),this.isValid()){var a=null===(r=this.parent)||void 0===r?void 0:r.getRootObject();if(a&&a instanceof f.hA){var s=a.getAllInputs(),l={};try{for(var c=(0,k.__values)(s),u=c.next();!u.done;u=c.next()){var d=u.value;d.id&&(l[d.id]=d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}null===(i=this.targetInputIds)||void 0===i||i.forEach((function(e){var t;l[e]&&(null===(t=l[e])||void 0===t||t.resetValue())}))}}},t.targetInputIdsProperty=new m.g7(m.uq.v1_5,"targetInputIds"),t.JsonTypeName="Action.ResetInputs",t}(f.rc),Nr=n(58176);class Vr extends f.Au{constructor(e,t,n){super(m.uq.latest),this.setElementRegistry(e),this.setActionRegistry(t),this.forbiddenActionTypes=n}parseAction(e,t,n,o){return super.parseAction(e,t,this.forbiddenActionTypes,o)}}const Hr=["enableAdaptiveCardCharts","enableAdaptiveCardEnhancements","disableAdaptiveCardActionSubmit","enablefullWidthPropOnAC","enableCustomWidthPropOnAC","avoidAdaptiveCardRerender"];function Ur(e,t){var n;return Hr.includes(e)&&!!(null===(n=null==t?void 0:t.featureFlags)||void 0===n?void 0:n[e])}var jr=n(21278);const zr=(0,jr.Q)("AdaptiveCardRenderer",(0,xn.n)({renderedAC:{"&:focus-visible, & > *:focus-visible":{outline:"none",border:"none"}},acLink:{color:Pn.L.colorBrandForegroundLink,textDecoration:"none","&:hover":{textDecoration:"underline"}}})),Gr="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+DQogIDxnIGlkPSJjYW52YXMiIG9wYWNpdHk9IjAiIGZpbGw9Im5vbmUiPg0KICAgIDxwYXRoIGQ9Ik0xNiwxNkgwVjBIMTZaIiBvcGFjaXR5PSIwIiBmaWxsPSJub25lIiAvPg0KICA8L2c+DQogIDxnIGlkPSJsZXZlbC0xIj4NCiAgICA8cGF0aCBkPSJNMTQuNSwyLjV2MTJIMS41VjIuNVoiIGZpbGw9IiMyMTIxMjEiIG9wYWNpdHk9IjAuMSIgLz4NCiAgICA8cGF0aCBkPSJNMTQuNSwySDEuNUwxLDIuNXYxMmwuNS41aDEzbC41LS41VjIuNVpNMTQsMTRIMlYzSDE0WiIgZmlsbD0iIzIxMjEyMSIgLz4NCiAgICA8cGF0aCBkPSJNMTIsNS41QTEuNSwxLjUsMCwxLDEsMTAuNSw0LDEuNSwxLjUsMCwwLDEsMTIsNS41WiIgZmlsbD0iIzk5NmYwMCIgLz4NCiAgICA8cGF0aCBkPSJNMTQsMTEuMDlWMTIuNWwtMi44MTktMi44Mkw4Ljk4OCwxMS44NzdIOC4yODFMNC44MTQsOC40MSwyLDExLjIyNVY5LjgxMUw0LjQ2MSw3LjM1aC43MDdsMy40NjYsMy40NjYsMi4xOTMtMi4xOTNoLjcwN1oiIGZpbGw9IiMwMDVkYmEiIC8+DQogIDwvZz4NCjwvc3ZnPg==",Wr=e=>{var t;const[n,o]=(0,l.useState)(Gr),a=l.useMemo((()=>{var t;return new i.k(null===(t=e.serviceProvider)||void 0===t?void 0:t.telemetryService,r.yx.GetImage,r.xe.GetImageProxyUrl)}),[]);return l.useEffect((()=>{var t,n,r;const i=null===(t=null==e?void 0:e.imageAttr)||void 0===t?void 0:t.src;if(i){if(/^data:image\/[a-zA-Z+.-]+;base64,/.test(i))return o(i),void a.logMetricEnd({renderId:e.renderId,diagnosticsData:`cardId : ${e.cardId}, type: base64`});const t={url:i};null===(r=null===(n=e.serviceProvider)||void 0===n?void 0:n.hostService)||void 0===r||r.getImage(t).then((t=>{var n;o(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:Gr),a.logMetricEnd({renderId:e.renderId,diagnosticsData:`cardId : ${e.cardId}, type: URL, Image url: ${null==t?void 0:t.url}, isCachedImage: ${null==t?void 0:t.isCachedImage}`})})).catch((t=>{a.logMetricEndWithError({renderId:e.renderId,diagnosticsData:`GetImage request failed with error: ${t} cardId : ${e.cardId}`})}))}}),[]),l.createElement("img",Object.assign({},e.imageAttr,{src:n,alt:(null===(t=e.imageAttr)||void 0===t?void 0:t.alt)||"Adaptive card img"}))};const qr=e=>l.createElement("div",{style:{width:e.width,height:e.height}});let Qr;function Kr(e){switch(e){case _.RK.VeryNarrow:return"220px";case _.RK.Narrow:return"340px";case _.RK.Standard:return"450px";case _.RK.Wide:return"680px";default:return}}function Yr(e){var t,n,o,a,s,c;const{content:u,runtime:d,hostConfig:p,uxRegistry:h,serviceProvider:y,cardId:v,renderId:C,disableAllActions:b,forbiddenActionTypes:E=[]}=e,[A,S]=l.useState(null),I=l.useRef(new ve.hq),P=l.useRef(v),[T,x]=l.useState(I.current.getValue(ve.hq.msTeamsProperty)),w=l.useMemo((()=>Ur("avoidAdaptiveCardRerender",p)),[null===(t=null==p?void 0:p.featureFlags)||void 0===t?void 0:t.avoidAdaptiveCardRerender]);(0,Rr.n_x)();const D=function(e){const[t,n]=l.useState(e);return l.useEffect((()=>{t!==e&&n(e)}),[t,e]),t}(u),F=function(e,t,n){const[o,r]=l.useState(void 0);return l.useEffect((()=>{const o=new Vr(e,t,n);r(o)}),[e,t,JSON.stringify(n)]),o}(f.v7.defaultElements,f.v7.defaultActions,Ur("disableAdaptiveCardActionSubmit",p)?["Action.Submit"]:E.map((e=>e.toString()))),L=zr(),O=l.useMemo((()=>new i.k(null==y?void 0:y.telemetryService,r.yx.CardRender,r.xe.M365CardParser)),[u,d,p,h]);return l.useEffect((()=>{P.current!==v&&(P.current=v)}),[v]),l.useEffect((()=>{if(w&&D&&F){const e=new i.k(null==y?void 0:y.telemetryService,r.yx.CardRender,r.xe.M365CardParser);try{const t=JSON.parse(D);I.current.parse(t,F);const n=l.createElement(I.current.Render,null);n&&S((e=>e||n)),x(I.current.getValue(ve.hq.msTeamsProperty));const o=I.current.getAllActions().filter(((e,t,n)=>t===n.findIndex((t=>t.key===e.key)))).length;e.logMetricEnd({diagnosticsData:`cardId : ${P.current}, actionCount: ${o}`})}catch(t){e.logMetricEndWithError({diagnosticsData:` Card parsing failed with error: ${t} cardId : ${P.current}`})}}}),[D,F,w]),l.useEffect((()=>{if(!w)return;f.v7.actionButtonRenderer=Ln,f.v7.defaultElements.register("Input.Text",(e=>new Ar),m.uq.v1_0),f.v7.defaultElements.register("Input.Date",(e=>new Zo),m.uq.v1_0),f.v7.defaultElements.register("Input.Time",(e=>new kr),m.uq.v1_0),f.v7.defaultElements.register("Input.Number",(e=>new rr),m.uq.v1_0),f.v7.defaultElements.register("Input.Toggle",(e=>new Or),m.uq.v1_0),f.v7.defaultElements.register("Input.ChoiceSet",(e=>new jo),m.uq.v1_0);I.current.onProcessMarkdown=(e,t,n)=>{n.didProcess=!0,n.output=l.createElement(Nr.$,{components:{a:e=>{var{node:t}=e;return Jr((e=>{$r(d,e)}),(0,k.__rest)(e,["node"]))},p:e=>{var{node:n}=e,o=(0,k.__rest)(e,["node"]);return Xr(t.wrap,o)}}},e)}}),[]),l.useEffect((()=>{if(!w)return;const{actionRegistry:e,elementRegistry:t}=h;e&&e.copyTo(f.v7.defaultActions),t&&t.copyTo(f.v7.defaultElements)}),[h,w]),l.useEffect((()=>{w&&Ur("enableAdaptiveCardEnhancements",p)&&(fn(f.v7.defaultElements,f.v7.defaultActions),f.v7.defaultElements.register("Icon",(e=>new Mr),m.uq.v1_5),f.v7.imagePlaceholderRenderer=qr,f.v7.defaultElements.register("Rating",(e=>new dr)),f.v7.defaultElements.register("Input.Rating",(e=>new mr)),f.v7.defaultElements.register("CompoundButton",(e=>new Ko)),f.v7.defaultActions.register(Br.JsonTypeName,(e=>new Br),m.uq.v1_5),g._Z.conditionallyEnabledProperty.isSerializationEnabled=!0,Zn.zh.isSerializationEnabled=!0,Zn.oC.layoutsProperty.isSerializationEnabled=!0,Zn.oC.roundedCornersProperty.isSerializationEnabled=!0,Zn.oC.showBorderProperty.isSerializationEnabled=!0)}),[null===(n=null==p?void 0:p.featureFlags)||void 0===n?void 0:n.enableAdaptiveCardEnhancements,w]),l.useEffect((()=>{w&&Ur("enableAdaptiveCardCharts",p)&&vt(f.v7.defaultElements,f.v7.defaultActions)}),[null===(o=null==p?void 0:p.featureFlags)||void 0===o?void 0:o.enableAdaptiveCardCharts,w]),l.useEffect((()=>{if(!w)return;const e="full"===(null==T?void 0:T.width)&&Ur("enablefullWidthPropOnAC",p);Qr=Ur("enableCustomWidthPropOnAC",p)?void 0:Kr(e?_.RK.Wide:p.hostWidth)}),[T,null===(a=null==p?void 0:p.featureFlags)||void 0===a?void 0:a.enablefullWidthPropOnAC,null===(s=null==p?void 0:p.featureFlags)||void 0===s?void 0:s.enableCustomWidthPropOnAC,null==p?void 0:p.hostWidth,w]),l.useEffect((()=>{w&&(I.current.hostConfig=p,I.current.hostWidth=p.hostWidth)}),[p,w]),l.useEffect((()=>{w&&(I.current.onExecuteAction=null==d?void 0:d.handleAction)}),[d,w]),l.useEffect((()=>{w&&b&&I.current.getAllActions().forEach((e=>{e.isEnabled=!1}))}),[b,w]),l.useEffect((()=>{w&&(I.current.onRenderImage=(e,t)=>l.createElement(Wr,{image:e,cardId:v,renderId:C,imageAttr:t,serviceProvider:y}))}),[y,v,C,w]),l.useEffect((()=>{var e,t;wn.shouldUseInlinePopup=null!==(t=null===(e=p.featureFlags)||void 0===e?void 0:e.shouldACUseInlinePopup)&&void 0!==t&&t}),[null===(c=p.featureFlags)||void 0===c?void 0:c.shouldACUseInlinePopup,w]),l.useEffect((()=>{var t,n;try{if(w)return;wn.shouldUseInlinePopup=null!==(n=null===(t=e.hostConfig.featureFlags)||void 0===t?void 0:t.shouldACUseInlinePopup)&&void 0!==n&&n;const o=new ve.hq;f.v7.actionButtonRenderer=Ln,f.v7.defaultElements.register("Input.Text",(e=>new Ar),m.uq.v1_0),f.v7.defaultElements.register("Input.Date",(e=>new Zo),m.uq.v1_0),f.v7.defaultElements.register("Input.Time",(e=>new kr),m.uq.v1_0),f.v7.defaultElements.register("Input.Number",(e=>new rr),m.uq.v1_0),f.v7.defaultElements.register("Input.Toggle",(e=>new Or),m.uq.v1_0),f.v7.defaultElements.register("Input.ChoiceSet",(e=>new jo),m.uq.v1_0),Ur("enableAdaptiveCardEnhancements",p)&&(fn(f.v7.defaultElements,f.v7.defaultActions),f.v7.defaultElements.register("Icon",(e=>new Mr),m.uq.v1_5),f.v7.imagePlaceholderRenderer=qr,f.v7.defaultElements.register("Rating",(e=>new dr)),f.v7.defaultElements.register("Input.Rating",(e=>new mr)),f.v7.defaultElements.register("CompoundButton",(e=>new Ko)),f.v7.defaultActions.register(Br.JsonTypeName,(e=>new Br),m.uq.v1_5),g._Z.conditionallyEnabledProperty.isSerializationEnabled=!0,Zn.zh.isSerializationEnabled=!0,Zn.oC.layoutsProperty.isSerializationEnabled=!0,Zn.oC.roundedCornersProperty.isSerializationEnabled=!0,Zn.oC.showBorderProperty.isSerializationEnabled=!0),Ur("enableAdaptiveCardCharts",p)&&vt(f.v7.defaultElements,f.v7.defaultActions);const{actionRegistry:r,elementRegistry:i}=h;r&&r.copyTo(f.v7.defaultActions),i&&i.copyTo(f.v7.defaultElements);const a=(e,t,n)=>{n.didProcess=!0,n.output=l.createElement(Nr.$,{components:{a:e=>{var{node:t}=e;return Jr((e=>{$r(d,e)}),(0,k.__rest)(e,["node"]))},p:e=>{var{node:n}=e,o=(0,k.__rest)(e,["node"]);return Xr(t.wrap,o)}}},e)};o.onProcessMarkdown=a;const s=Ur("disableAdaptiveCardActionSubmit",p)?["Action.Submit"]:E.map((e=>e.toString())),c=new Vr(f.v7.defaultElements,f.v7.defaultActions,s);o.hostConfig=p,o.hostWidth=p.hostWidth;const A=JSON.parse(u);o.parse(A,c);const I="full"===o.getValue(ve.hq.msTeamsProperty).width&&Ur("enablefullWidthPropOnAC",p);Qr=Ur("enableCustomWidthPropOnAC",p)?void 0:Kr(I?_.RK.Wide:p.hostWidth),o.onExecuteAction=null==d?void 0:d.handleAction,b&&o.getAllActions().forEach((e=>{e.isEnabled=!1})),o.onRenderImage=(e,t)=>l.createElement(Wr,{image:e,cardId:v,renderId:C,imageAttr:t,serviceProvider:y});const P=o.getAllActions().filter(((e,t,n)=>t===n.findIndex((t=>t.key===e.key)))).length,T=l.createElement(o.Render,null);T&&S(T),O.logMetricEnd({diagnosticsData:`cardId : ${v}, actionCount: ${P}`})}catch(e){O.logMetricEndWithError({diagnosticsData:` Card parsing failed with error: ${e} cardId : ${v}`})}}),[u,b,d,p,h,w]),l.createElement("div",{id:"renderedAC",style:{width:Qr},className:L.renderedAC},A)}function $r(e,t){t&&(null==e||e.handleAnchorClicked(t))}function Jr(e,t){if(t.href&&"string"==typeof t.href){return function(e){const t=zr();return l.createElement("a",Object.assign({},e,{className:t.acLink,href:e.href,title:e.href,target:"_blank",rel:"noopener noreferrer"}),e.children)}(Object.assign(Object.assign({},t),{onClick:n=>{e(t.href),n.preventDefault(),n.stopPropagation()},href:t.href}))}return l.createElement("span",null,t.children)}function Xr(e,t){return l.createElement("p",Object.assign({style:{overflow:e?void 0:"hidden",textOverflow:e?void 0:"ellipsis",margin:0}},t))}const Zr=(0,jr.Q)("nonAdaptiveCardStyles",(0,xn.n)({cardStack:{marginLeft:"16px",marginRight:"16px",marginBottom:"16px",marginTop:"4px"},factName:{fontSize:"14px",fontWeight:600,color:Pn.L.colorNeutralForeground1},cardTitle:{fontSize:"18px",fontWeight:700,textAlign:"start",display:"block",whiteSpace:"pre-wrap",wordBreak:"break-word",textOverflow:"clip",textSizeAdjust:"100%",overflowWrap:"anywhere",color:Pn.L.colorNeutralForeground1},cardSubTitle:{fontSize:"12px",fontWeight:400,width:"fit-content",textAlign:"start",textSizeAdjust:"100%",wordBreak:"break-word",color:Pn.L.colorNeutralForeground3,display:"block",marginBottom:"16px"},cardText:{fontSize:"14px",width:"fit-content",textAlign:"start",wordBreak:"break-word",whiteSpace:"normal",color:Pn.L.colorNeutralForeground1,display:"block",marginBottom:"16px"},thumbnailImage:{flexShrink:"0 !important"},heroImage:{height:"100%",width:"100%",maxWidth:"fit-content"},cardButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Tn.Pt.overflow("hidden")),{textOverflow:"ellipsis",textAlign:"center",verticalAlign:"middle",cursor:"default",fontFamily:"'Segoe UI', sans-serif",fontSize:"14px",fontWeight:600}),Tn.Pt.padding("4px 10px 5px 10px")),{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",height:"31px",marginTop:"1px"}),Tn.Pt.border("1px solid")),{backgroundColor:Pn.L.colorNeutralBackground1}),Tn.Pt.borderColor(Pn.L.colorNeutralStroke1)),{"&:active":{cursor:"pointer"}}),Tn.Pt.borderRadius("4px")),{marginRight:"8px"}),buttonStack:{marginTop:"5px"}}));var ei=n(10145),ti=n(50228);class ni{constructor(){this.options={attributeCallbacks:ii()}}static instance(){return this.sInstance||(this.sInstance=new ni),this.sInstance}sanitizeHtml(e){return ti.A.sanitizeHtml(e,this.options)}}ni.sInstance=null;const oi=["width","height","style"],ri={IMG:{width:"auto",height:"auto",style:""}},ii=()=>{const e={};return oi.forEach((t=>{e[t]=ai(t)})),e},ai=e=>(t,n)=>n&&void 0!==ri[n.tagName]&&void 0!==ri[n.tagName][e]?ri[n.tagName][e]:si(t),si=e=>{const t=null==e?void 0:e.split(";").map((e=>-1===e.indexOf("font-size")?e:null)).join(";");return t},li=l.memo((e=>{const{content:t}=e,n=ni.instance().sanitizeHtml(t);return l.createElement("div",{dangerouslySetInnerHTML:{__html:n}})}));li.displayName="RichHtml";const ci=e=>{const{content:t,className:n}=e;return t?l.createElement(ei.E,{className:n},l.createElement(li,{content:t})):null},ui=l.memo((e=>{const t=l.useRef(!1),{action:n,className:o,onClick:r}=e,[i,a]=l.useState(!1),s=l.useCallback((e=>t.current&&a(e)),[]);l.useEffect((()=>(t.current=!0,()=>{t.current=!1})),[]);const c=l.useCallback((e=>{try{e.stopPropagation(),s(!0),r(n)}catch(e){}finally{s(!1)}}),[r,n,s]);return l.createElement(yn.$,{className:o,disabled:i,onClick:c},n.title)}));ui.displayName="CardButton";const di=e=>{const{actions:t,buttonClassName:n,containerClassName:o,onClick:r,payload:i}=e,a=(s=t,Array.isArray(s)&&(null==s?void 0:s.length)>0?t.slice(0,6):t);var s;return l.createElement("div",{className:o},a.map(((e,t)=>l.createElement("span",null,l.createElement(ui,{key:t,className:n,action:e,onClick:r,payload:i})))))};function pi(e){const t=JSON.parse(e.content),n=t=>{var n;null===(n=e.serviceProvider)||void 0===n||n.cardService.handleOpenUrl({url:t.value,botId:e.botId})},o=Zr(),r=t.images,i=t.text||"",a=null==r?void 0:r[0],s=t.tap,c=e=>{try{e.stopPropagation(),n(s)}catch(e){}},u={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:null==a?void 0:a.url,alt:null==a?void 0:a.alt},serviceProvider:e.serviceProvider};return l.createElement("div",{key:"heroCardView","data-tid":"hero-card",className:o.cardStack,onClick:s&&c,onKeyDown:s&&c,role:"presentation"},l.createElement(ci,{className:o.cardTitle,content:t.title}),l.createElement(ci,{className:o.cardSubTitle,content:t.subtitle}),a&&l.createElement("div",null,l.createElement(Wr,Object.assign({},u))),i&&l.createElement(ci,{className:o.cardText,content:i}),l.createElement(di,{actions:t.buttons||[],buttonClassName:o.cardButton,containerClassName:o.buttonStack,onClick:n,payload:t}))}var hi,gi,fi;!function(e){e.OpenUri="OpenUri",e.ViewAction="ViewAction",e.HttpPOST="HttpPOST",e.ActionCard="ActionCard"}(hi||(hi={})),function(e){e.Article="article",e.Avatar="avatar"}(gi||(gi={})),function(e){e.Android="android",e.Default="default",e.IOS="iOS",e.Windows="windows"}(fi||(fi={}));function mi(e){return Array.isArray(e)&&(null==e?void 0:e.length)>0}const yi=e=>{switch(e["@type"]){case hi.OpenUri:return{type:"openUrl",title:e.name,value:vi(e)};case hi.ViewAction:return{type:"openUrl",title:e.name,value:null==e?void 0:e.target[0]};case hi.ActionCard:case hi.HttpPOST:default:return{type:"unknown",title:e.name,value:""}}},vi=e=>{var t;const n=null===(t=null==e?void 0:e.targets)||void 0===t?void 0:t.find((e=>e.os===fi.Default));return(null==n?void 0:n.uri)||""},Ci=l.memo((({actions:e,buttonClassName:t,containerClassName:n,onClick:o,payload:r})=>l.createElement("div",{className:n},e.map(((e,n)=>l.createElement("span",{key:n},l.createElement(ui,{className:t,action:yi(e),onClick:o,key:n,payload:r})))))));Ci.displayName="O365ConnectorCardButtonContainer";const bi=l.memo((e=>{const{fact:t,factClassName:n,textClassName:o}=e;return l.createElement("div",null,l.createElement("span",{className:n},l.createElement(li,{content:null==t?void 0:t.name})),l.createElement(ci,{className:o,content:null==t?void 0:t.value}))}));bi.displayName="O365ConnectorCardFactRenderer";const Ei=l.memo((e=>{var t,n;const{section:o,payload:r,onCardAction:i}=e,a=Zr(),s=mi(o.images)?o.images.map(((t,n)=>{const o={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:null==t?void 0:t.image,alt:null==t?void 0:t.title,height:160,width:160},serviceProvider:e.serviceProvider};return l.createElement("div",{key:n},l.createElement("div",null,t.image?l.createElement(Wr,Object.assign({},o)):null))})):null,c=mi(o.facts)?o.facts.map(((e,t)=>l.createElement("div",{key:t},l.createElement(bi,{factClassName:a.factName,textClassName:a.cardText,fact:e})))):null,u=o.potentialAction&&l.createElement(Ci,{actions:o.potentialAction,buttonClassName:a.cardButton,containerClassName:a.buttonStack,onClick:i,payload:r});return l.createElement("div",null,l.createElement(ci,{className:a.cardSubTitle,content:null===(t=null==e?void 0:e.section)||void 0===t?void 0:t.title}),l.createElement(Ai,Object.assign({},e)),l.createElement(ci,{className:a.cardText,content:null===(n=null==e?void 0:e.section)||void 0===n?void 0:n.text}),c,l.createElement("div",null,s),u)}));Ei.displayName="O365ConnectorCardSectionRenderer";const Ai=e=>{const{section:t}=e,n=Zr(),o={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:t.activityImage,alt:t.activityImage,height:52,width:52},serviceProvider:e.serviceProvider};return l.createElement("div",null,t.activityImage?l.createElement(Wr,Object.assign({},o)):null,l.createElement("div",null,l.createElement(ci,{className:n.cardSubTitle,content:null==t?void 0:t.activityTitle}),l.createElement(ci,{className:n.cardSubTitle,content:t.activitySubtitle}),l.createElement(ci,{className:n.cardText,content:t.activityText})))};function Si(e){const t=Zr(),n=JSON.parse(e.content),o=n.potentialAction,r=t=>{var n;"openUrl"===t.type&&(null===(n=e.serviceProvider)||void 0===n||n.cardService.handleOpenUrl({url:t.value,botId:e.botId,cardData:e.cardData}))},i=mi(n.sections)?n.sections.map(((t,o)=>l.createElement("div",{key:o},l.createElement(Ei,{section:t,onCardAction:r,payload:n,serviceProvider:e.serviceProvider})))):null;return l.createElement("div",{className:t.cardStack},l.createElement(ci,{className:t.cardTitle,content:null==n?void 0:n.title}),l.createElement(ci,{className:t.cardText,content:null==n?void 0:n.text}),i,o&&l.createElement(Ci,{actions:o,buttonClassName:t.cardButton,containerClassName:t.buttonStack,onClick:r,payload:n}))}function Ii(e){const t=Zr(),n=JSON.parse(e.content),o=t=>{var n;null===(n=e.serviceProvider)||void 0===n||n.cardService.handleOpenUrl({url:t.value,botId:e.botId})},r=n.tap,i=e=>{try{e.stopPropagation(),o(r)}catch(e){}},a=n.text||"",s=n.images,c=null==s?void 0:s[0],u={image:{allowExpand:!0,isSelectable:!0},imageAttr:{src:null==c?void 0:c.url,alt:null==c?void 0:c.alt,height:100,width:100},serviceProvider:e.serviceProvider};return l.createElement("div",{key:"thumbnailCardView",className:t.cardStack,onClick:r&&i,onKeyDown:r&&i,role:"presentation"},l.createElement("div",null,c?l.createElement("div",null,l.createElement("div",{className:t.thumbnailImage},l.createElement(Wr,Object.assign({},u)))):[],l.createElement("div",null,l.createElement(ci,{className:t.cardTitle,content:n.title}),l.createElement(ci,{className:t.cardSubTitle,content:n.subtitle}),a&&l.createElement(ci,{className:t.cardText,content:a}))),l.createElement(di,{actions:n.buttons||[],buttonClassName:t.cardButton,containerClassName:t.buttonStack,onClick:o,payload:n}))}function Pi(e){const{cardData:t,uxRegistry:n,onPrepareRuntimeActivityRequest:o,onRuntimeActivityResponse:r,hostConfig:i,serviceProvider:a,renderId:s,forbiddenActionTypes:c,disableAllActions:d}=e,p=l.useMemo((()=>a?new x(t,a,o,r):void 0),[a,o,r,t]);switch(null==t?void 0:t.contentType){case u.z.AdaptiveCard:return l.createElement(Yr,{content:null==t?void 0:t.content,cardId:t.cardId,renderId:s,runtime:p,uxRegistry:n,hostConfig:i,serviceProvider:a,forbiddenActionTypes:c,disableAllActions:d});case u.z.HeroCard:return l.createElement(pi,{content:null==t?void 0:t.content,botId:t.botId,serviceProvider:a});case u.z.ThumbnailCard:return l.createElement(Ii,{content:null==t?void 0:t.content,botId:t.botId,serviceProvider:a});case u.z.ConnectorCard:return l.createElement(Si,{content:null==t?void 0:t.content,botId:t.botId,serviceProvider:a,cardData:t});default:return l.createElement(l.Fragment,null)}}function Ti(e){var t,n;let u=null;const{cardData:d,uxRegistry:p,hostConfig:h,onPrepareRuntimeActivityRequest:g,onRuntimeActivityResponse:f,serviceProvider:m,forbiddenActionTypes:y,disableAllActions:v}=e,[C,b]=l.useState({cardData:d}),[E,A]=l.useState((0,o.DA)());l.useMemo((()=>(0,c.t)(d.cardId,b)),[d.cardId]),l.useMemo((()=>b({cardData:d})),[d]);const S=l.useMemo((()=>(A((0,o.DA)()),new i.k(null==m?void 0:m.telemetryService,r.yx.CardRender,r.xe.M365CardRenderer))),[]);try{u=l.createElement(Pi,{cardData:null==C?void 0:C.cardData,hostConfig:h,uxRegistry:p,serviceProvider:m,onPrepareRuntimeActivityRequest:g,onRuntimeActivityResponse:f,renderId:E,forbiddenActionTypes:y,disableAllActions:v})}catch(e){S.logMetricEndWithError({diagnosticsData:`TypeOfCard: ${null==C?void 0:C.cardData.contentType}, Card rendering failed with error: ${e} cardId : ${null==C?void 0:C.cardData.cardId}, Appid: ${(0,a.n)(null===(t=null==C?void 0:C.cardData)||void 0===t?void 0:t.titleId,null===(n=null==C?void 0:C.cardData)||void 0===n?void 0:n.appId)}`})}return l.useEffect((()=>{var e,t,n;A((0,o.DA)());S.logMetricEnd({props:{},renderId:E,diagnosticsData:`TypeOfCard: ${null==C?void 0:C.cardData.contentType}, cardId : ${null==C?void 0:C.cardData.cardId} cardsize: ${null===(e=null==C?void 0:C.cardData.content)||void 0===e?void 0:e.length}, Appid: ${(0,a.n)(null===(t=null==C?void 0:C.cardData)||void 0===t?void 0:t.titleId,null===(n=null==C?void 0:C.cardData)||void 0===n?void 0:n.appId)}, actionabilityStatus: ${(0,s.BP)(null==C?void 0:C.cardData.cardId)}`},null==h?void 0:h.correlationId)}),[]),u}},86654:(e,t,n)=>{n.d(t,{$:()=>i,t:()=>r});const o=new Map;function r(e,t){o.set(e,t)}function i(e,t){var n;null===(n=o.get(e))||void 0===n||n(t)}},36713:(e,t,n)=>{n.d(t,{q:()=>h});var o=n(11120),r=n(77373),i=n(11404),a=n(30185),s=n(25510);const l={body:[{type:"TextBlock",size:"Medium",weight:"Bolder",text:"Sign In"},{type:"TextBlock",text:"Please sign in to see the card content",wrap:!0}],actions:[{type:"Action.SignIn",title:"Sign in",url:"https://sampleSigninUrl",data:{id:"",verb:"",data:{},originalCard:""}}],$schema:"https://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"};var c=n(86654);class u{constructor(e,t,n){this.request=e,this.content=t,this.type=n}}class d{constructor(e,t,n){this.request=e,this.code=t,this.message=n}}class p{constructor(e,t,n){this.request=e,this.signInButton=t,this.tokenExchangeResource=n}}class h{constructor(e,t,n,o,r,i,a){this.cardData=e,this.serviceProvider=t,this.action=n,this.trigger=o,this.maxRetryCount=r,this.authToken=i,this.authCode=a}onCompletion(e){var t,n,r,d,h,g,f,m,y;const v=new a.k(null===(t=this.serviceProvider)||void 0===t?void 0:t.telemetryService,o.yx.CardActions,o.xe.ActionExecuteActivityRequest),C={};if(C[o.vP.ActionType]=o.X2.Execute,C[o.vP.Intent]=void 0,C[o.vP.RuntimeActivityResponseMethod]=o.mU.OnCompletion,e instanceof u){const t=null==e?void 0:e.content;if(t&&e.type){const n=Object.values(i.z).indexOf(e.type),o=Object.keys(i.z)[n];(0,c.$)(this.cardData.cardId,{cardData:Object.assign(Object.assign({},this.cardData),{content:t,contentType:i.z[o]})})}}else if(e instanceof p){const t=e,o=l;o.actions[0].title=null!==(r=null===(n=t.signInButton)||void 0===n?void 0:n.title)&&void 0!==r?r:"Sign in",o.actions[0].url=null!==(h=null===(d=t.signInButton)||void 0===d?void 0:d.value)&&void 0!==h?h:"",o.actions[0].data.data=null!==(g=this.action.data)&&void 0!==g?g:{},o.actions[0].data.id=null!==(f=this.action.id)&&void 0!==f?f:"",o.actions[0].data.verb=this.action.verb,o.actions[0].data.originalCard=this.cardData.content,(0,c.$)(this.cardData.cardId,{cardData:Object.assign(Object.assign({},this.cardData),{content:JSON.stringify(o),contentType:i.z.AdaptiveCard})})}v.logMetricEnd({props:C,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${(0,s.n)(null===(m=this.cardData)||void 0===m?void 0:m.titleId,null===(y=this.cardData)||void 0===y?void 0:y.appId)}`})}async execute(){var e,t,n,i,l,c,h,g;const f=new a.k(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,o.yx.CardActions,o.xe.ActionExecuteActivityRequest),m={};m[o.vP.ActionType]=o.X2.Execute,m[o.vP.Intent]=void 0,m[o.vP.RuntimeActivityResponseMethod]=o.mU.Execute;let y,v=0;m[o.vP.RetryCount]=v;do{try{const e={cardData:this.cardData,botId:null!==(t=this.cardData.botId)&&void 0!==t?t:"",appId:this.cardData.appId,actionId:this.action.id,actionVerb:this.action.verb,actionData:this.action.data,trigger:this.trigger,authCode:this.authCode,authToken:this.authToken},a=await this.serviceProvider.cardService.handleActionExecute(e);if(a)if(a instanceof r.BF)y=new p(this,a.signInButton,a.tokenExchangeResource);else if(a instanceof r.G3)y=new u(this,a.content,a.type);else{const e=a.code;let t=a.message;e||t||(t=JSON.stringify(a)),y=new d(this,e,t)}y instanceof d?(m[o.vP.ActionErrorType]=o.Pk.BotInvokeError,f.logMetricEndWithError({props:m,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: Bot Invoke failed with error code: ${y.code} and message: ${y.message}, Appid: ${(0,s.n)(null===(n=this.cardData)||void 0===n?void 0:n.titleId,null===(i=this.cardData)||void 0===i?void 0:i.appId)}`})):f.logMetricEnd({props:m,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId} Appid: ${(0,s.n)(null===(l=this.cardData)||void 0===l?void 0:l.titleId,null===(c=this.cardData)||void 0===c?void 0:c.appId)}`})}catch(e){v++,m[o.vP.ActionErrorType]=o.Pk.Others;const t=JSON.stringify(null==e?void 0:e.message);f.logMetricEndWithError({props:m,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${t||JSON.stringify(e)}, Appid: ${(0,s.n)(null===(h=this.cardData)||void 0===h?void 0:h.titleId,null===(g=this.cardData)||void 0===g?void 0:g.appId)}`})}}while(!y&&this.maxRetryCount&&v<this.maxRetryCount);return null!=y?y:{request:this}}}},71427:(e,t,n)=>{n.d(t,{G:()=>a});var o=n(11120),r=n(30185),i=n(25510);class a{constructor(e,t,n,o){this.cardData=e,this.url=t,this.serviceProvider=n,this.botId=o}onCompletion(e){}async execute(){var e,t,n,a,s;const l=new r.k(null===(e=this.serviceProvider)||void 0===e?void 0:e.telemetryService,o.yx.CardActions,o.xe.OpenUrlActivityRequest),c={};c[o.vP.ActionType]=o.X2.OpenUrl,c[o.vP.Intent]=void 0,c[o.vP.RuntimeActivityResponseMethod]=o.mU.Execute;try{const e={cardData:this.cardData,url:this.url,botId:this.botId};await this.serviceProvider.cardService.handleOpenUrl(e),l.logMetricEnd({props:c,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, cardId : ${this.cardData.cardId}, Appid: ${(0,i.n)(null===(t=this.cardData)||void 0===t?void 0:t.titleId,null===(n=this.cardData)||void 0===n?void 0:n.appId)}`})}catch(e){l.logMetricEndWithError({props:c,diagnosticsData:`TypeOfCard: ${this.cardData.contentType}, CardId : ${this.cardData.cardId}, Error: ${(null==e?void 0:e.message)||e}, Appid: ${(0,i.n)(null===(a=this.cardData)||void 0===a?void 0:a.titleId,null===(s=this.cardData)||void 0===s?void 0:s.appId)} `})}return{request:this}}}},46030:(e,t,n)=>{n.d(t,{N:()=>i});var o=n(89797),r=n(62653);function i(e,t,n){return new o.a(n,function(e){return{choiceSetInputValueSeparator:",",supportsInteractivity:!0,spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},separator:{lineThickness:1,lineColor:r.L.colorNeutralStroke1},imageSizes:{small:32,medium:52,large:100},fontTypes:{default:Object.assign(Object.assign({},a),{fontFamily:r.L.fontFamilyBase}),monospace:a},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:s(e),actions:{maxActions:6,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Left",allowButtonsToWrap:!0},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:16}}}(e),t,void 0,e)}function a(){return{fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:300,default:r.L.fontWeightRegular,bolder:r.L.fontWeightSemibold}}}function s(e){return{default:Object.assign(Object.assign({},l(e)),{backgroundColor:r.L.colorNeutralCardBackground,borderColor:r.L.colorNeutralStroke2}),emphasis:Object.assign(Object.assign({},l(e)),{backgroundColor:r.L.colorNeutralBackground3,borderColor:r.L.colorNeutralStroke1}),accent:Object.assign(Object.assign({},l(e)),{backgroundColor:c("#f2f4fc","#00061d","#000000",e),borderColor:r.L.colorBrandStroke2}),good:Object.assign(Object.assign({},l(e)),{backgroundColor:r.L.colorPaletteLightGreenBackground1,borderColor:r.L.colorStatusSuccessBorder1}),warning:Object.assign(Object.assign({},l(e)),{backgroundColor:r.L.colorPaletteDarkOrangeBackground1,borderColor:r.L.colorPaletteDarkOrangeBorder1}),attention:Object.assign(Object.assign({},l(e)),{backgroundColor:r.L.colorStatusDangerBackground1,borderColor:r.L.colorStatusDangerBorder1})}}function l(e){const t=c("#ffedd6","#4d2a00","#000000",e);return{foregroundColors:{default:{default:r.L.colorNeutralForeground1,subtle:r.L.colorNeutralForeground3,highlightColors:{default:t,subtle:t}},dark:{default:r.L.colorNeutralForeground1Static,subtle:r.L.colorNeutralForeground1Static,highlightColors:{default:r.L.colorTransparentBackground,subtle:r.L.colorTransparentBackground}},light:{default:r.L.colorNeutralForegroundStaticInverted,subtle:r.L.colorNeutralForegroundStaticInverted,highlightColors:{default:r.L.colorTransparentBackground,subtle:r.L.colorTransparentBackground}},accent:{default:r.L.colorBrandForeground2,subtle:r.L.colorBrandForeground2,highlightColors:{default:t,subtle:t}},good:{default:r.L.colorStatusSuccessForeground1,subtle:r.L.colorStatusSuccessForeground1,highlightColors:{default:t,subtle:t}},warning:{default:r.L.colorPaletteDarkOrangeForeground1,subtle:r.L.colorPaletteDarkOrangeForeground1,highlightColors:{default:t,subtle:t}},attention:{default:r.L.colorStatusDangerForeground3,subtle:r.L.colorStatusDangerForeground3,highlightColors:{default:t,subtle:t}}}}}function c(e,t,n,o){return"dark"===o?t:"contrast"===o?n:e}},30185:(e,t,n)=>{n.d(t,{k:()=>r});var o=n(11120);class r{constructor(e,t,n){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isLoggingDone=!1,this.timeoutId=setTimeout((()=>{this.log({type:o.FY.LogMetric,tag:this.tag,name:this.name,success:o.YE.Timeout,duration:6e4,diagnosticsData:"Ended with Timeout"}),this.isLoggingDone=!0}),6e4)}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:o.FY.LogMetric,tag:this.tag,name:this.name,success:o.YE.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:o.FY.LogMetric,tag:this.tag,name:this.name,success:o.YE.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}},25510:(e,t,n)=>{n.d(t,{n:()=>r});const o={GlobalApp:"GlobalApp",UserApp:"UserApp",TenantApp:"TenantApp",Empty:""};function r(e,t){const n=function(e){return(null==e?void 0:e.startsWith("P_"))?o.GlobalApp:(null==e?void 0:e.startsWith("U_"))?o.UserApp:(null==e?void 0:e.startsWith("T_"))?o.TenantApp:o.Empty}(e);switch(n){case o.GlobalApp:return t;case o.UserApp:return o.UserApp;case o.TenantApp:return o.TenantApp;default:return o.Empty}}},47063:(e,t,n)=>{n.d(t,{e:()=>r});var o=n(74842);class r{constructor(){this.elementRegistry=new o.lX,this.actionRegistry=new o.lX}}},58274:(e,t,n)=>{n.d(t,{J:()=>m});var o,r,i,a=n(79490),s=n(58651),l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},c=void 0!==s?s:void 0,u={trace:(null!==(o=null==c?void 0:c.trace)&&void 0!==o?o:l).bind(c),warn:(null!==(r=null==c?void 0:c.warn)&&void 0!==r?r:l).bind(c),table:(null!==(i=null==c?void 0:c.table)&&void 0!==i?i:l).bind(c)},d=n(81227),p="undefined"!=typeof __WHY_DID_YOU_RECOMPUTE__&&__WHY_DID_YOU_RECOMPUTE__||"undefined"!=typeof globalThis&&globalThis.__WHY_DID_YOU_RECOMPUTE__,h={empty:!0},g={},f="undefined"==typeof WeakMap?null:WeakMap,m=function(e,t){if(void 0===t&&(t=100),!f)return e;var n=y(),o=0,r=0,i=p?new Map:void 0,s=p?new Error("Memoized function defined").stack:"";return function(){for(var l,c,f,m,v=[],C=0;C<arguments.length;C++)v[C]=arguments[C];var b=n;(0!==r||t>0&&o>t)&&(n=y(),o=0,r=0,null==i||i.clear()),b=n;for(var E=function(e){var t=function(e){if(!e)return h;if("object"==typeof e||"function"==typeof e)return e;g[e]||(g[e]={val:e});return g[e]}(v[e]);if(!(null===(l=b.map)||void 0===l?void 0:l.has(t))&&(null===(c=b.map)||void 0===c||c.set(t,y()),p&&i)){var n=null!==(f=i.get(b))&&void 0!==f?f:[],o=n.filter((function(e){return e!==t&&(0,d.A)(e,t)}))[0];if(o){u.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var r=new Error("Indentical argument passed").stack,C=function(e,t){u.table(e),Object.keys(e).forEach((function(n){var o=e[n],r=t[n];o!==r&&(0,d.A)(o,r)&&(u.warn("Duplication present in child prop '".concat(n,"'")),C(o,r))}))};C(o,t),u.warn(r),u.warn(s)}i.set(b,(0,a.__spreadArray)((0,a.__spreadArray)([],(0,a.__read)(n),!1),[t],!1))}b=null===(m=b.map)||void 0===m?void 0:m.get(t)},A=0;A<v.length;A++)E(A);return b.hasOwnProperty("value")||(b.value=e.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(v),!1)),o++),b.value}};function y(){return{map:f?new f:null}}},94295:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapTimeout=t.wrapWithActivity=t.getCurrentActivity=t.startActivity=t.Activity=t.UserAction=void 0,function(e){e.Render="render",e.Select="select",e.Deselect="deselect",e.Hover="hover",e.Unhover="unhover"}(t.UserAction||(t.UserAction={}));var n=function(){function e(e){this.isActive=!0,this.start=performance.now(),this.data={actions:[],isSuccess:!0,entry:e}}return e.prototype.addAction=function(e){this.data.actions.includes(e)||this.data.actions.push(e)},e.prototype.setError=function(e){this.data.isSuccess=!1,this.data.errorMessage=e.message,e.stack&&(this.data.errorMessage+="\n "+e.stack)},e.prototype.end=function(){if(this.isActive){this.isActive=!1;var e=performance.now();this.data.duration=e-this.start,this.data.actions.sort(),(t=o.pop())&&t.sink.write(t.activity.getData())}var t},e.prototype.getEntry=function(){return this.data.entry},e.prototype.getData=function(){if(this.isActive)throw new Error("Data is invalid while activity is active.");return this.data},e}();t.Activity=n;var o=[];function r(e,t){var r=new n(t);return o.push({sink:e,activity:r}),r}function i(){var e;return null===(e=o[o.length-1])||void 0===e?void 0:e.activity}t.startActivity=r,t.getCurrentActivity=i,t.wrapWithActivity=function(e,t,n){var o,a;try{return e&&r(e,t),n()}catch(e){return void(null===(o=i())||void 0===o||o.setError(e))}finally{return void(null===(a=i())||void 0===a||a.end())}},t.wrapTimeout=function(e,t){var n,a;if("string"==typeof e)throw new Error("No string based timer.");var s="".concat((null===(n=i())||void 0===n?void 0:n.getEntry())||"","_timeout"),l=null===(a=o[o.length-1])||void 0===a?void 0:a.sink;return setTimeout((function(){var t,n;try{l&&r(l,s),e()}catch(e){null===(t=i())||void 0===t||t.setError(e)}finally{null===(n=i())||void 0===n||n.end()}}),t)}},24134:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AggregatingActivitySink=void 0;var o=n(79490),r=n(94295),i=function(){function e(){this.activities=[],this.timeout=-1,this.ignorableActions=[r.UserAction.Render,r.UserAction.Select,r.UserAction.Deselect]}return e.prototype.write=function(e){var t=this;if(e.actions.length>0&&e.actions.every((function(e){return t.ignorableActions.includes(e)})))this.writeAggregated(e);else{this.activities.push(e),-1!==this.timeout&&clearTimeout(this.timeout);this.timeout=setTimeout((function(){return t.flushActivities()}),1e3)}},e.prototype.flushActivities=function(){for(var e;this.activities.length>0;){for(var t=this.activities[0],n=[],r=this.activities.length-1;r>=0;r--){var i=this.activities[r];this.shouldAggregate(t,i)&&(n.push(null!==(e=i.duration)&&void 0!==e?e:0),this.activities.splice(r,1))}var a=n.reduce((function(e,t){return e+t}))/n.length;this.writeAggregated(o.__assign(o.__assign({},t),{duration:{average:a,count:n.length}}))}},e.prototype.shouldAggregate=function(e,t){return e.errorMessage===t.errorMessage&&e.entry===t.entry&&e.actions.length===t.actions.length&&e.actions.every((function(e,n){return t.actions[n]===e}))},e}();t.AggregatingActivitySink=i},88703:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CallbackActivitySink=void 0;var o=n(79490),r=function(e){function t(t){var n=e.call(this)||this;return n.callback=t,n}return o.__extends(t,e),t.prototype.writeAggregated=function(e){this.callback(e)},t}(n(24134).AggregatingActivitySink);t.CallbackActivitySink=r},29841:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Bounds2D=void 0;var n=function(){function e(){this.minX=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE}return e.prototype.addPoint=function(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},e.prototype.getBounds=function(){return{min:{x:this.minX,y:this.minY},max:{x:this.maxX,y:this.maxY}}},e.prototype.isEmpty=function(){return this.minX===Number.MAX_VALUE&&this.maxX===-Number.MAX_VALUE&&this.minY===Number.MAX_VALUE&&this.maxY===-Number.MAX_VALUE},e.prototype.reset=function(){this.minX=Number.MAX_VALUE,this.maxX=-Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxY=-Number.MAX_VALUE},e}();t.Bounds2D=n},59646:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasSink=void 0;var o=n(61269),r=n(1056),i=n(57096),a=n(5753),s=function(){function e(e){this.filled=!1,this.masterInstancer=new i.MasterInstancer,this.isCreatingMaster=!1;var t=e.getContext("2d");if(!t)throw new Error("Invalid canvas");this.context=t,(0,r.scale2DCanvasContextByDevicePixelRatio)(this.context),this.context.clearRect(0,0,e.width,e.height)}return e.prototype.beginGeometry=function(e){return this.formatObject=e,!0},e.prototype.endGeometry=function(){return this.formatObject=void 0,this.masterInstancer.reset(),!0},e.prototype.beginPath=function(e){return!this.isCreatingMaster||this.masterInstancer.beginPath(e)},e.prototype.endPath=function(){return!this.isCreatingMaster||this.masterInstancer.endPath()},e.prototype.beginFigure=function(e,t,n){return this.isCreatingMaster?this.masterInstancer.beginFigure(e,t,n):(this.context.beginPath(),this.context.moveTo(e.x+.5,e.y+.5),this.filled=t,!0)},e.prototype.endFigure=function(e){if(!this.formatObject)throw new Error("Missing format object.");if(this.isCreatingMaster)return this.masterInstancer.endFigure(e);if(this.context.save(),e&&this.context.closePath(),this.filled){var t=this.formatObject.getFill();if(!(0,o.isSolidFillFormat)(t))throw new Error("Unsupported fill.");this.context.fillStyle=t.color,this.context.fill()}var n=this.formatObject.getLineThickness();if("number"==typeof n&&(this.context.lineWidth=n),0!==n){var r=this.formatObject.getLineDashType(),i=this.formatObject.getLineCapType();r!==o.LineDashType.Solid&&this.context.setLineDash((0,a.createStrokeDashArray)(r,n,i));var s=this.formatObject.getLineFill();if(!(0,o.isSolidFillFormat)(s))throw new Error("Unsupported line fill.");this.context.strokeStyle=s.color,this.context.stroke()}return this.context.restore(),!0},e.prototype.addLines=function(e){if(this.isCreatingMaster)return this.masterInstancer.addLines(e);for(var t=0,n=e;t<n.length;t++){var o=n[t];this.context.lineTo(o.x+.5,o.y+.5)}return!0},e.prototype.addBeziers=function(e){if(this.isCreatingMaster)return this.masterInstancer.addBeziers(e);for(var t=0;t<e.length;t+=3)this.context.bezierCurveTo(e[t+0].x+.5,e[t+0].y+.5,e[t+1].x+.5,e[t+1].y+.5,e[t+2].x+.5,e[t+2].y+.5);return!0},e.prototype.addEscape=function(e,t){if(this.isCreatingMaster&&e!==o.GeometryEscape.MasterEnd)return this.masterInstancer.addEscape(e,t);switch(e){case o.GeometryEscape.MasterBegin:this.masterInstancer.reset(),this.isCreatingMaster=!0;break;case o.GeometryEscape.MasterEnd:this.isCreatingMaster=!1;break;case o.GeometryEscape.Instance2D:this.masterInstancer.createInstance(this,t)}return!0},e.prototype.render=function(e){var t=this;e.enumerateGeometry(this),this.renderText(e.getText()),e.getChildren().forEach((function(e){return t.render(e)}))},e.prototype.renderText=function(e){if(e){this.context.save(),this.context.translate(e.getLocation().x,e.getLocation().y),this.context.rotate(Math.PI*e.getAngle()/180);for(var t=0,n=0,r=e.getLines();n<r.length;n++){for(var i=r[n],a=0,s=0,l=i.getRuns();s<l.length;s++){var c=l[s],u="";c.getStyle()===o.FontStyle.Italic?u+="italic ":c.getStyle()===o.FontStyle.Oblique&&(u+="oblique "),c.getWeight()>=o.FontWeight.Bold&&(u+="bold ");var d="".concat(u).concat(c.getPixelSize(),"px ").concat(c.getFaceName());this.context.font=d,this.context.fillStyle=c.getColor(),this.context.fillText(c.getText(),a,t+i.getBaseline()),a+=this.context.measureText(c.getText()).width}t+=i.getHeight()}this.context.restore()}},e}();t.CanvasSink=s},36182:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChartHost=t.HostStatus=void 0;var o,r=n(79490),i=n(42333);!function(e){e[e.Idle=0]="Idle",e[e.LayoutInProgress=1]="LayoutInProgress",e[e.RenderInProgress=2]="RenderInProgress",e[e.LayoutAndRenderInProgress=3]="LayoutAndRenderInProgress"}(o=t.HostStatus||(t.HostStatus={}));var a=function(){function e(e,t,n){var o=this;this.layoutInProgress=!1,this.renderInProgress=!1,this.listeners={},this.layoutProvider=e,this.chartPlayer=new i.ChartPlayer(t,n),this.chartPlayer.on("finish",(function(e,t){o.onRenderFinish(e,t)})),this.chartPlayer.on("error",(function(e,t){o.onRenderError(e,t)}))}return e.prototype.on=function(e,t){return this.listeners[e]=t,this},e.prototype.getLayoutProvider=function(){return this.layoutProvider},e.prototype.setElement=function(e){this.chartPlayer.setElement(e),this.renderCurrent()},e.prototype.getRenderSettings=function(){return this.chartPlayer.getRenderSettings()},e.prototype.setRenderer=function(e){this.chartPlayer.setRenderer(e),this.renderCurrent()},e.prototype.setConfiguration=function(e){var t=r.__assign({},e);this.beginLayout(t)},e.prototype.beginLayout=function(e){var t=this;if(this.layoutInProgress)this.pendingChartDefinition=e;else{this.setLayoutInProgress(!0),this.layoutProvider.getResource(e,this.chartPlayer.getRenderSettings().renderer,(function(e,n){if(t.setLayoutInProgress(!1),e?t.notifyError("LayoutFailed: ".concat(e)):(t.currentChartLayout=n.chartResource,t.currentChartInteractivity=n.chartInteractivityResource,t.renderCurrent()),t.pendingChartDefinition){var o=t.pendingChartDefinition;t.pendingChartDefinition=void 0,t.beginLayout(o)}}))}},e.prototype.renderCurrent=function(){this.currentChartLayout&&this.chartPlayer.getElement()&&(this.setRenderInProgress(!0),this.chartPlayer.render(this.currentChartLayout,this.currentChartInteractivity))},e.prototype.setLayoutInProgress=function(e){this.layoutInProgress!==e&&(this.layoutInProgress=e,this.layoutInProgress?this.notifyStatusChanged("layout-start"):this.notifyStatusChanged("layout-finish"))},e.prototype.setRenderInProgress=function(e){this.renderInProgress!==e&&(this.renderInProgress=e,this.renderInProgress?this.notifyStatusChanged("render-start"):this.notifyStatusChanged("render-finish"))},e.prototype.notifyStatusChanged=function(e){this.listeners[e]&&this.listeners[e](e,this.getStatus())},e.prototype.notifyError=function(e){this.listeners.error&&this.listeners.error("error",e)},e.prototype.getStatus=function(){return this.layoutInProgress?this.renderInProgress?o.LayoutAndRenderInProgress:o.LayoutInProgress:this.renderInProgress?o.RenderInProgress:o.Idle},e.prototype.onRenderFinish=function(e,t){this.setRenderInProgress(!1)},e.prototype.onRenderError=function(e,t){this.notifyError("RenderFailed: ".concat(t))},e}();t.ChartHost=a},42333:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ChartPlayer=t.touchManualPlacementCG=t.inPlaceTextEditingFG=t.manualPlacementFG=t.RenderStatus=void 0;var o,r=n(1056),i=n(99365),a=n(74165),s=n(73927),l=n(24032),c=n(66796),u=n(51115),d=n(50556),p=n(3168),h=n(59646),g=n(49934),f=n(86954),m=n(63444),y=n(94295),v=n(88703),C=n(16460);!function(e){e[e.Idle=0]="Idle",e[e.Rendering=1]="Rendering",e[e.Finished=2]="Finished"}(o=t.RenderStatus||(t.RenderStatus={})),t.manualPlacementFG="EnableManualPlacement",t.inPlaceTextEditingFG="EnableInPlaceTextEditing",t.touchManualPlacementCG="EnableTouchManualPlacement";var b=function(){function e(e,t,n){this.renderingStatus=o.Idle,this.listeners={},this.activitySink=new v.CallbackActivitySink(this.handleActivity.bind(this)),this.renderSettings=e,this.element=t,this.renderHost=n||new u.DefaultRenderHost}return Object.defineProperty(e.prototype,"isInteractivityEnabled",{get:function(){return!!this.interactivityManager&&this.interactivityManager.isEnabled},set:function(e){var t=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.isInteractivityEnabled",(function(){t.interactivityManager&&(t.interactivityManager.isEnabled=e)}))},enumerable:!1,configurable:!0}),e.prototype.getElement=function(){return this.element},e.prototype.setElement=function(e){this.element=e},e.prototype.getRenderSettings=function(){return this.renderSettings},e.prototype.setRenderer=function(e){this.renderSettings.renderer=e},e.prototype.on=function(e,t){return this.listeners[e]=t,this},e.prototype.render=function(e,t){var n=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.render",(function(){var r;if(!n.element)throw new Error("Missing element.");n.renderingStatus!==o.Rendering&&(n.setAndNotifyStatus(o.Rendering),n.renderSettings.renderer===a.IvyRenderer.Image?n.renderImage(n.element,e):n.renderSettings.renderer===a.IvyRenderer.JSON?n.renderJson(n.element,e):n.renderSettings.renderer===a.IvyRenderer.Canvas?n.renderCanvas(n.element,e):n.renderSettings.renderer===a.IvyRenderer.Svg&&n.renderSvg(n.element,e,t),null===(r=(0,y.getCurrentActivity)())||void 0===r||r.addAction(y.UserAction.Render),n.setAndNotifyStatus(o.Finished))}))},e.prototype.select=function(e,t){var n=this,o=t?(0,C.convertInputTypeToEnum)(t.toLocaleLowerCase()):void 0;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.select",(function(){var t;return null===(t=n.interactivityManager)||void 0===t?void 0:t.select(e,o)}))},e.prototype.selectParent=function(){var e=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.selectParent",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.selectParent()}))},e.prototype.selectFirstChild=function(){var e=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.selectFirstChild",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.selectFirstChild()}))},e.prototype.selectNextSibling=function(){var e=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.selectNextSibling",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.selectNextSibling()}))},e.prototype.selectPreviousSibling=function(){var e=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.selectPreviousSibling",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.selectPreviousSibling()}))},e.prototype.moveElementByKey=function(e){var t=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.moveElementByKey",(function(){var n;return null===(n=t.interactivityManager)||void 0===n?void 0:n.moveElementByKey(e)}))},e.prototype.isElementMovementInProgress=function(){var e=this,t=(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.isElementMovementInProgress",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.isElementMovementInProgress()}));return void 0!==t&&t},e.prototype.restoreElementPosition=function(){var e=this;(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.restoreElementPosition",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.restoreElementPosition()}))},e.prototype.getDescription=function(){var e=this;return(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.getDescription",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.getDescription()}))},e.prototype.getCurrentSelectionBounds=function(){var e=this;return(0,y.wrapWithActivity)(this.activitySink,"ChartPlayer.getCurrentSelectionBounds",(function(){var t;return null===(t=e.interactivityManager)||void 0===t?void 0:t.getSelectionBounds()}))},e.prototype.renderCanvas=function(e,t){if("object"!=typeof t.data)throw new Error("Unsupported svg resource.");var n=new i.SceneGraph(t.data),o=n.getSize(),a=(0,r.createCanvas)(e,o.width,o.height);new h.CanvasSink(a).render(n.getRoot())},e.prototype.renderSvg=function(e,n,o){var a=this;if(!this.renderHost)throw new Error("Render host is needed for svg rendering.");if("object"!=typeof n.data)throw new Error("Unsupported svg resource.");var u=new i.SceneGraph(n.data),h=u.getSize(),y=u.getBorderWidth(),v=document.createElementNS(d.svgns,"svg");this.renderSettings.disableChartElementResize||(v.setAttribute("width","".concat(h.width+2*y)),v.setAttribute("height","".concat(h.height+2*y))),(0,r.replaceChildren)(e,[v]);var C=new p.SvgSink(u,v,this.renderHost,this.activitySink);if(C.render(),o){var b=new s.Interactivity(o.data),E=this.renderHost.isFeatureEnabled("EnableTooltips",!1)?new l.SvgTooltip(v):new m.NullTooltip(v),A=new f.NotifyingSelector(new g.SvgSelector(v,this.renderHost),(function(e,t){return a.notifySelectionChanged(e,t)}),(function(e){return a.notifyDoubleClick(e)}),(function(e,t,n,o){return a.notifyManualPlacement(e,t,n,o)}),(function(e){return a.notifyEmbeddedContentLoad(e)}));A.setHandles(C.getHandles()),A.setPathWidths(C.getPathWidths()),this.renderHost.isFeatureEnabled(t.inPlaceTextEditingFG,!1)&&A.loadEmbeddedContent(C.getEmbeddedContentCollection());var S=new c.InteractivityManager(E,A,b.getRoot(),this.renderHost);C.addObserver(S),this.interactivityManager=S}},e.prototype.renderImage=function(e,t){if("string"!=typeof t.data)throw new Error("Invalid image.");var n="data:image"===t.data.substring(0,10)?t.data:"data:image/png;base64,".concat(t.data),o=document.createElement("img");o.alt="Chart",o.src=n,(0,r.replaceChildren)(e,[o])},e.prototype.renderJson=function(e,t){var n=document.createElement("pre");n.innerText=JSON.stringify(t.data,null,2),(0,r.replaceChildren)(e,[n])},e.prototype.setAndNotifyStatus=function(e){if(this.renderingStatus!==e)switch(this.renderingStatus=e,this.renderingStatus){case o.Rendering:this.notifyStateChanged("start");break;case o.Finished:this.notifyStateChanged("finish")}},e.prototype.notifyStateChanged=function(e){this.listeners[e]&&this.listeners[e](e,this.renderingStatus)},e.prototype.handleActivity=function(e){e.isSuccess?this.notifyLog(JSON.stringify(e)):this.notifyError(JSON.stringify(e))},e.prototype.notifyLog=function(e){this.listeners.log&&this.listeners.log("log",e)},e.prototype.notifyError=function(e){this.listeners.error&&this.listeners.error("error",e)},e.prototype.notifySelectionChanged=function(e,t){this.listeners.select&&this.listeners.select("select",e,t)},e.prototype.notifyDoubleClick=function(e){this.listeners.dblclick&&this.listeners.dblclick("dblclick",e)},e.prototype.notifyEmbeddedContentLoad=function(e){this.listeners.embeddedContentLoad&&this.listeners.embeddedContentLoad("embeddedContentLoad",e)},e.prototype.notifyManualPlacement=function(e,t,n,o){this.listeners.placement&&this.listeners.placement("placement",e,t,n,o)},e}();t.ChartPlayer=b},5753:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createStrokeDashArray=void 0;var o=n(61269);t.createStrokeDashArray=function(e,t,n){var r=function(e){switch(e){case o.LineDashType.Dash:return[4,3];case o.LineDashType.Dot:return[1,3];case o.LineDashType.DashDot:return[4,3,1,3];case o.LineDashType.DashDotDot:return[4,3,1,3,1,3];case o.LineDashType.RoundDot:return[1,1];case o.LineDashType.SquareDot:return[3,1];case o.LineDashType.LongDash:return[8,3];case o.LineDashType.LongDashDot:return[8,3,1,3];case o.LineDashType.LongDashDotDot:return[8,3,1,3,1,3];case o.LineDashType.Solid:default:return[0]}}(e);return n===o.LineCapType.Flat?r.map((function(e){return e*t})):r.map((function(e,t){return t%2==0?e-1:e+1})).map((function(e){return e*t}))}},51115:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultRenderHost=void 0;var n=function(){function e(){}return e.prototype.renderCustomData=function(e,t){},e.prototype.isFeatureEnabled=function(e,t){return t},e.prototype.setFeatureIsEnabled=function(e,t){throw new Error("DefaultRenderHost does not allow setting feature enablement.")},e}();t.DefaultRenderHost=n},1056:(e,t)=>{function n(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function o(e,t){n(e),t.forEach((function(t){e.appendChild(t)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.hitTestingClassName=t.customDataClassName=t.scale2DCanvasContextByDevicePixelRatio=t.createCanvas=t.getOffsetInRect=t.getParentElement=t.replaceChildren=t.removeChildren=void 0,t.removeChildren=n,t.replaceChildren=o,t.getParentElement=function(e){var t=e.parentNode;if((null==t?void 0:t.nodeType)===Node.ELEMENT_NODE)return t},t.getOffsetInRect=function(e,t,n){return{x:t-e.left,y:n-e.top}},t.createCanvas=function(e,t,n){var r=document.createElement("canvas"),i=window.devicePixelRatio||1;return r.style.width="".concat(t,"px"),r.style.height="".concat(n,"px"),r.width=t*i,r.height=n*i,o(e,[r]),r},t.scale2DCanvasContextByDevicePixelRatio=function(e){var t=window.devicePixelRatio||1;e.scale(t,t)},t.customDataClassName="custom-data",t.hitTestingClassName="hit-test"},50556:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.xlinkns=t.svgns=void 0,t.svgns="http://www.w3.org/2000/svg",t.xlinkns="http://www.w3.org/1999/xlink"},63222:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EderaLayoutProvider=void 0;var o=n(74165),r=function(){function e(e){var t,n;this.extensionsUrl=null!==(t=e.extensionsUrl)&&void 0!==t?t:"".concat(e.base,"/charts/extensions?clientId=").concat(e.clientId),this.layoutUrl=null!==(n=e.layoutUrl)&&void 0!==n?n:"".concat(e.base,"/charts?clientId=").concat(e.clientId)}return e.prototype.getExtensions=function(e){this.get(this.extensionsUrl,e)},e.prototype.getResource=function(e,t,n){t===o.IvyRenderer.Image?this.getImage(e,n):this.getJson(e,n)},e.prototype.getImage=function(e,t){this.callPost("image/png",e,t)},e.prototype.getJson=function(e,t){this.callPost("application/json",e,t)},e.prototype.callPost=function(e,t,n){this.post(this.layoutUrl,e,t,n)},e.prototype.post=function(e,t,n,o){var r=new XMLHttpRequest;r.open("POST",e),r.setRequestHeader("Accept",t),r.setRequestHeader("Content-Type","text/plain"),r.send(JSON.stringify(n)),this.completeAjax(r,this.callbackWrapper(o))},e.prototype.callbackWrapper=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.apply(this,[t[0],{chartResource:t[1]}])}},e.prototype.get=function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.send(null),this.completeAjax(n,t)},e.prototype.completeAjax=function(e,t){e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&(200===e.status?t(null,JSON.parse(e.responseText)):t("Edera RequestFailed StatusCode: ".concat(e.status),null))}},e}();t.EderaLayoutProvider=r},28128:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getElementIdFromDomId=t.isDatapointDomId=t.isElementDomId=t.getDomIdFromElementId=void 0,t.getDomIdFromElementId=function(e){return"ce".concat(e)};var n=/^ce([\w.]+)(-\d)?$/,o=/^ce([\w.]+)(-\d+)$/;t.isElementDomId=function(e){return n.test(e)},t.isDatapointDomId=function(e){return o.test(e)},t.getElementIdFromDomId=function(e){var t;return null===(t=n.exec(e))||void 0===t?void 0:t[1]}},27940:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isExperimentalText=void 0,t.isExperimentalText=function(e){return Array.isArray(e.lines)}},24109:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExpiringValue=void 0;var n=function(){function e(e){this.resetTimer=0,this.initial=e,this.value=e}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e,t){var n=this;clearTimeout(this.resetTimer),this.value=e;this.resetTimer=setTimeout((function(){return n.reset()}),t)},e.prototype.reset=function(){clearTimeout(this.resetTimer),this.value=this.initial},e}();t.ExpiringValue=n},51559:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WaterfallSeriesLayout=t.FunnelSeriesLayout=t.ColumnStacked100SeriesLayout=t.ColumnStackedSeriesLayout=t.ColumnClusteredSeriesLayout=t.LineStacked100SeriesLayout=t.LineStackedSeriesLayout=t.LineSeriesLayout=t.RadarFilledSeriesLayout=t.RadarSeriesLayout=t.AreaStacked100SeriesLayout=t.AreaStackedSeriesLayout=t.AreaSeriesLayout=t.StreamgraphLayout=t.ScatterSeriesLayout=t.SunburstSeriesLayout=t.TreemapSeriesLayout=t.RoseSeriesLayout=t.PieSubsliceSeriesLayout=t.PieSeriesLayout=t.DoughnutSeriesLayout=t.MapSeriesLayout=t.WordCloudSeriesLayout=t.BarStacked100SeriesLayout=t.BarStackedSeriesLayout=t.BarClusteredSeriesLayout=t.BoxWhiskerSeriesLayout=t.BulletHorizontalLayout=t.BubbleSeriesLayout=void 0,t.BubbleSeriesLayout={Canonical:"Bubble",Id:"Bubble|6646C07F-EE69-4C50-8884-14E2C12A8A9C"},t.BulletHorizontalLayout={Canonical:"Bullet Horizontal",Id:"Bullet Horizontal|9A25A13C-AB3E-4EF8-A1D9-39D9CCC37B8B"},t.BoxWhiskerSeriesLayout={Canonical:"Box-and-Whisker",Id:"Box-and-Whisker|14CC8215-BA99-43D8-9BE9-B8DBA7AD0F38"},t.BarClusteredSeriesLayout={Canonical:"Bar Clustered",Id:"Bar Clustered|E3705380-245A-4853-B6AA-83835693455E"},t.BarStackedSeriesLayout={Canonical:"Bar Stacked",Id:"Bar Stacked|EC5331C8-5FF9-4616-9FFA-6C75564A2351"},t.BarStacked100SeriesLayout={Canonical:"Bar Stacked (100%)",Id:"Bar Stacked (100%)|97A63078-E257-49FA-A446-87127409FDE1"},t.WordCloudSeriesLayout={Canonical:"Word Cloud",Id:"Word Cloud|C430CFE8-79A1-4D29-9CC9-E3684ADC40A9"},t.MapSeriesLayout={Canonical:"Map",Id:"Map|7C2B0DE5-DA0B-4699-9363-55B47CE0D858"},t.DoughnutSeriesLayout={Canonical:"Doughnut",Id:"Doughnut|2370A541-66E7-41A5-9C91-F652C321ECB4"},t.PieSeriesLayout={Canonical:"Pie",Id:"Pie|0ACFABC7-B08C-4B76-B4F0-CE04A553FE7B"},t.PieSubsliceSeriesLayout={Canonical:"Pie Subslice",Id:"Pie Subslice|87B522EA-8314-474F-A4A5-C496B913EB4A"},t.RoseSeriesLayout={Canonical:"Rose",Id:"Rose|7FB5902D-B5B1-4F68-9C44-019E0737EFE0"},t.TreemapSeriesLayout={Canonical:"Treemap",Id:"Treemap|46C6B32F-E068-4797-B132-46134DDE3841"},t.SunburstSeriesLayout={Canonical:"Sunburst",Id:"Sunburst|EB06F640-38E2-40E2-B7D7-B2CAA15A9888"},t.ScatterSeriesLayout={Canonical:"Scatter",Id:"Scatter|E5E0729E-3F80-40FE-BAD9-B2C1FC0C48DF"},t.StreamgraphLayout={Canonical:"Streamgraph",Id:"Streamgraph|C1BBDE14-A890-4AE1-BAE5-9E712511FB49"},t.AreaSeriesLayout={Canonical:"Area",Id:"Area|89C5F39D-8367-4002-B161-7317E84B765A"},t.AreaStackedSeriesLayout={Canonical:"Area Stacked",Id:"Area Stacked|559EE575-F359-4C18-A578-95DDF77451D4"},t.AreaStacked100SeriesLayout={Canonical:"Area Stacked (100%)",Id:"Area Stacked (100%)|310E5127-9664-483E-B00D-43661237ED58"},t.RadarSeriesLayout={Canonical:"Radar",Id:"Radar|807D8333-019F-4585-803D-D3E7B910A21F"},t.RadarFilledSeriesLayout={Canonical:"Radar Filled",Id:"Radar Filled|EA4BD985-602D-4D31-A381-5D03785A72D3"},t.LineSeriesLayout={Canonical:"Line",Id:"Line|0835421C-BB45-4049-B5A1-01A910FA5786"},t.LineStackedSeriesLayout={Canonical:"Line Stacked",Id:"Line Stacked|D6EC4F15-AA43-4EB2-AC1E-7598CB3C730B"},t.LineStacked100SeriesLayout={Canonical:"Line Stacked (100%)",Id:"Line Stacked (100%)|74199267-AFC6-47FE-8360-CBDE0AD03D92"},t.ColumnClusteredSeriesLayout={Canonical:"Column Clustered",Id:"Column Clustered|66CD2202-3E02-411B-B0C8-80F648956105"},t.ColumnStackedSeriesLayout={Canonical:"Column Stacked",Id:"Column Stacked|AFB97C4F-15E7-4492-B85F-F07F1CDCE9E9"},t.ColumnStacked100SeriesLayout={Canonical:"Column Stacked (100%)",Id:"Column Stacked (100%)|D4F12861-68F0-418A-A140-486C9B328FC0"},t.FunnelSeriesLayout={Canonical:"Funnel",Id:"Funnel|73edc3b8-0194-4fb7-b180-9745cfa4b3ed"},t.WaterfallSeriesLayout={Canonical:"Waterfall",Id:"Waterfall|EB06F640-38E2-40E2-B7D7-B2CAA15A9888"}},37743:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateUniqueId=void 0;var n=0;t.generateUniqueId=function(){var e=++n;return"MSChart-".concat(e.toString())}},23440:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Experimental=t.Utils=t.Extensions=void 0;var o=n(79490);o.__exportStar(n(56877),t),o.__exportStar(n(51883),t),o.__exportStar(n(27672),t),o.__exportStar(n(33182),t),o.__exportStar(n(77952),t),o.__exportStar(n(8485),t);var r=n(51559);t.Extensions=r;var i=n(52457);t.Utils=i;var a=n(27940);t.Experimental=a,o.__exportStar(n(61269),t),o.__exportStar(n(74165),t),o.__exportStar(n(36182),t),o.__exportStar(n(42333),t),o.__exportStar(n(63222),t),o.__exportStar(n(75460),t),o.__exportStar(n(32744),t)},66291:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HandleSink=void 0;var o=n(79490),r=function(){function e(){this.handles=[]}return e.prototype.getHandles=function(){return o.__spreadArray([],this.handles,!0)},e.prototype.reset=function(){this.handles=[]},e.prototype.beginGeometry=function(e){return!0},e.prototype.endGeometry=function(){return!0},e.prototype.beginPath=function(e){return!0},e.prototype.endPath=function(){return!0},e.prototype.beginFigure=function(e,t,n){return this.handles.push(e),!0},e.prototype.endFigure=function(e){return!0},e.prototype.addLines=function(e){return this.handles=this.handles.concat(e),!0},e.prototype.addBeziers=function(e){var t=e.filter((function(e,t){return(t+1)%3==0}));return this.handles=this.handles.concat(t),!0},e.prototype.addEscape=function(e,t){return!0},e}();t.HandleSink=r},51678:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveElement=void 0;var o=n(61269),r=n(28626),i=function(){function e(e,t){this.element=e,this.parentId=t}return e.prototype.getId=function(){return this.element.id},e.prototype.getParentId=function(){return this.parentId},e.prototype.getDescription=function(){return this.element.description},e.prototype.getOnlyShowText=function(){return!!this.element.onlyShowText&&this.element.onlyShowText},e.prototype.hasDescription=function(){return"string"==typeof this.element.description},e.prototype.getChildren=function(){var t=this;return this.element.children?this.element.children.map((function(n){return new e(n,t.element.id)})):[]},e.prototype.getDatapointChildren=function(){var e=this;return this.element.datapointChildren?this.element.datapointChildren.map((function(t){return new r.InteractiveElementDatapoint(t,e.element.id)})):[]},e.prototype.getSelectionHandleOption=function(){return this.element.selectionHandleOption?this.element.selectionHandleOption:o.SelectionHandleOption.All},e.prototype.supportsManualPlacement=function(){return!!this.element.supportsManualPlacement},e}();t.InteractiveElement=i},28626:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveElementDatapoint=void 0;var o=n(10894),r=function(){function e(e,t){this.element=e,this.parentId=t}return e.prototype.getIndex=function(){return this.element.index},e.prototype.getId=function(){return this.parentId.concat("-",this.element.index.toString())},e.prototype.getParentId=function(){return this.parentId},e.prototype.getTitle=function(){return this.element.title},e.prototype.getDescription=function(){return this.element.description?this.element.description.map((function(e){return new o.InteractiveElementDatapointDescription(e)})):[]},e.prototype.hasTooltip=function(){return"string"==typeof this.element.title||this.getDescription().length>0},e.prototype.getDatapointChildren=function(){var t=this;return this.element.children?this.element.children.map((function(n){return new e(n,t.getId())})):[]},e}();t.InteractiveElementDatapoint=r},10894:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InteractiveElementDatapointDescription=void 0;var n=function(){function e(e){this.element=e}return e.prototype.getHeading=function(){return this.element.heading},e.prototype.getValue=function(){return this.element.value},e}();t.InteractiveElementDatapointDescription=n},73927:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Interactivity=void 0;var o=n(51678),r=function(){function e(e){this.root=new o.InteractiveElement(e.root)}return e.prototype.getRoot=function(){return this.root},e}();t.Interactivity=r},66796:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InteractivityManager=void 0;var o,r=n(16460),i=n(51678),a=n(28626),s=n(49991),l=n(24109),c=n(61269),u=n(28128),d=n(94295),p=n(42333);!function(e){e[e.None=0]="None",e[e.ChartElement=1]="ChartElement",e[e.Datapoint=2]="Datapoint",e[e.Count=3]="Count"}(o||(o={}));var h=function(){function e(e,t,n,r){this.tooltips={},this.datapointTooltips={},this.tooltipType=o.None,this.delayDatapointTooltip=new l.ExpiringValue(!0),this.selectables={},this._isEnabled=!0,this.dragInProcess=void 0,this.keyMoveInProcess=void 0,this.keyboardOperationDelay=void 0,this.dragStartX=void 0,this.dragStartY=void 0,this.initialDragStartX=0,this.initialDragStartY=0,this.tooltip=e,this.selector=t,this.root=n,this.renderHost=r,this.cacheTooltipText(n),this.rootSelectable={element:n,children:[]},this.cacheSelectables(n,this.rootSelectable.children,this.rootSelectable)}return Object.defineProperty(e.prototype,"isEnabled",{set:function(e){e!==this._isEnabled&&(e||(this.hover(void 0),this.selector.deselect(),this.removeTooltips()),this._isEnabled=e)},enumerable:!1,configurable:!0}),e.prototype.receiveMouseOver=function(e){var t=this;if(this._isEnabled){var n=e.target?this.getSelectionCandidateId(e.target):void 0,r=this.getTargetDatapointId(e);if(r&&this.isDatapointId(r)){var i=this.getInteractiveDatapoint(r),a=i?i.getParentId():void 0,s=this.selector.getSelectedId();if(s&&this.isDatapointId(s)){var l=this.getInteractiveDatapoint(s);s=l?l.getParentId():void 0}if(s&&a===s&&(n=r),i){this.tooltipType=o.Datapoint;var c=i.getTitle();this.tooltip.setHeader(c||""),i.getDescription().forEach((function(e){t.tooltip.addPair(e.getHeading(),e.getValue())})),this.showDatapointTooltip(e)}}this.hover(n)}},e.prototype.receivePointerMove=function(e,t){this._isEnabled&&this.handleMovement(e,t)},e.prototype.receiveMouseMove=function(e){this._isEnabled&&this.handleMovement(e,r.PointerType.Mouse)},e.prototype.receiveMouseOut=function(){this._isEnabled&&(this.hover(void 0),this.removeTooltips())},e.prototype.receivePointerDown=function(e,t){if(this._isEnabled){if(this.renderHost&&this.renderHost.isFeatureEnabled(p.manualPlacementFG,!1)){var n=e.target?this.getSelectionCandidateId(e.target):void 0;if(n){var o=this.getInteractiveElement(this.root,n);this.selector.getSelectedId()===n&&(null==o?void 0:o.supportsManualPlacement())&&this.startDrag(e)}}var i=(0,r.convertInputTypeToEnum)(t);this.handleSelection(e,i)}},e.prototype.receiveMouseUp=function(e){if(this._isEnabled&&this.renderHost&&this.renderHost.isFeatureEnabled(p.manualPlacementFG,!1)&&e.isLeftClickReleased&&this.dragInProcess&&this.dragStartX&&this.dragStartY){var t=this.dragStartX-this.initialDragStartX,n=this.dragStartY-this.initialDragStartY;this.selector.finalizePlacement(this.dragInProcess,t,n)}},e.prototype.receiveDoubleClick=function(e){if(this._isEnabled){var t=e.target?this.getSelectionCandidateId(e.target):void 0;t?(this.selector.doubleClick(t),this.handleSelection(e,r.InputType.Mouse),e.stopPropagation()):this.selector.doubleClick(void 0)}},e.prototype.receiveKeyDown=function(e,t){switch(e){case"Tab":t?this.selectPreviousSibling():this.selectNextSibling();break;case"Enter":this.selectFirstChild();break;case"Escape":this.isElementMovementInProgress()?this.restoreElementPosition():this.selectParent();break;case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":this.moveElementByKey(e)}},e.prototype.select=function(e,t){if(this._isEnabled){if(e===this.selector.getSelectedId())return;if(e&&e in this.selectables){var n=!1,o=c.SelectionHandleOption.All,r=this.getInteractiveElement(this.root,e);if(e){if(!r)throw new Error("Invalid selection.");n=r.getOnlyShowText(),o=r.getSelectionHandleOption()}this.currentSelectable=this.selectables[e].value,this.selector.select(e,n,o,t,null==r?void 0:r.supportsManualPlacement())}else this.selector.deselect(t)}},e.prototype.selectParent=function(){if(this._isEnabled&&this.rootSelectable&&0!==Object.keys(this.selectables).length&&this.selector.getSelectedId()){this.renderHost&&this.renderHost.isFeatureEnabled(p.manualPlacementFG,!0)&&this.restorePlacement();var e=this.currentSelectable;if(e){var t=e.parent;if(t&&t!==this.rootSelectable){var n=t.element;if(n instanceof i.InteractiveElement){var o=c.SelectionHandleOption.All;o=n.getSelectionHandleOption(),this.currentSelectable=t,this.selector.select(n.getId(),!1,o,r.InputType.Keyboard,null==n?void 0:n.supportsManualPlacement())}}else this.select(void 0,void 0),this.currentSelectable=void 0}}},e.prototype.selectFirstChild=function(){var e,t,n;if(this._isEnabled&&this.rootSelectable&&0!==Object.keys(this.selectables).length){var o=this.selector.getSelectedId();this.endDrag();var i=o?this.currentSelectable:this.rootSelectable;if(i&&(!o||o===i.element.getId())){var a=i.children;if(a)if(o&&(null===(e=this.getInteractiveElement(this.root,o))||void 0===e?void 0:e.getSelectionHandleOption())===c.SelectionHandleOption.UIControl)this.currentSelectable=this.selectables[o].value,this.selector.select(o,!1,c.SelectionHandleOption.UIControl,r.InputType.Keyboard,null===(t=this.getInteractiveElement(this.root,o))||void 0===t?void 0:t.supportsManualPlacement());else if(a.length>0){var s=a[0],l=s.element.getId();o?this.selector.selectionSupported(l)&&(this.currentSelectable=s,this.selector.select(l,!1,c.SelectionHandleOption.All,r.InputType.Keyboard,null===(n=this.getInteractiveElement(this.root,l))||void 0===n?void 0:n.supportsManualPlacement())):this.select(l,r.InputType.Keyboard)}}}},e.prototype.selectNextSibling=function(){this.selectSibling(!0)},e.prototype.selectPreviousSibling=function(){this.selectSibling(!1)},e.prototype.getDescription=function(){var e,t,n=this.selector.getSelectedId();if(!n)return this.root.getDescription();if(this.isDatapointId(n)){var o=this.getInteractiveDatapoint(n);return null!==(t=null===(e=null==o?void 0:o.getDescription()[0])||void 0===e?void 0:e.getValue())&&void 0!==t?t:""}var r=this.getInteractiveElement(this.root,n);if(!r)throw new Error("Invalid selection.");return r.getDescription()},e.prototype.getSelectionBounds=function(){var e=this.selector.getCurrentSelectionBounds();return JSON.stringify(e)},e.prototype.getDatapointId=function(e,t){return e.concat("-",t.toString())},e.prototype.getInteractiveDatapoint=function(e){if(e&&e in this.selectables){var t=this.selectables[e].value.element;return t instanceof a.InteractiveElementDatapoint?t:void 0}},e.prototype.getDragStatus=function(){return this.dragInProcess},e.prototype.getDragStartX=function(){return this.dragStartX},e.prototype.isElementMovementInProgress=function(){return null!==this.dragInProcess&&void 0!==this.dragInProcess||null!==this.keyMoveInProcess&&void 0!==this.keyMoveInProcess},e.prototype.restoreElementPosition=function(){this.restorePlacement()},e.prototype.moveElementByKey=function(e){var t,n,o=this,i=this.selector.getSelectedId();if(i){var a=this.getInteractiveElement(this.root,i);if(a&&(null==a?void 0:a.supportsManualPlacement())){switch(this.keyMoveInProcess||(this.keyMoveInProcess=i,t=this.selector.getPosition(i),this.initialDragStartX=t[0],this.initialDragStartY=t[1]),this.keyboardOperationDelay&&clearTimeout(this.keyboardOperationDelay),this.keyboardOperationDelay=setTimeout((function(){if(o.dragStartX&&o.dragStartY&&o.keyMoveInProcess){var e=o.dragStartX-o.initialDragStartX,t=o.dragStartY-o.initialDragStartY;o.selector.finalizePlacement(o.keyMoveInProcess,e,t)}}),1e3),e){case"ArrowDown":this.selector.movePlacement(i,0,1,r.InputType.Keyboard);break;case"ArrowLeft":this.selector.movePlacement(i,-1,0,r.InputType.Keyboard);break;case"ArrowRight":this.selector.movePlacement(i,1,0,r.InputType.Keyboard);break;case"ArrowUp":this.selector.movePlacement(i,0,-1,r.InputType.Keyboard)}n=this.selector.getPosition(i),this.dragStartX=n[0],this.dragStartY=n[1]}}},e.prototype.hover=function(e){var t=this;if(this.hoverTimer&&clearTimeout(this.hoverTimer),e){var n=this.getInteractiveElement(this.root,e);if(!n)throw new Error("Invalid selection.");this.hoverTimer=(0,d.wrapTimeout)((function(){return t.selector.hover(e,n.getOnlyShowText(),n.getSelectionHandleOption())}),16)}else this.selector.unhover()},e.prototype.getTargetDatapointId=function(e){if(e.target&&void 0!==e.datapointId)return e.datapointId},e.prototype.getInteractiveElement=function(e,t){if(e.getId()===t)return e;var n;if(this.isDatapointId(t)){var o=this.getInteractiveDatapoint(t);n=o?o.getParentId():void 0}else n=t;if(n&&n in this.selectables){var r=this.selectables[n].value;if(r.element instanceof i.InteractiveElement)return r.element}},e.prototype.removeTooltips=function(){this.tooltipType===o.Datapoint&&this.tooltip.isVisible()&&this.delayDatapointTooltip.setValue(!1,250),this.tooltipType=o.None,clearTimeout(this.showTooltipTimer),this.showTooltipTimer=0,this.tooltip.hide(),this.tooltip.removePairs()},e.prototype.cacheTooltipText=function(e){var t=this,n=e.getId(),o=e.getDescription();o&&(this.tooltips[(0,u.getDomIdFromElementId)(n)]=o),e.getChildren().forEach((function(e){t.cacheTooltipText(e)})),e.getDatapointChildren().filter((function(e){return e.hasTooltip()})).forEach((function(e){t.datapointTooltips[(0,u.getDomIdFromElementId)(e.getId())]=e}))},e.prototype.cacheSelectables=function(e,t,n){var o=this;e.getChildren().forEach((function(e){var r,i={element:e};t&&t.push(i);var a=[];o.cacheSelectables(e,a,i),a.length>0&&(i.children=a),n&&(i.parent=n),o.selectables[e.getId()]={value:i};var s=e.getDatapointChildren();if(s.length>0&&i){var l=[];o.cacheSelectableDatapoints(s,l,i),l.length>0&&(i.children?(r=i.children).push.apply(r,l):i.children=l)}}))},e.prototype.cacheSelectableDatapoints=function(e,t,n){var o=this;e&&e.length>0&&e.forEach((function(e){var r={element:e,parent:n};o.selectables[e.getId()]={value:r},t.push(r)}))},e.prototype.getSelectionCandidateId=function(e){for(var t=e;t&&!(t.getId()in this.selectables);)t=t.getParent();if(t)return t.getId()},e.prototype.showDatapointTooltip=function(e){this.tooltip.setPosition(e.x,e.y),this.tooltip.isVisible()||this.tooltip.isOversized()||this.showTooltip(!this.delayDatapointTooltip.getValue(),s.TooltipOffset.Above)},e.prototype.showNonDatapointTooltip=function(e){this.tooltip.isVisible()||(this.tooltip.setPosition(e.x,e.y),this.showTooltip(!1,s.TooltipOffset.BelowRight))},e.prototype.showTooltip=function(e,t){var n=this,o=function(){n.tooltip.setOffset(t),n.tooltip.show()};e?o():(clearTimeout(this.showTooltipTimer),this.showTooltipTimer=setTimeout(o,250))},e.prototype.selectSibling=function(e){if(this._isEnabled&&this.rootSelectable&&0!==Object.keys(this.selectables).length&&this.currentSelectable){var t=this.selector.getSelectedId();if(t&&(this.endDrag(),t in this.selectables||this.currentSelectable.element.getId()===t)){var n=this.getSiblings(this.currentSelectable);if(1!==n.length||n[0]!==this.currentSelectable){var o=n.length>0?n.indexOf(this.currentSelectable):-1;if(o<0)throw new Error("Invalid selection.");var i=o;i=e?o===n.length-1?0:i+1:0===o?n.length-1:i-1,this.select(n[i].element.getId(),r.InputType.Keyboard)}}}},e.prototype.handleSelection=function(e,t){var n,o,i=e.target?this.getSelectionCandidateId(e.target):void 0,a=this.getTargetDatapointId(e),s=i;if(a&&!0!==e.isRightClick){var l=this.getInteractiveDatapoint(a);if(l){var u=l.getParentId(),d=this.selector.getSelectedId();(d===u||d&&this.isDatapointId(d)&&d!==a&&(null===(n=this.getInteractiveDatapoint(d))||void 0===n?void 0:n.getParentId())===u)&&(s=a)}}void 0!==s?(this.renderHost&&this.renderHost.isFeatureEnabled(p.manualPlacementFG,!1)&&this.selector.getSelectedId()!==i&&this.resetDrag(),(this.selector.getSelectedId()!==s||t===r.InputType.Touch||(null===(o=this.getInteractiveElement(this.root,s))||void 0===o?void 0:o.getSelectionHandleOption())===c.SelectionHandleOption.UIControl)&&this.selectElement(s,t),e.stopPropagation()):(this.renderHost&&this.renderHost.isFeatureEnabled(p.manualPlacementFG,!1)&&this.resetDrag(),this.selector.deselect(t))},e.prototype.selectElement=function(e,t){var n=this.getInteractiveElement(this.root,e);if(!n)throw new Error("Invalid selection.");this.currentSelectable=this.selectables[e].value,this.selector.select(e,n.getOnlyShowText(),n.getSelectionHandleOption(),t,n.supportsManualPlacement())},e.prototype.startDrag=function(e){this.keyMoveInProcess=void 0,this.dragInProcess=void 0,this.dragStartX=void 0,this.dragStartY=void 0;var t=e.target?this.getSelectionCandidateId(e.target):void 0;this.dragStartX=e.x,this.dragStartY=e.y,this.initialDragStartX=e.x,this.initialDragStartY=e.y,t&&(this.dragInProcess=t)},e.prototype.onDrag=function(e,t){if(this.dragInProcess&&this.dragStartX&&this.dragStartY){var n=e.x-this.dragStartX,o=e.y-this.dragStartY,i=(0,r.convertInputTypeToEnum)(t);this.selector.movePlacement(this.dragInProcess,n,o,i)}this.dragStartX=e.x,this.dragStartY=e.y},e.prototype.endDrag=function(){if(this.dragInProcess&&this.dragStartX&&this.dragStartY){var e=this.dragStartX-this.initialDragStartX,t=this.dragStartY-this.initialDragStartY;this.selector.finalizePlacement(this.dragInProcess,e,t)}this.resetDrag()},e.prototype.resetDrag=function(){this.keyMoveInProcess=void 0,this.dragInProcess=void 0,this.dragStartX=void 0,this.dragStartY=void 0,this.initialDragStartX=0,this.initialDragStartY=0,this.selector.resetSelectionPosition()},e.prototype.restorePlacement=function(){if(this.dragStartX&&this.dragStartY){var e=this.initialDragStartX-this.dragStartX,t=this.initialDragStartY-this.dragStartY;this.dragInProcess?this.selector.movePlacement(this.dragInProcess,e,t,r.InputType.Mouse):this.keyMoveInProcess&&this.selector.movePlacement(this.keyMoveInProcess,e,t,r.InputType.Keyboard)}this.resetDrag()},e.prototype.handleMovement=function(e,t){if(this._isEnabled){var n=e.target?this.getSelectionCandidateId(e.target):void 0,r=this.getTargetDatapointId(e);if(this.renderHost&&this.renderHost.isFeatureEnabled(p.manualPlacementFG,!1)&&e.isLeftClick)this.onDrag(e,t);else if(r&&this.isDatapointId(r))n=r;else switch(this.hover(n),this.tooltipType){case o.ChartElement:this.showNonDatapointTooltip(e);break;case o.Datapoint:this.showDatapointTooltip(e)}}},e.prototype.getSiblings=function(e){var t=e.parent;if(!t)return[e];var n=t.children;return n||[e]},e.prototype.isDatapointId=function(e){return!!e&&(e in this.selectables&&this.selectables[e].value.element instanceof a.InteractiveElementDatapoint)},e}();t.InteractivityManager=h},86954:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NotifyingSelector=void 0;var n=function(){function e(e,t,n,o,r){this.wrapped=e,this.selectCallback=t,this.doubleClickCallback=n,this.manualPlacementCallback=o,this.loadEmbeddedContentCallback=r}return e.prototype.movePlacement=function(e,t,n,o){this.wrapped.movePlacement(e,t,n,o)},e.prototype.finalizePlacement=function(e,t,n){0===t&&0===n||this.manualPlacementCallback(e,t,n,this.getPlacementInputType())},e.prototype.resetSelectionPosition=function(){this.wrapped.resetSelectionPosition()},e.prototype.doubleClick=function(e){this.doubleClickCallback(e)},e.prototype.select=function(e,t,n,o,r){this.wrapped.select(e,t,n,o,r),this.selectCallback(e,o)},e.prototype.loadEmbeddedContent=function(e){this.loadEmbeddedContentCallback(JSON.stringify(e))},e.prototype.deselect=function(e){this.wrapped.deselect(e),this.selectCallback(void 0,e)},e.prototype.getSelectedId=function(){return this.wrapped.getSelectedId()},e.prototype.getCurrentSelectionBounds=function(){return this.wrapped.getCurrentSelectionBounds()},e.prototype.getPosition=function(e){return this.wrapped.getPosition(e)},e.prototype.hover=function(e,t,n){this.wrapped.hover(e,t,n)},e.prototype.unhover=function(){this.wrapped.unhover()},e.prototype.setHandles=function(e){this.wrapped.setHandles(e)},e.prototype.setPathWidths=function(e){this.wrapped.setPathWidths(e)},e.prototype.selectionSupported=function(e){return this.wrapped.selectionSupported(e)},e.prototype.getPlacementInputType=function(){return this.wrapped.getPlacementInputType()},e}();t.NotifyingSelector=n},63444:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullTooltip=void 0;var n=function(){function e(e){this.rootElement=e}return e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.isVisible=function(){return!1},e.prototype.isOversized=function(){return!1},e.prototype.setPosition=function(e,t){},e.prototype.setOffset=function(e){},e.prototype.setHeader=function(e){},e.prototype.addPair=function(e,t){},e.prototype.removePairs=function(){},e.prototype.getRoot=function(){return this.rootElement},e}();t.NullTooltip=n},16460:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.convertInputTypeToEnum=t.PointerType=t.InputType=void 0,function(e){e.Mouse="Mouse",e.Touch="Touch",e.Keyboard="Keyboard"}(n=t.InputType||(t.InputType={})),function(e){e.Mouse="Mouse",e.Touch="Touch"}(t.PointerType||(t.PointerType={})),t.convertInputTypeToEnum=function(e){switch(e.toLowerCase()){case"mouse":return n.Mouse;case"pen":case"touch":return n.Touch;case"keyboard":return n.Keyboard;default:throw new Error("InputType not supported")}}},49991:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TooltipOffset=void 0,function(e){e[e.Above=0]="Above",e[e.BelowRight=1]="BelowRight"}(t.TooltipOffset||(t.TooltipOffset={}))},27672:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TrendlineType=t.TickMarksLayoutType=t.TickLabelsPosition=t.ChartChildPositionOptions=t.EdgePosition=t.Edge=void 0,function(e){e[e.Left=0]="Left",e[e.Top=1]="Top",e[e.Right=2]="Right",e[e.Bottom=3]="Bottom",e[e.Count=4]="Count"}(t.Edge||(t.Edge={})),function(e){e[e.Minimum=0]="Minimum",e[e.Middle=1]="Middle",e[e.Maximum=2]="Maximum",e[e.Count=3]="Count"}(t.EdgePosition||(t.EdgePosition={})),function(e){e[e.None=0]="None",e[e.DoNotReserveSpace=1]="DoNotReserveSpace",e[e.RelativeToPlotArea=2]="RelativeToPlotArea",e[e.DoNotShareEdge=4]="DoNotShareEdge"}(t.ChartChildPositionOptions||(t.ChartChildPositionOptions={})),function(e){e.High="High",e.Low="Low",e.NextToAxis="NextToAxis"}(t.TickLabelsPosition||(t.TickLabelsPosition={})),function(e){e.Cross="Cross",e.Inside="Inside",e.Outside="Outside",e.None="None"}(t.TickMarksLayoutType||(t.TickMarksLayoutType={})),function(e){e.Linear="Linear",e.Polynomial="Polynomial",e.Exponential="Exponential",e.Logarithmic="Logarithmic",e.Power="Power",e.MovingAverage="MovingAverage"}(t.TrendlineType||(t.TrendlineType={}))},33182:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},56877:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ControlValue=t.ChartDataType=t.ChartDataDimension=void 0,function(e){e[e.None=0]="None",e[e.CategoryNames=1]="CategoryNames",e[e.Values=2]="Values",e[e.XValues=3]="XValues",e[e.YValues=4]="YValues",e[e.SizeValues=5]="SizeValues",e[e.OpenValues=6]="OpenValues",e[e.CloseValues=7]="CloseValues",e[e.HighValues=8]="HighValues",e[e.LowValues=9]="LowValues",e[e.RValues=10]="RValues",e[e.ThetaValues=11]="ThetaValues",e[e.ErrorBarsPosValues=12]="ErrorBarsPosValues",e[e.ErrorBarsNegValues=13]="ErrorBarsNegValues",e[e.CanvasXValues=14]="CanvasXValues",e[e.CanvasYValues=15]="CanvasYValues",e[e.ParentIndices=16]="ParentIndices",e[e.StringRenderingData=17]="StringRenderingData",e[e.DiscreteRenderingData=18]="DiscreteRenderingData",e[e.ContinuousRenderingData=19]="ContinuousRenderingData",e[e.CustomValues=20]="CustomValues",e[e.CustomStrings=21]="CustomStrings",e[e.DataIndex=22]="DataIndex",e[e.PartialValues=23]="PartialValues",e[e.ControlValues=24]="ControlValues",e[e.CategoryValues=25]="CategoryValues",e[e.CategoryWidths=26]="CategoryWidths",e[e.RegionIds=27]="RegionIds",e[e.Count=28]="Count"}(t.ChartDataDimension||(t.ChartDataDimension={})),function(e){e[e.Numeric=0]="Numeric",e[e.String=1]="String",e[e.Undefined=2]="Undefined",e[e.Count=3]="Count"}(t.ChartDataType||(t.ChartDataType={})),function(e){e[e.begin_GeneralControlValue=0]="begin_GeneralControlValue",e[e.Valid=0]="Valid",e[e.Invalid=1]="Invalid",e[e.end_GeneralControlValue=2]="end_GeneralControlValue",e[e.begin_StatisticalControlValue=100]="begin_StatisticalControlValue",e[e.LowOutlier=100]="LowOutlier",e[e.HighOutlier=101]="HighOutlier",e[e.LocalMinimum=102]="LocalMinimum",e[e.LocalMaximum=103]="LocalMaximum",e[e.Mean=104]="Mean",e[e.Median=105]="Median",e[e.Q1=106]="Q1",e[e.Q3=107]="Q3",e[e.Subtotal=108]="Subtotal",e[e.end_StatisticalControlValue=109]="end_StatisticalControlValue",e[e.end_ControlValue=110]="end_ControlValue"}(t.ControlValue||(t.ControlValue={}))},8485:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},61269:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PatternType=t.FontStyle=t.FontWeight=t.ParagraphAlignment=t.TextAlignment=t.ReadingDirection=t.SelectionHandleOption=t.LineEndSize=t.LineEndType=t.LineJoinType=t.LineCapType=t.LineDashType=t.LineDashStyle=t.isPatternFillFormat=t.isGradientFillFormat=t.isSolidFillFormat=t.isRadialGradientShade=t.isLinearGradientShade=t.GeometryEscape=t.FigureType=t.FillMode=t.GeometryOperation=void 0,function(e){e[e.BeginGeometry=0]="BeginGeometry",e[e.EndGeometry=1]="EndGeometry",e[e.BeginPath=2]="BeginPath",e[e.EndPath=3]="EndPath",e[e.BeginFigure=4]="BeginFigure",e[e.EndFigure=5]="EndFigure",e[e.AddLines=6]="AddLines",e[e.AddBeziers=7]="AddBeziers",e[e.AddEscape=8]="AddEscape"}(t.GeometryOperation||(t.GeometryOperation={})),function(e){e[e.Alternate=0]="Alternate",e[e.Winding=1]="Winding",e[e.Count=2]="Count"}(t.FillMode||(t.FillMode={})),function(e){e[e.Complex=0]="Complex",e[e.Rect=1]="Rect",e[e.Ellipse=2]="Ellipse",e[e.Point=3]="Point",e[e.Count=4]="Count"}(t.FigureType||(t.FigureType={})),function(e){e[e.MasterBegin=100]="MasterBegin",e[e.MasterEnd=101]="MasterEnd",e[e.Instance2D=102]="Instance2D",e[e.DatapointBegin=200]="DatapointBegin",e[e.DatapointEnd=201]="DatapointEnd",e[e.DatapointPoint=202]="DatapointPoint",e[e.ParentDatapoint=203]="ParentDatapoint",e[e.DatapointChildrenBegin=204]="DatapointChildrenBegin",e[e.DatapointChildrenEnd=205]="DatapointChildrenEnd",e[e.DataEdgeBegin=206]="DataEdgeBegin",e[e.DataEdgeEnd=207]="DataEdgeEnd",e[e.AggregateBegin=208]="AggregateBegin",e[e.AggregateEnd=209]="AggregateEnd",e[e.StringRenderingData=300]="StringRenderingData",e[e.DiscreteRenderingData=301]="DiscreteRenderingData",e[e.ResetStyleOverrides=400]="ResetStyleOverrides",e[e.LineColorOverride=401]="LineColorOverride",e[e.LineThicknessScaling=402]="LineThicknessScaling",e[e.LineDashStyleOverride=403]="LineDashStyleOverride",e[e.Max=1e4]="Max",e[e.ValuePoint=1e4]="ValuePoint",e[e.OriginPoint=10001]="OriginPoint"}(t.GeometryEscape||(t.GeometryEscape={})),t.isLinearGradientShade=function(e){return"number"==typeof e.angle},t.isRadialGradientShade=function(e){return"object"==typeof e.center},t.isSolidFillFormat=function(e){return"string"==typeof(null==e?void 0:e.color)},t.isGradientFillFormat=function(e){return Array.isArray(null==e?void 0:e.stops)},t.isPatternFillFormat=function(e){return"number"==typeof e.pattern},function(e){e[e.Solid=0]="Solid",e[e.Dash=1]="Dash",e[e.Dot=2]="Dot",e[e.DashDot=3]="DashDot",e[e.DashDotDot=4]="DashDotDot",e[e.Count=5]="Count"}(t.LineDashStyle||(t.LineDashStyle={})),function(e){e[e.Solid=0]="Solid",e[e.Dash=1]="Dash",e[e.Dot=2]="Dot",e[e.DashDot=3]="DashDot",e[e.DashDotDot=4]="DashDotDot",e[e.RoundDot=5]="RoundDot",e[e.SquareDot=6]="SquareDot",e[e.LongDash=7]="LongDash",e[e.LongDashDot=8]="LongDashDot",e[e.LongDashDotDot=9]="LongDashDotDot",e[e.Count=10]="Count"}(t.LineDashType||(t.LineDashType={})),function(e){e[e.Flat=0]="Flat",e[e.Square=1]="Square",e[e.Round=2]="Round",e[e.Count=3]="Count"}(t.LineCapType||(t.LineCapType={})),function(e){e[e.Round=0]="Round",e[e.Bevel=1]="Bevel",e[e.Miter=2]="Miter",e[e.Count=3]="Count"}(t.LineJoinType||(t.LineJoinType={})),function(e){e[e.None=0]="None",e[e.Triangle=1]="Triangle",e[e.Stealth=2]="Stealth",e[e.Diamond=3]="Diamond",e[e.Oval=4]="Oval",e[e.Arrow=5]="Arrow",e[e.Count=6]="Count"}(t.LineEndType||(t.LineEndType={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large",e[e.Count=3]="Count"}(t.LineEndSize||(t.LineEndSize={})),function(e){e[e.All=0]="All",e[e.EndPoints=1]="EndPoints",e[e.Maximum=2]="Maximum",e[e.UIControl=3]="UIControl",e[e.Count=4]="Count"}(t.SelectionHandleOption||(t.SelectionHandleOption={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.TopToBottom=2]="TopToBottom",e[e.BottomToTop=3]="BottomToTop",e[e.Count=4]="Count"}(t.ReadingDirection||(t.ReadingDirection={})),function(e){e[e.Leading=0]="Leading",e[e.Trailing=1]="Trailing",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Count=4]="Count"}(t.TextAlignment||(t.TextAlignment={})),function(e){e[e.Near=0]="Near",e[e.Far=1]="Far",e[e.Center=2]="Center",e[e.Count=3]="Count"}(t.ParagraphAlignment||(t.ParagraphAlignment={})),function(e){e[e.Thin=100]="Thin",e[e.ExtraLight=200]="ExtraLight",e[e.Light=300]="Light",e[e.SemiLight=350]="SemiLight",e[e.Normal=400]="Normal",e[e.Medium=500]="Medium",e[e.SemiBold=600]="SemiBold",e[e.Bold=700]="Bold",e[e.ExtraBold=800]="ExtraBold",e[e.Black=900]="Black",e[e.ExtraBlack=950]="ExtraBlack"}(t.FontWeight||(t.FontWeight={})),function(e){e[e.Normal=0]="Normal",e[e.Oblique=1]="Oblique",e[e.Italic=2]="Italic",e[e.Count=3]="Count"}(t.FontStyle||(t.FontStyle={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.ForwardDiagonal=2]="ForwardDiagonal",e[e.BackwardDiagonal=3]="BackwardDiagonal",e[e.Cross=4]="Cross",e[e.DiagonalCross=5]="DiagonalCross",e[e.Pattern05Percent=6]="Pattern05Percent",e[e.Pattern10Percent=7]="Pattern10Percent",e[e.Pattern20Percent=8]="Pattern20Percent",e[e.Pattern25Percent=9]="Pattern25Percent",e[e.Pattern30Percent=10]="Pattern30Percent",e[e.Pattern40Percent=11]="Pattern40Percent",e[e.Pattern50Percent=12]="Pattern50Percent",e[e.Pattern60Percent=13]="Pattern60Percent",e[e.Pattern70Percent=14]="Pattern70Percent",e[e.Pattern75Percent=15]="Pattern75Percent",e[e.Pattern80Percent=16]="Pattern80Percent",e[e.Pattern90Percent=17]="Pattern90Percent",e[e.LightDownwardDiagonal=18]="LightDownwardDiagonal",e[e.LightUpwardDiagonal=19]="LightUpwardDiagonal",e[e.DarkDownwardDiagonal=20]="DarkDownwardDiagonal",e[e.DarkUpwardDiagonal=21]="DarkUpwardDiagonal",e[e.WideDownwardDiagonal=22]="WideDownwardDiagonal",e[e.WideUpwardDiagonal=23]="WideUpwardDiagonal",e[e.LightVertical=24]="LightVertical",e[e.LightHorizontal=25]="LightHorizontal",e[e.NarrowVertical=26]="NarrowVertical",e[e.NarrowHorizontal=27]="NarrowHorizontal",e[e.DarkVertical=28]="DarkVertical",e[e.DarkHorizontal=29]="DarkHorizontal",e[e.DashedDownwardDiagonal=30]="DashedDownwardDiagonal",e[e.DashedUpwardDiagonal=31]="DashedUpwardDiagonal",e[e.DashedHorizontal=32]="DashedHorizontal",e[e.DashedVertical=33]="DashedVertical",e[e.SmallConfetti=34]="SmallConfetti",e[e.LargeConfetti=35]="LargeConfetti",e[e.ZigZag=36]="ZigZag",e[e.Wave=37]="Wave",e[e.DiagonalBrick=38]="DiagonalBrick",e[e.HorizontalBrick=39]="HorizontalBrick",e[e.Weave=40]="Weave",e[e.Plaid=41]="Plaid",e[e.Divot=42]="Divot",e[e.DottedGrid=43]="DottedGrid",e[e.DottedDiamond=44]="DottedDiamond",e[e.Shingle=45]="Shingle",e[e.Trellis=46]="Trellis",e[e.Sphere=47]="Sphere",e[e.SmallGrid=48]="SmallGrid",e[e.SmallCheckerBoard=49]="SmallCheckerBoard",e[e.LargeCheckerBoard=50]="LargeCheckerBoard",e[e.OutlinedDiamond=51]="OutlinedDiamond",e[e.SolidDiamond=52]="SolidDiamond",e[e.Count=53]="Count"}(t.PatternType||(t.PatternType={}))},51883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},77952:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},32744:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OfficeRenderHost=void 0;var o=n(50556),r=function(){function e(){this.features={}}return e.prototype.renderCustomData=function(e,t){this.setInnerHTML(e,t)},e.prototype.isFeatureEnabled=function(e,t){var n=this.features[e];return"boolean"==typeof n?n:t},e.prototype.setFeatureIsEnabled=function(e,t){this.features[e]=t},e.prototype.setInnerHTML=function(e,t){var n=document.createElementNS(o.svgns,"g");if(void 0!==n.innerHTML)n.innerHTML=t;else{if(!n.ownerDocument)throw new Error("Cannot render content.");var r=(new DOMParser).parseFromString(t,"text/xml").documentElement;n.appendChild(n.ownerDocument.importNode(r,!0))}var i=n.querySelector("svg"),a=i||n,s=a.getAttribute("xml:space"),l=a.querySelector("text");for("preserve"===s&&l&&l.setAttribute("style","white-space:pre;");a.firstElementChild;){var c=a.firstElementChild;a.removeChild(c),e.appendChild(c)}},e}();t.OfficeRenderHost=r},75460:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},13301:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Element=void 0;var o=n(79490),r=n(61269),i=n(27940),a=n(24340),s=n(78972),l=n(35477),c=n(52457),u=function(){function e(e,t){var n;this.formatResolver=new a.FormatResolver,this.element=e,this.parent=t,this.id=null!==(n=e.id)&&void 0!==n?n:"MISSING_ID",this.element.renderingProperties?this.formatResolver.pushFormat(this.getFormatFromRenderingProperties(this.element.renderingProperties)):this.element.format&&this.formatResolver.pushFormat(this.element.format)}return e.prototype.getFill=function(){return this.formatResolver.getFill()},e.prototype.getLineFill=function(){return this.formatResolver.getLineFill()},e.prototype.getLineThickness=function(){return this.formatResolver.getLineThickness()},e.prototype.getLineDashType=function(){return this.formatResolver.getLineDashType()},e.prototype.getLineCapType=function(){return this.formatResolver.getLineCapType()},e.prototype.getLineJoinType=function(){return this.formatResolver.getLineJoinType()},e.prototype.getHeadEnd=function(){return this.formatResolver.getHeadEnd()},e.prototype.getTailEnd=function(){return this.formatResolver.getTailEnd()},e.prototype.getClipRectIndex=function(){return this.formatResolver.getClipRectIndex()},e.prototype.getId=function(){return this.id},e.prototype.getText=function(){return this.element.text?i.isExperimentalText(this.element.text)?new s.ExperimentalText(this.element.text,this.formatResolver):new l.LegacyText(this.element.text):void 0},e.prototype.getEmbeddedContent=function(){if(this.element.embeddedContent)return this.element.embeddedContent},e.prototype.getCustomData=function(){return this.element.customData},e.prototype.getChildren=function(){var t=this;return this.element.children?this.element.children.map((function(n,r){return new e(o.__assign({id:"".concat(t.id,"-").concat(r)},n),t)})):[]},e.prototype.getParent=function(){return this.parent},e.prototype.enumerateGeometry=function(e){if(Array.isArray(this.element.geometry))for(var t=0,n=this.element.geometry;t<n.length;t++){var o=n[t];switch(o.op){case r.GeometryOperation.BeginGeometry:if(o.format?this.formatResolver.pushFormat(o.format):o.formatObject?this.formatResolver.pushFormat(this.getFormatFromFormatObject(o.formatObject)):this.formatResolver.pushFormat({}),!e.beginGeometry(this.copy()))throw new Error("Invalid operation: BeginGeometry failed.");break;case r.GeometryOperation.EndGeometry:if(this.formatResolver.popFormat(),!e.endGeometry())throw new Error("Invalid operation: EndGeometry failed.");break;case r.GeometryOperation.BeginPath:if(!e.beginPath(o.fillMode))throw new Error("Invalid operation: BeginPath failed.");break;case r.GeometryOperation.EndPath:if(!e.endPath())throw new Error("Invalid operation: EndPath failed.");break;case r.GeometryOperation.BeginFigure:if(!e.beginFigure(o.startPoint,o.filled,o.type))throw new Error("Invalid operation: BeginFigure failed.");break;case r.GeometryOperation.AddLines:if(!e.addLines(o.points))throw new Error("Invalid operation: AddLines failed.");break;case r.GeometryOperation.AddBeziers:if(!e.addBeziers(o.points))throw new Error("Invalid operation: AddBeziers failed.");break;case r.GeometryOperation.AddEscape:if(!e.addEscape(o.escape,o.data))throw new Error("Invalid operation: AddEscape failed.");break;case r.GeometryOperation.EndFigure:if(!e.endFigure(o.closed))throw new Error("Invalid operation: EndFigure failed.");break;default:throw new Error("Invalid operation: default case should not be reached")}}},e.prototype.copy=function(){var t=new e(this.element,this.parent);return t.formatResolver=this.formatResolver.copy(),t},e.prototype.getFormatFromRenderingProperties=function(e){if(!e)return{};var t={line:{thickness:e.lineThickness,dashStyle:e.lineDashStyle}},n=c.colorToCSSString(e.fillColor);n&&(t.fill={color:n});var o=c.colorToCSSString(e.lineColor);return o&&t.line&&(t.line.fill={color:o}),t},e.prototype.getFormatFromFormatObject=function(e){return e?{fill:{color:e.fillColor},line:{fill:{color:e.lineColor}}}:{}},e}();t.Element=u},78972:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentalText=void 0;var o=n(79490),r=n(93570),i=n(61269),a=function(e){function t(t,n){var o=e.call(this)||this;return o.text=t,o.resolver=n,o}return o.__extends(t,e),t.prototype.getLines=function(){var e=this;return this.text.lines.map((function(t){return new s(e.text,t,e.resolver)}))},t.prototype.getAngle=function(){return this.text.angle},t.prototype.getText=function(){return this.text.text},t.prototype.getSize=function(){return this.text.size},t.prototype.getLocation=function(){return this.text.location},t.prototype.getTextAlignment=function(){return i.TextAlignment.Center},t}(r.ElementText);t.ExperimentalText=a;var s=function(e){function t(t,n,o){var r=e.call(this)||this;return r.text=t,r.line=n,r.resolver=o,r}return o.__extends(t,e),t.prototype.getRuns=function(){var e=this;return this.line.runs.map((function(t){return new l(e.text,t,e.resolver)}))},t.prototype.getHeight=function(){return this.line.height},t.prototype.isTrimmed=function(){return this.line.isTrimmed},t.prototype.getBaseline=function(){return Math.max.apply(Math,this.line.runs.map((function(e){return e.baseline})))},t}(r.ElementTextLine),l=function(e){function t(t,n,o){var r=e.call(this)||this;return r.text=t,r.run=n,r.resolver=o.copy(),r.resolver.pushFormat({text:r.run.format}),r}return o.__extends(t,e),t.prototype.getColor=function(){return this.resolver.getFontColor()},t.prototype.getWeight=function(){return this.resolver.getFontWeight()},t.prototype.getStyle=function(){return this.resolver.getFontStyle()},t.prototype.getFaceName=function(){return this.resolver.getFontFaceName()},t.prototype.getPixelSize=function(){return this.resolver.getFontPixelSize()},t.prototype.getText=function(){return this.text.text.substr(this.run.start,this.run.length)},t}(r.ElementTextRun)},24340:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FormatResolver=void 0;var o=n(79490),r=n(61269),i=function(){function e(){this.formats=[],this.defaults={fill:{color:"white"},lineFill:{color:"black"},lineThickness:1,lineDashType:r.LineDashType.Solid,lineCapType:r.LineCapType.Flat,lineJoinType:r.LineJoinType.Round,headEnd:{type:r.LineEndType.None,width:r.LineEndSize.Small,length:r.LineEndSize.Small},tailEnd:{type:r.LineEndType.None,width:r.LineEndSize.Small,length:r.LineEndSize.Small},fontColor:"#595959",fontWeight:r.FontWeight.Normal,fontStyle:r.FontStyle.Normal,fontFaceName:"Calibri",fontPixelSize:12,clipRectIndex:-1}}return e.prototype.pushFormat=function(e){this.formats.push(e)},e.prototype.popFormat=function(){return this.formats.pop()},e.prototype.copy=function(){var t=new e;return t.formats=o.__spreadArray([],this.formats,!0),t},e.prototype.getFill=function(){var e;return null!==(e=this.resolve((function(e){return e.fill})))&&void 0!==e?e:this.defaults.fill},e.prototype.getLineFill=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=null==e?void 0:e.line)||void 0===t?void 0:t.fill})))&&void 0!==e?e:this.defaults.lineFill},e.prototype.getLineThickness=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.line)||void 0===t?void 0:t.thickness})))&&void 0!==e?e:this.defaults.lineThickness},e.prototype.getLineDashType=function(){var e,t;return null!==(t=null!==(e=this.resolve((function(e){var t;return null===(t=e.line)||void 0===t?void 0:t.dashType})))&&void 0!==e?e:function(e){switch(e){case"Dash":return r.LineDashType.Dash;case"DashDot":return r.LineDashType.DashDot;case"DashDotDot":return r.LineDashType.DashDotDot;case"Dot":return r.LineDashType.Dot;case"Solid":return r.LineDashType.Solid;case"Count":return r.LineDashType.Count;default:return e}}(this.resolve((function(e){var t;return null===(t=e.line)||void 0===t?void 0:t.dashStyle}))))&&void 0!==t?t:this.defaults.lineDashType},e.prototype.getLineCapType=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.line)||void 0===t?void 0:t.capType})))&&void 0!==e?e:this.defaults.lineCapType},e.prototype.getLineJoinType=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.line)||void 0===t?void 0:t.joinType})))&&void 0!==e?e:this.defaults.lineJoinType},e.prototype.getHeadEnd=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=null==e?void 0:e.line)||void 0===t?void 0:t.headEnd})))&&void 0!==e?e:this.defaults.headEnd},e.prototype.getTailEnd=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=null==e?void 0:e.line)||void 0===t?void 0:t.tailEnd})))&&void 0!==e?e:this.defaults.tailEnd},e.prototype.getFontColor=function(){var e;return null!==(e=this.resolve((function(e){var t,n;return null===(n=null===(t=e.text)||void 0===t?void 0:t.fill)||void 0===n?void 0:n.color})))&&void 0!==e?e:this.defaults.fontColor},e.prototype.getFontWeight=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.text)||void 0===t?void 0:t.weight})))&&void 0!==e?e:this.defaults.fontWeight},e.prototype.getFontStyle=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.text)||void 0===t?void 0:t.style})))&&void 0!==e?e:this.defaults.fontStyle},e.prototype.getFontFaceName=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.text)||void 0===t?void 0:t.faceName})))&&void 0!==e?e:this.defaults.fontFaceName},e.prototype.getFontPixelSize=function(){var e;return null!==(e=this.resolve((function(e){var t;return null===(t=e.text)||void 0===t?void 0:t.pixelSize})))&&void 0!==e?e:this.defaults.fontPixelSize},e.prototype.getClipRectIndex=function(){var e;return null!==(e=this.resolve((function(e){return e.clipRectIndex})))&&void 0!==e?e:this.defaults.clipRectIndex},e.prototype.resolve=function(e){return this.formats.reduceRight((function(t,n){return void 0===t?e(n):t}),void 0)},e}();t.FormatResolver=i},35477:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyTextRun=t.LegacyTextLine=t.LegacyText=void 0;var o=n(79490),r=n(93570),i=function(e){function t(t){var n=e.call(this)||this;return n.text=t,n}return o.__extends(t,e),t.prototype.getLines=function(){var e=this;return this.text.layout.map((function(t,n){return new a(e.text,n)}))},t.prototype.getAngle=function(){return this.text.angle},t.prototype.getText=function(){return this.text.text},t.prototype.getSize=function(){return this.text.size},t.prototype.getLocation=function(){return this.text.location},t.prototype.getTextAlignment=function(){return this.text.format.textAlignment},t}(r.ElementText);t.LegacyText=i;var a=function(e){function t(t,n){var o=e.call(this)||this;return o.index=0,o.text=t,o.index=n,o}return o.__extends(t,e),t.prototype.getRuns=function(){return[new s(this.text,this.index)]},t.prototype.getHeight=function(){return this.text.layout[this.index].height},t.prototype.isTrimmed=function(){return this.text.layout[this.index].isTrimmed},t.prototype.getBaseline=function(){return this.text.layout[this.index].baseline},t}(r.ElementTextLine);t.LegacyTextLine=a;var s=function(e){function t(t,n){var o=e.call(this)||this;o.index=0,o.start=0,o.text=t,o.index=n;for(var r=0;r<o.index;r++)o.start+=o.text.layout[r].length;return o}return o.__extends(t,e),t.prototype.getColor=function(){return this.text.format.textColor},t.prototype.getWeight=function(){return this.text.format.fontWeight},t.prototype.getStyle=function(){return this.text.format.fontStyle},t.prototype.getFaceName=function(){return this.text.format.faceName},t.prototype.getPixelSize=function(){return this.text.format.pixelSize},t.prototype.getText=function(){var e=this.text.layout[this.index],t=e.isTrimmed&&isFinite(this.text.trimStart)?this.text.trimStart-this.start:e.length-e.newlineLength;return this.text.text.substr(this.start,t)},t}(r.ElementTextRun);t.LegacyTextRun=s},57096:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MasterInstancer=void 0;var o=n(61269);function r(e,t){return{x:e.x+t.x,y:e.y+t.y}}var i=function(){function e(){this.master=[]}return e.prototype.reset=function(){this.master=[]},e.prototype.beginGeometry=function(e){return this.master.push({op:o.GeometryOperation.BeginGeometry,formatObject:e}),!0},e.prototype.endGeometry=function(){return this.master.push({op:o.GeometryOperation.EndGeometry}),!0},e.prototype.beginPath=function(e){return this.master.push({op:o.GeometryOperation.BeginPath,fillMode:e}),!0},e.prototype.endPath=function(){return this.master.push({op:o.GeometryOperation.EndPath}),!0},e.prototype.beginFigure=function(e,t,n){return this.master.push({op:o.GeometryOperation.BeginFigure,startPoint:e,filled:t,figureType:n}),!0},e.prototype.endFigure=function(e){return this.master.push({op:o.GeometryOperation.EndFigure,closed:e}),!0},e.prototype.addLines=function(e){return this.master.push({op:o.GeometryOperation.AddLines,points:e}),!0},e.prototype.addBeziers=function(e){return this.master.push({op:o.GeometryOperation.AddBeziers,points:e}),!0},e.prototype.addEscape=function(e,t){return this.master.push({op:o.GeometryOperation.AddEscape,escape:e,data:t}),!0},e.prototype.createInstance=function(e,t){return this.master.every((function(n){switch(n.op){case o.GeometryOperation.BeginGeometry:return e.beginGeometry(n.formatObject);case o.GeometryOperation.EndGeometry:return e.endGeometry();case o.GeometryOperation.BeginPath:return e.beginPath(n.fillMode);case o.GeometryOperation.EndPath:return e.endPath();case o.GeometryOperation.BeginFigure:return e.beginFigure(r(t,n.startPoint),n.filled,n.figureType);case o.GeometryOperation.EndFigure:return e.endFigure(n.closed);case o.GeometryOperation.AddLines:return e.addLines(n.points.map((function(e){return r(t,e)})));case o.GeometryOperation.AddBeziers:return e.addBeziers(n.points.map((function(e){return r(t,e)})));case o.GeometryOperation.AddEscape:return e.addEscape(n.escape,n.data);default:throw new Error("Unexpected geometry.")}}))},e}();t.MasterInstancer=i},99365:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SceneGraph=void 0;var o=n(79490),r=n(13301),i=function(){function e(e){this.root=new r.Element(o.__assign({id:"ROOT_ELEMENT"},e.root)),this.sceneGraph=e}return e.prototype.getRoot=function(){return this.root},e.prototype.getElementById=function(e){return this.findElementWithIdFromElement(this.root,e)},e.prototype.getSize=function(){return this.sceneGraph.size},e.prototype.getBorderWidth=function(){var e;return null!==(e=this.sceneGraph.borderWidth)&&void 0!==e?e:1},e.prototype.getClipRects=function(){var e;return null!==(e=this.sceneGraph.clipRects)&&void 0!==e?e:[]},e.prototype.findElementWithIdFromElement=function(e,t){if(e.getId()===t)return e;for(var n=0,o=e.getChildren();n<o.length;n++){var r=o[n],i=this.findElementWithIdFromElement(r,t);if(i)return i}},e}();t.SceneGraph=i},93570:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ElementText=t.ElementTextLine=t.ElementTextRun=void 0;var n=function(){};t.ElementTextRun=n;var o=function(){};t.ElementTextLine=o;var r=function(){};t.ElementText=r},43010:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObservableSvgElement=void 0;var o=n(79490),r=n(28128),i=n(1056),a=n(94295),s=n(42333),l=function(){function e(e,t,n){var o=this;this.observers=[],this.handleMouseOver=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handleMouseOver",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(e){return e.receiveMouseOver(t)}))}))},this.handleMouseMove=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handleMouseMove",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(e){return e.receiveMouseMove(t)}))}))},this.handleMouseOut=function(){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handleMouseOut",(function(){return o.observers.forEach((function(e){return e.receiveMouseOut()}))}))},this.handleMouseUp=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handleMouseUp",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(e){return e.receiveMouseUp(t)}))}))},this.handleDoubleClick=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handleDoubleClick",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(e){return e.receiveDoubleClick(t)}))}))},this.handlePointerDown=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handlePointerDown",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(n){return n.receivePointerDown(t,e.pointerType)}))}))},this.handleKeyDown=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handleKeyDown",(function(){o.observers.forEach((function(t){return t.receiveKeyDown(e.code,e.shiftKey)}))}))},this.handlePointerMove=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handlePointerMove",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(n){return n.receivePointerMove(t,e.pointerType)}))}))},this.handlePointerUp=function(e){(0,a.wrapWithActivity)(o.activitySink,"ObservableSvgElement.handlePointerUp",(function(){var t=o.convertMouseEvent(e);o.observers.forEach((function(e){return e.receiveMouseUp(t)}))}))},this.sceneGraph=e,this.activitySink=n,this.renderHost=t}return e.prototype.bind=function(e){var t=this;this.unbind(),this.element=e,this.renderHost&&this.renderHost.isFeatureEnabled("EnableKeyboardEventsInTraliccio",!1)&&(document.onkeydown=function(e){t.handleKeyDown(e),e.preventDefault()}),this.renderHost&&this.renderHost.isFeatureEnabled(s.touchManualPlacementCG,!1)?(this.element.addEventListener("pointerup",this.handlePointerUp),this.element.addEventListener("pointermove",this.handlePointerMove)):(this.renderHost&&this.renderHost.isFeatureEnabled(s.manualPlacementFG,!1)&&this.element.addEventListener("mouseup",this.handleMouseUp),this.element.addEventListener("mousemove",this.handleMouseMove)),this.element.addEventListener("pointerdown",this.handlePointerDown),this.element.addEventListener("mouseover",this.handleMouseOver),this.element.addEventListener("mouseout",this.handleMouseOut),this.element.addEventListener("dblclick",this.handleDoubleClick)},e.prototype.unbind=function(){this.element&&(this.renderHost&&this.renderHost.isFeatureEnabled(s.touchManualPlacementCG,!1)?(this.element.removeEventListener("pointerup",this.handlePointerUp),this.element.removeEventListener("pointermove",this.handlePointerMove)):(this.renderHost&&this.renderHost.isFeatureEnabled(s.manualPlacementFG,!1)&&this.element.removeEventListener("mouseup",this.handleMouseUp),this.element.removeEventListener("mousemove",this.handleMouseMove)),this.element.removeEventListener("pointerdown",this.handlePointerDown),this.element.removeEventListener("mouseover",this.handleMouseOver),this.element.removeEventListener("mouseout",this.handleMouseOut),this.element.removeEventListener("dblclick",this.handleDoubleClick)),this.element=void 0},e.prototype.addObserver=function(e){this.observers.push(e)},e.prototype.removeObservers=function(){this.observers=[]},e.prototype.getDatapointId=function(e){if(e){for(var t=e;t&&!(0,r.isElementDomId)(t.id);)t=(0,i.getParentElement)(t);return t&&(0,r.isDatapointDomId)(t.id)?(e=t,t.id.substr(2)):void 0}},e.prototype.getElementFromTarget=function(e){if(!(e instanceof Element||e instanceof window.SVGElement))throw new Error("Invalid event target.");var t=e,n=this.getDatapointId(e);for(n&&(t=(0,i.getParentElement)(e));t&&!(0,r.isElementDomId)(t.id);)t=(0,i.getParentElement)(t);if(t){var o=(0,r.getElementIdFromDomId)(t.id);if(!o)throw new Error("Unexpected error.");var a=this.sceneGraph.getElementById(o);if(!a)throw new Error("Unexpected error.");return{element:a,datapointId:n}}},e.prototype.convertMouseEvent=function(e){if(!e.target)throw new Error("Unexpected event.");if(!this.element)throw new Error("Unexpected error. Binding required.");var t=(0,i.getOffsetInRect)(this.element.getBoundingClientRect(),e.clientX,e.clientY),n=this.getElementFromTarget(e.target);return o.__assign(o.__assign({},t),{target:null==n?void 0:n.element,datapointId:null==n?void 0:n.datapointId,isRightClick:2===e.buttons,isLeftClick:1===e.buttons,isLeftClickReleased:0===e.button,stopPropagation:function(){return e.stopPropagation()}})},e}();t.ObservableSvgElement=l},33566:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgClipRectStorage=void 0;var o=n(37743),r=n(50556),i=function(){function e(e,t){this.svg=e,this.idPrefix=(0,o.generateUniqueId)(),this.count=t.length,this.ensureClipRects(t)}return e.prototype.getIdForIndex=function(e){if(e>=this.count)throw new Error("Invalid index.");return"".concat(this.idPrefix,"-").concat(e)},e.prototype.ensureClipRects=function(e){var t=this;e.forEach((function(e,n){t.ensureClipRect(e,n)}))},e.prototype.ensureClipRect=function(e,t){var n=document.createElementNS(r.svgns,"clipPath");n.id=this.getIdForIndex(t);var o=document.createElementNS(r.svgns,"rect");o.setAttribute("x","".concat(e.left)),o.setAttribute("y","".concat(e.top)),o.setAttribute("width","".concat(e.right-e.left)),o.setAttribute("height","".concat(e.bottom-e.top)),n.appendChild(o),this.svg.appendChild(n)},e}();t.SvgClipRectStorage=i},49210:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgGradientStorage=void 0;var o=n(50556),r=function(){function e(e){this.defs=e}return e.prototype.storeLinearGradient=function(e,t,n){var r=this.translateLinearGradientShade(e.angle),i=r.start,a=r.end,s=document.createElementNS(o.svgns,"linearGradient");s.setAttribute("x1",i.x.toString()),s.setAttribute("y1",i.y.toString()),s.setAttribute("x2",a.x.toString()),s.setAttribute("y2",a.y.toString()),this.appendGradient(s,t,n)},e.prototype.storeRadialGradient=function(e,t,n,r){var i=this.translateRadialGradientShade(e.center,n),a=document.createElementNS(o.svgns,"radialGradient");a.setAttribute("fx",i.focal.x.toString()),a.setAttribute("fy",i.focal.y.toString()),a.setAttribute("cx",i.center.x.toString()),a.setAttribute("cy",i.center.y.toString()),a.setAttribute("r",i.radius.toString()),i.translate&&i.scale&&a.setAttribute("gradientTransform","translate(".concat(i.translate.x,", ").concat(i.translate.y,") scale(").concat(i.scale.x,", ").concat(i.scale.y,")")),this.appendGradient(a,t,r)},e.prototype.appendGradient=function(e,t,n){e.id=n,t.sort((function(e,t){return e.pos-t.pos}));for(var r=0,i=t;r<i.length;r++){var a=i[r],s=document.createElementNS(o.svgns,"stop");s.setAttribute("offset",a.pos.toString()),s.setAttribute("stop-color",a.color),e.appendChild(s)}this.defs.appendChild(e)},e.prototype.translateLinearGradientShade=function(e){(e+=180)<0?(e%=360,e+=360):e%=360;var t,n,o,r=Math.floor(e/90),i=(e-90*r)*Math.PI/180,a={x:Math.cos(i),y:Math.sin(i)},s=(t={x:-1,y:-1}).x*(n=a).x+t.y*n.y,l={x:a.x*s,y:a.y*s};switch(r){case 0:default:o=l;break;case 1:o={x:-l.y,y:l.x};break;case 2:o={x:-l.x,y:-l.y};break;case 3:o={x:l.y,y:-l.x}}var c={x:-o.x,y:-o.y},u=function(e){return{x:(e.x+1)/2,y:(e.y+1)/2}};return o=u(o),{start:c=u(c),end:o}},e.prototype.translateRadialGradientShade=function(e,t){var n=t.max.x-t.min.x,o=t.max.y-t.min.y,r=n/2,i=o/2,a=Math.sqrt(n*n+o*o)/2,s={x:r-a,y:i-a},l={x:r+a,y:i+a},c=n*e.x,u=o*e.y,d=(l.x-s.x)/n/2,p={x:c/n,y:u/o},h=o/n,g=(h-1)/-2;p.y=e.y*h+g;var f=(t.max.x-t.min.x)/(t.max.y-t.min.y),m={x:1,y:f},y={x:0,y:(f-1)/-2};if(e.y>1||e.y<0)if(p.y<0){var v=.5-d-p.y;p.x=.5,p.y+=v,y.y-=v,m.y+=v}else{v=p.y-(.5+d);p.x=.5,p.y-=v,m.y+=v}else{var C={x:p.x-.5,y:p.y-.5},b=C.x*C.x+C.y*C.y;b>=d*d&&(d=Math.sqrt(b))}return{focal:p,center:{x:.5,y:.5},radius:d,translate:y,scale:m}},e}();t.SvgGradientStorage=r},46675:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgLineEndStorage=void 0;var o=n(61269),r=n(50556),i=function(){function e(e){this.refXOffset=.1,this.defs=e}return e.prototype.storeTriangleLineEnd=function(e,t,n,o,i){var a=this.translateTriangleLineEndSize(e,t),s=a.x,l=a.y,c=this.createTrianglePath(s,l,0)+" Z",u=document.createElementNS(r.svgns,"marker");u.setAttribute("refX",this.refXOffset.toString()),u.setAttribute("refY",l.toString());var d=document.createElementNS(r.svgns,"path");d.setAttribute("d",c),d.setAttribute("fill",n),u.appendChild(d),this.appendLineEnd(u,o,i)},e.prototype.storeArrowLineEnd=function(e,t,n,o,i){var a=this.translateTriangleLineEndSize(e,t),s=a.x,l=a.y,c=this.createArrowPath(s,l,i)+" Z",u=document.createElementNS(r.svgns,"marker");u.setAttribute("refX",(i+this.refXOffset).toString()),u.setAttribute("refY",(i+l).toString());var d=document.createElementNS(r.svgns,"path");d.setAttribute("d",c),d.setAttribute("fill","none"),d.setAttribute("stroke",n),d.setAttribute("stroke-linecap","round"),u.appendChild(d),this.appendLineEnd(u,o,i)},e.prototype.storeDiamondLineEnd=function(e,t,n,o,i){var a=this.translateDiamondLineEndSize(e,t),s=a.x,l=a.y,c=this.createDiamondPath(s,l)+" Z",u=document.createElementNS(r.svgns,"marker");u.setAttribute("refX",(s/2).toString()),u.setAttribute("refY",l.toString());var d=document.createElementNS(r.svgns,"path");d.setAttribute("d",c),d.setAttribute("fill",n),u.appendChild(d),this.appendLineEnd(u,o,i)},e.prototype.storeOvalLineEnd=function(e,t,n,o,i){var a=this.translateOvalLineEndSize(e,t),s=a.x,l=a.y,c=s.toString(),u=l.toString(),d=document.createElementNS(r.svgns,"marker");d.setAttribute("refX",s.toString()),d.setAttribute("refY",l.toString());var p=document.createElementNS(r.svgns,"ellipse");p.setAttribute("cx",c),p.setAttribute("cy",u),p.setAttribute("rx",c),p.setAttribute("ry",u),p.setAttribute("fill",n),d.appendChild(p),this.appendLineEnd(d,o,i)},e.prototype.storeStealthLineEnd=function(e,t,n,o,i){var a=this.translateTriangleLineEndSize(e,t),s=a.x,l=a.y,c=this.createStealthPath(s,l,0)+" Z",u=document.createElementNS(r.svgns,"marker");u.setAttribute("refX",(s/4+this.refXOffset).toString()),u.setAttribute("refY",l.toString());var d=document.createElementNS(r.svgns,"path");d.setAttribute("d",c),d.setAttribute("fill",n),u.appendChild(d),this.appendLineEnd(u,o,i)},e.prototype.enumToNumber=function(e){return"number"==typeof e?e:+o.LineEndSize[e]},e.prototype.appendLineEnd=function(e,t,n){e.id=t,e.setAttribute("orient","auto-start-reverse"),e.setAttribute("markerWidth",(7*n).toString()),e.setAttribute("markerHeight",(7*n).toString()),this.defs.appendChild(e)},e.prototype.translateTriangleLineEndSize=function(e,t){var n=this.enumToNumber(e);return{x:this.enumToNumber(t)+2,y:n/2+1.5}},e.prototype.translateDiamondLineEndSize=function(e,t){var n=this.enumToNumber(e);return{x:this.enumToNumber(t)+.75,y:n+.75}},e.prototype.translateOvalLineEndSize=function(e,t){var n=this.enumToNumber(e);return{x:this.enumToNumber(t)/2+1.25,y:n/2+1.25}},e.prototype.createTrianglePath=function(e,t,n){var o=n.toString();return"M "+o+" "+o+" L "+(e+n).toString()+" "+(t+n).toString()+" L "+o+" "+(n+2*t).toString()},e.prototype.createArrowPath=function(e,t,n){var o=this.createTrianglePath(e,t,n),r=(e+n).toString(),i=(t+n).toString();return o+(" M "+n.toString()+" "+i+" L "+r+" "+i)},e.prototype.createDiamondPath=function(e,t){var n=e.toString(),o=t.toString();return"M 0 "+o+" L "+n+" 0 L "+(2*e).toString()+" "+o+" L "+n+" "+(2*t).toString()},e.prototype.createStealthPath=function(e,t,n){return this.createTrianglePath(e,t,n)+" L "+(e/4).toString()+" "+t.toString()},e}();t.SvgLineEndStorage=i},9001:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgPathBuilder=void 0;var o=n(52457),r=n(29841),i=function(){function e(){this.pathBounds=new r.Bounds2D,this.finishedPaths=[],this.currentPath=this.createEmptyPath(),this.isLines=!0,this.hasGradient=!1}return Object.defineProperty(e.prototype,"length",{get:function(){return this.finishedPaths.length},enumerable:!1,configurable:!0}),e.prototype.shift=function(){return this.finishedPaths.shift()},e.prototype.setDatapointIndex=function(e){""!==this.currentPath.data&&this.currentPath.datapointIndex!==e&&this.finishCurrentPath(),this.currentPath.datapointIndex=e},e.prototype.setFilled=function(e){""!==this.currentPath.data&&this.currentPath.filled!==e&&this.finishCurrentPath(),this.currentPath.filled=e},e.prototype.move=function(e){this.currentPath.data+="M".concat(o.pointToString(e)),this.isLines&&this.pathBounds.addPoint(e)},e.prototype.addLines=function(e){if(e.length>0){this.currentPath.data+="L";for(var t=0,n=e;t<n.length;t++){var r=n[t];this.currentPath.data+=o.pointToString(r),this.isLines&&this.pathBounds.addPoint(r)}}},e.prototype.addBeziers=function(e){if(e.length>0){this.currentPath.data+="C",this.isLines=!1;for(var t=0,n=e;t<n.length;t++){var r=n[t];this.currentPath.data+=o.pointToString(r)}}},e.prototype.close=function(){this.currentPath.data+="Z"},e.prototype.finishCurrentPath=function(){""!==this.currentPath.data&&(this.hasGradient&&this.isLines&&!this.pathBounds.isEmpty()&&this.expandBoundsOfOrthogonalLine(),this.finishedPaths.push(this.currentPath),this.currentPath=this.createEmptyPath(),this.isLines=!0,this.hasGradient=!1,this.pathBounds.reset())},e.prototype.setHasGradient=function(e){this.hasGradient=e},e.prototype.expandBoundsOfOrthogonalLine=function(){var e=this.pathBounds.getBounds(),t=e.max.x-e.min.x,n=e.max.y-e.min.y;if(0!==n||0!==t){0===n?this.currentPath.data+="M".concat(e.max.x,",").concat(e.max.y+.005):0===t&&(this.currentPath.data+="M".concat(e.max.x+.005,",").concat(e.max.y))}},e.prototype.createEmptyPath=function(){return{data:"",filled:!1}},e}();t.SvgPathBuilder=i},29708:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createPatternCanvas=t.SvgPatternStorage=void 0;var o=n(52457),r=n(37743),i=n(50556),a=function(){function e(e){this.patterns={},this.defs=e}return e.prototype.storePattern=function(e){var t="".concat(e.pattern,",").concat(e.backgroundColor,",").concat(e.foregroundColor);if(this.patterns[t])return this.patterns[t];var n=document.createElementNS(i.svgns,"pattern");n.id=(0,r.generateUniqueId)(),n.setAttribute("patternUnits","userSpaceOnUse"),n.setAttribute("width",p.toString()),n.setAttribute("height",p.toString());var o=1/d;n.setAttribute("patternTransform","scale(".concat(o," ").concat(o,")"));var a=document.createElementNS(i.svgns,"image");a.id=(0,r.generateUniqueId)(),a.setAttribute("width",p.toString()),a.setAttribute("height",p.toString()),a.setAttribute("preserveAspectRatio","none");var l=s(e);a.setAttributeNS(i.xlinkns,"href",l.toDataURL("image/jpeg",1)),this.defs.appendChild(a);var c=document.createElementNS(i.svgns,"use");return c.setAttribute("width","100%"),c.setAttribute("height","100%"),c.setAttributeNS(i.xlinkns,"href","#".concat(a.id)),n.appendChild(c),this.defs.appendChild(n),this.patterns[t]=n.id,this.patterns[t]},e}();function s(e){var t=document.createElement("canvas"),n=t.getContext("2d");if(!n)throw new Error("Missing canvas support.");t.width=t.height=p,n.clearRect(0,0,p,p);for(var r=0,i=0,a=e.pattern*u,s=e.backgroundColor,h=e.foregroundColor,g=function(e,t,n){var r=o.cssStringToColor(e);if(!r)throw new Error("Invalid color.");var i=o.cssStringToColor(t);if(!i)throw new Error("Invalid color.");var a=o.colorToCSSString(function(e,t){return{r:e.r+t.r,g:e.g+t.g,b:e.b+t.b,a:e.a+t.a}}(r,function(e,t){return{r:e.r*t,g:e.g*t,b:e.b*t,a:e.a*t}}((s=i,l=r,{r:s.r-l.r,g:s.g-l.g,b:s.b-l.b,a:s.a-l.a}),n)));var s,l;if(!a)throw new Error("Invalid color.");return a}(e.backgroundColor,e.foregroundColor,.5),f=0;f<u;f++)for(var m=l[a+f],y=0;y<4;y++){var v=m>>y%4*2,C=s;2&v?C=h:1&v&&(C=g),n.fillStyle=C,n.fillRect(r*d,i*d,d,d),++r===c&&(r=0,i++)}return t}t.SvgPatternStorage=a,t.createPatternCanvas=s;var l=new Uint8Array([255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,3,0,7,64,29,0,116,0,208,1,64,7,0,29,0,116,1,208,1,208,0,116,0,29,64,7,208,1,116,0,29,0,7,64,255,255,3,0,3,0,3,0,3,0,3,0,3,0,3,0,7,208,29,116,116,29,208,7,208,7,116,29,29,116,7,208,3,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,3,0,0,0,0,3,0,0,3,0,0,0,0,3,0,0,3,3,0,0,48,48,0,0,3,3,0,0,48,48,0,0,3,3,48,48,3,3,48,48,3,3,48,48,3,3,48,48,51,51,12,12,51,51,192,192,51,51,12,12,51,51,192,192,51,51,204,204,51,51,204,192,51,51,204,204,51,51,192,204,51,51,204,204,51,51,204,204,51,51,204,204,51,51,204,204,63,63,204,204,243,243,204,204,63,63,204,204,243,243,204,204,252,252,207,207,252,252,207,207,252,252,207,207,252,252,207,207,252,252,255,255,207,207,255,255,252,252,255,255,207,207,255,255,63,255,255,255,255,63,255,255,63,255,255,255,255,63,255,255,255,255,255,255,255,255,255,252,255,255,255,255,255,255,252,255,3,3,12,12,48,48,192,192,3,3,12,12,48,48,192,192,192,192,48,48,12,12,3,3,192,192,48,48,12,12,3,3,15,15,60,60,240,240,195,195,15,15,60,60,240,240,195,195,240,240,60,60,15,15,195,195,240,240,60,60,15,15,195,195,15,192,63,0,252,0,240,3,192,15,0,63,0,252,3,240,3,240,0,252,0,63,192,15,240,3,252,0,63,0,15,192,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,255,255,0,0,0,0,0,0,255,255,0,0,0,0,0,0,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,204,255,255,0,0,255,255,0,0,255,255,0,0,255,255,0,0,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,255,255,255,255,0,0,0,0,255,255,255,255,0,0,0,0,0,0,0,0,3,3,12,12,48,48,192,192,0,0,0,0,0,0,0,0,192,192,48,48,12,12,3,3,0,0,0,0,255,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,3,0,3,0,3,0,3,0,0,3,0,3,0,3,0,3,3,0,0,3,12,0,0,48,192,0,0,192,48,0,0,12,243,192,240,0,0,240,192,243,207,3,15,0,0,15,3,207,3,192,12,48,48,12,192,3,3,192,12,48,48,12,192,3,0,0,192,3,48,204,15,0,0,0,192,3,48,204,15,0,0,192,0,48,0,12,0,3,192,3,48,12,12,48,3,192,255,255,3,0,3,0,3,0,255,255,0,3,0,3,0,3,3,3,204,12,48,48,12,204,3,3,192,12,48,48,204,192,51,51,204,204,51,51,204,204,255,0,255,0,255,0,255,0,0,0,192,0,0,3,192,0,0,0,3,0,0,192,3,0,51,51,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,48,48,0,0,0,3,0,0,48,48,0,0,0,240,3,12,12,3,240,0,0,15,0,48,0,192,0,192,255,255,60,60,255,255,195,195,255,255,60,60,255,255,195,195,252,252,3,195,3,255,3,255,252,252,195,3,255,3,255,3,255,255,3,3,3,3,3,3,255,255,3,3,3,3,3,3,195,195,60,60,60,60,195,195,195,195,60,60,60,60,195,195,255,0,255,0,255,0,255,0,0,255,0,255,0,255,0,255,3,48,12,12,48,3,192,0,48,3,12,12,3,48,0,192,192,0,240,3,252,15,255,63,252,15,240,3,192,0,0,0]),c=8,u=16,d=8,p=c*d},49934:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgSelector=void 0;var o=n(9001),r=n(61269),i=n(50556),a=n(28128),s=n(1056),l=n(94295),c=n(47526),u=n(42333),d=n(16460);t.SvgSelector=function(){function e(e,t){this.handles={},this.pathWidths={},this.svg=e,this.selectionLayer=document.createElementNS(i.svgns,"g"),this.svg.appendChild(this.selectionLayer),this.createHighContrastStyle(),this.ensurePaths(),this.renderHost=t,this.placementInputType=d.InputType.Mouse}return e.prototype.movePlacement=function(e,t,n,o){var r=(0,a.getDomIdFromElementId)(e),i=this.svg.getElementById(r);if(i&&this.ensureMovementWithinBounds(i,t,n)){var s=this.svg.createSVGTransform();s.setTranslate(t,n),i.transform&&i.transform.baseVal.appendItem(s),this.placementInputType=o,this.setupTransformsForSelectPathOnly(s)}},e.prototype.finalizePlacement=function(e,t,n){throw new Error("Method not implemented.")},e.prototype.resetSelectionPosition=function(){this.clearTransformsForSelectPathOnly()},e.prototype.doubleClick=function(e){throw new Error("Method not implemented.")},e.prototype.loadEmbeddedContent=function(e){throw new Error("Method not implemented.")},e.prototype.select=function(e,t,n,o,i){if(e!==this.selectPath.attachedId&&(this.selectedElementSupportsManualPlacement=!1,this.removeAllHandles(),this.clearPath(this.hoverPath,l.UserAction.Unhover),this.clearPath(this.selectPath,l.UserAction.Deselect),e&&e.length>0)){i&&(this.svg.style.cursor="move",this.selectedElementSupportsManualPlacement=!0);var a=n===r.SelectionHandleOption.UIControl,s=this.overlayPath(e,this.selectPath,t,a,l.UserAction.Select);if(this.renderHost&&this.renderHost.isFeatureEnabled(u.manualPlacementFG,!1)&&s){var c=null;s.transform&&(c=s.transform.baseVal.consolidate()),c&&this.setupTransformsForSelectPathOnly(c)}this.createHandlesForElement(e,n)}},e.prototype.deselect=function(){this.removeAllHandles(),this.clearPath(this.hoverPath,l.UserAction.Unhover),this.clearPath(this.selectPath,l.UserAction.Deselect),this.selectedElementSupportsManualPlacement=!1},e.prototype.getSelectedId=function(){return this.selectPath.attachedId},e.prototype.getCurrentSelectionBounds=function(){return void 0===this.selectPath.attachedElement?this.svg.getBoundingClientRect():this.selectPath.attachedElement.getBoundingClientRect()},e.prototype.getPosition=function(e){var t=(0,a.getDomIdFromElementId)(e),n=this.svg.getElementById(t);if(!n)throw new Error("Unexpected id");var o=n.getBoundingClientRect();return[o.left,o.top]},e.prototype.hover=function(e,t,n){if(e!==this.hoverPath.attachedId){var o=n===r.SelectionHandleOption.UIControl;if(void 0!==this.getSelectedId()&&e===this.getSelectedId()&&this.selectedElementSupportsManualPlacement?this.svg.style.cursor="move":this.svg.style.cursor=e&&o?"pointer":e?"default":"",("string"!=typeof this.selectPath.attachedId||this.selectPath.attachedId!==e)&&(this.clearPath(this.hoverPath,l.UserAction.Unhover),e&&e.length>0)){var i=this.overlayPath(e,this.hoverPath,t,o,l.UserAction.Hover);if(this.renderHost&&this.renderHost.isFeatureEnabled(u.manualPlacementFG,!1)&&i){var a=null;i.transform&&(a=i.transform.baseVal.consolidate()),a&&this.setupTransformsForHoverPathOnly(a)}}}},e.prototype.unhover=function(){this.svg.style.cursor="",this.renderHost&&this.renderHost.isFeatureEnabled(u.manualPlacementFG,!1)&&this.clearTransformsForHoverPathOnly(),this.clearPath(this.hoverPath,l.UserAction.Unhover)},e.prototype.setHandles=function(e){this.handles=e},e.prototype.setPathWidths=function(e){this.pathWidths=e},e.prototype.selectionSupported=function(e){return!!this.svg.getElementById((0,a.getDomIdFromElementId)(e))},e.prototype.getPlacementInputType=function(){return this.placementInputType},e.prototype.ensureMovementWithinBounds=function(e,t,n){var o,r=e.getBoundingClientRect(),i=null===(o=e.parentElement)||void 0===o?void 0:o.getBoundingClientRect();return!(i&&r.bottom+n>i.bottom||i&&r.top+n<i.top||i&&r.left+t<i.left||i&&r.right+t>i.right)},e.prototype.clearPath=function(e,t){var n;e.attachedId&&(e.path.removeAttribute("d"),e.attachedId=void 0,e.attachedElement=void 0,null===(n=(0,l.getCurrentActivity)())||void 0===n||n.addAction(t))},e.prototype.getPathsForSelection=function(e){var t;if("path"===e.nodeName)return[e];if(!e.querySelector(".".concat(s.customDataClassName))&&!e.querySelector(".".concat(s.hitTestingClassName)))return e.querySelectorAll("path");for(var n=e.querySelectorAll("path"),o=[],r=0;r<n.length;r++){for(var i=n[r],a=!0;void 0!==i&&i!==e&&a;){var l=null!==(t=i.getAttribute("class"))&&void 0!==t?t:"";a=!l.split(" ").includes(s.customDataClassName)&&!l.split(" ").includes(s.hitTestingClassName),i=(0,s.getParentElement)(i)}a&&o.push(n[r])}return o},e.prototype.overlayPath=function(e,t,n,r,i){var s,c=this;if(e!==t.attachedId){t.attachedId=e;var u=(0,a.getDomIdFromElementId)(e);if(t.attachedElement=this.svg.getElementById(u),t.attachedElement&&(null===(s=(0,l.getCurrentActivity)())||void 0===s||s.addAction(i),this.shouldShowBorder(u)||i!==l.UserAction.Select||r)){if(r?this.applyControlElementPathStyle(t.path,i):this.applyChartElementPathStyle(t.path),!n&&!r){var d=this.getPathsForSelection(t.attachedElement);if(d.length>0){for(var p="",h=0;h<d.length;h++){var g=(b=d[h]).getAttribute("d");"string"==typeof g&&(p+=g)}return t.path.setAttribute("d",p),t.attachedElement}}var f=[],m=this.getViewAdjustment(),y=t.attachedElement.querySelectorAll("text"),v=t.attachedElement.querySelectorAll("foreignObject");if(r){var C=this.getBoundingBox(m,t.attachedElement);f.push({x:C.left+1,y:C.top+1},{x:C.right-1,y:C.top+1},{x:C.right-1,y:C.bottom-1},{x:C.left+1,y:C.bottom-1})}else if(y.length>0)this.groupElements(y).forEach((function(e){var t=e.map((function(e){return c.getBoundingBox(m,e)})).reduce((function(e,t){return c.getUnionOfBoundingBoxes(e,t)}));f.push({x:t.left-4,y:t.top-4},{x:t.right+4,y:t.top-4},{x:t.right+4,y:t.bottom+4},{x:t.left-4,y:t.bottom+4})}));else{if(void 0!==this.handles[e]&&0===v.length){var b;if(this.handles[e].forEach((function(e){return f.push(e)})),f.length>2)(b=t.attachedElement.getAttribute("d"))&&"string"==typeof b&&(t.path.setAttribute("d",b),this.handles[e]=f);return}C=this.getBoundingBox(m,t.attachedElement);f.push({x:C.left,y:C.top},{x:C.right,y:C.top},{x:C.right,y:C.bottom},{x:C.left,y:C.bottom})}var E=new o.SvgPathBuilder;for(h=0;h<f.length;h+=4)E.move(f[h]),E.addLines(f.slice(h+1,h+4)),E.close();E.finishCurrentPath();var A=E.shift();if(!A)throw new Error("Unexpected missing path.");t.path.setAttribute("d",A.data),this.handles[e]=f}}},e.prototype.groupElements=function(e){for(var t={},n=0;n<e.length;n++){for(var o=e[n],r=o;!r.id;){var i=(0,s.getParentElement)(r);if(!i)throw new Error("Invalid element.");r=i}t[r.id]?t[r.id].push(o):t[r.id]=[o]}return Object.keys(t).map((function(e){return t[e]}))},e.prototype.getBoundingBox=function(e,t){var n=t.getBoundingClientRect();return{left:n.left/e.scaleFactor+e.xOffset,top:n.top/e.scaleFactor+e.yOffset,right:n.right/e.scaleFactor+e.xOffset,bottom:n.bottom/e.scaleFactor+e.yOffset}},e.prototype.getUnionOfBoundingBoxes=function(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)}},e.prototype.getViewAdjustment=function(){var e,t=this.svg.getBoundingClientRect(),n=null===(e=this.svg.getAttribute("viewBox"))||void 0===e?void 0:e.split(" ");if(void 0===n)return{xOffset:-t.left,yOffset:-t.top,scaleFactor:1};var o=parseInt(n[0],10),r=parseInt(n[2],10);if(isNaN(o)||isNaN(r))throw new Error("Invalid view box.");var i=t.width/r;return{xOffset:-t.left/i+o,yOffset:-t.top/i+o,scaleFactor:i}},e.prototype.createHighContrastStyle=function(){var t=document.createElementNS(i.svgns,"style");this.selectionLayer.appendChild(t);var n=new c.SvgStyle(t);n.addRule("@media screen and (-ms-high-contrast: active),\n            screen and (forced-colors: active) {\n                path.".concat(e.highContrastSelectionPathClassName," {\n                    stroke: highlight;\n                }\n            }")),n.addRule("@media screen and (-ms-high-contrast: active),\n            screen and (forced-colors: active) {\n                circle.".concat(e.highContrastSelectionHandleClassName," {\n                    stroke: highlight;\n                    fill: window;\n                }\n            }"))},e.prototype.ensurePaths=function(){this.hoverPath={path:document.createElementNS(i.svgns,"path")},this.hoverPath.path.setAttribute("pointer-events","none"),this.hoverPath.path.setAttribute("class",e.highContrastSelectionPathClassName),this.selectionLayer.appendChild(this.hoverPath.path),this.selectPath={path:document.createElementNS(i.svgns,"path")},this.selectPath.path.setAttribute("pointer-events","none"),this.selectPath.path.setAttribute("class",e.highContrastSelectionPathClassName),this.selectionLayer.appendChild(this.selectPath.path)},e.prototype.applyChartElementPathStyle=function(e){e.setAttribute("stroke-opacity","1"),e.setAttribute("stroke","#0078D2"),e.setAttribute("stroke-width","1px"),e.setAttribute("fill-opacity","0")},e.prototype.applyControlElementPathStyle=function(e,t){t===l.UserAction.Select?(e.setAttribute("stroke-opacity","1"),e.setAttribute("stroke","#000000"),e.setAttribute("stroke-width","1px"),e.setAttribute("fill-opacity","0")):(e.setAttribute("stroke-opacity","0"),e.setAttribute("fill-opacity","0.2"),e.setAttribute("fill","#000000"))},e.prototype.createHandlesForElement=function(e,t){var n=this,o=this.handles[e];if(o&&o.length>0){if(t===r.SelectionHandleOption.UIControl)return;if(t===r.SelectionHandleOption.EndPoints&&o.length>1)this.createHandle(o[0]),this.createHandle(o[o.length-1]);else if(t===r.SelectionHandleOption.Maximum&&o.length>16){for(var i=[],a=0,s=e.concat("-",a.toString());this.handles[s];)i.push(s),a++,s=e.concat("-",a.toString());if(i.length>16){this.handles[i[i.length-1]].forEach((function(e){return n.createHandle(e)}));var l=(i.length-1)/15;for(a=0;Math.round(a)<i.length-1;a+=l)this.handles[i[Math.round(a)]].forEach((function(e){return n.createHandle(e)}))}else if(0===i.length){this.createHandle(o[o.length-1]);l=(o.length-1)/15;for(a=0;Math.round(a)<o.length-1;a+=l)this.createHandle(o[Math.round(a)])}else i.forEach((function(e){return n.handles[e].forEach((function(e){return n.createHandle(e)}))}))}else o.forEach((function(e){return n.createHandle(e)}))}else{var c=this.getViewAdjustment(),u=this.getBoundingBox(c,this.selectPath.path);this.createHandle({x:u.left,y:u.top}),this.createHandle({x:u.right,y:u.top}),this.createHandle({x:u.right,y:u.bottom}),this.createHandle({x:u.left,y:u.bottom})}},e.prototype.createHandle=function(t){var n=document.createElementNS(i.svgns,"circle");n.setAttribute("class","handle ".concat(e.highContrastSelectionHandleClassName)),n.setAttribute("stroke","#0078D2"),n.setAttribute("stroke-width","1px"),n.setAttribute("fill","#B2D6F9"),n.setAttribute("pointer-events","none"),n.setAttribute("cx",t.x.toString()),n.setAttribute("cy",t.y.toString()),n.setAttribute("r","3"),this.selectionLayer.appendChild(n)},e.prototype.iterateThroughSelectionHandles=function(e){for(var t=this.selectionLayer.querySelectorAll(".handle"),n=0;n<t.length;n++)e(t[n])},e.prototype.removeAllHandles=function(){for(var e=this.selectionLayer.querySelectorAll(".handle"),t=0;t<e.length;t++)this.selectionLayer.removeChild(e[t])},e.prototype.shouldShowBorder=function(e){var t=this.pathWidths[e];return"number"!=typeof t||t>1},e.prototype.setupTransformsForSelectPathOnly=function(e){this.selectPath.path.transform&&this.selectPath.path.transform.baseVal.appendItem(e);this.iterateThroughSelectionHandles((function(t){t.transform&&t.transform.baseVal.appendItem(e)}))},e.prototype.setupTransformsForHoverPathOnly=function(e){this.hoverPath.path.transform&&this.hoverPath.path.transform.baseVal.appendItem(e)},e.prototype.clearTransformsForSelectPathOnly=function(){this.selectPath.path.transform&&this.selectPath.path.transform.baseVal.clear();this.iterateThroughSelectionHandles((function(e){e.transform&&e.transform.baseVal.clear()}))},e.prototype.clearTransformsForHoverPathOnly=function(){this.hoverPath.path.transform&&this.hoverPath.path.transform.baseVal.clear()},e.highContrastSelectionPathClassName="MSChart-HighContrastSelectionPath",e.highContrastSelectionHandleClassName="MSChart-HighContrastSelectionHandle",e}()},3168:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgSink=void 0;var o=n(61269),r=n(5753),i=n(47526),a=n(57096),s=n(49210),l=n(29708),c=n(50556),u=n(29841),d=n(9001),p=n(37743),h=n(28128),g=n(66291),f=n(1056),m=n(1056),y=n(43010),v=n(33566),C=n(46675),b=n(42333);t.SvgSink=function(){function e(t,n,o,r){this.pathBuilder=new d.SvgPathBuilder,this.groupStack=[],this.masterInstancer=new a.MasterInstancer,this.isCreatingMaster=!1,this.handleSink=new g.HandleSink,this.handles={},this.datapointHandles=[],this.embeddedContentCollection=[],this.pathWidths={},this.sceneGraph=t,this.renderHost=o,this.observable=new y.ObservableSvgElement(this.sceneGraph,o,r);var u=this.sceneGraph.getSize(),p=this.sceneGraph.getBorderWidth();n.setAttribute("viewBox","".concat(-p," ").concat(-p," ").concat(u.width+2*p," ").concat(u.height+2*p)),n.setAttribute("class","".concat(e.chartRootClassName));var h=document.createElementNS(c.svgns,"style");n.appendChild(h),this.svgStyle=new i.SvgStyle(h),this.svgStyle.addRule("@media screen and (-ms-high-contrast: active),\n            screen and (forced-colors: active) {\n                path.".concat(e.highContrastClassName," {\n                    fill: window;\n                    stroke: windowText;\n                }\n            }")),this.svgStyle.addRule("@media screen and (-ms-high-contrast: active),\n            screen and (forced-colors: active) {\n                path.".concat(e.highContrastNoFillClassName," {\n                    stroke: windowText;\n                }\n            }")),this.svgStyle.addRule("@media screen and (-ms-high-contrast: active),\n            screen and (forced-colors: active) {\n                path.".concat(e.highContrastNoStrokeClassName," {\n                    fill: window;\n                }\n            }")),this.svgStyle.addRule("@media screen and (-ms-high-contrast: active),\n            screen and (forced-colors: active) {\n                tspan.".concat(e.highContrastClassName," {\n                    fill: windowText;\n                    stroke: none;\n                }\n            }")),this.svgStyle.addRule("svg.".concat(e.chartRootClassName," {\n                font-size: 12px;\n                pointer-events: painted;\n            }"));var f=document.createElementNS(c.svgns,"defs");this.gradientStorage=new s.SvgGradientStorage(f),this.patternStorage=new l.SvgPatternStorage(f),this.lineEndStorage=new C.SvgLineEndStorage(f),n.appendChild(f),this.clipRectStorage=new v.SvgClipRectStorage(n,t.getClipRects());var m=document.createElementNS(c.svgns,"g");n.appendChild(m),this.observable.bind(m),this.groupStack.push(m)}return e.prototype.addObserver=function(e){this.observable.addObserver(e)},e.prototype.removeObservers=function(){this.observable.removeObservers()},e.prototype.beginGeometry=function(e){if(this.isCreatingMaster)return this.masterInstancer.beginGeometry(e);if(!this.handleSink.beginGeometry(e))return!1;if(this.pathBounds=this.shouldStartCollectingPathBounds(e)?new u.Bounds2D:void 0,this.formatObject=e,this.formatObject){var t=this.formatObject.getFill(),n=this.formatObject.getLineFill(),r=(0,o.isGradientFillFormat)(n)||(0,o.isGradientFillFormat)(t);this.pathBuilder.setHasGradient(r)}return!0},e.prototype.endGeometry=function(){if(this.isCreatingMaster)return this.masterInstancer.endGeometry();if(!this.handleSink.endGeometry())return!1;for(this.pathBuilder.finishCurrentPath();this.pathBuilder.length>0;)this.addPathToSvg(this.pathBuilder.shift());return this.formatObject=void 0,!0},e.prototype.beginPath=function(e){return this.isCreatingMaster?this.masterInstancer.beginPath(e):!!this.handleSink.beginPath(e)},e.prototype.endPath=function(){return this.isCreatingMaster?this.masterInstancer.endPath():!!this.handleSink.endPath()},e.prototype.beginFigure=function(e,t,n){if(this.isCreatingMaster)return this.masterInstancer.beginFigure(e,t,n);if(!this.handleSink.beginFigure(e,t,n))return!1;for(this.pathBuilder.setFilled(t),this.pathBuilder.move(e);this.pathBuilder.length>0;)this.addPathToSvg(this.pathBuilder.shift());return this.pathBounds&&this.pathBounds.addPoint(e),void 0!==this.currentDatapointIndex&&this.datapointHandles[this.datapointHandles.length-1]!==e&&this.datapointHandles.push(e),!0},e.prototype.endFigure=function(e){return this.isCreatingMaster?this.masterInstancer.endFigure(e):!!this.handleSink.endFigure(e)&&(e&&this.pathBuilder.close(),!0)},e.prototype.addLines=function(e){var t=this;if(this.isCreatingMaster)return this.masterInstancer.addLines(e);if(!this.handleSink.addLines(e))return!1;if(this.pathBuilder.addLines(e),this.pathBounds){var n=this.pathBounds;e.forEach((function(e){return n.addPoint(e)}))}return void 0!==this.currentDatapointIndex&&e.forEach((function(e){t.datapointHandles[t.datapointHandles.length-1]!==e&&t.datapointHandles.push(e)})),!0},e.prototype.addBeziers=function(e){var t=this;if(this.isCreatingMaster)return this.masterInstancer.addBeziers(e);if(!this.handleSink.addBeziers(e))return!1;if(this.pathBuilder.addBeziers(e),this.pathBounds){var n=this.pathBounds;e.forEach((function(e){return n.addPoint(e)}))}void 0!==this.currentDatapointIndex&&e.filter((function(e,t){return(t+1)%3==0})).forEach((function(e){t.datapointHandles[t.datapointHandles.length-1]!==e&&t.datapointHandles.push(e)}));return!0},e.prototype.addEscape=function(e,t){if(!this.handleSink.addEscape(e,t))return!1;switch(e){case o.GeometryEscape.MasterBegin:this.masterInstancer.reset(),this.isCreatingMaster=!0;break;case o.GeometryEscape.MasterEnd:this.isCreatingMaster=!1;break;case o.GeometryEscape.DatapointBegin:if("number"!=typeof t)return!1;this.pathBuilder.setDatapointIndex(t),this.currentDatapointIndex=t;break;case o.GeometryEscape.DatapointEnd:this.pathBuilder.setDatapointIndex(void 0),this.currentDatapointIndex=void 0;break;case o.GeometryEscape.Instance2D:this.masterInstancer.createInstance(this,t)}return!0},e.prototype.render=function(){this.renderElement(this.sceneGraph.getRoot())},e.prototype.getHandles=function(){return this.handles},e.prototype.getPathWidths=function(){return this.pathWidths},e.prototype.getEmbeddedContentCollection=function(){return this.embeddedContentCollection},e.prototype.renderElement=function(e){var t=this;this.createAndPushGroup(e),this.renderEmbeddedContent(e)||(this.renderGeometry(e),this.renderText(e),this.renderCustomData(e.getId(),e.getCustomData(),this.renderHost));var n=this.handleSink.getHandles();this.handleSink.reset(),n.length>0&&(this.handles[e.getId()]=n),e.getChildren().forEach((function(e){return t.renderElement(e)})),this.popGroup()},e.prototype.addPathToSvg=function(e){if(!this.formatObject)throw new Error("Missing format object.");var t=document.createElementNS(c.svgns,"path");t.setAttribute("d",e.data);var n,o=this.getTop();if(!o)throw new Error("Element stack should not be empty.");var r=e.data.split("M").length-1>1&&!e.data.includes("Z");if(void 0!==e.datapointIndex){var i=o.id;if(i){var a=(0,h.getElementIdFromDomId)(i);if(a&&"number"==typeof e.datapointIndex){var s=a.concat("-",e.datapointIndex.toString()),l=(0,h.getDomIdFromElementId)(s);t.setAttribute("id",l),r&&((n=document.createElementNS(c.svgns,"g")).setAttribute("id",l),n.appendChild(t)),e.data.includes("Z")||r?this.handles[s]=this.datapointHandles:this.handles[s]=[this.datapointHandles[0]],this.datapointHandles=[]}}}var u=this.formatObject.getClipRectIndex();u>=0&&t.setAttribute("clip-path","url(#".concat(this.clipRectStorage.getIdForIndex(u),")")),r&&n?o.appendChild(n):o.appendChild(t),this.stylePath(e,o,t,n)},e.prototype.stylePath=function(t,n,i,a){if(!this.formatObject)throw new Error("Missing format object.");var s=this.formatObject.getFill(),l=this.formatObject.getLineFill();if(t.filled||l){var u=[];if(t.filled?u.push({name:"fill",value:this.resolveFill(s)}):u.push({name:"fill",value:"none"}),l){var d=l,p=this.resolveFill(d);u.push({name:"stroke",value:"".concat(p)});var h=this.formatObject.getLineThickness(),g="number"==typeof h,f=g?h:1;g&&u.push({name:"stroke-width",value:f.toString()});var y=this.formatObject.getLineDashType(),v=this.formatObject.getLineCapType(),C=this.formatObject.getLineJoinType();if(y!==o.LineDashType.Solid){var b=(0,r.createStrokeDashArray)(y,f,v).toString();u.push({name:"stroke-dasharray",value:b})}u.push({name:"stroke-linecap",value:this.getStrokeLineCap(v)}),u.push({name:"stroke-linejoin",value:this.getStrokeJoinType(C)});var E=this.formatObject.getHeadEnd(),A=this.formatObject.getTailEnd();E.type!==o.LineEndType.None&&u.push({name:"marker-start",value:this.resolveLineEnd(E,p,f)}),A.type!==o.LineEndType.None&&u.push({name:"marker-end",value:this.resolveLineEnd(A,p,f)});if(f<6&&!t.filled){var S=document.createElementNS(c.svgns,"path");S.setAttribute("class",m.hitTestingClassName),S.setAttribute("d",t.data),S.setAttribute("stroke","transparent"),S.setAttribute("fill","none"),S.setAttribute("stroke-width",6..toString());var I=this.formatObject.getClipRectIndex();I>=0&&S.setAttribute("clip-path","url(#".concat(this.clipRectStorage.getIdForIndex(I),")")),a?a.appendChild(S):n.appendChild(S)}if(!t.filled){var P="number"==typeof this.pathWidths[n.id]?this.pathWidths[n.id]:1;if(this.pathWidths[n.id]=Math.min(P,f),void 0!==t.datapointIndex){var T="number"==typeof this.pathWidths[i.id]?this.pathWidths[i.id]:1;this.pathWidths[i.id]=Math.min(T,f)}}}else u.push({name:"stroke",value:"none"});var x=this.svgStyle.ensureRule(u),w=t.filled?l?e.highContrastClassName:e.highContrastNoStrokeClassName:e.highContrastNoFillClassName;i.setAttribute("class","".concat(w," ").concat(x))}},e.prototype.getStrokeLineCap=function(e){switch(e){case o.LineCapType.Flat:return"butt";case o.LineCapType.Round:return"round";case o.LineCapType.Square:return"square";default:return"butt"}},e.prototype.getStrokeJoinType=function(e){switch(e){case o.LineJoinType.Round:return"round";case o.LineJoinType.Bevel:return"bevel";case o.LineJoinType.Miter:return"miter";default:return"round"}},e.prototype.resolveFill=function(e){if((0,o.isSolidFillFormat)(e))return e.color;if((0,o.isGradientFillFormat)(e)){var t=(0,p.generateUniqueId)();if((0,o.isLinearGradientShade)(e.shade))this.gradientStorage.storeLinearGradient(e.shade,e.stops,t);else{if(!(0,o.isRadialGradientShade)(e.shade))throw new Error("Invalid IGradientFillFormat.");if(!this.pathBounds)throw new Error("Bounds required for radial gradient.");this.gradientStorage.storeRadialGradient(e.shade,e.stops,this.pathBounds.getBounds(),t)}return"url(#".concat(t,")")}if((0,o.isPatternFillFormat)(e))return"url(#".concat(this.patternStorage.storePattern(e),")");throw new Error("Invalid format.")},e.prototype.resolveLineEnd=function(e,t,n){var r=(0,p.generateUniqueId)();switch(e.type){case o.LineEndType.Triangle:this.lineEndStorage.storeTriangleLineEnd(e.width,e.length,t,r,n);break;case o.LineEndType.Stealth:this.lineEndStorage.storeStealthLineEnd(e.width,e.length,t,r,n);break;case o.LineEndType.Diamond:this.lineEndStorage.storeDiamondLineEnd(e.width,e.length,t,r,n);break;case o.LineEndType.Oval:this.lineEndStorage.storeOvalLineEnd(e.width,e.length,t,r,n);break;case o.LineEndType.Arrow:this.lineEndStorage.storeArrowLineEnd(e.width,e.length,t,r,n);break;default:throw new Error("'None' format line end.")}return"url(#".concat(r,")")},e.prototype.getTop=function(){return this.groupStack.length>0?this.groupStack[this.groupStack.length-1]:void 0},e.prototype.createAndPushGroup=function(e){var t=document.createElementNS(c.svgns,"g");t.setAttribute("id",(0,h.getDomIdFromElementId)(e.getId()));var n=this.getTop();n&&n.appendChild(t),this.groupStack.push(t)},e.prototype.popGroup=function(){this.groupStack.pop()},e.prototype.renderText=function(t){var n=this,r=t.getText();if(r){var i=this.getTop();if(!i)throw new Error("Element stack should not be empty.");var a=document.createElementNS(c.svgns,"g"),s=r.getLocation(),l="translate(".concat(s.x,", ").concat(s.y,")"),u="rotate(".concat(r.getAngle(),")");a.setAttribute("transform","".concat(l," ").concat(u));var d=0;r.getLines().forEach((function(t){if(0!==t.getHeight()){var i=document.createElementNS(c.svgns,"text");i.setAttribute("y",(d+t.getBaseline()).toString(10));var s=0;r.getTextAlignment()===o.TextAlignment.Center&&(s=r.getSize().width/2,i.setAttribute("text-anchor","middle")),i.setAttribute("x",s.toString(10)),t.getRuns().forEach((function(r,a){var s=document.createElementNS(c.svgns,"tspan");s.textContent=r.getText();var l=a===t.getRuns().length-1;t.isTrimmed()&&l&&(s.textContent+="");var u=[{name:"font-family",value:r.getFaceName()},{name:"font-size",value:"".concat(r.getPixelSize(),"px")},{name:"stroke",value:"none"},{name:"fill",value:r.getColor()},{name:"white-space",value:"pre"},{name:"font-weight",value:r.getWeight().toString()}];switch(r.getStyle()){case o.FontStyle.Normal:u.push({name:"font-style",value:"normal"});break;case o.FontStyle.Italic:u.push({name:"font-style",value:"italic"});break;case o.FontStyle.Oblique:u.push({name:"font-style",value:"oblique"})}var d=n.svgStyle.ensureRule(u);s.setAttribute("class","".concat(e.highContrastClassName," ").concat(d)),i.appendChild(s)})),d+=t.getHeight(),a.appendChild(i)}})),i.appendChild(a)}},e.prototype.renderCustomData=function(e,t,n){if(t&&n){var o=this.getTop();if(!o)throw new Error("Element stack should not be empty.");var r=document.createElementNS(c.svgns,"g");r.setAttribute("class",f.customDataClassName),o.appendChild(r),n.renderCustomData(r,t)}},e.prototype.renderGeometry=function(e){e.enumerateGeometry(this)},e.prototype.renderEmbeddedContent=function(e){var t=e.getEmbeddedContent();if(t&&this.renderHost.isFeatureEnabled(b.inPlaceTextEditingFG,!1)){var n=e.getId(),o=this.GetEmbeddedContentEntry(t,n);return!!o&&(this.embeddedContentCollection.push(o),!0)}return!1},e.prototype.GetEmbeddedContentEntry=function(e,t){if(e)return{id:(0,h.getDomIdFromElementId)(t),embeddedContent:e}},e.prototype.shouldStartCollectingPathBounds=function(e){var t=e.getFill(),n=e.getLineFill();return!!(n&&(0,o.isGradientFillFormat)(n)&&(0,o.isRadialGradientShade)(n.shade))||!!(t&&(0,o.isGradientFillFormat)(t)&&(0,o.isRadialGradientShade)(t.shade))},e.chartRootClassName="MSChart-ChartRoot",e.highContrastClassName="MSChart-HighContrast",e.highContrastNoFillClassName="MSChart-HighContrastNoFill",e.highContrastNoStrokeClassName="MSChart-HighContrastNoStroke",e}()},47526:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgStyle=void 0;var o=n(37743),r=function(){function e(e){this.content="",this.rules=[],this.element=e}return e.prototype.addRule=function(e){var t=e.replace(/(\n|\s+)/g," ");t&&(this.content+=t),this.updateElement()},e.prototype.ensureRule=function(e){var t=this;e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}));var n="";if(!this.rules.some((function(o){return!!t.areRulesEqual(o.properties,e)&&(n=o.className,!0)}))){n=(0,o.generateUniqueId)();var r=".".concat(n," {");e.forEach((function(e){r+="".concat(e.name,": ").concat(e.value,";")})),r+="}",this.rules.push({className:n,properties:e}),this.addRule(r)}return n},e.prototype.areRulesEqual=function(e,t){return e.length===t.length&&e.every((function(e,n){return e.name===t[n].name&&e.value===t[n].value}))},e.prototype.updateElement=function(){this.element.textContent=this.content},e}();t.SvgStyle=r},24032:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SvgTooltip=void 0;var o=n(50556),r=n(49991),i=function(){function e(e){this.padding=10,this.x=0,this.y=0,this.offset=r.TooltipOffset.Above,this.rootElement=e,this.ensureTooltip()}return e.prototype.show=function(){this.updateRectangle(),this.tooltipGroup.setAttribute("visibility","visible")},e.prototype.hide=function(){this.tooltipGroup.setAttribute("visibility","hidden")},e.prototype.isVisible=function(){return"visible"===this.tooltipGroup.getAttribute("visibility")},e.prototype.isOversized=function(){var e=this.tooltipText.getBoundingClientRect();return this.rootElement.clientWidth<=e.width||this.rootElement.clientHeight<=e.height},e.prototype.setPosition=function(e,t){this.x=e,this.y=t;var n=this.tooltipText.getBoundingClientRect(),o=this.getOffsetDimensions(e,t,n.width,n.height);o=this.adjustOffset(o,n.width,n.height);for(var r=this.tooltipText.childNodes,i=0;i<r.length;++i){if(r[i].nodeType===Node.ELEMENT_NODE)r[i].setAttribute("x","".concat(o[0]))}this.tooltipText.setAttribute("y","".concat(o[1])),this.tooltipBorderRectangle.setAttribute("x","".concat(o[0]-this.padding/2)),this.tooltipBorderRectangle.setAttribute("y","".concat(o[1]-2*this.padding))},e.prototype.setOffset=function(e){this.offset!==e&&(this.offset=e,this.setPosition(this.x,this.y))},e.prototype.setHeader=function(e){this.tooltipTspan.textContent=e,this.tooltipTspan.setAttribute("x","0")},e.prototype.addPair=function(e,t){var n=e,r=document.createElementNS(o.svgns,"tspan");r.textContent=n,r.setAttribute("dy","17px"),r.setAttribute("x","0"),this.setStyle(r,s);var i=document.createElementNS(o.svgns,"tspan");i.textContent=t,i.setAttribute("dy","12px"),i.setAttribute("x","0"),this.setStyle(i,l),this.tooltipText.appendChild(r),this.tooltipText.appendChild(i)},e.prototype.removePairs=function(){for(var e=this.tooltipText.childElementCount;e>1;)this.tooltipText.removeChild(this.tooltipText.lastChild),e-=1},e.prototype.getRoot=function(){return this.rootElement},e.prototype.getTooltipBorderRectangle=function(){return this.tooltipBorderRectangle},e.prototype.getTooltipText=function(){return this.tooltipText},e.prototype.ensureTooltip=function(){this.tooltipGroup=document.createElementNS(o.svgns,"g"),this.tooltipGroup.setAttribute("visibility","hidden"),this.tooltipGroup.setAttribute("transform","translate(0,0) rotate(0)"),this.tooltipGroup.style.pointerEvents="none",this.tooltipBorderRectangle=document.createElementNS(o.svgns,"rect"),this.setStyle(this.tooltipBorderRectangle,c),this.tooltipGroup.appendChild(this.tooltipBorderRectangle),this.tooltipText=document.createElementNS(o.svgns,"text"),this.tooltipGroup.appendChild(this.tooltipText),this.tooltipTspan=document.createElementNS(o.svgns,"tspan"),this.setStyle(this.tooltipTspan,a),this.tooltipText.appendChild(this.tooltipTspan),this.rootElement.appendChild(this.tooltipGroup)},e.prototype.setStyle=function(e,t){var n="";t.forEach((function(e){n+="".concat(e.name,": ").concat(e.value,";")})),e.setAttribute("style","".concat(n))},e.prototype.adjustOffset=function(e,t,n){var o=e[0],r=e[1];return r-n<0&&(r=2*this.padding),o<0&&(o=this.padding),o+t>this.rootElement.clientWidth-this.padding&&(o=this.rootElement.clientWidth-(t+this.padding)),r+n>this.rootElement.clientHeight-this.padding&&(r=this.rootElement.clientHeight-this.padding-n),[o,r]},e.prototype.getOffsetDimensions=function(e,t,n,o){switch(this.offset){case r.TooltipOffset.Above:return[e-n/2,t-o+this.padding/2];case r.TooltipOffset.BelowRight:return[e+this.padding,t+o+1.5*this.padding];default:throw new Error("Invalid offset.")}},e.prototype.updateRectangle=function(){var e=this.tooltipText.getBoundingClientRect();this.tooltipBorderRectangle.setAttribute("width","".concat(e.width+this.padding)),this.tooltipBorderRectangle.setAttribute("height","".concat(e.height+this.padding/2))},e}();t.SvgTooltip=i;var a=[{name:"font-family",value:"Calibri"},{name:"font-size",value:"17px"},{name:"stroke",value:"none"},{name:"fill",value:"#000000"},{name:"white-space",value:"pre"},{name:"font-weight",value:"400"},{name:"font-style",value:"normal"}],s=[{name:"font-family",value:"Calibri"},{name:"font-size",value:"13px"},{name:"stroke",value:"none"},{name:"fill",value:"#000000"},{name:"white-space",value:"pre"},{name:"font-weight",value:"400"},{name:"font-style",value:"normal"}],l=[{name:"font-family",value:"Calibri"},{name:"font-size",value:"15px"},{name:"stroke",value:"none"},{name:"fill",value:"#000000"},{name:"white-space",value:"pre"},{name:"font-weight",value:"700"},{name:"font-style",value:"normal"}],c=[{name:"stroke",value:"black"},{name:"fill",value:"white"},{name:"fill-opacity",value:".93"},{name:"stroke-width",value:".5px"}]},74165:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IvyRenderer=void 0,function(e){e[e.Image=0]="Image",e[e.Svg=1]="Svg",e[e.Canvas=2]="Canvas",e[e.JSON=3]="JSON"}(t.IvyRenderer||(t.IvyRenderer={}))},52457:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createStrokeDashArray=t.lineDashStyleToDashArray=t.isMissingNumber=t.pointToString=t.cssStringToColor=t.colorToCSSString=t.brightenColor=t.isInRange=t.toHex=t.getDataTypeFromDimension=t.getSeriesFieldFromDimension=void 0;var o=n(61269),r=n(56877);var i,a=((i={})[r.ChartDataDimension.None]="none",i[r.ChartDataDimension.CategoryNames]="categoryNames",i[r.ChartDataDimension.Values]="values",i[r.ChartDataDimension.XValues]="xValues",i[r.ChartDataDimension.YValues]="yValues",i[r.ChartDataDimension.SizeValues]="sizeValues",i[r.ChartDataDimension.OpenValues]="openValues",i[r.ChartDataDimension.CloseValues]="closeValues",i[r.ChartDataDimension.HighValues]="highValues",i[r.ChartDataDimension.LowValues]="lowValues",i[r.ChartDataDimension.RValues]="rValues",i[r.ChartDataDimension.ThetaValues]="thetaValues",i[r.ChartDataDimension.ErrorBarsPosValues]="errorBarsPosValues",i[r.ChartDataDimension.ErrorBarsNegValues]="errorBarsNegValues",i[r.ChartDataDimension.CanvasXValues]="canvasXValues",i[r.ChartDataDimension.CanvasYValues]="canvasYValues",i[r.ChartDataDimension.ParentIndices]="parentIndices",i[r.ChartDataDimension.StringRenderingData]="stringRenderingData",i[r.ChartDataDimension.DiscreteRenderingData]="discreteRenderingData",i[r.ChartDataDimension.ContinuousRenderingData]="continuousRenderingData",i[r.ChartDataDimension.CustomValues]="customValues",i[r.ChartDataDimension.CustomStrings]="customStrings",i[r.ChartDataDimension.DataIndex]="dataIndex",i[r.ChartDataDimension.PartialValues]="partialValues",i[r.ChartDataDimension.ControlValues]="controlValues",i[r.ChartDataDimension.CategoryValues]="categoryValues",i[r.ChartDataDimension.CategoryWidths]="categoryWidths",i[r.ChartDataDimension.RegionIds]="regionIds",i[r.ChartDataDimension.Count]="count",i);function s(e){var t=e.toString(16).toUpperCase();return 1===t.length?"0".concat(t):t}function l(e){switch(e){case o.LineDashStyle.Dash:return[4,3];case o.LineDashStyle.Dot:return[1,3];case o.LineDashStyle.DashDot:return[4,3,1,3];case o.LineDashStyle.DashDotDot:return[4,3,1,3,1,3];default:return[0]}}t.getSeriesFieldFromDimension=function(e){return a[e]},t.getDataTypeFromDimension=function(e){switch(e){case r.ChartDataDimension.CategoryNames:case r.ChartDataDimension.CustomStrings:case r.ChartDataDimension.StringRenderingData:case r.ChartDataDimension.RegionIds:return r.ChartDataType.String;case r.ChartDataDimension.Values:case r.ChartDataDimension.XValues:case r.ChartDataDimension.YValues:case r.ChartDataDimension.SizeValues:case r.ChartDataDimension.OpenValues:case r.ChartDataDimension.CloseValues:case r.ChartDataDimension.HighValues:case r.ChartDataDimension.LowValues:case r.ChartDataDimension.RValues:case r.ChartDataDimension.ThetaValues:case r.ChartDataDimension.ErrorBarsPosValues:case r.ChartDataDimension.ErrorBarsNegValues:case r.ChartDataDimension.CanvasXValues:case r.ChartDataDimension.CanvasYValues:case r.ChartDataDimension.ParentIndices:case r.ChartDataDimension.DiscreteRenderingData:case r.ChartDataDimension.CustomValues:case r.ChartDataDimension.DataIndex:case r.ChartDataDimension.PartialValues:case r.ChartDataDimension.ControlValues:case r.ChartDataDimension.CategoryValues:case r.ChartDataDimension.CategoryWidths:return r.ChartDataType.Numeric;default:return r.ChartDataType.Undefined}},t.toHex=s,t.isInRange=function(e,t,n){return e>=t&&e<=n},t.brightenColor=function(e,t){t>0?(e.r=e.r*(1-t)+t,e.g=e.g*(1-t)+t,e.b=e.b*(1-t)+t):(e.r*=t+1,e.g*=t+1,e.b*=t+1)},t.colorToCSSString=function(e){if(e){var t=Math.floor(255*e.r),n=Math.floor(255*e.g),o=Math.floor(255*e.b);return 1===e.a?"#".concat(s(t)).concat(s(n)).concat(s(o)):"rgba(".concat(t,",").concat(n,",").concat(o,",").concat(e.a.toFixed(4),")")}},t.cssStringToColor=function(e){var t=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(t)return{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255,a:1};var n=/^rgba\((\d+),(\d+),(\d+),(\d+\.\d+)\)$/i.exec(e);return n?{r:+n[1]/255,g:+n[2]/255,b:+n[3]/255,a:+n[4]}:void 0},t.pointToString=function(e){return"".concat(e.x,",").concat(e.y," ")},t.isMissingNumber=function(e){return isNaN(e)},t.lineDashStyleToDashArray=l,t.createStrokeDashArray=function(e,t){return l(e).map((function(e){return e*t}))}},72620:(e,t,n)=>{n.d(t,{g6:()=>o,Cc:()=>l,EF:()=>s});var o,r=n(9181),i=n(19728),a=function(){var e="MsgExtCardFooterStore";return(0,r.I$)().get(e)?(0,r.I$)().get(e):(0,r.y$)(e,{cardsFooterMap:new i.ObservableMap})()},s=(0,r.jK)("updateFooterStore",(function(e,t){var n,o,r,i,s=null===(o=null===(n=a())||void 0===n?void 0:n.cardsFooterMap)||void 0===o?void 0:o.get(e);s&&t?(s.actionMessageProps=t.actionMessageProps,s.dismissType=t.dismissType,s.type=t.type,s.messageType=t.messageType):null===(i=null===(r=a())||void 0===r?void 0:r.cardsFooterMap)||void 0===i||i.set(e,t)}));function l(e){var t,n;return null===(n=null===(t=a())||void 0===t?void 0:t.cardsFooterMap)||void 0===n?void 0:n.get(e)}!function(e){e[e.GenericError=0]="GenericError",e[e.AppNotInstalled=1]="AppNotInstalled",e[e.AppNotAvailable=2]="AppNotAvailable",e[e.ComposeScenario=3]="ComposeScenario",e[e.UntrustedUrl=4]="UntrustedUrl",e[e.VerificationInProgress=5]="VerificationInProgress",e[e.VerificationFailed=6]="VerificationFailed",e[e.VerificationError=7]="VerificationError",e[e.AppNotInstalledWithInstallLink=8]="AppNotInstalledWithInstallLink",e[e.AppNotUpdatedWithInstallLink=9]="AppNotUpdatedWithInstallLink",e[e.AppNotUpdated=10]="AppNotUpdated"}(o||(o={}))},70962:(e,t,n)=>{n.d(t,{h:()=>ue});var o=n(18850),r=n(11120),i=n(46030),a=n(30185),s=n(25510),l=n(30541),c=n(31414),u=n(30112),d=n(93536),p=n(8520);const h=p.createContext(void 0);var g=n(23913),f=n(47063);class m{constructor(e){this.msgExtTelemetryService=e}LogInfo(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogInfo(t)}LogError(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogError(t)}LogException(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogException(t)}LogWarning(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogWarning(t)}LogVerbose(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogVerbose(t)}LogMetric(e){const t=this.convertRequest(e);this.msgExtTelemetryService.LogMetric(t)}convertRequest(e){return Object.assign(Object.assign({},e),{source:4})}}function y(){const e=p.useMemo((()=>new f.e),[]),t=p.useContext(h);if(!t)return p.createElement(p.Fragment,null);const n=new m(t.serviceProvider.telemetryService),o=Object.assign(Object.assign({},t.serviceProvider),{telemetryService:n});return p.createElement(g.v,{cardData:t.cardDetails,hostConfig:t.hostConfig,uxRegistry:e,serviceProvider:o,onPrepareRuntimeActivityRequest:t.beforeActionExecute,onRuntimeActivityResponse:t.postActionExecute})}function v(e){const{serviceProvider:t,cardDetails:n,hostConfig:o,beforeActionExecute:r,postActionExecute:i}=e;return p.createElement(h.Provider,{value:{serviceProvider:t,cardDetails:n,hostConfig:o,beforeActionExecute:r,postActionExecute:i}},p.createElement(y,null))}var C=n(3817),b=n(71427),E=n(36713),A=n(11404),S=n(92026),I=n(24926),P=n(72620),T=n(48227);function x(e){const t=(0,c.pq)(e);let n;if(null==t?void 0:t.type){const e=function(e){switch(e){case c.SZ.error:return T.H.error;case c.SZ.warning:return T.H.warning;default:return T.H.info}}(t.messageType);n={dismissType:I.U.Automatic,type:w(t.type),messageType:e}}(0,P.EF)(e,n)}function w(e){switch(e){case c.n4.AppNotAvailable:return P.g6.AppNotAvailable;case c.n4.AppNotInstalled:return P.g6.AppNotInstalled;case c.n4.ComposeScenario:return P.g6.ComposeScenario;default:return P.g6.GenericError}}var k=n(89797);const _=(0,C.PA)((function(e){const{cardId:t,serviceProvider:n,hostConfig:o,postActionExecute:r}=e,i=(0,l.XF)(t),a=(e=>t=>{switch((0,c.BP)(e)){case S.nc.Full:return Promise.resolve(!1);case S.nc.Limited:return t instanceof b.G||t instanceof E.q&&t.trigger===A.x.Automatic?Promise.resolve(!1):(x(e),Promise.resolve(!0));default:return x(e),Promise.resolve(!0)}})(t);return i?p.createElement(v,{serviceProvider:n,cardDetails:i,hostConfig:null!=o?o:new k.a(s,{choiceSetInputValueSeparator:",",supportsInteractivity:!0,spacing:{small:8,default:12,medium:16,large:20,extraLarge:24,padding:16},separator:{lineThickness:1,lineColor:"#EEEEEE"},imageSizes:{small:32,medium:52,large:100},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:14,large:18,extraLarge:24},fontWeights:{lighter:200,default:400,bolder:600}}},textStyles:{heading:{fontType:"default",size:"large",weight:"bolder",color:"default",isSubtle:!1}},textBlock:{headingLevel:2},containerStyles:{default:{foregroundColors:{default:{default:"#1f1f1f",subtle:"#424242"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#115EA3",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}},borderColor:"#CCCCCC",backgroundColor:"#fafafa"},emphasis:{foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#115EA3",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}},borderColor:"#666666",backgroundColor:"#fff9f8f7"},accent:{borderColor:"#62A8F7",backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#115EA3",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},good:{borderColor:"#69E569",backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#115EA3",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},attention:{borderColor:"#FF764C",backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#115EA3",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}},warning:{borderColor:"#FFBC51",backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#ff252424",subtle:"#bf252424"},dark:{default:"#252424",subtle:"#bf252424"},light:{default:"#ffffff",subtle:"#fff3f2f1"},accent:{default:"#115EA3",subtle:"#8b8cc7"},good:{default:"#92c353",subtle:"#e592c353"},warning:{default:"#f8d22a",subtle:"#e5f8d22a"},attention:{default:"#c4314b",subtle:"#e5c4314b"}}}},actions:{maxActions:6,spacing:"Default",buttonSpacing:8,showCard:{actionMode:"Inline",inlineTopMargin:16,style:"emphasis"},preExpandSingleShowCardAction:!1,actionsOrientation:"Horizontal",actionAlignment:"Left",allowButtonsToWrap:!0},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:"Medium",maxImageHeight:100},factSet:{title:{size:"Default",color:"Default",isSubtle:!1,weight:"Bolder",wrap:!0},value:{size:"Default",color:"Default",isSubtle:!1,weight:"Default",wrap:!0},spacing:16}},void 0,void 0,"light"),beforeActionExecute:a,postActionExecute:r}):p.createElement(p.Fragment,null);var s}));var D=n(65593),F=n(70734);const L=(0,o.Ex)("msgext-card-preview.genericError"),O=(0,o.Ex)("msgext-card-preview.notAllowedInCompose"),R=(0,o.Ex)("msgext-card-preview.appNotAvailable"),M=(0,o.Ex)("msgext-card-preview.untrustedUrl"),B=(0,o.Ex)("msgext-card-preview.appNotInstalled"),N=(0,C.PA)((function(e){const t=(0,P.Cc)(e.cardId),n=function(e){switch(e){case P.g6.AppNotAvailable:return R;case P.g6.AppNotInstalled:return B;case P.g6.ComposeScenario:return O;case P.g6.GenericError:return L;case P.g6.UntrustedUrl:return M;default:return L}}(null==t?void 0:t.type),o=(0,D.kQ)({messageText:n}),r=p.useMemo((()=>{return(null==t?void 0:t.type)?(e=o.messageText(),p.createElement("div",null,e)):p.createElement(p.Fragment,null);var e}),[t,o]);if(!t)return p.createElement(p.Fragment,null);let i;return t.actionMessageProps&&(i={text:t.actionMessageProps.actionMessage,onClick:t.actionMessageProps.onClick}),p.createElement(F.J,{message:r,messageType:t.messageType,dismissType:t.dismissType,action:i,onDismiss:V(e.cardId),autoDismissTimer:t.autoDismissTimer})}));const V=e=>()=>{(0,P.EF)(e,{})};var H=n(21278),U=n(16895),j=n(658),z=n(62653);const G=(0,H.Q)("MsgExtCardPreview",(0,j.n)({root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({backgroundColor:z.L.colorNeutralBackground2},U.Pt.borderStyle("solid")),U.Pt.borderWidth("1px")),U.Pt.borderRadius("12px")),U.Pt.borderColor(z.L.colorNeutralStroke1)),U.Pt.overflow("hidden"))})),W=(0,j.n)({button:Object.assign(Object.assign(Object.assign(Object.assign({},U.Pt.borderRadius("4px")),U.Pt.borderWidth("1px")),U.Pt.borderStyle("solid")),{height:"32px"})});var q=n(87789),Q=n(54664),K=(0,H.Q)("MsgExtCardHeader",(0,j.n)({root:{height:"2px",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},progressBar:{borderTopLeftRadius:"2px",borderTopRightRadius:"2px",borderBottomLeftRadius:"2px",borderBottomRightRadius:"2px",paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},itemProgress:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:0},flex:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}}})),Y=n(79490),$=n(15954),J=n(19728),X=function(){var e="MsgExtCardHeaderStore";return(0,$.I$)().get(e)?(0,$.I$)().get(e):(0,$.y$)(e,{cardsMap:new J.ObservableMap})()},Z=((0,$.jK)("initializeHeaderStore",(function(e,t){var n={options:t};X().cardsMap.set(e,n)})),(0,$.jK)("updateMsgExtCardOptionsFeature",(function(e,t){var n=X().cardsMap.get(e);n?n.options=t:X().cardsMap.set(e,{options:t})})));(0,$.jK)("addMsgextCardOptionsFeature",(function(e,t){var n,o,r=null===(o=null===(n=X())||void 0===n?void 0:n.cardsMap)||void 0===o?void 0:o.get(e);if(r){var i=[t];if(r.options)(0,Y.__spreadArray)([],(0,Y.__read)(r.options),!1).forEach((function(e){t.type!==e.type&&i.push(e)}));r.options=i}})),(0,$.jK)("removeMsgExtCardOptionsFeature",(function(e,t){var n=X().cardsMap.get(e);if(n){var o=[];n.options&&(o=(0,Y.__spreadArray)([],(0,Y.__read)(n.options),!1)),o.forEach((function(e,n,o){e.type===t.type&&o.splice(n,1)})),n.options=o}}));var ee=(0,C.PA)((function(e){var t=e.processingCompleted,n=e.appIcon,o=e.appName,r=e.options,i=e.cardId,a=e.hideProgressIndicator,s=e.optionsComponents,l=K(),c=(0,u.z)(l.progressBar,l.itemProgress,l.root);p.useEffect((function(){r&&Z(i,r)}),[]);var d=function(e){var t,n,o;return null===(o=null===(n=null===(t=X())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===o?void 0:o.options}(i);return p.createElement("div",{className:"progressIndicatorStyles.flex"},a?null:p.createElement(Q.z,{value:t?1:void 0,className:c}),p.createElement(q.D,{appName:o,appIcon:n,options:d,optionsComponents:s}))})),te=n(68779),ne=n(21137),oe=n(79689),re=n(88700);const ie=(0,o.Ex)("msgext-card-preview.Copied"),ae=(0,o.Ex)("msgext-card-preview.Copy"),se=(0,H.Q)("M365CardHeaderOptions",(0,j.n)({cardOptions:{paddingTop:"12px",paddingRight:"16px"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1},button:{backgroundColor:z.L.colorNeutralCardBackground,":hover":{backgroundColor:z.L.colorNeutralCardBackground}}}));function le(e){const t=se(),n=(0,u.z)(t.flexItem,t.cardOptions),o=(0,D.Lh)(ae),r=(0,D.Lh)(ie),[i,a]=p.useState({tooltip:o,visible:void 0});return p.createElement("div",{className:n},p.createElement(te.m,{content:i.tooltip,relationship:"label",visible:i.visible},p.createElement(ne.$,{className:t.button,size:"small",style:{border:"none"},icon:i.tooltip===r?p.createElement(oe.c6S,null):p.createElement(re.k8e,null),onClick:()=>{e.onClick(),setTimeout((()=>{a({tooltip:o,visible:void 0})}),5e3),a({tooltip:r,visible:!0})}})))}const ce=(0,C.PA)((function(e){var t,n,o;const{cardId:i,hostService:a,telemetryService:s}=e,u=(0,c.BP)(i),d=(0,l.XF)(i);if(!d)return p.createElement(p.Fragment,null);const h=(0,l.Y6)(i),g=u!==S.nc.Unknown,f=null!==(t=null==h?void 0:h.name)&&void 0!==t?t:null==d?void 0:d.appName,m=null!==(n=null==h?void 0:h.largeImageUrl)&&void 0!==n?n:null==d?void 0:d.appIcon,y=function(e,t,n){const o=[];if("compose"===e){const e={iconProps:{iconName:"Cancel",title:"Remove card"},onMenuClick:()=>{t.deleteCard({cardDetails:n})}};o.push(e)}return o}(null!==(o=(0,l.Ey)(i))&&void 0!==o?o:"consume",a,d),v=function(e,t,n){var o,i;const a=[];let s;try{s=JSON.parse(null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"{}")}catch(e){null==n||n.LogError({type:r.FY.LogError,tag:r.m2.MsgExtCardHeader,name:r.ru.getHeaderOptions,message:r.FG.cardContentParseError}),s={}}if(null===(i=s.metadata)||void 0===i?void 0:i.webUrl){const n=()=>{e.copyCard({cardDetails:t})};return a.push(p.createElement(le,{onClick:n})),a}return}(a,d,s);return p.createElement(ee,{cardId:d.cardId,processingCompleted:g,appIcon:m,appName:f,options:y,hideProgressIndicator:!0,optionsComponents:v})}));function ue(e){const{cardDetails:t,serviceProvider:n,config:h,renderingMode:g,showCardHeader:f=!0}=e,m=p.useMemo((()=>(0,i.N)(null==h?void 0:h.themeMode,null==h?void 0:h.locale,null==h?void 0:h.featureFlags)),[h]),y=G(),v=p.useMemo((()=>new a.k(null==n?void 0:n.telemetryService,r.yx.CardRender,r.xe.MsgExtCardPreview)),[t,n,g]);p.useEffect((()=>{var e;const t=(0,o.U5)(null!==(e=m.locale)&&void 0!==e?e:"en-us");(0,o.ex)().then((e=>{e!==t&&(0,o.Gd)(t)}))}),[m]),p.useEffect((()=>{const e={};if(!n.appService)return void v.logMetricEndWithError({props:e,diagnosticsData:`TypeOfCard: ${t.contentType},  cardId : ${t.cardId}, Error: Card rendering failed due to invalid appService, Appid: ${(0,s.n)(null==t?void 0:t.titleId,null==t?void 0:t.appId)}`});const o=null!=g?g:"consume";(0,l.OL)(t,o,n.appService),v.logMetricEnd({props:e,diagnosticsData:`TypeOfCard: ${t.contentType},  cardId : ${t.cardId} , CardRenderingMode : ${o}, Appid: ${(0,s.n)(null==t?void 0:t.titleId,null==t?void 0:t.appId)}, actionabilityStatus: ${(0,c.BP)(t.cardId)}`},null==m?void 0:m.correlationId)}),[t,n,g]);const C={useButtonStyles_unstable:e=>{const t=e;t.root.className=(0,u.z)(t.root.className,W().button)}};return p.createElement(d.q,{customStyleHooks_unstable:C},p.createElement("div",{className:y.root,"data-testid":"MsgExtCardPreview"},f&&p.createElement(ce,{cardId:t.cardId,hostService:n.hostService,telemetryService:n.telemetryService}),p.createElement(_,{cardId:t.cardId,serviceProvider:n,hostConfig:m,postActionExecute:e.postActionExecute}),p.createElement(N,{cardId:t.cardId})))}},31414:(e,t,n)=>{n.d(t,{SZ:()=>u,n4:()=>d,BP:()=>p,pq:()=>h});var o=n(9181),r=n(19728);const i=()=>{const e="MsgExtCardStoreActionPolicy";if((0,o.I$)().get(e))return(0,o.I$)().get(e);return(0,o.y$)(e,{cardsMap:new r.ObservableMap})()},a=(0,o.jK)("updateActionabilityStatus",((e,t)=>{var n,o,r;const a=null===(o=null===(n=i())||void 0===n?void 0:n.cardsMap)||void 0===o?void 0:o.get(e);a?a.actionabilityStatus=t:null===(r=i().cardsMap)||void 0===r||r.set(e,{actionabilityStatus:t})}));var s=n(30541),l=n(92026);const c=(0,o.jK)("updateDisabledActionabilityReason",((e,t)=>{var n,o;const r=null===(o=null===(n=i())||void 0===n?void 0:n.cardsMap)||void 0===o?void 0:o.get(e);r&&(r.reason=t)}));var u,d;!function(e){e[e.error=0]="error",e[e.info=1]="info",e[e.warning=2]="warning"}(u||(u={})),function(e){e[e.AppNotInstalled=0]="AppNotInstalled",e[e.AppNotAvailable=1]="AppNotAvailable",e[e.ComposeScenario=2]="ComposeScenario"}(d||(d={}));(0,o.zZ)(s.X4,(e=>{var t,n,o,r,i,p,h;let g;const f=(0,s.Ey)(e.cardId),m=(0,s.MT)(e.cardId);let y=l.nc.None;m===l.iV.Installed?y=l.nc.Full:("compose"===f&&(y=l.nc.Limited,g={type:d.ComposeScenario,messageType:u.info}),m===l.iV.NotInstalled?g={type:d.AppNotInstalled,messageType:u.error}:m===l.iV.NotAvailable&&(g={type:d.AppNotAvailable,messageType:u.error}));const v=null!==(r=null===(o=null===(n=null===(t=e.appInfo)||void 0===t?void 0:t.bots)||void 0===n?void 0:n[0])||void 0===o?void 0:o.id)&&void 0!==r?r:null===(h=null===(p=null===(i=e.appInfo)||void 0===i?void 0:i.inputExtensions)||void 0===p?void 0:p[0])||void 0===h?void 0:h.botId;if(v){const t=(0,s.XF)(e.cardId);t&&(t.botId=v,(0,s.Wy)(e.cardId,t))}a(e.cardId,y),c(e.cardId,g)}));function p(e){var t,n,o;return null===(o=null===(n=null===(t=i())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===o?void 0:o.actionabilityStatus}function h(e){var t,n,o;return null===(o=null===(n=null===(t=i())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===o?void 0:o.reason}},30541:(e,t,n)=>{n.d(t,{Y6:()=>d,MT:()=>h,XF:()=>g,Ey:()=>f,OL:()=>r,X4:()=>s,Wy:()=>l});var o=n(9181);const r=(0,o.XI)("initializeMsgExtCardState",((e,t,n,o,r)=>({cardDetails:e,renderingMode:t,appService:n,channelService:o,actionabilityStatus:r})));var i=n(19728);const a=()=>{const e="MsgExtCardStoreVnext";if((0,o.I$)().get(e))return(0,o.I$)().get(e);return(0,o.y$)(e,{cardsMap:new i.ObservableMap})()},s=((0,o.lO)(r,(e=>{const t={cardDetails:e.cardDetails,renderingMode:e.renderingMode};a().cardsMap.set(e.cardDetails.cardId,t)})),(0,o.XI)("updateMsgExtAppInfo",((e,t,n)=>({cardId:e,appInfo:t,channelService:n})))),l=((0,o.lO)(s,(e=>{const t=a().cardsMap.get(e.cardId);t&&(t.appInfo=e.appInfo)})),(0,o.jK)("updateMsgExtCardDetails",((e,t)=>{const n=a().cardsMap.get(e);n&&(n.cardDetails=t)})));var c=n(79490),u=n(15666);(0,o.zZ)(r,(e=>(0,c.__awaiter)(void 0,void 0,void 0,(function*(){let t;try{const n=e.cardDetails;if(n&&n.appId){const o=yield e.appService.getApp({id:n.appId});o&&(o.titleInfo?t=(0,u.P)(o.titleInfo):o.appDefinition&&(t=o.appDefinition))}}catch(e){}s(e.cardDetails.cardId,t,e.channelService)}))));function d(e){var t,n;return null===(n=null===(t=null==a?void 0:a().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.appInfo}var p=n(92026);function h(e){var t;const n=null===(t=a().cardsMap.get(e))||void 0===t?void 0:t.appInfo;if(n&&n.state)switch(n.state){case"InstalledAndDeprecated":case"Featured":case"InstalledAndHidden":case"NotInstalled":case"PreConsented":return p.iV.NotInstalled;case"Installed":case"AdminPreInstalled":case"InstalledAndPermanent":return p.iV.Installed;case"RequireConsent":return p.iV.NeedsConsentForUpgrade;default:return p.iV.NotAvailable}return p.iV.NotAvailable}function g(e){var t,n;return null===(n=null===(t=null==a?void 0:a().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.cardDetails}function f(e){var t,n;return null===(n=null===(t=null==a?void 0:a().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.renderingMode}},92026:(e,t,n)=>{var o,r,i,a,s,l,c,u,d,p;n.d(t,{FY:()=>r,iV:()=>s,nc:()=>u}),function(e){e.Unknown="Unknown",e.Success="Success",e.Partial="Partial",e.Failed="Failed",e.Error="Error"}(o||(o={})),function(e){e[e.LogInfo=1]="LogInfo",e[e.LogError=2]="LogError",e[e.LogException=3]="LogException",e[e.LogMetric=4]="LogMetric"}(r||(r={})),function(e){e[e.Automatic=0]="Automatic",e[e.Manual=1]="Manual"}(i||(i={})),function(e){e.DeleteCard="DeleteCard",e.CopyCard="CopyCard",e.ManualRefresh="ManualRefresh",e.GetApp="GetApp",e.CardCopied="CardCopied"}(a||(a={})),function(e){e[e.NotAvailable=0]="NotAvailable",e[e.NotInstalled=1]="NotInstalled",e[e.Installed=2]="Installed",e[e.NeedsConsentForUpgrade=3]="NeedsConsentForUpgrade"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MailEditor=1]="MailEditor",e[e.MailReadingPane=2]="MailReadingPane",e[e.MailEditorReplyForward=3]="MailEditorReplyForward",e[e.MailReadingPaneFromExProp=4]="MailReadingPaneFromExProp"}(l||(l={})),function(e){e[e.Light=0]="Light",e[e.Dark=1]="Dark"}(c||(c={})),function(e){e[e.Full=0]="Full",e[e.Limited=1]="Limited",e[e.None=2]="None",e[e.Unknown=3]="Unknown"}(u||(u={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview",e.silentAuth="silentAuth"}(d||(d={})),function(e){e[e.Unknown=0]="Unknown",e[e.Auth=1]="Auth",e[e.Config=2]="Config",e[e.SilentAuth=3]="SilentAuth"}(p||(p={}))},14743:(e,t,n)=>{var o;n.d(t,{iP:()=>r});var r=function(e,t){return void 0===t&&(t=!1),o?o.getBooleanFeatureGate(e,t):t}},76916:(e,t,n)=>{var o;n.d(t,{n:()=>o}),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles"}(o||(o={}))},26529:(e,t,n)=>{var o;n.d(t,{k:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={}))},27420:(e,t,n)=>{n.d(t,{Hv:()=>r});var o=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e.prototype.setCorrelationId=function(){},e}(),r=new(function(){function e(){this.externalLogger=new o}return e.prototype.setCorrelationId=function(e){this.externalLogger.setCorrelationId(e)},e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)},e.prototype.debugAssertTag=function(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)},e.prototype.shipAssertTag=function(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)},e}())},2934:(e,t,n)=>{n.d(t,{d:()=>o});class o{constructor(e){this._factory=e}get value(){return void 0===this._value&&(this._value=this._factory()),this._value}}},61534:(e,t,n)=>{n.d(t,{pv:()=>T,rn:()=>P,Dt:()=>A,Os:()=>v});var o,r=n(70972),i=n(67001),a=n(26115),s=n(21326),l=n(11397),c=n(98483);!function(e){e.SessionConnect="SessionConnect",e.SessionDisconnect="SessionDisconnect",e.SessionReconnect="SessionReconnect",e.SessionClose="SessionClose",e.SessionReConnectFailed="SessionReConnectFailed"}(o||(o={}));const u=3e3;var d,p=n(43433),h=n(7589);!function(e){e[e.ReadyToConnect=0]="ReadyToConnect",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected"}(d||(d={}));let g=0;const f=10;let m,y=d.ReadyToConnect;const v=(0,c.A)(),C=(0,c.A)();let b,E=!1;const A=()=>b??"",S=new l.EventEmitter;function I(e,t,n){const i=r.b.getAugLoopRuntimeManager();i.setRequestAuthTokenCallback({requestAuthTokenCallback:t=>e.getAuthToken?e.getAuthToken():Promise.resolve(e.authToken)}),0==E&&(E=!0);const l={serviceUrl:e.serviceUrl,appName:e.appName,appVersion:e.appVersion,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseFork:e.releaseFork,sessionId:t,initSession:!0,flights:e.flights,sessionCreationOptions:{docSessionId:C,onSessionConnect:(e,t,n,r)=>{S.emit(o.SessionConnect),b=t.substring(t.lastIndexOf("/")+1),(0,p.c)(`In AL Session onSessionConnect, isSeedingRequired: ${e}, docSessionId: ${C}, sessionKey: ${A()}`),e&&async function(e){const t=await e.getSession(),n=new a.Xr({parentPath:["session"],items:[{id:"doc",body:new s.yo({isReadonly:!1})}]});t.submitSeedOperations([n])}(i)},onSessionDisconnect:e=>{(0,p.c)("In AL Session onSessionDisconnect"),S.emit(o.SessionDisconnect)},onSessionReconnect:()=>{(0,p.c)("In AL Session onSessionReconnect"),S.emit(o.SessionReconnect)},onSessionClose:e=>{(0,p.c)("In AL Session onSessionClose"),S.emit(o.SessionClose);try{(0,p.c)("In AL Session onSessionClose: starting new session"),i.startNewSession()}catch(e){(0,p.c)("In AL Session onSessionClose: error in starting new session"),S.emit(o.SessionReConnectFailed);const t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw new Error(`Failure in starting new AL Session onSessionClose: ${t}`)}}}};(0,p.c)(`docSessionId: ${C}`),i.initialize(l)}function P(e){y==d.ReadyToConnect&&(y=d.Connecting,m=e,x().on(o.SessionConnect,(()=>{g=0,y=d.Connected})),x().on(o.SessionDisconnect,(()=>{y=d.ReadyToConnect})),x().on(o.SessionClose,(()=>{y=d.ReadyToConnect})),x().on(o.SessionReconnect,(()=>{g=0,y=d.Connected})),x().on(o.SessionReConnectFailed,(()=>{y=d.ReadyToConnect})),I(e,v,g++))}async function T(){if(y==d.ReadyToConnect&&null!=m.serviceUrl){y=d.Connecting,I(m,v,g++);try{await async function(){const e=await r.b.getAugLoopRuntimeManager().getSession();return(0,p.c)(`Augloop session: isClosed: ${e.isClosed}, hasConnected: ${e.hasConnected}, isConnected: ${e.isConnected} `),e.hasConnected&&!e.isConnected&&(e.isClosed?(0,p.c)("Augloop connection is closed"):((0,p.c)("Sending KeepAlive..."),e.submitCustomMessage(new i.PR).then(((...e)=>{(0,p.c)("KeepAlive succeeded")})).catch((e=>{const t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw(0,p.c)(`KeepAlive failed: ${t}`),new Error(`Failure in KeepAlive: ${t}`)})))),(0,h.ue)((()=>y==d.Connected?Promise.resolve():Promise.reject(`Augloop connection not established. hasConnected: ${e.hasConnected}, isConnected: ${e.isConnected}, isClosed: ${e.isClosed}`)),f,u).catch((e=>{throw y=d.ReadyToConnect,e}))}()}catch(e){const t=e instanceof Error&&null!=e.message?e.message:"Unknown error";throw(0,p.c)(`${t}`),e}}const e=r.b.getAugLoopRuntimeManager();if(null==e)throw new Error("Augloop runtime manager is not initialized");return e}function x(){return S}},57830:(e,t,n)=>{n.d(t,{r:()=>o});class o{static generateId(){return o.operationId++,"AugLoopCopilotChat"+o.operationId.toString()}}o.operationId=0},43433:(e,t,n)=>{n.d(t,{c:()=>r});var o=n(58651);const r=(e,t)=>{null==t?o.log("Augloop Log:",e):o.log("Augloop Log:",e,t)}},7589:(e,t,n)=>{n.d(t,{X9:()=>a,ue:()=>i});var o=n(43433);function r(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}async function i(e,t,n){let o;for(let i=0;i<t;i++)try{return i>0&&await r(n),await e(i)}catch(e){o=e}throw o}const a=async e=>{const t=await fetch(e);if(!t||t&&!t.ok){const t=`toDataUrl: Could not fetch image at ${e}`;throw(0,o.c)(t),new Error(t)}try{const n=await t.blob();return new Promise(((t,o)=>{const r=new FileReader;r.onloadend=()=>{null!==r.result?t(r.result.toString()):o(new Error("toDataUrl: Could not get base64 encoding of image at "+e))},r.onerror=()=>o(),r.readAsDataURL(n)}))}catch(t){const n=`toDataUrl: Could not get base64 encoding of image at ${e}`;throw(0,o.c)(n),new Error(n)}}},49319:(e,t,n)=>{n.r(t),n.d(t,{createApolloLinks:()=>H});var o=n(97918),r=n(89685),i=n(40867),a=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))};const s=({shouldTrace:e=!0})=>(0,i.o)((()=>a(void 0,void 0,void 0,(function*(){return{requestId:(0,r.DA)(),shouldTrace:e}})))),l=e=>e.getContext();const c=new(n(76380).z)({attempts:{max:2,retryIf:(e,t)=>Boolean(l(t).shouldRetry)}});var u=n(5624);function d(e){return"object"==typeof e&&!!e&&(0,u.mQ)(e,"family")&&(0,u.mQ)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}var p,h="auth-token";!function(e){e[e.AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE=0]="AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE",e[e.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS=1]="AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS",e[e.EXPECTED_ERROR=2]="EXPECTED_ERROR",e[e.EXPECTED_TOKEN_INVALIDATED_ERROR=3]="EXPECTED_TOKEN_INVALIDATED_ERROR",e[e.GET_AUTH_TOKEN_TIMEOUT=4]="GET_AUTH_TOKEN_TIMEOUT",e[e.INVALID_AUTH_TOKEN=5]="INVALID_AUTH_TOKEN",e[e.GENERIC_TOKEN_ERROR=6]="GENERIC_TOKEN_ERROR",e[e.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED=7]="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED",e[e.BAD_REFRESH_TOKEN=8]="BAD_REFRESH_TOKEN",e[e.CONDITIONAL_ACCESS_BLOCKED=9]="CONDITIONAL_ACCESS_BLOCKED",e[e.PRECONDITION_VIOLATED=10]="PRECONDITION_VIOLATED",e[e.POLICY_REQUIRED_ERROR=11]="POLICY_REQUIRED_ERROR",e[e.DEVICE_CONNECTION_IS_NOT_AVAILABLE=12]="DEVICE_CONNECTION_IS_NOT_AVAILABLE",e[e.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN=13]="BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN",e[e.TIMEOUT_FETCHING_TOKEN=14]="TIMEOUT_FETCHING_TOKEN",e[e.NO_RESPONSE_FROM_SERVICE=15]="NO_RESPONSE_FROM_SERVICE",e[e.TIMEOUT_ERROR=16]="TIMEOUT_ERROR",e[e.NO_NETWORK_AVAILABLE=17]="NO_NETWORK_AVAILABLE",e[e.AD_ERROR_CACHE_BAD_FORMAT=18]="AD_ERROR_CACHE_BAD_FORMAT",e[e.AD_ERROR_CACHE_MULTIPLE_USERS=19]="AD_ERROR_CACHE_MULTIPLE_USERS",e[e.AD_ERROR_CACHE_NO_REFRESH_TOKEN=20]="AD_ERROR_CACHE_NO_REFRESH_TOKEN",e[e.AD_ERROR_CACHE_VERSION_MISMATCH=21]="AD_ERROR_CACHE_VERSION_MISMATCH",e[e.AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT=22]="AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT",e[e.AD_ERROR_SERVER_AUTHORIZATION_CODE=23]="AD_ERROR_SERVER_AUTHORIZATION_CODE",e[e.AD_ERROR_SERVER_INVALID_ID_TOKEN=24]="AD_ERROR_SERVER_INVALID_ID_TOKEN",e[e.AD_ERROR_SERVER_INVALID_RESPONSE=25]="AD_ERROR_SERVER_INVALID_RESPONSE",e[e.AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER=26]="AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER",e[e.AD_ERROR_SERVER_NON_HTTPS_REDIRECT=27]="AD_ERROR_SERVER_NON_HTTPS_REDIRECT",e[e.AD_ERROR_SERVER_OAUTH=28]="AD_ERROR_SERVER_OAUTH",e[e.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED=29]="AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED",e[e.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED=30]="AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED",e[e.AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED=31]="AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED",e[e.AD_ERROR_SERVER_UNSUPPORTED_REQUEST=32]="AD_ERROR_SERVER_UNSUPPORTED_REQUEST",e[e.AD_ERROR_SERVER_USER_INPUT_NEEDED=33]="AD_ERROR_SERVER_USER_INPUT_NEEDED",e[e.AD_ERROR_SERVER_WPJ_REQUIRED=34]="AD_ERROR_SERVER_WPJ_REQUIRED",e[e.AD_ERROR_SERVER_WRONG_USER=35]="AD_ERROR_SERVER_WRONG_USER",e[e.AD_ERROR_TOKENBROKER_BAD_RESUME_STATE=36]="AD_ERROR_TOKENBROKER_BAD_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_DECRYPTION_FAILED=37]="AD_ERROR_TOKENBROKER_DECRYPTION_FAILED",e[e.AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY=38]="AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY",e[e.AD_ERROR_TOKENBROKER_HASH_MISSING=39]="AD_ERROR_TOKENBROKER_HASH_MISSING",e[e.AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI=40]="AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI",e[e.AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE=41]="AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_NO_RESUME_STATE=42]="AD_ERROR_TOKENBROKER_NO_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE=43]="AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE",e[e.AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION=44]="AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION",e[e.AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH=45]="AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH",e[e.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED=46]="AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED",e[e.AD_ERROR_TOKENBROKER_UNKNOWN=47]="AD_ERROR_TOKENBROKER_UNKNOWN",e[e.AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER=48]="AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER",e[e.AD_ERROR_UI_NOT_ON_MAIN_THREAD=49]="AD_ERROR_UI_NOT_ON_MAIN_THREAD",e[e.AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION=50]="AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION",e[e.AD_ERROR_UI_USER_CANCEL=51]="AD_ERROR_UI_USER_CANCEL",e[e.AD_ERROR_UNEXPECTED=52]="AD_ERROR_UNEXPECTED",e[e.AD_ERROR_DEVELOPER_INVALID_ARGUMENT=53]="AD_ERROR_DEVELOPER_INVALID_ARGUMENT",e[e.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION=54]="AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION",e[e.kCFURLErrorTimedOut=55]="kCFURLErrorTimedOut",e[e.kCFURLErrorCannotFindHost=56]="kCFURLErrorCannotFindHost",e[e.kCFURLErrorCannotConnectToHost=57]="kCFURLErrorCannotConnectToHost",e[e.kCFURLErrorNetworkConnectionLost=58]="kCFURLErrorNetworkConnectionLost",e[e.kCFURLErrorNotConnectedToInternet=59]="kCFURLErrorNotConnectedToInternet",e[e.kCFURLErrorInternationalRoamingOff=60]="kCFURLErrorInternationalRoamingOff",e[e.kCFURLErrorCallIsActive=61]="kCFURLErrorCallIsActive",e[e.kCFURLErrorDataNotAllowed=62]="kCFURLErrorDataNotAllowed",e[e.kCFURLErrorSecureConnectionFailed=63]="kCFURLErrorSecureConnectionFailed",e[e.UNKNOWN_ERROR=64]="UNKNOWN_ERROR",e[e.UNKNOWN_200_ERROR=65]="UNKNOWN_200_ERROR",e[e.UNKNOWN_203_ERROR=66]="UNKNOWN_203_ERROR",e[e.UNKNOWN_STRING_ERROR=67]="UNKNOWN_STRING_ERROR",e[e.UNKNOWN_ERROR_CAUGHT_IN_PROMISE=68]="UNKNOWN_ERROR_CAUGHT_IN_PROMISE",e[e.BROKER_AUTHENTICATOR_NOT_RESPONDING=69]="BROKER_AUTHENTICATOR_NOT_RESPONDING",e[e.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION=70]="NO_NETWORK_CONNECTION_POWER_OPTIMIZATION",e[e.BROKER_AUTHENTICATOR_IO_EXCEPTION=71]="BROKER_AUTHENTICATOR_IO_EXCEPTION",e[e.IO_EXCEPTION=72]="IO_EXCEPTION",e[e.NO_ACCOUNTS_FOUND=73]="NO_ACCOUNTS_FOUND",e[e.DISALLOWED_MSA_ACCOUNT=74]="DISALLOWED_MSA_ACCOUNT",e[e.NO_M365_ACCOUNT=75]="NO_M365_ACCOUNT",e[e.NO_CREDENTIALS_FOUND=76]="NO_CREDENTIALS_FOUND",e[e.WIN32_UNKNOWN_ERROR=77]="WIN32_UNKNOWN_ERROR",e[e.WIN32_PERSONAJS_ERROR=78]="WIN32_PERSONAJS_ERROR",e[e.AUTH_RATE_LIMIT_EXCEEDED=79]="AUTH_RATE_LIMIT_EXCEEDED",e[e.INTERACTION_REQUIRED=80]="INTERACTION_REQUIRED",e[e.SERVER_DECLINED_SCOPES=81]="SERVER_DECLINED_SCOPES",e[e.USER_CANCELED=82]="USER_CANCELED",e[e.WORKPLACE_JOIN_REQUIRED=83]="WORKPLACE_JOIN_REQUIRED",e[e.RNX_NON_ACTIONABLE_ERROR=84]="RNX_NON_ACTIONABLE_ERROR"}(p||(p={}));var g,f,m,y;g=p;function v(e){return e.family===h&&e.code in p?e.code:void 0}var C=((f={})[p.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED]=1,f[p.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED]=1,f[p.AD_ERROR_SERVER_USER_INPUT_NEEDED]=1,f[p.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED]=1,f[p.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS]=1,f[p.CONDITIONAL_ACCESS_BLOCKED]=1,f[p.BAD_REFRESH_TOKEN]=1,f[p.POLICY_REQUIRED_ERROR]=1,f[p.PRECONDITION_VIOLATED]=1,f),b=((m={})[p.AD_ERROR_SERVER_INVALID_RESPONSE]=1,m[p.AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE]=1,m[p.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN]=1,m[p.BROKER_AUTHENTICATOR_IO_EXCEPTION]=1,m[p.BROKER_AUTHENTICATOR_NOT_RESPONDING]=1,m[p.DEVICE_CONNECTION_IS_NOT_AVAILABLE]=1,m[p.GENERIC_TOKEN_ERROR]=1,m[p.INTERACTION_REQUIRED]=1,m[p.IO_EXCEPTION]=1,m[p.kCFURLErrorCallIsActive]=1,m[p.kCFURLErrorCannotConnectToHost]=1,m[p.kCFURLErrorCannotFindHost]=1,m[p.kCFURLErrorDataNotAllowed]=1,m[p.kCFURLErrorInternationalRoamingOff]=1,m[p.kCFURLErrorNetworkConnectionLost]=1,m[p.kCFURLErrorNotConnectedToInternet]=1,m[p.kCFURLErrorSecureConnectionFailed]=1,m[p.kCFURLErrorTimedOut]=1,m[p.NO_NETWORK_AVAILABLE]=1,m[p.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION]=1,m[p.NO_RESPONSE_FROM_SERVICE]=1,m[p.SERVER_DECLINED_SCOPES]=1,m[p.TIMEOUT_ERROR]=1,m[p.TIMEOUT_FETCHING_TOKEN]=1,m[p.USER_CANCELED]=1,m[p.WORKPLACE_JOIN_REQUIRED]=1,m),E=((y={})[p.AD_ERROR_CACHE_NO_REFRESH_TOKEN]=1,y[p.AD_ERROR_SERVER_AUTHORIZATION_CODE]=1,y[p.AD_ERROR_SERVER_OAUTH]=1,y[p.AD_ERROR_SERVER_WPJ_REQUIRED]=1,y[p.AD_ERROR_SERVER_WRONG_USER]=1,y[p.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED]=1,y[p.AD_ERROR_TOKENBROKER_UNKNOWN]=1,y[p.AD_ERROR_UI_USER_CANCEL]=1,y[p.AD_ERROR_UNEXPECTED]=1,y[p.EXPECTED_ERROR]=1,y[p.EXPECTED_TOKEN_INVALIDATED_ERROR]=1,y[p.GET_AUTH_TOKEN_TIMEOUT]=1,y[p.AD_ERROR_CACHE_VERSION_MISMATCH]=1,y[p.AD_ERROR_CACHE_BAD_FORMAT]=1,y[p.AD_ERROR_DEVELOPER_INVALID_ARGUMENT]=1,y[p.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION]=1,y[p.RNX_NON_ACTIONABLE_ERROR]=1,y);function A(e){return!!(d(e)&&v(e)&&(function(e){return!!(d(e)&&v(e)&&C[e.code])}(e)||b[e.code]||E[e.code]))}const S="graphql";var I;function P(e){return{family:S,code:e}}!function(e){e[e.REQUEST_FAILED=0]="REQUEST_FAILED",e[e.CLIENT_ABORTED=1]="CLIENT_ABORTED",e[e.BACKEND_302_ERROR=2]="BACKEND_302_ERROR",e[e.BACKEND_400_ERROR=3]="BACKEND_400_ERROR",e[e.BACKEND_401_ERROR=4]="BACKEND_401_ERROR",e[e.BACKEND_403_ERROR=5]="BACKEND_403_ERROR",e[e.BACKEND_404_ERROR=6]="BACKEND_404_ERROR",e[e.BACKEND_408_ERROR=7]="BACKEND_408_ERROR",e[e.BACKEND_500_ERROR=8]="BACKEND_500_ERROR",e[e.BACKEND_503_ERROR=9]="BACKEND_503_ERROR",e[e.BACKEND_504_ERROR=10]="BACKEND_504_ERROR",e[e.BACKEND_MULTIPLE_GQL_ERRORS=11]="BACKEND_MULTIPLE_GQL_ERRORS",e[e.BACKEND_UNKNOWN_ERROR=12]="BACKEND_UNKNOWN_ERROR",e[e.BACKEND_UNRECOGNIZED_GUID_FORMAT=13]="BACKEND_UNRECOGNIZED_GUID_FORMAT",e[e.BACKEND_INVALID_NULL_FIELD=14]="BACKEND_INVALID_NULL_FIELD",e[e.BACKEND_INVALID_FIELD=15]="BACKEND_INVALID_FIELD",e[e.BACKEND_EXECUTION_ERROR=16]="BACKEND_EXECUTION_ERROR",e[e.BACKEND_UNKNOWN_SECTION=17]="BACKEND_UNKNOWN_SECTION",e[e.UNSUPPORTED_ACCOUNT=18]="UNSUPPORTED_ACCOUNT",e[e.RATE_LIMIT_EXCEEDED=19]="RATE_LIMIT_EXCEEDED",e[e.DELTA_REQUEST_UNSUCCESSFUL_WITHOUT_ITEMS=20]="DELTA_REQUEST_UNSUCCESSFUL_WITHOUT_ITEMS",e[e.DELTA_REQUEST_UNSUCCESSFUL_WITH_ITEMS=21]="DELTA_REQUEST_UNSUCCESSFUL_WITH_ITEMS",e[e.SERVICE_API_CALL_FAILED=22]="SERVICE_API_CALL_FAILED",e[e.TIMEOUT_EXCEEDED=23]="TIMEOUT_EXCEEDED",e[e.BACKEND_INVALID_OPERATION=24]="BACKEND_INVALID_OPERATION",e[e.USER_LOGGED_OUT=25]="USER_LOGGED_OUT",e[e.DATA_INCOMPLETE=26]="DATA_INCOMPLETE",e[e.LOKI_CONFIGURATION_FAILED=27]="LOKI_CONFIGURATION_FAILED",e[e.LOKI_CONFIGURATION_AUTH_FAILED=28]="LOKI_CONFIGURATION_AUTH_FAILED",e[e.RESPONSE_STREAMING_EXCEPTION=29]="RESPONSE_STREAMING_EXCEPTION",e[e.RESPONSE_STREAMING_NOT_SUCCESSFUL=30]="RESPONSE_STREAMING_NOT_SUCCESSFUL"}(I||(I={}));const T="AuthLink",x=({authTokenProvider:e,correlationId:t,unsupportedAccount:n})=>o.C.from([w(e,t,n),k(e)]),w=(e,t,n)=>(0,i.o)(((o,r)=>{if(n){throw{isExpected:!0,qosTagId:T,midgardError:P(I.UNSUPPORTED_ACCOUNT)}}const i=Date.now();return e(r).then((e=>e.getAuthToken(t))).then((e=>{var t,n;return{token:e.token.getValue(),tokenAttempts:(null!==(t=r.tokenAttempts)&&void 0!==t?t:0)+1,tokenDuration:(null!==(n=r.tokenDuration)&&void 0!==n?n:0)+Date.now()-i}})).catch((e=>{const t=d(null==e?void 0:e.midgardError)?null==e?void 0:e.midgardError:void 0;throw{isExpected:t&&A(t),qosTagId:T,midgardError:null!=t?t:P(I.REQUEST_FAILED)}}))})),k=e=>new o.C(((t,n)=>n(t).map((n=>{const{response:{headers:o}}=t.getContext(),r=o.get("x-tokenttl");return r&&e(t.getContext()).then((e=>e.updateAuthTokenTtl(r))),n})))),_=new o.C(((e,t)=>{const n=Date.now();let o=n;return t(e).map((t=>{var r,i,a;const s=l(e),c="hasNext"in t,u=c&&"incremental"in t,d=Date.now()-o;return c&&(o=Date.now()),((e,t)=>{e.setContext(t)})(e,{httpAttempts:(null!==(r=s.httpAttempts)&&void 0!==r?r:0)+(u?0:1),httpDuration:(null!==(i=s.httpDuration)&&void 0!==i?i:0)+(u?0:d),httpDurationTrailing:c?(null!==(a=s.httpDurationTrailing)&&void 0!==a?a:0)+d:s.httpDurationTrailing,httpRequestTime:n}),t}))}));var D=n(5678),F=n(10327),L=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))};const O=e=>{const t="strip"===e?(e,t)=>(0,F.Z)(t(e)):(e,t)=>t(e);return new D.P({uri:e=>e.getContext().serviceURL,print:t})},R=(e,t)=>{return o.C.from([(n=e,(0,i.o)(((e,t)=>L(void 0,void 0,void 0,(function*(){return{serviceURL:yield n(e.operationName,t)}}))))),O(t)]);var n};let M;var B=n(57355),N=n.n(B);const V="api/v2/graphql/",H=e=>{const t=new(N())(e.useExtendedExperimentalTimeout?24e4:3e4,0),n=new o.C(((e,t)=>{const n=e.getContext();return n.metadata?.timeout&&e.setContext({...n,timeout:n.metadata?.timeout}),t(e)})),r={getAuthToken:async()=>{const t=await(e.getAuthToken?.());if(!t?.accessToken)throw new Error("Missing loki token");return{token:{getValue:()=>t.accessToken,getExpirationTimeEpoch:()=>t.expirationTime,isApproachingExpiration:()=>!1,isValid:()=>!0},request:{fromCache:!1,duration:0}}},hasAuthToken:()=>!0,invalidateAuthToken:()=>{},forceRefreshAuthToken:async()=>{},updateAuthTokenTtl:()=>{}},i=o.C.from([s({shouldTrace:!1}),c,x({authTokenProvider:async()=>r,correlationId:e.clientCorrelationId,unsupportedAccount:!1}),(a={clientCorrelationId:e.clientCorrelationId,accountUpn:e.accountUpn??"",buildVersion:"",clientFeature:"BizChatGraphqlNetworkCore",locale:e.locale??"en-US",clientType:"CopilotAppChat",hostAppApp:"CopilotAppChat",hostApp:"Office",hostPlatform:e.hostAppPlatform??"Web",hostAppRing:e.hostAppRing,hostAppVersion:""},u=(e,t)=>(({clientType:e,clientCorrelationId:t,rootCorrelationId:n,clientFeature:o,buildVersion:r,hostApp:i,hostAppApp:a,hostPlatform:s,hostAppRing:c,hostAppVersion:u,clientScenario:d,returnEmptyAuthHeaderForLocalTesting:p,locale:h},g)=>{var f,m,y,v,C,b,E,A,S,I;const P=l(g),T=!0===p?"":P.token,x=null!==(y=null!==(f=P.clientFeature)&&void 0!==f?f:null===(m=P.metadata)||void 0===m?void 0:m.clientFeature)&&void 0!==y?y:o,w=null!==(E=null!==(b=null!==(C=null===(v=P.metadata)||void 0===v?void 0:v.clientScenario)&&void 0!==C?C:P.clientScenario)&&void 0!==b?b:d)&&void 0!==E?E:g.operationName,k=null===(A=P.metadata)||void 0===A?void 0:A.rootCorrelationId,_={Authorization:`Bearer ${T}`,"X-ClientType":e,"X-RootCorrelationId":null!==(S=null!=k?k:n)&&void 0!==S?S:P.requestId,"X-CorrelationId":P.requestId,"X-ClientFeature":x,"X-LPCVersion":r,"X-ClientScenario":w,ScenarioTag:`${e}_${g.operationName}`};return t&&(_["X-ClientCorrelationId"]=t),i&&(_["X-HostApp"]=i),s&&(_["X-HostAppPlatform"]=s),a&&(_["X-HostAppApp"]=a),c&&(_["X-HostAppRing"]=c),u&&(_["X-HostAppVersion"]=u),h&&(_["X-Client-Language"]=h),Object.assign(Object.assign({},_),null!==(I=null==P?void 0:P.headers)&&void 0!==I?I:{})})({...e,returnEmptyAuthHeaderForLocalTesting:!1},t),new o.C(((e,t)=>{const n=u(a,e);return e.setContext({headers:n}),t(e)}))),_,n,t,R((async t=>{const n=(e=>{switch(e){case"DOGFOOD":return"https://df.loki.delve.office.com";case"MSIT":case"Microsoft":return"https://msit.loki.delve.office.com";default:return M??"https://loki.delve.office.com"}})(e.hostAppRing),o=`${n}${n?.endsWith("/")?"":"/"}${V}`;return Promise.resolve(o+`?operationName=${t}`)}),"none")]);var a,u;return i}},43265:(e,t,n)=>{function o(e){switch(e){case"af":return n.e("officeaicopilotchatstrings_af").then(n.t.bind(n,43063,19));case"am":return n.e("officeaicopilotchatstrings_am").then(n.t.bind(n,75870,19));case"ar":return n.e("officeaicopilotchatstrings_ar").then(n.t.bind(n,42555,19));case"as-in":return n.e("officeaicopilotchatstrings_as-in").then(n.t.bind(n,97268,19));case"az-latn-az":return n.e("officeaicopilotchatstrings_az-latn-az").then(n.t.bind(n,49877,19));case"be-by":return n.e("officeaicopilotchatstrings_be-by").then(n.t.bind(n,43709,19));case"bg":return n.e("officeaicopilotchatstrings_bg").then(n.t.bind(n,75251,19));case"bn-in":return n.e("officeaicopilotchatstrings_bn-in").then(n.t.bind(n,35716,19));case"bn-bd":return n.e("officeaicopilotchatstrings_bn-bd").then(n.t.bind(n,20901,19));case"bs-latn-ba":return n.e("officeaicopilotchatstrings_bs-latn-ba").then(n.t.bind(n,95695,19));case"ca":return n.e("officeaicopilotchatstrings_ca").then(n.t.bind(n,23776,19));case"ca-es-valencia":return n.e("officeaicopilotchatstrings_ca-es-valencia").then(n.t.bind(n,83953,19));case"cs":return n.e("officeaicopilotchatstrings_cs").then(n.t.bind(n,54754,19));case"cy":return n.e("officeaicopilotchatstrings_cy").then(n.t.bind(n,70152,19));case"da":return n.e("officeaicopilotchatstrings_da").then(n.t.bind(n,57423,19));case"de":return n.e("officeaicopilotchatstrings_de").then(n.t.bind(n,55043,19));case"el":return n.e("officeaicopilotchatstrings_el").then(n.t.bind(n,3397,19));case"en-gb":return n.e("officeaicopilotchatstrings_en-gb").then(n.t.bind(n,33079,19));case"en-us":return n.e("officeaicopilotchatstrings_en-us").then(n.t.bind(n,63534,19));case"es":return n.e("officeaicopilotchatstrings_es").then(n.t.bind(n,55420,19));case"es-mx":return n.e("officeaicopilotchatstrings_es-mx").then(n.t.bind(n,94498,19));case"et":return n.e("officeaicopilotchatstrings_et").then(n.t.bind(n,59325,19));case"eu":return n.e("officeaicopilotchatstrings_eu").then(n.t.bind(n,75346,19));case"fa":return n.e("officeaicopilotchatstrings_fa").then(n.t.bind(n,24989,19));case"fi":return n.e("officeaicopilotchatstrings_fi").then(n.t.bind(n,89141,19));case"fil":return n.e("officeaicopilotchatstrings_fil").then(n.t.bind(n,43743,19));case"fr":return n.e("officeaicopilotchatstrings_fr").then(n.t.bind(n,17808,19));case"fr-ca":return n.e("officeaicopilotchatstrings_fr-ca").then(n.t.bind(n,2895,19));case"ga-ie":return n.e("officeaicopilotchatstrings_ga-ie").then(n.t.bind(n,18077,19));case"gd-gb":return n.e("officeaicopilotchatstrings_gd-gb").then(n.t.bind(n,2391,19));case"gl":return n.e("officeaicopilotchatstrings_gl").then(n.t.bind(n,20115,19));case"gu":return n.e("officeaicopilotchatstrings_gu").then(n.t.bind(n,96184,19));case"ha-latn-ng":return n.e("officeaicopilotchatstrings_ha-latn-ng").then(n.t.bind(n,10677,19));case"he":return n.e("officeaicopilotchatstrings_he").then(n.t.bind(n,6223,19));case"hi":return n.e("officeaicopilotchatstrings_hi").then(n.t.bind(n,80667,19));case"hr":return n.e("officeaicopilotchatstrings_hr").then(n.t.bind(n,15618,19));case"hu":return n.e("officeaicopilotchatstrings_hu").then(n.t.bind(n,37663,19));case"hy":return n.e("officeaicopilotchatstrings_hy").then(n.t.bind(n,37771,19));case"id":return n.e("officeaicopilotchatstrings_id").then(n.t.bind(n,50585,19));case"is":return n.e("officeaicopilotchatstrings_is").then(n.t.bind(n,96224,19));case"it":return n.e("officeaicopilotchatstrings_it").then(n.t.bind(n,12329,19));case"ja":return n.e("officeaicopilotchatstrings_ja").then(n.t.bind(n,96033,19));case"ka":return n.e("officeaicopilotchatstrings_ka").then(n.t.bind(n,3816,19));case"kk":return n.e("officeaicopilotchatstrings_kk").then(n.t.bind(n,16706,19));case"km-kh":return n.e("officeaicopilotchatstrings_km-kh").then(n.t.bind(n,18840,19));case"kn":return n.e("officeaicopilotchatstrings_kn").then(n.t.bind(n,42553,19));case"ko":return n.e("officeaicopilotchatstrings_ko").then(n.t.bind(n,23966,19));case"kok":return n.e("officeaicopilotchatstrings_kok").then(n.t.bind(n,30763,19));case"ky":return n.e("officeaicopilotchatstrings_ky").then(n.t.bind(n,4416,19));case"lb-lu":return n.e("officeaicopilotchatstrings_lb-lu").then(n.t.bind(n,28086,19));case"lo-la":return n.e("officeaicopilotchatstrings_lo-la").then(n.t.bind(n,36539,19));case"lt":return n.e("officeaicopilotchatstrings_lt").then(n.t.bind(n,14200,19));case"lv":return n.e("officeaicopilotchatstrings_lv").then(n.t.bind(n,7498,19));case"mi-nz":return n.e("officeaicopilotchatstrings_mi-nz").then(n.t.bind(n,40749,19));case"mk":return n.e("officeaicopilotchatstrings_mk").then(n.t.bind(n,59196,19));case"ml":return n.e("officeaicopilotchatstrings_ml").then(n.t.bind(n,63101,19));case"mn-mn":return n.e("officeaicopilotchatstrings_mn-mn").then(n.t.bind(n,70357,19));case"mr":return n.e("officeaicopilotchatstrings_mr").then(n.t.bind(n,67287,19));case"ms":return n.e("officeaicopilotchatstrings_ms").then(n.t.bind(n,98564,19));case"mt-mt":return n.e("officeaicopilotchatstrings_mt-mt").then(n.t.bind(n,64233,19));case"ne-np":return n.e("officeaicopilotchatstrings_ne-np").then(n.t.bind(n,14922,19));case"nl":return n.e("officeaicopilotchatstrings_nl").then(n.t.bind(n,48862,19));case"nn-no":return n.e("officeaicopilotchatstrings_nn-no").then(n.t.bind(n,35712,19));case"no":return n.e("officeaicopilotchatstrings_no").then(n.t.bind(n,66303,19));case"or":return n.e("officeaicopilotchatstrings_or").then(n.t.bind(n,26025,19));case"pa-in":return n.e("officeaicopilotchatstrings_pa-in").then(n.t.bind(n,17809,19));case"pl":return n.e("officeaicopilotchatstrings_pl").then(n.t.bind(n,64844,19));case"prs":return n.e("officeaicopilotchatstrings_prs").then(n.t.bind(n,39479,19));case"pt":return n.e("officeaicopilotchatstrings_pt").then(n.t.bind(n,56212,19));case"pt-pt":return n.e("officeaicopilotchatstrings_pt-pt").then(n.t.bind(n,20631,19));case"quz-pe":return n.e("officeaicopilotchatstrings_quz-pe").then(n.t.bind(n,64664,19));case"ro":return n.e("officeaicopilotchatstrings_ro").then(n.t.bind(n,54971,19));case"ru":return n.e("officeaicopilotchatstrings_ru").then(n.t.bind(n,77549,19));case"sd-arab-pk":return n.e("officeaicopilotchatstrings_sd-arab-pk").then(n.t.bind(n,16268,19));case"si-lk":return n.e("officeaicopilotchatstrings_si-lk").then(n.t.bind(n,81146,19));case"sk":return n.e("officeaicopilotchatstrings_sk").then(n.t.bind(n,20570,19));case"sl":return n.e("officeaicopilotchatstrings_sl").then(n.t.bind(n,66839,19));case"sq":return n.e("officeaicopilotchatstrings_sq").then(n.t.bind(n,49472,19));case"sr":return n.e("officeaicopilotchatstrings_sr").then(n.t.bind(n,11229,19));case"sr-cyrl":return n.e("officeaicopilotchatstrings_sr-cyrl").then(n.t.bind(n,41454,19));case"sr-cyrl-ba":return n.e("officeaicopilotchatstrings_sr-cyrl-ba").then(n.t.bind(n,9108,19));case"sv":return n.e("officeaicopilotchatstrings_sv").then(n.t.bind(n,77353,19));case"sw":return n.e("officeaicopilotchatstrings_sw").then(n.t.bind(n,17518,19));case"ta":return n.e("officeaicopilotchatstrings_ta").then(n.t.bind(n,68863,19));case"te":return n.e("officeaicopilotchatstrings_te").then(n.t.bind(n,97427,19));case"th":return n.e("officeaicopilotchatstrings_th").then(n.t.bind(n,43780,19));case"tk-tm":return n.e("officeaicopilotchatstrings_tk-tm").then(n.t.bind(n,3979,19));case"tr":return n.e("officeaicopilotchatstrings_tr").then(n.t.bind(n,79406,19));case"tt":return n.e("officeaicopilotchatstrings_tt").then(n.t.bind(n,11360,19));case"ug-cn":return n.e("officeaicopilotchatstrings_ug-cn").then(n.t.bind(n,91642,19));case"uk":return n.e("officeaicopilotchatstrings_uk").then(n.t.bind(n,12052,19));case"ur":return n.e("officeaicopilotchatstrings_ur").then(n.t.bind(n,34527,19));case"uz":return n.e("officeaicopilotchatstrings_uz").then(n.t.bind(n,94391,19));case"vi":return n.e("officeaicopilotchatstrings_vi").then(n.t.bind(n,60581,19));case"zh-hans":return n.e("officeaicopilotchatstrings_zh-hans").then(n.t.bind(n,23881,19));case"zh-hant":return n.e("officeaicopilotchatstrings_zh-hant").then(n.t.bind(n,3328,19));case"zu-za":return n.e("officeaicopilotchatstrings_zu-za").then(n.t.bind(n,67781,19));default:throw new Error(`Unsupported locale ${e}`)}}n.d(t,{N:()=>o})},59777:(e,t,n)=>{var o,r,i,a,s,l,c,u,d;n.d(t,{DF:()=>i,Gb:()=>s,PV:()=>c,SG:()=>a,Yk:()=>u,ck:()=>o,g$:()=>r,y2:()=>d}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA"}(o||(o={})),function(e){e[e.ACTION_AI=0]="ACTION_AI",e[e.COPILOT_ODSL=1]="COPILOT_ODSL"}(r||(r={})),function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(i||(i={})),function(e){e[e.QUERY_ENTERED=0]="QUERY_ENTERED",e[e.QUERY_SUBMITTED=1]="QUERY_SUBMITTED",e[e.QUERY_SUBMITTED_FAILED=2]="QUERY_SUBMITTED_FAILED",e[e.RESPONSE_RECEIVED=3]="RESPONSE_RECEIVED",e[e.RESPONSE_SENT=4]="RESPONSE_SENT",e[e.EXECUTION_COMPLETE=5]="EXECUTION_COMPLETE",e[e.IDLE=6]="IDLE"}(a||(a={})),function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(s||(s={})),function(e){e.FAILED="FAILED",e.SUCCESS="SUCCESS",e.PARTIAL_SUCCESS="PARTIAL"}(l||(l={})),function(e){e[e.AnnotationActivated=0]="AnnotationActivated",e[e.AugloopResponseTimeout=1]="AugloopResponseTimeout",e[e.StopGeneratingButtonClicked=2]="StopGeneratingButtonClicked",e[e.CopilotChatLoaded=3]="CopilotChatLoaded",e[e.CitationLinkClicked=4]="CitationLinkClicked",e[e.BasicChatSuggestionPills=5]="BasicChatSuggestionPills",e[e.BasicChatStatus=6]="BasicChatStatus",e[e.ChatTopicChanged=7]="ChatTopicChanged",e[e.ChatHistoryHydrationFailed=8]="ChatHistoryHydrationFailed",e[e.QuerySubmitted=9]="QuerySubmitted",e[e.UpdateChatClpFromChatHistory=10]="UpdateChatClpFromChatHistory",e[e.PluginsStateUpdated=11]="PluginsStateUpdated",e[e.ResetContextId=12]="ResetContextId",e[e.PythonExitAnalysisButtonClicked=13]="PythonExitAnalysisButtonClicked",e[e.SharedHeaderRendered=14]="SharedHeaderRendered",e[e.QueryEndOnGptSwitch=15]="QueryEndOnGptSwitch",e[e.NewChatButtonClicked=16]="NewChatButtonClicked",e[e.DifferentChatOpened=17]="DifferentChatOpened",e[e.CreateNewConversationButtonClicked=18]="CreateNewConversationButtonClicked",e[e.LowOnCredits=19]="LowOnCredits",e[e.OutOfCredits=20]="OutOfCredits",e[e.StartNewChatCalled=21]="StartNewChatCalled"}(c||(c={})),function(e){e.ALSessionInitialized="AL_Session_Initialized",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.ChatHistoryResponseReceived="Chat_History_Response_Received",e.ChatPaneInitalized="Chat_Pane_Initialized",e.ChatPaneLoaded="Chat_Pane_Loaded",e.MenuButtonItemClicked="Menu_Button_Item_Clicked",e.MenuButtonItemClickedL1="Menu_Button_Item_Clicked_L1",e.ZQMButtonItemClicked="ZQM_Button_Item_Clicked",e.InputAreaTextChangedToEmpty="Input_Area_Text_Changed_Empty",e.ZQMLoaded="ZQM_Loaded",e.SuggestionPillClicked="Suggestion_Pill_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.AugloopResponseReceived="Augloop_Response_Received",e.AugloopErrorReceived="Augloop_Error_Received",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionStarted="Query_Execution_Started",e.QueryExecutionCompleted="Query_Execution_Completed",e.CopilotSwitcherMenuStateChange="Copilot_Switcher_Menu_State_Change",e.ImagesFromChatHistoryRehydrated="Images_From_Chat_History_Rehydrated",e.VoiceCopilotConnectionStarted="Voice_Copilot_Connection_Started",e.VoiceCopilotSessionInitialMessageSent="Voice_Copilot_Session_Initial_Message_Sent",e.VoiceCopilotSessionStarted="Voice_Copilot_Session_Started",e.VoiceCopilotSessionStopped="Voice_Copilot_Session_Stopped",e.VoiceCopilotUserSpeechStarted="Voice_Copilot_User_Speech_Started",e.VoiceCopilotUserSpeechStopped="Voice_Copilot_User_Speech_Stopped",e.VoiceCopilotResponseReceived="Voice_Copilot_Response_Received",e.VoiceCopilotStateChanged="Voice_Copilot_State_Changed",e.VoiceCopilotPlaybackGlitchDetected="Voice_Copilot_Playback_Glitch_Detected",e.VoiceCopilotFirstBufferReceived="Voice_Copilot_First_Buffer_Received",e.VoiceCopilotFinishedPlayerBuffer="Voice_Copilot_Finished_Player_Buffer",e.VoiceCopilotError="Voice_Copilot_Error",e.VoiceCopilotSessionDisconnected="Voice_Copilot_Session_Disconnected"}(u||(u={})),function(e){e[e.Started=0]="Started",e[e.Finished=1]="Finished"}(d||(d={}))},52970:(e,t,n)=>{var o,r;n.d(t,{L:()=>r,o:()=>o}),function(e){e.AppService="appService",e.ChannelService="channelService",e.PluginConfigService="pluginConfigService",e.AuthService="authService",e.ExternalAuthService="externalAuthService",e.TelemetryService="telemetryService"}(o||(o={})),function(e){e.GetApp="getApp",e.GetApps="getApps",e.BotInvoke="botInvoke",e.ExecuteOperation="executeOperation",e.OnOperationResponse="onOperationResponse",e.GetToken="getToken",e.OpenUrlInEmbeddedBrowser="openUrlInEmbeddedBrowser",e.OpenUrlInExternalBrowser="openUrlInExternalBrowser",e.LogError="LogError",e.LogMetric="LogMetric",e.LogInfo="LogInfo",e.LogWarning="LogWarning",e.LogException="LogException",e.LogVerbose="LogVerbose"}(r||(r={}))},90922:(e,t,n)=>{var o,r,i,a,s;n.d(t,{CT:()=>o,DO:()=>f,EF:()=>d,G8:()=>g,H7:()=>y,IC:()=>i,JI:()=>C,Nr:()=>s,Nx:()=>b,RX:()=>u,Z_:()=>h,a5:()=>a,h3:()=>r,q0:()=>p,qN:()=>v,rf:()=>c,tw:()=>l,ym:()=>m}),function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.AugloopResponseTime="AugloopResponseTime",e.QueryExecutionTime="QueryExecutionTime",e.ImageResponseTime="ImageResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.QnAResponseTime="QnAResponseTime",e.QnAChunkInfo="QnAChunkInfo",e.SuggestedQnAResponseTime="SuggestedQnAResponseTime",e.AnnotationType="AnnotationType",e.RequestSignalType="RequestSignalType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.IsFirstSdxSessionQuery="IsFirstSdxSessionQuery",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.SubstrateAPIResponseTime="SubstrateAPIResponseTime",e.PluginsConfig3SFetchTime="PluginsConfig3SFetchTime",e.CopilotChatLoadTime="CopilotChatLoadTime",e.Cv="Cv"}(o||(o={})),function(e){e.UserQueryGuid="UserQueryGuid",e.CopilotChatSessionId="CopilotChatSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.FilterParameters="FilterParameters",e.ChatErrorKey="ChatErrorKey",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorType="ChatErrorType",e.IsFromCache="IsFromCache",e.IsStreamingResponse="IsStreamingResponse",e.Cv="Cv",e.SelectedSwitcherMenuItemId="SelectedSwitcherMenuItemId",e.IsOutputV2Shown="IsOutputV2Shown",e.AuthMessageStatus="AuthMessageStatus",e.AugloopTimer="AugloopTimer"}(r||(r={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCode="ErrorCode",e.ErrorType="ErrorType",e.ErrorCategory="ErrorCategory"}(i||(i={})),function(e){e.EnterKeyPressed="Enter_Key_Pressed",e.AuthMessageReceived="Auth_Message_Received",e.SubmitButtonClicked="Submit_Button_Clicked",e.RefreshPillsButtonClicked="Refresh_Pills_Button_Clicked",e.ZQMButtonClicked="ZQM_Button_Clicked",e.ZQMButtonV2Clicked="ZQM_Button_V2_Clicked",e.ZQMQuerySubmitted="ZQM_Query_Submitted",e.ZQMQuerySubmittedDirectly="ZQM_Query_Submitted_Directly",e.ZQMLoaded="ZQM_Loaded",e.ZQMShownSource="ZQM_Shown_Source",e.MenuItemClicked="Menu_Item_Clicked",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.QueryResubmittedToAL="Query_Resubmitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.HintCardShownOnSubmission="Hint_Card_Shown",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ALSessionConnected="AL_Session_Connected",e.ALSessionDisconnected="AL_Session_Disconnected",e.ALSessionReconnected="AL_Session_Reconnected",e.ALSessionClosed="AL_Session_Closed",e.ALAnnotationReceived="AL_Annotation_Received",e.ChatHistoryTimeout="Chat_History_Timeout",e.ChatHistorySignalSent="Chat_History_Signal_Sent",e.EntityLabelOperationSubmitted="Entity_Label_Operation_Submitted",e.ChatHistorySessionLoaded="Chat_History_Session_Loaded",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.GetCurrentChatStatus="GetCurrentChat_Status",e.GetMessagesStatus="GetMessages_Status",e.DeleteMessageStatus="DeleteMessage_Status",e.GetAllChatStatus="GetAllChat_Status",e.AddMessageStatus="AddMessage_Status",e.RetryGetMessageSignal="Retry_GetMessage_Signal",e.GetPreviousMessagesForPagination="GetPreviousMessages_For_Pagination",e.FeedbackDataUploadOperationSubmitted="FeedbackDataUpload_Operation_Submitted",e.FeedbackDataSydneyDataMissing="FeedbackData_SydneyData_Missing",e.CopyButtonClicked="Copy_Button_Clicked",e.QueryExecutionCompleted="Query_Execution_Completed",e.ChatPaneLoadMessageBarShown="ChatPaneLoad_MessageBar_Shown",e.FirstUserInputReceived="First_User_Input_Received",e.ChatInputLoaded="ChatInput_Loaded",e.FirstQuerySubmitted="First_Query_Submitted",e.CopilotLicensingAnnotationActivated="Copilot_Licensing_Annotation_Activated",e.ResetOperationListForResubmit="Reset_Operation_List_For_Resubmit",e.AddToOperationListForResubmit="Add_To_Operation_List_For_Resubmit",e.EditorBootstrapSkipped="Editor_Bootstrap_Skipped",e.SubmitWarmUpQuerySignalFailed="Submit_WarmUp_Query_Signal_Failed",e.ChatInputDisabledAndBannerShownForInActiveChatSession="ChatInput_Disabled_And_Banner_Shown_For_InActive_Chat_Session",e.QuerySubmittedBeforeAnnotationLoad="Query_Submitted_Before_Annotation_Load",e.ZQMRefreshButtonClicked="ZQM_Refresh_Button_Clicked",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.TrySydneyToggle="Try_Sydney_Toggle",e.IsSydneyEnabled="Is_Sydney_Enabled",e.HubbleEnterprisePromptClicked="EnterpriseImagePrompt_Clicked",e.BasicChatOperationSubmitted="Basic_Chat_Operation_Submitted",e.BasicChatStreamingResponseTimeout="Basic_Chat_Streaming_Response_Timeout",e.CachedBasicChatResponseShown="Cached_Basic_Chat_Response_Shown",e.EmptyBasicChatResponse="Empty_Basic_Chat_Response",e.QuerySuccessful="Query_Successful",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CLPEncryptedLabelSent="CLP_Encrypted_Label_Sent",e.CLPNonEncryptedLabelSent="CLP_Non_Encrypted_Label_Sent",e.CopilotLabDialogLaunched="Copilot_Lab_Dialog_Launched",e.CopilotLabDialogClosed="Copilot_Lab_Dialog_Closed",e.CopilotLabPromptItemClicked="Copilot_Lab_Prompt_Item_Clicked",e.CopilotLabSavedPromptClicked="Copilot_Lab_Saved_Prompt_Clicked",e.CopilotLabFilterUpdated="Copilot_Lab_Prompts_Filter_Updated",e.CopilotLabGoToCopilotLabButtonClicked="Copilot_Lab_GoToCopilotLab_Button_Clicked",e.CopilotLabPromptSubmitted="Copilot_Lab_Prompt_Submitted",e.CopilotLabPromptSaveClicked="Copilot_Lab_Prompt_AppChatSaved",e.CopilotLabPromptUnSaveClicked="Copilot_Lab_Prompt_AppChatUnsaved",e.CopilotLabPromptShareClicked="Copilot_Lab_Prompt_AppChatShare",e.GroundingSourceUpdated="Grounding_Source_Updated",e.GroundingButtonClicked="Grounding_Button_Clicked",e.EnabledPluginsInfoFetched="Enabled_Plugins_Info_Fetched",e.CopilotBrokeringWFFailure="Copilot_Brokering_WF_Failure",e.MenuButtonClicked="Menu_Button_Clicked",e.MenuL1SuggestionClicked="Menu_L1_Suggestion_Clicked",e.MenuL2SuggestionClicked="Menu_L2_Suggestion_Clicked",e.PluginConfigSignalSent="Plugin_Config_Signal_Sent",e.PromptSubmittedWithCIQ="Prompt_Submitted_With_CIQ",e.CIQSuggestionSelected="CIQ_Suggestion_Selected",e.PromptSubmittedWithFileEntity="Prompt_Submitted_With_File_Entity",e.ReadAloudPlayButtonClicked="Read_Aloud_Play_Button_Clicked",e.ReadAloudPauseButtonClicked="Read_Aloud_Pause_Button_Clicked",e.ReadAloudResumeButtonClicked="Read_Aloud_Resume_Button_Clicked",e.ReadAloudStopButtonClicked="Read_Aloud_Stop_Button_Clicked",e.ReadAloudMessageRegister="Read_Aloud_Message_Register",e.ReadAloudMessageUnregister="Read_Aloud_Message_Unregister",e.ReadAloudAudioPlayStart="Read_Aloud_Audio_Play_Start",e.ReadAloudAudioPlayPause="Read_Aloud_Audio_Play_Pause",e.ReadAloudAudioPlayResume="Read_Aloud_Audio_Play_Resume",e.ReadAloudAudioPlayStop="Read_Aloud_Audio_Play_Stop",e.ReadAloudAudioPlayComplete="Read_Aloud_Audio_Play_Complete",e.ReadAloudAPIRequestSuccess="Read_Aloud_API_Request_Success",e.ReadAloudAPIRequestFailure="Read_Aloud_API_Request_Failure",e.ReadAloudUnkownFailure="Read_Aloud_Unkown_Failure",e.HandoffEditInButtonRendered="Handoff_Edit_In_Button_Rendered",e.HandoffEditInMenuButtonClicked="Handoff_Edit_In_Menu_Button_Clicked",e.HandoffEditInItemButtonClicked="Handoff_Edit_In_Item_Button_Clicked",e.HandoffEditInRequestSent="Handoff_Edit_In_Request_Sent",e.HandoffEditInResponseReceived="Handoff_Edit_In_Response_Received",e.HandoffEditInRequestSucceeded="Handoff_Edit_In_Request_Succeeded",e.HandoffEditInRequestFailed="Handoff_Edit_In_Request_Failed",e.SubstrateAPIOperationSubmitted="Substrate_API_Operation_Submitted",e.MsgExtCardDataReceived="MsgExtCard_Data_Received",e.MsgExtAuthPopupOpened="MsgExtAuth_Popup_Opened",e.ExtPluginFlyoutEventDataReceived="Ext_Plugin_Flyout_Event_Data_Received",e.GetTokenInvoked="Get_Token_Invoked",e.ShowChatHistoryButtonClicked="Show_Chat_History_Button_Clicked",e.ChatHistoryBackButtonClicked="Chat_History_Back_Button_Clicked",e.ChatHistoryNewConversationButtonClicked="Chat_History_New_Conversation_Button_Clicked",e.ChatHistoryStartNewChatCalled="Chat_History_Start_New_Chat_Called",e.ChatHistoryDeleteButtonClicked="Chat_History_Delete_Button_Clicked",e.ChatHistoryDeleteAllButtonClicked="Chat_History_Delete_All_Button_Clicked",e.ChatHistoryConversationClicked="Chat_History_Conversation_Clicked",e.LoadChatHistoryPanel="Load_Chat_History_Panel",e.LoadMoreConversations="Load_More_Conversations",e.SwitchChatHistoryConversation="Switch_Chat_History_Conversation",e.ChatHistoryChangeTopicClicked="Chat_History_Change_Topic_Button_Clicked",e.ChatHistoryChangeTopicOnSwitcherMenuClicked="Chat_History_Change_Topic_In_Switcher_Menu_Clicked",e.IsFirstTimeChatPaneOpened="Is_First_Time_Chat_Pane_Opened",e.CopilotLocalStorageCreateInstanceFailed="Copilot_Local_Storage_Create_Instance_Failed",e.CopilotLocalStorageGetFailed="Copilot_Local_Storage_Get_Failed",e.CopilotLocalStorageSetFailed="Copilot_Local_Storage_Set_Failed",e.CopilotLocalStorageSetPropertiesFailed="Copilot_Local_Storage_Set_Properties_Failed",e.ImagesFromChatHistoryRehydrated="Images_From_Chat_History_Rehydrated",e.PluginStateAtWarmup="Plugin_State_At_Warmup",e.PluginStateAtInput="Plugin_State_At_Input",e.UnknownCreditLimitType="Unknown_Credit_Limit_Type",e.CopilotAppChatTUIShown="Copilot_App_Chat_TUI_Shown",e.CopilotAppChatGetTUIEverShownStateError="Copilot_App_Chat_Get_TUI_Ever_Shown_State_Error",e.CreditBalanceAnnotationStatus="Credit_Balance_Annotation_Status",e.CreditLimitType="Credit_Limit_Type",e.CommandingErrorCardClicked="CommandingErrorCardClicked",e.QuerySubmissionToAugloopAborted="Query_Submission_To_Augloop_Aborted",e.CopilotChatHistorySessionStorageCreateInstanceFailed="Copilot_Chat_History_Session_Storage_Create_Instance_Failed",e.CopilotSessionStorageGetFailed="Copilot_Session_Storage_Get_Failed",e.CopilotSessionStorageSetFailed="Copilot_Session_Storage_Set_Failed",e.CopilotSessionStorageSetPropertiesFailed="Copilot_Session_Storage_Set_Properties_Failed",e.CopilotChatHistorySessionStorageUsed="Copilot_Chat_History_Session_Storage_Used",e.SwitcherMenuStateChange="Switcher_Menu_State_Change",e.CopilotChange="Copilot_Change",e.GetGPTListRequest="Get_GPT_List_Request",e.GetGPTListResponse="Get_GPT_List_Response",e.GetGPTDetailsRequest="Get_GPT_Details_Request",e.GetGPTDetailsResponse="Get_GPT_Details_Response",e.GetGPTListError="Get_GPT_List_Error",e.GetGPTDetailsError="Get_GPT_Details_Error",e.GetGPTListLatency="Get_GPT_List_Latency",e.GetGPTListUserPerceivedLatency="GPT_List_User_Perceived_Latency",e.GetGPTDetailsLatency="Get_GPT_Details_Latency",e.GetGPTListTimeout="Get_GPT_List_Timeout",e.GetGPTDetailsTimeout="Get_GPT_Details_Timeout",e.GetCachedGPTList="Get_Cached_GPT_List",e.GetCachedGPTDetails="Get_Cached_GPT_Details",e.GPTBrandingIdInvalid="GPT_Branding_Id_Invalid",e.MessageHydrationCopilotId="Message_Hydration_Copilot_Id",e.NumInstalledDCs="Num_Installed_DCs",e.InputSignalSwitcherMenuGptId="Input_Signal_Switcher_Menu_Gpt_Id",e.InputSignalAtMentionGptId="Input_Signal_At_Mention_Gpt_Id",e.WorkflowDataMapNotInitialized="Workflow_Data_Map_Not_Initialized",e.ZQMEarlyLoadUsingCache="ZQM_Early_Load_Using_Cache",e.OpenAgentFromMOS="OpenAgentFromMOS",e.RequestContinuationMessageSent="Request_Continuation_Message_Sent"}(a||(a={})),function(e){e.AugloopResponseTimeoutMessage="AugloopResponseTimeoutMessage"}(s||(s={}));const l={...a,...o,...i,UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"};var c,u,d,p,h,g,f,m,y;!function(e){e.ContentGeneration="ContentGeneration",e.Commanding="Commanding",e.QAandSummaries="QAandSummaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(c||(c={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(u||(u={})),function(e){e.BasicChat="Basic Chat",e.ContentCreation="Content Creation Skill in Chat",e.PluginToggled="Plugin toggled",e.GetPluginConfig="Get Plugin Config",e.GetPluginDefinition="Get Plugin Definition",e.PluginFlyoutRenderer="Plugin Flyout Renderer",e.DeclarativeCopilots="Declarative Copilots",e.ExtensibilityDeclarativeAgents="Extensibility Declarative Agents"}(d||(d={})),function(e){e.Client="Client",e.Server="Server"}(p||(p={})),function(e){e.ChatQnA="Chat QnA",e.Draft="Draft",e.CopilotChat="CopilotChat",e.Extensibility="Extensibility"}(h||(h={})),function(e){e.BasicChatRAIFilterBlockedResponse="Ask Chat QnA Responsible AI Filter Blocked Response",e.ChatComposeDidNotGenerateContent="CopilotChatComposeDidNotGenerateContent",e.BasicChatUnsupportedCopilotFunctionality="Ask Chat QnA Unsupported Copilot Functionality",e.BasicChatMissingCopilotFunctionality="Ask Chat QnA Missing Copilot Functionality",e.BasicChatResponseTimedOut="Ask Chat QnA Response Delayed or Timed Out",e.BasicChatCapacityIssues="Ask Chat QnA Unable to Generate Response Due to Capacity Issue",e.BasicChatBadResponse="Ask Chat QnA LLM Service Side Issue Prevents Output",e.BasicChatInputNotProcessed="Ask Chat QnA User Input Could Not Be Processed",e.BasicChatTaskCompletionIssue="Ask Chat QnA Unable to Complete Task",e.BasicChatUnclassifiedError="Ask Chat QnA Unclassified ASHA Error",e.BasicChatUserCancelledResponse="Ask Chat QnA User Rejected or Cancelled Response"}(g||(g={})),function(e){e.UserAccessIssue="Unclear Intent CopilotChat User Access Issue for Copilot"}(f||(f={})),function(e){e.Fallback="Error occurred because of an unclassifed issue",e.InputTooLong="Error occurred because input is too long",e.UserThrottled="Error occurred because user has issued too many requests",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.Timeout="Timeout waiting for server",e.InvalidLanguage="Error occurred because language is not supported",e.InvalidSignal="Error occurred because signal/response is invalid",e.PromptInjection="Error occurred because prompt injection is detected",e.InputBlocked="Error occurred because input is blocked by filters",e.OutputBlocked="Error occurred because output is blocked by filters",e.OffensiveInput="Error occurred because user input is offensive",e.OffensiveOutput="Error occurred because offensive content is blocked in output",e.SignalMissing="Error occurred because signal is missing in workflow",e.SignalWrongType="Error occurred because signal is invalid",e.BadResponse="Error occured because of bad response",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.BadRequest="Error occured because of bad request",e.Unknown="Error is unknown",e.UserAbortedQueryExecution="User aborted query execution",e.APIUnavailable="Error occured because API is not available",e.RAIOnInputError="Error occurred while checking RAI on input query",e.RAIOnOutputError="Error occurred while checking RAI on generated output",e.UnknownError="Unknown error from model",e.QueryEndGptSwitch="Error occurred because of query end on GPT switch"}(m||(m={})),function(e){e.Licensing="Error occured because copilot license couldn't be validated"}(y||(y={}));const v="UserQueryGuid",C="ALSessionKey",b="Chat"},4801:(e,t,n)=>{var o,r,i,a,s,l;n.d(t,{PM:()=>l,S2:()=>a,lr:()=>s,uk:()=>i}),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=3]="SystemMetadata",e[e.OrganizationIdentifiableInformation=4]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=5]="EndUserIdentifiableInformation",e[e.CustomerContent=6]="CustomerContent",e[e.AccessControl=7]="AccessControl",e[e.PublicNonPersonalData=8]="PublicNonPersonalData",e[e.EndUserPseudonymousInformation=9]="EndUserPseudonymousInformation",e[e.PublicPersonalData=10]="PublicPersonalData",e[e.SupportData=11]="SupportData",e[e.Everything=12]="Everything"}(o||(o={})),function(e){e[e.CP_EVENT_TYPE_NOT_SET=1]="CP_EVENT_TYPE_NOT_SET",e[e.CP_EVENT_TYPE_CRITICAL=2]="CP_EVENT_TYPE_CRITICAL"}(r||(r={})),function(e){e[e.CP_DATA_CATEGORY_NOT_SET=1]="CP_DATA_CATEGORY_NOT_SET",e[e.CP_DATA_CATEGORY_SOFTWARE_SETUP=2]="CP_DATA_CATEGORY_SOFTWARE_SETUP",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE=3]="CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE",e[e.CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE=4]="CP_DATA_CATEGORY_PRODUCT_SERVICE_PERFORMANCE",e[e.CP_DATA_CATEGORY_DEVICE_CONFIGURATION=5]="CP_DATA_CATEGORY_DEVICE_CONFIGURATION",e[e.CP_DATA_CATEGORY_INKING_TYPING_SPEECH=6]="CP_DATA_CATEGORY_INKING_TYPING_SPEECH"}(i||(i={})),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.NotificationLatency="NotificationLatency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.QueryDetails="QueryDetails",e.Chat="Chat",e.AppDefinition="AppDefinition",e.AgentEvents="AgentEvents",e.StoryTeller="StoryTeller",e.Microphone="Microphone"}(a||(a={})),function(e){e.ChatEvents="ChatEvents",e.Latency="Latency",e.Error="Error",e.QueryDetails="QueryDetails",e.Chat="Chat",e.Microphone="Microphone",e.AshaError="AshaError",e.AgentError="AgentError",e.AgentEvents="AgentEvents"}(s||(s={})),function(e){e[e.CP_DIAGNOSTIC_LEVEL_OPTIONAL=1]="CP_DIAGNOSTIC_LEVEL_OPTIONAL",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED=2]="CP_DIAGNOSTIC_LEVEL_REQUIRED",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES=3]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA_FOR_ESSENTIAL_SERVICES",e[e.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA=4]="CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA"}(l||(l={}))},7058:(e,t,n)=>{n.d(t,{f:()=>r});const o=e=>({chatUiStack:e.chatUiStack??{},chatFreStack:e.chatFreStack??{},shimmerUi:e.shimmerUi??{},shimmerUiZoom:e.shimmerUiZoom??{},chatUiStackZoom:e.chatUiStackZoom??{},chatFreStackZoom:e.chatFreStackZoom??{},chatFreStackContainer:e.chatFreStackContainer??{},spinner:e.spinner??{},headerElement:e.headerElement??{},incomingShimmerCard:e.incomingShimmerCard??{},outgoingShimmerCard:e.outgoingShimmerCard??{},incomingShimmerCardWrapper:e.incomingShimmerCardWrapper??{},outgoingShimmerCardWrapper:e.outgoingShimmerCardWrapper??{},voicePageContainer:e.voicePageContainer??{}});function r(e){return o(e)}},33500:(e,t,n)=>{var o,r,i,a,s,l,c,u,d,p,h,g,f;n.d(t,{$v:()=>d,Ku:()=>p,O4:()=>c,Q9:()=>o,WT:()=>a,c_:()=>s,jc:()=>r,pf:()=>l,u1:()=>f,un:()=>h}),function(e){e.Chat="chat",e.Human="human"}(o||(o={})),function(e){e.BASIC_CHAT="BasicChat",e.DRAFT="Draft"}(r||(r={})),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(i||(i={})),function(e){e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsApplyClpFromHydratedMessagedEnabled="IsApplyClpFromHydratedMessagedEnabled",e.SkipHydrateEnabled="SkipHydrateEnabled",e.HydratedMessagesSquashingEnabled="HydratedMessagesSquashingEnabled",e.IsChatHistoryPaginationEnabled="IsChatHistoryPaginationEnabled",e.IsCopilotPluginEnabled="IsCopilotPluginEnabled",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.DisableChatHistoryPaginationFix="DisableChatHistoryPaginationFix",e.EnableSendTenantFeedback="EnableSendTenantFeedback",e.ShowRestrictiveSearchBanner="ShowRestrictiveSearchBanner",e.EnableRestrictiveSearchBanner="EnableRestrictiveSearchBanner",e.IsWebSearchDefaultOn="IsWebSearchDefaultOn",e.IsLicenseAnnotationEnabled="IsLicenseAnnotationEnabled",e.IsDebugSectionV2Enabled="IsDebugSectionV2Enabled",e.IsDisableChatInputWhenAlSessionCloseEnabled="IsDisableChatInputWhenAlSessionCloseEnabled",e.EnableALCorrelationLogs="EnableALCorrelationLogs",e.IsSuggestedQnACitationsEnabled="IsSuggestedQnACitationsEnabled",e.EnableMsgExtCardTelemetry="EnableMsgExtCardTelemetry",e.EnableCopilotExtTelemetry="EnableCopilotExtTelemetry",e.ExtractContentFromCardForFeedback="ExtractContentFromCardForFeedback",e.AugloopResponseTimeoutDuration="AugloopResponseTimeoutDuration",e.EnablePersonalizationIndicatorHeader="EnablePersonalizationIndicatorHeader",e.EnableInlineCreationHVC="EnableInlineCreationHVC",e.EnableInlineCreationHVCV2="EnableInlineCreationHVCV2",e.IsClaimChallengeEnabled="IsClaimChallengeEnabled",e.IsFeedbackAppChatIntegrationEnabled="IsFeedbackAppChatIntegrationEnabled",e.shouldLimitFilesInlineCreationHVC="shouldLimitFilesInlineCreationHVC",e.IsServerAuthenticationStateChangeEnabled="IsServerAuthenticationStateChangeEnabled"}(a||(a={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.UnknownOpenAI="unknown-openai",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(s||(s={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(l||(l={})),function(e){e.HandleSubmitError="handle-submit-error",e.AugloopInitializationError="augloop-initialization-error",e.ActivateAnnotationError="activate-annotation-error",e.AugloopResponseTimeout="augloop-response-timeout",e.ChatHistoryResponseTimeout="chat-history-response-timeout",e.AugloopPluginProviderFailure="augloop-plugin-provider-failure",e.MosProviderFailure="mos-provider-failure",e.MsgExtCardError="msg-ext-card-error",e.InteractionRequiredError="interaction-required",e.APIPluginSignInError="api-plugin-sign-in",e.HostMosTokenProvisioningError="host-mos-token-provisioning",e.HostGraphTokenProvisioningError="host-graph-token-provisioning",e.HostSharePointTokenProvisioningError="host-sharepoint-token-provisioning",e.HostOnenoteTokenProvisioningError="host-onenote-token-provisioning",e.MsalBrowserLoadError="msal-browser-load-error",e.NoSelectedAccountFoundError="no-selected-account-found",e.EmptyClientInfoForAuthToken="empty-client-info-for-auth-token",e.AuthTokenAcquireError="auth-token-acquire-error",e.AuthTokenCallFailedError="auth-token-call-failed-error",e.SketchImageResizeError="sketch-image-resize-error",e.MissingServicePlanBYOA="MissingServicePlanBYOA"}(c||(c={})),function(e){e.RestShy="RestShy",e.Expanded="Expanded"}(u||(u={})),function(e){e.Favourite="Favourite",e.Unfavourite="Unfavourite"}(d||(d={})),function(e){e.PromptGuide="PromptGuide",e.Microphone="Microphone",e.SubmitButton="SubmitButton",e.GroundingButton="GroundingButton"}(p||(p={})),function(e){e.ENTERPRISE_SEARCH="EnterpriseSearch",e.WEB_SEARCH="BingWebSearch"}(h||(h={})),function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(g||(g={})),function(e){e.None="none",e.Copylink="copylink",e.Download="download",e.Remove="remove",e.Sendcopy="sendcopy",e.Share="share",e.Unsubscribe="unsubscribe"}(f||(f={}))},35282:(e,t,n)=>{n.d(t,{E:()=>k});var o=n(35373),r=n(59777),i=n(71874),a=n(55161),s=n(26731),l=n(50857),c=n(59824),u=n(57743),d=n(38292),p=n(26532),h=n(33500),g=n(90922),f=n(78715),m=n(6182),y=n(48082),v=n(91834),C=n(18036),b=n(89994),E=n(89518),A=n(881),S=n(95113),I=n(90326),P=n(51311),T=n(86378),x=n(48153),w=n(19796);class k{constructor(){this.isSessionConnected=!0,this.isSessionClosed=!1,this.isLicenseAnnotationActivated=!0,this.operationListForResubmit=new Map,this.callbackTokens=[],this.annotationTokens=[],this.isInitialized=!1,this.telemetryLoggerUtils=p.j.getInstance(),this.isInitialized=!1}static getInstance(){return void 0===this.sInstance&&(this.sInstance=new k),this.sInstance}static resetInstance(){this.sInstance=void 0}initialize(e,t,n,o,r,i){this.isInitialized=!0,void 0!==n&&this.alSession!==n&&(this.releaseActiveAnnotations(),this.removeCallbacks()),this.chatContainerBuilder=e,this.copilotCommunicationHandler=t,this.alSession=n,this.isSessionClosed=this.alSession.isClosed,this.isSessionConnected=this.alSession.isConnected,this.loggingEventHandler=d.A.getInstance(t),this.telemetryLoggerUtils=p.j.getInstance(),this.setIsExecuting=o,this.setALSessionClosed=r,this.licenseValidationErrorMessage=i,this.setALSessionClosed(this.isSessionClosed),this.registerCallbacks()}removeCallbacks(){!1!==this.isInitialized?((0,o.cY)("Removing callbacks from AL session."),this.callbackTokens.forEach((e=>{this.alSession?.removeSessionStateCallback(e)})),this.callbackTokens=[]):(0,o.cY)("AugloopConnectionHandler is not initialized")}releaseActiveAnnotations(){!1!==this.isInitialized?(this.isSessionClosed||this.annotationTokens.forEach((e=>{this.alSession?.releaseAnnotation(e).then((e=>{(0,o.cY)("Annotation deactivated: "+e)})).catch((e=>{(0,o.cY)("error in deactivating: ",e)}))})),this.annotationTokens=[]):(0,o.cY)("AugloopConnectionHandler is not initialized")}registerCallbacks(){this.registerOnConnectCallback(),this.registerOnDisconnectCallback(),this.registerOnReconnectCallback(),this.registerOnCloseCallback()}registerOnConnectCallback(){if(!1===this.isInitialized)return void(0,o.cY)("AugloopConnectionHandler is not initialized");const e=this.alSession?.setConnectCallback(((e,t,n,a)=>{const s=t.substring(t.lastIndexOf("/")+1);this.copilotCommunicationHandler&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(h.WT.EnableALCorrelationLogs)&&((0,o.cY)(`Setting AL session key in CorrelationUtils from connect callback: ${s}`),S.w.getInstance().setAlSessionKey(s)),(0,o.cY)(`AL Session onSessionConnect, isSeedingRequired: ${e}, sessionKey: ${s}`),this.isSessionConnected=!0,this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.ALSessionConnected},{key:g.h3.ChatEventParameters,value:"isSeedingRequired: "+e.toString()},{key:g.h3.ALSessionKey,value:s}]),this.loggingEventHandler?.sendLoggingEventToClient(r.Yk.ALSessionConnected,{chatEventParams:e.toString()}),e?(0,o.Kx)()?this.resubmitTimerId=setTimeout((()=>{this.isLicenseAnnotationActivated||((0,o.cY)("License annotation is not activated, so not re-submitting signal and showing error"),(0,E.dS)(this.chatContainerBuilder,this.licenseValidationErrorMessage),i._.getInstance().clearAugloopResponseTimer(),(0,o.oc)(A.Ml.getTypeName(),"License annotation is not activated",g.q0.Client,g.DO.UserAccessIssue,g.H7.Licensing,g.Z_.CopilotChat),this.setIsExecuting&&this.setIsExecuting(!1),this.copilotCommunicationHandler?.sendEventToClient(r.PV.ResetContextId)),this.clearOperationListForResubmit()}),b.NJ):this.resubmitOnLicenseAnnotationActivation():(this.clearOperationListForResubmit(),this.setLicenseAnnotationActivated(!0))}));e&&this.callbackTokens.push(e)}registerOnDisconnectCallback(){if(!1===this.isInitialized)return void(0,o.cY)("AugloopConnectionHandler is not initialized");const e=this.alSession?.setDisconnectCallback((e=>{(0,o.cY)("AL Session Disconnected",e),this.isSessionConnected=!1,(0,o.Kx)()&&this.setLicenseAnnotationActivated(!1),this.loggingEventHandler?.sendLoggingEventToClient(r.Yk.ALSessionDisconnected),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.ALSessionDisconnected},{key:g.h3.ChatEventParameters,value:(new Date).getTime().toString()}])}));e&&this.callbackTokens.push(e)}registerOnReconnectCallback(){if(!1===this.isInitialized)return void(0,o.cY)("AugloopConnectionHandler is not initialized");const e=this.alSession?.setReconnectCallback((()=>{this.isSessionConnected=!0,this.loggingEventHandler?.sendLoggingEventToClient(r.Yk.ALSessionReconnected),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.ALSessionReconnected},{key:g.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),(0,o.cY)("AL Session Reconnected")}));e&&this.callbackTokens.push(e)}registerOnCloseCallback(){if(!1===this.isInitialized)return void(0,o.cY)("AugloopConnectionHandler is not initialized");const e=this.alSession?.setSessionCloseCallback((e=>{this.isSessionClosed=!0,this.setALSessionClosed&&this.setALSessionClosed(this.isSessionClosed),this.loggingEventHandler?.sendLoggingEventToClient(r.Yk.ALSessionClosed),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.ALSessionClosed}]),(0,o.cY)("AL Session Closed",e)}));e&&this.callbackTokens.push(e)}async activateAnnotation(e,t,n,i,a,c,d,p,E,A,S,I,k,_){!1!==this.isInitialized?await(this.alSession?.activateAnnotation(e,{callback:t,config:n,forceReturnCachedAnnotations:a}).then((async t=>{if((0,o.cY)("Annotation Token: "+t.token),this.annotationTokens.push(t.token),e===s.tP.getTypeName()||e===s.Pd.getTypeName()||e===s.CT.getTypeName()||t.token.includes(s.tP.getTypeName())||t.token.includes(s.Pd.getTypeName())||t.token.includes(s.CT.getTypeName())){if(e===s.Pd.getTypeName()){(0,u.jg)(!0);const e={gptId:A},t=I?.copilotChatConversationSelectedContext?.conversationId?.current;p&&!t&&k?.(E?.isCustomGPTsEnabled&&E?.enableQueryEndOnGptSwitch?{eventName:b.HK,gptId:A,shouldSetLoadingUIStates:!1,resetChatState:!0}:{eventName:b.HK,gptId:A,shouldSetLoadingUIStates:!0}),E?.isChatClickForGPTsEnabled&&t&&(_?.(),await(0,u.a_)(l.S5.GetMessagesOperation,void 0,void 0,void 0,t,void 0,void 0,e),I.copilotChatConversationSelectedContext.conversationId.current=null)}let t;c&&(t=P.g.getInstance()?.get()?.hasPaneOpenedInCurrentAppSession,this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.IsFirstTimeChatPaneOpened},{key:g.h3.ChatEventParameters,value:null===t?"unknown":t.toString()}]));const n=E?.isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled&&!w.n.getInstance(this.copilotCommunicationHandler?.getHostSettings()?.sessionStorageKey)?.isInErrorState();if(p)(0,u.Jk)(i,this.copilotCommunicationHandler,!0,d,!1,E?.isQueryWarmupSignalEnabledOnChatPaneOpens?S:void 0),P.g.getInstance()?.setProperties({hasPaneOpenedInCurrentAppSession:!0});else{const e=n;(n||!c||!t)&&(0,u.Jk)(i,this.copilotCommunicationHandler,!1,d,e)}}else(e===f.pK.getTypeName()||t.token.includes(f.pK.getTypeName()))&&this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(h.WT.IsQnASuggestionPillCachingEnabled)?this.submitOperation(m.U.getInstance().getSuggestedQnaScenarioSignalOperation(),f.pK.getTypeName()):e===v.x.getTypeName()&&this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(h.WT.IsSharedCopilotLabEnabled)?(this.submitOperation((0,y.C)(C.p.Suggestion),v.x.getTypeName()),E?.isSaveSharePromptEnabled&&this.submitOperation((0,y.C)(C.p.UserPrompts,void 0,void 0,void 0,C.y.GET),v.x.getTypeName())):e===T.d.getTypeName()&&E?.isCreditsUIEnabled&&(0,x.g)();const n={workflowAnnotationType:e,responseToken:t.token};this.copilotCommunicationHandler?.sendEventToClient(r.PV.AnnotationActivated,n)})).catch((e=>{(0,o.cY)("error in activating: ",e)}))):(0,o.cY)("AugloopConnectionHandler is not initialized")}submitOperation(e,t){if(!1===this.isInitialized)return void(0,o.cY)("AugloopConnectionHandler is not initialized");const n=e.items.length>0?e.items[0]?.body?.H_?.T_:"";(!1===this.isSessionConnected||!0===this.isSessionClosed||(0,o.Kx)()&&!1===this.isLicenseAnnotationActivated)&&((0,o.cY)("Session is not connected, adding operation to resubmit list."),this.operationListForResubmit.set(e,t),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.AddToOperationListForResubmit},{key:g.h3.ChatEventParameters,value:n??""}]));let i=(0,I.N)();if(this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(h.WT.EnableALCorrelationLogs)){i=S.w.getInstance().getQueryCv();const e=this.alSession?.getConnectParams()?.sessionUrl;if((0,o.cY)(`Session URL from submitOperation: ${e}`),e){const t=e.substring(e.lastIndexOf("/")+1);S.w.getInstance().getAlSessionKey()||((0,o.cY)(`Setting AL session key in CorrelationUtils from submitOperation: ${t}`),S.w.getInstance().setAlSessionKey(t))}}(0,o.cY)(`Submitting operation to AL: ${e}, signalName: ${n}, cv: ${i}`),this.alSession?.submitOperation(e,i);const a={workflowAnnotationType:t,cv:i,operation:JSON.stringify(e)};this.copilotCommunicationHandler?.sendEventToClient(r.PV.QuerySubmitted,a),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.QuerySubmittedToAL},{key:g.h3.ChatEventParameters,value:n??""},{key:g.h3.Cv,value:i},{key:g.h3.ALSessionKey,value:S.w.getInstance().getAlSessionKey()},{key:g.h3.AuthMessageStatus,value:S.w.getInstance().getAuthMessageStatus()}]);n===c.T.getTypeName()&&e.items.length>0&&e.items[0]?.body?.operation?.type===l.S5.AddMessageOperation||this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:g.CT.RequestSignalType,value:n??""},{key:g.CT.Cv,value:i},{key:g.h3.ALSessionKey,value:S.w.getInstance().getAlSessionKey()}])}clearOperationListForResubmit(){!1!==this.isInitialized?(this.operationListForResubmit.clear(),(0,o.cY)("Operation list for resubmit is cleared"),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.ResetOperationListForResubmit},{key:g.h3.ChatEventParameters,value:(new Date).getTime().toString()}])):(0,o.cY)("AugloopConnectionHandler is not initialized")}setLicenseValidationErrorMessage(e){this.licenseValidationErrorMessage=e}setLicenseAnnotationActivated(e){this.isLicenseAnnotationActivated=e,(0,o.cY)("License Annotation Activated: "+e)}resubmitOnLicenseAnnotationActivation(){!1!==this.isInitialized?((0,o.cY)("operationListForResubmit: ",this.operationListForResubmit),this.operationListForResubmit.forEach(((e,t)=>{this.submitOperation(t,e),(0,o.cY)("Resubmitting signal for operation: ",t);const n=t.items.length>0?t.items[0]?.body?.H_?.T_:"";this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.QueryResubmittedToAL},{key:g.h3.ChatEventParameters,value:n??""}]),a.A.getInstance().isAugloopResponseTimeoutRequired(e)&&i._.getInstance().setAugloopResponseTimer(e)})),clearTimeout(this.resubmitTimerId),(0,o.cY)("Resubmitting signals for operations in operation list for resubmit is completed. Cleared resubmit timer."),this.clearOperationListForResubmit()):(0,o.cY)("AugloopConnectionHandler is not initialized")}}},71874:(e,t,n)=>{n.d(t,{_:()=>y});var o=n(35373),r=n(89994),i=n(90922),a=n(33500),s=n(4801),l=n(22330),c=n(59777),u=n(55161),d=n(35282),p=n(54674),h=n(78715),g=n(6182),f=n(26532),m=n(95113);class y{constructor(){this.augloopResponseTimerID=NaN,this.augloopResponseTimeout=NaN,this.telemetryLoggerUtils=f.j.getInstance(),this.isInitialized=!1,this.lastUserQueryGuidSetTimer=r.u1,this.lastUserQueryGuidClearTimer=r.u1,this.augloopResponseTimeoutInternal=()=>{this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:i.h3.AugloopTimer,value:`Augloop Timer with TimerId: ${this.augloopResponseTimerID} timed out`}]),this.augloopResponseTimerID=NaN,(0,o.cY)("Augloop Response Timed Out for workflow",this.workflowAnnotationType),d.E.getInstance().clearOperationListForResubmit(),this.augloopResponseTimeout=u.A.getInstance().getDefaultAugloopWorkflowTimeoutValue();let e=!0,t=r.u1;this.copilotCommunicationHandler&&this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(a.WT.EnableALCorrelationLogs)&&(t=m.w.getInstance().getQueryCv()),this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:i.CT.ErrorParameter,value:i.a5.AugloopResponseTimeout},{key:i.CT.ErrorType,value:i.q0.Server}]),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:i.h3.ChatEventType,value:i.a5.AugloopResponseTimeout},{key:i.h3.ChatErrorType,value:i.q0.Server},{key:i.h3.ChatEventParameters,value:this.workflowAnnotationType??""},{key:i.h3.ChatErrorKey,value:i.Nr.AugloopResponseTimeoutMessage},{key:i.h3.Cv,value:t},{key:i.h3.ALSessionKey,value:m.w.getInstance().getAlSessionKey()}]),this.telemetryLoggerUtils.sendTelemetryErrorData([{key:i.IC.ErrorMessage,value:r.JM},{key:i.IC.ErrorType,value:i.q0.Server},{key:i.IC.ErrorCode,value:a.O4.AugloopResponseTimeout},{key:i.IC.ErrorCategory,value:s.S2.ChatEvents}]),this.workflowAnnotationType&&this.workflowAnnotationType===p.L.getTypeName()&&this.setSensitivityWarningInfo?this.setSensitivityWarningInfo():(g.U.getInstance().getIsBasicChatStreaming()&&this.workflowAnnotationType&&this.workflowAnnotationType===h.Ob.getTypeName()&&(g.U.getInstance().handleTimeoutForBasicChatStreaming(),e=!1),this.copilotCommunicationHandler&&this.copilotCommunicationHandler.sendEventToClient(c.PV.AugloopResponseTimeout,{workflowAnnotationType:this.workflowAnnotationType??""})),e&&this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:i.CT.UserPerceivedLatency,value:(0,l.WU)(l.qD)},{key:i.CT.IsQuerySuccess,value:!1}],!0)},this.isInitialized=!1}static getInstance(){return y.sInstance||(y.sInstance=new y),y.sInstance}initialize(e,t){this.copilotCommunicationHandler=e,this.setSensitivityWarningInfo=t,this.augloopResponseTimeout=u.A.getInstance().getDefaultAugloopWorkflowTimeoutValue(),this.isInitialized=!0}static resetInstance(){y.sInstance=void 0}setAugloopResponseTimer(e){if(!1===this.isInitialized)return void(0,o.cY)("AugloopResponseTimeoutHandler is not initialized");(0,o.cY)(`Setting augloop response Timer for workflow ${e}`);const t=u.A.getInstance();this.clearAugloopResponseTimer(),e&&(this.workflowAnnotationType=e),this.workflowAnnotationType&&(this.augloopResponseTimeout=t.getWorkflowAugloopTimeoutValue(this.workflowAnnotationType)),this.augloopResponseTimeout=this.augloopResponseTimeout??t.getDefaultAugloopWorkflowTimeoutValue(),this.augloopResponseTimerID=window.setTimeout(this.augloopResponseTimeoutInternal,this.augloopResponseTimeout),l.dB!=r.u1&&this.lastUserQueryGuidSetTimer!==l.dB&&(this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:i.h3.AugloopTimer,value:`Augloop Timer Set with TimerId: ${this.augloopResponseTimerID} for ${this.augloopResponseTimeout} ms for userQueryGuid: ${l.dB}`}]),this.lastUserQueryGuidSetTimer=l.dB)}clearAugloopResponseTimer(){!1!==this.isInitialized?isNaN(this.augloopResponseTimerID)||((0,o.cY)("Clear augloop response Timer"),l.dB!=r.u1&&this.lastUserQueryGuidClearTimer!==l.dB&&(this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:i.h3.AugloopTimer,value:`Augloop Timer Reset with TimerId: ${this.augloopResponseTimerID} for userQueryGuid: ${l.dB}`}]),this.lastUserQueryGuidClearTimer=l.dB),clearTimeout(this.augloopResponseTimerID),this.augloopResponseTimerID=NaN,this.augloopResponseTimeout=u.A.getInstance().getDefaultAugloopWorkflowTimeoutValue()):(0,o.cY)("AugloopResponseTimeoutHandler is not initialized")}isAugloopResponseTimerSet(){if(!1!==this.isInitialized)return!isNaN(this.augloopResponseTimerID);(0,o.cY)("AugloopResponseTimeoutHandler is not initialized")}}},57743:(e,t,n)=>{n.d(t,{Jk:()=>D,KC:()=>M,Ms:()=>B,UC:()=>L,W5:()=>w,a_:()=>F,g_:()=>N,jg:()=>R,mD:()=>A,zZ:()=>O});var o=n(50857),r=n(59824),i=n(26115),a=n(98483),s=n(57830),l=n(22330),c=n(13552),u=n(6609),d=n(35282),p=n(35373),h=n(59777),g=n(38292),f=n(26532),m=n(90922),y=n(33500),v=n(89994),C=n(1382),b=n(6394);let E,A,S,I=[],P=null,T=null,x=null,w=!0,k=!1,_=[];const D=async(e,t,n,r,i,a)=>{if(n||i)return A=(new Date).getTime(),u.P.getInstance().setAugloopResponseTimer(),u.P.getInstance().clearAugloopResponseTimer(),void a?.();f.j.getInstance().sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.CurrentChatHistoryStart},{key:m.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),A=(new Date).getTime(),await F(o.S5.GetCurrentChatOperation,void 0,e,t,void 0,r)},F=async(e,t,n,l,c,y,A,T)=>{let _={},D=new r.T;const F=Date.now(),L=f.j.getInstance(),O=(0,C.DM)(),R=T?.gptId??void 0,M=T?.isGptsEnabled??!1;switch(e){case o.S5.AddChatOperation:_={newChat:{userId:"dummyUserId",documentId:"dummyDocId",sessionId:(0,a.A)(),messages:[],gptIdentifier:{id:R,source:"MOS3"}},type:o.S5.AddChatOperation},D=new r.T({operation:_,documentURLOrLocalPath:n,timestamp:F,documentSensitivity:S,orchestratorGroundingMode:O,isFluxChatHistoryAnnotationActivated:k});break;case o.S5.GetAllChatsOperation:{const e={pageSize:v.wd,syncState:c?void 0:x};_={type:o.S5.GetAllChatsOperation,paging:e,isGptsEnabled:M},D=new r.T({operation:_,documentURLOrLocalPath:n,timestamp:F,documentSensitivity:S,orchestratorGroundingMode:O,isFluxChatHistoryAnnotationActivated:k});break}case o.S5.GetCurrentChatOperation:{const e={pageSize:v.IG};_={type:o.S5.GetCurrentChatOperation,paging:y?e:void 0},D=new r.T({operation:_,documentURLOrLocalPath:n,timestamp:F,documentSensitivity:S,orchestratorGroundingMode:O,isFluxChatHistoryAnnotationActivated:k});break}case o.S5.GetMessagesOperation:{const e={pageSize:v.IG,syncState:c?void 0:P};b.c.chatSessionId=c??b.c.chatSessionId,_={type:o.S5.GetMessagesOperation,chatSessionId:b.c.chatSessionId,paging:e,setSessionAsCurrent:!!c,gptId:R},D=new r.T({operation:_,documentURLOrLocalPath:n,timestamp:F,documentSensitivity:S,orchestratorGroundingMode:O,isFluxChatHistoryAnnotationActivated:k});break}case o.S5.AddMessageOperation:b.c.chatSessionId||(w=!1),I.push(t.messageId),_={newMessage:t,type:o.S5.AddMessageOperation,chatSessionId:b.c.chatSessionId,plugins:A,gptId:R},D=new r.T({operation:_,documentURLOrLocalPath:n,timestamp:F,documentSensitivity:S,orchestratorGroundingMode:O,isFluxChatHistoryAnnotationActivated:k});break;case o.S5.DeleteChatOperation:_={type:o.S5.DeleteChatOperation,chatSessionId:c},D=new r.T({operation:_,documentURLOrLocalPath:n,timestamp:F,documentSensitivity:S,orchestratorGroundingMode:O,isFluxChatHistoryAnnotationActivated:k})}const B=new i.g0({parentPath:["Signal",r.T.getTypeName()],items:[{id:s.r.generateId(),body:D}]});g.A.getInstance().sendLoggingEventToClient(h.Yk.ChatHistorySignalSent,{timestamp:(new Date).getTime(),signalName:r.T.getTypeName(),operationType:e}),L.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.ChatHistorySignalSent},{key:m.h3.ChatEventParameters,value:`${r.T.getTypeName()}_${e}`}]),(0,p.cY)(`Submitting signal to Augloop : ${r.T.getTypeName()} with operation type: ${e} and signal: ${JSON.stringify(D)}`),t?.content&&(0,p.cY)(`sending message: ${t.content}`),d.E.getInstance().submitOperation(B,r.T.getTypeName()),E=(new Date).getTime(),e===o.S5.GetCurrentChatOperation&&u.P.getInstance().setAugloopResponseTimer()},L=async(e,t,n,i,a,s,d,v,C,A,S,k,D)=>{const L=e.body?.H_?.T_;(0,p.cY)(`${r.T.getTypeName()} response. Time Taken : ${(0,l.WU)(E)} sec \n`);const O=e?.body,R=O?.operationResponse,M=f.j.getInstance();g.A.getInstance().sendLoggingEventToClient(h.Yk.ChatHistoryResponseReceived,{timeInMs:(0,l.xJ)(E),annotationName:L,operationType:R.type}),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.ResponseReceivedFromAL},{key:m.h3.ChatEventParameters,value:`${L}_${R.type}`},{key:m.h3.Cv,value:A}]);let N={operationType:o.S5.GetChatOperation,augloopResponseTime:-1};const H=(0,l.WU)(E);switch(R.type){case o.S5.GetCurrentChatOperation:{const e=R;N={operationType:o.S5.GetCurrentChatOperation,augloopResponseTime:H},P=e.paging?.syncState,e.chat?(b.c.chatSessionId=e.chat?.sessionId,b.c.currentChatId=b.c.chatSessionId,(0,p.cY)("chatSessionId from GetCurrentChatOperation: "+b.c.chatSessionId),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.ChatHistorySessionLoaded},{key:m.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),0===n&&e.chat&&u.P.getInstance().isAugloopResponseTimerSet&&(_=e.chat.messages,(0,c.Al)(i,e.chat.messages,t,S)),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.GetCurrentChatStatus},{key:m.h3.ChatEventParameters,value:R.status}]),R.status!==o.nW.Success&&u.P.getInstance().isAugloopResponseTimerSet&&(i.sendEventToClient(h.PV.ChatHistoryHydrationFailed),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.ChatHistoryHydrationFailed}])),u.P.getInstance().clearAugloopResponseTimer()):(u.P.getInstance().setHasExistingChat(!1),C?u.P.getInstance().clearAugloopResponseTimer():await F(o.S5.AddChatOperation)),s?.(e.chat?.plugins??[]),S?.isQueryWarmupSignalEnabledOnChatPaneOpens&&k?.();break}case o.S5.GetMessagesOperation:{const e=R;if(T=P,P=e.paging?.syncState,v&&(e.status===o.nW.Success?(I=[],w=!0,_=[],b.c.currentChatId=b.c.chatSessionId,0===e.messages?.length&&v?.((()=>[]))):(b.c.chatSessionId=b.c.currentChatId,v?.()),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.SwitchChatHistoryConversation},{key:m.h3.ChatEventParameters,value:e.status}])),C&&V(),e.messages?.length>0){const n=[];for(const t of e.messages)i.isFeatureGateEnabledFromClient(y.WT.DisableChatHistoryPaginationFix)||I.includes(t.messageId)||(n.push(t),I.push(t.messageId));if(n?.length>0){w=!0;const e=e=>{const t=v?[]:e,o=(0,c.AK)(i,n,S);return(0,c.T)(i,o,t)};v?v(e):t(e)}else C&&_.length>0&&T!==P&&(F(o.S5.GetMessagesOperation),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.RetryGetMessageSignal}]))}else e.status!==o.nW.Failure&&(w=!1);M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.GetMessagesStatus},{key:m.h3.ChatEventParameters,value:e.status}]);break}case o.S5.GetAllChatsOperation:R.status===o.nW.Success?(x=R.paging?.syncState??x,d?.(R.chats,!1)):d?.([],!0),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.GetAllChatStatus},{key:m.h3.ChatEventParameters,value:R.status}]);break;case o.S5.GetChatOperation:case o.S5.GetMessagesInCurrentChatSession:break;case o.S5.AddChatOperation:N={operationType:o.S5.AddChatOperation,augloopResponseTime:H},R.status===o.nW.Success&&(C?D?.current||B():(b.c.chatSessionId=R.chats?.[0].sessionId,b.c.currentChatId=b.c.chatSessionId),(0,p.cY)("chatSessionId from AddChatOperation: "+b.c.chatSessionId)),u.P.getInstance().clearAugloopResponseTimer(),a&&a();break;case o.S5.AddMessageOperation:N={operationType:o.S5.AddMessageOperation,augloopResponseTime:H},C&&R.status===o.nW.Success&&(b.c.chatSessionId=R.chat?.sessionId,b.c.currentChatId=b.c.chatSessionId,(0,p.cY)("chatSessionId from AddMessageOperation: "+b.c.chatSessionId)),M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.AddMessageStatus},{key:m.h3.ChatEventParameters,value:R.status}]);break;case o.S5.DeleteChatOperation:{const e=R;M.sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.DeleteMessageStatus},{key:m.h3.ChatEventParameters,value:e.status}]);break}}-1!==N.augloopResponseTime&&(f.j.getInstance().addChatHistoryInfoLog(N),f.j.getInstance().sendTelemetryLatencyData([]))},O=e=>{e?.isEncrypted?f.j.getInstance().sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.CLPEncryptedLabelSent}]):f.j.getInstance().sendTelemetryChatEventData([{key:m.h3.ChatEventType,value:m.a5.CLPNonEncryptedLabelSent}]),S=e},R=e=>{k=e},M=()=>{E=void 0,b.c.chatSessionId=null,b.c.currentChatId=null,T=null,P=null,I=[],w=!0,S=void 0,k=!1,x=null},B=()=>{b.c.chatSessionId="",b.c.currentChatId="",T=null,P=null,x=null,I=[],w=!0},N=()=>{x=null},V=()=>{for(const e of _)I.includes(e.messageId)||I.push(e.messageId)}},48153:(e,t,n)=>{n.d(t,{g:()=>h,h:()=>g});var o=n(26115),r=n(20125),i=n(86378),a=n(35282),s=n(57830),l=n(35373),c=n(93047),u=n(26532),d=n(90922),p=n(89994);const h=()=>{const e=new r.m({scenarioGuid:p.OR}),t=new o.g0({parentPath:["Signal",r.m.getTypeName()],items:[{id:s.r.generateId(),body:e}]});(0,l.cY)(`Submitting signal to Augloop : ${r.m.getTypeName()} with operation type: ${t} and signal: ${JSON.stringify(e)}`),a.E.getInstance().submitOperation(t,i.d.getTypeName())},g=async(e,t,n)=>{const o=e?.body;if(!o)return void(0,l.cY)(`${i.d.getTypeName()} body is undefined. No credit information is available.`);const r=o.limitType,a=o.availableCredits,s=o.status,h=u.j.getInstance();h.sendTelemetryChatEventData([{key:d.h3.ChatEventType,value:d.a5.CreditBalanceAnnotationStatus},{key:d.h3.ChatEventParameters,value:s}]),r!=c.$n.Limited&&r!=c.$n.Unlimited||(n(r),h.sendTelemetryChatEventData([{key:d.h3.ChatEventType,value:d.a5.CreditLimitType},{key:d.h3.ChatEventParameters,value:r}])),r===c.$n.Unknown&&h.sendTelemetryChatEventData([{key:d.h3.ChatEventType,value:d.a5.UnknownCreditLimitType}]),r===c.$n.Limited?s===c.hc.OutOfCredits||a===p.Cb?t(p.Cb):a?t(a):(0,l.cY)("Expected availableCredits property to be returned in response but is missing."):r===c.$n.Unlimited&&t(null),(0,l.cY)(`Credit limit type: ${r}, available credits: ${a}, status: ${s}`)}},57120:(e,t,n)=>{n.d(t,{W:()=>g});var o,r=n(17239),i=n(26115),a=n(98483),s=n(35282),l=n(57830),c=n(35373),u=n(90922),d=n(26532),p=n(6394),h=n(50393);!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(o||(o={}));const g=async(e,t,n)=>{try{const f=JSON.parse(e),m=(new Date).toISOString(),{AnswerType:y,FeedbackReasonType:v}=(e=>{const t=e?.elements?.options??[];let n="CopilotChatFeedback",r=0;for(const e of t)switch(e.displayedText?.toLowerCase()){case o.INACCURATE_OR_IRRELEVANT:r=33554432;break;case o.OFFENSIVE:n="CopilotChatReportHarm",r=32;break;case o.OTHER:r=64}return{AnswerType:n,FeedbackReasonType:r}})(f?.responseContent),C=(0,h.Rx)(),b=f?.responseContent?.elements.find((e=>e.userVerbatim))?.userVerbatim??(f?.responseContent?JSON.stringify(f.responseContent):""),E=(g=C,g?.contextData?.sydneyContextData?g?.contextData?.sydneyContextData:{conversationId:p.c.currentChatId,feedbackMessageId:(0,h.Xf)(),locale:(0,h.Tw)(),sydneyEndpoint:(0,h.cy)(),utteranceTimeStamp:(new Date).toISOString()}),A=(0,h.cy)();if(!E.feedbackMessageId&&!n||!E.conversationId||!A&&!E.sydneyEndpoint)return void d.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.FeedbackDataSydneyDataMissing},{key:u.h3.ChatEventParameters,value:(C.contextData?.feedbackContextData?.errorMessage??"")+(C.contextData?.feedbackContextData?.errorType??"")}]);const S=Object.assign(new r.n,{responseData:{AnswerType:y,ClientName:t+"CopilotOCV",CorrelationId:(0,a.A)(),Date:m,Description:b,FeedbackId:f?.diagnosticsUploadId??(0,a.A)(),FeedbackRating:"Frown"===f?.feedbackType?1:2,FeedbackReasonType:v,UserConsentGiven:f?.hostManagedContextDataConsent??!0,OptionalFields:{ConvId:E.conversationId,Endpoint:E.sydneyEndpoint??A,Locale:E.locale??"en-us",TraceId:E.feedbackMessageId??(E.requestId?.length?E.requestId:"!TRACE_ID_NA"),FeedbackSourceType:"OCV",UtteranceHappenTime:E.utteranceTimeStamp??m,ContactMe:!!f?.userEmail}}}),I=new i.g0({parentPath:["Signal",r.n.getTypeName()],items:[{id:l.r.generateId(),body:S}]});(0,c.cY)(`Submitting FeedbackDiagnosticDataSignal to Augloop : ${r.n.getTypeName()} with signal: ${JSON.stringify(I)}`),s.E.getInstance().submitOperation(I,r.n.getTypeName()),d.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.FeedbackDataUploadOperationSubmitted}])}catch(e){(0,c.cY)("Error parsing feedback response data",e.message)}var g}},48082:(e,t,n)=>{n.d(t,{C:()=>C,M:()=>b});var o=n(26115),r=n(18036),i=n(14093),a=n(91834),s=n(45091),l=n(57830),c=n(35373),u=n(22330),d=n(98483),p=n(48829),h=n(89994),g=n(26532),f=n(90922),m=n(18491),y=n(10947);let v;const C=(e,t,n,a,s=r.y.POST)=>{let c;const u=(0,d.A)();let h,C;e===r.p.Suggestion?(c=E(u),h=S()):e===r.p.UserActivity?(c=A(t,n),h=I(u)):e===r.p.UserPrompts?(c=(0,m.Ce)(s,t,a),h=(0,m.FW)(),C=s===r.y.GET?p.w.getAppName():void 0):e===r.p.Link&&(c=(0,y.lc)(a),h=(0,y.A)());const b={request:c,headers:h,httpMethod:s,type:e,queryId:u,scenario:p.w.getSubstrateScenarioName(),productsFilter:C},P=new o.Xr({parentPath:["Signal",i.G.getTypeName()],items:[{id:l.r.generateId(),body:new i.G(b)}]});return g.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.SubstrateAPIOperationSubmitted},{key:f.h3.ChatEventParameters,value:e},{key:f.h3.UserQueryGuid,value:u}]),v=(new Date).getTime(),P},b=(e,t,n)=>{(0,c.cY)(`${a.x.getTypeName()} response received\n Time Taken: ${(0,u.WU)(v)}s `);const o=e.body,i=o.queryId,l=o.status,d=o.results,p=o.error,h=o.httpStatus,C=o.type,b=g.j.getInstance();if(b.sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.ResponseReceivedFromAL},{key:f.h3.ChatEventParameters,value:a.x.getTypeName()},{key:f.h3.UserQueryGuid,value:i},{key:f.h3.Cv,value:n}]),b.sendTelemetryLatencyData([{key:f.CT.SubstrateAPIResponseTime,value:(0,u.WU)(v)},{key:f.CT.UserQueryGuid,value:i}]),i&&(0,c.cY)("substrateAPIResponseAnnotationProcessor: queryID: ",i),h&&(0,c.cY)("substrateAPIResponseAnnotationProcessor: httpStatus: ",h),d&&(0,c.cY)("substrateAPIResponseAnnotationProcessor: results: ",d),l===s.G.Failed){let e="";return p?((0,c.cY)("substrateAPIResponseAnnotationProcessor: error: ",p),e=p?.code??""):e=h?.toString()??"",void b.sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:`${a.x.getTypeName()}_Error`},{key:f.h3.ChatEventParameters,value:e},{key:f.h3.ChatErrorType,value:f.q0.Server},{key:f.h3.UserQueryGuid,value:i}])}if(l===s.G.Success)if(C===r.p.Suggestion&&d)try{const e=d?JSON.parse(d):{},n=e?.Groups,o=n?.[0]?.Suggestions.map((e=>({...e,LogicalId:i})))??[];o?.length>0&&t(o)}catch(e){return void(0,c.cY)("substrateAPIResponseAnnotationProcessor: failed to parse results")}else C===r.p.UserPrompts&&d?((0,c.cY)("substrateAPIResponseAnnotationProcessor: UserPrompts results"),(0,m.UH)(d,i,t)):C===r.p.Link&&d&&((0,c.cY)("substrateAPIResponseAnnotationProcessor: Link results"),(0,y.At)(d))},E=e=>{const t={EntityRequests:[{EntityType:h.F6,Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:p.w.getAppName()}}]}]},Size:h.Uk}],TimeZone:h.YL,Cvid:e,LogicalId:e,Scenario:{Name:p.w.getSubstrateScenarioName(),Dimensions:[{DimensionName:h.bG,DimensionValue:h.HT}]}};return JSON.stringify(t)},A=(e,t=!1)=>{const n={PromptActivityList:[{PromptId:e,UserActivity:{Favorite:{IsFavorite:t,ActivityDatetimeInUtc:(new Date).toISOString()}}}],PromptActivityListCount:1};return JSON.stringify(n)},S=()=>[{key:h.Ee.XClientLanguage,value:p.w.getLanguage()},{key:h.Ee.XClientFlights,value:h.vu}],I=e=>[{key:h.Ee.ClientRequestId,value:e}]},6609:(e,t,n)=>{n.d(t,{P:()=>h});var o=n(35373),r=n(89994),i=n(75601),a=n(90922),s=n(33500),l=n(4801),c=n(35282),u=n(26731),d=n(55161),p=n(26532);class h{constructor(e,t){this.chatHistoryResponseTimerID=null,this.workflowAnnotationType=u.tP.getTypeName(),this.chatHistoryResponseTimeout=r.A1,this.hasExistingChat=!0,this.telemetryLoggerUtils=p.j.getInstance(),this.chatHistoryResponseTimeoutInternal=()=>{this.chatHistoryResponseTimerID=null,(0,o.cY)("Chat History Augloop Response Timed Out for workflow",this.workflowAnnotationType),c.E.getInstance().clearOperationListForResubmit(),this.setIsChatHistoryLoading(!1),this.hasExistingChat&&this.setIsChatHistoryTimedOut(!0),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:a.a5.ChatHistoryTimeout},{key:a.h3.ChatEventParameters,value:(new Date).getTime().toString()},{key:a.h3.ChatErrorType,value:a.q0.Server}]),this.telemetryLoggerUtils.sendTelemetryErrorData([{key:a.IC.ErrorMessage,value:r.Fz},{key:a.IC.ErrorType,value:a.q0.Server},{key:a.IC.ErrorCode,value:s.O4.ChatHistoryResponseTimeout},{key:a.IC.ErrorCategory,value:l.S2.ChatEvents}]),this.hasExistingChat=!0},this.setIsChatHistoryLoading=e,this.setIsChatHistoryTimedOut=t,this.workflowAnnotationType=this.getChatHistoryWorkflowType(),this.chatHistoryResponseTimeout=this.getChatHistoryResponseTimeout()}static getInstance(e,t){if(!h.sInstance){if((0,i.hX)(e))throw new Error("setIsChatSessionIdSet is null or undefined");h.sInstance=new h(e,t)}return h.sInstance}static resetInstance(){h.sInstance=void 0}setAugloopResponseTimer(){(0,o.cY)("Setting chat history augloop response Timer"),this.clearAugloopResponseTimer(!1),this.setIsChatHistoryLoading(!0),this.setIsChatHistoryTimedOut(!1),this.chatHistoryResponseTimerID=window.setTimeout(this.chatHistoryResponseTimeoutInternal,this.chatHistoryResponseTimeout)}clearAugloopResponseTimer(e=!0){null!==this.chatHistoryResponseTimerID&&((0,o.cY)("Clear chat history augloop response Timer"),clearTimeout(this.chatHistoryResponseTimerID),this.chatHistoryResponseTimerID=null,e&&this.setIsChatHistoryLoading(!1))}get isAugloopResponseTimerSet(){return null!==this.chatHistoryResponseTimerID}setHasExistingChat(e){this.hasExistingChat=e}getChatHistoryWorkflowType(){return d.A.getInstance().isWorkflowRegistered(u.tP.getTypeName())?u.tP.getTypeName():d.A.getInstance().isWorkflowRegistered(u.CT.getTypeName())?u.CT.getTypeName():u.Pd.getTypeName()}getChatHistoryResponseTimeout(){return d.A.getInstance().getWorkflowAugloopTimeoutValue(this.workflowAnnotationType)??r.A1}}},89518:(e,t,n)=>{n.d(t,{cw:()=>m,dS:()=>y});var o=n(90922),r=n(33500),i=n(28087),a=n(19080),s=n(6182),l=n(35373),c=n(59777),u=n(22330),d=n(26532),p=n(89994),h=n(48606),g=n(65593);const f={errorOffensiveInputContent:h.Ej,errorOffensiveOutputContent:h.B5,errorInputBlockedByDynamicGuardList:h.Jh,errorInvalidSignal:h.PN,errorInvalidLanguage:h.Dq,errorUserThrottled:h.GH,errorThrottled:h.GH,errorTimeout:h.GH,errorInputTooLong:h.S8,learnMoreString:h.Y$},m=(e,t)=>{const n=(0,g.kQ)(f);return(i,a,h)=>{const g=d.j.getInstance();(0,l.cY)(`basicChatErrorHandler called with error : ${i} and status : `,a);let f="";if(!(0,l.hX)(i.errorDetailsJson))try{f=JSON.parse(i.errorDetailsJson).code}catch(e){(0,l.cY)("Error parsing error code from basic chat error",e.message)}s.U.getInstance().sendLoggingEventToClient(c.Yk.AugloopErrorReceived,{annotationName:h,timeInMs:(0,u.xJ)(u.qD),chatEventParams:JSON.stringify({errorCategory:i.category,errorCode:f})}),g.sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:`${h}_Error`},{key:o.h3.ChatEventParameters,value:`${i.category}_${f}`},{key:o.h3.ChatErrorType,value:o.q0.Server},{key:o.h3.UserQueryGuid,value:s.U.getInstance().getQueryID()}]),g.sendTelemetryLatencyData([{key:o.CT.ErrorParameter,value:`${i.category}_${f}`},{key:o.CT.ErrorType,value:o.q0.Server}]);const m=i.category;let C=o.ym.Fallback,b=o.G8.BasicChatUnclassifiedError;switch(m){case r.pf.OffensiveContent:switch(b=o.G8.BasicChatRAIFilterBlockedResponse,f){case r.c_.OffensiveInputContent:{C=o.ym.OffensiveInput;const t=n.errorOffensiveInputContent();y(e,t);break}case r.c_.OffensiveOutputContent:C=o.ym.OffensiveOutput,y(e,n.errorOffensiveOutputContent());break;case r.c_.OutputBlockedByDynamicGuardList:C=o.ym.OutputBlocked,y(e,n.errorOffensiveOutputContent());break;case r.c_.InputBlockedByDynamicGuardList:C=o.ym.InputBlocked,y(e,n.errorInputBlockedByDynamicGuardList());break;default:y(e,n.errorInvalidSignal())}break;case r.pf.PromptInjection:if(f===r.c_.Detected)b=o.G8.BasicChatRAIFilterBlockedResponse,C=o.ym.PromptInjection,y(e,n.errorInputBlockedByDynamicGuardList());else y(e,n.errorInvalidSignal());break;case r.pf.InvalidSignal:switch(C=o.ym.InvalidSignal,b=o.G8.BasicChatUnclassifiedError,f){case r.c_.Missing:C=o.ym.SignalMissing,y(e,n.errorInvalidSignal());break;case r.c_.WrongType:C=o.ym.SignalWrongType,y(e,n.errorInvalidSignal());break;default:y(e,n.errorInvalidSignal())}break;case r.pf.InvalidLanguage:switch(C=o.ym.InvalidLanguage,b=o.G8.BasicChatUnsupportedCopilotFunctionality,f){case r.c_.NotSupported:{const t=s.U.getInstance().getBasicChatProps();t?.languageHelpLink?v(e,n.errorInvalidLanguage(),n.learnMoreString(),t.languageHelpLink):y(e,n.errorInvalidLanguage());break}default:y(e,n.errorInvalidSignal())}break;case r.pf.InferenceAPI:switch(f){case r.c_.Timeout:b=o.G8.BasicChatResponseTimedOut,C=o.ym.Timeout,y(e,n.errorTimeout());break;case r.c_.UserThrottled:C=o.ym.UserThrottled,b=o.G8.BasicChatCapacityIssues,y(e,n.errorUserThrottled());break;case r.c_.Throttled:C=o.ym.Throttled,b=o.G8.BasicChatCapacityIssues,y(e,n.errorThrottled());break;case r.c_.ScenarioThrottled:C=o.ym.ScenarioThrottled,b=o.G8.BasicChatCapacityIssues,y(e,n.errorThrottled());break;case r.c_.NotAvailable:y(e,n.errorTimeout());break;case r.c_.InputRaiDependency:y(e,n.errorOffensiveInputContent());break;case r.c_.OutputRaiDependency:y(e,n.errorInvalidSignal());break;case r.c_.BadResponse:C=o.ym.BadResponse,b=o.G8.BasicChatBadResponse,y(e,n.errorInvalidSignal());break;case r.c_.BadRequest:C=o.ym.BadRequest,b=o.G8.BasicChatUnclassifiedError,y(e,n.errorInvalidSignal());break;case r.c_.Unknown:C=o.ym.Unknown,b=o.G8.BasicChatUnclassifiedError,y(e,n.errorInvalidSignal());break;default:y(e,n.errorInvalidSignal())}break;case r.pf.InvalidInput:if(f===r.c_.TooLong)C=o.ym.InputTooLong,b=o.G8.BasicChatInputNotProcessed,y(e,n.errorInputTooLong());else y(e,n.errorInvalidSignal());break;default:y(e,n.errorInvalidSignal())}g.logErrorWithAshaVetoAndError([{key:o.h3.UserQueryGuid,value:s.U.getInstance().getQueryID()}],s.U.getInstance().getFeatureName(),p.u1,b,C),s.U.getInstance().getIsFluxFlowEnabled()||((0,l.cY)("Encountered Error. Stopping loading UI"),t(!1))}},y=(e,t)=>{e.setChatMessageData(i._.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.O.Footer,isFailure:!0,showAnimation:!1,feedbackData:s.U.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:s.U.getInstance().getQueryID(),featureName:s.U.getInstance().getFeatureName()})},!0)},v=(e,t,n,o)=>{e.setChatMessageData(i._.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:t,linkText:{text:n,linkOnClick:C,linkUrl:o}}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.O.Footer,isFailure:!0,showAnimation:!1,feedbackData:s.U.getInstance().getFeedbackData(),telemetryData:JSON.stringify({correlationId:s.U.getInstance().getQueryID(),featureName:s.U.getInstance().getFeatureName()})},!0)},C=async e=>{window.open(e)}},38292:(e,t,n)=>{n.d(t,{A:()=>o});class o{constructor(e){this.copilotCommunicationHandler=e}static getInstance(e){if(void 0===o.instance){if(void 0===e)throw new Error("copilotCommunicationHandler is undefined");o.instance=new o(e)}return o.instance}static resetInstance(){o.instance=void 0}sendLoggingEventToClient(e,t){this.copilotCommunicationHandler.sendLoggingEventToClient(e,t)}}},6182:(e,t,n)=>{n.d(t,{K:()=>P,U:()=>I});var o=n(72277),r=n(28087),i=n(19080),a=n(27982),s=n(31238),l=n(88700),c=n(35373),u=n(78715),d=n(43008),p=n(89994),h=n(90922),g=n(33500),f=n(59777),m=n(26115),y=n(75601),v=n(38292),C=n(26532),b=n(22330),E=n(98483),A=n(57830),S=n(48829);class I{constructor(e,t,n){this.citationPathDataIndexMap=new Map,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.streamChunks=[],this.isAnswerCompleted=!1,this.isBasicChatStreaming=!1,this.queryID="",this.suggestedQnaSignalSubmitTime=0,this.featureName=h.Z_.ChatQnA,this.copyButtonText="",this.copyButtonPopoverText="",this.onClickCitationLink=(e,t=[],n="")=>{(0,c.cY)(`onClickCitationLink called with referenceId : ${e}  ,path`,this.citationPathDataIndexMap.get(e));let o={correlationId:"",featureName:""};try{o=JSON.parse(n)}catch(e){(0,c.cY)("Error parsing telemetry data on citation click",e.message)}this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:h.h3.ChatEventType,value:h.a5.CitationClicked},{key:h.h3.UserQueryGuid,value:o.correlationId||""}]);const r={referencePath:t.length>0?t:this.citationPathDataIndexMap.get(e),workflowAnnotationType:u.Ob.getTypeName()};this.copilotCommunicationHandler.sendEventToClient(f.PV.CitationLinkClicked,r)},this.sendBasicChatSuggestionPillsEvent=e=>{const t={suggestionPills:e,workflowAnnotationType:u.Ob.getTypeName()};this.copilotCommunicationHandler.sendEventToClient(f.PV.BasicChatSuggestionPills,t)},this.getMarkdownReferences=e=>void 0===e||e&&0===e.length||!this.basicChatProps.isCitationsEnabled?[]:(this.citationPathDataIndexMap.clear(),e.map((e=>{this.citationPathDataIndexMap.set(e.contentIndex,e.path),e.content&&e.content.length>150&&(e.content=e.content.substring(0,150).trim()+"...");const t='"'+e.content.slice(0,18).trim()+'..."';return e.content='"'+e.content+'"',{referenceIndex:e.contentIndex,referenceProps:{title:t,primarySubtitle:this.basicChatProps?.citationTitle,snippet:e.content,iconAppName:e.type,referenceType:o._2.Internal,citationPosition:e.position,onClickCitationLink:this.onClickCitationLink,sensitivityLabel:this.basicChatProps?.sensitivityIndicatorData?.badgeText,path:e.path}}}))),this.updateCardWithFooter=()=>{this.chatContainerBuilder.updateLastMessage(r._.MarkdownCard,void 0,{feedbackSectionPosition:i.O.Footer,showAnimation:!0,actionButtonList:[this.getCopyButton()],clpSensitivityIndicatorData:I.getInstance().getBasicChatProps()?.sensitivityIndicatorData??void 0},!0)},this.sendBasicChatProcessingEvent=e=>{this.copilotCommunicationHandler.sendEventToClient(f.PV.BasicChatStatus,e)},this.getRawFeedbackData=(e,t)=>{const n=this.copilotCommunicationHandler.getHostSettings()?.appName;return this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.WT.IsFeedbackAppChatIntegrationEnabled)&&(e=(0,p.rp)(n)),this.chatContainerBuilder.getRawFeedbackData(e,t)},this.getFeedbackData=()=>{let e=this.copilotCommunicationHandler.getFeedbackData();const t=this.featureName;return e&&!e.feedbackArea&&(e=this.getRawFeedbackData(t===h.Z_.Draft?g.jc.DRAFT:g.jc.BASIC_CHAT,e?.contextData)),e},this.handleTimeoutForBasicChatStreaming=()=>{const e=this.getFeatureName();this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:h.h3.ChatEventType,value:h.a5.BasicChatStreamingResponseTimeout},{key:h.h3.UserQueryGuid,value:this.queryID},{key:h.h3.ChatErrorType,value:h.q0.Server}]),this.telemetryLoggerUtils.logErrorWithAshaVetoAndError([{key:h.qN,value:this.queryID}],e,"",h.G8.BasicChatResponseTimedOut,h.ym.Timeout),this.isFirstStreamChunk||(this.paragraphChunks.length>0&&(this.updateCardWithFooter(),this.resetBasicChatStreamingStates(!1)),this.isAnswerCompleted||this.chatContainerBuilder.setChatMessageData(r._.Default,{defaultMessageProps:{user:"chat",messageHeader:{text:p.CY}}},{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:i.O.Footer,isFailure:!0,showAnimation:!1,feedbackData:this.getFeedbackData(),telemetryData:JSON.stringify({correlationId:I.getInstance().getQueryID(),featureName:I.getInstance().getFeatureName()})},!0),this.setIsExecuting(!1)),this.sendBasicChatProcessingEvent({status:f.y2.Finished,workflowAnnotationType:u.Ob.getTypeName(),queryID:this.queryID,isSuccess:!1}),this.resetBasicChatStreamingStates(!1)},this.sendLoggingEventToClient=(e,t)=>{this.loggingEventHandler.sendLoggingEventToClient(e,t)},this.getIsFirstStreamChunk=()=>this.isFirstStreamChunk,this.setIsFirstStreamChunk=e=>{this.isFirstStreamChunk=e},this.getParagraphChunks=()=>this.paragraphChunks,this.setParagraphChunks=e=>{this.paragraphChunks=e},this.getIsAnswerCompleted=()=>this.isAnswerCompleted,this.setIsAnswerCompleted=e=>{this.isAnswerCompleted=e},this.getIsBasicChatStreaming=()=>this.isBasicChatStreaming,this.setIsBasicChatStreaming=e=>{this.isBasicChatStreaming=e},this.setQueryID=e=>{this.queryID=e},this.setFeatureName=e=>{this.featureName=e},this.getFeatureName=()=>this.featureName,this.getQueryID=()=>this.queryID,this.setBasicChatProps=e=>{this.basicChatProps=e},this.getIsFluxFlowEnabled=()=>this.basicChatProps?.isFluxFlowEnabled,this.updateStreamChunks=e=>{this.streamChunks.push(e)},this.getStreamChunks=()=>this.streamChunks,this.getBasicChatProps=()=>this.basicChatProps,this.getSuggestedQnaSignalSubmitTime=()=>this.suggestedQnaSignalSubmitTime,this.setCopyButtonText=e=>{this.copyButtonText=e},this.setCopyButtonPopoverText=e=>{this.copyButtonPopoverText=e},this.getSuggestedQnaScenarioSignalOperation=()=>{const e={isBasicChat:!0,chatHistory:[],isStreaming:!0,queryId:(0,E.A)(),userLanguage:(0,y.Zi)(S.w.getLanguage()),isSuggestedQnAScenario:!0},t=new m.g0({parentPath:["Signal",d.h.getTypeName()],items:[{id:A.r.generateId(),body:new d.h(e)}]});return this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:h.h3.ChatEventType,value:h.a5.BasicChatOperationSubmitted},{key:h.h3.UserQueryGuid,value:e.queryId}]),this.suggestedQnaSignalSubmitTime=(new Date).getTime(),t},this.resetBasicChatStreamingStates=(e=!0,t=!1)=>{this.streamChunks.length>0&&(this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:h.CT.QnAResponseTime,value:(0,b.WU)(b.qD)},{key:h.CT.IsQuerySuccess,value:e},{key:h.CT.QnAChunkInfo,value:JSON.stringify(this.getStreamChunks())},{key:h.CT.UserQueryGuid,value:this.queryID},{key:h.CT.AnnotationType,value:u.Ob.getTypeName()}],t),e&&this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:h.h3.ChatEventType,value:h.a5.QuerySuccessful},{key:h.h3.UserQueryGuid,value:this.queryID},{key:h.h3.ChatEventParameters,value:u.Ob.getTypeName()}])),this.setIsFirstStreamChunk(!0),this.setParagraphChunks(p.u1),this.setIsAnswerCompleted(!1),this.setIsBasicChatStreaming(!1),this.setQueryID(p.u1),this.telemetryLoggerUtils.setUserQueryGuid(p.u1),this.streamChunks=[],this.featureName=h.Z_.ChatQnA},this.chatContainerBuilder=e,this.copilotCommunicationHandler=t,this.setIsExecuting=n,this.loggingEventHandler=v.A.getInstance(),this.telemetryLoggerUtils=C.j.getInstance()}static getInstance(e,t,n){if(!I.instance){if(!e||!n||!t)throw new Error("BasicChat Utils is not initialized");I.instance=new I(e,t,n)}return I.instance}static resetInstance(){I.instance=void 0}getCopyButton(){return{type:a.jA.Default,title:this.copyButtonText,text:(0,s.dD)()?"":this.copyButtonText,iconRegular:(0,s.dD)()?l.c2D:l.Jg_,popoverProps:{popoverTitle:this.copyButtonPopoverText},position:(0,s.dD)()?a.SC.FeedbackSection:a.SC.ActionButtonBar,handleButtonOnClick:y.Dd}}getChatMessageHeaderData(e){if(this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(g.WT.EnablePersonalizationIndicatorHeader)&&!(0,y.hX)(e))return{titleText:e?.title??"",popoverText:e?.expandedTitle??void 0}}}const P=(e,t)=>{const n=I.getInstance();return n?.getRawFeedbackData(e,t)}},50393:(e,t,n)=>{n.d(t,{$s:()=>r,Rx:()=>i,Tw:()=>u,Xf:()=>h,cy:()=>c,dX:()=>p,ei:()=>l});let o;const r=e=>{o=e},i=()=>o;let a,s;const l=e=>{if(!a&&e?.sydneyEndpoint&&(a=e?.sydneyEndpoint),e?.chatResponse?.messages){const t=e.chatResponse?.messages?.find((e=>e.locale));t?.locale&&(s=t?.locale)}},c=()=>a??"https://substrate.office.com/m365chat/SecuredChatHub",u=()=>s??"en-us";let d;const p=e=>{d=e},h=()=>d},13552:(e,t,n)=>{n.d(t,{AK:()=>A,Al:()=>b,CL:()=>k,OD:()=>w,Su:()=>x,T:()=>E,Vq:()=>P,dh:()=>I});var o=n(28087),r=n(19080),i=n(50857),a=n(98483),s=n(59777),l=n(35373),c=n(75601),u=n(57743),d=n(33500),p=n(90922),h=n(74873),g=n.n(h),f=n(50393),m=n(38292),y=n(26532);let v,C;function b(e,t,n,o){if(e.isFeatureGateEnabledFromClient(d.WT.SkipHydrateEnabled))return void(0,l.cY)("hydrateMessages: Skipping hydrating chat pane with history messages");(0,l.cY)(`hydrateMessages: Hydrating ${t.length} messages`);const r=A(e,t,o);n((t=>E(e,t,r)))}function E(e,t,n){const o=[...t,...n];if(!e.isFeatureGateEnabledFromClient(d.WT.HydratedMessagesSquashingEnabled))return o;const r=function(e,t=e=>e.messageId){const n=new Map,o=new Map,r=e.map((e=>[e,t(e)]));r.forEach((([e,t],r)=>{void 0!==t&&(o.set(t,e),n.has(t)||n.set(t,r))}));const i=[];return r.forEach((([e,t],r)=>{void 0===t?i.push(e):r===n.get(t)&&i.push(o.get(t))})),i}(o);if((0,l.cY)(`hydrateMessages: Squashing reduced ${o.length} messages to ${r.length}`),e.isFeatureGateEnabledFromClient(d.WT.IsApplyClpFromHydratedMessagedEnabled)&&r&&r.length>0){const t={messagesClpLabels:[...new Set(r.map((e=>e.clpSensitivityIndicatorData?.labelId)).filter(Boolean))],workflowAnnotationType:"UpdateChatClpFromChatHistory"};e.sendEventToClient(s.PV.UpdateChatClpFromChatHistory,t)}return r}function A(e,t,n){const o=[];for(const r of t.slice().reverse()){const t=S(e,r,n);t&&o.push(t)}return o}function S(e,t,n){return t.richTextJson?function(e,t,n,r){let i;(0,l.cY)("parsing rich text and display message");try{i=JSON.parse(t)}catch(e){return void(0,l.cY)("error parsing rich text from chat history",e.message)}if(i=function(e,t,n,r){let i="";try{const e=JSON.parse(t.telemetryData);e&&e.correlationId&&(i=e.correlationId)}catch(e){(0,l.cY)("Error parsing telemetry data from chat history",e),i=""}const a=y.j.getInstance(),c=t?.messageAttributionProps?.id;c&&a.sendTelemetryChatEventData([{key:p.h3.UserQueryGuid,value:i},{key:p.h3.ChatEventType,value:p.a5.MessageHydrationCopilotId},{key:p.h3.ChatEventParameters,value:c}]);switch(t.messageType){case o._.ChatCardWrapper:if(!t.body.renderData)return void(0,l.cY)("No render data found for ChatCardWrapper");if(r?.isCustomHandlingForChatHistoryEnabled&&t.chatHydrationKeys&&t.chatHydrationKeys.imagesKey&&n){const o=t.body.renderData,r=t.chatHydrationKeys.imagesKey;if(o.props){o.props[r]=n;const t={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({imagesPresentInChatHistoryForRehydration:n.length>0})};m.A.getInstance(e).sendLoggingEventToClient(s.Yk.ImagesFromChatHistoryRehydrated,t),a.sendTelemetryChatEventData([{key:p.h3.UserQueryGuid,value:i},{key:p.h3.ChatEventType,value:p.a5.ImagesFromChatHistoryRehydrated},{key:p.h3.ChatEventParameters,value:JSON.stringify({timestamp:(new Date).getTime(),imagesPresentInChatHistoryForRehydration:n.length>0})}])}t={...t,body:{...t.body,renderData:o}}}return t;case o._.SketchImageCard:if(n&&t.body.sketchImageData&&t.body.sketchImageData.length===n.length){const e=t.body.sketchImageData.map(((e,t)=>({...e,imageSrc:n[t]})));t={...t,body:{...t.body,sketchImageData:e}}}return t;case o._.ContentCard:return void(0,l.cY)("ContentCard message type not supported for hydration");default:return t}}(e,i,n,r),!i)return;i.showAnimation=!1,i.shouldShowProgressSpinner=!1,i.clpSensitivityIndicatorData&&(i={...i,clpSensitivityIndicatorData:{...i.clpSensitivityIndicatorData,icon:void 0}});if(!(0,c.hX)(i)&&i.body)return i;return}(e,t.richTextJson,t.images,n):t.content?function({format:e,userRole:t,content:n}){let a;if(e===i.Go.PlainText){const e=t===i.gG.User;a={messageType:o._.Default,body:{user:e?"human":"chat",messageHeader:{text:n}},shouldShowAIGeneratedIndicator:!e,showAnimation:!e,feedbackSectionPosition:e?r.O.None:r.O.Footer,shouldShowProgressSpinner:!1}}else a={messageType:o._.MarkdownCard,body:{user:"chat",message:n},shouldShowAIGeneratedIndicator:!0,shouldShowProgressSpinner:!1,showAnimation:!0,feedbackSectionPosition:r.O.Footer};if(!(0,c.hX)(a)&&a.body)return a;return}(t):void 0}function I(e,t,n,r,a,s,l,c){const d=T(e,t,n,r,a,s);e.messageType===o._.ChatCardWrapper&&(v=d,C=e.messageId);const p={gptId:c};(0,u.a_)(i.S5.AddMessageOperation,d,void 0,void 0,void 0,void 0,s?.isPluginStatePersist?l:void 0,p)}function P(e,t){if(v){(0,l.cY)(`resendCopilotMessage got key ${e}, and found a message with key ${C}`);const n=t(v);n&&(0,u.a_)(i.S5.AddMessageOperation,n)}}function T(e,t,n,o,r,a){const{chatMessageForRichText:s,images:c}=x(e,a);let u="";try{u=JSON.stringify(s)}catch(e){(0,l.cY)("error while stringify chat card props error:",e.message)}const d=n?i.gG.User:o?i.gG.System:i.gG.Copilot;return w(t,i.CY.Pane,d,i.Go.RichText,o?i.nW.Failure:i.nW.Success,u,c,r)}const x=(e,t)=>{let n,r;switch(r=e.actionBarButtons?{...e,actionBarButtons:void 0}:e.warningActionButtons?{...e,warningActionButtons:void 0}:{...e},r.outputV2Props&&(r={...r,outputV2Props:void 0,shouldShowCopyButton:!1,shouldShowHandoffButton:!1,shouldShowReadAloudButton:!1}),e.messageType){case o._.ChatCardWrapper:{const{body:e,chatHydrationKeys:o}=r;if(e.renderData&&e.element&&(r={...r,body:{...e,element:void 0}}),!t?.isCustomHandlingForChatHistoryEnabled&&e.renderData?.props.base64ImageData&&(n=e.renderData?.props.base64ImageData),t?.isCustomHandlingForChatHistoryEnabled&&o&&o.imagesKey){const t=o.imagesKey;e.renderData?.props?(n=e.renderData.props[t],r={...r,body:{...e,renderData:{...e.renderData,props:{...e.renderData.props}}}},r.body.renderData.props[t]=void 0):r={...r,body:e}}}break;case o._.SketchImageCard:{const{body:o}=e;if(o.sketchImageData&&o.sketchImageData.length>0){n=o.sketchImageData.map((e=>t?.isSketchImageResizeEnabled&&e.resizedImageForChatHistory?e.resizedImageForChatHistory:e.imageSrc));const e={...o,sketchImageData:o.sketchImageData.map((e=>({...e,imageSrc:void 0})))};r={...r,body:e}}}}return{chatMessageForRichText:r,images:n}};function w(e,t,n,o,r,s,l,c,u,d){const p={content:e,images:l,entry:t,userRole:n,format:o,timestamp:Date.now(),messageId:(0,a.A)(),status:r,richTextJson:s,messageMetadata:c,userId:u,rephrasedMessage:d};return n==i.gG.User&&(0,f.dX)(p.messageId),p}function k(e,t){let n="";switch(t){case o._.Default:n=function(e){let t="";e?.messageHeader&&(t=t+_(e.messageHeader)+"\n");if(e?.embeddedLists)for(const n of e.embeddedLists){if(n.listHeader&&(t=t+n.listHeader+"\n"),n.listItems)for(const e of n.listItems)t+=e.title?`${e.title}: ${e.text+"\n"}`:""+(e.text+"\n");n.listFooter&&(t=t+_(n.listFooter)+"\n")}e?.messageFooter&&(t+=_(e.messageFooter));return t}(e.defaultMessageProps);break;case o._.MarkdownCard:n=e.markDownCardProps?.message??"";break;case o._.WarningMessage:n=e.warningMessageCardProps?.warningPrefix+(e.warningMessageCardProps?.warningEmphasizedText??"")+(e.warningMessageCardProps?.warningSuffix??"");break;case o._.ChatCardWrapper:n=e.chatCardWrapperProps.textContent??"";break;case o._.StreamingAdaptiveCard:n=function(e){if(!e)return"";const{basin:t,uniqueId:n,accessPath:o}=e;if(t?.items&&n&&o){const t=g()(e.basin.items[e.uniqueId],e.accessPath);return t?.body?t.body.map((e=>e.text)).join("\n"):""}}(e.streamingAdaptiveCardProps);break;case o._.SketchImageCard:n=e.sketchImageMessageProps?.messageText??"";case o._.ContentCard:case o._.AccordionCard:case o._.ProactiveSuggestionCard:case o._.SlideLinksCard:case o._.SelfHelpAdaptiveCard:}return n}function _(e){let t="";return e?.text&&(t+=e.text),e?.linkText&&(t=t+e.linkText.text+(e.linkText.linkSuffix??"")),t}},66503:(e,t,n)=>{n.d(t,{$w:()=>i,Q:()=>l,YA:()=>s,xH:()=>a});let o,r=n(89994).u1;const i=e=>{r=e,e||(o=void 0)},a=()=>r,s=e=>{o=e},l=()=>o},95113:(e,t,n)=>{n.d(t,{w:()=>c});var o=n(75601),r=n(22330);let i;class a{constructor(e){this.value=e,this.nextChild=0}getNext(){return new a(`${this.value}.${++this.nextChild}`)}toString(){return`${this.value}.${this.nextChild}`}}var s=n(35373),l=n(89994);class c{constructor(){this.currentCvQueryGuid=r.dB,this.cvBase=function(){if(!i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=22,n=[];for(let o=0;o<t;o++)n.push(e.charAt(Math.floor(Math.random()*e.length)));i=new a(n.join(""))}return i}(),this.currentCvQueryGuid=r.dB,this.queryCv=this.cvBase.getNext(),this.alSessionKey=l.u1,this.authMessageStatus=l.u1}static getInstance(){return(0,o.hX)(c.instance)&&(c.instance=new c),c.instance}resetCvData(){(0,s.cY)("Reset Cv data to generate next cv for new query"),this.currentCvQueryGuid=r.dB,this.queryCv=this.cvBase.getNext()}getBaseCv(){return this.cvBase}setAlSessionKey(e){this.alSessionKey=e}getAlSessionKey(){return this.alSessionKey}setAuthMessageStatus(e){this.authMessageStatus=e}getAuthMessageStatus(){return this.authMessageStatus}getQueryCv(){return this.currentCvQueryGuid==r.dB?this.queryCv.getNext():this.resetCvData(),(0,s.cY)(`cvBase: ${this.cvBase?.toString()}, queryCv: ${this.queryCv?.toString()}, userQueryGuid: ${r.dB}`),this.queryCv?.toString()}}},1382:(e,t,n)=>{n.d(t,{DM:()=>b,P1:()=>C,PZ:()=>f,RJ:()=>I,UJ:()=>v,ZQ:()=>y,g8:()=>m,gE:()=>S,hU:()=>E,uX:()=>P});var o=n(27908),r=n(35373),i=n(50857),a=n(26532),s=n(33500),l=n(90922);let c=o.$.CurrentContext.toString(),u=!1,d=!1,p=!1,h=!1,g=!1;const f=e=>{c=e},m=(e,t)=>{h=e,g=t;let n=o.$.CurrentContext.toString();h&&(n+="+Work"),g&&(n+="+Web"),c=n},y=()=>c,v=e=>{u=e},C=e=>{p=e},b=()=>{if(u){const e=c===o.$.Work?i.z1.Enterprise:i.z1.Document;return(0,r.cY)("Orchestrator grounding mode used for Chat:",e),e}},E=(e,t)=>{S(`${A(e.id)}:${t}`)},A=e=>{switch(e){case s.un.ENTERPRISE_SEARCH:return o.$.Work;case s.un.WEB_SEARCH:return o.$.Web;default:return e}},S=e=>{a.j.getInstance().sendTelemetryChatEventData([{key:l.h3.ChatEventType,value:l.a5.GroundingSourceUpdated},{key:l.h3.ChatEventParameters,value:e}])},I=e=>{d||(a.j.getInstance().sendTelemetryChatEventData([{key:l.h3.ChatEventType,value:e?l.a5.PluginStateAtWarmup:l.a5.PluginStateAtInput},{key:l.h3.ChatEventParameters,value:p}]),d=!0)},P=e=>{if(!e||0===e.length)return void a.j.getInstance().sendTelemetryChatEventData([{key:l.h3.ChatEventType,value:l.a5.CopilotBrokeringWFFailure}]);const t=e.map((e=>new Object({id:e.id,state:e.state})));a.j.getInstance().sendTelemetryChatEventData([{key:l.h3.ChatEventType,value:l.a5.EnabledPluginsInfoFetched},{key:l.h3.ChatEventParameters,value:JSON.stringify(t)}])}},10947:(e,t,n)=>{n.d(t,{A:()=>c,At:()=>u,W6:()=>s,lc:()=>l});var o=n(48829),r=n(89994),i=n(35373);const a={},s=(e,t)=>{a[e]=t},l=e=>{const t={Prompt:{PromptId:e?.PromptId??"",Title:e?.Title??"",CommandText:e?.CommandText??"",Origin:r.c_,Products:[o.w.getAppName()],DisplayCategory:r.Gu,HydratedEntities:e?.HydratedEntities??[]}};return JSON.stringify(t)},c=()=>[{key:r.Ee.XClientFlights,value:r.j5}],u=(e,t="")=>{try{const n=a[t];if(!n)return void(0,i.cY)("handleLinkResponse: Unknown queryID");const s=JSON.parse(e??"");(0,i.cY)("handleLinkResponse: resultsObj",s);const l=s?.PromptEncodedLink;if(!l)return void(0,i.cY)("handleLinkResponse: LinkText not found");const c=r.cY,u=o.w.getAppName(),d=`${c}/prompts/link?product=${u}&linkText=${l}&OCID=${r.YF.WXPO_CopyLink}`;navigator.clipboard.writeText(d),(0,i.cY)("handleLinkResponse: share prompt link is on the clipboard",d),n.onShareSuccess(),(e=>{a[e]&&delete a[e]})(t)}catch(e){return void(0,i.cY)("handleLinkResponse: failed to parse results")}}},18491:(e,t,n)=>{n.d(t,{Ce:()=>h,FW:()=>g,L:()=>u,UH:()=>f,bn:()=>d});var o=n(18036),r=n(48829),i=n(89994),a=n(35373),s=n(72097);let l={},c=!1;const u=(e,t)=>{l[e]=t},d=()=>c,p=e=>{c=e},h=(e,t,n)=>{let a;return e===o.y.GET?"":(a=e===o.y.DELETE?{PromptId:t??""}:{Prompt:{Title:n?.Title??"",CommandText:n?.CommandText??"",Origin:i.c_,Products:[r.w.getAppName()],DisplayCategory:i.Gu,HydratedEntities:n?.HydratedEntities??[]}},JSON.stringify(a))},g=()=>[{key:i.Ee.XClientFlights,value:i.U_}],f=(e,t="",n)=>{try{const r=JSON.parse(e??""),i=r?.PromptList;if(i?.length>0)n(i,o.p.UserPrompts,o.y.GET),p(!1);else{const e=r?.PromptId;if(t&&l[t]){const{httpMethod:r,promptData:i,onSaveSuccess:a}=l[t];r===o.y.DELETE?(i&&(i.promptId="",i.isPromptSaved=!1),(0,s.aM)(e,!0),n([],o.p.UserPrompts,o.y.DELETE,e)):r===o.y.POST&&(i&&(i.promptId=e,i.isPromptSaved=!0,a&&a()),(0,s.aM)(e,!1),p(!0)),(e=>{l[e]&&delete l[e]})(t)}(0,a.cY)("substrateAPIResponseAnnotationProcessor: PromptId",e)}}catch(e){return void(0,a.cY)("substrateAPIResponseAnnotationProcessor: failed to parse results")}}},90326:(e,t,n)=>{n.d(t,{N:()=>i});const o=22;function r(){return"object"==typeof window&&window.crypto&&function(){const e=new Uint8Array(o);window.crypto.getRandomValues(e);const t=new Array(o);for(let n=0;n<o;n++)t[n]=e[n]/256;return t}()||function(){const e=new Array(o);for(let t=0;t<o;t++)e[t]=Math.random();return e}()}function i(){const e=r(),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[];for(let r=0;r<o;r++)n.push(t.charAt(Math.floor(64*e[r])));return n.join("")}},7556:(e,t,n)=>{n.d(t,{h:()=>I});var o,r=n(66782);!function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(o||(o={}));var i=n(41519),a=n(19080),s=n(78126),l=n(82794),c=n(86122),u=n(94671),d=n(88027);const p="AppChatCopilot",h=e=>{switch(e){case r.CS.IFrameWithinCallOut:case r.CS.IFrameWithinModal:case r.CS.IFrameWithinSidePane:return r.CS.IFrameWithinCallOut;default:return r.CS.CallOut}},g=e=>{const t="inapp-feedback-element-id";let n;return e&&(n=document.getElementById(e)),n||(n=document.getElementById(t)),n||(n=document.createElement("div"),n.id=t,document.body.appendChild(n)),n},f=(e,t,n)=>{if(e)return e;let o=`${t}Web`;switch(n){case"PC":o=`${t}Win32`;break;case"MAC":o=`${t}Mac`;break;case"IOS":o=`${t}iOS`}return o};var m=n(6182),y=n(35373),v=n(59777),C=n(33500),b=n(48829),E=n(57120),A=n(50393),S=n(36130);class I{isFeatureGateEnabledFromClient(e){return(0,y.cY)("Feature gate: ",e),!1}getNumberFeatureGateValueFromClient(e){return(0,y.cY)("Feature gate: ",e),NaN}sendLoggingEventToClient(e,t){(0,y.cY)("sendLoggingEventToClient: ",e),(0,y.cY)("loggingEventArgs: ",t)}updateCopilotState(e){(0,y.cY)("updateCopilotState: "+e)}feedbackButtonClicked(e,t,n,S,I){const P=b.w.getFeedbackSettings(),T=m.U.getInstance().getIsFluxFlowEnabled(),x=I&&document.getElementById(I)?.innerText?document.getElementById(I).innerText:void 0;(0,A.$s)(t),P&&P.feedbackInitOptions?.appId&&(async({appData:e,featureAreaName:t="Copilot",inAppFeedbackRef:n,specificHvcVersion:m,majorVersion:y,feedbackInitOptions:v,ocvFeedbackHost:C,platform:b,appEnvironment:E=o.DEV,language:A="en",feedbackType:S,feedbackData:I,buttonTarget:P,isSydneyEnabled:T,aiResponseMessage:x,lightTheme:w,darkTheme:k,createAndSubmitFeedbackDataUploadSignal:_})=>{const D=(0,s.A)();v={...v,authenticationType:v?.authenticationType??r.sO.Unauthenticated,clientFeedbackId:D,clientName:C};const F=(0,d.$x)()===i.G.defaultWhite;w&&k?v.themeOptions=F?w:k:v.themeOptions||(v.themeOptions=w??{baseTheme:F?"WindowsLight":"WindowsDark",v9Theme:F?l.o:c.C}),void 0!==v.isProduction&&null!==v.isProduction||(v.isProduction=E===o.PRODUCTION),v.telemetry={...v.telemetry,featureArea:I?.feedbackArea??t,sourceContext:T?"CopilotChatFeedback":v.telemetry?.sourceContext,featureName:I?.contextData?.featureName,subFeatureName:I?.contextData?.subFeatureName,entryPoint:I?.contextData?.entryPoint,integrationSource:I?.contextData?.integrationSource};const L=I?.contextData?.feedbackCategory===a.E.Error?r.wd.AIError:S==r.MW.Smile?r.wd.AIThumbsUp:r.wd.AIThumbsDown;v.feedbackConfig={...v.feedbackConfig,appData:v.feedbackConfig?.appData??JSON.stringify(e),calloutTarget:P,featureAreas:void 0,feedbackForumUrl:void 0,feedbackUiType:h(v.feedbackConfig?.feedbackUiType),initialFeedbackType:S,isDisplayed:!0,isFeedbackForumEnabled:void 0,isFileUploadEnabled:void 0,isMyFeedbackEnabled:void 0,isThankYouPageDisabled:!0,maxHeight:600,maxWidth:320,minHeight:void 0,minWidth:void 0,myFeedbackUrl:void 0,privacyUrl:void 0,retentionDurationDays:void 0,scenarioConfig:{isScenarioEnabled:!0,scenarioType:L},supportUrl:void 0,width:void 0,msInternalTitleTarget:void 0},v.userData={...v.userData,aiPrompt:I?.contextData?.feedbackContextData?.prompt,aiPromptId:I?.contextData?.feedbackContextData?.promptId,aiErrorType:I?.contextData?.feedbackContextData?.errorType,aiInteractionId:I?.contextData?.feedbackContextData?.interactionId,aiResponseMessage:I?.contextData?.feedbackContextData?.errorMessage??x},v.feedbackConfig.diagnosticsConfig={...v.feedbackConfig.diagnosticsConfig,diagnosticsEndPoint:"ODS",diagnosticsUploadId:D,waitForDiagnosticsUpload:void 0,isShareContextDataEnabled:!0,getContextData:v.feedbackConfig.diagnosticsConfig?.getContextData??(async()=>{const e=new File([I?.contextData?.cardMetaData],"contextData.json",{type:"text/json"});return new Promise((t=>{t([e])}))})},!v.feedbackConfig?.tenantFeedbackServiceOptions?.useTenantFeedbackService&&_&&(v.feedbackConfig.diagnosticsConfig={...v.feedbackConfig.diagnosticsConfig,extractFeedbackDataForHost:e=>{_(JSON.stringify(e),f(I?.contextData?.feedbackClientAppName,C,b))},isHostManagedContextDataEnabled:!0,isRetrieveFormDataEnabled:!0}),v.performanceTimestamps={invocationTimestamp:I?.invocationTimestamp,integrationInitTimestamp:Date.now()},v.feedbackConfig.feedbackUiType===r.CS.IFrameWithinCallOut?(0,u.dg)({hostName:p,locale:A,inAppFeedbackRef:g(n),majorVersion:y,returnElementRef:P},v):await(0,r.LR)({hostName:p,locale:A,inAppFeedbackRef:g(n),specificHvcVersion:m,majorVersion:y},v)})({...P,feedbackData:t,ocvFeedbackHost:b.w.getAppName(),platform:b.w.getAppPlatform(),language:b.w.getLanguage(),appEnvironment:b.w.getEnvironment(),feedbackType:e==v.Gb.LIKE?r.MW.Smile:r.MW.Frown,appData:n??P.appData,buttonTarget:S,isSydneyEnabled:T,aiResponseMessage:this.isFeatureGateEnabledFromClient(C.WT.ExtractContentFromCardForFeedback)?x:void 0,createAndSubmitFeedbackDataUploadSignal:this.isFeatureGateEnabledFromClient(C.WT.EnableSendTenantFeedback)?E.W:void 0}),(0,y.cY)("feedbackButtonClicked: "+e),(0,y.cY)("feedbackData: "+t),(0,y.cY)("telemetryData: "+n)}async copyButtonClicked(e,t,n){(0,y.cY)("Copy button clicked"),(0,S.Cu)(e),(0,y.cY)("messageContentElementId: "+e),(0,y.cY)("chatCardIndex: "+t),(0,y.cY)("telemetryData: "+n)}getALSession(){throw new Error("Method not implemented.")}getHostSettings(){throw new Error("Method not implemented.")}getAuthToken(){throw new Error("Method not implemented.")}getPythonMode(){return!1}async shouldIgnoreResponse(e){return!1}async shouldSendRequestToAugloop(e,t,n,o){return(0,y.cY)("shouldSendRequestToAugloop"),!0}getFeedbackData(){return{}}getOnClickHandler(e){return()=>{}}getCanvasSelection(){return Promise.resolve({})}getPreloadSignal(e){}}},48829:(e,t,n)=>{n.d(t,{w:()=>i});var o=n(89994),r=n(59777);class i{constructor(e){i.appName=e.appName,i.augloopUrl=e.augloopUrl??o.a6,i.devBuild=e.devBuild??!1,i.environment=e.environment,i.sessionId=e.sessionId,i.workflow=e.workflow??r.g$.ACTION_AI,i.appVersion=e.appVersion??"",i.appInternalName=e.appInternalName??"",i.appPlatform=e.appPlatform??"",i.augloopFlights=e.augloopFlights??"",i.language=e.language??"en-US",i.substrateScenarioName=e.substrateScenarioName??"",i.feedbackSettings=e.feedbackSettings,i.releaseAudienceGroup=e.releaseAudienceGroup??"",i.releaseChannel=e.releaseChannel??"",i.releaseFork=e.releaseFork??""}static getAppName(){return i.appName}static getAugloopUrl(){return i.augloopUrl}static isDevbuild(){return i.devBuild}static getEnvironment(){return i.environment}static getSessionId(){return i.sessionId}static getWorkflowType(){return i.workflow}static getAppVersion(){return i.appVersion}static getAppInternalName(){return i.appInternalName}static getAppPlatform(){return i.appPlatform}static getAugloopFlights(){return i.augloopFlights}static getLanguage(){return i.language}static getSubstrateScenarioName(){return i.substrateScenarioName}static getFeedbackSettings(){return i.feedbackSettings}static getReleaseAudienceGroup(){return i.releaseAudienceGroup}static getReleaseChannel(){return i.releaseChannel}static getReleaseFork(){return i.releaseFork}}},6394:(e,t,n)=>{n.d(t,{c:()=>o});class o{static get chatSessionId(){return this._chatSessionId??this._chatHistorySessionStorageService?.getChatSessionId()??null}static set chatSessionId(e){this._chatSessionId=e,this._chatHistorySessionStorageService?.setChatSessionId(e??null)}static get currentChatId(){return this._currentChatId??this._chatHistorySessionStorageService?.getCurrentChatId()??null}static set currentChatId(e){this._currentChatId=e,this._chatHistorySessionStorageService?.setCurrentChatId(e??null)}static set sessionStorageService(e){this._chatHistorySessionStorageService=e}}o._chatSessionId=null,o._currentChatId=null,o._chatHistorySessionStorageService=void 0},19796:(e,t,n)=>{n.d(t,{n:()=>a});var o=n(90922),r=n(26532),i=n(35373);class a{constructor(e){this.sessionKey=e,this.storage=sessionStorage,this.isError=!1,this.sessionKey?this.validateSessionStorageObject():(this.isError=!0,this.clearSessionStorageObject(!0))}validateSessionStorageObject(){const e=this.getSessionStorageObject();e?.sessionKey!==this.sessionKey?this.clearSessionStorageObject(!1):this.isError=e?.isError??!1}static getInstance(e){try{a.instance||(a.instance=new a(e))}catch(e){r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotChatHistorySessionStorageCreateInstanceFailed}]),(0,i.cY)("Error creating sessionStorage instance"),a.instance&&(a.instance.isError=!0)}return a.instance}getSessionStorageObject(){const e=this.storage?.getItem(a.SESSION_STORAGE_KEY);return e?JSON.parse(e):void 0}getSkeletonChatSessionStorageObject(e){return{sessionKey:this.sessionKey,chatMessages:[],enabledPlugins:[],chatSessionId:null,currentChatId:null,isError:e}}clearSessionStorageObject(e){this.isError=e;try{this.storage?.setItem(a.SESSION_STORAGE_KEY,JSON.stringify(this.getSkeletonChatSessionStorageObject(e)))}catch(e){(0,i.cY)("Clear session storage failed")}}setSessionStorageObject(e){this.storage?.setItem(a.SESSION_STORAGE_KEY,JSON.stringify(e))}getChatMessages(){if(this.isError)return[];try{const e=this.getSessionStorageObject(),t=e?.chatMessages.map((e=>{const{actionBarButtons:t,...n}=e;return n}));return t??[]}catch(e){return this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageGetFailed}]),(0,i.cY)("Error getting session storage object"),[]}}getEnabledPlugins(){if(this.isError)return[];try{const e=this.getSessionStorageObject();return e?.enabledPlugins??[]}catch(e){return this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageGetFailed}]),(0,i.cY)("Error getting session storage object"),[]}}getCurrentChatId(){if(this.isError)return null;try{const e=this.getSessionStorageObject();return e?.currentChatId??null}catch(e){return this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageGetFailed}]),(0,i.cY)("Error getting session storage object"),null}}getChatSessionId(){if(this.isError)return null;try{const e=this.getSessionStorageObject();return e?.chatSessionId??null}catch(e){return this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageGetFailed}]),(0,i.cY)("Error getting session storage object"),null}}setChatMessagesAndPlugins(e,t){if(!this.isError&&this.sessionKey)try{const n={...this.getSessionStorageObject(),sessionKey:this.sessionKey,enabledPlugins:t,chatMessages:e};this.setSessionStorageObject(n)}catch(e){this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageSetFailed}]),(0,i.cY)("Error setting session storage object")}}setChatSessionId(e){if(!this.isError&&this.sessionKey)try{const t={...this.getSessionStorageObject(),chatSessionId:e};this.setSessionStorageObject(t)}catch(e){this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageSetFailed}]),(0,i.cY)("Error setting session storage object")}}setCurrentChatId(e){if(!this.isError&&this.sessionKey)try{const t={...this.getSessionStorageObject(),currentChatId:e};this.setSessionStorageObject(t)}catch(e){this.clearSessionStorageObject(!0),r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotSessionStorageSetFailed}]),(0,i.cY)("Error setting session storage object")}}isInErrorState(){return this.isError}}a.SESSION_STORAGE_KEY="CopilotSessionStorageObject"},51311:(e,t,n)=>{n.d(t,{g:()=>i});var o=n(90922),r=n(26532);class i{constructor(e){const t=this.get();t?t?.appSessionId&&e?t?.appSessionId!==e&&this.set({appSessionId:e,hasPaneOpenedInCurrentAppSession:!1}):this.set({appSessionId:e,hasPaneOpenedInCurrentAppSession:null}):this.set({appSessionId:e,hasPaneOpenedInCurrentAppSession:!1})}static createInstance(e){try{i.instance&&e===i.instance.get()?.appSessionId||(i.instance=new i(e))}catch(e){r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotLocalStorageCreateInstanceFailed}])}return i.instance}static getInstance(){return i.instance}get(){try{const e=localStorage?.getItem(i.LOCAL_STORAGE_KEY);return e?JSON.parse(e):void 0}catch(e){return void r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotLocalStorageGetFailed}])}}set(e){try{localStorage?.setItem(i.LOCAL_STORAGE_KEY,JSON.stringify(e))}catch(e){r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotLocalStorageSetFailed}])}}setProperties(e){try{const t=this.get();this.set({...t,...e})}catch(e){r.j.getInstance().sendTelemetryChatEventData([{key:o.h3.ChatEventType,value:o.a5.CopilotLocalStorageSetPropertiesFailed}])}}}i.LOCAL_STORAGE_KEY="CopilotLocalStorageObject"},99429:(e,t,n)=>{n.d(t,{k:()=>o});class o{constructor(){o.queryAgentIdMap=new Map}static getInstance(){return o.instance||(o.instance=new o),o.instance}static resetInstance(){o.instance=void 0}addQueryIdToMap(e,t){t&&o.queryAgentIdMap.set(e,t)}getAgentIdForQueryId(e){return o.queryAgentIdMap.get(e)}removeQueryIdFromMap(e){o.queryAgentIdMap.delete(e)}}},93914:(e,t,n)=>{n.d(t,{R:()=>o});class o{openUrlInEmbeddedBrowser(e,t){const n=window.open("about:blank","appAuthWindow",t);return n.location.href=e.href,n}openUrlInExternalBrowser(e){window.open("about:blank").location.href=e.href}}},46961:(e,t,n)=>{n.d(t,{E:()=>l});var o=n(90922),r=n(35373);let i=null,a=null,s={};class l{static getInstance(){return l.telemetryEventHandler||(l.telemetryEventHandler=new l),l.telemetryEventHandler}initTelemetryLatencyObject(){i=(0,r.xI)()}initTelemetryChatEventObject(){a=(0,r.uA)()}updateTelemetryLatencyData(e,t){null!=i&&(Object.keys(e).forEach((t=>{i[t]=e[t],s[t]=e[t]})),t&&this.sendTelemetryLatencyData(t))}updateTelemetryChatEventData(e,t){null===a&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((t=>{a[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)}updateTelemetryQueryDetailsEventData(e){Object.keys(e).forEach((t=>{s[t]=e[t]}))}sendTelemetryLatencyData(e){null!=e&&(e.logEvent((0,r.kX)(i)),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e))}sendTelemetryQueryDetailsObject(e){e?.logEvent((0,r.cx)(s)),s={}}sendTelemetryChatEventData(e){if(null!=e){if(e.logEvent((0,r._W)(a)),a[o.h3.ChatEventType]){const e=Object.keys(o.a5)[Object.values(o.a5).indexOf(a[o.h3.ChatEventType])];s[e]=0===a[o.h3.ChatEventParameters].length?"true":a[o.h3.ChatEventParameters]}this.initTelemetryChatEventObject()}}}},68629:(e,t,n)=>{n.d(t,{M:()=>r,o:()=>i});var o=n(35373);class r{}class i{LogTelemetryEvent(e){(0,o.cY)("LogTelemetryEvent: EventName: "+e.GetEventName()+"\n EventType: "+e.GetEventType()+"\n EventLogs: ",e.GetLogs())}}},26532:(e,t,n)=>{n.d(t,{j:()=>h});var o=n(130),r=n(53357),i=n(22330),a=n(90922),s=n(4801),l=n(35373),c=n(68629);class u{constructor(e,t,n,o,r,i,a,l,c,u){this.logs=n,this.isRequired=l||!1,this.shouldLog=a??!0,this.eventType=e,this.eventName=t,this.diagnosticLevel=u||s.PM.CP_DIAGNOSTIC_LEVEL_OPTIONAL,this.dataCategory=c||s.uk.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,this.scenarioName=o,this.capability=r,this.verb=i||""}GetLogs(){return this.logs}SetLogs(e){this.logs=e}AddLog(e){this.logs.push(e)}IsRequired(){return this.isRequired}SetIsRequired(e){this.isRequired=e}SetEventType(e){this.eventType=e}GetEventType(){return this.eventType}SetEventName(e){this.eventName=e}GetEventName(){return this.eventName}SetDataCategory(e){this.dataCategory=e}GetDataCategory(){return this.dataCategory}SetDiagnosticLevel(e){this.diagnosticLevel=e}GetDiagnosticLevel(){return this.diagnosticLevel}SetScenarioName(e){this.scenarioName=e}GetScenarioName(){return this.scenarioName}SetCapability(e){this.capability=e}GetCapability(){return this.capability}GetShouldLog(){return this.shouldLog}SetShouldLog(e){this.shouldLog=e}GetVerb(){return this.verb}SetVerb(e){this.verb=e}}var d=n(89994),p=n(95113);class h{static setTelemetryHandler(e){this.telemetryHandler=e}static getTelemetryHandler(){return this.telemetryHandler}addChatHistoryInfoLog(e){this.chatHistoryInfoLog.push(e)}resetChatHistoryInfoLog(){this.chatHistoryInfoLog=[]}setUserQueryGuid(e){this.userQueryGuid=e}getUserQueryGuid(){return this.userQueryGuid}constructor(){this.chatHistoryInfoLog=[],this.userQueryGuid=d.u1,this.getTelemetryLatencyEvent=(e,t,n,o,r)=>{e=e.concat(this.getDataFields([{key:a.CT.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryInfoLog)}])),e=this.updateQueryGuidAndInteractionID(e),t&&this.setUserQueryGuid(d.u1);return new u(s.S2.Latency,s.lr.Latency,e,n,o,r,t)},this.getTelemetryLatencyEventForNotification=(e,t,n,o,r)=>new u(s.S2.NotificationLatency,s.lr.Latency,e,n,o,r,t),this.getASHATelemetryErrorEvent=(e,t,n,r,i,a,l)=>{e=e.concat(...r&&i?[...o.Mu.getFields({eventType:o.Mu.EventType.Error,veto:r,error:i,inStaging:a??!0})]:[]),e=this.updateQueryGuidAndInteractionID(e);return new u(s.S2.Error,s.lr.AshaError,e,t,n,l)},this.getASHAPillarTelemetryEvent=(e,t,n,r,i)=>{e=e.concat(...r?[...o.Mu.getFields({eventType:o.Mu.EventType.Pillar,pillar:r})]:[]),e=this.updateQueryGuidAndInteractionID(e);return new u(s.S2.ChatEvents,s.lr.ChatEvents,e,t,n,i)},this.getTelemetryErrorEvent=(e,t,n,o,r)=>{e=e.concat(this.getDataFields([{key:a.h3.UserQueryOrder,value:i.EU}])),e=this.updateQueryGuidAndInteractionID(e);return new u(s.S2.Error,s.lr.Error,e,n,o,r,t)},this.getTelemetryAgentErrorEvent=(e,t,n,o,r)=>{(e=e.concat(this.getDataFields([{key:a.h3.UserQueryOrder,value:i.EU}]))).find((e=>e.name===a.qN))||(e=e.concat(this.getDataFields([{key:a.qN,value:this.userQueryGuid.length>0?this.userQueryGuid:i.dB}])));return new u(s.S2.Error,s.lr.AgentError,e,n,o,r,t)},this.getTelemetryAgentEvent=(e,t,n,o,r)=>{(e=e.concat(this.getDataFields([{key:a.h3.UserQueryOrder,value:i.EU}]))).find((e=>e.name===a.qN))||(e=e.concat(this.getDataFields([{key:a.qN,value:this.userQueryGuid.length>0?this.userQueryGuid:i.dB}])));return new u(s.S2.AgentEvents,s.lr.AgentEvents,e,n,o,r,t)},this.getTelemetryQueryDetailsEvent=(e,t,n,o)=>{(e=e.concat(this.getDataFields([{key:a.tw.UserQueryOrder,value:i.EU}]))).find((e=>e.name===a.qN))||(e=e.concat(this.getDataFields([{key:a.qN,value:this.userQueryGuid.length>0?this.userQueryGuid:i.dB}])));return new u(s.S2.QueryDetails,s.lr.QueryDetails,e,t,n,o)},this.getTelemetryChatEvent=(e,t,n,o,r)=>{e=e.concat(this.getDataFields([{key:a.h3.UserQueryOrder,value:i.EU}])),(e=this.updateQueryGuidAndInteractionID(e)).find((e=>e.name===a.JI))||(e=e.concat(this.getDataFields([{key:a.JI,value:p.w.getInstance().getAlSessionKey()??""}])));return new u(s.S2.ChatEvents,s.lr.ChatEvents,e,n,o,r,t)},this.chatHistoryInfoLog=[]}static getInstance(){return h.telemetryHandler||this.setTelemetryHandler(new c.o),this.sInstance||(this.sInstance=new h),this.sInstance}static resetInstance(){this.sInstance=void 0}updateQueryGuidAndInteractionID(e){try{const t=e.find((e=>e.name===a.qN));let n="";return t?n=t.value.toString():(n=this.userQueryGuid.length>0?this.userQueryGuid:i.dB,e=e.concat(this.getDataFields([{key:a.qN,value:n}]))),e=e.concat([...o.TA.getFields({interactionId:n})])}catch(t){return(0,l.cY)("Error updating query GUID and interaction ID:",t),e}}sendTelemetryLatencyData(e,t=!1,n="",o="",r){null!=h.telemetryHandler&&(h.telemetryHandler.LogTelemetryEvent(this.getTelemetryLatencyEvent(this.getDataFields(e),t,n,o,r)),this.resetChatHistoryInfoLog())}sendTelemetryLatencyDataForNotification(e,t=!1,n="",o="",r){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getTelemetryLatencyEventForNotification(this.getDataFields(e),t,n,o,r))}sendTelemetryErrorData(e,t="",n="",o){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getTelemetryErrorEvent(this.getDataFields(e),!0,t,n,o))}sendTelemetryAgentErrorData(e,t="",n="",o){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getTelemetryAgentErrorEvent(this.getDataFields(e),!0,t,n,o))}sendTelemetryAgentEventData(e,t=!0,n="",o="",r){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getTelemetryAgentEvent(this.getDataFields(e),t,n,o,r))}sendTelemetryQueryDetailsObject(e,t="",n="",o){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getTelemetryQueryDetailsEvent(this.getDataFields(e),t,n,o))}sendTelemetryChatEventData(e,t=!0,n="",o="",r){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getTelemetryChatEvent(this.getDataFields(e),t,n,o,r))}getCopilotScorecardData(e,t,n,r,i,a,c,d){e=e.concat([...o.TA.getFields({featureActionType:o.TA.FeatureActionType[t],isUserInitiated:!0,capability:(0,l.hX)(i)?"":o.TA.Capability[i],verb:(0,l.hX)(c)?"":o.TA.Verb[c],featureName:(0,l.hX)(r)?"Others":r,subFeatureName:(0,l.hX)(d)?"":d,entryPoint:n,isThumbsUp:(0,l.hX)(a)?null:a})]),e=this.updateQueryGuidAndInteractionID(e);return new u(s.S2.Chat,s.lr.Chat,e,r,i,c,!0,!0,s.uk.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,s.PM.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)}getDataFields(e){return e.map((e=>"number"==typeof e.value?r.ip(e.key,e.value,e.tag):"string"==typeof e.value?r.m9(e.key,e.value,e.tag):"boolean"==typeof e.value?r.LK(e.key,e.value,e.tag):r.m9(e.key,e.value,e.tag)),[])}logSeenEvent(e,t,n,r,i,a){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(e),o.TA.FeatureActionType.IsSeen,t,n,r,void 0,i,a))}logTriedEvent(e,t,n,r,i,a,s){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(e),o.TA.FeatureActionType.IsTried,t,n,r,i,a,s))}logKeptEvent(e,t,n,r,i,a,s){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(e),o.TA.FeatureActionType.IsKept,t,n,r,i,a,s))}logEnabledEvent(e,t,n,r,i,a){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getCopilotScorecardData(this.getDataFields(e),o.TA.FeatureActionType.IsSeen,t,n,r,void 0,i,a))}logEventWithAshaPillar(e,t="",n="",o,r){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getASHAPillarTelemetryEvent(this.getDataFields(e),t,n,o,r))}logErrorWithAshaVetoAndError(e,t=a.Z_.CopilotChat,n="",o,r,i,s){null!=h.telemetryHandler&&h.telemetryHandler.LogTelemetryEvent(this.getASHATelemetryErrorEvent(this.getDataFields(e),t,n,o,r,i,s))}}},88012:(e,t,n)=>{n.d(t,{A9:()=>i,N2:()=>s,_w:()=>a,lh:()=>r});var o=n(90922);const r=e=>"ChatCompose"===e?o.Z_.Draft:o.Z_.ChatQnA,i=e=>{switch(e){case o.Z_.Draft:return o.rf.ContentGeneration;case o.Z_.ChatQnA:return o.rf.QAandSummaries;default:return}},a=e=>{switch(e){case o.Z_.Draft:return o.RX.Create;case o.Z_.ChatQnA:return o.RX.Ask;default:return}},s=e=>{switch(e){case o.Z_.Draft:return o.EF.ContentCreation;case o.Z_.ChatQnA:return o.EF.BasicChat;default:return}}},91749:(e,t,n)=>{n.d(t,{R:()=>bn});var o=n(21394),r=n(27982),i=n(41519),a=n(21137),s=n(8520),l=n(88027),c=n(5219),u=n(33561),d=n(62559),p=n(45626);const h=({actionButtons:e,messageContentElementId:t,chatCardIndex:n,pluginAuthError:h,telemetryData:g})=>{const f=(0,p.Up)(),m=(0,c.i)(h),y=e.map(((e,o)=>{if(e.type===r.jA.CustomButton&&e.customButtonUI)return e.customButtonUI;const i=!e.text&&e.iconRegular,l=()=>{e.handleOnMouseEnter&&e.handleOnMouseEnter()},c=()=>{e.handleOnMouseLeave&&e?.handleOnMouseLeave()},p=s.createElement(a.$,{appearance:e.type==r.jA.Primary?"primary":i?"transparent":"outline",tabIndex:0,key:o,title:e.title,"aria-label":e?.ariaLabel,"aria-expanded":"false",className:i?f.iconButton:f.combinedButton,icon:e?.iconRegular?{children:e.iconHover?(0,d.k)(e.iconRegular,e.iconHover):s.createElement(e.iconRegular,null),className:e?.text?f.combinedButtonIcon:f.icon}:void 0,onClick:()=>{e.handleButtonOnClick&&e.handleButtonOnClick(t,n,g)},onMouseEnter:l,onMouseLeave:c,onFocus:l,onBlur:c,disabled:e.isDisabled},e?.text);return e.popoverProps?s.createElement(u.K,{key:o,...e.popoverProps},p):p}));return h&&m&&y.push(s.createElement(o.N,{key:e.length,...m,customStyles:p.Xt,theme:(0,l.$x)()===i.G.defaultBlack?"dark":"light"})),y};var g=n(45779),f=n(65593),m=n(11313),y=n(19349),v=n(77148),C=n(5925),b=n(32459),E=n(68779),A=n(88700),S=n(82532),I=n(29208);const P=({onCopyButtonClick:e})=>{const t=(0,f.Lh)(I.fq),n=(0,g.dp)(),o=(0,m.Bi)("toaster"),{dispatchToast:r}=(0,y.J)(o),i=(0,f.Lh)(I.M2),l=()=>{e&&e(),r(s.createElement(v.y,null,s.createElement(C.S,null,i)),{intent:"success"})};return s.createElement(s.Fragment,null,s.createElement(b.l,{toasterId:o,position:"top",limit:1}),s.createElement(E.m,{content:t,relationship:"label",withArrow:!0},"sidecar"==n?s.createElement(a.$,{appearance:"transparent",icon:s.createElement(A.Jg_,null),onClick:l}):s.createElement(a.$,{appearance:"secondary",icon:s.createElement(S.Qvr,null),onClick:l},t)))};var T=n(26122);const x=e=>{const t=(0,g.dp)();return s.createElement(s.Fragment,null,s.createElement(T.z,{mode:t,positiveFeedbackButton:{onClick:t=>{const n=t.target.closest("button");e.handleThumbsUpClick(n)}},negativeFeedbackButton:{onClick:t=>{const n=t.target.closest("button");e.handleThumbsDownClick(n)}}}))};var w=n(28087),k=n(19080),_=n(27670),D=n(72277),F=n(66782),L=n(13552),O=n(59777),R=n(90922),M=n(33500),B=n(22330),N=n(35373),V=n(62653),H=n(47875);const U=e=>s.createElement("div",{style:{display:"flex",flexWrap:"wrap",rowGap:V.L.spacingVerticalS,columnGap:V.L.spacingHorizontalS}},e);var j=n(50393),z=n(6182),G=n(1382),W=n(6394),q=n(91971),Q=n(89685),K=n(79490),Y=n(43890);class ${handoffToService(e){return(0,K.__awaiter)(this,void 0,void 0,(function*(){var t,n,o;const r=new Y.vF(e);null===(t=this.beforeSendingHandoffInboundMessage)||void 0===t||t.call(this,r);const i=this.sendHandoffInboundMessage(r);null===(n=this.onHandoffInboundMessageSent)||void 0===n||n.call(this,r);const a=yield i;return null===(o=this.onHandoffOutboundMessageReceived)||void 0===o||o.call(this,a),a}))}retrieveHandoffFromService(e,t){return(0,K.__awaiter)(this,void 0,void 0,(function*(){var n,o,r,i;null===(n=this.beforeHandoffFromService)||void 0===n||n.call(this);const a=this.sendHandoffFromServiceRequest(e,t);null===(o=this.onHandoffFromServiceSent)||void 0===o||o.call(this);const s=yield a;if(null===(r=this.onHandoffFromServiceResponseReceived)||void 0===r||r.call(this,s),s.error)throw new Error("Handoff message fetch error: "+s.error);if(s.properties)return Object.assign(Object.assign({},s.properties),{handoffMessageId:e});return Object.assign(Object.assign({},s),{scenarioName:null!==(i=s.scenarioName)&&void 0!==i?i:q.Cu.NONE,handoffMessageId:e})}))}submitHandoffProperties(e){var t,n;const o=Object.assign({properties:e},e);null===(t=this.beforeSubmitHandoffMessage)||void 0===t||t.call(this,o),this.submitHandoffMessageAnnotation(o),null===(n=this.onHandoffMessageSubmitted)||void 0===n||n.call(this,o)}}class J{static generateId(){return J.operationId++,"AugLoopCopilotChat"+J.operationId.toString()}}J.operationId=0;var X=n(5157),Z=n(26115),ee=n(42414);class te extends ${constructor(e,t){super(),this.TIMEOUT_MS=9e4,this.alSession=e,t&&(this.TIMEOUT_MS=t)}get timeoutMs(){return this.TIMEOUT_MS}sendHandoffInboundMessage(e){return(0,K.__awaiter)(this,void 0,void 0,(function*(){return yield this.sendAugLoopRequest(e,X.kp.getTypeName(),(e=>{for(const t of e.items)if(t.body&&X.kp.typeGuard(t.body)){return t.body}}))}))}sendHandoffFromServiceRequest(e,t){return(0,K.__awaiter)(this,void 0,void 0,(function*(){if(!this.alSession.createMessageIdSignal)throw new Error("createMessageIdSignal is not defined in service config.");return yield this.sendAugLoopRequest(this.alSession.createMessageIdSignal(e,t),X.uC.getTypeName(),(e=>{for(const t of e.items)if(t.body&&X.uC.typeGuard(t.body)){return t.body}}))}))}submitHandoffMessageAnnotation(e){this.submitOperation(e)}sendAugLoopRequest(e,t,n){return(0,K.__awaiter)(this,void 0,void 0,(function*(){if(!this.alSession)throw Error("Handoff: Augloop session is empty.");let o=Promise.resolve(void 0);try{const r=new Promise((e=>{o=this.alSession.activateAnnotation(t,((t,o)=>{const r=n(t);r&&e(r)}))})),i=new Promise(((e,t)=>{setTimeout((()=>{t(new Error(`Handoff: Operation timed out after ${this.TIMEOUT_MS} ms.`))}),this.TIMEOUT_MS)})),a=Promise.race([r,i]);this.submitOperation(e);return yield a}finally{const e=yield o;e&&this.alSession.releaseAnnotation(e.token)}}))}submitOperation(e){const t=new Z.g0({parentPath:[ee.HN.getTypeName(),Y.vF.getTypeName()],items:[{id:J.generateId(),body:e}]});this.alSession.submitOperation(t)}}var ne=n(50083),oe=n(18603),re=n(58325),ie=n(96895),ae=n(19399),se=n(30921),le=n(19385),ce=n(94794),ue=n(89270),de=n(35571),pe=n(64934),he=n(18850);const ge=(0,he.Ex)("scc-react-handoff-plugin.sccHandoffStrings.HandoffButtonEditInText"),fe=(0,he.Ex)("scc-react-handoff-plugin.sccHandoffStrings.HandoffButtonToolTip"),me=(0,he.Ex)("scc-react-handoff-plugin.sccHandoffStrings.HandoffButtonFailedMessage"),ye=(0,he.Ex)("scc-react-handoff-plugin.sccHandoffStrings.HandoffItemButtonEditInWordText"),ve=(0,he.Ex)("scc-react-handoff-plugin.sccHandoffStrings.HandoffItemButtonEditInExcelText"),Ce=(0,he.Ex)("scc-react-handoff-plugin.sccHandoffStrings.HandoffButtonLoadingText");const be={displayName:"Word",icon:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets/brand-icons/product/svg/word_32x1.svg",alt:""},Ee={displayName:"Excel",icon:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets/brand-icons/product/svg/excel_32x1.svg",alt:""},Ae=[q.Ww.WORD,q.Ww.EXCEL];var Se;!function(e){e.Initial="initial",e.Loading="loading",e.Fail="fail"}(Se||(Se={}));const Ie=(e,t,n,o,r,i)=>(0,K.__awaiter)(void 0,void 0,void 0,(function*(){const a=(0,Q.DA)(),s={destinationApp:t,handoffEditInRequestId:a};null==i||i.logHandoffEditInItemButtonClicked(s);const l={queryId:a,destinationApp:t,scenarioName:q.Cu.GENERATE,documentName:Te(t),handoffStartTime:Date.now(),content:[Pe(t,n)],language:"en-US",sensitivityLabel:r},c=yield e();o(Se.Loading);try{null==i||i.logHandoffEditInRequestSent(s);const e=yield c.handoffToService(l);null==i||i.logHandoffEditInResponseReceived(s);const t=function(e,t){const n=e.generatedLinks;if(n){const e=n.find((e=>e.appPlatform===t));return null==e?void 0:e.platformHandoffUrl}}(e,q.pT.WEB);t&&window.open(t,"_blank"),o(Se.Initial),null==i||i.logHandoffEditInRequestSucceeded(s)}catch(e){o(Se.Fail),s.error=e.message,null==i||i.logHandoffEditInRequestFailed(s)}})),Pe=(e,t)=>{switch(e){case q.Ww.WORD:return{contentString:t,contentFormat:q.v1.MARKDOWN};case q.Ww.EXCEL:return{contentString:t,contentFormat:q.v1.JSON};default:throw new Error(`App ${e} is not supported`)}},Te=e=>{switch(e){case q.Ww.WORD:return"Document";case q.Ww.EXCEL:return"Book";default:throw new Error(`App ${e} is not supported`)}};var xe=n(92153);const we={small:22,medium:24,large:26},ke=(e,t)=>s.createElement(xe._,{alt:null==t?void 0:t.alt,height:we[e],src:null==t?void 0:t.icon,width:we[e]}),_e={handoffButtonEditInText:ge,handoffButtonToolTip:fe,handoffButtonFailedMessage:me,handoffItemButtonEditInWordText:ye,handoffItemButtonEditInExcelText:ve,handoffButtonLoadingText:Ce},De=({getHandoffService:e,editInAppList:t,markdownBody:n,buttonSize:o,sensitivityLabel:r,telemetryLogger:i})=>{const l=n.message.replace(/\[(\d+)\]\([^)]+\)/g,((e,t)=>`[${t}]`));const[c,u]=s.useState([]),d=e=>{null===e?u([]):c.includes(e)||u((t=>[...t,e]))};s.useEffect((()=>{t.includes(q.Ww.EXCEL)&&(n.componentsOverride=Object.assign(Object.assign({},n.componentsOverride),{table:e=>{var{node:t}=e,n=(0,K.__rest)(e,["node"]);return s.createElement("table",Object.assign({ref:d},n),n.children)}}))}),[t,n.message]);const p=(()=>{const e=(0,f.kQ)(_e);return Object.assign({},e)})(),[h,g]=s.useState(Se.Initial),m=t.filter((e=>Ae.includes(e))).map((t=>{if(t===q.Ww.WORD)return{appName:q.Ww.WORD,onClick:()=>Ie(e,q.Ww.WORD,l,g,r,i),appIcon:be};if(t===q.Ww.EXCEL&&c&&1===c.length){const t=(e=>{const t=e.cloneNode(!0),n=t.getElementsByTagName("a");for(const e of Array.from(n))"button"===e.role&&e.remove();const o=[],r=t.rows;for(let e=0;e<r.length;e++){const t=[],n=r[e].cells;for(let e=0;e<n.length;e++)t.push(n[e].innerText);o.push(t)}return JSON.stringify(o)})(c[0]);return{appName:q.Ww.EXCEL,onClick:()=>Ie(e,q.Ww.EXCEL,t,g,r,i),appIcon:Ee}}return null})).filter((e=>null!==e)),[y,v]=s.useState(!0);s.useEffect((()=>{y&&(null==i||i.logHandoffEditInButtonRendered(),v(!1))}),[y]);const C=s.useRef(null),b=s.useRef(null);s.useEffect((()=>{var e;b.current&&(null===(e=C.current)||void 0===e||e.setTarget(b.current))}),[b,C]),s.useEffect((()=>{if(h===Se.Fail){const e=setTimeout((()=>{g(Se.Initial)}),5e3);return()=>clearTimeout(e)}}),[h]);const[A,S]=s.useState(!0);s.useEffect((()=>{S(1===m.length)}),[m]);const I=()=>h===Se.Loading?s.createElement(ne.y,{size:"tiny"}):((e,t)=>{const n=(0,de.A)(t,e);return s.createElement(n,null)})(pe.AW6,pe.aJF),P=()=>{h!==Se.Loading&&(null==i||i.logHandoffEditInMenuButtonClicked(),g(Se.Initial),A&&m[0].onClick())},T=()=>({icon:I(),ref:b,onClick:P}),x=()=>s.createElement(s.Fragment,null,s.createElement(oe.A,{withArrow:!0,open:h===Se.Fail,positioning:{target:b.current,align:"start",position:"above"}},s.createElement(re.H,null,s.createElement("div",{role:"alert","aria-label":p.handoffButtonFailedMessage()},p.handoffButtonFailedMessage()))));return 1===m.length&&m[0].appName===q.Ww.WORD?s.createElement(s.Fragment,null,s.createElement(E.m,{content:h===Se.Loading?p.handoffButtonLoadingText():p.handoffItemButtonEditInWordText(),relationship:"label",withArrow:!0},s.createElement(a.$,Object.assign({appearance:"transparent"},T()))),x()):s.createElement(s.Fragment,null,s.createElement(ie.W,{positioning:{align:"start",position:"above"}},s.createElement(ae.c,{disableButtonEnhancement:!0},s.createElement(E.m,{content:h===Se.Loading?p.handoffButtonLoadingText():p.handoffButtonToolTip(),relationship:"label",withArrow:!0},s.createElement(se.I,Object.assign({size:o,style:{backgroundColor:"transparent"}},T()),p.handoffButtonEditInText()))),s.createElement(le.b,null,s.createElement(ce.c,null,m.map((e=>{const t=e.appName===q.Ww.WORD?p.handoffItemButtonEditInWordText():e.appName===q.Ww.EXCEL?p.handoffItemButtonEditInExcelText():p.handoffButtonEditInText();return s.createElement(ue.D,{key:e.appName,onClick:e.onClick,icon:ke(o,e.appIcon),"aria-label":t},t)}))))),x())};var Fe,Le,Oe,Re=n(98483);!function(e){e.Dogfood="dogfood",e.Production="production"}(Fe||(Fe={})),function(e){e.Initial="initial",e.Playing="playing",e.Paused="paused",e.Loading="loading"}(Le||(Le={})),function(e){e.V1="v1",e.V2="v2"}(Oe||(Oe={}));var Me=n(658),Be=n(16895),Ne=n(41798);const Ve=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.viewCopilotPromptGallery"),He=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.promptSavedLabel");var Ue=n(62418),je=n(30112),ze=n(95744);const Ge=(0,Me.n)({toastContainer:{width:"268px",maxWidth:"calc(100vw - 24px)"},toastTitle:{justifyContent:"space-between"},toastBody:Object.assign({fontWeight:V.L.fontWeightRegular,fontSize:V.L.fontSizeBase300,lineHeight:V.L.lineHeightBase300},Be.Pt.padding(V.L.spacingVerticalNone)),overflowToastBody:{gridColumn:"2 / 4"},toastFooter:{"&.fui-ToastFooter":Object.assign({},Be.Pt.padding(V.L.spacingVerticalS,V.L.spacingVerticalNone,V.L.spacingHorizontalNone,V.L.spacingVerticalNone))}}),We=({intent:e,title:t,body:n,overflowBody:o,footer:r,automationId:i})=>{const a=Ge();return s.createElement(v.y,{className:a.toastContainer,"data-automation-id":i},s.createElement(C.S,{media:"loading"===e?s.createElement(ne.y,{size:"extra-tiny"}):void 0,className:a.toastTitle,role:"alert"},t),n&&s.createElement(Ue.A,{className:(0,je.z)(o?a.overflowToastBody:void 0,a.toastBody)},n),r&&s.createElement(ze.F,{className:a.toastFooter},r))},qe=()=>{const e=Ne.hU,{dispatchToast:t,dismissAllToasts:n}=(0,y.J)(e),o=s.useCallback((o=>{var{intent:r,timeout:i}=o,a=(0,K.__rest)(o,["intent","timeout"]);n(),t(s.createElement(We,Object.assign({intent:r},a)),{intent:"loading"!==r?r:void 0,toastId:e,timeout:i})}),[n,t,e]);return{displayToast:o,dismissAllToasts:n}},Qe=(0,Me.n)({actionButton:Object.assign(Object.assign({fontWeight:V.L.fontWeightSemibold},Be.Pt.padding("0px")),{color:V.L.colorBrandForegroundLink,minWidth:"auto"})});var Ke=n(21017);const Ye=(0,he.Ex)("scc-react-chat-actionbar-plugin.promptLibrary.linkCopiedAndStoredLabel"),$e=(0,he.Ex)("scc-react-chat-actionbar-plugin.promptLibrary.sharePrivacyNoticeLabel"),Je=(0,he.Ex)("scc-react-chat-actionbar-plugin.promptLibrary.manageAccessText"),Xe=(0,Me.n)({actionButton:Object.assign(Object.assign({fontWeight:V.L.fontWeightSemibold},Be.Pt.padding("0px")),{color:V.L.colorBrandForegroundLink,minWidth:"auto"}),link:{color:V.L.colorBrandForegroundLink}});var Ze=n(79780);const et=(e,t=200,n=!0,o=!1)=>tt(e,t,s.useMemo((()=>({leading:n,trailing:o})),[n,o])),tt=(e,t,n)=>{const o=s.useCallback((0,Ze.A)(e,t,n),[e,t,n]);return s.useEffect((()=>()=>{o.cancel()}),[o]),o},nt=(0,Me.n)({compact:{minWidth:"auto",minHeight:"auto",border:"0",borderRadius:"0",padding:"0"}}),ot=s.forwardRef((({classes:e,shape:t,appearance:n,compact:o,disabled:r,icon:i,size:l,loading:c,children:u,testAutomationId:d,tooltip:p,"aria-label":h,onClick:g,eventLogger:f,...m},y)=>{const v=nt(),C=et(s.useCallback((e=>{null==f||f.logOnClickEventFunction(),null==g||g(e)}),[f,g])),b=s.useCallback((()=>{var e;null===(e=null==f?void 0:f.logOnHoverEventFunction)||void 0===e||e.call(f)}),[f]);s.useEffect((()=>{var e;null===(e=null==f?void 0:f.logOnDisplayEventFunction)||void 0===e||e.call(f)}),[]);const A=s.useMemo((()=>(0,je.z)(o&&v.compact,...e||[])),[v.compact,o,e]);let S=s.createElement(a.$,{ref:y,className:A,shape:t,appearance:n,disabled:r,disabledFocusable:c,size:l,onClick:C,"data-automation-id":d,...h?{"aria-label":h}:{},onMouseEnter:b,icon:c?s.createElement(ne.y,{size:"extra-tiny",appearance:"primary"!==n||r?"primary":"inverted"}):i,...m},u);return p&&(S=s.createElement(E.m,{...p},S)),S}));ot.displayName="Button";var rt=n(88203);const it=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.SaveAriaLabelSave"),at=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.SaveAriaLabelRemove"),st=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.SaveAriaLabelSaving"),lt=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.SaveTooltipContentSave"),ct=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.SaveTooltipContentRemove"),ut=()=>(0,f.Lh)(it),dt=()=>(0,f.Lh)(at),pt=()=>(0,f.Lh)(st),ht=()=>(0,f.Lh)(lt),gt=()=>(0,f.Lh)(ct),ft=(0,de.A)(rt.dAM,rt.Fpn),mt=(0,de.A)(rt.iHP,rt.mhB),yt=e=>{const{isSaved:t,loading:n}=e,o=ut(),r=dt(),i=pt(),a=ht(),l=gt(),c=n?i:t?r:o,u=(e=>{if(e)return{content:e,relationship:"label",withArrow:!0}})((()=>{if(!n)return t?l:a})()),d=t?s.createElement(mt,null):s.createElement(ft,null);return s.createElement(ot,Object.assign({appearance:"subtle","aria-label":c,tooltip:u,icon:d},e))};var vt=n(38574);const Ct=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.ShareAriaLabel"),bt=(0,he.Ex)("scc-react-chat-actionbar-plugin.chatActionBarPluginStrings.ShareTooltipContent"),Et=()=>(0,f.Lh)(Ct),At=()=>(0,f.Lh)(bt),St=e=>{const t=Et(),n={content:At(),relationship:"label",withArrow:!0};return s.createElement(ot,Object.assign({},e,{appearance:"subtle","aria-label":t,tooltip:n,icon:s.createElement(vt.mix,null)}))},It=e=>{const{onSavePrompt:t,onSharePrompt:n,isPromptSaved:o,telemetryLogger:r,onViewCopilotPromptGalleryClick:i}=e,[l,c]=s.useState(!1),{displaySaveSuccessToast:u}=(()=>{const e=Qe(),{displayToast:t,dismissAllToasts:n}=qe(),o=(0,f.kQ)({ViewCopilotPromptGallery:Ve,PromptSavedLabel:He});return{displaySaveSuccessToast:s.useCallback((n=>{t({intent:"success",title:o.PromptSavedLabel(),footer:s.createElement(a.$,{appearance:"transparent",className:e.actionButton,onClick:n,"data-automation-id":Ne.$T},o.ViewCopilotPromptGallery()),automationId:Ne.tM})}),[t,o,e]),dismissAllToasts:n}})(),{displayCopyLinkSuccessToast:d}=(()=>{const e=Xe(),t=(0,f.kQ)({LinkCopiedAndStoredLabel:Ye,SharePrivacyNotice:$e,ManageAccessText:Je}),{displayToast:n,dismissAllToasts:o}=qe();return{displayCopyLinkSuccessToast:s.useCallback((()=>{const o={intent:"success",title:t.LinkCopiedAndStoredLabel(),body:t.SharePrivacyNotice(),overflowBody:!0,footer:s.createElement(Ke.N,{href:Ne.ph,className:e.link,target:"_blank",inline:!0},t.ManageAccessText()),automationId:Ne.Fm};n(o)}),[n,t,e.link]),dismissAllToasts:o}})(),p=s.useRef(e.promptData);s.useEffect((()=>{p.current=e.promptData}),[e.promptData]);const h=s.useCallback((()=>o(p.current)),[o]),g=s.useCallback((()=>{u(i)}),[u,i]),m=s.useCallback((()=>{d()}),[d]),y=s.useCallback((()=>{p.current.isPromptSaved?null==r||r.logUnSaveClicked():null==r||r.logSaveClicked(),t(p.current,c,g)}),[r,t,g]),v=s.useCallback((()=>{null==r||r.logShareClicked(),n(p.current,m)}),[n,m,r]);return s.createElement(s.Fragment,null,s.createElement(yt,{isSaved:h(),loading:l,onClick:y}),s.createElement(St,{onClick:v}))};var Pt=n(26532),Tt=n(72097),xt=n(66503),wt=n(89994),kt=n(37426),_t=n(99429);const Dt=(e,t)=>{let n=e?.contextData?.cardMetaData??"";try{const e=JSON.parse(n);e.copilotExtensionId=t,n=JSON.stringify(e)}catch(e){(0,N.cY)("Error in parsing cardMetaData: "+e)}return t?{...e,contextData:{...e?.contextData,featureName:R.Z_.Extensibility,subFeatureName:R.EF.ExtensibilityDeclarativeAgents,cardMetaData:n}}:e},Ft=(e,t,n)=>{let o=n??"";try{const n=JSON.parse(o);n.copilotAgentId=t,n.correlationId=e,o=JSON.stringify(n)}catch(e){(0,N.cY)("Error in parsing telemetryData: "+e)}return t?o:n},Lt=(e,t)=>{const n=e?.feedbackData?.contextData?.feedbackContextData?.promptId??"",o=_t.k.getInstance().getAgentIdForQueryId(n);return o&&t?{...e,feedbackData:Dt(e?.feedbackData,o),telemetryData:Ft(n,o,e?.telemetryData)}:e};var Ot,Rt,Mt,Bt=n(4801),Nt=n(41712);!function(e){e.Dogfood="dogfood",e.Production="production"}(Ot||(Ot={})),function(e){e.Initial="initial",e.Playing="playing",e.Paused="paused",e.Loading="loading"}(Rt||(Rt={})),function(e){e.V1="v1",e.V2="v2"}(Mt||(Mt={}));const Vt={ReadSmart:!0,ExtractWordMarkers:!0,ExtractSentenceMarkers:!0,UseLanguageDetection:!0,UseBrowserSpecifiedDialect:!0,PreferredVoice:"Female"},Ht=(e,t,n,...o)=>(0,K.__awaiter)(void 0,[e,t,n,...o],void 0,(function*(e,t,n,o=Vt){if(!n.text)throw new Error("FreeformSpeechService: Text is required");const r={data:n,Options:o},i=yield fetch(e,{method:"POST",headers:t,body:JSON.stringify(r)});if(!i.ok)throw new Error(`FreeformSpeechService: Failed to get freeform speech: ${i.statusText}`);return yield i.json()}));class Ut{constructor(){this.endpoint=new URL("https://learningtools.edog.onenote.com/learningtoolsapi/v2.0/GetFreeformSpeech"),this.headers={"Content-Type":"application/json","Ms-Int-Appid":"KrakenTestHost","x-ms-useridhash":"KrakenTestUser"}}getFreeformSpeech(e){return(0,K.__awaiter)(this,arguments,void 0,(function*(e,t=Vt){return Ht(this.endpoint,this.headers,e,t)}))}}class jt{constructor(e){this.endpoint=new URL("https://learningtools.onenote.com/learningtoolsapi/v2.0/GetFreeformSpeech"),this.getAuthToken=e}getHeaders(){return(0,K.__awaiter)(this,void 0,void 0,(function*(){return{"Content-Type":"application/json","Ms-Int-Appid":"MicrosoftEdge",Authorization:`Bearer ${(yield this.getAuthToken()).accessToken}`}}))}getFreeformSpeech(e){return(0,K.__awaiter)(this,arguments,void 0,(function*(e,t=Vt){return Ht(this.endpoint,yield this.getHeaders(),e,t)}))}}class zt{static getInstance(e,t){if(this.instance)return this.instance;switch(e){case Ot.Dogfood:return this.instance=new Ut,this.instance;case Ot.Production:return this.instance=new jt(t),this.instance}}}zt.instance=null;class Gt{constructor(){this.audioElement=null}play(e,t){return this.audioElement&&this.audioElement.pause(),this.audioElement=e,this.audioElement.play(t)}resume(e,t){return this.audioElement&&this.audioElement.pause(),this.audioElement=e,this.audioElement.resume(t)}pause(){this.audioElement&&this.audioElement.pause()}stop(){this.audioElement&&this.audioElement.stop()}}class Wt{static getInstance(){return Wt.instance||(Wt.instance=new Gt),Wt.instance}static destroyInstance(){Wt.instance=null}}Wt.instance=null;var qt=n(41408),Qt=n.n(qt);class Kt{generateAudioElement(e,t,n,o){const r=new Audio(e);return r.onplay=this.onPlay,r.onpause=this.onPause,r.onended=t?()=>{this.telemetryLogger&&o&&this.telemetryLogger.logAudioPlayCompleteEvent(o),this.onEnded()}:()=>this.internalPlay(n+1,0),r}fetchAudioWithRetry(e){return Qt()(e,{retries:2})}generateGetNextAudioPromise(e=0,t=0,n=0,o){return new Promise(((r,i)=>{this.fetchAudioWithRetry((()=>this.apiService.getFreeformSpeech({text:this.textList[t].slice(n)}))).then((n=>{const{data:{sb:i,NextCharacterToRequest:a}}=n,s=-1===a,l=s&&t===this.textList.length-1,c=this.generateAudioElement(i[0].ad,l,e,o);l?this.telemetryLogger&&o&&this.telemetryLogger.logAPIRequestSuccessEvent(o):this.getNextAudioPromise=this.generateGetNextAudioPromise(e+1,s?t+1:t,s?0:a,o),this.audioElementList.push(c),r(c)})).catch((e=>{this.telemetryLogger&&o&&this.telemetryLogger.logAPIRequestFailureEvent(Object.assign(Object.assign({},o),{error:e})),i(e)}))}))}constructor(e,t,n,o,r,i){this.audioElementList=[],this.audioElementIndex=0,this.shouldPlay=!1,this.textList=e,this.apiService=t,this.telemetryLogger=r,this.telemetryData=i,this.onPlay=()=>n(Rt.Playing),this.onPause=()=>n(Rt.Paused),this.onEnded=()=>n(Rt.Initial),this.onLoading=()=>n(Rt.Loading),this.onError=o,this.getNextAudioPromise=this.generateGetNextAudioPromise(0,0,0,i)}getAudioElement(e){return(0,K.__awaiter)(this,void 0,void 0,(function*(){if(e>this.audioElementList.length)throw new Error("Invalid audio element index");if(e==this.audioElementList.length){return yield this.getNextAudioPromise}return this.audioElementList[e]}))}internalPlay(e,t,n){return(0,K.__awaiter)(this,void 0,void 0,(function*(){try{this.internalStop(),this.onLoading(),this.audioElementIndex=e;const o=yield this.getAudioElement(this.audioElementIndex);return this.shouldPlay?(this.onPlay(),this.telemetryLogger&&n&&(this.telemetryData=n,this.telemetryLogger.logAudioPlayStartEvent(n)),o.currentTime=t,yield o.play()):void this.onPause()}catch(e){throw e instanceof Error&&this.onError(e),e}}))}internalResume(e){return(0,K.__awaiter)(this,void 0,void 0,(function*(){try{this.internalPause(),this.onLoading();const t=yield this.getAudioElement(this.audioElementIndex);return this.shouldPlay?(this.onPlay(),this.telemetryLogger&&e&&(this.telemetryData=e,this.telemetryLogger.logAudioPlayResumeEvent(e)),yield t.play()):void this.onPause()}catch(e){throw e instanceof Error&&this.onError(e),e}}))}internalPause(){return(0,K.__awaiter)(this,void 0,void 0,(function*(){const e=this.audioElementList[this.audioElementIndex];e&&!e.paused&&(this.telemetryLogger&&this.telemetryData&&this.telemetryLogger.logAudioPlayPauseEvent(this.telemetryData),this.onPause(),e.pause())}))}internalStop(){return(0,K.__awaiter)(this,void 0,void 0,(function*(){const e=this.audioElementList[this.audioElementIndex];e&&!e.paused&&(this.telemetryLogger&&this.telemetryData&&this.telemetryLogger.logAudioPlayStopEvent(this.telemetryData),this.onEnded(),e.pause(),e.currentTime=0),this.audioElementIndex=0}))}play(e){return(0,K.__awaiter)(this,void 0,void 0,(function*(){return this.shouldPlay=!0,yield this.internalPlay(0,0,e)}))}resume(e){return(0,K.__awaiter)(this,void 0,void 0,(function*(){return this.shouldPlay=!0,yield this.internalResume(e)}))}pause(){return this.shouldPlay=!1,this.internalPause()}stop(){return this.shouldPlay=!1,this.internalStop()}}class Yt{static getTextList(e){const t=e.cloneNode(!0);t.querySelectorAll("a").forEach((e=>{/^\d+$/.test(e.innerText.trim())&&e.remove()})),document.body.append(t);const n=t.innerText;t.remove();const o=n.split("\n").map((e=>e.trim())).filter(Boolean);return this.getMergedTextListWithMaxLength(o,500)}static getMergedTextListWithMaxLength(e,t){return e.reduce(((e,n)=>(e[e.length-1].length+n.length+1<=t?e[e.length-1]+=(e[e.length-1]?"\n":"")+n:e.push(n),e)),[""])}}class $t{constructor(e,t){this.audioElementPool=new Map,this.readAloudAPIService=e,this.telemetryLogger=t}mustGetAudioElement(e){const t=this.audioElementPool.get(e);if(!t)throw new Error("Audio element not found: should register first");return t}register(e,t,n,o,r){if(this.audioElementPool.has(e))return!1;this.telemetryLogger&&r&&this.telemetryLogger.logMessageRegisterEvent(r);const i=t();if(!i)throw new Error("HTML Element not found");const a=Yt.getTextList(i),s=new Kt(a,this.readAloudAPIService,(t=>n(e,t)),(t=>{this.audioElementPool.delete(e),o(t)}),this.telemetryLogger,r);return this.audioElementPool.set(e,s),!0}unregister(e,t){return this.telemetryLogger&&t&&this.telemetryLogger.logMessageUnregisterEvent(t),this.audioElementPool.delete(e)}play(e,t){return(0,K.__awaiter)(this,void 0,void 0,(function*(){Wt.getInstance().pause();const n=this.mustGetAudioElement(e);return yield Wt.getInstance().play(n,t)}))}resume(e,t){return(0,K.__awaiter)(this,void 0,void 0,(function*(){Wt.getInstance().pause();const n=this.mustGetAudioElement(e);return yield Wt.getInstance().resume(n,t)}))}pause(){return Wt.getInstance().pause()}stop(){return Wt.getInstance().stop()}}class Jt{static getInstance(e,t){return this.instance||(this.instance=new $t(e(),t)),this.instance}static destroyInstance(){this.instance=null,Wt.destroyInstance()}}Jt.instance=null;var Xt=n(78226),Zt=n(85023),en=n(92936);const tn=(0,he.Ex)("scc-react-read-aloud-plugin.SccReadAloudStrings.InittalButtonTitle"),nn=(0,he.Ex)("scc-react-read-aloud-plugin.SccReadAloudStrings.PlayingButtonTitle"),on=(0,he.Ex)("scc-react-read-aloud-plugin.SccReadAloudStrings.PausedButtonTitle"),rn=(0,he.Ex)("scc-react-read-aloud-plugin.SccReadAloudStrings.LoadingButtonTitle"),an=s.forwardRef(((e,t)=>{var{state:n,handlePlayButtonOnClick:o,handlePauseButtonOnClick:r,handleResumeButtonOnClick:i}=e,l=(0,K.__rest)(e,["state","handlePlayButtonOnClick","handlePauseButtonOnClick","handleResumeButtonOnClick"]);const c=(0,f.kQ)({InittalButtonTitle:tn,PlayingButtonTitle:nn,PausedButtonTitle:on,LoadingButtonTitle:rn}),u=Object.assign(Object.assign({},l),{tabIndex:0,"aria-expanded":!1});switch(n){case Le.Initial:return s.createElement(a.$,Object.assign({},u,{ref:t,title:c.InittalButtonTitle(),icon:sn(Xt.RqL,Xt.dlv),onClick:o}));case Le.Playing:return s.createElement(a.$,Object.assign({},u,{ref:t,title:c.PlayingButtonTitle(),icon:sn(Zt.yTd,Zt.UGO),onClick:r}));case Le.Paused:return s.createElement(a.$,Object.assign({},u,{ref:t,title:c.PausedButtonTitle(),icon:sn(en.M1N,en.yGi),onClick:i}));case Le.Loading:return s.createElement(a.$,Object.assign({},u,{ref:t,title:c.LoadingButtonTitle(),icon:s.createElement(ne.y,{size:"tiny"})}))}})),sn=(e,t)=>{const n=(0,de.A)(t,e);return s.createElement(n,null)};an.displayName="ReadAloudButton";const ln=e=>{var{buttonRef:t,children:n}=e,o=(0,K.__rest)(e,["buttonRef","children"]);const r=s.useRef(null);return s.useEffect((()=>{var e;t.current&&(null===(e=r.current)||void 0===e||e.setTarget(t.current))}),[r]),s.createElement(oe.A,Object.assign({},o,{positioning:{positioningRef:r}}),s.createElement(re.H,null,n))};var cn=n(10145);const un=(0,he.Ex)("scc-react-read-aloud-plugin.SccReadAloudStrings.ErrorPopoverContentText"),dn={color:V.L.colorPaletteRedForeground3},pn=(0,Me.n)({tabStyle:{display:"flex",alignItems:"center",gap:"4px"},iconStyle:dn}),hn=()=>{const e=pn(),t=(0,f.kQ)({ErrorPopoverContentText:un});return s.createElement("div",{className:e.tabStyle,role:"alert","aria-label":t.ErrorPopoverContentText()},s.createElement(pe.nKe,{className:e.iconStyle}),s.createElement(cn.E,{weight:"semibold"},t.ErrorPopoverContentText()))},gn=({messageId:e,getMessageContentElement:t,getManagementService:n,version:o,telemetryLogger:r,popoverDuration:i=2e3})=>{const[a,l]=s.useState(Le.Initial),c=s.useCallback(((e,t)=>l(t)),[l]),[u,d]=s.useState(null);s.useEffect((()=>{const e=setTimeout((()=>{d(null)}),i);return()=>clearTimeout(e)}),[u,i]);const p=()=>{d(new Date),l(Le.Initial)},h=e=>({messageId:e.messageId,eventId:e.eventId,version:o,state:a}),g=t=>{const n={messageId:e,eventId:(0,Re.A)()};try{t(n)}catch(e){e instanceof Error&&(null==r||r.logUnkownFailureEvent(Object.assign(Object.assign({},n),{error:e})))}},f=s.useRef(null);return s.createElement(s.Fragment,null,s.createElement(an,{ref:f,appearance:o==Oe.V1?"secondary":"transparent",size:o==Oe.V1?"small":"medium",state:a,handlePlayButtonOnClick:()=>g((o=>{null==r||r.logPlayButtonClickedEvent(h(o)),n().register(e,t,c,p,o),n().play(e,o)})),handlePauseButtonOnClick:()=>g((e=>{null==r||r.logPauseButtonClickedEvent(h(e)),n().pause()})),handleResumeButtonOnClick:()=>g((t=>{null==r||r.logResumeButtonClickedEvent(h(t)),n().resume(e,t)}))}),s.createElement(ln,{withArrow:!0,size:"small",open:null!==u,buttonRef:f},s.createElement(hn,null)))},fn=()=>({getActionButton:e=>s.createElement(mn,{...e})}),mn=e=>{const{hostAppSettings:t,hostAppAuthToken:n}=(0,Nt.Mb)(),[o]=s.useState(vn()),r=s.useCallback((()=>Jt.getInstance((()=>zt.getInstance(yn(t.environment),n.oneNoteTokenProvider)),o)),[t,n]);return s.createElement(gn,{messageId:e.messageId,getMessageContentElement:e.getMessageContentElement,getManagementService:r,version:e.version,telemetryLogger:o})},yn=e=>{switch(e){case O.DF.DEV:case O.DF.DOGFOOD:return Fe.Dogfood;case O.DF.PRODUCTION:default:return Fe.Production}},vn=()=>{const e=(e,t)=>{const n=JSON.stringify({...e,error:e.error?e.error.message:void 0,timestamp:Date.now()});Pt.j.getInstance().sendTelemetryChatEventData([{key:R.h3.ChatEventType,value:t},{key:R.h3.ChatEventParameters,value:n}])},t=(e,t,n)=>{const o=[{key:R.IC.ErrorMessage,value:e.message},{key:R.IC.ErrorType,value:t},{key:R.IC.ErrorCategory,value:Bt.S2.Error}];n&&o.push({key:R.IC.ErrorCode,value:n}),Pt.j.getInstance().sendTelemetryErrorData(o)};return{logPlayButtonClickedEvent:t=>e(t,R.a5.ReadAloudPlayButtonClicked),logPauseButtonClickedEvent:t=>e(t,R.a5.ReadAloudPauseButtonClicked),logResumeButtonClickedEvent:t=>e(t,R.a5.ReadAloudResumeButtonClicked),logStopButtonClickedEvent:t=>e(t,R.a5.ReadAloudStopButtonClicked),logMessageRegisterEvent:t=>e(t,R.a5.ReadAloudMessageRegister),logMessageUnregisterEvent:t=>e(t,R.a5.ReadAloudMessageUnregister),logAudioPlayStartEvent:t=>e(t,R.a5.ReadAloudAudioPlayStart),logAudioPlayPauseEvent:t=>e(t,R.a5.ReadAloudAudioPlayPause),logAudioPlayResumeEvent:t=>e(t,R.a5.ReadAloudAudioPlayResume),logAudioPlayStopEvent:t=>e(t,R.a5.ReadAloudAudioPlayStop),logAudioPlayCompleteEvent:t=>e(t,R.a5.ReadAloudAudioPlayComplete),logAPIRequestSuccessEvent:t=>e(t,R.a5.ReadAloudAPIRequestSuccess),logAPIRequestFailureEvent:t=>e(t,R.a5.ReadAloudAPIRequestFailure),logUnkownFailureEvent:t=>e(t,R.a5.ReadAloudUnkownFailure),logAuthTokenError:e=>t(e,R.q0.Client,M.O4.HostOnenoteTokenProvisioningError),logServerError:e=>t(e,R.q0.Server),logClientError:e=>t(e,R.q0.Client)}};var Cn;class bn{constructor(e,t,n,o,r,i){this.handleThumbsDownClick=(e,t,n,o)=>{(0,j.$s)(e),this.copilotCommunicationHandler.feedbackButtonClicked(O.Gb.DISLIKE,e,t,n,o)},this.handleSendFeedbackClick=(e,t,n,o)=>{(0,j.$s)(e),this.copilotCommunicationHandler.feedbackButtonClicked(O.Gb.DISLIKE,e,t,n,o)},this.handleThumbsUpClick=(e,t,n,o)=>{(0,j.$s)(e),this.copilotCommunicationHandler.feedbackButtonClicked(O.Gb.LIKE,e,t,n,o)},this.getHandoffActionButton=e=>{if(e.messageType!==w._.MarkdownCard)return;const t=(e=>{if(e)return{id:e.labelId||"",displayName:e.badgeText||"",policyTip:e.tooltipText,priority:0,responsibleSensitiveTypes:[]}})(e.clpSensitivityIndicatorData),n=Pt.j.getInstance(),o=(e,t)=>{n.sendTelemetryChatEventData([{key:R.h3.ChatEventType,value:e},{key:R.h3.ChatEventParameters,value:JSON.stringify(t)}])};return((e,t,n,o="small",r,i)=>s.createElement(De,{getHandoffService:e,editInAppList:t,markdownBody:n,buttonSize:o,sensitivityLabel:r,telemetryLogger:i}))((async()=>((e,t)=>new te({createMessageIdSignal:(e,t)=>new Y.hU({queryId:(0,Q.DA)(),handOffMessageId:e,handoffOperation:t}),activateAnnotation:(t,n)=>e.activateAnnotation(t,{callback:n}),releaseAnnotation:t=>e.releaseAnnotation(t),submitOperation:(t,n)=>e.submitOperation(t,n)},t))(await this.copilotCommunicationHandler.getALSession(),1e4)),[q.Ww.WORD,q.Ww.EXCEL],e.body,"small",t,{logHandoffEditInButtonRendered:()=>o(R.a5.HandoffEditInButtonRendered),logHandoffEditInMenuButtonClicked:()=>o(R.a5.HandoffEditInMenuButtonClicked),logHandoffEditInItemButtonClicked:e=>o(R.a5.HandoffEditInItemButtonClicked,e),logHandoffEditInRequestSent:e=>o(R.a5.HandoffEditInRequestSent,e),logHandoffEditInResponseReceived:e=>o(R.a5.HandoffEditInResponseReceived,e),logHandoffEditInRequestSucceeded:e=>o(R.a5.HandoffEditInRequestSucceeded,e),logHandoffEditInRequestFailed:e=>o(R.a5.HandoffEditInRequestFailed,e)})},this.getReadAloudActionButtonUIPropsV1=e=>{const t=fn();return{isReadAloudEnabled:(this.featureFlags.isSccReadAloudEnabled&&!this.featureFlags.isOutputV2Enabled)??!1,getReadAloudActionButton:n=>void 0===e.messageId?null:t.getActionButton({messageId:e.messageId,getMessageContentElement:n,version:Oe.V1})}},this.getReadAloudActionButtonV2=(e,t)=>fn().getActionButton({messageId:e.messageId,getMessageContentElement:()=>document.getElementById(t),version:Oe.V2}),this.getChatOutputV2Props=(e,t)=>{let n;if(this.featureFlags.isSaveSharePromptEnabled&&(n=t??e.outputV2Props?.isFailure),e.body.user!==M.Q9.Human){const t=e.clpSensitivityIndicatorData,a=(0,Re.A)(),l=[];if(e.actionBarButtons){const t=(e=>{const{actionButtons:t,messageContentElementId:n,chatCardIndex:o,pluginAuthError:r,telemetryData:i}=e;return s.createElement(h,{actionButtons:t,messageContentElementId:n,chatCardIndex:o,pluginAuthError:r,telemetryData:i})})({actionButtons:e.actionBarButtons,messageContentElementId:a,chatCardIndex:e.chatCardIndex??0,pluginAuthError:e.pluginAuthError,telemetryData:e.telemetryData});l.push(t)}if((e.shouldShowHandoffButton??!1)&&this.featureFlags.isHandoffButtonEnabled){const t=this.getHandoffActionButton(e);t&&l.push(t)}if(e.shouldShowCopyButton??!1){const t=(i={onCopyButtonClick:()=>this.copilotCommunicationHandler.copyButtonClicked(a,e.chatCardIndex,e.telemetryData)},s.createElement(P,Object.assign({},i)));l.push(t)}if(e.feedbackSectionPosition==k.O.Header||e.feedbackSectionPosition==k.O.Footer){const t=(e=>s.createElement(x,Object.assign({},e)))({handleThumbsUpClick:t=>{this.handleThumbsUpClick(e.feedbackData??this.getFeedbackData(),e.telemetryData,t,a)},handleThumbsDownClick:t=>{this.handleThumbsDownClick(e.feedbackData??this.getFeedbackData(),e.telemetryData,t,a)}});l.push(t)}if((e.shouldShowReadAloudButton??!1)&&this.featureFlags.isSccReadAloudEnabled){const t=this.getReadAloudActionButtonV2(e,a);l.push(t)}const c=Cn.getMessageAttributionPropsForBranding(e.messageAttributionProps),u={type:_.N.CopilotMessageV2,props:{sensitivityIndicator:t?{sensitivityLabel:t.badgeText??t.tooltipText,sensitivityIconProps:{withLock:t.iconType===D.JF.Encryption,color:t.color,foregroundIcon:t.icon?(r={icon:t.icon},s.createElement(r.icon,null)):void 0},sensitivityTooltipProps:{message:t.tooltipText}}:void 0,actions:U(l)}},d=this.gptId||c?.id,p=this.featureFlags.isOutputV2Enabled&&d?Cn.getBrandingById?.(d):void 0;if(p&&(u.props={...u.props,avatar:(o=p?.iconUrl,o?s.createElement(H.e,{size:24,image:{src:o}}):s.createElement(s.Fragment,null)),name:p?.name}),e.references){const{referencesV2:t,citationsV2:o}=(0,N.Kn)(e.references,this.shouldSupportCitationsInAvalon,void 0,this.featureFlags.isDAOutputV2Enabled?c:void 0);return u.props.references=t,{messageProps:u,citationsV2:o,contentElementId:a,isFailure:n}}return{messageProps:u,contentElementId:a,isFailure:n}}var o,r,i;let a={};this.featureFlags.isOutputV2Enabled&&this.featureFlags.isSaveSharePromptEnabled&&(a=e.outputV2Props?.messageProps?.type===_.N.UserMessageV2?e.outputV2Props.messageProps.props:{});return{messageProps:{type:_.N.UserMessageV2,props:a},isFailure:n}},this.shouldEnableActionBar=(e,t)=>{const n=e.slice(t+1);return 0!==n.length&&n.every((e=>e?.outputV2Props?.messageProps.type===_.N.CopilotMessageV2&&!1===e.outputV2Props?.isFailure))},this.updateActionBarOnLastUserMessage=e=>{const t=this.getLastHumanMessageIndex(e);if(void 0===t)return;const n=e[t];if(n?.outputV2Props?.messageProps.type!==_.N.UserMessageV2)return;if(!this.shouldEnableActionBar(e,t))return void(n.outputV2Props.messageProps.props.actionBar=void 0);const o=n?.feedbackData?.contextData?.feedbackContextData,r=o?.prompt??wt.u1,i=(0,xt.Q)(),a=i?.DisplayText===r&&"User"==i?.Origin?i.PromptId:wt.u1,l={id:wt.u1,promptId:a,promptText:r,promptTitle:wt.u1,isPromptSaved:!1};var c;n.outputV2Props.messageProps.props.actionBar=(c={promptData:l,onSavePrompt:Tt.Ys,onSharePrompt:Tt.X3,isPromptSaved:e=>(e.isPromptSaved=(0,Tt.BS)(e.promptId),e.isPromptSaved),onViewCopilotPromptGalleryClick:kt.t_,telemetryLogger:(0,Tt.tX)()},s.createElement(It,Object.assign({},c)))},this.addChatMessages=e=>{e.length>0&&this.setChatLog((t=>[...t,...e]))},this.getLastMessage=(e=!0)=>{const t=this.getChatLog();if(0!==t.length)return t[(0,N.y6)(t,e)];(0,N.cY)("No chat messages available")},this.clearMessages=()=>{this.setChatLog((()=>[]))},this.getRawFeedbackData=(e,t={})=>({feedbackArea:e,contextData:{...t,cardMetaData:JSON.stringify({...t?.feedbackContextData,prompt:B.WN,promptId:B.dB}),sydneyContextData:{conversationId:W.c.chatSessionId,sydneyEndpoint:(0,j.cy)(),requestId:B.dB,utteranceTimeStamp:(new Date).toISOString(),feedbackMessageId:(0,j.Xf)(),locale:(0,j.Tw)()},feedbackContextData:{...t?.feedbackContextData,prompt:B.WN,promptId:B.dB},groundingSource:(0,G.ZQ)(),entryPoint:F.K.Chat,enabledPlugins:this.getEnabledPlugins()}}),this.getFeedbackData=()=>{let e=this.copilotCommunicationHandler.getFeedbackData();return e&&e?.contextData||(e=(0,z.K)(e?.feedbackArea,e?.contextData)),e},this.getEnabledPlugins=()=>this.pluginDataProvider?this.pluginDataProvider.getEnabledPlugins():[],this.submitRichTextChatMessage=e=>{const t=e.chatMessage,n=e.chatMessageType,o=e.chatMessageData,r=e.chatMessageBodyData;(0,N.UA)()&&n!==w._.FeedbackNudge&&(0,L.dh)(t,(0,L.CL)(o,n),t.body?.user===M.Q9.Human,r.isFailure,r.aiResponseMetadata,this.featureFlags,this.getEnabledPlugins(),this.gptId)},this.copilotCommunicationHandler=t,this.setChatLog=e,this.pluginDataProvider=n,this.featureFlags=o,this.gptId=r,this.shouldSupportCitationsInAvalon=!1,Cn.getBrandingById=i}static convertResponseMessageToChatMessage(e,t,n){let o;try{o=JSON.parse(n.telemetryData)}catch(e){(0,N.cY)("Error parsing telemetry data in chat message builder",e.message)}return{messageType:e,body:Cn.getChatMessageBody(e,t),feedbackData:n.feedbackData,shouldShowProgressSpinner:n.shouldShowProgressSpinner,shouldShowAIGeneratedIndicator:n.shouldShowAIGeneratedIndicator,shouldShowAIPoweredIndicator:n.shouldShowAIPoweredIndicator,feedbackSectionPosition:n.feedbackSectionPosition,showMinifiedUI:n.showMinifiedUI,showAnimation:n.showAnimation,actionBarButtons:n.actionButtonList,strikeThroughText:n.strikeThroughText,references:n.references,pillsList:n.pillsList,handleShowMeOnClick:n.handleShowMeOnClick,warningActionButtons:n.warningActionButtons??void 0,clpSensitivityIndicatorData:n.clpSensitivityIndicatorData??void 0,telemetryData:JSON.stringify(void 0===o?{correlationId:B.dB}:{...o,correlationId:o.correlationId||B.dB}),messageId:n.messageId,msgExtCardProps:n.msgExtCardProps,apiPluginCardProps:n.apiPluginCardProps,pluginAuthError:n.pluginAuthError,chatMessageHeaderData:n.chatMessageHeaderData,progressSpinnerData:n.progressSpinnerData?n.progressSpinnerData:void 0,chatHydrationKeys:n.chatHydrationKeys,messageAttributionProps:Cn.getMessageAttributionPropsForBranding(n.messageAttributionProps),feedbackCategory:n.feedbackCategory,debugInfo:n.debugInfo,shouldShowCopyButton:n.shouldShowCopyButton,shouldShowHandoffButton:n.shouldShowHandoffButton,shouldShowReadAloudButton:n.shouldShowReadAloudButton}}setChatMessageData(e,t,n={shouldShowAIGeneratedIndicator:!1,showAnimation:!1,feedbackData:this.getFeedbackData(),isFailure:!1,showMinifiedUI:!1,feedbackSectionPosition:k.O.None,aiResponseMetadata:void 0,actionButtonList:void 0,strikeThroughText:!1,references:void 0,pillsList:void 0,handlePillOnClick:void 0,handleShowMeOnClick:void 0,warningActionButtons:void 0,clpSensitivityIndicatorData:void 0,telemetryData:void 0,messageId:void 0,msgExtCardProps:void 0,apiPluginCardProps:void 0,pluginAuthError:void 0,chatMessageHeaderData:void 0,progressSpinnerData:void 0,messageAttributionProps:void 0,shouldShowCopyButton:void 0,shouldShowHandoffButton:void 0,shouldShowReadAloudButton:void 0},o=!0,r){this.setChatLog((i=>{const a=[...i];return this.addChatMessage(a,e,t,n,o,r)}))}getProps(e,t){return this.shouldSupportCitationsInAvalon=t?.shouldSupportCitationsInAvalon??!1,{chatLog:this.featureFlags.isOutputV2Enabled?this.convertToOutputV2(e):e,shouldShowFeedbackButtons:t?.showFeedbackButtons??!0,shouldSupportCitationsInAvalon:t?.shouldSupportCitationsInAvalon??!1,handleChatCardThumbsUpClick:this.handleThumbsUpClick,handleChatCardThumbsDownClick:this.handleThumbsDownClick,handleChatCardSendFeedbackClick:this.handleSendFeedbackClick,useFluentAIGeneratedIndicator:t?.useFluentAIGeneratedIndicator??!1,copilotModeOverride:t?.copilotModeOverride}}convertToOutputV2(e){return e.map((e=>e={...e,outputV2Props:this.getChatOutputV2Props(e)}))}updateLastMessage(e,t,n,o=!0){this.setChatLog((r=>{const i=[...r],a=(0,N.y6)(i);if(-1===a)return(0,N.cY)("Error: No chat message found to update."),i;return this.updateChatMessage(i,e,t,n,o,a)}))}updateMessage(e,t,n,o=!0){void 0!==n?.messageId?this.setChatLog((r=>{const i=[...r],a=i.findIndex((e=>e.messageId===n.messageId));return-1===a?((0,N.cY)(`chat message is not found with message id : ${n.messageId}`),i):this.updateChatMessage(i,e,t,n,o,a)})):(0,N.cY)("Error: No message id found to update.")}getLastHumanMessageIndex(e){for(let t=(0,N.y6)(e,!1);t>=0;t--)if(e[t].body.user===M.Q9.Human)return t}addChatMessage(e,t,n,o,r=!0,i){const a=Lt(o,this.featureFlags?.addExtensibiltyDataToFeedbackOCV);let s=Cn.convertResponseMessageToChatMessage(t,n,a);this.featureFlags.isOutputV2Enabled&&(s={...s,outputV2Props:this.getChatOutputV2Props(s,a.isFailure)}),!this.featureFlags.isOutputV2Enabled&&this.featureFlags.isSccReadAloudEnabled&&(s={...s,readAloudActionButtonProps:this.getReadAloudActionButtonUIPropsV1(s)});const l=[...e,s];this.featureFlags.isSaveSharePromptEnabled&&this.featureFlags.isOutputV2Enabled&&this.updateActionBarOnLastUserMessage(l);const c={chatMessageType:t,chatMessageData:n,chatMessageBodyData:a,chatMessage:s};return r?this.submitRichTextChatMessage(c):i&&i.push(c),l}updateChatMessage(e,t,n,o,r=!0,i){const a=o?Lt(o,this.featureFlags?.addExtensibiltyDataToFeedbackOCV):void 0,s=[...e],l=s.at(i);return l&&l.messageType!==t?((0,N.cY)("Error: Chat message type is not matching with the message type of existing chat message"),s):(l&&(n&&void 0!==l?.body&&(l.body=Cn.getChatMessageBody(t,n)),a&&Object.entries(a).forEach((([e,t])=>{"actionButtonList"===e?l.actionBarButtons=t:"messageAttributionProps"===e?l.messageAttributionProps=Cn.getMessageAttributionPropsForBranding(t):void 0!==t&&(l[e]=t)})),this.featureFlags.isOutputV2Enabled&&(l.outputV2Props=this.getChatOutputV2Props(l)),!this.featureFlags.isOutputV2Enabled&&this.featureFlags.isSccReadAloudEnabled&&(l.readAloudActionButtonProps=this.getReadAloudActionButtonUIPropsV1(l)),r&&(0,N.UA)()&&(n||(n=this.getChatMessageData(l.body,t)),(0,L.dh)(l,(0,L.CL)(n,t),l.body?.user===M.Q9.Human,a?.isFailure,a?.aiResponseMetadata,this.featureFlags,this.getEnabledPlugins(),this.gptId))),s)}deleteMessage(e,t){t?this.setChatLog((n=>{const o=[...n];for(let n=o.length-1;n>=0;n--){const r=o[n];if(r.messageId===t&&r.messageType===e){o.splice(n,1);break}}return o})):(0,N.cY)("Error: Message id is not provided to delete the chat message")}getChatMessageData(e,t){const n={};switch(t){case w._.ContentCard:n.contentCardProps=e;break;case w._.AccordionCard:n.accordionCardProps=e;break;case w._.ChatCardWrapper:n.chatCardWrapperProps=e;break;case w._.SelfHelpAdaptiveCard:n.selfHelpAdaptiveCardProps=e;break;case w._.StreamingAdaptiveCard:n.streamingAdaptiveCardProps=e;break;case w._.MarkdownCard:n.markDownCardProps=e;break;case w._.WarningMessage:n.warningMessageCardProps=e;break;case w._.ProactiveSuggestionCard:n.proactiveSuggestionCardProps=e;break;case w._.SlideLinksCard:n.slideLinksCardProps=e;break;case w._.SystemMessage:n.systemMessageProps=e;break;default:n.defaultMessageProps=e}return n}getChatLog(){let e=[];return this.setChatLog((t=>e=t)),e}}Cn=bn,bn.getFeedBackNudgeMessageBody=e=>({imageSrc:e}),bn.getChatMessageBody=(e,t)=>{let o;switch(e){case w._.ContentCard:o={...t.contentCardProps};break;case w._.AccordionCard:o={...t.accordionCardProps};break;case w._.ChatCardWrapper:o={...t.chatCardWrapperProps};break;case w._.FeedbackNudge:o=Cn.getFeedBackNudgeMessageBody(n(20434));break;case w._.SelfHelpAdaptiveCard:o={...t.selfHelpAdaptiveCardProps};break;case w._.StreamingAdaptiveCard:o={...t.streamingAdaptiveCardProps};break;case w._.MarkdownCard:o={...t.markDownCardProps};break;case w._.CopilotWorkflowMessage:o={...t.copilotWorkflowsCardProps};break;case w._.WarningMessage:o={...t.warningMessageCardProps};break;case w._.PaginatedCard:o={...t.paginatedCardProps};break;case w._.ProactiveSuggestionCard:o={...t.proactiveSuggestionCardProps};break;case w._.SlideLinksCard:o={...t.slideLinksCardProps};break;case w._.ReviewerSummaryCard:o={...t.reviewerSummaryCardProps};break;case w._.ReviewAgentCard:o={...t.reviewAgentCardProps};break;case w._.AgentPlanBuilderCard:o={...t.agentPlanBuilderCardProps};break;case w._.PlanBuilderCard:o={...t.planBuilderCardProps};break;case w._.SystemMessage:o={...t.systemMessageProps};break;case w._.SketchImageCard:o={...t.sketchImageMessageProps};break;case w._.InterstitialMessage:o={...t.interstitialMessageProps};break;default:o={...t.defaultMessageProps}}return o},bn.getMessageAttributionPropsForBranding=e=>{if(e){if(e.id)try{const t=Cn.getBrandingById?.(e.id);return t}catch(t){return e}return e}}},115:(e,t,n)=>{n.d(t,{c:()=>b});var o,r=n(89994),i=n(35373),a=n(34996),s=n(38292),l=n(59777),c=n(33500),u=n(90922),d=n(36199),p=n(26532),h=n(66503),g=n(37426);class f{constructor(e,t,n,o,f,m,y,v,C,b,E){this.getMenuProps=e=>{this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(c.WT.IsSharedCopilotLabEnabled)&&(!this.menuProps.copilotLabProps&&e.length>0&&(this.menuProps.copilotLabProps={copilotLabMenuItemText:this.copilotLabMenuItemText,iconRegular:d.a$3,iconHover:d.e13}),this.menuProps.copilotLabProps&&(this.menuProps.copilotLabProps.handleOnClickCopilotLab=g.t_));return{promptGuideMenuData:this.menuProps.promptGuideMenuData,copilotLabProps:this.menuProps.copilotLabProps,handleOnClickStarterPromptMenuItem:this.handleOnClickMenuItem,handleOnClickPromptGuideMenuButtonTelemetry:this.handleOnClickMenuButtonTelemetry,shouldBlockPromptGuideLaunch:this.shouldBlockPromptGuideLaunch}},this.shouldBlockPromptGuideLaunch=()=>this.setPaneLoadMessageIfApplicable(c.Ku.PromptGuide),this.handleOnClickMenuButtonTelemetry=()=>{this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.MenuButtonClicked}])},this.handleOnClickMenuItem=(e,t,n,o)=>{let s=e,c=r.u1;if(!t)return this.loggingEventHandler.sendLoggingEventToClient(l.Yk.MenuButtonItemClickedL1,{suggestionClicked:e}),void this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.MenuL1SuggestionClicked},{key:u.h3.ChatEventParameters,value:e}]);(0,h.$w)(r.u1),this.loggingEventHandler.sendLoggingEventToClient(l.Yk.MenuButtonItemClicked,{suggestionClicked:e}),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.MenuL2SuggestionClicked}]),this.isFreVisible&&this.setFreVisible(!1),e.endsWith(r.Gr)&&(s=s.slice(0,-r.Gr.length)+" "),this.immediateActionableQueries[e]?(this.chatInputRef.current?.setInputText(r.u1),this.chatInputRef.current?.setGhostText(this.chatPlaceholderMessage),this.handleSubmit({text:s})):(this.updateHintCard(e),n&&(s=s.replace(/ *\([^)]*\)/,r.cv),c=this.transformFilePlaceholderText),s=s.replace(/ *\[[^\]]*]/,r.u1),!this.editorService&&this.chatInputRef.current?.getChatEditorService&&(this.editorService=this.chatInputRef.current?.getChatEditorService()),n||(s+=" "),n&&this.editorService&&(this.editorService.setEntityScope(n),o&&(this.editorService.setUnsupportedEntities(o),(0,i.cY)("UnSupportedEntites:",o))),this.chatInputRef.current?.setInputText(s),this.chatInputRef.current?.setFocus(),n&&this.editorService&&setTimeout((()=>this.chatInputRef.current?.updateInputText(r.O8,a.v.InsertAtCursor)),1),this.chatInputRef.current?.setGhostText(c)),(0,i.cY)("Suggestion clicked: "+e)},this.generateQueryMap=()=>{const e={};this.menuProps.promptGuideMenuData.children?.forEach((function(t){t.children?.forEach((function(t){"ActionSet"===t.nodeType&&(e[t.text]=t.data?.shouldSubmitQueryOnClick)}))})),this.immediateActionableQueries=e},this.chatInputRef=t,this.menuProps=e,this.handleSubmit=n,t.current?.getChatEditorService&&(this.editorService=t.current?.getChatEditorService()),this.chatPlaceholderMessage=v,this.generateQueryMap(),this.updateHintCard=C,this.isFreVisible=o,this.setFreVisible=f,this.transformFilePlaceholderText=y,this.copilotCommunicationHandler=m,this.loggingEventHandler=s.A.getInstance(),this.telemetryLoggerUtils=p.j.getInstance(),this.setPaneLoadMessageIfApplicable=b,this.copilotLabMenuItemText=E}}!function(e){e.Backspace="Backspace",e.Escape="Escape",e.Delete="Delete",e.V="V"}(o||(o={}));var m=n(1382),y=n(35282),v=n(98483),C=n(6394);class b{constructor(e,t,n,a,d,g,b,E,A,S,I,P,T,x,w,k,_,D,F,L,O,R,M,B,N,V,H,U,j,z,G,W,q,Q,K,Y,$,J,X,Z,ee,te,ne,oe,re,ie,ae,se,le,ce,ue,de,pe,he,ge,fe){this.addTelemetryToEditorConfig=e=>{const t=p.j.getInstance();if(!e?.telemLogger)return e;const n={...e};return n.telemLogger.logErrorTelemetry=(e,n)=>{t.sendTelemetryErrorData([{key:u.IC.ErrorMessage,value:n},{key:u.IC.ErrorCategory,value:e}])},n.telemLogger.logSuccessTelemetry=(e,n)=>{n?t.sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:e},{key:u.h3.ChatEventParameters,value:n}]):t.sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:e}])},n},this.handleOnInput=e=>(this.isFreVisible&&this.setFreVisible(!1),this.chatInputRef.current?.getInputText()===r.u1&&(this.updateHintCard(r.u1),(0,h.$w)(r.u1),this.loggingEventHandler.sendLoggingEventToClient(l.Yk.InputAreaTextChangedToEmpty)),!0),this.handleWarmUpQuery=async()=>{try{const e=(0,v.A)(),t=this.copilotCommunicationHandler.isFeatureGateEnabledFromClient(c.WT.IsCopilotPluginEnabled)&&this.pluginDataProviderRef.current?.getEnabledPlugins()||[],n=await this.copilotCommunicationHandler.getDefaultSignalOperation("",e,C.c.currentChatId,void 0,void 0,t,void 0,this.selectedSwitcherMenuItemId,this.atMentionApp,void 0,!0);(0,m.RJ)(!0),y.E.getInstance().submitOperation(n.operation,n.workflowAnnotationType),this.warmedUpQueryIdRef.current=e}catch(e){p.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.SubmitWarmUpQuerySignalFailed}])}},this.getGroundingSourcePickerProps=()=>{if(this.groundingSourcePickerProps)return{...this.groundingSourcePickerProps,onSelection:e=>{(0,m.gE)(e.id),this.groundingSourcePickerProps.onSelection&&this.groundingSourcePickerProps.onSelection(e)}}},this.getProps=(e,t,n,a)=>{let s=this.editorProps?.editorConfig;s&&void 0===s.ciqPlaceholderText&&(this.editorProps.editorConfig.ciqPlaceholderText=this.ciqPlaceholderText),s=this.addTelemetryToEditorConfig(s);return{isDisabled:this.isDisabled,setIsDisabled:this.setIsDisabled,isSubmitButtonDisabled:this.isSubmitButtonDisabled,copilotChatTheme:this.copilotTheme,isDarkMode:this.isDarkModeEnabled,dir:this.dir,placeholderText:this.chatPlaceHolderMessage,restShyPlaceholderText:this.chatRestShyPlaceholderMessage,isMenuButtonEnabled:this.isMenuButtonEnabled??!0,isCIQButtonEnabled:this.isCIQButtonEnabled,isAtMentionButtonEnabled:this.isAtMentionButtonEnabled,isGroundingButtonEnabled:this.isGroundingButtonEnabled,characterLimitErrorMessage:this.characterLimitErrorMessage,handleSubmitButtonClick:(e,t,n)=>{let o=t;this.loggingEventHandler.sendLoggingEventToClient(l.Yk.SubmitButtonClicked),this.ciqResponseHandler||(this.ciqResponseHandler=this.chatInputRef.current.getCIQResponseHandler());const r=this.chatInputRef.current?this.ciqResponseHandler?.generatCopilotOdslSignalLinks(this.chatInputRef.current.getInputSpanElement()):void 0;this.editorProps?.handleInChatInput||(o=this.chatInputRef.current?this.ciqResponseHandler?.generateQueryAnnotations(this.chatInputRef.current.getInputSpanElement()):void 0),this.handleSubmit({text:e,links:r,telemetryData:u.a5.SubmitButtonClicked,queryAnnotations:o,entityList:n})},handleKeyDown:e=>{const t=this.chatInputRef.current;if(!t)return!1;const n=t?.getInputText(),a=t?.getGhostText();if(e.ctrlKey&&e.key.toLowerCase()===o.V)t?.setGhostText(r.u1);else{if("Enter"===e.key){if(e.preventDefault(),this.shouldBlockSubmitButtonClick())return;if(this.isSubmitButtonDisabled||this.isDisabled)return!1;if(e.shiftKey)return!0;{if(n.trimStart()===r.u1)return!1;this.ciqResponseHandler||(this.ciqResponseHandler=this.chatInputRef.current.getCIQResponseHandler());const e=this.ciqResponseHandler?.generatCopilotOdslSignalLinks(this.chatInputRef.current.getInputSpanElement()),o=this.chatInputRef.current?this.ciqResponseHandler?.generateQueryAnnotations(this.chatInputRef.current.getInputSpanElement()):void 0;return t?.setInputText(r.u1),t?.setGhostText(this.chatPlaceHolderMessage),this.handleSubmit({text:n,links:e,queryAnnotations:o}),!1}}e.key===o.Backspace?(!this.editorService&&this.chatInputRef.current?.getChatEditorService&&(this.editorService=this.chatInputRef.current?.getChatEditorService()),this.editorService&&n.length>1&&(0,i.gE)()&&(0,i.Ey)()===n.length&&n.slice(-1)===r.O8?t?.setGhostText(r.O8+this.ciqPlaceholderText):0!==(0,i.Ey)()&&a!==r.u1&&t?.setGhostText(r.u1)):(e.key===o.Escape||e.key===o.Delete&&(0,i.Ey)()!==n.length&&a!==r.u1)&&t?.setGhostText(r.u1)}return!0},handleOnBeforeInput:e=>{const t=this.chatInputRef.current;return!!t&&(!this.editorService&&this.chatInputRef.current?.getChatEditorService&&(this.editorService=this.chatInputRef.current?.getChatEditorService()),e.data!==r.O8||!this.editorService||(t?.setGhostText(this.ciqPlaceholderText),!1))},handleOnChatInputControlMount:()=>{this.setChatInputControlMounted(!0)},handleOnChatInputControlUnmount:()=>{this.setChatInputControlMounted(!1)},promptGuideMenuProps:this.menuBuilder?.getMenuProps(e),handleOnInput:this.handleOnInput,voiceInputProps:this.voiceInputProps,groundingSourcePickerProps:this.getGroundingSourcePickerProps(),groundingButtonPluginProps:this.groundingButtonPluginProps,shouldBlockGroundingButtonClick:this.shouldBlockGroundingButtonClick,shouldBlockSubmitButtonClick:this.shouldBlockSubmitButtonClick,handleFirstUserInput:this.handleFirstUserInput,handleChatInputLoad:this.handleChatInputLoad,editorProps:this.editorProps,isSensitivityIndicatorLoading:this.isSensitivityIndicatorLoading,imageInputEnabled:this.imageInputEnabled,isHVCAppChatV2Enabled:this.enableHVCAppChatV2,hvcPromptStrings:this.hvcPromptStrings,hvcPromptStringsList:this.hvcPromptStringsList,useSortedHVCTokenList:this.useSortedHVCTokenList,chatInputBannerProps:t,onChatInputHVCPromptUpdated:this.onChatInputHVCPromptUpdated,isImageInputButtonEnabled:this.isImageInputButtonEnabled,imageSizeLimitInMB:this.imageSizeLimitInMB,isImageResizeEnabled:this.isImageResizeEnabled,imageResizedSizeLimitInKB:this.imageResizedSizeLimitInKB,imageResizePreferredSizeInPx:this.imageResizePreferredSizeInPx,imageResizeQuickDimensionsReductionMultiplier:this.imageResizeQuickDimensionsReductionMultiplier,imageResizeSlowDimensionsReductionMultiplier:this.imageResizeSlowDimensionsReductionMultiplier,imageResizeCompressionQuality:this.imageResizeCompressionQuality,imageResizeFormatType:this.imageResizeFormatType,isScreenshotButtonEnabled:this.isScreenshotButtonEnabled,getScreenshot:this.getScreenshot,telemetryLogger:(0,i.Nk)(),isMinified:n,setAtMentionApp:this.setAtMentionApp,atMentionApp:this.atMentionApp,sendWarmupSignal:this.handleWarmUpQuery,isStartOfQueryRef:this.isStartOfQueryRef,shouldInitializeCIQ:this.shouldInitializeCIQ,insertImageFlags:this.insertImageFlags,getCanvasSelection:this.copilotCommunicationHandler.getCanvasSelection,isGPTCopilotSelected:a}},this.shouldBlockGroundingButtonClick=()=>this.setPaneLoadMessageIfApplicable(c.Ku.GroundingButton),this.shouldBlockSubmitButtonClick=()=>this.setPaneLoadMessageIfApplicable(c.Ku.SubmitButton),this.handleFirstUserInput=()=>{p.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.FirstUserInputReceived},{key:u.h3.ChatEventParameters,value:(new Date).getTime().toString()}])},this.handleChatInputLoad=()=>{p.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.ChatInputLoaded},{key:u.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),window.performance.mark(r.Nn)},this.setIsDisabled=g,this.chatInputRef=e,this.copilotTheme=t,this.isDarkModeEnabled=n,this.dir=a,this.isDisabled=d,this.isSubmitButtonDisabled=b,this.handleSubmit=P,this.isFreVisible=E,this.setFreVisible=A,this.copilotCommunicationHandler=S,this.updateHintCard=T,this.chatPlaceHolderMessage=D??D,this.chatRestShyPlaceholderMessage=F,this.ciqPlaceholderText=w,this.ciqResponseHandler=_,this.loggingEventHandler=s.A.getInstance(S),this.setPaneLoadMessageIfApplicable=H,e.current?.getChatEditorService&&(this.editorService=e.current?.getChatEditorService()),this.menuBuilder=I?new f(I,e,P,E,A,this.copilotCommunicationHandler,x,this.chatPlaceHolderMessage,T,this.setPaneLoadMessageIfApplicable,pe):void 0,this.setChatInputControlMounted=k,this.voiceInputProps=L,this.isCIQButtonEnabled=O,this.isAtMentionButtonEnabled=R,this.isGroundingButtonEnabled=M,this.isMenuButtonEnabled=B,this.groundingSourcePickerProps=N;const me=V?.plugins?.map((e=>({...e,onToggle:t=>{(0,m.gE)(`${e.id}:${t?"On":"Off"}`),e.onToggle&&e.onToggle(t)}})))??[];this.groundingButtonPluginProps={...V,plugins:me},this.editorProps=U??void 0,this.isSensitivityIndicatorLoading=j,this.characterLimitErrorMessage=K,this.imageInputEnabled=Y,this.enableHVCAppChatV2=$??!1,this.hvcPromptStrings=J,this.hvcPromptStringsList=X,this.useSortedHVCTokenList=ee,this.onChatInputHVCPromptUpdated=Z,this.isImageInputButtonEnabled=te,this.imageSizeLimitInMB=ne,this.isImageResizeEnabled=oe,this.imageResizedSizeLimitInKB=re,this.imageResizePreferredSizeInPx=ie,this.imageResizeQuickDimensionsReductionMultiplier=ae,this.imageResizeSlowDimensionsReductionMultiplier=se,this.imageResizeCompressionQuality=le,this.imageResizeFormatType=ce,this.isScreenshotButtonEnabled=ue,this.getScreenshot=de,this.setAtMentionApp=z,this.atMentionApp=G,this.isStartOfQueryRef=q,this.warmedUpQueryIdRef=W,this.pluginDataProviderRef=Q,this.handleWarmUpQuery=this.handleWarmUpQuery.bind(this),this.shouldInitializeCIQ=he,this.insertImageFlags=ge,this.selectedSwitcherMenuItemId=fe}}},17100:(e,t,n)=>{n.d(t,{Dk:()=>u,LX:()=>d,UU:()=>c,V6:()=>f,iB:()=>g,k6:()=>p,xU:()=>y});var o=n(28087),r=n(90922),i=n(26532),a=n(69290),s=n(70046),l=n(89994);const c=e=>{e((e=>e?.filter((e=>e.messageType!==o._.InterstitialMessage))))},u=e=>{const t={};return e.forEach((e=>{const n=e.source??s.L.Static;t[n]=(t[n]||0)+1})),t},d=(e,t)=>{if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n].promptSuggestionText!==t[n].promptSuggestionText)return!0;return!1},p=(e,t)=>{let n=l.u1;if(0==e.length)return n;for(let o=0;o<e.length;o++)if(h(e[o].promptSuggestionText,t))return n=e[o].source??s.L.Static,n;return n},h=(e,t)=>{const n=(e=e.replace(/\[.*?\]/g,".*")).replace(/\s+/g," "),o=t.replace(/\s+/g," ");return new RegExp(n).test(o)},g=e=>void 0!==e,f=(e,t,n,o)=>{const a=m(o),s=i.j.getInstance();(n||a)&&s.sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:n?r.a5.InputSignalSwitcherMenuGptId:r.a5.InputSignalAtMentionGptId},{key:r.h3.IsMicrophoneInvolvedInQueryInput,value:e.toString()},{key:r.h3.UserQueryGuid,value:t},{key:r.h3.ChatEventParameters,value:n??a??""}])},m=e=>{if(e&&e.appType===a.b.GPT)return e.appId},y=(e,t,n)=>{if(t&&t.length>0){const n=t.map((e=>e.QueryAnnotationType));e.sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.PromptSubmittedWithCIQ},{key:r.h3.ChatEventParameters,value:JSON.stringify(n)}])}const o={TotalFile:0,CloudFile:0,LocalFile:0,FileUrl:0,CiqFile:0};n?.forEach((e=>{"File"===e.data?.entity?.entityType?o.CiqFile++:"CloudFile"===e.data?.entity?.entityType?o.CloudFile++:"FileUrl"===e.data?.entity?.entityType?o.FileUrl++:"LocalFile"===e.data?.entity?.entityType&&o.LocalFile++})),Object.keys(o).length>0&&(o.TotalFile=Object.values(o).reduce(((e,t)=>e+t)),o.TotalFile>0&&e.sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.PromptSubmittedWithFileEntity},{key:r.h3.ChatEventParameters,value:JSON.stringify(o)}]))}},22330:(e,t,n)=>{n.d(t,{zn:()=>ud,xJ:()=>gd,WU:()=>hd,vD:()=>dd,sU:()=>ad,qD:()=>id,$m:()=>yd,Gs:()=>nd,WN:()=>ld,dB:()=>sd,EU:()=>cd});var o=n(63758),r=n(49118),i=n(24762),a=n(6049),s=n(17678),l=n(30685),c=n(8520),u=n(46961),d=n(78185),p=n(53357),h=n(48829),g=n(90922),f=n(4801);const m="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162";class y{static getInstance(){return y.telemetryLogger||(y.telemetryLogger=new y),y.telemetryLogger}getDefaultEventFlags(){return{}}logEvent(e,t){this.logTelemetryEvent(e,t)}logError(e,t){this.logTelemetryErrorEvent(e,t),this.telemetryEventHandler.updateTelemetryQueryDetailsEventData({[g.tw.ErrorCategory]:e.eventType,[g.tw.ErrorMessage]:e.errorMessage})}constructor(){this.oTelLogger=new d.M,this.setupTelemetryLogger(this.oTelLogger),this.telemetryEventHandler=u.E.getInstance()}logTelemetryEvent(e,t){const n={telemetryProperties:{ariaTenantToken:m,nexusTenantToken:1763},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?{...t,...this.getDefaultEventFlags()}:this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)}logTelemetryErrorEvent(e,t){const n={eventName:"Office.Voice.ActionAI."+f.S2.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?{...t,...this.getDefaultEventFlags()}:this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:"CopilotChatSessionId",value:h.w.getSessionId()}])};this.oTelLogger.sendError(n)}getDataFields(e){return e.map((e=>"number"==typeof e.value?(0,p.ip)(e.key,e.value):"string"==typeof e.value?(0,p.m9)(e.key,e.value):"boolean"==typeof e.value?(0,p.LK)(e.key,e.value):(0,p.m9)(e.key,e.value)),[])}setupTelemetryLogger(e){e.setTenantToken("Office.Voice.ActionAI",m,1763)}}var v=n(89994),C=n(22663),b=n(70737),E=n(18023),A=n(115),S=n(8154),I=n(27635);var P=n(77228),T=n(30112),x=n(658);const w=(0,x.n)({root:{display:"flex",alignItems:"center"},inputWrapper:{borderTopWidth:0},inputWrapperGridStyles:{gridTemplateColumns:"1fr auto auto",borderRadius:"12px","&::after":{left:"3px",right:"3px"}}}),k=c.forwardRef(((e,t)=>{const n=(e=>{var t;const{serviceProvider:{useVoiceInput:n,useLocalFiles:o,useCiq:r,useEntityPlugin:i,useCloudFiles:a,useAttachmentList:s,useHydratedEntityPlugin:l,useInputMessages:u,usePromptSuggestions:d,useElaboratePromptPlugin:p}}=(0,I.Ay)(),h=n(),g=p(),{ChatInputMessages:f,service:m}=u(),{FilePicker:y,useDragAndDropStyle:v}=o(),C=v(),b=w(),{ciqPlugin:E}=r(),{entityPlugin:A}=i(),{cloudFilePickerCallout:S}=a(),{attachmentList:x}=s(),{hydratedEntityPlugin:k}=l(),{promptListbox:_,cursorPositionPlugin:D,containerRef:F,onChange:L,onSubmit:O,onBlur:R,onFocus:M,onKeyDown:B,isPromptAutocompleteSelectMode:N}=d(),{enableSharedInputControlSimplification:V}=e;if(E&&!A)throw new Error("Entity plugin is required for CIQ plugin");if(y&&!A)throw new Error("Entity plugin is required for local files plugin");const H=c.useCallback(((e,t)=>N?void 0:(0,P.p)(t,e)),[N]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),void 0===e.attachments&&{attachments:x}),_?{listbox:_}:{}),F?{root:{ref:F}}:{}),L?{onChange:(0,P.p)(e.onChange,L)}:{}),O?{onSubmit:H(e.onSubmit,O)}:{}),R?{onBlur:(0,P.p)(e.onBlur,R)}:{}),M?{onFocus:(0,P.p)(e.onFocus,M)}:{}),B?{onKeyDown:(0,P.p)(e.onKeyDown,B)}:{}),{actions:Object.assign(Object.assign({},e.actions),{children:c.createElement("span",{className:b.root},null===(t=e.actions)||void 0===t?void 0:t.children,null==h?void 0:h.microphoneButton,null==g?void 0:g.elaboratePromptButton,y&&c.createElement(y,null))}),children:c.createElement(c.Fragment,null,e.children,null==h?void 0:h.ghostTextPlugin,A,E,S,k,D||c.createElement(c.Fragment,null)),banner:(null==m?void 0:m.messages.length)&&(null==m?void 0:m.messages.length)>0&&f?c.createElement(f,null):void 0,inputWrapper:{className:(null==f?void 0:f())?(0,T.z)(b.inputWrapper,V&&b.inputWrapperGridStyles):V?b.inputWrapperGridStyles:void 0},className:(0,T.z)(e.className,C)})})(e);return((e,t)=>{const{serviceProvider:n}=(0,I.Ay)(),{LocalFilesInputWrapper:o,styles:r}=n.useLocalFiles(),i=c.createElement(c.Fragment,null,c.createElement(S.V,Object.assign({ref:t},e)));return o?c.createElement(o,{style:r},i):i})(n,t)}));k.displayName="ChatInput";var _={doc:"Word",docb:"Word",docm:"Word",docx:"Word",note:"OneNoteSection",one:"OneNoteSection","ms-one-stub":"OneNoteNotebook",onepkg:"OneNoteNotebook",onetoc:"OneNoteNotebook",onetoc2:"OneNoteNotebook",pdf:"PDF",ai:"Photo",arw:"Photo",bmp:"Photo",cr2:"Photo",crw:"Photo",cur:"Photo",dcm:"Photo",dcm30:"Photo",dcr:"Photo",dds:"Photo",dib:"Photo",dic:"Photo",dicm:"Photo",dng:"Photo",epi:"Photo",eps:"Photo",epsf:"Photo",erf:"Photo",gif:"Photo",heic:"Photo",heif:"Photo",ico:"Photo",icon:"Photo",jfi:"Photo",jfif:"Photo",jif:"Photo",jpe:"Photo",jpeg:"Photo",jpg:"Photo",kdc:"Photo",mrw:"Photo",nef:"Photo",nrw:"Photo",orf:"Photo",pct:"Photo",pef:"Photo",pict:"Photo",png:"Photo",pns:"Photo",ps:"Photo",psb:"Photo",psd:"Photo",raw:"Photo",rw2:"Photo",sr2:"Photo",svg:"Photo",tga:"Photo",tif:"Photo",tiff:"Photo",wdp:"Photo",webp:"Photo",xbm:"Photo",xcf:"Photo",xpm:"Photo",ppt:"PowerPoint",pptm:"PowerPoint",pptx:"PowerPoint",sldm:"PowerPoint",sldx:"PowerPoint",htm:"Web",html:"Web",mht:"Web",dif:"Plaintext",diff:"Plaintext",out:"Plaintext",plist:"Plaintext",properties:"Plaintext",readme:"Plaintext",text:"Plaintext",txt:"Plaintext",xlc:"Excel",xls:"Excel",xlsb:"Excel",xlsm:"Excel",xlsx:"Excel",xlw:"Excel",eml:"Outlook",ical:"Outlook",icalendar:"Outlook",ics:"Outlook",ifb:"Outlook",msg:"Outlook",oft:"Outlook",ost:"Outlook",pst:"Outlook",vcf:"Outlook",vcs:"Outlook",mts:"Video",m2ts:"Video",ts:"Video","3g2":"Video","3gp":"Video","3gp2":"Video","3gpp":"Video",asf:"Video",wmv:"Video",avi:"Video",m4v:"Video",mov:"Video",mp4:"Video",mp4v:"Video",ogg:"Video",webm:"Video",movie:"Video",mkv:"Video",mpg:"Video",mpeg:"Video",vdw:"Visio",vdx:"Visio",vsd:"Visio",vsdm:"Visio",vsdx:"Visio",vss:"Visio",vssm:"Visio",vssx:"Visio",vst:"Visio",vstm:"Visio",vstx:"Visio",vsw:"Visio",vsx:"Visio",mpd:"Project",mpp:"Project",mpt:"Project",sway:"Sway"},D=["doc","docm","docx","dotx","odp","ods","odt","pot","potm","potx","pps","ppsx","ppt","pptm","pptx","rtf","xls","xlsb","xlsm","xlsx","eml","msg","pdf","vsd","vsdx"],F=["3g2","3gp","3gp2","3gpp","asf","avi","m2ts","m4v","mkv","mov","movie","mp4","mp4v","mpeg","mpg","mts","ogg","ts","webm","wmv"],L=["dwg","html","pdf","url","zip","msg","eml"];const O={doc:"application/msword",dot:"application/msword",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",docm:"application/vnd.ms-word.document.macroEnabled.12",docb:"application/vnd.ms-word.document.binary.macroEnabled.12",xls:"application/vnd.ms-excel",xlm:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.12",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",ppt:"application/vnd.ms-powerpoint",pps:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pptm:"application/vnd.ms-powerpoint.presentation.macroEnabled.12",txt:"text/plain",csv:"text/csv",pdf:"application/pdf"},R=e=>{return void 0!==((t=e)?_[t]:void 0)||e in D||e in F||e in L;var t},M=(e,t,n,o)=>({text:e.text,entityProps:{className:null!=n?n:"",text:Object.assign(Object.assign({as:"a"},e.url?{href:e.url,target:"_blank",rel:"noopener"}:{}),{"data-entity-id":e.id,"data-entity-type":e.entityType})},data:{entity:e,annotation:t,rawEntityData:o?{data:o,type:e.entityType}:void 0}}),B=(e,t,n)=>c.useCallback((()=>({addTempEntity:(t,o)=>{var r;null===(r=null==e?void 0:e.current)||void 0===r||r.insertChatInputEntity(M(t,o,n))},replaceEntity:(t,o,r,i)=>{var a;null===(a=null==e?void 0:e.current)||void 0===a||a.updateChatInputEntityProps((e=>{var t;return(null===(t=e.data)||void 0===t?void 0:t.entity.id)===r}),M(t,o,n,i))},removeEntity:t=>{var n;null===(n=null==e?void 0:e.current)||void 0===n||n.removeChatInputEntity((e=>{var n;return(null===(n=e.data)||void 0===n?void 0:n.entity.id)===t}))},closeCiq:()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.removeCiqChar()}})),[n,e,t]);function N(){const{inputContext:e,localFileContext:t,attachmentContext:n,getSharedCopilotLogger:o}=(0,I.Ay)(),{setAttachments:r}=n||{},{entityRef:i,insertCiqTriggerPluginRef:a}=e||{},s=B(i,a),{removeEntity:l,closeCiq:u,replaceEntity:d,addTempEntity:p}=s(),h=c.useCallback((e=>null==r?void 0:r((t=>t.map((t=>{var n;return(null===(n=t.data.entityElement)||void 0===n?void 0:n.id)===e.id?Object.assign(Object.assign({},t),{data:{entityElement:e}}):t}))))),[r]);if(!t)return{entityRef:i,filePickerRef:void 0,isFileBeingDragged:!1,setIsFileUploadInProgress:void 0,supportedFileExtensionMimeMap:O,duplicateFile:void 0,uploadErrors:void 0,dismissedPrivacyMessage:!1,removeEntity:l,closeCiq:u,replaceEntity:d,addTempEntity:p,updateEntity:void 0,setIsFileBeingDragged:void 0,setDuplicateFile:void 0,setUploadErrors:void 0,setDismissedPrivacyMessage:void 0,localFilesEntities:[],setLocalFilesEntities:void 0,getSharedCopilotLogger:o,isImageInputEnabled:!1,odbDataRef:void 0};const{uploadFileRef:g,supportedFileExtensionMimeMap:f,localFilesEntities:m,isFileBeingDragged:y,dismissedPrivacyMessage:v,duplicateFile:C,uploadErrors:b,setIsFileBeingDragged:E,setIsFileUploadInProgress:A,setDismissedPrivacyMessage:S,setDuplicateFile:P,setUploadErrors:T,setLocalFilesEntities:x,isImageInputEnabled:w,odbDataRef:k}=t;return{entityRef:i,filePickerRef:g,localFilesEntities:m,isFileBeingDragged:y,setIsFileUploadInProgress:A,duplicateFile:C,dismissedPrivacyMessage:v,uploadErrors:b,supportedFileExtensionMimeMap:f,removeEntity:l,closeCiq:u,replaceEntity:d,updateEntity:h,addTempEntity:p,setLocalFilesEntities:x,setDismissedPrivacyMessage:S,setDuplicateFile:P,setIsFileBeingDragged:E,setUploadErrors:T,getSharedCopilotLogger:o,isImageInputEnabled:w,odbDataRef:k}}function V({children:e}){const{setIsFileBeingDragged:t}=N();return c.createElement("div",{onDragEnter:e=>{e.stopPropagation(),e.preventDefault(),null==t||t(!0)},onDragLeave:e=>{e.stopPropagation(),e.preventDefault(),e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||null==t||t(!1)},onDragOver:e=>{e.stopPropagation(),e.preventDefault()}},e)}var H=n(74018),U=n(68779),j=n(21137),z=n(45857),G=n(62653);const W=(0,x.n)({button:{border:"none","@media (forced-colors: none)":{"&:hover":{color:G.L.colorBrandForeground1},"&:hover:active":{color:G.L.colorBrandForeground1}}}}),q=e=>{const t=W();return c.createElement(U.m,{content:"Add selection",relationship:"label",positioning:"above",withArrow:!0},c.createElement(j.$,{icon:c.createElement(z._6u,null),appearance:"outline",className:t.button,onClick:e.handleAddSelectionClick}))};var Q=n(57871),K=n(35571);const Y=(e,t)=>{const n=(0,K.A)(t,e);return c.createElement(n,null)},$=e=>{const t=e;return c.createElement(t,null)},J=(0,x.n)({activeIcon:{color:G.L.colorBrandForeground1},disabled:{color:G.L.colorNeutralForegroundDisabled},root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),X=({title:e,isDisabled:t,handleClick:n})=>{const o=J();return c.createElement("div",{className:o.root},c.createElement(U.m,{content:e,relationship:"label",withArrow:!0,positioning:"above"},c.createElement(j.$,{"aria-label":e,appearance:"transparent",role:"button",icon:{children:$(Q.HNj),className:t?o.disabled:void 0},onClick:n,disabled:t})))};var Z=n(15425),ee=n(80799),te=n(65593),ne=n(73805),oe=n(65127),re=n(26560),ie=n(92153),ae=n(88203),se=n(69290);function le(e){return[se.b.MessageExtension,se.b.PowerPlatform,se.b.OpenAIPlugin].includes(e?.appType)}var ce=n(18850);const ue=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.atMentionGpt");var de=n(16895);const pe=(0,x.n)({atMentionApp:{backgroundColor:G.L.colorNeutralBackground1,paddingTop:G.L.spacingVerticalS,paddingBottom:G.L.spacingVerticalS,...de.Pt.border(G.L.strokeWidthThin,"solid",G.L.colorNeutralStroke1),...de.Pt.borderBottom("0px"),...de.Pt.borderRadius("4px","4px","0px","0px")},atMentionAppMain:{display:"flex",flexWrap:"nowrap",...de.Pt.gap(G.L.spacingHorizontalXS)},atMentionGptLabel:{alignSelf:"center"},bannerTitle:{whiteSpace:"nowrap"},appIcon:{height:"16px",width:"16px",borderRadius:"1.6px"},truncatedTitle:{"> span:nth-child(2)":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",maxWidth:"100%"}}}),he=({app:e,onRemoveAtMentionApp:t,appService:n})=>{const o=pe(),r=(0,te.kQ)({AtMentionGpt:ue}),i=function(e,t,n){const[o,r]=c.useState();return c.useEffect((()=>{t||async function(e){try{const t={id:e},o=await(n?.getApp(t)),i=o?.titleInfo?.titleDefinition?.iconLarge?.uri;i&&r(i)}catch(e){}}(e)}),[e,t,n]),o}(e.appId,e.iconUrl,n);return c.createElement(Z.n,{className:o.atMentionApp,icon:null},c.createElement(ee.R,{className:o.atMentionAppMain},c.createElement(ne.V,{className:o.bannerTitle,"data-testid":"at-mention-banner"},c.createElement(c.Fragment,null,r.AtMentionGpt())),c.createElement(oe.C,{onDismiss:t},c.createElement(re.v,{icon:e.iconUrl||i?c.createElement(ie._,{height:20,fit:"contain",src:e.iconUrl||i,alt:e.title,className:o.appIcon}):le(e)?c.createElement(ae.Rl_,null):null,dismissible:!0,size:"small",shape:"circular",className:o.truncatedTitle},e.title))))},ge=(0,x.n)({inputBanner:{minHeight:"32px",...de.Pt.margin("-5px"),borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"},inputBannerInInputV3:{minHeight:"32px",borderTopLeftRadius:"7px",borderTopRightRadius:"7px",borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px",borderBottomStyle:"none"}}),fe=e=>{const t=ge();return e?t.inputBannerInInputV3:t.inputBanner};var me=n(54664),ye=n(10145),ve=n(21017);const Ce=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.ChatInputTitle"),be=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.StarterPromptMenuTitle"),Ee=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.SubmitButtonTitle"),Ae=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.ChatInputDefaultPlaceholder"),Se=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.MicrophoneListeningGhostText"),Ie=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.NeedHelpLink"),Pe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.NotNowMicrophoneButton"),Te=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.TryAgainMicrophoneButton"),xe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.DefaultCIQButtonTitle"),we=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.DefaultAtMentionButtonTitle"),ke=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.DefaultGroundingButtonTitle"),_e=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UpdatedGroundingButtonTitle"),De=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.CopilotLabMenuSubItem"),Fe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.DefaultMenuButtonTitle"),Le=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.GroundingSearchAndPlugins"),Oe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.PreviewFlagLabel"),Re=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.GroundingPluginFlyoutInfo"),Me=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.GroundingPluginFlyoutInfoTooltip"),Be=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.AdminBlockedPluginInfoTooltipLabel"),Ne=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.DefaultBlockedPluginInfoTooltipLabel"),Ve=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.WorkPluginLabel"),He=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.WebContentPluginLabel"),Ue=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.GroundingPluginFlyoutInfoLabel"),je=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.MicrophoneTooltipListening"),ze=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.MicrophoneTooltipPaused"),Ge=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.MicrophoneTooltipDisabled"),We=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.MicrophoneTooltipLoading"),qe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.AddImageButton"),Qe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.PasteImageButton"),Ke=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.PasteFromClipboardButton"),Ye=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageButton"),$e=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageUnsupportedTypeError"),Je=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageFileTooBigErrorFormat"),Xe=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageBadContentError"),Ze=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.chatInputAttachmentAltTextFormat"),et=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.nonImagePasteError"),tt=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.CharacterLimitReachedError"),nt=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.CreditUpsellCardTitle"),ot=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.CreditUpsellCardDescription"),rt=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.CreditUpsellCardButton"),it=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageFromPhoneButton"),at=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageFromPhoneDialogTitle"),st=(0,ce.Ex)("officeaicopilot-chatinput.chatInputStrings.UploadImageFromPhoneError"),lt=(0,x.n)({cardBackground:{backgroundImage:`linear-gradient(90deg, ${G.L.colorNeutralBackgroundAlpha2} 0%, ${G.L.colorNeutralBackgroundAlpha2} 100%), linear-gradient(90deg, ${G.L.colorPaletteBlueBackground2}  0%, ${G.L.colorPaletteBerryBackground2} 80%, ${G.L.colorPaletteDarkOrangeBackground2} 100%)`,paddingTop:G.L.spacingVerticalS,paddingBottom:G.L.spacingVerticalS,...de.Pt.border(G.L.strokeWidthThin,"solid",G.L.colorNeutralStroke1),...de.Pt.borderBottom("0px"),...de.Pt.borderRadius("4px","4px","0px","0px")},cardTitle:{marginBottom:"5px"},cardTitleText:{fontSize:"16px"},cardBody:{marginBottom:"20px"},cardGradientBar:{width:"5px",minWidth:"5px",height:"100px",backgroundImage:"linear-gradient(to bottom, rgba(254, 168, 116, 0.5) 25%, rgba(180, 124, 248, 0.5) 50%, rgba(70, 79, 235, 0.5) 65%, rgba(71, 207, 250, 0.5) 75% )",marginRight:"10px",marginTop:"3px"},container:{width:"100%",height:"100%",display:"flex",flexDirection:"row"},cardButton:{marginTop:"10px"}}),ct={creditUpsellCardTitle:nt,creditUpsellCardDescription:ot,creditUpsellCardButtonText:rt},ut=({creditsUIProps:e})=>{const t=lt(),n=(0,te.kQ)(ct),o=e.creditUpsellCardBannerProps,r=o?.title??n.creditUpsellCardTitle(),i=o?.description??n.creditUpsellCardDescription(),a=o?.buttonText??n.creditUpsellCardButtonText(),s=`${r} ${i}`;return c.createElement(Z.n,{icon:null,className:t.cardBackground},c.createElement(ee.R,{role:"alert","aria-label":s},c.createElement("div",{className:t.container},c.createElement(me.z,{value:0,className:t.cardGradientBar,"aria-hidden":"true"}),c.createElement("div",null,c.createElement("div",{className:t.cardTitle},c.createElement(ye.E,{weight:"semibold",className:t.cardTitleText},r)),c.createElement("div",{className:t.cardBody},c.createElement(ye.E,null,i)))),o?.useLink?c.createElement(ve.N,{onClick:e?.creditUpsellHandler,"aria-label":a,className:t.cardButton},a):c.createElement(j.$,{appearance:"primary",onClick:e?.creditUpsellHandler,"aria-label":a,className:t.cardButton},a)))},dt=e=>{const{chatInputBannerString:t,isInputV3Enabled:n=!1,atMentionApp:o,onRemoveAtMentionApp:r,appService:i,isCreditsUIShown:a,creditsUIProps:s}=e,l=!!o,u=c.createElement(he,{app:o,onRemoveAtMentionApp:r,appService:i}),d=c.createElement(Z.n,{className:fe(n)},c.createElement(ee.R,null,t)),p=c.createElement(ut,{creditsUIProps:s});return a?p:l?u:d};var pt=n(36199);const ht=({title:e,isDisabled:t,handleClick:n})=>c.createElement(U.m,{content:e,relationship:"label",withArrow:!0,positioning:"above"},c.createElement(j.$,{"aria-label":e,appearance:"transparent",role:"button",icon:{children:((e,t)=>{const n=(0,K.A)(t,e);return c.createElement(n,null)})(pt.Kfj,pt.AOU)},onClick:n,disabled:t}));var gt=n(13045),ft=n(39993),mt=n(89685),yt=n(93536);const vt=c.createContext({});var Ct;!function(e){e.TEAMS_HUB="teamshub",e.OWA_HUB="owahub",e.OFFICE_WEB="officeweb",e.OFFICE_DESKTOP="officedesktop"}(Ct||(Ct={}));const bt="https://teams.microsoft.com/l/store?id=app:co:copilotplugins&source=copilotChat",Et="{domain}/m365apps/f3a6e67f-850d-4dd9-960a-04c6638ded36/app:co:copilotplugins";const At="https://teams.microsoft.com/l/store?tabType=UserApps";var St;!function(e){e.AppStore="https://teams.microsoft.com/extensibility-apps/store/app:co:copilotplugins?host=metaos&language={locale}&metaoshost={hostName}&clienttype={hostClientType}",e.AppStoreManage="https://teams.microsoft.com/extensibility-apps/store/manage?host=metaos&language={locale}&metaoshost={hostName}&clienttype={hostClientType}",e.AppStoreDetails="https://teams.microsoft.com/extensibility-apps/appdetails/create?language={locale}&metaoshost={hostName}&host=metaos&clienttype={hostClientType}"}(St||(St={}));var It=n(67171),Pt=n(23044),Tt=n(94794),xt=n(64589),wt=n(79780),kt=n(89270),_t=n(79689),Dt=n(21278);const Ft=(0,Dt.Q)("CopilotPluginFlyoutCustomInfoButton",(0,x.n)({tooltiptext:{width:"216px",fontSize:"12px"},tooltip:{"> button":{backgroundColor:"none",paddingTop:"4px",paddingLeft:"4px",paddingRight:"4px",paddingBottom:"4px",width:"12px",height:"12px",minWidth:"0px",minHeight:"0px",maxWidth:"12px",maxHeight:"12px",borderTopStyle:"none",borderLeftStyle:"none",borderRightStyle:"none",borderBottomStyle:"none",borderBottomLeftRadius:"16px",borderBottomRightRadius:"16px",borderTopLeftRadius:"16px",borderTopRightRadius:"16px"}},infoButton:{marginLeft:"5px",":hover":{"> button":{backgroundColor:G.L.colorNeutralForeground2BrandHover},"> button > span > svg > path":{fill:G.L.colorNeutralForeground1}}},infoButtonTooltip:{zIndex:2,...de.Pt.padding("10px","12px")},infoButtonOverrideLightMode:{marginLeft:"5px",marginBottom:"5px",":hover":{"> button":{backgroundColor:"#0f6cbd"},"> button > span > svg > path":{fill:"#ffffff"}}},infoButtonOverrideDarkMode:{marginLeft:"5px",marginBottom:"5px",":hover":{"> button":{backgroundColor:"#479ef5"},"> button > span > svg > path":{fill:"#242424"}}}})),Lt=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginPreviewTitle"),Ot=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginDescription"),Rt=(0,ce.Ex)("copilot-ext-plugin-flyout.webContentPluginDescription"),Mt=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginInfoIconDescription"),Bt=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginAuthText"),Nt=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginConfigText"),Vt=(0,ce.Ex)("copilot-ext-plugin-flyout.searchInputPlaceholderText"),Ht=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginRequiredText"),Ut=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginNewBadge"),jt=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginDisabledInfoText"),zt=(0,ce.Ex)("copilot-ext-plugin-flyout.storeFrontTitleText"),Gt=(0,ce.Ex)("copilot-ext-plugin-flyout.addButtonContentText"),Wt=(0,ce.Ex)("copilot-ext-plugin-flyout.addingButtonContentText"),qt=(0,ce.Ex)("copilot-ext-plugin-flyout.privacyPolicyLinkText"),Qt=(0,ce.Ex)("copilot-ext-plugin-flyout.termsOfUseLinkText"),Kt=(0,ce.Ex)("copilot-ext-plugin-flyout.permissionsLinkText"),Yt=(0,ce.Ex)("copilot-ext-plugin-flyout.pluginMoreAppsText"),$t=(0,ce.Ex)("copilot-ext-plugin-flyout.managePluginsText"),Jt=(0,ce.Ex)("copilot-ext-plugin-flyout.connectPowerPlatformConnectorText"),Xt=(0,ce.Ex)("copilot-ext-plugin-flyout.enablingText"),Zt=(0,ce.Ex)("copilot-ext-plugin-flyout.infoText"),en=(0,ce.Ex)("copilot-ext-plugin-flyout.installationFailureMessage");function tn(e){const[t,n]=c.useState(),{infoMessage:o,theme:r}=e,i=Ft(),a=(0,T.z)(i.tooltip,i.infoButton,"dark"===r?i.infoButtonOverrideDarkMode:i.infoButtonOverrideLightMode),s=c.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M12 0C5.373 0 0 5.373 0 12C0 18.627 5.373 24 12 24C18.627 24 24 18.627 24 12C24 5.373 18.627 0 12 0ZM12 22C6.486 22 2 17.514 2 12C2 6.486 6.486 2 12 2C17.514 2 22 6.486 22 12C22 17.514 17.514 22 12 22Z",fill:"currentColor"}),c.createElement("path",{d:"M12 7C11.448 7 11 7.448 11 8V16C11 16.552 11.448 17 12 17C12.552 17 13 16.552 13 16V8C13 7.448 12.552 7 12 7Z",fill:"currentColor"}),c.createElement("circle",{cx:"12",cy:"5",r:"1",fill:"currentColor"})),l={content:{children:o,className:i.infoButtonTooltip},relationship:"label",...!e.mountTooltipToBody&&{mountNode:t},withArrow:!0},u=(0,te.kQ)({infoText:Zt});return c.createElement("span",{className:a,ref:n,title:u.infoText(),"aria-label":"Info"},c.createElement(U.m,{...l,onVisibleChange:(e,t)=>{if(t&&t.documentKeyboardEvent){"Escape"===t.documentKeyboardEvent.key&&t.documentKeyboardEvent.stopPropagation()}}},c.createElement(j.$,{icon:s,role:"tooltip",size:"small"})))}const nn=(0,Dt.Q)("CopilotPluginFlyoutItemRenderer",(0,x.n)({appIcon:{width:"20px",height:"20px",float:"left"},appNameContainer:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",...de.Pt.overflow("hidden")},appNameTextContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",...de.Pt.overflow("hidden")},appNameTooltip:{zIndex:2},appName:{width:"auto",height:"auto",lineHeight:"20px",paddingLeft:"2px",paddingRight:"2px",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:G.L.colorNeutralForeground2Link,whiteSpace:"nowrap",...de.Pt.overflow("hidden"),textOverflow:"ellipsis"},appInfo:{...de.Pt.padding("6px 4px 6px 6px"),...de.Pt.gap("4px"),display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1},...de.Pt.overflow("hidden"),alignContent:"center",justifyItems:"left",alignSelf:"center"},blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"36px",maxHeight:"100px",...de.Pt.margin("2px"),...de.Pt.padding("6px 0px 6px 6px"),justifyContent:"space-between",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1},alignItems:"center"},toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right","&:focus-within":{...de.Pt.border("1px","solid",G.L.colorNeutralForeground3)}},signInButton:{fontSize:"12px"},chevronIcon:{float:"left",marginRight:"20px",rotate:"270deg"},chevronIconCollapsed:{float:"left",marginRight:"20px"},powerplatformConnectorText:{display:"flex",maxWidth:"167px"},powerplatformConnectorTextContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"400px",justifyContent:"space-between",height:"auto",...de.Pt.overflow("hidden")},connectButton:{width:"auto",height:"auto",lineHeight:"16px",paddingLeft:"8px",paddingTop:"3px",paddingRight:"10px",fontSize:"12px",fontStyle:"normal",fontWeight:400,color:G.L.colorNeutralForeground2BrandPressed},newBadge:{marginLeft:"4px",marginTop:"3px",marginRight:"4px"}}));function on(e){const{plugin:t,setShowPlugins:n,pluginId:o}=e,[r,i]=c.useState(!1),a=nn(),[s,l]=c.useState(),u="blocked"===t.state?a.blocked:void 0,d="blocked"===t.state?c.createElement(tn,{infoMessage:"This plugin is disabled. Contact your admin."}):null,p=(0,T.z)(u,a.appName),h=c.createElement("div",{className:a.appInfo},t.icon&&c.createElement(ie._,{src:t.icon,className:(0,T.z)(a.appIcon,u),"aria-labelledby":o}),c.createElement("div",{className:a.appNameTextContainer,ref:l},c.createElement(U.m,{content:{children:t.name,className:a.appNameTooltip},relationship:"label",mountNode:s},c.createElement(ye.E,{id:o,className:p},t.name)),d));return c.createElement("div",{className:a.pluginItem,onClick:()=>{i(!r),n&&n()},role:"presentation"},h,c.createElement(_t.geq,{className:r?a.chevronIconCollapsed:a.chevronIcon}))}var rn=n(9567),an=n(31079),sn=n(94768);const ln=(0,Dt.Q)("CopilotPluginFlyoutItemCustomSwitch",(0,x.n)({toggleContainer:{boxSizing:"border-box",cursor:"pointer",...de.Pt.margin("0px"),...de.Pt.padding("8px"),width:"56px"},toggleOnContainerLightMode:{height:"20px",width:"40px",...de.Pt.borderRadius("10000px"),...de.Pt.border("1px","solid"),backgroundColor:"#0f6cbd",color:"#ffffff"},toggleOnContainerDarkMode:{height:"20px",width:"40px",...de.Pt.borderRadius("10000px"),...de.Pt.border("1px","solid"),backgroundColor:"#479ef5",color:"#242424"},toggleOffContainerLightMode:{height:"20px",width:"40px",...de.Pt.borderRadius("10000px"),...de.Pt.border("1px","solid"),...de.Pt.borderColor("#616161")},toggleOffContainerDarkMode:{height:"20px",width:"40px",...de.Pt.borderRadius("10000px"),...de.Pt.border("1px","solid"),...de.Pt.borderColor("#adadad")},toggleOffLightMode:{marginLeft:"2px",marginRight:"20px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",...de.Pt.borderRadius("10000px"),backgroundColor:"#616161"},toggleOffDarkMode:{marginLeft:"2px",marginRight:"20px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",...de.Pt.borderRadius("10000px"),backgroundColor:"#adadad"},toggleOnLightMode:{marginLeft:"22px",marginRight:"0px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",...de.Pt.borderRadius("10000px"),backgroundColor:"#ffffff"},toggleOnDarkMode:{marginLeft:"22px",marginRight:"0px",marginTop:"2.5px",marginBottom:"2.5px",width:"15px",height:"15px",...de.Pt.borderRadius("10000px"),backgroundColor:"#242424"}}));function cn(e){const{onChangeCallback:t,checked:n,theme:o,isBlocked:r,pluginName:i}=e,a=!r&&n,[s,l]=c.useState(a),u=()=>{if(!r){!function(e){const t=document.createElement("div"),n="PluginsFlyoutAnnounce-"+Date.now();t.setAttribute("id",n),t.setAttribute("aria-live","assertive"),t.classList.add("visually-hidden"),document.body.appendChild(t),window.setTimeout((()=>{const t=document.getElementById(n);t&&(t.textContent=e)}),100),window.setTimeout((()=>{const e=document.getElementById(n);e&&document.body.removeChild(e)}),1e3)}(`Toggle button ${i||"Plugin"} ${s?"not checked":"checked"}`),l(!s),t(!s)}},d=ln();return s?c.createElement("div",{"aria-label":`Toggle Button ${i} checked`,tabIndex:0,className:d.toggleContainer,onClick:u},c.createElement("div",{className:"dark"===o?d.toggleOnContainerDarkMode:d.toggleOnContainerLightMode},c.createElement("div",{className:"dark"===o?d.toggleOnDarkMode:d.toggleOnLightMode}))):c.createElement("div",{"aria-label":`Toggle Button ${i} not checked`,tabIndex:0,className:d.toggleContainer,onClick:u},c.createElement("div",{className:"dark"===o?d.toggleOffContainerDarkMode:d.toggleOffContainerLightMode},c.createElement("div",{className:"dark"===o?d.toggleOffDarkMode:d.toggleOffLightMode})))}function un(e){switch(e){case"MsgExt":return ft.QE.MsgExt;case"FirstParty":return ft.QE.FirstParty;case"PowerPlatform":return ft.QE.PowerPlatform;case"DataVerse":return ft.QE.DataVerse;case"Unsupported":return ft.QE.Unsupported;default:return ft.QE.Undefined}}function dn(e){const{plugin:t,onToggle:n,pluginId:o,isNewlyInstalled:r}=e,i=c.useContext(vt),{telemetryService:a,correlationVector:s,customStylingRequired:l,theme:u}=i,d=nn(),p=(0,te.kQ)({pluginDisabledInfoText:jt,pluginNewBadge:Ut}),[h,g]=c.useState(),f=(0,rn.W)(t)?`PluginName: ${t.name}, PluginId: ${t.id}, PluginSource: ${t.source}`:t.titleId?"LOB Plugin":"TitleId not found",m=c.useRef(null),{pluginRenderPerfMarker:y,propMap:v}=c.useMemo((()=>{const e=new gt.k(ft.yx.PluginRender,ft.xe.PluginFlyoutItemRender,a),n={};return n[ft.vP.PluginType]=un(t.type),n[ft.vP.IsPluginIconAvailable]=+!!t.icon,{pluginRenderPerfMarker:e,propMap:n}}),[t]),C=c.useCallback((e=>{b(!t.isEnabled)}),[]);c.useEffect((()=>{r&&m.current&&(b(!0),m.current.focus())}),[r]);const b=c.useCallback((e=>{const o=new gt.k(ft.yx.TogglePlugin,ft.xe.OnToggle,a),r={};try{r[ft.vP.TypeOfOperation]=e?ft.Lj.EnablePlugin:ft.Lj.DisablePlugin,r[ft.vP.PluginType]=un(t.type),n(e),o.logMetricEnd({props:r,diagnosticsData:f},s)}catch(e){o.logMetricEndWithError({props:r,message:ft.FG.PluginStateUpdateFailed,diagnosticsData:`Failed to update the toggled plugin state with error: ${e.message||"Unknown"}, ${f}`},s)}}),[n]),E="blocked"===t.state?d.blocked:void 0,A=c.useMemo((()=>l?c.createElement("div",{className:(0,T.z)(d.toggleControl,E)},c.createElement(cn,{checked:t.isEnabled,onChangeCallback:()=>{},theme:u,isBlocked:"blocked"==t.state,pluginName:t.name})):c.createElement(an.d,{className:d.toggleControl,disabled:"blocked"==t.state,checked:t.isEnabled,ref:m,"aria-label":`${t.name}. ${e.index} of ${e.length}. Toggle Mode `,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),b(!t.isEnabled))}})),[l,d.toggleControl,t.isEnabled,t.state,b,u]),S="blocked"===t.state?c.createElement(tn,{infoMessage:p.pluginDisabledInfoText()}):null,I=r?c.createElement(sn.E,{appearance:"filled",size:"small",className:d.newBadge},p.pluginNewBadge()):null,P=(0,T.z)(E,d.appName),x=c.createElement("div",{className:d.appInfo},t.icon&&c.createElement(ie._,{src:t.icon,className:(0,T.z)(d.appIcon,E),"aria-labelledby":o}),c.createElement("div",{className:d.appNameTextContainer,ref:g},c.createElement(U.m,{content:{children:t.name,className:d.appNameTooltip},relationship:"label",mountNode:h},c.createElement(ye.E,{id:o,className:P},t.name)),S,I));c.useEffect((()=>{y.logMetricEnd({props:v,diagnosticsData:f},s)}),[t]);const w="blocked"===t.state?void 0:C;return c.createElement("div",{className:d.pluginItem,onClick:w,role:"presentation"},x,A)}function pn(e){const{pluginVM:t,pluginId:n}=e,[o,r]=c.useReducer((()=>({...t.plugin})),t.plugin),i=c.useCallback((e=>{t.onToggle(e),r()}),[t]);return c.createElement(dn,{plugin:o,onToggle:i,pluginId:n,index:t.index,length:t.length,isNewlyInstalled:e.pluginVM.isNewlyInstalled})}var hn=n(50083);function gn({onSpinnerComplete:e}){c.useEffect((()=>{e()}),[]);const t=(0,te.kQ)({enablingText:Xt}).enablingText();return c.createElement("div",null,c.createElement(hn.y,{labelPosition:"after",size:"tiny",label:t}))}function fn(e){const{onToggle:t,onAuthLinkClickHandler:n,pluginId:o,isNewlyInstalled:r}=e,i=e.plugin,a=c.useContext(vt),{telemetryService:s,correlationVector:l,customStylingRequired:u,theme:d}=a,p=nn(),h=(0,te.Lh)(Ut),[g,f]=c.useState(),m=(0,rn.W)(i)?`PluginName: ${i.name}, PluginId: ${i.id}, PluginSource: ${i.source}`:i.titleId?"LOB Plugin":"TitleId not found",{pluginRenderPerfMarker:y,propMap:v}=c.useMemo((()=>{const e=new gt.k(ft.yx.PluginRender,ft.xe.PluginFlyoutItemRender,s),t={};return t[ft.vP.PluginType]=un(i.type),t[ft.vP.IsPluginIconAvailable]=+!!i.icon,{pluginRenderPerfMarker:e,propMap:t}}),[i]),C=c.useCallback((e=>{b(!i.isEnabled)}),[]);c.useEffect((()=>{r&&b(!0)}),[r]);const b=c.useCallback((e=>{const n=new gt.k(ft.yx.TogglePlugin,ft.xe.OnToggle,s),o={};try{o[ft.vP.TypeOfOperation]=e?ft.Lj.EnablePlugin:ft.Lj.DisablePlugin,o[ft.vP.PluginType]=un(i.type),t(e),n.logMetricEnd({props:o,diagnosticsData:m},l)}catch(e){n.logMetricEndWithError({props:o,message:ft.FG.PluginStateUpdateFailed,diagnosticsData:`Failed to update the toggled plugin state with error: ${e.message||"Unknown"}, ${m}`},l)}}),[l,t,i.id,i.name,i.source,i.type,s]),E=c.useRef(null),[A,S]=c.useState(!1);c.useEffect((()=>{A&&E.current&&(E.current.focus(),S(!1))}),[A,i.isEnabled,i.state]);const I=()=>{S(!0)},P="blocked"===i.state?p.blocked:void 0,x=c.useMemo((()=>i.isEnabled||"processing"!=i.status?u?c.createElement("div",{className:(0,T.z)(p.toggleControl,P)},c.createElement(cn,{checked:i.isEnabled,onChangeCallback:()=>{},theme:d})):c.createElement(an.d,{className:p.toggleControl,"aria-label":`${i.name}. ${e.index} of ${e.length}. Toggle Mode `,ref:E,disabled:"blocked"==i.state,checked:i.isEnabled,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),b(!i.isEnabled))}}):c.createElement(gn,{onSpinnerComplete:I})),[i.isEnabled,i.status,i.state,u,p.toggleControl,b,d]),w=(0,T.z)(P,p.appName),k=(0,te.Lh)(jt),_="blocked"===i.state?c.createElement(tn,{infoMessage:k}):null,D=r?c.createElement(sn.E,{appearance:"filled",size:"small",className:p.newBadge},h):null,F=c.createElement("div",{className:p.appInfo},i.icon&&c.createElement(ie._,{src:i.icon,className:(0,T.z)(p.appIcon,P),"aria-labelledby":o}),c.createElement("div",{className:p.appNameContainer},c.createElement("div",{className:p.appNameTextContainer,ref:f},c.createElement(U.m,{content:{children:i.name,className:p.appNameTooltip},relationship:"label",mountNode:g},c.createElement(ye.E,{className:w,id:o},i.name)),_,D),c.createElement(mn,{plugin:i,onAuthLinkClickHandler:n})));c.useEffect((()=>{y.logMetricEnd({props:v,diagnosticsData:m},l)}),[i]);const L="blocked"===i.state?void 0:C;return c.createElement("div",{className:p.pluginItem,onClick:L,role:"presentation"},F,x)}function mn(e){const t=e.plugin,n=e.onAuthLinkClickHandler,o=nn(),r=(0,te.kQ)({pluginAuthText:Bt,pluginConfigText:Nt,pluginRequiredText:Ht});let i;return t.authRequest&&(i="auth"===t.authRequest.type||"silentAuth"===t.authRequest.type||t.authRequest.isSilent?r.pluginAuthText():r.pluginConfigText()),t.isEnabled&&"pendingAuth"===t.status&&"blocked"!==t.state&&t.authRequest?c.createElement(ye.E,{className:o.signInButton},c.createElement(ve.N,{as:"button",onClick:e=>{e.stopPropagation(),n&&n()},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.stopPropagation(),n&&n())}},i),` ${r.pluginRequiredText()}`):null}function yn(e){const{pluginVM:t,pluginId:n}=e,o=t,[r,i]=c.useReducer((()=>({...o.plugin})),o.plugin),a=c.useCallback((e=>{o.onToggle(e,(()=>{i()}))}),[o]);return c.createElement(fn,{plugin:r,onToggle:a,onAuthLinkClickHandler:async()=>{o.handleAuthLinkClick(i)},pluginId:n,index:e.pluginVM.index,length:e.pluginVM.length,isNewlyInstalled:e.pluginVM.isNewlyInstalled})}function vn(e){const{pluginVM:t,dismissFlyoutCallback:n}=e,o=t.plugin,r=o.id,i=nn(),[a,s]=c.useState(),l=(0,te.kQ)({connectPowerPlatformConnectorText:Jt,pluginNewBadge:Ut}),{correlationVector:u,telemetryService:d}=c.useContext(vt),p=c.useRef(null),h=t.isNewlyInstalled?c.createElement(sn.E,{appearance:"filled",size:"small",className:i.newBadge},l.pluginNewBadge()):null;c.useEffect((()=>{t.isNewlyInstalled&&p.current&&p.current.focus()}),[t]);const g=c.createElement("div",{className:i.appInfo,ref:p},o.icon&&c.createElement(ie._,{src:o.icon,className:i.appIcon,"aria-labelledby":r}),c.createElement("div",{className:i.powerplatformConnectorTextContainer,ref:s},c.createElement("div",{className:i.powerplatformConnectorText},c.createElement(U.m,{content:{children:o.name,className:i.appNameTooltip},relationship:"label",mountNode:a},c.createElement(ye.E,{id:r,className:i.appName},o.name)),h),c.createElement(ye.E,{className:i.connectButton},l.connectPowerPlatformConnectorText())));return c.createElement("div",{className:i.pluginItem,onClick:()=>{const e=new gt.k(ft.yx.PowerPlatformConnector,ft.xe.PowerPlatformConnectorClick,d);window.open(o.powerPlatformConnectorId),n?(e.logMetricEnd({message:ft.FG.PowerPlatformConnectorFlyoutDismissed},u),n()):e.logMetricEnd({message:ft.FG.PowerPlatformConnectorFlyoutOpen},u)},role:"presentation"},g)}const Cn=e=>{const{pluginVM:t,isParentPlugin:n,isUnconnectedPPC:o,setShowPlugins:r,pluginId:i,dismissFlyoutCallback:a}=e;return n?c.createElement(on,{plugin:t.plugin,setShowPlugins:r,pluginId:i}):o?c.createElement(vn,{pluginVM:t,dismissFlyoutCallback:a}):t.plugin.id.includes("MessageExtension")?c.createElement(yn,{pluginVM:t,pluginId:i}):c.createElement(pn,{pluginVM:t,pluginId:i})},bn=(0,Dt.Q)("CopilotPluginFlyoutRenderer",(0,x.n)({menuPopOver:{overflowX:"hidden",width:"272px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"475px",backgroundColor:G.L.colorNeutralBackground1,overflowY:"hidden"},flyoutContainer:{display:"flex",flexDirection:"column",maxHeight:"60vh"},responsiveMenuList:{maxHeight:"280px",minHeight:"56px",overflowY:"scroll",...de.Pt.margin("4px","0px")},responsiveFooterSection:{height:"fit-content",width:"100%",borderRadius:"0px 0px 4px 4px"},menuList:{maxHeight:"250px",overflowY:"scroll"},searchInputBox:{minWidth:"230px",marginBottom:"5px",marginRight:"10px",minHeight:"32px","& input[type=text]":{...de.Pt.borderWidth(0)}},popOverScroll:{":hover::-webkit-scrollbar-thumb":{backgroundColor:G.L.colorNeutralForeground4,...de.Pt.border("2px","solid",G.L.colorNeutralBackground3),...de.Pt.borderRadius(G.L.borderRadiusMedium)},"&::-webkit-scrollbar":{width:G.L.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:G.L.colorNeutralBackground5}},menuItem:{backgroundColor:G.L.colorNeutralBackground1,maxWidth:"inherit",paddingLeft:"0px",paddingRight:"0px","> span":{...de.Pt.overflow("hidden")},"&:hover":{backgroundColor:G.L.colorNeutralBackground1Hover}},subMenuItem:{backgroundColor:G.L.colorNeutralBackground1,maxWidth:"inherit",paddingLeft:"25px",paddingRight:"0px","> span":{...de.Pt.overflow("hidden")},"&:focus-within":{backgroundColor:G.L.colorNeutralBackground1Hover}},descriptionSection:{color:G.L.colorNeutralForeground2Link,paddingBottom:"6px",paddingRight:"8px",paddingLeft:"8px",display:"flex",flexDirection:"column"},installedSection:{display:"flex",paddingBottom:"10px",paddingTop:"2px",paddingLeft:"2px",paddingRight:"2px",flexDirection:"column",...de.Pt.gap("2px"),alignSelf:"stretch"},description:{paddingBottom:"6px",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:G.L.colorNeutralForeground2Link},footerSection:{height:"auto",width:"100%",...de.Pt.borderRadius("0px","0px","4px","4px")},dividerContainer:{paddingLeft:"2px",paddingRight:"14px"},footerContainer:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",paddingTop:"16px",paddingBottom:"12px",paddingRight:"12px"},morePlugins:{...de.Pt.borderRadius("4px"),...de.Pt.borderWidth("1px"),paddingTop:"5px",paddingBottom:"7px",paddingLeft:"12px",paddingRight:"12px",lineHeight:"20px",fontWeight:600,fontSize:"14px",fontStyle:"normal",color:G.L.colorNeutralForeground1},titleContainer:{display:"flex",flexDirection:"row",paddingTop:"10px",paddingBottom:"10px",...de.Pt.gap("8px")},title:{color:G.L.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start",...de.Pt.gap("10px"),alignSelf:"stretch"},previewTitle:{height:"16px",color:G.L.colorNeutralForeground2,backgroundColor:G.L.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px",...de.Pt.borderRadius("8px"),display:"flex",flexDirection:"row",alignSelf:"stretch",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"},shimmer:{display:"grid",position:"relative",gridTemplateColumns:"min-content 1fr 20%",alignItems:"center",...de.Pt.padding("6px","12px","6px","0px"),color:G.L.colorNeutralStencil1},shimmerCircle:{marginRight:"10px"},shimmerRectangle:{width:"60%"},shimmerElementRadius:{...de.Pt.borderRadius("2px")},labelInfo:{backgroundColor:G.L.colorNeutralBackground1,"&:focus-within":{backgroundColor:G.L.colorNeutralBackground1Hover,...de.Pt.border("2px","solid",G.L.colorNeutralBackground1Hover),...de.Pt.borderRadius(G.L.borderRadiusMedium)}}}));var En=n(87354),An=n(71961);function Sn(e){const t=e||6,n=c.memo((()=>{const e=bn(),t=(0,T.z)(e.shimmerElementRadius,e.shimmerRectangle);return c.createElement(En.E,{className:e.shimmer,animation:"wave",appearance:"translucent"},c.createElement(An.H,{shape:"circle",size:24,className:e.shimmerCircle}),c.createElement(An.H,{shape:"rectangle",size:8,className:t}),c.createElement(An.H,{shape:"rectangle",size:8,className:e.shimmerElementRadius}))}));return n.displayName="ShimmerComponent",c.createElement(c.Fragment,null,[...Array(t)].map(((e,t)=>c.createElement(n,{key:t}))))}Sn.displayName="CopilotPluginFlyoutShimmerSection";const In=e=>{const{pluginGroupVM:t,dismissFlyoutCallback:n,enableCreatePpcConnections:o}=e,r=bn(),[i,a]=c.useState(!1),s=()=>{a(!i)};const l=t.groupPlugins.length>1;const u=!!o&&function(e){return e.parentPlugin.plugin.powerPlatformConnectorId&&0==e.groupPlugins.length}(t),d=c.useMemo((()=>c.createElement(c.Fragment,null,u&&c.createElement(kt.D,{persistOnClick:!0,tabIndex:-1,className:r.menuItem},Cn({pluginVM:t.parentPlugin,isParentPlugin:!1,isUnconnectedPPC:!0,dismissFlyoutCallback:n})),l&&c.createElement(kt.D,{persistOnClick:!0,tabIndex:-1,className:r.menuItem},Cn({pluginVM:t.parentPlugin,isParentPlugin:!0,setShowPlugins:s})),(!l||i)&&t.groupPlugins.map(((e,n)=>{e.index=t.index,e.length=t.length;const o=`PluginItem-${(0,mt.DA)()}`;return c.createElement(kt.D,{persistOnClick:!0,tabIndex:-1,className:l?r.subMenuItem:r.menuItem,key:n,"aria-labelledby":o},Cn({pluginVM:e,isParentPlugin:!1,pluginId:o}))})))),[t,i]);return d},Pn=e=>{const{pluginsGrouped:t,isPluginDataLoaded:n,dismissFlyoutCallback:o,enableCreatePpcConnections:r}=e;if(!n)return c.createElement(Sn,null);const i=[];return t.forEach(((e,n)=>{const a={parentPlugin:e.parentPlugin,groupPlugins:e.groupPlugins,index:n+1,length:t.length};i.push(c.createElement(In,{pluginGroupVM:a,dismissFlyoutCallback:o,enableCreatePpcConnections:r,key:e.parentPlugin.plugin.id}))})),c.createElement(c.Fragment,null,i)};var Tn=n(13944);const xn=(0,Dt.Q)("CopilotPluginStoreFrontListItemRenderer",(0,x.n)({image:{width:"1.5rem",height:"1.5rem",outlineOffset:"-0.1rem",borderRadius:"0.4rem",...de.Pt.outline(".1rem","solid",G.L.colorNeutralStroke2)},imageDiv:{marginRight:"0.6rem",marginTop:"0.4rem"},text:{fontWeight:400,fontSize:"0.9rem",lineHeight:"1.2rem",color:G.L.colorNeutralForeground1,textOverflow:"ellipsis",whiteSpace:"nowrap",...de.Pt.overflow("hidden")},textDesc:{fontWeight:400,fontSize:"0.7rem",lineHeight:"1rem",color:G.L.colorNeutralForeground3,textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",...de.Pt.overflow("hidden")},textInstallationFailedDesc:{fontWeight:400,fontSize:"0.6rem",lineHeight:"1rem",color:G.L.colorPaletteRedForeground1,textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",...de.Pt.overflow("hidden")},tileDiv:{display:"flex",marginRight:"1.6rem",height:"2.4rem",width:"11rem",alignItems:"center"},button:{paddingLeft:"0.2rem",paddingRight:"0.2rem",minWidth:"2.8rem",height:"1.6rem",...de.Pt.borderRadius(".4rem")},buttonDiv:{display:"flex",height:"2.4rem",alignItems:"center",paddingLeft:"0.2rem"},toolTipDiv:{width:"96%",display:"inline-block",backgroundColor:G.L.colorNeutralBackground1,":hover":{backgroundColor:G.L.colorNeutralBackground1Hover,"& span":{color:G.L.colorNeutralForeground1Hover}},margin:"0.2rem",borderRadius:"0.4rem"},toolTipInstallationFailedDiv:{width:"96%",display:"inline-block",backgroundColor:G.L.colorPaletteRedBackground1,margin:"0.2rem",borderRadius:"0.4rem",outlineOffset:"-0.1rem",...de.Pt.outline("1px","solid",G.L.colorPaletteRedBackground2)},privacyTermsDiv:{paddingLeft:"2.3rem",paddingRight:"0.6rem",paddingBottom:"0.5rem"},appNameTooltip:{zIndex:2},installationFailedDiv:{display:"flex"},informationIcon:{width:"1.5rem",color:G.L.colorPaletteRedForeground1,marginRight:"0.1rem",marginTop:"0.2rem"}})),wn="https://teams.microsoft.com/l/app/{appId}";const kn=(0,Dt.Q)("CopilotPluginStoreFrontTermAndPrivacyRenderer",(0,x.n)({termAndPrivacyDiv:{display:"flex"},privacyButton:{fontWeight:400,fontSize:"0.7rem",lineHeight:"1rem",paddingLeft:"0",paddingRight:"0.2rem",maxWidth:"4.5rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkButton:{fontWeight:400,fontSize:"0.7rem",lineHeight:"1rem",paddingLeft:"0.2rem",paddingRight:"0.2rem",maxWidth:"4.5rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}));function _n(e){const{appId:t,privacyUrl:n,termsOfUseUrl:o,sourceName:r,tokenService:i}=e,{correlationVector:a,telemetryService:s,metaOsSdk:l,appStoreService:u}=c.useContext(vt),d=kn(),p=(0,te.kQ)({privacyPolicyLinkText:qt,termsOfUseLinkText:Qt,permissionsLinkText:Kt}),h=c.useCallback((()=>{window.open(n)}),[]),g=c.useCallback((()=>{window.open(o)}),[]),f=c.useCallback((async()=>{const e=new gt.k(ft.yx.StoreFrontCopilotPluginPermissions,ft.xe.StoreFrontCopilotPluginPermissionClick,s);try{if(l){const n=function(e,t,n){let o=wn.replace("{appId}",e);if(n&&(o+="?scrollToSection=permissions"),!t)return o;switch(t.toLocaleLowerCase()){case Ct.OFFICE_WEB:case Ct.OFFICE_DESKTOP:case Ct.OWA_HUB:case Ct.TEAMS_HUB:}return o}(t,r,!0);await l.appOpenLink(n),e.logMetricEnd({message:ft.FG.StoreFrontCopilotPluginPermissionsClickHostHandled},a)}else e.logMetricEndWithError({message:ft.FG.StoreFrontCopilotPluginPermissionsClickFailed,diagnosticsData:"metaOsSdk handler is undefined by the host"})}catch(t){let n;n=t instanceof Error?t.message:t,e.logMetricEndWithError({message:ft.FG.StoreFrontCopilotPluginPermissionsClickFailed,diagnosticsData:`App details page failed to open on clicking permissions url on the flyout. Error: ${n}`})}}),[l]);return c.createElement("div",{className:d.termAndPrivacyDiv},c.createElement(ve.N,{onClick:h,className:d.privacyButton},p.privacyPolicyLinkText()),c.createElement(H.c,{vertical:!0}),c.createElement(ve.N,{onClick:g,className:d.linkButton},p.termsOfUseLinkText()),c.createElement(H.c,{vertical:!0}),c.createElement(ve.N,{onClick:()=>{if(u){const e=new gt.k(ft.yx.StoreFrontCopilotPluginPermissions,ft.xe.StoreFrontCopilotPluginPermissionClick,s);u.openAppStore({appId:t,tokenService:i,contentUrl:St.AppStoreDetails,scrollToPermissionsSection:!0}),e.logMetricEnd({message:ft.FG.StoreFrontCopilotPluginPermissionsClickHostHandled},a)}else f()},className:d.linkButton},p.permissionsLinkText()))}function Dn(e){const{appId:t,appName:n,imageUrl:o,appDescription:r,privacyUrl:i,termsOfUseUrl:a,onStoreFrontItemClick:s,sourceName:l,tokenService:u}=e,[d,p]=c.useState(!1),[h,g]=c.useState(!1),f=xn(),m=(0,te.kQ)({addButtonContentText:Gt,addingButtonContentText:Wt,installationFailureMessage:en}),y=c.useCallback((async()=>{p(!0);const e=await s();p(!1),g(!e)}),[]);return c.createElement(U.m,{content:{children:n,className:f.appNameTooltip},relationship:"label"},c.createElement("div",{className:h?f.toolTipInstallationFailedDiv:f.toolTipDiv},c.createElement("div",{className:f.buttonDiv},c.createElement("div",{className:f.tileDiv},c.createElement("div",{className:f.imageDiv},c.createElement(ie._,{src:o,className:f.image,"aria-hidden":"true"})),c.createElement(ye.E,{className:f.text},n)),c.createElement(j.$,{className:f.button,onClick:y,disabled:d||h},d?m.addingButtonContentText():m.addButtonContentText())),c.createElement("div",{className:f.privacyTermsDiv},c.createElement(ye.E,{className:f.textDesc},r),c.createElement(_n,{appId:t,privacyUrl:i,termsOfUseUrl:a,sourceName:l,tokenService:u}),h&&c.createElement("div",{className:f.installationFailedDiv},c.createElement(Tn.c8N,{className:f.informationIcon}),c.createElement(ye.E,{className:f.textInstallationFailedDesc},m.installationFailureMessage())))))}_n.displayName="CopilotPluginManagerStoreFrontTermAndPrivacyRenderer",Dn.displayName="CopilotPluginStoreFrontListItemRenderer";const Fn=(0,Dt.Q)("CopilotPluginStoreFrontRenderer",(0,x.n)({renderDiv:{paddingTop:"0.2rem"},textDiv:{height:"1.6rem",paddingTop:"0.5rem",paddingLeft:"0.5rem"},text:{fontWeight:600,fontSize:"0.8rem",lineHeight:"1.2rem",color:G.L.colorNeutralForeground3}}));function Ln(e){const{storeFrontPlugins:t,sourceName:n,fetchPluginsByNetwork:o,tokenService:r}=e,i=[],{correlationVector:a,telemetryService:s}=c.useContext(vt),l=Fn(),u=(0,te.kQ)({storeFrontTitleText:zt});return t.forEach((e=>{const t=e.plugin,l=async()=>{const n=new gt.k(ft.yx.StoreFrontCopilotPluginItem,ft.xe.StoreFrontCopilotPluginItemClick,s),r=await e.onInstall();return r?(o(e.plugin.id),n.logMetricEnd({message:ft.FG.StoreFrontCopilotPluginItemInstallSucceeded},a)):n.logMetricEndWithError({message:ft.FG.StoreFrontCopilotPluginItemInstallFailed,diagnosticsData:`store front plugin installation failed for plugin id: ${t.id}`}),r};t.largeImageUrl&&t.shortDescription&&t.privacyUrl&&t.termsOfUseUrl&&i.push(c.createElement("div",{key:t.id},c.createElement(Dn,{appId:t.id,appName:t.name,imageUrl:t.largeImageUrl,appDescription:t.shortDescription,privacyUrl:t.privacyUrl,termsOfUseUrl:t.termsOfUseUrl,onStoreFrontItemClick:l,sourceName:n,tokenService:r})))})),0===i.length?null:c.createElement("div",{className:l.renderDiv},c.createElement(H.c,null),c.createElement("div",{className:l.textDiv},c.createElement(ye.E,{className:l.text},u.storeFrontTitleText())),c.createElement("div",null,i))}Ln.displayName="CopilotPluginStoreFrontListRenderer";const On=8;function Rn(e){const{storeFrontPlugins:t,installedPlugins:n,searchText:o,fetchPluginsByNetwork:r,isInstalledPluginsDataLoaded:i,isStoreFrontPluginsDataLoaded:a,sourceName:s,tokenService:l}=e;if(!i||!a)return c.createElement(Sn,{numShimmers:On});if(t&&t.length>0){const e=t.filter((e=>{const t=e.plugin,n=o.toLowerCase();return 0===n.length||t.name.toLowerCase().includes(n)||t.shortDescription&&t.shortDescription.toLowerCase().includes(n)})).filter((e=>!n.some((t=>t.parentPlugin.plugin.metaOSAppId===e.plugin.id))));if(e.length>0){const t=e.slice(0,On);return c.createElement(Ln,{storeFrontPlugins:t,fetchPluginsByNetwork:r,sourceName:s,tokenService:l})}}return null}Rn.displayName="CopilotPluginStoreFrontRenderer";const Mn=250;function Bn(e){const{pluginsGrouped:t,isPluginDataLoaded:n,storeFrontPlugins:o,isStoreFrontPluginsDataLoaded:r,enableMorePlugins:i,isMorePluginHyperlinkEnabled:a,sourceName:s,positioningRef:l,fetchPluginsByNetwork:u,enablePluginSearch:d,tokenService:p,enableManagePlugins:h,dismissFlyoutCallback:g,enableStoreFrontPlugins:f,enableCreatePpcConnections:m,mountTooltipToBody:y,showGetCopilotExtensions:v,enablePluginsAsDeclarativeAgents:C}=e,b=bn(),{theme:E,isPreview:A,correlationVector:S,telemetryService:I,metaOsSdk:P,appStoreService:x}=c.useContext(vt),[w,k]=c.useState([]),[_,D]=c.useState(""),F=(0,te.kQ)({pluginInfoIconDescription:Mt,pluginPreviewTitle:Lt,pluginDescription:Ot,webContentPluginDescription:Rt,pluginMoreAppsText:Yt,searchInputPlaceholderText:Vt,managePluginsText:$t});c.useEffect((()=>{n&&k(t)}),[n]);const{findFirstFocusable:L}=(0,It.r)(),O=c.useCallback((e=>{if(n){D(e);const n=t.filter((t=>t.parentPlugin.plugin.name.toLowerCase().includes(e)||t.groupPlugins.some((t=>t.plugin.name.toLowerCase().includes(e)))));k(n)}}),[t,n]),R=(0,wt.A)(((e,t={value:""})=>{O(t.value.toLowerCase().trim())}),Mn),M=c.useRef(null),B=c.useRef(null);c.useEffect((()=>{l&&l.current&&l.current.updatePosition()}),[w]),c.useEffect((()=>{if(n)if(d&&M.current)M.current.focus();else if(B.current){const e=L(B.current);e&&e.focus()}}),[M,B,d,n]);const N=F.pluginInfoIconDescription(),V=c.createElement(tn,{infoMessage:N,theme:E,mountTooltipToBody:y}),G=F.pluginPreviewTitle(),W=A?c.createElement(ye.E,{className:b.previewTitle},G):null,q=c.createElement("div",{className:b.descriptionSection},c.createElement("div",{className:b.titleContainer},W),d&&c.createElement(Pt.p,{ref:M,"data-testid":"plugin-flyout-search-input","aria-label":F.searchInputPlaceholderText(),placeholder:F.searchInputPlaceholderText(),contentAfter:c.createElement(z.u5x,null),onChange:R,className:b.searchInputBox}),c.createElement("div",null,c.createElement(ye.E,{className:b.description},C?F.webContentPluginDescription():F.pluginDescription()),V)),Q=()=>{if(x){const e=new gt.k(ft.yx.MorePlugins,ft.xe.MorePluginsClick,I);x.openAppStore({tokenService:p,correlationVector:(0,mt.DA)()}),g&&g(),e.logMetricEnd({message:ft.FG.MorePluginsClickHostHandled},S)}else K()},K=async()=>{const e=new gt.k(ft.yx.MorePlugins,ft.xe.MorePluginsClick,I);try{if(P){const t=(await P.appGetContext()).page.sourceOrigin,n=function(e,t){if(!e)return bt;switch(e.toLocaleLowerCase()){case Ct.OFFICE_WEB:case Ct.OFFICE_DESKTOP:return t?"https://copilot.cloud.microsoft"===t?Et.replace("{domain}","https://m365.cloud.microsoft"):Et.replace("{domain}",t):bt;case Ct.OWA_HUB:case Ct.TEAMS_HUB:default:return bt}}(s,t);await P.appOpenLink(n),e.logMetricEnd({message:ft.FG.MorePluginsClickHostHandled},S)}else e.logMetricEndWithError({message:ft.FG.MorePluginsClickFailed,diagnosticsData:"metaOsSdk handler is undefined by the host"})}catch(t){let n;n=t instanceof Error?t.message:t,e.logMetricEndWithError({message:ft.FG.MorePluginsClickFailed,diagnosticsData:`Store page failed to open on clicking more plugins button on the flyout. Error: ${n}`})}},Y=async()=>{const e=new gt.k(ft.yx.ManagePlugins,ft.xe.ManagePluginsClick,I);try{if(P){const t=function(e){if(!e)return At;switch(e.toLocaleLowerCase()){case Ct.OFFICE_WEB:case Ct.OFFICE_DESKTOP:case Ct.OWA_HUB:case Ct.TEAMS_HUB:}return At}(s);await P.appOpenLink(t),e.logMetricEnd({message:ft.FG.ManagePluginsClickHostHandled},S)}else e.logMetricEndWithError({message:ft.FG.ManagePluginsClickFailed,diagnosticsData:"metaOsSdk handler is undefined by the host"})}catch(t){let n;n=t instanceof Error?t.message:t,e.logMetricEndWithError({message:ft.FG.ManagePluginsClickFailed,diagnosticsData:`Store page failed to open on clicking manage plugins button on the flyout. Error: ${n}`})}},$=a?c.createElement(j.$,{className:b.morePlugins,icon:c.createElement(xt.h7G,null),onClick:Q,"aria-label":F.pluginMoreAppsText()},F.pluginMoreAppsText()):c.createElement(j.$,{className:b.morePlugins,onClick:Q},F.pluginMoreAppsText()),J=i?c.createElement("div",{className:a?b.responsiveFooterSection:b.footerSection},c.createElement(H.c,{className:b.dividerContainer}),c.createElement("div",{className:b.footerContainer},v&&$,h&&c.createElement(U.m,{content:F.managePluginsText(),relationship:"label"},c.createElement(j.$,{icon:c.createElement(z.FhH,null),appearance:"transparent",onClick:()=>{if(x){const e=new gt.k(ft.yx.ManagePlugins,ft.xe.ManagePluginsClick,I);x.openAppStore({tokenService:p,contentUrl:St.AppStoreManage}),g&&g(),e.logMetricEnd({message:ft.FG.ManagePluginsClickHostHandled},S)}else Y()}})))):null,X=(0,T.z)(a?b.responsiveMenuList:b.menuList,b.popOverScroll);return c.createElement("div",{className:a?b.flyoutContainer:""},c.createElement("div",null,q),c.createElement("div",{className:X},c.createElement(Tt.c,null,c.createElement("div",{ref:B},c.createElement("div",{className:b.installedSection},c.createElement(Pn,{pluginsGrouped:w,isPluginDataLoaded:n,dismissFlyoutCallback:g,enableCreatePpcConnections:m})))),f&&c.createElement(Rn,{storeFrontPlugins:o,installedPlugins:t,isInstalledPluginsDataLoaded:n,fetchPluginsByNetwork:u,isStoreFrontPluginsDataLoaded:r,sourceName:s,searchText:_,tokenService:p})),c.createElement("div",null,J))}var Nn=n(82794),Vn=n(86122);const Hn={...Nn.o},Un={...Vn.C};function jn(e){const[t,n]=c.useState([]),[o,r]=c.useState(!1),[i,a]=c.useState([]),[s,l]=c.useState(!1),{pluginProvider:u,telemetryService:d,customStylingRequired:p,theme:h,isPreview:g,locale:f,enableMorePlugins:m,isMorePluginHyperlinkEnabled:y,sourceName:v,positioningRef:C,enablePluginSearch:b,appStoreService:E,tokenService:A,metaOsSdk:S,enableManagePlugins:I,dismissFlyoutCallback:P,enableStoreFrontPlugins:T,enableCreatePpcConnections:x,mountTooltipToBody:w,newlyInstalledPluginId:k,showGetCopilotExtensions:_,enablePluginsAsDeclarativeAgents:D,hideWebContent:F}=e,L=c.useMemo((()=>(0,mt.DA)()),[]),O=c.useMemo((()=>new gt.k(ft.yx.LaunchPluginFlyout,ft.xe.CopilotPluginFlyout,d)),[]),R=c.useCallback((e=>{let t=e;F&&(t=t.filter((e=>"BuiltIn"!==e.parentPlugin.plugin.source))),n(t)}),[F]);c.useEffect((()=>{u.getPlugins(void 0,L,!0,k?"network-only":"cache-and-network",k).then((e=>{e&&(R(e),r(!0))}))}),[R]),c.useEffect((()=>{T&&u.getStoreFrontPlugins(L).then((e=>{e&&(a(e),l(!0))}))}),[T]),c.useEffect((()=>{O.logMetricEnd(void 0,L)}),[]),c.useEffect((()=>{o&&(!T||s)&&d&&d.LogPluginMenuRendered()}),[d,s,o,T]),c.useEffect((()=>{const e=f?(0,ce.U5)(f):(0,ce.U5)("en-us");(0,ce.ex)().then((t=>{t!==f&&(0,ce.Gd)(e)}))}),[f]);const M=c.useCallback((e=>{o&&(r(!1),u.getPlugins(void 0,L,!0,"network-only",e).then((e=>{if(e){R(e),r(!0)}})))}),[o,R]),B=c.useMemo((()=>e.fluentTheme?e.fluentTheme:function(e){let t;return t=e?"light"===e?Hn:Un:Hn,t}(e.theme)),[e.fluentTheme,e.theme]);return c.createElement(yt.q,{theme:B},c.createElement(vt.Provider,{value:{telemetryService:d,correlationVector:L,customStylingRequired:p,theme:h,isPreview:g,appStoreService:E,metaOsSdk:S}},c.createElement(Bn,{pluginsGrouped:t,isPluginDataLoaded:o,storeFrontPlugins:i,isStoreFrontPluginsDataLoaded:s,enableMorePlugins:m,isMorePluginHyperlinkEnabled:y,sourceName:v,positioningRef:C,fetchPluginsByNetwork:M,enablePluginSearch:b,tokenService:A,enableManagePlugins:I,dismissFlyoutCallback:P,enableStoreFrontPlugins:T,enableCreatePpcConnections:x,mountTooltipToBody:w,showGetCopilotExtensions:_,enablePluginsAsDeclarativeAgents:D})))}var zn=n(26856),Gn=n(92619),Wn=n(18603),qn=n(38879),Qn=n(58325),Kn=n(96895),Yn=n(19399),$n=n(29328),Jn=n(15120),Xn=n(62388),Zn=n(26197),eo=n(7369);const to=(0,eo.a)({palette:{...Nn.o,themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000"}});(0,eo.a)({palette:{...Vn.C,themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF"}});let no;const oo=()=>no,ro=({themePalette:e,isDarkMode:t,dir:n,children:o,className:r})=>{const i={...to.palette,...e},a=(0,Zn.i)(i),s=t?(0,Jn.W)(a):(0,Xn.a)(a);return no=s,c.createElement(yt.q,{className:r,theme:s,dir:n},o)};var io=n(59762),ao=n(82027),so=n(19997),lo=n(44907),co=n(3334),uo=n(73090),po=n(71808),ho=n(78363);const go={dialogContainer:{width:"90%",maxWidth:"none",...de.Pt.padding("20px"),...de.Pt.borderRadius(G.L.borderRadiusMedium),...de.Pt.border("none"),...de.Pt.outline("3px","solid",G.L.colorTransparentBackground),display:"block",position:"fixed",bottom:0,marginBottom:"5vh"},dialogContent:{...de.Pt.margin("5px","0px"),...de.Pt.padding("0px","2px"),maxHeight:"50vh",":hover::-webkit-scrollbar-thumb":{backgroundColor:G.L.colorNeutralForeground4,...de.Pt.border("2px","solid",G.L.colorNeutralBackground3),...de.Pt.borderRadius(G.L.borderRadiusMedium)},"&::-webkit-scrollbar":{width:G.L.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:G.L.colorNeutralBackground5},"@media (max-height: 359px)":{overflowY:"auto"}},actionButtons:{"@media (max-width: 480px)":{flexDirection:"row",justifyContent:"flex-end",display:"flex"}}};const fo=(0,x.n)({dialogContainer:go.dialogContainer??{},dialogContent:go.dialogContent??{},actionButtons:go.actionButtons??{}}),mo=e=>{const{buttonText:t,dialogHeaderText:n,dialogBody:o,primaryButtonText:r,secondaryButtonText:i,morePluginsDialogOpen:a,setMorePluginsDialogOpen:s,actionButtonClick:l,primaryButtonClick:u,secondaryButtonClick:d}=e,p=fo();return c.createElement(ao.l,{open:a,onOpenChange:(e,t)=>{s&&t&&s(t.open)},modalType:"non-modal"},t?c.createElement(so.z,{disableButtonEnhancement:!0},c.createElement(j.$,{onClick:()=>{l&&l()}},t)):c.createElement(c.Fragment,null),c.createElement(lo.E,{className:p.dialogContainer},c.createElement(co.R,null,n&&c.createElement(uo.L,null,n),o&&c.createElement(po.C,{className:p.dialogContent},o),c.createElement(ho.i,{className:p.actionButtons},r&&c.createElement(so.z,{disableButtonEnhancement:!0},c.createElement(j.$,{appearance:"primary",onClick:()=>{u&&u()}},r)),i&&c.createElement(so.z,{disableButtonEnhancement:!0},c.createElement(j.$,{appearance:"secondary",onClick:()=>{d&&d()}},i))))))},yo=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogHeader"),vo=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogPrimaryButtonText"),Co=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogSecondaryButtonText"),bo=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogBody"),Eo=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogStep1"),Ao=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogStep2"),So=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogStep2Suffix"),Io=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogStep3"),Po=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogStep4"),To=(0,ce.Ex)("officeaicopilot-chatinput.morePluginsDialogStep5"),xo=()=>{const e=(0,te.kQ)({morePluginsDialogBody:bo,morePluginsDialogStep2Suffix:So}),t=(()=>{const[e,t]=(0,c.useState)([]),n=(0,te.kQ)({morePluginsDialogStep1:Eo,morePluginsDialogStep2:Ao,morePluginsDialogStep3:Io,morePluginsDialogStep4:Po,morePluginsDialogStep5:To});return(0,c.useEffect)((()=>{t([n.morePluginsDialogStep1(),n.morePluginsDialogStep2(),n.morePluginsDialogStep3(),n.morePluginsDialogStep4(),n.morePluginsDialogStep5()])}),[]),e})(),n=c.createElement("ol",null,t.map(((t,n)=>1===n?c.createElement("li",{key:n},t," ",c.createElement("span",{style:{verticalAlign:"middle"}},c.createElement($n._Jm,null))," ",e.morePluginsDialogStep2Suffix()):c.createElement("li",{key:n},t))));return c.createElement(c.Fragment,null,c.createElement("p",null,e.morePluginsDialogBody()),n)};var wo=n(56148),ko=n(27908),_o=n(55061),Do=n(21861),Fo=n(19385),Lo=n(98226);const Oo={popOver:{boxSizing:"border-box",minWidth:"304px",maxWidth:"calc(100% - 20px)",maxHeight:"390px",...de.Pt.overflow("hidden","auto"),marginRight:"20px",backgroundColor:G.L.colorNeutralBackground1,paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"4px",":hover::-webkit-scrollbar-thumb":{backgroundColor:G.L.colorNeutralForeground4,...de.Pt.border("2px","solid",G.L.colorNeutralBackground3),...de.Pt.borderRadius(G.L.borderRadiusMedium)},"&::-webkit-scrollbar":{width:G.L.spacingHorizontalS},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-corner":{backGroundColor:G.L.colorNeutralBackground5}},menuItem:{backgroundColor:G.L.colorNeutralBackground1,maxWidth:"inherit",...de.Pt.padding("0px"),...de.Pt.border("2px","solid","transparent"),...de.Pt.borderRadius(G.L.borderRadiusMedium),"> span":{...de.Pt.overflow("hidden")},"&:focus-within":{backgroundColor:G.L.colorNeutralBackground1Hover,...de.Pt.border("2px","solid",G.L.colorNeutralBackground1Hover)},[Lo.up]:{":hover":{...de.Pt.border("2px","dashed","Highlight")}}},descriptionSection:{color:G.L.colorNeutralForeground2Link,paddingBottom:"6px"},installedSection:{display:"flex",paddingBottom:"10px",flexDirection:"column",...de.Pt.gap("2px"),alignSelf:"stretch"},description:{paddingBottom:"6px",fontFamily:"Segoe UI",fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",color:G.L.colorNeutralForeground2Link},titleContainer:{display:"flex",flexDirection:"row",...de.Pt.gap("8px")},title:{color:G.L.colorNeutralForeground2,paddingBottom:"8px",paddingTop:"8px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:600,lineHeight:"20px",display:"flex",flexDirection:"column",alignItems:"flex-start",...de.Pt.gap("10px"),alignSelf:"stretch"},previewTitleContainer:{paddingTop:"10px",paddingBottom:"10px"},previewTitle:{height:"16px",color:G.L.colorNeutralForeground2,backgroundColor:G.L.colorNeutralBackground4,paddingLeft:"4px",paddingRight:"4px",...de.Pt.borderRadius("8px"),display:"flex",flexDirection:"row",alignSelf:"stretch",fontFamily:"Segoe UI",fontSize:"10px",fontStyle:"normal",fontWeight:600,lineHeight:"14px"},shimmerComponent:{...de.Pt.padding("6px","6px","6px","0px")},labelInfo:{backgroundColor:G.L.colorNeutralBackground1,"&:focus-within":{backgroundColor:G.L.colorNeutralBackground1Hover,...de.Pt.border("2px","solid",G.L.colorNeutralBackground1Hover),...de.Pt.borderRadius(G.L.borderRadiusMedium)}}};const Ro=(0,x.n)({popOver:Oo.popOver??{},titleContainer:Oo.titleContainer??{},descriptionSection:Oo.descriptionSection??{},title:Oo.title??{},previewTitleContainer:Oo.previewTitleContainer??{},previewTitle:Oo.previewTitle??{},menuItem:Oo.menuItem??{},installedSection:Oo.installedSection??{},description:Oo.description??{},shimmerComponent:Oo.shimmerComponent??{},labelInfo:Oo.labelInfo??{}}),Mo={shimmer:G.L.colorNeutralStencil1,shimmerWave:G.L.colorNeutralStencil2,background:G.L.colorNeutralBackground1},Bo=e=>c.createElement("svg",{className:e,width:"18",height:"19",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M7.25 2.2207H10.75C11.1642 2.2207 11.5 2.55649 11.5 2.9707V4.7207H6.5V2.9707C6.5 2.55649 6.83579 2.2207 7.25 2.2207ZM5 2.9707V4.7207H3.25C1.45507 4.7207 0 6.17578 0 7.9707V15.4707C0 17.2656 1.45507 18.7207 3.25 18.7207H14.75C16.5449 18.7207 18 17.2656 18 15.4707V7.9707C18 6.17578 16.5449 4.7207 14.75 4.7207H13V2.9707C13 1.72806 11.9926 0.720703 10.75 0.720703H7.25C6.00736 0.720703 5 1.72806 5 2.9707ZM16.5 7.9707V9.4707C16.5 10.4372 15.7165 11.2207 14.75 11.2207H11V10.7207C11 10.1684 10.5523 9.7207 10 9.7207H8C7.44772 9.7207 7 10.1684 7 10.7207V11.2207H3.25C2.2835 11.2207 1.5 10.4372 1.5 9.4707V7.9707C1.5 7.0042 2.2835 6.2207 3.25 6.2207H14.75C15.7165 6.2207 16.5 7.0042 16.5 7.9707ZM16.5 12.2098V15.4707C16.5 16.4372 15.7165 17.2207 14.75 17.2207H3.25C2.2835 17.2207 1.5 16.4372 1.5 15.4707V12.2098C2.00515 12.5332 2.60568 12.7207 3.25 12.7207H7C7 13.273 7.44772 13.7207 8 13.7207H10C10.5523 13.7207 11 13.273 11 12.7207H14.75C15.3943 12.7207 15.9949 12.5332 16.5 12.2098Z"})),No=e=>c.createElement("svg",{className:e,width:"16",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("path",{d:"M2 0.720703C0.89543 0.720703 0 1.61613 0 2.7207V18.7207C0 19.8253 0.895431 20.7207 2 20.7207H14C15.1046 20.7207 16 19.8253 16 18.7207V8.54847C16 8.01804 15.7893 7.50933 15.4142 7.13426L9.58645 1.30649C9.21137 0.931417 8.70267 0.720703 8.17223 0.720703H2ZM1.5 2.7207C1.5 2.44456 1.72386 2.2207 2 2.2207H8V6.7207C8 7.82527 8.89543 8.7207 10 8.7207H14.5V18.7207C14.5 18.9968 14.2761 19.2207 14 19.2207H2C1.72386 19.2207 1.5 18.9968 1.5 18.7207V2.7207ZM13.3793 7.2207H10C9.72386 7.2207 9.5 6.99685 9.5 6.7207V3.34136L13.3793 7.2207Z"})),Vo=e=>c.createElement("svg",{className:e,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("g",{clipPath:"url(#clip0_741_74312)"},c.createElement("path",{d:"M10 18.4961C9.21875 18.4961 8.4668 18.3952 7.74414 18.1934C7.02148 17.9915 6.3444 17.7051 5.71289 17.334C5.08138 16.9629 4.50846 16.5202 3.99414 16.0059C3.47982 15.4915 3.03711 14.9186 2.66602 14.2871C2.29492 13.6556 2.00846 12.9785 1.80664 12.2559C1.60482 11.5332 1.50391 10.7812 1.50391 10C1.50391 9.21875 1.60482 8.4668 1.80664 7.74414C2.00846 7.02148 2.29492 6.3444 2.66602 5.71289C3.03711 5.08138 3.47982 4.50846 3.99414 3.99414C4.50846 3.47982 5.08138 3.03711 5.71289 2.66602C6.3444 2.29492 7.02148 2.00846 7.74414 1.80664C8.4668 1.60482 9.21875 1.50391 10 1.50391C10.7812 1.50391 11.5332 1.60482 12.2559 1.80664C12.9785 2.00846 13.6556 2.29492 14.2871 2.66602C14.9186 3.03711 15.4915 3.47982 16.0059 3.99414C16.5202 4.50846 16.9629 5.08138 17.334 5.71289C17.7051 6.3444 17.9915 7.02148 18.1934 7.74414C18.3952 8.4668 18.4961 9.21875 18.4961 10C18.4961 10.7812 18.3952 11.5332 18.1934 12.2559C17.9915 12.9785 17.7051 13.6556 17.334 14.2871C16.9629 14.9186 16.5202 15.4915 16.0059 16.0059C15.4915 16.5202 14.9186 16.9629 14.2871 17.334C13.6556 17.7051 12.9785 17.9915 12.2559 18.1934C11.5332 18.3952 10.7812 18.4961 10 18.4961Z",fill:"#FAFAFA"}),c.createElement("path",{d:"M19.0039 10C19.0039 10.8268 18.8965 11.6243 18.6816 12.3926C18.4668 13.1543 18.1641 13.8704 17.7734 14.541C17.3828 15.2051 16.9141 15.8105 16.3672 16.3574C15.8203 16.9043 15.2148 17.3763 14.5508 17.7734C13.8802 18.1641 13.1641 18.4668 12.4023 18.6816C11.6341 18.8965 10.8366 19.0039 10.0098 19.0039C9.18294 19.0039 8.38542 18.8965 7.61719 18.6816C6.84896 18.4668 6.13281 18.1641 5.46875 17.7734C4.79818 17.3828 4.18945 16.9141 3.64258 16.3672C3.08919 15.8203 2.61719 15.2148 2.22656 14.5508C1.83594 13.8802 1.5332 13.1608 1.31836 12.3926C1.10352 11.6243 0.996094 10.8268 0.996094 10C0.996094 9.17318 1.10352 8.37891 1.31836 7.61719C1.5332 6.84896 1.83594 6.13281 2.22656 5.46875C2.61719 4.79818 3.08919 4.18945 3.64258 3.64258C4.18945 3.08919 4.79818 2.61719 5.46875 2.22656C6.13281 1.83594 6.84896 1.5332 7.61719 1.31836C8.37891 1.10352 9.17318 0.996094 10 0.996094C10.8268 0.996094 11.6243 1.10352 12.3926 1.31836C13.1543 1.5332 13.8704 1.83594 14.541 2.22656C15.2051 2.61719 15.8138 3.08919 16.3672 3.64258C16.9141 4.18945 17.3828 4.79818 17.7734 5.46875C18.1641 6.13281 18.4668 6.84896 18.6816 7.61719C18.8965 8.37891 19.0039 9.17318 19.0039 10ZM10 17.998C10.2344 17.998 10.4883 17.8841 10.7617 17.6562C11.0286 17.4284 11.2891 17.0996 11.543 16.6699C11.7904 16.2402 12.0215 15.7161 12.2363 15.0977C12.4512 14.4792 12.6237 13.7793 12.7539 12.998H7.24609C7.3763 13.7793 7.54883 14.4792 7.76367 15.0977C7.97852 15.7161 8.21289 16.2402 8.4668 16.6699C8.71419 17.0996 8.97461 17.4284 9.24805 17.6562C9.51497 17.8841 9.76562 17.998 10 17.998ZM12.9004 12.002C12.9329 11.6829 12.959 11.3574 12.9785 11.0254C12.9915 10.6934 12.998 10.3516 12.998 10C12.998 9.64844 12.9915 9.30664 12.9785 8.97461C12.959 8.64258 12.9329 8.31706 12.9004 7.99805H7.09961C7.06706 8.31706 7.04427 8.64258 7.03125 8.97461C7.01172 9.30664 7.00195 9.64844 7.00195 10C7.00195 10.3516 7.01172 10.6934 7.03125 11.0254C7.04427 11.3574 7.06706 11.6829 7.09961 12.002H12.9004ZM2.00195 10C2.00195 10.6771 2.08659 11.3444 2.25586 12.002H6.10352C6.07096 11.6764 6.04492 11.3477 6.02539 11.0156C6.00586 10.6836 5.99609 10.3451 5.99609 10C5.99609 9.65495 6.00586 9.31641 6.02539 8.98438C6.04492 8.65234 6.07096 8.32357 6.10352 7.99805H2.25586C2.08659 8.6556 2.00195 9.32292 2.00195 10ZM10 2.00195C9.76562 2.00195 9.51497 2.11589 9.24805 2.34375C8.97461 2.57161 8.71419 2.90039 8.4668 3.33008C8.21289 3.75977 7.97852 4.28385 7.76367 4.90234C7.54883 5.52083 7.3763 6.2207 7.24609 7.00195H12.7539C12.6237 6.2207 12.4512 5.52083 12.2363 4.90234C12.0215 4.28385 11.7904 3.75977 11.543 3.33008C11.2891 2.90039 11.0286 2.57161 10.7617 2.34375C10.4883 2.11589 10.2344 2.00195 10 2.00195ZM13.8965 7.99805C13.929 8.32357 13.9551 8.65234 13.9746 8.98438C13.9941 9.31641 14.0039 9.65495 14.0039 10C14.0039 10.3451 13.9941 10.6836 13.9746 11.0156C13.9551 11.3477 13.929 11.6764 13.8965 12.002H17.7441C17.9134 11.3444 17.998 10.6771 17.998 10C17.998 9.32292 17.9134 8.6556 17.7441 7.99805H13.8965ZM17.4121 7.00195C17.1777 6.42253 16.8815 5.88216 16.5234 5.38086C16.1654 4.87305 15.7585 4.41732 15.3027 4.01367C14.8405 3.60352 14.3359 3.25195 13.7891 2.95898C13.2422 2.65951 12.6628 2.42839 12.0508 2.26562C12.4479 2.79948 12.7962 3.47331 13.0957 4.28711C13.3887 5.0944 13.6133 5.99935 13.7695 7.00195H17.4121ZM7.94922 2.26562C7.33724 2.42839 6.75781 2.65951 6.21094 2.95898C5.66406 3.25195 5.16276 3.60352 4.70703 4.01367C4.24479 4.41732 3.83464 4.87305 3.47656 5.38086C3.11849 5.88216 2.82227 6.42253 2.58789 7.00195H6.23047C6.38672 5.99935 6.61458 5.0944 6.91406 4.28711C7.20703 3.47331 7.55208 2.79948 7.94922 2.26562ZM2.58789 12.998C2.82227 13.5775 3.11849 14.1211 3.47656 14.6289C3.83464 15.1302 4.24479 15.5859 4.70703 15.9961C5.16276 16.3997 5.66406 16.7513 6.21094 17.0508C6.75781 17.3438 7.33724 17.5716 7.94922 17.7344C7.55208 17.2005 7.20703 16.5299 6.91406 15.7227C6.61458 14.9089 6.38672 14.0007 6.23047 12.998H2.58789ZM12.0508 17.7344C12.6628 17.5716 13.2422 17.3438 13.7891 17.0508C14.3359 16.7513 14.8405 16.3997 15.3027 15.9961C15.7585 15.5859 16.1654 15.1302 16.5234 14.6289C16.8815 14.1211 17.1777 13.5775 17.4121 12.998H13.7695C13.6133 14.0007 13.3887 14.9089 13.0957 15.7227C12.7962 16.5299 12.4479 17.2005 12.0508 17.7344Z",fill:"#3A3A38"})),c.createElement("defs",null,c.createElement("clipPath",{id:"clip0_741_74312"},c.createElement("rect",{width:"20",height:"20",fill:"white"})))),Ho=e=>c.createElement("svg",{className:e,width:"20",height:"21",viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("g",{clipPath:"url(#clip0_98326_1271)"},c.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint0_linear_98326_1271)"}),c.createElement("path",{d:"M8.13676 1.49186H10.45L10.9 4.89929L8.64998 7.14931L6.39998 8.71324V10.5166C6.39998 11.7762 7.05827 12.9442 8.13579 13.5964L10.5044 15.0302L5.49999 17.9495H4.53477L2.73581 16.8605C1.65828 16.2083 1 15.0403 1 13.7808V7.71656C1 6.4566 1.6587 5.28833 2.73678 4.63622L8.13676 1.37988V1.49186Z",fill:"url(#paint1_linear_98326_1271)"}),c.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint2_radial_98326_1271)"}),c.createElement("path",{d:"M13.6003 8.49951V10.5157C13.6003 11.7752 12.942 12.9432 11.8645 13.5954L6.4645 16.8641C5.35987 17.5327 3.98543 17.5569 2.86133 16.9365L8.13612 20.1294C9.2821 20.8231 10.7185 20.8231 11.8645 20.1294L17.2644 16.8607C18.342 16.2085 19.0003 15.0405 19.0003 13.7809V12.3245L18.5503 11.6495L13.6003 8.49951Z",fill:"url(#paint3_linear_98326_1271)"}),c.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint4_radial_98326_1271)"}),c.createElement("path",{d:"M17.2636 4.63662L11.8636 1.37026C10.7536 0.698826 9.37133 0.678026 8.24444 1.30786L8.13717 1.37275C7.05909 2.02486 6.40039 3.19313 6.40039 4.45309V8.72087L8.13717 7.67032C9.28268 6.97742 10.7181 6.97742 11.8636 7.67032L17.2636 10.9367C18.3079 11.5684 18.9587 12.6845 18.9984 13.8991C18.9997 13.8599 19.0003 13.8206 19.0003 13.7812V7.71697C19.0003 6.457 18.3416 5.28873 17.2636 4.63662Z",fill:"url(#paint5_linear_98326_1271)"})),c.createElement("defs",null,c.createElement("linearGradient",{id:"paint0_linear_98326_1271",x1:"9.52494",y1:"5.71629",x2:"4.86462",y2:"20.1745",gradientUnits:"userSpaceOnUse"},c.createElement("stop",{stopColor:"#AE7FE2"}),c.createElement("stop",{offset:"1",stopColor:"#0078D4"})),c.createElement("linearGradient",{id:"paint1_linear_98326_1271",x1:"7.5417",y1:"16.3092",x2:"6.72169",y2:"14.7676",gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),c.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),c.createElement("radialGradient",{id:"paint2_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.98808 16.3592) rotate(-13.1869) scale(13.9366 10.8259)"},c.createElement("stop",{offset:"0.140029",stopColor:"#D59DFF"}),c.createElement("stop",{offset:"1",stopColor:"#5E438F"})),c.createElement("linearGradient",{id:"paint3_linear_98326_1271",x1:"16.6314",y1:"10.9555",x2:"15.8357",y2:"12.2201",gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:"0.9999",stopColor:"#493474"}),c.createElement("stop",{offset:"1",stopColor:"#8C66BA",stopOpacity:"0"})),c.createElement("radialGradient",{id:"paint4_radial_98326_1271",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.9836 11.3541) rotate(-160.581) scale(16.4238 16.5011)"},c.createElement("stop",{stopColor:"#50E6FF"}),c.createElement("stop",{offset:"1",stopColor:"#436DCD"})),c.createElement("linearGradient",{id:"paint5_linear_98326_1271",x1:"5.49905",y1:"5.87339",x2:"8.12498",y2:"5.87339",gradientUnits:"userSpaceOnUse"},c.createElement("stop",{offset:"0.9999",stopColor:"#2D3F80"}),c.createElement("stop",{offset:"1",stopColor:"#436DCD",stopOpacity:"0"})),c.createElement("clipPath",{id:"clip0_98326_1271"},c.createElement("rect",{y:"0.75",width:"20",height:"20",rx:"2",fill:"white"})))),Uo=c.createElement("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},c.createElement("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2zm0 18c-4.4 0-8-3.6-8-8s3.6-8 8-8 8 3.6 8 8-3.6 8-8 8zM11 7h2v2h-2V7zm0 3h2v6h-2V10z"})),jo={tooltipText:{width:"216px",fontSize:"12px"},tooltip:{alignSelf:"center","> button":{backgroundColor:"none",minWidth:"0px",maxHeight:"18px",maxWidth:"18px",...de.Pt.padding("4px"),...de.Pt.borderStyle("none"),...de.Pt.borderRadius("18px")}},infoButton:{backgroundColor:"inherit",boxShadow:"none",lineHeight:"6px",...de.Pt.border("2px","solid","transparent"),...de.Pt.borderColor(G.L.borderRadiusCircular),"> span":{maxHeight:"18px",maxWidth:"18px"},"&:focus-within":{...de.Pt.border("2px","solid",G.L.colorNeutralBackground1Hover)},":hover":{backgroundColor:G.L.colorNeutralForeground2BrandHover,"> span > svg > path":{fill:G.L.colorNeutralBackground2}},[Lo.up]:{"> span > svg > path":{fill:"ButtonText"},":hover":{backgroundColor:"Highlight"}}}};const zo=(0,x.n)({tooltipText:jo.tooltipText??{},tooltip:jo.tooltip??{},infoButton:jo.infoButton??{}});function Go(e){const{infoMessage:t}=e,n=zo(),o=(0,te.Lh)(Ue);return c.createElement("span",{className:n.tooltip,role:wo.eg.TOOLTIP},c.createElement(U.m,{content:t,relationship:"description"},c.createElement(j.$,{icon:Uo,size:"small",className:n.infoButton,"aria-label":o})))}const Wo={appIcon:{width:"20px",height:"fit-content",float:"left",...de.Pt.padding("4px","4px","4px","4px"),...de.Pt.border("2px","solid",G.L.colorNeutralBackground3Pressed),...de.Pt.borderRadius(G.L.borderRadiusMedium)},appNameContainer:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",...de.Pt.overflow("hidden")},appNameTextContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",...de.Pt.overflow("hidden")},appName:{width:"auto",height:"auto",lineHeight:"36px",paddingLeft:"2px",paddingRight:"2px",fontFamily:"Segoe UI",fontSize:"14px",fontStyle:"normal",fontWeight:400,color:G.L.colorNeutralForeground2Link,whiteSpace:"nowrap",...de.Pt.overflow("hidden"),textOverflow:"ellipsis"},appInfo:{...de.Pt.gap("4px"),display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1},...de.Pt.overflow("hidden"),alignContent:"center",justifyItems:"left",alignItems:"center"},blocked:{opacity:.5},infoIcon:{alignSelf:"left",float:"left"},pluginItem:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",maxHeight:"100px",...de.Pt.gap("4px"),justifyContent:"space-between","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},toggleControl:{float:"right",paddingLeft:"4px",justifyItems:"right",height:"36px","@media (forced-colors: active)":{forcedColorAdjust:"none"}},spinner:{paddingTop:"8px",paddingInlineEnd:"20px"}};const qo=(0,x.n)(Wo),Qo={pluginAdminBlockedInfo:Be,pluginDefaultBlockedInfo:Ne};function Ko(e){const t=(0,te.kQ)(Qo),n=t.pluginAdminBlockedInfo(),o=t.pluginDefaultBlockedInfo().length>0?t.pluginDefaultBlockedInfo():"The service required to use web content is not available.",{title:r,plugin:i}=e,a=qo(),[s,l]=c.useState(i.state==zn.p.Enabled),u=c.useCallback(((e,t)=>{d(t.checked)}),[]);c.useEffect((()=>{l(i.state==zn.p.Enabled)}),[i.state]);const d=e=>{i.onToggle(e),l(e)},p=i.state===zn.p.Blocked?a.blocked:void 0,h=c.useMemo((()=>{const e=i.state==zn.p.Blocked||i.state==zn.p.DefaultBlocked;return c.createElement("div",{className:a.toggleControl},c.createElement(an.d,{disabled:!!e,checked:s,onChange:u,tabIndex:-1,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),d(!(i.state==zn.p.Enabled)))},role:"switch"}))}),[d,i.state]),g=i.state===zn.p.Blocked||i.state===zn.p.DefaultBlocked?c.createElement(Go,{infoMessage:i.state==zn.p.Blocked?n:o}):null;let f=a.appName;f=(0,T.z)(f,p);const m=(y=i.id)===ko.$.Web?Vo(a.appIcon):y===ko.$.Work?Ho(a.appIcon):void 0;var y;const v=c.createElement("div",{className:a.appInfo},m,c.createElement("div",{className:a.appNameTextContainer},c.createElement(ye.E,{className:f},r),g));return c.createElement("div",{className:a.pluginItem},v,h)}const Yo={enterprisePluginTitle:Ve,pluginsFlyoutInfo:Re,pluginFlyoutInfoTip:Me,pluginsFlyoutTitle:Le,previewLabel:Oe,webPluginTitle:He};function $o(e){const t=(0,te.kQ)(Yo),{plugins:n,isPluginDataLoaded:o}=e,r=Ro(),i=c.useCallback((e=>{if(a.current.push(e),n.length===a.current.length){const e=C;for(let t=0;t<e.length;t++)if(!e[t].props.disabled){requestAnimationFrame((()=>{a.current[t].focus()}));break}}}),[]),a=c.useRef([]),s=r.title,l=r.previewTitle,u=r.descriptionSection,d=r.description,p=c.createElement(Go,{infoMessage:t.pluginFlyoutInfoTip()}),h=c.createElement("div",{className:r.previewTitleContainer},c.createElement(ye.E,{className:l},t.previewLabel())),g=c.createElement("div",{className:u},c.createElement("div",{className:r.titleContainer},c.createElement(ye.E,{role:wo.eg.HEADING,"aria-level":1,"aria-label":t.pluginsFlyoutTitle(),className:s},t.pluginsFlyoutTitle()),e.isPreview&&h),c.createElement(ye.E,{className:d},t.pluginsFlyoutInfo()),p),f=[{type:_o.w.circle,height:22.7},{type:_o.w.gap,width:10},{type:_o.w.line,height:10,width:160},{type:_o.w.gap,width:80},{type:_o.w.line,height:10}],m=c.memo((()=>c.createElement(Do.W,{className:r.shimmerComponent,shimmerElements:f,shimmerColors:Mo})));m.displayName="ShimmerComponent";const y=e=>{const t=e.target,n=e.currentTarget?.querySelector('[role="switch"]');t!==n&&(e.preventDefault(),n?.click(),t?.focus())},v=e=>{"Enter"!==e.key&&" "!==e.key||y(e)},C=c.useMemo((()=>n.map(((e,n)=>{const o=e.state===zn.p.Blocked,a=(s=e.id)===ko.$.Work?t.enterprisePluginTitle():s===ko.$.Web?t.webPluginTitle():void 0;var s;return c.createElement(kt.D,{role:"button",key:n,persistOnClick:!0,className:r.menuItem,tabIndex:o?-1:0,disabled:o,onKeyDown:v,onClick:y,"aria-label":a,"aria-pressed":e.state===zn.p.Enabled,ref:i},c.createElement(Ko,{title:a,plugin:e,key:e.id}))}))),[n]),b=c.createElement("div",{className:r.installedSection},o?C:(()=>{const e=n.length;return c.createElement(c.Fragment,null,[...Array(e)].map(((e,t)=>c.createElement(m,{key:t}))))})());return c.createElement(yt.q,null,c.createElement(Fo.b,{role:wo.eg.DIALOG,className:r.popOver},c.createElement(Tt.c,null,g,b)))}const Jo={color:G.L.colorBrandForeground1},Xo=(0,x.n)({menuPopOver:{minWidth:"304px",maxWidth:"calc(100% - 20px)",overflowX:"hidden",boxSizing:"border-box",marginRight:"20px",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"12px",paddingRight:"0px",maxHeight:"fit-content",overflowY:"hidden"}}),Zo=({title:e,isDisabled:t,isMenuOpen:n=!1,setMenuOpen:o,targetRef:r,shouldBlockGroundingButtonClick:i=()=>!1,groundingButtonPluginProps:a})=>{const[s,l]=(0,c.useState)(n),[u,d]=(0,c.useState)(!1),p=c.useRef(null),[h,g]=(0,c.useState)(!1),f=c.useRef(null),m=Xo(),y=(0,te.kQ)({morePluginsDialogHeader:yo,morePluginsDialogPrimaryButtonText:vo,morePluginsDialogSecondaryButtonText:Co,morePluginsDialogBody:bo,morePluginsDialogStep2Suffix:So});c.useEffect((()=>{r&&p.current?.setTarget(r)}),[r,p]),(0,c.useEffect)((()=>{l(n)}),[n]),(0,c.useEffect)((()=>{o(s)}),[s,o]);const v=c.useCallback(((e,t)=>{i&&i()||(t?.open&&(a.onGroundingButtonClick?.(),a.copilotPluginFlyoutProps?.telemetryService?.LogPluginMenuClicked()),o(t?.open))}),[o,i]);(0,c.useEffect)((()=>{g(0===a.plugins?.filter((e=>e.state===zn.p.Shimmer)).length)}),[a]);const C=()=>{window.open(io.Q6,"_blank")},b={openAppStore:()=>{a.copilotPluginFlyoutProps.enableMorePlugins&&(C(),o(!1))}},E=c.useMemo((()=>{if(!a.plugins)return[];if(!a.pluginBlockedInfo){const e=[];return a.plugins?.forEach((t=>{const n={...t,state:zn.p.DefaultBlocked};e.push(n)})),e}if(!a.pluginBlockedInfo?.length)return a.plugins;const e=[];return a.plugins?.forEach((t=>{const n={...t,state:a.pluginBlockedInfo.includes(t.id)?zn.p.Blocked:t.state};e.push(n)})),e}),[a]),A=c.createElement(U.m,{content:e,relationship:"label",positioning:"above",withArrow:!0},c.createElement(j.$,{appearance:"transparent",disabled:t,icon:s?{children:$($n.bq_),style:Jo}:{children:Y($n.d2l,$n.bq_)},"aria-label":e})),S=(0,Gn.Y$)();if(a.copilotPluginFlyoutProps){const e={target:r,positioningRef:f,align:"center",position:"above"};return c.createElement(c.Fragment,null,c.createElement(Wn.A,{open:s,onOpenChange:v,positioning:e,trapFocus:!0},c.createElement(qn.W,null,A),c.createElement(yt.q,null,c.createElement(Qn.H,{className:m.menuPopOver},c.createElement(jn,{...a.copilotPluginFlyoutProps,isMorePluginHyperlinkEnabled:S?.enableMorePluginHyperLinkInFlyout,positioningRef:f,fluentTheme:oo(),mountTooltipToBody:!0,appStoreService:b,enablePluginSearch:S?.enablePluginSearchInFlyout})))),c.createElement(mo,{dialogHeaderText:y.morePluginsDialogHeader(),primaryButtonText:y.morePluginsDialogPrimaryButtonText(),secondaryButtonText:y.morePluginsDialogSecondaryButtonText(),dialogBody:c.createElement(xo,null),morePluginsDialogOpen:u,setMorePluginsDialogOpen:d,primaryButtonClick:C}))}const I={target:r,align:"center",position:"above",matchTargetSize:"width"};return c.createElement(Kn.W,{open:s,onOpenChange:v,positioning:I},c.createElement(Yn.c,{disableButtonEnhancement:!0},A),c.createElement($o,{isPluginDataLoaded:h,plugins:E,isPreview:!0}))};var er=n(39492),tr=n(95457),nr=n(50987),or=n(18309),rr=n(47777),ir=n(41134),ar=n(86653);const sr={direction:ar.E.bidirectional,isCircularNavigation:!0,handleTabKey:ar.l.all},lr={selectors:{[Lo.up]:{color:"ButtonText"}}},cr=(0,nr.J9)(((e,t,n,o)=>(0,Lo.l8)({root:{direction:"inherit",borderTopLeftRadius:"8px",borderTopRightRadius:"8px"},container:{minHeight:"32px",display:"flex",flexDirection:"row",direction:"inherit",minWidth:"-webkit-fill-available",alignItems:"center",backgroundColor:G.L.colorNeutralBackground4,borderBottom:n?void 0:"solid",borderWidth:"1px",borderColor:G.L.colorNeutralStroke1,margin:n?void 0:"-4px",borderTopLeftRadius:o?void 0:"7px",borderTopRightRadius:o?void 0:"7px",borderLeftStyle:n?"solid":void 0,borderRightStyle:n?"solid":void 0,borderTopStyle:n||o?"solid":void 0},label:{fontWeight:400,fontSize:Lo.s.size12,lineHeight:"16px",textAlign:"start",display:"flex",justifyItems:"start",flexDirection:"row",alignItems:"center",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",color:t?G.L.colorNeutralForegroundDisabled:G.L.colorNeutralForeground1,paddingInlineStart:e?void 0:"10px",...lr},iconContainer:{display:"flex"},icon:{paddingInlineStart:"10px",paddingInlineEnd:"8px"},downChevron:{fill:t?G.L.colorNeutralForegroundDisabled:G.L.colorNeutralForeground1,color:t?G.L.colorNeutralForegroundDisabled:G.L.colorNeutralForeground1,...lr}}))),ur=(0,nr.J9)((e=>({root:{background:"transparent",border:"none",fontSize:Lo.s.size12,padding:0},rootHovered:{border:"none",backgroundColor:"transparent"},rootPressed:{border:"none",backgroundColor:"transparent"},rootDisabled:{border:"none",backgroundColor:"transparent",fontWeight:400},textContainer:{color:e?G.L.colorNeutralForegroundDisabled:G.L.colorNeutralForeground1,fontWeight:400,fontSize:Lo.s.size12,lineHeight:"16px",textAlign:"start",textDecoration:"underline",padding:"2px 0px 2px 0px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},menuIcon:{margin:0,color:e?G.L.colorNeutralForegroundDisabled:G.L.colorNeutralForeground1,fontSize:"8px",paddingTop:"3px"},label:{fontWeight:"normal"}}))),dr=(Lo.up,(0,Lo.Qg)(),{selectors:{[Lo.up]:{backgroundColor:"ButtonFace",color:"ButtonText",outlineColor:"inherit",...(0,Lo.Qg)()}}}),pr={selectors:{[Lo.up]:{backgroundColor:"Highlight",outlineColor:"ButtonText",outlineStyle:"dashed",...(0,Lo.Qg)()}}},hr=(0,nr.J9)((()=>({root:{padding:"6px",backgroundColor:"transparent",minWidth:"unset"},divider:{height:"1px"}}))),gr=(0,nr.J9)((()=>({root:{border:"none",minWidth:"-webkit-fill-available",minHeight:"48px",margin:"1px",padding:"0px",alignItems:"flex-start",fontWeight:400,backgroundColor:G.L.colorNeutralBackground1,color:G.L.colorNeutralForeground1,borderColor:G.L.colorNeutralStroke1,borderRadius:"6px",...dr},rootHovered:{backgroundColor:G.L.colorNeutralBackground1Hover,color:G.L.colorNeutralForeground1Hover,...pr},rootPressed:{backgroundColor:G.L.colorNeutralBackground1Pressed,color:G.L.colorNeutralForeground1Pressed,...pr},flexContainer:{[Lo.up]:{color:"HighlightText",foreground:"HighlightText",":hover label, :hover svg":{color:"HighlightText",fill:"HighlightText"},...(0,Lo.Qg)()}}}))),fr=(0,nr.J9)((()=>(0,Lo.l8)({root:{direction:"inherit",borderRadius:"7px",backgroundColor:G.L.colorNeutralBackground1},buttonContainer:{paddingLeft:"8px",paddingRight:"8px",width:"100%",alignItems:"center"},icon:{alignSelf:"center",padding:"2px",alignItems:"center",lineHeight:24,color:G.L.colorNeutralForeground1,fill:G.L.colorNeutralForeground1},container:{paddingInlineStart:"8px",alignItems:"flex-start",alignSelf:"center",display:"inline-block"},primaryLabel:{textAlign:"start",fontSize:Lo.s.size14,fontWeight:400,lineHeight:"14px",...de.Pt.padding("0px"),color:G.L.colorNeutralForeground1},secondaryLabel:{textAlign:"start",fontSize:Lo.s.size10,fontWeight:400,lineHeight:"14px",...de.Pt.padding("0px"),color:G.L.colorNeutralForeground2Link}}))),mr=(e,t)=>{const n=e.key+"_desc";return c.createElement(yt.q,{className:e.root},c.createElement(rr.Y,{onClick:(n,o)=>{e.onClick(),t(n,o)},styles:gr(),role:"menuitem"},c.createElement(er.B,{horizontal:!0,className:e.buttonContainerClass},(o=e.iconClass,{[ko.$.CurrentContext]:No(o),[ko.$.Work]:Bo(o)})[e.iconId],c.createElement(er.B,{className:e.containerClass},c.createElement(tr.J,{className:e.primaryClass,"aria-describedby":n},e.text),c.createElement(tr.J,{className:e.secondaryTextClass,id:n},e.secondaryText)))));var o},yr=(0,nr.J9)(((e,t,n,o)=>{const r=t.map((e=>((e,t)=>{const n=fr();return{key:e.primary,text:e.primary,secondaryText:e.secondary,iconId:e.id,root:n.root,containerClass:n.container,buttonContainerClass:n.buttonContainer,primaryClass:n.primaryLabel,secondaryTextClass:n.secondaryLabel,iconClass:n.icon,onClick:n=>{t(e,n)},onRender:mr}})(e,n)));return{target:e,alignTargetEdge:!0,isBeakVisible:!1,gapSpace:4,directionalHint:or.A.topCenter,items:r,styles:hr,focusZoneProps:sr,calloutProps:(i=e?.offsetWidth,{setInitialFocus:!0,styles:{root:{width:i?i+16:364,borderRadius:"8px"},calloutMain:{backgroundColor:oo().colorNeutralBackground1,borderRadius:"8px"}}}),onDismiss:o};var i})),vr=e=>{const[t,n]=c.useState(e.sourcesData[0]),[o,r]=c.useState(!1),i=()=>{r(!0)},a=t=>{r(!1),e.onMenuDismiss&&e.onMenuDismiss(t),window.requestAnimationFrame((()=>s.querySelector("button[aria-haspopup]")?.focus()))},[s,l]=c.useState(void 0),u=cr(!!e.infoTip,e.isDisabled,e.isChatInputV3Enabled,e.isChatInputBannerVisible);return c.createElement(yt.q,{className:u.root},c.createElement("div",{className:u.container,ref:e=>{e&&l(e)}},e.infoTip&&c.createElement("div",{className:u.icon},c.createElement(Go,{infoMessage:e.infoTip})),c.createElement(tr.J,{className:u.label},e.sourcePrefix),c.createElement(rr.Y,{text:t.primary.toLocaleLowerCase(),styles:ur(e.isDisabled),onClick:i,disabled:e.isDisabled,"aria-label":e.sourcePrefix+t.primary,type:"button","aria-haspopup":"true"}),c.createElement(_t.hoY,{className:u.downChevron,"aria-label":e.infoTip,cursor:"pointer",onClick:e.isDisabled?void 0:i}),o&&s&&c.createElement(ir.l,{...yr(s,e.sourcesData,((o,r)=>{o.id!=t.id&&(n(o),e.onSelection&&e.onSelection(o)),a(r)}),a)})))};var Cr=n(41712),br=n(44434),Er=n(82532),Ar=n(92936),Sr=n(91836);const Ir=(0,x.n)({activeIcon:{color:G.L.colorBrandForeground1},uploadButton:{justifyContent:"flex-start",paddingLeft:G.L.spacingHorizontalNone,...Sr.g.body1},addImage:{paddingBottom:G.L.spacingVerticalM},disabled:{color:G.L.colorNeutralForegroundDisabled},popoverSurface:{display:"flex",flexDirection:"column",paddingLeft:G.L.spacingHorizontalS,paddingBottom:G.L.spacingVerticalS,paddingTop:G.L.spacingVerticalS,paddingRight:G.L.spacingHorizontalS},uploadFromPhoneDialogTitle:{display:"flex",justifyContent:"center"},uploadFromPhoneDialogContent:{display:"flex",justifyContent:"center",minWidth:"250px",minHeight:"250px"}});var Pr=n(4587);var Tr=n(58651);const xr="images-from-phone.zip";async function wr(e,t){const n=await fetch(`https://graph.microsoft.com/v1.0/me/drive/root:/${t}`,{method:"GET",headers:{Authorization:"Bearer "+e}});if(!n||n&&!n.ok)throw new Error(`Failed to get file item id: ${n.statusText}`);return(await n.json()).id}async function kr(e){return new Promise(((t,n)=>{const o=new FileReader;o||n(),o.onloadend=()=>{o&&o.result?t(o.result.toString()):n()},o.onerror=()=>n(),o.readAsDataURL(e)}))}var _r=n(58651);function Dr(e){!async function(e,t){try{if(void 0===e)throw new Error("Host App Auth Token not found. This is required to delete file");if(void 0===e.graphTokenProvider)throw new Error("Graph Token Provider not found. This is required to delete file");const{accessToken:n}=await e.graphTokenProvider(),o=await wr(n,t),r=await fetch(`https://graph.microsoft.com/v1.0/me/drive/items/${o}`,{method:"DELETE",headers:{Authorization:"Bearer "+n}});(!r||r&&!r.ok)&&_r.error(`Failed to delete file ${t}: ${r.statusText}`)}catch(e){_r.error(`deleteFile failed to delete ${t}: ${e}`)}}(e,xr)}var Fr=n(58651);const Lr={uploadImageFromPhoneError:st};var Or;!function(e){e[e.GenerateQRCode=1]="GenerateQRCode",e[e.DisplayQRCodeAndWaitForUpload=2]="DisplayQRCodeAndWaitForUpload",e[e.DownloadImage=3]="DownloadImage",e[e.DisplayError=4]="DisplayError"}(Or||(Or={}));const Rr=({handleUploadFromPhoneReady:e,handleUploadFromPhoneTimedOut:t,uploadPollingIntervalMs:n})=>{const o=(0,te.kQ)(Lr),r=Ir(),[i,a]=(0,c.useState)(Or.GenerateQRCode),{hostAppAuthToken:s}=(0,Cr.Mb)(),l=c.useRef(""),u=c.useRef(""),d=c.useRef(!1),p=c.useRef(!1),h=(e,t)=>{clearInterval(e),clearTimeout(t)},g=()=>{a(Or.DisplayError)},f=c.useCallback((()=>{a(Or.DownloadImage),e(),Dr(s)}),[e,s]),m=c.useCallback((()=>{g(),t()}),[t]),y=c.useCallback((()=>{if(void 0===s)return void g();a(Or.DisplayQRCodeAndWaitForUpload);const e=setInterval((async()=>{p.current?await async function(e,t){try{if(void 0===e)throw new Error("Host App Auth Token not found. This is required to check for file");if(void 0===e.graphTokenProvider)throw new Error("Graph Token Provider not found. This is required to check for file");const{accessToken:n}=await e.graphTokenProvider(),o=await fetch(t,{method:"GET",headers:{Authorization:"Bearer "+n}});if(o){if(o.ok)return 0===(await o.json()).nextExpectedRanges.length;if(404===o.status)return!0}return!1}catch(e){return Fr.error(`isUploadComplete failed: ${e}`),!0}}(s,u.current)&&(h(e,t),f()):h(e,t)}),n),t=setTimeout((()=>{clearInterval(e),p.current&&m()}),6e5)}),[f,m,s]);c.useEffect((()=>(p.current=!0,()=>{p.current=!1})),[]),c.useEffect((()=>{if(d.current)return;d.current=!0;(async()=>{void 0!==s?(u.current=await async function(e,t){try{if(void 0===e||void 0===e.graphTokenProvider)throw new Error("Graph Token Provider not found. This is required to create upload session");const{accessToken:n}=await e.graphTokenProvider(),o=await fetch(`https://graph.microsoft.com/v1.0/me/drive/root:/${t}:/createUploadSession`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}});if(!o||o&&!o.ok)throw new Error(`Failed to create upload session: ${o.statusText}`);return(await o.json()).uploadUrl}catch(e){return Tr.error(`createUploadSession failed: ${e}`),""}}(s,xr),""!==u.current?(l.current=function(e){return`https://wink-demo.azurewebsites.net/uploader.html?uu=${encodeURIComponent(e)}`}(u.current),y()):g()):g()})()}),[y,s]);let v=c.createElement(c.Fragment,null);switch(i){case Or.DisplayQRCodeAndWaitForUpload:v=c.createElement(Pr.QRCode,{value:l.current,logoImage:"https://res-2-sdf.cdn.office.net/files/fabric-cdn-prod_20240411.001/assets/brand-icons/product/svg/copilot_24x1.svg",logoPadding:1,logoPaddingStyle:"circle",qrStyle:"dots",size:250,ecLevel:"M"});break;case Or.DisplayError:v=c.createElement("span",null,o.uploadImageFromPhoneError());break;case Or.GenerateQRCode:case Or.DownloadImage:default:v=c.createElement(hn.y,null)}return c.createElement(po.C,null,c.createElement("div",{className:r.uploadFromPhoneDialogContent},v))};var Mr=n(76811),Br=n.n(Mr),Nr=n(58651);async function Vr(e,t){const n=await wr(e,t),o=await async function(e,t){const n=await fetch(`https://graph.microsoft.com/v1.0/me/drive/items/${t}?select=@microsoft.graph.downloadUrl`,{method:"GET",headers:{Authorization:"Bearer "+e}});if(!n||n&&!n.ok)throw new Error(`Failed to get downloadUrl: ${n.statusText}`);return(await n.json())["@microsoft.graph.downloadUrl"]}(e,n),r=await fetch(o);if(!r||r&&!r.ok)throw new Error(`downloadBlob failed: ${r.statusText}`);return await r.blob()}async function Hr(e){const t=await async function(e,t){try{if(void 0===e)throw new Error("Host App Auth Token not found. This is required to download files");if(void 0===e.graphTokenProvider)throw new Error("Graph Token Provider not found. This is required to download files");const{accessToken:n}=await e.graphTokenProvider(),o=await Vr(n,t);let r=[];const i=await Br().loadAsync(o),a=Object.keys(i.files);for(const e of a){const t=await(i.file(e)?.async("blob"));if(!t)continue;const n=await kr(t);r.push(n)}return r}catch(e){return Nr.error("downloadZippedFiles failed: "+e),[]}}(e,xr);return t}const Ur="pasteImageInput",jr={addImageButtonLabel:qe,pasteImageLabel:Qe,uploadImageLabel:Ye,uploadImageFromPhoneLabel:it,uploadImageFromPhoneDialogTitle:at,pasteFromClipboard:Ke},zr=({isDisabled:e,insertImageProps:t})=>{const n=(0,te.kQ)(jr),{hostAppAuthToken:o}=(0,Cr.Mb)(),r=Ir(),[i,a]=(0,c.useState)(!1),s=c.useCallback(((t,n)=>{e||a(n?.open)}),[a,e]),[l,u]=(0,c.useState)(!1);c.useEffect((()=>{i&&document.getElementById(Ur)?.focus()}),[i]);const d={size:"small",children:null,onOpenChange:s,open:i},p=c.useCallback((async()=>{const e=await Hr(o);t.handleImageUploadFromPhone(e),u(!1)}),[o,t]),h=c.useCallback((()=>{u(!1)}),[]);return c.createElement("div",null,c.createElement(Wn.A,{...d},c.createElement(qn.W,{disableButtonEnhancement:!0},c.createElement(U.m,{content:n.addImageButtonLabel(),relationship:"label",positioning:"above",withArrow:!0},c.createElement(j.$,{appearance:"transparent",icon:{children:$(xt.t1F),className:e?r.disabled:d.open?r.activeIcon:void 0}}))),c.createElement(Qn.H,{className:r.popoverSurface,tabIndex:-1},c.createElement(br.Z,{className:r.addImage},n.addImageButtonLabel()),!t.isPasteFromClipboardButtonEnabled&&c.createElement(Pt.p,{placeholder:n.pasteImageLabel(),onPaste:e=>{t.handleImagePaste(e),a(!1)},onKeyDown:e=>{"Enter"===e.key&&t.showNonImageEntryError()},id:Ur,autofocus:"autofocus"}),t.isPasteFromClipboardButtonEnabled&&c.createElement(j.$,{appearance:"subtle",icon:c.createElement(Er.if7,null),className:r.uploadButton,onClick:async n=>{if(e)return;const o=new Event("paste",{bubbles:!0,cancelable:!0}),r=new DataTransfer,i=await navigator.clipboard.read();for(const e of i){const t=e.types.find((e=>e.startsWith("image/")));if(t){const n=await e.getType(t),o=n.type.split("/")[1];r.items.add(new File([n],`pasted-image.${o}`,{type:n.type}))}}Object.defineProperty(o,"clipboardData",{value:r}),t.handleImagePaste(o),a(!1)}},n.pasteFromClipboard()),c.createElement(j.$,{appearance:"subtle",icon:c.createElement(pt.gH8,null),className:r.uploadButton,onClick:n=>{e||(t.handleImageUploadOnClick(n),a(!1))}},n.uploadImageLabel()),t.isImageFromPhoneButtonEnabled&&c.createElement(j.$,{appearance:"subtle",icon:c.createElement(Ar.A9c,null),className:r.uploadButton,onClick:()=>{u(!0),a(!1)}},n.uploadImageFromPhoneLabel()))),t.isImageFromPhoneButtonEnabled&&c.createElement(ao.l,{modalType:"non-modal",open:l,onOpenChange:(e,t)=>{t.open||(u(!1),Dr(o))}},c.createElement(lo.E,null,c.createElement(co.R,null,c.createElement(uo.L,{className:r.uploadFromPhoneDialogTitle},n.uploadImageFromPhoneDialogTitle()),c.createElement(Rr,{handleUploadFromPhoneReady:p,handleUploadFromPhoneTimedOut:h,uploadPollingIntervalMs:t.uploadPollingIntervalMs})))))},Gr=(0,x.n)({activeIcon:{color:G.L.colorBrandForeground1},disabled:{color:G.L.colorNeutralForegroundDisabled},root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),Wr=({isDisabled:e,screenshotProps:t})=>{const n="Add a screenshot",o=Gr(),r=c.createElement(j.$,{"aria-label":n,appearance:"transparent",icon:{children:$(z.F1o),className:e?o.disabled:void 0},onClick:async e=>{t.handleScreenshotOnClick(e)},disabled:e});return c.createElement("div",{className:o.root},e?r:c.createElement(U.m,{content:n,relationship:"label",positioning:"above",withArrow:!0},r))},qr=({promptGuideMenuProps:e,isDisabled:t})=>{const n=(0,te.Lh)(Fe),o=Ar.Bm_,r=Ar.xPV;return e.copilotLabProps?c.createElement(U.m,{content:n,relationship:"label",positioning:"above",withArrow:!0},c.createElement(j.$,{id:io.HP,disabled:t,appearance:"transparent",icon:Y(r,o),onClick:()=>{e.copilotLabProps.handleOnClickCopilotLab&&e.copilotLabProps.handleOnClickCopilotLab(void 0)}})):c.createElement(c.Fragment,null)},Qr=(0,x.n)({activeIcon:{color:G.L.colorBrandForeground1},menuList:{minWidth:"100%",whiteSpace:"nowrap"},highlightedText:{color:G.L.colorBrandForeground1},greyedText:{color:G.L.colorNeutralForeground4},menuItem:{paddingLeft:"10px",paddingBottom:"8px",paddingTop:"8px",paddingRight:"10px",maxWidth:"none"},menuBackButtonContainer:{display:"flex",alignItems:"center","&:hover":{color:G.L.colorNeutralForeground1}},menuBackButton:{textAlign:"left",paddingLeft:0},menuBackButtonText:{whiteSpace:"nowrap",fontWeight:"600",fontSize:"12px",paddingLeft:"8px"}});var Kr=n(7524),Yr=n(3296),$r=n(72467);const Jr=(0,c.forwardRef)((({dataNode:e,updatePopoverOpen:t,updateDataNode:n,menuProps:o},r)=>{const i=Qr(),{text:a="",data:s,iconHover:l,iconRegular:u,children:d}=e,p=(d?.length||0)>0,{chunks:h,shouldHighlight:g,shouldGrey:f}=(e=>{const t=[],n=[],o=[],r=e.lastIndexOf(")"),i=e.lastIndexOf("(",r),a=e.lastIndexOf("]"),s=e.lastIndexOf("[",a);return r>i&&i>=0?(t.push(e.slice(0,i),e.slice(i,r+1),e.slice(r+1)),n.push(!1,!0,!1),o.push(!1,!1,!1)):a>s&&s>=0?(t.push(e.slice(0,s),e.slice(s,a+1),e.slice(a+1)),n.push(!1,!0,!1),o.push(!1,!0,!1)):(t.push(e),n.push(!1),o.push(!1)),{chunks:t,shouldHighlight:n,shouldGrey:o}})(a),m=(e,t,n,r)=>{o.handleOnClickStarterPromptMenuItem&&o.handleOnClickStarterPromptMenuItem(e,t,n,r)},y=c.useCallback((()=>{if(!d)return t(!1),void m(a,!0,s?.ciqEntity,s?.unSupportedEntities);n(a||""),m(a,!1,s?.ciqEntity,s?.unSupportedEntities)}),[s,d,t,n,a]);return c.createElement(kt.D,{ref:r,icon:u?l?{children:Y(u,l)}:{children:$(u)}:null,hasSubmenu:p,disabled:e.isDisabled,className:i.menuItem,"aria-label":a+(p?", sub menu":""),onClick:y},c.createElement("span",{style:{whiteSpace:"normal"}},h.map(((t,n)=>g[n]&&!e.isDisabled?c.createElement("span",{key:n,className:f[n]?i.greyedText:i.highlightedText},t):c.createElement(c.Fragment,{key:n},t)))))}));Jr.displayName="ViewPromptsMenuItem";const Xr=({dataNode:e,updatePopoverOpen:t,updateDataNode:n,menuProps:o})=>{const r=(0,te.Lh)(De),i=Qr(),a=Ar.Bm_,s=Ar.xPV,l="Root"===e?.nodeType,u=c.useCallback((()=>{n("")}),[n]),d=(0,c.useRef)(null),p=(0,c.useRef)(null);if((0,c.useEffect)((()=>{const e=l?p.current:d.current;e&&e.focus()}),[l]),!e)return c.createElement(c.Fragment,null);const h=l?{}:{paddingLeft:0},g=o?.copilotLabProps;return c.createElement(Tt.c,{className:i.menuList},c.createElement(Kr.r,null,c.createElement(Yr.s,{style:h},l?c.createElement(ye.E,{size:200,weight:"medium"},e.text):c.createElement("div",{className:i.menuBackButtonContainer},c.createElement(j.$,{ref:d,className:i.menuBackButton,appearance:"transparent",onClick:u,icon:c.createElement(_t.bP_,null),"aria-label":"Back"}),c.createElement("div",{className:i.menuBackButtonText},e.text))),e.children?.map(((e,r)=>c.createElement(Jr,{key:r,ref:0===r?p:void 0,dataNode:e,updatePopoverOpen:t,updateDataNode:n,menuProps:o})))),g?.copilotLabMenuItemText&&(l||"Category"===e?.nodeType)&&c.createElement(c.Fragment,null,c.createElement($r.N,null),c.createElement(kt.D,{className:i.menuItem,icon:{children:Y(s,a)},onClick:n=>{n.stopPropagation(),t(!1),g?.handleOnClickCopilotLab&&g.handleOnClickCopilotLab("Category"===e.nodeType?e.promptCategory:void 0)}},r)))},Zr=({isDisabled:e,isMenuOpen:t=!1,setMenuOpen:n,positioningRef:o,promptGuideMenuProps:r})=>{const i=(0,te.Lh)(Fe),a=Qr(),[s,l]=(0,c.useState)(""),[u,d]=(0,c.useState)(r.promptGuideMenuData),p=Ar.Bm_,h=Ar.xPV,g=(0,c.useRef)(""===s?u:u.children?.find((e=>e.text===s))),f=(0,c.useCallback)((e=>{g.current=""===e?u:u.children?.find((t=>t.text===e))}),[u]);(0,c.useEffect)((()=>{d(r.promptGuideMenuData)}),[r.promptGuideMenuData]),(0,c.useEffect)((()=>{f(s)}),[f,s]);const[m,y]=(0,c.useState)(t);(0,c.useEffect)((()=>{y(t)}),[t]),(0,c.useEffect)((()=>{n(m)}),[m,n]);const v=c.useCallback(((e,t)=>{t?.open&&r.shouldBlockPromptGuideLaunch&&r.shouldBlockPromptGuideLaunch()||(y(t?.open),t?.open&&r.handleOnClickPromptGuideMenuButtonTelemetry&&r.handleOnClickPromptGuideMenuButtonTelemetry(),l(""),g.current=u)}),[l,y,u,r.shouldBlockPromptGuideLaunch]),C=(0,c.useCallback)((e=>{l(e),o?.current?.updatePosition(),f(e)}),[l,o,f]),b=(0,c.useRef)(null);return(0,c.useEffect)((()=>{const e=document.getElementById(io.RD);if(e){const t=new ResizeObserver((()=>{const t=e.offsetWidth;if(b.current){const e={width:`${t}px`,maxWidth:"none",minHeight:"100px"};Object.assign(b.current.style,e)}o?.current?.updatePosition()}));return t.observe(e),()=>{t.unobserve(e)}}}),[b,m,o]),c.createElement(Kn.W,{open:m,onOpenChange:v,persistOnItemClick:!0,positioning:{positioningRef:o}},c.createElement(Yn.c,{disableButtonEnhancement:!0},c.createElement(U.m,{content:i,relationship:"label",positioning:"above",withArrow:!0},c.createElement(j.$,{appearance:"transparent",disabled:e,icon:m?{children:$(p),className:a.activeIcon}:{children:Y(h,p)},"aria-label":m?"Close view prompts":"Open view prompts",id:io.HP}))),c.createElement(Fo.b,{ref:b},c.createElement(Xr,{dataNode:g.current,updatePopoverOpen:y,updateDataNode:C,menuProps:r})))},ei=e=>(0,Gn.Y$)().isViewMorePromptsOneClickEnabled?c.createElement(qr,{...e}):c.createElement(Zr,{...e});var ti=n(60645),ni=n(21515),oi=n(36195),ri=n(86691);const ii=()=>{const{changeModality:e}=(0,ti.f)();return c.createElement(U.m,{content:"Enter conversational voice mode",relationship:"label",positioning:"above",withArrow:!0},c.createElement(oi.I,{icon:c.createElement(ri.XFg,null),onClick:()=>e(ni.S.RealtimeVoice)}))};var ai;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(ai||(ai={}));var si=n(56934);const li=(0,x.n)({root:{backgroundColor:"transparent"}}),ci=(0,x.n)({root:{position:"relative",backgroundColor:G.L.colorNeutralBackground3,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)",...de.Pt.padding("16px")}}),ui=(0,x.n)({root:{...de.Pt.border("1px solid"),...de.Pt.borderColor("transparent"),...de.Pt.borderRadius("2px"),height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"}}),di=(0,x.n)({root:{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1,"&:hover":{backgroundColor:`${G.L.colorBrandForeground1} !important`}}}),pi=(0,x.n)({root:{backgroundColor:G.L.colorNeutralBackground1,color:G.L.colorStrokeFocus2,"&:hover":{...de.Pt.borderColor(`${G.L.colorBrandForeground1}`),backgroundColor:`${G.L.colorNeutralBackground1} !important`}}}),hi=(0,x.n)({rootHelpLink:{color:G.L.colorBrandForeground1,"&:hover":{color:G.L.colorBrandForeground1},fontSize:"12px"}}),gi=(0,x.n)({root:{height:"63px",bottom:"12px"}}),fi=(0,x.n)({root:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}}}),mi=(0,x.n)({root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:G.L.colorNeutralForeground2,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"}}),yi=(0,x.n)({root:{fontWeight:"bold",color:G.L.colorStrokeFocus2,fontSize:"12px",paddingBottom:"0px"}}),vi={needHelp:Ie,notNow:Pe,tryAgain:Te},Ci=({shouldShowMicPermissionRetryDialog:e,microphonePermissionErrorTitle:t,microphonePermissionErrorMessage:n,microphonePermissionErrorImagePath:o,showHelpLink:r,tryAgainOnClickHandler:i,notNowOnClickHandler:a})=>{const s=ui(),l=di(),u=pi(),d=yi(),p=li(),h=ci(),g=fi(),f=(0,T.z)(s.root,l.root),m=(0,T.z)(s.root,u.root),y=mi().root,v=(0,T.z)(y,d.root),{rootHelpLink:C}=hi(),b=gi().root,E=(0,c.useRef)(null),A=(0,te.kQ)(vi);return(0,c.useEffect)((()=>{e&&E.current?.focus()}),[e]),c.createElement(yt.q,{className:p.root},c.createElement(ao.l,{modalType:"modal",open:e},c.createElement(lo.E,{className:h.root,tabIndex:0,style:{marginTop:window.innerHeight/3+"px"}},c.createElement(co.R,null,c.createElement(uo.L,{className:v},t),c.createElement(po.C,null,o&&c.createElement(ie._,{className:b,alt:"",src:o,width:"252px",height:"51px"}),c.createElement(si.J,{className:y},n),r&&c.createElement(ve.N,{inline:!0,className:C,target:"_blank",href:io.VN},A.needHelp())),c.createElement(ho.i,{className:g.root},c.createElement(so.z,{disableButtonEnhancement:!0},c.createElement(j.$,{ref:E,className:m,appearance:"secondary",onClick:a},A.notNow())),c.createElement(j.$,{className:f,appearance:"primary",onClick:i},A.tryAgain()))))))};var bi=n(39278);const Ei=(0,x.n)({root:{backgroundColor:G.L.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center",...de.Pt.borderRadius("8px"),...de.Pt.borderColor(G.L.colorNeutralBackground1),backgroundRepeat:"no-repeat",width:"32px",height:"32px",minWidth:"32px",[`&:hover .${bi.h.icon}`]:{color:G.L.colorBrandForeground1},[`&:hover:active .${bi.h.icon}`]:{color:G.L.colorBrandForeground1},display:"flow"}}),Ai=(0,x.n)({root:{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1,...de.Pt.borderRadius("50%"),animationName:[{"0%":{boxShadow:`0 0 0 0 ${G.L.colorBrandBackground2}`},"60%":{boxShadow:`0 0 0 5px ${G.L.colorBrandBackground2}`},"100%":{boxShadow:`0 0 0 0 ${G.L.colorBrandBackground2}`}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite",[`&.${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},[`&:hover .${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},[`&:active .${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},[`&:hover:active .${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},"&:hover":{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1},"&:hover:active":{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1},"@media (forced-colors: active)":{forcedColorAdjust:"none"}}}),Si=(0,x.n)({root:{position:"relative",marginRight:"4px",marginLeft:"4px"}}),Ii=(0,x.n)({root:{backgroundColor:G.L.colorNeutralBackground3,...de.Pt.borderRadius("50%"),color:G.L.colorBrandForeground1},loader:{color:G.L.colorNeutralBackground1,...de.Pt.borderRadius("50%"),position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",borderTopStyle:"solid",borderTopColor:G.L.colorBrandForeground1,borderTopWidth:"2px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"}}),Pi=(0,x.n)({root:{[`&:hover .${bi.h.icon}`]:{color:G.L.colorNeutralForegroundDisabled},[`&:hover:active .${bi.h.icon}`]:{color:`${G.L.colorNeutralForegroundDisabled} !important`}}}),Ti=({isDisabled:e,microphoneButtonProps:t})=>{const[n,o]=(0,c.useState)(!1),[r,i]=(0,c.useState)(!1),a=Ii(),s=Ai(),l=Pi(),u=(0,io.uR)();(0,c.useEffect)((()=>{t.isMicrophoneListening?(o(!1),h(f.current)):h(d.current.root)}),[t.isMicrophoneListening]),(0,c.useEffect)((()=>{t.microphoneState===ai.Loading?(o(!0),h(g.current)):(o(!1),t.microphoneState===ai.Uninitialized&&h(d.current.root))}),[t.microphoneState]),(0,c.useEffect)((()=>{e?h(m.current):t.isMicrophoneListening||h(d.current.root)}),[e]);const d=(0,c.useRef)(Ei()),[p,h]=(0,c.useState)(d.current.root),g=(0,c.useRef)((0,T.z)(d.current.root,a.root)),f=(0,c.useRef)((0,T.z)(d.current.root,s.root)),m=(0,c.useRef)((0,T.z)(d.current.root,l.root)),y=c.createElement(j.$,{className:p,title:t.title,"aria-label":(()=>{switch(t.microphoneState){case ai.Enabled:return t.isMicrophoneListening?u.listening():u.paused();case ai.Disabled:case ai.Uninitialized:return u.disabled();case ai.Loading:return u.loading()}})(),role:"switch","aria-checked":t.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),icon:t.isMicrophoneListening||r||n?c.createElement(Q.OPg,{title:"Mic-Filled"}):c.createElement(Q.AQv,{title:"Mic-Regular"}),onClick:async()=>{t.handleMicrophoneButtonOnClick(event)},disabled:e});return c.createElement("div",{className:Si().root},t.isTooltipDisabled?y:c.createElement(U.m,{content:t.title??io.u1,relationship:"label",positioning:"above",withArrow:!0},y),n&&c.createElement("div",{className:a.loader}),c.createElement(Ci,{microphonePermissionErrorImagePath:t.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:t.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:t.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:t.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:t.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:t.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:t.micPermissionRetryDialogProps.showHelpLink}))};var xi=n(58651);class wi{constructor(e){this.telemetryLogger=e}static createInstance(e){null==this.instance&&(this.instance=new wi(e))}static getInstance(){return this.instance}logEvent(e){if(!this.telemetryLogger)return;let t;try{t=e?.metaData?JSON.parse(e.metaData):void 0}catch(e){}switch(e.eventId){case"EditorBootStrapSkipped":case"EditorBootStrapError":case"EditorClientThemeChangedError":case"ESDKInitializeError":case"ESDKShutdownError":case"EditorClientLocalStorageFFOverrideError":case"ECCDisableInlineSuggestionMenuFailed":case"ECCEnableInlineSuggestionMenuFailed":this.telemetryLogger?.logErrorTelemetry&&this.telemetryLogger.logErrorTelemetry(e.eventId,e.errorMessage??"");break;case"EditorClientInlineSuggestionsEnabled":if(this.telemetryLogger?.logSuccessTelemetry){const n=t?.eccQueryCharacter;this.telemetryLogger.logSuccessTelemetry(e.eventId,n)}break;case"EditorBootstrapTriggered":case"EditorClientDestroyed":case"EditorClientThemeChanged":case"ECCAction":case"MicrophoneSuccessfullyInitialized":case"MicrophonePauseClicked":case"MicrophonePlayClicked":case"MicrophonePermissionDenied":case"UploadFileCanceled":case"CIQUploadButtonClicked":case"UploadLocalFileWarmupCall":case"UploadLocalFileDuplicateReplaced":case"UploadLocalFileRetry":this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry(e.eventId);break;case"EditorClientCreated":case"EditorClientInitialized":if(this.telemetryLogger?.logSuccessTelemetry){const n=t?.entitiesEnabled;this.telemetryLogger.logSuccessTelemetry(e.eventId,n)}break;case"ECCOpened":case"ECCSuggestionUpdated":case"ECCEmptySuggestionUpdated":this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry(e.eventId,e.metaData);break;case"ECCClosed":this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry("ECCClosed",e?.metaData);break;case"ECCEntitySelected":this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry("ECCEntitySelected",e?.entityType);break;case"ECCEntityInjectionFailed":this.telemetryLogger?.logErrorTelemetry&&this.telemetryLogger.logErrorTelemetry("ECCEntityInjectionFailed",String(e.message));break;case"MicrophoneInitializationTimeInMs":case"MicrophoneLoadingTimeInMs":this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry(e.eventId,e?.metaData);break;case"UploadLocalFileConnectionLatency":case"UploadLocalFileLatency":case"UploadLocalFileFlowLatency":try{this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry(e.eventId,JSON.stringify({measures:e.measures,metaData:e.metaData}))}catch(t){xi.log("error in stringifying measures and metadata",t),this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry(e.eventId)}break;case"UploadLocalFileError":this.telemetryLogger?.logErrorTelemetry&&this.telemetryLogger.logErrorTelemetry(e.eventId,e.metaData??"");break;default:(e.errorMessage||e.error)&&this.telemetryLogger?.logErrorTelemetry?this.telemetryLogger.logErrorTelemetry(e.eventId,e.errorMessage??e.error??""):this.telemetryLogger?.logSuccessTelemetry&&this.telemetryLogger.logSuccessTelemetry(e.eventId)}}}var ki=n(94717),_i=n(38239),Di=n(56864),Fi=n(51406),Li=n(33488),Oi=n(8044),Ri=n(83301);const Mi={isImageFromPhoneButtonEnabled:!1,isPasteFromClipboardButtonEnabled:!1,isFocusChatAfterImageUploadEnabled:!1};var Bi,Ni=n(34996);!function(e){e.AtMentionButtonClicked="ECCButtonClicked",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs"}(Bi||(Bi={}));var Vi,Hi=n(36317),Ui=n(31153);class ji{constructor(){this.subscribers=new Set}subscribe(e){this.subscribers.add(e)}notifySubscribers(){this.subscribers.forEach((e=>e()))}}!function(e){e.FileCount="FileCount",e.ODBDisabledError="ODBDisabledError",e.UnexpectedError="UnexpectedError",e.FileSize="FileSize",e.ElaboratePrompt="ElaboratePrompt",e.Network="Network",e.FileEmpty="FileEmpty",e.FileExtension="FileExtension",e.FileDuplicate="FileDuplicate",e.PrivacyMessage="PrivacyMessage",e.RelayOdbInfoMessage="RelayOdbInfoMessage",e.FileWithImage="FileWithImage"}(Vi||(Vi={}));const zi=(0,ce.Ex)("scc-service-input-messages.scc.chatInputFileCountErrorMessage"),Gi=(0,ce.Ex)("scc-service-input-messages.scc.chatInputFileSizeErrorMessage"),Wi=(0,ce.Ex)("scc-service-input-messages.scc.ODBDisabledErrorMessage"),qi=(0,ce.Ex)("scc-service-input-messages.scc.unexpectedErrorMessage"),Qi={error:1,warning:2,success:3,info:4};class Ki extends ji{constructor(e){super(),this.stringProvider=e,this._messages=[]}get messages(){return this._messages}addMessage(e){this._messages=[...this._messages,Object.assign(Object.assign({},e),{id:(0,mt.DA)()})],this.notifySubscribers()}addMessageById(e){this._messages=[...this._messages,Object.assign({},e)],this.notifySubscribers()}removeMessageById(e){this._messages=this._messages.filter((t=>t.id!==e)),this.notifySubscribers()}removeMessagesByType(e){this._messages=this._messages.filter((t=>t.type!==e)),this.notifySubscribers()}clearAllMessages(){this._messages=[],this.notifySubscribers()}isHigherPriority(e,t){return Qi[e.intent]<=Qi[t.intent]}addFileLimitMessage(e){this.addMessage({type:Vi.FileCount,message:(0,Ui.A)(this.stringProvider,zi),intent:"error"})}addFileSizeMessage(e){this.addMessage({type:Vi.FileSize,message:(0,Ui.A)(this.stringProvider,Gi),intent:"error"})}addODBDisabledMessage(){this.addMessage({type:Vi.ODBDisabledError,message:(0,Ui.A)(this.stringProvider,Wi),intent:"error"})}addUnexpectedErrorMessage(){this.addMessage({type:Vi.UnexpectedError,message:(0,Ui.A)(this.stringProvider,qi),intent:"error"})}}var Yi=n(2062);const $i=(0,ce.Ex)("scc-react-input-messages.m365chat.chatInputDismissMessage"),Ji=(0,x.n)({container:{borderRadius:`${G.L.borderRadiusLarge} ${G.L.borderRadiusLarge} 0 0`,margin:`calc(-1 * ${G.L.spacingVerticalS} - 1px) calc(-1 * ${G.L.spacingHorizontalS} - 1px) calc(-1 * ${G.L.spacingVerticalS})`},text:Object.assign({color:G.L.colorNeutralForeground1},Sr.g.caption1)});function Xi({message:e,link:t,button:n,dismissButtonCallback:o,intent:r}){const i=Ji(),a=(0,te.kQ)({ChatInputDismissMessage:$i});return c.createElement(Z.n,{className:i.container,intent:r},c.createElement(ee.R,{className:i.text},`${e} `,t&&c.createElement(ve.N,{href:t.url,target:"_blank"},t.message)),c.createElement(Yi.Q,{containerAction:c.createElement(j.$,{"aria-label":a.ChatInputDismissMessage(),appearance:"transparent",icon:c.createElement(ri.LMj,null),onClick:o})},n&&c.createElement(j.$,{size:"small",onClick:n.onClick},n.text)))}function Zi(){const{serviceProvider:e}=(0,I.Ay)(),{service:t}=e.useInputMessages(),{messages:n}=function(e,t){const[n,o]=c.useState(e?t.reduce(((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]})),{}):{}),r=c.useRef(n);return c.useEffect((()=>null==e?void 0:e.subscribe((()=>{t.forEach((t=>{const n=e[t];Object.is(n,r.current[t])||(r.current[t]=n,o((e=>Object.assign(Object.assign({},e),{[t]:n}))))}))}))),[null==e?void 0:e.subscribe]),n}(t,["messages"]),o=c.useMemo((()=>{if(!n||0===n.length)return;let e=n[0];return n.forEach((n=>{(null==t?void 0:t.isHigherPriority(n,e))&&(e=n)})),e}),[null==n?void 0:n.length,t]),r=c.useCallback((()=>{var e;o&&(o.dismissAllSameType?null==t||t.removeMessagesByType(o.type):null==t||t.removeMessageById(o.id),null===(e=o.dismissButtonCallback)||void 0===e||e.call(o))}),[o,t]);return o?c.createElement(Xi,Object.assign({},o,{dismissButtonCallback:r})):null}var ea,ta,na=n(79490),oa=n(35945);!function(e){e.Network="Network",e.FileSize="FileSize",e.FileExtension="FileExtension",e.FileEmpty="FileEmpty",e.FileCount="FileCount",e.FileWithImage="FileWithImage"}(ea||(ea={})),function(e){e.FileCount="FileCount",e.ODBDisabledError="ODBDisabledError",e.UnexpectedError="UnexpectedError",e.FileSize="FileSize",e.ElaboratePrompt="ElaboratePrompt",e.Network="Network",e.FileEmpty="FileEmpty",e.FileExtension="FileExtension",e.FileDuplicate="FileDuplicate",e.PrivacyMessage="PrivacyMessage",e.RelayOdbInfoMessage="RelayOdbInfoMessage",e.FileWithImage="FileWithImage"}(ta||(ta={}));const ra=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadMessage"),ia=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadMessageLink"),aa=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadDuplicateMessage"),sa=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadDuplicatedMessageLink"),la=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadReplaceFileBtn"),ca=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadFileErrorMessage"),ua=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadFileErrorBtn"),da=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadFileExtensionErrorMessage"),pa=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadFileExtensionErrorMessageBtn"),ha=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadSupportedFileFormatLink"),ga=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.UploadFileEmptyErrorMessage");function fa(){const{serviceProvider:e}=(0,I.Ay)();return e.useInputMessages().service}var ma=n(38451);const ya=e=>e&&{id:e.itemId,name:e.name,webUrl:e.webUrl,spoId:e.spoId,parentReference:{driveId:e.parentDriveId}};var va=n(85004);function Ca(e){const t=(0,mt.DA)();return{entity:{entityType:"LocalFile",text:e.name,id:t,url:"",fileExtension:e.name.split(".").pop(),progress:0},queryAnnotation:{id:"",text:e.name,queryAnnotationType:va.in.File}}}const ba=(e,t)=>{var n;return{entity:{entityType:"LocalFile",text:e.name,id:t,url:e.webUrl,fileExtension:e.name.split(".").pop(),progress:1,fileId:e.id},queryAnnotation:{id:null!==(n=e.spoId)&&void 0!==n?n:(0,ma.WG)(e.id,e.parentReference.driveId),text:e.name,queryAnnotationType:va.in.File}}},Ea=(e,t,n)=>({entity:{entityType:"Image",text:e.name,id:t,url:n,fileExtension:e.name.split(".").pop(),progress:1},queryAnnotation:{id:e.name,text:n,queryAnnotationType:va.in.Image}});function Aa(){const{localFilesEntities:e,setLocalFilesEntities:t,updateEntity:n,replaceEntity:o}=N(),r=c.useCallback((e=>{null==t||t((t=>t.filter((t=>t.id!==e))))}),[t]),i=c.useCallback((e=>null==t?void 0:t((t=>t.map((t=>t.id===e.id?t.progress>e.progress?t:Object.assign(Object.assign({},t),e):t))))),[t]),a=c.useCallback((e=>{null==t||t((t=>[...t,e]))}),[t]),s=c.useCallback((t=>e.find((e=>e.id===t))),[e]),l=c.useCallback((e=>{const t=s(e);return 1!==(null==t?void 0:t.progress)}),[s]),u=c.useCallback(((e,t,r)=>{const{entity:a,queryAnnotation:s}=ba(e,t);o(a,s,t,r),i(a),null==n||n(a)}),[o,i,n]),d=c.useCallback(((e,t,r,a,s)=>{const{entity:l,queryAnnotation:c}=Ea(e,t,a);o(l,c,r,s),i(l),null==n||n(l)}),[o,i,n]);return{localFilesEntities:e,removeLocalFileEntity:r,updateLocalFileEntity:i,addLocalFilesEntity:a,isLocalFileBeingUploaded:l,getLocalFileEntity:s,replaceLocalFileEntity:u,replaceImageEntity:d}}const Sa=5,Ia=["File","LocalFile"],Pa=e=>{var t;return-1!==Ia.indexOf((null===(t=e.data)||void 0===t?void 0:t.entity.entityType)||"")};function Ta(){const{updateLocalFileEntity:e}=Aa();return{updateProgress:c.useCallback(((t,n)=>{const o=(e=>{const t=8192e3;if(e>t){const n=e/4;return Math.min(n-n%320,t)}{const t=e/2;return Math.max(t-t%320,983040)}})(n);return o>=n?{progressCallback:()=>{let n=0;const o=setInterval((()=>{n=Math.round(10*(n+.2))/10,e(Object.assign(Object.assign({},t),{progress:n})),n>=.8&&clearInterval(o)}),200)},isMockedProgress:!0}:{progressCallback:n=>{void 0!==n&&e(Object.assign(Object.assign({},t),{progress:n}))},isMockedProgress:!1}}),[e])}}function xa(e){return performance.getEntriesByName(e).length>0}const wa="scc.local-file.set-performance-mark-imported";function ka(e){xa(e)||performance.mark(e)}function _a(e,t,n){if(xa(t)&&xa(n)){let o=performance.measure(e,t,n);return o||(o=performance.getEntriesByName(e,"measure")[0]),o.duration}return 0}xa(wa)||performance.mark(wa);const Da=()=>{const{updateLocalFileEntity:e,addLocalFilesEntity:t}=Aa(),{getSharedCopilotLogger:n}=N(),{setFileDuplicate:o}=function(){const{setDuplicateFile:e,getSharedCopilotLogger:t}=N(),n=fa(),{replaceLocalFileEntity:o}=Aa(),r=(0,te.kQ)({UploadDuplicateMessage:aa,UploadDuplicateMessageLink:sa,UploadReplaceFileBtn:la}),i=c.useCallback(((r,i)=>{o(i,i.renamedFile.entityId),null==e||e(void 0),null==n||n.removeMessageById(i.renamedFile.fileId),r(i.renamedFile.fileId),t&&t().logEvent({eventId:"UploadLocalFileDuplicateReplaced"})}),[o,e,n,t]),a=c.useCallback(((t,o)=>{null==e||e(t),null==n||n.addMessageById({id:t.renamedFile.fileId,type:ta.FileDuplicate,intent:"warning",message:r.UploadDuplicateMessage(),link:{url:t.webUrl,message:r.UploadDuplicateMessageLink()},button:{onClick:()=>i(o,t),text:r.UploadReplaceFileBtn()},dismissAllSameType:!1})}),[n,i,e,r]);return{setFileDuplicate:a}}(),{removeFile:r}=(0,ma.vU)(),{updateProgress:i}=Ta();return c.useCallback(((a,s)=>{if(!a)return{uploadHandlers:{}};const l=e=>e&&r(e);return{uploadHandlers:{onProgress:(e,t)=>{const{progressCallback:n}=i(a,t);n(e/t)}},ondDuplicateFile:(e,t,n,r,i,s)=>o({id:n,name:r,webUrl:i,parentReference:{driveId:s},renamedFile:{name:e,entityId:a.id,fileId:t}},l),setUploadTask:n=>s?e(Object.assign(Object.assign({},a),{uploadTask:n})):t(Object.assign(Object.assign({},a),{uploadTask:n})),setFirstChunkPerformanceMark:()=>ka(`scc.local-file-first-chunk_${a.id}`),warmupCallLog:()=>{var e,t;n&&(null===(t=(e=n()).logEvent)||void 0===t||t.call(e,{eventId:"UploadLocalFileWarmupCall"}))}}}),[t,r,o,e,i])},Fa=(e,t)=>{const n=t.lastIndexOf("."),o=t.substring(0,n),r=t.substring(n+1);return new RegExp(`${o}\\s[0-9]+\\.${r}`).test(e)},La=(e,t)=>((e,t)=>{var n;const o=null===(n=e.name.split(".").pop())||void 0===n?void 0:n.toLowerCase();return null!=o&&o in t})(e,t)?(e=>e.size<=157286400)(e)?void 0:{type:ea.FileSize,size:e.size}:{type:ea.FileExtension,extension:e.name.split(".").pop()||""},Oa=e=>e.some((e=>Ma(e))),Ra=e=>e.filter((e=>!Ma(e))),Ma=e=>e.type.startsWith("image/");function Ba(){var e;const{entityRef:t,duplicateFile:n,setDuplicateFile:o,uploadErrors:r,addTempEntity:i,closeCiq:a,getSharedCopilotLogger:s,supportedFileExtensionMimeMap:l,setIsFileUploadInProgress:u,odbDataRef:d}=N(),{attachments:p}=(null===(e=(0,I.Ay)())||void 0===e?void 0:e.attachmentContext)||{},h=fa(),{showPrivacyMessage:g}=function(){const{dismissedPrivacyMessage:e,setDismissedPrivacyMessage:t}=N(),n=fa(),o=(0,te.kQ)({UploadMessage:ra,UploadMessageLink:ia});return{showPrivacyMessage:c.useCallback((r=>{!e&&(null==r?void 0:r.isOdbEnabled)&&(null==n||n.addMessage({type:ta.RelayOdbInfoMessage,intent:"info",message:o.UploadMessage(),link:{url:r.copilotUploadsWebUrl,message:o.UploadMessageLink()},dismissButtonCallback:()=>null==t?void 0:t(!0),dismissAllSameType:!0}))}),[e,n,o,t])}}(),{uploadFile:f,retryUpload:m}=(0,ma.iv)(),{removeFile:y}=(0,ma.vU)(),v=Da(),C=c.useRef(null==p?void 0:p.filter((e=>{var t,n;return"LocalFile"===(null===(n=null===(t=e.data)||void 0===t?void 0:t.entityElement)||void 0===n?void 0:n.entityType)}))),{removeLocalFileEntity:b,getLocalFileEntity:E,replaceLocalFileEntity:A,localFilesEntities:S}=Aa(),P=c.useCallback((()=>{var e,t;return!(null===(e=null==d?void 0:d.current)||void 0===e?void 0:e.isOdbEnabled)&&(null==h||h.addODBDisabledMessage()),!!(null==d?void 0:d.current)&&(null===(t=null==d?void 0:d.current)||void 0===t?void 0:t.isOdbEnabled)}),[h]),T=c.useCallback(((e,t)=>{const n=JSON.stringify({size:e});ka(`scc.local-file-upload-finished_${t}`);const o=_a("scc-local-file.uploadLatency",`scc.local-file-first-chunk_${t}`,`scc.local-file-upload-finished_${t}`).toString();null==s||s().logEvent({eventId:"UploadLocalFileLatency",measures:o,metaData:n});const r=_a("scc-local-file.connectionLatency",`scc.local-file-establish-connection_${t}`,`scc.local-file-first-chunk_${t}`).toString();null==s||s().logEvent({eventId:"UploadLocalFileConnectionLatency",measures:r,metaData:n});const i=_a("scc-local-file-whole-flow",`scc.local-file-establish-connection_${t}`,`scc.local-file-upload-finished_${t}`).toString();null==s||s().logEvent({eventId:"UploadLocalFileFlowLatency",measures:i,metaData:n})}),[s]),x=c.useCallback(((e,t,n)=>o=>{null==u||u(!1),"UserWithoutOdbError"===o.name?null==h||h.addODBDisabledMessage():n({type:ea.Network,file:{data:e,entityId:t}})}),[h]),w=c.useCallback(((e,t,n)=>{e&&(T(t.size,n),A(e,n),null==u||u(!1))}),[T,A]);c.useEffect((()=>{C.current=null==p?void 0:p.filter((e=>{var t,n;return"LocalFile"===(null===(n=null===(t=e.data)||void 0===t?void 0:t.entityElement)||void 0===n?void 0:n.entityType)})),C.current&&C.current.length<S.length&&(()=>{const e=S.filter((e=>{var t;return!(null===(t=C.current)||void 0===t?void 0:t.some((t=>{var n;return(null===(n=t.data.entityElement)||void 0===n?void 0:n.id)===e.id})))}));e.length>0&&e.forEach((e=>L(e)))})()}),[p]);const k=c.useCallback(((e,t,n)=>{ka(`scc.local-file-establish-connection_${t.entity.id}`),f(e,v(t.entity)).then(ya).then((n=>w(n,e,t.entity.id))).catch(x(e,t.entity.id,n))}),[x,v,w,f]),_=c.useCallback(((e,t,n)=>{const o=[];for(const n of e){const e=La(n,l);if(e){t(e);continue}const r=Ca(n);o.push(r),null==u||u(!0),k(n,r,t),o.length>0&&g(null==d?void 0:d.current),o.forEach((e=>i(e.entity,e.queryAnnotation)))}}),[i,g,k]),D=c.useCallback(((e,n,o,r,i)=>{var s;const l=((null===(s=null==t?void 0:t.current)||void 0===s?void 0:s.getActiveEntities())||[]).filter(Pa).length;!function(e=1,t){return t+e<=Sa}(n.length,l)?null==h||h.addFileLimitMessage(oa.H.LocalFile):(r&&a(),_(n,e,i),(null==o?void 0:o.current)&&(o.current.value=""))}),[a,t,h,_]),F=c.useCallback((e=>e&&y(e)),[y]),L=c.useCallback((e=>{var t;if("LocalFile"===(null==e?void 0:e.entityType)){const r=E(e.id);if(!r)return;1===r.progress?F(r.fileId):null===(t=r.uploadTask)||void 0===t||t.cancel(),n&&Fa(r.text,n.name)&&(null==o||o(void 0)),(null==r?void 0:r.fileId)&&(null==h||h.removeMessageById(r.fileId)),1===(null==S?void 0:S.length)&&(null==h||h.removeMessagesByType(ta.RelayOdbInfoMessage)),b(r.id)}}),[E,n,b,F,o,S,h]),O=c.useCallback(((e,t)=>(0,na.__awaiter)(this,void 0,void 0,(function*(){const n=null==r?void 0:r.filter((e=>e.type===ea.Network));e(ea.Network);for(const e of n||[]){s&&s().logEvent({eventId:"UploadLocalFileRetry"});const n=E(e.file.entityId);((null==n?void 0:n.uploadTask)?m(n.uploadTask,e.file.data,v(n,!0)):f(e.file.data,v(n))).then(ya).then((t=>t&&A(t,e.file.entityId))).catch(x(e.file.data,e.file.entityId,t))}}))),[r,s,E,m,v,f,x,A]);return{createLocalFileCiqEntity:D,removeLocalFileCiqEntity:L,retryLocalFileEntityUpload:O,canUploadFile:P}}const Na="https://support.microsoft.com/en-us/topic/file-formats-supported-by-copilot-1afb9a70-2232-4753-85c2-602c422af3a8";function Va(){const{removeEntity:e,filePickerRef:t,uploadErrors:n,setUploadErrors:o,getSharedCopilotLogger:r}=N(),{retryLocalFileEntityUpload:i}=Ba(),a=fa(),s=(0,te.kQ)({UploadFileExtensionErrorBtn:pa,UploadSupportedFileFormatLink:ha,UploadFileExtensionErrorMessage:da,UploadFileErrorMessage:ca,UploadFileErrorBtn:ua,UploadFileEmptyErrorMessage:ga}),l=c.useCallback((e=>{let t;return null==o||o((n=>(t=null==n?void 0:n.filter((t=>t.type!==e)),t))),null==a||a.removeMessagesByType(e),t}),[o,a]),u=c.useCallback((t=>{if(t===ea.Network){const t=null==n?void 0:n.filter((e=>e.type===ea.Network));null==t||t.forEach((t=>e(t.file.entityId)))}l(t)}),[n,l]),d=c.useCallback((e=>{var n;u(e),null===(n=null==t?void 0:t.current)||void 0===n||n.click()}),[u,t]),p=c.useCallback((()=>{null==a||a.addFileSizeMessage(oa.H.LocalFile)}),[a]),h=c.useCallback((()=>{null==a||a.addMessage({type:ta.FileEmpty,intent:"error",message:s.UploadFileEmptyErrorMessage(),button:{onClick:()=>d(ea.FileEmpty),text:s.UploadFileExtensionErrorBtn()},dismissAllSameType:!0})}),[a,d,s]),g=c.useCallback((()=>{null==a||a.addMessage({type:ta.FileExtension,intent:"error",message:s.UploadFileExtensionErrorMessage(),link:{url:Na,message:s.UploadSupportedFileFormatLink()},button:{onClick:()=>d(ea.FileExtension),text:s.UploadFileExtensionErrorBtn()},dismissAllSameType:!0})}),[a,d,s]),f=c.useCallback((e=>{null==a||a.addMessage({type:ta.Network,intent:"error",message:s.UploadFileErrorMessage(),button:{onClick:()=>{i(l,e)},text:s.UploadFileErrorBtn()},dismissAllSameType:!0})}),[a,l,i,s]),m=c.useCallback((e=>{switch(null==o||o((t=>[...t||[],e])),e.type){case ea.FileSize:p();break;case ea.FileEmpty:h();break;case ea.FileExtension:g();break;case ea.Network:f(m)}r&&r().logEvent({eventId:"UploadLocalFileError",metaData:JSON.stringify(Ha(e))})}),[o,r,p,h,g,f]);return{addUploadError:m}}const Ha=e=>Object.assign(Object.assign({type:e.type},e.type===ea.FileExtension&&{extension:R(e.extension)?e.extension:"unknown"}),e.type===ea.FileCount&&{origin:e.origin.toString()});class Ua extends c.PureComponent{constructor(e){super(e),this.state={hasError:!1}}componentDidCatch(e){const{onError:t,codeLocation:n,retriesLeft:o,logErrorBoundaryMessage:r}=this.props;null==t||t(e,n,o,r),this.setState({hasError:!0})}static getDerivedStateFromError(){return{hasError:!0}}resetError(){this.setState({hasError:!1})}getFallbackUIWithRetry(){const{fallbackUI:e}=this.props;if(!e)return;const t={onRetryClick:this.resetError.bind(this)};return c.cloneElement(e,t)}render(){return this.state.hasError?this.getFallbackUIWithRetry()||c.createElement(c.Fragment,null):this.props.children}}var ja=n(50016);function za(){const{getSharedCopilotLogger:e}=N();return c.createElement(Ua,{fallbackUI:c.createElement(c.Fragment,null),onError:t=>{null==e||e().logEvent({eventId:"LocalFileUploadErrorBoundaryCaughtError",errorMessage:t.name+": "+t.message})}},c.createElement(c.Suspense,{fallback:c.createElement(c.Fragment,null)},c.createElement(Ga,null)))}function Ga(){const{odbDataRef:e}=N(),t=(0,ja.useLazyLoadQuery)(ma.ox,{shouldIssueQuery:!0}),n=(0,ma.Zt)(t.viewer);return e&&n&&(e.current=n),c.createElement("div",null)}function Wa(){const{closeCiq:e,filePickerRef:t,getSharedCopilotLogger:n,supportedFileExtensionMimeMap:o}=N(),{createLocalFileCiqEntity:r}=Ba(),{addUploadError:i}=Va();c.useEffect((()=>{var e;return null===(e=null==t?void 0:t.current)||void 0===e||e.addEventListener("cancel",a),()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.removeEventListener("cancel",a)}}),[]);const a=c.useCallback((()=>{e(),n&&n().logEvent({eventId:"UploadFileCanceled"})}),[]),s=c.useMemo((()=>Object.keys(o).map((e=>`.${e},${o[e]}`)).join(",")),[]),l=c.useCallback((e=>(0,na.__awaiter)(this,void 0,void 0,(function*(){const n=e.target.files;n&&(r(i,[...n],t,!0,oa.H.LocalFile),(null==t?void 0:t.current)&&(t.current.value=""))}))),[t,r,i]);return c.createElement("div",null,c.createElement("input",{ref:t,type:"file",accept:s,onChange:l,id:"upload-file-button",style:{display:"none"},multiple:!0}),c.createElement(za,null))}const qa=(0,ce.Ex)("scc-react-local-files.DragDropFile"),Qa=(0,x.n)({container:Object.assign({minWidth:"320px",maxWidth:"912px",position:"relative"},de.Pt.margin("0","auto")),fileDragText:{zIndex:1,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:G.L.colorNeutralForeground3,display:"flex",flexDirection:"column",alignItems:"center"},fileDragBackground:{"> *":{opacity:0},backgroundColor:G.L.colorNeutralBackground2},none:{display:"none"}}),Ka=e=>{const t=Qa();return Object.assign(Object.assign({},t),null!=e?e:{})};function Ya({children:e,style:t}){const n=Ka(t),o=(0,te.kQ)({DragDropFile:qa}),{isFileBeingDragged:r,setIsFileBeingDragged:i,filePickerRef:a,isImageInputEnabled:s}=N(),{createLocalFileCiqEntity:l,canUploadFile:u}=Ba(),{addUploadError:d}=Va(),p=e=>(0,na.__awaiter)(this,void 0,void 0,(function*(){null==i||i(!1);const t=e.dataTransfer.files;t&&(e.stopPropagation(),e.preventDefault(),u()&&l(d,[...t],a,!1,oa.H.DragAndDrop))}));return c.createElement("div",{onDrop:p,onPaste:e=>(0,na.__awaiter)(this,void 0,void 0,(function*(){const t=e.clipboardData.files;if(t&&(e.stopPropagation(),e.preventDefault(),u())){if(s&&Oa([...t])){const e=Ra([...t]);return void l(d,e,a,!1,oa.H.CopyPaste)}l(d,[...t],a,!1,oa.H.CopyPaste)}})),className:n.container},c.createElement("div",{className:r?n.fileDragText:n.none,onDrop:p},c.createElement(ri.Py6,null),c.createElement("span",null,o.DragDropFile())),e)}function $a({children:e,style:t}){return c.createElement(Ya,{style:t},e)}const Ja=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.uploadIconLabel"),Xa=(0,ce.Ex)("scc-react-local-files.sccLocalFiles.uploadFromDeviceMenuItemLabel");function Za(){const{isFileBeingDragged:e}=N(),t=Qa();return e?t.fileDragBackground:void 0}function es({uploadFileRef:e,sharedCopilotLogger:t,shouldShowFileUploadButtonText:n,enableDragAndDrop:o=!0,styles:r}){const i=function({uploadFileRef:e,sharedCopilotLogger:t,shouldShowFileUploadButtonText:n=!0}){const o=(0,te.kQ)({UploadIconLabel:Ja,UploadFromDeviceMenuItemLabel:Xa}),r=c.useCallback((()=>{var n;null===(n=e.current)||void 0===n||n.click(),null==t||t.logEvent({eventId:"CIQUploadButtonClicked"})}),[e]);return{enableCloudPicker:!0,isUploadFileButtonEnabled:!0,enableBrowseThisComputerOnFileFlags:!0,fluentMenuConfig:{enableMenuButtonIcon:!0,menuButtonText:n?o.UploadIconLabel():"",menuItems:[{menuItemText:o.UploadFromDeviceMenuItemLabel(),enableMenuItemIcon:!0,menuItemIcon:"ArrowUpload",onClickHandler:r}]}}}({uploadFileRef:e,sharedCopilotLogger:t,shouldShowFileUploadButtonText:n});return{LocalFilesInputWrapper:o?$a:void 0,FilePicker:Wa,useDragAndDropStyle:o?Za:()=>{},filePickerRef:e,ciqProps:i,styles:r}}var ts=n(60788),ns=n(11594),os=n(58651);function rs(e,t,n,o,r){const i=document.createElement("input");i.type="file",i.accept="image/bmp, image/pip, image/jpg, image/pjpeg, image/jpeg, image/jfif, image/png, image/webp",i.multiple=!1,i.onchange=i=>{i.stopPropagation();const a=i.target.files?.[0];if(a&&"image/bmp"!==a.type&&"image/pip"!==a.type&&"image/jpg"!==a.type&&"image/pjpeg"!==a.type&&"image/jpeg"!==a.type&&"image/jfif"!==a.type&&"image/png"!==a.type&&"image/webp"!==a.type)return os.log(`Unsupported image file type - ${a.type}`),void(r&&r(t.uploadImageUnsupportedTypeError()));const s=new FileReader;s.onloadend=i=>{const s=new Image;s.onload=()=>{if(os.log(`Image ${a.name} content is good`),e(s.src),o){const e=n.current?.getInputText();n.current?.setInputText(e)}},s.onerror=()=>{os.log("Bad image content"),r&&r(t.uploadImageBadContentError())},s.src=i.target.result},s.readAsDataURL(a)},i.click()}var is=n(61534);const as=e=>(new Date).getTime()-e,ss=(e,t)=>.75*e>=1048576*(t||2),ls=(e,t)=>{const n=t||2;return e.replace("{0}",n.toString())};var cs=n(86930);const us={nonImagePasteError:et,uploadImageBadContentError:Xe,uploadImageFileTooBigErrorFormat:Je,uploadImageUnsupportedTypeError:$e},ds=(e,t,n,o,r,i,a,s,l,u,d,p,h,g,f)=>{const m=(0,te.kQ)(us),y=c.useRef(0),[v,C]=c.useState([]),[b,E]=c.useState([]),[A,S]=c.useState(void 0);c.useEffect((()=>{v&&0!=v.length&&(async e=>{const t=new cs.w;await t.ResizeImage(e,a,l,u,s,d,p);const n=t.base64ResizedImage;n?(E((e=>[{dataUri:n,id:y.current++}])),C((e=>[]))):P(m.uploadImageBadContentError())})(v[0].dataUri)}),[v,i,a,s,l,u,d,p,Xe]);const I=e=>{i?ss(e.length,r)?P(ls(m.uploadImageFileTooBigErrorFormat(),r)):C((t=>[{dataUri:e,id:y.current++}])):E((t=>[{dataUri:e,id:y.current++}])),f?.([])},P=e=>{S(e),setTimeout((()=>{S(void 0)}),3e3)},T=(e,t)=>{if(o)if(e.clipboardData?.files?.length>0){const t=new FileReader;t.addEventListener("load",(()=>{if(i){const e=t.result.length;ss(e,r)?P(ls(m.uploadImageFileTooBigErrorFormat(),r)):C((e=>[{dataUri:t.result,id:y.current++}]))}else E((e=>[{dataUri:t.result,id:y.current++}]));f?.([])})),t.readAsDataURL(e.clipboardData.files[0])}else t&&P(m.nonImagePasteError())},x={handleScreenshotOnClick:async t=>{if(n)return;if(void 0===h)return;t?.stopPropagation();const o=await h();o&&(i?C((e=>[{dataUri:o,id:y.current++}])):E((e=>[{dataUri:o,id:y.current++}])),f?.([])),e.current?.focus()}};return{nextImageId:y,images:b,setImages:E,handlePaste:e=>{T(e,!1)},error:A,insertImageButtonProps:{handleImagePaste:t=>{t?.stopPropagation(),T(t,!0),e.current?.focus()},handleImageUploadOnClick:o=>{n||(o?.stopPropagation(),rs(I,m,t,!!g?.isFocusChatAfterImageUploadEnabled&&g?.isFocusChatAfterImageUploadEnabled,P),e.current?.focus())},showNonImageEntryError:()=>{P(m.nonImagePasteError())},handleImageUploadFromPhone:t=>{n||0===t.length||(t[0]&&I(t[0]),e.current?.focus())},isImageFromPhoneButtonEnabled:g?.isImageFromPhoneButtonEnabled??!1,isPasteFromClipboardButtonEnabled:g?.isPasteFromClipboardButtonEnabled??!1,uploadPollingIntervalMs:g?.uploadPollingIntervalMs??5e3},screenshotButtonProps:x}};class ps{constructor(e,t){this.entityPluginRef=e,this.controlRef=t}renderAndTrackSelectedSuggestion(e,t,n,o,r,i){}generatCopilotOdslSignalLinks(e){const t=this.controlRef.current?.getInputText().trim();if(!t)return;const n=this.entityPluginRef.current?.getActiveEntities();if(!n)return;const o=n.filter((e=>void 0!==e.data?.entity?.url)).reduce(((e,n)=>{const o=t.indexOf(n.text,e.lastOffset),r=n.text.length;return-1!==o&&(e.urls.push({type:"URL",range:[o,o+r-1],value:n.data.entity.url}),e.lastOffset=o+r),e}),{lastOffset:0,urls:[]}).urls;return o.length<=0?void 0:o}generateQueryAnnotations(e){const t=this.entityPluginRef.current?.getActiveEntities();if(!t)return;const n=t.filter((e=>void 0!==e.data?.annotation)).map((e=>e.data?.annotation));if(n.length<=0)return;return n.map((e=>({id:e.id,QueryAnnotationType:e.queryAnnotationType,text:e.text??""})))}setHVCAppChatV2Enabled(e){}}var hs,gs=n(90037),fs=n(73569);!function(e){e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.AttachCloudFilesClicked="Attach_Cloud_Files_Clicked",e.FilesSelectedFromCloudFileDailog="Files_Selected_From_Cloud",e.ErrorInLoadingCloudFilesDialog="Error_In_Loading_Cloud_Files_Dialog",e.CloudFilesDialogClosed="Cloud_Files_Dialog_Closed"}(hs||(hs={}));const ms=(e,t,n,o)=>({text:e.text,entityProps:{className:o??"",text:{as:"a",...e.url?{href:e.url,target:"_blank",rel:"noopener"}:{},"data-entity-id":e.id,"data-entity-type":e.entityType}},data:{entity:e,annotation:t,rawEntityData:n?{data:n,type:e.entityType}:void 0}});function ys(e){e?.current?.removeCiqChar()}function vs(e){return e.replace(/[{}]/g,"")}function Cs(e){const t=e.sharepointIds;if(!t)return;const n=vs(t.siteId||""),o=vs(t.webId||""),r=vs(t.listId||""),i=vs(t.listItemUniqueId||"");return n&&o&&r&&i?btoa(`${n},${o},${r}`).replace(/[=]+$/g,""):void 0}const bs=5,Es=["File","LocalFile"],As=e=>Es.includes(e.data?.entity.entityType||"");function Ss(e,t,n){const o=(t.current?.getActiveEntities()||[]).filter(As).length;if(function(e=1,t){return t+e<=bs}(e.length,o))for(const o of e){if(o.size&&o.size>536870912){n?.addFileSizeMessage(oa.H.CloudFile);continue}let e="";const r=Cs(o);e=r?`SPO_${r}_${o.id}`:"";const i={entityType:"CloudFile",text:o.name||"",id:e,url:o.webUrl||o.webDavUrl||"",fileExtension:(o.name||"").split(".").pop()},a={id:e,text:o.name||"",queryAnnotationType:va.in.File},s={id:e,referenceId:"",fileName:o.name||"",accessUrl:o.webUrl||o.webDavUrl||"",spoId:e,attachmentSource:oa.H.CloudFile};t.current?.insertChatInputEntity(ms(i,a,s))}else n?.addFileLimitMessage(oa.H.CloudFile)}var Is=n(58651);const Ps=e=>{const{chatInputRef:t,controlRef:n,entityRef:o,editorProps:r,getEditorService:i,ciqQueryCharacter:a,isDarkMode:s,isDisabled:l,setAtMentionApp:u,insertCiqTriggerPluginRef:d,inputMessagesNodes:p,shouldInitializeCIQ:h,localFilesNode:g}=e,[f,m]=c.useState(void 0),y=(0,Gn.Y$)(),{hostAppAuthToken:v}=(0,Cr.Mb)(),b=r?.editorConfig?.settings;wi.createInstance(r?.editorConfig?.telemLogger);const E=wi.getInstance(),A=(({entityRef:e,controlRef:t,isDarkMode:n,inputMessagesNodes:o,onAttachCloudFiles:r,insertCiqTriggerPluginRef:i,supportedFileExtensionMimeMap:a})=>{const s=(0,Cr.Mb)(),l=(0,Gn.Y$)(),u=I.IB.useCloudFiles(),d=s.hostAppAuthToken??gs.gh,p=c.useCallback((t=>{ys(i),Ss(t,e,o?.service),(0,ns.Zz)(hs.FilesSelectedFromCloudFileDailog,t.length.toString())}),[e,i]),h=c.useCallback((()=>{ys(i),(0,ns.Zz)(hs.CloudFilesDialogClosed)}),[i]),g=c.useCallback((()=>{ys(i),(0,ns.IT)(hs.ErrorInLoadingCloudFilesDialog,"Error in loading cloud files dialog"),o?.service?.addUnexpectedErrorMessage()}),[i]),f=c.useCallback((()=>{Is.log("onAttachCloudFiles"),(0,ns.Zz)(hs.AttachCloudFilesClicked),r?.({onItemSelected:p,onErrorInLoading:g,closeCiqCallback:h})}),[r]),m=(0,fs.m)({entityRef:e,controlRef:t,graphTokenProvider:d.graphTokenProvider,sharepointTokenProvider:d.sharepointTokenProvider,appName:s.hostAppSettings.appName,locale:s.hostAppSettings.locale,theme:n?"dark":"default",onAttachCloudFiles:r?f:void 0,shouldShowFileUploadButtonText:l.shouldShowFileUploadButtonText,supportedFileExtensionMimeMap:a});return l.isCloudFileUploadEnabled?m:u})({entityRef:o,controlRef:n,isDarkMode:s,onAttachCloudFiles:r?.editorConfig?.onAttachCloudFiles,insertCiqTriggerPluginRef:d,inputMessagesNodes:p,supportedFileExtensionMimeMap:r?.editorConfig?.supportedFileExtensionMimeMap}),S=e=>{switch(e){case C.O.Prod:return"Prod";case C.O.GCC:return"GCC";case C.O.GCCHigh:return"GCCH";case C.O.DOD:return"DOD";case C.O.DogFood:return"DogFood";default:return"None"}},P=c.useCallback((()=>r?.alSession&&r?.editorConfig&&h?{appId:b.hostAppId,appName:b.hostAppName,appPlatform:b.hostAppPlatform,appScenario:b.hostAppScenario,locale:b.hostDefaultLocale,isDogfoodEnvironment:b.isDogfoodEnvironment,appEnvironment:S(b?.appEnvironment),useFluentV9:b?.useFluentV9,sessionId:b?.sessionId,puid:b?.userId?.puid,tenantId:b?.userId?.tenantId,alSession:r?.alSession,targetElement:t.current,entitiesEnabled:r?.editorConfig?.entitiesSupported,enableExpandedECC:r?.editorConfig?.isExpandedECCEnabled,eccQueryCharacter:a,telemetryLogger:E,telemetrySink:r?.editorConfig?.telemSink,featureFlags:{enableSingleEntityStyle:1===r?.editorConfig?.entitiesSupported.length,...r?.editorConfig?.featureFlags},onOpenGptStorefront:r?.editorConfig?.onOpenGptStorefront,moreCopilotsStringOverride:r?.editorConfig?.moreCopilotsStringOverride,browseThisComputerSettings:{...A.browseThisComputerSettings,...g.ciqProps,fluentMenuConfig:{...A.browseThisComputerSettings?.fluentMenuConfig,menuItems:[...A.browseThisComputerSettings?.fluentMenuConfig?.menuItems??[],...g.ciqProps?.fluentMenuConfig?.menuItems??[]]}},inlineSuggestionsStyles:r?.editorConfig?.inlineSuggestionsStyles,getProfilePictureUrl:r?.editorConfig?.getProfilePictureUrl,onOpen:r?.onOpen,onClose:r?.onClose}:void 0),[r?.alSession,r?.editorConfig,h,t.current]),[T,x]=c.useState(P()),[w,k]=c.useState({getEditorService:()=>Promise.resolve(void 0),editorProps:T,entityRef:o,isDarkMode:s,isInputDisabled:l,ciqPlaceholderText:r?.editorConfig?.ciqPlaceholderText,setAtMentionApp:u,pasteUnfurlingProps:{enablePasteUnfurling:y.isPasteUnfurlingEnabled,entityPluginId:io.wb,graphAuthTokenCallback:y.enableFileUrlUnFurlingWithGraphAPI?v?.graphTokenProvider:void 0},insertCiqTriggerPluginRef:d});return c.useEffect((()=>{const e=P();x(e)}),[P]),c.useEffect((()=>{r?.alSession&&r?.editorConfig&&k({getEditorService:i,editorProps:T,entityRef:o,isDarkMode:s,isInputDisabled:l,ciqPlaceholderText:r?.editorConfig?.ciqPlaceholderText,pasteUnfurlingProps:{enablePasteUnfurling:y.isPasteUnfurlingEnabled,entityPluginId:io.wb,graphAuthTokenCallback:y.enableFileUrlUnFurlingWithGraphAPI?v?.graphTokenProvider:void 0},setAtMentionApp:u,insertCiqTriggerPluginRef:d})}),[r?.alSession,r?.editorConfig,v?.graphTokenProvider,T,s,l,u]),c.useEffect((()=>{if(r?.handleInChatInput&&r?.editorConfig&&!f&&t.current){const e=new ps(o,n);m(e)}}),[f,r,o]),{sccCiqResponseHandler:f,ciqPluginParams:w,cloudFileNode:A}};var Ts=n(46896),xs=n(87733),ws=n(71080),ks=n(58651);const _s={microphoneTooltipDisabled:Ge,microphoneTooltipListening:je,microphoneTooltipLoading:We,microphoneTooltipPaused:ze,micListeningGhostText:Se},Ds=e=>{const{chatInputRef:t,controlRef:n,handleChatInputLoad:o,isDisabled:r,languageSupportsSpace:i,maxInputCharLimit:a,placeholderText:s,voiceInputProps:l}=e,u=(0,te.kQ)(_s);let d=0;const[p,h]=c.useState(!1),[g,f]=c.useState(ai.Uninitialized),[m,y]=c.useState(!1),v=c.useRef(l?.alSession),C=c.useRef(!1),b=c.useRef(null),E=!((0,Gn.Y$)().isSccVoiceEnabled||!l?.handleInChatInput||!l?.alSession&&!l?.alSessionConfig),A=c.useCallback((e=>{if(e){(0,ns.Zz)(hs.MicrophoneLoadingTimeInMs,as(d).toString());const e=n.current?.getInputText().length>0&&i.current?io.Gs:io.u1;b.current?.setGhostText(e+u.micListeningGhostText())}else{const e=b.current?.getGhostText()?.trim();e&&""!==e&&e!==u.micListeningGhostText()?b.current?.commitGhostText(e):b.current?.cancelGhostText()}h(e),C.current=e}),[s]);c.useEffect((()=>{p?t.current?.focus():(0,Ts.WT)(A).catch((e=>{ks.log("pauseMicandStopTimer Error"+e)}))}),[p]);const S=c.useCallback((e=>{if(!C.current||!E||r||n.current?.getInputText().length>=a)return;const o=n.current?.getInputText().length>0&&i?io.Gs:io.u1;b.current?.commitGhostText(o+e),t.current?.focus(),n.current?.scrollToBottom()}),[E,r,a]),I=c.useCallback((e=>{if(!C.current||!E||r||null!=n.current&&n.current?.getInputText().length>=a)return;const t=n.current?.getInputText().length>0&&i?io.Gs:io.u1;b.current?.setGhostText(t+e),n.current?.scrollToBottom(),e.trim()&&(0,Ts.Uk)(io.l3,A)}),[E,r,a,A]),P=c.useCallback((async()=>{if(null==v.current&&(v.current=l.alSession??await(async e=>e?((0,is.rn)(e),(await(0,is.pv)()).getSession()):null)(l?.alSessionConfig)),v.current){const e=(new Date).getTime(),t=(0,xs.n)(l.voiceInputLocale);await(0,Ts.N6)(t,S,I,f,A,v.current),(0,ns.Zz)(hs.MicrophoneInitializationTimeInMs,as(e).toString()),i.current=(0,xs.G)((0,xs.n)(t)),(0,ns.Zz)(hs.MicrophoneSuccessfullyInitialized)}}),[I,S,A,l?.alSession,l?.alSessionConfig,l?.voiceInputLocale]);c.useEffect((()=>(o(),()=>{ks.log("Destroying voice input connection"),(0,Ts.ne)()})),[]),c.useEffect((()=>{E&&P()}),[E,P]);const T=E?{isMicrophoneListening:p,microphoneState:g,handleMicrophoneButtonOnClick:async e=>{e?.stopPropagation();try{p?((0,ns.Zz)(hs.MicrophonePauseClicked),b.current?.getGhostText()!=io.u1&&b.current?.getGhostText()!=s&&b.current?.getGhostText()?.trim()!=u.micListeningGhostText()&&b.current?.commitGhostText(b.current?.getGhostText()),await(0,Ts.WT)(A)):((0,ns.Zz)(hs.MicrophonePlayClicked),g===ai.Uninitialized&&f(ai.Loading),d=(new Date).getTime(),await ws.X.GetInstance().Resume(),y(!1),A(!p),f(ai.Enabled),await(0,Ts.Uk)(io.l3,A))}catch(e){const t=`Error occurred while fetching mic permissions - : ${e}`;return ks.error(t),"ErrorAudioPermissionDeniedError"==e&&(await ws.X.GetInstance().Pause(),y(!0),(0,ns.Zz)(hs.MicrophonePermissionDenied)),void f(ai.Uninitialized)}},micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:m,microphonePermissionErrorTitle:l?.microphonePermissionErrorTitle,microphonePermissionErrorMessage:l?.microphonePermissionErrorMessage,tryAgainOnClickHandler:()=>{d=(new Date).getTime(),(0,Ts.WY)(p,io.l3,y,f,A)},notNowOnClickHandler:()=>{y(!1)},microphonePermissionErrorImagePath:l?.microphonePermissionImagePath,showHelpLink:l?.showMicrophonePermissionHelpLink},isTooltipDisabled:!0}:l?.microphoneButtonProps;return{getMicrophoneTooltipText:()=>{if(T)switch(T?.microphoneState){case ai.Enabled:return T.isMicrophoneListening?u.microphoneTooltipListening():u.microphoneTooltipPaused();case ai.Disabled:case ai.Uninitialized:return u.microphoneTooltipDisabled();case ai.Loading:return u.microphoneTooltipLoading();default:return}},ghostTextRef:b,handleVoiceInChatInput:E,isMicrophoneActive:C,microphoneProps:T,setMicrophoneListeningStatus:A}};var Fs=n(47875);const Ls={Alt:"PowerPoint type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/pptx.svg"},Os={Alt:"Excel type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/xlsx.svg"},Rs={Alt:"Word type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/docx.svg"},Ms={Alt:"Onenote type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/one.svg"},Bs={Alt:"Outlook type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/outlook_24x1.svg"},Ns={Alt:"Teams type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/teams_24x1.svg"},Vs={Alt:"Sharepoint type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/spo.svg"},Hs={Alt:"PDF type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/pdf.svg"},Us={Alt:"Visio type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/vsdx.svg"},js={Alt:"Loop type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/loop.svg"},zs={Alt:"Video type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/stream.svg"},Gs={Alt:"Text type",Url:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/24/txt.svg"},Ws=(0,x.n)({icon:{color:G.L.colorNeutralForeground3,":focus":{color:G.L.colorNeutralForeground3},":hover":{color:G.L.colorNeutralForeground3},":active":{color:G.L.colorNeutralForeground3}}});var qs;!function(e){e.powerpoint="powerpoint",e.excel="excel",e.word="word",e.onenote="onenote",e.outlook="outlook",e.teams="teams",e.event="event",e.meeting="meeting",e.teamsmeeting="teamsmeeting",e.sharepoint="sharepoint",e.web="web",e.pdf="pdf",e.visio="visio",e.loop="loop",e.txt="txt",e.thirdparty="thirdparty",e.topic="topic",e.video="video",e.image="image"}(qs||(qs={}));const Qs=e=>{if(!e)return null;const t=(e=>{if(!e)return null;try{return new URL(e).hostname.replace(/^www\./,"")}catch(e){return null}})(e);return t?`https://services.bingapis.com/favicon?url=${t}`:null},Ks=({referenceType:e="",type:t="",iconUrl:n,authorEmail:o,authorName:r,iconSize:i=20,isListV2:a=!1,iconUrlPromise:s,appDataPromise:l,url:u})=>{var d;const p=Ws(),{getSharedCopilotLogger:h}=(0,I.Ay)(),g=(0,I.CS)(),f=null===(d=null==g?void 0:g.features)||void 0===d?void 0:d.enableFaviconForWebCompete,m=h?h():null,[y,v]=c.useState(""),[C,b]=c.useState(void 0);c.useEffect((()=>{l&&l.then((e=>{b(e.appIcon)})).catch((()=>{null==m||m.logEvent({eventId:"ReferenceIconErrorFailedToGetAppData",detail:"Failed to get appData from promise for reference"})}))}),[l,m]),c.useEffect((()=>{s&&n&&s.then((t=>{let o=(null==t?void 0:t.url)||"";o&&"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="===o&&(null==m||m.logEvent({eventId:"ReferenceIconDefaultImageResolved",detail:`DefaultPlaceholderImage Resolved for reference type: ${e}, iconUrlExtension: ${n.split(".")[-1]}`}),o=""),v(o)})).catch((()=>{null==m||m.logEvent({eventId:"ReferenceIconErrorFailedToGetImage",detail:`Failed to get image for from proxy for  reference type: ${e}, iconUrlExtension: ${n.split(".")[-1]}`})}))}),[n,s,e,m]);switch(t.toLocaleLowerCase()||e.toString().toLocaleLowerCase()){case qs.powerpoint:case"0":return c.createElement(ie._,{alt:Ls.Alt,src:Ls.Url,height:i,width:i});case qs.excel:case"1":return c.createElement(ie._,{alt:Os.Alt,src:Os.Url,height:i,width:i});case qs.word:case"2":return c.createElement(ie._,{alt:Rs.Alt,src:Rs.Url,height:i,width:i});case qs.onenote:case"3":return c.createElement(ie._,{alt:Ms.Alt,src:Ms.Url,height:i,width:i});case qs.outlook:case"4":return r||o?c.createElement(Fs.e,{size:i,name:r||o,style:a?{verticalAlign:"text-top"}:{}}):c.createElement(ie._,{alt:Bs.Alt,src:Bs.Url,height:i,width:i});case qs.teams:case"5":return r||o?c.createElement(Fs.e,{size:i,name:r||o,style:a?{verticalAlign:"text-top"}:{}}):c.createElement(ie._,{alt:Ns.Alt,src:Ns.Url,height:i,width:i});case qs.event:case"6":case qs.meeting:case"7":case qs.teamsmeeting:case"8":return c.createElement(ae.TDj,{className:p.icon,fontSize:i});case qs.sharepoint:case"9":return c.createElement(ie._,{alt:Vs.Alt,src:Vs.Url,height:i,width:i});case qs.pdf:case"12":return c.createElement(ie._,{alt:Hs.Alt,src:Hs.Url,height:i,width:i});case qs.visio:case"14":return c.createElement(ie._,{alt:Us.Alt,src:Us.Url,height:i,width:i});case qs.loop:case"16":return c.createElement(ie._,{alt:js.Alt,src:js.Url,height:i,width:i});case qs.video:case"17":return c.createElement(ie._,{alt:zs.Alt,src:zs.Url,height:i,width:i});case qs.txt:case"19":return c.createElement(ie._,{alt:Gs.Alt,src:Gs.Url,height:i,width:i});case qs.thirdparty:case"20":if(!n||s&&!y)return C?c.createElement(ie._,{height:i,width:i,src:C}):c.createElement(ae.Rl_,{className:p.icon,fontSize:i});break;case qs.topic:case"21":return c.createElement("svg",{"data-testid":"topic-icon-svg",width:i,height:i,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.createElement("circle",{cx:"9.00024",cy:"6",r:"6",fill:"#B26BFF"}),c.createElement("path",{d:"M14.9146 7.00072L11.0002 11L11.735 15.7867C12.611 16.5428 13.7522 17 15.0002 17C17.7617 17 20.0002 14.7614 20.0002 12C20.0002 9.23858 17.7617 7 15.0002 7C14.97   7 14.9431 7.00024 14.9146 7.00072Z",fill:"#7655AE"}),c.createElement("path",{d:"M3.55685 8.51758L11.0002 11.0021L11.7328 15.7795C10.9752 18.2267 8.6943 20.0044 5.99817 20.0044C2.68331 20.0044 -0.00390625 17.3172 -0.00390625 14.0024C-0.00390625 11.5568 1.45868 9.4529 3.55685 8.51758Z",fill:"#3C2B5E"}))}if(s&&y)return c.createElement(ie._,{height:i,width:i,src:y,onError:()=>{null==m||m.logEvent({eventId:"ReferenceIconErrorFailedToLoadImage",detail:`Image Failed to load for reference type: ${e}, iconUrlExtension: ${y.split(".")[-1]}`})}});if(r||o)return c.createElement(Fs.e,Object.assign({size:i,style:a?{verticalAlign:"text-top"}:{}},n?{image:{src:n}}:{}));if(n)return c.createElement(ie._,{height:i,width:i,src:n});if(u&&f){const e=Qs(u);if(e)return c.createElement("img",{alt:"Favicon type",src:e,height:i,width:i})}return c.createElement(xt.EEN,{className:p.icon,fontSize:i})};var Ys=n(41197),$s=n(37774);const Js=(0,ce.Ex)("scc-react-attachment-list-plugin.sccAttachment.removeIcon"),Xs=(0,ce.Ex)("scc-react-attachment-list-plugin.sccAttachment.addAttachmentHint"),Zs=(0,ce.Ex)("scc-react-attachment-list-plugin.sccAttachment.addSelectionAttachmentHint"),el=(0,ce.Ex)("scc-react-attachment-list-plugin.sccAttachment.moreAttachmentHint"),tl=(0,ce.qP)("scc-react-attachment-list-plugin.sccAttachment.uploadingAttachment"),nl=(0,ce.qP)("scc-react-attachment-list-plugin.sccAttachment.uploadingAttachmentFinished"),ol=(0,ce.Ex)("scc-react-attachment-list-plugin.sccAttachment.ciqAttachmentTooltip"),rl=(0,x.n)({tag:{"& button":{padding:"1px 2px 1px 2px"},"& .fai-Attachment__primaryAction":{paddingLeft:"6px"},"& span.fai-Attachment__primaryAction":{padding:"0 2px 0 6px"}},tagText:{display:"block",maxWidth:"100px",overflowX:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",padding:"4px",paddingLeft:"2px"},visuallyHidden:{clip:"rect(1px, 1px, 1px, 1px)",clipPath:"inset(50%)",height:"1px",width:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute"},attachmentImage:{width:"48px",height:"48px",objectFit:"cover"}}),il=({children:e,media:t,url:n,id:o,progress:r,shouldShowTooltip:i,text:a,dataUri:s,isImageAttachmentType:l,className:u})=>{const d=rl(),p=(0,te.kQ)({RemoveIcon:Js,AttachmentTooltip:ol}),h=(0,te.mY)({UploadingAttachment:tl,UploadAttachmentFinished:nl}),[g,f]=c.useState(null),m=c.useCallback((e=>{null!==e&&f(e)}),[]),[y,v]=c.useState(!0);c.useEffect((()=>{const e=setTimeout((()=>{v(!1)}),4e3);return()=>{clearTimeout(e)}}),[]);const C=!!n,b=c.useCallback((e=>{var t,o,r;null===(t=null==e?void 0:e.preventDefault)||void 0===t||t.call(e),null===(o=null==e?void 0:e.stopPropagation)||void 0===o||o.call(e),n&&(null===(r=window.open)||void 0===r||r.call(window,n,"_blank"))}),[o,n]),E=(0,$s.A)(r)&&!!a;let A,S,I;E&&(A=20*Math.round(100*r/20),S=h.UploadingAttachment({fileName:a,progress:A.toString()}),I=1===r?h.UploadAttachmentFinished({fileName:a}):void 0);const P=c.createElement(_i.o,{imageOnly:l,media:t?c.createElement("div",{ref:m},t):void 0,progress:E&&A&&(0,$s.A)(A)?{value:1*A/100}:void 0,primaryAction:C?{onClick:b}:{as:"span"},className:l?u:(0,T.z)(d.tag,u),id:o},l?c.createElement("img",{src:s,className:d.attachmentImage,alt:`${(e=>{if(!e)return"";return"Attachment {0}".replace("{0}",e)})(o)}`}):c.createElement("span",{className:d.tagText},e),E&&A&&(0,$s.A)(A)&&c.createElement("span",{"aria-live":"polite",className:d.visuallyHidden},A<100?S:I));return i?c.createElement(U.m,{visible:y,withArrow:!0,positioning:{target:g,position:"below",align:"start"},content:p.AttachmentTooltip(),relationship:"label"},P):P};var al=n(77111),sl=n(28236);const ll=(0,x.n)({placeholderTag:Object.assign(Object.assign({},de.Pt.borderStyle("none")),{alignSelf:"end"}),placeholderTagPrimary:Object.assign(Object.assign({},de.Pt.borderStyle("dashed")),{color:G.L.colorNeutralForeground4}),placeholderTagPrimaryText:{overflow:"hidden",textOverflow:"ellipsis"},addMoreIcon:{color:G.L.colorBrandForeground1}}),cl="addSelectionAttachmentHint",ul=({getCanvasSelection:e})=>{const t=ll(),n=(0,te.kQ)({AddSelectionAttachmentHintStr:Zs}),{attachmentContext:o}=(0,I.Ay)(),{setAttachments:r}=o||{},i=c.useCallback((()=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield null==e?void 0:e();if(!t||!t.isValid||!o)return;const n={type:Ys.J.entity,data:{entityElement:{id:"selectionAttachment"+o.attachments.length.toString(),text:t.attachmentDisplayText||t.selection,originalText:t.selection,url:"",entityType:"CanvasSelection"}}};null==r||r((e=>[...e,n]))}))),[o]);return c.createElement(al.H,{className:t.placeholderTag,appearance:"outline"},c.createElement(sl.B,{id:cl,icon:c.createElement(ae.wbC,{className:t.addMoreIcon}),onClick:i,className:t.placeholderTagPrimary,primaryText:{children:n.AddSelectionAttachmentHintStr()||"Add selection",className:t.placeholderTagPrimaryText}}))},dl=({showFullHint:e,insertCiqTriggerPluginRef:t})=>{const n=ll(),o=(0,te.kQ)({AddAttachmentHint:Xs,MoreAttachmentHint:el}),r=c.useCallback((()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.insertCiqTrigger("/")}),[]);return c.createElement(al.H,{className:n.placeholderTag,appearance:"outline"},c.createElement(sl.B,{icon:c.createElement(ae.wbC,{className:n.addMoreIcon}),onClick:r,className:n.placeholderTagPrimary,primaryText:{children:e?o.AddAttachmentHint():o.MoreAttachmentHint(),className:n.placeholderTagPrimaryText}}))};var pl;!function(e){e.powerpoint="powerpoint",e.excel="excel",e.word="word",e.onenote="onenote",e.outlook="outlook",e.teams="teams",e.event="event",e.meeting="meeting",e.teamsmeeting="teamsmeeting",e.sharepoint="sharepoint",e.web="web",e.pdf="pdf",e.visio="visio",e.loop="loop",e.txt="txt",e.thirdparty="thirdparty",e.topic="topic",e.video="video",e.image="image"}(pl||(pl={}));const hl=Object.freeze({doc:pl.word,docx:pl.word,dot:pl.word,dotx:pl.word,docm:pl.word,docb:pl.word,ppt:pl.powerpoint,pptx:pl.powerpoint,xls:pl.excel,xlm:pl.excel,xlsx:pl.excel,xlsm:pl.excel,xlsb:pl.excel,xltx:pl.excel,csv:pl.excel,one:pl.onenote,pdf:pl.pdf,vsd:pl.visio,vsdx:pl.visio,loop:pl.loop,fluid:pl.loop,txt:pl.txt,mp4:pl.video});const gl=(0,x.n)({list:{display:"flex",flexFlow:"wrap",columnGap:"6px",rowGap:"4px"},attachmentImage:{width:"20px",height:"20px",objectFit:"contain"}}),fl=({items:e,onItemRemoved:t,ciqTriggerPluginRef:n,showAttachmentHint:o,maxVisibleAttachments:r,getCanvasSelection:i,showAddSelectionHint:a})=>{const s=gl(),l=e.map((e=>{var t,n,o,r,i,a,l,u,d,p,h,g,f,m,y,v,C,b,E;let A,S,I=c.createElement(c.Fragment,null);return-1!==["File","FileUrl","CloudFile","LocalFile","Event","People","External"].indexOf(null!==(n=null===(t=e.data.entityElement)||void 0===t?void 0:t.entityType)&&void 0!==n?n:"")?(-1!==["File","FileUrl","CloudFile","LocalFile"].indexOf(null!==(r=null===(o=e.data.entityElement)||void 0===o?void 0:o.entityType)&&void 0!==r?r:"")?A=function(e){if(!e)return;const t=e.toLocaleLowerCase();return hl[t]}(null===(i=e.data.entityElement)||void 0===i?void 0:i.fileExtension):"Event"===(null===(a=e.data.entityElement)||void 0===a?void 0:a.entityType)?A=pl.event:"People"===(null===(l=e.data.entityElement)||void 0===l?void 0:l.entityType)?S=null===(u=e.data.entityElement)||void 0===u?void 0:u.text:"External"===(null===(d=e.data.entityElement)||void 0===d?void 0:d.entityType)&&(A=pl.thirdparty),I=c.createElement(Ks,{referenceType:A,referenceId:null===(p=e.data.entityElement)||void 0===p?void 0:p.id,authorName:S,iconUrl:null===(h=e.data.entityElement)||void 0===h?void 0:h.iconUrl})):"Image"===(null===(g=e.data.entityElement)||void 0===g?void 0:g.entityType)?I=c.createElement("img",{src:null===(f=e.data.entityElement)||void 0===f?void 0:f.url,className:s.attachmentImage,alt:"","aria-hidden":"true"}):"CanvasSelection"===(null===(m=e.data.entityElement)||void 0===m?void 0:m.entityType)&&(I=c.createElement(ts.AXN,null)),{children:null===(y=e.data.entityElement)||void 0===y?void 0:y.text,media:I,url:null===(v=e.data.entityElement)||void 0===v?void 0:v.url,text:null===(C=e.data.entityElement)||void 0===C?void 0:C.text,itemId:e.type===Ys.J.image?e.data.imageId:null===(b=e.data.entityElement)||void 0===b?void 0:b.id,isImageAttachmentType:e.type===Ys.J.image,dataUri:e.data.dataUri,progress:e.data.progress&&e.data.progress<1?e.data.progress:void 0,shouldShowTooltip:(null===(E=e.data.entityElement)||void 0===E?void 0:E.createdFrom)===va.KD.PromptGuide}}));if(0!==l.length||n&&o||a)return c.createElement(c.Fragment,null,c.createElement(ki._,{className:s.list,maxVisibleAttachments:r,onAttachmentDismiss:t},l.map(((e,t)=>c.createElement(il,Object.assign({key:t},e,{id:e.itemId})))),n&&o&&c.createElement(dl,{insertCiqTriggerPluginRef:n,showFullHint:!l.length}),a&&c.createElement(ul,{getCanvasSelection:i})))};var ml=n(62785),yl=n(21592),vl=n(13842),Cl=n(90424),bl=n(98904),El=n(86303),Al=n(96404);const Sl=(0,x.n)({ciqZeroQueryHintText:Object.assign(Object.assign({backgroundColor:G.L.colorNeutralBackground5,color:G.L.colorNeutralForeground4},de.Pt.borderRadius(G.L.borderRadiusMedium)),{paddingLeft:G.L.spacingHorizontalXS,paddingRight:G.L.spacingHorizontalXS}),ciqZeroQueryHintTextDark:{backgroundColor:G.L.colorSubtleBackground}}),Il=({eccQueryCharacter:e,ciqPlaceholderText:t,isDarkMode:n})=>{const[o]=(0,bl.useLexicalComposerContext)(),r=Sl(),i=c.useCallback((()=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){var n;if(!t)return;const o=(0,El.$getSelection)();if(!(0,El.$isRangeSelection)(o)||!o.isCollapsed())return;const r=o.getNodes()[0];if(!(0,El.$isTextNode)(r)||!r.isSimpleText())return;const i=r.getTextContent(),a=o.getCharacterOffsets()[0];if(!(i[a-1]===e))return;if(!(1===a||""===(null===(n=i[a-2])||void 0===n?void 0:n.trim())))return;return a===i.length||""===i[a].trim()?""+t+"":void 0}))),[t,e]);return c.useEffect((()=>o.registerNodeTransform(El.TextNode,(t=>{if(t.getPreviousSibling())return;const n=t.getTextContent();n.length>0&&(n[0]===e||"@"===n[0])&&t.insertBefore((0,El.$createTextNode)(" "))}))),[o,e]),c.createElement(c.Fragment,null,c.createElement(Al.i,{id:"ciqGhostText",$getGhostText:i,ghostTextProps:{className:(0,T.z)(r.ciqZeroQueryHintText,...n?[r.ciqZeroQueryHintTextDark]:[])}}))},Pl=/\s?\/[\s]*$/,Tl=/\s?[/@][\s]*$/,xl=c.forwardRef((({featureFlags:e},t)=>{const[n]=(0,bl.useLexicalComposerContext)(),o=!!((null==e?void 0:e.enableAppGptsInCiq)||(null==e?void 0:e.enableAppPluginsInCiq)||(null==e?void 0:e.enableAppPPInCiq)||(null==e?void 0:e.enableAppTypeBInCiq)||(null==e?void 0:e.enableAppMessageExtensionsInCiq))?Tl:Pl;return c.useImperativeHandle(t,(()=>({insertCiqTrigger(e){n.update((()=>{const t=(0,El.$nodesOfType)(El.TextNode);for(let e=t.length-1;e>=0;e--){const r=t[e],i=r.getTextContent(),a=o.exec(i);if(a){const e=(0,El.$createRangeSelection)();e.anchor.set(r.getKey(),a.index,"text"),e.focus.set(r.getKey(),i.length,"text"),(0,El.$setSelection)((0,El.$normalizeSelection__EXPERIMENTAL)(e)),n.dispatchCommand(El.DELETE_CHARACTER_COMMAND,!1);break}if(0===e){const e=t[t.length-1];null==e||e.selectEnd()}}setTimeout((()=>{n.update((()=>{const t=(0,El.$createTextNode)(" "+e);(0,El.$insertNodes)([t]),t.selectEnd()}))}),1)}))},removeQuery(e){n.update((()=>{const t=(0,El.$getSelection)();if(!(0,El.$isRangeSelection)(t)||!t.isCollapsed())return;const o=t.getNodes();if(0===o.length||o.length>1)return;const r=o[0];if(!(0,El.$isTextNode)(r))return;const i=r.getTextContent();let a=t.getCharacterOffsets()[0];for(;a>0&&""!==i[a-1].trim();)if(a--,i[a]===e)return void(0!==a&&""!==i[a-1].trim()||(t.setTextNodeRange(r,t.getCharacterOffsets()[0],r,a),n.dispatchCommand(El.DELETE_CHARACTER_COMMAND,!1)))}))},removeCiqChar(){n.update((()=>{const e=(0,El.$nodesOfType)(El.TextNode);for(let t=e.length-1;t>=0;t--){const r=e[t].getTextContent();if(o.exec(r)){(0,El.$createRangeSelection)().deleteWord(!0),n.dispatchCommand(El.DELETE_CHARACTER_COMMAND,!1);break}}}))},getEditor:()=>n})),[n,o]),null}));xl.displayName="InsertCiqTriggerPlugin";var wl=n(58651);const kl=({getEditorService:e,editorProps:t,entityRef:n,ciqPlaceholderText:o,ciqElementContainerClassName:r,isDarkMode:i=!1,isInputDisabled:a=!1,pasteUnfurlingProps:s,setAtMentionApp:l,insertCiqTriggerPluginRef:u,onCIQBootstrap:d})=>{const[p,h]=c.useState(null),[g,f]=c.useState(null),m=c.useRef(null),y=c.useRef(!1),v=c.useRef(!0),{telemetryLogger:C}=t||{},b=c.useCallback(((e,t,o,i,a,s)=>{var c;o&&(t?null===(c=n.current)||void 0===c||c.insertChatInputEntity(((e,t,n,o)=>({text:e.text,entityProps:{className:null!=o?o:"",text:Object.assign(Object.assign({as:"a"},e.url?{href:e.url,target:"_blank",rel:"noopener"}:{}),{"data-entity-id":e.id,"data-entity-type":e.entityType})},data:{entity:e,annotation:t,rawEntityData:n?{data:n,type:e.entityType}:void 0}}))(e,t,a,r)):s&&l&&l(s))}),[l]);c.useEffect((()=>{e().then((e=>{f(e)}))}),[e]),c.useEffect((()=>{g&&p&&g.updateCurrentTheme(i?va.SV.dark:va.SV.light)}),[g,p,i]),c.useEffect((()=>()=>{g&&m.current&&(y.current&&g.disableInlineSuggestionsMenu({eccQueryCharacter:null==t?void 0:t.eccQueryCharacter,featureFlags:null==t?void 0:t.featureFlags},m.current),g.destroyEditor(m.current))}),[]);const E=c.useCallback((()=>{if(g&&t&&!m.current&&!a){if(!v.current)return void(null==C||C.logEvent({eventId:"EditorBootStrapSkipped",errorMessage:"ShouldBootStrapEditor is false. Skipping editor bootstrap."}));v.current=!1;try{g.bootstrapEditor(Object.assign(Object.assign({},t),{onEntitySelected:b})).then((e=>{h(e),m.current=e,d&&d()}))}catch(e){null==C||C.logEvent({eventId:"EditorBootStrapError",errorMessage:JSON.stringify(e)}),wl.error(e),v.current=!0}}}),[g,t,b,a]);c.useEffect((()=>{E()}),[E]),c.useEffect((()=>()=>{g&&m.current&&(y.current&&g.disableInlineSuggestionsMenu({eccQueryCharacter:null==t?void 0:t.eccQueryCharacter,featureFlags:null==t?void 0:t.featureFlags},m.current),g.destroyEditor(m.current),h(null),m.current=null,v.current=!0,y.current=!1)}),[g,null==t?void 0:t.alSession,t]),c.useEffect((()=>{var e;g&&p&&t&&!y.current&&(g.enableInlineSuggestionsMenu(Object.assign(Object.assign({},t),{theme:null!==(e=t.theme)&&void 0!==e?e:i?va.SV.dark:va.SV.light,onEntitySelected:b})),y.current=!0,wl.log("Inline suggestions menu enabled"))}),[p,g]);const A=(0,ml.K)({}),S=(0,yl.O)({}),I=(0,vl.k)({graphAuthTokenCallback:null==s?void 0:s.graphAuthTokenCallback}),P=c.useMemo((()=>{var e;return null!==(e=null==s?void 0:s.pasteUnfurlingTransforms)&&void 0!==e?e:[S,I,A]}),[S,I,A,null==s?void 0:s.pasteUnfurlingTransforms]);return{ciqPlugin:c.createElement(c.Fragment,null,c.createElement(Il,{eccQueryCharacter:null==t?void 0:t.eccQueryCharacter,ciqPlaceholderText:o,isDarkMode:i}),s&&s.enablePasteUnfurling&&c.createElement(Cl.P,{entityPluginId:s.entityPluginId,transforms:P}),u&&c.createElement(xl,{ref:u,featureFlags:null==t?void 0:t.featureFlags}))}};var _l;!function(e){e.ElaboratePrompt="ElaboratePrompt"}(_l||(_l={}));const Dl=(0,ce.Ex)("scc-react-elaborate-prompt-plugin.scc.discardElaborated"),Fl=(0,ce.Ex)("scc-react-elaborate-prompt-plugin.scc.regenerateElaborated"),Ll=(0,ce.Ex)("scc-react-elaborate-prompt-plugin.scc.ElaboratePromptButton"),Ol=(0,ce.Ex)("scc-react-elaborate-prompt-plugin.scc.loadingElaborated"),Rl=(0,ce.Ex)("scc-react-elaborate-prompt-plugin.scc.cantChatAboutThis"),Ml=(0,ce.Ex)("scc-react-elaborate-prompt-plugin.scc.somethingWrong");var Bl=n(85023);const Nl=(0,x.n)({inlineElements:{float:"left",paddingLeft:"4px",paddingRight:"4px"},inlineIcon:{float:"left",paddingLeft:"4px",paddingRight:"4px",width:"16px",height:"16px"},button:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({fontWeight:"100"},de.Pt.flex(0)),{backgroundColor:"transparent"}),de.Pt.border("none")),de.Pt.padding(0)),{minWidth:"32px",height:"20px",selectors:{"&:disabled":{backgroundColor:G.L.colorNeutralBackground1},"&:active":{backgroundColor:"transparent"},"&:hover":{cursor:"pointer",backgroundColor:"transparent"},"&:hover:disabled":{cursor:"initial"}}}),actionButton:{height:"24px",selectors:{"&:disabled":{backgroundColor:G.L.colorNeutralBackground1},"&:hover":{cursor:"pointer"},"&:hover:disabled":{cursor:"initial"}}},actionButtonText:{fontWeight:"400",fontSize:"12px"},icon:{width:"18px",height:"18px"}}),Vl=(0,K.A)(Bl.YJW,Bl.EZi),Hl=(0,K.A)(Bl.YJW,Bl.EZi),Ul=(0,K.A)(ri.Ogn,ri.S61),jl=(0,K.A)($n.IEN,$n.E4E),zl=({onKeepItClick:e,onRegenerateClick:t,onDiscardClick:n})=>{const o=Nl(),r=(0,te.kQ)({CopilotRegenerateElaborated:Fl,CopilotDiscardElaborated:Dl});return c.createElement("div",null,c.createElement(j.$,{icon:c.createElement(Hl,null),onClick:e,className:o.actionButton,appearance:"primary","data-testid":"keep-elaborated-prompt"},c.createElement("text",{className:o.actionButtonText}," Keep it ")),c.createElement(U.m,{withArrow:!0,content:r.CopilotRegenerateElaborated(),relationship:"label"},c.createElement(j.$,{appearance:"transparent",icon:c.createElement(jl,null),onClick:t,className:o.button,"data-testid":"regenerate-elaborated-prompt"})),c.createElement(U.m,{withArrow:!0,content:r.CopilotDiscardElaborated(),relationship:"label"},c.createElement(j.$,{appearance:"transparent",className:o.button,icon:c.createElement(Ul,null),onClick:n,"data-testid":"discard-elaborated-prompt"})))};var Gl,Wl=n(58651);const ql=(void 0!==Gl||(Gl=n(2886)).hash&&"fdea60bd1ffe303a17908fe264a992d3"!==Gl.hash&&Wl.error("The definition of 'elaboratePromptQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),Gl);var Ql=n(58651);function Kl(e,t){var n,o,r,i,a,s,l,c,u,d,p,h,g,f,m,y,v,C,b,E,A,S,I,P,T,x;const w=function(e,t){var n,o;switch(t){case"People":return e.emailAddresses?e.emailAddresses[0]:"";case"File":return null!==(n=e.spoId)&&void 0!==n?n:e.id;case"Event":return null!==(o=e.originalId)&&void 0!==o?o:e.id}}(t,e);switch(e){case"People":return{text:null!==(n=t.displayName)&&void 0!==n?n:"",url:`mailto:${w}`,id:w,type:e,metadata:{name:null!==(o=t.displayName)&&void 0!==o?o:"",address:w},metadataState:"Partial",referenceId:t.referenceId};case"File":return{text:null!==(r=t.fileName)&&void 0!==r?r:"",url:null!==(i=t.accessUrl)&&void 0!==i?i:"",id:w,type:e,metadata:{Id:w,Type:e,Source:{Title:null!==(a=t.title)&&void 0!==a?a:"",FileName:null!==(s=t.fileName)&&void 0!==s?s:"",FileType:null!==(l=t.fileExtension)&&void 0!==l?l:"",Path:null!==(c=t.accessUrl)&&void 0!==c?c:"",FileExtension:null!==(d=null!==(u=t.secondaryFileExtension)&&void 0!==u?u:t.fileExtension)&&void 0!==d?d:"",ParentLink:null!==(p=t.parentLink)&&void 0!==p?p:"",LastModifiedTime:null!==(h=t.dateModified)&&void 0!==h?h:"",SecondaryFileExtension:t.secondaryFileExtension,SPWebUrl:null!==(g=t.spWebUrl)&&void 0!==g?g:"",AuthorOwsUser:t.authorEmail+" | "+(null!==(f=t.author)&&void 0!==f?f:""),SiteTitle:null!==(m=t.siteTitle)&&void 0!==m?m:""}},metadataState:"Full",referenceId:t.referenceId};case"Event":return{text:null!==(y=t.subject)&&void 0!==y?y:"",url:null!==(v=t.skypeTeamsMeetingUrl)&&void 0!==v?v:"",id:w,type:e,metadata:{Id:w,Type:e,Source:{Subject:null!==(C=t.subject)&&void 0!==C?C:"",OrganizerName:null!==(b=t.organizerName)&&void 0!==b?b:"",OrganizerAddress:null!==(E=t.organizerAddress)&&void 0!==E?E:"",Attendees:null!==(S=null===(A=t.attendees)||void 0===A?void 0:A.map((e=>({EmailAddress:{Name:e.emailAddress.name,Address:e.emailAddress.address}}))))&&void 0!==S?S:[],Start:null!==(I=t.start)&&void 0!==I?I:"",End:null!==(P=t.end)&&void 0!==P?P:"",EventId:{Id:null!==(x=null===(T=t.eventId)||void 0===T?void 0:T.id)&&void 0!==x?x:""}}},metadataState:"Partial",referenceId:t.referenceId}}}function Yl(e,t){var n,o,r,i,a,s;if(e instanceof El.TextNode)return e.getTextContent();if(e instanceof Di.iH){const s=null===(n=e.getTextContent())||void 0===n?void 0:n.trim(),l=null==t?void 0:t.find((e=>(null==e?void 0:e.text)&&0===s.localeCompare(e.text))),c=null===(r=null===(o=null==l?void 0:l.data)||void 0===o?void 0:o.entity)||void 0===r?void 0:r.id,u=null===(a=null===(i=null==l?void 0:l.data)||void 0===i?void 0:i.entity)||void 0===a?void 0:a.entityType;let d="";return c&&u&&(d=` type="${u}" ReferenceId="${c}"`),`<entity${d}>`+s+"</entity>"}if(e instanceof El.ElementNode){const n=null===(s=e.getChildren)||void 0===s?void 0:s.call(e);let o="";return null==n||n.forEach((e=>{o+=Yl(e,t)+" "})),o.trim()}return""}const $l=e=>{const{isDisabled:t,setIsDisabled:n,elaboratePromptProps:o}=e,{elaboratePromptActionsAvailable:r,setElaboratePromptActionsState:i,disabledElaborate:a}=o,s=(0,te.kQ)({CopilotCantChatAboutThis:Rl,CopilotSomethingWrong:Ml}),[l,u]=c.useState(!1),[d,p]=c.useState(""),[h,g]=c.useState(void 0),[f,m]=c.useState(!1),[y,v]=c.useState(!1),[C,b]=c.useState([]),[E,A]=c.useState([]),{inputContext:S,getSharedCopilotLogger:P,serviceProvider:T}=(0,I.Ay)(),{entityRef:x,insertCiqTriggerPluginRef:w}=S||{},{updateDraftForEntity:k}=T.useHydratedEntityPlugin(),{service:_}=T.useInputMessages(),D=P?P():null,F=c.useRef(+new Date),L=(0,ja.useRelayEnvironment)(),O=()=>{m(!1),v(!1)};c.useEffect((()=>{a?null==D||D.logEvent({eventId:"ElaboratePromptIconDisabled"}):null==D||D.logEvent({eventId:"ElaboratePromptIconEnabled"})}),[a]),c.useEffect((()=>{const e=f||y;e!==l&&u(e)}),[l,u,f,y]),c.useEffect((()=>{d||(i(!1),O())}),[d]),c.useEffect((()=>{(f||y)&&function(e,t){const n={userPrompt:t};return(0,ja.fetchQuery)(e,ql,{userPrompt:n},{networkCacheConfig:{metadata:{clientFeature:"copilotElaboratePrompt"}}}).toPromise().then((e=>{const t=null==e?void 0:e.bizChat.elaboratePrompt;if(t)return t;throw new Error("No elaborated prompt returned")})).catch((e=>{throw e}))}(L,d).then((e=>{g(e),null==D||D.logEvent({eventId:"ElaboratePromptResultReturned",latency:+new Date-F.current}),O()})).catch((e=>{var t,o,r,a;let l=!1;const c=null===(t=null==e?void 0:e.result)||void 0===t?void 0:t.errors;if(Array.isArray(c)&&c.length>0){const e=c[0];l="LLM_RAI_ERROR"===(null===(o=null==e?void 0:e.extensions)||void 0===o?void 0:o.code),null==D||D.logEvent({eventId:"ElaboratedPromptError",error:null==e?void 0:e.message,errorMessage:null===(r=null==e?void 0:e.extensions)||void 0===r?void 0:r.message,statusCode:null===(a=null==e?void 0:e.extensions)||void 0===a?void 0:a.code})}else e instanceof Error?null==D||D.logEvent({eventId:"ElaboratedPromptError",error:e.name,errorMessage:e.message,statusCode:"500"}):null==D||D.logEvent({eventId:"ElaboratedPromptError",error:"Unknown",errorMessage:"Unknown",statusCode:"500"});null==_||_.addMessage({type:ta.ElaboratePrompt,message:l?s.CopilotCantChatAboutThis():s.CopilotSomethingWrong(),intent:"error"}),O(),i(!1),n(!1)}))}),[f,y,_]),c.useEffect((()=>{var e;h&&k({text:h,promptId:void 0,hydratedEntities:C,launchOptionPromptEntityData:E[0]||{},triggerSource:void 0,rawEntitiesData:null===(e=null==x?void 0:x.current)||void 0===e?void 0:e.getActiveEntities().map((e=>{var t,n,o;return null!==(o=null===(n=null===(t=e.data)||void 0===t?void 0:t.rawEntityData)||void 0===n?void 0:n.data)&&void 0!==o?o:{}})),attachmentSource:void 0,updateDraftSource:_l.ElaboratePrompt}),O()}),[h,k]);const R=c.useCallback((()=>{i(!1),k({text:d,promptId:void 0,hydratedEntities:C}),null==D||D.logEvent({eventId:"ElaboratedPromptDiscarded"}),n(!1)}),[i,d]),M=c.useCallback((()=>{i(!1),n(!1),null==_||_.removeMessagesByType(ta.ElaboratePrompt),null==D||D.logEvent({eventId:"ElaboratedPromptKept"})}),[i,_]),B=c.useCallback((()=>{F.current=+new Date,v(!0),null==_||_.removeMessagesByType(ta.ElaboratePrompt),null==D||D.logEvent({eventId:"ElaboratedPromptRegenerated"})}),[_]),N=c.useCallback((()=>{var e,t,o;null==_||_.removeMessagesByType(ta.ElaboratePrompt);let r="";const a=null===(e=null==w?void 0:w.current)||void 0===e?void 0:e.getEditor();null==a||a.getEditorState().read((()=>{var e;const t=(0,El.$getRoot)(),n=null===(e=null==x?void 0:x.current)||void 0===e?void 0:e.getActiveEntities();r=Yl(t,n)||""}));const s=r;if(s){F.current=+new Date,n(!0),i(!0),p(s),m(!0);const e=(null===(t=null==x?void 0:x.current)||void 0===t?void 0:t.getActiveEntities())||[],r=null!==(o=function(e){const t=[];for(const n of e)try{const e=Kl(n.type,n.entity);e&&t.push(e)}catch(e){Ql.error("Error parsing hydrated entity:",e)}return t.length>0?t:void 0}(e.map((e=>{var t,n,o,r;return{type:null===(n=null===(t=e.data)||void 0===t?void 0:t.rawEntityData)||void 0===n?void 0:n.type,entity:null===(r=null===(o=e.data)||void 0===o?void 0:o.rawEntityData)||void 0===r?void 0:r.data}}))))&&void 0!==o?o:[],a=e.map((e=>{var t,n,o,r;return{text:null===(t=e.data)||void 0===t?void 0:t.entity.text,url:null===(n=e.data)||void 0===n?void 0:n.entity.url,id:null===(o=e.data)||void 0===o?void 0:o.entity.id,type:null===(r=e.data)||void 0===r?void 0:r.annotation.queryAnnotationType}}));b(r),A(a),null==D||D.logEvent({eventId:"ElaboratePromptClicked"})}}),[i,x,_]),V={onAmplifyClick:N,disabled:t},H={onKeepItClick:M,onRegenerateClick:B,onDiscardClick:R},z=r?f||y?(()=>{const e=Nl(),t=(0,te.kQ)({CopilotWorkingonElaboratedPrompt:Ol});return c.createElement("div",{"data-testid":"loading-elaborated-prompt"},c.createElement(Bl.YJW,{className:e.inlineIcon}),c.createElement("div",{className:e.inlineElements},t.CopilotWorkingonElaboratedPrompt()))})():zl(H):(({onAmplifyClick:e,disabled:t})=>{const n=Nl(),o=(0,te.kQ)({CopilotElaboratePromptButton:Ll});return c.createElement("div",{"data-testid":"ElaboratePromptButton"},c.createElement(U.m,{withArrow:!0,content:o.CopilotElaboratePromptButton(),relationship:"label"},c.createElement(j.$,{appearance:"transparent",className:n.button,icon:c.createElement(Vl,{className:n.icon}),onClick:e,disabled:t})))})(V);return{elaboratePromptButton:z}};var Jl=n(14533),Xl=n(18907),Zl=n(7293);const ec="https://substrate.office.com/search/api/v1/suggestions",tc="X-Client-Flights",nc=(e,t)=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){try{const n=yield oc(e);return rc(n,t)}catch(e){throw new Error("Unable to get prompt suggestions. Error: "+e)}})),oc=e=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){const t=new Headers;t.set("Content-Type","application/json"),e.authToken&&t.set("Authorization",`Bearer ${e.authToken}`),e.clientFlights?t.set(tc,e.clientFlights):t.set(tc,"enablePromptAutoSuggestProvider"),e.requestID&&t.set("client-Request-id",e.requestID),e.sessionId&&t.set("client-session-id",e.sessionId);const n=function(e){return{EntityRequests:[{EntityType:"Prompt",Query:{QueryString:e.queryString},PropertySet:"ProvenanceOptimized",From:0,Size:10}],TimeZone:e.clientTimezone&&""!==e.clientTimezone?e.clientTimezone:"UTC",Cvid:e.cvid,TextDecorations:"Forward",Scenario:{Name:e.scenarioName?e.scenarioName:ic(e.appName,e.platform)}}}(e),o=e.clientAppOverride?ec+"?clientAppOverride="+e.clientAppOverride:ec,r=new Request(o,{method:"POST",headers:t,body:JSON.stringify(n)}),i=yield fetch(r);if(!i.ok)throw new Error(`Failed to send 3S prompt assitance request. Status: ${i.status}, StatusText: ${i.statusText}`);return yield i.json()}));const rc=(e,t)=>{if(e&&e.Groups){const n=[];return e.Groups.forEach((e=>{e.Suggestions.forEach((e=>{n.push(e.DisplayText)}))})),t&&t&&t>0&&t<n.length?n.slice(0,t):n}return[]};function ic(e,t){switch(e.toLocaleLowerCase()){case"word":return function(e){switch(e.toLocaleLowerCase()){case"web":return"AppChat.Word.Web.Copilot_QF";case"ipad":return"AppChat.Word.iPad.Copilot_QF";case"mac":return"AppChat.Word.Mac.Copilot_QF";default:return"AppChat.Word.Win32.Copilot_QF"}}(t);case"powerpoint":return function(e){switch(e.toLocaleLowerCase()){case"web":return"AppChat.PowerPoint.Web.Copilot_QF";case"ipad":return"AppChat.PowerPoint.iPad.Copilot_QF";case"mac":return"AppChat.PowerPoint.Mac.Copilot_QF";default:return"AppChat.PowerPoint.Win32.Copilot_QF"}}(t);case"excel":return function(e){switch(e.toLocaleLowerCase()){case"web":return"AppChat.Excel.Web.Copilot_QF";case"ipad":return"AppChat.Excel.iPad.Copilot_QF";case"mac":return"AppChat.Excel.Mac.Copilot_QF";default:return"AppChat.Excel.Win32.Copilot_QF"}}(t);default:return""}}var ac=n(1047);const sc="/";var lc,cc=n(8235),uc=n(63722);!function(e){e.Entity="Entity",e.Placeholder="Placeholder",e.Unknown="Unknown"}(lc||(lc={}));const dc=(0,x.n)({ciqText:{color:G.L.colorBrandForeground1},placeholderText:{color:G.L.colorNeutralForeground4},promptMenuItemContainer:{marginBottom:"3px"},promptMenuItem:Object.assign(Object.assign(Object.assign({display:"flex",maxHeight:"40px",maxWidth:"100%",borderRadius:"0"},de.Pt.overflow("hidden")),de.Pt.padding("10px","8px")),de.Pt.border("1px","solid",G.L.colorTransparentBackground)),promptMenuItemSelected:Object.assign(Object.assign(Object.assign({display:"flex",maxHeight:"40px",maxWidth:"100%",borderRadius:"0"},de.Pt.overflow("hidden")),de.Pt.padding("10px","8px")),de.Pt.border("1px","solid",G.L.colorNeutralForeground3))}),pc=e=>{let t=e;const n=new RegExp("","g"),o=new RegExp("","g");return t=t.replace(n,""),t=t.replace(o,""),t},hc=({prompt:e})=>{const{chunks:t}=(e=>{const t=[],n="entity",o="placeholder",r=["b","i","u","ul","ol","li","br","a",n,o],i=cc.sanitize(e.DisplayText,{IN_PLACE:!0,ALLOWED_TAGS:r,ALLOWED_ATTR:["target","href","type","ReferenceId"]}),a=(0,uc.Ay)(i);"string"==typeof a?t.push({text:a,type:"Unknown",promptType:lc.Unknown,shouldHighlight:!1}):(Array.isArray(a)?a:[a]).forEach((e=>{var r,i,a;e.type===n?t.push({text:null===(r=e.props)||void 0===r?void 0:r.children,type:null===(i=e.props)||void 0===i?void 0:i.type,promptType:lc.Entity,shouldHighlight:!0}):e.type===o?t.push({text:null===(a=e.props)||void 0===a?void 0:a.children,type:"Unknown",promptType:lc.Placeholder,shouldHighlight:!0}):t.push({text:e,type:"Unknown",promptType:lc.Unknown,shouldHighlight:!1})}));return{chunks:t}})((e=>{const t=Object.assign({},e),n=new RegExp("","g"),o=new RegExp("","g");return t.DisplayText=t.DisplayText.replace(n,"<b>"),t.DisplayText=t.DisplayText.replace(o,"</b>"),t})(e)),n=dc(),o=[];return t.forEach(((e,t)=>{o[t]=(0,mt.DA)()})),c.createElement("div",{"aria-hidden":"true"},t.map(((e,t)=>e.shouldHighlight?"Placeholder"===e.promptType?c.createElement(ye.E,{className:n.placeholderText,key:o[t]},"["+e.text+"]"):c.createElement(ye.E,{className:n.ciqText,key:o[t]},"/"+e.text):c.createElement(ye.E,{key:t},e.text))))};function gc(e){return e.includes("</entity>")?e.replace(/.*<entity type=['||"](.*?)['||"].*>.*/,"$1"):e.includes("<placeholder>")?"Unknown":""}function fc(e){return e.replace(/.*ReferenceId=['|"](.*?)['|"].*/,"$1")}function mc(e){return{DisplayText:e,CommandText:e,Text:"TODO",PromptId:"TODO",Id:"TODO",Title:"TODO",Products:[],UserActivity:{Favorite:{IsFavorite:!1}},DisplayCategory:"Create"}}function yc(e,t,n,o,r,i,a,s){const{getSharedCopilotLogger:l}=(0,I.Ay)(),u=l?l():null,{controlRef:d,isEccMenuShown:p,getEditorService:h}=a,[g,f]=c.useState([]),[m,y]=c.useState(!1),v=c.useRef(!1);c.useEffect((()=>{const n=(0,wt.A)((function(){return(0,na.__awaiter)(this,void 0,void 0,(function*(){let t=null;const{substrateTokenProvider:n}=s;if(n){const{accessToken:e}=yield n();t=e}let o;try{o=yield nc({queryString:e,appName:s.appName,authToken:null!=t?t:s.authToken,cvid:s.cvid,platform:s.platform,clientAppOverride:s.clientAppOverride,scenarioName:s.scenarioName},3)}catch(e){return}try{f(function(e,t){return t?e.map(mc).map((e=>Object.assign(Object.assign({},e),{DisplayText:e.DisplayText}))):e.map(mc)}(o,e))}catch(e){return}}))}),100);if(!(t||p||e.length<3))return n(),()=>{n.cancel()};f([])}),[p,t,s,e,u]),c.useEffect((()=>{p&&r(!1),g.length&&!p&&r(!0)}),[g,r,p,n]),c.useEffect((()=>{0===e.trim().length?(v.current&&n(!1),f([])):v.current=!0}),[e,n]);const C=c.useCallback((e=>{y(e&&g.length>0)}),[g.length]),b=c.useCallback((e=>{var t,o,i,a;r(!1),n(!0);const s=pc(e.CommandText),l=gc(s),c=function(e,t=!1){var n,o;let r="<entity",i="</entity>";t&&e.includes("<placeholder")&&(r="<placeholder",i="</placeholder>");const a=[...e.matchAll(new RegExp(r,"gi"))].map((e=>e.index)),s=[...e.matchAll(new RegExp(i,"gi"))].map((e=>e.index));let l=0,c=0;const u=[];if(!a)return[];for(;c<a.length;){const t=null!==(n=a[c])&&void 0!==n?n:0,r=s[c],d=e.substring(t,r?r+i.length:e.length);c++;const p=fc(d);u.push({entityId:p,startIndex:t-l,entityType:null!==(o=gc(d))&&void 0!==o?o:"",rawText:d}),l+=d.length}return u}(s,!0);if(!l||0===c.length)return void(null===(t=d.current)||void 0===t||t.setInputText(s));const[{entityType:u,startIndex:p,rawText:g}]=c,f=s.slice(0,p).trim(),m=s.slice(p+g.length);null===(o=d.current)||void 0===o||o.setInputText(m),null===(i=d.current)||void 0===i||i.prependText(f);const y=s.includes("<placeholder>"),v=y?l:u||l,C=y?" ":` ${sc}`;v?h().then((e=>{var t;e.setEntityScope(v),null===(t=d.current)||void 0===t||t.insertTextAtCursor(C)})):null===(a=d.current)||void 0===a||a.insertTextAtCursor(C)}),[n,r,d,h]),E=!!o&&!t&&i&&!p&&g.length>0,A=g.map(((e,t)=>c.createElement(Xl.c,{key:`PromptSuggestion-${t}`,text:e.DisplayText,value:e.CommandText},c.createElement(hc,{prompt:e})))),{cursorPositionPlugin:S,containerRef:P,promptListbox:T,triggerProps:{ref:x,onFocus:w,onBlur:k,onKeyDown:_}}=(0,Zl.w)({open:!0,positioning:{position:"above",fallbackPositions:["above"]},onSelectionModeChange:C,listboxProps:{children:A,inlinePopup:!0,onOptionSelect:(e,t)=>{const n=null==g?void 0:g.find((e=>e.CommandText===t.optionValue));n&&b(n)}}}),D=c.useCallback((e=>{e.key===ac.uf9&&E&&r(!1),_(e)}),[E,_,r]),F=c.useCallback((()=>{r(!1),n(!0)}),[n,r]);return{isAutocompleteShown:E,isPromptAutocompleteSelectMode:m,cursorPositionPlugin:S,containerRef:P,promptListbox:T,triggerProps:{ref:x,onFocus:w,onBlur:k,onKeyDown:D,onSubmit:F}}}var vc;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(vc||(vc={}));const Cc=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.MicrophoneListeningGhostText"),bc=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.MicrophoneTooltip"),Ec=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.NeedHelpLink"),Ac=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.NotNowMicrophoneButton"),Sc=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.TryAgainMicrophoneButton"),Ic=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.MicrophoneTooltipListening"),Pc=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.MicrophoneTooltipPaused"),Tc=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.MicrophoneTooltipDisabled"),xc=(0,ce.Ex)("scc-react-voice-plugin.sccVoiceStrings.MicrophoneTooltipLoading"),wc=1e4,kc={listening:()=>"Microphone Listening",paused:()=>"Microphone Paused",disabled:()=>"Microphone Disabled",loading:()=>"Microphone Loading"},_c=(0,x.n)({root:{backgroundColor:"transparent"},dialog:Object.assign({position:"relative",backgroundColor:G.L.colorNeutralBackground3,minHeight:"140px",width:"288px",maxWidth:"calc(100% - 32px)"},de.Pt.padding("16px")),button:Object.assign(Object.assign(Object.assign(Object.assign({},de.Pt.border("1px solid")),de.Pt.borderColor("transparent")),de.Pt.borderRadius("2px")),{height:"26px",whiteSpace:"nowrap",marginBottom:"8px",fontSize:"12px",fontWeight:"bolder",textAlign:"center"}),tryAgainButton:{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1,"&:hover":{backgroundColor:`${G.L.colorBrandForeground1}`}},notNowButton:{backgroundColor:G.L.colorNeutralBackground1,color:G.L.colorStrokeFocus2,"&:hover":Object.assign(Object.assign({},de.Pt.borderColor(`${G.L.colorBrandForeground1}`)),{backgroundColor:`${G.L.colorNeutralBackground1}`})},needHelpLink:{color:G.L.colorBrandForeground1,"&:hover":{color:G.L.colorBrandForeground1},fontSize:"12px"},imageContainer:{height:"63px",bottom:"12px"},dialogAction:{justifySelf:"flex-end !important",flexDirection:"row","@media screen and (max-width: 480px)":{flexDirection:"row"}},pageTopLabel:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:G.L.colorNeutralForeground2,fontSize:"12px",lineHeight:"1.15",display:"block",paddingBottom:"5px"},topLabel:{fontWeight:"bold",color:G.L.colorStrokeFocus2,fontSize:"12px",paddingBottom:"0px"}}),Dc=({shouldShowMicPermissionRetryDialog:e,microphonePermissionErrorTitle:t,microphonePermissionErrorMessage:n,microphonePermissionErrorImagePath:o,showHelpLink:r,tryAgainOnClickHandler:i,notNowOnClickHandler:a})=>{const s=_c(),l=(0,T.z)(s.button,s.tryAgainButton),u=(0,T.z)(s.button,s.notNowButton),d=s.pageTopLabel,p=(0,T.z)(d,s.topLabel),h=s.needHelpLink,g=s.imageContainer,f=(0,c.useRef)(null),m=(0,te.Lh)(Ec),y=(0,te.Lh)(Ac),v=(0,te.Lh)(Sc);return(0,c.useEffect)((()=>{var t;e&&(null===(t=f.current)||void 0===t||t.focus())}),[e]),c.createElement(yt.q,{className:s.root},c.createElement(ao.l,{modalType:"modal",open:e},c.createElement(lo.E,{className:s.dialog,tabIndex:0,style:{marginTop:window.innerHeight/3+"px"}},c.createElement(co.R,null,c.createElement(uo.L,{className:p},t),c.createElement(po.C,null,o&&c.createElement(ie._,{className:g,alt:"",src:o,width:"252px",height:"51px"}),c.createElement(si.J,{className:d},n),r&&c.createElement(ve.N,{inline:!0,className:h,target:"_blank",href:"https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},m)),c.createElement(ho.i,{className:s.dialogAction},c.createElement(so.z,{disableButtonEnhancement:!0},c.createElement(j.$,{ref:f,className:u,appearance:"secondary",onClick:a},y)),c.createElement(j.$,{className:l,appearance:"primary",onClick:i},v))))))},Fc=(0,x.n)({root:Object.assign(Object.assign(Object.assign({backgroundColor:G.L.colorNeutralBackground1,backgroundPositionX:"center",backgroundPositionY:"center"},de.Pt.borderRadius("8px")),de.Pt.borderColor(G.L.colorNeutralBackground1)),{backgroundRepeat:"no-repeat",width:G.L.spacingHorizontalXXXL,height:G.L.spacingVerticalXXXL,minWidth:G.L.spacingHorizontalXXXL,[`&:hover .${bi.h.icon}`]:{color:G.L.colorBrandForeground1},[`&:hover:active .${bi.h.icon}`]:{color:G.L.colorBrandForeground1},display:"flow"})}),Lc=(0,x.n)({root:Object.assign(Object.assign({backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1},de.Pt.borderRadius("50%")),{animationName:[{"0%":{boxShadow:`0 0 0 0 ${G.L.colorBrandBackground2}`},"60%":{boxShadow:`0 0 0 5px ${G.L.colorBrandBackground2}`},"100%":{boxShadow:`0 0 0 0 ${G.L.colorBrandBackground2}`}}],animationDuration:"5s",animationTimingFunction:"ease-in-out",animationIterationCount:"infinite",[`&.${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},[`&:hover .${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},[`&:active .${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},[`&:hover:active .${bi.h.icon}`]:{color:G.L.colorNeutralBackground1},"&:hover":{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1},"&:hover:active":{backgroundColor:G.L.colorBrandForeground1,color:G.L.colorNeutralBackground1},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}),Oc=(0,x.n)({root:{position:"relative",marginRight:G.L.spacingVerticalXS,marginLeft:G.L.spacingVerticalXS}}),Rc=(0,x.n)({root:Object.assign(Object.assign({backgroundColor:G.L.colorNeutralBackground3},de.Pt.borderRadius("50%")),{color:G.L.colorBrandForeground1}),loader:Object.assign(Object.assign(Object.assign({color:G.L.colorNeutralBackground1},de.Pt.borderRadius("50%")),de.Pt.borderTop("2px","solid",G.L.colorBrandForeground1)),{position:"absolute",top:"0px",left:"0px",right:"0px",bottom:"0px",animationName:[{from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}],animationDuration:"2s",animationTimingFunction:"linear",animationIterationCount:"infinite"})}),Mc=(0,x.n)({root:{backgroundColor:"transparent",border:"none",[`&:hover .${bi.h.icon}`]:{color:G.L.colorNeutralForegroundDisabled},[`&:hover:active .${bi.h.icon}`]:{color:`${G.L.colorNeutralForegroundDisabled} !important`}}}),Bc={micTooltipDisabled:Tc,micTooltipListening:Ic,micTooltipPaused:Pc,micTooltipLoading:xc,micButtonTitle:bc},Nc=()=>{const e=(0,te.kQ)(Bc),t=kc;return Object.assign(Object.assign({},e),t)},Vc=({isDisabled:e,microphoneButtonProps:t})=>{const[n,o]=(0,c.useState)(!1),[r,i]=(0,c.useState)(!1),a=Lc(),s=Rc(),l=Mc(),u=Nc();(0,c.useEffect)((()=>{t.isMicrophoneListening?(o(!1),h(f.current)):h(d.current.root)}),[t.isMicrophoneListening]),(0,c.useEffect)((()=>{t.microphoneState===vc.Loading?(o(!0),h(g.current)):(o(!1),t.microphoneState===vc.Uninitialized&&h(d.current.root))}),[t.microphoneState]),(0,c.useEffect)((()=>{e?h(m.current):t.isMicrophoneListening||h(d.current.root)}),[e]);const d=(0,c.useRef)(Fc()),[p,h]=(0,c.useState)(d.current.root),g=(0,c.useRef)((0,T.z)(d.current.root,s.root)),f=(0,c.useRef)((0,T.z)(d.current.root,a.root)),m=(0,c.useRef)((0,T.z)(d.current.root,l.root)),y=c.createElement(j.$,{className:p,title:t.title,"aria-label":(()=>{switch(t.microphoneState){case vc.Enabled:return t.isMicrophoneListening?u.listening():u.paused();case vc.Disabled:case vc.Uninitialized:return u.disabled();case vc.Loading:return u.loading()}})(),role:"switch","aria-checked":t.isMicrophoneListening?"true":"false",appearance:"transparent",onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),icon:t.isMicrophoneListening||r||n?c.createElement(Q.OPg,{title:"Mic-Filled"}):c.createElement(Q.AQv,{title:"Mic-Regular"}),onClick:()=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){t.handleMicrophoneButtonOnClick(event)})),disabled:e});return c.createElement("div",{className:Oc().root},c.createElement(U.m,{content:(()=>{switch(null==t?void 0:t.microphoneState){case vc.Enabled:return t.isMicrophoneListening?u.micTooltipListening():u.micTooltipPaused();case vc.Disabled:case vc.Uninitialized:return u.micTooltipDisabled();case vc.Loading:return u.micTooltipLoading();default:return u.micButtonTitle()}})(),relationship:"label",positioning:"above",withArrow:!0},y),n&&c.createElement("div",{className:s.loader}),c.createElement(Dc,{microphonePermissionErrorImagePath:t.micPermissionRetryDialogProps.microphonePermissionErrorImagePath,microphonePermissionErrorTitle:t.micPermissionRetryDialogProps.microphonePermissionErrorTitle,microphonePermissionErrorMessage:t.micPermissionRetryDialogProps.microphonePermissionErrorMessage,shouldShowMicPermissionRetryDialog:t.micPermissionRetryDialogProps.shouldShowMicPermissionRetryDialog,notNowOnClickHandler:t.micPermissionRetryDialogProps.notNowOnClickHandler,tryAgainOnClickHandler:t.micPermissionRetryDialogProps.tryAgainOnClickHandler,showHelpLink:t.micPermissionRetryDialogProps.showHelpLink}))},Hc=["ar-BH","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-OM","ar-QA","ar-SA","ar-SY","ar-AE","bg-BG","ca-ES","zh-HK","zh-CN","zh-TW","hr-HR","cs-CZ","da-DK","nl-NL","en-AU","en-CA","en-HK","en-IN","en-IE","en-NZ","en-PH","en-SG","en-ZA","en-GB","en-US","et-EE","fi-FI","fr-CA","fr-FR","de-DE","el-GR","gu-IN","hi-IN","hu-HU","ga-IE","it-IT","ja-JP","ko-KR","lv-LV","lt-LT","mt-MT","mr-IN","nb-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","es-AR","es-BO","es-CL","es-CO","es-CR","es-CU","es-DO","es-EC","es-SV","es-GT","es-HN","es-MX","es-NI","es-PA","es-PY","es-PE","es-PR","es-ES","es-UY","es-US","es-VE","sv-SE","ta-IN","te-IN","th-TH","tr-TR","af-ZA","am-ET","bn-IN","cy-GB","eu-ES","fa-IR","fil-PH","gl-ES","he-IL","hy-AM","id-ID","is-IS","ka-GE","kk-KZ","km-KH","kn-IN","lo-LA","mk-MK","ml-IN","ms-MY","ne-NP","pa-IN","sq-AL","uk-UA","vi-VN"];function Uc(e){let t="en-US";return t=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}}(function(e){const t=e.split("-");if(1==t.length)return t[0].toLowerCase();t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase());if(t.length>2)for(let e=1;e<t.length-1;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].slice(1).toLowerCase();return t.join("-")}(e)),-1==Hc.indexOf(t)&&(t=function(e){const t=e.split("-");for(let e=0;e<Hc.length;e++){const n=Hc[e];if(t[0]==n.split("-")[0])return n}return e}(t)),-1==Hc.indexOf(t)&&(t="en-US"),t}var jc=n(58651);function zc(){return(0,na.__awaiter)(this,void 0,void 0,(function*(){let e=null;if(navigator.permissions)try{e=yield navigator.permissions.query({name:"microphone"})}catch(e){}return e}))}const Gc=e=>(new Date).getTime()-e;var Wc=n(58651);const qc=e=>{const{chatInputRef:t,controlRef:n,isDisabled:o,languageSupportsSpace:r,maxInputCharLimit:i,placeholderText:a,voiceInputProps:s,getMicrophoneService:l}=e,{getSharedCopilotLogger:u}=(0,I.Ay)(),d=u?u():null,p=(0,te.Lh)(Cc),[h,g]=c.useState(!1),[f,m]=c.useState(vc.Uninitialized);let y=0;const[v,C]=c.useState(!1),[b,E]=c.useState(),A=c.useRef(void 0),S=c.useRef(!1),P=c.useRef(null),T=c.useCallback((e=>{var t,o,i,a,s,l;if(e){null==d||d.logEvent({eventId:"MicrophoneLoadingTimeInMs",metaData:Gc(y).toString()});const e=n.current&&(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>0&&r.current?" ":"";null===(o=P.current)||void 0===o||o.setGhostText(e+p)}else{const e=null===(a=null===(i=P.current)||void 0===i?void 0:i.getGhostText())||void 0===a?void 0:a.trim();e&&""!==e&&e!==p?null===(s=P.current)||void 0===s||s.commitGhostText(e):null===(l=P.current)||void 0===l||l.cancelGhostText()}g(e),S.current=e}),[a]);c.useEffect((()=>()=>{var e;null===(e=A.current)||void 0===e||e.destroyVoiceInputConnection()}),[]),c.useEffect((()=>{(0,na.__awaiter)(void 0,void 0,void 0,(function*(){const e=yield l().then((e=>e));A.current=e,E(e)}))}),[l]),c.useEffect((()=>{var e;h?null===(e=t.current)||void 0===e||e.focus():null==b||b.pauseMicInputAndStopTimer(T).catch((e=>{Wc.log("pauseMicandStopTimer Error"+e)}))}),[h]);const x=c.useCallback((e=>{var a,s,l,c;if(!S.current||o||n.current&&n.current.getInputText().length>=i)return;const u=n.current&&(null===(a=n.current)||void 0===a?void 0:a.getInputText().length)>0&&r?" ":"";null===(s=P.current)||void 0===s||s.commitGhostText(u+e),null===(l=t.current)||void 0===l||l.focus(),null===(c=n.current)||void 0===c||c.scrollToBottom()}),[o,i]),w=c.useCallback((e=>{var t,a,s,l;if(!S.current||o||null!=n.current&&(null===(t=n.current)||void 0===t?void 0:t.getInputText().length)>=i)return;const c=n.current&&(null===(a=n.current)||void 0===a?void 0:a.getInputText().length)>0&&r?" ":"";null===(s=P.current)||void 0===s||s.setGhostText(c+e),null===(l=n.current)||void 0===l||l.scrollToBottom(),e.trim()&&(null==b||b.startVoiceInputTimer(wc,T))}),[o,i,T]),k=c.useCallback((()=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){if(b){const e=(new Date).getTime(),t=Uc(s.voiceInputLocale);yield null==b?void 0:b.initializeVoiceInputConnection(t,x,w),(e=>{(0,na.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield zc();jc.log("Microphone Permission Status = "+(null==t?void 0:t.state)),"granted"===(null==t?void 0:t.state)?e(vc.Enabled):e(vc.Uninitialized)}))})(m),T(!1),null==d||d.logEvent({eventId:"MicrophoneInitializationTimeInMs",metaData:Gc(e).toString()}),r.current=(e=>{switch(e.toLowerCase()){case"zh-hk":case"zh-cn":case"zh-tw":case"ja-jp":return!1;default:return!0}})(Uc(t)),null==d||d.logEvent({eventId:"MicrophoneSuccessfullyInitialized"})}}))),[w,x,T,b]);c.useEffect((()=>{b&&k()}),[k,b]);const _={isDisabled:o,microphoneButtonProps:{isMicrophoneListening:h,microphoneState:f,handleMicrophoneButtonOnClick:e=>(0,na.__awaiter)(void 0,void 0,void 0,(function*(){var t,n,o;null==e||e.stopPropagation();try{if(h){null==d||d.logEvent({eventId:"MicrophonePauseClicked"});const e=null===(n=null===(t=P.current)||void 0===t?void 0:t.getGhostText())||void 0===n?void 0:n.trim();e&&""!==e&&e!==p&&(null===(o=P.current)||void 0===o||o.commitGhostText(e)),yield null==b?void 0:b.pauseMicInputAndStopTimer(T)}else null==d||d.logEvent({eventId:"MicrophonePlayClicked"}),f===vc.Uninitialized&&m(vc.Loading),y=(new Date).getTime(),yield null==b?void 0:b.resumeRecordingSession(),C(!1),T(!h),m(vc.Enabled),yield null==b?void 0:b.startVoiceInputTimer(wc,T)}catch(e){const t=`Error occurred while fetching mic permissions - : ${e}`;return Wc.error(t),"ErrorAudioPermissionDeniedError"==e&&(yield null==b?void 0:b.pauseRecordingSession(),C(!0),null==d||d.logEvent({eventId:"MicrophonePermissionDenied"})),void m(vc.Uninitialized)}})),micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:v,microphonePermissionErrorTitle:null==s?void 0:s.microphonePermissionErrorTitle,microphonePermissionErrorMessage:null==s?void 0:s.microphonePermissionErrorMessage,tryAgainOnClickHandler:()=>{b&&(y=(new Date).getTime(),((e,t,n,o,r,i)=>{(0,na.__awaiter)(void 0,void 0,void 0,(function*(){try{yield e.resumeRecordingSession(),o(!1),r(vc.Enabled),i(!t),e.startVoiceInputTimer(n,i)}catch(t){jc.error("Error occurred - "+t),"ErrorAudioPermissionDeniedError"===t&&(yield e.pauseRecordingSession(),o(!0)),r(vc.Uninitialized)}}))})(b,h,wc,C,m,T))},notNowOnClickHandler:()=>{C(!1)},microphonePermissionErrorImagePath:null==s?void 0:s.microphonePermissionImagePath,showHelpLink:null==s?void 0:s.showMicrophonePermissionHelpLink}}},D=Vc(_);var F;return{ghostTextPlugin:(F=P,c.createElement(Ri.a,{ref:F,id:"scc-react-voice-plugin"})),microphoneButton:D||void 0}},Qc=(e,t,n,o,r,i,a,s,l,u,d,p,h,g)=>{const f=(0,Gn.Y$)(),m=g?f.enableAddSelectionForGPTs:f.isSelectionButtonEnabled,y={...I.IB,useVoiceInput:f.isSccVoiceEnabled?()=>qc({...e}):I.IB.useVoiceInput,useCiq:()=>kl({...n}),useEntityPlugin:()=>(0,Jl.a)({entityRef:o,entityPluginId:io.wb}),useCloudFiles:()=>r,useLocalFiles:f.isLocalFileUploadEnabled?()=>s:I.IB.useLocalFiles,usePromptSuggestions:f.isSccPromptSuggestionsEnabled&&l&&l.controlRef?()=>{const e=function(e){var t;const[n,o]=c.useState(!0),[r,i]=c.useState(""),[a,s]=c.useState(!1),[l,u]=c.useState(!1),[d,p]=c.useState(!0),h=(0,Cr.Mb)(),g=null!==(t=h.hostAppAuthToken)&&void 0!==t?t:gs.gh,f=c.useMemo((()=>({appName:h.hostAppSettings.appName,platform:h.hostAppSettings.platform,substrateTokenProvider:g.substrateTokenProvider,sessionId:h.hostAppSettings.sessionId,cvid:(0,mt.DA)()})),[g.substrateTokenProvider,h.hostAppSettings.appName,h.hostAppSettings.platform,h.hostAppSettings.sessionId]),{isAutocompleteShown:m,isPromptAutocompleteSelectMode:y,cursorPositionPlugin:v,containerRef:C,promptListbox:b,triggerProps:E}=yc(r,l,u,d,p,a,e,f),A=c.useCallback((e=>{s(!0),E.onFocus(e)}),[E,s]),S=c.useCallback((e=>{s(!1),E.onBlur(e)}),[E]),I=c.useCallback(((e,t)=>{y||t&&E.onSubmit()}),[y,E]),P=c.useCallback(((e,t)=>{const r=""===t.value.trim();n!==r&&o(r),i(t.value)}),[n]),T=c.useCallback((e=>{E.onKeyDown(e)}),[E]);return c.useEffect((()=>{e.controlRef.current&&e.controlRef.current.setInputText(r)}),[e.controlRef,r]),{promptListbox:m?b:void 0,cursorPositionPlugin:v,containerRef:C,onChange:P,onSubmit:I,onBlur:S,onFocus:A,onKeyDown:T,ref:E.ref,isPromptAutocompleteSelectMode:y}}(l);return e}:I.IB.usePromptSuggestions,useInputMessages:f.isInputMessageEnabled?()=>i:I.IB.useInputMessages,useAttachmentList:f.isAttachmentListEnabled?()=>{const e=(({entityRef:e,ciqTriggerPluginRef:t,showAttachmentHint:n=!0,maxVisibleAttachments:o,onDismiss:r,getCanvasSelection:i,showAddSelectionHint:a})=>{const{attachmentContext:s,localFileContext:l}=(0,I.Ay)(),{attachments:u}=s||{},{localFilesEntities:d}=l||{},p=c.useMemo((()=>null==u?void 0:u.map((e=>{var t,n;if("LocalFile"===(null===(t=e.data.entityElement)||void 0===t?void 0:t.entityType)){const t=null==d?void 0:d.find((t=>{var n;return t.id===(null===(n=e.data.entityElement)||void 0===n?void 0:n.id)}));return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{progress:null!==(n=null==t?void 0:t.progress)&&void 0!==n?n:0})})}return e}))),[u,d]),h=c.useCallback(((t,n)=>{var o,i;if(n.id){null==s||s.setAttachments((e=>e.filter((e=>{var t,o,r;const i=null===(o=null===(t=e.data)||void 0===t?void 0:t.entityElement)||void 0===o?void 0:o.id,a=null===(r=e.data)||void 0===r?void 0:r.imageId;return i!==n.id&&a!==n.id}))));const t=(i=n.id,(e,t)=>{var n;return(null===(n=e.data)||void 0===n?void 0:n.entity.id)===i});t&&(null===(o=e.current)||void 0===o||o.removeChatInputEntity(t)),null==r||r(n.id)}}),[]);return{attachmentList:fl({items:p||[],onItemRemoved:h,ciqTriggerPluginRef:t,showAttachmentHint:n,maxVisibleAttachments:o,getCanvasSelection:i,showAddSelectionHint:a})}})({entityRef:o,ciqTriggerPluginRef:n.insertCiqTriggerPluginRef,showAttachmentHint:u,onDismiss:d,maxVisibleAttachments:f.maxVisibleAttachments,getCanvasSelection:p,showAddSelectionHint:m&&h});return e}:I.IB.useAttachmentList,useHydratedEntityPlugin:()=>a,useElaboratePromptPlugin:f.isSccElaboratePromptEnabled?()=>$l({...t}):I.IB.useElaboratePromptPlugin};return y};var Kc=n(58651);var Yc;!function(e){e.AttachFile="AttachFile",e.TriggerChar="TriggerChar",e.Fre="Fre"}(Yc||(Yc={}));const $c=(e,t,n,o)=>({text:e.text,entityProps:{className:n,text:Object.assign(Object.assign({as:"a"},e.url?{href:e.url,target:"_blank",rel:"noopener"}:{}),{"data-entity-id":e.id,"data-entity-type":e.entityType})},data:{entity:e,annotation:t,rawEntityData:o?{data:o,type:e.entityType}:void 0}}),Jc=e=>{const{ciqElementContainerClassName:t,updateDraftForEntity:n}=e,{getSharedCopilotLogger:o}=(0,I.Ay)(),r=o?o():null,i=c.useCallback((e=>{var t,o;const r=null!==(o=null===(t=e.clipboardData)||void 0===t?void 0:t.getData("text"))&&void 0!==o?o:"";if((e=>e.includes("</entity>"))(r)&&n){const e=(e=>{var t;const n=e.slice(e.indexOf("<entity"),e.indexOf("</entity")+9);return null===(t=(new DOMParser).parseFromString(n,"text/html").getElementsByTagName("entity").item(0))||void 0===t?void 0:t.getAttribute("type")})(r);return n({text:r,ciqEntity:null!=e?e:"all"}),{handled:!0}}return{handled:!1}}),[n]),a=c.useCallback((e=>{e&&(null==r||r.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][Paste] File link found in clipboard data (type=text/link-preview)"}))}),[r]),s=c.useCallback((e=>{null==r||r.logEvent({eventId:"UXDiagnostic",message:`[ChatInput][Paste] ${e}`})}),[r]),l=c.useCallback(((e,t)=>{e&&(null==r||r.logEvent({eventId:"UXDiagnostic",message:`[ChatInput][Paste] File links found: ${e} Names inferred: ${t}`}))}),[r]),u=(0,yl.O)({onComplete:a,onError:s}),d=(0,ml.K)({onComplete:l}),p=c.useMemo((()=>[i,u,d]),[u,d,i]),h=c.useCallback(((e,n,o,r,i)=>{var a;if(!o)return(0,Di.Qf)(e,n,o,r,i);const s=$c(o.entity,Object.assign(Object.assign({},o.annotation),{queryAnnotationType:o.annotation.queryAnnotationType}),t,null===(a=o.rawEntityData)||void 0===a?void 0:a.data);return(0,Di.Qf)(e,s.text,s.data,s.entityProps,i)}),[t]);return c.createElement(Cl.P,{entityPluginId:"",transforms:p,$createEntityNode:h})};function Xc(e){return e.replace(/.*ReferenceId=['|"](.*?)['|"].*/,"$1")}function Zc(e,t){if(!t.global)throw new Error("The regex must have the global flag set");const n=[];let o;for(;null!==(o=t.exec(e));)n.push(o);return n}function eu(e,t,n){var o,r;if(e)if("metadata"in e){const{text:t,url:i,id:a,type:s,metadata:l}=e,c=null!==(r=null===(o=l.Source)||void 0===o?void 0:o.FileExtension)&&void 0!==r?r:void 0,u=tu(s);if(u)return{CIQelm:{id:a,text:t,url:i,entityType:u,fileExtension:c,createdFrom:n},annotation:{queryAnnotationType:u,id:a,text:t}}}else{const{text:t,url:o,id:r,type:i}=e,a=tu(i);if(a)return{CIQelm:{id:r,text:t,url:o,entityType:a,createdFrom:n},annotation:{queryAnnotationType:a,id:r,text:t}}}else if(t){const{text:e,url:o,id:r,type:i}=t;return{CIQelm:{id:r,text:e,url:o,entityType:i,createdFrom:n},annotation:{queryAnnotationType:i,id:r,text:e}}}}function tu(e){switch(e.toLowerCase()){case"file":return va.in.File;case"meeting":case"event":return va.in.Event;case"email":case"message":return va.in.Message;case"person":case"people":return va.in.People}}const nu=(e,t,n,o,r)=>{var i;const a=$c(e,t,o||"",r);null===(i=n.current)||void 0===i||i.insertChatInputEntity(a)};function ou({entityIndices:e,text:t,imperativeControlRef:n,entityRef:o,entities:r,rawEntitiesData:i,launchOptionPromptEntityData:a,entityClassName:s,eccQueryChar:l="/",telemetryLogger:c,createdFrom:u,attachmentSource:d,editorService:p}){var h,g,f,m,y,v,C,b;null===(h=n.current)||void 0===h||h.setInputText("");const{insideTexts:E,outsideTexts:A}=function(e){const t=/<entity[^>]*>([\s\S]*?)<\/entity>/gi;let n,o=0;const r=[],i=[];for(;null!==(n=t.exec(e));)r.push(e.slice(o,n.index)),i.push(n[1]),o=n.index+n[0].length;return o<e.length&&r.push(e.slice(o)),{outsideTexts:r,insideTexts:i}}(t);let S=0;const I=[...e].sort(((e,t)=>e.startIndex-t.startIndex));let P=!1,T=0;for(const{entityId:e,entityType:t}of I){null===(g=n.current)||void 0===g||g.appendText(A[S]||"");const h=null==r?void 0:r.find((t=>t.id===e||t.referenceId===e)),b=null==i?void 0:i.find((t=>t.id===e||t.referenceId===e));if(h||a){const{CIQelm:e,annotation:t}=h?null!==(y=eu(h,void 0,null!=u?u:null==b?void 0:b.createdFrom))&&void 0!==y?y:{}:null!==(v=eu(void 0,a,null!=u?u:null==b?void 0:b.createdFrom))&&void 0!==v?v:{};if(e&&t){const n=b?Object.assign(Object.assign({},b),{createdFrom:null!=u?u:b.createdFrom,attachmentSource:null!=d?d:oa.H.PromptGuide}):void 0;nu(e,t,o,s,n),T++}else null===(C=n.current)||void 0===C||C.appendText(E[S])}else null==c||c.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][UpdateDraft] No entity object found in either hydrated entity data or launch option data"}),P?null===(m=n.current)||void 0===m||m.appendText(E[S]):(t&&(null==p||p.setEntityScope(t)),null===(f=n.current)||void 0===f||f.appendText(" "+l),P=!0);S++}S<A.length&&(null===(b=n.current)||void 0===b||b.insertTextAtCursor(A[S])),T&&(null==c||c.logEvent({eventId:"UXDiagnostic",message:`[ChatInput][UpdateDraft] Inserted ${T} entities`}))}const ru=({editorService:e,imperativeControlRef:t,entityRef:n,telemetryLogger:o,featureFlags:r={},ciqElementContainerClassName:i="",eccQueryChar:a="/",setElaboratePromptActionsState:s})=>{const{enableHydratedEntities:l,enableSearchBar:u,enablePromptSavingHydratedEntities:d,enablePlaceholderTag:p,enableElaboratePromptRelay:h}=r,g=c.useCallback((({text:r,ciqEntity:c,hydratedEntities:g,launchOptionPromptEntityData:f,triggerSource:m,rawEntitiesData:y,attachmentSource:v,updateDraftSource:C})=>{var b,E,A,S,I;const P=function(e,t=!1){var n,o;let r="<entity",i="</entity>";t&&e.includes("<placeholder")&&(r="<placeholder",i="</placeholder>");const a=Zc(e,new RegExp(r,"gi")).map((e=>e.index)),s=Zc(e,new RegExp(i,"gi")).map((e=>e.index));let l=0,c=0;const u=[];if(!a)return[];for(;c<a.length;){const t=null!==(n=a[c])&&void 0!==n?n:0,r=s[c],p=e.substring(t,r?r+i.length:e.length);c++;const h=Xc(p);u.push({entityId:h,startIndex:t-l,entityType:null!==(d=p,o=d.includes("</entity>")?d.replace(/.*<entity type=['||"](.*?)['||"].*>.*/,"$1"):d.includes("<placeholder>")?"Unknown":"")&&void 0!==o?o:"",rawText:p}),l+=p.length}var d;return u}(r,!0);if(h&&"ElaboratePrompt"!==C&&s&&s(!1),!c&&!(null==P?void 0:P.length))return null===(b=t.current)||void 0===b||b.setInputText(r),void(null==o||o.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][UpdateDraft] Set text without trigger character"}));if(e&&(e.eccManuallyInitiated(m||va.KD.PromptGuide),u&&e.notifyTriggeringType(Yc.Fre)),(l||d)&&(null==g?void 0:g.length)&&g.length>0)null==o||o.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][UpdateDraft] Set text with hydrated entities"}),ou({entityIndices:P,text:r,imperativeControlRef:t,entityRef:n,entities:g,rawEntitiesData:y,entityClassName:i,eccQueryChar:a,telemetryLogger:o,attachmentSource:v});else if(f)null==o||o.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][UpdateDraft] Set text with launch option data"}),ou({entityIndices:P,text:r,imperativeControlRef:t,entityRef:n,rawEntitiesData:y,launchOptionPromptEntityData:f,entityClassName:i,eccQueryChar:a,telemetryLogger:o,attachmentSource:v,editorService:e});else if(r.includes("<placeholder>")&&p){null==o||o.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][UpdateDraft] Set text with placeholder character"});const{startIndex:n,rawText:i}=P[0],a=r.slice(0,n).trim(),s=r.slice(n+i.length);null===(E=t.current)||void 0===E||E.setInputText(s),null===(A=t.current)||void 0===A||A.prependText(a);const l=c;setTimeout((()=>{var n;l&&e&&e.setEntityScope(l),null===(n=t.current)||void 0===n||n.insertTextAtCursor(" ")}),1)}else{null==o||o.logEvent({eventId:"UXDiagnostic",message:"[ChatInput][UpdateDraft] Set text with trigger character"});const{entityType:n,startIndex:i,rawText:s}=P[0],l=r.slice(0,i).trim(),u=r.slice(i+s.length);null===(S=t.current)||void 0===S||S.setInputText(u),null===(I=t.current)||void 0===I||I.prependText(l);const d=n||c;setTimeout((()=>{var n;d&&e&&e.setEntityScope(d),null===(n=t.current)||void 0===n||n.insertTextAtCursor(" "+a)}),1)}}),[h,s,e,l,d,t,o,u,n,i,a,p]);return{updateDraftForEntity:g,hydratedEntityPlugin:c.createElement((()=>c.createElement(c.Fragment,null,c.createElement(Jc,{ciqElementContainerClassName:i,updateDraftForEntity:g}))),null)}};const iu={nonImagePasteError:et,uploadImageBadContentError:Xe,uploadImageFileTooBigErrorFormat:Je,uploadImageUnsupportedTypeError:$e},au=(e,t,n,o,r,i,a,s,l,u,d,p,h,g,f)=>{const m=(0,te.kQ)(iu),y=c.useRef(0),{setAttachments:v}=g||{},[C,b]=c.useState([]),[E,A]=c.useState(void 0);c.useEffect((()=>{C&&0!=C.length&&(async e=>{const t=new cs.w;await t.ResizeImage(e,a,l,u,s,d,p);const n=t.base64ResizedImage;n?(I(n),b((e=>[]))):P(m.uploadImageBadContentError())})(C[0].dataUri)}),[C,i,a,l,u,s,d,p,Xe]);const S=e=>{i?ss(e.length,r)?P(ls(m.uploadImageFileTooBigErrorFormat(),r)):b((t=>[{dataUri:e,id:y.current++}])):I(e)},I=e=>{const t=y.current++,n={type:Ys.J.image,data:{imageId:t.toString(),dataUri:e}};v?.((e=>[...e.filter((e=>e.type!==Ys.J.image)),n]))},P=e=>{A(e),setTimeout((()=>{A(void 0)}),3e3)},T=(e,t)=>{if(o)if(e.clipboardData?.files?.length>0){const t=new FileReader;t.addEventListener("load",(()=>{if(i){const e=t.result.length;ss(e,r)?P(ls(m.uploadImageFileTooBigErrorFormat(),r)):b((e=>[{dataUri:t.result,id:y.current++}]))}else I(t.result)})),t.readAsDataURL(e.clipboardData.files[0])}else t&&P(m.nonImagePasteError())},x={handleScreenshotOnClick:async t=>{if(n)return;if(void 0===h)return;t?.stopPropagation();const o=await h();o&&(i?b((e=>[{dataUri:o,id:y.current++}])):I(o)),e.current?.focus()}};return{getImages:()=>g?.attachments.filter((e=>e.type===Ys.J.image)),updateImageAttachmentData:I,handlePaste:e=>{T(e,!1)},error:E,insertImageButtonProps:{handleImagePaste:t=>{t?.stopPropagation(),T(t,!0),e.current?.focus()},handleImageUploadOnClick:o=>{n||(o?.stopPropagation(),rs(S,m,t,!!f?.isFocusChatAfterImageUploadEnabled&&f?.isFocusChatAfterImageUploadEnabled,P),e.current?.focus())},showNonImageEntryError:()=>{P(m.nonImagePasteError())},handleImageUploadFromPhone:t=>{n||0===t.length||(t[0]&&S(t[0]),e.current?.focus())},isImageFromPhoneButtonEnabled:f?.isImageFromPhoneButtonEnabled??!1,isPasteFromClipboardButtonEnabled:f?.isPasteFromClipboardButtonEnabled??!1,uploadPollingIntervalMs:f?.uploadPollingIntervalMs??5e3},screenshotButtonProps:x,removeImages:()=>{v?.((e=>e.filter((e=>e.type!==Ys.J.image))))},removeImage:e=>{v?.((t=>t.filter((t=>t.data.imageId!==e))))}}},su=(0,x.n)({attachmentImage:{width:"48px",height:"48px",objectFit:"cover"}});var lu=n(81130),cu=n(10806);const uu="{",du="}",pu=e=>{const{closingMarker:t=du,onChatInputTokenAdded:n,onChatInputTokenDeleted:o,openingMarker:r=uu,tokenListPhrases:i=[],useSortedTokenList:a=!1}=e,[s]=(0,bl.useLexicalComposerContext)();a&&(e=>{e.sort(((e,t)=>{const n=e.tokenPhrases.join(""),o=t.tokenPhrases.join("");return n<o?-1:n>o?1:n.length-o.length}))})(i);const l=c.useRef(!1),u=c.useCallback((e=>{const{endIndex:n,node:o,startIndex:i,text:a}=e;l.current=!0;const s=(0,Fi.iY)(a),c=o.splitText(i,n);let u=0,d=o,p=0;for(const e of c)if(u++,p+=e.getTextContent().length,e.getTextContent().toLowerCase()===a.toLowerCase()||e.getTextContent().toLowerCase()===r+a.toLowerCase()+t){e.replace(s);break}return u<c.length&&(d=c[u]),(0,El.$isRootOrShadowRoot)(s.getParentOrThrow())&&(0,lu.$wrapNodeInElement)(s,El.$createParagraphNode).selectEnd(),{updatedNode:d,nodeOffset:p}}),[t,r]);return(0,cu.E)((()=>(0,lu.mergeRegister)(s.registerMutationListener(Fi.Ag,((e,t)=>{for(const[r,i]of e)"destroyed"===i?t.prevEditorState.read((()=>{const e=(0,El.$getNodeByKey)(r);(0,Fi.cn)(e)&&(l.current=!1,o?.(e.getTextContent()),s.update((()=>{const e=(0,El.$getRoot)().getFirstChild();(0,El.$isElementNode)(e)&&e.getChildren()?.forEach((e=>{(0,Fi.cn)(e)&&e.replace((0,El.$createTextNode)(e.getTextContent()))}))})),s.update((()=>{(0,El.$getRoot)().getAllTextNodes().forEach((e=>e.markDirty()))})))})):"created"===i&&s.getEditorState().read((()=>{const e=(0,El.$getNodeByKey)(r);if((0,Fi.cn)(e)){l.current=!0;let e="";const t=(0,El.$getRoot)().getFirstChild();(0,El.$isElementNode)(t)&&t.getChildren()?.forEach((t=>{(0,Fi.cn)(t)&&(e+=t.getTextContent())})),n?.(e)}}))})))),[s,n,o]),c.useEffect((()=>s.registerNodeTransform(El.TextNode,(e=>{if(l.current)return;const n=e.getTextContent(),o=n.indexOf(r),a=n.indexOf(t,o);if(-1===o||-1===a){if(i.length>0)for(const t of i){let o=0;if(t.tokenPhrases.every((e=>{const t=n.toLocaleLowerCase().indexOf(e.toLocaleLowerCase(),o);return-1!==t&&(o=t+e.length,!0)}))){let o=0,r=0;for(const i of t.tokenPhrases){const t=n.toLocaleLowerCase().indexOf(i.toLocaleLowerCase(),r);r=t+i.length-o;const a=u({node:e,startIndex:t-o,endIndex:r,text:i});e=a.updatedNode,o+=a.nodeOffset}return}}return}const s=n.substring(o+1,a);""!==s&&u({node:e,startIndex:o,endIndex:a+1,text:s})}))),[u,t,s,r,i]),null},hu=()=>{},gu={attachmentAltTextFormat:Ze,characterLimitReachedError:tt,defaultSubmitButtonTitle:Ee,defaultChatInputContainerTitle:Ce,defaultStarterPromptMenuButtonTitle:be,defaultCIQButtonTitle:xe,defaultAtMentionButtonTitle:we,defaultChatInputPlaceholder:Ae,defaultGroundingButtonTitle:ke,updatedGroundingButtonTitle:_e},fu="CanvasSelection",mu=(e,t)=>{const o=(0,te.kQ)(gu),r=(0,Gn.Y$)(),i=e.isGPTCopilotSelected?r.enableAddSelectionForGPTs:r.isSelectionButtonEnabled,{chatInputContainerTitle:a=o.defaultChatInputContainerTitle(),ciqButtonTitle:s=o.defaultCIQButtonTitle(),atMentionButtonTitle:l=o.defaultAtMentionButtonTitle(),copilotChatTheme:u,editorProps:d,groundingButtonPluginProps:p,groundingSourcePickerProps:h,handleChatInputLoad:g=hu,handleFirstUserInput:f=hu,handleOnChatInputControlMount:m,handleOnChatInputControlUnmount:y,handleOnInput:v,handleSubmitButtonClick:C,isCIQButtonEnabled:b=!1,isAtMentionButtonEnabled:E=!1,isDarkMode:A,isDisabled:S,setIsDisabled:P=hu,isMenuButtonEnabled:T=!1,isGroundingButtonEnabled:x=!1,isSubmitButtonDisabled:w,maxInputCharLimit:k=r.promptInputLength??io.Xb,menuButtonTitle:_=o.defaultStarterPromptMenuButtonTitle(),overrideStyles:D,placeholderText:F=o.defaultChatInputPlaceholder(),restShyPlaceholderText:L=o.defaultChatInputPlaceholder(),promptGuideMenuProps:R,shouldBlockGroundingButtonClick:M=()=>!1,shouldBlockSubmitButtonClick:B=()=>!1,submitButtonTitle:N=o.defaultSubmitButtonTitle(),voiceInputProps:V,chatInputBannerProps:H,hvcPromptStringsList:U,isHVCAppChatV2Enabled:j,onChatInputHVCPromptUpdated:z,characterLimitErrorMessage:G=o.characterLimitReachedError(),useSortedHVCTokenList:W,handleOnChange:q,imageInputEnabled:Q=!1,isImageInputButtonEnabled:K=!1,imageSizeLimitInMB:Y,isImageResizeEnabled:$=!0,imageResizedSizeLimitInKB:J,imageResizePreferredSizeInPx:X,imageResizeQuickDimensionsReductionMultiplier:Z,imageResizeSlowDimensionsReductionMultiplier:ee,imageResizeCompressionQuality:ne,imageResizeFormatType:oe,isScreenshotButtonEnabled:re=!1,getScreenshot:ie,customNodes:ae,plugins:se,telemetryLogger:le,atMentionApp:ce,setAtMentionApp:ue,sendWarmupSignal:de,isMinified:pe=!1,shouldInitializeCIQ:he=!0,insertImageFlags:ge=Mi,getCanvasSelection:fe}=e;let me=e.isStartOfQueryRef;const[ye,ve]=c.useState(!1),[Ce,be]=c.useState(!1),[Ee,Ae]=c.useState(!1),[Se,Ie]=c.useState(F),[Pe,Te]=c.useState(!1),[xe,we]=c.useState(!0),[ke,_e]=c.useState(void 0),[De,Fe]=c.useState(!1),Le=c.useRef(),Oe=c.useRef(),Re=c.useRef(!0),Me=c.useRef(!0),Be=c.useRef(null),Ne=c.useRef(null),Ve=c.useRef(null),He=c.useRef(null),Ue=c.useRef(null),je=r.enableButtonHidingWithAtMention&&!!ce||S;(0,ns.WT)(le),wi.createInstance(le);const[ze,Ge]=c.useState([]),We={controlRef:Ve,entityRef:Ne,inputRef:Ue,insertCiqTriggerPluginRef:He},qe={attachments:ze,setAttachments:Ge},Qe=(({uploadFileRef:e,supportedFileExtensionMimeMap:t=O,isImageInputEnabled:n=!1})=>{const[o,r]=c.useState([]),[i,a]=c.useState(!1),[s,l]=c.useState(!1),[u,d]=c.useState(),[p,h]=c.useState(),[g,f]=c.useState(!1);return{uploadFileRef:e,duplicateFile:u,setDuplicateFile:d,uploadErrors:p,setUploadErrors:h,isFileBeingDragged:i,setIsFileBeingDragged:a,isFileUploadInProgress:s,setIsFileUploadInProgress:l,localFilesEntities:o,setLocalFilesEntities:r,dismissedPrivacyMessage:g,setDismissedPrivacyMessage:f,supportedFileExtensionMimeMap:t,isImageInputEnabled:n,odbDataRef:c.useRef(void 0)}})({uploadFileRef:c.useRef(null),isImageInputEnabled:Q}),{selections:Ke,setSelections:Ye,handleAddSelectionClick:$e,getRawCanvasSelections:Je,updateAttachmentList:Xe,showAddSelectionHint:Ze,handleAddSelectionOnInputFocus:et,handleAddSelectionOnInputBlur:tt,selectionError:nt,setSelectionError:ot}=((e,t,n,o)=>{const[r,i]=c.useState([]),[a,s]=c.useState(!1),[l,u]=c.useState(void 0),d=()=>{const e=t?.attachments?.filter((e=>"CanvasSelection"===e.data?.entityElement?.entityType)).map((e=>e.data?.entityElement?.originalText));return JSON.stringify(e)||""},p=async()=>{if(!e)return;const t=await e();return u(t?.errorMessage||void 0),t?.isValid},h=c.useCallback((async()=>{await p()?s(!0):s(!1)}),[p]),g=c.useCallback((e=>{e?.relatedTarget?.id!==cl&&(u(void 0),s(!1))}),[]);return{selections:r,setSelections:i,getRawCanvasSelections:()=>n?d():r[0]?.selection,handleAddSelectionClick:async()=>{if(!e)return;const t=await e();i((e=>[t]))},updateAttachmentList:e=>{if(!t)return;const n=e.map(((e,n)=>({type:Ys.J.entity,data:{entityElement:{id:"selectionAttachment"+(t.attachments.length+n).toString(),text:e.attachmentDisplayText||e.selection,originalText:e.selection,url:"",entityType:"CanvasSelection"}}})));t.setAttachments?.((e=>[...e,...n]))},showAddSelectionHint:(()=>{if(a&&o)return!0;const e=t?.attachments;return a&&(0==e?.length||!e?.some((e=>"CanvasSelection"===e.data?.entityElement?.entityType)))})(),handleAddSelectionOnInputFocus:h,handleAddSelectionOnInputBlur:g,selectionError:l,setSelectionError:u}})(fe,qe,r.isAttachmentListEnabled,r.isMultiSelectionAttachmentEnabled),{nextImageId:rt,images:it,setImages:at,handlePaste:st,error:lt,insertImageButtonProps:ct,screenshotButtonProps:ut}=ds(Ue,Ve,je,Q,Y,$,J,X,Z,ee,ne,oe,ie,ge,Ye),dt=au(Ue,Ve,je,Q,Y,$,J,X,Z,ee,ne,oe,ie,qe,ge),pt=es({uploadFileRef:Qe.uploadFileRef,shouldShowFileUploadButtonText:!1,enableDragAndDrop:r.isDragDropWrapperEnabled,styles:{container:"{}"}}),ht=I.IB.useLocalFiles(),gt=su(),ft=e=>o.attachmentAltTextFormat().replace("{0}",e.toString()),mt=r.isAttachmentListEnabled?void 0:(it.length>0||Ke.length>0)&&c.createElement(ki._,{onAttachmentDismiss:(e,t)=>{const n=it.findIndex((e=>e.id===Number(t.id)));n>=0&&at((e=>{const t=[...e];return t.splice(n,1),t}))}},it.map((({id:e,dataUri:t})=>c.createElement(_i.o,{key:e,id:e.toString(),imageOnly:!0},c.createElement("img",{src:t,className:gt.attachmentImage,alt:`${ft(e)}`})))),Ke.map(((e,t)=>c.createElement(_i.o,{key:"selection attachment"+t,media:c.createElement(ts.U5e,null),dismissButton:{onClick:()=>Ye([])}},e.attachmentDisplayText?.substring(0,10)))));c.useEffect((()=>{!1===i&&qe.attachments.length>0&&qe.setAttachments(qe.attachments?.filter((e=>e.data?.entityElement?.entityType!==fu)))}),[i]);const yt=async()=>{const e=await n.e("vendors~sccservicevoiceaugloop").then(n.bind(n,51741)).then((e=>e.MicrophoneUtilityService.getInstance(V?.alSession)));return Promise.resolve(e)},vt=async()=>{const e=await Promise.all([n.e("editor"),n.e("augloop-chunk"),n.e("office-iss"),n.e("vendors~shared"),n.e("vendors~sccserviceciq"),n.e("sccserviceciq")]).then(n.bind(n,40308)).then((e=>e.EditorServiceImplementation.getInstance()));return _e(e),Promise.resolve(e)},Ct={elaboratePromptActionsAvailable:Pe,setElaboratePromptActionsState:Te,disabledElaborate:!1},[bt,Et]=c.useState({chatInputRef:Ue,controlRef:Ve,isDisabled:je,languageSupportsSpace:Re,maxInputCharLimit:k,placeholderText:F,voiceInputProps:V,getMicrophoneService:()=>Promise.resolve(null)}),[At,St]=c.useState({controlRef:Ve,isEccMenuShown:De,getEditorService:vt}),It=c.useCallback((()=>{Fe(!0)}),[]),Pt=c.useCallback((()=>{Fe(!1)}),[]),Tt=function({editorService:e,editorProps:t,controlRef:n,entityRef:o,setElaboratePromptActionsState:r}){wi.createInstance(t?.editorConfig?.telemLogger);const i=wi.getInstance(),a=ru({entityRef:o,imperativeControlRef:n,editorService:e,telemetryLogger:i,featureFlags:t?.editorConfig?.featureFlags,setElaboratePromptActionsState:r}),s=I.IB.useHydratedEntityPlugin();return t?.editorConfig?.featureFlags?.enableHydratedEntities?a:s}({controlRef:Ve,editorProps:d,entityRef:Ne,editorService:ke,setElaboratePromptActionsState:Te});c.useImperativeHandle(t,(()=>({addImage:e=>{r.isAttachmentListEnabled?dt?.updateImageAttachmentData(e):at((t=>[...t,{dataUri:e,id:rt.current++}]))},removeImages:()=>{r.isAttachmentListEnabled?dt?.removeImages():at([])},getImages:()=>r.isAttachmentListEnabled?dt?.getImages().map((e=>e.data.dataUri)):it.map((e=>e.dataUri)),setInputText:e=>{Ve.current?.setInputText(e)},updateInputText:(e,t)=>{switch(t){case Ni.v.InsertAtCursor:e!==io.O8||Re.current||Ve.current?.insertTextAtCursor(io.Gs),Ve.current?.insertTextAtCursor(e);break;case Ni.v.Replace:Ve.current?.setInputText(e)}},getInputText:()=>Ve.current?.getInputText().replace("",""),getInputSpanElement:()=>Ue.current,setGhostText:e=>{},getGhostText:()=>Ot.current?.getGhostText(),setFocus:()=>{Ue.current?.focus()},closeMenu:()=>{T&&ye&&ve(!1),x&&Ce&&be(!1),Rt&&Mt.current&&Nt(!1)},getCIQTextRef:()=>{},getChatEditorService:()=>ke,getCIQResponseHandler:()=>_t,getRawCanvasSelections:()=>Je(),updateAttachmentList:e=>Xe(e),setMenuButtonFocus:()=>{},updateDraftForEntity:e=>{Tt.updateDraftForEntity(e)}})));const[xt,wt]=c.useState({isDisabled:S,setIsDisabled:P,elaboratePromptProps:Ct});c.useEffect((()=>{Ie(F)}),[F]),c.useEffect((()=>{Oe.current&&Be.current?.setTarget(Oe.current)}),[Be,Oe]);const kt=function(){const e=(0,Hi.eO)();return{ChatInputMessages:Zi,service:c.useMemo((()=>new Ki(e)),[e])}}(),{sccCiqResponseHandler:_t,ciqPluginParams:Dt,cloudFileNode:Ft}=Ps({chatInputRef:Ue,controlRef:Ve,entityRef:Ne,editorProps:{...d,onOpen:It,onClose:Pt},getEditorService:vt,ciqQueryCharacter:io.O8,isDarkMode:A,isDisabled:S,setAtMentionApp:ue,insertCiqTriggerPluginRef:He,inputMessagesNodes:kt,shouldInitializeCIQ:he,localFilesNode:r.isLocalFileUploadEnabled?pt:ht}),{getMicrophoneTooltipText:Lt,ghostTextRef:Ot,handleVoiceInChatInput:Rt,isMicrophoneActive:Mt,microphoneProps:Bt,setMicrophoneListeningStatus:Nt}=Ds({chatInputRef:Ue,controlRef:Ve,handleChatInputLoad:g,isDisabled:je,languageSupportsSpace:Re,maxInputCharLimit:k,placeholderText:F,voiceInputProps:V}),Vt=Qc({...bt},{...xt},{...Dt},Ne,Ft,kt,Tt,pt,{...At},!pe&&r.isAttachmentHintEnabled,dt?.removeImage,fe,Ze,e.isGPTCopilotSelected);c.useEffect((()=>{const e=r.enableButtonHidingWithAtMention&&!!ce||S;V?.alSession&&r.isSccVoiceEnabled&&Et({chatInputRef:Ue,controlRef:Ve,isDisabled:e,languageSupportsSpace:Re,maxInputCharLimit:k,placeholderText:F,voiceInputProps:V,getMicrophoneService:yt})}),[V?.alSession,ce,S]),c.useEffect((()=>{const e=r.enableButtonHidingWithAtMention&&!!ce||S;r.isSccElaboratePromptEnabled&&wt({isDisabled:e,setIsDisabled:P,elaboratePromptProps:Ct})}),[S,ce]);c.useEffect((()=>{if(r.isSccPromptSuggestionsEnabled){St({controlRef:Ve,isEccMenuShown:De,getEditorService:vt})}}),[Ve,De]);const Ht=c.useCallback(((e,t)=>{Me.current&&(f(),Me.current=!1),me.current&&r.isQueryWarmupSignalEnabled&&(me.current=!1,de?.());const{value:n}=t;we(!n||""===n.trim()),q?.(e,t)}),[f,q]),Ut=c.useCallback((async()=>{et()}),[]),jt=c.useCallback((e=>{tt(e)}),[]);c.useEffect((()=>(m&&m(),()=>{y&&y()})),[m,y]),c.useEffect((()=>{r.isFocusChatInputOnMount&&Ue.current?.focus()}),[]);const{onChatInputTokenAdded:zt,onChatInputTokenDeleted:Gt}=(e=>{const{hvcPromptStringsList:t,editorService:n,onChatInputHVCPromptUpdated:o}=e,r=(e,t)=>{if(t)return t.find((t=>t.tokenPhrases.some((t=>t===e))))};return{onChatInputTokenAdded:c.useCallback((e=>{const i=r(e,t);i&&(i.ciqEntity||i.unSupportedEntities)&&n&&(i.ciqEntity&&n.setEntityScope(i.ciqEntity),i.unSupportedEntities&&(Kc.log("setUnsupportedEntities"),n.setUnsupportedEntities(i.unSupportedEntities))),o&&o(e,!0)}),[t,o,n]),onChatInputTokenDeleted:c.useCallback((e=>{const i=r(e,t);i&&(i.ciqEntity||i.unSupportedEntities)&&n&&(i.ciqEntity&&(Kc.log("reset CurrentScope"),n.setEntityScope(i.ciqEntity)),i.unSupportedEntities&&(Kc.log("clear unSupportedEntities"),n.setUnsupportedEntities([]))),o&&o(e,!1)}),[t,o,n])}})({hvcPromptStringsList:U,editorService:ke,onChatInputHVCPromptUpdated:z}),Wt=(()=>{const e=(0,Gn.Y$)().isRealtimeVoiceEnabled,{modality:t}=(0,ti.f)();return!!e&&t===ni.S.Chat})();return{isDisabled:S,isImageInputMenuButtonEnabled:K,isScreenshotButtonEnabled:re,isSelectionButtonEnabled:i&&!r.isAttachmentListEnabled,getScreenshot:ie,isGroundingSourcePickerEnabled:!x&&void 0!==h,isPromptGuideMenuButtonEnabled:T&&void 0!==R,isCIQButtonEnabled:b,isAtMentionButtonEnabled:E,isGroundingButtonEnabled:x&&void 0!==p,isChatFooterDividerEnabled:T&&void 0!==R||b||E||x,isVoiceInputEnabled:void 0!==V,isRealtimeVoiceInputEnabled:Wt,themeWrapper:{isDarkMode:A,themePalette:u},chatInputContainer:{id:io.RD,ref:Oe},groundingSourcePicker:{...h,isChatInputV3Enabled:!0,isChatInputBannerVisible:void 0!==H,isDisabled:!h?.alwaysEnable&&S,onSelection:e=>{Ie(e.placeholderText),h?.onSelection?.(e)}},chatInputBannerProps:H?{...H,isInputV3Enabled:!0}:void 0,chatInputContainerTooltip:{content:a,onVisibleChange:(e,t)=>{e&&"focus"===e.type?Ae(!1):Ae(t.visible)},positioning:"above",relationship:"label",visible:Ee,withArrow:!0},promptGuideMenuButton:{isDisabled:je,isMenuOpen:ye,setMenuOpen:ve,positioningRef:Be,promptGuideMenuProps:R,title:_},ciqButton:{handleClick:()=>{Ve.current?.insertTextAtCursor("/"),Ot.current?.setGhostText(io.u1)},isDisabled:je,title:s},atMentionButton:{handleClick:()=>{le?.logSuccessTelemetry&&le.logSuccessTelemetry(Bi.AtMentionButtonClicked,"@");let e=Ve.current?.getInputText();e?.endsWith(" @")?e=e.slice(0,-2):e?.endsWith("@")&&(e=e.slice(0,-1)),void 0!==e&&Ve.current?.setInputText(e),He?.current?.insertCiqTrigger("@")},isDisabled:je,title:l},groundingButton:{isDisabled:je,isMenuOpen:Ce,groundingButtonPluginProps:p,setMenuOpen:be,shouldBlockGroundingButtonClick:M,targetRef:Oe.current,title:r?.useUpdatedGroundingButtonTitle?o.updatedGroundingButtonTitle():o.defaultGroundingButtonTitle()},chatFooterDivider:{appearance:"strong",vertical:!0},voiceInputTooltip:{content:Lt(),positioning:"above",relationship:"label",withArrow:!0},ariaLiveSpan:{"aria-live":"assertive",role:"alert"},microphoneButton:{"aria-live":"assertive",isDisabled:je,microphoneButtonProps:Bt},addSelectionButton:{selections:Ke,handleAddSelectionClick:()=>{$e(),at([])}},insertImageButton:{isDisabled:je,insertImageProps:r.isAttachmentListEnabled?dt?.insertImageButtonProps:ct},screenshotButton:{isDisabled:je,screenshotProps:r.isAttachmentListEnabled?dt?.screenshotButtonProps:ut},chatInputProps:{actions:{ref:Le},className:D?.userInput,customNodes:[Di.iH,Fi.Ag,Li.Ho,...ae||[]],disableSend:S||w||xe||Qe?.isFileUploadInProgress,disabled:S,editor:{input:{"aria-label":"Prompt"}},maxLength:k,onChange:Ht,onInput:v,onPaste:r.isAttachmentListEnabled?dt?.handlePaste:st,onSubmit:e=>{if(B?.())return;kt?.service?.clearAllMessages(),Qe?.setLocalFilesEntities([]),ot(void 0),i?qe.setAttachments(qe.attachments?.filter((e=>e.data?.entityElement?.entityType===fu))):Ge([]),e.stopPropagation(),Rt&&Nt(!1);const t=Ve.current?.getInputText()?.replace("","").trim();if(void 0!==t&&t.trimStart()!==io.u1&&!S){const e=Ve.current?_t?.generateQueryAnnotations(Ue.current):void 0,n=Ne.current?.getActiveEntities();C(t,e,n),Ve.current?.setInputText(io.u1),Ot.current?.cancelGhostText()}},onFocus:Ut,onBlur:jt,placeholderValue:pe?L:Se,ref:Ue,send:{title:N},attachments:mt,errorMessage:r.isAttachmentListEnabled?dt?.error||nt:lt,appearance:r.isSimplifiedChatInputEnabled?"responsive":"multi",characterLimitErrorMessage:G,children:c.createElement(c.Fragment,null,c.createElement(Oi.J,{ref:Ve}),c.createElement(Ri.a,{id:"voiceInputGhostText",ref:Ot}),j?c.createElement(pu,{languageSupportsSpace:Re,tokenListPhrases:U,useSortedTokenList:W,onChatInputTokenAdded:zt,onChatInputTokenDeleted:Gt}):void 0,se)},isSccVoiceEnabled:r.isSccVoiceEnabled,serviceProvider:Vt,attachmentContext:r.isAttachmentListEnabled?qe:void 0,localFileContext:r.isLocalFileUploadEnabled?Qe:void 0,inputContext:We,isLocalFilesEnabled:r.isLocalFileUploadEnabled&&r.isDragDropWrapperEnabled}};var yu=n(83318);const vu={chatInputOuterContainer:{...de.Pt.borderRadius(G.L.borderRadiusXLarge),...de.Pt.margin(0,`${yu.nT}`,"16px"),backgroundColor:"transparent",width:"-webkit-fill-available"},chatInputContainer:{color:G.L.colorNeutralForeground1,position:"relative",zIndex:"1",...de.Pt.margin(0,"auto"),maxWidth:yu.tu,minWidth:yu.Z$},faiChatInputWithGrounding:{borderTopLeftRadius:0,borderTopRightRadius:0}},Cu=(0,x.n)(vu),bu=c.forwardRef(((e,t)=>{const n=mu(e,t);return(e=>{const t=Cu(),{isDisabled:n,overrideStyles:o,isGroundingSourcePickerEnabled:r,chatInputBannerProps:i}=e;e.themeWrapper.className=(0,T.z)(t.chatInputOuterContainer,!n&&o?.chatInputOuterContainer,e.themeWrapper.className),e.chatInputContainer.className=(0,T.z)(t.chatInputContainer,!n&&o?.chatInput,e.chatInputContainer.className),e.chatInputProps.className=(0,T.z)((r||i)&&t.faiChatInputWithGrounding,e.chatInputProps.className),e.ariaLiveSpan.className=(0,T.z)(!n&&o?.ariaLiveSpan,e.ariaLiveSpan.className)})(n),(e=>{const{ariaLiveSpan:t,chatFooterDivider:n,chatInputContainer:o,isImageInputMenuButtonEnabled:r,isScreenshotButtonEnabled:i,atMentionButton:a,ciqButton:s,chatInputProps:l,groundingButton:u,groundingSourcePicker:d,isCIQButtonEnabled:p,isAtMentionButtonEnabled:h,isChatFooterDividerEnabled:g,isGroundingButtonEnabled:f,isGroundingSourcePickerEnabled:m,isPromptGuideMenuButtonEnabled:y,isVoiceInputEnabled:v,microphoneButton:C,insertImageButton:b,screenshotButton:E,promptGuideMenuButton:A,addSelectionButton:S,themeWrapper:P,voiceInputTooltip:T,chatInputBannerProps:x,serviceProvider:w,attachmentContext:_,localFileContext:D,inputContext:F,isSccVoiceEnabled:L,isSelectionButtonEnabled:O,isLocalFilesEnabled:R,isRealtimeVoiceInputEnabled:M}=e,B=D?.isFileUploadInProgress??!1,N=c.createElement(k,{...{...l,actions:{...l.actions,children:c.createElement("span",{style:{display:"flex",alignItems:"center"}},O&&c.createElement(q,{...S}),r&&c.createElement(zr,{...b}),i&&c.createElement(Wr,{...E}),y&&c.createElement(ei,{...A,isDisabled:A.isDisabled||B}),h&&c.createElement(X,{...a}),p&&c.createElement(ht,{...s}),f&&c.createElement(Zo,{...u}),g&&c.createElement(H.c,{...n}),v&&!L&&T&&c.createElement(U.m,{...T},c.createElement("span",{...t},c.createElement(Ti,{...C}))),M&&c.createElement(ii,null))}}}),j=R?c.createElement(V,null,N):N;return c.createElement(ro,{...P},c.createElement("div",{...o},x&&c.createElement(dt,{...x}),m&&c.createElement(vr,{...d}),c.createElement(I.N2,{serviceProvider:w,inputContext:F,getSharedCopilotLogger:()=>wi.getInstance(),attachmentContext:_,localFileContext:D},j)))})(n)}));bu.displayName="ChatInput";const Eu=c.memo(bu);var Au=n(88027),Su=n(41519),Iu=n(26532),Pu=n(59777),Tu=n(6863),xu=n(38292),wu=n(44676),ku=n(19016),_u=n(35373),Du=n(2471),Fu=n(81617),Lu=n(23372),Ou=n(8616);const Ru={useLazyLoadQuery:(e,t,n)=>({data:(0,Ou.useLazyLoadQuery)(e,t,n),error:void 0}),useFragment:Ou.useFragment,usePaginationFragment:Ou.usePaginationFragment,useRefetchableFragment:Ou.useRefetchableFragment,useSubscription:Ou.useSubscription,useMutation:e=>{const[t,n]=(0,Ou.useMutation)(e);return[({variables:e,optimisticResponse:n,onCompleted:o,context:r})=>{const i="object"==typeof n&&null!=n?n:void 0;return new Promise((n=>{t({variables:e,optimisticResponse:i,onCompleted:(e,t)=>{var r;null==o||o(e),n({errors:null!==(r=null==t?void 0:t.map((e=>new Error(e.message))))&&void 0!==r?r:void 0,data:e})},onError:e=>{n({errors:[e],data:void 0})}})}))},n]}},Mu=({children:e,environment:t,novaEventHandler:n})=>c.createElement(ja.RelayEnvironmentProvider,{environment:t},c.createElement(Du.X,{graphql:Ru},c.createElement(Fu.sU,{eventing:n,reactEventMapper:Lu.u},e)));var Bu=n(69471),Nu=(n(49319),n(89812));const Vu=e=>{let t={metadata:e};return{setContext:e=>(t={...t,...e},t),getContext:()=>t}};function Hu(e){return{...e,data:e.data??e.items?.[0]??void 0,errors:(e.errors??[]).map((e=>({message:e.message,locations:e.locations?.slice()})))}}var Uu=n(58651);function ju(e){const t=Promise.resolve().then(n.bind(n,49319)).then((t=>t.createApolloLinks(e))),o=(r=t,(e,t,n)=>{const o=Vu(n.metadata);if(!e.text)return Bu.Observable.from({errors:[{message:"No operation text provided",locations:[]}]});const i=(0,Nu.qg)(e.text);return Bu.Observable.from(r).mergeMap((n=>Bu.Observable.from(i).mergeMap((r=>{const i=n.request({operationName:e.name,query:r,variables:t,setContext:o.setContext,getContext:o.getContext,extensions:{}});return i?Bu.Observable.create((e=>i.subscribe({next:e.next,error:e.error,complete:e.complete}))).map((e=>"incremental"in e&&e.incremental?e.incremental.map((e=>Hu(e))):Hu(e))):Bu.Observable.from({errors:[{message:"Apollo link request returned null",locations:[]}]})}))))});var r;return new Bu.Environment({store:zu(),network:Bu.Network.create(o),relayFieldLogger:e=>{"relay_resolver.error"===e.kind&&Uu.error(`Error ${e.owner}.${e.fieldPath}`,e.error)}})}function zu(){return Bu.RelayFeatureFlags.ENABLE_RELAY_RESOLVERS=!0,new Bu.Store(new Bu.RecordSource)}var Gu=n(58651);const Wu=({children:e,sessionId:t,getAuthToken:n,hostAppRing:o,accountUpn:r,locale:i,useExtendedExperimentalTimeout:a=!1})=>{const s=c.useMemo((()=>{const e=t??(0,mt.DA)();return ju({getAuthToken:n,clientCorrelationId:e,hostAppRing:o,accountUpn:r,locale:i,useExtendedExperimentalTimeout:a})}),[i,t,n,o]),l={bubble:({event:e})=>(Gu.log("bubble",e),Promise.resolve())};return c.createElement(Mu,{environment:s,novaEventHandler:l},e)},qu=({children:e})=>{const{hostAppSettings:t,hostAppAuthToken:n}=(0,Cr.Mb)();if(!n?.lokiTokenProvider)throw new Error("Loki Token not found. This is required to create Relay Environment");return c.createElement(Wu,{sessionId:t.sessionId,getAuthToken:n.lokiTokenProvider,hostAppRing:t.environment,locale:t.locale,hostAppPlatform:t.platform},e)};var Qu=n(94241),Ku=n(6394),Yu=n(45779),$u=n(17100);let Ju=null;const Xu=c.forwardRef((function(e,t){const o=function(){const[e,t]=c.useState(null);return c.useEffect((()=>{Ju||(Ju=Promise.all([n.e("augloop-chunk"),n.e("vendors~shared"),n.e("vendors~copilotchatdisplay")]).then(n.bind(n,15368)).then((e=>e.CopilotChatDisplay))),Ju.then((e=>{t(e)}))}),[]),e}();return o?c.createElement(o,{ref:t,...e}):c.createElement(Tu.A,{className:e.shimmerClassName})})),Zu=c.memo(Xu),ed=c.lazy((()=>Promise.all([n.e("augloop-chunk"),n.e("vendors~shared"),n.e("vendors~copilotchatdisplay")]).then(n.bind(n,15368)).then((e=>({default:e.CopilotChatDisplay}))))),td=c.lazy((()=>Promise.all([n.e("augloop-chunk"),n.e("vendors~shared")]).then(n.bind(n,60886)).then((e=>({default:e.VoicePage})))));let nd=null,od=null,rd=null,id=null,ad=null,sd="",ld="",cd=0;const ud=c.forwardRef((({style:e,platformType:t,environment:n=C.O.None,copilotCommunicationHandler:d,copilotTelemetryHandler:p,theme:h=ku.zQ,themeV2:f,useALRuntime:m,chatUiProps:S,basicChatProps:I,debugProps:P,copilotPluginProps:T,overrideChatInputControl:x,copilotFeatureFlags:w,sketchImageProps:k,hostTokenProviders:_,inlineCreationHVCAppConfig:D,hostAppAuthTokens:F,switcherMenuProps:L,getHeaderElement:O,wasChatPaneAutoOpened:R},M)=>{(0,o.jD)(n);const B=(0,E.NZ)(),N=(0,E.UN)(),V=(0,Gn.dg)(w),H=(0,Cr.Hz)(function(){const e=c.useMemo((()=>(0,_u.ox)(d,F)),[F]);return e}());void 0!==f?(0,E.nJ)(N,e):(0,E.nJ)(B,e),(0,Au._X)(void 0!==f),ad=xu.A.getInstance(d);const U=c.useRef(),[j,z]=c.useState(h),[G,W]=c.useState(f),[q,Q]=c.useState(!1),[K,Y]=c.useState(!1),[$,J]=c.useState(!1),[X,Z]=c.useState(!1),[ee,te]=c.useState(void 0!==S.freUiProps),[ne,oe]=c.useState(!1),[re,ie]=c.useState(void 0),[ae,se]=c.useState(void 0),[le,ce]=c.useState(!1),[ue,de]=c.useState(!1),[pe,he]=c.useState(c.createElement(c.Fragment,null)),[ge,fe]=c.useState(!1),[me,ye]=c.useState(!1),[ve,Ce]=c.useState([]),[be,Ee]=c.useState(!1),Ae=c.useRef(void 0),Se=c.useRef(!0),Ie=c.useRef(void 0),Pe=(e,t)=>{oe(t.open);const n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};ad.sendLoggingEventToClient(Pu.Yk.CopilotSwitcherMenuStateChange,n)},Te=T?.copilotList.find((e=>e.isDefaultCopilot))?.id,xe=T?.copilotList.find((e=>e.isSelected))?.id,we=T&&T.copilotList.length>1,ke=(0,wu.B9)({colorLoadingFlair1:j.themeLight,colorLoadingFlair2:j.themeDarkAlt,colorLoadingFlair3:j.themeLighterAlt,colorLoadingFlair4:j.themeLighter}),_e={colorBrandFlair1:j.themeDarkAlt,colorBrandFlair2:j.themeLighterAlt,colorBrandFlair3:j.themeLighter,colorBrandFlair1Transparent:j.themeDarkAltTransparent,colorBrandFlair2Transparent:j.themeLighterAltTransparent,colorBrandFlair3Transparent:j.themeLighterTransparent,chatLoadColorBrandFlair1:ke.colorLoadingFlair1,chatLoadColorBrandFlair2:ke.colorLoadingFlair2,chatLoadColorBrandFlair3:ke.colorLoadingFlair3,chatLoadColorBrandFlair4:ke.colorLoadingFlair4};(f??h).isDarkModeEnabled?(0,Au.N_)(Su.G.defaultBlack):(0,Au.N_)(Su.G.defaultWhite),nd=y.getInstance(),od=u.E.getInstance();const De=S.chatInputV2Props;c.useEffect((()=>{L?.setAtMentionApp&&L.setAtMentionApp(ae)}),[ae]),c.useEffect((()=>{const e=!!ae||(0,$u.iB)(L?.currentSelectedGPTId);le!==e&&ce(e)}),[ae,L?.currentSelectedGPTId]),c.useEffect((()=>()=>{xu.A.resetInstance(),pd()}),[]),c.useEffect((()=>{const e=f??h;e.isDarkModeEnabled?(0,Au.N_)(Su.G.defaultBlack):(0,Au.N_)(Su.G.defaultWhite),e.isHighContrastModeEnabled?(0,Au.uj)(!0):(0,Au.uj)(!1),z(h),W(f)}),[h,f]),c.useEffect((()=>{if(xe&&Te&&xe!==Te){const e=T?.copilotList.find((e=>e.id===xe));e&&e.copilotComponent&&he(e.copilotComponent)}}),[T?.copilotList,Te,xe]);const Fe=Iu.j.getInstance(),Le=S.chatInputProps??S.chatInputV2Props;De&&Le===De&&(De.shouldInitializeEditorInChatInput=!0,De.voiceInputProps&&(De.voiceInputProps.handleInChatInput=!0));const[Oe,Re]=c.useState(new A.c(U,function(e){return Object.keys(e).filter((e=>"themeBackground"!==e)).reduce(((t,n)=>Object.assign(t,{[n]:e[n]})),{})}(j),(G||j).isDarkModeEnabled,(G||j).dir??void 0,!1,Z,!1,ee,te,d,De?.menuProps,fd,md,v.u1,v.u1,de,null,De?.chatPlaceholderMessage,De?.chatRestShyPlaceholderMessage,void 0,De?.buttonProps?.ciqButtonEnabled,De?.buttonProps?.groundingButtonEnabled,De?.buttonProps?.menuButtonEnabled,void 0,void 0,(e=>(q||Q(!0),Fe.sendTelemetryChatEventData([{key:g.h3.ChatEventType,value:g.a5.ChatPaneLoadMessageBarShown},{key:g.h3.ChatEventParameters,value:e.toString()}]),!0)),void 0,void 0,se,ae,Ae,Se,Ie));function Me(e){id=e}function Be(e){sd=e}function Ne(e){ld=e}function Ve(e){cd=e}c.useEffect((()=>{X&&$&&(Y(!1),J(!1))}),[Oe]);const He=(e,t)=>{e&&Re(e),t&&Ce(t)},{tipCardProps:Ue}=S,je=()=>{const e=O?.();return e?c.createElement("div",{className:B.headerElement},e):c.createElement(c.Fragment,null)};const{modality:ze}=(0,ti.f)(),Ge=V.isRealtimeVoiceEnabled&&ze===ni.S.RealtimeVoice,We=e=>c.createElement(b.L,{theme:G||j,shouldUseFluentV9Tokens:void 0!==G,dir:G?G.dir:j.dir},e),qe=()=>Ge?(V.isRealtimeVoiceChatHistoryEnabled&&Ku.c.chatSessionId&&(Qu.i.chatSessionId=Ku.c.chatSessionId),We(c.createElement(c.Suspense,{fallback:c.createElement(Tu.A,{className:""})},c.createElement(r.W,{style:B.voicePageContainer},c.createElement(td,{communicationHandler:d,options:{playerVersion:V.realtimeVoicePlayerVersion,clientVersion:V.realtimeVoiceClientVersion}}))))):T&&T.showCopilotSwitcherMenu&&!T.paneSilhouetteHeaderProps&&we&&xe&&Te&&xe!==Te?We(c.createElement(r.W,{style:be?B.chatUiStackZoom:B.chatUiStack},c.createElement(i.V,{isMenuOpen:ne,onMenuStateChange:Pe,handleCopilotChatChange:T.handleCopilotChatChange,copilotList:T.copilotList}),je(),c.createElement(a.K,{componentToRender:pe}))):We(c.createElement(r.W,{style:be?B.chatUiStackZoom:B.chatUiStack},T&&T.showCopilotSwitcherMenu&&!T.paneSilhouetteHeaderProps&&we&&c.createElement(i.V,{isMenuOpen:ne,onMenuStateChange:Pe,handleCopilotChatChange:T.handleCopilotChatChange,copilotList:T.copilotList}),je(),V.avoidReactSuspenseForCopilotChatDisplay?c.createElement(Zu,{shimmerClassName:be?B.shimmerUiZoom:B.shimmerUi,chatInputControlMounted:ue,setChatInputControlMounted:de,onRender:He,onQuerySubmit:Me,isFreVisible:ee,setFreVisible:te,isDisabled:X,setIsDisabled:Z,isExecuting:ge,setIsExecuting:fe,copilotChatTheme:j,copilotChatThemeV2:G,updateChangeTopicButtonClickedStatus:yd,setTipCardShown:ye,updateUserQueryGuid:Be,updateUserQuery:Ne,updateUserQueryOrder:Ve,setChatInputBannerProps:ie,setAtMentionApp:se,atMentionApp:ae,isPaneLoadMessageVisible:q,setPaneLoadMessageVisible:Q,inputRef:U,copilotCommunicationHandler:d,style:e,platformType:t,environment:n,theme:h,themeV2:f,useALRuntime:m,ref:M,chatUiProps:S,basicChatProps:I,copilotTelemetryHandler:p,debugProps:P,copilotPluginProps:T,isChatHistoryPanelShown:K,setIsChatHistoryPanelShown:Y,chatContainerZoomedIn:be,setChatContainerZoomedIn:Ee,hideChatHistoryPanelAfterInputDisabled:$,setHideChatHistoryPanelAfterInputDisabled:J,sketchImageProps:k,warmUpQueryIdRef:Ae,isStartOfQueryRef:Se,hostTokenProviders:_,inlineCreationHVCAppConfig:D,pluginDataProviderRef:Ie,switcherMenuProps:L,wasChatPaneAutoOpened:R}):c.createElement(c.Suspense,{fallback:c.createElement(Tu.A,{className:be?B.shimmerUiZoom:B.shimmerUi})},c.createElement(ed,{chatInputControlMounted:ue,setChatInputControlMounted:de,onRender:He,onQuerySubmit:Me,isFreVisible:ee,setFreVisible:te,isDisabled:X,setIsDisabled:Z,isExecuting:ge,setIsExecuting:fe,copilotChatTheme:j,copilotChatThemeV2:G,updateChangeTopicButtonClickedStatus:yd,setTipCardShown:ye,updateUserQueryGuid:Be,updateUserQuery:Ne,updateUserQueryOrder:Ve,setChatInputBannerProps:ie,setAtMentionApp:se,atMentionApp:ae,isPaneLoadMessageVisible:q,setPaneLoadMessageVisible:Q,inputRef:U,copilotCommunicationHandler:d,style:e,platformType:t,environment:n,theme:h,themeV2:f,useALRuntime:m,ref:M,chatUiProps:S,basicChatProps:I,copilotTelemetryHandler:p,debugProps:P,copilotPluginProps:T,isChatHistoryPanelShown:K,setIsChatHistoryPanelShown:Y,chatContainerZoomedIn:be,setChatContainerZoomedIn:Ee,hideChatHistoryPanelAfterInputDisabled:$,setHideChatHistoryPanelAfterInputDisabled:J,sketchImageProps:k,warmUpQueryIdRef:Ae,isStartOfQueryRef:Se,hostTokenProviders:_,inlineCreationHVCAppConfig:D,pluginDataProviderRef:Ie,switcherMenuProps:L,wasChatPaneAutoOpened:R})),!K&&c.createElement(c.Fragment,null,me&&c.createElement(s.A,{...Ue}),x?x(U,Oe.getProps(ve,re,t===l.Y.IOS,le)):c.createElement(Eu,{ref:U,...Oe.getProps(ve,re,t===l.Y.IOS,le)}))));return c.createElement(Gn.ZJ.Provider,{value:V},c.createElement(wu.Od.Provider,{value:ke},c.createElement(Cr.Hv.Provider,{value:H},V.isUXRefreshEnabled?c.createElement(Yu.Wr,{customStyleHooks:E.fJ,themeExtension:_e,mode:V.isOutputV2Enabled?S.copilotModeOverride?.mode??"sidecar":void 0},c.createElement(qu,null,qe())):c.createElement(qu,null,qe()))))}));let dd=!1;const pd=()=>{nd=null,od=null,rd=null,id=null,dd=!1};ud.displayName=v.MS;const hd=e=>((new Date).getTime()-(e??rd))/1e3,gd=e=>(new Date).getTime()-(e??rd);function fd(e){(0,_u.cY)(e)}function md(e){return(0,_u.cY)(e),null}const yd=e=>{dd=e}},6863:(e,t,n)=>{n.d(t,{A:()=>c});var o=n(87354),r=n(71961),i=n(8520),a=n(18023),s=n(89994),l=n(49118);const c=e=>{const{className:t}=e,n=(0,a.NZ)();return i.createElement(l.W,{style:t},i.createElement(o.E,null,i.createElement("div",{className:n.incomingShimmerCardWrapper},i.createElement("div",{className:n.incomingShimmerCard},i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}))),i.createElement("div",{className:n.outgoingShimmerCardWrapper},i.createElement("div",{className:n.outgoingShimmerCard},i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_}),i.createElement(r.H,{size:s.z_})))))}},18023:(e,t,n)=>{n.d(t,{NZ:()=>m,UN:()=>y,fJ:()=>f,nJ:()=>v});var o=n(92782),r=n(16895),i=n(62653),a=n(658),s=n(30112),l=n(19016),c=n(91848),u=n(83318);const d=(0,o.Q)(l.zQ),p={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:"transparent"},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:"transparent"},shimmerUi:{...r.Pt.margin("5px","auto","auto","auto"),maxWidth:u.tu,minWidth:u.Z$,width:"100%",overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth","::-webkit-scrollbar":{backgroundColor:d.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:d.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",d.colorNeutralBackground2Hover),":hover":{backgroundColor:d.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:d.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},shimmerUiZoom:{...r.Pt.margin("5px","auto","auto","auto"),maxWidth:u.tu,minWidth:u.Z$,width:"100%",overflowWrap:"break-word","::-webkit-scrollbar":{backgroundColor:d.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:d.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",d.colorNeutralBackground2Hover),":hover":{backgroundColor:d.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:d.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},chatFreStack:{...r.Pt.padding(0,u.nT),overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth","::-webkit-scrollbar":{backgroundColor:d.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:d.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",d.colorNeutralBackground2Hover),":hover":{backgroundColor:d.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:d.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},chatFreStackZoom:{...r.Pt.padding(0,u.nT),overflowWrap:"break-word","::-webkit-scrollbar":{backgroundColor:d.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:d.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",d.colorNeutralBackground2Hover),":hover":{backgroundColor:d.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:d.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},chatFreStackContainer:{...r.Pt.margin("5px","auto"),maxWidth:u.tu,minWidth:u.Z$,width:"100%",height:"100%"},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:"transparent"},headerElement:{margin:"5px 16px",position:"sticky",top:0},incomingShimmerCard:{alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative",...r.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...r.Pt.margin("10px")},outgoingShimmerCard:{alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative",...r.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...r.Pt.margin("10px","20px","0px","10px")},incomingShimmerCardWrapper:{...r.Pt.borderRadius("8px"),...r.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...r.Pt.margin("4px","16px","16px","48px"),justifyContent:"flex-end",height:"68px",backgroundColor:d.colorNeutralBackground1,opacity:"0.6"},outgoingShimmerCardWrapper:{...r.Pt.borderRadius("8px"),...r.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...r.Pt.margin(0,"16px"),height:"124px",backgroundColor:d.colorNeutralBackground1,opacity:"0.8"},voicePageContainer:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:d.colorTransparentBackground}},h={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:i.L.colorTransparentBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:i.L.colorTransparentBackground},shimmerUi:{...r.Pt.margin("5px","auto","auto","auto"),maxWidth:u.tu,minWidth:u.Z$,width:"100%",overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth","::-webkit-scrollbar":{backgroundColor:i.L.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:i.L.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",i.L.colorNeutralBackground2Hover),":hover":{backgroundColor:i.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:i.L.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},shimmerUiZoom:{...r.Pt.margin("5px","auto","auto","auto"),maxWidth:u.tu,minWidth:u.Z$,width:"100%",overflowWrap:"break-word","::-webkit-scrollbar":{backgroundColor:i.L.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:i.L.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",i.L.colorNeutralBackground2Hover),":hover":{backgroundColor:i.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:i.L.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},chatFreStack:{...r.Pt.padding(0,u.nT),overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth","::-webkit-scrollbar":{backgroundColor:i.L.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:i.L.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",i.L.colorNeutralBackground2Hover),":hover":{backgroundColor:i.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:i.L.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},chatFreStackZoom:{...r.Pt.padding(0,u.nT),overflowWrap:"break-word","::-webkit-scrollbar":{backgroundColor:i.L.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:i.L.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",i.L.colorNeutralBackground2Hover),":hover":{backgroundColor:i.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:i.L.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},chatFreStackContainer:{...r.Pt.margin("5px","auto","auto","auto"),maxWidth:u.tu,minWidth:u.Z$,width:"100%",height:"100%"},spinner:{width:"100%",alignItems:"center",height:"100%",backgroundColor:i.L.colorNeutralBackground1},headerElement:{margin:"5px 16px",position:"sticky",top:0},incomingShimmerCard:{alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative",...r.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...r.Pt.margin("10px")},outgoingShimmerCard:{alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative",...r.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...r.Pt.margin("10px","20px","0px","10px")},incomingShimmerCardWrapper:{...r.Pt.borderRadius("8px"),...r.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...r.Pt.margin("4px","16px","16px","48px"),justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:i.L.colorNeutralBackground1},outgoingShimmerCardWrapper:{...r.Pt.borderRadius("8px"),...r.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...r.Pt.margin(0,"16px"),height:"124px",opacity:"0.8",backgroundColor:i.L.colorNeutralBackground1},voicePageContainer:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:i.L.colorTransparentBackground}},g=(0,a.n)({promptStarterRoot:{padding:`${i.L.spacingVerticalL} ${i.L.spacingHorizontalL}`,borderRadius:"12px",boxShadow:i.L.shadow2,rowGap:i.L.spacingVerticalS,columnGap:i.L.spacingVerticalSNudge,border:"none",":hover":{border:"none",boxShadow:i.L.shadow8},":active":{border:"none",boxShadow:i.L.shadow8},[`& .${c.S.icon}`]:{color:i.L.colorBrandForeground1}},promptStarterIconTitleAndPromptRoot:{gridTemplateAreas:'\n      "icon category"\n      "prompt prompt"\n    '}}),f={usePromptStarterStyles:e=>{const t=g(),n=e;n.root.className=(0,s.z)(n.root.className,t.promptStarterRoot,t.promptStarterIconTitleAndPromptRoot)}},m=(0,a.n)(p),y=(0,a.n)(h),v=(e,t)=>{if(t)for(const n in e)e[n]=(0,s.z)(e[n],t[n]);return e}},70737:(e,t,n)=>{n.d(t,{L:()=>l});var o=n(13922),r=n(93536),i=n(8520);const a=({children:e,...t})=>t.shouldUseV9Tokens?i.createElement(r.q,{theme:t.theme,dir:t.dir},e):i.createElement(i.Fragment,null,e);var s=n(35373);const l=e=>{if(!e.shouldUseFluentV9Tokens)return(0,s.cY)("Fluent V8 Custom Tokens enabled"),i.createElement(o.N,{theme:e.theme,dir:e.dir},e.children);if(e.shouldUseFluentV9Tokens&&e.theme)return(0,s.cY)("Fluent V9 supported tokens enabled"),i.createElement(a,{...c(e.theme,e.dir)},e.children);throw new Error("Exception: Please ensure a compatible V9 Theme is passed to the ThemeProvider")},c=(e,t=void 0)=>({shouldUseV9Tokens:!0,theme:e,dir:t})},72097:(e,t,n)=>{n.d(t,{BS:()=>f,X3:()=>y,Ys:()=>m,aM:()=>g,bS:()=>h,tX:()=>v});var o=n(18036),r=n(91834),i=n(35373),a=n(48082),s=n(35282),l=n(18491),c=n(26532),u=n(90922),d=n(10947);let p=[];const h=e=>{p=e.map((e=>e.PromptId))},g=(e,t)=>{t?p=p.filter((t=>t!==e)):f(e)||p.push(e)},f=e=>p.includes(e),m=async(e,t,n)=>{t(!0);try{let t,i=o.y.POST;if(e.isPromptSaved&&e.promptId)i=o.y.DELETE,t=(0,a.C)(o.p.UserPrompts,e.promptId,void 0,void 0,i);else if(!e.isPromptSaved&&e.promptText.length>0){const n={Title:e.promptTitle??"",CommandText:e.promptText??"",HydratedEntities:[]};t=(0,a.C)(o.p.UserPrompts,void 0,void 0,n)}if(t){await s.E.getInstance().submitOperation(t,r.x.getTypeName());const o=t?.items[0]?.body;o?.queryId&&(0,l.L)(o.queryId,{httpMethod:i,promptData:e,onSaveSuccess:n})}}catch(e){(0,i.cY)("Error in onSaveOrRemovePrompt: ",e)}finally{setTimeout((()=>{t(!1)}),500)}},y=async(e,t)=>{try{(0,i.cY)("onSharePrompt: ",e);const n={PromptId:e.promptId??"",Title:e.promptTitle??"",CommandText:e.promptText??"",HydratedEntities:[]},l=(0,a.C)(o.p.Link,void 0,void 0,n);await s.E.getInstance().submitOperation(l,r.x.getTypeName());const c=l?.items[0]?.body;c?.queryId&&(0,d.W6)(c.queryId,{onShareSuccess:t})}catch(e){(0,i.cY)("Error in onSharePrompt: ",e)}},v=()=>{const e=e=>c.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:e}]);return{logSaveClicked:()=>e(u.a5.CopilotLabPromptSaveClicked),logUnSaveClicked:()=>e(u.a5.CopilotLabPromptUnSaveClicked),logShareClicked:()=>e(u.a5.CopilotLabPromptShareClicked)}}},92445:(e,t,n)=>{let o;n.d(t,{J:()=>r});try{o=n(46835)}catch{}class r{constructor(){this.debugLogs=""}static initialize(){r.debugLogManager||(r.debugLogManager=new r)}static getInstance(){return r.debugLogManager}addLog(...e){const t=o?o.format(...e)+"\n":e.join(" ")+"\n";this.debugLogs+=t}getLogs(){return this.debugLogs}resetLogs(){this.debugLogs=""}}},35373:(e,t,n)=>{n.d(t,{ad:()=>q,s5:()=>Q,cY:()=>F,FI:()=>H,Kn:()=>ee,Ey:()=>N,ox:()=>Z,y6:()=>U,_W:()=>R,kX:()=>O,Nk:()=>X,cx:()=>M,xI:()=>L,uA:()=>B,zA:()=>K,UA:()=>z,Kx:()=>G,mG:()=>_,hX:()=>j,a9:()=>Y,k1:()=>$,J:()=>J,gE:()=>V,oc:()=>W,WT:()=>D});n(8520);var o=n(26731),r=n(28087),i=n(85558),a=n(90922),s=n(4801),l=n(33500),c=n(22330),u=n(48829),d=n(55161),p=n(79746);function h(){var e=g();return(0,p.A)(e,"OPR/")||(0,p.A)(e,"Opera")?"Opera":(0,p.A)(e,"PhantomJS")?"PhantomJS":(0,p.A)(e,"Edg")?"Edge":(0,p.A)(e,"Electron")?"Electron":(0,p.A)(e,"Chrome")?"Chrome":(0,p.A)(e,"Trident")?"MSIE":(0,p.A)(e,"Firefox")?"Firefox":(0,p.A)(e,"Safari")?"Safari":(0,p.A)(e,"SkypeShell")?"SkypeShell":"Unknown"}var g=function(){var e;return null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.userAgent},f=n(89994),m=n(92445),y=n(881),v=n(26532),C=n(57743),b=n(37426),E=n(66503),A=n(6609),S=n(35282),I=n(71874),P=n(38292),T=n(6182),x=n(60501),w=n(99429),k=n(58651);let _=!1;const D=e=>{_=e},F=(e,t)=>{if(u.w.isDevbuild()){const n=m.J.getInstance();null==t?(k.log("CopilotChat Log:",e),n?.addLog("CopilotChat Log:",e)):(k.log("CopilotChat Log:",e,t),n?.addLog("CopilotChat Log:",e,t))}},L=()=>{const e={};return Object.keys(a.CT).forEach((t=>{e[t]=0})),e},O=e=>(e[a.CT.UserQueryGuid]=c.dB,e[a.CT.CopilotChatSessionId]=u.w.getSessionId(),{eventType:s.S2.Latency,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}),R=e=>(e[a.h3.UserQueryGuid]=c.dB,e[a.h3.CopilotChatSessionId]=u.w.getSessionId(),e[a.h3.UserQueryOrder]=c.EU,{eventType:s.S2.ChatEvents,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}),M=e=>(e[a.tw.UserQueryGuid]=c.dB,e[a.tw.HostSDXSessionID]=u.w.getSessionId(),e[a.tw.UserQueryOrder]=c.EU,{eventType:s.S2.QueryDetails,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}),B=()=>{const e={};return Object.keys(a.h3).forEach((t=>{e[t]=""})),e},N=()=>{const e=window.getSelection?.().getRangeAt?.(0).startOffset;return e||0===e?e:-1},V=()=>{const e=window.getSelection();return e?e.isCollapsed:(F("window.getSelection() returned null"),!1)},H=async(e,t)=>{const o=await n.e("augloop").then(n.bind(n,34181));if(!t){const t={serviceUrl:u.w.getAugloopUrl(),appName:u.w.getAppName(),appVersion:u.w.getAppVersion(),authToken:e,releaseAudienceGroup:u.w.getReleaseAudienceGroup(),releaseChannel:u.w.getReleaseChannel(),releaseFork:u.w.getReleaseFork(),flights:u.w.getAugloopFlights()};o.StartInitializingRuntimeManage(t)}return await o.EnsureAugloopRuntimeManager()},U=(e,t=!0)=>{if(0===e.length)return-1;let n=e.length-1;return e.length>=2&&(e[n].messageType===r._.FeedbackNudge||"human"===(t&&e[n])?.body?.user)&&(n=e.length-2),n};function j(e){return null==e}const z=()=>d.A.getInstance().isWorkflowRegistered(o.tP.getTypeName())||d.A.getInstance().isWorkflowRegistered(o.Pd.getTypeName())||d.A.getInstance().isWorkflowRegistered(o.CT.getTypeName()),G=()=>d.A.getInstance().isWorkflowRegistered(y.Ml.getTypeName())&&d.A.getInstance().getWorkflowDataMap().get(y.Ml.getTypeName()).workflowInfo.shouldHandleResponse,W=(e,t,n,o,r,i)=>{const s=v.j.getInstance();s.sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:`${e}_Error`},{key:a.h3.ChatEventParameters,value:t},{key:a.h3.ChatErrorType,value:n}]),s.sendTelemetryLatencyData([{key:a.CT.ErrorParameter,value:t},{key:a.CT.ErrorType,value:n},{key:a.CT.UserPerceivedLatency,value:(0,c.WU)(c.qD)},{key:a.CT.IsQuerySuccess,value:!1},{key:a.CT.FeatureName,value:i}],!0),s.logErrorWithAshaVetoAndError([],i,f.u1,o,r)},q=(e,t)=>{let n=e;return t?.length&&t.reverse().forEach((t=>{const[o,r]=t.range,i=`[${e.slice(o,r+1)}](${t.value})`;n=n.slice(0,o)+i+n.slice(r+1)})),{user:l.Q9.Human,message:n,disableLinksProcessing:!0,shouldApplyInputLinkTheme:!0}};function Q(e){return Object.keys(e).filter((e=>"themeBackground"!==e)).reduce(((t,n)=>Object.assign(t,{[n]:e[n]})),{})}const K=()=>"Safari"===h(),Y=e=>{let t=e,n=!1;return e.includes("<entity")?(t=e.slice(0,e.indexOf("<entity")),n=!0):e.includes("<placeholder")&&(t=e.slice(0,e.indexOf("<placeholder"))),{inputSpanText:t,isFileEntityPresent:n}},$=()=>{_=!1,(0,C.KC)(),(0,b.Bb)(),(0,E.$w)(f.u1)},J=()=>{A.P.resetInstance(),S.E.resetInstance(),I._.resetInstance(),d.A.resetInstance(),P.A.resetInstance(),T.U.resetInstance(),v.j.resetInstance(),w.k.resetInstance()},X=()=>{const e=v.j.getInstance();return{logErrorTelemetry:(t,n)=>{e.sendTelemetryErrorData([{key:a.IC.ErrorMessage,value:n},{key:a.IC.ErrorCategory,value:t}])},logSuccessTelemetry:(t,n)=>{n?e.sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:t},{key:a.h3.ChatEventParameters,value:n}]):e.sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:t}])}}};function Z(e,t){const n=e.getHostSettings();return{hostAppSettings:{appName:n.appName,augloopUrl:n.augloopUrl,devBuild:n.devBuild,environment:n.environment,sessionId:n.sessionId,appVersion:n.appVersion,locale:n.language,appPlatform:n.appPlatform,platform:n.appPlatform},hostAppAuthToken:t}}const ee=(e,t,n,o)=>{const r=[];return o&&(e=e.map((e=>(e.referenceProps.iconUrl=o.iconUrl,e.referenceProps.title=o.name,e)))),{referencesV2:{maxVisibleReferences:n??f.t0,references:e.map((e=>{const n=(0,i._)({...e,referenceIconSize:e.referenceIconSize??f.aI},t),{Citation:o,Reference:a}=(0,x.W)({index:e.referenceIndex,referenceProps:{graphic:n.media,children:n.label,content:n.excerpt},sensitivityLabelProps:e.referenceProps.sensitivityLabel?{label:e.referenceProps.sensitivityLabel,description:f.u1}:void 0,previewContentProps:{...n,content:n.excerpt}});return r.push({citationIndex:e.referenceIndex,citationPill:o}),a}))},citationsV2:r}}},89994:(e,t,n)=>{n.d(t,{A1:()=>l,BF:()=>c,BR:()=>o,CY:()=>p,Cb:()=>le,DB:()=>u,DC:()=>s,Ee:()=>G,F5:()=>$,F6:()=>R,FK:()=>W,Fz:()=>P,Gh:()=>Y,Gr:()=>C,Gs:()=>r,Gu:()=>H,HK:()=>Z,HT:()=>N,HX:()=>K,Hn:()=>D,IG:()=>f,JM:()=>I,Ky:()=>ce,MS:()=>i,NJ:()=>E,Nn:()=>oe,O2:()=>h,O8:()=>x,OR:()=>de,Om:()=>he,QJ:()=>ie,RW:()=>fe,S1:()=>q,Sk:()=>ue,U_:()=>j,Uk:()=>L,V7:()=>ye,YF:()=>Ae,YL:()=>M,Zh:()=>re,a6:()=>b,aI:()=>k,bE:()=>ne,bG:()=>B,cY:()=>Ee,c_:()=>V,cv:()=>v,d7:()=>g,dN:()=>ve,dT:()=>Ce,eu:()=>ge,fw:()=>pe,hD:()=>X,hN:()=>ae,hi:()=>J,hy:()=>a,i7:()=>be,j5:()=>z,l3:()=>T,nn:()=>S,oV:()=>te,rp:()=>A,sy:()=>Q,t0:()=>w,tv:()=>ee,u1:()=>y,vU:()=>me,vj:()=>se,vu:()=>U,wd:()=>m,xO:()=>d,zT:()=>_,z_:()=>O});const o=100,r=" ",i="CopilotChat",a="CopilotChatDisplay",s=15e3,l=5e3,c="I'm still learning and can't do this just yet. Is there something else I can do to help",u="claimsChallengeMessageID",d="tokenMissingInteractionRequiredMessageID",p="Sorry, something went wrong. I'm working on it.",h=200,g=2e3,f=10,m=50,y="",v=" ",C="...",b="https://augloop-dogfood.officeppe.com",E=6e3,A=e=>`${e}\\Copilot`,S="Choose a starter prompt from the suggestions menu to get started",I="Augloop Response Timed Out",P="Chat History Response Timed Out",T=1e4,x="/",w=2,k=16,_="https://go.microsoft.com/fwlink/?linkid=2259761",D="Ask a question";var F;!function(e){e.Opera="Opera",e.Safari="Safari",e.PhantomJS="PhantomJS",e.Edge="Edge",e.Electron="Electron",e.Chrome="Chrome",e.MSIE="MSIE",e.Firefox="Firefox",e.SkypeShell="SkypeShell",e.Unknown="Unknown"}(F||(F={}));const L=500,O=16,R="Prompt",M="UTC",B="UserExperience",N="PromptLibrary",V="User",H="Other",U="EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts,AddUserActivityInPromptSuggestion",j="EnableUserPromptsEndpointCF,EnableHydrationSavedPromptsCF",z="EnableUserPromptsEndpointCF,EnablePromptLinkSharingCF,EnableHydrationSavedPromptsCF";var G;!function(e){e.XClientFlights="X-Client-Flights",e.XClientLanguage="X-Client-Language",e.ClientRequestId="Client-Request-Id"}(G||(G={}));const W="ChatWrapperId",q="messagesStartID",Q=10,K=3,Y="https://edgeservices.bing.com/edgesvc/chat?udsframed=1&form=SHORUN&clientscopes=chat,noheader,udsedgeshop,channelcanary,ntpquery,devtoolsapi,udsinwin11,clipboardcontext,udsdlpconsent,udscstart,cspgrd&lightschemeovr=1",$="Web Chat",J="acquired",X="OnWithAllowList",Z="Switcher_Menu_Item_Clicked",ee="3068386c-7a16-4f6a-a664-043b6b232816",te="https://login.microsoftonline.com/common",ne="/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.13003/en-us_web/login.html",oe="chatInputLoaded",re="Loading...",ie="create a presentation",ae="https://go.microsoft.com/fwlink/?linkid=2281226&client=",se="https://go.microsoft.com/fwlink/?linkid=2281345&ref=",le=0,ce=5,ue=59,de="4543d9ef-ec61-445e-bb40-e4482a6a92d7",pe=/.*mos.microsoft.com/,he=["00000003-0000-0000-c000-000000000000","https://graph.microsoft.com","https://graph.microsoft.us","https://dod-graph.microsoft.us"],ge=40,fe=.5,me=.75,ye=[100],ve=.77,Ce="image/jpeg",be="An unexpected error occurred. Please try again later.",Ee="https://copilot.cloud.microsoft";var Ae;!function(e){e.WXPO_CopyLink="copilot_WXPOCopyLink"}(Ae||(Ae={}))},37426:(e,t,n)=>{n.d(t,{s3:()=>T,t_:()=>x,Bb:()=>I});var o=n(47106),r=n(35373),i=n(33500),a=n(48082),s=n(18036),l=n(91834),c=n(35282),u=n(67707),d=n(73878),p=n(48829),h=n(26115);function g(e,t){const n=new u.Cc({userId:"",tenantId:p.w.getFeedbackSettings()?.feedbackInitOptions?.tenantId??"",logicalId:e.LogicalId?.toString()??"",localTime:new Date(Date.now()).toISOString(),id:e.ReferenceId?.toString()??"",eventType:t==i.u1.None?d.T8.EntityClicked:d.T8.EntityActionTaken,metadata:t==i.u1.None?"":`{"entityactiontakentype": "${t}"}`}),o={scenario:p.w.getSubstrateScenarioName(),events:[n]};return new h.g0({parentPath:["Signal",u.RN.getTypeName()],items:[{id:n.logicalId,body:new u.RN(o)}]})}var f=n(90922),m=n(26532),y=n(66503),v=n(18491),C=n(31756);const b="libbie-loader",E="https://admin.microsoft.com",A="https://admin-ignite.microsoft.com";let S=null;const I=()=>{S=null},P={chatInput:void 0},T=(e,t,n,o,u=!1,d)=>{if(S)return S;const h=[];P.chatInput=e.current;const b={origin:window.location.origin,columnSize:6,title:t,copilotLabButtonText:n,copilotLabLink:"https://copilot.cloud.microsoft/prompts",prompts:[],bookmarks:[],facets:{displayCategory:[]},accountInfo:{},selectedFacets:{},width:55,height:55,isDarkMode:u,locale:p.w.getLanguage(),isHeaderDisabled:!1,featureFlags:o,centroBaseUrl:p.w.isDevbuild()?A:E,onDialogLaunched:()=>{(0,r.cY)("dialog launched!"),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabDialogLaunched}])},onPromptClicked:e=>{(0,r.cY)("prompt clicked",e),c.E.getInstance().submitOperation(g(e,i.u1.None),C.g.getTypeName()),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabPromptItemClicked},{key:f.h3.ChatEventParameters,value:`${e.DisplayCategory}`},{key:f.h3.FilterParameters,value:JSON.stringify(b?.selectedFacets??{})}]),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabDialogClosed}]),(0,y.$w)(e.PromptId),(0,y.YA)(e),d(e.CommandText)},onFavoriteToggled:(e,t)=>{(0,r.cY)(`favorited toggle favorited: ${t}, prompt: `,e),c.E.getInstance().submitOperation(g(e,t?i.u1.Download:i.u1.Unsubscribe),C.g.getTypeName()),c.E.getInstance().submitOperation((0,a.C)(s.p.UserActivity,e.PromptId,t),l.x.getTypeName());const n=b.prompts.map((n=>{let o=n;return e.Id===n.Id&&(o=e,o.UserActivity.Favorite.IsFavorite=t),o}));b.prompts=n,m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabSavedPromptClicked},{key:f.h3.ChatEventParameters,value:t?i.$v.Favourite:i.$v.Unfavourite},{key:f.h3.FilterParameters,value:JSON.stringify(b?.selectedFacets??{})}]),h.forEach((e=>e({prompts:n})))},onDeleted:e=>{if((0,r.cY)("On removing the prompt from Prompt Browser:",e),!e?.PromptId)return;const t=s.y.DELETE,n=(0,a.C)(s.p.UserPrompts,e.PromptId,void 0,void 0,t);c.E.getInstance().submitOperation(n,l.x.getTypeName());const o=n?.items[0]?.body;o?.queryId&&(0,v.L)(o.queryId,{httpMethod:t}),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabSavedPromptClicked},{key:f.h3.ChatEventParameters,value:"Deleted"},{key:f.h3.FilterParameters,value:JSON.stringify(b?.selectedFacets??{})}])},onDialogDismissed:()=>{(0,r.cY)("dialog dismissed"),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabDialogClosed}]),P?.chatInput?.setMenuButtonFocus&&P.chatInput.setMenuButtonFocus()},onFilterChanged:e=>{b.selectedFacets=e,(0,r.cY)("filters changed",e),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabFilterUpdated},{key:f.h3.ChatEventParameters,value:JSON.stringify(b?.selectedFacets??{})}])},onShowOnlyFavoriteToggled:e=>{(0,r.cY)(`show only favorited toggled ${e}`)},onGoToCopilotLabClicked:()=>{(0,r.cY)("on go to copilot lab clicked"),m.j.getInstance().sendTelemetryChatEventData([{key:f.h3.ChatEventType,value:f.a5.CopilotLabGoToCopilotLabButtonClicked}])}};return S={register:e=>(h.push(e),b),unregister:()=>{},updateColumnSize:e=>{b.columnSize=e,h.forEach((t=>t({columnSize:e})))},updateTitle:e=>{b.title=e,h.forEach((t=>t({title:e})))},updateCopilotLabButtonText:e=>{b.copilotLabButtonText=e,h.forEach((t=>t({copilotLabButtonText:e})))},updateCopilotLabLink:e=>{b.copilotLabLink=e,h.forEach((t=>t({copilotLabLink:e})))},updatePrompts:e=>{b.prompts=e,h.forEach((t=>t({prompts:e})))},updateBookmarks:e=>{b.bookmarks=e,h.forEach((t=>t({bookmarks:e})))},updateFacets:e=>{b.facets=e,h.forEach((t=>t({facets:e})))},updateSelectedFacets:e=>{b.selectedFacets=e,h.forEach((t=>t({selectedFacets:e})))},updateDarkMode:e=>{b.isDarkMode=e,h.forEach((t=>t({isDarkMode:e})))},updateLocale:e=>{b.locale=e,h.forEach((t=>t({locale:e})))},updateIsHeaderDisabled:e=>{b.isHeaderDisabled=e,h.forEach((t=>t({isHeaderDisabled:e})))},updateChatInputRef:e=>{P.chatInput=e},updateAccountInfo:e=>{b.accountInfo=e,h.forEach((t=>t({accountInfo:e})))},getData:()=>b},S},x=async e=>{(0,v.bn)()&&c.E.getInstance().submitOperation((0,a.C)(s.p.UserPrompts,void 0,void 0,void 0,s.y.GET),l.x.getTypeName()),await(async e=>{S.updateSelectedFacets(e?{displayCategory:[e]}:void 0),await(0,o.n_)({centroEnvironmentBaseUrl:p.w.isDevbuild()?A:E,preConfig:{hostName:"SharedCopilot",locale:"en",perfPrefix:"SharedCopilot_"},enableUxVersionQueryParam:!0}),await(0,o.sz)({featureName:b,adapters:{dataSources:e=>{e("centro.hvc.libbieloader",S)}},localMode:!!window.localStorage.getItem("centro.hvc-loader.localMode")});const t=await(0,o.Px)({featureName:b}),n=document.createElement("div");await t.main(n)})(e)}},48606:(e,t,n)=>{n.d(t,{B5:()=>g,Dq:()=>C,Ej:()=>h,FG:()=>U,Fj:()=>k,GH:()=>y,Jh:()=>f,KQ:()=>p,Kr:()=>z,Mc:()=>W,Ou:()=>E,PN:()=>m,RY:()=>A,S5:()=>s,S8:()=>v,T1:()=>I,Ur:()=>d,VX:()=>D,Vv:()=>r,Y$:()=>b,_V:()=>i,_f:()=>B,aK:()=>_,aM:()=>j,aU:()=>N,d7:()=>c,eB:()=>S,fE:()=>l,fz:()=>R,gE:()=>x,hD:()=>L,hf:()=>q,iP:()=>O,ix:()=>a,js:()=>w,k8:()=>F,qe:()=>M,vH:()=>T,wQ:()=>u,wX:()=>H,xM:()=>G,xr:()=>V,yz:()=>P});var o=n(18850);const r=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CopyButtonLabel"),i=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ChangeTopicButtonLabel"),a=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.SignInButtonLabel"),s=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.SignInButtonPopover"),l=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorAuthenticationWithFix"),c=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CopyButtonPopover"),u=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CopilotPromptLibraryHeader"),d=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CopilotLabLaunchertext"),p=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CopilotLabMenuSubItem"),h=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorOffensiveInputContent"),g=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorOffensiveOutputContent"),f=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorInputBlockedByDynamicGuardList"),m=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorInvalidSignal"),y=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorThrottled"),v=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorInputTooLong"),C=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ErrorInvalidLanguage"),b=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LearnMoreString"),E=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.WorkingOnItString"),A=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringFinishingUp"),S=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringGettingReady"),I=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringGettingEverythingReady"),P=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringCraftingContent"),T=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringFinishingTouches"),x=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringWorkingOnRequest"),w=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringGatheringResources"),k=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.PaneLoadingUIString"),_=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.InActiveChatSessionErrorString"),D=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LicenseValidationErrorMessage"),F=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ChatHistoryPanelTitle"),L=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ChatHistoryPanelEmptyConversationName"),O=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.MicrophoneListeningGhostText"),R=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.MissingServicePlanBYOAErrorText"),M=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CIQDefaultPlaceholder"),B=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringLoadingConversation"),N=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.LoadingUIStringCreateNewConversation"),V=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.ExtensionsDialogTitle"),H=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.VerifyAccessButtonLabel"),U=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.claimChallengeChatMessage"),j=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CreditBannerTitle"),z=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CreditBannerBody"),G=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.CreditBannerLinkText"),W=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.SystemMessageActionButtonText"),q=(0,o.Ex)("officeaicopilot-chat.copilotChatStrings.promptGuideMenuSectionUnderstand")},19016:(e,t,n)=>{n.d(t,{zQ:()=>a});var o=n(82794),r=n(86122),i=n(62388);const a={...o.o,themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"};r.C,(0,i.a)({10:"#2B2B40",20:"#2F2F4A",30:"#333357",40:"#383966",50:"#3D3E78",60:"#444791",70:"#4F52B2",80:"#5B5FC7",90:"#7579EB",100:"#7F85F5",110:"#9299F7",120:"#AAB1FA",130:"#B6BCFA",140:"#C5CBFA",150:"#DCE0FA",160:"#E8EBFA"})},75601:(e,t,n)=>{n.d(t,{Dd:()=>p,R3:()=>h,U:()=>m,Zi:()=>f,f4:()=>y,hX:()=>d,q6:()=>g,uk:()=>u});var o=n(36130),r=n(38292),i=n(59777),a=n(26532),s=n(90922),l=n(35373),c=n(88012);function u(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}function d(e){return null==e}const p=async(e,t,n)=>{r.A.getInstance().sendLoggingEventToClient(i.Yk.CopyButtonClicked,{chatEventParams:"Basic_Chat"});let u={correlationId:"",featureName:""};try{u=JSON.parse(n)}catch(e){(0,l.cY)("Error parsing telemetry data on copy click",e.message)}a.j.getInstance().logKeptEvent([{key:s.qN,value:u.correlationId||""}],s.Nx,u.featureName,(0,c.A9)(u.featureName),void 0,(0,c._w)(u.featureName)),a.j.getInstance().sendTelemetryChatEventData([{key:s.h3.ChatEventType,value:s.a5.CopyButtonClicked},{key:s.h3.ChatEventParameters,value:u.featureName||""},{key:s.h3.UserQueryGuid,value:u.correlationId||""}]),(0,o.Cu)(e)},h=e=>{let t,n=e.length;for(;0!=n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},g=e=>{let t,n=e.length;for(;0!=n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e},f=(e="en")=>e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e;function m(e){const t=[],n=[];return e.forEach((e=>{e.DisplayCategory&&!n.includes(e.DisplayCategory)&&n.push(e.DisplayCategory)})),n.forEach((e=>{t.push({value:e})})),t}function y(e){const t=e.toLowerCase();return t.endsWith(".sharepoint.com")||t.endsWith(".sharepoint-df.com")||t.endsWith(".sharepoint.us")||"08e18876-6177-487e-b8b5-cf950c1e598c"===t||"00000003-0000-0ff1-ce00-000000000000"===t}},55161:(e,t,n)=>{n.d(t,{A:()=>g});var o=n(78715),r=n(91834),i=n(89994),a=n(90922),s=n(33500),l=n(54674),c=n(10162),u=n(35373),d=n(26532),p=n(31756);class h{constructor(){this.augloopDefaultTimeoutValue=NaN,this.FALLBACK_DEFAULT_AUGLOOP_RESPONSE_TIMEOUT_DURATION_IN_MS=65e3,this.workflowDataMap=new Map}static getInstance(){return h.instance?this.instance.copilotCommunicationHandler||d.j.getInstance().sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:a.a5.WorkflowDataMapNotInitialized},{key:a.h3.ChatEventParameters,value:"Got instance without Initialization"}]):h.instance=new h,h.instance}initializeWorkflowDataMap(e,t=!1){this.copilotCommunicationHandler=e,this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister(t))}static resetInstance(){h.instance=void 0}populateWorkflowDataMap(e){for(const t of e){const e={workflowInfo:t};this.workflowDataMap.set(t.workflowAnnotationType,e)}this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(s.WT.IsQnASuggestionPillCachingEnabled)&&!this.workflowDataMap.has(o.pK.getTypeName())&&this.workflowDataMap.set(o.pK.getTypeName(),{workflowInfo:{workflowAnnotationType:o.pK.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}),this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(s.WT.IsSharedCopilotLabEnabled)&&(this.workflowDataMap.has(r.x.getTypeName())?this.workflowDataMap.get(r.x.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(r.x.getTypeName(),{workflowInfo:{workflowAnnotationType:r.x.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}})),this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(s.WT.IsSharedCopilotLabEnabled)&&this.workflowDataMap.set(p.g.getTypeName(),{workflowInfo:{workflowAnnotationType:p.g.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}),this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(s.WT.IsClpSensitivityInChatInputEnabled)&&!this.workflowDataMap.has(l.L.getTypeName())&&this.workflowDataMap.set(l.L.getTypeName(),{workflowInfo:{workflowAnnotationType:l.L.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:i.DC}}),(this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(s.WT.IsCopilotPluginEnabled)||this.copilotCommunicationHandler?.isFeatureGateEnabledFromClient(s.WT.IsPersistanceInPhase2UxEnabled))&&(this.workflowDataMap.has(c.BN.getTypeName())?this.workflowDataMap.get(c.BN.getTypeName()).workflowInfo.shouldHandleResponse=!0:this.workflowDataMap.set(c.BN.getTypeName(),{workflowInfo:{workflowAnnotationType:c.BN.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}}))}getWorkflowDataMap(e=!1,t=!1){return e&&(this.workflowDataMap.clear(),this.copilotCommunicationHandler?this.populateWorkflowDataMap(this.copilotCommunicationHandler.getWorkflowsToRegister(t)):((0,u.cY)("CopilotCommunicationHandler is not initialized"),d.j.getInstance().sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:a.a5.WorkflowDataMapNotInitialized},{key:a.h3.ChatEventParameters,value:"Empty WorkflowDataMap returned"}]))),t&&this.workflowDataMap.has(o.pK.getTypeName())&&this.workflowDataMap.delete(o.pK.getTypeName()),this.workflowDataMap}isWorkflowRegistered(e){return this.copilotCommunicationHandler?this.workflowDataMap.has(e):((0,u.cY)("CopilotCommunicationHandler is not initialized"),d.j.getInstance().sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:a.a5.WorkflowDataMapNotInitialized},{key:a.h3.ChatEventParameters,value:"Workflow is not registered"}]),!1)}getWorkflowAugloopTimeoutValue(e){return this.isWorkflowRegistered(e)?this.workflowDataMap.get(e).workflowInfo.augloopResponseTimeout:this.getDefaultAugloopWorkflowTimeoutValue()}getDefaultAugloopWorkflowTimeoutValue(){if(!this.copilotCommunicationHandler)return(0,u.cY)("CopilotCommunicationHandler is not initialized"),d.j.getInstance().sendTelemetryChatEventData([{key:a.h3.ChatEventType,value:a.a5.WorkflowDataMapNotInitialized},{key:a.h3.ChatEventParameters,value:"workflowDataMap is not initialized"}]),this.FALLBACK_DEFAULT_AUGLOOP_RESPONSE_TIMEOUT_DURATION_IN_MS;if(isNaN(this.augloopDefaultTimeoutValue)){const e=this.copilotCommunicationHandler.getNumberFeatureGateValueFromClient(s.WT.AugloopResponseTimeoutDuration);this.augloopDefaultTimeoutValue=isNaN(e)?this.FALLBACK_DEFAULT_AUGLOOP_RESPONSE_TIMEOUT_DURATION_IN_MS:e}return this.augloopDefaultTimeoutValue}isAugloopResponseTimeoutRequired(e){return!!this.isWorkflowRegistered(e)&&this.workflowDataMap.get(e).workflowInfo.augloopResponseTimerRequired}}const g=h},34996:(e,t,n)=>{var o;n.d(t,{v:()=>o}),function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(o||(o={}))},26856:(e,t,n)=>{var o;n.d(t,{p:()=>o}),function(e){e.Shimmer="shimmer",e.Blocked="blocked",e.Enabled="enabled",e.Disabled="disabled",e.DefaultBlocked="defaultBlocked"}(o||(o={}))},27908:(e,t,n)=>{var o;n.d(t,{$:()=>o}),function(e){e.CurrentContext="CurrentContext",e.Work="Work",e.Web="Web"}(o||(o={}))},56148:(e,t,n)=>{var o;n.d(t,{ck:()=>o,eg:()=>r}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA"}(o||(o={}));const r={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",DIALOG:"dialog",TOOLTIP:"tooltip"};var i,a;!function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(i||(i={})),function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(a||(a={}))},86930:(e,t,n)=>{n.d(t,{w:()=>i});var o=n(59762),r=n(11594);class i{constructor(){this.base64ResizedImage=null}async ResizeImage(e,t=290,n=.5,i=.75,a=[2e3,1024,800,512],s=.85,l="image/webp"){const c=1024*t;if(e.length<c)return void(this.base64ResizedImage=e);let u=new Image;u.onerror=()=>{(0,r.IT)(o.er,"Failed to load image"),this.base64ResizedImage=null},u.src=e,await(()=>new Promise((e=>{u.onload=()=>{let t=document.createElement("canvas"),d=t.getContext("2d");d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high";let p=document.createElement("canvas"),h=p.getContext("2d");t.width=u.width,t.height=u.height,d.drawImage(u,0,0,t.width,t.height);let g={width:Math.floor(u.width),height:Math.floor(u.height)},f={width:null,height:null},m=0;let y=a.shift();for(null==y&&(y=0);!this.base64ResizedImage||this.base64ResizedImage.length>c;){if(m++>15){(0,r.IT)(o.er,"Maximum iterations reached"),this.base64ResizedImage=null;break}let e=n;if(1===m)e=1;else if(0===a.length&&void 0===y)e=i;else if(g.width*e<y||g.height*e<y){e=y/Math.max(g.width,g.height),y=a.shift()}f.width=Math.floor(g.width*e),f.height=Math.floor(g.height*e),d.drawImage(t,0,0,g.width,g.height,0,0,f.width,f.height),g.width=f.width,g.height=f.height,p.width=g.width,p.height=g.height,h.drawImage(t,0,0,g.width,g.height,0,0,g.width,g.height);const c=this.base64ResizedImage?this.base64ResizedImage.length:void 0;if(this.base64ResizedImage=p.toDataURL(l,s),void 0!==c&&c<=this.base64ResizedImage.length)return(0,r.IT)(o.er,"Failed to reduce file size"),void(this.base64ResizedImage=null)}e()}})))()}}},59762:(e,t,n)=>{n.d(t,{Gs:()=>o,HP:()=>u,O8:()=>h,Q6:()=>c,RD:()=>i,VN:()=>l,Xb:()=>a,er:()=>p,l3:()=>s,u1:()=>r,uR:()=>f,wb:()=>d});const o=" ",r="",i="copilot-chat-input",a=2e3,s=1e4,l="https://support.microsoft.com/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b",c="https://go.microsoft.com/fwlink/?linkid=2271054",u="ViewPromptsID",d="EntityPlugin",p="ImageResizerFailure",h="/",g={listening:()=>"Microphone Listening",paused:()=>"Microphone Paused",disabled:()=>"Microphone Disabled",loading:()=>"Microphone Loading"},f=()=>g},11594:(e,t,n)=>{let o;function r(e){o=e}function i(e,t){o&&o.logErrorTelemetry&&o.logErrorTelemetry(e,t)}function a(e,t){o&&o.logSuccessTelemetry&&o.logSuccessTelemetry(e,t)}n.d(t,{IT:()=>i,WT:()=>r,Zz:()=>a})},19234:(e,t,n)=>{if(n.d(t,{n:()=>u}),"cloudFilePickerDialog"==n.j)var o=n(32662);var r=n(8520);if("cloudFilePickerDialog"==n.j)var i=n(810);if("cloudFilePickerDialog"==n.j)var a=n(93042);if("cloudFilePickerDialog"==n.j)var s=n(79824);if("cloudFilePickerDialog"==n.j)var l=n(91069);var c=n(58651);const u=e=>{const{userPrincipalName:t,appName:n,theme:u,locale:d,clientId:p,redirectUri:h,onItemSelected:g,onErrorInLoading:f,onDismissDialog:m,supportedFileExtensionMimeMap:y}=e,v=r.useMemo((()=>new s.S({userPrincipalName:t,redirectUri:h,clientId:p})),[t,h,p]),C=r.useCallback((async e=>{try{const t=await v.getToken(e??i.w.graph);return(0,a.t)(t)}catch(e){return c.error("Error acquiring graph token:",e),{accessToken:"",expirationTime:0}}}),[v]),b=r.useCallback((async e=>{try{const t=await v.getToken(e);return(0,a.t)(t)}catch(e){return c.error("Error acquiring sharepoint token:",e),{accessToken:"",expirationTime:0}}}),[v]),[E,A]=r.useState(void 0);return r.useEffect((()=>{const e=new o.P(C,b,n,d,u,y);A(e)}),[n,C,d,b,u,y]),r.createElement("div",null,E?r.createElement(l.o,{service:E,onItemSelected:g,onDismissDialog:m,onErrorInLoading:f}):r.createElement("div",null,"Loading..."))}},91069:(e,t,n)=>{if(n.d(t,{o:()=>u}),"cloudFilePickerDialog"==n.j)var o=n(44907);if("cloudFilePickerDialog"==n.j)var r=n(3334);if("cloudFilePickerDialog"==n.j)var i=n(71808);if("cloudFilePickerDialog"==n.j)var a=n(50083);var s=n(8520);if("cloudFilePickerDialog"==n.j)var l=n(36361);var c=n(58651);function u(e){const{service:t,onItemSelected:n,onDismissDialog:u,onErrorInLoading:d}=e,[p,h]=s.useState(!0),[g,f]=s.useState(null),m=(0,l.I)();s.useEffect((()=>{const e={pick:async e=>{c.log(e),n(e.items)},close:async e=>{u()},pageLoaded:e=>{h(!1)}};if(g){let n;return t.initializePicker(g,e).then((e=>{n=e})).catch((e=>{d()})),()=>n?.()}}),[g,t]);const y=s.useCallback((e=>{f(e&&e.contentWindow||null)}),[]);return s.createElement("div",null,s.createElement(o.E,{className:m.dialog},s.createElement(r.R,{className:m.dialogBody},s.createElement(i.C,{className:m.dialogContent},p&&s.createElement(a.y,{size:"large",className:m.spinner}),s.createElement("iframe",{title:"File Picker",sandbox:"allow-forms allow-modals allow-popups allow-same-origin allow-scripts",ref:y,className:m.iframe})))))}},36361:(e,t,n)=>{n.d(t,{I:()=>a});var o=n(658),r=n(62653),i=n(16895);const a=(0,o.n)({dialog:{display:"flex",width:"100%",height:"100%",maxWidth:"unset",backgroundColor:r.L.colorNeutralBackground4Hover,...i.Pt.padding("0px","0px","0px","0px"),border:"none",borderRadius:"0px"},dialogBody:{width:"100%",height:"100%",maxHeight:"100%"},dialogContent:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spinner:{position:"fixed",left:"50%",top:"50%"},iframe:{width:"97vw",height:"95vh",maxWidth:"100%",maxHeight:"100%",display:"block"}})},79824:(e,t,n)=>{n.d(t,{S:()=>r});var o=n(58651);class r{constructor(e){this.params=e}async loadMsalBrowser(){for(let e=1;e<=3;e++)try{return this.msalModule=await n.e("vendors~auth-msal-browser").then(n.bind(n,89761)),void(this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication))}catch(t){if(o.error(`Attempt ${e} to load @azure/msal-browser failed:`,t),3===e)throw t}}async createPublicClientApplication(e){const t=this.params.clientId,n=this.params.redirectUri;return new e({auth:{clientId:t,authority:"https://login.microsoftonline.com/common",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}async getToken(e,t){o.log("MsalTokenService.getToken called for resource: "+e),this.publicClientApplication||await this.loadMsalBrowser();const n=await this.publicClientApplication;if(!n)throw new Error("Failed to acquire token - Could not load msal module");let r;try{await n.initialize();const t=n.getAllAccounts();if(0===t?.length){return await this.ssoSilentNoAccount(e,n)}if(r=await this.getSelectedAccount(t,n),!r)throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return await this.acquireTokenSilent(e,r,n)}catch(t){if(o.log(`Failed to get access token: ${t?.message}`),this.msalModule&&t instanceof this.msalModule.InteractionRequiredAuthError){return await this.acquireTokenPopup(e,r,n)}throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),t}}async getSelectedAccount(e,t){if(this.loginPopupPromise){const e=await this.loginPopupPromise;return e?.account??void 0}if(!e||0===e.length)return;const n=this.params?e.find((e=>e.username?.toLowerCase()===this.params?.userPrincipalName?.toLowerCase()))??null:e[0];if(n)return n;const o=this.params?{loginHint:this.params.userPrincipalName}:void 0;try{this.loginPopupPromise=t.loginPopup(o);const e=await this.loginPopupPromise;return e?.account??void 0}finally{this.loginPopupPromise=void 0}}async ssoSilentNoAccount(e,t){const n={scopes:[`${e}/.default`],loginHint:this.params?.userPrincipalName},o=await t.ssoSilent(n);return o||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),o}async acquireTokenSilent(e,t,n){const o={scopes:[`${e}/.default`],account:t},r=await n.acquireTokenSilent(o);return r||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),r}async acquireTokenPopup(e,t,n){const o={scopes:[`${e}/.default`],account:t},r=await n.acquireTokenPopup(o);return r||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),r}logTokenAcquiredError(e){o.log("AuthTokenService",e)}}},810:(e,t,n)=>{n.d(t,{w:()=>o});const o={graph:"https://graph.microsoft.com",sharepoint:"https://microsoft-my.sharepoint-df.com"}},93042:(e,t,n)=>{n.d(t,{t:()=>o});const o=e=>({accessToken:e.accessToken,expirationTime:e?.expiresOn?.getTime()??0})},44676:(e,t,n)=>{n.d(t,{Od:()=>i,HK:()=>a,B9:()=>s});var o=n(8520);const r={colorLoadingFlair1:"#87CEFA",colorLoadingFlair2:"#B0E0E6",colorLoadingFlair3:"#AFEEEE",colorLoadingFlair4:"#E0FFFF"},i=o.createContext(r),a=()=>o.useContext(i),s=e=>(0,o.useMemo)((()=>({...r,...e})),[e])},92619:(e,t,n)=>{n.d(t,{ZJ:()=>i,Y$:()=>a,dg:()=>s});var o=n(8520);const r={isApiPluginsEnabled:!1,isApiPluginsAuthEnabled:!0,isPowerPlatformPluginsEnabled:!1,isChatCardFactoryMemoizationEnabled:!1,isChatCardRendererMemoizationEnabled:!1,isClaimsChallengeCallbackEnabled:!0,isClaimsChallengeMessageInAnnotationEnabled:!0,isCreditsUIEnabled:!1,isCustomGPTsEnabled:!1,isDragDropWrapperEnabled:!0,isInterstitialConfirmationEnabled:!0,isInterstitialAuthEnabled:!0,isCustomHandlingForChatHistoryEnabled:!1,isFocusChatInputOnMount:!0,isGroupedCopilotPluginEnabled:!1,isMissingServicePlanBYOAErrorEnabled:!0,isMsgExtAuthSkillEnabled:!0,isPasteUnfurlingEnabled:!1,isQueryWarmupSignalEnabled:!1,isQueryWarmupSignalEnabledOnChatPaneOpens:!1,isSccCiqEnabled:!1,isSccReadAloudEnabled:!1,isSccVoiceEnabled:!1,isSccElaboratePromptEnabled:!1,isServerAuthenticationStateChangeEnabled:!0,isSketchImageCardEnabled:!1,isSketchImageResizeEnabled:!1,isFocusChatAfterImageUploadEnabled:!1,isSpaceRequiredAfterInput:!0,isViewMorePromptsOneClickEnabled:!1,isStringReplacementAnchorTagOverrideEnabled:!1,isChatHistorySignalDeferred:!1,showSystemMessageOnPluginToggle:!0,useExternalAuthService:!0,enableProactiveZQMWith3SAPISuggestions:!1,enableProactiveZQMWithSuggestedQnA:!1,isZQMShownSourceTelemetryEnabled:!0,enableNewZQMsForDocumentWithContent:!1,enableNewZQMsForEmptyDocument:!1,enableQueryBeforeAnnotationLoad:!0,enableMorePlugins:!0,isPluginStatePersist:!1,isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:!1,shouldUseSMBAChannel:!0,shouldRenderAllHyperLinks:!1,enableCreatePpcConnections:!1,enableButtonHidingWithAtMention:!1,enableAddSelectionForGPTs:!1,shouldUseMsalSsoSilentLogin:!1,shouldUseMsalLocalSilentFlag:!1,shouldUseHybridAppService:!1,showPluginReferencesV3:!1,showNewChatOnGPTItem:!1,enableNewChatOnlyOnCopilot:!1,isCloudFileUploadEnabled:!1,isZQMEarlyLoadingEnabled:!1,isAttachmentHintEnabled:!1,isAttachmentListEnabled:!1,isInputMessageEnabled:!0,enableQueryEndOnGptSwitch:!0,isSelectionButtonEnabled:!1,isMultiSelectionAttachmentEnabled:!1,shouldShowFileUploadButtonText:!1,isOutputV2Enabled:!1,isLocalFileUploadEnabled:!1,isOfficeCopilotChatPreloadEnabled:!1,promptInputLength:2e3,enableSystemMessageActions:!1,isDAOutputV2Enabled:!1,clearLoadingMessagesOnHandleSubmit:!1,useResponsiveSystemMessage:!1,disableALAnnotationsOnPreload:!1,showPluginsAsAgents:!1,isHandoffButtonEnabled:!1,useCacheForGPTDetails:!1,enableSwitcherMenuV2:!1,isAcquirePluginsFromMosEnabled:!1,isSmartInsertEnabled:!1,isApiPluginsCardsEnabled:!1,isSaveSharePromptEnabled:!1,isFluentV9TaskPaneEnabled:!1,stopMenuShimmerAfterFirstCall:!1,isSEFEntitiesEnabled:!1,isDABrandingEnabled:!1,isInsertImageEnabledForDAs:!1,isGoBoldPromptCardEnabled:!1,shouldUseMsalGetTokenRequestCaching:!1,isZQMColumnStackingEnabled:!1,scrollToBottomThrottleDelay:500,isUXRefreshEnabled:!1,loadGptListOnCopilotIconClick:!1,restrictConversationStartersForDA:!1,enableCustomWidthPropOnAC:!1,isChatContainerZoomedInResetEnabled:!1,avoidReactSuspenseForCopilotChatDisplay:!1,isSimplifiedChatInputEnabled:!1,enableInsightsCard:!1,prefetchACImages:!1,addExtensibiltyDataToFeedbackOCV:!1,avoidAdaptiveCardRerender:!1},i=o.createContext(r),a=()=>o.useContext(i),s=e=>(0,o.useMemo)((()=>({...r,...e})),[e])},41712:(e,t,n)=>{n.d(t,{Hv:()=>i,Hz:()=>s,Mb:()=>a});var o=n(8520),r=n(90037);const i=o.createContext(r.Nh),a=()=>o.useContext(i),s=e=>(0,o.useMemo)((()=>({hostAppSettings:{...r.Nh.hostAppSettings,...e.hostAppSettings},hostAppAuthToken:{...r.Nh.hostAppAuthToken,...e.hostAppAuthToken}})),[e])},90037:(e,t,n)=>{n.d(t,{Nh:()=>i,gh:()=>r});const o="",r={graphTokenProvider:async e=>({accessToken:"",expirationTime:0}),sharepointTokenProvider:async e=>({accessToken:"",expirationTime:0}),lokiTokenProvider:async e=>({accessToken:"",expirationTime:0}),oneNoteTokenProvider:async e=>({accessToken:"",expirationTime:0}),substrateTokenProvider:async e=>({accessToken:"",expirationTime:0})},i={hostAppSettings:{appName:o,appPlatform:o,appVersion:o,augloopUrl:o,devBuild:!1,environment:o,locale:"en-US",sessionId:o,platform:o},hostAppAuthToken:r}},8320:(e,t,n)=>{n.d(t,{Sv:()=>l,WG:()=>r,l$:()=>a,wr:()=>s,y7:()=>i});var o=n(18850);const r=(0,o.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatLoadErrorHeader"),i=(0,o.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatLoadErrorText"),a=(0,o.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatGPTListLoadErrorText"),s=(0,o.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotExtensionChatInputPlaceholderText"),l=(0,o.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatGetAgentsText")},42181:(e,t,n)=>{n.d(t,{V:()=>i,z:()=>a});var o=n(8520);const r=(0,o.createContext)({copilotChatHistoryContext:{setOnClickShowChatHistoryPanel:()=>{},setChatHistoryContainer:void 0,setNewConversationClickHandler:void 0},copilotChatConversationSelectedContext:{conversationId:null,handleChatHistoryConversationClick:(e,t)=>!1},creditUIContext:{setShowCreditsTeachingCallout:null},stopGeneratingQuery:null}),i=({copilotChatHistoryContext:e,copilotChatConversationSelectedContext:t,creditUIContext:n,stopGeneratingQuery:i,children:a})=>o.createElement(r.Provider,{value:{copilotChatHistoryContext:e,copilotChatConversationSelectedContext:t,creditUIContext:n,stopGeneratingQuery:i}},a),a=()=>o.useContext(r)},18712:(e,t,n)=>{n.d(t,{e:()=>yn});var o=n(65593),r=n(90922),i=n(59777),a=n(22330),s=n(70737),l=n(92619),c=n(8320),u=n(75184),d=n(91042),p=n(8520),h=n(57830),g=n(41315),f=n(54833),m=n(26115),y=n(78126);const v=new Map,C=e=>v.has(e)?(new Date).getTime()-v.get(e):-1,b=e=>{v.delete(e)};var E;!function(e){e.GPTRequest="GPTRequest",e.GPTResponse="GPTResponse",e.GPTError="GPTError",e.GPTLatency="GPTLatency",e.GPTTimeout="GPTTimeout",e.GetCachedGPT="GetCachedGPT",e.GPTListUserPerceivedLatency="GPTListUserPerceivedLatency",e.OpenAgentFromMOS="OpenAgentFromMos"}(E||(E={}));var A=n(4787),S=n(58651);let I=!1;const P=(e,t)=>{I&&(null==t?S.log("CopilotGPT Log:",e):S.log("CopilotGPT Log:",e,t))},T=(e,t,n)=>{const o={...t.chatUiProps,...e,suggestionPillsUiProps:{suggestionList:[]},chatInputV2Props:{...t.chatUiProps.chatInputV2Props,isImageInputButtonEnabled:!1,buttonProps:{groundingButtonEnabled:!1,ciqButtonEnabled:!1,menuButtonEnabled:!1},chatPlaceholderMessage:n}};return P("Updated Copilot Chat Props for GPTs",o),{...t,chatUiProps:o}},x=(e,t,n)=>{let o="";try{o=JSON.stringify({fetchedGPTListLength:e,isCopilotExtensibilityDisabledByAdmin:t,gptTypeRecorder:n})}catch(e){P("Error in stringifying data",e)}return o},w=e=>e.includes("ProjectedDeclarativeAgent.MessageExtension"),k=e=>e.includes("ProjectedDeclarativeAgent.PowerPlatform"),_=e=>e.includes("ProjectedDeclarativeAgent.DataVerse"),D=e=>w(e)||k(e)||_(e),F=e=>w(e)?A.AL.MEProjectedAsDA:k(e)?A.AL.PPProjectedAsDA:_(e)?A.AL.DataVerseProjectedAsDA:A.AL.UnprojectedDA;var L;!function(e){e.Success="success",e.Error="error"}(L||(L={}));var O=n(79689);const R=e=>e?.conversationStarters?.conversationStarterList?.map((e=>({text:e?.text??"",title:e?.title??""})));let M;const B=g.s3.getTypeName(),N=async(e,t,n,o,r)=>{P("getGPTDetails from CopilotGPT",e),await H(d.S.GetGPT,t,n,e,r),o.setTimeout(d.S.GetGPT,3e4)},V=async(e,t,n,o)=>{P("getGPTList from CopilotGPT"),await H(d.S.GetGPTList,e,t,void 0,o),n.setTimeout(d.S.GetGPTList,3e4)},H=async(e,t,n,o,r)=>{const i=U(e,o,n,r),a=new m.g0({parentPath:["Signal",B],items:[{id:h.r.generateId(),body:i}]});var s,l;P(`Submitting signal to Augloop : ${B} with operation type: ${e} and signal: ${JSON.stringify(i)}`),s=i?.queryId,l=(new Date).getTime(),v.set(s,l),t(a),M=(new Date).getTime()},U=(e,t,n,o)=>{const r=(0,y.A)();switch(n?.(e,E.GPTRequest,void 0,o,r),e){case d.S.GetGPTList:{const e={type:d.S.GetGPTList};return new g.s3({operation:e,queryId:r})}case d.S.GetGPT:{const e={type:d.S.GetGPT,gptId:t};return new g.s3({operation:e,queryId:r})}default:return new g.s3}},j=async(e,t,n,o,r)=>{var i;P(`${g.s3.getTypeName()} response. Time Taken : ${i=M,((new Date).getTime()-i)/1e3} sec \n`);const a=e.body.operationResponse,s=a.type;switch(s){case d.S.GetGPTList:{o(!1);const e=a,n=e?.gptResult?.statusCode,r=e?.isCopilotExtensibilityDisabledByAdmin;if(n!==f.su.Success)return P(`GetGPTList failed with status code: ${n} and message: ${e?.messageToRender}`),t((e=>({copilotSwitcherMenuItemProps:e.copilotSwitcherMenuItemProps,status:L.Error}))),{operationType:s,statusCode:n,fetchedGPTListLength:0,isCopilotExtensibilityDisabledByAdmin:r};const i=e?.gptListResponse?.gptList??[];if(P(`GetGPTList response: ${JSON.stringify(i)}`),0===i.length)return P("No GPTs found"),{operationType:s,statusCode:n,fetchedGPTListLength:i?.length??0,isCopilotExtensibilityDisabledByAdmin:r};const l=(e=>e.filter((e=>e?.gptIdentifier?.id??!1)).map((e=>({id:e?.gptIdentifier?.id??"",name:e?.name??"",isDefaultCopilot:!1,copilotType:A.NV.CustomGPT,isSelected:!1,menuIconUrl:e.icon,starterPrompts:R(e)??[],metaOSAppId:e?.metaOSAppId??""}))))(i);t({copilotSwitcherMenuItemProps:l,status:L.Success});const c=(e=>{const t={[A.AL.MEProjectedAsDA]:0,[A.AL.PPProjectedAsDA]:0,[A.AL.DataVerseProjectedAsDA]:0,[A.AL.UnprojectedDA]:0};return e.reduce(((e,t)=>{const n=F(t.id);return e[n]=(e[n]||0)+1,e}),t)})(l);return{operationType:s,statusCode:n,fetchedGPTListLength:i?.length??0,isCopilotExtensibilityDisabledByAdmin:r,gptTypeRecorder:c}}case d.S.GetGPT:{r(!1);const e=a;P(`GetGPT response: ${JSON.stringify(e)}`);const t=e?.gptResult?.statusCode;if(t!==f.su.Success)return P(`GetGPT failed with status code: ${t} and message: ${e?.messageToRender}`),n({copilotChatProps:void 0,gptId:"",status:L.Error}),{operationType:s,statusCode:t};const o=e.gptResponse?.gptDetails;if(!o)return void P("No GPT details found");const i=(e=>({zeroQueryMessageV2Props:{promptSuggestionList:(e?.conversationStarters?.conversationStarterList??[]).map((e=>({suggestionText:e?.text??"",suggestionCategory:e?.title??"",iconRegular:O.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1})))}}))(o),l=t!==f.su.Success?L.Error:L.Success;return n({copilotChatProps:i,gptId:o.gptIdentifier.id,status:l}),{operationType:s,statusCode:t}}}};class z{constructor(e,t){this.queryTimeoutMap=new Map,this.gptListResponseTimeoutInternal=()=>{P("GPT List response timed out"),this.setIsTimeoutForGPTList(!0)},this.gptDetailsResponseTimeoutInternal=()=>{P("GPT Details response timed out"),this.setIsTimeoutForGPTDetails(!0)},this.setIsTimeoutForGPTList=e,this.setIsTimeoutForGPTDetails=t}static getInstance(e,t){return z.instance||(z.instance=new z(e,t)),z.instance}static resetInstance(){z.instance=void 0}setTimeout(e,t){let n;switch(e){case d.S.GetGPTList:n=this.gptListResponseTimeoutInternal;break;case d.S.GetGPT:n=this.gptDetailsResponseTimeoutInternal}const o=window.setTimeout(n,t);this.queryTimeoutMap.set(e,o)}clearTimeout(e){const t=this.queryTimeoutMap.get(e);t&&(P(`Clearing timeout for operation type: ${e}`),clearTimeout(t),this.queryTimeoutMap.delete(e))}}var G=new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;if(!e)throw new Error("Listener is not provided");return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0});const W=e=>{const[t,n]=p.useState(),o=p.useRef(!1),{copilotFeatureFlags:r}=e,i=p.useCallback((async()=>{var t;return o.current=!0,t=e.copilotCommunicationHandler.getHostSettings().devBuild,I=t,e.copilotCommunicationHandler.getALSession().then((e=>{n(e)})),()=>{z.resetInstance(),o.current=!1}}),[]),a=!r.isFocusChatInputOnMount,s=p.useCallback((async()=>{r?.loadGptListOnCopilotIconClick&&!o.current&&(i(),P("AL session is initialized and GPT List has been called when preload chatpane is visible :- "+a))}),[]);var l;return p.useEffect((()=>{r?.loadGptListOnCopilotIconClick?a||s():(P("AL session is initialized and GPT List has been called when component was mounted"),i())}),[]),l=s,p.useEffect((function(){if(l){var e=G.subscribe(l);return function(){e()}}}),[]),{alSession:t,handlePreloadGptListCall:s}};function q(e,t,n,o,r,i,a,s){const{copilotFeatureFlags:l}=t,{alSession:c,handlePreloadGptListCall:h}=W(t),[g,m]=p.useState({copilotSwitcherMenuItemProps:[],status:L.Error}),[y,v]=p.useState(!1),A=p.useRef(!1),[S,I]=p.useState({copilotChatProps:t.chatUiProps,gptId:"",status:L.Success}),[T,w]=p.useState(!1),[k,_]=p.useState(!1),[D,F]=p.useState(!1),O=p.useRef(a),R=z.getInstance(F,_),{handleAnnotation:M}=function(e,t,n,o,r,i,a,s,l,c){return{handleAnnotation:async p=>{for(const h of p.items){const p=h.body?.H_;if(p?.T_===u.vF.getTypeName()){const{operationType:u,statusCode:p,fetchedGPTListLength:g,isCopilotExtensibilityDisabledByAdmin:m,gptTypeRecorder:y}=await j(h,t,e,n,o),v=h.body,A=v?.queryId,S=C(A);P("userPerceivedLatency for GPT LIST",S),b(A),s.clearTimeout(u),S&&a(u,E.GPTLatency,S,null,A),p===f.su.Success?(a(u,E.GPTResponse,x(g,m,y),null,A),u===d.S.GetGPTList&&i(!1)):(a(u,E.GPTError,JSON.stringify({statusCode:p}),null,A),u===d.S.GetGPT?r(!0):u!==d.S.GetGPTList||p===f.su.GptListNotFound||l?.current||i(!0),u===d.S.GetGPTList&&l?.current&&c())}}}}}(I,m,v,w,n,o,r,R,O,(()=>{s(!1),O.current=!1,B()}));p.useEffect((()=>{c&&e&&c.activateAnnotation(u.vF.getTypeName(),{callback:M}).then((()=>{B()}))}),[c,e]),p.useEffect((()=>{D&&e&&(v(!1),0===g.copilotSwitcherMenuItemProps.length&&o(!0),r(d.S.GetGPTList,E.GPTTimeout,JSON.stringify({statusCode:"GPTListTimeout"})))}),[D]),p.useEffect((()=>{k&&e&&(w(!1),n(!0),r(d.S.GetGPT,E.GPTTimeout,JSON.stringify({statusCode:"GPTDetailsTimeout"})))}),[k]);const B=()=>{if(c&&e&&!y){l?.stopMenuShimmerAfterFirstCall?A?.current||(v(!0),A.current=!0):v(!0);const e=i();V((t=>{c.submitOperation(t,e)}),r,R,e)}};return{isLoadingMenu:y,isLoadingGPTDetails:T,isTimeoutForGPTList:D,isTimeoutForGPTDetails:k,fetchGPTList:B,gptListProps:g,fetchGPTDetails:async t=>{if(e&&c){w(!0);const e=i();await N(t,(t=>{c.submitOperation(t,e)}),r,R,e)}},gptDetailsProps:S,handlePreloadGptListCall:h}}var Q=n(42181),K=n(49118),Y=n(9596),$=n(11313),J=n(19349),X=n(77148),Z=n(5925),ee=n(70188),te=n(21137),ne=n(5031),oe=n(62653),re=n(98365),ie=n(30112),ae=n(94794),se=n(89270),le=n(32459),ce=n(86691),ue=n(86688),de=n(49324),pe=n(86899),he=n(2866),ge=n(12839),fe=n(85215),me=n(92153),ye=n(40292),ve=n(21112),Ce=n(658);const be=(0,Ce.n)({root:{maxWidth:"200px"}}),Ee=({onCloseFre:e,mountNode:t,primaryButtonText:n,headerText:o,title:r,image:i,bodyText:a,anchorId:s})=>{const l=i?.src,c={target:document.getElementById(s),position:"above",align:"start"},[u,d]=p.useState(!0),h=be();return p.createElement(pe.l,{open:u,size:"large",trapFocus:!0,onOpenChange:()=>{d(!1),e(!1)},mountNode:t,positioning:c,withArrow:!0},p.createElement(he.S,{"aria-label":`${o} ${r} ${a}`,className:h.root},p.createElement(ge.M,null,o),p.createElement(fe.N,{media:p.createElement(me._,{fit:"contain",src:l})},p.createElement(ye.T,null,r),p.createElement("div",null,a)),p.createElement(ve.w,{primary:{children:n,onClick:()=>{d(!1),e(!0)},role:"button",tabIndex:-1,"aria-label":n}})))};var Ae=n(28029),Se=n(68779),Ie=n(36195),Pe=n(44624),Te=n(86315);const xe="CopilotSwitcherMenuID",we=({copilot:e,handleCopilotChatChange:t,onMenuStateChange:n,copilotListStyle:o,switcherMenuChatHistoryProps:r,newChatLabel:i})=>{const a=!e.isLink,s=e.isSelected&&r?.newConversationClickHandler,[l,c]=p.useState(!1),u=p.useRef(null),d=p.useRef(null),h=s?e=>{"ArrowRight"===e.key&&!l&&d.current?(c(!0),d.current?.focus(),e.preventDefault()):"ArrowLeft"===e.key&&l&&(c(!1),u.current?.focus(),e.preventDefault())}:void 0;return p.createElement(se.D,{key:e.id,ref:u,onClick:o=>{t(e.id),n(o,{open:!1,type:"menuItemClick"})},"aria-label":e.name,onKeyDown:h,className:e.isSelected?o.menuItemSelected:o.menuItem},p.createElement(K.W,{horizontal:!0,style:o.menuItemParts},p.createElement(Pe.l,null,p.createElement(K.W,{horizontal:!0},!a&&p.createElement("div",{style:{marginLeft:"3px",color:"transparent"}}),a&&p.createElement(Pe.l,{style:o.itemSelector},p.createElement("svg",{width:"3",height:"20",viewBox:"0 0 3 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("rect",{width:"3",height:"16",rx:"1.5"}))),p.createElement(Pe.l,{style:o.menuItemIcon},e.menuIconUrl?p.createElement(Te.Z,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon?e.menuIcon:p.createElement("div",{style:{width:"20px"}})),p.createElement(Pe.l,{style:e.isSelected?o.menuItemLabelSelected:o.menuItemLabel},e.name))),p.createElement(Pe.l,{style:o.actionButtonContainer},s&&p.createElement(Se.m,{withArrow:!0,positioning:"below",content:i,relationship:"label"},p.createElement(Ie.I,{className:o.actionButton,ref:d,icon:p.createElement(O.svB,null),tabIndex:l?0:-1,onClick:()=>{r.newConversationClickHandler({eventName:"Switcher_Menu_Change_Topic_Button_Clicked",gptId:e.id,shouldSetLoadingUIStates:!0})},"aria-label":e.name+","+i})))))};var ke=n(16895);const _e={maxWidth:"100%",height:"32px",...ke.Pt.margin("2px","16px","2px","16px"),...ke.Pt.padding("0px"),alignItems:"center",cornerRadius:"8px",borderRadius:"8px",backgroundColor:oe.L.colorNeutralBackground3,":hover":{backgroundColor:oe.L.colorNeutralBackground3Hover,"& button":{backgroundColor:oe.L.colorNeutralBackground3Hover}},":hover:active":{backgroundColor:oe.L.colorNeutralBackground3Selected}},De={maxWidth:"100%",height:"32px",...ke.Pt.margin("2px","8px","2px","8px"),...ke.Pt.padding("0px"),alignItems:"center",cornerRadius:"8px",backgroundColor:oe.L.colorNeutralBackground3},Fe={...ke.Pt.padding("0px"),width:"32px",height:"32px",alignItems:"center",backgroundColor:oe.L.colorNeutralBackground3,":hover":{backgroundColor:oe.L.colorNeutralBackground3Hover}},Le={menuContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},drawerBody:{...ke.Pt.padding("0px")},menuItem:{..._e,":hover":{backgroundColor:oe.L.colorNeutralBackground3Hover,"& rect":{fill:oe.L.colorNeutralStroke1Hover},"& button":{backgroundColor:oe.L.colorNeutralBackground3Hover}},":hover:active":{backgroundColor:oe.L.colorNeutralBackground3Selected,"& rect":{fill:oe.L.colorNeutralStroke1Hover}},"& rect":{fill:"transparent"}},menuItemSelected:{..._e,"& rect":{fill:oe.L.colorBrandForeground1}},menuItemSeeMore:{..._e,...ke.Pt.padding("0px","0px","0px","6px")},menuItemParts:{justifyContent:"space-between"},itemSelector:{...ke.Pt.margin("4px","0px","0px","0px")},menuItemIcon:{...ke.Pt.padding("0px","0px","0px","5px"),maxWidth:"20px",maxHeight:"20px",alignSelf:"center"},menuItemLabel:{...ke.Pt.padding("0px","0px","0px","6px"),fontSize:"14px",lineHeight:"14px",alignSelf:"center",color:oe.L.colorNeutralForeground1},menuItemLabelSelected:{...ke.Pt.padding("0px","0px","0px","6px"),fontSize:"14px",lineHeight:"14px",alignSelf:"center",fontWeight:oe.L.fontWeightSemibold,color:oe.L.colorNeutralForeground1},menuButton:{minWidth:"95%",alignItems:"center"},chatHistoryButton:{..._e,width:"calc(100% - 32px)",alignSelf:"flex-end",borderRadius:"8px",...ke.Pt.margin("2px","16px","12px","16px")},actionButtonContainer:{...ke.Pt.padding("0px","6px","0px","0px")},actionButton:{...Fe},errorToastBody:{alignItems:"start",...ke.Pt.gap("5px")},errorToastIcon:{...ke.Pt.padding("5px")},errorToastText:{...ke.Pt.padding("5px","0px"),width:"200px",fontWeight:"600",fontSize:"300"},errorToastMount:{position:"fixed",top:"90vh",height:"0px",width:"100%"}},Oe={menuItem:{...De,":hover":{backgroundColor:oe.L.colorNeutralBackground3Hover,"& rect":{fill:oe.L.colorNeutralStroke1Hover}},":hover:active":{backgroundColor:oe.L.colorNeutralBackground3Selected,"& rect":{fill:oe.L.colorNeutralStroke1Hover}},"& rect":{fill:"transparent"}},menuItemSelected:{...De,":hover":{backgroundColor:oe.L.colorNeutralBackground3Hover},":hover:active":{backgroundColor:oe.L.colorNeutralBackground3Selected},"& rect":{fill:oe.L.colorBrandForeground1}},chatHistoryButton:{..._e,width:"calc(100% - 32px)",alignSelf:"flex-end",...ke.Pt.padding("0px")},errorToastBody:{alignItems:"start",...ke.Pt.gap("5px")},errorToastIcon:{...ke.Pt.padding("5px")},errorToastText:{...ke.Pt.padding("5px","0px"),width:"200px",fontWeight:"600",fontSize:"300"},errorToastMount:{position:"fixed",top:"90vh",height:"0px",width:"100%"}},Re=(0,Ce.n)(Le),Me=(0,Ce.n)({...Le,...Oe});var Be=n(94754),Ne=n(60645),Ve=n(21515),He=n(32307),Ue=n(68953),je=n(36049),ze=n(25388),Ge=n(18603),We=n(38879),qe=n(58325),Qe=n(10145),Ke=n(56934),Ye=n(96895),$e=n(19399),Je=n(19385),Xe=n(92936),Ze=n(85023),et=n(18959),tt=n(82532);const nt=()=>p.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M13 13.5002C13 14.881 10.7614 16.0002 8 16.0002C5.23858 16.0002 3 14.881 3 13.5002C3 12.1195 3 11.5 3 11.5H13C13 11.5 13 12.3899 13 13.5002Z",fill:"url(#paint0_linear_378174_10334)"}),p.createElement("path",{d:"M13 11.5C13 12.8807 10.7614 14 8 14C5.23858 14 3 12.8807 3 11.5C3 10.1193 5.23858 9 8 9C10.7614 9 13 10.1193 13 11.5Z",fill:"url(#paint1_linear_378174_10334)"}),p.createElement("path",{d:"M13 9.50025C13 10.881 10.7614 12.0002 8 12.0002C5.23858 12.0002 3 10.881 3 9.50025C3 8.11953 3 7.5 3 7.5H13C13 7.5 13 8.38988 13 9.50025Z",fill:"url(#paint2_linear_378174_10334)"}),p.createElement("path",{d:"M13 7.5C13 8.88071 10.7614 10 8 10C5.23858 10 3 8.88071 3 7.5C3 6.11929 5.23858 5 8 5C10.7614 5 13 6.11929 13 7.5Z",fill:"url(#paint3_linear_378174_10334)"}),p.createElement("path",{d:"M13 5.50025C13 6.88096 10.7614 8.00025 8 8.00025C5.23858 8.00025 3 6.88096 3 5.50025C3 4.11953 3 3.5 3 3.5H13C13 3.5 13 4.38988 13 5.50025Z",fill:"url(#paint4_linear_378174_10334)"}),p.createElement("path",{d:"M13 3.5C13 4.88071 10.7614 6 8 6C5.23858 6 3 4.88071 3 3.5C3 2.11929 5.23858 1 8 1C10.7614 1 13 2.11929 13 3.5Z",fill:"url(#paint5_linear_378174_10334)"}),p.createElement("defs",null,p.createElement("linearGradient",{id:"paint0_linear_378174_10334",x1:"5.65236",y1:"12.6044",x2:"7.30179",y2:"16.2736",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{"stop-color":"#FFA43D"}),p.createElement("stop",{offset:"1","stop-color":"#FB5937"})),p.createElement("linearGradient",{id:"paint1_linear_378174_10334",x1:"13.0143",y1:"13.9981",x2:"8.70233",y2:"6.9433",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{"stop-color":"#FF8A69"}),p.createElement("stop",{offset:"1","stop-color":"#FFCD0F"})),p.createElement("linearGradient",{id:"paint2_linear_378174_10334",x1:"5.65236",y1:"8.60437",x2:"7.30179",y2:"12.2736",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{"stop-color":"#FFA43D"}),p.createElement("stop",{offset:"1","stop-color":"#FB5937"})),p.createElement("linearGradient",{id:"paint3_linear_378174_10334",x1:"13.0143",y1:"9.99806",x2:"8.70233",y2:"2.9433",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{"stop-color":"#FF8A69"}),p.createElement("stop",{offset:"1","stop-color":"#FFCD0F"})),p.createElement("linearGradient",{id:"paint4_linear_378174_10334",x1:"5.65236",y1:"4.60437",x2:"7.30179",y2:"8.27361",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{"stop-color":"#FFA43D"}),p.createElement("stop",{offset:"1","stop-color":"#FB5937"})),p.createElement("linearGradient",{id:"paint5_linear_378174_10334",x1:"13.0143",y1:"5.99806",x2:"8.70233",y2:"-1.0567",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{"stop-color":"#FF8A69"}),p.createElement("stop",{offset:"1","stop-color":"#FFCD0F"})))),ot={toolbar:{justifyContent:"space-between",...ke.Pt.padding("8px","6px","8px","6px")},switcherButton:{alignItems:"center",width:"32px",height:"32px",...ke.Pt.padding("8px","6px","8px","6px")},switcherButtonToggled:{fontSize:"20px",backgroundColor:oe.L.colorNeutralBackground1Selected,"&:hover":{backgroundColor:oe.L.colorNeutralBackground2Selected}},drawerHeader:{...ke.Pt.padding("0px")},drawer:{width:"-webkit-fill-available",justifyContent:"space-between",display:"flex",...ke.Pt.padding("13px","6px","8px","6px"),...ke.Pt.margin("0px")},drawerToolbar:{...ke.Pt.padding("0px")},label:{...ke.Pt.padding("3px","3px","3px","4px"),fontSize:"14px",lineHeight:"20px",alignSelf:"center",userSelect:"none",color:oe.L.colorNeutralForeground1},labelIcon:{...ke.Pt.padding("0px","0px","0px","4px"),maxWidth:"20px",maxHeight:"20px",alignSelf:"center"},toolbarButton:{fontSize:"20px",cursor:"initial"},toolbarButtonToggled:{fontSize:"20px",cursor:"initial",backgroundColor:oe.L.colorNeutralBackground1Hover},menuItem:{minHeight:"30px",height:"30px",display:"flex"},toolbarGroup:{display:"flex"},toolbarButtonsGroup:{display:"flex"},creditButton:{height:"26px",alignSelf:"center",fontWeight:oe.L.fontWeightRegular,whiteSpace:"nowrap"},creditTooltip:{maxWidth:"60%"},creditTitle:{marginBottom:"5px"}},rt={toolbar:{justifyContent:"space-between",cursor:"initial",...ke.Pt.padding("0px","0px","8px","0px")},drawer:{justifyContent:"space-between",display:"flex",...ke.Pt.padding("5px","0px","8px","0px"),...ke.Pt.margin("0px")},switcherButton:{alignItems:"center",width:"32px",cursor:"initial",height:"32px",...ke.Pt.padding("8px","6px","8px","6px"),"&:hover":{cursor:"initial",...ke.Pt.borderColor(oe.L.colorNeutralStroke1)}},switcherButtonToggled:{fontSize:"20px",cursor:"initial",backgroundColor:oe.L.colorNeutralBackground1Selected,"&:hover":{cursor:"initial",...ke.Pt.borderColor(oe.L.colorNeutralStroke1),backgroundColor:oe.L.colorNeutralBackground2Selected}},label:{...ke.Pt.padding("3px","3px","3px","4px"),fontSize:"16px",lineHeight:"20px",alignSelf:"center",userSelect:"none",fontWeight:oe.L.fontWeightSemibold,color:oe.L.colorNeutralForeground1},toolbarButtonsGroup:{display:"flex",gap:"8px"},toolbarButton:{fontSize:"20px",maxWidth:"24px",minWidth:"24px",maxHeight:"24px",borderRadius:"4px",cursor:"initial",...ke.Pt.padding("2px"),"&:hover":{...ke.Pt.borderColor(oe.L.colorNeutralStroke1),backgroundColor:oe.L.colorNeutralBackground1Hover,cursor:"initial","> span > svg":{color:oe.L.colorNeutralForeground2}}},toolbarButtonToggled:{fontSize:"20px",maxWidth:"24px",minWidth:"24px",maxHeight:"24px",borderRadius:"4px",cursor:"initial",...ke.Pt.padding("2px"),...ke.Pt.borderColor(oe.L.colorNeutralStroke1),backgroundColor:oe.L.colorNeutralBackground1Hover,"> span > svg":{color:oe.L.colorNeutralForeground2}}},it=(0,Ce.n)(ot),at=(0,Ce.n)({...ot,...rt}),st=(e,t)=>{switch(e){case"close":return p.createElement(ce.LMj,null);case"help":return p.createElement(Xe.XLu,null);case"expandOrCollapse":return t?p.createElement(Ze.rCp,null):p.createElement(Ze.lA0,null);default:return null}},lt={creditButtonText:ue.nK,creditButtonTooltipTitle:ue.T_,creditButtonTooltipBody:ue.f_,sharedHeaderCloseButtonLabel:ue.rU,sharedHeaderCollapseButtonLabel:ue.qK,sharedHeaderExpandButtonOptionsLabel:ue.Vw,sharedHeaderHelpButtonLabel:ue.Ub,sharedHeaderMoveButtonLabel:ue.aX,sharedHeaderResizeButtonLabel:ue.RC,sharedHeaderTaskPaneOptionsLabel:ue.eT,sharedHeaderActivateRealtimeVoiceButtonLabel:ue.Z0,sharedHeaderDeactivateRealtimeVoiceButtonLabel:ue.qV},ct=p.memo((({copilotList:e,isMenuOpen:t,onMenuStateChange:n,isDrawer:r,closeButton:i,closeButtonStyle:a,headerMenuButtonProps:s,afterFirstRender:c,showCreditButton:u,appPlatform:d,appName:h,eventLogger:g,shouldHideCopilotIconInHeader:f})=>{const m=(e=>{const t=(0,o.kQ)(lt);return p.useMemo((()=>({...t,sharedHeaderTaskPaneOptionsLabel:()=>e.closePane??t.sharedHeaderTaskPaneOptionsLabel()})),[t,e.closePane])})({closePane:i?.label}),y=e.find((e=>e.isSelected)),v=y?.name,C=y?.menuIcon,b=y?.menuIconUrl,E=y?.iconAltText,A=(0,o.Lh)(ue.cn),S=it(),I=at(),P="PC"===d?I:S,T=(0,ie.z)(P.toolbarButton,a),x=p.useRef(null),w=p.useRef(null),k=`https://go.microsoft.com/fwlink/?linkid=2281345&ref=${h}#credits`,[_,D]=p.useState(!1),F=s?.buttons?.find((e=>e.type===Be.y.Move)),L=!!F?.clickHandler;p.useEffect((()=>{c?.()}),[]),p.useEffect((()=>{window.requestAnimationFrame((()=>{t?w.current?.focus():x.current?.focus()}))}),[t]);const R=(e,t)=>{L&&(F?.clickHandler(),g?.(t),e.dataTransfer.setDragImage(new Image,0,0),e.preventDefault())},M=e=>{R(e,"Shared_Header_Drawer_Drag_Started")},B=(0,l.Y$)().isRealtimeVoiceEnabled,{modality:N,changeModality:V}=(0,Ne.f)(),H=B&&N===Ve.S.RealtimeVoice;if(r)return p.createElement(He.B,{className:P.drawerHeader},p.createElement(Ue.J,{draggable:L,className:P.drawer,onDragStart:M},p.createElement(je.M,{size:"large","aria-label":A,className:P.drawerToolbar},p.createElement(ze.$,{role:"presentation",className:P.toolbarGroup},p.createElement(Se.m,{withArrow:!0,positioning:"below",content:A,relationship:"label"},p.createElement(Ie.I,{className:P.switcherButtonToggled,icon:p.createElement(et.hO5,null),"aria-checked":!0,ref:w,onClick:e=>n(e,{open:!t})})))),u&&p.createElement(Ge.A,{openOnHover:!0,size:"small",positioning:"below-end"},p.createElement(We.W,{disableButtonEnhancement:!0},p.createElement(te.$,{appearance:"outline",size:"small",icon:p.createElement(nt,null),className:P.creditButton,onClick:e=>{g?.("Credit_Balance_Button_Clicked"),e.stopPropagation(),window.open(k,"_blank")},"aria-label":m.creditButtonText()},m.creditButtonText())),p.createElement(qe.H,{tabIndex:-1,className:P.creditTooltip,"aria-label":`${ue.T_} ${ue.f_}`},p.createElement("div",{className:P.creditTitle},p.createElement(Qe.E,{weight:"semibold"},m.creditButtonTooltipTitle())),p.createElement("div",null,p.createElement(Qe.E,null,m.creditButtonTooltipBody()))))));const U=f&&(!y?.id||"copilotChat"===y?.id),j=H?p.createElement(Se.m,{withArrow:!0,positioning:"below",content:A,relationship:"label"},p.createElement(Ie.I,{id:xe,className:P.switcherButton,icon:p.createElement(tt.nUb,null),ref:x,onClick:e=>{V(Ve.S.Chat)}})):p.createElement(Se.m,{withArrow:!0,positioning:"below",content:A,relationship:"label"},p.createElement(Ie.I,{id:xe,className:P.switcherButton,icon:p.createElement(et.hO5,null),ref:x,onClick:e=>n(e,{open:!t})}));return p.createElement(je.M,{"aria-label":A,className:P.toolbar,draggable:L,onDragStart:e=>{R(e,"Shared_Header_Toolbar_Drag_Started")}},p.createElement(ze.$,{role:"presentation",className:P.toolbarGroup},j,!U&&p.createElement("div",{className:P.labelIcon},b?p.createElement(Te.Z,{iconUrl:b,iconAltText:E}):C),v&&p.createElement(Ke.J,{weight:"semibold",className:P.label},v)),!H&&p.createElement(ze.$,{role:"presentation",className:P.toolbarGroup},p.createElement(K.W,{horizontal:!0,style:P.toolbarButtonsGroup,customProperties:{id:"TaskPaneToolbarButtons"}},s&&s.buttons&&p.createElement(Ye.W,{positioning:"below",open:_,onOpenChange:(e,t)=>{D?.(t.open)}},p.createElement($e.c,null,p.createElement(Se.m,{withArrow:!0,positioning:"below",content:m.sharedHeaderTaskPaneOptionsLabel(),relationship:"label"},p.createElement(Ie.I,{"data-unique-id":"TaskPaneOptionsBtnShared","aria-label":m.sharedHeaderTaskPaneOptionsLabel(),className:_?P.toolbarButtonToggled:P.toolbarButton,icon:p.createElement(O.geq,null),onClick:e=>{D?.(!_)}}))),p.createElement(Je.b,{className:s?.menuStyle},p.createElement(ae.c,null,s.buttons.map((e=>{const t=(0,ie.z)(P.menuItem,s?.menuItemStyle);return p.createElement(se.D,{key:e.type,className:t,onClick:t=>{g?.("Options_Menu_Button_Clicked",e.type),e.clickHandler?.()},icon:e.icon??st(e.type)??p.createElement("div",{style:{marginInlineStart:"20px"}})},e.label??((e,t,n)=>{switch(e){case Be.y.Close:return t.sharedHeaderCloseButtonLabel();case Be.y.ExpandOrCollapse:return n?t.sharedHeaderCollapseButtonLabel():t.sharedHeaderExpandButtonOptionsLabel();case Be.y.Help:return t.sharedHeaderHelpButtonLabel();case Be.y.Move:return t.sharedHeaderMoveButtonLabel();case Be.y.Resize:return t.sharedHeaderResizeButtonLabel();default:return""}})(e.type,m))}))))),i&&p.createElement(Se.m,{key:i.type,withArrow:!0,positioning:"below",content:m.sharedHeaderCloseButtonLabel(),relationship:"label"},p.createElement(Ie.I,{"aria-label":m.sharedHeaderCloseButtonLabel(),className:T,icon:i.icon??st(Be.y.Close),onClick:i.clickHandler,"data-unique-id":"TaskPaneCloseBtnShared"})))))})),ut={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAADAFBMVEVHcEw2MzMMFBcREA8FBAQBBQgaGhoFBggRFR0jISEFBANBQ0QNDQwIBwwlJSUPDg4IBgcLCgoODQxeYGhSU1M2NjNDQT4FM29ccXU2SlkVUmpSVVgHRE9ycW+acc6xfG6DkY2EVlGyhNxBQkZDQkXbnGtBP0WncWxNMDLTh1XNRhWOiYc2PEvsrXVLUoAwR3dWUGHncbDBLwrvnFc6ODtQZ4VHS2HNisbjfKvGZDszNEvgJyXxtoBeYGy8h6/KVi6ha8b0mUibcsr5tnsAAACnPhkAJ5n/8aj/86j/8Kj/8an/76j/86n/9qkbGx0AAAH/8Kn/w4ciISQeHiH/woUYGRr/xYslJSctKy0wLjIpKCo1MjV8Va8fHzaBWLL/xImKXrc5Njg9Oj3/x4X/yoooJzlDP0KFW7V3UaxQTVH//7azR3ZIRUj/6ZBwTajKm+z/7Xr/+7LiuPj/4pT/AADcsPTqx/3/64j/76nnv/r/w4z/zoAoKTHBkuTVixpqRqEZHSv/8bD/7YL/zpH20/8yMDzMOyHXqfL/5566iuH6hrBbWFz/yY7/4f/xzv/hlQD/vYRjYWb/7HKpe9beigD/1YqgPnP92v/RW5IiIi+Ua8bye6n/0prSou7/3pH/un3/+IbDUob/2o6wksEuPGXcZZrocKHRhSoLGQDQfBn/xojNbQf/7pf/pGEpMUb/9nmMY73/kVD/96/+chyuRoT7XAYzL6/DTxRgQpyTZcD9kbpaR63/4X7JbiByaW/9mcr/sW//9ZX/vnfTPACidM/HXgr/62b/8KHWfACtgNskMFb/2HPCChT/sGNGNrRKPJr/x273ux/ooABWS2u1c2H/2KTnQgsIHaTpDADVAAD2xP6eS5aJZoz/hTeHO3v+yluTf67+qdyCT6L1pTX/PwD/xp6lb3i2PFJybI13ZLD8yEj7JQDMrd2Fj+j+zLGpAQDoqtO5bsPXfrjHg0JWd9z4lgH7g2/87b28aD/ebADuAGi0cJGPSgD/AAsACwFHcEwnoIJ4AAABAHRSTlMAKAchFgsqAQQmESgfDigoGRwkJigkIRgOEh8rJxr+VyM0/t+MmcZCYHuGMP/Invs+8WPC7vy4pb5S8/vdU33GyNyP+uXmp/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A4zYaCgAAEalJREFUeNrsmF9IW3kWx6/RmGiMjY2tJmZqXRDHFped9mG3tGw7O+ze3JsEbiDkaSEPubBDisVLBIMBRQOShYDBjVJ2g7FCK0aDa1KNMHXRFP8MVqoFrWXG+mCdWVpoH8rM7OzTnnPu1fb5amdfesz/2H4/53vO+f1+V4b5GB/jY3yMj3GM0Cnxf1HWQ2iUwNe/HAeKazRardFYfhRGo1YLHL8EBGSu0YJ0iclUBVEBgc8mUwlgaMEL3YdNHtTLS0pMIFxcXPZeFBcDiKmkpFyLPnyw5CF3FCftysqi96KyUqaoMpEPug8kD8ZXkDhIGgyGaoo6uMMbxECICpNsw4nro3wVypM46NbVmY+iDqMaKRChChF0J5w+mF9VcRp9J3Gz1WqteRfwTsYABigGIBi1J2kCpm8ieczdbK2xWCzWhvr65kaK5ub6BhtiyAxoQ4XpJE3QayD94jKSB/Vao7m+seWLVNzjhxBFeIinvmhprK9TGNCFYjBBoz8p+yH9MjLfarVozc0tqTjoen0+r8/t8+Hd7U6LaU+qpbkBGRBBNuEkykD6lH41JK9tupzy+NNuj88LAKjs9njcGPBGFNPxlnpCIBNOhAD1wX5Kv1ZTfznlF1HNLWfvRvuBwCNTeNw+0XMNEWAkiqAMQHDs+qN+ZaXBYK3RN4B8GpN2d0K2ETESiaQLHqgGtgEwdMaBwJf2tDRZZBNOgEBH+tB9kH7zQsqDpvt8na+TEX9qYXo3NwOR253OLBTESMwTP+iE70Ux3ogmKB7ojjd/UH/S15shfQ+FOxLxLuy++G/7+/EqlymI4kEn/oJPTF9rsFjJA1P5caZRpzdi/xsMNUxTxpOm/9wTixSmX7S3v/gxNRjlnNks74hGUvhJOzCADdgOnnS83kgeVJiMx2hEvbYE5w/0r6z7X/uw4cVYYbe9fSYVlQIQkiRlsxK+lKKpHHyeEUXqSbcYr9daDUhQor4NoADUAFamad3v7sTUksnMq/bpKChmXU6WZTmW41jWbncBhJScBhcKET+NpUxAjai6CGgA6uvNGb887H5vjuSzLtRl7SzncHAQ8MzZs1IgCggZMebBORXj0AdAoN4CNOB0ZZHNov+cms/nfX0w80JEeZ4lYWBwHAXHu7KBwCAYJMZ8B6/Bg2s1NQZDZZlqC8CAYmqACwXs/3Q6cjCTYwMSD7ZzsijL0osQfsBxPAuV4MEjrAL+i0YNFUGlBbIBBpu+ej3sp20nkpuWAk7eaecVYQd7+ILqwHMO1hWQptvXY26a13iTxabeAh2OABpwGfTDsN5t7e9KUojjnU6nnZWlZRK4CTzo82iEPRDYbS/EaIc6aNFb5UHQqaoArkE2zSfrg+GwGA5HPD/0BIQQFN5plwHAdB4BQsAgwGvC4eyB7ItcLOb1ut2xWIOFViNVNdAbsQJWptk/CPJhMbkfDLggU57lUZ51UBMqJXCEBBY+Bx84qMJo+0IMtyxvslFnxRoY9apaABfBGubzQYzwoH8j4IIsnSDjVBhwDllWYAUgEAQWLcDvpMB0DmsAANeoBqqaQKfBRcCmNa4HRwlhIyRh+Z1kNfqvOMDBKIZCHLUkfQ8WDM+kcOHwRjrPWmgpUANAQ2jTN2wER5FgNJzlFQCBEEAX+95BIynQKCgAnCT9mMJDgzcWa9LaaBBVAzBXwgAABKNBSeBJnsNyYwCIvAyEHILsCG9n8XtXIJMR8cjkjV3RqwegIWAuhaPDQDA6HM2GsNN5GD5sfjCfh97nBJQXCIDWBRaHM1DI4IHN1xlpZmAlgDE4HsAwAbhgBlGSMIABbgKYwIdCoI+DSLWAXwGAMAJ4fV7xOAAl7wAgglEXZMthAUgbbyyHvU8FoMUQHwQohCtQWAB1iNgF5rg9cGkvGgwiQRTUBGwBuQNYZT3g2ZDcABy1Ic2GU1pP0ak5GT8WAI4h8+n+ChAEwQE7GU41ONQmMwRlL0ADaD6FLJtxY/6+rQUCULUWywsRAPzcigBAsCKgBYIQEuQewCWAAMh6bD/wgsV9MTC67sMLB+/WLgKUVahbiHAzrGQ+fbO2AvqtwdZoz+Hw0TgetSI0QciB2wI2IgDwWdd6HAG8yeSrSzqbypUQ9gLT6dJSfcOb/cko6gdbV4CAE4R30qy8MgmKA8oC6ZLCC9gAXu9WZueKxgZDoGYvoC48VVpuebO0ttIK8goBlCFE+bOyC/LaxCqBW7IUXKcJAANmdswWW1mxuu0Ym+B0aRXzxzf7i0BAAQTYCHAgcLJ2ZVtQGlNmQP3oQpz0I1vTO1c1NerPZFiDU6XMhXx+b3GS9DuAgFqA8gYLWPkdr0wB3JxH+t6twqudC4xVbQXkQTxVqm3I5yfWiKCjo7cDPHAqeyJ/aAD6Lu+QfFYaPtRPxmZ2tptqbWVVJSovz2gOSiuY60v5xIDsASBM8j1OpfQ0hO+HS2LDoE8TmIzknl29rq85pf7CAC5MwYFSpmF+XibowOhFBCiE8zB9wSHPhZCVnMOFOG0BPvdWLPdsZ7u+1lp2RvUFqtwDZVrmwsT8UmJtcVEm6GjrneR6epRFAfZC3IyEnmzPyvDGBun7fGLSPfPs6vZ163lzdZHaHsApOFVaeUbP/Ok/q/NLq3sji+QAeNAGDCvgw7sIRYNrGxsb4TT93SKZXNgG/b4b5y9erDYc41gO60DZWcb89PHq6tj8xP7AyGIvEbT1DkC0dbROQrROtsLbtY21NTi6+rx4/ShO7zzq295+/k292Ww2qD6WUwXOGJlfP376LyRYSuwhAkUbxMDy8jLelzsGlh9gAIDb44/EMjPPHvX1bQ89v/+782Zzndoa6MursAIMM/cYCBKJMTChHxFGjgjgBve2jrY2Alhb80eSaZR/1Pfw4dDzoft3L2ITQA30alug6Czzm24keJ7oB4L5icTL4MjIyNRUmxJEAAxbg70PHnQMpqZJXtG/f/v3FjM0gbrdkFqgqJz5w625ubnHT+fe9q+OoQurT14uT40QxeJPU6A/BT+tPy2OPFjby+2QfN/DPvAf4vZvawlA5YEENkNogRtfzhHB7HdgQlfX2DgybL5cXh6ZQgi8T40MLO9t/vDzw0ey/MPvh4Zu3r9z587tz2qt0IWqj2TQAlrm3F+6u7vnoA5P//22v78LYnwcarGaePJkc3Pz5Ut42HySWJ1Yyi/l+zBQfgjkb99GgE+qVQPAcQAB/vb3boq5x7Oz34719ye6ZAigyC8tTSxNTEwswfPE+MR4HrPvQ/2bqA+hAJjUA2iYr8/9ufsWANzqnvvq6ey3b/ufKAxd4315fOzK9+XHx8cAKQ/mo/s3Uf8uxj9qa6qPcSwnB3719T9BnaL71lezs93fIQM5MT4uc4x3wZQmEqt5Sh4D9O/du3f33mcaAlDbA7AOlTM3/nruy/+1bzahTWVRHL9JtR9o4xhtTEbaqU2IBYt14ReCLgbXCSSEfEsTeGmCxUAhgcALZpEQ2tJIiBCaklUz0lXIooix0G6ymGbhwrrSMtQuxEIL6rgYGBjmnHPfS6uze6/OwOC/5qN94O93z73v9eb23WcPZIMHz16Aw9Yr6IuXjx+9/P3xI57Hv/7x6r5El/lPnizeZOfgOqBCQHOM/RzfqAA7ipE8wOHp6sOtd+9eUd6929pZXX3428r9lQP+IuTJ4g3241kV03IQOMkuxtOlZnQnGg0EAtFAVMqD1dUXL148xcdTeF6FvHmzsvIFf3Fx9ieGy+Ynlc2KcTqi62IsXp1pNQM7gcD7gJzd3SgKRemFCoNOO6DAxx/wZ2dn4WHUwhDQK7oUS9Pyvn52Ix+faTUQGwjcC9y7B8+7u4FDIRl42dl59kZu/yzlJjOd1aiblmu62HAVDEoVAAP9i6AQhR8LPFh9s0L82dnnz5+DwCX8bKw7qXhajn2gP85uJNBgqDF5b3JycgIewObPUuAA+UQnmh9/kfkQKMCABntA4bT8+A+8BMbEdD6eHhmqTExM8q/JiQn5idD4At83KkMfP36S+Ovr68NMzUopTct5Ce6kUvlqeqbUqjSQKmWS+Pggl2azUhkqjcyk159/WKfcwRGgeJ2SrxWf0p0408vubheSWISZjdZQs9HgFg1JAt82tgHeInw8Xv2AAm/f/nl3eFj6ZaxirVhzdpBZ7PYlNKiCwkipNVSpNJvNxmQDA2+o6UBHfDpezScSibeQT3b75eFLfEKkeK1YhwUY9Czb7elsMpXI5z/vp0c2SiDRGmrsAhfRrVapVNogOuDzienp6dTr18B3tS/SrFjVWjEU4LLgAIOlbDY5Pb2/X02nZ2ZGNkDjcwmzsTEyMjLD6dU4xycL2SW7PRMUeAmUrhVTDxiMPbcEhxMMtgvlwuvpfAJ6Ih5Pg8Y+YAFMQTo0HvCpVDKZLWxD+4PB4K1hPilVulas150wsAs+t8Npc9ntsUS5XEimphPQFflqFT2k7FHPY9shyWw5scn5QeH2oOJBQKtkuhMwBH2iGwTAAIZiOVtIpYAEFqiBSeCoAzzBofjlApQf6k+xGIdVTEpRwMSswjiVwLVMCvPlbDKZTKEGmQBYYhO9jL1vX85wgfZ147CaSalON2BkZo/YFp2ZoIuKYF9Kzs/PlwuF5EFSxAb6fDmJeHsmk1ngFRhXI0BzQiO76vPVRYfT6XJJCu/3CvMoUc5mswX6ykLL0WrvPR63ZZwoIKDALePgGXWTUhDweHw0Dm1BuQr2zaW9Qnn+IOVycm9pkw7ZbE4swGEB5YvVsoAHBZy2TNCGVcjYeTa3tpco21ub0o+WXcB3ZhzIF9DglpYEFM8JUcDq7RhgqCdoQFL+kt8A3AV4ib+AfKFdtzIVH0xoVmxiFi+EGxxWcLmCtuXMMg/WJYh44DuALwqYYL12GQTUTUoN7LZfNugogAT8y8gq0vcAd3K+JCAI9dsML0TK14q7dQbWG/L7/QcGTmylzZYhqPREcQbbiHe4F0QI4ts1z6D2jOI/ndKklAaBHw1oHDjIIZixfR1qewb4brcP8LUar4GVGVVPSg3sSggyVhvziDVRUnAe1MIpBw8hHwS89bpXyEEPXGGDJxT+vaKzSmboZeZQKDxeG/N6a6LopjI4JIeFYAeNcDhMfG/OmxNAwcyMBjWTUlql0pxjZ8PhcGQshN0gwjWJHBYWHM52W2YT3u2o1Xyix5PLgWo9B7lABdCrWyvGT+gWEIiEQ3wkkIJbEBwOUZTRYtvNiw+XDE+t5s9RLLwAiielPVIJDIyZI5AwKHhRQeB1OEhdFHwYxMMpi4M2lxszM2aAjyV65ffRyCUwsd7IFCQyhW3zetp1pIk+KfVxUYIjXcLncuNG/rFEcQH4KOjiBqapTVSYCo+N4XUJYfW2LFDzyPScnxLyw7AdRH638r8WdC5Gp+hiYLoWi83FYrEpPhYg9XGPFB+1nPNDFH/o6iAOgO5T+tOqbqXCG3nQwGBkzBqbg1wjBX5x/CLU8k6svcTv1p8+pup2tp5eGgbUC8wSmysWi1IZwiGykMOxYUotHLYwZiI+fipSeTdbP14PucF581xxDRSKoDCFZwVpAFciyzGfZ9T/yO9Xe2cpN8BxYNAyNjpVXFt7v1acozpsXov8M+HIKGNaw4DuaPjcAMdBdx8WgY2a59YgUAeSwFpIiUwh/yrg6fSD8Xck/EMGUARU6LbGikVyAIniNW5BHpHI9SuIp+bD+D8aPh+JcDZKCvhfXrGYYzgW0KBTB/NlpPfI+K7Tx47s3mZ+Yy8WARXwlOxhPedHLdetZrw2mK3XLaPniWU0EB7Lf0Q39crXA7q1mSv0gYNJyw72duALPLQmoGuw9dT8o7qt+VARSEFyAAmDyWTE3R1ardEEbMPAQB81nvBH2nypmdpDCiCh69MMdKLp0yEc6FB8fnP90W8x6GwwAAcu8VWQ/s22F3QU+rmDHi0kEf4OfnQS6f3fDM87gjvwXSZ6OZ0dJv3fcovJIQct7fE5Bh4UeEM7fbTfni474GYf7fFDwdPhX95yxTd5SXus/pPtXt/zPd/zPf+X/A2C0RxvbxOJzQAAAABJRU5ErkJggg==",alt:"Credits teaching UI",style:{justifyContent:"center"}},dt={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAADAFBMVEVHcEzBvbvFvbrCvbrgwbzOvr3DvbzWwb7kw73bwL3CvrvBvLnCvLnAvbrAvrq9vLm+vLq7uri9u7nBvLq/vbu7u7m8vbupqam0srLEmNysp6u3t7bd2NWqqan9yZ/4yafIxsX2xaHdyMvi39729PKnpqbn4+Hixsrs6Obw7u36xqH7y6bMt9bv6+vz8fD/ypr2vafPvbPslcDsoMPp6d7pkMC/ld/kzN68tb7AwcvCpdXn4ePaz8z95Zb856/96a/95q//yZb/yJX08vH19PP+57Dx7+3r5+R4R5n96LH/ypp+TJz/ypjv7evs6efp5eLu6+nh2tf/yJLn4uDm4N3b1NDqz/fgxOzy8O/Lw7r+5JT+5InOxsDjye/dv+v49/bRycTj3dv+7rf+9b3mzfD+3qH+4p38+/rVzcjf19P/0ZvYtuhwRJT/2p7/zpTSquP/AADKvbX/06HbuumIU5/GuKhpP4/95rf/0pLyl7mZZrjDgADc0Mq0bC2/jtj0oMDUsOf/zZ3Lmt/Yy8PFwa/hz+SmPWe/dAH/5HrBsaH+7K6md8r/15n2qMuyhdDujLPVx72hbsL/8pL/16e0cxf/4Kf+5aD/tHDmeqf/vXy5idXTwrf/5aykPQTFSjXqg67TpOK4dx9MLJ+xOiX+3JKLWq/gb5/Lod+ve8urTgSAUJ7/zKT/y3/8gyucOWXYztD/755bP5dfOof+6af/xoqsYBnwv0b+6YvMW4vcztr+dgdFOo7+pmLPnHYQBIXXZJmwQ4LAUIDOhgX+iVnQu6v+lUOPOmVwVZA7HJNuS6OnChC/fDH/0oupQ1zlrSOqb2P6z2XKkVrQX5rTrJbTXUW6fkmOY3rZblfovem4TlL+soT/XQuvUivojXXngGH8z7Tss9fKFwXdr+WZPXvqo414ZYT/SACcbG2lVmf/2HzrwNToXwWNYrdlKInanQCMGXH/NgCqrOXXernvtqSHQIb/mQB2mOH/skWyVqt/AHGThqTuElR8sernrnrXvrpHcEwDabOqAAABAHRSTlMAFSAaAwkMAgEGECUyWjlRR29AK3iHZbOm/qaVoIyuYp16hbfpasdHz9XURb7o3OyT0tyz4vfgafjqrPPi//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8ArqxfkQAAD2VJREFUeNrsmWlMk3kex3uXllvALJsJiG9M1EQdx7kSStuELJS+2WYTs5CQbBuaTaWFLQQQUqRsFDJci6WUsoDcwx2OCoZbGC5FuRRXFG/FA9F1ZnZmZ7Ob/f2e52lp5R0PzCu+hfZ5WsL38//+f/8LGIw97WlPe9rTnva0LblR4vP51NWvaw6+HBeRIL+OO+kt+Egkxa4zgD1lzqUEt/hih9hdBqLxpDlnqw2fSzHsFgLVeC6XRxkwPY4Eh4CCj3gIqZ8hGXYFAcMn3Pl4xwoOOia3SwLfsmNBwSziB3cJAZuP9nh9JEgikRC2cupZjm/IZcagI1QMiLALzUd79nEJIbnDWeL0hsx4XEiksLMEZPMxfPcgicLhJ0F/nU4hlThjGINYJMLOETiazw1SbDZXo0dpdDoNIeCQyhUK7BpZEFi7QQg7VAjoD+OOwQhWKBSku+yhXq9TWAcn2vtB7RODFqtCg2+1Yp/IZMZgDGGHuoHwx/iDFNBIiRS+oeHWiXv/SXTWi/ZBm0bTKpciJIRAEuxABnZ/9jGFRIrdLTXqFYP3EhPfj68oTBWRkZHhFSbJyvh7gGi36PRGsiTkx4QkAX0A9Ocw/BTSh2AulYD9xPvEeytmpQqkJIVXphWg6rdoNERMEnkrCwlod4IbXyDgCRjuRHlB2/Qmy73EcT06homc9A1AKPXjkEKbXkfWaSt7BwjIAmTwbBAsRquTtSeOm53dxWL7VVikUmUaT3xh0Rixp4CAQZ8AOwA68zCUH8Qqedja/0IB9pvGYieJwiAGxfvEQY1R0voQCA7TBoAAuNABITboAShuvbG/v4K0p5wdBCIxSaRUiduBAHBhzMhC6BKQATDbFAqdQqczan4cBwPRlqaTBASVKEylHE+0aNBfKm0V4JToRjeAIDBHmX6aUCo3+5xMQOTwF1EMKlX7C5sR61DaGkQvAioAyl9v+zFcJd4EsNfBZgAisktUkffaNTIEkLVyIAJaADweIwRm+zSQ/ietKlzs5C527QrijhgOqrQXViOOGnlrMC4K2wbAHuAyDuNagwRtKpehT3E41aH9PaVqYkKDo1ZupDUQYBLiCvk8m16fn5+flt9mVoa7xG+PQOScASFVfr8Ni1Aia6UNwPCY1WqRIH821bn/7SXgNBQdH4uVynFy6pK3usMGabt9gCUgZHjOavVaBNAqPwYQiUUfDUP7J6pBCzkfG4/QBOAyQmZNWi0QaM2pjsxF9qKnmu9gsX+uslrIfRLsDOgBCBi/mTVrkUBrDhe7DkIHBzkPbiJAAjaLlCCQ0QVwY55oM2vjgCCOAHB2dx4Eos0nYhxYreTejS4Ah+/xZVtpXBwimF0CcLTfpQ/IVQKq0GLDBRF2Z7QA+AK+wPtLS6k5DhHMFWLXKnSuAkcPEA9lhYXYPUqN0mAaqwEsBXzh/q/+W1+BAOq4inBq/XMeBq4RUBjKfCuxfZAYVw7RWQzgOMD0/WppHgEwArF4y0AUORM4AgizKogalEm/P8SgsTF0EwhYvke/61UjgZqKYEsdOkVApiBSzlqJ/aNcb/mexaBxTnQTcN33H/jf0KuwOCcCZ2vnKcn+ECu1VnJnDNvn7+ntCAVcP0//vy/djK5Ae7W6lMxAvKUXXPxLreQBSmYafHaYJoDQz8fzxNJCb08F+BMEW0cCtSDZ52VlnMN/5cGzEHqbcg7P3Wuf/9LQ9flvetSgerW6IjU88uMFaXNdEEVC/tQB0mSbWH3GZPBpAQhYfl4+J5aGxl6RBOrQ6NLI1PDwrXsCMgtlWBrpL5WY5O0PnsGWjA6AG0fI8vLxPrA0dJskCA1VR9cjgmsZUJsxpTJSayPOjzAETLr2O6vPWDAL0ADgC5hQA/4HvhtCgk7MIBQUE10qToUYXLYCqamp5vy2NvL8KjGabO23Hqweh+0InQQ4XKaHt++BE78MDS0YcuY7e0rRPzo6OiYmtLQnMtVJYrN2tq1tViclJgA4wL2purO6+ltoBK1TAY/t4e3/yR+Hu4cWFgzNN3M7O0PVBAAggELVpSDIBW5ftc3Wp6Xp0F9v0k2A/4PVyZ/ZNEchCfDL8PDzoYXbhuaM3j5AiCYiAOXaFR2TW48CADjC6DWWN4+r7tx58PLfoydpAfAFQpaHj+fBmeHh4eWF69cN95vH5ikEKgNS9fBFANSnaUw6S//jx1W30P/p6IcdADgUMDM9MDD8fGEMEJqbx3pDLwJDX4yrQh/mR8M8lW8bfPP4Wl3VrVt3Xr4bHR0dOURrFuAigNfXDW+7uweGpxbGcgiEnI353IsXL3Ze7OsrTUWQvr6+mJ7Uns7oV/Ptj6+BfRUATL4bvXrl6uJBWrMAl4kAnxcDABAMrI1lXK+pMVxGht75XJKCUl/ufO9GTuU1yv8u+F9ZXLyy+Cn8HloAXgCQF9GdktLdPT38/PZYRg3o8uXmyubLGRsbN2/2om5ubIzlNFdW3q9DVVXdvTE5OXplpHFkcQQAOHwaAO5e3vsCC9ffpoC6B6anl29nZOQgQwlANFdeqyQE3pX3LxsMBiQg7CcvXB1pbGwcGTmFJyM3WgA+gZlEBKiB6YHnc4CQU1OCMlyrKwGSkrq6+4YaAwI0g33HZEfHhauLjWVlgHCKxtGMBPD0/jy7PD0lJT6eQOianp5awxhyckpKwJQAqTPUlOQYcjJq7t640QHu4H+lsezSpbKysk8ZblwBTYCj2Zl5M0gQT0B0dU3XTi3PAQRQZBiAJIPQ9bmXLzvQ/kLHDdIfAC6dZMDhhrNtAFgMPfd/XZ1dXtySEh8REU9CxHcNTNfWdk0tL6/Nrc3Nza2tLS9PxXe9fYfuINK/qKjo0qWigwzetgEYJIB/QEIWECQDAIp8AYyurtra2oFaSl2gH54+JQBI/7NFqENuzO0DwEyIa4FvQlZ1YHlxQ8TU84gokiJiaop6jbDnggEhwY27MP7QH1RUdJYpZAppAPDYfj6+/kezkCBvPWIqPorSVJSDxSmWiB+6YfoD/yLCH3Scy6aRAFGF+/YHBGRlZSVklzcVN8zYAVpa7FdIAg98jZqZmfl5kWz+uXPnzsJjH5sFANveE3CIPggIOHrmTFbCt5mFeenryS3JLaCoFuLZlaehYb246cMHyh91kunOFnLpnIyIgejreQaE3VCYV5zegAxRyckAQtHMAEByQ0N6enFeU3lm9inCvuBcQUEBm4f+fBrLEUTA8tgn/CI2KSkJQgjMLGwChvSGhmRKUS1AAk1PLy5uaiosLA/Mrq4uOPeogNAXWEc0/1LLY7Lc2azPzifFxiZhP2Rnlhc2NRUXAwVqfR2e4C6vEMzLMwOzv61OyHry6DXh//oz+v+s4AqZLDbnkz/86XxsLCI8SajODswsLy+EJFBNeU1N2PLC8szMwEBwT8g6cyYp6cmjR48KXv/1bwdpAuCf6aCM/X73+7/8+fzp06djY//xr38+qf5/++bvm7oVxfGHKaQBjMEESABLUQgUpCZTt9cNCyawETE/pBCwhIRRhwg9saGnKJiBjbksb8vIzM5/8JbMHbu9pVOHnnPudYKenjrU7pvyJRCHSPl87jkmXJvrp6ezs7OPsE/+TvmIbBr7/QPh7+46nefnP+f2bOH60xrogBDIac2hPVz2+/B3//7yDK/J+/unT5/O/np8fEQyBOA49t8eGL7T7y/Xs9lqf+G6A/6w4H/fMo2e3dv1IZ0PHegEov64/3Lv5IEN/QP2Ceidfnu3n+33s88L1x0QEsJPunYzGYLBtt8e9bETHdohyOMlBEc6pN3fzlaz6XS/2oTdCUAHIkJO16AEw9uevd6N2tgIlruDQFk6DN4ftdvLzWq130A+b9xNSuG/QDgaLjZMKIE1BIWetRy1RyNsxYtHZ8m/Ex3xCxz+Zr1eb/bTn91NSkP+hJz4RW9ommncggFXaEMrRoQDkSW4LGET02Z44i8Wi/Vm8yv8Q//RhQBMyyNXul7TWk0DaoBFsIc75tAeHaaNWW43hJ8Cfj6fL9brubtJKUxIJPmqXoca3KBBD4oA+0JvuN0x4kGWy+3aBjrgYfjzuYEGC4MmpW6OC6TYVZUMTFYDUujZtt1bbHe7JWW33Q43NowdBz/tEX4ymRjzxdzABRUuJqUwJZNKlSqvwcSwLDJwJOyVTY8w7tmM4L3b24XF+GgwL7qflBbyarUKAjUy2FrW8NUBY0+dIH1oWUhvYsBgm3M/KS1cqF3HwASFVwcA9g7C6AxvmjemCQpN8Z0Hk1K12+2CAXShxRWYAy8EBX6yrFvDcPCU5u5GCPqCAVeTUileKA6YQQOKgApNAwMSmCHcLBz5nNMJzw3M/LHrSWksrlxwAV1v1TRUMFmDScPgmXA4olsQrdWCLdEnuBDgO0FSKQ0qFdgNqvUGFgH/tEkSqAF9Zmiim0TXWFpaEd5M3cyKj9hZKiU5AAMsAu4IqMCGd7MjJoUV3TQZvVaDL7hL4YQQCvz3U4X8wCCr5EEADagPoEBl0Fo8N6jDtwmOdEwuHE24mpY7r4NTpTxQKy9FAAUmwerMTOgHGjj8UodbrVGKRCNhNx1wSiAmM9nLgQoK3Soq4K5AChjkmqzsxG7oLA39fUyWXRbAOTxMJdNkoLI+oAN1gonAm3WjxreJXYebXtXEWCwiuCuA85YsxbPp7NXYUegyhYamY7HZnQ8cnq/jy6VavRIlKRp2WwA6XYsnitCgxA2YAmLqVAoHzOGUbkksiNQAV2fLnYkhGiTTmfx4PHh16DLUC5qT4VatdHPAZw1wv5gLDg78ZHCaPi+PyaHiOHwzqlo+KcQ949PhCRqkTk7TmdwlKWAd6EXxlQY8NVAvcwUlLspe8fkBUjgSE7EImdz1+MABS3EQePo6F1eUuCQnPOM7h2gRGYqQBYXz4iU5qCpz4AH4oFq8UAAvxmD/945PH6MH8RAhJqZOoArp0/P8tTrmlXCilvPnSUXJnqQkKD/u/z94uKwVF/T48CM8VIAyoEQuXypfX0Kuy8V87jyrZDLZJOFx+IFjjxf24oIWPypIYhwdUAKSeckp0OMi4gUfDv/oncc54goRGRxSIJFMZsEDkgU2wFOiFIvi6EPBY4/XNb8uKwqGfP5wIhJFCTGVSsUx8F0EuAx0gfCedv+rJRXMQUCJqCzHKLIM7EiC0QOerGT9VwVy8PnBApNIwIMg+AGO9P+n+N9wCASDoRB4UGArGAww+ve6zOPgMovjALu64ujoe17o4lzqwvN9r7J5y1ve8pa3eJt/AHx8Fr2ymgCjAAAAAElFTkSuQmCC",alt:"Credits teaching UI",style:{justifyContent:"center"}},pt={teachingCalloutHeaderText:ue.s1,teachingCalloutPrimaryButtonText:ue.$k,creditsTeachingCalloutBodyText:ue.zx,creditsTeachingCalloutTitleText:ue.Ps,paneSilhouetteSeeLessGPTsLabel:ue.Dc,paneSilhouetteSeeMoreGPTsLabel:ue.XC,newConversationButtonTextDesc:ue.kd},ht=({isMenuOpen:e,onMenuStateChange:t,handleCopilotChatChange:n,copilotList:r,showLoadingShimmer:i,paneSilhouetteHeaderProps:a,switcherMenuChatHistoryProps:s,featureFlags:l,appPlatform:c,menuErrorProps:u,setShowCreditsTeachingCallout:d,showCreditsTeachingCallout:h,appName:g,eventLogger:f,isDarkMode:m})=>{const y=Re(),v=Me(),C="PC"===c?v:y,b=(0,o.kQ)(pt),E=(0,Y.P)(),[A,S]=p.useState(!1),I=p.useMemo((()=>r.filter((e=>!e.isLink&&!e.isHandledExternally))),[r]),P=p.useMemo((()=>r.filter((e=>e.isLink))),[r]),T=p.useMemo((()=>r.filter((e=>e.isHandledExternally))),[r]);let x=I,w=I.length>5;w&&!A&&(x=I.slice(0,5));const k=A?p.createElement(O.nbk,null):p.createElement(O.geq,null),_=s&&s.isSwitcherMenuChatHistoryPanelOpen&&s.chatHistoryContainer,D=b.teachingCalloutHeaderText(),F=b.teachingCalloutPrimaryButtonText(),L=b.creditsTeachingCalloutBodyText(),R=b.creditsTeachingCalloutTitleText(),M=b.paneSilhouetteSeeLessGPTsLabel(),B=b.paneSilhouetteSeeMoreGPTsLabel(),N=b.newConversationButtonTextDesc(),V=p.useRef(null),H=window.innerWidth?window.innerWidth:628,U=(0,$.Bi)("toaster"),{dispatchToast:j}=(0,J.J)(U);return p.useEffect((()=>{u?.showErrorMessage&&!i&&j(p.createElement(X.y,null,p.createElement(Z.S,{action:p.createElement(ee.M,null,p.createElement(te.$,{appearance:"subtle",size:"small",icon:p.createElement(ce.Avk,null)}))},u?.errorMessage)),{intent:"info",timeout:3e3,onStatusChange:(e,{status:t})=>{"unmounted"===t&&u?.onErrorMessageDismiss?.()}})}),[u?.showErrorMessage,i]),p.createElement(p.Fragment,null,l.isCreditsUIEnabled&&h&&p.createElement(Ee,{headerText:D,title:R,bodyText:L,primaryButtonText:F,image:m?ut:dt,anchorId:xe,onCloseFre:e=>{d?.(!1)}}),p.createElement(ct,{isMenuOpen:e,onMenuStateChange:t,copilotList:r,isDrawer:!1,appPlatform:c,...a}),p.createElement(ne.e,{...E,style:{width:`${H}px`,backgroundColor:oe.L.colorNeutralBackground3},position:"start",open:e,onOpenChange:(e,n)=>t(e,{open:n.open})},p.createElement(ct,{isMenuOpen:e,onMenuStateChange:t,copilotList:r,isDrawer:!0,appPlatform:c,appName:g,...a}),p.createElement(re.y,{className:C.drawerBody},i?p.createElement(Ae.Y,null):_?s.chatHistoryContainer({onPaneClose:s.handleChatHistoryPanelClose}):p.createElement("div",{className:(0,ie.z)(C.menuContainer)},p.createElement(ae.c,{style:{width:"100%"}},x.map((e=>p.createElement(we,{copilot:e,key:e.id,handleCopilotChatChange:n,onMenuStateChange:t,copilotListStyle:C,switcherMenuChatHistoryProps:s,newChatLabel:N}))),w&&p.createElement(se.D,{key:A?M:B,icon:k,onClick:()=>{S(!A),window.requestAnimationFrame((()=>V.current?.focus())),f?.(A?"See_More_Clicked":"See_Less_Clicked",x.length.toString())},ref:V,"aria-label":A?M:B,className:C.menuItemSeeMore},A?M:B),T.map((e=>p.createElement(we,{copilot:e,key:e.id,handleCopilotChatChange:n,onMenuStateChange:t,copilotListStyle:C,switcherMenuChatHistoryProps:s,newChatLabel:N}))),P.map((e=>p.createElement(we,{copilot:e,key:e.id,handleCopilotChatChange:n,onMenuStateChange:t,copilotListStyle:C,switcherMenuChatHistoryProps:s,newChatLabel:N})))),p.createElement(K.W,null,s&&p.createElement("div",{className:(0,ie.z)(C.chatHistoryButton)},p.createElement(de.r,{onClick:()=>{s.onClickShowChatHistoryPanel(),s.setIsSwitcherMenuChatHistoryPanelOpen(!0)}})),u?.showErrorMessage&&p.createElement("div",{style:{position:"relative"}},p.createElement(le.l,{inline:!0,toasterId:U,position:"bottom"})))))))};var gt=n(24762),ft=n(6049),mt=n(78735),yt=n(18850);const vt=(0,yt.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.CopilotLabel"),Ct=()=>{const e=(0,o.Lh)(vt);return e||"Copilot"};var bt=n(95113),Et=n(90326),At=n(26532),St=n(29328);const It=()=>p.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("path",{d:"M14.1437 3.34932C13.9101 2.54966 13.177 2 12.3439 2L11.7427 2C10.8467 2 10.0758 2.634 9.90296 3.51321L8.85352 8.85006L9.15094 7.89102C9.39431 7.1063 10.1202 6.57143 10.9418 6.57143L14.2351 6.57143L15.6352 7.74347L16.8818 6.57143H16.4905C15.6574 6.57143 14.9242 6.02177 14.6907 5.22211L14.1437 3.34932Z",fill:"url(#paint0_radial_725_52234)"}),p.createElement("path",{d:"M6.0492 16.6427C6.28017 17.4462 7.01519 17.9997 7.85121 17.9997H9.07497C10.0844 17.9997 10.9126 17.2006 10.9488 16.1918L11.1295 11.1426L10.842 12.0951C10.6031 12.8867 9.87385 13.4283 9.04701 13.4283L5.73383 13.4283L4.34959 12.5431L3.32812 13.4283H3.71324C4.54926 13.4283 5.28427 13.9818 5.51524 14.7853L6.0492 16.6427Z",fill:"url(#paint1_radial_725_52234)"}),p.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint2_linear_725_52234)"}),p.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint3_linear_725_52234)"}),p.createElement("path",{d:"M7.74902 17.9997H14.3115C16.1865 17.9997 17.3114 15.603 18.0614 13.2063C18.95 10.3668 20.1127 6.56934 16.7489 6.56934H13.8877C13.0557 6.56934 12.3238 7.11559 12.088 7.91346C11.5946 9.58288 10.7343 12.48 10.0582 14.687C9.71358 15.812 9.42651 16.7782 8.98593 17.3799C8.73893 17.7172 8.32725 17.9997 7.74902 17.9997Z",fill:"url(#paint4_radial_725_52234)"}),p.createElement("path",{d:"M7.74902 17.9997H14.3115C16.1865 17.9997 17.3114 15.603 18.0614 13.2063C18.95 10.3668 20.1127 6.56934 16.7489 6.56934H13.8877C13.0557 6.56934 12.3238 7.11559 12.088 7.91346C11.5946 9.58288 10.7343 12.48 10.0582 14.687C9.71358 15.812 9.42651 16.7782 8.98593 17.3799C8.73893 17.7172 8.32725 17.9997 7.74902 17.9997Z",fill:"url(#paint5_linear_725_52234)"}),p.createElement("defs",null,p.createElement("radialGradient",{id:"paint0_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.7128 8.89484) rotate(-129.141) scale(7.20751 6.76953)"},p.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),p.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),p.createElement("stop",{offset:"1",stopColor:"#0736C4"})),p.createElement("radialGradient",{id:"paint1_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.74347 13.4005) rotate(51.7328) scale(6.58647 6.39483)"},p.createElement("stop",{stopColor:"#FFB657"}),p.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),p.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),p.createElement("linearGradient",{id:"paint2_linear_725_52234",x1:"5.29507",y1:"3.38547",x2:"6.17192",y2:"13.8705",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),p.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),p.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),p.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),p.createElement("linearGradient",{id:"paint3_linear_725_52234",x1:"6.11337",y1:"2",x2:"6.59201",y2:"13.4355",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{stopColor:"#3DCBFF"}),p.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),p.createElement("radialGradient",{id:"paint4_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.0861 5.45023) rotate(109.881) scale(15.2451 18.7446)"},p.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),p.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),p.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),p.createElement("linearGradient",{id:"paint5_linear_725_52234",x1:"17.6045",y1:"5.87149",x2:"17.5982",y2:"8.9847",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),p.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"})))),Pt=e=>xt(e)?r.a5.GetCachedGPTDetails:r.a5.GetCachedGPTList,Tt=e=>xt(e)?r.a5.GetGPTDetailsTimeout:r.a5.GetGPTListTimeout,xt=e=>e===d.S.GetGPT;var wt,kt=n(58651);!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"}(wt||(wt={}));const _t=e=>({id:mt.r9,name:e,isSelected:!0,copilotType:A.NV.Default,menuIcon:p.createElement(It,null)}),Dt=e=>!e||e===mt.r9,Ft=e=>({id:mt.NY,name:e,isSelected:!1,isLink:!0,linkURL:mt.Vh,menuIcon:p.createElement(St.zVV,null)}),Lt=e=>({id:mt.UM,name:e,isSelected:!1,isHandledExternally:!0,menuIcon:p.createElement(St.zVV,null)});function Ot(e){return e.map(((e,t)=>({item:e,index:t}))).sort(((e,t)=>{if(void 0===e.item.copilotType&&void 0===t.item.copilotType)return 0;if(void 0===e.item.copilotType)return 1;if(void 0===t.item.copilotType)return-1;const n=A.p8[e.item.copilotType]-A.p8[t.item.copilotType];return 0!==n?n:e.index-t.index})).map((({item:e})=>e))}const Rt=(e,t)=>t!==A.NV.CustomGPT?void 0:e;let Mt=!1;function Bt(e){Mt=e}const Nt=(e,t)=>{Mt&&(null==t?kt.log("CopilotSwitcherContainer Log:",e):kt.log("CopilotSwitcherContainer Log:",e,t))},Vt=(e,t,n,o,i,a,s)=>{const l=[{key:r.h3.UserQueryGuid,value:s},{key:r.h3.SelectedSwitcherMenuItemId,value:i},{key:r.h3.Cv,value:a}];switch(t){case E.GPTRequest:Gt(n).sendTelemetryChatEventData([...l,{key:r.h3.ChatEventType,value:e===d.S.GetGPT?r.a5.GetGPTDetailsRequest:r.a5.GetGPTListRequest}]);break;case E.GPTResponse:{const t=[...l,{key:r.h3.ChatEventType,value:e===d.S.GetGPTList?r.a5.GetGPTListResponse:r.a5.GetGPTDetailsResponse}];o&&e===d.S.GetGPTList&&t.push({key:r.h3.ChatEventParameters,value:o}),Gt(n).sendTelemetryChatEventData(t)}break;case E.GPTError:Gt(n).sendTelemetryErrorData([...l,{key:r.IC.ErrorCategory,value:e===d.S.GetGPT?r.a5.GetGPTDetailsError:r.a5.GetGPTListError},{key:r.IC.ErrorMessage,value:o}]);break;case E.GetCachedGPT:((e,t,n,o)=>{const i=[...n,{key:r.h3.ChatEventType,value:Pt(t)}];o&&!xt(t)&&i.push({key:r.h3.ChatEventParameters,value:o}),Gt(e).sendTelemetryChatEventData(i)})(n,e,l,o);break;case E.GPTTimeout:((e,t,n,o)=>{Gt(e).sendTelemetryErrorData([...n,{key:r.IC.ErrorCategory,value:Tt(t)},{key:r.IC.ErrorMessage,value:o}])})(n,e,l,o);break;case E.GPTListUserPerceivedLatency:((e,t,n)=>{Gt(e).sendTelemetryLatencyData([...t,{key:r.CT.RequestSignalType,value:r.a5.GetGPTListUserPerceivedLatency},{key:r.CT.FeatureName,value:r.Z_.Extensibility},{key:r.CT.SubFeatureName,value:r.EF.DeclarativeCopilots},{key:r.CT.UserPerceivedLatency,value:n}])})(n,l,o);break;case E.GPTLatency:Gt(n).sendTelemetryLatencyData([...l,{key:r.CT.RequestSignalType,value:e===d.S.GetGPT?r.a5.GetGPTDetailsLatency:r.a5.GetGPTListLatency},{key:r.CT.FeatureName,value:r.Z_.Extensibility},{key:r.CT.SubFeatureName,value:r.EF.DeclarativeCopilots},{key:r.CT.UserPerceivedLatency,value:o}]);break;case E.OpenAgentFromMOS:((e,t,n)=>{Gt(e).sendTelemetryChatEventData([...t,{key:r.CT.RequestSignalType,value:r.a5.OpenAgentFromMOS},{key:r.CT.FeatureName,value:r.Z_.Extensibility},{key:r.CT.SubFeatureName,value:r.EF.DeclarativeCopilots},{key:r.CT.UserPerceivedLatency,value:n}])})(n,l,JSON.stringify({aapId:JSON.parse(o).appId,action:JSON.parse(o).action}))}},Ht=(e,t,n,o)=>{Gt(e).sendTelemetryErrorData([{key:r.IC.ErrorCategory,value:t},{key:r.IC.ErrorMessage,value:n},{key:r.IC.ErrorCode,value:o}])},Ut=()=>bt.w.getInstance().getQueryCv()??(0,Et.N)(),jt=e=>e.find((e=>e.isSelected)),zt=(e,t)=>{const n=e.filter((e=>e.copilotType===A.NV.CustomGPT));Gt(t).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.NumInstalledDCs},{key:r.h3.ChatEventParameters,value:n.length??0}])};const Gt=e=>{const t=At.j.getInstance();return At.j.setTelemetryHandler(e),t},Wt=e=>{const{gptListProps:t,fetchGPTList:n,copilotSwitcherOpenRequest:o,setCopilotSwitcherOpenRequest:r,updateCurrentSelectedGPTId:i,gptTelemetryHandler:a}=e,s=p.useRef(0),l=p.useCallback((()=>{(async()=>{var e;await(e=mt.A0,new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))),n()})()}),[n]),c=p.useCallback((e=>{let a,c=t.copilotSwitcherMenuItemProps;if(!o||!r)return c;const d=c.find((e=>o.appId?e.metaOSAppId===o.appId:e.id.includes(o?.titleId)));return d?(e.isSelected=!1,c=c.map((e=>({...e,isSelected:e.id===d?.id}))),r(null),s.current=0,i&&i(d),a=wt.Success):(s.current++,1==s.current?n():s.current<=3?l():(r(null),s.current=0,a=wt.Failure)),u(a),c}),[t,o,r]),u=e=>{const t={appId:o.appId,action:e};a?.(void 0,E.OpenAgentFromMOS,JSON.stringify(t))};return c};const qt=(0,yt.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterTitle1"),Qt=(0,yt.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterText1"),Kt=(0,yt.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterTitle2"),Yt=(0,yt.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterText2"),$t=()=>{const e=(0,o.kQ)({defaultConversationStarterTitle1:qt,defaultConversationStarterText1:Qt,defaultConversationStarterTitle2:Kt,defaultConversationStarterText2:Yt});return[{suggestionText:e.defaultConversationStarterText1(),suggestionCategory:e.defaultConversationStarterTitle1(),iconRegular:O.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1},{suggestionText:e.defaultConversationStarterText2(),suggestionCategory:e.defaultConversationStarterTitle2(),iconRegular:O.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}]};var Jt=n(19016);const Xt=(0,n(92782).Q)(Jt.zQ),Zt={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:"transparent"},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:"transparent"},chatUiStackItemInContainer:{position:"relative",height:"100%"},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:Xt.colorNeutralStroke1Selected,...ke.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:Xt.colorNeutralForeground3,...ke.Pt.borderRadius("20px"),...ke.Pt.border("2px","solid",Xt.colorNeutralBackground2Hover),":hover":{backgroundColor:Xt.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:Xt.colorNeutralBackground2Hover,...ke.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:Xt.colorNeutralStroke1Selected,...ke.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:Xt.colorNeutralForeground3,...ke.Pt.borderRadius("20px"),...ke.Pt.border("2px","solid",Xt.colorNeutralBackground2Hover),":hover":{backgroundColor:Xt.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:Xt.colorNeutralBackground2Hover,...ke.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},incomingShimmerCard:{alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative",...ke.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...ke.Pt.margin("10px")},outgoingShimmerCard:{alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative",...ke.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...ke.Pt.margin("10px","20px","0px","10px")},incomingShimmerCardWrapper:{...ke.Pt.borderRadius("8px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.margin("4px","16px","16px","48px"),justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:Xt.colorNeutralBackground1},outgoingShimmerCardWrapper:{...ke.Pt.borderRadius("8px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.margin(0,"16px"),height:"124px",opacity:"0.8",backgroundColor:Xt.colorNeutralBackground1},inputBox:{...ke.Pt.borderRadius("8px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.margin(0,"16px"),height:"75px",opacity:"0.8",backgroundColor:Xt.colorNeutralBackground1,display:"flex",flexDirection:"column",...ke.Pt.padding("10px"),justifyContent:"space-between"},pills:{...ke.Pt.borderRadius("5px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:Xt.colorNeutralBackground1,width:"60%"},smallPills:{...ke.Pt.borderRadius("5px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:Xt.colorNeutralBackground1,width:"50%"},bottomContainer:{display:"flex",flexDirection:"column",...ke.Pt.gap("10px")},pillsContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",...ke.Pt.gap("10px"),justifyContent:"end",...ke.Pt.margin(0,"16px"),alignItems:"center"},inputText:{width:"85%"},inputButton:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},en={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:oe.L.colorTransparentBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:oe.L.colorTransparentBackground},chatUiStackItemInContainer:{position:"relative",height:"100%"},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:oe.L.colorNeutralStroke1Selected,...ke.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:oe.L.colorNeutralForeground3,...ke.Pt.borderRadius("20px"),...ke.Pt.border("2px","solid",oe.L.colorNeutralBackground2Hover),":hover":{backgroundColor:oe.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:oe.L.colorNeutralBackground2Hover,...ke.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:oe.L.colorNeutralStroke1Selected,...ke.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:oe.L.colorNeutralForeground3,...ke.Pt.borderRadius("20px"),...ke.Pt.border("2px","solid",oe.L.colorNeutralBackground2Hover),":hover":{backgroundColor:oe.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:oe.L.colorNeutralBackground2Hover,...ke.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},incomingShimmerCard:{alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative",...ke.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...ke.Pt.margin("10px")},outgoingShimmerCard:{alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative",...ke.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...ke.Pt.margin("10px","20px","0px","10px")},incomingShimmerCardWrapper:{...ke.Pt.borderRadius("8px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.margin("4px","16px","16px","48px"),justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:oe.L.colorNeutralBackground1},outgoingShimmerCardWrapper:{...ke.Pt.borderRadius("8px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.margin(0,"16px"),height:"124px",opacity:"0.8",backgroundColor:oe.L.colorNeutralBackground1},inputBox:{...ke.Pt.borderRadius("8px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.margin(0,"16px"),height:"75px",opacity:"0.8",backgroundColor:oe.L.colorNeutralBackground1,display:"flex",flexDirection:"column",...ke.Pt.padding("10px"),justifyContent:"space-between"},pills:{...ke.Pt.borderRadius("5px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:oe.L.colorNeutralBackground1,width:"60%"},smallPills:{...ke.Pt.borderRadius("5px"),...ke.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...ke.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:oe.L.colorNeutralBackground1,width:"50%"},bottomContainer:{display:"flex",flexDirection:"column",...ke.Pt.gap("10px")},pillsContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",...ke.Pt.gap("10px"),justifyContent:"end",...ke.Pt.margin(0,"16px"),alignItems:"center"},inputText:{width:"85%"},inputButton:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},tn=(0,Ce.n)(Zt),nn=(0,Ce.n)(en),on=(e,t)=>{if(t)for(const n in e)e[n]=(0,ie.z)(e[n],t[n]);return e};var rn=n(87354),an=n(71961);const sn=e=>{const{className:t}=e,n=tn();return p.createElement(K.W,{style:t},p.createElement(rn.E,null,p.createElement("div",{className:n.incomingShimmerCardWrapper},p.createElement("div",{className:n.incomingShimmerCard},p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}))),p.createElement("div",{className:n.outgoingShimmerCardWrapper},p.createElement("div",{className:n.outgoingShimmerCard},p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_}),p.createElement(an.H,{size:mt.z_})))),p.createElement(rn.E,null,p.createElement("div",{className:n.bottomContainer},p.createElement("div",{className:n.pillsContainer},p.createElement("div",{className:n.smallPills},p.createElement(an.H,{size:mt.it})),p.createElement("div",{className:n.pills},p.createElement(an.H,{size:mt.it})),p.createElement(an.H,{shape:"circle",size:mt.z_})),p.createElement("div",{className:n.inputBox},p.createElement("div",{className:n.inputText},p.createElement(an.H,{size:mt.z_})),p.createElement("div",{className:n.inputButton},p.createElement(an.H,{size:mt.z_,shape:"circle"}),p.createElement(an.H,{size:mt.z_,shape:"circle"}))))))};var ln=n(20505),cn=n(4396);const un=()=>p.createElement("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},p.createElement("g",{clipPath:"url(#clip0_4437_102859)"},p.createElement("path",{d:"M43.2727 4H20.6421C16.8051 4 14.2003 7.90009 15.67 11.4445L27.445 39.8402C29.1305 43.905 34.8911 43.8971 36.5656 39.8277L48.2505 11.4309C49.7082 7.88834 47.1035 4 43.2727 4Z",fill:"url(#paint0_radial_4437_102859)"}),p.createElement("circle",{cx:"32",cy:"36",r:"22",fill:"url(#paint1_radial_4437_102859)"}),p.createElement("circle",{cx:"32",cy:"36",r:"22",fill:"url(#paint2_radial_4437_102859)",fillOpacity:"0.5"}),p.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M45.7494 18.8244L37.0286 40.0181C35.1844 44.4998 28.84 44.5085 26.9837 40.0318L18.2051 18.8619C18.3398 18.7533 18.4759 18.6462 18.6132 18.5407L27.4455 39.8403C29.1311 43.9051 34.8917 43.8972 36.5662 39.8278L45.3404 18.5044C45.4781 18.6095 45.6144 18.7162 45.7494 18.8244Z",fill:"url(#paint3_linear_4437_102859)"}),p.createElement("path",{d:"M45.3348 18.5059C41.6592 15.6919 36.9872 14 32.0006 14C26.9787 14 22.3036 15.6917 18.6152 18.5419L27.4252 39.8402C29.1108 43.905 34.8714 43.8971 36.5459 39.8278L45.3348 18.5059Z",fill:"url(#paint4_radial_4437_102859)"}),p.createElement("path",{d:"M38.2732 17.9193C38.4165 17.9308 38.5419 17.8239 38.5534 17.6806C38.5649 17.5374 38.458 17.4119 38.3147 17.4004C38.1714 17.389 38.046 17.4958 38.0345 17.6391C38.023 17.7824 38.1299 17.9079 38.2732 17.9193Z",fill:"url(#paint5_linear_4437_102859)"}),p.createElement("path",{d:"M24.401 19.4206C24.5443 19.4321 24.6697 19.3252 24.6812 19.1819C24.6927 19.0386 24.5858 18.9131 24.4425 18.9017C24.2992 18.8902 24.1737 18.9971 24.1623 19.1404C24.1508 19.2837 24.2577 19.4091 24.401 19.4206Z",fill:"url(#paint6_linear_4437_102859)"}),p.createElement("path",{d:"M40.2277 22.8628C40.2086 23.1017 39.9995 23.2798 39.7607 23.2607C39.5219 23.2416 39.3437 23.0325 39.3629 22.7936C39.382 22.5548 39.5911 22.3767 39.8299 22.3958C40.0687 22.4149 40.2468 22.624 40.2277 22.8628Z",fill:"url(#paint7_linear_4437_102859)"}),p.createElement("path",{d:"M24.6881 23.4473C24.8791 23.4626 25.0464 23.3201 25.0617 23.1291C25.077 22.938 24.9345 22.7707 24.7434 22.7555C24.5524 22.7402 24.3851 22.8827 24.3698 23.0737C24.3545 23.2648 24.497 23.4321 24.6881 23.4473Z",fill:"url(#paint8_linear_4437_102859)"}),p.createElement("path",{d:"M35.4122 24.3054C35.6033 24.3207 35.7705 24.1782 35.7858 23.9871C35.8011 23.7961 35.6586 23.6288 35.4676 23.6135C35.2765 23.5982 35.1092 23.7407 35.0939 23.9318C35.0787 24.1228 35.2211 24.2901 35.4122 24.3054Z",fill:"url(#paint9_linear_4437_102859)"}),p.createElement("path",{d:"M35.1976 33.5143C35.3887 33.5296 35.556 33.3871 35.5713 33.196C35.5865 33.005 35.444 32.8377 35.253 32.8224C35.0619 32.8071 34.8947 32.9496 34.8794 33.1407C34.8641 33.3317 35.0066 33.499 35.1976 33.5143Z",fill:"url(#paint10_linear_4437_102859)"}),p.createElement("path",{d:"M34.7617 34.6109C34.7426 34.8497 34.5335 35.0279 34.2947 35.0087C34.0559 34.9896 33.8778 34.7805 33.8969 34.5417C33.916 34.3029 34.1251 34.1248 34.3639 34.1439C34.6027 34.163 34.7808 34.3721 34.7617 34.6109Z",fill:"url(#paint11_linear_4437_102859)"}),p.createElement("path",{d:"M33.461 33.4624C33.4419 33.7012 33.2328 33.8793 32.994 33.8602C32.7552 33.8411 32.5771 33.632 32.5962 33.3932C32.6153 33.1544 32.8244 32.9763 33.0632 32.9954C33.302 33.0145 33.4801 33.2236 33.461 33.4624Z",fill:"url(#paint12_linear_4437_102859)"}),p.createElement("path",{d:"M33.0528 38.565C33.3393 38.5879 33.5903 38.3742 33.6132 38.0876C33.6361 37.801 33.4224 37.5501 33.1358 37.5272C32.8492 37.5043 32.5983 37.718 32.5754 38.0046C32.5524 38.2912 32.7662 38.5421 33.0528 38.565Z",fill:"url(#paint13_linear_4437_102859)"}),p.createElement("path",{d:"M31.4373 25.0318C31.5806 25.0433 31.7061 24.9364 31.7176 24.7931C31.729 24.6498 31.6222 24.5244 31.4789 24.5129C31.3356 24.5014 31.2101 24.6083 31.1986 24.7516C31.1872 24.8949 31.2941 25.0203 31.4373 25.0318Z",fill:"url(#paint14_linear_4437_102859)"}),p.createElement("path",{d:"M38.6813 28.0485C38.8246 28.0599 38.9501 27.9531 38.9615 27.8098C38.973 27.6665 38.8661 27.541 38.7228 27.5296C38.5795 27.5181 38.4541 27.625 38.4426 27.7683C38.4311 27.9116 38.538 28.037 38.6813 28.0485Z",fill:"url(#paint15_linear_4437_102859)"}),p.createElement("path",{d:"M24.8264 28.2455C24.8149 28.3888 24.6895 28.4957 24.5462 28.4842C24.4029 28.4728 24.296 28.3473 24.3075 28.204C24.319 28.0607 24.4444 27.9539 24.5877 27.9653C24.731 27.9768 24.8379 28.1022 24.8264 28.2455Z",fill:"url(#paint16_linear_4437_102859)"}),p.createElement("path",{d:"M29.7179 34.5555C29.7065 34.6988 29.581 34.8057 29.4377 34.7942C29.2944 34.7828 29.1876 34.6573 29.199 34.514C29.2105 34.3707 29.3359 34.2638 29.4792 34.2753C29.6225 34.2868 29.7294 34.4122 29.7179 34.5555Z",fill:"url(#paint17_linear_4437_102859)"}),p.createElement("path",{d:"M34.8378 40.1875C34.8263 40.3308 34.7009 40.4376 34.5576 40.4262C34.4143 40.4147 34.3074 40.2892 34.3189 40.146C34.3303 40.0027 34.4558 39.8958 34.5991 39.9073C34.7424 39.9187 34.8493 40.0442 34.8378 40.1875Z",fill:"url(#paint18_linear_4437_102859)"}),p.createElement("circle",{cx:"30.7065",cy:"54.635",r:"10.2651",fill:"url(#paint19_radial_4437_102859)"}),p.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint20_radial_4437_102859)"}),p.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint21_radial_4437_102859)"}),p.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint22_radial_4437_102859)"}),p.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint23_radial_4437_102859)",fillOpacity:"0.8"}),p.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint24_radial_4437_102859)",fillOpacity:"0.5"}),p.createElement("path",{d:"M45.5363 18.026C41.7695 15.1847 37.0813 13.5 31.9996 13.5C26.8959 13.5 22.1891 15.1993 18.4141 18.0629L18.6122 18.5407C22.3207 15.6929 26.9624 14 31.9996 14C37.0152 14 41.6389 15.6785 45.3394 18.5043L45.5363 18.026Z",fill:"url(#paint25_linear_4437_102859)"})),p.createElement("defs",null,p.createElement("radialGradient",{id:"paint0_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(12.96 91.5892) rotate(-72.0032) scale(88.3469 77.6412)"},p.createElement("stop",{offset:"0.693439",stopColor:"#FEE39E"}),p.createElement("stop",{offset:"0.944453",stopColor:"#E7E7E7"})),p.createElement("radialGradient",{id:"paint1_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(6.97869 113.113) rotate(-69.2873) scale(101.649 100.571)"},p.createElement("stop",{offset:"0.54057",stopColor:"#FEE39E"}),p.createElement("stop",{offset:"0.756027",stopColor:"#E7E7E7"})),p.createElement("radialGradient",{id:"paint2_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(24.8846 10.6232) rotate(77.745) scale(40.8411 13.4678)"},p.createElement("stop",{offset:"0.722796",stopColor:"#A99B93"}),p.createElement("stop",{offset:"1",stopColor:"#E7E7E7",stopOpacity:"0"})),p.createElement("linearGradient",{id:"paint3_linear_4437_102859",x1:"32.604",y1:"24.5358",x2:"30.1599",y2:"50.2788",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{stopColor:"#E7E7E7"}),p.createElement("stop",{offset:"1",stopColor:"white"})),p.createElement("radialGradient",{id:"paint4_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(13.7515 86.4791) rotate(-69.9718) scale(80.4505 48.3189)"},p.createElement("stop",{offset:"0.557175",stopColor:"#FEE39E"}),p.createElement("stop",{offset:"0.650777",stopColor:"#FFB900"}),p.createElement("stop",{offset:"0.791699",stopColor:"#FF5C39"}),p.createElement("stop",{offset:"0.875",stopColor:"#DF4221"}),p.createElement("stop",{offset:"1",stopColor:"#711400"})),p.createElement("linearGradient",{id:"paint5_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint6_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint7_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint8_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint9_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint10_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint11_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint12_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint13_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint14_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint15_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint16_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint17_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("linearGradient",{id:"paint18_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),p.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),p.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),p.createElement("radialGradient",{id:"paint19_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(30.7065 55.1016) rotate(121.43) scale(9.84288 6.65281)"},p.createElement("stop",{offset:"0.271006",stopColor:"#A9A9A9"}),p.createElement("stop",{offset:"0.715999",stopColor:"#B1B1B1",stopOpacity:"0.5"}),p.createElement("stop",{offset:"0.934077",stopColor:"#DCDCDC",stopOpacity:"0"})),p.createElement("radialGradient",{id:"paint20_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.8709 50.8751) rotate(120.689) scale(10.5254)"},p.createElement("stop",{offset:"0.103226",stopColor:"#C58FF1"}),p.createElement("stop",{offset:"0.322917",stopColor:"#9D50EE"}),p.createElement("stop",{offset:"0.510417",stopColor:"#7B30EA"}),p.createElement("stop",{offset:"0.78125",stopColor:"#CB5285"})),p.createElement("radialGradient",{id:"paint21_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.9445 50.0656) rotate(104.486) scale(8.23697)"},p.createElement("stop",{stopColor:"#DAB0F2"}),p.createElement("stop",{offset:"0.806053",stopColor:"#D1A5EA",stopOpacity:"0"})),p.createElement("radialGradient",{id:"paint22_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(33.0917 49.8449) rotate(123.541) scale(3.92887)"},p.createElement("stop",{stopColor:"#EDDAFD"}),p.createElement("stop",{offset:"0.573279",stopColor:"#D8BDEF",stopOpacity:"0.57836"}),p.createElement("stop",{offset:"1",stopColor:"#BC95DC",stopOpacity:"0"})),p.createElement("radialGradient",{id:"paint23_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.0383 52.4709) rotate(97.8153) scale(9.88655)"},p.createElement("stop",{offset:"0.446038",stopColor:"white",stopOpacity:"0"}),p.createElement("stop",{offset:"0.841379",stopColor:"white"})),p.createElement("radialGradient",{id:"paint24_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(31.8462 58.0405) rotate(-90) scale(4.03312 7.97021)"},p.createElement("stop",{stopColor:"#FFB3BB"}),p.createElement("stop",{offset:"1",stopColor:"#FE625D",stopOpacity:"0"})),p.createElement("linearGradient",{id:"paint25_linear_4437_102859",x1:"18.4141",y1:"19.5907",x2:"18.2667",y2:"10.1574",gradientUnits:"userSpaceOnUse"},p.createElement("stop",{stopColor:"#F3F3F3"}),p.createElement("stop",{offset:"0.853323",stopColor:"#E7E7E7"})),p.createElement("clipPath",{id:"clip0_4437_102859"},p.createElement("rect",{width:"64",height:"64",fill:"white"})))),dn={root:{position:"relative",alignItems:"center",justifyContent:"space-between",...ke.Pt.overflow("hidden","auto"),scrollBehavior:"smooth",height:"100%"},mainContent:{alignItems:"center",justifyContent:"center",marginTop:oe.L.spacingVerticalXXL,rowGap:oe.L.spacingVerticalL,height:"100%"},textContent:{rowGap:oe.L.spacingVerticalM,alignItems:"center",maxWidth:"220px"},text:{textAlign:"center"}},pn=(0,Ce.n)(dn),hn=({isDarkMode:e,errorScreenTitle:t,errorScreenText:n})=>{const o=pn();return p.createElement(K.W,{style:o.root},p.createElement(K.W,{style:o.mainContent},p.createElement(un,null),p.createElement(K.W,{style:o.textContent},p.createElement(ln.M,{tabIndex:0,block:!0,className:o.text},t),p.createElement(cn.c,{tabIndex:0,block:!0,className:o.text},n))))},gn=p.forwardRef(((e,t)=>{const{copilotChatProps:n,updatedAgentChatProps:o,copilotList:r,showLoadingShimmer:i,showError:s,shouldClearChatHistory:l,setShouldClearChatHistory:c,finalCopilotSwitcherMenuContainerStyles:u,setAtMentionApp:d,handleCopilotChange:h,getBrandingById:g}=e,f=p.useMemo((()=>jt(r)),[r]),{theme:m,themeV2:y}=n,v=(0,mt.Qt)(f?.name),C=(0,mt.vX)(),{renderExternalComponent:b,selectedComponent:E}=function({copilotChatProps:e,copilotList:t}){const{debugProps:n,copilotPluginProps:o}=e,r=o?.showCopilotSwitcherMenu,[i,a]=p.useState(null),[s,l]=p.useState(!1);return p.useEffect((()=>{const e=t.find((e=>e.isSelected)),n=t.find((e=>e.copilotType===A.NV.Default));e&&n&&e.id===n.id&&l(!1),l(t&&r&&e?.id&&n?.id&&e?.id!==n?.id&&mt.tn.includes(e?.copilotType))}),[t,r,n]),p.useEffect((()=>{const e=o?.copilotList.find((e=>e.isSelected));a(e?e.copilotComponent:null)}),[o?.copilotList]),{renderExternalComponent:s,selectedComponent:i}}({copilotChatProps:n,copilotList:r});return p.createElement(p.Fragment,null,i?p.createElement(sn,{className:u.chatFreStack}):b?p.createElement(ft.K,{componentToRender:E}):s?p.createElement(hn,{isDarkMode:y?.isDarkModeEnabled??m?.isDarkModeEnabled,errorScreenTitle:v,errorScreenText:C}):p.createElement(K.W,{style:u.chatUiStackItemInContainer},p.createElement(a.zn,{key:f?.id,...o,theme:m,themeV2:y,ref:t,switcherMenuProps:{currentSelectedGPTId:Rt(f?.id,f?.copilotType),shouldClearChatHistory:l,setShouldClearChatHistory:c,getBrandingById:g,setAtMentionApp:d,handleCopilotChange:h}})))}));gn.displayName="AgentSwitcherMenuChatPanel";const fn=e=>{const{copilotChatProps:t,copilotList:n,showMenuShimmer:o,showErrorScreen:s,handleCopilotChange:c,newConversationClickHandler:u,showCreditUI:d,showCreditsTeachingCallout:h,setShowCreditsTeachingCallout:g,onClickShowChatHistoryPanel:f,chatHistoryContainer:m,fetchGPTList:y,gptListUserPerceivedLatencyStartTime:v}=e,{chatUiProps:C,copilotTelemetryHandler:b,copilotCommunicationHandler:E,copilotPluginProps:A,copilotFeatureFlags:S}=t,I=(0,mt.yb)(),P=E.getHostSettings()?.appPlatform,T=E.getHostSettings()?.appName?.toLowerCase(),x=C?.chatHistoryUiProps?.enableChatHistoryV2&&A?.paneSilhouetteHeaderProps?.enableChatHistory,[w,k]=p.useState(!1),[_,D]=p.useState(!1),F=(e,t)=>{k(t.open),t.open&&(o&&null===v.current&&(v.current=(new Date).getTime()),S.isCustomGPTsEnabled&&s&&y(),_&&x&&D(!1)),Gt(b).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.SwitcherMenuStateChange},{key:r.h3.ChatEventParameters,value:JSON.stringify({isOpen:t.open,isItemClick:"menuItemClick"===t.type,isPaneSilhouetteEnabled:!!A.paneSilhouetteHeaderProps})}]);const n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};a.sU.sendLoggingEventToClient(i.Yk.CopilotSwitcherMenuStateChange,n)},L=(0,l.dg)(S),O=(S?.enableNewChatOnlyOnCopilot?Dt(jt(n)?.id):S?.showNewChatOnGPTItem)?u:void 0,R=(e,t)=>{Gt(b).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:e},{key:r.h3.ChatEventParameters,value:t??""}])},M=p.useCallback((e=>{e?k(!1):D(!1)}),[]),B=p.useMemo((()=>Ot([...n])),[n]);return p.createElement(p.Fragment,null,A.paneSilhouetteHeaderProps&&p.createElement(l.ZJ.Provider,{value:L},p.createElement(ht,{isMenuOpen:w,onMenuStateChange:F,handleCopilotChatChange:c,copilotList:B,setShowCreditsTeachingCallout:g,showCreditsTeachingCallout:h,paneSilhouetteHeaderProps:{...A.paneSilhouetteHeaderProps,afterFirstRender:()=>{E?.sendEventToClient(i.PV.SharedHeaderRendered)},showCreditButton:d,eventLogger:R},switcherMenuChatHistoryProps:x?{onClickShowChatHistoryPanel:f,chatHistoryContainer:m,isSwitcherMenuChatHistoryPanelOpen:_,setIsSwitcherMenuChatHistoryPanelOpen:D,handleChatHistoryPanelClose:M,newConversationClickHandler:O}:void 0,featureFlags:S,appPlatform:P,menuErrorProps:S.isCustomGPTsEnabled?{showErrorMessage:s&&w,errorMessage:I}:void 0,appName:T,eventLogger:R})),!A.paneSilhouetteHeaderProps&&p.createElement(gt.V,{isMenuOpen:w,onMenuStateChange:F,handleCopilotChatChange:c,copilotList:B,showLoadingShimmer:o}))},mn=p.forwardRef(((e,t)=>{const{style:n,theme:i,themeV2:a,copilotTelemetryHandler:l,copilotPluginProps:u}=e,[h,g]=p.useState(void 0),[f,m]=p.useState(!1),y=void 0!==a,v=tn(),C=nn();let b=v;b=on(y?C:v,n);const[S,I]=p.useState((()=>{})),[P,x]=p.useState((()=>{})),[w,k]=p.useState((()=>{})),[_,R]=p.useState(i),[M,B]=p.useState(a),[N,V]=p.useState(!1),H=p.useRef(null),[U,j]=p.useState(-1);p.useEffect((()=>{R(i),B(a)}),[i,a]),p.useEffect((()=>{Bt(e.copilotCommunicationHandler.getHostSettings().devBuild)}));const{isLoadingMenu:z,isLoadingGPTDetails:G,fetchGPTList:W,fetchGPTDetails:Y,gptDetailsProps:$,gptListUserPerceivedLatencyStartTime:J,isTimeoutForGPTDetails:X,showGPTListErrorScreen:Z,showChatErrorScreen:ee,copilotListInternal:te,updateSelectedAgent:ne}=function({copilotChatProps:e,atMentionApp:t}){const{copilotTelemetryHandler:n,copilotPluginProps:o,copilotFeatureFlags:r}=e,[i,a]=(0,p.useState)([]),s=Ct(),[l,c]=(0,p.useState)(!1),[u,h]=(0,p.useState)(!0),[g,f]=(0,p.useState)(!1),m=(0,p.useRef)(null),y=(0,p.useRef)(!0),v=(e,t,o,r,a)=>{Vt(e,t,n,o,jt(i)?.id,r,a)},{isLoadingMenu:C,isLoadingGPTDetails:b,isTimeoutForGPTDetails:S,fetchGPTList:I,fetchGPTDetails:P,gptListProps:T,gptDetailsProps:x}=q(r?.isCustomGPTsEnabled,e,f,c,v,Ut,u,h),w=(0,mt.$q)();(0,p.useEffect)((()=>{if(0===i.length){const e=_t(s);a([e,...o?.copilotList||[],...r.isCustomGPTsEnabled?r.isAcquirePluginsFromMosEnabled?[Lt(w)]:[Ft(w)]:[]])}else{const e=o?.copilotList.find((e=>e.isSelected));if(e){const t=i.find((e=>e.isSelected));t&&t.id!==e.id&&a((t=>t.map((t=>({...t,isSelected:t.id===e.id})))))}}}),[o?.copilotList]);const k=Wt({gptListProps:T,fetchGPTList:I,copilotSwitcherOpenRequest:o?.copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest:o?.setCopilotSwitcherOpenRequest,gptTelemetryHandler:v});(0,p.useEffect)((()=>{if(r?.isCustomGPTsEnabled&&T.status===L.Success){Nt("Updating GPT list in switcher menu");const e=i.filter((e=>e.copilotType!==A.NV.CustomGPT)),t=i.find((e=>e.isSelected));let s=T.copilotSwitcherMenuItemProps;if(o?.copilotSwitcherOpenRequest&&r?.isAcquirePluginsFromMosEnabled?s=k(t):t?.copilotType===A.NV.CustomGPT&&(s=s.map((e=>({...e,isSelected:e.id===t.id})))),a([...e,...s]),y?.current){const e=m?.current?(new Date).getTime()-m?.current:0;Vt(null,E.GPTListUserPerceivedLatency,n,e>0?e:0),y.current=!1}}}),[T,o?.copilotSwitcherOpenRequest]),(0,p.useEffect)((()=>{const e=i.filter((e=>e.copilotType===A.NV.CustomGPT));if(T.status===L.Error&&e.length>0){let t="";try{t=JSON.stringify({fetchedGPTListLength:e.length})}catch(e){Nt("Error in stringifying data",e)}Vt(d.S.GetGPTList,E.GetCachedGPT,n,t)}}),[T]);const _=(0,p.useCallback)((e=>{o?.handleCopilotChatChange(e)}),[o]);(0,p.useEffect)((()=>{zt(i,n);const e=jt(i);e&&_(e.id)}),[i]);const D=(0,p.useCallback)(((e,n)=>{const o=jt(i);if(o?.id!==e){const o=i.map((t=>({...t,isSelected:t.id===e})));n&&o.push({id:t.appId,name:t.title,isSelected:!0,menuIconUrl:t.iconUrl,copilotType:A.NV.CustomGPT}),a(o);const s=jt(o);r.isCustomGPTsEnabled&&s?.copilotType===A.NV.CustomGPT&&(I(),r?.useCacheForGPTDetails||P(s.id))}}),[i,t]);return{isLoadingMenu:C,isLoadingGPTDetails:b,fetchGPTList:I,fetchGPTDetails:P,gptDetailsProps:x,gptListUserPerceivedLatencyStartTime:m,isTimeoutForGPTDetails:S,showGPTListErrorScreen:l,showChatErrorScreen:g,copilotListInternal:i,setAgentListInternal:a,updateSelectedAgent:D}}({copilotChatProps:e,atMentionApp:h}),oe=p.useCallback((e=>{const t=te.find((t=>t.id===e));if(t)return Nt("Returning branding data from copilotListInternal",t),{name:t.name,iconUrl:t.menuIconUrl,id:e};if(h&&h.appId===e)return Nt("Returning branding data from atMentionApp",h),{name:h.title,iconUrl:h.iconUrl,id:e};throw Nt("GPT id is invalid. No branding data found"),Ht(l,r.a5.GPTBrandingIdInvalid,`GPT id ${e} not found in copilotListInternal`),new Error(`Invalid GPT id ${e}`)}),[te,h]),{showCreditUI:re,updatedAgentChatProps:ie}=function({copilotChatProps:e,copilotList:t,atMentionApp:n,fetchGPTDetails:r,gptDetailsProps:i,isTimeoutForGPTDetails:a,getBrandingById:s}){const{chatUiProps:l,copilotTelemetryHandler:u,copilotPluginProps:h,copilotFeatureFlags:g,debugProps:f}=e,m=(0,o.Lh)(c.wr),y=l?.chatInputV2Props?.chatPlaceholderMessage,v=h?.showCopilotSwitcherMenu,[C,b]=p.useState(e),[S,I]=p.useState(g?.isCreditsUIEnabled),[P,x]=p.useState(e.chatUiProps.creditsUIProps??{creditUpsellHandler:()=>{},setShowCreditsUI:I,upsellFwdLinkId:"",clientParam:""}),w=$t();return p.useEffect((()=>{if(g.isCustomGPTsEnabled&&!a&&i.status===L.Success&&""!==i.gptId){let e;if(g.isDABrandingEnabled&&i.gptId){const t=s(i.gptId);t&&(e={iconName:t.name,iconUrl:t.iconUrl,title:t.name})}Nt("Updating GPT details in switcher menu container");let t={...i.copilotChatProps.zeroQueryMessageV2Props,brandingInfo:e,showBranding:g.isDABrandingEnabled};if(g?.restrictConversationStartersForDA){const e=i.copilotChatProps?.zeroQueryMessageV2Props?.promptSuggestionList?.length>0?i.copilotChatProps.zeroQueryMessageV2Props.promptSuggestionList:w;t={...t,promptSuggestionList:e.slice(0,6)}}i.copilotChatProps.zeroQueryMessageV2Props=t;const n=T(i.copilotChatProps,C,m);b(n)}}),[i]),p.useEffect((()=>{if(g?.isCreditsUIEnabled&&P){const e={...l};if(e.creditsUIProps=P,e.creditsUIProps.setShowCreditsUI=I,g?.useCacheForGPTDetails){e.zeroQueryMessageV2Props=C.chatUiProps.zeroQueryMessageV2Props;const t=T(e,C,C.chatUiProps.chatInputV2Props.chatPlaceholderMessage);b(t)}else b({...C,chatUiProps:e});x(e.creditsUIProps)}}),[e]),p.useEffect((()=>{const n=jt(t);if(g.isCustomGPTsEnabled&&n&&n.copilotType&&n.copilotType===A.NV.CustomGPT){let t;if(g.isDABrandingEnabled&&n.id){const e=s(n.id);e&&(t={iconName:e.name,iconUrl:e.iconUrl,title:e.name})}if(g?.useCacheForGPTDetails){const o=D(n.id);if(n?.starterPrompts?.length>0||o){const o={zeroQueryMessageV2Props:{promptSuggestionList:(n.starterPrompts?.length?n.starterPrompts?.map((e=>({suggestionText:e?.text??"",suggestionCategory:e?.title??"",iconRegular:O.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}))):w).slice(0,6),brandingInfo:t,showBranding:g.isDABrandingEnabled}},r={...e.chatUiProps,...o},i=T(r,e,m);b(i);let a="";try{const e=F(n.id);a=JSON.stringify({agentType:e,agentId:n.id})}catch(e){a=JSON.stringify({agentType:A.AL.UnprojectedDA,agentId:n.id})}Vt(d.S.GetGPT,E.GetCachedGPT,u,a)}else r(n.id)}}else b({...e})}),[t,e,v,f]),p.useEffect((()=>{const e=n?m:y;b((t=>({...t,chatUiProps:{...t.chatUiProps,chatInputV2Props:{...t.chatUiProps.chatInputV2Props,chatPlaceholderMessage:e}}})))}),[n]),{isLoadingGPTDetails:!1,showCreditUI:S,updatedAgentChatProps:C}}({copilotChatProps:e,copilotList:te,atMentionApp:h,fetchGPTDetails:Y,gptDetailsProps:$,isTimeoutForGPTDetails:X,getBrandingById:oe}),ae=p.useRef((()=>{})),se=e=>{ae?.current(),m(!0);const t=te.find((t=>t.id===e));var n;Gt(l).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.CopilotChange},{key:r.h3.ChatEventParameters,value:JSON.stringify({id:e,type:t?.copilotType??h?.appType})}]),t?t?.isLink&&t?.linkURL?(n=t?.linkURL,window.open(n,"_blank")):t?.isHandledExternally?u?.handleCopilotChatChange(e):ne(e):h&&h.appId===e&&ne(e,!0)},le=p.useCallback((e=>{if(e.ctrlKey&&"Space"===e.code&&-1===U){const t=window.setTimeout((()=>{const e=document.querySelector("[data-unique-id^=TaskPaneOptionsBtnShared]");e&&document.activeElement!==e&&e.click(),j(-1)}),400);j(t),e.stopPropagation(),e.preventDefault()}}),[U]);return p.createElement(Q.V,{copilotChatHistoryContext:{setOnClickShowChatHistoryPanel:I,setChatHistoryContainer:x,setNewConversationClickHandler:k},copilotChatConversationSelectedContext:{conversationId:H,handleChatHistoryConversationClick:async(e,t)=>{const n=e??mt.r9;se(n),H.current=t}},creditUIContext:{setShowCreditsTeachingCallout:V},stopGeneratingQuery:ae},p.createElement(s.L,{theme:M||_,shouldUseFluentV9Tokens:y,dir:M?M.dir:_.dir},p.createElement(K.W,{style:b.chatUiStack,customProperties:{onKeyDown:le}},p.createElement(fn,{copilotChatProps:e,copilotList:te,handleCopilotChange:se,showMenuShimmer:z,showErrorScreen:Z,newConversationClickHandler:w,showCreditUI:re,showCreditsTeachingCallout:N,setShowCreditsTeachingCallout:V,onClickShowChatHistoryPanel:S,chatHistoryContainer:P,fetchGPTList:W,gptListUserPerceivedLatencyStartTime:J}),p.createElement(gn,{copilotChatProps:e,updatedAgentChatProps:ie,showLoadingShimmer:G,showError:ee,shouldClearChatHistory:f,finalCopilotSwitcherMenuContainerStyles:b,atMentionApp:h,setShouldClearChatHistory:m,setAtMentionApp:g,handleCopilotChange:se,copilotList:te,ref:t,getBrandingById:oe}))))}));mn.displayName=mt.kr;const yn=p.forwardRef(((e,t)=>{const{copilotFeatureFlags:n}=e;return n.enableSwitcherMenuV2?p.createElement(mn,{...e,ref:t}):p.createElement(vn,{...e,ref:t})})),vn=p.forwardRef(((e,t)=>{const{style:n,copilotCommunicationHandler:u,theme:h,themeV2:g,chatUiProps:f,debugProps:m,copilotTelemetryHandler:v,copilotPluginProps:C,copilotFeatureFlags:b}=e,[S,I]=p.useState(void 0),[P,x]=p.useState(void 0),[w,k]=p.useState(!1),_=void 0!==g,R=tn(),M=nn(),B=p.useRef(mt.r9),N=Ct(),V=u.getHostSettings()?.appPlatform,H=u.getHostSettings()?.appName?.toLowerCase(),U=(0,o.Lh)(c.wr),j=f?.chatInputV2Props?.chatPlaceholderMessage;let z=R;z=on(_?M:R,n);const[G,W]=p.useState((0,y.A)()),[Y,$]=p.useState((()=>{})),[J,X]=p.useState((()=>{})),[Z,ee]=p.useState((()=>{})),[te,ne]=p.useState(!1),oe=f?.chatHistoryUiProps?.enableChatHistoryV2&&C?.paneSilhouetteHeaderProps?.enableChatHistory,re=p.useCallback((e=>{e?lt(!1):ne(!1)}),[]),[ie,ae]=p.useState(b?.isCreditsUIEnabled),[se,le]=p.useState(e.chatUiProps.creditsUIProps??{creditUpsellHandler:()=>{},setShowCreditsUI:ae,upsellFwdLinkId:"",clientParam:""}),[ce,ue]=p.useState(e),[de,pe]=p.useState(!0),[he,ge]=p.useState(!1),[fe,me]=p.useState(!1),[ye,ve]=p.useState(!1),[Ce,be]=p.useState(h),[Ee,Ae]=p.useState(g),[Se,Ie]=p.useState(!1),Pe=p.useRef(null),[Te,xe]=p.useState(!0),[we,ke]=p.useState(-1),_e=p.useRef(null),De=p.useRef(!0);p.useEffect((()=>{be(h),Ae(g)}),[h,g]),p.useEffect((()=>{Bt(e.copilotCommunicationHandler.getHostSettings().devBuild)}));const Fe=C?.showCopilotSwitcherMenu,[Le,Oe]=p.useState([]),Re=p.useMemo((()=>Le.find((e=>e.id===S))?.name),[S]),Me=(0,mt.yb)(),Be=(0,mt.Qt)(Re),Ne=(0,mt.vX)(),Ve=p.useMemo((()=>Le.find((e=>e.id===S))?.copilotType),[Le,S]);p.useEffect((()=>{ue(P?e=>({...e,chatUiProps:{...e.chatUiProps,chatInputV2Props:{...e.chatUiProps.chatInputV2Props,chatPlaceholderMessage:U}}}):e=>({...e,chatUiProps:{...e.chatUiProps,chatInputV2Props:{...e.chatUiProps.chatInputV2Props,chatPlaceholderMessage:j}}}))}),[P]);const He=p.useRef(void 0),Ue=(e,t,n,o,r)=>{Vt(e,t,v,n,S,o,r)},{isLoadingMenu:je,isLoadingGPTDetails:ze,isTimeoutForGPTDetails:Ge,fetchGPTList:We,gptListProps:qe,fetchGPTDetails:Qe,gptDetailsProps:Ke}=q(b.isCustomGPTsEnabled,ce,me,ve,Ue,Ut,Te,xe),Ye=p.useCallback((e=>{const t=Le.find((t=>t.id===e));if(t)return Nt("Returning branding data from copilotListInternal",t),{name:t.name,iconUrl:t.menuIconUrl,id:e};if(P&&P.appId===e)return Nt("Returning branding data from atMentionApp",P),{name:P.title,iconUrl:P.iconUrl,id:e};throw Nt("GPT id is invalid. No branding data found"),Ht(v,r.a5.GPTBrandingIdInvalid,`GPT id ${e} not found in copilotListInternal`),new Error(`Invalid GPT id ${e}`)}),[Le,P]);p.useEffect((()=>{pe(!!je)}),[je]),p.useEffect((()=>{b.isCustomGPTsEnabled&&!ze&&ge(!1)}),[ze]);const $e=p.useCallback((e=>{He.current=Rt(e.id,e?.copilotType),B.current=e.id,I(e.id)}),[]),Je=Wt({gptListProps:qe,fetchGPTList:We,copilotSwitcherOpenRequest:C?.copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest:C?.setCopilotSwitcherOpenRequest,updateCurrentSelectedGPTId:$e,gptTelemetryHandler:Ue});p.useEffect((()=>{if(b.isCustomGPTsEnabled&&qe.status===L.Success){Nt("Updating GPT list in switcher menu");const e=Le.filter((e=>e.copilotType!==A.NV.CustomGPT)),t=Le.find((e=>e.isSelected));let n=qe.copilotSwitcherMenuItemProps;if(C?.copilotSwitcherOpenRequest&&b?.isAcquirePluginsFromMosEnabled?n=Je(t):t?.copilotType===A.NV.CustomGPT&&(n=n.map((e=>({...e,isSelected:e.id===t.id})))),Oe([...e,...n]),De?.current){const e=_e?.current?(new Date).getTime()-_e?.current:0;Vt(null,E.GPTListUserPerceivedLatency,v,e>0?e:0),De.current=!1}}}),[qe,C?.copilotSwitcherOpenRequest]),p.useEffect((()=>{const e=Le.filter((e=>e.copilotType===A.NV.CustomGPT));if(qe.status===L.Error&&e.length>0){let t="";try{t=JSON.stringify({fetchedGPTListLength:e.length})}catch(e){Nt("Error in stringifying data",e)}Vt(d.S.GetGPTList,E.GetCachedGPT,v,t)}}),[qe]);const Xe=$t();p.useEffect((()=>{if(b.isCustomGPTsEnabled&&!Ge&&Ke.status===L.Success&&""!==Ke.gptId){let e;if(Nt("Updating GPT details in switcher menu container"),b.isDABrandingEnabled&&Ke.gptId){const t=Ye(Ke.gptId);t&&(e={iconName:t.name,iconUrl:t.iconUrl,title:t.name})}tt(Ke.gptId);let t={...Ke.copilotChatProps.zeroQueryMessageV2Props,brandingInfo:e,showBranding:b.isDABrandingEnabled};if(b?.restrictConversationStartersForDA){const e=Ke.copilotChatProps?.zeroQueryMessageV2Props?.promptSuggestionList?.length>0?Ke.copilotChatProps.zeroQueryMessageV2Props.promptSuggestionList:Xe;t={...t,promptSuggestionList:e.slice(0,6)}}Ke.copilotChatProps.zeroQueryMessageV2Props=t;const n=T(Ke.copilotChatProps,ce,U);ue(n)}}),[Ke]);const Ze=(0,mt.$q)();p.useEffect((()=>{if(0===Le.length){const e=_t(N);Oe([e,...C?.copilotList||[],...b.isCustomGPTsEnabled?b.isAcquirePluginsFromMosEnabled?[Lt(Ze)]:[Ft(Ze)]:[]])}else{const e=C?.copilotList.find((e=>e.isSelected));if(e){const t=Le.find((e=>e.isSelected));t&&t.id!==e.id&&Oe((t=>t.map((t=>({...t,isSelected:t.id===e.id})))))}}}),[C?.copilotList]);const et=p.useCallback((e=>{C?.handleCopilotChatChange(e)}),[C]),tt=(e,t)=>{me(!1);const n=Le.map((t=>({...t,isSelected:t.id===e})));t&&n.push({id:P.appId,name:P.title,isSelected:!0,menuIconUrl:P.iconUrl,copilotType:A.NV.CustomGPT}),B.current!=e&&(B.current=e,Oe(n),I(e))},nt=p.useRef((()=>{})),ot=e=>{nt?.current(),k(!0);const t=Le.find((t=>t.id===e));if(Gt(v).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.CopilotChange},{key:r.h3.ChatEventParameters,value:JSON.stringify({id:e,type:t?.copilotType??P?.appType})}]),t){if(t?.isLink&&t?.linkURL)n=t?.linkURL,window.open(n,"_blank");else if(t?.isHandledExternally)C?.handleCopilotChatChange(e);else if(B.current!=e){He.current=Rt(e,t?.copilotType),Dt(e)&&W((0,y.A)());t?.copilotType===A.NV.CustomGPT&&b.isCustomGPTsEnabled&&!b?.useCacheForGPTDetails&&ge(!0),tt(e)}}else if(P&&P.appId===e){"GPT"===P.appType&&b.isCustomGPTsEnabled&&!b?.useCacheForGPTDetails&&ge(!0),tt(e,!0)}var n};p.useEffect((()=>{zt(Le,v);const e=Le.find((e=>e.isSelected));e&&et(e.id)}),[Le]);const rt=p.useMemo((()=>Ot([...Le])),[Le]),[it,at]=p.useState(p.createElement(p.Fragment,null));p.useEffect((()=>{const e=C?.copilotList.find((e=>e.isSelected));at(e?e.copilotComponent:p.createElement(p.Fragment,null))}),[C?.copilotList]);const[st,lt]=p.useState(!1),ct=(e,t)=>{lt(t.open),t.open&&(de&&null===_e.current&&(_e.current=(new Date).getTime()),b.isCustomGPTsEnabled&&ye&&We(),te&&oe&&ne(!1)),Gt(v).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:r.a5.SwitcherMenuStateChange},{key:r.h3.ChatEventParameters,value:JSON.stringify({isOpen:t.open,isItemClick:"menuItemClick"===t.type,isPaneSilhouetteEnabled:!!C.paneSilhouetteHeaderProps})}]);const n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};a.sU.sendLoggingEventToClient(i.Yk.CopilotSwitcherMenuStateChange,n)},[ut,dt]=p.useState(!1);p.useEffect((()=>{const t=Le.find((e=>e.isSelected)),n=Le.find((e=>e.copilotType===A.NV.Default));t&&n&&t.id===n.id&&dt(!1),dt(Le&&Fe&&t?.id&&n?.id&&t?.id!==n?.id&&mt.tn.includes(t?.copilotType)),n&&n.isSelected&&ue(e)}),[Le,Fe,m]),p.useEffect((()=>{const t=Le.find((e=>e.isSelected));if(b.isCustomGPTsEnabled&&t&&t.copilotType&&t.copilotType===A.NV.CustomGPT)if(b?.useCacheForGPTDetails){const t={...e.chatUiProps};t.zeroQueryMessageV2Props=ce.chatUiProps.zeroQueryMessageV2Props;const n=T(t,e,U);ue(n)}else{const t=T(Ke.copilotChatProps,e,U);ue(t)}else ue(e);if(b?.isCreditsUIEnabled&&se){const e={...f};if(e.creditsUIProps=se,e.creditsUIProps.setShowCreditsUI=ae,b?.useCacheForGPTDetails){e.zeroQueryMessageV2Props=ce.chatUiProps.zeroQueryMessageV2Props;const t=T(e,ce,ce.chatUiProps.chatInputV2Props.chatPlaceholderMessage);ue(t)}else ue({...ce,chatUiProps:e});le(e.creditsUIProps)}}),[e]);p.useEffect((()=>{const t=async()=>{b?.useCacheForGPTDetails?((t=>{const n=Le.find((e=>e.id===t));let o;if(b.isDABrandingEnabled&&t){const e=Ye(t);e&&(o={iconName:e.name,iconUrl:e.iconUrl,title:e.name})}if(n){const r=D(t);if(n?.starterPrompts?.length>0||r){const r={zeroQueryMessageV2Props:{promptSuggestionList:(n.starterPrompts?.length?n.starterPrompts?.map((e=>({suggestionText:e?.text??"",suggestionCategory:e?.title??"",iconRegular:O.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}))):Xe).slice(0,6),brandingInfo:o,showBranding:b.isDABrandingEnabled}},i=T(r,e,U);ue(i),W((0,y.A)());let a="";try{const e=F(t);a=JSON.stringify({agentType:e,agentId:t})}catch(e){a=JSON.stringify({agentType:A.AL.UnprojectedDA,agentId:t})}Vt(d.S.GetGPT,E.GetCachedGPT,v,a)}else ge(!0),Qe(t)}})(S),We()):await Promise.all([We(),Qe(S)])};b.isCustomGPTsEnabled&&Ve===A.NV.CustomGPT&&t()}),[S]);const pt=(0,l.dg)(b),yt=p.useCallback((e=>{if(e.ctrlKey&&"Space"===e.code&&-1===we){const t=window.setTimeout((()=>{const e=document.querySelector("[data-unique-id^=TaskPaneOptionsBtnShared]");e&&document.activeElement!==e&&e.click(),ke(-1)}),400);ke(t),e.stopPropagation(),e.preventDefault()}else if(pt.isFluentV9TaskPaneEnabled&&"Tab"===e.code){const t=document.getElementById("CopilotSwitcherMenuID"),n=Array.from(document.querySelectorAll("button")),o=n?.slice(0).reverse().find((e=>!e.disabled));!e.shiftKey||e.target!==t&&"TaskPaneToolbarButtons"!==e.target?.parentElement?.id?e.shiftKey||e.target!==o||(e.preventDefault(),t?.focus()):(e.preventDefault(),o?.focus())}}),[we]),vt=(e,t)=>{Gt(v).sendTelemetryChatEventData([{key:r.h3.ChatEventType,value:e},{key:r.h3.ChatEventParameters,value:t??""}])},bt=(b?.enableNewChatOnlyOnCopilot?Dt(S):b?.showNewChatOnGPTItem)?Z:void 0;return p.createElement(Q.V,{copilotChatHistoryContext:{setOnClickShowChatHistoryPanel:$,setChatHistoryContainer:X,setNewConversationClickHandler:ee},copilotChatConversationSelectedContext:{conversationId:Pe,handleChatHistoryConversationClick:async(e,t)=>{const n=e??mt.r9;ot(n),Pe.current=t}},creditUIContext:{setShowCreditsTeachingCallout:Ie},stopGeneratingQuery:nt},p.createElement(s.L,{theme:Ee||Ce,shouldUseFluentV9Tokens:_,dir:Ee?Ee.dir:Ce.dir},p.createElement(K.W,{style:z.chatUiStack,customProperties:{onKeyDown:yt}},C.paneSilhouetteHeaderProps&&p.createElement(l.ZJ.Provider,{value:pt},p.createElement(ht,{isMenuOpen:st,onMenuStateChange:ct,handleCopilotChatChange:ot,copilotList:rt,setShowCreditsTeachingCallout:Ie,showCreditsTeachingCallout:Se,paneSilhouetteHeaderProps:{...C.paneSilhouetteHeaderProps,afterFirstRender:()=>{u?.sendEventToClient(i.PV.SharedHeaderRendered)},showCreditButton:ie,eventLogger:vt,shouldHideCopilotIconInHeader:ce.chatUiProps.zeroQueryMessageV2Props?.showBranding},switcherMenuChatHistoryProps:oe?{onClickShowChatHistoryPanel:Y,chatHistoryContainer:J,isSwitcherMenuChatHistoryPanelOpen:te,setIsSwitcherMenuChatHistoryPanelOpen:ne,handleChatHistoryPanelClose:re,newConversationClickHandler:bt}:void 0,featureFlags:b,appPlatform:V,menuErrorProps:b.isCustomGPTsEnabled?{showErrorMessage:ye&&st,errorMessage:Me}:void 0,appName:H,eventLogger:vt,isDarkMode:Ee?.isDarkModeEnabled??Ce?.isDarkModeEnabled})),!C.paneSilhouetteHeaderProps&&p.createElement(gt.V,{isMenuOpen:st,onMenuStateChange:ct,handleCopilotChatChange:ot,copilotList:rt,showLoadingShimmer:de}),he?p.createElement(sn,{className:z.chatFreStack}):ut?p.createElement(ft.K,{componentToRender:it}):fe?p.createElement(hn,{isDarkMode:Ee?.isDarkModeEnabled??Ce?.isDarkModeEnabled,errorScreenTitle:Be,errorScreenText:Ne}):p.createElement(K.W,{style:z.chatUiStackItemInContainer},p.createElement(a.zn,{key:G,...ce,theme:Ce,themeV2:Ee,ref:t,switcherMenuProps:{currentSelectedGPTId:He.current,shouldClearChatHistory:w,setShouldClearChatHistory:k,getBrandingById:Ye,setAtMentionApp:x,handleCopilotChange:ot}})))))}));yn.displayName=mt.kr,vn.displayName=mt.kr},78735:(e,t,n)=>{n.d(t,{$q:()=>v,A0:()=>g,NY:()=>c,Qt:()=>f,UM:()=>u,Vh:()=>d,it:()=>h,kr:()=>a,r9:()=>l,tn:()=>s,vX:()=>m,yb:()=>y,z_:()=>p});var o=n(65593),r=n(8320),i=n(4787);const a="CopilotSwitcherMenuContainer",s=[i.NV.ClientProvided,i.NV.Agent],l="copilotChat",c="GetCopilotExtensions",u="GetMosCopilotExtensions",d="https://go.microsoft.com/fwlink/?linkid=2271054",p=16,h=8,g=1e3,f=e=>{const t=(0,o.Lh)(r.WG),n=e??"this agent";return t?`${t} ${n}`:`Unable to load ${n}`},m=()=>{const e=(0,o.Lh)(r.y7);return e||"Please try reopening via the menu or switch to a different agent"},y=()=>{const e=(0,o.Lh)(r.l$);return e||"Some extensions failed to load. Try relaunching Copilot."},v=()=>{const e=(0,o.Lh)(r.Sv);return e||"Get Agents"}},27982:(e,t,n)=>{var o,r,i;n.d(t,{SC:()=>r,jA:()=>o}),function(e){e.Primary="Primary",e.Default="Default",e.CustomButton="CustomButton"}(o||(o={})),function(e){e.FeedbackSection="FeedbackSection",e.ActionButtonBar="ActionButtonBar"}(r||(r={})),function(e){e.Text="Text",e.Image="Image"}(i||(i={}))},44079:(e,t,n)=>{n.d(t,{L:()=>o,Q:()=>r});const o=e=>({buttonBarRoot:e.buttonBarRoot??{},primaryButton:e.primaryButton??{},defaultButton:e.defaultButton??{},icon:e.icon??{},combinedButtonIcon:e.combinedButtonIcon??{},iconButton:e.iconButton??{},combinedButton:e.combinedButton??{},minifiedButton:e.minifiedButton??{},showMeButton:e.showMeButton??{},showMeButtonBarRoot:e.showMebuttonBarRoot??{}});function r(e){return o(e)}},89556:(e,t,n)=>{n.d(t,{J:()=>i,_:()=>a});var o=n(44079),r=n(21812);const i=e=>({defaultRoot:e.defaultRoot??{},loader:e.loader??{},human:e.human??{},humanContent:e.humanContent??{},chat:e.chat??{},chatContent:e.chatContent??{},chatCard:e.chatCard??{},text:e.text??{},chatV2:e.chatV2??{},strikeThroughText:{},cardHighContrast:{},...(0,o.L)(e),...(0,r.u)(e)}),a=e=>i(e)},72277:(e,t,n)=>{var o,r,i,a,s;n.d(t,{GH:()=>r,JF:()=>a,Kg:()=>s,_2:()=>o,_R:()=>i}),function(e){e.CrossApp="CrossApp",e.External="External",e.Internal="Internal"}(o||(o={})),function(e){e.Citation="Citation",e.Annotation="Annotation"}(r||(r={})),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.Pdf="Pdf",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Topic="Topic"}(i||(i={})),function(e){e.Encryption="Encryption",e.NonEncryption="NonEncryption",e.Warning="Warning"}(a||(a={})),function(e){e.InProgress="InProgress",e.Success="Success",e.Failure="Failure",e.Hidden="Hidden"}(s||(s={}))},19080:(e,t,n)=>{var o,r;n.d(t,{E:()=>r,O:()=>o}),function(e){e.None="None",e.Header="Header",e.Footer="Footer"}(o||(o={})),function(e){e.Success="Success",e.Error="Error"}(r||(r={}))},21812:(e,t,n)=>{n.d(t,{u:()=>o,v:()=>r});const o=e=>({footerBar:e.footerBar??{},headerBar:e.headerBar??{},feedbackButton:e.feedbackButton??{},feedbackButtonsStack:e.feedbackButtonsStack??{},feedbackText:e.feedbackText??{},feedbackTextMinified:e.feedbackTextMinified??{},feedbackDisclaimerStack:e.feedbackDisclaimerStack??{},tooltipText:e.tooltipText??{},fluentAIDisclaimer:e.fluentAIDisclaimer??{}});function r(e){return o(e)}},1756:(e,t,n)=>{var o;n.d(t,{s:()=>o}),function(e){e.Rewrite="Rewrite",e.Insert="Insert",e.Reply="Reply"}(o||(o={}))},83318:(e,t,n)=>{n.d(t,{Z$:()=>o,nT:()=>i,tu:()=>r});const o="auto",r="912px",i="5%"},28087:(e,t,n)=>{var o,r;n.d(t,{S:()=>o,_:()=>r}),function(e){e[e.TaskViewMode=0]="TaskViewMode",e[e.StageViewMode=1]="StageViewMode"}(o||(o={})),function(e){e[e.Default=0]="Default",e[e.AccordionCard=1]="AccordionCard",e[e.ContentCard=2]="ContentCard",e[e.ChatCardWrapper=3]="ChatCardWrapper",e[e.FeedbackNudge=4]="FeedbackNudge",e[e.MarkdownCard=5]="MarkdownCard",e[e.SelfHelpAdaptiveCard=6]="SelfHelpAdaptiveCard",e[e.StreamingAdaptiveCard=7]="StreamingAdaptiveCard",e[e.CopilotWorkflowMessage=8]="CopilotWorkflowMessage",e[e.WarningMessage=9]="WarningMessage",e[e.PaginatedCard=10]="PaginatedCard",e[e.ProactiveSuggestionCard=11]="ProactiveSuggestionCard",e[e.SlideLinksCard=12]="SlideLinksCard",e[e.ReviewerSummaryCard=13]="ReviewerSummaryCard",e[e.ReviewAgentCard=14]="ReviewAgentCard",e[e.AgentPlanBuilderCard=15]="AgentPlanBuilderCard",e[e.PlanBuilderCard=16]="PlanBuilderCard",e[e.SystemMessage=17]="SystemMessage",e[e.SketchImageCard=18]="SketchImageCard",e[e.InterstitialMessage=19]="InterstitialMessage"}(r||(r={}))},94754:(e,t,n)=>{var o;n.d(t,{y:()=>o}),function(e){e.Close="close",e.Move="move",e.Resize="resize",e.Help="help",e.ExpandOrCollapse="expandOrCollapse",e.RealtimeVoice="realtimeVoice"}(o||(o={}))},4787:(e,t,n)=>{var o,r;n.d(t,{AL:()=>r,NV:()=>o,p8:()=>i}),function(e){e.Default="Default",e.CustomGPT="CustomGPT",e.Agent="Agent",e.ClientProvided="ClientProvided"}(o||(o={})),function(e){e.MEProjectedAsDA="MessageExtension",e.PPProjectedAsDA="PowerPlatform",e.DataVerseProjectedAsDA="DataVerse",e.UnprojectedDA="Unprojected"}(r||(r={}));const i={[o.Default]:0,[o.ClientProvided]:1,[o.CustomGPT]:2,[o.Agent]:3}},90907:(e,t,n)=>{n.d(t,{o:()=>o});const o={Ack:"Ack",CloseEvent:"CloseEvent",onServiceRequest:"onServiceRequest",onServiceResponse:"onServiceResponse"}},70046:(e,t,n)=>{var o;n.d(t,{L:()=>o}),function(e){e.Static="Static",e.SuggestedQnA="SuggestedQnA",e.Substrate="Substrate"}(o||(o={}))},22663:(e,t,n)=>{var o;n.d(t,{O:()=>o}),function(e){e[e.PPE=0]="PPE",e[e.Prod=1]="Prod",e[e.GCC=2]="GCC",e[e.GCCHigh=3]="GCCHigh",e[e.DOD=4]="DOD",e[e.DogFood=5]="DogFood",e[e.None=6]="None"}(o||(o={}))},30685:(e,t,n)=>{var o;n.d(t,{Y:()=>o}),function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac",e.win32="win32"}(o||(o={}))},41519:(e,t,n)=>{var o;n.d(t,{G:()=>o}),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(o||(o={}))},39387:(e,t,n)=>{var o;n.d(t,{t:()=>o}),function(e){e[e.Regular=0]="Regular",e[e.Ghost=1]="Ghost",e[e.File=2]="File",e[e.Skill=3]="Skill"}(o||(o={}))},49324:(e,t,n)=>{n.d(t,{r:()=>C,A:()=>b});var o=n(65593),r=n(21137),i=n(30112),a=n(64589),s=n(95653),l=n(79689),c=n(8520),u=n(86688),d=n(9341),p=n(92782),h=n(16895),g=n(658),f=n(64277);const m=(0,p.Q)(f.zQ),y={ShowChatHistoryAllButton:{...h.Pt.margin("0px",m.spacingHorizontalL),"&:disabled":{...h.Pt.borderColor(m.neutralPrimaryAlt),color:m.neutralQuaternary,backgroundColor:m.neutralTertiary}},ShowChatHistoryButtonInSwitcherMenu:{justifyContent:"space-between",alignItems:"center",width:"100%",height:"32px",display:"flex",padding:"0px"},ShowChatHistoryButtonInSwitcherMenuLeftContainer:{display:"flex",alignItems:"center",...h.Pt.padding("0px","0px","0px","6px"),fontWeight:m.fontWeightRegular},ShowChatHistoryMenuIcon:{...h.Pt.padding("0px","4px","0px","0px")},ShowChatHistoryIcon:{fontSize:m.fontSizeBase500,marginRight:m.spacingHorizontalXS}},v=(0,g.n)(y),C=c.memo((({onClick:e,customStyles:t})=>{const n=(0,o.Lh)(u.SG);return c.createElement(r.$,{className:(0,i.z)((0,d.K)().root,v().ShowChatHistoryButtonInSwitcherMenu,(0,d.$)().root,t),onClick:e,"aria-label":n,role:"menu"},c.createElement("div",{className:(0,i.z)(v().ShowChatHistoryButtonInSwitcherMenuLeftContainer)},c.createElement(s.tBH,{className:v().ShowChatHistoryIcon}),n),c.createElement(l.KOR,{className:v().ShowChatHistoryMenuIcon}))})),b=c.memo((({onClick:e,customStyles:t,customIconStyles:n,isDisabled:s})=>{const l=(0,o.Lh)(u.SG);return c.createElement(r.$,{className:(0,i.z)((0,d.K)().root,v().ShowChatHistoryAllButton,t),icon:c.createElement(a.nT,{className:n}),onClick:e,"aria-label":l,disabled:s},l)}))},9341:(e,t,n)=>{n.d(t,{$:()=>d,K:()=>u});var o=n(92782),r=n(16895),i=n(658),a=n(64277);const s=(0,o.Q)(a.zQ),l={root:{...r.Pt.overflow("visible"),backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:s.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:s.colorNeutralBackground3Hover}}}},c={root:{...r.Pt.border("none")}},u=(0,i.n)(l),d=(0,i.n)(c)},31778:(e,t,n)=>{n.d(t,{A:()=>w});var o=n(18603),r=n(38879),i=n(58325),a=n(4396),s=n(45857),l=n(88989),c=n(8520),u=n(31238),d=n(72277),p=n(49118),h=n(30685),g=n(92782),f=n(91836),m=n(16895),y=n(658),v=n(30112),C=n(64277);const b={tooltipText:{fontFamily:"-apple-system",lineHeight:"normal"},badgeText:{fontFamily:"-apple-system",lineHeight:"normal"},icon:{minWidth:"44px",minHeight:"44px",display:"flex",alignItems:"center",justifyContent:"center"}},E=(0,y.n)((e=>({tooltipText:e.tooltipText??{},badgeText:e.badgeText??{},tooltipStack:e.tooltipStack??{},icon:e.icon??{}}))(b));const A=(0,g.Q)(C.tR),S={tooltipText:{...f.g.caption1,color:A.neutralPrimary,wordWrap:"break-word",lineHeight:"16px"},badgeText:{...f.g.caption1Stronger,wordWrap:"break-word",lineHeight:"16px",marginBottom:"12px"},tooltipStack:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"flex-start",maxWidth:"240px",...m.Pt.padding("12px"),...m.Pt.gap("12px")},icon:{display:"grid",justifyItems:"center",alignItems:"center"}},I=(0,y.n)(S),P=(e,t)=>{if(t)for(const n in e)e[n]=(0,v.z)(e[n],t[n])},T=(e=d.JF.NonEncryption)=>{switch(e){case d.JF.Encryption:return(0,u.dD)()?c.createElement(s.fmR,null):c.createElement(s.k5V,null);case d.JF.Warning:return(0,u.dD)()?c.createElement(l.rg6,null):c.createElement(l.MR$,null);case d.JF.NonEncryption:default:return(0,u.dD)()?c.createElement(s.Opi,null):c.createElement(s.nDM,null)}},x=(e=d.JF.NonEncryption,t)=>{switch(e){case d.JF.Encryption:return(0,u.dD)()?c.createElement(s.VMD,{primaryFill:t}):c.createElement(s.Set,{primaryFill:t});case d.JF.Warning:return(0,u.dD)()?c.createElement(l.xEh,{primaryFill:t}):c.createElement(l.Y$h,{primaryFill:t});case d.JF.NonEncryption:default:return(0,u.dD)()?c.createElement(s.urY,{primaryFill:t}):c.createElement(s.vqE,{primaryFill:t})}},w=({styles:e,clpSensitivityIndicatorData:t})=>{const n=(()=>{const e=I(),t=E();(0,u.xp)()===h.Y.IOS&&P(e,t);return e})();return P(n,e),c.createElement(o.A,{openOnHover:!0},c.createElement(r.W,null,c.createElement("span",{className:n.icon},t.icon?c.createElement(t.icon,null):((e=d.JF.NonEncryption,t)=>t?x(e,t):T(e))(t.iconType,t.color))),c.createElement(i.H,{className:n.tooltipStack},c.createElement(p.W,null,t.badgeText&&c.createElement(a.c,{className:n.badgeText},t.badgeText),c.createElement(a.c,{className:n.tooltipText},t.tooltipText))))}},33561:(e,t,n)=>{n.d(t,{K:()=>s});var o=n(18603),r=n(38879),i=n(58325),a=n(8520);const s=({children:e,popoverTitle:t,popoverDuration:n})=>{const[s,l]=(0,a.useState)(!1),c=(0,a.useRef)(void 0);return(0,a.useEffect)((()=>{s&&(c.current&&clearTimeout(c.current),c.current=window.setTimeout((()=>{l(!1),c.current=void 0}),n??2e3)),s||void 0===c.current||(clearTimeout(c.current),c.current=void 0)}),[n,s]),a.createElement(o.A,{withArrow:!0,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:s,onOpenChange:(e,t)=>{l(t.open??!1)}},a.createElement(r.W,null,e),a.createElement(i.H,{"aria-live":"assertive",role:"alert"},t))}},1334:(e,t,n)=>{n.d(t,{D:()=>m});var o=n(8520),r=n(31238),i=n(27982),a=n(21137),s=n(30112),l=n(35571),c=n(49118),u=n(33561),d=n(58651);const p=(e,t)=>{const n=(0,l.A)(t,e);return o.createElement(n,null)},h=(e,t,n,r,l,c)=>{if(e.type===i.jA.CustomButton&&e.customButtonUI)return e.customButtonUI;const u=()=>{e.handleOnMouseEnter&&e.handleOnMouseEnter()},h=()=>{e.handleOnMouseLeave&&e?.handleOnMouseLeave()};d.log(e.text);const g=e.text?t.combinedButton:t.minifiedButton;return o.createElement(a.$,{tabIndex:0,key:l,appearance:e.type==i.jA.Primary?"primary":void 0,className:e.type==i.jA.Primary?(0,s.z)(g,t.primaryButton):g,icon:e?.iconRegular?{children:e.iconHover?p(e.iconRegular,e.iconHover):o.createElement(e.iconRegular,null),className:t.icon}:void 0,"aria-label":e?.ariaLabel,"aria-expanded":"false",title:e.title,onClick:()=>{e.handleButtonOnClick&&e.handleButtonOnClick(n,r,c)},onMouseEnter:u,onMouseLeave:h,onFocus:u,onBlur:h,disabled:e.isDisabled},e?.text)},g=({actionBarButtons:e,styles:t,messageContentElementId:n,chatCardIndex:r,telemetryData:i=""})=>o.createElement(c.W,{style:t.buttonBarRoot,customProperties:{tabIndex:-1}},e?.map(((e,a)=>e.popoverProps?o.createElement(u.K,{key:a,...e.popoverProps},h(e,t,n,r,a,i)):h(e,t,n,r,a,i))));var f=n(62559);const m=e=>(0,r.dD)()?o.createElement(g,{...e}):o.createElement(f.A,{...e})},62559:(e,t,n)=>{n.d(t,{A:()=>m,k:()=>g});var o=n(21394),r=n(41519),i=n(27982),a=n(21137),s=n(30112),l=n(35571),c=n(8520),u=n(88027),d=n(49118),p=n(33561),h=n(41225);const g=(e,t)=>{const n=(0,l.A)(t,e);return c.createElement(n,null)},f=(e,t,n,o,r,l)=>{if(e.type===i.jA.CustomButton&&e.customButtonUI)return e.customButtonUI;const u=e.text?t.combinedButton:t.iconButton,d=e.type==i.jA.Primary?t.primaryButton:t.defaultButton,p=()=>{e.handleOnMouseEnter&&e.handleOnMouseEnter()},h=()=>{e.handleOnMouseLeave&&e?.handleOnMouseLeave()};return c.createElement(a.$,{tabIndex:0,key:r,"aria-label":e?.ariaLabel,"aria-expanded":"false",title:e.title,appearance:e.type==i.jA.Primary?"primary":void 0,className:(0,s.z)(u,d),icon:e?.iconRegular?{children:e.iconHover?g(e.iconRegular,e.iconHover):c.createElement(e.iconRegular,null),className:e?.text?t.combinedButtonIcon:t.icon}:void 0,onClick:()=>{e.handleButtonOnClick&&e.handleButtonOnClick(n,o,l)},onMouseEnter:p,onMouseLeave:h,onFocus:p,onBlur:h,disabled:e.isDisabled},e?.text)},m=({actionBarButtons:e,styles:t,messageContentElementId:n,chatCardIndex:i,telemetryData:a="",pluginAuthButtonProps:s,readAloudButtonProps:l})=>{const g=(0,u.$x)();return c.createElement(d.W,{style:t.buttonBarRoot,customProperties:{tabIndex:-1}},e?.map(((e,o)=>e.popoverProps?c.createElement(p.K,{key:o,...e.popoverProps},f(e,t,n,i,o,a)):f(e,t,n,i,o,a))),s&&c.createElement(o.N,{...s,customStyles:h.cu,theme:g===r.G.defaultBlack?"dark":"light"}),l?.isReadAloudEnabled&&l.getReadAloudActionButton((()=>n?document.getElementById(n):null)))}},41225:(e,t,n)=>{n.d(t,{MB:()=>A,cu:()=>P,jd:()=>I});var o=n(30685),r=n(92782),i=n(16895),a=n(91836),s=n(39278),l=n(658),c=n(88027),u=n(64277),d=n(31238),p=n(36130),h=n(44079);const g={combinedButton:{fontFamily:"-apple-system",lineHeight:"normal"},buttonBarRoot:{fontFamily:"-apple-system",lineHeight:"normal"},primaryButton:{fontFamily:"-apple-system",lineHeight:"normal"},defaultButton:{fontFamily:"-apple-system",lineHeight:"normal"},showMeButton:{fontFamily:"-apple-system",lineHeight:"normal"},combinedButtonIcon:{fontFamily:"-apple-system",lineHeight:"normal"},iconButton:{fontFamily:"-apple-system",lineHeight:"normal"}},f=(0,l.n)((0,h.Q)(g));var m=n(45626);const y=(0,r.Q)(u.tR),v={backgroundColor:y.neutralLight,...i.Pt.border("1px","solid",y.neutralLighterAlt),...i.Pt.borderRadius(y.borderRadiusMedium)},C={height:"16px",width:"16px",...i.Pt.padding(0)},b={height:"24px",minWidth:"20px",...i.Pt.padding("4px","8px"),...a.g.caption1},E={buttonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row",marginTop:"12px",flexWrap:"wrap",rowGap:"8px"},showMeButtonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row"},primaryButton:{...i.Pt.border("1px","solid",y.themeSecondary),...i.Pt.borderRadius(y.borderRadiusMedium),"@media (forced-colors: none)":{backgroundColor:y.themeSecondary,"&:hover":{backgroundColor:y.themePrimary,...i.Pt.border("1px","solid",y.themePrimary)},"&:active":{backgroundColor:y.themePrimary,...i.Pt.border("1px","solid",y.themePrimary)},"&:disabled":{backgroundColor:y.neutralLighter,...i.Pt.border("1px","solid",y.neutralQuaternary)},"&:hover:active":{backgroundColor:y.themeTertiary,...i.Pt.border("1px","solid",y.themeTertiary)}}},defaultButton:{...v},showMeButton:{backgroundColor:y.neutralLight,...i.Pt.border("1px","solid",y.neutralLighterAlt),...i.Pt.borderRadius(y.borderRadiusMedium),"&:hover":{color:y.themePrimary}},icon:{height:"24px",width:"24px",...i.Pt.padding(0),[`&${s.h.icon}`]:{height:"20px",width:"20px"}},combinedButtonIcon:{...C,[`&${s.h.icon}`]:{height:"16px",width:"16px"}},iconButton:{height:"24px",width:"24px",minWidth:"20px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",...i.Pt.padding("2px")},combinedButton:{...b},minifiedButton:{height:"40px",width:"44px",minWidth:"44px",[`&${s.h.icon}`]:{height:"24px",width:"24px"}}},A=()=>{const e=E,t=(0,m.PA)(),n=(0,c.kF)()?t:e,r=g;return(0,d.xp)()===o.Y.IOS?{...n,...r}:{...n}},S=(0,l.n)(E),I=()=>{const e=S(),t=(0,m.Up)(),n=(0,c.kF)()?t:e,r=f();if((0,d.xp)()===o.Y.IOS)(0,p.bt)(n,r);return n},P=((0,l.n)({emptyIcon:{height:"0px",width:"0px"}}),(0,l.n)({authButton:{...v,...b},appIcon:{...C},title:{...a.g.caption1}}))},45626:(e,t,n)=>{n.d(t,{PA:()=>p,Up:()=>h,Xt:()=>g});var o=n(62653),r=n(16895),i=n(91836),a=n(39278),s=n(658);const l={backgroundColor:o.L.colorNeutralBackground1,...r.Pt.border("1px","solid",o.L.colorNeutralStroke1),borderRadius:o.L.borderRadiusMedium},c={height:"16px",width:"16px",...r.Pt.padding(0)},u={minWidth:"32px",...r.Pt.padding(o.L.spacingVerticalXS,o.L.spacingHorizontalS),...i.g.caption1},d={buttonBarRoot:{width:"100%",columnGap:o.L.spacingHorizontalS,flexDirection:"row",marginTop:o.L.spacingVerticalM,flexWrap:"wrap",rowGap:o.L.spacingVerticalS},showMeButtonBarRoot:{width:"100%",columnGap:o.L.spacingHorizontalS,flexDirection:"row"},primaryButton:{...r.Pt.border("1px","solid",o.L.colorBrandBackground2),borderRadius:o.L.borderRadiusMedium,"@media (forced-colors: none)":{backgroundColor:o.L.colorBrandBackground2,"&:hover":{backgroundColor:o.L.colorBrandBackground,...r.Pt.border("1px","solid",o.L.colorBrandBackground)},"&:active":{backgroundColor:o.L.colorBrandBackground,...r.Pt.border("1px","solid",o.L.colorBrandBackground)},"&:disabled":{backgroundColor:o.L.colorNeutralBackgroundDisabled,...r.Pt.border("1px","solid",o.L.colorNeutralStrokeDisabled)},"&:hover:active":{backgroundColor:o.L.colorBrandBackgroundHover,...r.Pt.border("1px","solid",o.L.colorBrandBackgroundHover)}}},defaultButton:{...l},showMeButton:{backgroundColor:o.L.colorNeutralBackground1,...r.Pt.border("1px","solid",o.L.colorNeutralForeground2),borderRadius:o.L.borderRadiusMedium,"&:hover":{color:o.L.colorBrandBackground}},icon:{height:"24px",width:"24px",...r.Pt.padding(0),[`&${a.h.icon}`]:{height:"20px",width:"20px"}},combinedButtonIcon:{...c,[`&${a.h.icon}`]:{height:"16px",width:"16px"}},iconButton:{maxWidth:"32px",minWidth:"32px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",...r.Pt.padding(o.L.spacingVerticalXXS)},combinedButton:{...u},minifiedButton:{height:"40px",width:"44px",minWidth:"44px",[`&${a.h.icon}`]:{height:"24px",width:"24px"}}},p=()=>d,h=(0,s.n)(d),g=(0,s.n)({authButton:{...l,...u},appIcon:{...c},title:{...i.g.caption1}})},5219:(e,t,n)=>{n.d(t,{i:()=>s});var o=n(92619),r=n(8520),i=n(35572),a=n(77942);const s=e=>{const{requestType:t,authUrl:n,botInvokeRequest:s,apiPluginAuthRequest:l,appId:c}=r.useMemo((()=>(0,i.m)(e)),[e]),{pluginServiceProvider:u}=(0,a.gW)(),d=(0,o.Y$)(),p=!!e&&t&&(s||l)&&u?.activityProvider&&u?.cardServices?.appService;return r.useMemo((()=>p?{requestType:t,url:n,appId:c??"",originalBotInvokeRequest:s,originalAPIPluginAuthRequest:l,activityProvider:u?.activityProvider,appService:u?.cardServices?.appService,isAPIPluginsAuthEnabled:d.isApiPluginsAuthEnabled,isAPIPlugin:"APIPluginAuth"===t||"TypeAPowerPlatformAuth"===t}:void 0),[t,n,c,s,l,p,u?.activityProvider,u?.cardServices?.appService,d.isApiPluginsAuthEnabled])}},33147:(e,t,n)=>{n.d(t,{mO:()=>S,gN:()=>T,dQ:()=>P});var o=n(30685),r=n(92782),i=n(16895),a=n(62653),s=n(91836),l=n(658),c=n(30112),u=n(88027),d=n(64277),p=n(31238),h=n(36130),g=n(41225),f=n(97511),m=n(89556);const y={chatCard:{fontFamily:"-apple-system",lineHeight:"normal"},defaultRoot:{fontFamily:"-apple-system",lineHeight:"normal"},loader:{fontFamily:"-apple-system",lineHeight:"normal"},human:{fontFamily:"-apple-system",lineHeight:"normal"},humanContent:{fontFamily:"-apple-system",lineHeight:"normal"},chat:{fontFamily:"-apple-system",lineHeight:"normal"},chatContent:{fontFamily:"-apple-system",lineHeight:"normal"},text:{fontFamily:"-apple-system",lineHeight:"normal"}},v=(0,l.n)((0,m._)(y));var C=n(23300);const b=(0,r.Q)(d.tR),E={defaultRoot:{...i.Pt.borderRadius("8px"),alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere",display:"flex",boxSizing:"border-box"},loader:{boxSizing:"border-box",display:"flex",width:"inherit",...i.Pt.gap("4px")},human:{alignSelf:"flex-end",maxWidth:"720px",...i.Pt.margin(a.L.spacingVerticalS,"0px",a.L.spacingVerticalS,"64px")},humanContent:{color:b.black,backgroundColor:b.themeLight},chat:{width:"100%",maxWidth:"720px",alignSelf:"flex-start",boxShadow:b.shadow2},chatV2:{width:"100%",maxWidth:"720px",alignSelf:"flex-start"},chatContent:{backgroundColor:b.neutralLight},chatCard:{width:"inherit",...i.Pt.padding("12px")},text:{...s.g.body1},strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:{...i.Pt.border("1px","solid",b.neutralLighterAlt)},...(0,g.MB)(),...(0,f.p0)()},A=()=>E,S=()=>{const e=A(),t=(0,C.r)(),n=(0,u.kF)()?t:e,r=y;return(0,p.xp)()===o.Y.IOS?{...n,...r}:{...n}},I=(0,l.n)(A()),P=()=>{const e=I(),t=(0,C.U)(),n=(0,u.kF)()?t:e,r=v();if((0,p.xp)()===o.Y.IOS)(0,h.bt)(n,r);return n},T=(e,t,n,o,r=!1)=>{const i={};return i.defaultRoot=(0,c.z)(e.defaultRoot,"human"===t?e.human:r?e.chatV2:e.chat),n&&(i.defaultRoot=(0,c.z)(i.defaultRoot,e.cardHighContrast)),i.loader=e.loader,i.chatCard=(0,c.z)(e.chatCard,"human"===t?e.humanContent:e.chatContent),i.strikeThroughText=o?e.strikeThroughText:"",i}},23300:(e,t,n)=>{n.d(t,{U:()=>d,r:()=>u});var o=n(62653),r=n(16895),i=n(91836),a=n(658),s=n(45626),l=n(56242);const c={defaultRoot:{borderRadius:o.L.borderRadiusXLarge,alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere",display:"flex",boxSizing:"border-box"},loader:{boxSizing:"border-box",display:"flex",width:"inherit",...r.Pt.gap("4px")},human:{alignSelf:"flex-end",maxWidth:"720px",...r.Pt.margin(o.L.spacingVerticalS,"0px",o.L.spacingVerticalS,"64px")},humanContent:{color:o.L.colorNeutralForeground1,backgroundColor:o.L.colorBrandBackground2},chat:{width:"100%",maxWidth:"720px",alignSelf:"flex-start",boxShadow:o.L.shadow2},chatV2:{width:"100%",maxWidth:"720px",alignSelf:"flex-start"},chatContent:{backgroundColor:o.L.colorNeutralBackground1},chatCard:{width:"inherit",...r.Pt.padding(o.L.spacingVerticalM)},text:{...i.g.body1},strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:{...r.Pt.border("1px","solid",o.L.colorNeutralStroke1)},...(0,s.PA)(),...(0,l.W)()},u=()=>c,d=(0,a.n)(c)},9124:(e,t,n)=>{n.d(t,{A:()=>p});var o=n(40924),r=n(8520),i=n(36130),a=n(85558),s=n(92782),l=n(658),c=n(64277);const u={root:{":hover":{backgroundColor:(0,s.Q)(c.tR).themeMedium}}},d=(0,l.n)(u),p=({referenceIndex:e,referenceProps:t,shouldSupportCitationsInAvalon:n,telemetryData:s="",citationsV2:l})=>{const c=d(),u=(0,o.I)({index:e,referenceProps:(0,a._)({referenceIndex:e,referenceProps:t},n),previewSurfaceProps:{tabIndex:0,style:{overflowWrap:"anywhere"}}}),p=()=>{n?!(0,i.Qh)(t?.path[0])&&t.url&&window.open(t.url,"_blank"):void 0!==t.url&&window.open(t.url,"_blank"),t.onClickCitationLink&&t.onClickCitationLink(e,t.path,s)};if(l){const t=l.find((t=>t.citationIndex===e));if(t)return r.createElement(t.citationPill,{onClick:p})}return r.createElement(u.Citation,{onClick:p,className:c.root},e)}},51524:(e,t,n)=>{n.d(t,{A:()=>E});var o=n(10145),r=n(8520),i=n(36130),a=n(49118),s=n(30112),l=n(21137),c=n(41225),u=n(92782),d=n(16895),p=n(91836),h=n(658),g=n(64277);const f=(0,u.Q)(g.tR),m={stack:{flexFlow:"wrap"},accordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:"400",fontSize:"12px",lineHeight:"16px",display:"flex",alignItems:"center",color:f.neutralPrimary,columnGap:"8px",rowGap:"8px",flexDirection:"row",marginTop:"12px",flexWrap:"wrap"},accordionCardButton:{height:"24px",minWidth:"20px",...d.Pt.padding("4px","8px"),...p.g.caption1,backgroundColor:f.neutralLight,...d.Pt.border("1px","solid",f.neutralLighterAlt),...d.Pt.borderRadius(f.borderRadiusMedium)}},y=(0,h.n)(m),v=({styles:e,cardButtons:t})=>{const n=(0,i.bt)(y(),e),o=(0,c.jd)(),u=(0,s.z)(o.defaultButton,o.combinedButton),d=(0,s.z)(u,n.accordionCardButton);return r.createElement(a.W,{horizontal:!0,style:n.stack},r.createElement(a.W,{horizontal:!0,style:n.accordionCardFooter},t?.map(((e,t)=>r.createElement(l.$,{tabIndex:0,key:t,className:d,icon:e.icon,title:e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled,onMouseEnter:e?.handleOnMouseEnter,onMouseLeave:e?.handleOnMouseLeave,onFocus:e?.handleOnMouseEnter,onBlur:e?.handleOnMouseLeave},e.buttonText)))))};var C=n(23420);function b(e,t){return r.createElement(v,{styles:e,cardButtons:t})}const E=({styles:e,body:t})=>{const n=(0,i.bt)((0,C.t)(),e),s=t.renderHeader?t.renderHeader((()=>{})):t.cardContent?.contentHeader?r.createElement(o.E,{className:n.contentHeader},t.cardContent.contentHeader):void 0,l=()=>t.cardContent?.contentBody,c=t.renderBody?t.renderBody((()=>l(t.cardContent))):l(t.cardContent),u=t.renderFooter?t.renderFooter((()=>b(e,t.cardContent?.cardButtons))):t.cardContent?.cardButtons?b(e,t.cardContent?.cardButtons):void 0;return r.createElement(a.W,{style:n.contentCard,customProperties:{tabIndex:-1}},s,c,u)}},23420:(e,t,n)=>{n.d(t,{t:()=>m});var o=n(30685),r=n(92782),i=n(16895),a=n(91836),s=n(658),l=n(31238),c=n(36130),u=n(64277);const d=(0,s.n)({stack:(p={contentHeader:{fontFamily:"-apple-system",lineHeight:"normal"}}).stack??{},contentCard:p.contentCard??{},contentHeader:p.contentHeader??{}});var p;const h=(0,r.Q)(u.tR),g={stack:{"> *":{marginBottom:"12px"}},contentCard:{...i.Pt.border("1px","solid",h.neutralLighterAlt),...i.Pt.margin("8px","20px","8px","15px"),...i.Pt.padding("8px"),boxShadow:h.shadow4,backgroundColor:h.neutralLight,...i.Pt.borderRadius(h.borderRadiusXLarge),overflowWrap:"anywhere",color:h.neutralPrimary},contentHeader:{...a.g.body1,marginBottom:"12px"}},f=(0,s.n)(g),m=()=>{const e=f(),t=d();if((0,l.xp)()===o.Y.IOS)(0,c.bt)(e,t);return e}},58295:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(30112),r=n(10145),i=n(21137),a=n(8520),s=n(36130),l=n(49118),c=n(65593),u=n(92936),d=n(86688),p=n(39086);const h=({styles:e={},onClickShowMeButton:t,onClickHelpButton:n})=>{const r=(0,c.Lh)(d.bK),s=(0,p.LW)(),h=e.combinedButton,g=e.showMeButton;return a.createElement(l.W,{style:e.showMeButtonBarRoot,customProperties:{tabIndex:-1}},a.createElement(i.$,{tabIndex:0,"aria-label":r,className:(0,o.z)(h,g),onClick:t},r),n&&a.createElement(i.$,{tabIndex:0,"aria-label":s,className:(0,o.z)(h,g),icon:a.createElement(u.XLu,null),onClick:n},s))};var g=n(9124),f=n(21017);const m=({styles:e,richText:t,renderTextWithCitation:n=e=>null,references:i=[]})=>{t.linkText&&t.linkText.linkSuffix?.includes("%s")&&(t.text+=t.linkText.linkSuffix.substring(0,t.linkText.linkSuffix.indexOf("%s")),t.linkText.linkSuffix=t.linkText.linkSuffix.substring(t.linkText.linkSuffix.indexOf("%s")+2));return a.createElement("span",null,a.createElement(r.E,{block:!0,className:(0,o.z)(e.text,e.richTextRoot)},t.text?(0,s.mj)(t.text,i)?n(t.text):t.text:"",t.linkText&&a.createElement(f.N,{target:t.linkText.linkUrl?"_blank":"",href:t.linkText.linkUrl??"#",className:(0,o.z)(e.linkText,t.linkText.linkUrl?"":e.linkButton),onClick:()=>{t.linkText.linkUrl||t.linkText.linkOnClick()}},t.linkText.text),t.linkText?.linkSuffix?(0,s.mj)(t.linkText?.linkSuffix,i)?n(t.linkText?.linkSuffix):t.linkText?.linkSuffix:""))};var y=n(10071);const v=({styles:e,body:t,strikeThroughText:n=!1,references:c=[],pillsList:u=[],handlePillOnClick:d=null,handleShowMeOnClick:p=null,telemetryData:f="",shouldSupportCitationsInAvalon:v})=>{let C=(0,o.z)(e.text,e.rootStack);n&&(C=(0,o.z)(e.text,e.strikeThroughText,e.rootStack));const b=(0,y.C)(),E={styles:e,onClickShowMeButton:p,onClickHelpButton:null},A=e=>(0,s.Iw)(e,c).map(((e,t)=>a.createElement("span",{key:t},e.message,e.references&&e.references.map(((e,t)=>a.createElement(g.A,{...e,key:t,telemetryData:f,shouldSupportCitationsInAvalon:v}))))));return a.createElement(l.W,{style:C},t.messageHeader&&(t.messageHeader.text||t.messageHeader.linkText)&&a.createElement(l.W,{style:e.messageHeader},a.createElement(m,{styles:e,richText:t.messageHeader,references:c,renderTextWithCitation:A})),t.embeddedLists&&t.embeddedLists.map(((t,n)=>a.createElement(l.W,{key:n,style:e.listStackStyle},t.listHeader&&a.createElement(r.E,{className:(0,o.z)(e.text,e.listHeader)},(0,s.mj)(t.listHeader,c)?A(t.listHeader):t.listHeader),t.listItems&&t.listItems.length>0&&a.createElement("ul",{className:e.list},t.listItems.map(((t,n)=>a.createElement(r.E,{block:!0,key:n,className:e.text},a.createElement("li",null,t.title&&a.createElement("span",{className:e.listItemTitle},(0,s.mj)(t.title,c)?A(t.title):t.title),(0,s.mj)(t.text,c)?A(t.text):t.text))))),t.listFooter&&(t.listFooter.text||t.listFooter.linkText)&&a.createElement(l.W,{style:e.listFooter},a.createElement(m,{styles:e,richText:t.listFooter,references:c,renderTextWithCitation:A}))))),t.messageFooter&&(t.messageFooter.text||t.messageFooter.linkText)&&a.createElement(l.W,{style:e.messageFooter},a.createElement(m,{styles:e,richText:t.messageFooter,references:c,renderTextWithCitation:A})),p&&a.createElement(h,{...E}),u&&u.length>0&&a.createElement(l.W,{style:b.pillsContainer},u.map(((e,t)=>a.createElement(i.$,{key:t,className:b.pillsItem,onClick:()=>{d&&d(e)}},e.data)))))}},10071:(e,t,n)=>{n.d(t,{C:()=>I});var o=n(30685),r=n(92782),i=n(16895),a=n(62653),s=n(91836),l=n(658),c=n(88027),u=n(64277),d=n(31238),p=n(36130),h=n(33147),g=n(89556);const f={messageHeader:{fontFamily:"-apple-system",lineHeight:"normal"},messageFooter:{fontFamily:"-apple-system",lineHeight:"normal"},listStackStyle:{fontFamily:"-apple-system",lineHeight:"normal"},pillsItem:{fontFamily:"-apple-system",lineHeight:"normal"},list:{fontFamily:"-apple-system",lineHeight:"normal"},listHeader:{fontFamily:"-apple-system",lineHeight:"normal"},listFooter:{fontFamily:"-apple-system",lineHeight:"normal"},linkText:{fontFamily:"-apple-system",lineHeight:"normal"},linkButton:{fontFamily:"-apple-system",lineHeight:"normal"},listItemTitle:{fontFamily:"-apple-system",lineHeight:"normal"},richTextRoot:{fontFamily:"-apple-system",lineHeight:"normal"}},m=(0,l.n)({rootStack:(y=f).rootStack??{},messageHeader:y.messageHeader??{},messageFooter:y.messageFooter??{},listStackStyle:y.listStackStyle??{},pillsItem:y.listStackStyle??{},pillsContainer:y.listStackStyle??{},list:y.list??{},listHeader:y.listHeader??{},listFooter:y.listFooter??{},linkText:y.linkText??{},linkButton:y.linkButton??{},listItemTitle:y.listItemTitle??{},richTextRoot:y.richTextRoot??{},...(0,g.J)(y)});var y,v=n(23300);const C={rootStack:{textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"},...i.Pt.gap("12px")},messageHeader:{},messageFooter:{},listStackStyle:{...i.Pt.gap("4px"),...i.Pt.gap("12px")},pillsContainer:{alignItems:"flex-start"},pillsItem:{backgroundColor:a.L.colorNeutralBackground3,color:a.L.colorNeutralForeground2,"&:hover":{backgroundColor:a.L.colorNeutralBackground2Hover,color:a.L.colorNeutralForeground1Hover},marginBottom:"10px",width:"fit-content",textAlign:"left",...i.Pt.border("transparent"),...i.Pt.borderColor(a.L.colorNeutralBackground3),display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",...i.Pt.borderRadius("4px"),...i.Pt.gap("4px"),...i.Pt.gap("12px")},list:{...i.Pt.margin("0px"),...i.Pt.gap("4px")},listHeader:{fontWeight:600},listFooter:{},linkText:{...s.g.body1,color:a.L.colorBrandForeground1,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:a.L.colorBrandForeground1}}},linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"},...(0,v.r)()},b=(0,l.n)(C),E=(0,r.Q)(u.tR),A={rootStack:{textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"},...i.Pt.gap("12px")},messageHeader:{},messageFooter:{},listStackStyle:{...i.Pt.gap("4px"),...i.Pt.gap("12px")},pillsContainer:{alignItems:"flex-start"},pillsItem:{backgroundColor:a.L.colorNeutralBackground3,color:a.L.colorNeutralForeground2,"&:hover":{backgroundColor:a.L.colorNeutralBackground2Hover,color:a.L.colorNeutralForeground1Hover},marginBottom:"10px",width:"fit-content",textAlign:"left",...i.Pt.border("transparent"),...i.Pt.borderColor(a.L.colorNeutralBackground3),display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",...i.Pt.borderRadius("4px"),...i.Pt.gap("4px"),...i.Pt.gap("12px")},list:{...i.Pt.margin("0px"),...i.Pt.gap("4px")},listHeader:{fontWeight:600},listFooter:{},linkText:{...s.g.body1,color:E.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:E.themePrimary}}},linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"},...(0,h.mO)()},S=(0,l.n)(A),I=()=>{const e=S(),t=b(),n=(0,c.kF)()?t:e,r=m();if((0,d.xp)()===o.Y.IOS)(0,p.bt)(n,r);return n}},93400:(e,t,n)=>{n.d(t,{A:()=>x});var o=n(35252),r=n(65593),i=n(19080),a=n(30112),s=n(21137),l=n(68779),c=n(10145),u=n(35571),d=n(60788),p=n(85023),h=n(8520),g=n(86688),f=n(31238),m=n(36130),y=n(31778),v=n(44624),C=n(49118),b=n(1334),E=n(97511);const A=(e,t)=>{const n=(0,u.A)(t,e);return h.createElement(n,null)},S={dislikeButtonAccessibilityLabel:g.jo,likeButtonAccessibilityLabel:g.Rw,aiPoweredDisclaimer:g.zw,aiGeneratedDisclaimer:g.yd,aiPoweredDisclaimerMinified:g.uw,aiGeneratedDisclaimerMinified:g.DR,sendFeedbackButtonLabel:g.wg},I=(e,t,n,o,r,i)=>h.createElement(l.m,{content:h.createElement(c.E,{className:e.tooltipText},t?n:o),relationship:"description"},h.createElement(c.E,{className:e.feedbackTextMinified},t?r:i)),P=(e,t,n,o)=>{const r=t?n:o;return h.createElement(c.E,{className:e.feedbackText},r)},T=(e,t,n,r)=>{const i=t?n:r;return h.createElement(o.$,{className:e.fluentAIDisclaimer},i)},x=({styles:e={},feedbackData:t,shouldShowAIGeneratedIndicator:n=!0,shouldShowAIPoweredIndicator:o,displayPosition:l,shouldShowFeedbackButtons:c=!0,handleThumbsUpClick:u,handleThumbsDownClick:g,handleSendFeedbackClick:x,showMinifiedUI:w=!1,clpSensitivityIndicatorData:k,telemetryData:_="",actionBarProps:D,useFluentAIGeneratedIndicator:F=!1,htmlMessageContentElementId:L,feedbackCategory:O=i.E.Success})=>{const R=(0,r.kQ)(S),M=(0,E.jd)();e.headerBar=(0,a.z)(e.footerBar,e.headerBar);const B=(0,f.dD)()?d.Oy3:d.FF8,N=(0,f.dD)()?d.UL4:d.p4c,V=(0,f.dD)()?d.Cbs:d.r3T,H=(0,f.dD)()?d.K53:d.vqM,U=(0,f.dD)()?p.tNe:p.qGu,j=(0,f.dD)()?p.p2N:p.EPs;D.styles=(0,m.bt)(D.styles,M);const z=()=>(t?t.invocationTimestamp=Date.now():t={invocationTimestamp:Date.now()},t.contextData?t.contextData.feedbackCategory=O:t.contextData={feedbackCategory:O},t);return h.createElement(C.W,{horizontal:!0,reverse:O===i.E.Success,customProperties:{tabIndex:-1},style:l===i.O.Header?e.headerBar:e.footerBar},h.createElement(v.l,null,h.createElement(C.W,{horizontal:!0,style:e.feedbackButtonsStack},D&&O===i.E.Success&&h.createElement(b.D,{...D}),c&&O===i.E.Success&&h.createElement(h.Fragment,null,h.createElement(s.$,{title:R.likeButtonAccessibilityLabel(),"aria-label":R.likeButtonAccessibilityLabel(),appearance:"transparent",size:"small",className:e.feedbackButton,icon:A(V,H),onClick:e=>{const t=e.target.closest("button");u(z(),_,t,L)}}),h.createElement(s.$,{title:R.dislikeButtonAccessibilityLabel(),className:e.feedbackButton,"aria-label":R.dislikeButtonAccessibilityLabel(),appearance:"transparent",size:"small",icon:A(B,N),onClick:e=>{const t=e.target.closest("button");g(z(),_,t,L)}})),c&&O===i.E.Error&&h.createElement(h.Fragment,null,h.createElement(s.$,{title:R.sendFeedbackButtonLabel(),"aria-label":R.sendFeedbackButtonLabel(),className:(0,a.z)(e.combinedButton,e.defaultButton),icon:A(U,j),onClick:e=>{const t=e.target.closest("button");x(z(),_,t,L)}},R.sendFeedbackButtonLabel())))),O===i.E.Success&&h.createElement(v.l,null,h.createElement(C.W,{horizontal:!0,style:e.feedbackDisclaimerStack},k&&h.createElement(y.A,{styles:e,clpSensitivityIndicatorData:k}),n&&(w?I(e,!!o,R.aiPoweredDisclaimer(),R.aiGeneratedDisclaimer(),R.aiPoweredDisclaimerMinified(),R.aiGeneratedDisclaimerMinified()):F?T(e,!!o,R.aiPoweredDisclaimer(),R.aiGeneratedDisclaimer()):P(e,!!o,R.aiPoweredDisclaimer(),R.aiGeneratedDisclaimer())))))}},97511:(e,t,n)=>{n.d(t,{p0:()=>A,jd:()=>T,gN:()=>I});var o=n(30685),r=n(44079),i=n(92782),a=n(16895),s=n(91836),l=n(39278),c=n(658),u=n(88027),d=n(64277),p=n(31238),h=n(36130),g=n(21812);const f=(0,i.Q)(d.tR),m={feedbackTextMinified:{...s.g.caption1,color:f.neutralSecondaryAlt,fontFamily:"-apple-system",lineHeight:"normal"},feedbackButton:{width:"44px",height:"44px",maxWidth:"unset",lineHeight:"normal",backgroundColor:"transparent",...a.Pt.border("0px"),[`&:hover .${l.h.icon}`]:{cursor:"pointer",color:f.themePrimary}},tooltipText:{...s.g.caption1,color:f.neutralPrimary,fontFamily:"-apple-system",lineHeight:"normal"}},y=()=>m,v=(0,c.n)((0,g.v)(m));var C=n(56242);const b=(0,i.Q)(d.tR),E={footerBar:{...a.Pt.padding("4px","0px"),width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},headerBar:{...a.Pt.padding("0px","4px")},feedbackText:{...s.g.caption2,color:b.neutralSecondaryAlt},feedbackTextMinified:{...s.g.caption1,color:b.neutralSecondaryAlt},feedbackButtonsStack:{alignItems:"center",...a.Pt.gap("2px")},feedbackButton:{backgroundColor:"transparent",[`&:hover .${l.h.icon}`]:{cursor:"pointer",color:b.themePrimary}},feedbackDisclaimerStack:{alignItems:"center",...a.Pt.gap("2px")},fluentAIDisclaimer:{whiteSpace:"initial"},tooltipText:{...s.g.caption1,color:b.neutralPrimary}},A=()=>{const e=E,t=(0,C.W)(),n=(0,u.kF)()?t:e,r=y();return(0,p.xp)()===o.Y.IOS?{...n,...r}:{...n}},S=(0,c.n)(E),I=()=>{const e=S(),t=(0,C.W)(),n=v(),r=(0,u.kF)()?t:e;if((0,p.xp)()===o.Y.IOS)(0,h.bt)(r,n);return r},P={buttonBarRoot:{marginTop:"0px",width:"auto"},minifiedButton:{...y().feedbackButton},icon:{}},T=(0,c.n)((0,r.Q)(P))},56242:(e,t,n)=>{n.d(t,{W:()=>c});var o=n(16895),r=n(62653),i=n(91836),a=n(39278),s=n(658);const l={footerBar:{...o.Pt.padding(r.L.spacingVerticalXS,r.L.spacingHorizontalNone),width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},headerBar:{...o.Pt.padding(r.L.spacingVerticalNone,r.L.spacingHorizontalXS)},feedbackText:{...i.g.caption2,color:r.L.colorNeutralForeground4},feedbackTextMinified:{...i.g.caption1,color:r.L.colorNeutralForeground4},feedbackButtonsStack:{alignItems:"center",...o.Pt.gap("2px")},feedbackButton:{backgroundColor:"transparent",[`&:hover .${a.h.icon}`]:{cursor:"pointer",color:r.L.colorBrandForeground1}},feedbackDisclaimerStack:{alignItems:"center",gap:"2px"},fluentAIDisclaimer:{whiteSpace:"initial"},tooltipText:{...i.g.caption1,color:r.L.colorNeutralForeground1}},c=()=>l;(0,s.n)(l)},61398:(e,t,n)=>{n.d(t,{T:()=>B});var o=n(8520),r=n(94329);const i="dialog-container",a=(e,t,a,l,c,u,d,p,h,g,f,m,y,v,C,b,E)=>{!function(e){e.setAttribute("id",i),s(),document.body.appendChild(e)}(t);const A=o.lazy((()=>n.e("dialog-modal").then(n.bind(n,71943)).then((({DialogModal:e})=>({default:e})))));r.render(o.createElement(o.Suspense,{fallback:null},o.createElement(A,{dialogContent:e,botService:a,appDefinition:l,hostContext:d,tokenService:c,userContext:u,subEntityId:p,onNavigateToApp:h,telemetryService:f,dialogTelemetryService:g,onDialogClose:()=>{s()},supportedActions:y,postActionExecute:v,getOverriddenDialogActions:C,dialogParameters:b,hostService:m,conversationId:E})),t)};function s(){const e=document.getElementById(i);e&&e instanceof HTMLElement&&(r.unmountComponentAtNode(e),e.remove())}var l=n(55076),c=n(79490),u=n(57160),d=n(66636),p=n(15666),h=n(74487),g=n(99609),f=n(11120),m=n(71086),y=n(30185),v=n(25510);class C{constructor(e,t,n,o,r){this.onClose=e,this.onUpdate=t,this.commandId=n,this.telemetryService=o,this.getAuthAdaptiveCard=r}handleAuth(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){var t,n,o,r,i,a;const{authUrl:s,originalRequest:l,appName:c}=e,u=new y.k(this.telemetryService,f.yx.CardService,f.xe.ActionSubmit),d={};d[f.vP.ModalViewType]=f.lp.TaskModule,d[f.vP.ActionType]=f.X2.Auth;try{if(!this.getAuthAdaptiveCard)return u.logMetricEndWithError({props:d,diagnosticsData:`Error: Auth failed. Auth provider is not available, Appid: ${(0,v.n)(null===(t=null==l?void 0:l.cardData)||void 0===t?void 0:t.titleId,null===(n=null==l?void 0:l.cardData)||void 0===n?void 0:n.appId)}`},null===(o=l.cardData)||void 0===o?void 0:o.cardId),void this.onClose({taskModuleClosedReason:"Done",resultType:"text",text:"Error: Auth failed. Activity provider is not available"});const e=this.getAuthAdaptiveCard({appName:c,authUrl:s,appId:l.appId,originalRequest:l}),r={type:g.g.Card,card:JSON.stringify(e.card)};this.onUpdate(r)}catch(e){return u.logMetricEndWithError({props:d,diagnosticsData:`Error: Auth failed. ErrorMessage: ${(null==e?void 0:e.message)||e}, Appid: ${(0,v.n)(null===(r=null==l?void 0:l.cardData)||void 0===r?void 0:r.titleId,null===(i=null==l?void 0:l.cardData)||void 0===i?void 0:i.appId)}`},null===(a=l.cardData)||void 0===a?void 0:a.cardId),void this.onClose({taskModuleClosedReason:"Done",resultType:"text",text:"Error: Auth failed"})}}))}getDialogSubmit(e,t,n){return o=>(0,c.__awaiter)(this,void 0,void 0,(function*(){var r,i,a,s;if(!o)return void this.onClose({taskModuleClosedReason:"CancelledByUser",resultType:"text",text:""});let l;if("object"==typeof o&&n){const e=function(e){const{authentication:t}=e;return t}(o);if(e){const o={appDefinition:t,signInUrl:e.authUrl},i=yield null==n?void 0:n(o);i.code?(l=e.originalRequest,(null===(r=null==l?void 0:l.requestBody)||void 0===r?void 0:r.value)&&(l.requestBody.value.state=i.code)):this.handleResultTypeMessage("Sign in failed")}}const c=new y.k(this.telemetryService,f.yx.CardService,f.xe.ActionSubmit),u={};u[f.vP.ModalViewType]=f.lp.TaskModule,u[f.vP.ActionType]=f.X2.Submit;const d=null!=l?l:{botId:null!==(a=null===(i=t.webApplicationInfo)||void 0===i?void 0:i.id)&&void 0!==a?a:"",appId:null!==(s=t.id)&&void 0!==s?s:"",requestBody:{name:"composeExtension/submitAction",value:{commandId:this.commandId,commandContext:"compose",context:{theme:"default"},data:o}}};e.botInvoke(d).then((e=>{var t,n,o,r,i,a,s;this.handleTaskSubmitResponse(e,d),c.logMetricEnd({props:u,diagnosticsData:`TypeOfCard: ${null===(t=null==d?void 0:d.cardData)||void 0===t?void 0:t.contentType}, cardId : ${null===(n=null==d?void 0:d.cardData)||void 0===n?void 0:n.cardId}, cardsize: ${null===(r=null===(o=null==d?void 0:d.cardData)||void 0===o?void 0:o.content)||void 0===r?void 0:r.length}, Appid: ${(0,v.n)(null===(i=null==d?void 0:d.cardData)||void 0===i?void 0:i.titleId,null===(a=null==d?void 0:d.cardData)||void 0===a?void 0:a.appId)}`},null===(s=d.cardData)||void 0===s?void 0:s.cardId)})).catch((e=>{var t,n,o;c.logMetricEndWithError({props:u,diagnosticsData:`Error: Bot invoke failed. Bot response is empty or error, Appid: ${(0,v.n)(null===(t=null==d?void 0:d.cardData)||void 0===t?void 0:t.titleId,null===(n=null==d?void 0:d.cardData)||void 0===n?void 0:n.appId)}`},null===(o=d.cardData)||void 0===o?void 0:o.cardId),this.onClose({taskModuleClosedReason:"Done",resultType:"text",text:"Something went wrong"})}))}))}handleTaskSubmitResponse(e,t){switch(e.type){case m.t.Result:{const n=e.value;n.composeExtension?this.handleComposeResult(n.composeExtension,t):n.task?this.handleTaskResult(n.task):this.handleResultTypeMessage("");break}case m.t.Error:this.handleResultTypeMessage("Something went wrong");break;default:this.handleResultTypeMessage("")}}handleResultTypeMessage(e){this.onClose({taskModuleClosedReason:"Done",resultType:"text",text:e})}handleComposeResult(e,t){var n,o,r,i,a;switch(e.type){case"message":return this.handleResultTypeMessage(null!==(n=e.text)&&void 0!==n?n:"");case"result":return void this.onClose({taskModuleClosedReason:"Done",resultType:"card",attachmentLayout:e.attachmentLayout,attachments:e.attachments});case"auth":{const{suggestedActions:n}=e;return this.handleAuth({appName:null!==(r=null===(o=null==n?void 0:n.actions)||void 0===o?void 0:o[0].title)&&void 0!==r?r:"",authUrl:null!==(a=null===(i=null==n?void 0:n.actions)||void 0===i?void 0:i[0].value)&&void 0!==a?a:"",originalRequest:t})}default:return this.handleResultTypeMessage("")}}handleTaskResult(e){switch(e.type){case"message":return this.handleResultTypeMessage(e.value);case"continue":{const t=e.value,n=null!=t.card?"card":"url",o=(t.height,t.height),r=(t.width,t.width);return this.onUpdate({type:n,card:"string"==typeof t.card?t.card:JSON.stringify(t.card),url:t.url,completionBotId:t.completionBotId,fallbackUrl:t.fallbackUrl,height:o,width:r})}default:return this.handleResultTypeMessage("")}}}var b=n(21120),E=n(56759),A=n(52404);function S(e){if(!e&&"string"!=typeof e&&"number"!=typeof e)return-1;if("string"==typeof e){const t=e,n=parseInt(t);if(!isNaN(n))return n;switch(t.toLowerCase()){case"large":return-3;case"medium":return-2;default:return-1}}return e}class I{constructor(e,t,n,o,r,i,a,s,l){this.getContainer=e,this.userContext=t,this.hostContext=n,this.appService=o,this.tokenService=r,this.openLaunchPage=i,this.channelService=a,this.telemetryService=s,this.enableAMSProxy=l}launchActionDialog(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const o=((e,t,n)=>(o,r,i)=>{if(!i)throw Error("botService is required to open dialog.");const a=t=>{o.close(),e(t=null!=t?t:{taskModuleClosedReason:"CancelledByUser"})};return{submit:new C(a,o.update,t.commandId,t.telemetryService,t.getAuthAdaptiveCard).getDialogSubmit(i,r,n),close:a,update:o.update}})(t,e,this.handleAuth.bind(this));this.openDialog(e.dialogContent,e.appId,o,e.dialogParameters,[d.r.Submit])}))}))}getImage(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){return(0,b.g)(e,this.userContext,this.hostContext,this.tokenService,this.enableAMSProxy)}))}openUrl(e){return window.open(e.url),Promise.resolve({status:"Success"})}handleAuth(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var o;const r={user:this.userContext,app:this.hostContext,page:{id:(null===(o=e.appDefinition)||void 0===o?void 0:o.id)||"",frameContext:h.E2.authentication}},i=e=>(o,r)=>e?(t({code:o}),Promise.resolve()):(n(o),Promise.resolve()),a=new u.y(i(!0),i(!1),this.tokenService,this.userContext);(function(e,t,n,o,r){return(0,c.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((i,a)=>{var s,l;const c=e.ownerDocument.defaultView;if(!c)return void a("Window object is null");const u=(0,E.z)(Object.assign(Object.assign({},t.appDefinition),{version:null!==(s=t.appDefinition.version)&&void 0!==s?s:"",appId:t.appDefinition.id,manifestVersion:null!==(l=t.appDefinition.manifestVersion)&&void 0!==l?l:""})),d={url:t.signInUrl,width:800,height:600,left:c.screen.availWidth/2-400,top:c.screen.availHeight/2-300};new A.I(c,d,u,n,o,{log:function(e,t,n,o){}},r)?i(void 0):a("Unable to initialize auth extension")}))}))})(this.getContainer(),e,a,r,this.telemetryService).catch((e=>{}))}))}))}handleJITInstall(e){throw new Error("Method not implemented.")}logTelemetry(e){throw new Error("Method not implemented.")}getHostContext(){var e,t;const n={locale:this.hostContext.locale,timeZone:null===(e=this.hostContext.osLocaleInfo)||void 0===e?void 0:e.longDate,timeOffset:null===(t=this.hostContext.osLocaleInfo)||void 0===t?void 0:t.regionalFormat,theme:this.hostContext.theme==h.BD.dark?h.BD.dark:h.BD.default};return Promise.resolve(n)}getDialogFromTaskInfo(e){return e.card?Object.assign({type:g.g.Card},e):e.url?Object.assign({type:g.g.Url},e):void 0}getDialogFromStageInfo(e){var t,n;const o=null!==(t=e.contentUrl)&&void 0!==t?t:e.websiteUrl;if(o)return{type:g.g.Url,width:.9*window.innerWidth,height:.9*window.innerHeight,title:null!==(n=e.name)&&void 0!==n?n:"",url:o}}getAppDefinition(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.appService.getApp({id:e});let n=null==t?void 0:t.appDefinition;return!n&&(null==t?void 0:t.titleInfo)&&(n=(0,p.P)(t.titleInfo)),n}))}sanitizeTaskInfo(e){!function(e){e.card&&void 0===e.width&&(e.width="medium"),e.card&&void 0===e.height&&(e.height="medium"),e.width=S(e.width),e.height=S(e.height),e.card&&"string"!=typeof e.card&&(e.card=JSON.stringify(e.card))}(e)}openTaskModule(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){this.sanitizeTaskInfo(e.taskInfo);const t=this.getDialogFromTaskInfo(e.taskInfo);return t?(yield this.openDialog(t,e.appId,void 0,void 0,void 0,e.conversationId),Promise.resolve({status:"Success"})):Promise.reject()}))}openStageView(e){return(0,c.__awaiter)(this,void 0,void 0,(function*(){const t=this.getDialogFromStageInfo(e.stageInfo);return t?(yield this.openDialog(t,e.appId,void 0,void 0,void 0,e.conversationId),Promise.resolve({status:"Success"})):Promise.reject()}))}}var P=n(11404),T=n(54571);class x extends I{constructor(e,t,n,o,r,i,a,s,l,c){super(e,t,n,o,r,i,a,s),this.displayExternalUrlWarning=l,this.allowListedDomains=c}openUrl(e){var t,n;if(null===(t=e.cardData)||void 0===t?void 0:t.appId){const t=e.cardData.appId;return new Promise(((n,o)=>{this.getAppDefinition(t).then((t=>{var o,r,i;if(t){const n=(0,E.z)(Object.assign(Object.assign({},t),{version:null!==(o=t.version)&&void 0!==o?o:"",appId:t.id,manifestVersion:null!==(r=t.manifestVersion)&&void 0!==r?r:""})),i={log:function(e,t,n,o){}};if((0,T.dE)(e.url,i,n)||this.isAllowListedDomain(e.url))return window.open(e.url),Promise.resolve({status:"Success"})}n(this.openUrlWithWarning(e.url,null===(i=e.cardData)||void 0===i?void 0:i.cardId))})).catch((()=>{var t;n(this.openUrlWithWarning(e.url,null===(t=e.cardData)||void 0===t?void 0:t.cardId))}))}))}return this.openUrlWithWarning(e.url,null===(n=e.cardData)||void 0===n?void 0:n.cardId)}openUrlWithWarning(e,t){var n,o;return null!==(o=null===(n=this.displayExternalUrlWarning)||void 0===n?void 0:n.call(this,t).then((()=>(window.open(e),Promise.resolve({status:"Success"})))).catch((e=>Promise.reject(e))))&&void 0!==o?o:Promise.reject("Unable to display open external url warning")}isAllowListedDomain(e){if(!this.allowListedDomains||!e)return!1;for(const t of this.allowListedDomains){const n=new RegExp(`${t}((/|\\?).*)?$`,"i");if(new URL(e).host.match(n))return!0}return!1}copyCard(e){var t;const n=e.cardDetails;if(n&&n.contentType==P.z.AdaptiveCard){const e=JSON.parse(n.content);if(e){const n=null===(t=e.metadata)||void 0===t?void 0:t.webUrl;n&&(0,l.eM)(n,document)}}}deleteCard(e){throw new Error("Method not implemented.")}embedCard(e){throw new Error("Method not implemented.")}makeCustomAnnouncement(e){throw new Error("Method not implemented.")}}function w(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function D(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t;var n}function F(e,t){return F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},F(e,t)}function L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_(e);if(t){var r=_(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return D(this,n)}}function O(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(i,e);var t,n,o,r=L(i);function i(e,t,n,o,a,s,l,c,u,d){var p;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(p=r.call(this,e,t,n,o,a,s,l,c)).displayExternalUrlWarning=u,p.allowListedDomains=d,p}return t=i,n=[{key:"openDialog",value:function(e,t,n,o,r){var i,s=this;return(i=function(){var i;return O(this,(function(l){switch(l.label){case 0:return[4,s.getAppDefinition(t)];case 1:return(i=l.sent())?(e&&a(e,s.getContainer(),s.channelService,i,s.tokenService,s.userContext,s.hostContext,void 0,void 0,void 0,void 0,s,r,void 0,n,o),[2]):[2,Promise.reject("App definition not found")]}}))},function(){var e=this,t=arguments;return new Promise((function(n,o){var r=i.apply(e,t);function a(e){w(r,n,o,a,s,"next",e)}function s(e){w(r,n,o,a,s,"throw",e)}a(void 0)}))})()}}],n&&k(t.prototype,n),o&&k(t,o),i}(x),M=n(28087);class B extends R{constructor(e,t,n,o,r,i,a,s,l,c,u,d){super(n,o,r,i,a,s,l,u,d),this.taskModuleLauncher=e,this.clientInfo=t,this.taskModuleDialogTitle=c,this.isTaskModuleRequest=e=>void 0!==e.taskInfo,this.isStageViewRequest=e=>void 0!==e.stageInfo}async launchModalDialogContainer(e,t,n){if(!t)return Promise.reject("Dialog content not found");const o=await this.getAppDefinition(e.appId);if(!o)return Promise.reject("App definition not found");let r="";if(this.isTaskModuleRequest(e))r=e.taskInfo.triggeringActionTitle??"";else{if(!this.isStageViewRequest(e))return Promise.resolve({status:"Failure"});r=e.stageInfo.triggeringActionTitle??""}const i={dialogContent:t,appDefinition:o,cardData:JSON.stringify(e.cardData),clientInfo:this.clientInfo,dialogTitle:this.taskModuleDialogTitle,viewMode:n,triggeringActionTitle:r};return this.taskModuleLauncher?(await this.taskModuleLauncher(i),Promise.resolve({status:"Success"})):Promise.resolve({status:"Failure"})}async openTaskModule(e){const t=this.getDialogFromTaskInfo(e.taskInfo);return this.launchModalDialogContainer(e,t,M.S.TaskViewMode)}async openStageView(e){const t=this.getDialogFromStageInfo(e.stageInfo);return this.launchModalDialogContainer(e,t,M.S.StageViewMode)}}},17427:(e,t,n)=>{n.d(t,{R:()=>c});var o=n(51986),r=n(89797),i=n(22098),a=n(39086),s=n(61398),l=n(85032);class c{constructor(e){this.cardProps=e}getDisplayExternalUrlWarning(){return e=>new Promise(((t,n)=>{e?setTimeout((()=>t()),2e3):n("CardId is missing")}))}isValidMessageForMsgExtCard(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((e=>!!e.cardJson))}getCardReferences(e){const t=this.getMsgExtCardService();if(!this.isValidMessageForMsgExtCard(e))return[];const n=new r.a({shouldACUseInlinePopup:!0},null,this.cardProps.clientInfo?.locale,"",this.cardProps.clientInfo?.theme);return e.map(((e,o)=>({index:o+1,card:e.cardJson?JSON.parse(e.cardJson):void 0,context:t,content:e.cardJson,config:n})))}getCardServiceProps(){return this.cardProps}getMsgExtCardService(){const e=this.cardProps.tokenService,t=this.cardProps.appService,n=this.cardProps.channelService,r=this.cardProps.clientInfo;let c=this.cardProps?.telemetryService;const u=this.cardProps.taskModuleLauncher,d=this.cardProps?.taskModuleDialogTitle??"",p={host:{clientType:r.clientType,name:r.hubName,sessionId:r.sessionId,version:a.V0},locale:r.locale,sessionId:r.sessionId,theme:r.theme},h={dataResidency:i.jI.Public,id:r.aadUserId,displayName:r.userName,userPrincipalName:r.userPrincipalName};c||(c=new l.B);const g=document.createElement("div"),f=new s.T(u,r,(()=>g),h,p,t,e,(()=>{throw new Error("Not implemented")}),n,d,void 0,this.getDisplayExternalUrlWarning());return{hostService:f,tokenService:e,appService:t,cardService:new o.o(f,n,t),telemetryService:c,channelService:n}}}},85032:(e,t,n)=>{n.d(t,{B:()=>o});class o{getRecord(e){return{type:e.type.toString(),tag:e.tag?.toString()??"",name:e.name?.toString()??"",source:e.source?.toString()??"",duration:e.duration?.toString()??"",success:e.success?.toString()??"",correlationVector:e.correlationVector?.toString()??""}}constructor(){}LogInfo(e){}LogError(e){}LogException(e){}LogWarning(e){}LogVerbose(e){}LogMetric(e){}}},85558:(e,t,n)=>{n.d(t,{d:()=>Pe,_:()=>be});var o=n(79490),r=n(11120),i=n(30185),a=n(70962),s=n(8520),l=n(72994);const c=["PluginDefinitions","CustomEngineCopilots"],u="en-us";let d,p=0;class h{constructor(e,t,n){this.tokenService=e,this.telemetryService=n,this.locale=null!=t?t:u}getApp(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=yield g(e,this.tokenService,this.locale,this.telemetryService);return null!=t?t:{titleInfo:void 0}}))}}const g=(e,t,n,r)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){return null==d?yield f(t,n,r):Date.now()-p>36e5&&f(t,n,r),yield m(e.id)})),f=(e,t,n)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){const o=yield y(e,t,n);return o&&(d=o,p=Date.now()),o})),m=e=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){if(d){const t=d.find((t=>t.appId===e||t.titleId===e));return Promise.resolve({titleInfo:t})}return Promise.reject(`couldn't find app with id, ${e}`)})),y=(e,t,n)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){var o;const a=new i.k(n,r.yx.GetUserConfig,r.xe.GetUserConfigFrom3S),s={};try{const n=yield e.getToken({resource:"https://substrate.office.com/search"});if(n&&(null==n?void 0:n.authToken)){const e={method:"POST",headers:{Authorization:`Bearer ${n.authToken}`,"Content-Type":"application/json","Accept-Language":null!=t?t:u},body:JSON.stringify({RequestedConfigTypes:c,Scenario:{Name:"sydney"},TextDecorations:"Off",TimeZone:"UTC",Culture:null!=t?t:u})},i=yield fetch("https://substrate.office.com/search/api/v1/userconfig".toString(),e);if(s[r.vP.HttpStatusCode]=null==i?void 0:i.status,i.ok&&200===i.status){const e=yield i.json();a.logMetricEnd({props:s});return(0,l.s)(null===(o=e.PluginDefinitionResponse)||void 0===o?void 0:o.Plugins)}return a.logMetricEndWithError({props:s}),Promise.reject(`Error while fetching userConfig: ${i.status}`)}}catch(e){return a.logMetricEndWithError({props:s,diagnosticsData:`Error: getUserConfig failed, ${null==e?void 0:e.message}`}),Promise.reject(`getUserConfig failed, ${null==e?void 0:e.message}`)}}));function v(e){if(!e)return"";if(/<([A-Za-z][A-Za-z0-9]*)\b[^>]*>(.*?)<\/\1>/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}return e}var C=n(65445),b=n(52517),E=n(85795),A=n(80553),S=n(45726),I=n(65593);function P(e){return"teamshub"==e}var T=n(95628),x=n(35888),w=n(68779),k=n(30112),_=n(89790),D=n(74018),F=n(10145),L=n(21278),O=n(16895),R=n(658),M=n(62653),B=(0,L.Q)("ReferenceItem",(0,R.n)({link:(0,o.__assign)((0,o.__assign)({},O.Pt.textDecoration("none")),{cursor:"pointer",":hover":(0,o.__assign)({},O.Pt.textDecoration("none")),":active":(0,o.__assign)({},O.Pt.textDecoration("none"))}),flexHorizontal:{display:"flex",flexDirection:"row",alignItems:"center",boxSizing:"border-box",justifyContent:"flex-start"},content:(0,o.__assign)((0,o.__assign)((0,o.__assign)({backgroundColor:M.L.colorNeutralBackground3,maxWidth:"204px",width:"fit-content"},O.Pt.padding("2px","8px","2px","0px")),O.Pt.overflow("hidden")),O.Pt.borderRadius("4px")),leftContainer:(0,o.__assign)({width:"20px",justifyContent:"center"},O.Pt.overflow("hidden")),dividerStyle:{height:"100%",flexGrow:0},rightContainer:{paddingLeft:"6px"},citationIndexText:{color:M.L.colorNeutralForeground2},text:(0,o.__assign)({color:M.L.colorNeutralForeground2,fontSize:M.L.fontSizeBase200,maxWidth:"149px",marginLeft:"4px"},O.Pt.overflow("hidden")),referenceIconContainer:{height:"16px"}})),N=n(37435),V=n(64589),H=function(e){var t,n=e.name,r=e.url,i=e.referenceIndex,a=e.onLinkClick,l=e.slots,c=e.ariaLabel,u=e.ariaDescription,d=e.onRender,p=e.ariaRole,h=void 0===p?"link":p,g=B(),f=(t=l,{components:{referenceIcon:"div"},referenceIcon:N.lq(null==t?void 0:t.referenceIcon,{elementType:"div",renderByDefault:!0,defaultProps:{children:s.createElement(V.EEN,{fontSize:16})}})});(0,T.C)(f);var m=(0,x.S)(f),y=m.slots,v=m.slotProps;return s.useEffect((function(){null==d||d()}),[]),s.createElement(w.m,{content:n||r||"",relationship:"label",positioning:"above"},s.createElement("a",{"aria-label":c,"aria-describedby":u,className:(0,k.z)(g.link,g.flexHorizontal,g.content),href:r,onClick:a,onKeyDown:function(e){return function(e,t){("Enter"===e.key||" "===e.key)&&(null==t||t(e))}(e,a)},target:"_blank","data-testid":"reference-item-url",rel:"noreferrer",role:h},s.createElement("div",{className:(0,k.z)(g.flexHorizontal,g.leftContainer)},s.createElement(_.g,{wrap:!1,truncate:!0,className:g.citationIndexText},i)),s.createElement(D.c,{vertical:!0,className:g.dividerStyle}),s.createElement("div",{className:(0,k.z)(g.flexHorizontal,g.rightContainer)},s.createElement("div",{className:g.referenceIconContainer},s.createElement(y.referenceIcon,(0,o.__assign)({},v.referenceIcon))),s.createElement(F.E,{wrap:!1,truncate:!0,className:g.text},n||r))))},U=n(47875),j=n(69926),z=(0,n(18850).qP)("copilot-ext-msgext-card-reference-control.appIconText"),G=n(88655);var W=(0,L.Q)("MsgExtCardReference",(0,R.n)({root:{marginBottom:"5px",marginTop:"5px"},rootV2:{marginTop:"0px",marginBottom:"0px"},rootV2NoLink:{"> a":{cursor:"default"}},appIcon:(0,o.__assign)({width:"20px",height:"20px"},O.Pt.borderRadius(M.L.borderRadiusMedium)),appIconV2:{verticalAlign:"text-top"},title:{fontWeight:600,fontSize:"14px"},metaData:{fontSize:"12px",color:M.L.colorNeutralForeground1,colorbackground:M.L.colorNeutralBackground1,fontWeight:400},citationLink:{textDecorationLine:"none"},cursorPointer:{cursor:"pointer"},cursorDefault:{cursor:"default"},previewContent:{width:"100%",maxWidth:"fit-content"},previewSurface:(0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)({},O.Pt.overflow("hidden","hidden")),O.Pt.padding("0px")),O.Pt.borderRadius("12px")),O.Pt.borderStyle("none")),O.Pt.borderWidth("0px")),{"& > div":(0,o.__assign)((0,o.__assign)({},O.Pt.padding("0px")),O.Pt.borderRadius("12px")),"&::-webkit-scrollbar-thumb":(0,o.__assign)((0,o.__assign)({backgroundColor:M.L.colorNeutralForeground4},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium)),"&::-webkit-scrollbar":(0,o.__assign)((0,o.__assign)({width:M.L.spacingHorizontalS,height:M.L.spacingHorizontalS},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium)),"&::-webkit-scrollbar-track":(0,o.__assign)((0,o.__assign)({backgroundColor:"transparent"},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium)),"&::-webkit-scrollbar-corner":(0,o.__assign)((0,o.__assign)({backGroundColor:M.L.colorNeutralBackground5},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium))}),text:{color:M.L.colorNeutralForeground2,fontSize:M.L.fontSizeBase200,maxWidth:"149px"}})),q=function(e,t){if(e&&t){var n=t.filter((function(e){return function(e){if(!e)return!1;var t=e.split("/")[0].split(".");if(t.length<=1)return!1;var n=t[t.length-1],o=t[t.length-2];return!n.includes("*")&&!o.includes("*")}(e)})),r=(0,o.__read)((0,j.A)(n,(function(e){return e.includes("/")})),2),i=r[0];if(function(e,t){var n,r;try{for(var i=(0,o.__values)((0,G.A)(t,(function(e){return e.toLowerCase()}))),a=i.next();!a.done;a=i.next()){for(var s=a.value,l="",c=s.split("."),u=0;u<c.length;u++)l+=(u>0?"[.]":"")+c[u].replace("*","[^/^.]+");var d=new RegExp("^".concat(l,"((/|\\?).*)?$"),"i"),p=new RegExp("^https://".concat(l,"((/|\\?).*)?$"),"i");if(e.match(d)||e.match(p))return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}(e,r[1])||function(e,t){return!!t.some((function(t){var n=t.replace(new RegExp("[*]","g"),"(.*)"),o=new RegExp(n);return e.match(o)}))}(e,i))return!0}return!1},Q=function(e){var t=e.cardUrl,n=e.cardTitle,r=e.appName,i=e.appIcon,a=e.validDomains,l=e.sourceName,c=e.isReferencesV3,u=e.msgExtCardPreview,d=(0,I.mY)({appIconText:z}),p=W(),h=(0,o.__read)(s.useState(!1),2),g=h[0],f=h[1],m=function(n){t&&g&&(e.onLinkClickHandler?e.onLinkClickHandler(t):window.open(t)),null==n||n.preventDefault()};s.useEffect((function(){(P(l)||function(e){var t=new RegExp("https://nam.+.safelinks.protection.+/?url=.+");return!(!e||!e.match(t))}(t)||q(t,a))&&f(!0)}),[t,l,a]);var y=s.createElement(U.e,{name:d.appIconText({appName:r}),size:16,className:p.appIconV2,image:{src:i}}),v=s.createElement(C.l,(0,o.__assign)({},{closeOnScroll:!0,size:"small",withArrow:!0,trapFocus:!0,positioning:{align:"center",autoSize:!0},showDelay:500,hideDelay:500}),s.createElement(b.b,null,s.createElement(E.O,{onClick:t?m:void 0,className:t?p.cursorPointer:p.cursorDefault,key:"Reference-".concat(e.citationIndex),citation:e.citationIndex,role:"button",graphic:y},s.createElement(F.E,{wrap:!1,truncate:!0,className:p.text},n||(g&&t?t:"")||r))),s.createElement(A.e,{className:p.previewSurface,tabIndex:0,"data-tid":"popver-adaptive"},s.createElement(S.y,{className:p.previewContent},u)));return c?v:s.createElement("div",{className:(0,k.z)(p.rootV2,!t&&p.rootV2NoLink),"data-testid":"msgext-reference-container"},s.createElement(H,{name:n,url:g?t:void 0,referenceIndex:e.citationIndex,onLinkClick:t?m:void 0,slots:{referenceIcon:y}}))},K=function(e){var t,n={},l=e.cardDetails,c=e.citationIndex,u=e.tokenService,d=e.telemetryService,p=e.onLinkClickHandler,g=e.sourceName,f=e.appService,m=e.config,y=e.serviceProvider,C=e.postActionExecute,b=e.isReferencesV3,E=(0,o.__read)(s.useState(l.appName),2),A=E[0],S=E[1],I=(0,o.__read)(s.useState(l.appIcon),2),P=I[0],T=I[1],x=(0,o.__read)(s.useState(void 0),2),w=x[0],k=x[1],_=l.appId;s.useEffect((function(){!u||null!=A&&null!=P&&null!=w||function(e,t,n){return(0,o.__awaiter)(this,void 0,void 0,(function(){var r,i,a,s,l,c,u,d,p,g;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r=null!=n?n:new h(t),i={id:e},[4,r.getApp(i)];case 1:return a=o.sent(),[2,{appName:null===(l=null===(s=a.titleInfo)||void 0===s?void 0:s.titleDefinition)||void 0===l?void 0:l.name,appIcon:null===(d=null===(u=null===(c=a.titleInfo)||void 0===c?void 0:c.titleDefinition)||void 0===u?void 0:u.iconLarge)||void 0===d?void 0:d.uri,validDomains:null===(g=null===(p=a.titleInfo)||void 0===p?void 0:p.titleDefinition)||void 0===g?void 0:g.validDomains}];case 2:return o.sent(),[2,{appName:void 0,appIcon:void 0,validDomains:void 0}];case 3:return[2]}}))}))}(_,u,f).then((function(e){(null==e?void 0:e.appName)!==A&&S(null==e?void 0:e.appName),(null==e?void 0:e.appIcon)!==P&&T(null==e?void 0:e.appIcon),(null==e?void 0:e.validDomains)!==w&&k(null==e?void 0:e.validDomains)})).catch((function(e){null==d||d.LogException({type:r.FY.LogException,name:r.ru.MsgExtCardReference,tag:r.m2.getAppDataException,success:r.YE.Failure,props:n,diagnosticsData:"Error while getting the app data ".concat(e)})}))}),[_]);var D=s.useMemo((function(){return new i.k(d,r.yx.ReferenceContainer,r.xe.MsgExtCardReferenceContainer)}),[]),F=s.useMemo((function(){return JSON.parse(l.content)}),[l.content]),L=s.useMemo((function(){return s.createElement(a.h,{cardDetails:(0,o.__assign)((0,o.__assign)({},l),{content:JSON.stringify(F.content)}),serviceProvider:y,config:m,postActionExecute:C})}),[l,y,m,C]),O=s.useMemo((function(){return function(e){var t,n,o;return e?v(null!==(o=null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.title)&&void 0!==o?o:""):""}(F)}),[F]),R=s.useMemo((function(){return function(e){var t,n,o,r,i,a,s,l,c,u;return e?(null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.subtitle)?v(null!==(i=null===(r=null===(o=e.preview)||void 0===o?void 0:o.content)||void 0===r?void 0:r.subtitle)&&void 0!==i?i:""):(null===(s=null===(a=e.preview)||void 0===a?void 0:a.content)||void 0===s?void 0:s.text)?v(null!==(u=null===(c=null===(l=e.preview)||void 0===l?void 0:l.content)||void 0===c?void 0:c.text)&&void 0!==u?u:""):void 0:""}(F)}),[F]),M=s.useMemo((function(){return function(e){var t,n;return e?null===(n=null===(t=e.content)||void 0===t?void 0:t.metadata)||void 0===n?void 0:n.webUrl:""}(F)}),[F]);return s.useEffect((function(){var e={};e[r.vP.citationIndex]=c,e[r.vP.HasURL]=1,null!=M&&null!=M||(e[r.vP.HasURL]=0),D.logMetricEnd({props:e,diagnosticsData:"TypeOfCard: ".concat(l.contentType,",  cardId : ").concat(l.cardId," }")})}),[]),s.createElement(Q,{citationIndex:c,cardTitle:null!=O?O:"",appIcon:null!=P?P:"",appName:null!=A?A:"",cardSubText:R,cardUrl:M,onLinkClickHandler:p,idxRenderOnBcb:null!==(t=e.idxRenderOnBcb)&&void 0!==t&&t,validDomains:w,sourceName:g,msgExtCardPreview:L,isReferencesV3:b})},Y=n(48620),$=n(869),J=n(62866),X=n(10966),Z=n(11404),ee=n(92619),te=n(84649);function ne(e){if(e){if(e.startsWith("P_"))return e;if(e.startsWith("T_"))return"T_";if(e.startsWith("U_"))return"U_"}return""}function oe(e){if(!e)return"";if(/<([A-Za-z][A-Za-z0-9]*)\b[^>]*>(.*?)<\/\1>/.test(e)){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}return e}var re=(0,L.Q)("APIPluginCardReference",(0,R.n)({root:{marginBottom:"5px",marginTop:"5px"},rootV2:{marginTop:"0px",marginBottom:"0px"},appIcon:(0,o.__assign)({width:"20px",height:"20px"},O.Pt.borderRadius(M.L.borderRadiusMedium)),appIconV2:{verticalAlign:"text-top"},title:{fontWeight:600,fontSize:"14px"},metaData:{fontSize:"12px",color:M.L.colorNeutralForeground1,colorbackground:M.L.colorNeutralBackground1,fontWeight:400},citationLink:{textDecorationLine:"none"},cursorPointer:{cursor:"pointer"},cursorDefault:{cursor:"default"},previewContent:{width:"100%",maxWidth:"fit-content"},previewSurface:(0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)((0,o.__assign)({},O.Pt.overflow("hidden","hidden")),O.Pt.padding("0px")),O.Pt.borderRadius("12px")),O.Pt.borderStyle("none")),O.Pt.borderWidth("0px")),{"& > div":(0,o.__assign)((0,o.__assign)({},O.Pt.padding("0px")),O.Pt.borderRadius("12px")),"&::-webkit-scrollbar-thumb":(0,o.__assign)((0,o.__assign)({backgroundColor:M.L.colorNeutralForeground4},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium)),"&::-webkit-scrollbar":(0,o.__assign)((0,o.__assign)({width:M.L.spacingHorizontalS,height:M.L.spacingHorizontalS},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium)),"&::-webkit-scrollbar-track":(0,o.__assign)((0,o.__assign)({backgroundColor:"transparent"},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium)),"&::-webkit-scrollbar-corner":(0,o.__assign)((0,o.__assign)({backGroundColor:M.L.colorNeutralBackground5},O.Pt.border("0px")),O.Pt.borderRadius(M.L.borderRadiusMedium))}),text:{color:M.L.colorNeutralForeground2,fontSize:M.L.fontSizeBase200,maxWidth:"149px"}})),ie=function(e,t){if(e&&t){var n=t.filter((function(e){return function(e){if(!e)return!1;var t=e.split("/")[0].split(".");if(t.length<=1)return!1;var n=t[t.length-1],o=t[t.length-2];return!n.includes("*")&&!o.includes("*")}(e)})),r=(0,o.__read)((0,j.A)(n,(function(e){return e.includes("/")})),2),i=r[0];if(function(e,t){var n,r;try{for(var i=(0,o.__values)((0,G.A)(t,(function(e){return e.toLowerCase()}))),a=i.next();!a.done;a=i.next()){for(var s=a.value,l="",c=s.split("."),u=0;u<c.length;u++)l+=(u>0?"[.]":"")+c[u].replace("*","[^/^.]+");var d=new RegExp("^".concat(l,"((/|\\?).*)?$"),"i"),p=new RegExp("^https://".concat(l,"((/|\\?).*)?$"),"i");if(e.match(d)||e.match(p))return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return!1}(e,r[1])||function(e,t){return!!t.some((function(t){var n=t.replace(new RegExp("[*]","g"),"(.*)"),o=new RegExp(n);return e.match(o)}))}(e,i))return!0}return!1},ae=function(e){var t=e.cardUrl,n=e.cardTitle,r=e.appIcon,i=e.appName,a=e.validDomains,l=e.sourceName,c=e.isReferencesV3,u=e.popover,d=re(),p=(0,o.__read)(s.useState(!1),2),h=p[0],g=p[1],f=function(n){t&&(e.onLinkClickHandler?e.onLinkClickHandler(t):window.open(t)),null==n||n.preventDefault()};s.useEffect((function(){(P(l)||function(e){var t=new RegExp("https://nam.+.safelinks.protection.+/?url=.+");return!(!e||!e.match(t))}(t)||ie(t,a))&&g(!0)}),[t,l,a]);var m=s.createElement(U.e,{size:16,className:d.appIconV2,image:{src:r}}),y=s.createElement(C.l,(0,o.__assign)({},{closeOnScroll:!0,size:"small",withArrow:!0,trapFocus:!0,positioning:{align:"center",autoSize:!0},showDelay:500,hideDelay:500}),s.createElement(b.b,null,s.createElement(E.O,{onClick:t?f:void 0,className:t?d.cursorPointer:d.cursorDefault,key:"Reference-".concat(e.citationIndex),citation:e.citationIndex,role:"button",graphic:m},s.createElement(F.E,{wrap:!1,truncate:!0,className:d.text},n||(h&&t?t:"")||i))),s.createElement(A.e,{className:d.previewSurface,tabIndex:0,"data-tid":"popver-adaptive"},s.createElement(S.y,{className:d.previewContent},u)));return c?y:s.createElement("div",{className:d.rootV2,"data-testid":"api-plugin-reference-container"},s.createElement(H,{name:n,url:h?t:void 0,referenceIndex:e.citationIndex,onLinkClick:t?f:void 0,slots:{referenceIcon:m}}))},se=function(e){var t,n,a,l=e.cardDetails,c=e.citationIndex,u=e.appService,d=e.telemetryService,p=e.onLinkClickHandler,h=e.sourceName,g=e.serviceProvider,f=e.config,m=e.postActionExecute,y=e.isReferencesV3,v=(0,o.__read)(s.useState({appName:l.appName,appIcon:l.appIcon,validDomains:void 0}),2),C=v[0],b=v[1];s.useEffect((function(){!u||null!=C.appName&&null!=C.appIcon&&null!=C.validDomains||function(e,t,n,i,a,s){return(0,o.__awaiter)(this,void 0,void 0,(function*(){var o,l,c,u,d,p,h,g,f,m,y,v,C,b,E,A,S,I,P,T,x,w,k,_,D;try{const r={id:e},i=yield t.getApp(r),F=null===(l=null===(o=i.titleInfo)||void 0===o?void 0:o.titleDefinition)||void 0===l?void 0:l.elementDefinitions;if(!F)return{referenceId:void 0,appName:void 0,appIcon:void 0};const L=null===(c=F.gpts)||void 0===c?void 0:c.find((e=>e.id===a)),O=null===(u=null==L?void 0:L.actions)||void 0===u?void 0:u.find((e=>e.id===s)),R=null===(d=F.declarativeCopilots)||void 0===d?void 0:d.find((e=>e.id===a)),M=null===(p=null==R?void 0:R.actions)||void 0===p?void 0:p.find((e=>e.id===s)),B=null!==(h=null!=M?M:O)&&void 0!==h?h:null===(g=F.plugins)||void 0===g?void 0:g[0],N=null!==(v=null===(y=null===(m=null===(f=i.titleInfo)||void 0===f?void 0:f.titleDefinition)||void 0===m?void 0:m.iconLarge)||void 0===y?void 0:y.uri)&&void 0!==v?v:null===(E=null===(b=null===(C=i.titleInfo)||void 0===C?void 0:C.titleDefinition)||void 0===b?void 0:b.iconSmall)||void 0===E?void 0:E.uri,V=null===(S=null===(A=i.titleInfo)||void 0===A?void 0:A.titleDefinition)||void 0===S?void 0:S.validDomains;return{referenceId:null===(T=null===(P=null===(I=null==B?void 0:B.runtimes)||void 0===I?void 0:I[n])||void 0===P?void 0:P.auth)||void 0===T?void 0:T.referenceId,appName:null!==(k=null!==(w=null!==(x=null==B?void 0:B.nameForHuman)&&void 0!==x?x:null==R?void 0:R.name)&&void 0!==w?w:null==L?void 0:L.name)&&void 0!==k?k:null===(D=null===(_=i.titleInfo)||void 0===_?void 0:_.titleDefinition)||void 0===D?void 0:D.name,appIcon:N,validDomains:V}}catch(t){return null==i||i.LogError({type:r.FY.LogError,name:r.ru.getAppDataForAPIPlugins,tag:r.m2.getAppDataForAPIPlugins,success:r.YE.Failure,diagnosticsData:`Error while getting app data ${(null==t?void 0:t.message)||t} where titleId is ${ne(e)}`}),{referenceId:void 0,appName:void 0,appIcon:void 0,validDomains:void 0}}}))}(l.appId,u,0,void 0,l.gptId,l.gptActionId).then((function(e){b(e)})).catch((function(e){null==d||d.LogException({type:r.FY.LogException,name:r.ru.APIPluginCardReference,tag:r.m2.getAppDataException,success:r.YE.Failure,diagnosticsData:"Error while getting the app data ".concat(e)})}))}),[l.appId,u]);var E=s.useMemo((function(){return new i.k(d,r.yx.ReferenceContainer,r.xe.APIPluginCardReferenceContainer)}),[]),A=s.useMemo((function(){return JSON.parse(l.content)}),[l.content]),S=s.useMemo((function(){return s.createElement(te.Y,{cardDetails:(0,o.__assign)((0,o.__assign)({},l),{content:JSON.stringify(A.content)}),serviceProvider:g,config:f,postActionExecute:m,isPopover:!0})}),[g,l]),I=s.useMemo((function(){return function(e){var t,n,o;return e?oe(null!==(o=null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.title)&&void 0!==o?o:""):""}(A)}),[A]),P=s.useMemo((function(){return function(e){var t,n,o,r,i,a,s,l,c,u;return e?(null===(n=null===(t=e.preview)||void 0===t?void 0:t.content)||void 0===n?void 0:n.subtitle)?oe(null!==(i=null===(r=null===(o=e.preview)||void 0===o?void 0:o.content)||void 0===r?void 0:r.subtitle)&&void 0!==i?i:""):(null===(s=null===(a=e.preview)||void 0===a?void 0:a.content)||void 0===s?void 0:s.text)?oe(null!==(u=null===(c=null===(l=e.preview)||void 0===l?void 0:l.content)||void 0===c?void 0:c.text)&&void 0!==u?u:""):void 0:""}(A)}),[A]),T=s.useMemo((function(){return function(e){var t,n;return e?null===(n=null===(t=e.content)||void 0===t?void 0:t.metadata)||void 0===n?void 0:n.webUrl:""}(A)}),[A]);return s.useEffect((function(){var e={};e[r.vP.citationIndex]=c,e[r.vP.HasURL]=1,null!=T&&null!=T||(e[r.vP.HasURL]=0),E.logMetricEnd({props:e,diagnosticsData:"TypeOfCard: ".concat(l.contentType,",  cardId : ").concat(l.cardId," }")})}),[]),s.createElement(ae,{citationIndex:c,cardTitle:null!=I?I:"",appIcon:null!==(t=C.appIcon)&&void 0!==t?t:"",appName:null!==(n=C.appName)&&void 0!==n?n:"",cardSubText:P,cardUrl:T,onLinkClickHandler:p,idxRenderOnBcb:null!==(a=e.idxRenderOnBcb)&&void 0!==a&&a,validDomains:C.validDomains,sourceName:h,popover:S,isReferencesV3:y})},le=n(21017),ce=n(86688),ue=n(49118),de=n(83242),pe=n(72277),he=n(92153),ge=n(86691),fe=n(78226),me=n(9178),ye=n(85023),ve=n(24355);const Ce=({referenceType:e,iconAppName:t,iconUrl:n,authorEmail:o,authorName:r,iconSize:i=20})=>{if(e===pe._2.Internal){if(t===pe._R.Word||t===pe._R.OneNote)return s.createElement(ge.E8s,null);if(t===pe._R.PowerPoint)return s.createElement(fe.GGW,null)}else if(e===pe._2.CrossApp){if(n)return s.createElement(he._,{src:n,alt:t??"",height:i,width:i});if(t)switch(t){case pe._R.Word:return s.createElement(he._,{src:(0,ve.M)(ve.q.Word),alt:t,height:i,width:i});case pe._R.PowerPoint:return s.createElement(he._,{src:(0,ve.M)(ve.q.PPT),alt:t,height:i,width:i});case pe._R.Excel:return s.createElement(he._,{src:(0,ve.M)(ve.q.Excel),alt:t,height:i,width:i});case pe._R.OneNote:return s.createElement(he._,{src:(0,ve.M)(ve.q.OneNote),alt:t,height:i,width:i});case pe._R.Visio:return s.createElement(he._,{src:(0,ve.M)(ve.q.Visio),alt:t,height:i,width:i});case pe._R.Loop:return s.createElement(he._,{src:(0,ve.M)(ve.q.Loop),alt:t,height:i,width:i});case pe._R.Txt:return s.createElement(he._,{src:(0,ve.M)(ve.q.Txt),alt:t,height:i,width:i});case pe._R.SharePoint:return s.createElement(he._,{src:(0,ve.M)(ve.q.SharePoint),alt:t,height:i,width:i});case pe._R.Event:case pe._R.Meeting:return s.createElement(me.lVp,null);case pe._R.Pdf:return s.createElement(ge.I3i,null);case pe._R.Teams:case pe._R.Outlook:return r||o?s.createElement(U.e,{size:i,name:r||o}):s.createElement(ye.rfQ,null);case pe._R.Topic:return s.createElement(he._,{src:"../assets/topic-icon.svg",alt:t,height:i,width:i})}}else if(n)return s.createElement(he._,{src:n,alt:t??"",height:i,width:i});return s.createElement(ye.rfQ,null)},be=(e,t)=>({index:e.referenceIndex,label:s.createElement(le.N,{appearance:"subtle",href:Ae(e,t),as:Ee(e),target:"_blank",onClick:()=>Se(e,t)},e.referenceProps.title),primaryText:e.referenceProps.primarySubtitle,secondaryText:e.referenceProps.secondarySubtitle,excerpt:e.referenceProps.snippet,media:s.createElement(Ce,{referenceType:e.referenceProps.referenceType,iconAppName:e.referenceProps.iconAppName,iconUrl:e.referenceProps.iconUrl,authorEmail:e.referenceProps.authorEmail,authorName:e.referenceProps.authorName,iconSize:e.referenceIconSize}),sensitivity:void 0!==e.referenceProps.sensitivityLabel?s.createElement("span",null,e.referenceProps.sensitivityLabel):void 0}),Ee=e=>e.referenceProps?.path?.[0]?"button":"a",Ae=(e,t)=>t&&e.referenceProps?.path?.[0]?de.u:e.referenceProps.url,Se=(e,t,n)=>{e.referenceProps.onClickCitationLink&&e.referenceProps.onClickCitationLink(e.referenceIndex,e.referenceProps?.path,n)},Ie={referenceText:ce.AF,referencesText:ce.Tp},Pe=({references:e,msgExtCardReferences:t=[],apiPluginCardReferences:n=[],pluginServiceProvider:o,telemetryData:r="",shouldSupportCitationsInAvalon:i,styles:a})=>{const l=(0,I.kQ)(Ie),c=(e=Te(e)).length>1?l.referencesText():l.referenceText(),u=(0,ee.Y$)(),{referenceGroupToggleProps:d,referenceListProps:p}=(0,Y.a)({});return s.createElement(ue.W,null,s.createElement($.z,{...d},`${e.length} ${c}`),s.createElement(J.a,{...p},e.map(((e,r)=>(e=>void 0!==t.find((t=>t.index===e&&t.card)))(r+1)?((e,t,n)=>{const o=n.find((t=>t.index===e&&t.card));if(o){const n={cardId:o.card.cardId,content:o.content,contentType:Z.z.AdaptiveCard,appId:o.card.appId,botId:o.card.botId};return s.createElement(K,{key:e,citationIndex:e,cardDetails:n,tokenService:t?.cardServices?.tokenService,theme:o.config.themeMode,appService:t?.cardServices?.appService,...o,serviceProvider:o.context,isReferencesV3:u.showPluginReferencesV3})}return null})(e.referenceIndex,o,t):(e=>void 0!==n.find((t=>t.index===e&&t.card)))(r+1)?((e,t,n)=>{const o=n.find((t=>t.index===e&&t.card));if(o){const n={cardId:o.card.cardId,content:JSON.stringify({...o.card}),contentType:Z.z.AdaptiveCard,appId:o.card.appId};return s.createElement(se,{key:e,citationIndex:e,cardDetails:n,appService:t?.cardServices?.appService,theme:o.config.themeMode,...o,serviceProvider:o.serviceProvider,isReferencesV3:u.showPluginReferencesV3})}return null})(e.referenceIndex,o,n):s.createElement(X.O,{key:r,...be(e,i)})))))};let Te=e=>{let t=[];for(let n of e){t.some((e=>e.referenceIndex===n.referenceIndex))||t.push(n)}return t}},98786:(e,t,n)=>{n.d(t,{Y:()=>r});var o=n(48298);class r extends o.Action{static isTelemetryEnabled(e){return e instanceof r||void 0!==e.executeWithTelemetry}}},39086:(e,t,n)=>{n.d(t,{$4:()=>T,E:()=>m,FG:()=>f,HA:()=>l,Ht:()=>i,J9:()=>r,Kp:()=>p,Ks:()=>C,LW:()=>y,Lo:()=>b,Tg:()=>S,V0:()=>o,WV:()=>c,XU:()=>d,YG:()=>E,aY:()=>A,dK:()=>a,g1:()=>v,hl:()=>x,jS:()=>P,ls:()=>s,mQ:()=>g,n_:()=>u,ub:()=>I,wP:()=>h});const o="1.0",r=/<a\s+class="(?:fai-Citation|(?:(?!fai-Citation)\w)+\s+fai-citation)(?:\s+(?:(?!fai-citation)\w)+)*"[^>]*>.*?<\/a>/gm,i="main-info-start",a="chat-container",s=()=>"Applying updates to following matches",l=()=>"Remove",c=()=>"Waiting to apply updates",u=()=>"Apply Updates",d=()=>"Apply",p=()=>"Apply All",h=()=>"Previous",g=()=>"Next",f=()=>"No results found for the search",m=()=>"Locate",y=()=>"Help",v=()=>"Comments Summary",C=()=>"Suggestion",b=()=>"Sure thing. I've found an agent that can help you with this task:",E=()=>"Add details",A=()=>"Start review",S=()=>"Reviewer",I=()=>"I'm the ultimate agent for document reviews, and can help you launch, track progress and resolve review comments.",P=()=>"Confirm Invitation",T=()=>"Invitation Sent",x=()=>"Review Details"},77942:(e,t,n)=>{n.d(t,{X7:()=>r,gW:()=>i,lU:()=>a,lc:()=>s});var o=n(8520);const r=(0,o.createContext)({}),i=()=>(0,o.useContext)(r),a=(0,o.createContext)({}),s=()=>(0,o.useContext)(a).skillExecutor},6049:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(8520),r=n(49118),i=n(56390);const a=({componentToRender:e})=>{const t=(0,i.a)();return o.createElement(r.W,{style:t.componentWrapper},e)}},24762:(e,t,n)=>{n.d(t,{V:()=>E});var o=n(65593),r=n(96895),i=n(68779),a=n(19399),s=n(21137),l=n(56934),c=n(19385),u=n(94794),d=n(89270),p=n(18959),h=n(82532),g=n(8520),f=n(86688),m=n(44624),y=n(49118),v=n(86315),C=n(56390),b=n(28029);const E=({isMenuOpen:e,onMenuStateChange:t,handleCopilotChatChange:n,copilotList:E,showLoadingShimmer:A})=>{const S=(0,C.a)(),I=E.find((e=>e.isSelected)),P=E.find((e=>e.isDefaultCopilot)),T=I?.id,x=P?.id,w=I?.name,k=I?.menuIcon,_=I?.menuIconUrl,D=I?.iconAltText,F=(0,o.Lh)(f.cn);return g.createElement(y.W,{horizontal:!0,style:S.root},g.createElement(r.W,{open:e,onOpenChange:t},g.createElement(y.W,{horizontal:!0,style:S.menuWrapper},g.createElement(i.m,{withArrow:!0,positioning:"below",content:F,relationship:"label"},g.createElement(a.c,{disableButtonEnhancement:!0},g.createElement(s.$,{className:S.iconButton,icon:g.createElement(p.hO5,null)}))),T!==x&&g.createElement(y.W,{horizontal:!0},g.createElement(m.l,{style:S.labelIcon},_?g.createElement(v.Z,{iconUrl:_,iconAltText:D}):k),g.createElement(l.J,{weight:"semibold",className:S.label},w))),g.createElement(c.b,{className:S.menu},A?g.createElement(b.Y,null):g.createElement(u.c,null,E.map((e=>g.createElement(d.D,{key:e.id,icon:e.menuIconUrl?g.createElement(v.Z,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon,onClick:()=>{n(e.id)},"aria-label":e.name,role:"tab","aria-selected":e.isSelected?"true":"false"},g.createElement(y.W,{horizontal:!0,style:S.menuItem},g.createElement(m.l,null,e.name),g.createElement(m.l,null,e.isSelected&&g.createElement(h.iNx,null))))))))))}},86315:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(92153),r=n(8520);const i=({iconUrl:e,iconAltText:t})=>{const n=t||"MenuItemIcon";return r.createElement(o._,{tabIndex:-1,"aria-hidden":!0,src:e,alt:n,fit:"contain"})}},56390:(e,t,n)=>{n.d(t,{a:()=>g});var o=n(92782),r=n(16895),i=n(658),a=n(64277),s=n(88027),l=n(62653);const c={root:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",...r.Pt.margin("0px","16px","0px","16px")},menuWrapper:{...r.Pt.margin("0px","16px","0px","0px")},menuAdjacentActionButtons:{color:l.L.colorNeutralForeground1,"&:hover":{color:l.L.colorBrandBackground2Hover},"&:hover :active":{color:l.L.colorBrandStroke2Hover}},iconButton:{...r.Pt.border("none"),color:l.L.colorNeutralForeground1,backgroundColor:"transparent"},label:{...r.Pt.padding("4px","5px","4px","5px")},labelIcon:{...r.Pt.padding("4px","1px","4px","5px"),maxWidth:"20px",maxHeight:"20px"},menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:{...r.Pt.margin("5px","0px","5px","0px"),height:"100%"},shimmerWrapperStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:l.L.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:l.L.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",l.L.colorNeutralBackground2Hover),":hover":{backgroundColor:l.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:l.L.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},shimmerCard:{...r.Pt.padding("0px","10px","0px","10px"),position:"relative",...r.Pt.gap("15px"),display:"flex",flexDirection:"column"},shimmerCardWrapper:{...r.Pt.borderRadius("8px"),opacity:"0.6",backgroundColor:l.L.colorNeutralBackground1},shimmerRow:{alignItems:"center",justifyContent:"flex-end",display:"flex",position:"relative",...r.Pt.gap("10px"),flexDirection:"row"}},u=(0,i.n)(c),d=(0,o.Q)(a.tR),p={root:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",zIndex:9999,...r.Pt.margin("0px","16px","0px","16px")},menuWrapper:{...r.Pt.margin("0px","16px","0px","0px")},menuAdjacentActionButtons:{color:d.neutralPrimary,"&:hover":{color:d.themeMedium},"&:hover :active":{color:d.themeDark}},iconButton:{...r.Pt.border("none"),color:d.neutralPrimary,backgroundColor:"transparent"},label:{...r.Pt.padding("4px","5px","4px","5px")},labelIcon:{...r.Pt.padding("4px","1px","4px","5px"),maxWidth:"20px",maxHeight:"20px"},menu:{width:"90%"},menuItem:{justifyContent:"space-between"},componentWrapper:{...r.Pt.margin("5px","0px","5px","0px"),height:"100%"},shimmerWrapperStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:d.colorNeutralStroke1Selected,...r.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:d.colorNeutralForeground3,...r.Pt.borderRadius("20px"),...r.Pt.border("2px","solid",d.colorNeutralBackground2Hover),":hover":{backgroundColor:d.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:d.colorNeutralBackground2Hover,...r.Pt.borderRadius("20px")}},shimmerCard:{...r.Pt.padding("0px","10px","0px","10px"),position:"relative",...r.Pt.gap("15px"),display:"flex",flexDirection:"column"},shimmerCardWrapper:{...r.Pt.borderRadius("8px"),backgroundColor:d.colorNeutralBackground1,opacity:"0.6"},shimmerRow:{alignItems:"center",justifyContent:"flex-end",display:"flex",position:"relative",...r.Pt.gap("10px"),flexDirection:"row"}},h=(0,i.n)(p),g=()=>{const e=h(),t=u();return(0,s.kF)()?t:e}},28029:(e,t,n)=>{n.d(t,{Y:()=>l});var o=n(87354),r=n(71961),i=n(8520),a=n(49118),s=n(56390);const l=()=>{const e=(0,s.a)();return i.createElement(a.W,{style:e.shimmerWrapperStack},i.createElement(o.E,null,i.createElement("div",{className:e.shimmerCardWrapper},i.createElement("div",{className:e.shimmerCard},i.createElement("div",{className:e.shimmerRow},i.createElement(r.H,{shape:"circle"}),i.createElement(r.H,{shape:"rectangle"})),i.createElement("div",{className:e.shimmerRow},i.createElement(r.H,{shape:"circle"}),i.createElement(r.H,{shape:"rectangle"})),i.createElement("div",{className:e.shimmerRow},i.createElement(r.H,{shape:"circle"}),i.createElement(r.H,{shape:"rectangle"}))))))}},23436:(e,t,n)=>{n.d(t,{A:()=>T});var o=n(65593),r=n(92153),i=n(20505),a=n(4396),s=n(21137),l=n(88700),c=n(8520),u=n(49118),d=n(36130),p=n(86688);const h="128px";var g=n(30685),f=n(16895),m=n(62653),y=n(91836),v=n(658),C=n(31238);const b={mainContent:{fontFamily:"-apple-system",lineHeight:"normal"},textContent:{fontFamily:"-apple-system",lineHeight:"normal"},refreshButton:{fontFamily:"-apple-system",lineHeight:"normal"},errorCodeButton:{fontFamily:"-apple-system",lineHeight:"normal"}},E=(0,v.n)({root:(A=b).root??{},mainContent:A.mainContent??{},textContent:A.textContent??{},refreshButton:A.refreshButton??{},errorCodeButton:A.errorCodeButton??{}});var A;const S={root:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",alignItems:"center",justifyContent:"space-between",...f.Pt.overflow("hidden","auto"),scrollBehavior:"smooth"},mainContent:{alignItems:"center",justifyContent:"center",marginTop:m.L.spacingVerticalXXL,rowGap:m.L.spacingVerticalL},textContent:{rowGap:m.L.spacingVerticalM,alignItems:"center"},refreshButton:{backgroundColor:m.L.colorBrandBackground,...f.Pt.padding(m.L.spacingVerticalSNudge,m.L.spacingHorizontalM),...f.Pt.borderRadius(m.L.borderRadiusNone)},errorCodeButton:{justifySelf:"flex-end",height:"4.65%",...f.Pt.borderWidth(m.L.strokeWidthThin),...f.Pt.borderRadius(m.L.borderRadiusXLarge),...f.Pt.padding(m.L.spacingVerticalM,m.L.spacingHorizontalL),...y.g.caption1,width:"92%",...f.Pt.margin(m.L.spacingVerticalL,m.L.spacingHorizontalL)}},I=(0,v.n)(S),P={errorBoundaryActionButton:p.C_,errorBoundaryBody:p.SX,errorBoundaryButton:p.Oh,errorBoundaryHeader:p.Jr},T=c.memo((({errorBoundaryImagePath:e,overrideStyles:t,handleRefreshButtonOnClick:n=()=>{},handleErrorButtonOnClick:p=()=>{}})=>{const f=(()=>{const e=I(),t=E();(0,C.xp)()===g.Y.IOS&&(0,d.bt)(e,t);return e})(),m=(0,o.kQ)(P);return(0,d.bt)(f,t),c.createElement(u.W,{style:f.root},c.createElement(u.W,{style:f.mainContent},c.createElement(r._,{src:e,alt:"",height:h,width:h,loading:"lazy"}),c.createElement(u.W,{style:f.textContent},c.createElement(i.M,null,m.errorBoundaryHeader()),c.createElement(a.c,null,m.errorBoundaryBody())),c.createElement(s.$,{onClick:n,className:f.refreshButton,appearance:"primary"},m.errorBoundaryButton())),c.createElement(s.$,{appearance:"outline",icon:c.createElement(l.Jg_,null),className:f.errorCodeButton,onClick:p},m.errorBoundaryActionButton()))}))},71406:(e,t,n)=>{n.d(t,{K:()=>R});var o=n(65593),r=n(53075),i=n(64056),a=n(26260),s=n(44907),l=n(3334),c=n(73090),u=n(19997),d=n(21137),p=n(35571),h=n(86691),g=n(8520),f=n(658),m=n(16895),y=n(62653);const v=(0,f.n)({dialogSurface:{width:"100%",height:"100%",maxWidth:"unset",maxHeight:"100%",minWidth:"20%",minHeight:"20%",display:"block",...m.Pt.padding("0px"),...m.Pt.borderRadius(y.L.borderRadiusMedium),...m.Pt.border("none"),...m.Pt.overflow("hidden"),...m.Pt.outline("3px","solid",y.L.colorTransparentBackground)},dialogBody:{alignItems:"left",colorScheme:"none",width:"100%",height:"90%",maxHeight:"85%",display:"flex",flexDirection:"column",...m.Pt.padding("0px","12px","0px","12px"),"&::-webkit-scrollbar-button:horizontal:start:increment":{},"&::-webkit-scrollbar-button:horizontal:end:decrement":{},"&::-webkit-scrollbar-button:vertical:start:increment":{},"&::-webkit-scrollbar-button:vertical:end:decrement":{display:"none"},"&::-webkit-scrollbar-button:start:increment":{},"&::-webkit-scrollbar-button:start:decrement":{display:"none",...m.Pt.gap("12px"),...m.Pt.overflow("hidden","auto")}},dialogHeader:{display:"flex",flexDirection:"row",justifyContent:"space-between",...m.Pt.padding("12px","12px","12px","24px")}});var C=n(10877),b=n(9768),E=n(66636),A=n(89797),S=n(11404),I=n(70962),P=n(56759),T=n(99609),x=n(61398),w=n(17427),k=n(83242);const _=(0,f.n)({dialogContentRoot:{overflowY:"auto"}});var D=n(58651);const F=document.createElement("div"),L=()=>{throw new Error("Not implemented")},O=e=>{const{dialogContent:t,dialogActions:n,appDefinition:o,tokenService:r,msgExtCardContextProps:i,hostContext:a,userContext:s,isCardRenderingInTaskModuleEnabled:l,externalAuthService:c,cardInfo:u,appService:d,channelService:p,telemetryService:h,isDialogAcRendererEnabledForTaskModule:f,createAndSendSignalsToSubstrate:m}=e,y=(0,P.z)({...o,version:o.version??k.u,appId:o.id,manifestVersion:o.manifestVersion??k.u}),v=new w.R(i),O=i.clientInfo,R=i.taskModuleDialogTitle??"",M=_();switch(t.type){case T.g.Card:if(l&&!f&&t.card){let e=k.u,n=null,o=k.u;try{e=JSON.stringify(t.card),n=JSON.parse(e),o=n.content?JSON.stringify(n.content):k.u}catch(e){return null}const r={appId:u?.appId??n?.appId,cardId:u?.cardId??n?.cardId,botId:u?.botId??n?.botId,content:o,contentType:n.contentType},i=new A.a({shouldACUseInlinePopup:!0},void 0,O?.locale,k.u,O?.theme),a=v.getMsgExtCardService();return g.createElement(I.h,{cardDetails:r,serviceProvider:a,config:i})}if(f&&t.card){let e=k.u;try{const n=JSON.parse(t.card);e=JSON.stringify(n)}catch(n){D.log("Error parsing card content",n),e=JSON.stringify(t.card)}const o={appId:u.appId,content:e,contentType:S.z.AdaptiveCard,cardId:u.cardId,botId:u.botId},i=new A.a({shouldACUseInlinePopup:!0},void 0,a?.locale,"",a?.theme),l=new x.T(void 0,O,(()=>F),s,a,d,r,L,p,R,void 0,(e=>new Promise(((t,n)=>{e?setTimeout((()=>t()),2e3):n("CardId is missing")}))));if(!p||!l)throw new Error("Missing Parameters bot service or card service");return g.createElement("div",{className:M.dialogContentRoot},g.createElement(b.m,{cardDetails:o,dialogActions:n,channelService:p,telemetryService:h,supportedActions:[E.r.Execute,E.r.Submit,E.r.OpenUrl],featureFlags:i.featureFlags,theme:a?.theme,hostService:l}))}return null;case T.g.Url:return g.createElement(C.S,{dialogActions:n,content:t,appDefinition:y,hostContext:a,tokenService:r,userContext:s,externalAuthService:c,createAndSendSignalsToSubstrate:m})}},R=e=>{const{dialogContent:t,botService:n,appDefinition:f,tokenService:m,telemetryService:y,userContext:C,hostContext:b,appService:E,clientInfo:A,isCardRenderingInTaskModuleEnabled:S,handleCloseButtonClick:I,taskModuleLauncher:P,externalAuthService:T,shouldShowDismissIcon:x=!0,cardInfo:w,isDialogAcRendererEnabledForTaskModule:k,createAndSendSignalsToSubstrate:_}=e,D=(0,o.kQ)({DialogCloseButtonTitle:a.j}),F=(0,p.A)(h.p4K,h.LMj),L=v(),[R,M]=g.useState(t);g.useMemo((()=>{M(t)}),[t]);const B=e=>{M((t=>(e.title||(e.title=t?.title),"card"===e.type&&"string"==typeof e.card&&(e.card=JSON.parse(e.card)),e)))},N=g.useMemo((()=>{const e={close:()=>{M(void 0),I()},update:B};return(0,r.w)(e,f,n)}),[n]);if(!R)return null;const V={appService:E,tokenService:m,channelService:n,clientInfo:A,telemetryService:y,taskModuleLauncher:P},H=g.createElement(i.c,{appDefinition:f,title:R.title});return g.createElement(s.E,{className:L.dialogSurface},g.createElement(l.R,{className:L.dialogHeader},x?g.createElement(c.L,{action:g.createElement(u.z,{disableButtonEnhancement:!0,action:"close"},g.createElement(d.$,{tabIndex:0,appearance:"transparent","aria-label":D.DialogCloseButtonTitle(),icon:g.createElement(F,null),onClick:()=>N.close()}))},H):H),g.createElement(l.R,{className:L.dialogBody},g.createElement(O,{dialogContent:R,dialogActions:N,appDefinition:f,tokenService:m,msgExtCardContextProps:V,hostContext:b,userContext:C,isCardRenderingInTaskModuleEnabled:S,externalAuthService:T,cardInfo:w,appService:E,channelService:n,telemetryService:y,isDialogAcRendererEnabledForTaskModule:k,createAndSendSignalsToSubstrate:_})))}},44624:(e,t,n)=>{n.d(t,{l:()=>a});var o=n(30112),r=n(8520);const i=(0,n(658).n)({item:{height:"auto",width:"auto",flexShrink:1}}),a=({children:e,style:t})=>{const n=(0,o.z)(i().item,t);return r.createElement("div",{className:n},e)}},49118:(e,t,n)=>{n.d(t,{W:()=>s});var o=n(8520),r=n(658),i=n(30112);const a=(0,r.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),s=({children:e,style:t,horizontal:n=!1,reverse:r=!1,customProperties:s})=>{const l=((e,t,n,o)=>{let r=e.root;return t&&(r=(0,i.z)(r,t)),n?r=o?(0,i.z)(r,e.horizontalReverse):(0,i.z)(r,e.horizontal):o&&(r=(0,i.z)(r,e.verticalReverse)),r})(a(),t,n,r);return o.createElement("div",{className:l,...s},e)}},13922:(e,t,n)=>{n.d(t,{N:()=>l});var o=n(41519),r=n(93536),i=n(8520),a=n(64277),s=n(88027);function l(e){const{theme:t,dir:n,children:l}=e,c=i.useMemo((()=>{switch((0,s.$x)()){case o.G.defaultBlack:return{...a.Ay,...t};case o.G.defaultWhite:default:return{...a.tR,...t}}}),[t]);return i.createElement(r.q,{theme:c,dir:n},l)}},17678:(e,t,n)=>{n.d(t,{A:()=>C});var o=n(10145),r=n(21137),i=n(8520),a=n(93400),s=n(88027),l=n(36130),c=n(97511),u=n(49118);var d=n(92782),p=n(16895),h=n(658),g=n(30112),f=n(64277);const m=(0,d.Q)(f.tR),y={root:{backgroundColor:m.neutralLight,...p.Pt.borderRadius(m.borderRadiusXLarge),...p.Pt.margin(m.spacingHorizontalL),...p.Pt.padding(m.spacingVerticalM),...p.Pt.border("1px","double",m.colorTransparentStroke),backgroundImage:`linear-gradient(${m.neutralLight}, ${m.neutralLight}), radial-gradient(circle at top left, ${m.themePrimary}, ${m.themeSecondary})`,backgroundOrigin:"border-box",backgroundClip:"padding-box, border-box",rowGap:m.spacingVerticalXS},rootHighContrast:{...p.Pt.border("1px","solid",m.neutralLighterAlt)},headerWrapper:{flexDirection:"row",alignItems:"center"},headerText:{fontWeight:m.fontWeightSemibold,lineHeight:m.lineHeightBase300,whiteSpace:"pre-line"},descriptionText:{color:m.neutralQuaternaryAlt,fontSize:m.fontSizeBase300,lineHeight:m.lineHeightBase300,whiteSpace:"pre-line",marginTop:m.spacingVerticalS},tipCardIcon:{color:m.themePrimary,marginRight:m.spacingHorizontalSNudge},actionButtonWrapper:{...p.Pt.margin(0),marginTop:m.spacingVerticalS,color:m.neutralLight},actionButton:{float:"left",alignItems:"center",justifyContent:"center",width:"fit-content",height:m.spacingVerticalXXL,backgroundColor:m.themePrimary,...p.Pt.borderRadius(m.borderRadiusMedium),paddingRight:m.spacingHorizontalS,paddingLeft:m.spacingHorizontalS,paddingTop:"3px",paddingBottom:"5px",fontSize:m.fontSizeBase200,lineHeight:m.lineHeightBase200,color:m.neutralLight,":hover":{backgroundColor:m.themeTertiary,color:m.neutralLight,...p.Pt.border("1px","solid",m.colorNeutralForegroundStaticInverted),":active":{backgroundColor:m.themeDarker,color:m.neutralLight,...p.Pt.border("1px","solid",m.colorNeutralForegroundStaticInverted)}}}},v=(0,h.n)(y),C=i.memo((({headerText:e,descriptionTextList:t,buttonTitle:n,onClick:d,overrideStyles:p,icon:h,feedbackProps:f})=>{const m=(0,s.R2)(),y=v();((e,t)=>{if(t)for(const n in e)e[n]=(0,g.z)(e[n],t[n]);e.rootHighContrast=(0,g.z)(e.root,e.rootHighContrast)})(y,p);const C=(0,c.jd)(),b=(0,c.gN)(),E={...f,styles:b,actionBarProps:{...f?.actionBarProps,styles:C}};return i.createElement(u.W,{style:m?y.rootHighContrast:y.root,customProperties:{role:l.eg.GROUP,tabIndex:0,"aria-labelledby":"tipCardHeaderText"}},i.createElement(u.W,{style:y.headerWrapper},h&&(()=>{const e=h;return i.createElement(e,{className:y.tipCardIcon})})(),i.createElement(o.E,{id:"tipCardHeaderText",className:y.headerText},e)),i.createElement(u.W,null,(t??[]).map(((e,t)=>i.createElement(o.E,{key:t,id:"tipCardDescriptionText",className:y.descriptionText},e)))),n&&d?i.createElement("div",{className:y.actionButtonWrapper},i.createElement(r.$,{appearance:"primary",className:y.actionButton,onClick:d,title:n},n)):null,f&&f.shouldShowFeedbackButtons?i.createElement(a.A,{...E}):null)}))},83242:(e,t,n)=>{n.d(t,{H:()=>o,u:()=>r});const o=" ",r=""},64277:(e,t,n)=>{n.d(t,{Ay:()=>a,tR:()=>i,zQ:()=>s});var o=n(82794),r=n(86122);const i={...o.o,themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"},a={...r.C,themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"},s={...o.o,themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"}},86688:(e,t,n)=>{n.d(t,{$k:()=>Ae,AF:()=>ee,C3:()=>C,C_:()=>$,DK:()=>p,DR:()=>a,Dc:()=>se,EY:()=>N,Jm:()=>g,Jr:()=>Q,KJ:()=>_,M2:()=>w,Oh:()=>Y,Ov:()=>V,Ps:()=>be,RC:()=>ge,Rw:()=>oe,SG:()=>G,SX:()=>K,T_:()=>Ie,To:()=>M,Tp:()=>te,Ub:()=>he,Un:()=>J,Vv:()=>D,Vw:()=>ye,XC:()=>le,Y$:()=>Z,YX:()=>F,Z0:()=>de,ZF:()=>s,Zl:()=>H,Zz:()=>R,_N:()=>S,_V:()=>r,aP:()=>v,aX:()=>fe,b6:()=>_e,bK:()=>T,cn:()=>ve,dG:()=>L,eA:()=>ke,eG:()=>h,eT:()=>ce,f_:()=>Pe,gV:()=>B,hU:()=>l,jO:()=>b,jo:()=>re,k7:()=>P,kH:()=>O,kd:()=>j,kq:()=>we,lQ:()=>ae,mF:()=>u,mc:()=>ne,nK:()=>Se,ny:()=>U,pL:()=>k,qK:()=>me,qV:()=>pe,qd:()=>y,rG:()=>f,rU:()=>ue,s1:()=>Ce,sv:()=>m,tE:()=>I,uC:()=>x,uw:()=>A,vB:()=>c,w:()=>xe,wO:()=>X,wY:()=>W,wg:()=>Te,ws:()=>ie,xo:()=>z,yd:()=>i,yx:()=>q,zT:()=>d,zw:()=>E,zx:()=>Ee});var o=n(18850);const r=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChangeTopicButtonLabel"),i=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatCardFooterDisclaimer"),a=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.AIGenerated"),s=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatContainerFeedbackNudgeContent"),l=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatContainerFeedbackNudgeContentTitle"),c=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatContainerFeedbackNudgeHeader"),u=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatContainerFeedbackNudgeHeaderTitle"),d=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.FREHeaderText"),p=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.FREButtonText"),h=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.FREHeaderTextLabel"),g=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.FREDescriptionTextLabel"),f=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.HintCardHeaderTextLabel"),m=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.HintCardDescriptionTextLabel"),y=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.LoadingUiTextLabel"),v=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.StopGeneratingButtonLabel"),C=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ZQMHeaderTextLabel"),b=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.WUCHeaderTextLabel"),E=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatCardFooterDisclaimerPowered"),A=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.AIPowered"),S=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ProactiveSuggestionTitleText"),I=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ProactiveSuggestionIconText"),P=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ProactiveSuggestionBodyText"),T=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ShowMeButtonText"),x=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ProactiveSuggestionApplyBtnText"),w=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ProactiveSuggestionImageAltText"),k=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SlideLinksMessage1Option1"),_=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SlideLinksMessage1Option2"),D=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SlideLinksListItemText"),F=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SlideLinksMessage2Part1"),L=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SlideLinksMessage2Part2"),O=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatHistoryHeaderAriaLabel"),R=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.EmptyConversationListText"),M=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ConversationListErrorStateText"),B=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ConversationListErrorStateTitle"),N=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatHistoryDeleteButtonAriaLabel"),V=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatHistoryListSecondaryButtonAriaLabel"),H=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatHistoryPanelAriaLabel"),U=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.DeleteAllChatHistoryButtonText"),j=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.NewConversationButtonText"),z=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.NewChatButtonText"),G=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ShowChatHistoryButtonText"),W=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatHistoryBackButtonAriaLabel"),q=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatHistoryNewConversationAriaLabel"),Q=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ErrorBoundaryHeader"),K=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ErrorBoundaryBody"),Y=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ErrorBoundaryButton"),$=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ErrorBoundaryActionButton"),J=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.RestrictiveSearchMessageTitleText"),X=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.RestrictiveSearchMessageBodyText"),Z=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.LearnMoreString"),ee=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ReferenceText"),te=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ReferencesText"),ne=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.ChatMessagesAccessibilityLabel"),oe=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.LikeButtonAccessibilityLabel"),re=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.DislikeButtonAccessibilityLabel"),ie=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SuggestionPaneLabel"),ae=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SuggestionPaneRefreshButtonLabel"),se=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.PaneSilhouetteSeeLessGPTsLabel"),le=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.PaneSilhouetteSeeMoreGPTsLabel"),ce=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderTaskPaneOptionsLabel"),ue=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderCloseButtonLabel"),de=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderActivateRealtimeVoiceButtonLabel"),pe=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderDeactivateRealtimeVoiceButtonLabel"),he=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderHelpButtonLabel"),ge=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderResizeButtonLabel"),fe=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderMoveButtonLabel"),me=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderCollapseButtonLabel"),ye=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SharedHeaderExpandButtonOptionsLabel"),ve=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CopilotSwitcherMenuTriggerTitle"),Ce=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.TeachingCalloutHeaderText"),be=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CreditsTeachingCalloutTitleText"),Ee=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CreditsTeachingCalloutBodyText"),Ae=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.TeachingCalloutPrimaryButtonText"),Se=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CreditButtonText"),Ie=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CreditButtonTooltipTitle"),Pe=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CreditButtonTooltipBody"),Te=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.SendFeedbackButtonLabel"),xe=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CopilotBrandingTitle"),we=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CopilotBrandingTagline"),ke=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.CopilotBrandingIconId"),_e=(0,o.Ex)("officeaicopilot-ui.copilotUiStrings.MoreExamplesButtonLabel")},63758:(e,t,n)=>{n.d(t,{jD:()=>i,pK:()=>a});var o=n(22663);let r=o.O.None;const i=e=>{r=e??o.O.None};const a=()=>r===o.O.GCC},31238:(e,t,n)=>{n.d(t,{dD:()=>s,j_:()=>i,xp:()=>a});var o=n(30685);let r=o.Y.web;const i=e=>{r=e},a=()=>r;function s(){return r===o.Y.IOS}},35572:(e,t,n)=>{n.d(t,{m:()=>o});const o=e=>{if(!e)return l();try{return e.pluginInfo.id.toLowerCase().includes("openaiplugin")||a(e.pluginInfo.id)||s(e.pluginInfo.id)?r(e):e.messageExtensionPluginInfo?i(e):l()}catch(e){return l()}},r=e=>{if(null!=e.pluginRuntimeId&&null!=e.pluginInfo.data?.MetaOSTitleId){let t="APIPluginAuth";(a(e.pluginInfo.id)||s(e.pluginInfo.id))&&(t="TypeAPowerPlatformAuth");return{requestType:t,apiPluginAuthRequest:{pluginId:e.pluginInfo.id,pluginRuntimeId:e.pluginRuntimeId,titleId:e.pluginInfo.data?.MetaOSTitleId,gptId:e.pluginInfo.data?.GptId,gptActionId:e.pluginInfo.data?.GptActionId},appId:e.pluginInfo.data?.MetaOSAppId??e.pluginInfo.data?.MetaOSTitleId,authUrl:e.oAuthCard.buttons[0]?.value}}return l()},i=e=>{const t=e.messageExtensionPluginInfo.errorType,n=e.oAuthCard?.buttons[0]?.value,o=JSON.parse(e.messageExtensionPluginInfo.failedActivity),r=o?.request;if(!r)throw new Error("Failed to parse pluginAuthError");return{requestType:t,authUrl:n,botInvokeRequest:{botId:r.msaAppId,appId:r.metaOsAppId,requestBody:{name:r.name,value:r.value}},appId:r.metaOsAppId}};function a(e){return e.toLowerCase().includes("powerplatform")}function s(e){return e.toLowerCase().includes("dataverse")}function l(){return{requestType:void 0,authUrl:void 0,botInvokeRequest:void 0,apiPluginAuthRequest:void 0,appId:void 0}}},88027:(e,t,n)=>{n.d(t,{$x:()=>s,N_:()=>a,R2:()=>l,_X:()=>u,kF:()=>d,uj:()=>c});let o=n(41519).G.defaultWhite,r=!1,i=!1;const a=e=>{o=e},s=()=>o,l=()=>r,c=e=>{r=e},u=e=>{i=e},d=()=>i},24355:(e,t,n)=>{n.d(t,{q:()=>r,M:()=>i});var o=n(63758);var r;!function(e){e.Word="Word",e.PPT="PPT",e.Excel="Excel",e.OneNote="OneNote",e.Visio="Visio",e.Loop="Loop",e.Txt="Txt",e.SharePoint="SharePoint",e.Copilot="Copilot"}(r||(r={}));const i=e=>{const t=(0,o.pK)();switch(e){case r.Word:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/docx.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg";case r.PPT:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/pptx.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg";case r.Excel:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/xlsx.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg";case r.OneNote:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/one.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/one.svg";case r.Visio:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/vsdx.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/vsdx.svg";case r.Loop:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/loop.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/loop.svg";case r.Txt:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/txt.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg";case r.SharePoint:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240925.001/assets/item-types/20/spo.svg":"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/spo.svg";case r.Copilot:return t?"https://res.gcc.cdn.office.net/files/fabric-cdn-prod_20240411.001/assets/brand-icons/product/svg/copilot_24x1.svg":"https://res-2-sdf.cdn.office.net/files/fabric-cdn-prod_20240411.001/assets/brand-icons/product/svg/copilot_24x1.svg";default:return""}}},36130:(e,t,n)=>{n.d(t,{CG:()=>I,Cu:()=>y,Iw:()=>T,L5:()=>_,Qh:()=>D,XG:()=>w,bt:()=>A,c9:()=>k,cj:()=>v,eg:()=>f,kT:()=>x,mj:()=>P,vS:()=>S,vy:()=>F,zP:()=>m});var o=n(11404),r=n(41519),i=n(39387),a=n(92782),s=n(30112),l=n(74487),c=n(39086),u=n(83242),d=n(64277),p=n(88027),h=n(58651);const g=(0,a.Q)(d.tR),f={GROUP:"group",LIST:"list",LIST_ITEM:"listitem",HEADING:"heading",MENU:"menu",MENU_ITEM:"menuitem",BUTTON:"button",ALERT:"alert"},m=e=>Object.values(o.z).filter((t=>t===e))?.[0],y=async e=>{try{const t=b(e),n=document.getElementById(e)?.innerText||"",o=new ClipboardItem({"text/html":new Blob([t],{type:"text/html"}),"text/plain":new Blob([n],{type:"text/plain"})});t&&await navigator.clipboard.write([o])}catch(e){h.log("Error copying html to clipboard",e.message)}},v=(e,t,n)=>{const o=document.getElementById(e),r=o?.cloneNode(!0);E(o,r),n||C(r);let i=r.outerHTML;if(t){const e=r.getElementsByClassName(c.Ht);e.length>0&&(i=`${e[0]?.outerHTML}`)}return r.parentNode?.removeChild(r),i},C=e=>{const t=e.getElementsByTagName("a");for(;t.length>0;)"button"===t[0].role&&t[0].remove()},b=e=>{const t=document.getElementById(e),n=t?.cloneNode(!0);E(t,n);const o=n.outerHTML.replace(c.J9,"");return n.parentNode?.removeChild(n),o};function E(e,t){if(!e)return;const n=document.createElement("div");document.body.appendChild(n);const o=getComputedStyle(e),i=getComputedStyle(n),a=[];for(let e=0;e<o.length;e++){const t=o[e];let n=o.getPropertyValue(t);const s=i.getPropertyValue(t),l=(0,p.$x)();l!==r.G.defaultBlack&&l!==r.G.defaultDarkGrey||"color"===t&&(n=g.black),n!==s&&a.push(`${t}: ${n}`)}t.setAttribute("style",a.join(";"));const s=e.children,l=t.children;for(let e=0;e<s.length;e++){E(s[e],l[e])}n.remove()}const A=(e,t)=>{if(t)for(const n in e)e[n]=(0,s.z)(e[n],t[n]);return e},S=(e,t)=>{const n=[],o=e.body;return(e=>{const t=e.split(/(\[.*?\]\(.*?\))/g),n=[];for(const e of t)if(!e.startsWith("[")||!e.endsWith(")")){let t=e.trim();t.startsWith(".")&&(t=t.substring(1).trim(),n.length>0&&(n[n.length-1]=n[n.length-1]+". ")),n.push(t)}return n})(o[0].text).forEach(((r,i)=>{r.length>0?n.push({adaptiveCard:{...e,body:[{...o[0],text:r}]},references:t[i]?[t[i]]:[]}):t[i]&&n.length>0&&n[n.length-1].references?.push(t[i])})),n},I=(e,t)=>{t.sort(((e,t)=>e.referenceIndex-t.referenceIndex));let n=0;return t.forEach((t=>{const o=t?.referenceProps?.citationPosition??0+n,r="["+t.referenceIndex.toString()+"]()";e=e.substring(0,o)+r+e.substring(o),n+=r.length})),e},P=(e,t)=>{if(0===t.length)return!1;const n=e.search("%c");if(-1===n)return!1;let o=e.slice(n+2).search("%c");if(-1===o)return!1;o=o+n+2;const r=parseInt(e.slice(n+2,o));return t.some((e=>e.referenceIndex===r))},T=(e,t)=>{const n=[];let o=e.search("%c");for(;-1!==o;){let r=e.slice(o+2).search("%c");if(-1===r)break;r+=o+2;const i=parseInt(e.slice(o+2,r));n.push({message:e.slice(0,o),references:[t?.find((e=>e?.referenceIndex===i))??{}]}),o=(e=e.slice(r+2)).search("%c")}return n},x=e=>{let t=u.u,n=u.u,o=u.u,r=u.u;if(!e||0===e.length)return{prefixText:o,skillText:r,inputText:t,hintText:n};const i=e.lastIndexOf("}"),a=e.lastIndexOf("{",i);i>a&&a>=0&&(r=e.slice(a+1,i),o=e.slice(0,a),e=e.slice(i+1));const s=e.lastIndexOf("]"),l=e.lastIndexOf("[",s);return s>l&&l>=0?(t=e.slice(0,l),n=e.slice(l,s+1)):t=e,{prefixText:o,skillText:r,inputText:t,hintText:n}},w=()=>({aadUserId:"",clientType:l.WK.web,hubName:l.UH.orange,locale:"en-US",physicalRing:"",sessionId:"",theme:l.BD.default,userName:"",userPrincipalName:""}),k=(e,t)=>t.find((t=>t.tokenPhrases.every((t=>e.includes(t))))),_=(e,t)=>{const n=[];if(t&&0===t.tokenPhrases.length)return n;let o=e,r=0;for(;o.length>0;){let e=!1,a=-1;if(t&&t.tokenPhrases.length>0&&r<t.tokenPhrases.length){const s=t;a=o.indexOf(s[r]),0===a&&(e=!0,n.push({promptType:i.t.Skill,promptText:s[r]}),o=o.substring(s[r].length))}if(e)r++;else{const e=o.indexOf("["),t=o.indexOf("]"),r=o.indexOf("("),s=o.indexOf(")");let l=-1,c=i.t.Regular;e>=0&&t>=0&&(l=e,0===l&&(c=i.t.Ghost,l=t+1)),r>=0&&s>=0&&(-1===l||r<l)&&(l=r,0===l&&(c=i.t.File,l=s+1)),-1===l&&(l=a>0?a:o.length),n.push({promptType:c,promptText:o.substring(0,l)}),o=o.substring(l)}}return n};function D(e){return null!=e&&!(e.trim()===u.u)}const F=(e,t,n)=>e>1||1===e&&t+n!==1},60645:(e,t,n)=>{n.d(t,{D:()=>u,f:()=>c});var o=n(8520),r=n(38283);class i{constructor(){this.events=[],this.startTime=Date.now()}log(e){this.events.push(Object.assign(Object.assign({},e),{timestamp:Date.now()-this.startTime}))}static serializeState(e){switch(e){case r.Y.Connecting:return"Connecting";case r.Y.Listening:return"Listening";case r.Y.Thinking:return"Thinking";case r.Y.Speaking:return"Speaking";case r.Y.Error:return"Error";case r.Y.Interrupted:return"Interrupted";case r.Y.Disconnected:return"Disconnected";default:return""}}toCsv(){return this.events.map((e=>{var t;return`${e.timestamp},${e.event},${i.serializeState(e.state)},${null!==(t=e.dataLength)&&void 0!==t?t:""}`})).join("\n")}downloadCsv(){const e=this.toCsv(),t=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="tracer_events.csv",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}}var a=n(21515);const s=()=>{},l=o.createContext({modality:a.S.Chat,changeModality:()=>{throw new Error("Can't change modality, the control is not wrapped in a context")},isVoiceModeTriggered:!1,setVoiceModeTriggered:s,enableTracing:s}),c=()=>o.useContext(l),u=({children:e,clientOverride:t})=>{const[n,r]=o.useState(a.S.Chat),[s,c]=o.useState(void 0),[u,d]=o.useState(!1),p=o.useCallback((()=>{s||c(new i)}),[s]);return o.createElement(l.Provider,{value:{modality:n,changeModality:r,isVoiceModeTriggered:u,setVoiceModeTriggered:d,tracer:s,enableTracing:p,clientOverride:t}},e)}},21515:(e,t,n)=>{var o;n.d(t,{S:()=>o}),function(e){e[e.Chat=0]="Chat",e[e.RealtimeVoice=1]="RealtimeVoice"}(o||(o={}))},94241:(e,t,n)=>{n.d(t,{i:()=>o});class o{static get chatSessionId(){return this._chatSessionId}static set chatSessionId(e){this._chatSessionId=e}}o._chatSessionId=null},24502:(e,t,n)=>{n.d(t,{C:()=>o});class o{constructor(){}static getInstance(){return o.instance||(o.instance=new o),o.instance}setALSession(e){this.alSession=e}getALSession(){return this.alSession}}},71080:(e,t,n)=>{n.d(t,{X:()=>a});var o=n(58651);class r{constructor(e,t){this.realTimeConnection=e,this.realTimeConnection?.SetErrorCallback(t),this.realTimeConnection?.SetAudioBufferCallback((e=>this.OnAudioBufferCallback(e)))}async Initialize(e){await(this.realTimeConnection?.InitializeConnection(e))}async StartMicrophone(){return this.realTimeConnection?.StartMicrophone()}async Pause(){return this.realTimeConnection?.PauseConnection()}async Resume(){return this.realTimeConnection?.ResumeConnection()}async Close(){return await(this.realTimeConnection?.PauseConnection()),this.realTimeConnection?.CloseConnection()}async OnAudioBufferCallback(e){o.log("DevLog: OnAudioBufferCallback")}}var i=n(73420);class a{static GetInstance(){return null==this.instance&&(this.instance=new r(i.K.GetInstance(),(e=>{}))),this.instance}static destroyInstance(){null!=this.instance&&(this.instance.Close(),this.instance=null)}}a.instance=null},76610:(e,t,n)=>{n.d(t,{EO:()=>l,OI:()=>s,Rh:()=>i,V9:()=>r,q$:()=>a,xP:()=>o});const o="ErrorAugloopActivateAnnotations",r=3e4,i={maxRetries:3,retryWaitMilliseconds:5e3},a="granted",s="denied";var l;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(l||(l={}))},87733:(e,t,n)=>{n.d(t,{G:()=>s,n:()=>a});var o=n(58651);const r="en-US",i=["ar-BH","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-OM","ar-QA","ar-SA","ar-SY","ar-AE","bg-BG","ca-ES","zh-HK","zh-CN","zh-TW","hr-HR","cs-CZ","da-DK","nl-NL","en-AU","en-CA","en-HK","en-IN","en-IE","en-NZ","en-PH","en-SG","en-ZA","en-GB","en-US","et-EE","fi-FI","fr-CA","fr-FR","de-DE","el-GR","gu-IN","hi-IN","hu-HU","ga-IE","it-IT","ja-JP","ko-KR","lv-LV","lt-LT","mt-MT","mr-IN","nb-NO","pl-PL","pt-BR","pt-PT","ro-RO","ru-RU","sk-SK","sl-SI","es-AR","es-BO","es-CL","es-CO","es-CR","es-CU","es-DO","es-EC","es-SV","es-GT","es-HN","es-MX","es-NI","es-PA","es-PY","es-PE","es-PR","es-ES","es-UY","es-US","es-VE","sv-SE","ta-IN","te-IN","th-TH","tr-TR","af-ZA","am-ET","bn-IN","cy-GB","eu-ES","fa-IR","fil-PH","gl-ES","he-IL","hy-AM","id-ID","is-IS","ka-GE","kk-KZ","km-KH","kn-IN","lo-LA","mk-MK","ml-IN","ms-MY","ne-NP","pa-IN","sq-AL","uk-UA","vi-VN"];function a(e){let t="en-US";return t=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}}(function(e){const t=e.split("-");if(1==t.length)return t[0].toLowerCase();t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase());if(t.length>2)for(let e=1;e<t.length-1;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].slice(1).toLowerCase();return t.join("-")}(e)),-1==i.indexOf(t)&&(t=function(e){const t=e.split("-");for(let e=0;e<i.length;e++){const n=i[e];if(t[0]==n.split("-")[0])return n}return e}(t)),-1==i.indexOf(t)&&(t=r),o.log("STT Language is "+t),t}const s=e=>{switch(e.toLowerCase()){case"zh-hk":case"zh-cn":case"zh-tw":case"ja-jp":return!1;default:return!0}}},46896:(e,t,n)=>{n.d(t,{ne:()=>b,N6:()=>h,WY:()=>v,QV:()=>m,WT:()=>y,Uk:()=>C});var o,r=n(24502),i=n(71080),a=n(76610),s=n(73420);!function(e){e[e.Completed=0]="Completed",e[e.Canceled=1]="Canceled"}(o||(o={}));class l{constructor(e){this.isCanceled=!1,this.tasks=e}async ExecuteTaskListSequentially(){if(this.isCanceled)return{status:o.Canceled};let e=null;if(this.tasks)for(const t of this.tasks)try{if(e=await t(e),this.isCanceled)return{status:o.Canceled}}catch(e){if(this.isCanceled)return{status:o.Canceled};throw e}return{status:o.Completed,result:e}}Cancel(){this.isCanceled=!0}}var c=n(58651);class u{static getInstance(){return u._instance||(u._instance=new u),u._instance}startVoiceInputTimer(e,t){this.timerId&&clearTimeout(this.timerId),this.timerId=setTimeout((async()=>{await m(t),c.log("Voice input timed out")}),e)}stopVoiceInputTimer(){this.timerId&&clearTimeout(this.timerId)}}var d=n(52546),p=n(58651);const h=async(e,t,n,o,a,c)=>{if(r.C.getInstance().setALSession(c),s.K.createInstance(t,n,e),null==s.K.GetInstance())throw new Error("realTimeTranscriptionConnection is null");const u=new l([()=>i.X.GetInstance().Initialize(e),()=>f(o)]);await(0,d.V6)(u),a(!1)};async function g(){let e=null;if(navigator.permissions)try{e=await navigator.permissions.query({name:"microphone"})}catch(e){}return e}const f=async e=>{const t=await g();p.log("Microphone Permission Status = "+t?.state),t?.state===a.OI?e(a.EO.Uninitialized):t?.state===a.q$&&e(a.EO.Enabled)},m=async e=>{await i.X.GetInstance().Pause(),e(!1)},y=async e=>{null!=s.K.GetInstance()&&(await m(e),u.getInstance().stopVoiceInputTimer())},v=async(e,t,n,o,r)=>{try{await i.X.GetInstance().Resume(),n(!1),o(a.EO.Enabled),r(!e),u.getInstance().startVoiceInputTimer(t,r)}catch(e){p.error("Error occurred - "+e),"ErrorAudioPermissionDeniedError"===e&&(await i.X.GetInstance().Pause(),n(!0)),o(a.EO.Uninitialized)}},C=async(e,t)=>{null!=s.K.GetInstance()&&u.getInstance().startVoiceInputTimer(e,t)},b=async()=>{s.K.destroyInstance(),i.X.destroyInstance()}},73420:(e,t,n)=>{n.d(t,{K:()=>g});var o=n(42387),r=n(54127),i=n(6552),a=n(35620),s=n(29946),l=n(11397),c=n(24502),u=n(76610),d=n(52546),p=n(58651);o.A.dictationSettings={dictationLanguage:"en-US",useAutoPunctuation:"Intelligent",useCorrections:"true",properties:{"SpeechContext-PhraseOutput.interimResults.resultType":"Hypothesis",setFeature:"emailplm,offtrt,copilot",Profanity:"masked","SpeechConfig-Context.DataCollection.Mode":"0"}};class h{constructor(e,t,n){this.speechToTextClient=null,this.voiceSession=null,this.isVoiceSessionActive=!1,this.closeConnectionPromise=null,this.locale=null,this.attempt=0,this.fdSpeechClientObserver={onSpeechSessionStarted:async e=>{try{null!=e&&p.log("Transcription speech session ID: ",e.speechSessionId)}catch(e){this.onError(e)}},onSpeechSessionStopped:()=>{this.speechEventEmitter.emit("SpeechSessionStopped")},onFinalText:e=>this.OnFinalResult(e),onFragmentText:e=>this.OnPartialResult(e),onSpeechRecognitionStarted:()=>{},onError:e=>{if(-1==e?.toString().indexOf(u.xP)||this.attempt>=3)try{if(e===r.J.ErrorAudioCaptureAsync||e===r.J.ErrorAudioDevicesNotFoundError||e===r.J.ErrorAudioNotReadableError||e===r.J.ErrorAudioPermissionDeniedError)return;const t=new Error("IAugloopSpeechObserverDecorator.onError: ");this.onError(t)}catch(e){this.onError(e)}},onSpeechEnd:()=>{},onEventUpdate:e=>{},showDictationWarning:()=>{},onWarning:e=>{},showPermissionPrompt:()=>{}},this.locale=n,this.onError=e=>{throw e},this.onAudioBuffer=e=>{},this.initPromise=this.PerformInitializeConnection(),this.speechEventEmitter=new l.EventEmitter,this.onTranscriptText=e,this.onTranscriptPartialText=t,o.A.dictationSettings.dictationLanguage=this.locale}async PerformInitializeConnection(){await this.InitializeSpeechToTextClient(),this.voiceSession=new i.Jv(void 0,this.fdSpeechClientObserver,!0,void 0,void 0,s.A.Dictation,c.C.getInstance()?.getALSession())}SetAudioBufferCallback(e){this.onAudioBuffer=e}SetErrorCallback(e){this.onError=e}async InitializeConnection(e){return this.attempt=0,this.locale=e,this.initPromise}async StartMicrophone(){return this.ResumeConnection()}async ResumeConnection(){if(this.isVoiceSessionActive)return Promise.resolve();if(await this.initPromise,this.isVoiceSessionActive=!0,null==this.locale)throw new Error("Reached resume connection without a locale. Did we really initilize AugloopRealTimeTranscriptionConnection?");o.A.dictationSettings.dictationLanguage=this.locale,await this.voiceSession.startVoiceSessionFromMicrophoneInput((e=>this.OnAudioBufferCallback(e)),null,null)}async PauseConnection(){if(!this.isVoiceSessionActive)return Promise.resolve();await this.initPromise,this.isVoiceSessionActive=!1,await this.voiceSession.stopMicrophoneInputAsync(),await this.voiceSession.stopVoiceSession()}async CloseConnection(){return null!=this.closeConnectionPromise||(this.closeConnectionPromise=new Promise((async(e,t)=>{try{this.voiceSession&&(this.voiceSession.endVoiceSession(),this.voiceSession.endVoiceSession(),await this.WaitForSessionEnd()),this.speechToTextClient&&await this.speechToTextClient.uninitializeAsync(),this.closeConnectionPromise=null,e()}catch(e){t(e)}}))),this.closeConnectionPromise}async WaitForSessionEnd(){const e=new Promise(((e,t)=>{setTimeout((()=>{try{this.voiceSession&&this.voiceSession.endVoiceSession(),e()}catch(e){t(e)}}),u.V9)})),t=new Promise(((e,t)=>{try{this.speechEventEmitter.once("SpeechSessionStopped",e)}catch(e){t(e)}}));await Promise.race([e,t])}OnFinalResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);p.log("transcript text "+n),this.onTranscriptText(n)}catch(e){this.onError(e)}}OnPartialResult(e){try{const t=this.locale;if(null==e||null==e)return;const n=e.get(t);p.log("RECOGNIZED: "+n),this.onTranscriptPartialText(""+n)}catch(e){this.onError(e)}}async InitializeSpeechToTextClient(){null!=this.closeConnectionPromise&&await this.closeConnectionPromise,this.speechToTextClient=new a.mp(void 0,this.fdSpeechClientObserver,!0,!0,!0,s.A.Dictation,c.C.getInstance().getALSession());let e=0;do{e>0&&await(0,d.uk)(u.Rh.retryWaitMilliseconds),this.attempt++,await this.speechToTextClient.initializeAsync([a.qW.PartialResult,a.qW.FinalResult])}while(!this.speechToTextClient.initialized&&e++<u.Rh.maxRetries)}OnAudioBufferCallback(e){this.onAudioBuffer(e)}}class g{static createInstance(e,t,n){null==this.instance&&(this.instance=new h(e,t,n))}static GetInstance(){return this.instance}static destroyInstance(){null!=this.instance&&(this.instance.CloseConnection(),this.instance=null)}}g.instance=null},52546:(e,t,n)=>{function o(e){return new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))}n.d(t,{V6:()=>r,uk:()=>o});const r=async e=>await(e?.ExecuteTaskListSequentially())},63158:(e,t,n)=>{n.r(t),n.d(t,{createICUString:()=>h,getOrdinalPluralString:()=>C,getOrdinalPluralStringUnsafe:()=>v,getPluralString:()=>m,getPluralStringUnsafe:()=>f,getStringForRange:()=>u,mapMidgardLocaleToCLDRLocale:()=>c,mapNumberToRangeForLocale:()=>d,mapOrdinalNumberToRangeForLocale:()=>p,parseOrdinalPluralString:()=>y,parsePluralString:()=>g});var o=n(79490),r=n(87250),i=n(34449),a=n.n(i),s=["zero","one","two","few","many","other"],l={zero:/zero\s*{([^}]+)}/,one:/one\s*{([^}]+)}/,two:/two\s*{([^}]+)}/,few:/few\s*{([^}]+)}/,many:/many\s*{([^}]+)}/,other:/other\s*{([^}]+)}/};function c(e){return e.split("-")[0]}function u(e,t){var n=(0,o.__read)(l[t].exec(e)||[],2)[1];return void 0===n?"":n}function d(e,t){return a()(t,e)}function p(e,t){return a().ordinal(t,e)}function h(e){var t="";return s.forEach((function(n){e[n]&&(t+=" ".concat(n,"{").concat(e[n],"}"))})),"".concat("{count, plural,").concat(t).concat("}")}function g(e,t,n){return u(e,d(t,n)||"other")}function f(e,t,n){if(t<0||t!==1/0&&!(0,r.A)(t))throw new Error("count must be a positive integer or Infinity");return g(e,t,n)}function m(e,t,n){if(void 0===t)return e;try{return f(e,t,n||"en")}catch(t){return e}}function y(e,t,n){return u(e,p(t,n)||"other")}function v(e,t,n){if(t<0||t!==1/0&&!(0,r.A)(t))throw new Error("count must be a positive integer or Infinity");return y(e,t,n)}function C(e,t,n){if(void 0===t)return e;try{return v(e,t,n||"en")}catch(t){return e}}},84649:(e,t,n)=>{n.d(t,{Y:()=>K});var o=n(18850),r=n(11120),i=n(46030),a=n(52891),s=n(77909),l=n(23913),c=n(30185),u=n(25510),d=n(47063),p=n(74842),h=n(8520);class g{static getInstance(e,t,n){return g.instance||(g.instance=new g(e,t,n)),g.instance}constructor(e,t,n){this.themeMode=n,this.tokenService=e,this.hostService=t,this.hostService&&(this.hostContextPromise=this.hostService.getHostContext())}getSpfxHostContext(){return this.hostContextPromise||(this.hostContextPromise=this.hostService?this.hostService.getHostContext():Promise.resolve(void 0)),this.hostContextPromise.then((e=>{var t;return e?{sourceAppName:e.sourceHostName||e.name||"",isTeamsHosted:"Teams"===e.name||"TeamsModern"===e.name||"teamshub"===(null===(t=e.name)||void 0===t?void 0:t.toLowerCase()),clientType:e.clientType||"Web"}:{sourceAppName:"",isTeamsHosted:!1,clientType:"Web"}}))}getSpoAccessToken(e){return this.tokenService.getToken({resource:e}).then((e=>e.authToken?e.authToken:Promise.reject("No token found"))).catch((e=>Promise.reject(e)))}getSpoDomain(){return this.spoDomainPromise||(this.spoDomainPromise=this.getGraphAccessToken().then((e=>{const t=`${this.getGraphEndpoint()}/v1.0/sites?$filter=siteCollection/root%20ne%20null&$select=webUrl,siteCollection&$top=1&VroomTakeover=1`;return fetch(t,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})})).then((e=>e.json())).then((e=>e.error?Promise.reject(e.error):e.value[0].siteCollection.hostname)).catch((e=>Promise.reject(e)))),this.spoDomainPromise}openUrl(e){const t=`${e}`;return this.getSpfxHostContext().then((e=>(null==e?void 0:e.isTeamsHosted)&&this.hostService?this.hostService.openUrl({url:t}):Promise.reject("fallback to window.open"))).then((()=>Promise.resolve())).catch((()=>(window.open(t,"_blank","noopener,noreferrer"),Promise.resolve())))}getGraphAccessToken(){return this.tokenService.getToken({resource:"00000003-0000-0000-c000-000000000000"}).then((e=>e.authToken||"")).catch((e=>Promise.reject(e)))}getGraphEndpoint(){return"https://graph.microsoft.com"}}class f extends s.bU{constructor(e,t,n){super(),this.title=e,this.description=t,this.iconUrl=n}getJsonTypeName(){return"SPFXComponentMetadata"}get title(){return this.getValue(f.title)}set title(e){this.setValue(f.title,e)}get description(){return this.getValue(f.description)}set description(e){this.setValue(f.description,e)}get iconUrl(){return this.getValue(f.iconUrl)}set iconUrl(e){this.setValue(f.iconUrl,e)}}f.title=new s.XB(s.uq.v1_0,"title"),f.description=new s.XB(s.uq.v1_0,"description"),f.iconUrl=new s.XB(s.uq.v1_0,"iconUrl");const m=h.lazy((()=>Promise.all([n.e("vendors~shared"),n.e("vendors~spfx-react-component")]).then(n.bind(n,4832)).then((e=>({default:e.SPFXReactComponent})))));class y extends p.hA{constructor(e){var t;super(),this.spfxHostService=g.getInstance(e.tokenService,e.hostService,null===(t=this.hostConfig)||void 0===t?void 0:t.themeMode),this.isPopover=e.isPopover||!1}get portableHostBaseUrl(){return this.getValue(y.portableHostBaseUrl)}set portableHostBaseUrl(e){this.setValue(y.portableHostBaseUrl,e)}get componentType(){return this.getValue(y.componentType)}set componentType(e){this.setValue(y.componentType,e)}get instanceId(){return this.getValue(y.instanceId)}set instanceId(e){this.setValue(y.instanceId,e)}get sourceListId(){return this.getValue(y.sourceListId)}set sourceListId(e){this.setValue(y.sourceListId,e)}get sourceItemId(){return this.getValue(y.sourceItemId)}set sourceItemId(e){this.setValue(y.sourceItemId,e)}get fallbackUrl(){return this.getValue(y.fallbackUrl)}set fallbackUrl(e){this.setValue(y.fallbackUrl,e)}get siteServerRelativeUrl(){return this.getValue(y.siteServerRelativeUrl)}set siteServerRelativeUrl(e){this.setValue(y.siteServerRelativeUrl,e)}get componentMetadata(){return this.getValue(y.componentMetadata)}set componentMetadata(e){this.setValue(y.componentMetadata,e)}internalRender(){return h.createElement(h.Suspense,{fallback:null},h.createElement(m,{siteServerRelativeUrl:this.siteServerRelativeUrl,componentType:this.componentType||"",instanceId:this.instanceId||"",sourceListId:this.sourceListId||"",sourceItemId:this.sourceItemId||"",fallbackUrl:this.fallbackUrl||"",componentMetadata:this.componentMetadata,spfxHostService:this.spfxHostService,shouldRenderPortableComponent:!this.isPopover}))}getJsonTypeName(){return"SPFXComponentBlock"}}y.portableHostBaseUrl=new s.XB(s.uq.v1_0,"portableHostBaseUrl"),y.componentType=new s.XB(s.uq.v1_0,"componentType"),y.instanceId=new s.XB(s.uq.v1_0,"instanceId"),y.sourceListId=new s.XB(s.uq.v1_0,"sourceListId"),y.sourceItemId=new s.XB(s.uq.v1_0,"sourceItemId"),y.fallbackUrl=new s.XB(s.uq.v1_0,"fallbackUrl"),y.siteServerRelativeUrl=new s.XB(s.uq.v1_0,"siteServerRelativeUrl"),y.componentMetadata=new s.a7(s.uq.v1_0,"componentMetadata","SPFXComponentMetadata",(e=>new f),!0);var v=n(30112),C=n(93536),b=n(21278),E=n(16895),A=n(658),S=n(62653);const I=(0,b.Q)("APIPluginCard",(0,A.n)({root:Object.assign(Object.assign(Object.assign(Object.assign({width:"fit-content",maxWidth:"100%",overflow:"auto hidden",backgroundColor:S.L.colorNeutralBackground2},E.Pt.borderStyle("solid")),E.Pt.borderWidth("1px")),E.Pt.borderRadius("12px")),E.Pt.borderColor(S.L.colorNeutralStroke1)),fluentProvider:{backgroundColor:S.L.colorTransparentBackground},renderer:{minWidth:"400px",":has(.ac-spfx-component)":{minWidth:"min(400px, 100%)"}}})),P=(0,A.n)({button:Object.assign(Object.assign(Object.assign(Object.assign({},E.Pt.borderRadius("4px")),E.Pt.borderWidth("1px")),E.Pt.borderStyle("solid")),{height:"32px"})});var T=n(65593),x=n(70734),w=n(72620),k=n(3817);const _=(0,o.Ex)("scc-react-api-plugin-card.genericError"),D=(0,o.Ex)("scc-react-api-plugin-card.appNotAvailable"),F=(0,o.Ex)("scc-react-api-plugin-card.untrustedUrl"),L=(0,o.Ex)("scc-react-api-plugin-card.appNotInstalled");n(31414);const O=(0,k.PA)((function(e){const t=(0,w.Cc)(e.cardId),n=function(e){switch(e){case w.g6.AppNotAvailable:return D;case w.g6.AppNotInstalled:return L;case w.g6.GenericError:return _;case w.g6.UntrustedUrl:return F;default:return _}}(null==t?void 0:t.type),o=(0,T.kQ)({messageText:n}),r=h.useMemo((()=>{return(null==t?void 0:t.type)?(e=o.messageText(),h.createElement("div",null,e)):h.createElement(h.Fragment,null);var e}),[t,o]);if(!t)return h.createElement(h.Fragment,null);let i;return t.actionMessageProps&&(i={text:t.actionMessageProps.actionMessage,onClick:t.actionMessageProps.onClick}),h.createElement(x.J,{message:r,messageType:t.messageType,dismissType:t.dismissType,action:i,onDismiss:R(e.cardId),autoDismissTimer:t.autoDismissTimer})}));const R=e=>()=>{(0,w.EF)(e,{})};var M=n(87789),B=n(79490);function N(e){if(e){if(e.startsWith("P_"))return e;if(e.startsWith("T_"))return"T_";if(e.startsWith("U_"))return"U_"}return""}var V=n(68779),H=n(21137),U=n(79689),j=n(88700);const z=(0,o.Ex)("scc-react-api-plugin-card.Copied"),G=(0,o.Ex)("scc-react-api-plugin-card.Copy"),W=(0,b.Q)("M365CardHeaderOptions",(0,A.n)({cardOptions:{paddingTop:"12px",paddingRight:"16px"},flex:{display:"flex",flexDirection:"row",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> :not(:first-child)":{marginTop:"0px"},"> *:not(.ms-StackItem)":{flexShrink:1}},flexItem:{height:"auto",width:"auto",flexShrink:1},button:{backgroundColor:S.L.colorNeutralCardBackground,":hover":{backgroundColor:S.L.colorNeutralCardBackground}}}));function q(e){const t=W(),n=(0,v.z)(t.flexItem,t.cardOptions),o=(0,T.Lh)(G),r=(0,T.Lh)(z),[i,a]=h.useState({tooltip:o,visible:void 0});return h.createElement("div",{className:n},h.createElement(V.m,{content:i.tooltip,relationship:"label",visible:i.visible},h.createElement(H.$,{className:t.button,size:"small",style:{border:"none"},icon:i.tooltip===r?h.createElement(U.c6S,null):h.createElement(j.k8e,null),onClick:()=>{e.onClick(),setTimeout((()=>{a({tooltip:o,visible:void 0})}),5e3),a({tooltip:r,visible:!0})}})))}const Q=(0,k.PA)((function(e){const{cardDetails:t,appService:n,hostService:o,telemetryService:i}=e,[a,s]=h.useState({appName:t.appName,appIcon:t.appIcon});h.useEffect((()=>{!n||null!=a.appName&&null!=a.appIcon||function(e,t,n,o,i,a){return(0,B.__awaiter)(this,void 0,void 0,(function*(){var s,l,c,u,d,p,h,g,f,m,y,v,C,b,E,A,S,I,P,T,x,w,k,_,D;try{const o={id:e},r=yield t.getApp(o),F=null===(l=null===(s=r.titleInfo)||void 0===s?void 0:s.titleDefinition)||void 0===l?void 0:l.elementDefinitions;if(!F)return{referenceId:void 0,appName:void 0,appIcon:void 0};const L=null===(c=F.gpts)||void 0===c?void 0:c.find((e=>e.id===i)),O=null===(u=null==L?void 0:L.actions)||void 0===u?void 0:u.find((e=>e.id===a)),R=null===(d=F.declarativeCopilots)||void 0===d?void 0:d.find((e=>e.id===i)),M=null===(p=null==R?void 0:R.actions)||void 0===p?void 0:p.find((e=>e.id===a)),B=null!==(h=null!=M?M:O)&&void 0!==h?h:null===(g=F.plugins)||void 0===g?void 0:g[0],N=null!==(v=null===(y=null===(m=null===(f=r.titleInfo)||void 0===f?void 0:f.titleDefinition)||void 0===m?void 0:m.iconLarge)||void 0===y?void 0:y.uri)&&void 0!==v?v:null===(E=null===(b=null===(C=r.titleInfo)||void 0===C?void 0:C.titleDefinition)||void 0===b?void 0:b.iconSmall)||void 0===E?void 0:E.uri,V=null===(S=null===(A=r.titleInfo)||void 0===A?void 0:A.titleDefinition)||void 0===S?void 0:S.validDomains;return{referenceId:null===(T=null===(P=null===(I=null==B?void 0:B.runtimes)||void 0===I?void 0:I[n])||void 0===P?void 0:P.auth)||void 0===T?void 0:T.referenceId,appName:null!==(k=null!==(w=null!==(x=null==B?void 0:B.nameForHuman)&&void 0!==x?x:null==R?void 0:R.name)&&void 0!==w?w:null==L?void 0:L.name)&&void 0!==k?k:null===(D=null===(_=r.titleInfo)||void 0===_?void 0:_.titleDefinition)||void 0===D?void 0:D.name,appIcon:N,validDomains:V}}catch(t){return null==o||o.LogError({type:r.FY.LogError,name:r.ru.getAppDataForAPIPlugins,tag:r.m2.getAppDataForAPIPlugins,success:r.YE.Failure,diagnosticsData:`Error while getting app data ${(null==t?void 0:t.message)||t} where titleId is ${N(e)}`}),{referenceId:void 0,appName:void 0,appIcon:void 0,validDomains:void 0}}}))}(t.appId,n,0,void 0,t.gptId,t.gptActionId).then((e=>{s(e)})).catch((e=>{null==i||i.LogException({type:r.FY.LogException,name:r.ru.APIPluginCard,tag:r.m2.getAppDataException,success:r.YE.Failure,diagnosticsData:`Error while getting the app data ${e}`})}))}),[t.appId,n]);const l=function(e,t,n){var o,i;const a=[];let s;try{s=JSON.parse(null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"{}")}catch(e){null==n||n.LogError({type:r.FY.LogError,tag:r.m2.MsgExtCardHeader,name:r.ru.getHeaderOptions,message:r.FG.cardContentParseError}),s={}}if(null===(i=s.metadata)||void 0===i?void 0:i.webUrl){const n=()=>{e.copyCard({cardDetails:t})};return a.push(h.createElement(q,{onClick:n})),a}return}(o,t,i);return h.createElement(M.D,{appName:a.appName,appIcon:a.appIcon,optionsComponents:l})}));function K(e){var t;const{cardDetails:n,serviceProvider:p,config:g}=e,f=h.useMemo((()=>(0,i.N)(null==g?void 0:g.themeMode,null==g?void 0:g.locale,null==g?void 0:g.featureFlags)),[g]),m=I(),b=h.useMemo((()=>{var t;const n=new d.e;if(p.tokenService){const o=p.tokenService;n.elementRegistry.register("SPFXComponentBlock",(t=>new y({tokenService:o,hostService:p.hostService,isPopover:e.isPopover}))),(null===(t=null==f?void 0:f.featureFlags)||void 0===t?void 0:t.isInsertImageEnabledForDAs)&&n.actionRegistry.register(a.b.JsonTypeName,(e=>new a.b),s.uq.v1_5)}return n}),[]);h.useEffect((()=>{var e;const t=(0,o.U5)(null!==(e=f.locale)&&void 0!==e?e:"en-us");(0,o.ex)().then((e=>{e!==t&&(0,o.Gd)(t)}))}),[f]),h.useEffect((()=>{const e=new c.k(null==p?void 0:p.telemetryService,r.yx.CardRender,r.xe.APIPluginCard);p.appService?e.logMetricEnd({diagnosticsData:`TypeOfCard: ${n.contentType},  cardId : ${n.cardId} , Appid: ${(0,u.n)(null==n?void 0:n.titleId,null==n?void 0:n.appId)}`},null==f?void 0:f.correlationId):e.logMetricEndWithError({diagnosticsData:`TypeOfCard: ${n.contentType},  cardId : ${n.cardId}, Error: Card rendering failed due to invalid appService, Appid: ${(0,u.n)(null==n?void 0:n.titleId,null==n?void 0:n.appId)}`})}));const E={useButtonStyles_unstable:e=>{const t=e;t.root.className=(0,v.z)(t.root.className,P().button)}},A=null===(t=null==g?void 0:g.featureFlags)||void 0===t?void 0:t.enableCopilotChatV2;return h.createElement(C.q,{customStyleHooks_unstable:E,className:A?m.fluentProvider:""},h.createElement("div",{className:m.root,"data-testid":"APIPluginCard"},h.createElement(Q,{cardDetails:n,appService:p.appService,hostService:p.hostService,telemetryService:p.telemetryService}),h.createElement("div",{className:m.renderer,"data-testid":"APIPluginCardRenderer"},h.createElement(l.v,{cardData:n,hostConfig:f,uxRegistry:b,serviceProvider:p,onPrepareRuntimeActivityRequest:void 0,onRuntimeActivityResponse:void 0})),h.createElement(O,{cardId:n.cardId})))}},41798:(e,t,n)=>{n.d(t,{$T:()=>i,Fl:()=>l,Fm:()=>s,c:()=>d,hU:()=>o,my:()=>u,nw:()=>c,ph:()=>r,tM:()=>a});const o="chatactionbar-toaster",r="https://copilot.cloud.microsoft/prompts/all?manageAccess=open&ocid=copilot_WXPOManageAccess",i="view-saved-prompt-button",a="save-success-toast",s="share-success-toast",l=5e3,c=1,u=0,d=47},27670:(e,t,n)=>{var o;n.d(t,{N:()=>o}),function(e){e.UserMessageV2="UserMessageV2",e.CopilotMessageV2="CopilotMessageV2"}(o||(o={}))},29208:(e,t,n)=>{n.d(t,{FM:()=>r,M2:()=>s,fq:()=>a,sn:()=>i});var o=n(18850);const r=(0,o.Ex)("scc-react-chat-output.chatOutputStrings.ReferencesShowLessLabel"),i=(0,o.Ex)("scc-react-chat-output.chatOutputStrings.aiDisclaimer"),a=(0,o.Ex)("scc-react-chat-output.chatOutputStrings.copyButtonText"),s=(0,o.Ex)("scc-react-chat-output.chatOutputStrings.copiedText")},73569:(e,t,n)=>{n.d(t,{m:()=>F});var o=n(32662),r=n(8520),i=n(79490),a=n(27635),s=n(82027),l=n(44907),c=n(3334),u=n(71808),d=n(50083);const p=(e,t,n,o)=>({text:e.text,entityProps:{className:null!=o?o:"",text:Object.assign(Object.assign({as:"a"},e.url?{href:e.url,target:"_blank",rel:"noopener"}:{}),{"data-entity-id":e.id,"data-entity-type":e.entityType})},data:{entity:e,annotation:t,rawEntityData:n?{data:n,type:e.entityType}:void 0}});function h(e){var t;null===(t=null==e?void 0:e.current)||void 0===t||t.removeCiqChar()}var g=n(35945),f=n(85004);function m(e){return e.replace(/[{}]/g,"")}function y(e){const t=e.sharepointIds;if(!t)return;const n=m(t.siteId||""),o=m(t.webId||""),r=m(t.listId||""),i=m(t.listItemUniqueId||"");return n&&o&&r&&i?btoa(`${n},${o},${r}`).replace(/[=]+$/g,""):void 0}const v=536870912,C=5,b=["File","LocalFile"],E=e=>{var t;return b.includes((null===(t=e.data)||void 0===t?void 0:t.entity.entityType)||"")};function A(e,t,n){var o,r;const i=((null===(o=t.current)||void 0===o?void 0:o.getActiveEntities())||[]).filter(E).length;if(function(e=1,t){return t+e<=C}(e.length,i))for(const o of e){if(o.size&&o.size>v){null==n||n.addFileSizeMessage(g.H.CloudFile);continue}const e=`SPO_${y(o)}_${o.id}`,i={entityType:"CloudFile",text:o.name||"",id:e,url:o.webUrl||o.webDavUrl||"",fileExtension:(o.name||"").split(".").pop()},a={id:e,text:o.name||"",queryAnnotationType:f.in.File},s={id:e,referenceId:"",fileName:o.name||"",accessUrl:o.webUrl||o.webDavUrl||"",spoId:e,attachmentSource:g.H.CloudFile};null===(r=t.current)||void 0===r||r.insertChatInputEntity(p(i,a,s))}else null==n||n.addFileLimitMessage(g.H.CloudFile)}var S=n(658),I=n(16895);const P=(0,S.n)({dialog:Object.assign({display:"flex",maxWidth:"fit-content"},I.Pt.padding("12px")),dialogBody:{},dialogContent:{},spinner:{position:"fixed",left:"50%",top:"50%"},iframe:{width:"75vw",height:"85vh",maxWidth:"100%",maxHeight:"100%",border:void 0,display:"block"}}),T=e=>{const t=P();return Object.assign(Object.assign({},t),null!=e?e:{})};function x(e){const{entityRef:t,isCalloutOpen:n,setIsCalloutOpen:o,service:p,controlRef:g,styles:f,onItemsSelected:m}=e,{inputContext:y}=(0,a.Ay)(),{insertCiqTriggerPluginRef:v}=y||{},[C,b]=r.useState(!0),[E,S]=r.useState(null),I=T(f),P=function(){const{serviceProvider:e}=(0,a.Ay)();return e.useInputMessages().service}();r.useEffect((()=>{const e={pick:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){o(!1),h(v),m?m(e.items):A(e.items,t,P)})),close:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){h(v),o(!1)})),pageLoaded:e=>{b(!1)}};if(E){let t;return p.initializePicker(E,e).then((e=>{t=e})).catch((e=>{h(v),o(!1),null==P||P.addUnexpectedErrorMessage()})),()=>null==t?void 0:t()}}),[E,o,g,t,p,P,v]);const x=r.useCallback((e=>{S(e&&e.contentWindow||null)}),[]);return r.createElement("div",null,r.createElement(s.l,{open:n,onOpenChange:(e,t)=>o(t.open)},r.createElement(l.E,{className:I.dialog},r.createElement(c.R,{className:I.dialogBody},r.createElement(u.C,{className:I.dialogContent},C&&r.createElement(d.y,{size:"large",className:I.spinner}),r.createElement("iframe",{title:"File Picker",sandbox:"allow-forms allow-modals allow-popups allow-same-origin allow-scripts",ref:x,className:I.iframe}))))))}var w=n(65593),k=n(18850);const _=(0,k.Ex)("scc-react-cloud-files.scc.attachCloudFilesMenuItemLabel"),D=(0,k.Ex)("scc-react-cloud-files.scc.uploadIconLabel");function F(e){const{entityRef:t,controlRef:n,locale:i,theme:a,appName:s,graphTokenProvider:l,sharepointTokenProvider:c,onAttachCloudFiles:u,shouldShowFileUploadButtonText:d,styles:p,supportedFileExtensionMimeMap:h,onItemsSelected:g}=e,[f,m]=r.useState(!1),y=r.useMemo((()=>new o.P(l,c,s,i,a,h)),[l,i,c,a,s,h]),v=function(e,t){const n=(0,w.kQ)({BizChatUploadIconLabel:D,BizChatAttachCloudFilesMenuItemLabel:_}),o=n.BizChatUploadIconLabel();return{enableCloudPicker:!0,isUploadFileButtonEnabled:!0,enableBrowseThisComputerOnFileFlags:!0,fluentMenuConfig:{enableMenuButtonIcon:!0,menuButtonText:t?o:"",menuItems:[{menuItemText:n.BizChatAttachCloudFilesMenuItemLabel(),enableMenuItemIcon:!0,menuItemIcon:"OneDrive",onClickHandler:e}]}}}(r.useCallback((()=>{u?u():m(!0)}),[m,u]),d);return{cloudFilePickerCallout:r.createElement(r.Fragment,null,r.createElement(x,{entityRef:t,isCalloutOpen:f,setIsCalloutOpen:m,controlRef:n,service:y,styles:p,onItemsSelected:g})),browseThisComputerSettings:v,service:y}}},27635:(e,t,n)=>{n.d(t,{N2:()=>h,IB:()=>u,CS:()=>c,Ay:()=>s});var o=n(70898),r=n(8520);const i=(0,o.m)(void 0,"SharedCopilotContext"),a=i.Provider;function s(){const e=r.useContext(i);if(!e)throw new Error("useSharedCopilotContext must be used within a SharedCopilotProvider");return e}function l(){return r.useContext(i)}function c(){var e;return null===(e=l())||void 0===e?void 0:e.serviceProvider.markdown}const u={useVoiceInput:()=>({ghostTextPlugin:void 0,microphoneButton:void 0}),useElaboratePromptPlugin:()=>({elaboratePromptButton:void 0,elaboratePromptProgressBar:void 0}),useLocalFiles:()=>({LocalFilesInputWrapper:void 0,FilePicker:void 0,service:void 0,filePickerRef:void 0,useDragAndDropStyle:()=>{},ciqProps:void 0}),useCiq:()=>({ciqPlugin:void 0}),useEntityPlugin:()=>({entityPlugin:void 0,entities:[],setEntities:()=>{},updateEntity:()=>{}}),useInputMessages:()=>({ChatInputMessages:void 0,service:void 0}),useCloudFiles:()=>({cloudFilePickerCallout:void 0,browseThisComputerSettings:void 0,service:void 0}),useAttachmentList:()=>({attachmentList:void 0}),useHydratedEntityPlugin:()=>({hydratedEntityPlugin:void 0,updateDraftForEntity:()=>{}}),usePromptSuggestions:()=>({promptListbox:void 0,cursorPositionPlugin:void 0,containerRef:void 0,onChange:void 0,onSubmit:void 0,onBlur:void 0,onFocus:void 0,onKeyDown:void 0,ref:void 0,isPromptAutocompleteSelectMode:void 0})},d={controlRef:void 0,entityRef:void 0,inputRef:void 0},p=()=>({logEvent:e=>{},log3sEvent:e=>{}}),h=e=>{const[t,n]=r.useState([]),{serviceProvider:o=u,inputContext:i=d,localFileContext:s,attachmentContext:l={attachments:t,setAttachments:n},getSharedCopilotLogger:c=p,children:h}=e;return r.createElement(a,{value:{serviceProvider:o,inputContext:i,localFileContext:s,attachmentContext:l,getSharedCopilotLogger:c}},h)}},2886:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});n(69471);const o={fragment:{argumentDefinitions:r=[{defaultValue:null,kind:"LocalArgument",name:"userPrompt"}],kind:"Fragment",metadata:null,name:"elaboratePromptQuery",selections:i=[{alias:null,args:null,concreteType:"BizChat",kind:"LinkedField",name:"bizChat",plural:!1,selections:[{alias:null,args:[{kind:"Variable",name:"input",variableName:"userPrompt"}],kind:"ScalarField",name:"elaboratePrompt",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:r,kind:"Operation",name:"elaboratePromptQuery",selections:i},params:{cacheID:"7bcc94789476d8c92c1ff58c0b10b126",id:null,metadata:{},name:"elaboratePromptQuery",operationKind:"query",text:"query elaboratePromptQuery(\n  $userPrompt: PromptElaborationRequestInput!\n) {\n  bizChat {\n    elaboratePrompt(input: $userPrompt)\n  }\n}\n"}};var r,i;o.hash="fdea60bd1ffe303a17908fe264a992d3";const a=o},14533:(e,t,n)=>{n.d(t,{a:()=>s});var o=n(93244),r=n(27635),i=n(41197),a=n(8520);function s({entityRef:e,onChatInputEntityAdded:t,onChatInputEntityDeleted:n,entityPluginId:s="EntityPlugin"}){const{attachmentContext:l}=(0,r.Ay)(),{setAttachments:c}=l||{},u=a.useCallback((e=>{var t;const n={type:i.J.entity,data:{entityElement:null===(t=e.data)||void 0===t?void 0:t.entity}};null==c||c((e=>[...e,n]))}),[c]),d=a.useCallback((e=>{null==c||c((t=>t.filter((t=>{var n,o;return(null===(n=t.data.entityElement)||void 0===n?void 0:n.id)!==(null===(o=e.data)||void 0===o?void 0:o.entity.id)}))))}),[c]);return{entityPlugin:a.createElement(a.Fragment,null,a.createElement(o.D,{id:s,controlRef:e,onChatInputEntityDeleted:null!=n?n:d,onChatInputEntityAdded:null!=t?t:u}))}}},21592:(e,t,n)=>{n.d(t,{O:()=>p});var o=n(8520),r=n(58399),i=n(29828);const a="text/link-preview";function s(e,t){try{const t=JSON.parse(e);return function(e){return!!e&&l(e.title)&&l(e.url)}(t)?t:void 0}catch(e){return void(null==t||t(`Failed to process clipboard data (type=${a})`))}}function l(e){return"string"==typeof e}function c(e,t){const n=function(e,t){var n;if(!(null===(n=null==e?void 0:e.types)||void 0===n?void 0:n.includes(a)))return;const o=null==e?void 0:e.getData(a);return o?s(o,t):void 0}(e,t);if(!n)return;const o=new URL(n.url).hostname;return(0,i.J)(o)?{url:n.url,file:n.title,fileExtension:(0,r.Q)(n.title)}:void 0}var u=n(93880),d=n(30136);const p=e=>o.useCallback((t=>{if(!t.clipboardData)return{handled:!1};const n=c(t.clipboardData,e.onError);if(!n)return{handled:!1};const o=(0,u.s)(n);return{handled:!0,transformedParts:[{type:"entity",value:(0,d.W)(o.entity,o.annotation,void 0,o.rawEntityData)}]}}),[e.onError])},13842:(e,t,n)=>{n.d(t,{k:()=>E});var o=n(8520),r=n(27635),i=n(84161),a=n(59707),s=n(79490);const l="u!";function c(e){return`https://graph.microsoft.com/v1.0/shares/${function(e){const t=btoa(unescape(encodeURIComponent(e)));return l+t.replace(/=+$/,"").replace(/\//g,"_").replace(/\+/g,"-")}(e)}/driveItem`}var u=n(58651);class d{constructor(){this.graphAuthTokenCallback=void 0}initialize(e){this.graphAuthTokenCallback=e}unfurlUrl(e){return(0,s.__awaiter)(this,void 0,void 0,(function*(){try{if(!this.graphAuthTokenCallback)throw new Error("Graph auth token callback is not initialized");const t=(yield this.graphAuthTokenCallback()).accessToken,n=c(e),o=yield fetch(n,{method:"GET",headers:{Authorization:`Bearer ${t}`}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const r=yield o.json();return Promise.resolve({fileName:r.name,fileUrl:e})}catch(e){throw u.error("Error unfurling URL:",e),e}}))}}var p=n(93880),h=n(58399),g=n(30136),f=n(58651);const m=(e,t,n)=>{const o=y(e),r=(0,p.s)(o),i=(0,g.W)(r.entity,r.annotation,void 0,r.rawEntityData);v(n,t,o,i),C(n,t,i)},y=e=>({url:e.fileUrl,file:e.fileName,fileExtension:(0,h.Q)(e.fileName)}),v=(e,t,n,o)=>{var r,i,a;null===(a=null===(i=null===(r=null==e?void 0:e.inputContext)||void 0===r?void 0:r.entityRef)||void 0===i?void 0:i.current)||void 0===a||a.updateChatInputEntityProps((e=>{var n;return(null===(n=e.data)||void 0===n?void 0:n.entity.id)==t}),{text:n.file,entityProps:o.entityProps,data:o.data})},C=(e,t,n)=>{var o;null===(o=null==e?void 0:e.attachmentContext)||void 0===o||o.setAttachments((e=>e.map((e=>{var o,r;return(null===(o=e.data.entityElement)||void 0===o?void 0:o.id)===t?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{entityElement:null===(r=n.data)||void 0===r?void 0:r.entity})}):e}))))},b=/((https?|ftp|file):\/\/|www\.)[^\s/$.?#].[^\s]*/gi,E=e=>{const t=(0,r.Ay)();return o.useCallback((n=>{var o;if(e.graphAuthTokenCallback){const r=null===(o=n.clipboardData)||void 0===o?void 0:o.getData("text");if(!r||!r.match(b))return{handled:!1};const s=(0,a.p)(r,{allowedTags:[]});(0,i.d)(s).map((n=>{if("string"==typeof n)return{type:"text",value:n};((e,t,n)=>{const o=new d;o.initialize(t.graphAuthTokenCallback),o.unfurlUrl(e).then((t=>{m(t,e,n)})).catch((e=>{f.error(e)}))})(n.url,e,t)}))}return{handled:!1}}),[e.graphAuthTokenCallback])}},62785:(e,t,n)=>{n.d(t,{K:()=>l});var o=n(8520),r=n(84161),i=n(93880),a=n(30136),s=n(59707);const l=e=>o.useCallback((t=>{var n,o;const l=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text");if(!l)return{handled:!1};const c=(0,s.p)(l,{allowedTags:[]});let u=0,d=0;const p=(0,r.d)(c).map((e=>{if("string"==typeof e)return{type:"text",value:e};const t=(0,i.s)(e),n=(0,a.W)(t.entity,t.annotation,void 0,t.rawEntityData);return t.entity.text!==t.entity.id&&d++,u++,{type:"entity",value:n}}));return null===(o=e.onComplete)||void 0===o||o.call(e,u,d),u>0?{handled:!0,transformedParts:p}:{handled:!1}}),[e])},93880:(e,t,n)=>{n.d(t,{s:()=>i});var o=n(85004),r=n(35945);function i(e,t){const n=e.url,i=e.file;return{entity:{entityType:"FileUrl",id:e.url,text:null!=i?i:n,url:n,fileExtension:e.fileExtension,originalText:i&&n!==i?n:void 0},annotation:t?{queryAnnotationType:o.in.FileUrl,id:n,text:n}:{queryAnnotationType:o.in.FileUrl,id:n},rawEntityData:{type:"File",data:{id:n,referenceId:"",fileName:null!=i?i:n,accessUrl:n,spoId:n,spWebUrl:n,fileExtension:e.fileExtension,attachmentSource:r.H.Pasted}}}}},58399:(e,t,n)=>{n.d(t,{Q:()=>o});const o=e=>{const t=new RegExp("(?:\\.([^.]+))?$").exec(e),n=t&&t[1];return null==n?void 0:n.toLowerCase()}},29828:(e,t,n)=>{n.d(t,{J:()=>o});const o=e=>e.endsWith(".sharepoint.com")||e.endsWith(".sharepoint-df.com")},30136:(e,t,n)=>{n.d(t,{W:()=>o});const o=(e,t,n,o)=>({text:e.text,entityProps:{className:null!=n?n:"",text:Object.assign(Object.assign({as:"a"},e.url?{href:e.url,target:"_blank",rel:"noopener"}:{}),{"data-entity-id":e.id,"data-entity-type":e.entityType})},data:{entity:e,annotation:t,rawEntityData:o}})},84161:(e,t,n)=>{n.d(t,{d:()=>v});var o=n(29828);const r="personal",i="share-point",a={leadingAndTrailingSlashesRegex:/(^\/|\/$)/g,oneDriveFile:`.*/${"personal"}/[^/]*/`,sharePointFile:`.*/(${"teams"}|sites)/[^/]*/`,trailingSlashRegex:/\/$/,oneNoteTargetRegex:/target\((.*)\/\)/,oneNoteSectionRegex:/(.*).one\|/,title:/^[^\\/:*?"<>|#%\t]*$/,shareLink:/\/:\w:\/\w\//},s=new RegExp(a.oneDriveFile),l=new RegExp(a.sharePointFile);var c=n(58399);const u=new RegExp(a.oneDriveFile),d=new RegExp(a.sharePointFile),p=e=>u.test(e)&&r||d.test(e)&&i||void 0,h=(e,t=!1)=>{try{return t?decodeURIComponent(e):decodeURI(e)}catch(t){return e}},g=new RegExp(a.oneDriveFile),f=new RegExp(a.sharePointFile),m=e=>{const t=((e,t)=>{if(t){const n=t.replace(a.leadingAndTrailingSlashesRegex,"").split("/");n.pop();const o=n.join("/");return`${new URL(e).origin}/${o}/`}if(l.test(e)){const t=e.match(l);return t?t[0]:null}if(s.test(e)){const t=e.match(s);return t?t[0]:null}if(e){const t=e.split("/"),n=2;if(t.length>=n)return`${t[0]}//${t[n]}/`}return e})(e);if(t){let n;try{n=new URL(e)}catch(e){return}const{hostname:r,searchParams:i}=n;if(f.test(t)||g.test(t)){const t=p(e);let n=h(i.get("sourcedoc")||"",!0)||void 0;n&&(n=n.replace(/(^{)|(}$)/g,""));const o=h(i.get("file")||"",!0)||void 0;return{url:e,file:o,fileExtension:(0,c.Q)(o||""),fileSource:t,sourcedoc:n}}if((0,o.J)(r)&&a.shareLink.test(e))return{url:e}}},y=/(\b(?:https?):\/\/[^\s]+)/gi;function v(e){var t;const n=[],r=null===(t=e.split)||void 0===t?void 0:t.call(e,y);return null==r||r.forEach((e=>{if(!y.test(e))return void n.push(e);const t=new URL(e).hostname;if((0,o.J)(t)){const t=m(e);t&&n.push(t)}else n.push(e)})),n}},59707:(e,t,n)=>{n.d(t,{p:()=>r});var o=n(8235);const r=(e,t)=>(0,o.sanitize)(e,Object.assign({},(null==t?void 0:t.allowedTags)?{ALLOWED_TAGS:null==t?void 0:t.allowedTags}:{}))},32662:(e,t,n)=>{n.d(t,{P:()=>l});var o=n(79490),r=n(6795);const i={doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",txt:"text/plain",csv:"text/csv",pdf:"application/pdf",rtf:"application/rtf"};function a(e,t,n){const{pageLoaded:o}=n;switch(e.type){case"command":s(e,"acknowledge",t),function(e,t,n,o){const{pick:r,close:i,authenticate:a}=o;switch(e.command){case"pick":r(e).then((()=>{s(t,"result",n,{result:"success"})}),(e=>{s(t,"result",n,{result:"error",error:{code:"filePickerCloseError",message:e.message},isExpected:!1})}));break;case"close":i(e).then((()=>{s(t,"result",n,{result:"success"})}),(e=>{s(t,"result",n,{result:"error",error:{code:"filePickerCloseError",message:e.message},isExpected:!1})}));break;case"authenticate":null==a||a(e).then((e=>{s(t,"result",n,e)}),(e=>{s(t,"result",n,{result:"error",error:{code:"noTokenObtained",message:e.message},isExpected:!1})}));break;default:s(t,"result",n,{result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}}(e.data,e,t,n);break;case"notification":!function(e,t){if("page-loaded"===e.notification)t(e)}(e.data,o)}}const s=(e,t,n,o)=>{n&&n.postMessage(Object.assign({type:t,id:e.id},"result"===t&&{data:o}))};class l{constructor(e,t,n,o="en-US",i="default",a={}){this.graphTokenProvider=e,this.sharepointTokenProvider=t,this.appName=n,this.locale=o,this.theme=i,this.supportedFileExtensionMimeMap=a,this.channelId="",this.channelId=(0,r.A)()}getODBWebUrl(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const{accessToken:e}=yield this.graphTokenProvider(),t=yield fetch("https://graph.microsoft.com/v1.0/me/drive/root?$select=webUrl",{method:"GET",headers:{Authorization:"Bearer "+e}}),n=yield t.json();return new URL(n.webUrl).origin}))}getIframeUrl(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const e=this.appName,t=yield this.getODBWebUrl(),n=function(e={}){const t=0===Object.keys(e).length?i:e;return Object.keys(t).map((e=>`.${e}`))}(this.supportedFileExtensionMimeMap),o={sdk:"8.0",messaging:{channelId:this.channelId,origin:location.origin,identifyParent:!0},theme:this.theme,entry:{oneDrive:{recent:{}}},selection:{mode:"multiple"},typesAndSources:{filters:["folder",...n]},accessibility:{showFocusOnLoad:!1,enableFocusTrap:!0},authentication:{claimsChallenge:{enabled:!0}},commands:{createFolder:{enabled:!1},upload:{enabled:!1}}},r={app:e,scenario:"AttachCloudFilesInCIQ",filePicker:JSON.stringify(o),locale:this.locale};return`${t}/_layouts/15/FilePicker.aspx?${new URLSearchParams(r)}`}))}initializePicker(e,t){return(0,o.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getIframeUrl(),o=new URL(n).origin,r=o,{accessToken:i}=yield this.sharepointTokenProvider(r),a=e.document.createElement("form");e.document.body.appendChild(a);const s=e.document.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","access_token"),s.setAttribute("value",i),a.appendChild(s),a.setAttribute("action",n),a.setAttribute("method","POST"),a.submit();const l=this.updateMessageCommands(t);return this.initializeMessageListener(e,o,l)}))}updateMessageCommands(e){return Object.assign(Object.assign({},e),{authenticate:e=>(0,o.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.sharepointTokenProvider(e.resource)).accessToken;return t?{result:"token",token:t}:{result:"error",isExpected:!0,error:{code:"NoTokenObtained",message:"Could not obtain a token for resource."}}}))})}initializeMessageListener(e,t,n){let o;const r=this.channelId,i=t=>{this.windowListener(t,o,e,n)};o=window.setInterval((()=>{e.postMessage({type:"identify-parent",channelId:r},t)}),100),window.addEventListener("message",i);return()=>{o&&(clearInterval(o),o=void 0),window.removeEventListener("message",i)}}windowListener(e,t,n,o){if(e.source&&e.source===n){const n=e.data;if("initialize"===n.type&&n.channelId===this.channelId){t&&(clearInterval(t),t=void 0);const n=e.ports[0];n.addEventListener("message",(e=>{a(e.data,n,o)})),n.start(),n.postMessage({type:"activate"})}}}}},41197:(e,t,n)=>{var o;n.d(t,{J:()=>o}),function(e){e[e.entity=0]="entity",e[e.image=1]="image"}(o||(o={}))},35945:(e,t,n)=>{n.d(t,{H:()=>o});var o;n(8520);!function(e){e.ECC="ECC",e.Pasted="PastedURL",e.CloudFile="CloudFile",e.PromptGuide="PromptGuide",e.EntityPrompts="EntityPrompts",e.CatchUp="CatchUp",e.LocalFile="LocalFile",e.DragAndDrop="DragAndDrop",e.CopyPaste="CopyPaste",e.CarriedOver="CarriedOver"}(o||(o={}))},69290:(e,t,n)=>{var o;n.d(t,{b:()=>o}),function(e){e.GPT="GPT",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.OpenAIPlugin="OpenAIPlugin"}(o||(o={}))},85004:(e,t,n)=>{var o,r,i,a;n.d(t,{KD:()=>i,SV:()=>a,in:()=>o}),function(e){e.File="File",e.FileUrl="FileUrl",e.People="People",e.Event="Event",e.Chat="Chat",e.Message="Message",e.Topic="Topic",e.Image="Image"}(o||(o={})),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(r||(r={})),function(e){e.AfterDeletion="AfterDeletion",e.AttachButton="Attach",e.AttachmentHint="AttachmentHint",e.PromptGuide="PromptGuide",e.EntityClicked="EntityClicked",e.EntityPrompts="EntityPrompts",e.PromptAutosuggest="PromptAutosuggest"}(i||(i={})),function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(a||(a={}))},54686:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleOdbUploadTask=void 0;var o=n(79490),r=n(65302),i=n(43252);function a(e){var t;if(!(e.id&&e.name&&(null===(t=e.parentReference)||void 0===t?void 0:t.driveId)&&e.webUrl))throw new Error("Invalid response body for finished upload session");return{itemId:e.id,name:e.name,parentDriveId:e.parentReference.driveId,webUrl:e.webUrl,spoId:(0,i.convertFromGraphIdsToSpoId)(e.id,e.parentReference.driveId)}}t.SimpleOdbUploadTask=class{constructor(e,t,{onProgress:n,onComplete:o,onError:r},i){this.alreadyUploadedBytes=0,this.nextRange={minValue:0},this.isInProgress=!1,this.isCancelled=!1,this.getSlice=({minValue:e,maxValue:t})=>this.file.slice(e,(null!=t?t:this.file.size)+1),this.getChunkSize=()=>{const e=8192e3;if(this.file.size>e){const t=this.file.size/4;return Math.min(t-t%320,e)}{const e=this.file.size/2;return Math.max(e-e%320,983040)}},this.uploadUrl=e,this.file=t,this.onProgress=n,this.onComplete=o,this.onError=r,this.chunkSize=this.getChunkSize(),this.shouldAddPregenHeader=!!i}upload(){return(0,o.__awaiter)(this,void 0,void 0,(function*(){var e,t,n,o;if(this.isInProgress)throw new Error("Upload is already in progress");for(this.isInProgress=!0;!this.isCancelled;){null===(e=this.onProgress)||void 0===e||e.call(this,this.alreadyUploadedBytes,this.file.size);const i=this.getNextRange(),s=this.getSlice(i),l=yield fetch(this.uploadUrl,{method:"PUT",headers:Object.assign({"Content-Length":`${s.size}`,"Content-Range":`bytes ${i.minValue}-${i.maxValue}/${this.file.size}`},this.shouldAddPregenHeader&&{Prefer:r.PREFER_HEADER_FOR_PREGEN}),body:s});this.alreadyUploadedBytes+=s.size,this.alreadyUploadedBytes===this.file.size?null===(t=this.onComplete)||void 0===t||t.call(this):null===(n=this.onProgress)||void 0===n||n.call(this,this.alreadyUploadedBytes,this.file.size);const c=yield l.json();if(200===l.status||201===l.status){const e=c;return this.isInProgress=!1,a(e)}if(202!==l.status){if(404===l.status&&this.isCancelled)return;throw this.isInProgress=!1,null===(o=this.onError)||void 0===o||o.call(this,l),new Error(`Upload failed with status ${l.status}, task.isCanceled: ${this.isCancelled}`)}{const e=c;this.nextRange=this.parseRange(e.nextExpectedRanges)}}}))}resume(){return this.isCancelled=!1,this.isInProgress=!1,this.upload()}cancel(){this.isCancelled=!0,this.isInProgress=!1,fetch(this.uploadUrl,{method:"DELETE"})}get sessionIsCancelled(){return this.isCancelled}parseRange(e){const t=e[0];if(void 0===t||""===t)throw new Error("Range is not present");const n=t.split("-"),o=parseInt(n[0],10);let r=parseInt(n[1],10);return Number.isNaN(r)&&(r=this.file.size-1),{minValue:o,maxValue:r}}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.chunkSize-1;return t>=this.file.size&&(t=this.file.size-1),{minValue:e,maxValue:t}}}},65302:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PREFER_HEADER_FOR_PREGEN=t.FileClientFeature=void 0;t.FileClientFeature="BizChatFile",t.PREFER_HEADER_FOR_PREGEN="ExtractTextOnCommit"},94388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserWithoutOdb=void 0;class n extends Error{}t.UserWithoutOdb=n},65981:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n={fragment:{argumentDefinitions:o=[{defaultValue:null,kind:"LocalArgument",name:"itemId"}],kind:"Fragment",metadata:null,name:"useContentExtractionWarmupMutation",selections:r=[{alias:null,args:[{fields:[{kind:"Variable",name:"itemId",variableName:"itemId"}],kind:"ObjectValue",name:"input"}],concreteType:"UserOneDriveContentExtractionWarmupPayload",kind:"LinkedField",name:"userOneDriveContentExtractionWarmup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"contentExtractionTriggered",storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:o,kind:"Operation",name:"useContentExtractionWarmupMutation",selections:r},params:{cacheID:"f58329511f3a6d722b344ea7f0e0d93d",id:null,metadata:{},name:"useContentExtractionWarmupMutation",operationKind:"mutation",text:"mutation useContentExtractionWarmupMutation(\n  $itemId: String!\n) {\n  userOneDriveContentExtractionWarmup(input: {itemId: $itemId}) {\n    contentExtractionTriggered\n  }\n}\n"}};var o,r;n.hash="c70df4363367703f54a64551524466de";t.default=n},33550:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n={fragment:{argumentDefinitions:o=[{defaultValue:null,kind:"LocalArgument",name:"itemId"}],kind:"Fragment",metadata:null,name:"useLokiFileRemoveMutation",selections:r=[{alias:null,args:[{fields:[{kind:"Variable",name:"itemId",variableName:"itemId"}],kind:"ObjectValue",name:"input"}],concreteType:"UserOneDriveFileRemovePayload",kind:"LinkedField",name:"userOneDriveFileRemove",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"didRemove",storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:o,kind:"Operation",name:"useLokiFileRemoveMutation",selections:r},params:{cacheID:"5684d1c5c69c4951f1d53f254b79357b",id:null,metadata:{},name:"useLokiFileRemoveMutation",operationKind:"mutation",text:"mutation useLokiFileRemoveMutation(\n  $itemId: String!\n) {\n  userOneDriveFileRemove(input: {itemId: $itemId}) {\n    didRemove\n  }\n}\n"}};var o,r;n.hash="70718323a29bbb3f76424f8fee567bd5";t.default=n},73943:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n={fragment:{argumentDefinitions:o=[{defaultValue:null,kind:"LocalArgument",name:"newfilename"}],kind:"Fragment",metadata:null,name:"useLokiFileUploadMutation",selections:[{alias:null,args:r=[{fields:[{kind:"Variable",name:"fileName",variableName:"newfilename"}],kind:"ObjectValue",name:"input"}],concreteType:"UserOneDriveCopilotUploadSessionCreatePayload",kind:"LinkedField",name:"userOneDriveCopilotUploadSessionCreate",plural:!1,selections:[i={alias:null,args:null,concreteType:"UploadSessionCreationPayload",kind:"LinkedField",name:"uploadSessionCreationPayload",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uploadUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"nextExpectedRanges",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expirationDateTime",storageKey:null},{alias:null,args:null,concreteType:"File",kind:"LinkedField",name:"duplicate",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"filename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"webUrl",storageKey:null},{alias:null,args:null,concreteType:"OneDriveItemInfo",kind:"LinkedField",name:"oneDriveItemInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"itemId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driveId",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"errors",plural:!0,selections:[a={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"UserWithoutOdbError",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:o,kind:"Operation",name:"useLokiFileUploadMutation",selections:[{alias:null,args:r,concreteType:"UserOneDriveCopilotUploadSessionCreatePayload",kind:"LinkedField",name:"userOneDriveCopilotUploadSessionCreate",plural:!1,selections:[i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"errors",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a],storageKey:null}],storageKey:null}]},params:{cacheID:"c301668f49d08fb26f403f1924191d51",id:null,metadata:{},name:"useLokiFileUploadMutation",operationKind:"mutation",text:"mutation useLokiFileUploadMutation(\n  $newfilename: String!\n) {\n  userOneDriveCopilotUploadSessionCreate(input: {fileName: $newfilename}) {\n    uploadSessionCreationPayload {\n      uploadUrl\n      nextExpectedRanges\n      expirationDateTime\n      duplicate {\n        id\n        filename\n        webUrl\n        oneDriveItemInfo {\n          itemId\n          driveId\n        }\n      }\n    }\n    errors {\n      __typename\n      ... on UserWithoutOdbError {\n        message\n      }\n    }\n  }\n}\n"}};var o,r,i,a;n.hash="72f59a57aa0e6c4103d8d836ef64fc8c";t.default=n},39482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n={fragment:{argumentDefinitions:o=[{defaultValue:null,kind:"LocalArgument",name:"shouldIssueQuery"}],kind:"Fragment",metadata:null,name:"usePrefetchCopilotUploadsDirectoryQuery",selections:[{condition:"shouldIssueQuery",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useUserOneDriveFragment"}],storageKey:null}]}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:o,kind:"Operation",name:"usePrefetchCopilotUploadsDirectoryQuery",selections:[{condition:"shouldIssueQuery",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"userOneDrive",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Directory",kind:"LinkedField",name:"copilotUploadsDirectory",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"webUrl",storageKey:null}],storageKey:null}],type:"OneDrive",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"errorMessage",args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"UserWithoutOdbError",abstractKey:null}],storageKey:null}],storageKey:null}]}]},params:{cacheID:"9003f5db4600f3df03927701fccef2e4",id:null,metadata:{},name:"usePrefetchCopilotUploadsDirectoryQuery",operationKind:"query",text:"query usePrefetchCopilotUploadsDirectoryQuery(\n  $shouldIssueQuery: Boolean!\n) {\n  viewer @include(if: $shouldIssueQuery) {\n    ...useUserOneDriveFragment\n  }\n}\n\nfragment useUserOneDriveFragment on Viewer {\n  userOneDrive {\n    __typename\n    ... on OneDrive {\n      copilotUploadsDirectory {\n        webUrl\n      }\n    }\n    ... on UserWithoutOdbError {\n      errorMessage: message\n    }\n  }\n}\n"}};var o;n.hash="ff883da2476cb7443032df86529517b1";t.default=n},32093:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useUserOneDriveFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"userOneDrive",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Directory",kind:"LinkedField",name:"copilotUploadsDirectory",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"webUrl",storageKey:null}],storageKey:null}],type:"OneDrive",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"errorMessage",args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"UserWithoutOdbError",abstractKey:null}],storageKey:null}],type:"Viewer",abstractKey:null,hash:"a08ad007471f1d1c6859f264b89d5442"};t.default=n},4607:(e,t,n)=>{var o=n(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.useContentExtractionWarmup=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,n&&n.set(e,o),o}(n(8520)),a=n(8616),s=n(45631);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}t.useContentExtractionWarmup=()=>{const[e]=(0,a.useMutation)((void 0!==r||(r=n(65981)).hash&&"c70df4363367703f54a64551524466de"!==r.hash&&o.error("The definition of 'useContentExtractionWarmupMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),s.commitFunctionFileClientFeature);return{warmupContentExtraction:i.useCallback((t=>new Promise((n=>{e({variables:{itemId:t},onCompleted:e=>{n()}})}))),[e])}}},41396:(e,t,n)=>{var o=n(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.useLokiFileRemove=void 0;var r,i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,n&&n.set(e,o),o}(n(8520)),a=n(8616),s=n(45631);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}t.useLokiFileRemove=()=>{const[e]=(0,a.useMutation)((void 0!==r||(r=n(33550)).hash&&"70718323a29bbb3f76424f8fee567bd5"!==r.hash&&o.error("The definition of 'useLokiFileRemoveMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),s.commitFunctionFileClientFeature);return{removeFile:i.useCallback((t=>new Promise((n=>{e({variables:{itemId:t},onCompleted:e=>{n()}})}))),[e])}}},76097:(e,t,n)=>{var o=n(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.useLokiFileUpload=void 0;var r,i=n(79490),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var o={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=r?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(o,i,a):o[i]=e[i]}return o.default=e,n&&n.set(e,o),o}(n(8520)),s=n(8616),l=n(54686),c=n(94388),u=n(45631),d=n(4607),p=n(41396);function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}t.useLokiFileUpload=e=>{const[t]=(0,s.useMutation)((void 0!==r||(r=n(73943)).hash&&"72f59a57aa0e6c4103d8d836ef64fc8c"!==r.hash&&o.error("The definition of 'useLokiFileUploadMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),u.commitFunctionFileClientFeature),{removeFile:h}=(0,p.useLokiFileRemove)(),{warmupContentExtraction:g}=(0,d.useContentExtractionWarmup)(),f=a.useCallback(((n,o)=>(0,i.__awaiter)(void 0,[n,o],void 0,(function*(n,{uploadHandlers:o,setUploadTask:r,ondDuplicateFile:a,setFirstChunkPerformanceMark:s,warmupCallLog:u}){return new Promise(((e,o)=>{t({variables:{newfilename:n.name},onCompleted:e,onError:o})})).then((t=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){var i,d,p,f,m,y,v,C;const b=null===(i=t.userOneDriveCopilotUploadSessionCreate)||void 0===i?void 0:i.uploadSessionCreationPayload,E=null===(d=t.userOneDriveCopilotUploadSessionCreate)||void 0===d?void 0:d.errors;if((null==E?void 0:E.length)&&E.length>0)throw new c.UserWithoutOdb(E[0].message);if(!b)throw new Error("Upload session creation failed unexpectedly");const A=new l.SimpleOdbUploadTask(b.uploadUrl,n,o,e);null==s||s();const S=A.upload();null==r||r(A);const I=b.duplicate,P=yield S;return A.sessionIsCancelled&&P&&h(P.itemId),!e&&(null==P?void 0:P.itemId)&&(g(P.itemId),null==u||u()),I&&P&&(null==a||a(P.name,P.itemId,null!==(f=null===(p=null==I?void 0:I.oneDriveItemInfo)||void 0===p?void 0:p.itemId)&&void 0!==f?f:"",null!==(m=null==I?void 0:I.filename)&&void 0!==m?m:"",null!==(y=null==I?void 0:I.webUrl)&&void 0!==y?y:"",null!==(C=null===(v=null==I?void 0:I.oneDriveItemInfo)||void 0===v?void 0:v.driveId)&&void 0!==C?C:"")),P}))))}))),[t,h,e,g]),m=a.useCallback(((e,t,n)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return e.resume().catch((()=>f(t,n)))}))),[f]);return{uploadFile:f,retryUpload:m}}},31343:(e,t,n)=>{var o=n(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.usePrefetchCopilotUploadsDirectoryQuery=t.usePrefetchCopilotUploadsDirectory=void 0;var r,i=n(8520),a=n(50016),s=n(65302);const l=t.usePrefetchCopilotUploadsDirectoryQuery=(void 0!==r||(r=n(39482)).hash&&"ff883da2476cb7443032df86529517b1"!==r.hash&&o.error("The definition of 'usePrefetchCopilotUploadsDirectoryQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);t.usePrefetchCopilotUploadsDirectory=e=>{const[t,n]=(0,a.useQueryLoader)(l);return(0,i.useEffect)((()=>{t||n({shouldIssueQuery:e},{networkCacheConfig:{metadata:{clientFeature:s.FileClientFeature}}})}),[n,t,e]),t}},6e4:(e,t,n)=>{var o=n(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.useUserOneDrive=void 0;var r,i=n(50016);t.useUserOneDrive=e=>{var t;const a=(0,i.useFragment)((void 0!==r||(r=n(32093)).hash&&"a08ad007471f1d1c6859f264b89d5442"!==r.hash&&o.error("The definition of 'useUserOneDriveFragment' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),e);return(null==a?void 0:a.userOneDrive.errorMessage)||!(null===(t=null==a?void 0:a.userOneDrive.copilotUploadsDirectory)||void 0===t?void 0:t.webUrl)?{isOdbEnabled:!1}:{isOdbEnabled:!0,copilotUploadsWebUrl:a.userOneDrive.copilotUploadsDirectory.webUrl}}},38451:(e,t,n)=>{Object.defineProperty(t,"WG",{enumerable:!0,get:function(){return d.convertFromGraphIdsToSpoId}}),Object.defineProperty(t,"vU",{enumerable:!0,get:function(){return a.useLokiFileRemove}}),Object.defineProperty(t,"iv",{enumerable:!0,get:function(){return s.useLokiFileUpload}}),Object.defineProperty(t,"ox",{enumerable:!0,get:function(){return l.usePrefetchCopilotUploadsDirectoryQuery}}),Object.defineProperty(t,"Zt",{enumerable:!0,get:function(){return c.useUserOneDrive}});var o,r=n(65302),i=(o=n(39482))&&o.__esModule?o:{default:o},a=n(41396),s=n(76097),l=n(31343),c=n(6e4),u=n(45631),d=n(43252)},45631:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.commitFunctionFileClientFeature=function(e,t){return(0,o.commitMutation)(e,Object.assign(Object.assign({},t),{cacheConfig:{metadata:{clientFeature:r.FileClientFeature}}}))};var o=n(69471),r=n(65302)},43252:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bytesToUuid=i,t.convertFromGraphIdsToSpoId=function(e,t){try{const{siteId:n,webId:i,listId:a}=r(t),s=function(e,t,n){const r=[e,t,n],i=r.join(",");return function(e){let t=(0,o.fromByteArray)(e);return t=t.split("=")[0],t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_"),t}((new TextEncoder).encode(i))}(n,i,a);return`SPO_${s}_${e}`}catch(e){return""}},t.decodeDriveIdV2=r;var o=n(76411);function r(e){const t=function(e){const t=e.padEnd(4*Math.ceil(e.length/4),"=").replace(/_/g,"/").replace(/-/g,"+");return(0,o.toByteArray)(t)}(e.slice(2)),n=t.slice(0,16),r=t.slice(16,32),a=t.slice(32,48);return{siteId:i(n),webId:i(r),listId:i(a)}}function i(e){if(16!==e.length)throw new Error("Guid must be 16 bytes long");return[e.subarray(0,4).reverse(),e.subarray(4,6).reverse(),e.subarray(6,8).reverse(),e.subarray(8,10),e.subarray(10,16)].map((e=>Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join(""))).join("-")}},97390:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(50709),r=n.n(o),i=n(28354),a=n.n(i)()(r());a.push([e.id,"svg>path.OfficeIconColors_m20 {\n    fill: #FAFAFAFF;\n}\nsvg>path.OfficeIconColors_m21 {\n    fill: #C8C6C4FF;\n}\nsvg>path.OfficeIconColors_m22 {\n    fill: #3A3A38FF;\n}\nsvg>path.OfficeIconColors_m23 {\n    fill: #797774FF;\n}\nsvg>path.OfficeIconColors_m24 {\n    fill: #1E8BCDFF;\n}\nsvg>path.OfficeIconColors_m25 {\n    fill: #0063B1FF;\n}\nsvg>path.OfficeIconColors_m26 {\n    fill: #83BEECFF;\n}\nsvg>path.OfficeIconColors_m27 {\n    fill: #379E4EFF;\n}\nsvg>path.OfficeIconColors_m28 {\n    fill: #309048FF;\n}\nsvg>path.OfficeIconColors_m29 {\n    fill: #A1DDAAFF;\n}\nsvg>path.OfficeIconColors_m210 {\n    fill: #DE6C00FF;\n}\nsvg>path.OfficeIconColors_m211 {\n    fill: #DE6C00FF;\n}\nsvg>path.OfficeIconColors_m212 {\n    fill: #F8DB8FFF;\n}\nsvg>path.OfficeIconColors_m213 {\n    fill: #ED3D3BFF;\n}\nsvg>path.OfficeIconColors_m214 {\n    fill: #D42314FF;\n}\nsvg>path.OfficeIconColors_m215 {\n    fill: #FF9198FF;\n}\nsvg>path.OfficeIconColors_m216 {\n    fill: #FF672DFF;\n}\nsvg>path.OfficeIconColors_m217 {\n    fill: #E84B12FF;\n}\nsvg>path.OfficeIconColors_m218 {\n    fill: #FFB255FF;\n}\nsvg>path.OfficeIconColors_m219 {\n    fill: #A846B2FF;\n}\nsvg>path.OfficeIconColors_m220 {\n    fill: #922E9BFF;\n}\nsvg>path.OfficeIconColors_m221 {\n    fill: #D492D8FF;\n}\nsvg>path.OfficeIconColors_m222 {\n    fill: #FFFFFF66;\n}\nsvg>path.OfficeIconColors_m223 {\n    fill: #DCEDFA;\n}\nsvg>path.OfficeIconColors_m224 {\n    fill: #0063B1FF;\n}\nsvg>path.OfficeIconColors_m225 {\n    fill: #EADECCFF;\n}\nsvg>path.OfficeIconColors_m226 {\n    fill: #705F53FF;\n}\nsvg>path.OfficeIconColors_m227 {\n    fill: #FFFFFFFF;\n}\nsvg>path.OfficeIconColors_m228 {\n    fill: #007EE5FF;\n}\nsvg>path.OfficeIconColors_m229 {\n    fill: #D83B01FF;\n}\nsvg>path.OfficeIconColors_m230 {\n    fill: #0849B1FF;\n}\nsvg>path.OfficeIconColors_m231 {\n    fill: #0078D7FF;\n}\nsvg>path.OfficeIconColors_m232 {\n    fill: #7DA3C6FF;\n}\nsvg>path.OfficeIconColors_m233 {\n    fill: #2B579AFF;\n}\nsvg>path.OfficeIconColors_m234 {\n    fill: #B7472AFF;\n}\nsvg>path.OfficeIconColors_m235 {\n    fill: #ED9583FF;\n}\nsvg>path.OfficeIconColors_m236 {\n    fill: #217346FF;\n}\nsvg>path.OfficeIconColors_m237 {\n    fill: #6EB38AFF;\n}\nsvg>path.OfficeIconColors_m238 {\n    fill: #7719AAFF;\n}\nsvg>path.OfficeIconColors_m239 {\n    fill: #DDC5ECFF;\n}\nsvg>path.OfficeIconColors_m240 {\n    fill: #FF0000FF;\n}\nsvg>path.OfficeIconColors_m241 {\n    fill: #FFFF00FF;\n}\nsvg>path.OfficeIconColors_m242 {\n    fill: #00FF00FF;\n}\nsvg>path.OfficeIconColors_m243 {\n    fill: #00FFFFFF;\n}\nsvg>path.OfficeIconColors_m244 {\n    fill: #FF0000FF;\n}\nsvg>path.OfficeIconColors_m245 {\n    fill: #FF8000FF;\n}\nsvg>path.OfficeIconColors_m246 {\n    fill: #57D200FF;\n}\nsvg>path.OfficeIconColors_m247 {\n    fill: #3165BBFF;\n}\nsvg>path.OfficeIconColors_m248 {\n    fill: #969696FF;\n}\nsvg>path.OfficeIconColors_m249 {\n    fill: #797979FF;\n}\nsvg>path.OfficeIconColors_m250 {\n    fill: #B3B3B3FF;\n}\nsvg>path.OfficeIconColors_m251 {\n    fill: #FF00FFFF;\n}\nsvg>path.OfficeIconColors_m252 {\n    fill: #000000FF;\n}\nsvg>path.OfficeIconColors_m253 {\n    fill: #9FCDB3FF;\n}\nsvg>path.OfficeIconColors_m254 {\n    fill: #028484FF;\n}\nsvg>path.OfficeIconColors_m255 {\n    fill: #3B5998FF;\n}\nsvg>path.OfficeIconColors_m256 {\n    fill: #1DA1F2FF;\n}\nsvg>path.OfficeIconColors_m257 {\n    fill: #DD4B39FF;\n}\nsvg>path.OfficeIconColors_m258 {\n    fill: #35465DFF;\n}\nsvg>path.OfficeIconColors_m259 {\n    fill: #464342FF;\n}\nsvg>path.OfficeIconColors_m260 {\n    fill: #BD081CFF;\n}\nsvg>path.OfficeIconColors_m261 {\n    fill: #0077B5FF;\n}\nsvg>path.OfficeIconColors_m262 {\n    fill: #FF4500FF;\n}\nsvg>path.OfficeIconColors_m263 {\n    fill: #008372FF;\n}\nsvg>path.OfficeIconColors_m264 {\n    fill: #0078D7FF;\n}\nsvg>path.OfficeIconColors_m265 {\n    fill: #0063DBFF;\n}\nsvg>path.OfficeIconColors_m266 {\n    fill: #FF0084FF;\n}\nsvg>path.OfficeIconColors_m267 {\n    fill: #CD201FFF;\n}\nsvg>path.OfficeIconColors_m268 {\n    fill: #FF00AAFF;\n}\nsvg>path.OfficeIconColors_m269 {\n    fill: #F57D00FF;\n}\nsvg>path.OfficeIconColors_m270 {\n    fill: #00BF00FF;\n}\nsvg>path.OfficeIconColors_m271 {\n    fill: #E6E6E6FF;\n}\nsvg>path.OfficeIconColors_m272 {\n    fill: #5A5A5AFF;\n}\nsvg>path.OfficeIconColors_m273 {\n    fill: #F4840BFF;\n}\nsvg>path.OfficeIconColors_m274 {\n    fill: #FF1600FF;\n}\nsvg>path.OfficeIconColors_m275 {\n    fill: #933DC1FF;\n}\nsvg>path.OfficeIconColors_m276 {\n    fill: #00BFFFFF;\n}\nsvg>path.OfficeIconColors_m277 {\n    fill: #B5D82AFF;\n}\nsvg>path.OfficeIconColors_m278 {\n    fill: #F2D80DFF;\n}\nsvg>path.OfficeIconColors_m279 {\n    fill: #D40078FF;\n}\nsvg>path.OfficeIconColors_m280 {\n    fill: #FABD14FF;\n}\nsvg>path.OfficeIconColors_m281 {\n    fill: #0F893EFF;\n}\nsvg>path.OfficeIconColors_m282 {\n    fill: #004E8CFF;\n}\nsvg>path.OfficeIconColors_m283 {\n    fill: #AC008CFF;\n}\nsvg>path.OfficeIconColors_m284 {\n    fill: #F7630DFF;\n}\nsvg>path.OfficeIconColors_m285 {\n    fill: #E81123FF;\n}\nsvg>path.OfficeIconColors_m286 {\n    fill: #00B6C1FF;\n}\nsvg>path.OfficeIconColors_m287 {\n    fill: #0063AFFF;\n}\nsvg>path.OfficeIconColors_m288 {\n    fill: #5B2D90FF;\n}\nsvg>path.OfficeIconColors_m289 {\n    fill: #C6A477FF;\n}\nsvg>path.OfficeIconColors_m290 {\n    fill: #7EC500FF;\n}\nsvg>path.OfficeIconColors_m291 {\n    fill: #00AC56FF;\n}\nsvg>path.OfficeIconColors_m292 {\n    fill: #0099BBFF;\n}\nsvg>path.OfficeIconColors_m293 {\n    fill: #C10051FF;\n}\nsvg>path.OfficeIconColors_m294 {\n    fill: #84939AFF;\n}\nsvg>path.OfficeIconColors_m295 {\n    fill: #106EBEFF;\n}\nsvg>path.OfficeIconColors_m296 {\n    fill: #EE3124FF;\n}\nsvg>path.OfficeIconColors_m297 {\n    fill: #DCEAF5FF;\n}\nsvg>path.OfficeIconColors_m298 {\n    fill: #C6DFF3FF;\n}\nsvg>path.OfficeIconColors_m299 {\n    fill: #B0D4F1FF;\n}\nsvg>path.OfficeIconColors_m2100 {\n    fill: #9AC9EEFF;\n}\nsvg>path.OfficeIconColors_m2101 {\n    fill: #83BEECFF;\n}\nsvg>path.OfficeIconColors_m2102 {\n    fill: #60ACE1FF;\n}\nsvg>path.OfficeIconColors_m2103 {\n    fill: #3D9BD6FF;\n}\nsvg>path.OfficeIconColors_m2104 {\n    fill: #1B86CAFF;\n}\nsvg>path.OfficeIconColors_m2105 {\n    fill: #1A6EBDFF;\n}\nsvg>path.OfficeIconColors_m2106 {\n    fill: #FFFFFFFF;\n}\nsvg>path.OfficeIconColors_m2107 {\n    fill: #00A4FFFF;\n}\nsvg>path.OfficeIconColors_m2108 {\n    fill: #0000007F;\n}\nsvg>path.OfficeIconColors_m2109 {\n    fill: #FFFFFF66;\n}\nsvg>path.OfficeIconColors_m2110 {\n    fill: #FFFFFF4C;\n}\nsvg>path.OfficeIconColors_m2111 {\n    fill: #FFFFFF7F;\n}\nsvg>path.OfficeIconColors_m2112 {\n    fill: #000000FF;\n}\nsvg>path.OfficeIconColors_m2113 {\n    fill: #A4373AFF;\n}\nsvg>path.OfficeIconColors_m2114 {\n    fill: #31752FFF;\n}\nsvg>path.OfficeIconColors_m2115 {\n    fill: #077568FF;\n}\nsvg>path.OfficeIconColors_m2116 {\n    fill: #3955A3FF;\n}\nsvg>path.OfficeIconColors_m2117 {\n    fill: #8EA6DDFF;\n}\nsvg>path.OfficeIconColors_m2118 {\n    fill: #00A1E0FF;\n}\nsvg>path.OfficeIconColors_m2119 {\n    fill: #002050FF;\n}\nsvg>path.OfficeIconColors_m2120 {\n    fill: #FFEF9CFF;\n}\nsvg>path.OfficeIconColors_m2121 {\n    fill: #638AC6FF;\n}\nsvg>path.OfficeIconColors_m2122 {\n    fill: #638AC63F;\n}\nsvg>path.OfficeIconColors_m2123 {\n    fill: #63BE7BFF;\n}\nsvg>path.OfficeIconColors_m2124 {\n    fill: #63BE7B3F;\n}\nsvg>path.OfficeIconColors_m2125 {\n    fill: #FF555AFF;\n}\nsvg>path.OfficeIconColors_m2126 {\n    fill: #FF555A3F;\n}\nsvg>path.OfficeIconColors_m2127 {\n    fill: #FFB628FF;\n}\nsvg>path.OfficeIconColors_m2128 {\n    fill: #008AEFFF;\n}\nsvg>path.OfficeIconColors_m2129 {\n    fill: #D6007BFF;\n}\nsvg>path.OfficeIconColors_m2130 {\n    fill: #ED7D31FF;\n}\nsvg>path.OfficeIconColors_m2131 {\n    fill: #107C10FF;\n}\nsvg>path.OfficeIconColors_m2132 {\n    fill: #C30052FF;\n}\nsvg>path.OfficeIconColors_m2133 {\n    fill: #9C0041FF;\n}\nsvg>path.OfficeIconColors_m2134 {\n    fill: #F7BFA0FF;\n}\nsvg>path.OfficeIconColors_m2135 {\n    fill: #A2D3A0FF;\n}\nsvg>path.OfficeIconColors_m2136 {\n    fill: #9FCDC7FF;\n}\nsvg>path.OfficeIconColors_m2137 {\n    fill: #D492D84C;\n}\nsvg>path.OfficeIconColors_m2138 {\n    fill: #00AECDFF;\n}\nsvg>path.OfficeIconColors_m2139 {\n    fill: #4285F1FF;\n}\nsvg>path.OfficeIconColors_m2140 {\n    fill: #32A651FF;\n}\nsvg>path.OfficeIconColors_m2141 {\n    fill: #FBBE05FF;\n}\nsvg>path.OfficeIconColors_m2142 {\n    fill: #EA4235FF;\n}\nsvg>path.OfficeIconColors_m2143 {\n    fill: #D492D899;\n}\nsvg>path.OfficeIconColors_m2144 {\n    fill: #0182BCFF;\n}\nsvg>path.OfficeIconColors_m2145 {\n    fill: #312F62FF;\n}\nsvg>path.OfficeIconColors_m2146 {\n    fill: #7CBC31FF;\n}\nsvg>path.OfficeIconColors_m2147 {\n    fill: #FAFAFAFF;\n}\nsvg>path.OfficeIconColors_m2148 {\n    fill: #3A3A38FF;\n}\nsvg>path.OfficeIconColors_m2149 {\n    fill: #797774FF;\n}\nsvg>path.OfficeIconColors_m2150 {\n    fill: #F07D88FF;\n}\nsvg>path.OfficeIconColors_m2151 {\n    fill: #55ABE5FF;\n}\nsvg>path.OfficeIconColors_m2152 {\n    fill: #5FBE7DFF;\n}\nsvg>path.OfficeIconColors_m2153 {\n    fill: #B9C0CBFF;\n}\nsvg>path.OfficeIconColors_m2154 {\n    fill: #FF8C00FF;\n}\nsvg>path.OfficeIconColors_m2155 {\n    fill: #33BAB1FF;\n}\nsvg>path.OfficeIconColors_m2156 {\n    fill: #A3B367FF;\n}\nsvg>path.OfficeIconColors_m2157 {\n    fill: #A895E2FF;\n}\nsvg>path.OfficeIconColors_m2158 {\n    fill: #026802FF;\n}\nsvg>path.OfficeIconColors_m2159 {\n    fill: #FFF100FF;\n}\nsvg>path.OfficeIconColors_m2160 {\n    fill: #5558AFFF;\n}\nsvg>path.OfficeIconColors_m2161 {\n    fill: #800080FF;\n}\nsvg>path.OfficeIconColors_m2162 {\n    fill: #FF91983F;\n}\nsvg>path.OfficeIconColors_m2163 {\n    fill: #68217AFF;\n}\nsvg>path.OfficeIconColors_m2164 {\n    fill: #2B2C33FF;\n}\nsvg>path.OfficeIconColors_m2165 {\n    fill: #00A7E9FF;\n}\nsvg>path.OfficeIconColors_m2166 {\n    fill: #00979DFF;\n}\nsvg>path.OfficeIconColors_m2167 {\n    fill: #FBD115FF;\n}\nsvg>path.OfficeIconColors_m2168 {\n    fill: #006BFFFF;\n}\nsvg>path.OfficeIconColors_m2169 {\n    fill: #231840FF;\n}\nsvg>path.OfficeIconColors_m2170 {\n    fill: #9E8BFCFF;\n}\nsvg>path.OfficeIconColors_m2171 {\n    fill: #F3E9FFFF;\n}\nsvg>path.OfficeIconColors_m2172 {\n    fill: #FFFFFF4C;\n}\nsvg>path.OfficeIconColors_m2173 {\n    fill: #3A3A38FF;\n}\nsvg>path.OfficeIconColors_m2174 {\n    fill: #797774FF;\n}\nsvg>path.OfficeIconColors_m2175 {\n    fill: #00000059;\n}\nsvg>path.OfficeIconColors_m2176 {\n    fill: #FFFFFF7F;\n}\nsvg>path.OfficeIconColors_m2177 {\n    fill: #A7DCD5FF;\n}\nsvg>path.OfficeIconColors_m2178 {\n    fill: #329494FF;\n}\nsvg>path.OfficeIconColors_m2179 {\n    fill: #008085FF;\n}\nsvg>path.OfficeIconColors_m2180 {\n    fill: #90E3E3FF;\n}\nsvg>path.OfficeIconColors_m2181 {\n    fill: #FFFFFFFF;\n}\nsvg>path.OfficeIconColors_m2182 {\n    fill: #0000000C;\n}\nsvg>path.OfficeIconColors_m2183 {\n    fill: #00000019;\n}\nsvg>path.OfficeIconColors_m2184 {\n    fill: #00000033;\n}\nsvg>path.OfficeIconColors_m2185 {\n    fill: #0000007F;\n}\nsvg>path.OfficeIconColors_m2186 {\n    fill: #000000C0;\n}\nsvg>path.OfficeIconColors_m2187 {\n    fill: #41A5EEFF;\n}\nsvg>path.OfficeIconColors_m2188 {\n    fill: #2B7CD3FF;\n}\nsvg>path.OfficeIconColors_m2189 {\n    fill: #185ABDFF;\n}\nsvg>path.OfficeIconColors_m2190 {\n    fill: #103F91FF;\n}\nsvg>path.OfficeIconColors_m2191 {\n    fill: #163870FF;\n}\nsvg>path.OfficeIconColors_m2192 {\n    fill: #33C481FF;\n}\nsvg>path.OfficeIconColors_m2193 {\n    fill: #21A366FF;\n}\nsvg>path.OfficeIconColors_m2194 {\n    fill: #107C41FF;\n}\nsvg>path.OfficeIconColors_m2195 {\n    fill: #185C37FF;\n}\nsvg>path.OfficeIconColors_m2196 {\n    fill: #134A2CFF;\n}\nsvg>path.OfficeIconColors_m2197 {\n    fill: #FF8F6BFF;\n}\nsvg>path.OfficeIconColors_m2198 {\n    fill: #ED6C47FF;\n}\nsvg>path.OfficeIconColors_m2199 {\n    fill: #D35230FF;\n}\nsvg>path.OfficeIconColors_m2200 {\n    fill: #C43E1CFF;\n}\nsvg>path.OfficeIconColors_m2201 {\n    fill: #993117FF;\n}\nsvg>path.OfficeIconColors_m2202 {\n    fill: #CA64EAFF;\n}\nsvg>path.OfficeIconColors_m2203 {\n    fill: #AE4BD5FF;\n}\nsvg>path.OfficeIconColors_m2204 {\n    fill: #9332BFFF;\n}\nsvg>path.OfficeIconColors_m2205 {\n    fill: #7719AAFF;\n}\nsvg>path.OfficeIconColors_m2206 {\n    fill: #511575FF;\n}\nsvg>path.OfficeIconColors_m2207 {\n    fill: #50D9FFFF;\n}\nsvg>path.OfficeIconColors_m2208 {\n    fill: #28A8EAFF;\n}\nsvg>path.OfficeIconColors_m2209 {\n    fill: #1490DFFF;\n}\nsvg>path.OfficeIconColors_m2210 {\n    fill: #0078D4FF;\n}\nsvg>path.OfficeIconColors_m2211 {\n    fill: #0364B8FF;\n}\nsvg>path.OfficeIconColors_m2212 {\n    fill: #0358A7FF;\n}\nsvg>path.OfficeIconColors_m2213 {\n    fill: #06509BFF;\n}\nsvg>path.OfficeIconColors_m2214 {\n    fill: #064A8CFF;\n}\nsvg>path.OfficeIconColors_m2215 {\n    fill: #0A2767FF;\n}\nsvg>path.OfficeIconColors_m2216 {\n    fill: #0A27677F;\n}\nsvg>path.OfficeIconColors_m2217 {\n    fill: #7B83EBFF;\n}\nsvg>path.OfficeIconColors_m2218 {\n    fill: #5059C9FF;\n}\nsvg>path.OfficeIconColors_m2219 {\n    fill: #4B53BCFF;\n}\nsvg>path.OfficeIconColors_m2220 {\n    fill: #363A7EFF;\n}\nsvg>path.OfficeIconColors_m2221 {\n    fill: #37C6D0FF;\n}\nsvg>path.OfficeIconColors_m2222 {\n    fill: #1A9BA1FF;\n}\nsvg>path.OfficeIconColors_m2223 {\n    fill: #038387FF;\n}\nsvg>path.OfficeIconColors_m2224 {\n    fill: #036C70FF;\n}\nsvg>path.OfficeIconColors_m2225 {\n    fill: #0E4F51FF;\n}\nsvg>path.OfficeIconColors_m2226 {\n    fill: #DE6C00FF;\n}\nsvg>path.OfficeIconColors_m2227 {\n    fill: #FFFFFF00;\n}\nsvg>path.OfficeIconColors_m2228 {\n    fill: #3A3A38FF;\n}\nsvg>path.OfficeIconColors_m2229 {\n    fill: #FFFFFF00;\n}\nsvg>path.OfficeIconColors_m2230 {\n    fill: #1E8BCDFF;\n}\nsvg>path.OfficeIconColors_m2231 {\n    fill: #FFFFFF00;\n}\nsvg>path.OfficeIconColors_m2232 {\n    fill: #66C2B5FF;\n}\nsvg>path.OfficeIconColors_m2233 {\n    fill: #FAC914FF;\n}\nsvg>path.OfficeIconColors_m2234 {\n    fill: #E9001BFF;\n}\nsvg>path.OfficeIconColors_m2235 {\n    fill: #A8C4CFFF;\n}\nsvg>path.OfficeIconColors_m2236 {\n    fill: #6EB005FF;\n}\nsvg>path.OfficeIconColors_m2237 {\n    fill: #B4009EFF;\n}\nsvg>path.OfficeIconColors_m2238 {\n    fill: #C8C6C4FF;\n}\nsvg>path.OfficeIconColors_m2239 {\n    fill: #666EDAFF;\n}\nsvg>path.OfficeIconColors_m2240 {\n    fill: #41479DFF;\n}\nsvg>path.OfficeIconColors_m2241 {\n    fill: #E08095FF;\n}\nsvg>path.OfficeIconColors_m2242 {\n    fill: #C94F60FF;\n}\nsvg>path.OfficeIconColors_m2243 {\n    fill: #AF2031FF;\n}\nsvg>path.OfficeIconColors_m2244 {\n    fill: #881421FF;\n}\nsvg>path.OfficeIconColors_m2245 {\n    fill: #66121CFF;\n}\nsvg>path.OfficeIconColors_m2246 {\n    fill: #E8467CFF;\n}\nsvg>path.OfficeIconColors_m2247 {\n    fill: #D23062FF;\n}\nsvg>path.OfficeIconColors_m2248 {\n    fill: #BC1948FF;\n}\nsvg>path.OfficeIconColors_m2249 {\n    fill: #8C193FFF;\n}\nsvg>path.OfficeIconColors_m2250 {\n    fill: #7B193BFF;\n}\nsvg>path.OfficeIconColors_m2251 {\n    fill: #000000FF;\n}\nsvg>path.OfficeIconColors_m2252 {\n    fill: #C8C6C4FF;\n}\nsvg>path.OfficeIconColors_m2253 {\n    fill: #86F2F2FF;\n}\nsvg>path.OfficeIconColors_m2254 {\n    fill: #F29E00FF;\n}\nsvg>path.OfficeIconColors_m2255 {\n    fill: #D83B01FF;\n}\nsvg>path.OfficeIconColors_m2256 {\n    fill: #D83B013F;\n}\nsvg>path.OfficeIconColors_m2257 {\n    fill: #D5559CFF;\n}\nsvg>path.OfficeIconColors_m2258 {\n    fill: #C21F24FF;\n}\nsvg>path.OfficeIconColors_m2259 {\n    fill: #C21F243F;\n}\nsvg>path.OfficeIconColors_m2260 {\n    fill: #F32940FF;\n}\nsvg>path.OfficeIconColors_m2261 {\n    fill: #5E050026;\n}\nsvg>path.OfficeIconColors_m2262 {\n    fill: #185ABDFF;\n}\nsvg>path.OfficeIconColors_m2263 {\n    fill: #107C41FF;\n}\nsvg>path.OfficeIconColors_m2264 {\n    fill: #C43E1CFF;\n}\nsvg>path.OfficeIconColors_m2265 {\n    fill: #7719AAFF;\n}\nsvg>path.OfficeIconColors_m2266 {\n    fill: #0078D4FF;\n}\nsvg>path.OfficeIconColors_m2267 {\n    fill: #4B53BCFF;\n}\nsvg>path.OfficeIconColors_m2268 {\n    fill: #038387FF;\n}\nsvg>path.OfficeIconColors_m2269 {\n    fill: #AF2031FF;\n}\nsvg>path.OfficeIconColors_m2270 {\n    fill: #BC1948FF;\n}\nsvg>path.OfficeIconColors_m2271 {\n    fill: #F8DE6DFF;\n}\nsvg>path.OfficeIconColors_m2272 {\n    fill: #E9C011FF;\n}\nsvg>path.OfficeIconColors_m2273 {\n    fill: #E6AD10FF;\n}\nsvg>path.OfficeIconColors_m2274 {\n    fill: #D7960FFF;\n}\nsvg>path.OfficeIconColors_m2275 {\n    fill: #D08A0FFF;\n}\nsvg>path.OfficeIconColors_m2276 {\n    fill: #C87E0EFF;\n}\nsvg>path.OfficeIconColors_m2277 {\n    fill: #34C1E0FF;\n}\nsvg>path.OfficeIconColors_m2278 {\n    fill: #83E688FF;\n}\nsvg>path.OfficeIconColors_m2279 {\n    fill: #37B658FF;\n}\nsvg>path.OfficeIconColors_m2280 {\n    fill: #088142FF;\n}\nsvg>path.OfficeIconColors_m2281 {\n    fill: #09743DFF;\n}\nsvg>path.OfficeIconColors_m2282 {\n    fill: #0A5A33FF;\n}\nsvg>path.OfficeIconColors_m2283 {\n    fill: #0A5A33FF;\n}\nsvg>path.OfficeIconColors_m2284 {\n    fill: #0A5A33FF;\n}\nsvg>path.OfficeIconColors_m2285 {\n    fill: #E5512AFF;\n}\nsvg>path.OfficeIconColors_m2286 {\n    fill: #BB3B01FF;\n}\nsvg>path.OfficeIconColors_m2287 {\n    fill: #8661C5FF;\n}\nsvg>path.OfficeIconColors_m2288 {\n    fill: #0472D8FF;\n}\nsvg>path.OfficeIconColors_m2289 {\n    fill: #0C4497FF;\n}\nsvg>path.OfficeIconColors_m2290 {\n    fill: #2096FFFF;\n}\nsvg>path.OfficeIconColors_m2291 {\n    fill: #56C5FFFF;\n}\nsvg>path.OfficeIconColors_DynamicColor {\n    fill: inherit;\n}\n","",{version:3,sources:["webpack://./../../../../npm/.store/sdx_officecopilot/@1js-icons.monoline@16.17623.43275-d54212279f15462c6b2b/node_modules/@1js/icons.monoline/m2_colorful.css"],names:[],mappings:"AAAA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,aAAa;AACjB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,eAAe;AACnB;AACA;IACI,aAAa;AACjB",sourcesContent:["svg>path.OfficeIconColors_m20 {\r\n    fill: #FAFAFAFF;\r\n}\r\nsvg>path.OfficeIconColors_m21 {\r\n    fill: #C8C6C4FF;\r\n}\r\nsvg>path.OfficeIconColors_m22 {\r\n    fill: #3A3A38FF;\r\n}\r\nsvg>path.OfficeIconColors_m23 {\r\n    fill: #797774FF;\r\n}\r\nsvg>path.OfficeIconColors_m24 {\r\n    fill: #1E8BCDFF;\r\n}\r\nsvg>path.OfficeIconColors_m25 {\r\n    fill: #0063B1FF;\r\n}\r\nsvg>path.OfficeIconColors_m26 {\r\n    fill: #83BEECFF;\r\n}\r\nsvg>path.OfficeIconColors_m27 {\r\n    fill: #379E4EFF;\r\n}\r\nsvg>path.OfficeIconColors_m28 {\r\n    fill: #309048FF;\r\n}\r\nsvg>path.OfficeIconColors_m29 {\r\n    fill: #A1DDAAFF;\r\n}\r\nsvg>path.OfficeIconColors_m210 {\r\n    fill: #DE6C00FF;\r\n}\r\nsvg>path.OfficeIconColors_m211 {\r\n    fill: #DE6C00FF;\r\n}\r\nsvg>path.OfficeIconColors_m212 {\r\n    fill: #F8DB8FFF;\r\n}\r\nsvg>path.OfficeIconColors_m213 {\r\n    fill: #ED3D3BFF;\r\n}\r\nsvg>path.OfficeIconColors_m214 {\r\n    fill: #D42314FF;\r\n}\r\nsvg>path.OfficeIconColors_m215 {\r\n    fill: #FF9198FF;\r\n}\r\nsvg>path.OfficeIconColors_m216 {\r\n    fill: #FF672DFF;\r\n}\r\nsvg>path.OfficeIconColors_m217 {\r\n    fill: #E84B12FF;\r\n}\r\nsvg>path.OfficeIconColors_m218 {\r\n    fill: #FFB255FF;\r\n}\r\nsvg>path.OfficeIconColors_m219 {\r\n    fill: #A846B2FF;\r\n}\r\nsvg>path.OfficeIconColors_m220 {\r\n    fill: #922E9BFF;\r\n}\r\nsvg>path.OfficeIconColors_m221 {\r\n    fill: #D492D8FF;\r\n}\r\nsvg>path.OfficeIconColors_m222 {\r\n    fill: #FFFFFF66;\r\n}\r\nsvg>path.OfficeIconColors_m223 {\r\n    fill: #DCEDFA;\r\n}\r\nsvg>path.OfficeIconColors_m224 {\r\n    fill: #0063B1FF;\r\n}\r\nsvg>path.OfficeIconColors_m225 {\r\n    fill: #EADECCFF;\r\n}\r\nsvg>path.OfficeIconColors_m226 {\r\n    fill: #705F53FF;\r\n}\r\nsvg>path.OfficeIconColors_m227 {\r\n    fill: #FFFFFFFF;\r\n}\r\nsvg>path.OfficeIconColors_m228 {\r\n    fill: #007EE5FF;\r\n}\r\nsvg>path.OfficeIconColors_m229 {\r\n    fill: #D83B01FF;\r\n}\r\nsvg>path.OfficeIconColors_m230 {\r\n    fill: #0849B1FF;\r\n}\r\nsvg>path.OfficeIconColors_m231 {\r\n    fill: #0078D7FF;\r\n}\r\nsvg>path.OfficeIconColors_m232 {\r\n    fill: #7DA3C6FF;\r\n}\r\nsvg>path.OfficeIconColors_m233 {\r\n    fill: #2B579AFF;\r\n}\r\nsvg>path.OfficeIconColors_m234 {\r\n    fill: #B7472AFF;\r\n}\r\nsvg>path.OfficeIconColors_m235 {\r\n    fill: #ED9583FF;\r\n}\r\nsvg>path.OfficeIconColors_m236 {\r\n    fill: #217346FF;\r\n}\r\nsvg>path.OfficeIconColors_m237 {\r\n    fill: #6EB38AFF;\r\n}\r\nsvg>path.OfficeIconColors_m238 {\r\n    fill: #7719AAFF;\r\n}\r\nsvg>path.OfficeIconColors_m239 {\r\n    fill: #DDC5ECFF;\r\n}\r\nsvg>path.OfficeIconColors_m240 {\r\n    fill: #FF0000FF;\r\n}\r\nsvg>path.OfficeIconColors_m241 {\r\n    fill: #FFFF00FF;\r\n}\r\nsvg>path.OfficeIconColors_m242 {\r\n    fill: #00FF00FF;\r\n}\r\nsvg>path.OfficeIconColors_m243 {\r\n    fill: #00FFFFFF;\r\n}\r\nsvg>path.OfficeIconColors_m244 {\r\n    fill: #FF0000FF;\r\n}\r\nsvg>path.OfficeIconColors_m245 {\r\n    fill: #FF8000FF;\r\n}\r\nsvg>path.OfficeIconColors_m246 {\r\n    fill: #57D200FF;\r\n}\r\nsvg>path.OfficeIconColors_m247 {\r\n    fill: #3165BBFF;\r\n}\r\nsvg>path.OfficeIconColors_m248 {\r\n    fill: #969696FF;\r\n}\r\nsvg>path.OfficeIconColors_m249 {\r\n    fill: #797979FF;\r\n}\r\nsvg>path.OfficeIconColors_m250 {\r\n    fill: #B3B3B3FF;\r\n}\r\nsvg>path.OfficeIconColors_m251 {\r\n    fill: #FF00FFFF;\r\n}\r\nsvg>path.OfficeIconColors_m252 {\r\n    fill: #000000FF;\r\n}\r\nsvg>path.OfficeIconColors_m253 {\r\n    fill: #9FCDB3FF;\r\n}\r\nsvg>path.OfficeIconColors_m254 {\r\n    fill: #028484FF;\r\n}\r\nsvg>path.OfficeIconColors_m255 {\r\n    fill: #3B5998FF;\r\n}\r\nsvg>path.OfficeIconColors_m256 {\r\n    fill: #1DA1F2FF;\r\n}\r\nsvg>path.OfficeIconColors_m257 {\r\n    fill: #DD4B39FF;\r\n}\r\nsvg>path.OfficeIconColors_m258 {\r\n    fill: #35465DFF;\r\n}\r\nsvg>path.OfficeIconColors_m259 {\r\n    fill: #464342FF;\r\n}\r\nsvg>path.OfficeIconColors_m260 {\r\n    fill: #BD081CFF;\r\n}\r\nsvg>path.OfficeIconColors_m261 {\r\n    fill: #0077B5FF;\r\n}\r\nsvg>path.OfficeIconColors_m262 {\r\n    fill: #FF4500FF;\r\n}\r\nsvg>path.OfficeIconColors_m263 {\r\n    fill: #008372FF;\r\n}\r\nsvg>path.OfficeIconColors_m264 {\r\n    fill: #0078D7FF;\r\n}\r\nsvg>path.OfficeIconColors_m265 {\r\n    fill: #0063DBFF;\r\n}\r\nsvg>path.OfficeIconColors_m266 {\r\n    fill: #FF0084FF;\r\n}\r\nsvg>path.OfficeIconColors_m267 {\r\n    fill: #CD201FFF;\r\n}\r\nsvg>path.OfficeIconColors_m268 {\r\n    fill: #FF00AAFF;\r\n}\r\nsvg>path.OfficeIconColors_m269 {\r\n    fill: #F57D00FF;\r\n}\r\nsvg>path.OfficeIconColors_m270 {\r\n    fill: #00BF00FF;\r\n}\r\nsvg>path.OfficeIconColors_m271 {\r\n    fill: #E6E6E6FF;\r\n}\r\nsvg>path.OfficeIconColors_m272 {\r\n    fill: #5A5A5AFF;\r\n}\r\nsvg>path.OfficeIconColors_m273 {\r\n    fill: #F4840BFF;\r\n}\r\nsvg>path.OfficeIconColors_m274 {\r\n    fill: #FF1600FF;\r\n}\r\nsvg>path.OfficeIconColors_m275 {\r\n    fill: #933DC1FF;\r\n}\r\nsvg>path.OfficeIconColors_m276 {\r\n    fill: #00BFFFFF;\r\n}\r\nsvg>path.OfficeIconColors_m277 {\r\n    fill: #B5D82AFF;\r\n}\r\nsvg>path.OfficeIconColors_m278 {\r\n    fill: #F2D80DFF;\r\n}\r\nsvg>path.OfficeIconColors_m279 {\r\n    fill: #D40078FF;\r\n}\r\nsvg>path.OfficeIconColors_m280 {\r\n    fill: #FABD14FF;\r\n}\r\nsvg>path.OfficeIconColors_m281 {\r\n    fill: #0F893EFF;\r\n}\r\nsvg>path.OfficeIconColors_m282 {\r\n    fill: #004E8CFF;\r\n}\r\nsvg>path.OfficeIconColors_m283 {\r\n    fill: #AC008CFF;\r\n}\r\nsvg>path.OfficeIconColors_m284 {\r\n    fill: #F7630DFF;\r\n}\r\nsvg>path.OfficeIconColors_m285 {\r\n    fill: #E81123FF;\r\n}\r\nsvg>path.OfficeIconColors_m286 {\r\n    fill: #00B6C1FF;\r\n}\r\nsvg>path.OfficeIconColors_m287 {\r\n    fill: #0063AFFF;\r\n}\r\nsvg>path.OfficeIconColors_m288 {\r\n    fill: #5B2D90FF;\r\n}\r\nsvg>path.OfficeIconColors_m289 {\r\n    fill: #C6A477FF;\r\n}\r\nsvg>path.OfficeIconColors_m290 {\r\n    fill: #7EC500FF;\r\n}\r\nsvg>path.OfficeIconColors_m291 {\r\n    fill: #00AC56FF;\r\n}\r\nsvg>path.OfficeIconColors_m292 {\r\n    fill: #0099BBFF;\r\n}\r\nsvg>path.OfficeIconColors_m293 {\r\n    fill: #C10051FF;\r\n}\r\nsvg>path.OfficeIconColors_m294 {\r\n    fill: #84939AFF;\r\n}\r\nsvg>path.OfficeIconColors_m295 {\r\n    fill: #106EBEFF;\r\n}\r\nsvg>path.OfficeIconColors_m296 {\r\n    fill: #EE3124FF;\r\n}\r\nsvg>path.OfficeIconColors_m297 {\r\n    fill: #DCEAF5FF;\r\n}\r\nsvg>path.OfficeIconColors_m298 {\r\n    fill: #C6DFF3FF;\r\n}\r\nsvg>path.OfficeIconColors_m299 {\r\n    fill: #B0D4F1FF;\r\n}\r\nsvg>path.OfficeIconColors_m2100 {\r\n    fill: #9AC9EEFF;\r\n}\r\nsvg>path.OfficeIconColors_m2101 {\r\n    fill: #83BEECFF;\r\n}\r\nsvg>path.OfficeIconColors_m2102 {\r\n    fill: #60ACE1FF;\r\n}\r\nsvg>path.OfficeIconColors_m2103 {\r\n    fill: #3D9BD6FF;\r\n}\r\nsvg>path.OfficeIconColors_m2104 {\r\n    fill: #1B86CAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2105 {\r\n    fill: #1A6EBDFF;\r\n}\r\nsvg>path.OfficeIconColors_m2106 {\r\n    fill: #FFFFFFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2107 {\r\n    fill: #00A4FFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2108 {\r\n    fill: #0000007F;\r\n}\r\nsvg>path.OfficeIconColors_m2109 {\r\n    fill: #FFFFFF66;\r\n}\r\nsvg>path.OfficeIconColors_m2110 {\r\n    fill: #FFFFFF4C;\r\n}\r\nsvg>path.OfficeIconColors_m2111 {\r\n    fill: #FFFFFF7F;\r\n}\r\nsvg>path.OfficeIconColors_m2112 {\r\n    fill: #000000FF;\r\n}\r\nsvg>path.OfficeIconColors_m2113 {\r\n    fill: #A4373AFF;\r\n}\r\nsvg>path.OfficeIconColors_m2114 {\r\n    fill: #31752FFF;\r\n}\r\nsvg>path.OfficeIconColors_m2115 {\r\n    fill: #077568FF;\r\n}\r\nsvg>path.OfficeIconColors_m2116 {\r\n    fill: #3955A3FF;\r\n}\r\nsvg>path.OfficeIconColors_m2117 {\r\n    fill: #8EA6DDFF;\r\n}\r\nsvg>path.OfficeIconColors_m2118 {\r\n    fill: #00A1E0FF;\r\n}\r\nsvg>path.OfficeIconColors_m2119 {\r\n    fill: #002050FF;\r\n}\r\nsvg>path.OfficeIconColors_m2120 {\r\n    fill: #FFEF9CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2121 {\r\n    fill: #638AC6FF;\r\n}\r\nsvg>path.OfficeIconColors_m2122 {\r\n    fill: #638AC63F;\r\n}\r\nsvg>path.OfficeIconColors_m2123 {\r\n    fill: #63BE7BFF;\r\n}\r\nsvg>path.OfficeIconColors_m2124 {\r\n    fill: #63BE7B3F;\r\n}\r\nsvg>path.OfficeIconColors_m2125 {\r\n    fill: #FF555AFF;\r\n}\r\nsvg>path.OfficeIconColors_m2126 {\r\n    fill: #FF555A3F;\r\n}\r\nsvg>path.OfficeIconColors_m2127 {\r\n    fill: #FFB628FF;\r\n}\r\nsvg>path.OfficeIconColors_m2128 {\r\n    fill: #008AEFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2129 {\r\n    fill: #D6007BFF;\r\n}\r\nsvg>path.OfficeIconColors_m2130 {\r\n    fill: #ED7D31FF;\r\n}\r\nsvg>path.OfficeIconColors_m2131 {\r\n    fill: #107C10FF;\r\n}\r\nsvg>path.OfficeIconColors_m2132 {\r\n    fill: #C30052FF;\r\n}\r\nsvg>path.OfficeIconColors_m2133 {\r\n    fill: #9C0041FF;\r\n}\r\nsvg>path.OfficeIconColors_m2134 {\r\n    fill: #F7BFA0FF;\r\n}\r\nsvg>path.OfficeIconColors_m2135 {\r\n    fill: #A2D3A0FF;\r\n}\r\nsvg>path.OfficeIconColors_m2136 {\r\n    fill: #9FCDC7FF;\r\n}\r\nsvg>path.OfficeIconColors_m2137 {\r\n    fill: #D492D84C;\r\n}\r\nsvg>path.OfficeIconColors_m2138 {\r\n    fill: #00AECDFF;\r\n}\r\nsvg>path.OfficeIconColors_m2139 {\r\n    fill: #4285F1FF;\r\n}\r\nsvg>path.OfficeIconColors_m2140 {\r\n    fill: #32A651FF;\r\n}\r\nsvg>path.OfficeIconColors_m2141 {\r\n    fill: #FBBE05FF;\r\n}\r\nsvg>path.OfficeIconColors_m2142 {\r\n    fill: #EA4235FF;\r\n}\r\nsvg>path.OfficeIconColors_m2143 {\r\n    fill: #D492D899;\r\n}\r\nsvg>path.OfficeIconColors_m2144 {\r\n    fill: #0182BCFF;\r\n}\r\nsvg>path.OfficeIconColors_m2145 {\r\n    fill: #312F62FF;\r\n}\r\nsvg>path.OfficeIconColors_m2146 {\r\n    fill: #7CBC31FF;\r\n}\r\nsvg>path.OfficeIconColors_m2147 {\r\n    fill: #FAFAFAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2148 {\r\n    fill: #3A3A38FF;\r\n}\r\nsvg>path.OfficeIconColors_m2149 {\r\n    fill: #797774FF;\r\n}\r\nsvg>path.OfficeIconColors_m2150 {\r\n    fill: #F07D88FF;\r\n}\r\nsvg>path.OfficeIconColors_m2151 {\r\n    fill: #55ABE5FF;\r\n}\r\nsvg>path.OfficeIconColors_m2152 {\r\n    fill: #5FBE7DFF;\r\n}\r\nsvg>path.OfficeIconColors_m2153 {\r\n    fill: #B9C0CBFF;\r\n}\r\nsvg>path.OfficeIconColors_m2154 {\r\n    fill: #FF8C00FF;\r\n}\r\nsvg>path.OfficeIconColors_m2155 {\r\n    fill: #33BAB1FF;\r\n}\r\nsvg>path.OfficeIconColors_m2156 {\r\n    fill: #A3B367FF;\r\n}\r\nsvg>path.OfficeIconColors_m2157 {\r\n    fill: #A895E2FF;\r\n}\r\nsvg>path.OfficeIconColors_m2158 {\r\n    fill: #026802FF;\r\n}\r\nsvg>path.OfficeIconColors_m2159 {\r\n    fill: #FFF100FF;\r\n}\r\nsvg>path.OfficeIconColors_m2160 {\r\n    fill: #5558AFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2161 {\r\n    fill: #800080FF;\r\n}\r\nsvg>path.OfficeIconColors_m2162 {\r\n    fill: #FF91983F;\r\n}\r\nsvg>path.OfficeIconColors_m2163 {\r\n    fill: #68217AFF;\r\n}\r\nsvg>path.OfficeIconColors_m2164 {\r\n    fill: #2B2C33FF;\r\n}\r\nsvg>path.OfficeIconColors_m2165 {\r\n    fill: #00A7E9FF;\r\n}\r\nsvg>path.OfficeIconColors_m2166 {\r\n    fill: #00979DFF;\r\n}\r\nsvg>path.OfficeIconColors_m2167 {\r\n    fill: #FBD115FF;\r\n}\r\nsvg>path.OfficeIconColors_m2168 {\r\n    fill: #006BFFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2169 {\r\n    fill: #231840FF;\r\n}\r\nsvg>path.OfficeIconColors_m2170 {\r\n    fill: #9E8BFCFF;\r\n}\r\nsvg>path.OfficeIconColors_m2171 {\r\n    fill: #F3E9FFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2172 {\r\n    fill: #FFFFFF4C;\r\n}\r\nsvg>path.OfficeIconColors_m2173 {\r\n    fill: #3A3A38FF;\r\n}\r\nsvg>path.OfficeIconColors_m2174 {\r\n    fill: #797774FF;\r\n}\r\nsvg>path.OfficeIconColors_m2175 {\r\n    fill: #00000059;\r\n}\r\nsvg>path.OfficeIconColors_m2176 {\r\n    fill: #FFFFFF7F;\r\n}\r\nsvg>path.OfficeIconColors_m2177 {\r\n    fill: #A7DCD5FF;\r\n}\r\nsvg>path.OfficeIconColors_m2178 {\r\n    fill: #329494FF;\r\n}\r\nsvg>path.OfficeIconColors_m2179 {\r\n    fill: #008085FF;\r\n}\r\nsvg>path.OfficeIconColors_m2180 {\r\n    fill: #90E3E3FF;\r\n}\r\nsvg>path.OfficeIconColors_m2181 {\r\n    fill: #FFFFFFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2182 {\r\n    fill: #0000000C;\r\n}\r\nsvg>path.OfficeIconColors_m2183 {\r\n    fill: #00000019;\r\n}\r\nsvg>path.OfficeIconColors_m2184 {\r\n    fill: #00000033;\r\n}\r\nsvg>path.OfficeIconColors_m2185 {\r\n    fill: #0000007F;\r\n}\r\nsvg>path.OfficeIconColors_m2186 {\r\n    fill: #000000C0;\r\n}\r\nsvg>path.OfficeIconColors_m2187 {\r\n    fill: #41A5EEFF;\r\n}\r\nsvg>path.OfficeIconColors_m2188 {\r\n    fill: #2B7CD3FF;\r\n}\r\nsvg>path.OfficeIconColors_m2189 {\r\n    fill: #185ABDFF;\r\n}\r\nsvg>path.OfficeIconColors_m2190 {\r\n    fill: #103F91FF;\r\n}\r\nsvg>path.OfficeIconColors_m2191 {\r\n    fill: #163870FF;\r\n}\r\nsvg>path.OfficeIconColors_m2192 {\r\n    fill: #33C481FF;\r\n}\r\nsvg>path.OfficeIconColors_m2193 {\r\n    fill: #21A366FF;\r\n}\r\nsvg>path.OfficeIconColors_m2194 {\r\n    fill: #107C41FF;\r\n}\r\nsvg>path.OfficeIconColors_m2195 {\r\n    fill: #185C37FF;\r\n}\r\nsvg>path.OfficeIconColors_m2196 {\r\n    fill: #134A2CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2197 {\r\n    fill: #FF8F6BFF;\r\n}\r\nsvg>path.OfficeIconColors_m2198 {\r\n    fill: #ED6C47FF;\r\n}\r\nsvg>path.OfficeIconColors_m2199 {\r\n    fill: #D35230FF;\r\n}\r\nsvg>path.OfficeIconColors_m2200 {\r\n    fill: #C43E1CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2201 {\r\n    fill: #993117FF;\r\n}\r\nsvg>path.OfficeIconColors_m2202 {\r\n    fill: #CA64EAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2203 {\r\n    fill: #AE4BD5FF;\r\n}\r\nsvg>path.OfficeIconColors_m2204 {\r\n    fill: #9332BFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2205 {\r\n    fill: #7719AAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2206 {\r\n    fill: #511575FF;\r\n}\r\nsvg>path.OfficeIconColors_m2207 {\r\n    fill: #50D9FFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2208 {\r\n    fill: #28A8EAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2209 {\r\n    fill: #1490DFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2210 {\r\n    fill: #0078D4FF;\r\n}\r\nsvg>path.OfficeIconColors_m2211 {\r\n    fill: #0364B8FF;\r\n}\r\nsvg>path.OfficeIconColors_m2212 {\r\n    fill: #0358A7FF;\r\n}\r\nsvg>path.OfficeIconColors_m2213 {\r\n    fill: #06509BFF;\r\n}\r\nsvg>path.OfficeIconColors_m2214 {\r\n    fill: #064A8CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2215 {\r\n    fill: #0A2767FF;\r\n}\r\nsvg>path.OfficeIconColors_m2216 {\r\n    fill: #0A27677F;\r\n}\r\nsvg>path.OfficeIconColors_m2217 {\r\n    fill: #7B83EBFF;\r\n}\r\nsvg>path.OfficeIconColors_m2218 {\r\n    fill: #5059C9FF;\r\n}\r\nsvg>path.OfficeIconColors_m2219 {\r\n    fill: #4B53BCFF;\r\n}\r\nsvg>path.OfficeIconColors_m2220 {\r\n    fill: #363A7EFF;\r\n}\r\nsvg>path.OfficeIconColors_m2221 {\r\n    fill: #37C6D0FF;\r\n}\r\nsvg>path.OfficeIconColors_m2222 {\r\n    fill: #1A9BA1FF;\r\n}\r\nsvg>path.OfficeIconColors_m2223 {\r\n    fill: #038387FF;\r\n}\r\nsvg>path.OfficeIconColors_m2224 {\r\n    fill: #036C70FF;\r\n}\r\nsvg>path.OfficeIconColors_m2225 {\r\n    fill: #0E4F51FF;\r\n}\r\nsvg>path.OfficeIconColors_m2226 {\r\n    fill: #DE6C00FF;\r\n}\r\nsvg>path.OfficeIconColors_m2227 {\r\n    fill: #FFFFFF00;\r\n}\r\nsvg>path.OfficeIconColors_m2228 {\r\n    fill: #3A3A38FF;\r\n}\r\nsvg>path.OfficeIconColors_m2229 {\r\n    fill: #FFFFFF00;\r\n}\r\nsvg>path.OfficeIconColors_m2230 {\r\n    fill: #1E8BCDFF;\r\n}\r\nsvg>path.OfficeIconColors_m2231 {\r\n    fill: #FFFFFF00;\r\n}\r\nsvg>path.OfficeIconColors_m2232 {\r\n    fill: #66C2B5FF;\r\n}\r\nsvg>path.OfficeIconColors_m2233 {\r\n    fill: #FAC914FF;\r\n}\r\nsvg>path.OfficeIconColors_m2234 {\r\n    fill: #E9001BFF;\r\n}\r\nsvg>path.OfficeIconColors_m2235 {\r\n    fill: #A8C4CFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2236 {\r\n    fill: #6EB005FF;\r\n}\r\nsvg>path.OfficeIconColors_m2237 {\r\n    fill: #B4009EFF;\r\n}\r\nsvg>path.OfficeIconColors_m2238 {\r\n    fill: #C8C6C4FF;\r\n}\r\nsvg>path.OfficeIconColors_m2239 {\r\n    fill: #666EDAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2240 {\r\n    fill: #41479DFF;\r\n}\r\nsvg>path.OfficeIconColors_m2241 {\r\n    fill: #E08095FF;\r\n}\r\nsvg>path.OfficeIconColors_m2242 {\r\n    fill: #C94F60FF;\r\n}\r\nsvg>path.OfficeIconColors_m2243 {\r\n    fill: #AF2031FF;\r\n}\r\nsvg>path.OfficeIconColors_m2244 {\r\n    fill: #881421FF;\r\n}\r\nsvg>path.OfficeIconColors_m2245 {\r\n    fill: #66121CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2246 {\r\n    fill: #E8467CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2247 {\r\n    fill: #D23062FF;\r\n}\r\nsvg>path.OfficeIconColors_m2248 {\r\n    fill: #BC1948FF;\r\n}\r\nsvg>path.OfficeIconColors_m2249 {\r\n    fill: #8C193FFF;\r\n}\r\nsvg>path.OfficeIconColors_m2250 {\r\n    fill: #7B193BFF;\r\n}\r\nsvg>path.OfficeIconColors_m2251 {\r\n    fill: #000000FF;\r\n}\r\nsvg>path.OfficeIconColors_m2252 {\r\n    fill: #C8C6C4FF;\r\n}\r\nsvg>path.OfficeIconColors_m2253 {\r\n    fill: #86F2F2FF;\r\n}\r\nsvg>path.OfficeIconColors_m2254 {\r\n    fill: #F29E00FF;\r\n}\r\nsvg>path.OfficeIconColors_m2255 {\r\n    fill: #D83B01FF;\r\n}\r\nsvg>path.OfficeIconColors_m2256 {\r\n    fill: #D83B013F;\r\n}\r\nsvg>path.OfficeIconColors_m2257 {\r\n    fill: #D5559CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2258 {\r\n    fill: #C21F24FF;\r\n}\r\nsvg>path.OfficeIconColors_m2259 {\r\n    fill: #C21F243F;\r\n}\r\nsvg>path.OfficeIconColors_m2260 {\r\n    fill: #F32940FF;\r\n}\r\nsvg>path.OfficeIconColors_m2261 {\r\n    fill: #5E050026;\r\n}\r\nsvg>path.OfficeIconColors_m2262 {\r\n    fill: #185ABDFF;\r\n}\r\nsvg>path.OfficeIconColors_m2263 {\r\n    fill: #107C41FF;\r\n}\r\nsvg>path.OfficeIconColors_m2264 {\r\n    fill: #C43E1CFF;\r\n}\r\nsvg>path.OfficeIconColors_m2265 {\r\n    fill: #7719AAFF;\r\n}\r\nsvg>path.OfficeIconColors_m2266 {\r\n    fill: #0078D4FF;\r\n}\r\nsvg>path.OfficeIconColors_m2267 {\r\n    fill: #4B53BCFF;\r\n}\r\nsvg>path.OfficeIconColors_m2268 {\r\n    fill: #038387FF;\r\n}\r\nsvg>path.OfficeIconColors_m2269 {\r\n    fill: #AF2031FF;\r\n}\r\nsvg>path.OfficeIconColors_m2270 {\r\n    fill: #BC1948FF;\r\n}\r\nsvg>path.OfficeIconColors_m2271 {\r\n    fill: #F8DE6DFF;\r\n}\r\nsvg>path.OfficeIconColors_m2272 {\r\n    fill: #E9C011FF;\r\n}\r\nsvg>path.OfficeIconColors_m2273 {\r\n    fill: #E6AD10FF;\r\n}\r\nsvg>path.OfficeIconColors_m2274 {\r\n    fill: #D7960FFF;\r\n}\r\nsvg>path.OfficeIconColors_m2275 {\r\n    fill: #D08A0FFF;\r\n}\r\nsvg>path.OfficeIconColors_m2276 {\r\n    fill: #C87E0EFF;\r\n}\r\nsvg>path.OfficeIconColors_m2277 {\r\n    fill: #34C1E0FF;\r\n}\r\nsvg>path.OfficeIconColors_m2278 {\r\n    fill: #83E688FF;\r\n}\r\nsvg>path.OfficeIconColors_m2279 {\r\n    fill: #37B658FF;\r\n}\r\nsvg>path.OfficeIconColors_m2280 {\r\n    fill: #088142FF;\r\n}\r\nsvg>path.OfficeIconColors_m2281 {\r\n    fill: #09743DFF;\r\n}\r\nsvg>path.OfficeIconColors_m2282 {\r\n    fill: #0A5A33FF;\r\n}\r\nsvg>path.OfficeIconColors_m2283 {\r\n    fill: #0A5A33FF;\r\n}\r\nsvg>path.OfficeIconColors_m2284 {\r\n    fill: #0A5A33FF;\r\n}\r\nsvg>path.OfficeIconColors_m2285 {\r\n    fill: #E5512AFF;\r\n}\r\nsvg>path.OfficeIconColors_m2286 {\r\n    fill: #BB3B01FF;\r\n}\r\nsvg>path.OfficeIconColors_m2287 {\r\n    fill: #8661C5FF;\r\n}\r\nsvg>path.OfficeIconColors_m2288 {\r\n    fill: #0472D8FF;\r\n}\r\nsvg>path.OfficeIconColors_m2289 {\r\n    fill: #0C4497FF;\r\n}\r\nsvg>path.OfficeIconColors_m2290 {\r\n    fill: #2096FFFF;\r\n}\r\nsvg>path.OfficeIconColors_m2291 {\r\n    fill: #56C5FFFF;\r\n}\r\nsvg>path.OfficeIconColors_DynamicColor {\r\n    fill: inherit;\r\n}\r\n"],sourceRoot:""}]);const s=a},83488:(e,t,n)=>{var o=n(28679),r=n.n(o),i=n(22180),a=n.n(i),s=n(87720),l=n.n(s),c=n(34159),u=n.n(c),d=n(11843),p=n.n(d),h=n(79216),g=n.n(h),f=n(97390),m={};m.styleTagTransform=g(),m.setAttributes=u(),m.insert=l().bind(null,"head"),m.domAPI=a(),m.insertStyleElement=p();r()(f.A,m),f.A&&f.A.locals&&f.A.locals},20434:(e,t,n)=>{e.exports=n.p+"assets/feedback-nudge.svg"},32054:e=>{e.exports=JSON.parse('{"FREHeader":"Introducing Copilot","FREDescriptionMessage":"Use the power of AI to add columns with formulas, format tables, and generate insights about data in your tables.\\n\\nCopilot can make mistakes, so remember to verify info and share your feedback.","ServerErrorMessage":"Whoops! I\'m not able to understand this yet. Is there something else I can do to help?","QueryLengthTooShortError":"Your message is too short. Please provide more information.","RaiErrorUserMessage":"I\'m not able to do that. What else can I do for you?","RaiErrorSuccessfulActionBlockedResponse":"Done! I made some changes, but I\'m not able to provide a description of the changes right now.","ServerErrorWithNoRetry":"I can\'t help with that. Try another prompt or use the prompt guide to see how I can help.","ServerErrorWithNoRetrySuggestionPill":"While I don\'t have a suggestion for you right now, try asking a specific question about the data.","ThrottlingErrorMessage":"You\'ve reached the limit on the total number of Copilot requests per hour. Try again in a little while.","LicensingErrorMessage":"Your account is not licensed to use Copilot, please contact your admin","ErrorQueryTooLarge":"I\'m still learning. That request is too large. Would you mind simplifying your request to one thing you want me to do?","ErrorServerBusy":"The server is really busy right now. Please try again later.","NoTableSelectedMessageWithLink2":"I only work with data in {0} or data ranges with the following criteria:","NoTableSelectedMessageCriteriaList":"a single header row with different column names\\nno empty rows or columns\\nconsistent data formatting per column\\nno subtotals","NoTableSelectedMessageWithCommand2":"Try selecting data that meets the criteria or is formatted as a table ({0}).","RibbonCommandInsertTable":"Insert > Table","NoTableSelectedTitle2":"No data selected from an Excel table or data range","ZQMPromptItemAsk":"Ask","ZQMPromptItemSummarize":"Summarize","CitationTitle":"This workbook","ClpLabelError":"I wasn\'t able to apply a sensitivity label to this file. Please choose another file or try again.","UnsupportedObjectSelectedTitle":"Select a table","UnsupportedObjectSelectedMessage":"For the best experience, select a table so I can help you make changes, create columns with formulas, and analyze your data.","PivotTableSelectedTitle":"I don\'t work on PivotTables just yet","PivotTableSelectedMessage":"Go to the original data set to do more analysis, create columns with formulas, or change formatting.","BlankWorksheetTitle":"Start with an Excel table","BlankWorksheetMessage":"You need an Excel table in this sheet to continue. If you want to see an example, I have one ready for you.","BlankWorksheetButtonText":"Try an example","BlankWorksheetButtonSuccess":"Done! I\'ve added the sample table. Try some of the suggestions to see how I can help.","ConvertToTableButtonSuccess":"Done! I\'ve created a Table from your data in {0}. How else can I help?","InsertTableSummaryCommentSuccessMessage":"Done! I added the description as a comment at {0}","TableTooLargeTitle":"Table too large","TableTooLargeMessage":"Copilot doesn\'t work with tables that have more than 40,000 cells. Try again with a smaller table.","TableHiddenHeadersTitle":"Hidden table headers","TableHiddenHeadersMessage":"I can only work with Excel tables that show headers. Would you like to show the header row?","ShowHeadersButtonTitle":"Show Header Row","ShowHeadersSuccessMessage":"Done! I\'ve made the header row of the table visible. How else can I help?","WorkbookTooLargeTitle":"Workbook too large","WorkbookTooLargeMessage":"Copilot doesn\'t work with workbooks that have more than 150,000 cells. Try using Copilot with a smaller workbook.","WorksheetAutosaveOffTitle":"AutoSave is turned off","WorksheetAutosaveOffMessage":"I only work with files that have AutoSave turned on. Turn it on to continue.","EnableAutosaveButtonText":"Turn on AutoSave","WorksheetProtectedTitle":"This sheet is password protected","WorksheetProtectedMessage":"I can\'t work on sheets that require a password. If you remove it temporarily, I can help you explore your data. Don\'t worry, you can add the password back anytime.","NonWorksheetActivatedTitle":"Start with a different sheet","NonWorksheetActivatedMessage":"I don\'t work in chart, macro, or dialog sheets. Select another sheet with data in an Excel table to continue.","ActionButtonGoToTable":"Go back to table","ActionButtonGoToData":"Go back to data","ActionButtonInsert":"Insert to new sheet","ActionButtonUndo":"Undo","ActionButtonUndoSuccessMessage":"Sure, I just reversed the last change I made.","ActionButtonApply":"Apply","InsertSingleTableSuccessMessage":"Done! A new table was inserted to {0}.","InsertMultiTablesSuccessMessage":"Done! {0} tables were added to your workbook.","InsertTableErrorMessage":"Sorry, something went wrong. Try your request again later.","InsertAllDataConfirmationMessage1":"Done! All insights from","InsertAllDataConfirmationMessage2":"were added to a new sheet.","InsertAllDataConfirmationMessage":"Done! I added all insights from {0} to a new sheet.","InsertDataConfirmationMessage1":"Done!","InsertDataConfirmationMessage2":"was added to","InsertDataConfirmationMessage":"Done! I added {0} to {1}.","CalculatedColumnsColumnConfirmationMessage":"Done! I inserted \'{0}\' to column {1}.","CalculatedColumnsTableConfirmationMessage":"Done! I inserted \'{0}\' to \'{1}\'.","MultipleCalculatedColumnsAddedToColumnsConfirmationMessage":"Done! I inserted {columnNames} to columns {columnHeaders}.","MultipleCalculatedColumnsAddedToTableConfirmationMessage":"Done! I inserted {columnNames} to \'{tableName}\'.","MoreThanThreeColumnsAddedToTableConfirmationMessage":"Done! I inserted {columnLength} formula columns to the table.","And":"and","DataShapingSuggestionHeader":"Here\'s a data shaping suggestion to review and apply:","DataShapingExplanation":"Explanation","DataShapingApply":"Apply","DataShapingApplyOrExit":"Apply changes or exit mode","DataShapingApplyToExistingTable":"Replace original table","DataShapingApplyToNewSheet":"Apply in a new sheet","DataShapingExitMode":"Exit mode","DataShapingConfirmationMessage":"Done! I applied the suggested transformation on your data.","LoadingUIApplyDataShapingStep":"Applying suggestion...","DataShapingGenericError":"Sorry, we\'re unable to apply the suggestion, please try again.","DataShapingUnsupportedPromptError":"Sorry, I can\'t help with that. Please exit the mode and try again.","DataShapingLoadingStartDataShapingMode":"Starting Data Preparation mode...","DataShapingAddStepDone":"Done! {0}.","DataShapingEnterModeButton":"Start Data Preparation.","DataShapingSuggestEnterModeHeaderText":"Sure, I can use Data Preparation mode!","DataShapingSuggestEnterModeText1":"Data Preparation mode assists you in transforming and shaping your data, a vital step before performing analysis, to ensure accurate decision-making.","DataShapingSuggestEnterModeText2":"When you start Data Preparation:","DataShapingSuggestEnterModeTextBullet1":"You will get a preview of all your transformation steps.","DataShapingSuggestEnterModeTextBullet2":"Once you apply the changes, all your steps will be executed either on your current sheet or a new sheet, depending on your preference.","DataShapingSuggestEnterModeText3":"To use other skills, you\'ll need to exit Data Preparation mode.","DataShapingPostEnterModeText1":"I can help with transforming your data and preparing it for analysis.","DataShapingPostEnterModeText2":"Select a suggested prompt or describe the specific transformations you would like to perform.","ExplainInsights":"Explain insights","ExplainFormula":"Explain formula","ExplainFormulas":"Explain formulas","ExplainCode":"Explain code","NoInsightsMessage":"I didn\'t find any relevant insights in your data. Try adding more data or use another data set.","NoAnalyzeDataMessage":"I don\'t have a helpful answer. Try another prompt.","AnalyzePotentialBiasMessage":"I\'m not able to work on that. However, I can try getting other insights for you.","AddMoreInfoMessage":"The more I know, the better I can answer. Try adding more information.","AnalyzeNotSupportedMessage":"I can\'t do that just yet. What else would you like me to do?","AnalyzeDataGenericError":"I\'m having trouble right now. Try inserting the content later.","AnalyzeDataGenericError2":"I\'m having trouble working on prompts right now. Try sending your prompt later.","AccessDeniedMessage":"Looks like this is a password-protected sheet. I\'m unable to insert this suggestion. Unprotect this sheet for a moment and try again.","CellEditingMessage":"I can\'t insert a suggestion while you\'re editing. Try again when you finish.","ChatPlaceholderMessage":"Ask a question or make a request about data in a table","ChatPlaceholderMessageV2":"Ask a question, or tell me how I can help","ChatPlaceholderMessageSearch":"Search for content, ask a question, or tell me how I can help","ChatPlaceholderMessageRange":"Ask a question, or tell me what you\'d like to do with {0}","ChatPlaceholderMessageSearchWithRange":"Search for content, ask a question, or tell me what you\'d like to do with {0}","ChatPlaceholderMessageInputV2NoGrounding":"Ask questions and work with this workbook","ChatPlaceholderMessageInputV2Enterprise":"Ask questions regarding people and files across your organization","ChatPlaceholderMessageAnalyzeData":"Describe what you want to know about the data","ChatPlaceholderMessageFormatTable":"Describe the changes you want to make to the table","ChatPlaceholderMessageFormulaColumn":"Describe the formula column you want to add","ChatRestShyPlaceholderMessage":"Ask a question","ChatRestShyPlaceholderMessageRange":"Ask a question about {0}","LoadingUIWorkingOnItStep":"Working on it...","LoadingUiUnderstandingDataStep":"Understanding your data...","LoadingUIAlmostThereStep":"Almost there...","LoadingUILookingAtDataRangeStep":"Looking at data range {0}...","LoadingUIAddingColumnStep":"Adding column...","LoadingUIAddingColumnsStep":"Adding columns...","LoadingUIInsertingContentStep":"Inserting content...","LoadingUIAnalyzingDataStep":"Analyzing your data...","LoadingUIAnalyzingDataTLRStep":"Analyzing {0}...","LoadingUIFinishingUpStep":"Finishing up...","LoadingUIMakingChangesStep":"Making changes to your table...","LoadingUIMakingChangesTLRStep":"Making changes to {0}...","LoadingUIGeneratingFormulaColumnSuggestionsStep":"Generating formula column suggestions...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStep":"Generating formula column suggestions for {0}...","LoadingUIMakingChangesStepTableOfficeJSLikeRange":"Making changes to your workbook...","RecommendationAddToNewSheet":"Add to a new sheet","RecommendationAddToSheet":"Add to sheet","RecommendationInsertColumn":"Insert column","RecommendationInsertMultipleColumns":"Insert columns","RecommendationSuggestionHeader":"Here\'s 1 formula column to review and insert:","RecommendationSuggestionHeaderGrounded":"Here\'s 1 formula column to review and insert into {range}:","RecommendationFormulaSuggestionHeaderGrounded":"Here\'s 1 formula to review and insert into {range}:","RecommendationSuggestionMultipleColumnsHeader":"Here are {columnLength} formula columns to review and insert:","RecommendationSuggestionMultipleColumnsHeaderGrounded":"Here are {columnLength} formula columns to review and insert into {range}:","RecommendationAnotherSuggestionHeader":"Here\'s another suggestion for you:","RecommendationAnotherSuggestionMultipleColumnsHeader":"Here are another {columnLength} suggestions for you:","FormulaSuggestion_Header_Singular":"Looking at {tableRange}, here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_Plural":"Looking at {tableRange}, here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_Singular_Location":"Column {columnLetter}","FormulaSuggestion_Header_Plural_Location":"Columns {columnLetters}","FormulaSuggestion_FormulaSnippet_AriaLabel":"Formula snippet","JunkPhrase1":"hey","JunkPhrase2":"hi","JunkPhrase3":"whats happening","JunkPhrase4":"hey there","JunkPhrase5":"whats up","JunkPhrase6":"who are you","JunkPhrase7":"heyo","JunkPhrase8":"whats going on","JunkPhrase9":"what up","JunkPhrase10":"hi there","JunkPhrase11":"how are you","JunkPhrase12":"good morning","JunkPhrase13":"good afternoon","JunkPhrase14":"good evening","JunkPhrase15":"whats your name","JunkPhrase16":"where are you from","JunkPhrase17":"where do you live","JunkPhrase18":"who made you","JunkPhrase19":"what is this","JunkPhrase20":"what do you do","JunkPhrase21":"what does this do","OptOutMessageTitle":"Thanks for giving me a try!","OptOutMessageSubTitle":"I know it\'s not you, it\'s me. But if you want me back, click the Ribbon Display Options down arrow and choose Beta","OptOutPhrase1":"quit","OptOutPhrase2":"return","OptOutPhrase3":"stop","OptOutPhrase4":"leave","OptOutPhrase5":"i dont like this","OptOutPhrase6":"i dont want this","OptOutPhrase7":"i hate this","OptOutPhrase8":"i dont want to use this","OptOutPhrase9":"i want the ribbon","OptOutPhrase10":"i want the regular Excel","OptOutPhrase11":"i want the old Excel","OptOutPhrase12":"old toolbar","OptOutPhrase13":"classic toolbar","OptOutPhrase14":"opt out","OptOutPhrase15":"goodbye","OptOutPhrase16":"bye","OptOutPhrase17":"leave me alone","OptOutPhrase18":"this sucks","OptOutPhrase19":"exit","OptOutPhrase20":"exit out","OptOutPhrase21":"leave beta","OptOutPhrase22":"leave experiment","OptOutPhrase23":"i want to quit","OptOutPhrase24":"i want to leave","OptOutPhrase25":"i want to opt out","OptOutPhrase26":"i want to exit","OptOutPhrase27":"i want to exit out","OptOutPhrase28":"i want to stop","OptOutPhrase29":"take me back","OptOutPhrase30":"take me back to old toolbar","OptOutPhrase31":"take me back to classic toolbar","OptOutPhrase32":"take me back to regular excel","OptOutPhrase33":"take me back to old excel","OptOutPhrase34":"old excel","OptOutPhrase35":"regular excel","HelpQueryPhrase1":"what can i say","HelpQueryPhrase2":"what else","HelpQueryPhrase3":"what else can i say","HelpQueryPhrase4":"what do i do","HelpQueryPhrase5":"what do i say","HelpQueryPhrase6":"what do i type","HelpQueryPhrase7":"commands","HelpQueryPhrase8":"show commands","HelpQueryPhrase9":"show me","HelpQueryPhrase10":"show me how to use","HelpQueryPhrase11":"tell me how to use","HelpQueryPhrase12":"tell me","HelpQueryPhrase13":"search","HelpQueryPhrase14":"help","HelpQueryPhrase15":"help me","HelpQueryPhrase16":"help me use","HelpQueryPhrase17":"how","HelpQueryPhrase18":"how do i","HelpQueryPhrase19":"how do i use","HelpQueryPhrase20":"how do I use this","HelpQueryPhrase21":"how does this work","HelpQueryPhrase22":"im confused","HelpQueryPhrase23":"what works","HelpQueryPhrase24":"what can you do","UnsupportedQueryUndoPhrase1":"undo","UnsupportedQueryUndoPhrase2":"cancel","UnsupportedQueryUndoPhrase3":"revert","UnsupportedQueryUndoPhrase4":"that\'s wrong","UnsupportedQueryUndoPhrase5":"that\'s not what I wanted","UnsupportedQueryAltTextPhrase1":"alt text","UnsupportedQueryAltTextPhrase2":"alternative text","UnsupportedQueryAltTextPhrase3":"accessible text","UnsupportedQueryAltTextPhrase4":"accessibility text","UnsupportedQueryAddCommentPhrase1":"add a comment","UnsupportedQueryAddCommentPhrase2":"add comment","UnsupportedQueryAddCommentPhrase3":"comment","UnsupportedQueryDataValidationPhrase1":"validate data","UnsupportedQueryDataValidationPhrase2":"restrict input","UnsupportedQueryDataValidationPhrase3":"add a drop down","UnsupportedQueryWorksheetPhrase1":"add a sheet","UnsupportedQueryWorksheetPhrase2":"rename the sheet","UnsupportedQueryWorksheetPhrase3":"delete the sheet","UnsupportedQueryFreezePanePhrase1":"freeze","UnsupportedQueryFreezePanePhrase2":"lock","PromptMenuSectionTable":"Work with my table","PromptMenuItemAddFormulaColumn":"Add a formula column","PromptMenuItemHighlightData":"Highlight data","PromptMenuItemAnalyzeData":"Analyze this data","PromptMenuItemSortFilter":"Sort and filter data","PromptMenuItemAnalyzeUsingPython":"Python","PromptMenuItemHowCanCopilotHelp":"How can Copilot help?","LearnMoreResponsePrefix":"I can make calculations and help you understand more about your data by working with tables to:","LearnMoreResponseLinkText":"Learn more about Copilot","LearnMoreResponseContentFirst":"Add columns that include formulas for calculating and manipulating data","LearnMoreResponseContentSecond":"Sort, filter, and apply formatting to your table to organize and highlight data","LearnMoreResponseContentThird":"Find insights like trends, summaries, and comparisons","SuggestionPillAnotherColumnSuggestion":"Give me another column suggestion","SuggestionPillCreateColumn":"Create a \'{0}\' column","SuggestionPillPromptBasedAnotherSuggestion":"Give me another suggestion based on my prompt","SuggestionPillSeeInsight":"Can I see another insight?","SuggestionPillAddInsights":"Add all insights to grid","SuggestionPillOutliers":"Are there any outliers in my data?","SuggestionPillCompareColumns":"Add a column to compare \'{0}\' and \'{1}\'","SuggestionPillBoldColumn":"Bold the first column","SuggestionPillHowMany":"How many \'{0}\' of \'{DataFromColCell-0}\'?","SuggestionPillCombineColumns":"Add a column that combines \'{0}\' and \'{1}\'","SuggestionPillHighlightHighest":"Highlight the highest values in \'{0}\'","SuggestionPillShowItems":"Show items with \'{0}\' of \'{DataFromColCell-0}\'","SuggestionPillBold":"Bold the top 10 values in \'{0}\'","SuggestionPillSortColumn":"Sort \'{0}\' from smallest to largest","SuggestionPillInsights":"Give me insights on my data","SuggestionPillUpdatedInsights":"Give me updated insights on my data","SuggestionPillInsights2":"Show data insights","SuggestionPillUpdatedInsights2":"Show updated data insights","SuggestionPillShowPivotTables":"Show PivotTables","SuggestionPillAnotherPivotTable":"Can I see another PivotTable?","SuggestionPillShowCharts":"Show charts","SuggestionPillAnotherChart":"Can I see another chart?","SuggestionPillHighlightFilterSort":"How can I highlight, filter, and sort data?","HintCardAnalyzeDataSuggestionHeader":"Find trends, summaries, and insights","HintCardAnalyzeDataSuggestionMessage1":"For example, \\"Plot sales by category over time\\"","HintCardAnalyzeDataSuggestionMessage2":"For example, \\"Show total sales for each product\\"","HintCardAnalyzeDataSuggestionMessage3":"For example, \\"Plot the total units sold by category over time\\"","HintCardAnalyzeDataSuggestionMessage4":"For example, \\"Identify the highest month for sales in 2022\\"","HintCardAnalyzeDataSuggestionMessage5":"For example, \\"Identify the lowest price for each product in 2022\\"","HintCardMoonshotSuggestionHeader":"Quickly get new data using formulas","HintCardMoonshotSuggestionMessage1":"For example, \\"Add a column that calculates profit per marketing campaign\\"","HintCardMoonshotSuggestionMessage2":"For example, \\"Add a column that calculates the number of days after the product launch\\"","HintCardMoonshotSuggestionMessage3":"For example, \\"Add a column that tells me which reviewers left notes\\"","HintCardMoonshotSuggestionMessage4":"For example, \\"Add a column that calculates the ratio of the park boundary area to the total area of each park\\"","HintCardFormatDataSuggestionHeader":"Change the data\'s format and view","HintCardFormatDataSuggestionMessage1":"For example, \\"Bold the top 10 values in the Sales column\\"","HintCardFormatDataSuggestionMessage2":"For example, \\"Highlight the highest values in Units Sold\\"","HintCardFormatDataSuggestionMessage3":"For example, \\"Hide rows that are past due\\"","HintCardFormatDataSuggestionMessage5":"For example, \\"Filter to only show products made in Canada\\"","StopGeneratingResponse":"OK, I stopped working on your prompt.","StopGeneratingResponseTableExplain":"OK, I stopped working on your question. If you want to analyze, I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to Insert in the ribbon, and then select Table).","FluxWorkflowCancelledMessage":"My query was cancelled.","FluxWorkflowSucceededMessage":"I succeeded in my task.","FluxWorkflowFailedMessage":"I failed in my task.","FluxWorkflowColumnRecommendation":"I suggested adding a column named {0} that uses the formula, {1}, to calculate the results.","AnalyzeDataResponseTextInsights":"Here\'s a {0} that shows an insight about your data.","AnalyzeDataResponseTextSpecificAnswer":"Here\'s a {0} based on your prompt.","AnalyzeDataResponseTextNotFullyUnderstood":"This {0} may include some of the information you\'re looking for. If it doesn\'t show everything you requested, try another prompt.","AnalyzeDataResponseTextNotFullyUnderstoodEmptyAnswer":"I looked through your data for this criteria: {0}. There were no matches. If you want to try again, use another prompt.","AnalyzeDataResponseTextEmptyAnswer":"I looked through your data for this criteria: {0}. There are no matches.","CardTypeChart":"chart","CardTypePivotChart":"PivotChart","CardTypePivotTable":"PivotTable","CardTypeFormula":"formula","MapChartType":"a Map Chart","ScatterChartType":"a Scatter Chart","ClusteredComboChartType":"a Clustered Combo Chart","StackedComboChartType":"a Stacked Combo Chart","HundredPercentComboChartType":"a Hundred Percent Combo Chart","FunnelChartType":"a Funnel Chart","TreemapChartType":"a Treemap Chart","SunburstChartType":"a Sunburst Chart","ColorFilledMapChartType":"a Color Filled Map Chart","CircularTreemapChartType":"a Circular Treemap Chart","HeatMapChartType":"a Heat Map Chart","WaterfallChartType":"a Waterfall Chart","RoseChartType":"a Rose Chart","NetworkMapChartType":"a Network Map Chart","SmoothLineChartType":"a Smooth Line Chart","ComboChartType":"a Combo Chart","LineChartType":"a Line Chart","PieChartType":"a Pie Chart","DonutChartType":"a Donut Chart","AreaChartType":"an Area Chart","StackedAreaChartType":"a Stacked Area Chart","HundredPercentStackedAreaChartType":"a Hundred Percent Stacked Area Chart","ClusteredBarChartType":"a Clustered Bar Chart","StackedBarChartType":"a Stacked Bar Chart","HundredPercentStackedBarChartType":"a Hundred Percent Stacked Bar Chart","ClusteredColumnChartType":"a Clustered Column Chart","StackedColumnChartType":"a Stacked Column Chart","HundredPercentStackedColumnChartType":"a Hundred Percent Stacked Column Chart","UndefinedChartType":"that type of chart","SampleColumnHeaderCampaignOwner":"Campaign Owner","SampleColumnHeaderCampaignName":"Campaign Name","SampleColumnHeaderLaunchDate":"Launch Date","SampleColumnHeaderCampaignType":"Campaign Type","SampleColumnHeaderBudget":"Budget","SampleColumnHeaderRevenue":"Revenue","SampleColumnHeaderTotalUsersTargeted":"Total Users Targeted","SampleColumnHeaderEngagedUsers":"Engaged Users","SampleDataTextLateJanEmail":"Late Jan Email","SampleDataTextBillboardsSmall":"Billboards small","SampleDataTextBillboardsLarge":"Billboards large","SampleDataTextProductReview3x":"Product review 3x","SampleDataTextTargetedGroup1":"Targeted - Group 1","SampleDataTextIndustryConference":"Industry Conference","SampleDataTextTargetedGroup2":"Targeted - Group 2","SampleDataTextFebEmailNorth":"Feb email - North","SampleDataTextFebEmailSouth":"Feb email - South","SampleDataTextFebEmailWest":"Feb email - West","SampleDataTextProductMention5x":"Product mention 5x","SampleDataTextDigitalMarketing":"Digital marketing","SampleDataTextBrandMarketing":"Brand marketing","SampleDataTextCustomerExperience":"Customer Experience","TableSummaryGeneralNoResults":"Sorry, I can\'t summarize this table. Try again with some different data.","TableSummaryGeneralInsertFailed":"Sorry, I couldn\'t insert the comment.","TableSummaryInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert this comment. Unprotect this sheet for a moment and try again.","CalculatedColumnsFailureGeneral":"I\'m having trouble working on prompts right now. Try sending your prompt later.","CalculatedColumnsGeneralNoResults":"I can\'t generate any column suggestions right now. Try adding more columns or rows to the table.","CalculatedColumnsNLNoResults":"I need more information to start working on your request. Use these tips to write a new request:","CalculatedColumnsNLMultipleColumns":"I can only add one column at a time. Try again with a request about one column.","CalculatedColumnsNLNoResultSuggestionIdentifyColumnAndTable":"Mention specific columns or tables you want me to use.","CalculatedColumnsNLNoResultSuggestionIdentifyColumn":"Mention specific columns you want me to use.","CalculatedColumnsNLNoResultSuggestionCreateColumn":"State specific calculations you want me to do.","CalculatedColumnsTimeout":"Something went wrong. Try your formula column request again later.","CalculatedColumnsInsertFailedDeleteConflict":"I\'m working to insert the column, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedColumnsInsertFailedConflict":"I can\'t add the new column because there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedColumnsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert any formula columns. Unprotect this sheet for a moment and try again.","CalculatedColumnsInsertFailedTableNotFound":"I can\'t insert any formula columns because it looks like no table is selected. Double check to make sure a table is selected and try again.","CalculatedColumnsInsertFailedGeneral":"I\'m having trouble inserting formula columns right now. Try sending your prompt later.","MultipleCalculatedColumnsInsertFailedConflict":"I\'m working to insert the columns, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","MultipleCalculatedColumnsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert these columns. Unprotect this sheet for a moment and try again.","MultipleCalculatedColumnsInsertFailedTableNotFound":"I couldn\'t insert the columns. Double check to make sure a table is selected.","MultipleCalculatedColumnsInsertFailedGeneral":"I couldn\'t insert the columns.","MultipleCalculatedColumnsInsertPartiallyFailedConflict":"I can\'t add some of the new columns because there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","MultipleCalculatedColumnsInsertPartiallyFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert some of these columns. Unprotect this sheet for a moment and try again.","MultipleCalculatedColumnsInsertPartiallyFailedTableNotFound":"I couldn\'t insert some of the columns. Double check to make sure a table is selected.","MultipleCalculatedColumnsInsertPartiallyFailedGeneral":"I couldn\'t insert some of the columns.","FormulaSuggestion_PreviewOnGridButton_ShowPreview":"Preview on grid","FormulaSuggestion_PreviewOnGridButton_HidePreview":"Hide from grid","FormulaSuggestion_Description_NotAvailable":"No description available.","FormulaSuggestion_Preview_NotAvailable":"No image available.","FormulaSuggestion_Preview_AriaLabel":"Table preview","CalculatedRowsInsertFailedDeleteConflict":"I\'m working to insert the row, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedRowsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert any rows. Unprotect this sheet for a moment and try again.","CalculatedRowsInsertFailedTableNotFound":"I can\'t insert any formulas because it looks like no table is selected. Double check to make sure a table is selected and try again.","CalculatedRowsNLMultipleRows":"I can only add one formula per column at a time. Edit your prompt accordingly and try again.","CalculatedRowsNLMultipleFormulaTypes":"I can only add one formula type at a time. Try again with a request about one formula type.","CalculatedRowsTimeout":"Something went wrong. Try your request again later.","CalculatedRowsInsertFailedGeneral":"I\'m having trouble inserting rows right now. Try sending your prompt later.","CalculatedRowsConfirmationTextForCell":"Done! I inserted the formula.","CalculatedRowsConfirmationTextForRow":"Done! I inserted the formulas.","CalculatedRowsConfirmationTextForUpdateCell":"Done! I updated the formula.","CalculatedRowsConfirmationTextForUpdateRow":"Done! I updated the formulas.","CalculatedRowsConfirmationTextForCellWithAddress":"Done! I inserted the formula in {0}.","CalculatedRowsConfirmationTextForRowWithAddress":"Done! I inserted the formulas in {0}.","CalculatedRowsConfirmationTextForUpdateCellWithAddress":"Done! I updated the formula in {0}.","CalculatedRowsConfirmationTextForUpdateRowWithAddress":"Done! I updated the formulas in {0}.","LoadingUIAddingCellStep":"Inserting formula...","LoadingUIAddingCellsStep":"Inserting formulas...","LoadingUIAddingCellWithAddressStep":"Inserting formula in {0}...","LoadingUIAddingCellsWithAddressStep":"Inserting formulas in {0}...","LoadingUIAddingCellUpdateWithAddressStep":"Updating formula in {0}...","LoadingUIAddingCellsUpdateWithAddressStep":"Updating formulas in {0}...","LoadingUIGeneratingFormulaRowSuggestionsStep":"Generating formula suggestions...","LoadingUIGeneratingFormulaRowSuggestionsTLRStep":"Generating formula suggestions for {0}...","CalculatedRowsShowMorePill":"Give me another row suggestion","CalculatedRowsInsertCellTitle":"Insert cell","CalculatedRowsInsertRowTitle":"Insert row","CalculatedRowsUpdateCellTitle":"Update cell","CalculatedRowsUpdateRowTitle":"Update row","CalculatedRowsFormulaSuggestionHeader":"Here\'s 1 formula to review and insert:","CalculatedRowsCellHeader":"cell {cellAddress}","CalculatedRowsRowHeader":"row {rowNumber}","CalculatedRowsFormulaSuggestionHeaderSingular":"Looking at {tableRange}, here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPlural":"Looking at {tableRange}, here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaTotalHeader":"Total","CalculatedRowsFormulaSuggestionHeaderUpdateSingular":"Looking at {tableRange}, here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePlural":"Looking at {tableRange}, here are {formulasLength} formulas to review and update in {location}:","FormulaExplanation_ShowExplanationButton":"Show explanation","FormulaExplanation_HideExplanationButton":"Hide explanation","CodeSnippetWithExplanation_ExplanationButton_Show":"Show explanation","CodeSnippetWithExplanation_ExplanationButton_Hide":"Hide explanation","CodeSnippetWithExplanation_ExplanationNotAvailable":"No explanation available","CodeSnippetWithExplanation_AriaLabel":"Code snippet","TableSummaryText":"Describe my data","CalculatedColumnsGeneral":"Show suggestions for formula columns","CalculatedColumnsGeneralSingular":"Show a suggestion for a formula column","AddAsCommentText":"Add as comment","UnsupportedOperationMessage":"I\'m not able to work on that. Try a new prompt or use a suggested one for ideas.","AugloopResponseTimeoutMessage":"Sorry, I\'m having some trouble right now. Try reopening the chat or sending your prompt a bit later.","AugloopErrorOTE":"I\'m still working to support other languages. For now, please try your prompt again in English.","AugloopErrorUnsupportedLanguage":"I\'m still working to support this language. For now, please try your prompt again in English or another supported language.","ChatSuggestionHeader":"Here\'s what I can do with data selected in Excel tables:","ChatSuggestionAddColumns":"Add formula columns","ChatSuggestionHighlight":"Highlight","ChatSuggestionFilterAndSort":"Filter and sort","ChatSuggestionAnalyze":"Analyze","DialogSheetUnsupportedTitle":"This workbook has a dialog sheet","DialogSheetUnsupportedMessage":"I can\'t work on files that contain dialog sheets. If you delete the dialog sheet and reopen the workbook or open a workbook without a dialog sheet, I can help you explore your data.","FileLocationUnsupportedTitle":"Unsupported file location","FileLocationUnsupportedMessage":"I only work with files saved to OneDrive or Microsoft 365 SharePoint locations with AutoSave turned on. Save the file to a supported location to continue.","ChatSuggestionFooterText":"Describe what you\'d like help with, or use one of the suggestions to get started.","DashboardSourceDataLabel":"PivotTable sources for charts","UndoScopeName":"Copilot Action","AugloopSessionClosedTitle":"Something went wrong","AugloopSessionClosedDesktopMessage":"Sorry, I\'m having some trouble right now. Restart Excel and try sending the prompt again.","AugloopSessionClosedWebMessage":"Sorry, I\'m having some trouble right now. Try refreshing the webpage.","TableHelpLinkText2":"Excel tables","ZeroQueryHeader":"Select an option to learn how I can work with your data in Excel tables:","ZeroQueryHeaderAsk":"Ask Copilot","ZeroQueryFormulaTitle":"Add formula columns","ZeroQueryFormulaMessage":"I can quickly add new columns with formulas. Select a suggested prompt, or describe what columns you\'d like to add.","ZeroQueryHighlightingTitle":"Highlight","ZeroQueryHighlightingMessage":"Need to highlight portions of data? I can help with that! Select a suggested prompt, or describe what you\'d like to highlight.","ZeroQuerySortFilterTitle":"Sort and filter","ZeroQueryFilterSortMessage":"I can sort and filter data to keep things organized. Select a suggested prompt, or describe what you\'d like to do.","ZeroQueAnalyzingTitle":"Analyze","ZeroQueAnalyzingMessage":"I can analyze data and show insights in charts and PivotTables. Select a suggested prompt, or describe what you\'d like to know.","ZeroQueryInsightsTitle":"Summarize using PivotTables or charts","ZeroQueryFormulaActionTitle":"Suggest a formula column","ZeroQueryHighlightActionTitle":"Highlight all cells with [incomplete in red]","ZeroQuerySearchTitle":"Create a table for my recent emails about [sales targets]","ZeroQueryHowToSumTitle":"How do I sum values based on [criteria]","ZeroQueryDataShapingText":"Prepare data for analysis","ZeroQueryDataShapingHeader":"Data Preparation","ZeroQuerySuggestAColumnTitle":"Suggest a column","ZeroQuerySuggestAColumnMessage":"Suggest a formula column for my data","ZeroQueryWriteAFormulaTitle":"Write a formula","ZeroQueryWriteAFormulaMessage":"Write a formula that...","ZeroQueryAddAFormulaColumnTitle":"Add a formula column","ZeroQueryAddAFormulaColumnMessage":"Add a column that...","ZeroQueryExplainAFormulaTitle":"Explain a formula","ZeroQueryExplainAFormulaMessage":"Explain this formula: [paste formula here]","ZeroQueryInvestigateErrorTitle":"Investigate error","ZeroQueryInvestigateErrorMessage":"Investigate why this has an error: [paste formula here]","ZeroQuerySplitColumnsTitle":"Split columns","ZeroQuerySplitColumnsMessage":"Write a formula that creates new columns by splitting [column A]","ZeroQueryCombineColumnsTitle":"Combine columns","ZeroQueryCombineColumnsMessage":"Combine [column A and B] with a space","ZeroQueryCreateTotalRowTitle":"Create a total row","ZeroQueryCreateTotalRowMessage":"Create a row that calculates column [averages]","ZeroQueryWriteLookupFormulaTitle":"Write a lookup formula","ZeroQueryWriteLookupFormulaMessage":"Write a formula that combines two tables together by matching [product ID]","ZeroQueryGetDataInsightsTitle":"Get data insights","ZeroQueryGetDataInsightsMessage":"Give a unique data insight using Python","ZeroQueryAdvancedAnalysisTitle":"Advanced analysis","ZeroQueryAdvancedAnalysisMessage":"Get deeper analysis results using Python","ZeroQueryPerformForecastingTitle":"Perform forecasting","ZeroQueryPerformForecastingMessage":"Perform forecasting using Python","ZeroQueryCreateBoxplotTitle":"Create a boxplot","ZeroQueryCreateBoxplotMessage":"Create a boxplot of this data using Python","ZeroQuerySetOfChartsTitle":"Set of charts","ZeroQuerySetOfChartsMessage":"Create a set of charts using Python","ZeroQueryGenerateWordCloudTitle":"Generate a word cloud","ZeroQueryGenerateWordCloudMessage":"Generate a word cloud using Python","ZeroQueryCreateATableTitle":"Create a table","ZeroQueryCreateATableMessage":"Create a table comparing planets","ZeroQueryKeyboardShortcutsTitle":"Keyboard shortcuts","ZeroQueryKeyboardShortcutsMessage":"What are 15 intermediate level shortcuts?","ZeroQueryTipsAndTricksTitle":"Tips and tricks","ZeroQueryTipsAndTricksMessage":"What are some tricks for working with dates?","ZeroQueryFreezeColumnTitle":"Freeze column","ZeroQueryFreezeColumnMessage":"How do I freeze one column while scrolling?","ZeroQueryHowDoITitle":"How do I?","ZeroQueryHowDoIUnpivotMessage":"How do I unpivot a table?","ZeroQueryHowDoIDropdownMessage":"How do I create a dropdown menu?","ZeroQueryHowDoIFormulaMessage":"How do I write a formula that [forecasts sales]","ZeroQuerySummarizeColumnTitle":"Summarize column","ZeroQuerySummarizeColumnMessage":"Summarize [column A] in bullet points","ZeroQueryShowDataInsightsTitle":"Show data insights","ZeroQueryShowDataInsightsMessage":"Show a data insight","ZeroQuerySumByCategoryTitle":"Sum by category","ZeroQuerySumByCategoryMessage":"Sum [total revenue] for each [category]","ZeroQueryCreatePivotTableTitle":"Create a PivotTable","ZeroQueryCreatePivotTableMessage":"Create a PivotTable grouped by [category]","ZeroQueryCreatePieChartTitle":"Create a pie chart","ZeroQueryCreatePieChartMessage":"Create a pie chart for my data","ZeroQueryGenerateAGraphTitle":"Generate a graph","ZeroQueryGenerateAGraphMessage":"Generate a graph of [x against y]","ZeroQueryHighlightDuplicatesTitle":"Highlight duplicates in a column","ZeroQueryHighlightDuplicatesMessage":"Highlight duplicates in [column A]","ZeroQueryHighlightCellsTitle":"Highlight cells in the table","ZeroQueryHighlightCellsMessage":"Highlight cells in the table that are [complete]","ZeroQueryApplyColorCodingTitle":"Add a color scale to a column","ZeroQueryApplyColorCodingMessage":"Add a color scale to [column A]","ZeroQueryWebSearchCreateTableTitle":"Create a table from web search","ZeroQueryWebSearchCreateTableMessage":"Create a table from web search of the top 15 companies in the S&P 500 and their market caps","ZeroQueryWebSearchTravelTitle":"Create a travel itinerary","ZeroQueryWebSearchTravelMessage":"Create an itinerary from web search in table form for a month trip to Europe","ZeroQueryWebSearchLearnTitle":"Learn in table form","ZeroQueryWebSearchLearnMessage":"Create a table from web search of 15 intermediate level vocab words in Spanish and their translations","ZeroQueryImportTableTitle":"Import table from file","ZeroQueryImportTableMessage":"Import the table from /[file]","ZeroQueryPrepareForMeetingsTitle":"Prepare for my meetings","ZeroQueryPrepareForMeetingsMessage":"Create a table of my meetings next week and to-do items","FluxWorkflowColumnRecommendationPrefix":"I suggested adding a column named {0} that uses the formula,","FluxWorkflowColumnRecommendationSuffix":", to calculate the results.","FluxWorkflowColumnsRecommendation":"I suggested adding the column named {columnName}, that uses the formula {formula}, to the column location {columnLocation} to calculate the results.","FluxWorkflowColumnsNoLocationsRecommendation":"I suggested adding the column named {columnName}, that uses the formula {formula}, to calculate the results.","FluxWorkflowMultipleColumnsRecommendation":"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to the column locations {columnLocations} to calculate the results.","FluxWorkflowMultipleColumnsNoLocationsRecommendation":"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to calculate the results.","ErrorScreenHeader":"We ran into an error.","ErrorScreenInstruction":"Please reopen the Copilot pane to try again.","ErrorScreenReopenButton":"Reopen","CommandingUndoWarningSuffix":"Do you want me to continue?","CommandingUndoWarningActionListHeader":"I am about to perform the following actions that cannot be undone by clicking \\"Undo\\":","CommandingUndoWarningConfirm":"Yes","CommandingUndoWarningReject":"No","CommandingExplanationPrefix":"Done! These are the steps I took:","OfficeJSResponseExplain":"Explain Result","OfficeJSErrorExplanationPrefix":"I couldn\'t complete that task, but here\'s what I tried to do:","OfficeJSExplanationPrefix":"I took the following actions to create the result:","OfficeJSSimpleSuccessResponse":"Done! What else can I help you with?","CopilotLicenseHelpPrefix":"We encountered a problem validating your Copilot license. For more information, see ","CopilotLicenseHelpHeader":"Validate your Copilot License","OfficeScriptRunScriptSuccessPrefix":"I\'ve successfully run \'{0}\' which performed the following steps:","OfficeScriptRunScriptFailPrefix":"I wasn\'t able to successfully run script \'{0}\'.","OfficeScriptSaveScriptSuccessPrefix":"Done! I just saved a script that does the following:","OfficeScriptSaveScriptFailPrefix":"Something went wrong while saving your script.","PromptGuideMenuTitle":"Prompts","PromptGuideMenuSelectionCreate":"Create formulas","PromptGuideMenuSelectionUnderstand":"Understand","PromptGuideMenuSelectionEdit":"Apply color and formatting","OfficeScriptSaveScriptFailPrefixAsk":"Ask","PromptGuideViewMorePrompts":"View more prompts","PromptGuideMenuSectionItemGenerateFormulaColumnSuggestion":"Generate a formula column suggestion","PromptGuideMenuSectionItemAddAColumnThatCombines":"Add a column that combines [the customer\'s first and last name]","PromptGuideMenuSectionItemAddAColumnToExtract":"Add a column to extract [the month from the date]","PromptGuideMenuSectionItemAddAColumnThatCalculates":"Add a column that calculates [the profit per order]","PromptGuideMenuSectionItemShowDataInsights":"Show insights about the data","PromptGuideMenuSectionItemPercentageCalculation":"What is the percentage of [total revenue from each region?]","PromptGuideMenuSectionItemHowManyDifferent":"How many different [teams are represented in this table]","PromptGuideMenuSectionItemWhichItems":"Which items [have the most remaining inventory?]","PromptGuideMenuSectionItemHighlight":"Highlight the [lowest 5 budgets]","PromptGuideMenuSectionItemSort":"Sort [engaged users from smallest to largest]","PromptGuideMenuSectionItemFilter":"Filter by [items from this month]","PromptGuideMenuSectionItemApplyRYG":"Apply a red-yellow-green color scale to [the \'Total\' column]","PromptGuideMenuSectionItemHelp":"How can Copilot help?","MicrophonePermissionErrorTitleWeb":"No Microphone Permission","MicrophonePermissionErrorTextWeb":"Copilot can\'t access your microphone. Click the lock icon in the browser address bar above, set your permissions to allow microphone access, and then try again.","MicrophonePermissionErrorTitleWin32":"Oops, unable to capture your audio","MicrophonePermissionErrorTextWin32":"There is a problem with your microphone. Please check your microphone permission settings.","CommandingFinishedResponseHeader":"Done! I made the following changes:","CommandingHumanInTheLoopApplyingChangesMessage":"Applying changes in {range}...","CommandingHumanInTheLoopSingleChangeResponseMessage":"Done! I made the change in {0}.","CommandingHumanInTheLoopMultipleChangesResponseMessage":"Done! I made the changes in {0}.","CommandingHumanInTheLoopSingleChangeNoRangeResponseMessage":"Done! I made the change.","CommandingHumanInTheLoopMultipleChangesNoRangeResponseMessage":"Done! I made the changes.","CommandingHumanInTheLoopSingleEventHeader":"Sure! Looking at {0}, heres 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeader":"OK! Looking at {0}, here are {1} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeader":"Sure! Looking at {0}, here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeader":"OK! Looking at {0}, here are {1} conditional formatting rules to review and apply:","AnalyzeDataTooLargeError":"This table has over two million cells of data, which is too large for me to analyze. Select a table with less data and try again.","AnalyzeDataTooLargeErrorFourMillion":"This table has over four million cells of data, which is too large for me to analyze. Select a table with less data and try again.","AnalyzeDataCardHeader":"I analyzed data in {0}, and here\'s what I found:","GroundingSourcePrefix":"Using ","GroundingWithDocument":"This workbook","GroundingWithDocumentLabel":"Using this workbook","GroundingWithDocumentDescription":"Ask questions and work with data in a table","GroundingWithEnterpriseData":"Your organization\'s data","GroundingWithEnterpriseDataLabel":"Using your organization\'s data","GroundingWithEnterpriseDataDescription":"Ask questions regarding people and files across your organization","GroundingWithEnterpriseDataDescriptionV2":"Unrelated to working with data in a table, ask questions regarding people and files across your organization.","GroundingSourceInformationTooltip":"In addition to answering general questions, Copilot can respond to requests that pertain either to this workbook or to organizational data, such as files and people\'s contact info.","GroundingSourceInformationTooltipV2":"For general questions and working on your content, use \\"this workbook\\". For questions that pertain to your organization, not related to creating or editing content, use \\"your organization\'s data\\".","GroundingDocToWorkModeSwitchMessage":"I\'m using your organization\'s data to respond to you. Ask me questions regarding people and files across your organization. Note that I won\'t be able to work with your content while I\'m in this mode.","GroundingWorkToDocModeSwitchMessage":"I\'m using this workbook and general knowledge to respond to you. Ask me questions and make requests for working with your data.","PythonInsertCodeActiveSheetButtonText":"Insert","PythonInsertAllCodeActiveSheetButtonText":"Insert all","PythonInsertCodeNewSheetButtonText":"Insert in new sheet","PythonInsertProtectedSheetErrorText":"Looks like this is a password-protected sheet and Python in Excel can\'t automatically insert code into the sheet. Remove the password and try again, but we recommend adding the password back to keep this sheet protected when you\'re done.","PythonInsertProtectedSheetInstructionText":"{0} Unprotect this sheet and try inserting the code again.","PythonLicensingErrorText":"You need to have an active license to use Python in Excel.","PythonPlatformErrorText":"Sorry, Python isnt supported on this platform. Use another platform and try again.","PythonSelectedTableErrorResponseText":"Sorry, I cannot do that. Please select a table you want to work with.","PythonCodeCardBodyText":"Here\'s the Python code you can use:","PythonDataFrameSnippetBodyText":"First, create a DataFrame with your data.","PythonCodeSnippetBodyText":"Then, use this code.","PythonDataFrameCopySuccessText":"Copied! Paste the code in any cell to create a DataFrame.","PythonCodeInsertNewSheetSuccessText":"Done! The code was inserted in a new sheet.","PythonDataFrameAndCodeInsertNewSheetSuccessText":"Done! The DateFrame and code was inserted in a new sheet.","PythonDataFrameAndCodeInsertSameSheetSuccessText":"Done! The DataFrame and code were inserted.","PythonCodeInsertSameSheetSuccessText":"Done! The code was inserted.","PythonCodeCopySuccessText":"Copied! Paste the code in any cell below the selected Python cell.","PythonDataFrameCodeExplanationText":"We create a DataFrame in a variable referencing the Excel table using the xl() function.","PythonGenericErrorText":"Sorry, I\'m having trouble working on this request. Try a new prompt or view the suggested ones for ideas.","PythonDataFrameCodeComment":"Import data into a DataFrame","PythonRestartRuntimeErrorText":"The Python runtime is having issues. In order for me to continue working on your question, go to **Formulas** in the ribbon, and then select **Reset runtime**.","PythonRestartRuntimeFormulaCommandText":"Formulas","PythonRestartRuntimeResetCommandText":"Reset","PythonRestartRuntimeResetRuntimeCommandText":"Reset Runtime","PythonLoadingStartAnalysis":"Starting the analysis...","PythonAugloopResponseTimeoutMessage":"I\'m having trouble working on prompts right now. Try sending your prompt later.","ChatPlaceholderMessagePythonMode":"Type a message for Advanced analysis","ZeroQueryPythonTitle":"Get deeper analysis results using Python","ZeroQueryPythonHeader":"Advanced analysis","StopGeneratingResponsePythonMode":"OK, I stopped working on your question.","PrePythonModeErrorText":"I\'m having trouble running an Advanced analysis. Try your prompt again or try another one.","PythonSelectTableOrPythonCellErrorText":"Looks like an empty grid cell was selected. In order to answer your question, select a range or a Python cell and try your question again.","PythonStartAnalysisEditModeErrorText":"Excel is in cell-editing mode. To start Advanced analysis, exit the mode by selecting **Enter** or **Tab** and try your prompt again.","PythonGenericEditModeErrorText":"Excel is in cell-editing mode. To continue the analysis, exit the mode by selecting **Enter** or **Tab** and try your prompt again.","PythonBusyStateErrorText":"I\'m still working on a previous question. Please wait a moment before sending another one.","PythonAnalysisSheetWasDeletedDuringGenerationErrorText":"It looks like the sheet was deleted while I was generating code. Please send your question again or send a new one to continue.","PythonCodeRetryMaximumHitErrorText":"I\'m having trouble with this Python code, and I can\'t correct it after trying multiple times. You can tell me to try again or use another prompt.","PythonGeneralErrorTextWithLinkOld":"Sorry, a PYTHON error happened with the Python cell that\'s not #PYTHON, #BLOCKED, or #CONNECT. To resolve this issue, review some troubleshooting tips before trying again. {0}.","PythonGeneralErrorTextWithLink":"An error happened with the Python cell that\'s not #PYTHON or #CONNECT. To resolve this issue, review some troubleshooting tips before trying again. {0}.","PythonGeneralErrorLinkText":"View troubleshooting tips","PythonNoSuggestionGenericErrorText":"I\'m having trouble working on this request. Try a new prompt or view the suggested ones for ideas.","PythonCodeRetryResponseText":"A #PYTHON error occurred while I tried to execute the code. I\'m generating new code to continue with the analysis.","PythonCodeRetryResponseWithAddressText":"A {0} error occurred while I tried to execute the code in **{1}**. I\'m generating new code to continue with the analysis.","PythonCodeDefaultErrorMessage":"An error occurred while I tried to execute the code. I\'m generating new code to continue with the analysis.","PythonStartAnalysisHeaderText":"I can use Advanced analysis for that. Here\'s what I\'ll do:","PythonStartAnalysisFirstBulletText":"Create a new sheet for the results","PythonStartAnalysisSecondBulletText":"Automatically write and insert Python formulas","PythonStartAnalysisThirdBulletText":"Answer your prompt in multiple messages","PythonStartAnalysisFourthBulletText":"Calculate formulas, even in manual calculation mode","PythonStartAnalysisButtonText":"Start Advanced analysis","PythonExistAnalysisConfirmationText":"OK, I stopped the Advanced analysis.","PythonStartAnalysisRAIErrorText":"I\'m unable to start Advanced analysis on this sheet.","PythonAnalysisSheetNameText":"Analysis","PythonAnalysisSheetHeaderText":"Advanced analysis","PythonAnalysisSheetDescriptionText":"This sheet will include all Python code generated by Copilot.","PythonAnalysisSheetWasDeletedBeforeGenerationText":"It looks like the sheet was deleted or changed. I made a new one to continue the Advanced analysis.","PythonPostviewHeaderText":"Here\'s what I inserted in {0}:","PythonPostviewLoadingHeaderText":"Here\'s what I\'m loading in {0} to run the analysis:","PythonPostviewNotSupportedText":"Sorry, results for this Python cell aren\'t supported.","PythonShowCodeButtonText":"Show Python Code","PythonHideCodeButtonText":"Hide Python Code","PythonLabelFallbackText":"Python code","PythonDataframeLabelText":"Load data from {0}, {1}","PythonDataframeCodeExplanationText":"The code loads data from {0}, {1}","PythonPreviewLabelText":"Preview","PythonSuggestMoreIdeasPill":"Suggest more ideas","PythonWhatElseCanIDoPill":"What else can I do?","PythonRunningCodeText":"Running code...","ImportDataCardHeaderMultipleTables":"Here are {0} tables to import and sync in the source file:","ImportDataCardHeaderSingleTable":"Here\'s 1 table to import and sync with the source file:","ImportDataStaticSuggestionPillText":"Show tables import options for Excel files","ImportDataStaticSuggestionButtonText":"Show tables to import","ImportDataLoadQueryAddedToDocumentMessageText":"The table has been imported!\\nTo see the latest information, refresh your imported data by selecting \'Data\' in the ribbon, and then \'Refresh\'. ","ImportDataLoadQueryAddedToDocumentMessageNoBindingText":"Import request sent.\\nOnce the table is in the sheet, you can refresh the imported data to get the latest information.                         ","ImportDataShowImportQuery":"Show import query","ImportDataHideImportQuery":"Hide import query","ImportDataImportToNewSheet":"Import to new sheet","ImportDataSuccessButtonText":"Import requested","ImportDataQuerySnippetTitle":"Import query","ImportDataCaruselText":"{0} of {1}","ImportDataExcelFileTooltip":".xlsx file","ImportDataNoTableFoundMessageText":"No tables from the cited files could be imported into the workbook. Open the cited files to manually import the data","ImportDataFailureGeneralMessageText":"Sorry, something went wrong. Try your request again later.","ImportDataShortFailureMessageText":"The table couldn\'t be imported.\\nTry again a bit later.","ImportDataPrepareImportOptions1":"Generating table previews...","ImportDataPrepareImportOptions2":"Almost there...","ImportDataToGridOption1":"Importing table...","ImportDataQueryExplanation":"This query imports data from the selected table to your workbook","LearnMoreLinkText":"Learn more","CommandingTellMeHeader1":"OK, here\'s how:","CommandingTellMeSuggestion1":"To highlight the data, try \\"Bold the top 10 values in the Sales column\\"","CommandingTellMeSuggestion2":"To filter and sort, try \\"Filter to items that are due next week\\"","CommandingTellMeHeader2":"Here are more things you can do:","CommandingTellMeSuggestion3":"To edit table properties, try \\"Add a Total row\\"","CommandingTellMeSuggestion4":"To adjust the number formatting, try \\"Show the Sales column in currency format\\"","CseSelfHelpSkillSourceLabel":"Excel Help","ShowPopupMessage":"Your Microsoft 365 account needs to be verified, but your browser settings are blocking this action. Select {0} to continue.","ShowPopupButton":"Verify","TableUsesTooMuchMemoryError":"I can\'t work on this request because there may be too much content in the table or the number of cells exceed the limit of two million. Reduce the amount of content or cells in the table, and try again.","TableUsesTooMuchMemoryErrorFourMillion":"I can\'t work on this request because there may be too much content in the table or the number of cells exceed the limit of four million. Reduce the amount of content or cells in the table, and try again.","TableUsesTooMuchMemoryError2":"I can\'t work on this question because the content in the table exceeds the maximum memory load. Reduce the amount of content such as formulas, columns, or rows, and try again. You can also select another table with less content before retrying.","ElseFormulaBlocksError":"I\'m not able to do that. Try another request or use a suggested prompt.","ElseSkillGeneralError":"I\'m having trouble answering your question right now. Try again later.","FallbackSkillLatencyMessage":"Still working on suggestions...","AugLoopSearchAndActionError":"I can\'t yet make changes that leverage information from your organization/from the web.","AugLoopSearchAndActionErrorImproved":"I can\'t yet make changes that leverage information from your organization/from the web, but here\'s some information that might help: ","AugLoopNoTableError":"I couldn\'t find a table or data range that answers your question. I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to Insert in the ribbon, and then select Table).","AugLoopNoTableError2":"I couldn\'t find a table or data range that answers your question. I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to **Insert** in the ribbon, and then select **Table**).","TabularRangeUnrecognizedTableError":"I can\'t identify the structure of the data range starting in **{range}**. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeUnrecognizedTableDueToWorkbookSizeError":"Looks like this file has over one million cells or exceeds the amount of content I can work with. Try converting the data range to an Excel table or reducing the content in the workbook and reopen Excel.","TabularRangeRowMajorSingleError":"The headers in data range **{range}** should be in columns, as a single row on top of the data. Ask me how to use the TRANSPOSE() function to switch the format from columns to rows.","TabularRangeRowMajorMultipleError":"The headers should be in columns, as a single row on top of the data. Make sure all headers have different names. To quickly switch the format to columns and rows, ask me how to use the TRANSPOSE() function.","TabularRangeRowMajorErrorHeader":"Place headers in columns","TabularRangeMergedCellsSingleError":"There are merged cells in the data range **{range}**, but data in those cells won\'t be included in my answer. To get accurate results, follow these quick steps:\\n- Go to **Home** in the ribbon, and then select **Merge and Center** to choose the option to unmerge cells.\\n- Copy and paste the data into the unmerged cells.","TabularRangeMergedCellsMultipleError":"There are merged cells in the data range, but data in merged cells won\'t be included in my answer. To get accurate results, follow these quick steps:\\n- Go to **Home** in the ribbon, and then select **Merge and Center** to choose the option to unmerge cells.\\n- Copy and paste the data into the unmerged cells.","TabularRangeMergeCellsErrorHeader":"Unmerge cells","TabularRangeAggregationsSingleError":"It looks like the data range **{range}** may have subsections. I only work with ranges that have a single total row at the bottom, not ones with subtotals or grouped rows. Remove the grouped rows and subtotals and try again.","TabularRangeAggregationsMultipleError":"There may be subsections in the data range. Remove the grouped rows and subtotals.","TabularRangeAggregationsErrorHeader":"Remove grouped rows and subtotals","TabularRangeMultipleHeaderRowsSingleError":"The data range **{range}** has more than one row of headers. I only work with data ranges that have a single row of headers. Consolidate the headers into a single row and try your question again.","TabularRangeMultipleHeaderRowsMultipleError":"There are more than one row of headers. I only work with data ranges that have a single row of headers. Consolidate the headers into a single row.","TabularRangeMultipleHeaderRowsErrorHeader":"Consolidate headers into a single row","TabularRangeNoHeaderColumnsSingleError":"There are no headers in the data range **{range}**. Create a row of headers with different names on the top of the data range and try your question again.","TabularRangeNoHeaderColumnsMultipleError":"There are no headers. Create a row of headers with different names on the top of the data range.","TabularRangeNoHeaderColumnsErrorHeader":"Create a row of headers","TabularRangeInterpretationConfidenceSingleError":"I can\'t identify the structure of the data range starting in **{range}**. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeInterpretationConfidenceMultipleError":"I can\'t identify the structure of the data range. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeInterpretationConfidenceErrorHeader":"Check data structure","TabularRangeEmptyHeadersSingleError":"It looks like some of the headers in the data range **{range}** have empty cells. Make sure all columns have header names and are different before trying your question again. If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**.","TabularRangeEmptyHeadersMultipleError":"It looks like some of the headers have empty cells. Make sure all columns have header names and are different.","TabularRangeEmptyHeadersErrorHeader":"Add header names","TabularRangeDuplicateHeadersSingleError":"It looks like there are headers with identical names in the data range **{range}**. Review and add different header names to each column before trying your question again.","TabularRangeDuplicateHeadersMultipleError":"It looks like there are headers with identical names. Review and add different header names to each column.","TabularRangeDuplicateHeadersErrorHeader":"Add different headers","TabularRangeCrosstabSingleError":"In the data range **{range}**, there are headers in rows and columns. Modify the range to have a single row of headers on top of the data or select another range that fits the criteria before trying your question again. If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**.","TabularRangeCrosstabMultipleError":"There are headers in rows and columns. Modify the range to have a single row of headers on top of the data or select another range that fits the criteria.","TabularRangeCrosstabErrorHeader":"Modify headers to be in a single row","TabularRangeMultipleErrorCardIntro":"In order to answer your question, the data range **{range}** needs some revisions:","TabularRangeMultipleErrorCardConclusion":"Once you\'ve made the recommended changes, try your question again.","TabularRangeMultipleErrorCardConvertToTableConclusion":"If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**. Once you\'ve made the recommended changes, try your question again.","SuggestionPillConditionalFormatting":"Suggest conditional formatting","ConditionalFormattingSuggestionResponse":"Okay! Here are some conditional formatting suggestions for data in {0}","ConditionalFormattingSuggestionResponseError":"Sorry, something went wrong. Try asking for conditional formatting suggestions again later.","ConditionalFormattingSuggestionResponseNoTable":"Sorry, I can\'t find the data I need to generate conditional formatting suggestions. Try selecting the table with your data, then asking for conditional formatting suggestions again.","ConditionalFormattingSuggestionResponseNoSuggestion":"Sorry, I have no suggestions at this time. Try suggest conditional formatting again later.","ConditionalFormattingSuggestionResponseNoSuggestionForRange":"Sorry, I don\'t have any conditional formatting suggestions for data in {0}. Try adding more data or selecting a different table, then asking for conditional formatting suggestions again.","UnsupportedConditionalFormatEntityRangeText":"I\'m sorry, but I can only apply formatting to rows or columns within tables. Try asking me to apply formatting to the whole table instead.","ConditionalFormatFormulaInvalidErrorText":"Sorry, I can\'t create that conditional format rule right now. Is there anything else I can help you with?","ODSLGeneralError":"Sorry, I can\'t do that right now. Try again or select a suggestion.","VariableCacheEntityTypeMismatched":"Sorry, I can\'t modify the entity. Make sure the correct entity is selected and try again.","CFSuggestionAverageAbove":"Highlight cells above average in column \'{Header}\'","CFSuggestionAverageBelow":"Highlight cells below average in column \'{Header}\'","CFSuggestionBlanksBlank":"Highlight cells that are blank in column \'{Header}\'","CFSuggestionBlanksRowLevelBlank":"Highlight rows where \'{Header}\' cells are blank","CFSuggestionBlanksNotBlank":"Highlight cells that are not blank in column \'{Header}\'","CFSuggestionBlanksRowLevelNotBlank":"Highlight cells where \'{Header}\' cells are not blank","CFSuggestionCategorical":"Highlight different unique cell values in different colors in column \'{Header}\'","CFSuggestionCellValueEqualToNumeric":"Highlight cells equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelEqualToNumeric":"Highlight rows when cells are equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueEqualToText":"Highlight cells equal to \'{Text}\' in column \'{Header}\'","CFSuggestionCellValueRowLevelEqualToText":"Highlight rows when cells are equal to \'{Text}\' in column \'{Header}\'","CFSuggestionCellValueNotEqualToNumeric":"Highlight cells not equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelNotEqualToNumeric":"Highlight rows when cells are not equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueNotEqualToText":"Highlight cells not equal to \'{Text}\' in column \'{Header}\'","CFSuggestionCellValueRowLevelNotEqualToText":"Highlight rows when cells not equal to \'{Text}\' in column \'{Header}\'","CFSuggestionCellValueGreaterThan":"Highlight cells greater than {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelGreaterThan":"Highlight rows when cells are greater than {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueGreaterThanOrEqual":"Highlight cells greater than or equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelGreaterThanOrEqual":"Highlight rows when cells are greater than or equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueLessThan":"Highlight cells less than {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelLessThan":"Highlight rows when cells are less than {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueLessThanOrEqual":"Highlight cells less than or equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelLessThanOrEqual":"Highlight rows when cells are less than or equal to {LowerLimit} in column \'{Header}\'","CFSuggestionCellValueBetween":"Highlight cells between {LowerLimit} and {UpperLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelBetween":"Highlight rows when cells are between {LowerLimit} and {UpperLimit} in column \'{Header}\'","CFSuggestionCellValueNotBetween":"Highlight cells not between {LowerLimit} and {UpperLimit} in column \'{Header}\'","CFSuggestionCellValueRowLevelNotBetween":"Highlight rows when cells are not between {LowerLimit} and {UpperLimit} in column \'{Header}\'","CFSuggestionColorScale":"Add a Color Scale to column \'{Header}\'","CFSuggestionContainsTextBeginsWith":"Highlight cells beginning with \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextRowLevelBeginsWith":"Highlight rows when cells begin with \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextEndsWith":"Highlight cells ending with \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextRowLevelEndsWith":"Highlight rows when cells end with \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextContains":"Highlight cells containing \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextRowLevelContains":"Highlight rows when cells contain \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextNotContains":"Highlight cells not containing \'{Text}\' in column \'{Header}\'","CFSuggestionContainsTextRowLevelNotContains":"Highlight rows when cells do not contain \'{Text}\' in column \'{Header}\'","CFSuggestionDataBarGradient":"Add a gradient Data Bar to \'{Header}\' column","CFSuggestionDataBarSolid":"Add a solid Data Bar to \'{Header}\' column","CFSuggestionDuplicatesUnique":"Highlight unique cells in column \'{Header}\'","CFSuggestionDuplicatesRowLevelUnique":"Highlight rows when cells in column \'{Header}\' are unique","CFSuggestionDuplicatesDuplicate":"Highlight duplicate cells in column \'{Header}\'","CFSuggestionDuplicatesRowLevelDuplicate":"Highlight rows when cells in column \'{Header}\' are duplicate","CFSuggestionErrorsWith":"Highlight cells with errors in column \'{Header}\'","CFSuggestionErrorsWithout":"Highlight cells without errors in column \'{Header}\'","CFSuggestionErrorsRowLevelWith":"Highlight rows when cells have errors in column \'{Header}\'","CFSuggestionErrorsRowLevelWithout":"Highlight rows when cells do not have errors in column \'{Header}\'","CFSuggestionFallback":"Highlight cells equal to {Values} in column \'{Header}\'","CFSuggestionIconSet":"Add a {IconId} Icon Set to \'{Header}\' column","CFSuggestionMixedType":"Highlight {Type} values in \'{Header}\' column","CFSuggestionMultiColumnEqualToNumeric":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are equal to {LowerLimit}","CFSuggestionMultiColumnEqualToText":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are equal to \'{Text}\'","CFSuggestionMultiColumnNotEqualToNumeric":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are not equal to {LowerLimit}","CFSuggestionMultiColumnNotEqualToText":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are not equal to \'{Text}\'","CFSuggestionMultiColumnGreaterThan":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are greater than {LowerLimit}","CFSuggestionMultiColumnGreaterThanOrEqual":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are greater than or equal to {LowerLimit}","CFSuggestionMultiColumnLessThan":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are less than {LowerLimit}","CFSuggestionMultiColumnLessThanOrEqual":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are less than or equal to {LowerLimit}","CFSuggestionMultiColumnBetween":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are between {LowerLimit} and {UpperLimit}","CFSuggestionMultiColumnNotBetween":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells are not between {LowerLimit} and {UpperLimit}","CFSuggestionMultiColumnContains":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells contain \'{Text}\'","CFSuggestionMultiColumnBeginsWith":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells start with \'{Text}\'","CFSuggestionMultiColumnEndsWith":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells end with \'{Text}\'","CFSuggestionMultiColumnNotContains":"Highlight cells in \'{TargetColumnHeader}\' when \'{ConditionColumnHeader}\' cells does not contain \'{Text}\'","CFSuggestionPresetDateLastMonth":"Highlight dates from last month in column \'{Header}\'","CFSuggestionPresetDateLastWeek":"Highlight dates from last week in column \'{Header}\'","CFSuggestionPresetDateNextMonth":"Highlight dates for next month in column \'{Header}\'","CFSuggestionPresetDateNextWeek":"Highlight dates for next week in column \'{Header}\'","CFSuggestionPresetDateThisMonth":"Highlight dates from this month in column \'{Header}\'","CFSuggestionPresetDateThisWeek":"Highlight dates from this week in column \'{Header}\'","CFSuggestionPresetDateTomorrow":"Highlight dates that are tomorrow in column \'{Header}\'","CFSuggestionPresetDateToday":"Highlight dates that are today in column \'{Header}\'","CFSuggestionPresetDateYesterday":"Highlight dates that were yesterday in column \'{Header}\'","CFSuggestionPresetDateGreaterThan":"Highlight dates that are after {ThresholdDate} in column \'{Header}\'","CFSuggestionPresetDateLessThan":"Highlight dates that are before {ThresholdDate} in column \'{Header}\'","CFSuggestionPresetDateYear":"Highlight dates that are in the year {Year} in column \'{Header}\'","CFSuggestionPresetDateMonth":"Highlight dates that are in {MonthName} in column \'{Header}\'","CFSuggestionPresetDateMonthJanuary":"Highlight dates that are in January in column \'{Header}\'","CFSuggestionPresetDateMonthFebruary":"Highlight dates that are in February in column \'{Header}\'","CFSuggestionPresetDateMonthMarch":"Highlight dates that are in March in column \'{Header}\'","CFSuggestionPresetDateMonthApril":"Highlight dates that are in April in column \'{Header}\'","CFSuggestionPresetDateMonthMay":"Highlight dates that are in May in column \'{Header}\'","CFSuggestionPresetDateMonthJune":"Highlight dates that are in June in column \'{Header}\'","CFSuggestionPresetDateMonthJuly":"Highlight dates that are in July in column \'{Header}\'","CFSuggestionPresetDateMonthAugust":"Highlight dates that are in August in column \'{Header}\'","CFSuggestionPresetDateMonthSeptember":"Highlight dates that are in September in column \'{Header}\'","CFSuggestionPresetDateMonthOctober":"Highlight dates that are in October in column \'{Header}\'","CFSuggestionPresetDateMonthNovember":"Highlight dates that are in November in column \'{Header}\'","CFSuggestionPresetDateMonthDecember":"Highlight dates that are in December in column \'{Header}\'","CFSuggestionPresetDateEqualTo":"Highlight dates that are equal to {ThresholdDate} in column \'{Header}\'","CFSuggestionTopBottomTop":"Highlight top {Rank} in column \'{Header}\'","CFSuggestionTopBottomBottom":"Highlight bottom {Rank} in column \'{Header}\'","MultipleEventsExecutionErrorText":"I couldn\'t finish your request. If something isn\'t right, use Undo to remove my changes.","ColumnRowOutOfBoundaryErrorText":"I\'m not able to make changes in those cells because they\'re outside of the Excel Table. Try making changes to cells inside of the Excel Table.","UnsupportedCommandIntroductionText":"I need more practice before I can do that. For now, I\'ll share the steps you can follow.","SelectedColumnRowErrorText":"I don\'t currently have a way to know which cells you selected. Please specify the cells, columns, or rows you want me to work with.","ClearSortErrorText":"Sorry, I can\'t remove sorting from the table. Please tell me how you\'d like to sort the table, or make a new request.","NoSupportedNumberFormatCategoriesNumberErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes accounting, currency, fraction, number, percentage, or scientific formatting and try again.","NoSupportedNumberFormatCategoriesDateErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes a date or time format and try again.","NoSupportedNumberFormatCategoriesTextErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes a text, special, date, or time format and try again.","NoSupportedNumberFormatCategoriesOtherErrorText":"Sorry, I can\'t apply conditional formatting to this range. Remove any general, custom, or text formatting for the range and try again.","NumericFilterOnNonNumberErrorText":"Sorry, I can\'t apply a numeric filter (greater than, less than, between, or their negations) to a column that\'s not numeric. Make sure it doesn\'t contain text or true/false data, and try again.","TextualFilterOnNonTextErrorText":"Sorry, I can\'t apply a text filter (begins with, ends with, contains, or their negations) to a column that\'s not textual. Make sure it doesn\'t contain numeric or true/false data, and try again.","DeleteUnexpectedTableRowsErrorText":"Sorry, I can\'t delete the row(s). Is there anything else I can help you with?","DeleteWithInsertColumnsErrorText":"Sorry, I can\'t modify the column(s). Is there anything else I can help you with?","PivotTableChartPresentWithoutTableTLRError":"Currently, I don\'t analyze PivotTables and charts in sheets. I can continue to help if you select the source table and try your question again.","PivotTableChartPresentWithoutTableTLRError2":"To continue analyzing with more prompts, go back to the source table.","PivotTableChartSelectedError":"I don\'t analyze PivotTables or charts in sheets. Select a source table and ask me a question. If you\'d like to keep working with the PivotTable or chart, try asking me how to analyze these objects.","PivotTableChartSelectedErrorHeader":"Continue analysis with a source table","RequestedVisualTypeUnsupportedError":"I can\'t create that type of chart yet, but here are a few steps to follow if you\'d like to try.","UnsupportedAnalysisError":"I can\'t do that just yet, but here are a few steps to follow if you\'d like to try.","NoPatternsFoundError":"I couldn\'t find any insights from your data, but here but here are a few steps to follow if you\'d like to try.","UnsupportedVisualConverterError":"I can\'t share any insights for that data just yet, but here are a few steps to follow if you\'d like to try.","FixItButtonText":"Fix it","TabularRangeAutoFixDuplicateHeadersSuccessfulResponse":"Thanks for changing the header names! You can try your question again.","TabularRangeAutoFixDuplicateHeadersUnsuccessfulResponse":"I couldn\'t fix the duplicate headers. Go to **Insert** in the ribbon, and then select **Table**.","TabularRangeAutoFixMergedCellsSuccessfulResponse":"Thanks for unmerging the cells! You can try your question again.","TabularRangeAutoFixMergedCellsUnsuccessfulResponse":"I couldn\'t unmerge the cells. Go to **Insert** in the ribbon, and then select **Table**.","TabularRangeAutoEmptyHeadersSuccessfulResponse":"Thanks for adding header names to the empty cells! You can try your question again.","TabularRangeAutoEmptyHeadersUnsuccessfulResponse":"I couldn\'t fix the empty headers. Go to **Insert** in the ribbon, and then select **Table**.","NoAutoFixCompleted":"No changes are needed. Try your question again.","TabularRangeAutoFixDuplicateHeaders":"Review and add different header names","HeaderColumnLabel":"Column","HeaderRowLabel":"Row","TlrAutoFixConfirmationMultipleCases":"Thanks for making those changes! Try your question again.","TlrAutoFixUnsuccessful":"I couldn\'t make those changes. Go to **Insert** in the ribbon, and then select **Table**. ","ExplainTablesPill":"Tell me more about Excel tables","ExplainHeadersPill":"What are headers?","ExplainUnmergingCellsPill":"What are the benefits of unmerging cells?","AutoFixIntroduction":"In order to answer your question, the data range in **{range}** needs a revision:","AutoFixMoreThanTwoMergedCells":"Unmerge {count} cells","AutoFixOneMergedCells":"Unmerge cell in {range}","AutoFixTwoMergedCells":"Unmerge cells in {range1} and {range2}","AutoFixMultipleMergedCellsDescription":"Unmerge cells and paste the data","AnalyzeDataInsertErrorMessage":"Sorry, something went wrong. Try again.","InsertedWorksheetName":"Suggestion{0}","InsertedPivotTableName":"PivotTable{0}","NoValueAnswerTextForIdeas":"Based on your question, we didn\'t find a match for the answer in the data.","NoValueAnswerTextForNLInsight":"Based on your question, we didn\'t find any insights that would match the answer.","CopilotUnsupportedlanguageMessage":"Your request includes a language that Copilot doesn\'t currently support. ","CopilotUnsupportedLanguageError":"I don\'t yet support %s. For a list of supported languages, please visit ","CopilotSupportedLanguagesLearnMoreLink":"Supported languages for Microsoft Copilot","FeedbackPrompt":"If you feel I\'m mistaken, please send feedback."}')},7274:e=>{e.exports=JSON.parse('{"ChatContainerKeepItActionButtonText":"Keep it","ChatContainerUndoActionButtonText":"Undo","ChatContainerInsertActionButtonText":"Insert","ChatContainerFeedbackNudgeContent":"Please help us learn and train our models by providing feedback through the thumbs up & down controls for each output the LLM generates.","ChatContainerFeedbackNudgeContentTitle":"Feedback Nudge Content","ChatContainerFeedbackNudgeHeader":"Provide feedback","ChatContainerFeedbackNudgeHeaderTitle":"MICROSOFT INTERNAL ONLY","ChatCardFooterDisclaimer":"AI-generated content may be incorrect","AIGenerated":"AI generated","ChatCardFooterDisclaimerPowered":"AI-powered suggestions may be inaccurate","AIPowered":"AI-powered suggestion","ChatCardSourceStockContent":"From Microsoft 365 content library","ChatCardSourceEnterprise":"From %s brand library","ChatCardSourceDALLE":"Powered by DALL-E 3","ChatInputDefaultPlaceholder":"Choose a starter prompt or type your own","FREHeaderText":"Copilot is here to help","FREButtonText":"Get started","StarterPromptMenuItemDefaultPrefix":"Prompt Guide Menu","ShowMeButtonText":"Show Me","HelpButtonText":"Help","ShowMeChatMessage":"I can\'t pull that info into our conversation at the moment, but you can find \\"$1(commandName)\\" feature in the $2(tabName) tab of the ribbon","ShowMeUpdatedMessage":"You can find the \\"$1(commandName)\\" feature on the $2(tabName) tab of the ribbon, but I can\'t access it directly. Would you like me to show you where it is?","ShowMeErrorMessage":"Sorry, I don\'t know of a way to do that. Try rephrasing your request, or ask me about another feature.","ShowMeUpdatedMessageWithoutAction":"You can find the \\"$1(commandName)\\" feature on the $2(tabName) tab of the ribbon, but I can\'t access it directly.","ChatContainerTitle":"Chat Container","ChatContainerDefaultMessageTitle":"Default Chat Message","ChatContainerListEmbeddedMessageTitle":"List Embedded Chat Message","ChatContainerLinkEmbeddedMessageTitle":"Link Embedded Chat Message","ChatInputTitle":"Prompt area","StarterPromptMenuTitle":"Prompt Guide","SubmitButtonTitle":"Send","FREHeaderTextLabel":"freSharedHeaderText","FREDescriptionTextLabel":"freSharedDescription","HintCardHeaderTextLabel":"hintCardHeaderText","HintCardDescriptionTextLabel":"hintCardDescriptionText","LoadingUiTextLabel":"loadingUiText","ZQMHeaderTextLabel":"zqmHeaderText","ChatMessagesLabel":"Chat Messages","RegenerateButtonLabel":"Regenerate","CopyButtonLabel":"Copy","LikeButtonLabel":"Like","DislikeButtonLabel":"Dislike","SuggestionPaneLabel":"Suggested Prompts","SuggestionPaneRefreshButtonLabel":"Refresh","StopGeneratingButtonLabel":"Stop generating","InputToolTipSuggestion":"Add details like length, tone and, style to finish the prompt","MicrophonPermissionErrorTitle":"No Microphone Permission","MicrophonPermissionErrorText":"Copilot can\'t access your microphone. Click the lock icon in the browser address bar above, set your permissions to allow microphone access, and then try again.","NeedHelpLink":"Need help?","NotNowMicrophoneButton":"Not Now","TryAgainMicrophoneButton":"Try Again","MicrophoneTooltip":"Microphone","MicrophonPermissionErrorTitleWin32":"Oops, unable to capture your audio","MicrophonPermissionErrorTextWin32":"There is a problem with your microphone. Please check your microphone permission settings.","MicrophonePausedStatus":"Microphone Paused","MicrophoneListeningStatus":"Microphone Listening","MicrophoneDisabledStatus":"Microphone Disabled","MicrophoneLoadingStatus":"Microphone Loading","ImagePickerHeader":"Here are {0} possibilities...","ImagePickerInsert":"Added an image.","AddImageButton":"Add an image","PasteImageSuggestion":"Paste image","UploadImageButton":"Upload from this device","UploadImageUnsupportedTypeError":"Unfortunately I can\'t work with that type of image. Please try again with a BMP, JPG, or PNG.","UploadImageFileTooBigErrorFormat":"The size of that image is beyond my {0}MB limit. Please try again with a smaller image.","UploadImageBadContentError":"It looks like there\'s some content here I can\'t work with. Try using a different image.","ChatInputAttachmentAltTextFormat":"Attachment {0}","ImageChatDefaultPrompt":"Describe this image","DesignerDialogHeader":"Designer","DesignerFallbackToStockApologyMessage":"Apologies, I can\'t do this yet. Here are some stock images that match your search that may be useful.","DesignerFallbackToDalleApologyMessage":"Apologies, I can\'t do this yet. Here are some generated images that match your search and may be useful.","ImageInsertionSuccessAnnouncement":"Your image has been inserted.","DesignerBrandImagesNotFound":"I couldn\'t find anything from your brand library matching that description. Try again using different key words or ask me to help with something else.","DesignerBrandLibraryNotConfigured":"It looks like you haven\'t set up a brand library for Copilot yet. Please reach out to your IT admin for access to brand images.","CopilotSwitcherMenuTriggerTitle":"Switch copilots","CopilotPromptLibraryHeader":"Prompts from Copilot Lab","CopilotLabLaunchertext":"See all prompts in Copilot Lab","CopilotLabMenuSubItem":"View more prompts","PromptGuideMenuSectionHeader":"Examples to help you %s","CitationTitleReference":"Reference","CitationTitleReferences":"References","DefaultCIQButtonTitle":"Attach","DefaultGroundingButtonTitle":"Manage search and plugins","DefaultMenuButtonTitle":"View Prompts","DefaultGhostText":"Ask a question or tell me what you want to do. For ideas on how I can help, select the prompt guide.","ErrorOffensiveInputContent":"Sorry, I can\'t work with that. Try making a new request.","ErrorOffensiveOutputContent":"Sorry, I can\'t generate content for this. Try making a new request.","ErrorInputBlockedByDynamicGuardList":"It looks like there\'s some content here I can\'t work with. Try asking me to do something else.","ErrorInvalidSignal":"Something went wrong. Please try again in a moment.","ErrorTimeout":"I can\'t process your request right now. Try again in a little while. ","ErrorThrottled":"The maximum number of requests per hour has been reached. Try again in a little while.","ErrorUserThrottled":"You\'re only allowed a certain number of requests per second. Try again in a little while.","ErrorInputTooLong":"This is too much information for me to process. Try again with a request that\'s less than 15,000 words.","ErrorInvalidLanguage":"Your request includes a language I don\'t currently support.","ChatHistoryHydrationError":"If this is a continuation of an earlier chat and you want chat history, try closing and reopening the pane.","DisengagedError":"Sorry, I can\'t chat about this. To save the chat and start a fresh one, select New chat.","LearnMoreString":"Learn More","CopyButtonPopover":"Copied to clipboard","MicrophoneListeningGhostText":"Listening...","ChangeTopicButtonLabel":"Change topic","ManageChatsButtonLabel":"Manage chats","LoadingUIStringLoadingConversation":"Loading conversation...","LoadingUIStringCreateNewConversation":"Creating a new conversation...","ChatHistoryPanelTitle":"Copilot Chats","ChatHistoryPanelEmptyConversationName":"Empty chat","BackButtonText":"Go back","DeleteAllChatHistoryButtonText":"Delete all Copilot history","NewConversationButtonText":"Create new conversation","NewChatButtonText":"New chat","ShowChatHistoryButtonText":"Chat history","ChatHistoryHeaderAriaLabel":"Copilot chats","ChatHistoryMenuTriggerButtonText":"Open conversation history","EmptyConversationListText":"No previous Copilot chats in this document","ConversationListErrorStateText":"We\'re having trouble showing Copilot chats. Please try again later.","ConversationListErrorStateTitle":"Something went wrong","ChatHistoryBackButtonAriaLabel":"Back home","ChatHistoryNewConversationAriaLabel":"Start new chat","ChatHistoryDeleteAllAriaLabel":"Delete all chat history","ChatHistoryDeleteButtonAriaLabel":"Delete","ChatHistoryPanelAriaLabel":"Recent document chat list","WorkingOnItString":"Working on it...","TopicChangedResponseText":"Ok, let\'s change topics. What would you like to talk about?","DKEAndNotExtractLabelErrorString":"Copilot can\'t reference this content because your organization\'s policy doesn\'t allow it.","BlockingCookiesErrorMessage":"Your browser settings are blocking cookies that are required for Copilot. Please use an alternative browser or Desktop App.","LicenseValidationErrorMessage":"We encountered a problem validating your Copilot license. For more information, see https://aka.ms/copilotlicensecheck","RequestTooLongErrorMessage":"I can\'t help you with this because your description is too long. Please consider shortening your request and try again.","DesignerPreviewLabel":"Designer Preview","CseSelfHelpSkillContentRetrievedMultipleArticles":"Here\'s what I found:","CseSelfHelpSkillContentRetrievedQuickAnswer":"Here\'s what I found:","CseSelfHelpSkillContentRetrievedSingleArticle":"Here\'s what I found:","CseSelfHelpSkillErrorOrNoContentRetrieved":"Sorry, I\'m having trouble finding information about that. Please rephrase your request and try again.","CseSelfHelpSkillLaunchHelpPaneTextArticle":"View Article","LoadingUIStringFinishingUp":"Finishing up...","LoadingUIStringGettingReady":"Getting ready...","LoadingUIStringGettingEverythingReady":"Getting everything ready...","LoadingUIStringCraftingContent":"Crafting your content...","LoadingUIStringFinishingTouches":"Applying the finishing touches...","LoadingUIStringWorkingOnRequest":"Working on your request...","LoadingUIStringGatheringResources":"Gathering resources...","PaneLoadingUIString":"Please wait for the pane to finish loading","GroundingSearchAndPlugins":"Search and plugins","GroundingPluginFlyoutInfoTooltip":"Microsoft 365 enterprise data includes Office applications, SharePoint sites, cloud files, communications, and more. All configured by your IT admin.","GroundingPluginFlyoutInfo":"Plugins allow Copilot to reference apps on your behalf. Copilot may share some of your Microsoft 365 enterprise data with plugins youve turned on.","GroundingPluginFlyoutInfoLabel":"Info","PreviewFlagLabel":"Preview","AdminBlockedPluginInfoTooltipLabel":"The service required to use this plugin is turned off for your organization.","WorkPluginLabel":"Microsoft 365 data","WebContentPluginLabel":"Web content","CIQDefaultPlaceholder":"Start typing to search","ProactiveSuggestionTitleText":"Highlight Data","ProactiveSuggestionIconText":"Idea","ProactiveSuggestionBodyText":"For a more engaging presentation, here\'s a design that might better highlight the stats in your slide.","ProactiveSuggestionApplyBtnText":"Apply","ProactiveSuggestionImageAltText":"proactive suggestion card img","RestrictiveSearchMessageTitleText":"Your organization\'s admin has restricted Copilot from accessing certain SharePoint sites.","RestrictiveSearchMessageBodyText":"This limits the content Copilot can search and reference when responding to your prompts.","ChatInputCharacterLimitExceededMessage":"Character limit exceeded","InActiveChatSessionErrorString":"This chat session has ended. Please close and reopen this app for a new session.","BadTokenErrorMessage":"There was a problem signing you in. Try closing and reopening the Copilot pane, and follow the instructions to sign in.","PersonalizationSuggestionText":"I want to get better responses by creating my Copilot profile.","PersonalizationSuggestionResponse1":"Your Copilot profile should include your instructions to me about how you want me to answer. To create it, type: \'Create my Copilot profile: [followed by your instructions].\'\\n\\n","PersonalizationSuggestionResponse2":"**For example:** \\n\\n**Create my Copilot profile: Include key people, numbers, and dates when answering a question or summarizing a document.**\\n\\n","PersonalizationSuggestionResponse3":"Once you create your profile, I\'ll be able to tailor my responses to you and generate personalized summaries and answers. To update your profile, type \'Update my Copilot profile: [followed by your instructions].\' You can always ask me to delete your profile.\\n\\n","PersonalizationSuggestionResponse4":"This feature is available in Word and PowerPoint in the Inner Ring (Dogfood) environment. Use thumbs up/down to send feedback to Feature Crew.","PromptGuideMenuItemWhatCanCopilotProfileDo":"What can my Copilot profile do?","PromptGuideMenuItemCreateMyCopilotProfile":"Set my Copilot profile: [tell Copilot how to respond to your prompts]","PromptGuideMenuSectionCustomize":"Customize","ErrorBoundaryHeader":"Something went wrong","ErrorBoundaryBody":"Please refresh the Copilot pane to try again.","ErrorBoundaryButton":"Refresh","ErrorBoundaryActionButton":"Copy Error Code","ConfirmButtonLabel":"Confirm","DeleteButtonLabel":"Delete","AssistantStorytellerNERBlockingMessageSentence1Option1":"If you\'d like to add images, I\'ve found some places that might work:","AssistantStorytellerNERBlockingMessageSentence1Option2":"As you review these slides, consider where you\'d like to add images.","AssistantStorytellerNERBlockingMessageSlideListItem":"Slide {0}","AssistantStorytellerNERBlockingMessageSentence2Part1":"To explore images in the ribbon above, select ","AssistantStorytellerNERBlockingMessageSentence2Part2":"Insert tab > Pictures.","PersonalizationProfileErrorResponse":"Sorry, something went wrong. Please try again in a moment or ask me to help with something else.","MeetingSuggestionNotAvailable":"Meeting suggestions aren\'t available","FileSuggestionNotAvailable":"File suggestions aren\'t available","PeopleSuggestionNotAvailable":"People suggestions aren\'t available","EmailSuggestionNotAvailable":"Email suggestions aren\'t available","SignInButtonLabel":"Continue","SignInButtonPopover":"Sign-In","ErrorAuthenticationWithFix":"There\'s a problem with your account or device. Let\'s fix it.","MicrophoneTooltipListening":"Microphone Listening","MicrophoneTooltipPaused":"Microphone Paused","MicrophoneTooltipDisabled":"Microphone Disabled","MicrophoneTooltipLoading":"Microphone Loading","VerifyAccessButtonLabel":"Verify access","VerifyAccessButtonPopover":"Verify access","ClaimChallengeUserMessage":"I have a response for you, but your organization\'s policy requires additional verification to access it.","ClaimChallengeChatMessage":"Your organization\'s policy requires additional verification to access Copilot.","ApplyLabelUnsupportedCrossTenantError":"I can\'t complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored.","ApplyLabelDocumentReadOnlyError":"I can\'t complete this request because this content requires a sensitivity label that cant be applied when a file is read-only.","ApplyLabelInsufficientPermissionError":"I can\'t complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file.","ApplyLabelLabelDisabledError":"I can\'t complete this request because this content requires a sensitivity label that is not available for your account.","ApplyLabelUnsupportedUdpError":"I can\'t complete this request because this content requires a sensitivity label with user-defined permissions.","ApplyLabelLabelingDisabledError":"I can\'t complete this request because this content requires a sensitivity label that is not available for your account.","ApplyLabelUnsupportedContentTypeError":"I can\'t complete this request because this content requires a sensitivity label, and this type of file doesn\'t support sensitivity labels.","ApplyLabelUnsupportedDkeError":"I can\'t complete this request because this content is protected with Double Key Encryption.","ApplyLabelLabelNotFoundError":"I can\'t complete this request because this content requires a sensitivity label that cannot be applied to this file.","OsfControlContainerError":"I can\'t complete this request because there was a problem applying a sensitivity label.","OMWorkflowUserNotFoundError":"I can\'t complete this request because there was a problem applying a sensitivity label.","OMOfficePerpetualNotSupportedError":"I can\'t complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn\'t support sensitivity labels.","LabelingDisabledProtectedViewError":"I can\'t complete this request because this file is in Protected View.","LabelingDisabledAppguardError":"I can\'t complete this request because this file is open in Application Guard.","LabelingDisabledPrivacySettingsError":"I can\'t complete this request because your privacy settings prevent access to content that has a sensitivity label.","LabelingDisabledUnsupportedLabelClientError":"I can\'t complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesnt support sensitivity labels.","LabelingDisabledNoSignedInClpCompatibleUsersError":"I can\'t complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account.","OMOfficeClientNotLicensedForLabelingError":"I can\'t complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account.","OutOfCreditsError":"Unfortunately, I can\'t complete that request because you\'re out of AI credits this month. Your credits will refill at the start of the next month."}')}}]);
//# sourceMappingURL=chunkoffice1js.js.map