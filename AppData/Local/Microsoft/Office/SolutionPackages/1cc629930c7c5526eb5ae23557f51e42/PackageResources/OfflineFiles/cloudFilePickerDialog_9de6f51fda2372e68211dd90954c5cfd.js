var TypeScriptModule;(()=>{"use strict";var e,t,a,n,o,r={17425:(e,t,a)=>{a.d(t,{ky:()=>r,mr:()=>i,w8:()=>o,xk:()=>n});var n="d2eb9fef-f34c-40ec-b6a3-4bf524065158",o={loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",sharepoint:"https://microsoft-my.sharepoint-df.com",onenote:"https://onenote.com",substrate:"https://substrate.office.com/search"},r="6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",i="https://login.microsoftonline.com/common"},77303:(e,t,a)=>{var n,o;a.d(t,{jYE:()=>J,Q6w:()=>ja,qAn:()=>Me,zgk:()=>H,n6d:()=>vt,eU_:()=>$a,QAh:()=>Ua,TzT:()=>n,I51:()=>Ja,FcJ:()=>Ha,DYx:()=>ye,_sV:()=>oe,G41:()=>Ia.G,DLk:()=>ia,RkY:()=>Pe,Yj6:()=>Ra,T$y:()=>Ba,dDr:()=>ve,xkN:()=>G.xk,utd:()=>_,$nm:()=>be,$9t:()=>fe,gcB:()=>Vt,oRj:()=>At,NnE:()=>le,piD:()=>de,YwR:()=>wt,yu7:()=>Rt,Q9t:()=>Et,Ne4:()=>ae,IdZ:()=>ee,Hrz:()=>_e,tO0:()=>va,Ebk:()=>Lt,qHb:()=>It,QF0:()=>Za,v5s:()=>an,BIF:()=>Da,aWC:()=>mt,Zl2:()=>Se,jPo:()=>Ne,Us6:()=>we,b_z:()=>ge,YPU:()=>T,OzJ:()=>rn,h7k:()=>ue,k$4:()=>me,zic:()=>he,LJF:()=>pe,lqj:()=>La,Un9:()=>ka,fQe:()=>Na,Qk5:()=>Ea}),function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(n||(n={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(o||(o={}));var r,i,l,s,c,d,u,m,g,h,p,b,f,C,y=void 0,v=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a]},T=function(e,t,a,n){y=e,v=t,r=a,i=n};!function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(l||(l={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.MsgExtTaskModule="MsgExtTaskModule"}(s||(s={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(c||(c={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response"}(d||(d={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode"}(u||(u={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat"}(m||(m={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(g||(g={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile"}(h||(h={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(p||(p={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(b||(b={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(f||(f={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(C||(C={}));var x=a(22330),S=(function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}e.getInstance=function(){return Z(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=(0,x.WU)(this.personalizationHITLCardActivationTime)}}(),"AugLoopChat".concat(y)),w=function(){function e(){}return e.generateId=function(){return e.operationId++,S+e.operationId.toString()},e.operationId=0,e}(),E=function(e,t){var a;r.sendErrorTelemetry(I(((a={})[u.ErrorMessage]="".concat(e),a[u.ErrorCategory]=s.CLP,a[u.ErrorCode]=t,a)))},R=function(e){var t;r.sendChatEventTelemetry(I(((t={})[c.ChatEventType]=d.OfficeJsApiCallForCLP,t[c.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},I=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};var A=function(e){return e||(e=m.CopilotChat),JSON.stringify({featureName:e})};function L(e){r.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function F(e,t){return e+" "+t}var _,N,k,O,P,M,D,$,B,H,U,q,V=function(e){var t;r.sendChatEventTelemetry(I(((t={})[c.ChatEventType]=d.MsgExtDataReceived,t[c.ChatEventParameters]=e.toString(),t)))},G=a(17425),W=a(58651),z=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Q=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},J=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return z(this,void 0,void 0,(function(){var e,t,n;return Q(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,a.e("vendors~auth-msal-browser").then(a.bind(a,89761))];case 3:return t.msalModule=o.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(n=o.sent(),W.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),n),3===e)throw n;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createPublicClientApplication=function(e){var t,a;return z(this,void 0,void 0,(function(){var n,o;return Q(this,(function(r){return n=null!==(a=null===(t=this.params)||void 0===t?void 0:t.clientId)&&void 0!==a?a:G.ky,o=this.params.redirectUri,[2,new e({auth:{clientId:n,authority:G.mr,redirectUri:new URL(o,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t){var a;return z(this,void 0,void 0,(function(){var t,n,o,i,l;return Q(this,(function(s){switch(s.label){case 0:return v("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:s.sent(),s.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=s.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(a=this.params)||void 0===a?void 0:a.logTelemetry)&&r.sendChatEventTelemetry(I(((l={})[c.ChatEventType]=d.MSALTokenRequested,l))),n=void 0,s.label=4;case 4:return s.trys.push([4,10,,14]),[4,t.initialize()];case 5:return s.sent(),0!==(null==(o=t.getAllAccounts())?void 0:o.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,s.sent()];case 7:return[4,this.getSelectedAccount(o,t)];case 8:if(!(n=s.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,n,t)];case 9:return[2,s.sent()];case 10:return i=s.sent(),v("Failed to get access token: ".concat(null==i?void 0:i.message)),this.msalModule&&i instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,n,t)]:[3,12];case 11:return[2,s.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),i;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getSelectedAccount=function(e,t){var a;return z(this,void 0,void 0,(function(){var n,o,r,i=this;return Q(this,(function(l){switch(l.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(r=l.sent())?void 0:r.account];case 2:if(!e||0===e.length)return[2,null];if(n=this.params?null!==(a=e.find((function(e){var t,a,n;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(n=null===(a=i.params)||void 0===a?void 0:a.userPrincipalName)||void 0===n?void 0:n.toLowerCase())})))&&void 0!==a?a:null:e[0],n)return[2,n];o=this.params?{loginHint:this.params.userPrincipalName}:void 0,l.label=3;case 3:return l.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(o),[4,this.loginPopupPromise];case 4:return[2,null==(r=l.sent())?void 0:r.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){var a;return z(this,void 0,void 0,(function(){var n,o;return Q(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],loginHint:null===(a=this.params)||void 0===a?void 0:a.userPrincipalName},[4,t.ssoSilent(n)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenSilent=function(e,t,a){return z(this,void 0,void 0,(function(){var n,o;return Q(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],account:t},[4,a.acquireTokenSilent(n)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenPopup=function(e,t,a){return z(this,void 0,void 0,(function(){var n,o;return Q(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],account:t},[4,a.acquireTokenPopup(n)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,o]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,a;(null===(a=this.params)||void 0===a?void 0:a.logTelemetry)&&r.sendErrorTelemetry(I(((t={})[u.ErrorCategory]=s.MSAL,t[u.ErrorMessage]=e,t)))},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(_||(_={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(N||(N={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(k||(k={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(O||(O={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(P||(P={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(M||(M={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(D||(D={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}($||($={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(B||(B={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(H||(H={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(U||(U={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(q||(q={}));var j=a(15120),Y=a(62388),X=a(29181),K=function(){return K=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},K.apply(this,arguments)};function Z(e){return null==e}var ee=function(e,t,a,n){var o=t!==O.defaultWhite?K({isDarkModeEnabled:!0,isHighContrastModeEnabled:a},(0,j.W)(e)):K({isDarkModeEnabled:!1,isHighContrastModeEnabled:a},(0,Y.a)(e));return o.dir=n,o};var te=function(){return"undefined"!=typeof OfficeaicopilotStrings},ae=function(e){var t,a,n,o;if(!Z(e))return v("Chat Message header received in response chatMessageHeaderType: ",e.chatMessageHeaderType),e.chatMessageHeaderType===X.Hu.Personalization_Indicator&&(v("Personalization header received in response"),r.sendChatEventTelemetry(I(((t={})[c.ChatEventType]=d.PersonalizationIndicatorShown,t[c.IsPersonalizedResponse]=!0,t))),r.sendLatencyTelemetry(I(((a={})[l.IsPersonalizedResponse]=!0,a)))),{titleText:null!==(n=null==e?void 0:e.title)&&void 0!==n?n:"",popoverText:null!==(o=null==e?void 0:e.expandedTitle)&&void 0!==o?o:void 0}};var ne,oe,re=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ie=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},le=function(){return re(void 0,void 0,void 0,(function(){var e,t;return ie(this,(function(a){switch(a.label){case 0:if(!Ie()&&!Re())return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,OfficeFirstParty.PrivateApi.execute("SHOW_COPILOT_PRODIGY_UPSELL_FLOW")];case 2:return e=a.sent(),v(e),[3,4];case 3:return t=a.sent(),v("Error Executing SHOW_COPILOT_PRODIGY_UPSELL_FLOW"+t),[3,4];case 4:return[3,7];case 5:return[4,Office.license.launchUpsellExperience("copilotsidepanel_creditlimit")];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},se=a(27379),ce=a(98483),de=function(e){if(/^data:image\/[a-zA-Z]+;base64,/.test(e)){for(var t=e.split(",")[1],a=atob(t),n=new Uint8Array(new ArrayBuffer(a.length)),o=0;o<a.length;o++)n[o]=a.charCodeAt(o);var r=function(e){return e.startsWith("data:image/png")?{format:se.f.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:se.f.Jpg}:e.startsWith("data:image/bmp")?{format:se.f.Bmp}:{format:se.f.Other,otherFormat:e.split(";")[0].split(":")[1]}}(e),i=r.format,l=r.otherFormat;return{contents:[{id:(0,ce.A)(),size:se.h.Unspecified,format:i,otherFormat:l,data:Array.from(n),sizeBytes:n.length}],widthPx:0,heightPx:0}}},ue=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],me=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],ge=["ar-SA","he-IL"],he=["ca-ES","cy-GB"],pe=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],be=["ar-SA","fa-IR","he-IL","ug-CN","ur-PK"],fe=["af-ZA","am-ET","ar-SA","as-IN","az-Latn-AZ","bg-BG","bn-IN","bs-Latn-BA","ca-ES","ca-Es-VALENCIA","cs-CZ","cy-GB","da-DK","de-DE","el-GR","en-GB","en-US","es-ES","es-MX","et-EE","eu-ES","fa-IR","fi-FI","fil-PH","fr-CA","fr-FR","ga-IE","gd-gb","gl-ES","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","hy-AM","id-ID","is-IS","it-IT","ja-JP","ka-GE","kk-KZ","km-KH","kn-IN","ko-KR","kok-IN","lb-LU","lo-LA","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-MY","mt-MT","nb-NO","ne-NP","nl-NL","nn-NO","or-IN","pa-IN","pl-PL","pt-BR","pt-PT","quz-PE","ro-RO","ru-RU","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv-SE","ta-IN","te-IN","th-TH","tr-TR","tt-RU","ug-CN","uk-UA","ur-PK","uz-Latn-UZ","vi-VN","zh-CN","zh-TW"],Ce=(ne=function(e,t){return ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},ne(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}ne(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t}(function(e){function t(t,a){var n=e.call(this,a)||this;return n.name=t,n}return Ce(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(oe||(oe={}));var ve=function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.supportedLanguages=[]}return Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var a=1;a<t.length-1;a++)t[a]=t[a].charAt(0).toUpperCase()+t[a].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),a=0;a<this.supportedLanguages.length;a++){var n=this.supportedLanguages[a];if(t[0]===n.split("-")[0])return n}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new ye(oe.InvalidInput," Display Language is undefined or null");var a=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(a),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=ue,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(me),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(ge))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(pe)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(he))},e}(),Te=a(8520),xe=a(58651),Se=function(e,t,a){return void 0===a&&(a=3),(0,Te.lazy)((function(){return new Promise((function(n,o){var r=0,i=function(){e().then((function(e){return n(e)})).catch((function(e){++r>=a?o(e):(xe.error("Error in lazy loading package ".concat(t),e),i())}))};i()}))}))};var we=new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0}),Ee=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e}(),Re=(Ee.isWebPlatform,Ee.isMacPlatform),Ie=Ee.isIOSPlatform,Ae=a(69290),Le=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Fe=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},_e=(function(){function e(){this.apiHandlers=new Map}e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return Le(this,void 0,void 0,(function(){var e,t=this;return Fe(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){return Le(t,void 0,void 0,(function(){var t,a,n;return Fe(this,(function(o){v("PrivateApi event: "+e),t=!1;try{a=JSON.parse(e)}catch(e){a=null}return(null==a?void 0:a.eventName)&&(n=this.apiHandlers.get(a.eventName))&&(n(a),t=!0),t||v("Could not dispatch PrivateApi event"),[2]}))}))}))];case 1:return a.sent(),[3,3];case 2:return e=a.sent(),v("Error initializing PrivateApi: "+e),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return Le(this,void 0,void 0,(function(){var e;return Fe(this,(function(t){return e={dispidMethod:2001},this.execute(e),[2]}))}))},e.prototype.execute=function(e){return Le(this,void 0,void 0,(function(){return Fe(this,(function(t){switch(t.label){case 0:return[4,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))];case 1:return t.sent(),[2]}}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&v("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)}}(),function(e){if(e&&e.appType===Ae.b.MessageExtension)return[{id:"CopilotPlugins.".concat(e.appType,".").concat(e.appId),source:"MOS3"}]}),Ne=function(){var e,t=tt;null===(e=null===window||void 0===window?void 0:window.open)||void 0===e||e.call(window,t,"_blank","noopener,noreferrer")};var ke="",Oe="shimmer",Pe=2e3,Me="3068386c-7a16-4f6a-a664-043b6b232816",De=function(){return te()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},$e=function(){return te()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that canâ€™t be applied when a file is read-only."},Be=function(){return te()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},He=function(){return te()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},Ue=function(){return te()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},qe=function(){return te()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},Ve=function(){return te()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},Ge=function(){return te()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},We=function(){return te()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},ze=function(){return te()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},Qe=function(){return te()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},Je=function(){return te()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},je=function(){return te()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},Ye=function(){return te()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},Xe=function(){return te()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},Ke=function(){return te()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},Ze=function(){return te()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},et=function(){return te()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},tt="https://go.microsoft.com/fwlink/?linkid=2271054",at=a(72277),nt=a(19080),ot=a(28087),rt=a(33500),it=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},lt=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},st=!1,ct=function(){return st},dt=function(e){v("setting ClpOfficeJSApiError to ".concat(e)),st=e},ut=!1;function mt(){return it(this,void 0,void 0,(function(){var e;return lt(this,(function(t){switch(t.label){case 0:return i.IsClpEnabledInEnterpriseForSydney()?(ut=!0,[4,vt.getInstance().getInDocSensitiveLabelUsingOfcJs()]):[3,3];case 1:return e=t.sent(),[4,vt.getInstance().getHighestDocumentSensitivityInfo([vt.getInstance().getInDocSensitiveLabelInfo(),e])];case 2:if(t.sent(),ct())return dt(!1),ut=!1,[2,!1];t.label=3;case 3:return ut=!1,[2,!0]}}))}))}function gt(e,t,a,n,o){void 0===o&&(o=!0);var i={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:nt.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:n?A(n):void 0},s=!0,d=vt.getInstance();(null==d?void 0:d.getShouldStopLoadingUi)&&(s=d.getShouldStopLoadingUi());var u={chatCardType:ot._.Default,chatMessageData:{defaultMessageProps:{user:rt.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:i,stopLoadingUi:s,startAugloopTimerForStreaming:!1,addCardToChatHistory:o};return function(e,t,a){var n,o;void 0===a&&(a=!0);var i={};if(t){r.sendChatEventTelemetry(I(((n={})[c.ChatEventType]=t.chatEventType,n[c.ChatEventParameters]=t.chatEventParam,n[c.ChatErrorType]=t.chatErrorType,n))),(o={})[l.ErrorType]=g.Client,o[l.ErrorParameter]=t.chatEventType,o[l.ErrorChatEventType]=t.chatEventType,o[l.ErrorChatEventParameter]=t.chatEventParam,i=o;var s=t.ashaErrorDetails;s&&L(s)}e&&(v("User Perceived Latency :  ".concat((0,x.WU)(x.qD)," sec")),i[l.UserPerceivedLatency]=(0,x.WU)(x.qD),i[l.IsQuerySuccess]=!1,r.sendLatencyTelemetry(I(i),a))}(t,a,!0),v("CLP error response message: ".concat(u)),u}function ht(e,t,a,n){var o,i,l;if(null===(l=null==e?void 0:e.current)||void 0===l?void 0:l.getIsExecuting()){var s=function(e,t){switch(e){case B.ApplyLabelUnsupportedCrossTenantErrorCode:return t===$.CLP_Get?ke:De();case B.ApplyLabelDocumentReadOnlyErrorCode:return t===$.CLP_Get?ke:$e();case B.ApplyLabelInsufficientPermissionErrorCode:return t===$.CLP_Get?ke:Be();case B.ApplyLabelLabelDisabledErrorCode:return t===$.CLP_Get?ke:He();case B.ApplyLabelUnsupportedUdpErrorCode:return t===$.CLP_Get?ke:Ue();case B.ApplyLabelLabelingDisabledErrorCode:return t===$.CLP_Get?ke:qe();case B.ApplyLabelUnsupportedContentTypeErrorCode:return t===$.CLP_Get?ke:Ve();case B.ApplyLabelUnsupportedDkeErrorCode:return t===$.CLP_Get?ke:Ge();case B.ApplyLabelLabelNotFoundErrorCode:case B.ErrorCode2147647531:return t===$.CLP_Get?ke:We();case B.OsfControlContainerErrorCode:case B.OfficeSolutionFrameworkHostErrorCode:case B.DocCookieErrorCode:case B.HostIntegrationManagerErrorCode:case B.MsoOLDocumentErrorCode:case B.ClpSessionErrorCode:return ze();case B.OMWorkflowUserNotFoundErrorCode:return Qe();case B.OMOfficePerpetualNotSupportedErrorCode:return Je();case B.LabelingDisabledProtectedViewErrorCode:return je();case B.LabelingDisabledAppguardErrorCode:return Ye();case B.LabelingDisabledPrivacySettingsErrorCode:return t===$.CLP_Get?ke:Xe();case B.LabelingDisabledUnsupportedLabelClientErrorCode:return t===$.CLP_Get?ke:Ke();case B.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===$.CLP_Get?ke:Ze();case B.OMOfficeClientNotLicensedForLabelingErrorCode:return t===$.CLP_Get?ke:et();case B.PolicyManagerUnavailableErrorCode:return t===$.CLP_Get?ke:ze();case B.ApplyLabelNewLabelSensitivityOrderErrorCode:return ke;case B.ErrorCode2147500033:default:return t===$.CLP_Get?ke:ze()}}(t,a);if(s){ut&&dt(!0),v("clp error: ".concat(s)),function(e,t){var a,n={chatEventType:d.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:g.Client,ashaErrorDetails:{vetoName:F(f.UnclearIntent,p.UserInputIssue),errorString:C.SensitivityExecutionFailed,featureName:m.CopilotChat}};null===(a=null==e?void 0:e.current)||void 0===a||a.addResponseMessage(gt(t,!0,n))}(e,s);var u=!0,h=vt.getInstance();(null==h?void 0:h.getShouldStopLoadingUi)&&(u=h.getShouldStopLoadingUi()),n&&u&&n(),r.sendChatEventTelemetry(I(((o={})[c.ChatEventType]=d.CLPErrorShown,o[c.ChatEventParameters]=a+"_"+t,o)))}else v("clp error string is empty"),r.sendChatEventTelemetry(I(((i={})[c.ChatEventType]=d.CLPErrorIgnored,i[c.ChatEventParameters]=a+"_"+t,i)));return s}return ke}var pt=function(){return pt=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},pt.apply(this,arguments)},bt=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ft=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Ct=null,yt=(0,ce.A)(),vt=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:ke,tenantId:ke},this.externalDocLabelInfo={labelId:ke,tenantId:ke},this.inDocLabelInfo.labelId=ke,this.inDocLabelInfo.tenantId=ke,this.externalDocLabelInfo.labelId=ke,this.externalDocLabelInfo.tenantId=ke}return e.getInstance=function(t,a,n,o){return Z(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),Z(t)||(e.clpSensitivityHandler.setBasicChatProps=t),Z(a)||(e.clpSensitivityHandler.copilotChatRef=a),Z(n)||(e.clpSensitivityHandler.removeCurrentContextId=n),Z(o)||(e.clpSensitivityHandler.getShouldStopLoadingUi=o),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return bt(this,void 0,void 0,(function(){var e,t;return ft(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 1:return e=a.sent(),this.setInDocSensitivityLabelInfo(e),R("setInDocSensitiveLabelInfoUsingOfcJs"),[3,3];case 2:return t=a.sent(),E("error in getLabel Api: ".concat(t.message),t.code),ht(this.copilotChatRef,t.code,$.CLP_Get,this.removeCurrentContextId),v("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,3];case 3:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return bt(this,void 0,void 0,(function(){var e,t;return ft(this,(function(a){switch(a.label){case 0:v("Getting label"),e={labelId:ke,tenantId:ke},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=a.sent(),R("getLabel"),[3,4];case 3:return t=a.sent(),E("error in getLabel Api : ".concat(t.message),t.code),ht(this.copilotChatRef,t.code,$.CLP_Get,this.removeCurrentContextId),v("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return v("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;v("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(a){var o,r;return pt(pt({},a),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(o=e.description)&&void 0!==o?o:"",badgeText:null!==(r=e.displayName)&&void 0!==r?r:"",iconType:e.encryptionType!==n.None?at.JF.Encryption:at.JF.NonEncryption}:void 0})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return bt(this,void 0,void 0,(function(){var t;return ft(this,(function(a){switch(a.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:ke}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):(v("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:a.sent(),this.labelChangedFromChatHistory=!1,a.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?(v("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return a.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){var t;return bt(this,void 0,void 0,(function(){var a,n,r,i,l,s,c=this;return ft(this,(function(d){switch(d.label){case 0:R("tryUpgradeLabel"),v("Upgrading sensitivity label: ".concat(JSON.stringify(e))),a=o[o.S_APPLYLABEL_OK],n=ke,d.label=1;case 1:return d.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,yt)];case 2:return d.sent(),[2,{status:o[o.S_APPLYLABEL_OK]}];case 3:return r=function(){return bt(c,void 0,void 0,(function(){return ft(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,yt)]}catch(e){E("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code),n=ht(this.copilotChatRef,e.code,$.CLP_Upgrade,this.removeCurrentContextId),v("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),a=e.message}return[2]}))}))},i=new Promise((function(e){Ct=e})),l=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([i,r()]),l])];case 4:d.sent(),d.label=5;case 5:return[3,7];case 6:return s=d.sent(),E("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(s.message),s.code),ht(this.copilotChatRef,s.code,$.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===s.message?v("Callback Timeout"):v("Exception while upgrading sensitivity label: ".concat(s.message,", error code: ").concat(s.code)),a=null!==(t=o[s.message])&&void 0!==t?t:s.message,[3,7];case 7:return Ct=null,[2,{status:a,errorMessage:n}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:Tt),R("Label Change Event Listener"),v("Sensitivity Label Change Event Listener Set")}catch(e){E("error in setting listener for CLP : ".concat(e.message),e.code),ht(this.copilotChatRef,e.code,$.CLP_Upgrade,this.removeCurrentContextId),v("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return bt(this,void 0,void 0,(function(){var t,a;return ft(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 1:return t=n.sent(),v("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),R("External Doc HighestSensitivityLabel"),[3,3];case 2:return a=n.sent(),E("error in HighestSensitivityLabel Api : ".concat(a.message),a.code),ht(this.copilotChatRef,a.code,$.CLP_Get,this.removeCurrentContextId),v("Error while updating external doc sensitivity label: ".concat(a.message,", error code: ").concat(a.code)),[3,3];case 3:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return bt(this,void 0,void 0,(function(){return ft(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return bt(this,void 0,void 0,(function(){var t,a;return ft(this,(function(n){switch(n.label){case 0:t={labelId:ke,tenantId:ke},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=n.sent(),v("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),R("HighestSensitivityLabel"),[3,4];case 3:return a=n.sent(),E("error in HighestSensitivityLabel Api : ".concat(a.message),a.code),ht(this.copilotChatRef,a.code,$.CLP_Get,this.removeCurrentContextId),v("Error while fetching highest sensitivity label: ".concat(a.message,", error code: ").concat(a.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return bt(this,void 0,void 0,(function(){var t;return ft(this,(function(a){switch(a.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=a.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==n.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){v("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return R("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===ke)),this.externalDocLabelInfo.labelId!==ke&&i.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return R("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===ke)),this.inDocLabelInfo.labelId!==ke&&i.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==n.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==n.None},e}();function Tt(e,t,a,n){return bt(this,void 0,void 0,(function(){return ft(this,(function(r){switch(r.label){case 0:return v("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(a,", error: ").concat(n)),R("Label change callback received, context:  ".concat(a)),Ct&&a===yt&&(Ct("ignore"),Ct=null),n!==o.S_APPLYLABEL_OK?(E("error in upgrading label : ".concat(n),n.code),[2]):i.IsClpEnabledInEnterpriseForSydney()&&(vt.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,vt.getInstance().setSensitivityLabelToHighestSensitivity([vt.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return r.sent(),[2];case 2:return i.IsApplyLabelUsingTryUpgradeLabelEnabled(),vt.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}var xt=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},St=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function wt(){!1}var Et=function(e){var t,a;if(e){v("ClpUtils: Fetching clpSensitivityIndicatorData");var o,r={labelId:e.labelId,iconType:(o=e.encryptionType,o!==n.None?at.JF.Encryption:at.JF.NonEncryption),tooltipText:null!==(t=e.description)&&void 0!==t?t:"",badgeText:null!==(a=e.displayName)&&void 0!==a?a:""};return v("ClpUtils: Returning clpSensitivityIndicatorData as ",r),r}v("ClpUtils: Label is undefined")},Rt=function(){v("ClpUtils: Fetching CLP label info..");var e=vt.getInstance().getInDocSensitiveLabelInfo();if(v("ClpUtils: Label is : ".concat(JSON.stringify(e))),e.labelId)return v("ClpUtils: Doc is labelled",e),e;v("ClpUtils: Doc is not labelled")},It=function(e){return xt(void 0,void 0,void 0,(function(){var t,a;return St(this,(function(n){switch(n.label){case 0:return e?(t={labelId:e.id,tenantId:e.tenantId},[4,vt.getInstance().getHighestDocumentSensitivityInfo([t])]):[3,2];case 1:if(a=n.sent())return[2,Et(a)];n.label=2;case 2:return[2,{tooltipText:"I wasn't able to apply a sensitivity label to this file. Please choose another file or try again.",iconType:at.JF.Warning}]}}))}))},At=function(e){return e?{labelId:e.id,tenantId:"",displayName:e.displayName,description:e.tooltip,color:e.color,encryptionType:e.isEncrypted?n.IRMTemplate:n.None,order:e.priority}:{labelId:ke,tenantId:ke}},Lt=function(e,t){return xt(void 0,void 0,void 0,(function(){var a,o,l,s,u,m,g,h,p,b,f,C;return St(this,(function(y){switch(y.label){case 0:return a=vt.getInstance().getInDocSensitiveLabelInfo(),i.IsClpEnabledInEnterpriseForSydney()?[4,vt.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return o=y.sent(),[4,vt.getInstance().getHighestDocumentSensitivityInfo([vt.getInstance().getInDocSensitiveLabelInfo(),o])];case 2:(a=y.sent()).isDke=o.isDke,a.hasExtractForUser=o.hasExtractForUser,y.label=3;case 3:return l={id:a.labelId,displayName:null!==(f=a.displayName)&&void 0!==f?f:"",tooltip:a.description,color:a.color,isEncrypted:a.encryptionType!==n.None,priority:null!==(C=a.order)&&void 0!==C?C:0},h={documentSensitivity:l},null==t?[3,4]:(u=t,[3,6]);case 4:return[4,i.getOfficeJSDocumentURL()];case 5:u=y.sent(),y.label=6;case 6:return h.documentURL=u,h.hasExtract=a.labelId===ke||a.hasExtractForUser,h.isDKE=a.labelId!==ke&&a.isDke,s=h,(m={copilotConfig:e(),documentConfig:s}).copilotConfig&&r.sendChatEventTelemetry(I(((p={})[c.ChatEventType]=d.CopilotConfig,p[c.ChatEventParameters]=JSON.stringify(m.copilotConfig),p))),g=void 0===s.hasExtract&&void 0===s.isDKE,r.sendChatEventTelemetry(I(((b={})[c.ChatEventType]=d.IsDocumentProtected,b[c.ChatEventParameters]=!!g||!(!s.hasExtract||s.isDKE),b))),[2,m]}}))}))};var Ft,_t=a(15413),Nt=a(40226);!function(e){e.AugloopSharedSessionID="AugloopSharedSessionID",e.HandoffMessageId="HandoffMessageId"}(Ft||(Ft={}));var kt,Ot,Pt,Mt=function(){function e(){}return e.getSettingAsString=function(e){var t=Office.context.document.settings.get(e.toString());return Z(t)?t:t.toString()},e}(),Dt=a(26115),$t=a(50837),Bt=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Ht=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function Ut(e){return Bt(this,void 0,void 0,(function(){var t;return Ht(this,(function(a){switch(a.label){case 0:return v("Activating User Context Annotation"),function(){v("Fetching AL Session");var e=Mt.getSettingAsString(Ft.AugloopSharedSessionID);Ot=(0,$t.wB)(Z(e)?"ALDummySession":e)}(),[4,Ot.activateAnnotation(_t.i.getTypeName(),{callback:function(t){return function(e,t){v("Entering user Context Annotation handler"),r.updateTelemetryOnAnnotationReceived(_t.i.getTypeName(),void 0,l.UserContextResponseTime,ke,void 0,Pt);for(var a=0,n=e.items;a<n.length;a++){var o=n[a];o.body&&_t.i.typeGuard(o.body)&&Gt(o,t)}}(t,e)}})];case 1:return t=a.sent(),kt=t.token,v("User Context Annotation activated with token: "+kt),[2]}}))}))}function qt(){return Bt(this,void 0,void 0,(function(){var e;return Ht(this,(function(t){switch(t.label){case 0:v("Releasing User Context Annotation with token: "+kt),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,Ot.releaseAnnotation(kt)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),v("Error while releasing User Context Annotation: "+e),[3,4];case 4:return v("User Context Released"),[2]}}))}))}function Vt(e){return Bt(this,void 0,void 0,(function(){var t,a,n,o,i;return Ht(this,(function(s){switch(s.label){case 0:return v("Sending signal to Copilot Warmup Flow"),t=(new Date).getTime(),[4,Ut(e)];case 1:s.sent(),v("User Context Annotation Time is "+(0,x.WU)(t)),r.sendLatencyTelemetry(I(((o={})[l.UserContextAnnotationActivationTime]=(0,x.WU)(t),o))),a=new Dt.g0({parentPath:["Signal",Nt.P.getTypeName()],items:[{id:w.generateId(),body:new Nt.P}]}),n=Nt.P.getTypeName(),v("Submitting User Context signal"+JSON.stringify(a)),Pt=(new Date).getTime();try{Ot.submitOperation(a)}catch(e){v("Error while submitting signal to Copilot Warmup Flow"+e)}return v("User Context signal submitted..."),r.sendChatEventTelemetry(I(((i={})[c.ChatEventType]=d.UserContextSignalSubmitted,i[c.ChatEventParameters]=n,i))),[2]}}))}))}function Gt(e,t){var a;return Bt(this,void 0,void 0,(function(){var n,o,i,l;return Ht(this,(function(s){switch(s.label){case 0:return v("Entering user Context Annotation item handler"),e.body?(n=e.body.userType,v("User Type returned is: ",n),o=null===(a=e.body)||void 0===a?void 0:a.isEUDBUser,v("isEUDBUser returned is: ",o),n?(r.sendChatEventTelemetry(I(((i={})[c.ChatEventType]=d.ALUserType,i[c.ChatEventParameters]=function(e){switch(e){case _.Enterprise:return"Enterprise";case _.Consumer:return"Consumer";default:return"Unknown"}}(n),i))),t(n,o),[4,qt()]):[3,2]):[2];case 1:return s.sent(),v("User Context Annotation Released"),[3,3];case 2:r.sendChatEventTelemetry(I(((l={})[c.ChatEventType]=d.ALUserType,l[c.ChatEventParameters]="UserTypeNotFound",l))),s.label=3;case 3:return[2]}}))}))}var Wt=a(23436),zt=a(70737),Qt=function(){var e=function(t,a){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},e(t,a)};return function(t,a){if("function"!=typeof a&&null!==a)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),Jt=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},jt=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};!function(e){function t(t){var a=e.call(this,t)||this;return a.handleRefreshButtonOnClick=function(){window.location.reload()},a.handleCopyErrorButtonOnClick=function(){return Jt(a,void 0,void 0,(function(){var e,t,a,n,o,r,i,l;return jt(this,(function(s){switch(s.label){case 0:e=null!==(r=null===(o=this.state.error)||void 0===o?void 0:o.message)&&void 0!==r?r:"No error message",t=null!==(l=null===(i=this.state.error)||void 0===i?void 0:i.stack)&&void 0!==l?l:"No error stack",a="Error Message: "+e+"\n Error Stack: "+t,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(a)];case 2:return s.sent(),[3,4];case 3:return n=s.sent(),v("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",n),[3,4];case 4:return[2]}}))}))},a.state={hasError:!1,error:void 0},a}Qt(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){var t;v("ErrorBoundary caught an error ",e),null===(t=window.document.getElementById(Oe))||void 0===t||t.style.setProperty("display","none"),function(e){var t;r.sendChatEventTelemetry(I(((t={})[c.ChatEventType]=d.ErrorBoundaryCaughtError,t[c.ChatEventParameters]=e,t))),L({vetoName:F(f.UnclearIntent,p.UnclassifiedError),errorString:C.UnexpectedFailure,featureName:m.CopilotChat})}(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?Te.createElement(zt.L,{theme:this.props.copilotChatTheme,shouldUseFluentV9Tokens:!0},Te.createElement(Wt.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children}}(Te.Component);a(94329);var Yt=a(45448),Xt=a(93914),Kt=a(71406),Zt=a(90907),ea=a(74487),ta=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},aa=function(e){var t={appId:"",botId:"",cardId:""};try{var a=JSON.parse(e.cardData);t={appId:a.appId,botId:a.botId,cardId:a.cardId}}catch(e){v("msgExtension Utils: Failed to extract cardId from cardData")}return t},na=function(){return na=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},na.apply(this,arguments)},oa=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ra=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},ia=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},v("MsgExtDialogLauncher : Task Module dialog closed")},this.onMessageCallback=function(e){return oa(t,void 0,void 0,(function(){var t,a,n,o,i,l,m,g,h,p;return ra(this,(function(b){switch(b.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(e)).type!==Zt.o.Ack?[3,1]:(a=aa(this.taskModuleProps),o={dialogContent:this.taskModuleProps.dialogContent,appDefinition:this.taskModuleProps.appDefinition,clientInfo:this.taskModuleProps.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:a},this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),[3,6]):[2];case 1:return t.type!==Zt.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==Zt.o.onServiceRequest)return[3,6];null===(p=r.setQueryGuid)||void 0===p||p.call(r,t.requestId),v("MsgExtDialogLauncher : Received service request from dialog",t),n={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},r.sendChatEventTelemetry(I(((m={})[c.ChatEventType]=d.TaskModuleServiceRequest,m[c.ChatEventParameters]=JSON.stringify(n),m))),o={requestId:t.requestId,messageType:Zt.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},b.label=3;case 3:return b.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(i=b.sent())&&(o.result=i),v("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),r.sendChatEventTelemetry(I(((g={})[c.ChatEventType]=d.TaskModuleServiceResponse,g[c.ChatEventParameters]=JSON.stringify(n),g))),this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),[3,6];case 5:return l=b.sent(),v("MsgExtDialogLauncher : Error executing plugin operation",l),r.sendErrorTelemetry(I(((h={})[u.ErrorMessage]=JSON.stringify(na(na({},n),{error:l})),h[u.ErrorCategory]=s.MsgExtTaskModule,h[u.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),h))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var a;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(a=t.taskModuleProps)||void 0===a?void 0:a.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.openDialogForWebPlatformAsNewWindow=function(e,a){return oa(t,void 0,void 0,(function(){var t,n,o=this;return ra(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=aa(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return n=ta(),[4,Office.context.ui.displayDialogAsync(n,{displayInIframe:!1,hideTitle:!0,height:e,width:a,promptBeforeOpen:!1},(function(e){return oa(o,void 0,void 0,(function(){var a=this;return ra(this,(function(n){return this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:this.taskModuleProps.triggeringActionTitle},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return oa(a,void 0,void 0,(function(){return ra(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return oa(a,void 0,void 0,(function(){return ra(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2]}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForWebPlatformAsIframe=function(e,a){return oa(t,void 0,void 0,(function(){var t,n=this;return ra(this,(function(o){switch(o.label){case 0:return t=ta(),[4,Office.context.ui.displayDialogAsync(t,{displayInIframe:!0,hideTitle:!0,height:e,width:a,promptBeforeOpen:!1},(function(e){return oa(n,void 0,void 0,(function(){var t=this;return ra(this,(function(a){return this.openedDialog.dialog=e.value,this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return oa(t,void 0,void 0,(function(){return ra(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),[2]}))}))}))];case 1:return o.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,a){return oa(t,void 0,void 0,(function(){var t,n,o,r=this;return ra(this,(function(i){return this.shouldDisplayDismissIcon=!1,t=ta(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(o=null===(n=this.taskModuleProps)||void 0===n?void 0:n.dialogTitle)&&void 0!==o?o:"Copilot Extensions Dialog",hideTitle:!0,height:e,width:a,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){r.openedDialog.dialog=e})).catch((function(e){v("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e,a){return oa(t,void 0,void 0,(function(){var t,n,o,r,i,l;return ra(this,(function(s){return this.taskModuleProps=a,t=null===(i=a.clientInfo)||void 0===i?void 0:i.clientType,n=e&&t===ea.WK.web?function(e){var t,a;if(e.viewMode===ot.S.TaskViewMode){var n=null===(t=e.dialogContent)||void 0===t?void 0:t.height,o=null===(a=e.dialogContent)||void 0===a?void 0:a.width;if(!n||!o||"number"!=typeof o||"number"!=typeof n)return{dialogHeight:55,dialogWidth:50};var r=screen.width,i=screen.height;return{dialogHeight:Math.floor(n/i*100),dialogWidth:Math.floor(o/r*100)}}return{dialogHeight:80,dialogWidth:80}}(a):function(e){var t,a,n,o,r=e.viewMode,i=r===ot.S.TaskViewMode?window.outerWidth:window.innerWidth,l=r===ot.S.TaskViewMode?window.outerHeight:window.innerHeight,s=r===ot.S.TaskViewMode?5:0,c=r===ot.S.TaskViewMode?2:0,d=null===(t=e.dialogContent)||void 0===t?void 0:t.height,u=null===(a=e.dialogContent)||void 0===a?void 0:a.width;try{if("number"==typeof u&&"number"==typeof d&&u<=i&&d<=l){var m=Math.floor(d/l*100),g=Math.floor(u/i*100);n=m+s,o=g+c}else n=55,o=50}catch(e){n=55,o=50}return{dialogHeight:n,dialogWidth:o}}(a),o=n.dialogHeight,r=n.dialogWidth,(null===(l=a.clientInfo)||void 0===l?void 0:l.clientType)===ea.WK.web?e?this.openDialogForWebPlatformAsNewWindow(o,r):this.openDialogForWebPlatformAsIframe(o,r):this.openDialogForNativePlatform(o,r),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e}(),la=a(52970),sa=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),ca=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},da=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},ua=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var a=this.requestByQueryId.get(e);a&&(this.requestByQueryId.delete(e),a.complete(t))},e.prototype.getToken=function(e){return ca(this,void 0,void 0,(function(){var t,a,n;return da(this,(function(o){switch(o.label){case 0:return t=(0,ce.A)(),pa(t,la.o.AuthService,la.L.GetToken,{request:e}),a=new sa,this.requestByQueryId.set(t,a),[4,a.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e}(),ma=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ga=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},ha=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var a=this.requestByQueryId.get(e);a&&(this.requestByQueryId.delete(e),a.complete(t))},e.prototype.botInvoke=function(e){return ma(this,void 0,void 0,(function(){var t,a,n;return ga(this,(function(o){switch(o.label){case 0:return t=(0,ce.A)(),pa(t,la.o.ChannelService,la.L.BotInvoke,{request:e}),a=new sa,this.requestByQueryId.set(t,a),[4,a.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e}(),pa=function(e,t,a,n){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:Zt.o.onServiceRequest,serviceName:t,apiName:a,requestData:n}),{targetOrigin:window.location.origin})},ba=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},fa=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Ca=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var a=this.requestByQueryId.get(e);a&&(this.requestByQueryId.delete(e),a.complete(t))},e.prototype.getApp=function(e){return ba(this,void 0,void 0,(function(){var t,a,n;return fa(this,(function(o){switch(o.label){case 0:return t=(0,ce.A)(),pa(t,la.o.AppService,la.L.GetApp,{request:e}),a=new sa,this.requestByQueryId.set(t,a),[4,a.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e.prototype.getApps=function(){return ba(this,void 0,void 0,(function(){var e,t,a;return fa(this,(function(n){switch(n.label){case 0:return e=(0,ce.A)(),pa(e,la.o.AppService,la.L.GetApps),t=new sa,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return a=n.sent(),[2,JSON.parse(a)]}}))}))},e}(),ya=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,ce.A)();pa(t,la.o.TelemetryService,la.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,ce.A)();pa(t,la.o.TelemetryService,la.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,ce.A)();pa(t,la.o.TelemetryService,la.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,ce.A)();pa(t,la.o.TelemetryService,la.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,ce.A)();pa(t,la.o.TelemetryService,la.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,ce.A)();pa(t,la.o.TelemetryService,la.L.LogMetric,{request:e})},e}();Te.memo((function(e){var t=e.dialogContent,a=e.appDefinition,n=e.userContext,o=e.hostContext,r=e.clientInfo,i=e.handleCloseButtonClick,l=e.shouldShowDismissIcon,s=e.copilotChatThemeV2,c=e.shouldDisplayInNewWindow,d=e.cardInfo,u=Te.useMemo((function(){return Ca.getInstance()}),[]),m=Te.useMemo((function(){return ua.getInstance()}),[]),g=Te.useMemo((function(){return ha.getInstance()}),[]),h=Te.useMemo((function(){return ya.getInstance()}),[]),p=Te.useMemo((function(){return new Xt.R}),[]);return Te.createElement(Yt.q,{theme:s},Te.createElement(Kt.K,{dialogContent:t,botService:g,appDefinition:a,tokenService:m,telemetryService:h,userContext:n,hostContext:o,appService:u,externalAuthService:p,clientInfo:r,isCardRenderingInTaskModuleEnabled:!0,handleCloseButtonClick:i,taskModuleLauncher:ia.getInstance().launchTaskModule.bind(null,c),shouldShowDismissIcon:l,cardInfo:d,isDialogAcRendererEnabledForTaskModule:!0,createAndSendSignalsToSubstrate:!1}))}));function va(e,t,a,n){var o;void 0===n&&(n=!1);var r=function(e){return 0===(e||[]).length?0:e.filter((function(e){return!!e.cardJson})).length}(e);return r>0?(v("Getting msgExtProp for MsgExtCard here.."),o={attributions:e,clientInfo:t,hideSingleCitation:a},n&&V(r)):v("No data(cardJson) found for MsgExtCard."),o}var Ta=a(18850),xa=a(43265),Sa=function(e){},wa=(0,Ta.mL)(xa.N,{currentLocale:void 0,strings:{},errorHandler:Sa,loaders:[],stringMapInitialized:!1});function Ea(e,t){void 0===t&&(t=Sa);var a=(0,Te.useState)(wa),n=a[0],o=a[1];return(0,Te.useEffect)((function(){(0,Ta.Au)((0,Ta.U5)(e,"en-us"),n).then(o)}),[e]),(0,Te.useEffect)((function(){o((0,Ta._c)(t,n))}),[t]),(0,Ta.zB)(n)}var Ra,Ia=a(93141),Aa=a(41519),La=function(e){var t,a=e.clientInfoRef,n=e.theme,o=e.locale,i=e.clientId,l=e.redirectUri,s=e.isWebPlatform,u=Te.useRef(void 0),m=function(){t&&t.close(),t=void 0},g=Te.useCallback((function(e){u.current=e;var g=window.location.href.replace("taskpane.html","CloudFilePickerDialog.html"),h=n===Aa.G.defaultBlack,p=function(e){var n,g,p,b,f,C,y=JSON.parse(e);switch(y.type){case H.Ack:var v={userPrincipalName:null!==(p=null===(g=a.current)||void 0===g?void 0:g.userPrincipalName)&&void 0!==p?p:"",clientId:i,redirectUri:l,locale:o,isDarkMode:h};r.sendChatEventTelemetry(I(((n={})[c.ChatEventType]=d.CloudFilesDialogOpened,n))),t&&t.messageChild(JSON.stringify(v),{targetOrigin:"*"});break;case H.CloseEvent:m(),s?setTimeout((function(){var e;null===(e=u.current)||void 0===e||e.closeCiqCallback()}),700):null===(b=u.current)||void 0===b||b.closeCiqCallback();break;case H.OnItemSelected:m();var T=y.files;s?setTimeout((function(){var e;null===(e=u.current)||void 0===e||e.onItemSelected(T)}),700):null===(f=u.current)||void 0===f||f.onItemSelected(T);break;case H.OnErrorInLoading:m(),s?setTimeout((function(){var e;null===(e=u.current)||void 0===e||e.onErrorInLoading()}),700):null===(C=u.current)||void 0===C||C.onErrorInLoading()}};s?Office.context.ui.displayDialogAsync(g,{displayInIframe:!0,hideTitle:!0,height:65,width:60},(function(e){null==(t=e.value)||t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){var t;p(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"")}))})):OfficeFirstPartyDialog.displayWebDialog(g,{displayInIframe:!0,dialogTitle:"",hideTitle:!0,height:65,width:60,onMessage:p,onClose:function(){var e;null===(e=u.current)||void 0===e||e.closeCiqCallback()}}).then((function(e){t=e}))}),[a,n,u]);return{onAttachCloudFiles:g}},Fa=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},_a=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Na=function(e){Te.useEffect((function(){var t=we.subscribe(e);return function(){t()}}),[])},ka=function(e){var t,a=!1;Te.useEffect((function(){return t=we.subscribe((function(){return Fa(void 0,void 0,void 0,(function(){return _a(this,(function(n){switch(n.label){case 0:return a?[3,2]:(a=!0,[4,e()]);case 1:n.sent(),t(),n.label=2;case 2:return[2]}}))}))})),function(){t()}}),[])},Oa=a(39531),Pa=new Set([Oa.n3.TriggerConfirmation,Oa.n3.TriggerPluginAuth]),Ma=function(e){return Pa.has(null==e?void 0:e.messageType)},Da=function(e,t,a){var n,o;void 0===a&&(a=!1);var r=null!==(n=e.messages)&&void 0!==n?n:[],i=r[r.length-1];return!(0===r.length||!Ma(i))&&(null===(o=t.current)||void 0===o||o.addResponseMessage({chatCardType:ot._.InterstitialMessage,stopLoadingUi:!0,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:a?r:[i]}},chatMessageBodyData:{messageId:i.messageId},addCardToChatHistory:!1}),!0)},$a=function(){return Te.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Te.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),Te.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),Te.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),Te.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),Te.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),Te.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),Te.createElement("defs",null,Te.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},Te.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),Te.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),Te.createElement("stop",{offset:"1",stopColor:"#0736C4"})),Te.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},Te.createElement("stop",{stopColor:"#FFB657"}),Te.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),Te.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),Te.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},Te.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),Te.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),Te.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),Te.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),Te.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},Te.createElement("stop",{stopColor:"#3DCBFF"}),Te.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),Te.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},Te.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),Te.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),Te.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),Te.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},Te.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),Te.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))},Ba=function(){return Te.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Te.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),Te.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),Te.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),Te.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),Te.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),Te.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),Te.createElement("defs",null,Te.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},Te.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),Te.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),Te.createElement("stop",{offset:"1",stopColor:"#0736C4"})),Te.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},Te.createElement("stop",{stopColor:"#FFB657"}),Te.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),Te.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),Te.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},Te.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),Te.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),Te.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),Te.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),Te.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},Te.createElement("stop",{stopColor:"#3DCBFF"}),Te.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),Te.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},Te.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),Te.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),Te.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),Te.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},Te.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),Te.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))};!function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(Ra||(Ra={}));var Ha,Ua=function(){return"Get Agents"},qa=a(5157),Va=a(97691),Ga=a(91971),Wa=a(58651),za=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Qa=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};(function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return za(t,void 0,void 0,(function(){var e;return Qa(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){Wa.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===k.win32?this.handleDefaultThemeChange():this.platform===k.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,a=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(a.theme=a.buildOfficeTheme(e.value),a.themeChangeObserver.update(a.theme),a.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}})(),(0,Te.createContext)({officePlatform:k.web,officeTheme:void 0});!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(Ha||(Ha={}));var Ja="I ran into a problem while completing your request. Please try again.",ja=function(){function e(e){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set;var t=this.getDocumentHandoffMessageId();t&&this.pendingHandoffMessageIds.add(t)}return e.prototype.getDocumentHandoffMessageId=function(){var e=Mt.getSettingAsString(Ft.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var a=(0,ce.A)(),n=this.getHandoffMessageIdSignal(a,t,e),o=new Dt.g0({parentPath:["Signal",qa.uC.getTypeName()],items:[{id:w.generateId(),body:n}]});e===Va.Q.GET&&this.trackHandoffMessageIdSignal(a,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(n.H_.T_,{operation:o,workflowAnnotationType:qa.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(n)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.handleHandoffMessage=function(e,t){try{if(!(null==e?void 0:e.body)||!qa.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var a=e.body;if(this.HandoffOperations.onAnnotationReceived(qa.uC.getTypeName(),a,this.handoffMessageIdRequestSubmitTime,t),a.scenarioName===Ga.Cu.INAPP)return void this.processHandoffMessage(a);if(!this.isHandoffMessageIdSignalTracked(a.queryId))return;if(a.error){if(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+a.error),a.error.includes("Unable to download content. The specified blob does not exist")||a.error.includes("Unable to download content. Request failed with status code 500"))return;return void this.HandoffOperations.onError(Ha.HandoffMessageResponse,Ja)}var n=this.getHandoffMessageIdFromSignal(a.queryId);return this.sendHandoffMessageId(Va.Q.PROCESSED,n),this.completeTrackedHandoffMessageIdSignal(a.queryId),this.processHandoffMessage(a),n}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)},e}(),Ya=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Xa=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Ka=(function(){function e(e){this.HandoffOperations=e}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e),a=new Dt.Xr({parentPath:["session","doc"],items:[{id:w.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:a,workflowAnnotationType:qa.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return Ya(this,void 0,void 0,(function(){var a,n;return Xa(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),!qa.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return a=e.body,this.HandoffOperations.onAnnotationReceived(qa.kp.getTypeName(),a,this.handoffInternalMessageSubmitTime,t),a.error?(this.HandoffOperations.onError(Ha.OutboundMessageResponse,a.error),[3,5]):[3,1];case 1:return a.message?[3,2]:(this.HandoffOperations.onError(Ha.NoResponse),[3,5]);case 2:return a.generatedLinks&&a.generatedLinks.length>0&&a.id?[4,this.renderGeneratedHandoffLinks(a)]:[3,4];case 3:return o.sent(),[3,5];case 4:this.HandoffOperations.onError(Ha.NoGeneratedLinks),o.label=5;case 5:return[3,7];case 6:throw n=o.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+n.message),n;case 7:return[2]}}))}))}}(),function(e){var t,a;return{accessToken:e.accessToken,expirationTime:null!==(a=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==a?a:0}}),Za=function(e){return e.substring(0,e.lastIndexOf("/"))},en=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},tn=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},an=function(e,t){return en(void 0,void 0,void 0,(function(){var a,n;return tn(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:G.w8.graph)];case 1:return a=o.sent(),[2,Ka(a)];case 2:throw n=o.sent(),v("Error fetching Graph token:",n),n;case 3:return[2]}}))}))},nn=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},on=function(e,t){var a,n,o,r,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;r&&(r=0,l[0]&&(i=0)),i;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,n=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){i=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){i.label=l[1];break}if(6===l[0]&&i.label<o[1]){i.label=o[1],o=l;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(l);break}o[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},rn=function(e,t){return nn(void 0,void 0,void 0,(function(){var a,n;return on(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:G.w8.sharepoint)];case 1:return a=o.sent(),[2,Ka(a)];case 2:throw n=o.sent(),v("Error fetching SharePoint token:",n),n;case 3:return[2]}}))}))}},83348:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(50709),o=a.n(n),r=a(28354),i=a.n(r)()(o());i.push([e.id,'@media (forced-colors: active) {\n  svg > path.OfficeIconColors_HighContrast:not([class*="OfficeIconColors_m"]) {\n    forced-color-adjust: auto;\n    fill: currentColor;\n  }\n}\n\n@media (forced-colors: active) {\n  svg > path[class*="OfficeIconColors_m"]:not(.OfficeIconColors_HighContrast) {\n    forced-color-adjust: auto;\n    fill: none;\n  }\n}\n\n@media (forced-colors: active) {\n  div.conditional-formatting-response-card-swatch {\n    display: none;\n  }\n}\n\n/* ConditionalFormatResponseCardSample.tsx */\n.conditional-formatting-response-card-icon {\n  height: 20px;\n  width: 20px;\n  margin-left: 1px;\n  margin-right: 10px;\n}\n\ndiv.conditional-formatting-response-card-icon-renderer {\n  display: flex;\n  border: none;\n  flex-basis: 100%;\n  direction: ltr;\n  height: 20px;\n  width: 110px;\n}\n\n/* commandingChatCard.tsx */\ndiv.conditional-formatting-response-card-swatch {\n  margin: auto;\n  width: 50%;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\ndiv.conditional-formatting-response-card-formula {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  margin-inline-start: -2rem;\n  width: auto;\n}\n',"",{version:3,sources:["webpack://./src/frontend/components/ConditionalFormatResponseCardSample/Styles/ConditionalFormatIcons.css"],names:[],mappings:"AAAA;EACE;IACE,yBAAyB;IACzB,kBAAkB;EACpB;AACF;;AAEA;EACE;IACE,yBAAyB;IACzB,UAAU;EACZ;AACF;;AAEA;EACE;IACE,aAAa;EACf;AACF;;AAEA,4CAA4C;AAC5C;EACE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,aAAa;EACb,YAAY;EACZ,gBAAgB;EAChB,cAAc;EACd,YAAY;EACZ,YAAY;AACd;;AAEA,2BAA2B;AAC3B;EACE,YAAY;EACZ,UAAU;EACV,mBAAmB;EACnB,sBAAsB;AACxB;;AAEA;EACE,iBAAiB;EACjB,oBAAoB;EACpB,0BAA0B;EAC1B,WAAW;AACb",sourcesContent:['@media (forced-colors: active) {\n  svg > path.OfficeIconColors_HighContrast:not([class*="OfficeIconColors_m"]) {\n    forced-color-adjust: auto;\n    fill: currentColor;\n  }\n}\n\n@media (forced-colors: active) {\n  svg > path[class*="OfficeIconColors_m"]:not(.OfficeIconColors_HighContrast) {\n    forced-color-adjust: auto;\n    fill: none;\n  }\n}\n\n@media (forced-colors: active) {\n  div.conditional-formatting-response-card-swatch {\n    display: none;\n  }\n}\n\n/* ConditionalFormatResponseCardSample.tsx */\n.conditional-formatting-response-card-icon {\n  height: 20px;\n  width: 20px;\n  margin-left: 1px;\n  margin-right: 10px;\n}\n\ndiv.conditional-formatting-response-card-icon-renderer {\n  display: flex;\n  border: none;\n  flex-basis: 100%;\n  direction: ltr;\n  height: 20px;\n  width: 110px;\n}\n\n/* commandingChatCard.tsx */\ndiv.conditional-formatting-response-card-swatch {\n  margin: auto;\n  width: 50%;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\ndiv.conditional-formatting-response-card-formula {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  margin-inline-start: -2rem;\n  width: auto;\n}\n'],sourceRoot:""}]);const l=i},27639:(e,t,a)=>{a.d(t,{A:()=>C});var n=a(50709),o=a.n(n),r=a(28354),i=a.n(r),l=a(73849),s=a.n(l),c=new URL(a(69336),a.b),d=new URL(a(52978),a.b),u=new URL(a(24815),a.b),m=new URL(a(67176),a.b),g=i()(o()),h=s()(c),p=s()(d),b=s()(u),f=s()(m);g.push([e.id,`html,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n}\n\n#log {\n  max-height: 92%;\n  max-width: 100%;\n  overflow: auto;\n  overflow-wrap: break-word;\n}\n\n.ChatUi {\n  position: absolute;\n  top: 5px;\n  bottom: 5px;\n  left: 0;\n  right: 0;\n  background-color: var(--bgColor);\n}\n\n.chat-input-text {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-page-fre {\n  overflow-wrap: break-word;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  margin-bottom: 5px;\n}\n\n.chat-input-text:focus {\n  outline: none;\n}\n\n.chat-footer-hyper-link-text {\n  /* Hyperlink */\n  height: 16px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  text-decoration-line: underline;\n  /* Excel Colors / XL Primary */\n  color: #107c41;\n  /* Inside auto layout */\n  margin-top: 3px;\n}\n\n.chat-footer-like-button {\n  background-image: url(${h});\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-like-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-dislike-button {\n  background-image: url(${p});\n  margin-left: 8px;\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-dislike-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-info-button {\n  background-image: url(${b});\n  background-color: white;\n  border: #ffffff;\n  margin-left: 8px;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-info-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-log {\n  padding-top: 5px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  background-color: white;\n  margin-bottom: 5px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-log-human {\n  align-self: flex-end;\n  align-items: flex-start;\n  border: 1px solid #bebbb8;\n  background-color: #edebe9;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 10px 0px 5px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt {\n  align-self: flex-start;\n  align-items: flex-start;\n  border: 1px solid #d2d0ce;\n  background-color: #ffffff;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 0px 0px 15px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt-designerlink {\n  text-decoration: none;\n  color: #b1470e;\n  margin-right: 4px;\n}\n\n.chat-log-suggestion ul {\n  padding-left: 15px;\n}\n\n.chat-log-suggestion {\n  align-self: flex-start;\n  text-align: start;\n  border: 1px solid rgb(210, 208, 206);\n  border-radius: 4px;\n  padding: 8px 10px;\n  max-width: 88%;\n  text-overflow: clip;\n  margin: 0px 0px 0px 15px;\n  white-space: pre-wrap !important;\n}\n\n.chat-log-suggestion-header {\n  font-weight: 600;\n  margin-bottom: 0.5vh;\n}\n\n.welcome-message {\n  margin-top: 100px;\n  padding-top: 20px;\n}\n\n.disclaimer {\n  font-size: 0.69rem;\n  line-height: 127%;\n  color: #707070;\n  margin: 4px 20px 0px 15px;\n}\n\n.chat-suggestionPane {\n  align-items: flex-end;\n  background: transparent;\n  margin-right: 10px;\n  margin-left: 10px;\n  justify-content: flex-start;\n  font-size: 12px;\n  padding: 4px 0px;\n  gap: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  font-family: "Segoe UI";\n  font-style: normal;\n}\n\n.chat-suggestionPane-heading {\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n\n.chat-suggestionPane-headingImage {\n  width: 16px;\n  height: 16px;\n}\n\n.chat-suggestionPane-headingText {\n  font-weight: 700;\n  font-size: 10px;\n  line-height: 13px;\n  display: flex;\n  align-items: center;\n  text-align: right;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: #949494;\n}\n\n.chat-suggestionPane-icon {\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  vertical-align: middle;\n  border: 2px solid #107c41;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 6px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-suggestionPane-button {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 32px;\n  background: #ffffff;\n  border: 2px solid #107c41;\n  border-radius: 6px;\n  line-height: 16px;\n  padding: 0px 10px;\n}\n\n.chat-suggestionPane-label {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  order: 0;\n  vertical-align: middle;\n  margin: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.user-chat-query-container {\n  margin: 12px;\n}\n\n.chat-input {\n  border: 1px solid #d1d1d1;\n  border-radius: 8px;\n  background: #ffffff;\n  margin-left: 15px;\n  margin-right: 20px;\n  padding: 4px;\n  gap: 4px;\n  position: relative;\n  z-index: 1;\n}\n\n.chat-input-onfocus-border::after {\n  position: absolute;\n  z-index: -1;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 5px;\n  content: "";\n  border-radius: 0px 0px 8px 8px;\n  background-image: linear-gradient(90.5deg, #107c41 0%, #429537 100%);\n}\n\n.chat-fixed-input-text {\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n  color: #107c41;\n  white-space: pre-wrap;\n}\n\n.chat-fixed-input-text:focus {\n  outline: none;\n}\n\n.chat-input-ghost-text {\n  color: #bebebe;\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n}\n\n.chat-input-buttons {\n  align-items: flex-start;\n  background: #ffffff;\n  flex-direction: row;\n  gap: 2px;\n  margin-bottom: 10px;\n  justify-content: space-between;\n}\n\n.chat-input-buttons-suggestion {\n  align-self: flex-start;\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion > .ms-Button-flexContainer {\n  align-items: center;\n}\n\n.chat-input-buttons-suggestion:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-input-buttons-suggestion-clicked {\n  align-self: flex-start;\n  background-color: #edebe9;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion-clicked:hover {\n  background-color: #edebe9;\n}\n\n.chat-input-buttons-send {\n  align-self: flex-end;\n  background-image: url(${f});\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-right: 2px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-send:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-taskPane-learn-more-button {\n  align-items: center;\n  justify-content: center;\n  width: 77px;\n  height: 24px;\n  background: transparent;\n  border: 1px solid #616161;\n  border-radius: 4px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  color: #616161;\n  line-height: 16px;\n  box-sizing: border-box;\n}\n\n.chat-taskPane-learn-more-button:hover {\n  cursor: pointer;\n}\n`,"",{version:3,sources:["webpack://./src/frontend/pages/ChatUiLanding/ChatUi.css"],names:[],mappings:"AAAA;;EAEE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,gCAAgC;AAClC;;AAEA;EACE,eAAe;EACf,eAAe;EACf,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,kBAAkB;EAClB,QAAQ;EACR,WAAW;EACX,OAAO;EACP,QAAQ;EACR,gCAAgC;AAClC;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;AACnB;;AAEA;EACE,yBAAyB;EACzB,gBAAgB;EAChB,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,YAAY;EACZ,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,iBAAiB;EACjB,+BAA+B;EAC/B,8BAA8B;EAC9B,cAAc;EACd,uBAAuB;EACvB,eAAe;AACjB;;AAEA;EACE,yDAAqD;EACrD,uBAAuB;EACvB,eAAe;EACf,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yDAAwD;EACxD,gBAAgB;EAChB,uBAAuB;EACvB,eAAe;EACf,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yDAA4D;EAC5D,uBAAuB;EACvB,eAAe;EACf,gBAAgB;EAChB,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,yBAAyB;EACzB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;AACnB;;AAEA;EACE,oBAAoB;EACpB,uBAAuB;EACvB,yBAAyB;EACzB,yBAAyB;EACzB,kBAAkB;EAClB,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,QAAQ;AACV;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,yBAAyB;EACzB,yBAAyB;EACzB,kBAAkB;EAClB,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,QAAQ;AACV;;AAEA;EACE,qBAAqB;EACrB,cAAc;EACd,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,sBAAsB;EACtB,iBAAiB;EACjB,oCAAoC;EACpC,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;EACd,mBAAmB;EACnB,wBAAwB;EACxB,gCAAgC;AAClC;;AAEA;EACE,gBAAgB;EAChB,oBAAoB;AACtB;;AAEA;EACE,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,qBAAqB;EACrB,uBAAuB;EACvB,kBAAkB;EAClB,iBAAiB;EACjB,2BAA2B;EAC3B,eAAe;EACf,gBAAgB;EAChB,QAAQ;EACR,aAAa;EACb,eAAe;EACf,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,mBAAmB;EACnB,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,WAAW;EACX,YAAY;AACd;;AAEA;EACE,gBAAgB;EAChB,eAAe;EACf,iBAAiB;EACjB,aAAa;EACb,mBAAmB;EACnB,iBAAiB;EACjB,sBAAsB;EACtB,yBAAyB;EACzB,cAAc;AAChB;;AAEA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,cAAc;EACd,6BAA6B;EAC7B,sBAAsB;EACtB,yBAAyB;EACzB,iBAAiB;EACjB,kBAAkB;EAClB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;EACvB,mBAAmB;EACnB,YAAY;EACZ,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,mBAAmB;EACnB,kBAAkB;EAClB,cAAc;EACd,6BAA6B;EAC7B,QAAQ;EACR,sBAAsB;EACtB,WAAW;EACX,iBAAiB;EACjB,kBAAkB;AACpB;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;EAClB,mBAAmB;EACnB,iBAAiB;EACjB,kBAAkB;EAClB,YAAY;EACZ,QAAQ;EACR,kBAAkB;EAClB,UAAU;AACZ;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,SAAS;EACT,OAAO;EACP,WAAW;EACX,WAAW;EACX,WAAW;EACX,8BAA8B;EAC9B,oEAAoE;AACtE;;AAEA;EACE,uBAAuB;EACvB,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,QAAQ;EACR,iBAAiB;EACjB,cAAc;EACd,qBAAqB;AACvB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,uBAAuB;EACvB,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,QAAQ;EACR,iBAAiB;AACnB;;AAEA;EACE,uBAAuB;EACvB,mBAAmB;EACnB,mBAAmB;EACnB,QAAQ;EACR,mBAAmB;EACnB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;EACzB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,oBAAoB;EACpB,yDAA4D;EAC5D,uBAAuB;EACvB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,iBAAiB;EACjB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,mBAAmB;EACnB,uBAAuB;EACvB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,yBAAyB;EACzB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,cAAc;EACd,iBAAiB;EACjB,sBAAsB;AACxB;;AAEA;EACE,eAAe;AACjB",sourcesContent:['html,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n}\n\n#log {\n  max-height: 92%;\n  max-width: 100%;\n  overflow: auto;\n  overflow-wrap: break-word;\n}\n\n.ChatUi {\n  position: absolute;\n  top: 5px;\n  bottom: 5px;\n  left: 0;\n  right: 0;\n  background-color: var(--bgColor);\n}\n\n.chat-input-text {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-page-fre {\n  overflow-wrap: break-word;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  margin-bottom: 5px;\n}\n\n.chat-input-text:focus {\n  outline: none;\n}\n\n.chat-footer-hyper-link-text {\n  /* Hyperlink */\n  height: 16px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  text-decoration-line: underline;\n  /* Excel Colors / XL Primary */\n  color: #107c41;\n  /* Inside auto layout */\n  margin-top: 3px;\n}\n\n.chat-footer-like-button {\n  background-image: url("./../../assets/like-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-like-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-dislike-button {\n  background-image: url("./../../assets/dislike-icon.svg");\n  margin-left: 8px;\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-dislike-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-info-button {\n  background-image: url("./../../assets/information-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  margin-left: 8px;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-info-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-log {\n  padding-top: 5px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  background-color: white;\n  margin-bottom: 5px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-log-human {\n  align-self: flex-end;\n  align-items: flex-start;\n  border: 1px solid #bebbb8;\n  background-color: #edebe9;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 10px 0px 5px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt {\n  align-self: flex-start;\n  align-items: flex-start;\n  border: 1px solid #d2d0ce;\n  background-color: #ffffff;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 0px 0px 15px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt-designerlink {\n  text-decoration: none;\n  color: #b1470e;\n  margin-right: 4px;\n}\n\n.chat-log-suggestion ul {\n  padding-left: 15px;\n}\n\n.chat-log-suggestion {\n  align-self: flex-start;\n  text-align: start;\n  border: 1px solid rgb(210, 208, 206);\n  border-radius: 4px;\n  padding: 8px 10px;\n  max-width: 88%;\n  text-overflow: clip;\n  margin: 0px 0px 0px 15px;\n  white-space: pre-wrap !important;\n}\n\n.chat-log-suggestion-header {\n  font-weight: 600;\n  margin-bottom: 0.5vh;\n}\n\n.welcome-message {\n  margin-top: 100px;\n  padding-top: 20px;\n}\n\n.disclaimer {\n  font-size: 0.69rem;\n  line-height: 127%;\n  color: #707070;\n  margin: 4px 20px 0px 15px;\n}\n\n.chat-suggestionPane {\n  align-items: flex-end;\n  background: transparent;\n  margin-right: 10px;\n  margin-left: 10px;\n  justify-content: flex-start;\n  font-size: 12px;\n  padding: 4px 0px;\n  gap: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  font-family: "Segoe UI";\n  font-style: normal;\n}\n\n.chat-suggestionPane-heading {\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n\n.chat-suggestionPane-headingImage {\n  width: 16px;\n  height: 16px;\n}\n\n.chat-suggestionPane-headingText {\n  font-weight: 700;\n  font-size: 10px;\n  line-height: 13px;\n  display: flex;\n  align-items: center;\n  text-align: right;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: #949494;\n}\n\n.chat-suggestionPane-icon {\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  vertical-align: middle;\n  border: 2px solid #107c41;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 6px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-suggestionPane-button {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 32px;\n  background: #ffffff;\n  border: 2px solid #107c41;\n  border-radius: 6px;\n  line-height: 16px;\n  padding: 0px 10px;\n}\n\n.chat-suggestionPane-label {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  order: 0;\n  vertical-align: middle;\n  margin: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.user-chat-query-container {\n  margin: 12px;\n}\n\n.chat-input {\n  border: 1px solid #d1d1d1;\n  border-radius: 8px;\n  background: #ffffff;\n  margin-left: 15px;\n  margin-right: 20px;\n  padding: 4px;\n  gap: 4px;\n  position: relative;\n  z-index: 1;\n}\n\n.chat-input-onfocus-border::after {\n  position: absolute;\n  z-index: -1;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 5px;\n  content: "";\n  border-radius: 0px 0px 8px 8px;\n  background-image: linear-gradient(90.5deg, #107c41 0%, #429537 100%);\n}\n\n.chat-fixed-input-text {\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n  color: #107c41;\n  white-space: pre-wrap;\n}\n\n.chat-fixed-input-text:focus {\n  outline: none;\n}\n\n.chat-input-ghost-text {\n  color: #bebebe;\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n}\n\n.chat-input-buttons {\n  align-items: flex-start;\n  background: #ffffff;\n  flex-direction: row;\n  gap: 2px;\n  margin-bottom: 10px;\n  justify-content: space-between;\n}\n\n.chat-input-buttons-suggestion {\n  align-self: flex-start;\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion > .ms-Button-flexContainer {\n  align-items: center;\n}\n\n.chat-input-buttons-suggestion:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-input-buttons-suggestion-clicked {\n  align-self: flex-start;\n  background-color: #edebe9;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion-clicked:hover {\n  background-color: #edebe9;\n}\n\n.chat-input-buttons-send {\n  align-self: flex-end;\n  background-image: url("./../../assets/send-button-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-right: 2px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-send:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-taskPane-learn-more-button {\n  align-items: center;\n  justify-content: center;\n  width: 77px;\n  height: 24px;\n  background: transparent;\n  border: 1px solid #616161;\n  border-radius: 4px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  color: #616161;\n  line-height: 16px;\n  box-sizing: border-box;\n}\n\n.chat-taskPane-learn-more-button:hover {\n  cursor: pointer;\n}\n'],sourceRoot:""}]);const C=g},92494:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(50709),o=a.n(n),r=a(28354),i=a.n(r)()(o());i.push([e.id,"/* Common properties */\nbutton.chat-conditional-formatting-suggestion-pill,\nbutton.chat-conditional-formatting-suggestion-pill-dark-mode {\n  margin-bottom: 10px;\n  display: inline-block;\n  padding: 4px 8px; /* Shorthand for padding-top, padding-bottom, padding-left, and padding-right */\n  text-align: start;\n}\n\nbutton.chat-conditional-formatting-suggestion-pill {\n  background-color: #f5f5f5; /* Default background color */\n  border-color: transparent; /* Shorthand for all border colors */\n}\n\nbutton.chat-conditional-formatting-suggestion-pill-dark-mode {\n  background-color: #0a0a0a; /* Specific background color for dark mode */\n  border-color: #707070; /* Shorthand for all border colors */\n}\n","",{version:3,sources:["webpack://./src/frontend/styles/CommandingChatCard.css"],names:[],mappings:"AAAA,sBAAsB;AACtB;;EAEE,mBAAmB;EACnB,qBAAqB;EACrB,gBAAgB,EAAE,+EAA+E;EACjG,iBAAiB;AACnB;;AAEA;EACE,yBAAyB,EAAE,6BAA6B;EACxD,yBAAyB,EAAE,oCAAoC;AACjE;;AAEA;EACE,yBAAyB,EAAE,4CAA4C;EACvE,qBAAqB,EAAE,oCAAoC;AAC7D",sourcesContent:["/* Common properties */\nbutton.chat-conditional-formatting-suggestion-pill,\nbutton.chat-conditional-formatting-suggestion-pill-dark-mode {\n  margin-bottom: 10px;\n  display: inline-block;\n  padding: 4px 8px; /* Shorthand for padding-top, padding-bottom, padding-left, and padding-right */\n  text-align: start;\n}\n\nbutton.chat-conditional-formatting-suggestion-pill {\n  background-color: #f5f5f5; /* Default background color */\n  border-color: transparent; /* Shorthand for all border colors */\n}\n\nbutton.chat-conditional-formatting-suggestion-pill-dark-mode {\n  background-color: #0a0a0a; /* Specific background color for dark mode */\n  border-color: #707070; /* Shorthand for all border colors */\n}\n"],sourceRoot:""}]);const l=i},35602:(e,t,a)=>{a.d(t,{A:()=>l});var n=a(50709),o=a.n(n),r=a(28354),i=a.n(r)()(o());i.push([e.id,'.chart>svg{overflow:hidden}.query-result{font-size:15px;line-height:21px;overflow:hidden;width:100%}.query-result thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.query-result thead tr:last-child{border-bottom:1px solid #7ca6d5}.query-result__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.query-result__table{border:none;border-collapse:collapse}.query-result__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .query-result__text{text-align:left}html[dir=rtl] .query-result__text{text-align:right}.query-result__header{font-weight:bold}.query-result__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .query-result__right-aligned{text-align:right}html[dir=rtl] .query-result__right-aligned{text-align:left}.query-result__grand-total{font-weight:bold}.query-result__subtotal{font-weight:bold}.query-result__highlight-cell{color:#ed7331}.query-result__no-headers{padding:0 4px}.pivot-table-light16{font-size:15px;line-height:21px;overflow:hidden;width:100%;font-size:12px}.pivot-table-light16 thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.pivot-table-light16 thead tr:last-child{border-bottom:1px solid #7ca6d5}.pivot-table-light16__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.pivot-table-light16__table{border:none;border-collapse:collapse}.pivot-table-light16__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .pivot-table-light16__text{text-align:left}html[dir=rtl] .pivot-table-light16__text{text-align:right}.pivot-table-light16__header{font-weight:bold}.pivot-table-light16__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .pivot-table-light16__right-aligned{text-align:right}html[dir=rtl] .pivot-table-light16__right-aligned{text-align:left}.pivot-table-light16__grand-total{font-weight:bold}.pivot-table-light16__subtotal{font-weight:bold}.pivot-table-light16__highlight-cell{color:#ed7331}.pivot-table-light16__subtotal-row{border-bottom:1px solid #7ca6d5}.pivot-table-light16__grand-total{border-top:1px solid #7ca6d5;border-bottom:1px solid rgba(0,0,0,0)}.pivot-table-light16__subtotal{border-bottom:1px solid #7ca6d5}.query-result{font-size:15px;line-height:21px;overflow:hidden;width:100%}.query-result thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.query-result thead tr:last-child{border-bottom:1px solid #7ca6d5}.query-result__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.query-result__table{border:none;border-collapse:collapse}.query-result__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .query-result__text{text-align:left}html[dir=rtl] .query-result__text{text-align:right}.query-result__header{font-weight:bold}.query-result__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .query-result__right-aligned{text-align:right}html[dir=rtl] .query-result__right-aligned{text-align:left}.query-result__grand-total{font-weight:bold}.query-result__subtotal{font-weight:bold}.query-result__highlight-cell{color:#ed7331}.query-result__no-headers{padding:0 4px}.recommendation{position:relative;outline:none;border-style:none;list-style:none;margin-left:20px;margin-right:20px;border:1px solid #e0e0e0}.theme-colorful .recommendation{background-color:#fff}.theme-dark-gray .recommendation{background-color:#fff}.theme-black .recommendation{background-color:#fff}.theme-white .recommendation{background-color:#fff}.theme-colorful .recommendation{color:#262626}.theme-dark-gray .recommendation{color:#262626}.theme-black .recommendation{color:#262626}.theme-white .recommendation{color:#262626}.recommendation::after{-webkit-pointer-events:none;-o-pointer-events:none;-moz-pointer-events:none;-ms-pointer-events:none;pointer-events:none;content:"";position:absolute;left:0;top:0;bottom:0;right:0;border-radius:2px;border-width:2px}.theme-colorful .recommendation::after{border-color:#c6c6c6}.theme-dark-gray .recommendation::after{border-color:#444}.theme-black .recommendation::after{border-color:#505050}.theme-white .recommendation::after{border-color:#c6c6c6}html[dir=ltr] .recommendation::after{box-shadow:0 2px 4px -0.75px rgba(0,0,0,.1)}html[dir=rtl] .recommendation::after{box-shadow:0 2px 4px -0.75px rgba(0,0,0,.1)}.theme-colorful.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#107c41}.theme-dark-gray.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#4e9668}.theme-black.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#4e9668}.theme-white.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#107c41}@media screen and (-ms-high-contrast: active),screen and (forced-colors: active){.recommendation:focus::after{border-style:dashed}}.theme-colorful .recommendation:hover::after{border-color:#107c41}.theme-dark-gray .recommendation:hover::after{border-color:#4e9668}.theme-black .recommendation:hover::after{border-color:#4e9668}.theme-white .recommendation:hover::after{border-color:#107c41}@media screen and (-ms-high-contrast: active),screen and (forced-colors: active){.recommendation:hover::after{border-style:dashed}}.recommendation__chart,.recommendation__pivot-table,.recommendation__empty-pivot-table,.recommendation__query-result{margin:8px 0 0}.recommendation__chart{padding-top:50%;position:relative;border:1px solid #e0e0e0;border-radius:2px}.recommendation__chart .chart{position:absolute;top:0;left:0;right:0;bottom:0}.recommendation__pivot-table{border:1px solid #e0e0e0;border-radius:2px}.recommendation__empty-pivot-table,.recommendation__query-result{padding:12px;border:1px solid #e0e0e0;border-radius:2px}.recommendation__invalid{background-color:#edebe9;opacity:.5}.recommendation__title{display:flex}.recommendation__title button{margin-top:13px;width:16px;height:16px;top:0;z-index:1}html[dir=ltr] .recommendation__title button{margin-left:10px}html[dir=rtl] .recommendation__title button{margin-right:10px}.recommendation__title button i{font-size:12px}.recommendation__title-group:last-child{padding-bottom:8px}.recommendation__collapsed{cursor:pointer}.recommendation__footer{font-family:"Segoe UI";font-style:normal;font-weight:400;font-size:12px;line-height:16px;display:flex;align-items:center;color:#242424}.recommendation__footer-insert-explain{margin:0px 8px 8px 8px;border:1px solid #d1d1d1;border-radius:4px}.recommendation-title{font-size:14px;font-weight:700;line-height:20px;margin:0;vertical-align:top;text-overflow:ellipsis;overflow:hidden}.recommendation-title__rich-text__0{color:#bc5610}.recommendation-title__rich-text__1{color:blue}.recommendation-subtitle{color:#323130;font-size:12px;margin:0;padding:2px 0 4px;vertical-align:top;word-wrap:break-word;overflow-wrap:break-word}.explanation-dropdown{color:#107c41;font-size:12px}.explanation-dropdown:hover{color:#0f703b}.explanation-dropdown:active{color:#094624}.explanation-dropdown:disabled{color:#bdbdbd}.explanation-dropdown i{color:inherit}.explanation-content{margin:0px 8px}.column-recommendation .formula-description{padding:0;box-sizing:border-box}.column-recommendation .formula-description p{all:inherit}.python-recommendation__title{font-weight:600;margin-top:12px;color:#242424}.python-recommendation .monaco-read-only{width:auto}.python-recommendation .monaco-read-only .monaco-editor .cursors-layer>.cursor{display:none !important}.python-recommendation .python-description{margin:8px 0px 0px;padding:0;box-sizing:border-box}.python-recommendation .python-description p{all:inherit}.recommendation__text-analysis__bullet-header{font-weight:bold}.AugloopDiganosticsPaneContainer{overflow:auto;padding-left:"2%";margin:0;width:"96%"}.hideOverflow{width:90%;text-overflow:ellipsis}.tree{--spacing: 1rem;--radius: 7px;padding-left:0;padding-inline-start:0}.tree li{display:block;position:relative;padding-inline-start:0;padding-left:calc(2*var(--spacing) - var(--radius) - 2px)}.tree ul{margin-left:calc(var(--radius) - var(--spacing));padding-left:0;padding-inline-start:0}.tree ul li{border-left:2px solid #ddd}.tree ul li:last-child{border-color:rgba(0,0,0,0)}.tree ul li::before{content:"";display:block;position:absolute;top:calc(var(--spacing)/-2);left:-2px;width:calc(var(--spacing) + 2px);height:calc(var(--spacing) + 1px);border:solid #ddd;border-width:0 0 2px 2px}.tree summary{display:block;cursor:pointer}.tree summary::marker,.tree summary::-webkit-details-marker{display:none}.tree summary:focus{outline:none}.tree summary:focus-visible{outline:1px dotted #000}.tree li::after,.tree summary::before{content:"";display:block;position:absolute;top:calc(var(--spacing)/2 - var(--radius));left:calc(var(--spacing) - var(--radius) - 1px);width:calc(2*var(--radius));height:calc(2*var(--radius));border-radius:50%;background:#ddd}.tree summary::before{z-index:1;background:#7196c7 0 0}.tree details[open]>summary::before{background-position:calc(-2*var(--radius)) 0}',"",{version:3,sources:["webpack://./src/frontend/styles/components/_chart.scss","webpack://./src/frontend/styles/components/_preview-table.scss","webpack://./../../../../npm/.store/sdx_officecopilot/@fluentui-common-styles@1.2.58-938c4d7a801cd37a7015/node_modules/@fluentui/common-styles/dist/sass/_i18n.scss","webpack://./src/frontend/styles/components/_query-result.scss","webpack://./src/frontend/styles/components/_pivot-table.scss","webpack://./src/frontend/styles/components/_recommendation.scss","webpack://./src/frontend/styles/abstracts/_mixins.scss","webpack://./src/frontend/styles/abstracts/_theming.scss","webpack://./src/frontend/styles/abstracts/_palette.scss","webpack://./src/frontend/styles/components/_recommendation-title.scss","webpack://./src/frontend/styles/components/_explanation.scss","webpack://./src/frontend/styles/components/_column-recommendation.scss","webpack://./src/frontend/styles/components/_python-recommendation.scss","webpack://./src/frontend/styles/components/_text-analysis.scss","webpack://./src/frontend/styles/components/augloop-diagnostics.scss"],names:[],mappings:"AAGE,WACE,eAAA,CAAA,cCDF,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,mCACE,kCAAA,CACA,+BAAA,CAGF,kCACE,+BAAA,CAGF,wBACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,qBACE,WAAA,CACA,wBAAA,CAGF,oBACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,kCA8NQ,eAAA,CAvNR,kCA0NQ,gBAAA,CDhMV,sBACE,gBAAA,CAGF,oBACE,qCAAA,CCtCA,2CAqOQ,gBAAA,CA9NR,2CAiOQ,eAAA,CD3LV,2BACE,gBAAA,CAGF,wBACE,gBAAA,CAGF,8BACE,aAAA,CEpDF,0BACE,aAAA,CCJJ,qBHDE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAAA,cAAA,CAEA,0CACE,kCAAA,CACA,+BAAA,CAGF,yCACE,+BAAA,CAGF,+BACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,4BACE,WAAA,CACA,wBAAA,CAGF,2BACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,yCA8NQ,eAAA,CAvNR,yCA0NQ,gBAAA,CDhMV,6BACE,gBAAA,CAGF,2BACE,qCAAA,CCtCA,kDAqOQ,gBAAA,CA9NR,kDAiOQ,eAAA,CD3LV,kCACE,gBAAA,CAGF,+BACE,gBAAA,CAGF,qCACE,aAAA,CGnDF,mCACE,+BAAA,CAGF,kCACE,4BAAA,CACA,qCAAA,CAGF,+BACE,+BAAA,CDdJ,cFDE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,mCACE,kCAAA,CACA,+BAAA,CAGF,kCACE,+BAAA,CAGF,wBACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,qBACE,WAAA,CACA,wBAAA,CAGF,oBACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,kCA8NQ,eAAA,CAvNR,kCA0NQ,gBAAA,CDhMV,sBACE,gBAAA,CAGF,oBACE,qCAAA,CCtCA,2CAqOQ,gBAAA,CA9NR,2CAiOQ,eAAA,CD3LV,2BACE,gBAAA,CAGF,wBACE,gBAAA,CAGF,8BACE,aAAA,CEpDF,0BACE,aAAA,CENJ,gBC0HE,iBAAA,CACA,YAAA,CACA,iBAAA,CD1HA,eAAA,CAEA,gBAAA,CACA,iBAAA,CACA,wBAAA,CE8SE,gCACE,qBAAA,CADF,iCACE,qBAAA,CADF,6BACE,qBAAA,CADF,6BACE,qBAAA,CADF,gCACE,aAAA,CADF,iCACE,aAAA,CADF,6BACE,aAAA,CADF,6BACE,aAAA,CDxMJ,uBAzDA,2BAAA,CACA,sBAAA,CACA,wBAAA,CACA,uBAAA,CACA,mBAAA,CAwDE,UAAA,CACA,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,OAAA,CACA,iBAAA,CAEA,gBAAA,CC4LA,uCACE,oBAAA,CADF,wCACE,iBAAA,CADF,oCACE,oBAAA,CADF,oCACE,oBAAA,CLlTF,qCA+OI,2CAAA,CAxOJ,qCA4OI,2CAAA,CK8EJ,uEACE,oBAAA,CADF,wEACE,oBAAA,CADF,oEACE,oBAAA,CADF,oEACE,oBAAA,CDrMJ,iFAxCA,6BAcE,mBAAA,CAAA,CC8MA,6CACE,oBAAA,CADF,8CACE,oBAAA,CADF,0CACE,oBAAA,CADF,0CACE,oBAAA,CDrLJ,iFArCA,6BAGI,mBAAA,CAAA,CDtFJ,qHAIE,cAAA,CAIF,uBACE,eAAA,CACA,iBAAA,CACA,wBAAA,CACA,iBAAA,CAGA,8BACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,OAAA,CACA,QAAA,CAIJ,6BACE,wBAAA,CACA,iBAAA,CAGF,iEAEE,YAAA,CACA,wBAAA,CACA,iBAAA,CAGF,yBACE,wBGtCK,CHuCL,UAAA,CAGF,uBAGE,YAAA,CACA,8BAEE,eAAA,CACA,UAAA,CACA,WAAA,CACA,KAAA,CACA,SAAA,CHxDF,4CAyKI,gBGtHmB,CH5CvB,4CAqKI,iBGzHmB,CAOrB,gCACE,cAAA,CAKN,wCACE,kBAAA,CAGF,2BACE,cAAA,CAGF,wBACE,sBAAA,CACA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,gBAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CAGF,uCACE,sBAAA,CACA,wBAAA,CACA,iBAAA,CIvFJ,sBACE,cAAA,CACA,eAAA,CACA,gBAAA,CACA,QAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CAGE,oCACE,aAAA,CAEF,oCACE,UD+BU,CC1BhB,yBACE,aDlBQ,CCmBR,cAAA,CACA,QAAA,CACA,iBAAA,CACA,kBAAA,CH+HA,oBAAA,CAEA,wBAAA,CI7JF,sBACE,aAAA,CACA,cAAA,CAEA,4BACE,aAAA,CAEF,6BACE,aAAA,CAEF,+BACE,aAAA,CAGF,wBACE,aAAA,CAIJ,qBACE,cAAA,CCnBA,4CACE,SAAA,CACA,qBAAA,CAEA,8CACE,WAAA,CCLJ,8BACE,eAAA,CACA,eAAA,CACA,aAAA,CAGF,yCACE,UAAA,CAEA,+EACE,uBAAA,CAIJ,2CACE,kBAAA,CACA,SAAA,CACA,qBAAA,CAEA,6CACE,WAAA,CCnBN,8CACE,gBAAA,CCDF,iCACE,aAAA,CACA,iBAAA,CACA,QAAA,CACA,WAAA,CAGF,cACE,SAAA,CACA,sBAAA,CAMF,MACE,eAAA,CACA,aAAA,CACA,cAAA,CACA,sBAAA,CAGF,SACE,aAAA,CACA,iBAAA,CACA,sBAAA,CACA,yDAAA,CAGF,SACE,gDAAA,CACA,cAAA,CACA,sBAAA,CAGF,YACE,0BAAA,CAGF,uBACE,0BAAA,CAGF,oBACE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,2BAAA,CACA,SAAA,CACA,gCAAA,CACA,iCAAA,CACA,iBAAA,CACA,wBAAA,CAGF,cACE,aAAA,CACA,cAAA,CAGF,4DAEE,YAAA,CAGF,oBACE,YAAA,CAGF,4BACE,uBAAA,CAGF,sCAEE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,0CAAA,CACA,+CAAA,CACA,2BAAA,CACA,4BAAA,CACA,iBAAA,CACA,eAAA,CAGF,sBACE,SAAA,CACA,sBAAA,CAGF,oCACE,4CAAA",sourcesContent:['\ufeff@import "../abstracts/mixins";\n\n.chart {\n  > svg {\n    overflow: hidden;\n  }\n}\n','@import "~@fluentui/common-styles/dist/sass/_i18n";\n\n@mixin preview-table {\n  font-size: 15px;\n  line-height: 21px;\n  overflow: hidden;\n  width: 100%;\n\n  & thead tr:first-child {\n    border-top: 1px solid transparent;\n    border-bottom: 1px solid #dce6f1;\n  }\n\n  & thead tr:last-child {\n    border-bottom: 1px solid #7ca6d5;\n  }\n\n  &__ellipsis {\n    font-size: 20px;\n    line-height: 21px;\n    overflow: hidden;\n    width: 100%;\n  }\n\n  &__table {\n    border: none;\n    border-collapse: collapse;\n  }\n\n  &__text {\n    height: 21px;\n    overflow: hidden;\n    padding: 0 4px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    @include text-align(left);\n  }\n\n  &__header {\n    font-weight: bold;\n  }\n\n  &__body {\n    border-bottom: 1px solid transparent;\n  }\n\n  &__right-aligned {\n    @include text-align(right);\n  }\n\n  &__grand-total {\n    font-weight: bold;\n  }\n\n  &__subtotal {\n    font-weight: bold;\n  }\n\n  &__highlight-cell {\n    color: #ed7331;\n  }\n}\n',"// Some things copied from WinJS with <3\n\n\n// LTR mixin definition\n@mixin LTR {\n    html[dir='ltr'] & {\n        @content;\n    }\n}\n\n// RTL mixin definition\n@mixin RTL {\n    html[dir='rtl'] & {\n        @content;\n    }\n}\n\n// Use baseRTL for a root element of a control that needs rtl support\n@mixin baseRtl {\n    @include RTL {\n        direction: rtl;\n        unicode-bidi: bidi-override;\n    }\n}\n\n/*\n    Common CSS property mixins with support for RTL.\n    Use these mixins when you want to automatically create RTL versions of your properties.\n    They are in alphabetical order (a-z).\n*/\n\n@mixin border-color($top, $right, $bottom, $left) {\n    border-color: $top $right $bottom $left;\n    @include RTL {\n        border-color: $top $left $bottom $right;\n    }\n}\n\n@mixin border-left($width, $style, $color) {\n    @include LTR {\n        border-left: $width $style $color;\n    }\n    @include RTL {\n        border-right: $width $style $color;\n    }\n}\n\n@mixin border-left-color($color) {\n    @include LTR {\n        border-left-color: $color;\n    }\n    @include RTL {\n        border-right-color: $color;\n    }\n}\n\n@mixin border-left-style($style) {\n    @include LTR {\n        border-left-style: $style;\n    }\n    @include RTL {\n        border-right-style: $style;\n    }\n}\n\n@mixin border-left-width($width) {\n    @include LTR {\n        border-left-width: $width;\n    }\n    @include RTL {\n        border-right-width: $width;\n    }\n}\n\n@mixin border-radius($topLeft, $topRight, $bottomRight, $bottomLeft) {\n    border-radius: $topLeft $topRight $bottomRight $bottomLeft;\n    @include RTL {\n        border-radius: $topRight $topLeft $bottomLeft $bottomRight;\n    }\n}\n\n@mixin border-right($width, $style, $color) {\n    @include LTR {\n        border-right: $width $style $color;\n    }\n    @include RTL {\n        border-left: $width $style $color;\n    }\n}\n\n@mixin border-right-color($color) {\n    @include LTR {\n        border-right-color: $color;\n    }\n    @include RTL {\n        border-left-color: $color;\n    }\n}\n\n@mixin border-right-style($style) {\n    @include LTR {\n         border-right-style: $style;\n    }\n    @include RTL {\n        border-left-style: $style;\n    }\n}\n\n@mixin border-right-width($width) {\n    @include LTR {\n        border-right-width: $width;\n    }\n    @include RTL {\n        border-left-width: $width;\n    }\n}\n\n@mixin clear($side) {\n    @if $side == left {\n        @include LTR {\n            clear: $side;\n        }\n        @include RTL {\n            clear: right;\n        }\n    } @else if $side == right {\n        @include LTR {\n            clear: $side;\n        }\n\n        @include RTL {\n            clear: left;\n        }\n    } @else {\n        clear: $side;\n    }\n}\n\n@mixin float($direction) {\n    @if $direction == left {\n        @include LTR {\n            float: left;\n        }\n        @include RTL {\n            float: right;\n        }\n    } @else {\n        @include LTR {\n            float: right;\n        }\n        @include RTL {\n            float: left;\n        }\n    }\n}\n\n@mixin left($distance) {\n    @include LTR {\n        left: $distance;\n    }\n    @include RTL {\n        right: $distance;\n    }\n}\n\n@mixin margin($top, $right, $bottom, $left) {\n    margin: $top $right $bottom $left;\n    @include RTL {\n        margin: $top $left $bottom $right;\n    }\n}\n\n@mixin margin-left($distance) {\n    @include LTR {\n        margin-left: $distance;\n    }\n    @include RTL {\n        margin-right: $distance;\n    }\n}\n\n@mixin margin-right($distance) {\n    @include LTR {\n        margin-right: $distance;\n    }\n    @include RTL {\n        margin-left: $distance;\n    }\n}\n\n@mixin padding($top, $right, $bottom, $left) {\n    padding: $top $right $bottom $left;\n    @include RTL {\n        padding: $top $left $bottom $right;\n    }\n}\n\n@mixin padding-left($distance) {\n    @include LTR {\n        padding-left: $distance;\n    }\n    @include RTL {\n        padding-right: $distance;\n    }\n}\n\n@mixin padding-right($distance) {\n    @include LTR {\n        padding-right: $distance;\n    }\n    @include RTL {\n        padding-left: $distance;\n    }\n}\n\n@mixin right($distance) {\n    @include LTR {\n        right: $distance;\n    }\n    @include RTL {\n        left: $distance;\n    }\n}\n\n@mixin text-align($direction) {\n    @if $direction == left {\n        @include LTR {\n            text-align: left;\n        }\n        @include RTL {\n            text-align: right;\n        }\n    } @else {\n        @include LTR {\n            text-align: right;\n        }\n        @include RTL {\n            text-align: left;\n        }\n    }\n}\n\n@mixin box-shadow($left, $etc) {\n    @include LTR {\n        box-shadow: $left $etc;\n    }\n\n    @include RTL {\n        box-shadow: -$left $etc;\n    }\n}\n\n@mixin transform-scaleX($scaleX: 1) {\n    @include LTR {\n        transform: scaleX($scaleX);\n    }\n    @include RTL {\n        transform: scaleX(-$scaleX);\n    }\n}\n\n@mixin transform-translateX($distance) {\n    @include LTR {\n        transform: translateX($distance);\n    }\n    @include RTL {\n        transform: translateX(-$distance);\n    }\n}\n\n// only supported when ONLY left/right are declared\n@mixin transition-property($direction) {\n    @if $direction == left {\n        @include LTR {\n            transition-property: left;\n        }\n        @include RTL {\n            transition-property: right;\n        }\n    } @else {\n        @include LTR {\n            transition-property: right;\n        }\n        @include RTL {\n            transition-property: left;\n        }\n    }\n}\n\n// Disables high contrast color adjusts for Edge/IE11\n@mixin highContrastAdjust {\n  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {\n    -ms-high-contrast-adjust: none;\n    forced-color-adjust: none;\n  }\n}\n",'@import "../abstracts/mixins";\n@import "../abstracts/variables";\n@import "./preview-table";\n\n.query-result {\n  @include preview-table;\n\n  &__no-headers {\n    padding: 0 4px;\n  }\n}\n','@import "./preview-table";\n\n// Matches the default PivotTabyle style, which is "Light Blue, Pivot Style Light 16"\n// For use in clients that don\'t support the TableStyle API\n.pivot-table-light16 {\n  @include preview-table;\n  font-size: 12px;\n\n  &__subtotal-row {\n    border-bottom: 1px solid #7ca6d5;\n  }\n\n  &__grand-total {\n    border-top: 1px solid #7ca6d5;\n    border-bottom: 1px solid transparent;\n  }\n\n  &__subtotal {\n    border-bottom: 1px solid #7ca6d5;\n  }\n}\n','@import "../abstracts/mixins";\n\n.recommendation {\n  @include card;\n  list-style: none;\n  // margin in copilot\n  margin-left: 20px;\n  margin-right: 20px;\n  border: 1px solid #e0e0e0;\n\n  &__chart,\n  &__pivot-table,\n  &__empty-pivot-table,\n  &__query-result {\n    margin: 8px 0 0;\n  }\n\n  // Maintain a 2:1 aspect ratio for the chart\n  &__chart {\n    padding-top: 50%;\n    position: relative;\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n\n    // Fill the entire available area\n    .chart {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n  }\n\n  &__pivot-table {\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n  }\n\n  &__empty-pivot-table,\n  &__query-result {\n    padding: 12px;\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n  }\n\n  &__invalid {\n    background-color: $Gray30;\n    opacity: 0.5;\n  }\n\n  &__title {\n    // @include expandable-card-button;\n    /* stylelint-disable-next-line plugin/no-unsupported-browser-features */\n    display: flex;\n    button {\n      @include margin-left(10px);\n      margin-top: 13px;\n      width: 16px;\n      height: 16px;\n      top: 0;\n      z-index: 1;\n\n      i {\n        font-size: 12px;\n      }\n    }\n  }\n\n  &__title-group:last-child {\n    padding-bottom: 8px;\n  }\n\n  &__collapsed {\n    cursor: pointer;\n  }\n\n  &__footer {\n    font-family: "Segoe UI";\n    font-style: normal;\n    font-weight: 400;\n    font-size: 12px;\n    line-height: 16px;\n    display: flex;\n    align-items: center;\n    color: #242424;\n  }\n\n  &__footer-insert-explain {\n    margin: 0px 8px 8px 8px;\n    border: 1px solid #d1d1d1;\n    border-radius: 4px;\n  }\n}\n','@import "~@fluentui/common-styles/dist/sass/_i18n";\n@import "./_theming";\n\n@mixin box-shadow-inset($left, $top, $blur, $spread, $color, $inset: false) {\n  @if $inset {\n    @include LTR {\n      -webkit-box-shadow: inset $left $top $blur $spread $color;\n      -moz-box-shadow: inset $left $top $blur $spread $color;\n      box-shadow: inset $left $top $blur $spread $color;\n    }\n    // @include RTL {\n    //     -webkit-box-shadow: inset -$left $top $blur $spread $color;\n    //     -moz-box-shadow: inset -$left $top $blur $spread $color;\n    //     box-shadow: inset -$left $top $blur $spread $color;\n    // }\n  } @else {\n    @include LTR {\n      -webkit-box-shadow: $left $top $blur $spread $color;\n      -moz-box-shadow: $left $top $blur $spread $color;\n      box-shadow: $left $top $blur $spread $color;\n    }\n    @include RTL {\n      -webkit-box-shadow: -$left $top $blur $spread $color;\n      -moz-box-shadow: -$left $top $blur $spread $color;\n      box-shadow: -$left $top $blur $spread $color;\n    }\n  }\n}\n\n@mixin user-select($value: none) {\n  -webkit-touch-callout: $value;\n  -webkit-user-select: $value;\n  -khtml-user-select: $value;\n  -moz-user-select: $value;\n  -ms-user-select: $value;\n  user-select: $value;\n}\n\n@mixin transform($transforms) {\n  -moz-transform: $transforms;\n  -o-transform: $transforms;\n  -ms-transform: $transforms;\n  -webkit-transform: $transforms;\n  transform: $transforms;\n}\n\n@mixin no-transitions {\n  -webkit-transition-property: none;\n  -moz-transition-property: none;\n  -o-transition-property: none;\n  transition-property: none;\n}\n\n@mixin no-pointer-events {\n  -webkit-pointer-events: none;\n  -o-pointer-events: none;\n  -moz-pointer-events: none;\n  -ms-pointer-events: none;\n  pointer-events: none;\n}\n\n@mixin shimmer-table {\n  padding: 14px;\n\n  .ms-Shimmer-container {\n    margin: 10px 0;\n  }\n\n  &__top {\n    margin: 8px 0;\n  }\n\n  &__first-row {\n    margin-bottom: 13px;\n  }\n\n  &__main-row {\n    margin: 5px 0;\n  }\n\n  &__bottom-row {\n    margin-top: 18px;\n  }\n}\n\n@mixin card {\n  @include card-without-focus;\n\n  // This mirrors how Office UI Fabric does keyboard focus indicators. Use ::after pseudo-element\n  // with z-index so that no part of the focus outline is hidden.\n  &:focus::after {\n    @include card-focus-after-pseudo;\n  }\n  &:hover::after {\n    @include themify("border-color", "InsightsCardKeyboardStroke");\n    @include high-contrast {\n      border-style: dashed;\n    }\n  }\n}\n\n@mixin card-focus-after-pseudo {\n  @include themifyForFocus("border-color", "InsightsCardKeyboardStroke");\n  @include high-contrast {\n    border-style: dashed;\n  }\n}\n\n@mixin card-without-focus {\n  @include themify("background-color", "InsightsCardBkg");\n  @include themify("color", "InsightsCardText");\n  &::after {\n    @include themify("border-color", "InsightsCardStroke");\n    @include no-pointer-events;\n    content: "";\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    border-radius: 2px;\n    @include box-shadow(0, 2px 4px -0.75px rgba(0, 0, 0, 0.1));\n    border-width: 2px;\n  }\n  position: relative;\n  outline: none;\n  border-style: none;\n}\n\n@mixin high-contrast {\n  @media screen and (-ms-high-contrast: active),\n    screen and (forced-colors: active) {\n    @content;\n  }\n}\n\n@mixin not-high-contrast {\n  @media screen and (-ms-high-contrast: none),\n    screen and (forced-colors: none) {\n    @content;\n  }\n}\n\n@mixin highlighted-option {\n  -ms-high-contrast-adjust: none;\n  forced-color-adjust: none;\n\n  @include high-contrast {\n    color: HighlightText;\n    background-color: Highlight;\n  }\n}\n\n@mixin overflow-wrap-break-word {\n  /* IE11 implementation of overflow-wrap */\n  word-wrap: break-word;\n  /* stylelint-disable-next-line plugin/no-unsupported-browser-features */\n  overflow-wrap: break-word;\n}\n','@import "../abstracts/palette";\n\n/**\n * Each theme is divided into \'Taskpane\', \'Callout\', and \'Custom\' sections.  Theme names for \'Taskpane\' and \'Callout\'\n * are based upon real components in Excel.  Theme names for \'Custom\' are Insights-specific components that have no\n * Excel equivalent. We try to use the \'Taskpane\' and \'Callout\' theme names wherever possible, as they have actual\n * semantic meaning in Excel.\n */\n\n$themes: (\n  "colorful": (\n    // Taskpane\n    "Bkg": $GrayB,\n    "BkgSVFluentRefresh": $Gray94,\n    "Text": $GrayI,\n    "TextSecondary": $GrayE2,\n    "TextEmphasis": $XL7,\n    "TextEmphasisHover": $XL8,\n    "TextEmphasisPressed": $XL7,\n    "TextEmphasisSelected": $XL8,\n    "BkgCtlDisabled": $GrayA,\n    "TextCtlDisabled": $GrayC3,\n    "StrokeCtl": $GrayD,\n    "StrokeCtlDisabled": $GrayC,\n    "TextHyperlink": $XL6,\n    "TextHyperlinkHover": $XL5,\n    "TextHyperlinkPressed": $XL7,\n    "TextHyperlinkFocusRectangle": $GrayE2,\n    // Callout\n    "CalloutBkg": $White,\n    "CalloutText": $GrayI,\n    "CalloutTextSecondary": $GrayI,\n    "CalloutBkgCtl": $White,\n    "CalloutBkgCtlHover": $GrayA,\n    "CalloutBkgCtlPressed": $GrayB,\n    "CalloutTextCtl": $GrayI,\n    "CalloutTextCtlHover": $GrayI,\n    "CalloutTextCtlPressed": $GrayI,\n    "CalloutStrokeCtl": $GrayD,\n    "CalloutStrokeCtlHover": $GrayD,\n    "CalloutStrokeCtlPressed": $GrayD,\n    "CalloutTextHyperlink": $XL6,\n    "CalloutTextHyperlinkHover": $XL4,\n    "CalloutTextHyperlinkPressed": $XL7,\n    // Custom\n    "InsightsCardBkg": $White,\n    "InsightsCardText": $GrayI,\n    "InsightsCardStroke": $GrayC2,\n    "InsightsCardKeyboardStroke": $XLPrimary,\n    "InsightsChartBorder": $GrayB,\n    "InsightsDefaultKeyboardStroke": $GrayI,\n    "InsightsDialogKeyboardStroke": $GrayI,\n    "InsightsScrollBkg": $GrayC2,\n    "InsightsScrollSeparatorStroke": $GrayC2,\n    "InsightsSpinnerBkg": $XL6 $GrayC2 $GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": $GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": $GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": $GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": $GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": $GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": $GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": $GrayI,\n    "InsightsPreferencesCheckbox": $GrayI,\n    "InsightsPreferencesFieldListBkg": $White,\n    "InsightsPreferencesFieldListBorder": $GrayC2,\n    "InsightsPreferencesFieldBkgHover": $XL2,\n    "InsightsPreferencesFieldText": $GrayI,\n    "InsightsPreferencesDropdownBkgHover": $XL2,\n    "InsightsPreferencesDropdownBkg": $White,\n    "InsightsPreferencesDropdownBorder": $GrayC2,\n    "InsightsPreferencesFocusOutline": $GrayE2,\n    "InsightsSecondaryBkgCtl": $GrayB,\n    "InsightsSecondaryBkgCtlHover": $GrayC,\n    "InsightsSecondaryBkgCtlPressed": $GrayC2,\n    "InsightsSecondaryTextCtl": $GrayI,\n    "InsightsSecondaryTextCtlHover": $GrayI,\n    "InsightsSecondaryTextCtlPressed": $GrayI,\n    "InsightsSecondaryStrokeCtl": $GrayD,\n    "InsightsSecondaryStrokeCtlHover": $GrayD,\n    "InsightsSecondaryStrokeCtlPressed": $GrayD,\n  ),\n  "dark-gray": (\n    // Taskpane\n    "Bkg": $GrayE2,\n    "BkgSVFluentRefresh": $Gray18,\n    "Text": $White,\n    "TextSecondary": $White,\n    "TextEmphasis": $White,\n    "TextEmphasisHover": $White,\n    "TextEmphasisPressed": $White,\n    "TextEmphasisSelected": $White,\n    "BkgCtlDisabled": $GrayG,\n    "TextCtlDisabled": $GrayE2,\n    "StrokeCtl": $GrayE,\n    "StrokeCtlDisabled": $GrayF,\n    "TextHyperlink": $HyperlinkA,\n    "TextHyperlinkHover": $White,\n    "TextHyperlinkPressed": $HyperlinkB,\n    "TextHyperlinkFocusRectangle": $Gray18,\n    // Callout\n    "CalloutBkg": $GrayE2,\n    "CalloutText": $White,\n    "CalloutTextSecondary": $White,\n    "CalloutBkgCtl": $GrayE2,\n    "CalloutBkgCtlHover": $GrayE,\n    "CalloutBkgCtlPressed": $GrayD2,\n    "CalloutTextCtl": $White,\n    "CalloutTextCtlHover": $White,\n    "CalloutTextCtlPressed": $White,\n    "CalloutStrokeCtl": $GrayD,\n    "CalloutStrokeCtlHover": $GrayD,\n    "CalloutStrokeCtlPressed": $GrayD,\n    "CalloutTextHyperlink": $XL6,\n    "CalloutTextHyperlinkHover": $XL4,\n    "CalloutTextHyperlinkPressed": $XL7,\n    // Custom\n    "InsightsCardBkg": $White,\n    "InsightsCardText": $GrayI,\n    "InsightsCardStroke": $GrayG,\n    "InsightsCardKeyboardStroke": $XL4,\n    "InsightsChartBorder": $GrayB,\n    "InsightsDefaultKeyboardStroke": $White,\n    "InsightsDialogKeyboardStroke": $GrayI,\n    "InsightsScrollBkg": $GrayC2,\n    "InsightsScrollSeparatorStroke": $GrayG,\n    "InsightsSpinnerBkg": $XL6 $GrayC2 $GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": $GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": $GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": $GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": $GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": $GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": $GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": $GrayI,\n    "InsightsPreferencesCheckbox": $White,\n    "InsightsPreferencesFieldListBkg": $GrayK,\n    "InsightsPreferencesFieldListBorder": $GrayD,\n    "InsightsPreferencesFieldBkgHover": $Grey36,\n    "InsightsPreferencesFieldText": $White,\n    "InsightsPreferencesDropdownBkgHover": $Grey36,\n    "InsightsPreferencesDropdownBkg": $GrayK,\n    "InsightsPreferencesDropdownBorder": $GrayD,\n    "InsightsPreferencesFocusOutline": $White,\n    "InsightsSecondaryBkgCtl": $GrayE2,\n    "InsightsSecondaryBkgCtlHover": $GrayE,\n    "InsightsSecondaryBkgCtlPressed": $GrayD2,\n    "InsightsSecondaryTextCtl": $White,\n    "InsightsSecondaryTextCtlHover": $White,\n    "InsightsSecondaryTextCtlPressed": $White,\n    "InsightsSecondaryStrokeCtl": $GrayD,\n    "InsightsSecondaryStrokeCtlHover": $GrayD,\n    "InsightsSecondaryStrokeCtlPressed": $GrayD,\n  ),\n  "black": (\n    // Taskpane\n    "Bkg": $GrayI,\n    "BkgSVFluentRefresh": $GrayJ,\n    "Text": $White,\n    "TextSecondary": $GrayC3,\n    "TextEmphasis": $XL2,\n    "TextEmphasisHover": $XL2,\n    "TextEmphasisPressed": $XL2,\n    "TextEmphasisSelected": $White,\n    "BkgCtlDisabled": $GrayG,\n    "TextCtlDisabled": $GrayE2,\n    "StrokeCtl": $GrayD,\n    "StrokeCtlDisabled": $GrayF,\n    "TextHyperlink": $HyperlinkD,\n    "TextHyperlinkHover": $HyperlinkB,\n    "TextHyperlinkPressed": $White,\n    "TextHyperlinkFocusRectangle": $Gray20,\n    // Callout\n    "CalloutBkg": $GrayI,\n    "CalloutText": $White,\n    "CalloutTextSecondary": $White,\n    "CalloutBkgCtl": $GrayI,\n    "CalloutBkgCtlHover": $GrayH,\n    "CalloutBkgCtlPressed": $GrayG,\n    "CalloutTextCtl": $White,\n    "CalloutTextCtlHover": $White,\n    "CalloutTextCtlPressed": $White,\n    "CalloutStrokeCtl": $GrayE2,\n    "CalloutStrokeCtlHover": $GrayE2,\n    "CalloutStrokeCtlPressed": $GrayE2,\n    "CalloutTextHyperlink": $HyperlinkC,\n    "CalloutTextHyperlinkHover": $HyperlinkA,\n    "CalloutTextHyperlinkPressed": $White,\n    // Custom\n    "InsightsCardBkg": $White,\n    "InsightsCardText": $GrayI,\n    "InsightsCardStroke": $GrayF,\n    "InsightsCardKeyboardStroke": $XL4,\n    "InsightsChartBorder": $GrayB,\n    "InsightsDefaultKeyboardStroke": $White,\n    "InsightsDialogKeyboardStroke": $White,\n    "InsightsScrollBkg": $GrayF,\n    "InsightsScrollSeparatorStroke": $GrayF,\n    "InsightsSpinnerBkg": $XL6 $GrayC2 $GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": $GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": $GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": $GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": $GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": $GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": $GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": $GrayI,\n    "InsightsPreferencesCheckbox": $White,\n    "InsightsPreferencesFieldListBkg": $GrayH,\n    "InsightsPreferencesFieldListBorder": $GrayE,\n    "InsightsPreferencesFieldBkgHover": $XL7,\n    "InsightsPreferencesFieldText": $White,\n    "InsightsPreferencesDropdownBkgHover": $XL7,\n    "InsightsPreferencesDropdownBkg": $GrayH,\n    "InsightsPreferencesDropdownBorder": $GrayE,\n    "InsightsPreferencesFocusOutline": $Gray20,\n    "InsightsSecondaryBkgCtl": $GrayI,\n    "InsightsSecondaryBkgCtlHover": $GrayH,\n    "InsightsSecondaryBkgCtlPressed": $GrayG,\n    "InsightsSecondaryTextCtl": $White,\n    "InsightsSecondaryTextCtlHover": $White,\n    "InsightsSecondaryTextCtlPressed": $White,\n    "InsightsSecondaryStrokeCtl": $GrayE2,\n    "InsightsSecondaryStrokeCtlHover": $GrayE2,\n    "InsightsSecondaryStrokeCtlPressed": $GrayE2,\n  ),\n  "white": (\n    // Taskpane\n    "Bkg": $White,\n    "BkgSVFluentRefresh": $Gray94,\n    // Override $GrayA with $White\n    "Text": $GrayI,\n    "TextSecondary": $GrayE2,\n    "TextEmphasis": $XL6,\n    "TextEmphasisHover": $XL5,\n    "TextEmphasisPressed": $XL7,\n    "TextEmphasisSelected": $XL6,\n    "BkgCtlDisabled": $GrayA,\n    "TextCtlDisabled": $GrayC3,\n    "StrokeCtl": $GrayD,\n    "StrokeCtlDisabled": $GrayC,\n    "TextHyperlink": $XL6,\n    "TextHyperlinkHover": $XL4,\n    "TextHyperlinkPressed": $XL7,\n    "TextHyperlinkFocusRectangle": $GrayE2,\n    // Callout\n    "CalloutBkg": $White,\n    "CalloutText": $GrayI,\n    "CalloutTextSecondary": $GrayI,\n    "CalloutBkgCtl": $White,\n    "CalloutBkgCtlHover": $GrayA,\n    "CalloutBkgCtlPressed": $GrayB,\n    "CalloutTextCtl": $GrayI,\n    "CalloutTextCtlHover": $GrayI,\n    "CalloutTextCtlPressed": $GrayI,\n    "CalloutStrokeCtl": $GrayD,\n    "CalloutStrokeCtlHover": $GrayD,\n    "CalloutStrokeCtlPressed": $GrayD,\n    "CalloutTextHyperlink": $XL6,\n    "CalloutTextHyperlinkHover": $XL5,\n    "CalloutTextHyperlinkPressed": $XL7,\n    // Custom\n    "InsightsCardBkg": $White,\n    "InsightsCardText": $GrayI,\n    "InsightsCardStroke": $GrayC2,\n    "InsightsCardKeyboardStroke": $XLPrimary,\n    "InsightsChartBorder": $GrayB,\n    "InsightsDefaultKeyboardStroke": $GrayI,\n    "InsightsDialogKeyboardStroke": $GrayI,\n    "InsightsScrollBkg": $GrayC2,\n    "InsightsScrollSeparatorStroke": $GrayC2,\n    "InsightsSpinnerBkg": $XL6 $GrayC2 $GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": $GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": $GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": $GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": $White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": $GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": $GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": $GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": $GrayI,\n    "InsightsPreferencesCheckbox": $GrayI,\n    "InsightsPreferencesFieldListBkg": $White,\n    "InsightsPreferencesFieldListBorder": $GrayC,\n    "InsightsPreferencesFieldBkgHover": $XL2,\n    "InsightsPreferencesFieldText": $GrayI,\n    "InsightsPreferencesDropdownBkgHover": $XL2,\n    "InsightsPreferencesDropdownBkg": $White,\n    "InsightsPreferencesDropdownBorder": $GrayC,\n    "InsightsPreferencesFocusOutline": $GrayE2,\n    "InsightsSecondaryBkgCtl": $White,\n    "InsightsSecondaryBkgCtlHover": $GrayA,\n    "InsightsSecondaryBkgCtlPressed": $GrayB,\n    "InsightsSecondaryTextCtl": $GrayI,\n    "InsightsSecondaryTextCtlHover": $GrayI,\n    "InsightsSecondaryTextCtlPressed": $GrayI,\n    "InsightsSecondaryStrokeCtl": $GrayD,\n    "InsightsSecondaryStrokeCtlHover": $GrayD,\n    "InsightsSecondaryStrokeCtlPressed": $GrayD,\n  ),\n) !default;\n\n// Themify mixin\n// Source: https://www.sitepoint.com/sass-theming-neverending-story/\n// Extended to allow overriding themes.\n@mixin themify($property, $key, $themes: $themes) {\n  @each $theme, $colors in $themes {\n    .theme-#{$theme} & {\n      #{$property}: map-get($colors, $key);\n    }\n  }\n}\n\n// Themify mixin for styles which apply when focus is visible.\n// .ms-Fabric--isFocusVisible and .theme-* class names are both on body element.\n// It does not work properly to use the mixin themify() in the way below.\n// .ms-Fabric--isFocusVisible &.ms-Button--default:focus::after {\n//      @include themify(\'border-color\', \'InsightsCardKeyboardStroke\');\n// }\n// because there will be a space between .theme-* and .ms-Fabric--isFocusVisible in generated css.\n// Please use this mixin to thimfy the style which applied when focus is visible.\n@mixin themifyForFocus($property, $key, $themes: $themes) {\n  @each $theme, $colors in $themes {\n    .theme-#{$theme}.ms-Fabric--isFocusVisible & {\n      #{$property}: map-get($colors, $key);\n    }\n  }\n}\n',"// Office Palette\n\n$White: #ffffff;\n$Gray110: #8a8886;\n$Gray130: #605e5c;\n$Gray140: #484644;\n$Gray160: #323130;\n$Gray18: #2e2e2e;\n$Gray20: #f3f2f1;\n$Gray30: #edebe9;\n$Gray40: #e1dfdd;\n$Gray60: #c8c6c4;\n$Gray94: #f0f0f0;\n$GrayA: #f3f3f3;\n$GrayB: #e6e6e6;\n$GrayC: #d2d2d2;\n$GrayC2: #c6c6c6;\n$GrayC3: #b1b1b1;\n$GrayD: #969696;\n$GrayD2: #808080;\n$GrayE: #737373;\n$GrayE2: #666666;\n$GrayF: #505050;\n$GrayG: #444444;\n$GrayH: #363636;\n$GrayI: #262626;\n$GrayJ: #0a0a0a;\n$GrayK: #4d4d4d;\n$Black: #000000;\n$Grey36: #5c5c5c;\n\n$HyperlinkA: #c5e9fe;\n$HyperlinkB: #79cdfe;\n$HyperlinkC: #56bdfc;\n$HyperlinkD: #23a6e8;\n\n$XL1: #e9f5ee;\n$XL2: #9fcdb3;\n$XL3: #6eb38a;\n$XL4: #4e9668;\n$XL5: #3f8159;\n$XL6: #217346;\n$XL7: #0e5c2f;\n$XL8: #004b1c;\n$XLPrimary: #107c41;\n\n// Insights Palette\n\n$insights-orange: #ed7d31;\n$insights-blue: #0000ff;\n$ErrorRed: #a80000;\n\n// XLO\n$xlo-headergray: #f5f5f5;\n",'@import "../abstracts/theming";\n@import "../abstracts/palette";\n@import "../abstracts/mixins";\n\n.recommendation-title {\n  font-size: 14px;\n  font-weight: 700;\n  line-height: 20px;\n  margin: 0;\n  vertical-align: top;\n  text-overflow: ellipsis;\n  overflow: hidden;\n\n  &__rich-text {\n    &__0 {\n      color: darken($color: $insights-orange, $amount: 16%);\n    }\n    &__1 {\n      color: $insights-blue;\n    }\n  }\n}\n\n.recommendation-subtitle {\n  color: $Gray160;\n  font-size: 12px;\n  margin: 0;\n  padding: $default-pt * 0.5 0 $default-pt;\n  vertical-align: top;\n  @include overflow-wrap-break-word;\n}\n',".explanation-dropdown {\n  color: #107c41;\n  font-size: 12px;\n\n  &:hover {\n    color: #0f703b;\n  }\n  &:active {\n    color: #094624;\n  }\n  &:disabled {\n    color: #bdbdbd;\n  }\n\n  i {\n    color: inherit;\n  }\n}\n\n.explanation-content {\n  margin: 0px 8px;\n}\n",".column-recommendation {\n  .formula-description {\n    padding: 0;\n    box-sizing: border-box;\n\n    p {\n      all: inherit;\n    }\n  }\n}\n",".python-recommendation {\n  &__title {\n    font-weight: 600;\n    margin-top: 12px;\n    color: #242424;\n  }\n\n  .monaco-read-only {\n    width: auto;\n\n    .monaco-editor .cursors-layer > .cursor {\n      display: none !important;\n    }\n  }\n\n  .python-description {\n    margin: 8px 0px 0px;\n    padding: 0;\n    box-sizing: border-box;\n\n    p {\n      all: inherit;\n    }\n  }\n}\n",'@import "../abstracts/mixins";\n\n.recommendation__text-analysis__bullet-header {\n  font-weight: bold;\n}\n','@import "../abstracts/mixins";\n\n.AugloopDiganosticsPaneContainer {\n  overflow: auto;\n  padding-left: "2%";\n  margin: 0;\n  width: "96%";\n}\n\n.hideOverflow {\n  width: 90%;\n  text-overflow: ellipsis;\n}\n\n// ----------------------------------------\n// tree view styles\n\n.tree {\n  --spacing: 1rem;\n  --radius: 7px;\n  padding-left: 0;\n  padding-inline-start: 0;\n}\n\n.tree li {\n  display: block;\n  position: relative;\n  padding-inline-start: 0;\n  padding-left: calc(2 * var(--spacing) - var(--radius) - 2px);\n}\n\n.tree ul {\n  margin-left: calc(var(--radius) - var(--spacing));\n  padding-left: 0;\n  padding-inline-start: 0;\n}\n\n.tree ul li {\n  border-left: 2px solid #ddd;\n}\n\n.tree ul li:last-child {\n  border-color: transparent;\n}\n\n.tree ul li::before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: calc(var(--spacing) / -2);\n  left: -2px;\n  width: calc(var(--spacing) + 2px);\n  height: calc(var(--spacing) + 1px);\n  border: solid #ddd;\n  border-width: 0 0 2px 2px;\n}\n\n.tree summary {\n  display: block;\n  cursor: pointer;\n}\n\n.tree summary::marker,\n.tree summary::-webkit-details-marker {\n  display: none;\n}\n\n.tree summary:focus {\n  outline: none;\n}\n\n.tree summary:focus-visible {\n  outline: 1px dotted #000;\n}\n\n.tree li::after,\n.tree summary::before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: calc(var(--spacing) / 2 - var(--radius));\n  left: calc(var(--spacing) - var(--radius) - 1px);\n  width: calc(2 * var(--radius));\n  height: calc(2 * var(--radius));\n  border-radius: 50%;\n  background: #ddd;\n}\n\n.tree summary::before {\n  z-index: 1;\n  background: rgb(113, 150, 199) 0 0;\n}\n\n.tree details[open] > summary::before {\n  background-position: calc(-2 * var(--radius)) 0;\n}\n'],sourceRoot:""}]);const l=i},97700:(e,t,a)=>{var n=a(28679),o=a.n(n),r=a(22180),i=a.n(r),l=a(87720),s=a.n(l),c=a(34159),d=a.n(c),u=a(11843),m=a.n(u),g=a(79216),h=a.n(g),p=a(35602),b={};b.styleTagTransform=h(),b.setAttributes=d(),b.insert=s().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=m();o()(p.A,b),p.A&&p.A.locals&&p.A.locals},92779:(e,t,a)=>{a.d(t,{Yhj:()=>vn,CnK:()=>Mm,Tem:()=>Dm,Ub7:()=>$m,p8k:()=>Bm,S08:()=>Pm,inn:()=>Nt,MiK:()=>Nc,W4k:()=>et,zVb:()=>tt,U2P:()=>zc,AXy:()=>xc,V7x:()=>dn,WJg:()=>un,I5y:()=>ks,Rzj:()=>ln,fDp:()=>fn,_Q4:()=>Cn,Hum:()=>cn,mRA:()=>pn,P6V:()=>bn,S5F:()=>rn,zr:()=>cr,sJU:()=>dr,l7G:()=>ur,s46:()=>mr,lqT:()=>gr,cRY:()=>sr,OSb:()=>Kt,a0$:()=>yn,$Sd:()=>sn,hiC:()=>Ji,YTh:()=>Gi,bUh:()=>zi,aI5:()=>Qi,wT9:()=>Wi,YXQ:()=>Ka,Q40:()=>Xa,wYv:()=>ja,Dvy:()=>Qa,SqW:()=>mn,NUW:()=>hn,ynC:()=>gn,Tr2:()=>Ja,z15:()=>Sn,n00:()=>wn,IyO:()=>Ya,YgX:()=>L,xJ7:()=>V,yZI:()=>wd,hl5:()=>c,nuZ:()=>pl,iUs:()=>ft,BFD:()=>ut,MCi:()=>ht,l_I:()=>pt,UDz:()=>bt,CY_:()=>mt,RVs:()=>Md,AUM:()=>Dd,HTR:()=>ta,PEH:()=>aa,Vx2:()=>ea,dKK:()=>Ui,CDl:()=>fm,hW$:()=>ac,yo8:()=>Bg,Pqn:()=>qg,ay0:()=>Ug,qp3:()=>Hg,o9V:()=>dc,omg:()=>Zs,Atw:()=>tc,ZKU:()=>Ze,HGr:()=>G,qjK:()=>je,Goo:()=>z,u3x:()=>K,YbA:()=>J,ZX_:()=>Y,yUb:()=>W,_1n:()=>Ye,wzr:()=>Xe,SXB:()=>Q,mYV:()=>Z,wQR:()=>j,Rc5:()=>X,jcG:()=>Ke,zQo:()=>ji,imT:()=>F,Xxp:()=>_,eZ0:()=>vc,Wuy:()=>Os,CDV:()=>Ps,QKr:()=>Ms,AUu:()=>Ds,wnp:()=>$s,yid:()=>Bs,nsJ:()=>Ys,bo$:()=>Hs,H1r:()=>Us,N0H:()=>qs,$c5:()=>zs,paF:()=>js,PKs:()=>Vs,Dt7:()=>Gs,dcf:()=>Ws,DXl:()=>Qs,HPY:()=>Js,Z_i:()=>$t,Bjy:()=>Ir,nnF:()=>Dt,NIQ:()=>Bt,ahY:()=>Ht,tl8:()=>Ut,IZs:()=>Vt,ir6:()=>qt,Hn3:()=>Gt,LA5:()=>Wt,aXL:()=>At,svm:()=>St,L1E:()=>wt,UVk:()=>Et,$cm:()=>Rt,UGc:()=>It,q7F:()=>rl,Lii:()=>k,uy0:()=>sg,vdP:()=>Cl,KCq:()=>Tl,Muj:()=>Ki,XsD:()=>ol,dw7:()=>ym,ICT:()=>ul,XM5:()=>Tc,DSt:()=>Hr,lj0:()=>Vi,go9:()=>qi,vqw:()=>vr,oOi:()=>Tr,v7j:()=>xr,vks:()=>Sr,YKk:()=>yr,ZcJ:()=>Za,Sur:()=>an,UFE:()=>en,$nW:()=>tn,Gpd:()=>nn,N9u:()=>on,v3b:()=>Dr,rVc:()=>$r,G2X:()=>Br,kwK:()=>Mr,VCG:()=>xm,$0s:()=>yc,T0z:()=>xd,ANf:()=>yd,yNF:()=>vd,I77:()=>bd,t_C:()=>Cd,LNV:()=>Td,AsH:()=>fd,$5J:()=>Sd,mjl:()=>za,ax8:()=>Wa,OfU:()=>ee,q_f:()=>te,TaP:()=>Rs,H6b:()=>Ga,COL:()=>zr,Klw:()=>Wr,eII:()=>Qr,JF4:()=>Bi,rZm:()=>Di,O0M:()=>uc,Pzq:()=>Jm,GyK:()=>jm,TMJ:()=>Ym,OpW:()=>Xm,rho:()=>Km,xmO:()=>Qm,DPI:()=>Jg,tMN:()=>Qg,erl:()=>Ed,rBP:()=>Rd,Ib6:()=>Jt,NKv:()=>Xt,OXO:()=>jt,xqS:()=>Yt,PUb:()=>Qt,LxC:()=>Oc,wzs:()=>ve,VSu:()=>be,yXE:()=>re,A99:()=>ye,Bdz:()=>Te,Bms:()=>we,qmi:()=>Ae,SpP:()=>xe,bCm:()=>Se,$oZ:()=>Ce,lp5:()=>Ee,CcC:()=>me,aRL:()=>ge,gXw:()=>Ie,i3R:()=>he,pF5:()=>pe,K1Z:()=>Re,vK1:()=>ce,m$v:()=>de,Y9M:()=>ie,O8z:()=>le,teX:()=>se,AS_:()=>ue,FuV:()=>Um,yWY:()=>qm,tPp:()=>Vm,YSs:()=>Gm,di6:()=>Wm,ean:()=>zm,TVz:()=>Hm,fOb:()=>kt,eL9:()=>fi,qat:()=>Ci,Xlr:()=>si,y9Z:()=>ui,Hdt:()=>ci,EoV:()=>pg,uvk:()=>bg,Lvp:()=>S,zOV:()=>wi,K2I:()=>hl,Obq:()=>yt,UuN:()=>Od,u1i:()=>Mt,mT9:()=>Pa,MhY:()=>xi,VMi:()=>Ri,Ogc:()=>xt,Oj_:()=>kr,RCr:()=>Or,BVL:()=>Pr,wZB:()=>Lr,vvX:()=>Wg,aDv:()=>Gg,R7A:()=>zg,I3c:()=>Pd,m1B:()=>Ic,FA0:()=>Rg,gAP:()=>Fs,_h7:()=>Ns,Twc:()=>_s,_A_:()=>Hi,SHb:()=>st,czL:()=>og,jh3:()=>rg,M76:()=>ng,u1Q:()=>Pt,YWO:()=>tl,qbK:()=>q,XBr:()=>ct,vG7:()=>ya,ZvH:()=>Ca,BGX:()=>Si,AWH:()=>Pg,yfY:()=>Mg,jdI:()=>il,QEp:()=>Lt,ekx:()=>Tn,vMn:()=>lr,Edn:()=>Yc,syu:()=>Jc,Af3:()=>jc,$Mo:()=>Qc,$Eq:()=>el,M_y:()=>fl,koJ:()=>vl,hIB:()=>Sl,OS6:()=>td,Txd:()=>Zc,h9u:()=>Xc,u1U:()=>Kc,yWm:()=>id,pZZ:()=>pd,Z4S:()=>cd,N0D:()=>ad,k0o:()=>gd,kM:()=>hd,U45:()=>sd,Dqz:()=>rd,m3r:()=>od,Iiw:()=>ld,bd1:()=>ed,gTs:()=>nd,w$T:()=>md,NLG:()=>ud,J40:()=>Ta,E$x:()=>ot,aVz:()=>at,BqH:()=>nt,IKl:()=>Sa,Nbb:()=>ws,EWN:()=>rt,Yyo:()=>xa,fLI:()=>ig,LLM:()=>wa,imX:()=>p,WlT:()=>h,u7V:()=>C,w_Q:()=>f,W32:()=>b,Vno:()=>u,gu1:()=>m,mDj:()=>g,MYv:()=>d,VHx:()=>_r,bcx:()=>Fr,Amo:()=>$i,BU1:()=>Nr,Kc4:()=>ml,M_1:()=>Pe,tZV:()=>Me,SUe:()=>De,zZj:()=>$e,uo4:()=>Ve,znb:()=>fe,_lL:()=>qe,tJt:()=>ze,wvg:()=>Ue,BaS:()=>We,XQw:()=>Be,_73:()=>He,_9M:()=>Ge,XFR:()=>_e,ZYo:()=>ke,w7p:()=>Ne,De1:()=>Oe,UOv:()=>Fe,WpK:()=>Yi,PX_:()=>gc,T1Y:()=>I,cGI:()=>A,Sak:()=>Mi,XWM:()=>Oi,ReY:()=>Pi,_C5:()=>ki,Pjp:()=>Ks,dlV:()=>mc,hAn:()=>pr,aS7:()=>br,VdU:()=>fr,aDZ:()=>Cr,o3Z:()=>hr,xau:()=>oe,L8i:()=>ae,AKP:()=>ne,J0g:()=>Le,Rff:()=>Zu,nKX:()=>Tm,Tg4:()=>cl,_:()=>wm,cls:()=>Cm,L0p:()=>Va,QOn:()=>qa,GRk:()=>kg,r$C:()=>N,V0i:()=>wg,aYy:()=>dg,Pot:()=>cg,SS1:()=>mg,nx1:()=>ug,SCL:()=>$d,MKr:()=>Bd,SXd:()=>ra,vBB:()=>na,oPi:()=>sa,bPB:()=>oa,CMz:()=>ca,_ZG:()=>vm,Ehc:()=>gg,BVu:()=>Nd,ir3:()=>kd,v3A:()=>qr,KVc:()=>Vr,f7s:()=>Ur,CLD:()=>Gr,Nfx:()=>di,_kX:()=>ai,IH5:()=>oi,Y55:()=>ni,CPY:()=>Jr,ak4:()=>Xr,s2u:()=>ti,mF:()=>Yr,T5i:()=>Kr,r8x:()=>Zr,nPU:()=>ei,gnM:()=>li,kAS:()=>jr,R_I:()=>jg,xe2:()=>$,xxz:()=>H,y6U:()=>Ra,OX0:()=>Aa,WTX:()=>Ia,BSy:()=>Ea,gGJ:()=>gl,FxF:()=>Cg,zGM:()=>yg,YNj:()=>Tg,cpK:()=>vg,NRU:()=>fc,gOS:()=>Vc,Gn5:()=>Sc,e0T:()=>Gc,ds$:()=>sm,sY1:()=>mm,kTv:()=>bm,Fsb:()=>im,DIE:()=>rm,jpr:()=>um,pRP:()=>dm,KBQ:()=>lm,I53:()=>cm,JGR:()=>pm,NeW:()=>hm,sGO:()=>gm,vKl:()=>tm,CNP:()=>am,v$B:()=>nm,C2X:()=>om,AZo:()=>Cc,ft7:()=>wc,VDh:()=>bc,UL_:()=>ga,PlK:()=>ma,hLq:()=>Uc,ZSg:()=>Wc,u6S:()=>Ec,n0L:()=>qc,hiv:()=>Ii,zDx:()=>dd,y$1:()=>El,Sa0:()=>Pc,Ony:()=>Mc,KdV:()=>rc,$98:()=>ic,kDR:()=>cu,NSY:()=>iu,RT6:()=>du,j0F:()=>lu,Q0:()=>ou,fzU:()=>Zd,I$I:()=>Kd,JAc:()=>jd,gNJ:()=>Jd,nhC:()=>tu,fu2:()=>Vd,EW5:()=>qd,mk8:()=>eu,I$d:()=>Xd,t8C:()=>Yd,TTT:()=>Wd,IpP:()=>Gd,qbB:()=>Qd,B3O:()=>zd,fRc:()=>Ud,ENk:()=>Hd,LC$:()=>yu,ijW:()=>Cu,irK:()=>pu,J$y:()=>hu,RV_:()=>gu,uVJ:()=>su,hEI:()=>au,qU2:()=>mu,P82:()=>Ku,v3q:()=>nu,Y2N:()=>uu,I64:()=>fu,pDo:()=>bu,wUB:()=>ru,Vl3:()=>ds,ELg:()=>ls,J9g:()=>cs,LAW:()=>os,Efv:()=>ns,I_l:()=>as,Rpx:()=>rs,Sl:()=>Ml,ZgC:()=>gt,jv5:()=>_l,GLO:()=>Ll,Sk4:()=>Pl,gg6:()=>Is,JIA:()=>Es,pa_:()=>As,YvV:()=>Ls,YCq:()=>Wl,mq0:()=>Dl,aWv:()=>Vl,IiW:()=>Gl,vCA:()=>Cs,YYS:()=>fs,Toc:()=>Ss,g$5:()=>xs,r5N:()=>is,Lby:()=>es,A1r:()=>Hl,O4H:()=>Ul,jYw:()=>Bl,z9Y:()=>$l,xUh:()=>kl,wW0:()=>ss,l6K:()=>ps,FCw:()=>Il,XZh:()=>bs,Huq:()=>Je,EwU:()=>Qe,zOC:()=>ql,S3X:()=>Al,vX0:()=>us,oMg:()=>ms,csN:()=>gs,g1k:()=>Fl,ZOw:()=>ys,$L3:()=>Ol,NCh:()=>Ql,A2r:()=>hs,QAQ:()=>Zl,dvg:()=>Nl,zqN:()=>Jl,LMV:()=>Kl,PxQ:()=>Xl,XXH:()=>zl,Dpi:()=>ts,lQ6:()=>jl,WQT:()=>Yl,rhr:()=>vs,V9X:()=>Rl,DjY:()=>Ts,hn:()=>Ai,epH:()=>Ni,Pqm:()=>Li,ZB_:()=>_i,BaM:()=>Fi,b4o:()=>vt,KC:()=>Ct,Jx4:()=>xg,r9E:()=>sl,Rp5:()=>ii,mnG:()=>Xi,XKD:()=>mi,QbU:()=>gi,ejy:()=>hi,YtG:()=>Dc,qvS:()=>$c,W9h:()=>lc,JuZ:()=>sc,pwZ:()=>lg,Is:()=>kc,Iy7:()=>Zm,Qv5:()=>eg,Xdl:()=>tg,QaT:()=>ag,OsU:()=>y,QCY:()=>_a,ZOE:()=>Na,$TB:()=>Vg,FIy:()=>dl,byP:()=>xn,brP:()=>bl,t3j:()=>yl,Kve:()=>xl,yMF:()=>Zi,fVE:()=>hc,sHs:()=>wr,lJi:()=>Rr,s_X:()=>Er,ZQs:()=>Ac,iMG:()=>Lc,xKU:()=>_c,cFM:()=>Fc,gZd:()=>In,JEr:()=>Nn,hzZ:()=>Ln,lkD:()=>Rn,dYE:()=>Fn,gax:()=>An,jmZ:()=>En,G5z:()=>zt,EZu:()=>_n,PFs:()=>kn,Qte:()=>cc,etO:()=>nl,tSR:()=>v,rGh:()=>w,HhS:()=>Nm,$S6:()=>Om,gq9:()=>km,xFL:()=>_m,hAW:()=>_t,S0l:()=>em,vYt:()=>la,OeJ:()=>ia,LRp:()=>Fa,iOi:()=>La,Pxj:()=>Fu,Gp3:()=>Lu,qre:()=>Au,P$N:()=>Og,MIy:()=>Ig,bor:()=>Ag,MuJ:()=>_g,VJh:()=>Ng,uvg:()=>Lg,R3b:()=>Fg,h_t:()=>Ju,ev2:()=>Qu,up8:()=>zu,c_T:()=>Wu,Dh1:()=>Gu,Tlk:()=>Vu,mJ6:()=>qu,z56:()=>Uu,jLG:()=>Hu,vkL:()=>Bu,GIT:()=>$u,c7Y:()=>Du,C$7:()=>Iu,Thz:()=>Ru,ZkE:()=>Eu,VH3:()=>Yu,S7l:()=>ju,nYf:()=>Xu,mcb:()=>ku,pP4:()=>Nu,nMc:()=>_u,pOf:()=>Mu,kMm:()=>Pu,ujQ:()=>Ou,L0V:()=>wu,NXr:()=>Su,DIq:()=>xu,YMx:()=>Tu,eGo:()=>vu,fw9:()=>x,Ykh:()=>hg,wzu:()=>bi,NOF:()=>pi,waz:()=>yi,vLX:()=>Xs,qPG:()=>Dg,Py2:()=>$g,pH2:()=>Ar,fhV:()=>Rc,OJx:()=>al,chZ:()=>ec,px2:()=>ba,L0O:()=>pa,_J3:()=>fa,DEh:()=>ha,Mgi:()=>T,HRg:()=>wl,sUU:()=>va,mLK:()=>Fm,wEx:()=>Lm,Y91:()=>Am,vuT:()=>Im,J_P:()=>Ft,Eyh:()=>Zt,dEi:()=>Sg,DUN:()=>Em,lPU:()=>Rm,AYD:()=>ua,h3h:()=>da,AWW:()=>dt,IeI:()=>Eg,KeO:()=>it,ooE:()=>lt,xk_:()=>fg,ORJ:()=>pc,H2U:()=>ri,iVS:()=>ll,USL:()=>Oa,tDq:()=>ka,UEB:()=>Da,v01:()=>Ma,gk_:()=>Ba,DyN:()=>$a,dq1:()=>Sm,MED:()=>Ua,TSg:()=>Ha,VAP:()=>Ot,ZLn:()=>Ei,zvE:()=>Bc,tdb:()=>nc,Dre:()=>Ti,n50:()=>vi,mjS:()=>Hc,kfS:()=>oc,KsV:()=>Jn,ztP:()=>jn,Oz3:()=>uo,Bzb:()=>mo,gsW:()=>jo,bgS:()=>Yo,KHB:()=>ao,Z3U:()=>no,ixU:()=>To,BhF:()=>xo,E9A:()=>po,pKA:()=>bo,BIf:()=>Uo,wwj:()=>qo,D02:()=>Bo,QHr:()=>Ho,nHd:()=>oo,KtU:()=>ro,lun:()=>Hn,On3:()=>Un,no:()=>Yn,qAx:()=>Xn,$dh:()=>Pn,RV1:()=>Io,U7J:()=>Ao,roM:()=>Vo,esl:()=>Go,D8x:()=>yo,Coj:()=>vo,I1u:()=>so,N_T:()=>co,_JR:()=>Vn,jI0:()=>Mn,lFW:()=>Qo,aW0:()=>Jo,_pS:()=>Wo,fsn:()=>zo,_ok:()=>_o,bkj:()=>No,Z2X:()=>Lo,_Gb:()=>Fo,Ghz:()=>qn,nby:()=>nr,_BM:()=>or,zp5:()=>On,$OL:()=>Kn,C_C:()=>Zn,wvv:()=>So,hCI:()=>wo,sqX:()=>go,xf7:()=>ho,vJt:()=>rr,ST4:()=>ir,vNK:()=>Bn,ONP:()=>$n,IZv:()=>Dn,xMZ:()=>fo,YYh:()=>Co,NyX:()=>Po,WNU:()=>Mo,xOV:()=>eo,_zy:()=>to,UXx:()=>Gn,VG_:()=>Wn,XAy:()=>ko,kvY:()=>Oo,dNS:()=>Do,Avw:()=>$o,qhm:()=>Eo,DqS:()=>Ro,Qhk:()=>Xo,rnM:()=>Ko,r3R:()=>tr,_xk:()=>ar,da$:()=>Zo,oKV:()=>er,ptM:()=>zn,K0f:()=>Qn,itS:()=>io,f00:()=>lo,Z1M:()=>R,OKS:()=>_d,sj0:()=>Id,Vgn:()=>Ad,ZAw:()=>Ld,Ovt:()=>Fd,fn_:()=>E,N1d:()=>M,kK2:()=>D});var n=a(74511),o=a(50347);function r(e,t=3e3){window.setTimeout((()=>{throw new Error(e)}),t)}function i(e,t,a=r){return new Proxy(t,{get(t,n){if("string"!=typeof n)return a("Unexpected string name type"),"";const o=n,r=globalThis[e];return r?r[o]:(a(`Requesting string ${e}.${n} before strings have loaded`),t[o])}})}var l=a(32054),s=a(7274);const c="9.51.2",d=!1,u="X-NLInteractionId",m="https://ppe.insights.microsoft.com",g="https://insights.microsoft.com",h="https://dev.insights.microsoft.com",p="https://dev2.insights.microsoft.com",b="https://api.gcc.insights.usgovcloudapi.net",f="https://api.gcch.insights.usgovcloudapi.net",C="https://api.dod.insights.usgovcloudapi.net",y="shimmer",v="/Sydney";var T;!function(e){e.notSet="NotSet",e.true="True",e.false="False"}(T||(T={}));const x="closeButton",S="https://go.microsoft.com/fwlink/?linkid=2250136",w={OFFICEONLINE:"Excel.Web.Copilot_Lib",PC:"Excel.Win32.Copilot_Lib",MAC:"Excel.Mac.Copilot_Lib",IOS:"Excel.iPad.Copilot_Lib"},E="Excel",R="Copilot",I=150,A=18,L="ANNOTATION",F=.5,_=100*F,N="[]",k=5e3;let O=!1,P=!1;const M=function(e,t){O=e,P=t},D=function(e){return(0,o.yw)("OfficeVSO_8940802_WrapNTierRtlUIStrings")&&P&&!O?"â§"+e+"â©":e},$=i("ExcelCopilotStrings",l),B=i("ExcelCopilotStrings",l,(()=>{})),H=i("OfficeaicopilotStrings",s),U=function(){return"undefined"!=typeof ExcelCopilotStringsNTier},q={Columns:{SingleColumnRecommendation:"I suggested adding the column named {columnName}, that use the formula {formula}, to the column location {columnLocation} to calculate the results.",SingleColumnRecommendationWithNoLocation:"I suggested adding the column named {columnName}, that use the formula {formula}, to calculate the results.",MultipleColumnsRecommendation:"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to the column locations {columnLocations} to calculate the results.",MultipleColumnsRecommendationWithNoLocation:"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to calculate the results."},Rows:{SingleFormulaRecommendation:"I suggested adding the formula {formula}, that calculates {title}, under the column {location} to calculate the results.",SingleFormulaRecommendationWithNoLocation:"I suggested adding the formula {formula}, that calculates {title}, to calculate the results.",MultipleFormulaRecommendation:"I suggested adding the formulas {formulas}, that calculate {titles}, under the columns {columnLocations} to calculate the results.",MultipleFormulaRecommendationWithNoLocation:"I suggested adding the formulas {formulas}, that calculate {titles}, to calculate the results."},HumanInTheLoop:{Error:"There was an error while generating the human in the loop card.",CardShown:"I showed the human in the loop card, prompting to confirm application of commanding operation."}},V=function(){return[$.CommandingHumanInTheLoopApplyingChangesMessage]},G=function(){return $.CalculatedColumnsFailureGeneral},W=function(e){return[e?$.CalculatedColumnsNLNoResultSuggestionIdentifyColumn:$.CalculatedColumnsNLNoResultSuggestionIdentifyColumnAndTable,$.CalculatedColumnsNLNoResultSuggestionCreateColumn]},z=function(){return $.CalculatedColumnsInsertFailedDeleteConflict},Q=function(){return $.CalculatedRowsInsertFailedDeleteConflict},J=function(){return $.CalculatedColumnsInsertFailedProtectedSheet},j=function(){return $.CalculatedRowsInsertFailedProtectedSheet},Y=function(){return $.CalculatedColumnsInsertFailedTableNotFound},X=function(){return $.CalculatedRowsInsertFailedTableNotFound},K=function(){return $.CalculatedColumnsInsertFailedGeneral},Z=function(){return $.CalculatedRowsInsertFailedGeneral},ee=function(){return $.CalculatedColumnsColumnConfirmationMessage},te=function(){return $.CalculatedColumnsTableConfirmationMessage},ae=function(){return $.MultipleCalculatedColumnsAddedToColumnsConfirmationMessage},ne=function(){return $.MultipleCalculatedColumnsAddedToTableConfirmationMessage},oe=function(){return $.MoreThanThreeColumnsAddedToTableConfirmationMessage},re=function(){return $.DataShapingEnterModeButton},ie=function(){return $.DataShapingSuggestEnterModeHeaderText},le=function(){return $.DataShapingSuggestEnterModeText1},se=function(){return $.DataShapingSuggestEnterModeText2},ce=function(){return $.DataShapingSuggestEnterModeTextBullet1},de=function(){return $.DataShapingSuggestEnterModeTextBullet2},ue=function(){return $.DataShapingSuggestEnterModeText3},me=function(){return[$.DataShapingLoadingStartDataShapingMode]},ge=function(){return["Applying your changes..."]},he=function(){return[$.DataShapingPostEnterModeText1]},pe=function(){return[$.DataShapingPostEnterModeText2]},be=function(){return $.DataShapingConfirmationMessage},fe=function(){return[$.LoadingUIApplyDataShapingStep]},Ce=function(){return $.DataShapingGenericError},ye=function(){return"Failed to start data prep mode. Please try again."},ve=function(){return $.DataShapingAddStepDone},Te=function(){return $.DataShapingApplyOrExit},xe=function(){return $.DataShapingApplyToNewSheet},Se=function(){return $.DataShapingApplyToExistingTable},we=function(){return $.DataShapingExitMode},Ee=function(){return"OK. I have exited Data Preparation mode."},Re=function(){return"OK. I replaced the original table and exited Data Preparation mode."},Ie=function(){return"OK. I created a new connection in a new sheet and exited Data Preparation mode."},Ae=function(){return $.DataShapingGenericError},Le=function(){return $.MultipleCalculatedColumnsInsertFailedConflict},Fe=["Saving your automation..."],_e=["Creating your automation..."],Ne=function(){return[$.LoadingUIWorkingOnItStep,$.LoadingUiUnderstandingDataStep,$.LoadingUILookingAtDataRangeStep]},ke=function(e){return e?[B.LoadingUIWorkingOnItStep,B.LoadingUiUnderstandingDataStep,B.LoadingUIAlmostThereStep]:[$.LoadingUIWorkingOnItStep,$.LoadingUiUnderstandingDataStep,$.LoadingUIAlmostThereStep]},Oe=function(){return[$.LoadingUIFinishingUpStep]},Pe=function(){return[$.LoadingUIAddingColumnStep]},Me=function(){return[$.LoadingUIAddingColumnsStep]},De=function(){return[$.LoadingUIInsertingContentStep]},$e=function(){return[$.LoadingUIAnalyzingDataStep]},Be=function(){return[$.LoadingUIMakingChangesStep]},He=function(){return[$.LoadingUIMakingChangesStepTableOfficeJSLikeRange]},Ue=function(){return[$.LoadingUIGeneratingFormulaColumnSuggestionsStep]},qe=function(){return[$.LoadingUIGeneratingFormulaRowSuggestionsStep]},Ve=function(){return[$.LoadingUIAnalyzingDataTLRStep]},Ge=function(){return[$.LoadingUIMakingChangesTLRStep]},We=function(){return[$.LoadingUIGeneratingFormulaColumnSuggestionsTLRStep]},ze=function(){return[$.LoadingUIGeneratingFormulaRowSuggestionsTLRStep]},Qe=function(){return[$.PythonLoadingStartAnalysis]},Je=function(){return[$.LoadingUIWorkingOnItStep]},je=function(e){return e?(0,o.yw)("OfficeVSO_8805623_singularCCPill")?B.CalculatedColumnsGeneralSingular:B.CalculatedColumnsGeneral:(0,o.yw)("OfficeVSO_8805623_singularCCPill")?$.CalculatedColumnsGeneralSingular:$.CalculatedColumnsGeneral},Ye=function(){return $.SuggestionPillAnotherColumnSuggestion},Xe=function(){return $.SuggestionPillPromptBasedAnotherSuggestion},Ke=function(){return $.CalculatedRowsShowMorePill},Ze=function(){return $.SuggestionPillCreateColumn},et=function(){return $.RecommendationAddToNewSheet},tt=function(){return $.RecommendationAddToSheet},at=function(){return $.RecommendationInsertColumn},nt=function(){return $.RecommendationInsertMultipleColumns},ot=function(){return $.CalculatedRowsInsertCellTitle},rt=function(){return $.CalculatedRowsInsertRowTitle},it=function(){return $.CalculatedRowsUpdateCellTitle},lt=function(){return $.CalculatedRowsUpdateRowTitle},st=function(){return $.CalculatedRowsFormulaSuggestionHeader},ct={PreviewOnGridButton_ShowPreview:()=>$.FormulaSuggestion_PreviewOnGridButton_ShowPreview,PreviewOnGridButton_HidePreview:()=>$.FormulaSuggestion_PreviewOnGridButton_HidePreview},dt=function(){return $.UnsupportedOperationMessage},ut=function(){return $.ServerErrorMessage},mt=function(){return $.AugloopResponseTimeoutMessage},gt=function(){return $.PythonAugloopResponseTimeoutMessage},ht=function(){return U()?D(ExcelCopilotStringsNTier.AugloopErrorUnsupportedLanguage):"I'm still working to support other languages. For now, please try your prompt again in English."},pt=function(){return $.QueryLengthTooShortError},bt=function(){return $.ThrottlingErrorMessage},ft=function(){return $.LicensingErrorMessage},Ct=function(){return $.RaiErrorUserMessage},yt=function(){return $.ElseFormulaBlocksError},vt=function(){return $.RaiErrorSuccessfulActionBlockedResponse},Tt=function(){return $.ErrorServerBusy},xt=()=>[{error:"Blocked potentially offensive input",errorMessageUser:Ct()},{error:"Output was blocked for offensive content",errorMessageUser:Ct()},{error:"The query is too long, try again with a shorter query.",errorMessageUser:$.ErrorQueryTooLarge},{error:"Detected languages",errorMessageUser:$.AugloopErrorOTE},{error:"InferenceAPI: Too busy",errorMessageUser:Tt()},{error:"InferenceAPI: Timeout",errorMessageUser:Tt()},{error:"InferenceAPI: User throttled",errorMessageUser:bt()}],St=function(){return $.ChatSuggestionHeader},wt=function(){return $.ChatSuggestionAddColumns},Et=function(){return $.ChatSuggestionHighlight},Rt=function(){return $.ChatSuggestionFilterAndSort},It=function(){return $.ChatSuggestionAnalyze},At=function(){return $.ChatSuggestionFooterText},Lt=function(){return[$.HelpQueryPhrase1,$.HelpQueryPhrase2,$.HelpQueryPhrase3,$.HelpQueryPhrase4,$.HelpQueryPhrase5,$.HelpQueryPhrase6,$.HelpQueryPhrase7,$.HelpQueryPhrase8,$.HelpQueryPhrase9,$.HelpQueryPhrase10,$.HelpQueryPhrase11,$.HelpQueryPhrase12,$.HelpQueryPhrase13,$.HelpQueryPhrase14,$.HelpQueryPhrase15,$.HelpQueryPhrase16,$.HelpQueryPhrase17,$.HelpQueryPhrase18,$.HelpQueryPhrase19,$.HelpQueryPhrase20,$.HelpQueryPhrase21,$.HelpQueryPhrase22,$.HelpQueryPhrase23,$.HelpQueryPhrase24]},Ft=function(){return[$.UnsupportedQueryUndoPhrase1,$.UnsupportedQueryUndoPhrase2,$.UnsupportedQueryUndoPhrase3,$.UnsupportedQueryUndoPhrase4,$.UnsupportedQueryUndoPhrase5]},_t=function(){return[$.UnsupportedQueryAltTextPhrase1,$.UnsupportedQueryAltTextPhrase2,$.UnsupportedQueryAltTextPhrase3,$.UnsupportedQueryAltTextPhrase4]},Nt=function(){return[$.UnsupportedQueryAddCommentPhrase1,$.UnsupportedQueryAddCommentPhrase2,$.UnsupportedQueryAddCommentPhrase3]},kt=function(){return[$.UnsupportedQueryDataValidationPhrase1,$.UnsupportedQueryDataValidationPhrase2,$.UnsupportedQueryDataValidationPhrase3]},Ot=function(){return[$.UnsupportedQueryWorksheetPhrase1,$.UnsupportedQueryWorksheetPhrase2,$.UnsupportedQueryWorksheetPhrase3]},Pt=function(){return[$.UnsupportedQueryFreezePanePhrase1,$.UnsupportedQueryFreezePanePhrase2]},Mt="",Dt=function(){return $.ChatPlaceholderMessage},$t=function(){return $.ChatPlaceholderMessageInputV2NoGrounding},Bt=function(){return $.ChatPlaceholderMessageV2},Ht=function(){return $.ChatPlaceholderMessagePythonMode},Ut=function(){return $.ChatPlaceholderMessageRange},qt=function(){return $.ChatPlaceholderMessageSearch},Vt=function(){return $.ChatPlaceholderMessageSearchWithRange},Gt=function(){return $.ChatRestShyPlaceholderMessage},Wt=function(){return $.ChatRestShyPlaceholderMessageRange},zt=function(){return[$.SuggestionPillSeeInsight,$.SuggestionPillAddInsights]},Qt=function(){return $.DashboardSourceDataLabel},Jt="#F0F0F0",jt="#595959",Yt=25,Xt=60,Kt=function(){return $.AnalyzeDataGenericError},Zt=function(){return $.UndoScopeName},ea=function(){return U()?D(ExcelCopilotStringsNTier.AugloopSessionClosedTitle):"Something went wrong"},ta=function(){return U()?D(ExcelCopilotStringsNTier.AugloopSessionClosedDesktopMessage):"Sorry, I'm having some trouble right now. Restart Excel and try sending the prompt again."},aa=function(){return U()?D(ExcelCopilotStringsNTier.AugloopSessionClosedWebMessage):"Sorry, I'm having some trouble right now. Try refreshing the webpage."},na=function(){return $.RibbonCommandInsertTable},oa=function(){return $.NoTableSelectedMessageWithLink2},ra=function(){return $.NoTableSelectedMessageCriteriaList},ia=function(){return $.TableHelpLinkText2},la="https://support.microsoft.com/office/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c",sa=function(){return $.NoTableSelectedMessageWithCommand2},ca=function(){return $.NoTableSelectedTitle2},da=function(){return $.UnsupportedObjectSelectedTitle},ua=function(){return $.UnsupportedObjectSelectedMessage},ma=function(){return $.PivotTableSelectedTitle},ga=function(){return $.PivotTableSelectedMessage},ha=function(){return $.BlankWorksheetTitle},pa=function(){return $.BlankWorksheetMessage},ba=function(){return $.BlankWorksheetButtonText},fa=function(){return $.BlankWorksheetButtonSuccess},Ca=function(){return $.ActionButtonGoToTable},ya=function(){return $.ActionButtonGoToData},va=function(){return $.ActionButtonUndo},Ta=function(){return $.ActionButtonInsert},xa=function(){return $.InsertSingleTableSuccessMessage},Sa=function(){return $.InsertMultiTablesSuccessMessage},wa=function(){return $.InsertTableErrorMessage},Ea=function(){return $.TableTooLargeTitle},Ra=function(){return $.TableUsesTooMuchMemoryError},Ia=function(){return $.TableUsesTooMuchMemoryErrorFourMillion},Aa=function(){return $.TableUsesTooMuchMemoryError2},La=function(){return $.TableHiddenHeadersTitle},Fa=function(){return $.TableHiddenHeadersMessage},_a=function(){return $.ShowHeadersButtonTitle},Na=function(){return $.ShowHeadersSuccessMessage},ka=function(){return U()?D(ExcelCopilotStringsNTier.WorksheetAutosaveOffTitle):"AutoSave is turned off"},Oa=function(){return U()?D(ExcelCopilotStringsNTier.WorksheetAutosaveOffMessage):"I only work with files that have AutoSave turned on. Turn it on to continue."},Pa=function(){return U()?D(ExcelCopilotStringsNTier.EnableAutosaveButtonText):"Turn on AutoSave"},Ma=function(){return $.DialogSheetUnsupportedTitle},Da=function(){return $.DialogSheetUnsupportedMessage},$a=function(){return $.FileLocationUnsupportedTitle},Ba=function(){return $.FileLocationUnsupportedMessage},Ha=function(){return $.WorksheetProtectedTitle},Ua=function(){return $.WorksheetProtectedMessage},qa=function(){return $.NonWorksheetActivatedTitle},Va=function(){return $.NonWorksheetActivatedMessage},Ga=function(){return $.ConvertToTableButtonSuccess},Wa=function(){return $.InsertAllDataConfirmationMessage},za=function(){return $.InsertDataConfirmationMessage},Qa=function(e){return e?B.SuggestionPillInsights2:$.SuggestionPillInsights2},Ja=function(){return $.SuggestionPillUpdatedInsights2},ja=function(){return $.SuggestionPillShowPivotTables},Ya=function(){return $.SuggestionPillShowCharts},Xa=function(){return $.SuggestionPillAnotherPivotTable},Ka=function(){return $.SuggestionPillAnotherChart},Za=function(){return $.CommandingTellMeHeader1},en=function(){return $.CommandingTellMeSuggestion1},tn=function(){return $.CommandingTellMeSuggestion2},an=function(){return $.CommandingTellMeHeader2},nn=function(){return $.CommandingTellMeSuggestion3},on=function(){return $.CommandingTellMeSuggestion4},rn=function(){return $.NoInsightsMessage},ln=function(){return $.NoAnalyzeDataMessage},sn=function(){return $.AnalyzeNotSupportedMessage},cn=function(){return $.AnalyzeDataGenericError2},dn=function(){return $.AccessDeniedMessage},un=function(){return $.CellEditingMessage},mn=function(){return $.AnalyzeDataTooLargeError},gn=function(){return $.AnalyzeDataTooLargeErrorFourMillion},hn=function(){return"There's too much content for me to summarize. Reduce the number of rows and try again."},pn=function(){return"I've run into a problem. Try asking me again later"},bn=function(){return"I've run into a problem. Try asking another question."},fn=function(){return"LLM throttled. Wait and retry may help"},Cn=function(){return"LLM API issue. Wait and retry may help"},yn=function(){return"There is an error in the network connection. Please check your network connection and try again."},vn=function(){return $.PromptMenuItemAddFormulaColumn},Tn=function(){return $.PromptMenuItemHighlightData},xn=function(){return $.PromptMenuItemSortFilter},Sn=function(){return $.PromptMenuItemAnalyzeData},wn=function(){return $.PromptMenuItemAnalyzeUsingPython},En=function(){return $.SuggestionPillOutliers},Rn=function(){return $.SuggestionPillCompareColumns},In=function(){return $.SuggestionPillBoldColumn},An=function(){return $.SuggestionPillHowMany},Ln=function(){return $.SuggestionPillCombineColumns},Fn=function(){return $.SuggestionPillHighlightHighest},_n=function(){return $.SuggestionPillShowItems},Nn=function(){return $.SuggestionPillBold},kn=function(){return $.SuggestionPillSortColumn},On=function(){return $.ZeroQueryInsightsTitle},Pn=function(){return $.ZeroQueryFormulaActionTitle},Mn=function(){return $.ZeroQueryHighlightActionTitle},Dn=function(){return $.ZeroQuerySearchTitle},$n=function(){return $.ZeroQueryPythonTitle},Bn=function(){return $.ZeroQueryPythonHeader},Hn=function(){return $.ZeroQueryDataShapingHeader},Un=function(){return $.ZeroQueryDataShapingText},qn=function(){return $.ZeroQueryHowToSumTitle},Vn=function(){return $.ZeroQueryHeaderAsk},Gn=function(){return $.ZeroQuerySuggestAColumnTitle},Wn=function(){return $.ZeroQuerySuggestAColumnMessage},zn=function(){return $.ZeroQueryWriteAFormulaTitle},Qn=function(){return $.ZeroQueryWriteAFormulaMessage},Jn=function(){return $.ZeroQueryAddAFormulaColumnTitle},jn=function(){return $.ZeroQueryAddAFormulaColumnMessage},Yn=function(){return $.ZeroQueryExplainAFormulaTitle},Xn=function(){return $.ZeroQueryExplainAFormulaMessage},Kn=function(){return $.ZeroQueryInvestigateErrorTitle},Zn=function(){return $.ZeroQueryInvestigateErrorMessage},eo=function(){return $.ZeroQuerySplitColumnsTitle},to=function(){return $.ZeroQuerySplitColumnsMessage},ao=function(){return $.ZeroQueryCombineColumnsTitle},no=function(){return $.ZeroQueryCombineColumnsMessage},oo=function(){return $.ZeroQueryCreateTotalRowTitle},ro=function(){return $.ZeroQueryCreateTotalRowMessage},io=function(){return $.ZeroQueryWriteLookupFormulaTitle},lo=function(){return $.ZeroQueryWriteLookupFormulaMessage},so=function(){return $.ZeroQueryGetDataInsightsTitle},co=function(){return $.ZeroQueryGetDataInsightsMessage},uo=function(){return $.ZeroQueryAdvancedAnalysisTitle},mo=function(){return $.ZeroQueryAdvancedAnalysisMessage},go=function(){return $.ZeroQueryPerformForecastingTitle},ho=function(){return $.ZeroQueryPerformForecastingMessage},po=function(){return $.ZeroQueryCreateBoxplotTitle},bo=function(){return $.ZeroQueryCreateBoxplotMessage},fo=function(){return $.ZeroQuerySetOfChartsTitle},Co=function(){return $.ZeroQuerySetOfChartsMessage},yo=function(){return $.ZeroQueryGenerateWordCloudTitle},vo=function(){return $.ZeroQueryGenerateWordCloudMessage},To=function(){return $.ZeroQueryCreateATableTitle},xo=function(){return $.ZeroQueryCreateATableMessage},So=function(){return $.ZeroQueryKeyboardShortcutsTitle},wo=function(){return $.ZeroQueryKeyboardShortcutsMessage},Eo=function(){return $.ZeroQueryTipsAndTricksTitle},Ro=function(){return $.ZeroQueryTipsAndTricksMessage},Io=function(){return $.ZeroQueryFreezeColumnTitle},Ao=function(){return $.ZeroQueryFreezeColumnMessage},Lo=function(){return $.ZeroQueryHowDoITitle},Fo=function(){return $.ZeroQueryHowDoIUnpivotMessage},_o=function(){return $.ZeroQueryHowDoIDropdownMessage},No=function(){return $.ZeroQueryHowDoIFormulaMessage},ko=function(){return $.ZeroQuerySummarizeColumnTitle},Oo=function(){return $.ZeroQuerySummarizeColumnMessage},Po=function(){return $.ZeroQueryShowDataInsightsTitle},Mo=function(){return $.ZeroQueryShowDataInsightsMessage},Do=function(){return $.ZeroQuerySumByCategoryTitle},$o=function(){return $.ZeroQuerySumByCategoryMessage},Bo=function(){return $.ZeroQueryCreatePivotTableTitle},Ho=function(){return $.ZeroQueryCreatePivotTableMessage},Uo=function(){return $.ZeroQueryCreatePieChartTitle},qo=function(){return $.ZeroQueryCreatePieChartMessage},Vo=function(){return $.ZeroQueryGenerateAGraphTitle},Go=function(){return $.ZeroQueryGenerateAGraphMessage},Wo=function(){return $.ZeroQueryHighlightDuplicatesTitle},zo=function(){return $.ZeroQueryHighlightDuplicatesMessage},Qo=function(){return $.ZeroQueryHighlightCellsTitle},Jo=function(){return $.ZeroQueryHighlightCellsMessage},jo=function(){return $.ZeroQueryApplyColorCodingTitle},Yo=function(){return $.ZeroQueryApplyColorCodingMessage},Xo=function(){return $.ZeroQueryWebSearchCreateTableTitle},Ko=function(){return $.ZeroQueryWebSearchCreateTableMessage},Zo=function(){return $.ZeroQueryWebSearchTravelTitle},er=function(){return $.ZeroQueryWebSearchTravelMessage},tr=function(){return $.ZeroQueryWebSearchLearnTitle},ar=function(){return $.ZeroQueryWebSearchLearnMessage},nr=function(){return $.ZeroQueryImportTableTitle},or=function(){return $.ZeroQueryImportTableMessage},rr=function(){return $.ZeroQueryPrepareForMeetingsTitle},ir=function(){return $.ZeroQueryPrepareForMeetingsMessage},lr=function(){return $.PromptMenuItemHowCanCopilotHelp},sr=function(){return $.HintCardAnalyzeDataSuggestionHeader},cr=function(){return $.HintCardAnalyzeDataSuggestionMessage1},dr=function(){return $.HintCardAnalyzeDataSuggestionMessage2},ur=function(){return $.HintCardAnalyzeDataSuggestionMessage3},mr=function(){return $.HintCardAnalyzeDataSuggestionMessage4},gr=function(){return $.HintCardAnalyzeDataSuggestionMessage5},hr=function(){return $.HintCardMoonshotSuggestionHeader},pr=function(){return $.HintCardMoonshotSuggestionMessage1},br=function(){return $.HintCardMoonshotSuggestionMessage2},fr=function(){return $.HintCardMoonshotSuggestionMessage3},Cr=function(){return $.HintCardMoonshotSuggestionMessage4},yr=function(){return $.HintCardFormatDataSuggestionHeader},vr=function(){return $.HintCardFormatDataSuggestionMessage1},Tr=function(){return $.HintCardFormatDataSuggestionMessage2},xr=function(){return $.HintCardFormatDataSuggestionMessage3},Sr=function(){return $.HintCardFormatDataSuggestionMessage5},wr=function(){return $.StopGeneratingResponse},Er=function(){return $.StopGeneratingResponseTableExplain},Rr=function(){return $.StopGeneratingResponsePythonMode},Ir=function(){return H.ChatHistoryHydrationError},Ar=function(){return H.TopicChangedResponseText},Lr="https://support.microsoft.com/office/welcome-to-microsoft-365-copilot-in-excel-e5faf5c4-aa48-437a-b5b2-b35ac2c4a01b",Fr=function(){return $.LearnMoreResponsePrefix},_r=function(){return $.LearnMoreResponseLinkText},Nr=function(){return[$.LearnMoreResponseContentFirst,$.LearnMoreResponseContentSecond,$.LearnMoreResponseContentThird]},kr=function(){return U()?D(ExcelCopilotStringsNTier.ErrorScreenHeader):"We ran into an error."},Or=function(){return U()?D(ExcelCopilotStringsNTier.ErrorScreenInstruction):"Please reopen the Copilot pane to try again."},Pr=function(){return U()?D(ExcelCopilotStringsNTier.ErrorScreenReopenButton):"Reopen"},Mr=function(){return $.CommandingUndoWarningSuffix},Dr=function(){return $.CommandingUndoWarningActionListHeader},$r=function(){return $.CommandingUndoWarningConfirm},Br=function(){return $.CommandingUndoWarningReject},Hr=function(){return $.CommandingExplanationPrefix},Ur=function(){return $.OfficeJSResponseExplain},qr=function(){return $.OfficeJSErrorExplanationPrefix},Vr=function(){return $.OfficeJSExplanationPrefix},Gr=function(){return $.OfficeJSSimpleSuccessResponse},Wr="https://aka.ms/copilotlicensecheck",zr="https://aka.ms/copilotlicensecheck",Qr=function(){return $.CopilotLicenseHelpPrefix},Jr=function(){return $.OfficeScriptSaveScriptFailPrefix},jr=function(){return"I was not able to find an Office Script called '{0}'"},Yr=function(){return"Something went wrong while trying to schedule your script"},Xr=function(){return"Sure, I've created an Office Script called '{0}' to automate your previous requests. Click \"Save Script\" to keep it for future use."},Kr=function(){return"Schedule script '{0}' to run:"},Zr=function(){return"Sure. Based on your automation request, here is an option for you."},ei=function(){return"Starting"},ti=function(){return"Repeat every"},ai=function(){return"I cannot run the script '{0}' for you. Please run it manually in Automate tab."},ni=function(){return"Done! I saved your Office Script."},oi=function(){return"You can find it in the Gallery in the Automate tab to re-run later."},ri=function(){return"View Script"},ii=function(){return"Save Script"},li=function(){return"Script name: '{0}'"},si=function(){return"Delete Script"},ci=function(){return"I'm unable to delete your script '{0}'. Please try again later or delete it from the {1} folder in your OneDrive."},di=function(){return'"Office Scripts"'},ui=function(){return"Sure, I've deleted script '{0}'."},mi=function(){return"Confirm or edit the flow"},gi=function(){return"Script"},hi=function(){return"Your automation has been scheduled successfully."},pi=function(){return"The response is too large to be displayed. Please try a smaller dataset."},bi=function(){return"Similar cells referenced"},fi=()=>$.GroundingSourcePrefix,Ci=()=>$.GroundingWithDocument,yi=()=>$.GroundingWithDocumentDescription,vi=()=>$.GroundingWithEnterpriseData,Ti=()=>$.GroundingWithEnterpriseDataDescriptionV2,xi=()=>$.ChatPlaceholderMessageInputV2Enterprise,Si=()=>$.GroundingSourceInformationTooltipV2,wi=()=>$.GroundingDocToWorkModeSwitchMessage,Ei=()=>$.GroundingWorkToDocModeSwitchMessage,Ri="EnterpriseSearch",Ii="acquired",Ai={menuTitle:()=>$.PromptGuideMenuTitle,menuSectionCreate:()=>$.PromptGuideMenuSelectionCreate,menuSectionUnderstand:()=>$.PromptGuideMenuSelectionUnderstand,menuSectionEdit:()=>$.PromptGuideMenuSelectionEdit,menuSectionAsk:()=>$.OfficeScriptSaveScriptFailPrefixAsk,viewMorePrompts:()=>$.PromptGuideViewMorePrompts},Li={generateFormulaColumnSuggestion:()=>$.PromptGuideMenuSectionItemGenerateFormulaColumnSuggestion,addAColumnThatCombines:()=>$.PromptGuideMenuSectionItemAddAColumnThatCombines,addAColumnToExtract:()=>$.PromptGuideMenuSectionItemAddAColumnToExtract,addAColumnThatCalculates:()=>$.PromptGuideMenuSectionItemAddAColumnThatCalculates},Fi={showDataInsights:()=>$.PromptGuideMenuSectionItemShowDataInsights,percentageCalculation:()=>$.PromptGuideMenuSectionItemPercentageCalculation,howManyDifferent:()=>$.PromptGuideMenuSectionItemHowManyDifferent,whichItems:()=>$.PromptGuideMenuSectionItemWhichItems},_i={highlight:()=>$.PromptGuideMenuSectionItemHighlight,sort:()=>$.PromptGuideMenuSectionItemSort,filter:()=>$.PromptGuideMenuSectionItemFilter,applyRYG:()=>$.PromptGuideMenuSectionItemApplyRYG},Ni={help:()=>lr()},ki=function(){return $.MicrophonePermissionErrorTitleWeb},Oi=function(){return $.MicrophonePermissionErrorTextWeb},Pi=function(){return $.MicrophonePermissionErrorTitleWin32},Mi=function(){return $.MicrophonePermissionErrorTextWin32},Di=function(){return U()?D(ExcelCopilotStringsNTier.CopilotNotAvailableInYourLanguageOthersSupported):"Copilot isn't available in your language yet. For now, you can try Copilot in English."},$i=function(){return U()?D(ExcelCopilotStringsNTier.LearnMoreLinkText):"Learn more"},Bi="https://go.microsoft.com/fwlink/?linkid=2247434",Hi=6e4,Ui=3e6,qi=function(e){return(0,o.k6)()?e>1?$.CommandingHumanInTheLoopMultipleChangesResponseMessage:$.CommandingHumanInTheLoopSingleChangeResponseMessage:"Done! I made the following changes in range {0}:"},Vi=function(e){return(0,o.k6)()?e>1?$.CommandingHumanInTheLoopMultipleChangesNoRangeResponseMessage:$.CommandingHumanInTheLoopSingleChangeNoRangeResponseMessage:"Done! I made the following changes:"},Gi=function(){return"Here's a {0} that shows an insight about your data."},Wi=function(){return"Here's a {0} based on your prompt."},zi=function(){return"This {0} may include some of the information you're looking for. If it doesn't show everything you requested, try another prompt."},Qi=function(){return"I looked through your data for this criteria: {0}. There were no matches. If you want to try again, use another prompt."},Ji=function(){return"I looked through your data for this criteria: {0}. There are no matches."},ji=function(){return["chart","PivotChart","PivotTable","formula"]},Yi=function(){return"a Map Chart"},Xi=function(){return"a Scatter Chart"},Ki=function(){return"a Clustered Combo Chart"},Zi=function(){return"a Stacked Combo Chart"},el=function(){return"a Hundred Percent Combo Chart"},tl=function(){return"a Funnel Chart"},al=function(){return"a Treemap Chart"},nl=function(){return"a Sunburst Chart"},ol=function(){return"a Color Filled Map Chart"},rl=function(){return"a Circular Treemap Chart"},il=function(){return"a Heat Map Chart"},ll=function(){return"a Waterfall Chart"},sl=function(){return"a Rose Chart"},cl=function(){return"a Network Map Chart"},dl=function(){return"a Smooth Line Chart"},ul=function(){return"a Combo Chart"},ml=function(){return"a Line Chart"},gl=function(){return"a Pie Chart"},hl=function(){return"a Donut Chart"},pl=function(){return"an Area Chart"},bl=function(){return"a Stacked Area Chart"},fl=function(){return"a Hundred Percent Stacked Area Chart"},Cl=function(){return"a Clustered Bar Chart"},yl=function(){return"a Stacked Bar Chart"},vl=function(){return"a Hundred Percent Stacked Bar Chart"},Tl=function(){return"a Clustered Column Chart"},xl=function(){return"a Stacked Column Chart"},Sl=function(){return"a Hundred Percent Stacked Column Chart"},wl=function(){return"that type of chart"},El=function(){return $.PrePythonModeErrorText},Rl=function(){return U()?D(ExcelCopilotStringsNTier.PythonUnsupportedLocaleErrorText):"I'm still working to support other languages when I help you with Python. For now, please try your prompt again in English."},Il=function(){return $.PythonInsertProtectedSheetErrorText},Al=function(){return U()?ExcelCopilotStringsNTier.PythonPlatformErrorTextWithLink:"Python in Excel is only available for Excel for Windows. {0}."},Ll=function(){return U()?ExcelCopilotStringsNTier.PythonAvailabilityErrorTextWithLink:"Python in Excel isn't available. {0}"},Fl=function(){return U()?ExcelCopilotStringsNTier.PythonPrerequisiteValidationErrorLinkText:"View more information"},_l="https://go.microsoft.com/fwlink/?linkid=2279837",Nl=function(){return $.PythonStartAnalysisEditModeErrorText},kl=function(){return $.PythonGenericEditModeErrorText},Ol=function(){return $.PythonRestartRuntimeErrorText},Pl=function(){return $.PythonBusyStateErrorText},Ml=function(){return $.PythonAnalysisSheetWasDeletedDuringGenerationErrorText},Dl=function(){return $.PythonCodeRetryMaximumHitErrorText},$l=function(){return $.PythonGeneralErrorTextWithLinkOld},Bl=function(){return $.PythonGeneralErrorTextWithLink},Hl=function(){return $.PythonGeneralErrorLinkText},Ul="https://go.microsoft.com/fwlink/?linkid=2281206",ql=function(){return $.PythonNoSuggestionGenericErrorText},Vl=function(){return $.PythonCodeRetryResponseText},Gl=function(){return $.PythonCodeRetryResponseWithAddressText},Wl=function(){return $.PythonCodeDefaultErrorMessage},zl=function(){return(0,o.yw)("OfficeVSO_9496420_PythonFirst30sStringUpdates")?"I can use advanced analysis for that. Hereâ€™s what Iâ€™ll do once you start the analysis:":$.PythonStartAnalysisHeaderText},Ql=function(){return["Running Code..."]},Jl=function(){return $.PythonStartAnalysisFirstBulletText},jl=function(){return $.PythonStartAnalysisSecondBulletText},Yl=function(){return $.PythonStartAnalysisThirdBulletText},Xl=function(){return $.PythonStartAnalysisFourthBulletText},Kl=function(){return"Ready to get started?"},Zl=function(){return(0,o.yw)("OfficeVSO_9496420_PythonFirst30sStringUpdates")?"Start advanced analysis":$.PythonStartAnalysisButtonText},es=function(){return $.PythonExistAnalysisConfirmationText},ts=function(){return $.PythonStartAnalysisRAIErrorText},as=function(){return B.PythonAnalysisSheetNameText},ns=function(){return(0,o.yw)("OfficeVSO_9496420_PythonFirst30sStringUpdates")?"Analysis Sheet":$.PythonAnalysisSheetHeaderText},os=function(){return $.PythonAnalysisSheetDescriptionText},rs=function(){return $.PythonAnalysisSheetWasDeletedBeforeGenerationText},is=function(){return"Detail"},ls=function(){return"Done! I added the results to {0}."},ss=function(){return"Go back to analysis sheet"},cs=function(){return"I'm having trouble inserting your results into the sheet. Try again later."},ds=function(){return"Add results to new sheet"},us=function(){return $.PythonPostviewHeaderText},ms=function(){return $.PythonPostviewLoadingHeaderText},gs=function(){return $.PythonPostviewNotSupportedText},hs=function(){return $.PythonShowCodeButtonText},ps=function(){return $.PythonHideCodeButtonText},bs=function(){return $.PythonLabelFallbackText},fs=function(){return $.PythonDataframeLabelText},Cs=function(){return $.PythonDataframeCodeExplanationText},ys=function(){return $.PythonPreviewLabelText},vs=function(){return $.PythonSuggestMoreIdeasPill},Ts=function(){return $.PythonWhatElseCanIDoPill},xs=function(){return"Reference with DataFrames"},Ss=function(){return"When asking for deeper analysis with Python, Copilot references your original, source data in a DataFrame â€“ never changing it. Any edits you make to the source data will be synced to analysis results."},ws=function(){return"Insert Python column"},Es=function(){return"Sorry, something went wrong with Python calculated columns. Try your request again later."},Rs=function(){return"Done! I inserted the new Python column to column {0}."},Is=function(){return"I can't insert any Python columns because it looks like no table is selected. Double check to make sure a table is selected and try again."},As=function(){return"Whoops! This code generated a {0} error. Please try again later."},Ls=function(){return"Whoops! This feature only works on formatted tables. Please format your data as an Excel table and try again. (Hint: select the table and run CTRL+T)"},Fs=function(){return"My query was cancelled."},_s=function(){return"I succeeded in my task."},Ns=function(){return"I failed in my task."},ks=function(){return $.AnalyzeDataCardHeader},Os=function(){return U()?ExcelCopilotStringsNTier.ChartTypeArea:"Area"},Ps=function(){return U()?ExcelCopilotStringsNTier.ChartTypeAreaStacked:"Stacked Area"},Ms=function(){return U()?ExcelCopilotStringsNTier.ChartTypeAreaStacked100:"100% Stacked Area"},Ds=function(){return U()?ExcelCopilotStringsNTier.ChartTypeBarClustered:"Clustered Bar"},$s=function(){return U()?ExcelCopilotStringsNTier.ChartTypeBarStacked:"Stacked Bar"},Bs=function(){return U()?ExcelCopilotStringsNTier.ChartTypeBarStacked100:"100% Stacked Bar"},Hs=function(){return U()?ExcelCopilotStringsNTier.ChartTypeColumnClustered:"Clustered Column"},Us=function(){return U()?ExcelCopilotStringsNTier.ChartTypeColumnStacked:"Stacked Column"},qs=function(){return U()?ExcelCopilotStringsNTier.ChartTypeColumnStacked100:"100% Stacked Column"},Vs=function(){return U()?ExcelCopilotStringsNTier.ChartTypeLine:"Line"},Gs=function(){return U()?ExcelCopilotStringsNTier.ChartTypeLineStacked:"Stacked Line"},Ws=function(){return U()?ExcelCopilotStringsNTier.ChartTypeLineStacked100:"100% Stacked Line"},zs=function(){return U()?ExcelCopilotStringsNTier.ChartTypeDoughnut:"Doughnut"},Qs=function(){return U()?ExcelCopilotStringsNTier.ChartTypePie:"Pie"},Js=function(){return U()?ExcelCopilotStringsNTier.ChartTypeScatter:"Scatter"},js=function(){return U()?ExcelCopilotStringsNTier.ChartTypeHistogram:"Histogram"},Ys=function(){return U()?ExcelCopilotStringsNTier.ChartTypeBubble:"Bubble"},Xs=function(){return U()?ExcelCopilotStringsNTier.ThousandsUnitsLabel:"Thousands"},Ks=function(){return U()?ExcelCopilotStringsNTier.MillionsUnitsLabel:"Millions"},Zs=function(){return U()?ExcelCopilotStringsNTier.BillionsUnitsLabel:"Billions"},ec=function(){return U()?ExcelCopilotStringsNTier.TrillionsUnitsLabel:"Trillions"},tc=function(){return U()?ExcelCopilotStringsNTier.BlankCellValue:"(blank)"},ac=function(){return U()?ExcelCopilotStringsNTier.AutoAddedValuesFieldName:"Values"},nc=function(){return U()?ExcelCopilotStringsNTier.XAxisDescriptor:"X"},oc=function(){return U()?ExcelCopilotStringsNTier.YAxisDescriptor:"Y"},rc=function(){return U()?ExcelCopilotStringsNTier.PrimaryXAxisDescriptor:"Primary X-Axis"},ic=function(){return U()?ExcelCopilotStringsNTier.PrimaryYAxisDescriptor:"Primary Y-Axis"},lc=function(){return U()?ExcelCopilotStringsNTier.SecondaryXAxisDescriptor:"Secondary X-Axis"},sc=function(){return U()?ExcelCopilotStringsNTier.SecondaryYAxisDescriptor:"Secondary Y-Axis"},cc=function(){return U()?ExcelCopilotStringsNTier.SumAggregationLabel:"Sum"},dc=function(){return U()?ExcelCopilotStringsNTier.AverageAggregationLabel:"Average"},uc=function(){return U()?ExcelCopilotStringsNTier.CountAggregationLabel:"Count"},mc=function(){return U()?ExcelCopilotStringsNTier.MinAggregationLabel:"Min"},gc=function(){return U()?ExcelCopilotStringsNTier.MaxAggregationLabel:"Max"},hc=function(){return U()?ExcelCopilotStringsNTier.StdDevAggregationLabel:"StdDev"},pc=function(){return U()?ExcelCopilotStringsNTier.VarAggregationLabel:"Var"},bc=function(){return U()?ExcelCopilotStringsNTier.PivotTableRowLabels:"Row Labels"},fc=function(){return U()?ExcelCopilotStringsNTier.PivotTableColumnLabels:"Column Labels"},Cc=function(){return U()?ExcelCopilotStringsNTier.PivotTableGrandTotal:"Grand Total"},yc=function(){return U()?ExcelCopilotStringsNTier.ConcatenatedAriaLabel:"{0}, {1}"},vc=function(){return U()?ExcelCopilotStringsNTier.ChartTypeAlternativeText:"Chart type: {0}."},Tc=function(){return U()?ExcelCopilotStringsNTier.ComboChartTypeAlternativeText:"Chart type: Combo: {0}; {1}."},xc=function(){return U()?ExcelCopilotStringsNTier.AltTextDisclaimer:"Description automatically generated"},Sc=function(){return U()?ExcelCopilotStringsNTier.PivotTableDataFieldHeader:"{0} of {1}"},wc=function(){return U()?ExcelCopilotStringsNTier.PivotTableGrandTotalWithDataField:"Total {0} of {1}"},Ec=function(){return U()?ExcelCopilotStringsNTier.PivotTableSubtotalWithDataField:"{0} {1} of {2}"},Rc=function(){return U()?ExcelCopilotStringsNTier.TransformedColumnName:"{0}{1}"},Ic=function(){return U()?ExcelCopilotStringsNTier.FieldTitle:"Field{0}"},Ac=function(){return U()?ExcelCopilotStringsNTier.SubtitleNameUnits:"{0} ({1})"},Lc=function(){return U()?ExcelCopilotStringsNTier.SubtitleNameUnits2:"{0} ({1}); {2} ({3})"},Fc=function(){return U()?ExcelCopilotStringsNTier.SubtitleWithSemicolon:"{0}; "},_c=function(){return U()?ExcelCopilotStringsNTier.SubtitleUnits:"({0})"},Nc=function(){return U()?ExcelCopilotStringsNTier.AddPeriodToText:"{0}."},kc=function(){return U()?ExcelCopilotStringsNTier.SeriesCountAlternativeText:"{0} series."},Oc=function(){return U()?ExcelCopilotStringsNTier.DatapointCountAlternativeText:"Series {0}: {1} datapoints."},Pc=function(){return U()?ExcelCopilotStringsNTier.PrimaryHorizontalAxisAlternativeText:"Primary Horizontal axis title: {0}."},Mc=function(){return U()?ExcelCopilotStringsNTier.PrimaryVerticalAxisAlternativeText:"Primary Vertical axis title: {0}."},Dc=function(){return U()?ExcelCopilotStringsNTier.SecondaryHorizontalAxisAlternativeText:"Secondary Horizontal axis title: {0}."},$c=function(){return U()?ExcelCopilotStringsNTier.SecondaryVerticalAxisAlternativeText:"Secondary Vertical axis title: {0}."},Bc=function(){return U()?ExcelCopilotStringsNTier.XAxisAlternativeText:"X axis title: {0}."},Hc=function(){return U()?ExcelCopilotStringsNTier.YAxisAlternativeText:"Y axis title: {0}."},Uc=function(){return U()?ExcelCopilotStringsNTier.PivotTableSingleRowTitle:"{0} as row"},qc=function(){return U()?ExcelCopilotStringsNTier.PivotTableTwoRowTitle:"{0} and {1} as rows"},Vc=function(){return U()?ExcelCopilotStringsNTier.PivotTableColumnTitle:"{0} as column"},Gc=function(){return U()?ExcelCopilotStringsNTier.PivotTableDataTitle:"{0} as values"},Wc=function(){return U()?ExcelCopilotStringsNTier.PivotTableSubtotal:"{0} Total"},zc="This code was made by Copilot for your specific needs. Please review it before you use it in another workbook.",Qc=function(){return $.CommandingHumanInTheLoopSingleEventHeader},Jc=function(){return $.CommandingHumanInTheLoopMultipleEventsHeader},jc=function(){return $.CommandingHumanInTheLoopSingleCFEventHeader},Yc=function(){return $.CommandingHumanInTheLoopMultipleCFEventsHeader},Xc=function(){return $.ImportDataCardHeaderMultipleTables},Kc=function(){return $.ImportDataCardHeaderSingleTable},Zc=function(){return"I am unable to find relevant tables to import, here are all the tables from the referred files that you can import:"},ed=function(){return $.ImportDataStaticSuggestionPillText},td=function(){return $.ImportDataStaticSuggestionButtonText},ad=function(){return $.ImportDataImportToNewSheet},nd=function(){return $.ImportDataSuccessButtonText},od=function(){return $.ImportDataQuerySnippetTitle},rd=function(){return $.ImportDataCaruselText},id=function(){return $.ImportDataExcelFileTooltip},ld=function(){return $.ImportDataQueryExplanation},sd=function(){return $.ImportDataShowImportQuery},cd=function(){return $.ImportDataHideImportQuery},dd=function(){return[$.ImportDataPrepareImportOptions1]},ud=function(){return[$.ImportDataPrepareImportOptions2]},md=function(){return[$.ImportDataToGridOption1]},gd=function(){return $.ImportDataLoadQueryAddedToDocumentMessageNoBindingText},hd=function(){return $.ImportDataNoTableFoundMessageText},pd=function(){return $.ImportDataFailureGeneralMessageText},bd=function(e){return e?B.SuggestionPillConditionalFormatting:$.SuggestionPillConditionalFormatting},fd=function(){return $.ConditionalFormattingSuggestionResponse},Cd=function(){return $.ConditionalFormattingSuggestionResponseError},yd=function(){return $.ConditionalFormattingSuggestionResponseNoSuggestion},vd=function(){return $.ConditionalFormattingSuggestionResponseNoSuggestionForRange},Td=function(){return $.ConditionalFormattingSuggestionResponseNoTable},xd=function(){return $.ConditionalFormatFormulaInvalidErrorText},Sd=function(){return $.UnsupportedConditionalFormatEntityRangeText},wd=function(){return $.ActionButtonApply};var Ed;!function(e){e.CopilotChat="copilotChat",e.Reviewer="reviewerAgent",e.DirectSkill="directSkill",e.DevTools="devTools",e.AugloopDiagnostics="augloopDiagnostics",e.AugloopModelVisualizer="augloopModelVisualizer"}(Ed||(Ed={}));const Rd={copilotChat:"Copilot",reviewerAgent:"Reviewer",directSkill:"Direct Skill",devTools:"Dev tools",augloopDiagnostics:"Augloop Diagnostics",augloopModelVisualizer:"Augloop Model Visualizer"},Id=()=>H.CseSelfHelpSkillContentRetrievedQuickAnswer,Ad=()=>H.CseSelfHelpSkillContentRetrievedSingleArticle,Ld=()=>H.CseSelfHelpSkillErrorOrNoContentRetrieved,Fd=()=>$.CseSelfHelpSkillSourceLabel,_d=()=>H.ChatInputCharacterLimitExceededMessage,Nd=()=>$.ODSLGeneralError,kd=function(){return $.ServerErrorWithNoRetry},Od=()=>$.ElseSkillGeneralError,Pd=()=>$.FallbackSkillLatencyMessage,Md=()=>$.AugLoopSearchAndActionError,Dd=()=>$.AugLoopSearchAndActionErrorImproved,$d=()=>$.AugLoopNoTableError,Bd=()=>$.AugLoopNoTableError2,Hd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorValueFormula:"How do I fix the #VALUE! error in my table when using the {formula} formula?",Ud=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorValue:"How do I fix the #VALUE! error in my table?",qd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorNameFormula:"How do I fix the #NAME! error in my table when using the {formula} formula?",Vd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorName:"How do I fix the #NAME! error in my table?",Gd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorRefFormula:"How do I fix the #REF! error in my table when using the {formula} formula?",Wd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorRef:"How do I fix the #REF! error in my table?",zd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorSpillFormula:"How do I fix the #SPILL! error in my table when using the {formula} formula?",Qd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorSpill:"How do I fix the #SPILL! error in my table?",Jd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorDiv0Formula:"How do I fix the #DIV/0! error in my table when using the {formula} formula?",jd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorDiv0:"How do I fix the #DIV/0! error in my table?",Yd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorNumFormula:"How do I fix the #NUM! error in my table when using the {formula} formula?",Xd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorNum:"How do I fix the #NUM! error in my table?",Kd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorCalcFormula:"How do I fix the #CALC! error in my table when using the {formula} formula?",Zd=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorCalc:"How do I fix the #CALC! error in my table?",eu=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorNAFormula:"How do I fix the #N/A error in my table when using the {formula} formula?",tu=()=>U()?ExcelCopilotStringsNTier.PromptFormulaErrorNA:"How do I fix the #N/A error in my table?",au=()=>U()?ExcelCopilotStringsNTier.PromptNumbersStoredAsText:"How do I convert numbers stored as text to numbers?",nu=()=>U()?ExcelCopilotStringsNTier.PromptSortData:"How do I sort data?",ou=()=>U()?ExcelCopilotStringsNTier.PromptFormatNumbers:"How do I format numbers in Excel?",ru=()=>U()?ExcelCopilotStringsNTier.PromptWrapText:"How do I wrap text in a cell?",iu=()=>U()?ExcelCopilotStringsNTier.PromptApplyDataValidation:"How do I apply data validation to cells?",lu=()=>U()?ExcelCopilotStringsNTier.PromptFilerData:"How do I filter data in a table?",su=()=>U()?ExcelCopilotStringsNTier.PromptMergeCells:"How do I merge and unmerge cells?",cu=()=>U()?ExcelCopilotStringsNTier.PromptAccessibilityChecker:"How do I improve accessibility with the accessibility checker?",du=()=>U()?ExcelCopilotStringsNTier.PromptConditionalFormattingHighlighting:"How do I use conditional formatting to highlight information?",uu=()=>U()?ExcelCopilotStringsNTier.PromptSplitText:"How do I spilt text into different columns?",mu=()=>U()?ExcelCopilotStringsNTier.PromptPageBreaks:"How do I insert, move, or delete page breaks?",gu=()=>U()?ExcelCopilotStringsNTier.PromptInsertDeleteRowsColumns:"How do I insert or delete rows and columns?",hu=()=>U()?ExcelCopilotStringsNTier.PromptInconsistentFormulaFormula:"How do I fix the inconsistent formula in my table when using the {formula} formula?",pu=()=>U()?ExcelCopilotStringsNTier.PromptInconsistentFormula:"How do I fix the inconsistent formula in my table?",bu=()=>U()?ExcelCopilotStringsNTier.PromptUnprotectedFormulaFormula:'How do I fix the "Unprotected Formula" error when using the {formula} formula?',fu=()=>U()?ExcelCopilotStringsNTier.PromptUnprotectedFormula:'How do I fix the "Unprotected Formula" error?',Cu=()=>U()?ExcelCopilotStringsNTier.PromptInconsistentCalculatedColumnFormula:"How do I fix the inconsistent calculated column error when using {formula} formula?",yu=()=>U()?ExcelCopilotStringsNTier.PromptInconsistentCalculatedColumn:"How do I fix the inconsistent calculated column error?",vu=()=>$.TabularRangeUnrecognizedTableError,Tu=()=>$.TabularRangeUnrecognizedTableDueToWorkbookSizeError,xu=()=>$.TabularRangeRowMajorSingleError,Su=()=>$.TabularRangeRowMajorMultipleError,wu=()=>$.TabularRangeRowMajorErrorHeader,Eu=()=>$.TabularRangeMergedCellsSingleError,Ru=()=>$.TabularRangeMergedCellsMultipleError,Iu=()=>$.TabularRangeMergeCellsErrorHeader,Au=()=>$.TabularRangeAggregationsSingleError,Lu=()=>$.TabularRangeAggregationsMultipleError,Fu=()=>$.TabularRangeAggregationsErrorHeader,_u=()=>$.TabularRangeMultipleHeaderRowsSingleError,Nu=()=>$.TabularRangeMultipleHeaderRowsMultipleError,ku=()=>$.TabularRangeMultipleHeaderRowsErrorHeader,Ou=()=>$.TabularRangeNoHeaderColumnsSingleError,Pu=()=>$.TabularRangeNoHeaderColumnsMultipleError,Mu=()=>$.TabularRangeNoHeaderColumnsErrorHeader,Du=()=>$.TabularRangeInterpretationConfidenceSingleError,$u=()=>$.TabularRangeInterpretationConfidenceMultipleError,Bu=()=>$.TabularRangeInterpretationConfidenceErrorHeader,Hu=()=>$.TabularRangeEmptyHeadersSingleError,Uu=()=>$.TabularRangeEmptyHeadersMultipleError,qu=()=>$.TabularRangeEmptyHeadersErrorHeader,Vu=()=>$.TabularRangeDuplicateHeadersSingleError,Gu=()=>$.TabularRangeDuplicateHeadersMultipleError,Wu=()=>$.TabularRangeDuplicateHeadersErrorHeader,zu=()=>$.TabularRangeCrosstabSingleError,Qu=()=>$.TabularRangeCrosstabMultipleError,Ju=()=>$.TabularRangeCrosstabErrorHeader,ju=()=>$.TabularRangeMultipleErrorCardIntro,Yu=()=>$.TabularRangeMultipleErrorCardConclusion,Xu=()=>$.TabularRangeMultipleErrorCardConvertToTableConclusion,Ku=()=>U()?ExcelCopilotStringsNTier.PromptPythonError:'Help with the Python error "{error}"',Zu=function(){return(0,o.k6)()&&(0,o.yw)("OfficeVSO_9196996_LocalizeMultipleEventsError")?$.MultipleEventsExecutionErrorText:"I couldn't finish your request. If something isn't right, use Undo to remove my changes."},em=function(){return void 0!==ExcelCopilotCommandingHitlStrings?ExcelCopilotCommandingHitlStrings.TableClearSortLabel:"Remove sorting on table ${tableName}"},tm=()=>"Qtr1",am=()=>"Qtr2",nm=()=>"Qtr3",om=()=>"Qtr4",rm=()=>"Jan",im=()=>"Feb",lm=()=>"Mar",sm=()=>"Apr",cm=()=>"May",dm=()=>"Jun",um=()=>"Jul",mm=()=>"Aug",gm=()=>"Sep",hm=()=>"Oct",pm=()=>"Nov",bm=()=>"Dec",fm=function(){return"Sorry, I can't do multiple things at once. For the best experience, add one request at a time."},Cm=function(){return"If your data changes, be sure to go back to Copilot and ask your question again to get an updated answer."},ym=function(){return"I'm not able to make changes in those cells because they're outside of the Excel Table. Try making changes to cells inside of the Excel Table."},vm=function(){return"I can only modify table structures relative to the visible cells in your table. Please unhide cells, clear filters, or phrase your prompt using a target location relative to the visible cells. If you need further assistance, let me know."},Tm=function(){return"I can't make those changes at the same time. The order of the changes would impact the cell locations and effect the target locations of the next changes. Please separate your changes into independent prompts, and try them again."},xm=function(){return"I couldn't complete your request. Please restate the part of your request that needs to be finished."},Sm=function(){return"Hopefully that's the column you had in mind. Remember, I work best when you tell me the name of the column you're referring to."},wm=function(){return"I couldn't create {0}, but here's an answer that may be helpful."},Em=function(){return"I need more practice before I can do that. For now, I'll share the steps you can follow."},Rm=function(){return"For now, I can only do that for columns in tables. Try asking me to apply formatting in a table column instead."},Im=function(){return"Want to undo?  Here's how:"},Am=function(){return'Select "Home" > "Undo"'},Lm=function(){return'Press "Ctrl"+ "Z" on your keyboard'},Fm=function(){return'Press "CMD"+ "Z" on your keyboard'},_m=function(){return"Want to add alternative text (alt text) to this table? Here's how:"},Nm=function(){return"Right-click on the table."},km=function(){return'Select "Table" > "Alt Text".'},Om=function(){return'Select "Table" > "Alternative Text".'},Pm=function(){return"Want to add a comment? Here's how:"},Mm=function(){return"Right-click on the cell."},Dm=function(){return'Select "New Comment".'},$m=function(){return"Enter your comment and mention people who need to view it if needed."},Bm=function(){return'Select "Post".'},Hm=function(){return"Want to apply data validation to cells? Here's how: "},Um=function(){return"Select one or more cells you want to create a rule for."},qm=function(){return'Select "Data" > "Data Validation".'},Vm=function(){return'On the "Settings" tab, under Allow, select an option.'},Gm=function(){return"Enter information for additional settings."},Wm=function(){return'Select "Error Alert" to customize the error message.'},zm=function(){return'Select "OK".'},Qm=function(){return"Want to create a pivot table? Here's how:"},Jm=function(){return"Select the cells you want to use to create the pivot table."},jm=function(){return'Select "Insert" > "PivotTable" > "Select a table or range".'},Ym=function(){return"Make sure the cell range is correct."},Xm=function(){return'Select "New Woksheet" or "Existing Worksheet" to set where you want the pivot table to appear. '},Km=function(){return'Select "OK".'},Zm=function(){return"Want to add, delete, or rename a worksheet?"},eg=function(){return'To add a worksheet: Select the "New Sheet" icon or "Home" > "Insert" > "Insert Sheet".'},tg=function(){return'To delete a worksheet: Right-click the "Sheet" tab and select "Delete" or "Home" > "Delete" > "Delete Sheet".'},ag=function(){return'To rename a worksheet: Double-click the name on the "Sheet" tab. You can also right-click on the "Sheet" tab, select "Rename", and type a new name.'},ng=function(){return"Want to freeze rows or columns?  Here's how:"},og=function(){return"Select the cell below the rows, and to the right of the columns you want to freeze."},rg=function(){return'Select "View" > "Freeze Panes" > "Freeze Panes". Or, choose another option depending on what you want to freeze.'},ig=function(){return"I can't insert a table into the sheet. However, I can try to help you using a table that's already in the sheet."},lg=function(){return"I don't currently have a way to know which cells you selected. Please specify the cells, columns, or rows you want me to work with."},sg=function(){return"Sorry, I can't remove sorting from the table. Please tell me how you'd like to sort the table, or make a new request."},cg=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes accounting, currency, fraction, number, percentage, or scientific formatting and try again."},dg=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes a date or time format and try again."},ug=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes a text, special, date, or time format and try again."},mg=function(){return"Sorry, I can't apply conditional formatting to this range. Remove any general, custom, or text formatting for the range and try again."},gg=function(){return"Sorry, I can't apply a numeric filter (greater than, less than, between, or their negations) to a column that's not numeric. Make sure it doesn't contain text or true/false data, and try again."},hg=function(){return"Sorry, I can't apply a text filter (begins with, ends with, contains, or their negations) to a column that's not textual. Make sure it doesn't contain numeric or true/false data, and try again."},pg=function(){return"Sorry, I can't delete the row(s). Is there anything else I can help you with?"},bg=function(){return"Sorry, I can't modify the column(s). Is there anything else I can help you with?"},fg=function(){return"Sorry, I can't modify the entity. Make sure the correct entity is selected and try again."},Cg=()=>$.PivotTableChartPresentWithoutTableTLRError,yg=()=>$.PivotTableChartPresentWithoutTableTLRError2,vg=()=>$.PivotTableChartSelectedErrorHeader,Tg=()=>$.PivotTableChartSelectedError,xg=()=>$.RequestedVisualTypeUnsupportedError,Sg=()=>$.UnsupportedAnalysisError,wg=()=>$.NoPatternsFoundError,Eg=()=>$.UnsupportedVisualConverterError,Rg=function(){return $.FixItButtonText},Ig=function(){return $.TabularRangeAutoFixDuplicateHeadersSuccessfulResponse},Ag=function(){return $.TabularRangeAutoFixDuplicateHeadersUnsuccessfulResponse},Lg=function(){return $.TabularRangeAutoFixMergedCellsSuccessfulResponse},Fg=function(){return $.TabularRangeAutoFixMergedCellsUnsuccessfulResponse},_g=function(){return $.TabularRangeAutoEmptyHeadersSuccessfulResponse},Ng=function(){return $.TabularRangeAutoEmptyHeadersUnsuccessfulResponse},kg=function(){return $.NoAutoFixCompleted},Og=function(){return $.TabularRangeAutoFixDuplicateHeaders},Pg=function(){return $.HeaderColumnLabel},Mg=function(){return $.HeaderRowLabel},Dg=function(){return $.TlrAutoFixConfirmationMultipleCases},$g=function(){return $.TlrAutoFixUnsuccessful},Bg=function(){return $.AutoFixMoreThanTwoMergedCells},Hg=function(){return $.AutoFixTwoMergedCells},Ug=function(){return $.AutoFixOneMergedCells},qg=function(){return $.AutoFixMultipleMergedCellsDescription},Vg=function(){return $.AutoFixIntroduction},Gg=()=>$.ExplainTablesPill,Wg=()=>$.ExplainHeadersPill,zg=()=>$.ExplainUnmergingCellsPill,Qg=()=>{switch(n.i.GetHostAppPlatform()){case Office.PlatformType.OfficeOnline:return"cmmyfd4mgl3";case Office.PlatformType.Mac:return"cmmweb1zw6v";case Office.PlatformType.PC:return"cmml0h1c9sd";case Office.PlatformType.iOS:return"cmmuefjswpd";default:return}},Jg=()=>n.i.GetHostAppPlatform()===Office.PlatformType.Mac?"excelmac":"excel",jg=()=>H.OutOfCreditsError},94303:(e,t,a)=>{a.d(t,{Dd:()=>u,UP:()=>i,VD:()=>p,WD:()=>g,iG:()=>b,ip:()=>f,j4:()=>s,m2:()=>c,sF:()=>h,tF:()=>d,tJ:()=>n,vb:()=>o});var n,o,r,i,l=a(81364);class s extends Error{constructor(e,t){super(e),this.isOnlyUnsupportedEventsError=!0,this.unsupportedTypes=t}}class c extends Error{constructor(e){super(e),this.isMultipeEventsExecutionError=!0}}!function(e){e.General="General",e.ColumnRowOutOfBoundary="ColumnRowOutOfBoundary",e.ColumnRowBySelection="ColumnRowBySelection",e.ConditionalFormatFormulaInvalid="conditionalFormatFormulaInvalid",e.ConditionalFormatFormulaExplanationInvalid="conditionalFormatFormulaExplanationInvalid",e.ClearSortUnsupported="ClearSortUnsupported",e.NoColumnArgument="NoColumnArgument",e.ColorDistanceExceededThreshold="ColorDistanceExceededThreshold",e.DeleteUnexpectedTableRows="DeleteUnexpectedTableRows",e.DeleteWithInsertColumns="DeleteWithInsertColumns",e.MultipleTableStructureChanges="MultipleTableStructureChanges",e.NoActiveTable="NoActiveTable",e.NoSupportedNumberFormatCategoriesNumber="NoSupportedNumberFormatCategoriesNumber",e.NoSupportedNumberFormatCategoriesDate="NoSupportedNumberFormatCategoriesDate",e.NoSupportedNumberFormatCategoriesText="NoSupportedNumberFormatCategoriesText",e.NoSupportedNumberFormatCategoriesOther="NoSupportedNumberFormatCategoriesOther",e.NoVisibleRange="NoVisibleRange",e.NumericFilterOnNonNumberError="NumericFilterOnNonNumberError",e.TextualFilterOnNonTextError="TextualFilterOnNonTextError",e.VariableCacheEntityTypeMismatched="VariableCacheEntityTypeMismatched"}(n||(n={}));class d extends Error{constructor(e,t,a,n){super(e),this.isConverterError=!0,this.property=t,this.failureType=a??"General",this.dataFields=n}}!function(e){e.ArgumentUndefined="ArgumentUndefined",e.ArgumentTypeUndefined="ArgumentTypeUndefined",e.ArgumentValueUndefined="ArgumentValueUndefined",e.ArgumentTypeMismatch="ArgumentTypeMismatch"}(o||(o={}));class u extends Error{constructor(e,t,a,n){super(e),this.isStatementArgumentError=!0,this.reason=t,this.argumentType=a,this.expectedType=n}}!function(e){e.EmptyEntityArray="EmptyEntityArray",e.UnsupportedArguments="UnsupportedArguments",e.NoMatchedArguments="NoMatchedArguments",e.Unknown="Unknown"}(r||(r={}));class m extends Error{constructor(e,t,a,n){super(`No event generate for statement: ${e}.`),this.isNoEventGeneratedError=!0,this.statementName=e,this.argumentNames=Object.keys(t),this.reason=a,this.unsupportedArgumentTypes=n}}class g extends Error{constructor(e){super(e),this.isExecutorError=!0}}!function(e){e.General="General",e.MissingIntent="MissingIntent",e.NoActiveTable="NoActiveTable"}(i||(i={}));class h extends Error{constructor(e,t){super(e),this.isHumanInTheLoopError=!0,this.failureType=t??"General"}}function p(e,t,a,n=!1){throw 0===t?new m(e.name,e.arguments,"EmptyEntityArray"):a.length>0?new m(e.name,e.arguments,"UnsupportedArguments",a):new m(e.name,e.arguments,n?"NoMatchedArguments":"Unknown")}function b(e){return e.isStatementArgumentError||e.isOnlyUnsupportedEventsError||e.isConverterError||e.isStatementArgumentError||e.isNoEventGeneratedError||e.isExecutorError||e.isHumanInTheLoopError}function f(e){return e instanceof l.u&&e.errorCode===l.O.PayloadSizeError}},31764:(e,t,a)=>{a.d(t,{L7:()=>f,Si:()=>h,VL:()=>b,sR:()=>p});var n=a(49134),o=a(52922),r=a(70352),i=a(76672),l=a(46581);const s={type:l.default.automin,formula:"",number:0},c={type:l.default.automax,formula:"",number:0},d={borderColor:"#FF0000",borderStyle:n.BorderLineStyle.Thin,borderWeight:o.BorderWeight.thin,scaleFactor_deprecated:15,scaleFactor:.25,defaultHeightWidth:15,fontColor:"#000000",fontSizeChange:2},u={isGradientFill:!0,borderColor:null,fillColor:"#FFFF00",isLTRDirection:!0,isNegativeValuesFillColorCustom:!1,negativeValuesFillColor:"#FFFF00",isNegativeValuesBorderColorCustom:!1,negativeValuesBorderColor:null,isShowValueEnabled:!0,axisColor:"#000000",axisPositionType:i.default.none,minBoundCFObjectValues:s,maxBoundCFObjectValues:c,minimumColorDeprecated:"#FF0000",minimumColor:"#F8696B",maximumColorDeprecated:"#00FF00",maximumColor:"#63be7b",midpointColor:"",maximumCFObjectValues:{type:l.default.max,formula:null,number:0},midpointCFObjectValuesDeprecated:{type:l.default.percent,formula:"=50",number:0},midpointCFObjectValues:{type:l.default.percentile,formula:"=50",number:50},minimumCFObjectValues:{type:l.default.min,formula:null,number:0},shouldGenerateGetRule:!1,defaultCustomFormat:{BackgroundColor:null,TextColor:"#000000",IsTextBold:!1,IsTextItalic:!1,IsTextStrikethrough:!1,IsTextUnderlined:!1,IsTextDoubleUnderlined:!1,BorderFormat:{Position:15,LineStyle:[n.BorderLineStyle.None,n.BorderLineStyle.None,n.BorderLineStyle.None,n.BorderLineStyle.None],Color:[0,0,0,0],ThemeBorderColor:[{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0}],ColorTypeOption:r.hU.rgbColor,Thickness:[0,0,0,0]},PreserveBackgroundColor:!1,PreserveTextColor:!1},BorderStyle:n.BorderLineStyle.Thin,defaultBackgroundColor:"#FFFF00",topBottomRank:10,topBottomType:"topItems"},m={"#FF0000":"#FF555A","#00FF00":"#63BE7B","#FFFF00":"#FFEF9C","#FFFFFF":"#FCFCFF","#0000FF":"#5A8AC6","#FFC0CB":"#FFC7CE","#8B0000":"#9C0006","#006400":"#63BE7B","#4169E1":"#5A8AC6","#FFA500":"#FCBF7B"},g={isAscending:!0,caseMatch:!1};function h(e){return d[e]}function p(e){return u[e]}function b(e){return g[e]}function f(e){return e in m?m[e]:e}},1805:(e,t,a)=>{a.d(t,{K:()=>Xt});var n=a(96098),o=a(94303),r=a(51319),i=a(92779),l=a(88179),s=a(31030),c=a(48314),d=a(49134),u=a(62522),m=a(23147);function g(e){const t=m.CP.getActiveTable();if(!t)throw new o.tF("Failed to resolve selected tables!",e);return t}function h(e,t){const a=g(t).sheetRange,n=a.range.topLeft,r=n.row,i=n.column,l=a.range.bottomRight,s=l.row,c=l.column,d=e.range.range.topLeft,u=d.row,m=d.column,h=e.range.range.bottomRight,p=h.row,b=h.column;if(null===r||null===i||null===s||null===c)throw new o.tF("Table range is null",t,o.tJ.ColumnRowOutOfBoundary);if(null===u||null===m||null===p||null===b)throw new o.tF("Range is null",t,o.tJ.ColumnRowOutOfBoundary);if(r>u||s<p)throw new o.tF("Row is out of bounds of the table",t,o.tJ.ColumnRowOutOfBoundary);if(i>m||c<b)throw new o.tF("Column is out of bounds of the table",t,o.tJ.ColumnRowOutOfBoundary);return e}const p=(e,t)=>{e=e.toLowerCase();for(const a of t)if(a.test(e))return!0;return!1};var b=a(50347);const f=[/\(/,/\)/,/\{/,/\}/,/\\\\/,/\/\//,/=/,/#/,/!/,/div\/0/,/.*\|.*/],C=[/^(0?[1-9]|1\d|2\d|3[01])[/-](0?[1-9]|1[0-2])[/-](\d{4}|\d{2})$/,/^(0?[1-9]|1[0-2])[/-](0?[1-9]|1\d|2\d|3[01])[/-](\d{4}|\d{2})$/,/^(?:jan(?:uary)?|feb(?:ruary)?|mar(?:ch)?|apr(?:il)?|may|jun(?:e)?|jul(?:y)?|aug(?:ust)?|sep(?:tember)?|oct(?:ober)?|nov(?:ember)?|dec(?:ember)?)\s(?:0?[1-9]|[12]\d|3[01]),?(?:\s\d{2}(?:\d{2})?)?$/,/^(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])$|^(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])\/$|^(0[1-9]|1[0-2])\/(0?[1-9]|[12]\d|3[01])$|^(0[1-9]|1[0-2])\/(0?[1-9]|[12]\d|3[01])\/(0?[1-9]|[12]\d|3[01])$|^(0?[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])$/],y=[/^-?[\d,. ']+%?$/],v=[/\b(odd|even)\s*(rows?|row)\b/i,/every\s+\b\w+\b\s*(rows?|row)/i],T=(0,b.yw)("OfficeVSO_9193005_NegativeRowIndexEnglishFix")?[/\b(first|last|top|bottom|beginning|ending)([\w\d\s]*)(rows?)\b/i,/\b(rows?)([\w\d\s]*)(top|bottom|beginning|end)\b/i,/\b(rows?)([\w\d\s]*)(above|below|under)$/i,/\b(headers?)\b/i]:[/\b(first|last|top|bottom|beginning|ending)\s*([\w\d]*)\s*(rows?)\b/i,/\b(row?|rows?)\s*([\w\d]*)\s*(top|bottom|beginning|end)\b/i,/\b(row?|rows?)\s*(above|below|under)$/,/\b(headers?)\b/],x=[/\b(last|bottom|ending)\s*([\w\d]*)\s*(rows?)\b/i,/\b(row?|rows?)\s*([\w\d]*)\s*(bottom|end)\b/i,/\b(row?|rows?)\s*(below|under)\b/i],S=[/\b(this|these|selected)\s+(row|rows)\b/gi,/\b(row|rows)\s+(selected)\b/gi],w=[/\b(clear|remove|delete|erase)\s+sort/gi],E=[/^(?!.*format)\b(clear|delete|eliminate|empty|erase|remove).*?(cell|cells|content|contents|data|text|value|values)\b/i,/\b(clear|delete|eliminate|empty|erase|remove)\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(format|formats|formatting)\s+and\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(cell|cells|content|contents|data|text|value|values)\b/i,/\b(clear|delete|eliminate|empty|erase|remove)\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(cell|cells|content|contents|data|text|value|values)\s+and\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(format|formats|formatting)\b/i],R=[/^(clear|delete|eliminate|empty|erase|remove) all(?!.*format)/i],I=[/^(remove|delete)/i];function A(e,t){if(t<0)throw new Error("Row index can bot be smaller than 0!");return{sheet:e,range:{topLeft:{row:t,column:null},bottomRight:{row:t,column:null}}}}function L(e,t){if(t<0)throw new Error("Column index can bot be smaller than 0!");return{sheet:e,range:{topLeft:{row:null,column:t},bottomRight:{row:null,column:t}}}}async function F(){try{return await Excel.run((async e=>{const t=e.workbook.worksheets.getActiveWorksheet();return t.load("name"),await e.sync(),t.name}))}catch{throw new o.tF("Failed to get active worksheet name","getActiveWorkSheetName")}}function _(e,t,a){let n;if(n=e<0?t.length+e:e-1,n>=t.length||n<0)throw new o.tF("Column index specified out of boundary.",a,o.tJ.ColumnRowOutOfBoundary);return t[n]}function N(e,t){const a=[];for(let n=e;n<=t;n++)a.push(n);return a}function k(e,t,a,n,r){if(null===e.range.topLeft.column||null===e.range.topLeft.row)throw new o.tF("Bad Column from TableContext","getFullTableEntityColumnRangeByIndex");const i=e.range.topLeft.column+t,l={row:e.range.topLeft.row,column:i},s={row:e.range.topLeft.row+1,column:i},c={row:e.range.bottomRight.row,column:i},u={sheet:e.sheet,range:{topLeft:s,bottomRight:c}},m={sheet:e.sheet,range:{topLeft:l,bottomRight:c}};return(0,b.av)()&&n?{columnRange:{rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.ColumnsBody,tableName:a,gridRange:u,subRangeValues:r?{columnNames:[r]}:{firstIndex:t,count:1}}},fullColumnRange:{rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Columns,tableName:a,gridRange:m,subRangeValues:r?{columnNames:[r]}:{firstIndex:t,count:1}}}}:{columnRange:{rangeType:d.RangeType.ExcelSheetRange,range:u},fullColumnRange:{rangeType:d.RangeType.ExcelSheetRange,range:m}}}var O=a(24008);function P(e,t){let a=[];const n=(0,O.dc)(e,"worksheetRowNumbers");return n&&n.length>0?n.map((e=>{if(e<=t)throw new o.tF("worksheetRowNumber specified out of boundary.","getRowNumber",o.tJ.ColumnRowOutOfBoundary);a.push(e-t-1)})):a=(0,O.dc)(e,"rowNumbers"),a}async function M(){if((0,b.yw)("OfficeVSO_9194315_Selection")){const e=m.CP.getActiveRangeAddresses();if(0===e.length)return[];try{return e.map((e=>d.ExcelCalc.sheetAddressToGeneralExcelSheetRange(e))).map((e=>e.range))}catch{throw new o.tF("Failed to get selected ranges.","getSelectedRanges",o.tJ.ColumnRowBySelection)}}try{return await Excel.run((async e=>{const t=e.workbook.getSelectedRanges(),a=t.areas;a.load("items/address"),t.load("address"),await e.sync();return a.items.map((e=>e.address)).map((e=>d.ExcelCalc.sheetAddressToGeneralExcelSheetRange(e))).map((e=>e.range))}))}catch{throw new o.tF("Failed to get selected ranges.","getSelectedRanges")}}var D=a(89337);function $(e,t,a,n,r,i){let s=[];if(t.length>0)s=U(e,t,i);else if(a.length>0||n.length>0)s=B(e,a.length>0?a:n,i);else if(r.length>0)s=function(e,t,a){const n=e.sheetRange,r=n.range.topLeft.column;if(null===r)throw new o.tF("Left column index of the table is null.",a);const i=t.map((t=>{if(t<0)return B(e,[t],a)[0];const n=t-1;if((0,b.yw)("OfficeVSO_8385154_ColumnByWorksheetNumberBugFix")){if(n>r+e.numColumns-1||n<r)throw new o.tF("Worksheet index received is outside of the table.",a,o.tJ.ColumnRowOutOfBoundary);return n-r}if(t>r+e.numColumns-1||t<r)throw new o.tF("Worksheet index received is outside of the table.",a,o.tJ.ColumnRowOutOfBoundary);return t-r}));return i}(e,r,i);else{if("filterTables"===i||"sortTables"===i)throw new o.tF("No column argument specified.",i);if("insertColumns"===i)return[];if("clearFilters"===i)throw new o.tF("No column argument specified.",i,o.tJ.NoColumnArgument);s=Array.from({length:e.numColumns},((e,t)=>t))}const c=[];if(s.map((t=>{-1===e.visibleColumns.indexOf(t)&&c.push(t)})),c.length>0){u.g.instance().setHiddenColumnSuffixMessage(e,c);const t=[{key:l.xL.NumOfColumnHidden,value:c.length}];(0,D.R)(new o.tF("User selected a column that is hidden.",i,o.tJ.General,t))}return s}function B(e,t,a){return t.map((t=>{let n;if(n=t<0?e.numColumns+t:t-1,n>=e.numColumns||n<0)throw new o.tF("Column index specified out of boundary.",a,o.tJ.ColumnRowOutOfBoundary);return n}))}function H(e){return String.raw`${e}`.replace(/\\n/g," ").replace(/\\r/g," ").replace(/\\t/g," ").replace(/\\v/g," ").replace(/\\(.)/g,"$1").replace(/\s+/g," ").trim().toLowerCase()}function U(e,t,a){const n=JSON.parse(e.headers);return t.map((e=>{let t=n.indexOf(e);if(-1===t){if((0,b.yw)("OfficeVSO_8432116_CleaningColumnName")){const a=H(e);t=n.findIndex((e=>H(e)===a))}if(-1===t)throw new o.tF("Column name specified not found.",a,o.tJ.ColumnRowOutOfBoundary)}return t}))}function q(e,t,a=!1){const n=[];let r=t.sheetRange;if(m.CP.isTableHeaderShown()){if(null===r.range.topLeft.row)throw new o.tF("Row range has incorrect format","getTableRowIndicesFromRanges");r={sheet:r.sheet,range:{topLeft:{row:r.range.topLeft.row+1,column:r.range.topLeft.column},bottomRight:r.range.bottomRight}}}for(const t of e){if(t.range.topLeft.row!==t.range.bottomRight.row)throw new o.tF("Row range has incorrect format","getTableRowIndicesFromRanges");if(null===t.range.topLeft.row||null===r.range.topLeft.row||null===r.range.bottomRight.row)throw new o.tF("Row not available (e.g. range address might refer to a full column)","getTableRowIndicesFromRanges",o.tJ.ColumnRowOutOfBoundary);if(t.range.topLeft.row<r.range.topLeft.row||t.range.topLeft.row>r.range.bottomRight.row+(a?1:0))throw new o.tF("Row out of boundary","getTableRowIndicesFromRanges",o.tJ.ColumnRowOutOfBoundary);const e=t.range.topLeft.row-r.range.topLeft.row;n.push(e)}if(0===n.length)throw new o.tF("No matched row index found","getTableRowIndicesFromRanges");return n}async function V(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.worksheets.getActiveWorksheet().load("name"),n=a.getRange(d.ExcelCalc.IExcelRangeToAddress(e.sheetRange.range)).getVisibleView();n.load("cellAddresses"),await t.sync();return n.cellAddresses.map((e=>{if((0,b.yw)("OfficeVSO_9322539_InsertAtTableEnd")&&0===e.length)throw new o.tF("No visible table row.","getVisibleRowRanges",o.tJ.NoVisibleRange);const t=a.name+"!"+e[0]+":"+e[e.length-1];return d.ExcelCalc.sheetAddressToExcelSheetRange(t)}))}))}var G=a(33540),W=a(81800),z=a.n(W);class Q{static async getSelectedWorksheets(e){let t=[];if(t=(0,O.Lb)(e,"worksheetNames"),0===t.length){const a=(0,O.dc)(e,"worksheetNumbers");if(a&&a.length>0){const e=await async function(){return Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets.load("items");return await e.sync(),t.items.map((e=>e.name))}))}();t=a.map((t=>{if(t<1||t>e.length)throw new o.tF("Worksheet number can not be 0 or greater than number of worksheets!","getSelectedWorksheets");return e[t-1]}))}else t=[await F()]}if(0===t.length)throw new o.tF("No worksheet has been selected!","getSelectedWorksheets");return t}static async getSelectedRanges(e,t){let a=await Q.getWorksheetScopeVariable(e,t);void 0===a&&(a=await F());let n=[];const r=(0,O.Lb)(e,"addresses");if(n=r&&r.length>0?r.map((t=>{const n={rangeType:d.RangeType.ExcelSheetRange,range:{sheet:a,range:d.ExcelCalc.addressToExcelRange(t)}};return(0,b.yw)("OfficeVSO_8324147_CheckRangeOutOfBounds")?h(n,e.name):n})):(await M()).map((t=>{if((0,b.yw)("OfficeVSO_8973949_CheckSelectionOutsideOfTable")){return h({rangeType:d.RangeType.ExcelSheetRange,range:{sheet:a,range:t.range}},e.name)}return{rangeType:d.RangeType.ExcelSheetRange,range:t}})),(0,b.av)()){let e={};await Excel.run((async t=>{e=await z().getTablesNameToRangeMapOnSheet(t,a)})),n=n.map((t=>{for(const a of Object.keys(e)){const n=d.ExcelEventConverter.makeTableRangeOperation(a,e[a],t.range);if(n){return{rangeType:d.RangeType.TableRange,range:n}}}return t}))}if(0===n.length)throw new o.tF("No ranges has been selected!","getSelectedRanges");return n}static async getSelectedTables(e,t){let a=await Q.getWorksheetScopeVariable(e,t);void 0===a&&(a=await F());const n=(0,O.Lb)(e,"tableNames"),r=Q.tryGetSelectedTableContext(e.name),i=(0,b.yw)("OfficeVSO_9469830_CFSuggestionsImprovedErrorMessage")?o.tJ.NoActiveTable:void 0;if(0===n.length){if(!r)throw new o.tF("Failed to resolve selected tables!","getSelectedTables",i);return[r]}const l=[];for(let e=0;e<n.length;e++){const t=n[e];if(r&&(0,G.P9)(r.name,t))l.push(r);else{await m.CP.fetchAndSetActiveTableLikeEntity(t);const e=m.CP.getActiveTable();e&&l.push(e)}}if(0===l.length)throw new o.tF("No table has been selected!","getSelectedTables",i);return l}static async getSelectedColumns(e,t){const a=t.tryGetScopeChainedVariableArgument(e),n=t.tryGetScopeVariableArgumentName(e);if(!a||!n)return await Q.getTableScopeSelectedColumns(e);if("Table"===a.entityType){const t=a.values[0];return await Q.getTableColumnRanges(t,e,n)}throw"Worksheet"===a.entityType?new o.tF("Worksheet column is not currently supported.","getSelectedColumns",o.tJ.ColumnRowOutOfBoundary):new o.tF(`Scope ${a.entityType} is not supported`,"getSelectedColumns")}static async getTableColumnRanges(e,t,a){let n=(0,O.Lb)(t,"columnNames");const o=$(e,n,(0,O.dc)(t,"columnNumbers"),(0,O.dc)(t,"tableColumnNumbers"),(0,O.dc)(t,"worksheetColumnNumbers"),t.name);if(0===n.length&&(0,b.av)()){const t=JSON.parse(e.headers);n=o.map((e=>t[e]))}return await Q.getTableColumnRangesBase(o,e,n,a)}static async getTableColumnRangesBase(e,t,a,n){if((0,b.xy)("AutofitSelectedRowsColumns")){const r=await Promise.all(e.map((async(e,n)=>{const o=0===a.length?void 0:a[n];return k(t.sheetRange,e,t.name,(0,m.En)(t),o)})));if(0===r.length)throw new o.tF("No column is selected!","getTableColumnRangesBase");return{ranges:r.map((e=>e.columnRange)),fullRanges:r.map((e=>e.fullColumnRange)),indices:e,tableKey:n}}{const r=await Promise.all(e.map((async(e,n)=>{const o=0===a.length?void 0:a[n],{columnRange:r}=k(t.sheetRange,e,t.name,(0,m.En)(t),o);return r})));if(0===r.length)throw new o.tF("No column is selected!","getTableColumnRangesBase");return{ranges:r,indices:e,tableKey:n}}}static getTableColumnNames(e,t){const a=(0,O.Lb)(t,"columnNames"),n=(0,O.dc)(t,"columnNumbers"),o=(0,O.dc)(t,"tableColumnNumbers"),r=(0,O.dc)(t,"worksheetColumnNumbers"),i=JSON.parse(e.headers);return $(e,a,n,o,r,t.name).map((e=>i[e]))}static getTableColumnName(e,t){const a=(0,O.Ru)(t,"columnName"),n=(0,O.lI)(t,"columnNumber"),o=(0,O.lI)(t,"tableColumnNumber"),r=(0,O.lI)(t,"worksheetColumnNumber");return JSON.parse(e.headers)[$(e,a?[a]:[],n?[n]:[],o?[o]:[],r?[r]:[],t.name)[0]]}static getTableColumnNumber(e,t){if((0,b.yw)("NewEntityResolution")){const a=(0,O.Ru)(e,"columnName"),n=(0,O.lI)(e,"columnNumber"),o=(0,O.lI)(e,"tableColumnNumber"),r=(0,O.lI)(e,"worksheetColumnNumber");return $(t,a?[a]:[],n?[n]:[],o?[o]:[],r?[r]:[],e.name)[0]}{const a=(0,O.Ru)(e,"columnName"),n=(0,O.lI)(e,"columnNumber");if(!a&&!n)throw new o.tF("No sort column specified","column");let r;if(a){r=JSON.parse(t.headers).indexOf(a)}if((!a||-1===r)&&n){r=_(n,t.visibleColumns,e.name)}return r}}static getTableColumnNumbers(e,t){const a=(0,O.dc)(e,"tableColumnNumbers");return $(t,[],(0,O.dc)(e,"columnNumbers"),a,(0,O.dc)(e,"worksheetColumnNumbers"),e.name)}static async getTableScopeSelectedColumns(e){const t=e.name,a=g(t),n=(await M())[0],r=n.range.topLeft.column,i=n.range.bottomRight.column;if(null===r||null===i)throw new o.tF("selected range is invalid","getTableScopeSecelectedColumns");const l=N(r,i),s=l.map((e=>e+1)),c=$(a,[],[],[],(0,b.yw)("OfficeVSO_8385154_ColumnByWorksheetNumberBugFix")?s:l,t);let d=[];if((0,b.av)()){const e=JSON.parse(a.headers);d=c.map((t=>e[t]))}const u=(0,O.iA)(e);((0,b.yw)("OfficeVSO_9435729_bugFixSelectColumnWithSelectionScope")||(0,b.av)())&&u&&(u.type="var",u.name="tables",e.arguments.tableColumnNumbers={type:"numberList",numberList:c});const m=(0,b.yw)("OfficeVSO_9435729_bugFixSelectColumnWithSelectionScope")&&u?.name?u?.name:"Selection";return await Q.getTableColumnRangesBase(c,a,d,m)}static async getSelectedColumnsDeprecated(e,t,a){const n=(0,O.NW)(e,"scope");if(!n)return this.getTableScopeSelectedColumns(e);const r=n.name,i=t.tryGetChainedVariableArgument(r);if(!i)return this.getTableScopeSelectedColumns(e);let l=(0,O.dc)(e,"columnNumbers"),s=(0,O.Lb)(e,"columnNames");if("Table"===i.entityType){const t=i.values[0],n=JSON.parse(t.headers),c=t.visibleColumns;if(l=0===l.length?l.concat(s.map((e=>{const t=n.indexOf(e);if(-1===t)throw new o.tF("Column name specified not found.","getSelectedColumnsDeprecated",o.tJ.ColumnRowOutOfBoundary);return t}))):l.map((t=>_(t,c,e.name))),0===s.length&&(0,b.av)()){const e=JSON.parse(t.headers);s=l.map((t=>e[t]))}if((0,b.xy)("AutofitSelectedRowsColumns")){0===l.length&&0===s.length&&(l=[...c]);const e=await Promise.all(l.map((async(e,a)=>{const n=s.length>0?s[a]:void 0;return k(t.sheetRange,e,t.name,!t.tableLikeRange,n)})));if(0===e.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return u.g.instance().setIsFirstColumnEntityResolved(t.headers,a),{ranges:e.map((e=>e.columnRange)),fullRanges:e.map((e=>e.fullColumnRange)),indices:l,tableKey:r}}{const e=await Promise.all(l.map((async(e,a)=>{const n=await async function(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.tables.getItem(e).columns.getItemAt(t).getDataBodyRange().load("address");return await a.sync(),n}))}(t.name,e);if((0,b.av)()&&(0,m.En)(t)){const o=s.length>0?s[a]:void 0;return{rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.ColumnsBody,gridRange:d.ExcelCalc.sheetAddressToExcelSheetRange(n.address),tableName:t.name,subRangeValues:o?{columnNames:[o]}:{firstIndex:e,count:1}}}}return{rangeType:d.RangeType.ExcelSheetRange,range:d.ExcelCalc.sheetAddressToExcelSheetRange(n.address)}})));if(0===e.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return u.g.instance().setIsFirstColumnEntityResolved(t.headers,a),{ranges:e,indices:l,tableKey:r}}}if("Worksheet"===i.entityType){const t=i.values[0];let a=[];if(0===l.length){a=(0,O.Lb)(e,"columnNames").map((e=>{const a=e+":"+e;return{rangeType:d.RangeType.ExcelSheetRange,range:{sheet:t,range:d.ExcelCalc.addressToExcelRange(a)}}}))}else a=l.map((e=>({rangeType:d.RangeType.ExcelSheetRange,range:L(t,e-1)})));if(0===a.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return{ranges:a,worksheetKey:r,indices:l}}throw new o.tF("invalid entity type","getSelectedColumnsDeprecated")}static async getSelectedRows(e,t,a){if(void 0===a)throw new o.tF("No query string",e.name);const n=(0,O.NW)(e,"scope");if(!n||"Selection"===n.name)return Q.getTableSelectedRows(e);const r=n.name,i=t.tryGetChainedVariableArgument(r);if(!i)throw new o.tF("No cached upper variable","getSelectedRows");let l=[];const s=(0,b.yw)("OfficeVSO_9436607_WorksheetRowNumber");if(s||(l=(0,O.dc)(e,"rowNumbers")),"Table"===i.entityType){const t=i.values[0];if(!s&&null==t.sheetRange.range.topLeft.row)throw new o.tF("Table row range has incorrect format","getSelectedRows");const n=t.sheetRange.range.topLeft.row??0;if(s&&(l=P(e,n)),(0,b.yw)("OfficeVSO_8375706_SelectAllRows")&&0===l.length)return this.getAllRows(t,r);const c=[...l],d=[],u=[],m=t.numRows;for(let e=0;e<l.length;e++)if(l[e]<0)if((0,b.yw)("OfficeVSO_9279053_SelectRowRegExpRemoval")||p(a,T))d.push(l[e]+n+m+1),u.push(c[e]+m);else{if((0,b.yw)("OfficeVSO_8532526_DeleteEmptyRows")&&-1===l[e]&&p(a,I))throw new o.tF("Deleting unexpected negative rows is a blocked scenario","deleteRows",o.tJ.DeleteUnexpectedTableRows);if(!t.totalRow)throw new o.tF("invalid negative row number expected","getSelectedRows");d.push(n+m+1),u.push(m)}else if(0===l[e])d.push(n),u.push(-1);else{if(l[e]>m+(t.totalRow?1:0))throw new o.tF("row numbers is greater than expected","getSelectedRows");d.push(l[e]+n),u.push(c[e]-1)}return{ranges:await Q.getTableRowRangesCommon(t,d,!0),tableKey:r,indices:u}}if("Worksheet"===i.entityType){s&&(l=(0,O.dc)(e,"worksheetRowNumbers"));return{ranges:Q.getWorksheetRowRangeCommon(i,l,a),worksheetKey:r,indices:l}}throw new o.tF("invalid entity type","getSelectedRows")}static async getTableSelectedRows(e){const t=g(e.name),a=(await M())[0],n=a.range.topLeft.row,r=a.range.bottomRight.row;if(null===n||null===r)throw new o.tF("selected range is invalid","getTableScopeSelectedColumns");const i=N(n,r),l=await Q.getTableRowRangesCommon(t,i,!0);let s=[];if(s=q(l.map((e=>d.ExcelCalc.getIGeneralRangeOperationRange(e))),t),(0,b.av)()){const t=(0,O.iA)(e);t&&(t.type="var",t.name="tables",e.arguments.rowNumbers={type:"numberList",numberList:s})}return{ranges:l,tableKey:"Selection",indices:s}}static async getAllRows(e,t){const a=(await V(e)).map((t=>{let a;return a=(0,b.av)()&&(0,m.En)(e)?{rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Rows,gridRange:t,tableName:e.name,subRangeValues:{firstIndex:e.sheetRange.range.topLeft.row-t.range.topLeft.row-1,count:1}}}:{rangeType:d.RangeType.ExcelSheetRange,range:t},a})),n=(e.sheetRange.range.topLeft.row??0)+1,o=a.map((e=>(d.ExcelCalc.getIGeneralRangeOperationRange(e).range.topLeft.row??0)-n));return m.CP.isTableHeaderShown()&&(o.shift(),a.shift()),{ranges:a,tableKey:t,indices:o,allRows:!0}}static getWorksheetRowRangeCommon(e,t,a){(0,b.yw)("OfficeVSO_9279066_RemoveRegExForRowBySelection")||function(e){if(p(e,S))throw new o.tF("Blocked phrase for referencing rows by selection","getSelectedRows",o.tJ.ColumnRowBySelection)}(a);const n=e.values[0],r=t.map((e=>({rangeType:d.RangeType.ExcelSheetRange,range:A(n,e-1)})));if(0===r.length)throw new o.tF("No row is selected!","getSelectedRows");return r}static async getTableRowRangesCommon(e,t,a=!1){const n=await V(e);let r=[];if(r=a?Q.getTableRowsByWorksheetIndices(n,t,e):await Q.getTableRowsByTableIndices(e,n,t),0===r.length)throw new o.tF("No row is selected!","getSelectedRows");return r}static getTableRowsByWorksheetIndices(e,t,a){const n=[];Q.throwIfRowsOutOfBoundary(t,a);for(const o of t){const t=e.find((e=>e.range.topLeft.row===o));if(t)if((0,b.av)()&&(0,m.En)(a)){const e={rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Rows,tableName:a.name,gridRange:t,subRangeValues:{firstIndex:t.range.topLeft.row-a.sheetRange.range.topLeft.row-1,count:1}}};n.push(e)}else{const e={rangeType:d.RangeType.ExcelSheetRange,range:t};n.push(e)}}return n}static async getTableRowsByTableIndices(e,t,a){e.totalRow&&t.pop();const n=(0,b.yw)("OfficeVSO_9322539_InsertAtTableEnd");if(n){if(0===t.length)throw new o.tF("No visible table row.","getTableRowsByTableIndices",o.tJ.NoVisibleRange);t.push({sheet:t[t.length-1].sheet,range:{topLeft:{row:t[t.length-1].range.topLeft.row+1,column:t[t.length-1].range.topLeft.column},bottomRight:{row:t[t.length-1].range.bottomRight.row+1,column:t[t.length-1].range.bottomRight.column}}})}return(a=a.map((e=>{let a=e;if(e<0?a=n?-1===e?t.length-1:t.length+e-1:t.length+e:m.CP.isTableHeaderShown()||(a=e-1),a>=t.length||a<0)throw new o.tF("Row index specified out of boundary.","getSelectedRows",o.tJ.ColumnRowOutOfBoundary);return a}))).map((a=>{if((0,b.av)()&&(0,m.En)(e)){let n;return n=0===a?{rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.HeaderRow,tableName:e.name,gridRange:t[a]}}:{rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Rows,tableName:e.name,gridRange:t[a],subRangeValues:{firstIndex:t[a].range.topLeft.row-e.sheetRange.range.topLeft.row-1,count:1}}},n}return{rangeType:d.RangeType.ExcelSheetRange,range:t[a]}}))}static async getWorksheetScopeVariable(e,t){const a=t.tryGetVariableArgumentValue(e,"scope");if(a&&"Worksheet"===a.entityType){const e=a.values;if(1===e.length)return e[0]}}static tryGetSelectedTableContext(e){try{return g(e)}catch{return}}static throwIfRowsOutOfBoundary(e,t){const a=t.sheetRange.range.topLeft.row,n=t.sheetRange.range.bottomRight.row;if(a&&e[0]<a||n&&e[e.length-1]>n)throw new o.tF("Row index specified out of boundary.","getSelectedRows",o.tJ.ColumnRowOutOfBoundary)}}class J{async cacheVariable(e,t){const a=this._variableCacheMap[e.name];await a(e,t)}isSelectStatement(e){return!!this._variableCacheMap[e.name]}isRowColumnSelectStatementWithSelectionScope(e){return!!(0,O.iA)(e)&&("selectColumns"===e.name||"selectRows"===e.name)}isDeleteColumnsStatement(e){return"deleteColumns"===e.name}isInsertColumnsStatement(e){return"insertColumns"===e.name}isSelectColumnsStatement(e){return"selectColumns"===e.name}isDeleteRowsStatement(e){return"deleteRows"===e.name}isInsertRowsStatement(e){return"insertRows"===e.name}isSelectRowsStatement(e){return"selectRows"===e.name}tryGetVariableArgumentValue(e,t){try{return this.getVariableArgumentValue(e,t)}catch{return}}getVariableArgumentValue(e,t){const a=(0,O.YL)(e,t),n=this.returnVariableCache[a];if(void 0===n)throw new o.tF("Cannot find variable in the cache dictionary!",t);return n}getChainedVariableArgument(e){const t=this.returnVariableCache[e];if(void 0===t)throw new o.tF("Chained variable cache is not found.","getChainedVariableArgument");return t}tryGetChainedVariableArgument(e){try{return this.getChainedVariableArgument(e)}catch{return}}getScopeChainedVariableArgument(e){const t=(0,O.l$)(e).name;return this.getChainedVariableArgument(t)}tryGetScopeChainedVariableArgument(e){try{return this.getScopeChainedVariableArgument(e)}catch{return}}getScopeVariableArgumentName(e){const t=(0,O.l$)(e);if(void 0===t.name)throw new o.tF("Scope name is undefined.","getScopeVariableArgumentName");return t.name}tryGetScopeVariableArgumentName(e){try{return this.getScopeVariableArgumentName(e)}catch{return}}getTableContext(e,t,a){const n=t.getVariableArgumentValue(e,a).values;if(!n.tableKey)throw new o.tF("Table key not found!",a);const r=t.getChainedVariableArgument(n.tableKey);if("Table"!==r.entityType)throw new o.tF("Variable cache entity type mismatched!","getTableContext: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return r.values[0]}UpdateVariableCache(e,t,a){void 0!==e&&(this.returnVariableCache[e]={entityType:t,values:a})}fillVariableCacheMap(){this._variableCacheMap.selectWorksheets=async(e,t)=>{const a=await Q.getSelectedWorksheets(e);this.returnVariableCache[(0,O.nZ)(e)]={entityType:"Worksheet",values:a}},this._variableCacheMap.selectRanges=async(e,t)=>{const a=await Q.getSelectedRanges(e,this);this.returnVariableCache[(0,O.nZ)(e)]={entityType:"Range",values:a}},this._variableCacheMap.selectTables=async(e,t)=>{const a=await Q.getSelectedTables(e,this);this.returnVariableCache[(0,O.nZ)(e)]={entityType:"Table",values:a}},this._variableCacheMap.selectColumns=async(e,t)=>{const a=(0,b.yw)("NewEntityResolution")?await Q.getSelectedColumns(e,this):await Q.getSelectedColumnsDeprecated(e,this,t);this.returnVariableCache[(0,O.nZ)(e)]={entityType:"Column",values:a}},this._variableCacheMap.selectRows=async(e,t)=>{const a=await Q.getSelectedRows(e,this,t);this.returnVariableCache[(0,O.nZ)(e)]={entityType:"Row",values:a}}}constructor(){this.returnVariableCache={},this._variableCacheMap={},this.fillVariableCacheMap()}}function j(e,t=[]){for(let a=0;a<e.length;a++)Array.isArray(e[a])?j(e[a],t):t.push(e[a]);return t}function Y(e){if(null===e.range.topLeft.row)throw new o.tF("no sheet range associated with table");return{rangeType:d.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:e.range.topLeft.row+1,column:e.range.topLeft.column},bottomRight:e.range.bottomRight}}}}async function X(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","conditionalFormatTables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedTableRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values,r=[];for(const e of n){let t;t=Y(e.sheetRange),((0,b.av)()||(0,b.yw)("OfficeVSO_9266813_CommandingConvertTableRangeToName"))&&(0,m.En)(e)&&(t={rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Body,tableName:e.name,gridRange:d.ExcelCalc.getIGeneralRangeOperationRange(t)}}),r.push(t)}return r}function K(e,t){if(void 0===e.arguments.columns)throw new o.tF("No columns specified.",e.name);const a=t.getVariableArgumentValue(e,"columns");if("Column"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedColumnRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return a.values.ranges}function Z(e,t){if(void 0===e.arguments.rows)throw new o.tF("No rows specified.",e.name);const a=t.getVariableArgumentValue(e,"rows");if("Row"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedRowRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return a.values.ranges}function ee(e,t){if(void 0===e.arguments.ranges)throw new o.tF("No range specified.",e.name);const a=t.getVariableArgumentValue(e,"ranges");if("Range"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return a.values}function te(e,t){const a=t.getVariableArgumentValue(e,"columns").values;if(!a?.tableKey)throw new o.tF("No table specified","columns");const n=t.tryGetChainedVariableArgument(a.tableKey);if(!n||!Array.isArray(n.values)||0===n.values.length)throw new o.tF("Table not found","columns");const r=n.values[0];if(!r?.headers)throw new o.tF("Invalid table data");const i=JSON.parse(r.headers);if(!Array.isArray(i)||0===i.length)throw new o.tF("Invalid table headers");const l=a.indices.map((e=>`'${i[e]}'`)).join(", ");if(!l)throw new o.tF("Invalid column name(s)");return l}function ae(e){const t={...e,bottomRight:{...e.bottomRight,row:e.bottomRight.row?e.bottomRight.row-1:e.bottomRight.row}};return d.ExcelCalc.IExcelRangeToAddress(t)}var ne=a(65230),oe=a(82563);function re(e,t){const a={rangeType:d.RangeType.ExcelSheetRange,range:t,values:e};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Range.Edited,t.sheet,a)}function ie(e,t){const a={rangeType:d.RangeType.ExcelSheetRange,range:t,value:e};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Range.SingleValueEdited,t.sheet,a)}function le(e,t,a,n){const o={rangeType:a.rangeType,range:a.range,value:t,columnName:n},r=d.ExcelCalc.getIGeneralRangeOperationRange(a).sheet;return ne.ExcelEventConverter.makeGenericEvent(e,r,o)}function se(e,t,a){return ne.ExcelEventConverter.makeGenericEvent(e,a,t)}function ce(e,t,a){const n={direction:a,rangeType:t.rangeType,range:t.range},o=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(e,o,n)}function de(e,t,a,n){const o={name:t,index:a,count:n};return ne.ExcelEventConverter.makeGenericEvent(e,t,o)}function ue(e,t,a,n){const o={name:e,index:t,count:a,columnNames:n};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.ColumnInserted,e,o)}function me(e,t){const a={rangeType:t.rangeType,range:t.range},n=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(e,n,a)}function ge(e,t){const a={rangeType:t.rangeType,range:t.range},n=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(e,n,a)}function he(e,t,a,n,o){const r={searchString:e,replaceWith:t,completeMatch:a,matchCase:n,rangeType:o.rangeType,range:o.range},i=d.ExcelCalc.getIGeneralRangeOperationRange(o).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Range.ReplacedAll,i,r)}function pe(e,t){const a={command:e,rangeType:t.rangeType,range:t.range},n=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Range.Cleared,n,a)}function be(e,t,a,n,o){const r={tableName:e,columnName:t,top:a,type:n,count:o};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.Top10FilterApplied,e,r)}function fe(e,t,a,n){const o={tableName:t,columnName:a,color:n};return ne.ExcelEventConverter.makeGenericEvent(e,t,o)}function Ce(e,t){const a={tableName:e,columnName:t};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.FilterCleared,e,a)}function ye(e){return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.AutoFilterCleared,e,{})}function ve(e,t,a,n,o){const r={range:t.range,columnName:n,rangeType:t.rangeType,formatType:oe.default.Custom,rule:a,customFormat:o},i=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(e,i,r)}function Te(e){const t={wholeSheet:!0,rangeType:e.rangeType,range:e.range},a=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.ConditionalFormatting.Deleted,a,t)}async function xe(e,t){let a=[],n=(0,O.BO)(e,"validationType");["date","decimal","textLength","time","wholeNumber"].includes(n)&&(n="basic");const o=Se[n];a=await o(t,e);const i=[];if(a.length>0){const e={agent:r.w2.OfficeScripts,items:a};i.push(e)}return i}const Se={list:async(e,t)=>{let a;const n=(0,O.Ru)(t,"source");if(void 0===n)throw new o.tF("Source is empty",t.name);void 0===(0,O.Ak)(t,"inCellDropDown")&&(a=!0);const r=j(await Promise.all(e.map((async e=>{const t=function(e,t,a){const n={range:e.range,rangeType:e.rangeType,source:t,inCellDropDown:a},o=d.EventMethods.Range.DataValidationRuleListChanged,r=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ne.ExcelEventConverter.makeGenericEvent(o,r,n)}(e,n,a);return[t]}))));return r},custom:async(e,t)=>{const a=(0,O.Ru)(t,"customFormula");if(void 0===a)throw new o.tF("Formula is empty",t.name);const n=j(await Promise.all(e.map((async e=>{const t=function(e,t){const a={range:e.range,rangeType:e.rangeType,formula:t},n=d.EventMethods.Range.DataValidationRuleCustomChanged,o=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ne.ExcelEventConverter.makeGenericEvent(n,o,a)}(e,a);return[t]}))));return n},basic:async(e,t)=>{let a;switch((0,O.BO)(t,"validationType")){case"date":a=d.EventMethods.Range.DataValidationRuleDateChanged;break;case"decimal":a=d.EventMethods.Range.DataValidationRuleDecimalChanged;break;case"textLength":a=d.EventMethods.Range.DataValidationRuleTextLengthChanged;break;case"time":a=d.EventMethods.Range.DataValidationRuleTimeChanged;break;case"wholeNumber":a=d.EventMethods.Range.DataValidationRuleWholeNumberChanged}const n=(0,O.Ru)(t,"formula1"),r=(0,O.Ru)(t,"formula2")??"",i=(0,O.BO)(t,"operator");if(void 0===n||void 0===i)throw new o.tF("Formula1 or Operator is empty",t.name);if(("Between"===i||"NotBetween"===i)&&""===r)throw new o.tF("Operator is ternary but formula2 is empty",t.name);const l=j(await Promise.all(e.map((async e=>{const t=function(e,t,a,n,o){const r={range:t.range,rangeType:t.rangeType,formula1:a,formula2:n,operator:o},i=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(e,i,r)}(a,e,n,r,i);return[t]}))));return l}};var we=a(19313);function Ee(e,t,a){const n=(0,O.Ak)(t,"content")??!1,i=(0,O.Ak)(t,"format")??!1,l={agent:r.w2.OfficeScripts,items:[]};if((0,b.yw)("OfficeVSO_9448487_fixClearContentFormatAndHyperlink")){for(const a of e)Re(l,t,a);return 0===l.items.length&&(0,o.VD)(t,e.length,[]),[l]}for(const t of e)n&&a&&(p(a,E)||p(a,R))&&l.items.push(pe(we.default.ClearCells,t)),i&&l.items.push(pe(we.default.ClearCellsFormat,t));return 0===l.items.length&&(0,o.VD)(t,e.length,[]),[l]}function Re(e,t,a){const n=(0,O.Ak)(t,"content")??!1,o=(0,O.Ak)(t,"format")??!1,r=(0,O.Ak)(t,"hyperlink")??!1,i=(0,O.Ak)(t,"all")??!1;n&&e.items.push(pe(we.default.ClearCells,a)),o&&e.items.push(pe(we.default.ClearCellsFormat,a)),r&&e.items.push(function(e,t){const a={command:e,rangeType:t.rangeType,range:t.range},n=d.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Range.HyperlinkRemoved,n,a)}(we.default.ConvertLinkedEntitiesToText,a)),i&&e.items.push(pe(we.default.ClearCellsAll,a))}async function Ie(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showHeaders=e.value,await t.sync()})),`I ${e.value?"set":"unset"} the header row on the table`}async function Ae(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showTotals=e.value,await t.sync()})),`I ${e.value?"added":"removed"} a total row from the table`}async function Le(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showBandedRows=e.value,await t.sync()})),`I ${e.value?"added":"removed"} banded rows`}async function Fe(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showBandedColumns=e.value,await t.sync()})),`I ${e.value?"added":"removed"} banded columns`}async function _e(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showFilterButton=e.value,await t.sync()})),`I ${e.value?"added":"removed"} the filter button`}async function Ne(e){const{tableName:t,columnName:a,color:n}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const o=e.workbook.tables.getItem(t),r=o.getHeaderRowRange();r.load("values"),await e.sync();const i=r.values[0].indexOf(a);o.autoFilter.apply(o.getRange(),i,{filterOn:"CellColor",color:n}),await e.sync()})),`I applied a cell color filter on ${a} to show only rows that are highlighted ${n}`}async function ke(e){const{tableName:t,columnName:a,color:n}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const o=e.workbook.tables.getItem(t),r=o.getHeaderRowRange();r.load("values"),await e.sync();const i=r.values[0].indexOf(a);o.autoFilter.apply(o.getRange(),i,{filterOn:"FontColor",color:n}),await e.sync()})),`I applied a font color filter on ${a} to show only rows that contain ${n} text `}async function Oe(e){const t=e;let a=[];await Excel.run({delayForCellEdit:!0},(async e=>{const n=e.workbook.tables.getItem(t.tableName);n.sort.apply(t.fields,t.caseMatch,t.method);const o=n.getHeaderRowRange();o.load("values"),await e.sync(),a=o.values[0]}));const n=[];return t.fields.forEach((e=>((e,t)=>{if(e.key<a.length){let n=`${a[e.key]} column in `;"FontColor"===e.sortOn?n+="font color":"CellColor"===e.sortOn?n+="cell color":e.ascending?n+="ascending":n+="descending",n+=" order",t.push(n)}})(e,n))),0===n.length?"I sorted the table":`I sorted the table by ${n.join(", ")}`}async function Pe(e){const t=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const a=e.workbook.tables.getItem(t.tableName),n=t.tableStyle;a.style="None"===n?null:t.tableStyle,await e.sync()})),`I applied the ${t.tableStyle} style to the table`}var Me=a(7024),De=a(96699);function $e(e,t){if(void 0===e)throw new o.tF("Limit1 is undefined!","filterTables");if(p(e,f))throw new o.tF("Invalid characters for custom filter in limit1","limit1");if(void 0!==t&&p(t,f))throw new o.tF("Invalid characters for custom filter in limit2","limit2")}function Be(e,t){let a="";switch(e){case De.default.Equals:a=`=${t}`;break;case De.default.DoesNotEqual:a=`<>${t}`;break;case De.default.BeginsWith:a=`=${t}*`;break;case De.default.DoesNotBeginWith:a=`<>${t}*`;break;case De.default.EndsWith:a=`=*${t}`;break;case De.default.DoesNotEndWith:a=`<>*${t}`;break;case De.default.Contains:a=`=*${t}*`;break;case De.default.DoesNotContain:a=`<>*${t}*`;break;case De.default.IsGreaterThan:a=`>${t}`;break;case De.default.IsGreaterThenOrEqualTo:a=`>=${t}`;break;case De.default.IsLessThen:a=`<${t}`;break;case De.default.IsLessThanOrEqualTo:a=`<=${t}`;break;default:throw new Error(`CustomFilterCompareType '${e}' not implemented.`)}return a}function He(e,t,a){const n=""!==a;switch(e){case"equalTo":return{compareType:"N/A",value1:{valueCompareType:De.default.Equals,value:t}};case"notEqualTo":return{compareType:"N/A",value1:{valueCompareType:De.default.DoesNotEqual,value:t}};case"beginsWith":return{compareType:n?"Or":"N/A",value1:{valueCompareType:De.default.BeginsWith,value:t},value2:n?{valueCompareType:De.default.BeginsWith,value:a}:void 0};case"notBeginsWith":return{compareType:n?"And":"N/A",value1:{valueCompareType:De.default.DoesNotBeginWith,value:t},value2:n?{valueCompareType:De.default.DoesNotBeginWith,value:a}:void 0};case"endsWith":return{compareType:n?"Or":"N/A",value1:{valueCompareType:De.default.EndsWith,value:t},value2:n?{valueCompareType:De.default.EndsWith,value:a}:void 0};case"notEndsWith":return{compareType:n?"And":"N/A",value1:{valueCompareType:De.default.DoesNotEndWith,value:t},value2:n?{valueCompareType:De.default.DoesNotEndWith,value:a}:void 0};case"contains":return{compareType:n?"Or":"N/A",value1:{valueCompareType:De.default.Contains,value:t},value2:n?{valueCompareType:De.default.Contains,value:a}:void 0};case"notContains":return{compareType:n?"And":"N/A",value1:{valueCompareType:De.default.DoesNotContain,value:t},value2:n?{valueCompareType:De.default.DoesNotContain,value:a}:void 0};case"greaterThan":return{compareType:"N/A",value1:{valueCompareType:De.default.IsGreaterThan,value:t}};case"greaterThanOrEqual":return{compareType:"N/A",value1:{valueCompareType:De.default.IsGreaterThenOrEqualTo,value:t}};case"lessThan":return{compareType:"N/A",value1:{valueCompareType:De.default.IsLessThen,value:t}};case"lessThanOrEqual":return{compareType:"N/A",value1:{valueCompareType:De.default.IsLessThanOrEqualTo,value:t}};case"between":if(!a)throw new o.tF("Limit2 is undefined!","filterTables");return{compareType:"And",value1:{valueCompareType:De.default.IsGreaterThenOrEqualTo,value:t},value2:{valueCompareType:De.default.IsLessThanOrEqualTo,value:a}};case"notBetween":if(!a)throw new o.tF("Limit2 is undefined!","filterTables");return{compareType:"Or",value1:{valueCompareType:De.default.IsLessThen,value:t},value2:{valueCompareType:De.default.IsGreaterThan,value:a}};default:throw new Error(`Operator '${e}' not implemented.`)}}function Ue(e){switch(e){case"Or":return Excel.FilterOperator.or;case"And":return Excel.FilterOperator.and;case"N/A":return}}var qe=a(866);const Ve={allDatesInPeriodJanuary:qe.default.M1,allDatesInPeriodFebruary:qe.default.M2,allDatesInPeriodMarch:qe.default.M3,allDatesInPeriodApril:qe.default.M4,allDatesInPeriodMay:qe.default.M5,allDatesInPeriodJune:qe.default.M6,allDatesInPeriodJuly:qe.default.M7,allDatesInPeriodAugust:qe.default.M8,allDatesInPeriodSeptember:qe.default.M9,allDatesInPeriodOctober:qe.default.M10,allDatesInPeriodNovember:qe.default.M11,allDatesInPeriodDecember:qe.default.M12,allDatesInPeriodQuarter1:qe.default.Q1,allDatesInPeriodQuarter2:qe.default.Q2,allDatesInPeriodQuarter3:qe.default.Q3,allDatesInPeriodQuarter4:qe.default.Q4,aboveAverage:qe.default.AboveAverage,belowAverage:qe.default.BelowAverage,lastMonth:qe.default.LastMonth,lastQuarter:qe.default.LastQuarter,lastWeek:qe.default.LastWeek,lastYear:qe.default.LastYear,nextMonth:qe.default.NextMonth,nextQuarter:qe.default.NextQuarter,nextWeek:qe.default.NextWeek,nextYear:qe.default.NextYear,thisMonth:qe.default.ThisMonth,thisQuarter:qe.default.ThisQuarter,thisWeek:qe.default.ThisWeek,thisYear:qe.default.ThisYear,today:qe.default.Today,tomorrow:qe.default.Tomorrow,yesterday:qe.default.Yesterday,yearToDate:qe.default.YearToDate,unknown:qe.default.Nil};var Ge=a(83197),We=a(61150);var ze=a(10796);async function Qe(e,t,a,n){let r=!1,i=e;const s=await async function(e,t){try{return await Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.tables.getItem(e).columns.getItemAt(t).getDataBodyRange();return n.conditionalFormats.load("items"),await a.sync(),n.conditionalFormats.items.length>0}))}catch(e){throw(0,We.cY)(We.SA.Error,e),new o.tF("Failed to read if there is any conditional formatting applied to a range","hasConditionalFormattingApplied")}}(t,a);if(!s){const o=await(0,ze.B)(t,a,n);try{i=(0,Ge.xq)(o,e),r=!0}catch{}}const c=[{key:l.Dh.EventType,value:l.Mv.GetFilterOrSortColor},{key:l.Dh.ColumnCFRApplied,value:s},{key:l.Dh.SortFilterColorFound,value:r}];return(0,D.j)(c),i}async function Je(e,t,a,n,r,i){let s=!1,c=n;const d=await async function(e,t,a){try{return await Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(e).getRange(t).getColumn(a);return o.conditionalFormats.load("items"),await n.sync(),o.conditionalFormats.items.length>0}))}catch(e){throw(0,We.cY)(We.SA.Error,e),new o.tF("Failed to read if there is any conditional formatting applied to a range","getHasConditionalFormattingApplied")}}(e,t,a);if(!d){let l=await async function(e,t,a,n){const r="font"===n?"#000000":"#FFFFFF";try{return await Excel.run({delayForCellEdit:!0},(async o=>{const i=o.workbook.worksheets.getItem(e).getRange(t).getColumn(a),l={format:{[n]:{color:!0}}},s=i.getCellProperties(l);return await o.sync(),s.value.map((e=>e[0].format?.[n]?.color??r))}))}catch{throw new o.tF(`Failed to read the ${n} colors from table column.`,"getRangeColors")}}(e,t,a,r);try{l=i?l.slice(1):l,c=(0,Ge.xq)(l,n),s=!0}catch{}}const u=[{key:l.Dh.EventType,value:l.Mv.GetFilterOrSortColor},{key:l.Dh.ColumnCFRApplied,value:d},{key:l.Dh.SortFilterColorFound,value:s}];return(0,D.j)(u),c}var je=a(2456);const Ye=(0,b.k6)()&&(0,b.yw)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS");function Xe(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","clearFilters: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0],i=n.name,l=n.sheetRange.sheet,s=d.ExcelCalc.IExcelRangeToAddress(n.sheetRange.range),c=JSON.parse(n.headers),u=[];if(n.tableLikeRange){let t=[],a=[];try{t=Q.getTableColumnNames(n,e),a=U(n,t,e.name)}catch(e){const t=e;if(!t.isConverterError||t.failureType!==o.tJ.NoColumnArgument)throw e;u.push(function({sheetName:e,rangeAddress:t}){const a={entityName:e,entityType:"worksheets",changedDataDisplayName:t};return{method:r.wv.Worksheet.ClearFilter,args:a,func:Me.We}}({sheetName:l,rangeAddress:s}))}return a.map((e=>{const t=Ye?d.ExcelCalc.IExcelRangeToAddress(d.ExcelCalc.columnFromIExcelAddress(n.sheetRange.range,e)):"";u.push(function({sheetName:e,rangeAddress:t,columnAddress:a,columnName:n,columnNumber:o}){const i={entityName:e,entityType:"worksheets",changedDataDisplayName:Ye?a:`column ${n||o+1} of ${t}`,columnIndex:o};return{method:r.wv.Worksheet.ClearColumnFilter,args:i,func:Me.hf}}({sheetName:l,rangeAddress:s,columnAddress:t,columnNumber:e,columnName:c[e]}))})),0===u.length&&(0,o.VD)(e,a.length,[]),[{agent:r.w2.OfficeJS,items:u}]}let m=[];try{m=Q.getTableColumnNames(n,e)}catch(e){const t=e;if(!t.isConverterError||t.failureType!==o.tJ.NoColumnArgument)throw e;u.push(ye(i))}return m.map((e=>u.push(Ce(i,e)))),0===u.length&&(0,o.VD)(e,m.length,[]),[{agent:r.w2.OfficeScripts,items:u}]}const Ke={CellColor:async(e,t,a,n)=>{const o=await Qe((0,O.wM)(n,"color"),e,a,"cell");return(0,b.av)()||(0,b.k6)()?fe(d.EventMethods.Table.CellColorFilterApplied,e,t,o):{method:r.wv.Table.FilterColor,args:{tableName:e,columnName:t,color:o},func:Ne}},FontColor:async(e,t,a,n)=>{const o=await Qe((0,O.wM)(n,"color"),e,a,"font");return(0,b.av)()||(0,b.k6)()?fe(d.EventMethods.Table.FontColorFilterApplied,e,t,o):{method:r.wv.Table.FilterColor,args:{tableName:e,columnName:t,color:await Qe((0,O.wM)(n,"color"),e,a,"font")},func:ke}}};const Ze={Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:(e,t,a)=>{const n=(0,O.mT)(a,"count");return Promise.resolve(be(e,t,!1,je.default.Items,String(n)))},BottomPercent:(e,t,a)=>{const n=(0,O.mT)(a,"count");return Promise.resolve(be(e,t,!1,je.default.Percent,String(n)))},TopItems:(e,t,a)=>{const n=(0,O.mT)(a,"count");return Promise.resolve(be(e,t,!0,je.default.Items,String(n)))},TopPercent:(e,t,a)=>{const n=(0,O.mT)(a,"count");return Promise.resolve(be(e,t,!0,je.default.Percent,String(n)))},Values:(e,t,a)=>{const n=(0,O.W7)(a,"values");return Promise.resolve(function(e,t,a){const n={tableName:e,columnName:t,values:a};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.ValuesFilterApplied,e,n)}(e,t,n))},Custom:async(e,t,a)=>{const n=nt(a,"limit1"),r=nt(a,"limit2")??"",i=(0,O.Am)(a,"operator");$e(n,r);const{compareType:l,value1:s,value2:c}=He(i,String(n),String(r)),u=await async function(e,t){return Excel.run((async a=>{try{let n=a.workbook.tables.getItem(e).columns.getItem(t).getDataBodyRange().load("rowCount");await a.sync();const o=100;n.rowCount>o&&(n=n.getResizedRange(o-n.rowCount,0)),n.load("values"),await a.sync();const r=n.values;let i=0,l=0,s=0;for(let e=0;e<r.length;++e){const t=r[e][0];i+="number"==typeof t?1:0,l+="string"==typeof t&&t.length>0?1:0,s+="boolean"==typeof t?1:0}const c=i+l+s;if(c<=0)return Promise.resolve("none");const d=.9;let u="none";return i/c>=d?u="number":l/c>=d?u="string":s/c>=d&&(u="bool"),Promise.resolve(u)}catch(e){return Promise.reject(new o.tF("Unable to determine if the column is string/numeric/bool","columnName"))}}))}(e,t);return"none"!==u&&function(e,t){switch(e){case"equalTo":case"notEqualTo":break;case"beginsWith":case"notBeginsWith":case"endsWith":case"notEndsWith":case"contains":case"notContains":if("string"!==t)throw new o.tF(`Applying a textual filter ${e} to a column that's not textual.`,"operandType",o.tJ.TextualFilterOnNonTextError);break;case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"between":case"notBetween":if("number"!==t)throw new o.tF(`Applying a numeric filter ${e} to a column that's not numeric.`,"operandType",o.tJ.NumericFilterOnNonNumberError);break;default:throw new Error(`Operator '${e}' not implemented.`)}}(i,u),Promise.resolve(function(e,t,a,n,o){const r={tableName:e,columnName:t,compareType:a,value1:n,value2:o};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.CustomFilterApplied,e,r)}(e,t,l,s,c))},Dynamic:(e,t,a)=>{const n=function(e){if(void 0!==Ve[e])return Ve[e];throw new Error(`Criteria type '${e}' not supported`)}((0,O.Am)(a,"dynamicCriteria"));return Promise.resolve(function(e,t,a){const n={tableName:e,columnName:t,criteriaType:a};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.DynamicFilterApplied,e,n)}(e,t,n))}};function et({filterType:e,sheetName:t,rangeAddress:a,columnAddress:n,columnIndex:o,columnName:i,filterCriteria:l}){const s={sheetName:t,rangeAddress:a,columnIndex:o,entityName:t,entityType:"worksheets",filteredDataDisplayName:Ye?n:`column ${i||o+1} of ${a}`,filterCriteria:{filterOn:e,...l}};return{method:r.wv.Worksheet.Filter[e],args:s,func:Me.$h}}const tt={CellColor:e=>({color:(0,O.wM)(e,"color")}),FontColor:e=>({color:(0,O.wM)(e,"color")}),Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:e=>{const t=(0,O.mT)(e,"count");return{criterion1:String(t)}},BottomPercent:e=>{const t=(0,O.mT)(e,"count");return{criterion1:String(t)}},TopItems:e=>{const t=(0,O.mT)(e,"count");return{criterion1:String(t)}},TopPercent:e=>{const t=(0,O.mT)(e,"count");return{criterion1:String(t)}},Custom:e=>{const t=nt(e,"limit1"),a=nt(e,"limit2")??"",n=(0,O.Am)(e,"operator");$e(t,a);const{compareType:o,value1:r,value2:i}=He(n,String(t),String(a));return{criterion1:Be(r.valueCompareType,r.value),criterion2:i?Be(i.valueCompareType,i.value):void 0,operator:Ue(o)}},Dynamic:e=>{const t=function(e){let t=Excel.DynamicFilterCriteria[e];if(void 0!==t)return t;if((0,b.yw)("OfficeVSO_9483981_DynamicFilterCriteriaTypoWorkaround")&&"allDatesInPeriodFebruary"===e){const e="allDatesInPeriodFebruray";t=Excel.DynamicFilterCriteria[e]}return t}((0,O.Am)(e,"dynamicCriteria"));return{dynamicCriteria:t}},Values:e=>({values:(0,O.W7)(e,"values")})},at={Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:()=>{throw new o.tF("BottomItems Not Implemented","FilterType")},BottomPercent:()=>{throw new o.tF("BottomPercent Not Implemented","FilterType")},TopItems:()=>{throw new o.tF("TopItems Not Implemented","FilterType")},TopPercent:()=>{throw new o.tF("TopPercent Not Implemented","FilterType")},Values:()=>{throw new o.tF("Values Not Implemented","FilterType")},Dynamic:()=>{throw new o.tF("Dynamic Not Implemented","FilterType")},CellColor:()=>{throw new o.tF("CellColor Not Implemented","FilterType")},FontColor:()=>{throw new o.tF("FontColor Not Implemented","FilterType")},Custom:async(e,t,a,n)=>{const o=nt(n,"limit1"),r=nt(n,"limit2")??"",i=(0,O.Am)(n,"operator");$e(o,r);const{compareType:l,value1:s,value2:c}=He(i,String(o),String(r));return Promise.resolve(function(e,t,a,n,o,r){const i={column:t,compareType:n,value1:o,value2:r,range:a};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Worksheet.CustomFilterApplied,e,i)}(e,t,a,l,s,c))}};function nt(e,t){let a;try{const n=(0,O.Q4)(e,t);if("string"===n)a=(0,O.Ru)(e,t);else if("number"===n){const n=(0,O.lI)(e,t);a=n?.toString()}}catch{}return a}var ot=a(52922),rt=a(31764),it=a(58428);async function lt(e){const t=e,a=d.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const n=t.range;e.workbook.worksheets.getItem(n.sheet).getRange(a).load("format").format.adjustIndent(t.indentChange),await e.sync()})),`I adjusted in the indent on ${a} by ${t.indentChange} `}async function st(e){const t=e,a=t.range,n=t.iconStyle,r=d.ExcelCalc.IExcelRangeToAddress(a.range);Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets.getItem(a.sheet).getRange(r).conditionalFormats.add(Excel.ConditionalFormatType.iconSet),i=function(e){switch(e){case Excel.IconSet.threeArrows:case Excel.IconSet.threeArrowsGray:case Excel.IconSet.threeFlags:case Excel.IconSet.threeTrafficLights1:case Excel.IconSet.threeTrafficLights2:case Excel.IconSet.threeSigns:case Excel.IconSet.threeSymbols:case Excel.IconSet.threeSymbols2:case Excel.IconSet.threeStars:case Excel.IconSet.threeTriangles:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=33",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=67",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];case Excel.IconSet.fourArrowsGray:case Excel.IconSet.fourArrows:case Excel.IconSet.fourTrafficLights:case Excel.IconSet.fourRedToBlack:case Excel.IconSet.fourRating:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=25",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=50",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=75",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];case Excel.IconSet.fiveArrowsGray:case Excel.IconSet.fiveArrows:case Excel.IconSet.fiveQuarters:case Excel.IconSet.fiveRating:case Excel.IconSet.fiveBoxes:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=20",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=40",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=60",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=80",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];default:return[]}}(n);if(0===i.length)throw new o.tF("No icon set match to generate criteria","applyIconSetConditionalFormatting");t.iconSet.style=n,t.iconSet.criteria=i,t.iconSet.reverseIconOrder=!1,t.iconSet.showIconOnly=!1,await e.sync()}));return`I created an icon set conditional formatting rule using ${it.IJ[n]} on ${r}.`}async function ct(e){const t=e;await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook.worksheets.getItem(t.sheetName).getRange(t.rangeAddress).sort.apply(t.fields,t.caseMatch,t.hasHeaders,t.orientationString,t.method)}));const a=[],n=[];if(t.fields.forEach((e=>((e,a,n)=>{if((0,b.yw)("OfficeVSO_9173844_AddSortRangeTelemetry")?e.key>=0:e.key){let o=`${t.headers?.[e.key]} column in `;"FontColor"===e.sortOn?o+="font color":"CellColor"===e.sortOn?o+="cell color":e.ascending?o+="ascending":o+="descending",o+=" order",a.push(o),(0,b.yw)("OfficeVSO_9173844_AddSortRangeTelemetry")&&n.push(e.key)}})(e,a,n))),(0,b.yw)("OfficeVSO_9173844_AddSortRangeTelemetry")){const e=[{key:l.Dh.EventType,value:l.Mv.LogSortRangeAddress},{key:l.Dh.SortRangeAddress,value:t.rangeAddress},{key:l.Dh.SortColumnIndex,value:n.join(", ")}];(0,D.j)(e)}return 0===a.length?"I sorted the table":`I sorted the table by ${a.join(", ")}`}async function dt(e,t,a,n){if(n&&p(n,w))throw new o.tF("Clear sort is not supported",e.name,o.tJ.ClearSortUnsupported);if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const i=t.getVariableArgumentValue(e,"tables").values[0];let l=d.ExcelCalc.IExcelRangeToAddress(i.sheetRange.range);const s=i.sheetRange.sheet,c=a.length>0?a[a.length-1]:void 0,m=c&&c.items.length>0?c.items[c.items.length-1]:void 0;let g=!1;if(m)if(m.method===r.wv.Range.Sort){const e=m.args;g=e.rangeAddress===l&&e.sheetName===i.sheetRange.sheet}else if((0,b.av)()&&m.method===d.EventMethods.Table.CustomSorted)g=m.entityId===i.name;else if(m.method===r.wv.Table.Sort){g=m.args.tableName===i.name}const h=(0,O.Ak)(e,"ascending")??(0,rt.VL)("isAscending"),f=(0,O.Ak)(e,"caseMatch")??(0,rt.VL)("caseMatch"),C=(0,O.Jh)(e,"fontColor"),y=(0,O.Jh)(e,"cellColor"),v=Q.getTableColumnNumber(e,i),T={key:v,ascending:h},x=(0,O.Ru)(e,"columnName"),S={columnIndex:v,columnName:x||"",isAscending:h};if(C&&y)throw new o.tF("Cannot sort by both font and cell color for a column!","color");if(C){let e;e=i.tableLikeRange?await Je(s,l,v,C,"font",!0):await Qe(C,i.name,v,"font"),T.color=e,T.sortOn="FontColor",S.sortOnColor={sortOn:ot.SortOn.fontColor,color:e}}else if(y){let e;e=i.tableLikeRange?await Je(s,l,v,y,"fill",!0):await Qe(y,i.name,v,"cell"),T.color=e,T.sortOn="CellColor",S.sortOnColor={sortOn:ot.SortOn.cellColor,color:e}}if(g){if((0,b.av)()&&!i.tableLikeRange){m.parameters.sharedSortConditions.push(S)}else{const e=m.args;if(f!==e.caseMatch)throw new o.tF("Cannot have different caseMatch settings while sorting by multiple columns!","caseMatch");e.fields.push(T)}return[]}{let t;if(i.tableLikeRange){const e=JSON.parse(i.headers);if(!(0,b.yw)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&(0,b.yw)("OfficeVSO_9080495_FixTLRWithHiTL")&&(0,b.k6)()){const a=i.sheetRange.range.topLeft.row,n=i.sheetRange.range.bottomRight.row,o={sheet:s,range:{topLeft:{row:e.length>0&&null!==a?a+1:a,column:i.sheetRange.range.topLeft.column},bottomRight:{row:i.totalRow&&null!==n?n-1:n,column:i.sheetRange.range.bottomRight.column}}},l=i.sheetRange.range.topLeft.column?i.sheetRange.range.topLeft.column+v:v,c=e.length>0&&null!==a?a+1:a,u={hasHeader:!1,caseSensitive:f,ascending:h,activeCell:{sheet:s,range:{topLeft:{row:c,column:l},bottomRight:{row:c,column:l}}},rangeType:d.RangeType.ExcelSheetRange,range:o};t={agent:r.w2.OfficeScripts,items:[d.ExcelEventConverter.makeGenericEvent(d.EventMethods.Range.Sorted,s,u)]}}else l=(0,b.tg)()&&i.totalRow?ae(i.sheetRange.range):l,t={agent:r.w2.OfficeJS,items:[{method:r.wv.Range.Sort,args:{sheetName:s,rangeAddress:l,fields:[T],caseMatch:f,hasHeaders:e.length>0,orientationString:Excel.SortOrientation.rows,headers:e},func:ct}]}}else if((0,b.av)()||(0,b.k6)()){const e={tableName:i.name,isCaseSensitive:f,sharedSortConditions:[S]};t={agent:r.w2.OfficeScripts,items:[d.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.CustomSorted,i.name,e)]}}else t={agent:r.w2.OfficeJS,items:[{method:r.wv.Table.Sort,args:{tableName:i.name,fields:[T],caseMatch:f},func:Oe}]};if(0===t.items.length&&(0,o.VD)(e,1,[]),!(0,b.yw)("NewEntityResolution")){u.g.instance().setIsFirstColumnEntityResolved(i.headers,n)}return[t]}}function ut(e,t){const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","clearingSort: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0],i=n.name,l=[];if(n.tableLikeRange)throw new o.tF("Clear sort is not supported for Table like Ranges",e.name,o.tJ.ClearSortUnsupported);return((0,b.av)()||(0,b.k6)())&&l.push(function(e){return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.Table.SortCleared,e,{})}(i)),0===l.length&&(0,o.VD)(e,1,[]),[{agent:r.w2.OfficeScripts,items:l}]}function mt(e){const t=function(e){const t=function(e){let t;try{const a=(0,O.Q4)(e,"underline");"boolean"===a?t=(0,O.Ak)(e,"underline"):"string"===a&&(t=(0,O.BO)(e,"underline"))}catch{}return t}(e);let a=(0,rt.sR)("defaultCustomFormat").IsTextUnderlined,n=(0,rt.sR)("defaultCustomFormat").IsTextDoubleUnderlined;switch(t){case!0:case"Single":a=!0,n=!1;break;case"Double":a=!1,n=!0;break;case!1:a=!1,n=!1}const o={isTextUnderlined:a,isTextDoubleUnderlined:n};return o}(e),a=function(e){const t=(0,O.Lb)(e,"borderEdges"),a=(0,O.BO)(e,"borderStyle"),n=a?d.BorderLineStyle[a]:(0,rt.sR)("BorderStyle"),o=(0,O.Jh)(e,"borderColor"),r=o?(0,Ge.yc)(o):(0,rt.sR)("defaultCustomFormat").borderColor,i=(0,b.yw)("OfficeVSO_9031700_UseBGRForBorderFormat")?(0,Ge.EQ)(r):r;let l=[d.BorderLineStyle.None,d.BorderLineStyle.None,d.BorderLineStyle.None,d.BorderLineStyle.None],s=[0,0,0,0];for(let e=0;e<t.length;e++){switch(t[e]){case"Top":l[0]=n,s[0]=i;break;case"Bottom":l[1]=n,s[1]=i;break;case"Left":l[2]=n,s[2]=i;break;case"Right":l[3]=n,s[3]=i;break;case"Horizontal":l[0]=n,s[0]=i,l[1]=n,s[1]=i;break;case"Vertical":l[2]=n,s[2]=i,l[3]=n,s[3]=i;break;case"Inside":case"Outside":case"All":s=[i,i,i,i],l=[n,n,n,n]}}const c={Position:(0,rt.sR)("defaultCustomFormat").BorderFormat.Position,LineStyle:l,Color:s,ThemeBorderColor:(0,rt.sR)("defaultCustomFormat").BorderFormat.ThemeBorderColor,ColorTypeOption:(0,rt.sR)("defaultCustomFormat").BorderFormat.ColorTypeOption,Thickness:(0,rt.sR)("defaultCustomFormat").BorderFormat.Thickness};return c}(e),n=(0,O.Jh)(e,"fillColor"),o=(0,O.Jh)(e,"fontColor"),r=(0,O.Ak)(e,"bold"),i=(0,O.Ak)(e,"italic"),l=(0,O.Ak)(e,"strikethrough"),s=t.isTextUnderlined,c=t.isTextDoubleUnderlined,u={BackgroundColor:n??null,TextColor:o??(0,rt.sR)("defaultCustomFormat").TextColor,IsTextBold:r??(0,rt.sR)("defaultCustomFormat").IsTextBold,IsTextItalic:i??(0,rt.sR)("defaultCustomFormat").IsTextItalic,IsTextStrikethrough:l??(0,rt.sR)("defaultCustomFormat").IsTextStrikethrough,IsTextUnderlined:s,IsTextDoubleUnderlined:c,BorderFormat:a,PreserveBackgroundColor:(0,rt.sR)("defaultCustomFormat").PreserveBackgroundColor,PreserveTextColor:(0,rt.sR)("defaultCustomFormat").PreserveTextColor};let m=!0;const g=a.LineStyle,h=a.Color;for(let e=0;e<g.length;e++)g[e]===d.BorderLineStyle.None&&0===h[e]||(m=!1);return void 0!==n||void 0!==o||r||i||l||s||c||!m||(u.BackgroundColor=(0,rt.sR)("defaultBackgroundColor")),u}function gt(e,t){let a;try{const n=(0,O.Q4)(e,t);"string"===n?a=(0,O.Ru)(e,t):"number"===n&&(a=(0,O.lI)(e,t))}catch{}return a}function ht(e){return"number"==typeof e?[`=${e}`,it.c$.Number]:p(e,C)?[`=DATEVALUE("${e}")`,it.c$.Date]:p(e,y)?[`=${e}`,it.c$.Number]:[`="${e}"`,it.c$.Text]}function pt(e){const t=(0,O.BO)(e,"icon");if(void 0===t)throw new o.tF("Icon style is undefined!");const a=it.Yl[t];if(!a)throw new o.tF(`Could not find matching ConditionalFormattingCommand for icon style: ${t}!`);return a}function bt(e){return{unique:e,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")}}function ft(e){const t=it.FN[e];if(!t)throw new o.tF(`Cannot find ConditionalFormattingTimePeriodType for preset criterion: ${e}`);return{timePeriodType:t,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")}}function Ct(e){const t=it.t0[e];if(!t)throw new o.tF(`Cannot find ConditionalFormattingCommand for preset criterion: ${e}`);return{criterion:t,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")}}async function yt(e,t,a){let n=(0,O.BO)(e,"conditionalFormatType");if(!n&&(0,O.BO)(e,"formulaString")&&(n="Formula"),!(0,b.yw)("OfficeVSO_9369541_CFFormulaSupport")&&"Formula"===n)throw new o.tF("Conditional Formatting Formula type disabled",e.name);const i=(0,O.Ak)(e,"clearConditionalFormat")??!1,s=[];let c=[],u=[];!function(e,t){return!Tt[e]&&!xt[e]&&!t}(n,i)?i?c=t.map((e=>Te(e))):(Object.keys(Tt).includes(n)&&(c=j(await Promise.all(t.map((async t=>{const o=Tt[n](t,e,a),r=await async function(e){const t=await async function(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=d.ExcelCalc.IExcelRangeToAddress(d.ExcelCalc.getIGeneralRangeOperationRange(e).range),o=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet,r=a.workbook.worksheets.getItem(o).getRange(n).load("conditionalFormats");await a.sync();const i=r.conditionalFormats;return t?i.items.filter((e=>e.type===t)).map((e=>e.priority)):i.items.map((e=>e.priority))}))}(e);let a=0;t&&0!==t.length&&(a=t[t.length-1]+1);return function(e,t){const a=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet,n={oldIndex:t,newIndex:0,isCurrentFilterWorksheet:!1,filterRange:[e]};return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.ConditionalFormatting.PriorityEdited,a,n)}(e,a)}(t);return[o,r]}))))),!(0,b.av)()&&(0,b.k6)()||!Object.keys(xt).includes(n)||(u=j(t.map((t=>xt[n](t,e,a)))))):(s.push(n),function(e){const t=[{key:l.Dh.EventType,value:l.Mv.LogUnsupportConditionalFormatType},{key:l.Dh.UnsupportedConditionalFormatType,value:e}];(0,D.j)(t)}(n));const m=[];if(c.length>0){const e={agent:r.w2.OfficeScripts,items:c};m.push(e)}if(u.length>0){const e={agent:r.w2.OfficeJS,items:u};m.push(e)}!function(e,t,a,n,r){const i=e.every((e=>0===e.items.length));i&&(0,o.VD)(t,a.length,n?[]:r)}(m,e,t,!1,s);const g=[{key:l.Dh.EventType,value:l.Mv.ConditionalFormatEvent},{key:l.Dh.CFRuleType,value:n}];return(0,D.j)(g),m}function vt(e,t,a){let n;if(t){const t=e.map((e=>Te(e)));n={agent:r.w2.OfficeScripts,items:t},0===t.length&&(0,o.VD)(a,e.length,[])}else n={agent:r.w2.UnsupportedEvent,items:[r.DH.Formatting]};return[n]}const Tt={CellValue:(e,t,a)=>{const n=function(e){const t=gt(e,"cellValue1"),a=gt(e,"cellValue2"),n=void 0===t?gt(e,"limit1"):t,r=void 0===a?gt(e,"limit2"):a,i=(0,O.BO)(e,"cellValueOperator");if(void 0===n)throw new o.tF("Limit 1 is undefined!");if(void 0===i)throw new o.tF("Cell value operator is undefined!");const l=it.RR[i];if(!l)throw new o.tF(`Cannot find matching ConditionalFormatCommand for operator: ${i}!`);if(p(String(n),f))throw new o.tF("Invalid characters for cell value conditional formatting in limit1","limit1");if(void 0!==r&&p(String(r),f))throw new o.tF("Invalid characters for cell value conditional formatting in limit2","limit2");const s=ht(n),c=s[0],d=void 0!==r?ht(r):void 0;return{cellValueRule:{formula1:c,formula2:d?d[0]:void 0,operator:l,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")},formulaCategory:s[1]}}(t).cellValueRule,r=mt(t);return ve(d.EventMethods.ConditionalFormatting.CellValueCreated,e,n,a,r)},ContainsText:(e,t,a)=>{const n=function(e){const t=(0,O.BO)(e,"textOperator"),a=(0,O.Ru)(e,"text");if(void 0===t)throw new o.tF("composeTextComparisonRule: operator is undefined!");if(void 0===a)throw new o.tF("composeTextComparisonRule: text is undefined!");const n=it.$J[t];if(!n)throw new o.tF(`Cannot find matching ConditionalFormatCommand for text operator: ${t}!`);if(p(a,f))throw new o.tF("Invalid characters for text comparison conditional formatting!",e.name);return{operator:n,text:a,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")}}(t),r=mt(t);return ve(d.EventMethods.ConditionalFormatting.TextComparisonCreated,e,n,a,r)},Preset:(e,t,a)=>{const n=function(e){const t=(0,O.BO)(e,"presetCriterion");if(!t)throw new o.tF("No presetCriterion on statement!");let a,n={};switch(t){case"uniqueValues":n={method:d.EventMethods.ConditionalFormatting.UniqueCreated,rule:bt(!0)},a=it.fP.UniqueDuplicate;break;case"duplicateValues":n={method:d.EventMethods.ConditionalFormatting.UniqueCreated,rule:bt(!1)},a=it.fP.UniqueDuplicate;break;case"lastMonth":case"lastSevenDays":case"lastWeek":case"nextMonth":case"nextWeek":case"thisMonth":case"thisWeek":case"today":case"tomorrow":n={method:d.EventMethods.ConditionalFormatting.DatesCreated,rule:ft(t)},a=it.fP.TimePeriod;break;case"aboveAverage":case"belowAverage":case"equalOrAboveAverage":case"equalOrBelowAverage":n={method:d.EventMethods.ConditionalFormatting.PresetCreated,rule:Ct(t)},a=it.fP.OtherPresetsNumber;break;case"blanks":case"nonBlanks":case"errors":case"nonErrors":case"invalid":n={method:d.EventMethods.ConditionalFormatting.PresetCreated,rule:Ct(t)},a=it.fP.OtherPresetsGeneral;break;default:throw new o.tF(`Cannot find matching rule composer for criteria: ${t}!`)}return[n,a]}(t),r=mt(t),i=n[0];return ve(i.method,e,i.rule,a,r)},TopBottom:(e,t,a)=>{const n=function(e){const t=(0,O.BO)(e,"topBottomType")??(0,rt.sR)("topBottomType"),a=(0,O.lI)(e,"topBottomRank")??(0,rt.sR)("topBottomRank"),n=it.ZA[t];if(!n)throw new o.tF(`Cannot find matching ConditionalFormatCommand for top/bottom type: ${t}!`);return{rank:a,type:n,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")}}(t),r=mt(t);return ve(d.EventMethods.ConditionalFormatting.TopBottomCreated,e,n,a,r)},ColorScale:(e,t,a)=>{const n=function(e){const t=(0,O.Jh)(e,"minimumColor"),a=(0,O.Jh)(e,"midpointColor"),n=(0,O.Jh)(e,"maximumColor");if((0,b.yw)("DefaultColorScales"))return{minimumColor:t?(0,rt.L7)(t):(0,rt.sR)("minimumColor"),midpointColor:a?(0,rt.L7)(a):(0,rt.sR)("midpointColor"),maximumColor:n?(0,rt.L7)(n):(0,rt.sR)("maximumColor"),maximumCFObjectValues:(0,rt.sR)("maximumCFObjectValues"),midpointCFObjectValues:a?(0,rt.sR)("midpointCFObjectValues"):null,minimumCFObjectValues:(0,rt.sR)("minimumCFObjectValues")};return{minimumColor:t??(0,rt.sR)("minimumColorDeprecated"),midpointColor:a??(0,rt.sR)("midpointColor"),maximumColor:n??(0,rt.sR)("maximumColorDeprecated"),maximumCFObjectValues:(0,rt.sR)("maximumCFObjectValues"),midpointCFObjectValues:a?(0,rt.sR)("midpointCFObjectValuesDeprecated"):null,minimumCFObjectValues:(0,rt.sR)("minimumCFObjectValues")}}(t);return function(e,t,a){const n={range:e.range,columnName:a,rangeType:e.rangeType,colorScaleFormat:t},o=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,o,n)}(e,n,a)},DataBar:(e,t,a)=>{const n=function(e){const t=(0,O.Jh)(e,"dataBarColor");return{isGradientFill:(0,O.Ak)(e,"dataBarGradient")??(0,rt.sR)("isGradientFill"),borderColor:(0,rt.sR)("borderColor"),fillColor:t??(0,rt.sR)("fillColor"),isLTRDirection:(0,rt.sR)("isLTRDirection"),isNegativeValuesFillColorCustom:(0,rt.sR)("isNegativeValuesFillColorCustom"),negativeValuesFillColor:t??(0,rt.sR)("negativeValuesFillColor"),isNegativeValuesBorderColorCustom:(0,rt.sR)("isNegativeValuesBorderColorCustom"),negativeValuesBorderColor:(0,rt.sR)("negativeValuesBorderColor"),isShowValueEnabled:(0,rt.sR)("isShowValueEnabled"),axisColor:(0,rt.sR)("axisColor"),axisPositionType:(0,rt.sR)("axisPositionType"),minBoundCFObjectValues:(0,rt.sR)("minBoundCFObjectValues"),maxBoundCFObjectValues:(0,rt.sR)("maxBoundCFObjectValues")}}(t);return function(e,t,a){const n={range:e.range,columnName:a,rangeType:e.rangeType,dataBarFormat:t},o=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.ConditionalFormatting.DataBarCustomCreated,o,n)}(e,n,a)},IconSet:(e,t,a)=>{const n=function(e){const t=(0,O.BO)(e,"icon");if(void 0===t)throw new o.tF("Icon style is undefined!");const a=it.nr[t];if(!a)throw new o.tF(`Could not find matching ConditionalFormattingCommand for icon style: ${t}!`);return a}(t);return function(e,t){const a={range:e.range,rangeType:e.rangeType,style:t},n=d.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ne.ExcelEventConverter.makeGenericEvent(d.EventMethods.ConditionalFormatting.IconSetCreated,n,a)}(e,n)},Formula:(e,t,a)=>{const n=function(e){const t=(0,O.BO)(e,"formulaString"),a=(0,O.BO)(e,"formulaExplanation");if(!t||""===t)throw new o.tF("Cannot compose custom rule with undefined or empty formula",e.name,o.tJ.ConditionalFormatFormulaInvalid);if((0,b._N)()&&(!a||""===a))throw new o.tF("Cannot compose custom rule with formula explanation",e.name,o.tJ.ConditionalFormatFormulaExplanationInvalid);return{formula:t,localFormula:(0,b.yw)("OfficeVSO_9407957_conditonalFormattingEnableFormulaLocal"),formulaExplanation:a,shouldGenerateGetRule:(0,rt.sR)("shouldGenerateGetRule")}}(t),r=mt(t);return ve(d.EventMethods.ConditionalFormatting.CustomCreated,e,n,a,r)}},xt={IconSet:(e,t,a)=>({method:r.wv.ConditionalFormatting.ApplyIconSetConditionalFormatting,args:{range:d.ExcelCalc.getIGeneralRangeOperationRange(e),iconStyle:pt(t)},func:st})};async function St(e,t,a){if(void 0===e.arguments.tables)throw new o.tF("No table specified.","tables");const n={func:"conditionalFormatSuggestion",args:[t.getVariableArgumentValue(e,"tables").values[0].name,a]};return[{agent:r.w2.ConditionalFormatSuggestion,items:[n]}]}var wt=a(71507),Et=a(48825);function Rt(e,t){return e.map((e=>e.map((e=>""===e?t:e))))}function It(e,t){const a=e.range.topLeft,n=e.range.bottomRight;if(null===a.column||null===n.column)return null;if((t=t>=0?t:n.column-a.column+t+1)<0||a.column+t>n.column)return null;return{rangeType:d.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:a.row,column:a.column+t},bottomRight:{row:n.row,column:a.column+t}}}}}async function At(e){return Excel.run({delayForCellEdit:!0},(async t=>{const a=d.ExcelCalc.IExcelRangeToAddress(e.range),n=t.workbook.worksheets.getItem(e.sheet).getRange(a);return n.load("values"),await t.sync(),n.values}))}function Lt(e,t){const a=e.range.topLeft,n=e.range.bottomRight;if(null===a.row||null===n.row)return null;if((t=t>=0?t:n.row-a.row+t+1)<0||a.row+t>n.row)return null;return{rangeType:d.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:a.row+t,column:a.column},bottomRight:{row:a.row+t,column:n.column}}}}}async function Ft(e,t){const a=function(e){try{const t=(0,O.Q4)(e,"searchString");if("string"===t)return(0,O.C3)(e,"searchString");if("number"===t){return(0,O.mT)(e,"searchString").toString()}throw new o.Dd(`Argument "searchString" type ${t} should be string or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"string | number")}catch(e){if(e.isStatementArgumentError&&e.reason===o.vb.ArgumentUndefined)return;throw e}}(e)??"",n=function(e){let t;if((0,b.yw)("OfficeVSO_9187797_MakeParamReplaceWithOptional")){if(t=(0,O.dQ)(e,"replaceWith"),void 0===t)return""}else t=(0,O.Q4)(e,"replaceWith");if("string"===t)return(0,O.C3)(e,"replaceWith");if("number"===t){return(0,O.mT)(e,"replaceWith").toString()}throw new o.Dd(`Argument "replaceWith" type ${t} should be string or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"string | number")}(e),i=(0,O.Ak)(e,"completeMatch")??!1,l=(0,O.Ak)(e,"matchCase")??!1,s={agent:r.w2.OfficeScripts,items:[]};for(const e of t)try{if((0,b.yw)("OfficeVSO_9033826_SearchReplaceEmptyCellStrings")||(0,b.av)()||""!==a)s.items.push(he(a,n,i,l,e));else{const t=Rt(await At(d.ExcelCalc.getIGeneralRangeOperationRange(e)),n);s.items.push(re(t,d.ExcelCalc.getIGeneralRangeOperationRange(e)))}}catch{(0,D.R)(new o.tF("Failed to compose replace all event for range.","replaceRangesCommon"))}return 0===s.items.length&&(0,o.VD)(e,t.length,[]),[s]}function _t(e,t){let a=0;const n=e[t];for(let o=0;o<t;o++)e[o]===n&&a++;return a}var Nt=a(8505);async function kt(e){const t=e,a=d.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const n=t.range;e.workbook.worksheets.getItem(n.sheet).getRange(a).load("format/useStandardHeight").format.useStandardHeight=!0,await e.sync()})),`I removed the autofit on rows(s) in ${a}.`}async function Ot(e){const t=e,a=d.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const n=t.range;e.workbook.worksheets.getItem(n.sheet).getRange(a).load("format/useStandardWidth").format.useStandardWidth=!0,await e.sync()})),`I removed the autofit on column(s) in ${a}.`}async function Pt(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.worksheets.getItem(t.sheet).getRange(d.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format/font");await a.sync();const r=n.format.font.size,i=function(e,t){const a=(0,O.Q4)(e,t);if("string"===a)return(0,O.Am)(e,t);if("number"===a)return(0,O.mT)(e,t);throw new o.Dd(`Argument ${t} type ${a} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,a,"enum | number")}(e,"size");return function(e,t){return"Increase"===t?e+(0,rt.Si)("fontSizeChange"):"Decrease"===t?e-(0,rt.Si)("fontSizeChange"):t}(r,i)}))}const Mt={true:"single",false:"none",None:"none",Single:"single",Double:"double",SingleAccountant:"singleAccountant",DoubleAccountant:"doubleAccountant"};var Dt=a(98453),$t=a(5409),Bt=a(65607),Ht=a(54947);async function Ut(e,t,a){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","formatTables: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0];let l;l=Y(i.sheetRange);const s=i.tableLikeRange?Nt.lp.TableLikeRange:Nt.lp.StandardTable;if(((0,b.av)()||(0,b.yw)("OfficeVSO_9404079_FixFormattingIntentStringTableWithTotalRow"))&&(0,m.En)(i)&&(l={rangeType:wt.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Body,tableName:i.name,gridRange:l.range}}),!i?.headers)throw new o.tF("Invalid table data");const c=JSON.parse(i.headers);if(!Array.isArray(c)||0===c.length)throw new o.tF("Invalid table headers");const{topLeft:u,bottomRight:g}=d.ExcelCalc.getIGeneralRangeOperationRange(l).range,{column:h,row:p}=u,{column:f,row:C}=g,y=i.numColumns,v=i.numRows;let T="";if(null===h||null===f||null===p||null===C)throw null!==h&&(T+=c[h]),new o.tF("Range having incomplete row and/or column data.");if(y===f-h+1&&v===C-p+1)T=(0,b.yw)("OfficeVSO_9125590_bugFixTLRWholeTableLabel")&&(0,b.k6)()&&i.tableLikeRange?"":Ht.G.O;else{const e=[];for(let t=h;t<=f;t++)e.push(`'${c[t]}'`);T+=e.join(", ")}const x=await Qt(e,[l],!1,T);return x.push(...function(e,t,a,n){const o=[];if((0,b.av)()||(0,b.k6)()){if(a===Nt.lp.TableLikeRange&&void 0!==(0,O.Ak)(e,"totalRow")){const t={agent:r.w2.UnsupportedEvent,items:[r.DH.Formatting]};o.push(t),(0,b.yw)("OfficeVSO_9187681_deleteArgument")?delete e.arguments.totalRow:e.arguments.totalRow=void 0}const i=Object.keys(zt).filter((t=>void 0!==e.arguments[t])).map((a=>zt[a](t,e,n))),l={agent:r.w2.OfficeScripts,items:j(i)};l.items.length>0&&o.push(l)}else{const a=Object.keys(Wt).filter((t=>void 0!==e.arguments[t])).map((a=>(0,Wt[a])(t,e,a,n))),i={agent:r.w2.OfficeJS,items:a};i.items.length>0&&o.push(i)}return o}(e,i.name,s,a)),Jt(x,e,[l]),x}async function qt(e,t){const a=function(e,t){if(void 0===e.arguments.columns)throw new o.tF("No columns specified.",e.name);const a=t.getVariableArgumentValue(e,"columns");if("Column"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getFullResolvedColumnRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return{columnRanges:a.values.ranges,fullColumnRanges:a.values.fullRanges}}(e,t),n=a.columnRanges,r=a.fullColumnRanges,i=function(e,t){try{return te(e,t)}catch{return}}(e,t),l=await Qt(e,n,!0,i,r);return Jt(l,e,n),l}const Vt={autofit:(e,t,a)=>{void 0!==t&&(t="autofit_defaultValue");return(0,O.zI)(a,"autofit")?function(e,t){switch(t.name){case"formatColumns":return[me(d.EventMethods.Range.ColumnsAutoFit,e)];case"formatRows":return[me(d.EventMethods.Range.RowsAutoFit,e)];default:{const t=[];return t.push(me(d.EventMethods.Range.ColumnsAutoFit,e)),t.push(me(d.EventMethods.Range.RowsAutoFit,e)),t}}}(e,a):(0,b.av)()||(0,b.k6)()?function(e,t){switch(t.name){case"formatColumns":return[ge(d.EventMethods.Range.UseStandardWidth,e)];case"formatRows":return[ge(d.EventMethods.Range.UseStandardHeight,e)];default:{const t=[];return t.push(ge(d.EventMethods.Range.UseStandardWidth,e)),t.push(ge(d.EventMethods.Range.UseStandardHeight,e)),t}}}(e,a):[]},bold:(e,t,a)=>{const n=(0,O.zI)(a,"bold");return le(d.EventMethods.Font.Bolded,n,e,t)},borderEdges:(e,t,a)=>{const n=(0,O.Lb)(a,"borderEdges"),o=[];if(0!==n.length){const r=function(e,t,a){const n=[],o=t||(0,rt.Si)("borderColor"),r=(0,Ge.EQ)((0,Ge.yc)(o));let i=d.BorderLineStyle[a];void 0===i&&(i=(0,rt.Si)("borderStyle"));for(const t of e){const e={border:d.BorderTypes[t],color:r,lineStyle:i};n.push(e)}return n}(n,(0,O.Jh)(a,"borderColor"),(0,O.BO)(a,"borderStyle"));r.map((a=>o.push(le(d.EventMethods.Border.BorderChanged,a,e,t))))}return o},cellStyle:(e,t,a)=>{const n=(0,O.Am)(a,"cellStyle");return le(d.EventMethods.Range.CellStyleApplied,n,e,t)},columnWidth:async(e,t,a)=>{const n=await(0,Dt.CE)(a,d.ExcelCalc.getIGeneralRangeOperationRange(e));return le(d.EventMethods.CellDimensions.ColumnWidthSet,n,e,t)},orientation:(e,t,a)=>{const n=(0,O.mT)(a,"orientation");return le(d.EventMethods.CellText.OrientationChanged,n,e,t)},fillColor:(e,t,a)=>{const n=(0,O.wM)(a,"fillColor");return le("None"===n?d.EventMethods.Fill.ColorCleared:d.EventMethods.Fill.Colored,n,e,t)},fontColor:(e,t,a)=>{const n=(0,O.wM)(a,"fontColor");return le(d.EventMethods.Font.Colored,"None"===n?(0,rt.Si)("fontColor"):n,e,t)},fontName:(e,t,a)=>{const n=(0,O.Am)(a,"fontName");return le(d.EventMethods.Font.Named,n,e,t)},size:async(e,t,a)=>{const n=await Pt(a,d.ExcelCalc.getIGeneralRangeOperationRange(e));return le(d.EventMethods.Font.Sized,n,e,t)},hide:(e,t,a)=>{const n=(0,O.zI)(a,"hide");if("formatColumns"===a.name)return le(d.EventMethods.CellDimensions.ColumnsHidden,n,e,t);if("formatRows"===a.name)return le(d.EventMethods.CellDimensions.RowsHidden,n,e,t);{const a=[];return a.push(le(d.EventMethods.CellDimensions.ColumnsHidden,n,e,t)),a.push(le(d.EventMethods.CellDimensions.RowsHidden,n,e,t)),a}},horizontalAlignment:(e,t,a)=>{const n=(0,O.Am)(a,"horizontalAlignment");return le(d.EventMethods.Alignment.HorizontalAlignmentSet,$t.default[n],e,t)},indentChange:(e,t,a)=>{const n=(0,O.mT)(a,"indentChange");return le(d.EventMethods.Indent.Incremented,n,e,t)},italic:(e,t,a)=>{const n=(0,O.zI)(a,"italic");return le(d.EventMethods.Font.Italicized,n,e,t)},numberFormat:(e,t,a)=>{const n=(0,O.C3)(a,"numberFormat"),o=(0,O.lI)(a,"decimalPlaces");return[le(d.EventMethods.Range.NumberFormatChanged,(0,b.yw)("OfficeVSO_9374683_RemoveDecimalPlacesHandling")?n:(0,Et.j)(n,o),e,t),me(d.EventMethods.Range.ColumnsAutoFit,e)]},rowHeight:async(e,t,a)=>{const n=await(0,Dt.fL)(a,d.ExcelCalc.getIGeneralRangeOperationRange(e));return le(d.EventMethods.CellDimensions.RowHeightSet,n,e,t)},strikethrough:(e,t,a)=>{const n=(0,O.zI)(a,"strikethrough");return le(d.EventMethods.Font.StrikeThrough,n,e,t)},underline:(e,t,a)=>{const n=function(e){const t=(0,O.Q4)(e,"underline");if("string"===t)return(0,O.Am)(e,"underline");if("boolean"===t)return(0,O.zI)(e,"underline");throw new o.Dd(`Argument "underline" type ${t} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"enum | boolean")}(a);return le(d.EventMethods.Font.UnderlineStyle,Mt[n],e,t)},verticalAlignment:(e,t,a)=>{const n=(0,O.Am)(a,"verticalAlignment");return le(d.EventMethods.Alignment.VerticalAlignmentSet,Bt.default[n],e,t)},wrapText:(e,t,a)=>{const n=(0,O.zI)(a,"wrapText");return le(d.EventMethods.CellText.WrapChanged,n,e,t)}},Gt={autofit:(e,t,a)=>(0,O.zI)(e,t)?[]:function(e,t){const a={method:r.wv.Format.RemoveAutofitColumns,args:{range:e},func:Ot},n={method:r.wv.Format.RemoveAutofitRows,args:{range:e},func:kt};switch(t.name){case"formatColumns":return[a];case"formatRows":return[n];default:return[a,n]}}(a,e),indentChange:(e,t,a)=>({method:r.wv.Format.IndentChange,args:{range:a,indentChange:(0,O.mT)(e,t)},func:lt})},Wt={totalRow:(e,t,a,n)=>({method:r.wv.Table.TotalRow,args:{tableName:e,value:(0,O.zI)(t,a)},func:Ae}),headerRow:(e,t,a,n)=>({method:r.wv.Table.HeaderRow,args:{tableName:e,value:(0,O.zI)(t,a)},func:Ie}),bandedRows:(e,t,a,n)=>{if(!(0,b.yw)("OfficeVSO_9279636_RemoveBandedRowRegex")&&n&&p(n,v))throw new o.tF("Detected unsupported banded rows query!",t.name);return{method:r.wv.Table.BandedRows,args:{tableName:e,value:(0,O.zI)(t,a)},func:Le}},bandedColumns:(e,t,a,n)=>({method:r.wv.Table.BandedColumns,args:{tableName:e,value:(0,O.zI)(t,a)},func:Fe}),filterButton:(e,t,a,n)=>({method:r.wv.Table.FilterButton,args:{tableName:e,value:(0,O.zI)(t,a)},func:_e}),tableStyle:(e,t,a,n)=>({method:r.wv.Table.ApplyStyle,args:{tableName:e,tableStyle:(0,O.C3)(t,a)},func:Pe})},zt={totalRow:(e,t,a)=>{const n=(0,O.zI)(t,"totalRow");return se(d.EventMethods.Table.TotalRowToggled,n,e)},headerRow:(e,t,a)=>{const n=(0,O.zI)(t,"headerRow");return se(d.EventMethods.Table.HeaderRowToggled,n,e)},bandedRows:(e,t,a)=>{if(a&&p(a,v))throw new o.tF("Detected unsupported banded rows query!",t.name);const n=(0,O.zI)(t,"bandedRows");return se(d.EventMethods.Table.BandedRowsVisibilityChanged,n,e)},bandedColumns:(e,t,a)=>{const n=(0,O.zI)(t,"bandedColumns");return se(d.EventMethods.Table.BandedColumnsVisibilityChanged,n,e)},filterButton:(e,t,a)=>{const n=(0,O.zI)(t,"filterButton");return se(d.EventMethods.Table.FilterButtonVisibilityChanged,n,e)},tableStyle:(e,t,a)=>{let n=(0,O.C3)(t,"tableStyle");return"None"===n&&(n=null),se(d.EventMethods.Table.StyleApplied,n,e)}};async function Qt(e,t,a,n,o){const i=[];if(!(0,b.yw)("OfficeVSO_9231902_UnblockNumberFormatEvent")&&!a){const t=function(e){const t=(0,O.BO)(e,"numberFormat"),a=[];void 0!==t&&a.push(r.DH.Formatting);const n={agent:r.w2.UnsupportedEvent,items:a};(0,b.yw)("OfficeVSO_9187681_deleteArgument")?delete e.arguments.numberFormat:e.arguments.numberFormat=void 0;return n}(e);t.items.length>0&&i.push(t)}void 0===n&&(n="");const s=await async function(e,t,a,n,o){const i=await Promise.all(e.map((async(e,r)=>{const i=Object.keys(Vt).filter((e=>!(!(0,b.av)()&&!(0,b.k6)()&&"indentChange"===e)&&void 0!==a.arguments[e]));return function(e){const t=[{key:l.Dh.EventType,value:l.Mv.LogStatmentInformation},{key:l.Dh.FormattingTypes,value:e.toString()}];(0,D.j)(t)}(i),await Promise.all(i.map((i=>{let l=e;n&&"autofit"===i&&o&&(l=o[r]);const s=!(0,b.yw)("OfficeVSO_9277386_FixEmptyColumnName")||""!==t,c=(0,b.k6)()&&s?function(e,t){let a=e.split(",")[t].trim();"'"===a[0]&&(a=a.slice(1));"'"===a[a.length-1]&&(a=a.slice(0,a.length-1));return a}(t,r):t;return Vt[i](l,c,a)})))}))),s={agent:r.w2.OfficeScripts,items:j(i)};return s}(t,n,e,a,o);if(s.items.length>0&&i.push(s),!(0,b.av)()&&!(0,b.k6)()){const a=await async function(e,t){const a=await Promise.all(e.map((async e=>j(Object.keys(Gt).filter((e=>void 0!==t.arguments[e])).map((a=>(0,Gt[a])(t,a,e))))))),n={agent:r.w2.OfficeJS,items:j(a)};return n}(t.map((e=>d.ExcelCalc.getIGeneralRangeOperationRange(e))),e);a.items.length>0&&i.push(a)}return i}function Jt(e,t,a){e.every((e=>0===e.items.length))&&(0,o.VD)(t,a.length,[],a.length>0)}async function jt(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values[0],n=(0,O.Ru)(e,"instruction"),i=[a.name];void 0!==n&&i.push(n);const l={func:(0,b.yw)("OfficeVSO_9110458_integrateCalculatedRowIntent")?e.name:"addCalculatedColumns",args:i};return[{agent:r.w2.FormulaGeneration,items:[l]}]}var Yt=a(98100);class Xt{async convert(e,t){const a=(new Date).getTime(),n=(0,b.yw)("OfficeVSO_9408716_BlockInsertDeleteScenarios");let o=!1,r=!1,i=!1,l=!1,s=!1,c=!1;for(let t=0;t<e.length;t++){const a=e[t];o=o||this.variableCache.isDeleteColumnsStatement(a),r=r||this.variableCache.isInsertColumnsStatement(a),n&&(i=i||this.variableCache.isDeleteRowsStatement(a),l=l||this.variableCache.isInsertRowsStatement(a),s=s||this.variableCache.isSelectColumnsStatement(a)&&(o||r),c=c||this.variableCache.isSelectRowsStatement(a)&&(i||l))}if(n?(o&&r||i&&l||s||c)&&this.logUnsupportedTableStructureChangesStatementsAndThrow(e):o&&r&&this.logUnsupportedStatementsAndThrow(e),(0,b.yw)("OfficeVSO_9261913_bugFixSelectRowsToSelectTables")&&(e=this.checkSelectRowsShouldBeSelectTables(e)),(0,b.yw)("OfficeVSO_9435729_bugFixSelectColumnWithSelectionScope")){this.insertOfSelectTablesIfNeeded(e);for(let a=0;a<e.length;a++){const n=e[a];this.variableCache.isSelectStatement(n)?await this.processSelectStatement(n,e,t):await this.handleNonSelectStatement(n,e,t)}return this.logConverterSucceeded(e,a),this.executableItems}for(let a=0;a<e.length;a++){let n=!1;const o=e[a];if(this.variableCache.isSelectStatement(o)){const r=(new Date).getTime();n=!0;try{const n=(0,b.av)()&&this.variableCache.isRowColumnSelectStatementWithSelectionScope(o);if(await this.variableCache.cacheVariable(o,t),n){const t=m.CP.getActiveTable().name;e.splice(a,0,{name:"selectTables",returns:"tables",arguments:{tableNames:{type:"stringList",stringList:[t]}}}),a++}}catch(t){this.logVariableCacheFailureAndRethrow(t,e,o,r)}}else{const a=(new Date).getTime(),r=this.eventConverterMap[o.name];if(r){n=!0;try{this.executableItems=this.executableItems.concat(await r(o,t))}catch(t){this.logConverterFailureAndRethrow(t,e,o,a)}}}n||this.logUnsupportedStatement(o)}return this.logConverterSucceeded(e,a),this.executableItems}insertOfSelectTablesIfNeeded(e){for(let t=0;t<e.length;t++)if(this.variableCache.isRowColumnSelectStatementWithSelectionScope(e[t])){const a=m.CP.getActiveTable().name;e.splice(t,0,{name:"selectTables",returns:"tables",arguments:{tableNames:{type:"stringList",stringList:[a]}}}),t++}}async processSelectStatement(e,t,a){const n=(new Date).getTime();try{await this.variableCache.cacheVariable(e,a)}catch(a){this.logVariableCacheFailureAndRethrow(a,t,e,n)}}async handleNonSelectStatement(e,t,a){let n=!1;if(!this.variableCache.isSelectStatement(e)){const o=(new Date).getTime(),r=this.eventConverterMap[e.name];if(r){n=!0;try{this.executableItems=this.executableItems.concat(await r(e,a))}catch(a){this.logConverterFailureAndRethrow(a,t,e,o)}}}n||this.logUnsupportedStatement(e)}checkFreezePanes(e,t){if(e.dismissedArguments?.freezePane||t&&(0,Yt.WS)(t,(0,i.u1Q)())){const t={agent:r.w2.UnsupportedEvent,items:[r.DH.FreezePanes]};return this.logUnsupportedStatement(e),[t]}}checkSelectRowsShouldBeSelectTables(e){if(!e.some((e=>"conditional_format_rows"===e.name||"conditionalFormatRows"===e.name)))return e;let t=!1;for(let a=0;a<e.length;a++)switch(e[a].name){case"select_rows":case"selectRows":if(0===e[a].arguments?.rowNumbers?.numberList?.length){t=!0;const n=e.slice(0,a),o=e.slice(a+1);e=n.concat(o),a--}break;case"conditional_format_rows":case"conditionalFormatRows":t&&(e[a].name="conditionalFormatTables",e[a].arguments.rows&&delete e[a].arguments.rows,e[a].arguments.tables={type:"var",name:"tables"})}return e}logConverterSucceeded(e,t){const a=(0,l.b6)();a[l.Dh.EventState]=l.DD.ConvertSucceeded,a[l.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),a[l.Dh.TimeDurationInMs]=(0,l.xJ)(t),this.telemetryLogger.logEvent((0,l.gY)(a))}logUnsupportedStatement(e){const t=(0,l.b6)();t[l.Dh.EventState]=l.DD.UnsupportedStatement,t[l.Dh.CurrentStatement]=e.name,this.telemetryLogger.logEvent((0,l.gY)(t))}logUnsupportedStatementsAndThrow(e){const t=(0,l.b6)();throw t[l.Dh.EventState]=l.DD.UnsupportedStatement,t[l.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),this.telemetryLogger.logEvent((0,l.gY)(t)),new o.tF("Delete + Insert columns (could be move columns) is a blocked scenario","DeleteColumns and InsertColumns",o.tJ.DeleteWithInsertColumns)}logUnsupportedTableStructureChangesStatementsAndThrow(e){const t=(0,l.b6)();throw t[l.Dh.EventState]=l.DD.UnsupportedStatement,t[l.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),this.telemetryLogger.logEvent((0,l.gY)(t)),new o.tF("Multiple steps with potential table structure changes","Inserts and Deletes",o.tJ.MultipleTableStructureChanges)}logVariableCacheFailureAndRethrow(e,t,a,n){e.isStatementArgumentError&&this.logStatementArgumentError(e),e.isConverterError&&(0,D.R)(e);const o=(0,l.b6)();throw o[l.Dh.EventState]=l.DD.VariableCacheFailed,o[l.Dh.CurrentStatement]=a.name,o[l.Dh.StatementNames]=JSON.stringify(t.map((e=>e.name))),o[l.Dh.TimeDurationInMs]=(0,l.xJ)(n),this.telemetryLogger.logEvent((0,l.gY)(o)),e}logConverterFailureAndRethrow(e,t,a,n){if(e.isNoEventGeneratedError)return void this.logNoEventGeneratedError(e);e.isStatementArgumentError&&this.logStatementArgumentError(e),e.isConverterError&&(0,D.R)(e);const o=(0,l.b6)();throw o[l.Dh.EventState]=l.DD.ConverterFailed,o[l.Dh.CurrentStatement]=a.name,o[l.Dh.StatementNames]=JSON.stringify(t.map((e=>e.name))),o[l.Dh.TimeDurationInMs]=(0,l.xJ)(n),this.telemetryLogger.logEvent((0,l.gY)(o)),e}logNoEventGeneratedError(e){const t={eventType:s.S.NoEventGenerated,errorMessage:e.message,logLevel:l.$b.ASHA},a=[{key:l.iq.Reason,value:e.reason},{key:l.iq.CurrentStatement,value:e.statementName},{key:l.iq.ArgumentNames,value:JSON.stringify(e.argumentNames)},{key:l.iq.UnsupportedArgumentTypes,value:JSON.stringify(e.unsupportedArgumentTypes)},{key:l.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(t,void 0,a)}logStatementArgumentError(e){const t={eventType:s.S.StatementArgumentError,errorMessage:e.message,logLevel:l.$b.Warning},a=[{key:l._4.Reason,value:e.reason},{key:l._4.ArgumentType,value:e.argumentType},{key:l._4.ExpectedType,value:e.expectedType},{key:l.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(t,void 0,a)}fillEventConverterMap(){this.eventConverterMap.formatRanges=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||async function(e,t){const a=ee(e,t),n=await Qt(e,a,!1);return Jt(n,e,a),n}(e,this.variableCache)},this.eventConverterMap.insertTables=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.InsertTables]}]},this.eventConverterMap.formatColumns=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||qt(e,this.variableCache)},this.eventConverterMap.formatRows=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||async function(e,t){const a=Z(e,t),n=await Qt(e,a,!1);return Jt(n,e,a),n}(e,this.variableCache)},this.eventConverterMap.formatTables=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||Ut(e,this.variableCache)},this.eventConverterMap.replaceTables=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values,n=[];for(const e of a)try{const t=e.sheetRange;if((0,b.av)()&&(0,m.En)(e)){const a={rangeType:wt.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.WholeTable,tableName:e.name,gridRange:t}};n.push(a)}else n.push({rangeType:wt.RangeType.ExcelSheetRange,range:t})}catch{}return await Ft(e,n)}(e,this.variableCache),this.eventConverterMap.replaceColumns=async(e,t)=>async function(e,t){const a=K(e,t);return await Ft(e,a)}(e,this.variableCache),this.eventConverterMap.replaceRows=async(e,t)=>async function(e,t){const a=Z(e,t);return await Ft(e,a)}(e,this.variableCache),this.eventConverterMap.replaceRanges=async(e,t)=>async function(e,t){const a=ee(e,t);return await Ft(e,a)}(e,this.variableCache),this.eventConverterMap.clearRanges=async(e,t)=>function(e,t,a){return Ee(ee(e,t),e,a)}(e,this.variableCache,t),this.eventConverterMap.clearTables=async(e,t)=>async function(e,t,a){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables").values,i=(0,O.Ak)(e,"content")??!1,l=(0,O.Ak)(e,"format")??!1,s={agent:r.w2.OfficeScripts,items:[]};if((0,b.yw)("OfficeVSO_9448487_fixClearContentFormatAndHyperlink")){for(const t of n){let a;a=Y(t.sheetRange),(0,b.av)()&&(0,m.En)(t)&&(a={rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Body,tableName:t.name,gridRange:d.ExcelCalc.getIGeneralRangeOperationRange(a)}}),Re(s,e,a)}return 0===s.items.length&&(0,o.VD)(e,n.length,[]),[s]}for(const t of n){let n;if(n=Y(t.sheetRange),(0,b.av)()&&(0,m.En)(t)&&(n={rangeType:d.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Body,tableName:t.name,gridRange:d.ExcelCalc.getIGeneralRangeOperationRange(n)}}),(0,b.yw)("OfficeVSO_9285634_RemoveClearContentRegex")){const t=(0,O.Ak)(e,"hyperlink")??!1,a=(0,O.Ak)(e,"all")??!1;i&&s.items.push(pe(we.default.ClearCells,n)),t&&s.items.push(pe(we.default.ConvertLinkedEntitiesToText,n)),a&&s.items.push(pe(we.default.ClearCellsAll,n))}else i&&a&&(p(a,E)||p(a,R))&&s.items.push(pe(we.default.ClearCells,n));l&&s.items.push(pe(we.default.ClearCellsFormat,n))}return 0===s.items.length&&(0,o.VD)(e,n.length,[]),[s]}(e,this.variableCache,t),this.eventConverterMap.clearColumns=async(e,t)=>function(e,t,a){return Ee(K(e,t),e,a)}(e,this.variableCache,t),this.eventConverterMap.clearRows=async(e,t)=>function(e,t,a){return Ee(Z(e,t),e,a)}(e,this.variableCache,t),this.eventConverterMap.filterTables=async(e,t)=>(0,b.yw)("NewEntityResolution")?async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","filterTables: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0],i=JSON.parse(n.headers),l=Q.getTableColumnName(n,e),s=(0,O.BO)(e,"filterType");if(void 0===s)throw new o.tF("No filter type specified",e.name);const c=[];let u=!1;const m=[];if(n.tableLikeRange){const t=tt[s],a=Q.getTableColumnNumber(e,n);let o=d.ExcelCalc.IExcelRangeToAddress(n.sheetRange.range),l=Ye?d.ExcelCalc.IExcelRangeToAddress(d.ExcelCalc.columnFromIExcelAddress(n.sheetRange.range,a)):"";if(t){u=!0;const d=t(e);if(d.color&&(d.color=await Je(n.sheetRange.sheet,o,a,d.color,"CellColor"===s?"fill":"font",!0)),!(0,b.yw)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS")&&(0,b.yw)("OfficeVSO_9115888_TLRFiltering")&&(0,b.k6)()){const t=at[s],o={sheet:n.sheetRange.sheet,range:{topLeft:n.sheetRange.range.topLeft,bottomRight:{column:n.sheetRange.range.bottomRight.column,row:n.totalRow&&n.sheetRange.range.bottomRight.row?n.sheetRange.range.bottomRight.row-1:n.sheetRange.range.bottomRight.row}}};c.push({agent:r.w2.OfficeScripts,items:[await t(n.sheetRange.sheet,a+1,o,e)]})}else(0,b.tg)()&&n.totalRow&&(o=ae(n.sheetRange.range),l=o),c.push({agent:r.w2.OfficeJS,items:[et({filterType:s,sheetName:n.sheetRange.sheet,rangeAddress:o,columnAddress:l,columnIndex:a,columnName:i[a],filterCriteria:d})]})}else m.push(s)}else{const t=Ze[s],a=Ke[s];u=!1;const o=[];t||a?(u=!0,t&&c.push({agent:r.w2.OfficeScripts,items:[await t(n.name,l,e)]}),a&&c.push({agent:r.w2.OfficeJS,items:[await a(n.name,l,i.indexOf(l),e)]})):o.push(s)}return 0===c.length&&(0,o.VD)(e,1,u?[]:m),c}(e,this.variableCache):async function(e,t,a){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","filterTablesDeprecated: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0],l=i.name,s=JSON.parse(i.headers),c=i.visibleColumns,d=(0,O.Ru)(e,"columnName"),m=(0,O.lI)(e,"columnNumber");if(void 0===d&&void 0===m)throw new o.tF("No column specified.","filterTablesDeprecated");let g=d;d||(g=s[_(m,c,"filterTablesDeprecated")]);const h=(0,O.BO)(e,"filterType");if(void 0===h)throw new o.tF("No filter type specified","filterTablesDeprecated");const p=[],b=Ze[h],f=Ke[h];let C=!1;const y=[];return b||f?(C=!0,b&&p.push({agent:r.w2.OfficeScripts,items:[await b(l,g,e)]}),f&&p.push({agent:r.w2.OfficeJS,items:[await f(l,g,s.indexOf(g),e)]})):y.push(h),0===p.length&&(0,o.VD)(e,1,C?[]:y),u.g.instance().setIsFirstColumnEntityResolved(i.headers,a),p}(e,this.variableCache,t),this.eventConverterMap.clearFilters=async(e,t)=>(0,b.yw)("NewEntityResolution")?Xe(e,this.variableCache):async function(e,t,a){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","clearFiltersDeprecated: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0],l=i.name,s=JSON.parse(i.headers),c=i.visibleColumns;let d=(0,O.Lb)(e,"columnNames")??[];const m=(0,O.dc)(e,"columnNumbers")??[],g=[];0!==d.length?d.map((e=>g.push(Ce(l,e)))):0!==m.length?(d=m.map((t=>{const a=_(t,c,e.name);return s[a]})),d.map((e=>g.push(Ce(l,e))))):g.push(ye(l)),0===g.length&&(0,o.VD)(e,1,[]),(0!==d.length||0!==m.length)&&u.g.instance().setIsFirstColumnEntityResolved(i.headers,a);return[{agent:r.w2.OfficeScripts,items:g}]}(e,this.variableCache,t),this.eventConverterMap.insertRows=async(e,t)=>async function(e,t,a){const n=t.getVariableArgumentValue(e,"scope");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","insertTableRows: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0];let l=[];l=(0,b.yw)("OfficeVSO_9436607_WorksheetRowNumber")?P(e,i.sheetRange.range.topLeft.row??0):(0,O.dc)(e,"rowNumbers");const s={agent:r.w2.OfficeScripts,items:[]};let c=!1;const u=t.tryGetChainedVariableArgument("rows");if(u){const e=u.values.indices[0];if(e&&(l.fill(e),c=!0),c)for(let e=0;e<l.length;e++)l[e]++}const m=await Q.getTableRowRangesCommon(i,l,!1);if(i.tableLikeRange){const a=[];if((0,b.yw)("OfficeVSO_9408399_InsertBelowFixes")){const t=(0,O.Ak)(e,"insertBelow")??!1;l.sort(((e,t)=>e-t));for(let e=0;e<m.length;e++){const n=d.ExcelCalc.getIGeneralRangeOperationRange(m[e]);c&&t&&n.range.topLeft.row<i.sheetRange.range.bottomRight.row+(i.totalRow?0:1)&&(n.range.topLeft.row++,n.range.bottomRight.row++,m[e]={rangeType:wt.RangeType.ExcelSheetRange,range:n});const o=e>0?_t(l,e):0,r={rangeType:wt.RangeType.ExcelSheetRange,range:{sheet:n.sheet,range:{topLeft:{row:n.range.topLeft.row+o,column:n.range.topLeft.column},bottomRight:{row:n.range.topLeft.row+o,column:n.range.bottomRight.column}}}};a.push(r)}}m.map((e=>{s.items.push(ce(d.EventMethods.Range.Inserted,e,d.IDirection.Down))})),(0,b.yw)("OfficeVSO_9377931_InsertRowReturnVariable")&&t.UpdateVariableCache(e.returns,"Row",{ranges:(0,b.yw)("OfficeVSO_9408399_InsertBelowFixes")?a:m})}else{const n=q(m.map((e=>d.ExcelCalc.getIGeneralRangeOperationRange(e))),i,(0,b.yw)("OfficeVSO_9322539_InsertAtTableEnd"));if(!(0,b.yw)("OfficeVSO_9279072_RowBelowQueryRegExp_IncrementFix")||c)if((0,b.yw)("OfficeVSO_9279072_RowBelowQueryRegExpRemoval")){if((0,O.Ak)(e,"insertBelow"))for(let e=0;e<n.length;e++)n[e]<i.numRows&&n[e]++}else if(a&&p(a,x))for(let e=0;e<n.length;e++)n[e]<i.numRows&&n[e]++;const o=[];if(n.sort(((e,t)=>e-t)),s.items=s.items.concat(n.map((e=>de(d.EventMethods.Table.RowInserted,i.name,e,1)))),(0,b.yw)("OfficeVSO_9377931_InsertRowReturnVariable")){const a=i.sheetRange;for(let e=0;e<n.length;e++){const t=e>0?_t(n,e):0,r={rangeType:wt.RangeType.ExcelSheetRange,range:{sheet:a.sheet,range:{topLeft:{row:a.range.topLeft.row+n[e]+1+t,column:a.range.topLeft.column},bottomRight:{row:a.range.topLeft.row+n[e]+1+t,column:a.range.bottomRight.column}}}};o.push(r)}t.UpdateVariableCache(e.returns,"Row",{ranges:o})}}return[s]}(e,this.variableCache,t),this.eventConverterMap.deleteRows=async(e,t)=>async function(e,t){const a=t.getVariableArgumentValue(e,"rows").values;if((0,b.yw)("OfficeVSO_8460617_BlockDeleteAllRows")&&a.allRows)throw new o.tF("Deleting all rows is a blocked scenario",e.name,o.tJ.DeleteUnexpectedTableRows);const n=g(e.name),i=a.indices??[],l=n.numRows,s={agent:r.w2.OfficeScripts,items:[]};if(0===i.length){if((0,D.R)(new o.tF("Executing delete row on table with no row number")),(0,b.av)()&&(0,m.En)(n))s.items.push(de(d.EventMethods.Table.RowsDeleted,n.name,l-1,1));else{const e=Lt(n.sheetRange,l-1);if(null===e)throw new o.tF("Failed to resolve selected tables!");s.items.push(ce(d.EventMethods.Range.Deleted,e,d.IDirection.Up))}return[s]}if((0,b.av)()&&(0,m.En)(n)){const e=[],t=[];i.sort(((e,t)=>e-t)).forEach((t=>{e.push(t)}));for(let t=e.length-1;t>=0;t--){const a=e[t];a>=-1&&a<n.numRows&&s.items.push(de(d.EventMethods.Table.RowsDeleted,n.name,a,1))}for(let e=t.length-1;e>=0;e--){const a=n.numRows+t[e];a>=0&&a<n.numRows&&s.items.push(de(d.EventMethods.Table.RowsDeleted,n.name,a,1))}}else i.sort(((e,t)=>t-e)).forEach((e=>{const t=Lt(n.sheetRange,e+1);if(null===t)throw new o.tF("Failed to resolve selected tables!");s.items.push(ce(d.EventMethods.Range.Deleted,t,d.IDirection.Up))}));return 0===s.items.length&&(0,o.VD)(e,1,[]),[s]}(e,this.variableCache),this.eventConverterMap.insertColumns=async(e,t)=>function(e,t,a){const n=t.getVariableArgumentValue(e,"scope");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","insertColumns: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0];let l=[];(0,b.yw)("NewEntityResolution")?(l=Q.getTableColumnNumbers(e,i),l=l.map((e=>e+1))):l=(0,O.dc)(e,"columnNumbers");const s=(0,O.Lb)(e,"columnNames"),c=(0,O.Lb)(e,"numberFormats"),g={agent:r.w2.OfficeScripts,items:[]},h=i.sheetRange,p=i.numColumns;if(s.length!==c.length&&0!==s.length&&0!==c.length)throw new o.tF("mismatch between columnNames and numberFormat dimensions","scope");if(0===l.length||-1===l[0]&&1===l.length){const e=0===s.length?0===c.length?1:c.length:s.length;l=Array(e).fill(p+1)}if((0,b.yw)("OfficeVSO_9175853_AdjustColumnNumbersForInsertColumn")&&1===l.length&&l[0]>-1&&s.length>1){const e=s.length;l=Array(e).fill(l[0])}if(l.length!==s.length&&0!==s.length)throw new o.tF("mismatch between columnNames, columnNumbers, numberFormat, and columnValues","columns");const f=(C=p,l.map((e=>e<0?C+1+e:e-1)).sort(((e,t)=>e-t)));var C;for(let e=f.length-1;e>=0;e--){const t=f[e];if(t>=0&&t<=p){if(i.tableLikeRange){const e=It(i.sheetRange,t);if(null===e)throw new o.tF("Failed to resolve selected tables!");g.items.push(ce(d.EventMethods.Range.Inserted,e,d.IDirection.Right))}else(0,b.av)()?g.items.push(ue(i.name,t,1,s.length>e?[s[e]]:void 0)):g.items.push(de(d.EventMethods.Table.ColumnInserted,i.name,t,1));const a=h.range.topLeft.row??0,n=(h.range.bottomRight.row??0)+1,r=(h.range.topLeft.column??0)+t;if(0!==c.length){const o={range:{topLeft:{row:a,column:r},bottomRight:{row:n,column:r}},sheet:h.sheet},l="";(0,b.av)()&&(0,m.En)(i)?g.items.push(le(d.EventMethods.Range.NumberFormatChanged,(0,Et.j)(c[e],void 0),{rangeType:wt.RangeType.TableRange,range:{subRange:d.TableRangeOperationSubRange.Columns,tableName:i.name,gridRange:o,subRangeValues:{firstIndex:t,count:1}}},l)):g.items.push(le(d.EventMethods.Range.NumberFormatChanged,(0,Et.j)(c[e],void 0),{rangeType:wt.RangeType.ExcelSheetRange,range:o},l))}if(!(0,b.av)()&&0!==s.length){const t={range:{topLeft:{row:a,column:r},bottomRight:{row:a,column:r}},sheet:h.sheet};g.items.push((0,b.yw)("OfficeVSO_9056836_useRangeSingleValueEdited")?ie(s[e],t):re([[s[e]]],t))}}}0===g.items.length&&(0,o.VD)(e,1,[]),(0,b.yw)("NewEntityResolution")||u.g.instance().setIsFirstColumnEntityResolved(i.headers,a);return[g]}(e,this.variableCache,t),this.eventConverterMap.deleteColumns=async(e,t)=>async function(e,t,a){const n=t.getVariableArgumentValue(e,"columns").values,i=g(e.name),l=n.indices??[],s=i.numColumns,c={agent:r.w2.OfficeScripts,items:[]};if(0===l.length){if((0,D.R)(new o.tF("Executing delete column on table with no column number")),(0,b.av)()&&(0,m.En)(i))c.items.push(de(d.EventMethods.Table.ColumnsDeleted,i.name,s-1,1));else{const e=It(i.sheetRange,s-1);if(null===e)throw new o.tF("Failed to resolve selected tables!");c.items.push(ce(d.EventMethods.Range.Deleted,e,d.IDirection.Left))}return[c]}if((0,b.av)()&&(0,m.En)(i)){const e=[],t=[];l.sort(((e,t)=>e-t)).forEach((a=>{a<0?t.push(a):e.push(a)}));for(let t=e.length-1;t>=0;t--){const a=e[t];a>=0&&a<s&&c.items.push(de(d.EventMethods.Table.ColumnsDeleted,i.name,a,1))}for(let e=t.length-1;e>=0;e--){const a=s+t[e];a>=0&&a<s&&c.items.push(de(d.EventMethods.Table.ColumnsDeleted,i.name,a,1))}}else l.sort(((e,t)=>t-e)).forEach((e=>{const t=It(i.sheetRange,e);if(null===t)throw new o.tF("Failed to resolve selected tables!");c.items.push(ce(d.EventMethods.Range.Deleted,t,d.IDirection.Left))}));0===c.items.length&&(0,o.VD)(e,1,[]),(0,b.yw)("NewEntityResolution")||u.g.instance().setIsFirstColumnEntityResolved(i.headers,a);return[c]}(e,this.variableCache,t),this.eventConverterMap.addCalculatedColumns=async(e,t)=>jt(e,this.variableCache),this.eventConverterMap.aggregateColumns=async(e,t)=>jt(e,this.variableCache),this.eventConverterMap.getInsights=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values[0],n=(0,O.Ru)(e,"instruction")??"get insights",i={func:"getTableInsights",args:[a.name,n]};return[{agent:r.w2.Insights,items:[i]}]}(e,this.variableCache),(0,b.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)&&(this.eventConverterMap.insertDatasource=async(e,t)=>async function(e){if(!e.arguments.preview)throw new o.tF("no preview context","preview");const t={func:"insertDatasource",args:[(0,O.Ru)(e,"preview")]};return[{agent:r.w2.ImportData,items:[t]}]}(e,this.variableCache)),(0,b.eF)()&&(this.eventConverterMap.addDataShapingTransformationSteps=async(e,t)=>async function(e){const t={kind:"addDataShapingTransformationSteps",args:{sessionId:(0,O.C3)(e,"sessionId"),transformationStepsJson:(0,O.C3)(e,"transformationSteps"),transformationStepsExplanation:(0,O.C3)(e,"transformationStepsExplanation")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache),this.eventConverterMap.enterDataShapingMode=async(e,t)=>async function(e){const t={kind:"enterDataShapingMode",args:{tableName:(0,O.C3)(e,"tableName"),sessionId:(0,O.C3)(e,"sessionId"),mashupDocument:(0,O.C3)(e,"mashupDocument"),queryName:(0,O.C3)(e,"queryName"),queryScript:(0,O.C3)(e,"queryScript")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache)),this.eventConverterMap.sortTables=async(e,t)=>dt(e,this.variableCache,this.executableItems,t),this.eventConverterMap.clearSort=async(e,t)=>(0,b.yw)("OfficeVSO_9217762_SupportClearSorting")?ut(e,this.variableCache):dt(e,this.variableCache,this.executableItems,t),this.eventConverterMap.conditionalFormatRanges=async(e,t)=>async function(e,t){return vt(ee(e,t),(0,O.Ak)(e,"clearConditionalFormat")??!1,e)}(e,this.variableCache),this.eventConverterMap.conditionalFormatTables=async(e,t)=>async function(e,t){const a=await X(e,t);return(0,b.yw)("OfficeVSO_9369560_CFTablesSupported")?yt(e,a):vt(a,(0,O.Ak)(e,"clearConditionalFormat")??!1,e)}(e,this.variableCache),this.eventConverterMap.conditionalFormatColumns=async(e,t)=>async function(e,t){return yt(e,K(e,t),te(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatRows=async(e,t)=>async function(e,t){const a=Z(e,t);return(0,b.yw)("OfficeVSO_9369564_CFRowsSupported")?yt(e,a):vt(a,(0,O.Ak)(e,"clearConditionalFormat")??!1,e)}(e,this.variableCache),this.eventConverterMap.conditionalFormatSuggestionPill=async(e,t)=>St(e,this.variableCache,n.i.SuggestionPill),this.eventConverterMap.conditionalFormatSuggestion=async(e,t)=>St(e,this.variableCache,n.i.Chat),this.eventConverterMap.insertWorksheets=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.InsertWorksheets]}]},this.eventConverterMap.deleteWorksheets=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.DeleteWorksheets]}]},(0,b.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableDataValidation",!1)&&(this.eventConverterMap.addDataValidationColumns=async(e,t)=>async function(e,t){const a=K(e,t);return await xe(e,a)}(e,this.variableCache),this.eventConverterMap.addDataValidationRows=async(e,t)=>async function(e,t){const a=Z(e,t);return await xe(e,a)}(e,this.variableCache),this.eventConverterMap.addDataValidationTables=async(e,t)=>async function(e,t){return xe(e,await X(e,t))}(e,this.variableCache),this.eventConverterMap.addDataValidationRanges=async(e,t)=>async function(e,t){const a=ee(e,t);return await xe(e,a)}(e,this.variableCache))}constructor(){this.variableCache=new J,this.telemetryLogger=c.M.getInstance(),this.executableItems=[],this.eventConverterMap={},this.fillEventConverterMap()}}},58428:(e,t,a)=>{a.d(t,{$8:()=>A,$J:()=>v,B8:()=>w,FN:()=>h,GO:()=>p,IJ:()=>I,Is:()=>E,Mb:()=>d,RR:()=>s,US:()=>L,X7:()=>c,Yl:()=>R,ZA:()=>u,b3:()=>y,c$:()=>o,fP:()=>n,mY:()=>x,nr:()=>S,qq:()=>g,sh:()=>b,t0:()=>f,tQ:()=>T,tg:()=>m,y6:()=>C});var n,o,r=a(49134),i=a(78686),l=a(69827);!function(e){e.UniqueDuplicate="UniqueDuplicate",e.TimePeriod="TimePeriod",e.OtherPresetsNumber="OtherPresetsNumber",e.OtherPresetsGeneral="OtherPresetsGeneral"}(n||(n={})),function(e){e.Number="Number",e.Date="Date",e.Text="Text"}(o||(o={}));const s={between:i.default.Between,equalTo:i.default.EQ,greaterThan:i.default.GT,greaterThanOrEqual:i.default.GE,lessThan:i.default.LT,lessThanOrEqual:i.default.LE,notBetween:i.default.NotBetween,notEqualTo:i.default.NE},c={[i.default.Between]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueBetweenPrefixLabel,[i.default.EQ]:e=>e?ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueEqualToNumberPrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueEqualToPrefixLabel,[i.default.GT]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueGreaterThanPrefixLabel,[i.default.GE]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueGreaterThanOrEqualToPrefixLabel,[i.default.LT]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueLessThanPrefixLabel,[i.default.LE]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueLessThanOrEqualToPrefixLabel,[i.default.NotBetween]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotBetweenPrefixLabel,[i.default.NE]:e=>e?ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotEqualToNumberPrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotEqualToPrefixLabel},d={[i.default.Between]:"between",[i.default.EQ]:"equal to",[i.default.GT]:"greater than",[i.default.GE]:"greater than or equal to",[i.default.LT]:"less than",[i.default.LE]:"less than or equal to",[i.default.NotBetween]:"not between",[i.default.NE]:"not equal to"},u={bottomItems:i.default.Bot10,bottomPercent:i.default.Bot10P,topItems:i.default.Top10,topPercent:i.default.Top10P},m={[i.default.Bot10]:"bottom ${number} items",[i.default.Bot10P]:"bottom ${number} percent",[i.default.Top10]:"top ${number} items",[i.default.Top10P]:"top ${number} percent"},g={[i.default.Bot10]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomItemsPrefixLabel,[i.default.Bot10P]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomPercentPrefixLabel,[i.default.Top10]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopItemsPrefixLabel,[i.default.Top10P]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopPercentPrefixLabel},h={lastMonth:l.default.LastMonth,lastSevenDays:l.default.Last7Days,lastWeek:l.default.LastWeek,nextMonth:l.default.NextMonth,nextWeek:l.default.NextWeek,thisMonth:l.default.ThisMonth,thisWeek:l.default.ThisWeek,today:l.default.Today,tomorrow:l.default.Tomorrow},p={[l.default.LastMonth]:"in the last month",[l.default.Last7Days]:"in the last 7 days",[l.default.LastWeek]:"in the last week",[l.default.NextMonth]:"in the next month",[l.default.NextWeek]:"in the next week",[l.default.ThisMonth]:"in this month",[l.default.ThisWeek]:"in this week",[l.default.Today]:"for today",[l.default.Tomorrow]:"for tomorrow"},b={[l.default.LastMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLastMonthPrefixLabel,[l.default.Last7Days]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLast7DaysPrefixLabel,[l.default.LastWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLastWeekPrefixLabel,[l.default.NextMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesNextMonthPrefixLabel,[l.default.NextWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesNextWeekPrefixLabel,[l.default.ThisMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesThisMonthPrefixLabel,[l.default.ThisWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesThisWeekPrefixLabel,[l.default.Today]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesTodayPrefixLabel,[l.default.Tomorrow]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesTomorrowPrefixLabel},f={aboveAverage:i.default.AA,belowAverage:i.default.BA,equalOrAboveAverage:i.default.EqualAA,equalOrBelowAverage:i.default.EqualBA,blanks:i.default.Blanks,nonBlanks:i.default.NoBlanks,errors:i.default.Errors,nonErrors:i.default.NoErrors,invalid:i.default.Nil},C={[i.default.AA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetAboveAveragePrefixLabel,[i.default.BA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetBelowAveragePrefixLabel,[i.default.EqualAA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetEqualToOrAboveAveragePrefixLabel,[i.default.EqualBA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetEqualToOrBelowAveragePrefixLabel,[i.default.Blanks]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetBlankPrefixLabel,[i.default.NoBlanks]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetNotBlankPrefixLabel,[i.default.Errors]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetErrorsPrefixLabel,[i.default.NoErrors]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetNotErrorsPrefixLabel,[i.default.Nil]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetInvalidPrefixLabel},y={[i.default.AA]:"above average",[i.default.BA]:"below average",[i.default.EqualAA]:"equal to or above average",[i.default.EqualBA]:"equal to or below average",[i.default.Blanks]:"blank",[i.default.NoBlanks]:"not blank",[i.default.Errors]:"errors",[i.default.NoErrors]:"not errors",[i.default.Nil]:"invalid"},v={beginsWith:i.default.BeginsWith,contains:i.default.Contains,endsWith:i.default.EndsWith,notContains:i.default.NotContains},T={[i.default.BeginsWith]:"begins with",[i.default.Contains]:"contains",[i.default.EndsWith]:"ends with",[i.default.NotContains]:"does not contain"},x={[i.default.BeginsWith]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonBeginsWithPrefixLabel,[i.default.Contains]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonContainsPrefixLabel,[i.default.EndsWith]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonEndsWithPrefixLabel,[i.default.NotContains]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonDoesNotContainPrefixLabel},S={fiveArrows:i.default.IconSet5Arrows,fiveArrowsGray:i.default.IconSet5ArrowsGray,fiveBoxes:i.default.IconSet5Boxes,fiveQuarters:i.default.IconSet5Quarters,fiveRating:i.default.IconSet5Rating,fourArrows:i.default.IconSet4Arrows,fourArrowsGray:i.default.IconSet4ArrowsGray,fourRating:i.default.IconSet4Rating,fourRedToBlack:i.default.IconSet4RedToBlack,fourTrafficLights:i.default.IconSet4TrafficLights,threeArrows:i.default.IconSet3Arrows,threeArrowsGray:i.default.IconSet3ArrowsGray,threeFlags:i.default.IconSet3Flags,threeSigns:i.default.IconSet3Signs,threeStars:i.default.IconSet3Stars,threeSymbols:i.default.IconSet3Symbols,threeSymbols2:i.default.IconSet3Symbols2,threeTrafficLights1:i.default.IconSet3TrafficLights1,threeTrafficLights2:i.default.IconSet3TrafficLights2,threeTriangles:i.default.IconSet3Triangles},w={[i.default.IconSet5Arrows]:"5 Arrows",[i.default.IconSet5ArrowsGray]:"5 Arrows Gray",[i.default.IconSet5Boxes]:"5 Boxes",[i.default.IconSet5Quarters]:"5 Quarters",[i.default.IconSet5Rating]:"5 Rating",[i.default.IconSet4Arrows]:"4 Arrows",[i.default.IconSet4ArrowsGray]:"4 Arrows Gray",[i.default.IconSet4Rating]:"4 Rating",[i.default.IconSet4RedToBlack]:"4 Red to Black",[i.default.IconSet4TrafficLights]:"4 Traffic Lights",[i.default.IconSet3Arrows]:"3 Arrows",[i.default.IconSet3ArrowsGray]:"3 Arrows Gray",[i.default.IconSet3Flags]:"3 Flags",[i.default.IconSet3Signs]:"3 Signs",[i.default.IconSet3Stars]:"3 Stars",[i.default.IconSet3Symbols]:"3 Symbols",[i.default.IconSet3Symbols2]:"3 Symbols",[i.default.IconSet3TrafficLights1]:"3 Traffic Lights",[i.default.IconSet3TrafficLights2]:"3 Traffic Lights",[i.default.IconSet3Triangles]:"3 Triangles"},E={[i.default.IconSet5Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Arrows,[i.default.IconSet5ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5ArrowsGray,[i.default.IconSet5Boxes]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Boxes,[i.default.IconSet5Quarters]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Quarters,[i.default.IconSet5Rating]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Rating,[i.default.IconSet4Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4Arrows,[i.default.IconSet4ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4ArrowsGray,[i.default.IconSet4Rating]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4Rating,[i.default.IconSet4RedToBlack]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4RedToBlack,[i.default.IconSet4TrafficLights]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4TrafficLights,[i.default.IconSet3Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Arrows,[i.default.IconSet3ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3ArrowsGray,[i.default.IconSet3Flags]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Flags,[i.default.IconSet3Signs]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Signs,[i.default.IconSet3Stars]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Stars,[i.default.IconSet3Symbols]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Symbols,[i.default.IconSet3Symbols2]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Symbols,[i.default.IconSet3TrafficLights1]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3TrafficLights,[i.default.IconSet3TrafficLights2]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3TrafficLights,[i.default.IconSet3Triangles]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Triangles},R={fiveArrows:Excel.IconSet.fiveArrows,fiveArrowsGray:Excel.IconSet.fiveArrowsGray,fiveBoxes:Excel.IconSet.fiveBoxes,fiveQuarters:Excel.IconSet.fiveQuarters,fiveRating:Excel.IconSet.fiveRating,fourArrows:Excel.IconSet.fourArrows,fourArrowsGray:Excel.IconSet.fourArrowsGray,fourRating:Excel.IconSet.fourRating,fourRedToBlack:Excel.IconSet.fourRedToBlack,fourTrafficLights:Excel.IconSet.fourTrafficLights,threeArrows:Excel.IconSet.threeArrows,threeArrowsGray:Excel.IconSet.threeArrowsGray,threeFlags:Excel.IconSet.threeFlags,threeSigns:Excel.IconSet.threeSigns,threeStars:Excel.IconSet.threeStars,threeSymbols:Excel.IconSet.threeSymbols,threeSymbols2:Excel.IconSet.threeSymbols2,threeTrafficLights1:Excel.IconSet.threeTrafficLights1,threeTrafficLights2:Excel.IconSet.threeTrafficLights2,threeTriangles:Excel.IconSet.threeTriangles},I={[Excel.IconSet.fiveArrows]:"5 Arrows",[Excel.IconSet.fiveArrowsGray]:"5 Arrows Gray",[Excel.IconSet.fiveBoxes]:"5 Boxes",[Excel.IconSet.fiveQuarters]:"5 Quarters",[Excel.IconSet.fiveRating]:"5 Rating",[Excel.IconSet.fourArrows]:"4 Arrows",[Excel.IconSet.fourArrowsGray]:"4 Arrows Gray",[Excel.IconSet.fourRating]:"4 Rating",[Excel.IconSet.fourRedToBlack]:"4 Red to Black",[Excel.IconSet.fourTrafficLights]:"4 Traffic Lights",[Excel.IconSet.threeArrows]:"3 Arrows",[Excel.IconSet.threeArrowsGray]:"3 Arrows Gray",[Excel.IconSet.threeFlags]:"3 Flags",[Excel.IconSet.threeSigns]:"3 Signs",[Excel.IconSet.threeStars]:"3 Stars",[Excel.IconSet.threeSymbols]:"3 Symbols",[Excel.IconSet.threeSymbols2]:"3 Symbols",[Excel.IconSet.threeTrafficLights1]:"3 Traffic Lights",[Excel.IconSet.threeTrafficLights2]:"3 Traffic Lights",[Excel.IconSet.threeTriangles]:"3 Triangles"},A={[r.BorderLineStyle.Thin]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatThinBorderLabel,[r.BorderLineStyle.Medium]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumBorderLabel,[r.BorderLineStyle.Dashed]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashedBorderLabel,[r.BorderLineStyle.Dotted]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDottedBorderLabel,[r.BorderLineStyle.Thick]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatThickBorderLabel,[r.BorderLineStyle.Double]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDoubleBorderLabel,[r.BorderLineStyle.Hair]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatHairlineBorderLabel,[r.BorderLineStyle.MediumDashed]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashedBorderLabel,[r.BorderLineStyle.DashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashDotBorderLabel,[r.BorderLineStyle.MediumDashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashDotBorderLabel,[r.BorderLineStyle.DashDotDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashDotDotBorderLabel,[r.BorderLineStyle.MediumDashDotDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashDotDotBorderLabel,[r.BorderLineStyle.SlantDashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatSlantDashDotBorderLabel},L={[r.BorderLineStyle.None]:"none",[r.BorderLineStyle.Thin]:"thin",[r.BorderLineStyle.Medium]:"medium",[r.BorderLineStyle.Dashed]:"dashed",[r.BorderLineStyle.Dotted]:"dotted",[r.BorderLineStyle.Thick]:"thick",[r.BorderLineStyle.Double]:"double",[r.BorderLineStyle.Hair]:"hairline",[r.BorderLineStyle.MediumDashed]:"medium dashed",[r.BorderLineStyle.DashDot]:"dash dot",[r.BorderLineStyle.MediumDashDot]:"medium dash dot",[r.BorderLineStyle.DashDotDot]:"dash dot dot",[r.BorderLineStyle.MediumDashDotDot]:"medium dash dot dot",[r.BorderLineStyle.SlantDashDot]:"slant dash dot"}},48825:(e,t,a)=>{a.d(t,{X:()=>l,j:()=>r});var n=a(50108);const o={General:e=>"General",Number:e=>i(e),Currency:e=>"$#,##"+i(e),Accounting:e=>{const t=i(e);return`_($* #,##${t}_);_($* (#,##${t};_($* "-"??_);_(@_)`},"Short Date":e=>"m/d/yyyy","Long Date":e=>"[$-x-sysdate]dddd, mmmm dd, yyyy",Time:e=>"[$-x-systime]h:mm:ss AM/PM",Comma:e=>{const t=i(e);return`_(* #,##${t}_);_(* (#,##${t});_(* "-"??_);_(@_)`},Percentage:e=>`${i(e)}%`,Fraction:e=>"# ?/?",Scientific:e=>`${i(e)}E+00`,Text:e=>"@"};function r(e,t){try{return o[e](t)}catch{return e}}function i(e){if(void 0===e||e<0)return"0.00";if(0===e)return"0";{let t="0.";for(let a=0;a<e;a++)t+="0";return t}}function l(e,t){let a=(t?{General:ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionGeneral,"m/d/yyyy":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionShortDate,"[$-x-sysdate]dddd, mmmm dd, yyyy":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionLongDate,"[$-x-systime]h:mm:ss AM/PM":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionTime,"# ?/?":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionFraction,"@":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionText}:{General:"a general format","m/d/yyyy":"a short date format","[$-x-sysdate]dddd, mmmm dd, yyyy":"a long date format","[$-x-systime]h:mm:ss AM/PM":"a time format","# ?/?":"a fraction format","@":"a text format"})[e];return void 0===a?(e.startsWith("[$-")||(0,n.xs)(e)?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionDateTime:"a date/time format":e.startsWith("_($")||e.startsWith("_(â‚¬")||e.startsWith("_(Â£")||e.startsWith("_(Â¥")||e.startsWith("_(â‚¹")||e.startsWith("_(â‚©")||e.startsWith("_(â‚½")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionAccounting:"an accounting format":e.includes("$")||e.includes("â‚¬")||e.includes("Â£")||e.includes("Â¥")||e.includes("â‚¹")||e.includes("â‚©")||e.includes("â‚½")||e.includes("kr")||e.includes("â‚ª")||e.includes("â‚´")||e.includes("zÅ‚")||e.includes("â‚º")||e.includes("à¸¿")||e.includes("KÄ")||e.includes("Ft")||e.includes("Rp")||e.includes("â‚«")||e.includes("kn")||e.includes("lei")||e.includes("Ð»Ð²")||e.includes("din")||e.includes("â‚±")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionCurrency:"a currency format":e.startsWith("_(* #,##")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionComma:"a comma format":e.endsWith("%")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionPercentage:"a percentage format":e.endsWith("E+00")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionScientific:"a scientific format":e.startsWith("0")&&(a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionNumber:"a number format"),void 0!==a?a:(t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionCustom:"a custom format")+"("+e+")"):a}},98453:(e,t,a)=>{a.d(t,{CE:()=>d,bN:()=>s,fL:()=>c});var n=a(49134),o=a(94303),r=a(31764),i=a(50347),l=a(24008);const s=5.625;async function c(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const o=a.workbook.worksheets.getItem(t.sheet).getRange(n.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format");await a.sync();return u(o.format.rowHeight,m(e,"rowHeight"),1)}))}async function d(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const o=a.workbook.worksheets.getItem(t.sheet).getRange(n.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format");await a.sync();return u(o.format.columnWidth,m(e,"columnWidth"),s)}))}function u(e,t,a){return(0,i.yw)("OfficeVSO_9476774_fixAdjustingRowHeightAndColumnWidth")?"Increase"===t?Math.ceil(e*(1+(0,r.Si)("scaleFactor"))):"Decrease"===t?Math.ceil(e*(1-(0,r.Si)("scaleFactor"))):(e=Number(t))*a:"Increase"===t?(e+(0,r.Si)("scaleFactor_deprecated"))*a:"Decrease"===t?(e-(0,r.Si)("scaleFactor_deprecated"))*a:(e=Number(t))*a}function m(e,t){const a=(0,l.Q4)(e,t);if("string"===a)return(0,l.Am)(e,t);if("number"===a)return(0,l.mT)(e,t);throw new o.Dd(`Argument ${t} type ${a} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,a,"enum | number")}},24008:(e,t,a)=>{a.d(t,{Ak:()=>v,Am:()=>i,BO:()=>f,C3:()=>r,Jh:()=>C,Lb:()=>T,NW:()=>S,Q4:()=>h,Ru:()=>b,W7:()=>d,YL:()=>g,dQ:()=>p,dc:()=>x,iA:()=>m,l$:()=>u,lI:()=>y,mT:()=>c,nZ:()=>w,wM:()=>l,zI:()=>s});var n=a(94303),o=a(50347);function r(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="string"!==o.type;if(r||void 0===o.string)throw new n.Dd(r?`Argument ${t} type ${o.type} should be string on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"string");return o.string}function i(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="string"!==o.type;if(r||void 0===o.string)throw new n.Dd(r?`Argument ${t} type ${o.type} should be enum on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"enum");return o.string}function l(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="color"!==o.type;if(r||void 0===o.string)throw new n.Dd(r?`Argument ${t} type ${o.type} should be color on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"color");return o.string}function s(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="boolean"!==o.type;if(r||void 0===o.boolean)throw new n.Dd(r?`Argument ${t} type ${o.type} should be boolean on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"boolean");return o.boolean}function c(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="number"!==o.type;if(r||void 0===o.number)throw new n.Dd(r?`Argument ${t} type ${o.type} should be number on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"number");return o.number}function d(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="stringList"!==o.type;if(r||void 0===o.stringList)throw new n.Dd(r?`Argument ${t} type ${o.type} should be stringList on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"stringList");return o.stringList}function u(e){const t=S(e,"scope");if(!t)throw new n.Dd(`Argument scope not found on ${e.name}`,n.vb.ArgumentUndefined);return t}function m(e){try{return function(e){const t=e.arguments.scope;if(!t)throw new n.Dd(`Argument scope not found on ${e.name}`,n.vb.ArgumentUndefined);if(((0,o.yw)("OfficeVSO_9435729_bugFixSelectColumnWithSelectionScope")?"scope"!==t.type:"scope"===t.type)||"Selection"!==t.name)throw new n.Dd(`Argument scope not Selection type on ${e.name}`,n.vb.ArgumentTypeMismatch);return t}(e)}catch{return}}function g(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="var"!==o.type;if(r||void 0===o.name)throw new n.Dd(r?`Argument ${t} type ${o.type} should be var on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"var");return o.name}function h(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a;if(!o.type)throw new n.Dd(`Argument ${t} type is undefined on ${e.name}`,n.vb.ArgumentTypeUndefined);return o.type}function p(e,t){try{return h(e,t)}catch{return}}function b(e,t){try{return r(e,t)}catch{return}}function f(e,t){try{return i(e,t)}catch{return}}function C(e,t){try{return l(e,t)}catch{return}}function y(e,t){try{return c(e,t)}catch{return}}function v(e,t){try{return s(e,t)}catch{return}}function T(e,t){try{return d(e,t)}catch{return[]}}function x(e,t){try{return function(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="numberList"!==o.type;if(r||void 0===o.numberList)throw new n.Dd(r?`Argument ${t} type ${o.type} should be numberList on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"numberList");return o.numberList}(e,t)}catch{return[]}}function S(e,t){try{return function(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="var"!==o.type;if(r||void 0===o.name)throw new n.Dd(r?`Argument ${t} type ${o.type} should be var on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"var");return o}(e,t)}catch{return}}function w(e){const t=e.returns;if(void 0===t)throw new n.tF(`Return variable not found on ${e.name}`,"getReturnVariable");return t}},8947:(e,t,a)=>{a.d(t,{s:()=>d});class n{invokeNative(e){OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))}constructor(){this.RekaConstants={}}}var o=a(34756),r=a(61150),i=a(50347);o.ft.registerTypeInfos({"Excel::Copilot::DataShapingPrivateSdxApiTransformationStep":{name:"$string",script:"$string"}});const l={IDataShapingPrivateSdxApiService:["Excel::Copilot::IDataShapingPrivateSdxApiService",{startPreview:["ReturnsPromiseMethod","$any",["$string","$string","$string"],{}],endPreview:["ReturnsPromiseMethod","$any",["$string"],{}],appendSteps:["ReturnsPromiseMethod","$any",[["$array","Excel::Copilot::DataShapingPrivateSdxApiTransformationStep"]],{}],removeStep:["ReturnsPromiseMethod","$any",["$string"],{}],getQueryScript:["ReturnsPromiseMethod","$string",[],{}],onQueryScriptChanged:["Event","$string"]}]};o.ft.registerTypeInfos({"Excel::Copilot::AddQueryResultSuccess":{kind:"$string",actualQueryName:"$string"},"Excel::Copilot::AddQueryResultFail":{kind:"$string",error:"$string"},"Excel::Copilot::AddStepResultSuccess":{kind:"$string",actualStepName:"$string"},"Excel::Copilot::AddStepResultFail":{kind:"$string",error:"$string"}});const s={IPowerQueryPrivateSdxApiService:["Excel::Copilot::IPowerQueryPrivateSdxApiService",{showEditor:["ReturnsPromiseMethod","$any",[],{}],addQuery:["ReturnsPromiseMethod",["$union",["Excel::Copilot::AddQueryResultSuccess","Excel::Copilot::AddQueryResultFail"]],["$string","$string","$boolean"],{}],appendStep:["ReturnsPromiseMethod",["$union",["Excel::Copilot::AddStepResultSuccess","Excel::Copilot::AddStepResultFail"]],["$string","$string","$string"],{}],onCommit:["Event","$string"],onCancel:["Event","$any"]}]};var c=a(2934);class d{static getInstance(){return d.excelSdxPrivateApi||(d.excelSdxPrivateApi=new d),d.excelSdxPrivateApi}get NativeServices(){return this.nativeServices}async initializePrivateApi(){this.rekaEnvironment&&(this.rekaEnvironment.RekaInstance.initBridge(new n,[]),this.attachPrivateEventHandler("RekaBridgeMessage",(e=>{(0,r.cY)("PrivateApi response: "+e),this.rekaEnvironment?.RekaInstance.invokeJavaScript(e)}))),await OfficeFirstParty.PrivateApi.onPrivateEvent((async e=>{(0,r.cY)("PrivateApi event: "+e);let t,a=!1;try{t=JSON.parse(e)}catch{t=null}if(t?.eventName){const e=this.apiHandlers.get(t.eventName);e&&(e(t),a=!0)}a||(0,r.cY)("could not dispatch PrivateApi event")}))}attachPrivateEventHandler(e,t){this.apiHandlers.has(e)&&(0,r.cY)("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)}constructor(){var e;this.apiHandlers=new Map,(0,i.yw)("OfficeVSO_9367507_ExcelRekaSdxPrivateAPI")&&(this.rekaEnvironment=(0,o.NU)(),this.nativeServices=(e=this.rekaEnvironment.RekaServiceRegistry,{IPowerQueryPrivateSdxApiService:new c.d((()=>e.getNativeService(s.IPowerQueryPrivateSdxApiService))),IDataShapingPrivateSdxApiService:new c.d((()=>e.getNativeService(l.IDataShapingPrivateSdxApiService)))}))}}},11820:(e,t,a)=>{a.d(t,{Gu:()=>r,J_:()=>i,tH:()=>n});var n,o=a(61150);function r(e){try{let t="";if(!document?.referrer)return void(0,o.cY)("SendMessageToHost failed. document object is null!");t=document.referrer,window.parent.postMessage(e,t)}catch(t){(0,o.cY)("SendMessageToHostViaAgent failed with exception: ",t," for event: ",e)}}function i(e){try{let t="";if(!document?.referrer)return void(0,o.cY)("SendMessageToHost failed. document object is null!");t=document.referrer;const a={Origin:"OfficeCopilotExcelTaskPane",Event:e};window.parent.postMessage(a,t)}catch(t){(0,o.cY)("SendMessageToHost failed with exception: ",t," for event: ",e)}}!function(e){e.TriggerCommentHighlight="TriggerCommentHighlight"}(n||(n={}))},93421:(e,t,a)=>{a.d(t,{y:()=>c});var n=a(89099),o=a(24220),r=a(48314);var i=a(90524);var l=a(43861),s=a(26543);function c(e,t){const a=e.category,c=(0,s.D)(e).errorCode;switch(a){case l.E.ClientProgramResponseError:!function(e,t){let a=o.W.Unclassified_Chat_Failure,i=n.c.Client_Program_Response_Error;e&&"timeout"===e&&(a=o.W.Response_Delayed_Or_Timed_Out,i=n.c.Service_Timeout);r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(c,t);break;case l.E.DisengagedError:(0,i.I)(c,t);break;case l.E.ExcelTabularSkillFailedError:break;case l.E.InferenceAPIError:!function(e,t){let a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.InferenceAPI;if(e)switch(e){case"user-throttled":a=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=n.c.User_Throttled;break;case"scenario-throttled":a=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=n.c.Scenario_Throttled;break;case"throttled":a=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=n.c.Throttled;break;case"not-available":i=n.c.InferenceAPI_Not_Available;break;case"timeout":a=o.W.Response_Delayed_Or_Timed_Out,i=n.c.InferenceAPI_Timeout}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(c,t);break;case l.E.InputQueryError:!function(e,t){let a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Augloop_Failed_Input_Error;if(e)switch(e){case"unsupported-multi-agent":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Multiple_Intents_Detected;break;case"bad-token":a=o.W.User_Access_Issue_For_Copilot,i=n.c.Augloop_Failed_Token_Validation;break;case"too-short":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Too_Short;break;case"too-long":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Too_Long;break;case"invalid":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Query_Error_Invalid;break;case"out-of-scope":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Query_Error_Out_Of_Scope}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(c,t);break;case l.E.LicensingError:!function(e,t){const a=o.W.User_Access_Issue_For_Copilot,i=n.c.Augloop_Failed_Entitlement_Validation;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case l.E.ODSLParseError:!function(e,t){let a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Failed_Parse_ODSL;if(e)switch(e){case"zero-parsed":i=n.c.Failed_Parse_ODSL_Zero;break;case"date-logic":a=o.W.Missing_Copilot_Functionality,i=n.c.Failed_Parse_ODSL_Date_Logic;break;case"no-op":i=n.c.Failed_Parse_ODSL_No_Op}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(c,t);break;case l.E.ODSLSyntaxError:!function(e,t){const a=o.W.Unable_To_Complete_Task,i=n.c.Invalid_ODSL_Generated;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case l.E.OffensiveContent:!function(e,t){let a=n.c.Input_Was_Offensive_So_No_Response;const i=o.W.Responsible_AI_Filter_Blocked_Response;if(e)switch(e){case"input-query:guardlist":a=n.c.Input_Blocked_Guardlist;break;case"input-query:content-safety-jailbreak-classifier":a=n.c.Input_Blocked_Prompt_Injection;break;case"generated-output:open-ai-moderation":a=n.c.Suggestion_Blocked_Due_To_Code_Generated_Being_Protected_By_Copyright_Licensing;break;default:e.indexOf("input-query")>-1?a=n.c.Input_Query_Error:e.indexOf("generated-output")>-1&&(a=n.c.Generated_Output_Error)}r.M.getInstance().logStandardizedAshaErrorEvent(i,a,t)}(c,t);break;case l.E.SkillFailedError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Failed_Due_To_Skill_Failure;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case l.E.SydneyCancelledError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Sydney_Cancelled_Error;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case l.E.IgnorableError:case l.E.SydneyError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output;let i=n.c.Orchestration_Failed_Sydney;if(e)switch(e){case"unknown":i=n.c.Sydney_Unknown_Error;break;case"bad-conversation-id":i=n.c.Sydney_Bad_Converstaion_Id;break;case"error-response":i=n.c.Sydney_Error;break;case"server-timeout":i=n.c.Sydney_Timeout;break;case"websocket-failed-to-connect":i=n.c.Sydney_Websocket_Failed;break;case"out-of-credits":i=n.c.Out_Of_Credits}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(c,t);break;case l.E.TokenCountError:!function(e,t){const a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Exceeded_Max_Length;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case l.E.UnsupportedLanguageError:!function(e,t){const a=o.W.Missing_Copilot_Functionality,i=n.c.Input_Language_Unsupported;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;default:r.M.getInstance().logStandardizedAshaErrorEvent(o.W.Unclassified_ASHA_Error,n.c.Augloop_Error,t)}}},90524:(e,t,a)=>{a.d(t,{I:()=>i});var n=a(89099),o=a(24220),r=a(48314);function i(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Disengaged_Error;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}},43861:(e,t,a)=>{a.d(t,{E:()=>n});const n={ClientProgramResponseError:"ClientProgramResponseError",DisengagedError:"DisengagedError",InferenceAPIError:"InferenceAPIError",InputQueryError:"InputQueryError",LicensingError:"LicensingError",ODSLParseError:"ODSLParseError",ODSLSyntaxError:"ODSLSyntaxError",OffensiveContent:"OffensiveContent",SkillFailedError:"SkillFailedError",SydneyCancelledError:"SydneyCancelledError",IgnorableError:"IgnorableError",SydneyError:"SydneyError",TokenCountError:"TokenCountError",UnsupportedLanguageError:"UnsupportedLanguageError",UnrecognizedTabularRange:"UnrecognizedTabularRange",ExcelTabularSkillFailedError:"ExcelTabularSkillFailedError"}},96854:(e,t,a)=>{a.d(t,{E:()=>m});var n=a(88179),o=a(31030),r=a(48314),i=a(22330),l=a(72746),s=a(50347);let c=null,d=null,u=0;class m{static getInstance(){return m.telemetryEventHandler||(m.telemetryEventHandler=new m),m.telemetryEventHandler}initTelemetryLatencyObject(){d=(()=>{const e={};return Object.keys(n.CT).forEach((t=>{e[t]=0})),e})()}initTelemetryChatEventObject(){c=function(){const e={};return Object.keys(n.h3).forEach((t=>{e[t]=""})),e}()}updateTelemetryChatEventData(e,t){null===c&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((t=>{c[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)}logUserPerceivedLatencyTelemetry(e,t,a=!1,o,r,l){null===d&&this.initTelemetryLatencyObject(),d&&o&&this.updateTelemetryLatencyData({[n.CT.OperationName]:e?n.OP.FirstChunkFinalResponse:n.OP.LastChunkFinalResponse,[n.CT.UserPerceivedLatency]:(0,i.WU)(o),[n.CT.IsQuerySuccess]:t,[n.CT.IsSuccessful]:t,[n.CT.IsFromCache]:a??"",[n.CT.FeatureName]:r?l??r.getActiveFeature():""},r)}logStopGeneratingLatencyTelemetry(e,t,a){null===d&&this.initTelemetryLatencyObject(),d&&e&&(d[n.CT.StopGeneratingTime]=(0,i.WU)(e),t&&(d[n.CT.FeatureName]=a??t.getActiveFeature(),this.sendTelemetryLatencyData(t)))}updateTelemetryLatencyData(e,t){null===d&&this.initTelemetryLatencyObject(),Object.keys(e).forEach((t=>{d&&(d[t]=e[t])})),t&&this.sendTelemetryLatencyData(t)}sendTelemetryLatencyData(e){null!=e&&null!=d&&(e.logEvent(g(d),e.getDefaultEventFlags()),this.initTelemetryLatencyObject())}logLatency(e,t,a=!0,o=""){const i={[n.CT.Duration]:e,[n.CT.OperationName]:t,[n.CT.IsSuccessful]:a,[n.CT.FeatureName]:o};r.M.getInstance().logEvent(g(i))}sendTelemetryChatEventData(e){null!=e&&c&&(e.logEvent(function(e){return e[n.h3.UserQueryGuid]=r.M.userQueryGuid,e[n.h3.UserQueryOrder]=r.M.userQueryOrder,e[n.CT.IsNearestTableEnabled]=(0,s.qm)(),{eventType:o.S.ChatEvents,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}}(c)),this.initTelemetryChatEventObject())}static redactUrl(e,t){switch(e){case"spoppe-b.azureedge.net":return t.endsWith("assets/icons/fabric-icons-a13498cf.woff")?e+t:"";case"fa000000124.resources.office.net":return t.endsWith("taskpane.css")||t.endsWith("officethemes.css")||t.endsWith("assets/office-js/excel.js")||t.endsWith("taskpane.js")||t.endsWith("office_strings.js")||t.endsWith("assets/office-js/webauth/webauth.browserauth.js")||t.endsWith("favicon.ico")||t.endsWith("calc.js")||t.endsWith("oss.js")||t.endsWith("ts.js")||t.endsWith("vendors~calc.js")||t.endsWith("vendors~oss.js")?e+t:"";case"login.microsoftonline.com":return"/common/discovery/instance"===t||"/organizations/oauth2/v2.0/authorize"===t||"/organizations/oauth2/v2.0/token"===t||"/organizations/v2.0/.well-known/openid-configuration"===t?e+t:"";case"alcdn.msauth.net":return t.endsWith("js/msal-browser-1p.min.js")?e+t:"";case"browser.events.data.microsoft.com":return"/OneCollector/1.0/"===t?e+t:"";default:return e.endsWith("officescripts.microsoftusercontent.com")&&"/eed0a086-3498-4f91-a377-1e0265ecc0cc"===t?`officescripts.microsoftusercontent.com${t}`:""}}logPerformanceEntries(e){try{for(const t of e)switch(t.entryType){case"navigation":this.logLatency(t.duration,n.OP.Navigation);break;case"resource":if("xmlhttprequest"!==t.initiatorType){const e=new URL(t.name),a={[n.CT.Duration]:t.duration,[n.CT.OperationName]:n.OP.FetchResource,[n.CT.IsSuccessful]:!0,FullUrl:m.redactUrl(e.hostname,e.pathname),SafeDomain:e.hostname.split(".").slice(-2).join("."),StartTime:t.startTime};r.M.getInstance().logEvent(g(a))}}}catch(e){r.M.getInstance().logError({eventType:o.S.Latency,errorMessage:e instanceof Error?e.message:"Unknown error encountered logging performance entries",logLevel:n.$b.Error})}}setInitContextTime(){u=performance.now()}logTableRecognized(){0!==u&&(u=0,this.logLatency(performance.now()-u,n.OP.RecognizeTable))}logTableMetadata(e){r.M.getInstance().logEvent({eventType:o.S.TabularRange,eventData:[{key:"TableMetadata",value:JSON.stringify(e)}]})}}function g(e){return e[n.CT.UserQueryGuid]=r.M.userQueryGuid,e[n.CT.AugloopSessionGuid]=l.O,e[n.CT.IsNearestTableEnabled]=(0,s.qm)(),{eventType:o.S.Latency,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}}},48314:(e,t,a)=>{a.d(t,{M:()=>A});var n,o,r,i=a(92779),l=a(81364),s=a(89099),c=a(24220),d=a(25549),u=a(45242),m=a(130),g=a(53357),h=a(78185),p=a(93772),b=a(88179);!function(e){e.AnalyzeReceived="AnalyzeReceived",e.FormulaGenerationReceived="GenerateReceived",e.CommandReceived="CommandReceived"}(n||(n={})),function(e){e.AnalyzeApplied="AnalyzeApplied",e.FormulaGenerationApplied="GenerateApplied",e.CommandApplied="CommandApplied"}(o||(o={})),function(e){e.AppLevelReceived="AppLevelReceived",e.AppLevelApplied="AppLevelApplied"}(r||(r={}));const f="Office.Excel.Copilot";var C=a(29348),y=a(11820),v=a(79029),T=a(31030),x=a(16144),S=a(50347),w=a(37488);const E="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",R=1763;class I{sendTelemetryEvent(e){Office.sendTelemetryEvent(e)}}class A{static getInstance(){return A.telemetryLogger||(A.telemetryLogger=new A),A.telemetryLogger}getDefaultEventFlags(){return{dataCategories:u.o.DataCategories.ProductServicePerformance|u.o.DataCategories.ProductServiceUsage,diagnosticLevel:u.o.DiagnosticLevel.RequiredServiceData}}getLogLevelForErrorCategory(e){switch(e){case"UnsupportedLanguageError":case"LicensingError":case"ODSLParseError":case"ODSLSyntaxError":case"InputQueryError":case"":return b.$b.Warning;default:return b.$b.Error}}getTelemetrySink(){return this.telemSink}sendTelemetryEvent(e){this.isAlwaysCriticalEvent(e)&&(e.eventFlags.samplingPolicy=u.o.SamplingPolicy.CriticalUsage),this.oTelLogger.sendTelemetryEvent(e)}logEvent(e,t){this.logTelemetryEvent(e,t)}logUncaughtException(e){const t=[];let a="";(e instanceof Error||e instanceof OfficeExtension.Error)&&(e.message&&(a=e.message),e.stack&&t.push({key:b.un.Stack,value:e.stack})),this.logTelemetryErrorEvent({eventType:T.S.UncaughtException,errorMessage:a,logLevel:b.$b.Critical},void 0,t)}logError(e,t,a){this.logTelemetryErrorEvent(e,t,a)}logStandardizedAshaErrorEvent(e,t,a,n){v.B.getInstance().logStandardizedAshaErrorEvent(e,t,a,this.getVerbForStandardizedFeature(a),n,this.getDefaultTelemetryData())}logAshaEvent(e,t,a,n){v.B.getInstance().logAshaErrorEvent(e,t,a,n,this.getDefaultTelemetryData())}logErrorCode(e,t,a,n,...o){const r=[{key:b.un.ErrorCode,value:e}],i=t instanceof l.u&&t.error?t.error:t;(i instanceof Error||i instanceof OfficeExtension.Error)&&(r.push({key:b.un.Name,value:i.name},{key:b.un.InnerError,value:i.message}),i.stack&&r.push({key:b.un.Stack,value:i.stack}),i instanceof OfficeExtension.Error&&(r.push({key:b.un.OfficeErrorCode,value:i.code}),i.debugInfo.errorLocation&&r.push({key:b.un.ErrorLocation,value:i.debugInfo.errorLocation}))),r.push(...o),this.logTelemetryErrorEvent({eventType:a??T.S.Error,errorMessage:e,logLevel:n??b.$b.Warning},void 0,r)}releaseHeldTelemetryEvents(){this.heldTelemetryEvents.forEach((({featureName:e,telemetryEvent:t})=>{this.sendTelemetryEvent(t),this.seenEvents.add(e)})),this.heldTelemetryEvents=[]}logSeenEvent(e){if(this.seenEvents.has(e))return;const t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(m.TA.FeatureActionType.IsSeen,e,void 0,void 0,void 0,void 0,b.Y9.Chat)};w.isSDXRenderingForPreload?this.heldTelemetryEvents.push({featureName:e,telemetryEvent:t}):(this.sendTelemetryEvent(t),this.seenEvents.add(e))}startTriedActivity(e){null!=this.pendingTriedActivity&&this.endTriedActivityFailure();const t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!0),dataFields:this.getCopilotDataFields(m.TA.FeatureActionType.IsTried,e)};this.pendingTriedActivity=this.oTelLogger.createActivity(t),this.currentStandardizedFeature=void 0,this.currentUsageFeature=void 0}endTriedActivitySuccess(e){if(null==this.pendingTriedActivity)return;if(this.pendingTriedActivity.dataFields=this.getCopilotDataFields(m.TA.FeatureActionType.IsTried,e),this.pendingTriedActivity.success=!0,this.pendingTriedActivity.endNow(),this.pendingTriedActivity=void 0,this.sendSurveyTriggerEvent(!1,e),(0,S.yw)("OfficeVSO_9249393_AttributionFromAugLoop")&&e===b.q.CopilotChat)return;const t=this.getStandardizedFeatureForSubFeature(e);(0,S.yw)("OfficeVSO_9249393_AttributionFromAugLoop")&&this.assertFeatureIsActive(t,"endTriedActivitySuccess: Feature from tried success does not match active feature from AugLoop."),this.currentStandardizedFeature=t,this.currentUsageFeature=e}endTriedActivityFailure(e){null!=this.pendingTriedActivity&&(e?this.pendingTriedActivity.dataFields=this.getCopilotDataFields(m.TA.FeatureActionType.IsTried,e):(0,S.yw)("OfficeVSO_9249393_AttributionFromAugLoop")&&this.currentUsageFeature?this.pendingTriedActivity.dataFields=this.getCopilotDataFields(m.TA.FeatureActionType.IsTried,this.currentUsageFeature):(0,S.yw)("OfficeVSO_9249393_AttributionFromAugLoop")&&(this.pendingTriedActivity.dataFields=this.getCopilotDataFields(m.TA.FeatureActionType.IsTried,this.getUsageFeatureForStandardizedFeature(this.currentStandardizedFeature))),this.pendingTriedActivity.success=!1,this.pendingTriedActivity.endNow(),this.pendingTriedActivity=void 0)}resetActiveFeature(){this.currentStandardizedFeature=void 0,this.currentUsageFeature=void 0,A.querySource=A.nextQuerySource?A.nextQuerySource:b.BC.Default,A.nextQuerySource=b.BC.Default,A.querySource===b.BC.ExternalQuery?A.currentEntryPoint=b.Y9.Canvas:A.currentEntryPoint=b.Y9.Chat}setQuerySource(e){A.nextQuerySource=e}setActiveFeature(e){this.currentStandardizedFeature=this.getStandardizedFeatureForSubFeature(e),this.currentUsageFeature=e}setActiveFeatureWithContentOrigin(e){if(e&&e!==d.w.AugLoopEvalName&&e!==d.w.AugLoopName&&e!==d.w.DeepLeo&&e!==d.w.Workflow)if(e.includes(",")){const t=e.split(",");for(const a of t){const t=(0,b.eQ)(a);if(t){if(void 0!==this.currentStandardizedFeature&&t===b.BJ.ExcelChatHelper)continue;this.assertFeatureIsActive(t,"setActiveFeatureWithContentOrigin, multiple skills"),void 0===this.currentStandardizedFeature&&(this.currentStandardizedFeature=t,this.currentUsageFeature=void 0,this.logError({eventType:T.S.ChatEvents,errorMessage:`AugLoop returned multiple skills: ${e}, and we are setting feature as ${this.currentStandardizedFeature}`,logLevel:b.$b.Warning}));break}}}else{const t=(0,b.eQ)(e);if(t){if(void 0!==this.currentStandardizedFeature&&t===b.BJ.ExcelChatHelper)return;this.assertFeatureIsActive(t,"setActiveFeatureWithContentOrigin, single skill"),void 0===this.currentStandardizedFeature&&(this.currentStandardizedFeature=t,this.currentUsageFeature=void 0)}}}getActiveFeature(){return this.currentStandardizedFeature?this.currentStandardizedFeature:b.BJ.CopilotChat}logKeptEvent(e){const t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(m.TA.FeatureActionType.IsKept,e)};this.sendTelemetryEvent(t),this.sendSurveyTriggerEvent(!0,e)}logRejectedEvent(e,t){if(t&&this.rejectedIds.has(t))return;const a={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(m.TA.FeatureActionType.IsRejected,e)};this.sendTelemetryEvent(a),t&&this.rejectedIds.add(t)}logThumbsUpEvent(e,t,a,n){const o=this.feedbackAreaToFeatureName(e),r={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(void 0,o,!0,(0,S.yw)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?t:void 0,a,n)};this.sendTelemetryEvent(r)}logThumbsDownEvent(e,t,a,n){const o=this.feedbackAreaToFeatureName(e),r={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(void 0,o,!1,(0,S.yw)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?t:void 0,a,n)};this.sendTelemetryEvent(r),this.logUserThumbsDownAshaError(o)}logCitationOnClickEvent(){const e={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!0),dataFields:this.getCopilotDataFields(m.TA.FeatureActionType.IsTried,b.q.AnalyzeData)};this.sendTelemetryEvent(e)}logUserThumbsDownAshaError(e){let t,a;switch(e){case b.q.CalculatedColumns:case b.q.CalculatedRows:t=s.c.User_Dissatisfied_With_Suggestion_Calculated_Columns,a=this.getStandardizedFeatureForSubFeature(a);break;case b.q.Search:t=s.c.Search_User_Thumbs_Down,a=b.BJ.Search;break;case b.q.Else:t=s.c.Else_User_Thumbs_Down,a=b.BJ.ExcelChatHelper;break;case b.q.Python:t=s.c.Python_User_Thumbs_Down,a=b.BJ.Python;break;default:t=s.c.Chat_User_Thumbs_Down,a=b.BJ.CopilotChat}t&&a&&A.getInstance().logStandardizedAshaErrorEvent(c.W.User_Rejected_Or_Cancelled_Response,t,a)}sendSurveyTriggerEvent(e,t){if(!(0,S.yw)("OfficeVSO_8378717_TriggerExcelCopilotSurvey")||void 0===t)return;const a=function(e,t){let a;switch(e){case b.q.AnalyzeData:a=t?"AnalyzeApplied":"AnalyzeReceived";break;case b.q.CalculatedColumns:case b.q.CalculatedRows:a=t?"GenerateApplied":"GenerateReceived";break;case b.q.Commanding:a=t?"CommandApplied":"CommandReceived";break;default:return}return f+"."+a}(t,e),n=function(e){return f+"."+(e?"AppLevelApplied":"AppLevelReceived")}(e);void 0!==a&&(this.logEventName(a),this.logEventName(n),(0,S.yw)("OfficeVSO_8396253_sendToHostCopilotVerticals")&&(0,y.J_)(a))}logEventName(e){const t={telemetryProperties:this.getTelemetryProperties(),eventName:e,eventFlags:this.getCopilotEventFlags(!1)};this.sendTelemetryEvent(t)}feedbackAreaToFeatureName(e){switch(e){case p.Xw.COMMANDING:case p.Xw.COMMANDINGCONDITIONALFORMATTING:return b.q.Commanding;case p.Xw.ANALYZEDATA:return b.q.AnalyzeData;case p.Xw.FORMULAGENERATION:return b.q.CalculatedColumns;case p.Xw.CHATSEARCH:return b.q.Search;case p.Xw.PYTHON:return b.q.Python;case p.Xw.ELSE:return b.q.Else;default:return b.q.CopilotChat}}getTelemetryProperties(){return{ariaTenantToken:E,nexusTenantToken:R}}getDefaultEventDataFields(){return this.getDataFields(this.getDefaultTelemetryData())}getDefaultTelemetryData(){const e=[{key:"UserQueryGuid",value:A.userQueryGuid},{key:"ClientVersion",value:i.hl5},{key:"IsNearestTableEnabled",value:(0,S.qm)()},{key:"GroundingMode",value:(0,b.Q6)()},{key:"IsDevBuild",value:i.MYv},{key:"UiLanguage",value:C.i.getHostAppDisplayLanguage()}];return(0,S.yw)("OfficeVSO_8947993_CustomizeZQMClickTelemetry")&&void 0!==A.querySource&&e.push({key:"querySource",value:A.querySource}),(0,S.yw)("OfficeVSO_9521943_PythonSTKFixes")&&e.push({key:"IsPythonAdaInCopilotEnabled",value:(0,S.H2)()}),e}isAlwaysCriticalEvent(e){if(!(0,S.yw)("OfficeVSO_9246195_AllowAlwaysCriticalEvents"))return!1;if(null===this.alwaysCriticalEvents){const e=(0,S.be)("Microsoft.Office.Excel.FA000000124.AlwaysCriticalEvents","");this.alwaysCriticalEvents=e?e.split("|"):["Office.Voice.ActionAI.ChatEvents","Office.Voice.ActionAI.ShowMe","Office.Voice.ActionAI.Commanding","Office.Voice.ActionAI.OfficeJsOperations","Office.Voice.ActionAI.Latency","Office.Voice.ActionAI.Usage","Office.Voice.ActionAI.Error"]}return this.alwaysCriticalEvents.includes(e.eventName)}getCopilotEventFlags(e){return{dataCategories:u.o.DataCategories.ProductServiceUsage,diagnosticLevel:e?u.o.DiagnosticLevel.RequiredServiceData:u.o.DiagnosticLevel.Optional,samplingPolicy:u.o.SamplingPolicy.CriticalUsage}}getCopilotDataFields(e,t,a,n,o,r,i,l){t!==b.q.UndoMessage&&t!==b.q.CopyMessage&&t!==b.q.ExternalTriggeredQuery||(t=void 0);const s=null!=t?this.getStandardizedFeatureForSubFeature(t):null!=this.currentStandardizedFeature?this.currentStandardizedFeature:b.BJ.CopilotChat,c=s,d=t,u=this.getVerbForStandardizedFeature(s),g=e===m.TA.FeatureActionType.IsTried||e===m.TA.FeatureActionType.IsKept||e===m.TA.FeatureActionType.IsRejected||void 0!==a,h=e===m.TA.FeatureActionType.IsTried||e===m.TA.FeatureActionType.IsKept||e===m.TA.FeatureActionType.IsRejected||void 0!==a;return[...m.TA.getFields({featureActionType:null==e?"":m.TA.FeatureActionType[e],isUserInitiated:!0,verb:u,featureName:c,subFeatureName:d,isThumbsUp:a,interactionId:g?o??A.userQueryGuid:"",conversationId:h?l??A.conversationId:"",entryPoint:i??A.currentEntryPoint}),...this.getDefaultEventDataFields(),...this.getDataFields([{key:"suggestionId",value:n??""},{key:"groundingMode",value:r??""}])]}getStandardizedFeatureForSubFeature(e){switch(e){case b.q.AnalyzeData:return b.BJ.AnalyzeData;case b.q.CalculatedColumns:case b.q.CalculatedRows:return b.BJ.FormulaGeneration;case b.q.Commanding:case b.q.OfficeJsCommanding:case b.q.ShowHeaders:case b.q.SmartHelp:case b.q.ConditionalFormattingSuggestion:return b.BJ.Commanding;case b.q.HandOff:return b.BJ.Handoff;case b.q.ImportDataFromSearch:return b.BJ.ImportData;case b.q.Search:return b.BJ.Search;case b.q.OfficeScripts:return b.BJ.OfficeScripts;case b.q.Python:return b.BJ.Python;case b.q.SelfHelp:return b.BJ.ChatQnA;case b.q.ChatPaneLoad:case b.q.ConvertToTable:case b.q.CopilotChat:case b.q.SampleData:case b.q.ContextInference:case b.q.InsertTable:return b.BJ.CopilotChat;case b.q.Else:return b.BJ.ExcelChatHelper;case b.q.CopyMessage:case b.q.ExternalTriggeredQuery:case b.q.UndoMessage:default:return this.logError({eventType:T.S.ChatEvents,errorMessage:`StandardizedFeature mapping error for: ${e}`,logLevel:b.$b.Error}),b.BJ.CopilotChat}}getUsageFeatureForStandardizedFeature(e){switch(e){case b.BJ.AnalyzeData:return b.q.AnalyzeData;case b.BJ.FormulaGeneration:return b.q.CalculatedColumns;case b.BJ.Commanding:return b.q.Commanding;case b.BJ.Handoff:return b.q.HandOff;case b.BJ.ImportData:return b.q.ImportDataFromSearch;case b.BJ.Search:return b.q.Search;case b.BJ.OfficeScripts:return b.q.OfficeScripts;case b.BJ.Python:return b.q.Python;case b.BJ.ChatQnA:return b.q.SelfHelp;case b.BJ.CopilotChat:return b.q.CopilotChat;case b.BJ.ExcelChatHelper:return b.q.Else;default:return this.logError({eventType:T.S.ChatEvents,errorMessage:`UsageFeature mapping error for: ${e}`,logLevel:b.$b.Error}),b.q.CopilotChat}}getVerbForStandardizedFeature(e){switch(e){case b.BJ.AnalyzeData:case b.BJ.Python:return b.uF.Analyze;case b.BJ.ChatQnA:case b.BJ.Search:return b.uF.Ask;case b.BJ.FormulaGeneration:case b.BJ.ImportData:return b.uF.Create;case b.BJ.Commanding:case b.BJ.OfficeScripts:return b.uF.Command;case b.BJ.CopilotChat:case b.BJ.ExcelChatHelper:case b.BJ.Handoff:return b.uF.UnknownIntent;default:(0,x.x)(!1,"Missing verb map.")}}logTelemetryEvent(e,t){const a={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?{...t,...this.getDefaultEventFlags()}:this.getDefaultEventFlags(),dataFields:[...this.getDefaultEventDataFields(),...this.getDataFields(e.eventData)]};this.sendTelemetryEvent(a)}getActionAITelemetryErrorEvent(e,t,a){return a||(a=[]),a.find((e=>"Message"===e.key))||a.push({key:"Message",value:e.errorMessage}),a.find((e=>e.key===b.xL.LogLevel))||a.push({key:b.xL.LogLevel,value:e.logLevel}),{eventName:"Office.Voice.ActionAI."+T.S.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?{...this.getDefaultEventFlags(),...t}:this.getDefaultEventFlags(),dataFields:[...this.getDefaultEventDataFields(),...this.getDataFields(a)]}}logTelemetryErrorEvent(e,t,a){this.oTelLogger.sendError(this.getActionAITelemetryErrorEvent(e,t,a))}getDataFields(e){return e.map((e=>"number"==typeof e.value?(0,g.ip)(e.key,e.value):"string"==typeof e.value?(0,g.m9)(e.key,e.value):"boolean"==typeof e.value?(0,g.LK)(e.key,e.value):(0,g.m9)(e.key,e.value)),[])}setupTelemetryLogger(e){e.setTenantToken("Office.Voice.ActionAI",E,R),e.setTenantToken("Office.Voice.Copilot",E,R),e.addSink(this.telemSink)}assertFeatureIsActive(e,t){if(e&&e!==this.getActiveFeature()&&this.getActiveFeature()!==b.BJ.CopilotChat){const a=t+" - feature: "+e+" activeFeature: "+this.getActiveFeature();this.logError({eventType:T.S.AssertionFailed,errorMessage:a,logLevel:b.$b.Error})}}constructor(){this.seenEvents=new Set,this.rejectedIds=new Set,this.alwaysCriticalEvents=null,this.heldTelemetryEvents=[],this.oTelLogger=new h.M,this.telemSink=new I,this.setupTelemetryLogger(this.oTelLogger)}}A.querySource=void 0,A.nextQuerySource=void 0,A.currentEntryPoint=void 0,A.userQueryGuid="",A.userQueryOrder=0,A.conversationId=void 0},41102:(e,t,a)=>{a.d(t,{$q:()=>D,E:()=>M,UC:()=>N,V1:()=>F,jl:()=>k,qD:()=>P,s6:()=>O});var n=a(47693),o=a(19433),r=a(31652),i=a(5550),l=a(92779),s=a(88179),c=a(61158),d=a(67001),u=a(96854),m=a(31030),g=a(48314),h=a(61150),p=a(50837),b=a(50347);const f="DefaultAugLoopSharedSessionID";let C,y,v,T="",x=0,S=0,w=()=>{};const E=(0,b.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelIncreaseCopilotCellLimit",!1),R=(0,b.Z8)("Microsoft.Office.Excel.FA000000124.MaxAugloopRestartsToAllowModelWorkflows",2),I=(0,b.Z8)("Microsoft.Office.Excel.FA000000124.AugloopRestartsTimeRangeInMs",12e4),A=e=>{const t=(0,p.wB)(e);return t.setSessionCloseCallback(L),t},L=e=>{(0,h.cY)("AugLoop session closing"),u.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.AugLoopSessionClosed},g.M.getInstance());const t=(0,b.yw)("OfficeVSO_8762671_AugLoopLimitedRetryModelWorkflows");C.close(),t&&(x=S&&_(S)<I?x+1:1,S=Date.now());let a=f;if(d.w9.typeGuard(e)&&e.reason&&d.pr.typeGuard(e.reason)&&e.reason.newDocSessionId)a=e.reason.newDocSessionId;else if(Office.context.platform!==Office.PlatformType.OfficeOnline){if(e.reason&&d.Zy.typeGuard(e.reason)&&"PermanentError"===e.reason?.reasonDescription)return void v();g.M.getInstance().logError({eventType:m.S.Augloop,errorMessage:"AugLoop failed to provide the new docSessionId.",logLevel:s.$b.Warning})}if(Office.context.platform===Office.PlatformType.OfficeOnline||a!==f){C=A(a);let n=!t;if(e.reason&&o.G2.typeGuard(e.reason)){const t=e.reason;n=E?t.errorType===r.m.LargeWorkbooksNotSupported:t.errorType===r.m.ModelWorkflowNotSupported}const i=x>R;n=n||i,n&&u.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.AugLoopSessionModelWorkflowUnsupported,[s.h3.ChatEventParameters]:JSON.stringify({restartLoopDetected:i})},g.M.getInstance()),w(C,n)}};const F=e=>{""===T&&(T=e)},_=e=>Date.now()-e,N=e=>{y=e},k=e=>{w=e},O=e=>{v=e},P=async()=>{if((0,h.cY)("getting AugLoop from host"),!C){if((0,h.cY)("sdxAugLoopSession does not exist, creating a new one"),i.Vv.IsSettingTrue(i.zj.ButtonEnabledForLocalFiles)){if(""===T)return Promise.reject(new Error("getAugLoopSessionFromHost called before DocSessionID provided by host"));C=A(T)}else{const e=i.Vv.getSettingAsString(i.zj.AugloopSharedSessionID);C=A(e??f)}await y(C),(0,b.yw)("OfficeVSO_9503894_AugloopDiagnosticsPane")&&((0,i.I_)()||l.MYv)&&n.$.getInstance().init(C)}return C},M=e=>void 0===e?"undefined":c.h.getTypeNameFor(e),D=()=>i.Vv.IsSettingTrue(i.zj.AugloopEverHadModelError)},25549:(e,t,a)=>{var n,o;a.d(t,{w:()=>n,x:()=>o}),function(e){e.CannedResponse="annrules",e.ElseSkillName="excel_else",e.GetInsightsName="get_insights",e.SelfHelpSkillName="self_help_search",e.CalculatedColumnsName="calculated_columns",e.CreateCalculatedColumnsName="create_calculated_columns",e.EditDocumentName="edit_document",e.SearchEnterpriseName="search-enterprise",e.OfficeScriptsName="office_scripts",e.PythonSkillName="get_python_code",e.PythonCalculatedColumnsName="python_calculated_columns",e.GenerateResponseName="generate_response",e.AugLoopEvalName="AugmentationLoopEval",e.AugLoopName="AugmentationLoop",e.GetContextName="get_context",e.Workflow="workflow",e.DeepLeo="DeepLeo",e.SearchToolsRequestInterstitialsPublisher="SearchToolsRequestInterstitialsPublisher",e.SearchToolsResponseInterstitials="SearchToolsResponseInterstitials",e.Unknown="Unknown"}(n||(n={})),function(e){e.QuickAnswer="QuickAnswer",e.HelpArticle="HelpArticle"}(o||(o={}))},45283:(e,t,a)=>{a.d(t,{r:()=>n});class n{static generateId(){return n.operationId++,"AugLoop-ChatExcel-"+n.operationId.toString()}}n.operationId=0},72746:(e,t,a)=>{a.d(t,{O:()=>n});const n=(0,a(98483).A)()},4475:(e,t,a)=>{a.d(t,{H0:()=>ne,Kv:()=>be,Oy:()=>Le,J3:()=>Re,z3:()=>Ce,vu:()=>ge,AH:()=>ue,zY:()=>Ie,E_:()=>xe,A6:()=>Se,AU:()=>we,JE:()=>pe,NQ:()=>me,yo:()=>Ee,FW:()=>ce,yq:()=>de,zL:()=>he,s_:()=>Ae});var n=a(92779),o=a(27982),r=a(90922),i=a(36130),l=a(28087),s=a(33500),c=a(36199),d=a(64934),u=a(86691),m=a(45857),g=a(88700),h=a(29328),p=a(25083),b=a(88989),f=a(89099),C=a(24220),y=a(72483),v=a(61437),T=a(49134),x=a(77303),S=a(19080),w=a(88179),E=a(825),R=a(41679),I=a(65624),A=a(94773),L=a(26170),F=a(96854),_=a(31030),N=a(48314),k=a(6925),O=a(23147),P=a(61150),M=a(27626),D=a(50347),$=a(49437),B=a(41485);async function H(e,t,a,o){const r=function(){const e=(0,$.P)("LaunchOfficeScriptsSDXOptionalProperties");if(!e)throw new Error("LaunchOfficeScriptsSDXOptionalProperties is undefined");let t;try{const a=JSON.parse(e);t=JSON.parse(a?.devProperties?.DocumentHostInfo)}catch{throw new L.Q0("Unable to parse DocumentHostInfo.")}if(!t.ClientUrl)throw new L.Q0("Object does not contain a 'ClientUrl'.");return t}().ClientUrl,i=await(0,B.Jv)(r,o),l=r.split("/").filter((e=>""!==e)),s=l.length>=2?"/"+l.slice(-2).join("/"):"",c=decodeURIComponent(s);return{properties:{categoryNames:["diet"],summary:"On a recurring basis, run an Office Script on an Excel workbook.",description:"On a recurring basis, run an Office Script on an Excel workbook.",author:{displayName:"Microsoft",source:"Microsoft"},metadata:{dietDesignerMarkup:{showParameterWithValue:{Recurrence:["frequency","interval","StartTime"]},parameterLabelOverrides:[{operationNodeId:"recurrence",parameterName:"interval",label:(0,n.s2u)()},{operationNodeId:"recurrence",parameterName:"StartTime",label:(0,n.nPU)()}],parameterDisplayInlineOverrides:[{operationNodeId:"recurrence",parameterName:"frequency",displayInline:!0},{operationNodeId:"recurrence",parameterName:"interval",displayInline:!0}]}},definition:{$schema:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",contentVersion:"1.0.0.0",parameters:{$connections:{defaultValue:{},type:"Object"},$authentication:{defaultValue:{},type:"SecureObject"}},triggers:{Recurrence:{recurrence:a,type:"Recurrence"}},actions:{Run_script:{runAfter:{},metadata:{[i.fileId]:c,[e]:t},type:"OpenApiConnection",inputs:{host:{apiId:"/providers/Microsoft.PowerApps/apis/shared_excelonlinebusiness",connectionName:"shared_excelonlinebusiness",operationId:"RunScriptProd"},parameters:{source:i.locationId,drive:i.driveId,file:i.fileId,scriptId:e},authentication:"@parameters('$authentication')"}}}},connectionReferences:{shared_excelonlinebusiness:{api:{id:"/providers/Microsoft.PowerApps/apis/shared_excelonlinebusiness"},source:"NotSpecified",connectionNamingMode:"NotSpecified"}}}}}var U=a(25594),q=a(95800),V=a(18700),G=a(59503);async function W(e,t,a){return t(k.mF.startExecutingAndLockContext(w.OP.InsertTable)),await async function(e,t,a){const n=[];try{let o;const r=(0,V.me)(e);if(await e.sync(),r())o=e.workbook.worksheets.getActiveWorksheet();else{const t=(0,q.d)(e);await e.sync();const a=await t()(e);n.push(a.undo),o=a.result}a(o);const i=(0,q.x)(e,o),l=await i()(e);return n.push(l.undo),await t(k.mF.stopExecutingAndReleaseContextLock()),o.m_name}catch(e){throw await t(k.mF.stopExecutingAndReleaseContextLock()),await(0,G.q)(n),e}}(a,t,(t=>function(e,t){const a=t.rows.length,n=t.headers.length,o=a+1;if(0===n)throw new Error("Parsed table has no columns");const r=e.getRangeByIndexes(0,0,o,n);r.numberFormat=(0,D.yw)("OfficeVSO_9297500_CopilotSDXInsertTableFormatAsGeneral")?[["General"]]:[["@"]];const i=[t.headers,...t.rows.map((e=>e.cells.map((e=>e.value))))];r.values=i,e.tables.add(r,!0),r.select(),r.format.autofitColumns()}(t,e)))}var z=a(94836),Q=a(2117),J=a(91918);async function j(e){const t=function(e){const t=(0,$.P)("LaunchOfficeScriptsSDXOptionalProperties");let a;if(t){const n=JSON.parse(t);a={DevProperties:n.devProperties,OptionalProperties:n.optionalProperties},a.DevProperties.Destination="Details",a.DevProperties.Source="Copilot",a.DevProperties.UnconditionalForceRefresh="",a.DevProperties.Script=JSON.stringify(e),a.DevProperties.CodeEditorUrl=Y(),a.DevProperties.IsOwner=!0,a.OptionalProperties.SourceLocationOverrideResourceId=Y()}else a={OptionalProperties:{TaskPaneTitle:"Office Scripts",TaskPaneWidth:360,SourceLocationOverrideResourceId:Y(),HeaderCssClass:"ewa-ptp-header-maker",TitleCssClass:"ewa-ptp-title-maker-react"},DevProperties:{Script:JSON.stringify(e),CodeEditorUrl:Y(),StorageModePreference:(0,Q.o8)(),Source:"ExcelCopilot",Destination:"Details",CopilotEnabled:"true",wacFlights:JSON.stringify({CopilotSaveAutomation:(0,D.av)()}),UnconditionalForceRefresh:""}};return a}(e);await X("FA000000043",t.OptionalProperties,t.DevProperties)}function Y(){switch((0,J.A)()){case"Dogfood":case"Microsoft":return"CodeEditor.URL";default:return"ProdCodeEditor.URL"}}async function X(e,t,a={}){if(!Office?.context?.extensionLifeCycle?.launchExtensionComponent)throw new Error("Unable to launch taskpane. 'Office.context.extensionLifeCycle.launchExtensionComponent' is not defined");const n={extId:{Id:e,StoreId:"sdxcatalog",StoreType:"sdxcatalog",AppVersion:"1.0.0"},componentType:"Taskpane",componentId:e,hostProperties:{HostType:"Excel-Online",FormFactor:"Desktop",Locale:Office.context.displayLanguage},optionalProperties:{DevProperties:a,OptionalProperties:t}};await Office.context.extensionLifeCycle.launchExtensionComponent(n.extId,n.componentType,n.componentId,n.hostProperties,n.optionalProperties)}var K=a(90219);function Z(e){return!isNaN(Number(e))}function ee(e,t){var a;Z(e)?t.cellFormatType.number++:"true"===(a=e).toLowerCase()||"false"===a.toLowerCase()?t.cellFormatType.boolean++:!function(e){return e.startsWith("=")}(e)?!function(e){return e.includes("http://")||e.includes("https://")}(e)?!function(e){return e.startsWith("$")||e.startsWith("Â£")||e.startsWith("â‚¬")||e.startsWith("Â¥")||e.startsWith("â‚¹")||e.startsWith("â‚½")}(e)?!function(e){return!(e.length<8)&&(!Z(e)&&(/^(0?[1-9]|1[0-2])[./](0?[1-9]|[12][0-9]|3[01])[./]\d{4}$/.test(e)&&!isNaN(Date.parse(e))))}(e)?t.cellFormatType.string++:t.cellFormatType.date++:t.cellFormatType.currency++:t.cellFormatType.linkCount++:t.cellFormatType.formula++}function te(e,t){const a={headers:[""],rows:[]};return e(t).find("li").each(((t,n)=>{const o={value:""},r={cells:[]};ae(e,n,o),r.cells.push(o),a.rows.push(r)})),a}function ae(e,t,a,n=void 0){const o=/^\^\d+\^$/g;e(t).find("a").each(((t,r)=>{e(r).text().match(o)?(n&&n.citationsCount++,e(r).remove()):(n&&n.hyperlinkCount++,a.hyperlink=e(r).attr("href"))})),a.value=e(t).text().trim()}var ne,oe=a(95789),re=a(71362),ie=a(70364),le=a(79029);function se(){return{type:o.jA.Default,title:(0,n.sUU)(),text:(0,z.dD)()?void 0:(0,n.sUU)(),iconRegular:c.t2R,iconHover:c.JL$}}function ce(e,t,a,n=[]){return de((async()=>{await(0,ie.tN)(e),a&&a()}),e,t,n)}function de(e,t,a,o=[]){const r=N.M.userQueryGuid;return{...se(),handleButtonOnClick:async()=>{const i=N.M.getInstance();i.logRejectedEvent(t,a),i.logEvent((0,w.SV)(w.he.Undo,t,w.KZ.UndoButton,a,r));let{message:c,telemetry:d}=function(){const e={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Human,messageHeader:{text:n.xe2.ActionButtonUndo}}}},t={featureName:w.q.UndoMessage,eventType:w.a5.ActionConfirmationMessage};return{message:e,telemetry:t}}();y.$.getInstance().displayResponse(c,d),await e(t),Ae("RemoveUndo"),({message:c,telemetry:d}=function(e=[]){const t={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:n.xe2.ActionButtonUndoSuccessMessage}}},chatMessageBodyData:{actionButtonList:e}},a={featureName:w.q.UndoMessage,eventType:w.a5.ActionConfirmationMessage};return{message:t,telemetry:a}}(o)),y.$.getInstance().displayResponse(c,d)}}}function ue(e,t){return{title:(0,n.wW0)(),text:(0,n.wW0)(),type:o.jA.Default,handleButtonOnClick:()=>{Excel.run((async a=>{try{const n=a.workbook.worksheets.getItemOrNullObject(e);if(await a.sync(),n.isNullObject)return;n.activate(),n.getRange(t).select(),await a.sync()}catch{}}))},isDisabled:!1}}async function me(e,t,a,i){const l=N.M.userQueryGuid;let s;if(t!==R.jy.Recurrence)throw new L.Q0(`Unknown schedule type ${t}`,L.y3.unknownScheduleType);return s=await H(e.id,e.name,a,i),{type:o.jA.Default,title:(0,n.XKD)(),text:(0,z.dD)()?void 0:(0,n.XKD)(),iconRegular:(0,z.dD)()?d.FQP:d.EO2,iconHover:(0,z.dD)()?d.NDW:d.Ov,handleButtonOnClick:async()=>{const e=N.M.getInstance();(0,D.BT)()?le.B.getInstance().logKeptEvent(w.BJ.OfficeScripts,w.q.OfficeScripts,r.RX.Command):e.logKeptEvent(w.q.OfficeScripts),e.logEvent((0,w.SV)(w.he.ScheduleScriptClicked,w.q.OfficeScripts,w.KZ.ScheduleScriptButton,i,l)),async function(e){const t=(0,$.i)();t.Script=void 0,t.FlowCreated=!0;const a={LaunchSource:"ExcelCopilot",TemplateDefinition:e,CopilotPAIntegration:(0,D.L)(),CopilotSDXLaunchDevProps:JSON.stringify(t)};await X("FA000000113",{SourceLocationOverrideResourceId:"ProdPowerAutomate.URL"},a)}(JSON.stringify(s))}}}function ge(e,t,a){const r=N.M.userQueryGuid;return{type:o.jA.Default,title:(0,n.Xlr)(),text:(0,z.dD)()?void 0:(0,n.Xlr)(),iconRegular:(0,z.dD)()?u.aYy:u.va_,iconHover:(0,z.dD)()?u.i00:u.TTy,handleButtonOnClick:async()=>{const o=N.M.getInstance();o.logRejectedEvent(e,a),o.logEvent((0,w.SV)(w.he.DeleteScript,e,w.KZ.DeleteScriptButton,a,r));const i=y.$.getInstance(),{message:l,telemetry:s}=re.n.getOfficeScriptSimpleResponse((0,n.Xlr)(),w.a5.DeleteScriptClicked);i.displayResponse(l,s),await async function(e){const t=y.$.getInstance();try{const a=new E.L,n=I.H.getInstance();await a.removeScriptShim(e),n.popScript();const o={operationName:"Delete",scriptMetadata:e};(0,oe.q)(o);const{message:r,telemetry:i}=re.n.getOfficeScriptDeleteScriptSuccessResponse(e.name);t.displayResponse(r,i)}catch(a){N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Remove script failed",logLevel:w.$b.Warning});const{message:n,telemetry:o}=re.n.getOfficeScriptDeleteScriptErrorResponse(e);t.displayResponse(n,o)}}(t),Ae("RemoveUndo")}}}function he(e){return{type:o.jA.Default,title:(0,n.H2U)(),text:(0,z.dD)()?void 0:(0,n.H2U)(),iconRegular:(0,z.dD)()?m.y_M:m.Fr0,iconHover:(0,z.dD)()?m.iKN:m.Pdb,position:(0,z.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:async()=>{N.M.getInstance().logEvent((0,w.SV)(w.he.ViewScript,w.q.OfficeScripts,w.KZ.ViewScriptButton,void 0,N.M.userQueryGuid)),j(e)},popoverProps:{popoverTitle:(0,n.H2U)()}}}function pe(e,t,a){return{type:o.jA.Default,title:(0,n.Rp5)(),text:(0,z.dD)()?void 0:(0,n.Rp5)(),iconRegular:(0,z.dD)()?m.osE:m.jFZ,iconHover:(0,z.dD)()?m.WlZ:m.fml,position:(0,z.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:async()=>{const o=N.M.getInstance();(0,D.BT)()?le.B.getInstance().logKeptEvent(w.BJ.OfficeScripts,w.q.OfficeScripts,r.RX.Command):o.logKeptEvent(w.q.OfficeScripts),o.logEvent((0,w.SV)(w.he.SaveScript,w.q.OfficeScripts,w.KZ.SaveScriptButton,void 0,N.M.userQueryGuid));const i=y.$.getInstance(),{message:l,telemetry:s}=re.n.getOfficeScriptSimpleResponse((0,n.Rp5)(),w.a5.SaveScriptClicked);i.displayResponse(l,s),a(k.mF.startExecutingCommand({command:w.OP.SaveOfficeScripts}));const c=await(0,R.fS)(e,t);if(c){Ae("RemoveSaveScript"),v.Z.getInstance().setShowUndoButton(!0);const{message:e,telemetry:t}=re.n.getSavedScriptCompletedResponse(c,!0);i.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),a(k.mF.stopExecuting({isSuccess:!0}))}else{const{message:e,telemetry:t}=re.n.getOfficeScriptErrorResponse((0,n.CPY)(),A.m.SaveScript);i.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),a(k.mF.stopExecuting({isSuccess:!1}))}},popoverProps:{popoverTitle:(0,n.Rp5)()}}}!function(e){e.DisableUndo="DisableUndo",e.RemoveUndo="RemoveUndo",e.RemoveGoBackToTable="RemoveGoBackToTable",e.RemoveExplain="RemoveExplain",e.RemoveSaveScript="RemoveSaveScript",e.RemoveAll="RemoveAll",e.EnableApply="EnableApply",e.ImportData="ImportData",e.InsertToNewSheet="InsertToNewSheet"}(ne||(ne={}));const be=async(e,t,a)=>{(0,P.cY)("Copy button clicked"),N.M.getInstance().logEvent((0,w.SV)(w.he.CopyMessageClicked,w.q.CopyMessage,void 0,void 0,N.M.userQueryGuid));try{await(0,i.Cu)(e)}catch(e){(0,P.cY)("Error copying html to clipboard",e.message),N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Error copying html to clipboard "+e.message,logLevel:w.$b.ASHA}),N.M.getInstance().logStandardizedAshaErrorEvent(C.W.Unable_To_Complete_Task,f.c.Failed_To_Copy_Response,w.BJ.CopilotChat)}};function fe(e){return{title:n.xxz.CopyButtonLabel,text:e&&!(0,z.dD)()?n.xxz.CopyButtonLabel:void 0,iconRegular:(0,z.dD)()?g.c2D:g.Jg_,iconHover:(0,z.dD)()?g.cAv:g.Z1B,popoverProps:{popoverTitle:n.xxz.CopyButtonPopover}}}function Ce(e=!0){return{type:o.jA.Default,...fe(e),position:(0,z.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:be}}function ye(){return{type:o.jA.Default,title:(0,n.J40)(),text:(0,z.dD)()?void 0:(0,n.J40)(),iconRegular:h.rz9,iconHover:h.dLz}}function ve(e,t,a,o,r=[]){t(k.mF.appliedChangesOnWorkbook({caller:e?"InsertList":"InsertTable",numberOfTables:a.length})),F.E.getInstance().updateTelemetryChatEventData({[w.h3.ChatEventType]:w.a5.InsertingListsFromResponse,[w.h3.ChatEventParameters]:JSON.stringify({numberOfTables:a.length,tablesStatistics:r})},N.M.getInstance());let i=(0,n.CLD)();1===a.length&&o?i=(0,n.Yyo)().replace("{0}",o):a.length>1&&(i=(0,n.IKl)().replace("{0}",a.length.toString()));const{message:l,telemetry:s}=re.n.getInsertTableSuccessResponse(i);y.$.getInstance().displayResponse(l,s),N.M.getInstance().logEvent((0,w.SV)(e?w.he.InsertListSuccess:w.he.InsertTableSuccess,e?w.q.InsertList:w.q.InsertTable,void 0,void 0,N.M.userQueryGuid))}async function Te(e,t){N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Error in handle insert table click"+e.message,logLevel:w.$b.ASHA}),(0,D.yw)("OfficeVSO_9260802_ActionBarButtonReleaseLock")&&await t(k.mF.stopExecutingAndReleaseContextLock()),N.M.getInstance().logStandardizedAshaErrorEvent(C.W.Unable_To_Complete_Task,f.c.Failed_To_Insert_Table,w.BJ.CopilotChat);const{message:a,telemetry:o}=re.n.getInsertTableErrorResponse((0,n.LLM)());y.$.getInstance().displayResponse(a,o)}function xe(e,t,a,r){return N.M.getInstance().logEvent((0,w.SV)(w.he.ImportDataButtonShowed,w.q.ImportDataFromSearch,void 0,void 0,t)),(0,D._K)()?le.B.getInstance().logSeenEvent(w.q.ImportDataFromSearch):N.M.getInstance().logSeenEvent(w.q.ImportDataFromSearch),{type:o.jA.Default,title:(0,n.OS6)(),text:(0,z.dD)()?void 0:(0,n.OS6)(),iconRegular:p.$7G,iconHover:p.B5Q,handleButtonOnClick:async(n,o,i)=>{N.M.getInstance().logEvent((0,w.SV)(w.he.ImportDataButtonClicked,w.q.ImportDataFromSearch,void 0,void 0,t)),(0,U.yU)(e,t,r,(0,x.Q9t)(a)),Ae("ImportData")}}}function Se(e){return N.M.getInstance().logEvent((0,w.SV)(w.he.InsertListShowed,w.q.InsertList,void 0,void 0,N.M.userQueryGuid)),{...ye(),handleButtonOnClick:async(t,a,n)=>{N.M.getInstance().logEvent((0,w.SV)(w.he.InsertListClicked,w.q.InsertList,void 0,void 0,N.M.userQueryGuid));try{if(Ae("InsertToNewSheet"),!t)throw(0,P.cY)("No messageContentElementId"),N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Error in handle insert list click, no messageContentElementId",logLevel:w.$b.Warning}),new Error("No messageContentElementId");const a=function(e){const t=(0,K.load)(e),a=[];return t("ul").each(((e,n)=>{const o=te(t,n);a.push(o)})),t("ol").each(((e,n)=>{const o=te(t,n);a.push(o)})),a}((0,i.cj)(t));let n;await(0,ie.F5)((async t=>{for(let o=0;o<a.length;o++){const r=a[o];0!==r.headers.length&&0!==r.rows.length?n=await W(r,e,t):N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Error in handle insert list click, empty lists is invalid",logLevel:w.$b.Error})}})),ve(!0,e,a,n)}catch(t){await Te(t,e)}}}}function we(e){return N.M.getInstance().logEvent((0,w.SV)(w.he.InsertTableShowed,w.q.InsertTable,void 0,void 0,N.M.userQueryGuid)),{...ye(),handleButtonOnClick:async(t,a,n)=>{N.M.getInstance().logEvent((0,w.SV)(w.he.InsertTableClicked,w.q.InsertTable,void 0,void 0,N.M.userQueryGuid));try{if(Ae("InsertToNewSheet"),!t)throw(0,P.cY)("No messageContentElementId"),N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Error in handle insert table click, no messageContentElementId",logLevel:w.$b.Warning}),new Error("No messageContentElementId");const a=function(e){const t=(0,K.load)(e),a=[],n=[];return t("table").each(((e,o)=>{const r=[],i=[],l={columns:0,rows:0,citationsCount:0,hyperlinkCount:0,cellFormatType:{date:0,number:0,boolean:0,formula:0,string:0,currency:0,linkCount:0},cellStyleType:{bold:0}};t(o).find("thead th").each(((e,a)=>{r.push(t(a).text().trim())})),t(o).find("tbody tr").each(((e,a)=>{const n={cells:[]};t(a).find("td").each(((e,a)=>{const o={value:""};ae(t,a,o,l),t(a).find("strong").each(((e,t)=>{l.cellStyleType.bold++})),ee(o.value,l),n.cells.push(o)})),i.push(n)})),l.columns=r.length,l.rows=i.length,n.push(l),a.push({headers:r,rows:i})})),{tables:a,tablesStatistics:n}}((0,i.cj)(t)),n=a.tables;let o;await(0,ie.F5)((async t=>{for(let a=0;a<n.length;a++){const r=n[a];0!==r.headers.length?o=await W(r,e,t):N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:"Error in handle insert table click, empty table headers is invalid",logLevel:w.$b.Error})}})),ve(!1,e,n,o,a.tablesStatistics)}catch(t){await Te(t,e)}}}}function Ee(e){const t="Dev";return{type:o.jA.Default,title:t,text:(0,z.dD)()?void 0:t,iconRegular:h.SFT,iconHover:h.qTo,handleButtonOnClick:async(a,n,o)=>{(0,P.cY)(`Show Dev Detail Button Clicked for message ID: ${e}`);const r=y.$.getInstance().getChatLog().find((t=>t?.chatMessageBodyData?.messageId===e));if(!r)return;r.startAugloopTimerForStreaming=!1;let i=o;if(o||(i=r?.chatMessageBodyData?.telemetryData),!i)return;try{const e=JSON.parse(i);if(r?.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData){const t=JSON.parse(r.chatMessageBodyData.feedbackData.contextData.cardMetaData);t.promptId&&(e.promptId=t.promptId)}i=JSON.stringify(e,null,2)}catch(e){}const c=(e,a)=>{if(e.chatMessageBodyData?.actionButtonList){if(!e.chatMessageBodyData?.messageId)return;e.chatMessageBodyData.actionButtonList=e.chatMessageBodyData.actionButtonList.filter((e=>e.title!==t)),a&&y.$.getInstance().updateMessage(e)}},d=r.chatMessageData?.defaultMessageProps;if(d?.messageHeader?.text)return d.messageHeader.text+=`\n\n ${i}`,c(r,!1),void y.$.getInstance().updateMessage(r);const u=r.chatMessageData?.markDownCardProps;if(u?.message){u.message+=`\n\n ${i}`,c(r,!1);const e=r.chatMessageBodyData;return e?.feedbackSectionPosition&&(e.feedbackSectionPosition=S.O.Footer,e.shouldShowAIGeneratedIndicator=!0),void y.$.getInstance().updateMessage(r)}const m={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:i}}},addCardToChatHistory:!1};c(r,!0),y.$.getInstance().displayResponse(m)}}}function Re(e,t){const a=(0,n.FA0)();return{type:o.jA.Default,title:a,text:a,iconRegular:b.ZwM,iconHover:b.XWm,handleButtonOnClick:async()=>{try{const{message:a,telemetry:n}=(0,M.b7)();y.$.getInstance().displayResponse(a,n),await(0,M.iT)(e,t)}catch(e){N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:`$"Error in auto fix button" ${e.message}`,logLevel:w.$b.Error})}}}}function Ie(e){const t=(0,n.vG7)(),a="Error in go back to data button";return{type:o.jA.Default,title:t,text:t,handleButtonOnClick:async()=>{try{await Excel.run((async t=>{if(!e)return void N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:`${a}, no tableContext`,logLevel:w.$b.Warning});const n=T.ExcelCalc.IExcelRangeToAddress(e.sheetRange.range);t.workbook.worksheets.getItem(e.sheetRange.sheet).getRange(n).select(),await t.sync()}))}catch(e){N.M.getInstance().logError({eventType:_.S.ChatEvents,errorMessage:a,logLevel:w.$b.ASHA})}}}}function Ae(e){const t=y.$.getInstance().getLastMessage();if(!t?.actionBarButtons?.length)return;const a=[...t.actionBarButtons];let o=t.strikeThroughText,r=!1;const i=a.findIndex((e=>e.title===(0,n.sUU)())),l=a.findIndex((e=>e.title===(0,n.ZvH)())),s=a.findIndex((e=>e.title===(0,n.f7s)())),c=a.findIndex((e=>e.title===(0,n.H2U)())),d=a.findIndex((e=>e.title===(0,n.Rp5)())),u=a.findIndex((e=>e.title===(0,n.yZI)())),m=a.findIndex((e=>e.title===(0,n.OS6)())),g=a.findIndex((e=>e.title===(0,n.J40)()));switch(e){case"EnableApply":-1!==u&&(a[u].isDisabled=!1,r=!0);break;case"DisableUndo":(0,D.yw)("OfficeVSO_9343910_XlimCachingForUndo")&&O.CP.clearCachedTableInterpretationsForUndo(),-1!==i&&(a[i]={...se(),isDisabled:!0,handleButtonOnClick:()=>{}},r=!0);break;case"RemoveUndo":(0,D.yw)("OfficeVSO_9343910_XlimCachingForUndo")&&O.CP.clearCachedTableInterpretationsForUndo(),-1!==i&&(a.splice(i,1),o=!0,r=!0,-1!==c&&a.splice(c,1));break;case"RemoveSaveScript":-1!==d&&a.splice(d,1);break;case"RemoveGoBackToTable":-1!==l&&(a.splice(l,1),r=!0);break;case"RemoveExplain":-1!==s&&(a.splice(s,1),r=!0);break;case"RemoveAll":a.length=0,r=!0;break;case"ImportData":-1!==m&&(a.splice(m,1),r=!0);break;case"InsertToNewSheet":-1!==g&&(a.splice(g,1),r=!0)}r&&y.$.getInstance().updateLastMessage({chatCardType:t.messageType,chatMessageBodyData:{actionButtonList:[...a],strikeThroughText:o},addCardToChatHistory:!1})}function Le(e,t){const a=[...e];return(0,D.jH)()&&a.push(Ee(t)),a}},27626:(e,t,a)=>{a.d(t,{b7:()=>w,ge:()=>E,iT:()=>I});var n=a(8348),o=a(28087),r=a(19080),i=a(33500),l=a(72483),s=a(49134),c=a(92779),d=a(93772),u=a(88179),m=a(82623),g=a(31030),h=a(48314),p=a(23147),b=a(4475),f=a(33540),C=a(95674),y=a(55143),v=a(50347),T=a(98483),x=a(61150);const S=1e3;function w(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,c.FA0)()}}}},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.HumanInput}}}async function E(e,t){let a=(0,f.kw)(t);t&m.ye.EmptyHeaders&&(a=a.filter((e=>e!==m.ye.DuplicateHeaders)));const n=(await Promise.all(a.map((async e=>await(0,f.xl)(e))))).filter((e=>!!e.header&&!!e.description));0===n.length&&h.M.getInstance().logError({eventType:g.S.AutoFixTLR,errorMessage:"Missing data for AutoFixMarkdownResponse",logLevel:u.$b.Warning},void 0,[{key:"Source",value:JSON.stringify(a)}]);return function(e,t,a,n,l){const c=(0,T.A)(),u=e.map((e=>`- **${e.header}**: ${e.description}`)).join("\n");let m=l;return m&&s.ExcelCalc.isSheetAddress(l)||(m=p.CP.getActiveTable()?.address||m),p.CP.setHumanInTheLoopRange((0,C.r)(m)),{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{message:`${t}\n\n${u}\n\n${a}`,user:i.Q9.Chat}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:d.Xw.CONTEXT},shouldShowFeedbackSection:!0,messageId:c,actionButtonList:(0,b.Oy)([(0,b.J3)(n,m)],c)},addCardToChatHistory:!0}}(n,(1===n.length?(0,c.$TB)():(0,c.S7l)()).replace("{range}",(0,y.G2)(e)),(0,c.VH3)(),t,e)}function R(e,t){const a=(0,f.kw)(e);switch(t){case n.Xs.Success:return function(e){const t=(0,T.A)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:d.Xw.CONTEXT},shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,b.Oy)([(0,b.FW)(u.q.ContextInference)],t)},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.ActionConfirmationMessage}}}((0,f.TF)(a));case n.Xs.Unsuccessful:return function(e){const t=(0,T.A)();return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:d.Xw.CONTEXT},shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,v.jH)()?[(0,b.yo)(t)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.TabularRangeAutoFixFailed,errorType:u.q0.TlrAutofixError}}}((0,f.ie)(a));case n.Xs.NoChangeMade:default:return function(){const e=(0,T.A)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,c.GRk)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:d.Xw.CONTEXT},shouldShowFeedbackSection:!0,messageId:e,actionButtonList:(0,v.jH)()?[(0,b.yo)(e)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.TabularRangeNoAutoFixApplied}}}()}}async function I(e,t){await p.CP.runWithContextRefreshAndLoader((async()=>{const a=performance.now(),o=await(0,n.Be)(t),r=performance.now()-a,i=S-r;i>0&&await(0,x.uk)(i);const{message:s,telemetry:c}=R(e,o);l.$.getInstance().displayResponse(s,c),p.CP.setHumanInTheLoopRange(void 0)}),u.OP.ApplyTLRAutoFix)}},72587:(e,t,a)=>{a.d(t,{AU:()=>rt,uS:()=>it,YV:()=>lt,g$:()=>ct,yT:()=>nt});var n=a(28679),o=a.n(n),r=a(22180),i=a.n(r),l=a(87720),s=a.n(l),c=a(34159),d=a.n(c),u=a(11843),m=a.n(u),g=a(79216),h=a.n(g),p=a(83348),b={};b.styleTagTransform=h(),b.setAttributes=d(),b.insert=s().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=m();o()(p.A,b);p.A&&p.A.locals&&p.A.locals;var f=a(92494),C={};C.styleTagTransform=h(),C.setAttributes=d(),C.insert=s().bind(null,"head"),C.domAPI=i(),C.insertStyleElement=m();o()(f.A,C);f.A&&f.A.locals&&f.A.locals;var y=a(10211),v=a(47691),T=a(50751),x=a(92782),S=a(658);const w={swatch:{stroke:(0,x.Q)(T.eL).black}},E=(0,S.n)(w);var R=a(8520);var I=a(96710),A=a(99737),L=a(92779),F=a(92716),_=a(88179),N=a(83197),k=a(81933);const O={width:"90px",height:"20px",border:"1px solid rgb(210, 208, 206)",borderRadius:"1px",borderWidth:"medium",fontSize:"12px",textAlign:"center",verticalAlign:"middle",fontWeight:"normal",fontStyle:"normal",textDecorationLine:"none",textDecorationStyle:"solid",backgroundColor:"white"},P={width:"72px",height:"16px",border:"1px solid rgb(210, 208, 206)",borderRadius:"1px",display:"flex",padding:"0.5px",flexDirection:"row"},M={background:"linear-gradient(to right, rgb(99, 142, 198), white)",width:"80%",border:"0.7px solid rgb(99, 142, 198)"},D=e=>{const t=e.IsTextDoubleUnderlined||e.IsTextUnderlined,a=e.BorderFormat.LineStyle,n=e.BorderFormat.Color;let o="rgb(210, 208, 206)",r="solid",i="medium";if(void 0!==a[0]){const e=(0,N.Cn)(n[0]);o=(0,N.S)(e),r=U(a[0]),i=H(a[0])}return{...O,backgroundColor:e.BackgroundColor?e.BackgroundColor:"white",color:e.TextColor,fontWeight:e.IsTextBold?"bold":"normal",fontStyle:e.IsTextItalic?"italic":"normal",textDecorationLine:`${e.IsTextStrikethrough?"line-through":""} ${t?"underline":""}`.trim(),textDecorationStyle:e.IsTextDoubleUnderlined?"double":void 0,border:`1px ${r} ${o}`,borderWidth:i}},$=(e,t,a)=>{let n;return n=null!=a?`linear-gradient(90deg, ${e} 0%, ${a} 50%, ${t} 100%)`:`linear-gradient(90deg, ${e} 0%, ${t} 100%)`,{...O,background:n}},B=(e,t)=>{let a;return a=t?`linear-gradient(to right, ${e}, white)`:`${e}`,{...M,background:a}},H=e=>{switch(e){case k.BorderLineStyle.Thin:return"thin";case k.BorderLineStyle.Thick:return"thick";case k.BorderLineStyle.Medium:return"medium";default:return"thin"}},U=e=>{switch(e){case k.BorderLineStyle.None:return"";case k.BorderLineStyle.Thin:case k.BorderLineStyle.Medium:case k.BorderLineStyle.Thick:case k.BorderLineStyle.Double:case k.BorderLineStyle.Hair:return"solid";case k.BorderLineStyle.Dotted:return"dotted";case k.BorderLineStyle.Dashed:case k.BorderLineStyle.DashDot:case k.BorderLineStyle.DashDotDot:case k.BorderLineStyle.MediumDashed:case k.BorderLineStyle.MediumDashDot:case k.BorderLineStyle.MediumDashDotDot:case k.BorderLineStyle.SlantDashDot:return"dashed";default:return"solid"}};var q=a(46835),V=a(98226),G=a(78686);a(83488);const W=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1865 954 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"}),R.createElement("path",{className:"OfficeIconColors_m21",d:"M 832 1856 v -1227 l -506 506 l -181 -181 l 815 -815 l 815 815 l -181 181 l -506 -506 v 1227 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"})),z=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 2048 2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 966 1865 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"}),R.createElement("path",{className:"OfficeIconColors_m21",d:"M 64 832 h 1227 l -506 -506 l 181 -181 l 815 815 l -815 815 l -181 -181 l 506 -506 h -1227 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"})),Q=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 2048 2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 55 966 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"}),R.createElement("path",{className:"OfficeIconColors_m21",d:"M 1088 64 v 1227 l 506 -506 l 181 181 l -815 815 l -815 -815 l 181 -181 l 506 506 v -1227 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"})),J=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 512 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 l 848 848 v -619 z"}),R.createElement("path",{className:"OfficeIconColors_m21",d:"M 576 1728 v -256 h 710 l -912 -912 l 186 -186 l 912 912 v -710 h 256 v 1152 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"})),j=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 256 v 1280 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 z"}),R.createElement("path",{className:"OfficeIconColors_m21",d:"M 374 1488 l 912 -912 h -710 v -256 h 1152 v 1152 h -256 v -710 l -912 912 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"})),Y=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 832 1856 v -1227 l -506 506 l -181 -181 l 815 -815 l 815 815 l -181 181 l -506 -506 v 1227 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"})),X=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 64 832 h 1227 l -506 -506 l 181 -181 l 815 815 l -815 815 l -181 -181 l 506 -506 h -1227 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"})),K=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1088 64 v 1227 l 506 -506 l 181 181 l -815 815 l -815 -815 l 181 -181 l 506 506 v -1227 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"})),Z=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 576 1728 v -256 h 710 l -912 -912 l 186 -186 l 912 912 v -710 h 256 v 1152 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"})),ee=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 374 1488 l 912 -912 h -710 v -256 h 1152 v 1152 h -256 v -710 l -912 912 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"})),te=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 1664 h -1920 l 960 -1280 m -704 1152 h 1408 l -704 -939 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 128 1600 l 832 -1109 l 832 1109 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 1920 1664 h -1920 l 960 -1280 m -704 1152 h 1408 l -704 -939 z"})),ae=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 640 v 640 h -1920 v -640 m 1792 128 h -1664 v 384 h 1664 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 64 1216 v -512 h 1792 v 512 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1920 640 v 640 h -1920 v -640 m 1792 128 h -1664 v 384 h 1664 z"})),ne=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 0 384 h 1920 l -960 1280 m 704 -1152 h -1408 l 704 939 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1792 448 l -832 1109 l -832 -1109 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 0 384 h 1920 l -960 1280 m 704 -1152 h -1408 l 704 939 z"})),oe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),re=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -39 4 -77 q 3 -38 9 -76 v -4 q 19 -123 66 -235 q 46 -112 116 -208 q 70 -96 160 -175 q 90 -78 196 -134 q 106 -55 226 -85 q 119 -30 247 -30 m 896 1024 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -9 0 -18 0 q -9 1 -18 2 l 930 930 q 1 -9 2 -18 q 0 -9 0 -18 m -1572 -586 q -72 83 -122 181 q -51 98 -76 209 l 1070 1070 q 111 -25 209 -76 q 98 -50 181 -122 m -1482 -676 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 9 0 18 -1 q 9 0 18 -1 l -930 -930 q -1 9 -1 18 q -1 9 -1 18 m 1572 586 q 72 -83 123 -181 q 50 -98 75 -209 l -1070 -1070 q -111 25 -209 75 q -98 51 -181 123 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),ie=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),le=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),se=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -512 0 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 z"}),R.createElement("path",{className:"OfficeIconColors_m221",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m220",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),ce=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -384 0 q 0 106 -40 199 q -41 93 -110 162 q -70 70 -163 110 q -93 41 -199 41 q -106 0 -199 -41 q -93 -40 -162 -110 q -70 -69 -110 -162 q -41 -93 -41 -199 q 0 -106 41 -199 q 40 -93 110 -163 q 69 -69 162 -110 q 93 -40 199 -40 q 106 0 199 40 q 93 41 163 110 q 69 70 110 163 q 40 93 40 199 z"}),R.createElement("path",{className:"OfficeIconColors_m21",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),de=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -256 0 q 0 88 -23 170 q -23 82 -64 153 q -42 71 -100 129 q -59 59 -130 100 q -71 42 -153 65 q -82 23 -170 23 q -88 0 -170 -23 q -82 -23 -153 -65 q -71 -41 -129 -100 q -59 -58 -100 -129 q -42 -71 -65 -153 q -23 -82 -23 -170 q 0 -88 23 -170 q 23 -82 65 -153 q 41 -71 100 -130 q 58 -58 129 -100 q 71 -41 153 -64 q 82 -23 170 -23 q 88 0 170 23 q 82 23 153 64 q 71 42 130 100 q 58 59 100 130 q 41 71 64 153 q 23 82 23 170 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 z"})),ue=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 m -896 -1664 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})),me=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 128 1920 h 1792 v -1792 h -1792 m 896 128 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 640 768 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -9 0 -18 0 q -9 0 -18 1 l 675 675 q 1 -9 1 -18 q 0 -9 0 -18 m -1280 0 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 q 130 0 245 -49 l -836 -836 q -49 115 -49 245 m 1002 528 q 88 -61 153 -147 q 64 -86 96 -191 l -801 -801 q -104 32 -190 96 q -87 65 -148 153 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})),ge=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 m -896 -1664 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})),he=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 l 960 -1920 m -753 1792 h 1506 l -753 -1506 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 104 1856 l 856 -1713 l 856 1713 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1920 1920 h -1920 l 960 -1920 m -753 1792 h 1506 l -753 -1506 z"})),pe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2020 1024 l -996 996 l -996 -996 l 996 -996 m 0 1810 l 815 -814 l -815 -814 l -815 814 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 119 1024 l 905 -905 l 905 905 l -905 905 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 2020 1024 l -996 996 l -996 -996 l 996 -996 m 0 1810 l 815 -814 l -815 -814 l -815 814 z"})),be=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2019 558 l -1315 1313 l -674 -674 l 271 -271 l 403 403 l 1043 -1043 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 120 1197 l 181 -181 l 403 403 l 1043 -1043 l 181 181 l -1224 1224 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 704 1510 l -403 -403 l -90 90 l 493 493 l 1133 -1133 l -90 -90 m 271 90 l -1314 1314 l -674 -674 l 271 -271 l 403 403 l 1043 -1043 z"})),fe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1280 0 v 1408 h -512 v -1408 m 0 1536 h 512 v 512 h -512 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 832 1984 v -384 h 384 v 384 m -384 -640 v -1280 h 384 v 1280 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1280 0 v 1408 h -512 v -1408 m 384 128 h -256 v 1152 h 256 m 128 256 v 512 h -512 v -512 m 384 128 h -256 v 256 h 256 z"})),Ce=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1984 348 l -676 676 l 676 676 l -284 284 l -676 -676 l -676 676 l -284 -284 l 676 -676 l -676 -676 l 284 -284 l 676 676 l 676 -676 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 154 1700 l 677 -676 l -677 -676 l 194 -194 l 676 677 l 676 -677 l 194 194 l -677 676 l 677 676 l -194 194 l -676 -677 l -676 677 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 1024 921 l -676 -676 l -103 103 l 676 676 l -676 676 l 103 103 l 676 -676 l 676 676 l 103 -103 l -676 -676 l 676 -676 l -103 -103 m 284 103 l -676 676 l 676 676 l -284 284 l -676 -676 l -676 676 l -284 -284 l 676 -676 l -676 -676 l 284 -284 l 676 676 l 676 -676 z"})),ye=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 142 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -66 -207 -160 q -94 -93 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -114 161 -208 q 93 -93 207 -160 q 113 -66 244 -103 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 544 -1312 l 128 128 l -864 864 l -480 -480 l 128 -128 l 352 352 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 1024 64 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 m 762 672 l -218 -218 l -736 736 l -352 -352 l -218 218 l 570 570 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 142 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -66 -207 -160 q -94 -93 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -114 161 -208 q 93 -93 207 -160 q 113 -66 244 -103 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -75 -12 -146 q -12 -71 -35 -138 l -1041 1041 l -661 -661 l 309 -309 l 352 352 l 736 -736 l 301 301 q -46 -131 -129 -241 q -83 -110 -193 -190 q -111 -80 -244 -125 q -133 -44 -279 -44 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 672 -1184 l -128 -128 l -736 736 l -352 -352 l -128 128 l 480 480 z"})),ve=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 0 -102 q -40 0 -75 -12 q -35 -12 -61 -33 q -26 -21 -41 -49 q -15 -28 -15 -60 q 0 -32 15 -60 q 15 -28 41 -49 q 26 -21 61 -33 q 35 -12 75 -12 q 40 0 75 12 q 35 12 61 33 q 26 21 41 49 q 15 28 15 60 q 0 32 -15 60 q -15 28 -41 49 q -26 21 -61 33 q -35 12 -75 12 m 128 -538 h -256 v -1024 h 256 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 832 1344 v -1152 h 384 v 1152 m -192 538 q -53 0 -99 -17 q -47 -17 -82 -47 q -35 -30 -55 -70 q -20 -39 -20 -84 q 0 -45 20 -85 q 20 -39 55 -69 q 35 -30 82 -47 q 46 -17 99 -17 q 53 0 100 17 q 46 17 81 47 q 35 30 55 69 q 20 40 20 85 q 0 45 -20 84 q -20 40 -55 70 q -35 30 -81 47 q -47 17 -100 17 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1818 q 40 0 75 -12 q 35 -12 61 -33 q 26 -21 41 -49 q 15 -28 15 -60 q 0 -32 -15 -60 q -15 -28 -41 -49 q -26 -21 -61 -33 q -35 -12 -75 -12 q -40 0 -75 12 q -35 12 -61 33 q -26 21 -41 49 q -15 28 -15 60 q 0 32 15 60 q 15 28 41 49 q 26 21 61 33 q 35 12 75 12 m 128 -1562 h -256 v 1024 h 256 m -1024 -256 q 0 164 56 311 q 56 147 154 264 q 98 117 232 196 q 133 80 289 109 q -70 -37 -112 -100 q -43 -62 -43 -140 q 0 -43 14 -82 q 14 -39 39 -72 q 24 -33 59 -59 q 34 -26 76 -43 h -124 v -1242 q -139 41 -256 123 q -117 83 -202 195 q -86 113 -134 251 q -48 138 -48 289 m 1061 880 q 156 -29 290 -109 q 133 -79 231 -196 q 98 -117 154 -264 q 56 -147 56 -311 q 0 -151 -48 -289 q -48 -138 -133 -251 q -86 -112 -203 -195 q -117 -82 -256 -123 v 1242 h -124 q 42 17 77 43 q 34 26 59 59 q 24 33 38 72 q 14 39 14 82 q 0 78 -42 140 q -43 63 -113 100 z"})),Te=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -715 0 l 422 421 l -182 182 l -421 -422 l -421 422 l -182 -182 l 422 -421 l -422 -421 l 182 -182 l 421 422 l 421 -422 l 182 182 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1296 l -421 421 l -272 -272 l 421 -421 l -421 -421 l 272 -272 l 421 421 l 421 -421 l 272 272 l -421 421 l 421 421 l -272 272 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 1024 843 l -421 -422 l -182 182 l 422 421 l -422 421 l 182 182 l 421 -422 l 421 422 l 182 -182 l -422 -421 l 422 -421 l -182 -182 m 363 182 l -422 421 l 422 421 l -363 363 l -421 -422 l -421 422 l -363 -363 l 422 -421 l -422 -421 l 363 -363 l 421 422 l 421 -422 m 603 784 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),xe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 z"}),R.createElement("path",{className:"OfficeIconColors_m29",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),R.createElement("path",{className:"OfficeIconColors_m28",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})),Se=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 m 512 128 h -293 l 293 293 m -640 -549 h -293 l 293 293 m -512 475 h 165 l -165 -165 m 512 165 v -293 l -475 -475 h -37 v 421 l 347 347 m 293 256 h 165 l -165 -165 m 512 165 v -293 l -475 -475 h -37 v 421 l 347 347 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})),we=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 m -128 -128 h -512 v 768 h 512 m 640 -512 h -512 v 768 h 512 z"}),R.createElement("path",{className:"OfficeIconColors_m215",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),R.createElement("path",{className:"OfficeIconColors_m214",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})),Ee=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1027 0 l 253 640 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 1026 1537 l -574 360 l 233 -666 l -530 -527 h 650 l 221 -533 l 211 533 h 657 l -526 528 l 263 665 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1025 1466 l 478 285 l -210 -531 l 448 -452 h -548 l -169 -426 l -176 426 h -539 l 450 450 l -187 532 m 708 -1110 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"})),Re=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 1467 l 479 284 l -210 -530 l 448 -453 h -548 l -169 -426 m 256 298 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1035 1530 l -575 361 l 234 -668 l -531 -530 h 651 l 221 -533 l 210 533 h 658 l -526 532 l 263 666 z"}),R.createElement("path",{className:"OfficeIconColors_m212",d:"M 460 1891 l 234 -668 l -531 -530 h 651 l 210 -507 v 1351 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1025 0 l 255 640 h 768 l -605 608 l 317 800 l -735 -434 v -148 l 478 285 l -210 -530 l 448 -453 h -548 l -168 -424 z"}),R.createElement("path",{className:"OfficeIconColors_m211",d:"M 1024 343 l -176 425 h -539 l 450 450 l -187 532 l 452 -283 v 147 l -693 434 l 281 -800 l -612 -608 h 763 l 261 -632 z"})),Ie=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 572 1750 l 453 -284 l 478 285 l -210 -530 l 448 -453 h -548 l -169 -426 l -176 426 h -539 l 462 457 m 509 -585 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1026 1537 l -574 360 l 233 -666 l -530 -527 h 650 l 221 -533 l 211 533 h 657 l -526 528 l 263 665 z"}),R.createElement("path",{className:"OfficeIconColors_m210",d:"M 572 1750 l 453 -284 l 478 285 l -210 -530 l 448 -453 h -548 l -169 -426 l -176 426 h -539 l 462 457 m 509 -585 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"})),Ae=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 384 -1024 h -128 v 1024 h 128 m 384 -1408 h -128 v 1408 h 128 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),Le=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 384 -1024 h -128 v 1024 h 128 m 640 -1792 h -256 v 1792 h 256 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 1344 1984 h -1152 v -768 h 384 v -384 h 384 v -384 h 384 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),Fe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 640 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 960 1984 h -768 v -768 h 384 v -384 h 384 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),_e=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -384 896 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 576 1984 h -384 v -768 h 384 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),Ne=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})),ke=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),Oe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 128 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 h 896 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 h 960 v -960 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 0 1024 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 m 128 0 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 z"})),Pe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m -896 1024 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 v -1792 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 1984 1024 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 v -1920 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),Me=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 h -896 v -896 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m23",d:"M 1024 64 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 h -960 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 z"})),De=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})),$e=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 896 h -768 v -768 h -128 v 768 h -768 v 128 h 768 v 768 h 128 v -768 h 768 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),Be=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -896 v 768 h -768 v 128 h 768 v 768 h 128 v -768 h 768 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 1860 956 v 903 h -1801 v -1794 h 903 v 891 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 896 h -768 v 768 h 768 m 896 -768 h -768 v 768 h 768 m 0 -896 v -768 h -768 v 768 z"})),He=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -768 v 768 h -128 v -768 h -768 v 896 h 768 v 768 h 128 v -768 h 768 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 1856 1856 h -1792 v -896 h 1792 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),Ue=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -768 v 768 h -128 v -768 h -768 v 896 h 768 v 768 h 896 v -768 h -768 v -126 h 768 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),R.createElement("path",{className:"OfficeIconColors_m26",d:"M 64 960 h 896 v 896 h -896 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),qe=()=>R.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048"},R.createElement("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 -768 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"}),R.createElement("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),R.createElement("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 -768 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})),Ve=()=>{(0,V.K1)({icons:{conditional_format_grey_arrow_up_icon:R.createElement(W,null),conditional_format_grey_arrow_right_icon:R.createElement(z,null),conditional_format_grey_arrow_down_icon:R.createElement(Q,null),conditional_format_grey_arrow_down_right_icon:R.createElement(J,null),conditional_format_grey_arrow_up_right_icon:R.createElement(j,null),conditional_format_colored_arrow_up_icon:R.createElement(Y,null),conditional_format_colored_arrow_right_icon:R.createElement(X,null),conditional_format_colored_arrow_down_icon:R.createElement(K,null),conditional_format_colored_arrow_down_right_icon:R.createElement(Z,null),conditional_format_colored_arrow_up_right_icon:R.createElement(ee,null),conditional_format_triangle_high_icon:R.createElement(te,null),conditional_format_triangle_medium_icon:R.createElement(ae,null),conditional_format_triangle_low_icon:R.createElement(ne,null),conditional_format_circle_high_icon:R.createElement(oe,null),conditional_format_circle_medium_icon:R.createElement(re,null),conditional_format_circle_low_icon:R.createElement(ie,null),conditional_format_4circle_high_icon:R.createElement(le,null),conditional_format_4circle_medium2_icon:R.createElement(se,null),conditional_format_4circle_medium1_icon:R.createElement(ce,null),conditional_format_4circle_low_icon:R.createElement(de,null),conditional_format_traffic_high_icon:R.createElement(ue,null),conditional_format_traffic_medium_icon:R.createElement(me,null),conditional_format_traffic_low_icon:R.createElement(ge,null),conditional_format_sign_medium_icon:R.createElement(he,null),conditional_format_sign_low_icon:R.createElement(pe,null),conditional_format_symbol_high_icon:R.createElement(be,null),conditional_format_symbol_medium_icon:R.createElement(fe,null),conditional_format_symbol_low_icon:R.createElement(Ce,null),conditional_format_circle_symbol_high_icon:R.createElement(ye,null),conditional_format_circle_symbol_medium_icon:R.createElement(ve,null),conditional_format_circle_symbol_low_icon:R.createElement(Te,null),conditional_format_flag_high_icon:R.createElement(xe,null),conditional_format_flag_medium_icon:R.createElement(Se,null),conditional_format_flag_low_icon:R.createElement(we,null),conditional_format_star_high_icon:R.createElement(Ee,null),conditional_format_star_medium_icon:R.createElement(Re,null),conditional_format_star_low_icon:R.createElement(Ie,null),conditional_format_signal_high_icon:R.createElement(Ae,null),conditional_format_signal_medium2_icon:R.createElement(Le,null),conditional_format_signal_medium1_icon:R.createElement(Fe,null),conditional_format_signal_low_icon:R.createElement(_e,null),conditional_format_signal_empty_icon:R.createElement(Ne,null),conditional_format_circle_filled_icon:R.createElement(ke,null),conditional_format_circle_75_icon:R.createElement(Oe,null),conditional_format_circle_half_icon:R.createElement(Pe,null),conditional_format_circle_25_icon:R.createElement(Me,null),conditional_format_circle_empty_icon:R.createElement(De,null),conditional_format_quadrant_full_icon:R.createElement($e,null),conditional_format_quadrant_75_icon:R.createElement(Be,null),conditional_format_quadrant_50_icon:R.createElement(He,null),conditional_format_quadrant_25_icon:R.createElement(Ue,null),conditional_format_quadrant_empty_icon:R.createElement(qe,null)}})};const Ge={[G.default.Nil]:[],[G.default.IconSet3Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_right_icon","conditional_format_colored_arrow_down_icon"],[G.default.IconSet3ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_right_icon","conditional_format_grey_arrow_down_icon"],[G.default.IconSet4Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_up_right_icon","conditional_format_colored_arrow_down_right_icon","conditional_format_colored_arrow_down_icon"],[G.default.IconSet4ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_up_right_icon","conditional_format_grey_arrow_down_right_icon","conditional_format_grey_arrow_down_icon"],[G.default.IconSet5Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_up_right_icon","conditional_format_colored_arrow_right_icon","conditional_format_colored_arrow_down_right_icon","conditional_format_colored_arrow_down_icon"],[G.default.IconSet5ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_up_right_icon","conditional_format_grey_arrow_right_icon","conditional_format_grey_arrow_down_right_icon","conditional_format_grey_arrow_down_icon"],[G.default.IconSet3Triangles]:["conditional_format_triangle_high_icon","conditional_format_triangle_medium_icon","conditional_format_triangle_low_icon"],[G.default.IconSet3TrafficLights1]:["conditional_format_circle_high_icon","conditional_format_circle_medium_icon","conditional_format_circle_low_icon"],[G.default.IconSet3TrafficLights2]:["conditional_format_traffic_high_icon","conditional_format_traffic_medium_icon","conditional_format_traffic_low_icon"],[G.default.IconSet4TrafficLights]:["conditional_format_circle_high_icon","conditional_format_circle_medium_icon","conditional_format_circle_low_icon","conditional_format_4circle_low_icon"],[G.default.IconSet3Signs]:["conditional_format_circle_high_icon","conditional_format_sign_medium_icon","conditional_format_sign_low_icon"],[G.default.IconSet4RedToBlack]:["conditional_format_4circle_high_icon","conditional_format_4circle_medium2_icon","conditional_format_4circle_medium1_icon","conditional_format_4circle_low_icon"],[G.default.IconSet3Symbols]:["conditional_format_circle_symbol_high_icon","conditional_format_circle_symbol_medium_icon","conditional_format_circle_symbol_low_icon"],[G.default.IconSet3Symbols2]:["conditional_format_symbol_high_icon","conditional_format_symbol_medium_icon","conditional_format_symbol_low_icon"],[G.default.IconSet3Flags]:["conditional_format_flag_high_icon","conditional_format_flag_medium_icon","conditional_format_flag_low_icon"],[G.default.IconSet3Stars]:["conditional_format_star_high_icon","conditional_format_star_medium_icon","conditional_format_star_low_icon"],[G.default.IconSet4Rating]:["conditional_format_signal_low_icon","conditional_format_signal_medium1_icon","conditional_format_signal_medium2_icon","conditional_format_signal_high_icon"],[G.default.IconSet5Rating]:["conditional_format_signal_empty_icon","conditional_format_signal_low_icon","conditional_format_signal_medium1_icon","conditional_format_signal_medium2_icon","conditional_format_signal_high_icon"],[G.default.IconSet5Quarters]:["conditional_format_circle_filled_icon","conditional_format_circle_75_icon","conditional_format_circle_half_icon","conditional_format_circle_25_icon","conditional_format_circle_empty_icon"],[G.default.IconSet5Boxes]:["conditional_format_quadrant_full_icon","conditional_format_quadrant_75_icon","conditional_format_quadrant_50_icon","conditional_format_quadrant_25_icon","conditional_format_quadrant_empty_icon"]};var We=a(50347);let ze=!1;function Qe(e){let t,a;const n={},o=e.cfHitlItem.conditionalFormatResponseCardData.originalHexColors;null!=o&&(null!=o.minimumColor&&(n.minimumColor=o.minimumColor),null!=o.midpointColor&&(n.midpointColor=o.midpointColor),null!=o.maximumColor&&(n.maximumColor=o.maximumColor));const r=Object.keys(n).length,i=e.cfHitlItem.conditionalFormatResponseCardData.cardTitle,l=e.cfHitlItem.conditionalFormatResponseCardData.customFormat;switch(i){case I.D.CellValue:case I.D.Preset:case I.D.TopBottom:case I.D.TextComparison:case I.D.Dates:case I.D.UniqueValue:case I.D.CustomCreated:l&&(t=D(l));break;case I.D.ColorScale:2===r?t=$(n.minimumColor,n.maximumColor):3===r&&(t=$(n.minimumColor,n.maximumColor,n.midpointColor));break;case I.D.DataBar:{t=P;const n=e.cfHitlItem.conditionalFormatResponseCardData.dataBarFormat;if(n){const e=n.isGradientFill;a=B(n.fillColor,e)}break}case I.D.IconSet:ze||(Ve(),ze=!0);return function(e){const t=(n=Ge,o=e,r=[],o in n?n[o]:r),a=e=>R.createElement("div",{className:"conditional-formatting-response-card-icon-renderer","aria-label":ExcelCopilotCommandingHitlStrings.ConditionalFormattingSwatchAriaLabel,role:"img"},e.map((e=>R.createElement(A.I,{iconName:e,key:e,className:"conditional-formatting-response-card-icon"}))));var n,o,r;if(t.length>0)return R.createElement("div",null,a(t));return R.createElement("div",null)}(e.cfHitlItem.conditionalFormatResponseCardData.iconSetNumber);default:(0,q.debuglog)("unknown ConditionalFormatResponseCardType while forming style")}const s=function(e){switch(e){case I.D.ColorScale:case I.D.DataBar:case I.D.IconSet:return!1;default:return!0}}(i);return R.createElement("div",{style:t,"aria-label":ExcelCopilotCommandingHitlStrings.ConditionalFormattingSwatchAriaLabel,role:"img"},R.createElement("span",{hidden:!s},"AaBbCc"),R.createElement("div",{hidden:s,style:a}))}var Je=a(72483),je=a(90922),Ye=a(79029),Xe=a(49118),Ke=a(48314),Ze=a(23147),et=a(49462),tt=a(20378),at=a.n(tt);const nt=/(#[a-fA-F0-9]{6})(?![a-zA-Z0-9])/g;function ot(e,t){const a=e.split(t);return R.createElement(y.E,null,a.map(((e,n)=>R.createElement(R.Fragment,{key:n},e,n!==a.length-1&&R.createElement("b",null,t)))))}function rt(e){return R.createElement(Xe.W,null,Ze.CP.getHumanInTheLoopRange()?ot(e.header,Ze.CP.getHumanInTheLoopRange()):R.createElement(y.E,null,e.header),R.createElement(Xe.W,null,R.createElement("ul",null,e.events.map(((e,t)=>R.createElement(y.E,{block:!0,key:t},R.createElement("li",null,e)))))))}function it(e){const t=e=>at()(e,nt,((e,t)=>function(e){const t=E();return R.createElement("span",{key:e.key},R.createElement("svg",{width:"10",height:"10"},R.createElement("rect",{className:t.swatch,width:"10",height:"10",rx:4,style:{fill:e.fillColor,strokeWidth:1}})),"Â ",e.fillColor)}({key:t,fillColor:e})));return R.createElement(Xe.W,null,(0,We.yw)("OfficeVSO_8976811_BoldRangeHiTLCard")&&Ze.CP.getHumanInTheLoopRange()?ot(e.header,Ze.CP.getHumanInTheLoopRange()):R.createElement(y.E,null,e.header),R.createElement(Xe.W,null,R.createElement("ul",null,e.listItems.map(((e,a)=>R.createElement(y.E,{block:!0,key:a},R.createElement("li",null,e.title&&R.createElement("span",{style:{fontWeight:600}},e.title),t(e.text))))))),e.footer&&R.createElement(Xe.W,null,R.createElement(y.E,null,e.footer)))}function lt(e){const t=e=>{const t={cfHitlItem:e};if((0,We.ID)())return function(e){const t=e.cfHitlItem.conditionalFormatResponseCardData.customFormula,a=e.cfHitlItem.conditionalFormatResponseCardData.formulaExplanation,n={isLoading:!a,isNotAvailable:!a,explanation:a,onFirstTimeExplanationShown:()=>{}};return R.createElement(F.$,{icon:"math",content:t,explanation:(0,We._N)()?n:void 0,telemetryUsageFeatureName:_.q.Commanding,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),ariaAttributes:{"aria-label":L.xe2.FormulaSuggestion_FormulaSnippet_AriaLabel}})}(t)};return R.createElement(Xe.W,null,(0,We.yw)("OfficeVSO_8976811_BoldRangeHiTLCard")&&Ze.CP.getHumanInTheLoopRange()?ot(e.header,Ze.CP.getHumanInTheLoopRange()):R.createElement(y.E,null,e.header),R.createElement(Xe.W,null,R.createElement("ul",null,e.eventIntents.map((e=>R.createElement("li",{key:e},e))),e.cfHitlItems.map((e=>R.createElement("li",{key:e.explanation},R.createElement(y.E,{style:{fontWeight:"bold"}},e.title),e.explanation,R.createElement("ul",null,e.subExplanations?.map((e=>R.createElement("li",{key:e},e)))),R.createElement("div",{hidden:!(0,We.GI)(),className:"conditional-formatting-response-card-swatch"},(e=>{const t={cfHitlItem:e};if((0,We.GI)())return Qe(t)})(e)),R.createElement("div",{hidden:!(0,We.ID)()||void 0===e.conditionalFormatResponseCardData.customFormula,className:"conditional-formatting-response-card-formula"},t(e))))))))}const st=(e,t)=>{if(Ze.CP.isContextLocked())return;const a=Ke.M.getInstance();(0,We.BT)()?Ye.B.getInstance().logKeptEvent(_.BJ.Commanding,_.q.ConditionalFormattingSuggestion,je.RX.Command):a.logKeptEvent(_.q.ConditionalFormattingSuggestion),a.logEvent((0,_.SV)(_.he.ConditionalFormattingSuggestionPillClicked,_.q.ConditionalFormattingSuggestion,_.KZ.ConditionalFormattingSuggestionPill,e.Key,t)),Je.$.getInstance().submitUserQuery(e.Description)};function ct(e){const t=(0,et.d4)((e=>e.chat.isDarkModeEnabled));return R.createElement(Xe.W,null,R.createElement(y.E,{style:{paddingBottom:"8px"}},e.header),e.suggestions&&e.suggestions.length>0&&R.createElement("div",{style:{alignItems:"flex-start"}},e.suggestions.map(((a,n)=>R.createElement(v.$,{key:n,className:t?"chat-conditional-formatting-suggestion-pill-dark-mode":"chat-conditional-formatting-suggestion-pill",onClick:()=>{st(a,e.guid)}},a.Description)))))}},2379:(e,t,a)=>{a.d(t,{n:()=>N,r:()=>I});var n=a(92779),o=a(27982),r=a(89099),i=a(24220),l=a(28087),s=a(33500),c=a(19080),d=a(79689),u=a(72483),m=a(93772),g=a(72587),h=a(94303),p=a(88179),b=a(48314),f=a(23147),C=a(80132),y=a(91259),v=a(50347),T=a(78651),x=a(10216),S=a(95674),w=a(4475);const E=p.q.Commanding,R=m.Xw.COMMANDING;function I(e,t){return{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:A(t.length)},embeddedLists:(0,v.k6)()?[]:[{listItems:t}],messageFooter:{text:e}}}}}function A(e){if(!(0,v.yw)("OfficeVSO_8977646_RemoveRangeFromHiTLConfirmationCard")&&(0,v.qm)()){const t=f.CP.getActiveTable()?.address,a=f.CP.getHumanInTheLoopRange()??(0,S.r)(t??"");if(a)return(0,n.go9)(e).replace("{0}",a)}return(0,n.lj0)(e)}function L(e,t){const a=f.CP.getActiveTable();if(!a?.address)throw new h.sF("No active table",h.UP.NoActiveTable);const o=(0,S.r)(a.address);return e&&1===t?(0,y.L)((0,n.Af3)(),o):e&&t>1?(0,y.L)((0,n.Edn)(),o,t):t>1?(0,y.L)((0,n.syu)(),o,t):(0,y.L)((0,n.$Mo)(),o)}function F(e){return{type:o.jA.Default,title:(0,n.yZI)(),text:(0,n.yZI)(),iconRegular:d.N5_,iconHover:d.FUA,isDisabled:!0,handleButtonOnClick:async()=>{b.M.getInstance().logEvent((0,p.SV)(p.he.Apply,p.q.Commanding,p.KZ.ApplyButton,void 0,b.M.userQueryGuid));const{message:t,telemetry:a}={message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Human,messageHeader:{text:(0,n.yZI)()}}}},telemetry:{featureName:E,eventType:p.a5.HumanInput}};u.$.getInstance().displayResponse(t,a),await e()}}}function _(e,t,a=void 0){const n=p.q.ConditionalFormattingSuggestion,o=(0,x.v)(e,{errorType:t,featureName:n},{},{feedbackData:(0,v.yw)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:m.Xw.COMMANDINGCONDITIONALFORMATTING}:{feedbackArea:m.Xw.COMMANDINGCFSUGGESTIONS}});return o.message.addCardToChatHistory=!1,(0,v.jH)()&&(o.telemetry.devInfo={category:t,message:a}),(0,v.yw)("OfficeVSO_9187840_ASHACoverageForServiceErrors")&&(t===p.q0.ClientError?b.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_Suggestions_Error_Due_To_No_Table_Selected,p.BJ.Commanding):b.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_Suggestions_Error,p.BJ.Commanding)),o}const N={getOdslExecutionFailedResponse:function(e,t){return(0,x.v)(e,{featureName:E,errorType:t},{},{feedbackData:{feedbackArea:R}})},getMultipleEventsErrorResponse:function(e,{showUndo:t}={showUndo:!1}){return(0,x.v)(e,{errorType:p.q0.DetectedMultipleIntents},{},{actionButtonList:t&&(0,v.BA)()?[(0,w.FW)(E)]:[]})},getCommandingSuccessResponse:function(e,t){const a=t.some((e=>g.yT.test(e.text))),n={shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:R},feedbackSectionPosition:c.O.Footer,actionButtonList:(0,v.BA)()?[(0,w.FW)(E)]:[]};let o;if(!(0,v.k6)()&&a){const a={header:A(t.length),listItems:t,footer:e},r=(0,T.KI)(a);o={chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,C.IM)("ChatCardListWithColorSwatch_V1",a),textContent:r}},chatMessageBodyData:n}}else o={...I(e,t),chatMessageBodyData:n};return{message:o,telemetry:{featureName:E,eventType:p.a5.ActionConfirmationMessage}}},getUnsupportedCommandResponse:function(e,t=[]){const{message:a,telemetry:n}=(0,x.v)(e,{featureName:E,errorType:p.q0.UnsupportedCommand},{embeddedLists:[{listItems:t}]},{feedbackData:{feedbackArea:R},feedbackSectionPosition:c.O.None});return{message:a,telemetry:n}},getCommandingTellMeResponse:function(){return{message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,embeddedLists:[{listHeader:(0,n.ZcJ)(),listItems:[{text:(0,n.UFE)()},{text:(0,n.$nW)()}]},{listHeader:(0,n.Sur)(),listItems:[{text:(0,n.Gpd)()},{text:(0,n.N9u)()}]}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:c.O.Footer,feedbackData:{feedbackArea:R}}},telemetry:{featureName:E,eventType:p.a5.HelpMessage}}},getCommandingHumanInTheLoopResponse:function(e,t){const a={header:L(!1,e.length),events:e},n=(0,v.yw)("OfficeVSO_8990694_HiTLChatHistorySignalContent")?(0,T.NP)(a):"";return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,C.IM)("ChatCardHumanInTheLoop_V1",a),textContent:n}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(t)],feedbackSectionPosition:c.O.Footer,feedbackData:(0,v.yw)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:m.Xw.COMMANDING}:{}}},telemetry:{featureName:E,eventType:p.a5.HumanInTheLoopMessage}}},getCommandingHumanInTheLoopResponseDeprecated:function(e,t){return{message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:L(!1,e.length)},embeddedLists:[{listItems:e.map((e=>({text:e})))}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(t)],feedbackSectionPosition:c.O.Footer}},telemetry:{featureName:E,eventType:p.a5.HumanInTheLoopMessage}}},getCommandingCFHumanInTheLoopResponse:function(e,t,a){const n={header:L(0===t.length,e.length+t.length),cfHitlItems:e,eventIntents:t};return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,C.IM)("ChatCardWithConditionalFormatting_V1",n),textContent:(0,T.EM)(n)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(a)],feedbackSectionPosition:c.O.Footer,feedbackData:(0,v.yw)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:m.Xw.COMMANDINGCONDITIONALFORMATTING}:{}}},telemetry:{featureName:E,eventType:p.a5.HumanInTheLoopMessage}}},getConditionalFormattingSuggestionsResponseMessage:function(e,t,a,o){const d=f.CP.getActiveTable(),u=d?.address;return(0,v.yw)("OfficeVSO_9492150_ProdigiConditionalFormatting")&&"out-of-credits"===t?_((0,n.R_I)(),p.q0.OutOfCreditsError,t):t?_((0,n.t_C)(),p.q0.ServiceError,t):u?0===e.length?function(e){const t=p.q0.NoSuggestions,a=p.q.ConditionalFormattingSuggestion,o=(0,v.yw)("OfficeVSO_9243974_UpdateNoCFSuggestionErrorMessage")?(0,y.L)((0,n.yNF)(),e):(0,n.ANf)(),l=(0,x.v)(o,{errorType:t,featureName:a},{},{feedbackData:(0,v.yw)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:m.Xw.COMMANDINGCONDITIONALFORMATTING}:{feedbackArea:m.Xw.COMMANDINGCFSUGGESTIONS}});return l.message.addCardToChatHistory=!1,b.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_No_Suggestions_Error,p.BJ.Commanding),l}(u):function(e,t,a,o){const r={featureName:p.q.ConditionalFormattingSuggestion,eventType:p.a5.SuggestionMessage},i=(0,S.r)(t),d={header:(0,y.L)(a??(0,n.AsH)(),i),suggestions:e,footer:void 0,guid:o},u=(0,T.iN)(d);return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,C.IM)("ConditionalFormattingSuggestionCard_V1",d),textContent:u}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:c.O.Footer,feedbackData:(0,v.yw)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:m.Xw.COMMANDINGCONDITIONALFORMATTING}:{feedbackArea:m.Xw.COMMANDINGCFSUGGESTIONS}}},telemetry:r}}(e,u,a,o):_((0,n.LNV)(),p.q0.ClientError)},getConditionalFormattingSuggestionsErrorResponse:_}},10216:(e,t,a)=>{a.d(t,{v:()=>u});var n=a(28087),o=a(33500),r=a(19080),i=a(93772),l=a(88179),s=a(4475),c=a(50347),d=a(98483);function u(e,t={},a={},u={},m={}){const g=(0,d.A)();return{message:{...m,chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e},...a}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:i.Xw.CHATEXCEL},isFailure:!0,messageId:g,actionButtonList:(0,c.jH)()?[(0,s.yo)(g)]:void 0,...u}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.ErrorMessage,...t}}}},71362:(e,t,a)=>{a.d(t,{n:()=>re});var n=a(28087),o=a(33500),r=a(19080),i=a(93772),l=a(88179),s=a(80132),c=a(78651),d=a(50347),u=a(10216),m=a(4475),g=a(98483);const h=l.q.AnalyzeData,p=i.Xw.ANALYZEDATA;const b={getChartAdaptiveCardResponse:function({requestId:e,adaptiveCardDefinition:t}){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,s.IM)("ChartAdaptiveCard_V1",{requestId:e,adaptiveCardDefinition:t}),textContent:"IGNORED"}},chatMessageBodyData:{messageId:(0,g.A)(),shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p}},addCardToChatHistory:!0},telemetry:{featureName:h,eventType:l.a5.SuggestionMessage}}},getAnalyzeDataErrorResponse:function(e,t){const{message:a,telemetry:n}=(0,u.v)(e,{errorType:t??l.q0.ClientError,featureName:h},{},{feedbackData:{feedbackArea:p},shouldShowAIGeneratedIndicator:!0});return{message:a,telemetry:n}},getAnalyzeDataRecommendationResponse:function({visual:e,requestId:t,responseText:a,caveats:i,tableName:u,tableContext:m}){const b=(0,c.Pp)(e,a);return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,s.IM)("AnalyzeData_V1",{tableName:u,visual:e,requestId:t,responseText:a,caveats:i,tableContext:m}),textContent:b}},chatMessageBodyData:{messageId:(0,d.yw)("OfficeVSO_8691849_CopilotChartToImage")?(0,g.A)():void 0,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p}},addCardToChatHistory:"TextAnalysisVisual"!==e.visual?.visualType},telemetry:{featureName:h,eventType:l.a5.SuggestionMessage}}},getAnalyzeDataInsertSuccessResponse:function({tableContext:e,messageText:t,confirmationMessage:a,suggestionId:i="",shouldShowGoBackToTableButton:s}){const c=[];return s&&c.push((0,m.zY)(e)),(0,d.BA)()&&c.push((0,m.FW)(h,i)),{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:t},messageFooter:a?{text:a}:void 0}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p},actionButtonList:c}},telemetry:{featureName:h,eventType:l.a5.ActionConfirmationMessage}}},getAnalyzeDataInsertUserChat:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:h,eventType:l.a5.HumanInput}}},getTextAnalysisV1Response:function({requestId:e,textAnalysis:t,title:a}){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,s.IM)("TextAnalysis_V1",{requestId:e,textAnalysis:t,title:a})}},chatMessageBodyData:{messageId:(0,d.yw)("OfficeVSO_8691849_CopilotChartToImage")?(0,g.A)():void 0,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p}},addCardToChatHistory:!1},telemetry:{featureName:h,eventType:l.a5.SuggestionMessage}}},getAnalyzeDataInfoResponse:function(e,t){const a=(0,g.A)();return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p},messageId:a,actionButtonList:(0,d.jH)()?[(0,m.yo)(a)]:void 0},addCardToChatHistory:t},telemetry:{featureName:h,eventType:l.a5.AnalyzeDataEmptyAnswer}}}};var f=a(80519),C=a(23147),y=a(61150),v=a(39504),T=a(85105);const x=l.q.CalculatedColumns,S=i.Xw.FORMULAGENERATION;const w={getFormulaSuggestionErrorResponse:function(e,t,a,n){const o=(0,v.J)(t.shouldShowFormulaDevButton,t.debugInfo),{message:r,telemetry:i}=(0,u.v)(e,{errorType:a??l.q0.ClientError,featureName:x},{embeddedLists:[{listItems:n}]},{feedbackData:{feedbackArea:S},...o?{actionButtonList:[o]}:{}});return{message:r,telemetry:i}},getFormulaSuggestionInsertSuccessResponse:function(e,t,a){return{message:{chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S},actionButtonList:(0,d.BA)()?[(0,m.FW)(x,t,a)]:[]}},telemetry:{featureName:x,eventType:l.a5.ActionConfirmationMessage}}},getFormulaSuggestionResponse:function(e,t,a){const o=a[t],i=0===t,u=C.CP.getActiveTable(),m=(0,d.qm)()?u?.address:void 0,g="number"==typeof u?.sheetRange.range.topLeft.column?(0,T._c)(o,{columnCount:u.numColumns,columnIndex:u.sheetRange.range.topLeft.column}):void 0,h=(0,f.cY)(o)&&null!=u?.sheetRange.range.bottomRight.row?u.totalRow?u.sheetRange.range.bottomRight.row+1:u.sheetRange.range.bottomRight.row+2:void 0,p=(0,c.Fp)(i,o,m,g,h);return(0,y.cY)("getFormulaSuggestionResponse",{requestId:e,requestIndex:t,recommendation:o,recommendationModels:a,textForChatHistory:p}),o||(0,y.cY)("formulaSuggestionModels: no recommendation"),{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:(0,s.IM)("FormulaSuggestion_V2",{requestId:e,isMainRecommendation:i,recommendation:o,targetAddress:m,columnLetters:g,rowNumber:h}),textContent:p}},chatMessageBodyData:{messageId:o.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S,contextData:{cardMetaData:JSON.stringify({suggestionId:a[0]?.id})}}}},telemetry:{featureName:(0,f.cY)(o)?l.q.CalculatedRows:l.q.CalculatedColumns,eventType:l.a5.SuggestionMessage}}},getInsertSuggestionUserChat:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:x,eventType:l.a5.HumanInput}}}};var E=a(2379),R=a(72483),I=a(92779),A=a(6925);const L=l.q.DataShaping,F=i.Xw.DATASHAPING;function _(e,t,a){const i={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,s.IM)(e,a)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:F}},stopLoadingUi:!0},c={featureName:L,eventType:l.a5.SuggestionMessage};return t(A.mF.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!1})),R.$.getInstance().displayResponse(i,c),{message:i,telemetry:c}}const N={getAddStepSuccessResponse:function(e,t){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:F},actionButtonList:(0,d.BA)()?[(0,m.yq)(t,L)]:[]}},telemetry:{featureName:L,eventType:l.a5.ActionConfirmationMessage}}},getApplyTableUpdatePlanSuccessResponse:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:F}}},telemetry:{featureName:L,eventType:l.a5.SuggestionMessage}}},getDataShapingErrorResponse:function(e){const t=e||(0,I.$oZ)();return(0,u.v)(t,{featureName:L,errorType:l.q0.ClientError},{},{feedbackData:{feedbackArea:F}})},getDataShapingDoneResponse:function(){const e=(0,I.VSu)();return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:F},actionButtonList:[]}},telemetry:{featureName:L,eventType:l.a5.ActionConfirmationMessage}}},getExitModeResponse:function(e){const t="replace"===e?(0,I.K1Z)():"newSheet"===e?(0,I.gXw)():(0,I.lp5)();return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:t}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:F},actionButtonList:[]}},telemetry:{featureName:L,eventType:l.a5.ActionConfirmationMessage}}},displayStartDataShapingResponse:function(e,t,a,n,o,r,i){return _("StartDataShaping_V1",e,{requestId:t,sessionId:n,tableName:a,mashupDocument:o,queryName:r,queryScript:i})},displayDataShapingIntroResponse:function(e,t){return _("DataShapingIntro_V1",e,{requestId:t})}};var k=a(93421),O=a(43861),P=a(48314),M=a(33540),D=a(74354),$=a(98100),B=a(67329),H=a(26543);const U=async e=>{e&&window.open(e,"_blank")};function q(e,t){return{linkText:{text:e,linkOnClick:U,linkUrl:t}}}function V(){return{messageHeader:{text:(0,I.eII)(),linkText:{text:I.Klw,linkOnClick:U,linkUrl:I.COL}}}}const G={getJunkQueryResponse:function(){const e=(0,I.AWW)();return(0,u.v)(e,{errorType:l.q0.DetectedJunkQuery})},getHelpQueryResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I.svm)()},embeddedLists:[{listItems:[{text:(0,I.L1E)()},{text:(0,I.UVk)()},{text:(0,I.$cm)()},{text:(0,I.UGc)()}]}],messageFooter:{text:(0,I.aXL)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.HelpMessage}}},getLearnMoreResponse:function(){const e=[];for(const t of(0,I.BU1)())e.push({text:t});return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I.bcx)()},embeddedLists:[{listItems:e}],messageFooter:q((0,I.VHx)(),I.wZB)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.HowCanCopilotHelpSuggestionClicked}}},getAugloopTimeoutResponse:function(){const e=C.CP.pythonContextManager.isPythonMode,t=(0,d.yw)("OfficeVSO_9333343_PythonAugloopTimeoutMessage")&&e?(0,I.ZgC)():(0,I.CY_)();return(0,u.v)(t,{errorType:l.q0.AugloopTimeout})},getStopGeneratingResponse:function(e){const t=(0,d.yw)("OfficeVSO_9301386_PythonModeSpecificMessages")&&C.CP.pythonContextManager.isPythonMode?(0,I.lJi)():(0,d.qm)()?(0,I.s_X)():(0,I.sHs)(),a={chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:t}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}};let i=l.q.CopilotChat;return e===l.OP.AnalyzeData?i=l.q.AnalyzeData:e===l.OP.CalculatedColumns?i=l.q.CalculatedColumns:e===l.OP.CalculatedCells&&(i=l.q.CalculatedRows),{message:a,telemetry:{featureName:i,eventType:l.a5.StopButtonClicked}}},getChangeTopicResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I.pH2)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.ChangeTopicButtonClicked}}},getAugloopErrorResponse:async function(e,t,a){const n=(0,$.uN)(e,t);let o=n,r=l.q0.ServiceError,i=!0,s={};const c=e.category;let m,g,h,p,b=!0;if((0,d.yw)("OfficeVSO_9321940_CopilotRefactorParseAugLoopErrorJson"))({errorCode:p,tlrSkillSupport:g,contextFailures:h}=(0,H.D)(e));else if(e.json)try{const t=JSON.parse(e.json);p=t.code,g=t.tabularRangeUnsupportedFeatureSkillFailures,h=t.unsupportedContextFeatures}catch(e){(0,y.cY)(y.SA.Error,"Failed to parse augloop error JSON: ",e)}const f=h?(0,M.AG)(h):void 0;switch(c){case O.E.LicensingError:o=(0,I.iUs)(),r=l.q0.LicensingError,i=!1,s=V();break;case O.E.OffensiveContent:o=I.xe2.ServerErrorWithNoRetry,r=l.q0.DetectedOffensiveContent;break;case O.E.TokenCountError:o=n,r=l.q0.TokenCount;break;case O.E.UnsupportedLanguageError:if(r=l.q0.DetectedUnsupportedLanguage,(0,d.yw)("OfficeVSO_9477289_UpdateUnsupportedLanguageMessage")){const e=a?.outputAnswerLanguage,t=(0,B.w)(e);s={messageHeader:{text:t?I.xe2.CopilotUnsupportedLanguageError.replace("%s",t):I.xe2.CopilotUnsupportedlanguageMessage,linkText:{text:I.xe2.CopilotSupportedLanguagesLearnMoreLink,linkUrl:I.JF4,linkSuffix:"\n\n"+I.xe2.FeedbackPrompt}}}}else s={messageHeader:{text:(0,I.MCi)()},messageFooter:q((0,I.Amo)(),I.JF4)};break;case O.E.InputQueryError:e.json?"unsupported-multi-agent"===p?(o=n,r=l.q0.DetectedMultipleIntents):"out-of-scope"===p?(o=(0,I.AWW)(),r=l.q0.DetectedOutOfScope):"bad-token"===p?(o=(0,I.iUs)(),r=l.q0.BadToken,i=!1,s=V()):"too-short"===p?(o=(0,I.l_I)(),r=l.q0.DetectedTooShort):(o=n,r=l.q0.ServiceError):(o=n,r=l.q0.ServiceError);break;case O.E.ExcelTabularSkillFailedError:f?m=(0,D.rE)(f):g?m=await(0,D.X$)(g):(o=n,r=l.q0.ServiceError);break;case O.E.InferenceAPIError:(0,d.yw)("OfficeVSO_9076919_ShowThrottlingErrorMessage")&&"user-throttled"===p?(o=(0,I.UDz)(),r=l.q0.UserThrottled):(o=n,r=l.q0.ServiceError);break;case O.E.IgnorableError:case O.E.SydneyError:"out-of-credits"===p&&(o=(0,I.R_I)());break;default:o=n,r=l.q0.ServiceError,b=!1}return m||(m=(0,u.v)(o,{errorType:r},s)),!b&&(0,d.th)()||(0,d.yw)("OfficeVSO_8936807_AshaLogging")&&(0,k.y)(e,P.M.getInstance().getActiveFeature()),m.telemetry.useClientSideErrorMessage=b,m.message.addCardToChatHistory=i,(0,d.jH)()&&(m.telemetry.devInfo={category:e.category,message:e.message,json:JSON.parse(e.json??"{}")}),m},getZeroQueryResponse:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.ZeroQueryMessageSuggestionClicked}}},getStreamingResponse:function({basin:e,uniqueId:t,accessPath:a,value:i,actionButtonList:s}){return{message:{chatCardType:n._.StreamingAdaptiveCard,chatMessageData:{streamingAdaptiveCardProps:{user:o.Q9.Chat,basin:e,uniqueId:t,accessPath:a,value:i}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,actionButtonList:s}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.ConversationMessage}}},getLanguageUnavailableResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I.rZm)()},messageFooter:q((0,I.Amo)(),I.JF4)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1},...(0,d.yw)("OfficeVSO_9135445_RemoveUnsupportedLanguageErrorFromChatHistory")?{addCardToChatHistory:!1}:{}},telemetry:{featureName:l.q.CopilotChat,eventType:l.a5.LanguageNotAvailableMessage}}},getExternalTriggeredQueryResponse:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:l.q.ExternalTriggeredQuery,eventType:l.a5.SuggestionMessage}}},getChatHistoryHydrationFailed:function(){return(0,u.v)((0,I.Bjy)(),{errorType:l.q0.ChatHistoryHydrationFailed},void 0,{messageId:"chatHistoryHydrationFailed"},{addCardToChatHistory:!1})},getDisengagedErrorResponse:function(){return(0,u.v)((0,I.KC)(),{errorType:l.q0.OrchestratorDisengaged},void 0,void 0,{addCardToChatHistory:!0})}},W=i.Xw.IMPORTDATA;function z(e){return e.length>0?(0,I.h9u)().replace("{0}",e.length.toString()):(0,I.u1U)()}const Q={getImportDataResponse:function({importType:e,requestId:t,dataSources:a,messageId:i,userQueryGuid:c,clpData:d,performedFallbackToAllTables:u}){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,s.IM)("ImportData_V1",{requestId:t,dataSources:a,messageId:i,userQueryGuid:c,performedFallbackToAllTables:u}),textContent:z(a)}},chatMessageBodyData:{messageId:t,shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:W},clpSensitivityIndicatorData:d&&""!==d.labelId?d:void 0}},telemetry:{featureName:e,eventType:l.a5.ImportDataCard}}},getImportDataSimpleMessage:function(e,t){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{actionButtonList:[],shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:W}}},telemetry:{featureName:t,eventType:l.a5.ActionConfirmationMessage}}}},J=l.q.InsertTable,j=i.Xw.INSERTTABLE;const Y={getInsertTableErrorResponse:function(e,t,a){const{message:n,telemetry:o}=(0,u.v)(e,{errorType:t??l.q0.ClientError,featureName:J},{embeddedLists:[{listItems:a}]},{feedbackData:{feedbackArea:j}});return{message:n,telemetry:o}},getInsertTableSuccessResponse:function(e,t){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:j},actionButtonList:(0,d.BA)()?[(0,m.FW)(J)]:[]}},telemetry:{featureName:J,eventType:l.a5.ActionConfirmationMessage}}}};var X=a(94773),K=a(35828);const Z=l.q.PythonCalculatedColumns,ee=i.Xw.PYTHONCALCULATEDCOLUMNS;const te={getPythonCalculatedColumnSuggestionResponse:function(e,t,a,o,i,c){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:(0,s.IM)("PythonCalculatedColumn_V1",{requestId:e,recommendation:t,targetAddress:a,columnLetters:o,sheetId:i,insertCallback:c})}},chatMessageBodyData:{messageId:t?.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ee,contextData:{cardMetaData:JSON.stringify({suggestionId:t.id})}}}},telemetry:{featureName:l.q.PythonCalculatedColumns,eventType:l.a5.SuggestionMessage}}},getPythonColumnInsertResponse:function(e,t){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ee},actionButtonList:(0,d.BA)()?[(0,m.FW)(Z,t)]:[]}},telemetry:{featureName:l.q.PythonCalculatedColumns,eventType:l.a5.ActionConfirmationMessage}}},getPythonColumnSuggestionErrorResponse:function(e,t,a){const{message:n,telemetry:o}=(0,u.v)(e,{errorType:t??l.q0.ClientError,featureName:Z},{embeddedLists:[{listItems:a}]},{feedbackData:{feedbackArea:ee}});return{message:n,telemetry:o}},getPythonColumnInsertErrorResponse:function(e,t){const a={featureName:l.q.PythonCalculatedColumns,eventType:l.a5.ErrorMessage,errorType:l.q0.PythonCalculatedColumnsError,devInfo:(0,K.jK)(e)},{message:n,telemetry:o}=(0,u.v)(t,a);return{message:n,telemetry:o}}};var ae=a(65118);const ne=i.Xw.COMMANDING;const oe={getRangeConvertToTableSuccessResponse:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I.H6b)().replace("{0}",e??"")}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:(0,d.BA)()?[(0,m.FW)(l.q.ConvertToTable)]:[],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ne}}},telemetry:{featureName:l.q.ConvertToTable,eventType:l.a5.ActionConfirmationMessage}}},getShowHeaderButtonResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:(0,I.QCY)()}}}},telemetry:{featureName:l.q.ShowHeaders,eventType:l.a5.HumanSuggestionApplied}}},getShowHeaderButtonSuccessResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I.ZOE)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ne}}},telemetry:{featureName:l.q.ConvertToTable,eventType:l.a5.ActionConfirmationMessage}}},getSampleTableDataResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:(0,I.px2)()}}}},telemetry:{featureName:l.q.SampleData,eventType:l.a5.HumanInput}}},getSampleTableDataSuccessResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,I._J3)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:(0,d.BA)()?[(0,m.FW)(l.q.ConvertToTable)]:[],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ne}}},telemetry:{featureName:l.q.SampleData,eventType:l.a5.ActionConfirmationMessage}}}},re={...G,...ae.n,...te,...E.n,...w,...b,...oe,...X.n,...Y,...N,...Q}},94773:(e,t,a)=>{a.d(t,{m:()=>f,n:()=>y});var n=a(28087),o=a(33500),r=a(19080),i=a(92779),l=a(93772),s=a(88179),c=a(96854),d=a(48314),u=a(4475);function m(e){if(e.fileUrl){const t=e.fileUrl.lastIndexOf("/");if(-1!==t)return e.fileUrl.slice(0,t)}}var g=a(10216);const h=s.q.OfficeScripts,p=l.Xw.OFFICESCRIPTS;var b,f;!function(e){e.SaveScriptHiTLCard="SaveScriptHiTLCard",e.CompletedSaveScriptCard="CompletedSaveScriptCard",e.SaveErrorCard="SaveErrorCard",e.DeleteScriptErrorCard="DeleteScriptErrorCard",e.DeleteScriptConfirmationCard="DeleteScriptCompletedCard",e.ScheduleScriptHiTLCard="ScheduleScriptHiTLCard",e.ScheduleScriptConfirmationCard="ScheduleScriptConfirmationCard",e.ScheduleErrorCard="ScheduleErrorCard"}(b||(b={})),function(e){e.SaveScript="SaveScript",e.ScheduleScript="ScheduleScript",e.RunScript="RunScript"}(f||(f={}));const C={SaveScript:"SaveErrorCard",ScheduleScript:"ScheduleErrorCard",RunScript:"RunErrorCard"};const y={getOfficeSaveScriptHiTL:function(e,t,a,l,c){const d=e.map((e=>({text:e}))),m=t.name;return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,embeddedLists:l?[]:[{listItems:d}],messageHeader:{text:l?(0,i.ak4)().replace("{0}",m):(0,i.gnM)().replace("{0}",m)}}},chatMessageBodyData:{actionButtonList:[(0,u.JE)(t,a,c)],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"SaveScriptHiTLCard"})}}}},telemetry:{featureName:h,eventType:s.a5.ActionConfirmationMessage}}},getSavedScriptCompletedResponse:function(e,t=!1){const a=e.name;return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.Y55)()},messageFooter:{text:(0,i.IH5)().replace("{0}",a)}}},chatMessageBodyData:{actionButtonList:t?[(0,u.zL)(e),(0,u.vu)(h,e)]:[(0,u.zL)(e)],feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"CompletedSaveScriptCard"})}}}},telemetry:{featureName:h,eventType:s.a5.ActionConfirmationMessage}}},getOfficeScriptErrorResponse:function(e,t,a){return(0,g.v)(e,{featureName:h,errorType:a??s.q0.ClientError},{},{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:C[t]})}}})},getOfficeScriptSimpleResponse:function(e,t,a=!1){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:a?o.Q9.Human:o.Q9.Chat,messageHeader:{text:e}}}},telemetry:{featureName:h,eventType:t}}},getOfficeScriptDeleteScriptErrorResponse:function(e){const t=m(e),a=(0,i.Hdt)().replace("{0}",e.name).split("{1}"),l={chatCardType:n._.Default,chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"DeleteScriptErrorCard"})}}}},u={featureName:h,eventType:s.a5.ErrorMessage};if(t){return{message:{...l,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:a[0],linkText:{text:(0,i.Nfx)(),linkOnClick:()=>{const e=d.M.getInstance();c.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.OfficeScriptsLinkClicked,[s.h3.ChatEventParameters]:JSON.stringify({featureName:s.q.OfficeScripts})},e)},linkUrl:m(e),linkSuffix:a[1]}}}}},telemetry:u}}return{message:{...l,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:a[0].concat((0,i.Nfx)(),a[1])}}}},telemetry:u}},getOfficeScriptDeleteScriptSuccessResponse:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.y9Z)().replace("{0}",e)}}},chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"DeleteScriptCompletedCard"})}}}},telemetry:{featureName:h,eventType:s.a5.ActionConfirmationMessage}}},getOfficeScriptsScheduleScriptFluxResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.r8x)()}}},chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"ScheduleScriptConfirmationCard"})}}}},telemetry:{featureName:h,eventType:s.a5.ActionConfirmationMessage}}},getOfficeScriptsScheduleScriptHiTLResponse:async function(e,t,a,l,c){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.T5i)().replace("{0}",e.name)},embeddedLists:[{listItems:[{text:t}]}]}},chatMessageBodyData:{actionButtonList:[await(0,u.NQ)(e,a,l,c)],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"ScheduleScriptHiTLCard"})}}}},telemetry:{featureName:h,eventType:s.a5.ActionConfirmationMessage}}}}},65118:(e,t,a)=>{a.d(t,{n:()=>_});var n=a(28087),o=a(33500),r=a(19080),i=a(72483),l=a(93772),s=a(92779),c=a(66888),d=a(80132),u=a(35828),m=a(97667),g=a(88179),h=a(31030),p=a(6925),b=a(23147),f=a(91259),C=a(50347),y=a(59726),v=a(78651),T=a(4475),x=a(46224),S=a(98483);const w=l.Xw.PYTHON;function E(e,t){const a=t.extractOper(e);return t.checkIsBusy(a)?void 0:a}async function R(e,t,a,n){const o=await n;return await(0,x.AJ)((async()=>{const n=e.getRange(a).load(["valuesAsJson"]);e.load("id"),await t.sync();const r=n.valuesAsJson[0][0];return{pythonCell:r,sheetId:e.id,cellTypeAndValue:E(r,o)}}),(e=>void 0!==e),(0,C.yw)("OfficeVSO_9441668_useRetryError")?Math.ceil(await b.CP.pythonContextManager.getPythonExecutionTimeoutInMilliseconds()/b.CP.pythonContextManager.RETRY_WAIT_IN_MILLISECONDS):b.CP.pythonContextManager.RETRY_WAIT_IN_MILLISECONDS,b.CP.pythonContextManager.RETRY_WAIT_IN_MILLISECONDS)}function I(){const e=b.CP.pythonContextManager.lastCodeAndPostViewMessage;if(void 0===e)throw(0,u.pz)("Cannot find the last postview message while updating. Function: getPythonCodeAndPostViewCardProps.");return{message:e,component:e.chatMessageData.chatCardWrapperProps.renderData.component,props:e.chatMessageData.chatCardWrapperProps.renderData.props}}function A(e,t,a,n){t.chatMessageData.chatCardWrapperProps.renderData=(0,d.Av)(a,n,{isPythonExecutionSuccess:!1},h.S.PythonError);const o={featureName:g.q.Python,eventType:g.a5.PythonCodeAndPostViewCardUpdatedWithError};i.$.getInstance().updateMessage(t),F(e,t,o,c.Aw.success,!1)}function L(e,t=!1,a,n=[]){const o=(0,S.A)();return{shouldShowAIGeneratedIndicator:e,feedbackData:t?void 0:{feedbackArea:w},feedbackSectionPosition:t?void 0:r.O.Footer,messageId:o,actionButtonList:a&&(0,C.jH)()?[...n,(0,T.yo)(o)]:n}}function F(e,t,a,n,o,r=!1){let i="";try{if(i=JSON.stringify({text:(0,y.N)(t),publishPreference:"Never",stopLoadingUi:o}),o){const t=n===c.Aw.success;(0,C.yw)("OfficeVSO_9490274_awaitStopBeforeSendingSkllResponseForPython")?e(p.mF.stopExecutingAndReleaseContextLock(t,r)):e(p.mF.stopExecutingAndReleaseContextLock(t))}}catch(t){const a=`Error while sending skill response to Flux, ProgramResponseStatus: ${n}, ShouldContinueLoadingUi: ${r},`,o=(0,u.HF)(a);(0,u.Kx)(e,o,"sendPythonSkillResponseToFlux")}e(p.mF.sendSkillResponseToFlux(i,n,a,!0,o))}const _={displayPythonAdaRecommendationResponse:function({dispatch:e,requestId:t,code:a,codeExplanation:r,codeLabel:l}){const s=(0,v.if)(a,r),u={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,d.IM)("PythonAdaRecommendation_V1",{requestId:t,code:a,codeExplanation:r,codeLabel:l}),textContent:s}},stopLoadingUi:!1,chatMessageBodyData:L(!0)},m={featureName:g.q.Python,eventType:g.a5.SuggestionMessage};i.$.getInstance().displayResponse(u,m),F(e,u,m,c.Aw.success,!1)},displayPythonStartAnalysisResponse:function(e,t,a,r){const l=(0,v.F)(),s={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,d.IM)("PythonStartAnalysis_V1",{requestId:t,shouldShowRecalcNotice:a}),textContent:l}},stopLoadingUi:!0,chatMessageBodyData:L(!1)},u={featureName:g.q.Python,eventType:g.a5.SuggestionMessage};e(p.mF.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),i.$.getInstance().displayResponse(s,u),F(e,s,u,c.Aw.success,!0,!r)},displayPythonTextResponse:function(e,t,a,r=!1,l=!1,s){const d={chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:t,horizontalTableScroll:!0,disableLinksProcessing:!0,shouldApplyInputLinkTheme:!0}},stopLoadingUi:l,chatMessageBodyData:L(a,r,void 0,s)},u={featureName:g.q.Python,eventType:g.a5.SuggestionMessage};i.$.getInstance().displayResponse(d,u),F(e,d,u,c.Aw.success,l)},displayPythonErrorResponse:function(e,t,a){(0,x.FN)(t);const r=(0,u.Qh)(t),l={chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:r,disableLinksProcessing:!0,shouldApplyInputLinkTheme:!0}},stopLoadingUi:!0,chatMessageBodyData:L(!1,!1,t,a)},s={featureName:g.q.Python,eventType:g.a5.ErrorMessage,errorType:g.q0.PythonError,devInfo:(0,u.jK)(t)};(0,C.yw)("OfficeVSO_9413108_AddPythonDevButtonDetailsToOCVDetails")&&(b.CP.pythonContextManager.ocvErrorDetails=s),i.$.getInstance().displayResponse(l,s),F(e,l,s,c.Aw.failed,!0),(0,C.Eq)()&&(0,m.vY)(m.hn.PythonError,t)},displayPythonPostViewResponse:async function(e,t,a,r,l,u){u??(u=(0,S.A)());const{pythonCell:m,sheetId:h,cellTypeAndValue:p}=await R(t,a,r,l);if(p){const t=JSON.stringify(m);let a=(0,f.L)((0,s.vX0)(),[r]);a+=t;const l={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,d.IM)("PostView",{requestId:u,cellAddress:r,sheetId:h,pythonCell:m}),textContent:a}},stopLoadingUi:!1,chatMessageBodyData:L(!0)},p={featureName:g.q.Python,eventType:g.a5.PythonPostView};i.$.getInstance().displayResponse(l,p),F(e,l,p,c.Aw.success,!1)}},displayPythonCodeCardWithPendingPostView:function(e,t,a,r,l,u,m,h){const y=(0,f.L)(u?(0,s.oMg)():(0,s.vX0)(),[l])+"\n"+(0,v.if)(a,m),T=(0,C.yw)("OfficeVSO_9511880_PythonAAAddResultsInAnotherSheetBugFixes")?e(p.mF.getLastPythonRequestId()):b.CP.pythonContextManager.lastPythonUserRequestId,x=L(!0),S={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,d.IM)("CodeAndPostView",{requestId:t,code:a,cellAddress:l,sheetId:r,pythonCell:void 0,codeLabel:h,codeExplanation:m,pythonUserRequestId:T,isInitialDataFrame:u}),textContent:y}},stopLoadingUi:!1,chatMessageBodyData:x},w={featureName:g.q.Python,eventType:g.a5.PythonCodeAndPostViewCardShown};return i.$.getInstance().displayResponse(S,w),F(e,S,w,c.Aw.success,!1),S},updatePythonCodeAndPostViewCardWithPostView:async function(e,t,a,n,o,r){const{message:l,component:s,props:u}=I(),{pythonCell:m,cellTypeAndValue:p}=await R(n,o,t,a);if(void 0!==p&&void 0!==m){let t=l.chatMessageData.chatCardWrapperProps.textContent??"";t+=JSON.stringify(m),l.chatMessageData.chatCardWrapperProps.textContent=t,l.chatMessageData.chatCardWrapperProps.renderData=(0,d.Av)(s,u,{pythonCell:m,diagnosticsEntry:r},h.S.PythonError);const a={featureName:g.q.Python,eventType:g.a5.PythonCodeAndPostViewCardUpdatedWithResult};i.$.getInstance().updateMessage(l),F(e,l,a,c.Aw.success,!1)}else A(e,l,s,u)},updatePythonCodeAndPostViewCardWithError:function(e){const{message:t,component:a,props:n}=I();A(e,t,a,n)}}},74354:(e,t,a)=>{a.d(t,{$o:()=>v,X$:()=>T,rE:()=>w});var n=a(28087),o=a(19080),r=a(93772),i=a(88179),l=a(92779),s=a(82623),c=a(31030),d=a(48314),u=a(23147),m=a(33540),g=a(27626),h=a(50347),p=a(4475),b=a(55143),f=a(2460),C=a(8348),y=a(98483);function v(e){return e===i.q0.UnsupportedTabularRange||e===i.q0.NoTableLikeEntityFound||e===i.q0.UnsupportedObjectDetected||e===i.q0.TLRAutofixSuggestion}async function T(e){const t=u.CP.getActiveTable()?.address,a=u.CP.getActiveTable()?.tableLikeRangeFeatures,v=()=>({message:R((0,l.MKr)().replace("\n\n","\n\n&nbsp;\n\n")),telemetry:{featureName:i.q.ContextInference,eventType:i.a5.ErrorMessage,errorType:i.q0.NoTableLikeEntityFound}}),T=(0,m.kB)(e);if(t&&a&&T){const e=T&a;if(0===e)return d.M.getInstance().logError({eventType:c.S.TabularRange,errorMessage:"No unsupported TLR features found",logLevel:i.$b.Warning}),v();const u=(0,m.kw)(e),w=(0,m.Ks)(u);return 1===w.length?await E(t,e,w):await async function(e,t,a){let i=a;(0,h.yw)("OfficeVSO_9271215_singleRowMajorError")&&t&s.ye.RowMajor&&(i=[s.ye.RowMajor]);i=(0,h.yw)("OfficeVSO_9271219_onlyShowEmptyHeaderMessage")&&t&s.ye.EmptyHeaders?(0,m.S5)(i).filter((e=>e!==s.ye.DuplicateHeaders)):(0,m.S5)(i);if(1===i.length)return E(e,t,i);if(await(0,C.f6)(t)){return{message:await(0,g.ge)(e,t),telemetry:(0,h.yw)("OfficeVSO_9578563_autofixTelemetry")?S(t):x(t)}}const c=i.map((e=>({header:(0,m.Ah)(e),description:(0,m.f0)(e)}))),d=(0,l.S7l)().replace("{range}",(0,b.G2)(e)),u=(0,h.yw)("OfficeVSO_9267571_DisplayConvertToTableConclusionMessage")?(0,m.hd)(i):(0,l.VH3)(),v=function(e,t,a){const i=(0,y.A)();return{chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:I(e,t,a),horizontalTableScroll:!0,componentsOverride:(0,f.G)(e)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,feedbackData:{feedbackArea:r.Xw.CONTEXT},shouldShowFeedbackSection:!0,messageId:i,actionButtonList:(0,h.jH)()?[(0,p.yo)(i)]:void 0},addCardToChatHistory:!0}}(c,d,u),T=x(t);return{message:v,telemetry:T}}(t,e,w)}return v()}function x(e){return{featureName:i.q.ContextInference,eventType:i.a5.ErrorMessage,errorType:i.q0.UnsupportedTabularRange,errorDetails:{TabularRangeUnsupportedFeature:e}}}function S(e){return{featureName:i.q.ContextInference,eventType:i.a5.ErrorMessage,errorType:i.q0.TLRAutofixSuggestion,errorDetails:{TabularRangeUnsupportedFeature:e}}}function w(e){const t=function(e){const t=(0,y.A)();return{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,h.jH)()?[(0,p.yo)(t)]:void 0,feedbackData:{feedbackArea:r.Xw.CONTEXT}},addCardToChatHistory:!0}}((0,m.ey)(e)),a=function(e){const t=e===s.b_.PayloadTooLarge?i.q0.LargeData:i.q0.UnsupportedObjectDetected;return{featureName:i.q.ContextInference,eventType:i.a5.ErrorMessage,errorType:t,errorDetails:{UnsupportedContextFeature:e}}}(e);return{message:t,telemetry:a}}async function E(e,t,a){const n=a[0];let o;if(await(0,C.f6)(t)){if(o=await(0,g.ge)(e,t),(0,h.yw)("OfficeVSO_9578563_autofixTelemetry")){return{message:o,telemetry:S(t)}}}else{o=R((0,m.Zv)(n).replace("{range}",(0,b.G2)(e)))}return{message:o,telemetry:x(t)}}function R(e){const t=(0,y.A)();return{chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e,horizontalTableScroll:!0}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,h.jH)()?[(0,p.yo)(t)]:void 0,feedbackData:{feedbackArea:r.Xw.CONTEXT}},addCardToChatHistory:!0}}function I(e,t,a){let n=`${t}\n`;return e.forEach((e=>{n+=`\n- ${e.header}\n\n`})),n+=`\n\n${a}`,n}},23147:(e,t,a)=>{a.d(t,{CP:()=>Y,En:()=>j});var n=a(89099),o=a(24220),r=a(61150),i=a(81364),l=a(49134),s=a(4475),c=a(88179),d=a(36131),u=a(52389),m=a(92779),g=a(93111),h=a(46224);class p{getPythonCalculatedColumnContext(){return{columnCode:this.columnCode}}async updatePythonColumns(){return Excel.run((async e=>{const t=Y.getActiveWorksheetId();if(!t)return;const a=e.workbook.worksheets.getItem(t),n=Y.getActiveTable();if(n){const t=a.getRange(n.address).getRow(1).load(["formulas","values"]);await e.sync();const o=t.formulas[0],r=t.values[0],i=[];for(let e=0;e<o.length;e++){const t=o[e],a=r[e];if(!t.toString().startsWith("=PY")||t===a)continue;const n=(0,h.vv)(t);""!==n&&i.push(n)}this.columnCode=i}}))}constructor(){this.columnCode=[]}}p.getInstance=()=>(void 0===p._instance&&(p._instance=new p),p._instance);var b,f,C,y=a(49783),v=a(35828);function T(e,t,a){const n=e instanceof DOMException&&"QuotaExceededError"===e.name&&window.localStorage&&0!==window.localStorage.length;switch(a){case"PythonAaTuiShown":{const e=`Failed to ${t} ${a} in local storage. Local storage is ${n?"available":"not available"}.`,o=(0,v.h3)(i.O.PythonTuiNotShownError,e);(0,v.QX)(void 0,o,!1);break}}return n?"QuotaExceeded":"LocalStorageNotAvailable"}!function(e){e.PythonAaTuiShown="PythonAaTuiShown"}(b||(b={})),function(e){e.KeyNotFound="KeyNotFound",e.QuotaExceeded="QuotaExceeded",e.LocalStorageNotAvailable="LocalStorageNotAvailable"}(f||(f={})),function(e){e.Read="Read",e.Write="Write"}(C||(C={}));var x=a(8505),S=a(84036),w=a(50347),E=a(33851);class R{getPythonConversationHistory(){return this.pythonConversationHistory}clearPythonContextBuilder(){this.pythonConversationHistory=[],this.otherPythonCells=[],this.pythonPrompt=""}getOtherPythonCells(){return this.otherPythonCells}setQuery(e){this.pythonConversationHistory.push({query:e})}setSelectedPythonTableContext(e){this.pythonConversationHistory.push({tableContext:e})}setSelectedPythonCellContext(e){this.pythonConversationHistory.push({pythonContext:e})}setLlmText(e){this.pythonConversationHistory.push({llmResponse:e})}setCodeAndOutput(e){this.pythonConversationHistory.push({codeAndOutput:e})}setFinalResponse(e){this.pythonConversationHistory.push({finalResponse:e})}setPythonPrompt(e){this.pythonPrompt=e}getPythonPrompt(){return this.pythonPrompt}async updateConversationHistory(e){const t=new Set;for(let a=0;a<this.pythonConversationHistory.length;a++){const n=this.pythonConversationHistory[a];if(n.tableContext){const e=n.tableContext,t=n.tableContext.tableType===x.lp.TableLikeRange?await Y.pythonContextManager.getUpdatedPythonTableContextForTableLikeRange(e):await Y.pythonContextManager.getUpdatedPythonTableContext(n.tableContext);t?this.pythonConversationHistory[a]={tableContext:t}:n.tableContext.wasDeleted=!0}if(n.pythonContext){const o=n.pythonContext.sheetAddress,r=e.get(n.pythonContext.sheetAddress);r?(this.pythonConversationHistory[a]={pythonContext:r},t.add(o)):n.pythonContext.wasDeleted=!0}if(n.codeAndOutput){const o=n.codeAndOutput.sheetAddress,r=e.get(n.codeAndOutput.sheetAddress);r?(this.pythonConversationHistory[a]={codeAndOutput:r},t.add(o)):n.codeAndOutput.wasDeleted=!0}}const a=Array.from(e.values()).filter((e=>!t.has(e.sheetAddress)));this.otherPythonCells=a}calculatePythonRangeDifference(e,t){return e.rowIndex!==t.rowIndex?e.rowIndex-t.rowIndex:e.columnIndex-t.columnIndex}async getPythonCellsFromWorksheet(e,t){try{const a=(new Date).getTime(),n=[],o=t.getUsedRange();if(o.load(["address","formulas","rowIndex","columnIndex","values"]),await e.sync(),(0,w.yw)("OfficeVSO_9228951_nullCheckFormulasAndValues")&&(!o.formulas||!o.values)){const e=`range.formulas: ${o.formulas?"Defined":"Undefined"}, range.values: ${o.values?"Defined":"Undefined"}`;return(0,E.ii)(e),[]}const r=o.address,i=l.ExcelCalc.sheetAddressToExcelSheetRange(r).range.topLeft,s=i.row??0,c=i.column??0;for(let e=0;e<o.formulas.length;++e)for(let a=0;a<o.formulas[0].length;++a){const r=o.formulas[e][a],i=o.values[e][a];if(r.toString().startsWith("=PY")&&(r!==i&&h.sy.test(r))){const o=t.getRangeByIndexes(s+e,c+a,1,1);o.track(),n.push(o),o.load(["address","rowIndex","columnIndex"])}}return await e.sync(),0===n.length?[]:(n.sort(((e,t)=>this.calculatePythonRangeDifference(e,t))),(0,S.Cc)(S.xk.GetPythonCellsFromWorksheet,a,!0),n)}catch(e){if((0,w.yw)("OfficeVSO_9365563_InsertDataFrameUseId")&&e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound){const e="getPythonCellsFromWorksheet: sheet deleted";throw(0,v.Uc)(i.O.PythonUnexpectedMissingSheetInContextExtraction,e)}throw e}}async getAllPythonCellsUptoAnalysisSheet(e,t){return Excel.run({delayForCellEdit:!(0,w.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")},(async a=>{const n=(new Date).getTime(),o=new Map,r=a.workbook.worksheets.load("items");await a.sync();const i=r.items,l=Y.pythonContextManager.pythonAnalysisSheetId;let s;s=l?i.findIndex((e=>e.id===l)):i.length-1,-1===s&&(s=i.length-1);const c=i.slice(0,s+1);for(const n of c){let r=[];if(r=await this.getPythonCellsFromWorksheet(a,n),!(0,w.yw)("OfficeVSO_9052463_UsePythonAnalysisSheetRangeForContextExtraction"))if(n.id===e){const e=n.getRange(t);e.load(["rowIndex","columnIndex"]),await a.sync(),r=r.filter((t=>{const a=this.calculatePythonRangeDifference(t,e)<=0;return t.untrack(),a}))}else r.forEach((e=>{e.untrack()}));for(let e=0;e<r.length;e++){const t=(0,h.c3)(r[e].address),a=await Y.pythonContextManager.getPythonCellContext(n.id,t);o.set(t,a),r[e].untrack()}}return await a.sync(),(0,S.Cc)(S.xk.GetAllPythonCellsUptoAnalysisSheet,n,!0),o}))}async getLastPythonCellOnSheet(e){return Excel.run({delayForCellEdit:!(0,w.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")},(async t=>{const a=(new Date).getTime(),n=t.workbook.worksheets.getItem(e);let o=[];o=await this.getPythonCellsFromWorksheet(t,n);const r=o.length;if(0===r)return;const i=(0,h.c3)(o[r-1].address),l=await Y.pythonContextManager.getPythonCellContext(n.id,i);return(0,S.Cc)(S.xk.GetLastPythonCellOnSheet,a,!0),l}))}constructor(){this.pythonConversationHistory=[],this.otherPythonCells=[],this.pythonPrompt=""}}R._instance=void 0,R.getInstance=()=>(void 0===R._instance&&(R._instance=new R),R._instance);class I{async setPythonStartAnalysisContext(e){if(!this.query){const e=`Undefined Item: query, Function: setPythonStartAnalysisContext, isPythonCellSelected: ${Y.isPythonCellSelected}`;throw(0,v.Uc)(i.O.PythonContextUndefinedParameter,e)}if(!this.sheetId||!this.address){const e=`\n      Address: ${this.address?"Defined":"Undefined"},\n      Sheet Id: ${this.sheetId?"Defined":"Undefined"},\n      Function: setPythonStartAnalysisContext, isPythonCellSelected: ${Y.isPythonCellSelected}`;throw(0,v.Uc)(i.O.PythonContextUndefinedParameter,e)}Y.pythonContextManager.pythonContextBuilder.clearPythonContextBuilder(),this.pythonCellContext?this.pythonContextBuilder.setSelectedPythonCellContext(this.pythonCellContext):this.pythonTableContext&&this.pythonContextBuilder.setSelectedPythonTableContext(this.pythonTableContext),this.pythonContextBuilder.setQuery(this.query),await this.pythonContextBuilder.updateConversationHistory(e)}updateTrimmedContext(e){const{query:t,sheetId:a,address:n,pythonCellContext:o,pythonTableContext:r}=e;this.query=t,this.sheetId=a,this.address=n,this.pythonCellContext=o,this.pythonTableContext=r,(0,w.yw)("OfficeVSO_9302535_PythonLogTrimmedContextModified")&&(0,E.xX)(E.Am.Update,!t,Error().stack)}setPythonCellContext(e){this.pythonCellContext=e}setPythonTableContext(e){this.pythonTableContext=e}getTrimmedContextQuery(){return this.query}getTrimmedContextSheetId(){return this.sheetId}getTrimmedContextAddress(){return this.address}getPythonTableContext(){return this.pythonTableContext}clearTrimmedContext(){this.query=void 0,this.sheetId=void 0,this.address=void 0,this.pythonCellContext=void 0,this.pythonTableContext=void 0,(0,w.yw)("OfficeVSO_9302535_PythonLogTrimmedContextModified")&&(0,E.xX)(E.Am.Clear,!0,Error().stack)}async insertDataFrameIfNecessaryForStartAnalysis(e,t){const a=(new Date).getTime(),n=this.getPythonTableContext();if(n){const a=n.tableName,o=n.tableType===x.lp.TableLikeRange;let r=!0;(0,w.yw)("OfficeVSO_9321092_InsertDataframeWithHeaderFalse")&&(r=n.headers!==m.r$C);const i=!!(0,w.yw)("OfficeVSO_9426161_DataframeShouldExcludeTotalRowForTLR")&&n.hasTotalRow,l=await(0,h.T7)(a,n.sheetAddress,o,r,i,e,t);if((0,w.yw)("OfficeVSO_9507767_StopRunningPythonAAOnStopGenerate")&&!Y.pythonContextManager.shouldGenerate)return;const{sheet:s,address:c}=(0,h.B4)(l,e),d=await Y.pythonContextManager.getPythonCellContext(s,c);d&&(this.setPythonCellContext(d),this.setPythonTableContext(void 0))}else(0,w.yw)("OfficeVSO_9343958_InsertSheetWithBlankCellAnalysis")&&(0,h.nC)(t,Y);(0,S.QO)(S.xk.InsertDataFrameIfNecessaryForStartAnalysis,a)}constructor(){this.pythonContextBuilder=R.getInstance()}}I.getInstance=()=>(void 0===I._instance&&(I._instance=new I),I._instance);var A=a(48314),L=a(55143),F=a(14588),_=a(98483);class N{async getMaxRetryAttempts(){return Math.ceil(await this.getPythonExecutionTimeoutInMilliseconds()/this.RETRY_WAIT_IN_MILLISECONDS)}registerOnNewEntry(){this.requestContext.workbook.externalCodeService.diagnostics.onNewEntry.add(y.w)}unregisterOnNewEntry(){this.requestContext.workbook.externalCodeService.diagnostics.onNewEntry.remove(y.w)}enterAdvancedAnalysisMode(){Y.pythonContextManager.isPythonMode=!0,Y.pythonContextManager.analysisSessionId=(0,_.A)(),Y.pythonContextManager.isFirstCodeExecution=!0,Y.pythonContextManager.registerOnNewEntry()}async init(e){this.dispatch=e}get alreadyShownTui(){return this._alreadyShownTui}set alreadyShownTui(e){this._alreadyShownTui=e,function(e,t){try{return localStorage.setItem(e,t),{isSuccess:!0,errorType:void 0}}catch(t){return{isSuccess:!1,errorType:T(t,"Write",e)}}}(b.PythonAaTuiShown,e?"true":"false")}async recalcSheet(e=!1){const t=(new Date).getTime(),a=this.pythonTrimmedContext.sheetId;if(!a)return void(0,E.PB)(E.L3.RecalcSheetMissingSheetId,[]);const n=await(0,h.eU)();if(n===Excel.CalculationMode.automatic){if(e)this.requestContext.application.calculate(Excel.CalculationType.full);else{this.requestContext.workbook.worksheets.getItem(a).calculate(!0)}await this.requestContext.sync()}(0,S.Cc)(S.xk.RecalcSheet,t,!0,`Calculation Mode: ${n}`)}async getActiveTableContext(e){const t=Y.getActiveTable();if(t){const a=(new Date).getTime(),n=l.ExcelCalc.IExcelSheetRangeToSheetAddress(t.sheetRange),o=await(0,F.vq)(t,e,n,this.dispatch,this.requestContext,this.MAX_SAMPLE_ROWS),r=(0,h.c3)(n),i={tableName:t.name,headers:t.headers,hasTotalRow:(0,w.yw)("OfficeVSO_9426161_DataframeShouldExcludeTotalRowForTLR")?t.totalRow:void 0,numRows:t.numRows,numColumns:t.numColumns,sampleRows:o,numberFormat:t.numberFormatCategories,sheetId:e,sheetAddress:r,tableType:t.tableLikeRange?x.lp.TableLikeRange:x.lp.StandardTable};return(0,S.Cc)(S.xk.GetActiveTableContext,a,!0),i}}async insertDataFrameAndGetPythonContext(e,t){const a=(new Date).getTime(),n=e.name,o=e.tableLikeRange??!1,r=!(0,w.yw)("OfficeVSO_9321092_InsertDataframeWithHeaderFalse")||e.headers!==m.r$C,i=!!(0,w.yw)("OfficeVSO_9426161_DataframeShouldExcludeTotalRowForTLR")&&e.totalRow,l=await(0,h.T7)(n,e.address,o,r,i,t,this.dispatch),{sheet:s,address:c}=(0,h.B4)(l,t),d=await this.getPythonCellContext(s,c);return(0,S.QO)(S.xk.InsertDataFrameAndGetPythonContext,a),d}getPythonAdaContext(){let e=this.pythonContextBuilder.getPythonConversationHistory().slice(-this.MAX_CONVERSATION_HISTORY);return e=structuredClone(e),e.forEach((e=>{e.pythonContext?delete e.pythonContext.sheetId:e.codeAndOutput&&delete e.codeAndOutput.sheetId})),{hasActivePythonLicense:(0,h.Gd)(),isPythonCellSelected:Y.isPythonCellSelected,conversationHistory:e,otherPythonCells:this.pythonContextBuilder.getOtherPythonCells().slice(-this.MAX_PYTHON_CELLS)}}async setPythonAdaContext(e,t,a,n){const o=(0,w.yw)("OfficeVSO_9253103_suppressPrePythonModeError"),r=(new Date).getTime();try{if(o&&(this.prePythonModeError=void 0,this.prePythonModeErrorFunction=void 0),(0,E.Jr)(this.augloopCallsPerQuery,this.codeRetryAttempts),this.codeRetryAttempts=0,this.augloopCallsPerQuery=0,!(0,w.H2)()||!(0,h.Gd)())return this.pythonContextBuilder.clearPythonContextBuilder(),!0;if(!a||!n){const e=`\n        Address: ${n?"Defined":"Undefined"},\n        Sheet Id: ${a?"Defined":"Undefined"},\n        Function: setPythonAdaContext, isPythonCellSelected: ${Y.isPythonCellSelected}`;throw(0,v.Uc)(i.O.PythonContextUndefinedParameter,e)}if((0,w.yw)("OfficeVSO_9235214_SettingPythonCellSelection")){const t=await this.isPythonCell(a,n);t!==e&&((0,E.hp)(e,t),Y.isPythonCellSelected=t,e=t)}const l={query:t,sheetId:a,address:n},s=Y.getActiveTable(),c=(0,w.yw)("OfficeVSO_9228889_getPythonCellsForPythonModeOnly"),d=!c||this.isPythonMode?await this.pythonContextBuilder.getAllPythonCellsUptoAnalysisSheet(a,n):new Map;if(e)l.pythonCellContext=await this.getPythonCellContext(a,n);else if(this.isPythonMode){const e=Y.pythonContextManager.pythonAnalysisSheetId;if(e&&e===a){const t=await this.pythonContextBuilder.getLastPythonCellOnSheet(e);l.pythonCellContext=t}else if(s)(0,w.Ff)()?l.pythonCellContext=await this.insertDataFrameAndGetPythonContext(s,d):l.pythonTableContext=await this.getActiveTableContext(a);else{(0,w.yw)("OfficeVSO_9343958_InsertSheetWithBlankCellAnalysis")&&(0,h.nC)(this.dispatch,Y);const e=await this.pythonContextBuilder.getLastPythonCellOnSheet(a);l.pythonCellContext=e}}else l.pythonTableContext=await this.getActiveTableContext(a);return c?this.isPythonMode?this.updatePythonContextFieldsForPythonMode(l,d):this.pythonTrimmedContext.updateTrimmedContext(l):this.updatePythonContextFieldsDeprecated(l,d),(0,S.Cc)(S.xk.AdaContextExtraction,r,!0),!0}catch(e){return o&&!this.isPythonMode?(this.prePythonModeErrorFunction="setPythonAdaContext",this.prePythonModeError=e,!0):((0,S.Cc)(S.xk.AdaContextExtraction,r,!1),(0,v.Kx)(this.dispatch,e,"setPythonAdaContext"),!1)}}async isPythonCell(e,t){const a=(new Date).getTime();try{const n=await this.getPythonCellRange(e,t);return await this.requestContext.sync(),await this.getPythonCellType(n),n.untrack(),await this.requestContext.sync(),(0,S.Cc)(S.xk.IsPythonCell,a,!0),!0}catch(e){return(0,S.Cc)(S.xk.IsPythonCell,a,!1),!1}}async getCodeAndOutput(e,t){if(t||(t=await this.getPythonCellType(e)),e.load("valuesAsJson"),await this.requestContext.sync(),"Error"===e.valuesAsJson[0][0].type)return await this.getErrorValue(e);switch(t){case x.px.SinglePythonObjectCell:return await this.getPythonObjectOutput(e);case x.px.SingleExcelValueCell:return await this.getExcelValueSingleCellOutput(e);case x.px.SpilledExcelValueCell:return await this.getExcelValueSpilledRangeOutput(e)}}async getUpdatedPythonTableContext(e){const t=e.tableName,a=this.requestContext.workbook.tables.getItemOrNullObject(t).load("isNullObject");if(await this.requestContext.sync(),a.isNullObject)return;const n=a.getHeaderRowRange().load("values"),o=a.getDataBodyRange().load(["rowCount","columnCount"]),r=o.getRow(0).load("numberFormatCategories");await this.requestContext.sync();const i=n?JSON.stringify(n.values[0]):"",l=await(0,F.GF)(t,this.MAX_SAMPLE_ROWS),s=r.numberFormatCategories?JSON.stringify(r.numberFormatCategories):"";return{tableName:t,headers:i,hasTotalRow:(0,w.yw)("OfficeVSO_9426161_DataframeShouldExcludeTotalRowForTLR")?a.showTotals:void 0,numRows:o.rowCount,numColumns:o.columnCount,sampleRows:l,numberFormat:s,sheetId:e.sheetId,sheetAddress:e.sheetAddress,tableType:e.tableType}}async getUpdatedPythonTableContextForTableLikeRange(e){if(!e.sheetId){throw(0,v.Uc)(i.O.PythonContextUndefinedParameter,"Undefined Parameter: sheetId, Function: getUpdatedPythonTableContextForTableLikeRange")}const t=(0,L.R1)(this.dispatch,e.sheetId,e.sheetAddress);if(t){const a=(0,L.K7)(t),{left:n,top:o,right:r,bottom:i,worksheetId:l}=a,s=t.interpretation.orientation,c=this.requestContext.workbook.worksheets.getItem(l),d=(0,L.vs)(c,a,s);d.load("values");const u=(0,L._f)(c,a);u.load("numberFormat");const m=await(0,L.m)(this.requestContext,c,a,this.MAX_SAMPLE_ROWS),g=(0,L.Sy)(d,s,t.unsupportedFeatures);return{tableName:t.name,headers:JSON.stringify(g),hasTotalRow:(0,w.yw)("OfficeVSO_9426161_DataframeShouldExcludeTotalRowForTLR")?t.hasTotalRow:void 0,numRows:i-o,numColumns:r-n+1,sampleRows:m,numberFormat:JSON.stringify(u.numberFormat[0]),sheetId:e.sheetId,sheetAddress:e.sheetAddress,tableType:e.tableType}}(0,E.PB)(E.L3.UpdateContextTLRCalledOnNonTLR,[])}async getPythonCellContext(e,t){const a=(new Date).getTime();if(!e||!t){const e=`Undefined Parameter: ${t?"sheetId":"address"}, Function: getPythonCellContext, isPythonCellSelected: ${Y.isPythonCellSelected}`;throw(0,v.Uc)(i.O.PythonContextUndefinedParameter,e)}const n=await this.getPythonCellRange(e,t);await this.requestContext.sync();const o=await this.getPythonCellType(n),r=await(0,h.AJ)((async()=>await this.getCodeAndOutput(n,o)),(e=>(0,w.yw)("OfficeVSO_9377566_DetectBusyStateWithErrorType")?!(0,v.U6)(e):e.outputType!==Excel.ErrorCellValueType.busy),(0,w.yw)("OfficeVSO_9569849_usePyExTimeout")?await this.getMaxRetryAttempts():this.MAX_RETRY_ATTEMPTS,this.RETRY_WAIT_IN_MILLISECONDS);if(n.load(["worksheet/id","address"]).untrack(),await this.requestContext.sync(),(0,w.yw)("OfficeVSO_9377566_DetectBusyStateWithErrorType")?(0,v.U6)(r):r.outputType===Excel.ErrorCellValueType.busy){const e=`Retry Wait (ms): ${this.RETRY_WAIT_IN_MILLISECONDS}, Python execution timeout (ms): ${await this.getPythonExecutionTimeoutInMilliseconds()}, Max Attempts: ${this.MAX_RETRY_ATTEMPTS}`;throw(0,v.jv)(e)}const l={sheetId:n.worksheet.id,sheetAddress:(0,h.c3)(n.address),code:r.code,output:r.output,outputType:r.outputType};return(0,S.Cc)(S.xk.GetPythonCellContext,a,!0),l}isStartAnalysisCard(){return this.lastStartAnalysisQueryGuid===A.M.userQueryGuid}exitAdvancedAnalysisMode(){this.pythonAnalysisSheetId=void 0,this.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,this.isPythonMode=!1,this.analysisSessionId=void 0,this.pythonContextBuilder.clearPythonContextBuilder(),this.pythonTrimmedContext.clearTrimmedContext(),this.isFirstCodeExecution=!0,Y.pythonContextManager.shouldGenerate=!1,(0,w.yw)("OfficeVSO_9476928_EnableDiagnosticsInPostView")&&this.unregisterOnNewEntry(),(0,w.SA)()&&(Y.pythonContextManager.lastPythonUserRequestId="")}async getPythonCellType(e){e.load(["formulas","hasSpill"]),await this.requestContext.sync();const t=e.formulas[0][0];if(h.sy.test(t))return e.hasSpill?x.px.SpilledExcelValueCell:h.OU.test(t)?x.px.SingleExcelValueCell:x.px.SinglePythonObjectCell;{const e="getPythonCellType: pythonCellType is PythonCellType.None";throw(0,v.Uc)(i.O.PythonGeneralContextError,e)}}async getExcelValueSingleCellOutput(e){const t=(new Date).getTime();e.load(["formulas","valuesAsJson"]),await this.requestContext.sync();const a=(0,h.vv)(e.formulas[0][0]),n=e.valuesAsJson[0][0];let o,r;switch(n.type){case"LocalImage":o="",r="Image";break;case Excel.CellValueType.notAvailable:o="#Unknown!",r=Excel.CellValueType.error;break;default:o=String(n.basicValue??""),r=String(n.basicType??"")}return(0,S.Cc)(S.xk.GetExcelValueSingleCellOutput,t,!0),{code:a,output:o,outputType:r}}async getExcelValueSpilledRangeOutput(e){const t=(new Date).getTime(),a=e.getSpillingToRangeOrNullObject().load(["isNullObject","rowCount","columnCount"]);if(a.track(),await this.requestContext.sync(),a.isNullObject){a.untrack(),await this.requestContext.sync();const e="getExcelValueSpilledRangeOutput: fullSpilledRange is null";throw(0,v.Uc)(i.O.PythonGeneralContextError,e)}const n=a.getRow(0).load("formulas");await this.requestContext.sync();const o=(0,h.vv)(n.formulas[0][0]),r=[],l=[],s=a.rowCount,c=a.columnCount;for(let e=0;e<this.MAX_SAMPLE_ROWS&&!(e>=s);e++){const t=[],n=a.getRow(e).load(["formulas","valuesAsJson"]);await this.requestContext.sync();const o=[];for(const e of n.valuesAsJson[0])t.push(String(e.basicValue??"")),o.push(String(e.basicType??""));r.push(o),!(t.length>0)||l.push(t)}a.untrack(),await this.requestContext.sync();const d={columnNames:[],dataTypes:r[0],sampleRows:l,numRows:s,numColumns:c};return(0,S.Cc)(S.xk.GetExcelValueSingleCellOutput,t,!0),{code:o,output:d,outputType:"TableLikeRange"}}composePythonOutputString(e){try{if(e.preview){const t=e.preview;if(t.properties?.arrayPreview?.elements){const e=t.properties.arrayPreview.elements;if(e&&!h.Xn.test(e[0][0].basicValue))return JSON.stringify(e.map((e=>e.map((e=>e.basicValue)))))}}return e.Python_str}catch{return e.Python_str}}async getPythonObjectOutput(e){const t=(new Date).getTime();let a;e.load("formulas"),await this.requestContext.sync();const n=e.valuesAsJson[0][0],o=(0,h.vv)(e.formulas[0][0]);if("DataFrame"!==n.Python_typeName)a={code:o,output:this.composePythonOutputString(n),outputType:n.Python_type};else{e.load("address");const t=await this.getPythonObjectReferenceIdWithRetry(e),n=(0,h.yK)(t),r=(await this.executePythonCodeWithRetry(n,e)).result;if((0,w.yw)("OfficeVSO_9575104_AddEmptyPayloadHandling")&&!r)throw(0,v.BH)("Python payload is undefined in getPythonObjectOutput");const i=r.value,l=r.value_type,s=i.sampleRows;for(let e=0;e<s.length;e++)s[e]=(0,h.LC)(s[e]);a={code:o,output:{columnNames:i.columnNames,dataTypes:i.dataTypes,sampleRows:s,numRows:i.numRows,numColumns:i.numColumns},outputType:l}}return(0,S.Cc)(S.xk.GetPythonObjectOutput,t,!0,`Python Object Output Type: ${a.outputType}`),a}async executePythonCodeWithTimeout(e,t){const a=(0,w.Z8)("Microsoft.Office.Excel.FA000000124.ExecutePythonCodeTimeoutInMS",5e3),n=(new Date).getTime();let o,r=!1;const i=new Promise(((e,t)=>{o=window.setTimeout((()=>{e()}),a)})),l=OfficeFirstParty.externalCodeService.executePythonCode(e).finally((()=>{o&&window.clearTimeout(o),r=!0}));if(await Promise.race([i,l]),(0,S.l5)(S.xk.ExecutePythonCodeApiCall,n,t),r){const e=await l;return JSON.parse(e)}return{error_name:"executeTimedOut",error_message:`executePythonCode timed out after ${(0,c.xJ)(n)} ms`}}async executePythonCode(e){const t=await OfficeFirstParty.externalCodeService.executePythonCode(e);return JSON.parse(t)}async executePythonCodeWithObjectReferenceRetry(e,t,a){if(!(0,w.yw)("OfficeVSO_9279917_ShouldUpdatePythonObjectReference"))return await this.executePythonCodeWithTimeout(e,a++);{const n=await this.getPythonObjectReferenceId(t);if(n)return e=(0,h.yK)(n),await this.executePythonCodeWithTimeout(e,a++)}}async executePythonCodeWithRetry(e,t){let a,n=0;const o=(0,w.yw)("OfficeVSO_9249899_RunPythonWithTimeout");if(a=o?await this.executePythonCodeWithTimeout(e,n++):await this.executePythonCode(e),(0,w.yw)("OfficeVSO_9279917_ShouldUpdatePythonObjectReference")){if((0,w.yw)("OfficeVSO_9575104_AddEmptyPayloadHandling")){if(void 0===a?.error_name&&a.result&&a.result.value)return a}else if(void 0===a?.error_name&&a.result&&null!==a.result.value)return a}else if(void 0===a.error_name)return a;let r;if(r=(0,w.yw)("OfficeVSO_9279917_ShouldUpdatePythonObjectReference")?void 0!==a.error_name?`executePythonCode API Call Failed - ErrorName: ${a.error_name}, ErrorMessage: ${a.error_message}`:`executePythonCode API Call Failed - Value_Type: ${a.result.value_type}, Value: ${a.result.value}`:`executePythonCode API Call Failed - ErrorName: ${a.error_name}, ErrorMessage: ${a.error_message}`,(0,E.nQ)(r),(0,w.yw)("OfficeVSO_9575127_useApplicationCalculate")?await Excel.run((async()=>{this.requestContext.application.calculate(Excel.CalculationType.full)})):t.calculate(),await this.requestContext.sync(),a=o?await(0,h.AJ)((async()=>await this.executePythonCodeWithObjectReferenceRetry(e,t,n)),(e=>(0,w.yw)("OfficeVSO_9279917_ShouldUpdatePythonObjectReference")?void 0===e?.error_name&&e.result&&((0,w.yw)("OfficeVSO_9575104_AddEmptyPayloadHandling")?e.result.value:null!==e.result.value):void 0===e.error_name),(0,w.yw)("OfficeVSO_9377618_UsePyExTimeoutForPollingRecalc")?(0,w.yw)("OfficeVSO_9569849_usePyExTimeout")?await this.getMaxRetryAttempts():Math.ceil(await this.getPythonExecutionTimeoutInMilliseconds()/this.RETRY_WAIT_IN_MILLISECONDS):this.MAX_RETRY_ATTEMPTS,this.RETRY_WAIT_IN_MILLISECONDS):await(0,h.AJ)((async()=>await this.executePythonCodeWithObjectReferenceRetry(e,t,n)),(e=>(0,w.yw)("OfficeVSO_9279917_ShouldUpdatePythonObjectReference")?void 0===e?.error_name&&e.result&&((0,w.yw)("OfficeVSO_9575104_AddEmptyPayloadHandling")?e.result.value:null!==e.result.value):void 0===e.error_name),(0,w.yw)("OfficeVSO_9569849_usePyExTimeout")?await this.getMaxRetryAttempts():this.MAX_RETRY_ATTEMPTS,this.RETRY_WAIT_IN_MILLISECONDS),(0,w.yw)("OfficeVSO_9279917_ShouldUpdatePythonObjectReference")){if(void 0===a?.error_name&&a.result&&((0,w.yw)("OfficeVSO_9575104_AddEmptyPayloadHandling")?a.result.value:null!==a.result.value))return a;const e=`executePythonCodeWithRetry:\nHResult: ${a.hresult}\nError Name: ${a.error_name}\nError Message: ${a.error_message}`;if(""===a.error_name&&""===a.error_message)throw(0,v.w5)(e);if(a.result.value_type===x.qf.None){const e=`executePythonCodeWithRetry:\nValue_Type: ${a.result.value_type}\nValue ${a.result.value}}`;throw(0,v.Pi)(e)}throw(0,v.Uc)(i.O.PythonGeneralContextError,e)}{if(void 0===a.error_name)return a;const e=`executePythonCodeWithRetry:\nHResult: ${a.hresult}\nError Name: ${a.error_name}\nError Message: ${a.error_message}`;throw""===a.error_name&&""===a.error_message?(0,v.w5)(e):(0,v.Uc)(i.O.PythonGeneralContextError,e)}}async getPythonObjectReferenceId(e){const t=e.getPythonObjectReferenceIds();await this.requestContext.sync();return t.value[0][0]}async getPythonObjectReferenceIdWithRetry(e){const t=(new Date).getTime();let a=await this.getPythonObjectReferenceId(e);if(a)return a;if((0,w.yw)("OfficeVSO_9575127_useApplicationCalculate")?await Excel.run((async()=>{this.requestContext.application.calculate(Excel.CalculationType.full)})):e.calculate(),await this.requestContext.sync(),a=await(0,h.AJ)((async()=>await this.getPythonObjectReferenceId(e)),(e=>!!e),(0,w.yw)("OfficeVSO_9569849_usePyExTimeout")?await this.getMaxRetryAttempts():this.MAX_RETRY_ATTEMPTS,this.RETRY_WAIT_IN_MILLISECONDS),a)return(0,S.l5)(S.xk.GetPythonObjectReferenceIdWithRetry,t),a;throw(0,v.Uc)(i.O.PythonGeneralContextError,"getPythonObjectReferenceIdWithRetry: id is undefined.")}async getErrorValue(e){e.load(["formulas","valuesAsJson"]),await this.requestContext.sync();const t=(0,h.vv)(e.formulas[0][0]),{errorName:a,errorType:n,errorSubType:o,errorMessage:r}=(0,h.$e)(e);let i;i=o||(a&&r?`${a}: ${r}`:"");return{code:t,output:{errorType:n,errorDetail:i},outputType:"Error"}}async getPythonCellRange(e,t){const a=(new Date).getTime(),n=this.requestContext.workbook.worksheets.getItem(e).getRange(t).getCell(0,0).load("hasSpill").track();let o;if(await this.requestContext.sync(),n.hasSpill){if(o=n.getSpillParentOrNullObject().load("isNullObject"),o.track(),n.untrack(),await this.requestContext.sync(),o.isNullObject){o.untrack();const e="getPythonCellRange: pythonCellRange is unexpectedly null for spilled Python cell.";throw(0,v.Uc)(i.O.PythonGeneralContextError,e)}return(0,S.Cc)(S.xk.GetPythonCellRange,a,!0),o}return n}async updatePythonContextFieldsForPythonMode(e,t){const{query:a,pythonCellContext:n,pythonTableContext:o}=e,r=n&&o;if(r){const e=`updatePythonContextFields: isBothDefined: ${r}.`;throw(0,v.Uc)(i.O.PythonInvalidSelectedContext,e)}n?this.pythonContextBuilder.setSelectedPythonCellContext(n):o&&this.pythonContextBuilder.setSelectedPythonTableContext(o),this.pythonContextBuilder.setQuery(a),await this.pythonContextBuilder.updateConversationHistory(t)}async updatePythonContextFieldsDeprecated(e,t){const{query:a,pythonCellContext:n,pythonTableContext:o}=e;if(this.isPythonMode){const e=n&&o;if(e){const t=`updatePythonContextFields: isBothDefined: ${e}.`;throw(0,v.Uc)(i.O.PythonInvalidSelectedContext,t)}n?this.pythonContextBuilder.setSelectedPythonCellContext(n):o&&this.pythonContextBuilder.setSelectedPythonTableContext(o),this.pythonContextBuilder.setQuery(a),await this.pythonContextBuilder.updateConversationHistory(t)}else this.pythonTrimmedContext.updateTrimmedContext(e)}getLastPythonCell(e){const t=this.pythonContextBuilder.getPythonConversationHistory();for(let a=t.length-1;a>=0;a--){const n=t[a];if(e&&n.query)return null;if(n.codeAndOutput&&(!(0,w.yw)("OfficeVSO_9409703_PythonCellOverlapFix")||!n.codeAndOutput.wasDeleted))return n.codeAndOutput}return null}constructor(e){this.RETRY_WAIT_IN_MILLISECONDS=1e3,this.MAX_RETRY_ATTEMPTS=10,this.MAX_CODE_RETRY_ATTEMPTS=(0,w.Z8)("Microsoft.Office.Excel.FA000000124.PythonAdaMaxCodeRetryAttempts",2),this.MAX_AUGLOOP_CALLS_PER_QUERY=(0,w.Z8)("Microsoft.Office.Excel.FA000000124.PythonAdaMaxAugLoopCallsPerQuery",10),this.isPythonMode=!1,this.isFirstCodeExecution=!0,this.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,this.codeRetryAttempts=0,this.disableAutoScroll=!1,this.augloopCallsPerQuery=0,this.ocvErrorDetails={},this.diagnosticsEntriesMap=new Map,this.lastPythonUserRequestId="",this.shouldGenerate=!0,this.getPythonExecutionTimeoutInMilliseconds=async()=>this.pythonExecutionTimeout?this.pythonExecutionTimeout:await Excel.run((async e=>{e.workbook.load(["externalCodeServiceTimeout"]),await e.sync();const t=1e3*(e.workbook.externalCodeServiceTimeout??30);return this.pythonExecutionTimeout=t+5e3,this.pythonExecutionTimeout})),this.MAX_SAMPLE_ROWS=(0,w.Z8)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxSampleRows",5),this.MAX_CONVERSATION_HISTORY=(0,w.Z8)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxConversationHistory",50),this.MAX_PYTHON_CELLS=(0,w.Z8)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxPythonCells",50),this.pythonContextBuilder=R.getInstance(),this.pythonTrimmedContext=I.getInstance(),this.requestContext=e;const t=function(e){try{const t=localStorage.getItem(e);return null===t?{value:void 0,errorType:"KeyNotFound"}:{value:t,errorType:void 0}}catch(t){return{value:void 0,errorType:T(t,"Read",e)}}}(b.PythonAaTuiShown);t.errorType?this._alreadyShownTui=!1:this._alreadyShownTui="true"===t.value}}N._instance=void 0,N.getInstance=e=>(void 0===N._instance&&(N._instance=new N(e)),N._instance);var k=a(82623),O=a(96854),P=a(31030),M=a(78640),D=a(55683),$=a(28745),B=a(6925),H=a(80519),U=a(88099),q=a(95674),V=a(45972),G=a(10796),W=a(33292),z=a(40910),Q=a(81800),J=a.n(Q);function j(e){return!e.tableLikeRange}const Y=new class{lockContextRefresh(e){const t=this.mutex.tryAcquire(e);void 0!==t?this.mutexToken=t:this.mutex.logMutexTokenError("Context already locked.","ContextManager",e)}async releaseContextLock(){try{this.mutexToken?.release(),this.mutexToken=void 0,await this.updateSelection()}catch(e){}}async runWithNoContextRefresh(e){const t=void 0!==this.mutexToken;(0,r.cY)("ContextManager.runWithNoContextRefresh",{currentlyLocked:t}),t||this.lockContextRefresh();try{return await e()}finally{t||this.releaseContextLock()}}async runWithContextRefreshAndLoader(e,t=c.OP.ActionAI){this.dispatch(B.mF.startExecutingCommand({command:t}));const a=void 0!==this.mutexToken;a||this.lockContextRefresh(t);try{return await e()}finally{a||await this.dispatch(B.mF.stopExecutingAndReleaseContextLock())}}clearMergedCellsFromActiveTable(){const e=this.activeWorksheetId,t=this.getActiveTable();if(e&&t?.tableLikeRangeFeatures){const a={hasMergedCells:!1,unsupportedFeatures:t.tableLikeRangeFeatures&~k.ye.HasMergedCells};this.dispatch(M.mF.updateTabularRangeInterpretation(e,t.name,a))}}clearCachedTableInterpretationsForUndo(){this.dispatch(M.mF.clearCachedTableInterpretationsForUndo())}isContextLocked(){return!!this.mutexToken}getActiveWorksheetName(){return this.activeWorksheetName}getActiveWorksheetId(){return this.activeWorksheetId}getPythonActiveTableSheetId(){return this.activePythonTableSheetId}getActiveTable(e=0){return this.activeTables.length?this.activeTables[e]:void 0}getRangeAddressesFromAddress(e){return e.includes("!")?l.ExcelCalc.localAddressesFromSheetAddresses(e).split(","):e.split(",")}getActiveRangeAddresses(){if(!this.activeRangeAddress)return[];return this.getRangeAddressesFromAddress(this.activeRangeAddress).map((e=>`${this.activeWorksheetName}!${e}`))}getNumberFormat(e){return(0,w.yw)("OfficeVSO_9470063_LocalizeNumberFormat")&&void 0!==e.numberFormatLocal?e.numberFormatLocal:e.numberFormat}getHumanInTheLoopRange(){return this.humanInTheLoopRange}setHumanInTheLoopRange(e){this.humanInTheLoopRange=e}setPythonAdaStaticPromptOverride(e){this.pythonAdaStaticPromptOverride=e}async getContextString(){(0,w.yw)("OfficeVSO_8434690_ContextManagerIntegrityCheck")&&(0,w.tg)()&&await this.doSelectionIntegrityCheck();const e=this.getActiveTable(),t={activeTables:(0,w.yw)("OfficeVSO_9217416_PythonAARemoveSettingActiveTableUndefined")?this.activeTables:this.isPythonCellSelected&&!(0,w.qm)()?[]:this.activeTables};this.activeUxRail&&(0,w.xy)("CopilotUxRailsOverride")&&(t.activeUxRail={type:this.activeUxRail});const a=(0,w.ge)();if(a&&(0,w.wy)()&&(t.activeUxRail={type:"Office Js"}),(0,w.H2)()){const e=this.pythonContextManager.getPythonAdaContext();t.pythonAdaContext=e,(0,h.mx)(e),(0,w.w9)()&&this.pythonAdaStaticPromptOverride&&(t.pythonAdaContext.staticPromptOverride=this.pythonAdaStaticPromptOverride)}if((0,w.vo)()){const e=this.pythonCalculatedColumnContextManager?.getPythonCalculatedColumnContext();t.pythonCalculatedColumnContext=e}a&&(t.officeJsExtraContext=!0,t.activeChart=this.activeChart,t.activeRange=this.activeRange,t.activePivotTable=this.activePivotTable),(0,w.av)()&&(t.officeScriptsContext=g.y.getInstance().getOfficeScriptsContext());const n=(0,w.yw)("OfficeVSO_9369541_CFFormulaSupport");if((0,w.tg)()?(t.activeCell=this.activeCell,t.activeChart=this.activeChart,t.activeRangeAreas=this.activeRangeAreas,t.activePivotTable=this.activePivotTable):n&&(t.activeCell=this.activeCell),n){if((0,w.Lr)()){const e=this.dispatch(D.mF.getLocaleInfo());e.isLoaded&&(t.localeInfo=(0,H.Ft)(e.calcLocaleInfo),t.dataLocale=e.dataLocale)}else if(e){const a=this.dispatch(M.mF.getChartCache(e.name));a&&(t.localeInfo=(0,H.Ft)(a.localeCacheDeprecated.calcLocaleInfo),t.dataLocale=a.localeCacheDeprecated.dataLocale)}t.isActiveTableCtrlT=!e?.tableLikeRange}if((0,w.qK)()&&"PAYLOAD_TOO_LARGE"===this.selectionError&&(t.unsupportedContext=(t.unsupportedContext??0)|k.b_.PayloadTooLarge),(0,w.ZA)()&&this.activeWorksheetId&&this.activeWorksheetName&&(t.activeWorksheet={id:this.activeWorksheetId,name:this.activeWorksheetName}),(0,w.eF)()){const e=this.dispatch(B.mF.getDataShapingState());e.started?t.dataShapingContext={sessionId:e.sessionId,queryScript:e.queryScript,tableName:e.tableName}:t.dataShapingContext={sessionId:void 0}}return JSON.stringify(t,((e,t)=>{if("sheetRange"!==e&&"totalRow"!==e&&"tableLikeRange"!==e&&"tableContained"!==e&&(a||n||"address"!==e)&&((0,w.tg)()||"tableLikeRangeFeatures"!==e&&"tableIntersected"!==e))return t}))}isTableHeaderShown(e=0){return this.activeTables.length>0&&!!this.activeTables[e].headers}async ensureSheetName(e,t){if(e)return e;if(t===this.activeWorksheetId&&this.activeWorksheetName)return this.activeWorksheetName;const a=this.requestContext.workbook.worksheets.getItem(t);return a.load("name"),await this.requestContext.sync(),a.name}async initPublic(e){return this.dispatch=e,this.initMemo.promise()}async init(){const e=performance.now();try{await this.pythonContextManager.init(this.dispatch);const e=(0,w.eF)();O.E.getInstance().setInitContextTime(),await this.updateSelection(),(0,w.av)()&&(await g.y.getInstance().initOfficeScriptsContext(),(0,w.L)()&&await g.y.getInstance().checkIfFlowCreatedFromPowerAutomate()),e&&await(0,W.uR)(),await Excel.run({delayForCellEdit:!0,previousObjects:this.requestContext},(async t=>{try{const e=t.workbook.worksheets.getActiveWorksheet().load(["protection/protected","protection/isPaused"]);await t.sync(),e.protection.protected&&!e.protection.isPaused&&this.dispatch(M.mF.setIsWorksheetProtected(!0))}catch(e){if(!(e instanceof OfficeExtension.Error&&"InvalidSelection"===e.code))throw e;this.setSelectionError("INVALID_SELECTION"),this.dispatch(M.mF.setIsWorksheet(!1))}(0,w.yw)("OfficeVSO_8466885_DisableSdxOnAutoSaveOff")&&t.workbook.load(["autoSave"]),t.workbook.worksheets.onSelectionChanged.add((async e=>{this.mutexToken?((0,r.cY)("ContextManager.onSelectionChanged skipped"),this.mutexToken.logSelectionChangeEvent()):((0,r.cY)("ContextManager.onSelectionChanged called",e),await this.updateSelection(e.worksheetId,e.address))})),(0,w.yw)("OfficeVSO_8450684_DisableSdxOnChartSheet")&&t.workbook.worksheets.onDeactivated.add((async()=>{await this.onWorksheetDeactivated()})),(0,w.yw)("OfficeVSO_8466885_DisableSdxOnAutoSaveOff")&&t.workbook.onAutoSaveSettingChanged.add((async()=>{await this.updateSelection()})),t.workbook.worksheets.onChanged.add((0,r.BC)((0,w.yw)("OfficeVSO_9476616_gatedAsyncDebounce"),(async e=>{if(this.mutexToken)(0,r.cY)("ContextManager.worksheets.onChanged skipped");else if(this.getActiveTable()?.tableLikeRange){if((0,w.yw)("OfficeVSO_9476651_alwaysCheckIntersection")||"Local"!==e.source){if(!await this.doesRemoteChangeIntersectTable(e))return}await this.refreshActiveTable(!1)}}),250)),(0,w.yw)("OfficeVSO_9451523_renameWorksheetAssortedIssues")&&t.workbook.worksheets.onNameChanged.add((async e=>{this.mutexToken||(await this.dispatch(M.mF.clearTablesOnSheet(e.worksheetId)),await this.updateSelection(e.worksheetId))})),t.workbook.worksheets.onFormatChanged.add((async e=>{if(!this.mutexToken&&e.worksheetId===this.activeWorksheetId){if(this.getActiveTable()?.name){const t=await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address);void 0!==t&&t===this.getActiveTable()?.name&&this.clearTableAndInvalidateNL(t)}if("Local"===e.source)await this.updateSelection(e.worksheetId);else if(this.getActiveTable())if((0,w.ge)())await this.updateSelection(e.worksheetId,e.address);else{await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address)===this.getActiveTable()?.name&&await this.updateSelection(e.worksheetId,e.address)}}})),t.workbook.worksheets.onRowSorted.add((0,r.g5)((async e=>{if(this.mutexToken)return;const t=await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address);void 0!==t&&t===this.getActiveTable()?.name&&this.clearTableAndInvalidateNL(t),await this.refreshActiveTable(!0,t)}),0)),t.workbook.tables.onAdded.add((0,r.g5)((async t=>{"Local"===t.source&&(this.fetchAndSetActiveTable(t.tableId),(0,w.av)()&&g.y.getInstance().addTable(t.tableId)),e&&await(0,W.Vq)(t.tableId)}),0)),t.workbook.tables.onChanged.add((0,r.g5)((async e=>{if(this.mutexToken)return void(0,r.cY)("ContextManager.tables.onChanged refreshActiveTable skipped");const t=(await this.getTableNamesUndefinedForDeletedTables([e.tableId]))[0];if(!t||t!==this.getActiveTable()?.name)return;const a=e.changeType!==Excel.DataChangeType.rangeEdited||void 0===e.details||e.details.valueBefore!==e.details.valueAfter;await this.fetchAndSetActiveTable(e.tableId),a&&await this.refreshActiveTable(!1)}),0)),t.workbook.tables.onChanged.add((async e=>{this.mutexToken?(0,r.cY)("ContextManager.tables.onChanged clearTable skipped"):await this.clearTableAndInvalidateNLResultFromId(e.tableId)})),t.workbook.tables.onFiltered.add((0,r.g5)((async e=>{const t=this.requestContext.workbook.tables.getItem(e.tableId);t.load("name"),await this.requestContext.sync(),await this.refreshActiveTable(!0,t.name)}),0)),t.workbook.worksheets.onActivated.add((async e=>{if(this.mutexToken)(0,r.cY)("ContextManager.worksheets.onActivated skipped");else if(await this.updateSelection(e.worksheetId),(0,w.yw)("OfficeVSO_8705628_updateActiveSelectionOnSheetChange")&&await this.refreshActiveTable(!1),!(0,w.yw)("OfficeVSO_8580762_CheckActiveWorksheetOnUpdateSelection")){const t=this.requestContext.workbook.worksheets.getItem(e.worksheetId).load(["protection/protected","protection/isPaused"]);await this.requestContext.sync(),this.dispatch(M.mF.setIsWorksheetProtected(t.protection.protected&&!t.protection.isPaused)),(0,w.yw)("OfficeVSO_8450684_DisableSdxOnChartSheet")&&this.dispatch(M.mF.setIsWorksheet(!0))}})),t.workbook.tables.onDeleted.add((async t=>{this.activeTables=this.activeTables.filter((e=>e.name!==t.tableName)),this.dispatch(M.mF.handleTableDeleted(t.tableName)),(0,w.av)()&&g.y.getInstance().removeTable(t.tableName),e&&(0,W.q9)(t.tableName)})),t.workbook.worksheets.onProtectionChanged.add((async e=>{if(e.worksheetId===this.activeWorksheetId)if(e.isProtected){const t=this.requestContext.workbook.worksheets.getItem(e.worksheetId).load(["protection/protected","protection/isPaused"]);await this.requestContext.sync(),this.dispatch(M.mF.setIsWorksheetProtected(t.protection.protected&&!t.protection.isPaused))}else this.dispatch(M.mF.setIsWorksheetProtected(e.isProtected))})),t.workbook.worksheets.onDeleted.add((async e=>{this.mutexToken||"Local"===e.source||(0,w.yw)("OfficeVSO_9243994_handleRemoteDelete")&&e.worksheetId===this.activeWorksheetId&&await this.updateSelection()})),await t.sync(),(0,w.yw)("OfficeVSO_8466885_DisableSdxOnAutoSaveOff")&&(t.workbook.autoSave||this.dispatch(M.mF.setIsWorkbookAutoSaved(t.workbook.autoSave)))})),O.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.ContextManagerInitialized},A.M.getInstance())}catch(e){throw A.M.getInstance().logErrorCode(i.O.ContextManagerInitializationFailed,e),e}finally{(0,z.NQ)("ContextManagerInitialization",performance.now()-e)}}setActivePythonTableProps(e){this.activePythonTableSheetId=e}setActiveTable(e,t=!1,a){e?(t?this.activeTables.push(e):this.activeTables=[e],(0,s.s_)(s.H0.RemoveGoBackToTable)):this.activeTables=[],this.setActivePythonTableProps(a),this.dispatch(M.mF.updateActiveTable(e))}async onWorksheetDeactivated(){await Excel.run((async e=>{try{e.workbook.worksheets.getActiveWorksheet(),await e.sync()}catch(e){(0,r.cY)("!==== "+e),this.setSelectionError("INVALID_SELECTION"),this.dispatch(M.mF.setIsWorksheet(!1))}return Promise.resolve()}))}setSelectionError(e){(0,w.ZA)()&&"INVALID_SELECTION"!==e||("PAYLOAD_TOO_LARGE"===e&&e!==this.selectionError&&A.M.getInstance().logStandardizedAshaErrorEvent(o.W.User_Input_Could_Not_Be_Processed,n.c.Input_Failed_Due_To_Memory,c.BJ.AnalyzeData),this.selectionError=e,this.dispatch(M.mF.setSelectionError(e)))}clearSelectionError(){this.selectionError=void 0,this.dispatch(M.mF.setSelectionError(void 0))}async handleBlankContextForPythonAa(e,t,a){try{let t;(0,w.yw)("OfficeVSO_9477550_selectionImprovements")?t=e:e&&!(0,w.ZA)()||await this.getSelectedRangeAddress(),t&&(this.isPythonCellSelected=!1,this.selectedPythonSheetId=a,this.selectedPythonAddress=t)}catch(e){return void(0,r.cY)(r.SA.Warning,e)}}loadSelectionDetails(){if((0,w.yw)("OfficeVSO_9477550_selectionImprovements")){const e=this.requestContext.workbook.getSelectedRanges(),t=this.requestContext.workbook.getActiveCell(),a=e.areas,n=(0,w.ZA)()?e.getTables():void 0;return a.load("items/address"),e.load("address"),t.load("address"),n?.load("items/name"),{selectedRanges:e,selectedCell:t,selectedAreas:a,selectedTables:n}}return{}}getSelectedAddress(e,t){const{selectedRanges:a,selectedCell:n,selectedAreas:o,selectedTables:r}=e;if((0,w.yw)("OfficeVSO_9477550_selectionImprovements")&&n&&a&&o){this.activeCell=n.address?(0,q.r)(n.address):void 0,(0,w.ZA)()&&(this.activeRangeAreas=a.address,this.selectedTableNames=r?.items.map((e=>e.name)));const e=o.items.map((e=>e.address)),t=e.length;return t>0?e[t-1]:void 0}return t}async updateSelection(e,t){if(this.isUpdatingSelection)this.pendingSelection=[e,t];else{this.isUpdatingSelection=!0;try{const a=this.requestContext.workbook,n=e&&!(0,w.yw)("OfficeVSO_9477550_selectionImprovements")?a.worksheets.getItem(e):a.worksheets.getActiveWorksheet(),o=this.loadSelectionDetails();(0,w.yw)("OfficeVSO_9456818_DearrayzingPropertyLoadInUpdateSelection")?(n.load("name,id,protection/protected,protection/isPaused"),a.load("autoSave")):(n.load(["name","id","protection/protected","protection/isPaused"]),a.load(["autoSave"]));const r=n.getUsedRangeOrNullObject();await this.requestContext.sync();const l=a.autoSave;if(this.dispatch(M.mF.setIsWorkbookAutoSaved(l)),!l)return;const s=n.name,d=n.id;this.activeWorksheetName=s,this.activeWorksheetId=d;const u=r.isNullObject,m=this.getSelectedAddress(o,t),g=n.protection.protected&&!n.protection.isPaused;if(this.dispatch(M.mF.setIsWorksheetProtected(g)),this.dispatch(M.mF.setIsWorksheet(!0)),await this.registerChartActivationHandlers(n,d),(0,w.ge)()||(0,w.ZA)())await this.updateActiveRange(m,d);else if(u)return"BLANK_WORKSHEET"!==this.selectionError&&A.M.getInstance().logEvent((0,c.SV)(c.he.SuggestionShown,c.q.SampleData)),this.setActiveTable(void 0),this.setSelectionError("BLANK_WORKSHEET"),void this.handleBlankContextForPythonAa(m,s,d);try{if((0,w.yw)("OfficeVSO_9477550_selectionImprovements"))return void await this.setContextWithAddressValidation(d,s,m);let e,a=d,n=s;t&&!(0,w.ZA)()?e=`'${s}'!${t}`:(e=await this.getSelectedRangeAddress(),(0,w.yw)("OfficeVSO_9276866_updateSheetWithSelectedRanges")&&(a=this.activeWorksheetId,n=this.activeWorksheetName)),await this.setContextWithAddressValidation(a,n,e)}catch(e){this.setActiveTable(void 0),e instanceof OfficeExtension.Error&&"InvalidSelection"===e.code?this.setSelectionError("INVALID_SELECTION"):(this.setSelectionError("UNKNOWN_ERROR"),A.M.getInstance().logErrorCode(i.O.SetContextWithAddressValidationFailed,e))}}catch(a){if((0,w.yw)("OfficeVSO_9477550_selectionImprovements")&&a instanceof OfficeExtension.Error&&"InvalidSelection"===a.code)return this.setSelectionError("INVALID_SELECTION"),void this.setActiveTable(void 0);let n=i.O.UpdateSelectionFailed;(0,w.yw)("OfficeVSO_9457405_RetryUpdateSelectionForPropertyNotLoaded")&&a instanceof OfficeExtension.Error&&"PropertyNotLoaded"===a.code&&!this.pendingSelection&&(this.pendingSelection=[e,t],n=i.O.UpdateSelectionFailedWillRetry),A.M.getInstance().logErrorCode(n,a)}finally{const e=this.pendingSelection;this.isUpdatingSelection=!1,e&&(this.pendingSelection=void 0,await this.updateSelection(...e))}}}async registerChartActivationHandlers(e,t){if(this.worksheetsWithChartsOnActivated.includes(t))return;const a=(0,w.ge)()||(0,w.tg)(),n=async()=>{this.activeChart=void 0};a&&e.charts.onDeactivated.add(n),e.charts.onActivated.add((async e=>{a?await this.setActiveChart(e):this.setChartSelectedError()})),(0,w.yw)("OfficeVSO_9483432_syncOnRegisterChartEvent")&&await this.requestContext.sync(),this.worksheetsWithChartsOnActivated.push(t)}setChartSelectedError(){this.setActiveTable(void 0),this.setSelectionError("CHART_SELECTED")}async setActiveChart(e){try{const t="series/items/name,chartType,title/text,isNullObject";let a;if(a=(0,w.yw)("OfficeVSO_9268305_getChartById")?this.requestContext.workbook.worksheets.getItemOrNullObject(e.worksheetId).charts.getItemOrNullObject(e.chartId):this.requestContext.workbook.getActiveChartOrNullObject(),a.load(t),await this.requestContext.sync(),a.isNullObject)throw new Error("Chart is null object");this.activeChart={title:a.title.text,series:a.series.items.map((e=>e.name)),chartType:"string"==typeof a.chartType?a.chartType:Excel.ChartType[a.chartType]},this.activeRange=void 0,this.setChartSelectedError()}catch(e){A.M.getInstance().logErrorCode(i.O.SetActiveChartFailed,e)}}async getSelectedRangeAddress(){const e=await this.getSelectedRanges();return e.length>0?e[0]:void 0}async getColorsUsedInTableForFormatting(e,t,a){let n;if(t){let o;o=(0,w.yw)("OfficeVSO_9489361_ExcelRun")?await(0,G.q)(e,t,"cell",a):await Promise.all(t.map((async t=>await(0,G.B)(e,t,"cell")))),n=[...new Set(o.flat())]}return n}async fetchAndSetActiveTableLikeEntity(e){const t=this.dispatch(M.mF.getTabularRangeInterpretationFromName(e));try{t?await this.fetchAndSetTabularRangeAsActiveTable(t):await this.fetchAndSetActiveTable(e)}catch(e){A.M.getInstance().logErrorCode(i.O.FetchAndSetActiveTableLikeEntityFailed,e)}}isPayloadTooLargeError(e){return e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||"RequestPayloadSizeLimitExceeded"===e.code)}async fetchAndSetActiveTable(e,t=!1,a){const n=performance.now();try{const n=async n=>{let o,r,s=!1;const c=n.workbook.tables.getItemOrNullObject(e);c.load("name"),n.workbook.load(["autoSave"]);const d=c.getRange().load("cellCount, columnCount, columnIndex, address");try{if(o=c.getHeaderRowRange().load("values,numberFormat,numberFormatCategories"),await n.sync(),(0,w.yw)("OfficeVSO_9197647_checkTableId")&&c.isNullObject)return void A.M.getInstance().logErrorCode(i.O.FetchAndSetActiveTableFailed,new Error("Table is NullObject"))}catch(e){if(A.M.getInstance().logErrorCode(i.O.FetchAndSetActiveTableFailed,e),e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound&&"Table.getHeaderRowRange"===e.debugInfo.errorLocation)s=!0;else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound&&"TableCollection.getItem"===e.debugInfo.errorLocation)return;o=void 0,(0,w.tg)()&&(r=k.ye.EmptyHeaders)}try{if((0,w.yw)("OfficeVSO_8466885_DisableSdxOnAutoSaveOff")&&!n.workbook.autoSave)return;if("PAYLOAD_TOO_LARGE"===this.selectionError&&this.getActiveTable()?.name===c.name)return;(0,w.tg)()||this.clearSelectionError(),c.load("showTotals"),s&&c.load("showHeaders");const e=["rowCount","columnCount"],i=["values","numberFormat","numberFormatCategories"];let u="values";(0,w.yw)("OfficeVSO_8534150_PassVisibleRowData")&&(e.push("text"),i.push("text"),u="text"),(0,w.yw)("OfficeVSO_9470063_LocalizeNumberFormat")&&i.push("numberFormatLocal");const m=c.getDataBodyRange().load(e),g=m.getRow(0).load(i),h=m.getLastRow().load(u),p=[];for(let e=0;e<d.columnCount;e++)p.push(c.worksheet.getCell(0,d.columnIndex+e).getEntireColumn().load("hidden"));let b,f,C,y,v,T,S;try{await n.sync(),b=m.rowCount,f=m.columnCount,(0,w.yw)("OfficeVSO_8534150_PassVisibleRowData")?(C=g.text,T=h.text):(C=g.values,T=h.values),y=this.getNumberFormat(g),v=g.numberFormatCategories,S=p.map((e=>e.hidden))}catch(e){if(!(this.isPayloadTooLargeError(e)||e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.generalException))throw e;{c.load("name, showTotals"),s&&c.load("showHeaders");const e=c.getDataBodyRange().load(["rowCount","columnCount"]),t=e.getRow(0).load(i),a=e.getLastRow().load("values"),o=[];for(let e=0;e<d.columnCount;e++)o.push(c.worksheet.getCell(0,d.columnIndex+e).getEntireColumn().load("hidden"));await n.sync(),b=e.rowCount,f=e.columnCount,C=t.values,y=this.getNumberFormat(t),v=t.numberFormatCategories,T=a.values,S=o.map((e=>e.hidden))}}const E=e=>this.buildArrayString(e?e[0]:[]),R=E(o?.values),I=E(C),A=E(T),L=E(y),F=E(v),_=[];for(const[e,t]of S.entries())t||_.push(e);let N=!1;if(c.showTotals){const e=c.getTotalRowRange();e.load("hidden"),await n.sync(),N=!e.hidden}const k=l.ExcelCalc.sheetAddressToExcelSheetRange(d.address);let O;(0,w.iP)("Microsoft.Office.Excel.FA000000124.OfficeVSO_8415279_PassColorsUsedInTableForFormatting",!1)&&(O=await this.getColorsUsedInTableForFormatting(c.name,_,n));const P={name:c.name,address:d.address,headers:R,numRows:b,numColumns:f,firstRowValues:I,lastRowValues:A,numberFormats:L,numberFormatCategories:F,visibleColumns:_,sheetRange:k,totalRow:N,ColorAlreadyUsedForConditionalFormatting:O,tableContained:a?.isContained,tableIntersected:a?0===a.distance:void 0,tableLikeRangeFeatures:r};if(this.setActiveTable(P,t),this.dispatch(M.mF.updateTableLikeEntity({type:x.lp.StandardTable,table:P})),s&&!1===c.showHeaders)return void this.setSelectionError("TABLE_HIDDEN_HEADERS")}catch(e){return A.M.getInstance().logErrorCode(i.O.FetchAndSetActiveTableFailed,e),this.setActiveTable(void 0),void((0,w.qK)()&&this.isPayloadTooLargeError(e)?this.pendingSelectionError="PAYLOAD_TOO_LARGE":this.setSelectionError("UNKNOWN_ERROR"))}};return(0,w.yw)("OfficeVSO_9489361_ExcelRun")?await Excel.run(n):await n(this.requestContext)}catch(e){if(A.M.getInstance().logErrorCode(i.O.FetchAndSetActiveTableFailed,e),!(0,w.yw)("OfficeVSO_9267639_dontThrowContextFetch"))throw e}finally{(0,z.NQ)("FetchAndSetActiveTable",performance.now()-n)}}async fetchAndSetActiveTableArray(e){try{if(this.selectedTableNames)for(const e of this.selectedTableNames)await this.fetchAndSetActiveTable(e,!0);if(this.activeRangeAreas){const t=this.activeRangeAreas.split(",").map((t=>this.dispatch(M.mF.getRangeIntersectingTabularRangeMetadata(e,t)))).flat();for(const e of t)await this.fetchAndSetTabularRangeAsActiveTable(e,!0)}}catch(e){(0,r.cY)(e)}}async getTableNamesUndefinedForDeletedTables(e){const t=e.map((e=>{const t=this.requestContext.workbook.tables.getItemOrNullObject(e);return t.load("name"),t}));await this.requestContext.sync();return t.map((e=>{if(!e.isNullObject)return e.name;(0,r.cY)("Table not found in getTableNamesUndefinedForDeletedTables - likely recently deleted")}))}async clearTableAndInvalidateNLResultFromId(e){if(this.pendingTableClear.add(e),this.isTableClearing)return;this.isTableClearing=!0;const t=Array.from(this.pendingTableClear);this.isTableClearing=!1,this.pendingTableClear.clear();(await this.getTableNamesUndefinedForDeletedTables(t)).filter((e=>void 0!==e)).forEach((e=>this.clearTableAndInvalidateNL(e)))}clearTableAndInvalidateNL(e){this.dispatch(M.mF.clearTable(e)),this.dispatch(B.mF.invalidateCurrentNLResult())}buildArrayString(e){return JSON.stringify(e)}async getClosestTableInfo(e,t){if(!t)return;const a=await J().getTablesNameToRangeMapOnSheet(this.requestContext,e);let n,o;const r=this.getRangeAddressesFromAddress(t);for(const t of r){if(Object.keys(a).length>0){const e=Object.keys(a);for(const o of e){const e=a[o],r=l.ExcelCalc.addressToExcelRange(t);if(l.ExcelCalc.IExcelRangeContainedIn(r,e.range))return{name:o,distance:0,isContained:!0};if(l.ExcelCalc.IExcelRangeIntersect(r,e.range))return{name:o,distance:0};{const t=(0,$._)(r,e.range);(!n||t<n.distance)&&(n={name:o,distance:t})}}}const r=this.dispatch(M.mF.getTabularRangeMetadataFromRange(e,t));(!o||r&&r.distance<o.distance)&&(o=r)}return 0===n?.distance?n:n?.distance&&0!==o?.distance?(o?.distance&&o.distance<n.distance&&(n=o),n):o}async getContainingTableName(e,t){const a=await J().getTablesNameToRangeMapOnSheet(this.requestContext,e);if((0,w.yw)("OfficeVSO_8601440_SplitAddressRange")){if(Object.keys(a).length>0&&t){const e=Object.keys(a);for(const n of e){const e=a[n],o=this.getRangeAddressesFromAddress(t);for(const t of o){const a=l.ExcelCalc.addressToExcelRange(t);if(l.ExcelCalc.IExcelRangeContainedIn(a,e.range))return n}}}return}let n;if(Object.keys(a).length>0){const e=Object.keys(a);for(const o of e){const e=a[o],r=(0,V.E)(t);if(l.ExcelCalc.IExcelRangeContainedIn(r,e.range)){n=o;break}}}return n}async doesRangeContainPivotTable(e,t){try{const a=this.getRangeAddressesFromAddress(t)[0],n=this.requestContext.workbook.worksheets.getItem(e).getRange(a).getPivotTables().getCount();return await this.requestContext.sync(),n.value>0}catch(e){return A.M.getInstance().logErrorCode(i.O.FetchPivotTableFailed,e),!1}}async setContext(e,t){if(this.isPythonCellSelected=await this.pythonContextManager.isPythonCell(e,t),this.selectedPythonSheetId=e,this.selectedPythonAddress=t,this.isPythonCellSelected)if((0,w.yw)("OfficeVSO_9217416_PythonAARemoveSettingActiveTableUndefined"))this.pythonContextManager.isPythonMode&&!(0,w.qm)()&&this.clearSelectionError();else if(!(0,w.ZA)())return this.clearSelectionError(),void this.setActiveTable(void 0);let a=!1;if((0,w.ZA)()&&this.activeRangeAreas){if(this.setActiveTable(void 0),await this.fetchAndSetActiveTableArray(e),this.activeTables.length)return}else if((0,w.qm)()){this.activePivotTable=void 0;const n=await this.getClosestTableInfo(e,t);if(n){if(n?.tabularRange?await this.fetchAndSetTabularRangeAsActiveTable(n.tabularRange,void 0,n):await this.fetchAndSetActiveTable(n.name,void 0,n),!(0,w.tg)())return;a=!!n}}else{const a=await this.getContainingTableName(e,t);if(null!=a)return void await this.fetchAndSetActiveTable(a)}let n,o=!1;if((0,w.tg)()?n=await this.fetchActivePivotTable(e,t):o=await this.doesRangeContainPivotTable(e,t),o||n)return((0,w.ge)()||(0,w.tg)())&&(n&&(this.activePivotTable=n),a||this.setActiveTable(void 0)),void this.setSelectionError("PIVOT_TABLE_SELECTED");if((0,w.tg)()){if(a)return void(this.pendingSelectionError?(this.setSelectionError(this.pendingSelectionError),this.pendingSelectionError=void 0):this.clearSelectionError());if(await this.fetchAndSetUnrecognizedRange(e))return}(0,w.qm)()?this.setNoTableSelectedError():await this.getAndSetTabularRange(e,t)}getPivotTableAttributes(e){return{name:e.name,hierarchies:e.hierarchies.items.map((e=>e.name)),columnHierarchies:e.columnHierarchies.items.map((e=>e.name)),dataHierarchies:e.dataHierarchies.items.map((e=>e.name)),filterHierarchies:e.filterHierarchies.items.map((e=>e.name)),rowHierarchies:e.rowHierarchies.items.map((e=>e.name))}}async fetchActivePivotTable(e,t){let a=i.O.FetchPivotTableFailedToLoadRange;const n=performance.now();try{return await Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(e).getRanges(t).areas;o.load("items/isNullObject"),await n.sync();a=i.O.FetchActivePivotTableFailed;const r=o.items.map((e=>{const t=e.getPivotTables().getFirstOrNullObject();return t.load("name,columnHierarchies/items/name,dataHierarchies/items/name,filterHierarchies/items/name,hierarchies/items/name,rowHierarchies/items/name"),t}));await n.sync();const l=r.find((e=>!e.isNullObject));if(l)return this.getPivotTableAttributes(l)}))}catch(e){return A.M.getInstance().logErrorCode(a,e),void(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidArgument&&(0,r.cY)(r.SA.Error,a,e.code,e.debugInfo.errorLocation,t,this.activeWorksheetName))}finally{(0,z.NQ)("FetchActivePivotTable",performance.now()-n)}}async setContextWithAddressValidation(e,t,a){(0,w.yw)("OfficeVSO_9445408_SetContextShouldAlsoUpdateActiveSheetId")?(this.activeWorksheetId=e,this.activeWorksheetName=t,this.activeRangeAddress=a,a?await this.setContext(e,a):(this.setActiveTable(void 0),this.setSelectionError("NOTHING_SELECTED"))):a?(this.activeRangeAddress=a,await this.setContext(e,a)):(this.setActiveTable(void 0),this.setSelectionError("NOTHING_SELECTED"))}async getAndSetTabularRange(e,t){const a=(0,L.R1)(this.dispatch,e,t);a?await this.fetchAndSetTabularRangeAsActiveTable(a):this.setNoTableSelectedError()}async fetchAndSetTabularRangeAsActiveTable(e,t=!1,a){const n=performance.now();try{const n=async n=>{const o=e.interpretation.orientation,r=(0,L.K7)(e),{left:i,top:l,right:s,bottom:c,worksheetId:d}=r;let u=e?.unsupportedFeatures;const m=n.workbook.worksheets.getItem(d);m.load("name");const g=(0,L.vs)(m,r,o);g.load("values");m.getRangeByIndexes(l+1,i,c-l,1).load("values");const h=(0,L._f)(m,r);if((0,w.yw)("OfficeVSO_9470063_LocalizeNumberFormat")){const e=["values","numberFormat","numberFormatCategories","numberFormatLocal"];h.load(e)}else h.load("values, numberFormat, numberFormatCategories");const p=m.getRangeByIndexes(c,i,1,s-i+1);p.load("values");const b=[];for(let e=i;e<=s;e++){const t=m.getCell(l,e);t.load("hidden"),b.push(t)}await n.sync();const f=(0,L.Sy)(g,o,e.unsupportedFeatures),C=f.some((e=>""===e));(0,w.tg)()&&(C&&(u|=k.ye.EmptyHeaders),new Set(f).size!==f.length&&(u|=k.ye.DuplicateHeaders));const y=[];for(let e=0;e<s-i+1;e++)b[e].hidden||y.push(e);const v={sheet:m.name,range:{topLeft:{row:l,column:i},bottomRight:{row:c,column:s}}},T=this.buildArrayString(h.numberFormatCategories),S=this.getNumberFormat(h),E={name:e.name,address:e.name,headers:this.buildArrayString(f),numRows:c-l,numColumns:s-i+1,firstRowValues:this.buildArrayString(h.values[0]),lastRowValues:this.buildArrayString(p.values[0]),numberFormats:this.buildArrayString(S[0]),numberFormatCategories:T,visibleColumns:y,sheetRange:v,totalRow:!!(0,w.tg)()&&e.hasTotalRow,tableLikeRange:!0,tableContained:a?.isContained,tableIntersected:a?0===a.distance:void 0,tableLikeRangeFeatures:u};this.setActiveTable(E,t,d),this.selectionError=void 0,this.dispatch(M.mF.updateTableLikeEntity({type:x.lp.TableLikeRange,table:E})),(0,w.Xh)()&&u&k.ye.All?this.setSelectionError("UNSUPPORTED_RANGE"):(0,w.yw)("OfficeVSO_9130675_tlrSelectionError")&&!(0,w.tg)()&&this.clearSelectionError()};return(0,w.yw)("OfficeVSO_9489361_ExcelRun")?await Excel.run(n):await n(this.requestContext)}catch(e){if(A.M.getInstance().logErrorCode(i.O.FetchAndSetTabularRangeAsActiveTableFailed,e),(0,w.qK)()&&this.isPayloadTooLargeError(e))return void(this.pendingSelectionError="PAYLOAD_TOO_LARGE");if(!(0,w.yw)("OfficeVSO_9267639_dontThrowContextFetch"))throw e}finally{(0,z.NQ)("FetchAndSetTabularRangeAsActiveTable",performance.now()-n)}}async getSelectedRanges(){const e=this.requestContext.workbook.getSelectedRanges(),t=this.requestContext.workbook.getActiveCell(),a=e.areas;let n;a.load("items/address"),e.load("address"),t.load("address"),(0,w.yw)("OfficeVSO_9276866_updateSheetWithSelectedRanges")&&(n=this.requestContext.workbook.worksheets.getActiveWorksheet(),n.load("id,name,isNullObject")),await this.requestContext.sync(),(0,w.ZA)()?(this.activeRangeAreas=e.address,this.activeCell=t.address?(0,q.r)(t.address):void 0):(0,w.yw)("OfficeVSO_9369541_CFFormulaSupport")&&(this.activeCell=t.address?(0,q.r)(t.address):void 0),(0,w.yw)("OfficeVSO_9276866_updateSheetWithSelectedRanges")&&n&&!n.isNullObject&&this.activeWorksheetId!==n.id&&(this.activeWorksheetId=n.id,this.activeWorksheetName=n.name);return a.items.map((e=>e.address))}async fetchAndSetUnrecognizedRange(e){const t=performance.now();try{const t=async t=>{const a=t.workbook.getActiveCell(),n=a.getSurroundingRegion(),o=n.getPivotTables().getCount(),i=["numberFormat","numberFormatCategories","text"];(0,w.yw)("OfficeVSO_9470063_LocalizeNumberFormat")&&i.push("numberFormatLocal"),a.load("valuesAsJson, isNullObject"),n.load(["address","rowCount","columnCount","cellCount"]);const s=n.getRow(0).load(i),c=n.getLastRow().load(["text"]);let d,u,g,h,p,b,f,C;(0,w.ZA)()&&(f=n.getTables().getCount(),C=()=>{const t=this.dispatch(M.mF.getTabularRangeMetadataFromRange(e,n.address));return!!t&&0===t.distance});try{if(await t.sync(),n.cellCount<4||o.value>0||f&&f.value>0||C?.())return;d=n.rowCount,u=n.columnCount,g=s.text,b=c.text,h=this.getNumberFormat(s),p=s.numberFormatCategories}catch(e){if(e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.itemNotFound||e.code===Excel.ErrorCodes.invalidSelection))return;throw(0,r.cY)(r.SA.Error,e),e}const y=e=>this.buildArrayString(e?e[0]:[]),v=y(g),T=y(b),S=y(h);let E=()=>Array.from({length:u},((e,t)=>t));const R=t.workbook.getActiveCell().getSurroundingRegion(),I=Array.from({length:u},((e,t)=>t)).map(((e,t)=>{const a=R.getCell(0,t);return a.load("hidden"),{index:t,cell:a}}));E=()=>I.filter((({cell:e})=>!e.hidden)).map((({index:e})=>e));const A=y(p),L=l.ExcelCalc.sheetAddressToExcelSheetRange(n.address);await t.sync();const F=E(),_={name:n.address,address:n.address,headers:m.r$C,numRows:d,numColumns:u,firstRowValues:v,lastRowValues:T,numberFormats:S,numberFormatCategories:A,visibleColumns:F,sheetRange:L,totalRow:!1,tableLikeRange:!0,tableContained:!0,tableIntersected:!0,tableLikeRangeFeatures:k.ye.Unrecognized};return this.setActiveTable(_,void 0,e),this.dispatch(M.mF.updateTableLikeEntity({type:x.lp.Range,table:_})),(0,w.Xh)()?this.setSelectionError("UNSUPPORTED_RANGE"):this.clearSelectionError(),n.address};return(0,w.yw)("OfficeVSO_9489361_ExcelRun")?await Excel.run(t):await t(this.requestContext)}catch(e){if(A.M.getInstance().logErrorCode(i.O.FetchAndSetUnrecognizedRangeFailed,e),(0,w.qK)()&&this.isPayloadTooLargeError(e))return void(this.pendingSelectionError="PAYLOAD_TOO_LARGE");if(!(0,w.yw)("OfficeVSO_9267639_dontThrowContextFetch"))throw e;return}finally{(0,z.NQ)("FetchAndSetUnrecognizedRange",performance.now()-t)}}async doesRemoteChangeIntersectTable(e){try{if(e.worksheetId!==this.activeWorksheetId)return!1;const t=e.getRangeOrNullObject(this.requestContext),a=this.requestContext.workbook.worksheets.getActiveWorksheet();if(await this.requestContext.sync(),t.isNullObject)return!1;const n=a.getRange(this.getActiveTable()?.name),o=n.getIntersectionOrNullObject(t);return await this.requestContext.sync(),!n.isNullObject&&!o.isNullObject}catch(e){return A.M.getInstance().logError({eventType:P.S.ContextManager,errorMessage:"Failed to check for remote changes in tabular range",logLevel:c.$b.Warning}),!1}}async updateActiveRange(e,t){await Excel.run((async a=>{const n=a.workbook,o=n.getActiveChartOrNullObject();if(await a.sync(),!o.isNullObject||(0,w.ZA)())return;const r=t?n.worksheets.getItem(t):n.worksheets.getActiveWorksheet(),i=e?r.getRange(e):n.getSelectedRange();i.load(["rowCount","columnCount","rowIndex","columnIndex","address"]);const l=10,s=["text","rowIndex","columnIndex"],c=["areas/items/rowCount","areas/items/columnCount","areas/items/rowIndex","areas/items/columnIndex"],d=i.getIntersection(i.getAbsoluteResizedRange(l,l)),u=i.getMergedAreasOrNullObject();await a.sync();const{columnCount:m,columnIndex:g,rowCount:h,rowIndex:p}=i;if(m*h>1){d.load(s),u.load(c);const e={topLeft:{range:d,mergedAreas:u}},t=p+h,n=g+m;if(h>l){const a=r.getRangeByIndexes(t-2,g,2,Math.min(l,m)).load(s),n=a.getMergedAreasOrNullObject().load(c);e.lastRows={range:a,mergedAreas:n}}if(m>l){const t=r.getRangeByIndexes(p,n-2,Math.min(l,h),2).load(s),a=t.getMergedAreasOrNullObject().load(c);e.lastCols={range:t,mergedAreas:a}}if(m>l&&h>l){const a=r.getRangeByIndexes(t-2,n-2,2,2).load(s),o=a.getMergedAreasOrNullObject().load(c);e.bottomRight={range:a,mergedAreas:o}}await a.sync();for(const t of Object.values(e)){const{range:e,mergedAreas:a}=t,n=t.values=e.text;if(!a.isNullObject)for(const t of a.areas.items){const a=t.rowIndex-e.rowIndex,o=t.columnIndex-e.columnIndex;if(a>=n.length||o>=n[o].length)continue;const r=n[a][o];for(let e=a;e<a+t.rowCount&&e<n.length;e++)for(let a=o;a<o+t.columnCount&&a<n[e].length;a++)n[e][a]=r}}this.activeRange={address:i.address,numRows:i.rowCount,numCols:i.columnCount,topLeftValues:e.topLeft.values,lastRowsValues:e.lastRows?.values,lastColsValues:e.lastCols?.values,bottomRightValues:e.bottomRight?.values}}else this.activeRange=void 0})).catch((()=>{this.activeRange=void 0}))}setNoTableSelectedError(){this.setActiveTable(void 0),this.activePivotTable=void 0,this.setSelectionError("NO_TABLE_SELECTED")}async getTableNameFromWorksheetIdAndAddress(e,t){if((0,w.qm)()){const a=await this.getClosestTableInfo(e,t);return a?.name}return await this.getContainingTableName(e,t)}async doSelectionIntegrityCheck(){const e=performance.now();let t=i.O.SelectionIntegrityCheckFlushingSelectionFailed;try{const e=this.pendingSelection;this.isUpdatingSelection=!1,e&&((0,r.cY)("Flushing pending selection update in doSelectionIntegrityCheck"),this.pendingSelection=void 0,await this.updateSelection(...e)),t=i.O.SelectionIntegrityCheckEncounteredNonWorksheet;const a=this.requestContext.workbook.worksheets.getActiveWorksheet();a.load("id"),await this.requestContext.sync(),t=i.O.SelectionIntegrityCheckEncounteredNoGridSelection;const n=this.requestContext.workbook.getSelectedRanges();n.load("address,areas/isNullObject,worksheet/id");const o=n.areas.getItemAt(0);(0,w.yw)("OfficeVSO_9445408_SetContextShouldAlsoUpdateActiveSheetId")?o.load("address,worksheet/id,worksheet/name"):o.load("address,worksheet/id");const l=this.requestContext.workbook.getActiveCell();l.load("address,worksheet/id"),await this.requestContext.sync(),t=i.O.SelectionIntegrityCheckFailed,(0,w.yw)("OfficeVSO_9457335_IncludeChartInSelectionIntegrityCheck")&&(this.activeChart=void 0),o.worksheet.id===a.id&&l.worksheet.id===a.id&&o.worksheet.id===l.worksheet.id||A.M.getInstance().logError({eventType:P.S.ContextManager,errorMessage:"OfficeJS reported inconsistent worksheet ID between active worksheet, selected range, and active cell",logLevel:c.$b.Warning});const s=await this.getClosestTableInfo(o.worksheet.id,o.address),d=this.getActiveTable();if(s?.name!==d?.name&&(!(0,w.qK)()||"PAYLOAD_TOO_LARGE"!==this.selectionError)){const e=!d&&s?i.O.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent:i.O.SelectionIntegrityCheckFoundTableMismatch;A.M.getInstance().logErrorCode(t,new Error(e)),await this.setContextWithAddressValidation(o.worksheet.id,(0,w.yw)("OfficeVSO_9445408_SetContextShouldAlsoUpdateActiveSheetId")?o.worksheet.name:this.activeWorksheetName,o.address)}if(!(0,w.Lr)()&&s?.name){this.dispatch(M.mF.getChartCache(s?.name))||(t=i.O.GetNLContextFailed,await this.dispatch(M.mF.getNLContextIfNeeded(s.name)))}}catch(e){if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidSelection)return;A.M.getInstance().logErrorCode(t,e)}finally{(0,z.NQ)("DoSelectionIntegrityCheck",performance.now()-e)}}constructor(e){this.selectionError=void 0,this.pendingSelectionError=void 0,this.activeWorksheetName=void 0,this.activeWorksheetId=void 0,this.activeRangeAddress=void 0,this.activeTables=[],this.activeRangeAreas=void 0,this.selectedTableNames=void 0,this.activeCell=void 0,this.activeRange=void 0,this.activeChart=void 0,this.activePivotTable=void 0,this.activeUxRail=void 0,this.humanInTheLoopRange=void 0,this.worksheetsWithChartsOnActivated=[],this.isUpdatingSelection=!1,this.isTableClearing=!1,this.pendingTableClear=new Set,this.isPythonCellSelected=!1,this.selectedPythonSheetId=void 0,this.selectedPythonAddress=void 0,this.pythonAdaStaticPromptOverride=void 0,this.activePythonTableSheetId=void 0,this.calculatedFormulaInsertLocation=void 0,this.initMemo=new d.d((async()=>{await this.init()})),this.refreshSelectionContext=(0,U.debounce)((async()=>{if(!(0,w.yw)("OfficeVSO_9445408_SetContextShouldAlsoUpdateActiveSheetId")||!this.mutexToken)return(0,w.yw)("OfficeVSO_9462726_updateSelectionOnTableRefresh")?await this.updateSelection():void(this.activeRangeAddress&&this.activeWorksheetId?await this.setContext(this.activeWorksheetId,this.activeRangeAddress):await this.updateSelection(this.activeWorksheetId))}),0),this.refreshActiveTable=(0,r.BC)((0,w.yw)("OfficeVSO_9476616_gatedAsyncDebounce"),(async(e,t)=>{const a=this.getActiveTable();e&&t!==a?.name||a&&((0,w.yw)("OfficeVSO_9344154_resolveTableLikeEntityIfNeeded")?await this.dispatch(M.mF.resolveTableLikeEntityIfNeeded(a,!0)):await this.dispatch(M.mF.resolveTableLikeEntity(a.name,!0)))}),500),this.requestContext=e,this.mutex=new u.e,this.pythonContextManager=new N(e),(0,w.vo)()&&(this.pythonCalculatedColumnContextManager=new p)}}(new Excel.RequestContext)},8505:(e,t,a)=>{var n,o,r;a.d(t,{lp:()=>n,px:()=>o,qf:()=>r}),function(e){e.StandardTable="StandardTable",e.TableLikeRange="TableLikeRange",e.Range="Range"}(n||(n={})),function(e){e.SinglePythonObjectCell="SinglePythonObjectCell",e.SingleExcelValueCell="SingleExcelValueCell",e.SpilledExcelValueCell="SpilledExcelValueCell"}(o||(o={})),function(e){e.Error="Error",e.PngImageFile="<class 'PIL.PngImagePlugin.PngImageFile'>",e.ImageFile="<class 'PIL.Image.Image'>",e.None="<class 'NoneType'>"}(r||(r={}))},51319:(e,t,a)=>{a.d(t,{DH:()=>o,w2:()=>r,wv:()=>n});class n{}var o,r;n.Worksheet={Activate:"Worksheet.activated",Filter:{Icon:"Worksheet.filtered.Icon",BottomItems:"Worksheet.filtered.BottomItems",BottomPercent:"Worksheet.filtered.BottomPercent",TopItems:"Worksheet.filtered.TopItems",TopPercent:"Worksheet.filtered.TopPercent",Values:"Worksheet.filtered.Values",Custom:"Worksheet.filtered.Custom",Dynamic:"Worksheet.filtered.Dynamic",FontColor:"Worksheet.filtered.FontColor",CellColor:"Worksheet.filtered.CellColor"},ClearFilter:"Worksheet.clearedFilter",ClearColumnFilter:"Worksheet.clearedColumnFilter"},n.Range={Sort:"Range.sorted"},n.Table={Sort:"Table.sorted",TotalRow:"Table.totalRowToggled",HeaderRow:"Table.headerRowToggled",BandedRows:"Table.bandedRowsToggled",BandedColumns:"Table.bandedColumnsToggled",FirstColumn:"Table.firstColumnToggled",LastColumn:"Table.lastColumnToggled",FilterButton:"Table.filterButtonToggled",FilterColor:"Table.filterColor",ApplyStyle:"Table.styleApplied",ApplyTableUpdatePlan:"Table.applyPowerQueryTableUpdatePlan"},n.Format={IndentChange:"Format.indentChange",RemoveAutofitColumns:"Format.removeAutofitColumns",RemoveAutofitRows:"Format.removeAutofitRows"},n.ConditionalFormatting={ApplyIconSetConditionalFormatting:"ConditionalFormatting.applyIconSetConditionalFormatting"},function(e){e.Undo="Undo",e.TableAltText="TableAltText",e.RefreshData="RefreshData",e.AddComment="AddComment",e.DataValidation="DataValidation",e.CreatePivotTable="CreatePivotTable",e.InsertWorksheets="InsertWorksheets",e.DeleteWorksheets="DeleteWorksheets",e.InsertTables="InsertTables",e.FreezePanes="FreezePanes",e.Formatting="Formatting"}(o||(o={})),function(e){e[e.OfficeScripts=0]="OfficeScripts",e[e.OfficeJS=1]="OfficeJS",e[e.Insights=2]="Insights",e[e.FormulaGeneration=3]="FormulaGeneration",e[e.DataShaping=4]="DataShaping",e[e.UnsupportedEvent=5]="UnsupportedEvent",e[e.ConditionalFormatSuggestion=6]="ConditionalFormatSuggestion",e[e.ImportData=7]="ImportData"}(r||(r={}))},33292:(e,t,a)=>{a.d(t,{UO:()=>d,Vq:()=>c,q9:()=>s,uR:()=>l});var n=a(61150),o=a(98483);const r=new Map,i={id:"",resolve:()=>{},reject:()=>{}};async function l(){await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.tables.load("items/name");await e.sync();for(const a of t.items)await u(e,a)}))}function s(e){m(e,void 0,`Table ${e} was deleted.`)}async function c(e){await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e).load("name");await t.sync(),r.has(a.name)||await u(t,a)}))}async function d(e){const t=r.get(e.tableId);if(!t)throw new Error(`Table ${e.tableId} was not registered for applyPowerQueryTableUpdatePlan.`);if(!e.planJson)throw new Error("planJson is missing in the annotation.");if(t!==i)throw new Error(`Table ${e.tableId} is busy.`);return await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e.tableId),i=(0,o.A)(),l=function(e,t){return new Promise(((a,n)=>{r.set(e,{id:t,resolve:a,reject:n})}))}(e.tableId,i);try{a.applyPowerQueryTableUpdatePlan(i,e.planJson),await t.sync()}catch(t){(0,n.cY)(`applyPowerQueryTableUpdatePlan failed: ${t.message}`),m(e.tableId,i,t.Message)}await l})),`I applied the following power query transformation on the table: '${e.queryScriptExplanation}'`}async function u(e,t){h(t.name),t.onApplyPowerQueryTableUpdatePlanCompleted.add((async e=>{var a,n;e.success?(a=t.name,n=e.id,g(a,n,(e=>e.resolve()))):m(t.name,e.id,e.error)})),await e.sync()}function m(e,t,a){g(e,t,(e=>e.reject(a)))}function g(e,t,a){const n=r.get(e);if(n&&n!==i){if(t&&t!==n.id)return;try{a(n)}finally{h(e)}}}function h(e){r.set(e,i)}},7024:(e,t,a)=>{a.d(t,{$h:()=>u,We:()=>p,hf:()=>h,lx:()=>g});var n=a(21792),o=a(8338),r=a(50347),i=a(96699),l=a(97869),s=a.n(l),c=a(31137),d=a(96756);async function u(e){const{sheetName:t,rangeAddress:a,entityName:n,entityType:o,columnIndex:r,filteredDataDisplayName:i,filterCriteria:l}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const i=e.workbook.worksheets.getItem(t).getRange(a);e.workbook[o].getItem(n).autoFilter.apply(i,r,l),await e.sync()})),g(i,l)}const m=(0,r.k6)()&&(0,r.yw)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS");function g(e,t){const{filterOn:a,criterion1:l,color:u}=t;let g=m?ExcelCopilotCommandingHitlStrings.WorksheetDefaultFilterLabel:c.Intents.WorksheetDefaultFilterLabel;switch(a){case"CellColor":g=m?ExcelCopilotCommandingHitlStrings.WorksheetCellColorFilterLabel:c.Intents.WorksheetCellColorFilterLabel;break;case"FontColor":g=m?ExcelCopilotCommandingHitlStrings.WorksheetFontColorFilterLabel:c.Intents.WorksheetFontColorFilterLabel;break;case"Values":g=m?ExcelCopilotCommandingHitlStrings.WorksheetValuesFilterAppliedLabel:c.Intents.WorksheetValuesFilterAppliedLabel;break;case"Dynamic":g=m?ExcelCopilotCommandingHitlStrings.WorksheetDynamicFilterAppliedLabel:c.Intents.WorksheetDynamicFilterAppliedLabel;break;case"TopItems":g=m?ExcelCopilotCommandingHitlStrings.WorksheetTopItemsFilterLabel:c.Intents.WorksheetTopItemsFilterLabel;break;case"TopPercent":g=m?ExcelCopilotCommandingHitlStrings.WorksheetTopPercentFilterLabel:c.Intents.WorksheetTopPercentFilterLabel;break;case"BottomItems":g=m?ExcelCopilotCommandingHitlStrings.WorksheetBottomItemsFilterLabel:c.Intents.WorksheetBottomItemsFilterLabel;break;case"BottomPercent":g=m?ExcelCopilotCommandingHitlStrings.WorksheetBottomPercentFilterLabel:c.Intents.WorksheetBottomPercentFilterLabel;break;case"Custom":return function(e,t){if(!t.criterion1)return(0,d.A)(m?ExcelCopilotCommandingHitlStrings.WorksheetCustomFilterAppliedLabel:c.Intents.WorksheetCustomFilterAppliedLabel,{columnName:e});let a,n=m?o.O.UnhandledIntent:c.Intents.WorksheetCustomFilterAppliedLabel,{valueCompareType:l,value:u}=s().getCustomFilterCompareType(t.criterion1);if(t.criterion2)if((0,r.yw)("OfficeVSO_9126157_FixTLRFilterBetween")){const{valueCompareType:e,value:n}=s().getCustomFilterCompareType(t.criterion2);a=n,l===i.default.IsGreaterThenOrEqualTo&&e===i.default.IsLessThanOrEqualTo&&t.operator===Excel.FilterOperator.and?l=i.default.IsBetween:l===i.default.IsLessThen&&e===i.default.IsGreaterThan&&t.operator===Excel.FilterOperator.or&&(l=i.default.IsNotBetween)}else a=s().getCustomFilterCompareType(t.criterion2)?.value;switch(l){case i.default.Equals:n=m?ExcelCopilotCommandingHitlStrings.TableColumnEqualsFilterLabel:c.Intents.TableColumnEqualsFilterLabel;break;case i.default.DoesNotEqual:n=m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualFilterLabel:c.Intents.TableColumnDoesNotEqualFilterLabel;break;case i.default.BeginsWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel2:c.Intents.TableColumnBeginsWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel1:c.Intents.TableColumnBeginsWithFilterLabel1;break;case i.default.DoesNotBeginWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel2:c.Intents.TableColumnDoesNotBeginWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel1:c.Intents.TableColumnDoesNotBeginWithFilterLabel1;break;case i.default.EndsWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel2:c.Intents.TableColumnEndsWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel1:c.Intents.TableColumnEndsWithFilterLabel1;break;case i.default.DoesNotEndWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel2:c.Intents.TableColumnDoesNotEndWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel1:c.Intents.TableColumnDoesNotEndWithFilterLabel1;break;case i.default.Contains:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel2:c.Intents.TableColumnContainsFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel1:c.Intents.TableColumnContainsFilterLabel1;break;case i.default.DoesNotContain:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel2:c.Intents.TableColumnDoesNotContainFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel1:c.Intents.TableColumnDoesNotContainFilterLabel1;break;case i.default.IsGreaterThan:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanFilterLabel:c.Intents.TableColumnIsGreaterThanFilterLabel;break;case i.default.IsGreaterThenOrEqualTo:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanOrEqualToFilterLabel:c.Intents.TableColumnIsGreaterThanOrEqualToFilterLabel;break;case i.default.IsLessThen:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanFilterLabel:c.Intents.TableColumnIsLessThanFilterLabel;break;case i.default.IsLessThanOrEqualTo:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanOrEqualToFilterLabel:c.Intents.TableColumnIsLessThanOrEqualToFilterLabel;break;case i.default.IsBetween:n=m?ExcelCopilotCommandingHitlStrings.TableColumnBetweenFilterLabel:c.Intents.TableColumnBetweenFilterLabel;break;case i.default.IsNotBetween:n=m?ExcelCopilotCommandingHitlStrings.TableColumnNotBetweenFilterLabel:c.Intents.TableColumnNotBetweenFilterLabel;break;default:n=m?o.O.UnhandledIntent:c.Intents.WorksheetCustomFilterAppliedLabel}return(0,d.A)(n,{columnName:e,value1:u,value2:a})}(e,t);default:g=m?o.O.UnhandledIntent:c.Intents.WorksheetDefaultFilterLabel}return(0,d.A)(g,{range:e,criterion:l,color:m&&u?n.g.colorNameFromHEX(u):u})}async function h(e){const{entityName:t,entityType:a,columnIndex:n,changedDataDisplayName:o}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook[a].getItem(t).autoFilter.clearColumnCriteria(n),await e.sync()})),(0,d.A)(c.Intents.WorksheetRangeClearFiltersLabel,{range:o})}async function p(e){const{entityName:t,entityType:a,changedDataDisplayName:n}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook[a].getItem(t).autoFilter.clearCriteria(),await e.sync()})),(0,d.A)(c.Intents.WorksheetRangeClearFiltersLabel,{range:n})}},54447:(e,t,a)=>{a.d(t,{O9:()=>g,OP:()=>p,Or:()=>u,mN:()=>d,xY:()=>m});var n=a(89099),o=a(24220),r=a(51400),i=a(79029),l=a(48314),s=a(88179),c=a(50347);function d(e){(0,c._K)()?i.B.getInstance().logSeenEvent(s.q.Else):(e??l.M.getInstance()).logSeenEvent(s.q.Else)}function u(e){e.endTriedActivityFailure(s.q.Else)}function m(e,t){h(e)&&(e.chatResponseCode===r.Ay.OK?t.endTriedActivitySuccess(s.q.Else):u(t))}function g(e){return h(e)&&e.elseSkillStarted}function h(e){return e?.type===r.VF.ElseResponseMeta}function p(e){if(!h(e))return;const t=e.chatResponseCode;if(void 0!==t&&t!==r.Ay.OK)switch(t){case r.Ay.ServiceTimeout:return void a(o.W.Response_Delayed_Or_Timed_Out,n.c.Else_Service_Timed_Out);case r.Ay.RAICheckFailed:return void a(o.W.Responsible_AI_Filter_Blocked_Response,n.c.RAI_Validation_Failed);case r.Ay.FormulaError:return void a(o.W.Unable_To_Complete_Task,n.c.Else_Response_Blocked_Bad_Formula);case r.Ay.SearchAndActionNotAllowed:return void a(o.W.Unable_To_Complete_Task,n.c.Else_Response_Blocked_Unsupported_Chaining);case r.Ay.ServiceError:default:return void a(o.W.LLM_Service_Side_Issue_Prevents_Output,n.c.Else_Service_Error)}function a(e,t){l.M.getInstance().logStandardizedAshaErrorEvent(e,t,s.BJ.ExcelChatHelper)}}},22034:(e,t,a)=>{a.d(t,{e:()=>Y});var n=a(89099),o=a(24220),r=a(92779),i=a(72483),l=a(61437),s=a(51319),c=a(94303),d=a(8338),u=a(88179),m=a(66888),g=a(60637),h=a(79029),p=a(62522),b=a(74840),f=a(31030),C=a(48314),y=a(90922),v=a(6925),T=a(55683),x=a(70364),S=a(23147),w=a(22650),E=a(96098),R=a(25594);const I=async(e,t,a)=>{if(0===e.length)return!1;for(const n of e)await A(n,t,a);return!0},A=async(e,t,a)=>{try{const n=e?.args?.[0],o=JSON.parse(n),r=JSON.parse(e?.args?.[1]);return await(0,R.Nl)(t,C.M.userQueryGuid,a,r,o)}catch(e){C.M.getInstance().logError({eventType:f.S.ImportData,errorMessage:`got error during handling import data suggestion pill: ${e} ${JSON.stringify(e)}`,logLevel:u.$b.Error})}};var L=a(25433),F=a(1690),_=a(59726),N=a(71362);const k=async(e,t,a)=>{e.length;for(const n of e)switch(n.kind){case"addDataShapingTransformationSteps":await P(n.args,t,a);break;case"enterDataShapingMode":M(n.args,t,a);break;default:(0,F.x)(n)}return!0};let O=0;const P=async(e,t,a)=>{a(v.mF.setLatestRequestId(t));const n=JSON.parse(e.transformationStepsJson).map((e=>({name:`${e.stepName}_${++O}`,script:e.stepScript})));await a(v.mF.addDataShapingSteps(n));const o=(0,r.wzs)().replace("{0}",e.transformationStepsExplanation),{message:l,telemetry:s}=N.n.getAddStepSuccessResponse(o,(async()=>{await a(v.mF.undoDataShapingSteps(n))}));i.$.getInstance().displayResponse(l,s);const c=(0,_.N)(l);a(v.mF.sendSkillResponseToFlux(c,m.Aw.success,s))},M=(e,t,a)=>{a(v.mF.exitDataShapingMode());L.w.getInstance(a).showStartDataShapingCard(t,e.sessionId,e.tableName,e.mashupDocument,e.queryName,e.queryScript)};var D=a(80519),$=a(24180),B=a(61150),H=a(50347),U=a(78640);const q=async(e,t,a,n)=>{if(0===e.length)return!1;for(const o of e)await V(o,t,a,n);return!0},V=async(e,t,a,n)=>{if("addCalculatedColumns"!==e.func&&"aggregateColumns"!==e.func)throw new Error(`Unsupported function ${e.func} for formula generation`);if(e.args.length<1)throw new Error(`No arguments found for ${e.func}`);if(e.args.length>3)throw new Error(`Incorrect number of parameters for ${e.func}`);if(!(0,H.yw)("OfficeVSO_9299857_skipResolveTbleBeforeCallingFormulaGeneration")){const n=a(U.mF.getIsModelWorkflowUnsupported());(0,H.rb)()&&!n?(0,B.cY)("executeCalculatedColumnsEvent: skipping resolveTableLikeEntity for due to hybrid cc"):await a(U.mF.resolveTableLikeEntity(e.args[0],!1,t))}a($.m.updateTableName({requestId:t,table:e.args[0]})),1===e.args.length?await a($.m.fetchColumnRecommendations(t,D.Yw.GeneralFormula,n)):(a($.m.updateSearchText({requestId:t,text:e.args[1]})),"aggregateColumns"===e.func?((0,B.cY)("fetchCellRecommendations"),await a($.m.fetchCellRecommendations(t,D.Yw.NLToFormula,n))):((0,B.cY)("fetchColumnRecommendations"),await a($.m.fetchColumnRecommendations(t,D.Yw.NLToFormula,n))))},G=async(e,t,a,n)=>{if(0===e.length)return!1;for(const o of e)await W(o,t,a,n);return!0},W=async(e,t,a,n)=>{if("getTableInsights"!==e.func)throw new Error(`Unsupported function ${e.func} for Insights agent`);if(e.args.length<1)throw new Error("No arguments found for getTableInsights");const o=e.args[0],r=e.args[1],i=S.CP.getActiveTable();if(!i||i.name!==o)throw new Error("The query is not aimed at the active table");a(U.mF.getInsights(o,i,r,t,n))};var z=a(2379),Q=a(95674),J=a(33637);var j=a(89337);class Y{async applyCommandingProgram(e,t,a,n,o,i){await(0,x.$r)((0,r.Eyh)()),a(v.mF.startExecutingAndLockContext(u.OP.Commanding));const c=(new Date).getTime();for(const r of t){let t="",l=!1;const c=(new Date).getTime();try{const n=r.items;switch(i){case s.w2.OfficeJS:t="OfficeJS",l=await this.executeJsApiEvent(e,n,a,o);break;case s.w2.OfficeScripts:t="OfficeScripts",l=await this.executeOfficeScript(e,n,a,o)}l&&a(v.mF.appliedChangesOnWorkbook({caller:t,commandingMessages:o}))}catch(e){return a(U.mF.resetIsAllowRewrite()),this.logExecutorFailure(r,c),this.telemetryLogger.endTriedActivityFailure(u.q.Commanding),void((0,H.yw)("OfficeVSO_9039820_handleExecutionErrorHiTL")&&(await a(v.mF.stopExecutingAndReleaseContextLock()),n(e)))}}this.logExecutionSucceed(c),(0,H.BT)()?h.B.getInstance().logKeptEvent(u.BJ.Commanding,u.q.Commanding,y.RX.Command):this.telemetryLogger.logKeptEvent(u.q.Commanding),await(0,x.TA)(),await a(v.mF.stopExecutingAndReleaseContextLock()),this.addCommandingSuccessMessage(a,o,!1),(0,H.yw)("OfficeVSO_9083629_HiTLApplyResetShowUndoButton")&&l.Z.getInstance().setShowUndoButton(!1)}async execute(e,t,a,n,o){const r=(new Date).getTime();let i=!1,l=!1,d=!1;const m=[];let g=!1;for(const r of this.events){if(e.happened)throw new c.WD("Timeout detected during HybridEventExecutor.execute");const h=(new Date).getTime();try{switch(r.agent){case s.w2.OfficeJS:(0,H.k6)()?d||(i=await this.showCommandingHumanInTheLoop(e,this.events,a,(e=>n(e)),m,r.agent)||i,d=!0):(this.telemetryLogger.endTriedActivitySuccess(u.q.Commanding),l=await this.executeJsApiEvent(e,r.items,a,m)||l,l&&a(v.mF.appliedChangesOnWorkbook({caller:"OfficeJS",commandingMessages:m})));break;case s.w2.OfficeScripts:(0,H.k6)()?d||(i=await this.showCommandingHumanInTheLoop(e,this.events,a,(e=>n(e)),m,r.agent)||i,d=!0):(this.telemetryLogger.endTriedActivitySuccess(u.q.Commanding),l=await this.executeOfficeScript(e,r.items,a,m)||l,l&&a(v.mF.appliedChangesOnWorkbook({caller:"OfficeScripts",commandingMessages:m})));break;case s.w2.Insights:this.telemetryLogger.endTriedActivitySuccess(u.q.AnalyzeData),i=await G(r.items,t,a,o)||i;break;case s.w2.ImportData:(0,H.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)&&(this.telemetryLogger.endTriedActivitySuccess(u.q.ImportDataFromSearch),i=await I(r.items,t,a)||i);break;case s.w2.FormulaGeneration:this.telemetryLogger.endTriedActivitySuccess("aggregateColumns"===r.items[0].func?u.q.CalculatedRows:u.q.CalculatedColumns),i=await q(r.items,t,a,o)||i;break;case s.w2.ConditionalFormatSuggestion:i=await(0,E.X)(r.items,t,a,o)||i;break;case s.w2.DataShaping:this.telemetryLogger.endTriedActivitySuccess(u.q.Commanding),i=await k(r.items,t,a)||i;break;case s.w2.UnsupportedEvent:this.telemetryLogger.endTriedActivityFailure(),g=!0;break;default:this.telemetryLogger.endTriedActivityFailure()}}catch(e){throw a(U.mF.resetIsAllowRewrite()),this.logExecutorFailure(r,h,e instanceof Error?e.message:void 0),this.telemetryLogger.endTriedActivityFailure(),e}}if(!i&&!l)throw this.telemetryLogger.endTriedActivityFailure(),this.logNoEventsExecuted(),this.hasOnlyUnsupportedEvents()?new c.j4("Only unsupported events.",function(e){let t=[];for(const a of e)a.agent===s.w2.UnsupportedEvent&&(t=t.concat(a.items));return t}(this.events)):new Error("No events were executed!");this.logExecutionSucceed(r),l&&((0,H.BT)()?h.B.getInstance().logKeptEvent(u.BJ.Commanding,u.q.Commanding,y.RX.Command):this.telemetryLogger.logKeptEvent(u.q.Commanding),this.addCommandingSuccessMessage(a,m,g))}async executeJsApiEvent(e,t,a,n){if(0===t.length)return!1;(0,H.k6)()||a(v.mF.startExecutingCommand({command:u.OP.Commanding}));let o="";try{for(let a=0;a<t.length;a++){if(e.happened){const e=new c.WD("Timeout detected during executeJsApiEvent");throw(0,H.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&(e.errorCode="Timeout"),e}const r=t[a];o=r.method.toString();const i=await r.func(r.args);n.push(i)}}catch(e){throw this.logJsApiExecutorError(e,o),this.logCommandingAshaError(e.errorCode),this.isExecutingMultipleEvents()?new c.m2("Error has occurred when executing multiple events."):e}return!0}async executeOfficeScript(e,t,a,n){if(0===t.length)return!1;(0,H.k6)()||a(v.mF.startExecutingCommand({command:u.OP.Commanding}));try{if(e.happened){const e=new c.WD("Timeout detected during executeOfficeScript");throw(0,H.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&(e.errorCode="Timeout"),e}const a=await(0,J.V)(t);await this.runtimeHelper.prepareScript(a),await this.runtimeHelper.executeScript(a);if((0,w.yC)(t).forEach((e=>{e!==d.O.MissingIntent&&n.push(e)})),0===n.length){const e=[{key:u.Dh.EventType,value:u.Mv.LogMissingIntentString}];(0,j.j)(e)}}catch(e){throw e.isExecutorError&&this.logOfficeScriptExecutorError(e,t),this.logCommandingAshaError(e.errorCode),this.isExecutingMultipleEvents()?new c.m2("Error has occurred when executing multiple events."):e}return!0}logCommandingAshaError(e){if((0,H.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")){let t,a;switch(e){case"AccessDenied":t=o.W.Unable_To_Complete_Task,a=n.c.Failed_Command_Execution_Due_To_Protection_Settings;break;case"Timeout":t=o.W.Response_Delayed_Or_Timed_Out,a=n.c.Command_Execution_Took_Too_Long;break;default:t=o.W.Unclassified_Chat_Failure,a=n.c.Failed_Command_Execution_Due_To_Other_Error}C.M.getInstance().logStandardizedAshaErrorEvent(t,a,u.BJ.Commanding)}}logExecutionSucceed(e){const t=(0,u.b6)();t[u.Dh.EventState]=u.DD.ExecutorSucceeded,t[u.Dh.TimeDurationInMs]=(0,u.xJ)(e),this.telemetryLogger.logEvent((0,u.gY)(t))}logNoEventsExecuted(){this.logNoEventExecutedError();const e=(0,u.b6)();e[u.Dh.EventState]=u.DD.ExecutorNoneExecuted,this.telemetryLogger.logEvent((0,u.gY)(e))}logExecutorFailure(e,t,a){const n=(0,u.b6)();n[u.Dh.EventState]=u.DD.ExecutorFailed,n[u.Dh.ExecutableAgent]=e.agent,n[u.Dh.TimeDurationInMs]=(0,u.xJ)(t),e.agent===s.w2.OfficeJS||e.agent===s.w2.OfficeScripts?n[u.Dh.ExecutableNames]=JSON.stringify(e.items.map((e=>e.method))):(0,H.yw)("OfficeVSO_9275720_addErrorMessageForExecutorFailureEventsV2")&&(n[u.Dh.ErrorMessage]=a),this.telemetryLogger.logEvent((0,u.gY)(n))}logNoEventExecutedError(){const e={eventType:f.S.NoEventExecuted,errorMessage:"",logLevel:u.$b.Warning},t=[{key:u.xL.ErrorMessage,value:"No event has been executed."}];this.telemetryLogger.logError(e,void 0,t)}logJsApiExecutorError(e,t){const a=JSON.stringify(e),n={eventType:f.S.Executor,errorMessage:a,logLevel:u.$b.ASHA},o=[{key:u.LP.FailedEventMethods,value:JSON.stringify([t])},{key:u.LP.Agent,value:s.w2.OfficeJS},{key:u.xL.ErrorMessage,value:"Something went wrong while executing JS API events."}];this.telemetryLogger.logError(n,void 0,o)}logOfficeScriptExecutorError(e,t){const a={eventType:f.S.Executor,errorMessage:e.message,logLevel:u.$b.ASHA},n=[{key:u.LP.FailedEventMethods,value:JSON.stringify(t.map((e=>e.method)))},{key:u.LP.Agent,value:s.w2.OfficeScripts},{key:u.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(a,void 0,n)}addCommandingSuccessMessage(e,t,a){l.Z.getInstance().setShowUndoButton(!0),(0,H.k6)()&&(0,H.yw)("OfficeVSO_9008332_FixHiTLUndoState")||e(T.mF.setDoesFluxTurnRequireUndo());const n=(0,H.yw)("NewEntityResolution")?this.getMessageSuffix(a):this.getMessageSuffixDeprecated(a),o=t.map((e=>({text:e}))),{message:r,telemetry:s}=N.n.getCommandingSuccessResponse(n,o);i.$.getInstance().displayResponse(r,s,{shouldShowWhenFluxSkillResponseRequired:!1});const c=(0,z.r)(n,o),d=(0,_.N)(c);e(v.mF.sendSkillResponseToFlux(d,m.Aw.success,s)),e(v.mF.showSuggestionListWithPriorities([b.hC.Commanding_Suggestion]))}isExecutingMultipleEvents(){let e=0;return this.events.forEach((t=>{t.agent!==s.w2.OfficeJS&&t.agent!==s.w2.OfficeScripts||(e+=t.items.length)})),e>1}hasOnlyUnsupportedEvents(){let e=!0;return this.events.forEach((t=>{t.agent!==s.w2.UnsupportedEvent&&(e=!1)})),e}getMessageSuffixDeprecated(e){let t;const a=p.g.instance();return a.getIsFirstColumnEntityResolved()&&!a.getHasShownFirstColumnHint()?(a.setHasShownFirstColumnHint(!0),t=e?(0,r.VCG)():(0,r.dq1)()):t=e?(0,r.VCG)():void 0,t}getMessageSuffix(e){let t;const a=p.g.instance().getHiddenColumnSuffixMessageAndReset();return t=a||(e?(0,r.VCG)():void 0),t}constructor(e){this.showCommandingHumanInTheLoop=async(e,t,a,n,o,l)=>{if(0===t.length)return!1;let c,g=[],h=[];for(const e of t)if((0,H.yw)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS")&&e.agent===s.w2.OfficeJS){const t=e.items;h=h.concat((0,w.C2)(t)??[])}else{const t=e.items,{cfIntents:a,nonCfIntents:n}=(0,w.NU)(t);g=g.concat(a??[]),h=h.concat(n??[])}const p=S.CP.getActiveTable(),b=p?p.address:"";S.CP.setHumanInTheLoopRange((0,Q.r)(b)),c=g.length>0?N.n.getCommandingCFHumanInTheLoopResponse(g,h,(()=>this.applyCommandingProgram(e,t,a,(e=>n(e)),o,l))):(0,H.yw)("OfficeVSO_8976811_BoldRangeHiTLCard")?N.n.getCommandingHumanInTheLoopResponse(h,(()=>this.applyCommandingProgram(e,t,a,(e=>n(e)),o,l))):N.n.getCommandingHumanInTheLoopResponseDeprecated(h,(()=>this.applyCommandingProgram(e,t,a,(e=>n(e)),o,l))),i.$.getInstance().displayResponse(c.message,c.telemetry,{shouldShowWhenFluxSkillResponseRequired:!0});const f=JSON.stringify({text:r.qbK.HumanInTheLoop.CardShown,publishPreference:d.f.Never});return this.telemetryLogger.endTriedActivitySuccess(u.q.Commanding),a(v.mF.sendSkillResponseToFlux(f,m.Aw.success,c.telemetry)),!0},this.runtimeHelper=g.b.instance(),this.telemetryLogger=C.M.getInstance(),this.events=e}}},31030:(e,t,a)=>{var n;a.d(t,{S:()=>n}),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.Converter="Converter",e.Executor="Executor",e.NoEventGenerated="NoEventGenerated",e.NoEventExecuted="NoEventExecuted",e.StatementArgumentError="StatementArgumentError",e.ConverterError="ConverterError",e.AnalyzeDataDuration="AnalyzeDataDuration",e.AnalyzeDataError="AnalyzeDataError",e.AnalyzeDataEvents="AnalyzeDataEvents",e.SuggestionEvents="SuggestionEvents",e.ContextManager="ContextManager",e.CitationFileUtils="CitationFileUtils",e.ImportData="ImportData",e.Usage="Usage",e.TabularRange="TabularRange",e.AuthError="AuthError",e.Undo="Undo",e.FormulaGeneration="FormulaGeneration",e.UncaughtException="UncaughtException",e.PythonDuration="PythonDuration",e.PythonEvents="PythonEvents",e.PythonError="PythonError",e.OfficeScriptSkillHandler="OfficeScriptSkillHandler",e.OfficeScriptsContextManager="OfficeScriptsContextManager",e.OfficeScriptsRename="OfficeScriptsRename",e.Localization="Localization",e.FetchCitationMetadata="FetchCitationMetadata",e.FetchTablesRelevancy="FetchTablesRelevancy",e.GetResolvedCitations="GetResolvedCitations",e.StreamHandler="StreamHandler",e.RefreshRibbonGallery="RefreshRibbonGallery",e.MakerStorageEvent="MakerStorageEvent",e.SpecialRefApiUpdated="SpecialRefApiUpdated",e.UserContextAnnotation="UserContextAnnotation",e.AssertionFailed="AssertionFailed",e.AuthSuccess="AuthSuccess",e.AutoFixTLR="AutoFixTLR",e.ImageChat="ImageChat",e.FormatMetadataFallback="FormatMetadataFallback",e.AugloopDiagnostics="AugloopDiagnostics",e.DataShaping="DataShaping"}(n||(n={}))},22650:(e,t,a)=>{a.d(t,{NU:()=>Fl,yC:()=>Sl,C2:()=>Ll});var n=a(51319),o=a(89099),r=a(24220),i=a(49134),l=a(94303),s=a(8338),c=a(48314),d=a(88179),u=a(23147),m=a(50347),g=a(7024),h=a(83197),p=a(21792),b=a(96710),f=a(92779),C=a(98453),y=a(58428),v=a(48825),T=a(89337),x=a(78686),S=a(96699),w=a(19313),E=a(96756);const R=(0,m.yw)("OfficeVSO_8999367_UseSeparateStringsForNumberValuesHiTL"),I=(0,m.yw)("OfficeVSO_8884962_useColorNameForHumanInTheLoop"),A={substitute:E.A};function L(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeCellTextOrientationChangedLabel,{orientation:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameCellTextOrientationChanged,{columnName:e.parameters.columnName,orientation:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.CellTextOrientationChanged,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),orientation:e.parameters.value})}function F(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetAddedWithNameLabel,{worksheetName:e.parameters})}function _(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetRenameLabel,{worksheetName:e.parameters})}function N(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDeleteMultipleLabel,{count:e.parameters.events.length})}function k(e){const t=e.parameters.values;if(1===t.length&&1===t[0].length){const a=R&&!isNaN(t[0][0])?ExcelCopilotCommandingHitlStrings.RangeEditValueNumberLabel:ExcelCopilotCommandingHitlStrings.RangeEditValueStringLabel;return A.substitute(a,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${t[0][0]}`})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangeEditLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function O(e){const t=R&&!isNaN(e.parameters.value)?ExcelCopilotCommandingHitlStrings.RangeEditValueNumberLabel:ExcelCopilotCommandingHitlStrings.RangeEditValueStringLabel;return A.substitute(t,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${e.parameters.value}`})}function P(e){return e.parameters.command===w.default.ClearCellsFormat?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearFormatLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearFormatLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function M(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeDeleteLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeDeleteLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function D(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeInsertedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeInsertLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeMergeLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeMergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function B(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnmergeLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnmergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function H(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeColumnsAutofitLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeColumnsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function U(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRowsAutofitLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeRowsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function q(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUseStandardHeightLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUseStandardHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function V(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUseStandardWidthLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUseStandardWidthLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function G(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function W(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeRemoveHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function z(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeNumberFormatLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!0),columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!0),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Q(e){return 0===e.parameters.copyCutOperation?A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCopyLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)}):A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCutLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)})}function J(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.target)})}function j(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableCreateLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Y(e){return(0,m.yw)("OfficeVSO_8900971_HumanInTheLoopAddColumnNameToInsertColumn")&&void 0!==e.parameters.columnNames?1===e.parameters.count?A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertColumnsLabelWithColumnName,{columnNumber:e.parameters.index+1,columnName:e.parameters.columnNames,tableName:e.parameters.name}):s.O.MissingIntent:A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function X(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRemoveColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function K(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Z(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRemoveRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function ee(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableSortColumnLabel,{columnNumber:e.parameters.columnIndex,tableName:e.parameters.tableName})}function te(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableClearFiltersLabel,{tableName:e.entityId})}function ae(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnClearFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ne(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableReapplyFilterLabel,{tableName:e.parameters.tableName})}function oe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableFilterColumnLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName,values:e.parameters.values.join(", ")})}function re(e){switch(e.parameters.value1.valueCompareType){case S.default.Equals:{const t=R&&!isNaN(e.parameters.value1.value)?ExcelCopilotCommandingHitlStrings.TableColumnEqualsNumberFilterLabel:ExcelCopilotCommandingHitlStrings.TableColumnEqualsFilterLabel;return A.substitute(t,{columnName:e.parameters.columnName,value1:e.parameters.value1.value})}case S.default.DoesNotEqual:{const t=R&&!isNaN(e.parameters.value1.value)?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualNumberFilterLabel:ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualFilterLabel;return A.substitute(t,{columnName:e.parameters.columnName,value1:e.parameters.value1.value})}case S.default.BeginsWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotBeginWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.EndsWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEndWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.Contains:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotContain:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThan:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThenOrEqualTo:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsLessThanOrEqualTo?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThen:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsGreaterThan?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnNotBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThanOrEqualTo:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});default:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnCustomFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}}function ie(e){if((0,m.yw)("OfficeVSO_8777053_AddColumnNameToTableSortResponse")){if(e.parameters.sharedSortConditions[0].columnName)return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnByNameCustomSortLabel,{tableName:e.parameters.tableName,columnName:e.parameters.sharedSortConditions[0].columnName});if(e.parameters.sharedSortConditions[0].columnIndex>=0)return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{tableName:e.parameters.tableName,columnIndex:e.parameters.sharedSortConditions[0].columnIndex})}throw new l.sF("Unhandled intent case in Table.CustomSorted",l.UP.MissingIntent)}function le(e){return A.substitute((0,f.S0l)(),{tableName:e.entityId})}function se(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnTopFilterLabel,{direction:e.parameters.top?"top":"bottom",count:e.parameters.count,columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ce(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDynamicFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function de(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatBoldLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatBoldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnboldLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnboldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnboldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ue(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatBoldLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnboldLabel}function me(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatSuperscriptLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveSuperscriptLabel}function ge(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatSubscriptLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveSubscriptLabel}function he(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatItalicLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatItalicLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatItalicLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnitalicizeLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnitalicizeLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnitalicizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function pe(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSetFontColorLabel,{color:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value});if((0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName){const t=(0,m.yw)("OfficeVSO_9425205_FixSetColumnFontColor")?ExcelCopilotCommandingHitlStrings.ColumnNameFormatSetFontColorLabel:ExcelCopilotCommandingHitlStrings.ColumnFormatSetFontColorLabel;return A.substitute(t,{columnName:e.parameters.columnName,color:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSetFontColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function be(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeFormatSetFontColorLabel,{color:I?p.g.colorNameFromHEX(e.parameters.events[0].parameters.value):e.parameters.events[0].parameters.value})}function fe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSetFontLabel,{fontName:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameFormatSetFontLabel,{columnName:e.parameters.columnName,fontName:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSetFontLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontName:e.parameters.value})}function Ce(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeFormatSetFontLabel,{fontName:e.parameters.events[0].parameters.value})}function ye(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ve(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatDoubleUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatDoubleUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveDoubleUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Te(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatStrikethroughLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatStrikethroughLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveStrikethroughLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveStrikethroughLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function xe(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSuperscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatSuperscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveSuperscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveSuperscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Se(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSubscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatSubscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveSubscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveSubscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function we(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetFontSizeLabel,{fontSize:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetFontSizeLabel,{columnName:e.parameters.columnName,fontSize:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetFontSizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontSize:e.parameters.value})}function Ee(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetFontSizeLabel,{fontSize:e.parameters.events[0].parameters.value})}function Re(e){if("none"===e.parameters.value)return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRemoveFontUnderlineStyleLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameRemoveFontUnderlineStyleLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RemoveFontUnderlineStyleLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)});let t="";const a=(0,m.yw)("OfficeVSO_9413070_FixHiTLUnderlineStringLocalization");if(a)switch(e.parameters.value){case"single":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleSingleLabel;break;case"double":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleDoubleLabel;break;case"singleAccountant":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleSingleAccountantLabel;break;case"doubleAccountant":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleDoubleAccountantLabel;break;default:throw new l.sF("Unhandled underline style in Font.UnderlineStyle",l.UP.MissingIntent)}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?a?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeApplyFontUnderlineStyleLabel,{style:t}):En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase()}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?a?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameApplyFontUnderlineStyleLabel,{style:t,columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),columnName:e.parameters.columnName}):a?A.substitute(ExcelCopilotCommandingHitlStrings.ApplyFontUnderlineStyleLabel,{style:t,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.FontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ie(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetBackgroundColorLabel,{color:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetBackgroundColorLabel,{columnName:e.parameters.columnName,color:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function Ae(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearBackgroundColorLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?(0,m.yw)("OfficeVSO_9374824_FixClearFormatIntentString")?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameClearBackgroundColorLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Le(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetBackgroundColorLabel,{color:I?p.g.colorNameFromHEX(e.parameters.events[0].parameters.value):e.parameters.events[0].parameters.value})}function Fe(e){const t=(0,m.yw)("OfficeVSO_9476774_fixAdjustingRowHeightAndColumnWidth")?(e.parameters.value/C.bN).toFixed(2):e.parameters.value/C.bN;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetCellWidthLabel,{size:t}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetCellWidthLabel,{size:t,columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetCellWidthLabel,{size:t,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function _e(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetCellWidthLabel,{size:e.parameters.events[0].parameters.value})}function Ne(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetCellHeightLabel,{size:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetCellHeightLabel,{columnName:e.parameters.columnName,size:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetCellHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),size:e.parameters.value})}function ke(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetCellHeightLabel,{size:e.parameters.events[0].parameters.value})}function Oe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeApplyBorderLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameApplyBorderLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeApplyBorderLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Pe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewDeleteLabel,{deletedNum:e.parameters.namedSheetViewNames.length})}function Me(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewDuplicateLabel,{sheetViewName:e.parameters.namedSheetViewName})}function De(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewExitAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewKeepName}):ExcelCopilotCommandingHitlStrings.NamedSheetViewExitLabel}function $e(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewKeepLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Be(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewRenameLabel,{newSheetViewName:e.parameters.newNamedSheetViewName})}function He(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewSwitchAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewName,sheetViewKeepName:e.parameters.namedSheetViewKeepName}):A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewSwitchLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Ue(e){if(e.parameters.destinationRange.rangeType===i.RangeType.TableRange){let t;switch(e.parameters.destinationRange.range.subRange){case i.TableRangeOperationSubRange.WholeTable:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableRangeLabel;break;case i.TableRangeOperationSubRange.Body:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableBodyRangeLabel;break;case i.TableRangeOperationSubRange.HeaderRow:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableHeaderRowRangeLabel;break;case i.TableRangeOperationSubRange.TotalRow:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableTotalRowRangeLabel;break;case i.TableRangeOperationSubRange.General:if((0,m.yw)("OfficeVSO_8900963_HumanInTheLoopRemoveSubRange"))return s.O.MissingIntent;t=ExcelCopilotCommandingHitlStrings.RangePasteInTableGeneralRangeLabel;break;case i.TableRangeOperationSubRange.Rows:case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableRangeLabel}return A.substitute(t,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),tableName:e.entityId})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),destinationRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).range)})}function qe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.events[0].parameters.sourceRange).range)})}function Ve(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ge(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDuplicateLabel,{sheet:e.entityId})}function We(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetReapplyFiltersLabel,{sheet:e.entityId})}function ze(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetClearFiltersLabel,{sheet:e.entityId})}function Qe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.CellFindContainingLabel,{search:e.parameters.searchString})}function Je(e){const t=i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range,a=i.ExcelCalc.IExcelRangeToAddress(t);if((0,m.yw)("OfficeVSO_9033826_SearchReplaceEmptyCellStrings")&&""===e.parameters.searchString){const n=t.topLeft.row===t.bottomRight.row&&t.topLeft.column===t.bottomRight.column?ExcelCopilotCommandingHitlStrings.ReplaceEmptyCellLabel:ExcelCopilotCommandingHitlStrings.ReplaceAllEmptyCellsLabel;return A.substitute(n,{replace:e.parameters.replaceWith,range:a})}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith}):A.substitute(ExcelCopilotCommandingHitlStrings.ReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith,range:a})}function je(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ReplaceAllLabelGeneric,{search:e.parameters.events[0].parameters.searchString,replace:e.parameters.events[0].parameters.replaceWith})}function Ye(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetHorizontalAlignmentLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetHorizontalAlignmentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetHorizontalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Xe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetVerticalAlignmentLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetVerticalAlignmentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetVerticalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ke(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeWrapTextLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameWrapTextLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeWrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnwrapTextLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnwrapTextLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnwrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ze(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeChangeIndentLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameChangeIndentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeChangeIndentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function et(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetReorderLabel,{sheet:e.entityId})}function tt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableToggleAutoFilterLabel,{tableName:e.entityId})}function at(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetToggleAutoFilterLabel,{sheet:e.entityId})}function nt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SlicerInsertedLabel,{pivotTable:e.parameters.pivotTable,pivotName:e.parameters.pivotFieldName})}function ot(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General){const t=e.parameters.range;if(t.subRange===i.TableRangeOperationSubRange.WholeTable)return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetTableRangeCreateChartLabel,{sheet:e.entityId,table:t.tableName})}return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCreateChartLabel,{sheet:e.entityId})}function rt(e){return`#${i.ExcelCalc.toHexColor(e)}`}function it(e,t,a){const n=a?a(e.parameters.newValue):`${e.parameters.newValue}`;return e.parameters.category===i.ChartObjectCategory.ChartAxis?A.substitute(t,{newValue:n,axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?A.substitute(t,{newValue:n,seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):A.substitute(t,{newValue:n,chartName:e.parameters.chartName})}function lt(e,t){return e.parameters.category===i.ChartObjectCategory.ChartAxis?A.substitute(t,{axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?A.substitute(t,{seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):A.substitute(t,{chartName:e.parameters.chartName})}function st(e){return e.parameters.added?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSerriesTrendlineAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSerriesTrendlineRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function ct(e){return e.parameters.added?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTitleAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTitleRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function dt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCreateChartLabel,{sheet:e.entityId})}function ut(e){return e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShowHeadingsLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetHideHeadingsLabel,{sheet:e.entityId})}function mt(e){return e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShowGridlinesLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetHideGridlinesLabel,{sheet:e.entityId})}function gt(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRemoveDuplicatesLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeRemoveDuplicatesLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ht(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddTotalRowLabel:ExcelCopilotCommandingHitlStrings.TableRemoveTotalRowLabel;return A.substitute(t,{tableName:e.entityId})}function pt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddHeaderRowLabel:ExcelCopilotCommandingHitlStrings.TableRemoveHeaderRowLabel;return A.substitute(t,{tableName:e.entityId})}function bt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableResizeLabel,{tableName:e.entityId})}function ft(e){return e.parameters.isCreation?A.substitute(ExcelCopilotCommandingHitlStrings.TableCreateAndFormatLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.TableFormatLabel,{tableName:e.entityId})}function Ct(e){return""===e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetClearTabColorLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetSetTabColorLabel,{color:I?p.g.colorNameFromHEX(e.parameters):e.parameters,sheet:e.entityId})}function yt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartSwitchRowColumnLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function vt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartSelectDataLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Tt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeTypeLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function xt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFlashFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function St(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function wt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Et(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Rt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideAxisTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function It(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeLegendLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function At(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartAxisTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Lt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCharTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ft(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideLegendLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function _t(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDataLabelChangePositionLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Nt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDataLabelChangeVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function kt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Ot(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Pt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableApplyStyleLabel,{tableName:e.entityId})}function Mt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddBandedRowsLabel:ExcelCopilotCommandingHitlStrings.TableRemoveBandedRowsLabel;return A.substitute(t,{tableName:e.entityId})}function Dt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddBandedColumnsLabel:ExcelCopilotCommandingHitlStrings.TableRemoveBandedColumnsLabel;return A.substitute(t,{tableName:e.entityId})}function $t(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableHighlightFirstColumnFilterLabel,{tableName:e.entityId})}function Bt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableHighlightLastColumnLabel,{tableName:e.entityId})}function Ht(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddFilterButtonLabel:ExcelCopilotCommandingHitlStrings.TableRemoveFilterButtonLabel;return A.substitute(t,{tableName:e.entityId})}function Ut(e){return e.parameters.rangeToFreeze?ExcelCopilotCommandingHitlStrings.WorksheetFreezePaneLabel:ExcelCopilotCommandingHitlStrings.WorksheetUnFreezePaneLabel}function qt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeInsertedLabel,{sheet:e.entityId})}function Vt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeSetStyleLabel,{sheet:e.entityId})}function Gt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Wt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartSeriesDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId,seriesIndex:e.parameters.seriesIndex})}function zt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartSeriesDataChangedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.seriesIndex})}function Qt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectDeleteLabel,{sheet:e.entityId})}function Jt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartMoveAndResizeLabel,{chartName:e.parameters.name,sheet:e.entityId})}function jt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectMoveAndResizeLabel,{sheet:e.entityId})}function Yt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectZOrderChangedLabel,{sheet:e.entityId})}function Xt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeRotateLabel,{sheet:e.entityId})}function Kt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeAltTextApplyLabel,{sheet:e.entityId})}function Zt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextChangedLabel,{sheet:e.entityId})}function ea(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextBoldedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnboldedLabel,{sheet:e.entityId})}function ta(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextItalicizedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnitalicizedLabel,{sheet:e.entityId})}function aa(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnderlinedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnderlineRemovedLabel,{sheet:e.entityId})}function na(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontNameChangedLabel,{sheet:e.entityId,fontName:e.parameters.value})}function oa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontSizeChangedLabel,{sheet:e.entityId,fontSize:e.parameters.value})}function ra(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontColorChangedLabel,{sheet:e.entityId,fontColor:I?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function ia(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextHorizontallyAlignedLabel,{sheet:e.entityId})}function la(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextVerticallyAlignedLabel,{sheet:e.entityId})}function sa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupLabel,{sheet:e.entityId})}function ca(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnGroupLabel,{sheet:e.entityId})}function da(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetOutlineLevelsSetLabel,{sheet:e.entityId})}function ua(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupDetailsShowLabel,{sheet:e.entityId})}function ma(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupDetailsHideLabel,{sheet:e.entityId})}function ga(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeDataValidationChangedGroupLabel,{sheet:e.entityId})}function ha(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRenameLabel,{tableName:e.parameters})}function pa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableConvertToRangeLabel,{tableName:e.entityId})}function ba(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextEditedLabel,{tableName:e.entityId})}function fa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextTitleEditedLabel,{tableName:e.entityId})}function Ca(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextDescriptionEditedLabel,{tableName:e.entityId})}function ya(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableChangeLabel,{pivotName:e.parameters.events[0].parameters.pivotName})}function va(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableAddPivot,{pivotName:e.parameters.pivotName})}function Ta(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRemovePivot,{pivotName:e.parameters.pivotName})}function xa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRefreshLabel,{pivotName:e.parameters})}function Sa(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotDrillExpandedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotDrillCollapsedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName})}function wa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRenamedLabel,{newName:e.parameters.value})}function Ea(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRowGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRowGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ra(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableColumnGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableColumnGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ia(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableLayoutTypeSetLabel,{pivotName:e.parameters.pivotName})}function Aa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetValuesFilterAppliedLabel,{range:i.ExcelCalc.columnFromIExcelAddress(e.parameters.range.range,e.parameters.column)})}function La(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCustomFilterAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Fa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDynamicFilterAppliedLabel,{range:i.ExcelCalc.ICellColumnSheetRangeToAddress({range:{topLeft:{column:e.parameters.column,row:null},bottomRight:{column:e.parameters.column,row:null}},sheet:""})})}function _a(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Na(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ArtPasteSameWorkbookLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).sheet})}function ka(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeAutoSumLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Oa(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeHideRowsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameHideRowsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeHideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnhideRowsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnhideRowsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnhideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Pa(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeHideColumnsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameHideColumnsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeHideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnhideColumnsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnhideColumnsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnhideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ma(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeHideRowsLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnhideRowsLabel}function Da(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeHideColumnsLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnhideColumnsLabel}function $a(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCreatedGroupEventLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ba(e){const t=e.parameters.customFormat,a=[];t.IsTextBold&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatBoldLabel),t.IsTextItalic&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatItalicizeLabel),t.IsTextUnderlined&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatUnderlineLabel),t.IsTextDoubleUnderlined&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDoubleUnderlineLabel);const n=I?p.g.colorNameFromHEX(t.BackgroundColor):t.BackgroundColor,o=I?p.g.colorNameFromHEX(t.TextColor):t.TextColor,r=t.IsTextStrikethrough,l=t.BorderFormat.LineStyle,s=t.BorderFormat.Color;if(null!=n){const e=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatFillColorLabel,{color:n});a.push(e)}if(null!=o){const e=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatFontColorLabel,{color:o});a.push(e)}if(r&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatStrikethroughLabel),l[0]!==i.BorderLineStyle.None){const e=(0,m.yw)("OfficeVSO_9031700_UseBGRForBorderFormat"),t=(0,h.Cn)(s[0]),n=e?t:s[0],o=I?p.g.colorNameFromHEX((0,h.S)(n)):(0,h.S)(n),r=A.substitute(y.$8[l[0]](),{color:o});a.push(r)}const c=[{key:d.Dh.EventType,value:d.Mv.LogSuccessMessageFormattingParameters},{key:d.Dh.SuccessMessageNumParameters,value:a.length},{key:d.Dh.SuccessMessageFormattingParameters,value:a.join(", ")}];return(0,T.j)(c),a}function Ha(e){return En(e,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingApplyFormattingCustomCreatedLabel,{})}function Ua(e,t){return(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameConditionalFormattingApplyFormattingCustomCreatedLabel,{columnName:e}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingApplyFormattingCustomCreatedLabel,{range:t})}function qa(e){const t=/"|=|DATEVALUE|\(|\)/g,a=e.parameters.rule,n=a.operator,o=a.formula1.replace(t,"");let r=y.X7[n](R&&!isNaN(o));const l=(0,m.yw)("OfficeVSO_9352581_CFCustomFormulaValue2BugFix");if(l||(r=A.substitute(r,{value1:o})),!a.formula2||n!==x.default.Between&&n!==x.default.NotBetween)l&&(r=A.substitute(r,{value1:o}));else{const e=a.formula2.replace(t,"");r=l?A.substitute(r,{value1:o,value2:e}):A.substitute(r,{value2:a.formula2})}const s=new b.J(b.D.CellValue),c=e.parameters.customFormat;c&&(s.customFormat=c);const d={title:r,explanation:"",conditionalFormatResponseCardData:s,subExplanations:Ba(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(d.explanation=Ha(e.parameters.range),d):(d.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),d)}function Va(e){const t=e.parameters.rule,a=t.formula,n=t.formulaExplanation,o=new b.J(b.D.CustomCreated);o.customFormula=a,o.formulaExplanation=n;const r=e.parameters.customFormat;r&&(o.customFormat=r);const l={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCustomFormulaPrefixLabel,explanation:"",subExplanations:Ba(e),conditionalFormatResponseCardData:o};return e.parameters.rangeType===i.RangeType.TableRange?(l.explanation=En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,{}),l):((0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?l.explanation=A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameConditionalFormattingCustomFormulaCreatedLabel,{columnName:e.parameters.columnName}):l.explanation=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCustomFormulaCreatedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),l)}function Ga(e){const t=e.parameters.rule,a=A.substitute(y.mY[t.operator](),{text:t.text}),n=new b.J(b.D.TextComparison),o=e.parameters.customFormat;o&&(n.customFormat=o);const r={title:a,explanation:"",conditionalFormatResponseCardData:n,subExplanations:Ba(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(r.explanation=Ha(e.parameters.range),r):(r.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),r)}function Wa(e){const t=new b.J(b.D.ColorScale),a=e.parameters.colorScaleFormat;a&&(t.originalHexColors=a);const n={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScalePrefixLabel,explanation:"",conditionalFormatResponseCardData:t};let o="",r="",l="";return a&&(o=I?p.g.colorNameFromHEX(a.minimumColor):a.minimumColor,r=I?p.g.colorNameFromHEX(a.midpointColor):a.midpointColor,l=I?p.g.colorNameFromHEX(a.maximumColor):a.maximumColor),e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(n.explanation=r?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,{color1:o,color2:r,color3:l}):En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,{color1:o,color2:l}),n):(n.explanation=r?A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,{color1:o,color2:r,color3:l,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,{color1:o,color2:l,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),n)}function za(e){const t=e.parameters.dataBarFormat;let a=!1,n="";t&&(a=t.isGradientFill,n=I?p.g.colorNameFromHEX(t.fillColor):t.fillColor);const o=new b.J(b.D.DataBar);t&&(o.dataBarFormat=t);const r={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingDataBarPrefixLabel,explanation:"",conditionalFormatResponseCardData:o};if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return a?(r.explanation=En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingGradientDataBarCustomCreatedLabel,{color:n}),r):(r.explanation=En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingSolidDataBarCustomCreatedLabel,{color:n}),r);const l=a?ExcelCopilotCommandingHitlStrings.ConditionalFormattingGradientDataBarCustomCreatedLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingSolidDataBarCustomCreatedLabel;return r.explanation=A.substitute(l,{color:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),r}function Qa(e){let t;t=e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSetCreatedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)});const a=e.parameters.style,n=new b.J(b.D.IconSet);return n.iconSetNumber=a,{title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSetPrefixLabel,explanation:t,conditionalFormatResponseCardData:n,subExplanations:[y.Is[a]()]}}function Ja(e){const t=e.parameters.rule,a=new b.J(b.D.Preset),n=e.parameters.customFormat;n&&(a.customFormat=n);const o={title:y.y6[t.criterion](),explanation:"",conditionalFormatResponseCardData:a,subExplanations:Ba(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Ha(e.parameters.range),o):(o.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function ja(e){const t=e.parameters.rule,a=new b.J(b.D.Dates),n=e.parameters.customFormat;n&&(a.customFormat=n);const o={title:y.sh[t.timePeriodType](),explanation:"",conditionalFormatResponseCardData:a,subExplanations:Ba(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Ha(e.parameters.range),o):(o.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Ya(e){const t=e.parameters.rule,a=new b.J(b.D.UniqueValue),n=e.parameters.customFormat;n&&(a.customFormat=n);const o={title:t.unique?ExcelCopilotCommandingHitlStrings.ConditionalFormattingUniquePrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingDuplicatePrefixLabel,explanation:"",conditionalFormatResponseCardData:a,subExplanations:Ba(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Ha(e.parameters.range),o):(o.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Xa(e){const t=e.parameters.rule,a=t.rank,n=y.qq[t.type](),o=A.substitute(n,{number:a}),r=new b.J(b.D.TopBottom),l=e.parameters.customFormat;l&&(r.customFormat=l);const s={title:o,explanation:"",conditionalFormatResponseCardData:r,subExplanations:Ba(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(s.explanation=Ha(e.parameters.range),s):(s.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),s)}function Ka(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingEditedGroupEventLabel,{sheet:e.entityId})}function Za(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingRuleDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.ranges[0]).range)})}function en(e){return s.O.NoIntentNeeded}function tn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingDeletedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function an(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeCellStyleAppliedLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameCellStyleAppliedLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeCellStyleAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function nn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PictureInsertedEventLabel,{sheet:e.entityId})}function on(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeCustomSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function rn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AutoFilterCustomSortLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).sheet})}function ln(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TextToColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range)})}function sn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeAddedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function cn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeDeletedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function dn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeEditedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function un(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionOptionsUpdatedLabel,{sheet:e.entityId})}function mn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionPasswordUpdatedLabel,{sheet:e.entityId})}function gn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionPausedLabel,{sheet:e.entityId})}function hn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionProtectedLabel,{sheet:e.entityId})}function pn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionResumedLabel,{sheet:e.entityId})}function bn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionUnprotectedLabel,{sheet:e.entityId})}function fn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationListRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),source:e.parameters.source})}function Cn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationCustomRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),formula:e.parameters.formula})}function yn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"date",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"date",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function vn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"decimal",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"decimal",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function Tn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"text length",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"text length",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function xn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"time",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"time",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function Sn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"whole number",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"whole number",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function wn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationClearRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function En(e,t,a,n,o,r,l,c,d,u,g,h){let p;switch(h.tableName=e.tableName,e.subRange){case i.TableRangeOperationSubRange.WholeTable:p=t;break;case i.TableRangeOperationSubRange.Body:p=a;break;case i.TableRangeOperationSubRange.HeaderRow:p=n;break;case i.TableRangeOperationSubRange.TotalRow:p=o;break;case i.TableRangeOperationSubRange.General:if((0,m.yw)("OfficeVSO_8900963_HumanInTheLoopRemoveSubRange"))return s.O.MissingIntent;p=r;break;case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:{p=d;const t=e.subRangeValues;if(t.columnNames)1===t.columnNames.length?(p=u,h.columnName=t.columnNames[0]):h.count=t.columnNames.length;else{const t=e.subRangeValues;1===t.count?(p=g,h.columnIndex=t.firstIndex):h.count=t.count}break}case i.TableRangeOperationSubRange.Rows:{const t=e.subRangeValues;1===t.count?(p=c,h.rowIndex=t.firstIndex):(p=l,h.count=t.count);break}}return A.substitute(p,h)}var Rn=a(31137);const In=(0,m.yw)("OfficeVSO_8999367_UseSeparateStringsForNumberValuesHiTL"),An={...Rn,substitute:E.A};function Ln(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeCellTextOrientationChangedLabel,An.Intents.TableBodyRangeCellTextOrientationChangedLabel,An.Intents.TableHeaderRowRangeCellTextOrientationChangedLabel,An.Intents.TableTotalRowRangeCellTextOrientationChangedLabel,An.Intents.TableGeneralRangeCellTextOrientationChangedLabel,An.Intents.TableRowsRangeCellTextOrientationChangedLabel,An.Intents.TableRowByIndexRangeCellTextOrientationChangedLabel,An.Intents.TableColumnsRangeCellTextOrientationChangedLabel,An.Intents.TableColumnByNameRangeCellTextOrientationChangedLabel,An.Intents.TableColumnByIndexRangeCellTextOrientationChangedLabel,{orientation:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameCellTextOrientationChanged,{columnName:e.parameters.columnName,orientation:e.parameters.value}):An.substitute(An.Intents.CellTextOrientationChanged,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),orientation:e.parameters.value})}function Fn(e){return An.substitute(An.Intents.WorksheetAddedWithNameLabel,{worksheetName:e.parameters})}function _n(e){return An.substitute(An.Intents.WorksheetRenameLabel,{worksheetName:e.parameters})}function Nn(e){return An.substitute(An.Intents.WorksheetDeleteMultipleLabel,{count:e.parameters.events.length})}function kn(e){const t=e.parameters.values;return 1===t.length&&1===t[0].length?An.substitute(An.Intents.RangeEditValueStringLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${t[0][0]}`}):An.substitute(An.Intents.RangeEditLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function On(e){const t=In&&!isNaN(e.parameters.value)?An.Intents.RangeEditValueNumberLabel:An.Intents.RangeEditValueStringLabel;return An.substitute(t,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${e.parameters.value}`})}function Pn(e){return e.parameters.command===w.default.ClearCellsFormat?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeClearFormatLabel,An.Intents.TableBodyRangeClearFormatLabel,An.Intents.TableHeaderRowRangeClearFormatLabel,An.Intents.TableTotalRowRangeClearFormatLabel,An.Intents.TableGeneralRangeClearFormatLabel,An.Intents.TableRowsRangeClearFormatLabel,An.Intents.TableRowByIndexRangeClearFormatLabel,An.Intents.TableColumnsRangeClearFormatLabel,An.Intents.TableColumnByNameRangeClearFormatLabel,An.Intents.TableColumnByIndexRangeClearFormatLabel,{}):An.substitute(An.Intents.RangeClearFormatLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeClearLabel,An.Intents.TableBodyRangeClearLabel,An.Intents.TableHeaderRowRangeClearLabel,An.Intents.TableTotalRowRangeClearLabel,An.Intents.TableGeneralRangeClearLabel,An.Intents.TableRowsRangeClearLabel,An.Intents.TableRowByIndexRangeClearLabel,An.Intents.TableColumnsRangeClearLabel,An.Intents.TableColumnByNameRangeClearLabel,An.Intents.TableColumnByIndexRangeClearLabel,{}):An.substitute(An.Intents.RangeClearLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Mn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeDeleteLabel,An.Intents.TableBodyRangeDeleteLabel,An.Intents.TableHeaderRowRangeDeleteLabel,An.Intents.TableTotalRowRangeDeleteLabel,An.Intents.TableGeneralRangeDeleteLabel,An.Intents.TableRowsRangeDeleteLabel,An.Intents.TableRowByIndexRangeDeleteLabel,An.Intents.TableColumnsRangeDeleteLabel,An.Intents.TableColumnByNameRangeDeleteLabel,An.Intents.TableColumnByIndexRangeDeleteLabel,{}):An.substitute(An.Intents.RangeDeleteLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Dn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeInsertedLabel,An.Intents.TableBodyRangeInsertedLabel,An.Intents.TableHeaderRowRangeInsertedLabel,An.Intents.TableTotalRowRangeInsertedLabel,An.Intents.TableGeneralRangeInsertedLabel,An.Intents.TableRowsRangeInsertedLabel,An.Intents.TableRowByIndexRangeInsertedLabel,An.Intents.TableColumnsRangeInsertedLabel,An.Intents.TableColumnByNameRangeInsertedLabel,An.Intents.TableColumnByIndexRangeInsertedLabel,{}):An.substitute(An.Intents.RangeInsertLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $n(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeMergeLabel,An.Intents.TableBodyRangeMergeLabel,An.Intents.TableHeaderRowRangeMergeLabel,An.Intents.TableTotalRowRangeMergeLabel,An.Intents.TableGeneralRangeMergeLabel,An.Intents.TableRowsRangeMergeLabel,An.Intents.TableRowByIndexRangeMergeLabel,An.Intents.TableColumnsRangeMergeLabel,An.Intents.TableColumnByNameRangeMergeLabel,An.Intents.TableColumnByIndexRangeMergeLabel,{}):An.substitute(An.Intents.RangeMergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Bn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnmergeLabel,An.Intents.TableBodyRangeUnmergeLabel,An.Intents.TableHeaderRowRangeUnmergeLabel,An.Intents.TableTotalRowRangeUnmergeLabel,An.Intents.TableGeneralRangeUnmergeLabel,An.Intents.TableRowsRangeUnmergeLabel,An.Intents.TableRowByIndexRangeUnmergeLabel,An.Intents.TableColumnsRangeUnmergeLabel,An.Intents.TableColumnByNameRangeUnmergeLabel,An.Intents.TableColumnByIndexRangeUnmergeLabel,{}):An.substitute(An.Intents.RangeUnmergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Hn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeColumnsAutofitLabel,An.Intents.TableBodyRangeColumnsAutofitLabel,An.Intents.TableHeaderRowRangeColumnsAutofitLabel,An.Intents.TableTotalRowRangeColumnsAutofitLabel,An.Intents.TableGeneralRangeColumnsAutofitLabel,An.Intents.TableRowsRangeColumnsAutofitLabel,An.Intents.TableRowByIndexRangeColumnsAutofitLabel,An.Intents.TableColumnsRangeColumnsAutofitLabel,An.Intents.TableColumnByNameRangeColumnsAutofitLabel,An.Intents.TableColumnByIndexRangeColumnsAutofitLabel,{}):An.substitute(An.Intents.RangeColumnsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Un(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeRowsAutofitLabel,An.Intents.TableBodyRangeRowsAutofitLabel,An.Intents.TableHeaderRowRangeRowsAutofitLabel,An.Intents.TableTotalRowRangeRowsAutofitLabel,An.Intents.TableGeneralRangeRowsAutofitLabel,An.Intents.TableRowsRangeRowsAutofitLabel,An.Intents.TableRowByIndexRangeRowsAutofitLabel,An.Intents.TableColumnsRangeRowsAutofitLabel,An.Intents.TableColumnByNameRangeRowsAutofitLabel,An.Intents.TableColumnByIndexRangeRowsAutofitLabel,{}):An.substitute(An.Intents.RangeRowsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function qn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUseStandardHeightLabel,An.Intents.TableBodyRangeUseStandardHeightLabel,An.Intents.TableHeaderRowRangeUseStandardHeightLabel,An.Intents.TableTotalRowRangeUseStandardHeightLabel,An.Intents.TableGeneralRangeUseStandardHeightLabel,An.Intents.TableRowsRangeUseStandardHeightLabel,An.Intents.TableRowByIndexRangeUseStandardHeightLabel,An.Intents.TableColumnsRangeUseStandardHeightLabel,An.Intents.TableColumnByNameRangeUseStandardHeightLabel,An.Intents.TableColumnByIndexRangeUseStandardHeightLabel,{}):An.substitute(An.Intents.RangeUseStandardHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Vn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUseStandardWidthLabel,An.Intents.TableBodyRangeUseStandardWidthLabel,An.Intents.TableHeaderRowRangeUseStandardWidthLabel,An.Intents.TableTotalRowRangeUseStandardWidthLabel,An.Intents.TableGeneralRangeUseStandardWidthLabel,An.Intents.TableRowsRangeUseStandardWidthLabel,An.Intents.TableRowByIndexRangeUseStandardWidthLabel,An.Intents.TableColumnsRangeUseStandardWidthLabel,An.Intents.TableColumnByNameRangeUseStandardWidthLabel,An.Intents.TableColumnByIndexRangeUseStandardWidthLabel,{}):An.substitute(An.Intents.RangeUseStandardWidthLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Gn(e){return An.substitute(An.Intents.RangeHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wn(e){return An.substitute(An.Intents.RangeRemoveHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function zn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeNumberFormatLabel,An.Intents.TableBodyRangeNumberFormatLabel,An.Intents.TableHeaderRowRangeNumberFormatLabel,An.Intents.TableTotalRowRangeNumberFormatLabel,An.Intents.TableGeneralRangeNumberFormatLabel,An.Intents.TableRowsRangeNumberFormatLabel,An.Intents.TableRowByIndexRangeNumberFormatLabel,An.Intents.TableColumnsRangeNumberFormatLabel,An.Intents.TableColumnByNameRangeNumberFormatLabel,An.Intents.TableColumnByIndexRangeNumberFormatLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!1),columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!1),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Qn(e){return 0===e.parameters.copyCutOperation?An.substitute(An.Intents.RangePasteCopyLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)}):An.substitute(An.Intents.RangePasteCutLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)})}function Jn(e){return An.substitute(An.Intents.RangeFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.target)})}function jn(e){return An.substitute(An.Intents.TableCreateLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yn(e){return An.substitute(An.Intents.TableInsertColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Xn(e){return An.substitute(An.Intents.TableRemoveColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Kn(e){return An.substitute(An.Intents.TableInsertRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Zn(e){return An.substitute(An.Intents.TableRemoveRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function eo(e){return An.substitute(An.Intents.TableSortColumnLabel,{columnNumber:e.parameters.columnIndex,tableName:e.parameters.tableName})}function to(e){return An.substitute(An.Intents.TableClearFiltersLabel,{tableName:e.entityId})}function ao(e){return An.substitute(An.Intents.TableColumnClearFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function no(e){return An.substitute(An.Intents.TableReapplyFilterLabel,{tableName:e.parameters.tableName})}function oo(e){return An.substitute(An.Intents.TableFilterColumnLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName,values:e.parameters.values.join(", ")})}function ro(e){switch(e.parameters.value1.valueCompareType){case S.default.Equals:return An.substitute(An.Intents.TableColumnEqualsFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEqual:return An.substitute(An.Intents.TableColumnDoesNotEqualFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.BeginsWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnBeginsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnBeginsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotBeginWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnDoesNotBeginWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnDoesNotBeginWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.EndsWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnEndsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnEndsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEndWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnDoesNotEndWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnDoesNotEndWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.Contains:return e.parameters.value2?An.substitute(An.Intents.TableColumnContainsFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnContainsFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotContain:return e.parameters.value2?An.substitute(An.Intents.TableColumnDoesNotContainFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnDoesNotContainFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThan:return An.substitute(An.Intents.TableColumnIsGreaterThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThenOrEqualTo:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsLessThanOrEqualTo?An.substitute(An.Intents.TableColumnBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnIsGreaterThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThen:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsGreaterThan?An.substitute(An.Intents.TableColumnNotBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnIsLessThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThanOrEqualTo:return An.substitute(An.Intents.TableColumnIsLessThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});default:return An.substitute(An.Intents.TableColumnCustomFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}}function io(e){if((0,m.yw)("OfficeVSO_8777053_AddColumnNameToTableSortResponse")){if(e.parameters.sharedSortConditions[0].columnName)return An.substitute(An.Intents.TableColumnByNameCustomSortLabel,{tableName:e.parameters.tableName,columnName:e.parameters.sharedSortConditions[0].columnName});if(e.parameters.sharedSortConditions[0].columnIndex)return An.substitute(An.Intents.TableColumnByIndexCustomSortLabel,{tableName:e.parameters.tableName,columnIndex:e.parameters.sharedSortConditions[0].columnIndex})}return An.substitute(An.Intents.TableCustomSortLabel,{tableName:e.parameters.tableName})}function lo(e){return An.substitute(An.Intents.TableClearSortLabel,{tableName:e.entityId})}function so(e){return An.substitute(An.Intents.TableColumnTopFilterLabel,{direction:e.parameters.top?"top":"bottom",count:e.parameters.count,columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function co(e){return An.substitute(An.Intents.TableColumnDynamicFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function uo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatBoldLabel,An.Intents.TableBodyRangeFormatBoldLabel,An.Intents.TableHeaderRowRangeFormatBoldLabel,An.Intents.TableTotalRowRangeFormatBoldLabel,An.Intents.TableGeneralRangeFormatBoldLabel,An.Intents.TableRowsRangeFormatBoldLabel,An.Intents.TableRowByIndexRangeFormatBoldLabel,An.Intents.TableColumnsRangeFormatBoldLabel,An.Intents.TableColumnByNameRangeFormatBoldLabel,An.Intents.TableColumnByIndexRangeFormatBoldLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatBoldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnboldLabel,An.Intents.TableBodyRangeFormatUnboldLabel,An.Intents.TableHeaderRowRangeFormatUnboldLabel,An.Intents.TableTotalRowRangeFormatUnboldLabel,An.Intents.TableGeneralRangeFormatUnboldLabel,An.Intents.TableRowsRangeFormatUnboldLabel,An.Intents.TableRowByIndexRangeFormatUnboldLabel,An.Intents.TableColumnsRangeFormatUnboldLabel,An.Intents.TableColumnByNameRangeFormatUnboldLabel,An.Intents.TableColumnByIndexRangeFormatUnboldLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatUnboldLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatUnboldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function mo(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatBoldLabel:An.Intents.MultiRangeFormatUnboldLabel}function go(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatSuperscriptLabel:An.Intents.MultiRangeFormatRemoveSuperscriptLabel}function ho(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatSubscriptLabel:An.Intents.MultiRangeFormatRemoveSubscriptLabel}function po(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatItalicLabel,An.Intents.TableBodyRangeFormatItalicLabel,An.Intents.TableHeaderRowRangeFormatItalicLabel,An.Intents.TableTotalRowRangeFormatItalicLabel,An.Intents.TableGeneralRangeFormatItalicLabel,An.Intents.TableRowsRangeFormatItalicLabel,An.Intents.TableRowByIndexRangeFormatItalicLabel,An.Intents.TableColumnsRangeFormatItalicLabel,An.Intents.TableColumnByNameRangeFormatItalicLabel,An.Intents.TableColumnByIndexRangeFormatItalicLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatItalicLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatItalicLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnitalicizeLabel,An.Intents.TableBodyRangeFormatUnitalicizeLabel,An.Intents.TableHeaderRowRangeFormatUnitalicizeLabel,An.Intents.TableTotalRowRangeFormatUnitalicizeLabel,An.Intents.TableGeneralRangeFormatUnitalicizeLabel,An.Intents.TableRowsRangeFormatUnitalicizeLabel,An.Intents.TableRowByIndexRangeFormatUnitalicizeLabel,An.Intents.TableColumnsRangeFormatUnitalicizeLabel,An.Intents.TableColumnByNameRangeFormatUnitalicizeLabel,An.Intents.TableColumnByIndexRangeFormatUnitalicizeLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatUnitalicizeLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatUnitalicizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function bo(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return pl(e.parameters.range,An.Intents.TableRangeFormatSetFontColorLabel,An.Intents.TableBodyRangeFormatSetFontColorLabel,An.Intents.TableHeaderRowRangeFormatSetFontColorLabel,An.Intents.TableTotalRowRangeFormatSetFontColorLabel,An.Intents.TableGeneralRangeFormatSetFontColorLabel,An.Intents.TableRowsRangeFormatSetFontColorLabel,An.Intents.TableRowByIndexRangeFormatSetFontColorLabel,An.Intents.TableColumnsRangeFormatSetFontColorLabel,An.Intents.TableColumnByNameRangeFormatSetFontColorLabel,An.Intents.TableColumnByIndexRangeFormatSetFontColorLabel,{color:e.parameters.value});if((0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName){const t=(0,m.yw)("OfficeVSO_9425205_FixSetColumnFontColor")?An.Intents.ColumnNameFormatSetFontColorLabel:An.Intents.ColumnFormatSetFontColorLabel;return An.substitute(t,{columnName:e.parameters.columnName,color:e.parameters.value})}return An.substitute(An.Intents.RangeFormatSetFontColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:e.parameters.value})}function fo(e){return An.substitute(An.Intents.MultiRangeFormatSetFontColorLabel,{color:e.parameters.events[0].parameters.value})}function Co(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatSetFontLabel,An.Intents.TableBodyRangeFormatSetFontLabel,An.Intents.TableHeaderRowRangeFormatSetFontLabel,An.Intents.TableTotalRowRangeFormatSetFontLabel,An.Intents.TableGeneralRangeFormatSetFontLabel,An.Intents.TableRowsRangeFormatSetFontLabel,An.Intents.TableRowByIndexRangeFormatSetFontLabel,An.Intents.TableColumnsRangeFormatSetFontLabel,An.Intents.TableColumnByNameRangeFormatSetFontLabel,An.Intents.TableColumnByIndexRangeFormatSetFontLabel,{fontName:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameFormatSetFontLabel,{columnName:e.parameters.columnName,fontName:e.parameters.value}):An.substitute(An.Intents.RangeFormatSetFontLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontName:e.parameters.value})}function yo(e){return An.substitute(An.Intents.MultiRangeFormatSetFontLabel,{fontName:e.parameters.events[0].parameters.value})}function vo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnderlineLabel,An.Intents.TableBodyRangeFormatUnderlineLabel,An.Intents.TableHeaderRowRangeFormatUnderlineLabel,An.Intents.TableTotalRowRangeFormatUnderlineLabel,An.Intents.TableGeneralRangeFormatUnderlineLabel,An.Intents.TableRowsRangeFormatUnderlineLabel,An.Intents.TableRowByIndexRangeFormatUnderlineLabel,An.Intents.TableColumnsRangeFormatUnderlineLabel,An.Intents.TableColumnByNameRangeFormatUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveUnderlineLabel,An.Intents.TableBodyRangeFormatRemoveUnderlineLabel,An.Intents.TableHeaderRowRangeFormatRemoveUnderlineLabel,An.Intents.TableTotalRowRangeFormatRemoveUnderlineLabel,An.Intents.TableGeneralRangeFormatRemoveUnderlineLabel,An.Intents.TableRowsRangeFormatRemoveUnderlineLabel,An.Intents.TableRowByIndexRangeFormatRemoveUnderlineLabel,An.Intents.TableColumnsRangeFormatRemoveUnderlineLabel,An.Intents.TableColumnByNameRangeFormatRemoveUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatRemoveUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function To(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatDoubleUnderlineLabel,An.Intents.TableBodyRangeFormatDoubleUnderlineLabel,An.Intents.TableHeaderRowRangeFormatDoubleUnderlineLabel,An.Intents.TableTotalRowRangeFormatDoubleUnderlineLabel,An.Intents.TableGeneralRangeFormatDoubleUnderlineLabel,An.Intents.TableRowsRangeFormatDoubleUnderlineLabel,An.Intents.TableRowByIndexRangeFormatDoubleUnderlineLabel,An.Intents.TableColumnsRangeFormatDoubleUnderlineLabel,An.Intents.TableColumnByNameRangeFormatDoubleUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatDoubleUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatDoubleUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableBodyRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableTotalRowRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableGeneralRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableRowsRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableColumnsRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveDoubleUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function xo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatStrikethroughLabel,An.Intents.TableBodyRangeFormatStrikethroughLabel,An.Intents.TableHeaderRowRangeFormatStrikethroughLabel,An.Intents.TableTotalRowRangeFormatStrikethroughLabel,An.Intents.TableGeneralRangeFormatStrikethroughLabel,An.Intents.TableRowsRangeFormatStrikethroughLabel,An.Intents.TableRowByIndexRangeFormatStrikethroughLabel,An.Intents.TableColumnsRangeFormatStrikethroughLabel,An.Intents.TableColumnByNameRangeFormatStrikethroughLabel,An.Intents.TableColumnByIndexRangeFormatStrikethroughLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatStrikethroughLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveStrikethroughLabel,An.Intents.TableBodyRangeFormatRemoveStrikethroughLabel,An.Intents.TableHeaderRowRangeFormatRemoveStrikethroughLabel,An.Intents.TableTotalRowRangeFormatRemoveStrikethroughLabel,An.Intents.TableGeneralRangeFormatRemoveStrikethroughLabel,An.Intents.TableRowsRangeFormatRemoveStrikethroughLabel,An.Intents.TableRowByIndexRangeFormatRemoveStrikethroughLabel,An.Intents.TableColumnsRangeFormatRemoveStrikethroughLabel,An.Intents.TableColumnByNameRangeFormatRemoveStrikethroughLabel,An.Intents.TableColumnByIndexRangeFormatRemoveStrikethroughLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveStrikethroughLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function So(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatSuperscriptLabel,An.Intents.TableBodyRangeFormatSuperscriptLabel,An.Intents.TableHeaderRowRangeFormatSuperscriptLabel,An.Intents.TableTotalRowRangeFormatSuperscriptLabel,An.Intents.TableGeneralRangeFormatSuperscriptLabel,An.Intents.TableRowsRangeFormatSuperscriptLabel,An.Intents.TableRowByIndexRangeFormatSuperscriptLabel,An.Intents.TableColumnsRangeFormatSuperscriptLabel,An.Intents.TableColumnByNameRangeFormatSuperscriptLabel,An.Intents.TableColumnByIndexRangeFormatSuperscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatSuperscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnSuperscriptLabel,An.Intents.TableBodyRangeFormatRemoveSuperscriptLabel,An.Intents.TableHeaderRowRangeFormatRemoveSuperscriptLabel,An.Intents.TableTotalRowRangeFormatRemoveSuperscriptLabel,An.Intents.TableGeneralRangeFormatRemoveSuperscriptLabel,An.Intents.TableRowsRangeFormatRemoveSuperscriptLabel,An.Intents.TableRowByIndexRangeFormatRemoveSuperscriptLabel,An.Intents.TableColumnsRangeFormatRemoveSuperscriptLabel,An.Intents.TableColumnByNameRangeFormatRemoveSuperscriptLabel,An.Intents.TableColumnByIndexRangeFormatRemoveSuperscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveSuperscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function wo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatSubscriptLabel,An.Intents.TableBodyRangeFormatSubscriptLabel,An.Intents.TableHeaderRowRangeFormatSubscriptLabel,An.Intents.TableTotalRowRangeFormatSubscriptLabel,An.Intents.TableGeneralRangeFormatSubscriptLabel,An.Intents.TableRowsRangeFormatSubscriptLabel,An.Intents.TableRowByIndexRangeFormatSubscriptLabel,An.Intents.TableColumnsRangeFormatSubscriptLabel,An.Intents.TableColumnByNameRangeFormatSubscriptLabel,An.Intents.TableColumnByIndexRangeFormatSubscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatSubscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveSubscriptLabel,An.Intents.TableBodyRangeFormatRemoveSubscriptLabel,An.Intents.TableHeaderRowRangeFormatRemoveSubscriptLabel,An.Intents.TableTotalRowRangeFormatRemoveSubscriptLabel,An.Intents.TableGeneralRangeFormatRemoveSubscriptLabel,An.Intents.TableRowsRangeFormatRemoveSubscriptLabel,An.Intents.TableRowByIndexRangeFormatRemoveSubscriptLabel,An.Intents.TableColumnsRangeFormatRemoveSubscriptLabel,An.Intents.TableColumnByNameRangeFormatRemoveSubscriptLabel,An.Intents.TableColumnByIndexRangeFormatRemoveSubscriptLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveSubscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Eo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetFontSizeLabel,An.Intents.TableBodyRangeSetFontSizeLabel,An.Intents.TableHeaderRowRangeSetFontSizeLabel,An.Intents.TableTotalRowRangeSetFontSizeLabel,An.Intents.TableGeneralRangeSetFontSizeLabel,An.Intents.TableRowsRangeSetFontSizeLabel,An.Intents.TableRowByIndexRangeSetFontSizeLabel,An.Intents.TableColumnsRangeSetFontSizeLabel,An.Intents.TableColumnByNameRangeSetFontSizeLabel,An.Intents.TableColumnByIndexRangeSetFontSizeLabel,{fontSize:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetFontSizeLabel,{columnName:e.parameters.columnName,fontSize:e.parameters.value}):An.substitute(An.Intents.RangeSetFontSizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontSize:e.parameters.value})}function Ro(e){return An.substitute(An.Intents.MultiRangeSetFontSizeLabel,{fontSize:e.parameters.events[0].parameters.value})}function Io(e){return"none"===e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeRemoveFontUnderlineStyleLabel,An.Intents.TableBodyRangeRemoveFontUnderlineStyleLabel,An.Intents.TableHeaderRowRangeRemoveFontUnderlineStyleLabel,An.Intents.TableTotalRowRangeRemoveFontUnderlineStyleLabel,An.Intents.TableGeneralRangeRemoveFontUnderlineStyleLabel,An.Intents.TableRowsRangeRemoveFontUnderlineStyleLabel,An.Intents.TableRowByIndexRangeRemoveFontUnderlineStyleLabel,An.Intents.TableColumnsRangeRemoveFontUnderlineStyleLabel,An.Intents.TableColumnByNameRangeRemoveFontUnderlineStyleLabel,An.Intents.TableColumnByIndexRangeRemoveFontUnderlineStyleLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameRemoveFontUnderlineStyleLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RemoveFontUnderlineStyleLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFontUnderlineStyleLabel,An.Intents.TableBodyRangeFontUnderlineStyleLabel,An.Intents.TableHeaderRowRangeFontUnderlineStyleLabel,An.Intents.TableTotalRowRangeFontUnderlineStyleLabel,An.Intents.TableGeneralRangeFontUnderlineStyleLabel,An.Intents.TableRowsRangeFontUnderlineStyleLabel,An.Intents.TableRowByIndexRangeFontUnderlineStyleLabel,An.Intents.TableColumnsRangeFontUnderlineStyleLabel,An.Intents.TableColumnByNameRangeFontUnderlineStyleLabel,An.Intents.TableColumnByIndexRangeFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase()}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),columnName:e.parameters.columnName}):An.substitute(An.Intents.FontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ao(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetBackgroundColorLabel,An.Intents.TableBodyRangeSetBackgroundColorLabel,An.Intents.TableHeaderRowRangeSetBackgroundColorLabel,An.Intents.TableTotalRowRangeSetBackgroundColorLabel,An.Intents.TableGeneralRangeSetBackgroundColorLabel,An.Intents.TableRowsRangeSetBackgroundColorLabel,An.Intents.TableRowByIndexRangeSetBackgroundColorLabel,An.Intents.TableColumnsRangeSetBackgroundColorLabel,An.Intents.TableColumnByNameRangeSetBackgroundColorLabel,An.Intents.TableColumnByIndexRangeSetBackgroundColorLabel,{color:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetBackgroundColorLabel,{columnName:e.parameters.columnName,color:e.parameters.value}):An.substitute(An.Intents.RangeSetBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:e.parameters.value})}function Lo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeClearBackgroundColorLabel,An.Intents.TableBodyRangeClearBackgroundColorLabel,An.Intents.TableHeaderRowRangeClearBackgroundColorLabel,An.Intents.TableTotalRowRangeClearBackgroundColorLabel,An.Intents.TableGeneralRangeClearBackgroundColorLabel,An.Intents.TableRowsRangeClearBackgroundColorLabel,An.Intents.TableRowByIndexRangeClearBackgroundColorLabel,An.Intents.TableColumnsRangeClearBackgroundColorLabel,An.Intents.TableColumnByNameRangeClearBackgroundColorLabel,An.Intents.TableColumnByIndexRangeClearBackgroundColorLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeClearBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Fo(e){return An.substitute(An.Intents.MultiRangeSetBackgroundColorLabel,{color:e.parameters.events[0].parameters.value})}function _o(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetCellWidthLabel,An.Intents.TableBodyRangeSetCellWidthLabel,An.Intents.TableHeaderRowRangeSetCellWidthLabel,An.Intents.TableTotalRowRangeSetCellWidthLabel,An.Intents.TableGeneralRangeSetCellWidthLabel,An.Intents.TableRowsRangeSetCellWidthLabel,An.Intents.TableRowByIndexRangeSetCellWidthLabel,An.Intents.TableColumnsRangeSetCellWidthLabel,An.Intents.TableColumnByNameRangeSetCellWidthLabel,An.Intents.TableColumnByIndexRangeSetCellWidthLabel,{size:e.parameters.value/C.bN}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetCellWidthLabel,{size:e.parameters.value/C.bN,columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeSetCellWidthLabel,{size:e.parameters.value/C.bN,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function No(e){return An.substitute(An.Intents.MultiRangeSetCellWidthLabel,{size:e.parameters.events[0].parameters.value})}function ko(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetCellHeightLabel,An.Intents.TableBodyRangeSetCellHeightLabel,An.Intents.TableHeaderRowRangeSetCellHeightLabel,An.Intents.TableTotalRowRangeSetCellHeightLabel,An.Intents.TableGeneralRangeSetCellHeightLabel,An.Intents.TableRowsRangeSetCellHeightLabel,An.Intents.TableRowByIndexRangeSetCellHeightLabel,An.Intents.TableColumnsRangeSetCellHeightLabel,An.Intents.TableColumnByNameRangeSetCellHeightLabel,An.Intents.TableColumnByIndexRangeSetCellHeightLabel,{size:e.parameters.value}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetCellHeightLabel,{columnName:e.parameters.columnName,size:e.parameters.value}):An.substitute(An.Intents.RangeSetCellHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),size:e.parameters.value})}function Oo(e){return An.substitute(An.Intents.MultiRangeSetCellHeightLabel,{size:e.parameters.events[0].parameters.value})}function Po(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeApplyBorderLabel,An.Intents.TableBodyRangeApplyBorderLabel,An.Intents.TableHeaderRowRangeApplyBorderLabel,An.Intents.TableTotalRowRangeApplyBorderLabel,An.Intents.TableGeneralRangeApplyBorderLabel,An.Intents.TableRowsRangeApplyBorderLabel,An.Intents.TableRowByIndexRangeApplyBorderLabel,An.Intents.TableColumnsRangeApplyBorderLabel,An.Intents.TableColumnByNameRangeApplyBorderLabel,An.Intents.TableColumnByIndexRangeApplyBorderLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameApplyBorderLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeApplyBorderLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Mo(e){return An.substitute(An.Intents.NamedSheetViewDeleteLabel,{deletedNum:e.parameters.namedSheetViewNames.length})}function Do(e){return An.substitute(An.Intents.NamedSheetViewDuplicateLabel,{sheetViewName:e.parameters.namedSheetViewName})}function $o(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?An.substitute(An.Intents.NamedSheetViewExitAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewKeepName}):An.Intents.NamedSheetViewExitLabel}function Bo(e){return An.substitute(An.Intents.NamedSheetViewKeepLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Ho(e){return An.substitute(An.Intents.NamedSheetViewRenameLabel,{newSheetViewName:e.parameters.newNamedSheetViewName})}function Uo(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?An.substitute(An.Intents.NamedSheetViewSwitchAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewName,sheetViewKeepName:e.parameters.namedSheetViewKeepName}):An.substitute(An.Intents.NamedSheetViewSwitchLabel,{sheetViewName:e.parameters.namedSheetViewName})}function qo(e){if(e.parameters.destinationRange.rangeType===i.RangeType.TableRange){let t;switch(e.parameters.destinationRange.range.subRange){case i.TableRangeOperationSubRange.WholeTable:t=An.Intents.RangePasteInTableRangeLabel;break;case i.TableRangeOperationSubRange.Body:t=An.Intents.RangePasteInTableBodyRangeLabel;break;case i.TableRangeOperationSubRange.HeaderRow:t=An.Intents.RangePasteInTableHeaderRowRangeLabel;break;case i.TableRangeOperationSubRange.TotalRow:t=An.Intents.RangePasteInTableTotalRowRangeLabel;break;case i.TableRangeOperationSubRange.General:t=An.Intents.RangePasteInTableGeneralRangeLabel;break;case i.TableRangeOperationSubRange.Rows:case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:t=An.Intents.RangePasteInTableRangeLabel}return An.substitute(t,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),tableName:e.entityId})}return An.substitute(An.Intents.RangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),destinationRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).range)})}function Vo(e){return An.substitute(An.Intents.MultiRangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.events[0].parameters.sourceRange).range)})}function Go(e){return An.substitute(An.Intents.RangePasteTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wo(e){return An.substitute(An.Intents.WorksheetDuplicateLabel,{sheet:e.entityId})}function zo(e){return An.substitute(An.Intents.WorksheetReapplyFiltersLabel,{sheet:e.entityId})}function Qo(e){return An.substitute(An.Intents.WorksheetClearFiltersLabel,{sheet:e.entityId})}function Jo(e){return An.substitute(An.Intents.CellFindContainingLabel,{search:e.parameters.searchString})}function jo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeReplaceAllLabel,An.Intents.TableBodyRangeReplaceAllLabel,An.Intents.TableHeaderRowRangeReplaceAllLabel,An.Intents.TableTotalRowRangeReplaceAllLabel,An.Intents.TableGeneralRangeReplaceAllLabel,An.Intents.TableRowsRangeReplaceAllLabel,An.Intents.TableRowByIndexRangeReplaceAllLabel,An.Intents.TableColumnsRangeReplaceAllLabel,An.Intents.TableColumnByNameRangeReplaceAllLabel,An.Intents.TableColumnByIndexRangeReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith}):An.substitute(An.Intents.ReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yo(e){return An.substitute(An.Intents.ReplaceAllLabelGeneric,{search:e.parameters.events[0].parameters.searchString,replace:e.parameters.events[0].parameters.replaceWith})}function Xo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetHorizontalAlignmentLabel,An.Intents.TableBodyRangeSetHorizontalAlignmentLabel,An.Intents.TableHeaderRowRangeSetHorizontalAlignmentLabel,An.Intents.TableTotalRowRangeSetHorizontalAlignmentLabel,An.Intents.TableGeneralRangeSetHorizontalAlignmentLabel,An.Intents.TableRowsRangeSetHorizontalAlignmentLabel,An.Intents.TableRowByIndexRangeSetHorizontalAlignmentLabel,An.Intents.TableColumnsRangeSetHorizontalAlignmentLabel,An.Intents.TableColumnByNameRangeSetHorizontalAlignmentLabel,An.Intents.TableColumnByIndexRangeSetHorizontalAlignmentLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetHorizontalAlignmentLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeSetHorizontalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ko(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetVerticalAlignmentLabel,An.Intents.TableBodyRangeSetVerticalAlignmentLabel,An.Intents.TableHeaderRowRangeSetVerticalAlignmentLabel,An.Intents.TableTotalRowRangeSetVerticalAlignmentLabel,An.Intents.TableGeneralRangeSetVerticalAlignmentLabel,An.Intents.TableRowsRangeSetVerticalAlignmentLabel,An.Intents.TableRowByIndexRangeSetVerticalAlignmentLabel,An.Intents.TableColumnsRangeSetVerticalAlignmentLabel,An.Intents.TableColumnByNameRangeSetVerticalAlignmentLabel,An.Intents.TableColumnByIndexRangeSetVerticalAlignmentLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetVerticalAlignmentLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeSetVerticalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Zo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeWrapTextLabel,An.Intents.TableBodyRangeWrapTextLabel,An.Intents.TableHeaderRowRangeWrapTextLabel,An.Intents.TableTotalRowRangeWrapTextLabel,An.Intents.TableGeneralRangeWrapTextLabel,An.Intents.TableRowsRangeWrapTextLabel,An.Intents.TableRowByIndexRangeWrapTextLabel,An.Intents.TableColumnsRangeWrapTextLabel,An.Intents.TableColumnByNameRangeWrapTextLabel,An.Intents.TableColumnByIndexRangeWrapTextLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameWrapTextLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeWrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnwrapTextLabel,An.Intents.TableBodyRangeUnwrapTextLabel,An.Intents.TableHeaderRowRangeUnwrapTextLabel,An.Intents.TableTotalRowRangeUnwrapTextLabel,An.Intents.TableGeneralRangeUnwrapTextLabel,An.Intents.TableRowsRangeUnwrapTextLabel,An.Intents.TableRowByIndexRangeUnwrapTextLabel,An.Intents.TableColumnsRangeUnwrapTextLabel,An.Intents.TableColumnByNameRangeUnwrapTextLabel,An.Intents.TableColumnByIndexRangeUnwrapTextLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameUnwrapTextLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeUnwrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function er(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeChangeIndentLabel,An.Intents.TableBodyRangeChangeIndentLabel,An.Intents.TableHeaderRowRangeChangeIndentLabel,An.Intents.TableTotalRowRangeChangeIndentLabel,An.Intents.TableGeneralRangeChangeIndentLabel,An.Intents.TableRowsRangeChangeIndentLabel,An.Intents.TableRowByIndexRangeChangeIndentLabel,An.Intents.TableColumnsRangeChangeIndentLabel,An.Intents.TableColumnByNameRangeChangeIndentLabel,An.Intents.TableColumnByIndexRangeChangeIndentLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameChangeIndentLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeChangeIndentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function tr(e){return An.substitute(An.Intents.WorksheetReorderLabel,{sheet:e.entityId})}function ar(e){return An.substitute(An.Intents.TableToggleAutoFilterLabel,{tableName:e.entityId})}function nr(e){return An.substitute(An.Intents.WorksheetToggleAutoFilterLabel,{sheet:e.entityId})}function or(e){return An.substitute(An.Intents.SlicerInsertedLabel,{pivotTable:e.parameters.pivotTable,pivotName:e.parameters.pivotFieldName})}function rr(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General){const t=e.parameters.range;if(t.subRange===i.TableRangeOperationSubRange.WholeTable)return An.substitute(An.Intents.WorksheetTableRangeCreateChartLabel,{sheet:e.entityId,table:t.tableName})}return An.substitute(An.Intents.WorksheetCreateChartLabel,{sheet:e.entityId})}function ir(e){return`#${i.ExcelCalc.toHexColor(e)}`}function lr(e,t,a){const n=a?a(e.parameters.newValue):`${e.parameters.newValue}`;return e.parameters.category===i.ChartObjectCategory.ChartAxis?An.substitute(t,{newValue:n,axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?An.substitute(t,{newValue:n,seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):An.substitute(t,{newValue:n,chartName:e.parameters.chartName})}function sr(e,t){return e.parameters.category===i.ChartObjectCategory.ChartAxis?An.substitute(t,{axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?An.substitute(t,{seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):An.substitute(t,{chartName:e.parameters.chartName})}function cr(e){return e.parameters.added?An.substitute(An.Intents.VisualSerriesTrendlineAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):An.substitute(An.Intents.VisualSerriesTrendlineRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function dr(e){return e.parameters.added?An.substitute(An.Intents.VisualSeriesTrendlineTitleAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex}):An.substitute(An.Intents.VisualSeriesTrendlineTitleRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function ur(e){return An.substitute(An.Intents.WorksheetCreateChartLabel,{sheet:e.entityId})}function mr(e){return e.parameters?An.substitute(An.Intents.WorksheetShowHeadingsLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetHideHeadingsLabel,{sheet:e.entityId})}function gr(e){return e.parameters?An.substitute(An.Intents.WorksheetShowGridlinesLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetHideGridlinesLabel,{sheet:e.entityId})}function hr(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeRemoveDuplicatesLabel,An.Intents.TableBodyRangeRemoveDuplicatesLabel,An.Intents.TableHeaderRowRangeRemoveDuplicatesLabel,An.Intents.TableTotalRowRangeRemoveDuplicatesLabel,An.Intents.TableGeneralRangeRemoveDuplicatesLabel,An.Intents.TableRowsRangeRemoveDuplicatesLabel,An.Intents.TableRowByIndexRangeRemoveDuplicatesLabel,An.Intents.TableColumnsRangeRemoveDuplicatesLabel,An.Intents.TableColumnByNameRangeRemoveDuplicatesLabel,An.Intents.TableColumnByIndexRangeRemoveDuplicatesLabel,{}):An.substitute(An.Intents.RangeRemoveDuplicatesLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function pr(e){const t=e.parameters?An.Intents.TableAddTotalRowLabel:An.Intents.TableRemoveTotalRowLabel;return An.substitute(t,{tableName:e.entityId})}function br(e){const t=e.parameters?An.Intents.TableAddHeaderRowLabel:An.Intents.TableRemoveHeaderRowLabel;return An.substitute(t,{tableName:e.entityId})}function fr(e){return An.substitute(An.Intents.TableResizeLabel,{tableName:e.entityId})}function Cr(e){return e.parameters.isCreation?An.substitute(An.Intents.TableCreateAndFormatLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):An.substitute(An.Intents.TableFormatLabel,{tableName:e.entityId})}function yr(e){return""===e.parameters?An.substitute(An.Intents.WorksheetClearTabColorLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetSetTabColorLabel,{color:e.parameters,sheet:e.entityId})}function vr(e){return An.substitute(An.Intents.WorksheetChartSwitchRowColumnLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Tr(e){return An.substitute(An.Intents.WorksheetChartSelectDataLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function xr(e){return An.substitute(An.Intents.WorksheetChartChangeTypeLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Sr(e){return An.substitute(An.Intents.RangeFlashFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function wr(e){return An.substitute(An.Intents.WorksheetChartChangeTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Er(e){return An.substitute(An.Intents.WorksheetChartHideTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Rr(e){return An.substitute(An.Intents.WorksheetChartChangeAxisTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Ir(e){return An.substitute(An.Intents.WorksheetChartHideAxisTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ar(e){return An.substitute(An.Intents.WorksheetChartChangeLegendLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Lr(e){return An.substitute(An.Intents.WorksheetChartAxisTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Fr(e){return An.substitute(An.Intents.WorksheetCharTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function _r(e){return An.substitute(An.Intents.WorksheetChartHideLegendLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Nr(e){return An.substitute(An.Intents.WorksheetChartDataLabelChangePositionLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function kr(e){return An.substitute(An.Intents.WorksheetChartDataLabelChangeVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Or(e){return An.substitute(An.Intents.WorksheetChartChangeAxisLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Pr(e){return An.substitute(An.Intents.WorksheetChartChangeAxisVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Mr(e){return An.substitute(An.Intents.TableApplyStyleLabel,{tableName:e.entityId})}function Dr(e){const t=e.parameters?An.Intents.TableAddBandedRowsLabel:An.Intents.TableRemoveBandedRowsLabel;return An.substitute(t,{tableName:e.entityId})}function $r(e){const t=e.parameters?An.Intents.TableAddBandedColumnsLabel:An.Intents.TableRemoveBandedColumnsLabel;return An.substitute(t,{tableName:e.entityId})}function Br(e){return An.substitute(An.Intents.TableHighlightFirstColumnFilterLabel,{tableName:e.entityId})}function Hr(e){return An.substitute(An.Intents.TableHighlightLastColumnLabel,{tableName:e.entityId})}function Ur(e){const t=e.parameters?An.Intents.TableAddFilterButtonLabel:An.Intents.TableRemoveFilterButtonLabel;return An.substitute(t,{tableName:e.entityId})}function qr(e){return e.parameters.rangeToFreeze?An.Intents.WorksheetFreezePaneLabel:An.Intents.WorksheetUnFreezePaneLabel}function Vr(e){return An.substitute(An.Intents.WorksheetShapeInsertedLabel,{sheet:e.entityId})}function Gr(e){return An.substitute(An.Intents.WorksheetShapeSetStyleLabel,{sheet:e.entityId})}function Wr(e){return An.substitute(An.Intents.WorksheetChartDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function zr(e){return An.substitute(An.Intents.ChartSeriesDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId,seriesIndex:e.parameters.seriesIndex})}function Qr(e){return An.substitute(An.Intents.ChartSeriesDataChangedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.seriesIndex})}function Jr(e){return An.substitute(An.Intents.WorksheetFloatingObjectDeleteLabel,{sheet:e.entityId})}function jr(e){return An.substitute(An.Intents.WorksheetChartMoveAndResizeLabel,{chartName:e.parameters.name,sheet:e.entityId})}function Yr(e){return An.substitute(An.Intents.WorksheetFloatingObjectMoveAndResizeLabel,{sheet:e.entityId})}function Xr(e){return An.substitute(An.Intents.WorksheetFloatingObjectZOrderChangedLabel,{sheet:e.entityId})}function Kr(e){return An.substitute(An.Intents.WorksheetShapeRotateLabel,{sheet:e.entityId})}function Zr(e){return An.substitute(An.Intents.WorksheetShapeAltTextApplyLabel,{sheet:e.entityId})}function ei(e){return An.substitute(An.Intents.WorksheetShapeTextChangedLabel,{sheet:e.entityId})}function ti(e){return e.parameters.value?An.substitute(An.Intents.WorksheetShapeTextBoldedLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetShapeTextUnboldedLabel,{sheet:e.entityId})}function ai(e){return e.parameters.value?An.substitute(An.Intents.WorksheetShapeTextItalicizedLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetShapeTextUnitalicizedLabel,{sheet:e.entityId})}function ni(e){return e.parameters.value?An.substitute(An.Intents.WorksheetShapeTextUnderlinedLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetShapeTextUnderlineRemovedLabel,{sheet:e.entityId})}function oi(e){return An.substitute(An.Intents.WorksheetShapeTextFontNameChangedLabel,{sheet:e.entityId,fontName:e.parameters.value})}function ri(e){return An.substitute(An.Intents.WorksheetShapeTextFontSizeChangedLabel,{sheet:e.entityId,fontSize:e.parameters.value})}function ii(e){return An.substitute(An.Intents.WorksheetShapeTextFontColorChangedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function li(e){return An.substitute(An.Intents.WorksheetShapeTextHorizontallyAlignedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function si(e){return An.substitute(An.Intents.WorksheetShapeTextVerticallyAlignedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function ci(e){return An.substitute(An.Intents.RangeGroupLabel,{sheet:e.entityId})}function di(e){return An.substitute(An.Intents.RangeUnGroupLabel,{sheet:e.entityId})}function ui(e){return An.substitute(An.Intents.WorksheetOutlineLevelsSetLabel,{sheet:e.entityId})}function mi(e){return An.substitute(An.Intents.RangeGroupDetailsShowLabel,{sheet:e.entityId})}function gi(e){return An.substitute(An.Intents.RangeGroupDetailsHideLabel,{sheet:e.entityId})}function hi(e){return An.substitute(An.Intents.RangeDataValidationChangedGroupLabel,{sheet:e.entityId})}function pi(e){return An.substitute(An.Intents.TableRenameLabel,{tableName:e.parameters})}function bi(e){return An.substitute(An.Intents.TableConvertToRangeLabel,{tableName:e.entityId})}function fi(e){return An.substitute(An.Intents.TableAltTextEditedLabel,{tableName:e.entityId})}function Ci(e){return An.substitute(An.Intents.TableAltTextTitleEditedLabel,{tableName:e.entityId})}function yi(e){return An.substitute(An.Intents.TableAltTextDescriptionEditedLabel,{tableName:e.entityId})}function vi(e){return An.substitute(An.Intents.PivotTableChangeLabel,{pivotName:e.parameters.events[0].parameters.pivotName})}function Ti(e){return An.substitute(An.Intents.PivotTableAddPivot,{pivotName:e.parameters.pivotName})}function xi(e){return An.substitute(An.Intents.PivotTableRemovePivot,{pivotName:e.parameters.pivotName})}function Si(e){return An.substitute(An.Intents.PivotTableRefreshLabel,{pivotName:e.parameters})}function wi(e){return e.parameters.value?An.substitute(An.Intents.PivotDrillExpandedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName}):An.substitute(An.Intents.PivotDrillCollapsedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName})}function Ei(e){return An.substitute(An.Intents.PivotTableRenamedLabel,{newName:e.parameters.value})}function Ri(e){return e.parameters.value?An.substitute(An.Intents.PivotTableRowGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):An.substitute(An.Intents.PivotTableRowGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ii(e){return e.parameters.value?An.substitute(An.Intents.PivotTableColumnGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):An.substitute(An.Intents.PivotTableColumnGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ai(e){return An.substitute(An.Intents.PivotTableLayoutTypeSetLabel,{pivotName:e.parameters.pivotName})}function Li(e){return An.substitute(An.Intents.WorksheetValuesFilterAppliedLabel,{range:i.ExcelCalc.columnFromIExcelAddress(e.parameters.range.range,e.parameters.column)})}function Fi(e){return An.substitute(An.Intents.WorksheetCustomFilterAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function _i(e){return An.substitute(An.Intents.WorksheetDynamicFilterAppliedLabel,{range:i.ExcelCalc.ICellColumnSheetRangeToAddress({range:{topLeft:{column:e.parameters.column,row:null},bottomRight:{column:e.parameters.column,row:null}},sheet:""})})}function Ni(e){return An.substitute(An.Intents.RangeSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ki(e){return An.substitute(An.Intents.ArtPasteSameWorkbookLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).sheet})}function Oi(e){return An.substitute(An.Intents.RangeAutoSumLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Pi(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeHideRowsLabel,An.Intents.TableBodyRangeHideRowsLabel,An.Intents.TableHeaderRowRangeHideRowsLabel,An.Intents.TableTotalRowRangeHideRowsLabel,An.Intents.TableGeneralRangeHideRowsLabel,An.Intents.TableRowsRangeHideRowsLabel,An.Intents.TableRowByIndexRangeHideRowsLabel,An.Intents.TableColumnsRangeHideRowsLabel,An.Intents.TableColumnByNameRangeHideRowsLabel,An.Intents.TableColumnByIndexRangeHideRowsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameHideRowsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeHideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnhideRowsLabel,An.Intents.TableBodyRangeUnhideRowsLabel,An.Intents.TableHeaderRowRangeUnhideRowsLabel,An.Intents.TableTotalRowRangeUnhideRowsLabel,An.Intents.TableGeneralRangeUnhideRowsLabel,An.Intents.TableRowsRangeUnhideRowsLabel,An.Intents.TableRowByIndexRangeUnhideRowsLabel,An.Intents.TableColumnsRangeUnhideRowsLabel,An.Intents.TableColumnByNameRangeUnhideRowsLabel,An.Intents.TableColumnByIndexRangeUnhideRowsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameUnhideRowsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeUnhideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Mi(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeHideColumnsLabel,An.Intents.TableBodyRangeHideColumnsLabel,An.Intents.TableHeaderRowRangeHideColumnsLabel,An.Intents.TableTotalRowRangeHideColumnsLabel,An.Intents.TableGeneralRangeHideColumnsLabel,An.Intents.TableRowsRangeHideColumnsLabel,An.Intents.TableRowByIndexRangeHideColumnsLabel,An.Intents.TableColumnsRangeHideColumnsLabel,An.Intents.TableColumnByNameRangeHideColumnsLabel,An.Intents.TableColumnByIndexRangeHideColumnsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameHideColumnsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeHideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnhideColumnsLabel,An.Intents.TableBodyRangeUnhideColumnsLabel,An.Intents.TableHeaderRowRangeUnhideColumnsLabel,An.Intents.TableTotalRowRangeUnhideColumnsLabel,An.Intents.TableGeneralRangeUnhideColumnsLabel,An.Intents.TableRowsRangeUnhideColumnsLabel,An.Intents.TableRowByIndexRangeUnhideColumnsLabel,An.Intents.TableColumnsRangeUnhideColumnsLabel,An.Intents.TableColumnByNameRangeUnhideColumnsLabel,An.Intents.TableColumnByIndexRangeUnhideColumnsLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameUnhideColumnsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeUnhideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Di(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeHideRowsLabel:An.Intents.MultiRangeUnhideRowsLabel}function $i(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeHideColumnsLabel:An.Intents.MultiRangeUnhideColumnsLabel}function Bi(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableBodyRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableGeneralRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableRowsRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableColumnsRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel,{}):An.substitute(An.Intents.ConditionalFormattingCreatedGroupEventLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Hi(e){const t=e.parameters.customFormat,a=[];t.IsTextBold&&a.push("bolded"),t.IsTextItalic&&a.push("italicized"),t.IsTextUnderlined&&a.push("underlined"),t.IsTextDoubleUnderlined&&a.push("double underlined");const n=[],o=t.BackgroundColor,r=t.TextColor,l=t.IsTextStrikethrough,s=t.BorderFormat.LineStyle,c=t.BorderFormat.Color;if(null!=o&&n.push(`${o} fill color`),null!=r&&n.push(`${r} font color`),l&&n.push("strikethrough"),s[0]!==i.BorderLineStyle.None){const e=(0,h.S)(c[0]);n.push(`${y.US[s[0]]} ${e} border`)}let u="";if(1===a.length&&0===n.length)u+=a[0];else if(0===a.length&&1===n.length)u+="applied a "+n[0]+" to";else if(1===a.length&&1===n.length)u+=a[0]+" and applied a "+n[0]+" to";else if(2===a.length&&0===n.length)u+=a[0]+" and "+a[1];else if(0===a.length&&2===n.length)u+="applied a "+n[0]+" and a "+n[1]+" to";else{if(a.length>0){for(let e=0;e<a.length-1;e++)u+=a[e]+", ";0===n.length?u+="and "+a[a.length-1]:u+=a[a.length-1]+", "}if(n.length>0)if(1===n.length)u+="and applied a "+n[0];else{u+="applied a ";for(let e=0;e<n.length-1;e++)u+=n[e]+", ";u+="and "+n[n.length-1]+" to"}}const m=[{key:d.Dh.EventType,value:d.Mv.LogSuccessMessageFormattingParameters},{key:d.Dh.SuccessMessageNumParameters,value:a.length+n.length},{key:d.Dh.SuccessMessageFormattingParameters,value:a.concat(n).join(", ")}];return(0,T.j)(m),u}function Ui(e){const t=/"|=|DATEVALUE|\(|\)/g;let a="cell value is ";const n=e.parameters.rule,o=n.operator;if(a+=y.Mb[o]+" "+n.formula1.replace(t,""),n.formula2&&(o===x.default.Between||o===x.default.NotBetween)){a+=" and "+n.formula2.replace(t,"")}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),cellValueCriteria:a}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,cellValueCriteria:a}):An.substitute(An.Intents.ConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),cellValueCriteria:a})}function qi(e){const t=e.parameters.rule.formula;return e.parameters.rangeType===i.RangeType.TableRange?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),customFormula:t}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,customFormula:t}):An.substitute(An.Intents.ConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),customFormula:t})}function Vi(e){const t=e.parameters.rule,a=y.tQ[t.operator]+" "+t.text;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),textComparisonCriteria:a}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,textComparisonCriteria:a}):An.substitute(An.Intents.ConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),textComparisonCriteria:a})}function Gi(e){const t=e.parameters.colorScaleFormat;let a="";if(t){const e=t.minimumColor,n=t.midpointColor,o=t.maximumColor;a=n?e+", "+n+", "+o:e+", "+o}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel,{colorScaleFormat:a}):An.substitute(An.Intents.ConditionalFormattingColorScaleCustomCreatedLabel,{colorScaleFormat:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wi(e){const t=e.parameters.dataBarFormat;let a="";if(t){const e=t.isGradientFill,n=t.fillColor;a=e?"gradient "+n:"solid "+n}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel,{dataBarFormat:a}):An.substitute(An.Intents.ConditionalFormattingDataBarCustomCreatedLabel,{dataBarFormat:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function zi(e){const t=e.parameters.style,a=y.B8[t];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel,{iconSet:a}):An.substitute(An.Intents.ConditionalFormattingIconSetCreatedLabel,{iconSet:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Qi(e){const t=e.parameters.rule,a=y.b3[t.criterion];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:a}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:a,columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ji(e){const t=e.parameters.rule,a=y.GO[t.timePeriodType];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:a}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:a,columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ji(e){const t=e.parameters.rule.unique;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate"}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate",columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yi(e){const t=e.parameters.rule,a=t.rank,n=y.tg[t.type],o=An.substitute(n,{number:a});return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o,columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Xi(e){return An.substitute(An.Intents.ConditionalFormattingEditedGroupEventLabel,{sheet:e.entityId})}function Ki(e){return An.substitute(An.Intents.ConditionalFormattingRuleDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.ranges[0]).range)})}function Zi(e){return s.O.MissingIntent}function el(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingDeletedLabel,An.Intents.TableBodyRangeConditionalFormattingDeletedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingDeletedLabel,An.Intents.TableTotalRowRangeConditionalFormattingDeletedLabel,An.Intents.TableGeneralRangeConditionalFormattingDeletedLabel,An.Intents.TableRowsRangeConditionalFormattingDeletedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingDeletedLabel,An.Intents.TableColumnsRangeConditionalFormattingDeletedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingDeletedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingDeletedLabel,{}):An.substitute(An.Intents.ConditionalFormattingDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function tl(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeCellStyleAppliedLabel,An.Intents.TableBodyRangeCellStyleAppliedLabel,An.Intents.TableHeaderRowRangeCellStyleAppliedLabel,An.Intents.TableTotalRowRangeCellStyleAppliedLabel,An.Intents.TableGeneralRangeCellStyleAppliedLabel,An.Intents.TableRowsRangeCellStyleAppliedLabel,An.Intents.TableRowByIndexRangeCellStyleAppliedLabel,An.Intents.TableColumnsRangeCellStyleAppliedLabel,An.Intents.TableColumnByNameRangeCellStyleAppliedLabel,An.Intents.TableColumnByIndexRangeCellStyleAppliedLabel,{}):(0,m.yw)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameCellStyleAppliedLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeCellStyleAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function al(e){return An.substitute(An.Intents.PictureInsertedEventLabel,{sheet:e.entityId})}function nl(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeCustomSortLabel,An.Intents.TableBodyRangeCustomSortLabel,An.Intents.TableHeaderRowRangeCustomSortLabel,An.Intents.TableTotalRowRangeCustomSortLabel,An.Intents.TableGeneralRangeCustomSortLabel,An.Intents.TableRowsRangeCustomSortLabel,An.Intents.TableRowByIndexRangeCustomSortLabel,An.Intents.TableColumnsRangeCustomSortLabel,An.Intents.TableColumnByNameCustomSortLabel,An.Intents.TableColumnByIndexCustomSortLabel,{}):An.substitute(An.Intents.RangeCustomSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ol(e){return An.substitute(An.Intents.AutoFilterCustomSortLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).sheet})}function rl(e){return An.substitute(An.Intents.TextToColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range)})}function il(e){return An.substitute(An.Intents.AllowEditRangeAddedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function ll(e){return An.substitute(An.Intents.AllowEditRangeDeletedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function sl(e){return An.substitute(An.Intents.AllowEditRangeEditedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function cl(e){return An.substitute(An.Intents.SheetProtectionOptionsUpdatedLabel,{sheet:e.entityId})}function dl(e){return An.substitute(An.Intents.SheetProtectionPasswordUpdatedLabel,{sheet:e.entityId})}function ul(e){return An.substitute(An.Intents.SheetProtectionPausedLabel,{sheet:e.entityId})}function ml(e){return An.substitute(An.Intents.SheetProtectionProtectedLabel,{sheet:e.entityId})}function gl(e){return An.substitute(An.Intents.SheetProtectionResumedLabel,{sheet:e.entityId})}function hl(e){return An.substitute(An.Intents.SheetProtectionUnprotectedLabel,{sheet:e.entityId})}function pl(e,t,a,n,o,r,l,s,c,d,u,m){let g;switch(m.tableName=e.tableName,e.subRange){case i.TableRangeOperationSubRange.WholeTable:g=t;break;case i.TableRangeOperationSubRange.Body:g=a;break;case i.TableRangeOperationSubRange.HeaderRow:g=n;break;case i.TableRangeOperationSubRange.TotalRow:g=o;break;case i.TableRangeOperationSubRange.General:g=r;break;case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:{g=c;const t=e.subRangeValues;if(t.columnNames)1===t.columnNames.length?(g=d,m.columnName=t.columnNames[0]):m.count=t.columnNames.length;else{const t=e.subRangeValues;1===t.count?(g=u,m.columnIndex=t.firstIndex):m.count=t.count}break}case i.TableRangeOperationSubRange.Rows:{const t=e.subRangeValues;1===t.count?(g=s,m.rowIndex=t.firstIndex):(g=l,m.count=t.count);break}}return An.substitute(g,m)}var bl=a(54947);function fl(e){let t=e.method;return t===i.EventMethods.System.Batched&&(t=e.parameters.method),t}const Cl=new Map([[i.EventMethods.Worksheet.Added,()=>An.Intents.WorksheetAddLabel],[i.EventMethods.Worksheet.AddedWithName,Fn],[i.EventMethods.Worksheet.Deleted,()=>An.Intents.WorksheetDeleteLabel],[i.EventMethods.Worksheet.MultiSheetDeleted,Nn],[i.EventMethods.Worksheet.Renamed,_n],[i.EventMethods.Worksheet.Duplicated,Wo],[i.EventMethods.Worksheet.FilterReapplied,zo],[i.EventMethods.Worksheet.AutoFilterCleared,Qo],[i.EventMethods.Worksheet.Reordered,tr],[i.EventMethods.Worksheet.AutoFilterToggled,nr],[i.EventMethods.Worksheet.GridlinesToggled,gr],[i.EventMethods.Worksheet.HeadingsToggled,mr],[i.EventMethods.Worksheet.TabColored,yr],[i.EventMethods.Worksheet.PaneFrozen,qr],[i.EventMethods.Worksheet.ColumnsFrozen,()=>An.Intents.WorksheetFreezeColumnsLabel],[i.EventMethods.Worksheet.RowsFrozen,()=>An.Intents.WorksheetFreezeRowsLabel],[i.EventMethods.Worksheet.OutlineLevelsShown,ui],[i.EventMethods.Worksheet.ValuesFilterApplied,Li],[i.EventMethods.Worksheet.CustomFilterApplied,Fi],[i.EventMethods.Worksheet.DynamicFilterApplied,_i],[i.EventMethods.Worksheet.VisibilityChanged,()=>An.Intents.WorksheetVisibilityChangedLabel],[i.EventMethods.Worksheet.MoveToEdge,()=>An.Intents.MoveToEdgeLabel],[i.EventMethods.Intent.CreateNamedItemOnWorkbook,()=>An.Intents.CreateNamedItem],[i.EventMethods.Intent.CreateNamedItemOnWorksheet,()=>An.Intents.CreateNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorkbook,()=>An.Intents.SetNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorksheet,()=>An.Intents.SetNamedItem],[i.EventMethods.Intent.DeleteNamedItemOnWorkbook,()=>An.Intents.DeleteNamedItem],[i.EventMethods.Intent.RangeSetIndent,()=>An.Intents.ChangeRangeIndent],[i.EventMethods.Intent.RangeAdjustIndent,()=>An.Intents.ChangeRangeIndent],[i.EventMethods.Range.Edited,kn],[i.EventMethods.Range.SingleValueEdited,On],[i.EventMethods.Range.MultiRangeEdited,()=>An.Intents.MultiRangeEditLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>An.Intents.MultiRangeDeleteLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>An.Intents.MultiRangeDeleteLabel],[i.EventMethods.Range.Cleared,Pn],[i.EventMethods.Range.MultiRangeCleared,()=>An.Intents.MultiRangeClearLabel],[i.EventMethods.Range.Deleted,Mn],[i.EventMethods.Range.Inserted,Dn],[i.EventMethods.Range.Merged,$n],[i.EventMethods.Range.MultiRangeMerged,()=>An.Intents.MultiRangeMergeLabel],[i.EventMethods.Range.MultiRangeInserted,()=>An.Intents.MultipleRangeInsertLabel],[i.EventMethods.Range.Unmerged,Bn],[i.EventMethods.Range.MultiRangeUnmerged,()=>An.Intents.MultiRangeUnmergeLabel],[i.EventMethods.Range.ColumnsAutoFit,Hn],[i.EventMethods.Range.MultiRangeColumnsAutoFit,Hn],[i.EventMethods.Range.RowsAutoFit,Un],[i.EventMethods.Range.UseStandardHeight,qn],[i.EventMethods.Range.UseStandardWidth,Vn],[i.EventMethods.Range.MultiRangeRowsAutoFit,Un],[i.EventMethods.Range.HyperlinkApplied,Gn],[i.EventMethods.Range.HyperlinkRemoved,Wn],[i.EventMethods.Range.MultiRangeHyperlinkRemoved,()=>An.Intents.MultiRangeRemoveHyperlinkLabel],[i.EventMethods.Range.NumberFormatChanged,zn],[i.EventMethods.Range.MultiRangeNumberFormatChanged,()=>An.Intents.MultiRangeNumberFormatLabel],[i.EventMethods.Range.InsertCopiedCutCells,Qn],[i.EventMethods.Range.InsertCopiedCutCellsInTable,e=>function(e){const t=e.parameters.destinationTableRange.subRangeValues;return 0===e.parameters.copyCutOperation?An.substitute(An.Intents.RangePasteCopyInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex}):An.substitute(An.Intents.RangePasteCutInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex})}(e)],[i.EventMethods.Range.Filled,Jn],[i.EventMethods.Range.DuplicatesRemoved,hr],[i.EventMethods.Range.FlashFilled,Sr],[i.EventMethods.Range.Grouped,ci],[i.EventMethods.Range.Ungrouped,di],[i.EventMethods.Range.GroupDetailsShown,mi],[i.EventMethods.Range.GroupDetailsHidden,gi],[i.EventMethods.Range.Sorted,Ni],[i.EventMethods.Range.DataValidationChangedGroup,hi],[i.EventMethods.Range.AutoSum,Oi],[i.EventMethods.Range.CellStyleApplied,tl],[i.EventMethods.Range.MultiRangeCellStyleApplied,()=>An.Intents.MultiRangeCellStyleAppliedLabel],[i.EventMethods.Range.CustomSorted,nl],[i.EventMethods.Range.AutoFilterCustomSorted,ol],[i.EventMethods.Range.TextToColumns,rl],[i.EventMethods.Range.FixedWidthTextToColumns,()=>An.Intents.FixedWidthTextToColumns],[i.EventMethods.Intent.SetDataValidation,()=>An.Intents.IntentSetDataValidation],[i.EventMethods.Shape.Inserted,Vr],[i.EventMethods.Shape.StyleSet,Gr],[i.EventMethods.Shape.Deleted,Jr],[i.EventMethods.Shape.MovedAndResized,Yr],[i.EventMethods.Shape.ZOrderChanged,Xr],[i.EventMethods.Shape.Rotated,Kr],[i.EventMethods.Shape.AltTextApplied,Zr],[i.EventMethods.Shape.PictureInserted,al],[i.EventMethods.Shape.TextChanged,ei],[i.EventMethods.Shape.TextBolded,ti],[i.EventMethods.Shape.TextItalicized,ai],[i.EventMethods.Shape.TextUnderlined,ni],[i.EventMethods.Shape.TextFontNameChanged,oi],[i.EventMethods.Shape.TextFontSizeChanged,ri],[i.EventMethods.Shape.TextFontColorChanged,ii],[i.EventMethods.Shape.TextHorizontallyAligned,li],[i.EventMethods.Shape.TextVerticallyAligned,si],[i.EventMethods.PivotTable.Created,()=>An.Intents.PivotTableCreateLabel],[i.EventMethods.PivotTable.SortApplied,()=>An.Intents.PivotTableSortLabel],[i.EventMethods.PivotTable.PivotPositionChanged,()=>An.Intents.PivotTableChangePositionLabel],[i.EventMethods.PivotTable.CreatedOnNewSheet,()=>An.Intents.PivotTableCreateLabel],[i.EventMethods.PivotTable.PivotRemoved,xi],[i.EventMethods.PivotTable.PivotAdded,Ti],[i.EventMethods.PivotTable.PivotAdded,Ti],[i.EventMethods.PivotTable.Pivoted,vi],[i.EventMethods.PivotTable.Refreshed,Si],[i.EventMethods.PivotTable.PivotDrillToggled,wi],[i.EventMethods.PivotTable.Renamed,Ei],[i.EventMethods.PivotTable.RowGrandTotalShown,Ri],[i.EventMethods.PivotTable.ColumnGrandTotalShown,Ii],[i.EventMethods.PivotTable.AutoFitColumnWidthsOnRefreshToggled,e=>function(e){return An.substitute(An.Intents.PivotTableAutoFitColumnWidthsOnRefreshToggledLabel,{pivotName:e.parameters.pivotName,value:e.parameters.value})}(e)],[i.EventMethods.PivotTable.SubTotalsVisibilitySettingSet,e=>function(e){return An.substitute(An.Intents.PivotTableSubTotalsVisibilitySettingSetLabel,{pivotName:e.parameters.pivotName})}(e)],[i.EventMethods.PivotTable.LayoutTypeSet,Ai],[i.EventMethods.Slicer.Inserted,or],[i.EventMethods.Chart.Created,rr],[i.EventMethods.Chart.MultiRangeCreated,ur],[i.EventMethods.Chart.RowColumnSwitched,vr],[i.EventMethods.Chart.DataSelected,Tr],[i.EventMethods.Chart.TypeChanged,xr],[i.EventMethods.Chart.TitleChanged,wr],[i.EventMethods.Chart.TitleTextChanged,Fr],[i.EventMethods.Chart.TitleHidden,Er],[i.EventMethods.Chart.AxisTitleChanged,Rr],[i.EventMethods.Chart.AxisTitleHidden,Ir],[i.EventMethods.Chart.AxisTitleTextChanged,Lr],[i.EventMethods.Chart.AxisTitleHorizontal,()=>An.Intents.ChartAxisTitleHorizontal],[i.EventMethods.Chart.AxisTitleVertical,()=>An.Intents.ChartAxisTitleVertical],[i.EventMethods.Chart.LegendChanged,Ar],[i.EventMethods.Chart.LegendHidden,_r],[i.EventMethods.Chart.DataLabelPositionChanged,Nr],[i.EventMethods.Chart.DataLabelVisibilityChanged,kr],[i.EventMethods.Chart.GridlinesVisibilityChanged,e=>function(e){return An.substitute(An.Intents.WorksheetChartChangeGridlineVisiblityLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}(e)],[i.EventMethods.Chart.AxisChanged,Or],[i.EventMethods.Chart.AxisVisiblityChanged,Pr],[i.EventMethods.Chart.Deleted,Wr],[i.EventMethods.Chart.MovedAndResized,jr],[i.EventMethods.Chart.SeriesDeleted,zr],[i.EventMethods.Chart.SeriesDataChanged,Qr],[i.EventMethods.ChartFormat.SetGetProperties,e=>function(e){return An.substitute(An.Intents.ChartFormatSetGetPropertiesLabel,{count:e.parameters.events.length,chartName:e.parameters.events[0].parameters.chartName})}(e)],[i.EventMethods.Visual.ChartAxisAxisTitleFillColored,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFillColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleFontBolded,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontColored,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleFontItalicized,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontNamed,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontNamedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontSized,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontSizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontUnderlined,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleLineColored,e=>lr(e,An.Intents.VisualChartAxisAxisTitleLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleTextChanged,e=>lr(e,An.Intents.VisualChartAxisAxisTitleTextChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMaxChanged,e=>lr(e,An.Intents.VisualChartAxisBoundsMaxChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMinChanged,e=>lr(e,An.Intents.VisualChartAxisBoundsMinChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesAtChanged,e=>lr(e,An.Intents.VisualChartAxisCrossesAtChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesChanged,e=>lr(e,An.Intents.VisualChartAxisCrossesChangedLabel)],[i.EventMethods.Visual.ChartAxisFillColored,e=>lr(e,An.Intents.VisualChartAxisFillColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisFontBolded,e=>lr(e,An.Intents.VisualChartAxisFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisFontColored,e=>lr(e,An.Intents.VisualChartAxisFontColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisFontItalicized,e=>lr(e,An.Intents.VisualChartAxisFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisFontNamed,e=>lr(e,An.Intents.VisualChartAxisFontNamedLabel)],[i.EventMethods.Visual.ChartAxisFontSized,e=>lr(e,An.Intents.VisualChartAxisFontSizedLabel)],[i.EventMethods.Visual.ChartAxisFontUnderlined,e=>lr(e,An.Intents.VisualChartAxisFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesLineColored,e=>lr(e,An.Intents.VisualChartAxisMajorGridlinesLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesLineColored,e=>lr(e,An.Intents.VisualChartAxisMinorGridlinesLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisLineColored,e=>lr(e,An.Intents.VisualChartAxisLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisNumberFormatCodeChanged,e=>lr(e,An.Intents.VisualChartAxisNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.ChartAxisReversePlotOrderChanged,e=>lr(e,An.Intents.VisualChartAxisReversePlotOrderChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMajorTypeChanged,e=>lr(e,An.Intents.VisualChartAxisTickMarksMajorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMinorTypeChanged,e=>lr(e,An.Intents.VisualChartAxisTickMarksMinorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMajorUnitChanged,e=>lr(e,An.Intents.VisualChartAxisUnitsMajorUnitChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMinorUnitChanged,e=>lr(e,An.Intents.VisualChartAxisUnitsMinorUnitChangedLabel)],[i.EventMethods.Visual.ChartTitleFillColored,e=>lr(e,An.Intents.VisualChartTitleFillColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleFontBolded,e=>lr(e,An.Intents.VisualChartTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartTitleFontColored,e=>lr(e,An.Intents.VisualChartTitleFontColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleFontItalicized,e=>lr(e,An.Intents.VisualChartTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartTitleFontNamed,e=>lr(e,An.Intents.VisualChartTitleFontNamedLabel)],[i.EventMethods.Visual.ChartTitleFontSized,e=>lr(e,An.Intents.VisualChartTitleFontSizedLabel)],[i.EventMethods.Visual.ChartTitleFontUnderlined,e=>lr(e,An.Intents.VisualChartTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartTitleLineColored,e=>lr(e,An.Intents.VisualChartTitleLineColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleOverlayChanged,e=>lr(e,An.Intents.VisualChartTitleOverlayChangedLabel)],[i.EventMethods.Visual.ChartTitleTextChanged,e=>lr(e,An.Intents.VisualChartTitleTextChangedLabel)],[i.EventMethods.Visual.LegendFillCleared,()=>An.Intents.VisualLegendFillClearedLabel],[i.EventMethods.Visual.LegendFillColored,e=>lr(e,An.Intents.VisualLegendFillColoredLabel,ir)],[i.EventMethods.Visual.LegendFontBolded,e=>lr(e,An.Intents.VisualLegendFontBoldedLabel)],[i.EventMethods.Visual.LegendFontColored,e=>lr(e,An.Intents.VisualLegendFontColoredLabel,ir)],[i.EventMethods.Visual.LegendFontItalicized,e=>lr(e,An.Intents.VisualLegendFontItalicizedLabel)],[i.EventMethods.Visual.LegendFontNamed,e=>lr(e,An.Intents.VisualLegendFontNamedLabel)],[i.EventMethods.Visual.LegendFontSized,e=>lr(e,An.Intents.VisualLegendFontSizedLabel)],[i.EventMethods.Visual.LegendFontUnderlined,e=>lr(e,An.Intents.VisualLegendFontUnderlinedLabel)],[i.EventMethods.Visual.LegendLineCleared,()=>An.Intents.VisualLegendLineClearedLabel],[i.EventMethods.Visual.LegendLineStyleChanged,()=>An.Intents.VisualLegendLineStyleChangedLabel],[i.EventMethods.Visual.LegendLineWeightChanged,()=>An.Intents.VisualLegendLineWeightChangedLabel],[i.EventMethods.Visual.LegendLineColored,e=>lr(e,An.Intents.VisualLegendLineColoredLabel,ir)],[i.EventMethods.Visual.LegendOverlayChanged,e=>lr(e,An.Intents.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.LegendPositionChanged,e=>lr(e,An.Intents.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinCount,e=>lr(e,An.Intents.VisualSeriesBinningOptionsBinCountLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinWidth,e=>lr(e,An.Intents.VisualSeriesBinningOptionsBinWidthLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinningType,e=>lr(e,An.Intents.VisualSeriesBinningOptionsBinningTypeLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowEnabled,e=>lr(e,An.Intents.VisualSeriesBinningOptionsOverflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowValue,e=>lr(e,An.Intents.VisualSeriesBinningOptionsOverflowValueLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowEnabled,e=>lr(e,An.Intents.VisualSeriesBinningOptionsUnderflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowValue,e=>lr(e,An.Intents.VisualSeriesBinningOptionsUnderflowValueLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerQuartileCalculation,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerQuartileCalculationLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowInnerPoints,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowInnerPointsLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanLine,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowMeanLineLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanMarker,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowMeanMarkerLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowOutliers,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowOutliersLabel)],[i.EventMethods.Visual.SeriesBubbleScaleSized,e=>lr(e,An.Intents.VisualSeriesBubbleScaleSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCategoryNameToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsCategoryNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCustomSeparatorChanged,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsLegendKeyToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsLegendKeyToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeparatorChanged,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeriesNameToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsSeriesNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsValueToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsValueToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsFillFormatColored,e=>lr(e,An.Intents.VisualSeriesDataLabelsFillFormatColoredLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatBolded,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatBoldedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatColored,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatColoredLabel,ir)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatItalicized,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatItaliizedcLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatNamed,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatNamedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatSized,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatUnderlined,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatUnderlinedLabel)],[i.EventMethods.Visual.SeriesDataLabelsLineFormatColored,e=>lr(e,An.Intents.VisualSeriesDataLabelsLineFormatColoredLabel,ir)],[i.EventMethods.Visual.SeriesDataLabelsNumberFormatCodeChanged,e=>lr(e,An.Intents.VisualSeriesDataLabelsNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsPositioned,e=>lr(e,An.Intents.VisualSeriesDataLabelsPositionedLabel)],[i.EventMethods.Visual.SeriesDoughnutHoleSized,e=>lr(e,An.Intents.VisualSeriesDoughnutHoleSizedLabel)],[i.EventMethods.Visual.SeriesFillColored,e=>lr(e,An.Intents.VisualSeriesFillColoredLabel,ir)],[i.EventMethods.Visual.SeriesGapWidthChanged,e=>lr(e,An.Intents.VisualSeriesGapWidthChangedLabel)],[i.EventMethods.Visual.SeriesLineColored,e=>lr(e,An.Intents.VisualSeriesLineColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersFillColored,e=>lr(e,An.Intents.VisualSeriesMakersFillColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersLineColored,e=>lr(e,An.Intents.VisualSeriesMakersLineColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersMarkerSized,e=>lr(e,An.Intents.VisualSeriesMakersMarkerSizedLabel)],[i.EventMethods.Visual.SeriesMarkersMarkerStyleChanged,e=>lr(e,An.Intents.VisualSeriesMakersMarkerStyleChangedLabel)],[i.EventMethods.Visual.SeriesNamed,e=>lr(e,An.Intents.VisualSeriesNamedLabel)],[i.EventMethods.Visual.SeriesTreemapParentLabelStrategy,e=>lr(e,An.Intents.VisualSeriesTreemapParentLabelStrategyLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>lr(e,An.Intents.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>lr(e,An.Intents.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesWaterfallShowConnectorLines,e=>lr(e,An.Intents.VisualSeriesWaterfallShowConnectorLinesLabel)],[i.EventMethods.Visual.SeriesTrendlineTypeSet,e=>lr(e,An.Intents.VisualSeriesTrendlineTypeSetLabel)],[i.EventMethods.Visual.SeriesTrendlineNameSet,e=>lr(e,An.Intents.VisualSeriesTrendlineNameChangedLabel)],[i.EventMethods.Visual.SeriesTrendlineEquationDisplayed,e=>lr(e,An.Intents.VisualSeriesTrendlineEquationDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineRSquaredDisplayed,e=>lr(e,An.Intents.VisualSeriesTrendlineRSquaredDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineInterceptSet,e=>lr(e,An.Intents.VisualSeriesTrendlineInterceptSetLabel)],[i.EventMethods.Visual.SeriesTrendlineIsCustomInterceptSet,e=>function(e){return e.parameters.newValue?An.substitute(An.Intents.VisualSeriesTrendlineManualSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):An.substitute(An.Intents.VisualSeriesTrendlineAutomaticSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index})}(e)],[i.EventMethods.Visual.SeriesTrendlineLineFormatColored,e=>lr(e,An.Intents.VisualSeriesTrendlineLineFormatColoredLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastForwardSet,e=>lr(e,An.Intents.VisualSeriesTrendlineForecastForwardSetLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastBackwardSet,e=>lr(e,An.Intents.VisualSeriesTrendlineForecastBackwardSetLabel)],[i.EventMethods.Visual.ChartTitleAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartTitleAddedLabel:An.Intents.VisualChartTitleRemovedLabel)],[i.EventMethods.Visual.LegendAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualLegendAddedLabel:An.Intents.VisualLegendRemovedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartAxisAxisTitleAddedLabel:An.Intents.VisualChartAxisAxisTitleRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartAxisGridlinesMajorGridlinesAddedLabel:An.Intents.VisualChartAxisGridlinesMajorGridlinesRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartAxisGridlinesMinorGridlinesAddedLabel:An.Intents.VisualChartAxisGridlinesMinorGridlinesRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarXAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualSeriesErrorBarXAddedLabel:An.Intents.VisualSeriesErrorBarXRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarYAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualSeriesErrorBarYAddedLabel:An.Intents.VisualSeriesErrorBarYRemovedLabel)],[i.EventMethods.Visual.SeriesTrendlineAddedRemoved,cr],[i.EventMethods.Visual.SeriesTrendlineTitleAddedRemoved,dr],[i.EventMethods.Visual.SeriesDataLabelsAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualSeriesDataLabelsAddedLabel:An.Intents.VisualSeriesDataLabelsRemovedLabel)],[i.EventMethods.Visual.ChartTitleFillCleared,()=>An.Intents.ChartTitleFillClearedLabel],[i.EventMethods.Visual.ChartTitleLineCleared,()=>An.Intents.ChartTitleLineClearedLabel],[i.EventMethods.Visual.ChartTitleLineStyleChanged,()=>An.Intents.ChartTitleLineStyleChangedLabel],[i.EventMethods.Visual.ChartTitleWeightChanged,()=>An.Intents.ChartTitleWeightChangedLabel],[i.EventMethods.Table.Created,jn],[i.EventMethods.Table.ColumnInserted,Yn],[i.EventMethods.Table.ColumnsDeleted,Xn],[i.EventMethods.Table.ColumnRearranged,()=>An.Intents.TableColumnsRearrangeLabel],[i.EventMethods.Table.RowInserted,Kn],[i.EventMethods.Table.RowsDeleted,Zn],[i.EventMethods.Table.FilterCleared,ao],[i.EventMethods.Table.FilterReapplied,no],[i.EventMethods.Table.ValuesFilterApplied,oo],[i.EventMethods.Table.CustomFilterApplied,ro],[i.EventMethods.Table.CustomSorted,io],[i.EventMethods.Table.SortCleared,lo],[i.EventMethods.Table.Top10FilterApplied,so],[i.EventMethods.Table.DynamicFilterApplied,co],[i.EventMethods.Table.ColumnSorted,eo],[i.EventMethods.Table.RowRearranged,()=>An.Intents.TableRowsRearrangeLabel],[i.EventMethods.Table.AutoFilterCleared,to],[i.EventMethods.Table.AutoFilterToggled,ar],[i.EventMethods.Table.TotalRowToggled,pr],[i.EventMethods.Table.HeaderRowToggled,br],[i.EventMethods.Table.Resized,fr],[i.EventMethods.Table.CreatedWithFormat,Cr],[i.EventMethods.Table.StyleApplied,Mr],[i.EventMethods.Table.BandedColumnsVisibilityChanged,$r],[i.EventMethods.Table.BandedRowsVisibilityChanged,Dr],[i.EventMethods.Table.FirstColumnHighlighted,Br],[i.EventMethods.Table.LastColumnHighlighted,Hr],[i.EventMethods.Table.FilterButtonVisibilityChanged,Ur],[i.EventMethods.Table.Renamed,pi],[i.EventMethods.Table.Converted,bi],[i.EventMethods.Table.AltTextEdited,fi],[i.EventMethods.Table.AltTextTitleEdited,Ci],[i.EventMethods.Table.AltTextDescriptionEdited,yi],[i.EventMethods.PivotChart.Created,()=>An.Intents.PivotChartCreateLabel],[i.EventMethods.PivotChart.OnNewSheetCreated,()=>An.Intents.PivotChartCreateLabel],[i.EventMethods.Font.Bolded,uo],[i.EventMethods.Font.MultiRangeBolded,mo],[i.EventMethods.Font.Italicized,po],[i.EventMethods.Font.MultiRangeItalicized,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatItalicizeLabel:An.Intents.MultiRangeFormatUnItalicizeLabel}(e)],[i.EventMethods.Font.Colored,bo],[i.EventMethods.Font.MultiRangeColored,fo],[i.EventMethods.Font.Named,Co],[i.EventMethods.Font.MultiRangeNamed,yo],[i.EventMethods.Font.Underlined,vo],[i.EventMethods.Font.MultiRangeUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatUnderlineLabel:An.Intents.MultiRangeFormatRemoveUnderlineLabel}(e)],[i.EventMethods.Font.DoubleUnderlined,To],[i.EventMethods.Font.MultiRangeDoubleUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatDoubleUnderlineLabel:An.Intents.MultiRangeFormatRemoveDoubleUnderlineLabel}(e)],[i.EventMethods.Font.Superscript,So],[i.EventMethods.Font.Subscript,wo],[i.EventMethods.Font.MultiRangeSuperscript,go],[i.EventMethods.Font.MultiRangeSubscript,ho],[i.EventMethods.Font.Superscript,So],[i.EventMethods.Font.MultiRangeSuperscript,go],[i.EventMethods.Font.StrikeThrough,xo],[i.EventMethods.Font.MultiRangeStrikeThrough,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatStrikethroughLabel:An.Intents.MultiRangeFormatRemoveStrikethroughLabel}(e)],[i.EventMethods.Font.UnderlineStyle,Io],[i.EventMethods.Font.Sized,Eo],[i.EventMethods.Font.MultiRangeSized,Ro],[i.EventMethods.Fill.Colored,Ao],[i.EventMethods.Fill.MultiRangeColored,Fo],[i.EventMethods.Fill.ColorCleared,Lo],[i.EventMethods.Fill.MultiRangeColorCleared,()=>An.Intents.MultiRangeClearBackgroundColorLabel],[i.EventMethods.Fill.Patterned,()=>An.Intents.RangeFillPatternAppliedLabel],[i.EventMethods.CellDimensions.ColumnWidthSet,_o],[i.EventMethods.CellDimensions.MultiRangeColumnWidthSet,No],[i.EventMethods.CellDimensions.RowHeightSet,ko],[i.EventMethods.CellDimensions.MultiRangeRowHeightSet,Oo],[i.EventMethods.CellDimensions.RowsHidden,Pi],[i.EventMethods.CellDimensions.MultiRangeRowsHidden,Di],[i.EventMethods.CellDimensions.ColumnsHidden,Mi],[i.EventMethods.CellDimensions.MultiRangeColumnsHidden,$i],[i.EventMethods.Border.BorderChanged,Po],[i.EventMethods.Border.MultiRangeBorderChanged,()=>An.Intents.MultiRangeApplyBorderLabel],[i.EventMethods.NamedSheetView.Created,()=>An.Intents.NamedSheetViewCreateLabel],[i.EventMethods.NamedSheetView.Deleted,Mo],[i.EventMethods.NamedSheetView.Duplicated,Do],[i.EventMethods.NamedSheetView.Exited,$o],[i.EventMethods.NamedSheetView.Kept,Bo],[i.EventMethods.NamedSheetView.Renamed,Ho],[i.EventMethods.NamedSheetView.Switched,Uo],[i.EventMethods.Paste.Range,qo],[i.EventMethods.Paste.MultiRange,Vo],[i.EventMethods.Paste.String,Go],[i.EventMethods.Paste.ArtSameWorkbook,ki],[i.EventMethods.Comment.Inserted,()=>An.Intents.CommentInsertLabel],[i.EventMethods.Comment.MultiRangeInserted,()=>An.Intents.CommentInsertLabel],[i.EventMethods.Comment.Edited,()=>An.Intents.CommentEditLabel],[i.EventMethods.Comment.MultiRangeEdited,()=>An.Intents.CommentEditLabel],[i.EventMethods.Comment.Deleted,()=>An.Intents.CommentDeleteLabel],[i.EventMethods.Comment.MultiRangeDeleted,()=>An.Intents.CommentDeleteLabel],[i.EventMethods.Reply.Inserted,()=>An.Intents.CommentInsertReplyLabel],[i.EventMethods.Reply.MultiRangeInserted,()=>An.Intents.CommentInsertReplyLabel],[i.EventMethods.Reply.Edited,()=>An.Intents.CommentEditReplyLabel],[i.EventMethods.Reply.MultiRangeEdited,()=>An.Intents.CommentEditReplyLabel],[i.EventMethods.Reply.Deleted,()=>An.Intents.CommentDeleteReplyLabel],[i.EventMethods.Reply.MultiRangeDeleted,()=>An.Intents.CommentDeleteReplyLabel],[i.EventMethods.Range.ReplacedAll,jo],[i.EventMethods.Workbook.ReplacedAll,jo],[i.EventMethods.Worksheet.ReplacedAll,jo],[i.EventMethods.Range.MultiRangeReplacedAll,Yo],[i.EventMethods.Worksheet.MultiRangeReplacedAll,Yo],[i.EventMethods.Workbook.MultiRangeReplacedAll,Yo],[i.EventMethods.Range.FoundNext,Jo],[i.EventMethods.Workbook.FoundNext,Jo],[i.EventMethods.Workbook.CalculationModeSet,()=>An.Intents.WorkbookSetCalculationModeLabel],[i.EventMethods.Workbook.Recalculated,()=>An.Intents.WorkbookRecalculateLabel],[i.EventMethods.Alignment.HorizontalAlignmentSet,Xo],[i.EventMethods.Alignment.MultiRangeHorizontalAlignmentSet,()=>An.Intents.MultiRangeSetHorizontalAlignmentLabel],[i.EventMethods.Alignment.VerticalAlignmentSet,Ko],[i.EventMethods.Alignment.MultiRangeVerticalAlignmentSet,()=>An.Intents.MultiRangeSetVerticalAlignmentLabel],[i.EventMethods.CellText.WrapChanged,Zo],[i.EventMethods.CellText.MultiRangeWrapChanged,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeWrapTextLabel:An.Intents.MultiRangeUnwrapTextLabel}(e)],[i.EventMethods.Indent.Set,er],[i.EventMethods.Indent.Incremented,er],[i.EventMethods.Indent.MultiRangeSet,()=>An.Intents.MultiRangeChangeIndentLabel],[i.EventMethods.ConditionalFormatting.CreatedGroup,Bi],[i.EventMethods.ConditionalFormatting.CellValueCreated,Ui],[i.EventMethods.ConditionalFormatting.CustomCreated,qi],[i.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,Gi],[i.EventMethods.ConditionalFormatting.DataBarCustomCreated,Wi],[i.EventMethods.ConditionalFormatting.DatesCreated,Ji],[i.EventMethods.ConditionalFormatting.IconSetCreated,zi],[i.EventMethods.ConditionalFormatting.PresetCreated,Qi],[i.EventMethods.ConditionalFormatting.TextComparisonCreated,Vi],[i.EventMethods.ConditionalFormatting.TopBottomCreated,Yi],[i.EventMethods.ConditionalFormatting.UniqueCreated,ji],[i.EventMethods.ConditionalFormatting.EditedGroup,Xi],[i.EventMethods.ConditionalFormatting.Deleted,el],[i.EventMethods.ConditionalFormatting.RuleDeleted,Ki],[i.EventMethods.ConditionalFormatting.PriorityEdited,Zi],[i.EventMethods.Workbook.RefreshedAll,()=>An.Intents.WorkbookRefreshAllLabel],[i.EventMethods.Workbook.ExternalLinksRefreshed,()=>An.Intents.ExternalLinksRefreshedLabel],[i.EventMethods.Workbook.ExternalLinksRefreshedAll,()=>An.Intents.ExternalLinksRefreshedAllLabel],[i.EventMethods.Workbook.ExternalLinksBrokeLink,()=>An.Intents.ExternalLinksBrokeLinkLabel],[i.EventMethods.Workbook.ExternalLinksBrokeAllLinks,()=>An.Intents.ExternalLinksBrokeAllLinksLabel],[i.EventMethods.Workbook.ExternalLinksSetAutoRefresh,()=>An.Intents.ExternalLinksSetAutoRefreshLabel],[i.EventMethods.Workbook.ExternalLinksChangedSource,()=>An.Intents.ExternalLinksChangedSourceLabel],[i.EventMethods.PageLayout.AddedToPrintArea,()=>An.Intents.PageLayoutAddedToPrintAreaLabel],[i.EventMethods.PageLayout.OrientationChanged,()=>An.Intents.PageLayoutOrientationChangedLabel],[i.EventMethods.PageLayout.PageBreakInserted,()=>An.Intents.PageLayoutPageBreakInsertedLabel],[i.EventMethods.PageLayout.PageBreakRemoved,()=>An.Intents.PageLayoutPageBreakRemovedLabel],[i.EventMethods.PageLayout.PageBreaksAllReset,()=>An.Intents.PageLayoutPageBreaksAllResetLabel],[i.EventMethods.PageLayout.PaperSizeChanged,()=>An.Intents.PageLayoutPaperSizeChangedLabel],[i.EventMethods.PageLayout.PrintAreaCleared,()=>An.Intents.PageLayoutPrintAreaClearedLabel],[i.EventMethods.PageLayout.PrintAreaSet,()=>An.Intents.PageLayoutPrintAreaSetLabel],[i.EventMethods.PageLayout.PrintSettingsChanged,()=>An.Intents.PageLayoutPrintSettingsChangedLabel],[i.EventMethods.PageLayout.ScalingChanged,()=>An.Intents.PageLayoutScalingChangedLabel],[i.EventMethods.AllowEditRange.Added,il],[i.EventMethods.AllowEditRange.Deleted,ll],[i.EventMethods.AllowEditRange.Edited,sl],[i.EventMethods.SheetProtection.OptionsUpdated,cl],[i.EventMethods.SheetProtection.PasswordUpdated,dl],[i.EventMethods.SheetProtection.Paused,ul],[i.EventMethods.SheetProtection.Resumed,gl],[i.EventMethods.SheetProtection.Protected,ml],[i.EventMethods.SheetProtection.Unprotected,hl],[i.EventMethods.CellText.OrientationChanged,Ln],[i.EventMethods.CellText.MultiRangeOrientationChanged,()=>An.Intents.CellTextOrientationChangedGeneric],[i.EventMethods.Chart.Renamed,()=>An.Intents.ChartRenamed],[i.EventMethods.Comment.Resolved,()=>An.Intents.CommentResolved],[i.EventMethods.Table.Deleted,()=>An.Intents.TableDeleted],[i.EventMethods.Worksheet.Calculated,()=>An.Intents.WorksheetCalculated],[i.EventMethods.Intent.ChangeRangeBorder,()=>An.Intents.IntentChangeRangeBorder],[i.EventMethods.Intent.CreateConditionalFormatColorScale,()=>An.Intents.IntentCreateConditionalFormatColorScale],[i.EventMethods.Intent.CreateConditionalFormatDataBar,()=>An.Intents.IntentCreateConditionalFormatDataBar],[i.EventMethods.Intent.RangeCopyFrom,()=>An.Intents.IntentRangeCopyFrom],[i.EventMethods.Intent.CreateConditionalFormatCellValue,()=>An.Intents.IntentCreateConditionalFormatCellValue],[i.EventMethods.Intent.CreateConditionalFormatPreset,()=>An.Intents.IntentCreateConditionalFormatPreset],[i.EventMethods.Intent.CreateConditionalFormatContainsText,()=>An.Intents.IntentCreateConditionalFormatContainsText],[i.EventMethods.Intent.CreateConditionalFormatTopBottom,()=>An.Intents.IntentCreateConditionalFormatTopBottom],[i.EventMethods.Intent.CreateConditionalFormatCustom,()=>An.Intents.IntentCreateConditionalFormatCustom],[i.EventMethods.Intent.CreateConditionalFormatIconSet,()=>An.Intents.IntentCreateConditionalFormatIconSet],[i.EventMethods.System.Undo,()=>An.Intents.UndoLabel],[i.EventMethods.System.Redo,()=>An.Intents.RedoLabel],[i.EventMethods.System.Unknown,()=>An.Intents.UnknownEventLabel],[i.EventMethods.System.Unsupported,()=>An.Intents.UnsupportedEventLabel],[i.EventMethods.System.InProgress,()=>An.Intents.InProgressEventLabel],[i.EventMethods.System.Undefined,()=>An.Intents.UnknownEventLabel],[i.EventMethods.Error.Alias,()=>An.Intents.ErrorAliasInfo],[i.EventMethods.Error.Unknown,()=>An.Intents.ErrorUnknown],[i.EventMethods.Error.UpstreamExceptionOccured,()=>An.Intents.ErrorUnknown]]),yl=new Map([[i.EventMethods.Worksheet.Added,()=>ExcelCopilotCommandingHitlStrings.WorksheetAddLabel],[i.EventMethods.Worksheet.AddedWithName,F],[i.EventMethods.Worksheet.Deleted,()=>ExcelCopilotCommandingHitlStrings.WorksheetDeleteLabel],[i.EventMethods.Worksheet.MultiSheetDeleted,N],[i.EventMethods.Worksheet.Renamed,_],[i.EventMethods.Worksheet.Duplicated,Ge],[i.EventMethods.Worksheet.FilterReapplied,We],[i.EventMethods.Worksheet.AutoFilterCleared,ze],[i.EventMethods.Worksheet.Reordered,et],[i.EventMethods.Worksheet.AutoFilterToggled,at],[i.EventMethods.Worksheet.GridlinesToggled,mt],[i.EventMethods.Worksheet.HeadingsToggled,ut],[i.EventMethods.Worksheet.TabColored,Ct],[i.EventMethods.Worksheet.PaneFrozen,Ut],[i.EventMethods.Worksheet.ColumnsFrozen,()=>ExcelCopilotCommandingHitlStrings.WorksheetFreezeColumnsLabel],[i.EventMethods.Worksheet.RowsFrozen,()=>ExcelCopilotCommandingHitlStrings.WorksheetFreezeRowsLabel],[i.EventMethods.Worksheet.OutlineLevelsShown,da],[i.EventMethods.Worksheet.ValuesFilterApplied,Aa],[i.EventMethods.Worksheet.CustomFilterApplied,La],[i.EventMethods.Worksheet.DynamicFilterApplied,Fa],[i.EventMethods.Worksheet.VisibilityChanged,()=>ExcelCopilotCommandingHitlStrings.WorksheetVisibilityChangedLabel],[i.EventMethods.Worksheet.MoveToEdge,()=>ExcelCopilotCommandingHitlStrings.MoveToEdgeLabel],[i.EventMethods.Intent.CreateNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.CreateNamedItem],[i.EventMethods.Intent.CreateNamedItemOnWorksheet,()=>ExcelCopilotCommandingHitlStrings.CreateNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.SetNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorksheet,()=>ExcelCopilotCommandingHitlStrings.SetNamedItem],[i.EventMethods.Intent.DeleteNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.DeleteNamedItem],[i.EventMethods.Intent.RangeSetIndent,()=>ExcelCopilotCommandingHitlStrings.ChangeRangeIndent],[i.EventMethods.Intent.RangeAdjustIndent,()=>ExcelCopilotCommandingHitlStrings.ChangeRangeIndent],[i.EventMethods.Range.Edited,k],[i.EventMethods.Range.SingleValueEdited,O],[i.EventMethods.Range.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.MultiRangeEditLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.MultiRangeDeleteLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.MultiRangeDeleteLabel],[i.EventMethods.Range.Cleared,P],[i.EventMethods.Range.MultiRangeCleared,()=>ExcelCopilotCommandingHitlStrings.MultiRangeClearLabel],[i.EventMethods.Range.Deleted,M],[i.EventMethods.Range.Inserted,D],[i.EventMethods.Range.Merged,$],[i.EventMethods.Range.MultiRangeMerged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeMergeLabel],[i.EventMethods.Range.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.MultipleRangeInsertLabel],[i.EventMethods.Range.Unmerged,B],[i.EventMethods.Range.MultiRangeUnmerged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeUnmergeLabel],[i.EventMethods.Range.ColumnsAutoFit,H],[i.EventMethods.Range.MultiRangeColumnsAutoFit,H],[i.EventMethods.Range.RowsAutoFit,U],[i.EventMethods.Range.UseStandardHeight,q],[i.EventMethods.Range.UseStandardWidth,V],[i.EventMethods.Range.MultiRangeRowsAutoFit,U],[i.EventMethods.Range.HyperlinkApplied,G],[i.EventMethods.Range.HyperlinkRemoved,W],[i.EventMethods.Range.MultiRangeHyperlinkRemoved,()=>ExcelCopilotCommandingHitlStrings.MultiRangeRemoveHyperlinkLabel],[i.EventMethods.Range.NumberFormatChanged,z],[i.EventMethods.Range.MultiRangeNumberFormatChanged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeNumberFormatLabel],[i.EventMethods.Range.InsertCopiedCutCells,Q],[i.EventMethods.Range.InsertCopiedCutCellsInTable,e=>function(e){const t=e.parameters.destinationTableRange.subRangeValues;return 0===e.parameters.copyCutOperation?A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCopyInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex}):A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCutInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex})}(e)],[i.EventMethods.Range.Filled,J],[i.EventMethods.Range.DuplicatesRemoved,gt],[i.EventMethods.Range.FlashFilled,xt],[i.EventMethods.Range.Grouped,sa],[i.EventMethods.Range.Ungrouped,ca],[i.EventMethods.Range.GroupDetailsShown,ua],[i.EventMethods.Range.GroupDetailsHidden,ma],[i.EventMethods.Range.Sorted,_a],[i.EventMethods.Range.DataValidationChangedGroup,ga],[i.EventMethods.Range.AutoSum,ka],[i.EventMethods.Range.CellStyleApplied,an],[i.EventMethods.Range.MultiRangeCellStyleApplied,()=>ExcelCopilotCommandingHitlStrings.MultiRangeCellStyleAppliedLabel],[i.EventMethods.Range.CustomSorted,on],[i.EventMethods.Range.AutoFilterCustomSorted,rn],[i.EventMethods.Range.TextToColumns,ln],[i.EventMethods.Range.FixedWidthTextToColumns,()=>ExcelCopilotCommandingHitlStrings.FixedWidthTextToColumns],[i.EventMethods.Intent.SetDataValidation,()=>ExcelCopilotCommandingHitlStrings.IntentSetDataValidation],[i.EventMethods.Shape.Inserted,qt],[i.EventMethods.Shape.StyleSet,Vt],[i.EventMethods.Shape.Deleted,Qt],[i.EventMethods.Shape.MovedAndResized,jt],[i.EventMethods.Shape.ZOrderChanged,Yt],[i.EventMethods.Shape.Rotated,Xt],[i.EventMethods.Shape.AltTextApplied,Kt],[i.EventMethods.Shape.PictureInserted,nn],[i.EventMethods.Shape.TextChanged,Zt],[i.EventMethods.Shape.TextBolded,ea],[i.EventMethods.Shape.TextItalicized,ta],[i.EventMethods.Shape.TextUnderlined,aa],[i.EventMethods.Shape.TextFontNameChanged,na],[i.EventMethods.Shape.TextFontSizeChanged,oa],[i.EventMethods.Shape.TextFontColorChanged,ra],[i.EventMethods.Shape.TextHorizontallyAligned,ia],[i.EventMethods.Shape.TextVerticallyAligned,la],[i.EventMethods.PivotTable.Created,()=>ExcelCopilotCommandingHitlStrings.PivotTableCreateLabel],[i.EventMethods.PivotTable.SortApplied,()=>ExcelCopilotCommandingHitlStrings.PivotTableSortLabel],[i.EventMethods.PivotTable.PivotPositionChanged,()=>ExcelCopilotCommandingHitlStrings.PivotTableChangePositionLabel],[i.EventMethods.PivotTable.CreatedOnNewSheet,()=>ExcelCopilotCommandingHitlStrings.PivotTableCreateLabel],[i.EventMethods.PivotTable.PivotRemoved,Ta],[i.EventMethods.PivotTable.PivotAdded,va],[i.EventMethods.PivotTable.PivotAdded,va],[i.EventMethods.PivotTable.Pivoted,ya],[i.EventMethods.PivotTable.Refreshed,xa],[i.EventMethods.PivotTable.PivotDrillToggled,Sa],[i.EventMethods.PivotTable.Renamed,wa],[i.EventMethods.PivotTable.RowGrandTotalShown,Ea],[i.EventMethods.PivotTable.ColumnGrandTotalShown,Ra],[i.EventMethods.PivotTable.AutoFitColumnWidthsOnRefreshToggled,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableAutoFitColumnWidthsOnRefreshToggledLabel,{pivotName:e.parameters.pivotName,value:e.parameters.value})}(e)],[i.EventMethods.PivotTable.SubTotalsVisibilitySettingSet,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableSubTotalsVisibilitySettingSetLabel,{pivotName:e.parameters.pivotName})}(e)],[i.EventMethods.PivotTable.LayoutTypeSet,Ia],[i.EventMethods.Slicer.Inserted,nt],[i.EventMethods.Chart.Created,ot],[i.EventMethods.Chart.MultiRangeCreated,dt],[i.EventMethods.Chart.RowColumnSwitched,yt],[i.EventMethods.Chart.DataSelected,vt],[i.EventMethods.Chart.TypeChanged,Tt],[i.EventMethods.Chart.TitleChanged,St],[i.EventMethods.Chart.TitleTextChanged,Lt],[i.EventMethods.Chart.TitleHidden,wt],[i.EventMethods.Chart.AxisTitleChanged,Et],[i.EventMethods.Chart.AxisTitleHidden,Rt],[i.EventMethods.Chart.AxisTitleTextChanged,At],[i.EventMethods.Chart.AxisTitleHorizontal,()=>ExcelCopilotCommandingHitlStrings.ChartAxisTitleHorizontal],[i.EventMethods.Chart.AxisTitleVertical,()=>ExcelCopilotCommandingHitlStrings.ChartAxisTitleVertical],[i.EventMethods.Chart.LegendChanged,It],[i.EventMethods.Chart.LegendHidden,Ft],[i.EventMethods.Chart.DataLabelPositionChanged,_t],[i.EventMethods.Chart.DataLabelVisibilityChanged,Nt],[i.EventMethods.Chart.GridlinesVisibilityChanged,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeGridlineVisiblityLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}(e)],[i.EventMethods.Chart.AxisChanged,kt],[i.EventMethods.Chart.AxisVisiblityChanged,Ot],[i.EventMethods.Chart.Deleted,Gt],[i.EventMethods.Chart.MovedAndResized,Jt],[i.EventMethods.Chart.SeriesDeleted,Wt],[i.EventMethods.Chart.SeriesDataChanged,zt],[i.EventMethods.ChartFormat.SetGetProperties,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartFormatSetGetPropertiesLabel,{count:e.parameters.events.length,chartName:e.parameters.events[0].parameters.chartName})}(e)],[i.EventMethods.Visual.ChartAxisAxisTitleFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFillColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontNamedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontSizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleTextChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleTextChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMaxChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisBoundsMaxChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMinChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisBoundsMinChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesAtChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisCrossesAtChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisCrossesChangedLabel)],[i.EventMethods.Visual.ChartAxisFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFillColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontNamedLabel)],[i.EventMethods.Visual.ChartAxisFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontSizedLabel)],[i.EventMethods.Visual.ChartAxisFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisMajorGridlinesLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisMinorGridlinesLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisNumberFormatCodeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.ChartAxisReversePlotOrderChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisReversePlotOrderChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMajorTypeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisTickMarksMajorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMinorTypeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisTickMarksMinorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMajorUnitChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisUnitsMajorUnitChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMinorUnitChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisUnitsMinorUnitChangedLabel)],[i.EventMethods.Visual.ChartTitleFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFillColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartTitleFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartTitleFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontNamedLabel)],[i.EventMethods.Visual.ChartTitleFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontSizedLabel)],[i.EventMethods.Visual.ChartTitleFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartTitleLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleLineColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleOverlayChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleOverlayChangedLabel)],[i.EventMethods.Visual.ChartTitleTextChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleTextChangedLabel)],[i.EventMethods.Visual.LegendFillCleared,()=>ExcelCopilotCommandingHitlStrings.VisualLegendFillClearedLabel],[i.EventMethods.Visual.LegendFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFillColoredLabel,rt)],[i.EventMethods.Visual.LegendFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontBoldedLabel)],[i.EventMethods.Visual.LegendFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontColoredLabel,rt)],[i.EventMethods.Visual.LegendFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontItalicizedLabel)],[i.EventMethods.Visual.LegendFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontNamedLabel)],[i.EventMethods.Visual.LegendFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontSizedLabel)],[i.EventMethods.Visual.LegendFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontUnderlinedLabel)],[i.EventMethods.Visual.LegendLineCleared,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineClearedLabel],[i.EventMethods.Visual.LegendLineStyleChanged,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineStyleChangedLabel],[i.EventMethods.Visual.LegendLineWeightChanged,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineWeightChangedLabel],[i.EventMethods.Visual.LegendLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendLineColoredLabel,rt)],[i.EventMethods.Visual.LegendOverlayChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.LegendPositionChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinCount,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinCountLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinWidth,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinWidthLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinningType,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinningTypeLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowEnabled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsOverflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowValue,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsOverflowValueLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowEnabled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsUnderflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowValue,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsUnderflowValueLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerQuartileCalculation,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerQuartileCalculationLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowInnerPoints,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowInnerPointsLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanLine,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowMeanLineLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanMarker,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowMeanMarkerLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowOutliers,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowOutliersLabel)],[i.EventMethods.Visual.SeriesBubbleScaleSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBubbleScaleSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCategoryNameToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsCategoryNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCustomSeparatorChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsLegendKeyToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsLegendKeyToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeparatorChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeriesNameToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsSeriesNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsValueToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsValueToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsFillFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFillFormatColoredLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatBoldedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatColoredLabel,rt)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatItaliizedcLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatNamedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatUnderlinedLabel)],[i.EventMethods.Visual.SeriesDataLabelsLineFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsLineFormatColoredLabel,rt)],[i.EventMethods.Visual.SeriesDataLabelsNumberFormatCodeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsPositioned,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsPositionedLabel)],[i.EventMethods.Visual.SeriesDoughnutHoleSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDoughnutHoleSizedLabel)],[i.EventMethods.Visual.SeriesFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesFillColoredLabel,rt)],[i.EventMethods.Visual.SeriesGapWidthChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesGapWidthChangedLabel)],[i.EventMethods.Visual.SeriesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesLineColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersFillColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersLineColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersMarkerSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersMarkerSizedLabel)],[i.EventMethods.Visual.SeriesMarkersMarkerStyleChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersMarkerStyleChangedLabel)],[i.EventMethods.Visual.SeriesNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesNamedLabel)],[i.EventMethods.Visual.SeriesTreemapParentLabelStrategy,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTreemapParentLabelStrategyLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesWaterfallShowConnectorLines,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesWaterfallShowConnectorLinesLabel)],[i.EventMethods.Visual.SeriesTrendlineTypeSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTypeSetLabel)],[i.EventMethods.Visual.SeriesTrendlineNameSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineNameChangedLabel)],[i.EventMethods.Visual.SeriesTrendlineEquationDisplayed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineEquationDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineRSquaredDisplayed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineRSquaredDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineInterceptSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineInterceptSetLabel)],[i.EventMethods.Visual.SeriesTrendlineIsCustomInterceptSet,e=>function(e){return e.parameters.newValue?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineManualSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineAutomaticSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index})}(e)],[i.EventMethods.Visual.SeriesTrendlineLineFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineLineFormatColoredLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastForwardSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineForecastForwardSetLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastBackwardSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineForecastBackwardSetLabel)],[i.EventMethods.Visual.ChartTitleAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartTitleAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartTitleRemovedLabel)],[i.EventMethods.Visual.LegendAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualLegendAddedLabel:ExcelCopilotCommandingHitlStrings.VisualLegendRemovedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMajorGridlinesAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMajorGridlinesRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMinorGridlinesAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMinorGridlinesRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarXAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarXAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarXRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarYAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarYAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarYRemovedLabel)],[i.EventMethods.Visual.SeriesTrendlineAddedRemoved,st],[i.EventMethods.Visual.SeriesTrendlineTitleAddedRemoved,ct],[i.EventMethods.Visual.SeriesDataLabelsAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsRemovedLabel)],[i.EventMethods.Visual.ChartTitleFillCleared,()=>ExcelCopilotCommandingHitlStrings.ChartTitleFillClearedLabel],[i.EventMethods.Visual.ChartTitleLineCleared,()=>ExcelCopilotCommandingHitlStrings.ChartTitleLineClearedLabel],[i.EventMethods.Visual.ChartTitleLineStyleChanged,()=>ExcelCopilotCommandingHitlStrings.ChartTitleLineStyleChangedLabel],[i.EventMethods.Visual.ChartTitleWeightChanged,()=>ExcelCopilotCommandingHitlStrings.ChartTitleWeightChangedLabel],[i.EventMethods.Table.Created,j],[i.EventMethods.Table.ColumnInserted,Y],[i.EventMethods.Table.ColumnsDeleted,X],[i.EventMethods.Table.ColumnRearranged,()=>ExcelCopilotCommandingHitlStrings.TableColumnsRearrangeLabel],[i.EventMethods.Table.RowInserted,K],[i.EventMethods.Table.RowsDeleted,Z],[i.EventMethods.Table.FilterCleared,ae],[i.EventMethods.Table.FilterReapplied,ne],[i.EventMethods.Table.ValuesFilterApplied,oe],[i.EventMethods.Table.CustomFilterApplied,re],[i.EventMethods.Table.CustomSorted,ie],[i.EventMethods.Table.SortCleared,le],[i.EventMethods.Table.Top10FilterApplied,se],[i.EventMethods.Table.DynamicFilterApplied,ce],[i.EventMethods.Table.ColumnSorted,ee],[i.EventMethods.Table.RowRearranged,()=>ExcelCopilotCommandingHitlStrings.TableRowsRearrangeLabel],[i.EventMethods.Table.AutoFilterCleared,te],[i.EventMethods.Table.AutoFilterToggled,tt],[i.EventMethods.Table.TotalRowToggled,ht],[i.EventMethods.Table.HeaderRowToggled,pt],[i.EventMethods.Table.Resized,bt],[i.EventMethods.Table.CreatedWithFormat,ft],[i.EventMethods.Table.StyleApplied,Pt],[i.EventMethods.Table.BandedColumnsVisibilityChanged,Dt],[i.EventMethods.Table.BandedRowsVisibilityChanged,Mt],[i.EventMethods.Table.FirstColumnHighlighted,$t],[i.EventMethods.Table.LastColumnHighlighted,Bt],[i.EventMethods.Table.FilterButtonVisibilityChanged,Ht],[i.EventMethods.Table.Renamed,ha],[i.EventMethods.Table.Converted,pa],[i.EventMethods.Table.AltTextEdited,ba],[i.EventMethods.Table.AltTextTitleEdited,fa],[i.EventMethods.Table.AltTextDescriptionEdited,Ca],[i.EventMethods.PivotChart.Created,()=>ExcelCopilotCommandingHitlStrings.PivotChartCreateLabel],[i.EventMethods.PivotChart.OnNewSheetCreated,()=>ExcelCopilotCommandingHitlStrings.PivotChartCreateLabel],[i.EventMethods.Font.Bolded,de],[i.EventMethods.Font.MultiRangeBolded,ue],[i.EventMethods.Font.Italicized,he],[i.EventMethods.Font.MultiRangeItalicized,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatItalicizeLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnItalicizeLabel}(e)],[i.EventMethods.Font.Colored,pe],[i.EventMethods.Font.MultiRangeColored,be],[i.EventMethods.Font.Named,fe],[i.EventMethods.Font.MultiRangeNamed,Ce],[i.EventMethods.Font.Underlined,ye],[i.EventMethods.Font.MultiRangeUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnderlineLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveUnderlineLabel}(e)],[i.EventMethods.Font.DoubleUnderlined,ve],[i.EventMethods.Font.MultiRangeDoubleUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatDoubleUnderlineLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveDoubleUnderlineLabel}(e)],[i.EventMethods.Font.Superscript,xe],[i.EventMethods.Font.Subscript,Se],[i.EventMethods.Font.MultiRangeSuperscript,me],[i.EventMethods.Font.MultiRangeSubscript,ge],[i.EventMethods.Font.Superscript,xe],[i.EventMethods.Font.MultiRangeSuperscript,me],[i.EventMethods.Font.StrikeThrough,Te],[i.EventMethods.Font.MultiRangeStrikeThrough,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatStrikethroughLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveStrikethroughLabel}(e)],[i.EventMethods.Font.UnderlineStyle,Re],[i.EventMethods.Font.Sized,we],[i.EventMethods.Font.MultiRangeSized,Ee],[i.EventMethods.Fill.Colored,Ie],[i.EventMethods.Fill.MultiRangeColored,Le],[i.EventMethods.Fill.ColorCleared,Ae],[i.EventMethods.Fill.MultiRangeColorCleared,()=>ExcelCopilotCommandingHitlStrings.MultiRangeClearBackgroundColorLabel],[i.EventMethods.Fill.Patterned,()=>ExcelCopilotCommandingHitlStrings.RangeFillPatternAppliedLabel],[i.EventMethods.CellDimensions.ColumnWidthSet,Fe],[i.EventMethods.CellDimensions.MultiRangeColumnWidthSet,_e],[i.EventMethods.CellDimensions.RowHeightSet,Ne],[i.EventMethods.CellDimensions.MultiRangeRowHeightSet,ke],[i.EventMethods.CellDimensions.RowsHidden,Oa],[i.EventMethods.CellDimensions.MultiRangeRowsHidden,Ma],[i.EventMethods.CellDimensions.ColumnsHidden,Pa],[i.EventMethods.CellDimensions.MultiRangeColumnsHidden,Da],[i.EventMethods.Border.BorderChanged,Oe],[i.EventMethods.Border.MultiRangeBorderChanged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeApplyBorderLabel],[i.EventMethods.NamedSheetView.Created,()=>ExcelCopilotCommandingHitlStrings.NamedSheetViewCreateLabel],[i.EventMethods.NamedSheetView.Deleted,Pe],[i.EventMethods.NamedSheetView.Duplicated,Me],[i.EventMethods.NamedSheetView.Exited,De],[i.EventMethods.NamedSheetView.Kept,$e],[i.EventMethods.NamedSheetView.Renamed,Be],[i.EventMethods.NamedSheetView.Switched,He],[i.EventMethods.Paste.Range,Ue],[i.EventMethods.Paste.MultiRange,qe],[i.EventMethods.Paste.String,Ve],[i.EventMethods.Paste.ArtSameWorkbook,Na],[i.EventMethods.Comment.Inserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertLabel],[i.EventMethods.Comment.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertLabel],[i.EventMethods.Comment.Edited,()=>ExcelCopilotCommandingHitlStrings.CommentEditLabel],[i.EventMethods.Comment.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.CommentEditLabel],[i.EventMethods.Comment.Deleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteLabel],[i.EventMethods.Comment.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteLabel],[i.EventMethods.Reply.Inserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertReplyLabel],[i.EventMethods.Reply.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertReplyLabel],[i.EventMethods.Reply.Edited,()=>ExcelCopilotCommandingHitlStrings.CommentEditReplyLabel],[i.EventMethods.Reply.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.CommentEditReplyLabel],[i.EventMethods.Reply.Deleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteReplyLabel],[i.EventMethods.Reply.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteReplyLabel],[i.EventMethods.Range.ReplacedAll,Je],[i.EventMethods.Workbook.ReplacedAll,Je],[i.EventMethods.Worksheet.ReplacedAll,Je],[i.EventMethods.Range.MultiRangeReplacedAll,je],[i.EventMethods.Worksheet.MultiRangeReplacedAll,je],[i.EventMethods.Workbook.MultiRangeReplacedAll,je],[i.EventMethods.Range.FoundNext,Qe],[i.EventMethods.Workbook.FoundNext,Qe],[i.EventMethods.Workbook.CalculationModeSet,()=>ExcelCopilotCommandingHitlStrings.WorkbookSetCalculationModeLabel],[i.EventMethods.Workbook.Recalculated,()=>ExcelCopilotCommandingHitlStrings.WorkbookRecalculateLabel],[i.EventMethods.Alignment.HorizontalAlignmentSet,Ye],[i.EventMethods.Alignment.MultiRangeHorizontalAlignmentSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeSetHorizontalAlignmentLabel],[i.EventMethods.Alignment.VerticalAlignmentSet,Xe],[i.EventMethods.Alignment.MultiRangeVerticalAlignmentSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeSetVerticalAlignmentLabel],[i.EventMethods.CellText.WrapChanged,Ke],[i.EventMethods.CellText.MultiRangeWrapChanged,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeWrapTextLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnwrapTextLabel}(e)],[i.EventMethods.Indent.Set,Ze],[i.EventMethods.Indent.Incremented,Ze],[i.EventMethods.Indent.MultiRangeSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeChangeIndentLabel],[i.EventMethods.ConditionalFormatting.CreatedGroup,$a],[i.EventMethods.ConditionalFormatting.EditedGroup,Ka],[i.EventMethods.ConditionalFormatting.Deleted,tn],[i.EventMethods.ConditionalFormatting.RuleDeleted,Za],[i.EventMethods.Workbook.RefreshedAll,()=>ExcelCopilotCommandingHitlStrings.WorkbookRefreshAllLabel],[i.EventMethods.Workbook.ExternalLinksRefreshed,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksRefreshedLabel],[i.EventMethods.Workbook.ExternalLinksRefreshedAll,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksRefreshedAllLabel],[i.EventMethods.Workbook.ExternalLinksBrokeLink,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksBrokeLinkLabel],[i.EventMethods.Workbook.ExternalLinksBrokeAllLinks,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksBrokeAllLinksLabel],[i.EventMethods.Workbook.ExternalLinksSetAutoRefresh,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksSetAutoRefreshLabel],[i.EventMethods.Workbook.ExternalLinksChangedSource,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksChangedSourceLabel],[i.EventMethods.PageLayout.AddedToPrintArea,()=>ExcelCopilotCommandingHitlStrings.PageLayoutAddedToPrintAreaLabel],[i.EventMethods.PageLayout.OrientationChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutOrientationChangedLabel],[i.EventMethods.PageLayout.PageBreakInserted,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreakInsertedLabel],[i.EventMethods.PageLayout.PageBreakRemoved,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreakRemovedLabel],[i.EventMethods.PageLayout.PageBreaksAllReset,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreaksAllResetLabel],[i.EventMethods.PageLayout.PaperSizeChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPaperSizeChangedLabel],[i.EventMethods.PageLayout.PrintAreaCleared,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintAreaClearedLabel],[i.EventMethods.PageLayout.PrintAreaSet,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintAreaSetLabel],[i.EventMethods.PageLayout.PrintSettingsChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintSettingsChangedLabel],[i.EventMethods.PageLayout.ScalingChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutScalingChangedLabel],[i.EventMethods.AllowEditRange.Added,sn],[i.EventMethods.AllowEditRange.Deleted,cn],[i.EventMethods.AllowEditRange.Edited,dn],[i.EventMethods.SheetProtection.OptionsUpdated,un],[i.EventMethods.SheetProtection.PasswordUpdated,mn],[i.EventMethods.SheetProtection.Paused,gn],[i.EventMethods.SheetProtection.Resumed,pn],[i.EventMethods.SheetProtection.Protected,hn],[i.EventMethods.SheetProtection.Unprotected,bn],[i.EventMethods.CellText.OrientationChanged,L],[i.EventMethods.CellText.MultiRangeOrientationChanged,()=>ExcelCopilotCommandingHitlStrings.CellTextOrientationChangedGeneric],[i.EventMethods.Chart.Renamed,()=>ExcelCopilotCommandingHitlStrings.ChartRenamed],[i.EventMethods.Comment.Resolved,()=>ExcelCopilotCommandingHitlStrings.CommentResolved],[i.EventMethods.Table.Deleted,()=>ExcelCopilotCommandingHitlStrings.TableDeleted],[i.EventMethods.Worksheet.Calculated,()=>ExcelCopilotCommandingHitlStrings.WorksheetCalculated],[i.EventMethods.Intent.ChangeRangeBorder,()=>ExcelCopilotCommandingHitlStrings.IntentChangeRangeBorder],[i.EventMethods.Intent.CreateConditionalFormatColorScale,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatColorScale],[i.EventMethods.Intent.CreateConditionalFormatDataBar,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatDataBar],[i.EventMethods.Intent.RangeCopyFrom,()=>ExcelCopilotCommandingHitlStrings.IntentRangeCopyFrom],[i.EventMethods.Intent.CreateConditionalFormatCellValue,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCellValue],[i.EventMethods.Intent.CreateConditionalFormatPreset,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatPreset],[i.EventMethods.Intent.CreateConditionalFormatContainsText,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatContainsText],[i.EventMethods.Intent.CreateConditionalFormatTopBottom,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatTopBottom],[i.EventMethods.Intent.CreateConditionalFormatCustom,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCustom],[i.EventMethods.Intent.CreateConditionalFormatIconSet,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatIconSet],[i.EventMethods.System.Undo,()=>ExcelCopilotCommandingHitlStrings.UndoLabel],[i.EventMethods.System.Redo,()=>ExcelCopilotCommandingHitlStrings.RedoLabel],[i.EventMethods.System.Unknown,()=>ExcelCopilotCommandingHitlStrings.UnknownEventLabel],[i.EventMethods.System.Unsupported,()=>ExcelCopilotCommandingHitlStrings.UnsupportedEventLabel],[i.EventMethods.System.InProgress,()=>ExcelCopilotCommandingHitlStrings.InProgressEventLabel],[i.EventMethods.System.Undefined,()=>ExcelCopilotCommandingHitlStrings.UnknownEventLabel],[i.EventMethods.Error.Alias,()=>ExcelCopilotCommandingHitlStrings.ErrorAliasInfo],[i.EventMethods.Error.Unknown,()=>ExcelCopilotCommandingHitlStrings.ErrorUnknown],[i.EventMethods.Error.UpstreamExceptionOccured,()=>ExcelCopilotCommandingHitlStrings.ErrorUnknown],[i.EventMethods.Range.DataValidationRuleListChanged,fn],[i.EventMethods.Range.DataValidationRuleCustomChanged,Cn],[i.EventMethods.Range.DataValidationRuleDateChanged,yn],[i.EventMethods.Range.DataValidationRuleDecimalChanged,vn],[i.EventMethods.Range.DataValidationRuleWholeNumberChanged,Sn],[i.EventMethods.Range.DataValidationRuleTextLengthChanged,Tn],[i.EventMethods.Range.DataValidationRuleTimeChanged,xn],[i.EventMethods.Range.DataValidationRuleCleared,wn]]),vl=new Map([[i.EventMethods.ConditionalFormatting.CellValueCreated,qa],[i.EventMethods.ConditionalFormatting.CustomCreated,Va],[i.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,Wa],[i.EventMethods.ConditionalFormatting.DataBarCustomCreated,za],[i.EventMethods.ConditionalFormatting.DatesCreated,ja],[i.EventMethods.ConditionalFormatting.IconSetCreated,Qa],[i.EventMethods.ConditionalFormatting.PresetCreated,Ja],[i.EventMethods.ConditionalFormatting.TextComparisonCreated,Ga],[i.EventMethods.ConditionalFormatting.TopBottomCreated,Xa],[i.EventMethods.ConditionalFormatting.UniqueCreated,Ya],[i.EventMethods.ConditionalFormatting.PriorityEdited,en]]);function Tl(e,t){const a=fl(e),n=(0,m.k6)()&&t?yl.get(a):Cl.get(a);if(void 0===n)return(0,m.yw)("OfficeVSO_8958983_HiTLMissingIntentError")?s.O.UnhandledIntent:"Missing intent string";return n(e)}function xl(e,t){const a=vl.get(t);if(void 0===a)return s.O.UnhandledIntent;return a(e)}function Sl(e,t){return e.map((e=>Tl(e,t)))}function wl(e){return e!==i.EventMethods.ConditionalFormatting.Deleted&&e?.includes("ConditionalFormatting")}function El(e){const t=e;t.parameters.rangeType=i.RangeType.TableRange,t.parameters.range.subRange=i.TableRangeOperationSubRange.WholeTable;const a=u.CP.getActiveTable();return t.parameters.range.tableName=a.name,t}function Rl(e){switch(e){case n.wv.Worksheet.Filter.Icon:case n.wv.Worksheet.Filter.BottomItems:case n.wv.Worksheet.Filter.BottomPercent:case n.wv.Worksheet.Filter.TopItems:case n.wv.Worksheet.Filter.TopPercent:case n.wv.Worksheet.Filter.Values:case n.wv.Worksheet.Filter.Custom:case n.wv.Worksheet.Filter.FontColor:case n.wv.Worksheet.Filter.CellColor:case n.wv.Worksheet.Filter.Dynamic:return!0;default:return!1}}function Il(e){switch(e.method){case n.wv.Worksheet.ClearFilter:case n.wv.Worksheet.ClearColumnFilter:return!0;default:return!1}}function Al(e){return e.method===n.wv.Range.Sort}function Ll(e){const t=[];for(const a of e){let e=!1;const n=a.method;let o=s.O.UnhandledIntent;if(Rl(n)){const{filteredDataDisplayName:e,filterCriteria:t}=a.args;o=(0,g.lx)(e,t)}else if(Il(a)){const{changedDataDisplayName:e}=a.args;o=(0,E.A)(ExcelCopilotCommandingHitlStrings.WorksheetRangeClearFiltersLabel,{range:e})}else if((0,m.yw)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&Al(a)){const n=a.args;n.fields.forEach((a=>{a.key>=0&&(o=(0,E.A)(ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{columnIndex:a.key,tableName:n.rangeAddress}),t.push(o),e=!0)}))}if(o===s.O.UnhandledIntent)throw new l.sF("Intent string missing or no conversion method exists.",l.UP.MissingIntent);(0,m.yw)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&e||t.push(o)}return t}function Fl(e){const t=[],a=[];for(let n of e){const e=fl(n),i=wl(e);n.parameters?.columnName===bl.G.O&&(n=El(n));const u=i?xl(n,e):Tl(n,!0);if("string"==typeof u)switch(u){case s.O.NoIntentNeeded:continue;case s.O.MissingIntent:case s.O.UnhandledIntent:if((0,m.yw)("OfficeVSO_9052516_HiTLASHATelemetry")&&c.M.getInstance().logStandardizedAshaErrorEvent(r.W.Missing_Copilot_Functionality,o.c.Missing_HITL_Intent_String,d.BJ.Commanding),(0,m.yw)("OfficeVSO_8958983_HiTLMissingIntentError"))throw new l.sF("Intent string missing or no conversion method exists.",l.UP.MissingIntent);return{cfIntents:[],nonCfIntents:[]}}i?t.push(u):a.push(u)}return{cfIntents:t,nonCfIntents:a}}},96756:(e,t,a)=>{a.d(t,{A:()=>o});const n=/([\s\S]*)\$\{(.*)\}([\s\S]*)/;const o=function e(t,a,o){const r=n.exec(t);if(!r)return t;const[i,l,s,c]=r,d=a[s];if(void 0===d)throw new Error(`Could not find a substitution for the placeholder "${s}" within "${t}" with substitutions \`${JSON.stringify(a)}\``);return e(l,a,o)+(o?"<b>":"")+d+(o?"</b>":"")+e(c,a,o)}},96098:(e,t,a)=>{a.d(t,{i:()=>b,X:()=>T});var n=a(11469),o=a(26115),r=a(72483),i=a(45283),l=a(88179),s=a(23147),c=a(41102),d=a(92779),u=a(98463),m=a(49134),g=a(93471),h=a(50347);async function p(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const a=await async function(e){const t=e.workbook.getActiveCell();return t.load("address"),await e.sync(),t}(t),n=m.ExcelCalc.sheetAddressToExcelSheetRange(a.address);let o;if(-1===e.address.indexOf("!"))o=m.ExcelCalc.addressToExcelRange(e.address);else{o=m.ExcelCalc.sheetAddressToExcelSheetRange(e.address).range}if(e.sheetRange.sheet!==n.sheet)throw new Error((0,d.LNV)());const{firstRow:r,firstColumn:i,numRows:l,numColumns:s,targetColumn:c}=function(e,t,a){const n=100,o=50;let r=!0;const i=Math.min(n,a.numRows)+1,l=Math.min(o,a.numColumns);let s=t.topLeft.row;const c=t.topLeft.column;let d=t.bottomRight.row;const u=t.bottomRight.column;(0,h.yw)("OfficeVSO_9320485_CFSuggestionsHandleLargeTable")&&null==s&&null==d&&null!==c&&null!==u&&(s=0,d=a.numRows);let g=e.topLeft.row,p=e.topLeft.column;if(null==s||null==c||null==u||null==d||null==g||null==p)return{firstRow:0,firstColumn:0,numRows:0,numColumns:0};if(!m.ExcelCalc.IExcelRangeIntersect(m.ExcelCalc.getIExcelRangeTopLeftCell(e),t)){const e=function(e,t,a,n,o,r){const i=Math.abs(o-e),l=Math.abs(a-o),s=Math.abs(r-t),c=Math.abs(n-r);let d=o;i<l?d=e:l<i&&(d=a);let u=r;s<c?u=t:c<s&&(u=n);o>=e&&o<=a&&(d=o);r>=t&&r<=n&&(u=r);return{row:d,column:u}}(s,c,d,u,g,p);g=e.row,p=e.column,r=!1}let b=Math.max(g-Math.floor(i/2),s),f=b+i-1;f>d&&(f=d,b=f-i+1);let C=Math.max(p-Math.floor(l/2),c),y=C+l-1;y>u&&(y=u,C=y-l+1);return{firstRow:b,firstColumn:C,numRows:i,numColumns:l,targetColumn:r?p:void 0}}(n.range,o,e),p=t.workbook.worksheets.getActiveWorksheet().getRangeByIndexes(r,i,l,s);await async function(e,t){t.load("address"),t.load({address:!0,values:!0,numberFormatCategories:!0,numberFormat:!0,text:!0,rowIndex:!0,rowCount:!0,columnIndex:!0,columnCount:!0}),await e.sync()}(t,p);const b=function(e,t,a,n){const o={Name:e.name,Columns:[],TargetColumnId:void 0},r=t.text,i=t.values,l=t.numberFormatCategories,s=""!==e.headers,c=JSON.parse(e.headers);if(!s)throw new Error((0,d.LNV)());return i.forEach(((e,a)=>{e.forEach(((e,i)=>{const d=a+t.rowIndex,m=i+t.columnIndex;if(void 0===o.Columns[i]){const e=m-n;o.Columns[i]={HeaderName:s?c[e]:"",Values:[],Index:m}}else{const t=l[a][i],n=function(e,t,a,n,o){let r=function(e){switch(e){case"General":default:return u.v.General;case"Number":return u.v.Number;case"Text":return u.v.Text;case"Date":return u.v.Date;case"Time":return u.v.Time;case"Currency":return u.v.Currency;case"Accounting":return u.v.Accounting}}(a),i=e;if(isNaN(Number(e)))i=t;else if(r===u.v.Date||r===u.v.Time){const{date:a}=(0,g.f9)(e);e<1||isNaN(a.getDay())?(i=t,r=u.v.Text):i=a}return{Value:i,Style:{Bold:!1,Italic:!1,Underline:!1,Strikethrough:!1,FillColor:"",FontColor:""},Type:r,Row:n,Column:o}}(e,r[a][i],t,d,m);o.Columns[i].Values.push(n)}}))})),o.Columns.forEach(((e,t)=>{e.Index===a&&(o.TargetColumnId=t+1)})),o}(e,p,c,o.topLeft.column??0);return b}))}var b,f=a(71362),C=a(6925),y=a(74511),v=a(66888);!function(e){e.Chat="Chat",e.SuggestionPill="SuggestionPill"}(b||(b={}));const T=async(e,t,a,n)=>{if(0===e.length)return!1;for(const o of e)a(x(o,t,a,n));return!0},x=(e,t,a,n)=>async()=>{if("conditionalFormatSuggestion"!==e.func)throw new Error(`Unsupported function ${e.func} for Conditional Format Suggestion agent`);if(2!==e.args.length)throw new Error(`Incorrect number of parameters for ${e.func}`);const o=e.args[1],i=s.CP.getActiveTable();if(!i){const{message:e,telemetry:t}=f.n.getConditionalFormattingSuggestionsErrorResponse((0,d.LNV)(),l.q0.ClientError);return r.$.getInstance().displayResponse(e,t),void await w(o,v.Aw.failed,a)}await S(i,t,o,a,n),await w(o,v.Aw.success,a)},S=async(e,t,a,s,u)=>{try{const l=new n.u;l.guid=t,l.uiLocale=y.i.GetHostAppDisplayLanguage(),l.outputLanguage=u,l.Table=await p(e);const d=new o.g0({parentPath:["Signal",n.u.getTypeName()],items:[{id:i.r.generateId(),body:l}]});if((0,h.yw)("OfficeVSO_9445515_FixCFTimeoutFalsePositive"))r.$.getInstance().submitOperation({operation:d,workflowAnnotationType:n.b.getTypeName()});else{(await(0,c.qD)()).submitOperation(d)}await w(a,v.Aw.success,s)}catch(e){let t=(0,d.t_C)();e?.message===(0,d.LNV)()&&(t=e.message);const{message:n,telemetry:o}=f.n.getConditionalFormattingSuggestionsErrorResponse(t,l.q0.ClientError);r.$.getInstance().displayResponse(n,o),await w(a,v.Aw.failed,s),await s(C.mF.stopExecutingAndReleaseContextLock(!1))}},w=async(e,t,a)=>{if("Chat"!==e)return;const n=JSON.stringify({text:"ConditionalFormattingSuggestion",publishPreference:"Never"}),o={featureName:l.q.ConditionalFormattingSuggestion,eventType:l.a5.SuggestionMessage};await a(C.mF.sendSkillResponseToFlux(n,t,o))}},5550:(e,t,a)=>{a.d(t,{B2:()=>s,I_:()=>l,TB:()=>c,Vv:()=>i,zj:()=>n});var n,o=a(61150),r=a(9166);!function(e){e.AugLoopCloudALServiceUrl="AugloopClouldALServiceUrl",e.CopilotEntryPoint="CopilotEntryPoint",e.CopilotStartResponse="copilotStartResponse",e.CopilotStartQuery="CopilotStartQuery",e.CopilotStartPromptCellRow="CopilotStartPromptCellRow",e.CopilotStartPromptCellCol="CopilotStartPromptCellCol",e.CopilotStartPromptId="CopilotStartPromptId",e.AugloopSharedSessionID="AugloopSharedSessionID",e.AugloopEverHadModelError="AugloopEverHadModelError",e.AudienceGroup="AudienceGroup",e.HasActivePythonLicense="HasActivePythonLicense",e.InsightsEndpoint="InsightsEndpoint",e.HandoffMessageId="HandoffMessageId",e.AppStartTimestamp="AppStartTimestamp",e.CopilotPaneStartTimestamp="StartTimeMs",e.ButtonEnabledForLocalFiles="ButtonEnabledForLocalFiles",e.ShouldUseEnvSpecificALUrl="ShouldUseEnvSpecificALUrl",e.ExcelSdxPrivateApiEnabled="ExcelSdxPrivateApiEnabled"}(n||(n={}));class i{static getSettingAsString(e){if(r.N)return"TestSetting";const t=Office.context.hostSettings.get(e.toString());return(0,o.hX)(t)?t:t.toString()}static getSetting(e){return Office.context.hostSettings.get(e.toString())}static set(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))}static setByKey(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))}static setHostSettings(e){Object.keys(e).forEach((t=>{const a=(0,o.gZ)(e[t]);this.setByKey(t,a)}))}static IsSettingTrue(e){const t=this.getSettingAsString(e);return!!t&&"true"===t.toLowerCase()}}function l(){const e=i.getSettingAsString("AudienceGroup");return"Automation"===e||"Dogfood"===e}function s(){return"Microsoft"===i.getSettingAsString("AudienceGroup")}function c(){const e=i.getSettingAsString("AugloopClouldALServiceUrl");return!!e?.toLowerCase().includes("augloop-gcc")&&((0,o.cY)("Environment is GCC"),!0)}},74511:(e,t,a)=>{a.d(t,{i:()=>n});class n{static GetHostAppContentLaguage(){return Office.context.contentLanguage}static GetHostAppPlatform(){return Office.context.diagnostics.platform}static GetHostAppDisplayLanguage(){return Office.context.displayLanguage}static isWin32Platform(){return Office.context.platform===Office.PlatformType.PC}static isWebPlatform(){return Office.context.platform===Office.PlatformType.OfficeOnline}}},41679:(e,t,a)=>{a.d(t,{jy:()=>v,I:()=>x,TQ:()=>T,fS:()=>S});var n=a(92779),o=a(1805),r=a(51319),i=a(8338),l=a(825),s=a(65624),c=a(26170),d=a(23147),u=a(22650),m=a(33637),g=a(95789),h=a(88179),p=a(31030),b=a(48314);const f=255,C=1;var y,v;async function T(e,t){const a=s.H.getInstance().getScripts();if(0===a.length)throw new c.Q0("No script found in the office script cache layer.",c.y3.scriptNotFound);const n=a.find((t=>t.name===e));if(!n)throw new c.Q0("No matched script to run.",c.y3.scriptNotFound);try{const e=new l.L;return await e.getScript(n,t)}catch{throw new c.Q0("Something went wrong while fetching the script to run.",c.y3.scriptNotFound)}}async function x(e,t){let a,l=!1,s=[];try{const g=JSON.parse(e.statements),y=new o.K,v=await y.convert(g),T=[];for(const e of v){if(e.agent!==r.w2.OfficeScripts)throw new c.Q0("ODSL cannot be saved other than Office Script agent.");T.push(...e.items)}s=(0,u.yC)(T).filter((e=>e!==i.O.MissingIntent));const x=function(e,t){const a=(0,n.QbU)(),o=[];let r=e;const i=new RegExp(/^(\s*)$/g);r&&!i.test(r)||(o.push("empty"),r=a);const l=new RegExp(/(["&%*:<>?/\\|.])/g);r.match(l)&&(o.push("invalid character"),r=r.replaceAll(l,""));const s=new RegExp(/(^((\.lock)|(CON)|(PRN)|(AUX)|(NUL)|(COM\d{1})|(LPT\d{1})|(desktop.ini))$)|(_vti_)|^~(\$)?/g);r.match(s)&&(o.push("invalid file name"),r=r.replaceAll(s,""));const c=new RegExp(/(table|Table)\s*\d+/g);r.match(c)&&(o.push("contains numbered table"),r=r.replaceAll(c,"Table"));const d=r.trim();if(d!==r&&(o.push("ends in whitespace"),r=d),r.length<C&&(o.push("too short"),r=a),r.length>f&&(o.push("too long"),r=r.substring(0,f)),0!==o.length){const e=[{key:h.ib.ErrorMessage,value:o.toString()},{key:h.ib.RequestId,value:t}];b.M.getInstance().logError({eventType:p.S.OfficeScriptsRename,errorMessage:"",logLevel:h.$b.Warning},void 0,e)}return r}(e.scriptNameToSave,t),S=d.CP.getActiveTable();let w;S&&(0,d.En)(S)&&(w=S.name);const E=await(0,m.V)(T,x,s.join("\n"),w,n.U2P);if(!E.storageScript.body||!E.storageScript.description)throw new c.Q0("Script body or description is undefined when saving a script.");a={...E.storageScript,...E.localUpdates,body:E.localUpdates.body,description:E.storageScript.description},l=!0}catch(e){(e.isOfficeScriptSkillHandlerError||e.isExecutorError||e.isConverterError)&&(0,c.hs)(e,"save_script",t)}return{success:l,intents:s,scriptToSave:a}}async function S(e,t){let a;try{const n=s.H.getInstance(),o=new l.L;a=await o.saveCopilotScript(e,t),n.pushScript(a),(0,g.q)({operationName:"Publish",scriptMetadata:a})}catch(e){const a=new c.Q0("Something went wrong while saving the script.");(0,c.hs)(a,"save_script",t)}return a}!function(e){e.Empty="empty",e.TooLong="too long",e.TooShort="too short",e.InvalidCharacter="invalid character",e.InvalidFileName="invalid file name",e.EndsInWhitespace="ends in whitespace",e.ContainsNumberedTable="contains numbered table"}(y||(y={})),function(e){e.Recurrence="recurrence"}(v||(v={}))},26170:(e,t,a)=>{a.d(t,{Q0:()=>l,hs:()=>s,y3:()=>n});var n,o=a(88179),r=a(31030),i=a(48314);!function(e){e.scriptNotFound="scriptNotFound",e.unknownScheduleType="unknownScheduleType"}(n||(n={}));class l extends Error{constructor(e,t){super(e),this.isOfficeScriptSkillHandlerError=!0,this.errorType=t}}const s=(e,t,a)=>{const n=i.M.getInstance(),l={eventType:r.S.OfficeScriptSkillHandler,errorMessage:e.message,logLevel:o.$b.ASHA},s=e.isOfficeScriptSkillHandlerError?e.errorType:void 0,c=[{key:o.ib.OperationType,value:t},{key:o.ib.ErrorMessage,value:e.message},{key:o.ib.RequestId,value:a},...s?[{key:o.ib.ErrorType,value:s}]:[]];n.logError(l,void 0,c)}},16508:(e,t,a)=>{a.d(t,{$:()=>x});var n=a(89099),o=a(24220),r=a(92779),i=a(72483),l=a(88179),s=a(66888),c=a(60637),d=a(48314),u=a(6925),m=a(70364),g=a(50347),h=a(59726),p=a(27982),b=a(28087),f=a(33500),C=a(19080),y=a(4475);const v=l.q.OfficeJsCommanding;const T={getOfficeJsGenericSuccess:function(e,t,a,n){const o=[];return e&&(0,g.BA)()&&o.push((0,y.FW)(v)),a&&n?.length&&o.push({type:p.jA.Default,title:(0,r.f7s)(),text:(0,r.f7s)(),handleButtonOnClick:async()=>{(0,y.s_)(y.H0.RemoveExplain),t(n)}}),{message:{chatCardType:b._.Default,chatMessageData:{defaultMessageProps:{user:f.Q9.Chat,messageHeader:{text:a??(0,r.CLD)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:o,feedbackSectionPosition:C.O.Footer}},telemetry:{featureName:v,eventType:l.a5.ActionConfirmationMessage}}},getOfficeJsUndoWarning:function(e,t,a,n){return{message:{chatCardType:b._.Default,chatMessageData:{defaultMessageProps:{user:f.Q9.Chat,embeddedLists:[{listHeader:(0,r.v3b)(),listItems:t.map((e=>({text:e}))),listFooter:{text:(0,r.kwK)()}}]}},chatMessageBodyData:{actionButtonList:[{type:p.jA.Default,title:(0,r.rVc)(),text:(0,r.rVc)(),handleButtonOnClick:()=>{(0,y.s_)(y.H0.RemoveAll),n.confirmedUndo(e,t,a)}},{type:p.jA.Default,title:(0,r.G2X)(),text:(0,r.G2X)(),handleButtonOnClick:async()=>{(0,y.s_)(y.H0.RemoveAll)}}]}},telemetry:{featureName:v,eventType:l.a5.ActionConfirmationMessage}}},getOfficeJsCodeExplanation:function(e,t,a){return{chatCardType:b._.Default,chatMessageData:{defaultMessageProps:{user:f.Q9.Chat,embeddedLists:[{listHeader:t,listItems:e.map((e=>({text:e})))}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:a&&(0,g.BA)()?[(0,y.FW)(v)]:[],feedbackSectionPosition:C.O.Footer}}}};class x{async getOfficeScriptLibrary(){return(await a.e("ojsc-os-library").then(a.t.bind(a,87343,19))).code}addCodeExplanationChatMessage(e,t,a,n){const o=T.getOfficeJsCodeExplanation(e,t,a);i.$.getInstance().displayResponse(o,n,{shouldShowWhenFluxSkillResponseRequired:!1});const r=(0,h.N)(o);this.dispatch(u.mF.sendSkillResponseToFlux(r,s.Aw.success,n))}handleOfficeJsExecutionError(e){this.addCodeExplanationChatMessage(e,(0,r.v3A)(),!1,{featureName:l.q.OfficeJsCommanding,eventType:l.a5.ErrorMessage,errorType:l.q0.OfficeJsExecutionFailed})}async confirmedUndo(e,t,a){this.dispatch(u.mF.startExecutingCommand({command:l.OP.FluxReasoning,id:d.M.userQueryGuid}));const n=await this.executeOfficeJs(e,t,a,!1);return await this.dispatch(u.mF.stopExecutingAndReleaseContextLock()),n}async executeOfficeJs(e,t,a,n){this.dispatch(u.mF.startExecutingCommand({command:l.OP.Commanding}));let o=!1;try{await(0,m.$r)((0,r.Eyh)()),await this.runtimeHelper.prepareCustomLibrary(((e,t)=>`async function main(context) {\n  if (!Array.prototype.findAsync) {\n    Object.defineProperty(Array.prototype, 'findAsync', {\n      value: async function (predicate) {\n        if (this == null) {\n          throw TypeError('"this" is null or not defined');\n        }\n        var o = Object(this);\n        var len = o.length >>> 0;\n        if (typeof predicate !== 'function') {\n          throw TypeError('predicate must be a function');\n        }\n        var thisArg = arguments[1];\n        var k = 0;\n        while (k < len) {\n          var kValue = o[k];\n          const check = (await (predicate.call(thisArg, kValue, k, o)));\n          if (check) {\n            return kValue;\n          }\n          k++;\n        }\n        return undefined;\n      },\n      configurable: false,\n      writable: false\n    });\n  }\n  if (!Array.prototype.findIndexAsync) {\n    Object.defineProperty(Array.prototype, 'findIndexAsync', {\n      value: async function (predicate) {\n        if (this == null) {\n          throw new TypeError('"this" is null or not defined');\n        }\n        var o = Object(this);\n        var len = o.length >>> 0;\n        if (typeof predicate !== 'function') {\n          throw new TypeError('predicate must be a function');\n        }\n        var thisArg = arguments[1];\n        var k = 0;\n        while (k < len) {\n          var kValue = o[k];\n          const check = (await (predicate.call(thisArg, kValue, k, o)));\n          if (check) {\n            return k;\n          }\n          k++;\n        }\n        return -1;\n      },\n      configurable: false,\n      writable: false\n    });\n  }\n  if (!Array.prototype.filterAsync) {\n    Object.defineProperty(Array.prototype, 'filterAsync', {\n      value: async function (func, thisArg) {\n        if (!(typeof func === 'function') && this) {\n          throw new TypeError();\n        }\n        var len = this.length >>> 0, res = new Array(len), t = this, c = 0, i = -1;\n        var kValue;\n        if (thisArg === undefined) {\n          while (++i !== len) {\n            if (i in this) {\n              kValue = t[i];\n              const check = (await (func(t[i], i, t)));\n              if (check) {\n                res[c++] = kValue;\n              }\n            }\n          }\n        }\n        else {\n          while (++i !== len) {\n            if (i in this) {\n              kValue = t[i];\n              const check = (await (func.call(thisArg, t[i], i, t)));\n              if (check) {\n                res[c++] = kValue;\n              }\n            }\n          }\n        }\n        res.length = c;\n        return res;\n      },\n      configurable: false,\n      writable: false\n    });\n  }\n  return new Promise((resolve, reject) => {\n    async function _____wrapperMain(engine, ...args) {\n      Function.constructor = null;\n      const allowedGlobals = ["Object","Function","Array","Number","parseFloat","parseInt","isNaN","Date","Promise","RegExp","Error","AggregateError","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","JSON","Math","Intl","Map","Set","WeakMap","WeakSet","OSF","OfficeExtension","OfficeCore","Office","Excel","CustomFunctionMappings","OfficeExtensionBatch","CustomFunctions","OfficeRuntime","ExcelScript","postMessage","__awaiter","__generator","window","_getCloneableValue","_clonify","OfficeExtension","performance","setTimeout","addEventListener"];\n      const globalSet = new Set(Object.getOwnPropertyNames(window));\n      for (let a in window) globalSet.add(a);\n      for (const f of globalSet) {\n        if (allowedGlobals.includes(f)) continue;\n        const type = typeof window[f];\n        if (type === 'function' || type === 'object') window[f] = null;\n      }\n\n      ${e}\n      try {\n        const output = await main(...args);\n        ${t?"if (Array.isArray(output)) {\n            let lines = '';\n            for (const line of output) {\n              if (typeof line === 'object') {\n                return;\n              }\n              lines += line.toString() + '\n';\n            }\n            return lines.trim();\n          }\n          else if (typeof output === 'object') {\n            return;\n          }\n          return output.toString();":"return output;"}\n      }\n      catch (e) {\n        reject(e);\n      }\n    }\n    ExcelScript.run(_____wrapperMain, {\n      context,\n      specialArgumentOrder: ["engine", "workbook"],\n      arguments: [],\n      errorCallback: reject,\n    }).then(resolve);\n  });\n}\n`)(e,a),await this.getOfficeScriptLibrary()),await new Promise(((e,a)=>{const c=setTimeout((()=>{d(),a(new Error("Timeout"))}),6e4),d=()=>{this.runtimeHelper.terminateCurrentRun(),clearTimeout(c)};this.runtimeHelper.executeScript().then((c=>{if(d(),"string"==typeof c){o=!0;const{message:e,telemetry:a}=T.getOfficeJsGenericSuccess(n,this.explainOfficeJsResult,c,t);i.$.getInstance().displayResponse(e,a);const r=(0,h.N)(e);this.dispatch(u.mF.sendSkillResponseToFlux(r,s.Aw.success,a))}else if(void 0!==c)a(c);else if(t.length)o=!0,this.addCodeExplanationChatMessage(t,(0,r.DSt)(),n,{featureName:l.q.OfficeJsCommanding,eventType:l.a5.ActionConfirmationMessage});else{o=!0;const{message:e,telemetry:t}=T.getOfficeJsGenericSuccess(n,this.explainOfficeJsResult);i.$.getInstance().displayResponse(e,t);const a=(0,h.N)(e);this.dispatch(u.mF.sendSkillResponseToFlux(a,s.Aw.success,t))}o&&(0,m.TA)(),e(null)})).catch(a)}))}catch(e){this.handleOfficeJsExecutionError(t),this.logOfficeJsAshaError(e)}return o}async logOfficeJsAshaError(e){if((0,g.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")){let t,a;"AccessDenied"===e.errorCode?(t=o.W.Unable_To_Complete_Task,a=n.c.Failed_Command_Execution_Due_To_Protection_Settings):"Timeout"===e.message?(t=o.W.Response_Delayed_Or_Timed_Out,a=n.c.Command_Execution_Took_Too_Long):(t=o.W.Unclassified_Chat_Failure,a=n.c.Failed_Command_Execution_Due_To_Other_Error),d.M.getInstance().logStandardizedAshaErrorEvent(t,a,l.BJ.Commanding)}}async handleOfficeJsResult(e){const{code:t,undoWarnings:a,returnsValue:n}=e,o=e.codeExplanation.split("\n");let r=!1;if(a.length){const{message:e,telemetry:a}=T.getOfficeJsUndoWarning(t,o,n,this);i.$.getInstance().displayResponse(e,a);const l=(0,h.N)(e);this.dispatch(u.mF.sendSkillResponseToFlux(l,s.Aw.success,a)),r=!0}else r=await this.executeOfficeJs(t,o,n,!0);return await this.dispatch(u.mF.stopExecutingAndReleaseContextLock()),r}constructor(e){this.dispatch=e,this.explainOfficeJsResult=e=>{this.addCodeExplanationChatMessage(e,(0,r.KVc)(),!1,{featureName:l.q.OfficeJsCommanding,eventType:l.a5.ActionConfirmationMessage})},this.runtimeHelper=c.b.instance()}}},52389:(e,t,a)=>{a.d(t,{e:()=>c});var n=a(88179),o=a(31030),r=a(48314),i=a(50347),l=a(89337);class s{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}class c{release(e){if(e!==this.outstandingToken)throw new Error("Release attempted by non-owner");this.outstandingToken=void 0,this.operation=void 0,this.processQueue()}processQueue(){if(this.waitQueue.length>0){const e=this.tryAcquire();if(e){this.waitQueue.shift().resolveFn(e)}}}tryAcquire(e){if(this.outstandingToken)return;const t=new d(this.release.bind(this));return this.outstandingToken=t,this.operation=e,t}async waitFor(){let e;const t=new Promise(((t,a)=>{e=new s(t,a),this.waitQueue.push(e)}));return this.processQueue(),t}logMutexTokenError(e,t,a=n.OP.ActionAI){const l=e,s={eventType:o.S.ContextManager,errorMessage:l,logLevel:n.$b.Warning},c=r.M.getInstance(),d=[{key:"Source",value:t}];if((0,i.yw)("OfficeVSO_9370178_logMutexOperation")){const e={prev:this.operation,current:a};d.push({key:"Operations",value:JSON.stringify(e)})}c.logError(s,void 0,d)}constructor(){this.waitQueue=[]}}class d{release(){this.relFn(this)}logSelectionChangeEvent(){if(!this.selectionChanged){this.selectionChanged=!0;const e={key:"selectionChange",value:!0};(0,l.j)([e])}}constructor(e){this.relFn=e,this.selectionChanged=!1}}},60637:(e,t,a)=>{a.d(t,{b:()=>E});var n=a(94303);function o(){return`${"https://officescripts.microsoftusercontent.com"}/${r}`}const r="eed0a086-3498-4f91-a377-1e0265ecc0cc";var i=a(52389),l=a(5550);class s{create(e,t){return!this.store[e]&&(this.store[e]=t,!0)}read(e){if(void 0!==this.store[e])return this.store[e];throw new Error("No such item: "+JSON.stringify(e))}update(e,t){const a=!!this.store[e];return this.store[e]=t,a}delete(e){const t=!!this.store[e];return delete this.store[e],t}keys(){const e=[];for(const t in this.store)e.push(t);return e}constructor(){this.store={}}}var c=a(35717),d=a(25741),u=a(50347),m=a(6704);async function g(){return await Promise.all([a.e("vendors~shared"),a.e("vendors~oss"),a.e("oss")]).then(a.t.bind(a,15096,23))}const h="https://appsforoffice.microsoft.com/lib/beta/hosted/",p="https://appsforoffice.gcch.cdn.office.net/appsforoffice/lib/beta/hosted/",b="https://appsforoffice.dod.cdn.office.net/appsforoffice/lib/beta/hosted/",f=["RichApiRuntimeFlag","ExcelApi","ExcelApiOnline","ExcelApiUndo"];function C(){if(Office?.context)return Office.context.platform}function y(){return((0,u.yw)("OfficeVSO_9404052_OfficeJsApiGCCDoD")?function(){const e=l.Vv.getSettingAsString(l.zj.InsightsEndpoint);return"Insights.Https.DOD.Bundle"===e?b:"Insights.Https.GCCH.Bundle"===e?p:h}():h)+(C()===Office.PlatformType.PC?"excel-win32-16.01.js":C()===Office.PlatformType.Mac?"excel-mac-16.00.js":"excel-web-16.00.js")}class v{async getRuntime(e,t){const a=(0,m.Ml)(e),n=!1;let o=this.getPreload(a,n);try{o||(o=new c.U((()=>this.createRuntime(a,n,t))));return await o.getPromise()}catch(e){throw e}finally{this.removePreload(a,n)}}getSupportedSetMap(){if(this.apiSetMap)return this.apiSetMap;const e={};return f.forEach((t=>{let a=0;for(;a<99;){if(!Office.context.requirements.isSetSupported(t,`1.${a}`)){a--;break}a++}a>=0&&(e[t]=`1.${a}`)})),this.apiSetMap=e,e}async loadCodeForRuntime(e,t,a){const n=a??await async function(){return(await g()).code}(),o=t.codeOverride||n;await e.loadCode(o);const r=this.getSupportedSetMap(),i=(0,d.tI)(r);return await e.loadCode(i),e}async createRuntime(e={variant:"synchronous",variantVersion:2},t,a){const n=await(0,m.Tq)(e),r={officeJsUrl:n.officeJsOverride||y(),allowExternalCalls:t,serviceUrl:o()};return d.zI.createRuntimeInstance(r).then((e=>this.loadCodeForRuntime(e,n,a)))}getPreload(e,t){const a=JSON.stringify([e,t]);if(!(this.preloads.keys().indexOf(a)<0))return this.preloads.read(a)}constructor(){this.preloadRuntime=async(e,t)=>{const a=(0,m.Ml)(e)||{variant:"synchronous",variantVersion:2},n=!1;if(void 0===this.getPreload(a,n)){const e=new c.U((()=>this.createRuntime(a,n,t))),o=e.getPromise();this.pushPreload(a,n,e);try{await o}catch(e){this.removePreload(a,n)}}},this.pushPreload=(e,t,a)=>{const n=JSON.stringify([e,t]);this.preloads.create(n,a)},this.removePreload=(e,t)=>{const a=JSON.stringify([e,t]);this.preloads.delete(a)},this.preloads=new s}}async function T(){return await Promise.all([a.e("vendors~shared"),a.e("ts")]).then(a.t.bind(a,8479,23))}async function x(e){const t=await T(),a=t.ScriptTarget.ES2019,n=t.transpileModule(e,{reportDiagnostics:!0,compilerOptions:{target:a,lib:["dom","es2019"],allowJs:!0}});if(n.diagnostics.length){return{compileErrorMessage:n.diagnostics.map((t=>{const a=e.substr(0,t.start),n=e.substr(t.start+1),o=a.split("\n").length,r=a.lastIndexOf("\n"),i=e.substring(r,t.start+Math.max(n.indexOf("\n"),0)).trim();return function(e,t){return`Line #${e}: ${t}`}(o,`${t.messageText}\n ${i}`)})).join("\n\n")}}return{outputText:n.outputText.replace('Object.defineProperty(exports, "__esModule", { value: true });',"")}}function S(e){return e.map((({name:e,version:t})=>({name:e,version:t,support:Office.context.requirements.isSetSupported(e,t)})))}async function w(e,t,a,n){let o="";const r=function(e){if(e){const t=e.storageScript.apiInfo;return!!t&&JSON.parse(t).variant===m.MH}return!0}(t),i={apiInfo:t.storageScript.apiInfo,storageId:t.storageScript.id,cacheHit:!1,parentCallId:n};JSON.parse(JSON.stringify(a)).cachedVersion=3;try{o=r?await async function(e,t,a){const n=await g(),o=!1;let r;try{const i=e=>e;r=await n.transformSynchronousCodeForBatchExecutionLegacy(e,x,{logger:void 0,scan:o,getSetSupport:S,mergeOverride:i,...t});const l=await T();if(r.outputText){const s=(e,t)=>{const o=[1107,1123,1155,1157,1182,1184,1188,1232,1312,1344,2300,2364,2393,2451,2481,2792],r=l.getPreEmitDiagnostics(t);a.syntaxErrorCodes=JSON.stringify(r.map((e=>e.code)));const i=r.filter((e=>o.indexOf(e.code)>=0)).filter((e=>e.file));return n.diagnosticsToErrorMessage(e,i)},c=n.transformSynchronousCodeForBatchExecution(e,{logger:void 0,scan:o,getSetSupport:S,mergeOverride:i,syntaxOverride:s,...t});c.outputText||(r=c)}}catch(e){throw e}const{outputText:i,failureStage:l,failureMessage:s}=r;if(l&&s)throw new SyntaxError(s);if(i)return i;throw new SyntaxError("No Code")}(e,a,i):await async function(e){const t=await x(e),a=t.compileErrorMessage,n=t.outputText;if(a)throw new SyntaxError(a);if(n)return n;throw new SyntaxError("No Code")}(e)}catch(e){throw e.isCompileError=!0,e}return o}class E{async terminateCurrentRun(e){this.runtime&&(this.runtime.terminate(),this.ensurePreload(e))}getPrepareScriptError(e){let t="Error occurred while loading runtime.";return!!e.isCompileError&&(t="Error occurred during code compilation."),new n.WD(t)}constructor(){this.acquireMutexToken=()=>{const e=this.mutex.tryAcquire();return void 0!==e&&(this.mutexToken=e,!0)},this.releaseMutexToken=()=>{try{this.mutexToken.release(),this.mutexToken=void 0,this.resolveMutexReleasePromise()}catch(e){}},this.ensureScriptBody=e=>{const t=e.localUpdates.body;return!(null==t)},this.ensurePreload=e=>{this.runtimeTracker.preloadRuntime(e)},this.prepareCustomLibrary=async(e,t)=>this.prepare(e,void 0,t),this.prepareScript=async e=>{const t=e.localUpdates.body,a=await(0,m.uS)(e),n=await w(t,e,a);return this.prepare(n,e)},this.executeScript=async(e,t)=>{try{const a=await this.runtime.executeFunction("main",t??[]);return await this.terminateCurrentRun(e),a}catch(t){await this.terminateCurrentRun(e);const a=new n.WD("Office Script execution failed.");throw t.data?.message?.error?.code&&(a.errorCode=t.data.message.error.code),a}},this.prepare=async(e,t,a)=>{try{this.runtime=await this.runtimeTracker.getRuntime(t,a),await this.runtime.loadCode(e)}catch(e){const a=this.getPrepareScriptError(e);throw await this.terminateCurrentRun(t),a}},this.resolveMutexReleasePromise=()=>{this.mutexPromiseResolveFn&&this.mutexPromiseResolveFn()},this.mutex=new i.e,this.runtimeTracker=new v}}E.instance=()=>(E._instance||(E._instance=new E),E._instance)},6129:(e,t,a)=>{a.d(t,{LA:()=>r,gc:()=>l,pX:()=>o,u$:()=>s});let n=!1;function o(){return n}function r(e){n=e}let i=!1;function l(){return i}function s(e){i=e}},47693:(e,t,a)=>{a.d(t,{$:()=>u,b:()=>c});var n=a(67001),o=a(61150),r=a(19433),i=a(92779),l=a(5550),s=a(88099);const c="unknown";class d{constructor(e){this.activatedAnnotationTypes=new Map,this.releasedAnnotationTypes=new Map,this.annotationActivationStatus=new Map,this.clientSentMessages=new Map,this.annotationsReceived=new Map,this.connectionMessages=[],this.isActive=!0,this.sessionKey=e}}class u{static getInstance(){return u.instance||(u.instance=new u),u.instance}getSessionsMap(){return this.sessionsMap}registerUIUpdater(e){this.updateUi=e}isAugloopSessionActive(e){return void 0!==e?.getConnectParams()}async onWebSocketActivity(){this.isAugloopSessionActive(this.activeSession)?(await this.refreshSessionDiagnosticsData(),this.updatesFromAugloopCount++,this.updateUi()):(0,o.cY)(o.SA.Info,"AugloopDiagnosticsManager.onWebSocketActivity: not sending request as augloop session is inactive.")}async syncCachedActiveSessionKey(){const e=this.getActiveSessionKeyFromConnectPramas();e!==this.cachedActiveSessionKey&&(this.createSessionDiagnosticsEntryIfNotExists(e),await this.refreshSessionDiagnosticsData())}getActiveSessionKey(){return this.debouncedSyncCachedActiveSessionKey(),this.cachedActiveSessionKey}setActiveSessionKey(e){this.cachedActiveSessionKey=e}setActiveSession(e){this.activeSession=e}getActiveSession(){return this.activeSession}init(e){if(!(0,l.I_)()&&!i.MYv)return void(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.init: Not initializing in dogfood or dev build or without feature flag");this.setActiveSession(e);const t=this.getActiveSessionKeyFromConnectPramas();this.createSessionDiagnosticsEntryIfNotExists(t);const a=e;a.messageBridge={...a.messageBridge,originalSendMessage:a.messageBridge.sendMessage},a.originalHandleSessionInitResponse=a.handleSessionInitResponse,a.handleSessionInitResponse=e=>{this.onSessionInitResponse(e),a.originalHandleSessionInitResponse(e)},a.originalHandleAnnotationResults=a.handleAnnotationResults,a.handleAnnotationResults=(e,t)=>{this.onAnnotationReceived(e,t),a.originalHandleAnnotationResults(e,t)},a.messageBridge.sendMessage=e=>{this.blockAnnotationReleaseMessageEnabled&&this.isAnnotationReleaseMessage(e)||(this.onSendMessage(e),a.messageBridge.originalSendMessage(e))},a.originalHandleSessionCloseMessage=a.handleSessionCloseMessage,a.handleSessionCloseMessage=e=>{this.onSessionCloseMessage(e),a.originalHandleSessionCloseMessage(e)},a.originalHandleSessionConnectMessage=a.handleSessionConnectMessage,a.handleSessionConnectMessage=e=>{this.onSessionConnectMessage(e),a.originalHandleSessionConnectMessage(e)},a.originalHandleSessionReconnectMessage=a.handleSessionReconnectMessage,a.handleSessionReconnectMessage=e=>{this.onSessionReconnectMessage(e),a.originalHandleSessionReconnectMessage(e)},a.originalHandleSessionDisconnectMessage=a.handleSessionDisconnectMessage,a.handleSessionDisconnectMessage=e=>{this.onSessionDisconnectMessage(e),a.originalHandleSessionDisconnectMessage(e)}}isAnnotationReleaseMessage(e){return e.includes(n.GA.getTypeName())}getActiveSessionKeyFromConnectPramas(){const e=this.getActiveSession()?.getConnectParams(),t=e?.sessionUrl.split("/").pop();return t??c}async retrieveModelFromAugloop(){const e=this.getActiveSession();if(!this.isAugloopSessionActive(e))return(0,o.cY)(o.SA.Info,"AugloopDiagnosticsManager.onWebSocketActivity: not sending request as augloop session is inactive."),Promise.reject(new Error("No active session found"));const t=await e.submitCustomMessage(new r.IW);return 0===t.itemsCount?Promise.reject(new Error("Failed to retrieve model. No items found in the model response")):t}async retrieveSessionDiagnosticsFromAugloop(){const e=this.getActiveSession();return e?e.submitCustomMessage(new r.pw):Promise.reject(new Error("No active session found"))}async refreshSessionDiagnosticsData(){this.sessionsMap.forEach((e=>{e.isActive=!1}));try{const e=await this.retrieveSessionDiagnosticsFromAugloop();if(void 0===e||void 0===e.sessionKey)throw new Error("sessionKey not found in response");const t=e.sessionKey;this.createSessionDiagnosticsEntryIfNotExists(t);const a=this.sessionsMap.get(t);if(!a)throw new Error("diagnosticsSession not found for sessionKey");a.isActive=!0,a.sessionKey=e.sessionKey,a.clientMetadata=e.clientMetadata,a.sessionMode=e.sessionMode,a.isCopilotLicensed=e.isCopilotLicensed,a.isCopilotActivated=e.isCopilotActivated,a.activatedAnnotationTypes=new Map(JSON.parse(e.activatedAnnotations)),a.releasedAnnotationTypes=new Map(JSON.parse(e.releasedAnnotations)),a.annotationActivationStatus=new Map(JSON.parse(e.annotationStatus)),a.annotationsReceived=new Map(JSON.parse(e.sentAnnotations)),a.clientSentMessages=new Map(JSON.parse(e.clientSubmittedMessages)),a.isLargeWorkbookSession=e.isLargeWorkbookSession,a.observerSessionType=e.observerSessionType,a.ecsSessionId=e.ecsSessionId,a.ecsStateId=e.ecsStateId}catch(e){(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.refreshSessionDiagnosticsData: error:",e)}}onSessionInitResponse(e){if(!this.autoRefreshEnabled)return;this.createSessionDiagnosticsEntryIfNotExists(e.sessionKey);this.sessionsMap.get(e.sessionKey).sessionInitResponse=e,this.storeConnectivityMessage(e),this.debouncedOnWebSocketActivity()}onSendMessage(e){this.autoRefreshEnabled&&(e.includes(r.pw.getTypeName())||e.includes(r.Lm.getTypeName())||this.debouncedOnWebSocketActivity())}onAnnotationReceived(e,t){this.autoRefreshEnabled&&this.debouncedOnWebSocketActivity()}onSessionDisconnectMessage(e){this.handleConnectivityMessage(e)}onSessionReconnectMessage(e){this.handleConnectivityMessage(e)}onSessionConnectMessage(e){this.handleConnectivityMessage(e)}onSessionCloseMessage(e){this.handleConnectivityMessage(e)}handleConnectivityMessage(e){this.storeConnectivityMessage(e),this.autoRefreshEnabled&&this.debouncedOnWebSocketActivity()}storeConnectivityMessage(e){if(JSON.stringify(e).includes(n.uN.getTypeName())){const t=e.sessionKey;this.createSessionDiagnosticsEntryIfNotExists(t)}const t=this.getActiveSessionKey(),a=this.sessionsMap.get(t);a?a.connectionMessages.unshift(JSON.stringify(e)):(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.storeConnectivityMessage: sessionKey not found in sessions collection")}createSessionDiagnosticsEntryIfNotExists(e){e!==this.cachedActiveSessionKey&&(this.cachedActiveSessionKey===c&&this.sessionsMap.has(c)?(this.sessionsMap.set(e,this.sessionsMap.get(c)),this.sessionsMap.delete(c)):this.sessionsMap.set(e,new d(e)),this.setActiveSessionKey(e))}constructor(){this.debounceIntervalForOnWebSocketActivityMs=2e3,this.debounceIntervalForSyncingActiveSessionKeyMs=5e3,this.sessionsMap=new Map,this.cachedActiveSessionKey=c,this.updatesFromAugloopCount=0,this.autoRefreshEnabled=!1,this.blockAnnotationReleaseMessageEnabled=!1,this.updateUi=()=>{},this.debouncedOnWebSocketActivity=(0,s.debounce)(this.onWebSocketActivity,this.debounceIntervalForOnWebSocketActivityMs,{leading:!0,trailing:!0}),this.debouncedSyncCachedActiveSessionKey=(0,s.debounce)(this.syncCachedActiveSessionKey,this.debounceIntervalForSyncingActiveSessionKeyMs,{leading:!0,trailing:!1})}}},82729:(e,t,a)=>{a.d(t,{n:()=>n.n6d});var n=a(77303)},91519:(e,t,a)=>{a.d(t,{Eb:()=>l,Q9:()=>o,oR:()=>s,qH:()=>i,yu:()=>r});var n=a(77303);const o=e=>(0,n.Q9t)(e),r=()=>(0,n.yu7)(),i=async e=>(0,n.qHb)(e),l=async(e,t)=>(0,n.Ebk)(e,t),s=e=>(0,n.oRj)(e)},34813:(e,t,a)=>{a.d(t,{p:()=>De});var n,o=a(92779),r=a(7556),i=a(59777),l=a(33500),s=a(22330),c=a(26115),d=a(89099),u=a(24220),m=a(93022);!function(e){e.getInsights="getInsights",e.getColumnsFromNL="getColumnsFromNL",e.getColumnsGeneral="getColumnsGeneral",e.getConditionalFormatSuggestion="getConditionalFormatSuggestion",e.transformTableFromNL="transformTableFromNL",e.getTableSummary="getTableSummary",e.getCellsFromNL="getCellsFromNL"}(n||(n={}));const g={getInsights:'[\n    {\n        "name": "selectTables",\n        "returns": "activeTables",\n        "arguments": {}\n    },\n    {\n        "name": "getInsights",\n        "returns": null,\n        "arguments": {\n            "tables": {\n                "type": "var",\n                "name": "activeTables"\n            },\n            "instruction": {\n              "type": "string",\n              "string": "{{messageText}}"\n            }\n        }\n    }\n]',getColumnsFromNL:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "addCalculatedColumns",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        },\n        "instruction": {\n            "type": "string",\n            "string": "{{messageText}}"\n        }\n    }\n}\n]',getCellsFromNL:'[\n  {\n      "name": "selectTables",\n      "returns": "activeTables",\n      "arguments": {}\n  },\n  {\n      "name": "aggregateColumns",\n      "returns": null,\n      "arguments": {\n          "tables": {\n              "type": "var",\n              "name": "activeTables"\n          },\n          "instruction": {\n              "type": "string",\n              "string": "{{messageText}}"\n          },\n          "cell": {},\n      }\n  }\n  ]',getColumnsGeneral:'[\n{\n  "name": "selectTables",\n  "returns": "activeTables",\n  "arguments": {}\n},\n{\n  "name": "addCalculatedColumns",\n  "returns": null,\n  "arguments": {\n      "tables": {\n          "type": "var",\n          "name": "activeTables"\n      }\n  }\n}\n]',transformTableFromNL:'[\n{\n  "name": "selectTables",\n  "returns": "activeTables",\n  "arguments": {}\n},\n{\n  "name": "transformTable",\n  "returns": null,\n  "arguments": {\n    "tables": {\n        "type": "var",\n        "name": "activeTables"\n    },\n    "instruction": {\n        "type": "string",\n        "string": "{{messageText}}"\n    }\n}\n}\n]',getTableSummary:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "summarizeTable",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        }\n    }\n}\n]',getConditionalFormatSuggestion:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "conditionalFormatSuggestionPill",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        }\n    }\n}\n]'};var h=a(82729),p=a(11469),b=a(72483),f=a(20125),C=a(86378),y=a(81364),v=a(64216),T=a(61437),x=a(20057),S=a(64598),w=a(82623),E=a(75520),R=a(77303),I=a(19080),A=a(5157),L=a(97691),F=a(79029),_=a(88179),N=a(48314),k=a(61150),O=a(10216);class P{onError(e,t){switch(e){case R.FcJ.HandoffMessageResponse:case R.FcJ.NoQuery:this.renderError(R.I51);break;default:throw(0,k.cY)("Unhandled Handoff error type: "+e+(t?` Error: ${JSON.stringify(t)}`:"")),new Error(R.I51)}}renderError(e){const{message:t,telemetry:a}=(0,O.v)("HandoffMessageIdResponseHandlerError: "+e,{errorType:_.q0.ClientError,featureName:_.q.HandOff},{},{feedbackData:{feedbackArea:I.O.Footer}});b.$.getInstance().displayErrorResponseIfNeeded(t,a),F.B.getInstance().sendChatEventTelemetry((0,_.pN)({[_.h3.ChatEventType]:_.a5.HandoffMessageIdResponseError,[_.h3.ChatErrorType]:_.q0.ClientError,[_.h3.ChatErrorParameters]:e})),D.getInstance().sendHandoffUserPerceivedLatency(!0)}onAnnotationReceived(e,t,a,n){if(e===A.uC.getTypeName()){F.B.getInstance().recordCheckPoint(_._R.HandoffMessageReceived);const n=t;n.queryId&&(N.M.userQueryGuid=n.queryId,F.B.userQueryGuid=n.queryId),F.B.getInstance().sendLatencyTelemetry((0,_.pN)({[_.CT.HandoffMessageResponseTime]:(0,s.WU)(a),[_.CT.AnnotationType]:e,[_.CT.FeatureName]:_.BJ.Handoff}))}F.B.getInstance().sendChatEventTelemetry((0,_.pN)({[_.h3.ChatEventType]:_.a5.ResponseReceivedFromAL,[_.h3.ChatEventParameters]:e,[_.h3.Cv]:n??""}))}onHandoffMessageIdSubmitted(e){let t,a;switch(e.handoffOperation){case L.Q.GET:t=_.a5.HandoffMessageIdGetOperationSubmitted,a=_._R.HandoffMessageIdSent;break;case L.Q.PROCESSED:t=_.a5.HandoffMessageIdProcessedOperationSubmitted,a=_._R.HandoffMessageIdProcessed}t&&((0,k.cY)("Update telemetry for handoff message id submitted: ",t),F.B.getInstance().sendChatEventTelemetry((0,_.pN)({[_.h3.ChatEventType]:t}))),a&&F.B.getInstance().recordCheckPoint(a)}logDebug(...e){(0,k.cY)(e)}submitSignal(e,t){b.$.getInstance().submitOperation(t),F.B.getInstance().sendLatencyTelemetry((0,_.pN)({[_.CT.RequestSignalType]:e}))}submitQuery(e){b.$.getInstance().submitUserQuery(e)}}var M=a(50347);class D extends R.Q6w{static getInstance(){return D._instance||(D._instance=new D),D._instance}getHandoffMessageIdSignal(e,t,a){return new S.aO({queryId:e,handOffMessageId:t,handoffOperation:a})}isHandoffAutoSubmitPromptsEnabled(){return(0,M.yw)("OfficeVSO_9277674_isHandoffAutoSubmitPromptsEnabled")}processHandoffMessage(e){if(!e.query||0===e.query.length){const e="Handoff query is empty or undefined.";throw this.HandoffOperations.onError(R.FcJ.NoQuery,e),new Error(e)}this.handleUserQuery(e)}handleUserQuery(e){try{e.manualSendPrompt?b.$.getInstance().setInputText(e.query):this.autoExecuteQuery(e.query),this.onHandoffQueryPerceivedByUser(e)}catch(e){this.HandoffOperations.logDebug("[Handoff] Has caught error in excel: "+e.message)}}onHandoffQueryPerceivedByUser(e){let t,a;e.manualSendPrompt?(t=_.a5.HandoffQueryPerceivedByUser,a=_._R.HandoffQueryPerceivedByUser,e.query&&F.B.getInstance().setInitialHandoffQuery(e.query)):(t=_.a5.HandoffQueryAutoSubmitted,a=_._R.HandoffQueryAutoSubmitted),this.sendHandoffUserPerceivedLatency();const n={};if(e.sourceApp&&(n[_.CD.SourceApp]=e.sourceApp),e.context){const t=JSON.parse(e.context).promptType;t&&(n[_.CD.PromptType]=t)}e.scenarioName&&(n[_.CD.ScenarioName]=e.scenarioName),(0,k.cY)("Handoff query perceived by user: ",n),F.B.getInstance().sendChatEventTelemetry((0,_.pN)({[_.h3.ChatEventType]:t,[_.h3.ChatEventParameters]:JSON.stringify(n)})),e.handoffStartTime&&F.B.getInstance().recordCheckPoint(_._R.HandoffStart,e.handoffStartTime),F.B.getInstance().recordCheckPoint(a),F.B.getInstance().sendLatencyTelemetryForCheckPoints(!0)}sendHandoffUserPerceivedLatency(e){F.B.getInstance().sendLatencyTelemetry((0,_.pN)({[_.CT.UserPerceivedLatency]:(0,s.WU)(this.handoffMessageIdRequestSubmitTime)}),e)}constructor(){super(new P)}}var $=a(23247),B=a(92240),H=a(8947),U=a(93772),q=a(10748),V=a(80519),G=a(40700),W=a(5550),z=a(74511),Q=a(4475),J=a(93111),j=a(45283),Y=a(66888),X=a(84036),K=a(33851),Z=a(26731),ee=a(50857),te=a(96854),ae=a(31030),ne=a(67603),oe=a(86916),re=a(23343);function ie(){const e=[],t={staticStrings:[{key:"formulaError",value:(0,o.Obq)()},{key:"raiError",value:(0,o.KC)()},{key:"fallbackLatencyMessage",value:(0,o.I3c)()},...(0,M.yw)("OfficeVSO_8656872_ConsumeNewRaiErrorString")?[{key:"raiErrorSuccessfulActionBlockedResponse",value:(0,o.b4o)()}]:[],{key:"generalError",value:(0,o.UuN)()},...(0,M.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.SearchAndActionErrorImproved",!1)?[{key:"searchChainingError",value:(0,o.AUM)()}]:[{key:"searchChainingError",value:(0,o.RVs)()}],...(0,M.qm)()?[{key:"noTableError",value:(0,o.SCL)()}]:[]]},a=!(0,M.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse");return e.push({workflowAnnotationType:x.Yn.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout(),config:t}),e.push({workflowAnnotationType:oe.w.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:Z.Pd.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:re.R.getChatHistoryWorkflowTimeout()}),e.push({workflowAnnotationType:B.yZ.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout(),forceReturnCachedAnnotations:!0}),e.push({workflowAnnotationType:m.lL.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:m.Dv.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),(0,M.eF)()&&e.push({workflowAnnotationType:E.PM.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:E.yg.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:E.NU.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),(0,M.UD)()&&(e.push({workflowAnnotationType:$.b.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),(0,M.iP)("Microsoft.Office.Excel.FA000000124.ImportDataEnableRelevancyCheck",!0)&&e.push({workflowAnnotationType:$.D.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()})),e.push({workflowAnnotationType:p.b.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a||(0,M.yw)("OfficeVSO_9445515_FixCFTimeoutFalsePositive"),augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),(0,M.WF)()&&e.push({workflowAnnotationType:A.uC.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:re.R.getAugloopWorkflowTimeout()}),(0,M.H)()&&e.push({workflowAnnotationType:C.d.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}),e}var le=a(38924),se=a(54447);class ce{async handleSharedLoggingEvent({event:e,args:t}){switch((0,k.cY)("client logging event received\n\tevent - ",e,"\n\targs: ",t),e){case i.Yk.ALSessionInitialized:return this.onALSessionInitialized(t);case i.Yk.AnnotationActivated:return this.onAnnotationActivated(t);case i.Yk.AugloopErrorReceived:return this.onAugloopErrorReceived(t);case i.Yk.ChatHistorySignalSent:return this.onChatHistorySignalSent(t);case i.Yk.ChatHistoryResponseReceived:return this.onChatHistoryResponseReceived(t);case i.Yk.ChatPaneInitalized:return this.onChatPaneInitialized(t);case i.Yk.ChatPaneLoaded:return this.onChatPaneLoaded(t);case i.Yk.CopyButtonClicked:return this.onCopyButtonClicked(t);case i.Yk.SubmitButtonClicked:return this.onSubmitButtonClicked(t);case i.Yk.MenuButtonItemClicked:return this.onMenuButtonItemClicked({event:e,args:t});case i.Yk.SuggestionPillClicked:return this.onSuggestionPillClicked(t);case i.Yk.ZQMLoaded:return this.onZQMLoaded({event:e,args:t});case i.Yk.ZQMButtonItemClicked:return this.onZQMButtonItemClicked({event:e,args:t});default:return this.defaultCallback({event:e,args:t})}}defaultCallback(e){this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.SharedCopilotChatLogEvent,[_.h3.ChatEventParameters]:JSON.stringify(e)},this.telemetryLogger)}onChatPaneInitialized(e){this.copilotChatBootStartTime=e?.timestamp??Date.now()}onAugloopErrorReceived(e){const t=JSON.parse(e?.chatEventParams??"{}");this.telemetryLogger.logError({eventType:ae.S.Augloop,logLevel:_.$b.Warning,errorMessage:`Augloop Error: code - ${t?.errorCode}`},this.telemetryLogger.getDefaultEventFlags())}onALSessionInitialized(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryLatencyData({[_.CT.AugloopInitializationTime]:t},this.telemetryLogger)}onAnnotationActivated(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.AnnotationActivated,[_.h3.ChatEventParameters]:JSON.stringify({activeAnnotations:this.getActiveAnnotationTypes()})},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[_.CT.AnnotationActivationTime]:t},this.telemetryLogger)}onChatHistorySignalSent(e){e&&e.operationType===ee.S5.GetCurrentChatOperation&&(this.chatHistorySignalTime=e.timestamp??Date.now())}onChatHistoryResponseReceived(e){if(!e||e.operationType!==ee.S5.GetCurrentChatOperation)return;const t=this.getDurationInSeconds(this.chatHistorySignalTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.ChatHistoryLoaded},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[_.CT.ChatHistoryLoadTime]:t},this.telemetryLogger)}onChatPaneLoaded(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,e?.timestamp);this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.ChatPaneLoaded,[_.h3.ChatEventParameters]:JSON.stringify({copilotEntryPoint:W.Vv.getSettingAsString(W.zj.CopilotEntryPoint)})},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[_.CT.ChatPaneLoadTime]:t},this.telemetryLogger)}onCopyButtonClicked(e){this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.CopyButtonClicked},this.telemetryLogger)}onSubmitButtonClicked(e){this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.SubmitButtonClicked},this.telemetryLogger)}static handleZqmLoadedLoggingEvent(e){const t=N.M.getInstance(),a=(0,le.dW)(),n=(0,le.eD)();for(const o of e?.promptSuggestionList??[])switch(o.suggestionText){case a[ne.fM.Search]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.Search):t.logSeenEvent(_.q.Search);break;case a[ne.fM.FormulaAction]:case n[ne.X6.SuggestColumn]:case n[ne.X6.WriteFormula]:case n[ne.X6.AddFormulaColumn]:case n[ne.X6.SplitColumns]:case n[ne.X6.CombineColumns]:case n[ne.X6.LookupFormula]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.CalculatedColumns):t.logSeenEvent(_.q.CalculatedColumns);break;case n[ne.X6.TotalRow]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.CalculatedRows):t.logSeenEvent(_.q.CalculatedRows);break;case a[ne.fM.HowToSum]:case n[ne.X6.ExplainFormula]:case n[ne.X6.InvestigateError]:case n[ne.X6.CreateTable]:case n[ne.X6.KeyboardShortcuts]:case n[ne.X6.TipsAndTricks]:case n[ne.X6.FreezeColumn]:case n[ne.X6.HowToUnpivot]:case n[ne.X6.HowToCreateDropdown]:case n[ne.X6.HowToWriteFormula]:(0,se.mN)(t);break;case a[ne.fM.Python]:case n[ne.X6.GetDataInsights]:case n[ne.X6.AdvancedAnalysis]:case n[ne.X6.PerformForecasting]:case n[ne.X6.CreateBoxplot]:case n[ne.X6.SetOfCharts]:case n[ne.X6.GenerateWordCloud]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.Python):t.logSeenEvent(_.q.Python);break;case n[ne.X6.DataPreparation]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.DataShaping):t.logSeenEvent(_.q.DataShaping);break;case a[ne.fM.Insights]:case n[ne.X6.SummarizeColumn]:case n[ne.X6.ShowDataInsights]:case n[ne.X6.SumByCategory]:case n[ne.X6.CreatePivotTable]:case n[ne.X6.CreatePieChart]:case n[ne.X6.GenerateGraph]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.AnalyzeData):t.logSeenEvent(_.q.AnalyzeData);break;case a[ne.fM.HighlightAction]:case n[ne.X6.HighlightDuplicates]:case n[ne.X6.HighlightCells]:case n[ne.X6.ApplyColorCoding]:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.Commanding):t.logSeenEvent(_.q.Commanding);break;case n[ne.X6.WebSearchCreateTable]:case n[ne.X6.WebSearchTravel]:case n[ne.X6.WebSearchLearn]:case n[ne.X6.ImportTable]:case n[ne.X6.PrepareForMeetings]:F.B.getInstance().logSeenEvent(_.q.Search);break;default:(0,M._K)()?F.B.getInstance().logSeenEvent(_.q.CopilotChat):t.logSeenEvent(_.q.CopilotChat)}}sendLoggingEventToPane(e,t){switch(this.telemetryLogger||(this.telemetryLogger=N.M.getInstance()),e){case i.Yk.ZQMLoaded:(0,k.cY)("ZQM Loaded: ${loggingEventArgs}"),ce.handleZqmLoadedLoggingEvent(this.zeroQueryMessageProps);break;case i.Yk.MenuButtonItemClicked:(0,k.cY)(`Menu Button Item Clicked: ${t}`)}}onZQMButtonItemClicked({event:e,args:t}){this.telemetryLogger.setQuerySource(_.BC.ZQM),F.B.getInstance().setQuerySource(_.BC.ZQM),this.defaultCallback({event:e,args:t})}onZQMLoaded({event:e,args:t}){this.sendLoggingEventToPane(e,t)}onMenuButtonItemClicked({event:e,args:t}){this.telemetryLogger.setQuerySource(_.BC.MenuItem),F.B.getInstance().setQuerySource(_.BC.MenuItem),this.sendLoggingEventToPane(e,t)}onSuggestionPillClicked(e){this.telemetryLogger.setQuerySource(_.BC.SuggestionPill),F.B.getInstance().setQuerySource(_.BC.SuggestionPill),this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.BasicChatSuggestionClicked},this.telemetryLogger)}getDurationInSeconds(e,t,a){return a?this.toSeconds(a):this.toSeconds((t??Date.now())-e)}toSeconds(e){return e/1e3}getActiveAnnotationTypes(){return ie().map((e=>e.workflowAnnotationType))}constructor(e){this.telemetryLogger=N.M.getInstance(),this.telemetryEventHandler=te.E.getInstance(),this.copilotChatBootStartTime=0,this.chatHistorySignalTime=0,this.zeroQueryMessageProps={promptSuggestionList:[]},this.zeroQueryMessageProps=(0,le.uC)({disableButtons:!1},e)}}var de=a(74840),ue=a(6925),me=a(72842),ge=a(46224),he=a(35828),pe=a(23147),be=a(63305),fe=a(98100),Ce=a(24180),ye=a(59367),ve=a(41102),Te=a(98974),xe=a(59726);var Se=a(71362);var we=a(37745),Ee=a(43811);var Re=a(25594),Ie=a(37488),Ae=a(58632),Le=a(90489),Fe=a(78640),_e=a(6129),Ne=a(72763),ke=a(55683),Oe=a(98483),Pe=a(37542).hp;const Me={"flux-getInsights":"get_insights","flux-createCalculatedColumns":"calculated_columns;create_columns","flux-editDocument":"edit_document","flux-dataShaping":"data_shaping","flux-createCalculatedCell":"calculated_columns;aggregate","flux-pythonAda":"get_python_code","flux-pythonCalculatedColumns":"python_calculated_columns","flux-importData":"import_data"};class De extends r.h{get isModelWorkflowSupported(){return!this.sessionRestartedDueToModelWorkflowNotSupported}static getInstance(e,t,a,n,o=[],r){return De.instance||(De.instance=new De(e,t,a,n,r,o)),De.instance}static getInstanceNoCreate(){return De.instance}updateClientInfo(e){this.clientInfo=e}setSuggestionList(e){e.forEach((e=>{const t=(0,de.eW)(e.suggestionType);t&&((0,M._K)()?F.B.getInstance().logSeenEvent(t):this.telemetryLogger.logSeenEvent(t))})),this.suggestionList=e}setZqmSuggestionList(e){const t=(0,le.uC)({disableButtons:!1},e);ce.handleZqmLoadedLoggingEvent(t)}set cannedOption(e){te.E.getInstance().updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.SkillOverride,[_.h3.ChatEventParameters]:`[{"skillOverride": ${e}]`},this.telemetryLogger),this._cannedOption=e}get cannedOption(){return this._cannedOption}setZeroQueryMessageTitles(e){this.zeroQueryMessageTitles=e}sendResponseToClient(e,t,a){if(e.body?.H_)switch(e.body.H_.T_){case x.jR.getTypeName():case x.Yn.getTypeName():this.responseHandler.handleResponse(e,this.clientInfo);break;case B.yZ.getTypeName():this.onExcelTableRecognitionAnnotationResult(e,a);break;case Z.tP.getTypeName():(0,k.cY)("Received SharedCopilotChatHistoryAnnotation, not handled yet");break;case m.lL.getTypeName():this.onCalculatedColumnAnnotationResult(e);break;case m.Dv.getTypeName():this.onCalculatedCellAnnotationResult(e);break;case E.NU.getTypeName():(0,Ae.o)(e,e.body.requestId);break;case $.b.getTypeName():(0,M.yw)("OfficeVSO_9523129_refactorCitationSignalAwait")?(0,Ae.o)(e,e.body.requestId):(0,Le.bn)(e);break;case $.D.getTypeName():(0,M.yw)("OfficeVSO_9523129_refactorCitationSignalAwait")?(0,Ae.o)(e,e.body.requestId):(0,Le.RD)(e);break;case p.b.getTypeName():this.onConditionalFormattingSuggestionAnnotationResult(e);break;case A.uC.getTypeName():D.getInstance().handleHandoffMessage(e,t);break;default:(0,k.cY)("sendResponseToClient: No matching annotation found")}(0,k.cY)(`sendResponseToClient - Item: ${JSON.stringify(e)}`)}updateCopilotState(e){(0,k.cY)(`updateCopilotState: ${e}`),e===i.SG.QUERY_SUBMITTED&&this.telemetryLogger.startTriedActivity()}sendLoggingEventToClient(e,t){this.loggingEventHelper.handleSharedLoggingEvent({event:e,args:t}).catch((t=>{N.M.getInstance().logError({eventType:ae.S.ChatEvents,logLevel:_.$b.Warning,errorMessage:`Failed to log share copilot logging event; ${{event:e,error:t?.message}}`},this.telemetryLogger.getDefaultEventFlags())}))}isFeatureGateEnabledFromClient(e){switch(e){case l.WT.SkipHydrateEnabled:return!(0,M.yw)("OfficeVSO_8996286_reenablingRehydration");case l.WT.HydratedMessagesSquashingEnabled:return(0,M.yw)("OfficeVSO_8996286_reenablingRehydration");case l.WT.IsApplyClpFromHydratedMessagedEnabled:return(0,M._b)();case l.WT.EnableRestrictiveSearchBanner:case l.WT.IsPersistanceInPhase2UxEnabled:return(0,M.vI)()&&(0,M.Dl)();case l.WT.IsSharedCopilotLabEnabled:return!0;case l.WT.IsWebSearchDefaultOn:return(0,M.iP)("Microsoft.Office.Excel.FA000000124.IsWebSearchDefaultOn",!0)&&(0,M.vI)();case l.WT.EnableSendTenantFeedback:return(0,M.RE)();default:return(0,M.iP)(`Microsoft.Office.Excel.FA000000124.${e}`,!1)}}getWorkflowsToRegister(){(0,k.cY)("registering workflows"),(0,k.cY)(`session restarted due to model workflows not supported: ${this.sessionRestartedDueToModelWorkflowNotSupported}`),(0,M.yw)("OfficeVSO_8772262_updateAugloopModelStatusOnAppState2")&&(this.responseHandler.setAugloopModelWorkflowUnsupported(this.sessionRestartedDueToModelWorkflowNotSupported),this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.AugLoopSessionModelWorkflowUnsupported,[_.h3.ChatEventParameters]:JSON.stringify({modelWorkflowNotSupported:this.sessionRestartedDueToModelWorkflowNotSupported})},this.telemetryLogger));return function(e){const t=ie();return e?t.filter((e=>e.workflowAnnotationType!==B.yZ.getTypeName()&&e.workflowAnnotationType!==E.PM.getTypeName()&&e.workflowAnnotationType!==E.yg.getTypeName()&&e.workflowAnnotationType!==E.yg.getTypeName())):t}(this.sessionRestartedDueToModelWorkflowNotSupported)}async sendEventToClient(e,t){switch((0,k.cY)(`sendEventToClient - event: ${e}`,{eventArgs:t}),(0,M.yw)("OfficeVSO_9371414_ChatHistorySignalEvent")&&t&&this.debugEvents.dispatchEvent(new CustomEvent(String(e),{detail:t})),e){case i.PV.AugloopResponseTimeout:(0,k.cY)("AUGLOOP_RESPONSE_TIMEOUT:",{eventArgs:t}),this.handleAugloopResponseTimeout(t.workflowAnnotationType);break;case i.PV.AnnotationActivated:if((0,k.cY)(`Annotation Activated: ${t.workflowAnnotationType}`),t.workflowAnnotationType===A.uC.getTypeName()){const e=D.getInstance().getDocumentHandoffMessageId();D.getInstance().sendHandoffMessageId(L.Q.GET,e)}break;case i.PV.StopGeneratingButtonClicked:(0,k.cY)("Stop Generating Button Clicked:",{eventArgs:t}),this.handleStopButtonOnClick();break;case i.PV.CopilotChatLoaded:if(b.$.getInstance().clearLoadingPaneTimeout(),(0,k.cY)("Copilot Chat Loaded:",{eventArgs:t}),(0,fe.sZ)(),F.B.getInstance().logTelemetryForSharedChatPaneLoad(),await this.handleStartQuery(),(0,M.yw)("OfficeVSO_9113126_copilotchatrefnulltimeoutfix")&&(0,we.C6)()){const{message:e,telemetry:t}=Se.n.getLanguageUnavailableResponse();b.$.getInstance().displayResponse(e,t)}W.Vv.IsSettingTrue(W.zj.ExcelSdxPrivateApiEnabled)&&(void 0===Ie.preloadCopilot||Ie.preloadCopilot&&Ie.hasPreloadedCopilotBeenShown)&&this.attachPrivateApiHandler();break;case i.PV.BasicChatSuggestionPills:(0,k.cY)("SuggestionPills event triggered:",{eventArgs:t});break;case i.PV.CitationLinkClicked:(0,k.cY)("Citation Link Clicked:",{eventArgs:t});break;case i.PV.ChatTopicChanged:(0,k.cY)("Chat Topic Changed:",{eventArgs:t}),this.handleChangeTopicButtonOnClick();break;case i.PV.ChatHistoryHydrationFailed:(0,k.cY)("Chat History Hydration Failed:",{eventArgs:t}),(0,M.yw)("OfficeVSO_9389712_noHydrationFailedASHA")||this.handleChatHistoryHydrationFailed();break;case i.PV.BasicChatStatus:(0,k.cY)("Basic Chat Status:",{eventArgs:t});break;case i.PV.QuerySubmitted:(0,k.cY)("Query Submitted:",{eventArgs:t});break;case i.PV.ResetContextId:(0,k.cY)("Reset Context Id:",{eventArgs:t});break;case i.PV.PluginsStateUpdated:(0,k.cY)("Plugin state updated",{eventArgs:t});if((0,M.vI)()&&!(0,M.oJ)()&&((0,M.HS)()||!(0,M.UL)())){t.pluginsInfo.findIndex((e=>e&&e.id===o.VMi&&e.state===o.hiv))>=0&&((0,_e.LA)(!0),this.setEnterpriseSearchIsEnabled&&this.setEnterpriseSearchIsEnabled(!0),(0,k.cY)("ExcelCopilotChat: Enterprise search is enabled by default"),this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.GroundingSourceUpdated,[_.h3.ChatEventParameters]:"Work:AutoOn"}))}break;case i.PV.UpdateChatClpFromChatHistory:{(0,k.cY)("Update Chat Clp From Chat History:",{eventArgs:t});const e=t?.messagesClpLabels,a=await h.n.getInstance().updateSdxSensitiveLabelFromChatHistory(e);this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.ClpLabelUpdateFromChatHistory,[_.h3.ChatEventParameters]:"result: "+a},this.telemetryLogger);break}case i.PV.PythonExitAnalysisButtonClicked:(0,k.cY)("Python Exit Analysis:",{eventArgs:t}),this.handlePythonExitAnalysis();break;case i.PV.SharedHeaderRendered:(0,M.aC)()&&!window.StaticHeaderLoadTime&&(0,Te.hC)(),(0,k.cY)("Shared Header Rendered:",{eventArgs:t});break;case i.PV.QueryEndOnGptSwitch:(0,k.cY)("Query End On Gpt Switch:",{eventArgs:t}),this.handleStopQueryWhenGptSwitched();break;case i.PV.NewChatButtonClicked:(0,k.cY)("New Chat Button Clicked:",{eventArgs:t});break;case i.PV.DifferentChatOpened:(0,k.cY)("Different Chat Opened:",{eventArgs:t});break;case i.PV.CreateNewConversationButtonClicked:(0,k.cY)("Create New Conversation Button Clicked:",{eventArgs:t});break;case i.PV.LowOnCredits:(0,k.cY)("Low on credits:",{eventArgs:t});break;case i.PV.OutOfCredits:(0,k.cY)("Out of credits:",{eventArgs:t});break;case i.PV.StartNewChatCalled:(0,k.cY)("Start New Chat Called:",{eventArgs:t});break;default:(0,k.cY)(`Unhandled event: ${e}`,{eventArgs:t}),(0,me.x)(e)}}async handleChangeTopicButtonOnClick(){const{message:e,telemetry:t}=Se.n.getChangeTopicResponse();this.copilotChatUIHelper.displayResponse(e,t),this.dispatch(ue.mF.showZeroStateSuggestionList()),J.y.getInstance().clearODSLCache()}async handleCommandExecutionStart(e,t,a){(0,k.cY)(e),(0,M.ge)()&&await pe.CP.releaseContextLock(),N.M.userQueryGuid=t,N.M.userQueryOrder++,this.telemetryLogger?.resetActiveFeature(),F.B.userQueryGuid=t,F.B.getInstance().resetActiveFeature(),(0,M.yw)("OfficeVSO_9260844_FixContextTreeBuildTime")?this.dispatch(ue.mF.startExecutingAndLockContext(_.OP.FluxReasoning,t)):(pe.CP.lockContextRefresh(),this.dispatch(ue.mF.startExecutingCommand({command:_.OP.FluxReasoning,id:t}))),this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:a,...(0,_.j)(pe.CP)},this.telemetryLogger);const n=(new Date).getTime();this.copilotChatUIHelper.setLastUserUtterance(e),this.responseHandler.setAugloopSignalSentTime(n),(0,M.cT)()&&((0,k.cY)(`Setting User Utterance for ${t} to "${e}"`),this.dispatch(Ne.m.setQueryUserUtterance({queryId:t,userUtterance:e})));const o=(0,_.xJ)(n);this.telemetryEventHandler.updateTelemetryLatencyData({[_.CT.ContextTreeBuildTime]:(0,s.WU)(n),[_.CT.Duration]:o,[_.CT.OperationName]:_.OP.ContextTreeBuild,[_.CT.IsSuccessful]:!0},this.telemetryLogger),(0,k.cY)(`Context Tree Build. Time Taken ${o/1e3} sec`)}async getDefaultSignalOperation(e,t,a,n,r,i,l,s,d,u,m,g){await this.handleCommandExecutionStart(e,t,_.a5.UserUtteranceSubmitted);const h=l?.map(R.piD)[0],p=l?.length??0;void 0===h&&l&&p>0&&((0,k.cY)(`Invalid image data URI in image chat: ${l[0]}`),F.B.getInstance().sendErrorTelemetry((0,_.pN)({[_.IC.ErrorMessage]:"Image chat bad image data URI in getFluxInputSignal",[_.IC.ErrorCategory]:ae.S.ImageChat}))),p>0&&((0,k.cY)(`image chat image count: ${p}`),F.B.getInstance().sendChatEventTelemetry((0,_.pN)({[_.h3.ChatEventType]:_.a5.TriggerImageChatOperation,[_.h3.ChatEventParameters]:`image chat image count: ${p}`,[_.h3.UserQueryGuid]:t})));const f=((0,M.yw)("OfficeVSO_9483632_fluxOverrideForMessage")?this.getFluxSkillOverrideForMessage(e):void 0)??this.getFluxSkillOverride();q.Q.getInstance().startRecordingFluxWorkflow();const C=await(0,fe.mm)(pe.CP,e,t,a,f,r,i,h,(0,M.Pz)()?s:void 0,d,m,g,this.getUserQueryLanguageIfSkippingLanguageDetection(e)),y=new c.g0({parentPath:["Signal",S.qO.getTypeName()],items:[{id:j.r.generateId(),body:C}]}),v=Pe.byteLength(JSON.stringify(y));if(v>o.dKK)throw b.$.getInstance().stopLoadingUi(),(0,M.yw)("OfficeVSO_9440123_LogMessageSizeWhenTooBigForAugloop")&&pe.CP.pythonContextManager.isPythonMode&&(0,K.fU)(v,Pe.byteLength(JSON.stringify(pe.CP)),Pe.byteLength(JSON.stringify(e)),Pe.byteLength(JSON.stringify(r)),Pe.byteLength(JSON.stringify(h))),new Error(`Message size exceeds AugLoop limit.  Size: ${v}`);this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.QuerySubmittedToAL},this.telemetryLogger);const T={operation:y,workflowAnnotationType:(0,M.yw)("OfficeVSO_9280423_AnnotationTypeForALTimer")?x.Yn.getTypeName():S.qO.getTypeName()};if((0,G.z)()){const e=pe.CP.getActiveTable();e&&await G.g.getInstance().showGridFoil(e.address)}return(0,k.cY)(`getDefaultSignalOperation: ${JSON.stringify(T,void 0,4)}`),T}getUserQueryLanguageIfSkippingLanguageDetection(e){if((0,Ee.XX)().some((t=>t.suggestionText.toLowerCase()===e.toLowerCase())))return(0,we.gl)()}deductCopilotCredit(e){const t=new f.v({scenarioGuid:w.ss,interactionId:e,interactionSessionId:v.s.getInstance().getConversationId()??""}),a={operation:new c.g0({parentPath:["Signal",f.v.getTypeName()],items:[{id:j.r.generateId(),body:t}]}),workflowAnnotationType:C.d.getTypeName()};b.$.getInstance().submitOperation(a)}anyHandledMessage(e){return(!(0,M.yw)("OfficeVSO_9463020_excelDisengagementErrorHandling")||!v.s.getInstance().hasSeenDisengagedError()||0===e.status)&&(!(void 0!==e.messagesToAddOrReplace&&(0,k.Pk)(e.messages)&&(0,k.Pk)(e.messagesToUpdate)&&(0,k.Pk)(e.messagesToDelete))||e.messagesToAddOrReplace.some((e=>v.s.getInstance().isHandledResponseMessage(e))))}async shouldIgnoreResponse(e){if(e.body?.H_)switch(e.body.H_.T_){case x.jR.getTypeName():case m.lL.getTypeName():case m.Dv.getTypeName():case E.De.getTypeName():case Z.tP.getTypeName():case B.yZ.getTypeName():case $.b.getTypeName():case p.b.getTypeName():case A.uC.getTypeName():return!1;case x.Yn.getTypeName():{if(!(0,M.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse"))return!1;if(!x.Yn.typeGuard(e.body))return!1;const t=e.body;return void 0!==t&&void 0!==t.chatResponse&&void 0===t.odslResponse&&!this.anyHandledMessage(t.chatResponse)}default:return(0,k.cY)("shouldIgnoreResponse: No matching annotation found"),N.M.getInstance().logError({eventType:ae.S.Augloop,errorMessage:`No matching annotation found for type: ${e.body.H_.T_}`,logLevel:_.$b.Warning}),!0}return!0}async getALSession(){return(0,ve.qD)()}initializeAlCallbacks(){(0,ve.UC)((async()=>{})),(0,ve.jl)((async(e,t)=>{this.sessionRestartedDueToModelWorkflowNotSupported=t,b.$.getInstance().startReinitializeALSession(),(0,M.yw)("OfficeVSO_8772262_updateAugloopModelStatusOnAppState")&&this.responseHandler.setAugloopModelWorkflowUnsupported(t),N.M.getInstance().logError({eventType:ae.S.Augloop,errorMessage:"Augloop session restarted",logLevel:_.$b.Warning},void 0,[{key:"UnsupportedWorkflow",value:t}])})),(0,ve.s6)((()=>{(0,k.cY)("AugLoop session closed on permanent error."),this.dispatch(Fe.mF.setIsPermanentError(!0)),(0,M.yw)("OfficeVSO_9352165_LogPermanentErrorOnSet")&&N.M.getInstance().logStandardizedAshaErrorEvent(u.W.User_Input_Could_Not_Be_Processed,d.c.Input_Failed_Due_To_Augloop_Session_Close,_.BJ.CopilotChat),N.M.getInstance().logError({eventType:ae.S.Augloop,errorMessage:"AugLoop connection closed on permanent error.",logLevel:_.$b.ASHA})}))}getHostSettings(){const e={appName:Office.context.diagnostics.host.toString(),appPlatform:z.i.GetHostAppPlatform().toString().toUpperCase(),devBuild:(0,k.K_)(),environment:i.DF.DOGFOOD,sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com",substrateScenarioName:o.rGh[z.i.GetHostAppPlatform().toString().toUpperCase()],...(0,M.yw)("OfficeVSO_9302077_AddLanguageToGetHostSettings")?{language:(0,we.gl)()}:{},sessionStorageKey:this.getSessionStorageKey()};return(0,M.mO)()&&(e.feedbackSettings=(0,be.f)()),e}getSessionStorageKey(){const e=window.Office.context,t=e?.platform;let a;const n=e?.hostSettings?._settings?.IsCopilotPreloaded;if(t===window.Office.PlatformType.OfficeOnline)a=e?.hostSettings?.get("AppStartTimestamp");else if(n){const t=e?.document?.settings?._clientSettingsManager?._osfClientContext;let n=t?.GetCorrelationId();const o=t?.GetDocUrl();n&&(n=n.replace(/[{}]/g,"")),o&&n&&(a=`${n}${"string"==typeof o?btoa(o):""}`)}return a}async setPythonContext(e,t){let a=!0;return pe.CP.pythonContextManager.lastPythonUserRequestId=(0,Oe.A)(),(0,M.yw)("OfficeVSO_9511880_PythonAAAddResultsInAnotherSheetBugFixes")&&(0,M.SA)()&&this.dispatch(ue.mF.startNewPythonQuery()),(0,M.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(t&&(N.M.userQueryGuid=t,F.B.userQueryGuid=t),(0,X.F5)()),(0,M.H2)()&&(a=await pe.CP.pythonContextManager.setPythonAdaContext(pe.CP.isPythonCellSelected,e,pe.CP.selectedPythonSheetId,pe.CP.selectedPythonAddress)),a}async shouldSendRequestToAugloop(e,t,a,n){if(this.onNewUserUtterance(),(0,M.WF)()&&F.B.getInstance().sendHandoffQuerySubmittedEvent(e),"python"===this.cannedOption)return await this.setPythonContext(e,n),(0,k.cY)("Canned option set - Showing Python card"),(0,M.H2)()&&((0,M.yw)("OfficeVSO_9544967_PythonTriedFixes")&&this.updateCopilotState(i.SG.QUERY_SUBMITTED),this.responseHandler.showPythonStartAnalysisCard((0,Oe.A)(),!1)),!1;const r=((e,t)=>{if((0,fe.jZ)(e)){(0,fe.cY)("Help query detected:"+e);const{message:a,telemetry:n}=Se.n.getHelpQueryResponse();return b.$.getInstance().displayResponse(a,n),t(ue.mF.showZeroStateSuggestionList()),!1}if(e===(0,o.vMn)()){const{message:e,telemetry:a}=Se.n.getLearnMoreResponse();return b.$.getInstance().displayResponse(e,a),t(ue.mF.showZeroStateSuggestionList()),!1}return!0})(e,this.dispatch);if(!r)return this.telemetryLogger.endTriedActivityFailure(),!1;const l=this.suggestionList.find((t=>t.suggestionText.toLowerCase()===e.toLowerCase()));if((0,M.yw)("OfficeVSO_9205086_LogSuggestionPillExecutes")&&l){const e=n??(0,Oe.A)();N.M.userQueryGuid=e,F.B.userQueryGuid=e,this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.SuggestionPaneSuggestionClicked,[_.h3.ChatEventParameters]:l.suggestionType},this.telemetryLogger),n=e}const s=this.getShouldHandleSuggestionClientSide(l);if(l&&s)return this.handleSuggestionPillClick(l,n),!1;l&&(0,M.yw)("OfficeVSO_9318449_TlrImprovementsSuggestionPills")&&this.resetUnsupportedTlrPromptSuggestions(l);const c=Object.values(this.zeroQueryMessageTitles).find((t=>t.toLowerCase()===e.toLowerCase()));if(n&&(c||l)&&this.dispatch(ue.mF.setZqmOrPillQueryId(n)),(0,M.H2)())if(pe.CP.pythonContextManager.shouldGenerate=!0,(0,M.yw)("OfficeVSO_9507882_checkIfPythonAnalysisSheetExistsStateless")){const e=await(0,ge.J7)(pe.CP);pe.CP.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit=e}else await(0,ge.TI)(pe.CP);if((0,M.yw)("OfficeVSO_9397167_PythonFlightProtectPath")&&(0,M.H2)()||!(0,M.yw)("OfficeVSO_9397167_PythonFlightProtectPath")){if(!await this.setPythonContext(e,n))return(0,M.yw)("OfficeVSO_9544967_PythonTriedFixes")?this.telemetryLogger.endTriedActivityFailure(_.q.Python):this.telemetryLogger.endTriedActivityFailure(),!1;if((0,M.yw)("OfficeVSO_9261865_PythonADABypassIntentRouting")&&!pe.CP.pythonContextManager.isPythonMode&&c&&c===(0,o.ONP)()){if((0,M.yw)("OfficeVSO_9297798_PythonZQMPrereqs")){(0,M.yw)("OfficeVSO_9544967_PythonTriedFixes")&&this.updateCopilotState(i.SG.QUERY_SUBMITTED);try{(0,he.iY)("en-us")}catch(e){return(0,M.yw)("OfficeVSO_9544967_PythonTriedFixes")?this.telemetryLogger.endTriedActivityFailure(_.q.Python):(0,M.yw)("OfficeVSO_9521943_PythonSTKFixes")&&this.telemetryLogger.endTriedActivityFailure(),(0,he.Kx)(this.dispatch,e,"shouldSendRequestToAugloop"),!1}}return this.responseHandler.showPythonStartAnalysisCard((0,Oe.A)(),!0),(0,M.yw)("OfficeVSO_9521943_PythonSTKFixes")&&!(0,M.yw)("OfficeVSO_9544967_PythonTriedFixes")&&this.telemetryLogger.endTriedActivitySuccess(_.q.Python),!1}}if((0,M.vo)()&&await(pe.CP.pythonCalculatedColumnContextManager?.updatePythonColumns()),(0,M._b)()){if(!await(0,R.aWC)())return(0,k.cY)("Sensitivity Label APIs failed, not sending request to AL"),Promise.resolve(!1)}return!0}getFluxSkillOverrideForMessage(e){const t=Object.values(this.zeroQueryMessageTitles).find((t=>t.toLowerCase()===e.toLowerCase()));if((0,M.eF)()&&Office.context.platform===Office.PlatformType.OfficeOnline&&!this.dispatch(ue.mF.getDataShapingState()).started&&t===(0,o.On3)())return Me["flux-dataShaping"]}getShouldHandleSuggestionClientSide(e){return!!e&&(e.suggestionType!==de.hC.Commanding_Suggestion&&(e.suggestionType===de.hC.AnalyzeData_InsertAll||e.suggestionType===de.hC.GiveMeMorePrompts||e.suggestionType===de.hC.Commanding_TellMe||e.suggestionType===de.hC.AnalyzeData_ShowMore||e.suggestionType===de.hC.CalculatedColumns_ShowMore||e.suggestionType===de.hC.AnalyzeData_ShowCharts||e.suggestionType===de.hC.AnalyzeData_ShowMoreCharts||e.suggestionType===de.hC.AnalyzeData_ShowPivotTables||e.suggestionType===de.hC.AnalyzeData_ShowMorePivotTables||e.suggestionType===de.hC.AnalyzeData_InsertAllCharts||e.suggestionType===de.hC.ConditionalFormat_Suggestion||e.suggestionType===de.hC.ImportDataFromFile))}getFeedbackData(){return(0,Te.M5)()}feedbackButtonClicked(e,t,a,n,o){(0,k.cY)("Feedback clicked");const r=t?.feedbackArea??U.Xw.CHATEXCEL,l=e===i.Gb.LIKE?U.Zi.Like:U.Zi.Dislike;if((0,M.yw)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")){const a=JSON.parse(t?.contextData?.cardMetaData??"{}");e===i.Gb.LIKE?this.telemetryLogger?.logThumbsUpEvent(r,a?.suggestionId,a?.promptId,a?.groundingMode):this.telemetryLogger?.logThumbsDownEvent(r,a?.suggestionId,a?.promptId,a?.groundingMode)}let s=(0,U.mh)(t?.contextData,e===i.Gb.LIKE?U.uo.AIThumbsUp:U.uo.AIThumbsDown),c="";try{const e=JSON.parse(t?.contextData?.cardMetaData??"{}");let a,n;(0,M.yw)("OfficeVSO_8854181_SimplifyChatHistoryForOCV")&&r===U.Xw.PYTHON&&(a=pe.CP.pythonContextManager.getPythonAdaContext(),n=pe.CP.pythonContextManager.pythonContextBuilder.getPythonPrompt());let o={};(0,M.yw)("OfficeVSO_9413108_AddPythonDevButtonDetailsToOCVDetails")&&r===U.Xw.PYTHON&&(o=pe.CP.pythonContextManager.ocvErrorDetails),c=JSON.stringify({...e,chatHistory:(0,M.yw)("OfficeVSO_8854181_SimplifyChatHistoryForOCV")?this.copilotChatUIHelper.getChatHistory():this.copilotChatUIHelper.getChatLog(),pythonContext:a,pythonPrompt:n,pythonOCVErrorDetails:o})}catch(e){c="Error while creating CardMetaData"}if((0,M.mO)())return(0,M.yw)("OfficeVSO_9282712_AddClientNameForAppChatFeedback")&&(t.contextData={...t.contextData,feedbackClientAppName:this.getfeedbackCientAppName(),featureName:this.telemetryLogger?.feedbackAreaToFeatureName(r)}),t={...t,contextData:{...t?.contextData,cardMetaData:c}},void super.feedbackButtonClicked(e,t,a,n,o);s=(0,U.mh)({cardMetaData:c},e===i.Gb.LIKE?U.uo.AIThumbsUp:U.uo.AIThumbsDown);let d=U.NX.ModalDialog;Office.context.platform===Office.PlatformType.PC&&(d=U.NX.Taskpane),(0,U.N6)(l,d,r,s)}async copyButtonClicked(e,t,a){(0,k.cY)("Copy button clicked called"),(0,Q.Kv)(e,t,a)}getfeedbackCientAppName(){let e="XLWeb";switch(z.i.GetHostAppPlatform()){case Office.PlatformType.PC:e="XLWin32";break;case Office.PlatformType.Mac:e="XLMac";break;case Office.PlatformType.iOS:e="XLiOS"}return e}async handleAugloopResponseTimeout(e){if(this.responseHandler.markRequestCanceled(),T.Z.getInstance().isWaitingForStreamEnd())return q.Q.getInstance().stopRecordingFluxWorkflow(!1),void T.Z.getInstance().cleanupStreamHandler();(0,k.cY)("Augloop Response Timed Out");const{message:t,telemetry:a}=Se.n.getAugloopTimeoutResponse();this.copilotChatUIHelper.displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!0}),q.Q.getInstance().stopRecordingFluxWorkflow(!1),this.dispatch(ue.mF.showZeroStateSuggestionList());const n=await this.dispatch(ue.mF.getExecutingCommand());this.logAugloopTimeoutAshaError(n),this.telemetryLogger.logError({eventType:ae.S.ChatEvents,errorMessage:`"Augloop Response Timed Out: workflowAnnotationType ${e}, executingCommand: ${n}`,logLevel:_.$b.Error})}logAugloopTimeoutAshaError(e){if(!e)return;const t=this.getFeatureNameFromLatencyOperation(e)??_.BJ.CopilotChat;N.M.getInstance().logStandardizedAshaErrorEvent(u.W.Response_Delayed_Or_Timed_Out,d.c.Augloop_Response_Timed_Out,t,!1)}async handleStopAlGeneration(e){pe.CP.pythonContextManager.shouldGenerate=!1;const t=await this.dispatch(ue.mF.getExecutingCommand());this.logUserStopGeneratingAshaError(t),this.logIsTriedFailedDueToUserStopGenerating(t);const a=this.getFeatureNameFromLatencyOperation(t)??_.BJ.CopilotChat;if(this.telemetryLogger.assertFeatureIsActive(a,"handleStopButtonClick: Feature from executing command does not match active feature."),this.telemetryEventHandler.logStopGeneratingLatencyTelemetry(s.qD,this.telemetryLogger,a),(0,M.yw)("OfficeVSO_9079282_RefactorFluxWorkflowCodeToFixHighWarningLogCount")||(this.responseHandler.markRequestCanceled(),this.dispatch(ue.mF.stopExecutingAndReleaseContextLock(!1))),(0,M.yw)("OfficeVSO_8531310_UndoForStopGenerating")&&this.dispatch((0,ke.f1)()),e){const{message:e,telemetry:a}=Se.n.getStopGeneratingResponse(t);this.copilotChatUIHelper.displayResponse(e,a);const n=(0,xe.N)(e);this.dispatch(ue.mF.sendSkillResponseToFlux(n,(0,M.yw)("OfficeVSO_9448880_UserCancelCreditDeduction")?Y.Aw.cancelled:Y.Aw.success,a,!1))}(0,M.yw)("OfficeVSO_9463020_excelDisengagementErrorHandling")&&v.s.getInstance().isWaitingForStreamEnd()&&v.s.getInstance().cleanupStreamHandler(),(0,M.yw)("OfficeVSO_9079282_RefactorFluxWorkflowCodeToFixHighWarningLogCount")&&this.responseHandler.markRequestCanceled()}async handleStopButtonOnClick(){this.handleStopAlGeneration(!0)}async handleStopQueryWhenGptSwitched(){(0,M.Pz)()&&this.handleStopAlGeneration(!1)}logIsTriedFailedDueToUserStopGenerating(e){if(e&&e===_.OP.ElseSkillExecuting)(0,se.Or)(N.M.getInstance())}getFeatureNameFromLatencyOperation(e){switch(e){case _.OP.CalculatedColumns:case _.OP.CalculatedCells:return _.BJ.FormulaGeneration;case _.OP.AnalyzeData:return _.BJ.AnalyzeData;case _.OP.Commanding:return _.BJ.Commanding;case _.OP.Search:return _.BJ.Search;case _.OP.ElseSkillExecuting:return _.BJ.ExcelChatHelper;case _.OP.PythonStartAnalysis:case _.OP.Python:return _.BJ.Python;default:return}}logUserStopGeneratingAshaError(e){if(!e)return;const t=this.getFeatureNameFromLatencyOperation(e)??_.BJ.CopilotChat;let a;if((0,M.yw)("OfficeVSO_9261746_UserCanceledVetoTimeThreshold")){a=(0,_.xJ)(s.qD)<=(0,M.Z8)("Microsoft.Office.Excel.FA000000124.UserCanceledVetoThresholdMs",5e3)?d.c.User_Stopped_Execution_Short:d.c.User_Stopped_Execution}else switch(e){case _.OP.CalculatedColumns:case _.OP.CalculatedCells:a=d.c.User_Stopped_Calculated_Columns_Execution;break;case _.OP.AnalyzeData:a=d.c.User_Stopped_Analyze_Data_Execution;break;case _.OP.Commanding:a=d.c.User_Stopped_Commanding_Execution;break;case _.OP.Search:a=d.c.User_Stopped_Search_Execution;break;case _.OP.ElseSkillExecuting:a=d.c.Else_User_Stopped_Execution;break;case _.OP.PythonStartAnalysis:case _.OP.Python:a=d.c.User_Stopped_Python_Execution;break;default:a=d.c.User_Stopped_Copilot_Chat_Execution}a&&t&&N.M.getInstance().logStandardizedAshaErrorEvent(u.W.User_Rejected_Or_Cancelled_Response,a,t)}onCalculatedColumnAnnotationResult(e){e.body&&m.lL.typeGuard(e.body)&&this.dispatch(Ce.m.onFormulaSuggestionAnnotationReceived(e.body))}onCalculatedCellAnnotationResult(e){e.body&&m.Dv.typeGuard(e.body)&&this.dispatch(Ce.m.onFormulaSuggestionAnnotationReceived(e.body,V.VS.Cell))}onExcelTableRecognitionAnnotationResult(e,t){const a=e.body;a&&this.dispatch(Fe.mF.onExcelRecognizedTableAnnotationReceived(a,t?.parentRevId))}async onConditionalFormattingSuggestionAnnotationResult(e){if(e.body&&p.b.typeGuard(e.body)){const t=e.body,{message:a,telemetry:n}=Se.n.getConditionalFormattingSuggestionsResponseMessage(t.Suggestions,t.errorMessage,t.headerMessage,t.guid);this.copilotChatUIHelper.displayResponse(a,n);const o=void 0===t.errorMessage;await this.dispatch(ue.mF.stopExecutingAndReleaseContextLock(o))}}async handleChatHistoryHydrationFailed(){if((0,k.cY)("Chat History Hydration Failed"),(0,M.yw)("OfficeVSO_8995453_reenablingRehydration")&&((0,M.Dl)()||(0,M.iP)("Microsoft.Office.Excel.FA000000124.RehydrateMessagesConsumer",!1))){const{message:e,telemetry:t}=Se.n.getChatHistoryHydrationFailed();this.copilotChatUIHelper.displayResponse(e,t,{replaceExistingMessage:!0}),(0,M.yw)("OfficeVSO_8787558_CopilotChatASHALog")&&N.M.getInstance().logStandardizedAshaErrorEvent(u.W.Copilot_Chat_Pane_Failed_To_Load,d.c.Pane_Failed_To_Hydrate_Previous_Chat_History,_.BJ.CopilotChat)}}handleSuggestionPillClick(e,t=(0,Oe.A)()){const a=pe.CP.getActiveTable(),o=a?.name;switch((0,M.yw)("OfficeVSO_9205086_LogSuggestionPillExecutes")||(N.M.userQueryGuid=t,this.telemetryLogger.setQuerySource(_.BC.SuggestionPill),this.telemetryLogger?.resetActiveFeature(),F.B.userQueryGuid=t,F.B.getInstance().setQuerySource(_.BC.SuggestionPill),F.B.getInstance().resetActiveFeature(),this.telemetryEventHandler.updateTelemetryChatEventData({[_.h3.ChatEventType]:_.a5.SuggestionPaneSuggestionClicked,[_.h3.ChatEventParameters]:e.suggestionType},this.telemetryLogger)),e.suggestionType){case de.hC.AnalyzeData_ShowMore:case de.hC.AnalyzeData_ShowMoreCharts:case de.hC.AnalyzeData_ShowMorePivotTables:case de.hC.AnalyzeData_ShowCharts:case de.hC.AnalyzeData_ShowPivotTables:this.handleTableSuggestionPillClick(e.suggestionType,a,o);break;case de.hC.AnalyzeData_InsertAllCharts:this.dispatch(Fe.mF.insertAllCurrentChartRecos());break;case de.hC.GiveMeMorePrompts:this.dispatch(ue.mF.showZeroStateSuggestionList());break;case de.hC.AnalyzeData_InsertAll:this.dispatch(Fe.mF.insertAllCurrentRecommendations());break;case de.hC.AnalyzeData_Suggestion:case de.hC.AnalyzeData_SpecificSuggestion:case de.hC.AnalyzeData_RelatedQuestions:(0,M.yw)("OfficeVSO_8982280_UseLLMParserForADSuggestions")||this.dispatch(Fe.mF.setIsAllowRewrite(!1)),this.handleSuggestionODSL(e.suggestionText,n.getInsights,t);break;case de.hC.Commanding_TellMe:!function(e){e(ue.mF.showSuggestionListWithPriorities([de.hC.Commanding_Suggestion]));const{message:t,telemetry:a}=Se.n.getCommandingTellMeResponse();b.$.getInstance().displayResponse(t,a)}(this.dispatch);break;case de.hC.CalculatedColumns_ShowMore:if(void 0===e.calculatedFormulaSuggestionMessage)return void(0,k.cY)("No calculatedFormulaSuggestionMessage found, not enough info to show the CC suggestion");this.dispatch(Ce.m.handleCalculatedFormulaShowMore(e.calculatedFormulaSuggestionMessage.requestId,e.calculatedFormulaSuggestionMessage.requestIndex));break;case de.hC.CalculatedColumns_GeneralSuggestion:this.handleSuggestionODSL(e.suggestionText,n.getColumnsGeneral,t);break;case de.hC.CalculatedColumns_SpecificSuggestion:this.handleSuggestionODSL(e.suggestionText,n.getColumnsFromNL,t);break;case de.hC.CalculatedCell_Suggestion:this.handleSuggestionODSL(e.suggestionText,n.getCellsFromNL,t);break;case de.hC.ConditionalFormat_Suggestion:this.handleSuggestionODSL(e.suggestionText,n.getConditionalFormatSuggestion,t);break;case de.hC.ImportDataFromFile:if(e.properties){const a=e.properties.messageId;(0,Re.yU)(a,t,this.dispatch,e.itemClp)}}}handleTableSuggestionPillClick(e,t,a){if(t&&a)switch(e){case de.hC.AnalyzeData_ShowMore:this.dispatch(ue.mF.showMoreInsights(a,t));break;case de.hC.AnalyzeData_ShowMoreCharts:case de.hC.AnalyzeData_ShowMorePivotTables:this.dispatch(ue.mF.showMoreRecommendations(a,t));break;case de.hC.AnalyzeData_ShowCharts:this.dispatch(ue.mF.setLatestRequestId(N.M.userQueryGuid)),this.dispatch(Fe.mF.getRecommendations(a,t,N.M.userQueryGuid,"ChartReco"));break;case de.hC.AnalyzeData_ShowPivotTables:this.dispatch(ue.mF.setLatestRequestId(N.M.userQueryGuid)),this.dispatch(Fe.mF.getRecommendations(a,t,N.M.userQueryGuid,"PivotTableReco"))}else N.M.getInstance().logError({eventType:ae.S.SuggestionEvents,errorMessage:"handleSuggestionPill failed. No active table found",logLevel:_.$b.Error})}async handleSuggestionODSL(e,t,a){this.telemetryLogger.startTriedActivity(),await this.handleCommandExecutionStart(e,a,_.a5.SuggestionPaneSuggestionClicked);let n=g[t];n=n.replace("{{messageText}}",e);const o=JSON.parse(n);try{await this.responseHandler.executeOdsl(o,a)}catch(e){throw e}}resetUnsupportedTlrPromptSuggestions(e){switch(e.suggestionType){case de.hC.TlrExplainHeaders:case de.hC.TlrExplainTables:case de.hC.TlrExplainUnmergingCells:this.dispatch(ue.mF.clearSuggestionList())}}async getPromptById(e,t){const a=await this.getContextSensitiveHelpPrompt(e,t);if(void 0!==a){const t={promptId:e.toLowerCase()};return F.B.getInstance().sendChatEventTelemetry((0,_.pN)({[_.h3.ChatEventType]:_.a5.CSHScenarioRun,[_.h3.ChatEventParameters]:JSON.stringify(t)})),a}}async getPromptWithFormulaPlaceholer(e,t,a){if(void 0!==a.cellRow&&void 0!==a.cellCol){const t=await async function(e,t){let a="";return await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet().getCell(e,t);o.load("formulas"),await n.sync(),1===o.formulas.length&&(a=o.formulas[0].toString())})),a}(a.cellRow,a.cellCol);if(t)return(0,fe.VY)(e,{formula:t})}return t}async getContextSensitiveHelpPrompt(e,t){switch(e.toLowerCase()){case"dd656fbd-fc5b-4e21-88bb-2b6ce622cc2e":if(void 0!==t.cellRow&&void 0!==t.cellCol){const e=await async function(e,t){let a="";return await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet().getCell(e,t);if(o.load(["valuesAsJsonLocal"]),await n.sync(),1===o.valuesAsJsonLocal.length){const e=o.valuesAsJsonLocal[0][0];e.errorMessage&&e.errorName?a=`${e.errorName}: ${e.errorMessage}`:e.errorMessage&&(a=e.errorMessage)}})),a}(t.cellRow,t.cellCol);if(e)return(0,fe.VY)((0,o.P82)(),{error:e})}return;case"f9ad6e18-f3c7-4346-8e1a-896849997b0d":return this.getPromptWithFormulaPlaceholer((0,o.ENk)(),(0,o.fRc)(),t);case"606f60ec-8401-418d-9f19-3c133e933ab1":return this.getPromptWithFormulaPlaceholer((0,o.mk8)(),(0,o.nhC)(),t);case"fd986fa8-18fa-47e6-bd6c-5278924c4fe3":return this.getPromptWithFormulaPlaceholer((0,o.EW5)(),(0,o.fu2)(),t);case"f4d3aafb-8190-46a9-bc20-cafe606dfd2d":return this.getPromptWithFormulaPlaceholer((0,o.IpP)(),(0,o.TTT)(),t);case"a49c05e9-ca3b-4a32-ac67-c56bd16a583b":return this.getPromptWithFormulaPlaceholer((0,o.B3O)(),(0,o.qbB)(),t);case"60baa1dd-aecf-42b2-9f89-a0be53a05a5a":return this.getPromptWithFormulaPlaceholer((0,o.gNJ)(),(0,o.JAc)(),t);case"8e05d9ff-5505-4c7d-925d-2cdbc7555da9":return this.getPromptWithFormulaPlaceholer((0,o.t8C)(),(0,o.I$d)(),t);case"117a47c2-8673-4631-af47-ab87bd8db3d3":return this.getPromptWithFormulaPlaceholer((0,o.I$I)(),(0,o.fzU)(),t);case"520eb606-caea-4c4d-9ebb-7da8aa8a76e5":return this.getPromptWithFormulaPlaceholer((0,o.J$y)(),(0,o.irK)(),t);case"4caf9f84-2dcd-4018-a8b1-8d3ea494eb5d":return this.getPromptWithFormulaPlaceholer((0,o.pDo)(),(0,o.I64)(),t);case"cfa8a08b-607b-435e-96b7-fa3c171da97b":return this.getPromptWithFormulaPlaceholer((0,o.ijW)(),(0,o.LC$)(),t);case"e8cd5204-4fe3-4564-82b1-cf17942c0da6":return(0,o.hEI)();case"73dba87b-93cd-4d77-92a7-f0eec75c3a3f":return(0,o.v3q)();case"c78d7f1e-3542-4463-b844-5eb8b5d53cdf":return(0,o.uVJ)();case"58fb1fe7-479e-42bd-a5e4-d270934a39d1":return(0,o.j0F)();case"b52dc308-99ca-48b2-9611-9f108902bf48":return(0,o.NSY)();case"a6b2d8eb-8c55-4d1f-81ae-be3e8f21122c":return(0,o.wUB)();case"de300c60-54c6-49f8-b049-418fdfc14bda":return(0,o.Q0)();case"a229a616-09dc-4f98-ab74-ef5e6ecb72e3":return(0,o.RT6)();case"12f792d7-c735-469e-8ef3-15fd1031e776":return(0,o.kDR)();case"e90809a8-1c84-4f53-bbcf-b1dccf36c528":return(0,o.Y2N)();case"c5900890-e61e-43ce-a549-03915cc3310c":return(0,o.qU2)();case"c0917abf-f982-4435-9b1b-37cad3f3d104":return(0,o.RV_)()}}async handleStartQuery(){let e=W.Vv.getSettingAsString(W.zj.CopilotStartQuery);if(e){try{e=JSON.parse(e)}catch(e){}return void await this.submitExternalQuery(e,_.BC.ExternalQuery)}const t=W.Vv.getSettingAsString(W.zj.CopilotStartPromptId);if(t){const e=JSON.parse(t),a={cellRow:W.Vv.getSetting(W.zj.CopilotStartPromptCellRow),cellCol:W.Vv.getSetting(W.zj.CopilotStartPromptCellCol)},n=await this.getPromptById(e,a);n&&await this.submitExternalQuery(n,_.BC.ExternalQuery)}}async submitExternalQuery(e,t){const{message:a,telemetry:n}=Se.n.getExternalTriggeredQueryResponse(e);if(this.copilotChatUIHelper.displayResponse(a,n),this.updateCopilotState(i.SG.QUERY_ENTERED),await pe.CP.initMemo.promise(),!await this.shouldSendRequestToAugloop(e))return;const o=(0,Oe.A)();this.telemetryLogger.setQuerySource(t),F.B.getInstance().setQuerySource(t);const r=await this.getDefaultSignalOperation(e,o);this.copilotChatUIHelper.submitOperation(r),this.updateCopilotState(i.SG.QUERY_SUBMITTED)}async handlePrivateApiExternalTriggeredQuery(e){if(!e.query)return void(0,k.cY)("externalTriggeredQuery query is missing");const t=await this.dispatch(ue.mF.getExecutingCommand());if(t)return void(0,k.cY)("Cannot handle externalTriggeredQuery, busy executing: "+t);const a=e.query;await this.submitExternalQuery(a,_.BC.ExternalQuery)}async handlePrivateApiExternalTriggeredPromptId(e){if(!e.promptId)return void(0,k.cY)("externalTriggeredPromptId, promptId is missing");const t=await this.dispatch(ue.mF.getExecutingCommand());if(t)return void(0,k.cY)("Cannot handle externalTriggeredPromptId, busy executing: "+t);const a={cellRow:e.cellRow,cellCol:e.cellCol},n=await this.getPromptById(e.promptId,a);n?await this.submitExternalQuery(n,_.BC.ExternalQuery):(0,k.cY)("No prompt found for promptId",e.promptId)}attachPrivateApiHandler(){H.s.getInstance().attachPrivateEventHandler("externalTriggeredQuery",(e=>{var t;t=e,void 0!==t?.eventName&&void 0!==t?.query&&this.handlePrivateApiExternalTriggeredQuery(e)})),H.s.getInstance().attachPrivateEventHandler("externalTriggeredPromptId",(e=>{var t;t=e,void 0!==t?.eventName&&void 0!==t?.promptId&&this.handlePrivateApiExternalTriggeredPromptId(e)}))}async handlePythonStartAnalysis(){const e=(new Date).getTime();try{(0,M.yw)("OfficeVSO_9378258_PythonFixUndefinedContextParameter")&&this.dispatch(ue.mF.setPythonStartAnalysisButtonDisabled(!0)),pe.CP.pythonContextManager.shouldGenerate=!0,this.updateCopilotState(i.SG.QUERY_ENTERED);const t=(0,Oe.A)();(0,M.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(N.M.userQueryGuid=t,F.B.userQueryGuid=t),(0,X.F5)();const a=pe.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextSheetId(),n=pe.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextAddress(),o=await pe.CP.pythonContextManager.pythonContextBuilder.getAllPythonCellsUptoAnalysisSheet(a,n);if((0,M.Ff)()&&(await pe.CP.pythonContextManager.pythonTrimmedContext.insertDataFrameIfNecessaryForStartAnalysis(o,this.dispatch),(0,M.yw)("OfficeVSO_9507767_StopRunningPythonAAOnStopGenerate")&&!pe.CP.pythonContextManager.shouldGenerate))return;await pe.CP.pythonContextManager.pythonTrimmedContext.setPythonStartAnalysisContext(o),(0,X.Cc)(X.xk.StartAnalysisContextExtraction,e,!0);const r=pe.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextQuery();if(!r){const e="Undefined Item: query, Function: handleStartPythonAnalysis";throw(0,he.Uc)(y.O.PythonContextUndefinedParameter,e)}this.dispatch(ue.mF.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0}));const l=await this.getDefaultSignalOperation(r,t);this.copilotChatUIHelper.submitOperation(l),this.updateCopilotState(i.SG.QUERY_SUBMITTED),this.dispatch(ue.mF.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),pe.CP.pythonContextManager.lastStartAnalysisQueryGuid=t}catch(t){throw(0,X.Cc)(X.xk.StartAnalysisContextExtraction,e,!1),t}}async handlePythonExitAnalysis(e){try{pe.CP.pythonContextManager.exitAdvancedAnalysisMode()}catch(e){pe.CP.pythonContextManager.isPythonMode=!1,(0,M.yw)("OfficeVSO_9476928_EnableDiagnosticsInPostView")&&pe.CP.pythonContextManager.unregisterOnNewEntry();const t=e instanceof Error?`Function: pythonContextManager.exitAdvancedAnalysisMode, Stack: ${e.stack}`:"Function: pythonContextManager.exitAdvancedAnalysisMode",a=(0,he.$C)(t);(0,he.QX)(this.dispatch,a,!1)}finally{(0,K.PB)(K.L3.ExitAnalysisClicked,[]),this.dispatch((0,ue.Nl)()),await this.dispatch(ue.mF.stopExecutingAndReleaseContextLock(e)),Se.n.displayPythonTextResponse(this.dispatch,(0,o.Lby)(),!1)}}async handlePythonAdaExecutionResult(){this.updateCopilotState(i.SG.QUERY_ENTERED);const e=(0,Oe.A)();(0,M.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(N.M.userQueryGuid=e,F.B.userQueryGuid=e);const t=pe.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextQuery();if(!t){const e="Undefined Item: query, Function: handlePythonAdaExecutionResult";throw(0,he.Uc)(y.O.PythonContextUndefinedParameter,e)}this.dispatch(ue.mF.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0}));const a=await this.getDefaultSignalOperation(t,e);(0,k.cY)(`signalOperationData: ${a}`),this.copilotChatUIHelper.submitOperation(a),this.updateCopilotState(i.SG.QUERY_SUBMITTED)}async handlePythonRaiQuerySubmission(e){await this.submitExternalQuery(e,_.BC.InternalTool)}getPythonMode(){return pe.CP.pythonContextManager.isPythonMode}onNewUserUtterance(){(0,Q.s_)(Q.H0.RemoveAll)}getFluxSkillOverride(){const e=!!(0,M.eF)()&&this.dispatch(ue.mF.getDataShapingState()).started;if((0,M.H2)()&&pe.CP.pythonContextManager.isPythonMode)return Me["flux-pythonAda"];if(e)return Me["flux-dataShaping"];if(this.cannedOption)return Me[this.cannedOption];if((0,M.ge)()){return(0,M.wy)()??void 0}}constructor(e,t,a,n,o=void 0,r=[]){super(),this.telemetryLogger=N.M.getInstance(),this.telemetryEventHandler=te.E.getInstance(),this.copilotChatUIHelper=b.$.getInstance(),this.suggestionList=[],this.zeroQueryMessageTitles={},this._cannedOption=void 0,this.sessionRestartedDueToModelWorkflowNotSupported=(0,ve.$q)(),this.debugEvents=new EventTarget,this.dispatch=e,this.responseHandler=t,this.suggestionList=a,this.zeroQueryMessageTitles=n(),this.loggingEventHelper=new ce(r),this.setEnterpriseSearchIsEnabled=o,this.initializeAlCallbacks(),this.clientInfo=(0,ye.z)()}}},72483:(e,t,a)=>{a.d(t,{$:()=>R});var n=a(89099),o=a(24220),r=a(57743),i=a(91749),l=a(13552),s=a(28087),c=a(33500),d=a(50857),u=a(61437),m=a(93772),g=a(10748),h=a(4475),p=a(88179),b=a(96854),f=a(31030),C=a(48314),y=a(23343),v=a(23147),T=a(61150),x=a(50347),S=a(74354);const w=C.M.getInstance(),E=b.E.getInstance();class R{static getInstance(){return R.instance||(R.instance=new R),R.instance}setCopilotRef(e){this.copilotChatRef=e}getCopilotRef(){return this.copilotChatRef}getChatLog(){return this.chatLog}getChatHistory(){return this.chatLog.map((e=>this.convertResponseMessageToOCVChatHistoryMessage(e)))}setLastUserUtterance(e){this.lastUserUtterance=e,this.chatLog.push({chatCardType:s._.Default,chatMessageData:{defaultMessageProps:{user:c.Q9.Human,messageHeader:{text:e}}}})}setIsSkillResponseRequired(e){this.isSkillResponseRequired=e}getIsSkillResponseRequired(){return this.isSkillResponseRequired}getLastUserUtterance(){return this.lastUserUtterance}getHasMessageBeenShown(e){return this.displayedMessageIds.includes(e)}getInputText(){return this.copilotChatRef?.current?.getInputText?.()??""}setInputText(e){(0,T.cY)("Setting input text"),this.copilotChatRef?.current?.setInputAreaText(e),this.setInputFocus()}scrollToBottom(){(0,T.cY)("scroll to bottom"),this.copilotChatRef?.current?.scrollToBottom()}addMessageIfNeeded(e,t,a){const n=!this.getHasMessageBeenShown(e);(0,T.cY)("Trying to add messageId: ",e),n&&(this.displayedMessageIds.push(e),this.displayResponse(t,a),(0,T.cY)("Added messageId: ",e))}displayResponse(e,t,a={}){t&&(this.submitChatMessageTelemetry(t),e.chatMessageBodyData&&(e.chatMessageBodyData.telemetryData=JSON.stringify(t)));const{shouldShowWhenFluxSkillResponseRequired:n=!0}=a;if(!this.getShouldShowMessage(n))return void(0,T.cY)("Skipping response display : ",e);(0,T.cY)("Displaying response : ",e),this.addFeedbackDataToMessage(e),this.chatLog.push(e),a?.replaceExistingMessage?this.copilotChatRef?.current?.updateMessage(e):this.copilotChatRef?.current?.addResponseMessage(e),this.getIsHumanMessage(e)&&(0,h.s_)(h.H0.RemoveAll),this.getIsSkillResponseRequired()&&g.Q.getInstance().recordFluxCopilotStep({operation:p.OP.FluxSkillCardShown});const o=C.M.getInstance().getStandardizedFeatureForSubFeature(t?.featureName);u.Z.getInstance().endUserPerceivedLatency(!0!==e.chatMessageBodyData?.isFailure,o===p.BJ.CopilotChat?void 0:o,"displayResponse: Feature from telemetry.featureName does not match active feature.")}displayErrorResponseIfNeeded(e,t,a={}){t?.errorType!==p.q0.BadToken&&t?.errorType!==p.q0.LicensingError||0!==this.chatLog.length&&this.getIsHumanMessage(this.chatLog[this.chatLog.length-1])?this.displayResponse(e,t,a):w.logError({eventType:f.S.ChatEvents,errorMessage:`Not showing the error message for ${t.errorType} as the last message is not from the user`,logLevel:p.$b.Warning})}updateLastMessage(e){(0,T.cY)("Updating response : ",e);const t=this.chatLog[this.chatLog.length-1]?.chatMessageBodyData?.messageId;this.updateChatLogMessage(t,e),this.copilotChatRef?.current?.updateLastMessage(e)}updateMessage(e){(0,T.cY)("Updating response : ",e),this.updateChatLogMessage(e?.chatMessageBodyData?.messageId,e),this.copilotChatRef?.current?.updateMessage(e)}resendChatHistorySignal(e,t){this.copilotChatRef?.current?.resendChatHistorySignal(e,t)}deleteMessage(e){(0,T.cY)("Deleting response : "+e),this.copilotChatRef?.current?.deleteMessage(e)}startReinitializeALSession(){(0,T.cY)("startReinitializeALSession"),this.copilotChatRef?.current?.startReinitializeALSession()}activateAugloopAnnotations(){(0,T.cY)("activate augloop anotations"),this.copilotChatRef?.current?.activateClientALAnnotations()}submitOperation(e){(0,T.cY)("Submitting signal : ",e),this.copilotChatRef?.current?.submitOperation(e)}updateLoadingComponentProps(e){(0,T.cY)("Updating loading component props"),this.copilotChatRef?.current?.updateLoadingComponentProps(e)}getIsHumanMessage(e){const t=e.chatMessageData;return t?.defaultMessageProps?.user===c.Q9.Human||t?.accordionCardProps?.user===c.Q9.Human||t?.chatCardWrapperProps?.user===c.Q9.Human||t?.contentCardProps?.user===c.Q9.Human||t?.copilotWorkflowsCardProps?.user===c.Q9.Human||t?.markDownCardProps?.user===c.Q9.Human||t?.paginatedCardProps?.user===c.Q9.Human||t?.proactiveSuggestionCardProps?.user===c.Q9.Human||t?.reviewAgentCardProps?.user===c.Q9.Human||t?.reviewerSummaryCardProps?.user===c.Q9.Human||t?.selfHelpAdaptiveCardProps?.user===c.Q9.Human||t?.streamingAdaptiveCardProps?.user===c.Q9.Human||t?.warningMessageCardProps?.user===c.Q9.Human}getLastMessage(e){if((0,T.cY)("Getting last message"),this.chatLog.length>0||(0,x.eA)())return this.copilotChatRef?.current?.getLastMessage(e)}startLoadingPaneTimeout(e){(0,x.yw)("OfficeVSO_9298843_DetectHangOnLoadInSDX2")&&((0,T.cY)("PaneBoot - Start loading pane"),this.startLoadingPaneId=window.setTimeout((()=>{(0,T.cY)(`PaneBoot - logging ASHA: ${o.W.Copilot_Chat_Pane_Failed_To_Load}; Hang ${e?"after disabled screen":""}`),C.M.getInstance().logStandardizedAshaErrorEvent(o.W.Copilot_Chat_Pane_Failed_To_Load,e?n.c.Pane_Taking_Too_Long_To_Load_After_Disabled_Screen:n.c.Pane_Taking_Too_Long_To_Load,p.BJ.CopilotChat,!1)}),y.R.getLoadPaneAshaTimeout()))}clearLoadingPaneTimeout(){(0,x.yw)("OfficeVSO_9298843_DetectHangOnLoadInSDX2")&&((0,T.cY)("PaneBoot - Stop loading pane"),this.startLoadingPaneId&&clearTimeout(this.startLoadingPaneId))}startLoadingUi(){(0,T.cY)("Start loading ui"),this.startLoadingUiId=window.setTimeout((()=>{this.startLoadingUiId=void 0,this.copilotChatRef?.current?.startLoadingUi()}),0)}setInputFocus(){(0,T.cY)("Setting input focus"),this.copilotChatRef?.current?.setInputFocus()}stopLoadingUi(){(0,T.cY)("Stop loading ui"),this.startLoadingUiId?clearTimeout(this.startLoadingUiId):this.updateLastMessage({chatCardType:s._.Default,addCardToChatHistory:!1,stopLoadingUi:!0})}submitUserQuery(e){this.copilotChatRef?.current?.submitUserQuery({text:e})}sendHistorySignal(e,t,a){(0,r.a_)(d.S5.AddMessageOperation,this.convertChatMessageToCopilotMessage(e,t,a),void 0,void 0,void 0,void 0)}convertChatMessageToCopilotMessage(e,t,a){const n=i.R.convertResponseMessageToChatMessage(e,t,a),o=(0,l.CL)(t,e),r=n.body?.user===c.Q9.Human,s=!!a?.isFailure,u=a?.aiResponseMetadata,{chatMessageForRichText:m,images:g}=(0,l.Su)(n,void 0);let h="";try{h=JSON.stringify(m)}catch(e){(0,T.cY)("error while stringify chat card props error:",e.message)}const p=r?d.gG.User:s?d.gG.System:d.gG.Copilot;return(0,l.OD)(o,d.CY.Pane,p,d.Go.RichText,s?d.nW.Failure:d.nW.Success,h,g,u)}getShouldShowMessage(e){return!this.isSkillResponseRequired||!!e}addFeedbackDataToMessage(e){e.chatMessageBodyData={...e.chatMessageBodyData??{},feedbackData:{contextData:{cardMetaData:JSON.stringify({prompt:this.lastUserUtterance,promptId:C.M.userQueryGuid,...(0,x.yw)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?JSON.parse(e.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData??"{}")??{}:{}})},feedbackArea:e.chatMessageBodyData?.feedbackData?.feedbackArea??m.Xw.CHATEXCEL}}}isChatMessageError(e){return(e.eventType===p.a5.ErrorMessage||e.eventType===p.a5.HandoffMessageIdResponseError)&&!(0,S.$o)(e.errorType)}convertResponseMessageToOCVChatHistoryMessage(e){if(e.chatMessageBodyData?.telemetryData){const t=JSON.parse(e.chatMessageBodyData.telemetryData);if(t.errorType)return{user:c.Q9.Chat,message:e.chatMessageData?.defaultMessageProps?.messageHeader?.text,errorType:t.errorType}}let t="";switch(e.chatCardType){case s._.Default:t=e.chatMessageData?.defaultMessageProps?.messageHeader?.text;break;case s._.MarkdownCard:t=e.chatMessageData?.markDownCardProps?.message;break;case s._.ChatCardWrapper:t=e.chatMessageData?.chatCardWrapperProps?.textContent;break;case s._.SelfHelpAdaptiveCard:t="A SelfHelpAdaptiveCard was shown with the following props: "+JSON.stringify(e.chatMessageData?.selfHelpAdaptiveCardProps);break;case s._.StreamingAdaptiveCard:t="A StreamingAdaptiveCard was shown with the following props: "+JSON.stringify(e.chatMessageData?.streamingAdaptiveCardProps);break;case s._.WarningMessage:t="A WarningMessage was shown with the following props: "+JSON.stringify(e.chatMessageData?.warningMessageCardProps);break;default:t=JSON.stringify(e.chatMessageData)}return{user:this.getIsHumanMessage(e)?c.Q9.Human:c.Q9.Chat,message:t}}updateChatLogMessage(e,t){if(!e)return;const a=this.chatLog.find((t=>t?.chatMessageBodyData?.messageId===e));if(a?.chatCardType!==s._.MarkdownCard)return;const n=a?.chatMessageData?.markDownCardProps,o=t?.chatMessageData?.markDownCardProps;n&&o&&(n.message=o.message)}constructor(){this.chatLog=[],this.lastUserUtterance="",this.displayedMessageIds=[],this.isSkillResponseRequired=!1,this.doesLastResponseHaveTable=!1,this.submitChatMessageTelemetry=e=>{if((0,T.cY)("submitChatMessageTelemetry",e),e){if(E.updateTelemetryChatEventData({[p.h3.ChatEventType]:e.eventType,...(0,p.j)(v.CP),[p.h3.ChatEventParameters]:JSON.stringify({featureName:e.featureName,errorType:e.errorType,errorDetails:e.errorDetails})},w),(0,x.yw)("OfficeVSO_9295606_ChatEventCatchAllError")&&this.isChatMessageError(e)){const t=C.M.getInstance().getStandardizedFeatureForSubFeature(e?.featureName);C.M.getInstance().logStandardizedAshaErrorEvent(o.W.Unclassified_Chat_Failure,n.c.Chat_Error_Message_Shown,t)}}else(0,T.cY)("[ERROR] Failed to emit chat log telemetry!!!")}}}},10748:(e,t,a)=>{a.d(t,{Q:()=>s});var n=a(88179),o=a(96854),r=a(31030);const i=a(48314).M.getInstance(),l=o.E.getInstance();class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}recordFluxCopilotStep({operation:e,featureName:t}){this.fluxExecutionStartTime?this.logChatLatency(e,this.fluxExecutionStartTime,!0,t):i.logError({eventType:r.S.Latency,errorMessage:`Flux workflow was not running before starting ${e}`,logLevel:n.$b.Warning})}startRecordingFluxWorkflow(){this.fluxExecutionStartTime&&(i.logError({eventType:r.S.Latency,errorMessage:`Command ${n.OP.FluxOverall} was not stopped before starting another Flux workflow`,logLevel:n.$b.Warning}),this.logChatLatency(n.OP.FluxOverall,this.fluxExecutionStartTime)),this.fluxExecutionStartTime=(new Date).getTime()}stopRecordingFluxWorkflow(e=!1){this.fluxExecutionStartTime&&this.logChatLatency(n.OP.FluxOverall,this.fluxExecutionStartTime,e),this.fluxExecutionStartTime=void 0}constructor(){this.logChatLatency=(e,t,a,o)=>{l.logLatency((0,n.xJ)(t),e,a,o)}}}},25433:(e,t,a)=>{a.d(t,{w:()=>me});var n=a(92779),o=a(89099),r=a(24220),i=a(63843),l=a(94303),s=a(72483),c=a(61437),d=a(20057),u=a(51400),m=a(1805),g=a(10748),h=a(22034),p=a(88179),b=a(6925),f=a(16508),C=a(93111),y=a(94773),v=a(66888),T=a(33851),x=a(61158),S=a(96854),w=a(31030),E=a(48314),R=a(55683),I=a(61150),A=a(50347),L=a(46224),F=a(35828),_=a(70364),N=a(23147),k=a(41679),O=a(24180),P=a(98100),M=a(41102),D=a(58242);var $=a(22330),B=a(59726),H=a(38924),U=a(51319),q=a(71362);function V(e,t){const a=t.filter(((e,a)=>!t.slice(0,a).includes(e)));if(!a.includes(U.DH.Undo)&&!a.includes(U.DH.InsertTables)&&!a.includes(U.DH.Formatting)&&a.length>0){const{message:t,telemetry:a}=q.n.getUnsupportedCommandResponse((0,n.DUN)());s.$.getInstance().displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!1});const o=(0,B.N)(t);e(b.mF.sendSkillResponseToFlux(o,v.Aw.failed,a))}a.forEach((t=>function(e,t){const a=Office.context.platform;let o="",r=[];switch(t){case U.DH.Undo:{let e=[{text:(0,n.Y91)()}];a===Office.PlatformType.Mac?e=[{text:(0,n.mLK)()}]:a===Office.PlatformType.PC&&(e=[{text:(0,n.wEx)()}]),o=(0,n.vuT)(),r=e;break}case U.DH.TableAltText:{const e=[{text:(0,n.HhS)()}];a===Office.PlatformType.Mac||a===Office.PlatformType.PC?e.push({text:(0,n.$S6)()}):e.push({text:(0,n.gq9)()}),o=(0,n.xFL)(),r=e;break}case U.DH.AddComment:o=(0,n.S08)(),r=[{text:(0,n.CnK)()},{text:(0,n.Tem)()},{text:(0,n.Ub7)()},{text:(0,n.p8k)()}];break;case U.DH.DataValidation:o=(0,n.TVz)(),r=[{text:(0,n.FuV)()},{text:(0,n.yWY)()},{text:(0,n.tPp)()},{text:(0,n.YSs)()},{text:(0,n.di6)()},{text:(0,n.ean)()}];break;case U.DH.CreatePivotTable:o=(0,n.xmO)(),r=[{text:(0,n.Pzq)()},{text:(0,n.GyK)()},{text:(0,n.TMJ)()},{text:(0,n.OpW)()},{text:(0,n.rho)()}];break;case U.DH.InsertWorksheets:case U.DH.DeleteWorksheets:o=(0,n.Iy7)(),r=[{text:(0,n.Qv5)()},{text:(0,n.Xdl)()},{text:(0,n.QaT)()}];break;case U.DH.FreezePanes:o=(0,n.M76)(),r=[{text:(0,n.czL)()},{text:(0,n.jh3)()}];break;case U.DH.Formatting:o=(0,A.yw)("OfficeVSO_9369541_CFFormulaSupport")?(0,n.$5J)():(0,n.lPU)();break;case U.DH.InsertTables:o=(0,n.fLI)();break;default:o=(0,n.AWW)(),e(b.mF.showZeroStateSuggestionList())}const{message:i,telemetry:l}=q.n.getUnsupportedCommandResponse(o,r);s.$.getInstance().displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!1});const c=(0,B.N)(i);e(b.mF.sendSkillResponseToFlux(c,v.Aw.failed,l))}(e,t)))}var G=a(54447);function W(e){if(!function(e){return e.type===u.VF.CopilotChatResponseMeta}(e))return;const t=e.chatResponseCode;if(t!==u.XO.OK)switch(t){case u.XO.ServiceTimeout:return void a(r.W.Response_Delayed_Or_Timed_Out,o.c.Service_Timeout);case u.XO.ServiceError:return void a(r.W.LLM_Service_Side_Issue_Prevents_Output,o.c.Service_Error_Augloop);case u.XO.RAICheckFailed:return void a(r.W.Responsible_AI_Filter_Blocked_Response,o.c.RAI_Validation_Failed);case u.XO.Unknown:return void a(r.W.Unable_To_Complete_Task,o.c.Service_Error_Unknown_Error);default:return E.M.getInstance().logError({eventType:w.S.Error,errorMessage:`Unknown CopilotChatResponseCode - ${t}`,logLevel:p.$b.Error}),void a(r.W.Unable_To_Complete_Task,o.c.Service_Error_Unknown_Error)}function a(e,t){E.M.getInstance().logStandardizedAshaErrorEvent(e,t,p.BJ.CopilotChat)}}var z=a(26170),Q=a(78640),J=a(72763),j=a(98483),Y=a(34813),X=a(81364),K=a(49134),Z=a(39531),ee=a(79474),te=a(8505),ae=a(84036),ne=a(79029),oe=a(90922),re=a(5911),ie=a(65118);class le extends ee.r{async autoInsertPythonFormula(){return new Promise(((e,t)=>{(0,_.F5)((async a=>{try{(0,ae.Fr)(ae.xk.CodeExecution),(0,ae.BW)(this.dispatch);const t=(0,L.ZK)(this.code,!0,re.M);let o;o=(0,A.yw)("OfficeVSO_9341197_PythonFixMissingLabel")?this.codeLabel?this.codeLabel:(0,n.XZh)():this.codeLabel??(0,n.XZh)();const r=await(0,L.WH)(a,this.sheetId),i=await this.insertLabelAndContentForPreviewOrFormula(a,r,o,t,!0,!1);e(i)}catch(e){if((0,ae.i5)(!1),(0,ae.$k)(this.dispatch),(0,A.yw)("OfficeVSO_9440568_CleanUpInsertionErrorHandlingLogic")){const a=(0,F.MF)(e,"PythonAutoInserter","autoInsertPythonFormula",!1);t(a)}else{if((0,A.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")&&e instanceof Error&&(0,F.HH)(e))return void t(e);const a=(0,F.zj)(X.O.PythonInsertFailed,"Class: PythonAutoInserter, Method: autoInsertPythonFormula, Stack: "+(e instanceof Error?e.stack:"No stack trace available"));t(a)}}}),{delayForCellEdit:!(0,A.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")})}))}async handlePythonCellExecutionResult(e,t,a){(0,A.yw)("OfficeVSO_9544967_PythonTriedFixes")?(0,T.M5)():((0,T._1)(p.he.SuggestionApplied,p.KZ.PythonAdaCodeInserted),(0,A.BT)()?ne.B.getInstance().logKeptEvent(p.BJ.Python,p.q.Python,oe.RX.Analyze):E.M.getInstance().logKeptEvent(p.q.Python)),this.addCodeAndOutputToBuilder(e),(0,T.S$)(t,e),await this.handlePythonAdaExecutionResult(e,a)}async handlePythonAdaExecutionResult(e,t){try{if(N.CP.pythonContextManager.augloopCallsPerQuery>=N.CP.pythonContextManager.MAX_AUGLOOP_CALLS_PER_QUERY){const e=`Maximum AugLoop Calls Per Query: ${N.CP.pythonContextManager.MAX_AUGLOOP_CALLS_PER_QUERY}`,t=(0,F.x6)(e);return void(0,F.QX)(this.dispatch,t,!1)}if(N.CP.pythonContextManager.augloopCallsPerQuery+=1,e.outputType===te.qf.Error){if(N.CP.pythonContextManager.codeRetryAttempts>=N.CP.pythonContextManager.MAX_CODE_RETRY_ATTEMPTS){const e=`Maximum Retry Attempts: ${N.CP.pythonContextManager.MAX_CODE_RETRY_ATTEMPTS}`;throw(0,F.Jk)(e)}{N.CP.pythonContextManager.codeRetryAttempts+=1;const a=e.output;if(!(a.errorType===Excel.ErrorCellValueType.python||(0,A.yw)("OfficeVSO_9378391_PythonRetryOnTimeOut")&&a.errorType===Excel.ErrorCellValueType.timeout)){if(a.errorType===Excel.ErrorCellValueType.connect)throw(0,F.w5)();{const e=`Python execution failed with error type: ${a.errorType}`;throw(0,F.jY)(e)}}if((0,A.yw)("OfficeVSO_9210153_PythonPostViewErrorCard")){const e=(0,L.u1)(a.errorType,t);ie.n.displayPythonTextResponse(this.dispatch,e,!1)}else ie.n.displayPythonTextResponse(this.dispatch,(0,n.aWv)(),!1)}}else(0,A.yw)("OfficeVSO_9431479_PerQueryStateReset")&&((0,T.Jr)(N.CP.pythonContextManager.augloopCallsPerQuery,N.CP.pythonContextManager.codeRetryAttempts),N.CP.pythonContextManager.codeRetryAttempts=0);me.getInstance(this.dispatch).handlePythonAdaExecutionResult(this.suggestionList)}catch(e){(0,F.Kx)(this.dispatch,e,"handlePythonAdaExecutionResult")}}constructor(e,t,a,n,o,r,i){super(e,a,ee.n.PythonCodeAndPreviewInserter,r,i),this.requestId=t,this.suggestionList=n,this.code=o}}var se=a(91259);class ce extends ee.r{async handlePythonCellExecutionResult(e){let t;(0,A.BT)()?ne.B.getInstance().logKeptEvent(p.BJ.Python,p.q.PythonCalculatedColumns,oe.RX.Analyze):E.M.getInstance().logKeptEvent(p.q.PythonCalculatedColumns);try{if("Error"===e.outputType){const a=e.output;t=(0,se.L)((0,n.pa_)(),a.errorType)}else t=(0,se.L)((0,n.TaP)(),this.columnLetters);const{message:a,telemetry:o}=q.n.getPythonColumnInsertResponse(t,this.requestId);s.$.getInstance().displayResponse(a,o)}catch(e){this.handlePythonColumnError(e,(0,n.JIA)())}}addResultListener(e,t){const a=t=>this.onCalculatedHandler(t,e);this.onCalculatedResult=t.onCalculated.add(a),this.handlerReference=a}removeResultListener(e){this.handlerReference&&e.onCalculated.remove(this.handlerReference)}async onCalculatedHandler(e,t){await Excel.run((async a=>{const o=a.workbook.worksheets.getItem(e.worksheetId);try{const n=e.address.split(",");for(const r of n){const n=o.getRange(r).load(["formulas","valuesAsJson","rowCount","columnCount"]);await a.sync();const i=(0,L.o7)(t);await Promise.all(n.formulas.flatMap((async(t,a)=>t.map((async(t,n)=>{const o=(0,L.o7)(t),l=await this.mutex.waitFor();if(this.onCalculatedFinished)l.release();else if(i===o){this.onCalculatedFinished=!0,l.release(),this.onCalculatedResult?.remove(),await(this.onCalculatedResult?.context.sync()),this.onCalculatedResult=null;const t=K.ExcelCalc.addressToExcelRange(r).topLeft;t.column=(t.column??0)+n,t.row=(t.row??0)+a;const o={topLeft:t,bottomRight:t},i=K.ExcelCalc.IExcelRangeToAddress(o),s=await N.CP.pythonContextManager.getPythonCellContext(e.worksheetId,i);await this.handlePythonCellExecutionResult(s)}else l.release()})))))}}catch(e){this.removeResultListener(o),this.handlePythonColumnError(e,(0,n.JIA)())}this.removeResultListener(o)}))}async autoInsertPythonFormula(){return new Promise(((e,t)=>{try{(0,_.F5)((async t=>{const a=(0,L.ZK)(this.code,!0,re.M),o=await this.insertContentForColumn(t,this.codeLabel??(0,n.XZh)(),a);e(o)}))}catch(e){this.handlePythonColumnError(e,(0,n.JIA)()),t(e)}}))}handlePythonColumnError(e,t){const{message:a,telemetry:n}=q.n.getPythonColumnInsertErrorResponse(e,t);s.$.getInstance().displayResponse(a,n)}async setColumnContent(e,t,a,n){const o=t.getRange(this.tableAddress).load(["rowIndex","rowCount","columnIndex","columnCount"]);await e.sync();const{headerCell:r,contentRange:i}=function(e,t){const a=t.columnIndex+t.columnCount;return{headerCell:e.getCell(t.rowIndex,a),contentRange:e.getRangeByIndexes(t.rowIndex+1,a,1,1)}}(t,o);return i.load("address"),r.values=[[a]],i.values=[[n]],i.select(),await e.sync(),i.address}async insertContentForColumn(e,t,a){const n=e.workbook.worksheets.getItemOrNullObject(this.sheetId);this.addResultListener(a,n);return await this.setColumnContent(e,n,t,a)}constructor(e,t,a,n,o,r,i,l){super(e,a,ee.n.PythonCalculatedColumnInserter,i,l),this.requestId=t,this.code=r,this.tableAddress=n,this.columnLetters=o}}var de=a(97667),ue=a(23343);class me{static getInstance(e){return me.instance||(me.instance=new me(e)),me.instance}setAugloopSignalSentTime(e){this.augloopSignalSentTime=e,this.isFirstResponse=!0,c.Z.getInstance().resetStartQueryState(e)}markRequestCanceled(){this.dispatch(b.mF.stopExecutingAndReleaseContextLock(!1));const e=E.M.userQueryGuid;this.canceledQueryIds.push(e),g.Q.getInstance().stopRecordingFluxWorkflow(!0),this.dispatch(Q.mF.evaluateQueryFailed(e)),this.dispatch(O.m.fetchRecommendationsFailed(e))}setAugloopModelWorkflowUnsupported(e){e&&this.dispatch(R.mF.setAugloopModelWorkflowUnsupported())}async handleErrorResponse(e,t,a){let n={},i={};if((0,A.th)()&&(({message:n,telemetry:i}=await q.n.getAugloopErrorResponse(e,this.dispatch,a)),!i.useClientSideErrorMessage))return!1;(0,A.yw)("OfficeVSO_9352410_SetPythonStartAnalysisButtonDisabled")&&N.CP.pythonContextManager.isPythonMode&&N.CP.pythonContextManager.isStartAnalysisCard()&&this.dispatch(b.mF.setPythonStartAnalysisButtonDisabled(!0)),this.dispatch(b.mF.showZeroStateSuggestionList()),this.telemetryLogger.endTriedActivityFailure(),(0,P.cY)(`AL Error:\n${JSON.stringify(e,void 0,4)}`),(0,A.yw)("OfficeVSO_9295074_stopExecutingAfterResponse")||await this.dispatch(b.mF.stopExecutingAndReleaseContextLock(!1));const l=(0,P.qW)(t);if("OffensiveContent"!==e.category&&0!==l.length)V(this.dispatch,l),(0,A.yw)("OfficeVSO_9220746_AddAshaForUnsupportedCommand")&&(0,A.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&E.M.getInstance().logStandardizedAshaErrorEvent(r.W.Missing_Copilot_Functionality,o.c.ODSL_Execution_Failed_Due_To_Unsupported_Commands,this.telemetryLogger.getActiveFeature());else{(0,A.th)()||({message:n,telemetry:i}=await q.n.getAugloopErrorResponse(e,this.dispatch,a)),this.copilotChatUiHelper.displayErrorResponseIfNeeded(n,i,{shouldShowWhenFluxSkillResponseRequired:!1});const t=(0,B.N)(n);this.dispatch(b.mF.sendSkillResponseToFlux(t,v.Aw.failed,i)),this.showUnsupportedTLRSuggestionListIfNeeded(i)}return(0,A.yw)("OfficeVSO_9295074_stopExecutingAfterResponse")&&await this.dispatch(b.mF.stopExecutingAndReleaseContextLock(!1)),g.Q.getInstance().stopRecordingFluxWorkflow(!1),this.telemetryLogger.logError({eventType:w.S.Augloop,errorMessage:"Failure received from Augloop.",logLevel:this.telemetryLogger.getLogLevelForErrorCategory(e?.category??"")},void 0,[{key:p.IC.ErrorCategory,value:e?.category??""}]),c.Z.getInstance().endUserPerceivedLatency(!1),(0,A.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&N.CP.pythonContextManager.isPythonMode&&(0,ae.P_)(),N.CP.pythonContextManager.isPythonMode&&(0,A.Eq)()&&("OffensiveContent"===e.category?(0,de.vY)(de.hn.RAIBlock):(0,de.vY)(de.hn.PythonError,e)),!0}async handleResponse(e,t){if(this.augloopSignalSentTime){const t=(0,p.xJ)(this.augloopSignalSentTime);this.telemetryEventHandler.logLatency(t,p.OP.AugloopResponse),this.isFirstResponse&&(this.telemetryEventHandler.updateTelemetryLatencyData({[p.CT.FirstServiceResponse]:(0,$.WU)(this.augloopSignalSentTime)},this.telemetryLogger),this.isFirstResponse=!1),(0,P.cY)(`${e.body?x.h.getTypeNameFor(e.body):"item.body is gone; this is a bug in"} response. Time Taken : ${t/1e3} sec \n`)}const a=this.copilotChatUiHelper.getLastUserUtterance(),o=e?.body?.odslResponse?.odsl?.responseRequired;if(!(0,A.yw)("OfficeVSO_9079282_RefactorFluxWorkflowCodeToFixHighWarningLogCount")&&o&&(this.copilotChatUiHelper.setIsSkillResponseRequired(!0),g.Q.getInstance().recordFluxCopilotStep({operation:p.OP.FluxSkillStart})),e?.body?.queryId&&-1!==this.canceledQueryIds.indexOf(e?.body?.queryId))return this.telemetryLogger.endTriedActivityFailure(),(0,P.cY)("query was cancelled"),o&&(0,b.$U)(v.Aw.failed,(0,n.gAP)()),void c.Z.getInstance().endUserPerceivedLatency(!1);(0,A.yw)("OfficeVSO_9079282_RefactorFluxWorkflowCodeToFixHighWarningLogCount")&&o&&(this.copilotChatUiHelper.setIsSkillResponseRequired(!0),g.Q.getInstance().recordFluxCopilotStep({operation:p.OP.FluxSkillStart}));const r=e?.body,l=r?.error,s=this.getOdslProgram(r),u=r.responseMetadata,m=r.chatResponse,h=m?.telemetry?.metrics,f=m?.sessionKey,C=r?.queryId,S=r?.prompt,R=r?.odslResponse?.prompt,I=r?.raw,F=r?.entities,_=r?.rewrite,k=r?.odslResponse?.outputAnswerLanguage;if((0,A.yw)("OfficeVSO_9249393_AttributionFromAugLoop")){const e=r?.contentOriginInformationalOnly;this.telemetryLogger.setActiveFeatureWithContentOrigin(e)}const O=this.getAiResponses(r);let D,H,U,V,W,z,Q,J;if(u&&this.logSkillAshaEvent(u),(0,G.O9)(u))return(0,A.Qy)()&&(0,G.mN)(this.telemetryLogger),void this.dispatch(b.mF.startExecutingCommand({command:p.OP.ElseSkillExecuting}));if(O)for(const e of O)if(e.value){const t=e.type;if((0,A.H2)()&&"pythonAda"===t)D=e.value;else if((0,A.vo)()&&"pythonCalculatedColumns"===t)H=e.value;else if((0,A.ge)()&&"officeJs"===t)U=e.value;else if((0,A.av)()&&"officeScripts"===t){const t=e.value,a=t.operationType;"run_script"===a&&t.officeScriptsRun?V=t.officeScriptsRun:"save_script"===a&&t.officeScriptsSave?W=t.officeScriptsSave:(0,A.L)()&&"schedule_script"===a&&t.officeScriptsSchedule&&(z=t.officeScriptsSchedule)}}if((0,M.E)(r)===d.Yn.getTypeName()&&r.conversationId&&(Q=r.conversationId,E.M.conversationId=Q,ne.B.conversationId=Q,J=r.sydneyEndpoint,(0,P.cY)(`conversation id from Excel Flux Copilot: ${r.conversationId}`)),_&&(0,P.cY)(`Rewrite:\n${_}`),S&&(0,P.cY)(`Prompt:\n${S}`),I&&(0,P.cY)(`ODSL:\n${I}`),F&&(0,P.cY)(`Entities:\n${F}`),D&&(0,P.cY)(`PythonAdaResult:\n${JSON.stringify(D)}`),H&&(0,P.cY)(`pythonColumnResult:\n${JSON.stringify(H)}`),V&&(0,P.cY)(`OfficeScript to Run:\n${JSON.stringify(V)}`),W&&(0,P.cY)(`OfficeScript ODSL to Save:\n${JSON.stringify(W)}`),z&&(0,P.cY)(`OfficeScript to Schedule:\n${JSON.stringify(z)}`),k&&(0,P.cY)(`outputLanguage:\n${k}`),this.telemetryEventHandler.updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.ResponseReceivedFromAL,...(0,p.j)(N.CP),[p.h3.ChatEventParameters]:JSON.stringify({annotationType:(0,M.E)(r)})},this.telemetryLogger),(0,A.cT)()&&this.updateDevTelemetry(f,Q,J,C,h),l){if(!(0,A.th)())return void await this.handleErrorResponse(l,a,r);if(await this.handleErrorResponse(l,a,r))return}if(D){if((0,A.yw)("OfficeVSO_9544967_PythonTriedFixes")?(0,T._8)(p.KZ.SubmitPythonAdaQuery):E.M.getInstance().endTriedActivitySuccess(p.q.Python),(0,L.bh)(R),(0,A.yw)("OfficeVSO_9507767_StopRunningPythonAAOnStopGenerate")&&!N.CP.pythonContextManager.shouldGenerate)return;return N.CP.pythonContextManager.pythonContextBuilder.setPythonPrompt(R),void await this.showPythonAdaCards((0,j.A)(),D,k)}if(H&&await this.showPythonCalculatedColumn((0,j.A)(),H),U)return this.telemetryLogger.endTriedActivitySuccess(p.q.Commanding),void await(this.officeJsCommanding?.handleOfficeJsResult(U));if(V){this.telemetryLogger.endTriedActivitySuccess(p.q.OfficeScripts);const{message:e,telemetry:t}=q.n.getOfficeScriptErrorResponse((0,n._kX)().replace("{0}",V.scriptNameToRun),y.m.RunScript);this.copilotChatUiHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),this.dispatch(b.mF.sendSkillResponseToFlux((0,B.N)(e),v.Aw.failed,t))}if(W)return this.telemetryLogger.endTriedActivitySuccess(p.q.OfficeScripts),void await this.handleSaveODSLToOfficeScript(W,E.M.userQueryGuid);if(z)return this.telemetryLogger.endTriedActivitySuccess(p.q.OfficeScripts),void await this.handleScheduleOfficeScript(z,E.M.userQueryGuid);if(!s||0===s.length)return m?(m.status===i.lC.Success&&this.telemetryLogger.endTriedActivitySuccess(p.q.CopilotChat),(0,G.xY)(u,this.telemetryLogger),(0,P.cY)(`chatResponse:\n${JSON.stringify(m)}`),(0,A.eA)()?await c.Z.getInstance().handleChatResponse(m,this.dispatch,t,Q,this.augloopSignalSentTime,J,r?.fromCache,l):await c.Z.getInstance().handleChatResponse(m,this.dispatch,Q)):(this.telemetryLogger.endTriedActivityFailure(),this.telemetryLogger.logError({eventType:w.S.Augloop,errorMessage:"Undefined Program received from Augloop",logLevel:p.$b.Warning}),o&&(0,b.$U)(v.Aw.failed,(0,n._h7)()),void c.Z.getInstance().endUserPerceivedLatency(!1));const Y=JSON.stringify(s.map((e=>(e.argumentsArray=void 0,e))),void 0,4);(0,P.cY)(`Program:\n${Y}`);const X=(new Date).getTime();await this.executeOdsl(s,E.M.userQueryGuid,k),this.telemetryEventHandler.logLatency((0,p.xJ)(X),p.OP.QueryExecution)}async handleSaveODSLToOfficeScript(e,t){this.dispatch(b.mF.setLatestRequestId(t)),this.dispatch(b.mF.startExecutingCommand({command:p.OP.CreateOfficeScripts}));const{success:a,intents:o,scriptToSave:r}=await(0,k.I)(e,t);if(a&&r){const{message:e,telemetry:a}=q.n.getOfficeSaveScriptHiTL(o,r,t,!1,this.dispatch);this.copilotChatUiHelper.displayResponse(e,a,{shouldShowWhenFluxSkillResponseRequired:!0});const{message:n,telemetry:i}=q.n.getOfficeSaveScriptHiTL(o,r,t,!0,this.dispatch);this.dispatch(b.mF.sendSkillResponseToFlux((0,B.N)(n),v.Aw.success,i))}else{const{message:e,telemetry:t}=q.n.getOfficeScriptErrorResponse((0,n.CPY)(),y.m.SaveScript);this.copilotChatUiHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),this.dispatch(b.mF.sendSkillResponseToFlux((0,B.N)(e),v.Aw.failed,t))}}async handleScheduleOfficeScript(e,t){const a=(e,a)=>{e.isOfficeScriptSkillHandlerError&&(0,z.hs)(e,"schedule_script",t);const{message:n,telemetry:r}=q.n.getOfficeScriptErrorResponse(a,y.m.ScheduleScript);this.copilotChatUiHelper.displayResponse(n,r,{shouldShowWhenFluxSkillResponseRequired:!1}),(0,A.yw)("OfficeVSO_8533885_SharedFluxProcessing")&&this.dispatch(b.mF.sendSkillResponseToFlux((0,B.N)(n),v.Aw.failed,r)),this.telemetryEventHandler.logLatency((0,p.xJ)(o),p.OP.ScheduleOfficeScriptsHiTLShown,!1,p.q.OfficeScripts)};this.dispatch(b.mF.setLatestRequestId(t));const o=(new Date).getTime();let r;try{r=await(0,k.TQ)(e.scriptNameToSchedule,t)}catch(t){return void a(t,(0,n.kAS)().replace("{0}",e.scriptNameToSchedule))}try{const{message:a,telemetry:n}=await q.n.getOfficeScriptsScheduleScriptHiTLResponse(r,e.schedulePlanExplanation,e.scheduleType,JSON.parse(e.schedulePlan),t);this.copilotChatUiHelper.displayResponse(a,n,{shouldShowWhenFluxSkillResponseRequired:!0}),this.telemetryEventHandler.logLatency((0,p.xJ)(o),p.OP.ScheduleOfficeScriptsHiTLShown,!0,p.q.OfficeScripts)}catch(e){return void a(e,(0,n.mF)())}if((0,A.yw)("OfficeVSO_8533885_SharedFluxProcessing")){const{message:e,telemetry:t}=q.n.getOfficeScriptsScheduleScriptFluxResponse();this.dispatch(b.mF.sendSkillResponseToFlux((0,B.N)(e),v.Aw.success,t))}}async handlePythonStartAnalysis(){try{const e=Y.p.getInstance(this.dispatch,this,[],H.dW);await e.handlePythonStartAnalysis()}catch(e){throw e}}async handlePythonAdaExecutionResult(e){const t=Y.p.getInstance(this.dispatch,this,e,H.dW);await t.handlePythonAdaExecutionResult()}async handlePythonExitAnalysis(e){const t=Y.p.getInstance(this.dispatch,this,[],H.dW);await t.handlePythonExitAnalysis(e)}async showPythonStartAnalysisCard(e,t){if((0,A.H2)())try{(0,A.yw)("OfficeVSO_9544967_PythonTriedFixes")?(0,T._8)((0,A.yw)("OfficeVSO_9302094_PythonPerfTelemetryForBeta")?p.KZ.SubmitPythonStartAnalysisQuery:p.KZ.SubmitPythonAdaQuery):(0,T._1)(p.he.SuggestionShown,(0,A.yw)("OfficeVSO_9302094_PythonPerfTelemetryForBeta")?p.KZ.SubmitPythonStartAnalysisQuery:p.KZ.SubmitPythonAdaQuery),this.dispatch(b.mF.setLatestRequestId(e));const a=await(0,L.eU)(),n=a!==Excel.CalculationMode.automatic;q.n.displayPythonStartAnalysisResponse(this.dispatch,e,n,t),(0,T.DC)(T.$.StartAnalysis,a),(0,A.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(0,ae.oO)(),N.CP.pythonContextManager.recalcSheet((0,A.yw)("OfficeVSO_9541393_FixStartAABug")),(0,A.Eq)()&&(0,de.vY)(de.hn.StartAnalysisCardShown)}catch(e){let t;t=(0,A.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")&&e instanceof Error&&(0,F.HH)(e)?(0,F.j9)(X.O.PythonStartAnalysisEditModeError):e,(0,F.Kx)(this.dispatch,t,"showPythonStartAnalysisCard")}}showStartDataShapingCard(e,t,a,n,o,r){this.dispatch(b.mF.setLatestRequestId(e));const{message:i,telemetry:l}=q.n.displayStartDataShapingResponse(this.dispatch,e,a,t,n,o,r),s=(0,B.N)(i);this.dispatch(b.mF.sendSkillResponseToFlux(s,v.Aw.success,l))}async showPythonAdaCards(e,t,a){if((0,A.H2)()){this.dispatch(b.mF.startExecutingCommand({command:p.OP.Python,id:e}));try{this.dispatch(b.mF.setLatestRequestId(e)),(0,A.yw)("OfficeVSO_9544967_PythonTriedFixes")||(0,T._1)(p.he.SuggestionShown,p.KZ.SubmitPythonAdaQuery),(0,F.iY)(a);const o=t.response;(0,L.PV)(o);let r=!1;const i=(0,L.ec)(o,"code");if((0,L.ec)(o,"suggestions")){const e=(0,A.yw)("OfficeVSO_9397080_PythonFallbackSuggestionPills")?[(0,n.rhr)(),(0,n.DjY)()]:[];this.dispatch(b.mF.showPythonDynamicSuggestionList(e))}for(let t=0;t<o.length;t++){let a=!1;const n=o[t],l=n.type;switch((0,A.Eq)()&&"debugText"!==l&&(0,de.a1)(n),l){case"text":{const e=n.value.text;if(!e){const e="Text is missing in IPythonAdaTextResponseChunkValue";throw(0,F.xp)(X.O.PythonMissingResponseValue,e)}{N.CP.pythonContextManager.pythonContextBuilder.setLlmText(e);const a=i&&t===o.length-1;q.n.displayPythonTextResponse(this.dispatch,e,!0,!1,a),r=!0,(0,T.DC)(T.$.Text)}break}case"code":{const t=n.value,a=t.code,o=t.codeExplanation,i=t.codeLabel;if(!a){const e=`Code: ${a?"Defined":"Undefined"} Code Explanation: ${o?"Defined":"Undefined"} Code Label: ${i?"Defined":"Undefined"} in IPythonAdaCodeResponseChunkValue.`;throw(0,F.xp)(X.O.PythonMissingResponseValue,e)}{const t=await(0,L.nC)(this.dispatch,N.CP);this.dispatch(b.mF.setLatestRequestId(e)),(0,A.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")||q.n.displayPythonAdaRecommendationResponse({dispatch:this.dispatch,requestId:e,code:a,codeExplanation:o,codeLabel:i});const n=new le(this.dispatch,e,t,[],a,o,i),l=await n.autoInsertPythonFormula();if((0,A.yw)("OfficeVSO_9507767_StopRunningPythonAAOnStopGenerate")&&!N.CP.pythonContextManager.shouldGenerate)break;if((0,A.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit"))if((0,A._T)()){const n=K.ExcelCalc.localAddressesFromSheetAddresses(l);N.CP.pythonContextManager.lastCodeAndPostViewMessage=q.n.displayPythonCodeCardWithPendingPostView(this.dispatch,e,a,t,n,!1,o,i)}else q.n.displayPythonAdaRecommendationResponse({dispatch:this.dispatch,requestId:e,code:a,codeExplanation:o,codeLabel:i});r=!0,(0,A.vE)()&&await(0,L.bf)(t,"A2"),(0,T.DC)(T.$.Code)}break}case"suggestions":{const e=n.value.suggestions;if(!e){const e="Suggestions is missing in IPythonAdaSuggestionsResponseChunkValue";throw(0,F.xp)(X.O.PythonMissingResponseValue,e)}this.dispatch(b.mF.showPythonDynamicSuggestionList(e)),r=!0,(0,T.DC)(T.$.Suggestions);break}case"finalText":{const e=`Final Text Index: ${t} Total Chunks: ${o.length}`;if(t!==o.length-1)throw(0,F.xp)(X.O.PythonInvalidResponseOrder,e);const l=n.value.finalText;if(!l){const e="Final text is missing in IPythonAdaFinalTextResponseChunkValue";throw(0,F.xp)(X.O.PythonMissingResponseValue,e)}N.CP.pythonContextManager.pythonContextBuilder.setFinalResponse(l),r=!0,q.n.displayPythonTextResponse(this.dispatch,l,!0,!1,i),a=!0,(0,T.DC)(T.$.FinalText),((0,A.vE)()||(0,A.o2)())&&(N.CP.pythonContextManager.disableAutoScroll=!1);break}case"debugText":break;default:{const e=`Python response type ${l} is not supported.`;throw(0,F.xp)(X.O.PythonUnsupportedResponseType,e)}}(0,A.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(0===t&&(0,ae.YM)(),a&&(0,ae.oO)())}if(!N.CP.pythonContextManager.isPythonMode){if((0,A.yw)("OfficeVSO_9261865_PythonADABypassIntentRouting"))this.showPythonStartAnalysisCard(e,!1);else{const t=await(0,L.eU)(),a=t!==Excel.CalculationMode.automatic;q.n.displayPythonStartAnalysisResponse(this.dispatch,e,a,!1),r=!0,(0,T.DC)(T.$.StartAnalysis,t),N.CP.pythonContextManager.recalcSheet(),(0,A.Eq)()&&(0,de.vY)(de.hn.StartAnalysisCardShown)}return}if(!r)throw(0,F.xp)(X.O.PythonResponseAllDebugChunks);(0,A.H)()&&i&&Y.p.getInstance(this.dispatch,this,[],H.dW).deductCopilotCredit(e),i&&(0,A.Eq)()&&(0,de.vY)(de.hn.TurnComplete)}catch(e){(0,F.Kx)(this.dispatch,e,"showPythonAdaCards")}}}async showPythonCalculatedColumn(e,t){if(!(0,A.vo)())return;const a=e=>{const{message:t,telemetry:a}=q.n.getPythonColumnSuggestionErrorResponse(e);s.$.getInstance().displayResponse(t,a);const n=(0,B.N)(t);this.dispatch(b.mF.sendSkillResponseToFlux(n,v.Aw.failed,a,!1)),this.dispatch(b.mF.stopExecutingAndReleaseContextLock())};this.dispatch(b.mF.startExecutingCommand({command:p.OP.PythonCalculatedColumn,id:e}));try{this.dispatch(b.mF.setLatestRequestId(e));const o=N.CP.getActiveTable(),r=o?.sheetRange.sheet,i=o?.address,l="number"==typeof o?.sheetRange.range.topLeft.column?function(e,t,a){const n=a?1:0;return(0,D.z)(t+e+n)}(o.numColumns,o.sheetRange.range.topLeft.column,!0):void 0;if(!r||!i||!l)return void a((0,n.gg6)());if(o.tableLikeRange)return void a((0,n.YvV)());const c=async()=>{const a=(0,n.Nbb)(),{message:o,telemetry:c}=q.n.getInsertSuggestionUserChat(a);s.$.getInstance().displayResponse(o,c);try{const a=new ce(this.dispatch,e,r,i,l,t.code,t.codeExplanation,t.columnName),n=p.OP.InsertPythonCalculatedColumn;this.dispatch(b.mF.startExecutingAndLockContext(n)),this.dispatch(b.mF.setLatestRequestId((0,j.A)())),await a.autoInsertPythonFormula()}catch(e){const{message:t,telemetry:a}=q.n.getPythonColumnInsertErrorResponse(e,(0,n.JIA)());s.$.getInstance().displayResponse(t,a)}finally{this.dispatch(b.mF.stopExecutingAndReleaseContextLock())}},{message:d,telemetry:u}=q.n.getPythonCalculatedColumnSuggestionResponse(e,t,i,l,r,c);s.$.getInstance().displayResponse(d,u);const m=(0,B.N)(d);this.dispatch(b.mF.sendSkillResponseToFlux(m,v.Aw.success,u,!1))}catch(e){(0,F.Kx)(this.dispatch,e,"showPythonAdaCards")}finally{this.dispatch(b.mF.stopExecutingAndReleaseContextLock())}}getAiResponses(e){return e?.odslResponse?.aiResponses}getOdslProgram(e){return e?.odslResponse?.odsl?.statements}async executeOdsl(e,t,a){try{this.dispatch(b.mF.setLatestRequestId(t));const o=new m.K,r=await o.convert(e,this.copilotChatUiHelper.getLastUserUtterance()),i=new h.e(r);if((0,I.kc)(r)){this.telemetryLogger.endTriedActivityFailure();const e=(0,n.CDl)(),{message:t,telemetry:a}=q.n.getMultipleEventsErrorResponse(e);this.copilotChatUiHelper.displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!1});const o=(0,B.N)(t);return void this.dispatch(b.mF.sendSkillResponseToFlux(o,v.Aw.failed,a))}(0,I.qw)(r)&&(0,A.av)()&&C.y.getInstance().pushOdslCache("",e),await(0,_.$r)((0,n.Eyh)());const l={happened:!1,id:void 0};let s=!1;const c=new Promise(((e,t)=>{l.id=setTimeout((()=>{l.happened=!0,e(l)}),ue.R.getOdslExecutionTimeout())})),d=i.execute(l,t,this.dispatch,(e=>this.handleODSLExecutionError(e)),a).finally((()=>{l.id&&clearTimeout(l.id),s=!0}));await Promise.race([c,d]),s||await d,await(0,_.TA)()}catch(e){await this.handleODSLExecutionError(e)}}async handleODSLExecutionError(e){if(e.isOnlyUnsupportedEventsError&&e.unsupportedTypes.length>0)return V(this.dispatch,e.unsupportedTypes),(0,A.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&E.M.getInstance().logStandardizedAshaErrorEvent(r.W.Missing_Copilot_Functionality,o.c.ODSL_Execution_Failed_Due_To_Unsupported_Commands,this.telemetryLogger.getActiveFeature()),Promise.resolve();if(e.isMultipeEventsExecutionError){const e=(0,n.Rff)(),{message:t,telemetry:a}=q.n.getMultipleEventsErrorResponse(e,{showUndo:!0});this.copilotChatUiHelper.displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!1});const i=(0,B.N)(t);return this.dispatch(b.mF.sendSkillResponseToFlux(i,v.Aw.failed,a)),(0,A.yw)("OfficeVSO_9112036_ASHALoggingForODSLExecutionFailedErrors")&&E.M.getInstance().logStandardizedAshaErrorEvent(r.W.User_Input_Could_Not_Be_Processed,o.c.ODSL_Execution_Failed_With_Multiple_Events,this.telemetryLogger.getActiveFeature()),Promise.resolve()}if(e.isConverterError&&(this.telemetryLogger.endTriedActivityFailure(),await this.handleConverterError(e)))return Promise.resolve();if(e.isHumanInTheLoopError&&(this.telemetryLogger.endTriedActivityFailure(),await this.handleHumanInTheLoopError(e)))return Promise.resolve();(0,l.iG)(e)&&this.telemetryLogger.assertFeatureIsActive(p.BJ.Commanding,"handleODSLExecutionError: isCommandingError returned true but Commanding is not the active feature");const t=(0,A.qm)()&&(0,l.ip)(e),a=t?(0,n.OX0)():(0,n.BVu)(),{message:i,telemetry:s}=q.n.getOdslExecutionFailedResponse(a,p.q0.OdslExecutionFailed);(0,A.yw)("OfficeVSO_9112036_ASHALoggingForODSLExecutionFailedErrors")&&(t?E.M.getInstance().logStandardizedAshaErrorEvent(r.W.User_Input_Could_Not_Be_Processed,o.c.ODSL_Execution_Failed_Due_To_Payload_Too_Large,this.telemetryLogger.getActiveFeature()):e.isConverterError?E.M.getInstance().logStandardizedAshaErrorEvent(r.W.User_Input_Could_Not_Be_Processed,o.c.ODSL_Execution_Failed_Due_To_Converter_Error,this.telemetryLogger.getActiveFeature()):E.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.ODSL_Execution_Failed_General_Error,this.telemetryLogger.getActiveFeature())),this.copilotChatUiHelper.displayResponse(i,s,{shouldShowWhenFluxSkillResponseRequired:!1});const c=(0,B.N)(i);return this.dispatch(b.mF.sendSkillResponseToFlux(c,v.Aw.failed,s)),this.dispatch(b.mF.showZeroStateSuggestionList()),Promise.resolve()}async handleHumanInTheLoopError(e){let t=(0,n.ir3)(),a=o.c.Missing_HITL_Intent_String,i=p.q0.OdslExecutionFailed;e.failureType===l.UP.NoActiveTable&&(t=(0,n.SCL)(),a=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=p.q0.NoTableLikeEntityFound);const{message:s,telemetry:c}=q.n.getOdslExecutionFailedResponse(t,i);this.copilotChatUiHelper.displayResponse(s,c,{shouldShowWhenFluxSkillResponseRequired:!0});const d=JSON.stringify({text:n.qbK.HumanInTheLoop.Error,publishPreference:Z.f$.Never});return this.dispatch(b.mF.sendSkillResponseToFlux(d,v.Aw.failed,c)),(0,A.yw)("OfficeVSO_9052516_HiTLASHATelemetry")&&E.M.getInstance().logStandardizedAshaErrorEvent(r.W.Missing_Copilot_Functionality,a,p.BJ.Commanding),!0}async handleConverterError(e){if(!e?.failureType)return!1;let t="",a=!1,i=o.c.ODSL_Execution_Failed_Due_To_Converter_Error,s=r.W.User_Input_Could_Not_Be_Processed;switch(e.failureType){case l.tJ.General:break;case l.tJ.ColumnRowOutOfBoundary:t=(0,n.dw7)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.ColumnRowBySelection:t=(0,n.pwZ)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.ConditionalFormatFormulaInvalid:t=(0,n.T0z)(),a=!0,i=o.c.Conditional_Formatting_Failed_Due_To_Invalid_Formula,s=r.W.Unable_To_Complete_Task;break;case l.tJ.ConditionalFormatFormulaExplanationInvalid:t=(0,n.T0z)(),a=!0,i=o.c.Conditional_Formatting_Failed_Due_To_Invalid_Formula_Explanation,s=r.W.Unable_To_Complete_Task;break;case l.tJ.ClearSortUnsupported:t=(0,n.uy0)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.NoColumnArgument:case l.tJ.ColorDistanceExceededThreshold:break;case l.tJ.DeleteUnexpectedTableRows:t=(0,n.EoV)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.DeleteWithInsertColumns:t=(0,n.uvk)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.MultipleTableStructureChanges:t=(0,n.nKX)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.NoSupportedNumberFormatCategoriesNumber:t=(0,n.Pot)(),a=!0,i=o.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,s=r.W.Unable_To_Complete_Task;break;case l.tJ.NoActiveTable:t=(0,n.SCL)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.NoSupportedNumberFormatCategoriesDate:t=(0,n.aYy)(),a=!0,i=o.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,s=r.W.Unable_To_Complete_Task;break;case l.tJ.NoSupportedNumberFormatCategoriesText:t=(0,n.nx1)(),a=!0,i=o.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,s=r.W.Unable_To_Complete_Task;break;case l.tJ.NoSupportedNumberFormatCategoriesOther:t=(0,n.SS1)(),a=!0,i=o.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,s=r.W.Unable_To_Complete_Task;break;case l.tJ.NoVisibleRange:t=(0,n._ZG)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,s=r.W.Missing_Copilot_Functionality;break;case l.tJ.NumericFilterOnNonNumberError:t=(0,n.Ehc)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Invalid_Targets,s=r.W.Unable_To_Complete_Task;break;case l.tJ.TextualFilterOnNonTextError:t=(0,n.Ykh)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Invalid_Targets,s=r.W.Unable_To_Complete_Task;break;case l.tJ.VariableCacheEntityTypeMismatched:t=(0,n.xk_)(),a=!0,i=o.c.ODSL_Execution_Failed_Due_To_Entity_Type_Mismatch,s=r.W.Unable_To_Complete_Task}if(a){const{message:e,telemetry:a}=q.n.getOdslExecutionFailedResponse(t,p.q0.OdslExecutionFailed);this.copilotChatUiHelper.displayResponse(e,a,{shouldShowWhenFluxSkillResponseRequired:!1});const n=(0,B.N)(e);this.dispatch(b.mF.sendSkillResponseToFlux(n,v.Aw.failed,a)),(0,A.yw)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&E.M.getInstance().logStandardizedAshaErrorEvent(s,i,this.telemetryLogger.getActiveFeature()),(0,A.yw)("OfficeVSO_9469830_CFSuggestionsImprovedErrorMessage")&&await this.dispatch(b.mF.stopExecutingAndReleaseContextLock(!1))}return a}updateDevTelemetry(e,t,a,n,o){e&&this.dispatch(J.m.setAugLoopSessionKey(e)),t&&this.dispatch(J.m.setSydneyConversationId(t)),a&&this.dispatch(J.m.setSydneyEndpoint(a)),n&&o&&o.length>0&&this.dispatch(J.m.addQueryMetrics({queryId:n,metrics:o}))}logSkillAshaEvent(e){switch(e.type){case u.VF.ElseResponseMeta:return void(0,G.OP)(e);case u.VF.CopilotChatResponseMeta:return void W(e);default:return void E.M.getInstance().logError({eventType:w.S.Error,errorMessage:`Unknown ResponseMetadata type - ${e.type}`,logLevel:p.$b.Error})}}showUnsupportedTLRSuggestionListIfNeeded(e){(0,A.yw)("OfficeVSO_9318449_TlrImprovementsSuggestionPills")?(0,A.tg)()&&e.errorType===p.q0.UnsupportedTabularRange&&e.errorDetails?.TabularRangeUnsupportedFeature&&this.dispatch(b.mF.showUnsupportedTLRSuggestionListIfNeeded(e.errorDetails.TabularRangeUnsupportedFeature)):b.mF.showZeroStateSuggestionList()}constructor(e){this.telemetryLogger=E.M.getInstance(),this.telemetryEventHandler=S.E.getInstance(),this.augloopSignalSentTime=null,this.canceledQueryIds=[],this.copilotChatUiHelper=s.$.getInstance(),this.isFirstResponse=!0,this.dispatch=e,(0,A.ge)()&&(this.officeJsCommanding=new f.$(e))}}},79029:(e,t,a)=>{a.d(t,{B:()=>S});var n=a(92779),o=a(88179),r=a(130),i=a(53357),l=a(45242),s=a(5550),c=a(29348),d=a(68629),u=a(26532),m=a(4801),g=a(22330),h=a(90922),p=a(96854),b=a(31030),f=a(48314),C=a(37488),y=a(61150),v=a(50347),T=a(51853),x=a(72746);class S extends d.M{initializeCheckPoint(){if(this.recordCheckPoint(o._R.TaskPaneStart,Number(C.excelTaskPaneStartTime)),this.recordCheckPoint(o._R.AppLoadStart,Number(C.appLoadStartTime)),C.officeOnReadyTime&&this.recordCheckPoint(o._R.OfficeJSReady,C.officeOnReadyTime),(0,v.yw)("OfficeVSO_9262045_ShouldRecordAppAndCopilotPaneStartCheckpoints")){const e=s.Vv.getSetting(s.zj.AppStartTimestamp);e&&this.recordCheckPoint(o._R.AppStart,e);const t=s.Vv.getSetting(s.zj.CopilotPaneStartTimestamp);t&&!C.preloadCopilot&&this.recordCheckPoint(o._R.CopilotPaneStart,t)}}sendChatEventTelemetry(e,t){return this.telemetryLoggerUtils.sendTelemetryChatEventData(e,t)}sendLatencyTelemetry(e,t){return this.telemetryLoggerUtils.sendTelemetryLatencyData(e,t)}sendErrorTelemetry(e){this.telemetryLoggerUtils.sendTelemetryErrorData(e)}static getInstance(){return S.instance||(S.instance=new S,u.j.setTelemetryHandler(S.instance)),S.instance}updateTelemetryOnAnnotationReceived(e,t,a,n,o,r,i){}resetActiveFeature(){S.querySource=S.nextQuerySource?S.nextQuerySource:o.BC.Default,S.nextQuerySource=o.BC.Default,S.querySource===o.BC.ExternalQuery?S.currentEntryPoint=o.Y9.Canvas:S.currentEntryPoint=o.Y9.Chat}setQuerySource(e){S.nextQuerySource=e}LogTelemetryEvent(e){let t=!1;switch(e.GetEventName()){case m.lr.AshaError:case m.lr.Chat:if(e.GetEventName()===m.lr.AshaError&&(t=!0),e.GetShouldLog()){e.SetIsRequired(!0);const a=e.GetLogs().some((e=>"Copilot.FeatureActionType"===e.name&&e.value===r.TA.FeatureActionType.IsTried));this.logSharedCopilotChatTelemetryEvent(e,a,t)}break;case m.lr.ChatEvents:if(!e.GetShouldLog()){for(const t of e.GetLogs())t.name!==o.h3.UserQueryGuid&&(this.telemetryChatEventObject[t.name]=t.value);break}e.SetIsRequired(!0),e.SetLogs([...e.GetLogs(),...this.getDataFields([{key:o.h3.UserQueryGuid,value:f.M.userQueryGuid},{key:o.h3.UserQueryOrder,value:f.M.userQueryOrder},...Object.keys(this.telemetryChatEventObject).map((e=>({key:e,value:this.telemetryChatEventObject[e]})))])]),this.logSharedTelemetryEvent(e),this.telemetryChatEventObject={};break;case m.lr.Latency:if(!e.GetShouldLog()){for(const t of e.GetLogs())t.name===o.CT.CopilotChatHistoryInfoJson?this.chatHistoryLog=this.chatHistoryLog.concat(JSON.parse(t.value)):t.name!==o.CT.UserQueryGuid&&(this.telemetryLatencyObject[t.name]=t.value);break}e.SetIsRequired(!0),e.SetLogs([...e.GetLogs().filter((e=>e.name!==o.CT.CopilotChatHistoryInfoJson)),...this.getDataFields([{key:o.CT.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryLog)},{key:o.CT.UserQueryGuid,value:f.M.userQueryGuid},{key:o.CT.AugloopSessionGuid,value:x.O},{key:o.CT.FeatureName,value:this.telemetryLogger.getActiveFeature()},...Object.keys(this.telemetryLatencyObject).map((e=>({key:e,value:this.telemetryLatencyObject[e]})))])]),this.logSharedTelemetryEvent(e),this.chatHistoryLog=[],this.telemetryLatencyObject={};break;case m.lr.Error:if(!e.GetShouldLog())break;e.SetLogs([...e.GetLogs(),...this.getDataFields([{key:o.h3.UserQueryGuid,value:f.M.userQueryGuid}])]),this.logSharedErrorEvent(e)}}getDataFields(e){return e.map((e=>"number"==typeof e.value?(0,i.ip)(e.key,e.value):"string"==typeof e.value?(0,i.m9)(e.key,e.value):"boolean"==typeof e.value?(0,i.LK)(e.key,e.value):(0,i.m9)(e.key,e.value)),[])}logStandardizedAshaErrorEvent(e,t,a,o,r=!1,i=[]){i.push({key:"AshaScenarioName",value:a}),this.telemetryLoggerUtils.logErrorWithAshaVetoAndError(i,a,n.u1i,o+" "+a+" "+e,t,r)}logAshaErrorEvent(e,t,a,o=!1,r=[]){r.push({key:"AshaScenarioName",value:a}),this.telemetryLoggerUtils.logErrorWithAshaVetoAndError(r,a,n.u1i,e,t,o)}logSharedCopilotChatTelemetryEvent(e,t,a){const n={telemetryProperties:this.telemetryLogger.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.IsRequired()&&(t||a)?l.o.DiagnosticLevel.RequiredServiceData:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?l.o.SamplingPolicy.CriticalUsage:l.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(n)}logSharedTelemetryEvent(e){const t={eventName:"Office.Voice.ActionAI."+e.GetEventName(),eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?l.o.SamplingPolicy.CriticalUsage:l.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(t)}logSharedErrorEvent(e){const t={eventName:"Office.Voice.ActionAI."+b.S.Error,error:{errorGroup:e.GetLogs().find((e=>e.name===o.IC.ErrorCategory))?.value,tag:0},eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?l.o.SamplingPolicy.CriticalUsage:l.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(t)}sendTelemetryEvent(e){this.telemetryLogger.sendTelemetryEvent(e)}logKeptEvent(e,t=o.q.Unset,a,n){this.telemetryLoggerUtils.logKeptEvent(n||[...this.getDefaultTelemetryData(),...this.convertDataFieldsToTelemetryData(this.getCopilotDataFields(r.TA.FeatureActionType.IsKept))],S.currentEntryPoint??o.Y9.Chat,e,void 0,void 0,a,t)}logSeenEvent(e,t){if(this.seenEvents.has(e))return;const a=this.getStandardizedFeatureForSubFeature(e);this.telemetryLoggerUtils.logSeenEvent(t||[...this.getDefaultTelemetryData(),...this.convertDataFieldsToTelemetryData(this.getCopilotDataFields(r.TA.FeatureActionType.IsSeen))],o.Y9.Chat,a,void 0,this.getVerbForStandardizedFeature(a),e),this.seenEvents.add(e)}getStandardizedFeatureForSubFeature(e){switch(e){case o.q.AnalyzeData:return o.BJ.AnalyzeData;case o.q.CalculatedColumns:case o.q.CalculatedRows:return o.BJ.FormulaGeneration;case o.q.Commanding:case o.q.OfficeJsCommanding:case o.q.ShowHeaders:case o.q.SmartHelp:case o.q.ConditionalFormattingSuggestion:return o.BJ.Commanding;case o.q.HandOff:return o.BJ.Handoff;case o.q.ImportDataFromSearch:return o.BJ.ImportData;case o.q.Search:return o.BJ.Search;case o.q.OfficeScripts:return o.BJ.OfficeScripts;case o.q.Python:return o.BJ.Python;case o.q.InsertTable:return o.BJ.Search;case o.q.SelfHelp:return o.BJ.ChatQnA;case o.q.ChatPaneLoad:case o.q.ConvertToTable:case o.q.CopilotChat:case o.q.SampleData:case o.q.ContextInference:return o.BJ.CopilotChat;case o.q.Else:return o.BJ.ExcelChatHelper;case o.q.CopyMessage:case o.q.ExternalTriggeredQuery:case o.q.UndoMessage:default:return o.BJ.CopilotChat}}getVerbForStandardizedFeature(e){switch(e){case o.BJ.AnalyzeData:case o.BJ.Python:return h.RX.Analyze;case o.BJ.ChatQnA:case o.BJ.Search:return h.RX.Ask;case o.BJ.FormulaGeneration:case o.BJ.ImportData:return h.RX.Create;case o.BJ.Commanding:case o.BJ.OfficeScripts:return h.RX.Command;case o.BJ.CopilotChat:case o.BJ.ExcelChatHelper:case o.BJ.Handoff:default:return}}getDefaultTelemetryData(){const e=[{key:"UserQueryGuid",value:S.userQueryGuid},{key:"ClientVersion",value:n.hl5},{key:"IsNearestTableEnabled",value:(0,v.qm)()},{key:"GroundingMode",value:(0,o.Q6)()},{key:"IsDevBuild",value:n.MYv},{key:"UiLanguage",value:c.i.getHostAppDisplayLanguage()}];return(0,v.yw)("OfficeVSO_8947993_CustomizeZQMClickTelemetry")&&void 0!==S.querySource&&e.push({key:"querySource",value:S.querySource}),e}getCopilotDataFields(e,t,a,n){const o=e===r.TA.FeatureActionType.IsTried||e===r.TA.FeatureActionType.IsKept||e===r.TA.FeatureActionType.IsRejected||void 0!==t,i=e===r.TA.FeatureActionType.IsTried||e===r.TA.FeatureActionType.IsKept||e===r.TA.FeatureActionType.IsRejected||void 0!==t;return[...r.TA.getFields({interactionId:o?a??S.userQueryGuid:"",conversationId:i?n??S.conversationId:""})]}convertDataFieldsToTelemetryData(e){return e.map((e=>({key:e.name,value:e.value})))}logTelemetryForSharedChatPaneLoad(){if(C.copilotPaneStartTimestamp){const e={[o.CT.SDXResourcesLoadTime]:(0,g.WU)(C.excelTaskPaneStartTime),[o.CT.FeatureName]:o.BJ.ChatPaneLoad};C.preloadCopilot||(e[o.CT.UserCopilotPaneLoadTime]=(0,g.WU)(C.copilotPaneStartTimestamp)),p.E.getInstance().updateTelemetryLatencyData(e,this.telemetryLogger)}else p.E.getInstance().updateTelemetryLatencyData({[o.CT.SDXResourcesLoadTime]:(0,g.WU)(C.excelTaskPaneStartTime),[o.CT.FeatureName]:o.BJ.ChatPaneLoad},this.telemetryLogger);p.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.TaskPaneStart,[o.h3.ChatEventParameters]:C.excelTaskPaneStartTime},this.telemetryLogger),p.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.AppLoadStart,[o.h3.ChatEventParameters]:C.appLoadStartTime},this.telemetryLogger),C.officeOnReadyTime&&p.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.OfficeJSReady,[o.h3.ChatEventParameters]:C.officeOnReadyTime.toString()},this.telemetryLogger),(0,v.yw)("OfficeVSO_9255610_TimeStampLogAfterAutoSaveTurnedOn")&&(p.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.CopilotEnabledAfterAutoSave,[o.h3.ChatEventParameters]:(0,T.Y)()},this.telemetryLogger),p.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.ShowDisabledScreen,[o.h3.ChatEventParameters]:(0,T.iN)()},this.telemetryLogger)),(0,v.yw)("OfficeVSO_9320287_PreLoadCopilotEnabled")&&C.preloadCopilot&&p.E.getInstance().updateTelemetryChatEventData({[o.h3.ChatEventType]:o.a5.PreloadCopilot,[o.h3.ChatEventParameters]:C.preloadCopilot.toString()},this.telemetryLogger),this.recordCheckPoint(o._R.ChatPaneLoaded)}recordCheckPoint(e,t){t&&0!==t&&!Number.isNaN(t)||(t=(new Date).getTime()),0===this.checkPointStartTime?(this.checkPointStartTime=t,this.checkPoints[e]=0):this.checkPoints[e]=t-this.checkPointStartTime}sendLatencyTelemetryForCheckPoints(e){const t=JSON.stringify(this.checkPoints);(0,y.cY)("sendLatencyTelemetryForCheckPoints: ",t),this.sendLatencyTelemetry((0,o.pN)({[o.CT.CheckPoints]:t}),e)}setInitialHandoffQuery(e){(0,y.cY)("setInitialHandoffQuery: ",e),this.initialHandoffQuery=e}sendHandoffQuerySubmittedEvent(e){if(!this.initialHandoffQuery)return;e=e.trim();const t=this.initialHandoffQuery.trim(),a=!(e===t||e.includes(t));(0,y.cY)("Handoff query is submitted. IsModified: "+a),S.getInstance().sendChatEventTelemetry([{key:o.h3.ChatEventType,value:o.a5.HandoffQuerySubmittedByUser},{key:o.h3.ChatEventParameters,value:`${o.CD.IsModified}:${a}`}]),this.initialHandoffQuery=void 0}constructor(){super(),this.chatHistoryLog=[],this.seenEvents=new Set,this.logUserCopilotPaneLoadTelemetry=e=>{const t=parseFloat((0,y.gZ)(e));p.E.getInstance().updateTelemetryLatencyData({[o.CT.UserCopilotPaneLoadTime]:(0,g.WU)(t),[o.CT.FeatureName]:o.BJ.Preload_ChatPaneLoad},this.telemetryLogger),this.recordCheckPoint(o._R.CopilotPaneStart,t)},this.sendVisibilityModeChangedTelemetry=e=>{S.getInstance().sendChatEventTelemetry((0,o.pN)({[o.h3.ChatEventType]:o.a5.TaskPaneVisibilityModeChanged,[o.h3.ChatEventParameters]:e}))},this.telemetryLogger=f.M.getInstance(),u.j.setTelemetryHandler(S.instance),this.telemetryLoggerUtils=u.j.getInstance(),this.telemetryChatEventObject={},this.telemetryLatencyObject={},this.checkPoints={},this.checkPointStartTime=0,this.initializeCheckPoint()}}S.querySource=void 0,S.nextQuerySource=void 0,S.currentEntryPoint=void 0,S.conversationId=void 0,S.userQueryGuid=""},98974:(e,t,a)=>{a.d(t,{Cn:()=>y,D9:()=>T,M5:()=>v,hC:()=>E,qP:()=>R,vo:()=>S});var n=a(89099),o=a(24220),r=a(72483),i=a(64216),l=a(93772),s=a(94754),c=a(74511),d=a(39531),u=a(88179),m=a(96854),g=a(48314),h=a(61150),p=a(77303),b=a(50393);let f,C;function y({showAIGenerated:e,showAnimation:t,footerPosition:a,actionButtonList:n,isFailure:o,references:r,annotationReferences:i,clpLabel:l,msgExtCardProps:s,apiPluginCardProps:c,confirmationCardProps:d,pluginAuthError:u,feedbackArea:m,telemetryData:g,chatMessageHeader:b,gptId:f,shouldShowCopyButton:C}){let y;(0,h.cY)(`Showing footer with showAnimation as ${t} and AIGenerated as ${e}`);try{y=g?JSON.stringify(g):void 0}catch(e){(0,h.cY)("Error in stringifying telemetry data",e)}const T={shouldShowAIGeneratedIndicator:e,feedbackSectionPosition:a,feedbackData:v(m),isFailure:o||!1,showAnimation:t,actionButtonList:n,references:r,annotationReferences:i,clpSensitivityIndicatorData:l,msgExtCardProps:s,apiPluginCardProps:c,confirmationCardProps:d,pluginAuthError:u,telemetryData:y,messageAttributionProps:f?{id:f,name:""}:void 0,shouldShowCopyButton:C};return b?{...T,chatMessageHeaderData:(0,p.Ne4)(b)}:T}function v(e){const t=r.$.getInstance(),a=(new Date).toISOString();return{feedbackArea:e??l.Xw.CHATEXCEL,contextData:{cardMetaData:JSON.stringify({prompt:t.getLastUserUtterance(),promptId:g.M.userQueryGuid}),feedbackContextData:{prompt:t.getLastUserUtterance(),promptId:g.M.userQueryGuid},groundingSource:(0,u.Q6)(),sydneyContextData:{requestId:g.M.userQueryGuid,utteranceTimeStamp:a,feedbackMessageId:(0,b.Xf)(),conversationId:i.s.getInstance().getConversationId()??"",sydneyEndpoint:i.s.getInstance().getSydneyEndpoint()??"",locale:i.s.getInstance().getResponseLocale()}}}}const T=e=>{f&&C||(f=m.E.getInstance(),C=g.M.getInstance()),e!==d.h2.None&&e!==d.h2.Unknown&&f&&(g.M.getInstance().logStandardizedAshaErrorEvent(o.W.Responsible_AI_Filter_Blocked_Response,n.c.RAI_Validation_Failed,u.BJ.CopilotChat),f.updateTelemetryChatEventData({[u.h3.ChatEventType]:"RAIOffense",[u.h3.ChatEventParameters]:JSON.stringify({offense:e,groundingMode:(0,u.Q6)()})},C))},x=()=>Office&&"ExtensionLifeCycle"in Office&&"taskpane"in Office.ExtensionLifeCycle;async function S(){(0,h.cY)("Closing Shared Header"),x()&&await Office.ExtensionLifeCycle.taskpane.close()}async function w(){(0,h.cY)("Moving Shared Header"),x()&&await Office.ExtensionLifeCycle.taskpane.move()}async function E(){(0,h.cY)("Shared Header Loaded"),x()&&await Office.ExtensionLifeCycle.taskpane.notifyHeaderLoaded()}function R(){if(c.i.isWin32Platform()){return{buttons:[{type:s.y.Move,clickHandler:w},{type:s.y.Close,clickHandler:S}]}}}},78651:(e,t,a)=>{a.d(t,{Pp:()=>h,EM:()=>C,iN:()=>y,NP:()=>f,KI:()=>b,Fp:()=>p,if:()=>v,F:()=>T});var n=a(92779),o=a(61150),r=a(50347),i=a(89791),l=a(40702),s=a(88179),c=a(31030),d=a(48314),u=a(8520),m=a(94329);function g(e){const t=document.createElement("div");try{return m.render(u.createElement(l.A,e),t),t.innerText}catch(e){return d.M.getInstance().logError({eventType:c.S.ChatEvents,errorMessage:`FormulaSuggestionTextForChatHistory: Failed to render header: ${e?.message}`,logLevel:s.$b.Critical}),""}finally{m.unmountComponentAtNode(t)}}function h(e,t){let a="";return e&&t?("TextAnalysisVisual"!==e.visual.visualType&&(a+=t+"\n"),e.title?.runs&&(e.title.runs.forEach((e=>{e?.text&&(a+=e.text)})),a+="\n"),a+=(0,i.g)(e,!1)+"\n",a):a}function p(e,t,a,n,r){return t?function(e,t,a,n,r){return t?((0,o.cY)("FormulaSuggestionTextForChatHistory",{isMainRecommendation:e,model:t,targetAddress:a,columnLetters:n,rowNumber:r}),[g({isMainRecommendation:e,recommendation:t,targetAddress:a,columnLetters:n,rowNumber:r}),...t.calculatedFormulas.flatMap((e=>Array.from(function*(e){const{title:t,formula:a,description:n,formulaExplanation:o}=e;t&&(yield t),n&&(yield n),yield a,o&&(yield o)}(e))))].join("\n")):((0,o.cY)("FormulaSuggestionTextForChatHistory: No model passed"),"")}(e,t,a,n,r):((0,o.cY)("FormulaSuggestionTextForChatHistory: No model passed"),"")}function b(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.listItems)for(const a of e.listItems)a.title&&(t+=a.title+"\n"),a.text&&(t+=a.text+"\n");return e?.footer&&(t+=e?.footer),t}function f(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.events)for(const a of e.events)t+=a+"\n";return t}function C(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.eventIntents)for(const a of e.eventIntents)t+=a+"\n";if(e?.cfHitlItems)for(const a of e.cfHitlItems){if(t+=a.title+a.explanation+"\n",a.subExplanations)for(const e of a.subExplanations)t+=e+"\n";(0,r.ID)()&&(0,r.yw)("OfficeVSO_9197813_AddCFFormulaToChatHistory")&&a.conditionalFormatResponseCardData.customFormula&&(t+=a.conditionalFormatResponseCardData.customFormula+"\n")}return t}function y(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.suggestions)for(const a of e.suggestions)t+=a.Description+"\n",t+=a.Key+"\n";return t}function v(e,t){let a=`Code: ${e}`;return t&&(a+=`\nCode Explanation: ${t}`),a}function T(){return(0,r.yw)("OfficeVSO_9496420_PythonFirst30sStringUpdates")?`${(0,n.XXH)()}\n${(0,n.zqN)()}\n${(0,n.lQ6)()}\n${(0,n.WQT)()}\n${(0,n.LMV)()}`:`${(0,n.XXH)()}\n${(0,n.zqN)()}\n${(0,n.lQ6)()}`}},10796:(e,t,a)=>{a.d(t,{B:()=>o,q:()=>r});var n=a(94303);async function o(e,t,a){try{return await Excel.run({delayForCellEdit:!0},(async n=>{const o=i(n,e,t,a);return await n.sync(),l(o,a)}))}catch{throw new n.tF(`Failed to read the ${a} colors from table column.`,"getTableColumnColors")}}async function r(e,t,a,o){try{const n=t.map((t=>i(o,e,t,a)));return await o.sync(),n.map((e=>l(e,a)))}catch{throw new n.tF(`Failed to read the ${a} colors from table column.`,"getTableColumnColors")}}function i(e,t,a,n){const o="font"===n?{format:{font:{color:!0}}}:{format:{fill:{color:!0}}};return e.workbook.tables.getItem(t).columns.getItemAt(a).getDataBodyRange().getCellProperties(o)}function l(e,t){return e.value.map((e=>"font"===t?e[0].format?.font?.color??"#000000":e[0].format?.fill?.color??"#FFFFFF"))}},99701:(e,t,a)=>{a.d(t,{t:()=>r});var n=a(92779),o=a(62982);const r=(e,t,a,n)=>{if("PivotTableVisual"===e.visual.visualType){const r=e.visual.pivotTable,i=(0,o.OY)(r);return l(i,a??t,"PivotTable",n)}if("PivotChartVisual"===e.visual.visualType){const r=e.visual.pivotTable,i=(0,o.OY)(r);return l(i,a??t,"PivotChart",n)}if("QueryResultVisual"===e.visual.visualType){const r=e.visual.result,i=(0,o.ub)(r);return l(i,a??t,"QueryResult",n)}if("TextAnalysisVisual"===e.visual.visualType){const{extendedData:t,interpretationId:a,...o}=e;return l(o,void 0,"TextAnalysisVisual",n)}{let o=t;a&&(o=a);const r=i(e);return l(r,o,void 0,n)}},i=e=>{const{id:t,interpretationId:a,extendedData:n,...o}=e;return o},l=(e,t,a,o)=>{let r=JSON.stringify({text:t,visualType:a,visual:e,mustExplain:o});return r.length>n._A_&&(r="TextAnalysisVisual"===a?(0,n.NOF)():JSON.stringify({text:t,visualType:a,mustExplain:o})),r}},59726:(e,t,a)=>{a.d(t,{N:()=>o});var n=a(61150);function o(e){if(!e.chatMessageData?.defaultMessageProps)return(0,n.cY)("Message provided to getFluxProgramResponseFromDefaultMessage had no defaultMessageProps"),"";const t=e.chatMessageData.defaultMessageProps;let a="";if(t?.messageHeader&&(a=a+r(t.messageHeader)+"\n"),t?.embeddedLists)for(const e of t.embeddedLists){if(e.listHeader&&(a=a+e.listHeader+"\n"),e.listItems)for(const t of e.listItems)a+=t.title?`${t.title}: ${t.text+"\n"}`:""+(t.text+"\n");e.listFooter&&(a=a+r(e.listFooter)+"\n")}return t?.messageFooter&&(a+=r(t.messageFooter)),a}function r(e){let t="";return e?.text&&(t+=e.text),e?.linkText&&(t=t+e.linkText.text+e.linkText.linkSuffix??""),t}},25594:(e,t,a)=>{a.d(t,{I2:()=>S,Nl:()=>w,yU:()=>E});var n=a(89099),o=a(24220),r=a(72483),i=a(8069),l=a(92779),s=a(88179),c=a(6925),d=a(66888),u=a(90489),m=a(96854),g=a(31030),h=a(48314),p=a(50347),b=a(59726),f=a(34874),C=a(71362),y=a(98483);const v=(0,p.Z8)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForCitations",3e4),T=(0,p.Z8)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForRelevancy",3e4);class x extends Error{toString(){return`SignalError: ${this.message} (ErrorCode: ${this.errorCode})`}constructor(e,t){super(e),this.errorCode=t}}function S(e,t,a,i,d=h.M.getInstance(),u=m.E.getInstance(),p=C.n,b=c.mF,y=s.xJ,v=f.r){return async c=>{let m=!1;const h=(new Date).getTime();a(b.startExecutingCommand({command:s.OP.ImportDataLoadQuery,id:t}));try{await v(c.powerQueryScript,c.sourceName),m=!0;const e=(0,l.k0o)(),{message:t,telemetry:a}=p.getImportDataSimpleMessage(e,i);r.$.getInstance().displayResponse(t,a)}catch(e){d.logError({eventType:g.S.ImportData,errorMessage:`failed to load query for source: ${c.sourceName} with error:  ${e} ${JSON.stringify(e)}`,logLevel:s.$b.Error});const{message:t,telemetry:a}=p.getImportDataSimpleMessage((0,l.pZZ)(),i);r.$.getInstance().displayResponse(t,a),d.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Load_Query_Error,s.BJ.ImportData)}finally{u.updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.ImportDataLoadQuery,[s.h3.ChatEventParameters]:JSON.stringify({success:m,messageId:e,duration:y(h)})},d),a(b.stopExecutingAndReleaseContextLock(m)),a(b.clearSuggestionList())}}}async function w(e,t,a,n,o,r=h.M.getInstance(),i=m.E.getInstance(),l=C.n,d=c.mF,u=s.xJ){await I(s.q.ImportDataSkill,e,t,a,n,r,i,l,d,u,(async()=>({requestId:t,dataSources:o})))}async function E(e,t,a,n,o=u.qx.getInstance(),r=h.M.getInstance(),i=m.E.getInstance(),l=C.n,d=c.mF,g=s.xJ){r.startTriedActivity(s.q.ImportDataFromSearch);await I(s.q.ImportDataFromSearch,e,t,a,n,r,i,l,d,g,(async()=>await o.fetchRelevantTablesForMessageId(e,v,T,a,t,d)),o)}function R(e,t,a,n,o){const r=(0,b.N)(a);e(o.sendSkillResponseToFlux(r,t?d.Aw.success:d.Aw.failed,n,!1,!0))}async function I(e,t,a,c,d,u,m,h,b,f,C,v){const T=(new Date).getTime(),S={success:!1,isCardShown:!1,resolvedDataSources:0,shownDataSources:0,messageId:t,duration:0},w=(0,y.A)();c(b.setLatestRequestId(w));let E=!1;try{const m=await C();let f=m.dataSources;if(S.resolvedDataSources=f.length,m.error&&m.error?.errorCode!==i.O.Timeout)throw m.error.errorCode===i.O.RAI&&u.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_RAI_Error,s.BJ.ImportData),new x(m.error.errorMessage,m.error.errorCode);const y=(0,p.iP)("Microsoft.Office.Excel.FA000000124.ImportDataShowAllTables",!0);if(v&&(0===f.length&&y||m.error?.errorCode===i.O.Timeout)&&(E=!0,f=await v.getAllResolvedDataSourcesForMessageId(t,0),u.logError({eventType:g.S.ImportData,errorMessage:`falling back to show all tables for message id: ${t}. errorCode?: ${m.error?.errorCode}`,logLevel:s.$b.Warning})),0===f.length){const{message:t,telemetry:a}=h.getImportDataSimpleMessage((0,l.kM)(),e);r.$.getInstance().displayResponse(t,a),c(b.showZeroStateSuggestionList()),R(c,!0,t,a,b)}else{const{message:n,telemetry:o}=h.getImportDataResponse({importType:e,requestId:w,dataSources:f,messageId:t,userQueryGuid:a,clpData:d,performedFallbackToAllTables:E});r.$.getInstance().displayResponse(n,o),S.isCardShown=!0,S.shownDataSources=f.length,c(b.clearSuggestionList()),R(c,!0,n,o,b)}S.success=!0,u.endTriedActivitySuccess(e)}catch(t){const a=function(e){return e instanceof x&&e.errorCode===i.O.RAI?(0,l.KC)():(0,l.pZZ)()}(t),{message:d,telemetry:m}=h.getImportDataSimpleMessage(a,e);r.$.getInstance().displayResponse(d,m),u.logError({eventType:g.S.ImportData,errorMessage:`got error during handling import data: ${t} ${JSON.stringify(t)}`,logLevel:s.$b.Error}),R(c,!1,d,m,b),u.endTriedActivityFailure(e),u.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Card_Rendering_Error,s.BJ.ImportData)}finally{S.duration=f(T),m.updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.ImportDataShowCard,[s.h3.ChatEventParameters]:JSON.stringify(S)},u),c(b.stopExecutingAndReleaseContextLock(S.success))}}},75633:(e,t,a)=>{a.d(t,{A:()=>c});var n=a(88179),o=a(41485),r=a(31030),i=a(48314),l=a(61150),s=a(98483);class c{succeed(e){this.endCalled&&this.sendError(`Telemetry already ended for ${this.operationType}.`,n.$b.Warning,0),(0,l.cY)(`MakerStorageTelemetry sending succeed for ${this.operationType}`,e,{id:this.id}),e.operationType=`${this.operationType}.Succeeded`,e.duration=Date.now()-this.createdTime,this.sendTelemetryEvent(e),this.endCalled=!0}fail(e,t,a){this.endCalled&&this.sendError(`Telemetry already ended for ${this.operationType}.`,n.$b.Warning,0),(0,l.cY)(`MakerStorageTelemetry sending fail for ${this.operationType}`,e,t,a,{id:this.id}),t.operationType=`${this.operationType}.Failed`,t.level=e,t.error=this.stringifyError(a),t.duration=Date.now()-this.createdTime,this.sendTelemetryEvent(t),this.endCalled=!0}sendStart(e){(0,l.cY)(`MakerStorageTelemetry sending start for ${this.operationType}`,e,{id:this.id}),e.operationType=`${this.operationType}.Start`,this.sendTelemetryEvent(e)}sendTelemetryEvent(e){e.Id=this.id;const t=[];Object.keys(e).forEach((a=>{t.push({key:a,value:e[a]})}));const a={eventType:this.eventType,eventData:t};i.M.getInstance().logEvent(a)}sendError(e,t,a){const o={eventType:r.S.MakerStorageEvent,errorMessage:"",logLevel:n.$b.Error},l=[{key:n.dA.ErrorMessage,value:e},{key:n.dA.LogLevel,value:t},{key:n.dA.TimeOut,value:a},{key:n.dA.Id,value:this.id}];i.M.getInstance().logError(o,void 0,l)}stringifyError(e){return e instanceof Error?e.message:e instanceof o.qD?JSON.stringify({message:e.message,errorCode:e.errorCode}):e instanceof o.Je?JSON.stringify({message:e.message,status:e.status,errorCode:e.errorCode}):e.toString()}constructor(e,t=[]){this.eventType=r.S.MakerStorageEvent,this.endCalled=!1,this.createTimeout=(e,t)=>{(0,l.uk)(t).then((()=>{this.endCalled||this.sendError(`Telemetry Activity timed out waiting for ${this.operationType}`,e,t)}))},this.id=(0,s.A)(),this.createdTime=Date.now(),this.operationType=e,t.forEach((e=>{this.createTimeout(e.level,e.timeout)}))}}},65624:(e,t,a)=>{a.d(t,{H:()=>r});var n=a(825),o=a(98483);class r{constructor(){this.scripts=[],this.scriptListPopulated=!1,this.getScriptExists=e=>this.scripts.findIndex((t=>t.name===e))>-1,this.getScripts=()=>this.scripts,this.pushScript=e=>{this.scripts.push(e)},this.popScript=()=>{this.scripts.pop()},this.populateScriptsList=async()=>{if(!this.scriptListPopulated)try{const e=new n.L;this.scripts=await e.getCopilotScripts((0,o.A)()),this.scriptListPopulated=!0}catch{return}}}}r._instance=void 0,r.getInstance=()=>(void 0===r._instance&&(r._instance=new r),r._instance)},93111:(e,t,a)=>{a.d(t,{y:()=>h});var n=a(72483),o=a(65624),r=a(88179),i=a(31030),l=a(48314);class s{constructor(e){this.camelToSnake=e=>e.replace(/([A-Z])/g,(e=>`_${e.toLowerCase()}`)),this.getRawStatements=e=>e.map((e=>{let t="";if(e.returns&&(t+=e.returns+"="),t+=this.camelToSnake(e.name)+"(",e.arguments){const a=Object.keys(e.arguments);for(let n=0;n<a.length;n++){const o=e.arguments[a[n]];if(o){switch(t+=a[n]+"=",o.type){case"number":t+=JSON.stringify(o.number);break;case"boolean":t+=JSON.stringify(o.boolean);break;case"jsonGrid":t+=JSON.stringify(o.json);break;case"stringList":t+=JSON.stringify(o.stringList);break;case"numberList":t+=JSON.stringify(o.numberList);break;case"color":case"string":t+=JSON.stringify(o.string);break;case"var":case"scope":t+=o.name;break;default:throw new Error("Type of the argument cannot be handled.")}n!==a.length-1&&(t+=", ")}}}return t=t.trim(),t=t.replace(/,$/,""),t+=")",t})),this.logConvertRawODSLError=()=>{const e=l.M.getInstance(),t={eventType:i.S.OfficeScriptsContextManager,errorMessage:"",logLevel:r.$b.Error},a=[{key:r.ib.ErrorMessage,value:"Something went wrong while converting statements to raw format."}];e.logError(t,void 0,a)},this.convertToRawODSLString=()=>{try{return this.getRawStatements(this.statements).join("\n")}catch{return void this.logConvertRawODSLError()}},this.statements=e}}var c=a(92779),d=a(61150);const u=e=>{const t=l.M.getInstance(),a={eventType:i.S.OfficeScriptsContextManager,errorMessage:"",logLevel:r.$b.Warning},n=[{key:r.ib.ErrorMessage,value:e}];t.logError(a,void 0,n)};var m=a(49437),g=a(71362);class h{constructor(){this.odslCacheList=[],this.tableNames=[],this.getOfficeScriptsContext=()=>{const e=o.H.getInstance();return{odslCache:JSON.stringify(this.odslCacheList),scriptNames:e.getScripts().map((e=>e.name)),tableNames:this.tableNames}},this.pushOdslCache=(e,t)=>{const a=new s(t).convertToRawODSLString();if(a){const t={query:e,odsl:a};this.odslCacheList.push(t)}},this.clearODSLCache=()=>{this.odslCacheList=[]},this.initOfficeScriptsContext=async()=>{this.tableNames=await async function(){try{return await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.tables.load("items/name");return await e.sync(),t.items.map((e=>e.name))}))}catch{return u("Office JS call failed to get all tables on current workbook"),[]}}(),await o.H.getInstance().populateScriptsList(),(0,d.cY)(`Office Scripts Context: Initial tables ${this.tableNames}`)},this.removeTable=e=>{const t=this.tableNames.findIndex((t=>t===e));t>-1&&(this.tableNames.splice(t,1),(0,d.cY)(`Office Scripts Context: Removing table ${this.tableNames}`))},this.addTable=async e=>{const t=await async function(e){try{return await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e).load("name");return await t.sync(),a.name}))}catch{return void u("Office JS call failed to get table name by id")}}(e);t&&(this.tableNames.push(t),(0,d.cY)(`Office Scripts Context: Adding table ${this.tableNames}`))},this.checkIfFlowCreatedFromPowerAutomate=async()=>{if((0,m.P)("FlowCreated")){const{message:e,telemetry:t}=g.n.getOfficeScriptSimpleResponse((0,c.ejy)(),r.a5.FlowCreatedConfirmation,!1);n.$.getInstance().displayResponse(e,t)}}}}h._instance=void 0,h.getInstance=()=>(void 0===h._instance&&(h._instance=new h),h._instance)},2117:(e,t,a)=>{a.d(t,{P1:()=>v,XT:()=>T,o8:()=>x});var n=a(88179),o=a(7704),r=a(23343),i=a(2070),l=a(75633);function s(){return{msalDefined:void 0!==window.msal,browserAuthDefined:void 0!==window.BrowserAuth}}class c{handleError(e){"string"==typeof e&&e.indexOf("BrowserAuth")>=0&&this.loadPromise&&this.loadPromise.reject(new Error(e))}async ensureAuthLibraryLoaded(e){const t=this.providers.getCurrent();if(t.isLoaded())return;const a=new l.A("LoadAuthLibrary",[{level:n.$b.ASHA,timeout:r.R.getLoadAuthLibraryAshaTimeout()},{level:n.$b.Error,timeout:r.R.getLoadAuthLibraryAceTimeout()}]);a.sendStart({parentCallId:e});const o={numFailures:0},c=()=>(0,i.U)((()=>this.loadAuthLibraryFn(t)),(()=>!0),(()=>(o.numFailures++,!1)),5,o);try{await(0,i.Y)(c,r.R.getLoadAuthLibraryTimeout()),a.succeed({...o,parentCallId:e,debugData:s(),provider:t.getName(),...t.getLoadProps()})}catch(r){throw a.fail(n.$b.Warning,{...o,parentCallId:e,debugData:s(),provider:t.getName(),...t.getLoadProps()},r),new Error("Authorization Error")}}constructor(e){this.loadAuthLibraryFn=async e=>new Promise(((t,a)=>{const n=new o.c(t,a);e.load().then((()=>n.resolve())).catch(n.reject),this.loadPromise=n})),this.providers=e}}var d=a(47807);class u{getName(){return"WebSSOApiProvider"}async getToken(e,t){return(0,i.Y)((()=>Excel.run({delayForCellEdit:!0},(async()=>(await OfficeFirstPartyAuth.getAccessToken(e,{popup:t})).accessToken))),r.R.getLoadAuthLibraryTimeout())}async getPrimaryIdentityEmail(){return await this.load(),(await OfficeFirstPartyAuth.getPrimaryIdentityInfo()).email}isLoaded(){return this.loaded}async load(){OfficeFirstPartyAuth.authFlow="authcode",0===this.delayMs&&0===OfficeFirstPartyAuth.delay&&(this.delayMs=12e3,OfficeFirstPartyAuth.delay=this.delayMs,OfficeFirstPartyAuth.delayMsal=this.delayMs),await OfficeFirstPartyAuth.load(d.dS),this.loaded=!0}getLoadProps(){return{delayAllowed:this.delayMs}}constructor(){this.delayMs=0,this.loaded=!1}}class m{hasMore(){return this.providers.length>0}removeCurrent(){this.providers.shift()}getCurrent(){if(!this.hasMore())throw new Error("No AuthProviders available");return this.providers[0]}reset(e){this.providers=e||[new u]}constructor(e){this.providers=[],this.reset(e)}}var g=a(66506);class h{async getPrimaryIdentityEmail(){const e=new l.A("GetPrimaryIdentityEmail");try{const t=await this.authHost.providers.getCurrent().getPrimaryIdentityEmail();return e.succeed({}),t}catch(t){throw e.fail(n.$b.Warning,{},t),new Error}}async authorize(e,t,a){let o;for(;this.authHost.providers.hasMore();){const r=this.authHost.providers.getCurrent().getName(),i=new l.A("Authorize");i.sendStart({scope:JSON.stringify(e),parentCallId:t});try{const a=await this.getAccessTokenSilent(e,t);return i.succeed({parentCallId:t,usedPopup:!1,usedLastAttempt:!1,provider:r}),a}catch(e){o=o||e}if("WebOAuthApiProvider"!==r){if(!(0,g.f)())try{const a=await this.getAccessTokenInternal(e,!0,t);return i.succeed({parentCallId:t,usedPopup:!0,usedLastAttempt:!1,provider:r}),a}catch(e){}try{if(a){const n=await a(e,t);return i.succeed({parentCallId:t,usedPopup:!0,usedLastAttempt:!0,provider:r}),n}}catch(e){}}i.fail(n.$b.Warning,{parentCallId:t,usedPopup:!0,usedLastAttempt:!!a,provider:r},o),this.authHost.providers.removeCurrent()}throw new Error("Authorization Error")}async getAccessTokenSilent(e,t){return this.getAccessTokenInternal(e,!1,t)}async getAccessTokenInternal(e,t,a){return await this.authHost.ensureAuthLibraryLoaded(a),(0,i.U)((async()=>this.getAccessTokenFn(e,t,a)),(()=>!0),(()=>!1),1)}async getAccessTokenFn(e,t,a){const o=new l.A("GetAccessToken");try{const n=await this.authHost.providers.getCurrent().getToken(e,t);return o.succeed({parentCallId:a,usePopup:t}),n}catch(e){throw o.fail(n.$b.Warning,{parentCallId:a,usePopup:t},e),e}}constructor(e){this.authHost=e}}var p=a(41485),b=a(49437),f=a(91918);const C={resource:p.Vs},y={resource:p.U4};class v{async authorizeStorageService(e){const t=v.getStorageScope();return this.authorizeScope(t,e)}async authorizeScope(e,t){const a=this.tokenCache;if(a){if(!(Date.now()>a.expirationTime))return a.token;this.clearStorageToken()}return this.pendingPromise||(this.pendingPromise=this.auth.authorize(e,t,v.fallbackFn).then((e=>(this.pendingPromise=void 0,this.cacheStorageToken(e,Date.now()+v.getExpirationTime()),e)))),this.pendingPromise}static putFallbackFn(e){v.fallbackFn=e}static getStorageScope(){return"makerserviceint"===x()?y:C}cacheStorageToken(e,t){Number.isInteger(t)&&(this.tokenCache={token:e,expirationTime:t})}getCachedStorageToken(){return this.tokenCache}static getExpirationTime(){return 864e5}clearStorageToken(){this.tokenCache=void 0}static getAuthProviders(){return[new u]}static instance(){const e=v.getAuthProviders();return v._instance||(v._instance=new v(new h(new c(new m(e))))),v._instance}constructor(e){this.auth=e}}var T;function x(){const e=(0,b.P)("StorageModePreference");if(e)return e;return"Dogfood"===(0,f.A)()?"makerserviceint":"makerserviceprodnew"}!function(e){e.makerserviceprodnew="makerserviceprodnew",e.makerserviceint="makerserviceint"}(T||(T={}))},66506:(e,t,a)=>{function n(){return Office.context.platform===Office.PlatformType.PC||Office.context.platform===Office.PlatformType.Mac}a.d(t,{f:()=>n})},7704:(e,t,a)=>{a.d(t,{c:()=>n});class n{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}},95789:(e,t,a)=>{a.d(t,{q:()=>l});var n=a(88179),o=a(31030),r=a(48314),i=a(66506);function l(e){if(!(0,i.f)())try{Office.context.ribbonGallery.refreshRibbon(e)}catch(e){!function(){const e=r.M.getInstance(),t={eventType:o.S.RefreshRibbonGallery,errorMessage:"",logLevel:n.$b.ASHA},a=[{key:n.ib.ErrorMessage,value:"Something went wrong while refreshing ribbon gallery after save."}];e.logError(t,void 0,a)}()}}},2070:(e,t,a)=>{a.d(t,{U:()=>i,Y:()=>l,or:()=>s});var n=a(7704),o=a(50347),r=a(98539);async function i(e,t,a,n=3,i,l=!1,s=0){const c=(0,o.yw)("OfficeVSO_9364466_NoWaitOnHandledRetry");let d,u;do{n--;try{const a=await e(i);if(u=a,t(a,i))return a}catch(e){if(d=e,a(e,i))throw e}finally{c||s>0&&await(0,r.u)(s)}c&&s>0&&await(0,r.u)(s)}while(n>0);if(l&&u)return u;throw d}async function l(e,t){let a;const o=new Promise(((e,t)=>{a=new n.c(e,t)}));return e().then(a.resolve).catch(a.reject),(0,r.u)(t).catch(a.reject),o}function s(...e){return function(e,...t){return t.reduce(((t,a)=>e(t,a)))}(((e,t)=>a=>e(a)||t(a)),...e)}},825:(e,t,a)=>{a.d(t,{L:()=>A,f:()=>L});var n=a(88179),o=a(2117),r=a(48314);var i=a(41485),l=a(49437),s=a(2070);function c(e){return e instanceof i.Je&&e.errorCode===i.F4.PlatformDisabled}function d(e){return e instanceof i.Je&&e.errorCode===i.F4.ItemNotFound}function u(e){return e instanceof i.Je&&e.errorCode===i.F4.AccessDenied}function m(e){return e instanceof i.Je&&e.errorCode===i.F4.InvalidRequest}function g(e){return e instanceof i.Je&&e.errorCode===i.F4.MaxItemCountExceeded}const h=["Failed to fetch","NetworkError when attempting to fetch resource.","Network request failed"];const p=(0,s.or)(c,(function(e){return e instanceof i.Je&&e.errorCode===i.F4.NotAllowed})),b=(0,s.or)(p,m),f=(0,s.or)(p,d),C=(0,s.or)((function(e){return e instanceof i.Je&&e.errorCode===i.F4.NameAlreadyExists}),d),y=(0,s.or)(p,d,(function(e){return e instanceof i.Je&&e.errorCode===i.F4.InvalidFileName}),g),v=(0,s.or)((function(e){return!(e instanceof i.Je)&&e.message&&h.indexOf(e.message)>=0||e instanceof i.Je&&"Server returned non-json response"===e.message}),(function(e){return"Authorization Error"===e.message&&e.isExpectedError}),g);var T=a(84654);const x={token:null},S=e=>{const t=x;var a;t.token=e,a=t,(0,i.sA)({currentUserToken:a.token,currentUserMlapiToken:null})},w=()=>!0;async function E(e,t,a){const n=async t=>(await async function(e){const t=await o.P1.instance().authorizeStorageService(e);S(t),(0,i.HR)(L()),(0,i.mY)((0,T.u)())}(t),e(t));return(0,s.U)((async()=>async function(e,t){try{return await e(t.id)}catch(e){throw e instanceof i.Je&&401===e.status&&((0,i.ki)(null),o.P1.instance().clearStorageToken()),e}}(n,t)),w,(0,s.or)(y,a),3)}var R=a(75633),I=a(91918);class A{async getScript(e,t){const a=new R.A("getScript");try{const n=await E((t=>(0,i.IT)(e,t,!0)),a,f);return a.succeed({storageId:e.id,parentCallId:t}),n}catch(o){const r=f(o)||v(o)||u(o)?n.$b.Warning:n.$b.Error;throw a.fail(r,{parentCallId:t,storageId:e.id,writeMRU:!0},o),o}}async getCopilotScripts(e){const t=new R.A("getCopilotScripts"),a=await this.getRecentScripts(e);return t.succeed({copilotScriptCount:a.length,parentCallId:e}),a}async saveCopilotScript(e,t){const a=new R.A("saveCopilotScript");let o;try{return o=await E((t=>(0,i.FB)(e,t,!0)),a,(0,s.or)(C,p)),a.succeed({storageId:o.id,parentCallId:t}),o}catch(r){throw a.fail(n.$b.Error,{parentCallId:t,storageId:e.id},r),o&&this.removeScriptShim(o),r}}async removeRecentScriptShim(e,t){const a=new R.A("RemoveRecentScript");try{await E((e=>(0,i.zb)(t,e)),a,(0,s.or)(y,v)),a.succeed({storageId:e,parentCallId:r.M.userQueryGuid})}catch(t){a.fail(n.$b.Warning,{storageId:e,parentCallId:r.M.userQueryGuid},t)}}async removeScriptShim(e){const t=new R.A("DeleteScript");try{await E((t=>(0,i.Wb)(e,t)),t,(0,s.or)(d,c)),t.succeed({storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}})}catch(a){if(d(a)&&e.mruItemId&&await this.removeRecentScriptShim(e.id,e.mruItemId),d(a))return void t.succeed({storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}});const o=c(a)||v(a)||u(a)?n.$b.Warning:n.$b.Error;throw t.fail(o,{storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}},a),a}}async getRecentScripts(e){const t=new R.A("getRecentScripts");try{const a=await E((e=>(0,i.g5)("undefined"!=typeof Office&&Office.context&&Office.context.host?Office.context.displayLanguage:"en-US",e)),t,b);return t.succeed({scriptCount:a.length,parentCallId:e}),a}catch(a){const o=(0,s.or)(p,u)(a),r=m(a);throw t.fail(o||v(a)?n.$b.Warning:r?n.$b.ASHA:n.$b.Error,{parentCallId:e},a),new Error("Failed getRecentScripts call")}}}function L(){const e=(0,l.P)("StorageModePreference");if(e)return e===o.XT.makerserviceint?"int":"prodNew";return"Dogfood"===(0,I.A)()?"int":"prodNew"}},98539:(e,t,a)=>{function n(e){return new Promise((t=>setTimeout(t,e)))}a.d(t,{u:()=>n})},79474:(e,t,a)=>{a.d(t,{n:()=>o,r:()=>v});var n,o,r=a(49783),i=a(81364),l=a(8505),s=a(49134),c=a(52389),d=a(92779),u=a(35828),m=a(46224),g=a(23147),h=a(50347),p=a(33851),b=a(58918),f=a(71362),C=a(70364),y=a(84036);!function(e){e.Label="Label",e.Content="Content"}(n||(n={})),function(e){e.PythonDataFrameInserter="PythonDataFrameInserter",e.PythonCodeAndPreviewInserter="PythonCodeAndPreviewInserter",e.PythonCalculatedColumnInserter="PythonCalculatedColumnInserter",e.PythonDetailSheetInserter="PythonDetailSheetInserter"}(o||(o={}));class v{conditionallySelect(e){((0,h.vE)()||(0,h.o2)())&&g.CP.pythonContextManager.disableAutoScroll||e.select()}addCodeAndOutputToBuilder(e){e.codeExplanation=this.codeExplanation,e.codeLabel=this.codeLabel,g.CP.pythonContextManager.pythonContextBuilder.setCodeAndOutput(e)}getDiagnosticEntryForCell(e,t,a){try{const n=(0,r.q)(e,t,a);return g.CP.pythonContextManager.diagnosticsEntriesMap.get(n)}catch(e){(0,u.QX)(null,(0,u.pJ)(),!1)}}async onCalculatedHandler(e,t){!(0,h.yw)("OfficeVSO_9507767_StopRunningPythonAAOnStopGenerate")||g.CP.pythonContextManager.shouldGenerate?await Excel.run((async n=>{try{const o=Promise.all([a.e("vendors~calc"),a.e("calc")]).then(a.bind(a,93961)),r=n.workbook.worksheets.getItem(e.worksheetId).load("id"),i=e.address.split(",");for(const e of i){const a=(0,h.yw)("OfficeVSO_9480049_specialrefnamesInEnglish")?r.getRange(e).load(["formulasLocal","valuesAsJson"]):r.getRange(e).load(["formulas","valuesAsJson"]);await n.sync();const i=(0,m.o7)(t);if((0,h.SA)())if((0,h.yw)("OfficeVSO_9480049_specialrefnamesInEnglish"))for(let t=0;t<a.formulasLocal.length&&!this.onCalculatedFinished;t++)for(let l=0;l<a.formulasLocal[t].length&&!this.onCalculatedFinished;l++)await this.onAddressCalculateHandler(n,o,r,a,e,i,a.formulasLocal[t][l],t,l);else for(let t=0;t<a.formulas.length&&!this.onCalculatedFinished;t++)for(let l=0;l<a.formulas[t].length&&!this.onCalculatedFinished;l++)await this.onAddressCalculateHandler(n,o,r,a,e,i,a.formulas[t][l],t,l);else(0,h.yw)("OfficeVSO_9480049_specialrefnamesInEnglish")?await Promise.all(a.formulasLocal.flatMap(((t,l)=>t.map((async(t,s)=>await this.onAddressCalculateHandler(n,o,r,a,e,i,t,l,s)))))):await Promise.all(a.formulas.flatMap(((t,l)=>t.map((async(t,s)=>await this.onAddressCalculateHandler(n,o,r,a,e,i,t,l,s))))))}}catch(e){this.onCalculatedFinished||((0,y.i5)(!1),(0,y.$k)(this.dispatch)),(0,h._T)()&&f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch),(0,u.Kx)(this.dispatch,e,"onCalculatedHandler")}})):this.onCalculatedHandlerShouldNotGenerate()}onCalculatedHandlerShouldNotGenerate(){f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch)}async onAddressCalculateHandler(e,t,a,n,o,r,i,c,d){const u=(0,m.o7)(i),p=await this.mutex.waitFor();if(this.onCalculatedFinished)p.release();else if(r===u){(0,y.i5)(!0),(0,y.$k)(this.dispatch),this.onCalculatedFinished=!0,p.release(),this.onCalculatedResult?.remove(),await(this.onCalculatedResult?.context.sync()),this.onCalculatedResult=null;const r=s.ExcelCalc.addressToExcelRange(o).topLeft;r.column=(r.column??0)+d,r.row=(r.row??0)+c;const i={topLeft:r,bottomRight:r},u=s.ExcelCalc.IExcelRangeToAddress(i),m=await g.CP.pythonContextManager.getPythonCellContext(a.id,u);if(!(0,h.SA)()||!this.skipInsertPostView){const n=m.output;if((0,h.yw)("OfficeVSO_9210153_PythonPostViewErrorCard"))if("Error"!==m.outputType&&"Python"!==n.errorType)if((0,h._T)()){let n;(0,h.yw)("OfficeVSO_9476928_EnableDiagnosticsInPostView")&&m.outputType===l.qf.None&&(n=this.getDiagnosticEntryForCell(r.row,r.column,a.id)),await f.n.updatePythonCodeAndPostViewCardWithPostView(this.dispatch,u,t,a,e,n)}else await this.showPostViewInChatPane(a,u,t,e);else(0,h._T)()&&f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch);else await this.showPostViewInChatPane(a,u,t,e)}(0,h.SA)()&&this.skipInsertPreView||await this.insertPreViewInGrid(a,u,m,e),await this.handlePythonCellExecutionResult(m,n,u)}else p.release()}async showPostViewInChatPane(e,t,a,n){await f.n.displayPythonPostViewResponse(this.dispatch,e,n,t,a,this.requestId)}async insertImageForPreview(e,t,a,n,o){const r=t.shapes.addLocalImageReference(n);return(0,h.yw)("OfficeVSO_9489083_PythonAASheetFormatting")?r.incrementTop(a.height):r.incrementLeft(a.width),r.lineFormat.color="#000000",(0,h.yw)("OfficeVSO_9378177_PythonAddAltText")&&(r.altTextTitle=this.codeLabel??(0,d.XZh)()),(0,h.iB)()&&o&&(r.load("height"),await e.sync(),r.lockAspectRatio=!0,r.scaleHeight(a.height*this.imageHeightInCells/r.height,Excel.ShapeScaleType.currentSize,Excel.ShapeScaleFrom.scaleFromTopLeft)),await e.sync(),(0,h.o2)()&&(0,m.lE)("ShowPythonAdvancedAnalysisFreA2"),r}async insertPreViewInGrid(e,t,a,n){try{if("Error"===a.outputType||(0,m.Hq)(a.outputType)){if((0,m.Hq)(a.outputType)){const a=e.getRange(t).load("width, height");if(a.track(),await n.sync(),(0,h.yw)("OfficeVSO_9469851_InsertAndResizePythonAAChartInOneUndoGroup")?await(0,C.F5)((async o=>{await this.insertImageForPreview(n,e,a,t,!0)})):await this.insertImageForPreview(n,e,a,t,!0),(0,h.yw)("OfficeVSO_9377925_ScrollOnPreviewInsertion")){const a=e.getRange(t).getOffsetRange(this.imageHeightInCells,0);this.conditionallySelect(a)}(0,h.yw)("OfficeVSO_9409229_PythonInsertFailureBugFixes")?(this.conditionallySelect(a),a.untrack(),await n.sync()):(this.conditionallySelect(a),await n.sync(),a.untrack())}}else{const e=await(0,m.WH)(n,this.sheetId);await this.insertLabelAndContentForPreviewOrFormula(n,e,(0,d.ZOw)(),`=IFERROR(${t}.arrayPreview,${t}.Python_str)`,!1,!1)}}catch(e){if((0,h.yw)("OfficeVSO_9409229_PythonInsertFailureBugFixes")){const t=`class: AbstractPythonInserter, method: "insertPreViewInGrid, outputType: ${a.outputType}`;if((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")){const a=(0,u.MF)(e,"AbstractPythonInserter","insertPreViewInGrid","PythonDataFrameInserter"===this.inserterType,t);(0,u.Kx)(this.dispatch,a,"insertPreViewInGrid")}else(0,u.Kx)(this.dispatch,e,t,!1,i.O.PythonInsertFailed)}else{const e=(0,u.zj)(i.O.PythonInsertFailed,"Class: AbstractPythonInserter, Method: insertPreViewInGrid");(0,u.Kx)(this.dispatch,e,"insertPreViewInGrid")}}}getOffsetRange(e,t,a,n,o){try{const n=t.rowIndex+(t.rowCount-1);return e.getRangeByIndexes(n+a,t.columnIndex,1,1)}catch(e){let t;const r=`isPythonFormula: ${o} offset: ${a} rangeType: ${n}`;if((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes"))t=(0,u.MF)(e,"AbstractPythonInserter","getOffsetRange","PythonDataFrameInserter"===this.inserterType,r);else{const e=`class: AbstractPythonInserter, method: "getOffsetRange" ${r}`;t=(0,u.zj)(i.O.PythonInsertFailed,e)}throw t}}async getUsedRange(e,t){const a=t.protection.load("protected"),n=t.getUsedRangeOrNullObject();if(await e.sync(),!n.isNullObject){if(n.load(["rowIndex","rowCount","columnIndex","address"]),n.track(),await e.sync(),a.protected)throw(0,h.yw)("OfficeVSO_9440528_UpdatePythonProtectedSheetError")?(0,u.Eu)():(0,u.zj)(i.O.PythonProtectedSheetError);return n}}async logHiddenRowsAndColumns(e,t,a){t.load("rowHidden, columnHidden"),a.load("rowHidden, columnHidden"),await e.sync(),(t.rowHidden||t.columnHidden||a.rowHidden||a.columnHidden)&&(0,p.XB)(t.rowHidden,t.columnHidden,a.rowHidden,a.columnHidden)}async logHiddenRowsAndColumns_old(e,t){t.load("rowHidden, columnHidden"),await e.sync(),(t.rowHidden||t.columnHidden)&&(0,p.BN)(t.rowHidden,t.columnHidden)}async checkIsPythonErrorCell(e,t,a){const[n,o]=(0,m.Jy)(a);o&&(a=o);const r=t.getRange(a);r.load(["valuesAsJson","formulas"]),await e.sync();const i=r.formulas[0][0],s=m.sy.test(i),c=r.valuesAsJson[0][0],d=String(c.type??"");return s&&d===l.qf.Error}async checkIsPythonCellImageType(e,t,a){const[n,o]=(0,m.Jy)(a);o&&(a=o);const r=t.getRange(a);r.load(["valuesAsJson","formulas"]),await e.sync();const i=r.formulas[0][0],l=m.sy.test(i),s=r.valuesAsJson[0][0],c=String(s.Python_type??"");return l&&(0,m.Hq)(c)}getRanges(e,t,a,n=0){if(void 0===t){return{labelRange:e.getRange("A1"),contentRange:e.getRange("A3")}}{let o,r;(0,h.yw)("OfficeVSO_9489083_PythonAASheetFormatting")&&a?(o=this.codeLabelOffset,r=this.codeContentOffset):(0,h.yw)("OfficeVSO_9489083_PythonAASheetFormatting")&&!a?(o=this.previewLabelOffset,r=this.previewContentOffset):(o=this.labelOffset,r=this.contentOffset);return{labelRange:this.getOffsetRange(e,t,o+n,"Label"),contentRange:this.getOffsetRange(e,t,r+n,"Content")}}}async updateExcelRangesIfPythonError(e,t,a,n,o){let r=n,i=o,l=!1;const c=g.CP.pythonContextManager.getLastPythonCell(!0);if(c){const n=c.sheetAddress,o=c.sheetId===this.sheetId;if(e&&o&&await this.checkIsPythonErrorCell(t,a,n)){const e=s.ExcelCalc.sheetAddressToICellRange(n),t=e.FirstRow,o=e.FirstColumn;r=a.getRangeByIndexes(t-1,o,1,1),i=a.getRangeByIndexes(t,o,1,1),c.wasDeleted=!0,l=!0}}return{labelAndContentRangesUpdated:l,labelRange:r,contentRange:i}}async setLabelAndContent(e,t,a,n,o,r,l,s){try{let i,c,d=!1;const u=this.getRanges(t,a,r);if(i=u.labelRange,c=u.contentRange,({labelAndContentRangesUpdated:d,labelRange:i,contentRange:c}=await this.updateExcelRangesIfPythonError(r,e,t,i,c)),!d&&r&&(0,h.iB)()){const n=g.CP.pythonContextManager.getLastPythonCell(!1),o=!n||n.sheetId===this.sheetId;if(n&&o){if(await this.checkIsPythonCellImageType(e,t,n.sheetAddress)){const{labelRange:e,contentRange:n}=this.getRanges(t,a,r,this.imageHeightInCells);i=e,c=n,d=!0}}}if(i.track(),c.track(),(0,h.yw)("OfficeVSO_9409229_PythonInsertFailureBugFixes")&&await e.sync(),i.values=[[n]],s)i.format.font.size=s;else if((0,h.yw)("OfficeVSO_9489083_PythonAASheetFormatting")){const e=r?14:12;i.format.font.size=e,r&&(i.format.font.color=b.e)}if(i.format.font.bold=!0,l&&(0,h.yw)("OfficeVSO_9480049_specialrefnamesInEnglish")?c.formulasLocal=[[o]]:c.values=[[o]],await e.sync(),(0,h.o2)()&&!r){const e="PythonDataFrameInserter"===this.inserterType,t="PythonCodeAndPreviewInserter"===this.inserterType;let a="";e?a="ShowPythonAdvancedAnalysisFre":t&&(a="ShowPythonAdvancedAnalysisFreA2Plot"),""!==a&&(0,m.lE)(a)}else(0,h.vE)()&&r&&(0,m.jC)(c,"ShowPythonAdvancedAnalysisWave1");return(0,h.yw)("OfficeVSO_9489287_PythonAAHiddenRowColLog")?await this.logHiddenRowsAndColumns(e,i,c):(await this.logHiddenRowsAndColumns_old(e,i),await this.logHiddenRowsAndColumns_old(e,c)),{contentRange:c,labelRange:i}}catch(e){let t;if((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes"))t=(0,u.MF)(e,"AbstractPythonInserter","setLabelAndContent","PythonDataFrameInserter"===this.inserterType);else{const e=`class: AbstractPythonInserter, method: "setLabelAndContent, isPythonFormula: ${r}`;t=(0,u.zj)(i.O.PythonInsertFailed,e)}throw t}}async insertLabelAndContentForPreviewOrFormula(e,t,a,n,o,r,i){const l=await this.getUsedRange(e,t);o&&(this.onCalculatedResult=t.onCalculated.add((async e=>this.onCalculatedHandler(e,n))),(0,p.BA)(this.requestId));const{contentRange:s,labelRange:c}=await this.setLabelAndContent(e,t,l,a,n,o,r,i);if((0,h.yw)("OfficeVSO_9235214_SettingPythonCellSelection")&&(s.load("address"),await e.sync()),(0,h.yw)("OfficeVSO_9257763_ForceRecalcInManualMode")){await(0,m.eU)()===Excel.CalculationMode.manual&&((0,h.yw)("OfficeVSO_9575127_useApplicationCalculate")?await Excel.run((async e=>{e.application.calculate(Excel.CalculationType.full)})):s.calculate(),(0,p.$J)(o))}o&&(this.conditionallySelect(s),g.CP.isPythonCellSelected=!0,(0,h.yw)("OfficeVSO_9235214_SettingPythonCellSelection")&&(g.CP.selectedPythonSheetId=this.sheetId,g.CP.selectedPythonAddress=s.address)),(0,h.yw)("OfficeVSO_9235214_SettingPythonCellSelection")||s.load("address"),await e.sync();const d=s.address;void 0!==l&&l.untrack(),s.untrack(),c.untrack(),(0,h.yw)("OfficeVSO_9409229_PythonInsertFailureBugFixes")&&await e.sync();const u=await this.getUsedRange(e,t);if(void 0!==u){if((0,h.yw)("OfficeVSO_9377925_ScrollOnPreviewInsertion")&&!o){if((0,h.yw)("OfficeVSO_9561788_handleInvalidGetSelectedRange")){const t=u.getLastRow().getOffsetRange(1,0).getCell(0,0);try{const a=e.workbook.getSelectedRange();this.conditionallySelect(t),this.conditionallySelect(a),await e.sync()}catch(e){this.conditionallySelect(t)}}else{const t=e.workbook.getSelectedRange(),a=u.getLastRow().getOffsetRange(1,0).getCell(0,0);this.conditionallySelect(a),this.conditionallySelect(t)}await e.sync()}await(0,m.t2)(e,u,this.dispatch)}return d}constructor(e,t,a,n,o,r=!1,i=!1){this.labelOffset=2,this.contentOffset=3,this.codeLabelOffset=3,this.codeContentOffset=4,this.previewLabelOffset=2,this.previewContentOffset=3,this.imageHeightInCells=16,this.mutex=new c.e,this.onCalculatedFinished=!1,this.onCalculatedResult=null,this.dispatch=e,this.sheetId=t,this.codeExplanation=n,this.codeLabel=o,this.skipInsertPreView=r,this.skipInsertPostView=i,this.inserterType=a}}},97667:(e,t,a)=>{a.d(t,{a1:()=>M,eG:()=>k,hn:()=>n,vY:()=>P});var n,o,r=a(34813),i=a(61150),l=a(92779),s=a(25433),c=a(23147),d=a(22330),u=a(50347),m=a(38924),g=a(98539);let h;!function(e){e.InitialQuery="initial-query",e.StartAnalysisCardShown="start-analysis",e.TurnComplete="turn-complete",e.RAIBlock="rai-block",e.PythonError="python-error"}(n||(n={})),function(e){e.Human="Human",e.ExcelCopilot="Excel Copilot"}(o||(o={}));const p="Help me analyze this using Python.",b=(0,u.Z8)("Microsoft.Office.Excel.FA000000124.PythonOutputGenerationMaximumResponseCards",10),f=(0,u.Z8)("Microsoft.Office.Excel.FA000000124.PythonOutputGenerationTestRetryMaximum",1),C=(0,u.Z8)("Microsoft.Office.Excel.FA000000124.PythonOutputGenerationStartRowIndex",2),y=(0,u.Z8)("Microsoft.Office.Excel.FA000000124.PythonOutputGenerationEndRowIndex",201);let v=0,T=0,x=[];const S=[];let w,E=0,R="",I=[],A=0,L="",F="",_="",N=[];async function k(e){try{if(0===T&&0===E){if((0,i.cY)(i.SA.Verbose,"Running Python RAI Prompt Harms Output Generation Tool..."),v=Date.now(),h=e,x=await async function(){return Excel.run({delayForCellEdit:!0},(async e=>{(0,i.cY)(i.SA.Verbose,"Python RAI Tool: Getting Tool Inputs...");const t=e.workbook.worksheets.getActiveWorksheet().load("name"),a=t.tables.getItemAt(0).load("rows/count"),n=a.getHeaderRowRange().load("values");if(await e.sync(),!t.name.startsWith("input-"))throw new Error("Please select an input sheet to proceed with the RAI Output Generation!");const o=n.values[0].indexOf("conversation_starter"),r=n.values[0].indexOf("document");let l=C;const s=[];for(let n=0;n<a.rows.count;n++){const i=a.rows.getItemAt(n).load("values");await e.sync(),_=t.name;const c=i.values[0][o];w=i.values[0][r];const d=w.replace(/\.csv$/,"");s.push({inputQuery:c,dataTableName:d,gridRowNumber:l}),l+=1}return s}))}(),C<2||C>y)throw new Error("Python RAI Tool: Invalid row numbers! Start row index must be greater than or equal to 2 (start of data) and less than or equal to end row index.");x=x.slice(C-2,y-2)}}catch(e){(0,i.cY)(i.SA.Verbose,`Python RAI Tool: Error Reading Test Input ${e}`)}try{(0,i.cY)(i.SA.Verbose,`Python RAI Tool: Running Test Case ${T}`);const e=x[T];L=e.inputQuery,F=e.dataTableName,await c.CP.fetchAndSetActiveTableLikeEntity(F),P("initial-query")}catch(e){$(e)}}function O(){const e=s.w.getInstance(h);return r.p.getInstance(h,e,[],m.dW)}async function P(e,t){try{switch(e){case"initial-query":await O().handlePythonRaiQuerySubmission(p);break;case"start-analysis":c.CP.pythonContextManager.isPythonMode=!0,await O().handlePythonStartAnalysis();break;case"turn-complete":0===A?(D(!1),D(!1),await O().handlePythonRaiQuerySubmission(L)):2===A&&(D(!1),await B());break;case"rai-block":D(!0),await B();break;case"python-error":throw new Error(t?.message??"")}}catch(t){$(t)}}function M(e){N.push(e)}function D(e){try{(0,i.cY)(i.SA.Verbose,"Python RAI Tool: Writing Output Metadata for Turn "+A);const t={turn_number:A,response:"",actor:1===A?"Human":"Excel Copilot"};if(0===A||2===A)if(e)t.response+=l.xe2.ServerErrorWithNoRetry;else for(let e=0;e<N.length&&!(e>=b);e++){const a=N[e];switch(a.type){case"text":t.response+=`${a.value.text} `??0;break;case"code":t.response+=`${a.value.code} `??0,t.response+=`${a.value.codeExplanation} `??0;break;case"finalText":t.response+=`${a.value.finalText} `??0;break;case"suggestions":t.response+=a.value.suggestions?`${JSON.stringify(a.value.suggestions)} `:"";break;default:throw new Error("Python RAI Tool - writeTurnOutput: Invalid Python Response Chunk Type")}}else t.response=L;N=[],A+=1,(0,i.cY)(i.SA.Verbose,`Turn Output Entry: ${JSON.stringify(t)}`),I.push(t)}catch(e){$(e)}}function $(e){(0,i.cY)(i.SA.Verbose,`Error in Test Case: ${e.message}`),S.push(x[T]),I=[],B()}async function B(){T+=1,A=0;const e={metadata:{name:"Human",chatbot_name:"Excel Copilot",document:w,documents_dir:""},conversation:I};if(R+=JSON.stringify(e)+"\n",I=[],await async function(){return Excel.run({delayForCellEdit:!0},(async e=>{e.workbook.worksheets.getItem(_).activate();const t=c.CP.pythonContextManager.pythonAnalysisSheetId;if(t){e.workbook.worksheets.getItem(t).delete()}await e.sync()}))}(),c.CP.pythonContextManager.exitAdvancedAnalysisMode(),T<x.length)await(0,g.u)(1e4),k(h);else if(S.length>0&&E<f)(0,i.cY)(i.SA.Verbose,`Python RAI Tool: Retrying Failed Test Cases Attempt ${E+1}: ${S}`),E+=1,T=0,x=S,k(h);else{const e=(0,d.WU)(v),t=Math.floor(e/60),a=e%60;(0,i.cY)(i.SA.Verbose,`Python RAI Tool: JSONL Output of Test: ${R}.`),(0,i.cY)(i.SA.Verbose,`Python RAI Tool: Failed Test Cases: ${S}.`),(0,i.cY)(i.SA.Verbose,`Python RAI Tool: All Test Cases Complete in ${t}m ${a}s.`)}}},49783:(e,t,a)=>{a.d(t,{q:()=>o,w:()=>r});var n=a(23147);function o(e,t,a){return`${e},${t},${a}`}function r(e){const t=e.row,a=e.column,r=e.worksheetId,i={stdErr:e.stderr,stdOut:e.stdout};return function(e,t){n.CP.pythonContextManager.diagnosticsEntriesMap.set(e,t)}(o(t,a,r),i),Promise.resolve()}},35828:(e,t,a)=>{a.d(t,{$C:()=>V,BH:()=>j,Eu:()=>B,HF:()=>Q,HH:()=>S,Jk:()=>U,Kx:()=>w,L7:()=>L,LH:()=>D,MF:()=>F,MQ:()=>x,Pi:()=>N,QX:()=>E,Qh:()=>T,RA:()=>R,U6:()=>A,Uc:()=>W,Vp:()=>ee,_s:()=>K,h3:()=>te,iY:()=>v,iq:()=>J,j9:()=>G,jK:()=>y,jY:()=>H,jv:()=>k,pJ:()=>z,pz:()=>P,rn:()=>I,w5:()=>_,x6:()=>q,xp:()=>M,zj:()=>$});var n=a(89099),o=a(24220),r=a(8505),i=a(81364),l=a(92779),s=a(31030),c=a(48314),d=a(88179),u=a(46224),m=a(23147),g=a(91259),h=a(50347),p=a(33851),b=a(71362),f=a(84036);class C extends Error{constructor(e,t,a,n){super(e),this.eventType=s.S.PythonError,this.errorCode=e,this.ashaVeto=t,this.ashaError=a,this.detailedErrorMessage=n}}function y(e){const t={errorCode:e.errorCode,detailedErrorMessage:e.detailedErrorMessage??"",ashaVeto:e.ashaVeto,ashaError:e.ashaError};return JSON.stringify(t)}function v(e){if((0,h.yw)("OfficeVSO_9473384_CheckPlatformThenLicenseThenLanguage")){if(Office.context.platform!==Office.PlatformType.PC)throw X();if(!(0,u.Gd)())throw Z();if(!(0,h.iP)("Microsoft.Office.Excel.FA000000124.PythonLanguageSupport",!1)&&!e?.startsWith("en")){throw Y(e?"Unsupported Language Detected":"OutputLanguage Undefined")}}else{if(!(0,h.iP)("Microsoft.Office.Excel.FA000000124.PythonLanguageSupport",!1)&&!e?.startsWith("en")){throw Y(e?"Unsupported Language Detected":"OutputLanguage Undefined")}if(Office.context.platform!==Office.PlatformType.PC)throw X();if(!(0,u.Gd)())throw Z()}}function T(e){let t;switch(e.errorCode){case i.O.PrePythonModeError:t=(0,l.y$1)();break;case i.O.PythonUnsupportedLanguage:t=(0,l.V9X)();break;case i.O.PythonNoActiveLicense:{const e=`[${(0,l.g1k)()}](${l.jv5})`;t=(0,g.L)((0,l.GLO)(),e);break}case i.O.PythonUnsupportedPlatform:{const e=`[${(0,l.g1k)()}](${l.jv5})`;t=(0,g.L)((0,l.S3X)(),e);break}case i.O.PythonStaleRuntimeError:t=(0,l.$L3)();break;case i.O.PythonBusyStateError:t=(0,l.Sk4)();break;case i.O.PythonGeneralError:{const e=`[${(0,l.A1r)()}](${l.O4H})`,a=(0,h.yw)("OfficeVSO_9425000_PythonDataFrameBlocked")?(0,l.jYw)():(0,l.z9Y)();t=(0,g.L)(a,e);break}case i.O.PythonProtectedSheetError:t=(0,l.FCw)();break;case i.O.PythonDeletedSheetBeforeResponseGeneration:t=(0,l.Rpx)();break;case i.O.PythonDeletedSheetDuringResponseGeneration:t=(0,l.Sl)();break;case i.O.PythonCodeRetryMaximumHit:t=(0,l.mq0)();break;case i.O.PythonStartAnalysisEditModeError:t=(0,l.dvg)();break;case i.O.PythonGenericEditModeError:t=(0,l.xUh)();break;case i.O.PayloadSizeError:t=(0,h.yw)("OfficeVSO_9396201_PythonRowTextNullCheck")?(0,l.OX0)():(0,l.zOC)();break;case i.O.PythonAddResultsToNewSheetError:t=(0,l.J9g)();break;default:t=(0,l.zOC)()}return t}function x(e,t){const a=`Catching Function: ${t}: `;return e instanceof Error?a+`${e.stack?e.stack:"Unknown Type"}: `:a+"Unknown Type"}function S(e){return e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode}async function w(e,t,a,r=!1,l,s=[],g=!1){(0,h.yw)("OfficeVSO_9544967_PythonTriedFixes")&&c.M.getInstance().endTriedActivityFailure(d.q.Python);let y="";(0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")&&(y=x(t,a));const v=`Catching Function: ${a}: `;let T;var w;t instanceof C?T=t:t instanceof Error?((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")||(y=v+`${t.stack?t.stack:"Unknown Type"}: `),S(t)?T=G(i.O.PythonGenericEditModeError,y):(0,h.yw)("OfficeVSO_9408289_DisplayPrePythonModeError")&&r?(w=y,T=new C(i.O.PrePythonModeError,o.W.Unable_To_Complete_Task,n.c.Pre_Python_Mode_Error,w)):T=!(0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")&&l&&"PythonInsertFailed"===l?$(i.O.PythonInsertFailed,y):(0,h.yw)("OfficeVSO_9541393_FixStartAABug")&&g||!(0,h.yw)("OfficeVSO_9480468_RichApiResourceNotFound")||!await async function(){try{return!await(0,u.J7)(m.CP)}catch{return!1}}()?O(y):ee(i.O.PythonDeletedSheetDuringResponseGeneration)):((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")||(y=v+"Unknown Type"),T=O(y)),b.n.displayPythonErrorResponse(e,T,s),(0,p.Lv)(T),(0,p.yQ)(T.ashaVeto,T.ashaError),(0,h.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(0,f.P_)(),(0,h.yw)("OfficeVSO_9421891_userLatencyDataPoints")&&(0,f.P_)()}function E(e,t,a){if(a){const a=T(t);b.n.displayPythonTextResponse(e,a,!1)}(0,p.Lv)(t),(0,p.yQ)(t.ashaVeto,t.ashaError)}function R(e){m.CP.pythonContextManager.disableAutoScroll=!1;E(void 0,te(i.O.PythonTuiNotShownError,e instanceof Error?e.stack:"No stack trace available"),!1)}function I(e,t){const a=function(e){return new C(i.O.PythonCodeAndPostViewPropsNotSerializable,o.W.Unable_To_Complete_Task,n.c.Python_Code_And_PostView_Props_Not_Serializable,e)}(t+` Props keys: ${Object.keys(e).join(", ")}`);E(void 0,a,!1)}function A(e){return e.output.errorType===Excel.ErrorCellValueType.busy}function L(e,t){if(e.outputType!==r.qf.Error)return;const a=e.output;if((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")){const e=a.errorType,t=`Python execution failed with error type: ${e}`;return e===Excel.ErrorCellValueType.python||e===Excel.ErrorCellValueType.timeout?$(i.O.PythonDataFrameInsertFailed,t):e===Excel.ErrorCellValueType.busy?k(t):e===Excel.ErrorCellValueType.connect?_(t):H(t)}return a.errorType===Excel.ErrorCellValueType.timeout?_(t):H(t)}function F(e,t,a,n,o){if((0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")&&e instanceof C)return e;if((0,h.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")&&S(e))return G(i.O.PythonGenericEditModeError);if((0,h.yw)("OfficeVSO_9440528_UpdatePythonProtectedSheetError")&&e instanceof C&&e.errorCode===i.O.PythonProtectedSheetError)return e;const r=`Class ${t}, Method: ${a}, Stack: ${e instanceof Error?e.stack:"No stack trace available"} + Details: ${o}`;return $(n?i.O.PythonDataFrameInsertFailed:i.O.PythonInsertFailed,r)}function _(e){return new C(i.O.PythonStaleRuntimeError,o.W.Unable_To_Complete_Task,n.c.Python_Runtime_In_Bad_State,e)}function N(e){return new C(i.O.PythonObjectReferenceError,o.W.Unable_To_Complete_Task,n.c.Python_Bad_Object_Reference,e)}function k(e){return new C(i.O.PythonBusyStateError,o.W.Unable_To_Complete_Task,n.c.Python_Runtime_Busy,e)}function O(e){return new C(i.O.PythonUnknownError,o.W.Unable_To_Complete_Task,n.c.Python_Unknown_Error,e)}function P(e){return new C(i.O.PythonPostViewError,o.W.Unable_To_Complete_Task,n.c.Python_PostView_Failed,e)}function M(e,t){return new C(e,o.W.Unable_To_Complete_Task,n.c.Python_Missing_Or_Invalid_Response,t)}function D(){return new C(i.O.PythonCopyFailed,o.W.Unable_To_Complete_Task,n.c.Failed_To_Copy_Code)}function $(e,t){return new C(e,o.W.Unable_To_Complete_Task,n.c.Python_Failed_To_Insert_Code,t)}function B(){return new C(i.O.PythonProtectedSheetError,o.W.Unable_To_Complete_Task,n.c.Python_Failed_Due_To_Protected_Sheet)}function H(e){return new C(i.O.PythonGeneralError,o.W.Unable_To_Complete_Task,n.c.Python_General_Grid_Error,e)}function U(e){return new C(i.O.PythonCodeRetryMaximumHit,o.W.Unable_To_Complete_Task,n.c.Python_Code_Retry_Maximum_Hit,e)}function q(e){return new C(i.O.PythonAugLoopCallsPerQueryMaximumHit,o.W.Unable_To_Complete_Task,n.c.Python_AugLoop_Calls_Per_Query_Maximum_Hit,e)}function V(e){return new C(i.O.PythonExitAnalysisError,o.W.Unable_To_Complete_Task,n.c.Python_Exit_Analysis,e)}function G(e,t){return new C(e,o.W.Unable_To_Complete_Task,n.c.Python_Cell_Edit_Mode,t)}function W(e,t){return new C(e,o.W.Unable_To_Complete_Task,n.c.Context_Extraction_Error,t)}function z(){return new C(i.O.PythonGetDiagnosticsError,o.W.Unable_To_Complete_Task,n.c.Python_Failed_To_Get_Diagnostics)}function Q(e){return new C(i.O.PythonSendSkillResponseToFlux,o.W.Unable_To_Complete_Task,n.c.Python_Failed_To_Send_Skill_Response_To_Flux,e)}function J(e){return new C(i.O.PythonAddResultsToNewSheetError,o.W.Unable_To_Complete_Task,n.c.Python_Add_Results_To_New_Sheet,e)}function j(e){return new C(i.O.PythonPayloadEmptyError,o.W.Unable_To_Complete_Task,n.c.Python_Payload_Empty,e)}function Y(e){return new C(i.O.PythonUnsupportedLanguage,o.W.Missing_Copilot_Functionality,n.c.Input_Language_Unsupported,e)}function X(){return new C(i.O.PythonUnsupportedPlatform,o.W.Missing_Copilot_Functionality,n.c.Unsupported_Platform_For_Python_In_Excel)}function K(e){return new C(i.O.PayloadSizeError,o.W.Missing_Copilot_Functionality,n.c.Payload_Too_Large,e)}function Z(){return new C(i.O.PythonNoActiveLicense,o.W.User_Access_Issue_For_Copilot,n.c.Users_Python_License_Could_Not_Be_Validated)}function ee(e,t){return new C(e,o.W.User_Rejected_Or_Cancelled_Response,n.c.Python_Analysis_Sheet_Deleted,t)}function te(e,t){return new C(e,o.W.Unable_To_Complete_Task,n.c.Python_Teaching_Callout_Not_Shown,t)}},84036:(e,t,a)=>{a.d(t,{$k:()=>R,BW:()=>E,Cc:()=>S,F5:()=>F,Fr:()=>I,P_:()=>k,QO:()=>L,YM:()=>_,i5:()=>A,l5:()=>w,oO:()=>N,xk:()=>f});var n=a(31030),o=a(92779),r=a(48314),i=a(6925),l=a(23147),s=a(50347),c=a(88179),d=a(33851),u=a(98483);let m,g,h,p,b="";var f,C;function y(e,t){t.push({key:"PythonDurationEvent",value:e}),(t=t.concat((0,d.p1)())).push({key:"UserScenarioId",value:b});const a={eventType:n.S.PythonDuration,eventData:t};r.M.getInstance().logEvent(a)}function v(e){const t=[];t.push({key:"TimerName",value:e}),y("TimerAlreadyRunning",t)}function T(e){const t=[];t.push({key:"TimerName",value:e}),y("TimerUndefined",t)}function x(e,t){const a=performance.measure(e,{start:t});return Math.round(a.duration)}function S(e,t,a,n){const o=(0,c.xJ)(t),r=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length,i=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length,s=[];s.push({key:"Duration",value:o}),s.push({key:"IsPythonCellSelected",value:l.CP.isPythonCellSelected}),s.push({key:"ConversationHistoryCount",value:r}),s.push({key:"OtherPythonCellsCount",value:i}),s.push({key:"IsSuccess",value:a}),n&&s.push({key:"OptionalDetails",value:n}),y(e,s)}function w(e,t,a){const n=(0,c.xJ)(t),o=[];o.push({key:"Duration",value:n}),a&&o.push({key:"RetryCount",value:a}),y(e,o)}function E(e){(0,s.yw)("OfficeVSO_9456567_UseRunningCodeString")&&e(i.mF.setLoadingStrings((0,o.NCh)()))}function R(e){(0,s.yw)("OfficeVSO_9456567_UseRunningCodeString")&&e(i.mF.setLoadingStrings((0,o.ZYo)()))}function I(e){(m||g)&&v("codeExecutionTimer"),m=(0,s.yw)("OfficeVSO_9421891_userLatencyDataPoints")?performance.now():(new Date).getTime(),g=e}function A(e){const t=l.CP.pythonContextManager.isFirstCodeExecution;if(l.CP.pythonContextManager.isFirstCodeExecution=!1,!m||!g)return void T("codeExecutionTimer");let a;a=(0,s.yw)("OfficeVSO_9421891_userLatencyDataPoints")?x(g,m):(0,c.xJ)(m);const n=[];n.push({key:"Duration",value:a}),n.push({key:"DidInsert",value:e}),n.push({key:"IsFirstCodeExecution",value:t}),y(g,n),m=void 0,g=void 0}function L(e,t,a){const n=(0,c.xJ)(t),o=[];o.push({key:"Duration",value:n}),a&&o.push({key:"OptionalDetails",value:a}),y(e,o)}function F(){h&&v("PythonUserScenario"),h=performance.now(),b=(0,u.A)(),p=0}function _(){p++,O("UserScenarioQueryToFirstResponse",!1)}function N(){O("UserScenarioQueryToFinalText",!0)}function k(){O("UserScenarioQueryToError",!0)}function O(e,t){if(!h)return void T("PythonUserScenario."+e);const a=x(e,h),n=[];n.push({key:"ResponseNumber",value:p}),n.push({key:"Duration",value:a}),y(e,n),t&&(h=void 0,b="",p=0)}!function(e){e.AdaContextExtraction="AdaContextExtraction",e.CodeExecution="CodeExecuted",e.DataFrameInsert="DataFrameInsert",e.ExecutePythonCodeApiCall="ExecutePythonCodeApiCall",e.FindDataFrameAddress="FindDataFrameAddress",e.GetActiveTableContext="GetActiveTableContext",e.GetAllPythonCellsUptoAnalysisSheet="GetAllPythonCellsUptoAnalysisSheet",e.GetExcelValueSingleCellOutput="GetExcelValueSingleCellOutput",e.GetLastPythonCellOnSheet="GetLastPythonCellOnSheet",e.GetPythonCellContext="GetPythonCellContext",e.GetPythonCellRange="GetPythonCellRange",e.GetPythonCellsFromWorksheet="GetPythonCellsFromWorksheet",e.GetPythonObjectOutput="GetPythonObjectOutput",e.GetPythonObjectReferenceIdWithRetry="GetPythonObjectReferenceIdWithRetry",e.GetUpdatedPythonTableContext="GetUpdatedPythonTableContext",e.GetUpdatedPythonTableContextForTableLikeRange="GetUpdatedPythonTableContextForTableLikeRange",e.InsertDataFrameAndGetPythonContext="InsertDataFrameAndGetPythonContext",e.InsertDataFrameIfNecessaryForStartAnalysis="InsertDataFrameIfNecessaryForStartAnalysis",e.IsPythonCell="IsPythonCell",e.RecalcSheet="RecalcSheet",e.StartAnalysisContextExtraction="StartAnalysisContextExtraction",e.TimerAlreadyRunning="TimerAlreadyRunning",e.TimerUndefined="TimerUndefined",e.UpdateConversationHistory="UpdateConversationHistory",e.UserScenarioQueryToError="UserScenarioQueryToError",e.UserScenarioQueryToFirstResponse="UserScenarioQueryToFirstResponse",e.UserScenarioQueryToFinalText="UserScenarioQueryToFinalText"}(f||(f={})),function(e){e.ConversationHistoryCount="ConversationHistoryCount",e.DidInsert="DidInsert",e.Duration="Duration",e.IsPythonCellSelected="IsPythonCellSelected",e.IsSuccess="IsSuccess",e.OptionalDetails="OptionalDetails",e.OtherPythonCellsCount="OtherPythonCellsCount",e.PythonDurationEvent="PythonDurationEvent",e.RetryCount="RetryCount",e.TimerName="TimerName",e.IsFirstCodeExecution="IsFirstCodeExecution",e.ResponseNumber="ResponseNumber",e.UserScenarioId="UserScenarioId"}(C||(C={}))},33851:(e,t,a)=>{a.d(t,{$:()=>i,$J:()=>D,Am:()=>d,BA:()=>_,BN:()=>A,DC:()=>F,Jr:()=>N,L3:()=>r,Lv:()=>B,M5:()=>w,PB:()=>R,Rj:()=>E,S$:()=>I,XB:()=>L,_1:()=>x,_8:()=>S,fU:()=>k,hp:()=>P,ii:()=>M,nQ:()=>O,p1:()=>U,xX:()=>$,yQ:()=>H});var n,o,r,i,l,s,c,d,u,m,g=a(8505),h=a(88179),p=a(79029),b=a(31030),f=a(48314),C=a(90922),y=a(23147),v=a(50347),T=a(46224);function x(e,t){f.M.getInstance().logEvent((0,h.SV)(e,h.q.Python,t))}function S(e){f.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionShown,h.q.Python,e)),f.M.getInstance().endTriedActivitySuccess(h.q.Python)}function w(){f.M.getInstance().logEvent((0,h.SV)(h.he.SuggestionApplied,h.q.Python,h.KZ.PythonAdaCodeInserted)),(0,v.BT)()?p.B.getInstance().logKeptEvent(h.BJ.Python,h.q.Python,C.RX.Analyze):f.M.getInstance().logKeptEvent(h.q.Python)}function E(e){const t=(0,h.SV)(h.he.TeachingCalloutShown,h.q.Python,h.KZ.PythonAdaCodeInserted);t.eventData.push({key:"CallOutScenario",value:e}),f.M.getInstance().logEvent(t)}function R(e,t){t.push({key:"PythonEvent",value:e}),t=t.concat(U());const a={eventType:b.S.PythonEvents,eventData:t};f.M.getInstance().logEvent(a)}function I(e,t){const a=[];let n=!0;if(t.outputType===g.qf.Error){const{errorName:t,errorType:o,errorSubType:r,errorMessage:i}=(0,T.$e)(e);n=!1,a.push({key:"ErrorName",value:t}),a.push({key:"ErrorType",value:o}),a.push({key:"ErrorSubType",value:r}),"ModuleNotFoundError"===t&&a.push({key:"ErrorMessage",value:i}),a.push({key:"RetryAttempts",value:y.CP.pythonContextManager.codeRetryAttempts})}a.push({key:"IsSuccess",value:n}),(0,v.yw)("OfficeVSO_9270732_PythonImageTypes")&&a.push({key:"OutputType",value:t.outputType}),R("ExecutionResult",a)}function A(e,t){const a=[];a.push({key:"RowHidden",value:e}),a.push({key:"ColumnHidden",value:t}),R("InsertInHiddenCell",a)}function L(e,t,a,n){const o=[];o.push({key:"LabelRowHidden",value:e}),o.push({key:"LabelColumnHidden",value:t}),o.push({key:"ContentRowHidden",value:a}),o.push({key:"ContentColumnHidden",value:n}),R("InsertInHiddenCell",o)}function F(e,t){const a=[];a.push({key:"CardType",value:e}),t&&a.push({key:"CalculationMode",value:t}),R("ResponseCardShown",a)}function _(e){const t=[];t.push({key:"RequestId",value:e}),R("ListenerAttached",t)}function N(e,t){const a=[];a.push({key:"AugLoopCalls",value:e}),a.push({key:"RetryAttempts",value:t}),R("AugLoopCallsCompleted",a)}function k(e,t,a,n,o){R("MessageToAugLoopIsTooLarge",[{key:"OperationSize",value:e},{key:"ContextMemoSize",value:t},{key:"MessageTextSize",value:a},{key:"QueryAnnotationSize",value:n},{key:"ImageTileSize",value:o}])}function O(e){const t=[];t.push({key:"ApiFailure",value:e}),R("ExecutePythonCodeApi",t)}function P(e,t){R("UpdateIsPythonCellSelected",[{key:"OldPythonCellSelected",value:e},{key:"CurrentIsPythonCellSelected",value:t}])}function M(e){const t=[];t.push({key:"MissingData",value:e}),R("IncompleteContext",t)}function D(e){const t=[];t.push({key:"IsPythonFormula",value:e}),R("ForcedCalculation",t)}function $(e,t,a){R("TrimmedContextModified",[{key:"Operation",value:e},{key:"QueryNull",value:t},{key:"Stack",value:a??"No stack available."}])}function B(e){const t={eventType:e.eventType,errorMessage:e.errorCode,logLevel:h.$b.ASHA};let a=[{key:"DetailedErrorMessage",value:e.detailedErrorMessage??e.message},{key:"Stack",value:e.stack??""}];a=a.concat(U()),f.M.getInstance().logError(t,void 0,a)}function H(e,t){f.M.getInstance().logStandardizedAshaErrorEvent(e,t,h.BJ.Python)}function U(){const e=[];return e.push({key:"PythonModeValue",value:y.CP.pythonContextManager.isPythonMode}),e.push({key:"PythonAnalysisSessionId",value:y.CP.pythonContextManager.analysisSessionId??""}),e.concat(function(){const e=[];return e.push({key:"IsPythonAdaInCopilotEnabled",value:(0,v.H2)()}),e.push({key:"IsPythonAdaClientDataFrameCreationEnabled",value:(0,v.Ff)()}),e.push({key:"IsPythonManualPromptEnabled",value:(0,v.w9)()}),e.push({key:"IsPythonRaiTestEnabled",value:(0,v.Eq)()}),e.push({key:"isPythonCalculatedColumnsEnabled",value:(0,v.vo)()}),e.push({key:"isPythonAddResultToNewSheetEnabled",value:(0,v.SA)()}),e}()),e}!function(e){e.PythonAnalysisSessionId="PythonAnalysisSessionId",e.PythonModeValue="PythonModeValue"}(n||(n={})),function(e){e.IsPythonAdaClientDataFrameCreationEnabled="IsPythonAdaClientDataFrameCreationEnabled",e.IsPythonAdaInCopilotEnabled="IsPythonAdaInCopilotEnabled",e.IsPythonManualPromptEnabled="IsPythonManualPromptEnabled",e.IsPythonRaiTestEnabled="IsPythonRaiTestEnabled",e.isPythonCalculatedColumnsEnabled="isPythonCalculatedColumnsEnabled",e.isPythonAddResultToNewSheetEnabled="isPythonAddResultToNewSheetEnabled"}(o||(o={})),function(e){e.AugLoopCallsCompleted="AugLoopCallsCompleted",e.CopyButtonClicked="CopyButtonClicked",e.ExecutePythonCodeApi="ExecutePythonCodeApi",e.ExecutionResult="ExecutionResult",e.ExitAnalysisClicked="ExitAnalysis",e.ForcedCalculation="ForcedCalculation",e.IncompleteContext="IncompleteContext",e.InsertInHiddenCell="InsertInHiddenCell",e.IsPythonCellFailed="IsPythonCellFailed",e.Key="PythonEvent",e.ListenerAttached="ListenerAttached",e.MessageToAugLoopIsTooLarge="MessageToAugLoopIsTooLarge",e.RecalcSheetMissingSheetId="RecalcSheetMissingSheetId",e.ResponseShown="ResponseCardShown",e.StartAnalysisClicked="StartAnalysisClicked",e.TrimmedContextModified="TrimmedContextModified",e.UpdateContextTLRCalledOnNonTLR="UpdateContextTLRCalledOnNonTLR",e.UpdateIsPythonCellSelected="UpdateIsPythonCellSelected"}(r||(r={})),function(e){e.ApiFailure="ApiFailure",e.AugLoopCalls="AugLoopCalls",e.CalculationMode="CalculationMode",e.CardType="CardType",e.Code="Code",e.ColumnHidden="ColumnHidden",e.CurrentIsPythonCellSelected="CurrentIsPythonCellSelected",e.ErrorMessage="ErrorMessage",e.ErrorName="ErrorName",e.ErrorStack="ErrorStack",e.ErrorSubType="ErrorSubType",e.ErrorType="ErrorType",e.FinalText="FinalText",e.IsSuccess="IsSuccess",e.MissingData="MissingData",e.OldPythonCellSelected="OldPythonCellSelected",e.OutputType="OutputType",e.RequestId="RequestId",e.RetryAttempts="RetryAttempts",e.RowHidden="RowHidden",e.StartAnalysis="StartAnalysis",e.Suggestions="Suggestions",e.Text="Text",e.CalloutScenario="CallOutScenario"}(i||(i={})),function(e){e.DetailedErrorMessage="DetailedErrorMessage",e.Stack="Stack"}(l||(l={})),function(e){e.IsPythonFormula="IsPythonFormula"}(s||(s={})),function(e){e.Operation="Operation",e.IsQueryNull="QueryNull",e.Stack="Stack"}(c||(c={})),function(e){e.Update="Update",e.Clear="Clear"}(d||(d={})),function(e){e.LabelRowHidden="LabelRowHidden",e.LabelColumnHidden="LabelColumnHidden",e.ContentRowHidden="ContentRowHidden",e.ContentColumnHidden="ContentColumnHidden"}(u||(u={})),function(e){e.OperationSize="OperationSize",e.ContextMemoSize="ContextMemoSize",e.MessageTextSize="MessageTextSize",e.QueryAnnotationSize="QueryAnnotationSize",e.ImageTileSize="ImageTileSize"}(m||(m={}))},58918:(e,t,a)=>{a.d(t,{e:()=>n});const n="#156082"},46224:(e,t,a)=>{a.d(t,{t2:()=>_e,nC:()=>Ce,J7:()=>ve,TI:()=>ye,Yp:()=>te,jC:()=>Me,bf:()=>Oe,lE:()=>Pe,ec:()=>Ne,yt:()=>Z,UH:()=>ee,OU:()=>_,vv:()=>re,Jy:()=>ae,VF:()=>Te,$e:()=>ue,u1:()=>se,eU:()=>ge,WH:()=>he,yK:()=>ce,ZK:()=>ie,B4:()=>ne,cx:()=>Y,WM:()=>K,gQ:()=>X,c3:()=>me,Gd:()=>A,gx:()=>L,T7:()=>xe,IY:()=>be,Hq:()=>ke,PV:()=>Le,mx:()=>Ie,FN:()=>Fe,bh:()=>Ae,Xn:()=>N,sy:()=>F,o7:()=>oe,AJ:()=>le,LC:()=>de});var n=a(23147),o=a(61150),r=a(81364),i=a(8505),l=a(49134),s=a(5550),c=a(92779),d=a(79474),u=a(84036),m=a(35828),g=a(91259),h=a(50347);var p=a(5911),b=a(65118),f=a(70364),C=a(98483);class y extends d.r{getDataFrameCodeHelper(e){let t=!0;return(0,h.yw)("OfficeVSO_9321092_InsertDataframeWithHeaderFalse")&&(t=this.hasHeaders),`${this.dataFrameName}=xl("${e}", headers=${t?"True":"False"})`}getDataFrameCode(e){if(this.tableLikeRange){if((0,h.yw)("OfficeVSO_9426161_DataframeShouldExcludeTotalRowForTLR")){const e=Te(this.address,this.hasTotalRow);return this.getDataFrameCodeHelper(e)}{const e=l.ExcelCalc.sheetNameFromSheetAddresses(this.name),t=l.ExcelCalc.localAddressesFromSheetAddresses(this.name),a=`'${Z(e)}'!${t}`;return this.getDataFrameCodeHelper(a)}}{const t=(0,h.yw)("OfficeVSO_9416323_DataframeShouldExcludeTotalRow")?`[${e}]`:`[#${e}]`,a=this.name+t;return this.getDataFrameCodeHelper(a)}}getDataFrameLabel(e,t){return(0,g.L)((0,c.YYS)(),e,t)}clearState(){this.resolve=void 0,this.reject=void 0}resolveAndClear(e){this.resolve&&this.resolve(e),this.clearState()}rejectAndClear(e){this.reject&&this.reject(e),this.clearState()}getAddressAndPythonCellContext(e){const t=Array.from(this.pythonCells.entries()).find((t=>{const[a,n]=t;return!(!(0,h.yw)("OfficeVSO_9425000_PythonDataFrameBlocked")&&((0,h.yw)("OfficeVSO_9425000_PythonDataFrameBlocked")||n.outputType===i.qf.Error)||!e(a,n))}));if(void 0!==t)return{address:t[0],pythonCellContext:t[1]}}codeRegexTest(e,t,a){return e.test(a.code)}codeRegexMissingSheetNameTest(e,t,a,n){return l.ExcelCalc.sheetNameFromSheetAddresses(t)===a&&e.test(n.code)}findDataFrame(e){if(this.tableLikeRange){const e=l.ExcelCalc.sheetNameFromSheetAddresses(this.name),t=l.ExcelCalc.localAddressesFromSheetAddresses(this.name),a=ee(e),n=X(a,t,!0),o=this.getAddressAndPythonCellContext(((e,t)=>this.codeRegexTest(n,e,t)));if(o)return o;const r=X(a,t,!1);return this.getAddressAndPythonCellContext(((t,a)=>this.codeRegexMissingSheetNameTest(r,t,e,a)))}{const t=K(this.name,e);return this.getAddressAndPythonCellContext(((e,a)=>this.codeRegexTest(t,e,a)))}}async getListSeparator(e){return e.application.cultureInfo.formulaCulture.load("listSeparator"),await e.sync(),e.application.cultureInfo.formulaCulture.listSeparator??","}autoInsertPythonFormula(){return new Promise(((e,t)=>{this.resolve=e,this.reject=t,(0,f.F5)((async e=>{try{const t=(0,h.yw)("OfficeVSO_9557540_AddSeparatorFormat")?await this.getListSeparator(e):",",a=await async function(){return await Excel.run({delayForCellEdit:!(0,h.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")},(async e=>(e.application.load("cultureInfo/formulaCulture/specialRefNames"),await e.sync(),e.application.cultureInfo.formulaCulture.specialRefNames)))}(),o=(0,h.yw)("OfficeVSO_9416323_DataframeShouldExcludeTotalRow")?`[#${a[1]}]${t}[#${a[2]}]`:a[0];if((0,h.yw)("OfficeVSO_9425000_PythonDataFrameBlocked")){const e=this.findDataFrame(o);if(e){const{address:t,pythonCellContext:a}=e,n=(0,m.L7)(a,"autoInsertPythonFormula");return n?void this.rejectAndClear(n):void this.resolveAndClear(t)}}else{const e=this.findDataFrame(o);if(e)return void this.resolveAndClear(e.address)}(0,u.Fr)(u.xk.DataFrameInsert),(0,u.BW)(this.dispatch);const r=this.getDataFrameCode(o),i=ie(r,!0,p.M),[s,d]=ae(this.address),f=this.tableLikeRange?d:this.name;let y=this.getDataFrameLabel(s,f);(0,h.yw)("OfficeVSO_9341197_PythonFixMissingLabel")||(y=y??(0,c.XZh)()),this.codeLabel=y;const v=await he(e,this.sheetId),T=await this.insertLabelAndContentForPreviewOrFormula(e,v,y,i,!0,!0);if((0,h._T)()){const e=l.ExcelCalc.localAddressesFromSheetAddresses(T),t=l.ExcelCalc.sheetNameFromSheetAddresses(T);n.CP.pythonContextManager.lastCodeAndPostViewMessage=b.n.displayPythonCodeCardWithPendingPostView(this.dispatch,(0,C.A)(),r,t,e,(0,h.yw)("OfficeVSO_9483481_UseLoadingDFString"),(0,g.L)((0,c.vCA)(),s,f),y)}}catch(e){if((0,u.i5)(!1),(0,u.$k)(this.dispatch),(0,h.yw)("OfficeVSO_9440568_CleanUpInsertionErrorHandlingLogic")){const a=(0,m.MF)(e,"PythonDataFrameInserter","autoInsertPythonFormula",!0);t(a)}else{if((0,h.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")&&e instanceof Error&&(0,m.HH)(e))return void this.rejectAndClear(e);let t;t=(0,h.yw)("OfficeVSO_9541912_PythonP1LoggingFixes")?(0,m.MF)(e,"PythonDataFrameInserter","autoInsertPythonFormula",!0):(0,m.zj)(r.O.PythonDataFrameInsertFailed,e instanceof Error?e.stack:"No stack trace available"),this.rejectAndClear(t)}}}),{delayForCellEdit:!(0,h.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")})}))}onCalculatedHandlerShouldNotGenerate(){super.onCalculatedHandlerShouldNotGenerate(),this.resolveAndClear(null)}async handlePythonCellExecutionResult(e,t){if((0,h.yw)("OfficeVSO_9425000_PythonDataFrameBlocked")){const t=(0,m.L7)(e,"handlePythonCellExecutionResult");if(t)return void this.rejectAndClear(t)}this.addCodeAndOutputToBuilder(e);const a=e.sheetAddress;this.pythonCells.set(a,e),this.resolveAndClear(a)}constructor(e,t,a,n,o,r,i,l){super(i,l,d.n.PythonDataFrameInserter),this.name=e,this.address=t,this.tableLikeRange=a,this.hasHeaders=n,this.hasTotalRow=o,this.pythonCells=r,this.dataFrameName=te(e)}}var v=a(88099),T=a(37745),x=a(33851);class S{getNextAvailableSheetName(e){const t=e.map((e=>{const t=this.sheetNameRegex.exec(e);return t?Number(t[1]):null})).filter((e=>null!==e&&e>=this.currentSheetNumber));t.sort(((e,t)=>e-t));for(const e of t){if(e!==this.currentSheetNumber)break;this.currentSheetNumber++}const a=this.sheetName+this.currentSheetNumber;return this.currentSheetNumber++,a}constructor(e){this.currentSheetNumber=1,this.sheetName=e,this.sheetNameRegex=Y(e)}}const w=new S((0,c.I_l)()),E=new S((0,c.r5N)());var R=a(58918),I=a(2070);function A(){return"true"===(s.Vv.getSettingAsString(s.zj.HasActivePythonLicense)??"false")}function L(){try{(0,m.iY)((0,T.gl)())}catch(e){return!1}return!0}const F=/^=[ ]*PY\(/,_=/.*['"],\s*0\)/,N=/^<class.*>$/,k=/["'\s]/g,O=RegExp("=[ ]*PY\\(['\"](.*)['\"],\\s*[01]\\s*\\)","s"),P=/[^a-zA-Z0-9_]/g,M=/^[^a-zA-Z_].*$/,D=/([A-Z]+|[0-9]+)/g,$=/\}/g,B=/\{/g,H=/\^/g,U=/\$/g,q=/\(/g,V=/\)/g,G=/\./g,W=/\+/g,z=/\|/g,Q=/"/g,J=/'/g,j=/''/g;function Y(e){return new RegExp(`^${e}([0-9]+)$`)}function X(e,t,a){const n=t.replace(D,"\\$?$1");return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*\\"${a?`'?${e}'?!`:""}${n}".*\\)\\s*`)}function K(e,t){return new RegExp((0,h.yw)("OfficeVSO_9416323_DataframeShouldExcludeTotalRow")?`.+\\s*=\\s*xl\\s*\\(\\s*\\"${e}\\[${(0,v.escapeRegExp)(t)}]".*\\)\\s*`:`.+\\s*=\\s*xl\\s*\\(\\s*\\"${e}\\[\\#${t}]".*\\)\\s*`)}function Z(e){return e.replaceAll(J,"''").replaceAll(Q,'\\"')}function ee(e){let t;return t=(0,h.yw)("OfficeVSO_9517624_BetterSheetNameEscaping")?e.replaceAll(J,"''").replaceAll(Q,'\\\\"').replaceAll($,"\\}").replaceAll(B,"\\{").replaceAll(H,"\\^").replaceAll(U,"\\$").replaceAll(V,"\\)").replaceAll(q,"\\(").replaceAll(G,"\\.").replaceAll(W,"\\+").replaceAll(z,"\\|"):e.replaceAll(J,"''").replaceAll(Q,'\\\\"'),t}function te(e){const t=e.replaceAll(P,"_")+"_df";return t.match(M)?"_"+t:t}function ae(e){return[l.ExcelCalc.sheetNameFromSheetAddresses(e).replaceAll(j,"'"),l.ExcelCalc.localAddressesFromSheetAddresses(e)]}function ne(e,t){let a,n;const[o,i]=ae(e);if((0,h.yw)("OfficeVSO_9365563_InsertDataFrameUseId")){if(a=t.get(e)?.sheetId,!a){const e="getSheetAndAddress: sheet deleted";throw(0,m.Uc)(r.O.PythonUnexpectedMissingSheetInContextExtraction,e)}n=i}else a=o,n=e;return{sheet:a,address:n}}function oe(e){return e.replace(k,"")}function re(e){const t=O.exec(e);return(null!=t?t[1]:"").replace(/""/g,'"')}function ie(e,t,a){let n;return e=e.replace(/"/g,'""'),n=t?`=PY("${e}", ${a})`:`"=PY(""${e=e.replace(/"/g,'""')}"",${a})"`,n}async function le(e,t,a,n){try{return await(0,I.U)(e,t,(()=>!1),a,void 0,!0,n)}catch(e){if((0,h.yw)("OfficeVSO_9441668_useRetryError")&&!e){const e=`Retry Wait (ms): ${n}, Max Attempts: ${a}`;throw(0,m.jv)(e)}throw e}}function se(e,t){const a=new Map([[Excel.ErrorCellValueType.python,"#PYTHON"],[Excel.ErrorCellValueType.timeout,"#TIMEOUT"]]),n=(0,c.YCq)(),o=a.get(e);return o?(0,g.L)((0,c.IiW)(),o,t):n}function ce(e){return`from excel import xl_ref as xl\nimport excel\n\n_ref_context = excel.get_ref_context()\n_ref_context.clear()\n_ref_context["stored_value"] = excel.ObjectReference("${e}")\n\nprimitives = (bool, str, int, float, type(None))\nvalue = None\nvalue_type = type(xl("stored_value"))\nis_data_frame = value_type == pd.DataFrame\nis_primitive = value_type in primitives\nif is_data_frame:\n  numRows = xl("stored_value").shape[0]\n  value = {\n    "columnNames": xl("stored_value").columns.values.tolist(),\n    "dataTypes": xl("stored_value").dtypes.tolist(),\n    "firstRowValues": xl("stored_value").iloc[0].values.tolist() if numRows > 0 else [],\n    "secondRowValues": xl("stored_value").iloc[1].values.tolist() if numRows > 1 else [],\n    "sampleRows": xl("stored_value").head(20).values.tolist() if numRows > 0 else [],\n    "numRows": numRows,\n    "numColumns": xl("stored_value").shape[1],\n  }\nelif is_primitive:\n  value = xl("stored_value")\nreturnValue = {\n  "value": value,\n  "value_type": value_type,\n  "is_data_frame": is_data_frame,\n  "is_primitive": is_primitive,\n}\nreturnValue`}function de(e){return e.map((e=>void 0===e?.value?e:e.value))}function ue(e){const t=e.valuesAsJson[0][0];return{errorName:t.errorName,errorType:t.errorType??"",errorSubType:t.errorSubType,errorMessage:t.errorMessage}}function me(e){if(e.includes("!")){return`'${l.ExcelCalc.sheetNameFromSheetAddresses(e)}'!${l.ExcelCalc.localAddressesFromSheetAddresses(e)}`}return e}async function ge(){return Excel.run((async e=>(e.application.load("calculationMode"),await e.sync(),e.application.calculationMode)))}async function he(e,t){const a=e.workbook.worksheets.getItemOrNullObject(t);if(!a){const{sheet:t}=await fe(e,n.CP);return t}return a}async function pe(e,t){const a=e.workbook.worksheets.load("items/name");await e.sync();const n=a.items.map((e=>e.name)),o=t(n);return a.add(o)}async function be(e){const t=await pe(e,E.getNextAvailableSheetName.bind(E));return await e.sync(),t}async function fe(e,t){let a;if((0,h.SA)())a=await pe(e,w.getNextAvailableSheetName.bind(w));else{const t=e.workbook.worksheets;t.load("items/name"),await e.sync();const n=t.items.map((e=>e.name)),o=w.getNextAvailableSheetName(n);a=t.add(o)}a.load("id");const n=a.getRange("A1");return n.values=[[(0,c.Efv)()]],n.format.font.bold=!0,(0,h.yw)("OfficeVSO_9489083_PythonAASheetFormatting")&&(n.format.font.size=24,n.format.font.color=R.e),a.getRange("A2").values=[[(0,c.LAW)()]],await e.sync(),a.activate(),t.pythonContextManager.pythonAnalysisSheetId=a.id,{id:a.id,sheet:a}}async function Ce(e,t){let a="";return await Excel.run((0,h.yw)("OfficeVSO_9265986_PythonDontDelayCellEdit")?{delayForCellEdit:!1}:{},(async n=>{const o=t.pythonContextManager.pythonAnalysisSheetId;if(o){const i=n.workbook.worksheets.getItemOrNullObject(o);if(i.load("isNullObject"),await n.sync(),i.isNullObject){if(t.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit)throw(0,m.Vp)(r.O.PythonDeletedSheetDuringResponseGeneration);{const o=(0,m.Vp)(r.O.PythonDeletedSheetBeforeResponseGeneration);(0,m.QX)(e,o,!0);const{id:i}=await fe(n,t);a=i}}else i.activate(),a=o}else{const{id:e}=await fe(n,t);a=e}})),a}async function ye(e){const t=e.pythonContextManager.pythonAnalysisSheetId;if(t){let a=!1;return await Excel.run((async n=>{const o=n.workbook.worksheets.getItemOrNullObject(t);o.load("isNullObject"),await n.sync(),e.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit=!o.isNullObject,a=!o.isNullObject})),a}return e.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,!1}async function ve(e){const t=e.pythonContextManager.pythonAnalysisSheetId;if(t){let e=!1;return await Excel.run((async a=>{const n=a.workbook.worksheets.getItemOrNullObject(t);n.load("isNullObject"),await a.sync(),e=!n.isNullObject})),e}return!1}function Te(e,t){const a=Z(l.ExcelCalc.sheetNameFromSheetAddresses(e)),n=l.ExcelCalc.addressToExcelRange(l.ExcelCalc.localAddressesFromSheetAddresses(e));return n.bottomRight.row&&(n.bottomRight.row-=t?1:0),`'${a}'!${l.ExcelCalc.IExcelRangeToAddress(n)}`}async function xe(e,t,a,o,r,i,l){const s=await Ce(l,n.CP),c=new y(e,t,a,o,r,i,l,s);return await c.autoInsertPythonFormula()}function Se(e,t){return"sampleRows"===e||"columnNames"===e||"dataTypes"===e?JSON.stringify(t):t}function we(e,t){(0,o.cY)(o.SA.Verbose,`%cPython Ada ${e}`,`\n      font-size: 1em;\n      padding: 0.5em 2em;\n      margin: 1em 0;\n      color: white;\n      background-color: ${t};\n      border-radius: 10%;\n      `)}function Ee(e){(0,o.cY)(o.SA.Verbose,"Python Ada: "+e)}function Re(e){return JSON.stringify(e,Se,4).replace(/\\n/g,"\n").replace(/\\/g,"").replace(/"\[/g,"[").replace(/\]"/g,"]").replace(/"\{/g,"{").replace(/\}"/g,"}")}function Ie(e){if((0,o.K_)()){we("Context","blue");Ee(Re(e))}}function Ae(e){(0,o.K_)()&&(we("Prompt","blue"),Ee(e||"Prompt is empty."))}function Le(e){if((0,o.K_)()){we("Response Chunks","blue");const t=e.filter((e=>"debugText"!==e.type));0===t.length?Ee("Response Chunks are empty."):t.forEach((e=>{Ee(Re(e))})),we("Debug Chunks","blue");const a=e.filter((e=>"debugText"===e.type));0===t.length?Ee("Debug Chunks are empty."):a.forEach((e=>{Ee(Re(e))}))}}function Fe(e){we("Python Error","red");Ee((0,m.jK)(e))}async function _e(e,t,a){try{t.format.autofitRows(),await e.sync(),t.untrack()}catch(e){const t=(0,m.zj)(r.O.PythonAutofitFailed);(0,m.QX)(a,t,!1)}}function Ne(e,t){return!e.some((e=>e.type===t))}function ke(e){return(0,h.yw)("OfficeVSO_9270732_PythonImageTypes")?e===i.qf.PngImageFile||e===i.qf.ImageFile:e===i.qf.PngImageFile}async function Oe(e,t){try{n.CP.pythonContextManager.alreadyShownTui||await async function(e){await Excel.run({delayForCellEdit:!1},(async t=>{await e(t)}))}((async a=>{Me(a.workbook.worksheets.getItem(e).getRange(t),"ShowPythonAdvancedAnalysisWave1A2")}))}catch(e){(0,m.RA)(e)}}async function Pe(e){try{n.CP.pythonContextManager.alreadyShownTui||(n.CP.pythonContextManager.disableAutoScroll=!0,await OfficeFirstParty.PrivateApi.execute(e),n.CP.pythonContextManager.alreadyShownTui=!0,(0,x.Rj)(e))}catch(e){(0,m.RA)(e)}}function Me(e,t){try{if(!n.CP.pythonContextManager.alreadyShownTui)return n.CP.pythonContextManager.disableAutoScroll=!0,e.showTeachingCallout((0,c.g$5)(),(0,c.Toc)()),n.CP.pythonContextManager.alreadyShownTui=!0,(0,x.Rj)(t),!0}catch(e){return(0,m.RA)(e),!1}return!0}},88179:(e,t,a)=>{a.d(t,{$b:()=>F,BC:()=>R,BJ:()=>L,CD:()=>Y,CT:()=>n,DD:()=>l,Dh:()=>r,EB:()=>T,IC:()=>d,Jr:()=>X,KZ:()=>E,LP:()=>b,Mv:()=>s,OP:()=>o,P1:()=>$,Q6:()=>G,Qf:()=>U,SV:()=>q,Sn:()=>y,W0:()=>v,Y9:()=>I,_4:()=>C,_R:()=>j,a5:()=>u,b6:()=>H,dA:()=>h,eQ:()=>J,gY:()=>B,h3:()=>c,he:()=>S,ib:()=>g,iq:()=>f,j:()=>z,pN:()=>Q,pf:()=>i,q:()=>w,q0:()=>m,uF:()=>A,un:()=>x,xJ:()=>D,xL:()=>p,zq:()=>W});var n,o,r,i,l,s,c,d,u,m,g,h,p,b,f,C,y,v,T,x,S,w,E,R,I,A,L,F,_=a(25549),N=a(31030),k=a(48314),O=a(61150),P=a(50347),M=a(6129);!function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.CheckPoints="CheckPoints",e.UserQueryGuid="UserQueryGuid",e.IsSuccessful="IsSuccessful",e.IsQuerySuccess="IsQuerySuccess",e.OperationName="OperationName",e.Duration="Duration",e.IsFluxEnabled="IsFluxEnabled",e.FeatureName="FeatureName",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.RequestSignalType="RequestSignalType",e.AnnotationType="AnnotationType",e.ChatHistoryLoadTime="ChatHistoryLoadTime",e.ChatPaneLoadTime="ChatPaneLoadTime",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.IsNearestTableEnabled="IsNearestTableEnabled",e.ContentOrigin="ContentOrigin",e.SDXResourcesLoadTime="SDXResourcesLoadTime",e.FirstServiceResponse="FirstServiceResponse",e.UserPerceivedLatency="UserPerceivedLatency",e.IsFromCache="IsFromCache",e.StopGeneratingTime="StopGeneratingTime",e.HandoffMessageResponseTime="HandoffMessageResponseTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.UserCopilotPaneLoadTime="UserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime_PreloadTime="UserCopilotPaneLoadTime_PreloadTime"}(n||(n={})),function(e){e.AugloopInitialization="AugloopInitialization",e.AnnotationActivation="AnnotationActivation",e.ContextTreeBuild="ContextTreeBuild",e.AugloopResponse="AugloopResponse",e.QueryExecution="QueryExecution",e.ImageResponse="ImageResponse",e.AnalyzeData="AnalyzeData",e.InsertAnalyzeData="InsertAnalyzeData",e.Commanding="Commanding",e.CalculatedColumns="CalculatedColumns",e.CalculatedCells="CalculatedCells",e.ChatHistoryHydrateMessages="ChatHistoryHydrateMessages",e.ApplyDataShaping="ApplyDataShaping",e.DataShaping="DataShaping",e.EnterDataShapingMode="EnterDataShapingMode",e.ExitDataShapingMode="ExitDataShapingMode",e.InsertCalculatedColumn="InsertCalculatedColumn",e.InsertCalculatedColumns="InsertCalculatedColumns",e.InsertCalculatedCell="InsertCalculatedCell",e.InsertCalculatedCells="InsertCalculatedCells",e.UpdateCalculatedCell="UpdateCalculatedCell",e.UpdateCalculatedCells="UpdateCalculatedCells",e.InsertSampleData="InsertSampleData",e.InsertTable="InsertTable",e.ActionAI="ActionAI",e.Navigation="Navigation",e.FetchResource="FetchResource",e.OpenSdx="OpenSdx",e.ZeroQueryMessage="ZeroQueryMessage",e.FluxReasoning="FluxReasoning",e.FluxOverall="FluxOverall",e.FluxSkillCardShown="FluxSkillCardShown",e.FluxFirstStreamedToken="FluxFirstStreamedToken",e.FluxGenerateResponse="FluxGenerateResponse",e.FluxSkillStart="FluxSkillStart",e.FluxSkillEnd="FluxSkillEnd",e.LoadLocalizedStrings="LoadLocalizedStrings",e.ScheduleOfficeScriptsHiTLShown="ScheduleOfficeScriptsHiTLShown",e.SaveOfficeScripts="SaveOfficeScripts",e.CreateOfficeScripts="CreateOfficeScripts",e.Python="Python",e.PythonStartAnalysis="PythonStartAnalysis",e.PythonInsertingResultInNewSheet="PythonInsertingResultInNewSheet",e.PythonCalculatedColumn="PythonCalculatedColumn",e.InsertPythonCalculatedColumn="InsertPythonCalculatedColumn",e.ChatResponseFirstChunk="ChatResponseFirstChunk",e.ChatResponseLastChunk="ChatResponseLastChunk",e.FetchCitationFileMetadata="FetchCitationFileMetadata",e.RecognizeTable="RecognizeTable",e.Search="Search",e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.ElseSkillExecuting="ElseSkillExecuting",e.ImportDataGenerateSuggestion="ImportDataGenerateSuggestion",e.ImportDataRelevancyCheck="ImportDataRelevancyCheck",e.ImportDataLoadQuery="ImportDataLoadQuery",e.NoCurrentlyExecutingCommandSet="NoCurrentlyExecutingCommandSet",e.FormulaDescriptionAvailable="FormulaDescriptionAvailable",e.FormulaExplanationAvailable="FormulaExplanationAvailable",e.FormulaPreviewAvailable="FormulaPreviewAvailable",e.FirstChunkFinalResponse="FirstChunkFinalResponse",e.LastChunkFinalResponse="LastChunkFinalResponse",e.ApplyTLRAutoFix="ApplyTLRAutoFix",e.FetchTablesRelevancy="FetchTablesRelevancy"}(o||(o={})),function(e){e.UserQueryGuid="UserQueryGuid",e.EventState="EventState",e.OperationOrder="OperationOrder",e.OperationType="OperationType",e.TimeDurationInMs="TimeDurationInMs",e.OperationParameters="OperationParameters",e.UserQueryOrder="UserQueryOrder",e.StatementNames="StatementNames",e.CurrentStatement="CurrentStatement",e.ExecutableNames="ExecutableNames",e.ExecutableAgent="ExecutableAgent",e.CFRuleType="CFRuleType",e.ColumnCFRApplied="ColumnCFRApplied",e.SortFilterColorFound="SortFilterColorFound",e.SuccessMessageNumParameters="SuccessMessageNumParameters",e.SuccessMessageFormattingParameters="SuccessMessageFormattingParameters",e.UnsupportedConditionalFormatType="UnsupportedConditionalFormatType",e.ConditionalFormatType="ConditionalFormatType",e.FormattingTypes="FormattingTypes",e.EventType="EventType",e.IsFluxEnabled="IsFluxEnabled",e.IsNearestTableEnabled="IsNearestTableEnabled",e.SortRangeAddress="SortRangeAddress",e.SortColumnIndex="SortColumnIndex",e.ErrorMessage="ErrorMessage"}(r||(r={})),function(e){e.RequestId="RequestId",e.Success="Success",e.ExecutionTime="ExecutionTime",e.Error="Error",e.TotalFiles="TotalFiles",e.ResolvedCitations="ResolvedCitations",e.ResolvedValidCitations="ResolvedValidCitations",e.UnresolvedCitations="UnresolvedCitations",e.ResolvedDataSources="ResolvedDataSources",e.ValidDataSources="ValidDataSources"}(i||(i={})),function(e){e.ConvertSucceeded="ConvertSucceeded",e.UnsupportedStatement="UnsupportedStatement",e.VariableCacheFailed="VariableCacheFailed",e.ConverterFailed="ConverterFailed",e.ExecutorSucceeded="ExecutorSucceeded",e.ExecutorFailed="ExecutorFailed",e.ExecutorNoneExecuted="ExecutorNoneExecuted"}(l||(l={})),function(e){e.ConditionalFormatEvent="ConditionalFormatEvent",e.GetFilterOrSortColor="GetFilterOrSortColor",e.LogSuccessMessageFormattingParameters="LogSuccessMessageFormattingParameters",e.LogMissingIntentString="LogMissingIntentString",e.LogUnsupportConditionalFormatType="LogUnsupportedConditionalFormatType",e.LogStatmentInformation="LogStatementInformation",e.LogSortRangeAddress="LogSortRangeAddress"}(s||(s={})),function(e){e.UserQueryGuid="UserQueryGuid",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.UserQueryOrder="UserQueryOrder",e.IsFluxEnabled="IsFluxEnabled",e.IsTLR="IsTLR",e.IsTableContained="IsTableContained",e.isTableIntersected="IsTableIntersected",e.ChatErrorType="ChatErrorType",e.ChatErrorParameters="ChatErrorParameters",e.Cv="Cv",e.IsTable="IsTable",e.IsValidTLR="IsValidTLR",e.UnrecognizedTabularRangeError="UnsupportedTabularRangeError",e.IsChart="IsChart",e.IsPivotTable="IsPivotTable",e.TLRFeatures="TLRFeatures",e.TableLikeEntityDimensions="TableLikeEntityDimensions",e.SelectionError="SelectionError"}(c||(c={})),function(e){e.ErrorCategory="ErrorCategory",e.ErrorMessage="ErrorMessage"}(d||(d={})),function(e){e.ActionConfirmationMessage="Action_Confirmation_Message",e.ConversationMessage="Conversation_Message",e.EnterKeyPressed="Enter_Key_Pressed",e.ErrorMessage="Error_Message",e.HelpMessage="Help_Message",e.HumanInput="Human_Input",e.HumanSuggestionApplied="Human_Suggestion_Applied",e.StopButtonClicked="Stop_Button_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.UserUtteranceSubmitted="User_Utterance_Submitted",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.ZeroQueryMessageSuggestionClicked="ZeroQueryMessage_Suggestion_Clicked",e.SuggestionMessage="Suggestion_Message",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ThumbsUpButtonClicked="Thumbs_Up_Button_Clicked",e.ThumbsDownButtonClicked="Thumbs_Down_Button_Clicked",e.AugLoopSessionClosed="AugLoop_Session_Closed",e.AugLoopSessionModelWorkflowUnsupported="AugLoop_Session_Model_Workflow_Unsupported",e.HowCanCopilotHelpSuggestionClicked="How_Can_Copilot_Help_Suggestion_Clicked",e.AddAllInsightsToGridClicked="Add_All_Insights_To_Grid_Clicked",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignal="Chat_History_Signal",e.ChatHistoryResponse="Chat_History_Response",e.ShowMeAnotherInsightClicked="Show_Me_Another_Insight_Clicked",e.CalculatedColumnsSignalSent="Calculated_Columns_Signal_Sent",e.LanguageNotAvailableMessage="Language_Not_Available_Message",e.BasicChatSuggestionClicked="BasicChat_Suggestion_Clicked",e.ChatHistoryLoaded="Chat_History_Loaded",e.ChatPaneLoaded="Chat_Pane_Loaded",e.SharedCopilotChatLogEvent="Shared_Copilot_Chat_Log_Event",e.CopyButtonClicked="Copy_Button_Clicked",e.CalculatedColumnsExplainButtonClicked="Calculated_Columns_Explain_Button_Clicked",e.PythonCalculatedColumnsExplainButtonClicked="Python_Calculated_Columns_Explain_Button_Clicked",e.LargeDataErrorMessage="Large_Data_Error_Message",e.ChangeTopicButtonClicked="Change_Topic_Button_Clicked",e.SaveScriptClicked="Save_Script_Clicked",e.DeleteScriptClicked="Delete_Script_Clicked",e.OfficeScriptsLinkClicked="Office_Scripts_Link_Clicked",e.DocumentClpUpgrade="DocumentClpUpgrade",e.ClpLabelUpdateFromChatHistory="ClpLabelUpdateFromChatHistory",e.ResponseStreamFinished="Response_Stream_Finished",e.InsertingTablesFromResponse="Inserting_Tables_From_Response",e.InsertingListsFromResponse="Inserting_Lists_From_Response",e.FormulaPreviewButtonAllowed="Formula_Preview_Button_Allowed",e.FormulaPreviewButtonDisabled="Formula_Preview_Button_Disabled",e.FormulaPreviewButtonVisible="Formula_Preview_Button_Visible",e.FormulaPreviewButtonClickShow="Formula_Preview_Button_Click_Show",e.FormulaPreviewButtonClickHide="Formula_Preview_Button_Click_Hide",e.PromptAuthPopup="Prompt_Auth_Popup",e.ChatHistoryImageResendEvent="Chat_History_Image_Resend_Event",e.SelfHelpContentShown="SelfHelp_Content_Shown",e.SelfHelpActionClicked="SelfHelp_Action_Clicked",e.CalculatedFormulaGetFormula="Calculated_Formula_Get_Formula",e.CalculatedFormulaGetDescription="Calculated_Formula_Get_Description",e.CalculatedFormulaGetExplanation="Calculated_Formula_Get_Explanation",e.CalculatedRowsSuggestionsReceived="Calculated_Rows_Suggestions_Received",e.FormulaSuggestionDedupedContextTables="Formula_Suggestion_Deduped_Context_Tables",e.FormulaSuggestionInvalidated="Formula_Suggestion_Invalidated",e.FormulaSuggestionTrackedForInvalidation="Formula_Suggestion_Tracked_For_Invalidation",e.FormulaSuggestionInsertColumnTimings="Formula_Suggestion_Insert_Column_Timings",e.FormulaSuggestionInsertRowTimings="Formula_Suggestion_Insert_Row_Timings",e.FormulaSuggestionInvalidationTrackingData="Formula_Suggestion_Invalidation_Tracking_Data",e.ScheduleScriptClicked="Schedule_Script_Clicked",e.FlowCreatedConfirmation="Flow_Created_Confirmation",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ALUserType="AL_User_Type",e.GroundingSourceUpdated="Grounding_Source_Updated",e.HumanInTheLoopMessage="Human_In_The_Loop_Message",e.EmptyMessageReceivedFromSydney="Empty_Message_Received_From_Sydney",e.SelectTableCard="Select_Table_Card",e.ImportDataCard="Import_Data_Card",e.ImportDataShowCard="Import_Data_Show_Card",e.ImportDataLoadQuery="Import_Data_Load_Query",e.ImportDataExplainButtonClicked="Import_Data_Explain_Button_Clicked",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.CopilotEnabledAfterAutoSave="Copilot_Enabled_After_AutoSave",e.ShowDisabledScreen="Show_Disabled_Screen",e.PythonPostView="Python_PostView",e.SkillOverride="Skill_Override",e.HandoffMessageIdResponseError="Handoff_MessageIdResponse_Error",e.HandoffMessageIdGetOperationSubmitted="Handoff_Message_Id_Get_Operation_Submitted",e.HandoffMessageIdProcessedOperationSubmitted="Handoff_Message_Id_Processed_Operation_Submitted",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffQuerySubmittedByUser="Handoff_Query_Submitted_By_User",e.AnalyzeDataEmptyAnswer="Analyze_Data_Empty_Answer",e.CSHScenarioRun="CSH_Scenario_Run",e.ContextManagerInitialized="Context_Manager_Initialized",e.DefaultInsertCalculatedColumnFailed="DefaultInsertCalculatedColumnFailed",e.CalculatedColumnExpandFailedNotEmptyColumn="CalculatedColumnExpandFailedNotEmptyColumn",e.CalculatedColumnExpandFailed="CalculatedColumnExpandFailed",e.CalculatedCellExpandFailedNotEmptyCell="CalculatedCellExpandFailedNotEmptyCell",e.CalculatedCellExpandFailed="CalculatedCellExpandFailed",e.CalculatedColumnPartialInsertFailed="CalculatedColumnPartialInsertFailed",e.TabularRangeAutoFixFailed="TabularRangeAutoFixFailed",e.TabularRangeNoAutoFixApplied="TabularRangeNoAutoFixApplied",e.PythonCodeAndPostViewCardShown="PythonCodeAndPostViewCardShown",e.PythonCodeAndPostViewCardUpdatedWithResult="PythonCodeAndPostViewCardUpdatedWithResult",e.PythonCodeAndPostViewCardUpdatedWithError="PythonCodeAndPostViewCardUpdatedWithError",e.PythonResultsAddedToNewSheetSuccess="PythonResultsAddedToNewSheetSuccess",e.PythonResultsAddedToNewSheetError="PythonResultsAddedToNewSheetError",e.TriggerImageChatOperation="Trigger_Image_Chat_Operation",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.PreloadCopilot="PreloadCopilot"}(u||(u={})),function(e){e.AgentTimeout="Agent_Timeout",e.AugloopTimeout="Augloop_Timeout",e.BadToken="Bad_Token",e.ClientError="Client_Error",e.DashboardInsertFailed="Dashboard_Insert_Failed",e.DetectedJunkQuery="Junk_Query",e.DetectedMultipleIntents="Multiple_Intents_Detected",e.DetectedOffensiveContent="Offensive_Content",e.DetectedOutOfScope="Out_Of_Scope",e.DetectedOutOfScopeShort="Out_Of_Scope_Short",e.DetectedTooShort="Too_Short",e.DetectedUnsupportedLanguage="Unsupported_Language",e.NoTableLikeEntityFound="No_TableLikeEntity_Found",e.UnsupportedTabularRange="Unsupported_Tabular_Range",e.LicensingError="Licensing_Error",e.PlatformError="Platform_Error",e.NetworkError="Network_Error",e.NoSuggestions="No_Suggestions",e.NotSingleColumn="Not_Single_Column",e.UserThrottled="User_Throttled",e.RaiError="RAI_Error",e.LLMServiceError="LLM_Service_Error",e.IrrelevantQuery="Irrelevant_Query",e.OdslExecutionFailed="Odsl_Execution_Failed",e.OfficeJsExecutionFailed="OfficeJs_Execution_Failed",e.OrchestratorDisengaged="OrchestratorDisengaged",e.RequestTooLong="Request_Too_Long",e.ServiceError="Service_Error",e.TokenCount="Token_Count",e.UnsupportedCommand="UnsupportedCommand",e.CommandingSmartHelp="CommandingSmartHelp",e.OfficeScriptExecutionFailed="OfficeScript_Execution_Failed",e.LargeData="Large_Data",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.ChatHistoryImageResendFailed="Chat_History_Image_Resend_Failed",e.PythonCalculatedColumnsError="Python_Calculated_Columns_Error",e.PythonError="Python_Error",e.UnsupportedObjectDetected="Unsupported_Object_Detected",e.TlrAutofixError="Tlr_Autofix_Error",e.OutOfCreditsError="Out_Of_Credits_Error",e.TLRAutofixSuggestion="Tlr_Autofix_Suggestion"}(m||(m={})),function(e){e.ErrorMessage="ErrorMessage",e.OperationType="OperationType",e.RequestId="RequestId",e.ErrorType="ErrorType",e.LogLevel="LogLevel"}(g||(g={})),function(e){e.ErrorMessage="ErrorMesasge",e.LogLevel="LogLevel",e.TimeOut="TimeOut",e.Id="Id"}(h||(h={})),function(e){e.LogLevel="LogLevel",e.ErrorMessage="ErrorMessage",e.NumOfColumnHidden="NumOfColumnHidden"}(p||(p={})),function(e){e.FailedEventMethods="Executor_FailedMethods",e.Agent="Executor_ExecutableAgent"}(b||(b={})),function(e){e.Reason="Reason",e.CurrentStatement="CurrentStatement",e.ArgumentNames="ArgumentNames",e.UnsupportedArgumentTypes="UnsupportedArgumentTypes"}(f||(f={})),function(e){e.Reason="Reason",e.ArgumentType="ArgumentType",e.ExpectedType="ExpectedType"}(C||(C={})),function(e){e.ODSLProperty="ODSLProperty"}(y||(y={})),function(e){e.CorrelationId="CorrelationId",e.EventType="EventType",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.RecommendationId="RecommendationId",e.IsNLAnswer="IsNLAnswer",e.EvaluateQueryCorrelationId="EvaluateQueryCorrelationId",e.CellCount="CellCount",e.NumRows="NumRows",e.NumColumns="NumColumns",e.SelectionModification="SelectionModification",e.SelectionExpanded="SelectionExpanded",e.IsSmallSelection="IsSmallSelection",e.IsTable="IsTable",e.IsPivotTable="IsPivotTable",e.HasTableHeaders="HasTableHeaders",e.AreaCount="AreaCount",e.HasInvalidValues="HasInvalidValues",e.RecommendationIndex="RecommendationIndex",e.RecommendationType="RecommendationType",e.IsSuccessful="IsSuccessful",e.TransformedDataType="TransformedDataType",e.IsNLDiscoverInsights="IsNLDiscoverInsights",e.IsPivotTableSource="isPivotTableSource",e.Destination="Destination",e.Method="Method",e.Api="Api",e.ResponseCode="ResponseCode",e.RetryCount="RetryCount",e.RecommendationsCount="RecommendationsCount",e.InitialRenderedRecoCount="InitialRenderedRecoCount",e.NoHeadersCount="NoHeadersCount",e.TransposeCount="TransposeCount",e.BlankOrDuplicateCount="BlankOrDuplicateCount",e.HierarchicalHeaderCount="HierarchicalHeaderCount",e.DataTransformCount="DataTransformCount",e.RecommendationsFilteredCount="RecommendationsFilteredCount",e.TransposeMalformedCount="TransposeMalformedCount",e.TransposeWithNoHeaderCount="TransposeWithNoHeaderCount",e.TransposeWithHierarchicalHeaderCount="TransposeWithHierarchicalHeaderCount",e.Status="Status",e.Source="Source",e.IsLive="IsLive",e.ResponseType="ResponseType",e.TotalTokenCount="TotalTokenCount",e.NoneTokenCount="NoneTokenCount",e.PlainTextTokenCount="PlainTextTokenCount",e.UnrecognizedTokenCount="UnrecognizedTokenCount",e.ColumnTokenCount="ColumnTokenCount",e.ValueTokenCount="ValueTokenCount",e.VisualTypeTokenCount="VisualTypeTokenCount",e.ForceStaticAnswer="ForceStaticAnswer",e.IsEmpty="IsEmpty",e.ShowDiscoverInsights="ShowDiscoverInsights",e.ShowSuggestions="ShowSuggestions",e.Count="Count",e.ServiceTime="ServiceTime",e.IsValueChange="IsValueChange",e.IsValueTypeChange="IsValueTypeChange",e.ChangeType="ChangeType",e.ChangeSource="ChangeSource",e.GeometryRelationship="GeometryRelationship",e.VerticalPosition="VerticalPosition",e.HorizontalPosition="HorizontalPosition",e.IsRefreshSucceed="IsRefreshSucceed",e.HasBeenInCellEditMode="HasBeenInCellEditMode",e.RangeId="RangeId",e.OperationId="OperationId",e.CompressionMethod="CompressionMethod",e.CompressionTime="CompressionTime",e.SerializationTime="SerializationTime",e.OperationStatus="OperationStatus",e.RequestSize="RequestSize",e.FailureReason="FailureReason",e.FailureLocation="FailureLocation",e.RecommendationData="RecommendationData",e.Duration="Duration",e.NumChunks="NumChunks",e.NumSyncs="NumSyncs",e.MinRowsInChunk="MinRowsInChunk",e.Type="Type",e.NLContextId="NLContextId",e.AllowRewrite="AllowRewrite",e.IsAnnaParserFallback="IsAnnaParserFallback",e.TraceId="TraceId",e.SpanId="SpanId",e.VisualType="VisualType",e.ReasonForError="ReasonForError",e.IsInvalidInsightsSession="IsInvalidInsightsSession",e.InvalidInsightsSessionSource="invalidInsightsSessionSource",e.QueryType="QueryType",e.RowOffset="RowOffset",e.Height="Height",e.Width="Width"}(v||(v={})),function(e){e.CorrelationId="CorrelationId",e.Duration="Duration",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.RequestId="RequestId",e.SuggestionId="SuggestionId",e.Type="Type"}(T||(T={})),function(e){e.CorrelationId="CorrelationId",e.ErrorCode="ErrorCode",e.ErrorLocation="ErrorLocation",e.EvaluateQueryCorrelationId="EvaluateQueryCorrelationId",e.ErrorType="EventType",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.Message="Message",e.Name="Name",e.OfficeErrorCode="OfficeErrorCode",e.Reason="Reason",e.RecommendationId="RecommendationId",e.Source="Source",e.Stack="Stack",e.InnerError="InnerError",e.SuggestionID="SuggestionID"}(x||(x={})),function(e){e.NoResult="NoResult",e.SuggestionApplied="SuggestionApplied",e.SuggestionShown="SuggestionShown",e.Undo="Undo",e.Deleted="Deleted",e.GroundPickerSelected_DocMode="GroundPickerSelected_DocMode",e.GroundPickerSelected_EnterpriseMode="GroundPickerSelected_EnterpriseMode",e.InsertTableShowed="InsertTableShowed",e.InsertTableClicked="InsertTableClicked",e.InsertTableSuccess="InsertTableSuccess",e.InsertListShowed="InsertListShowed",e.InsertListClicked="InsertListClicked",e.InsertListSuccess="InsertListSuccess",e.CopyMessageClicked="CopyMessageClicked",e.ImportDataButtonShowed="ImportDataButtonShowed",e.ImportDataButtonClicked="ImportDataButtonClicked",e.ViewScript="ViewScriptClicked",e.SaveScript="SaveScriptClicked",e.DeleteScript="DeleteScriptClicked",e.FormulaCopyClicked="FormulaCopyClicked",e.OfficeScriptsFolderClicked="OfficeScriptsFolderClicked",e.ScheduleScriptClicked="ScheduleScriptClicked",e.Apply="Apply",e.ConditionalFormattingSuggestionPillClicked="ConditionalFormattingSuggestionPillClicked",e.ElseFallback="ElseFallback",e.TeachingCalloutShown="TeachingCalloutShown"}(S||(S={})),function(e){e.AnalyzeData="AnalyzeData",e.CalculatedColumns="CalculatedColumns",e.PythonCalculatedColumns="PythonCalculatedColumns",e.ChatPaneLoad="ChatPaneLoad",e.Commanding="Commanding",e.ConditionalFormattingSuggestion="ConditionalFormattingSuggestion",e.ConvertToTable="ConvertToTable",e.CopilotChat="CopilotChat",e.CopyMessage="CopyMessage",e.DataShaping="DataShaping",e.Else="Else",e.ExternalTriggeredQuery="ExternalTriggeredQuery",e.ImportDataFromSearch="ImportDataFromSearch",e.ImportDataSkill="ImportDataSkill",e.InsertTable="InsertTable",e.InsertList="InsertList",e.OfficeJsCommanding="OfficeJsCommanding",e.OfficeScripts="OfficeScripts",e.Python="Python",e.SampleData="SampleData",e.Search="Search",e.SelfHelp="Self-Help Search",e.ShowHeaders="ShowHeaders",e.SmartHelp="SmartHelp",e.UndoMessage="UndoMessage",e.HandOff="Hand-Off",e.ContextInference="ContextInference",e.CalculatedRows="CalculatedRows",e.Unset=""}(w||(w={})),function(e){e.AddButton="AddButton",e.DashboardSuggestionPill="DashboardSuggestionPill",e.GridAction="GridAction",e.InsightsApi="InsightsApi",e.UndoButton="UndoButton",e.NLChatRequest="NLChatRequest",e.FormulaGenerationSuggestionPill="FormulaGenerationSuggestionPill",e.SubmitPythonStartAnalysisQuery="SubmitPythonStartAnalysisQuery",e.SubmitPythonAdaQuery="SubmitPythonAdaQuery",e.InsertPythonCodeButton="InsertPythonCodeButton",e.PythonAdaCodeInserted="PythonAdaCodeInserted",e.CopyPythonCodeButton="CopyPythonCodeButton",e.ViewScriptButton="ViewScriptButon",e.SaveScriptButton="SaveScriptButton",e.DeleteScriptButton="DeleteScriptButton",e.CopyFormulaButton="CopyFormulaButton",e.ScheduleScriptButton="ScheduleScriptButton",e.ApplyButton="ApplyButton",e.ConditionalFormattingSuggestionPill="ConditionalFormattingSuggestionPill"}(E||(E={})),function(e){e.Default="Default",e.SuggestionPill="SuggestionPill",e.ZQM="ZQM",e.ExternalQuery="ExternalQuery",e.MenuItem="MenuItem",e.InternalTool="InternalTool"}(R||(R={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(I||(I={})),function(e){e.Analyze="Analyze",e.Ask="Ask",e.Command="Command",e.Create="Create",e.Share="Share",e.Summarize="Summarize",e.UnknownIntent="UnknownIntent"}(A||(A={})),function(e){e.AnalyzeData="AnalyzeData",e.FormulaGeneration="FormulaGeneration",e.ChatPaneLoad="ChatPaneLoad",e.Preload_ChatPaneLoad="Preload_ChatPaneLoad",e.ChatQnA="Chat QnA",e.Commanding="Commanding",e.ImportData="ImportData",e.CopilotChat="CopilotChat",e.OfficeScripts="OfficeScripts",e.ExcelChatHelper="ExcelChatHelper",e.Python="Python",e.Search="Search",e.Handoff="Handoff",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.Unset=""}(L||(L={})),function(e){e[e.Warning=400]="Warning",e[e.ASHA=450]="ASHA",e[e.Error=500]="Error",e[e.Critical=600]="Critical"}(F||(F={}));const D=e=>(new Date).getTime()-e,$=(e,t)=>({eventType:e,eventData:Object.keys(t).map((e=>({key:e,value:t[e]})))}),B=e=>(e.UserQueryGuid=k.M.userQueryGuid,e.UserQueryOrder=k.M.userQueryOrder,e.IsNearestTableEnabled=(0,P.qm)(),{eventType:N.S.OfficeJsOperations,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}),H=()=>{const e={};return Object.keys(r).forEach((t=>{e[t]=""})),e};function U({actionType:e,featureName:t,source:a,suggestionId:n,userQueryGuid:o}){return q(e,t,a,n,o)}const q=(e,t,a,n,o)=>{const r=[{key:"ActionType",value:e},{key:"FeatureName",value:t??"Commanding"}];return a&&r.push({key:"Source",value:a}),n&&r.push({key:"SuggestionId",value:n}),o&&r.push({key:"UserQueryGuid",value:o}),{eventType:N.S.Usage,eventData:r}};var V;!function(e){e.CreatePresentation="Create Presentation",e.AddContent="Add Content",e.Organize="Organize",e.BasicCommand="Basic Command",e.Summarize="Summarize",e.DocumentQnA="Document QnA",e.ChatQnA="Chat QnA",e.Unset="",e.CopilotChat="Copilot Chat"}(V||(V={}));const G=()=>{if((0,P.vI)()){let e="Workbook";return(0,M.pX)()&&(e+="+Work"),(0,M.gc)()&&(e+="+Web"),e}return(0,M.pX)()?"Enterprise":"Workbook"},W=e=>{let t={};try{t=JSON.parse(e)}catch(e){(0,O.cY)("Error parsing telemetry data ",e.message)}return t},z=e=>{const t=e.getActiveTable(),a=t?.tableLikeRange?"true":"false",n=t?.tableLikeRange&&!t?.tableLikeRangeFeatures?"true":"false",o=t&&!t.tableLikeRange?"true":"false",r=t?.tableContained?"true":"false",i=t?.tableIntersected?"true":"false",l=e?.activeChart?"true":"false",s=e?.activePivotTable?"true":"false",c=`${t?.tableLikeRangeFeatures??0}`,d=(0,P.yw)("OfficeVSO_9432343_LogTableLikeEntityDimensions")?(e=>{if(!e)return"";const t=e.sheetRange.range;return null===t.bottomRight.row||null===t.topLeft.row||null===t.bottomRight.column||null===t.topLeft.column?"":`${t.bottomRight.row-t.topLeft.row+1}x${t.bottomRight.column-t.topLeft.column+1}`})(t):"";return{IsTLR:a,IsValidTLR:n,IsTable:o,IsTableContained:r,IsTableIntersected:i,IsChart:l,IsPivotTable:s,TLRFeatures:c,TableLikeEntityDimensions:d,SelectionError:(0,P.yw)("OfficeVSO_9436030_LogSelectionError")&&e.selectionError?e.selectionError:""}},Q=e=>Object.keys(e).map((t=>({key:t,value:e[t]}))),J=e=>{let t;if(!e)return t;switch(e){case _.w.ElseSkillName:t="ExcelChatHelper";break;case _.w.GetInsightsName:t="AnalyzeData";break;case _.w.SelfHelpSkillName:t="Search";break;case _.w.CalculatedColumnsName:case _.w.CreateCalculatedColumnsName:t="FormulaGeneration";break;case _.w.EditDocumentName:t="Commanding";break;case _.w.SearchEnterpriseName:case _.w.SearchToolsRequestInterstitialsPublisher:case _.w.SearchToolsResponseInterstitials:t="Search";break;case _.w.OfficeScriptsName:t="OfficeScripts";break;case _.w.PythonSkillName:case _.w.PythonCalculatedColumnsName:t="Python";break;case _.w.GenerateResponseName:t="CopilotChat";break;case _.w.AugLoopEvalName:case _.w.AugLoopName:case _.w.GetContextName:case _.w.DeepLeo:case _.w.Workflow:break;default:k.M.getInstance().logError({eventType:N.S.AssertionFailed,errorMessage:`AugLoop returned an unexpected skill: ${e}`,logLevel:500})}return t};var j,Y;function X(e){if((0,P.yw)("OfficeVSO_9389407_fixErrorLoggingV2"))return"string"==typeof e?new Error(e):e}!function(e){e.HandoffStart="Handoff_Start",e.AppStart="App_Start",e.CopilotPaneStart="Copilot_Pane_Start",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.ChatPaneLoaded="Chat_Pane_Loaded",e.HandoffMessageIdSent="Handoff_Message_Id_Sent",e.HandoffMessageIdProcessed="Handoff_Message_Id_Processed",e.HandoffMessageReceived="Handoff_Message_Received",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted"}(j||(j={})),function(e){e.PromptType="promptType",e.SourceApp="sourceApp",e.IsModified="isModified",e.ScenarioName="scenarioName"}(Y||(Y={}))},89099:(e,t,a)=>{var n;a.d(t,{c:()=>n}),function(e){e.AE_Execution_Unsupported="AE execution unsupported",e.Analyze_Data_AugLoop_Timeout="Analyze Data AugLoop timeout",e.Analyze_Data_Insights_Services_Error="Analyze Data Insights Services error",e.Analyze_Data_Insights_Services_Timeout="Analyze Data Insights Services timeout",e.Analyze_Data_Network_Error="Analyze Data network error",e.Analyze_Data_Other_Error="Analyze Data other error",e.Analyze_Data_Get_Insights_Client_Error="Analyze Data get insights client error",e.Analyze_Data_Evaluate_Query_Client_Error="Analyze Data evaluate query client error",e.Analyze_Data_Text_Analysis_Unsupported_Language="Analyze Data text analysis unsupported language",e.Analyze_Data_LLM_Timeout="Analyze Data LLM timeout",e.Analyze_Data_Undo_Failed="Analyze Data undo failed",e.Apply_Table_Creation_Failed_Due_To_Issue_With_Location="Apply table creation failed due to issue with location",e.Augloop_Response_Timed_Out="Augloop Response Timed Out",e.Augloop_Failed_Input_Error="AugLoop failedÂ due to AugLoop input error",e.Augloop_Failed_Entitlement_Validation="AugLoop failed to validate the user's Copilot entitlement",e.Augloop_Failed_Token_Validation="AugLoop failed to validate the Copilot user token",e.Augloop_Error="Unclassified AugLoop error",e.Calculate_Preview_Timeout="Calculate preview timeout",e.Calculate_Suggestion_Timeout="Calculate suggestion timeout",e.Calculated_Column_Out_Of_Scope_Scenarios="Calculated column out of scope scenarios",e.Chat_Error_Message_Shown="Chat error message shown (catch-all, may overlap with other errors)",e.Chat_History_Response_Timed_Out="Chat history response timed out",e.Chat_User_Thumbs_Down="Chat user thumbs down",e.Client_Program_Response_Error="Client program response error",e.Command_Execution_Blocked_By_Capacity="Command execution blocked by capacity",e.Command_Execution_Happened_With_No_Confirmation_Of_Action="Command execution happened with no confirmation of action",e.Command_Execution_Took_Too_Long="Command execution took too long",e.Command_Execution_Undo_Failed="Command execution undo failed",e.Conditional_Formatting_Failed_Due_To_Out_Of_Scope_Prompt="Conditional Formatting failed due to out of scope prompt",e.Conditional_Formatting_Failed_Due_To_Invalid_Formula="Conditional Formatting failed due to invalid formula",e.Conditional_Formatting_Failed_Due_To_Invalid_Formula_Explanation="Conditional Formatting failed due to invalid formula explanation",e.Conditional_Formatting_Failed_Due_To_Invalid_Targets="Conditional Formatting failed due to invalid targets",e.Conditional_Formatting_No_Suggestions_Error="Conditional Formatting no suggestions error",e.Conditional_Formatting_Suggestions_Error="Conditional Formatting suggestions error",e.Conditional_Formatting_Suggestions_Error_Due_To_No_Table_Selected="Conditional Formatting suggestions error due to no table selected",e.Context_Extraction_Error="Context extraction error",e.Disengaged_Error="AugLoop failedÂ due to Sydney disengage",e.Else_Response_Blocked_Bad_Formula="Response blocked due to invalid formula",e.Else_Response_Blocked_Unsupported_Chaining="Response blocked due to unsupported chaining",e.Else_Service_Timed_Out="Service timed out",e.Else_Service_Error="Service error",e.Else_User_Stopped_Execution="User stopped execution or closed pane",e.Else_User_Thumbs_Down="User dissatisfied with the suggestion",e.Failed_Column_Insertion="Failed column insertion",e.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range="Failed column insertion due to conflict in the target range",e.Failed_Column_Insertion_Due_To_Protection_Settings="Failed column insertion due to protection settings",e.Failed_Column_Insertion_Due_To_Target_Table_Error="Failed column insertion due to target table error",e.Failed_Column_Suggestion_Generation_For_Suggestion_Pill="Failed column suggestion generation for suggestion pill",e.Failed_Column_Suggestion_Generation_For_User_Prompt="Failed column suggestion generation for user prompt",e.Failed_Command_Execution_Due_To_Other_Error="Failed command execution due to other error",e.Failed_Command_Execution_Due_To_Protection_Settings="Failed command execution due to protection settings",e.Failed_Due_To_Skill_Failure="Failed due to Service Error (Skill failure)",e.Failed_During_Prompt_Construction_Or_Postprocessing="Failed during prompt construction or postprocessing",e.Failed_Parse_ODSL="Failed to parse generated ODSL",e.Failed_Parse_ODSL_Zero="Failed to parse generated ODSL (no ODSL present)",e.Failed_Parse_ODSL_Date_Logic="Failed to parse generated ODSL (unsupported date logic)",e.Failed_Parse_ODSL_No_Op="Failed to parse generated ODSL (no program effect)",e.Failed_Insight_Generation_Due_To_No_Patterns_In_Data="Failed insight generation due to no patterns in data",e.Failed_Insight_Generation_Due_To_No_Requested_Data_In_The_Source_Data="Failed insight generation due to no requested data in the source data",e.Failed_Insight_Generation_Due_To_Not_Enough_Info="Failed insight generation due to not enough info",e.Failed_Insight_Generation_Due_To_Other_Error="Failed insight generation due to other error",e.Failed_Insight_Generation_Due_To_Out_Of_Scope_Error="Failed insight generation due to out of scope error",e.Failed_Insight_Generation_Due_To_Too_Large_Data="Failed insight generation due to too large data",e.Failed_Insight_Insertion="Failed insight insertion",e.Failed_Insight_Insertion_Due_To_Protection_Settings="Failed insight insertion due to protection settings",e.Failed_Insight_Insertion_Due_To_User_Edits="Failed insight insertion due to user edits",e.Failed_To_Copy_Code="Failed to copy code",e.Failed_To_Copy_Response="Failed to copy chat response",e.Failed_To_Insert_Table="Failed to insert table from chat response",e.Features_In_Development="Features in development or under flight",e.Formula_Description_Failed_To_Display="Formula description failed to display",e.Formula_Explanation_Failed_To_Display="Formula explanation failed to display",e.Formula_Generation_Columns_Letters_Mismatch_Between_Title_And_Preview="Columns letters mismatch between title and preview",e.Formula_Generation_Failed_To_Send_Signal="Failed to send formula generation signal",e.Formula_Generation_Unsupported_Multiple_Columns="Unsupported multiple columns generation",e.Formula_Generation_Unsupported_Multiple_Rows="Unsupported multiple rows generation",e.Generated_Output_Error="OffensiveÂ contentÂ detectedÂ inÂ generatedÂ output",e.InferenceAPI="Inference API",e.InferenceAPI_Not_Available="Inference API not available",e.InferenceAPI_Timeout="Inference API timeout",e.Input_Blocked_Guardlist="Input blocked by dynamic guard list so no response",e.Input_Blocked_Prompt_Injection="Input blocked due to prompt injection so no response",e.Input_Failed_Due_To_Augloop_Session_Close="Input failed due to Augloop session close",e.Input_Failed_Due_To_Memory="Input failed due to memory",e.Input_Language_Unsupported="Input language unsupported",e.Insights_Visual_Converter_Unsupported="Insights visual converter unsupported",e.Invalid_AE_Generated="Invalid AE response was generated by LLM",e.Invalid_Column_Name="Invalid column name was generated by LLM",e.Invalid_Json_Format="Invalid Json format was generated by LLM",e.Invalid_ODSL_Generated="Invalid ODSL was generated",e.Invalid_Response_Type="Invalid response type was generated by LLM",e.Invalid_Text_Analysis_Response="Invalid text analysis response was generated by LLM",e.Input_Resulted_In_Unsupported_Command="Input resulted in unsupported command",e.Input_Was_Offensive_So_No_Response="Input was offensive so no response",e.Inserting_Column_Took_Too_Long_Time="Inserting column took too long time",e.Input_Exceeded_Max_Length="Input exceeded max length",e.Input_Too_Long="Input Query is too long, or has too many tokens",e.Input_Too_Short="Input too short",e.Input_Query_Error="ErrorÂ occurredÂ becauseÂ inputÂ queryÂ isÂ offensive",e.Input_Query_Error_Invalid="The program/app name cannot be determined because the input is invalid",e.Input_Query_Error_Out_Of_Scope="The intent for the input cannot be determined because the input is out of scope",e.Import_Data_Card_Rendering_Error="Error occurred while trying to render the import card",e.Import_Data_File_Fetching_Error="Error occurred while trying to fetch file metadata",e.Import_Data_File_Fetching_Timeout="Timeout occurred while trying to fetch file metadata",e.Import_Data_Relevancy_Error="Error occurred while trying to run relevancy signal",e.Import_Data_Relevancy_Timeout="Timeout occurred while trying to run relevancy signal",e.Import_Data_Load_Query_Error="Error occurred while trying load query from import data",e.Import_Data_RAI_Error="RAI error during import data",e.Import_Data_General_Error="General error on import data",e.LLM_HTTP_Request_Error="LLM HTTP request error",e.LLM_Identifies_UnanswerableQuery="LLM identifies the query is unanswerable",e.LLM_Thinks_Ambiguous="LLM thinks the query is too ambiguous",e.LLM_Throttled="LLM throttled",e.LLM_Service_Error="LLM service error",e.Mismatch_Between_Preview_And_Grid_Values="Mismatch between preview and grid values",e.Missing_HITL_Intent_String="Missing human in the loop intent string",e.Multiple_Intents_Detected="Orchestration failed due to multiple intents",e.ODSL_Execution_Failed_Due_To_Converter_Error="ODSL execution failed due to a converter error",e.ODSL_Execution_Failed_Due_To_Invalid_Targets="ODSL execution failed due to invalid targets",e.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt="ODSL execution failed due to out of scope prompt",e.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets="ODSL execution failed due to out of scope targets",e.ODSL_Execution_Failed_Due_To_Payload_Too_Large="ODSL execution failed due to payload too large",e.ODSL_Execution_Failed_Due_To_Entity_Type_Mismatch="ODSL execution failed due to entity type mismatch",e.ODSL_Execution_Failed_Due_To_Unsupported_Commands="ODSL execution failed due to unsupported commands",e.ODSL_Execution_Failed_General_Error="ODSL execution failed general error",e.ODSL_Execution_Failed_With_Multiple_Events="ODSL execution failed with multiple events",e.Orchestration_Failed_Sydney="Orchestration failedÂ due to Service Error (Sydney)",e.Orchestration_Failed_When_Calling_OfficeJS_Sensitivity_API="Orchestration failed when calling OfficeJS sensitivity API",e.Orchestration_Failed_When_Could_Not_Fetch_Sensitivity_Label="Orchestration failed when could not fetch sensitivity label",e.Organization_Policy_Does_Not_Allow_This_Type_Of_Content="Organization policy does not allow this type of content",e.Other_Input_Attack_Detected="Other input attack detected",e.Out_Of_Credits="Customer has no remaining Copilot credits",e.Output_Blocked_By_Guard_List="Output blocked by guard list",e.Output_Deemed_Offensive="Output deemed offensive",e.Pane_Crashed="Pane crashed",e.Pane_Failed_To_Hydrate_Previous_Chat_History="Pane failed to hydrate previous chat history",e.Pane_Taking_Too_Long_To_Load="Pane taking too long to load",e.Pane_Taking_Too_Long_To_Load_After_Disabled_Screen="Pane taking too long to load after disabled screen",e.Preview_On_Card_Failed_To_Display="Preview on card failed to display",e.Preview_On_Grid_Failed_To_Display="Preview on grid failed to display",e.Prompt_Injection_Detected="Prompt injection detected",e.Pre_Python_Mode_Error="Pre Python mode error",e.Python_Add_Results_To_New_Sheet="Adding results to new sheet failed",e.Python_Analysis_Sheet_Deleted="Python analysis sheet deleted",e.Python_AugLoop_Calls_Per_Query_Maximum_Hit="Python AugLoop calls per query maximum hit",e.Python_Bad_Object_Reference="Python Bad Object Reference",e.Python_Cell_Edit_Mode="Python Cell Edit Mode",e.Python_Code_Retry_Maximum_Hit="Python code retry maximum hit",e.Python_Code_And_PostView_Props_Not_Serializable="Python code and PostView card props not serializable.",e.Python_Exit_Analysis="Python failed to exit analysis",e.Python_Failed_To_Insert_Code="Python failed to insert code",e.Python_Failed_To_Get_Diagnostics="Python failed to get diagnostics object",e.Python_General_Grid_Error="Python general grid error",e.Python_Missing_Or_Invalid_Response="Python missing or invalid response",e.Python_Payload_Empty="Python payload empty",e.Python_PostView_Failed="Python inserting PostView failed",e.Python_Runtime_Busy="Python runtime busy",e.Python_Runtime_In_Bad_State="Python runtime in bad state",e.Python_Teaching_Callout_Not_Shown="Python teaching callout not shown",e.Python_Unknown_Error="Python unknown error",e.Python_User_Thumbs_Down="Python user thumbs down",e.RAI_Validation_Failed="RAI Validation failed",e.Requested_Visual_Type_Unsupported="Requested visual type unsupported",e.Scenario_Throttled="Scenario has issued too many requests",e.Search_Sensitivity_API_Error="Search sensitivity API error",e.Search_User_Thumbs_Down="Search user thumbs down",e.Service_Error_Augloop="Service error (AugLoop)",e.Service_Error_Unknown_Error="Service Error (unknown error)",e.Service_Timeout="Service timed out waiting on the client",e.Suggestion_Blocked_Due_To_Code_Generated_Being_Protected_By_Copyright_Licensing="Suggestion blocked due to code generated being protected by copyright/licensing",e.Suggestion_Blocked_Due_To_RAI="Suggestion blocked due to RAI",e.Sydney_Bad_Converstaion_Id="Sydney failed due to bad conversation id",e.Sydney_Cancelled_Error="ConnectionÂ toÂ SydneyÂ isÂ cancelled",e.Sydney_Error="Sydney error",e.Sydney_Timeout="Sydney timeout",e.Sydney_Unknown_Error="Sydney unknown error",e.Sydney_Websocket_Failed="Sydney failed to connect",e.Tabular_Range_Unsupported="Tabular Range Unsupported",e.Throttled="Server too busy",e.Undo_Calculated_Columns_Error="Undo calculated column error (Undo button error)",e.Unsupported_Platform_For_Python_In_Excel="Unsupported platform for Python in Excel",e.User_Dissatisfied_With_Suggestion_Calculated_Columns="User dissatisfied with the suggestion",e.User_Input_Deemed_Offensive="User input deemed offensive",e.User_Stopped_Analyze_Data_Execution="User stopped Analyze Data execution",e.User_Stopped_Calculated_Columns_Execution="User stopped Calculated Columns execution",e.User_Stopped_Commanding_Execution="User stopped Commanding execution",e.User_Stopped_Copilot_Chat_Execution="User stopped Copilot Chat execution",e.User_Stopped_Execution="User stopped execution",e.User_Stopped_Execution_Short="User stopped execution (short duration)",e.User_Stopped_Python_Execution="User stopped Python execution",e.User_Stopped_Search_Execution="User stopped Search execution",e.User_Throttled="User has issued too many requests",e.Users_Python_License_Could_Not_Be_Validated="User's Python license could not be validated",e.Table_Like_Entity_Not_Found="Table-like entity not found",e.Unsupported_Object_Selected="Unsupported object selected",e.Payload_Too_Large="Table Data Too Large",e.TLR_Auto_Fix_Undo_Failed="Tabular range auto fix undo failed",e.Python_Failed_Due_To_Protected_Sheet="Python failed due to protected sheet",e.Python_Failed_To_Send_Skill_Response_To_Flux="Python failed to send skill response to flux"}(n||(n={}))},24220:(e,t,a)=>{var n;a.d(t,{W:()=>n}),function(e){e.Copilot_Canvas_Pane_Failed_To_Load="Copilot Canvas Pane Failed to Load",e.Copilot_Chat_Pane_Failed_To_Load="Copilot Chat Pane Failed to Load",e.LLM_Service_Side_Issue_Prevents_Output="LLM Service Side Issue Prevents Output",e.Missing_Copilot_Functionality="Missing Copilot Functionality",e.Referencing_A_File_Failed="Referencing a File Failed",e.Response_Delayed_Or_Timed_Out="Response Delayed or Timed Out",e.Responsible_AI_Filter_Blocked_Response="Responsible AI Filter Blocked Response",e.UI_Failed_To_Update_Or_Load="UI Failed to Update or Load",e.Unable_To_Complete_Task="Unable to Complete Task",e.Unable_To_Generate_Response_Due_To_Capacity_Issue="Unable to Generate Response Due to Capacity Issue",e.Unclassified_ASHA_Error="Unclassified ASHA Error",e.Unclassified_Chat_Failure="Unclassified Chat Failure",e.User_Access_Issue_For_Copilot="User Access Issue for Copilot",e.User_Input_Could_Not_Be_Processed="User Input Could Not Be Processed",e.User_Rejected_Or_Cancelled_Response="User Rejected or Cancelled Response"}(n||(n={}))},89337:(e,t,a)=>{a.d(t,{R:()=>i,j:()=>l});var n=a(88179),o=a(31030),r=a(48314);function i(e){const t={eventType:o.S.ConverterError,errorMessage:e.message,logLevel:n.$b.ASHA};let a=[{key:n.Sn.ODSLProperty,value:e.property},{key:n.xL.ErrorMessage,value:e.message}];e.dataFields&&(a=a.concat(e.dataFields));r.M.getInstance().logError(t,void 0,a)}function l(e){const t=(0,n.b6)();e.forEach((e=>{t[e.key]=e.value}));r.M.getInstance().logEvent((0,n.gY)(t))}},23343:(e,t,a)=>{a.d(t,{R:()=>o});var n=a(50347);class o{static getAugloopWorkflowTimeout(){return(0,n.iP)("Microsoft.Office.Excel.FA000000124.NeverTimeout",!1)?2**31-1:(0,n.Z8)("Microsoft.Office.Excel.FA000000124.AugloopWorkflowDefaultTimeout",65e3)}static getChatHistoryWorkflowTimeout(){return(0,n.yw)("OfficeVSO_8996311_chatHistoryTimeout")?5e3:3e3}static getAnalyzeDataNetworkTimeout(){return(0,n.Z8)("Microsoft.Office.Excel.FA000000124.AnalyzeDataNetworkTimeout",5e4)}static getAnalyzeDataTimeout(){return(0,n.Z8)("Microsoft.Office.Excel.FA000000124.AnalyzeDataTimeout",4e4)}static getOdslExecutionTimeout(){return(0,n.Z8)("Microsoft.Office.Excel.FA000000124.OdslExecutionTimeout",6e4)}static getFormulaAITimeout(){return(0,n.Z8)("Microsoft.Office.Excel.FA000000124.FormulaAITimeout",4e4)}static getInsertColumnTimeout(){return 1e4}static getFormulaSuggestionUiTimeouts(){const[e,t,a]=(0,n.xt)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[2e4,15e3,3e4]);return{description:e,preview:t,explanation:a}}static getLoadPaneAshaTimeout(){return(0,n.Z8)("Microsoft.Office.Excel.FA000000124.SDXLoadTimeout",1e4)}static getLoadAuthLibraryAshaTimeout(){return 1e4}static getLoadAuthLibraryAceTimeout(){return 3e4}static getLoadAuthLibraryTimeout(){return this.getLoadAuthLibraryAceTimeout()-3e3}}},8348:(e,t,a)=>{a.d(t,{Be:()=>y,Xs:()=>n,f6:()=>b,ge:()=>f});var n,o,r=a(81364),i=a(89381),l=a(92779),s=a(82623),c=a(48314),d=a(88179),u=a(23147),m=a(50347),g=a(95674),h=a(33540),p=a(70364);async function b(e){if(!(0,m.qT)()||!e)return!1;if(!(e&(s.ye.DuplicateHeaders|s.ye.HasMergedCells|s.ye.EmptyHeaders)))return!1;const t=s.ye.RowMajor|s.ye.TotalsRow|s.ye.DuplicateHeaders,a=t|s.ye.HasMergedCells|s.ye.EmptyHeaders;return!(e&~t)||!(!Office.context.requirements.isSetSupported("excelapiundo","1.31")||e&~a)&&(!(e&s.ye.EmptyHeaders)||await async function(){try{return await Excel.run((async e=>{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");const a=e.workbook.worksheets.getItemOrNullObject(t.sheetRange.sheet),n=a.getRange((0,g.r)(t.address)),o=S(t),r=x(n,o);if(r.load("valueTypes, isNullObject"),await e.sync(),r.isNullObject||a.isNullObject)throw new Error("NoHeaderRange");const i=r.valueTypes,l="rowMajor"===o,s=i.flatMap(((e,t)=>e.map(((e,a)=>e===Excel.RangeValueType.empty?l?t:a:void 0)))).filter((e=>void 0!==e));if(0===s.length)return!1;const c=s.map((e=>{const t=l?n.getRow(e):n.getColumn(e);return t.load("isNullObject, valueTypes"),t}));await e.sync();return 0===c.filter((e=>!e.isNullObject&&e.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty)))))).length}))}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRValidateEmptyHeadersFailed,e),!1}}())}async function f(){try{return await Excel.run((async e=>{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");const a=v(e,t).tableRange.getMergedAreasOrNullObject();return a.load("areas/items/addressLocal"),await e.sync(),a.isNullObject?[]:a.areas.items.map((e=>e.addressLocal))}))}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRRetrieveMergeCellsFailed,e),[]}}async function C(e){let t=1;try{const{context:a,tableRange:n,orientation:o}=e,r=x(n,o),i="rowMajor"===o;let l;if(r.load("values"),await a.sync(),l=i?r.values.flat():r.values[0],T(l)){const e=function(e,t){const a=new Map;let n=2;return e.map((e=>{const o=a.get(e)||0;if(a.set(e,o+1),0===o)return e;let r=`${e}${n}`;for(;t.has(r);)n++,r=`${e}${n}`;return n++,r}))}(l,function(e){const t=new Map;return e.forEach((e=>{const a=t.get(e)||0;t.set(e,a+1)})),t}(l));T(e)?t=2:(r.values=i?e.map((e=>[e])):[e],await a.sync(),t=0)}return t}catch(e){t=2,c.M.getInstance().logErrorCode(r.O.TLRFixDuplicatesFailed,e)}return t}async function y(e){await u.CP.fetchAndSetActiveTableLikeEntity(e);const t=u.CP.getActiveTable();if(!t||!(0,h.P9)(e,t.name))return c.M.getInstance().logErrorCode(r.O.AutoFixTLRFailed,new Error("NoActiveTable")),2;try{return await(0,p.F5)((async e=>{const a=v(e,t),n=t.tableLikeRangeFeatures;if(!n)return 1;if(n===s.ye.DuplicateHeaders)return await C(a);if(Office.context.requirements.isSetSupported("excelapiundo","1.31")){const e=await async function(e,t){const a=[];t&s.ye.HasMergedCells&&a.push(await async function(e){try{const{context:t,tableRange:a}=e,n=a.getMergedAreasOrNullObject();return n.load("areas/items/values"),await t.sync(),n.isNullObject?(0,m.yw)("OfficeVSO_9476290_autoFixMergeEntireRange")?(a.unmerge(),await t.sync(),0):1:(n.areas.items.forEach((e=>{const t=e.values.flat().find((e=>e!==Excel.RangeValueType.empty));e.unmerge(),e.values=e.values.map((e=>e.map((()=>t))))})),(0,m.yw)("OfficeVSO_9476290_autoFixMergeEntireRange")&&a.unmerge(),await t.sync(),0)}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRFixMergedCellsFailed,e),2}}(e));t&s.ye.EmptyHeaders&&a.push(await async function(e){try{const{context:t,tableRange:a,orientation:n}=e,o=x(a,n);if(o.load("valueTypes, isNullObject"),await t.sync(),o.isNullObject)throw new Error("NoHeaderRange");const r=o.valueTypes,i="rowMajor"===n,s=r.flatMap(((e,t)=>e.map(((e,n)=>{if(e===Excel.RangeValueType.empty){const e=a.getCell(t,n),o=i?`${(0,l.yfY)()}${t+1}`:`${(0,l.AWH)()}${n+1}`;return e.values=[[o]],e}})))).filter((e=>void 0!==e));return await t.sync(),s.length>0?0:1}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRFixEmptyHeadersFailed,e),2}}(e));return a.push(await C(e)),a}(a,n);if(e.includes(2))throw new Error("AutoFixUnsuccessful");if(e.includes(0))return n&s.ye.HasMergedCells&&u.CP.clearMergedCellsFromActiveTable(),0}return 1}))}catch(e){return"AutoFixUnsuccessful"===e.message?await(0,p.tN)(d.q.ContextInference):c.M.getInstance().logErrorCode(r.O.AutoFixTLRFailed,e),2}}function v(e,t){const a=e.workbook.worksheets.getItem(t.sheetRange.sheet),n=a.getRange((0,g.r)(t.address));return{context:e,sheet:a,tableRange:n,orientation:S(t)}}function T(e){return new Set(e).size!==e.length}function x(e,t=i.YV.ColumnMajor){return t===i.YV.RowMajor?e.getColumn(0):e.getRow(0)}function S(e){return e?.tableLikeRangeFeatures&&e.tableLikeRangeFeatures&s.ye.RowMajor?i.YV.RowMajor:i.YV.ColumnMajor}!function(e){e[e.Success=0]="Success",e[e.NoChangeMade=1]="NoChangeMade",e[e.Unsuccessful=2]="Unsuccessful"}(n||(n={})),function(e){e.NoActiveTable="NoActiveTable",e.NoHeaderRange="NoHeaderRange",e.AutoFixUnsuccessful="AutoFixUnsuccessful"}(o||(o={}))},83197:(e,t,a)=>{a.d(t,{Cn:()=>s,EQ:()=>l,S:()=>i,xq:()=>u,yc:()=>r});var n=a(94303);function o(e){e=e.replace("#","");for(;e.length<6;)e="0"+e;return e}function r(e){e=o(e);const t=parseInt(e,16);if(isNaN(t))throw new Error("NaN");return t}function i(e){let t=e.toString(16);for(;t.length<6;)t="0"+t;return"#"+t.toUpperCase()}function l(e){return(255&e)<<16|65280&e|(16711680&e)>>16}function s(e){return l(e)}function c(e){let t="",a="",r="";if(6!==(e=o(e)).length)throw new n.tF("Hex color value length is not 7.","convertHexToTuple");t=`0x${e[0]}${e[1]}`,a=`0x${e[2]}${e[3]}`,r=`0x${e[4]}${e[5]}`;const i={r:parseInt(t),g:parseInt(a),b:parseInt(r)};if(Number.isNaN(i.r)||Number.isNaN(i.g)||Number.isNaN(i.b))throw new n.tF("Failed to parse hex value into numbers.","convertHexToTuple");return i}function d(e){let t,a,n,o=e.r/255,r=e.g/255,i=e.b/255;return o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,t=(.4124*o+.3576*r+.1805*i)/.95047,a=(.2126*o+.7152*r+.0722*i)/1,n=(.0193*o+.1192*r+.9505*i)/1.08883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,{l:116*a-16,a:500*(t-a),b:200*(a-n)}}function u(e,t){if(-1!==e.findIndex((e=>e===t)))return t;{let a=0;const o=d(c(t)),r=e.reduce(((e,t)=>{const n=d(c(e)),r=d(c(t)),i=new m(n,o).getDeltaE(),l=new m(r,o).getDeltaE();return a=Math.min(l,i),l<i?t:e}));if(a<35)return r;throw new n.tF("No close color matched.","getClosestColor",n.tJ.ColorDistanceExceededThreshold)}}class m{getDeltaE(){try{this.hPrime1=this.gethPrime1(),this.hPrime2=this.gethPrime2(),this.deltahPrime=this.getDeltahPrime(),this.deltaHPrime=2*Math.sqrt(this.CPrime1*this.CPrime2)*Math.sin(this.degreesToRadians(this.deltahPrime)/2),this.HBarPrime=this.getHBarPrime(),this.T=this.getT(),this.SsubH=1+.015*this.CBarPrime*this.T,this.RsubT=this.getRsubT();const e=this.deltaLPrime/(this.ksubL*this.SsubL),t=this.deltaCPrime/(this.ksubC*this.SsubC),a=this.deltaHPrime/(this.ksubH*this.SsubH);return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(a,2)+this.RsubT*t*a)}catch{throw new n.tF("Error happened during calculating the color distance.","getDeltaE")}}getT(){return 1-.17*Math.cos(this.degreesToRadians(this.HBarPrime-30))+.24*Math.cos(this.degreesToRadians(2*this.HBarPrime))+.32*Math.cos(this.degreesToRadians(3*this.HBarPrime+6))-.2*Math.cos(this.degreesToRadians(4*this.HBarPrime-63))}getHBarPrime(){return Math.abs(this.hPrime1-this.hPrime2)>180?(this.hPrime1+this.hPrime2+360)/2:(this.hPrime1+this.hPrime2)/2}getDeltahPrime(){return 0===this.C1||0===this.C2?0:Math.abs(this.hPrime1-this.hPrime2)<=180?this.hPrime2-this.hPrime1:this.hPrime2<=this.hPrime1?this.hPrime2-this.hPrime1+360:this.hPrime2-this.hPrime1-360}gethPrime1(){return this.gethPrimeFn(this.x1.b,this.aPrime1)}gethPrime2(){return this.gethPrimeFn(this.x2.b,this.aPrime2)}gethPrimeFn(e,t){if(0===e&&0===t)return 0;const a=this.radiansToDegrees(Math.atan2(e,t));return a>=0?a:a+360}radiansToDegrees(e){return e*(180/Math.PI)}degreesToRadians(e){return e*(Math.PI/180)}constructor(e,t,a){this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0,this.getRsubT=()=>-2*Math.sqrt(Math.pow(this.CBarPrime,7)/(Math.pow(this.CBarPrime,7)+Math.pow(25,7)))*Math.sin(this.degreesToRadians(60*Math.exp(-Math.pow((this.HBarPrime-275)/25,2)))),this.x1=e,this.x2=t,this.weights=a??{lightness:1,chroma:1,hue:1},this.ksubL=this.weights.lightness,this.ksubC=this.weights.chroma,this.ksubH=this.weights.hue,this.deltaLPrime=t.l-e.l,this.LBar=(e.l+t.l)/2,this.C1=Math.sqrt(Math.pow(e.a,2)+Math.pow(e.b,2)),this.C2=Math.sqrt(Math.pow(t.a,2)+Math.pow(t.b,2)),this.CBar=(this.C1+this.C2)/2,this.aPrime1=e.a+e.a/2*(1-Math.sqrt(Math.pow(this.CBar,7)/(Math.pow(this.CBar,7)+Math.pow(25,7)))),this.aPrime2=t.a+t.a/2*(1-Math.sqrt(Math.pow(this.CBar,7)/(Math.pow(this.CBar,7)+Math.pow(25,7)))),this.CPrime1=Math.sqrt(Math.pow(this.aPrime1,2)+Math.pow(e.b,2)),this.CPrime2=Math.sqrt(Math.pow(this.aPrime2,2)+Math.pow(t.b,2)),this.CBarPrime=(this.CPrime1+this.CPrime2)/2,this.deltaCPrime=this.CPrime2-this.CPrime1,this.SsubL=1+.015*Math.pow(this.LBar-50,2)/Math.sqrt(20+Math.pow(this.LBar-50,2)),this.SsubC=1+.045*this.CBarPrime,this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0}}},21792:(e,t,a)=>{a.d(t,{g:()=>n});class n{static hslFromRgb(e){const t=(e>>16&255)*this.maxHslValue/this.maxRGBValue,a=(e>>8&255)*this.maxHslValue/this.maxRGBValue,n=(255&e)*this.maxHslValue/this.maxRGBValue,o=Math.max(t,Math.max(a,n)),r=Math.min(t,Math.min(a,n)),i=o+r,l=o-r;let s,c;const d=i/2;return 0===l?(s=0,c=0):(c=l*this.maxHslValue/(d<=this.maxHslValue/2?i:2*this.maxHslValue-i),s=t===o?(a-n)*(this.maxHslValue/6)/l:a===o?this.maxHslValue/3+(n-t)*(this.maxHslValue/6)/l:2*this.maxHslValue/3+(t-a)*(this.maxHslValue/6)/l,s<0?s+=this.maxHslValue:s>this.maxHslValue&&(s-=this.maxHslValue)),[s,c,d]}static colorNameFromHEX(e){if(!e)return;if(e in n.HexColorMap)return n.HexColorMap[e]();let t,a,o;const r=parseInt("0x"+e.slice(1,7),16);if([t,a,o]=this.hslFromRgb(r),t=255*t/this.maxHslValue,o=255*o/this.maxHslValue,a=255*a/this.maxHslValue,o>240)return ExcelCopilotCommandingHitlStrings.ColorWhite;if(o<20)return ExcelCopilotCommandingHitlStrings.ColorBlack;if(a<=20)return o>170?ExcelCopilotCommandingHitlStrings.ColorLightGray:o>100?ExcelCopilotCommandingHitlStrings.ColorGray:ExcelCopilotCommandingHitlStrings.ColorDarkGray;let i;i=a>20&&a<=75?n.HueLimitsForSatLevel1:a>75&&a<=115?n.HueLimitsForSatLevel2:a>115&&a<=150?n.HueLimitsForSatLevel3:a>150&&a<=240?n.HueLimitsForSatLevel4:n.HueLimitsForSatLevel5;let l=0;for(;l<i.length&&t>=i[l];)l++;return l!==i.length?o>n.LumLimitsForHueIndexHigh[l]?n.ColorNamesLight[l]():o<n.LumLimitsForHueIndexLow[l]?n.ColorNamesDark[l]():n.ColorNamesMid[l]():void 0}}n.HexColorMap={"#FFBF00":()=>ExcelCopilotCommandingHitlStrings.ColorAmber,"#F5F5DC":()=>ExcelCopilotCommandingHitlStrings.ColorBeige,"#000000":()=>ExcelCopilotCommandingHitlStrings.ColorBlack,"#5A8AC6":()=>ExcelCopilotCommandingHitlStrings.ColorBlue,"#73d8ff":()=>ExcelCopilotCommandingHitlStrings.ColorBlue,"#CD7F32":()=>ExcelCopilotCommandingHitlStrings.ColorBronze,"#964B00":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#c45100":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#E1C699":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#3B2F2F":()=>ExcelCopilotCommandingHitlStrings.ColorBrunette,"#800020":()=>ExcelCopilotCommandingHitlStrings.ColorBurgundy,"#36454F":()=>ExcelCopilotCommandingHitlStrings.ColorCharcoal,"#4B3621":()=>ExcelCopilotCommandingHitlStrings.ColorMocha,"#FF7F50":()=>ExcelCopilotCommandingHitlStrings.ColorCoral,"#DC143C":()=>ExcelCopilotCommandingHitlStrings.ColorCrimson,"#00FFFF":()=>ExcelCopilotCommandingHitlStrings.ColorCyan,"#00008B":()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,"#A9A9A9":()=>ExcelCopilotCommandingHitlStrings.ColorDarkGray,"#006400":()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,"#4B0082":()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,"#8B0000":()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed,"#50C878":()=>ExcelCopilotCommandingHitlStrings.ColorEmerald,"#FFD700":()=>ExcelCopilotCommandingHitlStrings.ColorGold,"#808080":()=>ExcelCopilotCommandingHitlStrings.ColorGray,"#194d33":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#63BE7B":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#808900":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#b0bc00":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#b0bf1a":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#cddf19":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#E6E6FA":()=>ExcelCopilotCommandingHitlStrings.ColorLavender,"#FFF44F":()=>ExcelCopilotCommandingHitlStrings.ColorLemonYellow,"#ADD8E6":()=>ExcelCopilotCommandingHitlStrings.ColorLightBlue,"#D3D3D3":()=>ExcelCopilotCommandingHitlStrings.ColorLightGray,"#DABDE4":()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,"#C8A2C8":()=>ExcelCopilotCommandingHitlStrings.ColorLilac,"#00FF00":()=>ExcelCopilotCommandingHitlStrings.ColorLime,"#FF00FF":()=>ExcelCopilotCommandingHitlStrings.ColorMagenta,"#800000":()=>ExcelCopilotCommandingHitlStrings.ColorMaroon,"#E0B0FF":()=>ExcelCopilotCommandingHitlStrings.ColorMauve,"#FFDB58":()=>ExcelCopilotCommandingHitlStrings.ColorMustard,"#000080":()=>ExcelCopilotCommandingHitlStrings.ColorNavyBlue,"#808000":()=>ExcelCopilotCommandingHitlStrings.ColorOliveGreen,"#fb9e00":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#FCBF7B":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#fe9200":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#FFDAB9":()=>ExcelCopilotCommandingHitlStrings.ColorPeach,"#CCCCFF":()=>ExcelCopilotCommandingHitlStrings.ColorPeriwinkle,"#fda1ff":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FF9994":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FFC0CB":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FFC7CE":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#DDA0DD":()=>ExcelCopilotCommandingHitlStrings.ColorPlum,"#58427C":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#800080":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#9370DB":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#ab149e":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#aea1ff":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#A52A2A":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#b10000":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#DB2D43":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#E74C3C":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#F8696B":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#FF0044":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#E0115F":()=>ExcelCopilotCommandingHitlStrings.ColorRuby,"#8B2500":()=>ExcelCopilotCommandingHitlStrings.ColorRust,"#F4C430":()=>ExcelCopilotCommandingHitlStrings.ColorSaffron,"#FA8072":()=>ExcelCopilotCommandingHitlStrings.ColorSalmon,"#0F52BA":()=>ExcelCopilotCommandingHitlStrings.ColorSapphire,"#2E8B57":()=>ExcelCopilotCommandingHitlStrings.ColorSeaGreen,"#C0C0C0":()=>ExcelCopilotCommandingHitlStrings.ColorSilver,"#87CEEB":()=>ExcelCopilotCommandingHitlStrings.ColorSkyBlue,"#D2B48C":()=>ExcelCopilotCommandingHitlStrings.ColorTan,"#008080":()=>ExcelCopilotCommandingHitlStrings.ColorTeal,"#40E0D0":()=>ExcelCopilotCommandingHitlStrings.ColorTurquoise,"#EE82EE":()=>ExcelCopilotCommandingHitlStrings.ColorViolet,"#FCFCFF":()=>ExcelCopilotCommandingHitlStrings.ColorWhite,"#FFFFFF":()=>ExcelCopilotCommandingHitlStrings.ColorWhite,"#fcc400":()=>ExcelCopilotCommandingHitlStrings.ColorYellow,"#FFEF9C":()=>ExcelCopilotCommandingHitlStrings.ColorYellow,"#FFFF00":()=>ExcelCopilotCommandingHitlStrings.ColorYellow},n.ColorNamesLight=[()=>ExcelCopilotCommandingHitlStrings.ColorLightOrange,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorLightOrange,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorLightYellow,()=>ExcelCopilotCommandingHitlStrings.ColorLightYellow,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorPaleBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorRed],n.ColorNamesMid=[()=>ExcelCopilotCommandingHitlStrings.ColorOrange,()=>ExcelCopilotCommandingHitlStrings.ColorRed,()=>ExcelCopilotCommandingHitlStrings.ColorOrange,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorGold,()=>ExcelCopilotCommandingHitlStrings.ColorYellow,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBrightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGray,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorRed],n.ColorNamesDark=[()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkYellow,()=>ExcelCopilotCommandingHitlStrings.ColorDarkYellow,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGray,()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed],n.maxRGBValue=255,n.maxHslValue=6*n.maxRGBValue,n.HueLimitsForSatLevel1=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0],n.HueLimitsForSatLevel2=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256],n.HueLimitsForSatLevel3=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256],n.HueLimitsForSatLevel4=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,140,0,180,0,0,224,241,0,256],n.HueLimitsForSatLevel5=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,0,256],n.LumLimitsForHueIndexLow=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100],n.LumLimitsForHueIndexHigh=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165]},9166:(e,t,a)=>{a.d(t,{N:()=>n});const n=!1},95674:(e,t,a)=>{a.d(t,{r:()=>o});var n=a(49134);function o(e){return e.lastIndexOf("!")===e.length-1?e:n.ExcelCalc.stripSheetFromRange(e)}},91918:(e,t,a)=>{a.d(t,{A:()=>o});var n=a(49437);function o(){return(0,n.P)("AudienceGroup")}},6704:(e,t,a)=>{a.d(t,{MH:()=>n,Ml:()=>o,Tq:()=>c,uS:()=>d});const n="synchronous";function o(e){if(e){const t=e.storageScript.apiInfo;if(t){return JSON.parse(t)}}}const r=1,i=1,l=2;function s(e){if(e){const{variantVersion:a}=e;if(void 0!==a&&"number"==typeof(t=a)&&Number.isInteger(t)&&t>=0)return a}var t;return 0}async function c(e){const t=s(e);return{enableNoImplicitAny:t>=r,enableNoIdentifiersPassedToArrayMethodCallbacks:t>=i,enableNoImplicitAnyAssignment:t>=l}}async function d(e){return c(o(e))}},45972:(e,t,a)=>{a.d(t,{E:()=>o});var n=a(49134);function o(e){return-1===e.indexOf("!")?n.ExcelCalc.addressToExcelRange(e):n.ExcelCalc.addressToExcelRange(n.ExcelCalc.localAddressesFromSheetAddresses(e))}},33637:(e,t,a)=>{a.d(t,{V:()=>u});var n=a(49134),o=a(94303),r=a(48286),i=a(6704);function l(){const e={variant:i.MH,variantVersion:2};return JSON.stringify(e)}var s=a(98483);const c=e=>{const t={...d(),...e};return{storageScript:t,localUpdates:{dateLastModified:Date.now(),body:t.body,parameterInfo:t.parameterInfo}}},d=()=>({id:(0,s.A)(),name:"TempScript",body:r.newScriptBody,description:"",apiInfo:l(),isCreator:!0,creatorId:"0a088C17MOCKPUID",creatorDisplayName:"Name",creatorEmail:"name@contoso.com",mruItemId:(0,s.A)()});async function u(e,t,a,r,i){try{const o=await async function(){return Excel.run(n.getStartingContext)}();if(r){const e=(0,n.getParameterAliasesTableByName)({tableAliasId:r,tableAliasDisplayName:"inputTable"});o.parameterAliasInfo=e}const l=function(){const e=new n.ExcelLocalCodeGenerator([]);return new n.GeneralExtendedRangeCodeGenerator(e)}(),s=function(e){const t=e?new n.OfficeScriptsRelativeRangeExpressionGenerator(e):new n.OfficeScriptsAbsoluteRangeExpressionGenerator;return new n.OfficeScriptCodeBlockGenerator(t)}();await l.startNewRecording(o),e.forEach((e=>l.addEvent(e)));let d=await l.getCode(s,!1);return i&&(d=`// ${i}\n${d}`),c({name:t,description:a,body:d})}catch{throw new o.WD("Failed to generate Office Scripts script.")}}},84654:(e,t,a)=>{a.d(t,{u:()=>o});var n=a(98483);function o(){let e;try{e=OSF._OfficeAppFactory.getHostInfo().osfControlAppCorrelationId}catch(e){}return e||(e=`local.${(0,n.A)()}`),e}},55143:(e,t,a)=>{a.d(t,{G2:()=>b,Jm:()=>p,K7:()=>d,R1:()=>c,Sy:()=>m,_f:()=>g,m:()=>h,vs:()=>u,zC:()=>f});var n=a(78640),o=a(58242),r=a(50347),i=a(95674),l=a(14588),s=a(33540);function c(e,t,a){return e(n.mF.getTabularRangeMetadataFromRange(t,a))?.tabularRange}function d(e){const t=e.interpretation.location,{left:a,top:n,right:o,bottom:r,worksheetId:i}={left:t.left-1,top:t.top-1,right:t.right-1,bottom:t.bottom-1,worksheetId:t.worksheetId};return{left:a,top:n,right:o,bottom:r,worksheetId:i}}function u(e,t,a){let n;return n=(0,r.yw)("OfficeVSO_9266150_handleHeadersByOrientation")&&"rowMajor"===a?e.getRangeByIndexes(t.top,t.left,t.bottom-t.top+1,1):e.getRangeByIndexes(t.top,t.left,1,t.right-t.left+1),n}function m(e,t,a){if((0,r.yw)("OfficeVSO_9266150_handleHeadersByOrientation")){if((0,s.TP)(t,a))return[];if("rowMajor"===t)return e.values.map((e=>e[0]))}return e.values[0]}function g(e,t){return e.getRangeByIndexes(t.top+1,t.left,1,t.right-t.left+1)}async function h(e,t,a,n){const o=function(e,t){return e.getRangeByIndexes(t.top+1,t.left,t.bottom-t.top,t.right-t.left+1)}(t,a);o.track(),o.load("rowCount"),await e.sync();const r=await(0,l.dr)(e,o,n);return o.untrack(),r}function p(e,t){return`${e}!${(0,o.XK)({top:t.top,left:t.left,right:t.right,bottom:t.bottom})}`}function b(e){return(0,i.r)(e)}function f(e){const t=e.lastIndexOf("!");return-1===t?"":e.substring(0,t)}},14588:(e,t,a)=>{a.d(t,{GF:()=>l,dr:()=>s,vq:()=>c});var n=a(81364),o=a(50347),r=a(55143),i=a(35828);async function l(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.tables.getItemOrNullObject(e).load("isNullObject");if(await a.sync(),n.isNullObject)return[];const o=n.getDataBodyRange().load("rowCount");return await a.sync(),s(a,o,t)}))}async function s(e,t,a){if(t.rowCount<a&&(a=t.rowCount),(0,o.yw)("OfficeVSO_9396201_PythonRowTextNullCheck")){const n=[];for(let e=0;e<a;e++){const a=t.getRow(e).load(["isEntireRow","isEntireColumn","text"]);n.push(a)}await e.sync();const o=[];for(let e=0;e<n.length;e++){if(n[e].isEntireColumn||n[e].isEntireRow||!n[e].text)throw(0,i._s)("Range is null due to payload size limit.");o.push(n[e].text[0])}return o}{const n=[];for(let o=0;o<a;o++){const a=t.getRow(o).load("text");await e.sync(),n.push(a.text[0])}return n}}async function c(e,t,a,o,s,c){let d=[];if(!0!==e.tableLikeRange)d=await l(e.name,c);else{if(!t){throw(0,i.Uc)(n.O.PythonContextUndefinedParameter,"Undefined Parameter: sheetId, Function: getSampleRowsForPythonAda")}d=await async function(e,t,a,n,o){const i=(0,r.R1)(e,a,n);if(i){const e=(0,r.K7)(i),a=t.workbook.worksheets.getItem(e.worksheetId);return await(0,r.m)(t,a,e,o)}return[]}(o,s,t,a,c)}return d}},49437:(e,t,a)=>{function n(e){if(Office.context.document?.settings?.get){const t=Office.context.document.settings.get(e);if(null===t)return;return t}throw new Error("Unable to get initial taskpane state. 'Office.context.document.settings.get' is not defined.")}function o(){return{AudienceGroup:n("AudienceGroup"),Script:n("Script"),StorageModePreference:n("StorageModePreference"),StartTimeMs:n("StartTimeMs"),copilotPaneStartTimestamp:n("copilotPaneStartTimestamp"),CopilotSaveAutomation:n("CopilotSaveAutomation"),CopilotPAIntegration:n("CopilotPAIntegration"),HandoffMessageId:n("HandoffMessageId"),LaunchOfficeScriptsSDXOptionalProperties:n("LaunchOfficeScriptsSDXOptionalProperties"),optionalProperties:n("optionalProperties"),FlowCreated:n("FlowCreated"),SessionLocation:n("SessionLocation")}}a.d(t,{P:()=>n,i:()=>o})},36131:(e,t,a)=>{a.d(t,{d:()=>n});class n{promise(){return this.cachedPromise||(this.cachedPromise=this.initFn().then((e=>(this.cachedPromise&&(this.cachedValue=e),e)))),this.cachedPromise}forget(){this.cachedPromise=void 0,this.cachedValue=void 0}isStarted(){return void 0!==this.cachedPromise}value(){return this.cachedValue}get(){return()=>this.promise()}constructor(e){this.initFn=e}}},26543:(e,t,a)=>{a.d(t,{D:()=>o});var n=a(61150);function o(e){let t,a,o;if(e.json)try{const n=JSON.parse(e.json);o=n.code,t=n.tabularRangeUnsupportedFeatureSkillFailures,a=n.unsupportedContextFeatures}catch(e){(0,n.cY)(n.SA.Error,"Failed to parse augloop error JSON: ",e)}return{errorCode:o,tlrSkillSupport:t,contextFailures:a}}},59367:(e,t,a)=>{a.d(t,{z:()=>o});var n=a(36130);const o=()=>(0,n.XG)()},35717:(e,t,a)=>{a.d(t,{U:()=>o,p:()=>r});class n{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}class o{constructor(e){this.getPromise=()=>this.outerPromise,this.getOriginalPromise=()=>this.originalPromise,this.reject=e=>{this.pHolder&&this.pHolder.reject(e)},this.resolve=e=>{this.pHolder&&this.pHolder.resolve(e)},this.outerPromise=new Promise(((e,t)=>{this.pHolder=new n(e,t)})),this.originalPromise=e(),this.originalPromise.then((e=>{this.pHolder&&this.pHolder.resolve(e)})).catch((e=>{this.pHolder&&this.pHolder.reject(e)}))}}function r(){let e=null,t=null;return{promise:new Promise(((a,n)=>{e=a,t=n})),resolve:e,reject:t}}},28745:(e,t,a)=>{a.d(t,{_:()=>s});var n=a(49134);function o(e,t){return null===e.column||null===e.row||null===t.column||null===t.row?1/0:Math.sqrt(Math.pow(e.column-t.column,2)+Math.pow(e.row-t.row,2))}function r(e,t){if(null===e.column||null===e.row||null===t.bottomRight.row||null===t.bottomRight.column||null===t.topLeft.row||null===t.topLeft.column)return 1/0;if(e.row>=t.topLeft.row&&e.row<=t.bottomRight.row)return Math.abs(e.column-t.topLeft.column);const a=o(e,t.topLeft),n=o(e,t.bottomRight);return Math.min(a,n)}function i(e,t){if(null===e.column||null===e.row||null===t.bottomRight.row||null===t.bottomRight.column||null===t.topLeft.row||null===t.topLeft.column)return 1/0;if(e.column>=t.topLeft.column&&e.column<=t.bottomRight.column)return Math.abs(e.row-t.topLeft.row);const a=o(e,t.topLeft),n=o(e,t.bottomRight);return Math.min(a,n)}function l(e,t){const a=[{topLeft:t.topLeft,bottomRight:{row:t.topLeft.row,column:t.bottomRight.column}},{topLeft:{row:t.bottomRight.row,column:t.topLeft.column},bottomRight:t.bottomRight}],n=[{topLeft:t.topLeft,bottomRight:{row:t.bottomRight.row,column:t.topLeft.column}},{topLeft:{row:t.topLeft.row,column:t.bottomRight.column},bottomRight:t.bottomRight}];let o=1/0;for(const t of a){const a=i(e,t);o=Math.min(o,a)}for(const t of n){const a=r(e,t);o=Math.min(o,a)}return o}function s(e,t){const a=[{row:e.topLeft.row,column:e.topLeft.column},{row:e.topLeft.row,column:e.bottomRight.column},{row:e.bottomRight.row,column:e.topLeft.column},{row:e.bottomRight.row,column:e.bottomRight.column}];if(n.ExcelCalc.IExcelRangeIntersect(e,t))return 0;let o=1/0;for(const e of a){const a=l(e,t);o=Math.min(o,a)}return o}},62522:(e,t,a)=>{a.d(t,{g:()=>n});class n{getIsFirstColumnEntityResolved(){return this.isFirstColumnEntityResolved}getHasShownFirstColumnHint(){return this.hasShownFirstColumnHint}setIsFirstColumnEntityResolved(e,t){const a=JSON.parse(e);let n=!1;for(let e=0;e<a.length;e++)if(t?.includes(a[e])){n=!0;break}n||(this.isFirstColumnEntityResolved=!0)}setHiddenColumnSuffixMessage(e,t){const a=JSON.parse(e.headers),n=t.map((e=>a[e]));n.length>1?this.hiddenColumnSuffixMessage="I noticed that some columns are hidden, so you'll need to unhide them to see what I did.":this.hiddenColumnSuffixMessage=`I noticed that column ${n[0]} is hidden, so you'll need to unhide this column to see what I did.`}getHiddenColumnSuffixMessageAndReset(){const e=this.hiddenColumnSuffixMessage?.slice();return this.hiddenColumnSuffixMessage=void 0,e}setHasShownFirstColumnHint(e){this.hasShownFirstColumnHint=e}constructor(){this.isFirstColumnEntityResolved=!1,this.hasShownFirstColumnHint=!1}}n.instance=()=>(n._instance||(n._instance=new n),n._instance)},33540:(e,t,a)=>{a.d(t,{$j:()=>U,AG:()=>k,Ah:()=>E,GT:()=>p,Ks:()=>F,M$:()=>b,MQ:()=>C,OK:()=>f,P9:()=>H,S5:()=>V,TF:()=>I,TP:()=>T,Zv:()=>S,bp:()=>v,ey:()=>O,f0:()=>w,f_:()=>h,hd:()=>x,ie:()=>A,kB:()=>N,kw:()=>_,py:()=>y,xl:()=>R});var n=a(92779),o=a(34813),r=a(49134),i=a(82623),l=a(88099),s=a(55143),c=a(61150),d=a(50347),u=a(8348),m=a(95674),g=a(98100);function h(e,t,a,n){const o=y(e),r=n?t[n]:t[o];if(!r)return t;const i=(0,l.cloneDeep)(t),s={...r,...a};return n&&o!==n&&(i[o]=i[n],delete i[n]),i[o]=s,i}function p(e){if(1===e.length&&!b(e[0]))throw new Error("Single range that is not fully specified");const t={topLeft:{row:Math.min(...e.map((e=>(e=>null!==e.topLeft.row?e.topLeft.row:1/0)(e)))),column:Math.min(...e.map((e=>(e=>null!==e.topLeft.column?e.topLeft.column:1/0)(e))))},bottomRight:{row:Math.max(...e.map((e=>(e=>null!==e.bottomRight.row?e.bottomRight.row:0)(e)))),column:Math.max(...e.map((e=>(e=>null!==e.bottomRight.column?e.bottomRight.column:0)(e))))}};if(!b(t))throw new Error("Bounding rect does not produce a fully specified range");return t}function b(e){return null!==e.topLeft.column&&null!==e.topLeft.row&&null!==e.bottomRight.column&&null!==e.bottomRight.row&&e.bottomRight.column>=e.topLeft.column&&e.bottomRight.row>=e.topLeft.row}function f(e,t,a,n){if(!b(e))throw new Error("Invalid TLR range");const o={worksheetId:n,left:e.topLeft.column+1,top:e.topLeft.row+1,right:e.bottomRight.column+1,bottom:e.bottomRight.row+1},r=t[a],i=(0,s.Jm)((0,s.zC)(r.name),o);if((0,d.yw)("OfficeVSO_9324467_updateInterpretationsForRange")){return h(i,t,{range:e,name:i,interpretation:{...r.interpretation,location:o}},a)}const c=(0,l.cloneDeep)(t),u=C(e);return c[u]=c[a],delete c[a],c[u]={...c[u],range:e,name:i,interpretation:{...c[u].interpretation,location:o}},c}function C(e){if(!b(e))throw new Error("Invalid TLR range");return`${e.topLeft.column+1}|${e.bottomRight.column+1}|${e.topLeft.row+1}|${e.bottomRight.row+1}`}function y(e){return C(r.ExcelCalc.addressToExcelRange((0,s.G2)(e)))}function v(e,t){let a=i.ye.None;t.hasMergedcells&&(a|=i.ye.HasMergedCells);const n=e.aggregationLines?.length,o=t.primaryTable?.hasTotalRow??!1;o&&(a|=i.ye.TotalsRow),(0,d.yw)("OfficeVSO_9266302_tlrFlagAggregations")&&n&&(n>1||1===n&&!o)&&(a|=i.ye.UnsupportedAggregations);const r=[{check:0===e.headerRowCount,flag:i.ye.NoHeaderRow},{check:e.headerRowCount>1,flag:i.ye.MultipleHeaderRows},{check:"rowMajor"===e.orientation,flag:i.ye.RowMajor},{check:.5===e.confidence,flag:i.ye.Crosstab}],l=[{check:"columnMajor"===e.orientation&&0===e.headerRowCount,flag:i.ye.NoHeaderRow},{check:"columnMajor"===e.orientation&&e.headerRowCount>1,flag:i.ye.MultipleHeaderRows},{check:"columnMajor"===e.orientation&&e.headerColumnCount>0,flag:i.ye.HeaderColumns},{check:"rowMajor"===e.orientation,flag:i.ye.RowMajor},{check:"rowMajor"===e.orientation&&0===e.headerColumnCount,flag:i.ye.NoHeaderColumn},{check:"rowMajor"===e.orientation&&e.headerColumnCount>1,flag:i.ye.MultipleHeaderColumns},{check:"rowMajor"===e.orientation&&e.headerRowCount>0,flag:i.ye.HeaderRows},{check:.5===e.confidence,flag:i.ye.Crosstab}];return a|=((0,d.yw)("OfficeVSO_9265660_newTLRConditions")?l:r).reduce(((e,t)=>t.check?e|t.flag:e),i.ye.None),{unsupportedFeatures:a,hasTotalRow:o}}function T(e,t){return"columnMajor"===e?!!(t&i.ye.NoHeaderRow):!!(t&i.ye.NoHeaderColumn)}function x(e){return function(e){const t=new Set(e);return e.some((e=>function(e,t){const a=B[e];return!!a&&a.every((e=>!t.has(e)))}(e,t)))}(e)?(0,n.nYf)():(0,n.VH3)()}function S(e){const t=M(e);return t?.singleErrorMessage??""}function w(e){const t=M(e);return t?.multipleErrorMessage??""}function E(e){const t=M(e);return t?.header??""}async function R(e){const t=P(e);return{header:await t.header(),description:t.description}}function I(e){if(1===e.length){return P(e[0]).successfulResponse}return(0,n.qPG)()}function A(e){if(1===e.length){return P(e[0]).unsuccessfulResponse}return(0,n.Py2)()}const L=(e,t,a)=>a.includes(t[0])&&a.includes(t[1])&&e===t[0];function F(e){return e.filter((t=>!$.some((a=>L(t,a,e)))))}function _(e){return Object.values(i.ye).filter((t=>"number"==typeof t&&t!==i.ye.All&&e&t))}function N(e){try{return e.reduce(((e,t)=>e|t[1]),i.ye.None)}catch(e){return(0,c.cY)("Error getting unsupported skill features:",e),i.ye.None}}function k(e){try{return e.reduce(((e,t)=>e|t[1]),0)}catch(e){return(0,c.cY)("Error getting unsupported context features:",e),0}}function O(e){switch(e){case i.b_.PayloadTooLarge:return(0,n.OX0)();case i.b_.PivotTableSelected:case i.b_.ChartSelected:default:return(0,d.yw)("OfficeVSO_9364126_UpdateAnalyzeDataInsertResponse")?(0,n.zGM)():(0,n.FxF)()}}function P(e){switch(e){case i.ye.DuplicateHeaders:return{header:async()=>(0,n.c_T)(),description:(0,n.P$N)(),successfulResponse:(0,n.MIy)(),unsuccessfulResponse:(0,n.bor)()};case i.ye.HasMergedCells:return{header:D,description:(0,n.Pqn)(),successfulResponse:(0,n.uvg)(),unsuccessfulResponse:(0,n.R3b)()};case i.ye.EmptyHeaders:return{header:async()=>(0,n.mJ6)(),description:(0,n.z56)(),successfulResponse:(0,n.MuJ)(),unsuccessfulResponse:(0,n.VJh)()};default:return{header:async()=>{},description:void 0,successfulResponse:(0,n.qPG)(),unsuccessfulResponse:(0,n.Py2)()}}}function M(e){switch(e){case i.ye.RowMajor:return{singleErrorMessage:(0,n.DIq)(),multipleErrorMessage:(0,n.NXr)(),header:(0,n.L0V)()};case i.ye.HeaderColumns:return{singleErrorMessage:(0,n.ujQ)(),multipleErrorMessage:(0,n.kMm)(),header:(0,n.pOf)()};case i.ye.HasMergedCells:return{singleErrorMessage:(0,n.ZkE)(),multipleErrorMessage:(0,n.Thz)(),header:(0,n.C$7)()};case i.ye.UnsupportedAggregations:case i.ye.TotalsRow:return{singleErrorMessage:(0,n.qre)(),multipleErrorMessage:(0,n.Gp3)(),header:(0,n.Pxj)()};case i.ye.NoHeaderRow:return{singleErrorMessage:(0,n.ujQ)(),multipleErrorMessage:(0,n.kMm)(),header:(0,n.pOf)()};case i.ye.MultipleHeaderRows:return{singleErrorMessage:(0,n.nMc)(),multipleErrorMessage:(0,n.pP4)(),header:(0,n.mcb)()};case i.ye.EmptyHeaders:return{singleErrorMessage:(0,n.jLG)(),multipleErrorMessage:(0,n.z56)(),header:(0,n.mJ6)()};case i.ye.DuplicateHeaders:return{singleErrorMessage:(0,n.Tlk)(),multipleErrorMessage:(0,n.Dh1)(),header:(0,n.c_T)()};case i.ye.Crosstab:return{singleErrorMessage:(0,n.up8)(),multipleErrorMessage:(0,n.ev2)(),header:(0,n.h_t)()};case i.ye.MultipleHeaderColumns:case i.ye.NoHeaderColumn:case i.ye.HeaderRows:case i.ye.LowInterpretationConfidence:return{singleErrorMessage:(0,n.c7Y)(),multipleErrorMessage:(0,n.GIT)(),header:(0,n.vkL)()};case i.ye.Unrecognized:default:{const e=o.p.getInstanceNoCreate();return e&&!e.isModelWorkflowSupported?{singleErrorMessage:(0,n.YMx)(),multipleErrorMessage:void 0,header:void 0}:{singleErrorMessage:(0,n.eGo)(),multipleErrorMessage:void 0,header:void 0}}}}async function D(){const e=await(0,u.ge)(),t=e.length;let a;if(0===t)a=(0,g.VY)((0,n.yo8)(),{count:""});else if(t>2)a=(0,g.VY)((0,n.yo8)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,m.r)(e)));a=(0,g.VY)((0,n.qp3)(),{range1:t,range2:o})}else{const t=(0,m.r)(e[0]);a=(0,g.VY)((0,n.ay0)(),{range:t})}return a}const $=[[i.ye.HeaderColumns,i.ye.NoHeaderRow],[i.ye.TotalsRow,i.ye.UnsupportedAggregations]],B={[i.ye.EmptyHeaders]:[i.ye.HasMergedCells,i.ye.UnsupportedAggregations,i.ye.MultipleHeaderRows],[i.ye.Crosstab]:[i.ye.HasMergedCells,i.ye.UnsupportedAggregations,i.ye.MultipleHeaderRows]};function H(e,t){if(e===t)return!0;if(!e.includes("!")||!t.includes("!"))return!1;if(r.ExcelCalc.sheetNameFromSheetAddresses(e)!==r.ExcelCalc.sheetNameFromSheetAddresses(t))return!1;return q(r.ExcelCalc.addressToExcelRange((0,s.G2)(e)),r.ExcelCalc.addressToExcelRange((0,s.G2)(t)))}function U(e,t){if(e===t.name)return!0;if(!e.includes("!"))return!1;if(r.ExcelCalc.sheetNameFromSheetAddresses(e)!==r.ExcelCalc.sheetNameFromSheetAddresses(t.name))return!1;return q(r.ExcelCalc.addressToExcelRange((0,s.G2)(e)),t.range)}function q(e,t){if(!b(e)||!b(t))return!1;if(!r.ExcelCalc.IExcelRangeIntersect(e,t))return!1;const a=Math.abs(e.topLeft.row-t.topLeft.row),n=Math.abs(e.bottomRight.row-t.bottomRight.row);return a<=1&&n<=1}function V(e){const t=[i.ye.UnsupportedAggregations,i.ye.HeaderColumns,i.ye.Crosstab,i.ye.MultipleHeaderRows,i.ye.EmptyHeaders,i.ye.DuplicateHeaders,i.ye.HasMergedCells];return(0,d.yw)("OfficeVSO_9271220_sortTLRErrorMessages")?e.sort((function(e,a){let n=t.indexOf(e),o=t.indexOf(a);return-1===n&&(n=t.length),-1===o&&(o=t.length),n-o})):e}},8338:(e,t,a)=>{var n,o;a.d(t,{O:()=>n,f:()=>o}),function(e){e.MissingIntent="MissingIntent",e.NoIntentNeeded="NoIntentNeeded",e.UnhandledIntent="Missing intent string"}(n||(n={})),function(e){e.Never="Never"}(o||(o={}))},70364:(e,t,a)=>{a.d(t,{$r:()=>d,F5:()=>g,TA:()=>u,tN:()=>m});var n=a(89099),o=a(24220),r=a(88179),i=a(63395),l=a(31030),s=a(48314),c=a(92779);async function d(e,{delayForCellEdit:t=!0,operationTimers:a=new i.q}={}){try{return await a.measure("openUndoScope",Excel.run({delayForCellEdit:t},(async t=>{await a.measure("undoScope.open",t.application.undoScope.open(e))})))}catch(e){s.M.getInstance().logError({eventType:l.S.ChatEvents,errorMessage:`ctx.application.undoScope.open() failed with code ${e.code}`,logLevel:r.$b.Warning})}}async function u({delayForCellEdit:e=!0,operationTimers:t=new i.q}={}){try{return await t.measure("closeUndoScope",Excel.run({delayForCellEdit:e},(async e=>{await t.measure("undoScope.close",e.application.undoScope.close())})))}catch(e){s.M.getInstance().logError({eventType:l.S.ChatEvents,errorMessage:`ctx.application.undoScope.close() failed with code ${e.code}`,logLevel:r.$b.Warning})}}async function m(e){try{return await Excel.run({delayForCellEdit:!0},(async e=>{await e.application.undo()}))}catch(t){let a;switch(s.M.getInstance().logError({eventType:l.S.ChatEvents,errorMessage:`ctx.application.undo() failed with code ${t.code}`,logLevel:r.$b.Warning}),e){case r.q.CalculatedColumns:case r.q.CalculatedRows:a=n.c.Undo_Calculated_Columns_Error;break;case r.q.AnalyzeData:a=n.c.Analyze_Data_Undo_Failed;break;case r.q.Commanding:a=n.c.Command_Execution_Undo_Failed;break;case r.q.ContextInference:a=n.c.TLR_Auto_Fix_Undo_Failed}a&&s.M.getInstance().logStandardizedAshaErrorEvent(o.W.User_Input_Could_Not_Be_Processed,a,s.M.getInstance().getStandardizedFeatureForSubFeature(e))}}async function g(e,{delayForCellEdit:t=!0,operationTimers:a=new i.q}={}){a.start("total");try{await d((0,c.Eyh)(),{delayForCellEdit:t,operationTimers:a});const n=await a.measure("batch",Excel.run({delayForCellEdit:t},e));return await a.measure("forcesOnUndoChanged",Excel.run({delayForCellEdit:t},(async e=>{await e.sync()}))),n}finally{await u({delayForCellEdit:t,operationTimers:a}),a.end("total")}}},61150:(e,t,a)=>{a.d(t,{BC:()=>f,K_:()=>h,Pk:()=>u,SA:()=>p,cY:()=>b,g5:()=>C,gZ:()=>y,hX:()=>d,kc:()=>m,qw:()=>g,uk:()=>c});var n=a(51319),o=a(92779),r=a(5550),i=a(67022),l=a.n(i),s=a(58651);function c(e){return new Promise(((t,a)=>{setTimeout((()=>{t()}),e)}))}function d(e){return null==e}function u(e){return void 0===e||0===e.length}function m(e){return 0!==e.length&&!e.every((t=>e[0].agent===n.w2.OfficeScripts||e[0].agent===n.w2.OfficeJS||e[0].agent===n.w2.UnsupportedEvent?t.agent===n.w2.OfficeScripts||t.agent===n.w2.OfficeJS||t.agent===n.w2.UnsupportedEvent:t.agent===e[0].agent))}function g(e){return e.every((e=>e.agent===n.w2.OfficeScripts))}const h=()=>o.MYv||(0,r.I_)()||(0,r.B2)();var p;function b(e,...t){if(!h())return;let a="info";e&&Object.values(p).includes(e)?a=e:e&&t.unshift(e);const n="Excel Copilot Chat";switch(a){case"verbose":s.debug(`${n}`,...t);break;case"warning":s.warn(`${n}`,...t);break;case"error":s.error(`${n}`,...t);break;default:s.log(`${n}:`,...t)}}function f(e,t,a,n){return e?C(t,a,n):t}function C(e,t,a){const n=l()(e,t,a);return async(...e)=>{const t=n(...e);return void 0===t?Promise.resolve():t}}function y(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}!function(e){e.Verbose="verbose",e.Info="info",e.Warning="warning",e.Error="error"}(p||(p={}))},20456:(e,t,a)=>{a.d(t,{D:()=>qn,A:()=>Vn});var n,o=a(72483);!function(e){e[e.Enabled=0]="Enabled",e[e.DisabledNewWorkbook=1]="DisabledNewWorkbook",e[e.DisabledAutoSaveOff=2]="DisabledAutoSaveOff",e[e.DisabledSharedLock=4]="DisabledSharedLock",e[e.DisabledLocalFile=8]="DisabledLocalFile",e[e.DisabledPrerequisitesPending=16]="DisabledPrerequisitesPending",e[e.DisabledAugLoopPending=32]="DisabledAugLoopPending",e[e.DisabledUnsupportedLocale=64]="DisabledUnsupportedLocale",e[e.DisabledUserChanged=128]="DisabledUserChanged",e[e.DisabledVisibility=256]="DisabledVisibility",e[e.DisabledUnknownPrerequisite=512]="DisabledUnknownPrerequisite",e[e.DisabledAugLoopPermanentError=1024]="DisabledAugLoopPermanentError",e[e.DisabledUploadNotAllowedForClp=2048]="DisabledUploadNotAllowedForClp",e[e.DisabledDialogSheetExists=4096]="DisabledDialogSheetExists",e[e.DisabledThirdPartyHost=8192]="DisabledThirdPartyHost"}(n||(n={}));var r=a(92779),i=a(17678),l=a(41519),s=a(88027),c=a(13922),d=a(49118),u=a(35571),m=a(78226),g=a(50347),h=a(50751),p=a(658),b=a(61150);async function f(e){const t={cmdType:e};(0,b.cY)("Sending message to host: "+JSON.stringify(t)),await Excel.run((async e=>{e.workbook.settings.add("msgToExcel",t)}))}var C=a(51853),y=a(8520);const v=(0,p.n)({chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:"transparent"}}),T=({copilotState:e})=>(0,g.yw)("OfficeVSO_9341486_UnsupportedFileLocation")&&e&n.DisabledThirdPartyHost?y.createElement(i.A,{headerText:(0,r.DyN)(),descriptionTextList:[(0,r.gk_)()],icon:(0,u.A)(m.wrX,m.UhZ)}):(e&(n.DisabledNewWorkbook|n.DisabledAutoSaveOff|n.DisabledLocalFile))!==n.Enabled?y.createElement(i.A,{headerText:(0,r.tDq)(),descriptionTextList:[(0,r.USL)()],buttonTitle:(0,r.mT9)(),onClick:()=>{f("EnableAutoSave")},icon:(0,u.A)(m.wrX,m.UhZ)}):(0,g.yw)("OfficeVSO_9185107_DisabledDialogSheetError")&&e&n.DisabledDialogSheetExists?y.createElement(i.A,{headerText:(0,r.v01)(),descriptionTextList:[(0,r.UEB)()],icon:(0,u.A)(m.wrX,m.UhZ)}):(e&(n.DisabledAugLoopPermanentError|n.DisabledSharedLock))!==n.Enabled?y.createElement(i.A,{headerText:(0,r.Vx2)(),descriptionTextList:[(0,r.HTR)()],icon:(0,u.A)(m.wrX,m.UhZ)}):(window.document.getElementById(r.OsU)?.style.removeProperty("display"),y.createElement("div",null)),x=({copilotState:e,theme:t,isHighContrast:a})=>{const[n,r]=y.useState((0,h.eS)(t,a)),i=v();return y.useEffect((()=>{t!==l.G.defaultWhite?(0,s.N_)(l.G.defaultBlack):(0,s.N_)(l.G.defaultWhite),(0,s.uj)(a),r((0,h.eS)(t,a))}),[t,a]),y.useEffect((()=>(o.$.getInstance().clearLoadingPaneTimeout(),(0,g.yw)("OfficeVSO_9255610_TimeStampLogAfterAutoSaveTurnedOn")?((0,C.oO)((new Date).getTime().toString()),()=>{o.$.getInstance().startLoadingPaneTimeout(!0),(0,C.Gr)((new Date).getTime().toString())}):()=>{o.$.getInstance().startLoadingPaneTimeout(!0)})),[]),y.createElement(c.N,{theme:n},y.createElement(d.W,{reverse:!0,style:i.chatUiStack},y.createElement(T,{copilotState:e})))};var S=a(28679),w=a.n(S),E=a(22180),R=a.n(E),I=a(87720),A=a.n(I),L=a(34159),F=a.n(L),_=a(11843),N=a.n(_),k=a(79216),O=a.n(k),P=a(27639),M={};M.styleTagTransform=O(),M.setAttributes=F(),M.insert=A().bind(null,"head"),M.domAPI=R(),M.insertStyleElement=N();w()(P.A,M);P.A&&P.A.locals&&P.A.locals;var D=a(77303),$=a(82729),B=a(34813),H=a(27908),U=a(26856),q=a(22330),V=a(18712),G=a(4787),W=a(94754),z=a(36130),Q=a(31238),J=a(61437),j=a(29348),Y=a(5550),X=a(4475),K=a(88179),Z=a(25433);const ee=e=>{const t=(0,D.Zl2)((()=>Promise.all([a.e("editor"),a.e("augloop-chunk"),a.e("office-iss"),a.e("vendors~shared"),a.e("vendors~ReviewerAgent"),a.e("ReviewerAgent")]).then(a.bind(a,46477)).then((e=>({default:e.ReviewerAgent})))),"ReviewerAgent");return y.createElement(y.Suspense,{fallback:y.createElement(y.Fragment,null)},y.createElement(t,e))};var te=a(79029),ae=a(48314),ne=a(29328),oe=a(47693),re=a(52983),ie=a(54738),le=a(93901),se=a(73405),ce=a(31030),de=a(98100);const ue=(e,t)=>e?.length>50?y.createElement(y.Fragment,null,y.createElement("span",{title:e},t?(0,de.Yp)(e):e),y.createElement(re.i,{getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})})})):y.createElement("span",null,e??"-"),me=e=>{try{return JSON.stringify(e,void 0,4)}catch(t){return e}},ge=(e,t,a)=>y.createElement("div",null,y.createElement(ie.B,{horizontal:!0,horizontalAlign:"space-between"},y.createElement("span",{style:{maxWidth:"90%",overflow:"hidden"},title:e},e),y.createElement("span",{style:{color:a,paddingRight:"3px"}},ue(t,!0)))),he=(e,t)=>ge(e,t?"Active":"Inactive",t?"green":"red");function pe(){const e=oe.$.getInstance(),[t,a]=(0,y.useState)(e.updatesFromAugloopCount),[n,o]=(0,y.useState)(e.blockAnnotationReleaseMessageEnabled),[r,i]=(0,y.useState)(e.autoRefreshEnabled),l=e.getSessionsMap(),s=()=>{a(t+1)};return e.registerUIUpdater(s),y.createElement("div",{className:"AugloopDiganosticsPaneContainer"},y.createElement(le.K,{title:"Force Refresh",iconProps:{iconName:"Refresh"},onClick:async()=>{await e.refreshSessionDiagnosticsData(),s()}}),y.createElement(se.d,{checked:r,onChange:t=>{e.autoRefreshEnabled=t.currentTarget.checked,i(t.currentTarget.checked),ae.M.getInstance()?.logEvent({eventType:ce.S.AugloopDiagnostics,eventData:[{key:"autoRefreshEnabled",value:t.currentTarget.checked}]})},label:"Auto Refresh",title:"Auto refresh the diagnostics on websocket activity"}),y.createElement(se.d,{checked:n,onChange:t=>{e.blockAnnotationReleaseMessageEnabled=t.currentTarget.checked,o(t.currentTarget.checked)},label:"Block Annotations Release",title:"CommunicationHandler to block annotations release messages"}),y.createElement("ul",{className:"tree"},Array.from(l.keys()).map((e=>{const t=l.get(e);return y.createElement("li",{key:e},y.createElement("details",{open:!0},y.createElement("summary",null,"SessionKey: ",e),he("Status:",t.isActive),y.createElement("ul",null,y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Session Info"),y.createElement("ul",null,y.createElement("li",null,ge("sessionMode",t.sessionMode)),y.createElement("li",null,ge("isCopilotLicensed",t.isCopilotLicensed?.toString())),y.createElement("li",null,ge("isCopilotActivated",t.isCopilotActivated?.toString())),y.createElement("li",null,ge("isLargeWorkbookSession",t.isLargeWorkbookSession?.toString())),y.createElement("li",null,ge("observerSessionType",t.observerSessionType)),y.createElement("li",null,ge("ecsSessionId",t.ecsSessionId)),y.createElement("li",null,ge("ecsStateId",t.ecsStateId)),y.createElement("li",null,ge("uiLanguage",t.clientMetadata?.uiLanguage)),y.createElement("li",null,ge("docSessionId",t.clientMetadata?.docSessionId)),y.createElement("li",null,ge("documentId",t.clientMetadata?.documentId)),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Client Flights"),y.createElement("ul",null,t.clientMetadata?.flights?.split(";").map((e=>{if(0!==e.length)return y.createElement("li",{key:e},ue(e,!1))})))))))),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Annotations Status"),y.createElement("ul",null,Array.from(t.annotationActivationStatus.keys()).map((e=>y.createElement("li",{key:e},he(e,t.annotationActivationStatus.get(e)))))))),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Annotations Activations (",t.activatedAnnotationTypes.size,"):"),y.createElement("ul",null,Array.from(t.activatedAnnotationTypes.keys()).map((e=>y.createElement("li",{key:e},ge(e,t.activatedAnnotationTypes.get(e)))))))),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Annotations Releases (",t.releasedAnnotationTypes.size,"):"),y.createElement("ul",null,Array.from(t.releasedAnnotationTypes.keys()).map((e=>y.createElement("li",{key:e},ge(e,t.releasedAnnotationTypes.get(e)))))))),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Annotations Received (",t.annotationsReceived.size,"):"),y.createElement("ul",null,Array.from(t.annotationsReceived.keys()).map((e=>{const a=t.annotationsReceived.get(e).length;return y.createElement("li",{key:e},y.createElement("details",null,y.createElement("summary",null,`${e} (${a})`),y.createElement("ul",null,Array.from(t.annotationsReceived.get(e)??[]).map((e=>{const t=JSON.stringify(e);return y.createElement("li",{key:t},y.createElement("details",null,y.createElement("summary",null,ue(t,!0)),y.createElement("pre",null,me(e))))})))))}))))),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Custom Messages Sent (",t.clientSentMessages.size,"):"),y.createElement("ul",null,Array.from(t.clientSentMessages.keys()).map((e=>y.createElement("li",{key:e},y.createElement("details",null,y.createElement("summary",null,`${e} (${t.clientSentMessages.get(e)?.length})`),y.createElement("ul",null,Array.from(t.clientSentMessages.get(e)).map((e=>{const t=JSON.stringify(e);return y.createElement("li",{key:t},y.createElement("details",null,y.createElement("summary",null,ue(t,!0)),y.createElement("pre",null,me(e))))})))))))))),y.createElement("li",null,y.createElement("details",null,y.createElement("summary",null,"Connection Messages (",t.connectionMessages.length,"):"),y.createElement("ul",null,t.connectionMessages.map((e=>{const t=JSON.parse(e);return y.createElement("li",{key:e},y.createElement("details",null,y.createElement("summary",null,ue(e,!0)),y.createElement("pre",null,me(t))))}))))))))}))))}var be=a(71848);const fe="http://www.w3.org/2000/svg",Ce="#dddddd";class ye{constructor(e,t){this.name=e,this.label=JSON.stringify(t,void 0,4),this.path=[...t.parentPath,t.id],this.parentPath=t.parentPath,this.children=[],this.hidden=!1,this.numberOfRows=0}}function ve(e){0===e.children.length?e.numberOfRows=1:(e.numberOfRows=e.children.filter((e=>!e.hidden)).reduce(((e,t)=>(ve(t),e+t.numberOfRows)),0),0===e.numberOfRows&&(e.numberOfRows=1))}function Te(e){return 0===e.children.length?1:1+Math.max(...e.children.map(Te))}function xe(e,t){const a=260,n=8,o=25,r=function(e){let t;const a=new Map;if(e.forEach((e=>{const t=new ye(e.id,e);a.set(t.path.join("/"),t)})),Array.from(a.keys()).forEach((e=>{const n=a.get(e);if(0===n.parentPath.length)t=n;else{const t=n.parentPath.join("/"),o=a.get(t);if(!o)throw new Error(`mapAugloopModelToTreeNode: Parent node not found for node ${e}`);o.children.push(n)}})),!t)throw new Error("mapAugloopModelToTreeNode: Root node not found");return t}(t),i=document.createElementNS(fe,"svg"),l=document.createElementNS(fe,"g");l.setAttribute("transform","translate(40,0)"),i.appendChild(l);const s=e=>e.numberOfRows*(o+5);function c(e,t,r,i){if(e.hidden)return;const s=document.createElementNS(fe,"g");s.setAttribute("transform",`translate(${t},${r})`);const u=document.createElementNS(fe,"title");u.textContent=e.label,s.appendChild(u);const m=document.createElementNS(fe,"circle");m.setAttribute("r","6"),m.setAttribute("fill",0===e.children?.length?"#dddddd":"#8096c3"),s.appendChild(m);const g=document.createElementNS(fe,"text");if(g.setAttribute("dy","3"),g.setAttribute("x",n.toString()),g.setAttribute("fill","black"),g.textContent=(0,de.Yp)(e.name),s.appendChild(g),e.children.length>0){s.style.cursor="pointer",s.addEventListener("click",(()=>{e.children.forEach((e=>{e.hidden=!e.hidden})),d()}));const n=t+a;let u=r-e.numberOfRows/2*o;e.children.filter((e=>!e.hidden)).forEach((e=>{const a=u+e.numberOfRows/2*o;u=a+e.numberOfRows/2*o;const s=function(e,t,a,n){const o=document.createElementNS(fe,"path"),r=Math.abs(a-e)/2,i=`M${e},${t} C${e+r},${t} ${a-r},${n} ${a},${n}`;return o.setAttribute("d",i),o.setAttribute("stroke",Ce),o.setAttribute("fill","none"),o.setAttribute("class","link"),o}(t,r,n,a);l.appendChild(s),c(e,n,a,i+1)}))}l.appendChild(s)}function d(){for(;l.firstChild;)l.removeChild(l.firstChild);if(!r)throw new Error("updateTree: Tree is undefined");ve(r);const e=Te(r)*(a+n),t=s(r);i.setAttribute("width",e.toString()),i.setAttribute("height",t.toString()),c(r,0,t/2,0)}d(),e.replaceChildren(i),null!==e.parentElement&&(e.parentElement.scrollTop+=s(r)/2)}const Se=async()=>{try{const e=oe.$.getInstance(),t=await e.retrieveModelFromAugloop();if(void 0===t.stringifiedModel)throw new Error("showModelVisualization: Stringified model is undefined");const a=JSON.parse(t.stringifiedModel),n=document.getElementById("augloopModelContainer");if(!n)return void(0,b.cY)(K.$b.Error,"Model container element not found");xe(n,a)}catch(e){(0,b.cY)(K.$b.Error,`Failed to visualize model: ${e}`)}};function we(){const e=oe.$.getInstance().getActiveSessionKey();return y.createElement("div",{className:"AugloopDiganosticsPaneContainer"},y.createElement("strong",null,"Active SessionKey:"),y.createElement("br",null),y.createElement("span",null,e),y.createElement("br",null),y.createElement(be.r,{iconProps:{iconName:"VisioDiagram"},allowDisabledFocus:!0,disabled:e===oe.b,onClick:Se},"Visualize model"),y.createElement("br",null),y.createElement("div",{id:"augloopModelContainer"}))}var Ee=a(44088),Re=a(79195),Ie=a(3677),Ae=a(64223),Le=a(76645),Fe=a(81349),_e=a(51423),Ne=a(77252),ke=a(48739),Oe=a(39897),Pe=a(59573),Me=a(96774),De=a(47691),$e=a(3167),Be=a(98817),He=a(40707),Ue=a(11107),qe=a(90216),Ve=a(55427),Ge=a(67560),We=a(36505),ze=a(13383),Qe=a(69723),Je=a(69109),je=a(86691),Ye=a(88700),Xe=a(45857),Ke=a(74540),Ze=a(84654),et=a(49462);const tt=(0,p.n)({devStack:{margin:"32px"}}),at=e=>{window.open(e,"_blank")},nt=async e=>{try{await navigator.clipboard.writeText(e)}catch(e){(0,b.cY)("Failed to copy text to clipboard:",e)}},ot=({isModalOpen:e,setIsModalOpen:t,sessionId:a,augloopSessionKey:n,sydneyConversationId:o,sydneyEndpoint:r})=>{const i=`https://turingbot.sdf-master.substrate-turing-turingbot.westus3-sdf.cosmic-ppe.office.net/turingbot/ui?debug=true&sourceConversationId=${o}`,l=`https://dataexplorer.azure.com/dashboards/c5389d47-6569-4e8d-bcec-4057c569820e?p-_sessionIds=v-${a}#19773814-791b-4a1c-a2ef-d1f66b692f6e`;return y.createElement(Ne.l,{open:e,onOpenChange:(e,a)=>{t(a.open)}},y.createElement(ke.E,null,y.createElement(Oe.R,null,y.createElement(Pe.L,{action:y.createElement(Me.z,{action:"close"},y.createElement(De.$,{appearance:"subtle","aria-label":"Close",icon:y.createElement(je.Jtj,null)}))},"Session Info"),y.createElement($e.C,null,y.createElement("div",null,y.createElement("b",null,"Session Id:")," ",a,a&&y.createElement(Be.m,{content:"Copy",relationship:"label"},y.createElement(De.$,{"aria-label":"Copy",icon:y.createElement(Ye.Jg_,null),appearance:"subtle",onClick:()=>nt(a)}))),y.createElement("div",null,y.createElement("b",null,"Augloop Session Key:")," ",n,n&&y.createElement(Be.m,{content:"Copy",relationship:"label"},y.createElement(De.$,{"aria-label":"Copy",icon:y.createElement(Ye.Jg_,null),appearance:"subtle",onClick:()=>nt(n)}))),y.createElement("div",null,y.createElement("b",null,"Sydney Conversation Id:")," ",o,o&&y.createElement(Be.m,{content:"Copy",relationship:"label"},y.createElement(De.$,{"aria-label":"Copy",icon:y.createElement(Ye.Jg_,null),appearance:"subtle",onClick:()=>nt(o)}))),y.createElement("div",null,y.createElement("b",null,"Sydney Endpoint:")," ",r),y.createElement("div",null,a&&y.createElement("div",null,y.createElement("b",null,"Kusto Dashboard: "),y.createElement(Ke.N,{onClick:()=>at(l)},"Excel Copilot Shield Session Explorer"))),y.createElement("div",null,o&&y.createElement("div",null,y.createElement("b",null,"Sydney Dashboard: "),y.createElement(Ke.N,{onClick:()=>at(i)},"DevUI Session Explorer")))))))},rt=({isModalOpen:e,setIsModalOpen:t,sessionId:a,queryMetrics:n})=>y.createElement(Ne.l,{open:e,onOpenChange:(e,a)=>{t(a.open)}},y.createElement(ke.E,{style:{maxWidth:"1000px",inset:"8px"}},y.createElement(Oe.R,null,y.createElement(Pe.L,{action:y.createElement(Me.z,{action:"close"},y.createElement(De.$,{appearance:"subtle","aria-label":"Close",icon:y.createElement(je.Jtj,null)}))},y.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},y.createElement("span",null,"Session Queries"),y.createElement(De.$,{"aria-label":"Download",size:"medium",icon:y.createElement(ne.eiB,null),onClick:()=>(async(e,t)=>{const a=new Blob([JSON.stringify(t)],{type:"application/json"}),n=window.URL.createObjectURL(a),o=document.createElement("a");o.href=n,o.download="query-telemetry"+(e?"-"+e:"")+".json",o.click()})(a,n)},"Download"))),y.createElement($e.C,null,it(n))))),it=e=>y.createElement(He.n,{multiple:!0,collapsible:!0},Object.entries(e).map((([e,{userUtterance:t,metrics:a}])=>y.createElement(Ue.A,{key:e,value:e},y.createElement(qe.u,{icon:y.createElement(Xe.Roy,null),size:"large",style:{overflow:"hidden"}},st(t,e)),y.createElement(Ve.v,null,lt(a)))))),lt=e=>y.createElement(He.n,{multiple:!0,collapsible:!0},e.map(((e,t)=>y.createElement(Ue.A,{key:t,value:t},y.createElement(qe.u,null,ct(e)),y.createElement(Ve.v,null,y.createElement(ie.B,null,y.createElement(Ge.D,{label:"Input"},y.createElement(ie.B,{horizontal:!0},y.createElement(We.T,{contentEditable:!1,resize:"vertical",style:{width:"100%"}},dt(e.input)),y.createElement(Be.m,{content:"Copy",relationship:"label"},y.createElement(De.$,{"aria-label":"Copy",icon:y.createElement(Ye.k8e,null),onClick:()=>nt(dt(e.input))})))),y.createElement(Ge.D,{label:"Output"},y.createElement(ie.B,{horizontal:!0},y.createElement(We.T,{contentEditable:!1,resize:"vertical",style:{width:"100%"}},dt(e.output)),y.createElement(Be.m,{content:"Copy",relationship:"label"},y.createElement(De.$,{"aria-label":"Copy",icon:y.createElement(Ye.k8e,null),onClick:()=>nt(dt(e.output))})))))))))),st=(e,t)=>y.createElement("div",{"aria-label":e,role:"button",tabIndex:0},y.createElement(ze.Q,{truncate:!0,wrap:!1},e),y.createElement("br",null),y.createElement(Qe.M,null,"[queryId: ",t,"]")),ct=e=>{let t=`${e.serviceName}:${e.metricType}`;if("PolymerLLMImprovedNetworking"===e.serviceName||"DeepLeoImprovedNetworking"===e.serviceName){t=`Sydney:${e.tags.length>0?e.tags[0]:e.metricType}`}return y.createElement("div",null,y.createElement("span",null,t)," ",y.createElement("span",{style:{color:"Success"===e.status?"green":"red"}},"[",e.status,"]")," ",y.createElement("span",null,"[",e.latencyMilliseconds,"ms]"))},dt=e=>{try{const t=e.indexOf("{"),a=e.lastIndexOf("}"),n=-1!==t&&-1!==a?e.substring(t,a+1):e,o=JSON.parse(n);return o.prompt?o.prompt.replace(/\\n/g,"\n"):o.text?o.text.replace(/\\n/g,"\n"):o.choices&&o.choices.length>0?o.choices[0]?.text:JSON.stringify(o,null,2)}catch(t){return e}};function ut({setShouldShowFormulaDevButton:e}){const[t,a]=(0,y.useState)(!1),[n,o]=(0,y.useState)(!1),r=(0,et.d4)((e=>e.dataAI.shouldShowFormulaDevButton)),i=(0,Ze.u)()??"none",{alSessionKey:l,sydneyConversationId:s,sydneyEndpoint:c,queryMetrics:d}=(0,et.d4)((e=>e.telemetry)),u=tt();return y.createElement(ie.B,{className:u.devStack},(0,g.cT)()&&y.createElement(y.Fragment,null,y.createElement(De.$,{onClick:()=>a(!0)},"Show Session Info"),y.createElement(Je.c,null),y.createElement(De.$,{onClick:()=>o(!0)},"Show Query Telemetry"),y.createElement(Je.c,null)),y.createElement(se.d,{checked:r,onChange:t=>{e(t.currentTarget.checked)},label:"Formula Dev Button"}),t&&y.createElement(ot,{isModalOpen:t,setIsModalOpen:a,sessionId:i,augloopSessionKey:l,sydneyConversationId:s,sydneyEndpoint:c}),n&&y.createElement(rt,{isModalOpen:n,setIsModalOpen:o,sessionId:i,queryMetrics:d}))}var mt=a(20057),gt=a(1805),ht=a(22034),pt=a(16508),bt=a(45283),ft=a(26115),Ct=a(57244),yt=a(88220);const vt=(0,p.n)({list:{paddingTop:"4px",paddingBottom:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",backgroundColor:"transparent"},item:{backgroundColor:"transparent","&:hover":{backgroundColor:h.k1.colorNeutralBackground2Hover,color:h.k1.colorNeutralForeground2Hover}}});function Tt({setCannedOption:e,getCannedOption:t}){const[a,n]=y.useState({skillOverride:[t()??"no-override"]}),o=vt();return y.createElement("div",{className:o.list},y.createElement(Ct.c,{checkedValues:a,onCheckedValueChange:(t,{name:a,checkedItems:o})=>{o[0]&&"no-override"!==o[0]?e(o[0]):e(),n({[a]:o})}},y.createElement(yt.s,{name:"skillOverride",value:"flux-getInsights",className:o.item},"Use the Analyze Data skill directly"),y.createElement(yt.s,{name:"skillOverride",value:"flux-createCalculatedColumns",className:o.item},"Use the Calculated Columns skill directly"),y.createElement(yt.s,{name:"skillOverride",value:"flux-editDocument",className:o.item},"Use the Commanding skill directly"),(0,g.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1)&&y.createElement(yt.s,{name:"skillOverride",value:"flux-dataShaping",className:o.item},"Use the Data Shaping skill directly"),y.createElement(yt.s,{name:"skillOverride",value:"python",className:o.item},"Use the Python skill directly"),y.createElement(yt.s,{name:"skillOverride",value:"flux-createCalculatedCell",className:o.item},"Use the Column Aggregation skill directly"),y.createElement(yt.s,{name:"skillOverride",value:"no-override",className:o.item},"No override")))}var xt=a(16144),St=a(23147),wt=a(24180),Et=a(41102),Rt=a(80519),It=a(22551),At=a(6925),Lt=a(78640),Ft=a(98483);const _t=async e=>{const t=(0,Ft.A)();e(At.mF.setLatestRequestId(t)),e(wt.m.startFetching(t)),e(At.mF.startExecutingCommand({command:K.OP.CalculatedColumns,id:t})),e(wt.m.setActiveRequestType(Rt.Yw.GeneralFormula)),e(wt.m.onFormulaSuggestionAnnotationReceived(kt(t,"1",["1"],["link"],["=SOME_FORMULA()"],[["1"],["2"]]))),e(At.mF.stopExecutingAndReleaseContextLock())};function Nt(e,t){const a=e.sheetRange.range.topLeft.row+1+1,n=e.sheetRange.range.bottomRight.row+1,o=[];for(let e=a;e<=n;e++)o.push(""+e*t);return o}const kt=(e,t,a,n,o,r)=>({calculatedColumns:a.map(((e,t)=>({id:e,columnName:n[t],formula:o[t],title:"Mock Title",numberFormat:"0.0",description:"<p>Mock Description.</p>",formulaExplanation:"<p>This is just a mock formula:</p>\n<ul>\n<li>It is only enabled in local SDX.</li>\n<li>It is hardcoded and does not come from LLM.</li>\n<li>The value changes every time.</li>\n</ul>"}))),isAlternativeSuggestion:!1,previewValues:r,requestId:e,suggestionId:t,suggestionMetadata:{result:It.sR.Success},success:!0,H_:{T_:"AugLoop_ExcelIntelligence_CalculatedColumnSuggestion",B_:["AugLoop_Core_Annotation"]},ownerId:"ExcelIntelligenceSignal"}),Ot=(e,t,a,n,o)=>({calculatedCells:a.map(((e,t)=>({id:e,formula:n[t],insertionIndexes:[1],title:"Mock Title",numberFormat:"0.0",description:"<p>Mock Description.</p>",formulaExplanation:"<p>This is just a mock formula:</p>\n<ul>\n<li>It is only enabled in local SDX.</li>\n<li>It is hardcoded and does not come from LLM.</li>\n<li>The value changes every time.</li>\n</ul>"}))),isAlternativeSuggestion:!1,previewValues:o,requestId:e,suggestionId:t,suggestionMetadata:{result:It.sR.Success},success:!0,H_:{T_:"AugLoop_ExcelIntelligence_CalculatedCellSuggestion",B_:["AugLoop_Core_Annotation"]},metadata:{result:It.sR.Success},ownerId:"ExcelIntelligenceSignal"});var Pt=a(59824),Mt=a(59777),Dt=a(28087),$t=a(33500),Bt=a(80132),Ht=a(96710),Ut=a(71362);const qt=["Sort column A","Format table red"];async function Vt(){}const Gt=async()=>{const{message:e,telemetry:t}=Ut.n.getCommandingHumanInTheLoopResponse(qt,Vt);o.$.getInstance().displayResponse(e,t)},Wt=async()=>{const e=[{title:"Custom Formula: ",explanation:"Apply formatting using formula below",conditionalFormatResponseCardData:{cardTitle:Ht.D.CustomCreated,customFormat:{BackgroundColor:"#000000",TextColor:"#FFFFFF",IsTextBold:!1,IsTextItalic:!1,IsTextStrikethrough:!1,IsTextUnderlined:!1,IsTextDoubleUnderlined:!1,BorderFormat:{Position:15,LineStyle:[0,0,0,0],Color:[0,0,0,0],ThemeBorderColor:[{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0}],ColorTypeOption:0,Thickness:[0,0,0,0]},PreserveBackgroundColor:!1,PreserveTextColor:!1},customFormula:"=$E2 > $F2",formulaExplanation:"If E2 is greater than F2"},subExplanations:["Format1","Format2"]}],{message:t,telemetry:a}=Ut.n.getCommandingCFHumanInTheLoopResponse(e,qt,Vt);o.$.getInstance().displayResponse(t,a)},zt=async()=>{const{message:e,telemetry:t}=Ut.n.getConditionalFormattingSuggestionsResponseMessage([{Description:"Highlight cells below average in column 'Total Budget and Revenue'",TableName:"Table1",ColumnID:1,Key:"Average/Below"},{Description:"Highlight top 3 in column 'Column1'",TableName:"Table1",ColumnID:1,Key:"TopBottom/Top"}],void 0,"Okay! Here are some conditional formatting suggestions for data in {0}","guid");o.$.getInstance().displayResponse(e,t)};var Qt=a(8069),Jt=a(64216);const jt={status:-1,conversationSensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},messagesToAddOrReplace:[{actionId:null,action:null,sourceRequestId:null,isCancelOption:!1,text:'enterprise search whats in excel file "FF document.xlsx" ?',author:"user",from:{id:null,name:null,partnerId:null},createdAt:"2024-09-29T13:04:27.4783232+00:00",timestamp:"2024-09-29T13:04:26.168+00:00",locale:"en-us",market:"en-us",region:"us",locationInfo:{timeZone:"America/New_York"},messageId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",messageType:"Chat",experienceType:"Default",offense:"None",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"AugmentationLoop",groundingDataCount:0,clientContext:null,inputMethod:"Keyboard",queryAnnotations:[],turnCount:8,citations:[]},{text:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1) authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1). Is there anything specific you would like to know about this file?',hiddenText:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [^1^] authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [^1^]. Is there anything specific you would like to know about this file?',author:"bot",createdAt:"2024-09-29T13:04:48.1703965+00:00",timestamp:"2024-09-29T13:04:48.1703965+00:00",messageId:"a9d573f4-1db2-4549-9efc-5bbed7672a97",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",messageType:"Chat",experienceType:"Default",offense:"Unknown",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1) authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1). Is there anything specific you would like to know about this file?',wrap:!0}]}],actionButtons:[],sourceAttributions:[{providerDisplayName:"FF document",seeMoreUrl:"https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1",path:null,referenceMetadata:'{"type":"Excel","typeDescription":"Excel","referenceType":1,"context":"Guy Yom Tov modified on 9/29/24","hasAttachments":false,"refType":"Excel","dataSource":"SharePoint","sourceType":"File","resultSearchType":"Lexical","fromTuring":"","provenance":"SharePoint","itemId":"AAAAABVT5a96BHRInZE2l1Qj0D8HAEBDCM6yMvVOoNAvcu9tJI4AAAAAASMAAEBDCM6yMvVOoNAvcu9tJI4AAAIYZZYAAA2","fileName":"FF document.xlsx","fileType":"xlsx","isEnterprise":true,"sensitivityLabel":{"id":"f42aa342-8706-4288-bd11-ebb85995028c","displayName":"General","tooltip":"Business data which is NOT meant for public consumption. This can be shared with internal employees, business guests and external partners as needed.","priority":2,"color":"#0078D7","isEncrypted":false}}'}],entityRepresentations:[],feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"DeepLeo",suggestedResponses:[{text:"What are the details of the campaigns in the 'Table1' sheet?",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970144+00:00",timestamp:"2024-09-29T13:04:49.0970144+00:00",messageId:"d78be5a0-fbd9-4f24-9b81-c4c3d6ac10bc",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null},{text:"Tell me more about Guy Yom Tov",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970187+00:00",timestamp:"2024-09-29T13:04:49.0970187+00:00",messageId:"eb5b9ee6-f0bb-4477-baec-3224021f0673",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null},{text:"What other files has Guy Yom Tov authored?",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970213+00:00",timestamp:"2024-09-29T13:04:49.0970213+00:00",messageId:"5683af45-264a-49d6-bcf6-b495398e7968",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null}],groundingDataCount:10,clientContext:null,turnCount:8,sensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},citations:[]}],resultType:"Success",sessionKey:"fde07ae5-5825-4d48-a1f2-e3831f50e889"},Yt=async e=>{const t=(0,Ft.A)(),{message:a,telemetry:n}=Ut.n.getImportDataResponse({requestId:t,dataSources:[{id:"1",type:Qt.o.ExcelFile,sourceUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",sourceLocation:"Book6",sourceParentUrl:"XLIL_Team",sourceRelativePath:"Documents/Workbooks/AL",sourceName:"Users",seeMoreUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",powerQueryScript:'let Source = Excel.Workbook(File.Contents("https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx"), null, true), Users_Table = Source{[Item="Users",Kind="Table"]}[Data], ChangedType = Table.TransformColumnTypes(Users_Table,{{"Name", type text}, {"Age", Int64.Type}, {"Gender", type text}}) in ChangedType',columns:[{name:"Name"},{name:"Age"},{name:"Gender"}],sampleRows:[["John","25","male"],["Doe","30","male"],["Jane","35","female"]]},{id:"2",type:Qt.o.ExcelFile,sourceUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",sourceLocation:"Book6",sourceName:"Movies",seeMoreUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",powerQueryScript:'let Source = Excel.Workbook(File.Contents("https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx"), null, true), Movies_Table = Source{[Item="Movies",Kind="Table"]}[Data], ChangedType = Table.TransformColumnTypes(Movies_Table,{{"Movie", type text}, {"Date of Release", Int64.Type}, {"Rating", type number}, {"Genre", type text}}) in ChangedType',sourceParentUrl:"XLIL_Team",sourceRelativePath:"Documents/Workbooks/AL",columns:[{name:"Movie"},{name:"Date of Release"},{name:"Rating"},{name:"Genre"}],sampleRows:[["The Shawshank Redemption","1994","9.3","Drama"],["The Godfather","1972","9.2","Crime"],["The Dark Knight","2008","9.0","Action"],["The Godfather: Part II","1974","9.0","Crime"],["The Lord of the Rings: The Return of the King","2003","8.9","Adventure"]]}],messageId:"",userQueryGuid:"",clpData:void 0,performedFallbackToAllTables:!1,importType:K.q.ImportDataFromSearch});e(At.mF.setLatestRequestId(t)),o.$.getInstance().displayResponse(a,n)},Xt=async e=>{Ut.n.displayPythonAdaRecommendationResponse({dispatch:e,requestId:"",code:"import pandas",codeExplanation:"This code imports the pandas library.",codeLabel:"Import the pandas library"})},Kt="âŒ",Zt=`${Kt} Unexpected Error`,ea=`${Kt}${Kt}${Kt} Test Failed`,ta="âš ï¸ Missing Test Coverage",aa="âœ… Test Passed",na=async(e,t)=>{const a=new Map(Object.keys(Bt.J3.renderers).map((e=>[e,[]]))),n="Simple Text";async function o(t,n,o,r){a.set(n,o),ia(t),await r(e)}!function(e,t,a){const n=new Map,o=new Map,r=new AbortController,i=[];setTimeout((()=>{r.abort(),function(e,t,a,n){const o=Array.from(e.entries()).sort(((e,t)=>e[0]<t[0]?-1:1)),[r,i]=oa(o,((e,t)=>a.has(e)));n.push(...r.map((([e])=>`${ea}: empty content field at '${e}' signal: ${a.get(e)}`)));const[l,s]=oa(i,((e,a)=>!t.has(e)));n.push(...l.map((([e])=>`${ta}: no '${e}' signal found`)));const[c,d]=oa(s,((e,t)=>0===t.length));n.push(...c.map((([e])=>`${ta}: no expectation set for '${e}' signals content: ${JSON.stringify(t.get(e))}`)));const[u,m]=oa(d,((e,a)=>!a.every((a=>t.get(e).some((e=>e.includes(a)))))));n.push(...u.map((([a])=>`${ea}: expected content part wasn't found in '${a}' signals. Expected: ${JSON.stringify(e.get(a))}. Actual: ${JSON.stringify(t.get(a))}`))),n.push(...m.map((([e])=>`${aa} for '${e}'`))),ia(n.join("\n"))}(e,n,o,i)}),4e3),t.debugEvents.addEventListener(String(Mt.PV.QuerySubmitted),(t=>{const r=function(e,t){if(!(e instanceof CustomEvent))return void t.push(`${Zt}: no CustomEvent: ${JSON.stringify(e)}`);const a=e.detail;if(!("operation"in a))return void t.push(`${Zt}: no operation in eventArgs: ${JSON.stringify(a)}`);const n=JSON.parse(a.operation);if(!ft.g0.typeGuard(n))return void t.push(`${Zt}: no SignalOperation: ${JSON.stringify(a)}`);const o=n.items[0]?.body;if(!o||!Pt.T.typeGuard(o))return void t.push(`${Zt}: no CopilotChatHistorySignal: ${JSON.stringify(n)}`);const r=o.operation;if(!r)return void t.push(`${Zt}: no AddMessageOperation: ${JSON.stringify(o)}`);const i=r.newMessage;if(!i)return void t.push(`${Zt}: no CopilotMessage: ${JSON.stringify(r)}`);return i}(t,i);if(!r)return;const l=function(e,t){const a=e.richTextJson;if(!a)return void t.push(`${Zt}: no richTextJson: ${JSON.stringify(e)}`);try{return JSON.parse(a)}catch(e){return void t.push(`${Zt}: bad richTextJson: ${JSON.stringify(a)}. Error: ${e}`)}}(r,i);if(!l)return;const s=r.content.trim();if(l.messageType!==Dt._.ChatCardWrapper)return 0===s.length?void o.set(a,`${JSON.stringify(r)}`):void ra(n,a,s);const c=function(e,t,a){const n=e.body.renderData;if(!n)return void a.push(`${Zt}: no renderData: ${JSON.stringify(e)}`);const o=n.component;if(!t.has(o))return void a.push(`${Zt}: Unknown renderer '${o}' in ${JSON.stringify(e)}`);return o}(l,e,i);c&&(0!==s.length?ra(n,c,s):o.set(c,`${JSON.stringify(r)}`))}),{signal:r.signal})}(a,t,n);const i=`Chat History Tests - ${(new Date).toLocaleTimeString()}`;a.set(n,[i]),ia(i),o("Import Data","ImportData_V1",[(0,r.h9u)().replace("{0}","2")],Yt),o("Python","PythonAdaRecommendation_V1",["import pandas","This code imports the pandas library","Import the pandas library"],Xt),o("Commanding HiTL","ChatCardHumanInTheLoop_V1",["Sort column A","Format table red"],Gt),o("Commanding Conditional Formatting Formula HiTL","ChatCardWithConditionalFormatting_V1",["Sort column A","Format table red","Custom Formula: Apply formatting using formula below","Format1","Format2","=$E2 > $F2","If E2 is greater than F2"],Wt),o("Commanding Conditional Formatting Suggestion","ConditionalFormattingSuggestionCard_V1",["Highlight cells below average in column 'Total Budget and Revenue'","Average/Below","Highlight top 3 in column 'Column1'","TopBottom/Top"],zt),o("Calculated Column","FormulaSuggestion_V2",["=SOME_FORMULA()"],_t)};function oa(e,t){const a=[],n=[];for(const[o,r]of e)t(o,r)?a.push([o,r]):n.push([o,r]);return[a,n]}function ra(e,t,a){e.get(t)||e.set(t,[]),e.get(t).push(a)}function ia(e){(0,b.cY)(`showUserTextCard: ${e}`),o.$.getInstance().displayResponse({chatCardType:Dt._.Default,chatMessageData:{defaultMessageProps:{user:$t.Q9.Human,messageHeader:{text:e}}}})}var la=a(46224),sa=a(98539);const ca=1,da=["English","Spanish"];async function ua(e){return Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.worksheets.getItem(e).tables.getItemAt(0).load("rows/count"),n=a.getHeaderRowRange().load("values");await t.sync();const o=n.values[0].indexOf("Query"),r=n.values[0].indexOf("Test file"),i=n.values[0].indexOf("Expected Python Code"),l=n.values[0].indexOf("Python Code"),s=[],c=a.rows.count;for(let e=0;e<c;e++){const n=a.rows.getItemAt(e).load("values");await t.sync();const c=n.values[0][r],d=n.values[0][o],u=n.values[0][i],m=n.values[0][l];s.push({testFile:c,query:d,expectedPythonCode:u,generatedPythonCode:m})}return s}))}async function ma(e,t,a,n,o,r){return Excel.run({delayForCellEdit:!0},(async i=>{const l=i.workbook.worksheets.getItem(r),s=`B${o+4}:E${o+4}`,c=l.getRange(s);return c.values=[[e,t,a,n]],await i.sync(),c}))}async function ga(e,t,a){return Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(a),r=`F${t+4}:G${t+4}`;o.getRange(r).values=[[e.result,e.reason]],await n.sync()}))}async function ha(e,t){return Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(t).getRange(`D${e+4}:E${e+4}`).load(["address","valuesAsJson"]);if(await n.sync(),"Error"===o.valuesAsJson[0][0].type)return{result:"EXPECTED_CODE_EXECUTION_ERROR",reason:""};if("Error"===o.valuesAsJson[0][1].type)return{result:"FAIL",reason:"Generated code has an error in execution"};const r=o.getPythonObjectReferenceIds();await n.sync();const i=r.value[0][0],l=r.value[0][1];if(""===i||void 0===i||""===l||void 0===l)throw new Error("getPythonObjectReferenceIds failed!");const s=await a(i),c=await a(l);return c.errorName?{result:"FAIL",reason:`Error in Python Code Execution: ${c.errorName}`}:function(e,t){const a=e.payload,n=a.value,o=a.value_type,r=t.payload,i=r.value,l=r.value_type;let s={result:"PASS",reason:""};if(e.payload.is_data_frame)if(r.is_data_frame){const e=pa(n),t=pa(i);e.numColumns===t.numColumns&&e.numRows===t.numRows||(s={result:"FAIL",reason:"DataFrames have different number of rows or columns"})}else s={result:"FAIL",reason:"Generated code should be a DataFrame."};else a.is_primitive?r.is_primitive?i===n&&l===o||(s={result:"FAIL",reason:`Expected Value/Type: ${n}/${o} doesn't match Generated Value/Type: ${i}/${l} `}):s={result:"FAIL",reason:`Generated payload should be a primitive value with value ${n}`}:l!==o&&(s={result:"FAIL",reason:`Complex Type Mismatch: ExpectedValueType: ${o}, GeneratedValueType: ${l}, `});return s}(s,c)}));async function a(e){const t=(0,la.yK)(e),a=await OfficeFirstParty.externalCodeService.executePythonCode(t),n=JSON.parse(a);let o,r;void 0!==n.error_name&&(o=n.error_name,r=n.error_message);const i=n.result;return{payload:i,value:i.value,valueType:i.value_type,errorName:o,errorMessage:r}}}function pa(e){return{numRows:e.numRows,numColumns:e.numColumns}}var ba,fa=a(97667),Ca=a(11689);!function(e){e[e.Running=0]="Running",e[e.Success=1]="Success",e[e.Failure=2]="Failure",e[e.Warning=3]="Warning"}(ba||(ba={}));const ya={0:Ie.H.info,1:Ie.H.success,2:Ie.H.error,3:Ie.H.warning},va=[Ee.YO.getTypeName(),mt.Yn.getTypeName()],Ta=async(e,t,a)=>({query:e,queryId:t,context:await St.CP.getContextString(),raw:r.MYv||(0,Y.I_)(),fluxSkillOverride:a});var xa;!function(e){e.BulkTestCodeEvaluation="Python Language Expansion Bulk Test",e.RaiOutputGenerationTool="Python RAI Output Generation Tool"}(xa||(xa={}));let Sa=[];function wa({communicationHandler:e,setCannedOption:t}){let[a,n]=y.useState(),[o,i]=y.useState();const[l,s]=y.useState(!1),[c,d]=y.useState(!1),[u,m]=y.useState([]),[h,p]=y.useState({resolve:()=>{},reject:()=>{}}),[f,C]=y.useState(),[v,T]=y.useState({reject:()=>{}}),x=y.createRef(),[S,w]=y.useState(0),E=(0,Ca.j)();if(!(r.MYv||(0,Y.I_)()&&((0,g.iP)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)||(0,g.iP)("Microsoft.Office.Excel.FA000000124.EnableUsingFluxSkillsDirectly",!1))))return null;const R=(e,t,a,n)=>{m((o=>Sa=o.map((o=>(o.test===e&&(o.state=["Incorrect Changes","Timeout"].includes(t)?3:2,o.note=t,o.startTime&&(o.time=n-o.startTime,void 0!==(a=o.serverTime??a)&&(o.serverTime=a,o.executionTime=o.time-o.serverTime))),o)))))},I=(e,t,a)=>{m((n=>Sa=n.map((n=>(n.test===e&&(n.state=1,n.note="Passed",n.startTime&&(n.time=a-n.startTime,n.serverTime=n.serverTime??t,n.executionTime=n.time-n.serverTime)),n)))))},A=(e,t)=>{m((a=>Sa=a.map((a=>(a.test===e&&Object.assign(a,t),a)))))};async function L(e,t){const n=a,o={};return n.activationsMapTokenToCallback.forEach((e=>{va.includes(e.annotationType)&&(o[e.annotationType]=e)})),new Promise(((n,r)=>{Object.keys(o).forEach((e=>{const a={...o[e]};o[e].callback=t.bind(void 0,n,r),o[e]=a}));const i=new ft.g0({parentPath:["Signal",Re.z.getTypeName()],parentRevId:e.query,items:[{id:bt.r.generateId(),body:new Re.z(e)}]});a?.submitOperation(i)})).finally((()=>{n.activationsMapTokenToCallback.forEach((e=>{va.includes(e.annotationType)&&(e.callback=o[e.annotationType].callback)}))}))}function F(e,t){if(t?.errorMessage)throw A(e,{serverOutput:JSON.stringify(t.serverOutput),serverTime:t.duration}),new Error(JSON.stringify(t.errorMessage,null,2))}const _=e=>{(0,xt.x)(!!e,"No AugLoop response body");const t=e.error;if(t){throw"timeout"===JSON.parse(t.json).code?new Error("Server Timeout"):new Error(t.message)}},N=async e=>{F(e,e.odsl);const t=async t=>{A(e,{note:"Executing...",serverOutput:JSON.stringify(t,null,2)});const a=new gt.K,n=await a.convert(t);if((0,b.kc)(n))throw new Error("Multiple Agents");const o=new ht.e(n),r={happened:!1,id:void 0};await o.execute(r,(0,Ft.A)(),E,(function(e){return(0,b.cY)(b.SA.Error,e),Promise.resolve()}))};if(St.CP.isUpdatingSelection=!1,await St.CP.releaseContextLock(),e.odsl?.serverOutput){A(e,{note:"Sending to AugLoop..."});const a=await t(e.odsl.serverOutput.statements).then((()=>!0)).catch((e=>((0,b.cY)(b.SA.Error,e),!1))),n=e.odsl.duration;return A(e,{serverTime:n}),{serverTime:a&&n?n:-1,usedAugLoop:!1}}let a=-1;A(e,{note:"Sending to AugLoop..."});const n=await Ta(e.query,""),o=JSON.parse(n.context);delete o.officeJsExtraContext,n.context=JSON.stringify(o);const r=Date.now();return await L(n,(async(n,o,i)=>{try{if(void 0===i.items[0].body)return;a=Date.now()-r,A(e,{serverTime:a});const o=[];for(const e of i.items){const t=e.body;_(t),t?.odsl?.statements&&o.push(...t.odsl.statements)}await t(o),n()}catch(e){o(e)}})),{serverTime:a,usedAugLoop:!0}},k=async e=>{let t;F(e,e.officeJs);let a=-1;if(e.officeJs?.serverOutput)t=e.officeJs.serverOutput,a=e.officeJs.duration,A(e,{serverTime:a});else{A(e,{note:"Sending to AugLoop..."});const n=async(t,n,r)=>{try{const n=r.items[0].body;_(n),(0,xt.x)(1===n.aiResponses?.length&&"officeJs"===n.aiResponses[0].type,"No Office JS AI response"),a=Date.now()-o,A(e,{serverTime:a}),t(n.aiResponses[0].value)}catch(e){n(e)}},o=Date.now();t=await L(await Ta(e.query,""),n)}A(e,{note:"Executing...",serverOutput:JSON.stringify(t,null,2)});let n=await(o?.handleOfficeJsResult(t));return(0,xt.x)(void 0!==n,"Office JS Commanding instance not initialized"),(0,xt.x)(n,"Execution Failed"),t.undoWarnings.length&&(n=!!await(o?.confirmedUndo(t.code,t.codeExplanation.split("\n"),t.returnsValue))),n||(a=-1),{serverTime:a,usedAugLoop:!e.officeJs}},O=()=>{const e=x.current?.files?.item(0);e&&(e.text().then((e=>h.resolve(JSON.parse(e)))),x.current?.click())},P=async e=>{if("ODSL"!==e){if(!(0,g.ge)())return void m([{test:{query:"Enable the following flight(s) before running this test:\n  Microsoft.Office.Excel.FA000000124.OfficeJsCommanding",kind:"OfficeJs",category:""},note:"",state:2}]);o||(o=new pt.$(E),i(o))}m([]),Sa.length=0,a||(a=await(0,Et.qD)(),n(a));const t=await(async()=>(d(!0),new Promise(((e,t)=>p({resolve:e,reject:t}))).finally((()=>d(!1)))))();switch(e){case"ODSL":t.forEach((e=>e.kind="ODSL"));break;case"OfficeJs":t.forEach((e=>e.kind="OfficeJs"));break;case"Comparison":t.forEach(((e,a)=>{e.kind="ODSL",e.originalIndex=a,t.push({...e,kind:"OfficeJs"})})),t.sort((()=>Math.random()-.5))}w(t.length);const r=async e=>new Promise(((t,a)=>{const n=setTimeout((()=>{a(new Error("Timeout"))}),12e4),o="OfficeJs"===e.kind?k:N;(e=>{m((t=>(t.push({test:e,note:"Running...",state:0,startTime:Date.now()}),Sa=[...t])))})(e),o(e).then(t).catch(a).finally((()=>clearTimeout(n)))}));for(const e of t){let t="",a=!1;await new Promise(((n,o)=>{T({reject:o}),Excel.run((async a=>{let n=a.workbook.worksheets.getActiveWorksheet(),o=e.testSelection?.name,r="";switch(e.testSelection?.type){case"range":{const[t,i]=e.testSelection.name.split("!");r=i??e.testSelection.name,o=t;const l=a.workbook.worksheets.getItemOrNullObject(o);if(await a.sync(),l.isNullObject)break;n=l;break}case"worksheet":{const e=a.workbook.worksheets.getItemOrNullObject(o);if(await a.sync(),e.isNullObject)break;n=e;break}case"table":{const t=a.workbook.tables.getItemOrNullObject(e.testSelection.name),o=t.getRange().getCell(0,0).load("address");if(await a.sync(),t.isNullObject)break;n=t.worksheet,r=o.address.split("!")[1]??o.address;break}}const i=n.copy().load("id");await a.sync(),i.activate(),t=i.id,r&&i.getRange(r).select()})).then((()=>r(e))).then((({serverTime:t,usedAugLoop:a})=>{const n=Date.now()+(a?0:t);return(0,xt.x)(-1!==t,"Execution failed"),new Promise((a=>{C({test:e,resolve:e=>{a({passed:e,endTime:n,serverTime:t})}})}))})).then((({passed:t,endTime:a,serverTime:n})=>{C(void 0),t?I(e,n,a):R(e,"Incorrect Changes",n,a)})).catch((t=>{(0,b.cY)(b.SA.Error,t),C(void 0);const n=e["ODSL"===e.kind?"odsl":"officeJs"]?.duration??0,o=Date.now()+n;a=!0,R(e,t.message,n,o)})).finally((()=>Excel.run((async n=>{if(t){const o=n.workbook.worksheets.getItemOrNullObject(t);a?o.delete():A(e,{worksheet:t})}})).then((()=>{T({reject:()=>{}}),n()}))))}))}const l=Sa.filter((e=>"ODSL"===e.test.kind)),s=Sa.filter((e=>"OfficeJs"===e.test.kind));await Excel.run((async t=>{t.workbook.worksheets.load("items/name"),await t.sync();let a=e+" Test Results";const n=t.workbook.worksheets.items.filter((e=>e.name.startsWith(a)));n.length&&(a+=" "+(n.length+1));const o=t.workbook.worksheets.add(a),r=async(e,a)=>{e.sort(((t,a)=>(t.test.originalIndex??e.length)-(a.test.originalIndex??e.length)));const n=o.tables.add(a,!1);n.getHeaderRowRange().values=[["Name","Category","Pass","Server Time (s)","Execution Time (s)","Total Runtime (s)","Server Output JSON","Results Worksheet","Fail Reason"]],n.getDataBodyRange().numberFormat=[["Text","Text","0","0.000","0.000","0.000","Text","Text","Text"]],e.forEach((e=>{if(!e.worksheet)return;const a=e.test.testSelection?.name+` (${e.test.kind} GPT4)`;t.workbook.worksheets.getItemOrNullObject(e.worksheet).name=a,e.worksheet=a})),n.rows.add(void 0,e.map((e=>[e.test.query,e.test.category,1===e.state?1:0,e.serverTime?e.serverTime/1e3:"",e.executionTime?e.executionTime/1e3:"",e.time?e.time/1e3:"",e.serverOutput??"",e.worksheet??"",1===e.state?" ":e.note])));const r=n.getDataBodyRange().getColumn(2).load("address"),i=n.getDataBodyRange().getColumn(3).load("address"),l=n.getDataBodyRange().getColumn(4).load("address"),s=n.getDataBodyRange().getColumn(5).load("address");await t.sync(),n.showTotals=!0,n.getTotalRowRange().formulas=[["Average","",`=SUBTOTAL(101, ${r.address})`,`=SUBTOTAL(101, ${i.address})`,`=SUBTOTAL(101, ${l.address})`,`=SUBTOTAL(101, ${s.address})`,"","",""]],n.getTotalRowRange().numberFormat=[["","","0.00%","0.0000","0.0000","0.0000","","",""]],r.format.horizontalAlignment="Center";const c=r.conditionalFormats.add(Excel.ConditionalFormatType.iconSet);c.iconSet.style=Excel.IconSet.threeSymbols2,c.iconSet.criteria=c.iconSet.criteria=[{type:Excel.ConditionalFormatIconRuleType.formula,operator:Excel.ConditionalIconCriterionOperator.greaterThanOrEqual,formula:"=0"},{type:Excel.ConditionalFormatIconRuleType.formula,operator:Excel.ConditionalIconCriterionOperator.greaterThanOrEqual,formula:"=2"},{type:Excel.ConditionalFormatIconRuleType.formula,operator:Excel.ConditionalIconCriterionOperator.greaterThanOrEqual,formula:"=1"}],c.iconSet.showIconOnly=!0,n.getRange().format.autofitColumns(),n.getRange().format.wrapText=!1;const d=n.getRange().getOffsetRange(-1,0).getCell(0,0);d.values=[[e[0].test.kind+" Test Results"]],d.format.font.bold=!0,d.format.horizontalAlignment="Center",d.format.autofitColumns()},i=o.getRangeByIndexes(1,0,1,9);if(l.length&&s.length){await r(l,i),await t.sync();const e=o.getRangeByIndexes(l.length+5,0,1,9);await r(s,e)}else l.length?await r(l,i):s.length?await r(s,i):o.getCell(0,0).values=[["No test results"]];o.activate(),o.getCell(0,0).select()}))},M=async t=>{switch(t){case"Comparison":return P("Comparison");case"ODSL Commanding":return P("ODSL");case"Office JS Commanding":return P("OfficeJs");case"Calculated Columns":return(async e=>{const t=(0,Ft.A)(),a=e;a(At.mF.setLatestRequestId(t));const n=St.CP.getActiveTable();if(!n)return;const o=n.name;await a(Lt.mF.resolveTableLikeEntity(o,!1,t)),e(wt.m.updateTableName({requestId:t,table:o})),a(wt.m.startFetching(t)),e(At.mF.startExecutingCommand({command:K.OP.CalculatedColumns,id:t})),a(wt.m.setActiveRequestType(Rt.Yw.GeneralFormula)),a(wt.m.onFormulaSuggestionAnnotationReceived(kt(t,"1",["1"],["link"],['=HYPERLINK("https://www.microsoft.com", "Microsoft")'],[Nt(n,1)]))),a(wt.m.onFormulaSuggestionAnnotationReceived(kt(t,"1",["1"],["row"],["=ROW()"],[Nt(n,1)]))),a(wt.m.onFormulaSuggestionAnnotationReceived(kt(t,"2",["2","3"],["Row*10","Row*100"],["=ROW() * 10","=ROW() * 100"],[Nt(n,10),Nt(n,100)]))),a(wt.m.onFormulaSuggestionAnnotationReceived(kt(t,"3",["4","5","6","7","8","9","10","11"],["Row*10","Row*100","Row*1000","Row*10000","Row*100000","long name with spaces long name with spaces","name with\n             new line","Row*100000000"],["=ROW() * 10","=ROW() * 100","=ROW() * 1000","=ROW() * 10000","=ROW() * 100000","=ROW() * 1000000","=ROW() * 10000000","=ROW() * 100000000"],[Nt(n,10),Nt(n,100),Nt(n,1e3),Nt(n,1e4),Nt(n,1e5),Nt(n,1e6),Nt(n,1e7),Nt(n,1e8)])))})(E);case"Calculated Row":return(async e=>{const t=(0,Ft.A)(),a=e;a(At.mF.setLatestRequestId(t));const n=St.CP.getActiveTable();if(!n)return;const o=n.name;await a(Lt.mF.resolveTableLikeEntity(o,!1,t)),e(wt.m.updateTableName({requestId:t,table:o})),a(wt.m.startFetching(t)),e(At.mF.startExecutingCommand({command:K.OP.CalculatedColumns,id:t})),a(wt.m.setActiveRequestType(Rt.Yw.GeneralFormula)),a(wt.m.onFormulaSuggestionAnnotationReceived(Ot(t,"1",["1"],["=ROW()"],["1"])))})(E);case"Search With Citations":return(async e=>{const t=jt;await Jt.s.getInstance().handleChatResponse(t,e);const a={...t,status:0,messagesToAddOrReplace:[],messages:t.messagesToAddOrReplace};Jt.s.getInstance().handleChatResponse(a,e)})(E);case"Import Data - Render Card":return Yt(E);case"Chat History":return na(E,e);case"Python Language Expansion Bulk Test":return async function(){(0,b.cY)("Running Python Bulk Test Code Evaluation...");const e=Date.now();for(let e=da.length-1;e>=0;e--){const t=da[e];(0,b.cY)(`Starting Test for ${t}...`);try{const e=`${t}_BulkTest`,a=await ua(e);(0,b.cY)("Inserting Python Formulas for Language: "+t);for(let e=0;e<a.length;e++){const n=a[e],o=(0,la.ZK)(n.expectedPythonCode,!0,ca),r=(0,la.ZK)(n.generatedPythonCode,!0,ca);await ma(n.testFile,n.query,o,r,e,t)}(0,b.cY)("Waiting for Python Code to Execute..."),await(0,sa.u)(3e4),(0,b.cY)("Getting Test Results for Language:  "+t);for(let e=0;e<a.length;e++){let n;n=""===a[e].generatedPythonCode?{result:"FAIL",reason:"No code generated by LLM"}:await ha(e,t),await ga(n,e,t)}}catch(e){(0,b.cY)(`Error in Python Bulk Test Code Evaluation Tool for ${t}: ${e}`)}}const t=Date.now();(0,b.cY)("Python Bulk Test Code Evaluation Complete!"),(0,b.cY)("Total Time: "+(t-e)+"ms")}();case"Python RAI Output Generation Tool":return(0,fa.eG)(E)}},D=[{key:"flux-getInsights",text:"Use the Analyze Data skill directly"},{key:"flux-createCalculatedColumns",text:"Use the Calculated Columns skill directly"},...(0,g.vo)()?[{key:"flux-pythonCalculatedColumns",text:"Use the Python Calculated Columns skill directly"}]:[],{key:"flux-editDocument",text:"Use the Commanding skill directly"},...(0,g.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1)?[{key:"flux-dataShaping",text:"Use the Data Shaping skill directly"}]:[],...(0,g.iP)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)?[{key:"flux-importData",text:"Use the Import Data as skill directly"}]:[],{key:"python",text:"Use the Python skill directly"}];D.push({key:"flux-createCalculatedCell",text:"Use the Column Aggregation skill directly"}),D.push({key:"no-override",text:"No override",iconProps:{iconName:"Checkmark"}});const $={items:D,onItemClick(e,a){D.forEach((e=>delete e.iconProps)),a&&(a.iconProps={iconName:"Checkmark"}),"no-override"===a?.key?t?.():t?.(a?.key)}},B={items:[{key:"Comparison",text:"Commanding Comparison Tests"},{key:"ODSL Commanding",text:"ODSL Commanding Only Tests"},{key:"Office JS Commanding",text:"Office JS Commanding Only Tests"},{key:"Calculated Columns",text:"Calculated Columns suggestion"},{key:"Calculated Row",text:"Calculated Row suggestion"},{key:"Import Data - Render Card",text:"Import Data - Render Card"},{key:"Search With Citations",text:"Search With Citations"},{key:"Chat History",text:"Chat History Tests"},{key:"Python Language Expansion Bulk Test",text:"Run Python Language Expansion Evaluation Tool"},...(0,g.Eq)()?[{key:"Python RAI Output Generation Tool",text:"Python RAI Output Generation Tool"}]:[]],onItemClick(e,t){s(!0),M(t?.key).finally((()=>s(!1)))}};return c?y.createElement("span",{style:{position:"fixed",top:0,right:0,zIndex:100}},y.createElement("input",{type:"file",id:"test-selector",ref:x,accept:"application/json",style:{display:"none"},onChange:O}),y.createElement(Ae.Y,{text:"Select Test File",primary:!0,onClick:()=>x.current?.click()}),y.createElement(le.K,{iconProps:{iconName:"Back"},onClick:()=>h.reject()})):l?y.createElement(Le.a,{isOpen:!0,styles:{main:{position:"fixed",top:0,minHeight:0,padding:"5px"}}},y.createElement(ie.B,null,y.createElement("h3",{style:{textAlign:"center",margin:0,fontFamily:"sans-serif"}},`Tests ${u.length}/${S}`),y.createElement(le.K,{iconProps:{iconName:"Back"},onClick:v.reject}),u.map(((e,t)=>y.createElement("div",{key:t},y.createElement(Fe.n,{messageBarType:ya[e.state]},e.test.query,": ",y.createElement("b",null,e.note)),f?.test===e.test?y.createElement("div",{style:{width:"80%",margin:"auto",marginTop:"5px"}},y.createElement("h4",{style:{textAlign:"center",margin:0,fontFamily:"sans-serif"}},"Correct?"),y.createElement(_e.j,{style:{float:"left",marginBottom:"5px"},onClick:()=>f.resolve(!0)},"Yes"),y.createElement(_e.j,{style:{float:"right"},onClick:()=>f.resolve(!1)},"No")):null))).reverse())):r.MYv||(0,g.iP)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)?y.createElement(y.Fragment,null,t&&y.createElement(Ae.Y,{iconProps:{iconName:"TestPlan"},split:!0,splitButtonAriaLabel:"Set Canned option","aria-roledescription":"Set Canned option",menuProps:$,style:{position:"fixed",top:0,right:100,zIndex:100,opacity:"50%"}}),y.createElement(Ae.Y,{iconProps:{iconName:"TestUserSolid"},split:!0,splitButtonAriaLabel:"Run Tests","aria-roledescription":"Run Tests",menuProps:B,style:{position:"fixed",top:0,right:0,zIndex:100,opacity:"50%"}})):y.createElement(y.Fragment,null,!(0,g.yw)("OfficeVSO_9205837_formulasDevButton")&&t&&y.createElement(Ae.Y,{split:!0,splitButtonAriaLabel:"Set Canned option","aria-roledescription":"Set Canned option",menuProps:$,text:"Use skill directly",style:{position:"fixed",top:10,right:15,zIndex:100,opacity:"100%",borderColor:"green"}}))}function Ea(){return(0,g.yw)("OfficeVSO_9205837_formulasDevButton")&&((0,Y.I_)()||r.MYv||(0,g.iP)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1))}var Ra=a(11820),Ia=a(74511),Aa=a(1756);const La=()=>{const e=Ia.i.GetHostAppPlatform();switch(e){case Office.PlatformType.PC:return"Excel_Win32";case Office.PlatformType.Mac:return"Excel_Mac";case Office.PlatformType.iOS:return"Excel_iOS";case Office.PlatformType.OfficeOnline:return"Excel_Online";default:return ae.M.getInstance().logError({eventType:ce.S.ChatEvents,errorMessage:`Unknown Host Platform Type: ${e}`,logLevel:K.$b.Error}),""}},Fa=()=>{const e=Ia.i.GetHostAppPlatform();switch(e){case Office.PlatformType.PC:return"Win32";case Office.PlatformType.Mac:return"Mac";case Office.PlatformType.iOS:return"iOS";case Office.PlatformType.OfficeOnline:return"Web";default:return ae.M.getInstance().logError({eventType:ce.S.ChatEvents,errorMessage:`Unknown Host Platform Type: ${e}`,logLevel:K.$b.Error}),""}};var _a=a(37745);function Na(e){(0,b.cY)("Highlight comment with commentid "+e),(0,Ra.Gu)({type:Ra.tH.TriggerCommentHighlight,commentId:e})}async function ka(e,t){(0,b.cY)("Adding reply to comment",e,t),await Excel.run((async a=>{await a.sync();const n=a.workbook.comments;n.load("items"),await a.sync();for(const o of n.items)if(await a.sync(),o.id.toString()===e){const e=o.replies.add(t);e.load(),await a.sync(),(0,b.cY)("Reply added with id = "+e.id)}}))}async function Oa(e,t,a){(0,b.cY)("Applying suggestion",e,t,a),a===Aa.s.Reply?ka(e,t):await Excel.run((async n=>{await n.sync();const o=n.workbook.comments;o.load("items"),await n.sync();for(const r of o.items)if(await n.sync(),r.id.toString()===e){(0,b.cY)(r);const e=r.getLocation();if(e.load("range"),e.load("values"),await n.sync(),a===Aa.s.Insert){const a=e.values[0][0];t=a+" "+t,e.values=[[t]]}else e.values=[[t]];await n.sync();break}}))}async function Pa(e,t=""){if(!t)return await Excel.run((async t=>{const a=t.workbook.comments,n=t.workbook.worksheets.getActiveWorksheet().getRange("A1"),o=a.add(n,e);return o.load(),await t.sync(),o.id}));try{return await ka(t,e),t}catch(e){return(0,b.cY)("addReplyToComment failed with "+e),""}}async function Ma(){const e=await D.n6d.getInstance(void 0,o.$.getInstance().getCopilotRef(),void 0,de.Y6).getInDocSensitiveLabelUsingOfcJs();return{id:e.labelId,parent:e.parentName,isEncrypted:e.encryptionType!==D.TzT.None,displayName:e.displayName,priority:e.order}}function Da(){return{settings:{hostAppId:La(),hostAppName:r.fn_,hostAppPlatform:Fa(),hostAppScenario:r.Z1M,hostDefaultLocale:(0,g.yw)("OfficeVSO_9463384_EditorConfigUseUserLang")?(0,_a.gl)():Ia.i.GetHostAppDisplayLanguage(),isDogfoodEnvironment:(0,Y.I_)(),enableAutomaticScoping:!0,resultTime:1e4},telemLogger:{logError:e=>{(0,b.cY)("Reviewer agent people picker CIQ Error Log: ",e)}},entitiesSupported:[Mt.ck.People],isExpandedECCEnabled:!1}}var $a=a(55683),Ba=a(17425),Ha=a(98974),Ua=a(91519),qa=a(81364),Va=a(50108);var Ga=a(82623),Wa=a(7058);const za=(0,p.n)((0,Wa.f)({chatFreStack:{flexGrow:1},chatUiStack:{backgroundColor:"transparent"},spinner:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}})),Qa={root:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}},Ja=(0,p.n)({root:{height:"10%",width:"max-content",backgroundColor:"white",zIndex:1}}),ja={calloutStyles:{marginTop:4,width:"calc(100vw - 20px)",borderRadius:2},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}};var Ya=a(6129),Xa=a(64934),Ka=a(13944),Za=a(79689);const en=()=>{const e=[];Office.context.document.mode!==Office.DocumentMode.ReadOnly&&e.push((()=>{const e=[];return e.push({nodeType:"ActionSet",text:r.Pqm.generateFormulaColumnSuggestion(),data:{shouldSubmitQueryOnClick:!0}}),e.push({nodeType:"ActionSet",text:r.Pqm.addAColumnThatCombines()}),e.push({nodeType:"ActionSet",text:r.Pqm.addAColumnToExtract()}),e.push({nodeType:"ActionSet",text:r.Pqm.addAColumnThatCalculates()}),{nodeType:"Category",text:r.hn.menuSectionCreate(),promptCategory:"Create",iconRegular:Xa.vfO,iconHover:Xa.Dal,children:e}})());const t=(()=>{const e=[];return e.push({nodeType:"ActionSet",text:r.BaM.showDataInsights(),data:{shouldSubmitQueryOnClick:!0}}),e.push({nodeType:"ActionSet",text:r.BaM.percentageCalculation()}),e.push({nodeType:"ActionSet",text:r.BaM.howManyDifferent()}),e.push({nodeType:"ActionSet",text:r.BaM.whichItems()}),{nodeType:"Category",text:r.hn.menuSectionUnderstand(),promptCategory:"Understand",iconRegular:Ka.uJg,iconHover:Ka._38,children:e}})();t&&e.push(t);const a=(()=>{const e=[];return e.push({nodeType:"ActionSet",text:r.ZB_.highlight()}),e.push({nodeType:"ActionSet",text:r.ZB_.sort()}),e.push({nodeType:"ActionSet",text:r.ZB_.filter()}),e.push({nodeType:"ActionSet",text:r.ZB_.applyRYG()}),{nodeType:"Category",text:r.hn.menuSectionEdit(),promptCategory:"Edit",iconRegular:Xa.RIf,iconHover:Xa.FBb,children:e}})();a&&Office.context.document.mode!==Office.DocumentMode.ReadOnly&&e.push(a),e.push((()=>{const e=[];return e.push({nodeType:"ActionSet",text:r.epH.help(),data:{shouldSubmitQueryOnClick:!0}}),{nodeType:"Category",text:r.hn.menuSectionAsk(),promptCategory:"Ask",iconRegular:Za.I11,iconHover:Za.kNP,children:e}})());return{promptGuideMenuData:{nodeType:"Root",text:r.hn.menuTitle(),children:e}}};var tn=a(95674),an=a(74840),nn=a(38924);const on=e=>(0,g.FE)()?{sourcePrefix:(0,r.eL9)(),sourcesData:[{id:H.$.CurrentContext,primary:(0,r.qat)(),secondary:(0,r.waz)(),placeholderText:(0,r.Z_i)()},{id:H.$.Work,primary:(0,r.n50)(),secondary:(0,r.Dre)(),placeholderText:(0,r.MhY)()}],infoTip:(0,r.BGX)(),onSelection:t=>{const a=t.id===H.$.Work;e(a),(0,Ya.LA)(a);const n={featureName:K.q.CopilotChat,eventType:K.a5.ConversationMessage};(0,g.yw)("OfficeVSO_8688050_DisableXPIAMitigationFix")&&o.$.getInstance().displayResponse({chatCardType:Dt._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:a?(0,r.zOV)():(0,r.ZLn)()}},stopLoadingUi:!0,addCardToChatHistory:!0},n)},alwaysEnable:!0}:void 0,rn=e=>{if(o.$.getInstance().getInputText().length>0)return{message:"",restShyMessage:""};const t=(e=>{if(e&&((0,g.qm)()||e.tableLikeRange)&&e?.tableLikeRangeFeatures!==Ga.ye.Unrecognized)return(0,tn.r)(e.address)})(e),a=(0,g.vI)()&&((0,Ya.gc)()||(0,Ya.pX)());if((0,g.yw)("OfficeVSO_9301386_PythonModeSpecificMessages")&&St.CP.pythonContextManager.isPythonMode)return{message:(0,r.ahY)(),restShyMessage:(0,r.Hn3)()};if(t){let e=a?(0,r.IZs)():(0,r.tl8)();e=e.replace("{0}",t);return{message:e,restShyMessage:(0,r.LA5)().replace("{0}",t)}}return a?{message:(0,r.ir6)(),restShyMessage:(0,r.Hn3)()}:(0,g.qm)()?{message:(0,r.NIQ)(),restShyMessage:(0,r.Hn3)()}:(0,g.vI)()?{message:(0,r.Hn3)(),restShyMessage:(0,r.Hn3)()}:(0,g.FE)()&&(0,Ya.pX)()?{message:(0,r.MhY)(),restShyMessage:(0,r.Hn3)()}:{message:(0,r.nnF)(),restShyMessage:(0,r.Hn3)()}};function ln(e,t){return{settings:{hostAppId:La(),hostAppName:r.fn_,hostAppPlatform:Fa(),hostAppScenario:r.Z1M,hostDefaultLocale:(0,g.yw)("OfficeVSO_9463384_EditorConfigUseUserLang")?(0,_a.gl)():Ia.i.GetHostAppDisplayLanguage(),isDogfoodEnvironment:(0,Y.I_)(),enableAutomaticScoping:!0},telemLogger:{logError:e=>{(0,de.cY)("Shared Copilot CIQ Error Log: ",e)}},telemSink:ae.M.getInstance().getTelemetrySink(),entitiesSupported:[Mt.ck.File,Mt.ck.People,Mt.ck.Event,Mt.ck.Message],isExpandedECCEnabled:!0,getSensitivityInfo:Ua.qH,featureFlags:{enableAppGptsInCiq:(0,g.v2)(),enableAppPluginsInCiq:(0,g.DU)(),enableTopicECC:(0,g.K7)(),enableAppMessageExtensionsInCiq:(0,g.vN)(),enableAppPPInCiq:(0,g.$X)(),enableAppTypeBInCiq:(0,g.DD)(),disableClientConfigQueryCharacterForEditorService:!t&&(0,g.WI)()},onOpenGptStorefront:D.jPo,onAttachCloudFiles:e,inlineSuggestionsStyles:ja,moreCopilotsStringOverride:(0,g.tm)()?(0,D.QAh)():void 0}}const sn=()=>{const e={promptSuggestionHintCardMap:{[(0,r.Yhj)()]:{headerText:(0,r.o3Z)(),descriptionTextList:[(0,r.hAn)(),(0,r.aS7)(),(0,r.VdU)(),(0,r.aDZ)()]},[(0,r.ekx)()]:{headerText:(0,r.YKk)(),descriptionTextList:[(0,r.vqw)(),(0,r.oOi)()]},[(0,r.byP)()]:{headerText:(0,r.YKk)(),descriptionTextList:[(0,r.v7j)(),(0,r.vks)()]},[(0,r.z15)()]:{headerText:(0,r.cRY)(),descriptionTextList:[(0,r.zr)(),(0,r.sJU)(),(0,r.l7G)(),(0,r.s46)(),(0,r.lqT)()]}}};return(0,g.H2)()&&(0,la.Gd)()&&(e.promptSuggestionHintCardMap[(0,r.n00)()]={headerText:"Use Python to analyze data",descriptionTextList:["Forecast the sales for the next 10 periods","Reduce Features via PCA with 3 components, plot 3d for k means clustering","Summarize each cluster with 75 percentiles in a column in descending order by row sum"]}),e},cn=(e,t)=>({trySydneyToggleChecked:!1,trySydneyToggleEnabled:!1,tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryReviewerAgentToggleOnChange:e,tryReviewerAgentToggleChecked:t,tryReviewerAgentToggleEnabled:(0,g.wB)()}),dn=(e,t,n,o,i,l,s,c,d,u,m,h,p,b,f)=>{const C=(0,g.QE)()&&void 0!==s,y=t&&(0,g.SP)();(0,de.cY)("Fetching Chat UI Props");const v={zeroQueryMessageV2Props:y?void 0:(0,nn.uC)({disableButtons:C},f,(()=>{i(At.mF.showMoreZQMPrompts())})),hintCardProps:sn(),tipCardProps:o,suggestionPillsUiProps:(0,an.nK)(n,!St.CP.pythonContextManager.isPythonMode&&n.length>0,(()=>{i(At.mF.showMorePrompts())}),s,(0,g.yw)("OfficeVSO_9343894_useTableFromState")?l:St.CP.getActiveTable()),toggleUiProps:cn(u,m),chatContainerUiProps:{showFeedbackButtons:(0,g.tV)(),useFluentAIGeneratedIndicator:(0,g.yw)("OfficeVSO_9066056_useFluentAIGeneratedIndicator")},customMessageRenderers:Bt.J3,documentSensitivityProps:c,changeTopicUiProps:{hideChangeTopicButton:(0,g.T$)()},clientInfoProps:{clientInfo:h,taskModuleLauncher:D.DLk.getInstance().launchTaskModule.bind(null,!1)},singleModeProps:"off"===b.feature?{isInSingleMode:!1}:{isInSingleMode:!0,exitButtonProps:un(i,b)}};return v.chatInputV2Props=((e,t,n,o,i)=>{const l=(0,g.vI)(),s=(0,g.lD)(),c=l||(0,g.qm)(),d=n&&(0,g.SP)(),u=rn(e);return{chatPlaceholderMessage:u.message,chatRestShyPlaceholderMessage:u.restShyMessage,voiceInputProps:(0,g.CG)()?{voiceInputLocale:Ia.i.GetHostAppDisplayLanguage(),microphonePermissionErrorMessage:Ia.i.isWebPlatform()?(0,r.XWM)():(0,r.Sak)(),microphonePermissionErrorTitle:Ia.i.isWebPlatform()?(0,r._C5)():(0,r.ReY)(),microphonePermissionImagePath:Ia.i.isWebPlatform()?a(50501):void 0,showMicrophonePermissionHelpLink:Ia.i.isWebPlatform(),handleInChatInput:c}:void 0,menuProps:d?void 0:en(),groundingSourcePickerProps:on(t),editorConfig:(0,g.H_)()&&n?ln(i,n):void 0,buttonProps:{groundingButtonEnabled:l,atMentionButtonEnabled:s},pluginsInfo:o(),isVersion3Enabled:c,shouldInitializeEditorInChatInput:l,characterLimitErrorMessage:(0,g.yw)("OfficeVSO_8986671_UseLocalizedStringForCharacterLimitExceed")?(0,r.OKS)():void 0,imageInputEnabled:(0,g.lj)(),isImageInputButtonEnabled:(0,g.lj)(),imageSizeLimitInMB:(0,g.Mo)()?(0,g.kr)():Math.round((0,g.i3)()/1024*100)/100,isImageResizeEnabled:(0,g.Mo)(),imageResizedSizeInKB:(0,g.lz)()}})(l,e,t,d,p),v.chatHistoryUiProps={enableChatHistoryV2:(0,g.K$)(),isGptsEnabled:(0,g.Pz)()},(0,g.H)()&&(v.creditsUIProps={creditUpsellHandler:D.NnE,upsellFwdLinkId:(0,r.tMN)(),clientParam:(0,r.DPI)()}),v};function un(e,t){return{buttonText:t.caption,...t.exitMenuOptions&&t.exitMenuOptions?.length>0?{menuProps:t.exitMenuOptions,onClick:t=>{e(At.mF.singleModeExitOptionSelected(t))}}:{onClick:()=>{e(At.mF.singleModeExitOptionSelected(void 0))}}}}var mn=a(89099),gn=a(24220),hn=a(93772),pn=a(19080),bn=a(96854),fn=a(33540),Cn=a(95800);const yn=["General","General","d-mmm","General",'_($* #,##0_);_($* (#,##0);_($* "-"??_);_(@_)','_($* #,##0_);_($* (#,##0);_($* "-"??_);_(@_)','_(* #,##0_);_(* (#,##0);_(* "-"??_);_(@_)','_(* #,##0_);_(* (#,##0);_(* "-"??_);_(@_)'];var vn=a(18700),Tn=a(59503),xn=a(70364);function Sn(e){const t=[[r.xe2.SampleColumnHeaderCampaignOwner,r.xe2.SampleColumnHeaderCampaignName,r.xe2.SampleColumnHeaderLaunchDate,r.xe2.SampleColumnHeaderCampaignType,r.xe2.SampleColumnHeaderBudget,r.xe2.SampleColumnHeaderRevenue,r.xe2.SampleColumnHeaderTotalUsersTargeted,r.xe2.SampleColumnHeaderEngagedUsers],["Halima, Yakubu",r.xe2.SampleDataTextLateJanEmail,"1/27/2023",r.xe2.SampleDataTextDigitalMarketing,500,6980,4205,465],["Kovaleva, Anna",r.xe2.SampleDataTextBillboardsSmall,"1/29/2023",r.xe2.SampleDataTextBrandMarketing,250,4732,2e3,500],["Smith, Avery",r.xe2.SampleDataTextBillboardsLarge,"2/3/2023",r.xe2.SampleDataTextBrandMarketing,4500,5632,1e4,362],["Glazkov, Ilya",r.xe2.SampleDataTextProductReview3x,"1/16/2023",r.xe2.SampleDataTextCustomerExperience,2750,5676,35e3,5418],["Lawson, Andre",r.xe2.SampleDataTextTargetedGroup1,"1/26/2023",r.xe2.SampleDataTextDigitalMarketing,5800,136,1e4,285],["Cartier, Christian",r.xe2.SampleDataTextBillboardsSmall,"1/3/2023",r.xe2.SampleDataTextBrandMarketing,800,8703,2500,496],["Barden, Malik",r.xe2.SampleDataTextIndustryConference,"2/23/2023",r.xe2.SampleDataTextCustomerExperience,600,4540,950,618],["Macedo, Beatriz",r.xe2.SampleDataTextTargetedGroup2,"2/25/2023",r.xe2.SampleDataTextDigitalMarketing,800,788,2e3,367],["Halima, Yakubu",r.xe2.SampleDataTextFebEmailNorth,"2/11/2023",r.xe2.SampleDataTextDigitalMarketing,500,12423,4205,902],["Halima, Yakubu",r.xe2.SampleDataTextFebEmailSouth,"2/12/2023",r.xe2.SampleDataTextDigitalMarketing,500,9293,3687,673],["Halima, Yakubu",r.xe2.SampleDataTextFebEmailWest,"2/13/2023",r.xe2.SampleDataTextDigitalMarketing,500,16342,5278,1029],["Connors, Morgan",r.xe2.SampleDataTextProductMention5x,"2/17/2023",r.xe2.SampleDataTextCustomerExperience,635,2208,55e3,1470]],a=yn,n=t.length,o=n>0?t[0].length:0,i=e.getRangeByIndexes(0,0,n,o);i.values=t;for(let e=0;e<o;e++)i.getColumn(e).numberFormat=[[a[e]]];i.getRow(0).numberFormat=[["General"]],e.tables.add(i,!0).getRange().select(),i.format.autofitColumns()}function wn(e,t){const a=e.split("{0}");return y.createElement(y.Fragment,null,a[0],y.createElement("b",null,t),a[1])}function En(e){const t=e.split("\n");return y.createElement(y.Fragment,null,y.createElement("ul",null,t.map(((e,t)=>y.createElement("li",{key:t},e)))))}function Rn(e,t,a){const n=e.split("{0}");return y.createElement(y.Fragment,null,n[0],y.createElement(Ke.N,{href:a,underline:!0,target:"_blank",rel:"noopener noreferrer"},t),n[1])}const In=(0,u.A)(m.wrX,m.UhZ),An=(e,t,a,n,i,l,s,c,d)=>{const u=(0,g.yw)("OfficeVSO_8450684_DisableSdxOnChartSheet"),m=(0,g.yw)("OfficeVSO_8466885_DisableSdxOnAutoSaveOff"),h=(0,g.tg)(),p=(0,g.QE)();if(d){!(0,g.yw)("OfficeVSO_9352165_LogPermanentErrorOnSet")&&(0,g.yw)("OfficeVSO_8787558_CopilotChatASHALog")&&ae.M.getInstance().logStandardizedAshaErrorEvent(gn.W.User_Input_Could_Not_Be_Processed,mn.c.Input_Failed_Due_To_Augloop_Session_Close,K.BJ.CopilotChat);return{descriptionTextList:[Office.context.platform===Office.PlatformType.OfficeOnline?(0,r.PEH)():(0,r.HTR)()],headerText:(0,r.Vx2)(),icon:In,isError:!0}}if(u&&m){if(!t&&!i&&l&&s)return}else if(u){if(!t&&!i&&l)return}else if(m){if(!t&&!i&&s)return}else if(!t&&!i)return;if(n&&n===St.CP.getActiveWorksheetName())return{isError:p};if(m&&!s)return{descriptionTextList:[(0,r.USL)()],headerText:(0,r.tDq)(),icon:In,isError:!0};if(u&&!l)return{descriptionTextList:[(0,r.L0p)()],headerText:(0,r.QOn)(),icon:In,isError:!0};if(i)return{descriptionTextList:[(0,r.MED)()],headerText:(0,r.TSg)(),icon:In,isError:!0};switch(t){case"BLANK_WORKSHEET":return{headerText:(0,r.DEh)(),descriptionTextList:[(0,r.L0O)()],buttonTitle:(0,r.px2)(),onClick:()=>{!function(e){Excel.run((async t=>{e(At.mF.startExecutingAndLockContext(K.OP.InsertSampleData));const{message:a,telemetry:n}=Ut.n.getSampleTableDataResponse();o.$.getInstance().displayResponse(a,n),ae.M.getInstance().logEvent((0,K.SV)(K.he.SuggestionApplied,K.q.SampleData,K.KZ.AddButton));const r=(0,vn.me)(t);await t.sync();const i=[];if(r()){await(0,xn.F5)((async e=>{Sn(e.workbook.worksheets.getActiveWorksheet())})),await e(At.mF.stopExecutingAndReleaseContextLock());const{message:t,telemetry:a}=Ut.n.getSampleTableDataSuccessResponse();return void o.$.getInstance().displayResponse(t,a)}const l=(0,Cn.d)(t);try{await t.sync();const a=await l()(t);i.push(a.undo);const n=a.result;await(0,xn.F5)((async e=>{Sn(n)}));const r=(0,Cn.x)(t,n);await t.sync();const s=await r()(t);i.push(s.undo),await e(At.mF.stopExecutingAndReleaseContextLock());const{message:c,telemetry:d}=Ut.n.getSampleTableDataSuccessResponse();o.$.getInstance().displayResponse(c,d)}catch(t){throw await e(At.mF.stopExecutingAndReleaseContextLock()),await(0,Tn.q)(i),t}}))}(e),e(Lt.mF.setSelectionError(void 0))},icon:In,isError:p};case"PIVOT_TABLE_SELECTED":return{descriptionTextList:(0,g.Xh)()?[(0,r.YNj)()]:[(0,r.UL_)()],headerText:(0,g.Xh)()?(0,r.cpK)():(0,r.PlK)(),icon:In,isError:p,isWarning:(0,g.Xh)()};case"CHART_SELECTED":case"INVALID_SELECTION":return{descriptionTextList:(0,g.Xh)()&&"CHART_SELECTED"===t?[(0,r.YNj)()]:[(0,r.AYD)()],headerText:(0,g.Xh)()&&"CHART_SELECTED"===t?(0,r.cpK)():(0,r.h3h)(),icon:In,isError:p,isWarning:(0,g.Xh)()&&"CHART_SELECTED"===t};case"PAYLOAD_TOO_LARGE":return{descriptionTextList:[(0,g.yw)("OfficeVSO_9480524_LargeDataMessage")&&4e6===(0,g.Z8)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",Lt.Kd)?(0,r.WTX)():(0,r.y6U)()],headerText:(0,r.BSy)(),icon:In,isError:p};case"TABLE_HIDDEN_HEADERS":return{descriptionTextList:[(0,r.LRp)()],headerText:(0,r.iOi)(),buttonTitle:(0,r.QCY)(),onClick:async()=>{const{message:e,telemetry:t}=Ut.n.getShowHeaderButtonResponse();o.$.getInstance().displayResponse(e,t),ae.M.getInstance().logEvent((0,K.SV)(K.he.SuggestionApplied,K.q.ShowHeaders,K.KZ.AddButton)),await(0,xn.F5)((async e=>{e.workbook.tables.getItem(a?.name??"").showHeaders=!0}));const n=Ut.n.getShowHeaderButtonSuccessResponse();o.$.getInstance().displayResponse(n.message,n.telemetry)},icon:In,isError:p};case"UNSUPPORTED_RANGE":if(a?.tableLikeRangeFeatures){const e=a.tableLikeRangeFeatures&Ga.ye.All,n=(0,fn.kw)(e).map((e=>(0,fn.Ah)(e))),o=(0,Ha.M5)(hn.Xw.CONTEXT),r=e=>{c.feedbackButtonClicked(e,o)};return{headerText:t,descriptionTextList:n,isError:!1,isWarning:h,feedbackProps:{shouldShowFeedbackButtons:!0,useFluentAIGeneratedIndicator:!0,displayPosition:pn.O.Footer,feedbackData:o,handleThumbsUpClick:()=>{r(Mt.Gb.LIKE)},handleThumbsDownClick:()=>{r(Mt.Gb.DISLIKE)}}}}return;default:if(!(0,g.yw)("OfficeVSO_9352165_LogPermanentErrorOnSet")&&p&&(0,g.yw)("OfficeVSO_8895888_NearestTableLoggingEnabled")){const e=ae.M.getInstance(),t=bn.E.getInstance();t.updateTelemetryChatEventData({[K.h3.ChatEventType]:K.a5.SelectTableCard},e),t.sendTelemetryChatEventData(e)}if((0,g.Xh)())return;return{descriptionTextList:[y.createElement(y.Fragment,{key:0},Rn((0,r.bPB)(),(0,r.OeJ)(),r.vYt),En((0,r.SXd)()),wn((0,r.oPi)(),(0,r.vBB)()))],headerText:(0,r.CMz)(),icon:In,isError:p}}};var Ln=a(37488),Fn=a(94836),_n=a(54447),Nn=a(83349);const kn=({theme:e=l.G.defaultWhite,isHighContrast:t=!1})=>{const a=(0,Ca.j)(),[n,i]=(0,y.useState)({citationTitle:"",isFluxFlowEnabled:!0,isCitationsEnabled:(0,g.FE)()||(0,g.vI)()});(0,D.fQe)((async()=>{const e=document.getElementsByClassName(r.fw9);e?.length&&e[0].focus(),o.$.getInstance().setInputFocus(),o.$.getInstance().scrollToBottom()}));const s=(0,g.K5)()&&void 0!==Ln.preloadCopilot;(0,D.Un9)((async()=>{s&&!Ln.hasPreloadedCopilotBeenShown&&o.$.getInstance().activateAugloopAnnotations()}));const[c,u]=y.useState(!1),[m,p]=y.useState(!1),[f,C]=(0,y.useState)((0,g._b)()?$.n.getInstance(void 0,o.$.getInstance().getCopilotRef(),void 0,de.Y6).getSensitivity():void 0),v=(0,et.d4)((e=>e.chat.suggestionList)),T=(0,et.d4)((e=>e.chat.zqmSuggestionList)),x=(0,et.d4)((e=>e.chat.loadingStrings)),S=(0,et.d4)((e=>e.selection.selectionError)),w=(0,et.d4)((e=>e.chat.executingCommand)),E=(0,et.d4)((e=>e.selection.activeTable),((e,t)=>(0,g.yw)("OfficeVSO_9343900_activeTableEqualityFn")?e?.name===t?.name&&e?.tableLikeRangeFeatures===t?.tableLikeRangeFeatures:e===t)),R=(0,et.d4)((e=>e.selection.hideSelectionErrorOnSheet)),I=(0,et.d4)((e=>e.selection.isWorksheetProtected)),A=(0,et.d4)((e=>e.selection.isPermanentError)),L=(0,et.d4)((e=>e.selection.isWorkbookAutoSaveOn)),F=(0,et.d4)((e=>e.selection.isWorksheet)),_=(0,et.d4)((e=>e.app.userType)),N=(0,et.d4)((e=>e.app.clientInfo)),k=(0,et.d4)((e=>e.chat.singleModeState)),O=y.useRef(null);o.$.getInstance().setCopilotRef(O);const P=(0,g._S)(),[M,oe]=(0,y.useState)(null),[re,ie]=(0,y.useState)(!1),[le,se]=y.useState(!1),[ce,ue]=y.useState(!1),[me,ge]=y.useState(""),[he,be]=(0,y.useState)({displayName:"",email:""}),[fe,Ce]=(0,y.useState)(""),[ye,ve]=y.useState(D.Yj6.LAUNCH_WITH_REVIEWERS),Te=y.useCallback((()=>{const e=[];return(0,g.oJ)()&&!(0,g.UL)()&&e.push({id:H.$.Work,onToggle:e=>{(0,b.cY)("ExcelCopilotChat: Microsoft M365 toggle is "+(e?"enabled":"turned off")),(0,Ya.LA)(e),u(e)},state:c?U.p.Enabled:U.p.Disabled}),e.push({id:H.$.Web,onToggle:e=>{(0,b.cY)("ExcelCopilotChat: Web Content toggle is "+(e?"enabled":"turned off")),(0,Ya.u$)(e),p(e)},state:m?U.p.Enabled:U.p.Disabled}),e}),[c,m]);(0,y.useEffect)((()=>{(0,g.vI)()&&((0,b.cY)("ExcelCopilotChat: Reinitializing AL session due to user type change to "+_),(0,g._b)()&&Se())}),[_]),(0,y.useEffect)((()=>{const e=w===K.OP.ActionAI||w===K.OP.AnalyzeData||w===K.OP.CalculatedColumns||w===K.OP.CalculatedCells||w===K.OP.ElseSkillExecuting||w===K.OP.FluxReasoning||w===K.OP.FluxGenerateResponse||w===K.OP.Search||w===K.OP.Python||w===K.OP.PythonStartAnalysis;o.$.getInstance().updateLoadingComponentProps({loadingUiStringList:x,showStopGeneratingButton:e&&!(0,Fn.dD)(),showInlineStopGeneratingButton:e&&(0,Fn.dD)()})}),[w,x]),(0,Nn.H5)((()=>{a(wt.m.setShouldShowFormulaDevButton({shouldShowFormulaDevButton:(0,g.yw)("OfficeVSO_9205837_formulasDevButton")&&((0,Y.I_)()||(0,g.iP)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1))}))}));const xe=async()=>{const e=await async function(){try{return await Excel.run((async e=>{const t=(0,Va.dI)(e);return await e.sync(),t()}))}catch(e){const t=ae.M.getInstance();return t.logErrorCode(qa.O.LocaleFetchFailed,e),void((e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.inactiveWorkbook||e instanceof qa.u)&&t.logErrorCode(qa.O.InactiveWorkbook,e))}}();e&&a($a.mF.setLocaleInfo({localeInfo:e}))};async function Se(){$.n.getInstance().getInDocSensitiveLabelInfo(),$.n.getInstance().setLabelChangeEventListener(Ee),Re()}async function Ee(e,t){(0,b.cY)(`ExcelCopilotChat: Sensitivity Label Change Event: ${JSON.stringify(e)} to ${JSON.stringify(t)}`),(0,g.FE)()||(0,g.vI)()?await $.n.getInstance().setSensitivityLabelToHighestSensitivity([$.n.getInstance().getInDocSensitiveLabelInfo(),t]):($.n.getInstance().setInDocSensitivityLabelInfo(t),Re())}function Re(){(0,b.cY)("ExcelCopilotChat: Setting sensitivity in basic chat props");const e=(0,Ua.yu)();i((t=>({...t,sensitivityIndicatorData:(0,Ua.Q9)(e)}))),C($.n.getInstance().getSensitivity())}(0,y.useEffect)((()=>{let e=!1;(0,g._b)()&&(f&&""!==f.id||(async()=>{await $.n.getInstance().setInDocSensitiveLabelInfoUsingOfcJs(),C($.n.getInstance().getSensitivity())})()),(async()=>{if((0,g.Ty)()&&(0,D.gcB)((e=>{a($a.mF.setUserType(e))})),ae.M.userQueryOrder=0,(0,g._K)()?te.B.getInstance().logSeenEvent(K.q.CopilotChat):ae.M.getInstance().logSeenEvent(K.q.CopilotChat),(0,g.Qy)()||(0,_n.mN)(),await(async()=>{await Excel.run({delayForCellEdit:!0},(async e=>{e.application.onUndoChanged.add((async e=>{"UndoGroupAdded"===e.changeType&&St.CP.isContextLocked()||(await a(At.mF.getExecutingCommand())!==K.OP.FluxGenerateResponse?(0,X.s_)(X.H0.DisableUndo):J.Z.getInstance().setDisableUndoButton(!0))}))}))})(),!(e||(await(0,hn.LN)(),e||(0,g.Lr)()&&(await xe(),e)))){if((0,g._b)()&&Se(),!(0,g.yw)("OfficeVSO_9113126_copilotchatrefnulltimeoutfix")&&(0,_a.C6)()){const{message:e,telemetry:t}=Ut.n.getLanguageUnavailableResponse();o.$.getInstance().displayResponse(e,t)}(0,de.sZ)(),P&&(async()=>{try{const e=await _e.getALSession(),t=await async function(){let e="",t="";try{const a=await OfficeFirstPartyAuth.getPrimaryIdentityInfo();e=a.email,t=a.displayName}catch(e){return(0,b.cY)("Error getting user info: "+e),{displayName:"defaultName",email:"defaultEmail"}}return{displayName:t,email:e}}(),a=await j.i.getDocumentUrlAsync();oe(e),be(t),Ce(a)}catch(e){(0,b.cY)("Failed to fetch session:",e)}})()}})()}),[]),(0,y.useEffect)((()=>{a(At.mF.initializeSuggestionList())}),[]),(0,y.useEffect)((()=>{(0,Ya.LA)(c),(0,g.vI)()||(a(At.mF.clearSuggestionList()),ae.M.getInstance()?.logEvent((0,K.SV)(c?K.he.GroundPickerSelected_EnterpriseMode:K.he.GroundPickerSelected_DocMode,K.q.CopilotChat)),c||a(At.mF.showZeroStateSuggestionList()))}),[c]),(0,y.useEffect)((()=>{a(At.mF.showMoreZQMPrompts())}),[]);const Ie=y.useCallback((()=>{ie(!0),(0,b.cY)("handleReviewerAgentToggle User Query: ",me),setTimeout((()=>{ie(!1)}),2e3)}),[]),Ae={isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:(0,g.qJ)(),enableProactiveZQMWith3SAPISuggestions:(0,g.Cp)(),enableProactiveZQMWithSuggestedQnA:(0,g.wO)(),enableQueryBeforeAnnotationLoad:(0,g.wT)(),isCreditsUIEnabled:(0,g.H)(),isSketchImageCardEnabled:(0,g.IL)(),isAttachmentListEnabled:(0,g.N6)()&&(0,Ya.pX)(),isCloudFileUploadEnabled:(0,g.Sh)()&&(0,Ya.pX)(),enablePluginSearchInFlyout:(0,g.fn)()&&(0,Ya.pX)(),enableMorePluginHyperLinkInFlyout:(0,g.md)()&&(0,Ya.pX)(),enableQueryEndOnGptSwitch:(0,g.FF)(),showNewChatOnGPTItem:(0,g.CU)(),enableNewChatOnlyOnCopilot:(0,g.Lz)(),isChatClickForGPTsEnabled:(0,g.pl)(),isCustomGPTsEnabled:(0,g.Pz)(),isSccReadAloudEnabled:(0,g.ii)(),isViewMorePromptsIconV2Enabled:(0,g.s2)(),isViewMorePromptsOneClickEnabled:(0,g.zd)(),promptInputLength:(0,g.Z8)("Microsoft.Office.Excel.FA000000124.AugLoop.PromptInputLength",D.RkY),disableALAnnotationsOnPreload:s,isApiPluginsCardsEnabled:(0,g.l6)(),isInterstitialConfirmationEnabled:(0,g.dw)(),isInterstitialAuthEnabled:(0,g.I3)(),useCacheForGPTDetails:(0,g.Co)(),isDAOutputV2Enabled:(0,g.MN)(),isDABrandingEnabled:(0,g.CL)(),isOutputV2Enabled:(0,g.pu)(),addExtensibiltyDataToFeedbackOCV:(0,g.sC)()},Le=y.useCallback(((e,t)=>{const a=t?.checked;(0,b.cY)("Toggling Reviewer Agent to "+(a?"on":"off")),De(a?r.erl.Reviewer:r.erl.CopilotChat),se(a??!1),ge(""),ue(!1),ve(D.Yj6.LAUNCH_FROM_TOGGLE),Ie()}),[Ie]),Fe=Z.w.getInstance(a),_e=B.p.getInstance(a,Fe,v,nn.dW,T,u);_e.setSuggestionList(v),_e.setZeroQueryMessageTitles((0,nn.dW)()),_e.setZqmSuggestionList(T);const Ne=(0,g.yw)("OfficeVSO_8427023_HandleTabKey")?e=>{"Tab"===e.key&&e.stopPropagation()}:void 0,ke=Ja(),[Oe,Pe]=y.useState((()=>{const n=[];return(0,g.aC)()||n.push({id:r.erl.CopilotChat,name:r.rBP[r.erl.CopilotChat],isSelected:!0,isDefaultCopilot:!0,menuIcon:y.createElement(D.eU_,null)}),P&&n.push({id:r.erl.Reviewer,name:r.rBP[r.erl.Reviewer],isSelected:!1,isDefaultCopilot:!1,copilotType:(0,g.aC)()?G.NV.ClientProvided:void 0,copilotComponent:y.createElement(ee,{alSession:M||void 0,onReviewerAgentToggleChange:Le,onApplySuggestion:Oa,userQuery:me,addCommentToFirstLineOfDocument:Pa,onSuggestionCardNavigation:Na,isDarkModeEnabled:(0,h.eS)(e,t).isDarkModeEnabled,isHighContrastModeEnabled:(0,h.eS)(e,t).isHighContrastModeEnabled,documentURL:fe,authorName:he.displayName,authorEmail:he.email,isReviewerNotAddedButtonClicked:ce,getDocumentSensitivity:Ma,agentLaunchType:ye,peoplePickerEditorConfig:Da()}),menuIcon:y.createElement(D.T$y,null),iconAltText:r.rBP[r.erl.Reviewer]}),n.push(...function(e,t){const a=[];return Ea()&&(a.push({id:r.erl.DirectSkill,name:r.rBP[r.erl.DirectSkill],isSelected:!1,isDefaultCopilot:!1,copilotType:(0,g.aC)()?G.NV.ClientProvided:void 0,copilotComponent:y.createElement(Tt,{setCannedOption:t=>e.cannedOption=t,getCannedOption:()=>e.cannedOption}),menuIcon:y.createElement(ne.SFT,null)}),a.push({id:r.erl.DevTools,name:r.rBP[r.erl.DevTools],isSelected:!1,copilotType:(0,g.aC)()?G.NV.ClientProvided:void 0,isDefaultCopilot:!1,copilotComponent:y.createElement(ut,{setShouldShowFormulaDevButton:e=>t(wt.m.setShouldShowFormulaDevButton({shouldShowFormulaDevButton:e}))}),menuIcon:y.createElement(ne.SFT,null)}),(0,g.yw)("OfficeVSO_9503894_AugloopDiagnosticsPane")&&(a.push({id:r.erl.AugloopDiagnostics,name:r.rBP[r.erl.AugloopDiagnostics],isSelected:!1,isDefaultCopilot:!1,copilotComponent:y.createElement(pe,null),menuIcon:y.createElement(ne.HpN,null)}),a.push({id:r.erl.AugloopModelVisualizer,name:r.rBP[r.erl.AugloopModelVisualizer],isSelected:!1,isDefaultCopilot:!1,copilotComponent:y.createElement(we,null),menuIcon:y.createElement(ne.HpN,null)}))),a}(_e,a)),n})),[Me,De]=y.useState(r.erl.CopilotChat),$e=a=>{(0,b.cY)("handleCopilotChatChange in client",a);const n=(0,g.yw)("OfficeVSO_9281676_OnlySetReviewerToOneId"),o=Oe.map((o=>n&&a===r.erl.Reviewer&&o.id===r.erl.Reviewer||!n&&a===r.erl.Reviewer?{...o,copilotComponent:y.createElement(ee,{alSession:M||void 0,onReviewerAgentToggleChange:Le,onApplySuggestion:Oa,userQuery:me,addCommentToFirstLineOfDocument:Pa,onSuggestionCardNavigation:Na,isDarkModeEnabled:(0,h.eS)(e,t).isDarkModeEnabled,isHighContrastModeEnabled:(0,h.eS)(e,t).isHighContrastModeEnabled,documentURL:fe,authorName:he.displayName,authorEmail:he.email,isReviewerNotAddedButtonClicked:ce,getDocumentSensitivity:Ma,agentLaunchType:ye,peoplePickerEditorConfig:Da()}),isSelected:o.id===a}:{...o,isSelected:o.id===a}));Pe(o),De(a)};y.useEffect((()=>{$e(Me)}),[Me,M]);const Be={closeButton:{type:W.y.Close,clickHandler:Ha.vo},headerMenuButtonProps:(0,Ha.qP)(),showCreditButton:(0,g.H)(),enableChatHistory:(0,g.XX)()},He={showCopilotSwitcherMenu:!0,copilotList:Oe,handleCopilotChatChange:$e,showNewChatButtonOnTop:!1,enableMorePlugins:!0,paneSilhouetteHeaderProps:(0,g.aC)()?Be:void 0};y.useEffect((()=>{((0,g.kk)()||(0,g.l6)()||(0,g.Sh)())&&async function(){const n=await(0,de.m4)(e,t);(0,b.cY)("SDX ClientInfo : ",n),a($a.mF.setClientInfo(n)),_e.updateClientInfo(n)}()}),[e,t]);const Ue=y.useRef((0,z.XG)()),{onAttachCloudFiles:qe}=(0,D.lqj)({clientInfoRef:Ue,theme:e,locale:a($a.mF.getLocaleInfo()).dataLocale||"en-us",clientId:D.xkN,redirectUri:(0,de.cn)(),isWebPlatform:j.i.isWebPlatform()}),Ve=y.useMemo((()=>{const{userPrincipalName:e}=Ue.current;return new D.jYE({userPrincipalName:e,redirectUri:(0,de.cn)(),clientId:D.xkN})}),[Ue.current]),Ge=dn(u,c,v,An(a,(0,Ya.pX)()?void 0:S,E,R,I,F,L,_e,A),a,E,(0,Ya.pX)()?void 0:S,f,Te,Le,le,N,qe,k,T),ze=P||(0,g.aC)()||(0,g.yw)("OfficeVSO_9469778_ShowDebugOptionsIfReviewAgentDisabled")&&Ea()?He:void 0,Qe={copilotCommunicationHandler:_e,style:za(),platformType:(0,Q.xp)(),theme:(0,h.eS)(e,t),useALRuntime:!1,ref:O,chatUiProps:Ge,basicChatProps:n,copilotTelemetryHandler:te.B.getInstance(),copilotPluginProps:ze,copilotFeatureFlags:Ae,hostAppAuthTokens:(0,g.Sh)()?{graphTokenProvider:async e=>await(0,D.v5s)(Ve),sharepointTokenProvider:async e=>{const t=(0,D.QF0)(e??Ba.w8.sharepoint);return await(0,D.OzJ)(Ve,t)}}:{},themeV2:(0,g.iP)("Microsoft.Office.Excel.FA000000124.EnableFluent2Tokens",!1)?(0,D.IdZ)(h.v1,e,t,(0,_a.xt)()?"rtl":"ltr"):void 0},Je=(0,g.aC)()?V.e:q.zn;return P?y.createElement("div",{onKeyDown:Ne},y.createElement(d.W,null,le?re?y.createElement("div",null,"Loading Reviewer Agent..."):y.createElement(ee,{alSession:M||void 0,onReviewerAgentToggleChange:Le,onApplySuggestion:Oa,userQuery:me,addCommentToFirstLineOfDocument:Pa,onSuggestionCardNavigation:Na,isDarkModeEnabled:(0,h.eS)(e,t).isDarkModeEnabled,isHighContrastModeEnabled:(0,h.eS)(e,t).isHighContrastModeEnabled,documentURL:fe,authorName:he.displayName,authorEmail:he.email,isReviewerNotAddedButtonClicked:ce,getDocumentSensitivity:Ma,agentLaunchType:ye,isReviewerToggleEnabled:!0,peoplePickerEditorConfig:Da()}):re?y.createElement("div",null,"Loading Chat..."):y.createElement(Je,Qe),(0,g.w9)()?y.createElement("div",{className:ke.root},y.createElement(We.T,{resize:"both",onChange:(e,t)=>{St.CP.setPythonAdaStaticPromptOverride(t.value)}})):null),y.createElement(wa,{communicationHandler:_e,setCannedOption:e=>_e.cannedOption=e})):y.createElement("div",{onKeyDown:Ne},y.createElement(d.W,null,y.createElement(Je,Qe),(0,g.w9)()?y.createElement("div",{className:ke.root},y.createElement(We.T,{resize:"both",onChange:(e,t)=>{St.CP.setPythonAdaStaticPromptOverride(t.value)}})):null),y.createElement(wa,{communicationHandler:_e,setCannedOption:e=>_e.cannedOption=e}))};var On=a(24557),Pn=a(15772),Mn=a(53681),Dn=a(8947),$n=a(26532);let Bn;async function Hn(e,t,a,n,o,i){try{if((0,g.yw)("OfficeVSO_8455363_MoveInitializationCodeToInitializeTasks")){if((0,Pn.v)(),Office.context.platform===Office.PlatformType.PC?(n(Office.context.officeTheme.bodyBackgroundColor,!0),t().catch((e=>{(0,de.cY)("Register Theme Callback() error: "+e),ae.M.getInstance().logError({eventType:ce.S.Error,errorMessage:e,logLevel:K.$b.Error})}))):(0,Fn.OK)()&&Office.context?.themeManager?.getOfficeThemeAsync((e=>{if("succeeded"===e.status){const a=e.value;n(a.bodyBackgroundColor,!0),t()}})),(0,g.yw)("OfficeVSO_8565845_GateForConsumer")){const e=await OfficeFirstPartyAuth.getPrimaryIdentityInfo(),t=e.identityType===OfficeCore.IdentityType.organizationAccount?D.utd.Enterprise:e.identityType===OfficeCore.IdentityType.microsoftAccount?D.utd.Consumer:D.utd.Unknown;i($a.mF.setUserType(t)),(0,g.Aw)(t)}window.matchMedia("(forced-colors: active)").matches&&a(!0)}(0,g.Wd)()&&(0,D.YPU)(r.fn_,de.cY,te.B.getInstance(),{IsClpEnabledInEnterpriseForSydney:()=>(0,g._b)(),IsApplyLabelUsingTryUpgradeLabelEnabled:()=>(0,g._b)(),IsUserTypeEnterprise:()=>(0,g.Dl)(),getOfficeJSDocumentURL:()=>j.i.getDocumentUrlAsync(),shouldCLPExceptionDisableEnterpriseSearch:()=>(0,g.vI)(),setEnableEnterpriseSearchOverride:Ya.LA});const e=(new Date).getTime();await(0,_a.XX)(),Bn=((new Date).getTime()-e)/1e3,bn.E.getInstance().logLatency(Bn,K.OP.LoadLocalizedStrings),$n.j.getInstance().logEventWithAshaPillar([],"","","Copilot:Chat Pane:Chat Pane"),Y.Vv.IsSettingTrue(Y.zj.ExcelSdxPrivateApiEnabled)&&Dn.s.getInstance().initializePrivateApi(),Y.Vv.IsSettingTrue(Y.zj.ButtonEnabledForLocalFiles)&&async function(e){await Excel.run((async t=>{t.workbook.settings.onSettingsChanged.add((()=>Excel.run((async t=>{const a=function(e,t){const a=e.getItemOrNullObject(t);return a.load("isNullObject,value"),a}(t.workbook.settings,"setState");await t.sync(),a.isNullObject||((0,b.cY)("Setting changed: state: "+JSON.stringify(a.value)),e(Number(a.value.copilotState),a.value.augLoopId),a.delete())}))))})),await f("OnLoad")}(((e,t)=>{o(e),t&&(0,Et.V1)(t)}))}catch(e){e instanceof D.DYx&&(0,de.cY)(e.message)}Ln.preloadCopilot&&(0,g.jl)()?function(e){"function"==typeof window.requestIdleCallback?requestIdleCallback((()=>e(!0)),{timeout:5e3}):setTimeout((()=>e(!0)),0)}(e):e(!0)}const Un={},qn=(0,y.createContext)(Un),Vn=e=>{const[t,a]=y.useState(l.G.defaultWhite),[i,c]=y.useState(h.QJ.disabled),[d,u]=y.useState(!1),[m,p]=y.useState(void 0),b=(0,Ca.j)(),f=e=>{const t=window.matchMedia("(prefers-color-scheme: light)").matches;(0,s.uj)(e),e?c(t?h.QJ.light:h.QJ.dark):(c(h.QJ.disabled),T(Office.context.officeTheme.bodyBackgroundColor,!1))};y.useEffect((()=>{const e=e=>{f(e.matches)};return window.matchMedia("(forced-colors: active)").addEventListener("change",e),()=>{window.matchMedia("(forced-colors: active)").removeEventListener("change",e)}}),[]);const C=e=>{T(e.officeTheme.bodyBackgroundColor,!0)},v=async()=>{Office.context?.themeManager&&await Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,C)},T=(e,t)=>{const n=(0,h.mR)(e,t),o=(0,h.j2)(n);b(At.mF.setIsDarkModeEnabled(o)),a(n)};y.useEffect((()=>{const e=e=>{window.matchMedia("(forced-colors: active)").matches&&c(e.matches?h.QJ.light:h.QJ.dark)};return window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",e),()=>{window.matchMedia("(prefers-color-scheme: light)").removeEventListener("change",e)}}),[]),y.useEffect((()=>{(0,g.yw)("OfficeVSO_8455363_MoveInitializationCodeToInitializeTasks")||((0,Pn.v)(),Office.context.platform===Office.PlatformType.PC?(T(Office.context.officeTheme.bodyBackgroundColor,!0),v().catch((e=>{(0,de.cY)("Register Theme Callback() error: "+e),ae.M.getInstance().logError({eventType:ce.S.Error,errorMessage:e,logLevel:K.$b.Error})}))):(0,Fn.OK)()&&Office.context?.themeManager?.getOfficeThemeAsync((e=>{if("succeeded"===e.status){const t=e.value;T(t.bodyBackgroundColor,!0),v()}})),window.matchMedia("(forced-colors: active)").matches&&f(!0));const e=e=>{p((t=>t===n.Enabled?((0,de.cY)("Leaving copilotState as Enabled instead of changing to "+e),t):(e!==n.Enabled?(0,de.sZ)():window.document.getElementById(r.OsU)?.style.removeProperty("display"),(0,de.cY)("Updating copilotState to "+e),e)))};o.$.getInstance().startLoadingPaneTimeout(!1),(async()=>{await Hn(u,v,f,T,e,b)})()}),[]),y.useEffect((()=>{switch(i){case h.QJ.light:(0,s.N_)(l.G.defaultWhite),a(l.G.defaultWhite);break;case h.QJ.dark:(0,s.N_)(l.G.defaultBlack),a(l.G.defaultBlack)}}),[i]);const S=(0,D.Qk5)((0,_a.gl)(),void 0);if(d){if(Y.Vv.IsSettingTrue(Y.zj.ButtonEnabledForLocalFiles)&&m!==n.Enabled)return void 0===m?y.createElement("div",null):(0,g.vC)()?y.createElement(On.q,{dir:(0,_a.xt)()?"rtl":"ltr"},y.createElement(x,{copilotState:m,theme:t,isHighContrast:i!==h.QJ.disabled})):y.createElement(x,{copilotState:m,theme:t,isHighContrast:i!==h.QJ.disabled});{const e=y.createElement(kn,{theme:t,isHighContrast:i!==h.QJ.disabled}),a=(0,g.Pu)()?y.createElement(D.G41,{lookupString:S},e):e;return y.createElement(qn.Provider,{value:{sdxTheme:t,highContrastClientMode:i}},y.createElement("div",{className:"ms-welcome"},(0,g.vC)()?y.createElement(On.q,{dir:(0,_a.xt)()?"rtl":"ltr"},a):a))}}return y.createElement(ie.B,{styles:Qa},y.createElement(Mn.y,null))}},37488:(e,t,a)=>{a.d(t,{appLoadStartTime:()=>pt,copilotPaneStartTimestamp:()=>ft,excelTaskPaneStartTime:()=>ht,hasPreloadedCopilotBeenShown:()=>Tt,isSDXRenderingForPreload:()=>vt,officeOnReadyTime:()=>bt,preloadCopilot:()=>Ct});var n=a(89099),o=a(24220),r=a(92779),i=a(54738),l=a(77131),s=a(51423),c=a(50347),d=a(37745),u=a(8520);const m={root:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}},g=()=>{let e;return(0,c.yw)("OfficeVSO_9227275_RtlErrorScreen")&&(e=(0,d.xt)()?"rtl":"ltr"),u.createElement(i.B,{styles:m,dir:e},u.createElement(l.E,{variant:"large"},(0,r.Oj_)()),u.createElement(l.E,{variant:"medium"},(0,r.RCr)()),u.createElement("br",null),u.createElement(s.j,{onClick:()=>{window.location.reload()},text:(0,r.BVL)()}),u.createElement("br",null))};var h=a(48314),p=a(58651);class b extends u.Component{static getDerivedStateFromError(e){return h.M.getInstance().logUncaughtException(e),{hasError:!0,error:e}}componentDidCatch(e,t){p.error(e,t)}render(){return this.state.hasError?u.createElement(g,null):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:void 0}}}var f=a(5550),C=a(88179),y=a(49462),v=a(79029),T=a(96854),x=a(11689),S=a(23147),w=a(61150),E=a(22330),R=a(49437),I=a(77303),A=a(94329),L=a(94836),F=a(72842),_=a(66036),N=a(31030),k=a(59384);const O="#".repeat(255);class P{get resolve(){return this._resolve}constructor(){this.promise=new Promise((e=>{this._resolve=e}))}}class M{getOrCreateCellJobs(e,t){const a=M.hash(e,t);let n=this.cellJobs[a];return n||(n={formatAggregatedValues:{}},this.cellJobs[a]=n),n}getValue(e,t){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to get deferred value after deferred jobs have resolved. This can impact performance",logLevel:C.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.value||(a.value=new P),a.value.promise}getText(e,t){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to get deferred text after deferred jobs have resolved. This can impact performance",logLevel:C.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.text||(a.text=new P),a.text.promise}getFormat(e,t){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to get deferred number format after deferred jobs have resolved. This can impact performance",logLevel:C.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.numberFormat||(a.numberFormat=new P),a.numberFormat.promise}getFormatLocal(e,t){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to get deferred local number format after deferred jobs have resolved. This can impact performance",logLevel:C.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.numberFormatLocal||(a.numberFormatLocal=new P),a.numberFormatLocal.promise}formatAggregateValue(e,t,a){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to format aggregated value after jobs have resolved. This can impact performance",logLevel:C.$b.Error}),this.getFormatLocal(e,t);const n=this.getOrCreateCellJobs(e,t);return n.formatAggregatedValues[a]||(n.formatAggregatedValues[a]=new P),n.formatAggregatedValues[a].promise}formatSourceValue(e,t){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to format source value after jobs have resolved. This can impact performance",logLevel:C.$b.Error}),this.getValue(e,t),this.getFormatLocal(e,t);const a=this.getOrCreateCellJobs(e,t);return a.formatSourceValue||(a.formatSourceValue=new P),a.formatSourceValue.promise}formatSourceDate(e,t){this.hasResolved&&h.M.getInstance().logError({eventType:N.S.Error,errorMessage:"Attempted to format date after jobs have resolved. This can impact performance",logLevel:C.$b.Error}),this.getValue(e,t);const a=this.getOrCreateCellJobs(e,t);return a.formatSourceDate||(a.formatSourceDate=new P),a.formatSourceDate.promise}getTranslations(e,t){return{getValue:this.translate(this.getValue,e,t),getText:this.translate(this.getText,e,t),getFormat:this.translate(this.getFormat,e,t),getFormatLocal:this.translate(this.getFormatLocal,e,t),formatAggregateValue:this.translate(this.formatAggregateValue,e,t),formatSourceValue:this.translate(this.formatSourceValue,e,t),formatSourceDate:this.translate(this.formatSourceDate,e,t)}}translate(e,t,a){return(n,o,...r)=>e.call(this,n+t,o+a,...r)}async resolveJobs(){this.hasResolved=!0;const{sheetId:e}=this;for(;Object.keys(this.cellJobs).length>0;){const{cellJobs:t}=this;this.cellJobs={},await M.resolveJobs(t,e)}}static async resolveJobs(e,t){await Excel.run((async a=>{const n={},o=a.workbook.worksheets.getItem(t);for(const[t,a]of Object.entries(e)){const{row:e,column:r}=M.unhash(t),i=[];a.text&&i.push("text"),a.value&&i.push("values"),a.numberFormat&&i.push("numberFormat"),a.numberFormatLocal&&i.push("numberFormatLocal"),n[t]=o.getCell(e,r).load(i)}await a.sync();for(const t in n){const a=e[t],o=n[t];a.text&&a.text.resolve(o.text[0][0]),a.value&&a.value.resolve(o.values[0][0]),a.numberFormat&&a.numberFormat.resolve(o.numberFormat[0][0]),a.numberFormatLocal&&a.numberFormatLocal.resolve(o.numberFormatLocal[0][0])}const r=Excel.NumberFormattingService.newObject(a),i=[];function l(e,t,a,n){if(Number.isNaN(e)||_.P.getNumberFormatCache().isDateTime(a)&&!$.isValidDateTime(e))n(O);else{const a=t.format(e);i.push((()=>n(a.value)))}}for(const t in e){const a=e[t],o=n[t];if(a.formatSourceValue||Object.keys(a.formatAggregatedValues).length>0){const e=o.numberFormatLocal[0][0],t=r.getFormatter(e);if(a.formatSourceValue){const n=o.values[0][0];"number"==typeof n?l(n,t,e,a.formatSourceValue.resolve):a.formatSourceValue.resolve(void 0)}for(const n in a.formatAggregatedValues){const{resolve:o}=a.formatAggregatedValues[n];l(Number.parseFloat(n),t,e,o)}}if(a.formatSourceDate){const e=o.values[0][0];if("number"==typeof e){l(e,r.getFormatter(k.D4),k.D4,a.formatSourceDate.resolve)}else a.formatSourceDate.resolve(void 0)}}0!==i.length&&(await a.sync(),i.forEach((e=>e())))}))}static hash(e,t){return`${e},${t}`}static unhash(e){const[t,a]=e.split(",");return{row:Number.parseInt(t),column:Number.parseInt(a)}}constructor(e){this.sheetId=e,this.cellJobs={},this.hasResolved=!1}}var D=a(40910);class ${isFormattingSupported(){return!0}formatValue(e,t){return Number.isNaN(e)||_.P.getNumberFormatCache().isDateTime(t)&&!$.isValidDateTime(e)?Promise.resolve(O):Excel.run((async a=>{const n=Excel.NumberFormattingService.newObject(a).getFormatter(t).format(e);return await a.sync(),n.value}))}async getFormatMetadata(e){const t=performance.now(),a=await Excel.run((async t=>{const a=Excel.NumberFormattingService.newObject(t),n=e.map((e=>a.getFormatter(e).load("*")));return await t.sync(),n.map((e=>e.toJSON()))}));return(0,D.NQ)("GetNumberFormatMetadata",performance.now()-t),a}static isValidDateTime(e){return!(e<0||e>2958465.99999999)}}var B,H=a(81364);function U(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0!==t&&void 0!==a&&void 0===n&&void 0===o}function q(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0===t&&void 0===a&&void 0===n&&void 0!==o}function V(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0!==t&&void 0!==a&&void 0!==n&&void 0===o}!function(e){e.Self="self",e.EvaluateQuery="evaluate-query",e.AnalyzeTyping="analyze-typing",e.GenerateSuggestedQueries="generate-suggested-queries",e.GenerateResultForNLEvaluation="generate-result-for-nl-evaluation",e.NLEvaluationResult="nl-evaluation-result",e.Interpretations="interpretations"}(B||(B={}));var G=a(62646),W=a(23343),z=a(98483);function Q(e,t){e.onerror=()=>{t(new H.u(H.O.NetworkError))},e.timeout=W.R.getAnalyzeDataNetworkTimeout(),e.ontimeout=()=>{t(new H.u(H.O.NetworkTimeout))}}function J(e,t){t&&Object.keys(t).forEach((a=>{e.setRequestHeader(a,t[a])}))}function j(e,t,a){const n=(0,z.A)().replace(/-/g,"").slice(0,16);let o;o=t?.[r.Vno]?t[r.Vno]:(0,z.A)(),o=o.replace(/-/g,"");const i=`00-${o}-${n}-01`;e.setRequestHeader("traceparent",i),a.push({key:C.W0.TraceId,value:o}),a.push({key:C.W0.SpanId,value:n})}var Y=a(93887),X=a(91259);const K="Forecast({0})",Z="Lower Confidence Bound({0})",ee="Upper Confidence Bound({0})",te="=FORECAST.ETS(A{0},{1},{2})",ae="=C{0}-FORECAST.ETS.CONFINT(A{0},{1},{2})",ne="=C{0}+FORECAST.ETS.CONFINT(A{0},{1},{2})",oe="$A$2:$A$",re="$B$2:$B$",ie="General";function le(e){const t=[...e.originalTimeValues,...e.resultTimeValues],a=e.originalValues.length,n=e.resultValues.length,o=a+n,r=e.originalValues[a-1],i=[...e.originalValues,...new Array(n).fill(null)],l=oe+(a+1),s=re+(a+1),c=a+2,d=(0,Y.Kz)(n,(e=>(0,X.L)(te,e+c,s,l))),u=(0,Y.Kz)(n,(e=>(0,X.L)(ae,e+c,s,l))),m=(0,Y.Kz)(n,(e=>(0,X.L)(ne,e+c,s,l))),g=[...new Array(a-1).fill(null),r,...d],h=[...new Array(a-1).fill(null),r,...u],p=[...new Array(a-1).fill(null),r,...m];return{fields:[de(1,t),de(2,i,new Array(o).fill(ie)),de(3,g,new Array(o).fill(ie)),de(4,h,new Array(o).fill(ie)),de(5,p,new Array(o).fill(ie))],fieldHeaders:[{runs:[{text:e.timeColumnName}]},{runs:[{text:e.valueColumnName}]},{runs:[{text:(0,X.L)(K,e.valueColumnName)}]},{runs:[{text:(0,X.L)(Z,e.valueColumnName)}]},{runs:[{text:(0,X.L)(ee,e.valueColumnName)}]}]}}function se(e){return{fields:[de(1,e.resultTimeValues.slice(0,5)),de(2,e.resultValues.slice(0,5))],fieldHeaders:[{runs:[{text:e.timeColumnName}]},{runs:[{text:(0,X.L)(K,e.valueColumnName)}]}]}}function ce(e){const t=[{dimensionType:"categories",title:{runs:[{text:e.timeColumnName}]},axisGroup:"primary"},{dimensionType:"values",title:{runs:[{text:e.valueColumnName}]},axisGroup:"primary",linearValueScale:{zeroPolicy:"includeZero"}}],a=[...e.originalTimeValues,...e.resultTimeValues],n=e.originalValues.length,o=e.resultValues.length,r=n+o,i=e.originalValues[n-1],l=[...e.originalValues,...new Array(o).fill(null)],s=[...new Array(n-1).fill(null),i,...e.resultValues],c=[...new Array(n-1).fill(null),i,...e.lowerBound],d=[...new Array(n-1).fill(null),i,...e.upperBound],u={top:1,bottom:r,left:1,right:1},m={top:1,bottom:r,left:2,right:2},g={top:1,bottom:r,left:3,right:3},h={top:1,bottom:r,left:4,right:4};return{axes:t,data:{dimensions:[de(1,a,void 0,[{top:1,bottom:r,left:0,right:0}]),de(2,l,new Array(r).fill(ie),[u]),de(3,s,new Array(r).fill(ie),[m]),de(4,c,new Array(r).fill(ie),[g]),de(5,d,new Array(r).fill(ie),[h]),ue(6,e.valueColumnName,[{top:0,bottom:0,left:1,right:1}]),ue(7,(0,X.L)(K,e.valueColumnName),[{top:0,bottom:0,left:2,right:2}]),ue(8,(0,X.L)(Z,e.valueColumnName),[{top:0,bottom:0,left:3,right:3}]),ue(9,(0,X.L)(ee,e.valueColumnName),[{top:0,bottom:0,left:4,right:4}])]},series:[me(1,2,6),me(1,3,7),me(1,4,8),me(1,5,9)],showLegend:!0}}function de(e,t,a,n){return{id:e,values:{raw:t,strings:t.map((e=>e?.toString()??"")),formats:a},references:n}}function ue(e,t,a){return{id:e,values:{raw:[t],strings:[t]},references:a}}function me(e,t,a){return{layout:"line",valueAxisGroup:"primary",exceptions:[],dataBindings:[{dimensionId:e,dimensionType:"categories"},{dimensionId:t,dimensionType:"values"},{dimensionId:a,dimensionType:"title"}]}}var ge=a(93471),he=a(56229),pe=a(87919),be=a(18700);const fe="#VALUE!";async function Ce(e,t,a){return 1===t.length&&void 0!==t[0].row&&void 0!==t[0].column?e.getText(t[0].row,t[0].column):(0,k.Hf)(e,t,a)}function ye(e){const t=function(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`ValueFilter: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null==e.columnFieldIndex?{labelFieldIndex:e.rowFieldIndex,labelFieldType:"rowField"}:{labelFieldIndex:e.columnFieldIndex,labelFieldType:"columnField"}}(e);switch(e.filterType){case"equal":case"notEqual":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"startsWith":case"notStartsWith":case"endsWith":case"notEndsWith":case"contains":case"notContains":return{...t,filterType:e.filterType,value:e.value};case"between":case"notBetween":return{...t,filterType:e.filterType,value:e.value,value2:e.value2};default:return(0,F.x)(e.filterType)}}function ve(e){const t=e=>new Date(86400*(e-25569)*1e3),a=function(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`DateFilterBase: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null==e.columnFieldIndex?{fieldIndex:e.rowFieldIndex,fieldType:"rowField"}:{fieldIndex:e.columnFieldIndex,fieldType:"columnField"}}(e);switch(e.filterType){case"inDynamicPeriod":return{...a,filterType:e.filterType,periodType:e.periodType};case"between":case"notBetween":return{...a,filterType:e.filterType,value:t(e.value),value2:t(e.value2),wholeDays:e.wholeDays};case"equal":case"notEqual":case"before":case"beforeOrEqual":case"after":case"afterOrEqual":return{...a,filterType:e.filterType,value:t(e.value),wholeDays:e.wholeDays};default:return(0,F.x)(e.filterType)}}function Te(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`ValueFilter: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null!=e.rowFieldIndex?{labelFieldIndex:e.rowFieldIndex,labelFieldType:"rowField"}:{labelFieldIndex:e.columnFieldIndex,labelFieldType:"columnField"}}function xe(e){const t={...Te(e),dataFieldIndex:e.dataFieldIndex};switch(e.filterType){case"bottomItems":case"bottomPercent":case"bottomSum":case"equal":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"notEqual":case"topItems":case"topPercent":case"topSum":return{...t,filterType:e.filterType,value:e.value};case"between":case"notBetween":return{...t,filterType:e.filterType,value:e.value,value2:e.value2};default:return(0,F.x)(e.filterType)}}function Se(e){return(e.columnFields||[]).length>0||0===(e.dataFields||[]).length}function we(e){return Math.max((e.rowFields||[]).length,1)}function Ee(e){const t=(e.rowFields||[]).length,a=(e.columnFields||[]).length,n=(e.dataFields||[]).length;return e.pivotTableData&&function(e){if(1===n&&(t>0&&a>0||0===t&&0===a)){return[[{dataFieldIndex:0},...e[0].slice(1)],...e.slice(1)]}return e}((o=function(t){const a=we(e);return a>1?[t.slice(0,a).reduce(((e,t)=>e.map(((e,a)=>e||t[a]))),t[0]),...t.slice(a)]:t}(e.pivotTableData),Se(e)?o.map((e=>[null,...e])):o));var o}function Re(e,t){return Se(e)?t+1:t}function Ie(e,t){return Math.max(t-we(e)+1,0)}function Ae(e){const t=(e.rowFields||[]).length,a=(e.columnFields||[]).length,n=(e.dataFields||[]).length,o=null!=e.grandTotalRowIndex&&(0!==t||a>0&&1===n)?Re(e,e.grandTotalRowIndex):void 0,r=null==e.grandTotalColumnIndex?e.grandTotalColumnIndex:Ie(e,e.grandTotalColumnIndex),i=e.grandTotalColumnIndices?.map((t=>Ie(e,t))),l=(e.dataFields||[]).map((t=>({...t,dataTableColumnIndices:t.dataTableColumnIndices?.map((t=>Ie(e,t)))}))),s=e.highlightCellReferences?.map((t=>{const{row:a,column:n}=t;return{row:null==a?a:Re(e,a),column:null==n?n:Ie(e,n)}})),c=e.subTotalColumnIndices?.map((t=>Ie(e,t))),d=e.subTotalRowIndices?.map((t=>Re(e,t)));return function(e){const t=e.pivotTableData.slice(0,k.y3).map((e=>e.slice(0,k.m6))),a=e=>void 0!==e&&e<k.m6,n=e=>void 0!==e&&e<k.y3,o=a(e.grandTotalRowIndex)?e.grandTotalRowIndex:void 0,r=n(e.grandTotalColumnIndex)?e.grandTotalColumnIndex:void 0,i=e.grandTotalColumnIndices?e.grandTotalColumnIndices.filter(n):void 0,l=e.subTotalRowIndices?e.subTotalRowIndices.filter(a):void 0,s=e.subTotalColumnIndices?e.subTotalColumnIndices.filter(n):void 0,c=e.dataFields.map((e=>({...e,dataTableColumnIndices:e.dataTableColumnIndices?.filter(n)})));return{...e,pivotTableData:t,dataFields:c,grandTotalRowIndex:o,grandTotalColumnIndex:r,grandTotalColumnIndices:i,subTotalRowIndices:l,subTotalColumnIndices:s}}({...e,pivotTableData:Ee(e),dataFields:l,subTotalColumnIndices:c,subTotalRowIndices:d,grandTotalRowIndex:o,grandTotalColumnIndex:r,grandTotalColumnIndices:i,highlightCellReferences:s})}async function Le(e,t,a,n,o){return 0!==t.pivotTableData.length&&t.pivotTableData.some((e=>e.some((e=>!!e&&(void 0!==e.value||(void 0!==e.row||void 0!==e.column)&&void 0===e.dataFieldIndex)))))?Promise.all((t.pivotTableData||[]).map(((i,l)=>Promise.all(i.map(((i,s)=>async function(e,t,a,n,o,i,l){const s=t.pivotTableData[n][a],{rowFields:c,columnFields:d,dataFields:u}=t,m=(c||[]).length,g=(d||[]).length,h=(u||[]).length,p=0===n?i[a]:0;if(s){if(function(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0===t&&void 0===a&&void 0!==n&&void 0===o}(s)||V(s))return{value:await Fe(e,s,u,o),isNumber:!1,indent:p};if(U(s)){const t=e.getValue(s.row,s.column),a=e.getText(s.row,s.column),n=e.getFormat(s.row,s.column),o=e.formatSourceValue(s.row,s.column),[i,l,c,d]=await Promise.all([t,a,n,o]);if(i===fe)return{value:l,isNumber:!1,indent:p};if(d){const e=s.datePartOverride;return e?{value:(0,ge.xb)(i,e),isNumber:!1,indent:p}:{value:"General"===c?i:d,isNumber:!0,indent:p}}return{value:null==i?(0,r.Atw)():i,isNumber:!1,indent:p}}if(q(s)){const t=u.find((e=>e.dataTableColumnIndices.some((e=>e===n))));if(!!t&&!!t.showAsCalculation&&"percentOfGrandTotal"===t.showAsCalculation){return{value:`${s.value.toFixed(2)}%`,isNumber:!0,indent:p}}return t?.formatReference?_e(e,s.value,t.formatReference,p):{value:s.value,isNumber:!0,indent:p}}throw new Error(`Invalid PivotTableDataValue. Provided entries: [${Object.entries(s)}]`)}if(m>0&&a===(0,k.HF)(t)-1&&0===n){if(l&&1===m){return{value:await Ce(e,c[0].nameReferences,o),isNumber:!1,indent:p}}return{value:(0,r.VDh)(),isNumber:!1,indent:p}}if(g>0&&0===a){if(n===(1===h||m>0?1:0)){if(l&&1===g){return{value:await Ce(e,d[0].nameReferences,o),isNumber:!1,indent:p}}return{value:(0,r.NRU)(),isNumber:!1,indent:p}}}return{value:"",isNumber:!1,indent:p}}(e,t,s,l,a,n,o))))))):[]}async function Fe(e,t,a,n){const o=t.dataFieldIndex;if(o<0||o>2*a.length)throw new Error(`Invalid PivotTableDataValue.dataFieldIndex: "${o}" for number of dataFields ${a.length}`);const i=a[o%(a.length+1)],l=i&&(0,he.iz)(i.dataCalculation);let s,c=Promise.resolve(void 0),d=Promise.resolve(void 0);V(t)&&(c=e.getText(t.row,t.column)),o<a.length&&(d=Ce(e,i.nameReferences,n));const[u,m]=await Promise.all([c,d]);if(null!=u&&(s=(0,be.So)(u)?(0,r.Atw)():u),null!=m)return(0,X.L)((0,r.Gn5)(),l,m);if(V(t)){if(o>a.length){const t=await Ce(e,i.nameReferences,n);return(0,X.L)((0,r.u6S)(),s,l,t)}return(0,X.L)((0,r.ZSg)(),s)}if(o>a.length){const t=await Ce(e,i.nameReferences,n);return(0,X.L)((0,r.ft7)(),l,t)}return(0,r.AZo)()}async function _e(e,t,a,n){const o=e.getFormat(a.row,a.column),r=e.formatAggregateValue(a.row,a.column,t),[i,l]=await Promise.all([o,r]);return"General"===i?{value:t,isNumber:!0,indent:n}:{value:l,isNumber:!0,indent:n}}async function Ne(e,t,a,n,o,r){const i=Promise.all((t.dataFields||[]).map((t=>async function(e,t,a){const{nameReferences:n,formatReference:o}=t,r=(0,k.Hf)(e,n,a),i=o&&e.getFormatLocal(o.row,o.column),[l,s]=await Promise.all([r,i]);return{name:l,dataCalculation:t.dataCalculation,showAsCalculation:t.showAsCalculation,numberFormat:s}}(e,t,a)))),l=t=>async function(e,t,a,n){const o=(0,k.Hf)(e,t.nameReferences,n),[r,i]=await Promise.all([o,a]),l={name:r};t.sortOrder&&(l.sortOrder=t.sortOrder);const s=t.sortByDataField;if("number"==typeof s){if(!(s<i.length))throw new Error("Invalid sortByDataField.");l.sortBy=i[s].name}return t.datePartOverride&&(l.datePartOverride=t.datePartOverride),l}(e,t,i,a),s=Promise.all((t.rowFields||[]).map(l)),c=Promise.all((t.columnFields||[]).map(l)),d=Promise.all((t.filterFields||[]).map((t=>async function(e,t,a){const n=Promise.all((0,pe.w)(t.valueReferences,((t,a)=>(0,k.Pe)(e,t,a)))),o=(0,k.Hf)(e,t.nameReferences,a);let r;const i=t.datePartOverride;let l,s;if(i){const a=async(t,a)=>{const n=await e.getValue(t,a);return"number"==typeof n?n:void 0},c=Promise.all((0,pe.w)(t.valueReferences,a)),[d,u,m]=await Promise.all([n,o,c]);l=d,s=u,r={datePartOverride:i,values:m.filter((e=>void 0!==e))}}else[l,s]=await Promise.all([n,o]);return{name:s,values:l,datePart:r}}(e,t,a)))),u=n?Le(e,t,a,r,o):Promise.resolve(void 0),[m,g,h,p,b]=await Promise.all([i,s,c,d,u]);return{rowFields:g,columnFields:h,filterFields:p,dataFields:m,valueFilters:(t.valueFilters||[]).map(xe),labelFilters:(t.labelFilters||[]).map(ye),dateFilters:(t.dateFilters||[]).map(ve),pivotTableData:b,subTotalRowIndices:t.subTotalRowIndices,subTotalColumnIndices:t.subTotalColumnIndices,grandTotalRowIndex:t.grandTotalRowIndex,grandTotalColumnIndices:t.grandTotalColumnIndices,highlightCellReferences:t.highlightCellReferences||[]}}function ke(e,t,a,n,o){return Ne(e,n?Ae(t):t,a,n,o,n?function(e){if(0===e.pivotTableData.length)return[];const t=we(e),a=e.pivotTableData.slice(0,t),n=a[0].map(((e,t)=>Math.max(a.map((e=>e[t])).findIndex((e=>!!e))-1,0)));return Se(e)?[0,...n]:n}(t):void 0)}var Oe=a(91960);const Pe=async(e,t,a)=>{const n=e.getFormat(t,a),o=e.getFormatLocal(t,a),[r,i]=await Promise.all([n,o]);return{format:r,formatLocal:i,isDateTime:_.P.getNumberFormatCache().isDateTime(i)}};async function Me(e,t,a,n){const o=[];t.forEach((e=>{for(let t=e.top;t<=e.bottom;t++)for(let n=e.left;n<=e.right;n++)o.push(a[n][t])}));const i=Promise.all(o.map(De.bind(null,e))),l=Promise.all(o.map($e.bind(null,e))),[s,c]=await Promise.all([i,l]);return{raw:n?(0,Oe.m9)(s):s,strings:n?c.map(((e,t)=>null===s[t]?(0,r.Atw)():e)):c}}async function De(e,t){return t?U(t)?e.getValue(t.row,t.column):q(t)?t.value:"":""}async function $e(e,t){return t?U(t)?e.getText(t.row,t.column):q(t)?t.value.toString():"":""}async function Be(e,t,a,n){const[o,i]=await Promise.all([(()=>{if(n&&t.references)return Me(e,t.references,n,a);if(t.references)return async function(e,t,a){const n=Promise.all((0,pe.w)(t,e.getValue.bind(e))),o=Promise.all((0,pe.w)(t,e.getText.bind(e))),i=Promise.all((0,pe.w)(t,((t,a)=>e.getFormat(t,a)))),l=Promise.all((0,pe.w)(t,((t,a)=>e.getFormatLocal(t,a)))),[s,c,d,u]=await Promise.all([n,o,i,l]);return{raw:a?(0,Oe.m9)(s):s,strings:a?c.map(((e,t)=>null===s[t]?(0,r.Atw)():e)):c,formats:d,formatLocals:u}}(e,t.references,a);if(t.values)return async function(e,t,a){const n={raw:t,strings:t.map((e=>e.toString()))};if(a){const o=Promise.all(t.map((t=>_e(e,t,a,0)))),r=e.getFormat(a.row,a.column),i=e.getFormatLocal(a.row,a.column),[l,s,c]=await Promise.all([o,r,i]);return{...n,formattedValues:l,formats:t.map((()=>s)),formatLocals:t.map((()=>c))}}return n}(e,t.values.map((e=>"number"==typeof e?e:parseFloat(e))),t.formatReference);throw new Error("FieldData has no values or references.")})(),(async()=>{const a=t.formatReference;if(a){const{row:t,column:n}=a;if(void 0===t&&void 0===n)throw new Error("V3SourceCellReference is missing both row and column references.");return Pe(e,t,n)}const o=t.references;if(o&&o.length>0){const t=o[0],a=t.top,r=t.left;let i,l;if(n){const e=n[r][a];e&&U(e)&&(i=e.row,l=e.column)}else i=a,l=r;if(void 0!==i&&void 0!==l)return Pe(e,i,l)}})()]),l={id:t.id,values:o,formatInfo:i};return t.references&&(l.references=t.references),(e=>{const a=t.datePartOverride;if(null==a)return e;{const t=e.values.raw.map((e=>(0,ge.xb)(e,a)));return{...e,formatInfo:void 0,values:{...e.values,raw:t,strings:t,formats:Array(t.length).fill(null),formatLocals:Array(t.length).fill(null)}}}})(l)}var He=a(63789),Ue=a(93170);async function qe(e,t,a){return t?Je(e,t,a):void 0}async function Ve(e,t,a,n){const o=t.axes&&function(e,t,a){return Promise.all(t.map((async t=>{const n=await qe(e,t.title,a);return{dimensionType:t.dimensionType,linearValueScale:t.linearValueScale,reversePlotOrder:t.reversePlotOrder,title:n,axisGroup:t.axisGroup?t.axisGroup:"primary"}})))}(e,t.axes,a),r=async function(e,t,a,n){return{dimensions:await Promise.all(t.dimensions.map((t=>Be(e,t,a.has(t.id),n))))}}(e,t.data,function(e){const t=new Set;return e.series.forEach((e=>e.dataBindings.forEach((e=>{"categories"===e.dimensionType&&t.add(e.dimensionId)})))),t}(t),n),i=async function(e,t,a){const n=await Promise.all(t.map((async t=>{const n=await qe(e,t.title,a),o={dataBindings:t.dataBindings,exceptions:t.exceptions,highlightedLineSegments:t.highlightedLineSegments,layout:t.layout,binOptions:t.binOptions,title:n,valueAxisGroup:t.valueAxisGroup?t.valueAxisGroup:"primary"};return null!=t.highlightStyleIndex&&t.highlightStyleIndex>-1&&(o.highlightStyleIndex=t.highlightStyleIndex>=Ue.hr.length?0:t.highlightStyleIndex),t.trendlines&&(o.trendlines=t.trendlines),o}))),o=t.some((e=>"secondary"===e.valueAxisGroup)),r=t.some((e=>(0,He.Y)(e.layout).isLine));return o&&r?n.sort(((e,t)=>{const a=(0,He.Y)(e.layout).isLine,n=(0,He.Y)(t.layout).isLine;return a&&!n?1:!a&&n?-1:0})):n}(e,t.series,a),l=qe(e,t.title,a),[s,c,d,u]=await Promise.all([o,r,i,l]),m={axes:s,data:c,series:d};return u&&(m.title=u),m}function Ge(e){switch(e.exprType){case"and":case"or":case"contains":case"endsWith":case"equality":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"startsWith":return{exprType:e.exprType,left:Ge(e.left),right:Ge(e.right)};case"columnName":return We(e);case"datePart":return{exprType:e.exprType,source:Ge(e.source),datePartFunction:e.datePartFunction};case"dynamicColumn":return{exprType:e.exprType,kind:e.kind};case"distinct":return{exprType:e.exprType,exprs:e.exprs.map((e=>Ge(e)))};case"inQuery":return{exprType:e.exprType,columnNameExpr:We(e.columnNameExpr),query:ze(e.query)};case"numberLiteral":case"dateTimeLiteral":case"stringLiteral":return{exprType:e.exprType,value:e.value};case"query":return ze(e);case"not":return{exprType:e.exprType,expr:Ge(e.expr)};case"average":case"count":case"max":case"median":case"min":case"sum":return{exprType:e.exprType,expr:e.expr&&Ge(e.expr)};default:(0,F.c)(e)}}function We(e){return{exprType:e.exprType,name:e.name,sourceDataReference:e.sourceDataReference}}function ze(e){return{exprType:e.exprType,projectClause:e.projectClause.map((e=>Ge(e))),...e.whereClause&&{whereClause:Ge(e.whereClause)},...e.groupClause&&{groupClause:e.groupClause.map((e=>Ge(e)))},...e.havingClause&&{havingClause:Ge(e.havingClause)},...e.sortClause&&{sortClause:e.sortClause.map((e=>Qe(e)))},...e.rankingClause&&{rankingClause:{order:e.rankingClause.order.map((e=>Qe(e))),filter:Ge(e.rankingClause.filter),partitions:e.rankingClause.partitions.map((e=>Ge(e)))}},...e.takeClause&&{takeClause:e.takeClause}}}function Qe(e){return{expr:Ge(e.expr),order:e.order}}async function Je(e,t,a){const n=a?.table,o=n&&(!!n.headerColumnCount&&n.headerColumnCount>1||!!n.headerRowCount&&n.headerRowCount>1),i=await Promise.all(t.runs.map((async t=>{if(void 0!==t.text)return{text:(0,be.So)(t.text)?(0,r.Atw)():t.text};if(null!=t.references){if(!o||1===t.references.length&&(null==t.references[0].column&&null==t.references[0].row||null!=t.references[0].column&&null!=t.references[0].row)){const n=await async function(e,t,a){const{row:n,column:o}=t,i=a?.table.tableLocation;if(void 0===n&&void 0===o)throw new Error("V3SourceCellReference is missing both row and column references.");return void 0===n?(0,X.L)((0,r.m1B)(),i?o-i.left+1:o+1):void 0===o?(0,X.L)((0,r.m1B)(),i?n-i.top+1:n+1):e.getText(n,o)}(e,t.references[0],a);return{text:(0,be.So)(n)?(0,r.Atw)():n.trim()}}throw new Error("Invalid TextRun")}if(t.formattedValue){const{value:a,formatReference:n}=t.formattedValue,o={text:""},i=await e.formatAggregateValue(n.row,n.column,a);return o.text=(0,be.So)(i)?(0,r.Atw)():i,o}throw new Error("Invalid TextRun")})));return{runs:i.map(((e,a)=>{const n=t.runs[a];if(null!=n.highlightStyleIndex&&n.highlightStyleIndex>-1){const t=n.highlightStyleIndex>=Ue.vA.length?0:n.highlightStyleIndex;e.highlightStyleIndex=t}return e}))}}async function je(e,t,a){const n=Promise.all((t.fields||[]).map((t=>Be(e,t,!1)))),o=Promise.all((t.fieldHeaders||[]).map((t=>Je(e,t,a)))),[r,i]=await Promise.all([n,o]);return{fields:r,fieldHeaders:i}}async function Ye(e,t,a,n){switch(t.visualType){case"ChartVisual":return{chart:await Ve(e,t.chart,a),visualType:t.visualType,chartConfig:t.chartConfig};case"PivotTableVisual":return{pivotTable:await ke(e,t.pivotTable,a,!0,n),visualType:t.visualType};case"PivotChartVisual":{const o=Ve(e,t.chart,a,t.pivotTable.pivotTableData),r=ke(e,t.pivotTable,a,!0,n),[i,l]=await Promise.all([o,r]);return{chart:i,pivotTable:l,visualType:t.visualType,chartConfig:t.chartConfig}}case"QueryResultVisual":return{query:t.query?function(e){return Ge(e)}(t.query):void 0,result:await je(e,t.result,a),visualType:t.visualType};case"ForecastVisual":return function(e){if(!(0,c.iP)("Microsoft.Office.Excel.FA000000124.EnableForecasting",!1))throw new Error("Forecasting is disabled but a forecast visual was generated");return{visualType:"ForecastVisual",chart:ce(e),previewTable:se(e),formulasTable:le(e)}}(t.forecastResult);case"TextAnalysisVisual":return{textAnalysisResult:t.textAnalysisResult,visualType:t.visualType};default:(0,F.c)(t)}}async function Xe(e,t){if("TextAnalysisVisual"===t.visualType)return await function(e,t){if(t&&t.top<=t.bottom&&t.left===t.right){const a=[];for(let n=t.top;n<=t.bottom;n++)a.push(e.getText(n,t.left));return Promise.all(a)}return Promise.resolve([])}(e,t.textAnalysisResult.columnReference)}var Ke=a(79259);async function Ze(e){const t=(0,ge.SB)(e.data.formatRows);await _.P.getNumberFormatCache().addFormatPropertiesAsync(["General",...(0,ge.SB)(e.data.formatLocalRows).values]);const a=t.positions.map((t=>{const a=e.data.formatLocalRows[t.row][t.column],n=_.P.getNumberFormatCache().data[a].metadata;return{excelFormatCode:a,isDateTime:n.isDateTime,hasMonth:n.hasMonth,hasDay:n.hasDayOfWeek,hasYear:n.hasYear,isPercent:n.isPercent,isCurrency:n.isCurrency,isNumeric:n.isNumeric,isText:n.isText}}));return{valueRows:e.data.valueRows,formatKeyRows:t.keys,formatInfos:a,mergedCells:e.data.mergedCells,formulas:e.data.formulas}}function et(e){const t=function(e){return{...e}}(e.table);return{...e,table:t}}async function tt(e,t,a,n){const o=Ye(e,t.visual,a,n),r=t.title&&Je(e,t.title,a),i=Xe(e,t.visual),[l,s,c]=await Promise.all([o,r,i]);return{id:t.id,interpretationId:a?a.id:t.interpretationId,title:s,visual:l,providerName:t.providerName,providerIndex:t.providerIndex,extendedData:c}}async function at(e,t,a,n){if(t.visualAnswer&&t.responseType===G.WZ.Answered){const o=t.visualAnswer.visual.refreshable,r=null==o||o,i=Promise.all(t.discoverInsights?.map((t=>tt(e,t,a,!0)))??[]),l=tt(e,t.visualAnswer,a,!0),s=nt(e,a,t.relatedQuestions),[c,d,u]=await Promise.all([i,l,s]);return{...t,visualAnswer:[d],relatedQuestions:u,refreshable:r,forceStaticAnswer:n,discoverInsights:c}}if(t.insightsVisuals){const o=Promise.all(t.insightsVisuals.map((t=>tt(e,t,a,!0)))),r=Promise.all(t.discoverInsights?.map((t=>tt(e,t,a,!0)))??[]),i=nt(e,a,t.relatedQuestions),[l,s,c]=await Promise.all([o,r,i]);return{...t,visualAnswer:l,relatedQuestions:c,refreshable:!0,forceStaticAnswer:n,discoverInsights:s}}{const o=Promise.all(t.discoverInsights?.map((t=>tt(e,t,a,!0)))??[]),r=nt(e,a,t.relatedQuestions),[i,l]=await Promise.all([o,r]);return{...t,visualAnswer:[],relatedQuestions:l,refreshable:i.length>0,forceStaticAnswer:n,discoverInsights:i}}}async function nt(e,t,a){return a&&Promise.all(a.map((async a=>({query:{tokens:a.tokens},title:a.title?await Je(e,a.title,t):{runs:[{text:a.tokens.map((e=>e.token.text)).join("")}]}}))))}var ot=a(58976),rt=a(72355);const it=4,lt=2;function st(e,t=it){let a=0;const n=async()=>{try{return await e(a)}catch(e){return(e.errorCode===H.O.NetworkError||e.errorCode===H.O.NetworkTimeout)&&a<t?(a++,await new Promise((e=>{window.setTimeout(e,1===a?0:200)})),n()):Promise.reject(e)}};return n()}function ct(){return{postRanges(e,t,a){const n=function(e,t){const a=(0,ge.SB)(t.data.formatRows),n=a.positions.map((t=>{const a=(0,Ke.sr)(e,t.row,t.column),n=_.P.getNumberFormatCache().data[a].metadata;return{excelFormatCode:a,isDateTime:n.isDateTime,hasMonth:n.hasMonth,hasDay:n.hasDayOfWeek,hasYear:n.hasYear,isPercent:n.isPercent,isCurrency:n.isCurrency,isNumeric:n.isNumeric,isText:n.isText}}));return{data:{valueRows:t.data.valueRows,formatKeyRows:a.keys,formatInfos:n,mergedCells:t.data.mergedCells,formulas:t.data.formulas,topLeftCellAddress:t.data.topLeftCellAddress},contentLanguageHint:t.contentLanguageHint,generateResults:t.generateResults}}(e,t);return st((e=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=[],l=[];let s=0;const c=new URLSearchParams;c.set("clientId",(0,rt.fp)());const d=`${(0,rt.wF)()}/v3.0/ranges?${c.toString()}`;r.open("POST",d,!0),r.setRequestHeader("Content-Type","application/json"),J(r,t),j(r,t,l),Q(r,o),r.onreadystatechange=()=>{if(4===r.readyState){if(i.push({key:C.W0.ServiceTime,value:performance.now()-s}),0===r.status);else if(201===r.status||202===r.status){const e=r.getResponseHeader("Range-Id"),t=r.getResponseHeader("Location"),a=r.getResponseHeader("Auth-Token");let o;if(l.push({key:C.W0.RangeId,value:e}),i.push({key:C.W0.RangeId,value:e}),202===r.status){const n=r.getResponseHeader("Operation-Id");o={rangeId:e,location:t,operationId:n,operationLocation:r.getResponseHeader("Operation-Location"),authToken:a},l.push({key:C.W0.OperationId,value:n}),i.push({key:C.W0.OperationId,value:n})}else o={rangeId:e,location:t,authToken:a};n(o)}else o((0,rt.sm)(r.status));(0,D.gr)("POST","ranges",r.status,a,l),(0,D.eE)(i)}};try{const t=e.data.valueRows.length*e.data.valueRows[0].length,a=performance.now(),n=JSON.stringify(e);if(i.push({key:C.W0.SerializationTime,value:performance.now()-a}),t>(0,rt.Iw)()){const e=performance.now(),t=(0,ot.Kc)(n,{level:1});i.push({key:C.W0.CompressionMethod,value:"deflate"},{key:C.W0.CompressionTime,value:performance.now()-e},{key:C.W0.RequestSize,value:t.length}),s=performance.now(),r.setRequestHeader("Content-Encoding","deflate"),r.send(t)}else i.push({key:C.W0.CompressionMethod,value:"none"},{key:C.W0.RequestSize,value:n.length}),s=performance.now(),r.send(n)}catch(e){o(new H.u(H.O.PostRangesError,e))}}))}(n,a,e)))},async initializeRange(e,t,a){const{address:n,rowCount:o,columnCount:r}=t,i={contentLanguageHint:e.contentLanguageHint,topLeftCellAddress:(0,be.D$)(n),dataSize:{width:r,height:o},data:await Ze(e)};return st((e=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=[],l=(0,c.yw)("OfficeVSO_9430066_InsightsApiLogging")?[{key:C.W0.NumRows,value:e.data.valueRows.length},{key:C.W0.NumColumns,value:e.data.valueRows[0].length},{key:C.W0.Height,value:e.dataSize.height},{key:C.W0.Width,value:e.dataSize.width}]:[];let s=0;const d=new URLSearchParams;d.set("clientId",(0,rt.fp)());const u=`${(0,rt.wF)()}/v3.0/ranges/initialize?${d.toString()}`;r.open("POST",u,!0),r.setRequestHeader("Content-Type","application/json"),(0,c.yw)("OfficeVSO_9430066_InsightsApiLogging")&&j(r,t,l),J(r,t),Q(r,o),r.onreadystatechange=()=>{if(4===r.readyState){if(i.push({key:C.W0.ServiceTime,value:performance.now()-s}),0===r.status);else if(201===r.status){const e=r.getResponseHeader("Range-Id"),t=r.getResponseHeader("Location"),a=r.getResponseHeader("Auth-Token");l.push({key:C.W0.RangeId,value:e}),i.push({key:C.W0.RangeId,value:e}),n({...JSON.parse(r.responseText),rangeId:e,location:t,authToken:a})}else o((0,rt.sm)(r.status));(0,D.gr)("POST",(0,c.yw)("OfficeVSO_9430066_InsightsApiLogging")?"initialize":"ranges",r.status,a,l),(0,D.eE)(i)}};try{const t=e.data.valueRows.length*e.data.valueRows[0].length,a=performance.now(),n=JSON.stringify(e);if(i.push({key:C.W0.SerializationTime,value:performance.now()-a}),t>(0,rt.Iw)()){const e=performance.now(),t=(0,ot.Kc)(n,{level:1});i.push({key:C.W0.CompressionMethod,value:"deflate"},{key:C.W0.CompressionTime,value:performance.now()-e},{key:C.W0.RequestSize,value:t.length}),s=performance.now(),r.setRequestHeader("Content-Encoding","deflate"),r.send(t)}else i.push({key:C.W0.CompressionMethod,value:"none"},{key:C.W0.RequestSize,value:n.length}),s=performance.now(),r.send(n)}catch(e){o(new H.u(H.O.InitializeRangesFailure,e))}}))}(i,a,e)))},async storeData(e,t,a,n){const o={rowOffset:a,data:await Ze(t)};return st((t=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=[],s=(0,c.yw)("OfficeVSO_9430066_InsightsApiLogging")?[{key:C.W0.NumRows,value:t.data.valueRows.length},{key:C.W0.NumColumns,value:t.data.valueRows[0].length},{key:C.W0.RowOffset,value:t.rowOffset}]:[];let d=0;const u=new URLSearchParams;u.set("clientId",(0,rt.fp)());const m=`${(0,rt.wF)()}${e}/data?${u.toString()}`;i.open("POST",m,!0),i.setRequestHeader("Content-Type","application/json"),(0,c.yw)("OfficeVSO_9430066_InsightsApiLogging")&&j(i,a,s),J(i,a),Q(i,r),i.onreadystatechange=()=>{4===i.readyState&&(l.push({key:C.W0.ServiceTime,value:performance.now()-d}),0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r((0,rt.sm)(i.status))),(0,D.gr)("POST",(0,c.yw)("OfficeVSO_9430066_InsightsApiLogging")?"data":"ranges",i.status,n,s),(0,D.eE)(l))};try{const e=t.data.valueRows.length*t.data.valueRows[0].length,a=performance.now(),n=JSON.stringify(t);if(l.push({key:C.W0.SerializationTime,value:performance.now()-a}),e>(0,rt.Iw)()){const e=performance.now(),t=(0,ot.Kc)(n,{level:1});l.push({key:C.W0.CompressionMethod,value:"deflate"},{key:C.W0.CompressionTime,value:performance.now()-e},{key:C.W0.RequestSize,value:t.length}),d=performance.now(),i.setRequestHeader("Content-Encoding","deflate"),i.send(t)}else l.push({key:C.W0.CompressionMethod,value:"none"},{key:C.W0.RequestSize,value:n.length}),d=performance.now(),i.send(n)}catch(e){r(new H.u(H.O.StoreDataFailure,e))}}))}(e,o,n,t)))},getRange:(e,t)=>st((a=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId",(0,rt.fp)());const l=`${(0,rt.wF)()}${e}?${i.toString()}`;r.open("GET",l,!0),J(r,t),Q(r,o);const s=[];j(r,t,s),r.onreadystatechange=()=>{if(4===r.readyState)if(0===r.status);else if(200===r.status){const e=JSON.parse(r.responseText);n(e)}else o((0,rt.sm)(r.status));(0,D.gr)("GET","range",r.status,a,s)},r.send()}))}(e,t,a))),deleteRange:(e,t)=>st((a=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId",(0,rt.fp)());const l=`${(0,rt.wF)()}${e}?${i.toString()}`;r.open("DELETE",l,!0),J(r,t),Q(r,o);const s=[];j(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n():o((0,rt.sm)(r.status))),(0,D.gr)("DELETE","range",r.status,a,s))},r.send()}))}(e,t,a))),generateResultsForRange:(e,t,a)=>st((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId",(0,rt.fp)());const s=`${(0,rt.wF)()}${e}/generateResults?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),J(i,a),Q(i,r);const c=[];j(i,a,c),i.onreadystatechange=()=>{if(4===i.readyState){if(0===i.status);else if(202===i.status){const e=i.getResponseHeader("Operation-Id"),t=i.getResponseHeader("Operation-Location");o({operationId:e,operationLocation:t}),c.push({key:C.W0.OperationId,value:e})}else r((0,rt.sm)(i.status));(0,D.gr)("POST","generateResultsForRange",i.status,n,c)}},i.send(JSON.stringify(t))}))}(e,t,a,n))),getOperation:(e,t)=>st((a=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId",(0,rt.fp)());const l=`${(0,rt.wF)()}${e}?${i.toString()}`;r.open("GET",l,!0),J(r,t),Q(r,o);const s=[];j(r,t,s),r.onreadystatechange=()=>{if(4===r.readyState){if(0===r.status);else if(200===r.status){const e=JSON.parse(r.responseText);s.push({key:C.W0.OperationStatus,value:e.status});const t={...e.resourceLocations};e.links[B.NLEvaluationResult]&&(t.nlEvaluationResult=e.links[B.NLEvaluationResult].href);const a={...e,resourceLocations:t};n(a)}else o((0,rt.sm)(r.status));(0,D.gr)("GET","operation",r.status,a,s)}},r.send()}))}(e,t,a))),deleteOperation:(e,t)=>st((a=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId",(0,rt.fp)());const l=`${(0,rt.wF)()}${e}?${i.toString()}`;r.open("DELETE",l,!0),J(r,t),Q(r,o);const s=[];j(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n():o((0,rt.sm)(r.status))),(0,D.gr)("DELETE","operation",r.status,a,s))},r.send()}))}(e,t,a))),async getRecommendations(e,t,a,n,o){const r=await st((t=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId",(0,rt.fp)()),a&&(l.set("chartWidth",a.chartWidth.toString()),l.set("chartHeight",a.chartHeight.toString()));const s=`${(0,rt.wF)()}${e}?${l.toString()}`;i.open("GET",s,!0),J(i,t),Q(i,r);const c=[];j(i,t,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r((0,rt.sm)(i.status))),(0,D.gr)("GET","recommendations",i.status,n,c))},i.send()}))}(e,a,n,t))),i=[],l=r.interpretations.map((e=>et(e))),s=new M(t.sheetId);r.recommendations&&i.push(...r.recommendations);const c=Promise.all(i.map((e=>{const a=l.find((({id:t})=>t===e.interpretationId));return tt(s.getTranslations(t.rowIndex,t.columnIndex),e,a,o??!1)})));await s.resolveJobs();const d=await c;return{interpretations:l,recommendations:d}},async getNaturalLanguageResult(e,t,a,n,o){let r=await st((a=>dt(e,t,o,a)),lt);(function(e){if(e.responseType!==G.WZ.Answered||!e.visualAnswer||!e.visualAnswer.visual)return!1;if(!function(e){const t=e.visual.visualType;return"PivotChartVisual"===t||"PivotTableVisual"===t}(e.visualAnswer))return!1;const t=e.visualAnswer.visual.pivotTable,a=!!t.labelFilters&&t.labelFilters.length>0,n=!!t.valueFilters&&t.valueFilters.some((e=>"between"===e.filterType||"notBetween"===e.filterType)),o=Office.context.requirements.isSetSupported.bind(Office.context.requirements);if(t.dateFilters&&t.dateFilters.length>0){if(!o("ExcelApi","1.12")&&!o("PivotFilters","1.2"))return!0;if(t.dateFilters&&t.dateFilters.some((e=>!!e.wholeDays))&&!o("PivotTableNativeGrouping","1.1")&&!o("ExcelApi","1.14"))return!0}if((a||n)&&!o("ExcelApi","1.12")&&!o("PivotFilters","1.1"))return!0;const r=e=>!!e.datePartOverride,i=t.rowFields?.some(r)??!1,l=t.columnFields?.some(r)??!1;return!(!i&&!l||o("PivotTableNativeGrouping","1.1"))})(r)&&(t.forceStaticAnswer=!0,r=await st((a=>dt(e,t,o,a)),lt));const i=new M(n.sheetId),l=at(i.getTranslations(n.rowIndex,n.columnIndex),r,a,!!t.forceStaticAnswer);return await i.resolveJobs(),await l},generateResultForNaturalLanguage:(e,t,a)=>st((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest;(new URLSearchParams).set("clientId",(0,rt.fp)()),i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),J(i,a),Q(i,r);const l=[];j(i,a,l);const s=e.split("/"),c=s[3],d=s[5];l.push({key:C.W0.RangeId,value:c}),l.push({key:C.W0.NLContextId,value:d}),l.push({key:C.W0.AllowRewrite,value:t.allowRewrite??!1}),i.onreadystatechange=()=>{if(4===i.readyState){if(0===i.status);else if(202===i.status){const e=i.getResponseHeader("Operation-Id"),t=i.getResponseHeader("Operation-Location");o({operationId:e,operationLocation:t}),l.push({key:C.W0.OperationId,value:e})}else r((0,rt.sm)(i.status));(0,D.gr)("POST","generateResultForNaturalLanguage",i.status,n,l)}},i.send(JSON.stringify(t))}))}(e,t,a,n))),async getGeneratedResultForNaturalLanguage(e,t,a,n,o){const r=await st((t=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest;(new URLSearchParams).set("clientId",(0,rt.fp)()),r.open("GET",e,!0),J(r,t),Q(r,o);const i=[];j(r,t,i),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n(JSON.parse(r.responseText)):o((0,rt.sm)(r.status))),(0,D.gr)("GET","getResultForNaturalLanguage",r.status,a,i))},r.send()}))}(e,o,t)),lt),i=new M(a.sheetId),l=at(i.getTranslations(a.rowIndex,a.columnIndex),r,t,!!n);return await i.resolveJobs(),await l},async getNaturalLanguageContext(e,t,a){const n=await st((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId",(0,rt.fp)());const s=`${(0,rt.wF)()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),J(i,a),Q(i,r);const c=[];j(i,a,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(201===i.status?o(JSON.parse(i.responseText)):r((0,rt.sm)(i.status))),(0,D.gr)("POST","naturalLanguageContext",i.status,n,c))},i.send(JSON.stringify(t))}))}(e,t,a,n)),lt);return{id:n.id,evaluateQueryLocation:n.evaluateQueryLocation,generateResultForNLEvaluationLocation:n.links[B.GenerateResultForNLEvaluation]?.href,language:n.language,suggestedQueries:n.suggestedQueries}},async getInterpretations(e,t){const a=await st((a=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId",(0,rt.fp)());const l=`${(0,rt.wF)()}${e}?${i.toString()}`;r.open("GET",l,!0),J(r,t),Q(r,o);const s=[];j(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n(JSON.parse(r.responseText)):o((0,rt.sm)(r.status))),(0,D.gr)("GET","interpretations",r.status,a,s))},r.send()}))}(e,t,a)));return{interpretations:a.interpretations.map((e=>et(e)))}},handleOperation:(e,t,a,n)=>function(e,t,a,n){const o=[],r={};function i(e){Object.keys(e||{}).forEach((a=>{const n=t[a],i=e[a];!r[a]&&n&&(o.push(n(i)),r[a]=!0)}))}async function l(e){if(!a||!e)return;const t=Object.keys(e||{}).map((t=>{const n=a[t],o=e[t];return n?n(o):Promise.resolve()}));await Promise.all(t)}async function s(){const t=await(0,rt.x4)().getOperation(e,n),{resourceLocations:a,retryAfterMs:r,status:c}=t,d=r||2e3,u=new Promise((e=>{setTimeout(e,d)}));switch(c){case G.Uh.NotStarted:return await u,s();case G.Uh.Running:return i(a),await l(t.statusDetails),await u,s();case G.Uh.Succeeded:return i(a),await l(t.statusDetails),Promise.all(o);default:return Promise.reject(new Error("Unexpected operation result."))}}return s()}(e,t,a,n),generateSuggestedQueries:(e,t)=>st((a=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId",(0,rt.fp)());const l=`${(0,rt.wF)()}${e}?${i.toString()}`;r.open("POST",l,!0),J(r,t),Q(r,o);const s=[];j(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n(JSON.parse(r.responseText)):o((0,rt.sm)(r.status))),(0,D.gr)("POST","generateSuggestedQueries",r.status,a,s))},r.send()}))}(e,t,a)),lt),analyzeTyping:(e,t,a)=>st((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId",(0,rt.fp)());const s=`${(0,rt.wF)()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),J(i,a),Q(i,r);const c=[];j(i,a,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r((0,rt.sm)(i.status))),(0,D.gr)("POST","analyzeTyping",i.status,n,c))},i.send(JSON.stringify(t))}))}(e,t,a,n)),lt)}}function dt(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId",(0,rt.fp)());const s=`${(0,rt.wF)()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),J(i,a),Q(i,r);const d=[];j(i,a,d),(0,c.yw)("OfficeVSO_8875418_UseLLMParserInRetry")||n&&n>0&&t.allowRewrite&&(t.allowRewrite=!1,d.push({key:C.W0.IsAnnaParserFallback,value:!0}));const u=e.split("/"),m=u[3],g=u[5];d.push({key:C.W0.RangeId,value:m}),d.push({key:C.W0.NLContextId,value:g}),d.push({key:C.W0.AllowRewrite,value:t.allowRewrite??!1}),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r((0,rt.sm)(i.status))),(0,D.gr)("POST","naturalLanguageResult",i.status,n,d))},i.send(JSON.stringify(t))}))}var ut=a(50108);function mt(){(0,rt.lC)(ct()),(0,ut.lC)(new $)}var gt=a(20456);const ht=window.excelTaskPaneStartTime,pt=(new Date).getTime().toString();let bt,ft,Ct,yt,vt=!1,Tt=!1;function xt(e){const t=sessionStorage?.getItem("preloadCopilot");t&&St(e)}function St(e=!0){sessionStorage?.setItem("preloadCopilot",JSON.stringify({isPreloaded:!0,isHidden:e}))}let wt=!1,Et=!1;async function Rt(){await It(),wt=!0,Office.addin.onVisibilityModeChanged((function(e){if(v.B.getInstance().sendVisibilityModeChangedTelemetry(e.visibilityMode),(0,w.cY)(`Visibility_mode changed to  ${e.visibilityMode}`),"Taskpane"===e.visibilityMode){if(vt=!1,Et){const e=f.Vv.getSetting(f.zj.CopilotPaneStartTimestamp);v.B.getInstance().sendLatencyTelemetry([{key:C.CT.FeatureName,value:C.BJ.ShowPreloadedCopilot},{key:C.CT.UserCopilotPaneLoadTime_PreloadTime,value:(0,E.WU)(e)}],!0),Et=!1}xt(!1)}else"Hidden"===e.visibilityMode&&xt(!0)})),yt&&At(yt)}async function It(){try{if((0,c.yw)("OfficeVSO_9256726_officeOnReadyTime")&&(bt=(new Date).getTime()),(0,L.Ok)(),T.E.getInstance().logPerformanceEntries(performance.getEntriesByType("resource")),new PerformanceObserver((e=>{T.E.getInstance().logPerformanceEntries(e.getEntries())})).observe({entryTypes:["navigation","resource"]}),ft=(0,R.P)("copilotPaneStartTimestamp"),(0,c.yw)("OfficeVSO_9256800_copilotButtonClickTimeStamp")&&ft)T.E.getInstance().logLatency(performance.timeOrigin-ft,C.OP.OpenSdx);else{const e=(0,R.P)("StartTimeMs");e&&T.E.getInstance().logLatency(performance.timeOrigin-e,C.OP.OpenSdx)}const e=(0,x.U)();await c.u$.promise(),await c.So.promise(),mt(),S.CP.initPublic(e.dispatch),(0,A.render)(u.createElement("div",null,u.createElement(b,null,u.createElement(y.Kq,{store:e},u.createElement(gt.A,null)))),document.getElementById("container"))}catch(e){h.M.getInstance().logUncaughtException(e),(0,c.yw)("OfficeVSO_8787558_CopilotChatASHALog")&&h.M.getInstance().logStandardizedAshaErrorEvent(o.W.Copilot_Chat_Pane_Failed_To_Load,n.c.Pane_Crashed,C.BJ.CopilotChat),(0,A.render)(u.createElement(g,null),document.getElementById("container"))}}function At(e){(0,w.cY)(`ShowPreloadedCopilot, showAsTaskPane ${wt}`),wt?(Et=!0,xt(!1),e&&(e.copilotPaneStartTimestamp&&v.B.getInstance().logUserCopilotPaneLoadTelemetry(e.copilotPaneStartTimestamp),f.Vv.setHostSettings(e)),I.Us6.setValue({iteration:I.Us6.getValue().iteration+1}),v.B.getInstance().sendChatEventTelemetry((0,C.pN)({[C.h3.ChatEventType]:C.a5.ShowPreloadedCopilot,[C.h3.ChatEventParameters]:(new Date).getTime()})),Tt=!0,Office.addin.showAsTaskpane()):yt=e}Office.onReady((async e=>{e.addin?"Hidden"===e.addin.visibilityMode?(St(),vt=!0,Ct||(Ct=(new Date).getTime()),(0,c.jl)()?"function"==typeof window.requestIdleCallback?requestIdleCallback(Rt,{timeout:5e3}):setTimeout(Rt,0):await Rt()):await Rt():((0,w.cY)("hostAndPlatform.addin is null"),await It())})),Office.actions.associate("ShowPreloadedCopilot",(e=>{At(e)})),Office.actions.associate("PreloadCopilot",(()=>{Ct||(Ct=(new Date).getTime()),wt=!0,St(),It()}))},37745:(e,t,a)=>{a.d(t,{C6:()=>C,XX:()=>v,gl:()=>b,xt:()=>y});var n=a(29348),o=a(77303),r=a(88179),i=a(31030),l=a(48314),s=a(61150),c=a(50347),d=a(92779);const u="en-US",m=["ar-SA","fa-IR","he-IL","ur-PK"];function g(e,t){const a=document.createElement("script");a.type="text/javascript",a.src=e,(0,s.cY)("Loading Localized strings for Language: "+e);const c=new Promise(((s,c)=>{a.onload=()=>{s()},a.onerror=a.onabort=()=>{const a=n.i.getHostAppDisplayLanguage();l.M.getInstance().logError({eventType:i.S.Localization,errorMessage:"Failed to load script url = "+e.split("/")?.pop()+" with mapped language = "+t+" and display language = "+a,logLevel:r.$b.Warning}),c(new o.DYx(o._sV.FailedToLoadStrings,"Failed to load strings with mapped language = "+t+" and display language = "+a))}}));return document.head.appendChild(a),c}function h(e,t){return-1===t.indexOf(e)?u:e}let p="";function b(){return p}let f="";function C(){return p!==f}function y(){return o.b_z.includes(p)}async function v(){const e=n.i.getHostAppDisplayLanguage();if((0,s.cY)("Display Language Detected: "+e),(0,c.yw)("OfficeVSO_9450166_SharedSDXLocalization")){const t=new o.dDr;t.IsTier2LanguageSupportEnabled=(0,c.vK)(),t.IsTier2RTLLanguageEnabled=(0,c.vC)(),t.IsTier2Point5LanguagesEnabled=(0,c.Gp)(),t.IsTier3LanguagesEnabled=(0,c.oV)(),p=t.getUserLanguage(e)}else{if(null==e)throw new o.DYx(o._sV.InvalidInput," Display Language is undefined or null");let t=o.h7k;(0,c.vK)()&&(t=t.concat(o.k$4),(0,c.vC)()&&(t=t.concat(o.b_z))),(0,c.Gp)()&&(t=t.concat(o.zic)),(0,c.oV)()&&(t=t.concat(o.LJF)),p=h(e,t)}f=h(e,o.$9t),(0,c.yw)("OfficeVSO_9450166_SharedSDXLocalization")?(0,d.N1d)(o.$nm.includes(p),o.$nm.includes(f)):(0,d.N1d)(m.includes(p),m.includes(f));const t="office-online-strings",a=t+"/"+p.toLowerCase()+"/excel-copilot-strings.min.js",r=t+"/"+p.toLowerCase()+"/officeaicopilot-strings.min.js",i=t+"/"+f.toLowerCase()+"/excel-copilot-strings-n-tier.min.js",l=t+"/"+p.toLowerCase()+"/excel-copilot-commanding-hitl-strings.min.js";try{return(0,c.k6)()?Promise.all([g(a,p),g(r,p),g(i,f),g(l,p)]):Promise.all([g(a,p),g(r,p),g(i,f)])}catch(e){const t=n.i.getHostAppDisplayLanguage();throw new o.DYx(o._sV.FailedToLoadStrings,"Failed to load strings with mapped language = "+p+", unclassified Tier Language = "+f+" and display language = "+t)}}},64216:(e,t,a)=>{a.d(t,{s:()=>ue});var n=a(16912),o=a(20057),r=a(88179),i=a(61150),l=a(6925),s=a(55683),c=a(50347),d=a(72483),u=a(4475),m=a(33500),g=a(28087),h=a(19080),p=a(8338),b=a(98974),f=a(63843),C=a(92779),y=a(72277),v=a(39531);class T{static getInstance(){return T.instance||(T.instance=new T),T.instance}getUrlForCitation(e){return(0,i.hX)(e.path)?e.seeMoreUrl:void 0}getReferenceSourceType(e){return e.sourceType===C.YgX?y.GH.Annotation:y.GH.Citation}constructor(){this.CitationFileTypeMap=new Map([[v.YA.PowerPoint,y._R.PowerPoint],[v.YA.Excel,y._R.Excel],[v.YA.Word,y._R.Word],[v.YA.OneNote,y._R.OneNote],[v.YA.Outlook,y._R.Outlook],[v.YA.Teams,y._R.Teams],[v.YA.Event,y._R.Event],[v.YA.Meeting,y._R.Meeting],[v.YA.TeamsMeeting,y._R.Meeting],[v.YA.SharePoint,y._R.SharePoint],[v.YA.PDF,y._R.Pdf],[v.YA.Zip,y._R.Pdf],[v.YA.Visio,y._R.Visio],[v.YA.Fluid,y._R.Loop],[v.YA.Txt,y._R.Txt]]),this.lastBuilderCitationsTypes=[],this.getLastBuildCrossAppCitations=()=>this.lastBuilderCitationsTypes,this.getSnippetFromCitationContent=e=>e?'"'+(e.length>C.T1Y?e.slice(0,C.T1Y)+"...":e)+'"':null,this.getChatReferenceType=(e,t,a)=>e===v.YA.Web||void 0===e?y._2.External:void 0!==e&&Object.values(y._R).includes(e)?y._2.CrossApp:void 0===t?y._2.External:a?.path?((0,i.cY)("CitationBuilder: internal citation is not supported in excel: ",a.path),y._2.Internal):this.CitationFileTypeMap.has(t)?y._2.CrossApp:y._2.External,this.getCrossAppCitationFileType=e=>{if(void 0!==e)return this.CitationFileTypeMap.has(e)?this.CitationFileTypeMap.get(e):void 0},this.getSupportedIconType=e=>{if(void 0!==e)return Object.values(y._R).includes(e)?e:void 0},this.getTitleFromSnippet=e=>e?('"'===e[0]&&(e=e.substring(1,e.length-1)),'"'+(e.length>C.cGI?e.slice(0,C.cGI).trim()+"...":e)+'"'):null,this.getFileExtensionFromName=e=>e?.includes(".")?e.split(".").pop():"",this.getChatReferenceFromSourceAttributions=(e,t,a)=>(a&&(this.lastBuilderCitationsTypes=[]),e.filter((e=>t?e.sourceType===C.YgX:e.sourceType!==C.YgX)).map(((e,t)=>{let a;e.referenceMetadata&&(a=JSON.parse(e.referenceMetadata));const n=this.getChatReferenceType(a?.type,a?.referenceType,e);this.lastBuilderCitationsTypes.push(`${n}:${a?.type}:${a?.referenceType}:${this.getFileExtensionFromName(a?.fileName)}`);const o=this.getTitleFromSnippet(e.providerDisplayName)??n,r=a?.typeDescription??C.u1i,i=a?.iconUrl?.replace(/\/$/,""),l=this.getReferenceSourceType(e);return{referenceIndex:t+1,referenceProps:{title:o??C.u1i,primarySubtitle:r,secondarySubtitle:a?.context??this.getUrlForCitation(e),snippet:this.getSnippetFromCitationContent(a?.snippet)??C.u1i,referenceType:n,iconAppName:n===y._2.CrossApp?this.getSupportedIconType(a?.type):this.getCrossAppCitationFileType(a?.referenceType),url:this.getUrlForCitation(e),path:[e.path],sensitivityLabel:a?.sensitivityLabel?.displayName,iconUrl:i,linkType:l},isFlux:!0}})))}}var x=a(77303),S=a(82729),w=a(91519),E=a(74840),R=a(6129),I=a(25549),A=a(93421),L=a(48314),F=a(96854),_=a(31030),N=a(89099),k=a(24220),O=a(98100),P=a(62614),M=a.n(P);var D=a(10748),$=a(79490),B=a(90922),H=a(93772),U=a(27409),q=a(79029),V=a(98786);const G=F.E.getInstance(),W=L.M.getInstance();function z(e){return!!c.v1&&("bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===I.w.SelfHelpSkillName)}function Q(e,t){const a=e.adaptiveCards&&e.adaptiveCards.length>0,n=[];let o="";if(a&&e.hiddenText===I.x.QuickAnswer){o=I.x.QuickAnswer;const t=(0,C.sj0)(),a=e.adaptiveCards?e.adaptiveCards[0]:{},r=J(a,t,e.messageId);n.push(r)}else if(a&&e.hiddenText===I.x.HelpArticle)if(o=I.x.HelpArticle,1===e.adaptiveCards?.length){const t=(0,C.Vgn)(),a=e.adaptiveCards[0],o=J(a,t,e.messageId);n.push(o)}else{const t={chatCardType:g._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,C.sj0)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:h.O.None,isFailure:!1,messageId:e.messageId},addCardToChatHistory:!0},a=e.adaptiveCards.map((t=>J(t,e.messageId)));n.push(t,...a)}else{o="N/A";const t={chatCardType:g._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,C.ZAw)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:h.O.None,isFailure:!0,messageId:e.messageId},addCardToChatHistory:!0};n.push(t)}Z(o);for(const e of n)t.displayResponse(e)}const J=(e,t,a)=>({chatCardType:g._.SelfHelpAdaptiveCard,chatMessageData:{selfHelpAdaptiveCardProps:{user:"chat",headerText:t,sourceLabel:{iconName:"unknown",text:(0,C.Ovt)()},cardData:e,customActions:{[j.JsonTypeName]:j,[X.JsonTypeName]:X,[K.JsonTypeName]:K,[Y.JsonTypeName]:Y}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:h.O.Footer,feedbackData:(0,b.M5)(H.Xw.SELFHELPSEARCH),isFailure:!1,messageId:a},addCardToChatHistory:!0});class j extends V.Y{getJsonTypeName(){return j.JsonTypeName}executeWithTelemetry(e){ee("ExecuteTCID",e),this.tcid&&Office.context.ui.executeFeature(this.tcid)}}j.JsonTypeName="SelfHelpAction.ExecuteTCID",j.tcidProperty=new U.NumProperty(U.Versions.v1_0,"tcid"),(0,$.__decorate)([(0,U.property)(j.tcidProperty)],j.prototype,"tcid",void 0);class Y extends V.Y{getJsonTypeName(){return Y.JsonTypeName}executeWithTelemetry(e){ee("ShowTeachingCallout",e),this.tabId&&this.anchorId&&this.calloutTitle&&this.calloutText&&OfficeFirstParty.Notification.addNotification(OfficeFirstParty.Notification.callout({target:this.tabId,title:this.calloutTitle,content:this.calloutText,useTeachingStyles:!0}),{navigationalOptions:{controlToFind:this.anchorId}})}}Y.JsonTypeName="SelfHelpAction.ShowTeachingCallout",Y.tabIdProperty=new U.NumProperty(U.Versions.v1_0,"tabId"),Y.anchorIdProperty=new U.NumProperty(U.Versions.v1_0,"anchorId"),Y.calloutTitleProperty=new U.StringProperty(U.Versions.v1_0,"calloutTitle"),Y.calloutTextProperty=new U.StringProperty(U.Versions.v1_0,"calloutText"),Y.delayProperty=new U.NumProperty(U.Versions.v1_0,"delay"),(0,$.__decorate)([(0,U.property)(Y.tabIdProperty)],Y.prototype,"tabId",void 0),(0,$.__decorate)([(0,U.property)(Y.anchorIdProperty)],Y.prototype,"anchorId",void 0),(0,$.__decorate)([(0,U.property)(Y.calloutTitleProperty)],Y.prototype,"calloutTitle",void 0),(0,$.__decorate)([(0,U.property)(Y.calloutTextProperty)],Y.prototype,"calloutText",void 0),(0,$.__decorate)([(0,U.property)(Y.delayProperty)],Y.prototype,"delay",void 0);class X extends V.Y{getJsonTypeName(){return X.JsonTypeName}executeWithTelemetry(e){ee("OpenUrl",e),this.url&&window?.open(this.url)}}X.JsonTypeName="SelfHelpAction.OpenUrl",X.urlProperty=new U.StringProperty(U.Versions.v1_0,"url"),(0,$.__decorate)([(0,U.property)(X.urlProperty)],X.prototype,"url",void 0);class K extends V.Y{getJsonTypeName(){return K.JsonTypeName}executeWithTelemetry(e){ee("ShowHelpPane",e),this.articleId&&OfficeFirstParty.Copilot.launchHelpPaneByArticleIdString(this.articleId)}}K.JsonTypeName="SelfHelpAction.ShowHelpPane",K.articleIdProperty=new U.StringProperty(U.Versions.v1_0,"articleId"),(0,$.__decorate)([(0,U.property)(K.articleIdProperty)],K.prototype,"articleId",void 0);const Z=e=>{G.updateTelemetryChatEventData({[r.h3.ChatEventType]:r.a5.SelfHelpContentShown,[r.h3.ChatEventParameters]:JSON.stringify({ContentType:e})},W),W.endTriedActivitySuccess(r.q.SelfHelp)},ee=(e,t)=>{const a=L.M.userQueryGuid;if(t){const{correlationId:e}=(0,r.zq)(t);void 0!==e&&(L.M.userQueryGuid=e,q.B.userQueryGuid=e)}G.updateTelemetryChatEventData({[r.h3.ChatEventType]:r.a5.SelfHelpActionClicked,[r.h3.ChatEventParameters]:JSON.stringify({ActionType:e})},W),(0,c.BT)()?q.B.getInstance().logKeptEvent(r.BJ.ChatQnA,r.q.SelfHelp,B.RX.Ask):W.logKeptEvent(r.q.SelfHelp),t&&(L.M.userQueryGuid=a,q.B.userQueryGuid=a)};var te=a(90489),ae=a(15183),ne=a(2460),oe=a(71362),re=a(78640),ie=a(23147),le=a(90524),se=a(39504);const ce=(0,c.Z8)("Microsoft.Office.Excel.FA000000124.StreamHandlerSuggestionsCount",3),de=()=>(0,c.yw)("OfficeVSO_9262753_InternalLoadingMessageSupportEnabled")||(0,c.vI)();class ue{static getInstance(){return ue._instance||(ue._instance=new ue),ue._instance}getCustomMarkdownComponents(e,t){const a=this.getMarkdownCardOptionsByMessageOrigin(e,t);return a.useExcelMDComponents?(0,ne.i)(a.telemetryFeatureName):void 0}cleanupStreamHandler(){this.messageId="",this.contentOrigin=void 0,this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.chunksCount=0,this.lastFormulaRequestDebugInfo=void 0,this.isDisengagedError=!1}resetStartQueryState(e){this.isMessageRendered=!1,this.augloopSignalSentTime=e}isWaitingForStreamEnd(){return this.isStreaming}endUserPerceivedLatency(e,t,a){!this.isMessageRendered&&this.augloopSignalSentTime&&(t&&a&&L.M.getInstance().assertFeatureIsActive(t,"displayResponse: Feature from telemetry.featureName does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!0,e,!1,this.augloopSignalSentTime,this.telemetryLogger,t),this.isMessageRendered=!0,this.augloopSignalSentTime=void 0)}getBasinObject(){return this.basin}setShowUndoButton(e){this.showUndoButton=e}setDisableUndoButton(e){this.disableUndoButton=e}getConversationId(){return this.conversationId}getSydneyEndpoint(){return this.sydneyEndpoint}getResponseLocale(){return this.locale}isHandledResponseMessage(e){return(0,c.yw)("OfficeVSO_9318370_DontIgnoreInternalLoaderMessage")&&this.isInternalLoadingMessage(e)?de():!(!(0,c.yw)("OfficeVSO_9463020_excelDisengagementErrorHandling")||!this.isDisengagedMessage(e))||this.isValidMessageForRendering(e)}setLastFormulaRequestDebugInfo(e){this.lastFormulaRequestDebugInfo=e}setShouldShowFormulaDevButton(e){this.shouldShowFormulaDevButton=e}shouldStopLoadingUi(e){if(!e.messages)return!0;let t=!0;for(const a of e.messages)try{const e=JSON.parse(a.text);if(void 0!==e?.stopLoadingUi){t=e.stopLoadingUi;break}}catch(e){(0,i.cY)(`parse stop loading ui error: ${e}`)}return t}isInternalLoadingMessage(e){return e.messageType===ae.n3.InternalSearchQuery||e.messageType===ae.n3.InternalLoaderMessage}isDisengagedMessage(e){return e.messageType===ae.n3.Disengaged}hasSeenDisengagedError(){return this.isDisengagedError}getFullAdaptiveCardText(e){const t=e.adaptiveCards?e.adaptiveCards[0]:null;let a="";if(t){const e=t.body;for(const t of e)"TextBlock"===t.type&&(a+=t.text)}return a}handleStreamEndInternal(e){(0,i.cY)("ExcelAppSharedStreamHandler: Excel App Copilot streaming ended."),this.logDiagnostics();const t=e.messages?.find((e=>this.isValidMessageForRendering(e)));return t}async handleStreamEndForSharedCopilot(e,t,a,n,o,h,p,b){!this.conversationId?.length&&n&&(this.conversationId=n,L.M.conversationId=n,q.B.conversationId=n),this.sydneyEndpoint?.length||(this.sydneyEndpoint=h);const f=this.handleStreamEndInternal(e);f&&(0,te.JK)(f)&&(this.streamingCitationHandler?.processCitations(f,b),this.streamingCitationHandler?.setMessageMetadata(f,e)),this.streamingCitationHandler?.doMessageContainsCitation(this.messageId)&&this.telemetryLogger.endTriedActivitySuccess(r.q.Search);let y={};if(this.telemetryEventHandler.updateTelemetryLatencyData({[r.CT.ContentOrigin]:f?.contentOrigin??I.w.Unknown},this.telemetryLogger),this.messageId){if(f&&f.messageId===this.messageId&&!z(f)){(0,i.cY)("ExcelAppSharedStreamHandler: Message id was set. Updating final message rendered");const n=(0,R.pX)()?e.conversationSensitivityLabel:void 0;if(n){(0,i.cY)("ExcelAppSharedStreamHandler: Enterprise search"),(0,c.Wd)()&&(0,x.YwR)();const e=(0,w.oR)(n);try{const t=await S.n.getInstance().getInDocSensitiveLabelUsingOfcJs(),a=await S.n.getInstance().getHighestDocumentSensitivityInfo([t,e]);a.isDke=t.isDke,a.hasExtractForUser=t.hasExtractForUser,(0,i.cY)("Highest label: "+JSON.stringify(a)),S.n.getInstance().setInDocSensitivityLabelInfo(a)}catch(e){(0,i.cY)("Enterprise search: Office JS sensitivity api failed: "+e.message),this.telemetryLogger.logError({eventType:_.S.OfficeJsOperations,errorMessage:"Exception while calling Office JS sensitivity api in Flux Copilot Workflow: "+e.message,logLevel:r.$b.Error},void 0,[{key:"userQueryGuid",value:L.M.userQueryGuid}]),(0,c.yw)("OfficeVSO_8787558_CopilotChatASHALog")&&L.M.getInstance().logStandardizedAshaErrorEvent(k.W.LLM_Service_Side_Issue_Prevents_Output,N.c.Orchestration_Failed_When_Calling_OfficeJS_Sensitivity_API,r.BJ.CopilotChat)}}const o=(0,c._b)()?(0,w.yu)():void 0,l=this.shouldStopLoadingUi(e);y=await this.updateLastRenderedMessage(f,t,a,o,l)}}else{const t=d.$.getInstance().getLastMessage(!1);if(t&&t.body.user===m.Q9.Chat){const a=t?.messageType??g._.MarkdownCard;(0,i.cY)("ExcelAppSharedStreamHandler: Message id was not set. Stopping loading ui for last message"),d.$.getInstance().updateLastMessage({chatCardType:a,stopLoadingUi:this.shouldStopLoadingUi(e),addCardToChatHistory:!1})}}const v=d.$.getInstance().getLastMessage(!1),T=await t(l.mF.getInsertingFormulaSuggestion());if(v&&v.body.user===m.Q9.Human&&!T||(0,c.yw)("OfficeVSO_9250375_DisplayPythonChatMessage")&&ie.CP.pythonContextManager.isPythonMode&&f){if((0,c.Eq)())return;f||L.M.getInstance().logError({eventType:_.S.StreamHandler,errorMessage:"ExcelAppSharedStreamHandler: finalMessage is undefined",logLevel:r.$b.Warning});const t=f?.text??(0,C.BFD)();(0,i.cY)("ExcelAppSharedStreamHandler: No chat message has been rendered. Rendering text from final message. text: ",t);const a=this.shouldStopLoadingUi(e);this.addResponseMarkdownMessageCard(t,f?.messageId,a,f?.contentOrigin)}if(y.conversationId=this.conversationId,y.messageId=f?.messageId,y.userQueryGuid=L.M.userQueryGuid,y.chunkCount=this.chunksCount,y.groundingMode=(0,r.Q6)(),this.telemetryEventHandler.updateTelemetryChatEventData({[r.h3.ChatEventType]:r.a5.ResponseStreamFinished,[r.h3.ChatEventParameters]:JSON.stringify({lastMessageMetadata:y})},this.telemetryLogger),t(s.mF.resetDoesFluxTurnRequireUndo()),this.cleanupStreamHandler(),D.Q.getInstance().stopRecordingFluxWorkflow(!0),this.shouldStopLoadingUi(e)&&(await t(l.mF.stopExecutingAndReleaseContextLock(!0)),(0,c.vI)()&&t(l.mF.setLoadingStrings([]))),(0,c.k6)()&&(0,u.s_)(u.H0.EnableApply),o){if(!this.isMessageRendered){let e=(0,r.eQ)(f?.contentOrigin);(0,c.yw)("OfficeVSO_9370618_FixUserPerceiveLatencyForElseFallback")&&this.telemetryLogger.getActiveFeature()!==r.BJ.CopilotChat&&(e=this.telemetryLogger.getActiveFeature()),this.telemetryLogger.assertFeatureIsActive(e,"handleStreamEndForSharedCopilot: Feature from finalMessage?.contentOrigin does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!1,!0,p??!1,o,this.telemetryLogger,e),this.isMessageRendered=!0,this.augloopSignalSentTime=void 0}const e=(0,r.xJ)(o);this.telemetryEventHandler.logLatency(e,r.OP.ChatResponseLastChunk)}}async getExcelActionButtons(e,t,a,n,o){const i=[];d.$.getInstance().doesLastResponseHaveTable=!1,this.showUndoButton&&(0,c.BA)()&&i.push((0,u.FW)(r.q.CopilotChat)),this.disableUndoButton&&(0,u.s_)(u.H0.DisableUndo);const l=a===I.w.ElseSkillName;if(l&&(0,c.yw)("OfficeVSO_9339984_addFormulaDevButtonToElse")){const e=(0,se.J)(this.shouldShowFormulaDevButton,this.lastFormulaRequestDebugInfo);e&&i.push(e)}const s=this.streamingCitationHandler?.doMessageContainsExcelCitation(e);if((0,c.iP)("Microsoft.Office.Excel.FA000000124.ImportDataShowImportButton",!0)&&s){let t=S.n.getInstance().getInDocSensitiveLabelInfo();""===t.labelId&&(await S.n.getInstance().setInDocSensitiveLabelInfoUsingOfcJs(),t=S.n.getInstance().getInDocSensitiveLabelInfo()),i.push((0,u.E_)(e,L.M.userQueryGuid,t,n))}const m=!s&&((0,R.pX)()||(0,R.gc)());if(l&&(0,c.yw)("OfficeVSO_9211113_InsertTablesFromElseCard")||m){const e=function(e){if(!e)return"None";const t=(new(M())).parse(e,{});return t.some((e=>"table_close"===e.type))?(d.$.getInstance().doesLastResponseHaveTable=!0,"Table"):t.some((e=>"ordered_list_close"===e.type||"bullet_list_close"===e.type))?"List":"None"}(t),o=m&&!l&&a!==I.w.GetInsightsName;"Table"===e?i.push((0,u.AU)(n)):o&&"List"===e&&i.push((0,u.A6)(n))}if(o&&!(0,c.pu)()){const e=0===i.length;i.push((0,u.z3)(e))}return(0,c.jH)()&&i.push((0,u.yo)(e)),i}getSuggestionItems(e){return e.filter((e=>e.messageType===ae.n3.Suggestion)).map((e=>({suggestionText:e.text,suggestionType:E.hC.SydneySuggestion})))}async updateLastRenderedMessage(e,t,a,n,o=!0){const s=!(e.contentOrigin===I.w.ElseSkillName||(0,R.pX)()&&function(e){if(!e)return!1;const t=/=\S+\(.*\)/,a=/[+\-@]\S+\(.*\)/,n=/[=+\-@]\S*[!|]/,o=new RegExp(`${t.source}|${a.source}|${n.source}`).test(e);if(o){(0,O.cY)("NOTICE!: Potential formula found: "+e);const o=t.test(e),i=a.test(e),l=n.test(e);L.M.getInstance().logError({eventType:_.S.StreamHandler,errorMessage:`messageCouldHaveFormulas: Potential formula found. First pattern hit: ${o}, Second pattern hit: ${i}, Third pattern hit: ${l}`,logLevel:r.$b.Warning},void 0,[{key:"userQueryGuid",value:L.M.userQueryGuid}]),(0,c.yw)("OfficeVSO_8787558_CopilotChatASHALog")&&L.M.getInstance().logStandardizedAshaErrorEvent(k.W.Missing_Copilot_Functionality,N.c.Input_Resulted_In_Unsupported_Command,r.BJ.CopilotChat)}return o}(e.text)),u=await this.getExcelActionButtons(e.messageId,e.text,e.contentOrigin,t,s);let m=[],p=[];if(((0,c.FE)()||(0,c.vI)())&&((e.sourceAttributions||[]).length>0?((0,i.cY)("ExcelAppSharedStreamHandler: Getting external citations here.."),m=T.getInstance().getChatReferenceFromSourceAttributions(e.sourceAttributions,!1,!0),p=T.getInstance().getChatReferenceFromSourceAttributions(e.sourceAttributions,!0)):(e.citations||[]).length>0&&(0,i.cY)("ExcelAppSharedStreamHandler: Getting in-doc citations which is not supported in Excel"),(0,R.pX)()||(0,R.gc)())){const{suggestedResponses:a}=e;if((0,i.cY)("ExcelAppSharedStreamHandler: suggestedResponses ",a),(0,c.iP)("Microsoft.Office.Excel.FA000000124.ImportDataShowImportButton",!0)){if(a&&a.length>0){const e=this.getSuggestionItems(a);t(l.mF.setSuggestionListDetails({suggestionList:e}))}}else{const o=[],r=await(this.streamingCitationHandler?.getStaticSuggestionIfExcelFileExist(e.messageId,e.sourceAttributions,n))??[];if(r.length>0&&o.push(r[0]),a&&a.length>0){const e=this.getSuggestionItems(a);o.push(...e),t(l.mF.setSuggestionListDetails({suggestionList:o.slice(0,ce)}))}}}const f=(0,c.kk)()&&e.sourceAttributions&&a?(0,x.tO0)(e.sourceAttributions,a,(0,c.nz)(),!0):void 0;if(this.shouldRenderAdaptiveCard(e)){const t=e.adaptiveCards?e.adaptiveCards[0]:{},a=oe.n.getChartAdaptiveCardResponse({requestId:e.requestId,adaptiveCardDefinition:t});d.$.getInstance().updateLastMessage(a.message)}else{const t=this.getMarkdownCardOptionsByMessageOrigin(e.contentOrigin,e.messageId).feedbackData?.feedbackArea;d.$.getInstance().updateLastMessage({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.text,horizontalTableScroll:!0,componentsOverride:this.getCustomMarkdownComponents(e.contentOrigin,e.messageId)}},chatMessageBodyData:(0,b.Cn)({showAIGenerated:!0,showAnimation:!0,footerPosition:h.O.Footer,actionButtonList:u,isFailure:!1,references:m&&m.length>0?m:void 0,annotationReferences:p&&p.length>0?p:void 0,clpLabel:n?(0,w.Q9)(n):void 0,msgExtCardProps:1===f?.attributions.length?void 0:f,feedbackArea:t,shouldShowCopyButton:s&&(0,c.pu)()}),stopLoadingUi:o,addCardToChatHistory:!0})}return{suggestionsCount:e.suggestedResponses?.length,citationCount:m?.length,crossAppCitations:T.getInstance().getLastBuildCrossAppCitations(),actionButtonsCount:u.length,responseHasTable:d.$.getInstance().doesLastResponseHaveTable,messageLabel:n?.displayName}}handleChatResponseForSharedCopilot(e,t,a,n,o,s,u,m,h){(0,c.th)()&&h&&(0,A.y)(h,r.BJ.CopilotChat),o?.length&&(this.conversationId=o,L.M.conversationId=o,q.B.conversationId=o),s?.length&&(this.sydneyEndpoint=s);const p=t.basinCursor,f=t.basinWrite,C=t.messagesToAddOrReplace,y=t.messagesToDelete,v=t.messagesToUpdate;if(!(0,i.hX)(y))for(const e of y)(0,i.cY)("ExcelAppSharedStreamHandler: Deleting message id: ",e),d.$.getInstance().deleteMessage({chatCardType:g._.MarkdownCard,messageIdToDelete:e}),delete this.basin.items[e];if(!(0,i.hX)(p)){const e=JSON.parse(p);this.basin.setCursor(e),(0,i.cY)("ExcelAppSharedStreamHandler: Setting basin cursor: ",e)}if((0,i.cY)("ExcelAppSharedStreamHandler: Initial/previous annotation message id is "+this.messageId),!(0,i.hX)(C)&&C.length>0)for(const t of C){if((0,c.yw)("OfficeVSO_9463020_excelDisengagementErrorHandling")){if(this.isDisengagedError)break;if(this.isDisengagedMessage(t)){this.isDisengagedError=!0;const{message:e,telemetry:t}=oe.n.getDisengagedErrorResponse();d.$.getInstance().displayResponse(e,t),(0,le.I)(void 0,r.BJ.CopilotChat);break}}(0,te.JK)(t)&&this.streamingCitationHandler?.processCitations(t,m);const a=(0,O.WF)(t.text);if(a)if((0,i.cY)("ExcelAppSharedStreamHandler:  Adding Text analysis for messagesToAddOrReplace:"+t.text),(0,c.iP)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1))e(re.mF.showTextAnalysisRecommendationCard(a));else try{const{visual:e,title:a}=JSON.parse(t.text).visual,{message:n,telemetry:o}=oe.n.getTextAnalysisV1Response({requestId:L.M.userQueryGuid,textAnalysis:e,title:a});d.$.getInstance().displayResponse(n,o)}catch(e){this.addResponseMarkdownMessageCard(e,t.messageId)}else if(this.isValidMessageForRendering(t)){if((0,i.cY)("ExcelAppSharedStreamHandler: MessageId for this annotation is : "+t.messageId),t.messageId!==this.messageId){if(this.messageId=t.messageId,this.isFirstStreamChunk){if(n){if(!(0,c.yw)("OfficeVSO_9370618_FixUserPerceiveLatencyForElseFallback")||!this.isMessageRendered){let e=(0,r.eQ)(t?.contentOrigin);(0,c.yw)("OfficeVSO_9370618_FixUserPerceiveLatencyForElseFallback")&&this.telemetryLogger.getActiveFeature()!==r.BJ.CopilotChat&&(e=this.telemetryLogger.getActiveFeature()),this.telemetryLogger.assertFeatureIsActive(e,"handleChatResponseForSharedCopilot: Feature from message?.contentOrigin does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!0,!0,u??!1,n,this.telemetryLogger,e),this.augloopSignalSentTime=void 0}const e=(0,r.xJ)(n);this.telemetryEventHandler.logLatency(e,r.OP.ChatResponseFirstChunk)}this.isFirstStreamChunk=!1}if((0,b.D9)(t.offense),(0,i.cY)("ExcelAppSharedStreamHandler: Adding Response Card for messagesToAddOrReplace:",t),z(t))Q(t,d.$.getInstance());else if(this.shouldRenderAdaptiveCard(t)){const e=t.adaptiveCards?t.adaptiveCards[0]:{},a=oe.n.getChartAdaptiveCardResponse({requestId:t.requestId,adaptiveCardDefinition:e});d.$.getInstance().displayResponse(a.message,a.telemetry)}else{this.basin.items[this.messageId]={adaptiveCards:[{body:[{text:t.text,type:"TextBlock",wrap:!0}]}]};const e=this.getFullAdaptiveCardText(t);(0,i.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",e),this.addResponseMarkdownMessageCard(e||t.text,t.messageId,void 0,t.contentOrigin)}}else if(!z(t)){(0,i.cY)("ExcelAppSharedStreamHandler: Adding Response Card for messagesToAddOrReplace:",t);const e=this.getFullAdaptiveCardText(t);(0,i.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",e);const a=t.sourceAttributions,n=a?T.getInstance().getChatReferenceFromSourceAttributions(a):[],o=a?T.getInstance().getChatReferenceFromSourceAttributions(a,!0):[];this.updateResponseMarkdownMessageCard(e||t.text,!0,n,o)}}else de()&&this.isInternalLoadingMessage(t)&&e(l.mF.setLoadingStrings([t.text]))}else{if(!(0,i.hX)(v)&&v.length>0)for(const e of v)if((0,i.cY)("ExcelAppSharedStreamHandler: MessageId for this annotation is : "+e.messageId),e.messageId===this.messageId){(0,i.cY)("ExcelAppSharedStreamHandler: Updating Response Card to messagesToUpdate:",e);const t=e.sourceAttributions,n=t?T.getInstance().getChatReferenceFromSourceAttributions(t):[],o=t?T.getInstance().getChatReferenceFromSourceAttributions(t,!0):[],r=(0,c.kk)()&&t&&a?(0,x.tO0)(t,a,(0,c.nz)()):void 0;this.updateResponseMarkdownMessageCard(e.appendText,void 0,n,o,r),(0,te.JK)(e)&&this.streamingCitationHandler?.processCitations(e,m)}if(!(0,i.hX)(f)){const e=JSON.parse(f);(0,i.cY)("ExcelAppSharedStreamHandler: Basin write received: ",e),this.basin.write(e);const t=this.getFullAdaptiveCardText(this.basin.items[this.messageId]);(0,i.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",t),this.updateResponseMarkdownMessageCard(t||e,!0)}}}async handleChatResponse(e,t,a,n,o,r,l,u){(0,i.cY)("ExcelAppSharedStreamHandler: Excel Copilot chatResponse received for Shared Copilot");const m=t(s.mF.getLocaleInfo())?.dataLocale;if(!((0,c.yw)("OfficeVSO_9176144_DontProcessInternalLoaderMessages")&&this.chatResponseIsInternalLoaderMessage(e))){if(e.status===f.lC.Success)return(0,x.BIF)(e,d.$.getInstance().getCopilotRef())?void this.cleanupStreamHandler():void await this.handleStreamEndForSharedCopilot(e,t,a,n,o,r,l,m);this.isStreaming||""===this.messageId||this.handleStreamBegin(t),this.chunksCount++}this.handleChatResponseForSharedCopilot(t,e,a,o,n,r,l,m,u)}chatResponseIsInternalLoaderMessage(e){const t=e.messagesToAddOrReplace?.[0];return!!t&&this.isInternalLoadingMessage(t)}logDiagnostics(){this.conversationId&&(0,i.cY)("ExcelAppSharedStreamHandler: conversation id from Excel App Copilot: "+this.conversationId)}shouldRenderAdaptiveCard(e){return((0,c.yw)("OfficeVSO_9118479_AnalyzeDataAdaptiveCard")&&e.adaptiveCards&&e.adaptiveCards?.length>0&&e.contentOrigin===I.w.GetInsightsName)??!1}constructor(e=()=>te.qx.getInstance()){this.basin=new n.Basin,this.messageId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.isFirstStreamChunk=!0,this.isMessageRendered=!1,this.augloopSignalSentTime=void 0,this.paragraphChunks="",this.contentOrigin=void 0,this.chunksCount=0,this.isDisengagedError=!1,this.conversationId=void 0,this.sydneyEndpoint=void 0,this.locale=void 0,this.telemetryLogger=L.M.getInstance(),this.telemetryEventHandler=F.E.getInstance(),this.lastFormulaRequestDebugInfo=void 0,this.shouldShowFormulaDevButton=!1,this.getMarkdownCardOptionsByMessageOrigin=(e,t)=>{const a=t??this.messageId;switch(e){case I.w.ElseSkillName:return{showAiGenerated:!1,feedbackPosition:h.O.None,useExcelMDComponents:!0,telemetryFeatureName:r.q.Else,feedbackData:{feedbackArea:H.Xw.ELSE},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1};case I.w.GetInsightsName:return{showAiGenerated:!0,feedbackPosition:h.O.Footer,useExcelMDComponents:!0,telemetryFeatureName:r.q.AnalyzeData,feedbackData:{feedbackArea:H.Xw.ANALYZEDATA},shouldShowDevDiagnosticsButton:!0,addCardToChatHistory:!1};default:return{showAiGenerated:!1,feedbackPosition:h.O.Footer,useExcelMDComponents:!1,telemetryFeatureName:this.streamingCitationHandler?.doMessageContainsCitation(a)?r.q.Search:r.q.CopilotChat,feedbackData:{feedbackArea:this.streamingCitationHandler?.doMessageContainsCitation(a)?H.Xw.CHATSEARCH:H.Xw.CHATEXCEL},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1}}},this.isValidMessageForRendering=e=>{if(e.locale&&(this.locale=e.locale),e.text)try{if(JSON.parse(e.text).publishPreference===p.f.Never)return!1}catch(e){}return!(e.author!==ae.nC.Bot||!this.getFullAdaptiveCardText(e)&&!e.text||void 0!==e.messageType&&e.messageType!==ae.n3.Chat||!e.messageId)},this.addResponseMarkdownMessageCard=(e,t,a,n)=>{if((0,i.hX)(e))return void(0,i.cY)("ExcelAppSharedStreamHandler: Returning as message is undefined");(0,i.cY)("ExcelAppSharedStreamHandler: Adding Response Card:",e),this.paragraphChunks=e,this.contentOrigin=n,this.messageId=t??"";const l=this.getMarkdownCardOptionsByMessageOrigin(n,t),s={featureName:l.telemetryFeatureName,eventType:r.a5.ConversationMessage},m=l.shouldShowDevDiagnosticsButton&&(0,c.jH)()&&t?[(0,u.yo)(t)]:void 0;d.$.getInstance().displayResponse({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,horizontalTableScroll:!0,componentsOverride:l.useExcelMDComponents?(0,ne.i)(s.featureName):void 0,disableLinksProcessing:n?.toLowerCase()===I.w.CannedResponse}},chatMessageBodyData:{...(0,b.Cn)({showAIGenerated:l.showAiGenerated,showAnimation:!1,footerPosition:l.feedbackPosition,actionButtonList:m}),messageId:t,feedbackData:l.feedbackData},stopLoadingUi:!!a,startAugloopTimerForStreaming:!a,workflowAnnotationTypeForAugloopTimer:o.Yn.getTypeName(),addCardToChatHistory:l.addCardToChatHistory},s)},this.updateResponseMarkdownMessageCard=(e,t,a,n,l,s)=>{if((0,i.hX)(e))return(0,i.cY)("ExcelAppSharedStreamHandler: Returning as message is undefined"),void q.B.getInstance().sendChatEventTelemetry((0,r.pN)({[r.h3.ChatEventType]:r.a5.EmptyMessageReceivedFromSydney,[r.h3.ChatEventParameters]:"Empty Markdown message card"}));(0,i.cY)("ExcelAppSharedStreamHandler: Updating Response Card:",e);let c=e;c=c.replace("\\n","\n"),this.paragraphChunks=t?c:this.paragraphChunks+c;const u=d.$.getInstance().getLastMessage(),m=u?.actionBarButtons?.slice()??void 0,p=this.getCustomMarkdownComponents(this.contentOrigin,this.messageId);d.$.getInstance().updateLastMessage({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,horizontalTableScroll:!0,componentsOverride:p}},chatMessageBodyData:(0,b.Cn)({showAIGenerated:!1,showAnimation:!1,footerPosition:h.O.None,references:a&&a.length>0?a:void 0,annotationReferences:n&&n.length>0?n:void 0,actionButtonList:m,msgExtCardProps:l,apiPluginCardProps:s}),stopLoadingUi:!1,startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:o.Yn.getTypeName(),addCardToChatHistory:!1})},this.handleStreamBegin=e=>{(0,i.cY)("ExcelAppSharedStreamHandler: handleStreamBegin"),D.Q.getInstance().recordFluxCopilotStep({operation:r.OP.FluxFirstStreamedToken}),((0,R.pX)()||(0,R.gc)())&&e(l.mF.clearSuggestionList())},this.streamingCitationHandler=(0,c.UD)()?e():void 0}}},40700:(e,t,a)=>{a.d(t,{g:()=>c,z:()=>s});var n=a(49134),o=a(88179),r=a(31030),i=a(48314),l=a(50347);function s(){return(0,l.iP)("Microsoft.Office.Excel.FA000000124.IsContextFoilEnabled",!1)}class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}async showGridFoil(e){this.sheetName&&(await this.removeGridFoil(),window.clearTimeout(this.timeout));const t=n.ExcelCalc.sheetNameFromSheetAddresses(e),a=n.ExcelCalc.localAddressesFromSheetAddresses(e);try{await Excel.run((async e=>{const n=e.workbook.worksheets.getItem(t),o=n.getRange(a);n.gridFoils.add(o,this.getCopilotFoilOptions()),await e.sync(),this.sheetName=t}))}catch{i.M.getInstance().logError({eventType:r.S.Error,errorMessage:"GridFoil failed to show",logLevel:o.$b.Warning})}}async removeGridFoil(){if(!this.sheetName)return;const e=this.sheetName;try{await Excel.run((async t=>{t.workbook.worksheets.getItem(e).gridFoils.removeAll(),await t.sync(),this.sheetName=void 0}))}catch{i.M.getInstance().logError({eventType:r.S.Error,errorMessage:"GridFoil failed to remove",logLevel:o.$b.Warning})}}async showGridFoils(e){this.sheetName&&(await this.removeGridFoil(),window.clearTimeout(this.timeout));try{await Excel.run((async t=>{const a=n.ExcelCalc.sheetNameFromSheetAddresses(e[0]),o=t.workbook.worksheets.getItem(a);e.forEach((e=>{const t=n.ExcelCalc.localAddressesFromSheetAddresses(e),a=o.getRange(t);o.gridFoils.add(a,this.getCopilotFoilOptions())})),await t.sync(),this.sheetName=a}))}catch(e){i.M.getInstance().logError({eventType:r.S.Error,errorMessage:"GridFoil failed to show",logLevel:o.$b.Warning})}}static async removeGridFoilWithSheetName(e){if(e)try{await Excel.run((async t=>{t.workbook.worksheets.getItem(e).gridFoils.removeAll(),await t.sync()}))}catch{i.M.getInstance().logError({eventType:r.S.Error,errorMessage:"GridFoil failed to remove",logLevel:o.$b.Warning})}}async highlightWithDuration(e,t){const a=n.ExcelCalc.sheetNameFromSheetAddresses(e[0]);await c.getInstance().showGridFoils(e),this.timeout=window.setTimeout((async()=>{await c.removeGridFoilWithSheetName(a)}),t)}getCopilotFoilOptions(){return{borderColor:"copilotBorder",tintColor:"copilotTint",gradientColor:"copilotGradient"}}}},29348:(e,t,a)=>{a.d(t,{i:()=>n});class n{static getHostAppDisplayLanguage(){return Office.context.displayLanguage}static getDocumentUrlAsync(){return new Promise((function(e){Office.context.document.getFilePropertiesAsync((function(t){e(t.value.url)}))}))}static isWebPlatform(){return Office.context.platform===Office.PlatformType.OfficeOnline}}},2460:(e,t,a)=>{a.d(t,{G:()=>p,i:()=>h});var n=a(658),o=a(40707),r=a(11107),i=a(90216),l=a(55427),s=a(92779),c=a(43371),d=a(92716),u=a(50347),m=a(8520);const g=(0,n.n)({accordionPanel:{marginBottom:"6px"}});function h(e){return{code:({className:t,children:a})=>{if("language-excel"===t){const t="string"==typeof a[0]?a[0]:"";if(t)return m.createElement(d.$,{icon:"math",content:t,copyButtonAriaLabelSuffix:(0,u.yw)("OfficeVSO_9546084_CopyButtonAriaLabelFix")?t:void 0,telemetryUsageFeatureName:e,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),ariaAttributes:{"aria-label":s.xe2.FormulaSuggestion_FormulaSnippet_AriaLabel}})}return m.createElement("code",{className:t},a)}}}function p(e){return{li:({index:t})=>m.createElement(b,e[t]),ul:({children:e})=>m.createElement(o.n,{collapsible:!0,multiple:!0},e)}}function b(e){const t=function(e){let t=e.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/^-\s+(.*)/gm,"<li>$1</li>");if(/<li>/.test(t)){const e=t.indexOf("<li>"),a=t.lastIndexOf("</li>")+5;t=`${t.slice(0,e)}\n    <ul>${t.slice(e,a)}</ul>\n    ${t.slice(a)}`}return t}(e.description),a=g();return m.createElement(r.A,{value:e.header},m.createElement(i.u,{expandIconPosition:"end"},`â€¢ ${e.header}`),m.createElement(l.v,{className:a.accordionPanel},m.createElement(c.u,{text:t})))}},94836:(e,t,a)=>{a.d(t,{OK:()=>l,Ok:()=>i,dD:()=>s});var n=a(31238),o=a(30685),r=a(50347);function i(){switch(Office.context.platform){case Office.PlatformType.PC:(0,r.yw)("OfficeVSO_9470283_ExcelCopilotWin32PlatformType")?(0,n.j_)(o.Y.win32):(0,n.j_)(o.Y.web);break;case Office.PlatformType.iOS:(0,n.j_)(o.Y.IOS);break;case Office.PlatformType.Mac:(0,n.j_)(o.Y.MACOS);break;default:(0,n.j_)(o.Y.web)}}const l=()=>Office.context.platform===Office.PlatformType.iOS||Office.context.platform===Office.PlatformType.Mac,s=()=>Office.context.platform===Office.PlatformType.iOS},61437:(e,t,a)=>{a.d(t,{Z:()=>T});var n=a(16912),o=a(28087),r=a(63843),i=a(72483),l=a(64216),s=a(10748),c=a(4475),d=a(88179),u=a(8338),m=a(48314),g=a(98100),h=a(6925),p=a(55683),b=a(61150),f=a(50347),C=a(71362),y=a(74873),v=a.n(y);class T{cleanupStreamHandler(){this.accessPath="",this.uniqueId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1}resetStartQueryState(e){}isWaitingForStreamEnd(){return this.isStreaming}endUserPerceivedLatency(e,t,a){}getBasinObject(){return this.basin}setShowUndoButton(e){this.showUndoButton=e}setDisableUndoButton(e){this.disableUndoButton=e}getConversationId(){return this.conversationId}static getInstance(){return T._instance||((0,f.eA)()?T._instance=l.s.getInstance():T._instance=new T),T._instance}constructor(){this.basin=new n.Basin,this.accessPath="",this.uniqueId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.conversationId=void 0,this.getAdaptiveCardAccessPath=(e,t)=>e?e.slice(0,e.indexOf("]")+1):"adaptiveCards["+t+"]",this.isValidMessageForRendering=e=>{if(e.text)try{if(JSON.parse(e.text).publishPreference===u.f.Never)return!1}catch(e){}return!("bot"!==e.author||!e.adaptiveCards&&!e.text||void 0!==e.messageType&&"Chat"!==e.messageType||!e.messageId)},this.promiseFromStatus=(e,t,a)=>e===r.lC.Success?this.handleStreamEnd(t,a):this.isStreaming||""===this.uniqueId?Promise.resolve():this.handleStreamBegin(t),this.handleStreamBegin=e=>(this.isStreaming=!0,s.Q.getInstance().recordFluxCopilotStep({operation:d.OP.FluxFirstStreamedToken}),e(h.mF.hideLoadingUI())),this.handleStreamEnd=async(e,t)=>{this.conversationId=t,await e(p.mF.resetDoesFluxTurnRequireUndo()),this.cleanupStreamHandler(),s.Q.getInstance().stopRecordingFluxWorkflow(!0),await e(h.mF.stopExecutingAndReleaseContextLock(!0))},this.handleMessages=e=>{e.messages?.forEach((e=>{if(this.isValidMessageForRendering(e)){const t=e.text,a=[];if(this.showUndoButton&&(0,f.BA)()&&a.push((0,c.FW)(d.q.CopilotChat)),(0,b.cY)("ExcelAppStreamHandler - handleMessages",t),i.$.getInstance().getHasMessageBeenShown(e.messageId))i.$.getInstance().updateLastMessage({chatCardType:o._.Default,chatMessageBodyData:{actionButtonList:a},addCardToChatHistory:!1});else{if((0,b.cY)("ExcelAppStreamHandler - handleMessages - displaying for the first time",t),!this.basin.items[e.messageId]){this.uniqueId=e.messageId;const a=this.getAdaptiveCardAccessPath(this.accessPath,0);this.accessPath||(this.accessPath=a),this.basin.items[this.uniqueId]={adaptiveCards:[{body:[{text:t,type:"TextBlock",wrap:!0}]}]}}if(!v()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,b.cY)("ExcelAppStreamHandler - handleMessages - no card data to show",t);const{message:n,telemetry:o}=C.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath,actionButtonList:a});i.$.getInstance().addMessageIfNeeded(this.uniqueId,n,o)}this.disableUndoButton&&(0,c.s_)(c.H0.DisableUndo)}}))},this.handleMessagesToDelete=e=>{e.messagesToDelete?.forEach((e=>{delete this.basin.items[e]}))},this.handleBasinCursor=e=>{const t=e.basinCursor;if(!(0,b.hX)(t)){const e=JSON.parse(t),a=e?.j||e?.jsonPath;this.uniqueId=a.slice(a.indexOf("[")+2,a.indexOf("]")-1),this.accessPath=this.getAdaptiveCardAccessPath(a.slice(a.indexOf("]")+2),0),this.basin.setCursor(e)}},this.handleMessagesToAddOrReplace=e=>{e.messagesToAddOrReplace?.forEach((e=>{if((0,g.WF)(e.text)){(0,b.cY)("ExcelAppSharedStreamHandler:  Adding Text analysis for messagesToAddOrReplace:"+e.text);try{const{visual:t,title:a}=JSON.parse(e.text).visual,{message:n,telemetry:o}=C.n.getTextAnalysisV1Response({requestId:m.M.userQueryGuid,textAnalysis:t,title:a});i.$.getInstance().displayResponse(n,o)}catch(e){const t={featureName:d.q.CopilotChat,eventType:d.a5.ConversationMessage};i.$.getInstance().displayResponse({chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e,horizontalTableScroll:!0}}},t)}}else if(this.isValidMessageForRendering(e)){if(!this.basin.items[e.messageId]){this.uniqueId=e.messageId;const t=this.getAdaptiveCardAccessPath(this.accessPath,0);this.accessPath||(this.accessPath=t),this.basin.items[this.uniqueId]={adaptiveCards:[{body:[{text:e.text,type:"TextBlock",wrap:!0}]}]}}if(!v()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,b.cY)("ExcelAppStreamHandler - handleMessagesToAddOrReplace - no card data to show");(0,b.cY)("ExcelAppStreamHandler - handleMessagesToAddOrReplace",e.text);const{message:t,telemetry:a}=C.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath});i.$.getInstance().addMessageIfNeeded(this.uniqueId,t,a)}}))},this.handleMessagesToUpdate=e=>{e.messagesToUpdate?.forEach((e=>{this.uniqueId=e.messageId;const t=e.acLoc;t?this.basin.items[this.uniqueId].adaptiveCards[t.cIdx].body[t.bIdx].text+=e.appendText:this.basin.items[this.uniqueId].text+=e.appendText;if(!v()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,b.cY)("ExcelAppStreamHandler - handleMessagesToUpdate - no card data to show");(0,b.cY)("ExcelAppStreamHandler - handleMessagesToUpdate",e.appendText);const{message:a,telemetry:n}=C.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath});i.$.getInstance().addMessageIfNeeded(this.uniqueId,a,n)}))},this.handleBasinWrite=e=>{const t=e.basinWrite;(0,b.hX)(t)||this.basin.write(JSON.parse(t))},this.handleChatResponse=async(e,t,a)=>(this.handleMessages(e),this.handleBasinCursor(e),this.handleMessagesToDelete(e),this.handleMessagesToAddOrReplace(e),this.handleMessagesToUpdate(e),this.handleBasinWrite(e),this.promiseFromStatus(e.status,t,a))}}},90489:(e,t,a)=>{a.d(t,{JK:()=>_,RD:()=>$,bn:()=>D,qx:()=>B});var n=a(89099),o=a(24220),r=a(82729),i=a(72483),l=a(54676),s=a(23247),c=a(8069),d=a(29181),u=a(92779),m=a(58632),g=a(77303),h=a(88179),p=a(26115),b=a(39531),f=a(74840),C=a(96854),y=a(31030),v=a(48314),T=a(6925),x=a(91519),S=a(35717),w=a(46835),E=a(41102),R=a(50347),I=a(98483);const A=(0,R.Z8)("Microsoft.Office.Excel.FA000000124.CitationMetadataFetchRequestTimeoutMs",3e4),L=v.M.getInstance(),F=C.E.getInstance();function _(e){return void 0!==e.sourceAttributions&&void 0!==e.messageId}const N=new Map,k=new Map;async function O(e,t,a,r,d){try{const u=new p.g0({parentPath:["Signal",l.Uk.getTypeName()],items:[{id:r,body:new l.Uk({locale:d,fileIdentifiers:[{fileUrl:a,fileName:t}],requestId:r})}]});if((0,R.yw)("OfficeVSO_9523129_refactorCitationSignalAwait"))return(0,m.T)(u,e,r,y.S.CitationFileUtils,h.OP.FetchCitationFileMetadata,s.b.getTypeName(),A);{const t=(0,S.p)();(0,R.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse")?i.$.getInstance().submitOperation({operation:u,workflowAnnotationType:s.b.getTypeName()}):e.submitOperation(u);const a=setTimeout((()=>{M(r,{id:r,body:{requestId:r,error:{errorCode:c.O.Timeout,errorMessage:`ExcelImportDataFileMetadataSignal Request timed out after ${A} ms. request id ${r}`}}}),L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Timeout,h.BJ.ImportData)}),A);return N.set(r,{deferredPromise:t,requestId:r,timeoutId:a,startTime:performance.now(),telemetryEventType:y.S.CitationFileUtils,latencyOperation:h.OP.FetchCitationFileMetadata}),t.promise}}catch(e){throw L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Error while submitting signal to fetch citation file details: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Error,h.BJ.ImportData),e}}function P(e,t){const a=k.get(e);if(a){k.delete(e),clearTimeout(a.timeoutId);const n=performance.now()-a.startTime;F.logLatency(n,h.OP.FetchTablesRelevancy),t instanceof Error?a.deferredPromise.reject(t):a.deferredPromise.resolve(t.body),L.logEvent((0,h.P1)(y.S.FetchTablesRelevancy,{[h.pf.RequestId]:e,[h.pf.ExecutionTime]:n,[h.pf.Success]:!(t instanceof Error),[h.pf.Error]:t instanceof Error?t.message:""}))}else L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Relevancy_Error,h.BJ.ImportData),L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Received data import annotation for unknown request ${e}`,logLevel:h.$b.Warning})}function M(e,t){const a=N.get(e);if(a){N.delete(e),clearTimeout(a.timeoutId);const n=performance.now()-a.startTime;F.logLatency(n,h.OP.FetchCitationFileMetadata),t instanceof Error?a.deferredPromise.reject(t):a.deferredPromise.resolve(t.body),L.logEvent((0,h.P1)(y.S.FetchCitationMetadata,{[h.pf.RequestId]:e,[h.pf.ExecutionTime]:n,[h.pf.Success]:!(t instanceof Error),[h.pf.Error]:t instanceof Error?t.message:""}))}else L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Error,h.BJ.ImportData),L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Received data import annotation for unknown request ${e}`,logLevel:h.$b.Warning})}function D(e){e.body&&s.b.typeGuard(e.body)&&M(e.body.requestId,e)}function $(e){e.body&&s.D.typeGuard(e.body)&&P(e.body.requestId,e)}class B{static getInstance(){return B._instance||(B._instance=new B((()=>(0,I.A)()),E.qD)),B._instance}setMessageMetadata(e,t){const a=t.messages?.filter((e=>"user"===e.author))[0]?.text??"";this.messageIdToMessageMetaDataMap.set(e.messageId,{userQuery:a,chatResponse:e.text,locale:e.locale??"",sensitivityLabel:e.sensitivityLabel})}doMessageContainsExcelCitation(e){return this.messageIdToFileUrlsMap.has(e)}doMessageContainsCitation(e){return this.messagesWithCitations.has(e)}async processCitations(e,t){try{this.augloopSession?e.sourceAttributions?.forEach((async a=>{this.messagesWithCitations.add(e.messageId);const n=await H(a);if(!n)return(0,w.debuglog)("Skipping citation file details fetch for non valid excel file"),Promise.resolve();const o=a.seeMoreUrl;this.messageIdToFileUrlsMap.has(e.messageId)||this.messageIdToFileUrlsMap.set(e.messageId,new Set),this.messageIdToFileUrlsMap.get(e.messageId)?.add(o);const r=`${v.M.userQueryGuid}_${e.messageId}_${this.requestIdGenerator()}`;if(!this.inProgressItems?.has(o)&&!this.resolvedItems?.has(o)){const e=async()=>{try{const e=await this.fetchCitationFileDetailsImpl(this.augloopSession,n.fileName,o,r,t??"");return this.resolvedItems?.has(o),this.resolvedItems?.set(o,e),this.inProgressItems?.delete(o),this.notifyItemResolvedEventHandlers(e),e}catch(e){return this.inProgressItems?.delete(o),L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Error while fetching citation file details: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),Promise.resolve(void 0)}};this.inProgressItems?.set(o,e())}})):L.logError({eventType:y.S.CitationFileUtils,errorMessage:"AugLoop session is not available to process citations",logLevel:h.$b.Warning})}catch(e){L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Error while processing citations: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Error,h.BJ.ImportData)}}intersectResolvedCitations(e){return e?.filter((e=>e.seeMoreUrl&&this.resolvedItems?.has(e.seeMoreUrl)))?.map((e=>this.resolvedItems.get(e.seeMoreUrl)))?.filter((e=>void 0!==e))}async fetchRelevantTablesForMessageId(e,t,a,r,d,u=T.mF){try{r(u.startExecutingCommand({command:h.OP.ImportDataGenerateSuggestion,id:d}));const g=await this.getAllResolvedDataSourcesForMessageId(e,t),b=this.messageIdToMessageMetaDataMap.get(e);if(!b||0===g.length){const t=`Message metadata or dataSources not found.\nskipping relevancy check.\ndataSources length: ${g.length},\nmessageMetaData undefined: ${!b},\nmessage id: ${e}`;return L.logError({eventType:y.S.CitationFileUtils,errorMessage:t,logLevel:h.$b.Error}),Promise.resolve({requestId:"",dataSources:g})}if(!(0,R.iP)("Microsoft.Office.Excel.FA000000124.ImportDataEnableRelevancyCheck",!0))return Promise.resolve({requestId:"",dataSources:g});r(u.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0})),r(u.startExecutingCommand({command:h.OP.ImportDataRelevancyCheck,id:d}));const f=`${v.M.userQueryGuid}_${e}_${this.requestIdGenerator()}`,C=new p.g0({parentPath:["Signal","ExcelImportDataSourcesRelevancySignal"],items:[{id:f,body:new l.sN({requestId:f,userQuery:b?.userQuery??"",chatResponse:b?.chatResponse??"",sources:g})}]});if((0,R.yw)("OfficeVSO_9523129_refactorCitationSignalAwait"))return(0,m.T)(C,this.augloopSession,f,y.S.CitationFileUtils,h.OP.FetchTablesRelevancy,s.D.getTypeName(),a,{dataSources:g});{const e=(0,S.p)();(0,w.debuglog)(`SENDING SIGNAL TO RUN RELEVANCY CHECK: ${JSON.stringify(C)}`),(0,R.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse")?i.$.getInstance().submitOperation({operation:C,workflowAnnotationType:s.D.getTypeName()}):this.augloopSession?.submitOperation(C);const t=setTimeout((()=>{P(f,{id:f,body:{requestId:f,dataSources:g,error:{errorCode:c.O.Timeout,errorMessage:`ExcelImportDataSourcesRelevancySignal Request timed out after ${a} ms. returning sources without relevancy. request id ${f}`}}}),L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Relevancy_Timeout,h.BJ.ImportData)}),a);return k.set(f,{deferredPromise:e,requestId:f,timeoutId:t,telemetryEventType:y.S.CitationFileUtils,latencyOperation:h.OP.FetchTablesRelevancy,startTime:performance.now()}),e.promise}}catch(e){throw L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Error while submitting signal to run relevancy check: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Relevancy_Error,h.BJ.ImportData),e}}async getAllResolvedDataSourcesForMessageId(e,t){const a=this.messageIdToFileUrlsMap.get(e)??new Set,r=this.getCurrentTime()+t,i=()=>Array.from(a).filter((e=>!this.resolvedItems.has(e)&&this.inProgressItems.has(e)));let l=i();for(;l.length>0&&this.getCurrentTime()<r;)await Promise.race([U(r-this.getCurrentTime()),this.waitForItemResolved()]),l=i();const s=Array.from(a).map((e=>this.resolvedItems.get(e))),d=s.filter((e=>{const t=void 0!==e&&void 0===e.error&&e.dataSources&&e.dataSources.length>0;if(!t&&(L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Filtering resolved citation: citationDetails: ${!!e} citationDetails.error: ${JSON.stringify(e?.error)}\n            } citationDetails.dataSources count: ${e?.dataSources?.length}, requestId: ${e?.requestId}`,logLevel:h.$b.Error}),e?.error?.errorCode)){const t=e.error.errorCode===c.O.Timeout?n.c.Import_Data_File_Fetching_Timeout:n.c.Import_Data_File_Fetching_Error;L.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,t,h.BJ.ImportData)}return t})),u=d.map((e=>e.dataSources)).flat(),m=u.filter((e=>{const t=void 0===e.error&&e.sourceName&&e.sourceLocation&&e.powerQueryScript;return t||L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Filtering data source: dataSource.error: ${JSON.stringify(e.error)} dataSource.sourceName: ${!!e.sourceName} dataSource.sourceLocation: ${!!e.sourceLocation} dataSource.powerQueryScript: ${!!e.powerQueryScript}`,logLevel:h.$b.Error}),t}));return L.logEvent((0,h.P1)(y.S.GetResolvedCitations,{[h.pf.TotalFiles]:a.size,[h.pf.UnresolvedCitations]:l.length,[h.pf.ResolvedCitations]:s.length,[h.pf.ResolvedValidCitations]:d.length,[h.pf.ResolvedDataSources]:u.length,[h.pf.ValidDataSources]:m.length})),m}async getStaticSuggestionIfExcelFileExist(e,t,a){const n=[];try{if((await Promise.all((t??[]).map((async e=>await H(e))))).some((e=>e))){const t=(0,g.Q9t)(a);n.push({suggestionText:(0,u.bd1)(),suggestionType:f.hC.ImportDataFromFile,itemClp:t,properties:{messageId:e}})}}catch(e){L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Error while generating static suggestion for excel file: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error})}return n}registerOnItemResolvedEventHandler(e){this.onItemResolvedEventHandlers.push(e)}unregisterOnItemResolvedEventHandler(e){const t=this.onItemResolvedEventHandlers.indexOf(e);t>-1&&this.onItemResolvedEventHandlers.splice(t,1)}waitForItemResolved(){return new Promise((e=>{this.registerOnItemResolvedEventHandler((t=>{this.unregisterOnItemResolvedEventHandler(e),e(t)}))}))}notifyItemResolvedEventHandlers(e){setTimeout((()=>{this.onItemResolvedEventHandlers.forEach((t=>t(e)))}),0)}constructor(e,t,a=new Map,n=new Map,o=new Map,r=new Set,i=new Map,l=Date.now,s=O){this.requestIdGenerator=e,this.inProgressItems=a,this.resolvedItems=n,this.messageIdToFileUrlsMap=o,this.messagesWithCitations=r,this.messageIdToMessageMetaDataMap=i,this.getCurrentTime=l,this.fetchCitationFileDetailsImpl=s,this.augloopSession=void 0,this.onItemResolvedEventHandlers=[],t().then((e=>{this.augloopSession=e}))}}async function H(e){if(e.referenceMetadata)try{const t=JSON.parse(e.referenceMetadata);if(!t)throw new Error("referenceMetadata could not be parsed");const a=t.referenceType===b.YA.Excel||t.referenceType===d.ss.Excel,n=void 0!==e.providerDisplayName,o=t.sensitivityLabel?.isEncrypted,i=(0,R.iP)("Microsoft.Office.Excel.FA000000124.ImportFilterEncryptedFiles",!0),l=(0,R.iP)("Microsoft.Office.Excel.FA000000124.ImportFilterOnlyXlsxFiles",!0);if(!a||!n||o&&i)return L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Skipping file: isExcelFile: ${a}, hasDisplayName: ${n}, isEncrypted: ${o}`,logLevel:h.$b.Warning}),Promise.resolve(void 0);if(l&&t.fileName?.includes(".")){const e=t.fileName?.split(".").pop();if("xlsx"!==e?.toLowerCase())return L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Skipping file: fileExtension: ${e}`,logLevel:h.$b.Warning}),Promise.resolve(void 0)}return await async function(e){const t=(0,x.oR)(e.sensitivityLabel);return await r.n.getInstance().isSensitivityHigherThanDoc(t)}(t)?((0,w.debuglog)(`Skipping citation file details fetch for sensitive file ${t.fileName} with sensitivity ${t.sensitivityLabel}`),L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Skipping citation file details fetch for sensitive file with sensitivity ${t.sensitivityLabel?.displayName}`,logLevel:h.$b.Warning}),Promise.resolve(void 0)):e.seeMoreUrl?(t.fileName=e.providerDisplayName,Promise.resolve(t)):(L.logError({eventType:y.S.CitationFileUtils,errorMessage:"Citation file url is missing in source attribution",logLevel:h.$b.Warning}),Promise.resolve(void 0))}catch(e){L.logError({eventType:y.S.CitationFileUtils,errorMessage:`Error while parsing reference metadata: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error})}return Promise.resolve(void 0)}function U(e){return new Promise((t=>setTimeout(t,e)))}B._instance=void 0},83349:(e,t,a)=>{a.d(t,{H5:()=>l,IC:()=>i,iK:()=>r,rK:()=>s});var n=a(98100),o=a(8520);function r(e){const t=o.useRef(e);t.current=e,o.useEffect((()=>()=>t.current()),[])}function i(e,t){const a=o.useRef(!1),n=o.useRef(t);n.current=t,o.useEffect((()=>{!a.current&&e&&(a.current=!0,n.current())}),[e])}function l(e){i(!0,e)}function s(e,t,a,r){const i=(0,o.useRef)(performance.now()),[l,s]=(0,o.useState)((()=>t?"loaded":"loading")),c=function(e,t){const a=(0,o.useRef)(e);a.current=e;const n=(0,o.useRef)();return(0,o.useEffect)((()=>{const e=setTimeout((()=>{a.current?.()}),t);return n.current=()=>{clearTimeout(e),n.current=void 0},()=>n.current?.()}),[]),()=>n.current?.()}((()=>{(0,n.cY)(`useLoadingTimeout(${e}): timed out after ${a/1e3}s`),s("timeout"),r?.onTimeout?.()}),a);return(0,o.useEffect)((()=>{const a=performance.now()-i.current,o=`useLoadingTimeout(${e}, t=${(a/1e3).toFixed(2)}s)`;if(t)switch(l){case"loaded":r?.onLoaded?.(Math.round(a),!1),(0,n.cY)(`${o}: already loaded`),c();break;case"loading":(0,n.cY)(`${o}: loaded`),c(),s("loaded");break;case"timeout":(0,n.cY)(`${o}: loaded after timeout`),r?.onLoaded?.(Math.round(a),!0)}}),[t,l]),l}},67329:(e,t,a)=>{a.d(t,{q:()=>s,w:()=>d});var n=a(88179),o=a(92779),r=a(31030),i=a(48314),l=a(37745);function s(e,t=(0,l.gl)()){const a=function(e){try{const t=new Intl.ListFormat(e,{});return e=>t.format(e)}catch(t){return i.M.getInstance().logError({eventType:r.S.Localization,errorMessage:`Failed to create Intl.ListFormat for locale ${e}. ${t}`,logLevel:n.$b.Warning}),c}}(t);return a(e)}function c(e){const t=[...e];if(0===t.length)return"";if(1===t.length)return t[0];const a=t.pop(),n=o.xe2.And;return`${t.join(", ")} ${n} ${a}`}function d(e){if(e){return new Intl.DisplayNames([(0,l.gl)()],{type:"language"}).of(e)}}},73418:(e,t,a)=>{a.d(t,{sA:()=>i});var n=a(8520);function o(e,t,a){return e.split(t).map(((e,t)=>t%2==0?e:a(e,t))).filter((e=>null!==e&&""!==e))}function r(e,t){return function(e,t){const a=/\{(\d+)\}/,n=/\{(\w+)\}/;if(Array.isArray(t))return o(e,a,(e=>{const a=parseInt(e,10);return a>=0&&a<t.length?t[a]:`{${e}}`}));return o(e,n,(e=>e in t?t[e]:`{${e}}`))}(e,t)}const i=({message:e,values:t})=>n.createElement(n.Fragment,null,n.Children.toArray(r(e,t)))},58632:(e,t,a)=>{a.d(t,{T:()=>b,o:()=>f});var n=a(72483),o=a(35717),r=a(8069),i=a(88179),l=a(96854),s=a(31030),c=a(48314),d=a(46835),u=a(50347);const m=3e4,g=c.M.getInstance(),h=new Map,p=l.E.getInstance();async function b(e,t,a,l,s,c,p=m,b=void 0){try{const i=(0,o.p)();(0,d.debuglog)(`SENDING AWAITABLE SIGNAL: ${JSON.stringify(e)}`),(0,u.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse")?n.$.getInstance().submitOperation({operation:e,workflowAnnotationType:c}):t?.submitOperation(e);const m=setTimeout((()=>{C({id:a,body:{requestId:a,error:{errorCode:r.O.Timeout,errorMessage:`triggerSignalAndWaitForAnnotation Request timed out after ${p} ms. request id ${a}`,...b||{}}}},a)}),p);if(h.has(a))throw new Error(`triggerSignalAndWaitForAnnotation: requestId ${a} already exists`);return h.set(a,{deferredPromise:i,requestId:a,timeoutId:m,telemetryEventType:l,latencyOperation:s,startTime:performance.now()}),i.promise}catch(e){throw g.logError({eventType:l,errorMessage:`Error while submitting signal. requestID: ${a}, error: ${e}`,logLevel:i.$b.Error}),e}}function f(e,t){C(e,t)}function C(e,t){const a=h.get(t);if(a){const n=function(e,t){h.delete(e),clearTimeout(t.timeoutId);const a=performance.now()-t.startTime;return p.logLatency(a,t.latencyOperation),a}(t,a);e.body&&"error"in e.body&&e.body.error?a.deferredPromise.reject(e.body):a.deferredPromise.resolve(e.body),g.logEvent((0,i.P1)(a.telemetryEventType,{[i.pf.RequestId]:t,[i.pf.ExecutionTime]:n,[i.pf.Success]:!(e instanceof Error),[i.pf.Error]:e instanceof Error?e.message:""}))}else g.logError({eventType:s.S.Error,errorMessage:`Received annotation for unknown request ${t}`,logLevel:i.$b.Warning})}},98100:(e,t,a)=>{a.d(t,{Kv:()=>$,R3:()=>A,VY:()=>q,WF:()=>V,WS:()=>k,XZ:()=>U,Y6:()=>J,Yd:()=>P,Yp:()=>j,Z:()=>H,cY:()=>L,cn:()=>z,hU:()=>B,jZ:()=>_,m4:()=>Q,mm:()=>D,qW:()=>O,sZ:()=>G,uN:()=>F});var n=a(92779),o=a(89099),r=a(24220),i=a(77303),l=a(23147),s=a(64216),c=a(61437),d=a(64598),u=a(5550),m=a(29348),g=a(74487),h=a(41519),p=a(88179),b=a(47807),f=a(25433),C=a(48314),y=a(51319),v=a(61150),T=a(78735),x=a(50347),S=a(59367),w=a(6129),E=a(91519),R=a(37745),I=a(58651);const A=e=>{let t,a=e.length;for(;0!==a;)t=Math.floor(Math.random()*a),a--,[e[a],e[t]]=[e[t],e[a]];return e},L=(e,...t)=>{(0,v.K_)()&&I.log("Excel Copilot Chat Log:",e,...t)},F=(e,t)=>{if(e.json){const a=JSON.parse(e.json);switch(a.code){case"unsupported-multi-agent":return(0,n.CDl)();case"unknown":if((0,x.yw)("OfficeVSO_9257764_pythonStartAnalysisRAIMessage")&&"guardlist"===a.callReason&&l.CP.pythonContextManager.isStartAnalysisCard())return f.w.getInstance(t).handlePythonExitAnalysis(!1),(0,n.Dpi)()}}const a=(0,n.UuN)();let o=a;return(0,n.Ogc)().some((t=>((e.message===t.error||e.message.startsWith(t.error))&&(o=t.errorMessageUser),o!==a))),o},_=e=>N(e,(0,n.QEp)()),N=(e,t)=>(e=(e=e.replace(/[.,?!']/g,"")).toLowerCase(),t.some((t=>t===e))),k=(e,t)=>(e=(e=e.replace(/[.,?!']/g,"")).toLowerCase(),t.some((t=>e.includes(t)))),O=e=>{const t=[];return k(e,(0,n.J_P)())&&t.push(y.DH.Undo),k(e,(0,n.hAW)())&&t.push(y.DH.TableAltText),k(e,(0,n.inn)())&&t.push(y.DH.AddComment),k(e,(0,n.fOb)())&&t.push(y.DH.DataValidation),k(e,(0,n.fOb)())&&t.push(y.DH.CreatePivotTable),k(e,(0,n.VAP)())&&t.push(y.DH.DeleteWorksheets),t},P=e=>{switch(e){case"ChartVisual":return(0,n.zQo)()[0];case"PivotChartVisual":return(0,n.zQo)()[1];case"BlankPivotTable":case"PivotTableVisual":return(0,n.zQo)()[2];case"QueryResultVisual":return(0,n.zQo)()[3]}return null},M=async e=>{const t=()=>({webGroundingEnabled:(0,x.vI)()&&((0,x.iP)("Microsoft.Office.Excel.FA000000124.IsWebSearchDefaultOn",!0)||(0,w.gc)())&&!(0,x.kk)(),enterpriseGroundingEnabled:(0,w.pX)(),searchOnlyMode:!(0,x.vI)()&&(0,w.pX)()&&!(0,x.kk)(),requireExplicitPlugins:(0,x.vI)(),pluginInfo:e??[]});return(0,x._b)()?await(0,E.Eb)(t):{copilotConfig:t()}},D=async(e,t,a,o,r,l,s,m,g,h,p,b,f)=>{const C=o??c.Z.getInstance().getConversationId();L(`createInputSignalOperationBody: ${l}, ${JSON.stringify(s)}`);const y=(0,i.Hrz)(h),v=await e.getContextString(),S=g===T.r9?void 0:g;return new d.qO({query:t,queryId:a,gptId:(0,x.Pz)()?S:void 0,context:v,raw:n.MYv||(0,u.I_)(),fluxSkillOverride:r,config:{...await M(s),isToolboxEnabled:!!S,isInterstitialConfirmationEnabled:(0,x.dw)(),isInterstitialAuthenticationEnabled:(0,x.I3)()},queryAnnotations:l,conversationId:C,images:m,mentionedPlugins:y,isWarmUp:p,requestContinuation:b,clientUILanguageAndLocale:(0,x.yw)("OfficeVSO_9489298_SendTaskpaneUILocaleWithExcelInputSignal")?(0,R.gl)():void 0,userQueryLanguage:(0,x.yw)("OfficeVSO_9526211_SendUserQueryLanguageInInputSignal")?f:void 0})},$=async(e,t,a)=>{(0,v.cY)("Copy button clicked");try{e&&(await navigator.clipboard.write([e]),a&&C.M.getInstance().logEvent((0,p.Qf)(a)))}catch(e){(0,v.cY)("Error copying html to clipboard",e.message),C.M.getInstance().logError({eventType:t,errorMessage:"Error copying html to clipboard "+e.message,logLevel:p.$b.ASHA}),C.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_To_Copy_Response,p.BJ.CopilotChat)}};function B(e){return e.calculatedFormulas.length<=1}function H(e){return!e.insertRowTitle&&U(e)}function U(e){return B(e)&&void 0!==e.calculatedFormulas[0].insertionIndexes&&e.calculatedFormulas[0].insertionIndexes.length<=1}function q(e,t){return e.replaceAll(/\{(\w+)\}/g,((e,a)=>a in t?String(t[a]):`${a}`))}function V(e){if(e)try{const t=JSON.parse(e);if("TextAnalysisVisual"===t.visualType)return t.visual?.id}catch(e){L(`parse text analysis error: ${e}`)}}function G(){window.document.getElementById(n.OsU)?.style.setProperty("display","none")}function W(e,t){return t?g.BD.highContrast:e!==h.G.defaultWhite?g.BD.dark:g.BD.default}function z(){return new URL(b.dS).pathname}async function Q(e=h.G.defaultWhite,t=!1){if(!(0,x.kk)())return(0,S.z)();const a={locale:m.i.getHostAppDisplayLanguage(),sessionId:u.Vv.getSettingAsString(u.zj.AugloopSharedSessionID),physicalRing:(0,u.I_)()?"Dogfood":"Prod",clientType:m.i.isWebPlatform()?g.WK.web:g.WK.desktop,hubName:g.UH.office,theme:W(e,t),redirectUri:z(),clientId:i.qAn,aadUserId:"",userName:"",userPrincipalName:""};let n="",o="";try{const e=new Promise((e=>Office.context.auth.getAuthContextAsync(e))),t=await e;if("succeeded"===t.status){const e=t.value;n=e.userObjectId,o=e.userPrincipalName}else L("Failed to fetch user id from OfficeJS")}catch(e){return L("Error getting user info: "+e),a}return{...a,aadUserId:o,userName:n,userPrincipalName:o}}function J(){return!s.s.getInstance().isWaitingForStreamEnd()}function j(e,t=35){const a="...";return e?.length>t-3?e.substring(0,t-3)+a:e}},93772:(e,t,a)=>{a.d(t,{LN:()=>y,N6:()=>v,NX:()=>n,Xw:()=>r,Zi:()=>o,mh:()=>T,uo:()=>i});var n,o,r,i,l=a(92779),s=a(74511),c=a(88179),d=a(31030),u=a(48314),m=a(57120),g=a(50347),h=a(37542).hp;let p;!function(e){e.ModalDialog="ModalDialog",e.Taskpane="Taskpane"}(n||(n={})),function(e){e.Like="Like",e.Dislike="Dislike",e.Idea="Idea",e.Unclassified="Unclassified"}(o||(o={})),function(e){e.CHATEXCEL="Copilot",e.ANALYZEDATA="Copilot\\Analyze Data",e.FORMULAGENERATION="Copilot\\Formula Generation",e.COMMANDING="Copilot\\Commanding",e.COMMANDINGCFSUGGESTIONS="Copilot\\Commanding CF Suggestions",e.COMMANDINGCONDITIONALFORMATTING="Copilot\\Commanding Conditional Formatting",e.OFFICESCRIPTS="Copilot\\Office Scripts",e.INSERTTABLE="Copilot\\Insert Table",e.PYTHON="Copilot\\Python",e.PYTHONCALCULATEDCOLUMNS="Copilot\\Python Calculated Columns",e.CHATSEARCH="Copilot\\Search",e.DATASHAPING="Copilot\\Data Shaping",e.SELFHELPSEARCH="Copilot\\SelfHelpSearch",e.ELSE="Copilot\\Else",e.IMPORTDATA="Copilot\\Import Data",e.CONTEXT="Copilot\\Context Inference"}(r||(r={})),function(e){e.AIThumbsDown="AIThumbsDown",e.AIThumbsUp="AIThumbsUp"}(i||(i={}));const b=()=>{p=document.activeElement},f=()=>{setTimeout((()=>{p instanceof HTMLElement&&p.focus()}),2e3)},C=e=>{if(!(0,g.RE)()||!e.length)return;let t="";const a=s.i.GetHostAppPlatform();switch(a){case Office.PlatformType.PC:t="XLWin32";break;case Office.PlatformType.Mac:t="XLMac";break;case Office.PlatformType.iOS:t="XLiOS";break;case Office.PlatformType.OfficeOnline:t="XLWeb";break;default:return void u.M.getInstance().logError({eventType:d.S.ChatEvents,errorMessage:`Unknown Host Platform Type: ${a}`,logLevel:c.$b.Error})}(0,m.W)(e,t)},y=async()=>{await OfficeFirstParty.UserFeedback.onUserFeedbackResponse(C),await OfficeFirstParty.UserFeedback.onUserFeedbackUIDismissed(f)};function v(e,t,a,n){b();const o=(0,g.RE)()?a+l.tSR:a;OfficeFirstParty.UserFeedback.CollectUserFeedback(e,t,o,n)}const T=(e,t)=>{const a={},n={},o={isScenarioEnabled:!1,question:{questionUIType:"DropDown",questionInstruction:{displayedString:" ",displayedStringInEnglish:" "},questionOptions:[{displayedString:" ",displayedStringInEnglish:" "}]}};if(t&&(o.isScenarioEnabled=!0,o.scenarioType=t),e){const t={fileType:"text/plain; charset=utf-8",fileName:"contextData.txt",base64Data:h.from(JSON.stringify(e),"utf8").toString("base64")};n.contextDataFiles=[t]}return n.scenarioConfig=o,(0,g.RE)()&&(n.isEmailCollectionEnabled=l.Mgi.true,n.isFileUploadEnabled=l.Mgi.true,n.isScreenshotEnabled=l.Mgi.true,n.isScreenRecordingEnabled=l.Mgi.true,n.isHostManagedContextDataEnabled=l.Mgi.true,n.hostManagedContextDataExplanationUrl=l.Lvp,n.isRetrieveFormDataEnabled=l.Mgi.true),a.v2Config=n,a}},74840:(e,t,a)=>{a.d(t,{eW:()=>u,hC:()=>n,nK:()=>d});var n,o=a(82623),r=a(88179),i=a(72842),l=a(23147),s=a(50347);!function(e){e.Commanding_Suggestion="Commanding_Suggestion",e.Commanding_TellMe="Commanding_TellMe",e.CalculatedColumns_GeneralSuggestion="CalculatedColumns_GeneralSuggestion",e.CalculatedColumns_ShowMore="CalculatedColumns_ShowMore",e.CalculatedColumns_SpecificSuggestion="CalculatedColumns_SpecificSuggestion",e.AnalyzeData_Suggestion="AnalyzeData_Suggestion",e.AnalyzeData_SpecificSuggestion="AnalyzeData_SpecificSuggestion",e.AnalyzeData_InsertAll="AnalyzeData_InsertAll",e.AnalyzeData_InsertAllCharts="AnalyzeData_InsertAllCharts",e.AnalyzeData_ShowMore="AnalyzeData_ShowMore",e.AnalyzeData_ShowCharts="AnalyzeData_ShowCharts",e.AnalyzeData_ShowMoreCharts="AnalyzeData_ShowMoreCharts",e.AnalyzeData_ShowPivotTables="AnalyzeData_ShowPivotTables",e.AnalyzeData_ShowMorePivotTables="AnalyzeData_ShowMorePivotTables",e.AnalyzeData_RelatedQuestions="AnalyzeData_RelatedQuestions",e.MorePrompts="MorePrompts",e.GiveMeMorePrompts="GiveMeMorePrompts",e.ImportDataFromFile="ImportDataFromFile",e.SydneySuggestion="SydneySuggestion",e.CalculatedCell_Suggestion="CalculatedCell_Suggestion",e.PythonSuggestion="Python_Suggestion",e.ConditionalFormat_Suggestion="ConditionalFormat_Suggestion",e.TlrExplainTables="Tlr_ExplainTables",e.TlrExplainHeaders="Tlr_ExplainHeaders",e.TlrExplainUnmergingCells="Tlr_ExplainUnmergingCells"}(n||(n={}));const c=["Commanding_TellMe","MorePrompts","GiveMeMorePrompts","SydneySuggestion","ImportDataFromFile","Tlr_ExplainHeaders","Tlr_ExplainTables","Tlr_ExplainUnmergingCells"];function d(e,t=!1,a=()=>{},n,r){const i=r?.tableLikeRangeFeatures&&r.tableLikeRangeFeatures&o.ye.All,d=(0,s.tg)()&&i;if(!(0,s.QE)()&&n||d)(0,s.yw)("OfficeVSO_9258430_AlwaysShowPythonSuggestionPills")&&l.CP.pythonContextManager.isPythonMode||("CHART_SELECTED"===n||"PIVOT_TABLE_SELECTED"===n?(e=[],t=!1):e=e.filter((e=>c.includes(e.suggestionType))));else if(!i&&(0,s.yw)("OfficeVSO_9413795_updateUnsupportedTLRSuggestionPills")){const t=["Tlr_ExplainHeaders","Tlr_ExplainTables","Tlr_ExplainUnmergingCells"];e=e.filter((e=>!t.includes(e.suggestionType)))}return{onRefreshButtonClicked:a,suggestionList:e.map((e=>e.suggestionText)),showRefreshButton:t}}function u(e){switch(e){case"AnalyzeData_InsertAll":case"AnalyzeData_InsertAllCharts":case"AnalyzeData_ShowMore":case"AnalyzeData_SpecificSuggestion":case"AnalyzeData_Suggestion":case"AnalyzeData_ShowCharts":case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowPivotTables":case"AnalyzeData_ShowMorePivotTables":case"AnalyzeData_RelatedQuestions":return r.q.AnalyzeData;case"CalculatedColumns_GeneralSuggestion":case"CalculatedColumns_ShowMore":case"CalculatedColumns_SpecificSuggestion":return r.q.CalculatedColumns;case"CalculatedCell_Suggestion":return r.q.CalculatedRows;case"Commanding_Suggestion":case"Commanding_TellMe":case"ConditionalFormat_Suggestion":return r.q.Commanding;case"Python_Suggestion":return r.q.Python;case"Tlr_ExplainTables":case"Tlr_ExplainHeaders":case"Tlr_ExplainUnmergingCells":return r.q.ContextInference;case"GiveMeMorePrompts":case"ImportDataFromFile":case"MorePrompts":case"SydneySuggestion":return;default:(0,i.x)(e)}}},38924:(e,t,a)=>{a.d(t,{eD:()=>S,dW:()=>x,uC:()=>A,_2:()=>I});var n=a(92779),o=a(67603),r=a(13944),i=a(64934),l=a(79689),s=a(88700),c=a(29328),d=a(57871),u=a(45857),m=a(25083),g=a(95653),h=a(78226),p=a(9178),b=a(92936),f=a(85023);const C={[o.fM.Insights]:r.uJg,[o.fM.FormulaAction]:i.vfO,[o.fM.HighlightAction]:i.RIf,[o.fM.Search]:l.CDg,[o.fM.Python]:s.Yuv,[o.fM.HowToSum]:l.CDg,[o.fM.DataPreparation]:i.RIf,[o.Ki.SuggestColumn]:s.pZh,[o.Ki.WriteFormula]:i.RIf,[o.Ki.AddFormulaColumn]:c.Y8t,[o.Ki.ExplainFormula]:d.rof,[o.Ki.InvestigateError]:u.TRI,[o.Ki.SplitColumns]:s.hX8,[o.Ki.CombineColumns]:s.CMb,[o.Ki.TotalRow]:m.Kdk,[o.Ki.LookupFormula]:m.Vz1,[o.Oc.GetDataInsights]:s.zJX,[o.Oc.AdvancedAnalysis]:s.Yuv,[o.Oc.PerformForecasting]:s.vS8,[o.Oc.CreateBoxplot]:s.O11,[o.Oc.SetOfCharts]:g.NOv,[o.Oc.GenerateWordCloud]:s.VJB,[o.Tz.CreateTable]:h.X_q,[o.Tz.KeyboardShortcuts]:r.YWy,[o.Tz.TipsAndTricks]:p.lHS,[o.Tz.FreezeColumn]:m.NFJ,[o.Tz.HowToUnpivot]:l.CDg,[o.Tz.HowToCreateDropdown]:l.CDg,[o.Tz.HowToWriteFormula]:l.CDg,[o.iT.SummarizeColumn]:m.QXr,[o.iT.ShowDataInsights]:s.SZA,[o.iT.SumByCategory]:s.nFp,[o.iT.CreatePivotTable]:b.pnR,[o.iT.CreatePieChart]:s.BGz,[o.iT.GenerateGraph]:l.XQT,[o.iT.HighlightDuplicates]:g.jEr,[o.iT.HighlightCells]:g.jEr,[o.iT.ApplyColorCoding]:f.fFI,[o.YA.WebSearchCreateTable]:m.Vz1,[o.YA.WebSearchTravel]:c.BYt,[o.YA.WebSearchLearn]:m.ITY,[o.YA.ImportTable]:s.kMD,[o.YA.PrepareForMeetings]:f.vmL};var y=a(50347),v=a(6129),T=a(46224);const x=()=>({[o.fM.FormulaAction]:(0,n.$dh)(),[o.fM.Insights]:(0,n.zp5)(),[o.fM.Python]:(0,n.ONP)(),[o.fM.HighlightAction]:(0,n.jI0)(),[o.fM.Search]:(0,n.IZv)(),[o.fM.HowToSum]:(0,n.Ghz)(),[o.fM.DataPreparation]:(0,n.On3)()}),S=()=>({...x(),[o.X6.SuggestColumn]:(0,n.VG_)(),[o.X6.WriteFormula]:(0,n.K0f)(),[o.X6.AddFormulaColumn]:(0,n.ztP)(),[o.X6.ExplainFormula]:(0,n.qAx)(),[o.X6.InvestigateError]:(0,n.C_C)(),[o.X6.SplitColumns]:(0,n._zy)(),[o.X6.CombineColumns]:(0,n.Z3U)(),[o.X6.TotalRow]:(0,n.KtU)(),[o.X6.LookupFormula]:(0,n.f00)(),[o.X6.GetDataInsights]:(0,n.N_T)(),[o.X6.AdvancedAnalysis]:(0,n.Bzb)(),[o.X6.PerformForecasting]:(0,n.xf7)(),[o.X6.CreateBoxplot]:(0,n.pKA)(),[o.X6.SetOfCharts]:(0,n.YYh)(),[o.X6.GenerateWordCloud]:(0,n.Coj)(),[o.X6.CreateTable]:(0,n.BhF)(),[o.X6.KeyboardShortcuts]:(0,n.hCI)(),[o.X6.TipsAndTricks]:(0,n.DqS)(),[o.X6.FreezeColumn]:(0,n.U7J)(),[o.X6.HowToUnpivot]:(0,n._Gb)(),[o.X6.HowToCreateDropdown]:(0,n._ok)(),[o.X6.HowToWriteFormula]:(0,n.bkj)(),[o.X6.SummarizeColumn]:(0,n.kvY)(),[o.X6.ShowDataInsights]:(0,n.WNU)(),[o.X6.SumByCategory]:(0,n.Avw)(),[o.X6.CreatePivotTable]:(0,n.QHr)(),[o.X6.CreatePieChart]:(0,n.wwj)(),[o.X6.GenerateGraph]:(0,n.esl)(),[o.X6.HighlightDuplicates]:(0,n.fsn)(),[o.X6.HighlightCells]:(0,n.aW0)(),[o.X6.ApplyColorCoding]:(0,n.bgS)(),[o.X6.WebSearchCreateTable]:(0,n.rnM)(),[o.X6.WebSearchTravel]:(0,n.oKV)(),[o.X6.WebSearchLearn]:(0,n._xk)(),[o.X6.ImportTable]:(0,n._BM)(),[o.X6.PrepareForMeetings]:(0,n.ST4)()});function w(){return{[o.fM.Insights]:n.hn.menuSectionUnderstand(),[o.fM.FormulaAction]:n.hn.menuSectionCreate(),[o.fM.HighlightAction]:n.hn.menuSectionEdit(),[o.fM.Search]:(0,n._JR)(),[o.fM.Python]:(0,n.vNK)(),[o.fM.HowToSum]:(0,n._JR)(),[o.fM.DataPreparation]:(0,n.lun)(),[o.X6.SuggestColumn]:(0,n.UXx)(),[o.X6.WriteFormula]:(0,n.ptM)(),[o.X6.AddFormulaColumn]:(0,n.KsV)(),[o.X6.ExplainFormula]:(0,n.no)(),[o.X6.InvestigateError]:(0,n.$OL)(),[o.X6.SplitColumns]:(0,n.xOV)(),[o.X6.CombineColumns]:(0,n.KHB)(),[o.X6.TotalRow]:(0,n.nHd)(),[o.X6.LookupFormula]:(0,n.itS)(),[o.X6.GetDataInsights]:(0,n.I1u)(),[o.X6.AdvancedAnalysis]:(0,n.Oz3)(),[o.X6.PerformForecasting]:(0,n.sqX)(),[o.X6.CreateBoxplot]:(0,n.E9A)(),[o.X6.SetOfCharts]:(0,n.xMZ)(),[o.X6.GenerateWordCloud]:(0,n.D8x)(),[o.X6.CreateTable]:(0,n.ixU)(),[o.X6.KeyboardShortcuts]:(0,n.wvv)(),[o.X6.TipsAndTricks]:(0,n.qhm)(),[o.X6.FreezeColumn]:(0,n.RV1)(),[o.X6.HowToUnpivot]:(0,n.Z2X)(),[o.X6.HowToCreateDropdown]:(0,n.Z2X)(),[o.X6.HowToWriteFormula]:(0,n.Z2X)(),[o.X6.SummarizeColumn]:(0,n.XAy)(),[o.X6.ShowDataInsights]:(0,n.NyX)(),[o.X6.SumByCategory]:(0,n.dNS)(),[o.X6.CreatePivotTable]:(0,n.D02)(),[o.X6.CreatePieChart]:(0,n.BIf)(),[o.X6.GenerateGraph]:(0,n.roM)(),[o.X6.HighlightDuplicates]:(0,n._pS)(),[o.X6.HighlightCells]:(0,n.lFW)(),[o.X6.ApplyColorCoding]:(0,n.gsW)(),[o.X6.WebSearchCreateTable]:(0,n.Qhk)(),[o.X6.WebSearchTravel]:(0,n.da$)(),[o.X6.WebSearchLearn]:(0,n.r3R)(),[o.X6.ImportTable]:(0,n.nby)(),[o.X6.PrepareForMeetings]:(0,n.vJt)()}}function E(){return{[o.fM.Insights]:!0,[o.fM.FormulaAction]:!0,[o.fM.HighlightAction]:!1,[o.fM.Search]:!1,[o.fM.Python]:!0,[o.fM.HowToSum]:!1,[o.fM.DataPreparation]:!0,[o.X6.SuggestColumn]:!0,[o.X6.WriteFormula]:!1,[o.X6.AddFormulaColumn]:!1,[o.X6.ExplainFormula]:!1,[o.X6.InvestigateError]:!1,[o.X6.SplitColumns]:!1,[o.X6.CombineColumns]:!1,[o.X6.TotalRow]:!1,[o.X6.LookupFormula]:!1,[o.X6.GetDataInsights]:!0,[o.X6.AdvancedAnalysis]:!0,[o.X6.PerformForecasting]:!1,[o.X6.CreateBoxplot]:!0,[o.X6.SetOfCharts]:!0,[o.X6.GenerateWordCloud]:!0,[o.X6.CreateTable]:!0,[o.X6.KeyboardShortcuts]:!0,[o.X6.TipsAndTricks]:!0,[o.X6.FreezeColumn]:!0,[o.X6.HowToUnpivot]:!0,[o.X6.HowToCreateDropdown]:!0,[o.X6.HowToWriteFormula]:!1,[o.X6.SummarizeColumn]:!1,[o.X6.ShowDataInsights]:!0,[o.X6.SumByCategory]:!1,[o.X6.CreatePivotTable]:!1,[o.X6.CreatePieChart]:!0,[o.X6.GenerateGraph]:!1,[o.X6.HighlightDuplicates]:!1,[o.X6.HighlightCells]:!1,[o.X6.ApplyColorCoding]:!1,[o.X6.WebSearchCreateTable]:!0,[o.X6.WebSearchTravel]:!0,[o.X6.WebSearchLearn]:!0,[o.X6.ImportTable]:!1,[o.X6.PrepareForMeetings]:!0}}const R={[o.fM.Search]:()=>(0,v.pX)(),[o.fM.Python]:()=>(0,y.H2)()&&(0,T.gx)(),[o.fM.DataPreparation]:()=>(0,y.eF)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableDataPreparationZQM",!1),[o.fM.HowToSum]:()=>(0,y.Qy)(),[o.X6.GetDataInsights]:()=>(0,y.H2)()&&(0,T.gx)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableGetDataInsightsRotatingZQM",!1),[o.X6.AdvancedAnalysis]:()=>(0,y.H2)()&&(0,T.gx)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableAdvancedAnalysisRotatingZQM",!1),[o.X6.PerformForecasting]:()=>(0,y.H2)()&&(0,T.gx)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisablePerformForecastingRotatingZQM",!1),[o.X6.CreateBoxplot]:()=>(0,y.H2)()&&(0,T.gx)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableCreateBoxplotRotatingZQM",!1),[o.X6.SetOfCharts]:()=>(0,y.H2)()&&(0,T.gx)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableSetOfChartsRotatingZQM",!1),[o.X6.GenerateWordCloud]:()=>(0,y.H2)()&&(0,T.gx)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableGenerateWordCloudRotatingZQM",!1),[o.X6.CreateTable]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableCreateTableRotatingZQM",!1),[o.X6.KeyboardShortcuts]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableKeyboardShortcutsRotatingZQM",!1),[o.X6.TipsAndTricks]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableTipsAndTricksRotatingZQM",!1),[o.X6.FreezeColumn]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableFreezeColumnRotatingZQM",!1),[o.X6.HowToUnpivot]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableHowToUnpivotRotatingZQM",!1),[o.X6.HowToCreateDropdown]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableHowToCreateDropdownRotatingZQM",!1),[o.X6.WriteFormula]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableWriteFormulaRotatingZQM",!1),[o.X6.SummarizeColumn]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableSummarizeColumnRotatingZQM",!1),[o.X6.ShowDataInsights]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableShowDataInsightsRotatingZQM",!1),[o.X6.SumByCategory]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableSumByCategoryRotatingZQM",!1),[o.X6.CreatePivotTable]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableCreatePivotTableRotatingZQM",!1),[o.X6.CreatePieChart]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableCreatePieChartRotatingZQM",!1),[o.X6.GenerateGraph]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableGenerateGraphRotatingZQM",!1),[o.X6.HighlightDuplicates]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableHighlightDuplicatesRotatingZQM",!1),[o.X6.HighlightCells]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableHighlightCellsRotatingZQM",!1),[o.X6.ApplyColorCoding]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableApplyColorCodingRotatingZQM",!1),[o.X6.SuggestColumn]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableSuggestColumnRotatingZQM",!1),[o.X6.AddFormulaColumn]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableAddFormulaColumnRotatingZQM",!1),[o.X6.ExplainFormula]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableExplainFormulaRotatingZQM",!1),[o.X6.InvestigateError]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableInvestigateErrorRotatingZQM",!1),[o.X6.SplitColumns]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableSplitColumnsRotatingZQM",!1),[o.X6.CombineColumns]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableCombineColumnsRotatingZQM",!1),[o.X6.TotalRow]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableTotalRowRotatingZQM",!1),[o.X6.LookupFormula]:()=>!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableLookupFormulaRotatingZQM",!1),[o.X6.WebSearchCreateTable]:()=>(0,v.gc)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableWebSearchCreateTableRotatingZQM",!1),[o.X6.WebSearchTravel]:()=>(0,v.gc)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableWebSearchTravelRotatingZQM",!1),[o.X6.WebSearchLearn]:()=>(0,v.gc)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableWebSearchLearnRotatingZQM",!1),[o.X6.ImportTable]:()=>(0,v.pX)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisableImportTableRotatingZQM",!1),[o.X6.PrepareForMeetings]:()=>(0,v.pX)()&&!(0,y.iP)("Microsoft.Office.Excel.FA000000124.DisablePrepareForMeetingsRotatingZQM",!1)};function I(e){return(R[e]??(()=>!0))()}function A({disableButtons:e=!1},t=[],a=()=>{}){const n=(0,y.GK)();if(t.length>0&&n){return{promptSuggestionList:t.filter((e=>I(e))).map((t=>({suggestionText:S()[t],suggestionCategory:w()[t],iconRegular:C[t],isDisabled:e,shouldSubmitQueryOnClick:E()[t]}))),showRefreshButton:n,handleRefreshButtonClick:a}}return{promptSuggestionList:Object.entries(x()).filter((([e,t])=>I(e))).map((([t,a])=>({suggestionText:a,suggestionCategory:w()[t],iconRegular:C[t],isDisabled:e,shouldSubmitQueryOnClick:E()[t]}))),showRefreshButton:!1,handleRefreshButtonClick:a}}},67603:(e,t,a)=>{var n,o,r,i,l,s;a.d(t,{Ki:()=>o,Oc:()=>r,Tz:()=>i,X6:()=>d,YA:()=>s,fM:()=>n,iT:()=>l,w_:()=>c}),function(e){e.Insights="Insights",e.FormulaAction="FormulaAction",e.HighlightAction="HighlightAction",e.Search="Search",e.Python="Python",e.HowToSum="HowToSum",e.DataPreparation="DataPreparation"}(n||(n={})),function(e){e.SuggestColumn="SuggestColumn",e.WriteFormula="WriteFormula",e.AddFormulaColumn="AddFormulaColumn",e.ExplainFormula="ExplainFormula",e.InvestigateError="InvestigateError",e.SplitColumns="SplitColumns",e.CombineColumns="CombineColumns",e.TotalRow="TotalRow",e.LookupFormula="LookupFormula"}(o||(o={})),function(e){e.GetDataInsights="GetDataInsights",e.AdvancedAnalysis="AdvancedAnalysis",e.PerformForecasting="PerformForecasting",e.CreateBoxplot="CreateBoxplot",e.SetOfCharts="SetOfCharts",e.GenerateWordCloud="GenerateWordCloud"}(r||(r={})),function(e){e.CreateTable="CreateTable",e.KeyboardShortcuts="KeyboardShortcuts",e.TipsAndTricks="TipsAndTricks",e.FreezeColumn="FreezeColumn",e.HowToUnpivot="HowToUnpivot",e.HowToCreateDropdown="HowToCreateDropdown",e.HowToWriteFormula="HowToWriteFormula",e.DataPreparation="DataPreparation"}(i||(i={})),function(e){e.SummarizeColumn="SummarizeColumn",e.ShowDataInsights="ShowDataInsights",e.SumByCategory="SumByCategory",e.CreatePivotTable="CreatePivotTable",e.CreatePieChart="CreatePieChart",e.GenerateGraph="GenerateGraph",e.HighlightDuplicates="HighlightDuplicates",e.HighlightCells="HighlightCells",e.ApplyColorCoding="ApplyColorCoding"}(l||(l={})),function(e){e.WebSearchCreateTable="WebSearchCreateTable",e.WebSearchTravel="WebSearchTravel",e.WebSearchLearn="WebSearchLearn",e.ImportTable="ImportTable",e.PrepareForMeetings="PrepareForMeetings"}(s||(s={}));const c={...o,...r,...i,...l,...s},d={...n,...c}},15835:(e,t,a)=>{a.r(t);var n=a(8520),o=a(94329),r=a(77303),i=a(19234),l=a(24557),s=a(86122),c=a(82794),d=a(88179),u=a(31030),m=a(48314);Office.onReady((async()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,(e=>{let t;try{t=JSON.parse(e.message)}catch(e){m.M.getInstance().logError({eventType:u.S.ChatEvents,errorMessage:"CloudFilePickerEntryPoint: Failed to parse message from parent: "+e,logLevel:d.$b.Error}),t={}}o.render(n.createElement(l.q,{theme:t.isDarkMode?s.C:c.o},n.createElement(i.n,{userPrincipalName:t.userPrincipalName??"",clientId:t.clientId??"",redirectUri:t.redirectUri??"",locale:t.locale??"",appName:"Excel",onItemSelected:e=>{const t={type:r.zgk.OnItemSelected,files:e};Office.context.ui.messageParent(JSON.stringify(t))},onDismissDialog:()=>{const e={type:r.zgk.CloseEvent};Office.context.ui.messageParent(JSON.stringify(e))},onErrorInLoading:()=>{const e={type:r.zgk.OnErrorInLoading};Office.context.ui.messageParent(JSON.stringify(e))},theme:t.isDarkMode?"dark":"default"})),document.getElementById("cloud-file-picker-container"))})),Office.context.ui.messageParent(JSON.stringify({type:r.zgk.Ack}))}))},96710:(e,t,a)=>{var n;a.d(t,{D:()=>n,J:()=>o}),function(e){e[e.None=0]="None",e[e.CellValue=1]="CellValue",e[e.ColorScale=2]="ColorScale",e[e.DataBar=3]="DataBar",e[e.IconSet=4]="IconSet",e[e.Preset=5]="Preset",e[e.TopBottom=6]="TopBottom",e[e.CustomCreated=7]="CustomCreated",e[e.Dates=8]="Dates",e[e.UniqueValue=9]="UniqueValue",e[e.TextComparison=10]="TextComparison"}(n||(n={}));class o{constructor(e=0,t,a,n,o,r,i){this.cardTitle=e,this.iconSetNumber=t,this.originalHexColors=a,this.customFormula=n,this.formulaExplanation=o,this.customFormat=r,this.dataBarFormat=i}}},52983:(e,t,a)=>{a.d(t,{i:()=>x});var n=a(658),o=a(47691),r=a(98817),i=a(33789),l=a(18475),s=a(63644),c=a(8520);const d=({title:e,duration:t,trigger:a,withArrow:n})=>{const[o,r]=function(e){const[t,a]=(0,c.useState)(!1),n=(0,c.useRef)(void 0);return(0,c.useEffect)((()=>{if(t)return u(n),n.current=window.setTimeout((()=>{a(!1),u(n)}),e),()=>u(n)}),[t]),[t,a]}(t);return c.createElement(i.A,{withArrow:n,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:o,onOpenChange:(e,{open:t})=>{r(t)}},c.createElement(l.W,null,a),c.createElement(s.H,{"aria-live":"assertive"},e))};function u(e){e.current&&(clearTimeout(e.current),e.current=void 0)}var m=a(35571),g=a(88700),h=a(77609),p=a(92779),b=a(31030),f=a(98100),C=a(50751),y=a(94836);const v=(0,m.A)(g.cAv,g.c2D),T=(0,n.n)({iconContainer:{[`&:hover .${h.ru}`]:{color:C.k1.themePrimary}}});function x({getClipboardItem:e,telemetryUsageData:t,ariaLabelSuffix:a}){const[n,i]=(0,c.useState)(null),l=!(0,y.dD)(),s=T();(0,c.useEffect)((()=>{(async()=>{const t=await e();i(t)})()}),[e]);const u=c.createElement(o.$,{size:"small",appearance:"transparent",icon:c.createElement(v,null),className:s.iconContainer,"aria-expanded":void 0,onClick:()=>(0,f.Kv)(n,b.S.Error,t)});return c.createElement(d,{duration:3e3,title:p.xxz.CopyButtonPopover,trigger:l?c.createElement(r.m,{content:p.xxz.CopyButtonLabel+(a?" "+a:""),relationship:"label"},u):u})}},80132:(e,t,a)=>{a.d(t,{J3:()=>Ba,IM:()=>Ua,Av:()=>qa});a(97700);var n,o=a(27409),r=a(79490),i=a(23440);!function(e){e.Cycle="Cycle"}(n||(n={}));class l{getExtensions(e){l.get(this.extensionsUrl,e)}getResource(e,t,a){t===i.IvyRenderer.Image?this.getImage(e,a):this.getJson(e,a)}getImage(e,t){this.callPost("image/png",e,t)}getJson(e,t){this.callPost("application/json",e,t)}callPost(e,t,a){const n={chartSettings:t,colorizer:this.colorizer};l.post(this.layoutUrl,e,n,a)}static post(e,t,a,n){const o=new XMLHttpRequest;o.open("POST",e),o.setRequestHeader("Accept",t),o.setRequestHeader("Content-Type","text/plain"),o.send(JSON.stringify(a)),l.completeAjax(o,l.callbackWrapper(n))}static callbackWrapper(e){return function(...t){e.apply(this,[t[0],{chartResource:t[1]}])}}static get(e,t){const a=new XMLHttpRequest;a.open("GET",e),a.send(null),l.completeAjax(a,t)}static completeAjax(e,t){e.onreadystatechange=()=>{e.readyState===XMLHttpRequest.DONE&&(200===e.status?t(null,JSON.parse(e.responseText)):t(`Edera RequestFailed StatusCode: ${e.status}`,null))}}constructor(e,t){this.extensionsUrl=e.extensionsUrl??`${e.base}/charts/extensions?clientId=${e.clientId}`,this.layoutUrl=e.layoutUrl??`${e.base}/charts/layout?clientId=${e.clientId}`,this.colorizer=t}}var s=a(81364),c=a(88179),d=a(31030),u=a(48314),m=a(88099),g=a(72355);class h extends o.CardElement{get definition(){return this.getValue(h.definitionProperty)}set definition(e){this.definition!==e&&(this.setValue(h.definitionProperty,e),this.updateLayout())}internalRender(){return this.chartElement=document.createElement("div"),this.chartElement.className="chart",this.setupChartHost(),this.resizeObserver=new ResizeObserver((0,m.debounce)((([e])=>{e&&this.onChartChange()}),1e3)),this.resizeObserver.observe(this.chartElement),this.chartElement}getJsonTypeName(){return h.JsonTypeName}updateLayout(e=!0){super.updateLayout(e),this.renderedElement&&this.layoutChart()}setupChartHost(){const e={base:`${(0,g.wF)()}/v3.0`,clientId:(0,g.fp)()},t={disableChartElementResize:!1,renderer:i.IvyRenderer.Svg},a={type:n.Cycle};this.host=new i.ChartHost(new l(e,a),t,this.chartElement),this.host.on("error",((e,t)=>{u.M.getInstance().logErrorCode(s.O.IvyWebFailure,new Error(t),d.S.AnalyzeDataError,c.$b.ASHA)}))}layoutChart(){if(this.definition){const e=JSON.parse(this.definition),t=.5,a=this.chartElement.clientWidth,n=a*t;e.size={width:a,height:n},this.host?.setConfiguration(e)}}onChartChange(){this.layoutChart()}}h.JsonTypeName="Chart",h.definitionProperty=new o.StringProperty(o.Versions.v1_0,"definition",!1),(0,r.__decorate)([(0,o.property)(h.definitionProperty)],h.prototype,"definition",null);var p=a(38405),b=a(8520);function f({requestId:e,adaptiveCardDefinition:t}){const a=new o.CardObjectRegistry;o.GlobalRegistry.populateWithDefaultElements(a),a.register(h.JsonTypeName,h);const n=new o.SerializationContext;n.setElementRegistry(a);const r=new o.AdaptiveCard;r.hostConfig=new o.HostConfig({fontFamily:"Segoe UI, Helvetica Neue, sans-serif"}),r.parse(t,n);const i=r.render(),l=b.createElement(C,{element:i});return b.createElement(p.lJ,{contentBody:l,cardButtons:void 0,requestId:e})}const C=({element:e})=>{const t=b.useRef();return b.useEffect((()=>(e&&t.current&&t.current.appendChild(e),()=>{e&&t.current&&t.current.removeChild(e)})),[e]),b.createElement("span",{ref:t})};var y=a(72587),v=a(7616),T=a(92779),x=a(54738),S=a(10211),w=a(50751),E=a(92782),R=a(658);const I=(0,E.Q)(w.eL),A={cardStack:{"& > :first-child":{marginBottom:"2px"},backgroundColor:I.neutralLight,color:I.neutralDark},bulletList:{marginTop:"0px",paddingLeft:"25px"},bulletListHeader:{marginBottom:"4px"}},L=(0,R.n)(A);function F(e){return b.createElement(p.lJ,{contentBody:function(){const e=L();return b.createElement(x.B,{className:e.cardStack},b.createElement(S.E,null,(0,T.i3R)()),b.createElement(S.E,null,(0,T.pF5)()))}(),requestId:e.requestId,cardButtons:[]})}var _=a(58295),N=a(89099),k=a(24220),O=a(91836),P=a(50280),M=a(94709),D=a(30112),$=a(43371),B=a(92716),H=a(96854),U=a(83349);const q=(0,R.n)({description:{...O.g.body1,"& > p:first-child":{marginTop:0}}});function V({id:e,suggestionId:t,title:a,formula:n,explanation:o,description:r,role:i,onFirstTimeExplanationShown:l,loadingTimeouts:s,icon:d}){const u=(0,P.Bi)("formula-title-"),m=q(),g=G(`explanation[${e}]`,Boolean(o),s.explanation,N.c.Formula_Explanation_Failed_To_Display,c.OP.FormulaExplanationAvailable),h=G(`description[${e}]`,Boolean(r),s.description,N.c.Formula_Description_Failed_To_Display,c.OP.FormulaDescriptionAvailable);return b.createElement(x.B,{role:i,tokens:{childrenGap:8},"aria-labelledby":u},a&&b.createElement(M.V,{id:u,role:"heading","aria-level":2,"data-testid":"formula-title"},a),b.createElement($.u,{text:function(e){switch(h){case"loading":return;case"timeout":return T.xe2.FormulaSuggestion_Description_NotAvailable;default:return e}}(r),className:(0,D.z)(m.description,"formula-description")}),b.createElement(B.$,{icon:d??"math",content:n,explanation:{explanation:o,isLoading:"loading"===g,isNotAvailable:"timeout"===g,onFirstTimeExplanationShown:l},telemetryUsageFeatureName:c.q.CalculatedColumns,suggestionId:t,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([n],{type:"text/plain"})}),ariaAttributes:{"aria-label":T.xe2.FormulaSuggestion_FormulaSnippet_AriaLabel}}))}function G(e,t,a,n,o){return(0,U.rK)(e,t,a,{onTimeout(){u.M.userQueryGuid&&u.M.getInstance().logStandardizedAshaErrorEvent(k.W.UI_Failed_To_Update_Or_Load,n,c.BJ.FormulaGeneration)},onLoaded(e,t){H.E.getInstance().logLatency(e,o,!t)}})}var W=a(40702),z=a(80519),Q=a(8374),J=a(55973),j=a(51378);const Y=({preview:e,title:t,loadingStatus:a})=>{switch(a){case"loading":return b.createElement(Q.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4}},b.createElement(J.H,{size:12}));case"timeout":return null;default:return b.createElement(j.c,null,t,": ",b.createElement(M.V,null," ",e," "))}};var X=a(72842),K=a(16895);function Z(e){return(0,R.n)({tablePreview:{marginTop:"12px",display:"flex"},numberRowColumn:{display:"flex",flexDirection:"column","& > :first-child":{...K.Pt.borderTop("1px","solid",e.borderColor),borderStartStartRadius:"4px"},"& > :last-child":{borderEndStartRadius:"4px",...K.Pt.borderBottom("1px","solid",e.borderColor)}},dataColumn:{display:"flex",flexDirection:"column",...K.Pt.flex(1),...K.Pt.borderTop("1px","solid",e.borderColor),...K.Pt.borderBottom("1px","solid",e.borderColor),"& > :nth-child(2n+3)":{backgroundColor:e.dataBackgroundOdd},"&:last-child > *":{borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.borderColor},"&:last-child":{borderStartEndRadius:"4px",borderEndEndRadius:"4px"}},numberRowCell:{display:"flex",alignItems:"center",justifyContent:"center",height:"20px",...K.Pt.border("1px","solid",e.borderColor),...K.Pt.borderTop(0),backgroundColor:e.cellBackground,"& > *":{...K.Pt.overflow("hidden"),whiteSpace:"nowrap",textOverflow:"ellipsis",...K.Pt.padding("2px","4px"),...O.g.caption1,color:w.k1.colorNeutralForeground3}},dataColumnsContainer:{display:"flex",flexGrow:1,overflowX:"auto",overflowY:"hidden"},lastDataColumn:{"& > :first-child":{borderStartEndRadius:"4px"},"& > :last-child":{borderEndEndRadius:"4px"}},dataCell:{height:"20px",display:"flex",alignItems:"center",...K.Pt.borderBottom("1px","solid",e.dataBorderHorizontalColor),borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.dataBorderVerticalColor,backgroundColor:e.dataBackgroundEven,"&:last-child":{...K.Pt.borderBottom("0px")}},dataCellTotal:{boxShadow:`0 1px 0 0 ${e.totalRowBackground} inset, 0 2px 0 0 ${e.dataBorderHorizontalColor} inset`,"&:last-child":{backgroundColor:e.totalRowBackground}},contentDataCellTotal:{...O.g.caption1Strong},contentDataCell:{whiteSpace:"nowrap",textOverflow:"ellipsis",color:w.k1.colorNeutralForeground1,...K.Pt.padding("2px","4px"),...K.Pt.overflow("hidden"),...O.g.caption1},headerCell:{...K.Pt.borderColor(e.borderColor),borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.borderColor,backgroundColor:e.cellBackground,justifyContent:"center",color:w.k1.colorNeutralForeground3,"& > *":{color:w.k1.colorNeutralForeground3}},headerCellBeforeSkip:{marginInlineEnd:"1px"},headerCellAfterSkip:{borderInlineStartStyle:"solid",borderInlineStartWidth:"1px"},columnTitleCell:{backgroundColor:e.titleBackground,"& > *":{color:e.titleForeground,...O.g.caption1Strong}}})}const ee=Z({cellBackground:w.k1.colorNeutralBackground2,titleBackground:w.k1.colorCompoundBrandBackground,titleForeground:w.k1.colorNeutralForegroundInverted,dataBackgroundOdd:w.k1.colorBrandBackground2,dataBackgroundEven:w.k1.colorNeutralBackground1,totalRowBackground:w.k1.colorNeutralBackground1,borderColor:w.k1.colorNeutralStroke2,dataBorderVerticalColor:w.k1.colorBrandStroke2,dataBorderHorizontalColor:w.k1.colorBrandStroke2}),te=Z({cellBackground:w.k1.colorNeutralBackground3,titleBackground:w.k1.colorNeutralBackground6,titleForeground:w.k1.colorNeutralForeground1,dataBackgroundOdd:w.k1.colorNeutralBackground1,dataBackgroundEven:w.k1.colorNeutralBackground1,totalRowBackground:w.k1.colorNeutralBackground1,borderColor:w.k1.colorNeutralStroke1Selected,dataBorderVerticalColor:w.k1.colorNeutralStroke1,dataBorderHorizontalColor:w.k1.colorNeutralStroke1}),ae=Z({cellBackground:"lightgreen",titleBackground:w.k1.colorCompoundBrandBackground,titleForeground:w.k1.colorNeutralForegroundInverted,dataBackgroundOdd:"lightblue",dataBackgroundEven:"deepskyblue",totalRowBackground:"green",borderColor:"red",dataBorderVerticalColor:"yellow",dataBorderHorizontalColor:"pink"});var ne;function oe(e){const t=te(),a=ee(),n=ae();switch(e){case 1:return t;case 0:return a;case 2:return T.MYv?n:t;default:return(0,X.x)(e)}}function re({rows:e,numberColumnWidth:t}){const a=oe(ne.neutral),n=b.createElement(Q.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4}},b.createElement(J.H,{size:12}));return b.createElement("div",{className:a.tablePreview},b.createElement("div",{className:a.numberRowColumn,style:{width:t}},Array.from({length:e}).map(((e,t)=>b.createElement("div",{className:a.numberRowCell,key:t},0===t?null:n)))),b.createElement("div",{className:(0,D.z)(a.dataColumn,a.lastDataColumn),style:{width:"100%"}},Array.from({length:e}).map(((e,t)=>b.createElement("div",{className:0===t?(0,D.z)(a.dataCell,a.headerCell):a.dataCell,key:t},n)))))}!function(e){e[e.grid=0]="grid",e[e.neutral=1]="neutral",e[e.crazy=2]="crazy"}(ne||(ne={}));var ie=a(98100),le=a(50347);const se=(e,t,a)=>Math.min(Math.max(((e,t="12px Segoe UI")=>{const a=document.createElement("canvas").getContext("2d");if(a)return a.font=t,a.measureText(e).width;return 12*e.length})(e),t),a);var ce=a(58242);const de={smallScrollbarStyle:{"::-webkit-scrollbar":{height:"7px",backgroundColor:"transparent",...K.Pt.borderRadius(w.k1.borderRadiusLarge)},"::-webkit-scrollbar-thumb":{backgroundColor:w.k1.colorScrollbarOverlay,...K.Pt.borderRadius(w.k1.borderRadiusLarge),...K.Pt.border("1px","solid",w.k1.colorNeutralBackground1),":hover":{backgroundColor:w.k1.colorNeutralForeground3}},"::-webkit-scrollbar-track":{backgroundColor:"transparent",...K.Pt.borderRadius(w.k1.borderRadiusLarge)}}},ue=(0,R.n)(de),me=({preview:e,type:t,theme:a,uiTimeout:n})=>{(0,U.IC)("Failed"===e,(()=>{u.M.userQueryGuid&&(u.M.getInstance().logStandardizedAshaErrorEvent(k.W.UI_Failed_To_Update_Or_Load,N.c.Preview_On_Card_Failed_To_Display,c.BJ.FormulaGeneration),u.M.getInstance().logErrorCode(s.O.CalculatedColumnPreviewNotUpdated,new Error("Preview is 'Failed'"),d.S.FormulaGeneration,c.$b.Warning))}));const o=(0,U.rK)("preview",Boolean(e),n,{onTimeout(){u.M.userQueryGuid&&(u.M.getInstance().logStandardizedAshaErrorEvent(k.W.Response_Delayed_Or_Timed_Out,N.c.Calculate_Preview_Timeout,c.BJ.FormulaGeneration),u.M.getInstance().logErrorCode(s.O.CalculatedColumnPreviewNotUpdated,new Error("Preview took too long to load"),d.S.FormulaGeneration,c.$b.Warning))},onLoaded(e,t){H.E.getInstance().logLatency(e,c.OP.FormulaPreviewAvailable,!t)}}),r=b.createElement("div",null,T.xe2.FormulaSuggestion_Preview_NotAvailable);switch(o){case"timeout":return r;case"loading":return b.createElement(re,{rows:7,numberColumnWidth:38});case"loaded":switch(e){case"Failed":return r;case"previewDisabled":case void 0:return null;default:return b.createElement(ge,{preview:e,type:t,theme:a})}default:(0,X.x)(o)}},ge=({preview:e,type:t,theme:a})=>{const n=oe(a),o=ue();if(!e.rows.length||!e.rows[0].values.length)return(0,ie.cY)("TablePreview: No rows or values in preview"),null;const r=e.rows[0].values.length,i=({children:e})=>b.createElement("div",{className:n.numberRowCell},b.createElement("div",null,e)),l=({children:e,className:t,contentClassName:a})=>b.createElement("div",{className:t},b.createElement("div",{className:(0,D.z)(n.contentDataCell,a)},e)),m=Array.from({length:r}),g=m.length-1,h=se(String(e.rows.at(-1)?.row),38,50);return b.createElement("div",{className:n.tablePreview,role:"group","aria-label":T.xe2.FormulaSuggestion_Preview_AriaLabel},b.createElement("div",{className:n.numberRowColumn,style:{width:h},"aria-hidden":!0},b.createElement(i,null)," ",b.createElement(i,null,e.headerRow),e.rows.map((e=>b.createElement(i,{key:e.row},e.row)))),b.createElement("div",{className:(0,D.z)(n.dataColumnsContainer,o.smallScrollbarStyle)},m.map(((a,o)=>{const r=0===o,i=o===g,h=e.columnLetters[o];void 0===h&&u.M.getInstance().logErrorCode(s.O.CalculatedColumnPreviewNoColumnLetters,new Error(`columnLetters is undefined for column ${o} out of ${g}`),d.S.FormulaGeneration,c.$b.Warning);const p=r?void 0:e.columnLetters[o-1],f=i?void 0:e.columnLetters[o+1],{isBeforeSkip:C,isAfterSkip:y}=function(e,t,a){if(!(0,le.yw)("OfficeVSO_9523173_previewSkippedColumnsFix")||void 0===e)return{isBeforeSkip:!1,isAfterSkip:!1};const n=void 0!==t&&(0,ce.$Y)(e)+1!==(0,ce.$Y)(t),o=void 0!==a&&(0,ce.$Y)(a)+1!==(0,ce.$Y)(e);return{isBeforeSkip:n,isAfterSkip:o}}(h,f,p);return b.createElement("div",{key:o,className:(0,D.z)(n.dataColumn,i&&n.lastDataColumn),style:{maxWidth:1===m.length?"100%":"50%"}},b.createElement(l,{className:(0,D.z)(n.dataCell,n.headerCell,C&&n.headerCellBeforeSkip,y&&n.headerCellAfterSkip)},h),b.createElement(l,{className:(0,D.z)(n.dataCell,n.columnTitleCell)},e.columnHeaders[o]),e.rows.map(((e,a,r)=>{const i=a===r.length-1;return b.createElement(l,{key:e.row,className:(0,D.z)(n.dataCell,t===z.VS.Cell&&i&&n.dataCellTotal),contentClassName:t===z.VS.Cell&&i?n.contentDataCellTotal:void 0},e.values[o])})))}))))};var he=a(23343);const pe=(0,R.n)({columnRecommendation:{backgroundColor:w.k1.neutralLight,color:w.k1.black},text:{}});var be=a(64934),fe=a(24180),Ce=a(54285),ye=a(18700),ve=a(11689),Te=a(39504),xe=a(49462);function Se(e){if((0,z.iM)(e))return(0,ie.hU)(e)?(0,T.aVz)():(0,T.BqH)();if((0,z.cY)(e))return(0,ie.Z)(e)?e.allowReplacementOfExistingValue?(0,T.KeO)():(0,T.E$x)():e.allowReplacementOfExistingValue?(0,T.ooE)():(0,T.EWN)();throw new Error("getInsertText: Invalid recommendation type")}function we(e,t){const a=(0,xe.d4)((e=>e.dataAI.invalidatedSuggestions.includes(t.id)))&&(0,le.Jh)(),[n,o]=(0,b.useState)((()=>!t||!t.isInserted)),r=(0,le.iP)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsPreviewButton",!1),i=n&&!a,l=function(e,t,a,n){(0,U.H5)((()=>{Le(t.id,a?c.a5.FormulaPreviewButtonAllowed:c.a5.FormulaPreviewButtonDisabled)}));const o=(0,ve.j)(),r=(0,xe.Pj)(),i=(0,xe.d4)((e=>e.dataAI.previewId)),l=(0,xe.d4)((e=>e.chat.latestRequestId)),s=b.useMemo((()=>{const n=r.getState();return Boolean(t&&a&&(0,Ce.O4)(e,t,n)&&n.dataAI.rawPreview[t.id]?.length)}),[e,t,r]),d=t?.id,u=l===e,m=i===d;(0,b.useEffect)((()=>{s&&d&&m&&!u&&((0,ie.cY)("FormulaSuggestion: not in latest request, hiding preview"),o(fe.m.hidePreviewOnGrid(e,d)))}),[m,u,d,s]),(0,U.iK)((()=>{s&&d&&m&&((0,ie.cY)("FormulaSuggestion: unmounting, hiding preview"),o(fe.m.hidePreviewOnGrid(e,d)))}));const g=Boolean(n&&s&&d);if((0,U.IC)(g,(()=>{Le(d,c.a5.FormulaPreviewButtonVisible)})),!g)return;const h=m?T.XBr.PreviewOnGridButton_HidePreview():T.XBr.PreviewOnGridButton_ShowPreview(),p={buttonText:h,buttonTitle:h,icon:m?b.createElement(be.sTx,null):b.createElement(be.tRH,null),handleButtonOnClick:async()=>{if(t)return Le(t.id,m?c.a5.FormulaPreviewButtonClickHide:c.a5.FormulaPreviewButtonClickShow),o(fe.m.togglePreviewOnGrid(e,t,{hidePreviewOnChange:!0,moveViewportToPreview:!0}))}};return p}(e,t,r,i),s=function(e,t,a,n,o){const r=(0,ve.j)();function i(t){if(o(),r(fe.m.hidePreviewOnGrid(e,t.id)),(0,z.iM)(t))r(fe.m.insertColumnsRecommendation(e,t));else{if(!(0,z.cY)(t))throw new Error("handleInsert: Invalid recommendation type");r(fe.m.insertCellsRecommendation(e,t))}}return!t.isInserted&&n?{...(0,z.cY)(t)&&t.allowReplacementOfExistingValue?(0,p.x8)(Se(t)):(0,p.r1)(Se(t)),handleButtonOnClick:async()=>i(t),...a&&{handleOnMouseEnter:async()=>r(fe.m.showPreviewOnGrid(e,t)),handleOnMouseLeave:async()=>r(fe.m.hidePreviewOnGrid(e,t.id))}}:void 0}(e,t,!r,i,(()=>o(!1))),d=(0,Te.D)(t.debugInfo);return(0,ie.cY)("useSuggestionsButtons",{requestId:e,recommendation:t,canInsert:n,canInsertSuggestion:i,canShowPreviewButton:r,previewButton:l,insertButton:s}),[s,l,d].filter(ye.O9)}function Ee({recommendation:e,...t}){return e?b.createElement(Re,{recommendation:e,...t}):(u.M.getInstance().logErrorCode(s.O.ColumnRecommendationsNotAvailable,new Error("No visible recommendation"),d.S.FormulaGeneration,c.$b.Warning),b.createElement(Ae,null))}function Re({requestId:e,recommendation:t,isMainRecommendation:a,targetAddress:n,columnLetters:o,rowNumber:r}){(0,ie.cY)("FormulaSuggestion.render",{requestId:e,recommendation:t,isMainRecommendation:a,targetAddress:n,columnLetters:o,rowNumber:r});const i=we(e,t);void 0===t.suggestionType&&(t.suggestionType=z.VS.Column);const l=pe();(0,U.IC)(function(e,t){return t&&"object"==typeof e.preview&&String(e.preview.columnLetters)!==String(t)}(t,o),(()=>{u.M.getInstance().logError({logLevel:c.$b.Warning,eventType:d.S.FormulaGeneration,errorMessage:`columnLetters in the header are different than in the preview. Recommendation: ${t.id}`})}));const s=t.calculatedFormulas.length>1,m=he.R.getFormulaSuggestionUiTimeouts(),g=(0,U.rK)("previewForHeader",Boolean(t.preview),m.preview);return b.createElement(p.lJ,{contentBody:b.createElement(x.B,{tokens:{childrenGap:12},className:(0,D.z)(l.columnRecommendation,"column-recommendation")},Ie(t,g)&&b.createElement(Y,{title:t.calculatedFormulas[0]?.title,preview:t.preview.headerPreviewValue,loadingStatus:g}),b.createElement(W.A,{recommendation:t,isMainRecommendation:a,targetAddress:n,columnLetters:o,rowNumber:r}),b.createElement(x.B,{tokens:{childrenGap:12},role:s?"list":void 0},t.calculatedFormulas.map(((e,a)=>b.createElement(V,{loadingTimeouts:m,key:e.id,id:`${t.id}_${e.id}`,suggestionId:t.id,role:s?"listitem":(0,le.yw)("OfficeVSO_9419358_FormulaA11yFixes")?"group":void 0,title:Ie(t,g)?void 0:s?`${a+1}. ${e.title}`:e.title,description:e.description,formula:e.formula,explanation:e.formulaExplanation,onFirstTimeExplanationShown:()=>{Le(t.id,c.a5.CalculatedColumnsExplainButtonClicked)}})))),b.createElement(me,{uiTimeout:m.preview,theme:ne.neutral,preview:t.preview,type:t.suggestionType})),requestId:e,cardButtons:i})}function Ie(e,t){return!!(0,le.yw)("OfficeVSO_9588604_ColumnAggregationHeaderPreview")&&(!!e.isSingleFormula&&"timeout"!==t&&"object"==typeof e.preview&&"string"==typeof e.preview.headerPreviewValue)}function Ae(){return b.createElement(_.A,{body:{user:"chat",messageHeader:{text:(0,T.HGr)()}},styles:pe(),shouldShowAIGeneratedIndicator:!1})}function Le(e,t){H.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:t,[c.h3.ChatEventParameters]:e},u.M.getInstance())}var Fe=a(79689),_e=a(29328),Ne=a(47691),ke=a(32096),Oe=a(29995),Pe=a(73418),Me=a(90922),De=a(25594),$e=a(74540),Be=a(18011),He=a(79029),Ue=a(98226);const qe=(0,E.Q)(w.eL),Ve=qe.neutralLight,Ge=(0,Ue.l8)({sliderButton:{alignSelf:"flex-end",backgroundColor:Ve,border:Ve,alignItems:"center",paddingLeft:0,paddingRight:0,":hover":{color:qe.themePrimary+" !important",cursor:"pointer",backgroundColor:"inherit"}},excelFileNameLink:{color:qe.colorNeutralForeground3,fontSize:qe.fontSizeBase200,lineHeight:"16px",padding:"5px",verticalAlign:"super",fontWeight:"600",":hover":{color:qe.themePrimary,cursor:"pointer"}},excelFileNameSuffix:{display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl",textAlign:"left",maxWidth:"100%",fontSize:qe.fontSizeBase200,fontWeight:"400",padding:"0",marginBottom:"-12px",color:qe.colorNeutralForeground3},pathContainer:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",height:"44px",paddingTop:"4px"},importButton:{height:"24px",padding:"0 8px",width:"fit-content"},folderIcon:{color:qe.colorNeutralForeground3,marginRight:"4px",marginTop:"1px"}}),We={title:{justifyContent:"start",...K.Pt.padding("0px",0),"&:hover":{color:qe.themePrimary,"&:active":{color:qe.themeDarkAlt}},"&:disabled":{color:qe.neutralQuaternary}},snippet:{transition:"max-height 0.5s ease-in-out"},snippetVisible:{maxHeight:"1000px"},snippetHidden:{maxHeight:"0"}},ze=(0,R.n)(We);function Qe(e){const[t,a]=(0,b.useState)(!1),[n,o]=(0,b.useState)(!1),[r,i]=(0,b.useState)(!1),l=ze(),s=r?(0,D.z)(l.snippet,l.snippetVisible):(0,D.z)(l.snippet,l.snippetHidden);return(0,b.useEffect)((()=>{t?(o(!0),setTimeout((()=>{i(!0)}),50)):(i(!1),setTimeout((()=>{o(!1)}),600))}),[t]),b.createElement(b.Fragment,null,b.createElement(Ne.$,{size:"small",appearance:"transparent",onClick:()=>{a(!t),e.logBodyShown&&!t&&e.logBodyShown()},"aria-expanded":t,className:l.title,icon:t?b.createElement(Fe.g4$,null):b.createElement(Fe.rLf,null),iconPosition:"after"},t?(0,T.Z4S)():(0,T.U45)()),n&&b.createElement("div",{className:s},b.createElement(B.$,{title:(0,T.m3r)(),content:b.createElement(b.Fragment,null,e.query),explanation:{explanation:e.explanation},alwaysShowExplanation:!0,telemetryUsageFeatureName:c.q.ImportDataFromSearch,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([e.query],{type:"text/plain"})})})))}const Je=(e,t)=>{const a=t.slice(0,4).map(((e,t)=>({row:t+2,values:e})));return t.length>4&&a.push({row:6,values:e.map((e=>"..."))}),0===a.length?(u.M.getInstance().logError({eventType:d.S.ImportData,errorMessage:"getSampleRows: No rows provided",logLevel:c.$b.Warning}),[{row:"...",values:e.map((e=>"..."))}]):a},je=()=>b.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},b.createElement("path",{fill:"#fff",d:"M7.5 22h14c.275 0 .5-.225.5-.5V7h-3.5c-.827 0-1.5-.673-1.5-1.5V2H7.5c-.275 0-.5.225-.5.5v19c0 .275.225.5.5.5z"}),b.createElement("path",{fill:"#fff",d:"M21.293 6 18 2.707V5.5c0 .275.225.5.5.5h2.793z"}),b.createElement("path",{fill:"#605E5C",fillRule:"evenodd",d:"m22.56 5.854-4.414-4.415A1.51 1.51 0 0 0 17.086 1H7.5C6.673 1 6 1.673 6 2.5v19c0 .827.673 1.5 1.5 1.5h14c.827 0 1.5-.673 1.5-1.5V6.914c0-.4-.156-.777-.44-1.06zM18 2.707 21.293 6H18.5a.501.501 0 0 1-.5-.5V2.707zM7.5 22h14c.275 0 .5-.225.5-.5V7h-3.5c-.827 0-1.5-.673-1.5-1.5V2H7.5c-.275 0-.5.225-.5.5v19a.5.5 0 0 0 .5.5z",clipRule:"evenodd",opacity:".64"}),b.createElement("path",{fill:"#134A2C",d:"M19 17h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),b.createElement("path",{fill:"#185C37",d:"M15 17h-1v-2h1a1 1 0 1 1 0 2z"}),b.createElement("path",{fill:"#21A366",d:"M19 14h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),b.createElement("path",{fill:"#107C41",d:"M15 14h-1v-2h1a1 1 0 1 1 0 2z"}),b.createElement("path",{fill:"#33C481",d:"M19 11h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),b.createElement("path",{fill:"#21A366",d:"M15 11h-1V9h1a1 1 0 1 1 0 2z"}),b.createElement("path",{fill:"#107C41",d:"M2 19h10a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1z"}),b.createElement("path",{fill:"#F9F7F7",d:"m4.125 16 2.06-3.009L4.298 10h1.518l1.03 1.913c.095.18.16.316.196.405h.014c.067-.145.138-.285.213-.422L8.369 10h1.394l-1.936 2.974L9.813 16H8.329l-1.19-2.1a1.75 1.75 0 0 1-.142-.28H6.98a1.28 1.28 0 0 1-.138.271L5.617 16H4.125z"}));const Ye=({importType:e,requestId:t,dataSources:a,messageId:n,userQueryGuid:o,performedFallbackToAllTables:r})=>{const i=(0,ve.j)(),[l,s]=b.useState(0),[d,m]=b.useState(new Set),g=a[l],h=d.has(g.id),f=pe(),C=function(){const[e,t,a]=(0,le.xt)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[0,15e3,25e3]);return{description:e,preview:t,explanation:a}}(),y=a.length>1,v=g.powerQueryScript,S={headerRow:1,columnLetters:Array.from({length:g.columns?.length||0},((e,t)=>String.fromCharCode(65+t))),columnHeaders:g.columns?.map((e=>e.name))||[],rows:Je(g.columns||[],g.sampleRows||[])},w=h?(0,T.gTs)():(0,T.N0D)(),E=h?b.createElement(Fe.N5_,null):b.createElement(_e.rz9,null);return b.createElement(p.lJ,{contentBody:b.createElement(x.B,{tokens:{childrenGap:12},className:(0,D.z)(f.columnRecommendation,"column-recommendation")},b.createElement(j.c,null,b.createElement(Pe.sA,{message:r?(0,T.Txd)():y?(0,T.h9u)():(0,T.u1U)(),values:[a.length]})),y&&b.createElement(x.B,{horizontal:!0},b.createElement(Ne.$,{size:"small",name:"Previous",appearance:"transparent",icon:b.createElement(Fe.bP_,null),className:Ge.sliderButton,"aria-expanded":void 0,onClick:()=>{s((e=>(e-1+a.length)%a.length))}}),b.createElement(j.c,{style:{lineHeight:"24px"}},(0,T.Dqz)().replace("{0}",`${l+1}`).replace("{1}",`${a.length}`)),b.createElement(Ne.$,{size:"small",name:"Next",appearance:"transparent",icon:b.createElement(Fe.KOR,null),className:Ge.sliderButton,"aria-expanded":void 0,onClick:()=>{s((e=>(e+1)%a.length))}})),b.createElement(ke.Z,null,b.createElement(j.c,null,b.createElement("div",{className:Ge.pathContainer},b.createElement("span",{style:{float:"right",marginLeft:"10px"}},b.createElement(Oe.E,{title:g.sourceName,shape:"rounded",color:"informative",size:"small",appearance:"filled"},g.sourceName)),b.createElement("span",null,b.createElement("span",{title:(0,T.yWm)()},b.createElement(je,null)),b.createElement($e.N,{title:g.sourceLocation,className:Ge.excelFileNameLink,appearance:"subtle",href:g.seeMoreUrl,as:"a",target:"_blank"},g.sourceLocation)),b.createElement(x.B,{horizontal:!0},b.createElement(be.aPM,{className:Ge.folderIcon}),b.createElement(Be.J,{className:Ge.excelFileNameSuffix,title:g.sourceRelativePath},g.sourceRelativePath)))),b.createElement("div",{style:{height:"155px",marginTop:"-12px"}},b.createElement(me,{uiTimeout:C.preview,theme:ne.neutral,preview:S,type:z.VS.Column})),b.createElement(x.B,{tokens:{childrenGap:0}},b.createElement(Qe,{query:v,explanation:(0,T.Iiw)(),logBodyShown:()=>{var e,t;e=g.id,t=c.a5.ImportDataExplainButtonClicked,H.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:t,[c.h3.ChatEventParameters]:e},u.M.getInstance())}})),b.createElement(x.B,{tokens:{childrenGap:0}},b.createElement(Ne.$,{className:Ge.importButton,size:"small",title:w,icon:E,disabled:h,onClick:()=>(()=>{const t=a[l];(0,De.I2)(n,o,i,e)({sourceName:t.sourceName,sourceLocation:t.sourceLocation,sourceUrl:t.sourceUrl??"",columns:t.columns??[],sampleRows:t.sampleRows??[],powerQueryScript:t.powerQueryScript}),m(new Set(d).add(t.id)),(0,le.BT)()?He.B.getInstance().logKeptEvent(c.BJ.ImportData,e,Me.RX.Create):u.M.getInstance().logKeptEvent(e),(0,ie.cY)(`Added ${t.sourceName} to sheet.`)})()},w)))),requestId:t})};const Xe={root:{},card:{fontWeight:"400",fontSize:"14px",lineHeight:"20px",color:(0,E.Q)(w.eL).black},confirmationMessage:{paddingTop:"20px"}},Ke=(0,R.n)(Xe);function Ze(e){const t=Ke();return b.createElement("div",{className:t.card},b.createElement("div",null,e.message),e.confirmationMessage?b.createElement("div",{className:t.confirmationMessage},e.confirmationMessage):null)}var et=a(56305),tt=a(5911),at=a(46224);const nt=(0,b.lazy)((()=>Promise.all([a.e("monaco-editor"),a.e("vendors~MonacoReadOnly"),a.e("MonacoReadOnly")]).then(a.bind(a,79493))));function ot({id:e,columnName:t,code:a,codeExplanation:n,text:o,onFirstTimeExplanationShown:r,loadingTimeouts:i}){const l=it(`description[${e}]`,Boolean(o),i.description);return b.createElement(x.B,{tokens:{childrenGap:8}},b.createElement(M.V,{role:"heading","aria-level":2,"data-testid":"formula-title"},t),b.createElement($.u,{text:function(e){switch(l){case"loading":return;case"timeout":return T.xe2.FormulaSuggestion_Description_NotAvailable;default:return e}}(o)}),b.createElement(rt,{id:e,code:a,codeExplanation:n,onFirstTimeExplanationShown:r,loadingTimeouts:i}))}function rt({id:e,code:t,codeExplanation:a,onFirstTimeExplanationShown:n,loadingTimeouts:o}){const r=it(`explanation[${e}]`,Boolean(a),o.explanation),i=c.q.PythonCalculatedColumns,l=b.createElement(nt,{code:t}),s=(0,at.ZK)(t,!0,0);return b.createElement(B.$,{title:"Python",content:l,explanation:{explanation:a,isLoading:"loading"===r,isNotAvailable:"timeout"===r,onFirstTimeExplanationShown:n},telemetryUsageFeatureName:i,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([s],{type:"text/plain"})})})}function it(e,t,a){return(0,U.rK)(e,t,a,{onTimeout(){},onLoaded(){}})}var lt=a(95674),st=a(50819);function ct({recommendation:e,...t}){return e?b.createElement(dt,{recommendation:e,...t}):b.createElement(mt,null)}function dt({requestId:e,recommendation:t,targetAddress:a,columnLetters:n,insertCallback:o}){if(!t)return b.createElement(mt,null);if(!a)return b.createElement(mt,{errorMessage:(0,T.gg6)()});const r=(0,st.E)().pythonRecommendation,i=function(){const[e,t,a]=(0,le.xt)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[15e3,15e3,25e3]);return{description:e,preview:t,explanation:a}}();return b.createElement(p.lJ,{requestId:e,contentBody:b.createElement(x.B,{tokens:{childrenGap:12},className:(0,D.z)(r,"python-recommendation")},a&&n&&b.createElement(ut,{targetAddress:a,columnLetters:n}),b.createElement(x.B,{tokens:{childrenGap:12}},b.createElement(ot,{loadingTimeouts:i,key:t.id,id:`${t.id}_${t.id}`,columnName:t.columnName,text:t.text,code:t.code,codeExplanation:t.codeExplanation,onFirstTimeExplanationShown:()=>{var e,a;e=t.id,a=c.a5.PythonCalculatedColumnsExplainButtonClicked,H.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:a,[c.h3.ChatEventParameters]:e},u.M.getInstance())}}))),cardButtons:[{...(0,p.r1)((0,T.Nbb)()),handleButtonOnClick:o}]})}function ut({targetAddress:e,columnLetters:t}){const a=(0,lt.r)(e),n=b.createElement(Pe.sA,{message:T.xe2.FormulaSuggestion_Header_Singular_Location,values:{columnLetter:t}});return b.createElement(j.c,null,b.createElement(Pe.sA,{message:T.xe2.FormulaSuggestion_Header_Singular,values:{tableRange:b.createElement(M.V,null,a),location:b.createElement(M.V,null,n)}}))}function mt({errorMessage:e}){return b.createElement(_.A,{body:{user:"chat",messageHeader:{text:e??(0,T.JIA)()}},styles:(0,st.E)(),shouldShowAIGeneratedIndicator:!1})}var gt=a(28087),ht=a(33500),pt=a(72483),bt=a(6925),ft=a(33851),Ct=a(25433),yt=a(23147),vt=a(35828);const Tt=(0,E.Q)(w.eL),xt={pythonStartAnalysis:{"& > :first-child":{marginBottom:"2px"},"& > :nth-child(2)":{marginTop:"0px",paddingLeft:"25px"},backgroundColor:Tt.neutralLight,color:Tt.neutralDark}},St=(0,R.n)(xt);var wt=a(98483);function Et(e){const t=(0,ve.j)(),a=(0,xe.d4)((e=>e.chat.showLoadingUI)),n=(0,xe.d4)((e=>e.chat.isPythonStartAnalysisButtonDisabled));return(0,b.useEffect)((()=>{t(bt.mF.setPythonStartAnalysisButtonDisabled(!1))}),[]),b.createElement(p.lJ,{contentBody:function(e){const t=St();return b.createElement(x.B,{className:(0,D.z)(t.pythonStartAnalysis,"python-start-analysis")},b.createElement(S.E,null,(0,T.XXH)()),b.createElement("ul",null,b.createElement("li",{key:"first-bullet"},(0,T.zqN)()),b.createElement("li",{key:"second-bullet"},(0,T.lQ6)()),b.createElement("li",{key:"third-bullet"},(0,T.WQT)()),e?b.createElement("li",{key:"fourth-bullet"},(0,T.PxQ)()):null),(0,le.yw)("OfficeVSO_9496420_PythonFirst30sStringUpdates")?b.createElement(S.E,null,(0,T.LMV)()):null)}(e.shouldShowRecalcNotice),requestId:e.requestId,cardButtons:(0,le.yw)("OfficeVSO_9352410_SetPythonStartAnalysisButtonDisabled")&&n?[]:[{buttonTitle:(0,T.QAQ)(),buttonText:(0,T.QAQ)(),handleButtonOnClick:()=>o(),icon:b.createElement(_e.u9I,null),isDisabled:a}]});async function o(){const e=Ct.w.getInstance(t);try{if((0,ft.PB)(ft.L3.StartAnalysisClicked,[]),(0,le.yw)("OfficeVSO_9435602_displayStartAAMessage")){const e={chatCardType:gt._.Default,chatMessageData:{defaultMessageProps:{user:ht.Q9.Human,messageHeader:{text:(0,T.QAQ)()}}}};if((0,le.yw)("OfficeVSO_9544967_PythonTriedFixes")){const t={featureName:c.q.Python,eventType:c.a5.SuggestionMessage};pt.$.getInstance().displayResponse(e,t)}else pt.$.getInstance().displayResponse(e)}if(yt.CP.pythonContextManager.prePythonModeError)return void(0,vt.Kx)(t,yt.CP.pythonContextManager.prePythonModeError,yt.CP.pythonContextManager.prePythonModeErrorFunction??"handleStartAnalysisOnClick - prePythonModeError",!0);t(bt.mF.startExecutingAndLockContext(c.OP.PythonStartAnalysis)),(0,le.yw)("OfficeVSO_9476928_EnableDiagnosticsInPostView")?yt.CP.pythonContextManager.enterAdvancedAnalysisMode():(yt.CP.pythonContextManager.isPythonMode=!0,yt.CP.pythonContextManager.analysisSessionId=(0,wt.A)(),yt.CP.pythonContextManager.isFirstCodeExecution=!0);const e=Ct.w.getInstance(t);await e.handlePythonStartAnalysis()}catch(a){e.handlePythonExitAnalysis(!1),(0,vt.Kx)(t,a,"handleStartAnalysisOnClick",!1,void 0,[],!0)}}}const Rt={title:{color:(0,E.Q)(w.eL).black}},It=(0,R.n)(Rt);function At(e){const t=It();if(!e.title)return null;const a=e.title.runs.map(((e,t)=>{const a=null!=e.highlightStyleIndex?`recommendation-title__rich-text__${e.highlightStyleIndex}`:"";return b.createElement("span",{className:a,key:t},e.text)}));return b.createElement("div",{className:(0,D.z)(t.title,"recommendation-title")},a)}a(49473);var Lt=a(32182),Ft=a(93170),_t=a(17649),Nt=a(42012),kt=a(59266),Ot=a(39234);function Pt(e,t=1){if(!e||7!==e.length)throw new Error("Invalid color string.");return{r:Mt(e.substr(1,2)),g:Mt(e.substr(3,2)),b:Mt(e.substr(5,2)),a:t}}function Mt(e){const t=Number.parseInt(e[0],16),a=Number.parseInt(e[1],16);if(Number.isNaN(t)||Number.isNaN(a))throw new Error("Invalid color string.");return(16*t+a)/255}var Dt,$t=a(15407),Bt=a(91960);function Ht(e){const t=Date.UTC(0,0,-1,0,0,0);return(e.getTime()-t)/1e3/60/60/24}function Ut(e,t,a=1){const n=new Date(+e);return 3===t?n.setUTCFullYear(e.getUTCFullYear()+a):2===t?n.setUTCMonth(e.getUTCMonth()+a):1===t?n.setUTCDate(e.getUTCDate()+7*a):n.setUTCDate(e.getUTCDate()+a),n}function qt(e){const t=e.filter((e=>0!==e)).reduce(((e,t)=>Math.min(e,t)),Number.MAX_VALUE),a=e.filter((e=>0!==e)).reduce(((e,t)=>Math.max(e,t)),Number.MIN_VALUE),n=function(e,t,a){const n=function(e){let t=Number.MAX_VALUE,a=e[0];for(let n=1;n<e.length;n++){const o=e[n];t=Math.min(Math.abs(a-o),t),a=o}return t}(a),o=t-e;if(n<7&&o<56)return Dt.Day;if(n<28&&o<365)return Dt.Week;if(n<365&&o<1825)return Dt.Month;return Dt.Year}(t,a,e);return function(e,t,a,n=1){const o=[];if(e===t)o.push(1);else if(a===Dt.Day)o.push(n);else if(a===Dt.Week)o.push(7*n);else{let i=e;for(;i<t;){const e=Ht(Ut((r=i,new Date(Date.UTC(0,0,r-1,0,0,0))),a,n));o.push(e-i),i=e}}var r;return o}(t,a,n)}!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.Year=3]="Year"}(Dt||(Dt={}));var Vt=a(59384);class Gt{createAxes(e){return this.getAxesForChart(e)}static updateAxesTickLabels(e,t,a,n,o){if("histogram"===e.series[0].layout)return;const r=t&&n>Vt.y3;a.forEach((t=>{if("categoryValues"!==t.dimensionType)return;const a=Gt.getCategoryCountForSeries(e.data,e.series[0]);if(!r&&!o&&a>n&&t.tickLabels)return void(t.tickLabels.show=!1);const i=Gt.isDateDimension(e,"categories");(0,Nt.tJ)(e.series)&&(-1===a||i)||t.tickLabels&&(t.tickLabels.show=!0)}))}getAxesForChart(e){const t=(0,Ot.ip)(e),a=[...(0,_t.lf)(t.primary.insightsType)];if(t.secondary){const e=(0,_t.t7)(t.secondary.insightsType);a.push(...e)}return a.map(((t,a)=>{const n=t.dimension,o=(0,Nt.tJ)(e.series)?(0,Nt.fB)(e,t):e.axes.find((e=>e.dimensionType===n&&e.axisGroup===t.axisGroup)),r=(0,Lt.q)(e,n,t.axisGroup),i={dimensionType:"categories"===n?"categoryValues":n,tickLabels:this.getTickLabelsForAxis(e,t),index:a};if(t.isValue&&"primary"===t.axisGroup&&(i.majorGridLines={}),"values"===t.dimension?i.lineThickness=0:i.lineColor=Pt(Ft.Ei),o){this.isTitleForAxisRequired(e,o)&&(i.title=Gt.getTitleForAxis(o));const t=o.linearValueScale;!!t&&"includeZero"===t.zeroPolicy&&(i.linearValueScale={...i.linearValueScale,zeroPolicy:"IncludeZero"})}if(this.shouldSetupIntervals(e,n)){const t=(0,kt.Q)(e,0,n).values.raw;i.intervalsScale=Gt.getIntervalsScale(t),i.tickLabels={show:!1}}if(t.isHundredPercent?(i.units="Percentage",i.linearValueScale={...i.linearValueScale,autoBufferRatio:0}):r&&r.languageUnitsValue!==Lt.YO.None&&(i.units=r.languageUnitsValue),(0,kt.$)(n)){const a=(0,$t.r)(e,n,t.axisGroup);a&&a.max<=0&&0!==a.min&&(i.axisCrossType="Maximum")}if(o?.reversePlotOrder&&(i.reverseDirection=!0,i.axisCrossType="Maximum"),"categories"===n&&(0,Nt.q3)(e.series)&&!this.shouldSetupIntervals(e,n)&&(i.reverseDirection=!0),(0,Nt.tJ)(e.series)&&(0,kt.$)(n)){const a=!!o&&!!o.linearValueScale&&"includeZero"===o.linearValueScale.zeroPolicy,r=(0,Nt.ps)(e,n,t.axisGroup,a);r&&(i.linearValueScale={...i.linearValueScale,maximum:r.maximum,minimum:r.minimum})}return i}))}static getIntervalsScale(e){const t=e.reduce(((e,t)=>Math.min(e,t)),Number.MAX_VALUE);return{plotLevel:0,manualLevels:[{start:Math.floor(t),intervals:qt(e)}]}}areTickLabelsAppropriate(e,t){const a="categories"===t.dimension;if(a&&"histogram"===e.series[0].layout)return!1;const n=Gt.getCategoryCountForSeries(e.data,e.series[0]);if(!this.options.showHierarchicalCategoryTickLabels&&a&&n>this.options.maxCategoryLabels)return!1;const o=a&&-1===n,r=Gt.isDateDimension(e,"categories");return!(0,Nt.tJ)(e.series)||!o&&!r}isTitleForAxisRequired(e,t){const a=this.options.allowDateAxis&&"categories"===t.dimensionType&&Gt.isDateDimension(e,"categories"),n="secondary"===t.axisGroup?(0,Ot.ip)(e).secondary.insightsType:(0,Ot.ip)(e).primary.insightsType,o=(0,_t.C$)(n,t.dimensionType),r=this.areTickLabelsAppropriate(e,o),i=(0,kt.$)(t.dimensionType),l=e.axes.filter((e=>(0,kt.$)(e.dimensionType))).length;return!(!(this.options.showAxisTitles||a||this.options.showAxisLabels&&!r||this.options.showAxisLabels&&i&&l>1)||!t.title)}static getTitleForAxis(e){return{text:e.title&&(0,Bt.HK)(e.title,30),textFaceName:Ft.e0,textPointSize:Ft.Wn,textColor:Pt(Ft.Yg)}}getTickLabelsForAxis(e,t){const a=!!this.options.showAxisLabels&&this.areTickLabelsAppropriate(e,t),n="categories"===t.dimension,o="secondary"===t.axisGroup,r={show:a,allowAdvancedLayout:this.options.showHierarchicalCategoryTickLabels,textFaceName:Ft.e0,textPointSize:Ft.QN,textColor:Pt(Ft.Yg)},i=(0,Ot.ip)(e).primary.insightsType;if(a&&!n&&!t.isHundredPercent&&"histogram"!==i){const a=e.series.findIndex((e=>o?"secondary"===e.valueAxisGroup:"secondary"!==e.valueAxisGroup)),n=(0,kt.Q)(e,a,t.dimension);n?.formatInfo&&(r.numberFormat=n.formatInfo.format)}return r}shouldSetupIntervals(e,t){if(!this.options.allowDateAxis||!Gt.isDateDimension(e,t))return!1;return(0,kt.Q)(e,0,t).values.raw.every((e=>"number"==typeof e))}static isDateDimension(e,t){const a=(0,kt.Q)(e,0,t);if(!a)return!1;const n=!!a.formatInfo&&a.formatInfo.isDateTime;return"categories"===t&&n}static getCategoryCountForSeries(e,t){const a=t.dataBindings.find((e=>"categories"===e.dimensionType));if(!a)return-1;const n=e.dimensions.find((e=>e.id===a.dimensionId));return n?n.values.raw.length:-1}constructor(e){this.options=e}}var Wt=a(57516),zt=a(63789),Qt=a(62646);class Jt{createSeries(e){return this.getSeriesForChart(e)}getSeriesForChart(e){const t=this.options.allowDateAxis&&Jt.hasDateDimension(e),a=[...e.series],n=a.some((e=>null!=e.highlightStyleIndex));return a.map(((o,r)=>{const i=o.exceptions&&o.exceptions.length>0,{hasDataMarkers:l,isLine:s,isPie:c}=(0,zt.Y)(o.layout);let d={id:`Series${r}`,title:this.getTitleForSeries(o,e.data),layout:(0,Ot.Pg)(o.layout).ivyLayout,data:this.getDataForSeries(o,e.data)};if((0,Nt.tJ)(e.series))switch(o.valueAxisGroup){case"primary":d.boundAxes=[0,1];break;case"secondary":d.boundAxes=[0,2];break;default:(0,X.c)(o.valueAxisGroup)}if("histogram"===o.layout&&(d.fillColor=Pt(Ft.w8)),(l||i&&s)&&(d.dataMarkers=Jt.getDataMarkersForSeries(o,n)),o.trendlines&&o.trendlines.length>0){"linear"===o.trendlines[0].trendType&&(d.trendLines=Jt.getTrendlinesForSeries(o,n))}if(n){const e=null!=o.highlightStyleIndex?Ft.hr[o.highlightStyleIndex]:Ft.wm;s?d.lineColor=Pt(e):d.fillColor=Pt(e)}if(i&&(s?d.lineColor=Pt(Ft.Zx):(d.exceptionalDatapoints=Jt.getExceptionsForSeries(o),d.fillColor=Pt(Ft.Zx))),(0,Qt.o_)(o,["highlightedLineSegments"])&&o.highlightedLineSegments.length>0&&(d.lineColor=Pt(Ft.Zx),d.exceptionalDatapoints=Jt.getExceptionalDatapointsForSeries(o)),s?d.lineThickness=2:c?(d.lineColor=Pt(Ft.ON),d.lineThickness=1):(d.lineColor=Pt(Ft.ON,0),d.lineThickness=1),t&&void 0!==d.data.categoryValues&&(d=(0,Wt.Lt)(d,"categoryValues",Wt.V0)),"Line"===d.layout&&(d=(0,Wt.jx)(d)),(0,Nt.q3)(a)){const e=void 0===d.data.categoryNames;e&&(d.data.categoryNames=(d.data.values||[[]]).map((e=>e.map(((e,t)=>t.toString()))))),d=(0,Wt.Lt)(d,"categoryNames",Wt.Hw),e&&(d.data.categoryNames=void 0)}return d}))}getTitleForSeries(e,t){const a=e.dataBindings.find((e=>"title"===e.dimensionType));if(a){const e=t.dimensions.find((e=>e.id===a.dimensionId));if(e)return e.values.strings[0]}}getDataForSeries(e,t){if("histogram"===e.layout)return this.getHistogramData(e,t);return e.dataBindings.reduce(((e,a)=>{switch(a.dimensionType){case"categories":{const n=this.getDimensionForSeries(t,a);if(this.options.showHierarchicalCategoryTickLabels&&n.categoryNames&&1===n.categoryNames.length){if(n.categoryNames[0].every((e=>""===e)))return e;{const t=e.categoryNames?e.categoryNames:[];return t.unshift(n.categoryNames[0]),{...e,categoryNames:t}}}return{...e,...n}}case"values":case"xValues":case"yValues":return{...e,...this.getDimensionForSeries(t,a)};case"title":return e;default:throw new Error("Unrecognized dimension.")}}),{})}getDimensionForSeries(e,t){const a=t.dimensionId,n=e.dimensions.find((e=>e.id===a));if(!n)throw new Error("Invalid dimension.");const o=this.getDimensionName(n,t),r=this.getDimensionValues(n,t);return this.options.maxDatapoints<0?{[o]:[r]}:{[o]:[r.slice(0,this.options.maxDatapoints)]}}getDimensionName(e,t){if("categories"===t.dimensionType){const t=e.formatInfo,a=!!t&&t.isDateTime&&!(0,ye.Xw)(t.format),n=e?.values.raw&&!e.values.raw.some((e=>"number"!=typeof e));return this.options.allowDateAxis&&a&&n?"categoryValues":"categoryNames"}return t.dimensionType}getDimensionValues(e,t){const a="categoryNames"===this.getDimensionName(e,t)?e.values.strings:e.values.raw;switch(t.dimensionType){case"categories":case"title":return a;case"values":case"xValues":case"yValues":return a.map((e=>null===e||""===e?"NaN":e));default:throw new Error("Unrecognized dimension.")}}getHistogramData(e,t){const a="values",n=(0,Wt.Mi)(e,t);return this.options.maxDatapoints<0?{[a]:[n]}:{[a]:[n.slice(0,this.options.maxDatapoints)]}}static hasDateDimension(e){return e.series.some((t=>t.dataBindings.some((t=>{if("categories"!==t.dimensionType)return!1;const a=t.dimensionId,n=e.data.dimensions.find((e=>e.id===a)),o=n.formatInfo,r=!!n&&n.values?.raw&&!n.values.raw.some((e=>"number"!=typeof e));return o?.isDateTime&&r&&!(0,ye.Xw)(o.format)}))))}static getDataMarkersForSeries(e,t){const a=e.exceptions&&e.exceptions.length>0,n=(0,zt.Y)(e.layout).hasDataMarkers,o={defaultSize:0};return t&&(null!=e.highlightStyleIndex?o.fillColor=Pt(Ft.hr[e.highlightStyleIndex]):o.fillColor=Pt(Ft.wm)),n&&(o.defaultSize=Ft.iR,o.lineColor=Pt(Ft.ON),a&&(o.fillColor=Pt(Ft.Zx))),a&&(o.exceptionalDataMarkers=Jt.getExceptionalDataMarkersForSeries(e)),o}static getExceptionalDataMarkersForSeries(e){const t=(0,zt.Y)(e.layout).hasDataMarkers?Ft.iR:Ft.r$;return e.exceptions.map((e=>({index:e,size:t,fillColor:Pt(Ft.SB),lineColor:Pt(Ft.ON)})))}static getExceptionsForSeries(e){return e.exceptions.map((e=>({index:e,fillColor:Pt(Ft.SB),lineColor:Pt(Ft.ON),lineThickness:1})))}static getExceptionalDatapointsForSeries(e){return e.highlightedLineSegments.map((e=>({index:e+1,lineColor:Pt(Ft.SB),lineThickness:Ft.kd})))}static getTrendlinesForSeries(e,t){const a=e.exceptions&&e.exceptions.length>0,n=!!e.highlightedLineSegments&&e.highlightedLineSegments.length>0,o={lineThickness:Ft.yX,lineDashStyle:Ft.Vs};return t&&(null!=e.highlightStyleIndex?o.lineColor=Pt(Ft.hr[e.highlightStyleIndex]):o.lineColor=Pt(Ft.wm)),(a||n)&&(o.lineColor=Pt(Ft.Zx)),[o]}constructor(e){this.options=e}}class jt{render(e,t){return{...jt.getEmptyChart(),series:new Jt(this.options).createSeries(e),axes:new Gt(this.options).createAxes(e),locale:t,legend:e.showLegend?{position:{edge:"Bottom"}}:void 0}}static getDefaults(){return{allowDateAxis:!0,showAxisLabels:!1,showAxisTitles:!0,maxCategoryLabels:6,maxDatapoints:-1,minRangeForValueLabels:0,showHierarchicalCategoryTickLabels:!1}}static getEmptyChart(){return{series:[],size:{width:300,height:200},lineThickness:0}}constructor(e={}){this.options={...jt.getDefaults(),...e}}}var Yt=a(56229),Xt=a(24910);class Kt extends b.Component{layoutChart(){const e=T.imT,t=this.chartRef.clientWidth,a=t*e;if((0,le.yw)("OfficeVSO_9545031_FixAriaLabelForChartPreviews")){const e={attributes:!0,childList:!0,characterData:!0},t=()=>{const e=this.chartRef?.querySelector("svg");e&&(e.setAttribute("focusable","false"),e.setAttribute("role","img"),e.setAttribute("aria-label",(0,Yt.Z_)(this.props.recommendation,!1)),(0,le.yw)("OfficeVSO_8691849_CopilotChartToImage")&&e.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.props.onChartRendered?.((0,le.yw)("OfficeVSO_9417957_AnalyzeDataHandleInvalidCharacter")?Zt(e):`data:image/svg+xml;base64,${btoa(e.outerHTML)}`)),this.observer.disconnect()};this.observer=new MutationObserver(t),this.observer.observe(this.chartRef,e)}this.chartSettings.size.width!==t&&this.updateAxesSettings(t,e),this.chartSettings.size={width:t,height:a},this.host.setConfiguration(this.chartSettings)}createChartSettings(){const e=this.props.recommendation.visual;this.chartRenderOptions={allowDateAxis:"ChartVisual"===e.visualType,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:this.props.maxDataPoints,showHierarchicalCategoryTickLabels:!1};return new jt(this.chartRenderOptions).render(e.chart)}updateAxesSettings(e,t){const a=Math.floor((e-300)*t/20+6),n=Math.max(a,0);if(n!==this.chartRenderOptions.maxCategoryLabels&&this.chartSettings.axes){this.chartRenderOptions.maxCategoryLabels=n;const e=this.props.visual;Gt.updateAxesTickLabels(e.chart,"PivotChartVisual"===e.visualType,this.chartSettings.axes,this.chartRenderOptions.maxCategoryLabels,!!this.chartRenderOptions.showHierarchicalCategoryTickLabels&&this.chartRenderOptions.showHierarchicalCategoryTickLabels)}}componentDidMount(){const e=`${(0,g.wF)()}/v3.0`,t={cycleColors:this.props.themeColors,type:n.Cycle},a=new l({base:e,clientId:(0,g.fp)()},t);this.resizeObserver=new Xt.A((0,m.debounce)((([e])=>{if(e){if(!(0,le.yw)("OfficeVSO_9545031_FixAriaLabelForChartPreviews")){const t=e.target.querySelector("svg");t&&(t.setAttribute("focusable","false"),t.setAttribute("role","img"),t.setAttribute("aria-label",(0,Yt.Z_)(this.props.recommendation,!1)),(0,le.yw)("OfficeVSO_8691849_CopilotChartToImage")&&t.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.props.onChartRendered?.((0,le.yw)("OfficeVSO_9417957_AnalyzeDataHandleInvalidCharacter")?Zt(t):`data:image/svg+xml;base64,${btoa(t.outerHTML)}`))}this.layoutChart()}}),1e3)),this.host=new i.ChartHost(a,this.ivySettings,this.chartRef),this.host.on("error",((e,t)=>{u.M.getInstance().logErrorCode(s.O.IvyWebFailure,new Error(t),d.S.AnalyzeDataError,c.$b.ASHA)})),this.chartSettings=this.createChartSettings(),this.layoutChart(),this.resizeObserver.observe(this.chartRef)}componentWillUnmount(){this.resizeObserver.unobserve(this.chartRef),this.host.on("error",null),this.host=void 0}render(){return b.createElement("div",{className:"chart",ref:e=>{this.chartRef=e}})}constructor(...e){super(...e),this.chartRenderOptions={},this.ivySettings={disableChartElementResize:!0,renderer:i.IvyRenderer.Svg}}}function Zt(e){try{return`data:image/svg+xml;base64,${btoa(e.outerHTML)}`}catch(t){if("InvalidCharacterError"===t.name)return`data:image/svg+xml,${encodeURIComponent(e.outerHTML)}`;throw u.M.getInstance().logError({eventType:d.S.ChatEvents,errorMessage:`getSvgDataUrl: Failed to convert SVG to data URL: ${t?.message}`,logLevel:c.$b.Critical}),t}}var ea=a(88700),ta=a(61150),aa=a(53463),na=a(62982);const oa=4;function ra(e){const{value:t}=e;if(t.toString().length<=3)return b.createElement(b.Fragment,null,t.toString());const a=function(e){const t=Math.min(Math.max(e.toString().length-e.toFixed(0).length-1,0),oa);return t>0?{isFullEllipsis:!1,fractionDecimalLength:t,cacheKey:`true${t}`}:{isFullEllipsis:!0,fractionDecimalLength:0,cacheKey:"false0"}}(t);return b.createElement(aa.A,{data:{fractionDecimalLength:-1,isFullEllipsis:!1,cacheKey:"true-1"},onRenderData:e=>{const a=(0,na.Fl)(t,e.isFullEllipsis,e.fractionDecimalLength);return b.createElement(b.Fragment,null,a)},onReduceData:e=>-1===e.fractionDecimalLength?a:0===e.fractionDecimalLength?e.isFullEllipsis?void 0:{isFullEllipsis:!0,fractionDecimalLength:0,cacheKey:"false0"}:{fractionDecimalLength:e.fractionDecimalLength-1,isFullEllipsis:!1,cacheKey:"true"+(e.fractionDecimalLength-1)}})}var ia=a(1690);const la={header:{backgroundColor:w.k1.lightBlue},grandTotal:{backgroundColor:w.k1.lightBlue}},sa=(0,R.n)(la);var ca,da;function ua(e){const{cellType:t,className:a,isHighlightCell:n,colspan:o,isEllipsisBodyCell:r,isRowLabelsColumn:i}=e,{value:l,isNumber:s,indent:c}=e.value,d=sa();let u;u="number"==typeof l&&"Header"!==t?b.createElement(ra,{value:l}):l?.toString()||"";const m=[`${a}__text`];switch(!s&&!r||i||m.push(`${a}__right-aligned`),n&&m.push(`${a}__highlight-cell`),t){case"Header":{m.push(`${a}__header`);const e=o>0?o:void 0;return b.createElement("th",{colSpan:e,className:(0,D.z)(d.header,m.join(" "))},u)}case"Body":m.push(`${a}__body`);break;case"SubTotal":m.push(`${a}__subtotal`);break;case"GrandTotal":m.push(`${a}__grand-total`);break;default:(0,ia.x)(t)}const g=c>0?{textIndent:10*c+"px"}:void 0;let h;return h="GrandTotal"===t?(0,D.z)(d.grandTotal,m.join(" ")):m.join(" "),b.createElement("td",{className:h,style:g},u)}!function(e){e.Header="Header",e.Body="Body",e.GrandTotal="GrandTotal",e.SubTotal="SubTotal"}(ca||(ca={})),function(e){e.PivotTable="PivotTable",e.QueryResult="QueryResult"}(da||(da={}));class ma extends b.Component{getRowCount(){switch(this.props.type){case"PivotTable":return(this.props.pivotTable.pivotTableData[0]||[]).length;case"QueryResult":return 0===this.props.data.fields.length?Vt.mz:Math.min(this.props.data.fields[0].values.strings.length+1,Vt.m6);default:return(0,X.x)(this.props)}}getColumnCount(){switch(this.props.type){case"PivotTable":return this.props.pivotTable.pivotTableData.length;case"QueryResult":return this.props.data.fields.length;default:return(0,X.x)(this.props)}}getColGroup(e){const t=this.getColumnCount(),a=[];for(let n=0;n<t;n++){const t={width:this.state.colWidths[n],visibility:this.state.collapseColIndex>0&&n>=this.state.collapseColIndex?"collapse":void 0};a.push(b.createElement("col",{key:`${n}-${e}`,id:`${e}Col${n}`,style:t}))}return b.createElement("colgroup",null,a)}getTableCell(e,t,a,n,o,r=0,i=!1){return b.createElement(ua,{value:e,className:this.props.className,key:t,cellType:a,colspan:r,isHighlightCell:n,isEllipsisBodyCell:i,isRowLabelsColumn:o})}static getBlankPreviewTable(e){return b.createElement("div",{className:"preview-table__no-values"},e?T.xe2.NoValueAnswerTextForNLInsight:T.xe2.NoValueAnswerTextForIdeas)}renderPivotTable(e){const{pivotTableData:t,grandTotalRowIndex:a,subTotalRowIndices:n,highlightCellReferences:o}=e;if(t&&0===t.length)return ma.getBlankPreviewTable(!1);const r=!!n&&n.length>1,i=(0,Vt.HF)(e),l=t[0].map(((e,a)=>t.map((e=>e[a])))),s=e.rowFields.length>=1,c=l.slice(0,i).map(((e,t)=>{const a=i>1&&0===t,n=e.map(((n,r)=>{const i=o?.some((e=>t===e.row&&r===e.column));if(a&&1===r){const t=e.length-1;return this.getTableCell(n,r,ca.Header,i,!1,t)}return a&&r>1?void 0:this.getTableCell(n,r,ca.Header,i,s&&0===r)}));return b.createElement("tr",{key:t},n)})),d=(()=>{const e=[],t=l.slice(i,a);let c=0;for(let a=0;a<t.length;a++){const l=!!n&&n.length>0&&n.some((e=>e===a+i));c=l?0:c+1;const d=[],u=t[a];if(!(!l&&c>3&&r)){for(let e=0;e<u.length;e++){const t=o?.some((t=>a+i===t.row&&e===t.column));l?d.push(this.getTableCell(u[e],e,ca.SubTotal,t,s&&0===e)):3===c&&r?d.push(this.getTableCell({value:"...",isNumber:!1,indent:0},e,ca.Body,!1,s&&0===e,void 0,!0)):d.push(this.getTableCell(u[e],e,ca.Body,t,s&&0===e))}e.push(b.createElement("tr",{key:a+i,className:l?`${this.props.className}__subtotal-row`:""},d))}}return e})(),u=d.length>0?b.createElement("tbody",null,d):null,m="number"==typeof a?l.slice(a).map((e=>{const t=e.map(((e,t)=>this.getTableCell(e,t,ca.GrandTotal,!1,s&&0===t)));return b.createElement("tr",{key:a},t)})):[],g=m.length>0?b.createElement("tfoot",null,m):null,h=this.getColGroup("PivotTable");return b.createElement("table",{className:`${this.props.className}__table`,ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},h,b.createElement("thead",null,c),u,g)}renderQueryResult(e){if(0===e.fields.length)return ma.getBlankPreviewTable(!0);if(0===e.fields[0].values.raw.length)return ma.getBlankPreviewTable(!1);const t=e.fieldHeaders.map(((e,t)=>{const a=e.runs.map((e=>e.text)).join("");return b.createElement(ua,{className:"query-result",value:{value:a,isNumber:!1,indent:0},key:t,cellType:ca.Header,isEllipsisBodyCell:!1,isRowLabelsColumn:!1})})),a=t.length>0?b.createElement("thead",null,b.createElement("tr",null,t)):null,n=this.getRowCount()-1,o=[];for(let t=0;t<n;t++){const a=[];for(let n=0;n<this.getColumnCount();n++)if(e.fields[n].values.formattedValues){const o=e.fields[n].values.formattedValues[t];a.push(b.createElement(ua,{value:o,className:"query-result",key:n,cellType:ca.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1}))}else{const o=e.fields[n].values.strings[t],r=e.fields[n].values.raw[t],i=o||r;a.push(b.createElement(ua,{className:"query-result",value:{value:i,isNumber:!1,indent:0},key:n,cellType:ca.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1}))}o.push(b.createElement("tr",{key:t},a))}const r=this.getColGroup("QueryResult");return b.createElement("table",{className:"query-result__table",ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},r,a,b.createElement("tbody",null,o))}getRawWidth(){this.rawTableWidth=this.tableRef.scrollWidth;const e=this.tableRef.getElementsByTagName("tr"),t=e.item(e.length-1).children;this.rawColumnsWidth=[];for(let e=0;e<t.length;e++)this.rawColumnsWidth.push(t.item(e).scrollWidth)}restyleTable(){const e=this.getColumnCount(),t=this.tableContainerDivRef.getBoundingClientRect().width,a=this.getColWidthsLoad(t,e),n=this.getCollapseColIndexLoad(t,e),o=this.getTableLayoutFixed(t,e);this.setState({colWidths:a,collapseColIndex:n,tableWidth:"100%",tableLayoutFixed:o})}getColWidthsLoad(e,t){const a=new Array(t);if(2===t){if(this.rawColumnsWidth[0]<=.5*e&&this.rawColumnsWidth[1]<=.5*e)return["50%","50%"];if(this.rawTableWidth>e){if(this.rawColumnsWidth[0]/e<=.67){const t=this.rawColumnsWidth[0]/e;return[`${t.toLocaleString("en",{style:"percent"})}`,`${(1-t).toLocaleString("en",{style:"percent"})}`]}return["67%","33%"]}}if(t>2){if(Math.max(...this.rawColumnsWidth)<=e/t)for(let e=0;e<a.length;e++)a[e]=`${(1/t).toLocaleString("en",{style:"percent"})}`;else if(this.rawTableWidth<=e)for(let e=0;e<a.length;e++)a[e]=`${(this.rawColumnsWidth[e]/this.rawTableWidth).toLocaleString("en",{style:"percent"})}`;else{if(!(this.rawColumnsWidth[0]+this.rawColumnsWidth[1]<=.75*e)){const t=.5,a=.75,n="25%";if(this.rawColumnsWidth[0]<=e*t){const t=this.rawColumnsWidth[0]/e;return[`${t.toLocaleString("en",{style:"percent"})}`,`${(a-t).toLocaleString("en",{style:"percent"})}`,n]}return["50%","25%","25%"]}{let t=0,n=e;for(;n>0;)a[t]=n-this.rawColumnsWidth[t]>0?`${(this.rawColumnsWidth[t]+1).toString()}px`:`${n.toString()}px`,n-=this.rawColumnsWidth[t]+1,++t}}}return a}getCollapseColIndexLoad(e,t){if(t>2&&this.rawTableWidth>e){if(this.rawColumnsWidth[0]+this.rawColumnsWidth[1]>.9*e)return 3;{let t=0,a=e;for(;a>0;)a-=this.rawColumnsWidth[t]+1,++t;return t}}return-1}getTableLayoutFixed(e,t){return!(Math.max(...this.rawColumnsWidth)>e/t&&this.rawTableWidth<=e)}componentDidMount(){this.tableRef&&(this.getRawWidth(),this.restyleTable(),this.resizeObserver.observe(this.tableContainerDivRef))}componentWillUnmount(){this.tableRef&&this.resizeObserver.unobserve(this.tableContainerDivRef)}renderTable(){switch(this.props.type){case"PivotTable":return this.renderPivotTable(this.props.pivotTable);case"QueryResult":return this.renderQueryResult(this.props.data);default:return(0,X.x)(this.props)}}getEllipsisRow(){const e=this.getColumnCount(),t=[],a="PivotTable"===this.props.type&&this.props.pivotTable.rowFields.length>=1;for(let n=0;n<e;n++)t.push(b.createElement(ua,{className:this.props.className,value:{value:"...",isNumber:!1,indent:0},cellType:ca.Body,isHighlightCell:!1,key:n,isEllipsisBodyCell:!0,isRowLabelsColumn:a&&0===n}));return b.createElement("tr",null,t)}renderEllipsis(){const e=this.getColGroup("Ellipsis"),t=this.getEllipsisRow();return b.createElement("div",{className:`${this.props.className}__ellipsis`,"aria-hidden":!0},b.createElement("table",{className:`${this.props.className}__table`,style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0}},e,b.createElement("tbody",null,t)))}render(){const e=Math.ceil(3*this.props.windowWidth/5)-40,t=Math.floor(e/22),a=22*t;return b.createElement("div",null,b.createElement("div",{className:this.props.className,style:{maxHeight:a},ref:e=>{this.tableContainerDivRef=e}},this.renderTable()),this.getRowCount()>t?this.renderEllipsis():null)}constructor(e){super(e),this.state={colWidths:new Array(this.getColumnCount()),collapseColIndex:-1,tableWidth:"",tableLayoutFixed:!1},this.resizeObserver=new Xt.A((e=>{e.forEach((()=>{this.restyleTable()}))}))}}var ga=a(9124),ha=a(72277),pa=a(40700),ba=a(85105);const fa=3,Ca=5,ya=30;function va({textAnalysis:e,title:t,tableContext:a,textColumn:n}){const o=(0,le.iP)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1),r=e.textAnalysisResult.bulletList,i=o&&r&&n?function(e,t,a,n){const o=e.sheetRange.range.topLeft;if(null===o.column||null===o.row)throw new Error("unexpected range. The supported range should be a limited one.");const r=e.sheetRange.sheet,i=o.column+t.left+1,l=o.row+t.top+1,s=a.map((e=>function(e,t,a,n){const o=e=>`${t}!${(0,ba.LM)(a+e,n)}`;return e.map(o)}(e.reference,r,l,i)));if(n.length<=0)return;return s.map(((e,t)=>{const o=t+1,r=function(e){if(e.length<=0)return"";try{let t=e[0].split("!")[0];return e.length<=fa?t+=` ${e.map((e=>e.split("!")[1])).join(", ")}`:(t+=` ${e[0].split("!")[1]}`,t+=" ...",t+=` ${e[e.length-1].split("!")[1]}`),t}catch{return""}}(e),i=function(e,t,a){if(!e||!t||!a||e.length!==t.length)return"";const n=e=>e.length>ya?`${e.slice(0,ya-3)}...`:e;try{let o="";return t.length<=Ca?t.map(((t,r)=>{o+=`${e[r].split("!")[1]}: ${n(a[t])}\n`})):(t.slice(0,Ca-2).map(((t,r)=>{o+=`${e[r].split("!")[1]}: ${n(a[t])}\n`})),o+="...\n",o+=`${e[e.length-1].split("!")[1]}: ${n(a[t[t.length-1]])}`),o.replace(/\n$/,"")}catch{return""}}(e,a[t].reference,n);return{referenceIndex:o,referenceProps:{title:r,primarySubtitle:(0,T.wzu)(),snippet:i,iconAppName:ha._R.Excel,referenceType:ha._2.Internal,onClickCitationLink:xa,path:e}}}))}(a,e.textAnalysisResult.columnReference,r,n):[],l=r&&r.length>0?b.createElement("ul",{className:"recommendation__text-analysis_bullet-list"},r.map(((e,t)=>b.createElement("li",{key:t},b.createElement("span",{className:"recommendation__text-analysis__bullet-header"},e.title,":"," "),b.createElement("span",{className:"recommendation__text-analysis__bullet-description"},e.description),o&&i?.length===r.length?b.createElement(ga.A,{...i[t],key:t}):null)))):void 0,s=e.textAnalysisResult.generalResponse?b.createElement("div",{className:"recommendation__text-analysis__generalResponse",style:{paddingTop:"50%"}},e.textAnalysisResult.generalResponse):void 0,c=l||s;return b.createElement("div",{className:"recommendation__text-analysis"},b.createElement(Ta,{title:t}),c)}const Ta=({title:e})=>{const t=e?.runs.map((e=>e.text)).join(" ")??"";return b.createElement("div",{className:"recommendation__text-analysis__title"},b.createElement("span",null,t))};const xa=async(e,t,a)=>{(0,ta.cY)(`onClickCitationLink called with referenceId : ${e}, and telemetryData : ${a}`),(0,pa.z)()&&(void 0!==t&&t.length>0&&await pa.g.getInstance().highlightWithDuration(t,T.Lii),u.M.getInstance().logCitationOnClickEvent())};var Sa=a(78640),wa=a(89791),Ea=a(18541),Ra=a(94836);const Ia={recommendationTitle:{backgroundColor:w.k1.neutralLight,color:w.k1.black},recommendationSubtitle:{color:w.k1.black}},Aa=(0,R.n)(Ia);function La({visual:e,tableName:t,requestId:a,tableContext:n,chartImageUrl:o}){const r=(0,ve.j)(),i=(0,xe.d4)((e=>e.selection.interpretations[t])),l=(0,xe.d4)((e=>e.chat.showLoadingUI)),s=(0,le.yw)("OfficeVSO_8691849_CopilotChartToImage")&&o?.startsWith("data:image")?b.createElement("div",{className:"recommendation__chart",style:{paddingTop:0}},b.createElement("img",{alt:"Chart",src:o})):b.createElement(_a,{recommendationVisual:e,tableContext:n,onChartRendered:(0,le.yw)("OfficeVSO_8691849_CopilotChartToImage")?t=>function(e,t){try{pt.$.getInstance().resendChatHistorySignal(t,(t=>function(e,t){if(!e.richTextJson)return void o("message has no richTextJson");const a=JSON.parse(e.richTextJson),n=a?.body?.renderData;if(!n)return void o("message has no renderData");if("AnalyzeData_V1"!==n.component)return void o(`Unsupported message component: ${n.component}`);return H.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.ChatHistoryImageResendEvent,[c.h3.ChatEventParameters]:JSON.stringify({featureName:c.q.CopilotChat,eventType:c.a5.ChatHistoryImageResendEvent})},u.M.getInstance()),n.props.chartImageUrl=t,delete n.props.visual.visual,{...e,richTextJson:JSON.stringify(a),images:[t],messageId:(0,wt.A)()};function o(e){(0,ta.cY)(ta.SA.Error,"Error while resending chat history signal with an image",e),H.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.q0.ChatHistoryImageResendFailed,[c.h3.ChatEventParameters]:JSON.stringify({featureName:c.q.CopilotChat,eventType:c.a5.ErrorMessage,errorType:c.q0.ChatHistoryImageResendFailed})},u.M.getInstance())}}(t,e)))}catch(e){(0,ta.cY)("Error while resending chat history signal with an image",e)}}(t,e.id):void 0}),m=[],g=(0,le.iP)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1),h=(0,b.useCallback)((()=>{if(g&&"TextAnalysisVisual"===e.visual?.visualType&&e.visual.textAnalysisResult.bulletList){const{header:t,values:a}=(0,Ea.RU)(e.visual.textAnalysisResult);r(Sa.mF.showPreviewData(a.map((e=>e.map((e=>null===e?"":e.toString())))),t,n))}}),[e,n,r]),f=(0,b.useCallback)((()=>{g&&"TextAnalysisVisual"===e.visual?.visualType&&e.visual.textAnalysisResult.bulletList&&r(Sa.mF.hidePreviewData(n))}),[e,n,r]);if((0,ba.VV)(e,i)||m.push({...(0,p.r1)("ChartVisual"===e.visual.visualType||"TextAnalysisVisual"===e.visual.visualType?(0,T.zVb)():(0,T.W4k)()),handleButtonOnClick:()=>Promise.resolve(r(Sa.mF.insertRecommmendation(t,e,n))),handleOnMouseEnter:h,handleOnMouseLeave:f,isDisabled:l}),!(0,ba.fB)(e)){const t=e.visual.textAnalysisResult?.generalResponse??"",a=new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),n={actionType:c.he.CopyMessageClicked,source:c.KZ.InsightsApi,featureName:c.q.AnalyzeData,userQueryGuid:u.M.userQueryGuid};m.push({buttonTitle:T.xxz.CopyButtonLabel,buttonText:T.xxz.CopyButtonLabel,icon:(0,Ra.dD)()?b.createElement(ea.c2D,null):b.createElement(ea.Jg_,null),handleButtonOnClick:()=>(0,ie.Kv)(a,d.S.AnalyzeDataError,n),isDisabled:l})}return b.createElement(p.lJ,{contentBody:b.createElement(b.Fragment,null,"TextAnalysisVisual"!==e.visual?.visualType?b.createElement(Na,{title:e?.title,subtitleText:(0,wa.g)(e,!1),tableName:n.address}):void 0,s),cardButtons:m,requestId:a})}const Fa=e=>{if(e&&"PivotChartVisual"===e.visual.visualType){if(!(1===e.visual.pivotTable.rowFields.length))return-1;const t=(0,Ot.ip)(e.visual.chart),a=[t.primary.datapointLimit];t.secondary&&a.push(t.secondary.datapointLimit);const n=a.filter((e=>-1!==e));return 0===n.length?-1:Math.min(...n)}},_a=({recommendationVisual:e,tableContext:t,onChartRendered:a})=>{const n=e.visual,o=(0,xe.d4)((e=>e.selection.themeColors));switch(n.visualType){case"PivotChartVisual":case"ChartVisual":{const t=`${T.Xxp}%`;return b.createElement("div",{className:"recommendation__chart",style:{paddingTop:t}},b.createElement(Kt,{visual:n,"aria-live":"assertive",recommendation:e,maxDataPoints:Fa(e),onChartRendered:a,themeColors:o}))}case"PivotTableVisual":{const e=n.pivotTable.pivotTableData,t=e&&0===e.length?"recommendation__empty-pivot-table":"recommendation__pivot-table";return b.createElement("div",{className:t},b.createElement(ma,{"aria-live":"assertive",pivotTable:n.pivotTable,className:"pivot-table-light16",windowWidth:window.innerWidth,type:da.PivotTable}))}case"BlankPivotTable":return null;case"QueryResultVisual":return b.createElement("div",{className:"recommendation__query-result"},b.createElement(ma,{"aria-live":"assertive",className:"query-result",windowWidth:window.innerWidth,type:da.QueryResult,data:n.result,formula:n.query}));case"ForecastVisual":return b.createElement(b.Fragment,null,b.createElement("div",{className:"recommendation__chart"},b.createElement(Kt,{visual:n,"aria-live":"assertive",recommendation:e,maxDataPoints:Fa(e),themeColors:o})),b.createElement("div",{className:"recommendation__query-result"},b.createElement(ma,{"aria-live":"assertive",className:"query-result",windowWidth:window.innerWidth,type:da.QueryResult,data:n.previewTable})));case"TextAnalysisVisual":return b.createElement(va,{textAnalysis:n,title:e.title,tableContext:t,textColumn:e.extendedData});default:return(0,X.x)(n)}},Na=({title:e,subtitleText:t,tableName:a})=>{const n=Aa();let o;return(0,le.qm)()&&(o=(0,T.I5y)().replace("{0}",(0,lt.r)(a))),b.createElement("div",{className:"recommendation__title-group"},o&&b.createElement("p",{className:(0,D.z)(n.recommendationSubtitle,"recommendation-subtitle")},o),b.createElement("div",{className:(0,D.z)(n.recommendationTitle,"recommendation__title")},b.createElement(At,{title:e})),t&&b.createElement("p",{className:(0,D.z)(n.recommendationSubtitle,"recommendation-subtitle")},t))};function ka(e){const t=(0,ve.j)(),[a,n]=(0,b.useState)(!0);return b.createElement(p.lJ,{contentBody:function(){const e=L();return b.createElement(x.B,{className:e.cardStack},b.createElement(S.E,null,(0,T.Y9M)()),b.createElement("br",null),b.createElement(S.E,null,(0,T.O8z)()),b.createElement("br",null),b.createElement(S.E,{className:e.bulletListHeader},(0,T.teX)()),b.createElement("ul",{className:e.bulletList},b.createElement("li",{key:"first-bullet"},(0,T.vK1)()),b.createElement("li",{key:"second-bullet"},(0,T.m$v)())),b.createElement("br",null),b.createElement(S.E,null,(0,T.AS_)()))}(),requestId:e.requestId,cardButtons:a?[{buttonTitle:(0,T.yXE)(),buttonText:(0,T.yXE)(),handleButtonOnClick:()=>(n(!1),void t(bt.mF.startDataShaping(e))),icon:b.createElement(_e.Eu3,null)}]:[]})}function Oa({requestId:e,textAnalysis:t,title:a}){const n=(0,xe.d4)((e=>e.chat.showLoadingUI)),o=t.textAnalysisResult.bulletList&&t.textAnalysisResult.bulletList.length>0?b.createElement("ul",{className:"recommendation__text-analysis_bullet-list"},t.textAnalysisResult.bulletList.map(((e,t)=>b.createElement("li",{key:t},b.createElement("span",{className:"recommendation__text-analysis__bullet-header"},e.title,":"," "),b.createElement("span",{className:"recommendation__text-analysis__bullet-description"},e.description))))):void 0,r=t.textAnalysisResult.generalResponse?b.createElement("div",{className:"recommendation__text-analysis__generalResponse",style:{paddingTop:"50%"}},t.textAnalysisResult.generalResponse):void 0,i=o||(r||void 0),l=t.textAnalysisResult.generalResponse??"",s=new ClipboardItem({"text/plain":new Blob([l],{type:"text/plain"})}),m={actionType:c.he.CopyMessageClicked,source:c.KZ.InsightsApi,featureName:c.q.AnalyzeData,userQueryGuid:u.M.userQueryGuid};return b.createElement(p.lJ,{contentBody:b.createElement("div",{className:"recommendation__text-analysis"},b.createElement(Pa,{title:a}),i),cardButtons:[{buttonTitle:T.xxz.CopyButtonLabel,buttonText:T.xxz.CopyButtonLabel,icon:(0,Ra.dD)()?b.createElement(ea.c2D,null):b.createElement(ea.Jg_,null),handleButtonOnClick:()=>(0,ie.Kv)(s,d.S.AnalyzeDataError,m),isDisabled:n}],requestId:e})}const Pa=({title:e})=>{const t=e?.runs.map((e=>e.text)).join(" ")??"";return b.createElement("div",{className:"recommendation__text-analysis__title"},b.createElement("span",null,t))};function Ma(e){return null==e||("string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(Ma):"object"==typeof e&&null!==e&&(Object.keys(e).every((e=>"string"==typeof e))&&Object.values(e).every(Ma))))}const Da={AnalyzeData_V1:b.memo(La),ChartAdaptiveCard_V1:b.memo(f),InsightsInsertComplete_V1:b.memo(Ze),StartDataShaping_V1:b.memo(ka),DataShapingIntro_V1:b.memo(F),FormulaSuggestion_V2:b.memo(Ee),ChatCardHumanInTheLoop_V1:b.memo(y.AU),ChatCardListWithColorSwatch_V1:b.memo(y.uS),PythonAdaRecommendation_V1:b.memo(tt.m),PythonCalculatedColumn_V1:b.memo(ct),PythonStartAnalysis_V1:b.memo(Et),ChatCardWithConditionalFormatting_V1:b.memo(y.YV),TextAnalysis_V1:b.memo(Oa),ConditionalFormattingSuggestionCard_V1:b.memo(y.g$),PostView:b.memo(et.q),CodeAndPostView:b.memo(v.o),ImportData_V1:b.memo(Ye)},$a=b.memo((({component:e})=>((0,U.H5)((()=>{u.M.getInstance().logError({eventType:d.S.Error,errorMessage:`Missing renderer for ${e}`,logLevel:c.$b.ASHA})})),b.createElement("i",null,"Sorry, cannot display this message.")))),Ba={renderers:Da,renderFallback:e=>b.createElement($a,{component:e.component})};function Ha(e,t,a,n){if("CodeAndPostView"===e)(0,vt.rn)(t,n);else u.M.getInstance().logError({eventType:a,errorMessage:n,logLevel:c.$b.ASHA})}function Ua(e,t){if((0,ie.cY)(`customSerializableRenderer(${e})`,t),!Ma(t)){const a=`Props for ${e} are not serializable, therefore we cannot save them in the chat history and rehydrate the chat.`;(0,le.yw)("OfficeVSO_9515057_PythonRenderDataPropsSerializationAshaError")?Ha(e,t,d.S.Error,a):u.M.getInstance().logError({eventType:d.S.Error,errorMessage:a,logLevel:c.$b.ASHA}),(0,ie.cY)(a)}return{component:e,props:t}}function qa(e,t,a,n){if(!Ma(a)||!Ma(t)){const a=`Props used to update ${e} are not serializable, therefore we cannot save them in the chat history and rehydrate the chat.`;(0,le.yw)("OfficeVSO_9515057_PythonRenderDataPropsSerializationAshaError")?Ha(e,t,n,a):u.M.getInstance().logError({eventType:n,errorMessage:a,logLevel:c.$b.ASHA})}return{component:e,props:{...t,...a}}}},25587:(e,t,a)=>{a.d(t,{Q:()=>i});var n=a(8374),o=a(55973),r=a(8520);function i(){const e=r.createElement(n.E,{animation:"wave",appearance:"translucent",style:{marginTop:4,width:"100%",height:12}},r.createElement(o.H,{size:12}));return r.createElement("div",null,e,e)}},38405:(e,t,a)=>{a.d(t,{lJ:()=>y,r1:()=>f,x8:()=>C});var n=a(29328),o=a(36199),r=a(51524),i=a(23147),l=a(50347),s=a(50751),c=a(92782),d=a(16895),u=a(658);const m=(0,c.Q)(s.eL),g={contentCard:{width:"100%",...d.Pt.margin("0"),boxShadow:"none",...d.Pt.border("0","none"),...d.Pt.borderRadius("0"),...d.Pt.padding("0")},contentHeader:{color:m.black}},h=(0,u.n)(g);var p=a(49462),b=a(8520);const f=e=>({buttonTitle:e,buttonText:e,icon:b.createElement(n.rz9,null)}),C=e=>({buttonTitle:e,buttonText:e,icon:b.createElement(o.wm0,null)});function y({requestId:e,cardButtons:t,contentBody:a,contentHeader:n,pythonUserRequestId:o}){let s=(0,p.d4)((e=>e.chat.latestRequestId))===e,c=(0,p.d4)((e=>e.chat.lastPythonQueryId));return(0,l.SA)()&&i.CP.pythonContextManager.isPythonMode&&o&&((0,l.yw)("OfficeVSO_9511880_PythonAAAddResultsInAnotherSheetBugFixes")||(c=i.CP.pythonContextManager.lastPythonUserRequestId),s=o===c),b.createElement(r.A,{body:{cardContent:{contentBody:a,contentHeader:n,cardButtons:s?t:void 0}},styles:h()})}},39504:(e,t,a)=>{a.d(t,{D:()=>f,J:()=>b});var n=a(28087),o=a(27982),r=a(31238),i=a(29328),l=a(33500),s=a(72483),c=a(5550),d=a(50347),u=a(49462),m=a(8520);const g="FormulaDev",h=(e,t)=>(0,d.yw)("OfficeVSO_9205837_formulasDevButton")&&e&&Boolean(t)&&((0,c.I_)()||(0,d.iP)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)),p=async e=>{const t={chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:l.Q9.Chat,message:`\`\`\`json\n${JSON.stringify(JSON.parse(e),null,2)}\n\`\`\``}},addCardToChatHistory:!1};s.$.getInstance().displayResponse(t)};function b(e,t){if(h(e,t))return{type:o.jA.Default,title:g,text:(0,r.dD)()?void 0:g,iconRegular:i.SFT,iconHover:i.qTo,handleButtonOnClick:async()=>{p(t)}}}function f(e){const t=(0,u.d4)((e=>e.dataAI.shouldShowFormulaDevButton));if(h(t,e))return{buttonTitle:g,buttonText:g,icon:m.createElement(i.SFT,null),handleButtonOnClick:async()=>{p(e)}}}},40702:(e,t,a)=>{a.d(t,{A:()=>g});var n=a(51378),o=a(94709),r=a(92779),i=a(73418),l=a(95674),s=a(80519),c=a(98100),d=a(67329),u=a(8520);function m(e,t,a){const n=(0,s.iM)(e)?t?(0,c.hU)(e)?a?"RecommendationSuggestionHeaderGrounded":"RecommendationAnotherSuggestionHeader":"RecommendationSuggestionMultipleColumnsHeaderGrounded":(0,c.hU)(e)?a?"RecommendationSuggestionHeader":"RecommendationAnotherSuggestionHeader":"RecommendationSuggestionMultipleColumnsHeader":t?"RecommendationFormulaSuggestionHeaderGrounded":null;return null===n?(0,r.SHb)():r.xe2[n]}const g=({recommendation:e,targetAddress:t,isMainRecommendation:a,columnLetters:o,rowNumber:r})=>(0,s.iM)(e)&&o&&t?u.createElement(p,{recommendation:e,targetAddress:t,columnLetters:o}):(0,s.cY)(e)&&o&&r&&t?u.createElement(h,{recommendation:e,targetAddress:t,columnLetters:o,rowNumber:r}):u.createElement(n.c,null,u.createElement(i.sA,{message:m(e,t,a),values:{range:t?(0,l.r)(t):"",columnLength:e.calculatedFormulas.length}})),h=({recommendation:e,targetAddress:t,columnLetters:a,rowNumber:s})=>{const d=(0,c.Z)(e),m=(0,c.XZ)(e),g=(0,l.r)(t),h=e.calculatedFormulas.reduce(((e,t)=>e+(t.insertionIndexes?.length??0)),0),p=e.allowReplacementOfExistingValue,b=m?p?"CalculatedRowsFormulaSuggestionHeaderUpdateSingular":"CalculatedRowsFormulaSuggestionHeaderSingular":p?"CalculatedRowsFormulaSuggestionHeaderUpdatePlural":"CalculatedRowsFormulaSuggestionHeaderPlural",f=d?"CalculatedRowsCellHeader":"CalculatedRowsRowHeader";return u.createElement(n.c,null,u.createElement(i.sA,{message:r.xe2[b],values:{tableRange:u.createElement(o.V,null,g),location:u.createElement(o.V,null,u.createElement(i.sA,{message:r.xe2[f],values:d?{cellAddress:a[0]+s.toString()}:{rowNumber:s.toString()}})),formulasLength:h}}))},p=({recommendation:e,targetAddress:t,columnLetters:a})=>{const s=(0,c.hU)(e),m=(0,l.r)(t),g=s?u.createElement(i.sA,{message:r.xe2.FormulaSuggestion_Header_Singular_Location,values:{columnLetter:a[0]}}):u.createElement(i.sA,{message:r.xe2.FormulaSuggestion_Header_Plural_Location,values:{columnLetters:(0,d.q)(a)}});return u.createElement(n.c,null,s?u.createElement(i.sA,{message:r.xe2.FormulaSuggestion_Header_Singular,values:{tableRange:u.createElement(o.V,null,m),location:u.createElement(o.V,null,g)}}):u.createElement(i.sA,{message:r.xe2.FormulaSuggestion_Header_Plural,values:{tableRange:u.createElement(o.V,null,m),location:u.createElement(o.V,null,g),columnLength:e.calculatedFormulas.length}}))}},5911:(e,t,a)=>{a.d(t,{M:()=>h,m:()=>p});a(97700);var n=a(38405),o=a(33851),r=a(92716),i=a(30112),l=a(90010),s=a(54738),c=a(35828),d=a(46224),u=a(50819),m=a(8520);const g=(0,m.lazy)((()=>Promise.all([a.e("monaco-editor"),a.e("vendors~MonacoReadOnly"),a.e("MonacoReadOnly")]).then(a.bind(a,79493)))),h=1;function p(e){const{requestId:t,codeExplanation:a,codeLabel:p}=e;let{code:b}=e;b=function(e){return(p?.trim()?"#"+p+"\n":"")+e}(b);const f=(0,u.E)();return m.createElement(n.lJ,{contentBody:m.createElement(s.B,{tokens:{childrenGap:8},className:(0,i.z)(f.pythonRecommendation,"python-recommendation")},m.createElement(m.Suspense,{fallback:m.createElement(l.y,null)},m.createElement(r.$,{title:"Python",content:m.createElement(g,{code:b}),getClipboardItem:()=>async function(e){let t=new ClipboardItem({"text/plain":""});try{const a=(0,d.ZK)(e,!1,h);t=new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})}),(0,o.PB)(o.L3.CopyButtonClicked,[])}catch(e){const t=(0,c.LH)();(0,c.QX)(null,t,!1)}return t}(b),explanation:a?{explanation:a}:void 0}))),requestId:t})}},50819:(e,t,a)=>{a.d(t,{E:()=>i});var n=a(50751),o=a(658);const r={pythonRecommendation:{backgroundColor:n.k1.neutralLight,color:n.k1.neutralDark}},i=(0,o.n)(r)},43371:(e,t,a)=>{a.d(t,{u:()=>l});var n=a(25587),o=a(8235),r=a.n(o),i=a(8520);const l=i.memo((({text:e,...t})=>e?i.createElement("div",{...t,dangerouslySetInnerHTML:{__html:r().sanitize(e)}}):i.createElement(n.Q,null)))},92716:(e,t,a)=>{a.d(t,{$:()=>I});var n=a(57871),o=a(88700),r=a(79689),i=a(52983),l=a(658),s=a(16895),c=a(50280),d=a(14205),u=a(98817),m=a(69109),g=a(25587),h=a(43371),p=a(91836),b=a(8520);const f=(0,l.n)({title:p.g.body1Strong,explanation:{...p.g.body1,...s.Pt.padding(0),boxSizing:"border-box","& p":{...s.Pt.margin(0)},"& ul":{...s.Pt.margin("8px","0px","0px"),paddingInlineStart:"24px"}}});function C({id:e,explanation:t}){const a=f();return t?t.isLoading?b.createElement(g.Q,null):b.createElement(h.u,{id:e,text:t.explanation,className:a.explanation}):null}var y=a(92779),v=a(18845),T=a(88179),x=a(50751),S=a(50347),w=a(83349);const E=(0,l.n)({contentCondensed:{maxHeight:"7.5em","&[data-fui-focus-visible]":{...s.Pt.outline(x.k1.strokeWidthThick,"solid",x.k1.colorStrokeFocus2),position:"relative",zIndex:1}},contentExpanded:(0,S.yw)("OfficeVSO_9320982_FixScrollBarFlickerBug")?{maxHeight:"none",scrollbarGutter:"stable"}:{maxHeight:"none"},explanationDivider:{minHeight:"2em"},header:{display:"flex",flexDirection:"row",alignItems:"center",...s.Pt.gap("4px")},footer:{display:"flex",flexDirection:"row-reverse",...s.Pt.padding(0)},footerForeground:{color:x.k1.colorNeutralForeground3,"&:hover":{color:x.k1.colorNeutralForeground2Hover},"&:hover:active":{color:x.k1.colorNeutralForeground2Pressed},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},footerForegroundDisabled:{color:x.k1.colorNeutralForegroundDisabled}}),R={math:n.y4p,code:o.P1J},I=({icon:e,title:t,content:a,explanation:n,getClipboardItem:o,telemetryUsageFeatureName:l,suggestionId:s,ariaAttributes:g,alwaysShowExplanation:h,copyButtonAriaLabelSuffix:p})=>{const f=(0,c.Bi)("snippet-explanation-"),x=E(),[I,A]=b.useState(h);(0,w.IC)(I,(()=>{n?.onFirstTimeExplanationShown?.()}));const L=n&&(n.isNotAvailable||!n.isLoading&&!n.explanation);return(0,b.useEffect)((()=>{L&&A(!1)}),[L]),b.createElement(v.Y,{...(0,S.yw)("OfficeVSO_9419358_FormulaA11yFixes")?{role:"group","aria-label":g?.["aria-label"]??y.xe2.CodeSnippetWithExplanation_AriaLabel}:void 0,header:function(){if(!e&&!t)return;const a=e&&R[e];return b.createElement("div",{className:x.header},a&&b.createElement(a,null),t||null)}(),footer:function(){if(!n||h)return;const e=I?r.g4$:r.rLf,t=b.createElement(d.f,{checked:I,disabled:L,size:"small",appearance:"transparent",iconPosition:"after",className:L?x.footerForegroundDisabled:x.footerForeground,onClick:()=>A(!I),icon:b.createElement(e,{className:L?x.footerForegroundDisabled:x.footerForeground}),...(0,S.yw)("OfficeVSO_9419358_FormulaA11yFixes")?{"aria-expanded":I,"aria-controls":f}:void 0},I?y.xe2.CodeSnippetWithExplanation_ExplanationButton_Hide:y.xe2.CodeSnippetWithExplanation_ExplanationButton_Show);return{className:x.footer,children:L?b.createElement(u.m,{withArrow:!0,content:y.xe2.CodeSnippetWithExplanation_ExplanationNotAvailable,relationship:"label"},t):t}}(),controls:o&&b.createElement(i.i,{getClipboardItem:o,telemetryUsageData:{actionType:T.he.FormulaCopyClicked,source:T.KZ.CopyFormulaButton,featureName:l,suggestionId:s},ariaLabelSuffix:p}),content:{className:I?x.contentExpanded:x.contentCondensed,tabIndex:0}},(0,S.yw)("OfficeVSO_9299043_SnippetAlwaysLTR")?b.createElement("div",{dir:"ltr",style:{textAlign:"left"}},a):a,I&&n&&b.createElement(b.Fragment,null,b.createElement(m.c,{className:x.explanationDivider}),b.createElement(C,{id:f,explanation:n})))}},51853:(e,t,a)=>{a.d(t,{Gr:()=>r,Y:()=>i,iN:()=>s,oO:()=>l});let n="",o="";function r(e){n=e}function i(){return n}function l(e){o=e}function s(){return o}},50751:(e,t,a)=>{a.d(t,{QJ:()=>n,eL:()=>C,eS:()=>h,j2:()=>g,k1:()=>y,mR:()=>m,v1:()=>v});var n,o=a(41519),r=a(88027),i=a(94836),l=a(37745),s=a(82794),c=a(92782);!function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(n||(n={}));const d=[{excelPrimaryBackgroundColor:"#FFFFFF",sdxPrimaryBackgroundColor:"#EDEBE9",sdxTheme:o.G.defaultWhite},{excelPrimaryBackgroundColor:"#1B1A19",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.G.defaultBlack},{excelPrimaryBackgroundColor:"#262626",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.G.defaultBlack},{excelPrimaryBackgroundColor:"#666666",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.G.defaultBlack},{excelPrimaryBackgroundColor:"#323232",sdxPrimaryBackgroundColor:"#323232",sdxTheme:o.G.defaultBlack}],u=[{excelPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:o.G.defaultWhite},{excelPrimaryBackgroundColor:"#000000",sdxPrimaryBackgroundColor:"#141414",sdxTheme:o.G.defaultBlack}],m=(e,t)=>{const a=(0,i.dD)()?u.find((t=>t.excelPrimaryBackgroundColor.toLowerCase()===e.toLowerCase())):d.find((t=>t.excelPrimaryBackgroundColor.toLowerCase()===e.toLowerCase()));return(0,r.N_)(a?.sdxTheme??o.G.defaultWhite),t&&f(a?.sdxPrimaryBackgroundColor??"#EDEBE9"),a?.sdxTheme??o.G.defaultWhite},g=e=>e===o.G.defaultDarkGrey||e===o.G.defaultBlack,h=(e,t)=>{const a=e!==o.G.defaultWhite?{isDarkModeEnabled:!0,isHighContrastModeEnabled:t,...b}:{isDarkModeEnabled:!1,isHighContrastModeEnabled:t,...p};return a.dir=(0,l.xt)()?"rtl":"ltr",a},p={themePrimary:"#107c41",themeSecondary:"#007c85",themeLight:"#CAEAD8",themeDark:"#A0D8B9",themeDarker:"#37A660",themeTertiary:"#0f703b",themeLighter:"#42B8B2",themeMedium:"#A0D8B9",themeDarkAlt:"#107C41",themeLighterAlt:"#DCF51D",neutralLighter:"#f5f5f5",neutralDark:"#242424",black:"#292827",white:"#ffffff",lightBlue:"#dce6f1"},b={themePrimary:"#55B17E",themeSecondary:"#007c85",themeLight:"#084625",themeDark:"#0f7c41",themeDarker:"#0a5f33",themeTertiary:"#0f703b",themeLighter:"#42B8B2",themeMedium:"#0f7c41",themeDarkAlt:"#107C41",themeLighterAlt:"#DCF51D",neutralLighter:"#757575",neutralDark:"#ffffff",black:"#ffffff",white:"#292827",lightBlue:"#292827"},f=e=>{document.body.style.backgroundColor=e},C={...s.o,themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#C43E1C",black:"#000000",lightBlue:"#dce6f1"},y=(0,c.Q)(C),v={10:"#03160A",20:"#052912",30:"#094624",40:"#0A5325",50:"#0C5F32",60:"#0F703B",70:"#0F7937",80:"#107C41",90:"#218D51",100:"#10893C",110:"#1F954A",120:"#37A660",130:"#55B17E",140:"#60BD82",150:"#A0D8B9",160:"#CAEAD8"}},17649:(e,t,a)=>{var n;a.d(t,{C$:()=>m,UQ:()=>n,lf:()=>d,t7:()=>u}),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(n||(n={}));const o=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:1,isHundredPercent:!1,axisGroup:"primary"}],r=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:1,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:0,isHundredPercent:!1,axisGroup:"primary"}],i=[{dimension:"xValues",excelAxisType:"Category",ivyDimension:"xValues",isValue:!0,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"yValues",excelAxisType:"Value",ivyDimension:"yValues",isValue:!0,orientation:1,isHundredPercent:!1,axisGroup:"primary"}],l=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:1,isHundredPercent:!0,axisGroup:"primary"}],s=[],c={area:o,areaStacked:o,areaStacked100:l,barClustered:r,barStacked:r,barStacked100:[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:1,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:0,isHundredPercent:!0,axisGroup:"primary"}],columnClustered:o,columnStacked:o,columnStacked100:l,line:o,lineStacked:o,lineStacked100:l,bubble:i,doughnut:s,pie:s,radar:o,scatter:i,histogram:o};function d(e){return e in c?c[e]:[]}function u(e){const t=m(e,"values");if(void 0===t)throw new Error("unsupported secondary axis type");return[{...t,axisGroup:"secondary"}]}function m(e,t){return c[e].find((e=>e.dimension===t))}},93170:(e,t,a)=>{a.d(t,{Az:()=>m,BC:()=>g,D9:()=>h,Ei:()=>S,ON:()=>n,P6:()=>C,Pl:()=>_,QN:()=>L,Qi:()=>p,SB:()=>d,U$:()=>N,Vs:()=>E,Wn:()=>A,Wx:()=>y,Yg:()=>w,Zx:()=>c,e0:()=>I,gv:()=>F,hr:()=>u,iR:()=>v,kd:()=>x,r$:()=>T,tF:()=>f,vA:()=>s,w8:()=>i,wm:()=>o,yX:()=>R,z8:()=>b});const n="#FFFFFF",o="#D2D2D2",r="#ED7331",i="#595959",l="#0000FF",s=["#DD5A13",l],c=o,d=r,u=[r,l],m=50,g=33,h=3,p=7,b=-30,f=100,C=20,y=.33,v=.07,T=.1,x=3,S="#F0F0F0",w=i,E="Dot",R=2,I="inherit",A=8.25,L=7.4,F=["h:mm AM/PM","h:mm:ss AM/PM","AM/PM h:mm;","AM/PM h:mm:ss;","h:mm","h:mm:ss","m/d/yyyy h:mm","mm:ss","ms:ss.0","[h]:mm:ss","h:mm AM/PM;@","h:mm:ss AM/PM;@","AM/PM h:mm;@","AM/PM h:mm:ss;@","h:mm;@","h:mm:ss;@","mm:ss.0;@","[h]:mm:ss;@","m/d/yy h:mm;@"],_=255,N=255},39234:(e,t,a)=>{a.d(t,{Pg:()=>l,iZ:()=>d,ip:()=>s,z6:()=>c});var n=a(92779);const o=[];function r(){if(o.length>0)return;const e=Office.context.requirements.isSetSupported("ExcelApi","1.9");o.push({excelType:Excel.ChartType.area,insightsType:"area",ivyLayout:"Area",localizedName:(0,n.Wuy)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.areaStacked,insightsType:"areaStacked",ivyLayout:"Area Stacked",localizedName:(0,n.CDV)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.areaStacked100,insightsType:"areaStacked100",ivyLayout:"Area Stacked (100%)",localizedName:(0,n.QKr)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.barClustered,insightsType:"barClustered",ivyLayout:"Bar Clustered",localizedName:(0,n.AUu)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.barStacked,insightsType:"barStacked",ivyLayout:"Bar Stacked",localizedName:(0,n.wnp)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.barStacked100,insightsType:"barStacked100",ivyLayout:"Bar Stacked (100%)",localizedName:(0,n.yid)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnClustered,insightsType:"columnClustered",ivyLayout:"Column Clustered",localizedName:(0,n.bo$)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnStacked,insightsType:"columnStacked",ivyLayout:"Column Stacked",localizedName:(0,n.H1r)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnStacked100,insightsType:"columnStacked100",ivyLayout:"Column Stacked (100%)",localizedName:(0,n.N0H)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.line,insightsType:"line",ivyLayout:"Line",localizedName:(0,n.PKs)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.lineStacked,insightsType:"lineStacked",ivyLayout:"Line Stacked",localizedName:(0,n.Dt7)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.lineStacked100,insightsType:"lineStacked100",ivyLayout:"Line Stacked (100%)",localizedName:(0,n.dcf)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.doughnut,insightsType:"doughnut",ivyLayout:"Doughnut",localizedName:(0,n.$c5)(),isSupported:!0,hasCategoryLegend:!0,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.pie,insightsType:"pie",ivyLayout:"Pie",localizedName:(0,n.DXl)(),isSupported:!0,hasCategoryLegend:!0,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.xyscatter,insightsType:"scatter",ivyLayout:"Scatter",localizedName:(0,n.HPY)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.histogram,insightsType:"histogram",ivyLayout:"Column Clustered",localizedName:(0,n.paF)(),isSupported:e,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.bubble,insightsType:"bubble",ivyLayout:"Scatter",localizedName:(0,n.nsJ)(),isSupported:!1,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1})}const i=["columnClustered","columnStacked","columnStacked100","line","lineStacked","lineStacked100"];function l(e){r();const t=o.find((t=>t.insightsType===e));if(!t)throw new Error("Invalid chart type.");return t}function s(e){const t=e.series;if(0===t.length)throw new Error("Chart contains no series.");if(t.map((e=>e.layout)).filter(((e,t,a)=>t===a.findIndex((t=>t===e)))).length>2)throw new Error("Currently we only support maximum 2 chart types");const a=t.find((e=>"primary"===e.valueAxisGroup));if(void 0===a)throw new Error("All series are in the Secondary axis group");if(t.some((e=>"primary"===e.valueAxisGroup&&e.layout!==a.layout)))throw new Error("All the series in the primary axis group should have same chart layout");const n=t.find((e=>"secondary"===e.valueAxisGroup));if(n){if(t.some((e=>"secondary"===e.valueAxisGroup&&e.layout!==n.layout)))throw new Error("All the series in the secondary axis group should have same chart layout");if(!i.some((e=>e===a.layout))||!i.some((e=>e===n.layout)))throw new Error("Unsupported chart layout for combo chart")}return{primary:l(a.layout),secondary:void 0===n?void 0:l(n.layout)}}function c(){return r(),o.filter((e=>e.isSupported)).map((e=>e.insightsType))}function d(e){return e===Excel.ChartType.histogram}},63789:(e,t,a)=>{a.d(t,{Y:()=>r});const n={isLine:!1,isPie:!1,isClustered:!1,hasDoughnutHoleSize:!1,hasGapWidth:!1,hasDataMarkers:!1,hasSeriesOverlap:!1},o={area:{...n},areaStacked:{...n},areaStacked100:{...n},barClustered:{...n,hasGapWidth:!0,hasSeriesOverlap:!0,isClustered:!0},barStacked:{...n,hasGapWidth:!0},barStacked100:{...n,hasGapWidth:!0},columnClustered:{...n,hasGapWidth:!0,hasSeriesOverlap:!0,isClustered:!0},columnStacked:{...n,hasGapWidth:!0},columnStacked100:{...n,hasGapWidth:!0},line:{...n,isLine:!0},lineStacked:{...n,isLine:!0},lineStacked100:{...n,isLine:!0},doughnut:{...n,isPie:!0,hasDoughnutHoleSize:!0},pie:{...n,isPie:!0},scatter:{...n,hasDataMarkers:!0},bubble:{...n},radar:{...n,isLine:!0},histogram:{...n}};function r(e){return o[e]}},7616:(e,t,a)=>{a.d(t,{o:()=>C,I:()=>f});var n,o=a(98226),r=a(50751),i=a(8295);function l(e){switch(e){case n.Colorful:case n.White:return{buttonBackgroundDisabled:"#F0F0F0",buttonBackgroundHovered:"#FAFAFA",buttonBackgroundPressed:"#F5F5F5",menuBackground:"#FAFAFA",menuItemBackgroundHovered:"#F0F0F0",menuItemBackgroundPressed:"#DBDBDB"};case n.Black:return{buttonBackgroundDisabled:"#0A0A0A",buttonBackgroundHovered:"#1F1F1F",buttonBackgroundPressed:"#000000",menuBackground:"#1F1F1F",menuItemBackgroundHovered:"#333333",menuItemBackgroundPressed:"#141414"};case n.DarkGray:return{buttonBackgroundDisabled:"#2E2E2E",buttonBackgroundHovered:"#3D3D3D",buttonBackgroundPressed:"#242424",menuBackground:"#424242",menuItemBackgroundHovered:"#525252",menuItemBackgroundPressed:"#383838"};default:return{}}}function s(e){const t=function(e){switch(e){case n.DarkGray:return{neutralLight:"#242424",neutralSecondary:"#FFFFFF",themeSecondary:"#E6E6E6"};case n.Black:return{neutralLight:"#000000",neutralSecondary:"#FFFFFF",themeSecondary:"#D6D6D6"};case n.White:case n.Colorful:default:return{neutralLight:"#F5F5F5",neutralSecondary:"#212121",themeSecondary:"#424242"}}}(e),a=(0,i.a)({palette:t,semanticColors:l(e)});a.name=e,function(e){const t=document.getElementsByTagName("body").item(0);switch(e){case"DarkGray":return t.classList.toggle("black",!1),void t.classList.toggle("dark-gray",!0);case"Black":return t.classList.toggle("dark-gray",!1),void t.classList.toggle("black",!0);default:t.classList.toggle("dark-gray",!1),t.classList.toggle("black",!1)}}(e);const o=document.documentElement;return o.style.setProperty("--theme-themePrimary",a.palette.themePrimary),o.style.setProperty("--theme-themeLighterAlt",a.palette.themeLighterAlt),o.style.setProperty("--theme-themeLighter",a.palette.themeLighter),o.style.setProperty("--theme-themeLight",a.palette.themeLight),o.style.setProperty("--theme-themeTertiary",a.palette.themeTertiary),o.style.setProperty("--theme-themeSecondary",a.palette.themeSecondary),o.style.setProperty("--theme-themeDarkAlt",a.palette.themeDarkAlt),o.style.setProperty("--theme-themeDark",a.palette.themeDark),o.style.setProperty("--theme-themeDarker",a.palette.themeDarker),o.style.setProperty("--theme-neutralLighterAlt",a.palette.neutralLighterAlt),o.style.setProperty("--theme-neutralLighter",a.palette.neutralLighter),o.style.setProperty("--theme-neutralLight",a.palette.neutralLight),o.style.setProperty("--theme-neutralQuaternaryAlt",a.palette.neutralQuaternaryAlt),o.style.setProperty("--theme-neutralQuaternary",a.palette.neutralQuaternary),o.style.setProperty("--theme-neutralTertiaryAlt",a.palette.neutralTertiaryAlt),o.style.setProperty("--theme-neutralTertiary",a.palette.neutralTertiary),o.style.setProperty("--theme-neutralSecondary",a.palette.neutralSecondary),o.style.setProperty("--theme-neutralPrimaryAlt",a.palette.neutralPrimaryAlt),o.style.setProperty("--theme-neutralPrimary",a.palette.neutralPrimary),o.style.setProperty("--theme-neutralDark",a.palette.neutralDark),o.style.setProperty("--theme-white",a.palette.white),o.style.setProperty("--theme-redDark",a.palette.redDark),o.style.setProperty("--theme-whiteTranslucent40",a.palette.whiteTranslucent40),o.style.setProperty("--theme-green",a.palette.green),o.style.setProperty("--theme-black",a.palette.black),a}!function(e){e.Colorful="Colorful",e.DarkGray="DarkGray",e.Black="Black",e.White="White"}(n||(n={}));var c=a(56305),d=a(41519),u=a(20456),m=a(50347),g=a(11689),h=a(49462),p=a(8520);const b=async(e,t,n,o,r,i,l,s,c,d,u,m,g,h,p,b,f)=>await Excel.run((async C=>{const y=await Promise.all([a.e("vendors~calc"),a.e("calc")]).then(a.bind(a,93961)),v=h?y.extractOper(h):void 0;return y.renderCodeAndPostView({context:C,requestId:e,cellAddress:n,sheetId:o,calc:y,linkTheme:r,styles:i,valOper:v,isPythonCodeShown:l,setIsPythonCodeShown:s,dispatch:c,isLoadingUIShown:d,pythonUserRequestId:u,isInitialDataFrame:m,code:t,codeExplanation:p,codeLabel:b,isPythonExecutionSuccess:f,diagnosticsEntry:g})??void 0})),f=(e,t)=>(0,p.useCallback)((()=>{const e=function(){if(!window.Office)return"Colorful";try{const e=Office.context.officeTheme;return function(e){switch(e){case"#E6E6E6":default:return"Colorful";case"#666666":return"DarkGray";case"#262626":return"Black";case"#FFFFFF":return"White"}}(e?e.bodyBackgroundColor.toUpperCase():"")}catch{return"Colorful"}}(),t=s(e).palette,a=(i=e)===n.Black||(0,m.yw)("OfficeVSO_9289835_DarkModePostView")&&i===n.DarkGray;var i;return(0,o.l8)({errorOutput:{color:t.red},stringOutput:{color:t.themeSecondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},staticOutput:{color:t.themeSecondary},numberOutput:{color:a?"#B5CEA8":"#098658",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},booleanOutput:{color:a?"#569CD6":"#0000FF",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},webImage:{objectFit:"contain",maxWidth:"calc(min(80%, 100px))",maxHeight:"100px"},localImage:{objectFit:"contain"},pythonProps:{color:t.neutralSecondary,fontSize:"12px","> code":{color:"inherit !important"}},pythonTable:{whiteSpace:"nowrap",overflowX:"auto",textOverflow:"ellipsis",display:"flow",width:"100%",tableLayout:"fixed",borderSpacing:0,borderCollapse:"collapse","& tr > td":{border:`1px solid ${t.neutralSecondaryAlt}`,padding:"2px 4px",minWidth:"30px"},"& > thead > tr > td":{background:t.neutralLight,fontWeight:o.BO.semibold,"> code":{fontWeight:"inherit !important",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"}},"& > tbody > tr > td":{}},showPythonCodeToggleButtonStyle:{color:r.k1.colorNeutralForeground3,"&:hover":{color:r.k1.colorNeutralForeground2Hover},"&:hover:active":{color:r.k1.colorNeutralForeground2Pressed},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},diagnosticsOutputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontFamily:"Consolas, monospace",fontSize:"16px",fontWeight:"400",whiteSpace:"pre-wrap",lineHeight:"20px",marginBottom:"8px",overflowWrap:"anywhere"},stdOut:{color:t.neutralSecondary,padding:"2px 0 2px 0"},Error:{color:t.red,padding:"2px 0 2px 0"}})}),[e,t]);function C({requestId:e,cellAddress:t,sheetId:a,pythonCell:n,code:o,codeExplanation:i,codeLabel:l,isPythonExecutionSuccess:s,diagnosticsEntry:m,pythonUserRequestId:C,isInitialDataFrame:y}){const v=(0,g.j)(),T=(0,h.d4)((e=>e.chat.showLoadingUI)),x=(0,h.d4)((e=>e.chat.lastPythonQueryId)),{sdxTheme:S,highContrastClientMode:w}=(0,p.useContext)(u.D),[E,R]=p.useState(w!==r.QJ.disabled),[I,A]=p.useState(),[L,F]=p.useState(!1),_=f(S,E);return(0,p.useEffect)((()=>{R(w!==r.QJ.disabled)}),[w]),(0,p.useEffect)((()=>{const c=(0,r.eS)(S||d.G.defaultWhite,E);(async()=>{const r=await b(e,o,t,a,c,_(),L,F,v,T,C,y,m,n,i,l,s);A(r)})()}),[S,T,E,n,L,s,x]),I??p.createElement(c.z,null)}},56305:(e,t,a)=>{a.d(t,{q:()=>u,z:()=>m});var n=a(50751),o=a(41519),r=a(7616),i=a(8374),l=a(55973),s=a(20456),c=a(8520);const d=async(e,t,n,o,r,i)=>await Excel.run((async l=>{const s=await Promise.all([a.e("vendors~calc"),a.e("calc")]).then(a.bind(a,93961)),c=s.extractOper(o);return s.renderOperWrapper({valOper:c,context:l,requestId:e,cellAddress:t,sheetId:n,calc:s,linkTheme:r,styles:i})??void 0}));function u({requestId:e,cellAddress:t,sheetId:a,pythonCell:i}){const{sdxTheme:l,highContrastClientMode:u}=(0,c.useContext)(s.D),[g,h]=c.useState(u!==n.QJ.disabled),[p,b]=c.useState(),f=(0,r.I)(l,g);return(0,c.useEffect)((()=>{h(u!==n.QJ.disabled)}),[u]),(0,c.useEffect)((()=>{const r=(0,n.eS)(l||o.G.defaultWhite,g);(async()=>{const n=await d(e,t,a,i,r,f());b(n)})()}),[l,g]),p??c.createElement(m,null)}function m(){return c.createElement(i.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4}},c.createElement(l.H,{size:12}))}},47807:(e,t,a)=>{a.d(t,{EH:()=>y,IN:()=>T,Nd:()=>h,dS:()=>d,js:()=>v});var n=a(81364),o=a(88179),r=a(31030),i=a(48314),l=a(33532),s=a(50347);const c=9,d="https://fa000000124.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.2.2305.23018/en-us_web/login.html",u=1e4;let m;async function g(){const e=Office.context.document.settings.get("LicensedIdentities");if(e){const t=await OfficeFirstPartyAuth.getIdentities();if(m=t.find((({uniqueId:t})=>e.some((e=>e===t)))),!m)throw new Error(`No logged in licensed identities found. Licensed identities found: ${e?.length}. Logged in identities: ${t.length}`)}else m=await OfficeFirstPartyAuth.getPrimaryIdentityInfo()}async function h(){try{await(0,l.j)(Promise.all([OfficeFirstPartyAuth.load(d),g()]),(0,s.Z8)("Microsoft.Office.Excel.FA000000124.AuthTimeout",u))}catch(e){throw i.M.getInstance().logErrorCode(n.O.LoadAuthError,e,r.S.AuthError,o.$b.Error),e}}Office.onReady((()=>{OfficeFirstPartyAuth.supportsOauthManager=!0}));const p="79d1f229-c1e5-4bd5-b2fd-4764b025b103",b=`${p}/.default`,f="DELEGATED";async function C(e){let t,a;if(!m)throw i.M.getInstance().logError({eventType:r.S.AuthError,errorMessage:"Attempted to authenticate with no logged in licensed identity",logLevel:o.$b.Error}),new Error("Attempted to authenticate with no logged in licensed identity");const l=m.identityType;if("Unsupported"===l)throw i.M.getInstance().logError({eventType:r.S.AuthError,errorMessage:"Unsupported identity type",logLevel:o.$b.Error},void 0,[{key:"FetchType",value:e}]),new Error("Unsupported identity type");for(let s=0;s<=c;s++)try{return(await OfficeFirstPartyAuth.getAccessToken({resource:p,scope:"MicrosoftAccount"===l?b:void 0,policy:"MicrosoftAccount"===l?f:void 0,identityUniqueId:m.uniqueId,appName:"OAuthManager"===e?"OfficeInsightsServices":void 0},{popup:"Popup"===e})).accessToken}catch(l){const s=l instanceof OfficeExtension.Error?l.code:void 0,c="login_required"===s?o.$b.ASHA:"invalid_resource"===s?o.$b.Error:o.$b.Warning;if(i.M.getInstance().logErrorCode(n.O.AuthError,l,r.S.AuthError,c,{key:"FetchType",value:e}),"invalid_resource"!==s)throw l;t=l,a=s}throw i.M.getInstance().logError({eventType:r.S.AuthError,errorMessage:`Ran out of retries while authenticating. Last error encountered: ${a??"Unknown"}`,logLevel:o.$b.Error},void 0,[{key:"FetchType",value:e}]),t}async function y(){try{return await C("OAuthManager")}catch{return!1}}async function v(){try{return await C("Silent")}catch(e){if("login_required"===e.code)return!1;throw e}}async function T(){try{return await C("Popup")}catch{return!1}}},46919:(e,t,a)=>{async function n(e,t,n,o,r,i,l,s){return(await Promise.all([a.e("vendors~calc"),a.e("calc")]).then(a.bind(a,93961))).adjustFormulaReferencesToNewColAddition(e,t,n,o,r,i,l,s)}async function o(e,t,n){return(await Promise.all([a.e("vendors~calc"),a.e("calc")]).then(a.bind(a,93961))).substitution.getColumnsReferencedByFormula(e,t,n)}a.d(t,{s:()=>o,t:()=>n})},15197:(e,t,a)=>{a.d(t,{lA:()=>n,zJ:()=>l});var n,o=a(72842);function r(e,t){return{x:e.x+t.x,y:e.y+t.y}}function i(e,{maxWidthBeforeOverflow:t=Number.POSITIVE_INFINITY,padding:a={x:0,y:0},startVector:n={x:0,y:0}}={}){const o=function(e,t,a={x:0,y:0},n={x:0,y:0}){const o=[],i={x:0,y:0},l=t;let s=0,c=0,d=0;const u=(e,t)=>{o.push({...e,position:r({x:s,y:c},n)}),d=Math.max(d,t.y),i.x=Math.max(i.x,s+t.x),i.y=Math.max(i.y,c+t.y),s+=t.x},m=()=>{c+=d,d=0,s=0};for(let n=0;n<e.length;++n){const o=e[n],i=r(o.dim,a);i.x>t?(0!==s&&m(),u(o,i)):i.x>l-s?(m(),--n):i.x===l-s?(u(o,i),m()):u(o,i)}return{placements:o,bbox:i}}(e,t,a,n),i={};return o.placements.forEach((e=>{i[e.id]=e})),{result:i,bbox:o.bbox}}function l(e,t){const a={x:1,y:1},n={x:0,y:0},l=e=>{if(e.pivotTableData&&e.pivotTableData.length>0){const t=(e.subTotalRowIndices?.length??0)>0?1:0,a=(e.filterFields.length>0?e.filterFields.length+1:0)+(e.grandTotalRowIndex?0:1)+(e.subTotalRowIndices?.length??0);return{x:e.pivotTableData.length+t,y:e.pivotTableData[0].length+a}}return{x:4,y:10}},s=[],c=[];e.forEach((e=>{switch(e.visual.visualType){case"ChartVisual":{const t={x:5,y:14};s.push({position:n,dim:t,id:e.id});break}case"PivotTableVisual":{const t=l(e.visual.pivotTable);c.push({position:n,dim:t,id:e.id});break}case"PivotChartVisual":{const t=l(e.visual.pivotTable),a={x:5,y:14};s.push({position:n,dim:a,id:e.id}),c.push({position:n,dim:t,id:e.id});break}case"BlankPivotTable":case"QueryResultVisual":case"ForecastVisual":case"TextAnalysisVisual":throw new Error(`insertAllRecommendations: Unsupported visualType=${e.visual.visualType}`);default:(0,o.x)(e.visual)}}));const d={x:2,y:2},u=i(s,{maxWidthBeforeOverflow:t,padding:a,startVector:d}),m=r(d,{y:u.bbox.y+5,x:0}),g=i(c,{padding:a,startVector:m}),h={};return e.forEach((e=>{const t=u.result[e.id],a=g.result[e.id];h[e.id]={chart:t,pivotTable:a}})),{layoutPlacementsById:h,mainDataLocation:{startRow:d.y,startColumn:d.x,rowCount:u.bbox.y,columnCount:u.bbox.x},supportingDataLocation:{startRow:m.y,startColumn:m.x,rowCount:g.bbox.y,columnCount:g.bbox.x}}}!function(e){e[e.none=0]="none",e[e.unknown=1]="unknown",e[e.findInterpretation=2]="findInterpretation",e[e.preFormatDashboardSheet=3]="preFormatDashboardSheet",e[e.insertRecommendations=4]="insertRecommendations",e[e.convertingDashboardArgs=5]="convertingDashboardArgs",e[e.insertPivotTables=6]="insertPivotTables",e[e.insertCharts=7]="insertCharts",e[e.insertPivotCharts=8]="insertPivotCharts",e[e.postFormatDashboardSheet=9]="postFormatDashboardSheet"}(n||(n={}))},80519:(e,t,a)=>{a.d(t,{$k:()=>O,Ft:()=>Y,Fw:()=>V,JM:()=>P,L$:()=>N,VS:()=>o,Yw:()=>n,aG:()=>Z,cY:()=>k,fJ:()=>G,gA:()=>D,hK:()=>H,iM:()=>_,jI:()=>B,jL:()=>q,mZ:()=>K,uq:()=>X,wr:()=>$,xw:()=>U});var n,o,r=a(89099),i=a(24220),l=a(61852),s=a(93022),c=a(72483),d=a(81364),u=a(88179),m=a(92779),g=a(45283),h=a(63395),p=a(26115),b=a(96854),f=a(31030),C=a(48314),y=a(50347),v=a(46919),T=a(18700),x=a(23147),S=a(61150),w=a(79259),E=a(41102),R=a(54285),I=a(78640),A=a(9019),L=a(70364),F=a(40910);function _(e){return 0===e.suggestionType}function N(e){return e.every(_)}function k(e){return 1===e.suggestionType}function O(e){return e.every(k)}function P(e){return e.calculatedFormulas.flatMap((e=>e.insertionIndexes)).filter((e=>void 0!==e)).sort(((e,t)=>e-t))}async function M(e){if(!(0,R.k8)(e))return;const t=Math.min(A.do+1,e.rowCount-(e.hasTableHeaders?1:0));return e.hasHiddenRows?Excel.run((async a=>{if(e.address){const n=a.workbook.worksheets.getItem(e.sheetName).getRange(e.address).getColumn(0).getVisibleView();n.load("cellAddresses"),await a.sync();const o=function(e,t,a){const n=e.split(",").slice(a.hasTableHeaders?1:0,t+(a.hasTableHeaders?1:0));return n.map((e=>{const t=e.match(/\d+$/);return t?parseInt(t[0],10):NaN}))}(n.cellAddresses.toString(),t,e);return o}})):Array.from({length:Math.min(t,e.rowCount-(e.hasTableHeaders?1:0))},((t,a)=>e.rowIndex+(e.hasTableHeaders?1:0)+(a+1)))}function D(e,t,a,n,o=!1){const{isPivotTable:r,tableName:i,sheetName:l,address:s}=t;if(r||!i||!l||!s)return Promise.resolve();if(0===a.length)return Promise.resolve();const c=t.hasTableHeaders?[e,...a]:[];return Excel.run((async e=>{const a=o&&t.sheetId?e.workbook.worksheets.getItem(t.sheetId):e.workbook.worksheets.getActiveWorksheet();if(o)a.activate();else if(a.load("name"),await e.sync(),a.name!==l)return;const r=a.rangeValuesPreview,i=(0,T.cc)(s)??s;if(r.onDismissed.add(n),r.show(i,c,{autoexpandTable:!0,autofitColumns:!0}),o){const t=a.getRange(i),n=t.getOffsetRange(0,(c[0]?.length??0)+1);await x.CP.runWithNoContextRefresh((async()=>{t.getBoundingRect(n).select(),await e.sync();t.getOffsetRange(0,-1).select(),await e.sync()}))}else await e.sync()}))}function $(e,t,a,n,o=!1){const{isPivotTable:r,tableName:i,sheetName:l,address:s,showTotals:c}=e;return!r&&i&&l&&s?0===t.length||void 0===a?Promise.resolve():Excel.run((async r=>{const i=o&&e.sheetId?r.workbook.worksheets.getItem(e.sheetId):r.workbook.worksheets.getActiveWorksheet();if(o)i.activate();else if(i.load("name"),await r.sync(),i.name!==l)return;const d=i.rangeValuesPreview,u=(0,T.K3)(s,a)??s;if(d.onDismissed.add(n),d.show(u,[t],{autoexpandTable:!0,autofitColumns:!0}),o){const e=i.getRange(u);if(c)e.select(),await r.sync();else{const t=e.getOffsetRange(1,0),a=e.getOffsetRange(-1,0);await x.CP.runWithNoContextRefresh((async()=>{t.select(),await r.sync(),a.select(),await r.sync()}))}}else await r.sync()})):Promise.resolve()}async function B(e){const{rowIndex:t,rowCount:a,columnIndex:n,columnCount:o,sheetName:r}=e;if(!r)throw new Error("getRowValuesUnderneathTable: sheetName is undefined");return Excel.run((async e=>{const i=e.workbook.worksheets.getItem(r).getRangeByIndexes(t+a,n,1,o);return i.load("text"),await e.sync(),i.text[0]}))}function H(e){return Excel.run((async t=>{t.workbook.worksheets.getItem(e).rangeValuesPreview.dismiss(),await t.sync()}))}function U(e,t,a,n,o){return(0,F.T0)("InsertColumn",(()=>async function(e,t,a,n,o){const r=[];try{if(!t.calculatedFormulas)return{insertionAddresses:r};let{calculatedFormulas:i}=t;const l=(0,R.UN)(t);let s;l&&(i=[...i],i.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER))));const c=[],d=new h.q("insertColumnApi");try{await(0,L.F5)((async e=>{for(let t=0;t<i.length;t++){const u=t,{address:m,selectedRange:g}=await W(i[t],a,n,u,s,c,e,o,d.withPrefix(`column${t}`));r.push(m),l||(s=g)}}),{operationTimers:d.withPrefix("undoScope")})}finally{(0,y.yw)("OfficeVSO_9265123_SendInsertFormulaColumnTelemetry")&&b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.FormulaSuggestionInsertColumnTimings,[u.h3.ChatEventParameters]:JSON.stringify({requestId:e,recommendationId:t.id,timers:d.getAll()})},C.M.getInstance())}return{insertionAddresses:r}}catch(e){return{insertionAddresses:r,insertionError:e}}}(n,e,t,a,o)),n,e.id)}function q(e,t,a,n){return(0,y.yw)("OfficeVSO_9546218_validatePreviewForRow")?(0,F.T0)("verifyCalcValueMatchesRowPreviewApi",(()=>async function(e,t,a,n){async function o(){let e=0,n=!1;const o=[];return await Excel.run({delayForCellEdit:!0},(async r=>{const{sheetName:i}=a;if(!i)throw new Error("Sheet name is undefined in selectionContext");const s=r.workbook.worksheets.getItem(i);for(let a=0;a<t.length;a++){const i=t[a],c=s.getRange(i);c.load("text, values"),await r.sync();const d=c.text[0];for(let t=0;t<d.length;t++)if(o.push(d[t]),d[t]!==l[e++]){n=!0;break}if(n)break}})),{isMismatch:n,gridTexts:o}}if(!e||0===e.length)return;t.sort(((e,t)=>(0,T.Jx)(e)-(0,T.Jx)(t)));const l=e[0],{isMismatch:s,gridTexts:c}=await o();if(s){const e=l.slice(0,c.length);C.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Mismatch_Between_Preview_And_Grid_Values,u.BJ.FormulaGeneration);const t=(0,T.sq)([e]),a=(0,T.sq)([c]);C.M.getInstance().logErrorCode(d.O.PreviewValidationFailed,new Error(`Preview value doesn't match the value on the grid. anonymized preview values: ${t}. anonymized grid values: ${a}`),f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:n})}}(e,t,a,n)),n):Promise.resolve()}function V(e,t,a,n){return(0,F.T0)("VerifyCalcValueMatchesPreview",(()=>async function(e,t,a,n){async function o(e){return await Excel.run({delayForCellEdit:!0},(async n=>{const{sheetName:o,hasTableHeaders:r}=a,i=n.workbook.worksheets.getItem(o).getRange(t[0]),l=e.length-1,s=i.getCell(r?1:0,0).getResizedRange(l,0);s.load("text, values"),await n.sync();let c=!1;for(let t=0;t<l;t++)if(e[t][0]!==s.text[t][0]){c=!0;break}return{isMismatch:c,allZeroes:s.values.every((e=>0===e[0])),gridRangeValues:s.text}}))}async function l(){return await Excel.run({delayForCellEdit:!0},(async e=>(e.application.load("calculationMode"),await e.sync(),"Automatic"===e.application.calculationMode&&(e.application.calculate("Recalculate"),!0))))}if(!e||0===e.length)return;const s=Math.min(5,e.length),c=e.slice(0,s);let{isMismatch:m,allZeroes:g,gridRangeValues:h}=await o(c),p=!1;m&&g&&(p=await l(),p&&({isMismatch:m}=await o(c)));if(m){const e=/^#.+[?|!]$/,t=(0,T.sq)(c),a=(0,T.sq)(h);t.some((t=>e.test(t)))||a.some((t=>e.test(t)))||C.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Mismatch_Between_Preview_And_Grid_Values,u.BJ.FormulaGeneration),C.M.getInstance().logErrorCode(d.O.PreviewValidationFailed,new Error(`Preview value doesn't match the value on the grid. attempted recalc: ${p}. anonymized preview values: ${t}. anonymized grid values: ${a}`),f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:n})}}(e,t,a,n)),n)}function G(e,t,a,n){return(0,F.T0)("InsertCell",(()=>async function(e,t){const a=[];let n,o=!1;try{const{calculatedFormulas:r}=e;if(!r)return{insertionAddresses:a};const i=r.flatMap((e=>{const t=(0,R.Ne)(e.insertionIndexes??[]),a=t.reduce(((e,t)=>e+t.length),0);if(!e.formulasToInsert||e.formulasToInsert.length!==a)throw new Error(`insertCellRecommendationApi: formula ${e.id} - formulasToInsert is not defined or has different length than insertionIndexes`);let n=0;return t.map((t=>({...e,insertionIndexes:t,formulasToInsert:t.map((()=>{const t=e.formulasToInsert?.[n]??e.formula;return n++,t}))})))})),l=new h.q("insertCellRecommendationApi");try{await(0,L.F5)((async r=>{t.showTotals||await l.measure("addEmptyRowIfNeededApi",async function(e,t,a){try{const{rowCount:e,rowIndex:n,columnIndex:o,sheetName:r,columnCount:i}=t;if(!r)throw new Error("addEmptyRowIfNeededApi: sheetName or showTotals are null or undefined");if(!a)throw new Error("addEmptyRowIfNeededApi: context is undefined");const l=await async function(e,t,a,n,o,r){const i=r.workbook.worksheets.getItem(o),l=i.getRangeByIndexes(a+e,n,1,t);l.load("valueTypes"),await r.sync();const s=(0,T.RV)(l);return s}(e,i,n,o,r,a);l||await async function(e,t,a,n,o,r){const i=e.workbook.worksheets.getItem(r);let l=i.getRangeByIndexes(n+t,o,1,a);return l=l.insert(Excel.InsertShiftDirection.down),l.clear(),l}(a,e,i,n,o,r)}catch(t){throw C.M.getInstance().logErrorCode(d.O.CalculatedCellPartialInsertFailed,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e}),t}}(e.id,t,r));for(let s=0;s<i.length;s++){const c=i[s],d=l.withPrefix(`formulaGroup:${s}`);try{const{address:n}=await z(c,t,r,!!(0,y.yw)("OfficeVSO_9145863_allowReplacementOfExistingValueInCellsSuggestion")&&!(!t.showTotals||!e.allowReplacementOfExistingValue),d);a.push(n)}catch(e){n=e,o=!0}}if(e.insertRowTitle){const a=l.withPrefix("Title");await async function(e,t,a,n){n.start("total");try{return await async function(e,t){const{rowCount:a,rowIndex:n,columnIndex:o,sheetName:r}=e,i=t.workbook.worksheets.getItem(r),l=i.getRangeByIndexes(n+a,o,1,1);if(l.load("valueTypes"),await t.sync(),!(0,T.RV)(l))return;l.values=[[m.xe2.CalculatedRowsFormulaTotalHeader]],await t.sync()}(t,a)}catch(t){throw C.M.getInstance().logErrorCode(d.O.DefaultInsertCalculatedCellTitleFailed,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e}),t}finally{n.end("total")}}(e.id,t,r,a)}if(await async function(e,t){const{rowCount:a,rowIndex:n,columnIndex:o,columnCount:r,sheetName:i}=e,l=t.workbook.worksheets.getItem(i);return l.getRangeByIndexes(n+a,o,1,r).format.font.bold=!0,t.sync()}(t,r),o)throw n}),{operationTimers:l.withPrefix("undoScope")})}finally{(0,y.yw)("OfficeVSO_9266949_SendInsertFormulaCellTelemetry")&&b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.FormulaSuggestionInsertRowTimings,[u.h3.ChatEventParameters]:JSON.stringify({requestId:e.id,timers:l.getAll()})},C.M.getInstance())}return{insertionAddresses:a}}catch(e){return{insertionAddresses:a,insertionError:e}}}(e,a)),n,e.id)}async function W(e,t,a,n,o,r,i,l,s){try{if(void 0!==e.insertionIndex)return await Q(e,t,a,n,o,r,s.withPrefix("partialInsertColumn"),i,e.insertionIndex,l);try{return await async function(e,t,a,n,o,r,i,l){try{r.start("total");const s=t.hasTableHeaders,{showTotals:c,rowCount:u,rowIndex:m,columnCount:g,columnIndex:h,sheetName:p,isTable:b}=t;if(!p||null==c)throw new Error("expandTableWithNewColumn: sheetName or showTotals are null or undefined");if(!i)throw new Error("expandTableWithNewColumn: context is undefined");let f=e;if(o.length>0){const t=await r.measure("adjustFormulaReferencesToNewColAddition",(0,v.t)(e.formula,o,p,m,u,h,g,l));f={...e,formula:t}}return await function(e,t,a,n,o,r,i,l,s,c,u,m){return async g=>{const h=g.workbook.worksheets.getItem(l),p=n+(a?1:0),b=h.getRangeByIndexes(o,i+r+t,p,1);b.load("valueTypes"),await m.measure("newColRange.load(valueTypes)",g.sync());if(b.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty)))))return s||b.clear(),await J(g,b,e,a,s,c,u,m.withPrefix("fillFormulaAndFormat"));throw new Error(d.O.CalculatedColumnExpandFailedNotEmptyColumn)}}(f,a,c,u,m,g,h,p,b,s,n,r)(i)}catch(t){throw t.message===d.O.CalculatedColumnExpandFailedNotEmptyColumn?(0,y.yw)("OfficeVSO_9290708_FormulaGenerationAshaAdjustments")?b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.CalculatedColumnExpandFailedNotEmptyColumn,[u.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},C.M.getInstance()):C.M.getInstance().logErrorCode(d.O.CalculatedColumnExpandFailedNotEmptyColumn,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e.id}):(0,y.yw)("OfficeVSO_9290708_FormulaGenerationAshaAdjustments")?b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.CalculatedColumnExpandFailed,[u.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},C.M.getInstance()):C.M.getInstance().logErrorCode(d.O.CalculatedColumnExpandFailed,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e.id}),t}finally{r.end("total")}}(e,a,n,o,r,s.withPrefix("expandTableWithNewColumn"),i,l)}catch(l){if((0,y.yw)("OfficeVSO_9290708_FormulaGenerationAshaAdjustments")?b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.DefaultInsertCalculatedColumnFailed,[u.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},C.M.getInstance()):C.M.getInstance().logErrorCode(d.O.DefaultInsertCalculatedColumnFailed,l,f.S.FormulaGeneration,u.$b.ASHA,{key:u.un.SuggestionID,value:e.id}),l.message===d.O.CalculatedColumnExpandFailedNotEmptyColumn)return await Q(e,t,a,n,o,r,s.withPrefix("partialInsertColumn-ExpandFailedNotEmptyColumn"),i);throw l}}catch(a){throw await async function(e,t,a){try{Excel.run((async a=>{const n=a.workbook.tables.getItem(t);n.columns.load("items"),await a.sync();const o=n.columns.items[n.columns.count-1];o.name===e&&(o.delete(),await a.sync())}))}catch(e){C.M.getInstance().logErrorCode(d.O.DeleteLastColumnFailed,e,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:a})}}(e.columnName,t,e.id),a}}async function z(e,t,a,n,o){o.start("total");try{return await async function(e,t,a,n,o){try{const{rowCount:r,rowIndex:i,columnIndex:l,sheetName:s}=t;if(!s)throw new Error("insertColumnAggregationUnderTable: sheetName or showTotals are null or undefined");return await async function(e,t,a,n,o,r,i,l){const s=r.workbook.worksheets.getItem(o),c=s.getRangeByIndexes(a+t,n+(e.insertionIndexes?.[0]??0),1,e.insertionIndexes?.length??1);let u=!1;i||(c.load("valueTypes"),await l.measure("newRowRange.load(valueTypes)",r.sync()),u=(0,T.RV)(c));if(u||i){const t=e.insertionIndexes?.map((()=>e.numberFormat))??[];return c.set({formulasLocal:[e.formulasToInsert],numberFormat:[t]}),c.select(),c.load("address"),await l.measure("newRowRange.set",r.sync()),{address:c.address,selectedRange:c}}throw new Error(d.O.CalculatedCellExpandFailedNotEmptyCell)}(e,r,i,l,s,a,n,o)}catch(t){throw t.message===d.O.CalculatedCellExpandFailedNotEmptyCell?(0,y.yw)("OfficeVSO_9290708_FormulaGenerationAshaAdjustments")?b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.CalculatedCellExpandFailedNotEmptyCell,[u.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},C.M.getInstance()):C.M.getInstance().logErrorCode(d.O.CalculatedCellExpandFailedNotEmptyCell,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e.id}):(0,y.yw)("OfficeVSO_9290708_FormulaGenerationAshaAdjustments")?b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.CalculatedCellExpandFailed,[u.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},C.M.getInstance()):C.M.getInstance().logErrorCode(d.O.CalculatedCellExpandFailed,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e.id}),t}}(e,t,a,n,o)}catch(t){throw C.M.getInstance().logErrorCode(d.O.DefaultInsertCalculatedCellFailed,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e.id}),t}finally{o.end("total")}}async function Q(e,t,a,n,o,r,i,l,s,c){const{showTotals:m,rowCount:g,rowIndex:h,columnCount:p,columnIndex:T,sheetName:x,isTable:S}=a;if(!x||null==m)throw new Error("partialInsertColumn: sheetName or showTotals are null or undefined");try{if(i.start("total"),!l)throw new Error("partialInsertColumn: context is undefined");return await function(e,t,a,n,o,r,i,l,s,c,d,u,m,g,h,p){return async b=>{const f=await g.measure("partialInsertEmptyColumn",async function(e,t,a,n,o,r,i,l,s,c){let d;if(s){const t=void 0!==c?c+r:-1;d=e.workbook.tables.getItem(l).columns.add(t).getRange()}else{const l=void 0!==c?n+c+r:n+o+r;d=e.workbook.worksheets.getItem(t).getRangeByIndexes(a,l,i,1),d=d.insert(Excel.InsertShiftDirection.right),d.clear()}return d}(b,s,r,l,i,a,o,t,c,h));m.push(h??i);const C=await g.measure("adjustFormulaReferencesToNewColAddition",(0,v.t)(e.formula,m,s,r,o,l,i,p)),y={...e,formula:C};return await J(b,f,y,n,c,u,d,g.withPrefix("fillFormulaAndFormat"))}}(e,t,n,m,g,h,p,T,x,S,o,a.hasTableHeaders,r,i,s,c)(l)}catch(t){throw(0,y.yw)("OfficeVSO_9290708_FormulaGenerationAshaAdjustments")?b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.CalculatedColumnPartialInsertFailed,[u.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},C.M.getInstance()):C.M.getInstance().logErrorCode(d.O.CalculatedColumnPartialInsertFailed,t,f.S.FormulaGeneration,u.$b.Warning,{key:u.un.SuggestionID,value:e.id}),t}finally{i.end("total")}}async function J(e,t,a,n,o,r,i,l){if(l.start("total"),(0,y.yw)("OfficeVSO_9212439_CopyTableFormatInTLR_2")&&!o){const e=t.getOffsetRange(0,-1);t.copyFrom(e,Excel.RangeCopyType.formats),t.conditionalFormats.clearAll()}const s=await async function(e,t,a,n,o,r,i,l){let s=!1,c=!1,m=null;for(let g=0;g<2;g++)try{return await j(e,t,a.columnName,a.formula,a.nonLocalizedFormula,a.numberFormat,!o,n,r,i,s,c,l.withPrefix(`fillFormulaAndFormatWithAutoFill:${g}`))}catch(e){if("InvalidArgument"!==e.code)throw e;if(e.debugInfo.errorLocation===m)throw e;if(m=e.debugInfo.errorLocation,"Range.formulasLocal"===e.debugInfo.errorLocation&&a.nonLocalizedFormula)C.M.getInstance().logErrorCode(d.O.CalculatedColumnsInvalidFormula,e,f.S.FormulaGeneration,u.$b.Warning),s=!0;else{if("Range.autoFill"!==e.debugInfo.errorLocation)throw e;C.M.getInstance().logErrorCode(d.O.InsertCalculatedColumnWithTargetRangeFailed,e,f.S.FormulaGeneration,u.$b.Warning),c=!0}}throw new Error("Failed to fill formula after 2 retries")}(e,t,a,n,o,r,i,l);if(!o&&r&&!(0,y.yw)("OfficeVSO_9212439_CopyTableFormatInTLR_2")){const e=t.getCell(0,0),a=e.getOffsetRange(0,-1);e.copyFrom(a,Excel.RangeCopyType.formats)}return l.end("total"),s}async function j(e,t,a,n,o,r,i,l,s,c,d=!1,u=!1,m){m.start("total");const g=t.getCell(0,0),h=ee();!h&&s&&(g.values=[[a]]);const p=s?g.getOffsetRange(1,0):g;(0,y.yw)("OfficeVSO_8662447_setFormatBeforeFormulaToAvoidSyntaxErrors")&&(p.numberFormat=[[r]]),d?p.values=[[o]]:(0,y.r1)()?p.formulasLocal=[[n]]:(0,y.yw)("OfficeVSO_8938494_useNonLocalizedFormulaAsFallback")&&o?p.values=[[o]]:p.values=[[n]];const b=t.getOffsetRange(s?1:0,0).getResizedRange((l?-2:-1)+(s?0:1),0),f=i||(0,y.yw)("OfficeVSO_9133639_CalculatedColumnsAlwaysAutoFill");f&&p.autoFill(u?void 0:b,Excel.AutoFillType.fillDefault),ee()||await m.measure("ContextSyncMidInsert",e.sync()),h&&s&&(g.values=[[a]]),(0,y.yw)("OfficeVSO_8449352_CalculatedColumnsCopyFromV2")&&(f||b.copyFrom(p,Excel.RangeCopyType.formulas)),b.numberFormat=[[r]],t.format.autofitColumns();const C=c?c.getBoundingRect(t):t;return C.select(),t.load("address"),await m.measure("ContextSyncPostInsert",e.sync()),m.end("total"),{address:t.address,selectedRange:C}}function Y(e){if((0,y.yw)("OfficeVSO_9006210_refactorCreateLocaleInfoFromLocaleCache")){const{errorTypeNames:t,specialRefNames:a,worksheetFunctionNames:n,...o}=e;return o}const{errorTypeNames:t,specialRefNames:a,...n}=e;return n}async function X(e,t,a,n,o,r,i,m,h,v){const T=await(0,F.T0)("GetVisibleRows",(()=>M(e)),n);(0,S.cY)("visibleRows: ",T);const x=function(e,t,a,n,o,r,i,s,c,m,g){if(!e.tableName||((0,y.yw)("CalculatedColumnsTLRSupport")?e.isPivotTable:!e.isTable))return null;const h=[];if((0,y.UB)()||r){if(!a)return C.M.getInstance().logErrorCode(d.O.CalculatedColumnFailedToSendSignal,new Error("convertFormulaSuggestionToResult dataSourceApi is undefined"),f.S.FormulaGeneration,u.$b.Error),null;let t=a.values.length;void 0!==a.formulas?.length&&(t=Math.min(a.values.length,a.formulas.length)),0!==t&&(t=Math.min(t,(0,y.xy)("CalculatedColumnsMaxCells")/a.values[0].length),t=Math.min(t,(0,y.xy)("CalculatedColumnsMaxRows")));const n=(0,y.yw)("OfficeVSO_9505903_SmallerExcelIntelligenceContext");for(let o=0;o<t;o++)for(let t=0;t<a.values[o].length;t++)h.push((0,w.If)(a,o,t,e.rowIndex,e.columnIndex,n))}const p=(0,I.at)(e,e.sheetId??""),b=(0,y.r1)();return new l.v({sheetName:e.sheetName??"",tableInfo:{hasHeaderRow:e.hasTableHeaders,hasTotalRow:e.showTotals??!1,tableName:e.tableName},cells:h,tableAddress:e.address,userPrompt:s,requestId:n,scenarioType:o,isCtrlTTable:e.isTable,dataLocale:t.dataLocale,localeInfoForPreview:b?void 0:(v=t,{decimalSeparator:v.localeInfo.decimalPoint,thousandsSeparator:v.localeInfo.digitGrouping,currencySymbol:v.localeInfo.currencySymbol,dayNameLong:v.localeInfo.longDay,dayNameShort:v.localeInfo.shortDay,monthNameLong:v.localeInfo.longMonth,monthNameShort:v.localeInfo.medMonth}),range:p,outputLanguage:c,visibleRows:m,isGeneralSuggestionsRequest:i,localeInfo:b?Y(t.calcLocaleInfo):void 0,isHybrid:!r,workbookTables:(0,y._m)()?g:void 0});var v}(e,t,a,n,o,r,i,m,h,T,v);if(!x)return Promise.reject(new Error("Invalid signal object"));const R=new p.g0({parentPath:["session","doc"],items:[{id:g.r.generateId(),body:x}]});if(b.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.CalculatedColumnsSignalSent,[u.h3.ChatEventParameters]:JSON.stringify({scenarioType:o})},C.M.getInstance()),(0,y.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse"))c.$.getInstance().submitOperation({operation:R,workflowAnnotationType:s.lL.getTypeName()});else{(await(0,E.qD)()).submitOperation(R)}}function K(e,t,a,n){if(e.requestId===t){if(!1===e.success)return{success:!1,result:void 0,suggestionType:n,suggestionMetadata:e.suggestionMetadata,debugInfo:e.debugInfo};const o=s.lL.typeGuard(e)?e.calculatedColumns?{requestType:a,id:Z(e.requestId,e.suggestionId),suggestionType:0,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.calculatedColumns,allowReplacementOfExistingValue:!1,debugInfo:e.debugInfo}:e.calculatedColumn?{suggestionType:0,requestType:a,id:Z(e.requestId,e.suggestionId),isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,allowReplacementOfExistingValue:!1,calculatedFormulas:[{id:e.suggestionId,description:e.description,formulaExplanation:e.formulaExplanation,formula:e.calculatedColumn.formula,columnName:e.calculatedColumn.columnName,title:e.calculatedColumn.title,numberFormat:e.calculatedColumn.numberFormat,structRefsFormula:e.calculatedColumn.structRefsFormula,insertionIndex:e.calculatedColumn.insertionIndex,nonLocalizedFormula:e.calculatedColumn.nonLocalizedFormula}]}:void 0:void 0,r=s.Dv.typeGuard(e)&&e.calculatedCells?{requestType:a,id:Z(e.requestId,e.suggestionId),suggestionType:1,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.calculatedCells,allowReplacementOfExistingValue:!!(0,y.yw)("OfficeVSO_9145863_allowReplacementOfExistingValueInCellsSuggestion")&&void 0,debugInfo:e.debugInfo}:void 0,i=o||r;return i?{success:!0,result:[i]}:(C.M.getInstance().logErrorCode(d.O.CalculatedColumnConvertAnnotationToRecommendationFailed,new Error("convertFormulaSuggestionToResult failed"),f.S.FormulaGeneration,u.$b.ASHA,{key:u.un.SuggestionID,value:Z(t,e.suggestionId??"not found")}),{success:!1,result:void 0,suggestionType:n,suggestionMetadata:e.suggestionMetadata,debugInfo:e.debugInfo})}return{success:!0,result:void 0}}function Z(e,t){return`${e}_${t}`}function ee(){return(0,y.yw)("OfficeVSO_9273998_skipContextSyncByBuildVersionV2")?(0,y.w0)(["PC:17425","Mac:84.414","OfficeOnline:true"]):(0,y.iP)("Microsoft.Office.Excel.FA000000124.RemoveContextSyncMidInsert",!1)}!function(e){e[e.GeneralFormula=0]="GeneralFormula",e[e.NLToFormula=1]="NLToFormula"}(n||(n={})),function(e){e[e.Column=0]="Column",e[e.Cell=1]="Cell"}(o||(o={}))},79259:(e,t,a)=>{a.d(t,{If:()=>u,ol:()=>n,sr:()=>d});var n,o=a(61852),r=a(93471);function i(e,t,a){return e.values[t][a]}function l(e,t,a){return e.texts[t][a]}function s(e,t,a){return e.formulas?.[t][a]}function c(e,t,a){return(0,r.gV)(e.numberFormats,t,a)}function d(e,t,a){return(0,r.gV)(e.numberFormatLocals,t,a)}function u(e,t,a,n,r,d){const u={row:t+n,column:a+r,displayText:l(e,t,a),rawValueJson:JSON.stringify(i(e,t,a)),numberFormat:c(e,t,a),formulaJson:JSON.stringify(s(e,t,a))};return d?u:new o.z(u)}!function(e){e[e.Sheet=0]="Sheet",e[e.PivotTable=1]="PivotTable"}(n||(n={}))},63305:(e,t,a)=>{a.d(t,{f:()=>g,y:()=>d});var n=a(92779),o=a(81364),r=a(88179),i=a(31030),l=a(48314),s=a(61150),c=a(50347);async function d(){let e=n.u1i;try{e=await OfficeFirstParty.UserFeedback.GetInitializationData()}catch(e){l.M.getInstance().logErrorCode(o.O.FeedbackApiError,e,i.S.Error,r.$b.Warning),(0,s.cY)("Error in OfficeFirstParty UserFeedback GetInitializationData ",e)}return e}async function u(){let e={};try{e=await OfficeFirstParty.UserFeedback.GetHostScreenshot()}catch(e){l.M.getInstance().logErrorCode(o.O.FeedbackApiError,e,i.S.Error,r.$b.Warning),(0,s.cY)("Error in OfficeFirstParty UserFeedback GetHostScreenshot ",e)}return e}const m=(e,t)=>{try{OfficeFirstParty.UserFeedback.InvokeDiagnosticsLogsUpload(e)}catch(e){l.M.getInstance().logErrorCode(o.O.FeedbackApiError,e,i.S.Error,r.$b.Warning),(0,s.cY)("Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload ",e)}},g=()=>{const e=(0,c.Ul)();if(e)try{let t,a=JSON.parse(e);return a&&(a={...a,callbackFunctions:{...a.callbackFunctions,provideDynamicScreenshot:u},feedbackConfig:{...a.feedbackConfig,diagnosticsConfig:{...a.feedbackConfig.diagnosticsConfig,attachDiagnostics:m},isScreenshotEnabled:!0,isEmailCollectionEnabled:!0}}),t=(0,c.yw)("OfficeVSO_9249582_IsFeedbackAppChatThemingEnabled")?{feedbackInitOptions:a,lightTheme:{baseTheme:"ExcelLightTheme"},darkTheme:{baseTheme:"ExcelDarkTheme"}}:{feedbackInitOptions:a},t}catch(e){return l.M.getInstance().logErrorCode(o.O.FeedbackApiError,e,i.S.Error,r.$b.Warning),void(0,s.cY)("Error in parsing feedbackInitializationData to JSON ",e)}}},50347:(e,t,a)=>{a.d(t,{$X:()=>se,Aw:()=>H,BA:()=>Te,BT:()=>Bt,CG:()=>ve,CL:()=>jt,CU:()=>kt,Co:()=>Qt,Cp:()=>Tt,DD:()=>ce,DU:()=>ie,Dl:()=>U,Eq:()=>Ge,FE:()=>W,FF:()=>Nt,Ff:()=>Ue,GI:()=>Pe,GK:()=>$t,Gp:()=>we,H:()=>Et,H2:()=>He,HS:()=>te,H_:()=>ae,I3:()=>zt,ID:()=>Me,IL:()=>Lt,Jh:()=>ht,K$:()=>dt,K5:()=>St,K7:()=>de,L:()=>$,Lr:()=>bt,Lz:()=>Ot,MN:()=>Jt,Mo:()=>Ft,N6:()=>ne,Pu:()=>_e,Pz:()=>It,QE:()=>et,Qy:()=>ct,RE:()=>V,RJ:()=>_,SA:()=>Je,SP:()=>z,Sh:()=>oe,So:()=>M,T$:()=>G,Te:()=>it,Ty:()=>J,UB:()=>Ie,UD:()=>K,UL:()=>ee,Ul:()=>Ce,WF:()=>ut,WI:()=>Xt,Wd:()=>he,XX:()=>Ut,Xh:()=>ot,Z8:()=>I,ZA:()=>Ye,_K:()=>Ht,_N:()=>Ae,_S:()=>mt,_T:()=>We,_b:()=>ge,_m:()=>Fe,aC:()=>Rt,av:()=>D,be:()=>A,cT:()=>Ze,dw:()=>Wt,eA:()=>ye,eF:()=>De,fn:()=>ue,ge:()=>pe,i3:()=>Ct,iB:()=>qe,iP:()=>R,ii:()=>At,jH:()=>Ke,jl:()=>wt,k6:()=>Oe,kk:()=>pt,kr:()=>_t,l6:()=>Vt,lC:()=>F,lD:()=>X,lj:()=>ft,lz:()=>qt,mO:()=>Be,md:()=>me,nz:()=>Y,o2:()=>Qe,oJ:()=>Z,oV:()=>Ee,pR:()=>Re,pl:()=>Pt,pu:()=>Gt,qJ:()=>yt,qK:()=>nt,qS:()=>L,qT:()=>at,qm:()=>Xe,r1:()=>ke,rb:()=>Le,s2:()=>Mt,sC:()=>Kt,tV:()=>fe,tg:()=>tt,th:()=>rt,tm:()=>Yt,u$:()=>O,u0:()=>N,v1:()=>$e,v2:()=>re,vC:()=>Se,vE:()=>ze,vI:()=>j,vK:()=>xe,vN:()=>le,vo:()=>je,w0:()=>Ne,w9:()=>Ve,wB:()=>gt,wO:()=>xt,wT:()=>vt,wy:()=>be,xt:()=>lt,xy:()=>w,yw:()=>E,zd:()=>Dt});var n=a(61150),o=a(81364),r=a(92779),i=a(5550),l=a(88179),s=a(36131),c=a(31030),d=a(48314),u=a(77303),m=a(72842),g=a(63305),h=a(49437),p=a(94836),b=a(9166),f=a(40910);const C={showDiscoverInsightsForShortQueries:{featureName:"Microsoft.Office.Excel.ShowDiscoverInsightsForShortQueries",defaultValue:!0},ConditionalFormattingConverter:{featureName:"Microsoft.Office.Excel.ConditionalFormattingConverter",defaultValue:!1},ExcelWorkflow:{featureName:"Microsoft.Office.Excel.ExcelWorkflow",defaultValue:!1},InsightsEndpointOverride:{featureName:"Microsoft.Office.Excel.InsightsEndpointOverride",defaultValue:""},CopilotUxRailsOverride:{featureName:"Microsoft.Office.Excel.CopilotUxRailsOverride",defaultValue:!0},CannedOdslDropdown:{featureName:"Microsoft.Office.Excel.CannedOdslDropdown",defaultValue:!1},CalculatedColumnsMaxRows:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxRows",defaultValue:200},CalculatedColumnsMaxCells:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxCells",defaultValue:2e3},CalculatedColumnsMaxPreviewRows:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxPreviewRows",defaultValue:1024},AutofitSelectedRowsColumns:{featureName:"Microsoft.Office.Excel.AutofitSelectedRowsColumns",defaultValue:!0},NeverTimeout:{featureName:"Microsoft.Office.Excel.NeverTimeout",defaultValue:!1},CopilotInsertTable:{featureName:"Microsoft.Office.Excel.CopilotInsertTable",defaultValue:!1}},y={TelemetryUserQueryGuid:"OfficeVSO_8163054_TelemetryUserQueryGuid",NewEntityResolution:"OfficeVSO_8204197_NewEntityResolution",limitPreviewRows:"OfficeVSO_8221261_limitPreviewRows",CalculatedColumnsHostedAugLoop:"OfficeVSO_8118694_ccHostedALSession",previewCalcErrorsTelemetry:"OfficeVSO_8370299_previewCalcErrorsTelemetryV2",AugLoopSessionClosedMessageCard:"OfficeVSO_8253114_AugLoopSessionClosedMessageCard",DontSuggestSimilarAfterInsert:"OfficeVSO_8319973_dontSuggestSimilarAfterInsert",DefaultColorScales:"OfficeVSO_8317167_DefaultColorScales",CalculatedColumnsTLRSupport:"OfficeVSO_8329492_CalculatedColumnsTLRSupport",CalculatedColumnsOnUndo:"OfficeVSO_8364594_CalculatedColumnsOnUndo"},v={showDiscoverInsightsForShortQueries:{featureName:"Microsoft.Office.Excel.FA000000124.ShowDiscoverInsightsForShortQueries",defaultValue:!0},enableForecasting:{featureName:"Microsoft.Office.Excel.FA000000124.EnableForecasting",defaultValue:!1},enableTextAnalysisCitation:{featureName:"Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",defaultValue:!1},enableQuickSummarization:{featureName:"Microsoft.Office.Excel.FA000000124.EnableQuickSummarization",defaultValue:!1},enableFullTheming:{featureName:"Microsoft.Office.Excel.FA000000124.EnableFullTheming",defaultValue:!1},enableSentimentAnalysis:{featureName:"Microsoft.Office.Excel.FA000000124.EnableSentimentAnalysis",defaultValue:!1},useMetadataV2:{featureName:"Microsoft.Office.Excel.FA000000124.UseMetadataV2",defaultValue:!1},enableAdvancedTextAnalysis:{featureName:"Microsoft.Office.Excel.FA000000124.EnableAdvancedTextAnalysis",defaultValue:!1}};const T={isLoaded:!1,deferredFlights:null,sessionId:null,buildNumber:[0,0]};const x={isLoaded:!1,isFeedbackEnabled:!0,feedbackInitializationData:""},S="Microsoft.Office.Excel.FA000000124.";function w(e){const{featureName:t,defaultValue:a}=C[e];if(b.N)switch(typeof a){case"boolean":return!0;case"string":return"";case"number":return 0;default:throw new Error("Flighting type must be a string, boolean, or integer")}const n=t.split(".").pop(),o=`${S}${n}`;switch(typeof a){case"boolean":return R(o,a);case"string":return A(o,a);case"number":return I(o,a);default:throw new Error("Flighting type must be a string, boolean, or integer")}}function E(e){return/^OfficeVSO_\d+_/.test(e)?R(`${S}${e}`,!0):R(`${S}${y[e]}`,!0)}function R(e,t){return OfficeRuntime.experimentation.getBooleanFeatureGate(e,t)}function I(e,t){return OfficeRuntime.experimentation.getIntFeatureGate(e,t)}function A(e,t){return OfficeRuntime.experimentation.getStringFeatureGate(e,t)}function L(){if(!T.isLoaded){const e=new Error("Attempted to access build number before it was set");throw d.M.getInstance().logErrorCode(o.O.FetchUnsetFlight,e,c.S.Error,l.$b.Warning),e}return T.buildNumber}function F(){const e=Object.fromEntries(Object.entries(v).map((([e,t])=>{const{defaultValue:a,featureName:n}=t;switch(typeof a){case"boolean":return[e,R(n,a)];case"number":return[e,I(n,a)];case"string":return[e,A(n,a)];default:(0,m.x)(a)}})));return e.enableLLMChartReco=!0,JSON.stringify(e)}function _(){if(!T.isLoaded){const e=new Error("Attempted to access deferred flights before they were set");throw d.M.getInstance().logErrorCode(o.O.FetchUnsetFlight,e,c.S.Error,l.$b.Warning),e}return T.deferredFlights}function N(){if(!T.isLoaded){const e=new Error("Attempted to access flighting session id before they were set");throw d.M.getInstance().logErrorCode(o.O.FetchUnsetFlight,e,c.S.Error,l.$b.Warning),e}return T.sessionId}let k=!1;const O=new s.d((async()=>{await async function(){if(!k)try{Office.context.platform===Office.PlatformType.OfficeOnline?k=!0:await Excel.run((async e=>{const t=e.flighting.getDeferredFlights(),a=e.flighting.getClientSessionId();await e.sync(),T.deferredFlights=t.value,T.sessionId=a.value;try{const e=Office.context.diagnostics.version.split(".").map((e=>parseInt(e,10))),t=Office.context.platform===Office.PlatformType.Mac?-1:0;e.length>=2-t&&(T.buildNumber=e.slice(-2+t,e.length+t)),k=!0}catch(e){d.M.getInstance().logErrorCode(o.O.FailedToParseClientVersion,e,c.S.Error,l.$b.Warning),T.buildNumber=[0,0]}})),(0,f.S8)(),T.isLoaded=!0}catch(e){d.M.getInstance().logErrorCode(o.O.FlightingFailure,e,c.S.Error,l.$b.Warning),T.isLoaded=!0}}()}));async function P(){x.isLoaded||(R("Microsoft.Office.Excel.FA000000124.IsCanCollectCopilotFeedbackEnabled",!1)?x.isFeedbackEnabled=await async function(){let e=!1;try{e=await OfficeFirstParty.UserFeedback.CanCollectCopilotFeedback(),(0,n.cY)("OfficeFirstParty CanCollectCopilotFeedback : "+e)}catch(t){try{d.M.getInstance().logErrorCode(o.O.FeedbackApiError,t,c.S.Error,l.$b.Warning),(0,n.cY)("Error in UserFeedback CanCollectCopilotFeedback : ",t),e=await OfficeFirstParty.UserFeedback.CanCollectUserFeedback(),(0,n.cY)("OfficeFirstParty CanCollectUserFeedback : ",e)}catch(e){d.M.getInstance().logErrorCode(o.O.FeedbackApiError,e,c.S.Error,l.$b.Warning),(0,n.cY)("Error in UserFeedback CanCollectUserFeedback : ",e)}}return e}():x.isFeedbackEnabled=await async function(){if(!("OfficeFirstParty"in window&&"UserFeedback"in OfficeFirstParty&&"CanCollectUserFeedback"in OfficeFirstParty.UserFeedback))return!0;let e=!0;try{e=await OfficeFirstParty.UserFeedback.CanCollectUserFeedback(),(0,n.cY)("OfficeFirstParty CanCollectUserFeedback= "+e)}catch(e){(0,n.cY)(n.SA.Error,"Error in OfficeFirstParty CanCollectUserFeedback ",e)}return e}(),x.isLoaded=!0)}const M=new s.d((async()=>{await P(),Be()&&(x.feedbackInitializationData=await(0,g.y)())})),D=()=>!b.N&&"true"===(0,h.P)("CopilotSaveAutomation"),$=()=>!b.N&&"true"===(0,h.P)("CopilotPAIntegration");let B;const H=e=>{B=e},U=()=>B?B===u.utd.Enterprise:((0,n.cY)(n.SA.Warning,"isUserTypeOrganization: userType is not defined. Returning false."),!1),q=()=>B?B===u.utd.Consumer:((0,n.cY)(n.SA.Warning,"isUserTypeConsumer: userType is not defined. Returning false."),!1);function V(){return U()&&!(0,i.TB)()}const G=()=>!1;function W(){return U()&&ye()&&R("Microsoft.Office.Excel.FA000000124.EnterpriseGroundingEnabled",!1)&&!Q()}function z(){return W()&&!j()}function Q(){return ye()&&R("Microsoft.Office.Excel.FA000000124.GroundingPhase2Ux",!1)}function J(){return Q()&&E("OfficeVSO_8910862_isUserTypeCheckEnabled")}function j(){return Q()&&U()||Q()&&q()&&R("Microsoft.Office.Excel.FA000000124.IsGroundingPhase2UxEnabledForConsumer",!1)}function Y(){return E("OfficeVSO_8910862_IsHideSingleCitationEnabled")}function X(){return R("Microsoft.Office.Excel.FA000000124.IsEnableAppGptsInCIQ",!1)&&re()}function K(){return j()&&!(0,p.dD)()&&R("Microsoft.Office.Excel.FA000000124.ImportDataEnabledForSearch",!1)}function Z(){return R("Microsoft.Office.Excel.FA000000124.EnableEnterpriseToggleInPhase2Ux",!1)}function ee(){return R("Microsoft.Office.Excel.FA000000124.EnterpriseToggleInPhase2UxHiddenAndDisabled",!1)}function te(){return R("Microsoft.Office.Excel.FA000000124.IsEnterpriseSearchDefaultOn",!1)}function ae(){return Q()&&U()&&R("Microsoft.Office.Excel.FA000000124.IsCIQEnabled",!0)}function ne(){return ae()&&R("Microsoft.Office.Excel.FA000000124.CIQAttachmentList",!1)}function oe(){return ae()&&R("Microsoft.Office.Excel.FA000000124.IsCloudFileUploadEnabled",!1)}function re(){return R("Microsoft.Office.Excel.FA000000124.IsEnableAppGptsInCIQ",!1)}function ie(){return R("Microsoft.Office.Excel.FA000000124.IsEnableAppPluginsInCIQ",!1)}function le(){return R("Microsoft.Office.Excel.FA000000124.IsEnableAppMsgExtInCIQ",!1)}function se(){return R("Microsoft.Office.Excel.FA000000124.IsEnableAppPPInCIQ",!1)}function ce(){return R("Microsoft.Office.Excel.FA000000124.IsEnableAppTypeBInCIQ",!1)}function de(){return R("Microsoft.Office.Excel.FA000000124.IsEnableTopicECC",!1)}function ue(){return ae()&&R("Microsoft.Office.Excel.FA000000124.EnablePluginSearchInFlyout",!1)}function me(){return ae()&&R("Microsoft.Office.Excel.FA000000124.EnableMorePluginHyperLinkInFlyout",!1)}function ge(){return(W()||Q())&&"OfficeFirstParty"in window&&"Sensitivity"in OfficeFirstParty}function he(){return E("OfficeVSO_8910862_UseNewCopilotSharedPackage")}const pe=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.OfficeJsCommanding",!1),be=()=>A("Microsoft.Office.Excel.FA000000124.ForceOfficeJsCommandingSkill","");const fe=()=>x.isFeedbackEnabled,Ce=()=>x.feedbackInitializationData,ye=()=>E("OfficeVSO_8856950_UseNewStreamHandler"),ve=()=>!(0,p.dD)(),Te=()=>R("Microsoft.Office.Excel.FA000000124.showUndoButton",!0),xe=()=>R("Microsoft.Office.Excel.FA000000124.IsTierTwoLocalizationEnabled",!1),Se=()=>R("Microsoft.Office.Excel.FA000000124.IsTierTwoRTLLocalizationEnabled",!1),we=()=>R("Microsoft.Office.Excel.FA000000124.IsTierTwoPointFiveLocalizationEnabled",!1),Ee=()=>R("Microsoft.Office.Excel.FA000000124.IsTierThreeLocalizationEnabled",!1),Re=()=>E("OfficeVSO_8996286_reenablingRehydration"),Ie=()=>E("OfficeVSO_9043928_AlwaysSendCellsToCCSignal"),Ae=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.CFResponseCardShowFormulaExplanation",!1),Le=()=>R("Microsoft.Office.Excel.FA000000124.doNotResolveTableForHybridCCEnabled",!1),Fe=()=>E("OfficeVSO_9117932_calculatedColumnsUseTablesFromSignal"),_e=()=>E("OfficeVSO_9142032_IsMidgardComponentsLocalizationEnabled");function Ne(e,t=!1){const a=e.map((e=>{const[t,a]=e.split(":"),[n,o]=a.split(".");return{platform:Office.PlatformType[t],majorOrDefaultValue:n,minorOrUndefined:o}})).find((e=>e.platform===Office.context.platform));if(!a)return t;try{if("true"===a.majorOrDefaultValue||"false"===a.majorOrDefaultValue)return"true"===a.majorOrDefaultValue;const e=Number.parseInt(a.majorOrDefaultValue,10),t=a.minorOrUndefined?Number.parseInt(a.minorOrUndefined,10):0,[n,o]=L();return n>e||e===n&&o>=t}catch(e){return!1}}const ke=()=>{if(E("OfficeVSO_9275381_refactorBuildVersionCheckV2"))return Ne(["PC:17231","Mac:81.114","iOS:81.24010823","OfficeOnline:true"]);let e;try{e=L()}catch(e){return!1}let t=!1;switch(Office.context.platform){case Office.PlatformType.PC:t=e[0]>=17231;break;case Office.PlatformType.Mac:t=e[0]>81||81===e[0]&&e[1]>=114;break;case Office.PlatformType.iOS:t=e[0]>=81&&e[1]>=24010823;break;case Office.PlatformType.OfficeOnline:t=!0;break;default:t=!1}return t||d.M.getInstance().logError({eventType:c.S.Localization,errorMessage:`Build number ${e} is not valid for new locale APIs`,logLevel:l.$b.Warning}),t},Oe=()=>E("OfficeVSO_9473972_OdslCommandingHumanInTheLoop"),Pe=()=>E("OfficeVSO_9473973_ConditionalFormattingResponseCardWithSample"),Me=()=>E("OfficeVSO_9473975_ConditionalFormattingCustomFormula"),De=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1),$e=()=>ye()&&R("Microsoft.Office.Excel.FA000000124.SelfHelpSearchRenderingEnabled",!1),Be=()=>R("Microsoft.Office.Excel.FA000000124.IsFeedbackAppChatIntegrationEnabled",!1),He=()=>q()&&R("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonAaForConsumers",!1)||R("Microsoft.Office.Excel.FA000000124.PythonAdaInCopilot",!1),Ue=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaClientDataFrameCreation",!1),qe=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaFloatingPlotScaling",!1),Ve=()=>R("Microsoft.Office.Excel.FA000000124.EnablePythonManualPrompt",!1),Ge=()=>R("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)&&R("Microsoft.Office.Excel.FA000000124.EnablePythonRAIOutputGeneration",!1),We=()=>R("Microsoft.Office.Excel.FA000000124.MergePythonCards",!1),ze=()=>!Qe()&&R("Microsoft.Office.Excel.FA000000124.IsPython30SecondsWave1",!1),Qe=()=>R("Microsoft.Office.Excel.FA000000124.IsPython30SecondsWave2",!1),Je=()=>R("Microsoft.Office.Excel.FA000000124.PythonAddResultToNewSheet",!1),je=()=>R("Microsoft.Office.Excel.FA000000124.PythonCalculatedColumns",!1),Ye=()=>tt()&&R("Microsoft.Office.Excel.FA000000124.AugLoop.TableFreeCopilot",!1),Xe=()=>E("OfficeVSO_9426549_NearestTable")||R("Microsoft.Office.Excel.FA000000124.AugLoop.UseNearestTable",!1),Ke=()=>R("Microsoft.Office.Excel.FA000000124.DevDiagButton",!1),Ze=()=>E("OfficeVSO_9412591_telemetryDevButton")&&(r.MYv||(0,i.I_)()),et=()=>!(pe()||Ye()||Xe()),tt=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.TLRImprovements",!1),at=()=>R("Microsoft.Office.Excel.FA000000124.TLRAutoFix",!1),nt=()=>E("OfficeVSO_9249372_unsupportedContext")&&tt(),ot=()=>tt()&&R("Microsoft.Office.Excel.FA000000124.TLRTipCard",!1),rt=()=>R("Microsoft.Office.Excel.FA000000124.AugLoop.SendAugLoopErrorAnnotationWithChatResponse",!1);function it(e,t){return st(e,t)}function lt(e,t){return st(e,t)}function st(e,t){const a=A(e,JSON.stringify(t));try{return JSON.parse(a)}catch(e){return t}}function ct(){return E("OfficeVSO_9231431_ElseZQM")}const dt=()=>U()||R("Microsoft.Office.Excel.FA000000124.isChatHistoryV2EnabledForConsumer",!1)&&q(),ut=()=>E("OfficeVSO_9489189_xlCopilotAppChatHandoff");function mt(){return R("Microsoft.Office.Excel.FA000000124.isReviewerAgentEnabled",!1)}function gt(){return mt()&&R("Microsoft.Office.Excel.FA000000124.isReviewerAgentToggleEnabled",!1)}function ht(){return R("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsInvalidation",!1)}function pt(){return R("Microsoft.Office.Excel.FA000000124.IsMsgExtEnabled",!1)}function bt(){return E("OfficeVSO_9298835_SeparateLocaleInfoFromSelection")}const ft=()=>R("Microsoft.Office.Excel.FA000000124.IsImageInputEnabled",!1);function Ct(){return I("Microsoft.Office.Excel.FA000000124.ImageSizeLimitInKB",700)}function yt(){return R("Microsoft.Office.Excel.FA000000124.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled",!1)}function vt(){return R("Microsoft.Office.Excel.FA000000124.EnableQueryBeforeAnnotationLoad",!1)}function Tt(){return R("Microsoft.Office.Excel.FA000000124.enableProactiveZQMWith3SAPISuggestions",!1)}function xt(){return R("Microsoft.Office.Excel.FA000000124.enableProactiveZQMWithSuggestedQnA",!1)}function St(){return R("Microsoft.Office.Excel.FA000000124.disableALAnnotationsOnPreload",!1)}function wt(){return R("Microsoft.Office.Excel.FA000000124.renderPreloadUIOnIdleOnly",!1)}function Et(){return R("Microsoft.Office.Excel.FA000000124.AugLoop.EnableCreditDeduction",!1)}function Rt(){return R("Microsoft.Office.Excel.FA000000124.CopilotSharedHeader",!1)}function It(){return R("Microsoft.Office.Excel.FA000000124.IsCustomGPTsEnabled",!1)}function At(){return R("Microsoft.Office.Excel.FA000000124.IsSccReadAloudEnabled",!1)}function Lt(){return ft()&&E("OfficeVSO_9374189_IsSketchImageCardEnabled")}function Ft(){return ft()&&E("OfficeVSO_9374365_IsImageResizeEnabled")}function _t(){return I("Microsoft.Office.Excel.FA000000124.ImageSizeLimitInMBWhenResizing",10)}function Nt(){return R("Microsoft.Office.Excel.FA000000124.EnableQueryEndOnGptSwitch",!1)}function kt(){return R("Microsoft.Office.Excel.FA000000124.IsNewChatOnGPTItemsEnabled",!1)}function Ot(){return R("Microsoft.Office.Excel.FA000000124.IsNewChatOnCopilotGPTItemEnabled",!1)}function Pt(){return R("Microsoft.Office.Excel.FA000000124.IsChatClickForGPTsEnabled",!1)}function Mt(){return R("Microsoft.Office.Excel.FA000000124.IsViewMorePromptsIconV2Enabled",!1)}function Dt(){return R("Microsoft.Office.Excel.FA000000124.IsViewMorePromptsOneClickEnabled",!1)}function $t(){return R("Microsoft.Office.Excel.FA000000124.RotatingZQM",!1)}function Bt(){return E("OfficeVSO_9511562_KeptTelemetryRefactor")}function Ht(){return E("OfficeVSO_9529996_SeenTelemetryRefactor")}function Ut(){return R("Microsoft.Office.Excel.FA000000124.IsChatHistoryOnSwitcherMenuEnabled",!1)}function qt(){return I("Microsoft.Office.Excel.FA000000124.ImageResizedSizeInKB",610)}function Vt(){return E("OfficeVSO_3557215_IsApiPluginsCardsEnabled")}function Gt(){return R("Microsoft.Office.Excel.FA000000124.IsOutputV2Enabled",!1)}function Wt(){return E("OfficeVSO_3557154_EnableInterstitialConfirmation")}function zt(){return E("OfficeVSO_3557154_EnableInterstitialAuthentication")}function Qt(){return E("OfficeVSO_3557154_UseCacheForGPTDetails")}function Jt(){return E("OfficeVSO_3557154_IsDAOutputV2Enabled")}function jt(){return E("OfficeVSO_3557154_IsDACopilotBrandingEnabled")}function Yt(){return E("OfficeVSO_3557417_RenameToAgentsEnabled")}function Xt(){return E("OfficeVSO_3557417_DisableClientConfigQueryCharacterForEditorService")}function Kt(){return R("Microsoft.Office.Excel.FA000000124.AddExtensibiltyDataToFeedbackOCV",!0)}},18541:(e,t,a)=>{a.d(t,{Ns:()=>Ea,RU:()=>La,h7:()=>Ia,q:()=>Ra});var n,o=a(81364),r=a(72842);class i{toString(){return this.address}constructor(e){this.address=e}}class l{toString(){return null==this.value?'""':`"${Se(this.value)}"`}getValue(){return this.value&&Se(this.value)}constructor(e){this.value=e}}class s{toString(){return null==this.value?"":this.value?"TRUE":"FALSE"}constructor(e){this.value=e}}class c{toString(){return null==this.value?"":this.value.toString()}constructor(e){this.value=e}}class d{toString(){return null==this.valueOrArray?"":"number"==typeof this.valueOrArray?`${this.valueOrArray}`:this.valueOrArray.length>0&&"number"==typeof this.valueOrArray[0]?1===this.valueOrArray.length?`${this.valueOrArray[0]}`:`{${this.valueOrArray.join(",")}}`:`{${this.valueOrArray.map((e=>e.join(","))).join(";")}}`}constructor(e){this.valueOrArray=e}}class u{toString(){return null==this.valueOrArray?"":"string"==typeof this.valueOrArray?new l(this.valueOrArray).toString():this.valueOrArray.length>0&&"string"==typeof this.valueOrArray[0]?1===this.valueOrArray.length?new l(this.valueOrArray[0]).toString():`{${this.valueOrArray.map((e=>new l(e).toString())).join(",")}}`:`{${this.valueOrArray.map((e=>e.map((e=>new l(e).toString())).join(","))).join(";")}}`}constructor(e){this.valueOrArray=e}}class m{toString(){return this.brackets?`(${this.left.toString()}${this.op}${this.right.toString()})`:`${this.left.toString()}${this.op}${this.right.toString()}`}constructor(e,t,a,n){this.op=e,this.left=t,this.right=a,this.brackets=n}}class g{toString(){return this.brackets?`(${this.left.toString()}${this.op}${this.right.toString()})`:`${this.left.toString()}${this.op}${this.right.toString()}`}constructor(e,t,a,n){this.op=e,this.left=t,this.right=a,this.brackets=n}}class h{toString(){let e=this.params.length;for(;e>=1&&(null===this.params[e-1]||void 0===this.params[e-1]);e--);return`${this.functionName}(${this.params.slice(0,e).map((e=>null==e?"":e.toString())).join(",")})`}constructor(...e){this.params=e}}class p extends h{constructor(...e){super(...e),this.functionName="ROUND"}}class b extends h{constructor(...e){super(...e),this.functionName="CEILING.MATH"}}class f extends h{toString(){const[e,t]=this.params;return null==t?`${this.functionName}(${e.toString()})`:super.toString()}constructor(...e){super(...e),this.functionName="FLOOR.MATH"}}class C extends h{constructor(...e){super(...e),this.functionName="MEDIAN"}}class y extends h{constructor(...e){super(...e),this.functionName="TRANSPOSE"}}class v extends h{constructor(...e){super(...e),this.functionName="SUBSTITUTE"}}class T extends h{toString(){const[e,t,a]=this.params;return null==a?null==t?`${this.functionName}(${e.toString()},,)`:`${this.functionName}(${e.toString()},${t.toString()})`:super.toString()}constructor(...e){super(...e),this.functionName="INDEX"}}class x extends h{constructor(...e){super(...e),this.functionName="ISBLANK"}}class S extends h{constructor(...e){super(...e),this.functionName="ISNUMBER"}}class w extends h{constructor(...e){super(...e),this.functionName="ISTEXT"}}class E extends h{constructor(...e){super(...e),this.functionName="ISERROR"}}class R extends h{constructor(...e){super(...e),this.functionName="ISLOGICAL"}}class I extends h{constructor(...e){super(...e),this.functionName="MATCH"}}class A extends h{constructor(...e){super(...e),this.functionName="XMATCH"}}class L extends h{constructor(...e){super(...e),this.functionName="XLOOKUP"}}class F extends h{constructor(...e){super(...e),this.functionName="MUNIT"}}class _ extends h{constructor(...e){super(...e),this.functionName="AVERAGEIFS"}}class N extends h{constructor(...e){super(...e),this.functionName="MAXIFS"}}class k extends h{constructor(...e){super(...e),this.functionName="MINIFS"}}class O extends h{constructor(...e){super(...e),this.functionName="COUNTIFS"}}class P extends h{constructor(...e){super(...e),this.functionName="SUMIFS"}}class M{toString(){const e=this.formula instanceof l||this.formula instanceof c||this.formula instanceof s,t=this.formula instanceof l?this.formula.getValue():this.formula.toString();switch(this.op){case"startWith":return e?`"=${t}*"`:`"="&${t}&"*"`;case"endWith":return e?`"=*${t}"`:`"=*"&${t}`;case"contain":return e?`"=*${t}*"`:`"=*"&${t}&"*"`;default:return e?`"${this.op}${t}"`:`"${this.op}"&${t}`}}constructor(e,t){this.op=e,this.formula=t}}class D{toString(){return`${this.range.toString()},${this.criteria.toString()}`}constructor(e,t){this.range=e,this.criteria=t}}class $ extends h{constructor(...e){super(...e),this.functionName="SUM"}}class B extends h{constructor(...e){super(...e),this.functionName="AVERAGE"}}class H extends h{constructor(...e){super(...e),this.functionName="MAX"}}class U extends h{constructor(...e){super(...e),this.functionName="MIN"}}class q extends h{constructor(...e){super(...e),this.functionName="MOD"}}class V extends h{constructor(...e){super(...e),this.functionName="COUNTA"}}class G extends h{constructor(...e){super(...e),this.functionName="COLUMN"}}class W extends h{constructor(...e){super(...e),this.functionName="ROW"}}class z extends h{constructor(...e){super(...e),this.functionName="COLUMNS"}}class Q extends h{constructor(...e){super(...e),this.functionName="ROWS"}}class J extends h{constructor(...e){super(...e),this.functionName="SEQUENCE"}}class j extends h{constructor(...e){super(...e),this.functionName="SORTBY"}}class Y{toString(){return`${this.array.toString()},${this.order}`}constructor(e,t){this.array=e,this.order=t}}class X extends h{toString(){const[e,t,a]=this.params;return t?a?`${this.functionName}(${e.toString()},${t.toString()},${a.toString()})`:`${this.functionName}(${e.toString()},${t.toString()})`:`${this.functionName}(${e.toString()})`}constructor(...e){super(...e),this.functionName="SORT"}}class K{}class Z extends K{toString(){return`(TRUE)-(${this.condition.toString()})`}constructor(e){super(),this.condition=e}}class ee extends K{toString(){return`${this.left instanceof ee||this.left instanceof h?this.left.toString():`(${this.left.toString()})`}*${this.right instanceof ee||this.right instanceof h?this.right.toString():`(${this.right.toString()})`}`}constructor(e,t){super(),this.left=e,this.right=t}}class te extends K{toString(){return`${this.left instanceof te||this.left instanceof ee||this.left instanceof h?this.left.toString():`(${this.left.toString()})`}+${this.right instanceof te||this.right instanceof ee||this.right instanceof h?this.right.toString():`(${this.right.toString()})`}`}constructor(e,t){super(),this.left=e,this.right=t}}class ae extends h{constructor(...e){super(...e),this.functionName="FILTER"}}class ne extends h{constructor(...e){super(...e),this.functionName="CHOOSE"}}class oe extends h{toString(){const[e,t,a]=this.params;return t||a?super.toString():`${this.functionName}(${e.toString()})`}constructor(...e){super(...e),this.functionName="UNIQUE"}}class re extends h{constructor(...e){super(...e),this.functionName="MMULT"}}class ie extends h{constructor(...e){super(...e),this.functionName="FIND"}}class le extends h{constructor(...e){super(...e),this.functionName="SEARCH"}}class se extends h{constructor(...e){super(...e),this.functionName="IF"}}class ce extends h{constructor(...e){super(...e),this.functionName="IFERROR"}}class de extends h{constructor(...e){super(...e),this.functionName="LEN"}}class ue extends h{constructor(...e){super(...e),this.functionName="RIGHT"}}class me extends h{constructor(...e){super(...e),this.functionName="DATE"}}class ge extends h{constructor(...e){super(...e),this.functionName="TIME"}}class he extends h{constructor(...e){super(...e),this.functionName="NA"}}class pe extends h{constructor(...e){super(...e),this.functionName="YEAR"}}class be extends h{constructor(...e){super(...e),this.functionName="MONTH"}}class fe extends h{constructor(...e){super(...e),this.functionName="DAY"}}class Ce extends h{constructor(...e){super(...e),this.functionName="HOUR"}}class ye extends h{constructor(...e){super(...e),this.functionName="MINUTE"}}class ve extends h{constructor(...e){super(...e),this.functionName="SECOND"}}class Te extends h{constructor(...e){super(...e),this.functionName="TEXT"}}class xe{static formulaRound(e,t){return new p(e,new c(t))}static formulaCeilingMath(e){return new b(e)}static formulaFloorMath(e,t){return new f(e,t?new c(t):null)}static formulaMedian(e){return new C(e)}static formulaTranspose(e){return new y(e)}static formulaSubstitute(e,t,a){return new v(e,"string"==typeof t?new l(t):t,"string"==typeof a?new l(a):a)}static formulaIndex(e,t,a){let n,o;return n=null==t?null:"number"==typeof t||t instanceof Array?new d(t):t,o=null==a?null:"number"==typeof a||a instanceof Array?new d(a):a,new T(e,n,o)}static formulaIsBlank(e){return new x(e)}static formulaIsNumber(e){return new S(e)}static formulaIsText(e){return new w(e)}static formulaIsError(e){return new E(e)}static formulaIsLogical(e){return new R(e)}static formulaMatch(e,t,a){return new I(e,t,new c(null==a?1:a))}static formulaXMatch(e,t,a,n){return new A(e,t,new c(null==a?0:a),new d(null==n?1:n))}static formulaXLookup(e,t,a,n,o,r){return new L(e,t,a,n,new c(o||0),new c(null==r?1:r))}static formulaMunit(e){return new F("number"==typeof e?new c(e):e)}static formulaAverageifs(e,t){return new _(e,...t)}static formulaMaxifs(e,t){return new N(e,...t)}static formulaMinifs(e,t){return new k(e,...t)}static formulaCountifs(e){return new O(...e)}static formulaSumifs(e,t){return new P(e,...t)}static formulaSum(e){return e instanceof Array?new $(...e):new $(e)}static formulaAverage(e){return new B(e)}static formulaCountA(e){return new V(e)}static formulaMax(e){return new H(e)}static formulaMin(e){return e instanceof Array?new U(...e):new U(e)}static formulaMod(e,t){return new q(e,new d(t))}static formulaColumn(e){return new G(e)}static formulaRow(e){return new W(e)}static formulaColumns(e){return new z(e)}static formulaRows(e){return new Q(e)}static formulaSequence(e,t,a,n){const o="number"==typeof e?new c(e):e;let r,i,l;return r=null==n?null:"number"==typeof n?new c(n):n,i=null==a?null:"number"==typeof a?new c(a):a,l=null==t?null:"number"==typeof t?new c(t):t,new J(o,l,i,r)}static formulaSortBy(e,t){return new j(e,...t)}static formulaSort(e,t,a){return null==(t||a)?new X(e,null,null):new X(e,"number"==typeof t||t instanceof Array?new d(t):t,null==a?null:new d(a))}static formulaFilter(e,t){return new ae(e,t)}static formulaChoose(e,...t){return new ne(e,...t)}static formulaUnique(e,t,a){return new oe(e,null==t?null:new s(t),null==a?null:new s(t))}static formulaMmult(e,t){return new re(e,t)}static formulaFind(e,t){return new ie("string"==typeof e?new l(e):e,t)}static formulaSearch(e,t){return new le("string"==typeof e?new l(e):e,t)}static formulaIf(e,t,a){return new se(e,t,a)}static formulaIfError(e,t){return new ce(e,t)}static formulaLen(e){return new de(e)}static formulaRight(e,t){return new ue(e,t)}static formulaDate(e,t,a){const n="number"==typeof e?new c(e):e,o="number"==typeof t?new c(t):t,r="number"==typeof a?new c(a):a;return new me(n,o,r)}static formulaTime(e,t,a){const n="number"==typeof e?new c(e):e,o="number"==typeof t?new c(t):t,r="number"==typeof a?new c(a):a;return new ge(n,o,r)}static formulaNA(){return new he}static formulaYear(e){return new pe("number"==typeof e?new c(e):e)}static formulaMonth(e){return new be("number"==typeof e?new c(e):e)}static formulaDay(e){return new fe("number"==typeof e?new c(e):e)}static formulaHour(e){return new Ce("number"==typeof e?new c(e):e)}static formulaMinute(e){return new ye("number"==typeof e?new c(e):e)}static formulaSecond(e){return new ve("number"==typeof e?new c(e):e)}static formulaText(e,t){return new Te(e,new l(t))}}function Se(e){return e.replace(/"/g,'""')}function we(e){return e.replace(/~/g,"~~").replace(/\*/g,"~*").replace(/\?/g,"~?")}function Ee(e,t){return xe.formulaSubstitute(xe.formulaSubstitute(xe.formulaSubstitute(e,"~",t?"~~":xe.formulaIf(new g(">",xe.formulaMmult(xe.formulaIfError(xe.formulaFind(new u(["*","?"]),e),new c(0)),new d([[1],[1]])),new c(0)),new l("~~"),new l("~"))),"*","~*"),"?","~?")}function Re(e){const t=/^([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+\.[0-9]+)/.exec(e);if(7!==t.length)throw new Error("wrong datetime structure");const[a,n,o,r,i,l]=t.filter(((e,t)=>t>0)).map((e=>parseFloat(e)));return new m("+",xe.formulaDate(a,n,o),xe.formulaTime(r,i,l))}class Ie extends Error{constructor(e,t){super(t||""),this.errorCode=e,Object.setPrototypeOf(this,Ie.prototype)}}function Ae(e,t,a){const[n,o,l,s,d,u]=(e=>{if(Oe(e)){const t=new i(a(e.sourceDataReference.left));return[xe.formulaYear(t),xe.formulaMonth(t),xe.formulaDay(t),xe.formulaHour(t),xe.formulaMinute(t),xe.formulaSecond(t)]}{const t=/^([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+\.[0-9]+)/.exec(e.value);if(7!==t.length)throw new Error("wrong datetime structure");return t.filter(((e,t)=>t>0)).map((e=>new c(parseFloat(e))))}})(t);switch(e){case"date":return xe.formulaDate(n,o,l);case"decade":return xe.formulaFloorMath(xe.formulaMod(n,100),10);case"year":return n;case"quarter":return xe.formulaCeilingMath(new m("/",o,new c(3)));case"month":return o;case"dayOfMonth":return l;case"hour":return s;case"minute":return d;case"hourAndMinute":return xe.formulaTime(s,d,0);case"hourMinuteAndSecond":return xe.formulaTime(s,d,u);case"dateAndHour":return new m("+",xe.formulaDate(n,o,l),xe.formulaTime(s,0,0));case"dateHourAndMinute":return new m("+",xe.formulaDate(n,o,l),xe.formulaTime(s,d,0));case"dateHourMinuteAndSecond":return new m("+",xe.formulaDate(n,o,l),xe.formulaTime(s,d,u));case"monthAndDay":return xe.formulaDate(0,o,l);case"yearAndMonth":return xe.formulaDate(n,o,1);case"yearAndQuarter":return xe.formulaCeilingMath(new m("/",new m("+",new m("*",n,new c(12)),o),new c(3)));default:return(0,r.x)(e)}}function Le(e,t){if(!Oe(e.source))throw new Ie("TranslationFailure","only column name expressions are supported as source of Date Function in project or group columns");switch(e.datePartFunction){case"date":return xe.formulaText(t,"yyyy-mm-dd");case"decade":return xe.formulaText(xe.formulaFloorMath(xe.formulaMod(xe.formulaYear(t),100),10),"00");case"year":return xe.formulaText(t,"yyyy");case"quarter":return xe.formulaText(xe.formulaCeilingMath(new m("/",xe.formulaMonth(t),new c(3))),'"Q"0');case"month":return xe.formulaText(t,"mm");case"dayOfMonth":case"hour":return xe.formulaText(t,"dd");case"minute":return xe.formulaText(xe.formulaMinute(t),"00");case"hourAndMinute":return xe.formulaText(t,"hh:mm AM/PM");case"hourMinuteAndSecond":return xe.formulaText(t,"hh:mm:ss AM/PM");case"dateAndHour":return xe.formulaText(t,"yyyy-mm-dd h AM/PM");case"dateHourAndMinute":return xe.formulaText(t,"yyyy-mm-dd h:mm AM/PM");case"dateHourMinuteAndSecond":return xe.formulaText(t,"yyyy-mm-dd h:mm:ss AM/PM");case"monthAndDay":return xe.formulaText(t,"mm-dd");case"yearAndMonth":return xe.formulaText(t,"yyyy-mm");case"yearAndQuarter":return new m("&",xe.formulaYear(t),xe.formulaText(xe.formulaCeilingMath(new m("/",xe.formulaMonth(t),new c(3))),'" Q"0'));default:return(0,r.x)(e.datePartFunction)}}!function(e){e.ProactiveLimitation="ProactiveLimitation",e.ValidationIssue="ValidationIssue",e.TranslationFailure="TranslationFailure",e.ExceedLengthLimitation="ExceedLengthLimitation",e.ContentTooLarge="ContentTooLarge",e.Unknown="Unknown"}(n||(n={}));class Fe{getTableAddress(){return this.isFake?null:this.address}getColumnAddress(e){return this.isFake?null:this.columns[e].columnAddress}getColumnLength(){return this.isFake?-1:this.columns.length}constructor(e,t,a){this.isFake=e,this.columns=t,this.address=a}}function _e(e){return!!e&&"query"===e.exprType}function Ne(e){return!!e&&"inQuery"===e.exprType}function ke(e){return!!e&&"distinct"===e.exprType}function Oe(e){return!!e&&"columnName"===e.exprType}function Pe(e){return!!e&&"datePart"===e.exprType}function Me(e){return!!e&&["average","count","max","median","min","sum"].some((t=>t===e.exprType))}function De(e){return!!e&&["and","or"].some((t=>t===e.exprType))}function $e(e){return!!e&&"not"===e.exprType}function Be(e){return!!e&&["contains","equality","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","startsWith","endsWith"].some((t=>t===e.exprType))}function He(e){return!!e&&"numberLiteral"===e.exprType}function Ue(e){return!!e&&"booleanLiteral"===e.exprType}function qe(e){return!!e&&("dateTimeLiteral"===e.exprType||"stringLiteral"===e.exprType)}function Ve(e,t){return JSON.stringify(e)===JSON.stringify(t)}const Ge=8e5,We=5e4,ze=1e3,Qe=3e4,Je=5e4;class je{translate(){const{projectClause:e,whereClause:t,havingClause:a,sortClause:o,takeClause:r,groupClause:i,rankingClause:l}=this.queryResult;if(l)throw new Ie(n.TranslationFailure,"ranking clause is not supported at present");const c=e.length;let u=!1;if(o&&o.length>0)for(let t=0;t<o.length;t++)e.findIndex((e=>Ve(o[t].expr,e)))<0&&(u=!0,e.push(o[t].expr));if(e.length>254)throw new Ie(n.TranslationFailure,"length of project clause can not be larger than 254");const m=e.some((e=>Me(e))),g=e.some((e=>Oe(e)||Pe(e)));let h;const p=e.map((e=>Oe(e)?e.sourceDataReference.left:null)),b=this.calculateColumnIndexNeedNumberCheckForFilter(t),f=this.includeNumberCheckInFilterCondition(b,t&&this.calculateFilterInclude(h,t));let C;if(!m&&g?h=this.calculateOnlyNonAggregations(p,f):(C=this.calculateBothColumnsAndAggregations(f,b),h=1===C.valueList.length?C.valueList[0]:xe.formulaChoose(new d(C.indexStartFromOneList),...C.valueList)),a&&(h=xe.formulaFilter(h,xe.formulaIfError(this.calculateFilterInclude(h,a),new s(!1)))),o){const t=o.map((t=>e.findIndex((e=>Ve(t.expr,e)))+1)),a=o.map((e=>"asc"===e.order?1:-1));h=xe.formulaSort(h,t,a)}else i&&(h=xe.formulaSort(h,1===e.length?null:e.map(((e,t)=>Oe(e)||Pe(e)?t+1:null)).filter((e=>null!=e))));return r&&(h=xe.formulaIndex(h,xe.formulaSequence(r),xe.formulaSequence(1,e.length))),u&&(h=xe.formulaIndex(h,xe.formulaSequence(xe.formulaRows(h)),xe.formulaSequence(1,c))),h}calculateColumnIndexNeedNumberCheckForFilter(e){if(!e)return[];if(Be(e)){const t=[];return!Oe(e.left)||"greaterThanOrEqual"!==e.exprType&&"greaterThan"!==e.exprType&&"lessThanOrEqual"!==e.exprType&&"lessThan"!==e.exprType||t.push(e.left.sourceDataReference.left),!Oe(e.right)||"greaterThanOrEqual"!==e.exprType&&"greaterThan"!==e.exprType&&"lessThanOrEqual"!==e.exprType&&"lessThan"!==e.exprType||t.push(e.right.sourceDataReference.left),t.filter(((e,t,a)=>a.indexOf(e)===t))}return $e(e)?this.calculateColumnIndexNeedNumberCheckForFilter(e.expr):De(e)?[...this.calculateColumnIndexNeedNumberCheckForFilter(e.left),...this.calculateColumnIndexNeedNumberCheckForFilter(e.right)].filter(((e,t,a)=>a.indexOf(e)===t)):[]}includeNumberCheckInFilterCondition(e,t){let a=t;for(let t=0;t<e.length;t++)a=a?new ee(xe.formulaIsNumber(new i(this.content.getColumnAddress(e[t]))),a):xe.formulaIsNumber(new i(this.content.getColumnAddress(e[t])));return a}calculateBothColumnsAndAggregations(e,t){const{projectClause:a,groupClause:o,whereClause:r}=this.queryResult,l=[],s=new i(this.content.getTableAddress()),c=xe.formulaUnique(this.calculateNonAggregatedPart(o||[],s,e)),d=[];let u=0;const m=!!o&&Ve(o,a.slice(0,o.length));return m&&(l.push(c),u=1),a.forEach((a=>{if(Oe(a)||Pe(a)){if(!o)throw new Ie(n.TranslationFailure,"non-aggregated columns must be in the group clause if there are aggregations");m?d.push(1):(l.push(1===o.length?c:xe.formulaIndex(c,null,o.findIndex((e=>Ve(e,a)))+1)),u+=1,d.push(u))}else{if(!Me(a))throw new Error;l.push(this.calculateAggregationWithCustomFunction(a,e,t)),u+=1,d.push(u)}})),{indexStartFromOneList:d,valueList:l}}calculateNonAggregatedPart(e,t,a){const n=this.calculateNonAggregatedPartWithoutFilter(e,t),o=1===n.valueList.length?n.valueList[0]:xe.formulaChoose(new d(n.indexStartFromOneList),...n.valueList);return a?xe.formulaFilter(o,a):o}calculateNonAggregatedPartWithoutFilter(e,t,a){const o=[];let r=0;const i=[],l=e.filter((e=>Oe(e))).length,s=e.length-l,c=!a&&(l>3||0===s);if(c){const a=e.map((e=>Oe(e)?e.sourceDataReference.left:0)),n=this.getSubTableWithSeveralColumns(a,t,!0);o.push(n),r=1}for(let a=0;a<e.length;a++){const l=e[a];if(Oe(l))if(c)i.push(1);else{r+=1,i.push(r);const e=this.getSubTableWithSeveralColumns([l.sourceDataReference.left],t,!0);o.push(e)}else{if(r+=1,i.push(r),!Oe(l.source))throw new Ie(n.TranslationFailure,"only columnName expressions are supported as the source of date part function in project or group clause");const e=this.getSubTableWithSeveralColumns([l.source.sourceDataReference.left],t,!0);o.push(Le(l,e))}}return{indexStartFromOneList:i,valueList:o}}calculateDatePartComparison(e){const{left:t,right:a,exprType:o}=e;if(!Pe(t)||!Pe(a)||t.datePartFunction!==a.datePartFunction)throw new Ie(n.TranslationFailure,"only two date part expressions with the same date part function could be compared");const r={greaterThan:">",greaterThanOrEqual:">=",lessThan:"<",lessThanOrEqual:"<=",equality:"="};if(!Object.prototype.hasOwnProperty.call(r,o))throw new Ie(n.TranslationFailure,"only >,>=,<,<=,= are supported in date part comparison");const i=Ae(t.datePartFunction,t.source,this.content.getColumnAddress.bind(this.content)),l=Ae(a.datePartFunction,a.source,this.content.getColumnAddress.bind(this.content));return new g(r[o],i,l)}calculateOnlyNonAggregations(e,t){const{groupClause:a,projectClause:n}=this.queryResult,o=new i(this.content.getTableAddress());let r=this.calculateNonAggregatedPart(n,o,t);return e&&e.length===this.content.getColumnLength()&&e.every(((e,t)=>e===t))&&(r=t?xe.formulaFilter(o,t):o),a&&(r=xe.formulaUnique(r)),r}calculateAggregationWithNativeFunction(e,t,a){const n=[...t||[],...a||[]],o=null!=(t||a),l=e.expr;if(Oe(l)){const t=new i(this.content.getColumnAddress(l.sourceDataReference.left));switch(e.exprType){case"sum":return o?xe.formulaSumifs(t,n):xe.formulaSum(t);case"average":return o?xe.formulaAverageifs(t,n):xe.formulaAverage(t);case"count":{const e=(this.queryResult.groupClause||[]).map((e=>e.sourceDataReference.left));if(this.queryResult.groupClause&&!e.some((e=>e===l.sourceDataReference.left)))throw new Error("use custom calculation when there are group columns but the counted column is not one of them");return o?xe.formulaCountifs(n):xe.formulaCountA(t)}case"max":return o?xe.formulaMaxifs(t,n):xe.formulaMax(t);case"min":return o?xe.formulaMinifs(t,n):xe.formulaMin(t);case"median":if(!o)return xe.formulaMedian(t);break;default:(0,r.x)(e.exprType)}}if(null==l&&"count"===e.exprType)return o?xe.formulaCountifs(n):xe.formulaRows(new i(this.content.getTableAddress()));throw new Error}calculateAggregationWithCustomFunction(e,t,a){const{whereClause:n,groupClause:o}=this.queryResult,l=(o||[]).length,s=e.expr,d=new i(this.content.getTableAddress());if(!o||0===l){if(Oe(s)){const a=new i(this.content.getColumnAddress(s.sourceDataReference.left)),n=t?xe.formulaFilter(a,t):a;switch(e.exprType){case"sum":return xe.formulaSum(n);case"count":{const e=t?xe.formulaFilter(a,new ee(new Z(xe.formulaIsBlank(a)),t)):a;return xe.formulaCountA(e)}case"average":return xe.formulaAverage(n);case"median":return xe.formulaMedian(n);case"min":return xe.formulaMin(n);case"max":return xe.formulaMax(n);default:(0,r.x)(e.exprType)}}else{if(ke(s)){if(s.exprs&&0!==s.exprs.length){if(1!==s.exprs.length)throw Error("doesn't support more than 1 expression in Distinct Expression");{const e=s.exprs[0],a=new i(this.content.getColumnAddress(e.sourceDataReference.left)),n=t?xe.formulaFilter(a,t):a;return t?xe.formulaSum(xe.formulaIf(xe.formulaIsError(xe.formulaUnique(n)),new c(0),new c(1))):xe.formulaCountA(xe.formulaUnique(n))}}throw Error("invalid arguments")}if(null==s&&"count"===e.exprType){const e=t?xe.formulaFilter(d,t):d;return xe.formulaRows(e)}}throw new Error("currently not support such expression")}const u=this.calculateNonAggregatedPart(o,d,t),m=this.calculateNonAggregatedPartWithoutFilter(o,d,!0),g=je.concatColumns(l,m.valueList,m.indexStartFromOneList);if(Oe(s)){const h=new i(this.content.getColumnAddress(s.sourceDataReference.left)),p=n?this.includeNumberCheckInFilterCondition([...a,s.sourceDataReference.left].filter(((e,t,a)=>a.indexOf(e)===t)),this.calculateFilterInclude(d,n)):xe.formulaIsNumber(h),b=this.calculateNonAggregatedPart([...o||[],s],d,p),f=xe.formulaSort(b,xe.formulaSequence(1,l+1)),C=this.calculateNonAggregatedPart(o,d,p),y=xe.formulaSort(u,xe.formulaSequence(1,l)),v=t?xe.formulaFilter(g,t):g,T=xe.formulaSortBy(v,m.valueList.map((e=>new Y(t?xe.formulaFilter(e,t):e,1)))),x=xe.formulaSort(C,xe.formulaSequence(1,l)),S=xe.formulaFilter(g,p),w=xe.formulaSortBy(S,m.valueList.map((e=>new Y(xe.formulaFilter(e,p),1)))),E=je.getHelperMatrix(l,u,l),R=t?xe.formulaFilter(h,t):h,I=xe.formulaIndex(f,null,l+1),A=xe.formulaSortBy(xe.formulaSequence(xe.formulaRows(xe.formulaUnique(u))),(o||[]).map(((e,t)=>new Y(l>1?xe.formulaIndex(xe.formulaUnique(u),null,t+1):xe.formulaUnique(u),1))));switch(e.exprType){case"sum":return je.customSumGroupBy(E,xe.formulaIf(xe.formulaIsNumber(R),R,new c(0)));case"count":return je.customCountGroupBy(E,R,!1,!1);case"average":{const e=je.customSumGroupBy(E,xe.formulaIf(xe.formulaIsNumber(R),R,new c(0))),t=je.customCountGroupBy(E,R,!0,!1);return je.customAverageGroupBy(e,t)}case"median":return xe.formulaSortBy(je.customMedianGroupBy(l,y,x,I,T,w),[new Y(A,1)]);case"min":return xe.formulaSortBy(je.customMinMaxGroupBy(l,y,x,I,!1),[new Y(A,1)]);case"max":return xe.formulaSortBy(je.customMinMaxGroupBy(l,y,x,I,!0),[new Y(A,1)]);default:(0,r.x)(e.exprType)}}else if(ke(s)){if(!s.exprs||0===s.exprs.length)throw Error("invalid arguments");if(1!==s.exprs.length)throw Error("doesn't support more than 1 expression in Distinct Expression");{const e=s.exprs[0];if(Oe(e)){const a=xe.formulaUnique(this.calculateNonAggregatedPart([...o||[],e],d,t)),n=je.getHelperMatrix(l,a,l+1);return je.customCountGroupBy(n,xe.formulaIndex(a,null,l+1),!1,!0)}}}else if(null==s&&"count"===e.exprType){const e=je.getHelperMatrix(l,u,l),a=t?xe.formulaFilter(d,t):d,n=xe.formulaSequence(xe.formulaRows(a),1,1,0);return xe.formulaMmult(e,n)}throw new Error("currently not support such expression")}getSubTableWithSeveralColumns(e,t,a){return a&&1===e.length?new i(this.content.getColumnAddress(e[0])):xe.formulaIndex(t,1===e.length?null:xe.formulaSequence(xe.formulaRows(t)),1===e.length?e[0]+1:e.map((e=>e+1)))}static getHelperMatrix(e,t,a){const n=je.joinColumnText(e,t,a),o=xe.formulaUnique(n);return new m("+",new g("=",o,xe.formulaTranspose(n),!0),new c(0),!0)}static concatColumns(e,t,a){if(e<2)return t[0];let n=xe.formulaSubstitute(xe.formulaSubstitute(t[a[0]-1],"\\","\\\\"),",","\\,");for(let o=1;o<e;o++)n=new m("&",new m("&",n,new l(",")),xe.formulaSubstitute(xe.formulaSubstitute(t[a[o]-1],"\\","\\\\"),",","\\,"));return n}static joinColumnText(e,t,a){if(e<2)return a<2?t:xe.formulaIndex(t,null,1);let n=xe.formulaSubstitute(xe.formulaSubstitute(xe.formulaIndex(t,null,1),"\\","\\\\"),",","\\,");for(let a=1;a<e;a++)n=new m("&",new m("&",n,new l(",")),xe.formulaSubstitute(xe.formulaSubstitute(xe.formulaIndex(t,null,a+1),"\\","\\\\"),",","\\,"));return n}static customSumGroupBy(e,t){return xe.formulaMmult(e,t)}static customAverageGroupBy(e,t){return new m("/",e,t)}static customCountGroupBy(e,t,a,n){let o;return o=a?new m("+",xe.formulaIsNumber(t),new c(0)):n?xe.formulaSequence(xe.formulaRows(t),1,1,0):new m("-",new c(1),xe.formulaIsBlank(t)),xe.formulaMmult(e,o)}static customMedianGroupBy(e,t,a,n,o,r){const i=e>1?o:je.joinColumnText(e,t,e),l=xe.formulaUnique(i),s=e>1?r:je.joinColumnText(e,a,e),u=xe.formulaXMatch(l,s,0,1),g=xe.formulaXMatch(l,s,0,[1,-1]),h=xe.formulaMmult(xe.formulaIfError(g,new c(1)),new d([[.5],[.5]])),p=xe.formulaRound(new m("+",new m("*",h,new d([1,1])),new d([0,-.5])),0);return xe.formulaIf(xe.formulaIsNumber(u),xe.formulaMmult(xe.formulaIndex(n,p),new d([[.5],[.5]])),xe.formulaNA())}static customMinMaxGroupBy(e,t,a,n,o){const r=je.joinColumnText(e,t),i=xe.formulaUnique(r),l=je.joinColumnText(e,a),s=xe.formulaXMatch(i,l,0,1),d=xe.formulaXMatch(i,l,0,-1),u=o?d:s;return xe.formulaIfError(xe.formulaIndex(n,u),new c(0))}calculateWhereCriteria(e){if(De(e)){if("or"===e.exprType)throw new Error('aggregation-ifs function could only deal with "AND" logic, fall back to custom function');return[...this.calculateWhereCriteria(e.left),...this.calculateWhereCriteria(e.right)]}if(Be(e)){if(!Oe(e.left)||(!(t=e.right)||!["numberLiteral","stringLiteral","booleanLiteral","dateTimeLiteral"].some((e=>e===t.exprType))))throw new Error("aggregation-ifs function could only deal with comparison of column and literals");const a=new i(this.content.getColumnAddress(e.left.sourceDataReference.left)),n=je.calculateLiteralPartInCriteria(e.right,!1),o=je.calculateLiteralPartInCriteria(e.right,!0);switch(e.exprType){case"greaterThan":return[new D(a,new M(">",n))];case"greaterThanOrEqual":return[new D(a,new M(">=",n))];case"lessThan":return[new D(a,new M("<",n))];case"lessThanOrEqual":return[new D(a,new M("<=",n))];case"equality":return[new D(a,new M("=",n))];case"contains":return[new D(a,new M("contain",o))];case"startsWith":return[new D(a,new M("startWith",o))];case"endsWith":return[new D(a,new M("endWith",o))];default:throw new Error("unsupported comparison type")}}var t;throw new Error}static calculateLiteralPartInCriteria(e,t){return qe(e)?"dateTimeLiteral"===e.exprType?Re(e.value):new l(function(e,t){let a=t||e.includes("*")||e.includes("?")?e.replace(/~/g,"~~"):e;return a=a.replace(/\*/g,"~*").replace(/\?/g,"~?"),a}(e.value,t)):He(e)?new c(e.value):Ue(e)?new s(e.value):(0,r.x)(e)}calculateGroupCriteria(e){const{groupClause:t,whereClause:a}=this.queryResult;let n=new i(this.content.getTableAddress());const o=(t||[]).map((e=>e.sourceDataReference.left+1));if(a){const t=this.calculateFilterInclude(n,a);n=xe.formulaFilter(n,this.includeNumberCheckInFilterCondition(e,t))}if(n=xe.formulaUnique(xe.formulaIndex(n,xe.formulaSequence(xe.formulaRows(n)),o)),1===t.length&&!a){const e=t[0],a=this.content.getColumnAddress(e.sourceDataReference.left);return[new D(new i(a),new m("&",new l("="),Ee(xe.formulaUnique(new i(a)))))]}return t.map(((e,t)=>{const a=e.sourceDataReference.left,o=this.content.getColumnAddress(a);return new D(new i(o),new m("&",new l("="),xe.formulaIndex(Ee(n),null,t+1)))}))}calculateFilterInclude(e,t){if(De(t))switch(t.exprType){case"and":return new ee(this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"or":return new te(this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));default:(0,r.x)(t)}if($e(t))return new Z(this.calculateFilterInclude(e,t.expr));if(Be(t)){if(["startsWith","endsWith","contains"].includes(t.exprType)&&!qe(t.right))throw new Ie(n.TranslationFailure,"only string literals are supported as the right operator in startWith/endWith/contain.");if(Pe(t.left)&&Pe(t.right))return this.calculateDatePartComparison(t);switch(t.exprType){case"greaterThan":return new g(">",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"greaterThanOrEqual":return new g(">=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"lessThan":return new g("<",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"lessThanOrEqual":return new g("<=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"equality":{const a=new g("=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));return!qe(t.right)||"true"!==t.right.value.toLowerCase()&&"false"!==t.right.value.toLowerCase()?a:new te(a,new g("=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,{exprType:"booleanLiteral",value:"true"===t.right.value.toLowerCase()})))}case"startsWith":return new g("=",xe.formulaIfError(xe.formulaSearch(new l(we(t.right.value)),this.calculateFilterInclude(e,t.left)),new c(-1)),new c(1));case"endsWith":return new g("=",xe.formulaIfError(xe.formulaSearch(new l(we(t.right.value)),xe.formulaRight(this.calculateFilterInclude(e,t.left),xe.formulaLen(this.calculateFilterInclude(e,t.right)))),new c(-1)),new c(1));case"contains":return xe.formulaIsNumber(xe.formulaSearch(new l(we(t.right.value)),this.calculateFilterInclude(e,t.left)));default:(0,r.x)(t)}}if(Me(t))return xe.formulaIndex(e,null,this.queryResult.projectClause.findIndex((e=>Ve(e,t)))+1);if(Oe(t))return new i(this.content.getColumnAddress(t.sourceDataReference.left));if(qe(t))return"dateTimeLiteral"===t.exprType?Re(t.value):new l(t.value);if(He(t))return new c(t.value);if(Ue(t))return new s(t.value);if(Ne(t)){const e=this.content.getColumnAddress(t.columnNameExpr.sourceDataReference.left);return xe.formulaIsNumber(xe.formulaXMatch(new i(e),xe.formulaIndex(new je(t.query,this.content).translate(),null,t.query.projectClause.findIndex((e=>Oe(e)&&e.sourceDataReference.left===t.columnNameExpr.sourceDataReference.left))+1),0,1))}if(_e(t))return new je(t,this.content).translate();throw new Error}constructor(e,t){this.queryResult=e,this.content=t}}var Ye=a(15197),Xe=a(88179),Ke=a(49195),Ze=a(31030),et=a(48314),tt=a(78640),at=a(92779),nt=a(95800);async function ot(e,t,a){const o=t.getTable(e),r=(o?o.getRange():t.getRange(e)).load(["rowIndex","columnIndex","rowCount","columnCount","address"]),i=o?.getHeaderRowRange().load("values"),l=o?.getDataBodyRange().load(["address","rowCount","columnCount"]);await e.sync();const{rowIndex:s,columnIndex:c,rowCount:d,columnCount:u}=r,m=Office.context.platform===Office.PlatformType.OfficeOnline;if(d*u>(m?We:Ge))throw new Ie(n.ContentTooLarge,"exceed max supported cell count"+(m?" in XLO":""));const g=l||t.getSheet(e).getRangeByIndexes(s+1,c,d-1,u).load(["address","rowCount","columnCount"]),h=i||t.getSheet(e).getRangeByIndexes(s,c,1,u).load("values"),p=Array(u).fill(0).map(((e,t)=>g.getColumn(t).load(["address","valueTypes"]))),b=e=>{const t=/(^.+!)([a-zA-Z]+)([0-9]+:)([a-zA-Z]+)([0-9]+)$/.exec(e);if(6!==t.length)throw new Error("wrong address structure");return t.map(((e,t)=>t>1?`$${e}`:t>0?e:"")).join("")};return await e.sync(),function(e,t,a){const o=it(e),r=lt(e);if(o.length>0&&r.length>0){if(a.rowCount>ze)throw new Ie(n.ContentTooLarge,"exceed max supported row count for queries with aggregation group-by")}else if(o.length>0){if(a.rowCount>Qe)throw new Ie(n.ContentTooLarge,"exceed max supported row count for queries with group-by")}else if(a.rowCount>Je)throw new Ie(n.ContentTooLarge,"exceed max supported row count");t.forEach((e=>{if(e.valueTypes.filter((e=>e.some((e=>e===Excel.RangeValueType.error||e===Excel.RangeValueType.richValue||e===Excel.RangeValueType.unknown)))).length>0)throw new Ie(n.ValidationIssue,"errors or rich values or unknown values in source are not supported")})),r.map((e=>e.index)).filter(((e,t,a)=>a.indexOf(e)===t)).forEach((e=>{if(t[e].valueTypes.filter((e=>e.some((e=>e===Excel.RangeValueType.string||e===Excel.RangeValueType.empty)))).length>0)throw new Ie(n.ValidationIssue,"strings or blanks in aggregated columns are not supported")})),o.forEach((e=>{const a=t[e].valueTypes.every((e=>e.some((e=>e===Excel.RangeValueType.double||e===Excel.RangeValueType.integer)))),o=t[e].valueTypes.every((e=>e.some((e=>e===Excel.RangeValueType.string))));if(!a&&!o)throw new Ie(n.ValidationIssue,"only support all numbers or all strings in group column")}))}(a,p,g),new Fe(!1,p.map(((e,a)=>{return{index:a,columnName:String(h.values[0][a]),columnAddress:o?(n=t.tableName,r=h.values[0][a],`${n}[${r.replace(/'/g,"''").replace(/#/g,"'#").replace(/\[/g,"'[").replace(/\]/g,"']").replace(/@/g,"'@")}]`):b(e.address),columnIndex:c+a,rowStartIndex:s+1,rowEndIndex:s+d-1};var n,r})),o?t.tableName:b(g.address))}function rt(e){const{whereClause:t,projectClause:a,havingClause:n,groupClause:o}=e;return[...[...a,...o||[]].filter((e=>Pe(e)&&Oe(e.source))).map((e=>e.source.sourceDataReference.left)),...t?dt(t):[],...t?dt(n):[]].filter(((e,t,a)=>a.indexOf(e)===t))}function it(e){const{whereClause:t,groupClause:a,havingClause:n}=e;return[...a?a.filter((e=>Oe(e))).map((e=>e.sourceDataReference.left)):[],...t?st(t):[],...n?st(n):[]].filter(((e,t,a)=>a.indexOf(e)===t))}function lt(e){const{projectClause:t,whereClause:a,havingClause:n,sortClause:o}=e;return[...t.filter((e=>Me(e)&&Oe(e.expr))).map((e=>({index:e.expr.sourceDataReference.left,aggregationType:e.exprType}))),...o?o.filter((e=>Me(e.expr)&&Oe(e.expr.expr))).map((e=>({index:e.expr.expr.sourceDataReference.left,aggregationType:e.expr.exprType}))):[],...a?ct(a):[],...n?ct(n):[]].filter(((e,t,a)=>a.findIndex((t=>t.index===e.index&&t.aggregationType===e.aggregationType))===t))}function st(e){const t=ut(e);let a=[];return t.forEach((e=>{a=[...a,...it(e)]})),a}function ct(e){const t=ut(e);let a=[];return t.forEach((e=>{a=[...a,...lt(e)]})),a}function dt(e){return e?.exprType?De(e)?[...dt(e.left),...dt(e.right)]:$e(e)?dt(e.expr):Be(e)?[...dt(e.left),...dt(e.right)]:Ne(e)?rt(e.query):_e(e)?rt(e):Pe(e)&&Oe(e.source)?[e.source.sourceDataReference.left]:[]:[]}function ut(e){return e?.exprType?De(e)?[...ut(e.left),...ut(e.right)]:$e(e)?ut(e.expr):Be(e)?[...ut(e.left),...ut(e.right)]:Ne(e)?[e.query]:_e(e)?[e]:[]:[]}var mt=a(70364),gt=a(85105),ht=a(93887),pt=a(91960),bt=a(18700),ft=a(59503),Ct=a(39234),yt=a(82959),vt=a(32182),Tt=a(93170),xt=a(91259),St=a(17649),wt=a(15407),Et=a(63789),Rt=a(62646);const It=8;function At(e,t,a){!function(e,t,a){const n=t.title;if(!1===a?.title?.visible)return void(e.title.visible=!1);if(a?.title?.text)return void(e.title.text=a.title.text);if(void 0===n)return;!function(e,t){const a=t.title;if(!a)throw new Error("Unsupported title type.");const n=255;let o=!1;e.title.text=Ft(a,n,(()=>{o=!0}));let r=0;const i=o?n-1:n;a.runs.every((t=>{const a=Math.min(t.text.length,i-r);if(null!=t.highlightStyleIndex&&a>0){e.title.getSubstring(r,a).font.color=Tt.vA[t.highlightStyleIndex]}return r+=t.text.length,r<=i}))}(e,t)}(e,t,a),function(e,t,a){!function(e,t,a){const n=t.series,o=n.length,r=n.some((e=>"secondary"===e.valueAxisGroup)),i=n.some((e=>null!=e.highlightStyleIndex));n.forEach(((t,n)=>{const l=e.series.getItemAt(n),{hasDoughnutHoleSize:s,hasGapWidth:c,hasDataMarkers:d,hasSeriesOverlap:u,isClustered:m}=(0,Et.Y)(t.layout),g=!!t.highlightedLineSegments&&t.highlightedLineSegments.length>0,h=t.exceptions&&t.exceptions.length>0,p=(0,Ct.Pg)(t.layout);!(0,Ct.iZ)(p.excelType)&&r&&(l.chartType=p.excelType);"secondary"===t.valueAxisGroup&&(l.axisGroup=Excel.AxisGroup.secondary),g&&(l.format.line.color=Tt.Zx),i&&function(e,t){const{hasDataMarkers:a,isLine:n}=(0,Et.Y)(t.layout),o=null!=t.highlightStyleIndex?Tt.hr[t.highlightStyleIndex]:Tt.wm;a?(e.markerBackgroundColor=o,e.markerForegroundColor=Tt.ON):n?e.format.line.color=o:e.format.fill.setSolidColor(o)}(l,t),h&&function(e,t){const{hasDataMarkers:a,isLine:n}=(0,Et.Y)(t.layout);a?e.markerBackgroundColor=Tt.Zx:n?e.format.line.color=Tt.Zx:e.format.fill.setSolidColor(Tt.Zx)}(l,t),s&&(l.doughnutHoleSize=Tt.Az),c&&(l.gapWidth=m&&o>1?Math.min(Tt.tF+o*Tt.P6,500):Tt.BC),d&&(l.markerStyle=Excel.ChartMarkerStyle.circle,l.markerSize=Tt.Qi,l.markerForegroundColor=Tt.ON),l.hasDataLabels=a?.series?.[n].dataLabels?.visible??!1;u&&!r&&(l.overlap=Tt.z8)}))}(e,t,a)}(e,t,a),function(e,t,a){const n=t.series,o=n.some((e=>null!=e.highlightStyleIndex));n.forEach(((t,n)=>{if(t.trendlines&&t.trendlines.length>0){if("linear"===t.trendlines[0].trendType){const r=t.exceptions&&t.exceptions.length>0,i=e.series.getItemAt(n).trendlines.add(Excel.TrendlineType.linear);i.format.line.lineStyle=Excel.ChartLineStyle.roundDot,o&&(null!=t.highlightStyleIndex?i.format.line.color=Tt.hr[t.highlightStyleIndex]:i.format.line.color=Tt.wm),r&&(i.format.line.color=Tt.Zx),null!=a?.series?.[n].trendline?.showEquation&&(i.showEquation=a?.series?.[n].trendline?.showEquation??!1)}}}))}(e,t,a),function(e,t,a){const n=t.series.length,o=t.series[0],r=o.exceptions&&o.exceptions.length>0,i=(0,Ct.Pg)(o.layout).hasCategoryLegend,l=null!=a?.legend?.visible?a.legend.visible:n>1||i&&!r;e.legend.visible=l,l&&(e.legend.position=n<=It?Excel.ChartLegendPosition.bottom:Excel.ChartLegendPosition.right)}(e,t,a),function(e,t,a){if(!t.axes)return;(function(e,t){const a=(0,Ct.ip)(t);t.axes.forEach((t=>{if(t.reversePlotOrder){const n=t.dimensionType,o="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,r=(0,St.C$)(o,n),i=e.axes.getItem(r.excelAxisType,_t(t.axisGroup));i.crosses=Excel.AxisCrosses.maximum,i.reversePlotOrder=!0}}))})(e,t),function(e,t,a){const n=(0,Ct.ip)(t);t.axes.forEach((t=>{const o=t.title;if(o){const r=t.dimensionType,i="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,l=(0,St.C$)(i,r),s=e.axes.getItem(l.excelAxisType,_t(t.axisGroup));s.title.text=Ft(o,255),l.excelAxisType===Excel.AxisType.category&&"primary"===t.axisGroup?(a?.primaryCategoryAxis?.title?.text&&(s.title.text=a.primaryCategoryAxis.title.text),null!=a?.primaryCategoryAxis?.title?.visible&&(s.title.visible=a.primaryCategoryAxis.title.visible)):l.excelAxisType===Excel.AxisType.value&&"primary"===t.axisGroup&&(a?.primaryValueAxis?.title?.text&&(s.title.text=a.primaryValueAxis.title.text),null!=a?.primaryValueAxis?.title?.visible&&(s.title.visible=a.primaryValueAxis.title.visible))}}))}(e,t,a),function(e,t){const a=(0,Ct.ip)(t),n=a.secondary?a.primary.positionAxisOnTick&&a.secondary.positionAxisOnTick:a.primary.positionAxisOnTick;Office.context.requirements.isSetSupported("ExcelApi","1.8")&&n&&(e.axes.categoryAxis.isBetweenCategories=!1)}(e,t),function(e,t,a){if(null==a?.primaryCategoryAxis?.minimum&&null==a?.primaryCategoryAxis?.maximum&&null==a?.primaryValueAxis?.minimum&&null==a?.primaryValueAxis?.maximum)return;const n=(0,Ct.ip)(t);t.axes.forEach((t=>{const o="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,r=t.dimensionType,i=(0,St.C$)(o,r),l=e.axes.getItem(i.excelAxisType,_t(t.axisGroup));i.isValue&&"primary"===i.axisGroup&&(i.excelAxisType===Excel.AxisType.category&&(null!=a.primaryCategoryAxis?.minimum&&(l.minimum=a.primaryCategoryAxis.minimum),null!=a.primaryCategoryAxis?.maximum&&(l.maximum=a.primaryCategoryAxis.maximum)),i.excelAxisType===Excel.AxisType.value&&(null!=a.primaryValueAxis?.minimum&&(l.minimum=a.primaryValueAxis.minimum),null!=a.primaryValueAxis?.maximum&&(l.maximum=a.primaryValueAxis.maximum)))}))}(e,t,a)}(e,t,a);(0,Ct.ip)(t).primary.excelType===Excel.ChartType.histogram?function(e,t){if(1!==t.series.length)return;const a=e.series.getItemAt(0);a.format.fill.setSolidColor(Tt.w8);const n=t.series[0].binOptions;n&&(n.usingBinCount?(a.binOptions.type=Excel.ChartBinType.binCount,a.binOptions.count=n.binCount):(a.binOptions.type=Excel.ChartBinType.binWidth,a.binOptions.width=n.binWidth),n.overflow&&(a.binOptions.overflowValue=n.overflow),n.underflow&&(a.binOptions.underflowValue=n.underflow),a.gapWidth=Tt.Wx);e.axes.valueAxis.majorGridlines.visible=!0}(e,t):function(e,t,a){if(!a)return;const n=(0,Ct.ip)(t);t.axes.forEach((t=>{const o=t.dimensionType,r="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,i=(0,St.C$)(r,o),l=e.axes.getItem(i.excelAxisType,_t(t.axisGroup));i.excelAxisType===Excel.AxisType.category&&"primary"===t.axisGroup&&null!=a.primaryCategoryAxis?.majorGridlines?.visible?l.majorGridlines.visible=a.primaryCategoryAxis.majorGridlines.visible:i.excelAxisType===Excel.AxisType.value&&"primary"===t.axisGroup&&null!=a.primaryValueAxis?.majorGridlines?.visible&&(l.majorGridlines.visible=a.primaryValueAxis.majorGridlines.visible)}))}(e,t,a)}function Lt(e,t,a){!function(e,t){const a=t.series;a.forEach(((t,a)=>{const n=e.series.getItemAt(a);t.exceptions&&t.exceptions.length>0&&function(e,t){const{hasDataMarkers:a,isLine:n}=(0,Et.Y)(t.layout);t.exceptions.forEach((t=>{const o=e.points.getItemAt(t);n||a?(o.markerStyle=Excel.ChartMarkerStyle.circle,o.markerSize=Tt.Qi,o.markerBackgroundColor=Tt.SB,o.markerForegroundColor=Tt.ON):o.format.fill.setSolidColor(Tt.SB)}))}(n,t),(0,Rt.o_)(t,["highlightedLineSegments"])&&t.highlightedLineSegments.length>0&&function(e,t){t.highlightedLineSegments.forEach((a=>{const n=e.points.getItemAt(a+1),o=null!=t.highlightStyleIndex?t.highlightStyleIndex:0;n.format.border.color=Tt.hr[o],n.format.border.weight=Tt.D9}))}(n,t)})),function(e,t){const a=t.series,n=(o=a,o.every((e=>e.dataBindings.some((e=>"title"===e.dimensionType)))));var o;a.forEach(((a,o)=>{const r=e.series.getItemAt(o),i=a.title;if(!i)return;const l=(0,Ct.ip)(t);(0,Ct.iZ)(l.primary.excelType)||l.secondary&&(0,Ct.iZ)(l.secondary.excelType)||n||(r.name=Ft(i,255))}))}(e,t)}(e,t),function(e,t){if(Office.context.requirements.isSetSupported("ExcelApi","1.9")){const a=t.title,n=a?(0,pt.HW)(a):"",o=(0,Ct.ip)(t),r=o.secondary?(0,xt.L)((0,at.$0s)(),o.primary.localizedName,o.secondary.localizedName):o.primary.localizedName,i=`${(0,xt.L)((0,at.eZ0)(),r)} ${n}`,l=(0,at.AXy)();e.worksheet.shapes.getItem(e.id).altTextDescription=`${i}\n\n${l}`}}(e,t);const n=function(e,t,a){if(!t.axes)return()=>{};const n=function(e,t){const a=(0,Ct.ip)(t),n=t.axes.filter((e=>!!e.linearValueScale&&"includeZero"===e.linearValueScale.zeroPolicy)).map((t=>{const n=t.dimensionType,o="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,r=(0,St.C$)(o,n);return e.axes.getItem(r.excelAxisType,_t(t.axisGroup)).load(["minimum","maximum"])}));return()=>{n.forEach((e=>{Math.sign(e.minimum)===Math.sign(e.maximum)&&(e.minimum>0?e.minimum=0:e.maximum=0)}))}}(e,t),o=function(e,t){const a=(0,Ct.ip)(t);return()=>{t.axes.forEach((n=>{const o="secondary"===n.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType;if("histogram"===o||"areaStacked100"===o||"barStacked100"===o||"columnStacked100"===o||"lineStacked100"===o)return;const i=n.dimensionType,l=(0,St.C$)(o,i);if(l.isValue){const a=(0,wt.r)(t,i,n.axisGroup);if(!a)return;const o=e.axes.getItem(l.excelAxisType,_t(n.axisGroup)),s=(0,vt.wM)(a.min,a.max);if(!s)return void(o.displayUnit=Excel.ChartAxisDisplayUnit.none);const c=s.languageUnitsValue;switch(c){case vt.YO.Thousands:o.displayUnit=Excel.ChartAxisDisplayUnit.thousands;break;case vt.YO.Millions:o.displayUnit=Excel.ChartAxisDisplayUnit.millions;break;case vt.YO.Billions:o.displayUnit=Excel.ChartAxisDisplayUnit.billions;break;case vt.YO.Trillions:o.displayUnit=Excel.ChartAxisDisplayUnit.trillions;break;case vt.YO.None:o.displayUnit=Excel.ChartAxisDisplayUnit.none;break;default:(0,r.c)(c)}}}))}}(e,t),i=function(e,t,a){const n=(0,Ct.ip)(t),o=[...(0,St.lf)(n.primary.insightsType)];if(n.secondary){const e=(0,St.C$)(n.secondary.insightsType,"values");e&&o.push(e)}const r=o.map(((t,a)=>t.isValue?{valueAxis:n.secondary&&a===o.length-1?e.axes.getItem(t.excelAxisType,Excel.ChartAxisGroup.secondary).load(["minimum","maximum"]):e.axes.getItem(t.excelAxisType,Excel.ChartAxisGroup.primary).load(["minimum","maximum"]),crossingAxis:n.secondary&&a===o.length-1?void 0:e.axes.getItem(o[1-a].excelAxisType)}:null)).filter((e=>null!==e));return()=>{if(2===o.length||3===o.length){if(r.forEach((e=>{const t=e.valueAxis.maximum>0,a=e.valueAxis.minimum<0;a&&!t&&(e.valueAxis.position=Excel.ChartAxisPosition.maximum),a&&t&&e.crossingAxis&&(e.crossingAxis.tickLabelPosition=Excel.AxisTickLabelPosition.low)})),!1===a?.primaryCategoryAxis?.tickLabel?.visible){e.axes.getItem(Excel.AxisType.category,Excel.AxisGroup.primary).tickLabelPosition=Excel.AxisTickLabelPosition.none}if(!1===a?.primaryValueAxis?.tickLabel?.visible){e.axes.getItem(Excel.AxisType.value,Excel.AxisGroup.primary).tickLabelPosition=Excel.AxisTickLabelPosition.none}}}}(e,t,a);return()=>{n(),o(),i()}}(e,t,a);return()=>{n()}}function Ft(e,t=-1,a){const n=e.runs.map((e=>e.text)).join("");return n.length<=t||-1===t?n:(a&&a(),`${n.slice(0,t-1)}â€¦`)}function _t(e){if(void 0!==e)switch(e){case"primary":return Excel.AxisGroup.primary;case"secondary":return Excel.AxisGroup.secondary;default:(0,r.c)(e)}}var Nt=a(98483);const kt=250,Ot=250;function Pt(e,t,a){if(a){const n=a.indexOf("!"),o=a.lastIndexOf(":");if(-1!==n&&o>n){const r=e.getRange(a.substring(n+1,o)),i=e.getRange(a.substring(o+1));t.setPosition(r,i)}else t.setPosition(a)}else t.top=kt,t.left=Ot}async function Mt(e,t,a,n,o,r){let i;i=r?await(0,bt.dG)(e,n,r):a.getSheet(e);const l=await async function(e,t,a,n,o,r,i){const l=(0,Ct.ip)(t);if((0,Ct.iZ)(l.primary.excelType)||l.secondary&&(0,Ct.iZ)(l.secondary.excelType)){const l=await function(e,t,a,n,o){return async r=>{const i=(0,Ct.ip)(e),l=e.data;if(1!==e.series.length)return Promise.reject(new Error("Ivy Chart contains incorrect series."));const s=e.series[0];if(1!==s.dataBindings.length)return Promise.reject(new Error("Ivy Chart contains incorrect dataBindings."));const c=s.dataBindings[0];if("values"!==c.dimensionType)return Promise.reject(new Error("Unrecognized dimension type."));const d=$t(l,c.dimensionId),u=t.getRangeFromReferences(r,d.references);Office.context.platform===Office.PlatformType.OfficeOnline&&u.getCell(0,0).select();const m=a.charts.add(i.primary.excelType,u);o?m.setPosition(o):(m.top=kt,m.left=Ot),At(m,e,n);const g=(0,Nt.A)();r.trace(g);const h=(0,ft.U)((()=>m.delete()),g);a.load("name"),m.load(["name","id"]);try{await r.sync()}catch(e){await h(e)}const p=e=>(e.workbook.worksheets.getItem(a.name).charts.getItem(m.name).delete(),e.sync());return m.activate(),await r.sync(),{result:m,undo:p}}}(t,a,o,r,i)(e);return n.push(l.undo),l.result}{const l=await function(e,t,a){return async n=>{const o=(0,yt.wZ)(t);await n.sync();const r=(0,Ct.ip)(e),i=o()||t.getCell(0,0),l=t.charts.add(r.primary.excelType,i);a?l.setPosition(a):(l.top=kt,l.left=Ot);const s=(0,Nt.A)();n.trace(s);const c=(0,ft.U)((()=>l.delete()),s);l.series.load("count"),t.load("name"),l.load(["name","id"]);try{await n.sync()}catch(e){await c(e)}const d=e=>(e.workbook.worksheets.getItem(t.name).charts.getItem(l.name).delete(),e.sync());l.activate();for(let e=l.series.count-1;e>=0;e--)l.series.getItemAt(e).delete();return await n.sync(),{result:l,undo:d}}}(t,o,i)(e);return n.push(l.undo),async function(e,t,a,n,o){const r=a.data,i=a.series,l=[];i.forEach((()=>{t.series.add()})),At(t,a,o),i.forEach(((a,o)=>{const i=t.series.getItemAt(o);a.dataBindings.forEach((t=>{const a=$t(r,t.dimensionId),s=n.getRangeFromReferences(e,a.references);switch(t.dimensionType){case"values":case"yValues":i.setValues(s);break;case"categories":case"xValues":i.setXAxisValues(s);break;case"title":s.load("address"),l.push({index:o,range:s});break;default:throw new Error("Unrecognized dimension type.")}}))})),0!==l.length&&await e.sync();return l.forEach((e=>{t.series.getItemAt(e.index).name=`=${e.range.address}`})),t}(e,l.result,t,a,r)}}(e,t,a,n,i,o,r),s=Lt(l,t,o),c=(0,nt.x)(e,l.worksheet);l.worksheet.load("name"),await e.sync(),s();const d=await c()(e);return n.push(d.undo),l}async function Dt(e,t,a){const n=[];a.forEach((t=>{const a=t.destination?(0,bt.dn)(e,t.destination):t.dataProvider.getSheet(e);n.push({visualChart:t.visualChart,dataProvider:t.dataProvider,insertionSheet:a,chartConfig:t.chartConfig,destination:t.destination})}));const o=await async function(e,t,a){const n=Array(a.length),o=[],r=[],i=[],l=[];for(let e=0;e<a.length;++e){const t=a[e],n=(0,Ct.ip)(t.visualChart);(0,Ct.iZ)(n.primary.excelType)||n.secondary&&(0,Ct.iZ)(n.secondary.excelType)?(o.push(t),r.push(e)):(i.push(t),l.push(e))}if(o.length>0){const a=await function(e){return async t=>{const a=[],n=[];for(const o of e){const e=(0,Ct.ip)(o.visualChart),r=o.visualChart.data;if(1!==o.visualChart.series.length)return Promise.reject(new Error("Ivy Chart contains incorrect series."));const i=o.visualChart.series[0];if(1!==i.dataBindings.length)return Promise.reject(new Error("Ivy Chart contains incorrect dataBindings."));const l=i.dataBindings[0];if("values"!==l.dimensionType)return Promise.reject(new Error("Unrecognized dimension type."));const s=$t(r,l.dimensionId),c=o.dataProvider.getRangeFromReferences(t,s.references),d=o.insertionSheet.charts.add(e.primary.excelType,c);Pt(o.insertionSheet,d,o.destination),At(d,o.visualChart,o.chartConfig),o.insertionSheet.load("name"),d.load(["name","id"]),a.push(d);const u=(0,Nt.A)();t.trace(u),n.push(u)}try{await t.sync()}catch(e){for(let e=0;e<a.length;++e)(0,ft.U)((()=>a[e].delete()),n[e])}const o=t=>{for(let n=0;n<a.length;++n){t.workbook.worksheets.getItem(e[n].insertionSheet.name).charts.getItem(a[n].name).delete()}return t.sync()};return await t.sync(),{result:a,undo:o}}}(o)(e);t.push(a.undo);const i=a.result;for(let e=0;e<i.length;++e)n[r[e]]=i[e]}if(i.length>0){const a=[];for(let e=0;e<i.length;++e)a.push({visualChart:i[e].visualChart,insertionSheet:i[e].insertionSheet,destination:i[e].destination});const o=await function(e){return async t=>{const a=[];e.forEach((e=>{const t=(0,yt.wZ)(e.insertionSheet);a.push(t)})),await t.sync();const n=[],o=[];for(let r=0;r<e.length;++r){const i=e[r],l=(0,Ct.ip)(i.visualChart),s=(0,a[r])()||i.insertionSheet.getCell(0,0),c=i.insertionSheet.charts.add(l.primary.excelType,s);Pt(i.insertionSheet,c,i.destination),c.series.load("count"),i.insertionSheet.load("name"),c.load(["name","id"]),n.push(c);const d=(0,Nt.A)();t.trace(d),o.push(d)}try{await t.sync();const a=t=>{for(let a=0;a<n.length;++a){t.workbook.worksheets.getItem(e[a].insertionSheet.name).charts.getItem(n[a].name).delete()}return t.sync()};return n.forEach((e=>{for(let t=e.series.count-1;t>=0;t--)e.series.getItemAt(t).delete()})),await t.sync(),{result:n,undo:a}}catch(e){for(let e=0;e<n.length;++e)(0,ft.U)((()=>n[e].delete()),o[e]);throw e}}}(a)(e);t.push(o.undo);const r=[];for(let e=0;e<i.length;++e)r.push({chart:o.result[e],visualChart:i[e].visualChart,dataProvider:i[e].dataProvider,chartConfig:i[e].chartConfig});const s=await async function(e,t){const a=[],n=[];for(let o=0;o<t.length;++o){const r=t[o],i=r.visualChart.data,l=r.visualChart.series;for(let e=0;e<l.length;++e)r.chart.series.add();At(r.chart,r.visualChart,r.chartConfig),l.forEach(((t,a)=>{const l=r.chart.series.getItemAt(a);t.dataBindings.forEach((t=>{const s=$t(i,t.dimensionId),c=r.dataProvider.getRangeFromReferences(e,s.references);switch(t.dimensionType){case"values":case"yValues":l.setValues(c);break;case"categories":case"xValues":l.setXAxisValues(c);break;case"title":c.load("address"),n.push({chartIndex:o,seriesIndex:a,range:c});break;default:throw new Error("Unrecognized dimension type.")}}))})),a.push(r.chart)}0!==n.length&&await e.sync();return n.forEach((e=>{a[e.chartIndex].series.getItemAt(e.seriesIndex).name=`=${e.range.address}`})),a}(e,r);for(let e=0;e<s.length;++e)n[l[e]]=s[e]}return n}(e,t,n),r=[];for(let e=0;e<o.length;++e){const t=Lt(o[e],n[e].visualChart,n[e].chartConfig);r.push(t)}return await e.sync(),r.forEach((e=>{e()})),o}function $t(e,t){const a=e.dimensions.find((e=>e.id===t));if(void 0===a)throw new Error("Cannot find dimension by id.");return a}function Bt(e,t,a,n,o,r){const i=t.length>0?t[0].length:0,l=e.getRangeByIndexes(n,o,r,i);l.numberFormat=t.slice(0,r),l.numberFormatLocal=a.slice(0,r);for(let l=0;l<i;l++){const i=t.slice(r).map((e=>[e[l]])),s=a.slice(r).map((e=>[e[l]]));let c=0;for(let t=0;t<=i.length;t++)if(t===i.length&&i.length>=1||0!==t&&i[t-1][0]!==i[t][0]){const a=e.getRangeByIndexes(n+r+c,o+l,t-c,1);a.numberFormat=i.slice(c,c+1),a.numberFormatLocal=s.slice(c,c+1),c=t}}}function Ht(e,t,a,n,o,r,i){const l=function(e,t,a,n,o,r,i){const l=t.length,s=l>0?t[0].length:0,c=e.getRangeByIndexes(o,r,l,s);return c.values=t,Bt(e,a,n,o,r,i),c}(e,t,a,n,o,r,i);return l.format.autofitColumns(),e.tables.add(l,!0)}var Ut=a(58242);const qt=3,Vt=2,Gt="C";var Wt=a(56229),zt=a(93471);function Qt(e,t){const{is29Feb1900:a,adjustedRaw:n,date:o}=(0,zt.f9)(e);if(Number.isNaN(o.getDay()))return n.toString();const i=o.getFullYear().toString(),l=o.getMonth(),s=function(e){switch(e){case 0:return(0,at.DIE)();case 1:return(0,at.Fsb)();case 2:return(0,at.KBQ)();case 3:return(0,at.ds$)();case 4:return(0,at.I53)();case 5:return(0,at.pRP)();case 6:return(0,at.jpr)();case 7:return(0,at.sY1)();case 8:return(0,at.sGO)();case 9:return(0,at.NeW)();case 10:return(0,at.JGR)();case 11:return(0,at.kTv)();default:throw new Error(`invalid month in date part month grouping, month = ${e}`)}}(l),c=function(e){switch(Math.floor(e/3)){case 0:return(0,at.vKl)();case 1:return(0,at.CNP)();case 2:return(0,at.v$B)();case 3:return(0,at.C2X)();default:throw new Error(`invalid month in date part quarter grouping, month = ${e}`)}}(l),d=a?"29":o.getDate().toString();switch(t){case Excel.PivotTableDateGroupBy.bySeconds:case Excel.PivotTableDateGroupBy.byMinutes:case Excel.PivotTableDateGroupBy.byHours:case Excel.PivotTableDateGroupBy.byDays:return`${d}-${s}`;case Excel.PivotTableDateGroupBy.byMonths:return s;case Excel.PivotTableDateGroupBy.byQuarters:return`Qtr${c}`;case Excel.PivotTableDateGroupBy.byYears:return i;case Excel.PivotTableDateGroupBy.invalid:return"";default:return(0,r.x)(t)}}function Jt(e,t,a){const n=function(e,t,a){const n=new Map,o=new Map;if(t.filterFields.forEach((t=>{const r=t.datePart;if(r){const i=[],l=a.get(t.name)||t.name;jt(r.datePartOverride).forEach((t=>{const a=e.hierarchies.getItem(l).fields.getItem(l),n=e.addDateGroup(a,t);n.load("name"),i.push(n);const s=r.values.map((e=>Qt(e,t)));o.set(n,s)})),i.length>0&&n.set(t,i)}})),0===n.size)return;const r=e=>{const t=[];return e.forEach((e=>{const a=n.get(e);a?a.forEach((e=>{t.push({name:e.name,datePart:void 0,values:o.get(e)||[]})})):t.push(e)})),t};return()=>({...t,filterFields:r(t.filterFields)})}(e,t,a),o=function(e,t,a){const n=new Map;if(t.rowFields.concat(t.columnFields).forEach((t=>{if(t.datePartOverride){const o=[],r=a.get(t.name)||t.name;jt(t.datePartOverride).forEach((t=>{const a=e.hierarchies.getItem(r).fields.getItem(r),n=e.addDateGroup(a,t);n.load("name"),o.push(n)})),o.length>0&&n.set(t,o)}})),0===n.size)return;const o=e=>{const t=[];return e.forEach((e=>{const a=n.get(e);a?a.forEach((a=>{t.push({...e,name:a.name,datePartOverride:void 0})})):t.push(e)})),t};return()=>({...t,rowFields:o(t.rowFields),columnFields:o(t.columnFields)})}(e,t,a);if(n||o)return()=>{const e=n?n():t,a=o?o():t;return{...t,filterFields:e.filterFields,rowFields:a.rowFields,columnFields:a.columnFields}}}function jt(e){switch(e){case"year":case"quarter":return[Excel.PivotTableDateGroupBy.byYears];case"yearAndQuarter":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byQuarters];case"yearAndMonth":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths];case"month":return[Excel.PivotTableDateGroupBy.byMonths];case"date":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays];case"dateAndHour":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays,Excel.PivotTableDateGroupBy.byHours];case"dateHourAndMinute":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays,Excel.PivotTableDateGroupBy.byHours,Excel.PivotTableDateGroupBy.byMinutes];default:return[]}}const Yt={rowFields:[],columnFields:[],filterFields:[],dataFields:[],valueFilters:[],labelFilters:[],dateFilters:[],highlightCellReferences:[]};async function Xt(e,t,a){const n=[];a.forEach((e=>{n.push({visualPivotTable:e.visualPivotTable,dataProvider:e.dataProvider,interpretation:e.interpretation,useTableDataSource:e.useTableDataSource})}));const r=function(e,t){const a=e.workbook.pivotTables,n=e.workbook.worksheets.getActiveWorksheet().protection.load("protected"),r=[];t.forEach((t=>{const a=t.dataProvider.getTopLeftCell(e).load(["rowIndex","columnIndex"]);r.push(a)})),a.load({name:!0,worksheet:{id:!0,protection:{protected:!0}}});const i=[];return t.forEach((t=>{let a=null;!t.dataProvider.isPivotTable&&t.useTableDataSource&&t.dataProvider.tableName&&(a=e.workbook.worksheets.getItem(t.dataProvider.sheetId).tables.getItemOrNullObject(t.dataProvider.tableName)),i.push(a)})),e=>async l=>{const s=a.items.filter((e=>e.worksheet.protection.protected));if(n.protected&&Office.context.platform!==Office.PlatformType.OfficeOnline)throw new o.u(o.O.InsertionFailedCurrentWorksheetProtected);if(s.length>0&&Office.context.requirements.isSetSupported("ExcelApi","1.15")){const e=s.map((e=>({type:e.getDataSourceType(),sourceString:e.getDataSourceString()})));await a.context.sync();const n=e.map((e=>({type:e.type.value,sourceString:e.sourceString.value})));t.forEach((e=>{if(n.filter((t=>t.sourceString.length>0&&(t.type===Excel.DataSourceType.localTable&&t.sourceString===e.dataProvider.tableName||t.type===Excel.DataSourceType.localRange&&t.sourceString===`${e.dataProvider.sheetName}!${e.dataProvider.address}`))).length>0)throw new o.u(o.O.InsertionFailedPivotCacheProtected)}))}const c=new Set(a.items.map((e=>e.name)));let d=1;const u=[],m=[],g=[];for(let n=0;n<e.length;++n){const o=i[n],s=t[n],h=e[n],p=r[n],b=!o||o.isNullObject?va(l,s.interpretation,s.dataProvider,p):o;let f;do{f=(0,xt.L)(at.xe2.InsertedPivotTableName,d.toString()),++d}while(c.has(f));c.add(f),g.push(f);const C=a.add(f,b,h),y=new Map,v=na(C,s.visualPivotTable,y);ra(C,s.visualPivotTable,v,y),C.refresh(),Office.context.requirements.isSetSupported("TableStyle","1.1")&&C.layout.setStyle("PivotStyleLight16"),u.push(C);const T=(0,Nt.A)();l.trace(T),m.push(T)}await l.sync();const h=e=>{for(let t=0;t<u.length;++t){const a=e.workbook.pivotTables.getItem(g[t]),n=Office.context.requirements.isSetSupported("ExcelApi","1.9")&&Office.context.platform!==Office.PlatformType.OfficeOnline,o=e.workbook.worksheets.getActiveWorksheet();n&&(e.application.suspendScreenUpdatingUntilNextSync(),a.worksheet.activate()),a.delete(),n&&o.activate()}return e.sync()},p=[];for(let e=0;e<u.length;++e)p.push({pivotTable:u[e],hierarchyNameMap:new Map});return{result:p,undo:h}}}(e,n),i=[];for(let t=0;t<a.length;++t){const n=a[t];i.push((0,bt.dn)(e,n.destination).getRange((0,bt.gx)(n.destination)))}await e.sync();const l=await r(i)(e);t.push(l.undo);const s=[];let c=!1;for(let e=0;e<l.result.length;++e){const t=a[e],n=Jt(l.result[e].pivotTable,t.visualPivotTable,l.result[e].hierarchyNameMap);n&&(c=!0),s.push(n)}c&&await e.sync();const d=[];for(let e=0;e<l.result.length;++e){const t=a[e],n=s[e];n&&(t.visualPivotTable=n());const o=ta(l.result[e].pivotTable,t.visualPivotTable,!0,!1,t.useTabularLayout,l.result[e].hierarchyNameMap);d.push(o)}await e.sync(),d.forEach((e=>{e()}));const u=[];return l.result.forEach((e=>{e.pivotTable.load({name:!0,worksheet:{id:!0}}),u.push(e.pivotTable)})),u}async function Kt(e,t,a,n,r,i,l,s,c,d,u,m,g=Yt){let h=m;i&&h&&(h=(0,bt.TC)(h,1,g.filterFields.length>0?g.filterFields.length+3:2));const p=ea(e,t,n,r,i,u,l,m),b=(0,nt.d)(e),f=null==h||0===h.length,C=f?null:(0,bt.dn)(e,h).protection.load("protected");let y;if(await e.sync(),f){const t=await b({useSheetSeries:s&&c})(e);a.push(t.undo),y=await p(t.result.getCell(Ca(g,n,i),ya(i)))(e)}else{if(C?.protected)throw new o.u(o.O.InsertionFailedDestinationProtected);y=await p((0,bt.dn)(e,h).getRange((0,bt.gx)(h)))(e)}const v=y.result.pivotTable;a.push(y.undo),s&&(e.workbook.showPivotFieldList=!0);const T=Jt(v,g,y.result.hierarchyNameMap);let x=g;T&&(await e.sync(),x=T());const S=aa(v,x,n,i,d,y.result.hierarchyNameMap),w=(0,nt.x)(e,v.worksheet);v.worksheet.load("name"),await e.sync(),S();const E=await w()(e);return a.push(E.undo),s&&v.layout.getRange().select(),v}async function Zt(e,t,a,n,o,r,i,l,s,c,d,u,m){const g=await async function(e,t,a,n,o,r,i,l,s,c,d){if(a.isPivotTable)return Promise.resolve(a.getPivotTable(e));let u=d;const m=d;i&&u&&(u=(0,bt.TC)(u,1,t.filterFields.length>0?t.filterFields.length+3:2));const g=ea(e,a,o,r,i,c,l,m);let h;await e.sync();const p=await(0,bt.dG)(e,n,d);h=u?await g(p.getRange((0,bt.gx)(u)))(e):await g(p.getCell(Ca(t,o,i),ya(i)))(e);n.push(h.undo);const b=h.result.pivotTable,f=Jt(b,t,h.result.hierarchyNameMap);let C=t;f&&(await e.sync(),C=f());const y=aa(b,C,o,i,s,h.result.hierarchyNameMap);return await e.sync(),y(),b}(e,t,n,o,r,i,l,s,c,d,m),h=await function(e,t,a,n,o,r,i){return async l=>{const s=(0,Ct.ip)(t).primary,c=e.layout.getRange(),d=e.worksheet,u=function(e,t,a,n){if(a){if(n){const e=(0,bt.b8)(n,{top:3,left:2});return t?e.top+1:e.top+2}return t?3:4}return e.isPivotTable&&void 0!==e.tableRowIndex?e.tableRowIndex:1}(a,n,o,i),m=c.getColumnsAfter(2).getEntireColumn().getCell(u,1);m.select();const g=d.charts.add(s.excelType,m);g.setPosition(m),g.setData(c),g.showAllFieldButtons=!1,At(g,t,r);const h=(0,Nt.A)();l.trace(h);const p=(0,ft.U)((()=>{g.delete()}),h);d.load("name"),g.load(["name","id"]),a.isPivotTable||d.getRange("A1").select();try{await l.sync()}catch(e){await p(e)}return{result:g,undo:e=>(e.workbook.worksheets.getItem(d.name).charts.getItem(g.name).delete(),e.sync())}}}(g,a,n,r,l,u,m)(e);o.push(h.undo);const p=Lt(h.result,a,u),b=(0,nt.x)(e,h.result.worksheet);h.result.worksheet.load("name"),await e.sync(),p();const f=await b()(e);return o.push(f.undo),h.result}function ea(e,t,a,n,r,i,l,s){const c=e.workbook.pivotTables,d=e.workbook.worksheets.getActiveWorksheet().protection.load("protected"),u=t.getTopLeftCell(e).load(["rowIndex","columnIndex"]);c.load({name:!0,worksheet:{id:!0,protection:{protected:!0}}});let m=null;return!t.isPivotTable&&i&&t.tableName&&(m=e.workbook.worksheets.getItem(t.sheetId).tables.getItemOrNullObject(t.tableName)),e=>async i=>{const g=c.items.filter((e=>e.worksheet.protection.protected));if(d.protected&&Office.context.platform!==Office.PlatformType.OfficeOnline)throw new o.u(o.O.InsertionFailedCurrentWorksheetProtected);if(g.length>0&&Office.context.requirements.isSetSupported("ExcelApi","1.15")){const e=g.map((e=>({type:e.getDataSourceType(),sourceString:e.getDataSourceString()})));await c.context.sync();if(e.map((e=>({type:e.type.value,sourceString:e.sourceString.value}))).filter((e=>e.sourceString.length>0&&(e.type===Excel.DataSourceType.localTable&&e.sourceString===t.tableName||e.type===Excel.DataSourceType.localRange&&e.sourceString===`${t.sheetName}!${t.address}`))).length>0)throw new o.u(o.O.InsertionFailedPivotCacheProtected)}const h=!m||m.isNullObject?va(i,n,t,u):m,p=new Set(c.items.map((e=>e.name)));let b,f=1;do{b=(0,xt.L)(at.xe2.InsertedPivotTableName,f.toString()),++f}while(p.has(b));const C=c.add(b,h,e);C.refresh();const y=function(e,t,a){const n=e.hierarchies,o=t.getRange(a).getRow(0).load("text,rowCount");return n.load("items/name"),()=>{const e=new Set(n.items.map((e=>e.name.toUpperCase()))),t=new Set,a=new Map;let r=[];return o.rowCount>0&&(r=o.text[0]),r.forEach((n=>{const o=n.toUpperCase();if(e.has(o)&&!t.has(o))t.add(o);else{let r=2,i=(0,xt.L)((0,at.fhV)(),o,r);for(;e.has(i);){if(!t.has(i)){a.set(n,i),t.add(i);break}++r,i=(0,xt.L)((0,at.fhV)(),o,r)}}})),a}}(C,t,i);r&&(0,bt.tF)(e.worksheet,l,a,s),Office.context.requirements.isSetSupported("TableStyle","1.1")&&C.layout.setStyle("PivotStyleLight16");const v=(0,Nt.A)();i.trace(v);const T=(0,ft.U)((()=>C.delete()),v);try{await i.sync()}catch(e){await T(e)}const x=y();return{result:{pivotTable:C,hierarchyNameMap:x},undo:e=>{const t=e.workbook.pivotTables.getItem(b),a=Office.context.requirements.isSetSupported("ExcelApi","1.9")&&Office.context.platform!==Office.PlatformType.OfficeOnline,n=e.workbook.worksheets.getActiveWorksheet();return a&&(e.application.suspendScreenUpdatingUntilNextSync(),t.worksheet.activate()),t.delete(),a&&n.activate(),e.sync()}}}}function ta(e,t,a,n,o,r){(t.valueFilters.length>0||t.labelFilters.length>0||t.dateFilters.length>0)&&(e.allowMultipleFiltersPerField=!0),o&&(e.layout.layoutType=Excel.PivotLayoutType.tabular);const i=[];t.filterFields&&t.filterFields.forEach((t=>{const a=r.get(t.name)||t.name,n=e.hierarchies.getItem(a),o=e.filterHierarchies.add(n);0!==t.values.length&&(i.push({filterField:o.fields.getItem(a),visibleItemNames:t.values}),o.enableMultipleFilterItems=!0)}));const l=oa(i);return()=>{l(),sa(e,t,r),da(e,t,r),ha(e,t,r),pa(e,t),ba(e,t,a,n)}}function aa(e,t,a,n,o,r){(t.valueFilters.length>0||t.labelFilters.length>0||t.dateFilters.length>0)&&(e.allowMultipleFiltersPerField=!0),o&&(e.layout.layoutType=Excel.PivotLayoutType.tabular);const i=[];t.filterFields&&t.filterFields.forEach((t=>{const a=r.get(t.name)||t.name,n=e.hierarchies.getItem(a),o=e.filterHierarchies.add(n);0!==t.values.length&&(i.push({filterField:o.fields.getItem(a),visibleItemNames:t.values}),o.enableMultipleFilterItems=!0)}));const l=oa(i);return()=>{l();const o=na(e,t,r);ra(e,t,o,r),sa(e,t,r),da(e,t,r),ha(e,t,r),pa(e,t),ba(e,t,a,n)}}function na(e,t,a){return t.dataFields.map((t=>{const n=e.hierarchies.getItem(a.get(t.name)||t.name),o=e.dataHierarchies.add(n);o.summarizeBy=function(e){switch(e){case"sum":return Excel.AggregationFunction.sum;case"count":return Excel.AggregationFunction.count;case"average":return Excel.AggregationFunction.average;case"min":return Excel.AggregationFunction.min;case"max":return Excel.AggregationFunction.max;case"distinctCount":return Excel.AggregationFunction.countNumbers;case"stdDev":return Excel.AggregationFunction.standardDeviation;case"variance":return Excel.AggregationFunction.variance;default:throw new Error("Unsupported calculation function")}}(t.dataCalculation),t.numberFormat&&(o.numberFormat=t.numberFormat);const i=function(e){if(void 0===e)return Excel.ShowAsCalculation.none;switch(e){case"percentOf":return Excel.ShowAsCalculation.percentOf;case"percentOfColumnTotal":return Excel.ShowAsCalculation.percentOfColumnTotal;case"percentOfRowTotal":return Excel.ShowAsCalculation.percentOfRowTotal;case"percentOfGrandTotal":return Excel.ShowAsCalculation.percentOfGrandTotal;case"percentOfParentTotal":return Excel.ShowAsCalculation.percentOfParentTotal;case"percentOfParentColumnTotal":return Excel.ShowAsCalculation.percentOfParentColumnTotal;case"percentOfParentRowTotal":return Excel.ShowAsCalculation.percentOfParentRowTotal;case"percentRunningTotal":return Excel.ShowAsCalculation.percentRunningTotal;case"rankAscending":return Excel.ShowAsCalculation.rankAscending;case"rankDecending":return Excel.ShowAsCalculation.rankDecending;case"runningTotal":return Excel.ShowAsCalculation.runningTotal;case"none":return Excel.ShowAsCalculation.none;default:(0,r.c)(e)}}(t.showAsCalculation);return o.showAs={calculation:i},{dataPivotHierarchy:o,visualDataField:t}}))}function oa(e){const t={name:!0,items:{name:!0}};return e.forEach((e=>{e.filterField.load(t)})),()=>{e.forEach((e=>{e.filterField.items.items.forEach((t=>{t.visible=e.visibleItemNames.includes(t.name)}))}))}}function ra(e,t,a,n){t.rowFields&&t.rowFields.forEach((t=>{const o=n.get(t.name)||t.name,r=e.hierarchies.getItem(o);e.rowHierarchies.add(r),fa(r.fields.getItem(o),a,t)})),t.columnFields&&t.columnFields.forEach((t=>{const o=n.get(t.name)||t.name,r=e.hierarchies.getItem(o);e.columnHierarchies.add(r),fa(r.fields.getItem(o),a,t)}))}function ia(e){switch(e.filterType){case"between":case"notBetween":return{condition:Excel.ValueFilterCondition.between,exclusive:"notBetween"===e.filterType,lowerBound:e.value,upperBound:e.value2};case"bottomItems":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.items,threshold:e.value};case"bottomPercent":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.percent,threshold:e.value};case"bottomSum":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.sum,threshold:e.value};case"equal":case"notEqual":return{condition:Excel.ValueFilterCondition.equals,exclusive:"notEqual"===e.filterType,comparator:e.value};case"greaterThan":return{condition:Excel.ValueFilterCondition.greaterThan,comparator:e.value};case"greaterThanOrEqual":return{condition:Excel.ValueFilterCondition.greaterThanOrEqualTo,comparator:e.value};case"lessThan":return{condition:Excel.ValueFilterCondition.lessThan,comparator:e.value};case"lessThanOrEqual":return{condition:Excel.ValueFilterCondition.lessThanOrEqualTo,comparator:e.value};case"topItems":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.items,threshold:e.value};case"topPercent":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.percent,threshold:e.value};case"topSum":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.sum,threshold:e.value};default:(0,r.c)(e,`Invalid ValueFilter type: ${e.filterType}`)}}function la(e,t){switch(e){case"rowField":return t.rowFields;case"columnField":return t.columnFields;default:return(0,r.x)(e)}}function sa(e,t,a){t.valueFilters.forEach((n=>{const o=la(n.labelFieldType,t)[n.labelFieldIndex],r=a.get(o.name)||o.name,i=t.dataFields[n.dataFieldIndex],l=a.get(i.name)||i.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({valueFilter:{...ia(n),value:(0,xt.L)((0,at.Gn5)(),(0,Wt.iz)(i.dataCalculation),l)}})}))}function ca(e){const t=e.value.toString();switch(e.filterType){case"equal":case"notEqual":return{condition:Excel.LabelFilterCondition.equals,comparator:t,exclusive:"notEqual"===e.filterType};case"greaterThan":return{condition:Excel.LabelFilterCondition.greaterThan,comparator:t};case"greaterThanOrEqual":return{condition:Excel.LabelFilterCondition.greaterThanOrEqualTo,comparator:t};case"lessThan":return{condition:Excel.LabelFilterCondition.lessThan,comparator:t};case"lessThanOrEqual":return{condition:Excel.LabelFilterCondition.lessThanOrEqualTo,comparator:t};case"between":case"notBetween":return{condition:Excel.LabelFilterCondition.between,exclusive:"notBetween"===e.filterType,lowerBound:t,upperBound:e.value2.toString()};case"startsWith":case"notStartsWith":return{condition:Excel.LabelFilterCondition.beginsWith,substring:t,exclusive:"notStartsWith"===e.filterType};case"endsWith":case"notEndsWith":return{condition:Excel.LabelFilterCondition.endsWith,substring:t,exclusive:"notEndsWith"===e.filterType};case"contains":case"notContains":return{condition:Excel.LabelFilterCondition.contains,substring:t,exclusive:"notContains"===e.filterType};default:return(0,r.x)(e)}}function da(e,t,a){t.labelFilters.forEach((n=>{const o=la(n.labelFieldType,t)[n.labelFieldIndex],r=a.get(o.name)||o.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({labelFilter:ca(n)})}))}function ua(e,t){switch(e){case"equal":case"notEqual":return{condition:Excel.DateFilterCondition.equals,exclusive:"notEqual"===e};case"after":return{condition:Excel.DateFilterCondition.after};case"afterOrEqual":return{condition:Excel.DateFilterCondition.afterOrEqualTo};case"before":return{condition:Excel.DateFilterCondition.before};case"beforeOrEqual":return{condition:Excel.DateFilterCondition.beforeOrEqualTo};case"between":case"notBetween":return{condition:Excel.DateFilterCondition.between,exclusive:"notBetween"===e};case"inDynamicPeriod":return{condition:ma(t)};default:return(0,r.x)(e)}}function ma(e){switch(e){case"tomorrow":return Excel.DateFilterCondition.tomorrow;case"today":return Excel.DateFilterCondition.today;case"yesterday":return Excel.DateFilterCondition.yesterday;case"nextWeek":return Excel.DateFilterCondition.nextWeek;case"thisWeek":return Excel.DateFilterCondition.thisWeek;case"lastWeek":return Excel.DateFilterCondition.lastWeek;case"nextMonth":return Excel.DateFilterCondition.nextMonth;case"thisMonth":return Excel.DateFilterCondition.thisMonth;case"lastMonth":return Excel.DateFilterCondition.lastMonth;case"nextQuarter":return Excel.DateFilterCondition.nextQuarter;case"thisQuarter":return Excel.DateFilterCondition.thisQuarter;case"lastQuarter":return Excel.DateFilterCondition.lastQuarter;case"nextYear":return Excel.DateFilterCondition.nextYear;case"thisYear":return Excel.DateFilterCondition.thisYear;case"lastYear":return Excel.DateFilterCondition.lastYear;case"yearToDate":return Excel.DateFilterCondition.yearToDate;case"quarter1":return Excel.DateFilterCondition.allDatesInPeriodQuarter1;case"quarter2":return Excel.DateFilterCondition.allDatesInPeriodQuarter2;case"quarter3":return Excel.DateFilterCondition.allDatesInPeriodQuarter3;case"quarter4":return Excel.DateFilterCondition.allDatesInPeriodQuarter4;case"january":return Excel.DateFilterCondition.allDatesInPeriodJanuary;case"february":return Excel.DateFilterCondition.allDatesInPeriodFebruary;case"march":return Excel.DateFilterCondition.allDatesInPeriodMarch;case"april":return Excel.DateFilterCondition.allDatesInPeriodApril;case"may":return Excel.DateFilterCondition.allDatesInPeriodMay;case"june":return Excel.DateFilterCondition.allDatesInPeriodJune;case"july":return Excel.DateFilterCondition.allDatesInPeriodJuly;case"august":return Excel.DateFilterCondition.allDatesInPeriodAugust;case"september":return Excel.DateFilterCondition.allDatesInPeriodSeptember;case"october":return Excel.DateFilterCondition.allDatesInPeriodOctober;case"november":return Excel.DateFilterCondition.allDatesInPeriodNovember;case"december":return Excel.DateFilterCondition.allDatesInPeriodDecember;default:return(0,r.x)(e)}}function ga(e){return(0,Rt.S$)(e)?{...ua(e.filterType),comparator:{date:e.value.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},wholeDays:e.wholeDays}:(0,Rt.kp)(e)?{...ua(e.filterType),lowerBound:{date:e.value.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},upperBound:{date:e.value2.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},wholeDays:e.wholeDays}:(0,Rt.vr)(e)?ua(e.filterType):(0,r.x)(e)}function ha(e,t,a){t.dateFilters.forEach((n=>{const o=la(n.fieldType,t)[n.fieldIndex],r=a.get(o.name)||o.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({dateFilter:ga(n)})}))}function pa(e,t){(t.subTotalRowIndices||t.subTotalColumnIndices)&&(e.layout.subtotalLocation=Excel.SubtotalLocationType.atTop)}function ba(e,t,a,n){const o=e.worksheet;if(t.highlightCellReferences){const e=Ca(t,a,n),r=ya(n);t.highlightCellReferences.forEach((t=>{o.getCell(t.row+e,t.column+r).format.font.color="#ED7331"}))}}function fa(e,t,a){const n=a.sortOrder;if(!n||"default"===n)return;const o=function(e){switch(e){case"ascending":return Excel.SortBy.ascending;case"descending":return Excel.SortBy.descending;case"default":throw new Error("Unsupported sort order");default:return(0,r.x)(e)}}(n);if(a.sortBy){const n=t.find((e=>e.visualDataField.name===a.sortBy)).dataPivotHierarchy;e.sortByValues(o,n)}else e.sortByLabels(o)}function Ca(e,t,a){const n=(e.filterFields||[]).length;return a?t?n>0?n+4:3:n>0?n+5:4:n>0?n+2:1}function ya(e){return e?2:0}function va(e,t,a,n){const o=e.workbook.worksheets.getItem(a.sheetId);if(!t||a.isInsertedSheet)return a.getRange(e);{const{top:e,left:a,bottom:r,right:i}=t.table.tableLocation;return o.getRangeByIndexes(e+n.rowIndex,a+n.columnIndex,r-e+1,i-a+1)}}const Ta=4,xa=2,Sa=0,wa=0;function Ea(e,t,a){return Excel.run((n=>{switch(e.type){case"ChartVisual":case"PivotChartVisual":t.some((t=>t.sheetId===e.sheetId&&(0,Rt.VZ)(t.type)))||n.workbook.worksheets.getItem(e.sheetId).charts.onDeleted.add((e=>a(e.chartId,tt.D0.Chart,e.source)));break;case"PivotTableVisual":t.some((e=>"PivotTableVisual"===e.type))||n.workbook.worksheets.onDeleted.add((e=>a(e.worksheetId,tt.D0.Sheet,e.source)));break;case"QueryResultVisual":if(!e.sheetId)break;e.sheetId&&!t.some((t=>"QueryResultVisual"===t.type&&t.sheetId===e.sheetId))&&(e.isFormulaInsertion?n.workbook.worksheets.onDeleted.add((e=>a(e.worksheetId,tt.D0.Sheet,e.source))):n.workbook.worksheets.getItem(e.sheetId).tables.onDeleted.add((e=>a(e.tableId,tt.D0.Table,e.source))))}return Promise.resolve()}))}async function Ra(e,t,a,n,i){const l=[];try{const o=[],s=[],c=[];i.failureLocation=Ye.lA.convertingDashboardArgs,t.forEach((e=>{const t=e=>(0,gt.LM)(1+e.position.y,1+e.position.x),i=(e,t)=>{const a=e.filterFields.length>0?e.filterFields.length+1:0;return(0,gt.LM)(1+t.position.y+a,1+t.position.x)},l=e=>(0,gt.LM)(1+e.position.y+e.dim.y-1,1+e.position.x+e.dim.x-1);switch(e.recommendation.visual.visualType){case"ChartVisual":{const r=e.layoutPlacement.chart;if(!r)throw new Error("Chart layout rectangle not found for ChartVisual");const i=t(r),s=l(r),c=`'${a}'!${i}:${s}`;o.push({recommendation:e.recommendation,dataProvider:n,destination:c});break}case"PivotTableVisual":{const t=e.layoutPlacement.pivotTable;if(!t)throw new Error("Pivot table layout rectangle not found for PivotTableVisual");const o=i(e.recommendation.visual.pivotTable,t),r=`'${a}'!${o}`;s.push({recommendation:e.recommendation,dataProvider:n,interpretation:e.interpretation,destination:r,useTabularLayout:e.useTabularLayout,useTableDataSource:e.useTableDataSource,layoutPlacement:t});break}case"PivotChartVisual":{const o=e.layoutPlacement.pivotTable,r=e.layoutPlacement.chart;if(!r)throw new Error("Chart layout rectangle not found for PivotChartVisual");if(!o)throw new Error("Pivot table layout rectangle not found for PivotChartVisual");const d=t(r),u=l(r),m=i(e.recommendation.visual.pivotTable,o),g=`'${a}'!${m}`,h=`'${a}'!${d}:${u}`;c.push({recommendation:e.recommendation,dataProvider:n,destination:h,pivotTableSheetId:null,pivotTableRange:null}),s.push({recommendation:e.recommendation,dataProvider:n,interpretation:e.interpretation,destination:g,useTabularLayout:e.useTabularLayout,useTableDataSource:e.useTableDataSource,layoutPlacement:o});break}case"BlankPivotTable":case"QueryResultVisual":case"ForecastVisual":case"TextAnalysisVisual":throw new Error(`Unsupported dashboard visual type: ${e.recommendation.visual.visualType}`);default:(0,r.x)(e.recommendation.visual)}})),i.failureLocation=Ye.lA.insertCharts;const d=await async function(e,t,a){if(a.length<=0)return[];const n=[];a.forEach((e=>{const t=e.recommendation.visual;let a=t.chart;void 0===a.title&&(a={...a,title:e.recommendation.title}),n.push({visualChart:a,dataProvider:e.dataProvider,chartConfig:t.chartConfig,destination:e.destination})}));const o=await Dt(e,t,n),r=[];for(let e=0;e<o.length;++e)r.push({objectId:o[e].id,sheetId:o[e].worksheet.id,recommendationId:a[e].recommendation.id,type:"ChartVisual",isNLAnswer:!1});return r}(e,l,o);i.failureLocation=Ye.lA.insertPivotTables;const u=await async function(e,t,a){if(a.length<=0)return[];const n=a.sort(((e,t)=>e.layoutPlacement.position.y>t.layoutPlacement.position.y?1:e.layoutPlacement.position.y<t.layoutPlacement.position.y?-1:e.layoutPlacement.position.x-t.layoutPlacement.position.x)),o=n.map((e=>{const t=e.recommendation.visual;return{dataProvider:e.dataProvider,interpretation:e.interpretation,useTabularLayout:e.useTabularLayout,useTableDataSource:e.useTableDataSource,destination:e.destination,visualPivotTable:t.pivotTable}})),r=await Xt(e,t,o);await e.sync();return r.map(((e,t)=>({objectId:e.id,sheetId:e.worksheet.id,range:e.layout.getRange(),recommendationId:n[t].recommendation.id,type:"PivotTableVisual",isNLAnswer:!1})))}(e,l,s);c.forEach((e=>{const t=u.find((t=>t.recommendationId===e.recommendation.id));e.pivotTableRange=t?.range,e.pivotTableSheetId=t?.sheetId})),i.failureLocation=Ye.lA.insertPivotCharts;const m=await async function(e,t,a){if(a.length<=0)return[];const n=[];a.forEach((e=>{if(!e.pivotTableRange)throw new Error(`Pivot table range not provided for recommendation: ${e.recommendation.id}`);if(!e.pivotTableSheetId)throw new Error(`Pivot table sheet id not provided for recommendation: ${e.recommendation.id}`);let t=e.recommendation.visual.chart;void 0===t.title&&(t={...t,title:e.recommendation.title}),n.push({visualChart:t,dataProvider:e.dataProvider,destination:e.destination,pivotTableRange:e.pivotTableRange,pivotTableSheetId:e.pivotTableSheetId})}));const o=await async function(e,t,a){const n=[],o=[];a.forEach((t=>{const a=(0,Ct.ip)(t.visualChart).primary;let r,i,l=!1;const s=(0,bt.dn)(e,t.destination);try{const e=(0,bt.gx)(t.destination);if(e){const t=(0,Ut.AW)(e);r=s.getCell(t.top-1,t.left-1),t.top===t.bottom&&t.left===t.right||(i=s.getCell(t.bottom-1,t.right-1),l=!0)}}catch(e){l=!1}if(!r)throw new Error("Starting cell not found.");r.select();const c=s.charts.add(a.excelType,r);l?c.setPosition(r,i):c.setPosition(r),c.setData(t.pivotTableRange),c.showAllFieldButtons=!1,At(c,t.visualChart,t.chartConfig),s.load("name"),c.load(["name","id"]),t.dataProvider.isPivotTable||s.getRange("A1").select(),n.push(c);const d=(0,Nt.A)();e.trace(d),o.push(d)})),await e.sync();const r=[];for(let e=0;e<n.length;++e){const t=Lt(n[e],a[e].visualChart,a[e].chartConfig);r.push(t)}try{await e.sync(),r.forEach((e=>{e()}))}catch(e){for(let e=0;e<n.length;++e)(0,ft.U)((()=>n[e].delete()),o[e])}return t.push((e=>{for(let t=0;t<n.length;++t)e.workbook.worksheets.getItem(a[t].pivotTableSheetId).charts.getItem(n[t].name).delete();return e.sync()})),n}(e,t,n),r=[];for(let e=0;e<o.length;++e)r.push({objectId:o[e].id,sheetId:o[e].worksheet.id,recommendationId:a[e].recommendation.id,type:"PivotChartVisual",isNLAnswer:!1});return r}(e,l,c);return d.concat(u.concat(m))}catch(e){try{await(0,ft.q)(l)}catch(e){et.M.getInstance().logErrorCode(o.O.InsertionCleanupFailed,e,Ze.S.Undo,Xe.$b.Error)}throw e}}async function Ia(e,t,a,l,s,d,u,h,p){const b=[];try{return await(0,mt.$r)((0,at.Eyh)()),await Excel.run({delayForCellEdit:!0},(async f=>{const C=e.visual,y=null==h||h.refreshable,v=null==h?null:h.textAnswerSummary;switch(C.visualType){case"ChartVisual":{const a=await async function(e,t,a,n,o,r){const i=t.visual;let l=i.chart;void 0===l.title&&(l={...l,title:t.title});Office.context.platform===Office.PlatformType.OfficeOnline&&a.getSheet(e).getRange("A1").select();const s=await Mt(e,l,a,n,i.chartConfig,r);return{objectId:s.id,sheetId:s.worksheet.id,recommendationId:t.id,type:"ChartVisual",isNLAnswer:o,sheetName:s.worksheet.name}}(f,e,t,b,l,u);return a}case"BlankPivotTable":{const n=await async function(e,t,a,n,o,r,i,l,s,c,d){const u=await Kt(e,a,n,!0,o,r,i,l,!0,s,c,d);return{objectId:u.id,sheetId:u.worksheet.id,recommendationId:t.id,type:"BlankPivotTable",isNLAnswer:r,sheetName:u.worksheet.name}}(f,e,t,b,a,l,v,p,s,d,u);return n}case"PivotTableVisual":{const n=await async function(e,t,a,n,o,r,i,l,s,c,d,u){const m=t.visual,g=await Kt(e,a,n,o,r,i,l,s,!1,d,u,c,m.pivotTable);return{objectId:g.id,sheetId:g.worksheet.id,recommendationId:t.id,type:"PivotTableVisual",isNLAnswer:i,sheetName:g.worksheet.name}}(f,e,t,b,y,a,l,v,p,u,s,d);return n}case"PivotChartVisual":{const n=await async function(e,t,a,n,o,r,i,l,s,c,d){const u=t.visual;let m=u.chart;const g=u.pivotTable;void 0===m.title&&(m={...m,title:t.title});const h=await Zt(e,g,m,a,n,o,r,i,l,s,c,u.chartConfig,d);return{objectId:h.id,sheetId:h.worksheet.id,recommendationId:t.id,type:"PivotChartVisual",isNLAnswer:i,sheetName:h.worksheet.name}}(f,e,t,b,y,a,l,v,s,d,u);return n}case"QueryResultVisual":try{return await async function(e,t,a,o,r,l,s){const d=t.visual;if(void 0===d.query)throw new Error("The recommendation is not a query result visual.");const u=function(e){const{projectClause:t,groupClause:a}=e;return!(t&&t.length>1||!t.some((e=>Me(e)))||a)}(d.query);new je(d.query,new Fe(!0)).translate();const h=await ot(e,o,d.query);let p;try{const e=new je(d.query,h).translate();p=`=${function(e,t,a){const n=it(e),o=lt(e).filter((e=>"average"===e.aggregationType)).map((e=>e.index)),r=rt(e),l=[new m("*",xe.formulaIsError(new i(t.getTableAddress())),new c(1))];if(n.forEach((e=>{const a=new i(t.getColumnAddress(e));l.push(xe.formulaMin([xe.formulaSum(new m("-",new c(1),xe.formulaIsNumber(a))),xe.formulaSum(new m("-",new c(1),xe.formulaIsText(a)))]))})),o.length>0){const e=1===o.length?new i(t.getColumnAddress(o[0])):xe.formulaIndex(new i(t.getTableAddress()),xe.formulaSequence(xe.formulaRows(new i(t.getTableAddress()))),o.map((e=>e+1)));l.push(new m("*",xe.formulaIsBlank(e),new c(1)))}if(r.length>0){const e=1===r.length?new i(t.getColumnAddress(r[0])):xe.formulaIndex(new i(t.getTableAddress()),xe.formulaSequence(xe.formulaRows(new i(t.getTableAddress()))),r.map((e=>e+1)));l.push(new m("*",xe.formulaIsError(xe.formulaYear(e)),new c(1)))}return xe.formulaIf(new g(">",xe.formulaSum(l),new c(0)),xe.formulaNA(),a)}(d.query,h,e).toString()}`}catch(e){throw e instanceof Ie?e:new Ie(n.TranslationFailure)}if(p.length>8192)throw new Ie(n.ExceedLengthLimitation);const b=await(0,bt.dG)(e,r,s);await function(e,t,a,n,o,r,i,l){const s=n.fields,c=n.fieldHeaders.map(pt.HW),d=s.length,u=s[0].values.raw.length,m=(0,ht.Kz)(u,(e=>s.map((t=>t.values.formats?.[e])))),g=(0,ht.Kz)(u,(e=>s.map((t=>t.values.formatLocals?.[e])))),h=new Array(d).fill(null),p=[h,...m],b=[h,...g];let f,C=l;if(o){if(C){const e=(0,bt.b8)(C,{top:2,left:2});f=`${(0,Ut.z)(e.left)}${e.top}`,C=(0,bt.TC)(C,1,2)}(0,bt.tF)(t,i,!0,f)}let y=qt,v=Vt,T=Gt;if(C){const e=(0,bt.b8)(C,{top:y+1,left:v+1});y=e.top-1,v=e.left-1,T=(0,Ut.z)(e.left)}t.getRangeByIndexes(y,v,1,d).set({values:[c],format:{font:{color:"white",bold:!0,size:11},fill:{color:"4472C4"}}});const{formulaCellAddress:x,formulaCellTop:S,formulaCellLeft:w}=function(e,t,a,n){return{formulaCellAddress:e?`${n}${t+2}`:`${n}${t+3}`,formulaCellTop:e?t:t+1,formulaCellLeft:a}}(r,y,v,T),E=r?u+1:u+2;return t.getRange(x).formulas=[[a]],Bt(t,p,b,S,w,1),t.getRangeByIndexes(3,2,E,d).format.autofitColumns(),e.sync()}(e,b,p,d.result,l,u,a,s);const f=(0,nt.x)(e,b);b.load("name"),await e.sync();const C=await f()(e);return r.push(C.undo),{objectId:null,sheetId:b.id,recommendationId:t.id,type:"QueryResultVisual",isNLAnswer:!0,isFormulaInsertion:!0,sheetName:b.name}}(f,e,v,t,b,l,u)}catch(t){return et.M.getInstance().logErrorCode(t instanceof Ie?function(e){switch(e){case"ContentTooLarge":return o.O.FormulaErrorContentTooLarge;case"ExceedLengthLimitation":return o.O.FormulaErrorExceedLengthLimitation;case"ProactiveLimitation":return o.O.FormulaErrorProactiveLimitation;case"TranslationFailure":return o.O.FormulaErrorTranslationFailure;case"Unknown":return o.O.FormulaErrorUnknown;case"ValidationIssue":return o.O.FormulaErrorValidationIssue;default:return(0,r.x)(e)}}(t.errorCode):o.O.FormulaErrorUnknown,t,Ze.S.AnalyzeDataError,Xe.$b.Warning,{key:Xe.un.RecommendationId,value:e.id}),await(0,ft.q)(b),async function(e,t,a,n,o){const r=t.visual,i=r.result,{targetSheet:l,table:s}=await Aa(e,i,a,n,Ta,xa,o);return{objectId:s.id,sheetId:l.id,recommendationId:t.id,type:"QueryResultVisual",isNLAnswer:!0,isFormulaInsertion:!1,sheetName:l.name}}(f,e,v,b,u)}case"ForecastVisual":return async function(e,t,a){const n=t.visual,o=n.formulasTable,{targetSheet:r,table:i}=await Aa(e,o,null,a,Sa,wa),l=r.getUsedRange();l.load("address"),await e.sync();const s=new Ke.N(r.id,r.name,l.address,!0,!1),c=await Mt(e,n.chart,s,a);return c.width=500,c.height=300,await e.sync(),{objectId:i.id,sheetId:r.id,recommendationId:t.id,type:"ForecastVisual",isNLAnswer:!0,isFormulaInsertion:!0,sheetName:r.name}}(f,e,b);case"TextAnalysisVisual":return async function(e,t,a){const n=a.getTable(e),o=(n?n.getRange():a.getRange(e)).load(["rowIndex","columnIndex","rowCount","columnCount","address"]);await e.sync();const{rowIndex:r,columnIndex:i,rowCount:l,columnCount:s}=o,c=r,d=i+s,u=t.visual,{header:m,values:g}=La(u.textAnalysisResult),h=a.sheetName,p=e.workbook.worksheets.getItem(h);return p.getRangeByIndexes(c,d,l,m.length).values=[m,...g],p.load(["name","id"]),await e.sync(),{objectId:null,sheetId:p.id,recommendationId:t.id,type:"TextAnalysisVisual",isNLAnswer:!0,isFormulaInsertion:!1,sheetName:p.name}}(f,e,t);default:return(0,r.x)(C)}}))}catch(e){try{await(0,ft.q)(b)}catch(e){et.M.getInstance().logErrorCode(o.O.InsertionCleanupFailed,e,Ze.S.Undo,Xe.$b.Error)}throw e}finally{await(0,mt.TA)()}}async function Aa(e,t,a,n,o,r,i){const l=t.fields,s=l[0].values.raw.length,c=(0,ht.Kz)(s,(e=>l.map((t=>t.values.raw[e])))),d=t.fieldHeaders.map(pt.HW);c.unshift(d);const u=c[0].length,m=(0,ht.Kz)(s,(e=>l.map((t=>t.values.formats?.[e])))),g=(0,ht.Kz)(s,(e=>l.map((t=>t.values.formatLocals?.[e])))),h=new Array(u).fill(null),p=[h,...m],b=[h,...g],f=await(0,bt.dG)(e,n,i);null!=a&&(0,bt.tF)(f,a,!1,i);let C=o,y=r;if(i){const e=(0,bt.b8)(i,{top:C,left:y});C=e.top+1,y=e.left+2}const v=Ht(f,c,p,b,C,y,1).load("id");f.getRange("A1").select();const T=(0,nt.x)(e,f);f.load("name"),await e.sync();const x=await T()(e);return n.push(x.undo),{targetSheet:f,table:v}}function La(e){const t=e.bulletList;if(!t)throw new Error("Invalid text analysis result to insert. Only result with bulletList can be inserted.");const a=e.columnReference.bottom-e.columnReference.top+1,{augmentedColumnNames:n,augmentedColumnValues:o}=function(e,t){const a=e.map((e=>e.title)),n=[];for(let e=0;e<t;e++)n.push(Array(a.length).fill(!1));for(let t=0;t<a.length;t++){const a=e[t].reference;if(a)for(let e=0;e<a.length;e++){const o=a[e];if(o<0||o>=n.length)throw new Error("Invalid BulletResult. Reference out of range.");n[o][t]=!0}}return{augmentedColumnNames:a,augmentedColumnValues:n}}(t,a),{success:r,columnValues:i,columnName:l}=function(e,t,a,n){const o=[],r=`${a}-${n}`;for(const a of t){const t=a.filter((e=>!0===e)).length;if(1===t)o.push(e[a.indexOf(!0)]);else{if(0!==t)return{success:!1};o.push(null)}}return{success:!0,columnValues:o,columnName:r}}(n,o,e.columnName,e.analysisType);if(r){if(void 0===l||void 0===i)throw new Error("Invalid result. When success is true, columnName and columnValues should not be undefined.");return{header:[l],values:i.map((e=>[e]))}}return{header:n,values:o}}},50108:(e,t,a)=>{a.d(t,{FZ:()=>l,dI:()=>s,lC:()=>i,x4:()=>r,xs:()=>u});var n=a(50347);let o;function r(){return o}function i(e){o=e}function l(){return{isLoaded:!1,localeInfo:{},calcLocaleInfo:{}}}function s(e){e.application.cultureInfo.load("name");const t=e.application.cultureInfo.numberFormat,a=e.application.cultureInfo.datetimeFormat;let o;return t.load("numberGroupSeparator"),t.load("numberDecimalSeparator"),(0,n.r1)()&&(o=e.application.cultureInfo.formulaCulture,o?.load(),a.load(),t.load()),e.application.cultureInfo.numberFormat.load("currencySymbol"),()=>{const r={isLoaded:!1,localeInfo:{},calcLocaleInfo:{}},i=e.application.cultureInfo.name.toLowerCase();if(r.dataLocale=i,"."!==e.application.cultureInfo.numberFormat.numberDecimalSeparator&&(r.localeInfo.decimalPoint=e.application.cultureInfo.numberFormat.numberDecimalSeparator),","!==e.application.cultureInfo.numberFormat.numberGroupSeparator&&(r.localeInfo.digitGrouping=e.application.cultureInfo.numberFormat.numberGroupSeparator),"$"!==e.application.cultureInfo.numberFormat.currencySymbol&&(r.localeInfo.currencySymbol=e.application.cultureInfo.numberFormat.currencySymbol),"en-us"!==i&&(r.localeInfo.longDay=d(i,"long"),r.localeInfo.shortDay=d(i,"short"),r.localeInfo.longMonth=c(i,"long"),r.localeInfo.medMonth=c(i,"short"),r.localeInfo.shortMonth=c(i,"narrow")),(0,n.r1)()){r.calcLocaleInfo.falseName=o?.falseName,r.calcLocaleInfo.trueName=o?.trueName,r.calcLocaleInfo.errorTypeNames=o?.errorTypeNames,r.calcLocaleInfo.leftBrace=o?.leftBrace,r.calcLocaleInfo.leftBracket=o?.leftBracket,r.calcLocaleInfo.listSeparator=o?.listSeparator,r.calcLocaleInfo.rightBracket=o?.rightBracket,r.calcLocaleInfo.rightBrace=o?.rightBrace,r.calcLocaleInfo.specialRefNames=o?.specialRefNames,r.calcLocaleInfo.uppercaseColumnLetter=o?.uppercaseColumnLetter,r.calcLocaleInfo.uppercaseRowLetter=o?.uppercaseRowLetter,r.calcLocaleInfo.worksheetFunctionNames=o?.worksheetFunctionNames;try{r.calcLocaleInfo.rowSeparator=o?.rowSeparator,r.calcLocaleInfo.columnSeparator=o?.columnSeparator}catch(e){}r.calcLocaleInfo.dateSeparator=a.dateSeparator,r.calcLocaleInfo.longDatePattern=a.longDatePattern,r.calcLocaleInfo.shortDatePattern=a.shortDatePattern,r.calcLocaleInfo.timeSeparator=a.timeSeparator,r.calcLocaleInfo.longTimePattern=a.longTimePattern,r.calcLocaleInfo.amSymbol=a.amSymbol,r.calcLocaleInfo.dateOrder=a.dateOrder,r.calcLocaleInfo.dateSeparatorAlternative=a.dateSeparatorAlternative,r.calcLocaleInfo.dayNameLong=a.dayNameLong,r.calcLocaleInfo.dayNameShort=a.dayNameShort,r.calcLocaleInfo.isAmPmSeparatedBySpace=a.isAmPmSeparatedBySpace,r.calcLocaleInfo.isClock24Hour=a.isClock24Hour,r.calcLocaleInfo.isDayTwoDigits=a.isDayTwoDigits,r.calcLocaleInfo.isHourTwoDigits=a.isHourTwoDigits,r.calcLocaleInfo.isLongDateFormat=a.isLongDateFormat,r.calcLocaleInfo.isMonthTwoDigits=a.isMonthTwoDigits,r.calcLocaleInfo.isYearFourDigits=a.isYearFourDigits,r.calcLocaleInfo.isYearFourDigits=a.isYearFourDigits,r.calcLocaleInfo.monthNameLong=a.monthNameLong,r.calcLocaleInfo.monthNameShort=a.monthNameShort,r.calcLocaleInfo.pmSymbol=a.pmSymbol,r.calcLocaleInfo.timeSeparatorAlternative=a.timeSeparatorAlternative,r.calcLocaleInfo.numberDecimalSeparator=t.numberDecimalSeparator,r.calcLocaleInfo.numberGroupSeparator=t.numberGroupSeparator,r.calcLocaleInfo.currencySymbol=t.currencySymbol,r.calcLocaleInfo.currencyDecimals=t.currencyDecimals,r.calcLocaleInfo.currencyNegative=t.currencyNegative,r.calcLocaleInfo.fractionSeparator=t.fractionSeparator,r.calcLocaleInfo.isCurrencySeparatedBySpace=t.isCurrencySeparatedBySpace,r.calcLocaleInfo.isCurrencySymbolLeading=t.isCurrencySymbolLeading,r.calcLocaleInfo.nonCurrencyNumberDecimals=t.nonCurrencyNumberDecimals,r.calcLocaleInfo.numberGrouping=t.numberGrouping,r.calcLocaleInfo.spaceBeforePercentage=t.spaceBeforePercentage,r.calcLocaleInfo.spaceInScientificNotation=t.spaceInScientificNotation}return r.isLoaded=!0,r}}function c(e,t){const a=new Intl.DateTimeFormat(e,{month:t}),n=[];for(let e=1;e<13;e++){const t=new Date(Date.UTC(2e3,e,1,0,0,0));n.push(a.format(t))}return n}function d(e,t){const a=new Intl.DateTimeFormat(e,{weekday:t}),n=[];for(let e=0;e<7;e++){const t=new Date(Date.UTC(2e3,1,e,0,0,0));n.push(a.format(t))}return n}function u(e){const t=e.toLowerCase();return!!(t.includes("dd")||t.includes("mm")||t.includes("yy")||t.includes("aa")||t.includes("jj")||t.includes("rr")||t.includes("vv")||t.includes("Ð´Ð´")||t.includes("Ð³Ð³"))}},66036:(e,t,a)=>{a.d(t,{P:()=>i});var n=a(31030),o=a(48314),r=a(50108);class i{static getNumberFormatCache(){return this.numberFormatCache}addFormat(e){this._data[e]||(this._data[e]=i.createInvalidCacheEntry())}async ensureFormats(){const e=Object.keys(this._data).filter((e=>!this._data[e].isValid));if(0===e.length)return;const t=await(0,r.x4)().getFormatMetadata(e);if(e.length!==t.length)throw new Error("getFormatMetadata returned unexpected results.");e.forEach(((e,a)=>{this._data[e]=i.createValidCacheEntryFromFormatterData(t[a])}))}isDateTime(e){if(this._data[e]){if(this._data[e].isValid)return this._data[e].metadata.isDateTime;throw new Error("Format not valid. Ensure formats before accessing metadata.")}throw new Error("Format not added.")}addNumberFormatPropertiesToCache(e){e.forEach((e=>{this._data[e.key]=i.createValidCacheEntryFromFormatProperty(e)}))}get data(){return JSON.parse(JSON.stringify(this._data))}async addFormatPropertiesAsync(e){const t=e.filter((e=>!this._data[e]));t.length>0&&(o.M.getInstance().logEvent({eventType:n.S.FormatMetadataFallback,eventData:[]}),t.forEach(this.addFormat.bind(this)),await this.ensureFormats())}static createInvalidCacheEntry(){return{isValid:!1,metadata:{hasDayOfWeek:!1,hasMonth:!1,hasYear:!1,isCurrency:!1,isDateTime:!1,isNumeric:!1,isPercent:!1,isText:!1}}}static createValidCacheEntryFromFormatterData(e){return{isValid:!0,metadata:{hasDayOfWeek:e.hasDayOfWeek,hasMonth:e.hasMonth,hasYear:e.hasYear,isCurrency:e.isCurrency,isDateTime:e.isDateTime,isNumeric:e.isNumeric,isPercent:e.isPercent,isText:e.isText}}}static createValidCacheEntryFromFormatProperty(e){return{isValid:!0,metadata:{hasDayOfWeek:e.dateTimeHasDayOfWeek,hasMonth:e.dateTimeHasMonth,hasYear:e.dateTimeHasYear,isCurrency:e.currency,isDateTime:e.dateTime,isNumeric:e.numeric,isPercent:e.percent,isText:e.text}}}constructor(e={}){this._data=JSON.parse(JSON.stringify(e))}}i.numberFormatCache=new i},34874:(e,t,a)=>{a.d(t,{r:()=>r});var n=a(95800),o=a(70364);async function r(e,t){return Excel.run((async a=>{await(0,o.F5)((async a=>{const o=a.workbook.queries.loadQuery(t,e,Excel.PowerQueryObjectType.table);a.load(o),await a.sync();const r=o.name,i=a.workbook.worksheets.getItem(r);if(await a.sync(),i){const e=(0,n.x)(a,i);await e()(a),await a.sync()}}))}))}},82959:(e,t,a)=>{function n(e,t){const a=e.getDataBodyRange();return t?e.getHeaderRowRange().getBoundingRect(a):a}function o(e){const t=e.getUsedRangeOrNullObject().getCell(0,0).load(["rowIndex","columnIndex"]),a=e.getUsedRangeOrNullObject().getLastColumn().getCell(0,0).load(["rowIndex","columnIndex"]),n=e.getUsedRangeOrNullObject().getLastRow().getCell(0,0).load(["rowIndex","columnIndex"]),o=e.getRange().getLastCell().load(["rowIndex","columnIndex"]);return()=>t.columnIndex-2>=0?t.getOffsetRange(0,-2):t.rowIndex-2>=0?t.getOffsetRange(-2,0):a.columnIndex+2<=o.columnIndex?a.getOffsetRange(0,2):n.rowIndex+2<=o.rowIndex?n.getOffsetRange(2,0):null}a.d(t,{U2:()=>n,wZ:()=>o})},49195:(e,t,a)=>{a.d(t,{N:()=>n});class n{getTable(e){return this.tableName?e.workbook.worksheets.getItem(this.sheetId).tables.getItem(this.tableName):null}getPivotTable(e){if(!this.isPivotTable||!this.tableName)throw new Error("Source range is not a pivot table");return e.workbook.worksheets.getItem(this.sheetId).pivotTables.getItem(this.tableName)}getSheet(e){return e.workbook.worksheets.getItem(this.sheetId)}getRange(e){return e.workbook.worksheets.getItem(this.sheetId).getRange(this.address)}getRangeFromReferences(e,t){if(1!==t.length)throw new Error("Invalid number of references.");const a=this.getRange(e),{top:n,right:o,bottom:r,left:i}=t[0],l=a.getCell(n,i),s=a.getCell(r,o);return l.getBoundingRect(s)}getTopLeftCell(e){return e.workbook.worksheets.getItem(this.sheetId).getRange(this.address).getCell(0,0)}constructor(e,t,a,n,o,r,i){this.sheetId=e,this.sheetName=t,this.address=a,this.isInsertedSheet=n,this.isPivotTable=o,this.tableName=r,this.tableRowIndex=i}}},59503:(e,t,a)=>{function n(e){const t=async a=>{if(0===e.length)return Promise.resolve();await e.pop()(a),await t(a)};return Excel.run((e=>t(e)))}function o(e,t){return a=>(a instanceof OfficeExtension.Error&&a.traceMessages.includes(t)&&e(),Promise.reject(a))}a.d(t,{U:()=>o,q:()=>n})},18700:(e,t,a)=>{a.d(t,{D$:()=>v,H:()=>f,Jx:()=>O,K3:()=>x,O9:()=>R,RV:()=>S,So:()=>h,TC:()=>y,XR:()=>d,Xw:()=>g,b8:()=>C,cc:()=>T,dG:()=>w,dn:()=>p,gx:()=>s,me:()=>m,mg:()=>E,sq:()=>k,tF:()=>b,uT:()=>u});var n=a(92779),o=a(58242),r=a(85105),i=a(95800),l=a(93170);function s(e){const t=e.lastIndexOf("!");if(-1===t)return e;const a=e.slice(t+1);return a.length>1e3?void 0:a}function c(e,t){const a=e.lastIndexOf("!");let n=null;return-1!==a&&(n=e.substr(0,a),!t&&n.startsWith("'")&&(n=n.substr(1,n.length-2))),n}function d(e,t,a,o){if(0===e.length||void 0===t)return[];let r=o?o.slice(t[0],t[t.length-1]+1):new Array(t[t.length-1]-t[0]+1).fill("");if(t.forEach(((a,n)=>{const o=a-t[0];o>=0&&o<r.length&&(r[o]=e[0][n])})),a){const e=o?o.slice(0,t[0]):new Array(t[0]).fill("");e[0]=n.xe2.CalculatedRowsFormulaTotalHeader,r=e.concat(r)}return r}function u(e,t,a,n){if(e<0||t<0||a<0||n<0)throw new Error("Invalid indices");const o=e+1,i=t+1,l=e+a,s=t+n;return`${(0,r.LM)(o,i)}:${(0,r.LM)(l,s)}`}function m(e){const t=e.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject(!0);return()=>t.isNullObject}function g(e){const t=e.replace(/^\[\$-([a-z]+-[A-Za-z0-9]+(-[A-Z]+)?)?(,[0-9]{1,3})?\]/,"");return l.gv.some((e=>e===t))}function h(e){return"string"==typeof e&&(0===e.length||0===e.replace(/\s/g,"").length)}function p(e,t){const a=c(t);return null==a?e.workbook.worksheets.getActiveWorksheet():e.workbook.worksheets.getItem(a)}function b(e,t,a,o){const r=o?v(o):"B2",i=o?v(y(o,0,1)):"B3";e.showGridlines=!1;const l=e.getRange(r);l.format.columnWidth=20;const s=t?t.tokens.map((e=>e.text)).join(""):"",c=s.startsWith("'")?`'${s}`:s;if(l.set({values:[[c]],format:{horizontalAlignment:Excel.HorizontalAlignment.left,verticalAlignment:Excel.VerticalAlignment.center,font:{color:"black",name:"Calibri",size:11,bold:!0,italic:!0},wrapText:!1}}),!a){const t=(0,n.cls)();e.getRange(i).set({values:[[t]],format:{horizontalAlignment:Excel.HorizontalAlignment.left,verticalAlignment:Excel.VerticalAlignment.center,font:{color:"black",name:"Calibri",size:11},wrapText:!1}})}}async function f(e,t){let a;for(;!a?.done;)a=t.next(),await e.sync();return a.value}function C(e,t){const a=s(e);if(a){const e=(0,o.AW)(a);return{top:e.top,left:e.left}}return t}function y(e,t,a){const n=s(e),r=c(e);if(n){const e=(0,o.AW)(n),i=(0,o.m4)(e,o.dd.Right,t),l=(0,o.AW)(i);return`${r}!${(0,o.m4)(l,o.dd.Bottom,a)}`}return e}function v(e){const t=e.indexOf(":");return-1===t?e:e.substring(0,t)}function T(e){const t=c(e,!0),a=s(e);if(a){const e=(0,o.AW)(a);return t?`${t}!${(0,o.z)(e.right+1)}${e.top}`:`${(0,o.z)(e.right+1)}${e.top}`}}function x(e,t){const a=c(e,!0),n=s(e);if(n){const e=(0,o.AW)(n);return a?`${a}!${(0,o.z)(e.left+t)}${e.bottom+1}`:`${(0,o.z)(e.left+t)}${e.bottom+1}`}}function S(e){return e.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty))))}async function w(e,t,a){if(a)return p(e,a);{const a=(0,i.d)(e);await e.sync();const n=await a({})(e);return t.push(n.undo),n.result}}function E(e){return 0===e.length?e:e[0].map(((t,a)=>e.map((e=>e[a]))))}function R(e){return void 0!==e}const I="d",A="w",L=new RegExp("[0-9]","gm"),F=new RegExp(I,"gm"),_=new RegExp(`[^=\\[\\]\\.\\\\/%#\\-\\+,;\\(\\):?"&<>'!{}~\\^\\*$Â€Â¢Â£Â¤Â¥â‚ â‚¡â‚¢â‚£â‚¤â‚¥â‚¦â‚§â‚¨â‚©â‚ªâ‚«â‚¬â‚­â‚®â‚¯â‚°â‚±â‚²â‚³â‚´â‚µâ‚¶â‚·â‚¸â‚¹\\s\\ua0c2${I}]`,"gm");function N(e){return(e=(e=e.toLowerCase().replace(F,A)).replace(L,I)).replace(_,A)}function k(e){return e.flatMap((e=>e.map(N)))}function O(e){const t=e.match(/^(?:[^!]+!)?\$?([A-Z]{1,3})\$?\d+(?::\$?[A-Z]{1,3}\$?\d+)?$/);return t?.[1]?function(e){e=e.toUpperCase();let t=0;for(let a=0;a<e.length;a++)t*=26,t+=e.charCodeAt(a)-"A".charCodeAt(0)+1;return t}(t[1]):-1}},95800:(e,t,a)=>{a.d(t,{d:()=>d,x:()=>u});var n=a(92779),o=a(59503),r=a(91259),i=a(50347),l=a(98483);let s,c;function d(e){const t=e.workbook.worksheets.load("items");return e=>async a=>{let d;d=e?.useSheetSeries?null:e?.sheetName?e.sheetName:function(e){if(void 0===s)return null;let t,a=s;do{a++,t=(0,r.L)(n.xe2.InsertedWorksheetName,a)}while(e.some((e=>e.name===t)));return c(a),t}(t.items);const u=t.getActiveWorksheet().load("id");(0,i.yw)("OfficeVSO_9182495_MakeWorkSheetAddSingleBatch")&&await a.sync();const m=d?t.add(d):t.add();if((0,i.yw)("OfficeVSO_9182495_MakeWorkSheetAddSingleBatch")){const e=(0,l.A)();a.trace(e);const t=(0,o.U)((()=>m.delete()),e);try{await a.sync()}catch(e){await t(e)}m.load(["id","name"]);const n=(0,l.A)();a.trace(n);const r=(0,o.U)((()=>m.delete()),n);try{await a.sync()}catch(e){await r(e)}}else{m.load(["id","name"]);const e=(0,l.A)();a.trace(e);const t=(0,o.U)((()=>m.delete()),e);try{await a.sync()}catch(e){await t(e)}}const g=u.id;return{result:m,undo:e=>(e.workbook.worksheets.getItem(g).activate(),e.sync())}}}function u(e,t){const a=e.workbook.worksheets.getActiveWorksheet();return a.load("name"),()=>e=>(t.activate(),Promise.resolve({result:t,undo:t=>(e.workbook.worksheets.getItem(a.name).activate(),t.sync())}))}},15407:(e,t,a)=>{a.d(t,{r:()=>r});var n=a(59266),o=a(57516);function r(e,t,a){if(!(0,n.$)(t))return null;function r(e){return"number"==typeof e&&Number.isFinite(e)}let i=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,s=!1;return e.series.forEach(((c,d)=>{if(c.valueAxisGroup!==a)return;const u=(0,n.Q)(e,d,t);if(!u)return;const m="histogram"===c.layout?(0,o.Mi)(c,e.data):u.values.raw.filter(r);0!==m.length&&(i=m.reduce(((e,t)=>Math.min(e,t)),i),l=m.reduce(((e,t)=>Math.max(e,t)),l),s=!0)})),s?{min:i,max:l}:null}},87919:(e,t,a)=>{function n(e,t){const a=[];return e.forEach((e=>{for(let n=e.top;n<=e.bottom;n++)for(let o=e.left;o<=e.right;o++)a.push(t(n,o))})),a}function o(e,t){return e.map((({row:e,column:a})=>t(e,a)))}a.d(t,{O:()=>o,w:()=>n})},72355:(e,t,a)=>{a.d(t,{Iw:()=>g,fp:()=>p,lC:()=>u,oO:()=>s,sm:()=>h,wF:()=>b,x4:()=>d});var n=a(81364),o=a(5550),r=a(92779),i=a(50347),l=a(37745);function s(e,t,a){const n={"Accept-Language":(0,l.gl)(),Flights:(0,i.lC)(),DeferredFlights:(0,i.RJ)(),SessionId:(0,i.u0)()};return e&&(n.Authorization=`Bearer ${e}`),t&&(n["New-Authorization"]=t),a&&(n[r.Vno]=a),n}let c;function d(){return c}function u(e){c=e}const m=1e4;function g(){return m}function h(e){return 400===e?new n.u(n.O.BadRequest):401===e?new n.u(n.O.Unauthorized):403===e?new n.u(n.O.Forbidden):406===e?new n.u(n.O.NotAcceptable):404===e?new n.u(n.O.NotFound):410===e?new n.u(n.O.Gone):429===e?new n.u(n.O.NetworkThrottleError):500===e?new n.u(n.O.InternalServerError):new Error}function p(){return"F940464D-7313-4BF9-B3F4-60A4E3DC50B7"}function b(){switch((0,i.xy)("InsightsEndpointOverride")){case"dev":return r.WlT;case"dev2":return r.imX;case"ppe":return r.gu1;case"prod":return r.mDj}const e=o.Vv.getSettingAsString(o.zj.InsightsEndpoint);return"Insights.Https.GCC.Bundle"===e?r.W32:"Insights.Https.DOD.Bundle"===e?r.u7V:"Insights.Https.GCCH.Bundle"===e?r.w_Q:r.MYv||(0,o.I_)()||(0,o.B2)()?r.gu1:r.mDj}},59266:(e,t,a)=>{function n(e){switch(e){case"values":case"xValues":case"yValues":return!0;default:return!1}}function o(e,t,a){const n=e.series[t].dataBindings,o=e.data.dimensions,r=n.find((e=>e.dimensionType===a));return r&&o.find((e=>e.id===r.dimensionId))}a.d(t,{$:()=>n,Q:()=>o})},32182:(e,t,a)=>{a.d(t,{YO:()=>n,q:()=>s,wM:()=>c});var n,o=a(92779),r=a(15407);!function(e){e.None="None",e.Trillions="Trillions",e.Billions="Billions",e.Millions="Millions",e.Thousands="Thousands"}(n||(n={}));const i=10,l=[];function s(e,t,a){if("histogram"===e.series[0].layout)return null;const n=(0,r.r)(e,t,a);return n?c(n.min,n.max):null}function c(e,t){l.length>0||l.push({numericalUnitsValue:1e15,languageUnitsValue:"None",localizedUnitsValue:""},{numericalUnitsValue:1e12,languageUnitsValue:"Trillions",localizedUnitsValue:(0,o.chZ)()},{numericalUnitsValue:1e9,languageUnitsValue:"Billions",localizedUnitsValue:(0,o.omg)()},{numericalUnitsValue:1e6,languageUnitsValue:"Millions",localizedUnitsValue:(0,o.Pjp)()},{numericalUnitsValue:1e3,languageUnitsValue:"Thousands",localizedUnitsValue:(0,o.vLX)()});const a=Math.abs(t)>Math.abs(e)?Math.abs(t):Math.abs(e);for(let e=0;e<l.length;e++)if(a>=l[e].numericalUnitsValue*i)return l[e];return null}},93471:(e,t,a)=>{a.d(t,{SB:()=>c,f9:()=>d,gV:()=>s,vc:()=>l,xb:()=>u});var n=a(92779),o=a(72842);function r(e,t){return e.length===t.length&&e.every(((e,a)=>e===t[a]))}function i(e){let t=e.length-1;for(;t>0&&e[t]===e[t-1];t--);return e.slice(0,t+1)}function l(e){const t=e.length;let a=[...e],n=t-1;for(;n>0&&r(a[n],a[n-1]);n--);return a=a.slice(0,n+1),a.map(i)}function s(e,t,a){const n=e[t<e.length?t:e.length-1];return n[a<n.length?a:n.length-1]}function c(e){if(!e)return null;if(0===e.length)return{keys:[],values:[],positions:[]};const t=e.map((e=>e.map((()=>-1)))),a=[],n=[];return e.forEach(((e,o)=>{e.forEach(((e,r)=>{const i=a.indexOf(e);"General"===e?t[o][r]=-1:i<0?(t[o][r]=a.length,a.push(e),n.push({row:o,column:r})):t[o][r]=i}))})),{keys:t,values:a,positions:n}}function d(e){const t=e>=60&&e<61,a=e<60?e+1:e,n=new Date(1e3*Math.round(86400*(a-25569)));return{is29Feb1900:t,adjustedRaw:a,date:new Date(1e3*Math.round(86400*(a-25569+n.getTimezoneOffset()/1440)))}}function u(e,t){if(null==e)return(0,n.Atw)();if("number"!=typeof e)throw new Error("Only numerics and blanks are expected in DatePartOverride grouped data");const{is29Feb1900:a,adjustedRaw:r,date:i}=d(e);if(Number.isNaN(i.getDay()))return r.toString();const l=e=>{const t=`0${e.toString()}`;return t.substr(t.length-2)},s=(i.getFullYear()-i.getFullYear()%10).toString(),c=i.getFullYear().toString(),u=l(i.getMonth()+1),m=a?"29":l(i.getDate()),g=l(i.getHours()),h=l(i.getMinutes()),p=l(i.getSeconds()),b=(Math.floor(i.getMonth()/3)+1).toString();switch(t){case"date":return`${c}-${u}-${m}`;case"decade":return`${s}`;case"monthAndDay":return`${u}-${m}`;case"dayOfMonth":return`${m}`;case"month":return`${u}`;case"quarter":return`Q${b}`;case"year":return`${c}`;case"yearAndMonth":return`${c}-${u}`;case"yearAndQuarter":return`${c} Q${b}`;case"hour":return`${g}:00`;case"minute":return`${h}`;case"hourAndMinute":return`${g}:${h}`;case"hourMinuteAndSecond":return`${g}:${h}:${p}`;case"dateAndHour":return`${c}-${u}-${m} ${g}:00`;case"dateHourAndMinute":return`${c}-${u}-${m} ${g}:${h}`;case"dateHourMinuteAndSecond":return`${c}-${u}-${m} ${g}:${h}:${p}`;default:return(0,o.x)(t)}}},62646:(e,t,a)=>{var n,o,r,i,l,s,c;function d(e){return"ChartVisual"===e||"PivotChartVisual"===e||"ForecastVisual"===e}function u(e){return e&&d(e.visualType)}function m(e){return"inDynamicPeriod"===e.filterType}function g(e){return["equal","notEqual","after","afterOrEqual","before","beforeOrEqual"].some((t=>t===e.filterType))}function h(e){return["between","notBetween"].some((t=>t===e.filterType))}function p(e,t){return t.every((t=>void 0!==e[t]))}a.d(t,{J2:()=>u,M$:()=>l,S$:()=>g,T6:()=>n,Uh:()=>o,VZ:()=>d,WZ:()=>r,kp:()=>h,o_:()=>p,vr:()=>m}),function(e){e.ChartTypeNotSupported="chartTypeNotSupported",e.ChartTypeNotAppropriate="chartTypeNotAppropriate"}(n||(n={})),function(e){e.NotStarted="notStarted",e.Running="running",e.Succeeded="succeeded",e.Failed="failed",e.Cancelling="cancelling",e.Cancelled="cancelled"}(o||(o={})),function(e){e.NotUnderstood="notUnderstood",e.Error="error",e.Answered="answered",e.Conversation="conversation"}(r||(r={})),function(e){e.None="none",e.Entities="entities",e.PotentialBias="potentialBias"}(i||(i={})),function(e){e.UnanswerableQuery="UnanswerableQuery",e.AskForClarification="AskForClarification",e.InvalidJsonFormat="InvalidJsonFormat",e.InvalidResponseType="InvalidResponseType",e.InvalidAE="InvalidAE",e.MismatchedColumnName="MismatchedColumnName",e.UnsupportedExecution="UnsupportedExecution",e.LLMThrottledError="LLMThrottledError",e.LLMHttpRequestError="LLMHttpRequestError",e.LLMTimeout="LLMTimeout",e.LLMGenericError="LLMGenericError",e.SymbolicLogicException="SymbolicLogicException",e.VisualConversionError="VisualConversionError",e.MissingFunctionality="MissingFunctionality",e.ContentTooLarge="ContentTooLarge",e.UnsupportedLanguage="UnsupportedLanguage",e.UnsupportedTextAnalysisType="UnsupportedTextAnalysisType",e.TextAnalysisUnexpectedLLMResult="TextAnalysisUnexpectedLLMResult",e.BlockedByRAI="BlockedByRAI"}(l||(l={})),function(e){e.OLAP="olap",e.Insights="insights",e.TextAnalysis="textAnalysis",e.Forecasting="forecasting",e.Visualization="visualization"}(s||(s={})),function(e){e.Summary="summary",e.Clustering="clustering",e.Topic="topic",e.KeyPhrase="keyPhrase",e.Sentiment="sentiment",e.General="general"}(c||(c={}))},59384:(e,t,a)=>{a.d(t,{D4:()=>g,tN:()=>h,HF:()=>b,M7:()=>u,Hf:()=>m,Pe:()=>p,y3:()=>s,m6:()=>c,mz:()=>d});var n=a(92779),o=a(66036),r=a(91259),i=a(18700);var l=a(87919);const s=15,c=30,d=1;function u(e,t){switch(typeof e){case"string":return e;case"boolean":return t.trim();default:return t}}async function m(e,t,a){if(null==t)throw new Error("V3.PivotTableField is missing nameReferences.");if(t.length>1){return async function(e,t,a){const o=Promise.all((0,l.O)(t,e.getValue.bind(e))),s=Promise.all((0,l.O)(t,e.getText.bind(e))),[c,d]=await Promise.all([o,s]);return function(e,t,a){if(null==e)return null;const o=e.map(((e,a)=>u(e,t[a])));return o.every(i.So)?(0,r.L)((0,n.m1B)(),a):o.map((e=>(0,i.So)(e)?(0,n.Atw)():e)).join(" ")}(c,d,a)}(e,t,"columnMajor"===a.table.orientation?t[t.length-1].column-a.table.tableLocation.left+1:t[t.length-1].row-a.table.tableLocation.top+1)}const{row:o,column:s}=t[0];if(void 0===o&&void 0===s)throw new Error("V3.SourceCellReference is missing both row and column references.");if(void 0===o)return(0,r.L)((0,n.m1B)(),s-a.table.tableLocation.left+1);if(void 0===s)return(0,r.L)((0,n.m1B)(),o-a.table.tableLocation.top+1);const c=e.getValue(o,s),d=e.getText(o,s),[m,g]=await Promise.all([c,d]),h=u(m,g);return(0,i.So)(h)?(0,n.Atw)():h}const g="m/d/yyyy",h={key:g,currency:!1,dateTime:!0,dateTimeHasDayOfWeek:!0,dateTimeHasMonth:!0,dateTimeHasYear:!0,numeric:!1,percent:!1,text:!1};async function p(e,t,a){const r=e.getValue(t,a),i=e.getText(t,a),l=e.getFormatLocal(t,a),s=e.formatSourceDate(t,a),[c,d,u,m]=await Promise.all([r,i,l,s]);if(m&&o.P.getNumberFormatCache().isDateTime(u))return m;{const e=function(e,t,a){return"string"==typeof e?e:"number"!=typeof e||o.P.getNumberFormatCache().isDateTime(a)?t:e.toString()}(c,d,u);return null==c?(0,n.Atw)():e}}function b(e){const t=(e.columnFields||[]).length,a=(e.dataFields||[]).length;return t+(t>0&&a>1?1:0)+1}},89791:(e,t,a)=>{a.d(t,{g:()=>h});var n=a(17649),o=a(32182),r=a(92779),i=a(91259),l=a(50347),s=a(39234),c=a(91960),d=a(56229),u=a(62646),m=a(42012),g=a(59266);function h(e,t){const a=function(e,t){if(!e||!(0,u.J2)(e.visual))return;const a=e.visual.chart,h=(0,s.ip)(a),p=(e,t)=>("primary"===t?(0,n.lf)(e):(0,n.t7)(e)).filter((e=>(0,g.$)(e.dimension))),b=p(h.primary.insightsType,"primary");h.secondary&&b.push(...p(h.secondary.insightsType,"secondary"));switch(b.length){case 0:default:return;case 1:{const n=(0,o.q)(a,b[0].dimension,"primary");if("PivotChartVisual"!==e.visual.visualType||!t&&1!==e.visual.pivotTable.dataFields.length)return n&&n.languageUnitsValue!==o.YO.None?(0,i.L)((0,r.xKU)(),n.localizedUnitsValue):void 0;{const t=e.visual.pivotTable.dataFields,a=t.length;return t.map(((e,t)=>{const{name:s,dataCalculation:c}=e,u=(0,d.iz)(c),m=(0,i.L)((0,r.Gn5)(),u,s),g=n&&n.languageUnitsValue!==o.YO.None?(0,i.L)((0,r.ZQs)(),m,(0,l.yw)("OfficeVSO_8693694_UseLocalizedUnitForSubTitle")?n.localizedUnitsValue:n.languageUnitsValue):m;return t===a-1?g:(0,i.L)((0,r.cFM)(),g)})).join("")}}case 2:{const e=b.map((e=>{const t=(0,o.q)(a,e.dimension,e.axisGroup);if(!t)return null;const i=function(e,t){const a=(e.axes||[]).find((e=>e.dimensionType===t.dimension&&e.axisGroup===t.axisGroup));if(a){const e=a.title?(0,c.HW)(a.title):null;if(e)return e}const o=(0,m.tJ)(e.series);switch(t.orientation){case n.UQ.Horizontal:return o?"primary"===t.axisGroup?(0,r.KdV)():(0,r.W9h)():(0,r.tdb)();case n.UQ.Vertical:return o?"primary"===t.axisGroup?(0,r.$98)():(0,r.JuZ)():(0,r.kfS)();default:throw new Error("Invalid orientation")}}(a,e);return{units:t.localizedUnitsValue,name:i}})).filter((e=>!!e));if(0===e.length)return;if(1===e.length)return(0,i.L)((0,r.ZQs)(),e[0].name,e[0].units);if(2===e.length&&e[0].units===e[1].units)return(0,i.L)((0,r.xKU)(),e[0].units);if(2===e.length)return(0,i.L)((0,r.iMG)(),e[0].name,e[0].units,e[1].name,e[1].units);throw new Error("Invalid number of descriptors.")}}}(e,t);return(0,l.yw)("OfficeVSO_9565730_RTLSubtitleForNTier")&&a?(0,r.kK2)(a):a}},91960:(e,t,a)=>{a.d(t,{HK:()=>r,HW:()=>o,m9:()=>i});var n=a(92779);function o(e){return e.runs.map((e=>e.text)).join("")}function r(e,t){const a=o(e),n=a.length,r=a.substring(0,t);return t<n?r.concat("â€¦"):r}function i(e){return e.map((e=>null==e?(0,n.Atw)():e))}},56229:(e,t,a)=>{a.d(t,{K4:()=>u,Z_:()=>d,iz:()=>c});var n=a(92779),o=a(17649),r=a(72842),i=a(91259),l=a(39234),s=a(91960);function c(e){switch(e){case"sum":return(0,n.Qte)();case"count":return(0,n.O0M)();case"average":return(0,n.o9V)();case"min":return(0,n.dlV)();case"max":return(0,n.PX_)();case"stdDev":return(0,n.fVE)();case"variance":return(0,n.ORJ)();case"none":case"distinctCount":throw new Error("Invalid Data Calculation type.");default:(0,r.c)(e,"Invalid Data Calculation type.")}}function d(e,t=!0){const{title:a,visual:d}=e,u=a&&t?(0,i.L)((0,n.MiK)(),(0,s.HW)(a)):"";switch(d.visualType){case"ChartVisual":case"PivotChartVisual":{const e=d.chart,t=(0,l.ip)(e),a=(0,i.L)((0,n.Is)(),e.series.length),r=e.data,c=(e,t)=>{const a=function(e,t){if(0===e.dataBindings.length)return 0;const a=e.dataBindings[0].dimensionId;return t.dimensions.find((e=>e.id===a)).values.raw.length}(e,r);return(0,i.L)((0,n.LxC)(),t+1,a)};if(t.secondary){const r=(0,i.L)((0,n.XM5)(),t.primary.localizedName,t.secondary.localizedName),l=(e,a,n)=>{const r=a===e.axisGroup||"primary"===a&&void 0===e.axisGroup,i=(0,o.C$)(t.primary.insightsType,e.dimensionType),l=!!i&&i.orientation===n;return r&&l},d=e.axes.find((e=>l(e,"primary",o.UQ.Horizontal))),m=d?.title?(0,i.L)((0,n.Sa0)(),(0,s.HW)(d.title)):"",g=e.axes.find((e=>l(e,"primary",o.UQ.Vertical))),h=g?.title?(0,i.L)((0,n.Ony)(),(0,s.HW)(g.title)):"",p=e.axes.find((e=>l(e,"secondary",o.UQ.Horizontal))),b=p?.title?(0,i.L)((0,n.YtG)(),(0,s.HW)(p.title)):m,f=e.axes.find((e=>l(e,"secondary",o.UQ.Vertical))),C=f?.title?(0,i.L)((0,n.qvS)(),(0,s.HW)(f.title)):"",y=`${(0,i.L)((0,n.MiK)(),t.primary.localizedName)} ${m} ${h}`,v=`${(0,i.L)((0,n.MiK)(),t.secondary.localizedName)} ${b} ${C}`,T=[],x=[];e.series.forEach(((e,t)=>{"secondary"!==e.valueAxisGroup?T.push({series:e,index:t}):x.push({series:e,index:t})}));return`${u} ${r} ${a} ${y} ${T.map((e=>c(e.series,e.index))).join(" ")} ${v} ${x.map((e=>c(e.series,e.index))).join(" ")}`.trim()}return`${u} ${(0,i.L)((0,n.eZ0)(),t.primary.localizedName)} ${a} ${e.series.map(c).join(" ")} ${(e.axes||[]).map((e=>{const a=(0,o.C$)(t.primary.insightsType,e.dimensionType);if(!a||!e.title)return"";const r=(0,s.HW)(e.title);if(a.orientation===o.UQ.Horizontal)return(0,i.L)((0,n.zvE)(),r);if(a.orientation===o.UQ.Vertical)return(0,i.L)((0,n.mjS)(),r);throw new Error("Invalid orientation")})).join(" ")}`.trim()}case"PivotTableVisual":{const{rowFields:e,columnFields:t,dataFields:a,pivotTableData:o}=d.pivotTable;if(o&&0===o.length)return n.xe2.NoValueAnswerTextForIdeas;const r=[];switch((e||[]).length){case 1:r.push((0,i.L)((0,n.hLq)(),e[0].name));break;case 2:r.push((0,i.L)((0,n.n0L)(),e[0].name,e[1].name))}if(1===(t||[]).length&&r.push((0,i.L)((0,n.gOS)(),t[0].name)),1===(a||[]).length){const{name:e,dataCalculation:t}=a[0],o=c(t),l=(0,i.L)((0,n.Gn5)(),o,e);r.push((0,i.L)((0,n.e0T)(),l))}return`${u} ${r.join(", ")}.`.trim()}case"BlankPivotTable":case"ForecastVisual":case"TextAnalysisVisual":return"";case"QueryResultVisual":return 0===d.result.fields.length||0===d.result.fields[0].values.raw.length?n.xe2.NoValueAnswerTextForIdeas:u.trim();default:return(0,r.x)(d)}}function u(e,t){for(let a=0;e[a]||t[a];a++)if(e[a]!==t[a])return a;return-1}},42012:(e,t,a)=>{a.d(t,{fB:()=>l,ps:()=>g,q3:()=>i,tJ:()=>r});var n=a(59266),o=a(15407);function r(e){return e.some((e=>"secondary"===e.valueAxisGroup))}function i(e){return!!r(e)&&e.some((e=>"line"===e.layout&&"primary"===e.valueAxisGroup))}function l(e,t){const a=(0,n.Q)(e,0,"categories"),o=!!a&&!!a.formatInfo&&a.formatInfo.isDateTime,r=!!a&&a.values.raw.every((e=>"number"==typeof e));if("values"===t.dimension&&i(e.series)&&o&&r){const a="primary"===t.axisGroup?"secondary":"primary";return e.axes.find((e=>e.dimensionType===t.dimension&&e.axisGroup===a))}return e.axes.find((e=>e.dimensionType===t.dimension&&e.axisGroup===t.axisGroup))}const s=10,c=1/6,d=.05,u=1.5,m=6;function g(e,t,a,n){const r=(0,o.r)(e,t,a);if(null===r)return null;const i=r.max-r.min;if(i<0)throw new Error("Invalid MinMax: max should not be less than min");if(0===i){if(0===r.min)return{minimum:0,maximum:1};r.min<0?r.max=0:r.min=0}let l=r.max,s=r.min;if(s>0||l<0){const e=s>0?l:Math.abs(s),t=l-s;t>e/m?s>0?s=0:l=0:s>0?s-=t/2:l+=t/2}const g=l-s,p=(1+d)*g,b=d*g,f=p*u;let C,y;const v=e=>{s=s-r.min+b>0?r.min-b:s;const t=h(e||-1*s);return Math.floor(s/t)*t},T=e=>{l=l-r.max-b<0?r.max+b:l;const t=h(e||l);return Math.ceil(l/t)*t};if(l>0&&s<0)C=v(p),y=T(p);else if(l>0){g<c*l&&!n?(C=v(f),y=T(f)):(C=0,y=T())}else if(s<0){g<-1*c*s&&!n?(C=v(f),y=T(f)):(C=v(),y=0)}return void 0!==C&&void 0!==y?{minimum:C,maximum:y}:null}function h(e){const t=[.1,.2,.5,1,2,5,10],{base:a,exponent:n}=function(e){if(e<0)throw new Error("Input number should be greater than or equal to 0");if(0===e)return{base:0,exponent:0};const t=Math.floor(Math.log10(e)),a=e/s**t;return{base:a,exponent:t}}(e);for(let e=t.length-1;e>1;--e)if(a>t[e]){return t[e-2]*s**n}return t[0]*s**n}},57516:(e,t,a)=>{function n(e){const t=e.length;return e.map(((a,n)=>e[t-n-1]))}function o(e){return e.sort(((e,t)=>e.value<t.value?-1:e.value>t.value?1:0))}function r(e,t,a){let n=e.data[t][0].map(((e,t)=>({index:t,value:e})));(e.exceptionalDatapoints||[]).forEach((e=>{n[e.index].exceptionalDatapoint=e})),(e.dataMarkers?.exceptionalDataMarkers||[]).forEach((e=>{n[e.index].exceptionalDataMarker=e})),n=a(n);const o=Object.keys(e.data).reduce(((t,a)=>{return{...t,[a]:(o=e.data[a],r=n,o.map((e=>e.map(((t,a)=>e[r[a].index])))))};var o,r}),{}),r=[];n.forEach(((e,t)=>{e.exceptionalDatapoint&&r.push({...e.exceptionalDatapoint,index:t})}));const i=[];n.forEach(((e,t)=>{e.exceptionalDataMarker&&i.push({...e.exceptionalDataMarker,index:t})}));const l={...e,data:o,exceptionalDatapoints:r};return i.length>0&&(l.dataMarkers={...l.dataMarkers,exceptionalDataMarkers:i}),l}function i(e,t){if(1!==t.dimensions.length||!e.binOptions)return[];const a=e.binOptions,n=t.dimensions[0].values.raw.filter((e=>"number"==typeof e&&Number.isFinite(e)));n.sort(((e,t)=>e-t));let o=n[0],r=n[n.length-1],i=a.binCount;a.underflow&&(o=a.underflow,i--),a.overflow&&(r=a.overflow,i--);let l=0;const s=[];if(a.underflow){let e=0;for(;l<n.length&&n[l]<=o+Number.EPSILON;)e++,l++;s.push(e)}for(let e=1;e<=i;e++){const t=Math.min(o+e*a.binWidth,r);let i=0;for(;l<n.length&&n[l]<=t+Number.EPSILON;)i++,l++;s.push(i)}return a.overflow&&s.push(n.length-l),s}function l(e){const t=e.data.values[0];let a=!1;for(let e=0;e<t.length;e++)"NaN"!==t[e]?(!a&&(e+1>=t.length||"NaN"===t[e+1])&&(t[e]="NaN"),a=!0):a=!1;const n={...e};return n.data.values[0]=t,n}a.d(t,{Hw:()=>n,Lt:()=>r,Mi:()=>i,V0:()=>o,jx:()=>l})},72842:(e,t,a)=>{function n(e){return e}function o(e,t){throw new Error(t)}a.d(t,{c:()=>o,x:()=>n})},16144:(e,t,a)=>{function n(e,t){if(!1===e)throw new Error(t)}a.d(t,{x:()=>n})},11689:(e,t,a)=>{a.d(t,{U:()=>c,j:()=>s});var n=a(86512),o=a(20106),r=a(35893),i=a(40910),l=a(49462);const s=()=>(0,l.wA)();function c(e){const t=(0,n.HY)(r.g);return(0,o.U1)({reducer:t,middleware:e=>e().concat(i.c_,r.F.middleware),preloadedState:e})}},81364:(e,t,a)=>{a.d(t,{O:()=>o,u:()=>n});class n extends Error{getErrorLocation(){return this.error instanceof OfficeExtension.Error?this.error.debugInfo.errorLocation:null}constructor(e,t){super(e),this.errorCode=e,t instanceof n&&(t.error instanceof Error||t.error instanceof OfficeExtension.Error)?this.error=t.error:(t instanceof Error||t instanceof OfficeExtension.Error)&&(this.error=t),Object.setPrototypeOf(this,n.prototype)}}var o;!function(e){e.SelectionFailed="SelectionFailed",e.LargeData="LargeData",e.UnboundedRange="UnboundedRange",e.LargePivotTableSource="LargePivotTableSource",e.NotAlignedRanges="NotAlignedRanges",e.SeparateRowsSelected="SeparateRowsSelected",e.SeparateColumnsSelectedOnRowMajorTable="SeparateColumnsSelectedOnRowMajorTable",e.SelectionsFromDifferentRanges="SelectionsFromDifferentRanges",e.NetworkError="NetworkError",e.NetworkTimeout="NetworkTimeout",e.BadRequest="BadRequest",e.InternalServerError="InternalServerError",e.NetworkThrottleError="NetworkThrottleError",e.NoRecommendations="NoRecommendations",e.RecommendationsFailed="RecommendationsFailed",e.InsertionFailed="InsertionFailed",e.InsertionFailedCellEditMode="InsertionFailedCellEditMode",e.PivotTableSelection="PivotTableSelection",e.SignInFailed="SignInFailed",e.TrySampleDataError="TrySampleDataError",e.PreferencesFailed="PreferencesFailed",e.NoRecommendationsWithPreferences="NoRecommendationsWithPreferences",e.NaturalLanguageFailed="NaturalLanguageFailed",e.NaturalLanguageVisualInsertionFailed="NaturalLanguageVisualInsertionFailed",e.NaturalLanguageVisualInsertionFailedCellEditMode="NaturalLanguageVisualInsertionFailedCellEditMode",e.NaturalLanguageFailedNoSuggestions="NaturalLanguageFailedNoSuggestions",e.NaturalLanguageFailedConversation="NaturalLanguageFailedConversation",e.Unauthorized="Unauthorized",e.Forbidden="Forbidden",e.NotAcceptable="NotAcceptable",e.NotFound="NotFound",e.Gone="Gone",e.MultiSelectionError="MultiSelectionError",e.CellEditModeError="CellEditModeError",e.InvalidSelection="InvalidSelection",e.RecommendedPivotTablesNoRecommendations="RecommendedPivotTablesNoRecommendations",e.RecommendedPivotTablesFailed="RecommendedPivotTablesFailed",e.RecommendedPivotTablesPivotTableSelection="RecommendedPivotTablesPivotTableSelection",e.RecommendedPivotTablesInsertionFailed="RecommendedPivotTablesInsertionFailed",e.RecommendedPivotTablesInsertionFailedCellEditMode="RecommendedPivotTablesInsertionFailedCellEditMode",e.RecommendedPivotTablesBlankInsertionFailedInvalidDataSource="RecommendedPivotTablesBlankInsertionFailedInvalidDataSource",e.FetchNaturalLanguageContextFailed="FetchNaturalLanguageContextFailed",e.NaturalLanguageUnsupportedLanguageError="NaturalLanguageUnsupportedLanguageError",e.NaturalLanguageFailedForShortQuery="NaturalLanguageFailedForShortQuery",e.InactiveWorkbook="InactiveWorkbook",e.LocaleFetchFailed="LocaleFetchFailed",e.NaturalLanguageFailedForPotentialBiasQuery="NaturalLanguageFailedForPotentialBiasQuery",e.RecommendedPivotTablesNoRecosForSingleLineData="RecommendedPivotTablesNoRecosForSingleLineData",e.RecommendedChartsPivotTableSourceNoDataField="RecommendedChartsPivotTableSourceNoDataField",e.RecommendedChartsPivotTableSourceNoRowField="RecommendedChartsPivotTableSourceNoRowField",e.InsertionFailedPivotCacheProtected="InsertionFailedPivotCacheProtected",e.InsertionFailedDestinationProtected="InsertionFailedDestinationProtected",e.InsertionFailedCurrentWorksheetProtected="InsertionFailedCurrentWorksheetProtected",e.OCVFeedbackError="OCVFeedbackError",e.InsertCalculatedColumnFailed="InsertCalculatedColumnFailed",e.InsertCalculatedColumnWithTargetRangeFailed="InsertCalculatedColumnWithTargetRangeFailed",e.InsertCommentFailed="InsertCommentFailed",e.AnalyzeTyping="AnalyzeTyping",e.DeactivateRangePickerFailed="DeactivateRangePickerFailed",e.FetchUnsetFlight="FetchUnsetFlight",e.FlightingFailure="FlightingFailure",e.FormulaErrorContentTooLarge="FormulaErrorContentTooLarge",e.FormulaErrorExceedLengthLimitation="FormulaErrorExceedLengthLimitation",e.FormulaErrorProactiveLimitation="FormulaErrorProactiveLimitation",e.FormulaErrorTranslationFailure="FormulaErrorTranslationFailure",e.FormulaErrorUnknown="FormulaErrorUnknown",e.FormulaErrorValidationIssue="FormulaErrorValidationIssue",e.GenerateSuggestedQueries="GenerateSuggestedQueries",e.InitializeAppFailure="InitializeAppFailure",e.InitializeOfficeFailure="InitializeOfficeFailure",e.InitializeSharedRuntimeFailure="InitializeSharedRuntimeFailure",e.InsertionCleanupFailed="InsertionCleanupFailed",e.IvyWebFailure="IvyWebFailure",e.LoadStringsFailure="LoadStringsFailure",e.NativeSelectionFailed="NativeSelectionFailed",e.NaturalLanguageContextFailed="NaturalLanguageContextFailed",e.ReducerException="ReducerException",e.RenderRecommendationFailed="RenderRecommendationFailed",e.FailedToParseClientVersion="FailedToParseClientVersion",e.FailedToParseSelectionContext="FailedToParseSelectionContext",e.FailedToSelectSelectionContext="FailedToSelectSelectionContext",e.SeeAllChartsFailed="SeeAllChartsFailed",e.DataRefreshFailed="DataRefreshFailed",e.XlimResolveError="XlimResolveError",e.SubstrateSignalError="SubstrateSignalError",e.FailedToParseCalculatedColumnSuggestion="FailedToParseCalculatedColumnSuggestion",e.ShowPreviewColumnFailed="ShowPreviewColumnFailed",e.HidePreviewColumnFailed="HidePreviewColumnFailed",e.DefaultInsertCalculatedColumnFailed="DefaultInsertCalculatedColumnFailed",e.PreviewValidationFailed="PreviewValidationFailed",e.UpdateAppStyleFailed="UpdateAppStyleFailed",e.NavigateToDataAIError="NavigateToDataAIError",e.ExcelIntelligenceSignalFailed="ExcelIntelligenceSignalFailed",e.ExcelIntelligenceSignalFailedWithSuggestions="ExcelIntelligenceSignalFailedWithSuggestions",e.GetInsightsFailed="GetInsightsFailed",e.GetInterpretationsFailed="GetInterpretationsFailed",e.GetNLContextFailed="GetNLContextFailed",e.InsertRecommendationsDashboard="InsertRecommendationsDashboard",e.CheckForTablesError="CheckForTablesError",e.CalculatedColumnsInsertColumnFailedGetRange="CalculatedColumnsInsertColumnFailedGetRange",e.CalculatedColumnsInsertColumnFailedResolveTableLikeEntity="CalculatedColumnsInsertColumnFailedResolveTableLikeEntity",e.DeleteLastColumnFailed="DeleteLastColumnFailed",e.CalculatedColumnExpandFailedNotEmptyColumn="CalculatedColumnExpandFailedNotEmptyColumn",e.CalculatedColumnExpandFailed="CalculatedColumnExpandFailed",e.CalculatedColumnPartialInsertFailed="CalculatedColumnPartialInsertFailed",e.FetchAndSetActiveTableFailed="FetchAndSetActiveTableFailed",e.ColumnRecommendationsNotAvailable="ColumnRecommendationsNotAvailable",e.DataLocaleUndefined="DataLocaleUndefined",e.AnalyzeDataTimeout="AnalyzeDataTimeout",e.CalculatedColumnPreviewNotUpdated="CalculatedColumnPreviewNotUpdated",e.CalculatedColumnPreviewNoColumnLetters="CalculatedColumnPreviewNoColumnLetters",e.CalculatedColumnFormulaLocalizationFailed="CalculatedColumnFormulaLocalizationFailed",e.CalculatedColumnConvertAnnotationToRecommendationFailed="CalculatedColumnConvertAnnotationToRecommendationFailed",e.CalculatedColumnFailedToSendSignal="CalculatedColumnFailedToSendSignal",e.CalculatedColumnInsertColumnFailedVerifyPreview="CalculatedColumnInsertColumnFailedVerifyPreview",e.CalculatedColumnInsertColumnError="CalculatedColumnInsertColumnError",e.CopyButtonError="CopyButtonError",e.PostRangesError="PostRangesError",e.InitializeRangesFailure="InitializeRangesFailure",e.StoreDataFailure="StoreDataFailure",e.PrePythonModeError="PrePythonModeError",e.PythonStaleRuntimeError="PythonStaleRuntimeError",e.PythonBusyStateError="PythonBusyStateError",e.PythonCodeAndPostViewPropsNotSerializable="PythonCodeAndPostViewPropsNotSerializable",e.PythonGeneralError="PythonGeneralError",e.PythonGeneralContextError="PythonGeneralContextError",e.PythonInsertFailed="PythonInsertFailed",e.PythonProtectedSheetError="PythonProtectedSheetError",e.PythonCopyFailed="PythonCopyFailed",e.PythonNoActiveLicense="PythonNoActiveLicense",e.PythonUnsupportedLanguage="PythonUnsupportedLanguage",e.PythonUnsupportedPlatform="PythonUnsupportedPlatform",e.PythonUnsupportedResponseType="PythonUnsupportedResponseType",e.PythonDeletedSheetBeforeResponseGeneration="PythonDeletedSheetBeforeResponseGeneration",e.PythonDeletedSheetDuringResponseGeneration="PythonDeletedSheetDuringResponseGeneration",e.PythonUnexpectedMissingSheetInContextExtraction="PythonUnexpectedMissingSheetInContextExtraction",e.PythonMissingResponseValue="PythonMissingResponseValue",e.PythonInvalidResponseOrder="PythonInvalidResponseOrder",e.PythonResponseAllDebugChunks="PythonResponseAllDebugChunks",e.PythonCodeRetryMaximumHit="PythonCodeRetryMaximumHit",e.PythonAugLoopCallsPerQueryMaximumHit="PythonAugLoopCallsPerQueryMaximumHit",e.PythonStartAnalysisEditModeError="PythonStartAnalysisEditModeError",e.PythonGenericEditModeError="PythonGenericEditModeError",e.PythonInvalidSelectedContext="PythonInvaldSelectedContext",e.PythonUnknownError="PythonUnknownError",e.PythonPostViewError="PythonPostViewError",e.PythonDataFrameInsertFailed="PythonDataFrameInsertFailed",e.PythonContextUndefinedParameter="PythonContextUndefinedParameter",e.PythonObjectReferenceError="PythonObjectReferenceError",e.PythonExitAnalysisError="PythonExitAnalysisError",e.PythonAddResultsToNewSheetError="PythonAddResultToNewSheetError",e.PythonTuiNotShownError="PythonTuiNotShownError",e.PythonGetDiagnosticsError="PythonGetDiagnosticsError",e.PythonPayloadEmptyError="PayloadEmptyError",e.PayloadSizeError="PayloadSizeError",e.CalculatedCellExpandFailedNotEmptyCell="CalculatedCellExpandFailedNotEmptyCell",e.CalculatedCellExpandFailed="CalculatedCellExpandFailed",e.GetChartRecoFailed="GetChartRecoFailed",e.GetPivotTableRecoFailed="GetPivotTableRecoFailed",e.MissingOperationLocation="MissingOperationLocation",e.FeedbackApiError="FeedbackApiError",e.CalculatedColumnsInvalidFormula="CalculatedColumnsInvalidFormula",e.ShowSuggestionsTimeout="ShowSuggestionsTimeout",e.PythonAutofitFailed="PythonAutofitFailed",e.DefaultInsertCalculatedCellFailed="DefaultInsertCalculatedCellFailed",e.DefaultInsertCalculatedCellTitleFailed="DefaultInsertCalculatedCellTitleFailed",e.CalculatedCellPartialInsertFailed="CalculatedCellPartialInsertFailed",e.CalculatedCellUndefinedColumnHeader="CalculatedCellUndefinedColumnHeader",e.TLRRevisionError="TLRRevisionError",e.CalculatedCellsGetIsTotalRowCellsEmptyFailed="CalculatedCellsGetIsTotalRowCellsEmptyFailed",e.EvaluateQueryFailed="EvaluateQueryFailed",e.FetchAndSetTabularRangeAsActiveTableFailed="FetchAndSetTabularRangeAsActiveTableFailed",e.FetchAndSetUnrecognizedRangeFailed="FetchAndSetUnrecognizedRangeFailed",e.ResolveTableLikeEntityFailed="ResolveTableLikeEntityFailed",e.UpdateSelectionFailed="UpdateSelectionFailed",e.UpdateSelectionFailedWillRetry="UpdateSelectionFailedWillRetry",e.FetchPivotTableFailed="FetchPivotTableFailed",e.SetActiveChartFailed="SetActiveChartFailed",e.FetchActivePivotTableFailed="fetchActivePivotTableFailed",e.FetchPivotTableFailedToLoadRange="FetchPivotTableFailedToLoadRange",e.SelectionIntegrityCheckFailed="SelectionIntegrityCheckFailed",e.SelectionIntegrityCheckEncounteredNonWorksheet="SelectionIntegrityCheckEncounteredNonWorksheet",e.SelectionIntegrityCheckEncounteredNoGridSelection="SelectionIntegrityCheckEncounteredNoGridSelection",e.SelectionIntegrityCheckFoundTableMismatch="SelectionIntegrityCheckFoundTableMismatch",e.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent="SelectionIntegrityCheckFoundNoTableButOneShouldBePresent",e.SelectionIntegrityCheckFlushingSelectionFailed="SelectionIntegrityCheckFlushingSelectionFailed",e.ContextManagerInitializationFailed="ContextManagerInitializationFailed",e.FetchAndSetActiveTableLikeEntityFailed="FetchAndSetActiveTableLikeEntityFailed",e.AuthError="AuthError",e.LoadAuthError="LoadAuthError",e.SetFormulaPreviewFailed="SetFormulaPreviewFailed",e.TLRFixDuplicatesFailed="TLRFixDuplicatesFailed",e.TLRFixMergedCellsFailed="TLRFixMergedCellsFailed",e.TLRRetrieveMergeCellsFailed="TLRRetrieveMergeCellsFailed",e.TLRFixEmptyHeadersFailed="TLRFixEmptyHeadersFailed",e.TLRValidateEmptyHeadersFailed="TLRValidateEmptyHeadersFailed",e.AutoFixTLRFailed="AutoFixTLRFailed",e.SetContextWithAddressValidationFailed="SetContextWithAddressValidationFailed",e.FormulaGenerationCreateFetchOperationFailed="FormulaGenerationCreateFetchOperationFailed",e.PythonSendSkillResponseToFlux="PythonSendSkillResponseToFlux"}(o||(o={}))},40910:(e,t,a)=>{a.d(t,{H:()=>x,IJ:()=>I,LV:()=>O,N6:()=>T,NQ:()=>E,Ri:()=>y,S8:()=>N,T0:()=>w,c_:()=>_,eE:()=>L,gr:()=>A,ij:()=>k,in:()=>v,kw:()=>P,n5:()=>F,sC:()=>R,zG:()=>M});var n=a(89099),o=a(24220),r=a(45242),i=a(81364),l=a(15197),s=a(88179),c=a(31030),d=a(48314),u=a(23343),m=a(63395);const g=(e,t)=>({dataCategories:r.o.DataCategories.ProductServiceUsage,samplingPolicy:t||r.o.SamplingPolicy.Measure,diagnosticLevel:e||r.o.DiagnosticLevel.FullEvent});let h,p,b,f;const C={};function y(e){delete C[e]}function v(e,t){C[e]?C[e].push(t):C[e]=[t]}function T(e,t){if(!C[e])return;const a=C[e].indexOf(t);a>-1&&C[e].splice(a,1)}function x(e){if(C[e]&&0!==C[e].length)return C[e][C[e].length-1]}function S(e,t){h||(h=d.M.getInstance()),e.push({key:s.W0.CorrelationId,value:p}),b&&e.push({key:s.W0.ExcelCorrelationId,value:b}),f&&e.push({key:s.W0.FetchRecommendationsCorrelationId,value:f}),h.logEvent({eventType:c.S.AnalyzeDataEvents,eventData:e},t)}async function w(e,t,a,n){return(0,m.H)(t(),(t=>E(e,t,a,n)))}function E(e,t,a,i){h||(h=d.M.getInstance()),function(e,t){"InsertColumn"===e&&t>u.R.getInsertColumnTimeout()&&d.M.getInstance().logStandardizedAshaErrorEvent(o.W.Response_Delayed_Or_Timed_Out,n.c.Inserting_Column_Took_Too_Long_Time,s.BJ.FormulaGeneration)}(e,t);const l=[{key:s.EB.Type,value:e},{key:s.EB.Duration,value:t},{key:s.EB.CorrelationId,value:p}];b&&l.push({key:s.EB.ExcelCorrelationId,value:b}),f&&l.push({key:s.EB.FetchRecommendationsCorrelationId,value:f}),a&&l.push({key:s.EB.RequestId,value:a}),i&&l.push({key:s.EB.SuggestionId,value:i}),h.logEvent({eventType:c.S.AnalyzeDataDuration,eventData:l},g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function R(e,t,a,n,o,i){const{isTable:l,isPivotTable:c,hasTableHeaders:d}=n;S([{key:s.W0.EventType,value:"GetSelectionContext"},{key:s.W0.NumRows,value:t},{key:s.W0.NumColumns,value:e},{key:s.W0.SelectionExpanded,value:a},{key:s.W0.IsSmallSelection,value:o},{key:s.W0.IsTable,value:l},{key:s.W0.IsPivotTable,value:c},{key:s.W0.HasTableHeaders,value:d},{key:s.W0.AreaCount,value:i}],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function I(e){S([{key:s.W0.EventType,value:"GetDataFromRange"},{key:s.W0.HasInvalidValues,value:e}],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function A(e,t,a,n,o){S([{key:s.W0.EventType,value:"InsightsApiCall"},{key:s.W0.Method,value:e},{key:s.W0.Api,value:t},{key:s.W0.ResponseCode,value:a},{key:s.W0.RetryCount,value:n},...o],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function L(e){const t=g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact);e.push({key:s.W0.EventType,value:"RangeDataPerformance"}),S([{key:s.W0.EventType,value:"RangeDataPerformance"},...e],t)}function F(e){S([{key:s.W0.EventType,value:"InsertRecommendationsDashboard"},{key:s.W0.IsSuccessful,value:e.isSuccessful},{key:s.W0.FailureReason,value:e.failureReason},{key:s.W0.FailureLocation,value:l.lA[e.failureLocation]},{key:s.W0.RecommendationData,value:JSON.stringify(e.recommendationData)}],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}const _=()=>e=>t=>{const a=t.type;try{e(t)}catch(e){throw d.M.getInstance().logErrorCode(i.O.ReducerException,e,c.S.AnalyzeDataError,s.$b.Warning,{key:s.un.Source,value:a}),e}};function N(){S([{key:s.W0.EventType,value:"FlightingSuccess"}],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function k(e,t,a,n,o,i,l,c){S([{key:s.W0.EventType,value:"LoadDataWithChunking"},{key:s.W0.Type,value:e},{key:s.W0.Duration,value:t},{key:s.W0.NumRows,value:a},{key:s.W0.NumColumns,value:n},{key:s.W0.IsSuccessful,value:o},{key:s.W0.NumChunks,value:i},{key:s.W0.NumSyncs,value:l},{key:s.W0.MinRowsInChunk,value:c}],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function O(e,t,a){S([{key:s.W0.EventType,value:"LoadFormulaData"},{key:s.W0.Duration,value:e},{key:s.W0.NumRows,value:t},{key:s.W0.NumColumns,value:a}],g(r.o.DiagnosticLevel.NecessaryServiceDataEvent,r.o.SamplingPolicy.CriticalBusinessImpact))}function P(e){const t=[{key:s.W0.EventType,value:"EvaluateQuery"},{key:s.W0.ResponseType,value:e.responseType}],a=e.visualAnswer?.at(0)?.visual?.visualType;a&&t.push({key:s.W0.VisualType,value:a}),e.reasonForError&&t.push({key:s.W0.ReasonForError,value:e.reasonForError}),e.queryType&&t.push({key:s.W0.QueryType,value:e.queryType}),S(t,g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}function M(e){S([{key:s.W0.InvalidInsightsSessionSource,value:e},{key:s.W0.IsInvalidInsightsSession,value:!0}],g(r.o.DiagnosticLevel.RequiredServiceData,r.o.SamplingPolicy.CriticalBusinessImpact))}},63395:(e,t,a)=>{async function n(e,t){const a=performance.now();try{return await e}finally{if(t){t(performance.now()-a)}}}a.d(t,{H:()=>n,q:()=>o});class o{getName(e){return this.prefix?`${this.prefix}:${e}`:e}start(e){const t=this.getName(e);this.parent?this.parent.start(t):this.measures.set(t,{startTime:performance.now(),duration:NaN})}end(e){const t=this.getName(e);if(this.parent)this.parent.end(t);else{const e=this.measures.get(t);e&&(e.duration=performance.now()-e.startTime)}}getAll(){return Object.fromEntries(this.measures.entries())}async measure(e,t){this.start(e);try{return await t}finally{this.end(e)}}withPrefix(e){return new o(e,this)}constructor(e="",t=null){this.prefix=e,this.parent=t,this.measures=new Map}}},58242:(e,t,a)=>{var n;a.d(t,{$Y:()=>m,AW:()=>l,XK:()=>i,dd:()=>n,m4:()=>d,z:()=>u}),function(e){e.Top="top",e.Bottom="bottom",e.Left="left",e.Right="right",e.None="none"}(n||(n={}));const o=16384,r=1048576;function i(e){const t=c(e);return`${`${u(t.left)}${t.top}`}:${`${u(t.right)}${t.bottom}`}`}function l(e){const t=e.split(":");if(1===t.length){const t=s(e);if(0===t.row||0===t.column)throw new Error(0===t.row?"wrong cell address format with no row value":"wrong cell address format with no column value");return{left:t.column,top:t.row,right:t.column,bottom:t.row}}const a=s(t[0]),n=s(t[1]);if(0===a.column!=(0===n.column))throw new Error("wrong range address format with column value missing");if(0===a.row!=(0===n.row))throw new Error("wrong range address format with row value missing");if(a.column*n.column==0&&a.row*n.row==0)throw new Error("wrong range address format with row & column value missing");return 0===a.column&&0===n.column?{left:1,top:a.row,right:o,bottom:n.row}:0===a.row&&0===n.row?{left:a.column,top:1,right:n.column,bottom:r}:{left:a.column,top:a.row,right:n.column,bottom:n.row}}function s(e){if(e.length<1)throw new Error("Empty cell address error");let t=0,a=0;for(let n=0;n<e.length;n++)e[n]>="A"&&e[n]<="Z"?t=26*t+(e[n].charCodeAt(0)-"A".charCodeAt(0))+1:a=10*a+Number(e[n]);return{row:a,column:t}}function c(e){let t=e;return e.left<=e.right&&e.top<=e.bottom?e:(e.left>e.right&&(t={...t,left:e.right,right:e.left}),e.top>e.bottom&&(t={...t,top:e.bottom,bottom:e.top}),t)}function d(e,t,a){const n=c(e);switch(t){case"left":n.left-=a,n.right-=a;break;case"right":n.left+=a,n.right+=a;break;case"top":n.top-=a,n.bottom-=a;break;case"bottom":n.top+=a,n.bottom+=a}return n.left===n.right&&n.top===n.bottom?`${u(n.left)}${n.top}`:`${u(n.left)}${n.top}:${u(n.right)}${n.bottom}`}function u(e){if(e<1)throw new Error("wrong excel column index");const t=[];let a=e;for(;0!==a;)a--,t.push(String.fromCharCode(a%26+"A".charCodeAt(0))),a=Math.floor(a/26);return t.reverse().join("")}function m(e){return s(e).column}},9019:(e,t,a)=>{a.d(t,{BG:()=>o,LS:()=>r,do:()=>n});const n=5;function o(e,t,a,o,r){if(r&&r.length>0)return function(e,t,a,o){const r={headerRow:e,columnLetters:t,columnHeaders:a,rows:[]},l=o[0].length,s=i(o,n);r.rows=s.map((e=>({row:e[0].row,values:i(e,l).map((e=>e.value))}))),o.length>s.length&&r.rows.splice(-1,1,{row:"...",values:Array(l).fill("...")});return r}(e,t,a,r);const l={headerRow:e,columnLetters:t,columnHeaders:a,rows:[]},s=o[0].length,c=i(o,n);return l.rows=c.map(((t,a)=>({row:e+1+a,values:i(t,s)}))),o.length>c.length&&l.rows.splice(-2,2,{row:"...",values:Array(s).fill("...")},{row:e+o.length,values:o[o.length-1]}),l}function r(e,t,[a],o){const r={headerRow:e,columnLetters:t,columnHeaders:o[0],rows:[],headerPreviewValue:a.at(-1)},l=o.slice(1),s=a.length,c=i(l,n-1);return r.rows=c.map(((t,a)=>({row:e+1+a,values:i(t,s)}))),l.length>c.length&&r.rows.splice(-1,1,{row:"...",values:Array(s).fill("...")}),r.rows.push({row:e+l.length+1,values:a}),r}function i(e,t){return e.slice(0,t)}},54285:(e,t,a)=>{a.d(t,{Ne:()=>m,O4:()=>d,UN:()=>u,YE:()=>g,cQ:()=>s,k8:()=>l});var n=a(80519),o=a(50347),r=a(85105),i=a(18700);function l(e){return Boolean(e&&!e.isPivotTable&&e.tableName&&e.sheetName&&e.address&&(!(0,o.yw)("OfficeVSO_9227364_SheetIdInValidTableSelectionContext")||e.sheetId))}function s(e,t){if((0,o.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)){const{dataAI:{tableName:a},selection:n}=t,o=a[e];return o?n.selectionContexts[o]:void 0}const a=c(e,t);return a?.context}function c(e,t){const{dataAI:{tableName:a},selection:{selectionContexts_DEPRECATED:n}}=t,o=a[e];return o?n[o]:void 0}function d(e,t,a){if(!function(){if((0,o.yw)("OfficeVSO_9245799_blockMacGridPreviewByClientVersion")){if((0,o.yw)("OfficeVSO_9275381_refactorBuildVersionCheckV2"))return(0,o.w0)(["Mac:89.802"],!0);if(Office.context.platform===Office.PlatformType.Mac)try{const[e,t]=(0,o.qS)();return e>89||89===e&&t>=802}catch(e){return!1}return!0}return!(0,o.Te)("Microsoft.Office.Excel.FA000000124.disableGridPreview",["Mac"]).includes(Office.PlatformType[Office.context.platform])}())return!1;if(!(0,r.CU)(t))return!1;if((0,n.iM)(t)&&u(t))return!1;const i=c(e,a),d=(0,o.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?s(e,a):i?.context;if(!d||!l(d))return!1;const m=a.dataAI.tableName[e];if(!m)return!1;const g=a.selection.dataSourceApis[m];return!!((0,o.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?a.selection.selectionContexts:g)}function u(e){return e.calculatedFormulas.some((e=>void 0!==e.insertionIndex))}function m(e){if(0===e.length)return[];const t=[];let a=[];return e.forEach(((n,o)=>{0===o||n-e[o-1]==1?a.push(n):(t.push(a),a=[n])})),t.push(a),t}function g(e,t){let a=(0,n.JM)(e);e.insertRowTitle&&(a=[0,...a]);const o=a.map((e=>t.map((t=>t[e]??""))));return(0,i.mg)(o)}},85105:(e,t,a)=>{a.d(t,{CU:()=>h,GC:()=>f,LM:()=>s,QI:()=>m,VV:()=>c,_c:()=>b,ch:()=>g,fB:()=>d,gD:()=>u,s6:()=>p});var n=a(80519),o=a(66036),r=a(59384),i=a(50347),l=a(58242);function s(e,t){let a="",n=t;for(;n>0;){const e=n%26;0===e?(a+="Z",n=Math.floor(n/26)-1):(a=String.fromCharCode(e-1+"A".charCodeAt(0))+a,n=Math.floor(n/26))}return`${a}${e}`}const c=(e,t)=>{const a="TextAnalysisVisual"===e?.visual?.visualType&&!!e?.visual?.textAnalysisResult?.bulletList,n=(0,i.iP)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1);return a&&!n||!u(e,t)},d=e=>"TextAnalysisVisual"!==e?.visual?.visualType||!e?.visual?.textAnalysisResult?.bulletList,u=(e,t)=>t?.find((({id:t})=>t===e.interpretationId));function m(e){const t=o.P.getNumberFormatCache();return t.addNumberFormatPropertiesToCache([r.tN]),e.data.formatLocalRows.forEach((e=>e.forEach((e=>t.addFormat(e))))),t.ensureFormats()}const g=e=>{switch(e.visualType){case"PivotTableVisual":return e.pivotTable.pivotTableData&&0===e.pivotTable.pivotTableData.length;case"QueryResultVisual":return 0===e.result.fields.length||0===e.result.fields[0].values.raw.length;default:return!1}};function h(e){return e.calculatedFormulas.every((e=>e.formula))}function p(e,{columnIndex:t}){return(0,n.JM)(e).map((e=>(0,l.z)(t+e+1)))}function b(e,t){return(0,n.iM)(e)?f(e,t):(0,n.cY)(e)?p(e,t):[]}function f(e,{columnCount:t,columnIndex:a}){return e.calculatedFormulas.map(((e,n)=>{const o=(e.insertionIndex??t)+1+n;return(0,l.z)(a+o)}))}},33532:(e,t,a)=>{function n(e,t){let a;const n=new Promise(((e,n)=>{a=window.setTimeout((()=>{n(new Error("timeout"))}),t)}));return Promise.race([(async()=>{try{return await e}finally{clearTimeout(a)}})(),n])}function o(e,t){return e.every((e=>e.suggestionType===t))}a.d(t,{K:()=>o,j:()=>n})},62982:(e,t,a)=>{a.d(t,{Fl:()=>r,OY:()=>c,ub:()=>d});var n=a(92779),o=a(59384);function r(e,t,a){if(t)return"...";const n=Number.parseFloat(e.toPrecision(9));return-1===a?n.toString():n.toFixed(a)}function i(e,t){let a;return a="number"!=typeof e||t?e?.value?.toString()||"":r(e,!1,-1),a}function l(e){return e?n.xe2.NoValueAnswerTextForNLInsight:n.xe2.NoValueAnswerTextForIdeas}function s(e,t){const a=e=>"|"+e.join("|")+"|\n";let n="";for(let t=0;t<e.length;t++)n+=a(e[t]);n+=a(e[0].map((e=>"---")));for(let e=0;e<t.length;e++)n+=a(t[e]);return n}function c(e){const{pivotTableData:t,grandTotalRowIndex:a,subTotalRowIndices:n}=e;if(t&&0===t.length)return l(!1);const r=(0,o.HF)(e),c=t[0].map(((e,a)=>t.map((e=>e[a]))));return s(c.slice(0,r).map((e=>e.map((e=>i(e,!0))))),(()=>{const e=[],t=c.slice(r,a);for(let a=0;a<t.length;a++){if(!!n&&n.length>0&&n.some((e=>e===a+r)))continue;const o=t[a].map((e=>i(e,!1)));e.push(o)}return e})())}function d(e){if(0===e.fields.length)return l(!0);if(0===e.fields[0].values.raw.length)return l(!1);const t=[e.fieldHeaders.map((e=>i({value:e.runs.map((e=>e.text)).join(""),isNumber:!1,indent:0},!0)))],a=e.fields[0].values.raw.length,n=[];for(let t=0;t<a;t++){const a=[];for(let n=0;n<e.fields.length;n++){const o=e.fields[n].values;if(o.formattedValues){const e=o.formattedValues[t];a.push(i(e,!1))}else{const e=o.strings[t],n=o.raw[t],r={value:e||n,isNumber:!1,indent:0};a.push(i(r,!1))}}n.push(a)}return s(t,n)}},55683:(e,t,a)=>{a.d(t,{Ff:()=>S,f1:()=>y,mF:()=>x});var n=a(28087),o=a(27982),r=a(72483),i=a(61437),l=a(88179),s=a(50108),c=a(92779),d=a(31030),u=a(48314),m=a(77303),g=a(6925),h=a(70364),p=a(20106),b=a(59367),f=a(47807),C=a(40910);const y=()=>async(e,t)=>{(0,h.TA)(),t().app.doesFluxTurnRequireUndo&&((0,h.tN)(),e(x.resetDoesFluxTurnRequireUndo()),i.Z.getInstance().setShowUndoButton(!1))},v={tokenState:"NotStarted",doesFluxTurnRequireUndo:!1,augloopModelWorkflowUnsupported:!1,userType:m.utd.Unknown,clientInfo:(0,b.z)(),localeInfo:(0,s.FZ)()},T=(0,p.Z0)({name:"app",initialState:v,reducers:{loadAuth(e){e.tokenState="Loaded"},fetchTokenSuccess(e){e.tokenState="Cached"},fetchTokenFailed(e){e.tokenState="Error"},setDoesFluxTurnRequireUndo:e=>{e.doesFluxTurnRequireUndo=!0},resetDoesFluxTurnRequireUndo:e=>{e.doesFluxTurnRequireUndo=!1},setLocaleInfo:(e,t)=>{e.localeInfo=t.payload.localeInfo},setUserType:(e,t)=>{e.userType=t.payload},setAugloopModelWorkflowUnsupported:e=>{e.augloopModelWorkflowUnsupported=!0},setClientInfo:(e,t)=>{e.clientInfo=t.payload}}}),x={getLocaleInfo:()=>(e,t)=>t().app.localeInfo,getToken:(e=()=>()=>{})=>async(t,a)=>{const i=performance.now();try{if("NotStarted"===a().app.tokenState)try{await(0,f.Nd)(),t(x.loadAuth())}catch{return void t(x.fetchTokenFailed())}if("Loaded"!==a().app.tokenState&&"Cached"!==a().app.tokenState)return;try{let i;if(Office.context.platform===Office.PlatformType.OfficeOnline&&(i=await(0,f.EH)(),i))return t(x.fetchTokenSuccess()),u.M.getInstance().logEvent({eventType:d.S.AuthSuccess,eventData:[{key:"FetchType",value:"OAuthManager"}]}),i;if(i=await(0,f.js)(),i)return t(x.fetchTokenSuccess()),u.M.getInstance().logEvent({eventType:d.S.AuthSuccess,eventData:[{key:"FetchType",value:"Silent"}]}),i;const s=e(),{executingCommand:m,executingId:h}=a().chat;let p;const b=new Promise((e=>{p=e})),C=c.xe2.ShowPopupMessage,[y,v]=C.split("{0}");return r.$.getInstance().displayResponse({chatCardType:n._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:"chat",warningPrefix:y,warningEmphasizedText:c.xe2.ShowPopupButton,warningSuffix:v}},chatMessageBodyData:{actionButtonList:[{type:o.jA.Default,text:c.xe2.ShowPopupButton,title:c.xe2.ShowPopupButton,handleButtonOnClick:()=>{t(g.mF.startExecutingCommand({command:m??l.OP.AnalyzeData,id:h})),p((0,f.IN)())}}]}},{featureName:l.q.AnalyzeData,eventType:l.a5.PromptAuthPopup}),i=await b,i?(s(),t(x.fetchTokenSuccess()),u.M.getInstance().logEvent({eventType:d.S.AuthSuccess,eventData:[{key:"FetchType",value:"Popup"}]}),i):void 0}catch{return void t(x.fetchTokenFailed())}}finally{(0,C.NQ)("GetToken",performance.now()-i)}},tryBackoutUndo:y,...T.actions},{reducer:S}=T},6925:(e,t,a)=>{a.d(t,{mF:()=>ee,Ff:()=>te,$U:()=>K,Nl:()=>j});var n=a(92779),o=a(82729),r=a(72483),i=a(64598),l=a(20057),s=a(10748),c=a(80519),d=a(40700),u=a(88179),m=a(43811),g=a(62646),h=a(45283),p=a(66888),b=a(26115),f=a(74840),C=a(96854),y=a(31030),v=a(48314),T=a(67603),x=a(53299),S=a(23247),w=a(8947),E=a(4475),R=a(33292),I=a(72842),A=a(41102),L=a(34874),F=a(71362),_=a(58632),N=a(98483);async function k(e,t){let a="DECLINE";const o=w.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,i=t?.key;try{if(i){const t=await o.getQueryScript();switch(e(ee.startExecutingAndLockContext(u.OP.ExitDataShapingMode)),i){case"replace":a="ACCEPT",await async function(e,t){const a=await(0,A.qD)(),n=(0,N.A)(),o=e(ee.getDataShapingState()),r=o.started?o.tableName:"",i=new b.g0({parentPath:["Signal",x.Cm.getTypeName()],items:[{id:n,body:new x.Cm({requestId:n,tableId:r,queryScript:t})}]}),l=await(0,_.T)(i,a,n,y.S.DataShaping,u.OP.DataShaping,S.D.getTypeName());if(!l?.success)throw new Error(`Failed to retrieve table update plan. ${l?.errorMessage}`);return await(0,R.UO)(l),l}(e,t);break;case"newSheet":await(0,L.r)(t,"NewQuery"),a="ACCEPT";break;case"discard":break;default:(0,I.x)(i)}e(ee.stopExecutingAndReleaseContextLock())}}catch(e){const{message:t,telemetry:a}=F.n.getDataShapingErrorResponse((0,n.qmi)());r.$.getInstance().displayResponse(e.message||t,a)}await o.endPreview(a),e(ee.exitDataShapingMode()),e(ee.exitSingleMode());const{message:l,telemetry:s}=F.n.getExitModeResponse(i);r.$.getInstance().displayResponse(l,s)}var O=a(33532),P=a(23147),M=a(20106),D=a(98100),$=a(91259),B=a(50347),H=a(99701),U=a(95674),q=a(38924),V=a(55683);const G={isExecuting:!1,showLoadingUI:!1,loadingStrings:(0,n.ZYo)(!0),currentNLResult:void 0,currentNLResultVisualIndex:0,isCurrentNLResultValid:!1,currentRecos:void 0,currentRecoIndex:0,suggestionList:[],executionStartTime:void 0,executingCommand:void 0,executingId:void 0,latestRequestId:void 0,lastUserPrompt:void 0,fillablePromptList:void 0,recentlyShownPrompts:[],nextSuggestionTypePriorities:[],isSkillResponseRequired:!1,zeroQueryTimeout:void 0,fluxExecutionStartTime:void 0,isDarkModeEnabled:!1,zqmOrPillQueryIds:[],isInsertingFormulaSuggestion:!1,isPythonStartAnalysisButtonDisabled:!1,dataShapingState:{started:!1},singleModeState:{feature:"off"},zqmSuggestionList:[],lastPythonQueryId:void 0},W=v.M.getInstance(),z=C.E.getInstance(),Q=(e,t="")=>{const a=(e().selection.suggestions[t]??[]).map((e=>({suggestionText:e,suggestionType:f.hC.AnalyzeData_SpecificSuggestion})));if((0,B.yw)("OfficeVSO_8967624_ShowLLMRelatedQuestions")){const t=J(e);a.push(...t)}const o=e().chat.latestRequestId,r=o&&e().dataAI.recommendations[o]||[],i=[],l=new Set;r.forEach((e=>{(0,c.iM)(e)&&e.calculatedFormulas.forEach((e=>{l.has(e.columnName.toLocaleLowerCase())||(l.add(e.columnName.toLocaleLowerCase()),i.push({suggestionText:(0,$.L)((0,n.ZKU)(),e.columnName),suggestionType:f.hC.CalculatedColumns_SpecificSuggestion}))}))}));const{fillablePromptList:s}=e().chat,d=[...s??[],...a,...i];return(0,D.R3)(d)},J=e=>{const t=e().chat.currentNLResult?.relatedQuestions;if(t){return t.map((t=>({suggestionText:t.query.tokens.map((e=>e.token.text)).join(""),suggestionType:f.hC.AnalyzeData_RelatedQuestions,suggestionLanguage:e().chat.currentNLResult?.outputLanguage})))}return[]},j=()=>async e=>{e(ee.setRecentlyShownPrompts([])),e(ee.setSuggestionListDetails({suggestionList:(0,m.XX)(),nextSuggestionTypePriorities:[]}))},Y=e=>async(t,a)=>{const o=a().chat.isCurrentNLResultValid,r={suggestionList:[],nextSuggestionTypePriorities:[f.hC.AnalyzeData_SpecificSuggestion]};if(e){if(e.visualAnswer?.length>1&&o){const e=`${(0,n.G5z)()[1]}`;r.suggestionList=[{suggestionText:(0,n.G5z)()[0],suggestionType:f.hC.AnalyzeData_ShowMore},{suggestionText:e,suggestionType:f.hC.AnalyzeData_InsertAll}]}else if(e.visualAnswer?.length>1)r.suggestionList=[{suggestionText:(0,n.Tr2)(),suggestionType:f.hC.AnalyzeData_Suggestion}];else if(e.relatedQuestions&&e.relatedQuestions.length>0){const t=e.relatedQuestions.map((e=>e.query.tokens.map((e=>e.token.text)).join("")));if((0,B.yw)("OfficeVSO_8967624_ShowLLMRelatedQuestions")){const e=t.slice(0,m.xP).map((e=>({suggestionText:e,suggestionType:f.hC.AnalyzeData_RelatedQuestions})));r.suggestionList=e,r.nextSuggestionTypePriorities=[f.hC.AnalyzeData_RelatedQuestions]}else{const e=t.map((e=>({suggestionText:e,suggestionType:f.hC.AnalyzeData_Suggestion})));r.suggestionList=e,r.nextSuggestionTypePriorities=[]}}else{if(e.responseType===g.WZ.Answered)return void t(ee.showSuggestionListWithPriorities([f.hC.AnalyzeData_SpecificSuggestion]));r.suggestionList=[{suggestionText:(0,n.Dvy)(),suggestionType:f.hC.AnalyzeData_Suggestion}]}r.suggestionList.forEach((t=>{t.suggestionLanguage=e.outputLanguage})),t(ee.setSuggestionListDetails(r))}else t(ee.showZeroStateSuggestionList())},X=(e,t,a,n)=>{C.E.getInstance().logLatency((0,u.xJ)(t),e,a,n)},K=(e,t)=>async()=>{r.$.getInstance().setIsSkillResponseRequired(!1);const a=e===p.Aw.success||(0,B.yw)("OfficeVSO_9448880_UserCancelCreditDeduction")&&e===p.Aw.cancelled,n=new i.DE({queryId:v.M.userQueryGuid,status:e,message:a?t:void 0,error:a?void 0:t}),o=new b.g0({parentPath:["Signal",i.DE.getTypeName()],items:[{id:h.r.generateId(),body:n}]});if((0,D.cY)("Sending ExcelCopilotProgramResponseSignal to AL"),(0,B.yw)("OfficeVSO_9261508_shouldIgnoreUserResponse"))r.$.getInstance().submitOperation({operation:o,workflowAnnotationType:l.Yn.getTypeName()});else{(await(0,A.qD)()).submitOperation(o,void 0)}},Z=(0,M.Z0)({name:"chat",initialState:G,reducers:{startExecutingCommand:(e,t)=>{let a;e.executionStartTime&&e.executingCommand&&(e.executingCommand===u.OP.FluxReasoning&&t.payload.command!==u.OP.FluxReasoning&&t.payload.command!==u.OP.Search||W.logError({eventType:y.S.Latency,errorMessage:`Command ${e.executingCommand} was not stopped before starting ${t.payload.command}`,logLevel:u.$b.Warning}),X(e.executingCommand,e.executionStartTime)),e.executingCommand=t.payload.command,e.executionStartTime=(new Date).getTime(),e.executingId=t.payload.id;const o=P.CP.getActiveTable();switch((0,B.qm)()&&o&&(a=(0,U.r)(o.address)),t.payload.command){case u.OP.AnalyzeData:e.loadingStrings=a?(0,n.uo4)().map((e=>e.replace("{0}",a))):(0,n.zZj)();break;case u.OP.InsertAnalyzeData:e.loadingStrings=(0,n.SUe)();break;case u.OP.CalculatedColumns:e.loadingStrings=a?(0,n.BaS)().map((e=>e.replace("{0}",a))):(0,n.wvg)();break;case u.OP.CalculatedCells:e.loadingStrings=a?(0,n.tJt)().map((e=>e.replace("{0}",a))):(0,n._lL)();break;case u.OP.InsertCalculatedColumn:e.loadingStrings=(0,n.M_1)();break;case u.OP.InsertCalculatedColumns:e.loadingStrings=(0,n.tZV)();break;case u.OP.InsertCalculatedCell:{const t=P.CP.calculatedFormulaInsertLocation??"",a=n.xe2.LoadingUIAddingCellWithAddressStep,o=n.xe2.CalculatedRowsCellHeader;e.loadingStrings=[a.replace("{0}",o).replace("{cellAddress}",t)];break}case u.OP.InsertCalculatedCells:{const t=P.CP.calculatedFormulaInsertLocation??"",a=n.xe2.LoadingUIAddingCellsWithAddressStep,o=n.xe2.CalculatedRowsRowHeader;e.loadingStrings=[a.replace("{0}",o).replace("{rowNumber}",t)];break}case u.OP.UpdateCalculatedCell:{const t=P.CP.calculatedFormulaInsertLocation??"",a=n.xe2.LoadingUIAddingCellUpdateWithAddressStep,o=n.xe2.CalculatedRowsCellHeader;e.loadingStrings=[a.replace("{0}",o).replace("{cellAddress}",t)];break}case u.OP.UpdateCalculatedCells:{const t=P.CP.calculatedFormulaInsertLocation??"",a=n.xe2.LoadingUIAddingCellsUpdateWithAddressStep,o=n.xe2.CalculatedRowsRowHeader;e.loadingStrings=[a.replace("{0}",o).replace("{rowNumber}",t)];break}case u.OP.ApplyDataShaping:e.loadingStrings=(0,n.znb)();break;case u.OP.ApplyTLRAutoFix:case u.OP.Commanding:{const t=P.CP.getHumanInTheLoopRange();(0,B.k6)()&&t?e.loadingStrings=(0,n.xJ7)().map((e=>e.replace("{range}",t))):e.loadingStrings=a&&o?.tableLikeRange?(0,n._9M)().map((e=>e.replace("{0}",a))):(0,B.ge)()?(0,n._73)():(0,n.XQw)();break}case u.OP.FluxGenerateResponse:e.loadingStrings=(0,n.De1)();break;case u.OP.SaveOfficeScripts:e.loadingStrings=n.UOv;break;case u.OP.CreateOfficeScripts:e.loadingStrings=n.XFR;break;case u.OP.PythonStartAnalysis:e.loadingStrings=(0,n.EwU)();break;case u.OP.EnterDataShapingMode:e.loadingStrings=(0,n.CcC)();break;case u.OP.ExitDataShapingMode:e.loadingStrings=(0,n.aRL)();break;case u.OP.ImportDataLoadQuery:e.loadingStrings=(0,n.w$T)();break;case u.OP.ImportDataRelevancyCheck:e.loadingStrings=(0,n.NLG)();break;case u.OP.ImportDataGenerateSuggestion:e.loadingStrings=(0,n.zDx)();break;case u.OP.PythonInsertingResultInNewSheet:e.loadingStrings=(0,n.Huq)();break;case u.OP.FluxReasoning:case u.OP.ActionAI:case u.OP.Search:default:(0,B.qm)()&&a?e.loadingStrings=(0,n.w7p)().map((e=>e.replace("{0}",a))):e.loadingStrings=(0,n.ZYo)()}e.isExecuting=!0,e.showLoadingUI=!0,r.$.getInstance().startLoadingUi()},stopExecuting:(e,t)=>{e.executionStartTime&&X(e.executingCommand??u.OP.NoCurrentlyExecutingCommandSet,e.executionStartTime,t.payload?.isSuccess),e.isExecuting=!1,(0,B.yw)("OfficeVSO_9564929_DisabledStartAAButtonBugFix")?e.showLoadingUI&&!t.payload?.keepShowingLoadingUIIfAlreadyActive&&(e.showLoadingUI=!1):e.showLoadingUI=t.payload?.keepShowingLoadingUIIfAlreadyActive??!1,e.executingCommand=void 0,e.executionStartTime=void 0,e.executingId=void 0,e.zeroQueryTimeout&&(window.clearTimeout(e.zeroQueryTimeout),e.zeroQueryTimeout=void 0)},startInsertingFormulaSuggestion:e=>{e.isInsertingFormulaSuggestion=!0},stopInsertingFormulaSuggestion:e=>{e.isInsertingFormulaSuggestion=!1},appliedChangesOnWorkbook:(e,t)=>{if((0,B._b)()){(0,D.cY)("ODSL scenario success, updating document sensitivity");const e=o.n.getInstance().getInDocSensitiveLabelInfo(),t=o.n.getInstance().upgradeSensitivityLabelUsingOfcJs(e);z?.updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.DocumentClpUpgrade,[u.h3.ChatEventParameters]:"result: "+t},W)}},hideLoadingUI:e=>{!0===e.showLoadingUI&&r.$.getInstance().stopLoadingUi(),e.showLoadingUI=!1},setSuggestionListDetails:(e,t)=>{P.CP.pythonContextManager.isPythonMode&&!t.payload.isPythonSuggestion||(e.suggestionList=t.payload.suggestionList,e.nextSuggestionTypePriorities=t.payload.nextSuggestionTypePriorities??[],e.recentlyShownPrompts=[...e.recentlyShownPrompts,...t.payload.suggestionList.map((e=>e.suggestionText))])},setZqmSuggestionList:e=>{e.zqmSuggestionList=(0,D.R3)(Object.keys(T.w_).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,q._2)(t)))).slice(0,3)},setNextSuggestionTypePriorities:(e,t)=>{e.nextSuggestionTypePriorities=t.payload},setRecentlyShownPrompts:(e,t)=>{e.recentlyShownPrompts=t.payload},clearSuggestionList:e=>{e.suggestionList=[]},setCurrentNLResultInvalid:e=>{e.isCurrentNLResultValid=!1},setLoadingStrings:(e,t)=>{e.loadingStrings=t.payload},incrementCurrentNLResultVisualIndex:e=>{e.currentNLResultVisualIndex++,e.currentNLResult?.visualAnswer&&e.currentNLResultVisualIndex+1>=e.currentNLResult.visualAnswer.length&&(e.suggestionList=[e.suggestionList[1]])},updateCurrentNLResult:(e,t)=>{e.isCurrentNLResultValid=t.payload.isCurrentNLResultValid,e.currentNLResult=t.payload.currentNLResult,e.currentNLResultVisualIndex=t.payload.currentNLResultVisualIndex},updateCurrentRecos:(e,t)=>{e.currentRecos=t.payload,e.currentRecoIndex=0},incrementRecoIndex:e=>{e.currentRecoIndex++},removeFirstSuggestionPill:e=>{e.suggestionList.length>0&&(e.suggestionList=e.suggestionList.slice(1))},setLatestRequestId:(e,t)=>{e.latestRequestId=t.payload},setZeroQueryTimeout:(e,t)=>{e.zeroQueryTimeout=t.payload},initializeSuggestionList:e=>{e.fillablePromptList=(0,m.zH)()},setIsDarkModeEnabled:(e,t)=>{e.isDarkModeEnabled=t.payload},setPythonStartAnalysisButtonDisabled:(e,t)=>{e.isPythonStartAnalysisButtonDisabled=t.payload},addZqmOrPillQueryId:(e,t)=>{e.zqmOrPillQueryIds=[...e.zqmOrPillQueryIds,t.payload]},enterDataShapingMode:(e,t)=>{e.dataShapingState={started:!0,disableQueryScriptUpdates:!1,...t.payload}},exitDataShapingMode:e=>{e.dataShapingState={started:!1}},enterSingleMode:(e,t)=>{e.singleModeState=t.payload},exitSingleMode:e=>{e.singleModeState={feature:"off"}},updateDataShapingQueryScript:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.queryScript=t.payload},setDisableQueryScriptUpdates:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.disableQueryScriptUpdates=t.payload},startNewPythonQuery:e=>{e.lastPythonQueryId=(0,N.A)()}}}),ee={...Z.actions,showMoreInsights:(e,t)=>async(a,o)=>{const{currentNLResult:i,currentNLResultVisualIndex:l}=o().chat,{activeRequestId:s}=o().selection;if(!i)return;const c=!1===i.fullyUnderstoodRewrittenQuery?(0,n.bUh)():(0,n.YTh)(),d=i.visualAnswer[l+1],u=(0,D.Yd)(d.visual.visualType)??"visual",m=c.replace("{0}",u),{message:g,telemetry:h}=F.n.getAnalyzeDataRecommendationResponse({visual:d,requestId:s[e],responseText:m,tableName:e,tableContext:t});r.$.getInstance().displayResponse(g,h);const b=(0,H.t)(d,m,i.textAnswer?.tokens.map((e=>e.text)).join(""));a(ee.sendSkillResponseToFlux(b,p.Aw.success,h)),a(ee.incrementCurrentNLResultVisualIndex())},startExecutingAndLockContext:(e,t)=>async a=>{P.CP.lockContextRefresh(e),a(ee.startExecutingCommand({command:e,id:t}))},stopExecutingAndReleaseContextLock:(e,t)=>async a=>{(0,d.z)()&&await d.g.getInstance().removeGridFoil(),(0,B.yw)("OfficeVSO_9490274_awaitStopBeforeSendingSkllResponseForPython")?((0,B.yw)("OfficeVSO_9537624_hideLoadingUIAfterReleaseContextLock")&&await P.CP.releaseContextLock(),t||a(ee.hideLoadingUI()),(0,B.yw)("OfficeVSO_9537624_hideLoadingUIAfterReleaseContextLock")||await P.CP.releaseContextLock(),a(ee.stopExecuting({isSuccess:e,keepShowingLoadingUIIfAlreadyActive:t}))):(a(ee.hideLoadingUI()),await P.CP.releaseContextLock(),a(ee.stopExecuting({isSuccess:e})))},showSuggestionListCore:()=>async(e,t)=>{const a=P.CP.getActiveTable(),{nextSuggestionTypePriorities:n,recentlyShownPrompts:o}=t().chat,r=Q(t,a?.name);let i={suggestionList:[]};if(n.length>0){const e=r.filter((e=>n.includes(e.suggestionType)));i=(0,m.g4)(a,e,o)}0===i.suggestionList.length&&(i=(0,m.g4)(a,r,o)),i.shouldResetRecentPrompts&&e(ee.setRecentlyShownPrompts([])),e(ee.setSuggestionListDetails({...i,nextSuggestionTypePriorities:[]}))},showZeroStateSuggestionList:j,showMorePrompts:()=>async(e,t)=>{z?.updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.SuggestionPaneSuggestionClicked,[u.h3.ChatEventParameters]:f.hC.MorePrompts},W),(0,B.yw)("OfficeVSO_8967624_ShowLLMRelatedQuestions")&&(0,O.K)(t().chat.suggestionList,f.hC.AnalyzeData_RelatedQuestions)?e(ee.showSuggestionListWithPriorities([f.hC.AnalyzeData_RelatedQuestions])):e(ee.showSuggestionListCore())},showCalculatedColumnsSuggestionList:(e,t,a,o=1)=>async r=>{const i=[{suggestionText:a===c.VS.Column?t?(0,n.wzr)():(0,n._1n)():(0,n.jcG)(),suggestionType:f.hC.CalculatedColumns_ShowMore,calculatedFormulaSuggestionMessage:{requestId:e,requestIndex:o}}];r(ee.setSuggestionListDetails({suggestionList:i,nextSuggestionTypePriorities:[f.hC.CalculatedColumns_SpecificSuggestion]}))},showSuggestionListWithPriorities:(e=[])=>async t=>{t(ee.setNextSuggestionTypePriorities(e)),t(ee.showSuggestionListCore())},setCurrentNLResult:e=>async t=>{e.discoverInsights?.length>0&&(e.visualAnswer=e.discoverInsights,e.responseType=g.WZ.Answered,e.answerForDiscoverInsights&&(e.textAnswer=e.answerForDiscoverInsights)),e.visualAnswer?.length>6&&(e.visualAnswer=e.visualAnswer.slice(0,6)),t(ee.updateCurrentNLResult({isCurrentNLResultValid:!0,currentNLResult:e,currentNLResultVisualIndex:0})),t(Y(e))},showPythonDynamicSuggestionList:e=>async t=>{const a=e.slice(0,2).map((e=>({suggestionText:e,suggestionType:f.hC.PythonSuggestion})));t(ee.setSuggestionListDetails({suggestionList:a,nextSuggestionTypePriorities:[f.hC.PythonSuggestion],isPythonSuggestion:!0}))},showAnalyzeDataSuggestionList:Y,invalidateCurrentNLResult:()=>async(e,t)=>{e(ee.setCurrentNLResultInvalid());const{currentNLResult:a}=t().chat;e(ee.showAnalyzeDataSuggestionList(a))},getExecutingCommand:()=>async(e,t)=>t().chat.executingCommand,sendSkillResponseToFlux:(e,t,a,o=!0,i=!0)=>async l=>{if(!r.$.getInstance().getIsSkillResponseRequired())return;s.Q.getInstance().recordFluxCopilotStep({operation:u.OP.FluxSkillEnd,featureName:a.featureName}),e||(e=t===p.Aw.success?(0,n.Twc)():(0,n._h7)()),await l(K(t,e));const c=t===p.Aw.success;c||await l((0,V.f1)()),i&&((0,B.yw)("OfficeVSO_9537624_hideLoadingUIAfterReleaseContextLock")?l(ee.stopExecuting({isSuccess:c,keepShowingLoadingUIIfAlreadyActive:o})):l(ee.stopExecuting({isSuccess:c})),o&&l(ee.startExecutingCommand({command:u.OP.FluxGenerateResponse,id:v.M.userQueryGuid})))},showMoreRecommendations:(e,t)=>async(a,n)=>{const{currentRecos:o,currentRecoIndex:i,suggestionList:l}=n().chat,{activeRequestId:s}=n().selection;if(!o)return;const c=i+1,d=o[c],{message:u,telemetry:m}=F.n.getAnalyzeDataRecommendationResponse({visual:d,requestId:s[e],responseText:"",tableName:e,tableContext:t});r.$.getInstance().displayResponse(u,m),c===o.length-1&&(l.length<=1?a(j()):a(ee.removeFirstSuggestionPill())),a(ee.incrementRecoIndex())},setCurrentRecos:(e,t)=>async a=>{const o=e.length>6?e.slice(0,6):e;a(ee.updateCurrentRecos(o)),a(((e,t)=>async a=>{if(e.length<=1)a(ee.showZeroStateSuggestionList());else if("ChartReco"===t){const e=`${(0,n.G5z)()[1]}`;a(ee.setSuggestionListDetails({suggestionList:[{suggestionText:(0,n.YXQ)(),suggestionType:f.hC.AnalyzeData_ShowMoreCharts},{suggestionText:e,suggestionType:f.hC.AnalyzeData_InsertAllCharts}]}))}else a(ee.setSuggestionListDetails({suggestionList:[{suggestionText:(0,n.Q40)(),suggestionType:f.hC.AnalyzeData_ShowMorePivotTables}]}))})(o,t))},setZqmOrPillQueryId:e=>async t=>{t(ee.addZqmOrPillQueryId(e))},getInsertingFormulaSuggestion:()=>async(e,t)=>t().chat.isInsertingFormulaSuggestion,showUnsupportedTLRSuggestionListIfNeeded:e=>async(t,a)=>{let n=(0,m.$c)(e);n&&0!==n.length&&(n=n.concat(a().chat.suggestionList),t(ee.setSuggestionListDetails({suggestionList:n})))},showMoreZQMPrompts:()=>async e=>{e(ee.setZqmSuggestionList())},getDataShapingState:()=>(e,t)=>t().chat.dataShapingState,startDataShaping:e=>async t=>{await async function(e,t){const a=w.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;try{e(ee.startExecutingAndLockContext(u.OP.EnterDataShapingMode)),await a.startPreview(t.queryName,t.mashupDocument,t.tableName),a.onQueryScriptChanged.subscribe((t=>{const a=e(ee.getDataShapingState());a.started&&!a.disableQueryScriptUpdates&&a.queryScript!==t&&(e(ee.updateDataShapingQueryScript(t)),(0,E.s_)(E.H0.DisableUndo))})),e(ee.enterDataShapingMode(t)),e(ee.enterSingleMode({feature:"dataShaping",caption:(0,n.Bdz)(),exitMenuOptions:[{key:"replace",text:(0,n.bCm)()},{key:"newSheet",text:(0,n.SpP)()},{key:"discard",text:(0,n.Bms)()}]})),e(ee.stopExecutingAndReleaseContextLock()),e(ee.setLatestRequestId(t.requestId)),F.n.displayDataShapingIntroResponse(e,t.requestId)}catch(t){await a.endPreview("ERROR"),e(ee.stopExecutingAndReleaseContextLock()),e(ee.exitDataShapingMode()),e(ee.exitSingleMode());const{message:o,telemetry:i}=F.n.getDataShapingErrorResponse((0,n.A99)());r.$.getInstance().displayResponse(t.message||o,i)}}(t,e)},endDataShaping:e=>async t=>{await k(t,e)},addDataShapingSteps:e=>async t=>{await async function(e,t){e(ee.setDisableQueryScriptUpdates(!0)),await w.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.appendSteps(t);const a=await w.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.getQueryScript();e(ee.updateDataShapingQueryScript(a)),e(ee.setDisableQueryScriptUpdates(!1))}(t,e)},undoDataShapingSteps:e=>async t=>{await async function(e,t){try{for(const e of t.reverse())await w.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.removeStep(e.name)}catch(e){v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:`IDataShapingPrivateSdxApiService.removeStep failed with error ${e}`,logLevel:u.$b.Warning})}}(0,e)},singleModeExitOptionSelected:e=>async(t,a)=>{const{feature:n}=a().chat.singleModeState;switch(n){case"off":throw new Error("Single mode is not enabled");case"python":throw new Error("Python single mode is not supported yet");case"dataShaping":t(ee.endDataShaping(e));break;default:(0,I.x)(n)}t(ee.exitSingleMode())},getLastPythonRequestId:()=>(e,t)=>t().chat.lastPythonQueryId},{reducer:te}=Z},24180:(e,t,a)=>{a.d(t,{m:()=>Te,F:()=>xe});var n=a(92779),o=a(89099),r=a(24220),i=a(37197),l=a(93022),s=a(22551),c=a(80519),d=a(61150);class u{addCleanupFunctions(e,...t){this.cleanupFunctionsByKey.has(e)?this.cleanupFunctionsByKey.get(e).push(...t):this.cleanupFunctionsByKey.set(e,t)}isTracking(e){return this.cleanupFunctionsByKey.has(e)}stopTracking(e){(0,d.cY)("BaseEventsTracker: stopTracking",e),this.cleanupFunctionsByKey.get(e)?.forEach((e=>e.remove())),this.cleanupFunctionsByKey.delete(e)}constructor(){this.cleanupFunctionsByKey=new Map}}var m=a(72483),g=a(81364),h=a(64216),p=a(88179),b=a(54285),f=a(78640),C=a(96854),y=a(31030),v=a(48314),T=a(6925),x=a(88099),S=a(50347),w=a(46919),E=a(33540),R=a(35893);function I(e,t){return e.filter((e=>!t.includes(e)))}async function A(e){return e.context.load(e.columns,"items/name"),await e.context.sync(),e.columns.items.map((e=>e.name))}async function L(e,t,a){const{referencedColumns:n}=await(0,w.s)(a,e.map((e=>e.nonLocalizedFormula??e.formula)),new Map);for(const e of t)if(n.includes(e))return!0;return!1}var F=a(66888),_=a(79029),N=a(74840),k=a(90922),O=a(23343),P=a(55683),M=a(23147),D=a(9019),$=a(20106),B=a(98925),H=a(91259),U=a(18700),q=a(85105),V=a(58242),G=a(8338),W=a(98100),z=a(67329);const Q="en-US",J=(e,t,a)=>e?(0,c.iM)(e)?Y(e,t,a):(0,c.cY)(e)?j(e,t,a):"":JSON.stringify({publishPreference:G.f.Never}),j=(e,t,a)=>{let o;const r=t().dataAI.tableName[a];if(r){const a=t().selection.selectionContexts_DEPRECATED[r];((0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?t().selection.selectionContexts[r]:a)&&(o=(0,q.s6)(e,(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?t().selection.selectionContexts[r]:a.context))}const i=e.calculatedFormulas.map((e=>e.title??"")),l=e.calculatedFormulas.map((e=>e.formula));let s;return s=(0,W.hU)(e)?o?.[0]?(0,W.VY)(n.qbK.Rows.SingleFormulaRecommendation,{title:i[0],formula:l[0],location:o[0]}):(0,W.VY)(n.qbK.Rows.SingleFormulaRecommendationWithNoLocation,{title:i[0],formula:l[0]}):o?(0,W.VY)(n.qbK.Rows.MultipleFormulaRecommendation,{titles:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q),columnLocations:(0,z.q)(o,Q)}):(0,W.VY)(n.qbK.Rows.MultipleFormulaRecommendationWithNoLocation,{titles:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q)}),JSON.stringify({text:s,formulas:l,titles:i,location:o,publishPreference:G.f.Never})},Y=(e,t,a)=>{let o;const r=t().dataAI.tableName[a];if(r){const a=t().selection.selectionContexts_DEPRECATED[r];((0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?t().selection.selectionContexts[r]:a)&&(o=(0,q.GC)(e,(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?t().selection.selectionContexts[r]:a.context))}const i=e.calculatedFormulas.map((e=>e.columnName)),l=e.calculatedFormulas.map((e=>e.formula));let s;return s=(0,W.hU)(e)?o?.[0]?(0,W.VY)(n.qbK.Columns.SingleColumnRecommendation,{columnName:i[0]??"",formula:l[0]??"",columnLocation:o[0]}):(0,W.VY)(n.qbK.Columns.SingleColumnRecommendationWithNoLocation,{columnName:i[0]??"",formula:l[0]??""}):o?(0,W.VY)(n.qbK.Columns.MultipleColumnsRecommendation,{columnNames:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q),columnLocations:(0,z.q)(o,Q)}):(0,W.VY)(n.qbK.Columns.MultipleColumnsRecommendationWithNoLocation,{columnNames:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q)}),JSON.stringify({text:s,formula:l,columnName:i,locations:o,publishPreference:G.f.Never})};var X=a(59726);var K=a(55143),Z=a(71362),ee=a(40910);function te(e,t,a){return(0,ee.T0)("GetIsCellsEmptyInTotalRow",(()=>async function(e,t,a){try{const{sheetName:a}=t;if(!a)throw new Error("getIsCellsEmpty: sheetName is undefined");return await async function(e,t,a){return Excel.run((async n=>{const{rowCount:o,rowIndex:r,columnIndex:i,columnCount:l}=e,{range:s,columnOffset:c}=function(e,t,a,n,o,r,i){const l=i.workbook.worksheets.getItem(o);if(1===r.length)return{range:l.getRangeByIndexes(a+e,n+r[0],1,1),columnOffset:r[0]};if(r.every(((e,t,a)=>0===t||e===a[t-1]+1)))return{range:l.getRangeByIndexes(a+e,n+r[0],1,r.length),columnOffset:r[0]};return{range:l.getRangeByIndexes(a+e,n,1,t),columnOffset:0}}(o,l,r,i,t,[...new Set(a.flat())].sort(((e,t)=>e-t)),n);return s.load("valueTypes"),await n.sync(),a.map((e=>e.map((e=>s.valueTypes[0][e-c]===Excel.RangeValueType.empty)).every((e=>e))))}))}(t,a,e)}catch(e){return void v.M.getInstance().logErrorCode(g.O.CalculatedCellsGetIsTotalRowCellsEmptyFailed,e,y.S.FormulaGeneration,p.$b.Warning,{key:p.un.SuggestionID,value:a})}}(e,t,a)),a)}var ae=a(72763);const ne="success",oe={recommendations:{},fetchRecommendationsState:{},searchText:{},tableName:{},isVisible:{},previewId:null,activeRequestId:null,activeRequestType:null,currentShownSuggestionIndex:{},hasShownSuggestionPrompt:{},rawPreview:{},visibleRowPreviewValues:{},currentTotalRowValues:{},invalidatedSuggestions:[],shouldShowFormulaDevButton:!1},re=(e,t,i,l,s)=>async(d,u)=>{let m=ne;try{if("inProgress"===u().dataAI.fetchRecommendationsState[e])return m="inProgress",Promise.resolve();const h=u().dataAI.tableName[e];if(!h)return m="noTableName",void ye(e,d);let b;if(l===c.Yw.NLToFormula&&(b=u().dataAI.searchText[e],!b))return m="noQuery",void ye(e,d);d(Te.startFetching(e)),d(T.mF.startExecutingCommand({command:t,id:e})),d(Te.setActiveRequestType(l));const x=u().app.augloopModelWorkflowUnsupported,{selectionContexts_DEPRECATED:w,localeCacheDeprecated:E,dataSourceApis:R}=u().selection;let I=u().selection.selectionContexts;const A=(0,S.yw)("OfficeVSO_9408436_SmallDataSourceApi")?await d(f.mF.getDataSourceApiIfNeeded(h,e)):R[h];(0,S.yw)("OfficeVSO_9610128_fixFailureToSendFormulaGenerationSignal")&&(I=u().selection.selectionContexts);const L=!x&&(0,S.rb)();if(!((0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?I:w)[h]||!A&&!L)return m="noTableData",void ye(e,d);const F=O.R.getFormulaAITimeout();window.setTimeout((()=>{if("inProgress"===u().dataAI.fetchRecommendationsState[e]){ye(e,d,n.xe2.CalculatedColumnsFailureGeneral,p.q0.AugloopTimeout),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.Response_Delayed_Or_Timed_Out,o.c.Calculate_Suggestion_Timeout,p.BJ.FormulaGeneration);const t=`Timeout on SDX after waiting ${F} seconds for calculated column suggestions from AL`;v.M.getInstance().logErrorCode(g.O.ShowSuggestionsTimeout,(0,p.Jr)(t),y.S.FormulaGeneration,p.$b.Warning,{key:p.un.Message,value:t})}}),F),Promise.all([a.e("vendors~calc"),a.e("calc")]).then(a.bind(a,93961));const _=u().chat.zqmOrPillQueryIds.includes(e);let N=[];return(0,S._m)()&&(N=function(e,t){if(!(0,S.yw)("OfficeVSO_9506002_DedupeTablesInExcelIntelligenceContext"))return e;const a=new Set,n=[...e].reverse().filter((e=>{const t=function(e){return e.tableName?e.tableName:[e.sheetName||e.range.worksheetId,e.range.top,e.range.left,e.range.bottom,e.range.right].join("|")}(e);return!a.has(t)&&(a.add(t),!0)}));return n.length===e.length?e:(C.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.FormulaSuggestionDedupedContextTables,[p.h3.ChatEventParameters]:JSON.stringify({requestId:t,before:e.length,after:n.length})},v.M.getInstance()),n.reverse())}(u().selection.excelRecognizedTablesAnnotationsCache,e)),await(0,c.uq)((0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?I[h]:w[h].context,(0,S.Lr)()?d(P.mF.getLocaleInfo()):E,A,e,i,x,_,b,s,N)}catch(t){(0,S.yw)("OfficeVSO_9348331_errorLogForFetchOperationV2")&&(m=t),ye(e,d)}finally{(0,S.yw)("OfficeVSO_9348331_errorLogForFetchOperationV2")&&m!==ne&&(v.M.getInstance().logErrorCode(g.O.FormulaGenerationCreateFetchOperationFailed,(0,p.Jr)(m),y.S.FormulaGeneration,p.$b.Error,{key:"operation",value:t}),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Formula_Generation_Failed_To_Send_Signal,p.BJ.FormulaGeneration))}},ie=async(e,t,a,n,o)=>{const r=(0,b.cQ)(o,t());if((0,S.yw)("OfficeVSO_9301082_showCurrentRowValuesOnGridPreview")&&r){let a;const{showTotals:n}=r;a=n?t().dataAI.currentTotalRowValues[o]??await(0,ee.T0)("GetCurrentRowValues",(()=>(0,c.jI)(r)),o):void 0,e(Te.setCurrentRowValuesForRequestId({requestId:o,currentTotalRowValues:a}))}e(Te.setPreviewForSuggestionID({suggestionId:a,preview:[n],visibleRowsPreview:[]}))},le=async(e,t,a)=>{if((0,S.yw)("OfficeVSO_9145863_allowReplacementOfExistingValueInCellsSuggestion")&&t?.success&&t?.result&&(0,c.$k)(t.result)){const n=e().dataAI.recommendations[a];if(-1===n.findIndex((e=>t.result.some((t=>t.id===e.id))))){const n=await me(e,t.result,a);t.result.forEach(((e,t)=>{e.allowReplacementOfExistingValue=n[t]}));const o=await ge(e,t.result,a);t.result.forEach(((e,t)=>{e.insertRowTitle=o[t]})),(0,S.yw)("OfficeVSO_9588604_ColumnAggregationHeaderPreview")&&t.result.forEach((e=>{e.isSingleFormula=(0,W.XZ)(e)})),C.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.CalculatedRowsSuggestionsReceived,[p.h3.ChatEventParameters]:JSON.stringify({isUpdateSuggestion:n})},v.M.getInstance())}else t.result.forEach((e=>{const t=n.find((t=>t.id===e.id));t&&(e.insertRowTitle=t.insertRowTitle)}))}},se=async(e,t,a,i,l)=>{if(a.success){if(a.result){if(!(0,c.L$)(a.result)&&!(0,c.$k)(a.result))return;e(Te.fetchRecommendationsSucceeded({requestId:i,recommendation:a.result}));const[n]=a.result,o=t().dataAI.recommendations[i].find((e=>e.id===n.id));if(o&&void 0===o.preview&&e(Te.setFormulaRecommendationPreviewOnCard(i,n)),!t().dataAI.isVisible[i]){e(Te.markVisible(i));const[o]=a.result;(0,S.Jh)()&&(0,ee.T0)("FormulaSuggestionInvalidatorTrack",(()=>ue.track(i,(0,b.cQ)(i,t()),o,((t,a)=>{e(Te.markRecommendationAsInvalidated({reason:t,suggestionId:a}))}))),i,o.id);const{message:r,telemetry:l}=Z.n.getFormulaSuggestionResponse(i,0,a.result);m.$.getInstance().displayResponse(r,l);const s=J(o,t,i);e(T.mF.sendSkillResponseToFlux(s,F.Aw.success,l)),v.M.getInstance().logEvent((0,p.SV)(p.he.SuggestionShown,(0,c.$k)(a.result)?p.q.CalculatedRows:p.q.CalculatedColumns,p.KZ.NLChatRequest,n.id))}ce(e,t,i)}}else{e(Te.fetchRecommendationsFailed(i));const d=t().dataAI.recommendations[i].length;if(!d){const d=t().chat.zqmOrPillQueryIds.includes(i);let u=d?n.xe2.ServerErrorWithNoRetrySuggestionPill:n.xe2.ServerErrorWithNoRetry,g=p.q0.ServiceError,b=r.W.Unable_To_Complete_Task,f=o.c.Service_Error_Unknown_Error;const C=a.suggestionMetadata.shouldFallbackToElse;switch((0,S.yw)("OfficeVSO_9339984_addFormulaDevButtonToElse")&&C&&h.s.getInstance().setLastFormulaRequestDebugInfo(a.debugInfo),a.suggestionMetadata.result){case s.sR.NoSuggestion:g=p.q0.NoSuggestions,d?(b=r.W.Unable_To_Complete_Task,f=o.c.Failed_Column_Suggestion_Generation_For_Suggestion_Pill):(u=l===c.Yw.NLToFormula?n.xe2.CalculatedColumnsNLNoResults:n.xe2.CalculatedColumnsGeneralNoResults,b=r.W.User_Input_Could_Not_Be_Processed,f=o.c.Failed_Column_Suggestion_Generation_For_User_Prompt);break;case s.sR.UserThrottled:b=r.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,f=o.c.LLM_Throttled,u=(0,n.UDz)(),g=p.q0.UserThrottled;break;case s.sR.MultipleFormulas:b=r.W.Missing_Copilot_Functionality,f=a.suggestionType===c.VS.Cell?o.c.Formula_Generation_Unsupported_Multiple_Rows:o.c.Formula_Generation_Unsupported_Multiple_Columns,d||(u=n.xe2.CalculatedRowsNLMultipleRows),g=p.q0.NotSingleColumn;break;case s.sR.HarmfulContent:b=r.W.Responsible_AI_Filter_Blocked_Response,f=o.c.Suggestion_Blocked_Due_To_RAI,g=p.q0.RaiError;break;case s.sR.IrrelevantQuery:b=r.W.Missing_Copilot_Functionality,f=o.c.Calculated_Column_Out_Of_Scope_Scenarios,g=p.q0.IrrelevantQuery;break;case s.sR.LlmGeneralErrorFailure:b=r.W.LLM_Service_Side_Issue_Prevents_Output,f=o.c.Service_Error_Augloop,g=p.q0.LLMServiceError}let y,x;C||v.M.getInstance().logStandardizedAshaErrorEvent(b,f,p.BJ.FormulaGeneration);const w=void 0,E=t().app.augloopModelWorkflowUnsupported;switch(l){case c.Yw.NLToFormula:{let e;switch(a.suggestionMetadata.result){case s.sR.MultipleFormulas:e=void 0;break;case s.sR.UserThrottled:e=(0,n.yUb)(E).map((e=>({text:e})));break;default:e=d?void 0:(0,n.yUb)(E).map((e=>({text:e})))}({message:y,telemetry:x}=Z.n.getFormulaSuggestionErrorResponse(u,{shouldShowFormulaDevButton:t().dataAI.shouldShowFormulaDevButton,debugInfo:a.debugInfo},g,e));break}default:({message:y,telemetry:x}=Z.n.getFormulaSuggestionErrorResponse(u,{shouldShowFormulaDevButton:t().dataAI.shouldShowFormulaDevButton,debugInfo:a.debugInfo},g))}C||m.$.getInstance().displayResponse(y,x,w);const R=JSON.stringify({text:(0,X.N)(y),publishPreference:"Never",fallbackToElse:C}),I=!C,A=!C;e(T.mF.sendSkillResponseToFlux(R,F.Aw.failed,x,I,A))}v.M.getInstance().logErrorCode(d?g.O.ExcelIntelligenceSignalFailedWithSuggestions:g.O.ExcelIntelligenceSignalFailed,(0,p.Jr)(a.suggestionMetadata.result),y.S.FormulaGeneration,p.$b.Error)}},ce=(e,t,a)=>{if(!t().dataAI.hasShownSuggestionPrompt[a])if(t().dataAI.activeRequestId===a&&0===t().dataAI.currentShownSuggestionIndex[a]&&t().dataAI.recommendations[a].length>1){const n=t().dataAI.recommendations[a][1],o=n.requestType===c.Yw.NLToFormula&&!n.isAlternativeSuggestion;e(Te.setHasShownSuggestionPrompt(a)),e(T.mF.showCalculatedColumnsSuggestionList(a,o,n.suggestionType))}else{if(t().dataAI.activeRequestId===a&&0===t().dataAI.currentShownSuggestionIndex[a]&&(0,c.cY)(t().dataAI.recommendations[a][0]))return;e(T.mF.showSuggestionListWithPriorities([N.hC.CalculatedColumns_SpecificSuggestion]))}},de=new class extends u{track(e,t,a){if(this.isTracking(e))return void(0,d.cY)("ColumnPreviewInvalidator: already tracking",e);const{sheetId:n,sheetName:o,tableName:r}=t;if(!n||!o||!r)return void(0,d.cY)("ColumnPreviewInvalidator: invalid selection context");(0,d.cY)("ColumnPreviewInvalidator: tracking",e);const i=(t,n)=>{(0,d.cY)("ColumnPreviewInvalidator: invalidating",t,e,n),this.stopTracking(e),a()};Excel.run((async t=>{const a=t.workbook.worksheets.getItem(n),o=[a.onChanged.add((async e=>{i("sheetChanged",e)})),a.onDeactivated.add((async e=>{i("sheetDeactivated",e)}))];this.addCleanupFunctions(e,...o),await t.sync()}))}},ue=new class extends u{async track(e,t,a,n){if(this.isTracking(a.id))v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: already tracking suggestion ${a.id}`,logLevel:p.$b.Warning});else if((0,b.k8)(t)){this.saveRequestId(a.id,e),this.addCleanupFunctions(a.id,{remove:()=>this.removeRequestId(a.id,e)}),this.invalidationCallbacks.set(a.id,n),this.addCleanupFunctions(a.id,{remove:()=>this.invalidationCallbacks.delete(a.id)});try{await this.startTracking(a,t)}catch(e){v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: failed to start tracking suggestion ${a.id} with error ${e}`,logLevel:p.$b.Warning})}}else v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: track called with invalid selection context",logLevel:p.$b.Warning})}async startTracking(e,t){const{sheetId:a,tableName:n}=t;return Excel.run((async o=>{const r=o.workbook.worksheets.getItem(a).tables.getItemOrNullObject(n);r.load("isNullObject"),await o.sync(),C.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.FormulaSuggestionTrackedForInvalidation,[p.h3.ChatEventParameters]:JSON.stringify({suggestionId:e.id})},v.M.getInstance()),this.addCleanupFunctions(e.id,{remove:R.F.startListening({actionCreator:T.mF.setLatestRequestId,effect:(t,a)=>{const{latestRequestId:n}=a.getOriginalState().chat;t.payload!==n&&this.stopTracking(e.id)}})}),r.isNullObject?(0,S.yw)("OfficeVSO_9334657_TlrInvalidation")&&await this.registerTLREvents(e,t):await this.registerTableEvents(e,r),await o.sync()}))}invalidate(e,t,a=void 0){(0,d.cY)("FormulaSuggestionInvalidator: invalidating",e,t,a);const n=this.invalidationCallbacks.get(e);n&&n(t,e),this.stopTracking(e)}async registerTLREvents(e,t){this.addCleanupFunctions(e.id,{remove:R.F.startListening({actionCreator:Te.markRecommendationInserted,effect:(t,a)=>{const{requestId:n,suggestionId:o}=t.payload;if(o===e.id)return void(0,d.cY)("FormulaSuggestionInvalidator: markRecommendationInserted: suggestionId is the tracked suggestionId");const r=this.trackedSuggestionsByRequestId.get(n);(0,d.cY)("FormulaSuggestionInvalidator: markRecommendationInserted",{suggestionId:o,requestId:n,siblings:r}),r?.has(e.id)&&this.invalidate(e.id,"SiblingRecommendationInserted")}})});const{sheetId:a,address:n}=t;if(a&&n){const t=(0,E.py)(n),o=(0,x.debounce)((a=>{const n=a[t];(0,d.cY)("FormulaSuggestionInvalidator: TabularRangeChanged",{currentTable:t,sheetTables:a}),n||this.invalidate(e.id,"TabularRangeChanged",`Table ${t} not found in ${Object.keys(a)}`)}),2e3);this.addCleanupFunctions(e.id,{remove:R.F.startListening({actionCreator:f.mF.updateTableInterpretationsForSheet,effect:({payload:n},{getState:r})=>{if(n.sheetId!==a)return void(0,d.cY)("FormulaSuggestionInvalidator: updateTableInterpretationsForSheet: sheetId is different, skipping");const i=r().selection.tabularRanges;i?.[a]?(!function(e){C.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.FormulaSuggestionInvalidationTrackingData,[p.h3.ChatEventParameters]:JSON.stringify(e)},v.M.getInstance())}({sheetId:a,currentTable:t,suggestionId:e.id,type:"tabularRangesChanged",tablesInSheet:Object.keys(i[a]),tablesInPayload:Object.keys(n.newInterpretations)}),o(i[a])):v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: updateTableInterpretationsForSheet: tablesBySheet?.[sheetId] is undefined",logLevel:p.$b.Warning})}})})}else v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: registerTLREvents: selectionContext is invalid",logLevel:p.$b.Warning})}async registerTableEvents(e,t){let a=await A(t);const n=t.id,o=[t.worksheet.tables.onDeleted.add((async t=>{(0,d.cY)("FormulaSuggestionInvalidator: tableDeleted",t),t.tableId===n&&this.invalidate(e.id,"TableDeleted",t)})),t.onChanged.add((async t=>{(0,d.cY)("FormulaSuggestionInvalidator: tableChanged",t),await Excel.run((async n=>{try{const o=n.workbook.tables.getItem(t.tableId);switch(t.changeType){case Excel.DataChangeType.rangeEdited:{const r=t.getRange(n),i=o.getHeaderRowRange(),l=r.getIntersectionOrNullObject(i);l.load("isNullObject"),await n.sync();const s=await A(o);!l.isNullObject&&await async function(e,t,a,n){if(!n){const n=await L(e.calculatedFormulas,I(t,a),t);return(0,d.cY)(`shouldInvalidateOnHeaderEdit: ${n}, change is undefined (multiple cells were edited at once) tested by the removed columns`),n}if(n.valueTypeBefore===Excel.RangeValueType.empty)return(0,d.cY)("shouldInvalidateOnHeaderEdit: false because the header was empty before the change (the user is adding a new column)"),!1;if(await L(e.calculatedFormulas,[n.valueBefore],t))return(0,d.cY)("shouldInvalidateOnHeaderEdit: true because header was found in the formula"),!0;return!1}(e,a,s,t.details)&&this.invalidate(e.id,"ColumnHeaderEdited",t),a=s;break}case Excel.DataChangeType.columnInserted:a=await A(o);break;case Excel.DataChangeType.columnDeleted:{const n=await A(o),r=I(a,n);a=n,await L(e.calculatedFormulas,r,a)&&this.invalidate(e.id,"ColumnDeleted",t)}}}catch(e){v.M.getInstance().logError({eventType:y.S.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: tableChanged: ${e}`,logLevel:p.$b.Warning})}}))}))];this.addCleanupFunctions(e.id,...o)}saveRequestId(e,t){this.trackedSuggestionsByRequestId.has(t)||this.trackedSuggestionsByRequestId.set(t,new Set),this.trackedSuggestionsByRequestId.get(t).add(e)}removeRequestId(e,t){const a=this.trackedSuggestionsByRequestId.get(t);a&&(a.delete(e),0===a.size&&this.trackedSuggestionsByRequestId.delete(t))}constructor(...e){super(...e),this.invalidationCallbacks=new Map,this.trackedSuggestionsByRequestId=new Map}},me=async(e,t,a)=>{const n=performance.now();(0,d.cY)("getShouldAllowReplacementOfExistingValueInTotalRow start",a,t,n);let o=t.map((()=>!1));const r=e().dataAI.tableName[a];if(r){const n=(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?e().selection.selectionContexts[r]:e().selection.selectionContexts_DEPRECATED[r].context;if(n?.showTotals){const e=t.map((e=>e.calculatedFormulas.flatMap((e=>e.insertionIndexes??[]))));o=(await te(e,n,a)??e.map((()=>!0))).map((e=>!e))}}return(0,d.cY)("getShouldAllowReplacementOfExistingValueInTotalRow end",a,t,performance.now()-n,o),o},ge=async(e,t,a)=>{let n=t.map((()=>!1));const o=e().dataAI.tableName[a];if(o){const r=(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?e().selection.selectionContexts[o]:e().selection.selectionContexts_DEPRECATED[o].context;if(r){const e=r.showTotals;let o;const i=async()=>(void 0===o&&(o=(await te([[0]],r,a))?.[0]??!1),o),l=t.map((e=>e.calculatedFormulas.some((e=>e.insertionIndexes.includes(0)))));n=await Promise.all(l.map((async t=>!t&&(!e||await i()))))}}return n},he=async(e,t,a,n,o,r,i,l)=>{const s=(0,c.iM)(n);(0,S.Jh)()&&ue.stopTracking(n.id),e(T.mF.startInsertingFormulaSuggestion());const{message:d,telemetry:u}=Z.n.getInsertSuggestionUserChat(o);if(m.$.getInstance().displayResponse(d,u),!(0,q.CU)(n))return void Ce(e,n.debugInfo);const h=t().dataAI.tableName[a];if(!h)return void Ce(e,n.debugInfo);const b=t().selection.selectionContexts_DEPRECATED[h],C=(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?t().selection.selectionContexts[h]:b.context,x=(0,S.Lr)()?e(P.mF.getLocaleInfo()):(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?t().selection.localeCacheDeprecated:b.localeDeprecated,w=(0,S.yw)("OfficeVSO_9408436_SmallDataSourceApi")?await e(f.mF.getDataSourceApiIfNeeded(h,a)):t().selection.dataSourceApis[h];if(!C||!s&&!w)return void Ce(e,n.debugInfo);s||function(e,t){const a=t.rowIndex+t.rowCount+1,n=(0,q.s6)(e,t),o=1===n?.length?n[0]:"";M.CP.calculatedFormulaInsertLocation=`${o}${a}`}(n,C);const E=function(e){if((0,c.iM)(e))return(0,W.hU)(e)?p.OP.InsertCalculatedColumn:p.OP.InsertCalculatedColumns;return e.allowReplacementOfExistingValue?(0,W.Z)(e)?p.OP.UpdateCalculatedCell:p.OP.UpdateCalculatedCells:(0,W.Z)(e)?p.OP.InsertCalculatedCell:p.OP.InsertCalculatedCells}(n);e(T.mF.startExecutingAndLockContext(E));const R=!s&&C.hasTableHeaders?w.values[0].map((e=>String(e))):void 0;e(Te.hidePreviewOnGrid(a,n.id));try{const{insertionAddresses:o,insertionError:d}=await r(n,h,C,a,x,R);if(d){const t=!(0,W.hU)(n);if(pe(e,d,n.id,s,t,n.debugInfo),0===o.length)return void await e(T.mF.stopExecutingAndReleaseContextLock());t||v.M.getInstance().logErrorCode(g.O.CalculatedColumnInsertColumnError,(0,p.Jr)("Got insertion error but still have insertion addresses (but not for multi columns)"),y.S.FormulaGeneration,p.$b.Warning,{key:p.un.SuggestionID,value:n.id})}else if((0,S.yw)("OfficeVSO_121212_verifyValueValueMatchesPreview"))try{const{dataAI:e}=t();i(e.rawPreview[n.id],o,C,a)}catch(e){v.M.getInstance().logErrorCode(g.O.CalculatedColumnInsertColumnFailedVerifyPreview,e,y.S.FormulaGeneration,p.$b.Warning,{key:p.un.SuggestionID,value:n.id})}C.sheetId?((0,S.yw)("OfficeVSO_9343910_XlimCachingForUndo")&&e(f.mF.cacheTableInterpretationsForUndo()),e(f.mF.extendTabularRangeInterpretation(C.sheetId,h,o))):e(f.mF.hideSelectionErrorOnRange((0,K.G2)(h))),(0,S.yw)("DontSuggestSimilarAfterInsert")&&n.requestType===c.Yw.NLToFormula&&e(T.mF.showZeroStateSuggestionList()),e(Te.markRecommendationInserted({requestId:a,suggestionId:n.id}));try{e(f.mF.clearTable(h)),await e(f.mF.resolveTableLikeEntity(h,!0,a))}catch(e){v.M.getInstance().logErrorCode(g.O.CalculatedColumnsInsertColumnFailedResolveTableLikeEntity,e,y.S.FormulaGeneration,p.$b.Warning,{key:p.un.SuggestionID,value:n.id})}await e(T.mF.stopExecutingAndReleaseContextLock()),e(T.mF.appliedChangesOnWorkbook({caller:"insertColumnsRecommendation"}));const u=l(n,o,h),{message:b,telemetry:w}=Z.n.getFormulaSuggestionInsertSuccessResponse(u,n.id,(0,S.yw)("OfficeVSO_9343910_XlimCachingForUndo")?()=>e(f.mF.restoreTableInterpretationsForUndo()):()=>{});m.$.getInstance().displayResponse(b,w);const E=(0,X.N)(b);e(T.mF.sendSkillResponseToFlux(E,F.Aw.success,w)),e(T.mF.stopInsertingFormulaSuggestion()),m.$.getInstance().setInputFocus(),(0,S.BT)()?_.B.getInstance().logKeptEvent(p.BJ.FormulaGeneration,s?p.q.CalculatedColumns:p.q.CalculatedRows,k.RX.Create):v.M.getInstance().logKeptEvent(s?p.q.CalculatedColumns:p.q.CalculatedRows)}catch(t){await pe(e,t,n.id,s,!(0,W.hU)(n),n.debugInfo),await e(T.mF.stopExecutingAndReleaseContextLock())}},pe=async(e,t,a,i,l,s)=>{const c=t instanceof OfficeExtension.Error?t.code:null;let d="";"InsertDeleteConflict"===c||"PivotTableRangeConflict"===c||c===g.O.CalculatedColumnExpandFailedNotEmptyColumn?(d=i?l?(0,n.J0g)():(0,n.Goo)():(0,n.SXB)(),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range,p.BJ.FormulaGeneration)):"AccessDenied"===c?(d=i?(0,n.YbA)():(0,n.wQR)(),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Protection_Settings,p.BJ.FormulaGeneration)):"ItemNotFound"===c?(d=i?(0,n.ZX_)():(0,n.Rc5)(),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Target_Table_Error,p.BJ.FormulaGeneration)):(d=i?(0,n.u3x)():(0,n.mYV)(),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion,p.BJ.FormulaGeneration));const{message:u,telemetry:h}=Z.n.getFormulaSuggestionErrorResponse(d,{shouldShowFormulaDevButton:!0,debugInfo:s});m.$.getInstance().displayResponse(u,h);const b=JSON.stringify({text:(0,X.N)(u),publishPreference:"Never"});e(T.mF.sendSkillResponseToFlux(b,F.Aw.failed,h)),e(T.mF.stopInsertingFormulaSuggestion()),v.M.getInstance().logErrorCode(g.O.InsertCalculatedColumnFailed,t,y.S.FormulaGeneration,p.$b.Warning,{key:p.un.SuggestionID,value:a})},be=(e,t,a)=>{const o=t.map((e=>/:([A-Z]+)/.exec(e)?.[1])),r=o.every((e=>e));if(r||v.M.getInstance().logErrorCode(g.O.CalculatedColumnsInsertColumnFailedGetRange,(0,p.Jr)("Failed to get column letter"),y.S.FormulaGeneration,p.$b.Warning,{key:p.un.SuggestionID,value:e.id}),1===o.length){const t=e.calculatedFormulas[0].columnName;return r?(0,H.L)((0,n.OfU)(),t,o[0]):(0,H.L)((0,n.q_f)(),t,a)}if(o.length>3)return(0,W.VY)((0,n.xau)(),{columnLength:o.length.toString()});{const t=o.map(((t,a)=>e.calculatedFormulas[a].columnName)),i=(0,z.q)(t?.map((e=>`'${e}'`))??[]);if(r){const e=(0,z.q)(o.filter((e=>"string"==typeof e)));return(0,W.VY)((0,n.L8i)(),{columnNames:i,columnHeaders:e})}return(0,W.VY)((0,n.AKP)(),{columnNames:i,tableName:a})}},fe=(e,t,a)=>{const o=M.CP.calculatedFormulaInsertLocation??"",r="CalculatedRowsConfirmationTextForCellWithAddress",i="CalculatedRowsConfirmationTextForUpdateCellWithAddress",l="CalculatedRowsConfirmationTextForRowWithAddress",s="CalculatedRowsConfirmationTextForUpdateRowWithAddress",c="CalculatedRowsCellHeader",d="CalculatedRowsRowHeader";let u;u=(0,W.XZ)(e)?e.allowReplacementOfExistingValue?i:r:e.allowReplacementOfExistingValue?s:l;return((e,t)=>{const a=n.xe2[e],r=`**${n.xe2[t]}**`,i=t===c?"cellAddress":"rowNumber";return a.replace("{0}",r).replace(`{${i}}`,o)})(u,(0,W.Z)(e)?c:d)},Ce=(e,t)=>{const{message:a,telemetry:o}=Z.n.getFormulaSuggestionErrorResponse((0,n.u3x)(),{shouldShowFormulaDevButton:!0,debugInfo:t});m.$.getInstance().displayResponse(a,o);const r=JSON.stringify({text:(0,X.N)(a),publishPreference:"Never"});e(T.mF.sendSkillResponseToFlux(r,F.Aw.failed,o)),e(T.mF.stopInsertingFormulaSuggestion()),e(T.mF.stopExecuting())},ye=async(e,t,a,o)=>{t(Te.fetchRecommendationsFailed(e)),await t(T.mF.stopExecutingAndReleaseContextLock(!1));const{message:r,telemetry:i}=Z.n.getFormulaSuggestionErrorResponse(a??(0,n.HGr)(),{shouldShowFormulaDevButton:!1},o);m.$.getInstance().displayResponse(r,i);const l=JSON.stringify({text:(0,X.N)(r),publishPreference:"Never"});t(T.mF.sendSkillResponseToFlux(l,F.Aw.failed,i)),t(T.mF.showZeroStateSuggestionList())},ve=(0,$.Z0)({name:"dataAI",initialState:oe,reducers:{startFetching:(e,t)=>{e.recommendations[t.payload]=[],e.fetchRecommendationsState[t.payload]="inProgress",e.isVisible[t.payload]=!1,e.activeRequestId=t.payload,e.currentShownSuggestionIndex[t.payload]=0},fetchRecommendationsSucceeded:(e,t)=>{const{requestId:a,recommendation:n}=t.payload;n.forEach((t=>{const n=e.recommendations[a],o=n.findIndex((e=>e.id===t.id)),r=t.calculatedFormulas.length,i=t.id;function l(e,t){C.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:e,[p.h3.ChatEventParameters]:JSON.stringify({time:performance.now(),requestId:a,suggestionId:i,calculatedFormulaLength:r,formulaIndex:t})},v.M.getInstance())}function s(e,t,a){return a[e]&&a[e]!==t[e]}if(-1===o)n.push(t),l(p.a5.CalculatedFormulaGetFormula);else{let r=!1,i=!1;t.calculatedFormulas.forEach((e=>{const t=n[o];if(t.preview&&(i=!0),t.calculatedFormulas){const a=t.calculatedFormulas.findIndex((t=>t.id===e.id));-1!==a&&((void 0===t.calculatedFormulas[a].description&&void 0!==e.description||void 0===t.calculatedFormulas[a].formulaExplanation&&void 0!==e.formulaExplanation)&&(s("description",t.calculatedFormulas[a],e)&&l(p.a5.CalculatedFormulaGetDescription,a),s("formulaExplanation",t.calculatedFormulas[a],e)&&l(p.a5.CalculatedFormulaGetExplanation,a),t.calculatedFormulas[a]=e),r=Boolean(e.description))}}));if((0,S.yw)("OfficeVSO_8486330_chatHistoryCalculatedColumnUpdate")&&e.currentShownSuggestionIndex[a]>=o&&(r||(0,S.yw)("OfficeVSO_9236970_calculatedColumnsAllowPreviewBeforeDescription")&&i)){const{message:e,telemetry:t}=Z.n.getFormulaSuggestionResponse(a,o,(0,B.ss)(n));setTimeout((()=>{m.$.getInstance().displayResponse(e,t,{replaceExistingMessage:!0})}))}}})),e.fetchRecommendationsState[a]="succeeded"},fetchRecommendationsFailed:(e,t)=>{e.fetchRecommendationsState[t.payload]="failed"},startPreviewing:(e,t)=>{e.previewId=t.payload},stopPreviewing:e=>{e.previewId=null},clearSearchText:(e,t)=>{e.searchText[t.payload]=""},updateSearchText:(e,t)=>{e.searchText[t.payload.requestId]=t.payload.text},updateTableName:(e,t)=>{e.tableName[t.payload.requestId]=t.payload.table},updateFormulaRecommendationPreview:(e,t)=>{const{requestId:a,suggestionId:n,preview:o,visibleRowsPreviewValues:r,tableValues:i}=t.payload,l=e.recommendations[a],s=l.find((e=>e.id===n));if(s){if("Failed"===o||"previewDisabled"===o)s.preview=o;else{const{previewValues:e,rowNumber:t,letters:a}=o;(0,c.iM)(s)?s.preview=(0,D.BG)(t,a,s.calculatedFormulas.map((e=>e.columnName)),e,r):(0,c.cY)(s)&&(s.preview=(0,D.LS)(t,a,e,i))}(0,d.cY)("updateFormulaRecommendationPreview",s.preview,s.calculatedFormulas.map((e=>e.description)));const t=(0,S.yw)("OfficeVSO_9236970_calculatedColumnsAllowPreviewBeforeDescription")||s.calculatedFormulas.every((e=>e.description)),n=l.findIndex((e=>e===s)),u=e.currentShownSuggestionIndex[a]===n;if((0,S.pR)()&&t&&u){const{message:e,telemetry:t}=Z.n.getFormulaSuggestionResponse(a,n,(0,B.ss)(l));setTimeout((()=>{(0,d.cY)("updateFormulaRecommendationPreview","displayResponse",e),m.$.getInstance().displayResponse(e,t,{replaceExistingMessage:!0})}))}}},markRecommendationInserted:(e,t)=>{const{suggestionId:a,requestId:n}=t.payload,o=e.recommendations[n].findIndex((e=>e.id===a));-1!==o&&(e.recommendations[n][o].isInserted=!0)},markRecommendationAsInvalidated:(e,t)=>{const{suggestionId:a,reason:n}=t.payload;e.invalidatedSuggestions.push(a),C.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.FormulaSuggestionInvalidated,[p.h3.ChatEventParameters]:JSON.stringify({reason:n,suggestionId:a})},v.M.getInstance())},reset:()=>oe,markVisible:(e,t)=>{e.isVisible[t.payload]=!0},setCurrentShownSuggestionIndex:(e,t)=>{e.currentShownSuggestionIndex[t.payload.requestId]=t.payload.suggestionIndex},setActiveRequestType:(e,t)=>{e.activeRequestType=t.payload},setHasShownSuggestionPrompt:(e,t)=>{e.hasShownSuggestionPrompt[t.payload]=!0},setPreviewForSuggestionID:(e,t)=>{const{preview:a,suggestionId:n,visibleRowsPreview:o}=t.payload;e.rawPreview[n]=a,e.visibleRowPreviewValues[n]=o},setCurrentRowValuesForRequestId:(e,t)=>{const{requestId:a,currentTotalRowValues:n}=t.payload;e.currentTotalRowValues[a]=n},setShouldShowFormulaDevButton:(e,t)=>{const{shouldShowFormulaDevButton:a}=t.payload;e.shouldShowFormulaDevButton=a,(0,S.yw)("OfficeVSO_9339984_addFormulaDevButtonToElse")&&h.s.getInstance().setShouldShowFormulaDevButton(a)}}}),Te={onFormulaSuggestionAnnotationReceived:(e,t=c.VS.Column)=>async(a,o)=>{const r=o(),i=r.dataAI.activeRequestId;if(i&&"failed"===r.dataAI.fetchRecommendationsState[i]||i!==e.requestId)return;if((0,S.cT)()){const t=e.telemetry;t?.metrics&&t.metrics.length>0&&a(ae.m.addQueryMetrics({queryId:e.requestId,metrics:t.metrics}))}const s=r.dataAI.activeRequestType;if(i&&null!==s){if(l.lL.typeGuard(e)||l.Dv.typeGuard(e)){const t=(0,c.aG)(e.requestId,e.suggestionId);l.lL.typeGuard(e)&&e.previewValues&&e.previewValuesForVisibleRows?a(Te.setPreviewForSuggestionID({suggestionId:t,preview:(0,U.mg)(e.previewValues),visibleRowsPreview:(0,U.mg)(e.previewValuesForVisibleRows)})):l.Dv.typeGuard(e)&&e.previewValues?ie(a,o,t,e.previewValues,i):r.app.augloopModelWorkflowUnsupported&&void 0===r.dataAI.rawPreview[t]&&Te.setPreviewForSuggestionID({suggestionId:t,preview:[],visibleRowsPreview:[]})}const n=(0,c.mZ)(e,i,s,t);await le(o,n,i),await se(a,o,n,i,s)}else{const{message:t,telemetry:o}=Z.n.getFormulaSuggestionErrorResponse((0,n.HGr)(),{shouldShowFormulaDevButton:r.dataAI.shouldShowFormulaDevButton,debugInfo:e.debugInfo});m.$.getInstance().displayResponse(t,o);const i=JSON.stringify({text:(0,X.N)(t),publishPreference:"Never"});a(T.mF.sendSkillResponseToFlux(i,F.Aw.failed,o))}},fetchColumnRecommendations:(e,t,a)=>re(e,p.OP.CalculatedColumns,i.az.ColumnSuggestion,t,a),fetchCellRecommendations:(e,t,a)=>re(e,p.OP.CalculatedCells,i.az.CellSuggestion,t,a),showPreviewOnGrid:(e,t,a={hidePreviewOnChange:!1,moveViewportToPreview:!1})=>async(n,i)=>{if(i().dataAI.previewId!==t.id&&(0,b.O4)(e,t,i()))try{const o=(0,b.cQ)(e,i());if(!o||!(0,b.k8)(o))return;null!=i().dataAI.previewId&&await(0,c.hK)(o.sheetName),n(Te.startPreviewing(t.id));const r=async r=>{if(!(0,c.iM)(t))throw Error("showPreviewColumn called with non-column recommendation");i().dataAI.previewId===t.id&&(await(0,ee.T0)("ShowPreviewColumn",(()=>(0,c.gA)(t.calculatedFormulas.map((e=>e.columnName)),o,r,(async()=>{(0,d.cY)("showPreviewColumn.previewDismissed"),de.stopTracking(t.id),n(Te.stopPreviewing())}),a.moveViewportToPreview)),e,t.id),a.hidePreviewOnChange&&de.track(t.id,o,(()=>{n(Te.hidePreviewOnGrid(e,t.id))})),null===i().dataAI.previewId&&o.sheetName&&await(0,c.hK)(o.sheetName))},l=async r=>{if(!(0,c.cY)(t))throw Error("showPreviewRow called with non-cell recommendation");if(i().dataAI.previewId===t.id){const l=(0,c.JM)(t);await(0,ee.T0)("showPreviewRow",(()=>(0,c.wr)(o,(0,U.XR)(r,l,t.insertRowTitle,i().dataAI.currentTotalRowValues[e]),t.insertRowTitle?0:l?.[0],(async()=>{(0,d.cY)("showPreviewRow.previewDismissed"),de.stopTracking(t.id),n(Te.stopPreviewing())}),a.moveViewportToPreview)),e,t.id),a.hidePreviewOnChange&&de.track(t.id,o,(()=>{n(Te.hidePreviewOnGrid(e,t.id))})),null===i().dataAI.previewId&&o.sheetName&&await(0,c.hK)(o.sheetName)}},s=(0,c.cY)(t)?l:r,u=i().dataAI.rawPreview[t.id];u?s(u):R.F.startListening({actionCreator:Te.setPreviewForSuggestionID,effect:(e,a)=>{a.unsubscribe();const n=a.getState().dataAI.rawPreview[t.id];n&&s(n)}})}catch(e){v.M.getInstance().logErrorCode(g.O.ShowPreviewColumnFailed,e,y.S.FormulaGeneration,p.$b.ASHA,{key:p.un.SuggestionID,value:t.id}),v.M.getInstance().logStandardizedAshaErrorEvent(r.W.UI_Failed_To_Update_Or_Load,o.c.Preview_On_Grid_Failed_To_Display,p.BJ.FormulaGeneration),n(Te.stopPreviewing())}},hidePreviewOnGrid:(e,t)=>async(a,n)=>{if(de.stopTracking(t),null==n().dataAI.previewId)return;const o=(0,b.cQ)(e,n());if(o&&(0,b.k8)(o))try{a(Te.stopPreviewing());const{sheetName:n}=o;await(0,ee.T0)("HidePreviewColumn",(()=>(0,c.hK)(n)),e,t)}catch(e){v.M.getInstance().logErrorCode(g.O.HidePreviewColumnFailed,e,y.S.FormulaGeneration,p.$b.ASHA,{key:p.un.SuggestionID,value:t})}},togglePreviewOnGrid:(e,t,a)=>async(n,o)=>{const{previewId:r}=o().dataAI;r===t.id?n(Te.hidePreviewOnGrid(e,r)):n(Te.showPreviewOnGrid(e,t,a))},insertColumnsRecommendation:(e,t)=>async(a,o)=>{v.M.getInstance().logEvent((0,p.SV)(p.he.SuggestionApplied,p.q.CalculatedColumns,p.KZ.AddButton,t.id));const r=(0,W.hU)(t)?(0,n.aVz)():(0,n.BqH)();he(a,o,e,t,r,c.xw,c.Fw,be)},insertCellsRecommendation:(e,t)=>async(a,o)=>{v.M.getInstance().logEvent((0,p.SV)(p.he.SuggestionApplied,p.q.CalculatedRows,p.KZ.AddButton,t.id));const r=(0,W.Z)(t)?t.allowReplacementOfExistingValue?(0,n.KeO)():(0,n.E$x)():t.allowReplacementOfExistingValue?(0,n.ooE)():(0,n.EWN)();he(a,o,e,t,r,c.fJ,c.jL,fe)},setFormulaRecommendationPreviewOnCard:(e,t)=>async(a,o)=>{const r=(0,c.iM)(t);if(!t||!(0,q.CU)(t))return;const i=o().dataAI.tableName[e];if(!i)return;const l=o().selection.selectionContexts_DEPRECATED[i];if(!((0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?o().selection.selectionContexts[i]:l))return;const s=(0,S.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?o().selection.selectionContexts[i]:l.context,d=(0,S.yw)("OfficeVSO_9408436_SmallDataSourceApi")?await a(f.mF.getDataSourceApiIfNeeded(i,e)):o().selection.dataSourceApis[i];d&&(0,b.k8)(s)&&void 0!==o().dataAI.rawPreview[t.id]&&setTimeout((async()=>{try{const i=o().dataAI.rawPreview[t.id],l=o().dataAI.visibleRowPreviewValues[t.id],u=0===i.length||(0,S.yw)("OfficeVSO_9314905_fixEmptyPreviewResultsCheck")&&0===i[0].length;if(u&&(!l||0===l.length)||!r&&u)throw new Error("No preview values");const m=s.rowIndex+1;let g=(0,q._c)(t,s);const h=(0,c.cY)(t)?(0,b.YE)(t,d.texts):[];let p=i;t.insertRowTitle&&i.some((e=>e.length>0))&&(p=[[n.xe2.CalculatedRowsFormulaTotalHeader,...i[0]],...i.slice(1)],g=[(0,V.z)(s.columnIndex+1),...g]),a(Te.updateFormulaRecommendationPreview({formulaSuggestionType:t.suggestionType,requestId:e,suggestionId:t.id,visibleRowsPreviewValues:l,preview:{previewValues:p,rowNumber:m,letters:g},tableValues:h}))}catch(n){a(Te.updateFormulaRecommendationPreview({formulaSuggestionType:t.suggestionType,requestId:e,suggestionId:t.id,preview:"Failed",visibleRowsPreviewValues:[],tableValues:[]})),v.M.getInstance().logErrorCode(g.O.SetFormulaPreviewFailed,n,y.S.FormulaGeneration,p.$b.ASHA,{key:p.un.SuggestionID,value:t.id})}}),0)},handleCalculatedFormulaShowMore:(e,t)=>async(a,n)=>{const{recommendations:o}=n().dataAI,r=o[e],i=r[t];(0,S.Jh)()&&(0,ee.T0)("FormulaSuggestionInvalidatorTrack",(()=>ue.track(e,(0,b.cQ)(e,n()),i,((e,t)=>{a(Te.markRecommendationAsInvalidated({reason:e,suggestionId:t}))}))),e,i.id);const{message:l,telemetry:s}=Z.n.getFormulaSuggestionResponse(e,t,r);m.$.getInstance().displayResponse(l,s);const d=J(i,n,e);if(a(T.mF.sendSkillResponseToFlux(d,F.Aw.success,s)),a(Te.setFormulaRecommendationPreviewOnCard(e,o[e][t])),v.M.getInstance().logEvent((0,p.SV)(p.he.SuggestionShown,(0,c.cY)(i)?p.q.CalculatedRows:p.q.CalculatedColumns,p.KZ.FormulaGenerationSuggestionPill,o[e][t].id)),a(Te.setCurrentShownSuggestionIndex({requestId:e,suggestionIndex:t})),t+1<o[e].length){const n=o[e][t+1],r=n.requestType===c.Yw.NLToFormula&&!n.isAlternativeSuggestion;a(T.mF.showCalculatedColumnsSuggestionList(e,r,n.suggestionType,t+1))}else a(T.mF.showSuggestionListWithPriorities([N.hC.CalculatedColumns_SpecificSuggestion]))},...ve.actions},{reducer:xe}=ve},43811:(e,t,a)=>{a.d(t,{$c:()=>v,XX:()=>h,g4:()=>C,xP:()=>g,zH:()=>p});var n,o=a(92779),r=a(88179),i=a(74840),l=a(82623),s=a(31030),c=a(48314),d=a(33532),u=a(50347),m=a(50108);!function(e){e.Number="Number",e.String="String",e.Any="Any"}(n||(n={}));const g=2,h=()=>[{suggestionText:(0,o.Dvy)(!0),suggestionType:i.hC.AnalyzeData_Suggestion,alwaysInList:!0},{suggestionText:(0,o.qjK)(!0),suggestionType:i.hC.CalculatedColumns_GeneralSuggestion,alwaysInList:!0},{suggestionText:(0,o.I77)(!0),suggestionType:i.hC.ConditionalFormat_Suggestion,alwaysInList:!0}],p=()=>[{suggestionText:(0,o.jmZ)(),suggestionType:i.hC.AnalyzeData_SpecificSuggestion},{suggestionText:(0,o.lkD)(),suggestionType:i.hC.CalculatedColumns_SpecificSuggestion,numColsRequired:2,requiredColsType:"Number"},{suggestionText:(0,o.gZd)(),suggestionType:i.hC.Commanding_Suggestion},{suggestionText:(0,o.gax)(),suggestionType:i.hC.AnalyzeData_SpecificSuggestion,numColsRequired:1,requiredColsType:"String"},{suggestionText:(0,o.hzZ)(),suggestionType:i.hC.CalculatedColumns_SpecificSuggestion,numColsRequired:2,requiredColsType:"String"},{suggestionText:(0,o.dYE)(),suggestionType:i.hC.Commanding_Suggestion,numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.EZu)(),suggestionType:i.hC.Commanding_Suggestion,numColsRequired:1,requiredColsType:"Any"},{suggestionText:(0,o.JEr)(),suggestionType:i.hC.Commanding_Suggestion,numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.PFs)(),suggestionType:i.hC.Commanding_Suggestion,numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.IyO)(),suggestionType:i.hC.AnalyzeData_ShowCharts,alwaysInList:!0},{suggestionText:(0,o.wYv)(),suggestionType:i.hC.AnalyzeData_ShowPivotTables,alwaysInList:!0}],b=(e,t)=>{let a=e;return t.forEach(((e,t)=>{a=a.replace(`{${t}}`,e.header),a=a.replace(`{DataFromColCell-${t}}`,e.firstCell.toString())})),a},f=e=>Math.floor(Math.random()*e),C=(e,t,a=[])=>{try{if((0,u.yw)("OfficeVSO_8967624_ShowLLMRelatedQuestions")&&(0,d.K)(t,i.hC.AnalyzeData_RelatedQuestions)){const e=y(t,a);let n;if((0,u.yw)("OfficeVSO_9062167_AvoidDupLLMRelatedQuestions")){const e=a.slice(-1*g);n=y(t,e)}else n=t;const o=(0===e.length?n:e).slice(0,g);return{suggestionList:o,shouldResetRecentPrompts:0===e.length}}let n=!1;const o=((e,t)=>{const a=[],n={Number:f(e.Number.length),String:f(e.String.length),Any:f(e.Any.length)};return t.forEach((t=>{const o=t.requiredColsType??"Any",r=e[o],i=t.numColsRequired??0;if(r.length<i)return;const l=((e,t,a)=>{const n=[];let o=t;for(let t=0;t<a;t++)e[o].header.trim().length&&(n.push(e[o]),o=(o+1)%e.length);return n})(r,n[o],i);l.length<i||(n[o]=(n[o]+l.length)%r.length,a.push({suggestionText:b(t.suggestionText,l),suggestionType:t.suggestionType,suggestionLanguage:t.suggestionLanguage}))})),a})((e=>{const t={Number:[],String:[],Any:[]};if(!e)return t;try{const a=JSON.parse(e.firstRowValues),n=JSON.parse(e.headers),o=JSON.parse(e.numberFormats);return e.visibleColumns.forEach((e=>{const r=a[e],i=o[e],l={header:n[e],firstCell:r};"number"!=typeof r||(0,m.xs)(i)?"string"==typeof r&&r.length&&"true"!==r&&"false"!==r&&(t.String.push(l),t.Any.push(l)):(t.Number.push(l),t.Any.push(l))})),t}catch(e){return c.M.getInstance().logError({eventType:s.S.ChatEvents,errorMessage:`Error sorting columns by type: ${e.message}`,logLevel:r.$b.Warning}),t}})(e),t);let l=y(o,a);l.length<=3&&(l=o,n=!0);return{suggestionList:l.slice(0,Math.min(3,o.length)),shouldResetRecentPrompts:n}}catch(e){return c.M.getInstance().logError({eventType:s.S.ChatEvents,errorMessage:`Error generating prompt suggestions: ${e.message}`,logLevel:r.$b.Warning}),{suggestionList:h().slice(0,3).map((e=>({suggestionType:e.suggestionType,suggestionText:e.suggestionText})))}}},y=(e,t)=>e.filter((e=>!t.includes(e.suggestionText))),v=e=>{if(!e)return;const t=l.ye.EmptyHeaders|l.ye.DuplicateHeaders;return e&t&&!(e&~t)?[{suggestionText:(0,o.aDv)(),suggestionType:i.hC.TlrExplainTables},{suggestionText:(0,o.vvX)(),suggestionType:i.hC.TlrExplainHeaders}]:e===l.ye.Unrecognized||e===l.ye.Crosstab?[{suggestionText:(0,o.aDv)(),suggestionType:i.hC.TlrExplainTables}]:e===l.ye.HasMergedCells?[{suggestionText:(0,o.R7A)(),suggestionType:i.hC.TlrExplainUnmergingCells}]:void 0}},78640:(e,t,a)=>{a.d(t,{D0:()=>Ie,mF:()=>xt,Kd:()=>Ve,at:()=>ht,Ff:()=>St});var n=a(92779),o=a(81364),r=a(89099),i=a(24220),l=a(90922),s=a(72483),c=a(49134),d=a(92240),u=a(15197),m=a(88179),g=a(50108),h=a(62646),p=a(66036),b=a(66888),f=a(72355),C=a(79029),y=a(49195),v=a(8505),T=a(82623),x=a(96854),S=a(31030),w=a(48314),E=a(23343),R=a(40910),I=a(55683),A=a(72842),L=a(18541),F=a(33540),_=a(28745),N=a(91259);const k=e=>{switch(e){case"Map":return(0,n.WpK)();case"ScatterChart":return(0,n.mnG)();case"ClusteredComboChart":return(0,n.Muj)();case"StackedComboChart":return(0,n.yMF)();case"HundredPercentComboChart":return(0,n.$Eq)();case"FunnelChart":return(0,n.YWO)();case"Treemap":return(0,n.OJx)();case"SunburstChart":return(0,n.etO)();case"ColorFilledMap":return(0,n.XsD)();case"CircularTreemap":return(0,n.q7F)();case"HeatMap":return(0,n.jdI)();case"WaterfallChart":return(0,n.iVS)();case"RoseChart":return(0,n.r9E)();case"NetworkMap":return(0,n.Tg4)();case"SmoothLineChart":return(0,n.FIy)();case"ComboChart":return(0,n.ICT)();case"LineChart":return(0,n.Kc4)();case"PieChart":return(0,n.gGJ)();case"DonutChart":return(0,n.K2I)();case"AreaChart":return(0,n.nuZ)();case"StackedArea":return(0,n.brP)();case"HundredPercentStackedArea":return(0,n.M_y)();case"ClusteredBarChart":return(0,n.vdP)();case"StackedBarChart":return(0,n.t3j)();case"HundredPercentStackedBarChart":return(0,n.koJ)();case"ClusteredColumnChart":return(0,n.KCq)();case"StackedColumnChart":return(0,n.Kve)();case"HundredPercentStackedColumnChart":return(0,n.hIB)();default:return(0,n.HRg)()}};var O=a(6925),P=a(88099),M=a(93471),D=a(23147),$=a(79259);const B=1e3;async function H(e,t,a){const r=await function(e,t,a){return Excel.run((async r=>{const i=r.workbook.worksheets.getItem(e).pivotTables.getItem(t);i.rowHierarchies.load("items"),i.columnHierarchies.load("items"),i.dataHierarchies.load("items/field/name, items/summarizeBy"),await r.sync();const l=i.rowHierarchies.items.map((e=>e.id));let s=i.columnHierarchies.items.map((e=>e.id));const c=i.dataHierarchies.items.map((e=>e.field.name));if(0===l.length)throw new o.u(o.O.RecommendedChartsPivotTableSourceNoRowField);if(0===c.length)throw new o.u(o.O.RecommendedChartsPivotTableSourceNoDataField);c.length<2&&(s=s.filter((e=>e!==(0,n.hW$)())));const d=a.data.valueRows.length>=1&&a.data.valueRows[0].every((e=>null===e)),u=(s.length>1||1===s.length&&c.length<2?1:0)+(d?1:0),m=Math.max(u+1,u+s.length);let g;if(0===s.length)g=[...l,...c];else{const e=a.data.textRows.slice(u,m).map(((e,t)=>{if(s[t]===(0,n.hW$)()){let t=-1;return[...e.slice(0,l.length),...e.slice(l.length).map((e=>(e&&t++,c[t%c.length])))]}return e})),t=(e,t)=>[...e,t||e[e.length-1]||""],o=e.map((e=>e.reduce(t,[])));g=a.data.textRows[0].map(((e,t)=>o.map((e=>e[t])).filter((e=>!!e)).join(" ")))}const h=g.map((()=>"General")),p={...a,data:{valueRows:[g,...a.data.valueRows.slice(m)],formatRows:[h,...a.data.formatRows.slice(m)],formatLocalRows:[h,...a.data.formatLocalRows.slice(m)],textRows:[g,...a.data.textRows.slice(m)]}},b=s.filter((e=>e!==(0,n.hW$)())),f=i.dataHierarchies.items.map((e=>({name:e.field.name,dataCalculation:U(e.summarizeBy)})));return{range:p,pivotTable:{rowFields:l.map((e=>({name:e}))),columnFields:b.map((e=>({name:e}))),filterFields:[],dataFields:f,valueFilters:[],labelFilters:[],dateFilters:[],highlightCellReferences:[]}}}))}(e,t,a),i={type:$.ol.PivotTable,sheetId:e,values:r.range.data.valueRows,numberFormats:r.range.data.formatRows,numberFormatLocals:r.range.data.formatLocalRows,texts:r.range.data.textRows,mergedCells:r.range.data.mergedCells,pivotTableName:t,transformedRange:r.range,appPivotTable:r.pivotTable,topLeftCellAddress:r.range.data.topLeftCellAddress},l=r.range.data.valueRows.length-1,s=function(e){return 0===e.transformedRange.data.valueRows.length?0:e.transformedRange.data.valueRows[0].length}(i)-r.pivotTable.rowFields.length;if(s*l>B)throw new o.u(o.O.LargePivotTableSource);return i}function U(e){switch(e){case Excel.AggregationFunction.sum:return"sum";case Excel.AggregationFunction.count:return"count";case Excel.AggregationFunction.average:return"average";case Excel.AggregationFunction.min:return"min";case Excel.AggregationFunction.max:return"max";case Excel.AggregationFunction.countNumbers:return"distinctCount";case Excel.AggregationFunction.standardDeviation:return"stdDev";case Excel.AggregationFunction.variance:return"variance";default:throw new Error("Unsupported calculation function")}}function q(e,t){const{valueRows:a,formatRows:n,formatLocalRows:o,textRows:r,mergedCells:i,formulas:l}=t;return{type:$.ol.Sheet,sheetId:e,values:a,numberFormats:n,numberFormatLocals:o,texts:r,mergedCells:i,formulas:l}}var V=a(20106),G=a(55143),W=a(59384),z=a(61150),Q=a(85105),J=a(50347);function j(e){return{table:{orientation:"columnMajor",headerRowCount:1,headerColumnCount:0},useOnlyFields:e.visibleColumns}}function Y(e){return{topLeft:{row:e.top-1,column:e.left-1},bottomRight:{row:e.bottom-1,column:e.right-1}}}var X=a(91960),K=a(59726),Z=a(99701),ee=a(93170),te=a(56229);var ae=a(95674),ne=a(45972),oe=a(18700),re=a(82959);const ie=4,le=5e6,se=5e5,ce=5e8,de={maxCellCount:1e4,entryLimit:1e3};class ue{log(){(0,R.sC)(this.columnCount,this.rowCount,this.selectionExpanded,this.tableSelectionContext,this.isSmallSelection,this.areaCount)}constructor(){this.selectionExpanded=!1,this.columnCount=0,this.rowCount=0,this.tableSelectionContext={isTable:!1,isPivotTable:!1,hasTableHeaders:!1,showTotals:!1},this.isSmallSelection=!1,this.areaCount=0}}function me(e){e.load(["isNullObject","cellCount","isEntireRow","isEntireColumn","worksheet/id","worksheet/name","address","columnCount","rowCount","rowIndex","columnIndex","rowHidden"])}function ge(e){return e.load(["values","numberFormat","numberFormatLocal","text","valueTypes"]),()=>{let t=!1;const a=e.values.map(((a,n)=>a.map(((a,o)=>"#VALUE!"===a?(t=!0,e.text[n][o]):e.valueTypes[n][o]===Excel.RangeValueType.empty?null:e.values[n][o]))));return(0,R.IJ)(t),{values:a,formats:e.numberFormat,formatLocals:e.numberFormatLocal,text:e.text}}}function he(e,t,a,n,o){const r=e.getRangeByIndexes(a,o,t,n).getMergedAreas(),i=r.areas;return i.load(["columnIndex","rowIndex","columnCount","rowCount"]),()=>r.isNullObject?[]:i.items.map((e=>{const{columnIndex:t,rowIndex:n,columnCount:r,rowCount:i}=e,l=n-a,s=t-o;return{top:l,left:s,bottom:l+i-1,right:s+r-1}}))}function pe(e){e.load(["columnIndex","rowIndex"]);const t=e.getMergedAreas(),a=t.areas;return a.load(["columnIndex","rowIndex","columnCount","rowCount"]),()=>{const n=e.columnIndex,o=e.rowIndex;return t.isNullObject?[]:a.items.map((e=>{const{columnIndex:t,rowIndex:a,columnCount:r,rowCount:i}=e,l=a-o,s=t-n;return{top:l,left:s,bottom:l+i-1,right:s+r-1}}))}}function be(e,t,a,n,o){const r=e.getRangeByIndexes(a,o,t,n);return r.load(["formulas","rowCount","columnCount"]),()=>r.formulas}function fe(e,t){const a=(0,oe.uT)(t.rowIndex,t.columnIndex,t.rowCount,t.columnCount),n=e.getRange(a);return n.load(["formulas","rowCount","columnCount"]),()=>n.formulas}function Ce(e,t,a,n,o){let r;if(t*n<le)r=e.getRangeByIndexes(a,o,t,n).getNumberFormatProperties().load("items/*");else{const i=Math.min(t,de.entryLimit),l=Math.min(n,de.maxCellCount/i),s=(0,oe.uT)(a,o,i,l),c=e.getRange(s);r=c.getNumberFormatProperties().load("items/*")}return()=>r.items}function ye(e,t){let a;if(t.rowCount*t.columnCount<le)a=t.getNumberFormatProperties().load("items/*");else{const n=Math.min(t.rowCount,de.entryLimit),o=Math.min(t.columnCount,de.maxCellCount/n),r=(0,oe.uT)(t.rowIndex,t.columnIndex,n,o),i=e.getRange(r);a=i.getNumberFormatProperties().load("items/*")}return()=>a.items}function ve(e){const t=e.map((e=>e.values)),a=e.map((e=>e.text)),n=e.map((e=>e.formats)),o=e.map((e=>e.formatLocals));return{values:[].concat(...t),formats:[].concat(...n),formatLocals:[].concat(...o),text:[].concat(...a)}}function Te(e){if(e.pivotTableData)throw new o.u(o.O.PivotTableSelection);if(e.range.isEntireRow||e.range.isEntireColumn)throw new o.u(o.O.UnboundedRange)}async function xe(e,t){t&&(0,R.in)(t,"getSelectionContextAndData");const a=new ue,n=performance.now();let r;const i=()=>(r=performance.now(),r);try{return await Excel.run((async r=>async function(e,t,a,n,r,i){i&&(0,R.in)(i,"getSelectionContextAndDataImp");const l=(0,g.dI)(e),s=function(e){if(Office.context.requirements.isSetSupported("ExcelApi","1.17")){const t=e.workbook.getThemeColors();return()=>{const e=[],a=t.value;if(a.length<10)return e;for(let t=4;t<10;t++)e.push(Re(a[t]));return e}}return()=>[]}(e),c=await async function(e,t,a,n){n&&(0,R.in)(n,"getNewSelectedRange");const r=e.workbook.getSelectedRanges().load("areaCount"),i=r.getUsedRangeAreasOrNullObject(!0);let l;if(a.type===v.lp.StandardTable)l=e.workbook.tables.getItem(a.name).getRange();else{if(a.type!==v.lp.TableLikeRange)throw new Error("InvalidTableLikeEntityType");{const t=(0,G.G2)(a.name);l=e.workbook.worksheets.getItem(a.sheetId).getRange(t),a.showTotals&&(l=l.getResizedRange(-1,0))}}l.load(["cellCount","rowCount"]);const s=l.getUsedRangeOrNullObject(!0).load(["cellCount","rowCount"]),c={selected:{range:l},usedSelected:{range:s}};!function(e){const t=e.selected.range.worksheet;t.tables.load(["items","showHeaders","showTotals","name"]),t.pivotTables.load("items"),t.load("id"),[e.selected.range,e.usedSelected.range].forEach((e=>me(e)))}(c);const d=function(e){const t=e.getTables().load({name:!0,showHeaders:!0,showTotals:!0});return async()=>{if(1!==t.items.length)return;const e=t.items[0],a=(0,re.U2)(e,e.showHeaders);return me(a),await e.context.sync(),{range:a,getTableData:()=>({tableName:e.name,hasTableHeaders:e.showHeaders,showTotals:e.showTotals}),getHasHiddenRows:()=>!1!==a.rowHidden}}}(l),u=function(e){const t=function(e){const t=e.getSurroundingDataRegion();return me(t),{range:t,usedRange:t}}(e.selected.range),a=function(e){return me(e.selected.range),{range:e.selected.range,usedRange:e.usedSelected.range}}(e),n=Ee(t.range,t.usedRange),o=Ee(a.range,a.usedRange);return n.next(),o.next(),{smallSelectionGenerator:n,largeSelectionGenerator:o}}(c);try{let n;await e.sync();const s=l.isEntireRow||l.isEntireColumn;t.areaCount=r.areaCount;const m=i.isNullObject;if(r.areaCount>1&&!(0,J.yw)("OfficeVSO_9209788_allowMultiSelectedRanges"))throw new o.u(o.O.MultiSelectionError);{const o=e=>e.usedSelected.range.isNullObject||m||e.usedSelected.range.cellCount<=ie||e.usedSelected.range.rowCount<2||1===e.usedSelected.range.columnCount;if(a.type!==v.lp.TableLikeRange&&o(c)){t.selectionExpanded=!0,t.isSmallSelection=!0;const a=await d(),o=!a||s?await(0,oe.H)(e,u.smallSelectionGenerator):a;n=a??o}else n=await(0,oe.H)(e,u.largeSelectionGenerator)}return{selected:(e=>{if(e&&e.pivotTableData)throw new o.u(o.O.PivotTableSelection);return e})(n)}}catch(e){if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode)throw new o.u(o.O.CellEditModeError,e);if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidSelection)throw new o.u(o.O.InvalidSelection,e);throw e}finally{n&&(0,R.N6)(n,"getNewSelectedRange")}}(e,t,r,i),d=c.selected,u=l(),m=s();if((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)){if(!d)return(0,R.NQ)("GetSelectionContext",performance.now()-a,i),i&&(0,R.N6)(i,"getSelectionContextAndDataImp"),{context:Se,localeDeprecated:u,theme:m};try{Te(d)}catch(e){throw i&&(0,R.N6)(i,"getSelectionContextAndDataImp"),e}(0,R.NQ)("GetSelectionContext",n()-a,i);const{rowCount:e,rowIndex:l,columnCount:s,columnIndex:c,worksheet:g}=d.range,h=async function*(e,t,a,n,r,i){const l=Office.context.platform===Office.PlatformType.OfficeOnline?le:se;let s=Math.floor(Math.min(e,l/a));const c=2**(0,J.Z8)("Microsoft.Office.Excel.FA000000124.MaxPayloadSizeRetries",7),d=Math.min(de.entryLimit,Math.ceil(de.maxCellCount/a));let u=t,m=t;for(;u<t+e;){i&&(0,R.in)(i,"getSelectionDataFromSelectedRangeInfo");const g=Date.now(),h=[],b=[];let f,C,y=0;try{const v=await Excel.run((async i=>{const g=i.workbook.worksheets.getItem(r);for(;u<t+e&&u-m<Math.floor(l/a);){let r=0;if(h.length===c||(0,J.yw)("OfficeVSO_9408436_SmallDataSourceApi")&&r>=ce){const e=ve(h),t=[].concat(...b);return{...e,mergedCells:C,formulas:t}}const i=g.getRangeByIndexes(u,n,Math.min(s,t+e-u),a),l=ge(i);let m,v,T=()=>[];u===t&&(m=he(g,e,t,a,n),T=Ce(g,e,t,a,n));const x=u-t;x<d&&x*a<de.maxCellCount&&(v=be(g,Math.min(d-x,s),u,a,n)),y++;try{await i.context.sync();const a=l();if(h.push(a),void 0!==v&&b.push(v()),u===t&&(C=m(),f=T(),p.P.getNumberFormatCache().addNumberFormatPropertiesToCache(f)),(0,J.yw)("OfficeVSO_9408436_SmallDataSourceApi"))r+=JSON.stringify(a).length;else if(JSON.stringify(a).length*Math.ceil(e/s)>ce)throw new o.u(o.O.PayloadSizeError);u+=s}catch(e){if(!(e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||e.code===OfficeExtension.ErrorCodes.generalException)&&s>1))throw e;s=Math.ceil(s/2)}}const v=ve(h),T=[].concat(...b);return{...v,mergedCells:C,formulas:T}}));(0,R.ij)("GetSelectionData",Date.now()-g,e,a,!0,h.length,y,s),m+=v.values.length,i&&(0,R.N6)(i,"getSelectionDataFromSelectedRangeInfo"),yield v}catch(t){throw(0,R.ij)("GetSelectionData",Date.now()-g,e,a,!1,h.length,y,s),t}}}(e,l,s,c,g.id,i);let b=we(d,t)??Se;return r.type===v.lp.TableLikeRange&&(b={...b,tableName:r.name,showTotals:r.showTotals,hasTableHeaders:r.hasTableHeaders}),t.log(),i&&(0,R.N6)(i,"getSelectionContextAndDataImp"),{context:b,dataGenerator:h,localeDeprecated:u,theme:m}}{if(!d){const e={text:[],values:[],formats:[],formatLocals:[]};return(0,R.NQ)("GetSelectionContext",performance.now()-a,i),i&&(0,R.N6)(i,"getSelectionContextAndDataImp"),{context:Se,data:e,localeDeprecated:u,theme:m}}try{Te(d)}catch(e){throw i&&(0,R.N6)(i,"getSelectionContextAndDataImp"),e}(0,R.NQ)("GetSelectionContext",n()-a,i);const e=await async function(e,t){t&&(0,R.in)(t,"getSelectionDataFromSelectedRangeInfo");const a=e.range.worksheet,n=await async function(e,t){const{rowCount:a,rowIndex:n,columnCount:r,columnIndex:i}=e,l=Date.now(),s=[],c=[];let d=n;const u=Office.context.platform===Office.PlatformType.OfficeOnline?le:se;let m=Math.floor(Math.min(a,u/r));const g=Math.min(de.entryLimit,Math.ceil(de.maxCellCount/r));let h,b,f=0,C=0;try{for(;d<n+a;){const l=t.getRangeByIndexes(d,i,Math.min(m,n+a-d),r),u=ge(l);let y,v,T=()=>[];d===n&&(y=pe(e),T=ye(t,e));const x=d-n;x<g&&x*r<de.maxCellCount&&(v=fe(t,{rowCount:Math.min(g-x,m),rowIndex:d,columnCount:r,columnIndex:i})),f++;try{await l.context.sync();const e=u();if(s.push(e),void 0!==v&&c.push(v()),d===n&&(b=y(),h=T(),p.P.getNumberFormatCache().addNumberFormatPropertiesToCache(h),JSON.stringify(e).length*Math.ceil(a/m)>ce))throw new o.u(o.O.PayloadSizeError);d+=m}catch(e){if(!(e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||e.code===OfficeExtension.ErrorCodes.generalException)&&m>1))throw e;if(C++,C>(0,J.Z8)("Microsoft.Office.Excel.FA000000124.MaxPayloadSizeRetries",7))throw new o.u(o.O.PayloadSizeError,e);m=Math.ceil(m/2)}}const u=ve(s),y=[].concat(...c);return(0,R.ij)("GetSelectionData",Date.now()-l,a,r,!0,s.length,f,m),{...u,mergedCells:b,formulas:y}}catch(e){throw(0,R.ij)("GetSelectionData",Date.now()-l,a,r,!1,s.length,f,m),e}}(e.range,a);t&&(0,R.N6)(t,"getSelectionDataFromSelectedRangeInfo");return n}(d,i);let l=we(d,t)??Se;return r.type===v.lp.TableLikeRange&&(l={...l,tableName:r.name,showTotals:r.showTotals,hasTableHeaders:r.hasTableHeaders}),t.log(),i&&(0,R.N6)(i,"getSelectionContextAndDataImp"),{context:l,data:e,localeDeprecated:u,theme:m}}}(r,a,n,i,e,t)))}catch(e){throw e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.inactiveWorkbook?new o.u(o.O.InactiveWorkbook,e):e instanceof o.u?e:new o.u(o.O.SelectionFailed,e)}finally{r&&(0,R.NQ)("GetSelectionData",performance.now()-r,t),t&&(0,R.N6)(t,"getSelectionContextAndData")}}const Se={rowCount:0,rowIndex:0,columnCount:0,columnIndex:0,isTable:!1,isPivotTable:!1,hasTableHeaders:!1,showTotals:!1};function we(e,t){if(e)return function(e,t){const a=t.range;e.columnCount=a.columnCount,e.rowCount=a.rowCount;const n=t.getTableData(),o=t.pivotTableData;let r;r=o?o.tableName:n?n.tableName:void 0;const i={isTable:!!n,isPivotTable:!!o,hasTableHeaders:!!o&&o.hasTableHeaders||!!n&&n.hasTableHeaders,showTotals:!!n&&n.showTotals,tableName:r,hasHiddenRows:t.getHasHiddenRows()};return e.tableSelectionContext=i,(0,R.NQ)("GenerateSelectionContext",0),{address:(0,oe.gx)(a.address),sheetId:a.worksheet.id,sheetName:a.worksheet.name,rowCount:a.rowCount,rowIndex:a.rowIndex,columnCount:a.columnCount,columnIndex:a.columnIndex,...i}}(t,e)}function*Ee(e,t){const a=e.getTables().load("items"),n=e.getPivotTables(!1).getFirstOrNullObject().load("name"),o=n.layout.getRange();me(o);const r={range:t,getTableData:()=>{},getHasHiddenRows:()=>!1!==o.rowHidden};if(yield,n.isNullObject&&0===a.items.length)return r;a.items.forEach((e=>{e.load(["showHeaders","name","showTotals"])}));const i=a.items.map((e=>{const t=e.getRange();return me(t),t}));if(n.isNullObject){if(a.items.length>0){let e=t;if(1===i.length&&(yield,function(e,t){return null!==e&&null!==t&&e.rowIndex>=t.rowIndex&&e.columnIndex>=t.columnIndex&&e.rowIndex+e.rowCount<=t.rowIndex+t.rowCount&&e.columnIndex+e.columnCount<=t.columnIndex+t.columnCount}(i[0],t)&&(e=i[0])),a.items.some((e=>e.showTotals))){const t=a.items.map((e=>e.getTotalRowRange().load(["rowIndex","columnIndex","columnCount"]))),n=1===e.rowCount?void 0:e.getResizedRange(-1,0);n&&(me(n),yield,t.some(((t,n)=>a.items[n].showTotals&&t.columnIndex>=e.columnIndex&&t.columnIndex+t.columnCount<=e.columnIndex+e.columnCount&&t.rowIndex===e.rowIndex+e.rowCount-1))&&(e=n))}return{range:e,getTableData:()=>{const t=i.findIndex((t=>function(e,t){return e.rowIndex<=t.rowIndex&&e.columnIndex<=t.columnIndex&&e.rowIndex+e.rowCount>=t.rowIndex+t.rowCount&&e.columnIndex+e.columnCount>=t.columnIndex+t.columnCount}(t,e)));return-1===t?void 0:{hasTableHeaders:a.items[t].showHeaders,tableName:a.items[t].name,showTotals:a.items[t].showTotals}},getHasHiddenRows:()=>!1!==e.rowHidden}}return r}return{range:o,pivotTableData:{hasTableHeaders:!0,tableName:n.name},getTableData:()=>{},getHasHiddenRows:()=>!1!==o.rowHidden}}function Re(e){return{r:(255&e)/255,g:(e>>8&255)/255,b:(e>>16&255)/255,a:1}}var Ie,Ae=a(39234),Le=a(37745),Fe=a(95800),_e=a(94303),Ne=a(35893),ke=a(98100),Oe=a(71362),Pe=a(70364),Me=a(98483);!function(e){e.Chart="Chart",e.Table="Table",e.Sheet="Sheet"}(Ie||(Ie={}));const De="BlankPivotTable",$e=!0,Be="I don't find any suggestions",He={activeTable:void 0,lastActiveTable:void 0,dataSourceApis:{},selectionContexts:{},selectionContexts_DEPRECATED:{},evaluateQueryLocations:{},generateResultForNLEvaluationLocations:{},postRangesResults:{},postRangesRequestTypes:{},interpretations:{},recommendations:{},suggestions:{},selectionError:void 0,isInserting:!1,hideSelectionErrorOnSheet:void 0,hideSelectionErrorOnRange:void 0,activeRequestId:{},isAllowRewrite:$e,requestState:{},isPermanentError:!1,isWorksheetProtected:!1,isWorksheet:!0,isWorkbookAutoSaveOn:!0,pendingNLContextFetches:[],tabularRanges:{},localeCacheDeprecated:(0,g.FZ)(),themeColors:[],textAnalysisCardProps:void 0,excelRecognizedTablesAnnotationsCache:[],excelRecognizedTablesAnnotationsCacheRevisionId:"",nlEvaluationStates:{}},Ue=(0,J.iP)("Microsoft.Office.Excel.FA000000124.CalculatedColumnsHeaderLessTLR",!1),qe=(0,J.iP)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1),Ve=2e6;async function Ge(e,t){let a;const n=e.address;if(n){const e=n.indexOf(":");a=e>0?n.substring(0,e):void 0}const o={data:{valueRows:t.values,formatRows:(0,M.vc)(t.formats),formatLocalRows:(0,M.vc)(t.formatLocals),textRows:t.text,mergedCells:t.mergedCells,formulas:t.formulas,topLeftCellAddress:a},contentLanguageHint:(0,Le.gl)()};if(e.isPivotTable){const t=await H(e.sheetId,e.tableName,o);return{range:t.transformedRange,dataSourceApi:t}}return{range:o,dataSourceApi:q(e.sheetId,o.data)}}function We(e){return{data:{valueRows:e.values,formatRows:(0,M.vc)(e.formats),formatLocalRows:(0,M.vc)(e.formatLocals),textRows:e.text,mergedCells:e.mergedCells,formulas:e.formulas},contentLanguageHint:(0,Le.gl)()}}function ze(e,t,a){const n=(0,Ae.z6)();if(!t)throw new Error("No active table");if(t.name!==e)throw new Error("The query is not aimed at the active table");if(0===t.visibleColumns.length)throw new Error("All columns in selected table are hidden");return{recommendationOptions:"NL"===a?void 0:{capabilities:{chart:{layouts:"ChartReco"===a?n:[]},pivotTable:"PivotTableReco"===a,pivotChart:{layouts:"ChartReco"===a?n:[]}},thresholdOfUsingBaseMiningLevel:15e3,maxNumOfSummaryPerClass:1,disableInterleaveExperiment:!1},dataFieldOptions:j(t)}}function Qe(e,t,a,n){return{...e,generateResults:ze(t,a,n)}}const Je=(e,t,a="NL",n=!1)=>async(o,r)=>{const{postRangesResults:i,postRangesRequestTypes:l}=r().selection;if(i[e]){if(!n&&l[e]&&l[e].includes(a))return;{const n=ze(e,r().selection.activeTable,a),l=await(0,f.x4)().generateResultsForRange(i[e].location,n,(0,f.oO)(void 0,i[e].authToken,t));return void o(xt.generateResultsSuccess({tableName:e,requestType:a,generateResultsResult:l}))}}t&&(0,R.in)(t,"postRangesIfNeeded");const s=performance.now();try{if(!(0,J.yw)("OfficeVSO_8394820_UseForceRefreshToSkipTableLoading")&&((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?r().selection.selectionContexts:r().selection.dataSourceApis)[e]||await o(at(e,!1,t)),(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)){const n=await o(at(e,!1,t));if(n){p.P.getNumberFormatCache().addNumberFormatPropertiesToCache([W.tN]);const i=r().selection.selectionContexts[e],l=(i.address,await n.next());if(l.done)throw Error("Selection data generator returned nothing");const s=l.value;if(!(0,J.yw)("OfficeVSO_9408436_SmallDataSourceApi")){const t=Math.min((0,J.xy)("CalculatedColumnsMaxRows"),Math.floor((0,J.xy)("CalculatedColumnsMaxCells")/i.columnCount));o(xt.setDataSourceApi({tableName:e,dataSourceApi:q(i.sheetId,{textRows:s.text.slice(0,t),valueRows:s.values.slice(0,t),formatRows:s.formats.slice(0,t),formulas:s.formulas?.slice(0,t)})}))}const c=(0,f.oO)(void 0,void 0,t),d=await(0,f.x4)().initializeRange(We(s),i,c);let{isComplete:u,authToken:m}=d,g=l.value.values.length;const h=(0,f.oO)(void 0,m,t);for await(const t of n){if(u)throw Error('Insights range returned with "Complete" status before all data was sent');const n=Qe(We(t),e,r().selection.activeTable,a);u=(await(0,f.x4)().storeData(d.location,n,g,h)).isComplete,g+=t.values.length}if(!u)throw Error('Insights range returned with "Incomplete" status after all data was sent');const b=ze(e,r().selection.activeTable,a),C=await(0,f.x4)().generateResultsForRange(d.location,b,h);o(xt.postRangesSuccess({tableName:e,postRangesResult:{...C,...d},requestType:a}))}}else{const{dataSourceApis:n}=r().selection,i=n[e];let l=(e=>({data:{valueRows:e.values,formatRows:(0,M.vc)(e.numberFormats),formatLocalRows:(0,M.vc)(e.numberFormatLocals),textRows:e.texts,mergedCells:e.mergedCells,formulas:e.formulas,topLeftCellAddress:e.topLeftCellAddress},contentLanguageHint:(0,Le.gl)()}))(i);l=Qe(l,e,r().selection.activeTable,a),await(0,Q.QI)(l);const s=(0,f.oO)(void 0,void 0,t),c=await(0,f.x4)().postRanges(i,l,s);o(xt.postRangesSuccess({tableName:e,postRangesResult:c,requestType:a}))}}finally{t&&(0,R.N6)(t,"postRangesIfNeeded"),(0,R.NQ)("PostRangesIfNeeded",performance.now()-s,t)}},je=(e,t=()=>!1,a,n="NL",r=!1)=>async(i,l)=>{const{interpretations:s}=l().selection;if(s[e]&&s[e].length>0&&!r&&l().selection.postRangesRequestTypes[e]&&l().selection.postRangesRequestTypes[e].includes(n))return;a&&(0,R.in)(a,"getInterpretationsIfNeeded");const c=performance.now();try{if((r||!l().selection.postRangesResults[e]||!l().selection.postRangesRequestTypes[e]||!l().selection.postRangesRequestTypes[e].includes(n))&&(await i(Je(e,a,n,r)),t()))return;if(!bt(l().selection,e))return i(xt.clearExpiredRanges(e)),void(0,R.zG)("getInterpretationsIfNeeded");const{postRangesResults:s}=l().selection;if(t())return;const c=s[e],d=(0,f.oO)(void 0,c.authToken,a);if(!c.operationLocation)throw new Error(o.O.MissingOperationLocation);await(0,f.x4)().handleOperation(c.operationLocation,{interpretations:async t=>{const a=await(0,f.x4)().getInterpretations(t,d);if(0===a.interpretations.length)throw new Error(o.O.GetInterpretationsFailed);i(xt.getInterpretationsSuccess({tableName:e,result:a,requestType:n}))},recommendations:"NL"===n?void 0:async t=>{const a=await(0,f.x4)().getRecommendations(t,(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?l().selection.selectionContexts[e]:l().selection.selectionContexts_DEPRECATED[e].context,d);a.recommendations.length>0&&i(xt.getRecommendationsSuccess({tableName:e,recommendations:a.recommendations}))}},d)}finally{(0,R.NQ)("GetInterpretationsIfNeeded",performance.now()-c,a),a&&(0,R.N6)(a,"getInterpretationsIfNeeded")}},Ye=(e,t,a=()=>!1,n=!1)=>async(r,i)=>{t&&(0,R.in)(t,"getNLContextIfNeeded");const l=performance.now(),{evaluateQueryLocations:s,generateResultForNLEvaluationLocations:c}=i().selection;if((!qe||!c[e])&&(qe||!s[e])){if(i().selection.pendingNLContextFetches.includes(e))return t&&(0,R.in)(t,"pendingNLContextFetches"),await new Promise((t=>{Ne.F.startListening({predicate:(t,a)=>t.type===xt.getNLContextFinished.type&&!a.selection.pendingNLContextFetches.includes(e),effect:(e,a)=>{a.unsubscribe(),t()}})})),(0,R.NQ)("GetNLContextIfNeeded",performance.now()-l,t),void(t&&((0,R.N6)(t,"pendingNLContextFetches"),(0,R.N6)(t,"getNLContextIfNeeded")));r(xt.getNLContextRequest(e));try{if((!i().selection.interpretations[e]||0===i().selection.interpretations[e].length)&&(await r(je(e,a,t)),a()))return;if(!bt(i().selection,e))return r(xt.clearExpiredRanges(e)),void(0,R.zG)("getNLContextIfNeeded");if(!i().selection.interpretations[e]||0===i().selection.interpretations[e].length)throw new Error(o.O.GetInterpretationsFailed);const{interpretations:n,postRangesResults:l}=i().selection,s=n[e][0];if(a())return;const c=(0,f.oO)(void 0,l[e].authToken,t),d=await(0,f.x4)().getNaturalLanguageContext(s.generateNLContextLocation,{headerNames:[],preferColumnsIndexes:[]},c);r(xt.getNLContextSuccess({tableName:e,contextResponse:d}))}catch(i){if(!(i instanceof o.u)||i.errorCode!==o.O.Gone&&i.errorCode!==o.O.NotFound||n)throw i;r(xt.clearExpiredRanges(e)),r(xt.getNLContextFinished(e)),await r(Ye(e,t,a,!0))}finally{r(xt.getNLContextFinished(e)),(0,R.NQ)("GetNLContextIfNeeded",performance.now()-l,t),t&&(0,R.N6)(t,"getNLContextIfNeeded")}}},Xe=(e,t,a,l,c,d)=>async(u,g)=>{const h=performance.now();try{if((0,R.Ri)(a),(0,R.in)(a,"getInsights"),u(O.mF.startExecutingCommand({command:m.OP.AnalyzeData,id:a})),u(xt.setActiveRequestId({tableName:e,activeRequestId:a})),t.numColumns*t.numRows>(0,J.Z8)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",Ve))throw new o.u(o.O.LargeData);const n=async(e=()=>()=>{})=>{await d(e),"failed"!==g().selection.requestState[a]&&u(xt.evaluateQuerySuccess(a))};let r=()=>{};const i=new Promise(((e,t)=>{r=()=>t(new Error("timeout"))}));let l=setTimeout(r,E.R.getAnalyzeDataTimeout());const s=()=>(clearTimeout(l),()=>{l=setTimeout(r,E.R.getAnalyzeDataTimeout())}),c=(async()=>{try{await n(s)}finally{clearTimeout(l)}})();await Promise.race([c,i])}catch(e){e instanceof Error&&"timeout"===e.message&&w.M.getInstance().logErrorCode(o.O.AnalyzeDataTimeout,void 0,S.S.AnalyzeDataDuration,m.$b.ASHA,{key:m.un.ErrorLocation,value:(0,R.H)(a)??""},{key:m.un.EvaluateQueryCorrelationId,value:a}),u(xt.evaluateQueryFailed(a)),w.M.getInstance().logEvent((0,m.SV)(m.he.NoResult,m.q.AnalyzeData,m.KZ.InsightsApi));let t=(0,n.Hum)(),d=l,g=m.q0.ClientError,h=i.W.Unable_To_Complete_Task,p=r.c.Analyze_Data_Get_Insights_Client_Error;e instanceof Error&&e.message===o.O.GetInterpretationsFailed?(t=(0,n.S5F)(),d=o.O.GetInterpretationsFailed,g=m.q0.NoSuggestions,h=i.W.User_Input_Could_Not_Be_Processed,p=r.c.Failed_Insight_Generation_Due_To_Not_Enough_Info):e instanceof o.u&&e.errorCode===o.O.LargeData?(t=(0,J.yw)("OfficeVSO_9480524_LargeDataMessage")&&4e6===(0,J.Z8)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",Ve)?(0,n.ynC)():(0,n.SqW)(),d=o.O.LargeData,g=m.q0.LargeData,h=i.W.User_Input_Could_Not_Be_Processed,p=r.c.Failed_Insight_Generation_Due_To_Too_Large_Data):e instanceof o.u&&e.errorCode===o.O.NetworkError?(t=(0,n.a0$)(),d=o.O.NetworkError,g=m.q0.NetworkError,h=i.W.Unable_To_Complete_Task,p=r.c.Analyze_Data_Network_Error):e instanceof Error&&"timeout"===e.message?(d=o.O.AnalyzeDataTimeout,g=m.q0.AgentTimeout,h=i.W.Response_Delayed_Or_Timed_Out,p=r.c.Analyze_Data_Insights_Services_Timeout):(0,J.qm)()&&(0,_e.ip)(e)&&(t=(0,n.OX0)(),d=o.O.PayloadSizeError,g=m.q0.LargeData,h=i.W.User_Input_Could_Not_Be_Processed,p=r.c.Failed_Insight_Generation_Due_To_Too_Large_Data),w.M.getInstance().logErrorCode(d,e,S.S.AnalyzeDataError,e instanceof Error&&"timeout"===e.message?m.$b.Error:m.$b.ASHA),w.M.getInstance().logStandardizedAshaErrorEvent(h,p,m.BJ.AnalyzeData);const{message:f,telemetry:C}=Oe.n.getAnalyzeDataErrorResponse(t,g);if(s.$.getInstance().displayResponse(f,C,{shouldShowWhenFluxSkillResponseRequired:!1}),c){const e=(0,K.N)(f);u(O.mF.sendSkillResponseToFlux(e,b.Aw.failed,C))}}finally{c||await u(O.mF.stopExecutingAndReleaseContextLock()),u(xt.resetIsAllowRewrite()),(0,R.NQ)("GetInsights",performance.now()-h,a),(0,R.Ri)(a)}},Ke=(e,t,a,l,c=()=>()=>{},d=()=>!1,u=!1,g)=>async(p,C)=>{(0,R.in)(l,"evaluateQuery");const y=performance.now();try{const y=qe&&!C().selection.generateResultForNLEvaluationLocations[e],v=!qe&&!C().selection.evaluateQueryLocations[e];(y||v)&&await p(Ye(e,l));const{postRangesResults:T,interpretations:x,evaluateQueryLocations:E,generateResultForNLEvaluationLocations:A,isAllowRewrite:L}=C().selection,F=(0,J.yw)("OfficeVSO_9536868_RemoveIncompleteQuery")?function(e){if(""!==e)return{tokens:[{tokenType:"none",text:e}]}}(a):function(e,t){const a=t?t.tokens.map((e=>e.text)).join(""):"";if(a===e)return t;const n=e.length>a.length?e:a,o=n===e?a:e,r=(0,te.K4)(e,a),i=0===a.length||0===e.length||!n.startsWith(o),l=e.length>a.length;if(i)return{tokens:[{tokenType:"none",text:e}]};if(l){const e=t,a=[...e.tokens],o=a.pop(),i={tokenType:"none",text:""};return"none"===o.tokenType?i.text=o.text+n.substring(r):(a.push(o),i.text=n.substring(r)),a.push(i),{...e,tokens:a}}{const e=[...t.tokens],a={tokens:[]};let n=0;for(;n<r;){const t=e.shift(),o=n;if(n+=t.text.length,n>r){const e={tokenType:"none",text:t.text.substring(0,r-o)};a.tokens.push(e)}else a.tokens.push(t)}return a}}(a);if(!F)throw new Error("No query tokens found");const _={visualPreviewOptions:{maxTableDataSize:function(){const e=ee.U$+20,t=ee.Pl+20;return{width:Math.max(W.y3,e),height:Math.max(W.m6,t)}}()},allowReorder:!1,allowRewrite:L,outputAnswerLanguage:g,...F},N=await p(I.mF.getToken(c));if(!bt(C().selection,e))return p(xt.clearExpiredRanges(e)),void(0,R.zG)("evaluateQuery");const k=(0,f.oO)(N,T[e].authToken,l);try{let a;if(a=qe?await Ze(A[e],_,x[e][0],(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?C().selection.selectionContexts[e]:C().selection.selectionContexts_DEPRECATED[e].context,l,p,k):await(0,f.x4)().getNaturalLanguageResult(E[e],_,x[e][0],(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?C().selection.selectionContexts[e]:C().selection.selectionContexts_DEPRECATED[e].context,k),g&&(a.outputLanguage=g),d())return;if(p(O.mF.setCurrentNLResult(a)),(0,R.kw)(a),a.responseType===h.WZ.Answered){const o=!1===a.fullyUnderstoodRewrittenQuery;if(a.visualAnswer.every((e=>"QueryResultVisual"===e.visual.visualType&&0===e.visual.result.fields.length))){w.M.getInstance().logEvent((0,m.SV)(m.he.ElseFallback,m.q.AnalyzeData,m.KZ.InsightsApi));const e=!(0,J.yw)("OfficeVSO_9576728_RemoveElseErrorMessage"),{message:t,telemetry:o}=Oe.n.getAnalyzeDataInfoResponse(e?(0,n.V0i)():"",!!e||void 0);s.$.getInstance().displayResponse(t,o,{shouldShowWhenFluxSkillResponseRequired:e});const r={text:(0,n.S5F)(),visual:Be,mustExplain:a.explainToLLM,fallbackToElse:!0},i=JSON.stringify(r);p(O.mF.sendSkillResponseToFlux(i,b.Aw.failed,o))}else if(a.caveats&&a.caveats.length>0)if(a.visualAnswer.some((e=>!(0,Q.ch)(e.visual)))){w.M.getInstance().logEvent((0,m.SV)(m.he.SuggestionShown,m.q.AnalyzeData,m.KZ.InsightsApi));const n=gt(a),o=a.visualAnswer[0],{message:r,telemetry:i}=Oe.n.getAnalyzeDataRecommendationResponse({visual:o,requestId:l,responseText:"",caveats:a.caveats,tableName:e,tableContext:t});s.$.getInstance().displayResponse(r,i);const c=(0,Z.t)(o,"",a.textAnswer?.tokens.map((e=>e.text)).join(""),n);p(O.mF.sendSkillResponseToFlux(c,b.Aw.success,i))}else{w.M.getInstance().logEvent((0,m.SV)(m.he.ElseFallback,m.q.AnalyzeData,m.KZ.InsightsApi));const e=!(0,J.yw)("OfficeVSO_9576728_RemoveElseErrorMessage"),{message:t,telemetry:o}=Oe.n.getAnalyzeDataInfoResponse(e?(0,n.Jx4)():"",!!e||void 0);s.$.getInstance().displayResponse(t,o,{shouldShowWhenFluxSkillResponseRequired:e});const r={text:(0,n.$Sd)(),visual:Be,mustExplain:a.explainToLLM,fallbackToElse:!0},i=JSON.stringify(r);p(O.mF.sendSkillResponseToFlux(i,b.Aw.failed,o))}else if(a.visualAnswer.every((e=>(0,Q.ch)(e.visual)))){w.M.getInstance().logEvent((0,m.SV)(m.he.SuggestionShown,m.q.AnalyzeData,m.KZ.InsightsApi));const e=o?(0,n.aI5)():(0,n.hiC)(),t=(a.textAnswerSummary?.tokens??[]).map((e=>e.text)).join(""),r=!(0,J.yw)("OfficeVSO_9496159_FixTextAnswerNullRef")||t.length>0?e.replace("{0}",t[0].toLocaleLowerCase()+t.slice(1)):(0,n.V0i)(),{message:i,telemetry:l}=Oe.n.getAnalyzeDataInfoResponse(r);s.$.getInstance().displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!1});const c=JSON.stringify({text:r,visual:Be,mustExplain:a.explainToLLM});p(O.mF.sendSkillResponseToFlux(c,b.Aw.failed,l))}else{w.M.getInstance().logEvent((0,m.SV)(m.he.SuggestionShown,m.q.AnalyzeData,m.KZ.InsightsApi));const r=(o?(0,n.bUh)():1===a.visualAnswer.length?(0,n.wT9)():(0,n.YTh)()).replace("{0}",(0,ke.Yd)(a.visualAnswer[0].visual.visualType)??"visual");let i=a.textAnswer?.tokens.map((e=>e.text)).join("");i=o?a.textAnswer?.tokens.map((e=>e.text)).join("")+" "+r:a.visualAnswer.length>1&&a.visualAnswer[0].title?a.visualAnswer[0].title.runs.map((e=>e.text)).join(""):a.textAnswer?.tokens.map((e=>e.text)).join("");const c=gt(a),d=a.visualAnswer[0],u="TextAnalysisVisual"===a.visualAnswer[0].visual.visualType,g=(0,Me.A)(),h={visual:u?{...d,id:g}:d,requestId:l,responseText:r,tableName:e,tableContext:t},{message:f,telemetry:C}=Oe.n.getAnalyzeDataRecommendationResponse(h),y=(0,Z.t)(u?{...d,id:g}:d,r,i,c),v=()=>p(O.mF.sendSkillResponseToFlux(y,b.Aw.success,C));if(u){const{chatCardType:e,chatMessageData:t,chatMessageBodyData:a}=f;p(xt.setTextAnalysisCardProps({props:h})),s.$.getInstance().sendHistorySignal(e,t,a),v()}else s.$.getInstance().displayResponse(f,C),v()}}else{const e=(a.explainToLLM?.length??0)>0;let t,o;(0,J.yw)("OfficeVSO_9242126_NoVetoForAmbiguousWithExplanation")&&a.reasonForError===h.M$.AskForClarification&&e?t=m.he.SuggestionShown:yt(a.reasonForError)?t=m.he.ElseFallback:(Ct(a.reasonForError,e),t=m.he.NoResult),w.M.getInstance().logEvent((0,m.SV)(t,m.q.AnalyzeData,m.KZ.InsightsApi));let r=a.explainToLLM;if(a.reasonForError){const e=ft(a.reasonForError);o=e.errorMessage,e.explainToLLM&&(r&&r.length>0?(r+=". ",r+=e.explainToLLM):r=e.explainToLLM)}else o=(0,n.Rzj)();const i=vt(a.reasonForError),l=!(0,J.yw)("OfficeVSO_9576728_RemoveElseErrorMessage")&&yt(a.reasonForError)&&void 0!==i;let c;c=(0,J.yw)("OfficeVSO_9242126_NoVetoForAmbiguousWithExplanation")&&a.reasonForError===h.M$.AskForClarification&&e?Oe.n.getAnalyzeDataInfoResponse(o):l?Oe.n.getAnalyzeDataInfoResponse(i,!0):Oe.n.getAnalyzeDataErrorResponse(o,m.q0.NoSuggestions);const{message:d,telemetry:u}=c;s.$.getInstance().displayResponse(d,u,{shouldShowWhenFluxSkillResponseRequired:l});const g={text:o,visual:Be,mustExplain:r,fallbackToElse:yt(a.reasonForError)},f=JSON.stringify(g);p(O.mF.sendSkillResponseToFlux(f,b.Aw.failed,u))}}catch(h){if(h instanceof o.u&&(h.errorCode===o.O.Gone||h.errorCode===o.O.NotFound)&&!u)p(xt.clearExpiredRanges(e)),await p(Ke(e,t,a,l,c,d,!0,g));else{let e=m.q0.ClientError,t=i.W.Unable_To_Complete_Task,a=r.c.Analyze_Data_Evaluate_Query_Client_Error;h instanceof o.u&&h.errorCode===o.O.InternalServerError&&(e=m.q0.ServiceError,t=i.W.Unable_To_Complete_Task,a=r.c.Analyze_Data_Insights_Services_Error);let l=(0,n.Hum)();h instanceof o.u&&h.errorCode===o.O.NetworkError&&(l=(0,n.a0$)(),e=m.q0.NetworkError,t=i.W.Unable_To_Complete_Task,a=r.c.Analyze_Data_Network_Error),w.M.getInstance().logStandardizedAshaErrorEvent(t,a,m.BJ.AnalyzeData),w.M.getInstance().logErrorCode(o.O.EvaluateQueryFailed,h,S.S.AnalyzeDataError,m.$b.ASHA);const{message:c,telemetry:d}=Oe.n.getAnalyzeDataErrorResponse(l,e);s.$.getInstance().displayResponse(c,d,{shouldShowWhenFluxSkillResponseRequired:!1});const u=(0,K.N)(c);p(O.mF.sendSkillResponseToFlux(u,b.Aw.failed,d))}}}finally{(0,R.N6)(l,"evaluateQuery"),(0,R.NQ)("EvaluateQuery",performance.now()-y,l)}},Ze=async(e,t,a,n,o,r,i)=>{const l=await(0,f.x4)().generateResultForNaturalLanguage(e,t,i);let s={};return await(0,f.x4)().handleOperation(l.operationLocation,{nlEvaluationResult:async e=>{s=await(0,f.x4)().getGeneratedResultForNaturalLanguage(e,a,n,t.forceStaticAnswer,i)}},{nlEvaluationState:async e=>{e&&r(xt.setNLEvaluationState({requestId:o,nlEvaluationState:e}))}},i),s},et=e=>{switch(e){case"BlankPivotTable":case"ChartVisual":case"ForecastVisual":case"PivotChartVisual":case"PivotTableVisual":return(0,J.yw)("OfficeVSO_9364126_UpdateAnalyzeDataInsertResponse")?(0,n.zGM)():(0,n.FxF)();case"QueryResultVisual":case"TextAnalysisVisual":return;default:(0,A.x)(e)}};async function tt(e,t){const a=Y(e);return{locationKey:(0,F.MQ)(a),range:a,sheetName:await D.CP.ensureSheetName(t.sheetName,e.worksheetId)}}const at=(e,t,a)=>async(n,o)=>{if((0,J.tg)()&&D.CP.activeChart)return;a&&(0,R.in)(a,"resolveTableLikeEntity");const r=performance.now();try{const o=Boolean(!(0,J.yw)("OfficeVSO_8394820_UseForceRefreshToSkipTableLoading")||t),r=n(nt(e));if(r)return await n(rt(r,o,a));if(e.includes("!")&&(w.M.getInstance().logError({eventType:S.S.TabularRange,errorMessage:"Trying to resolve a table with a tabular-range-like name because TLR was not found in the cache",logLevel:m.$b.Warning},void 0,[{key:m.un.Stack,value:(new Error).stack??""}]),(0,J.tg)()))return;return await n(((e,t,a)=>async(n,o)=>{a&&(0,R.in)(a,"resolveTable");const r=performance.now(),{dataSourceApis:i,selectionContexts:l}=o().selection;if(t||!((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?l[e]:i[e]))try{const t=await xe({type:v.lp.StandardTable,name:e},a),{context:o,dataGenerator:r,localeDeprecated:i,theme:l}=t;if((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)){if(n(xt.setSelectionContext({context:o,tableName:e,localeCacheDeprecated:i,theme:l})),(0,J.yw)("OfficeVSO_9408436_SmallDataSourceApi"))n(it(e,a));else{const t=await r.next();if(!t.done){const a=t.value,i=Math.min((0,J.xy)("CalculatedColumnsMaxRows"),Math.floor((0,J.xy)("CalculatedColumnsMaxCells")/o.columnCount));return n(xt.setDataSourceApi({tableName:e,dataSourceApi:q(o.sheetId,{textRows:a.text.slice(0,i),valueRows:a.values.slice(0,i),formatRows:a.formats.slice(0,i),formulas:a.formulas?.slice(0,i)})})),ot(r,t.value)}}return r}{const a=await Ge(o,t.data);n(xt.setSelectionContext_DEPRECATED({tableName:e,selectionContextAndData:t,localeCacheDeprecated:i,theme:l})),n(xt.setDataSourceApi({tableName:e,dataSourceApi:a.dataSourceApi}))}}finally{a&&(0,R.N6)(a,"resolveTable"),(0,R.NQ)("ResolveTable",performance.now()-r,a)}else(0,z.cY)(`[resolveTable]: Skipping, ${e} already resolved`)})(e,o,a))}finally{(0,R.NQ)("ResolveTableLikeEntity",performance.now()-r,a),a&&(0,R.N6)(a,"resolveTableLikeEntity")}},nt=e=>(t,a)=>Object.values(a().selection.tabularRanges).flatMap(Object.values).find((t=>(0,F.$j)(e,t)));async function*ot(e,t){yield t;for await(const t of e)yield t}const rt=(e,t=!0,a)=>async(n,o)=>{a&&(0,R.in)(a,"resolveTabularRange");const r=performance.now();try{const{dataSourceApis:r,selectionContexts:i}=o().selection;if(!t&&e.name in((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?i:r))return void(0,z.cY)(`[resolveTabularRange]: skipping, ${e.name} already resolved`);const l={type:v.lp.TableLikeRange,name:e.name,sheetId:e.interpretation.location.worksheetId,showTotals:e.hasTotalRow,hasTableHeaders:e.interpretation.headerRowCount>0},s=await xe(l,a),{context:c,dataGenerator:d,localeDeprecated:u,theme:m}=s;if((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)){if(n(xt.setSelectionContext({tableName:e.name,context:c,localeCacheDeprecated:u,theme:m})),(0,J.yw)("OfficeVSO_9408436_SmallDataSourceApi"))n(it(e.name,a));else{const t=await d.next();if(!t.done){const a=t.value,o=Math.min((0,J.xy)("CalculatedColumnsMaxRows"),Math.floor((0,J.xy)("CalculatedColumnsMaxCells")/c.columnCount));return n(xt.setDataSourceApi({tableName:e.name,dataSourceApi:q(c.sheetId,{textRows:a.text.slice(0,o),valueRows:a.values.slice(0,o),formatRows:a.formats.slice(0,o),formulas:a.formulas?.slice(0,o)})})),ot(d,t.value)}}return d}{const t=await Ge(c,s.data);n(xt.setSelectionContext_DEPRECATED({tableName:e.name,selectionContextAndData:s,localeCacheDeprecated:u,theme:m})),n(xt.setDataSourceApi({tableName:e.name,dataSourceApi:t.dataSourceApi}))}}finally{(0,R.NQ)("ResolveTabularRange",performance.now()-r,a),a&&(0,R.N6)(a,"resolveTabularRange")}},it=(e,t)=>async(a,n)=>{const{dataSourceApis:o}=n().selection;if(o[e])return n().selection.dataSourceApis[e];const r=(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?await a(lt(e,t)):n().selection.selectionContexts[e],{sheetId:i,rowIndex:l,rowCount:s,columnIndex:c,columnCount:d}=r,{text:u,values:m,formats:g,formulas:h}=await async function(e,t,a,n,o,r){r&&(0,R.in)(r,"getSelectionDataForFormulas");const i=Date.now(),l=Math.min(de.entryLimit,Math.ceil(de.maxCellCount/a)),s=await Excel.run((async r=>{const i=r.workbook.worksheets.getItem(o),s=i.getRangeByIndexes(t,n,e,a),c=ge(s),d=be(i,Math.min(l,e),t,a,n);return await s.context.sync(),{...c(),formulas:d()}}));return(0,R.LV)(Date.now()-i,e,a),r&&(0,R.N6)(r,"getSelectionDataForFormulas"),s}(Math.min(s,(0,J.xy)("CalculatedColumnsMaxRows"),Math.floor((0,J.xy)("CalculatedColumnsMaxCells")/d)),l,d,c,i,t),p=q(i,{textRows:u,valueRows:m,formatRows:g,formulas:h});return a(xt.setDataSourceApi({tableName:e,dataSourceApi:p})),p},lt=(e,t)=>async(a,n)=>{let{selectionContexts:o}=n().selection;if(o[e])return n().selection.selectionContexts[e];if(await a(at(e,!0,t)),o=n().selection.selectionContexts,o[e])return n().selection.selectionContexts[e];throw new Error("getSelectionContextIfNeeded: SelectionContext not found for table name")},st=(e,t,a)=>async(r,i)=>{if(i().selection.isInserting)return Promise.resolve();r(xt.startInsertRecommendations());const c=performance.now(),d={recommendationData:[],isSuccessful:!1,failureLocation:u.lA.unknown,failureReason:""};r(O.mF.startExecutingAndLockContext(m.OP.InsertAnalyzeData));let g="",h="",p="";try{const o=await ct();g=o.previousActiveSheetId,h=o.dashboardSheetName,p=o.dashboardSheetId;const i=function(e){const t=new Set,a=["ChartVisual","PivotTableVisual","PivotChartVisual"],n=e.filter((e=>{if(!e.visual)return!1;if(e.id===De)return!1;const n=e.visual.visualType;if(!a.includes(n))return!1;if("ChartVisual"===n){const a=e.title;if(a){const e=(0,X.HW)(a);if(t.has(e))return!1;t.add(e)}}return!0}));return n}(t);await r(ut(i,h,p,e,d)),await r(O.mF.stopExecutingAndReleaseContextLock());const l=(0,N.L)((0,n.ax8)(),e),c=(0,J.tg)()?i.map((e=>et(e.visual.visualType))).reduce(((e,t)=>e||t),void 0):void 0,{message:m,telemetry:f}=Oe.n.getAnalyzeDataInsertSuccessResponse({messageText:l,tableContext:a,confirmationMessage:c,shouldShowGoBackToTableButton:!0});s.$.getInstance().displayResponse(m,f);const C=(0,K.N)(m);r(O.mF.sendSkillResponseToFlux(C,b.Aw.success,f)),r(xt.hideSelectionErrorOnSheet(h)),d.isSuccessful=!0,d.failureLocation=u.lA.none}catch(e){await r(O.mF.stopExecutingAndReleaseContextLock());let t=(0,n.OSb)();(0,J.yw)("OfficeVSO_9355779_NewInsertErrorString")&&(e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied?t=(0,n.V7x)():e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode&&(t=(0,n.WJg)()));const{message:a,telemetry:i}=Oe.n.getAnalyzeDataErrorResponse(t,m.q0.DashboardInsertFailed);s.$.getInstance().displayResponse(a,i,{shouldShowWhenFluxSkillResponseRequired:!1});const l=(0,K.N)(a);r(O.mF.sendSkillResponseToFlux(l,b.Aw.failed,i)),d.failureReason=e.message+(e.debugInfo?.errorLocation?` Location: ${e.debugInfo?.errorLocation}`:""),await Excel.run((async e=>dt(e,p,g))),w.M.getInstance().logErrorCode(o.O.InsertionCleanupFailed,e,S.S.AnalyzeDataError,m.$b.ASHA)}finally{r(xt.endInsertRecommendations()),(0,J.BT)()?C.B.getInstance().logKeptEvent(m.BJ.AnalyzeData,m.q.AnalyzeData,l.RX.Analyze):w.M.getInstance().logKeptEvent(m.q.AnalyzeData),w.M.getInstance().logEvent((0,m.SV)(m.he.SuggestionApplied,m.q.AnalyzeData,m.KZ.DashboardSuggestionPill,p)),(0,R.NQ)("InsertRecommendationsDashboard",performance.now()-c),(0,R.n5)(d)}},ct=async()=>{let e="",t="",a="";return await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet();n.workbook.worksheets.load("items"),await n.sync(),e=o.id;const r=(await(0,Fe.d)(n)()(n)).result;a=r.id,t=r.name})),{previousActiveSheetId:e,dashboardSheetName:t,dashboardSheetId:a}},dt=async(e,t,a)=>{if(t){a&&e.workbook.worksheets.getItemOrNullObject(a).activate();const n=e.workbook.worksheets.getItemOrNullObject(t);await e.sync(),n.isNullObject||n.delete()}},ut=(e,t,a,o,r)=>async function(i,l){const s=l().selection.interpretations[o],c=(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?l().selection.selectionContexts[o]:l().selection.selectionContexts_DEPRECATED[o].context;if(!c.sheetId)throw new Error("SheetId is not available in selection context");if(!c.sheetName)throw new Error("SheetName is not available in selection context");if(!c.address)throw new Error("Address is not available in selection context");const d=new y.N(c.sheetId,c.sheetName,c.address,!1,!1,c.tableName,c.rowIndex),{layoutPlacementsById:m,mainDataLocation:g,supportingDataLocation:h}=(0,u.zJ)(e,15);r.failureLocation=u.lA.findInterpretation,r.recommendationData=e.map((e=>{const{id:t}=e;return{id:t,type:e.visual.visualType,location:{chart:m[t].chart,pivotTable:m[t].pivotTable},pivotTableSizeData:mt(e.visual)}}));const p=e.map((e=>{const t=(0,Q.gD)(e,s);if(!t)throw i(O.mF.invalidateCurrentNLResult()),new Error(`insertAllRecommendationsCore: No interpretation for recommendation ${e.id}`);return{recommendation:e,interpretation:t,useTabularLayout:!0,useTableDataSource:!0,layoutPlacement:m[e.id]}}));r.failureLocation=u.lA.preFormatDashboardSheet,await async function(e,t,a){return Excel.run((async o=>{const r=o.workbook.worksheets.getItemOrNullObject(e);r.showGridlines=!1,r.getRange("A1").format.columnWidth=10,r.getRange("A1").format.rowHeight=10;const i=r.getRangeByIndexes(t.startRow-1,t.startColumn-1,t.rowCount+1,t.columnCount+1);if(i.format.fill.color=n.Ib6,i.format.columnWidth=n.NKv,a.rowCount&&a.columnCount){const e=a.startRow-2;r.getRangeByIndexes(e,a.startColumn,1,1).values=[[(0,n.PUb)()]];const o=r.getRangeByIndexes(e,1,1,Math.max(a.columnCount,t.columnCount+1));o.format.fill.color=n.Ib6,o.format.font.color=n.OXO,o.format.rowHeight=n.xqS,o.format.verticalAlignment="Center"}r.activate()}))}(a,g,h),r.failureLocation=u.lA.insertRecommendations,await(0,Pe.F5)((async e=>{await(0,L.q)(e,p,t,d,r),r.failureLocation=u.lA.postFormatDashboardSheet,await async function(e,t,a,o){const r=e.workbook.worksheets.getItemOrNullObject(t),i=r.getRangeByIndexes(a.startRow-1,a.startColumn-1,a.rowCount+1,a.columnCount+1);if(i.format.columnWidth=n.NKv,o.rowCount&&o.columnCount){const e=r.getRangeByIndexes(o.startRow,o.startColumn,o.rowCount,o.columnCount);e.format.wrapText=!0,e.format.rowHeight=15,e.format.verticalAlignment="Top"}}(e,a,g,h)})),r.failureLocation=u.lA.none};function mt(e){if("PivotTableVisual"!==e.visualType&&"PivotChartVisual"!==e.visualType)return;const t=e?.pivotTable,a={};for(const[e,n]of Object.entries(t))a[e]="number"==typeof n||void 0===n?n:"object"==typeof n?n.length:typeof n;return a}function gt(e){let t=e.explainToLLM;if(e.caveats&&e.caveats.length>0){const a=(e.caveats||[]).map((e=>e.code===h.T6.ChartTypeNotSupported||e.code===h.T6.ChartTypeNotAppropriate?(0,N.L)((0,n._)(),k(e.detail)):null)).find((e=>null!==e&&e.length>0))||(0,N.L)((0,n._)(),(0,n.HRg)());t=t?t+" "+a:a}return t}function ht(e,t){const{columnCount:a,columnIndex:n,rowCount:o,rowIndex:r}=e;return new d.pW({worksheetId:t,left:n+1,top:r+1,right:n+a,bottom:r+o})}function pt(e,t){delete e.evaluateQueryLocations[t],delete e.postRangesResults[t],delete e.postRangesRequestTypes[t],delete e.interpretations[t],delete e.suggestions[t],delete e.recommendations[t],delete e.generateResultForNLEvaluationLocations[t]}function bt(e,t){return t in e.postRangesResults}const ft=e=>{let t,a;switch(e){case h.M$.LLMThrottledError:t=(0,n.mRA)(),a=(0,n.fDp)();break;case h.M$.LLMHttpRequestError:case h.M$.LLMTimeout:case h.M$.LLMGenericError:t=(0,n.mRA)(),a=(0,n._Q4)();break;case h.M$.MissingFunctionality:case h.M$.VisualConversionError:case h.M$.UnsupportedTextAnalysisType:t=(0,n.$Sd)();break;case h.M$.ContentTooLarge:t=(0,n.NUW)();break;case h.M$.InvalidJsonFormat:case h.M$.InvalidAE:case h.M$.InvalidResponseType:case h.M$.MismatchedColumnName:case h.M$.TextAnalysisUnexpectedLLMResult:case h.M$.BlockedByRAI:case h.M$.UnsupportedExecution:case h.M$.SymbolicLogicException:case h.M$.AskForClarification:case h.M$.UnanswerableQuery:case h.M$.UnsupportedLanguage:t=(0,n.P6V)();break;default:t=(0,n.Rzj)()}return{errorMessage:t,explainToLLM:a}},Ct=(e,t)=>{let a,n;switch(e){case h.M$.LLMThrottledError:a=i.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,n=r.c.LLM_Throttled;break;case h.M$.LLMHttpRequestError:a=i.W.LLM_Service_Side_Issue_Prevents_Output,n=r.c.LLM_HTTP_Request_Error;break;case h.M$.LLMTimeout:a=i.W.LLM_Service_Side_Issue_Prevents_Output,n=r.c.Analyze_Data_LLM_Timeout;break;case h.M$.LLMGenericError:a=i.W.LLM_Service_Side_Issue_Prevents_Output,n=r.c.LLM_Service_Error;break;case h.M$.InvalidJsonFormat:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Json_Format;break;case h.M$.InvalidAE:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_AE_Generated;break;case h.M$.InvalidResponseType:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Response_Type;break;case h.M$.MismatchedColumnName:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Column_Name;break;case h.M$.TextAnalysisUnexpectedLLMResult:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Text_Analysis_Response;break;case h.M$.BlockedByRAI:a=i.W.Responsible_AI_Filter_Blocked_Response,n=r.c.RAI_Validation_Failed;break;case h.M$.SymbolicLogicException:a=i.W.Unable_To_Complete_Task,n=r.c.Failed_During_Prompt_Construction_Or_Postprocessing;break;case h.M$.AskForClarification:a=i.W.User_Input_Could_Not_Be_Processed,n=r.c.LLM_Thinks_Ambiguous;break;case h.M$.UnsupportedLanguage:a=i.W.Missing_Copilot_Functionality,n=r.c.Analyze_Data_Text_Analysis_Unsupported_Language;break;case h.M$.ContentTooLarge:case h.M$.UnsupportedTextAnalysisType:case h.M$.MissingFunctionality:a=i.W.Missing_Copilot_Functionality,n=r.c.Features_In_Development;break;case h.M$.VisualConversionError:a=i.W.Missing_Copilot_Functionality,n=r.c.Insights_Visual_Converter_Unsupported;break;case h.M$.UnsupportedExecution:a=i.W.Missing_Copilot_Functionality,n=r.c.AE_Execution_Unsupported;break;case h.M$.UnanswerableQuery:a=i.W.Missing_Copilot_Functionality,n=r.c.LLM_Identifies_UnanswerableQuery;break;default:a=t?i.W.Missing_Copilot_Functionality:i.W.Unable_To_Complete_Task,n=t?r.c.Failed_Insight_Generation_Due_To_Out_Of_Scope_Error:r.c.Failed_Insight_Generation_Due_To_Other_Error}w.M.getInstance().logStandardizedAshaErrorEvent(a,n,m.BJ.AnalyzeData)},yt=e=>{if(!e)return!1;switch(e){case h.M$.ContentTooLarge:case h.M$.MissingFunctionality:case h.M$.VisualConversionError:case h.M$.UnsupportedLanguage:case h.M$.UnanswerableQuery:case h.M$.UnsupportedExecution:case h.M$.UnsupportedTextAnalysisType:return!0;case h.M$.AskForClarification:case h.M$.LLMThrottledError:case h.M$.LLMHttpRequestError:case h.M$.LLMTimeout:case h.M$.LLMGenericError:case h.M$.InvalidJsonFormat:case h.M$.InvalidAE:case h.M$.InvalidResponseType:case h.M$.MismatchedColumnName:case h.M$.SymbolicLogicException:case h.M$.TextAnalysisUnexpectedLLMResult:case h.M$.BlockedByRAI:return!1;default:(0,A.x)(e)}},vt=e=>{if(e)switch(e){case h.M$.UnsupportedLanguage:return;case h.M$.VisualConversionError:return(0,n.IeI)();case h.M$.ContentTooLarge:case h.M$.MissingFunctionality:case h.M$.UnanswerableQuery:case h.M$.UnsupportedExecution:case h.M$.UnsupportedTextAnalysisType:return(0,n.dEi)();case h.M$.AskForClarification:case h.M$.LLMThrottledError:case h.M$.LLMHttpRequestError:case h.M$.LLMTimeout:case h.M$.LLMGenericError:case h.M$.InvalidJsonFormat:case h.M$.InvalidAE:case h.M$.InvalidResponseType:case h.M$.MismatchedColumnName:case h.M$.SymbolicLogicException:case h.M$.TextAnalysisUnexpectedLLMResult:case h.M$.BlockedByRAI:return;default:(0,A.x)(e)}},Tt=(0,V.Z0)({name:"selection",initialState:He,reducers:{clearExpiredRanges:(e,t)=>{pt(e,t.payload)},clearTable:(e,t)=>{delete e.dataSourceApis[t.payload],delete e.selectionContexts[t.payload],delete e.selectionContexts_DEPRECATED[t.payload],pt(e,t.payload),delete e.activeRequestId[t.payload]},setActiveTable:(e,t)=>{t.payload?(e.activeTable&&(e.lastActiveTable=e.activeTable),e.activeTable=t.payload):(e.lastActiveTable===e.activeTable&&(e.lastActiveTable=void 0),e.activeTable=void 0)},removeLastActiveTable:e=>{e.lastActiveTable=void 0},setDataSourceApi:(e,t)=>{e.dataSourceApis[t.payload.tableName]=t.payload.dataSourceApi},setSelectionContext:(e,t)=>{e.selectionContexts[t.payload.tableName]=t.payload.context,e.localeCacheDeprecated=t.payload.localeCacheDeprecated,e.themeColors=t.payload.theme},setSelectionContext_DEPRECATED:(e,t)=>{e.selectionContexts_DEPRECATED[t.payload.tableName]=t.payload.selectionContextAndData,e.localeCacheDeprecated=t.payload.localeCacheDeprecated,e.themeColors=t.payload.theme},setEvaluateQueryLocation:(e,t)=>{e.evaluateQueryLocations[t.payload.tableName]=t.payload.evaluateQueryLocation},postRangesSuccess:(e,t)=>{e.postRangesResults[t.payload.tableName]=t.payload.postRangesResult,e.postRangesRequestTypes[t.payload.tableName]||(e.postRangesRequestTypes[t.payload.tableName]=[]),e.postRangesRequestTypes[t.payload.tableName].includes(t.payload.requestType)||e.postRangesRequestTypes[t.payload.tableName].push(t.payload.requestType)},generateResultsSuccess:(e,t)=>{e.postRangesRequestTypes[t.payload.tableName].includes(t.payload.requestType)||e.postRangesRequestTypes[t.payload.tableName].push(t.payload.requestType),e.postRangesResults[t.payload.tableName].operationId=t.payload.generateResultsResult.operationId,e.postRangesResults[t.payload.tableName].operationLocation=t.payload.generateResultsResult.operationLocation},getInterpretationsSuccess:(e,t)=>{e.interpretations[t.payload.tableName]?e.interpretations[t.payload.tableName].push(...t.payload.result.interpretations):e.interpretations[t.payload.tableName]=t.payload.result.interpretations},getRecommendationsSuccess:(e,t)=>{e.recommendations[t.payload.tableName]=t.payload.recommendations},getNLContextSuccess:(e,t)=>{e.evaluateQueryLocations[t.payload.tableName]=t.payload.contextResponse.evaluateQueryLocation,qe&&(e.generateResultForNLEvaluationLocations[t.payload.tableName]=t.payload.contextResponse.generateResultForNLEvaluationLocation),e.suggestions[t.payload.tableName]=t.payload.contextResponse.suggestedQueries?.suggestions??[]},setSelectionError:(e,t)=>{e.selectionError=t.payload,void 0===t.payload&&(e.hideSelectionErrorOnSheet=void 0,e.hideSelectionErrorOnRange=void 0)},hideSelectionErrorOnSheet:(e,t)=>{(0,J.QE)()&&(e.hideSelectionErrorOnSheet=t.payload)},hideSelectionErrorOnRange:(e,t)=>{e.hideSelectionErrorOnRange=t.payload},startInsertRecommendations(e){e.isInserting=!0},endInsertRecommendations(e){e.isInserting=!1},setIsAllowRewrite(e,t){e.isAllowRewrite=t.payload},resetIsAllowRewrite(e){e.isAllowRewrite=$e},setActiveRequestId:(e,t)=>{e.activeRequestId[t.payload.tableName]=t.payload.activeRequestId,e.requestState[t.payload.activeRequestId]="pending"},evaluateQuerySuccess:(e,t)=>{e.requestState[t.payload]="success"},evaluateQueryFailed:(e,t)=>{e.requestState[t.payload]="failed"},setIsPermanentError:(e,t)=>{e.isPermanentError=t.payload},setIsWorksheetProtected:(e,t)=>{e.isWorksheetProtected=t.payload},setIsWorksheet:(e,t)=>{e.isWorksheet=t.payload},setIsWorkbookAutoSaved:(e,t)=>{e.isWorkbookAutoSaveOn=t.payload},getNLContextRequest:(e,t)=>{e.pendingNLContextFetches.push(t.payload)},getNLContextFinished:(e,t)=>{e.pendingNLContextFetches=e.pendingNLContextFetches.filter((e=>e!==t.payload))},cacheTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo=(0,P.cloneDeep)(e.tabularRanges)},restoreTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo&&(e.tabularRanges=e.cachedTabularRangesForUndo),e.cachedTabularRangesForUndo=void 0},clearCachedTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo=void 0},updateTableInterpretationsForSheet:(e,t)=>{e.tabularRanges[t.payload.sheetId]=t.payload.newInterpretations},updateExcelRecognizedTableCache:(e,t)=>{""!==e.excelRecognizedTablesAnnotationsCacheRevisionId&&e.excelRecognizedTablesAnnotationsCacheRevisionId===t.payload.revisionId||(e.excelRecognizedTablesAnnotationsCache=[],e.excelRecognizedTablesAnnotationsCacheRevisionId=t.payload.revisionId),e.excelRecognizedTablesAnnotationsCache.push(t.payload.recognizedTable)},setTextAnalysisCardProps:(e,t)=>{e.textAnalysisCardProps=t.payload.props},setNLEvaluationState:(e,t)=>{e.nlEvaluationStates[t.payload.requestId]=t.payload.nlEvaluationState}}}),xt={handleTableDeleted:e=>async(t,a)=>{const{activeTable:n,lastActiveTable:o}=a().selection;n&&n.name===e?(t(xt.setSelectionError("NOTHING_SELECTED")),t(xt.clearTable(n.name)),t(xt.setActiveTable(void 0))):(o&&o.name===e&&t(xt.removeLastActiveTable()),t(xt.clearTable(e)),t(O.mF.invalidateCurrentNLResult()))},updateActiveTable:e=>async(t,a)=>{const{activeTable:n,lastActiveTable:o}=a().selection;!(0,J.ge)()&&e&&(n&&n.name!==e.name||!n&&o?.name!==e.name)&&t(O.mF.showZeroStateSuggestionList()),t(xt.setActiveTable(e))},updateTableLikeEntity:e=>async t=>{const{type:a,table:n}=e;if(a!==v.lp.Range)try{await t(xt.getNLContextIfNeeded(n.name))}catch(e){e instanceof Error&&e.message===o.O.GetInterpretationsFailed?w.M.getInstance().logErrorCode(o.O.GetInterpretationsFailed,e,S.S.AnalyzeDataError,m.$b.ASHA):w.M.getInstance().logErrorCode(o.O.GetNLContextFailed,e,S.S.AnalyzeDataError,m.$b.ASHA)}},resolveTableLikeEntity:at,resolveTableLikeEntityIfNeeded:(e,t,a)=>async(n,o)=>{if(!o().chat.isCurrentNLResultValid&&e?.tableLikeRangeFeatures!==T.ye.Unrecognized)return n(at(e.name,t,a))},getIsModelWorkflowUnsupported:()=>(e,t)=>t().app.augloopModelWorkflowUnsupported,getInsights:(e,t,a,n,r)=>async(i,l)=>i(Xe(e,t,n,o.O.GetInsightsFailed,!0,(async o=>{const s=()=>"failed"===l().selection.requestState[n];await i(Ye(e,n,s)),s()||await i(Ke(e,t,a,n,o,s,!1,r))}))),getNLContextIfNeeded:Ye,getTabularRangeInterpretationFromName:nt,insertRecommmendation:(e,t,a)=>async(c,d)=>{try{(0,J.BT)()?C.B.getInstance().logKeptEvent(m.BJ.AnalyzeData,m.q.AnalyzeData,l.RX.Analyze):w.M.getInstance().logKeptEvent(m.q.AnalyzeData),w.M.getInstance().logEvent((0,m.SV)(m.he.SuggestionApplied,m.q.AnalyzeData,m.KZ.AddButton,t.id));const o="TextAnalysisVisual"===t.visual.visualType,r="ChartVisual"===t.visual.visualType||o?(0,n.zVb)():(0,n.W4k)(),{message:i,telemetry:u}=Oe.n.getAnalyzeDataInsertUserChat(r);s.$.getInstance().displayResponse(i,u),c(O.mF.startExecutingAndLockContext(m.OP.InsertAnalyzeData));const g=(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?d().selection.selectionContexts[e]:d().selection.selectionContexts_DEPRECATED[e].context,h=(0,Q.gD)(t,d().selection.interpretations[e]);if(!g.sheetId)throw new Error("SheetId is not available in selection context");if(!g.sheetName)throw new Error("SheetName is not available in selection context");if(!g.address)throw new Error("Address is not available in selection context");const p=new y.N(g.sheetId,g.sheetName,g.address,!1,!1,g.tableName,g.rowIndex),f="TextAnalysisVisual"===t.visual.visualType?`Column ${t.visual.textAnalysisResult.columnName}_${t.visual.textAnalysisResult.analysisType}`:t.title?.runs.map((e=>e.text)).join(""),v=await(0,L.h7)(t,p,h,!0,!0,!0);(0,L.Ns)(v,[],((e,a)=>(("Sheet"===a&&e===v.sheetId||e===v.objectId)&&(w.M.getInstance().logRejectedEvent(m.q.AnalyzeData,t.id),w.M.getInstance().logEvent((0,m.SV)(m.he.Deleted,m.q.AnalyzeData,m.KZ.GridAction,t.id))),Promise.resolve()))),await c(O.mF.stopExecutingAndReleaseContextLock());const T=(0,N.L)((0,n.mjl)(),f,v.sheetName),{message:x,telemetry:S}=Oe.n.getAnalyzeDataInsertSuccessResponse({messageText:T,tableContext:a,confirmationMessage:(0,J.tg)()?et(t.visual.visualType):void 0,suggestionId:t.id,shouldShowGoBackToTableButton:"TextAnalysisVisual"!==t.visual.visualType});s.$.getInstance().displayResponse(x,S),o&&(c(xt.clearTable(e)),await c(xt.resolveTableLikeEntity(e,!0)));const E=(0,K.N)(i);c(O.mF.sendSkillResponseToFlux(E,b.Aw.success,u)),v.sheetName&&c(xt.hideSelectionErrorOnSheet(v.sheetName))}catch(e){if(await c(O.mF.stopExecutingAndReleaseContextLock()),w.M.getInstance().logErrorCode(o.O.InsertionFailed,e,S.S.AnalyzeDataError,m.$b.ASHA),e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied){w.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_Protection_Settings,m.BJ.AnalyzeData);const{message:e,telemetry:t}=Oe.n.getAnalyzeDataErrorResponse((0,n.V7x)());s.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,K.N)(e);c(O.mF.sendSkillResponseToFlux(a,b.Aw.failed,t))}else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode){w.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_User_Edits,m.BJ.AnalyzeData);const{message:e,telemetry:t}=Oe.n.getAnalyzeDataErrorResponse((0,n.WJg)());s.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,K.N)(e);c(O.mF.sendSkillResponseToFlux(a,b.Aw.failed,t))}else{w.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Failed_Insight_Insertion,m.BJ.AnalyzeData);const{message:e,telemetry:t}=Oe.n.getAnalyzeDataErrorResponse((0,J.yw)("OfficeVSO_9355779_NewInsertErrorString")?(0,n.OSb)():(0,n.Hum)());s.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,K.N)(e);c(O.mF.sendSkillResponseToFlux(a,b.Aw.failed,t))}}},insertAllRecommendations:st,insertAllCurrentChartRecos:()=>(e,t)=>{const a=D.CP.getActiveTable(),n=a?.name;if(!a||!n)return;const o=t().chat.currentRecos||[];e(st(n,o,a))},insertAllCurrentRecommendations:()=>(e,t)=>{const a=D.CP.getActiveTable(),n=a?.name;if(!a||!n)return;const o=t().chat.currentNLResult?.visualAnswer||[];e(st(n,o,a))},onExcelRecognizedTableAnnotationReceived:(e,t)=>async(a,n)=>{let r,i,l,s,d={},u="";if(t?({coauthVersionDocId:i,coauthVersionXluid:l,coauthVersionXrevId:s}=JSON.parse(t)):w.M.getInstance().logErrorCode(o.O.TLRRevisionError,(0,m.Jr)("parentRevId is undefined"),S.S.TabularRange,m.$b.Warning),i||l||s){u=`${i}.${l}.${s}`}else w.M.getInstance().logErrorCode(o.O.TLRRevisionError,(0,m.Jr)("revisionWaterline is undefined"),S.S.TabularRange,m.$b.Warning);(0,J._m)()&&a(xt.updateExcelRecognizedTableCache({revisionId:u,recognizedTable:e}));const g=e.range.worksheetId;if(x.E.getInstance().logTableRecognized(),(0,J.tg)())({newInterpretations:d,range:r}=await(async(e,t)=>{const a={};let n;if(!e.tableName){if((0,J.yw)("OfficeVSO_9265661_lowConfidenceTLR")&&e.interpretations.length>2){const n=e.interpretations[0],o=n.location;let{unsupportedFeatures:r,hasTotalRow:i}=(0,F.bp)(n,e);r|=T.ye.LowInterpretationConfidence;const{locationKey:l,range:s,sheetName:c}=await tt(o,e);return a[l]={name:(0,G.Jm)(c,o),interpretation:n,hasMergedCells:e.hasMergedcells??!1,range:s,revisionWaterline:t,unsupportedFeatures:r,hasTotalRow:i},{newInterpretations:a,range:s}}for(const o of e.interpretations)if(o.confidence>=.75||.5===o.confidence&&"columnMajor"===o.orientation){const{unsupportedFeatures:r,hasTotalRow:i}=(0,F.bp)(o,e),l=o.location;let s,c;({sheetName:c,range:n,locationKey:s}=await tt(l,e)),a[s]={name:(0,G.Jm)(c,l),interpretation:o,hasMergedCells:e.hasMergedcells??!1,range:n,revisionWaterline:t,unsupportedFeatures:r,hasTotalRow:i};break}}return{newInterpretations:a,range:n}})(e,u));else if(!e.hasMergedcells&&!e.tableName)for(const t of e.interpretations){let a=t.location,n=0===(t.aggregationLines?.length??0);const o=1===t.aggregationLines?.length,i=e.primaryTable?.hasTotalRow??!1;if(o&&i&&(a={...t.location,bottom:t.location.bottom-1},n=!0),t.confidence>=.75&&"columnMajor"===t.orientation&&(1===t.headerRowCount||Ue&&0===t.headerRowCount)&&0===t.headerColumnCount&&n){if(t.headerNames){if(new Set(t.headerNames.map((e=>e.toLowerCase()))).size!==a.right-a.left+1)continue}r=Y(a);const n=(0,F.MQ)(r),o=await D.CP.ensureSheetName(e.sheetName,a.worksheetId);d[n]={name:(0,G.Jm)(o,a),interpretation:{...t,location:a},hasMergedCells:e.hasMergedcells??!1,range:r,revisionWaterline:u,unsupportedFeatures:T.ye.None,hasTotalRow:!1};break}}const h=n().selection.tabularRanges[g]??{};for(const[e,t]of Object.entries(h))(0,J.yw)("OfficeVSO_9489615_ClearStateSelectionTableOnNewXlimAnnotation")&&r&&t.range&&c.ExcelCalc.IExcelRangeIntersect(r,t.range)&&a(xt.clearTable(t.name)),t.revisionWaterline===u&&(d[e]=t,!(0,J.yw)("OfficeVSO_9489615_ClearStateSelectionTableOnNewXlimAnnotation")&&r&&t.range&&c.ExcelCalc.IExcelRangeIntersect(r,t.range)&&a(xt.clearTable(t.name)));a(xt.updateTableInterpretationsForSheet({sheetId:g,newInterpretations:d})),e.tableName||g!==D.CP.getActiveWorksheetId()||await D.CP.refreshSelectionContext()},extendTabularRangeInterpretation:(e,t,a)=>async(n,o)=>{const r=a.map((e=>c.ExcelCalc.addressToExcelRange((0,ae.r)(e))));if(r.some((e=>!(0,F.M$)(e))))return;const i=o().selection.tabularRanges[e]??{},l=(0,F.py)(t),s=i[l];if(!s)return;const d=s.range,u=r.map((e=>(0,_._)(d,e)));if(1!==Math.min(...u))return;const m=(0,F.GT)([d,...r]),g=(0,F.OK)(m,o().selection.tabularRanges[e]??{},l,e);n(xt.updateTableInterpretationsForSheet({sheetId:e,newInterpretations:g}))},getRangeIntersectingTabularRangeMetadata:(e,t)=>(a,n)=>{const o=n().selection.tabularRanges[e];if(!o)return[];const r=(0,ne.E)(t);return Object.values(o).filter((e=>{const t=Y(e.interpretation.location);return c.ExcelCalc.IExcelRangeIntersect(r,t)}))},getTabularRangeMetadataFromRange:(e,t)=>(a,n)=>{const o=n().selection.tabularRanges[e];if(!o)return;const r=(0,ne.E)(t);let i;const l=n().selection.hideSelectionErrorOnRange;for(const e of Object.values(o)){const t=e.name,a=Y(e.interpretation.location);if(c.ExcelCalc.IExcelRangeContainedIn(r,a))return{name:t,tabularRange:e,distance:0};if((0,J.qm)()||l){if(c.ExcelCalc.IExcelRangeIntersect(r,a))return{name:t,tabularRange:e,distance:0};{const n=(0,_._)(r,a);(!i||n<i.distance)&&(i={name:t,tabularRange:e,distance:n})}}}return i},getChartCache:e=>(t,a)=>{const n=a().selection.selectionContexts_DEPRECATED[e];if((0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?a().selection.selectionContexts[e]:n)return{localeCacheDeprecated:(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?a().selection.localeCacheDeprecated:n.localeDeprecated,theme:(0,J.iP)("Microsoft.Office.Excel.FA000000124.CopilotInsightsStreaming",!1)?a().selection.themeColors:n.theme}},getRecommendations:(e,t,a,r)=>async(i,l)=>{await i(Xe(e,t,a,"ChartReco"===r?o.O.GetChartRecoFailed:o.O.GetPivotTableRecoFailed,!1,(async()=>{await i(je(e,(()=>"failed"===l().selection.requestState[a]),a,r,!0))})));const c=l().selection.recommendations[e];if(c&&c.length>0){i(O.mF.setCurrentRecos(c,r));const n=c[0],{message:o,telemetry:l}=Oe.n.getAnalyzeDataRecommendationResponse({visual:n,requestId:a,responseText:"",tableName:e,tableContext:t});s.$.getInstance().displayResponse(o,l)}else{const{message:e,telemetry:t}=Oe.n.getAnalyzeDataErrorResponse((0,n.S5F)(),m.q0.NoSuggestions);s.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1})}},showPreviewData:(e,t,a)=>async(n,o)=>{try{const n=a.sheetRange.sheet,o=a.sheetRange.range.topLeft.row,r=a.sheetRange.range.bottomRight.column+1;await Excel.run((async a=>{const i=a.workbook.worksheets.getItem(n);i.activate();const l=i.rangeValuesPreview,s=c.ExcelCalc.IExcelRangeToAddress({topLeft:{row:o,column:r},bottomRight:{row:o,column:r}});l.show(s,[t,...e],{autoexpandTable:!0,autofitColumns:!1}),await a.sync()}))}catch(e){w.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Preview_On_Grid_Failed_To_Display,m.BJ.AnalyzeData)}},hidePreviewData:e=>async(t,a)=>{try{const t=e.sheetRange.sheet;await Excel.run((async e=>{e.workbook.worksheets.getItem(t).rangeValuesPreview.dismiss(),await e.sync()}))}catch(e){w.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Preview_On_Grid_Failed_To_Display,m.BJ.AnalyzeData)}},showTextAnalysisRecommendationCard:e=>async(t,a)=>{const n=a().selection.textAnalysisCardProps;if(n&&n.visual.id===e){const{message:e,telemetry:a}=Oe.n.getAnalyzeDataRecommendationResponse(n);s.$.getInstance().displayResponse(e,a),t(xt.setTextAnalysisCardProps({props:void 0})),t(O.mF.stopExecutingAndReleaseContextLock())}},updateTabularRangeInterpretation:(e,t,a)=>(n,o)=>{const r=o().selection.tabularRanges[e]??{},i=(0,F.f_)(t,r,a);n(xt.updateTableInterpretationsForSheet({sheetId:e,newInterpretations:i}))},clearTablesOnSheet:e=>async(t,a)=>{const n=a().selection.selectionContexts;for(const a in n)n[a].sheetId===e&&t(xt.clearTable(a))},getDataSourceApiIfNeeded:it,...Tt.actions},{reducer:St}=Tt},35893:(e,t,a)=>{a.d(t,{F:()=>d,g:()=>c});var n=a(55683),o=a(6925),r=a(20106),i=a(24180),l=a(78640),s=a(72763);const c={app:n.Ff,chat:o.Ff,dataAI:i.F,selection:l.Ff,telemetry:s.F},d=(0,r.Nc)()},72763:(e,t,a)=>{a.d(t,{F:()=>c,m:()=>s});var n=a(20106),o=a(61150);const r={alSessionKey:void 0,sydneyConversationId:void 0,sydneyEndpoint:void 0,queryMetrics:{}},i=(e,t)=>(e[t]||((0,o.cY)(`Creating new telemetry entry for query ${t}`),e[t]={metrics:[]}),e[t]),l=(0,n.Z0)({name:"telemetry",initialState:r,reducers:{addQueryMetrics(e,t){const{queryId:a,metrics:n}=t.payload,o=i(e.queryMetrics,a),r=n.filter((e=>(e=>!e.serviceName?.startsWith("ExtensionRunner:ext:")&&!(!e.input||!e.output)&&("PolymerLLMImprovedNetworking"===e.serviceName||"DeepLeoImprovedNetworking"===e.serviceName||e.isUsed))(e))).filter((e=>((e,t)=>{const a=e.tags?.find((e=>e?.startsWith("unique-id-")));return!a||!t.some((e=>e.tags.includes(a)))})(e,o.metrics)));o.metrics.push(...r)},setAugLoopSessionKey(e,t){e.alSessionKey=t.payload},setSydneyConversationId(e,t){e.sydneyConversationId=t.payload},setSydneyEndpoint(e,t){e.sydneyEndpoint=t.payload},setQueryUserUtterance(e,t){const{queryId:a,userUtterance:n}=t.payload;i(e.queryMetrics,a).userUtterance=n}}}),s={...l.actions},{reducer:c}=l},91259:(e,t,a)=>{function n(e,...t){return e.replace(/{(\d+)}/gm,((e,a)=>{const n=parseInt(a,10);return t[n]?t[n]:""}))}a.d(t,{L:()=>n})},52978:(e,t,a)=>{e.exports=a.p+"assets/dislike-icon.svg"},24815:(e,t,a)=>{e.exports=a.p+"assets/information-icon.svg"},69336:(e,t,a)=>{e.exports=a.p+"assets/like-icon.svg"},50501:(e,t,a)=>{e.exports=a.p+"assets/mic-permission-dialog.svg"},67176:(e,t,a)=>{e.exports=a.p+"assets/send-button-icon.svg"},31531:e=>{if("undefined"==typeof perf_hooks){var t=new Error("Cannot find module 'perf_hooks'");throw t.code="MODULE_NOT_FOUND",t}e.exports=perf_hooks},54947:e=>{e.exports=JSON.parse('{"G":{"O":"to whole table"}}')},31137:e=>{e.exports=JSON.parse('{"Intents":{"AllowEditRangeAddedLabel":"Add unlocked range ${range}","_AllowEditRangeAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","AllowEditRangeDeletedLabel":"I deleted the unlocked range ${range}","_AllowEditRangeDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","AllowEditRangeEditedLabel":"I edited the unlocked range ${range}","_AllowEditRangeEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","ArtPasteSameWorkbookLabel":"Paste art on sheet ${sheet}","_ArtPasteSameWorkbookLabel.comment":"Text to show in a list when a paste art on same workbook user action was taken during script recording","CellFindContainingLabel":"Find cell containing \'${search}\'","_CellFindContainingLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.","ChartFormatSetGetPropertiesLabel":"${count} format changes were applied to ${chartName}.","_ChartFormatSetGetPropertiesLabel.comment":"The intent shown when two or more chart formats were changed in a batch request.","ChartSeriesDeleteLabel":"I deleted the series ${seriesIndex} from chart ${chartName} on sheet ${sheet}","_ChartSeriesDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartSeriesDataChangedLabel":"I changed the data of series ${seriesIndex} of chart ${chartName}","ChartSeriesDataChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentDeleteLabel":"I deleted the comment","_CommentDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentDeleteReplyLabel":"I deleted the reply","_CommentDeleteReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentEditLabel":"I edited the comment","_CommentEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentEditReplyLabel":"I edited the reply","_CommentEditReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentInsertLabel":"I inserted a comment","_CommentInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentInsertReplyLabel":"I inserted a reply","_CommentInsertReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${range} where ${cellValueCriteria}.","_ConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} where ${cellValueCriteria}.","_TableRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} body where ${cellValueCriteria}.","_TableBodyRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} header row where ${cellValueCriteria}.","_TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} total row where ${cellValueCriteria}.","_TableTotalRowRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} sub-range of table ${tableName} where ${cellValueCriteria}.","_TableGeneralRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${count} row(s) in table ${tableName} where ${cellValueCriteria}.","_TableRowsRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} row at index ${rowIndex} in table ${tableName} where ${cellValueCriteria}.","TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${count} column(s) in table ${tableName} where ${cellValueCriteria}.","_TableColumnsRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} column \'${columnName}\' in table ${tableName} where ${cellValueCriteria}.","_TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} the column at index ${columnIndex} in table ${tableName} where ${cellValueCriteria}.","_TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} the column(s) \'${columnName}\' where ${cellValueCriteria}.","_ColumnNameConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${range} with formula ${customFormula}.","_ConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} with formula ${customFormula}.","_TableRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} body with formula ${customFormula}.","_TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} header row with formula ${customFormula}.","_TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} total row with formula ${customFormula}.","_TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} sub-range of table ${tableName} with formula ${customFormula}.","_TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${count} row(s) in table ${tableName} with formula ${customFormula}.","_TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} row at index ${rowIndex} in table ${tableName} with formula ${customFormula}.","TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${count} column(s) in table ${tableName} with formula ${customFormula}.","_TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} column \'${columnName}\' in table ${tableName} with formula ${customFormula}.","_TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} the column at index ${columnIndex} in table ${tableName} with formula ${customFormula}.","_TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} the column(s) \'${columnName}\' with formula ${customFormula}.","_ColumnNameConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${range} that ${textComparisonCriteria}.","_ConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} that ${textComparisonCriteria}.","_TableRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} body that ${textComparisonCriteria}.","_TableBodyRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} header row that ${textComparisonCriteria}.","_TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} total row that ${textComparisonCriteria}.","_TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in sub-range of table ${tableName} that ${textComparisonCriteria}.","_TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${count} row(s) in table ${tableName} that ${textComparisonCriteria}.","_TableRowsRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in row at index ${rowIndex} in table ${tableName} that ${textComparisonCriteria}.","TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${count} column(s) in table ${tableName} that ${textComparisonCriteria}.","_TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in column \'${columnName}\' in table ${tableName} that ${textComparisonCriteria}.","_TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in the column at index ${columnIndex} in table ${tableName} that ${textComparisonCriteria}.","_TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in the column(s) \'${columnName}\' that ${textComparisonCriteria}.","_ColumnConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${range}.","_ConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName}.","_TableRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} body.","_TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${range}.","_ConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName}.","_TableRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} body.","_TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${range}.","_ConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName}.","_TableRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} body.","_TableBodyRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${range}.","_ConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName}.","_TableRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} body.","_TableBodyRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${range}.","_ConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName}.","_TableRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} body.","_TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${range}.","_ConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName}.","_TableRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} body.","_TableBodyRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${range} for values that are ${presetCriterion}.","_ConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} for values that are ${presetCriterion}.","_TableRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} body for values that are ${presetCriterion}.","_TableBodyRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} header row for values that are ${presetCriterion}.","_TableHeaderRowRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} total row for values that are ${presetCriterion}.","_TableTotalRowRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} sub-range of table ${tableName} for values that are ${presetCriterion}.","_TableGeneralRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${count} row(s) in table ${tableName} for values that are ${presetCriterion}.","_TableRowsRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} row at index ${rowIndex} in table ${tableName} for values that are ${presetCriterion}.","TableRowByIndexRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${count} column(s) in table ${tableName}. for values that are ${presetCriterion}","_TableColumnsRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} column \'${columnName}\' in table ${tableName} for values that are ${presetCriterion}.","_TableColumnByNameRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} the column at index ${columnIndex} in table ${tableName} for values that are ${presetCriterion}.","_TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} the column(s) \'${columnName}\' for values that are ${presetCriterion}.","_ColumnNameConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${range}","_ConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName}","_TableRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} body","_TableBodyRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} header row","_TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} total row","_TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on sub-range of table ${tableName}","_TableGeneralRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${count} row(s) in table ${tableName}","_TableRowsRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${count} column(s) in table ${tableName}","_TableColumnsRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingCreatedGroupTypeEventLabel":"I created a ${type} conditional formatting rule on ${range}","_ConditionalFormattingCreatedGroupTypeEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingEditedGroupEventLabel":"I edited the conditional formatting on sheet ${sheet}","_ConditionalFormattingEditedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingRuleDeletedLabel":"I cleared the conditional formatting rule on ${range}","_ConditionalFormattingRuleDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${range}","_ConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName}.","_TableRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} body.","_TableBodyRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","CreateNamedItem":"I created a named item","_CreateNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","SetNamedItem":"I set the named item","_SetNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","DeleteNamedItem":"I deleted the named item","_DeleteNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","ErrorAliasInfo":"This object\'s actions cannot be recorded right now. Try restarting the recorder and execute the action again.","_ErrorAliasInfo.comment":"User-facing string describing an error that occurs when a user creates an object during a recording session that we don\'t understand.","ErrorUnknown":"Oops! An unexpected error occurred while recording this action. Try restarting the recorder and execute the action again.","_ErrorUnknown.comment":"User-facing string describing an error case we don\'t know about.","ExternalLinksRefreshedLabel":"Refresh a linked Workbook","_ExternalLinksRefreshedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksRefreshedAllLabel":"Refresh all linked workbooks","_ExternalLinksRefreshedAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksBrokeLinkLabel":"Break a linked workbook","_ExternalLinksBrokeLinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksBrokeAllLinksLabel":"Break all linked workbooks","_ExternalLinksBrokeAllLinksLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksSetAutoRefreshLabel":"I set the auto refresh for workbook links","_ExternalLinksSetAutoRefreshLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksChangedSourceLabel":"I changed the source for a linked workbook","_ExternalLinksChangedSourceLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutAddedToPrintAreaLabel":"Added to print area label in page setup","_PageLayoutAddedToPrintAreaLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutOrientationChangedLabel":"I changed the page setup orientation","_PageLayoutOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreakInsertedLabel":"I inserted a page break in page setup","_PageLayoutPageBreakInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreakRemovedLabel":"I removed the page break in page setup","_PageLayoutPageBreakRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreaksAllResetLabel":"Reset all page breaks in page setup","_PageLayoutPageBreaksAllResetLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPaperSizeChangedLabel":"I changed the page setup paper size","_PageLayoutPaperSizeChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintAreaClearedLabel":"I cleared the page setup print area","_PageLayoutPrintAreaClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintAreaSetLabel":"I set the page setup print area","_PageLayoutPrintAreaSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintSettingsChangedLabel":"I changed the page setup print setting","_PageLayoutPrintSettingsChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutScalingChangedLabel":"I changed the page setup scaling","_PageLayoutScalingChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","InProgressEventLabel":"This action is coming soon","_InProgressEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PictureInsertedEventLabel":"I inserted a picture on sheet ${sheet}","_PictureInsertedEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PivotChartCreateLabel":"I created a pivot chart","_PivotChartCreateLabel.comment":"Text to show in a list when a create pivot chart user action was taken during script recording","PivotTableCreateLabel":"I created a pivot table","_PivotTableCreateLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableSortLabel":"I sorted the  pivot table","_PivotTableSortLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableChangePositionLabel":"I changed the pivot table position","_PivotTableChangePositionLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableRefreshLabel":"Refresh pivot table ${pivotName}","_PivotTableRefreshLabel.comment":"Text to show in a list when a refresh pivot table user action was taken during script recording","PivotDrillExpandedLabel":"Expanded pivot item ${pivotItem} for pivot table ${pivotName}","_PivotDrillExpandedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotItem variable/placeholder is replaced by the name of the item being expanded.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotDrillCollapsedLabel":"Collapse pivot item ${pivotItem} for pivot table ${pivotName}","_PivotDrillCollapsedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotItem variable/placeholder is replaced by the name of the item being collapsed.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRenamedLabel":"Rename pivot table to ${newName}","_PivotTableRenamedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and newName variable/placeholder is replaced by the new name of the pivot table.","PivotTableRowGrandTotalShownLabel":"Show row grand totals for pivot table ${pivotName}","_PivotTableRowGrandTotalShownLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRowGrandTotalHiddenLabel":"I hid the row grand totals for pivot table ${pivotName}","_PivotTableRowGrandTotalHiddenLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableColumnGrandTotalShownLabel":"Show column grand totals for pivot table ${pivotName}","_PivotTableColumnGrandTotalShownLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableColumnGrandTotalHiddenLabel":"I hid the column(s) grand totals for pivot table ${pivotName}","_PivotTableColumnGrandTotalHiddenLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableAutoFitColumnWidthsOnRefreshToggledLabel":"I set the auto-fit of column widths for pivot table ${pivotName} to ${value}","_PivotTableAutoFitColumnWidthsOnRefreshToggledLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.  The $ and value variable/placeholder is replaced by true or false","PivotTableSubTotalsVisibilitySettingSetLabel":"Visibility of subtotals changed for pivot table ${pivotName}","_PivotTableSubTotalsVisibilitySettingSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableLayoutTypeSetLabel":"Layout type of pivot table ${pivotName} changed","_PivotTableLayoutTypeSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableChangeLabel":"I changed the fields for pivot table ${pivotName}","_PivotTableChangeLabel.comment":"Text to show in a list when a change pivot table user action was taken during script recording","PivotTableAddPivot":"Added pivot for pivot table ${pivotName}","_PivotTableAddPivot.comment":"Text to show in a list when a add pivot to pivot table user action was taken during script recording. The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRemovePivot":"I removed the pivot for pivot table ${pivotName}","_PivotTableRemovePivot.comment":"Text to show in a list when a add pivot to pivot table user action was taken during script recording. The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","RangeAutoSumLabel":"I applied autosum to ${range}","_RangeAutoSumLabel.comment":"Text to show in a list when a range autosum user action was taken during script recording","RangeApplyBorderLabel":"I changed the border on ${range}","_RangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameApplyBorderLabel":"I changed the border on the column(s) \'${columnName}\'","_ColumnNameApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","SheetProtectionProtectedLabel":"Protect sheet ${sheet}","_SheetProtectionProtected.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionUnprotectedLabel":"Unprotect sheet ${sheet}","_SheetProtectionUnprotected.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionPasswordUpdatedLabel":"Update sheet password on sheet ${sheet}","_SheetProtectionPasswordUpdated.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionOptionsUpdatedLabel":"Update sheet protection option on sheet ${sheet}","_SheetProtectionOptionsUpdated.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionPausedLabel":"Pause protection on sheet ${sheet}","_SheetProtectionPaused.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionResumedLabel":"Resume protection on sheet ${sheet}","_SheetProtectionResumed.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","TableAltTextEditedLabel":"I edited the Alt Text of Table ${tableName}","_TableAltTextEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAltTextTitleEditedLabel":"I edited the title part of Alt Text of Table ${tableName}","_TableAltTextTitleEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAltTextDescriptionEditedLabel":"I edited the description part Alt Text of Table ${tableName}","_TableAltTextDescriptionEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeApplyBorderLabel":"I changed the border on table ${tableName}","_TableRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeApplyBorderLabel":"I changed the border on table ${tableName} body","_TableBodyRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeApplyBorderLabel":"I changed the border on table ${tableName} header row","_TableHeaderRowRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeApplyBorderLabel":"I changed the border on table ${tableName} total row","_TableTotalRowRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeApplyBorderLabel":"I changed the border on sub-range of table ${tableName}","_TableGeneralRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeApplyBorderLabel":"I changed the border on ${count} row(s) in table ${tableName}","_TableRowsRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeApplyBorderLabel":"I changed the border on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeApplyBorderLabel":"I changed the border on ${count} column(s) in table ${tableName}","_TableColumnsRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeApplyBorderLabel":"I changed the border on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeApplyBorderLabel":"I changed the border on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeApplyBorderLabel":"I changed the border on range areas","_MultiRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeClearBackgroundColorLabel":"I cleared the background color on ${range}","_RangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameClearBackgroundColorLabel":"I cleared the background color on the column(s) \'${columnName}\'","_ColumnNameClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeClearBackgroundColorLabel":"I cleared the background color on range areas","_MultiRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName}","_TableRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by a the name of the table.","TableBodyRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} body","_TableBodyRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} header row","_TableHeaderRowRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} total row","_TableTotalRowRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearBackgroundColorLabel":"I cleared the background color on sub-range of table ${tableName}","_TableGeneralRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearBackgroundColorLabel":"I cleared the background color on ${count} row(s) in table ${tableName}","_TableRowsRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearBackgroundColorLabel":"I cleared the background color on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearBackgroundColorLabel":"I cleared the background color on ${count} column(s) in table ${tableName}","_TableColumnsRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearBackgroundColorLabel":"I cleared the background color on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearBackgroundColorLabel":"I cleared the background color on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFillPatternAppliedLabel":"Patterned fill applied","_RangeFillPatternAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeCellStyleAppliedLabel":"I applied a cell style to ${range}","_RangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameCellStyleAppliedLabel":"I applied a cell style to the column(s) \'${columnName}\'","_ColumnNameCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeCellStyleAppliedLabel":"I applied a cell style to range areas","_MultiRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName}","_TableRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by a range of cells.","TableBodyRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} body","_TableBodyRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} header row","_TableHeaderRowRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} total row","_TableTotalRowRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeCellStyleAppliedLabel":"I applied a cell style to sub-range of table ${tableName}","_TableGeneralRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeCellStyleAppliedLabel":"I applied a cell style to ${count} row(s) in table ${tableName}","_TableRowsRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeCellStyleAppliedLabel":"I applied a cell style to row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeCellStyleAppliedLabel":"I applied a cell style to ${count} column(s) in table ${tableName}","_TableColumnsRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeCellStyleAppliedLabel":"I applied a cell style to column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeCellStyleAppliedLabel":"I applied a cell style to column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeClearLabel":"I cleared the contents of ${range}","_RangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeClearLabel":"I cleared the contents of table ${tableName}","_TableRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeClearLabel":"I cleared the contents of table ${tableName} body","_TableBodyRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearLabel":"I cleared the contents of table ${tableName} header row","_TableHeaderRowRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearLabel":"I cleared the contents of table ${tableName} total row","_TableTotalRowRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearLabel":"I cleared the contents of sub-range of table ${tableName}","_TableGeneralRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearLabel":"I cleared the contents of ${count} row(s) in table ${tableName}","_TableRowsRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearLabel":"I cleared the contents of row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearLabel":"I cleared the contents of ${count} column(s) in table ${tableName}","_TableColumnsRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearLabel":"I cleared the contents of column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearLabel":"I cleared the contents of column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeClearFormatLabel":"I cleared the formatting on ${range}","_RangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeClearFormatLabel":"I cleared the formatting on table ${tableName}","_TableRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeClearFormatLabel":"I cleared the formatting on table ${tableName} body","_TableBodyRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearFormatLabel":"I cleared the formatting on table ${tableName} header row","_TableHeaderRowRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearFormatLabel":"I cleared the formatting on table ${tableName} total row","_TableTotalRowRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearFormatLabel":"I cleared the formatting on sub-range of table ${tableName}","_TableGeneralRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearFormatLabel":"I cleared the formatting on ${count} row(s) in table ${tableName}","_TableRowsRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearFormatLabel":"I cleared the formatting on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearFormatLabel":"I cleared the formatting on ${count} column(s) in table ${tableName}","_TableColumnsRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearFormatLabel":"I cleared the formatting on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearFormatLabel":"I cleared the formatting on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeClearLabel":"I cleared the range areas","_MultiRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeColumnsAutofitLabel":"I autofitted column(s) in ${range}.","_RangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName}","_TableRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} body","_TableBodyRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} header row","_TableHeaderRowRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} total row","_TableTotalRowRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeColumnsAutofitLabel":"I autofitted column(s) in sub-range of table ${tableName}","_TableGeneralRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeColumnsAutofitLabel":"I autofitted column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeColumnsAutofitLabel":"I autofitted column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeColumnsAutofitLabel":"I autofitted column(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeColumnsAutofitLabel":"I autofitted column(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeColumnsAutofitLabel":"I autofitted column(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeUseStandardWidthLabel":"I removed autofit from column(s) in ${range}.","_RangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName}","_TableRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} body","_TableBodyRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} header row","_TableHeaderRowRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} total row","_TableTotalRowRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUseStandardWidthLabel":"I removed autofit from column(s) in sub-range of table ${tableName}","_TableGeneralRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUseStandardWidthLabel":"I removed autofit from column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUseStandardWidthLabel":"I removed autofit from column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUseStandardWidthLabel":"I removed autofit from column(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUseStandardWidthLabel":"I removed autofit from column(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUseStandardWidthLabel":"I removed autofit from column(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeUseStandardHeightLabel":"I removed autofit from row(s) in ${range}.","_RangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName}","_TableRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} body","_TableBodyRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} header row","_TableHeaderRowRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} total row","_TableTotalRowRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUseStandardHeightLabel":"I removed autofit from row(s) in sub-range of table ${tableName}","_TableGeneralRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUseStandardHeightLabel":"I removed autofit from row(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUseStandardHeightLabel":"I removed autofit from row(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUseStandardHeightLabel":"I removed autofit from row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUseStandardHeightLabel":"I removed autofit from row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUseStandardHeightLabel":"I removed autofit from row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeCustomSortLabel":"I applied a custom sort on ${range}","_RangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by a name of a sheet.","TableRangeCustomSortLabel":"I applied a custom sort on ${tableName}.","_TableRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeCustomSortLabel":"I applied a custom sort on ${tableName} body.","_TableBodyRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeCustomSortLabel":"I applied a custom sort on ${tableName} header row.","_TableHeaderRowRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeCustomSortLabel":"I applied a custom sort on ${tableName} total row.","_TableTotalRowRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeCustomSortLabel":"I applied a custom sort on sub-range of table ${tableName}.","_TableGeneralRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeCustomSortLabel":"I applied a custom sort on ${count} row(s) in table ${tableName}.","_TableRowsRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeCustomSortLabel":"I applied a custom sort on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeCustomSortLabel":"I applied a custom sort on ${count} column(s) in table ${tableName}.","_TableColumnsRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameCustomSortLabel":"I applied a custom sort on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexCustomSortLabel":"I applied a custom sort on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","AutoFilterCustomSortLabel":"I applied a custom sort to range spanned by auto filter on sheet ${sheet}","_AutoFilterCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TextToColumnsLabel":"Transform text to columns on ${range}","_TextToColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is the range where the operation happens.","RangeDeleteLabel":"I deleted ${range}","_RangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeDeleteLabel":"I deleted table ${tableName}","_TableRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeDeleteLabel":"I deleted table ${tableName} body","_TableBodyRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeDeleteLabel":"I deleted table ${tableName} header row","_TableHeaderRowRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeDeleteLabel":"I deleted table ${tableName} total row","_TableTotalRowRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeDeleteLabel":"I deleted sub-range of table ${tableName}","_TableGeneralRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeDeleteLabel":"I deleted ${count} row(s) in table ${tableName}","_TableRowsRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeDeleteLabel":"I deleted row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeDeleteLabel":"I deleted ${count} column(s) in table ${tableName}","_TableColumnsRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeDeleteLabel":"I deleted column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeDeleteLabel":"I deleted column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeEditLabel":"I edited ${range}","_RangeEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeEditValueNumberLabel":"Write ${value} into ${range}","_RangeEditValueNumberLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells. The value represents a specific string cell value we\'re writing into that cell range, e.g. \'1.5\'","RangeEditValueStringLabel":"I wrote \'${value}\' into ${range}","_RangeEditValueStringLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells. The value represents a specific cell value we\'re writing into that cell range, e.g. \'1.5\'","MultiRangeEditLabel":"I edited the range areas","_MultiRangeEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeDeleteLabel":"I deleted the range areas","_MultiRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFillLabel":"Fill range ${range}","_RangeFillLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeFlashFillLabel":"Flash fill on ${range}","_RangeFlashFillLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeFormatBoldLabel":"I bolded ${range}","_RangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatBoldLabel":"I bolded the column(s) \'${columnName}\'","_ColumnFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatSuperscriptLabel":"Superscript ${range}","_RangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatSuperscriptLabel":"Superscript the column(s) \'${columnName}\'","_ColumnFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatSubscriptLabel":"subscript ${range}","_RangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatSubscriptLabel":"subscript the column(s) \'${columnName}\'","_ColumnFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatBoldLabel":"I bolded the range areas","_MultiRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatSuperscriptLabel":"Superscript range areas","_MultiRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatSubscriptLabel":"Subscript range areas","_MultiRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatBoldLabel":"I bolded the table ${tableName}","_TableRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatSuperscriptLabel":"Superscript table ${tableName}","_TableRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatSubscriptLabel":"Subscript table ${tableName}","_TableRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatBoldLabel":"I bolded the table ${tableName} body","_TableBodyRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSuperscriptLabel":"Superscript table ${tableName} body","_TableBodyRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSubscriptLabel":"Subscript table ${tableName} body","_TableBodyRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatBoldLabel":"I bolded the table ${tableName} header row","_TableHeaderRowRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSuperscriptLabel":"Superscript table ${tableName} header row","_TableHeaderRowRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSubscriptLabel":"Subscript table ${tableName} header row","_TableHeaderRowRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatBoldLabel":"I bolded the table ${tableName} total row","_TableTotalRowRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSuperscriptLabel":"Superscript table ${tableName} total row","_TableTotalRowRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSubscriptLabel":"Subscript table ${tableName} total row","_TableTotalRowRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatBoldLabel":"I bolded the sub-range of table ${tableName}","_TableGeneralRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSuperscriptLabel":"Superscript sub-range of table ${tableName}","_TableGeneralRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSubscriptLabel":"Subscript sub-range of table ${tableName}","_TableGeneralRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatBoldLabel":"I bolded ${count} row(s) in table ${tableName}","_TableRowsRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatBoldLabel":"I bolded row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatSuperscriptLabel":"Superscript ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSuperscriptLabel":"Superscript row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatSubscriptLabel":"Subscript ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSubscriptLabel":"Subscript row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatBoldLabel":"I bolded ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatBoldLabel":"I bolded column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatBoldLabel":"I bolded column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatSuperscriptLabel":"Superscript ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSuperscriptLabel":"Superscript column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSuperscriptLabel":"Superscript column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatSubscriptLabel":"Subscript ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSubscriptLabel":"Subscript column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSubscriptLabel":"Subscript column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatUnboldLabel":"I unbolded the range areas","_MultiRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatRemoveSuperscriptLabel":"I removed the superscript from range areas","_MultiRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatRemoveSubscriptLabel":"I removed the subscript from range areas","_MultiRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatDoubleUnderlineLabel":"I applied a double underline to ${range}","_RangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatDoubleUnderlineLabel":"I applied a double underline to the column(s) \'${columnName}\'","_ColumnFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatDoubleUnderlineLabel":"I applied a double underline to range areas","_MultiRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName}","_TableRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} body","_TableBodyRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} header row","_TableHeaderRowRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} total row","_TableTotalRowRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatDoubleUnderlineLabel":"I applied a double underline to sub-range of table ${tableName}","_TableGeneralRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatDoubleUnderlineLabel":"I applied a double underline to ${count} row(s) in table ${tableName}","_TableRowsRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatDoubleUnderlineLabel":"I applied a double underline to row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatDoubleUnderlineLabel":"I applied a double underline to ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatDoubleUnderlineLabel":"I applied a double underline to column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatDoubleUnderlineLabel":"I applied a double underline to column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatItalicLabel":"I italicized ${range}","_RangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatItalicLabel":"I italicized the column(s) \'${columnName}\'","_ColumnFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatItalicizeLabel":"I italicized the range areas","_MultiRangeFormatItalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatItalicLabel":"I italicized the table ${tableName}","_TableRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatItalicLabel":"I italicized the table ${tableName} body","_TableBodyRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatItalicLabel":"I italicized the table ${tableName} header row","_TableHeaderRowRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatItalicLabel":"I italicized the table ${tableName} total row","_TableTotalRowRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatItalicLabel":"I italicized the sub-range of table ${tableName}","_TableGeneralRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatItalicLabel":"I italicized ${count} row(s) in table ${tableName}","_TableRowsRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatItalicLabel":"I italicized row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatItalicLabel":"I italicized ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatItalicLabel":"I italicized column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatItalicLabel":"I italicized column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatUnItalicizeLabel":"I removed italics from the range areas","_MultiRangeFormatUnItalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${range}","_RangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveDoubleUnderlineLabel":"I removed the double underline from the column(s) \'${columnName}\'","_ColumnFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName}","_TableRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} body","_TableBodyRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} total row","_TableTotalRowRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from range areas","_MultiRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${range}","_RangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveStrikethroughLabel":"I removed the strikethrough from the column(s) \'${columnName}\'","_ColumnFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from range areas","_MultiRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName}","_TableRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} body","_TableBodyRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} total row","_TableTotalRowRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatRemoveUnderlineLabel":"I removed underlining from ${range}","_RangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveUnderlineLabel":"I removed underlining from column(s) ${racolumnNamenge}","_ColumnFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatRemoveUnderlineLabel":"I removed underlining from range areas","_MultiRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName}","_TableRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} body","_TableBodyRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} total row","_TableTotalRowRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveUnderlineLabel":"I removed underlining from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveUnderlineLabel":"I removed underlining from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveUnderlineLabel":"I removed underlining from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveUnderlineLabel":"I removed underlining from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveUnderlineLabel":"I removed underlining from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveUnderlineLabel":"I removed underlining from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatSetFontColorLabel":"I set the font color to ${color} on ${range}","_RangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameFormatSetFontColorLabel":"I set the font color to ${color} on ${columnName}","_ColumnNameFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and columnName variable/placeholder is replaced by the column name.","ColumnFormatSetFontColorLabel":"I set the font color to ${color} on ${range}","_ColumnFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeFormatSetFontColorLabel":"I set the font color to ${color} on range areas","_MultiRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.","TableRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName}","_TableRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} body","_TableBodyRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} header row","_TableHeaderRowRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} total row","_TableTotalRowRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSetFontColorLabel":"I set the font color to ${color} on sub-range of table ${tableName}","_TableGeneralRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatSetFontColorLabel":"I set the font color to ${color} on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSetFontColorLabel":"I set the font color to ${color} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatSetFontColorLabel":"I set the font color to ${color} on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSetFontColorLabel":"I set the font color to ${color} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSetFontColorLabel":"I set the font color to ${color} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatSetFontLabel":"I set the font to ${fontName} on ${range}","_RangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameFormatSetFontLabel":"I set the font to ${fontName} on the column(s) \'${columnName}\'","_ColumnNameFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatSetFontLabel":"I set the font to ${fontName} on range areas","_MultiRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.","TableRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName}","_TableRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} body","_TableBodyRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} header row","_TableHeaderRowRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} total row","_TableTotalRowRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSetFontLabel":"I set the font to ${fontName} on sub-range of table ${tableName}","_TableGeneralRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatSetFontLabel":"I set the font to ${fontName} on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSetFontLabel":"I set the font to ${fontName} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatSetFontLabel":"I set the font to ${fontName} on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSetFontLabel":"I set the font to ${fontName} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSetFontLabel":"I set the font to ${fontName} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatStrikethroughLabel":"I applied a strikethrough on ${range}","_RangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatStrikethroughLabel":"I applied a strikethrough on the column(s) \'${columnName}\'","_ColumnFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatStrikethroughLabel":"I applied a strikethrough on range areas","_MultiRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName}","_TableRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableRange variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} body","_TableBodyRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} header row","_TableHeaderRowRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} total row","_TableTotalRowRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatStrikethroughLabel":"I applied a strikethrough on sub-range of table ${tableName}","_TableGeneralRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatStrikethroughLabel":"I applied a strikethrough on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatStrikethroughLabel":"I applied a strikethrough on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatStrikethroughLabel":"I applied a strikethrough on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatStrikethroughLabel":"I applied a strikethrough on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatStrikethroughLabel":"I applied a strikethrough on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnboldLabel":"I unbolded ${range}","_RangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnboldLabel":"I unbolded the column(s) \'${columnName}\'","_ColumnFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${range}","_RangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveSuperscriptLabel":"I removed the superscript from the column(s) \'${columnName}\'","_ColumnFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatRemoveSubscriptLabel":"I removed the subscript from ${range}","_RangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveSubscriptLabel":"I removed the subscript from the column(s) \'${columnName}\'","_ColumnFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatUnboldLabel":"I unbolded the table ${tableName}","_TableRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatUnSuperscriptLabel":"I removed the superscript from table ${tableName}","_TableRangeFormatUnSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName}","_TableRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnboldLabel":"I unbolded the table ${tableName} body","_TableBodyRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} body","_TableBodyRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} body","_TableBodyRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnboldLabel":"I unbolded the table ${tableName} header row","_TableHeaderRowRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnboldLabel":"I unbolded the table ${tableName} total row","_TableTotalRowRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} total row","_TableTotalRowRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} total row","_TableTotalRowRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnboldLabel":"I unbolded the sub-range of table ${tableName}","_TableGeneralRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveSuperscriptLabel":"I removed the superscript from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveSubscriptLabel":"I removed the subscript from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnboldLabel":"I unbolded ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnboldLabel":"I unbolded row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveSuperscriptLabel":"I removed the superscript from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatRemoveSubscriptLabel":"I removed the subscript from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveSubscriptLabel":"I removed the subscript from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnboldLabel":"I unbolded ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnboldLabel":"I unbolded column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnboldLabel":"I unbolded column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveSuperscriptLabel":"I removed the superscript from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveSuperscriptLabel":"I removed the superscript from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatRemoveSubscriptLabel":"I removed the subscript from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveSubscriptLabel":"I removed the subscript from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveSubscriptLabel":"I removed the subscript from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnderlineLabel":"I underlined ${range}","_RangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnderlineLabel":"I underlined the column(s) \'${columnName}\'","_ColumnFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatUnderlineLabel":"I underlined the range areas","_MultiRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatUnderlineLabel":"I underlined the table ${tableName}","_TableRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnderlineLabel":"I underlined the table ${tableName} body","_TableBodyRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnderlineLabel":"I underlined the table ${tableName} header row","_TableHeaderRowRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnderlineLabel":"I underlined the table ${tableName} total row","_TableTotalRowRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnderlineLabel":"I underlined the sub-range of table ${tableName}","_TableGeneralRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnderlineLabel":"I underlined ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnderlineLabel":"I underlined row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnderlineLabel":"I underlined ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnderlineLabel":"I underlined column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnderlineLabel":"I underlined column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnitalicizeLabel":"I removed italics from ${range}","_RangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnitalicizeLabel":"I removed italics from the column(s) \'${columnName}\'","_ColumnFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName}","_TableRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} body","_TableBodyRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} header row","_TableHeaderRowRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} total row","_TableTotalRowRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnitalicizeLabel":"I removed italics from sub-range of table ${tableName}","_TableGeneralRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnitalicizeLabel":"I removed italics from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnitalicizeLabel":"I removed italics from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnitalicizeLabel":"I removed italics from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnitalicizeLabel":"I removed italics from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnitalicizeLabel":"I removed italics from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeGroupDetailsHideLabel":"I hid the group details on sheet ${sheet}","_RangeGroupDetailsHideLabel.comment":"Text to show in a list when a group details hide user action was taken during script recording","RangeGroupDetailsShowLabel":"Show group details on sheet ${sheet}","_RangeGroupDetailsShowLabel.comment":"Text to show in a list when a group details show user action was taken during script recording","RangeGroupLabel":"Group range on sheet ${sheet}","_RangeGroupLabel.comment":"Text to show in a list when a range group user action was taken during script recording","RangeDataValidationChangedGroupLabel":"I set the data validation on sheet ${sheet}","_RangeDataValidationChangedGroupLabel.comment":"Text to show in a list when the data validation group was changed for a selected range","RangeHideRowsLabel":"I hid the row(s) on ${range}","_RangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeHideRowsLabel":"I hid the row(s) in table ${tableName}","_TableRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeHideRowsLabel":"I hid the row(s) in table ${tableName} body","_TableBodyRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeHideRowsLabel":"I hid the table ${tableName} header row","_TableHeaderRowRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeHideRowsLabel":"I hid the table ${tableName} total row","_TableTotalRowRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeHideRowsLabel":"I hid the row(s) in sub-range of table ${tableName}","_TableGeneralRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeHideRowsLabel":"I hid ${count} row(s) in table ${tableName}","_TableRowsRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeHideRowsLabel":"I hid row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeHideRowsLabel":"I hid the row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeHideRowsLabel":"I hid the row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeHideRowsLabel":"I hid the row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameHideRowsLabel":"I hid the row(s) on the column(s) \'${columnName}\'","_ColumnNameRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeUnhideRowsLabel":"I unhid the row(s) on ${range}","_RangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnhideRowsLabel":"I unhid the row(s) in table ${tableName}","_TableRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnhideRowsLabel":"I unhid the row(s) in table ${tableName} body","_TableBodyRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnhideRowsLabel":"I unhid the table ${tableName} header row","_TableHeaderRowRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnhideRowsLabel":"I unhid the table ${tableName} total row","_TableTotalRowRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnhideRowsLabel":"I unhid the row(s) in sub-range of table ${tableName}","_TableGeneralRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnhideRowsLabel":"I unhid ${count} row(s) in table ${tableName}","_TableRowsRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnhideRowsLabel":"I unhid row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnhideRowsLabel":"I unhid the row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnhideRowsLabel":"I unhid the row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnhideRowsLabel":"I unhid the row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameUnhideRowsLabel":"I unhid the row(s) on the column(s) \'${columnName}\'","_ColumnNameUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeHideColumnsLabel":"I hid the column(s) on ${range}","_RangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeHideColumnsLabel":"I hid the column(s) in table ${tableName}","_TableRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} body","_TableBodyRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} header row","_TableHeaderRowRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} total row","_TableTotalRowRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeHideColumnsLabel":"I hid the column(s) in sub-range of table ${tableName}","_TableGeneralRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeHideColumnsLabel":"I hid the column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeHideColumnsLabel":"I hid the column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeHideColumnsLabel":"I hid ${count} column(s) in table ${tableName}","_TableColumnsRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeHideColumnsLabel":"I hid column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeHideColumnsLabel":"I hid the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameHideColumnsLabel":"I hid the column(s) \'${columnName}\'","_ColumnNameHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeUnhideColumnsLabel":"I unhid the column(s) on ${range}","_RangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName}","_TableRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} body","_TableBodyRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} header row","_TableHeaderRowRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} total row","_TableTotalRowRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnhideColumnsLabel":"I unhid the column(s) in sub-range of table ${tableName}","_TableGeneralRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnhideColumnsLabel":"I unhid the column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnhideColumnsLabel":"I unhid the column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnhideColumnsLabel":"I unhid ${count} column(s) in table ${tableName}","_TableColumnsRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnhideColumnsLabel":"I unhid column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnhideColumnsLabel":"I unhid the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameUnhideColumnsLabel":"I unhid the column(s) \'${columnName}\'","_ColumnNameRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeHideRowsLabel":"I hid the row(s) on range areas","_MultiRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeUnhideRowsLabel":"I unhid the row(s) on range areas","_MultiRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeHideColumnsLabel":"I hid the column(s) on range areas","_MultiRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeUnhideColumnsLabel":"I unhid the column(s) on range areas","_MultiRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeHyperlinkLabel":"I applied a hyperlink on ${range}","_RangeHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeRemoveHyperlinkLabel":"I removed the hyperlink from ${range}","_RangeRemoveHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ChangeRangeIndent":"I changed the indent","_ChangeRangeIndent.comment":"User-facing string describing the Excel event executed by Copilot.","RangeChangeIndentLabel":"I changed the indent on ${range}","_RangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameChangeIndentLabel":"I changed the indent on the column(s) \'${columnName}\'","_ColumnNameChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeChangeIndentLabel":"I changed the indent on table ${tableName}","_TableRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeChangeIndentLabel":"I changed the indent on table ${tableName} body","_TableBodyRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeChangeIndentLabel":"I changed the indent on table ${tableName} header row","_TableHeaderRowRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeChangeIndentLabel":"I changed the indent on table ${tableName} total row","_TableTotalRowRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeChangeIndentLabel":"I changed the indent on sub-range of table ${tableName}","_TableGeneralRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeChangeIndentLabel":"I changed the indent on ${count} row(s) in table ${tableName}","_TableRowsRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeChangeIndentLabel":"I changed the indent on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeChangeIndentLabel":"I changed the indent on ${count} column(s) in table ${tableName}","_TableColumnsRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeChangeIndentLabel":"I changed the indent on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeChangeIndentLabel":"I changed the indent on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeRemoveHyperlinkLabel":"I removed the hyperlink from range areas","_MultiRangeRemoveHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeChangeIndentLabel":"I changed the indent on range areas","_MultiRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeInsertLabel":"I inserted ${range}","_RangeInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeInsertedLabel":"I inserted cells at table ${tableName}","_TableRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeInsertedLabel":"I inserted cells at table ${tableName} body","_TableBodyRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeInsertedLabel":"I inserted cells at table ${tableName} header row","_TableHeaderRowRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeInsertedLabel":"I inserted cells at table ${tableName} total row","_TableTotalRowRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeInsertedLabel":"I inserted cells at sub-range of table ${tableName}","_TableGeneralRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeInsertedLabel":"I inserted cells at ${count} row(s) in table ${tableName}","_TableRowsRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeInsertedLabel":"I inserted cells at row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeInsertedLabel":"I inserted cells at ${count} column(s) in table ${tableName}","_TableColumnsRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeInsertedLabel":"I inserted cells at column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeInsertedLabel":"I inserted cells at column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultipleRangeInsertLabel":"I inserted multiple ranges","_MultipleRangeInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeMergeLabel":"I merged ${range}","_RangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeMergeLabel":"I merged cells on table ${tableName}","_TableRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeMergeLabel":"I merged cells on table ${tableName} body","_TableBodyRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeMergeLabel":"I merged cells on table ${tableName} header row","_TableHeaderRowRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeMergeLabel":"I merged cells on table ${tableName} total row","_TableTotalRowRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeMergeLabel":"I merged cells on sub-range of table ${tableName}","_TableGeneralRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeMergeLabel":"I merged cells on ${count} row(s) in table ${tableName}","_TableRowsRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeMergeLabel":"I merged cells on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeMergeLabel":"I merged cells on ${count} column(s) in table ${tableName}","_TableColumnsRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeMergeLabel":"I merged cells on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeMergeLabel":"I merged cells on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeMergeLabel":"I merged the range areas","_MultiRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeNumberFormatLabel":"I applied ${numberFormat} on ${range}","_RangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameNumberFormatLabel":"I applied ${numberFormat} on the column(s) \'${columnName}\'","_ColumnNameNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeNumberFormatLabel":"I applied the number format on range areas","_MultiRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeNumberFormatLabel":"I applied the number format on table ${tableName}","_TableRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeNumberFormatLabel":"I applied the number format on table ${tableName} body","_TableBodyRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeNumberFormatLabel":"I applied the number format on table ${tableName} header row","_TableHeaderRowRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeNumberFormatLabel":"I applied the number format on table ${tableName} total row","_TableTotalRowRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeNumberFormatLabel":"I applied the number format on sub-range of table ${tableName}","_TableGeneralRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeNumberFormatLabel":"I applied the number format on ${count} row(s) in table ${tableName}","_TableRowsRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeNumberFormatLabel":"I applied the number format on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeNumberFormatLabel":"I applied the number format on ${count} column(s) in table ${tableName}","_TableColumnsRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeNumberFormatLabel":"I applied the number format on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeNumberFormatLabel":"I applied the number format on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangePasteCopyLabel":"Paste copied cells into ${range}","_RangePasteCopyLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangePasteCopyInTableLabel":"Paste copied cells into row ${rowIndex} of table ${tableName}","_RangePasteCopyInTableLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and rowIndex variable/placeholder is replaced by the index where the copied cells are pasted.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteCutLabel":"Paste cut cells into ${range}","_RangePasteCutLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangePasteCutInTableLabel":"Paste cut cells into row ${rowIndex} of table ${tableName}","_RangePasteCutInTableLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and rowIndex variable/placeholder is replaced by the index where the cut cells are pasted.  The $ and tableName variable/placeholder is replaced by the name of the table.","NamedSheetViewCreateLabel":"I created a new temporary sheet view","_NamedSheetViewCreateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","NamedSheetViewDeleteLabel":"I deleted ${deletedNum} named sheet view(s)","_NamedSheetViewDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and deletedNum variables/placeholders is replaced by the number of named sheet views deleted.","NamedSheetViewDuplicateLabel":"Duplicate named sheet view ${sheetViewName}","_NamedSheetViewDuplicateLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewExitLabel":"Exit named sheet view","_NamedSheetViewExitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","NamedSheetViewExitAndKeepLabel":"Exit named sheet view and keep as ${sheetViewName}","_NamedSheetViewExitAndKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewKeepLabel":"Keep named sheet view as ${sheetViewName}","_NamedSheetViewKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewRenameLabel":"Rename named sheet view to ${newSheetViewName}","_NamedSheetViewRenameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and newSheetViewName variables/placeholders is replaced by the new name of the named sheet view.","NamedSheetViewSwitchLabel":"Switch to named sheet view ${sheetViewName}","_NamedSheetViewSwitchLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewSwitchAndKeepLabel":"Switch to named sheet view ${sheetViewName} and keep temporary named sheet view as ${sheetViewKeepName}","_NamedSheetViewSwitchAndKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.  The $ and namedSheetViewKeepName variables/placeholders is replaced by the name of the temporary named sheet view to keep.","RangePasteLabel":"Paste from ${sourceRange} to ${destinationRange}","_RangePasteLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange and destinationRange variables/placeholders are replaced by ranges of cells.","RangePasteInTableRangeLabel":"Paste from ${sourceRange} to table ${tableName}","_RangePasteInTableRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange variable/placeholder is replaced a range of cells.","RangePasteInTableBodyRangeLabel":"Paste from ${sourceRange} to table ${tableName} body","_RangePasteInTableBodyRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableHeaderRowRangeLabel":"Paste from ${sourceRange} to table ${tableName} header row","_RangePasteInTableHeaderRowRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableTotalRowRangeLabel":"Paste from ${sourceRange} to table ${tableName} total row","_RangePasteInTableTotalRowRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableGeneralRangeLabel":"Paste from ${sourceRange} to sub-range of table ${tableName}","_RangePasteInTableGeneralRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","MultiRangePasteLabel":"Paste from ${sourceRange} to range areas","_MultiRangePasteLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange variable/placeholder is replaced by ranges of cells.","RangePasteTextLabel":"Paste text to ${range}","_RangePasteTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeRemoveDuplicatesLabel":"I removed duplicates on ${range}","_RangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName}","_TableRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} body","_TableBodyRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} header row","_TableHeaderRowRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} total row","_TableTotalRowRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRemoveDuplicatesLabel":"I removed duplicates in sub-range of table ${tableName}","_TableGeneralRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRemoveDuplicatesLabel":"I removed duplicates in ${count} row(s) in table ${tableName}","_TableRowsRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRemoveDuplicatesLabel":"I removed duplicates in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRemoveDuplicatesLabel":"I removed duplicates in ${count} column(s) in table ${tableName}","_TableColumnsRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRemoveDuplicatesLabel":"I removed duplicates in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRemoveDuplicatesLabel":"I removed duplicates in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeRowsAutofitLabel":"I autofitted row(s) in ${range}.","_RangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName}","_TableRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} body","_TableBodyRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} header row","_TableHeaderRowRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} total row","_TableTotalRowRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRowsAutofitLabel":"I autofitted row(s) in sub-range of table ${tableName}","_TableGeneralRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRowsAutofitLabel":"I autofitted row(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRowsAutofitLabel":"I autofitted row(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRowsAutofitLabel":"I autofitted row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRowsAutofitLabel":"I autofitted row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRowsAutofitLabel":"I autofitted row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetBackgroundColorLabel":"I set the background color to ${color} on ${range}","_RangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetBackgroundColorLabel":"I set the background color to ${color} on the column(s) \'${columnName}\'","_ColumnNameSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName}","_TableRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} body","_TableBodyRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} header row","_TableHeaderRowRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} total row","_TableTotalRowRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetBackgroundColorLabel":"I set the background color to ${color} on sub-range of table ${tableName}","_TableGeneralRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetBackgroundColorLabel":"I set the background color to ${color} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetBackgroundColorLabel":"I set the background color to ${color} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetBackgroundColorLabel":"I set the background color to ${color} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetBackgroundColorLabel":"I set the background color to ${color} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetBackgroundColorLabel":"I set the background color to ${color} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeSetBackgroundColorLabel":"I set the background color to ${color} on range areas","_MultiRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.","RangeSetCellHeightLabel":"I set the height to ${size} on ${range}","_RangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName}","_TableRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} body","_TableBodyRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} header row","_TableHeaderRowRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} total row","_TableTotalRowRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetCellHeightLabel":"I set the height to ${size} on sub-range of table ${tableName}","_TableGeneralRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetCellHeightLabel":"I set the height to ${size} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetCellHeightLabel":"I set the height to ${size} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetCellHeightLabel":"I set the height to ${size} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetCellHeightLabel":"I set the height to ${size} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetCellHeightLabel":"I set the height to ${size} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameSetCellHeightLabel":"I set the height to ${size} on the column(s) \'${columnName}\'","_ColumnNameSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetCellHeightLabel":"I set the height to ${size} on range areas","_MultiRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeSetCellWidthLabel":"I set the width to ${size} on ${range}","_RangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName}","_TableRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} body","_TableBodyRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} header row","_TableHeaderRowRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} total row","_TableTotalRowRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetCellWidthLabel":"I set the width to ${size} on sub-range of table ${tableName}","_TableGeneralRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetCellWidthLabel":"I set the width to ${size} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetCellWidthLabel":"I set the width to ${size} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetCellWidthLabel":"I set the width to ${size} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetCellWidthLabel":"I set the width to ${size} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetCellWidthLabel":"I set the width to ${size} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameSetCellWidthLabel":"I set the width to ${size} on the column(s) \'${columnName}\'","_ColumnNameSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetCellWidthLabel":"I set the width to ${size} on range areas","_MultiRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.","RangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${range}","_RangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetFontSizeLabel":"I set the font size to ${fontSize} on the column(s) \'${columnName}\'","_ColumnNameSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetFontSizeLabel":"I set the font size to ${fontSize} on range areas","_MultiRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","FontUnderlineStyleLabel":"I applied the ${style} underline on ${range}","_FontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and style variable/placeholder is replaced by the style of underline. The $ and range variable/placeholder is replaced by a range of cells","TableRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName}","_TableRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} body","_TableBodyRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} header row","_TableHeaderRowRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} total row","_TableTotalRowRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFontUnderlineStyleLabel":"I applied the ${style} underline on sub-range of table ${tableName}","_TableGeneralRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFontUnderlineStyleLabel":"I applied the ${style} underline on ${count} row(s) in table ${tableName}","_TableRowsRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFontUnderlineStyleLabel":"I applied the ${style} underline on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFontUnderlineStyleLabel":"I applied the ${style} underline on ${count} column(s) in table ${tableName}","_TableColumnsRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFontUnderlineStyleLabel":"I applied the ${style} underline on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFontUnderlineStyleLabel":"I applied the ${style} underline on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameFontUnderlineStyleLabel":"I applied the ${style} underline on the column(s) \'${columnName}\'","_ColumnNameFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.  The $ and style variable/placeholder is replaced by the style of underline. The $ and columnName variable/placeholder is replaced by columnName of cells","RemoveFontUnderlineStyleLabel":"I removed underlining from ${range}","_RemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by a range of cells","TableRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName}","_TableRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} body","_TableBodyRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} header row","_TableHeaderRowRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} total row","_TableTotalRowRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRemoveFontUnderlineStyleLabel":"I removed underlining from sub-range of table ${tableName}","_TableGeneralRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRemoveFontUnderlineStyleLabel":"I removed underlining from ${count} row(s) in table ${tableName}","_TableRowsRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRemoveFontUnderlineStyleLabel":"I removed underlining from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRemoveFontUnderlineStyleLabel":"I removed underlining from ${count} column(s) in table ${tableName}","_TableColumnsRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRemoveFontUnderlineStyleLabel":"I removed underlining from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRemoveFontUnderlineStyleLabel":"I removed underlining from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameRemoveFontUnderlineStyleLabel":"I removed underlining from the column(s) \'${columnName}\'","_ColumnNameRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and columnName variable/placeholder is replaced by columnName of cells","TableRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName}","_TableRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} body","_TableBodyRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} header row","_TableHeaderRowRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} total row","_TableTotalRowRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetFontSizeLabel":"I set the font size to ${fontSize} on sub-range of table ${tableName}","_TableGeneralRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetFontSizeLabel":"I set the font size to ${fontSize} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetFontSizeLabel":"I set the font size to ${fontSize} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetFontSizeLabel":"I set the font size to ${fontSize} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${range}","_RangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetHorizontalAlignmentLabel":"I set the horizontal alignment on the column(s) \'${columnName}\'","_ColumnNameSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on range areas","_MultiRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName}","_TableRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableRange variable/placeholder is replaced by the name of the table.","TableBodyRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} body","_TableBodyRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} header row","_TableHeaderRowRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} total row","_TableTotalRowRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on sub-range of table ${tableName}","_TableGeneralRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${count} row(s) in table ${tableName}","_TableRowsRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${range}","_RangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetVerticalAlignmentLabel":"I set the vertical alignment on the column(s) \'${columnName}\'","_ColumnNameSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetVerticalAlignmentLabel":"I set the vertical alignment on range areas","_MultiRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName}","_TableRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by the name of the table.","TableBodyRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} body","_TableBodyRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} header row","_TableHeaderRowRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} total row","_TableTotalRowRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetVerticalAlignmentLabel":"I set the vertical alignment on sub-range of table ${tableName}","_TableGeneralRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${count} row(s) in table ${tableName}","_TableRowsRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetVerticalAlignmentLabel":"I set the vertical alignment on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetVerticalAlignmentLabel":"I set the vertical alignment on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetVerticalAlignmentLabel":"I set the vertical alignment on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSortLabel":"I sorted the range  ${range}","_RangeSortLabel.comment":"Text to show in a list when a sort range user action was taken during script recording","RangeUnGroupLabel":"Ungroup range on sheet ${sheet}","_RangeUnGroupLabel.comment":"Text to show in a list when a range ungroup user action was taken during script recording","RangeUnmergeLabel":"Unmerge ${range}","_RangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnmergeLabel":"I unmerged cells on table ${tableName}","_TableRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnmergeLabel":"I unmerged cells on table ${tableName} body","_TableBodyRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnmergeLabel":"I unmerged cells on table ${tableName} header row","_TableHeaderRowRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnmergeLabel":"I unmerged cells on table ${tableName} total row","_TableTotalRowRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnmergeLabel":"I unmerged cells on sub-range of table ${tableName}","_TableGeneralRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnmergeLabel":"I unmerged cells on ${count} row(s) in table ${tableName}","_TableRowsRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnmergeLabel":"I unmerged cells on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnmergeLabel":"I unmerged cells on ${count} column(s) in table ${tableName}","_TableColumnsRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnmergeLabel":"I unmerged cells on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnmergeLabel":"I unmerged cells on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeUnmergeLabel":"Unmerge range areas","_MultiRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeUnwrapTextLabel":"Unwrap text on ${range}","_RangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameUnwrapTextLabel":"Unwrap text on the column(s) \'${columnName}\'","_ColumnNameUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeUnwrapTextLabel":"Unwrap text on range areas","_MultiRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUnwrapTextLabel":"Unwrap text on table ${tableName}","_TableRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnwrapTextLabel":"Unwrap text on table ${tableName} body","_TableBodyRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnwrapTextLabel":"Unwrap text on table ${tableName} header row","_TableHeaderRowRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnwrapTextLabel":"Unwrap text on table ${tableName} total row","_TableTotalRowRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnwrapTextLabel":"Unwrap text on sub-range of table ${tableName}","_TableGeneralRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnwrapTextLabel":"Unwrap text on ${count} row(s) in table ${tableName}","_TableRowsRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnwrapTextLabel":"Unwrap text on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnwrapTextLabel":"Unwrap text on ${count} column(s) in table ${tableName}","_TableColumnsRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnwrapTextLabel":"Unwrap text on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnwrapTextLabel":"Unwrap text on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeWrapTextLabel":"I wrapped text on ${range}","_RangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameWrapTextLabel":"I wrapped text on the column(s) \'${columnName}\'","_ColumnNameWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeWrapTextLabel":"I wrapped text on range areas","_MultiRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeWrapTextLabel":"I wrapped text on table ${tableName}","_TableRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeWrapTextLabel":"I wrapped text on table ${tableName} body","_TableBodyRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeWrapTextLabel":"I wrapped text on table ${tableName} header row","_TableHeaderRowRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeWrapTextLabel":"I wrapped text on table ${tableName} total row","_TableTotalRowRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeWrapTextLabel":"I wrapped text on sub-range of table ${tableName}","_TableGeneralRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeWrapTextLabel":"I wrapped text on ${count} row(s) in table ${tableName}","_TableRowsRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeWrapTextLabel":"I wrapped text on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeWrapTextLabel":"I wrapped text on ${count} column(s) in table ${tableName}","_TableColumnsRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeWrapTextLabel":"I wrapped text on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeWrapTextLabel":"I wrapped text on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RedoLabel":"Redo","_RedoLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' over the range ${range}","_ReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term. \'range\' represents the cell range we\'re operating over, e.g. A1:C6","TableRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName}","_TableRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} body","_TableBodyRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} header row","_TableHeaderRowRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} total row","_TableTotalRowRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in sub-range of table ${tableName}","_TableGeneralRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in ${count} row(s) in table ${tableName}","_TableRowsRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in ${count} column(s) in table ${tableName}","_TableColumnsRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ReplaceAllLabelGeneric":"Replace all \'${search}\' with \'${replace}\'","_ReplaceAllLabelGeneric.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.","TableApplyStyleLabel":"I applied a style on table ${tableName}","_TableApplyStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeBandedColumnsVisibilityLabel":"Change the visibility of banded columns on table ${tableName}","_TableChangeBandedColumnsVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddBandedColumnsLabel":"I added banded columns on table ${tableName}","_TableAddBandedColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveBandedColumnsLabel":"I removed banded columns on table ${tableName}","_TableRemoveBandedColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeBandedRowsVisibilityLabel":"I changed the visibility of banded rows on table ${tableName}","_TableChangeBandedRowsVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddBandedRowsLabel":"I added banded rows on table ${tableName}","_TableAddBandedRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveBandedRowsLabel":"I removed banded rows on table ${tableName}","_TableRemoveBandedRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeFilterButtonVisibilityLabel":"I changed the visibility of filter button on table ${tableName}","_TableChangeFilterButtonVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddFilterButtonLabel":"I added filter button on table ${tableName}","_TableAddFilterButtonLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveFilterButtonLabel":"I removed filter button on table ${tableName}","_TableRemoveFilterButtonLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableClearFiltersLabel":"I removed all filters on table ${tableName}","_TableClearFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnClearFilterLabel":"I removed a filter on \'${columnName}\' of table ${tableName}","_TableColumnClearFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was un-filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnCustomFilterLabel":"I applied a custom filter on \'${columnName}\' of table ${tableName}","_TableColumnCustomFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnEqualsFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is equal to ${value1}","_TableColumnEqualsFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotEqualFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value does not equal to ${value1}","_TableColumnDoesNotEqualFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBeginsWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value begins with ${value1}","_TableColumnBeginsWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBeginsWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value begins with ${value1} or ${value2}","_TableColumnBeginsWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotBeginWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not begin with ${value1}","_TableColumnDoesNotBeginWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotBeginWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not begin with ${value1} and ${value2}","_TableColumnDoesNotBeginWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnEndsWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value ends with ${value1}","_TableColumnEndsWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnEndsWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value ends with ${value1} or ${value2}","_TableColumnEndsWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotEndWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not end with ${value1}","_TableColumnDoesNotEndWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotEndWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not end with ${value1} and ${value2}","_TableColumnDoesNotEndWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnContainsFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value contains ${value1}","_TableColumnContainsFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnContainsFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value contains ${value1} or ${value2}","_TableColumnContainsFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotContainFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not contain ${value1}","_TableColumnDoesNotContainFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotContainFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not contain ${value1} and ${value2}","_TableColumnDoesNotContainFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnIsGreaterThanFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is greater than ${value1}","_TableColumnIsGreaterThanFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsGreaterThanOrEqualToFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is greater than or equal to ${value1}","_TableColumnIsGreaterThanOrEqualToFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsLessThanFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is less than ${value1}","_TableColumnIsLessThanFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsLessThanOrEqualToFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is less than or equal to ${value1}","_TableColumnIsLessThanOrEqualToFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBetweenFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is between ${value1} and ${value2}","_TableColumnBetweenFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the smaller value used to filter. The ${value2} is replaced by the greater value used to filter.","TableColumnNotBetweenFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is not between ${value1} and ${value2}","_TableColumnNotBetweenFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the smaller value used to filter. The ${value2} is replaced by the greater value used to filter.","TableColumnDynamicFilterLabel":"I applied a filter on \'${columnName}\' of table ${tableName}","_TableColumnDynamicFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnTopFilterLabel":"I applied a ${direction} ${count} filter on \'${columnName}\' of table ${tableName}","_TableColumnTopFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by a number.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableConvertToRangeLabel":"Convert table ${tableName} to range","_TableConvertToRangeLabel.comment":"Text to show in a list when a convert to range action was taken during script recording.","TableCreateAndFormatLabel":"I created and formatted a table ${tableName} on the range ${range}","_TableCreateAndFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableCreateLabel":"I created a table ${tableName} on the range ${range}","_TableCreateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableCustomSortLabel":"I applied a custom sort to table ${tableName}","_TableCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableClearSortLabel":"I removed sorting on table ${tableName}","_TableClearSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableFilterColumnLabel":"I applied a filter on the column \'${columnName}\' of table ${tableName} to include the following values: ${values}","_TableFilterColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and values variable/placeholder is replaced by a comma-separated list of unique values in the column. For example, I applied a filter on column Column1 of table Table1 to include the following values: A, B, C","TableFormatLabel":"I applied a new format on table ${tableName}","_TableFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHighlightFirstColumnFilterLabel":"I changed the highlighting on first column on table ${tableName}","_TableHighlightFirstColumnFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHighlightLastColumnLabel":"I changed the highlighting on last column on table ${tableName}","_TableHighlightLastColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableInsertColumnsLabel":"I inserted ${count} column(s) at column number ${columnNumber} of table ${tableName}","_TableInsertColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of columns inserted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableInsertRowsLabel":"I inserted ${count} row(s) at row number ${rowNumber} of table ${tableName}","_TableInsertRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of rows inserted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableReapplyFilterLabel":"Reapply filter on table ${tableName}","_TableReapplyFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveColumnsLabel":"I removed ${count} column(s) at column number ${columnNumber} of table ${tableName}","_TableRemoveColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of columns removed.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveRowsLabel":"I removed ${count} row(s) at row number ${rowNumber} of table ${tableName}","_TableRemoveRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of rows removed.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRenameLabel":"Rename table to ${tableName}","_TableRenameLabel.comment":"Text to show in a list when a rename table user action was taken during script recording","TableResizeLabel":"Resize table ${tableName}","_TableResizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRearrangeLabel":"Rearrange table row(s)","_TableRowsRearrangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableColumnsRearrangeLabel":"Rearrange table column(s)","_TableColumnsRearrangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableSortColumnLabel":"I sorted column ${columnNumber} of table ${tableName}","_TableSortColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was sorted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleAutoFilterLabel":"I changed the AutoFilter on table ${tableName}","_TableToggleAutoFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleHeaderRowLabel":"I changed the visibility of header row on table ${tableName}","_TableToggleHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddHeaderRowLabel":"I added header row on table ${tableName}","_TableAddHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveHeaderRowLabel":"I removed header row on table ${tableName}","_TableRemoveHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleTotalRowLabel":"I changed the visibility of total row on table ${tableName}","_TableToggleTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddTotalRowLabel":"I added total row on table ${tableName}","_TableAddTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveTotalRowLabel":"I removed total row on table ${tableName}","_TableRemoveTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","CellTextOrientationChanged":"I changed the text orientation of ${range} to ${orientation} degrees","_CellTextOrientationChanged.comment":"User-facing string describing the Excel event executed by Copilot. \'orientation\' is a number representing degrees out of 360, e.g. 45 or 90.","ColumnNameCellTextOrientationChanged":"I changed the text orientation of the column(s) \'${columnName}\' to ${orientation} degrees","_ColumnNameCellTextOrientationChanged.comment":"User-facing string describing the Excel event executed by Copilot. \'orientation\' is a number representing degrees out of 360, e.g. 45 or 90.","CellTextOrientationChangedGeneric":"Cell text orientation changed","_CellTextOrientationChangedGeneric.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} to ${orientation} degrees","_TableRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableBodyRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} body to ${orientation} degrees","_TableBodyRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableHeaderRowRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} header row to ${orientation} degrees","_TableHeaderRowRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableTotalRowRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} total row to ${orientation} degrees","_TableTotalRowRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableGeneralRangeCellTextOrientationChangedLabel":"I changed the text orientation of sub-range of table ${tableName} to ${orientation} degrees","_TableGeneralRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableRowsRangeCellTextOrientationChangedLabel":"I changed the text orientation of ${count} row(s) in table ${tableName} to ${orientation} degrees","_TableRowsRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableRowByIndexRangeCellTextOrientationChangedLabel":"I changed the text orientation of row at index ${rowIndex} in table ${tableName} to ${orientation} degrees","TableRowByIndexRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnsRangeCellTextOrientationChangedLabel":"I changed the text orientation of ${count} column(s) in table ${tableName} to ${orientation} degrees","_TableColumnsRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnByNameRangeCellTextOrientationChangedLabel":"I changed the text orientation of column \'${columnName}\' in table ${tableName} to ${orientation} degrees","_TableColumnByNameRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnByIndexRangeCellTextOrientationChangedLabel":"I changed the text orientation of column at index ${columnIndex} in table ${tableName} to ${orientation} degrees","_TableColumnByIndexRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","ChartRenamed":"Rename chart","_ChartRenamed.comment":"User-facing string describing the Excel event executed by Copilot.","CommentResolved":"Resolve comment","_CommentResolved.comment":"User-facing string describing the Excel event executed by Copilot.","TableDeleted":"I deleted the table","_TableDeleted.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetCalculated":"Calculate worksheet","_WorksheetCalculated.comment":"User-facing string describing the Excel event executed by Copilot.","IntentChangeRangeBorder":"I changed the range border","_IntentChangeRangeBorder.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatColorScale":"I created a conditional format color scale","_IntentCreateConditionalFormatColorScale.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatDataBar":"I created a Conditional Format data bar","_IntentCreateConditionalFormatDataBar.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatCellValue":"I created a Conditional Format cell rules","_IntentCreateConditionalFormatCellValue.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatPreset":"I created a Conditional Format preset criteria","_IntentCreateConditionalFormatPreset.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatContainsText":"I created a Conditional Format containing text","_IntentCreateConditionalFormatContainsText.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatTopBottom":"I created a Conditional Format with Top/Bottom rules","_IntentCreateConditionalFormatTopBottom.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatCustom":"I created a Conditional Format with custom rules","_IntentCreateConditionalFormatCustom.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatIconSet":"I created a Conditional Format with icon sets","_IntentCreateConditionalFormatIconSet.comment":"User-facing string describing the Excel event executed by Copilot.","IntentSetDataValidation":"I created a data validation rule","_IntentSetDataValidation.comment":"User-facing string describing the Excel event executed by Copilot.","FixedWidthTextToColumns":"Convert fixed width text to columns","_FixedWidthTextToColumns.comment":"User-facing string describing the Excel event executed by Copilot.","IntentRangeCopyFrom":"Copy range","_IntentRangeCopyFrom.comment":"User-facing string describing the Excel event executed by Copilot.","UndoLabel":"Undo","_UndoLabel.comment":"User-facing string describing the Excel event executed by Copilot.","UnknownEventLabel":"This action is not yet recordable","_UnknownEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","UnsupportedEventLabel":"This action cannot be recorded","_UnsupportedEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartAxisTitleHorizontal":"I set the axis title orientation to horizontal","_ChartAxisTitleHorizontal.comment":"Text to show in a list when axis title orientation is changed during script recording","ChartAxisTitleVertical":"I set the axis title orientation to vertical","_ChartAxisTitleVertical.comment":"Text to show in a list when axis title orientation is changed during script recording","ChartAxisDisplayUnit":"I changed the axis display unit","_ChartAxisDisplayUnit.comment":"Text to show in a list when axis display unit is changed during script recording","ChartAxisMajorGridilinesVisible":"I changed the axis major gridline visibility","_ChartAxisMajorGridilinesVisible.comment":"Text to show in a list when major gridline visibility is changed during script recording","ChartAxisMajorTickMark":"I changed the axis major tick mark","_ChartAxisMajorTickMark.comment":"Text to show in a list when major tick mark is changed during script recording","ChartAxisMinorTickMark":"I changed the axis minor tick mark","_ChartAxisMinorTickMark.comment":"Text to show in a list when minor tick mark is changed during script recording","ChartAxisMinorGridilinesVisible":"I changed the axis minor gridline visibility","_ChartAxisMinorGridilinesVisible.comment":"Text to show in a list when major gridline visibility is changed during script recording","ChartAxisTitleText":"I changed the axis title text","_ChartAxisTitleText.comment":"Text to show in a list when axis title text is changed during script recording","VisualChartAxisAxisTitleFillColoredLabel":"I set the fill color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFillColoredLabel.comment":"Text to show in a list when the fill color for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontBoldedLabel":"I set the font bold on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontBoldedLabel.comment":"Text to show in a list when the font bold style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontColoredLabel":"I set the font color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontColoredLabel.comment":"Text to show in a list when a visual.SetProperty(\'PlotArea0_Axis_PrimaryValue0_AxisTitle0_FontFormat_Color\') was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontItalicizedLabel":"I set the font italic on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontItalicizedLabel.comment":"Text to show in a list when the font italic style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontNamedLabel":"I set the font name on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontNamedLabel.comment":"Text to show in a list when the font name for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontSizedLabel":"I set the font size on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontSizedLabel.comment":"Text to show in a list when the font size for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontUnderlinedLabel":"I set the font underline on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontUnderlinedLabel.comment":"Text to show in a list when the font underline style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleLineColoredLabel":"I set the line color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleTextChangedLabel":"I set the text on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleTextChangedLabel.comment":"Text to show in a list when the text for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisBoundsMaxChangedLabel":"I set the bounds max on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisBoundsMaxChangedLabel.comment":"Text to show in a list when the maximum value for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisBoundsMinChangedLabel":"I set the bounds min on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisBoundsMinChangedLabel.comment":"Text to show in a list when the minimum value for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisCrossesAtChangedLabel":"I set the crossesAt on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisCrossesAtChangedLabel.comment":"Text to show in a list when the specified axis position where the other axis crosses at for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisCrossesChangedLabel":"I set the crosses on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisCrossesChangedLabel.comment":"Text to show in a list when the specified axis position where the other axis crosses was changed by the ChartFormat add-in during script recording","VisualChartAxisFillColoredLabel":"I set the fill color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFillColoredLabel.comment":"Text to show in a list when the fill color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontBoldedLabel":"I set the font bold on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontBoldedLabel.comment":"Text to show in a list when the font bold style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontColoredLabel":"I set the font color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontColoredLabel.comment":"Text to show in a list when the font color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontItalicizedLabel":"I set the font italic on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontItalicizedLabel.comment":"Text to show in a list when the font italic style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontNamedLabel":"I set the font name on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontNamedLabel.comment":"Text to show in a list when the font name for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontSizedLabel":"I set the font size on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontSizedLabel.comment":"Text to show in a list when the font size for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontUnderlinedLabel":"I set the font underline on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontUnderlinedLabel.comment":"Text to show in a list when the font underline style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisLineColoredLabel":"I set the line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisMajorGridlinesLineColoredLabel":"I set the major grid line\'s line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisMajorGridlinesLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis major gridlines was changed by the ChartFormat add-in during script recording","VisualChartAxisMinorGridlinesLineColoredLabel":"I set the minor grid line\'s line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisMinorGridlinesLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis minor gridlines was changed by the ChartFormat add-in during script recording","VisualChartAxisNumberFormatCodeChangedLabel":"I set the numberFormat on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisNumberFormatCodeChangedLabel.comment":"Text to show in a list when the numberFormat for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisReversePlotOrderChangedLabel":"I set the reverse plot order on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisReversePlotOrderChangedLabel.comment":"Text to show in a list when the reverse plot order for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisTickMarksMajorTypeChangedLabel":"I set the major tick mark on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisTickMarksMajorTypeChangedLabel.comment":"Text to show in a list when the type of major tick mark for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisTickMarksMinorTypeChangedLabel":"I set the minor tick mark on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisTickMarksMinorTypeChangedLabel.comment":"Text to show in a list when the type of minor tick mark for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisUnitsMajorUnitChangedLabel":"I set the units major unit on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisUnitsMajorUnitChangedLabel.comment":"Text to show in a list when the interval between two major tick marks for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisUnitsMinorUnitChangedLabel":"I set the units minor unit on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisUnitsMinorUnitChangedLabel.comment":"Text to show in a list when the interval between two minor tick marks for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartTitleFillColoredLabel":"I set the fill color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFillColoredLabel.comment":"Text to show in a list when the fill color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontBoldedLabel":"I set the font bold on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontBoldedLabel.comment":"Text to show in a list when the font bold style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontColoredLabel":"I set the font color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontColoredLabel.comment":"Text to show in a list when the font color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontItalicizedLabel":"I set the font italic on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontItalicizedLabel.comment":"Text to show in a list when the font italic style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontNamedLabel":"I set the font name on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontNamedLabel.comment":"Text to show in a list when the font name of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontSizedLabel":"I set the font size on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontSizedLabel.comment":"Text to show in a list when the font size of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontUnderlinedLabel":"I set the font underline on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontUnderlinedLabel.comment":"Text to show in a list when the font underline style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleLineColoredLabel":"I set the line color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleLineColoredLabel.comment":"Text to show in a list when the line color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleOverlayChangedLabel":"I set the position on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleOverlayChangedLabel.comment":"Text to show in a list when the overlay of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleTextChangedLabel":"I set the text on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleTextChangedLabel.comment":"Text to show in a list when the text of a chart title was changed by the ChartFormat add-in during script recording","VisualLegendFillClearedLabel":"I cleared the legend fill color","_VisualLegendFillClearedLabel.comment":"Text to show in a list when the fill color of a chart legend was cleared by the ChartFormat add-in during script recording","VisualLegendFillColoredLabel":"I set the fill color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFillColoredLabel.comment":"Text to show in a list when the fill color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontBoldedLabel":"I set the font bold on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontBoldedLabel.comment":"Text to show in a list when the font bold style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontColoredLabel":"I set the font color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontColoredLabel.comment":"Text to show in a list when the font color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontItalicizedLabel":"I set the font italic on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontItalicizedLabel.comment":"Text to show in a list when the font italic style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontNamedLabel":"I set the font name on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontNamedLabel.comment":"Text to show in a list when font name of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontSizedLabel":"I set the font size on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontSizedLabel.comment":"Text to show in a list when font size of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontUnderlinedLabel":"I set the font underline on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontUnderlinedLabel.comment":"Text to show in a list when font underline style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineClearedLabel":"I cleared the legend line color","_VisualLegendLineClearedLabel.comment":"Text to show in a list when the line color of a chart legend was cleared by the ChartFormat add-in during script recording","VisualLegendLineStyleChangedLabel":"I changed the legend line style","_VisualLegendLineStyleChangedLabel.comment":"Text to show in a list when the line style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineWeightChangedLabel":"I cleared the legend line weight","_VisualLegendLineWeightChangedLabel.comment":"Text to show in a list when the line weight of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineColoredLabel":"I set the line color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendLineColoredLabel.comment":"Text to show in a list when the line color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendOverlayChangedLabel":"I set the overlay on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendOverlayChangedLabel.comment":"Text to show in a list when the overlay of a chart legend was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinCountLabel":"I set the binOptions\' count on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinCountLabel.comment":"Text to show in a list when the binOptions\' count property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinWidthLabel":"I set the binOption\'s width on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinWidthLabel.comment":"Text to show in a list when the binOptions\' width property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinningTypeLabel":"I set the binOption\'s type on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinningTypeLabel.comment":"Text to show in a list when the binOptions\' type property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsOverflowEnabledLabel":"I set the binOption\'s allowOverflow on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsOverflowEnabledLabel.comment":"Text to show in a list when the binOptions\' allowOverflow property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsOverflowValueLabel":"I set the binOption\'s overflowValue on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsOverflowValueLabel.comment":"Text to show in a list when the binOptions\' overflowValue property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsUnderflowEnabledLabel":"I set the binOption\'s allowUnderflow on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsUnderflowEnabledLabel.comment":"Text to show in a list when the binOptions\' allowUnderflow property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsUnderflowValueLabel":"I set the binOption\'s underflowValue on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsUnderflowValueLabel.comment":"Text to show in a list when the binOptions\' underflowValue property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerQuartileCalculationLabel":"I set the boxwhiskerOptions\'s quartileCalculation on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerQuartileCalculationLabel.comment":"Text to show in a list when the boxwhiskerOptions\' quartileCalculation property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowInnerPointsLabel":"I set the boxwhiskerOptions\'s showInnerPoints on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowInnerPointsLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showInnerPoints property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowMeanLineLabel":"I set the boxwhiskerOptions\'s showMeanLine on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowMeanLineLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showMeanLine property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowMeanMarkerLabel":"I set the boxwhiskerOptions\'s showMeanMarker on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowMeanMarkerLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showMeanMarker property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowOutliersLabel":"I set the boxwhiskerOptions\'s showOutlierPoints on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowOutliersLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showOutlierPoints property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBubbleScaleSizedLabel":"I set the bubbleScale on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBubbleScaleSizedLabel.comment":"Text to show in a list when the bubbleScale property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesDataLabelsContainsCategoryNameToggledLabel":"I set the visibility of the data label category name on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsCategoryNameToggledLabel.comment":"Text to show in a list when the visibility of the data label category name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel":"I set the separator used for the data label on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel.comment":"Text to show in a list when the separator used for the data label on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsLegendKeyToggledLabel":"I set the visibility of the data label legend key on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsLegendKeyToggledLabel.comment":"Text to show in a list when the visibility of the data label legend key on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsSeparatorChangedLabel":"I set the predefined separator of the data label on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsSeparatorChangedLabel.comment":"Text to show in a list when the predefined separator of the data label on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsSeriesNameToggledLabel":"I set the visibility of the data label series name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsSeriesNameToggledLabel.comment":"Text to show in a list when the data label series name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsValueToggledLabel":"I set the visibility of the data label value on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsValueToggledLabel.comment":"Text to show in a list when the data label value on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFillFormatColoredLabel":"I set the data label\'s fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFillFormatColoredLabel.comment":"Text to show in a list when the data label\'s fill color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatBoldedLabel":"I set the data label\'s font bold style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatBoldedLabel.comment":"Text to show in a list when the data label\'s font bold style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatColoredLabel":"I set the data label\'s font color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatColoredLabel.comment":"Text to show in a list when the data label\'s font color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatItaliizedcLabel":"I set the data label\'s font italic style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatItaliizedcLabel.comment":"Text to show in a list when the data label\'s font italic style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatNamedLabel":"I set the data label\'s font name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatNamedLabel.comment":"Text to show in a list when the data label\'s font name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatSizedLabel":"I set the data label\'s font size for chart ${chartName}","_VisualSeriesDataLabelsFontFormatSizedLabel.comment":"Text to show in a list when the data label\'s font size on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatUnderlinedLabel":"I set the data label\'s font underline style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatUnderlinedLabel.comment":"Text to show in a list when the data label\'s font underline style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsLineFormatColoredLabel":"I set the data label\'s line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsLineFormatColoredLabel.comment":"Text to show in a list when the data label\'s line color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsNumberFormatCodeChangedLabel":"I set the data label\'s number format on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsNumberFormatCodeChangedLabel.comment":"Text to show in a list when the data label\'s number format on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsPositionedLabel":"I set the data label\'s position on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsPositionedLabel.comment":"Text to show in a list when the data label\'s position on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDoughnutHoleSizedLabel":"I set the dough nut hole size on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDoughnutHoleSizedLabel.comment":"Text to show in a list when the doughnut hole size of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesFillColoredLabel":"I set the fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesFillColoredLabel.comment":"Text to show in a list when the fill color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesGapWidthChangedLabel":"I set the gap width on series for chart ${chartName}","_VisualSeriesGapWidthChangedLabel.comment":"Text to show in a list when the gap width of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesLineColoredLabel":"I set the line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesLineColoredLabel.comment":"Text to show in a list when the line color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersFillColoredLabel":"I set the markers fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersFillColoredLabel.comment":"Text to show in a list when the markers background color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersLineColoredLabel":"I set the markers line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersLineColoredLabel.comment":"Text to show in a list when the markers foreground color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersMarkerSizedLabel":"I set the maker size on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersMarkerSizedLabel.comment":"Text to show in a list when the marker size of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersMarkerStyleChangedLabel":"I set the maker style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersMarkerStyleChangedLabel.comment":"Text to show in a list when the marker style of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesNamedLabel":"I set the name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesNamedLabel.comment":"Text to show in a list when the name property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesTreemapParentLabelStrategyLabel":"I set the parentLabelStrategy on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTreemapParentLabelStrategyLabel.comment":"Text to show in a list when the parentLabelStrategy property for a treemap chart series was changed by the ChartFormat add-in during script recording","VisualSeriesVaryColorsBySliceChangedLabel":"I set the vary color by slice on series ${seriesIndex} for chart ${chartName}","_VisualSeriesVaryColorsBySliceChangedLabel.comment":"Text to show in a list when the varyByCategories property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesWaterfallShowConnectorLinesLabel":"I set the showConnectorLines on series ${seriesIndex} for chart ${chartName}","_VisualSeriesWaterfallShowConnectorLinesLabel.comment":"Text to show in a list when the showConnectorLines property for a waterfall chart series was changed by the ChartFormat add-in during script recording","VisualSeriesTrendlineTypeSetLabel":"I set the trendline type on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineTypeSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineNameChangedLabel":"I set the trendline name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineNameChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineEquationDisplayedLabel":"I set the trendline equation visibility on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineEquationDisplayedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineRSquaredDisplayedLabel":"I set the trendline R squared visibility on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineRSquaredDisplayedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineInterceptSetLabel":"I set the trendline intercept on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineInterceptSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineManualSetLabel":"I set the trendline intercept manually on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineManualSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineAutomaticSetLabel":"I set the trendline intercept automatically on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineAutomaticSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineLineFormatColoredLabel":"I set the trendline\'s line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineLineFormatColoredLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineForecastForwardSetLabel":"I set the trendline forward forecast on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineForecastForwardSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineForecastBackwardSetLabel":"I set the trendline backward forecast on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineForecastBackwardSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleAddedRemovedLabel":"I changed the visibility of title for chart ${chartName}","_VisualChartTitleAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleAddedLabel":"I added title for chart ${chartName}","_VisualChartTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleRemovedLabel":"I removed title for chart ${chartName}","_VisualChartTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendAddedRemovedLabel":"I changed the visibility of legend for chart ${chartName}","_VisualLegendAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendAddedLabel":"I added legend for chart ${chartName}","_VisualLegendAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendRemovedLabel":"I removed legend for chart ${chartName}","_VisualLegendRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartAxisAxisTitleAddedRemovedLabel":"I changed the visibility of ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisAxisTitleAddedLabel":"I added ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisAxisTitleRemovedLabel":"I removed ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesAddedRemovedLabel":"I changed the visibility of ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesAddedLabel":"I added ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesRemovedLabel":"I removed ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesAddedRemovedLabel":"I changed the visibility of ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesAddedLabel":"I added ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesRemovedLabel":"I removed ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualSerriesErrorBarXAddedRemovedLabel":"I changed the visibility of horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSerriesErrorBarXAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarXAddedLabel":"I added horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarXAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarXRemovedLabel":"I removed horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarXRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesErrorBarYAddedRemovedLabel":"I changed the visibility of vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSerriesErrorBarYAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarYAddedLabel":"I added vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarYAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarYRemovedLabel":"I removed vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarYRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesTrendlineAddedLabel":"Add trendline to series ${seriesIndex} of chart ${chartName}","_VisualSerriesTrendlineAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesTrendlineRemovedLabel":"I removed the trendline ${trendlineIndex} from series ${seriesIndex} of chart ${chartName}","_VisualSerriesTrendlineRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.  The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesTrendlineTitleAddedLabel":"Add a equation to trendline ${trendlineIndex} of series ${seriesIndex} of chart ${chartName}","_VisualSeriesTrendlineTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index. The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesTrendlineTitleRemovedLabel":"I removed the equation and/or R Squared value from trendline ${trendlineIndex} of series ${seriesIndex} of chart ${chartName}","_VisualSeriesTrendlineTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index. The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesDataLabelsAddedRemovedLabel":"I changed the visibility of data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesDataLabelsAddedLabel":"I added data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesDataLabelsRemovedLabel":"I removed data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","ChartTitleFillClearedLabel":"Chart title fill cleared","_ChartTitleFillClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleLineClearedLabel":"Chart title line cleared","_ChartTitleLineClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleLineStyleChangedLabel":"Chart title line style changed","_ChartTitleLineStyleChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleWeightChangedLabel":"Chart title line weight changed","_ChartTitleWeightChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorkbookRecalculateLabel":"Recalculate workbook","_WorkbookRecalculateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorkbookRefreshAllLabel":"Refresh all data connections in workbook","_WorkbookRefreshAllLabel.comment":"Text to show in a list when a refresh all user action was taken during script recording.","WorkbookSetCalculationModeLabel":"I set the calculation mode","_WorkbookSetCalculationModeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetAddLabel":"Add worksheet","_WorksheetAddLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetAddedWithNameLabel":"Add worksheet with name ${worksheetName}","_WorksheetAddedWithNameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and worksheetName variable/placeholder is replaced by the new name of the worksheet.","WorksheetChartAxisTitleChangeTextLabel":"I changed the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartAxisTitleChangeTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetCharTitleChangeTextLabel":"I changed the title of chart ${chartName} on sheet ${sheet}","_WorksheetCharTitleChangeTextLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on. The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartChangeAxisLabel":"I changed the axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisLabel.comment":"Text to show in a list when a change Chart axis user action was taken during script recording","WorksheetChartChangeAxisTitleLabel":"I changed the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisTitleLabel.comment":"Text to show in a list when a change Chart axis title user action was taken during script recording","WorksheetChartChangeAxisVisibilityLabel":"I changed the visibility of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisVisibilityLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartAddAxisLabel":"I added axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartAddAxisLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartRemoveAxisLabel":"I removed axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartRemoveAxisLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartChangeGridlineVisiblityLabel":"I changed the visibility of gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeGridlineVisiblityLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartAddGridlineLabel":"I added gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartAddGridlineLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartRemoveGridlineLabel":"I removed gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartRemoveGridlineLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartChangeLegendLabel":"I changed the legend for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeLegendLabel.comment":"Text to show in a list when a change Chart legend user action was taken during script recording","WorksheetChartChangeTitleLabel":"I changed the title for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeTitleLabel.comment":"Text to show in a list when a Change Chart Title user action was taken during script recording","WorksheetChartChangeTypeLabel":"I changed the chart type for ${chartName} on sheet ${sheet}","_WorksheetChartChangeTypeLabel.comment":"Text to show in a list when a Change Chart Type user action was taken during script recording","WorksheetChartDataLabelChangePositionLabel":"I changed the position of data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelChangePositionLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelChangeVisibilityLabel":"I changed the visibility of data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelChangeVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelAddedLabel":"I added data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelRemovedLabel":"I removed data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDeleteLabel":"I deleted the chart ${chartName} on sheet ${sheet}","_WorksheetChartDeleteLabel.comment":"Text to show in a list when a chart delete user action was taken during script recording","WorksheetChartHideAxisTitleLabel":"I hid the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideAxisTitleLabel.comment":"Text to show in a list when a hide Chart axis title user action was taken during script recording","WorksheetChartHideLegendLabel":"I hid the legend for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideLegendLabel.comment":"Text to show in a list when a change Chart legend user action was taken during script recording","WorksheetChartHideTitleLabel":"I hid the title for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideTitleLabel.comment":"Text to show in a list when a Hide Chart Title user action was taken during script recording","WorksheetChartMoveAndResizeLabel":"Move or resize chart ${chartName} on sheet ${sheet}","_WorksheetChartMoveAndResizeLabel.comment":"Text to show in a list when a chart move or resize user action was taken during script recording","WorksheetChartSelectDataLabel":"Select data for chart ${chartName} on sheet ${sheet}","_WorksheetChartSelectDataLabel.comment":"Text to show in a list when a Select Chart Data user action was taken during script recording","WorksheetChartSwitchRowColumnLabel":"Switch row/column for chart ${chartName} on sheet ${sheet}","_WorksheetChartSwitchRowColumnLabel.comment":"Text to show in a list when a Switch Chart Row and Column user action was taken during script recording","WorksheetClearFiltersLabel":"I cleared the filters on worksheet ${sheet}","_WorksheetClearFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetClearTabColorLabel":"I cleared the worksheet tab color on worksheet ${sheet}","_WorksheetClearTabColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetCreateChartLabel":"I created a chart on worksheet ${sheet}","_WorksheetCreateChartLabel.comment":"Text to show in a list when a Create Chart user action was taken during script recording","SlicerInsertedLabel":"I created a slicer with pivot ${pivotName} from pivot table ${pivotTable}","_SlicerInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot the slicer is associated with.  The $ and pivotTable variable/placeholder is replaced by the name of the source pivot table","WorksheetTableRangeCreateChartLabel":"I created a chart on worksheet ${sheet} with source data from table ${table}","_WorksheetTableRangeCreateChartLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet the chart was inserted on.  The $ and table variable/placeholder is replaced by the name of the source data table","WorksheetCustomFilterAppliedLabel":"I applied a custom filter to ${range}","_WorksheetCustomFilterAppliedLabel.comment":"Text to show in a list when a worksheet custom filter user action was taken during script recording","WorksheetDeleteLabel":"I deleted the worksheet","_WorksheetDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetDeleteMultipleLabel":"I deleted ${count} worksheets","_WorksheetDeleteMultipleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and count variable/placeholder is replaced by the number of sheets deleted","WorksheetDuplicateLabel":"Duplicate worksheet ${sheet}","_WorksheetDuplicateLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the duplicated sheet.","WorksheetDynamicFilterAppliedLabel":"I applied a dynamic filter to ${range}","_WorksheetDynamicFilterAppliedLabel.comment":"Text to show in a list when a worksheet dynamic filter user action was taken during script recording","WorksheetFloatingObjectDeleteLabel":"I deleted the object on sheet ${sheet}","_WorksheetFloatingObjectDeleteLabel.comment":"Text to show in a list when an object delete user action was taken during script recording","WorksheetFloatingObjectMoveAndResizeLabel":"Move or resize object on sheet ${sheet}","_WorksheetFloatingObjectMoveAndResizeLabel.comment":"Text to show in a list when an object move or resize user action was taken during script recording","WorksheetFloatingObjectZOrderChangedLabel":"I changed the z-order of object on sheet ${sheet}","_WorksheetFloatingObjectZOrderChangedLabel.comment":"Text to show in a list when an object change z-order type user action was taken during script recording","WorksheetFreezePaneLabel":"Freeze worksheet panes","_WorksheetFreezePaneLabel.comment":"Text to show in a list when a worksheet pane freeze user action was taken during script recording","WorksheetFreezeRowsLabel":"Freeze worksheet rows","_WorksheetFreezeRowsLabel.comment":"Text to show in a list when a worksheet row freeze user action was taken during script recording","WorksheetFreezeColumnsLabel":"Freeze worksheet columns","_WorksheetFreezeColumnsLabel.comment":"Text to show in a list when a worksheet column freeze user action was taken during script recording","WorksheetHideGridlinesLabel":"I hid the gridlines on worksheet ${sheet}","_WorksheetHideGridlinesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetHideHeadingsLabel":"I hid the headings on worksheet ${sheet}","_WorksheetHideHeadingsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetOutlineLevelsSetLabel":"I set the outline level on sheet ${sheet}","_WorksheetOutlineLevelsSetLabel.comment":"Text to show in a list when an outline set user action was taken during script recording","WorksheetReapplyFiltersLabel":"Reapply filters on worksheet ${sheet}","_WorksheetReapplyFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetRenameLabel":"Rename worksheet to ${worksheetName}","_WorksheetRenameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and worksheetName variable/placeholder is replaced by the new name of the worksheet.","WorksheetReorderLabel":"Reorder worksheet ${sheet}","_WorksheetReorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetSetTabColorLabel":"I set the worksheet tab color to ${color} on worksheet ${sheet}","_WorksheetSetTabColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new tab color.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetShapeAltTextApplyLabel":"I applied an alt text to shape on sheet ${sheet}","_WorksheetShapeAltTextApplyLabel.comment":"Text to show in a list when an shape alt text apply user action was taken during script recording","WorksheetShapeInsertedLabel":"I created a shape on sheet ${sheet}","_WorksheetShapeInsertedLabel.comment":"Text to show in a list when a create shape user action was taken during script recording","WorksheetShapeRotateLabel":"Rotate shape on sheet ${sheet}","_WorksheetShapeRotateLabel.comment":"Text to show in a list when an shape rotate user action was taken during script recording","WorksheetShapeSetStyleLabel":"I set the style on shape on sheet ${sheet}","_WorksheetShapeSetStyleLabel.comment":"Text to show in a list when a shape set style user action was taken during script recording","WorksheetShapeTextChangedLabel":"I set the text on shape on sheet ${sheet}","_WorksheetShapeTextChangedLabel.comment":"Text to show in a list when a shape text changed user action was taken during script recording","WorksheetShapeTextBoldedLabel":"I bolded the text of shape on sheet ${sheet}","_WorksheetShapeTextBoldedLabel.comment":"Text to show in a list when bold style for text of a shape was changed during script recording","WorksheetShapeTextUnboldedLabel":"I unbolded the text of shape on sheet ${sheet}","_WorksheetShapeTextUnboldedLabel.comment":"Text to show in a list when bold style for text of a shape was changed during script recording","WorksheetShapeTextItalicizedLabel":"I italicized the text of shape on sheet ${sheet}","_WorksheetShapeTextItalicizedLabel.comment":"Text to show in a list when italic style for text of a shape was changed during script recording","WorksheetShapeTextUnitalicizedLabel":"I removed italics from text of shape on sheet ${sheet}","_WorksheetShapeTextUnitalicizedLabel.comment":"Text to show in a list when italic style for text of a shape was changed during script recording","WorksheetShapeTextUnderlinedLabel":"I underlined the text of shape on sheet ${sheet}","_WorksheetShapeTextUnderlinedLabel.comment":"Text to show in a list when underline style for text of a shape was changed during script recording","WorksheetShapeTextUnderlineRemovedLabel":"I removed underlining from text of shape on sheet ${sheet}","_WorksheetShapeTextUnderlineRemovedLabel.comment":"Text to show in a list when underline style for text of a shape was changed during script recording","WorksheetShapeTextFontNameChangedLabel":"I set the font name to ${fontName} for shape on sheet ${sheet}","_WorksheetShapeTextFontNameChangedLabel.comment":"Text to show in a list when font name for text of a shape was changed during script recording","WorksheetShapeTextFontSizeChangedLabel":"I set the font size to ${fontSize} for shape on sheet ${sheet}","_WorksheetShapeTextFontSizeChangedLabel.comment":"Text to show in a list when font size for text of a shape was changed during script recording","WorksheetShapeTextFontColorChangedLabel":"I set the font color to ${fontColor} for shape on sheet ${sheet}","_WorksheetShapeTextFontColorChangedLabel.comment":"Text to show in a list when font color for text of a shape was changed during script recording","WorksheetShapeTextHorizontallyAlignedLabel":"I set the horizontal alignment on shape on sheet ${sheet}","_WorksheetShapeTextHorizontallyAlignedLabel.comment":"Text to show in a list when horiontal alignment for text of a shape was changed during script recording","WorksheetShapeTextVerticallyAlignedLabel":"I set the vertical alignment on shape on sheet ${sheet}","_WorksheetShapeTextVerticallyAlignedLabel.comment":"Text to show in a list when vertical alignment for text of a shape was changed during script recording","WorksheetShowGridlinesLabel":"Show gridlines on worksheet ${sheet}","_WorksheetShowGridlinesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetShowHeadingsLabel":"Show headings on worksheet ${sheet}","_WorksheetShowHeadingsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetToggleAutoFilterLabel":"I changed the AutoFilter on worksheet ${sheet}","_WorksheetToggleAutoFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetUnFreezePaneLabel":"Unfreeze worksheet panes","_WorksheetUnFreezePaneLabel.comment":"Text to show in a list when a worksheet pane unfreeze user action was taken during script recording","WorksheetValuesFilterAppliedLabel":"I applied a values filter to ${range}","_WorksheetValuesFilterAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetVisibilityChangedLabel":"I changed the worksheet visibility","_WorksheetVisibilityChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MoveToEdgeLabel":"Select data region","_MoveToEdgeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetCellColorFilterLabel":"I applied a cell color filter on ${range} to show only rows that are highlighted ${color}","_WorksheetCellColorFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetFontColorFilterLabel":"I applied a font color filter on ${range} to show only rows that contain ${color} text","_WorksheetFontColorFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetTopItemsFilterLabel":"I applied a top ${criterion} filter on ${range}","_WorksheetTopItemsFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetTopPercentFilterLabel":"I applied a top ${criterion}% filter on ${range}","_WorksheetTopPercentFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetBottomItemsFilterLabel":"I applied a bottom ${criterion} filter on ${range}","_WorksheetBottomItemsFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetBottomPercentFilterLabel":"I applied a bottom ${criterion}% filter on ${range}","_WorksheetBottomPercentFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetDefaultFilterLabel":"I applied a top ${criterion} filter on ${range}","_WorksheetDefaultFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetRangeClearFiltersLabel":"I removed all filters on ${range}","_WorksheetRangeClearFiltersLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetColumnClearFilterLabel":"I removed a filter on ${range}","_WorksheetColumnClearFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event"}}')}},i={};function l(e){var t=i[e];if(void 0!==t)return t.exports;var a=i[e]={id:e,loaded:!1,exports:{}};return r[e].call(a.exports,a,a.exports,l),a.loaded=!0,a.exports}l.m=r,l.amdO={},e=[],l.O=(t,a,n,o)=>{if(!a){var r=1/0;for(d=0;d<e.length;d++){for(var[a,n,o]=e[d],i=!0,s=0;s<a.length;s++)(!1&o||r>=o)&&Object.keys(l.O).every((e=>l.O[e](a[s])))?a.splice(s--,1):(i=!1,o<r&&(r=o));if(i){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,n,o]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},a=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var o=Object.create(null);l.r(o);var r={};t=t||[null,a({}),a([]),a(a)];for(var i=2&n&&e;"object"==typeof i&&!~t.indexOf(i);i=a(i))Object.getOwnPropertyNames(i).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,l.d(o,r),o},l.d=(e,t)=>{for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,a)=>(l.f[a](e,t),t)),[])),l.u=e=>e+".js",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},o="TypeScriptModule:",l.l=(e,t,a,r)=>{if(n[e])n[e].push(t);else{var i,s;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==o+a){i=u;break}}i||(s=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,l.nc&&i.setAttribute("nonce",l.nc),i.setAttribute("data-webpack",o+a),i.src=e),n[e]=[t];var m=(t,a)=>{i.onerror=i.onload=null,clearTimeout(g);var o=n[e];if(delete n[e],i.parentNode&&i.parentNode.removeChild(i),o&&o.forEach((e=>e(a))),t)return t(a)},g=setTimeout(m.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=m.bind(null,i.onerror),i.onload=m.bind(null,i.onload),s&&document.head.appendChild(i)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),l.j="cloudFilePickerDialog",(()=>{var e;l.g.importScripts&&(e=l.g.location+"");var t=l.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var n=a.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=a[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),l.p=e})(),(()=>{l.b=document.baseURI||self.location.href;var e={cloudFilePickerDialog:0};l.f.j=(t,a)=>{var n=l.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else{var o=new Promise(((a,o)=>n=e[t]=[a,o]));a.push(n[2]=o);var r=l.p+l.u(t),i=new Error;l.l(r,(a=>{if(l.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=a&&("load"===a.type?"missing":a.type),r=a&&a.target&&a.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",i.name="ChunkLoadError",i.type=o,i.request=r,n[1](i)}}),"chunk-"+t,t)}},l.O.j=t=>0===e[t];var t=(t,a)=>{var n,o,[r,i,s]=a,c=0;if(r.some((t=>0!==e[t]))){for(n in i)l.o(i,n)&&(l.m[n]=i[n]);if(s)var d=s(l)}for(t&&t(a);c<r.length;c++)o=r[c],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return l.O(d)},a=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),l.nc=void 0,l.O(void 0,["chunkfluentui","chunkoffice1js","augloop-chunk","office-iss","vendors~shared","vendors~cloudFilePickerDialog"],(()=>l(53012)));var s=l.O(void 0,["chunkfluentui","chunkoffice1js","augloop-chunk","office-iss","vendors~shared","vendors~cloudFilePickerDialog"],(()=>l(15835)));s=l.O(s),TypeScriptModule=s})();
//# sourceMappingURL=cloudFilePickerDialog.js.map