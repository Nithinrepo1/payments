(self.webpackChunksdx_pptnarrativeview=self.webpackChunksdx_pptnarrativeview||[]).push([[1804],{33602:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CreateAugloopSessionModule:()=>i.M}),3023==o.j)var i=o(38534)},18554:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CategoryLocalizationSlimModule:()=>i.N}),3023==o.j)var i=o(20510)},20558:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{NudgeUXModule:()=>i.B}),3023==o.j)var i=o(91096)},41435:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{UXModules:()=>s}),3023==o.j)var i=o(22411);if(3023==o.j)var n=o(96801);if(3023==o.j)var r=o(41906);class s{constructor(){this.imports=[r.q,n.y]}get uniqueId(){return(0,i.z)(507363479)}}},41906:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>u}),3023==o.j)var i=o(22411);if(3023==o.j)var n=o(18846);if(3023==o.j)var r=o(93589);if(3023==o.j)var s=o(34732);if(3023==o.j)var a=o(19559);if(3023==o.j)var l=o(24319);if(3023==o.j)var c=o(39427);class u{constructor(){this.imports=[r.f,n.D,a.I,c.p,s.S,l.O]}get uniqueId(){return(0,i.z)(507363480)}}},26712:(e,t,o)=>{"use strict";o.d(t,{A:()=>n});var i=o(81787);class n{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,o)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=n.Rejected,void o(t)}this.prevSeq=-1}e!=this.prevSeq+1&&i.tG.warn(542712385,i.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const r={seq:e,resolve:t};this.insertItem(r),this.runInOrder(r,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,o=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(o?(o.prev=e,e.next=o):this.lastQueueItem=e);o=t,t=t.prev}while(t);o&&(o.prev=e),e.next=o,this.firstQueueItem=e}runInOrder(e,t,o){let i=this.prevSeq,n=!1;const r=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(i+1!=t.seq&&(!o||t.seq>e.seq))break;i=t.seq,t.timeout&&clearTimeout(t.timeout),r.push(t),e==t&&(n=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}r.length>0&&setTimeout((()=>{for(const e of r)e.resolve(e.seq)}),0),this.prevSeq=i,!n&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}n.Rejected="SequenceItemRejected"},71200:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>d,n:()=>u}),3023==o.j)var i=o(33674);if(3023==o.j)var n=o(31987);if(3023==o.j)var r=o(7553);var s=o(26394),a=o.n(s);const l=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,c=/[.!?]/g;function u(e,t){const o=[],i=g(e,t);return i&&o.push(i),o}function d(e,t){const o=[],r=g(e,t);r&&o.push(r);const s=function(e,t,o){var r,s,a,l,c,u;const d=e,g=t;if((null==d?void 0:d.ipPosition)!==(null==g?void 0:g.ipPosition)||(null==d?void 0:d.isColdIp)!==(null==g?void 0:g.isColdIp)){if((null==d?void 0:d.isColdIp)===(null==g?void 0:g.isColdIp)&&o)if(o.deltaType===i.WI.Add){if((null==g?void 0:g.ipPosition)===(null!==(r=o.position)&&void 0!==r?r:0)+(null!==(s=o.length)&&void 0!==s?s:0))return}else if(o.deltaType===i.WI.Update){if((null==g?void 0:g.ipPosition)===(null!==(a=o.position)&&void 0!==a?a:0)+(null!==(c=null===(l=o.content)||void 0===l?void 0:l.length)&&void 0!==c?c:0))return}else if(o.deltaType===i.WI.Delete&&(null==g?void 0:g.ipPosition)===(null!==(u=o.position)&&void 0!==u?u:0))return;return new n.s({deltaType:i.WI.CursorUpdate,cursorData:{ipPosition:null==g?void 0:g.ipPosition,isColdIp:null==g?void 0:g.isColdIp}})}}(e,t,r);s&&o.push(s);const l=function(e,t,o){var r,s,l,c,u,d,g;const h=e,p=t;if((null===(r=p.formattedRanges)||void 0===r?void 0:r.length)<=(null===(s=h.formattedRanges)||void 0===s?void 0:s.length))if(o){let e=h.formattedRanges?[...h.formattedRanges]:[];const t=function(e,t,o){if(!e)return;if(t.deltaType===i.WI.Add){const t=e.find((e=>e.start===o&&0===e.length));if(t)return t;o=Math.max(o-1,0)}const n=e.find((e=>0===e.length?e.start===o:e.start<=o&&o<e.start+e.length));return n}(h.formattedRanges,o,o.position),n=t?e.indexOf(t):-1;if(-1!==n&&(o.position+(o.length||0)>t.start+t.length?t.length=o.position+(null!==(l=o.content)&&void 0!==l?l:"").length-t.start:t.length+=(null!==(c=o.content)&&void 0!==c?c:"").length-(o.length||0),e[n]=t),e.length>0){for(const t of e.slice(n+1))t.start<o.position||(o.position+(o.length||0)>t.start?(t.length=t.start+t.length-(o.position+(o.length||0)),t.start=o.position+(null!==(u=o.content)&&void 0!==u?u:"").length):t.start+=(null!==(d=o.content)&&void 0!==d?d:"").length-(o.length||0));e=e.filter((e=>e.length>0))}const r=null!==(g=null==p?void 0:p.formattedRanges)&&void 0!==g?g:[];if(a()(e,r)||0===e.length&&0===r.length)return}else if(a()(null==h?void 0:h.formattedRanges,null==p?void 0:p.formattedRanges))return;return new n.s({deltaType:i.WI.FormattingUpdate,formattedRanges:null==p?void 0:p.formattedRanges})}(e,t,r);l&&o.push(l);const c=function(e,t){const o=e,r=t;let s;const l={};let c=!1;for(s in r)-1===["ipPosition","isColdIp","content","formattedRanges"].indexOf(s)&&(a()(r[s],o[s])||(c=!0,l[s]=r[s]));if(c)return new n.s({deltaType:i.WI.OtherNonContentUpdate,otherNonContentData:l})}(e,t);return c&&o.push(c),o}function g(e,t){const o=e.content,s=t.content,a=(0,r.C)(o,s),u=a.firstDiffLeft,d=o.length-a.firstDiffRight,g=s.length-a.firstDiffRight;let h,p=i.WI.Update;if(o.length!==s.length)d===u?(p=i.WI.Add,h=o[o.length-1]):g===u&&(p=i.WI.Delete,h=s[s.length-1]);else if(o===s)return;let f,m=0;switch(p){case i.WI.Update:m=d-u,f=s.substring(u,g);break;case i.WI.Add:f=s.substring(u,g);break;case i.WI.Delete:m=d-u,f=o.substring(u,d)}const v=function(e,t){const o=Array.from(e.matchAll(l));if(l.lastIndex=0,0===o.length)return i.OD.Chars;if(1===o.length){if(0===o[0].index)return t&&c.test(t)?i.OD.Sentence:t&&!l.test(t)?i.OD.Word:i.OD.Chars;if(o[0].index+1===e.length)return c.test(e[o[0].index-1])?i.OD.Sentence:l.test(e[o[0].index-1])?i.OD.Chars:i.OD.Word;if(e[o[0].index-1]){const t=e[o[0].index-1];if(c.test(t))return i.OD.Sentence;if(l.test(t))return i.OD.Chars}return i.OD.Word}const n=Array.from(e.matchAll(c));return c.lastIndex=0,0===n.length?i.OD.PartialSentence:n.length>1?i.OD.Paragraph:n[0].index+1<=e.length?l.test(e[n[0].index+1])?i.OD.Sentence:i.OD.Paragraph:void 0}(f,h);if(void 0!==v)return new n.s({content:p!==i.WI.Delete?f:void 0,deltaType:p,unit:v,position:u,length:p!==i.WI.Add?m:0})}},31968:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>r}),3023==o.j)var i=o(28677);if(3023==o.j)var n=o(71200);class r{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(i.qf.getTypeName(),n.n),this.registerDeltaBuilderHandler(i.Cg.getTypeName(),n.T)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,o){const i=this.deltaBuilderHandlers.get(e);return i?i(t,o):[]}}},44298:(e,t,o)=>{"use strict";if(o.d(t,{U:()=>u}),3023==o.j)var i=o(99564);if(3023==o.j)var n=o(23774);if(3023==o.j)var r=o(81787);if(3023==o.j)var s=o(28677);if(3023==o.j)var a=o(31968);const l=(e,t)=>t?c([...t,e]):e,c=e=>e.join("\\");class u{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var o;const a=new n.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return a.success=!1,a.resultDescription="Unable to create text tile delta, parent item is undefined",void r.tG.info(524883085,r.nh.CoreDefault,a.stop());if(!e.body)return a.success=!1,a.resultDescription="Unable to create text tile delta, parent item has undefined body",void r.tG.info(524883086,r.nh.CoreDefault,a.stop());const n=e.body;if(!s.qf.typeGuard(n))return a.success=!1,void(a.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${s.qf.getTypeName()}, received ${i.h.getTypeNameFor(n)}`);const c=l(e.id,t),u=null!==(o=this.lastSeenTileByTileId.get(c))&&void 0!==o?o:new s.qf({content:""}),d=this.createDeltas(u,n);return d&&0!==d.length?(a.dimension0=d.length.toString(),this.lastSeenTileByTileId.set(c,n)):(a.dimension0="0",a.resultDescription="No delta differences found"),r.tG.info(524883087,r.nh.CoreDefault,a.stop()),d}catch(e){return a.success=!1,a.resultDescription=`Error creating text tile delta: ${e}`,void r.tG.info(524883088,r.nh.CoreDefault,a.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new a.a}addItemToLocalMap(e,t){const o=l(e.id,t),i=e.body;s.qf.typeGuard(i)&&!this.lastSeenTileByTileId.has(o)&&this.lastSeenTileByTileId.set(o,i)}deleteItemFromLocalMap(e,t){const o=l(e.id,t);this.lastSeenTileByTileId.has(o)&&this.lastSeenTileByTileId.delete(o)}moveItemsInLocalMap(e,t,o){const i=new Set(o),n=c(t),r=c(e),s=[],a=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(n)){const o=a(e,n);if(void 0===o||i.has(o)){const o=e.replace(n,r);s.push({item:t,newPathKey:o,prevPathKey:e})}}for(const e of s)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(i.h.getTypeNameFor(t),e,t)}}},7553:(e,t,o)=>{"use strict";function i(e,t,o=!1){let i,s,a={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(i=e,s=t):(i=t,s=e),0===s.indexOf(i)?(a.firstDiffLeft=i.length,a.firstDiffRight=0):s.endsWith(i)?(a.firstDiffLeft=0,a.firstDiffRight=i.length):(a=function(e,t,o=!1){const i={firstDiffLeft:0,firstDiffRight:t.length};let r;for(r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(r),s=t.charCodeAt(r);if(!(i===s||n(i,o)&&n(s,o)))break}for(i.firstDiffLeft=r,r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(e.length-r-1),s=t.charCodeAt(t.length-r-1);if(!(i===s||n(i,o)&&n(s,o)))break}return i.firstDiffRight=r,i}(e,t,o),a.firstDiffLeft+a.firstDiffRight>i.length&&(a.firstDiffRight=i.length-a.firstDiffLeft)),function(e,t,o){if(e.firstDiffLeft>0){const i=e.firstDiffLeft<t.length&&r(t,e.firstDiffLeft),n=e.firstDiffLeft<o.length&&r(o,e.firstDiffLeft);(i||n)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const i=e.firstDiffRight<t.length&&r(t,t.length-e.firstDiffRight),n=e.firstDiffRight<o.length&&r(o,o.length-e.firstDiffRight);(i||n)&&(e.firstDiffRight-=1)}}(a,e,t),a}function n(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function r(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}o.d(t,{C:()=>i})},62672:(e,t,o)=>{"use strict";var i,n,r,s;o.d(t,{OY:()=>i}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(n||(n={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(r||(r={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(s||(s={}))},86689:(e,t,o)=>{"use strict";var i;o.d(t,{T:()=>i}),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(i||(i={})),Error},69201:(e,t,o)=>{"use strict";var i;o.d(t,{q:()=>i}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(i||(i={}))},9798:(e,t,o)=>{"use strict";var i,n,r,s,a,l,c,u,d,g,h;o.d(t,{Y$:()=>r,in:()=>a,wC:()=>i}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(i||(i={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(r||(r={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(s||(s={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(a||(a={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(l||(l={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(c||(c={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(u||(u={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(d||(d={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount"}(g||(g={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(h||(h={}))},12839:(e,t,o)=>{"use strict";var i;o.d(t,{O:()=>i}),function(e){e.dev="dev",e.int="int",e.test="test",e.dogfood="dogfood",e.msit="msit",e.prod="prod",e.gcc="gcc",e.dod="dod",e.gccHigh="gcchigh",e.ag08="ag08",e.ag09="ag09",e.gallatin="gallatin"}(i||(i={}))},86319:(e,t,o)=>{"use strict";var i;o.d(t,{Z:()=>i}),function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(i||(i={}))},36273:(e,t,o)=>{"use strict";var i,n,r,s,a,l,c,u,d,g,h;o.d(t,{wC:()=>i}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(i||(i={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(r||(r={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(s||(s={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(a||(a={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(l||(l={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(c||(c={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(u||(u={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(d||(d={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount"}(g||(g={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(h||(h={}))},17934:(e,t,o)=>{"use strict";o.d(t,{r:()=>r});const{AugLoopTextEncoder:i,AugLoopTextDecoder:n}=(()=>{if("undefined"==typeof TextEncoder){o(12855);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();class r{static deserialize(e,t=(e=>e)){if(e[0]!==r.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let o=1;const i=[],n=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;o<e.byteLength;){if(o+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const t=n.getUint32(o);if(o+t+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");"undefined"!=typeof Buffer&&Buffer.from?i.push(Buffer.from(e.buffer,e.byteOffset+o+4,t)):i.push(new Uint8Array(e.buffer,e.byteOffset+o+4,t)),o+=4+t}if(i.length<1)throw new Error("Invalid Binary: No fragments found");const s=r.textDecoder.decode(i[0]);return JSON.parse(s,((e,o)=>{if("string"==typeof o){if(o.substring(0,r.BINARYKEYWORD.length)===r.BINARYKEYWORD){const e=parseInt(o.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=i.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(i[e+1])}if(o.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return o.substring(r.ESCAPEKEYWORD.length)}return o}))}static serialize(e){const t=[void 0],o=JSON.stringify(e,((e,o)=>ArrayBuffer.isView(o)?(t.push(o),`${r.BINARYKEYWORD}${t.length-2}`):o&&"Buffer"===o.type&&Array.isArray(o.data)?(t.push(new Uint8Array(o.data)),`${r.BINARYKEYWORD}${t.length-2}`):"string"==typeof o&&o.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+o:o));t[0]=r.textEncoder.encode(o);const i=t.reduce(((e,t)=>e+4+t.byteLength),0),n=new Uint8Array(i+1);n[0]=r.IDENTIFIERBYTE;let s=1;const a=new DataView(n.buffer,n.byteOffset,n.byteLength);for(const e of t)a.setUint32(s,e.byteLength),n.set(e,s+4),s+=4+e.byteLength;return n}}r.IDENTIFIERBYTE=3,r.BINARYKEYWORD=":b",r.ESCAPEKEYWORD=":",r.textDecoder=new n,r.textEncoder=new i},99919:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},74498:(e,t,o)=>{"use strict";o.d(t,{W:()=>i});class i{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<r;e++)s[e]=n[Math.floor(Math.random()*n.length)];return s.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new i(e.substring(0,e.length-2)):new i(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new i(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=3023==o.j?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"]:null,r=22,s=new Array(r)},94771:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});const i=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}class r{constructor(e,t,o,r,s){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const o=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])o.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n="n~"),o.push(`${n}${e[t].toString().replace(i,"_")}`)}const r=o.join("|");let s=this.buckets.get(r);if(!s){s=new n,s.traceLevel=e.traceLevel;for(const e of this.avgMeasures)s.measureSums.set(e,0);this.buckets.set(r,s)}s.count++;for(const t of this.avgMeasures)e[t]&&s.measureSums.set(t,s.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},i=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],n=i[e];0===n.indexOf("b~")?o[t]="b~true"===n:0===n.indexOf("n~")?o[t]=parseInt(n.slice(2),10):o[t]=n}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=o,this.avgMeasures=r,s>0&&(this.interval=setInterval(this.flush,1e3*s))}}},81787:(e,t,o)=>{"use strict";o.d(t,{tG:()=>v,nh:()=>M,OD:()=>k});var i,n=o(69201);!function(e){e.Log="Log"}(i||(i={}));const r="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",s="abcdefghijklmnopqrstuvwxyz0123456789",a={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,c=[],u=[],d=e=>null,g=e=>{};const h=new Map,p=new Map,f=new Map,m=new Map;var v;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{c=[],u=[],p.clear(),f.clear()},e.clearAggregators=()=>{h.clear()},e.addLogger=e=>{-1===c.indexOf(e)&&(c.push(e),y(p,e))},e.addDecidingLogger=e=>{-1===u.indexOf(e)&&(u.push(e),y(f,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e=>{g=e},e.addAggregator=e=>{e.init(((e,t)=>{I(e,t)})),h.has(e.eventName)?h.get(e.eventName).push(e):h.set(e.eventName,[e])},e.flushAggregators=e=>{h.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const o=R(e);m.set(o,t)},e.resetTagLevelOverrides=()=>{m.clear()},e.error=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.error,o,i,r,s,a,l,c,u)},e.warn=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.warn,o,i,r,s,a,l,c,u)},e.info=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.info,o,i,r,s,a,l,c,u)},e.verbose=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.verbose,o,i,r,s,a,l,c,u)},e.debug=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.debug,o,i,r,s,a,l,c,u)},e.metric=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.metric,o,i,r,s,a,l,c,u)},e.formatMetric=(e,t,o,i)=>{const n={};return n[e]={dimensionNames:o,dimensionValues:i,value:t},n},e.dynamic=e=>{I(e)}}(v||(v={}));const y=(e,t)=>{const o=t.level;Object.keys(n.q).map((e=>n.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=o)).forEach((o=>{e.has(o)?e.get(o).push(t):e.set(o,[t])}))},b=e=>{if("string"==typeof e)return e;let t="";for(let o=0;o<e.length;o++){o>0&&(t+=" ");const i=e[o];i instanceof Error?t+=JSON.stringify({message:i.message,name:i.name,stack:i.stack}):t+="object"==typeof i?JSON.stringify(i):i}return t},S=[],C=["Level","Tag"],w=["Level","Tag","Workflow"],k=e=>T(e).length,T=e=>void 0!==e?p.get(e)||S:c,x=(e,t)=>(void 0!==e?f.get(e)||[]:u).filter((e=>e.shouldLog(t))),_=(e,t,o,n,r,s,a,c,u,p,f)=>{o=m.get(e)||o;const v=T(o),y=x(o,n);if(0==v.length&&0==y.length)return;const S=d(i.Log),k=B(e),_=((e,t,o,i,n,r,s,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,o,i,n,r,s,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(n,r,s,a,c,u,p,f);if(E(t))A(_)&&I({eventName:"Metrics",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:"",getMetrics:()=>_},!1,v,y);else if(A(_)){const e=_;e.tagId=k,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const i=h.get(e.eventName);if(i)for(let t=0;t<i.length;++t){const o=i[t];if(o&&o.add(e,t===i.length-1))break}else I(e,!1,v,y)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>C,dimensionValues:[String(o),k],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>w,dimensionValues:[String(o),k,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};I({eventName:"Log",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:b(_),getMetrics:e},!1,v,y)}g(S)},I=(e,t=!1,o,i)=>{var n,s,a,c,u,d,g,h,p,f,m,v;if(null==o&&(o=T(e.traceLevel)),i=i||S,o.length>0||i.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(n=t.clientMetadata)||void 0===n?void 0:n.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(s=t.clientMetadata)||void 0===s?void 0:s.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(a=t.clientMetadata)||void 0===a?void 0:a.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(c=t.clientMetadata)||void 0===c?void 0:c.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(u=t.clientMetadata)||void 0===u?void 0:u.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(p=t.clientMetadata)||void 0===p?void 0:p.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(f=t.clientMetadata)||void 0===f?void 0:f.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(m=t.clientMetadata)||void 0===m?void 0:m.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(v=t.clientMetadata)||void 0===v?void 0:v.isClientTelemetrySampled)}for(const t of o)t.log(e);for(const t of i)t.log(e)}},E=e=>e.name===M.WorkflowMetricsOnly.name&&e.root===M.WorkflowMetricsOnly.root,A=e=>!Array.isArray(e)&&"object"==typeof e,B=e=>s[e>>24&63]+s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e],R=e=>e&&5===e.length?a[e.charCodeAt(0)]<<24|a[e.charCodeAt(1)]<<18|a[e.charCodeAt(2)]<<12|a[e.charCodeAt(3)]<<6|a[e.charCodeAt(4)]:-1;class M{}M.CoreDefault=v.defineCoreLogCategory("Default"),M.CoreSystem=v.defineCoreLogCategory("System"),M.CoreUnsampled=v.defineCoreLogCategory("Unsampled"),M.WorkflowDefault=v.defineWorkflowLogCategory("Default"),M.WorkflowUnsampled=v.defineWorkflowLogCategory("Unsampled"),M.WorkflowMetricsOnly=v.defineWorkflowLogCategory("MetricsOnly"),M.PrivacyGuardEvent=v.defineCoreLogCategory("PrivacyGuardEvent")},96424:(e,t,o)=>{"use strict";o.d(t,{t:()=>i});const i="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now()},23774:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),r=o(96424);class s extends n{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){if(null==t)return;const o=this.dataFields?JSON.parse(this.dataFields):{};o[e]=t,this.dataFields=JSON.stringify(o)}setDataFields(e){this.dataFields?this.dataFields=JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)}start(){return this.startTime=(0,r.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,r.t)()-this.startTime)),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,o;const i={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":i[this.operationName+".CountV2"]={dimensionNames:s.getOrphanedSessionHealthDimensionNames.bind(s),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":i[this.operationName+".Reason"]={dimensionNames:s.getSessionHealthDimensionNames.bind(s),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(i["Workflow.DurationMs"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},i["Workflow.Count"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const o=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(o)>=0)&&(i[o]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(o=this.options)||void 0===o?void 0:o.metricCount)||e.indexOf(t)>=0)&&(i[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return i}getDimensionNames(){var e,t;let o=s.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){o=o.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(e)}return o}getDimensionValues(){var e,t;const o=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(this.options.metricCustomDimensions[e]);return o}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}s.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],s.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"]},72834:(e,t,o)=>{"use strict";o.d(t,{vf:()=>c,Pq:()=>r,l6:()=>n,aM:()=>i});var i,n,r,s={util:{},roots:{default:{}}},a=(s.util,s.roots.default||(s.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=o(96424);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(r={}));class c extends a{constructor(e,t){var o,s;super({source:i[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(o=e.durationMs)&&void 0!==o?o:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(s=e.affectedWorkflows)&&void 0!==s?s:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},15027:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},41744:(e,t,o)=>{"use strict";o.d(t,{u:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.operationName="",e.prototype.key="",e.prototype.value="",e.prototype.buildVersion="",e.prototype.datafield0="",e.prototype.datafield1="",e.prototype.datafield2="",e.prototype.datafield3="",e.prototype.tagId=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnonymizedOperationEvent"},e}());class r extends n{constructor(e){if(super(e),this.eventName="AnonymizedOperation",this.allowListedLogs=[508856344,508688156],!this.allowListedLogs.includes(e.tagId))throw new Error("AnonymizedOperations must be allow-listed and reviewed by AugLoop engineering team. Please include your privacy approval in the review.")}}},4647:(e,t,o)=>{"use strict";o.d(t,{W:()=>i});class i{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<r;e++)s[e]=n[Math.floor(Math.random()*n.length)];return s.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new i(e.substring(0,e.length-2)):new i(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new i(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=3023==o.j?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"]:null,r=22,s=new Array(r)},83422:(e,t,o)=>{"use strict";o.d(t,{u:()=>n});var i=o(4647);class n{get sessionKey(){var e;return null===(e=this.sessionDescriptor)||void 0===e?void 0:e.sessionKey}get interactionSessionId(){return this._interactionSessionId}set interactionSessionId(e){if(this._interactionSessionId&&this._interactionSessionId!==e)throw new Error("InteractionSessionId is already set");this._interactionSessionId=e}get interactionId(){return this._interactionId}set interactionId(e){if(this._interactionId&&this._interactionId!==e)throw new Error("InteractionId is already set");this._interactionId=e}constructor(e,t,o,i){this.cv=e,this.sessionDescriptor=t,this.clientMetadata=o,this.workflow=null==i?void 0:i.workflow,this.joinContextId=null==i?void 0:i.joinContextId,this.performanceEvent=null==i?void 0:i.performanceEvent,this.sessionLogsSampled=void 0,this._interactionId=null==i?void 0:i.interactionId,this._interactionSessionId=null==i?void 0:i.interactionSessionId,this.traceId=null==i?void 0:i.traceId}static deserialize(e){if(e)try{const t=JSON.parse(e),o={appName:t.clientAppName,appPlatform:t.clientAppPlatform,releaseAudienceGroup:t.clientReleaseAudienceGroup,flights:t.clientFlights};return new n(new i.W(t.cv),{sessionKey:t.sessionKey,userId:t.userId,mastermindEndpoint:t.mastermindEndpoint},o,{workflow:t.workflow,joinContextId:t.joinContextId,interactionId:t.interactionId,interactionSessionId:t.interactionSessionId,traceId:t.traceId})}catch(t){return new n(new i.W(e))}}static fromExisting(e,t,o,i,r){return new n(t||e.cv,o||e.sessionDescriptor,i||e.clientMetadata,{workflow:(null==r?void 0:r.workflow)||e.workflow,joinContextId:(null==r?void 0:r.joinContextId)||e.joinContextId,performanceEvent:(null==r?void 0:r.performanceEvent)||e.performanceEvent,interactionId:(null==r?void 0:r.interactionId)||e.interactionId,interactionSessionId:(null==r?void 0:r.interactionSessionId)||e.interactionSessionId,traceId:(null==r?void 0:r.traceId)||e.traceId})}toString(){var e,t;return`${null===(e=this.clientMetadata)||void 0===e?void 0:e.appName};${null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform};${this.sessionKey};${this.cv}`}serialize(){var e,t,o,i,r;const s=null===(e=this.clientMetadata)||void 0===e?void 0:e.appName,a=null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform,l=null===(o=this.clientMetadata)||void 0===o?void 0:o.releaseAudienceGroup,c=null===(i=this.clientMetadata)||void 0===i?void 0:i.flights;return n.stringify(Object.assign(Object.assign({cv:this.cv.toString()},null!==(r=this.sessionDescriptor)&&void 0!==r?r:{}),{clientAppName:s,clientAppPlatform:a,clientReleaseAudienceGroup:l,clientFlights:c,workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId}))}newChild(){return new n(this.cv.newChild(),this.sessionDescriptor,this.clientMetadata,{workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId})}}n.schema={type:"object",properties:{cv:{type:"string"},clientAppName:{type:"string"},clientAppPlatform:{type:"string"},clientReleaseAudienceGroup:{type:"string"},clientFlights:{type:"string"},sessionKey:{type:"string"},userId:{type:"string"},mastermindEndpoint:{type:"string"},workflow:{type:"string"},joinContextId:{type:"string"},interactionId:{type:"string"},interactionSessionId:{type:"string"},traceId:{type:"string"}}},n.stringify=(n.schema,JSON.stringify)},57375:(e,t,o)=>{"use strict";o.d(t,{HW:()=>d,IQ:()=>v,NS:()=>u,Ve:()=>c,Zw:()=>f,fK:()=>p,fZ:()=>m,nd:()=>g,z0:()=>h});var i=o(4647),n=o(83422);let r=new n.u(new i.W);const s=3023==o.j?[]:null,a=new Map;let l;const c=e=>{s.push(r),r=e},u=e=>{if(r===e)return void(r=s.pop());const t=s.lastIndexOf(e);if(t<0)throw new Error("Context not found");if(0===t)throw new Error("Cannot remove top context");s.splice(t,1)},d=e=>{l||(l=e.createHook({init(t){const o=g();if(o)a.set(t,o);else if(0===e.executionAsyncId()){const o=e.triggerAsyncId(),i=a.get(o);i&&a.set(t,i)}},before(e){const t=a.get(e);t&&c(t)},after(e){const t=a.get(e);t&&u(t)},destroy(e){a.delete(e)}}),l.enable())},g=()=>r,h=()=>r&&r.cv&&r.cv.toString()||null,p=()=>{var e;return new n.u((null===(e=null==r?void 0:r.cv)||void 0===e?void 0:e.newChild())||new i.W,null==r?void 0:r.sessionDescriptor,null==r?void 0:r.clientMetadata,{workflow:null==r?void 0:r.workflow,joinContextId:null==r?void 0:r.joinContextId,performanceEvent:null==r?void 0:r.performanceEvent,interactionId:null==r?void 0:r.interactionId,interactionSessionId:r.interactionSessionId,traceId:null==r?void 0:r.traceId})},f=e=>{const t=p();return v((t=>e(t&&t.cv||void 0)),t)},m=(e,t,o,s,a)=>{const l=new n.u(t&&i.W.fromString(t)||(null==r?void 0:r.cv)||new i.W,o||(null==r?void 0:r.sessionDescriptor),s||(null==r?void 0:r.clientMetadata),{workflow:(null==a?void 0:a.workflow)||(null==r?void 0:r.workflow),joinContextId:(null==a?void 0:a.joinContextId)||(null==r?void 0:r.joinContextId),performanceEvent:(null==a?void 0:a.performanceEvent)||(null==r?void 0:r.performanceEvent),interactionId:(null==a?void 0:a.interactionId)||(null==r?void 0:r.interactionId),interactionSessionId:(null==a?void 0:a.interactionSessionId)||(null==r?void 0:r.interactionSessionId),traceId:(null==a?void 0:a.traceId)||(null==r?void 0:r.traceId)});return v(e,l)},v=(e,t)=>{c(t);try{return e(t)}finally{u(t)}}},53970:(e,t,o)=>{"use strict";var i;o.d(t,{AQ:()=>r,GR:()=>i,HX:()=>c,He:()=>s,ax:()=>a,oX:()=>l,sw:()=>u,yL:()=>n}),function(e){e.UnexpectedClose="UnexpectedClose",e.ExpectedClose="ExpectedClose",e.ExpectedError="ExpectedError"}(i||(i={}));const n="ExcelExtensionClose",r="ExcelKeepAlive",s=3023==o.j?`ProcessMessage_${n}`:null,a=3023==o.j?`${n}_${i[i.ExpectedClose]}`:null,l=3023==o.j?`${n}_${i[i.ExpectedError]}`:null,c=3023==o.j?`${n}_${i[i.UnexpectedClose]}`:null;var u;!function(e){e[e.Unknown=0]="Unknown",e[e.SessionClosedOutside=1]="SessionClosedOutside",e[e.ClosedOutsideBeforeInitialSeedingCompleted=2]="ClosedOutsideBeforeInitialSeedingCompleted",e[e.EcsProxyClose=3]="EcsProxyClose",e[e.EcsProxyFailedToFetchContent=4]="EcsProxyFailedToFetchContent",e[e.EcsProxyFailedToFetchWorkbookMetadata=5]="EcsProxyFailedToFetchWorkbookMetadata",e[e.EcsProxyFailedToRequestWaitForWorkbookChange=6]="EcsProxyFailedToRequestWaitForWorkbookChange",e[e.EcsProxyReconnect=7]="EcsProxyReconnect",e[e.EcsProxyUnexpected=8]="EcsProxyUnexpected",e[e.EcsSessionClosedNotification=9]="EcsSessionClosedNotification",e[e.SessionIdle=10]="SessionIdle",e[e.FailedToProducePubSubMessage=11]="FailedToProducePubSubMessage",e[e.FailedToSetSessionData=12]="FailedToSetSessionData",e[e.FailedToGetSessionData=13]="FailedToGetSessionData",e[e.ReachUnexpectedCode=14]="ReachUnexpectedCode",e[e.RequestIdMismatch=15]="RequestIdMismatch",e[e.SeedingNotRequired=16]="SeedingNotRequired",e[e.ShortAccessTokenTTLReconnect=17]="ShortAccessTokenTTLReconnect"}(u||(u={}))},93894:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>s}),3023==o.j)var i=o(44452);if(3023==o.j)var n=o(37827);if(3023==o.j)var r=o(41744);class s{constructor(e,t,o,n,r=5,s){this.severity=e,this.resourceId=t,this.tokenExpirationInMS=o,this.idleDurationInMS=n,this.kAnonUser=r,this.log=s,this.cache=new i.l({idleDurationMs:this.idleDurationInMS,sweepInterval:6e4}),this.kAnonUser=Math.min(5,this.kAnonUser),this.log=s||this.logHits}updateTokenCount(e,t,o){this.flush();const i=Date.now(),n=this.cache.get(e);if(!n)return void this.cache.put(e,{users:[{userId:t,timestamp:i,count:o}]},this.tokenExpirationInMS);const r=n.users.find((e=>e.userId===t));if(r)r.timestamp=i,r.count+=o;else if(n.users.push({userId:t,timestamp:i,count:o}),n.users.length>=this.kAnonUser){const t=n.users.reduce(((e,t)=>e+t.count),0);this.cache.del(e),this.log(e,t)}}logHits(e,t){n.tG.info(508688156,n.nh.CoreSystem,new r.u({operationName:"BlocklistMatchEvent",key:e,value:t+"",datafield0:this.severity,datafield1:this.resourceId,buildVersion:process.env.BUILD_BUILDNUMBER||"DEV",tagId:508688156}))}flush(){this.cache.forEach((e=>{e.users=e.users.filter((e=>Date.now()<e.timestamp+this.tokenExpirationInMS))}))}getCount(e){this.flush();const t=this.cache.get(e);return t?t.users.reduce(((e,t)=>e+t.count),0):0}shutdown(){this.cache.clear(),this.cache=void 0}}},68380:(e,t,o)=>{"use strict";o.d(t,{H:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpRequestQueueEvent"},e}());class r extends n{getMetrics(){return{HttpRequestQueueV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpRequestQueue"}}},33480:(e,t,o)=>{"use strict";o.d(t,{S:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpSocketListEvent"},e}());class r extends n{getMetrics(){return{HttpSocketListV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpSocketList"}}},98635:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{AnnotationMetaDataChange:()=>d.v,AnonymizedOperation:()=>m.u,CorrelationContext:()=>a.u,CorrelationVector:()=>l.W,CustomBlockListLogger:()=>T.P,ExtensionCloseReason:()=>C.sw,ExtensionCloseType:()=>C.GR,HttpRequestQueue:()=>r.H,HttpSocketList:()=>b.S,Log:()=>i.tG,LogCategory:()=>i.nh,LoggingAggregator:()=>u.D,Operation:()=>n.I,OutboundHttpRequest:()=>y.c,PrivacyGuardIssue:()=>S.J,ProcessIdentification:()=>s.U,ScenarioStats:()=>f.y,SessionHealthEvent:()=>g.vf,SessionHealthEventAggregation:()=>h.N,SessionHealthImpact:()=>g.Pq,SessionHealthReason:()=>g.l6,SessionHealthSource:()=>g.aM,SessionIssue:()=>p.M,Timer:()=>v.M,WebSocketConnectionEnd:()=>c.j,argsToString:()=>i.am,createChildCorrelation:()=>w.fK,enter:()=>w.Ve,excelExtensionCloseEventName:()=>C.yL,excelExtensionExpectedCloseEventName:()=>C.ax,excelExtensionExpectedErrorEventName:()=>C.oX,excelExtensionUnexpectedCloseEventName:()=>C.HX,excelKeepAliveAggregationName:()=>C.He,excelKeepAliveMessageName:()=>C.AQ,exit:()=>w.NS,getCorrelation:()=>w.nd,getCorrelationVectorString:()=>w.z0,getNumLoggers:()=>i.OD,initAsyncHooks:()=>w.HW,now:()=>k.t,resumeCorrelation:()=>w.IQ,startChildCorrelation:()=>w.Zw,startCorrelation:()=>w.fZ,tagIdToString:()=>i.ih}),3023==o.j)var i=o(37827);if(3023==o.j)var n=o(76839);if(3023==o.j)var r=o(68380);if(3023==o.j)var s=o(47646);if(3023==o.j)var a=o(83422);if(3023==o.j)var l=o(4647);if(3023==o.j)var c=o(9918);if(3023==o.j)var u=o(26870);if(3023==o.j)var d=o(15027);if(3023==o.j)var g=o(91617);if(3023==o.j)var h=o(50399);if(3023==o.j)var p=o(79002);if(3023==o.j)var f=o(25452);if(3023==o.j)var m=o(41744);if(3023==o.j)var v=o(88690);if(3023==o.j)var y=o(72766);if(3023==o.j)var b=o(33480);if(3023==o.j)var S=o(7196);if(3023==o.j)var C=o(53970);if(3023==o.j)var w=o(57375);if(3023==o.j)var k=o(89471);if(3023==o.j)var T=o(93894)},26870:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});const i=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}class r{constructor(e,t,o,r,s){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const o=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])o.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n="n~"),o.push(`${n}${e[t].toString().replace(i,"_")}`)}const r=o.join("|");let s=this.buckets.get(r);if(!s){s=new n,s.traceLevel=e.traceLevel;for(const e of this.avgMeasures)s.measureSums.set(e,0);this.buckets.set(r,s)}s.count++;for(const t of this.avgMeasures)e[t]&&s.measureSums.set(t,s.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},i=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],n=i[e];0===n.indexOf("b~")?o[t]="b~true"===n:0===n.indexOf("n~")?o[t]=parseInt(n.slice(2),10):o[t]=n}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=o,this.avgMeasures=r,s>0&&(this.interval=setInterval(this.flush,1e3*s))}}},37827:(e,t,o)=>{"use strict";var i,n;o.d(t,{tG:()=>v,nh:()=>M,am:()=>b,OD:()=>k,ih:()=>B}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(i||(i={})),function(e){e.Log="Log"}(n||(n={}));const r="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",s="abcdefghijklmnopqrstuvwxyz0123456789",a={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,c=[],u=[],d=e=>null,g=e=>{};const h=new Map,p=new Map,f=new Map,m=new Map;var v;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{c=[],u=[],p.clear(),f.clear()},e.clearAggregators=()=>{h.clear()},e.addLogger=e=>{-1===c.indexOf(e)&&(c.push(e),y(p,e))},e.addDecidingLogger=e=>{-1===u.indexOf(e)&&(u.push(e),y(f,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e=>{g=e},e.addAggregator=e=>{e.init(((e,t)=>{I(e,t)})),h.has(e.eventName)?h.get(e.eventName).push(e):h.set(e.eventName,[e])},e.flushAggregators=e=>{h.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const o=R(e);m.set(o,t)},e.resetTagLevelOverrides=()=>{m.clear()},e.error=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.error,o,n,r,s,a,l,c,u)},e.warn=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.warn,o,n,r,s,a,l,c,u)},e.info=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.info,o,n,r,s,a,l,c,u)},e.verbose=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.verbose,o,n,r,s,a,l,c,u)},e.debug=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.debug,o,n,r,s,a,l,c,u)},e.metric=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.metric,o,n,r,s,a,l,c,u)},e.formatMetric=(e,t,o,i)=>{const n={};return n[e]={dimensionNames:o,dimensionValues:i,value:t},n},e.dynamic=e=>{I(e)}}(v||(v={}));const y=(e,t)=>{const o=t.level;Object.keys(i).map((e=>i[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=o)).forEach((o=>{e.has(o)?e.get(o).push(t):e.set(o,[t])}))},b=e=>{if("string"==typeof e)return e;let t="";for(let o=0;o<e.length;o++){o>0&&(t+=" ");const i=e[o];i instanceof Error?t+=JSON.stringify({message:i.message,name:i.name,stack:i.stack}):t+="object"==typeof i?JSON.stringify(i):i}return t},S=[],C=["Level","Tag"],w=["Level","Tag","Workflow"],k=e=>T(e).length,T=e=>void 0!==e?p.get(e)||S:c,x=(e,t)=>(void 0!==e?f.get(e)||[]:u).filter((e=>e.shouldLog(t))),_=(e,t,o,i,r,s,a,c,u,p,f)=>{o=m.get(e)||o;const v=T(o),y=x(o,i);if(0==v.length&&0==y.length)return;const S=d(n.Log),k=B(e),_=((e,t,o,i,n,r,s,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,o,i,n,r,s,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(i,r,s,a,c,u,p,f);if(E(t))A(_)&&I({eventName:"Metrics",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:"",getMetrics:()=>_},!1,v,y);else if(A(_)){const e=_;e.tagId=k,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const i=h.get(e.eventName);if(i)for(let t=0;t<i.length;++t){const o=i[t];if(o&&o.add(e,t===i.length-1))break}else I(e,!1,v,y)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>C,dimensionValues:[String(o),k],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>w,dimensionValues:[String(o),k,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};I({eventName:"Log",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:b(_),getMetrics:e},!1,v,y)}g(S)},I=(e,t=!1,o,i)=>{var n,s,a,c,u,d,g,h,p,f,m,v;if(null==o&&(o=T(e.traceLevel)),i=i||S,o.length>0||i.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(n=t.clientMetadata)||void 0===n?void 0:n.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(s=t.clientMetadata)||void 0===s?void 0:s.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(a=t.clientMetadata)||void 0===a?void 0:a.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(c=t.clientMetadata)||void 0===c?void 0:c.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(u=t.clientMetadata)||void 0===u?void 0:u.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(p=t.clientMetadata)||void 0===p?void 0:p.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(f=t.clientMetadata)||void 0===f?void 0:f.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(m=t.clientMetadata)||void 0===m?void 0:m.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(v=t.clientMetadata)||void 0===v?void 0:v.isClientTelemetrySampled)}for(const t of o)t.log(e);for(const t of i)t.log(e)}},E=e=>e.name===M.WorkflowMetricsOnly.name&&e.root===M.WorkflowMetricsOnly.root,A=e=>!Array.isArray(e)&&"object"==typeof e,B=e=>s[e>>24&63]+s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e],R=e=>e&&5===e.length?a[e.charCodeAt(0)]<<24|a[e.charCodeAt(1)]<<18|a[e.charCodeAt(2)]<<12|a[e.charCodeAt(3)]<<6|a[e.charCodeAt(4)]:-1;class M{}M.CoreDefault=v.defineCoreLogCategory("Default"),M.CoreSystem=v.defineCoreLogCategory("System"),M.CoreUnsampled=v.defineCoreLogCategory("Unsampled"),M.WorkflowDefault=v.defineWorkflowLogCategory("Default"),M.WorkflowUnsampled=v.defineWorkflowLogCategory("Unsampled"),M.WorkflowMetricsOnly=v.defineWorkflowLogCategory("MetricsOnly"),M.PrivacyGuardEvent=v.defineCoreLogCategory("PrivacyGuardEvent")},89471:(e,t,o)=>{"use strict";o.d(t,{t:()=>i});const i="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now()},76839:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),r=o(89471);class s extends n{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){if(null==t)return;const o=this.dataFields?JSON.parse(this.dataFields):{};o[e]=t,this.dataFields=JSON.stringify(o)}setDataFields(e){this.dataFields?this.dataFields=JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)}start(){return this.startTime=(0,r.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,r.t)()-this.startTime)),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,o;const i={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":i[this.operationName+".CountV2"]={dimensionNames:s.getOrphanedSessionHealthDimensionNames.bind(s),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":i[this.operationName+".Reason"]={dimensionNames:s.getSessionHealthDimensionNames.bind(s),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(i["Workflow.DurationMs"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},i["Workflow.Count"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const o=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(o)>=0)&&(i[o]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(o=this.options)||void 0===o?void 0:o.metricCount)||e.indexOf(t)>=0)&&(i[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return i}getDimensionNames(){var e,t;let o=s.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){o=o.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(e)}return o}getDimensionValues(){var e,t;const o=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(this.options.metricCustomDimensions[e]);return o}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}s.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],s.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"]},72766:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.host="",e.prototype.statusCode=0,e.prototype.success=!1,e.prototype.wait=0,e.prototype.dns=0,e.prototype.tcp=0,e.prototype.firstByte=0,e.prototype.download=0,e.prototype.total=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OutboundHttpRequestEvent"},e}());class r extends n{getMetrics(){return{"OutboundHttpRequestV2.Wait":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.wait},"OutboundHttpRequestV2.DNS":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.dns},"OutboundHttpRequestV2.TCP":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.tcp},"OutboundHttpRequestV2.FirstByte":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.firstByte},"OutboundHttpRequestV2.Download":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.download},"OutboundHttpRequestV2.Total":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.total}}}constructor(e){super(e),this.eventName="OutboundHttpRequest"}getDimensionValues(){return[this.host,this.statusCode,this.success]}}r.dimensionNames=["Host","StatusCode","Success"]},7196:(e,t,o)=>{"use strict";o.d(t,{J:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.suspiciousLogTagId="",e.prototype.suspiciousStringIssues="",e.prototype.suspiciousStringValue="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/PrivacyGuardIssueEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="PrivacyGuardIssue"}}},47646:(e,t,o)=>{"use strict";o.d(t,{U:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Pid=0,e.prototype.ApplicationName="",e.prototype.ServiceName="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ProcessIdentificationEvent"},e}());class r extends n{constructor(){super(...arguments),this.eventName="ProcessIdentification"}}},25452:(e,t,o)=>{"use strict";o.d(t,{y:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.resourceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.scenarioHealthBucket="",e.prototype.scenarioHealthReason="",e.prototype.scenarioHealthBucketWithSuppressions="",e.prototype.scenarioHealthReasonWithSuppressions="",e.prototype.activationState="",e.prototype.modelItemsCountBucket="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ScenarioStatsEvent"},e}());class r extends n{getMetrics(){return{"ScenarioStats.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:1},"ScenarioStatsWithSuppressions.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getSuppressionsDimensionValues(),value:1},"ScenarioStatsScenario.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getScenarioDimensionValues(),value:1},"ScenarioStatsScenarioWithSuppressions.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getScenarioSuppressionsDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="ScenarioStats",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucket,this.healthReason]}getSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucketWithSuppressions,this.healthReasonWithSuppressions]}getScenarioDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucket,this.scenarioHealthReason]}getScenarioSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucketWithSuppressions,this.scenarioHealthReasonWithSuppressions]}}r.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","HealthBucket","HealthReason"]},50399:(e,t,o)=>{"use strict";o.d(t,{N:()=>a});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.sessionHealthEventName="",e.prototype.count=0,e.prototype.successes=0,e.prototype.failures=0,e.prototype.maxDurationMs=0,e.prototype.sumDurationMs=0,e.prototype.cancellations=0,e.prototype.failureBuckets="",e.prototype.firstFailureReason="",e.prototype.firstFailureImpact="",e.prototype.firstEventSource="",e.prototype.firstEventReason="",e.prototype.firstEventReasonDependency="",e.prototype.firstEventImpact="",e.prototype.firstEventSuccess=!1,e.prototype.firstEventDurationMs=0,e.prototype.firstEventCount=0,e.prototype.firstEventMessage="",e.prototype.firstEventAffectedWorkflows="",e.prototype.lastEventSource="",e.prototype.lastEventReason="",e.prototype.lastEventReasonDependency="",e.prototype.lastEventImpact="",e.prototype.lastEventSuccess=!1,e.prototype.lastEventDurationMs=0,e.prototype.lastEventCount=0,e.prototype.lastEventMessage="",e.prototype.lastEventAffectedWorkflows="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEventAggregation"},e}()),r=o(91617);const s=(e,t)=>"reason"===e?r.l6[t]:"impact"===e?r.Pq[t]:t;class a extends n{constructor(e,t){super({sessionHealthEventName:e,count:t.count,successes:t.successes,failures:t.failures,cancellations:t.cancellations,maxDurationMs:t.maxDurationMs,sumDurationMs:t.sumDurationMs,failureBuckets:JSON.stringify(t.failureBuckets,s),firstFailureReason:t.failureBuckets.length>0?r.l6[t.failureBuckets[0].reason]:"",firstFailureImpact:t.failureBuckets.length>0?r.Pq[t.failureBuckets[0].impact]:""}),this.eventName="SessionHealthAggregation",t.firstEvent&&(this.firstEventAffectedWorkflows=t.firstEvent.affectedWorkflows,this.firstEventCount=t.firstEvent.count,this.firstEventDurationMs=t.firstEvent.durationMs,this.firstEventImpact=t.firstEvent.impact,this.firstEventMessage=t.firstEvent.message,this.firstEventReason=t.firstEvent.reason,this.firstEventReasonDependency=t.firstEvent.reasonDependency,this.firstEventSource=t.firstEvent.source,this.firstEventSuccess=t.firstEvent.success),t.lastEvent&&(this.lastEventAffectedWorkflows=t.lastEvent.affectedWorkflows,this.lastEventCount=t.lastEvent.count,this.lastEventDurationMs=t.lastEvent.durationMs,this.lastEventImpact=t.lastEvent.impact,this.lastEventMessage=t.lastEvent.message,this.lastEventReason=t.lastEvent.reason,this.lastEventReasonDependency=t.lastEvent.reasonDependency,this.lastEventSource=t.lastEvent.source,this.lastEventSuccess=t.lastEvent.success)}}},91617:(e,t,o)=>{"use strict";o.d(t,{vf:()=>c,Pq:()=>r,l6:()=>n,aM:()=>i});var i,n,r,s={util:{},roots:{default:{}}},a=(s.util,s.roots.default||(s.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=o(89471);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(r={}));class c extends a{constructor(e,t){var o,s;super({source:i[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(o=e.durationMs)&&void 0!==o?o:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(s=e.affectedWorkflows)&&void 0!==s?s:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},79002:(e,t,o)=>{"use strict";o.d(t,{M:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthSubreason="",e.prototype.summarizedFindings="",e.prototype.affectedResource="",e.prototype.affectedSessions="",e.prototype.suppressionReason="",e.prototype.modelItemsCountBucket="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionIssueEvent"},e}());class r extends n{getMetrics(){return{"SessionIssue.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="SessionIssue",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.modelItemsCountBucket,this.healthBucket,this.healthReason,this.healthSubreason,this.affectedResource,this.affectedSessions,this.suppressionReason]}}r.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ModelItemsCountBucket","HealthBucket","HealthReason","HealthSubreason","AffectedResource","AffectedSessions","SuppressionReason"]},88690:(e,t,o)=>{"use strict";o.d(t,{M:()=>i});class i{constructor(e){null==e?this.reset():this.start=e}diffInMs(){const e=process.hrtime(this.start),t=1e3*e[0]+e[1]/1e6;return Math.floor(t)}diffInUs(){const e=process.hrtime(this.start),t=1e6*e[0]+e[1]/1e3;return Math.floor(t)}reset(){this.start=process.hrtime()}}},9918:(e,t,o)=>{"use strict";o.d(t,{j:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.TerminationReason="",e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.TotalRequestCount=0,e.prototype.LifetimeSec=0,e.prototype.ClientApp="",e.prototype.ClientAppPlatform="",e.prototype.ClientAppVersion="",e.prototype.ClientReleaseAudienceGroup="",e.prototype.ClientSessionId="",e.prototype.ClusterId="",e.prototype.ConnectionSequenceId=0,e.prototype.CorrelationId="",e.prototype.UsageType="",e.prototype.MaxActiveRequestsCount=0,e.prototype.unexpectedTerminationNotSeenInSessionHealth=!1,e.prototype.webSocketCloseCode=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WebSocketConnectionEndEvent"},e}());class r extends n{constructor(e,t){super(e),this.eventName="WebSocketConnectionEnd",t&&(this.ClientApp=null==t?void 0:t.appName,this.ClientAppPlatform=null==t?void 0:t.appPlatform,this.ClientAppVersion=null==t?void 0:t.appVersion,this.ClientReleaseAudienceGroup=null==t?void 0:t.releaseAudienceGroup,this.ClientSessionId=null==t?void 0:t.sessionId)}}},3843:(e,t,o)=>{"use strict";o.d(t,{a4:()=>c,gu:()=>l,si:()=>u});var i=o(69689);if(3023==o.j)var n=o(99564);if(3023==o.j)var r=o(23774);if(3023==o.j)var s=o(81787);if(3023==o.j)var a=o(1653);const l=new Set([i.Xr.getTypeName(),i.fZ.getTypeName(),i.g0.getTypeName(),i.xU.getTypeName()]);class c{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return(0,a.lO)(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=n.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new r.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return l.has(e)}tryLogMessage(e,t,o=!0){e&&(e.success=o,e.resultDescription=t,s.tG.verbose(527308633,s.nh.CoreDefault,e.stop()))}}var u;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(u||(u={}))},59446:(e,t,o)=>{"use strict";if(o.d(t,{MM:()=>u,a4:()=>d}),3023==o.j)var i=o(99564);if(3023==o.j)var n=o(23774);if(3023==o.j)var r=o(81787);var s=o(33674);if(3023==o.j)var a=o(28677);if(3023==o.j)var l=o(31987);const c=[s.WI.CursorUpdate,s.WI.FormattingUpdate,s.WI.OtherNonContentUpdate];function u(e,t,o){const c=new n.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return c.success=!1,c.resultDescription="Unable to apply text tile delta, parent tile is undefined",void r.tG.info(538798173,r.nh.CoreDefault,c.stop());if(i.h.getTypeNameFor(t)!==a.qf.getTypeName())return c.success=!1,c.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${l.Q.getTypeName()}, received ${i.h.getTypeNameFor(t)}`,void r.tG.info(538798174,r.nh.CoreDefault,c.stop());const o=e,n=t.content;let u="";if(void 0===o.position||o.position<0)return c.success=!1,c.resultDescription="Unable to apply text tile delta, invalid text tile position",void r.tG.info(538798175,r.nh.CoreDefault,c.stop());switch(o.deltaType){case s.WI.Add:u=o.position<n.length?`${n.slice(0,o.position)}${o.content}${n.slice(o.position,n.length)}`:n+o.content;break;case s.WI.Update:o.content||o.unit!==s.OD.Sentence||(c.dimension0="1"),u=`${n.slice(0,o.position)}${o.content}${n.slice(o.position+(o.length||0),n.length)}`;break;case s.WI.Delete:u=`${n.slice(0,o.position)}${n.slice(o.position+(o.length||0),n.length)}`}return r.tG.info(538837071,r.nh.CoreDefault,c.stop()),new a.qf({content:u})}catch(e){return c.success=!1,c.resultDescription=`Error applying text tile delta: ${e}`,void r.tG.info(538798176,r.nh.CoreDefault,c.stop())}}function d(e,t,o){var l,c,u,d,p,f,m,v;const y=new n.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();y.clientFlights=o;try{if(!t)return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void r.tG.info(538798177,r.nh.CoreDefault,y.stop());if(i.h.getTypeNameFor(t)!==a.Cg.getTypeName())return y.success=!1,y.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${a.Cg.getTypeName()}, received ${i.h.getTypeNameFor(t)}`,void r.tG.info(538798178,r.nh.CoreDefault,y.stop());const o=t,b=e,S=o.content;let C="";if((void 0===b.position||b.position<0)&&!h(b.deltaType))return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void r.tG.info(538798179,r.nh.CoreDefault,y.stop());if(void 0===b.content&&!h(b.deltaType))return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void r.tG.info(538798208,r.nh.CoreDefault,y.stop());if(b.deltaType===s.WI.Add&&0!==b.length?r.tG.info(538798209,r.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):h(b.deltaType)&&void 0!==b.content&&r.tG.info(538798210,r.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!g(b.deltaType)){const e=function(e,t,o){const i=new n.I({operationName:"FindRangeForDelta",success:!0});if(i.start(),!e)return i.resultDescription="No formatted ranges found within the tile, skipping.",void r.tG.info(538798212,r.nh.CoreDefault,i.stop());if(t===s.WI.Add){const t=e.find((e=>e.start===o&&0===e.length));if(t)return i.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,r.tG.info(538798213,r.nh.CoreDefault,i.stop()),t;o=Math.max(o-1,0)}const a=e.find((e=>0===e.length?e.start===o:e.start<=o&&o<e.start+e.length));return a?(i.resultDescription=`Updating formatted range for operation with start: ${a.start} and length: ${a.length}`,r.tG.info(538798214,r.nh.CoreDefault,i.stop())):(i.resultDescription=`Unable to find formatted range for operation at position ${o}, skipping.`,r.tG.info(538798215,r.nh.CoreDefault,i.stop())),a}(o.formattedRanges,b.deltaType,b.position);let t=o.formattedRanges?[...o.formattedRanges]:[];const i=e?t.indexOf(e):-1;-1!==i&&(b.position+(b.length||0)>e.start+e.length?e.length=b.position+(null!==(l=b.content)&&void 0!==l?l:"").length-e.start:e.length+=(null!==(c=b.content)&&void 0!==c?c:"").length-(b.length||0),t[i]=e);let g=o.ipPosition;switch(b.deltaType){case s.WI.Add:C=b.position<S.length?`${S.slice(0,b.position)}${b.content}${S.slice(b.position,S.length)}`:S+b.content,g=b.position+b.length;break;case s.WI.Update:b.content||b.unit!==s.OD.Sentence||(y.dimension0="1"),C=`${S.slice(0,b.position)}${b.content}${S.slice(b.position+(null!==(u=b.length)&&void 0!==u?u:0),S.length)}`,g=b.position+b.content.length;break;case s.WI.Delete:C=`${S.slice(0,b.position)}${S.slice(b.position+(null!==(d=b.length)&&void 0!==d?d:0),S.length)}`,g=b.position}for(const e of t.slice(i+1))e.start<b.position||(b.position+(b.length||0)>e.start?(e.length=e.start+e.length-(b.position+(b.length||0)),e.start=b.position+(null!==(p=b.content)&&void 0!==p?p:"").length):e.start+=(null!==(f=b.content)&&void 0!==f?f:"").length-(b.length||0));t=t.filter((e=>e.length>0));const h=new a.Cg(Object.assign(Object.assign({},o),{ipPosition:g,content:C,formattedRanges:t,queryRange:b.queryRange}));return r.tG.info(538837073,r.nh.CoreDefault,y.stop()),h}if(b.deltaType===s.WI.CursorUpdate)return new a.Cg(Object.assign(Object.assign({},o),{ipPosition:null===(m=b.cursorData)||void 0===m?void 0:m.ipPosition,isColdIp:null===(v=b.cursorData)||void 0===v?void 0:v.isColdIp}));if(b.deltaType===s.WI.FormattingUpdate)return new a.Cg(Object.assign(Object.assign({},o),{formattedRanges:b.formattedRanges}));if(b.deltaType===s.WI.OtherNonContentUpdate){let e;const t={};for(e in b.otherNonContentData)t[e]=b.otherNonContentData[e];return new a.Cg(Object.assign(Object.assign({},o),t))}return}catch(e){return y.success=!1,y.resultDescription=`Error applying formatted text tile delta: ${e}`,void r.tG.info(538798211,r.nh.CoreDefault,y.stop())}}function g(e){return-1!==c.indexOf(e)}function h(e){return g(e)||s.WI.Delete===e}},42979:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(1653);class n{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,o){return Object.assign(Object.assign(Object.assign({},e),t),o)}mergeWorkflowDefinition(e,t,o){if(o){const r=(0,i.oF)(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));r.set(o,n.mergeDefinitions(e,r.get(o),t))}else this.workflowDefByWorkflow.set(e.id,n.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var o;let i;return t&&(i=null===(o=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===o?void 0:o.get(t)),i||(i=this.workflowDefByWorkflow.get(e.id)),i||(i=e),i}deleteWorkflowDefinition(e,t){const o=this.workflowDefByWorkflowAndContextId.get(e.id);o&&(o.delete(t),0===o.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}},1653:(e,t,o)=>{"use strict";o.d(t,{_$:()=>n,lO:()=>r,oF:()=>i});const i=(e,t,o)=>{let i=e.get(t);return i||(i=o(),e.set(t,i)),i},n=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),r=(e,t)=>null!=e&&null!=t&&e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))},48490:(e,t,o)=>{"use strict";if(o.d(t,{Q$:()=>a,aZ:()=>s}),3023==o.j)var i=o(9798);if(3023==o.j)var n=o(23774);if(3023==o.j)var r=o(81787);var s;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(s||(s={}));class a{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var o;const i=this.getLocation(t);return null===(o=this.graphNodeByLocationAndWorkflowId.get(i))||void 0===o?void 0:o.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const o=new n.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void r.tG.error(524300630,r.nh.CoreDefault,o.stop())}const o=this.getLocation(t),i=new l(e,o);this.addWorkflowAsDependency(i);let s=this.graphNodeByLocationAndWorkflowId.get(o);s||(s=new Map,this.graphNodeByLocationAndWorkflowId.set(o,s)),s.set(e.id,i)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const o of t.values()||[]){const t=this.createWorkflowDefinition(o.workflow);o.workflow.visibility===i.Y$.LocalOnly?this.compressDownstreamWorkflows(t,o):t.outputTypes.push(...o.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),o=this.graphNodeByLocationAndWorkflowId.get(t),i=Array.from((null==o?void 0:o.values())||[]);for(const e of i){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);o.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const o of t.values()||[])e.push(o.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const o of e.values())t.push(o);return t}getLocation(e){return e?s.External:s.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const o of t.downstreamWorkflows)if(o.workflow.visibility!==i.Y$.LocalOnly){if(o.workflow.kind!==i.wC.Join||-1!==e.inputTypes.indexOf(o.workflow.collectionScopeType))for(const t of o.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,o)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const o of t.values()){for(const t of o.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,o);for(const t of o.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(o,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class l{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}},38215:(e,t,o)=>{"use strict";if(o.d(t,{e:()=>a}),3023==o.j)var i=o(23774);if(3023==o.j)var n=o(81787);if(3023==o.j)var r=o(1653);if(3023==o.j)var s=o(74066);class a{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var o;const r=e.contextId;if(r)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(r,[]),this.scopeItemsByContextId.has(r)){if(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.has(r)){const o=new i.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${r} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();n.tG.verbose(527291288,n.nh.CoreDefault,o.stop())}}else this.scopeItemsByContextId.set(r,e)}updateScopeItemPath(e,t,o){var i,n;if(!e)return;const r=this.scopeItemsByContextId.get(e);if(!r)return;const a=r.parentPath;this.scopeItemsByContextId.set(e,(0,s.CY)(t,r));const l=null!==(n=null===(i=this.itemsByWorkflowAndContextId.get(o.id))||void 0===i?void 0:i.get(e))&&void 0!==n?n:[];for(let e=0;e<l.length;e++)l[e]=(0,s.CY)([...t,...l[e].parentPath.slice(0,a.length)],l[e])}getScopeItem(e,t){var o;for(const i of(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.keys())||[])if((0,r.lO)(i,e))return this.scopeItemsByContextId.get(i)}addItemToWorkflowList(e,t){const o=e.contextId;if(!o)return;const s=this.itemsByWorkflowAndContextId.get(t.id);if(s)for(const[a,l]of s)if((0,r.lO)(a,o)){l.push(e);const o=new i.I({resultDescription:`Items for contextId ${a}: [${l.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();n.tG.info(526403808,n.nh.CoreDefault,o.stop())}}isWorkflowReady(e,t){const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=o}getItemsToExecute(e,t){const o=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),o}onWorkflowExecuted(e,t){const o=e.contextId,i=this.itemsByWorkflowAndContextId.get(t.id);i&&(i.delete(o),0===i.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(o)||this.scopeItemsByContextId.delete(o)}getGeneratedItems(e,t){var o;if(!(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.get(e)))return[];const i=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,i)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const o of t.keys())if(o===e)return!0;return!1}}},83757:(e,t,o)=>{"use strict";o.d(t,{$:()=>x});var i=o(76839),n=o(37827);const r=(e,t)=>t.some((t=>e instanceof t));let s,a;const l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,g=new WeakMap;let h={get(e,t,o){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return f(e[t])},set:(e,t,o)=>(e[t]=o,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(m(this),e),f(l.get(this))}:function(...e){return f(t.apply(m(this),e))}:function(e,...o){const i=t.call(m(this),e,...o);return u.set(i,e.sort?e.sort():[e]),f(i)}:(e instanceof IDBTransaction&&function(e){if(c.has(e))return;const t=new Promise(((t,o)=>{const i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",r),e.removeEventListener("abort",r)},n=()=>{t(),i()},r=()=>{o(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",r),e.addEventListener("abort",r)}));c.set(e,t)}(e),r(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e);var t}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,o)=>{const i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",r)},n=()=>{t(f(e.result)),i()},r=()=>{o(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&l.set(t,e)})).catch((()=>{})),g.set(t,e),t}(e);if(d.has(e))return d.get(e);const t=p(e);return t!==e&&(d.set(e,t),g.set(t,e)),t}const m=e=>g.get(e),v=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],b=new Map;function S(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(b.get(t))return b.get(t);const o=t.replace(/FromIndex$/,""),i=t!==o,n=y.includes(o);if(!(o in(i?IDBIndex:IDBObjectStore).prototype)||!n&&!v.includes(o))return;const r=async function(e,...t){const r=this.transaction(e,n?"readwrite":"readonly");let s=r.store;return i&&(s=s.index(t.shift())),(await Promise.all([s[o](...t),n&&r.done]))[0]};return b.set(t,r),r}var C;C=h,h={...C,get:(e,t,o)=>S(e,t)||C.get(e,t,o),has:(e,t)=>!!S(e,t)||C.has(e,t)};var w=o(87783);const k="undefined"!=typeof fetch?fetch:w;var T;!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(T||(T={}));class x{constructor(e,t,o,r){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(o),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${o}`:"",this.checkIdbByFeatures=null==r?void 0:r.checkIdbByFeatures;const s=new i.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});s.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,o=0,i=0;const n=new Promise(((t,o)=>{e=setTimeout((()=>{o(new Error("Took longer than 10000 ms"))}),1e4)})),r=this.accessDB().then((e=>{const n=e.transaction(this.osName,"readwrite");return n.objectStore(this.osName).openCursor().then((function e(r){if(i++,r){const i=r.value;let n;return i.timesSinceUsage||(i.timesSinceUsage=0),i.timesSinceUsage++,i.timesSinceUsage>5?(o++,n=r.delete()):(t++,n=r.update(i)),n.then((()=>r.continue())).then(e)}return n.done}))}));this.initPromise=Promise.race([n,r]).catch((e=>{s.success=!1,s.resultDescription+=`${e.message} `})).then((()=>{s.dimension0=`${i}`,s.dimension1=`${t}`,s.dimension2=`${o}`,clearTimeout(e),this.closeDBAndEndLog(s,"initializing idb storage")}))}else s.resultDescription="Incompatible browser for IDB",n.tG.info(538706242,n.nh.CoreDefault,s.stop())})).catch((()=>{s.resultDescription="Issue determining idb compatibility",n.tG.info(536966936,n.nh.CoreDefault,s.stop())}))}getResourceAsArrayBuffer(e,t,o){const n=new i.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:T.ArrayBuffer,dimension1:e,dimension2:t});n.start();const r={};return this.getResource(e,t,o,T.ArrayBuffer,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{const o=e.get(t);return o.arrayBuffer?o.arrayBuffer().then((e=>{r[t]=e})):new Promise(((e,i)=>{const n=new FileReader;n.readAsArrayBuffer(o),n.onload=o=>{const n=o.target.result;n instanceof ArrayBuffer?(r[t]=n,e()):i(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>r))}getKey(e,t,o){return o?`${e}_${t}_${JSON.stringify(Array.from(o.entries()))}`:`${e}_${t}`}updateCache(e,t,o,i){this.modelPathsCache.set(this.getKey(e,t,o),i)}getCache(e,t,o){return this.modelPathsCache.get(this.getKey(e,t,o))}getResourceAsURL(e,t,o){const n=new i.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:T.URL,dimension1:e,dimension2:t});n.start();const r={},s=this.getCache(e,t,o);return s?Promise.resolve(s):this.getResource(e,t,o,T.URL,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{r[t]=URL.createObjectURL(e.get(t))}))))).then((()=>this.getCache(e,t,o)||(this.updateCache(e,t,o,r),r)))}getResource(e,t,o,i,n,r){return this.getFiles(e,t,o,n).then((e=>r(e))).then((()=>{this.closeDBAndEndLog(n,`retrieving ${e}`)})).catch((t=>{throw n.resultDescription.indexOf(t.message)>=0&&(n.success=!1,n.resultDescription+=`${t.message} `),n.resultSignature=`Issue retrieving from CDN or translating to ${i}`,this.closeDBAndEndLog(n,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const o=globalThis.indexedDB.open(this.dbName,this.dbVersion);o.onsuccess=function(){e(!0)},o.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?this.checkIdbByFeatures&&(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=function(e,t,{blocked:o,upgrade:i,blocking:n,terminated:r}={}){const s=indexedDB.open(e,t),a=f(s);return i&&s.addEventListener("upgradeneeded",(e=>{i(f(s.result),e.oldVersion,e.newVersion,f(s.transaction))})),o&&s.addEventListener("blocked",(()=>o())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),n&&e.addEventListener("versionchange",(()=>n()))})).catch((()=>{})),a}(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,n.tG.info(573329487,n.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,n.tG.error(573329488,n.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,o,i){return this.isBrowserIdbCompatible().catch((e=>(i.success=!1,i.resultDescription+=`${e.message} `,i.resultSignature="Issue determining idb compatibility",!1))).then((n=>{const r=()=>{if(o){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,o,i,n);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,i,n)};return n?this.getFilesFromIDB(e,t,o,i).catch((e=>(e&&(i.resultDescription.indexOf(e.message)>=0&&(i.success=!1,i.resultDescription+=`${e.message} `),i.resultSignature="Issue retrieving from DB"),r()))):r()}))}getFilesFromIDB(e,t,o,i){return this.initPromise.catch((e=>{i.success=!1,i.resultDescription+=`${e.message} `,i.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((n=>{for(const r of n)if(r&&r.model&&r.version==t){if(!this.checkModelFiltersPass(o,r.filters))continue;return this.putModel(e,r.model,t,r.filters,i,r.id),Promise.resolve(r.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var o;for(const i of e){const e=null===(o=t.get(i[0]))||void 0===o?void 0:o.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${i[0]} to exist in metadata file`);if(e.indexOf(i[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,o,i,n){let r;return i.dimension3="Polymer",o||(o=new Map),k(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{var s,a;const l=JSON.parse(n);if(l.name!==e||l.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${l.name} version ${l.version}`);for(const e of l.variants)if(r=new Map(Object.entries(e)),this.checkModelFiltersPass(o,r))return(l.catalog?o.size+2:o.size+1!==r.size)&&(i.success=!1,i.resultDescription+=`Expected ${null===(s=r.keys)||void 0===s?void 0:s.length} # of filters, received ${null===(a=o.keys)||void 0===a?void 0:a.length}`),e.model_files;throw new Error("No model found with given filters")})).then((o=>Promise.all(o.map((o=>k(`${this.polymerBaseURL}/${e}/${t}/${o}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[o,e]))))))).then((o=>{const s=new Map(o);return n?this.putModel(e,s,t,r,i):s}))}downloadFiles(e,t,o,i){return o.dimension3="FS",k(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((o=>{const i=JSON.parse(o),n=`${i.MajorVersion}.${i.MinorVersion}/ModelResources`,r=`${e}/${t}/`;return Promise.all(i.Resources.map((e=>(e.Name.length>r.length&&e.Name.substring(0,r.length)===r&&(e.Name=e.Name.substring(r.length)),k(`${this.baseURL}/${n}/${r}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((n=>{const r=new Map(n);return i?this.putModel(e,r,t,new Map,o):r}))}getModelOptions(e){return this.accessDB().then((t=>{const o=[],i=t.transaction(this.osName,"readonly");return i.objectStore(this.osName).openCursor().then((function t(n){if(n){const i=n.value;return i.modelId==e&&o.push(i),n.continue().then(t)}return i.done})).then((()=>o))}))}putModel(e,t,o,i,n,r){return i||(i=new Map),this.accessDB().then((n=>n.put(this.osName,{modelId:e,model:t,version:o,filters:i,timesSinceUsage:0},r))).catch((e=>{n.resultDescription.indexOf(e.message)>=0&&(n.success=!1,n.resultDescription+=`${e.message} `),n.resultSignature="Issue adding to DB"})).then((()=>t))}}},50725:(e,t,o)=>{"use strict";if(o.d(t,{_:()=>r}),3023==o.j)var i=o(98054);if(3023==o.j)var n=o(11954);class r{static createFactory(e=".",t,o,n){return s=>{var a;const l=o||i.e3;return!r.onnxRetrievalPromise||s?e?((null===(a=l())||void 0===a?void 0:a.ai_outlook)&&!s?Promise.resolve():(0,i.el)(`${e}/ai_outlook.min.js`,l,"ai_outlook",t,n)).then((()=>{r.onnxRetrievalPromise=Promise.resolve(new r(l))})).catch((e=>{r.onnxRetrievalPromise=Promise.reject(e)})).then((()=>r.onnxRetrievalPromise)):Promise.reject(new Error("Error: folderPath not provided")):r.onnxRetrievalPromise}}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var o;const i=null===(o=this.getCache())||void 0===o?void 0:o.ai_outlook;return i?(i.env.wasm.simd=!0,i.env.wasm.numThreads=0,n.Kx.create(e,t||"",i)):Promise.reject(new Error("Error: aiOutlook is undefined"))}createInputs(){return n.G0.create()}}},11954:(e,t,o)=>{"use strict";if(o.d(t,{G0:()=>c,Kx:()=>l,fE:()=>a}),3023==o.j)var i=o(86319);if(3023==o.j)var n=o(37827);if(3023==o.j)var r=o(76839);var s=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function a(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,n.tG.info(540406806,n.nh.CoreDefault,e.stop()),!0)}class l{constructor(e,t,o){this.session=e,this.onnxObject=o,this.modelName=t}static create(e,t,o){return s(this,void 0,void 0,(function*(){const i=new r.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return i.start(),o[e]?(i.resultDescription="Model already existed",n.tG.info(509699716,n.nh.CoreDefault,i.stop()),o[e]):o[e]=this.getInferenceSession(o).create(e).then((e=>(n.tG.info(540406807,n.nh.CoreDefault,i.stop()),new l(e,t,o)))).catch((e=>{throw i.resultDescription=`Error: ${e}`,n.tG.info(540406808,n.nh.CoreDefault,i.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return s(this,void 0,void 0,(function*(){const o=new r.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(o.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),i={};return Object.keys(t).forEach((e=>{const o=t[e];if(Array.isArray(o.values)&&o.values.length>0&&"boolean"==typeof o.values[0]){const t=new Uint8Array(o.values);i[e]=new this.onnxObject.Tensor(t,o.dimensions)}else i[e]=new this.onnxObject.Tensor(o.values,o.dimensions)})),this.session.run(i).then((e=>(n.tG.info(540406809,n.nh.CoreDefault,o.stop()),new u(e)))).catch((e=>{o.resultDescription=`Problem running model. ${e.message}`,n.tG.info(540406810,n.nh.CoreDefault,o.stop())}))}throw o.resultDescription="Unable to run model. Tensor not defined",n.tG.info(540406811,n.nh.CoreDefault,o.stop()),new Error("Tensor is not defined")}))}}class c{constructor(){this.map={}}static create(){return new c}getInputs(){return this.map}add(e,t,o){return this.map[e]={dimensions:t,values:o},this}}class u{constructor(e){for(const t of Object.keys(e))this[t]=new d(t,e[t])}}class d{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return i.Z.Strings;case"int8":return i.Z.Int8s;case"int16":return i.Z.Int16s;case"int32":return i.Z.Int32s;case"bool":return i.Z.Booleans;case"uint8":return i.Z.UnsignedInt8s;case"uint16":return i.Z.UnsignedInt16s;case"uint32":return i.Z.UnsignedInt32s;case"float32":return i.Z.Float32s;case"float64":return i.Z.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===i.Z.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===i.Z.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===i.Z.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===i.Z.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===i.Z.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===i.Z.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===i.Z.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===i.Z.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===i.Z.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===i.Z.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}},98054:(e,t,o)=>{"use strict";if(o.d(t,{e3:()=>s,el:()=>l}),3023==o.j)var i=o(76839);if(3023==o.j)var n=o(37827);if(3023==o.j)var r=o(11954);function s(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function a(e,t){e.src=t}function l(e,t,o,s,l){const u=new i.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(u.start(),(0,r.fE)(u)){const e="Browser lacks necessary support for inference service";return u.success=!1,u.resultDescription=e,n.tG.info(540406803,n.nh.CoreDefault,u.stop()),Promise.reject(new Error(e))}return new Promise(((i,n)=>{if("undefined"!=typeof document){const r=document.createElement("script");(l||a)(r,e),r.onload=()=>{c(t,o)?(s&&(t()[o].env.wasm.wasmPaths=s),i()):(r.remove(),n(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},r.onerror=n,document.body.appendChild(r)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[o]=self[o],c(t,o)?(s&&(t()[o].env.wasm.wasmPaths=s),i()):n(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):n(new Error("Unexpected lack of document and importScripts"))})).then((()=>{n.tG.info(540406804,n.nh.CoreDefault,u.stop())})).catch((e=>{throw u.success=!1,u.resultDescription=e.message,n.tG.info(509871835,n.nh.CoreDefault,u.stop()),e}))}function c(e,t){const o=globalThis[t];if(o&&o.InferenceSession&&o.Tensor){const i=e();return i&&!i[t]&&(i[t]=o),!0}return!1}},90580:(e,t,o)=>{"use strict";o.d(t,{g:()=>n});var i=o(85964);class n{constructor(e,t,o,i){this.sendMessage=e,this.annotationType=t,this.options=o,this.token=`${t}-${n.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=i}activate(e,t,o){return new Promise(((n,r)=>{this.sendMessage(new i.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:o}),((e,t)=>{e?r(new Error(e.error)):(i.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),n({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new i.GA({token:this.token}),((o,i)=>{o?t(new Error(o.error)):e(i.lastRelease)}))}))}}n.nextActivationResultBatchId=1},25942:(e,t,o)=>{"use strict";if(o.d(t,{Z:()=>n}),3023==o.j)var i=o(91605);class n{constructor(e){this.annotationSequencer=null!=e?e:new i.N}process(e,t,o,i){const n=[];for(const i of e.ops){const r=[];if(null==i?void 0:i.items)for(const e of i.items){const o=this.annotationSequencer.sequence(e.body).then((()=>{t(i,e)}));r.push(o)}n.push(Promise.all(r).then((()=>{o(i,e.cv)})))}Promise.all(n).then((()=>i(e)))}}},91605:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>n}),3023==o.j)var i=o(11763);class n{constructor(e=500,t){this.sequencerFactory=null!=t?t:new i.k(e)}sequence(e){var t,o,i,n,r;return o=this,i=void 0,r=function*(){if(null==(null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq))return;const o=this.sequencerFactory.create(e);o&&(yield o.sequence(e.M_.seq))},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(s,a)}l((r=r.apply(o,i||[])).next())}))}}},11763:(e,t,o)=>{"use strict";if(o.d(t,{k:()=>n}),3023==o.j)var i=o(26712);class n{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new i.A(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}},76577:(e,t,o)=>{"use strict";o.d(t,{_:()=>i});class i{process(e,t,o,i){for(const i of e.ops){if(null==i?void 0:i.items)for(const e of i.items)t(i,e);o(i,e.cv)}i(e)}}},12643:(e,t,o)=>{"use strict";if(o.d(t,{Y:()=>l}),3023==o.j)var i=o(81787);if(3023==o.j)var n=o(23774);if(3023==o.j)var r=o(69689);if(3023==o.j)var s=o(63203);var a;!function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(a||(a={}));class l{constructor(e,t,o,i){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=i,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=o}addBatchItem(e,t,o,n,r,s){const{delayMs:l,delayMsMax:c,maxInputSize:u,estimateSize:d,groupingKeyExtractor:g}=t,h=d(e),p=g(e);if(t.split&&h>u){let a;try{a=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(s?s(t):i.tG.error(573366352,i.nh.CoreDefault,t))}if(a&&Array.isArray(a.inputs)&&a.inputs.length>1){let e;const i=[],l=s?(t,o)=>{if(e=e||t,i.push(o),i.length===a.inputs.length){let o;try{o=a.join(i)}catch(t){return void s(new Error("Join error: "+t.message))}s(e,o)}}:void 0;for(let e=0;e<a.inputs.length;e++){const i=a.inputs[e];this.addBatchItem(i,t,o,n,r&&e===a.inputs.length-1,l)}return}}let f=this.batchesByGroupingKey.get(p);if(f&&f.size+h>u&&(this.executeBatch(p,f,t,a.ExceedingMaxSize),f=void 0),f||(f={items:[],size:0,hasItemsWithCallbacks:!1,context:o,creationTime:Date.now()},this.batchesByGroupingKey.set(p,f)),this.batchMessagesEnabled){const t=f.items[f.items.length-1];t&&t.cv===n&&t.callback===s?(t.input=[...t.input,...e],t.size+=h):f.items.push({input:e,size:h,cv:n,callback:s})}else f.items.push({input:e,size:h,callback:s});f.size+=h,f.hasItemsWithCallbacks=f.hasItemsWithCallbacks||!!s,this.batchMessagesEnabled||(f.cv=n),f.groupComplete=r,f.groupComplete?this.executeBatch(p,f,t,a.GroupComplete):(Date.now()-f.creationTime+l<c&&(clearTimeout(f.timeout),f.timeout=void 0),f.timeout||(f.timeout=setTimeout((()=>{this.executeBatch(p,f,t,a.BatchIntervalElapsed)}),l)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new n.I({operationName:"ReduceBatchOperations"}).start();let o=0,s=0,a=0;const l=new Set,c=[],u=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const i of t.input.reverse())if(r.fZ.typeGuard(i)){const t=[];for(const e of i.items){a++;const n=u(i,e);l.has(n)?s++:(t.push(e),l.add(n),o++)}0!==t.length&&(i.items=t,e.push(i))}else if(r.Xr.typeGuard(i)){for(const e of i.items){const t=u(i,e);l.delete(t)}e.push(i)}else e.push(i);0!==e.length&&c.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=c.reverse(),0!=a&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(s)}`,t.dimension1=`noOp: ${0===s}`),t.success=a-s==o,i.tG.info(507839488,i.nh.CoreDefault,t.stop())}executeBatch(e,t,o,r){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const a=t.items,l=new n.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(a.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:r.toString()}).start(),c=(e,o,n)=>{let r;if(o&&o.exceptionType===s.K.NoOutput)l.success=!0,i.tG.info(573366353,i.nh.CoreDefault,l.stop());else{const n=`${e} error: ${o?o.message||o:"Unknown error"}`;r=o||new Error(n),l.success=!1,l.resultDescription=`Batch of ${a.length} items of size ${t.size} with ${n}`,l.resultSignature=`${e} Error`,i.tG.error(573366354,i.nh.CoreDefault,l.stop())}if(t.hasItemsWithCallbacks)for(const e of a)e.callback&&e.callback(r,n)};let u;try{u=o.multiplex(this.batchMessagesEnabled?a:a.map((e=>e.input)))}catch(e){return void c("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(u),this.submit(u.input,t,((e,n)=>{if(e||n&&("exceptionType"in n||n instanceof Error))c("Submit",e||n,n);else if(t.hasItemsWithCallbacks||o.summaryExtractor){let r,s,d;if(t.hasItemsWithCallbacks)try{if(r=u.demultiplex(n),r.length!==a.length)throw new Error("Mismatched output length")}catch(e){return void c("Demultiplex",e)}if(o.summaryExtractor)try{[d,s]=o.summaryExtractor(n)}catch(e){return void c("SummaryExtractor",e)}if(l.success=!0,i.tG.info(573366342,i.nh.CoreDefault,l.stop()),t.hasItemsWithCallbacks)for(let e=0;e<a.length;e++)a[e].callback&&a[e].callback(void 0,r[e]);s&&this.onSummary(d,s,t.context)}else l.success=!0,i.tG.info(573366343,i.nh.CoreDefault,l.stop())}))}}},53134:(e,t,o)=>{"use strict";if(o.d(t,{A:()=>d,Z:()=>g}),3023==o.j)var i=o(22461);if(3023==o.j)var n=o(81787);var r=o(87783);if(3023==o.j)var s=o(17934);if(3023==o.j)var a=o(85964);var l=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function c(e,t){return l(this,void 0,void 0,(function*(){const{authToken:o,origin:i,sessionUrl:n}=e,{body:s,cv:a,method:l,requestUrl:c}=t,u=yield(0,r.fetch)(c||n,{method:l,headers:Object.assign({Authorization:`Bearer ${o}`,"x-origin":i,"x-correlationid":a},t.headers),body:s});if(200!==u.status)throw new Error(`Unexpected status code: ${u.status}`);return u}))}const u=(e,t)=>{t?(e.resultDescription=t,e.success=!1,n.tG.error(507646878,n.nh.CoreDefault,e.stop())):n.tG.info(507646877,n.nh.CoreDefault,e.stop())};function d(e,t,o,i){let n;c(e,{headers:{"Content-Type":"application/jsond"},body:s.r.serialize(t),cv:o.cv,method:"POST"}).then((e=>e.json())).catch((e=>{n=new a._p({messageId:t.messageId,error:e.message})})).then((e=>{u(o,n?n.error:void 0),i(n,e)}))}function g(e,t,o,n){const{sessionUrl:r}=e;let s;c(e,{cv:n.cv,method:"GET",requestUrl:t.refType===i.J1.AlCodedLocation?`${r}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{s=e})).then((e=>{u(n,s?s.message:void 0),o(s,e)}))}},31201:(e,t,o)=>{"use strict";o.d(t,{_A:()=>a,OW:()=>r,t$:()=>n});var i=o(87783);const n="Request timed out";function r(e,t,o){const n=new i.Request(e,t);return s.add(n,o)}const s=new class{constructor(e,t,o){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=o}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,o]=this.queuedRequests.shift();clearTimeout(o),this.add(e,t)}}add(e,t){if(this.requestInProgress){const o=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,o])}else this.requestInProgress=!0,new Promise(((t,o)=>{let i=!1;const n=setTimeout((()=>{i=!0,o(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{i||(clearTimeout(n),t(e))})).catch((e=>{i||(clearTimeout(n),o(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}(i.fetch,2e4,12e4);function a(e,t,o){return new Promise(((r,s)=>{const a=setTimeout((()=>{s(new Error(n))}),t);(0,i.fetch)(e,o||{}).then((e=>{clearTimeout(a),r(e)})).catch((e=>{clearTimeout(a),s(e)}))}))}},73800:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n}),3023==o.j)var i=o(42534);class n{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=(0,i.Vh)(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}}},52428:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(81787);if(3023==o.j)var n=o(23774);if(3023==o.j)var r=o(3843);class s{constructor(e,t,o){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,o&&(this.itemsContextId=o.itemsContextId,this.executionState=o.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const o of this.itemsContextId)0===o.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(i.tG.info(520217546,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(i.tG.info(508883415,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,r.si.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,r.si.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===r.si.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[o,i]of t.getExecutionState())i===r.si.Executed&&r.a4.isParentContextId(e,o)&&t.tryToCompleteWorkflowExecution(o)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const o of t.getExecutionState().keys())if(r.a4.isParentContextId(o,e))return!1;return!0}}},54758:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>r}),3023==o.j)var i=o(74498);var n=o(85430);class r extends(3023==o.j?n.EventEmitter:null){init(){return Promise.resolve()}sendMessage(e,t,o){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new i.W}getNetworkWorkerManager(){}setState(e){}}},29:(e,t,o)=>{"use strict";if(o.d(t,{Y:()=>c}),3023==o.j)var i=o(23774);if(3023==o.j)var n=o(81787);if(3023==o.j)var r=o(96657);if(3023==o.j)var s=o(85964);const a=3023==o.j?6e4:null,l="Request timed out";class c{constructor(e,t,o){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new i.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=o,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new i.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508163399,n.nh.CoreDefault,e.stop()),this.trySendLongPoll(r.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new i.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void n.tG.info(508162497,n.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,n.tG.info(508163398,n.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===l?r.PO.TimeoutResend:r.PO.FailResend;t.error===l||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",n.tG.info(508163397,n.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",n.tG.info(508163401,n.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(r.PO.Regular)}close(){const e=new i.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508162467,n.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new i.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508162496,n.nh.CoreDefault,e.stop()),this.trySendLongPoll(r.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&s.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(r.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new i.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void n.tG.info(507281438,n.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new i.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void n.tG.info(508163396,n.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>a&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new i.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void n.tG.info(507278739,n.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new s.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}},4325:(e,t,o)=>{"use strict";o.d(t,{Z:()=>u});var i=o(85964);if(3023==o.j)var n=o(73165);var r=o(31201),s=o(87783);if(3023==o.j)var a=o(23774);if(3023==o.j)var l=o(81787);const c=JSON.stringify(new i.ry({error:r.t$}));class u{constructor(){this.isClosed=!1,this.pendingEgress=[]}init(e,t,o,i){const r=new a.I({operationName:"HttpWorkerInit",success:!0}).start(),s=e.split("/?x-origin=");2===s.length?(this.url=n.Aq.convertWebSocketUrlToHttp(s[0]),this.origin=s[1]):(this.url=n.Aq.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=o,this.onClose=i,l.tG.info(507839180,l.nh.CoreDefault,r.stop())}egress(e){const t=new a.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void l.tG.info(508163394,l.nh.CoreDefault,t.stop());const o=this.getRequestInfo(e,t);if(!o.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void l.tG.error(508163393,l.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(o,t):(0,r.OW)(o.url,o.request,((e,o)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):o&&o.ok?o.text().then((e=>{t.success=!0,l.tG.info(508163362,l.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==o?void 0:o.status}: ${null==o?void 0:o.statusText}`)}))}close(){const e=new a.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void l.tG.info(508163360,l.nh.CoreDefault,e.stop());l.tG.info(508163359,l.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,l.tG.error(508163358,l.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let o=e;t||(o=this.formatServerInput(e));o&&(this.logIngressCount(o),this.ingress(o,(e=>{i.uN.typeGuard(e)&&this.onSessionInitResponse(e)})))}onSessionInitResponse(e){const t=new a.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void l.tG.error(507809949,l.nh.CoreDefault,t.stop());l.tG.info(508163357,l.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){(0,r._A)(e.url,2e4,e.request).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",l.tG.info(508163355,l.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===r.t$?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),l.tG.error(508163353,l.nh.CoreDefault,t.stop()),this.ingressInternal(c,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const o=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),i=this.getHeader(e,t);return t.resultSignature=o,{url:o,request:{method:"POST",headers:i,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){if(null==e?void 0:e.isHttpSessionInitMessage){const e=new s.Headers({"Content-Type":"application/json"});return this.origin&&e.set("x-origin",this.origin),e}if(this.isConnectedToSession()){let o;return e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(o=new s.Headers({"Content-Type":"application/jsond2"}),t.dimension0=e.obj.byteLength.toString().length.toString()):o=new s.Headers({"Content-Type":"application/json"}),o.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),o.set("x-origin",this.sessionSettings.origin),o}return new s.Headers}setSessionSettings(e,t,o,i){const n=i.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:o,sliceUrl:n}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new a.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),l.tG.info(508409622,l.nh.CoreDefault,e.stop())}}}},53944:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>s}),3023==o.j)var i=o(97388);if(3023==o.j)var n=o(29);if(3023==o.j)var r=o(4325);const s=(e,t,o,s,a)=>e instanceof r.Z?new n.Y(e,o,s):new i.R(e,t,o,a)},97388:(e,t,o)=>{"use strict";o.d(t,{R:()=>s});var i=o(23774),n=o(81787);const r=3e4;class s{constructor(e,t,o,n){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=n,this.pingPongLogOp=new i.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(o,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultDescription="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,n.tG.info(506795283,n.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===s.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultDescription="close",n.tG.info(506795282,n.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),n.tG.info(506795281,n.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:s.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<r)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?this.ping():(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",n.tG.info(506795280,n.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=r,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),r)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,o,i){var r,s,a,l;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=o,i&&(this.pingPongLogOp.dimension0=null!==(r=i[0])&&void 0!==r?r:"",this.pingPongLogOp.dimension1=null!==(s=i[1])&&void 0!==s?s:"",this.pingPongLogOp.dimension2=null!==(a=i[2])&&void 0!==a?a:"",this.pingPongLogOp.dimension3=null!==(l=i[3])&&void 0!==l?l:""),n.tG.info(507320073,n.nh.CoreDefault,this.pingPongLogOp.stop())}}s.pingPongMessage="~"},96687:(e,t,o)=>{"use strict";o.d(t,{xB:()=>Fe});var i,n,r=o(69201),s=o(23774),a=o(81787);!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(i||(i={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(n||(n={}));var l=o(94771);const c=["cloud-dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],u=(e,t,o,i)=>new l.D(e,(e=>e.success&&o.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],i),d=e=>{if(!e)return e;for(const t of c)if(e.indexOf(t)>=0)return e;return"**redacted**"};class g{constructor(e){this.level=r.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,o,r,s)=>{let a=t.charAt(0).toUpperCase()+t.slice(1),l={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};o&&(l=Object.assign(Object.assign({},l),JSON.parse(o)));const c=r||g.augLoopAriaTenantToken,u=s||c!=g.augLoopAriaTenantToken?s:g.augLoopAriaNamespace;a=a||g.operationNamePlaceholder;const d={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(c,u?`${u}_${a}`:a,l,"Office.System.Activity",d,!1,i.ProductServiceUsage|i.ProductServicePerformance,n.RequiredServiceDataEvent)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const o=e;t(o,o.operationName,o.dataFields,void 0,o.ariaNamespace)}else if("SessionHealth"===e.eventName)t(e,e.sessionHealthEventName);else if("WorkflowOperation"===e.eventName){const o=e;t(o,o.operationName,o.dataFields,o.ariaTenant,o.ariaNamespace)}else"Log"===e.eventName&&((e,t,o)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,o)})(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}g.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",g.augLoopAriaNamespace="Office_AugLoop_Client",g.operationNamePlaceholder="OperationNameNotProvided";var h=o(91803),p=o.n(h);class f{constructor(){this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}init(e,t,o,i,n){this.clientMetadata=n,this.ws=new(p())(e),this.logOp=new s.I({operationName:f.className,success:!0}).start(),this.logOp.setClientMetadata(n,!0),this.ingressByteCountOp=new s.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(n,!0),this.ws.addEventListener("open",(e=>{o(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),a.tG.info(508843801,a.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,a.tG.info(508843800,a.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,a.tG.info(508843799,a.nh.CoreDefault,this.logOp.stop()),i(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,a.tG.info(508843797,a.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),a.tG.info(508843794,a.nh.CoreDefault,this.ingressByteCountOp.stop()))}logWsUndefinedError(e){const t=new s.I({operationName:f.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",a.tG.info(506566722,a.nh.CoreDefault,t.stop())}}f.className="WebSocketWorker";var m,v,y=o(74498),b=o(72834),S=o(50676),C=o(99564),w=o(96657),k=o(85964),T=o(62266);function x(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let o;for(const i of t)if(0===e.indexOf(i)){o=i;break}if(!o)return"MalformedMessageName";const i=e.indexOf("Message",e.length-7)===e.length-7;return e.slice(o.length,i?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found"}(m||(m={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(v||(v={}));class _{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new T.l({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?b.aM.ClientRuntime:b.aM.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){k.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),k.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,o,i=0){var n,r;const s=new b.vf({sessionHealthEventName:"SendMessage",source:this.source,reason:b.l6.Client,impact:this.source===b.aM.ClientRuntime?b.Pq.MissingInput:b.Pq.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:x(C.h.getTypeNameFor(e)),dimension0:i.toString()}).start(),l=()=>{if(s.setClientMetadata(this.clientMetadata),s.success)a.tG.info(572836e3,a.nh.CoreDefault,s.stop());else{const e="ErrorWithoutPendingResponse"===s.resultSignature||"ResponseCallbackException"===s.resultSignature||"We called into done callback"!==s.message;s.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),a.tG.error(572836001,a.nh.CoreDefault,s.stop())}};(0,S.I)("PersistMessageId")?e.messageId=null!==(n=e.messageId)&&void 0!==n?n:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,k.l0.typeGuard(e)&&e.messages.forEach(((t,o)=>t.messageId=e.messageId+"."+o));const c=C.h.getTypeNameFor(e)===k.w9.getTypeName(),u={message:e,logOp:s,logEvent:l,callback:void 0,sendCount:1};if(!o&&!c){u.callback=(o,i)=>{var n;if(o?(s.success=!1,s.resultSignature=o.error,s.resultDescription=`Error for ${C.h.getTypeNameFor(e)} message ${e.messageId}${k.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${o.error}`):s.resultSignature="Success",t)try{s.message="We called into done callback",t(o,i)}catch(e){s.success=!1,s.resultSignature="ResponseCallbackException",s.resultDescription="Web"===(null===(n=this.clientMetadata)||void 0===n?void 0:n.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}l(),this.updateSendMessageStats(s.success,s.durationMs,o?new Error(o.error):void 0)};const o=()=>{u.callback(new k.F_({code:w.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let i=this.config.responseTimeoutMs;if(k.LQ.typeGuard(e)){const t=e;i=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else k.Yp.typeGuard(e)&&(i=null!==(r=e.maxDelayMs)&&void 0!==r?r:12e4);this.pendingResponseCallbacks.put(e.messageId,u,i,o)}this.egress&&this.egress(e,(e=>this.onEgressError(e,u)),i)}onEgressError(e,t){var o,i;if(e){const n=t.message,r=this.pendingResponseCallbacks.get(t.message.messageId);r?(this.pendingResponseCallbacks.del(n.messageId),r.callback(new k._p({messageId:n.messageId,code:w.xv.EgressError,error:e.message}))):k.w9.typeGuard(n)?(t.logOp.success=null!==(i=null===(o=e.message)||void 0===o?void 0:o.endsWith("Client disconnected."))&&void 0!==i&&i,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${C.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${C.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t){this.messageCallbacks.set(e,t)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(){this.pendingResponseCallbacks.forEach(((e,t)=>{e&&(this.pendingResponseCallbacks.del(t),e.callback(new k._p({messageId:t,code:w.xv.Cancelled,error:"Cancelled"})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new s.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});a.tG.info(572836002,a.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const o=new b.vf({sessionHealthEventName:"ProcessMessage",source:this.source,reason:b.l6.Client,impact:this.source===b.aM.ClientRuntime?b.Pq.MissingOutput:b.Pq.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),i=()=>{if(o.setClientMetadata(this.clientMetadata),o.success)a.tG.info(572836003,a.nh.CoreDefault,o.stop());else{const e="UnsupportedMessage"===o.resourceId||"Timeout"===o.resultSignature||"OnResponseInvokedMoreThanOnce"===o.resultSignature||"MessageCallbackException"===o.resultSignature||"We called into messageCallback"!==o.message;o.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),a.tG.error(572836032,a.nh.CoreDefault,o.stop())}};let n=this.messageCallbacks.get(C.h.getTypeNameFor(e));n?o.resourceId=x(C.h.getTypeNameFor(e)):n=(e,t)=>{o.resourceId=x(C.h.getTypeNameFor(e)),"MalformedMessageName"!==o.resourceId&&(o.resourceId="UnsupportedMessage"),t(new k._p({messageId:e.messageId,code:w.xv.UnsupportedMessage,error:`Message type ${C.h.getTypeNameFor(e)} is not supported`}))};let r=!1;const s=(n,s)=>{r?(o.success=!1,o.resultSignature="OnResponseInvokedMoreThanOnce",o.resultDescription=`Invoked onResponse for ${C.h.getTypeNameFor(e)} message ${e.messageId} more than once`):n?(o.success=!1,o.resultSignature=n.error,void 0!==n.code&&(o.dimension0=w.xv[n.code]),o.resultDescription=`Error for ${C.h.getTypeNameFor(e)} message ${e.messageId}: ${n.error}`):o.resultSignature="Success",r=!0,i(),n&&!C.h.matchesTypesFor(n,[k._p.getTypeName()])&&(n=new k._p({error:"Internal Server Error"})),this.updateProcessMessageStats(o.success,o.durationMs,n?new Error(n.error):void 0),n?(n.messageId=e.messageId,t(n)):s?(s.messageId=e.messageId,t(void 0,s)):t()};try{o.message="We called into messageCallback",n(e,s)}catch(e){o.success=!1,o.resultSignature="MessageCallbackException",o.resultDescription=JSON.stringify({message:e.message,stack:e.stack}),i(),this.updateProcessMessageStats(!1,o.durationMs,e),t()}}processResponse(e){var t;const o=new s.I({operationName:"ProcessResponse"});if(o.success=!0,o.setClientMetadata(this.clientMetadata),o.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),i=null==t?void 0:t.callback;if(i){if(k.i.typeGuard(e)&&!e.finalResponse){const o=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,o)}else this.pendingResponseCallbacks.del(e.messageId);C.h.matchesTypesFor(e,[k._p.getTypeName()])?i(e):i(void 0,e)}else o.resultSignature="NoPendingMessage",o.resultDescription=`${e.messageId}`,o.success=!1}else o.resultSignature="NoMessageIdSetInResponse",k._p.typeGuard(e)?o.resultDescription=e.error:o.resultDescription="MessageId is not available",o.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(o.resourceId=x(C.h.getTypeNameFor(e)),a.tG.info(572836034,a.nh.CoreDefault,o.stop()))}updateSendMessageStats(e,t,o){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||o?e&&o&&a.tG.warn(572836036,a.nh.CoreDefault,"Succeeded send message provided error object."):a.tG.warn(572836035,a.nh.CoreDefault,"Failed send message did not provide error object."),e||(o&&o.message===m.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,o){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||o?e&&o&&a.tG.warn(572836038,a.nh.CoreDefault,"Succeeded process message provided error object."):a.tG.warn(572836037,a.nh.CoreDefault,"Failed process message did not provide error object."),e||(o&&o.message===v.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var I,E,A=o(85430),B=o(73165),R=o(25626),M=o.n(R);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(I||(I={}));class D{constructor(e){this.logOp=new s.I({operationName:"MessageQueue",success:!0}),this.queue=new(M())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,o){const i=this.queue;if(1e3===i.length){this.logOp.resourceId="QueueFull",this.logOp.durationMs=0,this.logOp.success=!1,a.tG.warn(508843746,a.nh.CoreDefault,this.logOp);const e=i.shift();e.onResponse&&e.onResponse(new k._p({error:I.DroppedAsOldestInQueue}))}i.push({message:e,onResponse:t,timeQueued:B.Aq.getCurrentTimeMs(),attemptNumber:o})}sendOnSessionInitialized(e){const t=this.queue.length;let o=0;if(t>0){const i=B.Aq.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(o++,t.onResponse&&t.onResponse(new k._p({error:I.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${o}`,this.logOp.durationMs=i,this.logOp.success=!0,a.tG.warn(508843745,a.nh.CoreDefault,this.logOp)}}containSequencedSyncMessage(e){return e.message instanceof k.Tb&&C.h.matchesTypesFor(e.message,[k.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof k.l0&&C.h.matchesTypesFor(e.message,[k.l0.getTypeName()])}}!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(E||(E={}));const P=(e,t,o,i)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,i)=>{t||C.h.getTypeNameFor(i)!==k.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),o&&o(t,i)}),void 0,i))},N=(e,t,o,i)=>{t&&(e.messageQueue.push(t,o,i),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new s.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});a.tG.error(508843789,a.nh.CoreDefault,t)})))},F=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{a.tG.error(508843788,a.nh.CoreDefault,`Init failed: ${e}`)})))};class O{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,o,i){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class j extends O{constructor(){super(...arguments),this.stateName=E.Initing,this.possibleNextStates=[E.Running,E.Disconnected,E.Closed]}sendMessage(e,t,o){C.h.matchesTypesFor(e,[k.eE.getTypeName()])?P(this.context,e,t,o):N(this.context,e,t)}sendBytes(e){F(this.context,e)}onConnectionClose(){this.context.setState(E.Disconnected)}}class q extends O{constructor(){super(...arguments),this.stateName=E.Running,this.possibleNextStates=[E.Disconnected,E.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,o,i){P(this.context,e,t,o)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(E.Disconnected)}}class L extends O{constructor(){super(...arguments),this.stateName=E.Disconnected,this.possibleNextStates=[E.Initing,E.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}sendMessage(e,t,o,i){if(C.h.matchesTypesFor(e,[k.eE.getTypeName()]))this.context.setState(E.Initing),P(this.context,e,t,o);else if(C.h.matchesTypesFor(e,[k.w9.getTypeName()]))this.context.setState(E.Closed);else{if(!i)return void N(this.context,e,t,o);t&&t(new k._p({messageId:e.messageId,error:I.DroppedBecauseClientDisconnected}))}}sendBytes(e){F(this.context,e)}}class H extends O{constructor(){super(...arguments),this.stateName=E.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}}var z=o(17934),W=o(31201),G=o(53944),U=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const V=1e5,$=1e4,K=1e3;class J{constructor(e){var t,o,i;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.pendingQueue=[],this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new s.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.dynamicRateControllerEnabled=null!==(t=null==e?void 0:e.dynamicRateControllerEnabled)&&void 0!==t&&t,this.dynamicRateControllerEnabled&&(this.messageQueue=new(M())),this.reducedPingPongRetryEnabled=null!==(o=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==o&&o,this.startQueueProcessingInOpen=null===(i=null==e?void 0:e.startQueueProcessingInOpen)||void 0===i||i}init(e,t,o,i,n,r){this.worker=e,this.ingress=t,this.queryEgressCacheSize=o,this.clientMetadata=n,this.networkMode=i,this.reliabilityManager=(0,G.a)(this.worker,this.close.bind(this),void 0,r,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.dynamicRateControllerEnabled&&(this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.startQueueProcessingInOpen||this.processQueue()),this.resolveInitPromise()}open(){const e=new s.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.dynamicRateControllerEnabled?this.startQueueProcessingInOpen&&this.processQueue():(this.egressRateControlTimer=setInterval((()=>this.flush()),1e3),this.flush())})).catch((t=>{var o;e.success=!1,e.resultDescription=null!==(o="Catch: "+(null==t?void 0:t.message))&&void 0!==o?o:""})).finally((()=>{a.tG.info(507834384,a.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){if(this.dynamicRateControllerEnabled){const t=new s.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),a.tG.info(507388684,a.nh.CoreDefault,t.stop())}}setRpsBps(e,t){const o=new s.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();o.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.9*e,o.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.9*t,o.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),a.tG.info(507388683,a.nh.CoreDefault,o.stop())}close(){var e,t;return U(this,void 0,void 0,(function*(){const o=new s.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();if(o.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,this.dynamicRateControllerEnabled){null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const i=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();o.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&i&&(yield this.queueProcessingCompletePromise),o.setDataField("QueueSizeAfterFlush",this.messageQueue.length),o.setDataField("IsConnected",i)}this.reliabilityManager?this.reliabilityManager.close():o.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,a.tG.info(507834381,a.nh.CoreDefault,o.stop())}))}clearMessageQueues(){this.pendingQueue=[],this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var o,i,n;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const r=this.getMessageSize(e);if(r>=3e6)this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${r}`);else{if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);if(this.validateSyncMessage(e.messageId,e.seqId),this.dynamicRateControllerEnabled){const n=null!==(o=e.messageId)&&void 0!==o?o:"id"+this.emptyMessageId++,r={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:n,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},l=t>0,c=new s.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${l}`}).start();c.setClientMetadata(this.clientMetadata,!0);const u={message:r,logOp:c};if(c.dimension0="Enqueue",l?this.messageQueue.unshift(u):this.messageQueue.push(u),this.messageQueue.length>1e4)throw this.messageQueue.shift(),new Error("MessageQueue max size reached.");a.tG.info(507388547,a.nh.CoreDefault,c.stop()),null===(i=this.resolveQueueNotEmptyPromise)||void 0===i||i.call(this)}else{const t=this.queryEgressCacheSize(),o=this.egressMessageCount>=this.rpsThreshold,i=this.egressByteCount>=this.bpsThreshold,r=t>$,s=this.reliabilityManager.checkConnection(),a=0!==this.pendingQueue.length,l=this.pendingQueue.length>=1e4;if(!s||o||i||a||l||r){let c="";const u=[];(a||l)&&(c+=l?"Pending queue max exceeded. ":"Pending queue not empty. ",u.push(this.pendingQueue.length.toString().length.toString())),r&&(c+=t>=$?"Egressed cache max exceeded. ":"",u.push(t.toString().length.toString())),o&&(c+="RPS exceeded. ",u.push(this.egressMessageCount.toString().length.toString())),i&&(c+="BPS exceeded. ",u.push(this.egressByteCount.toString().length.toString())),c+=s?"":"Not connected. ",this.logEgressActivity(!0,`networkMode: ${this.networkMode}`,c,u);const d=null!==(n=e.messageId)&&void 0!==n?n:"id"+this.emptyMessageId++;return void this.pendingQueue.push({obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:d,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage})}this.sendToNetworkWorker(e)}}}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.reliabilityManager.postEgress();const t=this.getMessageSize(e);this.logEgressCount(t)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}flush(){if(!this.reliabilityManager){const e=new s.I({operationName:"NetworkRateControllerFlushFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void a.tG.info(507834373,a.nh.CoreDefault,e.stop())}let e=0,t=0;for(;this.pendingQueue.length>0&&this.queryEgressCacheSize()<$&&e<this.rpsThreshold&&t<this.bpsThreshold&&this.reliabilityManager.checkConnection();){const o=this.pendingQueue.shift();this.sendToNetworkWorker(o),e++,t+=this.getMessageSize(o)}}processQueue(){var e,t;return U(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new s.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void a.tG.info(507573643,a.nh.CoreDefault,e.stop())}const o=new s.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){o.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new s.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),a.tG.info(507281410,a.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){o.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){o.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=K)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=Date.now()-this.egressRateControlIntervalStart,t=K-e+100;let o="";this.egressMessageCount>=this.rpsThreshold&&(o+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(o+="BPS exceeded.");const i="rateLimitHit",n=new s.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();n.setClientMetadata(this.clientMetadata,!0),n.success=!0,n.resultDescription=i,n.resultSignature=o,n.dimension0=this.messageQueue.length.toString().length.toString(),n.dimension1="rateLimitHit",n.setDataField("QueueLength",this.messageQueue.length),n.setDataField("RateLimitDelayMs",t),a.tG.info(507281409,a.nh.CoreDefault,n.stop()),this.startRateLimiting(t);break}const e=this.messageQueue.shift();e.logOp.dimension0="Dequeue",this.sendToNetworkWorker(e.message),a.tG.info(507388682,a.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}this.resolveQueueProcessingCompletePromise(),this.resolveQueueProcessingCompletePromise=void 0,o.setClientMetadata(this.clientMetadata,!0),o.setDataField("QueueSize",this.messageQueue.length),o.setDataField("IsConnected",null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection()),o.setDataField("IsClosing",this.isClosing),a.tG.info(507368671,a.nh.CoreDefault,o.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new s.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),a.tG.info(507834370,a.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,o,i){var n,r,l,c;const u=new s.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=o,i&&(u.dimension0=null!==(n=i[0])&&void 0!==n?n:"",u.dimension1=null!==(r=i[1])&&void 0!==r?r:"",u.dimension2=null!==(l=i[2])&&void 0!==l?l:"",u.dimension3=null!==(c=i[3])&&void 0!==c?c:""),a.tG.info(507626007,a.nh.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>K&&((this.egressMessageCount>50||this.egressByteCount>V)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>V?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,a.tG.info(508843792,a.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var Z=o(73789);class Y{constructor(e,t,o,i,n,r,l,c,u,g,h){this.logCountLimiter=new B.yq(Y.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=B.Aq.convertWebSocketUrlToHttp(this.globalUrl),o=!e,i=null!=e?e:new s.I({operationName:"HttpsTest",resourceId:d(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),n={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":i.cv},body:JSON.stringify(B.Aq.createHealthCheckRequest(this.clientMetadata))};(0,W.OW)(t,n,((e,t)=>{e?(i.dimension1="HttpErr",i.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(i.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,o&&(i.success=!0)):(i.dimension1="HttpNoResp",i.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),o&&i.stop(),this.logCountLimiter.log((()=>{a.tG.info(508843780,a.nh.CoreDefault,i)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=o,this.sessionInitializer=i,this.ingress=n,this.queryEgressCacheSize=r,this.onConnectionClose=l,this.onDetectedWSBlock=c,this.sessionCorrelationVector=u,this.httpFallbackEnabled=g.httpFallbackEnabled,this.dynamicRateControllerEnabled=g.dynamicRateControllerEnabled,this.reducedPingPongRetryEnabled=g.reducedPingPongRetryEnabled,this.startQueueProcessingInOpen=g.startQueueProcessingInOpen,this.networkWorkerLogOp=new s.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=h||Z.y.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,o=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const i=()=>{if(o||!this.alreadyLoggedReconnectAttempt){const e=o?Y.initialAttemptTimeout:Y.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new s.I({operationName:"ConnectionFailingOrSlow",dimension0:o?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});a.tG.info(508843787,a.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!o,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new s.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});a.tG.error(508843786,a.nh.CoreDefault,t)})).then((()=>{i(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),i(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.dynamicRateControllerEnabled&&this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),!this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new s.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});a.tG.info(508843785,a.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,o)=>{let i=0;const n=B.Aq.getCurrentTimeMs()?B.Aq.getCurrentTimeMs()-t:0,r=[1e3,2e3,5e3,1e4,6e4];return i=r[Math.max(0,Math.min(r.length-1,e-1))],i=Math.max(i-n,1e3),i=o&&o>0?Math.min(5e3,i):i,i})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpFallbackEnabled?this.httpTestsSuccessCount:void 0)):this.getNetworkMode()===Z.y.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!C.h.matchesTypesFor(e,[k.eE.getTypeName()]))return void(C.h.matchesTypesFor(e,[k.YK.getTypeName()])||a.tG.error(508843784,a.nh.CoreDefault,new s.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let o,i;if(C.h.matchesTypesFor(e,[k.VR.getTypeName()])?(this.castBinaryData(e),o=z.r.serialize(e)):o=JSON.stringify(e),k.Tb.typeGuard(e)&&(i=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:o});const n=k.eE.typeGuard(e)&&this.getNetworkMode()===Z.y.HttpFallback;this.getNetworkRateController().egress({obj:o,isHttpSessionInitMessage:n,messageId:e.messageId,seqId:i},t)}bypassRateController(e){return k.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):a.tG.error(508843783,a.nh.CoreDefault,new s.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=B.Aq.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const o=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",d(o)),this.connect(o),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(o,i)=>{if(t.success=!o,t.resourceId=i?d(i.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===Z.y.HttpFallback?(t.resultDescription=o?`HTTP Error: ${o.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=o?`WS Error: ${o.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),o||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.httpFallbackEnabled?this.getNetworkMode()===Z.y.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=Z.y.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"):0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(this.permanentlyClosed=!0,t.dimension1="WSBlocked",this.onDetectedWSBlock()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"),this.logCountLimiter.log((()=>{a.tG.info(508843782,a.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{a.tG.info(508843781,a.nh.CoreDefault,t.stop())})),i.forceReconnect){this.close();const t=new s.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=i.sliceUrl,this.dynamicRateControllerEnabled&&this.getNetworkRateController().setRpsBps(i.maxRPS,i.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new s.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new J({dynamicRateControllerEnabled:this.dynamicRateControllerEnabled,reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled,startQueueProcessingInOpen:this.startQueueProcessingInOpen})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>a.tG.info(508372418,a.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,this.queryEgressCacheSize,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===Z.y.JSWebSockets?"WebSocket":"HTTP")}}Y.initialAttemptTimeout=1e5,Y.reconnectAttemptTimeout=2e4,Y.className="NetworkWorkerManager";var Q=o(80500);class X extends A.EventEmitter{constructor(e,t,o,i,n,r,a,l,c){super(),this.cvParent=new y.W,this.logOp=new s.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new B.yq("SessionState"),this.logRetryTelemetry=!0,this.stats=t,this.allStates={[E.Initing]:new j(this),[E.Running]:new q(this),[E.Disconnected]:new L(this),[E.Closed]:new H(this)},this.setState(E.Initing),this.messageEndpoint=new _({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(n),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(k.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new Y(e,n,o,i,this.ingress.bind(this),this.messageEndpoint.queryEgressCacheSize.bind(this.messageEndpoint),this.onConnectionClose.bind(this),(()=>{this.onSessionClose(void 0,"WSNotSupported")}),this.getCorrelationVector.bind(this),a,c),this.messageQueue=new D({sendMessage:(e,t,o,i)=>this.state.sendMessage(e,t,o,i),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),i.on("connect",((e,t,o,i,n,r,s)=>{this.setState(E.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,o,i,n,r,s)})),i.on("reconnect",(()=>this.emit("reconnect"))),i.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=r,this.delayBeforeSocketClose=a.delayBeforeSocketClose,this.gateUtils=l,this.gateUtils&&this.gateUtils.isChangeGateEnabled("LogRetryMessageEvent").then((e=>{this.logRetryTelemetry=e})).catch((()=>{}))}setState(e,t,o){if(this.state&&e===this.state.stateName)return;const i=this.state?E[this.state.stateName]:"undefined",n=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===E.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${n?E[e]:i}`,this.logOp.resultDescription=`Previous state: ${i}`,this.logOp.dimension0=`Attempted state: ${E[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!n?"Unexpected state change":""),this.logOp.success=n,a.tG.info(508843791,a.nh.CoreDefault,this.logOp)})),n&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(o))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,o){this.retrySendMessage(e,t,X.maxRetries,o)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){if(this.sendMessage(new k.w9),this.delayBeforeSocketClose)setTimeout((()=>{this.networkWorkerManager.close(!0);const t=e||new k.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new k.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}),100);else{this.networkWorkerManager.close(!0);const t=e||new k.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new k.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}}ingress(e,t){let o;try{o=JSON.parse(e)}catch(e){a.tG.error(508843790,a.nh.CoreDefault,new s.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(o){if(t&&k.YK.typeGuard(o)&&t(o),this.networkWorkerManager.getNetworkMode()===Z.y.HttpFallback&&k.ry.typeGuard(o)){const e=o;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(o,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,o){e&&this.networkWorkerManager.egress(e,o).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(E.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=B.Aq.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,o,i,n){const r=X.maxRetries-o;this.state.sendMessage(e,((l,c)=>{var u,d,g,h;n&&(l&&0==o?(n.success=!1,a.tG.info(507025311,a.nh.CoreDefault,n.stop())):l&&o>0?(n.dimension0=(r+1).toString(),n.dimension1=null!==(u=l.code.toString())&&void 0!==u?u:"NoErrorCode",n.resultSignature=null!==(d=l.error)&&void 0!==d?d:"NoErrorMessage"):(n.success=!0,a.tG.info(507025310,a.nh.CoreDefault,n.stop()))),l&&o>0&&this.canBeRetried(e)&&this.isTransientError(l)?(this.logRetryTelemetry&&!n&&((n=new s.I({operationName:"RetrySendMessage",success:!0,dimension0:r.toString()}).start()).resourceId=C.h.getTypeNameFor(e),n.dimension1=null!==(g=l.code.toString())&&void 0!==g?g:"NoErrorCode",n.resultSignature=null!==(h=l.error)&&void 0!==h?h:"NoErrorMessage",n.resultDescription=`Retrying message with messageId: ${e.messageId}${k.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),C.h.matchesTypesFor(l,[k.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(l),this.retrySendMessage(e,t,o-1,i)):t&&t(l,c)}),r,i)}canBeRetried(e){return!C.h.matchesTypesFor(e,[k.eE.getTypeName(),k.VR.getTypeName(),Q.x5.getTypeName()])}isTransientError(e){const t=e.error;return t!==m.SyncMessageUnsupportedBatch&&t!==m.UnexpectedSeedMessage&&t!==m.UnsupportedSyncMessage&&t!==m.AnnotationTokenNotFound&&t!==I.ArrivedBeforeReseeding&&t!==I.DroppedAsOldestInQueue&&t!==I.DroppedBecauseClientDisconnected}}X.maxRetries=2;var ee=o(76640);class te{}var oe,ie=o(64399),ne=o(62672),re=o(64843);!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(oe||(oe={}));class se{constructor(){this.timers=new Map}scheduleRefresh(e,t,o,i){let n=this.timers.get(e);n||(n={numberOfAttempts:0},this.timers.set(e,n)),n.refreshTimeoutId&&(clearTimeout(n.refreshTimeoutId),n.refreshTimeoutId=void 0),n.expiredTimeoutId&&(clearTimeout(n.expiredTimeoutId),n.expiredTimeoutId=void 0);let r=1e3*t-se.tokenRefreshBufferMs,s=1e3*t-se.tokenExpirationBufferMs;r>0?n.numberOfAttempts=0:(++n.numberOfAttempts,r=se.tokenRefreshBackoffIntervalMs,s=se.tokenExpirationBufferMs),n.numberOfAttempts<=se.tokenRefreshMaximumAttempts&&(n.refreshTimeoutId=setTimeout((()=>{o()}),r)),i&&(n.expiredTimeoutId=setTimeout((()=>{i()}),s))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,o)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(o)}))}}se.tokenRefreshBufferMs=24e4,se.tokenExpirationBufferMs=12e4,se.tokenRefreshBackoffIntervalMs=3e4,se.tokenRefreshMaximumAttempts=3;class ae extends A.EventEmitter{constructor(e,t,o,i,n){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=o,this.sendMessage=i,this.options=n||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=B.Aq.getCurrentTimeMs(),o=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,i=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,n=new s.I({operationName:"SessionInit"}).start(),r={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:o,timeSinceLastSyncMessage:i,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0},l=this.options.overrideSessionInitMessage(new k.eE({protocolVersion:w.mH,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(l,((t,o)=>{if(n.success=!t,n.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",n.resourceId=d(null==o?void 0:o.sliceUrl),n.setClientMetadata(this.clientMetadata),(null==o?void 0:o.sessionKey)&&r.sessionKey!==o.sessionKey&&(r.sessionKey=o.sessionKey),t&&(r.error=t.error),n.resultDescription=JSON.stringify(r),a.tG.info(508843779,a.nh.CoreDefault,n.stop()),e.onResponse(t,o),t)this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&o.forceReconnect)this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);else{if(!o.anonymousToken||!o.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),void a.tG.error(508843778,a.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=o.anonymousToken,this.onSuccessfulSessionInitOnServerSide(o)}}))}onSuccessfulSessionInitOnServerSide(e){this.tokenRefreshManager.scheduleRefresh(oe.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},this.initHostAuthToken();const t=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,t,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows),t&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:re.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new s.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==re.Pu.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",ie.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void a.tG.info(508843777,a.nh.CoreDefault,t.stop());a.tG.info(508843776,a.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,a.tG.error(508843747,a.nh.CoreDefault,t.stop())}))}}sendTokenProvisionMessage(e){const t=new k.kd({authToken:e,version:1});this.emit("serverAuthenticationStateChange",ie.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){if(e||!t||!t.tokenExpirationSeconds)return void this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);const o=t.tokenType&&t.tokenType==ne.OY.WacUserInfo?ie.f.WacUserInfoAuthenticated:ie.f.Authenticated;this.emit("serverAuthenticationStateChange",o),this.tokenRefreshManager.scheduleRefresh(oe.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))}}var le,ce=o(55512),ue=o(69689),de=o(92318),ge=o(7727),he=o(34516),pe=o(9798),fe=o(86689),me=o(99919),ve=o(76e3),ye=o(59446),be=o(3843),Se=o(48490),Ce=o(73800),we=o(66061),ke=o(31987),Te=o(74066),xe=o(52428);!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(le||(le={}));class _e{constructor(e,t,o){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,o)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,o):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,o)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,o):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,o.enableDeltas&&(this.deltaHandlers=(new Map).set(C.h.getTypeNameFor(ke.Q),ye.MM).set(C.h.getTypeNameFor(ke.s),ye.a4),this.itemsForDelta=new Map),this.enableEarlyJoin=o.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const o=new s.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes((0,we.v)(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),o.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,o)=>{t.push(this.createWorkflowImplementation(e,o))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,o)=>{o.registerContextTypes((0,we.v)(e.requestedContextTypesRules).map((([e,t])=>e))),o.attachToWorkflowGraph(e)}))),o.success=!0,a.tG.info(572838110,a.nh.CoreDefault,o.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const o=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>o.set(e.workflow.id,e.workflow))),o}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,o){const i=e.getWorkflowNodes(),n=this.executionTrackersByWorkflowNameBySession.get(t),r=(e,i)=>{o&&o(e,i),this.enableEarlyJoin&&(()=>{for(const e of this.executionTrackersByWorkflowNameBySession.get(t).values())if(e.graphNode.workflow.kind===pe.wC.Join)for(const t of e.getExecutionState().keys())if(be.a4.isParentContextId(t,i))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())};for(const e of i){const t=n.get(e.workflow.id),o=new xe.g(e,r.bind(this),t);n.set(e.workflow.id,o)}for(const e of n.values())this.setDownstreamWorkflowExecutionTrackers(e,n),this.setUpstreamWorkflowExecutionTrackers(e,n)}canActivateWorkflow(e,t){var o;return e.location===Se.aZ.Local||!!t.hasConnected&&!((null===(o=e.workflow.requiredTokenTypes)||void 0===o?void 0:o.length)>0&&t.getServerAuthenticationState()===ie.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:o}=e;for(const i of o.downstreamWorkflows||[]){const o=t.get(i.workflow.id);this.setDownstreamWorkflowExecutionTrackers(o,t),e.downstreamWorkflowExecutionTrackers.add(o)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:o}=e;for(const i of o.upstreamWorkflows||[]){const o=t.get(i.workflow.id);this.setUpstreamWorkflowExecutionTrackers(o,t),e.upstreamWorkflowExecutionTrackers.add(o)}}deactivateServerWorkflow(e,t){var o;e.location!==Se.aZ.Local&&(null===(o=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===o||o.get(e.workflow.id).clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const o of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(o)),e.attachToWorkflowGraph(o);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,o){const i=this.executionTrackersByWorkflowNameBySession.get(o).get(e.id);e.kind===pe.wC.Join&&C.h.matchesTypesFor(t.body,e.inputTypes)&&i.addInputItemToProcess(t.contextId),(e.kind===pe.wC.SingleItem&&C.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===pe.wC.Join&&C.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&i.beforeWorkflowExecution(t.contextId)}isReadyToEarlyJoin(e,t,o){const i=i=>{var n;const r=Array.from(null!==(n=i.states)&&void 0!==n?n:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),l=new s.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();l.setClientMetadata(o),l.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${i.hasProcessedAllInputItems}, allUpstreamComplete: ${i.allUpstreamComplete}, states: ${r}`,a.tG.info(512550800,a.nh.CoreDefault,l.stop())},n=0===e.countItemsToProcess(t);if(!n)return this.enableEarlyJoin||i({hasProcessedAllInputItems:n}),!1;const{allUpstreamComplete:r,states:l}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?r:(i({hasProcessedAllInputItems:n,allUpstreamComplete:r,states:l}),!1)}areAllUpstreamWorkflowComplete(e,t){const o=new Map;for(const i of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[n,r]of i.getExecutionState())if(e.push([n,r]),be.a4.isParentContextId(t,n))return o.set(i.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:o};e.length>0&&o.set(i.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:o}}runLocalWorkflows(e,t,o=!1){var i,n,r;const l=(e,o,i)=>{var n,r;const l=t.getWorkflowItemStorage(),{workflow:c}=e,u=null===(n=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===n?void 0:n.get(c.id),d=c.inputTypes.concat(c.kind===pe.wC.Join?c.collectionScopeType:[]),g=new s.I({operationName:"RunLocalWorkflows",success:!0,resourceId:c.id,joinContextId:o.contextId}).start();if(g.setClientMetadata(t.getClientMetadata()),C.h.matchesTypesFor(o.body,d)){const n=(0,Te.CY)(i.parentPath,o);if(c.kind===pe.wC.Join){if(C.h.matchesTypesFor(n.body,[c.collectionScopeType]))return l.setScopeItem(n,c),g.resultDescription=`Scope item: ${o.id} (${C.h.getTypeNameFor(o.body)})`,a.tG.info(524126153,a.nh.CoreDefault,g.stop()),void this.setScopeExecutionNotification(t,e,n,ee.VI.Internal);{u.removeProcessedInputItem(n.contextId);const e=l.getScopeItem(n.contextId,c);if(!e)return g.resultDescription=`Filtered out join invalidation: out of scope type (${c.collectionScopeType}), item id: ${n.id}`,void a.tG.info(541173894,a.nh.CoreDefault,g.stop());l.addItemToWorkflowList(n,c),g.joinContextId=e.contextId,g.resultDescription=`Input item: ${o.id} (${C.h.getTypeNameFor(o.body)})`}}if(C.h.getBaseTypesFor(n.body).indexOf(ce.W1.getTypeName())>=0){const e=[...n.parentPath,n.id];let o=!0;for(const i of null!==(r=c.outputTypes)&&void 0!==r?r:[])if(!t.getContextAnnotations(i,ee.vd.LocalWorkflow,e,c.id)){o=!1;break}if(o)return}const s=()=>{var i;const[r,d]=t.resolveRequestedContexts(c);if(!r)return g.resultDescription=`Required contexts are not ready for ${c.id}. Retrying execution in 500 milliseconds...`,a.tG.info(545837259,a.nh.CoreDefault,g.stop()),void setTimeout(s,500);if(c.kind===pe.wC.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:n,inputItems:[n],requestedContexts:d,session:t,orchestrationMode:ee.VI.Internal,triggerReason:le.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,c,t)}).then((()=>{a.tG.info(509154263,a.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,a.tG.error(572838111,a.nh.CoreDefault,g.stop())}));else if(c.kind===pe.wC.Join){const n=o.contextId,r=l.getScopeItem(n,e.workflow);if(!r)return g.resultDescription=`No scope item for ${c.id} workflow from contextId ${n}`,void a.tG.info(526758475,a.nh.CoreDefault,g.stop());const s=this.isReadyToEarlyJoin(u,r.contextId,t.getClientMetadata()),h=s?le.JoinEarlyCompletion:le.JoinMaxAnnnotation;if(l.isWorkflowReady(r.contextId,c)||s){if(!(null===(i=this.pendingScopeExecutionNotificationsByWorkflow.get(c.id))||void 0===i?void 0:i.get(r.contextId)))return g.resultDescription=`Workflow ${c.id}, contextId ${r.contextId}, already queued, skipping new scope execution`,void a.tG.info(528048977,a.nh.CoreDefault,g.stop());const o=l.getItemsToExecute(r.contextId,c);this.queueWorkflow({workflowInfo:e,scopeItem:r,inputItems:o,requestedContexts:d,session:t,orchestrationMode:ee.VI.Internal,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,r,c,t)}).then((()=>{a.tG.info(509154262,a.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,a.tG.error(541173895,a.nh.CoreDefault,g.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(c.id).delete(r.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(c.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(c.id)}}};s()}};let c=e;o&&(c=[new ue.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new ce.hD}]}),new ue.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new ce.SB}]})],t.getContextIdManager().applyContextIdOnOperations(c),c=c.concat(e));for(const e of c){const o=C.h.getTypeNameFor(e);for(const s of e.items)if(t.applyOperationForContext(e,s,ee.vd.Submitted),o!==ue.n4.getTypeName()){if(s.body)if(o===ue.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(s,e,t);else{null===(n=this.itemsForDelta)||void 0===n||n.set(e.parentPath.concat(s.id).toString(),s);for(const t of this.workflowsWithoutSessionAffinity)l(t,s,e);for(const o of null!==(r=this.workflowsWithSessionAffinity.get(t))&&void 0!==r?r:[])l(o,s,e)}}else null===(i=this.itemsForDelta)||void 0===i||i.delete(e.parentPath.concat(s.id).toString())}}handleLocalDeltaUpdate(e,t,o){const i=new s.I({operationName:"LocalDeltaUpdate",dimension0:C.h.getTypeNameFor(e.body),success:!0});i.start();try{const n=this.deltaHandlers.get(C.h.getTypeNameFor(e.body)),r=this.itemsForDelta.get(t.parentPath.toString());if(n&&r){const s=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,l=n(e.body,r.body);if(l){const t={id:r.id,revId:e.revId,body:l,parentPath:s,delta:e.body,contextId:e.contextId},n=new ue.I({parentPath:t.parentPath,items:[t]});a.tG.info(539637591,a.nh.CoreDefault,i.stop()),this.runLocalWorkflows([n],o)}else i.success=!1,i.resultDescription="Failed because the handler did not produce valid updated item",a.tG.info(539637592,a.nh.CoreDefault,i.stop())}else i.success=!1,i.resultDescription="Failed due to lack of handler or parent item",a.tG.info(539637593,a.nh.CoreDefault,i.stop())}catch(e){i.success=!1,i.resultDescription=`Failed to apply delta, error: ${e}`,a.tG.info(539637594,a.nh.CoreDefault,i.stop())}}createWorkflowImplementation(e,t){const o=e.factory();return{workflow:e,workflowLambda:o,initPromise:this.initWorkflow(e.kind,o,t)}}initWorkflow(e,t,o){const i=new Ce.I({model:void 0,clientMetadata:o?o.getClientMetadata():void 0,userContext:o?o.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===pe.wC.SingleItem||e===pe.wC.Join?t.init(this.site,i):Promise.resolve()}queueWorkflow(e){return this.executionTrackersByWorkflowNameBySession.get(e.session).get(e.workflowInfo.workflow.id).setExecutionState(e.scopeItem.contextId,be.si.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.orchestrationMode,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const o of e)t.onAnnotationResults(o,ee.vd.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,o,i,n,r,l){return new Promise(((c,u)=>{var d,g,h;const p=[],f=e.workflow,m=new s.I({operationName:"ExecuteWorkflow",resourceId:f.id,joinContextId:null!==(d=null==t?void 0:t.contextId)&&void 0!==d?d:"",resultDescription:null!=l?l:"",success:!0}).setClientMetadata(i.getClientMetadata());m.start();const v=null!==(g=null==t?void 0:t.contextId)&&void 0!==g?g:o[0].contextId,y=null!==(h=null==t?void 0:t.revId)&&void 0!==h?h:o[0].revId,b=(()=>{const e=new Map;if(t&&(t.parentPath||a.tG.error(525382231,a.nh.CoreDefault,`Missing scope item parent. Workflow: ${f.id}. Type: ${C.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(o))for(const t of o)t&&t.body&&(t.parentPath||a.tG.error(525382232,a.nh.CoreDefault,`Missing parent. Workflow: ${f.id}. Type: ${C.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),S=(e,t=m)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",a.tG.error(572838112,a.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;a.tG.info(572838113,a.nh.CoreDefault,t.stop())},w=new Ce.I({model:new ve.B(o[0],n),clientMetadata:i.getClientMetadata(),userContext:i.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),T=e=>{S(e?e.message:void 0),e?u(e):c(p)},x={setAnnotations:(n,l,c,d)=>{var g;const h=new s.I({operationName:"SetAnnotations",resourceId:l,joinContextId:null!==(g=null==t?void 0:t.contextId)&&void 0!==g?g:"",success:!0}).setClientMetadata(i.getClientMetadata());h.start();const m=t=>{a.tG.info(555866112,a.nh.CoreDefault,new me.v({annotationType:l,annotationState:t,workflowId:e.workflow.id}))};for(const e of c)e.metadata=Object.assign(Object.assign({},e.metadata),{state:de.r.Created}),m(de.r.Created);const w=b.get(n),T=C.h.getTypeNameFor(w.body),x=(()=>{var e;if(f.kind===pe.wC.SingleItem&&o[0].body!==n){const e=`Expected obj to be ${o[0].body} but instead it was ${n}`;return S(e,h),void u(S(e))}let t,s;if(Array.isArray(c))if(!f.outputTypes||f.outputTypes.indexOf(l)<0)t=`Workflow said it would output one of [${f.outputTypes}] but instead output ${l}`;else if(w)for(const e of c)C.h.matchesTypesFor(e,[ge.YH.getTypeName()])?C.h.getTypeNameFor(e)!==l&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${C.h.getTypeNameFor(e)} did not match expected ${l})`):t=`Workflow produced an output that is not an annotation ${C.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return S(t,h),void u(S(t));if(s=d&&d.isSessionAnnotation?["session"]:d&&d.ancestorType?w.parentPath:w.parentPath.concat(w.id),r===ee.VI.External)return;const g=[],p=[];for(const t of c){t.metadata=Object.assign(Object.assign({},t.metadata),{state:de.r.Sent}),m(de.r.Sent);const o=t.id,n=o?null===(e=i.getContextAnnotations(l,ee.vd.LocalWorkflow,s,f.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==o})):void 0;1==(null==n?void 0:n.length)?1==n.length?p.push({id:n[0].id,source:f.id,revId:y,body:t,contextId:v}):a.tG.error(545837260,a.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${o} found for ${l} and local workflow ${f.id}).`):g.push({id:this.getNextClientAnnotationId(),source:f.id,revId:y,body:t,contextId:v})}const b=[];return g.length>0&&b.push(new ue.Xr({parentPath:s,items:g,parentRevId:y})),p.length>0&&b.push(new ue.fZ({parentPath:s,items:p,parentRevId:y})),new k.B_({annotationType:l,ops:b})})();x?(d&&d.immediate?i.onAnnotationResults(x,ee.vd.LocalWorkflow,(()=>{})):p.push(x),(T==ce.hD.getTypeName()||T==ce.SB.getTypeName()||C.h.matchesTypesFor(w.body,[ce.yo.getTypeName(),ce.I3.getTypeName()]))&&i.submitOperationsToSession(x.ops),a.tG.info(509644822,a.nh.CoreDefault,h.stop())):a.tG.info(509644823,a.nh.CoreDefault,h.stop())},submitSignals:e=>{if(r===ee.VI.External)return void u(S("NYI"));const t=new s.I({operationName:"submitSignalsAction",resourceId:f.id,success:!0}).setClientMetadata(i.getClientMetadata());for(const o of e){const e=C.h.getTypeNameFor(o);C.h.matchesTypesFor(o,[he.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${C.h.getTypeNameFor(o)})`,a.tG.info(521413954,a.nh.CoreDefault,t)),f.outputTypes&&-1!==f.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${f.outputTypes}] but instead output ${e}`,a.tG.info(521413953,a.nh.CoreDefault,t)),o.timestamp&&(_e.logTimestampUsageByWorkflowId.has(f.id)||(_e.logTimestampUsageByWorkflowId.add(f.id),t.resultDescription=`Workflow "${f.id}" sets signal.timeStamp`,a.tG.info(509212803,a.nh.CoreDefault,t)))}const o=e.map((e=>({id:this.getNextClientSignalId(),source:f.id,revId:y,body:e,contextId:v}))),n=new ue.g0({parentPath:["session"],parentRevId:y,items:o});i.submitOperations([n])},done:T,overrideWorkflowDefinition:(e,o,n)=>{let r;switch(n){case fe.T.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw a.tG.error(527472289,a.nh.CoreDefault,e),new Error(e)}r=t.contextId;break;case fe.T.Session:r=void 0;break;default:{const e="Defined scope is not supported. "+n;throw a.tG.error(527472290,a.nh.CoreDefault,e),new Error(e)}}const s=new Q.Qr({definition:o,contextId:r,sourceWorkflowId:f.id,targetWorkflowId:e});i.onWorkflowDefinitionOverrideMessage(s)},getDynamicAnnotations:void 0,setBillingDomain:void 0},_=e.workflowLambda;if(f.kind===pe.wC.SingleItem){1!==o.length&&T(new Error("Single item workflows expect a single input")),w.delta=o[0].delta,w.deltas=o[0].deltas;try{const t=_;e.initPromise||(e.initPromise=t.init(this.site,w)),e.initPromise.then((()=>{t.execute(o[0].body,w,x)})).catch((e=>{S(e)}))}catch(e){S(e)}}else if(f.kind===pe.wC.Join){0===o.length&&T(new Error("Join workflows expect an inputs array")),w.delta=t.delta,w.deltas=t.deltas;try{const i=_;e.initPromise||(e.initPromise=i.init(this.site,w)),e.initPromise.then((()=>{i.execute(t.body,o.map((e=>e.body)),w,x)})).catch((e=>{S(e)}))}catch(e){S(e)}}else S(`Workflow kind ${f.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,o,i){var n,r;const l=Date.now(),c={session:e,workflowImplementation:t,scopeItem:o,startTime:l,minTime:l+(0,B.ZF)(t.workflow.minDelayMs,1e3),maxTime:l+(0,B.ZF)(t.workflow.maxDelayMs,5e3),orchestrationMode:i},u=t.workflow.kind===pe.wC.Join?o.contextId:c.scopeItem.parentPath.concat(o.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(u)){const i=new s.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(r=null==o?void 0:o.contextId)&&void 0!==r?r:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();a.tG.info(509727899,a.nh.CoreDefault,i.stop())}else{const i=new s.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(n=null==o?void 0:o.contextId)&&void 0!==n?n:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();a.tG.info(539883075,a.nh.CoreDefault,i.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(u,c)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const o=new Set(Array.from(this.sweepTimers.keys()));for(const[i,n]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[r,l]of Array.from(n.entries())){const{session:n,workflowImplementation:{workflow:c},orchestrationMode:u}=l,d=n.getWorkflowItemStorage(),g=new s.I({operationName:"LocalScopeExecutionNotification",resourceId:c.id,joinContextId:null!==(t=null===(e=l.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(n.getClientMetadata()).start(),h=()=>{if(c.kind===pe.wC.Join){const e=Date.now(),{workflow:t}=l.workflowImplementation,o=l.scopeItem.contextId,i=n.getWorkflowDefinition(t,o).maxDelayMs;return d.isWorkflowReady(o,t)?(g.resultDescription=`Join Workflow: ${t.id} queuing by maxAnnotation, contextId: ${o}`,a.tG.info(528048978,a.nh.CoreDefault,g.stop()),{isValid:!0,triggerReason:le.JoinMaxAnnnotation}):l.startTime+i<e?(g.resultDescription=`Join Workflow: ${t.id} queuing by maxTimeout, contextId: ${o}`,a.tG.info(528048979,a.nh.CoreDefault,g.stop()),{isValid:!0,triggerReason:le.JoinMaxTimeout}):this.isReadyToEarlyJoin(this.executionTrackersByWorkflowNameBySession.get(n).get(t.id),o,n.getClientMetadata())?(a.tG.info(512550856,a.nh.CoreDefault,`Workflow: ${t.id} queuing by early completion, contextId: ${o}, timeout: ${i}`),{isValid:!0,triggerReason:le.JoinEarlyCompletion}):{isValid:!1,triggerReason:le.Unknown}}return{isValid:!0,triggerReason:le.Unknown}};(()=>{const{isValid:e,triggerReason:t}=h();if(!e)return!1;const[o,i]=n.resolveRequestedContexts(c);if(!o)return!1;try{if(c.kind===pe.wC.Join){const e=l.scopeItem.contextId,o=d.getScopeItem(e,c);if(o){const r=d.getItemsToExecute(o.contextId,c);if(0===r.length)return g.resultDescription=`Failed to retrieve items for workflow: ${c.id}, contextId: ${e}, skipping execution`,a.tG.info(527472291,a.nh.CoreDefault,g.stop()),this.onWorkflowExecuted(o,c,n),!0;this.queueWorkflow({workflowInfo:l.workflowImplementation,scopeItem:o,inputItems:r,requestedContexts:i,session:n,orchestrationMode:u,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,o,c,n)}).catch((e=>{g.success=!1,g.resultDescription=e.message,a.tG.error(509092189,a.nh.CoreDefault,g.stop())}))}else g.resultDescription="ContextId no longer exists, skipping workflow execution",a.tG.info(539883076,a.nh.CoreDefault,g.stop())}else g.resultDescription=`Workflow in type ${c.kind} is not supported`,a.tG.error(539883077,a.nh.CoreDefault,g.stop())}catch(e){g.resultDescription=`Trying to execute ${c.id} caused an exception: ${e}`,a.tG.warn(539883078,a.nh.CoreDefault,g.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(i).delete(r),0===this.pendingScopeExecutionNotificationsByWorkflow.get(i).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(i)):o.delete(n)}if(0!==o.size)for(const e of Array.from(o)){const t=new s.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();a.tG.debug(539883079,a.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,o){const i={id:"",parentPath:[],contextId:e},n={id:t};this.onWorkflowExecuted(i,n,o,!1)}onWorkflowExecuted(e,t,o,i=!0){var n;null===(n=this.executionTrackersByWorkflowNameBySession.get(o).get(t.id))||void 0===n||n.afterWorkflowExecution(e.contextId),i&&t.kind===pe.wC.Join&&o.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}var Ie=o(25942),Ee=o(76577);class Ae{constructor(e,t,o){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new Ie.Z,this.unorderedAnnotationResultsProcessor=null!=o?o:new Ee._}process(e,t,o,i){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,o,i):this.unorderedAnnotationResultsProcessor.process(e,t,o,i)}}var Be=o(54758),Re=o(1401),Me=o(42534),De=o(4325);class Pe{constructor(e){this.hostCallbacks=e}isFeatureEnabled(e,t=!1,o="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,o).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){return this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled?this.hostCallbacks.isChangeGateEnabled(e):Promise.resolve(!1)}}class Ne{constructor(e,t,o){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,checkIdbByFeatures:!0,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,httpFallbackEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,dynamicRateControllerEnabled:!1,removeDuplicateFlights:!0,delayBeforeSocketClose:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,startQueueProcessingInOpen:!0},this.isDownloaderCompatible=()=>{if(this.settings.checkIdbByFeatures)return"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL;if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;return!(!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0)}return!1},this.workerFactory=e||(e=>e&&e===Z.y.HttpFallback?new De.Z:new f);const i=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||i(...e),this.sessionFactory=o||(e=>new ee.po(e))}init(e,t,i,n){var l,u,h,p,f,m,v,y,b,S;const C=new s.I({operationName:"InitRuntime",resourceId:d(e),dimension1:this.hasBeenInitialized.toString()});C.start(),this.hasBeenInitialized=!0,this.hostCallbacks=i,this.gateUtils=new Pe(this.hostCallbacks),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=o(67278).r),this.telemetryLogger=new g(this.hostCallbacks),this.shouldAddLogger(C)?(a.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(n)):(a.tG.clearLoggers(),a.tG.addLogger(this.telemetryLogger)),Ne.haveCalledInit=!0,this.annotationResultsProcessor=new Ae((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=n.inferenceServiceFactory,C.dimension2=(0,a.OD)(r.q.info).toString();const w=[];e&&(this.defaultServiceUrl=B.Aq.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),w.push(B.Aq.isChangeGateEnabled(this.hostCallbacks,"CheckIdbByFeatures").then((e=>{this.settings.checkIdbByFeatures=e}))),w.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),w.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),w.push(this.isFeatureEnabled("HttpFallbackEnabled").then((e=>{var t;(t=this.settings).httpFallbackEnabled||(t.httpFallbackEnabled=e)}))),w.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),w.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),w.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),w.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),w.push(this.isFeatureEnabled("DynamicRateControllerEnabled").then((e=>{this.settings.dynamicRateControllerEnabled=e}))),w.push(B.Aq.isChangeGateEnabled(this.hostCallbacks,"DelayBeforeSocketClose").then((e=>{this.settings.delayBeforeSocketClose=e}))),w.push(B.Aq.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),w.push(B.Aq.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),w.push(B.Aq.isChangeGateEnabled(this.hostCallbacks,"StartQueueProcessingInOpen").then((e=>{var t;(t=this.settings).startQueueProcessingInOpen||(t.startQueueProcessingInOpen=e)})));const k={enableDeltas:!1,enableEarlyJoin:!1};w.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>k.enableDeltas=e)).catch((()=>k.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>k.enableEarlyJoin=e)).catch((()=>k.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new _e(n.modelDownloader&&this.isDownloaderCompatible()?n.modelDownloader:void 0,this.inferenceServiceFactory,k)})));const T=(0,Me.Vh)(null!==(l=t.flights)&&void 0!==l?l:"");var x;return this.isDeltaGeneratorEnabled=T.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(u=n.isDeltaGeneratorEnabled)&&void 0!==u&&u),this.disableSyncDeltaSending=T.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(h=n.disableSyncDeltaSending)&&void 0!==h&&h),this.syncDeltaTimeout=T.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",n.syncDeltaTimeout),(p=this.settings).httpFallbackEnabled||(p.httpFallbackEnabled=T.getBooleanValue("HttpFallbackEnabled",!1)),(f=this.settings).defaultBatchingEnabled&&(f.defaultBatchingEnabled=!T.getBooleanValue("DefaultBatchingDisabled",!1)),(m=this.settings).batchingWith20msIntervalEnabled&&(m.batchingWith20msIntervalEnabled=!T.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(v=this.settings).reduceBatchOperationsEnabled||(v.reduceBatchOperationsEnabled=T.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(y=this.settings).batchMessagesEnabled||(y.batchMessagesEnabled=T.getBooleanValue("BatchMessagesEnabled",!1)),(b=this.settings).removeDuplicateFlights&&(b.removeDuplicateFlights=T.getBooleanValue("RemoveDuplicateFlights",!0)),(S=this.settings).reducedPingPongRetryEnabled||(S.reducedPingPongRetryEnabled=T.getBooleanValue("ReducedPingPongRetryEnabled",!1)),C.setDataField("Flights",JSON.stringify(this.settings)),n&&n.loggableUrls&&(x=n.loggableUrls,c.push(...x)),Promise.all(w).then((()=>{this.batchOptions=n.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),n&&n.networkMode&&(n.networkMode===Z.y.HttpFallback&&(n.networkMode=this.settings.httpFallbackEnabled?Z.y.HttpFallback:Z.y.JSWebSockets),this.networkMode=n.networkMode,n.networkMode===Z.y.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new Be.t)),C.dimension0=JSON.stringify(this.batchOptions),this.logOperation(C,!0)})).catch((e=>{this.logOperation(C,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){a.tG.flushAggregators(e)}createSession(e){var t;const o=e&&e.docSessionId?e.docSessionId:(0,Re.v4)(),i=e&&e.documentId?e.documentId:void 0,n=this.sessionsByDocSessionId.get(o),r=new s.I({operationName:"CreateSession",resourceId:o,dimension1:this.hasBeenInitialized.toString()});if(r.start(),n&&!1===n.isClosed)throw this.logOperation(r,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let a=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;a=B.Aq.convertServiceUrlToWebSocket(a),a||((e=e||{}).networkMode=Z.y.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==Z.y.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=Z.y.HttpFallback),e&&e.networkMode===Z.y.HttpFallback&&(e.networkMode=this.settings.httpFallbackEnabled?Z.y.HttpFallback:Z.y.JSWebSockets);const l=Object.assign({},this.clientMetadata);l.docSessionId=o,i&&(l.documentId=i),e&&e.flights&&(l.flights=l.flights?l.flights+";"+e.flights:e.flights),this.settings.removeDuplicateFlights&&l.flights&&(l.flights=(0,Me.JU)(l.flights)),r.setDataField("Flights",l.flights||"");const c=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(l,a,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:l,userContext:e?e.userContext:void 0,localWorkflowManager:e&&e.enableComplexLocalWorkflows?void 0:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService});return this.sessionsByDocSessionId.set(o,c),e&&e.onSessionConnect&&c.setConnectCallback(e.onSessionConnect),e&&e.onSessionDisconnect&&c.setDisconnectCallback(e.onSessionDisconnect),e&&e.onSessionReconnect&&c.setReconnectCallback(e.onSessionReconnect),e&&e.onSessionClose&&c.setSessionCloseCallback(e.onSessionClose),e&&e.onServerAuthenticationStateChangeCallback&&c.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e&&e.onClaimsChallengeCallback&&c.setClaimsChallengeCallback(e.onClaimsChallengeCallback),this.logOperation(r,!0),c.initialize?c.initialize():Promise.resolve(c)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(Ne.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,a.OD)(r.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,o)=>{if(o&&o.enableComplexLocalWorkflows)throw new Error("NYI");if(o&&o.networkMode==Z.y.LocalWorkflowsOnly)return new Be.t;const i=new se,n=new te;let r=()=>{a.tG.error(573321615,a.nh.CoreDefault,"Unexpectedly not set sendMessage")};const s=new ae((()=>n),e,i,((e,t,o)=>{r(e,t,o)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==o?void 0:o.enableRemoteExecutionNotification)||!1}),l=new X(B.Aq.convertServiceUrlToWebSocket(t),n,this.workerFactory,s,e,i,this.settings,this.gateUtils,null==o?void 0:o.networkMode);return r=l.sendMessage.bind(l),l.on("disconnect",(()=>i.clearRefreshTimeouts())),l.on("connect",((e,t,o,i)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,o,i);const n=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(n)})),l}}isFeatureEnabled(e,t=!1,o="None"){return B.Aq.isFeatureEnabled(this.hostCallbacks,e,t,o)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,o,i){e.stop(),e.success=t,e.resultSignature=o,e.resultDescription=i,a.tG.info(573321622,a.nh.CoreDefault,e)}addLoggingAggregator(e){var t,o,i,n;B.Aq.isChangeGateEnabled(this.hostCallbacks,"AggregateInProductionOnly")&&"Dogfood"===this.clientMetadata.releaseAudienceGroup||(a.tG.addAggregator(u("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet","NetworkRateControllerQueueItem"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),a.tG.addAggregator(u("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:60)),a.tG.addAggregator(u("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(i=e.telemetryAggregationIntervalSec)&&void 0!==i?i:120)),a.tG.addAggregator(u("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)))}uninitialize(){this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,Ne.haveCalledInit=!1,a.tG.clearAggregators(),a.tG.clearLoggers()}}new Ne;const Fe=()=>new Ne},76640:(e,t,o)=>{"use strict";if(o.d(t,{VI:()=>q,po:()=>W,vd:()=>j}),3023==o.j)var i=o(64399);if(3023==o.j)var n=o(85964);if(3023==o.j)var r=o(96657);if(3023==o.j)var s=o(80500);if(3023==o.j)var a=o(73789);if(3023==o.j)var l=o(69689);if(3023==o.j)var c=o(99564);if(3023==o.j)var u=o(22461);if(3023==o.j)var d=o(7727);if(3023==o.j)var g=o(86066);if(3023==o.j)var h=o(64843);if(3023==o.j)var p=o(90580);if(3023==o.j)var f=o(12643);if(3023==o.j)var m=o(62672);if(3023==o.j)var v=o(9798);if(3023==o.j)var y=o(73165);if(3023==o.j)var b=o(81787);if(3023==o.j)var S=o(23774);if(3023==o.j)var C=o(74498);if(3023==o.j)var w=o(66061);if(3023==o.j)var k=o(74066);if(3023==o.j)var T=o(48490);if(3023==o.j)var x=o(42979);if(3023==o.j)var _=o(3843);if(3023==o.j)var I=o(38215);if(3023==o.j)var E=o(1653);if(3023==o.j)var A=o(49936);if(3023==o.j)var B=o(44298);if(3023==o.j)var R=o(33674);if(3023==o.j)var M=o(28677);if(3023==o.j)var D=o(31987);if(3023==o.j)var P=o(1401);if(3023==o.j)var N=o(27821);if(3023==o.j)var F=o(53134);if(3023==o.j)var O=o(54758);var j,q,L=function(e){return this instanceof L?(this.v=e,this):new L(e)};!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(j||(j={})),function(e){e[e.Internal=0]="Internal",e[e.External=1]="External"}(q||(q={}));const H=(e,t)=>{t?(e.resultDescription=t,e.success=!1,b.tG.error(509203144,b.nh.CoreDefault,e.stop())):b.tG.info(509203143,b.nh.CoreDefault,e.stop())},z=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class W{constructor(e){var t;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=i.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new T.Q$,this.workflowDefinitionManager=new x.h,this.contextIdManager=new _.a4(A.x.JsClient,this.workflowGraph),this.workflowItemStorage=new I.e(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.batchMessagesEnabled=!1,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,e.workflowRuntimeFactory&&(this.workflowRuntime=e.workflowRuntimeFactory(this.sessionManager)),this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(n.B_.getTypeName(),this.workflowRuntime?this.onAnnotationResultsFromLocal.bind(this):this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(n.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(n.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(n.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new S.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===T.aZ.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,b.tG.info(508879493,b.nh.CoreDefault,e.stop())}}initialize(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress).then((()=>(this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this)))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length){if(this.workflowRuntime)for(const t of e)this.workflowRuntime.registerWorkflow(t),this.sendMessageToSession(new s.Et({workflowDefinition:t}));if(this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new S.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();H(t)}activateAnnotation(e,t,o){var i;const n=new p.g(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),r=(t,o)=>{let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n.token,o)};(null==t?void 0:t.callback)&&r(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&r(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const s=null!==(i=this.tokensByAnnotationType.get(e))&&void 0!==i?i:[];return-1===s.indexOf(n.token)&&s.push(n.token),this.tokensByAnnotationType.set(e,s),this.annotationActivationTrackers.set(n.token,n),this.activateAnnotationForTracker(n,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateAnnotationForTracker(e,t){const o=new S.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((i=>(o.resultSignature="Ok",o.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,H(o),i))).catch((i=>{throw H(o,`error on activate annotation type ${e.annotationType}: ${i}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),i}))}updateAnnotationConfig(e,t){const o=new n.Ol({token:e,config:t});this.sendMessageToSession(o);const i=this.annotationActivationTrackers.get(e);i&&i.options&&(i.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const o=o=>{const i=o.get(t.annotationType);i&&(i.delete(e),0==i.size&&o.delete(t.annotationType))};return o(this.annotationCallbacks),o(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,o){const i={state:o};this.submitOperation(new l.XP({parentPath:e,items:[{id:t}],M_:i}))}setAnnotationMetadata(e,t,o){this.submitOperation(new l.XP({parentPath:e,items:[{id:t}],M_:o}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var o,i;if(t||(t=this.generateCorrelationId()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[o,i]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,t)}const n=e.filter(this.filterOperationsForSession.bind(this)).filter(z);if(this.workflowRuntime){if(this.onAnnotationsSubmittedEnabled){const[e,o]=this.partitionAnnotationOperations(n);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(o,t)}else this.submitOperationsToSession(n,t);return}const r=[];if(this.deltaGenerator){const e=new S.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of n)if(l.fZ.typeGuard(e))r.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const n of t.items)l.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(n,t.parentPath):l.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(n,t.parentPath):l.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(i=null===(o=e.items)||void 0===o?void 0:o.map((e=>e.id)))&&void 0!==i?i:[]);r.push(e)}H(e)}if(this.onAnnotationsSubmittedEnabled){const[e,o]=this.partitionAnnotationOperations(r.length?r:n);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(o,t)}else this.submitOperationsToSession(r.length?r:n,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===a.y.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[o,i]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,t):this.executeCallbacksOnAnnotationSubmitted(o,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?i:e,!0,t):this.sendMessageToSession(new n.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?i:e}))}submitSeedGroupOperations(e,t,o){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===a.y.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);o||(o=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[i,r]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(i,o),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(i,o):this.executeCallbacksOnAnnotationSubmitted(i,o),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?r:e,!!t,o):(this.seedGroupSize++,this.sendMessageToSession(new n.Tb({cv:o,seq:0,ops:this.onAnnotationsSubmittedEnabled?r:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,o)=>{this.sendMessageToSession(e,((i,n)=>{i?o(new Error(`${i.error}; for message type: ${c.h.getTypeNameFor(e)}`)):t(n)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,o)=>{this.sendMessageToSessionPostEndpoint(e,((e,i)=>{e?o(new Error(e.error)):t(i)}))}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==u.J1.None?new Promise(((t,o)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,i)=>{e?o(e):t(i)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new n.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.workflowRuntime&&this.workflowRuntime.close(),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(){return e=this,t=void 0,i=function*(){if(this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const e=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(n.D0.typeGuard(e))throw new Error(e.reason)},new((o=void 0)||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}));var e,t,o,i}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new O.t}onAnnotationResults(e,t,o){b.tG.info(508916486,b.nh.CoreDefault,new S.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),o(void 0,new n.YK),t===j.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,o)=>{this.applyOperationForContext(e,o,t)}),((t,o)=>{this.triggerRegisteredAnnotationCallbacks(t,e.annotationType,o,e.areApologies)}),(e=>{if(t!==j.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(z);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var o;t(void 0,new n.YK);for(const t of e.updates){const{annotationType:e,state:i}=t;if(!this.tokensByAnnotationType.has(e))continue;let n;n=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):i===r.K7.Idle?r.K7.Pending:r.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(o=e.options)||void 0===o?void 0:o.stateUpdateCallback)&&e.options.stateUpdateCallback(n,i)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const o=e.filter((e=>l.g0.typeGuard(e))),i=e.filter((e=>!l.g0.typeGuard(e)));if(o.length>0&&this.sendMessageToSession(new n.Tb({cv:t,ops:o})),i.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,o)=>{if(e.length){const t=new n.l0;t.messages=[],e.forEach((e=>{t.messages.push(new n.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{o(e?new Error(e.error):void 0)}))}}:(e,t,o)=>{this.sendMessageToSession(new n.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{o(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new f.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled)}this.batchedOperationsManager.addBatchItem(i,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new n.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:i}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),n.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const o=new S.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,F.A)(this.connectParams,e,o,t);else{const i=(i=>(0,F.A)(i,e,o,t)).bind(this);this.pendingConnectCallbacks.push(i)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const o=new S.I({operationName:"RequestBinaryData",success:!0,cv:(new C.W).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,F.Z)(this.connectParams,e,t,o);else{const i=(i=>(0,F.Z)(i,e,t,o)).bind(this);this.pendingConnectCallbacks.push(i)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,o){let i=c.h.getTypeNameFor(e);if(i!=l.Xr.getTypeName()&&i!=l.I.getTypeName()&&i!=l.fZ.getTypeName()&&i!=l.n4.getTypeName())return;i==l.I.getTypeName()&&(i=l.Xr.getTypeName());const n=(0,k.CY)(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),r=(0,k.M6)(n.parentPath);if(i==l.Xr.getTypeName()||i==l.fZ.getTypeName()){if(!n.body)return;const e=c.h.getTypeNameFor(n.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let s=t.get(o);if(s||(s=[],t.set(o,s)),!n.id){if(this.workflowRuntime)throw new Error("Expected item to have id already");this.localWorkflowManager&&(n.id=this.localWorkflowManager.getNextClientAnnotationId())}if(i==l.Xr.getTypeName())0==s.filter((e=>(0,k.M6)(e.parentPath)==r&&e.id==n.id)).length?s.push(n):b.tG.info(540848911,b.nh.CoreDefault,`AddOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<s.length;e++)if(s[e].id==n.id&&(0,k.M6)(s[e].parentPath)==r){if(s[e].source==n.source){s[e]=n;break}b.tG.warn(540848912,b.nh.CoreDefault,`UpdateOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with provided path and ID has different source: ${s[e].source}`)}else b.tG.warn(540848913,b.nh.CoreDefault,`UpdateOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(i==l.n4.getTypeName()){if(!n.id)return;this.availableContexts.forEach(((e,t)=>{let i=e.get(o);i&&(i=i.filter((e=>!((0,k.M6)(e.parentPath)==r&&e.id==n.id))),0==i.length?e.delete(o):e.set(o,i),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const o of e)if(_.gu.has(c.h.getTypeNameFor(o)))for(const e of o.items)for(const o of t||[])this.localWorkflowManager.preProcessItemToWorkflow(o,e,this)}}resolveRequestedContexts(e){const t=[];for(const[o,i,n]of(0,w.v)(e.requestedContextTypesRules)){if(!this.availableContexts.has(o)){if(i==v.in.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(o).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${o} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,o)=>o.findIndex((t=>y.Aq.deepEquals(t,e)))===t))}getContextAnnotations(e,t,o,i){var n,r;const s=o?(0,k.M6)(o):void 0;return null===(r=null===(n=this.availableContexts.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.filter((e=>!(s&&(0,k.M6)(e.parentPath)!=s||i&&e.source!=i)))}onWorkflowDefinitionOverrideMessage(e){const t=new S.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),o=e=>{throw H(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void o("Not supported by this local SessionProxy instance.");const i=this.localWorkflowManager.getWorkflowDefinitionsByName(this),n=i.get(e.sourceWorkflowId);if(!n)return void o(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=n.id;const r=i.get(e.targetWorkflowId);r&&(r.allowDefinitionOverride?n.definitionOverrideTargetWorkflows&&-1!==n.definitionOverrideTargetWorkflows.indexOf(r.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(r,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,H(t)):o(`Workflow '${n.id}' does not allow workflow definition for workflow '${r.id}'.`):o(`Workflow '${r.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,o,i){if(this.callAnnotationCallbacks(e,t,o,i),this.hostCallbacks.onAnnotationResult)try{i?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,o):this.hostCallbacks.onAnnotationResult(e,o)}catch(e){b.tG.error(540301151,b.nh.CoreDefault,new S.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new n.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new B.U,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,o;const i=[];b.tG.info(523776396,b.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(o=e.items)||void 0===o?void 0:o.length)>0?e.items[0].id:"(no items)"})`);let n=[...e.parentPath];for(const t of e.items){const o=[],r=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==r?void 0:r.length){for(const i of r){const r=(0,P.v4)();n=[...e.parentPath,t.id];const s={id:r,revId:t.revId,body:i,contextId:t.contextId,source:t.source};o.push(s)}o.length>0&&(i.push(new l.xU({parentPath:n,items:o})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,n,o))}else b.tG.info(523329632,b.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return i}setupSyncDeltaAfterDelay(e,t,o){var i,n,r;const s=this.syncDeltaTimers.get(e.id);s&&(clearTimeout(s),this.syncDeltaTimers.delete(e.id));const a=o.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===R.OD.Chars}));if(a){const o=a.body,s={content:"",deltaType:R.WI.Update,length:0,position:(null!==(i=null==o?void 0:o.position)&&void 0!==i?i:0)+(null!==(r=null===(n=null==o?void 0:o.content)||void 0===n?void 0:n.length)&&void 0!==r?r:0),unit:R.OD.Sentence},c=M.Cg.typeGuard(e.body)?new D.s(s):new D.Q(s),u={id:(0,P.v4)(),revId:e.revId,body:c,contextId:e.contextId,source:e.source},d=new l.xU({parentPath:t,items:[u]}),g=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,d,e.id);this.syncDeltaTimers.set(e.id,g)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow((0,E._$)(e))}getAnnotations(e,t){var o,i,n;const a=new S.I({operationName:"GetAnnotations",success:!0,dimension1:null===(o=e.annotationType)||void 0===o?void 0:o.toString(),dimension2:null===(i=e.maxDelayMs)||void 0===i?void 0:i.toString(),cv:e.cv}).setClientMetadata(this.clientMetadata).start(),l=this.sessionManager.getCorrelationVector(),c=new s.x5({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:null!==(n=e.cv)&&void 0!==n?n:l.newChild().toString()}}),u=[];let d;this.sendMessageToSession(c,((e,t)=>{u.push({error:e,response:t}),null==d||d(!0)}));const g=this;let h=!1;return{[Symbol.asyncIterator](){var e,o,i,n;return function(e,t,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=o.apply(e,t||[]),r=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise((function(o,i){r.push([e,t,o,i])>1||a(e,t)}))})}function a(e,t){try{(o=n[e](t)).value instanceof L?Promise.resolve(o.value.v).then(l,c):u(r[0][2],o)}catch(e){u(r[0][3],e)}var o}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function*(){for(;!h;)try{0===u.length&&(yield L(new Promise((e=>d=e))));const s=u.shift();if(t&&t.IsCancellationRequested){a.dimension0=`Error code: ${r.zy.RequestCancelled}`,H(a,"Request cancelled"),yield yield L({content:void 0,error:{clientError:{code:r.zy.RequestCancelled,error:"Request cancelled"}}}),h=!0;break}h=(null===(e=s.response)||void 0===e?void 0:e.finalResponse)||void 0!==s.error,a.dimension3=`final response: ${h}`;let l=!1;s.error?(a.dimension0=`Error code: ${s.error.code}`,H(a,s.error.error),l=!0):(null===(o=s.response)||void 0===o?void 0:o.errorInfo)?(a.dimension0=`Error code: ${s.response.errorInfo}`,H(a,"Workflow execution error"),l=!0):(a.resultDescription="OK",H(a)),yield yield L({content:null===(i=s.response)||void 0===i?void 0:i.content,error:l?{workflowError:null===(n=s.response)||void 0===n?void 0:n.errorInfo,serverError:s.error?{code:s.error.code,error:s.error.error,retryable:null==g?void 0:g.canBeRetried(s.error)}:void 0}:void 0})}catch(e){a.dimension0=`Error code: ${r.zy.Unknown}`,H(a,null==e?void 0:e.message),yield yield L({content:void 0,error:{clientError:{code:r.zy.Unknown,error:null==e?void 0:e.message}}}),h=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==a.y.JSWebSockets||e.getNetworkMode()!==a.y.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===r.xv.TooManyRequests||(null==e?void 0:e.code)===r.xv.RequestTimeout}getAuthToken(e,t){const o={Tickets:[]};this.clientMetadata.docSessionId&&(o.DocSessionId=this.clientMetadata.docSessionId);const i=(e=>{if(e===m.OY.Substrate)return h.OY.Substrate})(e);i&&(o.TokenType=i),this.hostCallbacks.requestAuthToken(o).then((o=>{var i;if(!o)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!o.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,o.Token,{returnedTokenType:e,timeToLiveSec:null===(i=o.TokenProperties)||void 0===i?void 0:i.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,o)=>{t(e)}))}onConnect(e,t,o,i,n,r){this.hasSessionConnected?e&&(this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})):this.enableRemoteExecutionNotification&&this.addDownstreamWorkflowsIntoClientGraph(r),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:o,authToken:i},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((n,r)=>{n(e,t,o,i)})),this.serverInputTypes=n}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,o)=>{t(e)}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==i.f.Authenticated&&e==i.f.Pending)return;this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,o,i){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const n=i?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);n&&n.forEach((t=>{t(e,o)}))}getOperationBatchConfig(e){let t;return t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]}),{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:N.E,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,o){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,o)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const i=new n.l0;i.messages=[],e.forEach((e=>{i.messages.push(new n.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(i,(e=>{o(e?new Error(e.error):void 0)}))}}:(e,t,o)=>{this.seedGroupSize++,this.sendMessageToSession(new n.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{o(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new f.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},o,t)}onAnnotationResultsFromServer(e,t){this.onAnnotationResults(e,j.ServerWorkflow,t)}onAnnotationResultsFromLocal(e,t){this.onAnnotationResults(e,j.LocalWorkflow,t)}getLocalRegisteredWorkflows(){return this.workflowRuntime?this.workflowRuntime.getRegisteredWorkflows():this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>(0,E._$)(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new S.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),o=new n.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(o,((o,i)=>{o?H(t,o.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${i.downstreamRuntimeWorkflows.map((e=>e.id))}`,H(t),this.onWorkflowGraphInitResponse(i))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.workflowRuntime||this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(b.tG.info(540848914,b.nh.CoreDefault,`Replacing user context placeholder for: ${(0,k.M6)(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(b.tG.info(540848915,b.nh.CoreDefault,`Replacing tenant context placeholder for: ${(0,k.M6)(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return!!this.workflowRuntime||(0,y.zX)(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:o,apologyOpsMap:i}=this.getAnnotationOperationsByType(e);o.forEach(((e,o)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,o,t,!1)))})),i.forEach(((e,o)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,o,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],o)=>o.items.some((e=>e.body&&d.YH.typeGuard(e.body)))?[[...e,o],t]:[e,[...t,o]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:o,apologyOpsMap:i}=this.getAnnotationOperationsByType(e);o.forEach(((e,o)=>{const i=Array.from(e);this.onAnnotationResults(new n.B_({annotationType:o,ops:i,cv:t,areApologies:!1}),j.Submitted,(()=>{}))})),i.forEach(((e,o)=>{const i=Array.from(e);this.onAnnotationResults(new n.B_({annotationType:o,ops:i,cv:t,areApologies:!0}),j.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,o=new Map;for(const i of e)for(const e of i.items)if(e.body&&d.YH.typeGuard(e.body)){const n=(e,t)=>{const o=e.get(t)||new Set;o.add(i),e.set(t,o)};g.k$.typeGuard(e.body)?n(o,e.body.annotationTypeName):n(t,c.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:o}}onClaimsChallengeMessage(e,t){e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0}));for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge);t(void 0,new n.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e,t){if(e||!t)return;const o=t.tokenType&&t.tokenType==m.OY.WacUserInfo?i.f.WacUserInfoAuthenticated:i.f.Authenticated;this.onServerAuthenticationStateChange(o)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var o;const i=new S.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(o=null==t?void 0:t.interactive)&&void 0!==o&&o}`}).start();i.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const r={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:h.OY.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(r).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return i.resultSignature="Token",new n.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(i.resultSignature="NoToken",i.dimension2=t.message,new n.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,o)=>{this.sendMessageToSession(e,((r,s)=>{H(i,null==r?void 0:r.error),this.onTokenProvisionResponse(r,s),r?o(new Error(r.error)):(n.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1),t(e))}))}))))}}},73165:(e,t,o)=>{"use strict";o.d(t,{yq:()=>h,Aq:()=>g,ZF:()=>p,zX:()=>f});var i,n=o(81787),r=o(23774);!function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(i||(i={}));var s=o(99564),a=o(7727),l=o(34516),c=o(69689),u=o(26394),d=o.n(u);class g{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:i.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,o=!1,i="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,i).catch((()=>Promise.resolve(o))):Promise.resolve(o)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const o=e.split(":");let i=o[0].toLowerCase();return 0==i.indexOf(t?"http":"ws")?(i=t?i.replace("http","ws"):i.replace("ws","http"),o[0]=i,o.join(":")):e}static deepEquals(e,t){return d()(e,t)}static collectTelemetry(e,t,o,i,r,s){var a,l,c,u;e.start(),e.resultSignature=null!=i?i:"",e.resultDescription=null!=r?r:"",e.success=o,s?(e.dimension0=null!==(a=s[0])&&void 0!==a?a:"",e.dimension1=null!==(l=s[1])&&void 0!==l?l:"",e.dimension2=null!==(c=s[2])&&void 0!==c?c:"",e.dimension3=null!==(u=s[3])&&void 0!==u?u:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>n.tG.info(508367457,n.nh.CoreDefault,e.stop())))}}g.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class h{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new r.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});n.tG.warn(572838107,n.nh.CoreDefault,e)}}}s.h.getTypeName(),a.YH.getTypeName(),l.HN.getTypeName();const p=(e,t=0)=>Number.isFinite(e)?e:t,f=(e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(c.xU.typeGuard(e)||c.XP.typeGuard(e))return!0;for(const o of e.items)if(!o.body||s.h.matchesTypesFor(o.body,t))return!0;return!1}},76e3:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(74066);if(3023==o.j)var n=o(99564);class r{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=(0,i.M6)(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class s{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&n.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&n.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new r(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}},50562:(e,t,o)=>{"use strict";var i;o.d(t,{MY:()=>g}),o(37827),function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(i||(i={}));var n=o(47174);class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()},o(26394);const d=[n.h.getTypeName(),r.getTypeName(),l.getTypeName()],g=e=>{const t=new Set;for(const o of e)if("string"==typeof o)-1===d.indexOf(o)&&t.add(o);else for(const e of[o.getTypeName(),...o.getBaseTypes()])-1===d.indexOf(e)&&t.add(e);return Array.from(t)}},78851:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>r}),3023==o.j)var i=o(36273);if(3023==o.j)var n=o(50562);class r{constructor(e,t){var o,n,r,s,a;this.kind=i.wC.Join,this.isStateful=!1,this.maxDelayMs=1e3,this.maxAnnotations=1,this.allowDefinitionOverride=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.maxDelayMs=null!==(s=t.maxDelayMs)&&void 0!==s?s:this.maxDelayMs,this.requestedContextTypesRules=null!==(a=t.requestedContextTypesRules)&&void 0!==a?a:this.requestedContextTypesRules)}static create(e){return new r(e)}setCollectionScopeType(e){return this.collectionScopeType=e,this}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setMaxDelayTime(e){return this.maxDelayMs=e?Math.max(0,e):void 0,this}setMaxAnnotations(e){return this.maxAnnotations=e,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setAllowDefinitionOverride(){return this.allowDefinitionOverride=!0,this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},84563:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>r}),3023==o.j)var i=o(36273);if(3023==o.j)var n=o(50562);class r{constructor(e,t){var o,n,r,s,a,l;this.kind=i.wC.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.requestedContextTypesRules=null!==(s=t.requestedContextTypesRules)&&void 0!==s?s:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(a=t.definitionOverrideTargetWorkflows)&&void 0!==a?a:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(l=t.correlatedSignals)||void 0===l?void 0:l.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new r(e)}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},49936:(e,t,o)=>{"use strict";var i;o.d(t,{x:()=>i}),function(e){e.JsClient="C",e.Server="S"}(i||(i={}))},64843:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OY:()=>n,Pu:()=>r}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(i||(i={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(r||(r={}))},63203:(e,t,o)=>{"use strict";var i,n;o.d(t,{K:()=>n}),function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(n||(n={}))},77972:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OY:()=>n}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(i||(i={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(r||(r={}))},74066:(e,t,o)=>{"use strict";o.d(t,{CY:()=>n,M6:()=>r});const i="\\",n=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),r=e=>Array.isArray(e)?5===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}${i}${e[3]}${i}${e[4]}`:4===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}${i}${e[3]}`:3===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}`:2===e.length?`${e[0]}${i}${e[1]}`:1===e.length?e[0]:e.join(i):"(malformed path)"},80500:(e,t,o)=>{"use strict";o.d(t,{Et:()=>n,Qr:()=>g,x5:()=>h});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},73789:(e,t,o)=>{"use strict";var i;o.d(t,{y:()=>i}),function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(i||(i={}))},64399:(e,t,o)=>{"use strict";var i;o.d(t,{f:()=>i}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(i||(i={}))},85964:(e,t,o)=>{"use strict";o.d(t,{$j:()=>x,B_:()=>N,D0:()=>O,F_:()=>g,GA:()=>_,Gs:()=>z,LQ:()=>m,Ol:()=>E,PY:()=>T,Sy:()=>ee,TV:()=>L,Tb:()=>R,VR:()=>M,YK:()=>r,Yp:()=>a,Zy:()=>y,_p:()=>d,eE:()=>p,fZ:()=>D,i:()=>s,kd:()=>F,l0:()=>B,n4:()=>k,ru:()=>h,ry:()=>v,uN:()=>f,w9:()=>S,z_:()=>C});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class S{constructor(e){i.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class C{constructor(e){i.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class w{constructor(e){i.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class k{constructor(e){i.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class T{constructor(e){i.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class x{constructor(e){i.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class _{constructor(e){i.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class I{constructor(e){i.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class E{constructor(e){i.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class A{constructor(e){i.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class B{constructor(e){i.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class R{constructor(e){i.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class M{constructor(e){i.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class D{constructor(e){i.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){i.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class N{constructor(e){i.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class F{constructor(e){i.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class O{constructor(e){i.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class j{constructor(e){i.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class q{constructor(e){i.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class L{constructor(e){i.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class H{constructor(e){i.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class z{constructor(e){i.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class W{constructor(e){i.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class G{constructor(e){i.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class U{constructor(e){i.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class V{constructor(e){i.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class ${constructor(e){i.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class K{constructor(e){i.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class J{constructor(e){i.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Z{constructor(e){i.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class Y{constructor(e){i.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class Q{constructor(e){i.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class X{constructor(e){i.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{constructor(e){i.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()}},96657:(e,t,o)=>{"use strict";o.d(t,{K7:()=>c,PO:()=>a,mH:()=>i,xv:()=>s,zy:()=>r});const i=2;var n,r,s,a,l,c;!function(e){e[e.WorkflowDisabled=0]="WorkflowDisabled",e[e.TokenNotReady=1]="TokenNotReady",e[e.FlightNotReady=2]="FlightNotReady",e[e.ContextNotReady=3]="ContextNotReady",e[e.WorkflowExcluded=4]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=5]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=6]="LambdaExecutionError",e[e.UnexpectedOutput=7]="UnexpectedOutput"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(s||(s={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(a||(a={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(l||(l={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(c||(c={}))},50676:(e,t,o)=>{"use strict";o.d(t,{I:()=>c});var i=o(26394),n=o.n(i),r=o(81787);class s{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}class a extends s{constructor(e){super(),this.name=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new a(e);const o=a.tryGetConfigProperty(a.currentConfig,e);o.success&&t.updateValue(o.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new a(e)};const o=a.tryGetConfigPropertyByPattern(a.currentConfig,t.regex);t.setting.updateValue(o),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){a.currentConfig=e,r.tG.info(572837966,r.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),a.allSettings.forEach(((e,t)=>{const o=a.tryGetConfigProperty(a.currentConfig,t).value;e.updateValue(o)&&(r.tG.info(572837967,r.nh.CoreDefault,`Setting new value for ${t}: ${o instanceof Object?JSON.stringify(o):o}`),e.notifyListeners(o))})),a.allPatternSettings.forEach(((t,o)=>{const i=a.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(i)&&(r.tG.info(508432774,r.nh.CoreDefault,`Setting new value for pattern ${o}: ${JSON.stringify(i)}`),t.setting.notifyListeners(i))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:a.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const o=[];if(e){const i=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of i)o.push({name:t,value:a.selectApplicableValue(e[t])})}return o}static setGlobalFilter(e){a.globalFilter=e}static clear(){a.currentConfig=void 0,a.allSettings.clear(),a.allPatternSettings.clear()}static selectApplicableValue(e){let t;if(e){const o=e.find((e=>!a.globalFilter||a.globalFilter(e)));o&&(t=o.value)}return t}getName(){return this.name}getValue(){return this.value}updateValue(e){return!n()(this.value,e)&&(r.tG.info(572837968,r.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}}a.allSettings=new Map,a.allPatternSettings=new Map;const l=new class extends s{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=a.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}}("disabledChangeGates",[]),c=(e,t,...o)=>{const i=-1===l.getValue().indexOf(e);return t?i?t(...o):void 0:i}},62266:(e,t,o)=>{"use strict";o.d(t,{l:()=>i});class i{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){i.logIntervalError=e}put(e,t,o,i,n,r,s){if(null==o||o<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const a={value:t,lastUsed:n?Date.now():void 0,expire:o+Date.now(),idleDurationMs:n,expireCallback:i,expiringTriggerTime:r+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,o)=>{e(t.value,o)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,o)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(o),void(this.options.idleCallback&&this.options.idleCallback(o,t.value));t.expire<e&&(this.del(o),t.expireCallback&&t.expireCallback(o,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(o,t.value),t.expiringCallback=void 0)}catch(e){i.logIntervalError&&i.logIntervalError(e)}}))}}},44452:(e,t,o)=>{"use strict";o.d(t,{l:()=>i});class i{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){i.logIntervalError=e}put(e,t,o,i,n,r,s){if(null==o||o<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const a={value:t,lastUsed:n?Date.now():void 0,expire:o+Date.now(),idleDurationMs:n,expireCallback:i,expiringTriggerTime:r+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,o)=>{e(t.value,o)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,o)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(o),void(this.options.idleCallback&&this.options.idleCallback(o,t.value));t.expire<e&&(this.del(o),t.expireCallback&&t.expireCallback(o,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(o,t.value),t.expiringCallback=void 0)}catch(e){i.logIntervalError&&i.logIntervalError(e)}}))}}},92318:(e,t,o)=>{"use strict";var i;o.d(t,{r:()=>i}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(i||(i={}))},7727:(e,t,o)=>{"use strict";o.d(t,{YH:()=>n});var i=o(99564);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},86066:(e,t,o)=>{"use strict";o.d(t,{k$:()=>n});var i=o(99564);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},69689:(e,t,o)=>{"use strict";o.d(t,{I:()=>s,XP:()=>u,Xr:()=>l,fZ:()=>d,g0:()=>S,hW:()=>c,n4:()=>g,xU:()=>y});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class S{constructor(e){i.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()}},99564:(e,t,o)=>{"use strict";o.d(t,{h:()=>i});class i{constructor(e){i.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=i.getTypeNameFor(e);return t?[t,...i.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const o=i.getTypeNameFor(e),n=i.getBaseTypesFor(e);for(const e of t){if(e===o)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,o){if(o)for(const e of Object.keys(o))t[e]=o[e];return t.H_=e.H_,t}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},34516:(e,t,o)=>{"use strict";o.d(t,{HN:()=>n});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},55512:(e,t,o)=>{"use strict";o.d(t,{I3:()=>c,SB:()=>m,W1:()=>p,hD:()=>f,yo:()=>l});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},22461:(e,t,o)=>{"use strict";var i,n;o.d(t,{J1:()=>i}),function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token"}(i||(i={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(n||(n={}));class r{}r.lowerIndexBound=1,r.maxNumberOfRows=1048576,r.maxNumberOfColumns=16384,r.firstColumnName="A",r.lastColumnName="XFD"},58636:(e,t,o)=>{"use strict";o.d(t,{N0:()=>n,NC:()=>d,Xv:()=>r,Z8:()=>c,aD:()=>u,f4:()=>g,hl:()=>a,iU:()=>l,ub:()=>s});var i=o(87094);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentSuggestion"}static getBaseTypes(){return["AugLoop_SmartCompose_Suggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentPrefilterTriggered"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntent"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentHybrid"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_Prefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_FlagWithIntent"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_EntityPrediction"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},51887:(e,t,o)=>{"use strict";o.d(t,{A$:()=>s,R6:()=>n,aO:()=>r});var i=o(87094);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionSignal"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedRequestSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},14347:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{EntityPrediction:()=>n.f4,FlagWithIntent:()=>n.NC,GraphIntentDetectionBaseSignal:()=>r.R6,GraphIntentDetectionSignal:()=>r.aO,GraphIntentPrefilterTriggered:()=>n.Xv,GraphIntentSuggestion:()=>n.N0,IntentConfidenceLevel:()=>i.Z,IntentScope:()=>i.f,Prefetch:()=>n.aD,SystemInitiatedRequestSignalHybrid:()=>r.A$,SystemInitiatedWithIntent:()=>n.hl,SystemInitiatedWithIntentBase:()=>n.ub,SystemInitiatedWithIntentClient:()=>n.iU,SystemInitiatedWithIntentHybrid:()=>n.Z8}),3023==o.j)var i=o(2826);if(3023==o.j)var n=o(58636);if(3023==o.j)var r=o(51887)},2826:(e,t,o)=>{"use strict";var i,n;o.d(t,{Z:()=>i,f:()=>n}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(i||(i={})),function(e){e.FirstParty="FirstParty",e.ThirdParty="ThirdParty"}(n||(n={}))},25426:(e,t,o)=>{"use strict";o.d(t,{J_:()=>a,NG:()=>u,VL:()=>s,nm:()=>l,rQ:()=>r,t9:()=>c,xz:()=>n});var i=o(87094);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetchCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDeleteCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid"}static getBaseTypes(){return["AugLoop_GraphSearch_SearchSuggestionsAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphSearch_PredictionAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphSearch_NudgeAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphSearch_EccAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_GraphSearch_UserInitiatedAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},85209:(e,t,o)=>{"use strict";o.d(t,{$9:()=>s,Z5:()=>n,tE:()=>r,zV:()=>a});var i=o(87094);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsRequest"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_GraphSearchSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDelete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},95436:(e,t,o)=>{"use strict";o.d(t,{JM:()=>n,VP:()=>r});var i=o(87094),n=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),r=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}())},33674:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OD:()=>n,WI:()=>i}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate"}(i||(i={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n||(n={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(r||(r={}))},31987:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,s:()=>r});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},28677:(e,t,o)=>{"use strict";o.d(t,{Cg:()=>r,qf:()=>n});var i=o(99564);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},12980:(e,t,o)=>{"use strict";o.d(t,{Cg:()=>r,qf:()=>n});var i=o(87094);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},71501:(e,t,o)=>{"use strict";t.pR=t.O7=t.i6=t.Jq=t.wS=t._C=void 0;const i=o(14347);var n,r;!function(e){e[e.Person=0]="Person",e[e.NonPerson=1]="NonPerson",e[e.File=2]="File",e[e.WordDocument=3]="WordDocument",e[e.Powerpoint=4]="Powerpoint",e[e.PDF=5]="PDF",e[e.Excel=6]="Excel",e[e.Meeting=7]="Meeting",e[e.Chat=8]="Chat",e[e.Email=9]="Email",e[e.Unknown=10]="Unknown"}(n||(n={})),function(e){e[e.PastMeeting=0]="PastMeeting",e[e.FutureMeeting=1]="FutureMeeting",e[e.Unknown=2]="Unknown"}(r||(r={}));t._C={"whats the latest from":n.Person,"when is my next meeting with":n.Person,"what s the latest from":n.Person,"when s my next meeting with":n.Person,"what did":n.Person,recap:n.Meeting,"draft an email with action items from":n.Meeting,"what are the unresolved issues from":n.Meeting,"help me prepare for my next meeting":n.Meeting,"what were the key takeaways from":n.Meeting,"what are the key takeaways from":n.Meeting,"list key points from":n.File,"create a faq based on":n.File,"propose a new introduction to":n.File,"suggest edits make this more concise":n.File},t.wS={"¿cuáles fueron los problemas abiertos de":r.PastMeeting,"¿cuáles fueron los problemas abiertos de la":r.PastMeeting,"rédige un courriel contenant des notes et des éléments d’action de la":r.PastMeeting,"rédige un e-mail contenant des notes et des éléments d’action de la":r.PastMeeting,"crea una bozza di e-mail con le note e le attività definite durante la":r.PastMeeting,"entwirf eine e-mail mit notizen und aktionselementen aus":r.PastMeeting,"redacta un borrador de correo electrónico con notas y acciones de":r.PastMeeting,使用来自:r.PastMeeting,"draft an email with notes and action items from":r.PastMeeting,"¿cuáles son los elementos de acción de":r.PastMeeting,"elabore um email com anotações e itens de ação":r.PastMeeting,"was waren die offenen fragen in":r.PastMeeting,"what were the open issues from":r.PastMeeting,"quels étaient les problèmes en suspens par rapport à la":r.PastMeeting,"quali sono state le questioni discusse nella":r.PastMeeting,"quais foram os problemas em aberto da":r.PastMeeting,"what are the action items from":r.PastMeeting,"quali sono le attività da svolgere definite nella":r.PastMeeting,"was sind die aktionselemente aus":r.PastMeeting,"quels sont les points d'action issus de la":r.PastMeeting,"quais são os itens de ação da":r.PastMeeting,recap:r.PastMeeting,"resuma a":r.PastMeeting,"récap. la":r.PastMeeting,"resume las conclusiones y elementos de acción de la":r.PastMeeting,"crea un riepilogo della":r.PastMeeting,回顾:r.PastMeeting,récap:r.PastMeeting},t.Jq={"のオープンしている問題は何でしたか?":r.PastMeeting,"を要約し、主要な要点とアクション アイテムを別のセクションとしてまとめ、各責任者を含めます":r.PastMeeting,"中的未解决问题有哪些?":r.PastMeeting,"のアクション アイテムは何ですか?":r.PastMeeting,"中的拟办事项有哪些?":r.PastMeeting,"zusammen, mit ergebnissen/aktionselementen als abschnitten, mit zuständigen.":r.PastMeeting,"のメモとアクション アイテムを含むメールの下書きを作成します":r.PastMeeting},t.i6={"latest from":n.Person,"manager of":n.Person,who:n.Person,"who is":n.Person,message:n.NonPerson,messages:n.NonPerson,summarize:n.NonPerson,concise:n.NonPerson,elaborate:n.NonPerson,"introduction to":n.NonPerson,"points from":n.NonPerson,"items from":n.NonPerson,"issues from":n.NonPerson,"based on":n.NonPerson,in:n.NonPerson,meeting:n.Meeting,event:n.Meeting,meet:n.Meeting,sync:n.Meeting,"sync up":n.Meeting,call:n.Meeting,huddle:n.Meeting,scrum:n.Meeting,conference:n.Meeting,conf:n.Meeting,review:n.Meeting,discussion:n.Meeting,brief:n.Meeting,briefing:n.Meeting,appointment:n.Meeting,recap:n.Meeting,"prepare for":n.Meeting,"prep for":n.Meeting,file:n.File,files:n.File,document:n.WordDocument,documents:n.WordDocument,doc:n.WordDocument,word:n.WordDocument,docx:n.WordDocument,excel:n.Excel,sheet:n.Excel,spreadsheet:n.Excel,"spread sheet":n.Excel,presentation:n.Powerpoint,deck:n.Powerpoint,powerpoint:n.Powerpoint,"power point":n.Powerpoint,ppt:n.Powerpoint,pptx:n.Powerpoint,pdf:n.PDF,email:n.Email,emails:n.Email,"e mail":n.Email,"e mails":n.Email,chat:n.Chat,chats:n.Chat,group:n.Chat,groups:n.Chat,conversation:n.Chat,conversations:n.Chat};const s=new Set(["with","by"]);function a(e,t,o){const n=function(e,t){let o;if(void 0!==e&&e!==r.Unknown)switch(e){case r.FutureMeeting:o={name:"#event#",scope:i.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?i.IntentConfidenceLevel.High:i.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"future"}],highConfidenceSign:!!t};break;case r.PastMeeting:o={name:"#event#",scope:i.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?i.IntentConfidenceLevel.High:i.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"past"}],highConfidenceSign:!!t}}return o}(e,o);if(void 0===n)return;const s=t.find((e=>e.name===n.name));s?(s.score=Math.max(s.score,n.score),s.confidenceLevel=Math.max(s.confidenceLevel,n.confidenceLevel),s.highConfidenceSign=s.highConfidenceSign||n.highConfidenceSign,s.slots=function(e,t){if(t){if(e){const o=t.filter((t=>!e.some((e=>t.slotName===e.slotName))));return[...e,...o]}return t}return e}(s.slots,n.slots)):t.push(n)}function l(e){let t=e.toLowerCase().trim().replace(/[^\w\s]/g," ").trim().toLowerCase();return t=t.replace(/\s+/g," "),t}t.O7={"prepare for":r.FutureMeeting,"prep for":r.FutureMeeting,"prepare me for":r.FutureMeeting,"prep me for":r.FutureMeeting,"next meeting":r.FutureMeeting,"next event":r.FutureMeeting,"next sync":r.FutureMeeting,"next call":r.FutureMeeting,upcoming:r.FutureMeeting,"to be discussed":r.FutureMeeting,recap:r.PastMeeting,"last meeting":r.PastMeeting,"previous meeting":r.PastMeeting,summarize:r.PastMeeting,"summary of":r.PastMeeting,"points from":r.PastMeeting,"items from":r.PastMeeting,"takeaways from":r.PastMeeting,discussed:r.PastMeeting,"issues from":r.PastMeeting,"based on":r.PastMeeting},t.pR=function(e,o){var c,u;if((null!==(c=null==e?void 0:e.length)&&void 0!==c?c:0)<=0&&(null!==(u=null==o?void 0:o.length)&&void 0!==u?u:0)<=0)return;const d=function(e){const t=[];if(void 0!==e&&e!==n.Unknown)switch(e){case n.Person:t.push({name:"#people#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.NonPerson:t.push({name:"#people#",scope:i.IntentScope.FirstParty,score:0,confidenceLevel:i.IntentConfidenceLevel.Low,highConfidenceSign:!1});break;case n.File:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.WordDocument:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"doc"},{slotName:"file_type",slotValue:"docx"}],highConfidenceSign:!0});break;case n.Powerpoint:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"ppt"},{slotName:"file_type",slotValue:"pptx"}],highConfidenceSign:!0});break;case n.PDF:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"pdf"}],highConfidenceSign:!0});break;case n.Excel:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"xls"},{slotName:"file_type",slotValue:"xlsx"}],highConfidenceSign:!0});break;case n.Meeting:t.push({name:"#event#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Chat:t.push({name:"#chat#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Email:t.push({name:"#email#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0})}return t}(function(e){let o=n.Unknown;const i=l(e);if(t._C.hasOwnProperty(i))return t._C[i];const r=i.split(" "),a=r[r.length-1];if(t.i6.hasOwnProperty(a)&&(o=t.i6[a]),r.length>=2){const e=r.slice(Math.max(0,r.length-2)).join(" ");t.i6.hasOwnProperty(e)&&(o=t.i6[e]);const i=r[r.length-2];("from"===a&&t.i6.hasOwnProperty(i)||s.has(a))&&(o=n.Person)}return o}(e)),g=function(e,o){const i=e.trim().toLowerCase();if(t.wS.hasOwnProperty(i))return t.wS[i];if(o){const e=o.trim().toLowerCase();if(t.Jq.hasOwnProperty(e))return t.Jq[e]}return r.Unknown}(e,o);return g!==r.Unknown?a(g,d,!0):a(function(e){const o=l(e).split(" "),i=Math.min(o.length,5),n=o.slice(Math.max(0,o.length-i)).join(" ");for(const e in t.O7)if(n.includes(e))return t.O7[e];return r.Unknown}(e),d),d}},38889:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildEmscriptenCustomContextFromSite=t.buildEmscriptenCustomContext=void 0;const i=o(98635);function n(e,t){function o(e,t,o,i){const n=function(e,t,o){const i=new Headers,n=o.keys();for(let e=0;e<n.size();e++){const t=n.get(e);i.append(t,o.get(t))}const r={};return r.method=e,void 0!==t&&(r.body=t),n.size()>0&&(r.headers=i),n.delete(),r}(t,o,i);let r=0;return fetch(e,n).then((e=>{if(r=e.status,!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((e=>({bufferArray:new Uint8Array(e),length:e.byteLength,isError:!1,statusCode:r}))).catch((e=>{const t=e;return t.isError=!0,t.statusCode=r,t}))}function n(e,t,o){if(e||t&&0!==t.length){if(e){const t=e;return t.isError=!0,t}return{token:t,ttl:o?o.timeToLiveSec:void 0}}return{name:"Missing Token",message:"Unable to fetch token",isError:!0}}function r(e){if(!e)return;const t=new Map,o=e.keys();for(let i=0;i<o.size();i++){const n=o.get(i);t.set(n,e.get(n))}return t}function s(e,t){return new Promise((async(o,i)=>{try{if(!e.run)throw new Error("WorkflowSite is unimplemented.");const i=await e.run(t);if(!i)throw new Error("Outputs returned as undefined.");o(i)}catch(e){const t=e;t.isError=!0,o(t)}}))}function a(e,t,o){if(!e||!e.run){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.run(t).then((e=>{if(!e)throw new Error("Outputs returned as undefined.");i.opcall(e)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))}const l={createModel:function(t){return new Promise((async(o,i)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const i=await e.site.createModel(t);i.customRun=s.bind(null,i),i.customRunInCallback=a.bind(null,i),o(i)}catch(e){const t=e;t.isError=!0,o(t)}}))},createModelInCallback:function(t,o){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.site.createModel(t).then((e=>{e.customRun=s.bind(null,e),e.customRunInCallback=a.bind(null,e),i.opcall(e)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))},createModelInputs:function(){return new Promise((async(t,o)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");t(await e.site.createModelInputs())}catch(e){const o=e;o.isError=!0,t(o)}}))},createModelInputsInCallback:function(t){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void t(e)}const o=t.clone();e.site.createModelInputs().then((e=>{o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))}},c={};return c.docSessionId=e.clientMetadata.docSessionId,c.getToken=function(t){return new Promise(((o,i)=>{e.getToken(t,((e,t,i)=>{if(e||t&&0!==t.length)if(e){const t=e;t.isError=!0,o(t)}else o(t);else o({name:"Missing Token",message:"Unable to fetch token",isError:!0})}))}))},c.getTokenWithPropertiesAsync=function(t){return new Promise(((o,i)=>{e.getToken(t,((e,t,i)=>{const r=n(e,t,i);o(r)}))}))},c.getTokenWithPropertiesInCallback=function(t,o){const i=o.clone();e.getToken(t,((e,t,o)=>{const r=n(e,t,o);i.opcall(r),i.delete()}))},c.getResourceAsUrlInCallback=function(t,o,i,n){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void n(e)}const s=n.clone();e.site.getResourceAsURL(t,o,r(i)).then((e=>{const t=Object.entries(e),o=new Map(t);s.opcall(o)})).catch((e=>{const t=e;t.isError=!0,s.opcall(t)})).finally((()=>{s.delete()}))},c.httpRequest=o,c.httpRequestInCallback=function(e,t,i,n,r){const s=r.clone();o(e,t,i,n).then((e=>{s.opcall(e)})).catch((e=>{})).finally((()=>{s.delete()}))},c.copyUint8ArrayToWasmMemory=function(e,o){t().HEAPU8.set(e,o)},c.copyUint16ArrayToWasmMemory=function(e,o){t().HEAPU16.set(e,o>>1)},c.copyUint32ArrayToWasmMemory=function(e,o){t().HEAPU32.set(e,o>>2)},c.copyInt8ArrayToWasmMemory=function(e,o){t().HEAP8.set(e,o)},c.copyInt16ArrayToWasmMemory=function(e,o){t().HEAP16.set(e,o>>1)},c.copyInt32ArrayToWasmMemory=function(e,o){t().HEAP32.set(e,o>>2)},c.copyFloat32ArrayToWasmMemory=function(e,o){t().HEAPF32.set(e,o>>2)},c.copyFloat64ArrayToWasmMemory=function(e,o){t().HEAPF64.set(e,o>>3)},c.getResourceAsUrl=function(t,o,i){return new Promise((async(n,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const s=await e.site.getResourceAsURL(t,o,r(i)),a=Object.entries(s);n(new Map(a))}catch(e){const t=e;t.isError=!0,n(t)}}))},c.getResourceAsByteArray=function(t,o,i){return new Promise((async(n,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const s=await e.site.getResourceAsArrayBuffer(t,o,r(i)),a=new Map;for(const[e,t]of Object.entries(s)){console.log(e,t);const o=new Uint8Array(t),i={};i.bufferArray=o,i.length=t.byteLength,a.set(e,i)}n(a)}catch(e){const t=e;t.isError=!0,n(t)}}))},c.site=l,c.context=e,c.logOperationClass=i.Operation,c.logInfoFunction=i.Log.info.bind(null,0,i.LogCategory.WorkflowDefault),c.dummyPromise=Promise.resolve("Success"),c.logDebugTrace=function(e,t){i.Log.debug(e,i.LogCategory.WorkflowDefault,t)},c.logInfoTrace=function(e,t){i.Log.info(e,i.LogCategory.WorkflowDefault,t)},c.logWarnTrace=function(e,t){i.Log.warn(e,i.LogCategory.WorkflowDefault,t)},c.logErrorTrace=function(e,t){i.Log.error(e,i.LogCategory.WorkflowDefault,t)},c.getUserContext=function(){if(!e.userContext)return;const t={UserContextObject:e.userContext};return JSON.stringify(t)},c}t.buildEmscriptenCustomContext=n,t.buildEmscriptenCustomContextFromSite=function(e,t){return n({clientMetadata:void 0,getToken:function(e,t){throw new Error("GetToken not available in init.")},getTokenAsync:async function(){throw new Error("GetTokenAsync not available in init.")},site:e},t)}},40087:function(e,t,o){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,i,n)}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(o(25599),t),n(o(38889),t)},25599:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmWebFromModularizeFunction=void 0;const i=o(98635),n=new Set,r=new Map,s="function"==typeof globalThis.importScripts;function a(e,t){e.src=t}function l(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function c(e,t,o,n,r){if(!n)return!1;const s=r||l;return!!s()[e+"Module"]&&(t.resultDescription="Module Loaded From Cache",i.Log.info(538576341,i.LogCategory.WorkflowDefault,t.stop()),o(s()[e+"Module"]),!0)}t.loadWasmWebFromModularizeFunction=async function(e,t,o,u,d,g,h){const p=new i.Operation({operationName:"LoadWasmWebFromModularizeFunction",success:!0,resourceId:o,resultDescription:""}).start();return new Promise(((f,m)=>{if(c(t,p,f,u,g))return;if(u&&n.has(t)){if(c(t,p,f,u,g))return;let e=r.get(t);void 0===e&&(e=[],r.set(t,e)),e.push({onSuccess:e=>f(e),onError:e=>m(e)})}else!function(e,t,o,i){if(s)try{globalThis.importScripts(e),t()}catch(e){o(e)}else{const n=document.createElement("script");(i||a)(n,e),n.onload=function(){t(),n.remove()},n.onerror=function(e){o(e),n.remove()},document.body.appendChild(n)}}(e,(()=>{if(c(t,p,f,u,g))return;if(!self[t])return p.success=!1,p.resultDescription="ModularizeFunction Missing",i.Log.info(538576343,i.LogCategory.WorkflowDefault,p.stop()),void m(new Error("ModularizeFunction Missing"));const e={};void 0!==d&&(e.locateFile=d),e.onAbort=function(e){const t=new i.Operation({operationName:"WasmCrashHappenedOnAbortCalled",resourceId:o}).start();"string"==typeof e&&(t.resultDescription=e),i.Log.error(509154189,i.LogCategory.WorkflowDefault,t.stop())},self[t](e).then((e=>{!function(e,t,o,n,a,u){var d;if(c(e,t,o,n,u))return;s&&(globalThis.top=self);const g=u||l;n&&(g()[e+"Module"]=a,null===(d=r.get(e))||void 0===d||d.forEach((t=>{t.onSuccess(g()[e+"Module"])})),r.set(e,[])),t.dimension0=n.toString(),i.Log.info(512237901,i.LogCategory.WorkflowDefault,t.stop()),o(a)}(t,p,f,u,e,g)})).catch((e=>{var o,n;p.success=!1,p.resultDescription="ModularizeFunction Failed: "+(null!==(o=e.message)&&void 0!==o?o:"Unknown Error Message"),i.Log.info(512237900,i.LogCategory.WorkflowDefault,p.stop()),null===(n=r.get(t))||void 0===n||n.forEach((t=>{t.onError(e)})),r.set(t,[]),m(e)}))}),(e=>{var o;p.success=!1,p.resultDescription="ScriptLoad Failed: "+("string"==typeof e?e:"Unknown Error Message"),i.Log.info(538706265,i.LogCategory.WorkflowDefault,p.stop()),null===(o=r.get(t))||void 0===o||o.forEach((t=>{t.onError(e)})),r.set(t,[]),m(e)}),h);u&&n.add(t)}))}},27821:(e,t,o)=>{"use strict";o.d(t,{E:()=>i});const i=e=>n(e,Number.POSITIVE_INFINITY),n=(e,t)=>{let o=0;const i=[],n=[e];for(;n.length>0;){const e=n.pop(),r=typeof e;if("boolean"===r)o+=4;else if("string"===r)o+=2*e.length;else if("number"===r)o+=8;else if("object"===r&&e&&-1===i.indexOf(e))if(e instanceof Uint8Array)o+=e.length;else{i.push(e);for(const t in e)n.push(e[t])}if(o>t)return o}return o}},1401:(e,t,o)=>{"use strict";function i(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}o.d(t,{v4:()=>i})},42534:(e,t,o)=>{"use strict";o.d(t,{JU:()=>s,Vh:()=>r});const i=";",n=":";function r(e){if(!e)return new a([],new Set,new Map,new Map);const t=e.split(i),o=new Set,r=new Map,s=new Map;for(const e of t){const t=e.trim();if(""===t)continue;o.add(a.normalizeName(t));const[i,...l]=t.split(n),c=l.join(n),u=a.normalizeName(i);if(u){r.set(u,c);const e=a.parseName(u);e&&e!==u&&s.set(e,u)}}return new a(t,o,r,s)}function s(e){if(!e)return"";const t=new Set,o=[];for(const r of e.split(i).reverse()){const e=r.split(n)[0],i=a.normalizeName(e);t.has(i)||(t.add(i),o.push(r))}return o.reverse().join(i)}class a{constructor(e,t,o,i){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=o,this.parsedFlightsMap=i}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=a.normalizeName(e),o=this.normalizedFlights.has(t),i=this.keyValueFlightsMap.has(t),n=this.parsedFlightsMap.has(t);return o||i||n}getBooleanValue(e,t){var o,i;const n=null===(o=this.getStringValue(e))||void 0===o?void 0:o.toLowerCase(),r=null===(i=this.getStringValue(this.parsedFlightsMap.get(a.normalizeName(e))))||void 0===i?void 0:i.toLowerCase();return"true"===n||"true"===r||"false"!==n&&"false"!==r&&t}getIntValue(e,t){const o=this.getStringValue(e),i=Number.parseInt(o,10);return Number.isNaN(i)?t:i}getStringValue(e,t){var o;return null!==(o=this.keyValueFlightsMap.get(a.normalizeName(e)))&&void 0!==o?o:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,o)=>{const i=null==t?void 0:t.toLowerCase();switch(i){case"true":e.push({name:o,value:!0});break;case"false":e.push({name:o,value:!1});break;default:{const n=Number.parseInt(i,10);Number.isNaN(n)?e.push({name:o,value:t}):e.push({name:o,value:n})}}})),e}}},66061:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=(e,t)=>{const o=[];for(const i of null!=e?e:[])if(void 0===t||t===i.cardinality)for(const e of i.contextTypes)o.push([e,i.cardinality,i.producerWaitPolicy]);return o}},59080:(e,t,o)=>{"use strict";o.d(t,{L:()=>i});class i{constructor(e){this.outlookDataHandle=e}getLocalPeopleData(){const e=this.outlookDataHandle.getAllRecipients(),t=[];for(const o of e)t.push({DisplayName:o.displayName,EmailAddresses:[o.emailAddress],Id:o.id,confidence:0,entityType:"",providerName:"",text:""});return t}}},1513:(e,t,o)=>{"use strict";o.d(t,{L4:()=>y});var i=o(25426),n=o(85209),r=o(37827),s=o(78851),a=o(87094),l=o(21912),c=o(55384),u=o(95436),d=o(58636),g=o(60172),h=o(900);const p=e=>"GraphSearchClient"===e.ownerId,f=new Map([["AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid",0],["AugLoop_ObservationalAssistance_EccAnnotationClient",1],["AugLoop_GraphSearch_EccAnnotationHybrid",1],["AugLoop_GraphSearch_PredictionAnnotationHybrid",2],["AugLoop_GraphSearch_NudgeAnnotationHybrid",3]]);class m extends g.c{constructor(e,t){super("GraphSearchJoinWorkflowInstance",e,t)}async execute(e,t,o,n){let s=!1,c=!1;const u=new Date,d=this.startLogOperation("GraphSearchJoinWorkflowExecute",u,t);this.logWasmStats(d);const g=f.get(a.h.getTypeNameFor(t[0]));if(void 0!==g&&d.setDataFields({scenario:g}),2===t.length){if(l.SM.typeGuard(t[0])||l.SM.typeGuard(t[1])){const e=t[p(t[0])?0:1];d.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:o.clientMetadata.sessionId})}if(i.nm.typeGuard(t[0])||i.nm.typeGuard(t[1])){const e=t[p(t[0])?0:1];d.setDataFields({logicalId:e.logicalId,sessionId:o.clientMetadata.sessionId}),"Ignore"===e.entityType&&(c=!0)}}d.setDataFields({dimension0:(new Date).getTime()-u.getTime()}),s=this.executeWorkflowLambda(d,e,o,n,t),c&&!s||r.tG.info(509638786,r.nh.WorkflowDefault,d.stop())}}const v=(e,t)=>new m(e,t),y=(e,t)=>s.a.create("GraphSearchJoinECC").setCollectionScopeType(u.VP.getTypeName()).setInputTypes([l.SM.getTypeName(),i.NG.getTypeName()]).setOutputTypes([c.os.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,e,t));var b,S;b=h.aU,S=h.zb,s.a.create("GraphSearchJoinWorkflow").setCollectionScopeType(n.Z5.getTypeName()).setInputTypes([i.J_.getTypeName()]).setOutputTypes([i.VL.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,b,S)),((e,t)=>{s.a.create("GraphSearchJoinPrediction").setCollectionScopeType(d.iU.getTypeName()).setInputTypes([i.nm.getTypeName(),i.t9.getTypeName()]).setOutputTypes([l.k2.getTypeName(),l.KL.getTypeName(),c.Vm.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,e,t))})(h.aU,h.zb),y(h.aU,h.zb)},70168:(e,t,o)=>{"use strict";o.d(t,{X8:()=>v});var i=o(84563),n=o(37827),r=o(87094),s=o(85209),a=o(25426),l=o(58636),c=o(95436);if(3023==o.j)var u=o(21912);var d=o(60172),g=o(900);if(3023==o.j)var h=o(59080);const p=new Map([["AugLoop_GraphSearch_SearchSuggestionsRequest",0],["AugLoop_ObservationalAssistance_UserInitiatedRequestClient",1],["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient",2]]);class f extends d.c{constructor(e,t){super("GraphSearchWorkflowInstance",e,t)}async execute(e,t,o){var i;let s=!1,a=!1;const u=new Date,d=this.startLogOperation("GraphSearchWorkflowExecute",u);this.logWasmStats(d);const g=p.get(r.h.getTypeNameFor(e));void 0!==g&&d.setDataFields({scenario:g}),(c.VP.typeGuard(e)||l.iU.typeGuard(e))&&(d.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:t.clientMetadata.sessionId}),l.iU.typeGuard(e)&&0===(null===(i=e.multiIntents)||void 0===i?void 0:i.length)&&(a=!0)),s=this.executeWorkflowLambda(d,e,t,o),a&&!s||n.tG.info(509638755,n.nh.WorkflowDefault,d.stop())}}const m=(e,t)=>new f(e,t),v=(e,t)=>{const o=t.localContext?new h.L(t.localContext):null;return i.z.create("GraphSearchLocalWorkflowOA").setStateful().setInputTypes([s.$9.getTypeName(),l.iU.getTypeName(),c.VP.getTypeName(),s.zV.getTypeName()]).setOutputTypes([a.nm.getTypeName(),a.t9.getTypeName(),u.SM.getTypeName(),a.NG.getTypeName(),s.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(m.bind(null,{...e,localContext:o},t))};var y,b;y=g.aU,b=g.zb,i.z.create("GraphSearchLocalWorkflow").setStateful().setInputTypes([s.$9.getTypeName(),s.Z5.getTypeName(),s.zV.getTypeName()]).setOutputTypes([a.J_.getTypeName(),s.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(m.bind(null,y,b))},60172:(e,t,o)=>{"use strict";o.d(t,{c:()=>m});var i=o(40087);if(3023==o.j)var n=o(900);if(3023==o.j)var r=o(12839);if(3023==o.j)var s=o(37827);if(3023==o.j)var a=o(76839);if(3023==o.j)var l=o(42948);if(3023==o.j)var c=o(85209);if(3023==o.j)var u=o(25426);if(3023==o.j)var d=o(95436);if(3023==o.j)var g=o(83012);if(3023==o.j)var h=o(21912);if(3023==o.j)var p=o(55384);if(3023==o.j)var f=o(84635);class m{constructor(e,t,o){var i,s;this.ariaNamespace="GraphSearch",this.prodAriaToken="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",this.devAriaToken="30d62489eb65462bb3a5c93b0cad786b-0260e5be-afb3-4f7c-a14a-f0b25b00a080-7662",this.isDisposed=!1,this.wasmConfig=o,this.propertyName=e,this.ariaToken=void 0!==t.environment&&t.environment===r.O.dev?this.devAriaToken:this.prodAriaToken;const a=t.scenarios&&t.scenarios.includes(n.Nz.BIZ_CHAT)?(0,l.E)():void 0;this.config={...t,...void 0===t.scenarioLength?{scenarioLength:t.scenarios.length}:{},heuristicIntentsConfig:a};const c=null!==(i=null==o?void 0:o.jsAssetName)&&void 0!==i?i:"GraphSearchLocalWorkflow.js",u=`${o.wasmRoot}/${c}`;this.wasmConfig={...void 0===o?{}:o,wasmRoot:u},t.enableMemoryLeakDetection&&(this.memoryLeakDetector=new f.j(null!==(s=t.memoryLeakDetectorConfig)&&void 0!==s?s:{}))}async init(e,t){var o;const n=this.startLogOperation("GraphSearchWorkflowInstance"===this.propertyName?"GraphSearchWorkflowInit":"GraphSearchJoinWorkflowInit",new Date);n.setDataFields({isPrefetch:this.config.prefetchOnly});try{await this.initializeWasmModule(this.wasmConfig.wasmRoot,this.wasmConfig.locateFile,this.wasmConfig.cacheModule,this.wasmConfig.wasmModuleCache,this.wasmConfig.scriptSrcSetter),this.logWasmStats(n),this.workflowLambda=this.wasmModule[this.propertyName](this.config);const o=t?(0,i.buildEmscriptenCustomContext)(t,(()=>this.wasmModule)):(0,i.buildEmscriptenCustomContextFromSite)(e,(()=>this.wasmModule));this.workflowLambda.init(o)}catch(e){const t=null!==(o=null==e?void 0:e.stack)&&void 0!==o?o:"";n.resultDescription=e&&e.message?`${e.message} // ${t}`:"Unknown error.",n.success=!1}s.tG.info(507573794,s.nh.WorkflowDefault,n.stop())}executeWorkflowLambda(e,t,o,n,r){var a;let l=!1;if(!this.wasmModule||!this.workflowLambda)return e.resultDescription="null lambda",e.success=!1,s.tG.info(507564037,s.nh.WorkflowDefault,e.stop()),"GraphSearchWorkflowInstance"===this.propertyName?this.sendDummyAndTriggerServiceFallback(n,t):this.sendInputAnnotation(n,t,r),!1;try{const e=(0,i.buildEmscriptenCustomContext)(o,this.wasmModule);void 0===r?this.workflowLambda.execute(t,e,n):this.workflowLambda.execute(t,r,e,n)}catch(t){const o=null!==(a=null==t?void 0:t.stack)&&void 0!==a?a:"";e.resultDescription=t&&t.message?`${t.message} // ${o}`:"Unknown error.",e.success=!1,l=!0}return l}dispose(){this.isDisposed=!0,void 0!==this.workflowLambda&&this.workflowLambda.delete(),this.workflowLambda=void 0,this.wasmModule=void 0}async initializeWasmModule(e,t,o=!0,n,r){if(this.wasmModule=await(0,i.loadWasmWebFromModularizeFunction)(e,"createGSWLocalInstance","GraphSearchWorkflowWasm_Prefetch",o,t,n,r),this.isDisposed)throw new Error("Workflow was disposed while initializing WASM module")}startLogOperation(e,t,o){const i=new a.I({operationName:"GraphSearchWorkflowInstance"===this.propertyName?"graphsearchworkflow_ts":"graphsearchjoinworkflow_ts",success:!0,resultDescription:"",ariaTenant:this.ariaToken,ariaNamespace:this.ariaNamespace}).start();return i.setDataFields({msg:e,startTimestamp:t.toISOString(),inputCount:o?o.length:0}),i}logWasmStats(e){this.wasmModule&&e.setDataFields({version:this.wasmModule.version,sdkVersion:this.wasmModule.sdkVersion,wasmModuleHeapSize:this.wasmModule.HEAP8?this.wasmModule.HEAP8.buffer.byteLength:void 0}),this.config.enableMemoryLeakDetection&&this.wasmModule&&this.wasmModule.HEAP8&&this.memoryLeakDetector.recordMemoryUsage(this.wasmModule.HEAP8.buffer.byteLength)}sendDummyAndTriggerServiceFallback(e,t){if(d.VP.typeGuard(t)||c.Z5.typeGuard(t)){const o={ownerId:"GraphSearchClient",conversationId:t.conversationId,logicalId:t.logicalId,entityResults:[],status:g.i.Success},i=d.VP.typeGuard(t)?h.SM.getTypeName():u.J_.getTypeName();e.setAnnotations(t,i,[o],{immediate:!0}),e.submitSignals([new c.tE({cachedIntents:[],inputObject:t,entityTypesResolved:this.config.entityTypes})])}}sendInputAnnotation(e,t,o){void 0!==o&&o.length>0&&(h.SM.typeGuard(o[0])?this.sendEccInputAnnotation(e,t,o):u.J_.typeGuard(o[0])&&this.sendSearchSuggestionInputAnnotation(e,t,o))}sendEccInputAnnotation(e,t,o){if(void 0!==o&&o.length>0&&h.SM.typeGuard(o[0])){const i=new p.os({entityResults:o[0].entityResults,status:g.i.Success});e.setAnnotations(t,p.os.getTypeName(),[i],{immediate:!0})}}sendSearchSuggestionInputAnnotation(e,t,o){if(void 0!==o&&o.length>0&&u.J_.typeGuard(o[0])){const i=new u.VL({results:o[0].results,status:g.i.Success});e.setAnnotations(t,u.VL.getTypeName(),[i],{immediate:!0})}}}},42948:(e,t,o)=>{"use strict";o.d(t,{E:()=>r});var i=o(71501);function n(e,t,o){var n;if(!t||void 0===o)return[];const r=t.substring(0,o).trimEnd(),s=t.substring(o+(null!==(n=1+(null==e?void 0:e.length))&&void 0!==n?n:0)).trim();return(0,i.pR)(r,s)||[]}function r(){return{getHeuristicIntents:n}}},84635:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});class i{constructor(e){var t,o,i,n;this.memoryPoints=new Set,this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now(),this.growthFrequencyThreshold=null!==(t=e.growthFrequencyThreshold)&&void 0!==t?t:5,this.shortTermWindow=null!==(o=e.shortTermWindow)&&void 0!==o?o:6e4,this.longTermGrowthThreshold=null!==(i=e.longTermGrowthThreshold)&&void 0!==i?i:.5,this.longTermWindow=null!==(n=e.longTermWindow)&&void 0!==n?n:288e5}recordMemoryUsage(e){const t=Date.now();0===this.memoryPoints.size&&(this.startMemorySize=e,this.startTimestamp=t),this.memoryPoints.add(e),this.memoryTimestamps.push(t),this.checkShortTermGrowths(t),this.checkLongTermGrowth(e,t)}checkShortTermGrowths(e){const t=e-this.shortTermWindow;for(;this.memoryTimestamps.length>0&&this.memoryTimestamps[0]<t;)this.memoryTimestamps.shift();const o=new Set(this.memoryTimestamps.map((t=>Array.from(this.memoryPoints).find((()=>-1!==this.memoryTimestamps.findIndex((o=>o>=t&&o<=e)))))).filter(Boolean));if(o.size>=this.growthFrequencyThreshold)throw new Error(`Potential memory leak detected: ${o.size} unique memory points in the last ${this.shortTermWindow/1e3} seconds.`)}checkLongTermGrowth(e,t){const o=t-this.startTimestamp;if(o>=this.longTermWindow){const i=(e-this.startMemorySize)/this.startMemorySize;if(i>this.longTermGrowthThreshold)throw new Error(`Potential memory leak detected: ${(100*i).toFixed(2)}% growth over ${(o/36e5).toFixed(2)} hours.`);this.startMemorySize=e,this.startTimestamp=t}}getUniqueMemoryPointCount(){return this.memoryPoints.size}getCurrentMemoryUsage(){return Array.from(this.memoryPoints).pop()}resetDetector(){this.memoryPoints.clear(),this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now()}}},900:(e,t,o)=>{"use strict";o.d(t,{Nz:()=>i,Xe:()=>n,aU:()=>s,zb:()=>a});var i,n,r=o(10091);!function(e){e[e.OWA_REACT_COMPOSE=0]="OWA_REACT_COMPOSE",e[e.OUTLOOK_WEB_OA=1]="OUTLOOK_WEB_OA",e[e.OWA_PEOPLE_NAME_PRED=2]="OWA_PEOPLE_NAME_PRED",e[e.OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE=3]="OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE",e[e.DYNAMIC_SEARCH_BOX=4]="DYNAMIC_SEARCH_BOX",e[e.WORKPLACE_SEARCH=5]="WORKPLACE_SEARCH",e[e.COPILOT=6]="COPILOT",e[e.COPILOT_POWERPOINT=7]="COPILOT_POWERPOINT",e[e.PEOPLE_FLYOUT=100]="PEOPLE_FLYOUT",e[e.BIZ_CHAT=1e4]="BIZ_CHAT"}(i||(i={})),function(e){e[e.SUBSTRATE_AAD=0]="SUBSTRATE_AAD",e[e.SUBSTRATE_MSA=1]="SUBSTRATE_MSA"}(n||(n={}));const s={emailId:"",puid:"",scenarios:[i.OWA_REACT_COMPOSE],market:"",tenantId:"",substrateAuthTokenType:n.SUBSTRATE_AAD,entityTypes:[r.ck.People,r.ck.File,r.ck.Scope],prefetchOnly:!1},a={wasmRoot:"graph-search-local"}},1972:(e,t,o)=>{"use strict";o.d(t,{A:()=>f});var i,n,r,s=o(55384),a=o(83012),l=o(95436),c=o(37827),u=o(84563),d=o(12980);!function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(i||(i={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n||(n={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(r||(r={}));var g=o(4413),h=o(20391);class p{constructor(){this.seqCounter=0,this.lastInput="",this.lastConversationId="",this.lastLogicalId=""}async init(e){}initialize(e){var t,o;!0!==this.initialized&&(this.enableUserInitiatedRequests=null===(t=null==e?void 0:e.flights)||void 0===t?void 0:t.hasFlight("mc-editor-oa-client-ecc"),this.enableSystemInitiatedRequest=null===(o=null==e?void 0:e.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-predictions"),this.initialized=!0)}async execute(e,t,o){this.executeInner(e,t,o),o.done()}executeInner(e,t,o){var i;if(c.tG.info(526713100,c.nh.WorkflowDefault,"Executing oa-client router workflow"),e&&e.content&&t&&o){if(this.initialize(t),d.Cg.typeGuard(e)||d.qf.typeGuard(e))if(null===(i=null==t?void 0:t.flights)||void 0===i?void 0:i.hasFlight("mc-editor-oa-client-router-refactor"))this.processTextTileInput(e.content,e,o,t);else{if(this.tryGenerateUserInitiatedRequest(e.content,e,o,t))return;this.tryGenerateSystemInitiatedRequest(e.content,e,o,t)}}else c.tG.warn(526713101,c.nh.WorkflowDefault,"unexpected inputs, ignoring request")}dispose(){this.seqCounter=0}processTextTileInput(e,t,o,i){var n,r,l,u,d,p,f;const m=(new Date).toISOString(),v=(0,h.K)("Router_UserInitiated",i).start(),y=i.delta,b=null!==(r=null===(n=null==y?void 0:y.additionalData)||void 0===n?void 0:n.conversationId)&&void 0!==r?r:"",S=null!==(u=null===(l=null==y?void 0:y.additionalData)||void 0===l?void 0:l.logicalId)&&void 0!==u?u:"",C=this.getValidUserInitQuery(t,i,v);if(C){const i=null!==(p=null===(d=null==y?void 0:y.additionalData)||void 0===d?void 0:d.scopeInfo)&&void 0!==p?p:void 0,n=void 0===i&&this.sameAsLastUserInitRequest(e,y),r=null!==(f=null==i?void 0:i.entityType)&&void 0!==f?f:"";return v.setDataFields({hasScope:void 0!==i,entityType:r,repeatedReuquest:n}),this.generateUserInitiatedRequest(e,t,o,C,S,b,i,v),void this.finalizeLogging(v,m,S,b)}if(this.enableUserInitiatedRequests){const e=new s.os({conversationId:null!=b?b:"",entityResults:[],logicalId:null!=S?S:"",status:a.i.EarlyExit});o.setAnnotations(t,s.os.getTypeName(),[e]),v.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"}),this.finalizeLogging(v,m,S,b)}else v.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),this.finalizeLogging(v,m,S,b);const w=(new Date).toISOString(),k=(0,h.K)("Router_SystemInitiated",i).start(),T=(0,g.A)();this.isValidSystemInitQuery(t,i,k)?this.generateSystemInitiatedRequest(e,t,o,T,k):this.enableSystemInitiatedRequest?k.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"}):k.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),c.tG.info(508408097,c.nh.WorkflowDefault,`sending SystemInitiatedRequestClient (${this.seqCounter})`),this.finalizeLogging(k,w,T)}finalizeLogging(e,t,o,i){const n=(new Date).toISOString();i&&e.setDataFields({conversationId:i}),e.setDataFields({startTimeStamp:t,endTimeStamp:n,logicalId:o}),c.tG.info(508356445,c.nh.WorkflowDefault,e.stop())}generateUserInitiatedRequest(e,t,o,i,n,r,s,a){if(!this.enableUserInitiatedRequests)return void a.setDataFields({statusDescription:"Request skipped because required flight is missing"});const c=new l.VP({content:this.sanitizeText(e),logicalId:n,conversationId:r,seq:++this.seqCounter,scope:s,...i});o.setAnnotations(t,l.VP.getTypeName(),[c]),a.setDataFields({statusDescription:"User-Initiated request generated"})}generateSystemInitiatedRequest(e,t,o,i,n){if(!this.enableSystemInitiatedRequest)return void n.setDataFields({statusDescription:"Request skipped because required flight is missing"});const r=new l.JM({content:this.sanitizeText(e),logicalId:i,seq:++this.seqCounter});o.setAnnotations(t,l.JM.getTypeName(),[r]),n.setDataFields({statusDescription:"System-Initiated request generated"})}tryGenerateUserInitiatedRequest(e,t,o,i){var n,r,u,d,g,p,f,m;let v=!1;const y=(new Date).toISOString(),b=(0,h.K)("Router_UserInitiated",i).start(),S=i.delta,C=null!==(r=null===(n=null==S?void 0:S.additionalData)||void 0===n?void 0:n.conversationId)&&void 0!==r?r:"",w=null!==(d=null===(u=null==S?void 0:S.additionalData)||void 0===u?void 0:u.logicalId)&&void 0!==d?d:"";if(null===(g=null==i?void 0:i.flights)||void 0===g?void 0:g.hasFlight("mc-editor-oa-client-ecc")){const n=this.getValidUserInitQuery(t,i,b);if(n){const i=null!==(f=null===(p=null==S?void 0:S.additionalData)||void 0===p?void 0:p.scopeInfo)&&void 0!==f?f:void 0,r=void 0===i&&this.sameAsLastUserInitRequest(e,S),s=null!==(m=null==i?void 0:i.entityType)&&void 0!==m?m:"";b.setDataFields({hasScope:void 0!==i,entityType:s,repeatedReuquest:r});const a=new l.VP({content:this.sanitizeText(e),logicalId:w,conversationId:C,seq:++this.seqCounter,scope:i,...n});o.setAnnotations(t,l.VP.getTypeName(),[a]),b.setDataFields({statusDescription:"User-Initiated request generated"}),v=!0}else{const e=new s.os({conversationId:null!=C?C:"",entityResults:[],logicalId:null!=w?w:"",status:a.i.EarlyExit});o.setAnnotations(t,s.os.getTypeName(),[e]),b.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"})}}else b.setDataFields({statusDescription:"Request skipped because required flight is missing"});const k=(new Date).toISOString();return b.setDataFields({startTimeStamp:y,endTimeStamp:k,conversationId:C,logicalId:w}),c.tG.info(508409808,c.nh.WorkflowDefault,b.stop()),v}tryGenerateSystemInitiatedRequest(e,t,o,i){var n;const r=(new Date).toISOString(),s=(0,h.K)("Router_SystemInitiated",i).start(),a=(0,g.A)();if(null===(n=null==i?void 0:i.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-predictions")){if(this.isValidSystemInitQuery(t,i,s)){const i=new l.JM({content:this.sanitizeText(e),logicalId:a,seq:++this.seqCounter});o.setAnnotations(t,l.JM.getTypeName(),[i]),s.setDataFields({statusDescription:"System-Initiated request generated"})}else s.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"});c.tG.info(508409807,c.nh.WorkflowDefault,`sending SystemInitiatedRequestClient(${this.seqCounter})`)}else s.setDataFields({statusDescription:"Request skipped because required flight is missing"});const u=(new Date).toISOString();s.setDataFields({startTimeStamp:r,endTimeStamp:u,logicalId:a}),c.tG.info(508409806,c.nh.WorkflowDefault,s.stop())}sanitizeText(e,t){if("number"!=typeof(null==e?void 0:e.length))return"";"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1));const o=e.replace(/\s/g," ");return t?o.trim():o}sameAsLastUserInitRequest(e,t){var o,i,n,r;const s=null!==(i=null===(o=null==t?void 0:t.additionalData)||void 0===o?void 0:o.conversationId)&&void 0!==i?i:"",a=null!==(r=null===(n=null==t?void 0:t.additionalData)||void 0===n?void 0:n.logicalId)&&void 0!==r?r:"";let l=!1;return e===this.lastInput&&s===this.lastConversationId&&a===this.lastLogicalId&&(l=!0),this.lastInput=e,this.lastConversationId=s,this.lastLogicalId=a,l}getValidUserInitQuery(e,t,o){var i,r;if(!d.Cg.typeGuard(e))return void o.setDataFields({statusDescription:"Invalid input type"});const s=e;if((null===(i=t.delta)||void 0===i?void 0:i.unit)!==n.Chars&&this.sanitizeText(s.content,!0).length<1)return void o.setDataFields({statusDescription:"Ignore empty tile"});const a=t.delta;if(a&&(a.unit!==n.Sentence||a.queryRange&&a.content)){const t=e.content;let i;const n=a.queryRange;if(n){const{length:e,start:o}=n,s=null!==(r=n.prefix)&&void 0!==r?r:p.userInitiatedIntentChar;i={query:this.sanitizeText(t.substring(o+s.length,o+e)),queryChar:s,queryCharIndex:o}}else o.setDataFields({statusDescription:"Invalid or non-existent queryRange provided."});if(i){const e={start:i.queryCharIndex,end:i.queryCharIndex+i.query.length+1};return(a.position>=e.start||a.position+a.content.length>=e.start)&&a.position<=e.end?(o.setDataFields({seqCounter:this.seqCounter,querylength:n.length}),i):void o.setDataFields({statusDescription:"Delta outside of query bounds"})}o.setDataFields({statusDescription:"Invalid query to generate user init request."})}else o.setDataFields({statusDescription:"Delta is undefined. Cannot proceed with query detection logic."})}isValidSystemInitQuery(e,t,o){var i;if(!d.Cg.typeGuard(e))return o.setDataFields({statusDescription:"Invalid input type, ignore"}),!1;const r=e.content,s=this.sanitizeText(r,!0),a=t.delta;if(!a)return o.setDataFields({statusDescription:"Delta is undefined."}),!1;{if(a.unit===n.Sentence||a.unit===n.Paragraph)return!1;if(a.unit!==n.Chars&&s.length<1)return o.setDataFields({statusDescription:"Empty tile, ignore"}),!1;const e=r.endsWith("\n")?r.substring(0,r.length-1):r;if((null===(i=null==t?void 0:t.flights)||void 0===i?void 0:i.hasFlight("mc-editor-oa-client-router-refactor"))&&a.position>=e.length-1)return!0;if(a.position>=e.length-1&&p.triggerCharacters.has(s[s.length-1]))return o.setDataFields({statusDescription:"Router should not generate system initiated requests for ECC requests"}),!1}return!0}}p.userInitiatedIntentChar="@",p.triggerCharacters=new Set(["@","/"]);const f=u.z.create("oaClientRouter").setInputTypes([d.qf.getTypeName()]).setOutputTypes([s.os.getTypeName(),l.JM.getTypeName(),l.VP.getTypeName()]).setLambdaType((()=>new p))},16137:(e,t,o)=>{"use strict";o.d(t,{TE:()=>T});var i=o(91519),n=o(55384),r=o(83012),s=o(12980),a=o(78851),l=o(37827),c=o(20391),u=o(26394),d=o.n(u);class g{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}class h extends g{constructor(e){super(),this.name=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new h(e);const o=h.tryGetConfigProperty(h.currentConfig,e);o.success&&t.updateValue(o.value),this.allSettings.set(e,t)}return t}static setEcsRequestor(e){h.ecsRequestor=e}static getInstanceWithUserId(e,t,o){return h.ecsRequestor?h.ecsRequestor.getECSConfig(t,e,o):(l.tG.info(506228882,l.nh.CoreDefault,"ECS Requestor is not initialized"),Promise.resolve(o))}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new h(e)};const o=h.tryGetConfigPropertyByPattern(h.currentConfig,t.regex);t.setting.updateValue(o),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){h.currentConfig=e,l.tG.info(572837966,l.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),h.allSettings.forEach(((e,t)=>{const o=h.tryGetConfigProperty(h.currentConfig,t).value;e.updateValue(o)&&(l.tG.info(572837967,l.nh.CoreDefault,`Setting new value for ${t}: ${o instanceof Object?JSON.stringify(o):o}`),e.notifyListeners(o))})),h.allPatternSettings.forEach(((t,o)=>{const i=h.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(i)&&(l.tG.info(508432774,l.nh.CoreDefault,`Setting new value for pattern ${o}: ${JSON.stringify(i)}`),t.setting.notifyListeners(i))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:h.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const o=[];if(e){const i=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of i)o.push({name:t,value:h.selectApplicableValue(e[t])})}return o}static setGlobalFilter(e){h.globalFilter=e}static clear(){h.currentConfig=void 0,h.allSettings.clear(),h.allPatternSettings.clear()}static selectApplicableValue(e){let t;if(e){const o=e.find((e=>!h.globalFilter||h.globalFilter(e)));o&&(t=o.value)}return t}getName(){return this.name}getValue(){if(void 0!==globalThis.process&&"true"===(null===(t=null===(e=globalThis.process)||void 0===e?void 0:e.env)||void 0===t?void 0:t.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)&&0===this.listeners.size){const e=new Error("getValue() has been invoked incorrectly for ModuleSettings. Make sure getValue() is called during runtime or there is a listener set up on the setting.");throw e.name="Incorrect usage of getValue()",e}var e,t;return this.value}updateValue(e){return!d()(this.value,e)&&(l.tG.info(572837968,l.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}}h.allSettings=new Map,h.allPatternSettings=new Map;const p=new class extends g{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=h.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueWithUserId(e){return h.getInstanceWithUserId(this.setting.getName(),e,this.defaultValue)}}("disabledChangeGates",[]),f=(e,t,...o)=>{const i=-1===p.getValue().indexOf(e);return t?i?t(...o):void 0:i},m=new Map([[i.c.People,1300],[i.c.PeopleInGroup,1250],[i.c.File,1200],[i.c.Event,1100],[i.c.Message,1e3],[i.c.Chat,920],[i.c.Team,910],[i.c.Channel,900],[i.c.MessageExtensionApp,800],[i.c.External,700],[i.c.Topic,600],[i.c.Loop,500],[i.c.Address,400],[i.c.Scope,100],[i.c.App,90],[i.c.Prompt,85],[i.c.CopilotPlugin,80]]),v=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,y=e=>{const t=m.get(e);return void 0===t?(l.tG.error(509743565,l.nh.WorkflowDefault,`unsupported entity type:'${e}'`),1):t},b=(e,t)=>{const o=y(e.entityType),i=y(t.entityType);return o===i?(l.tG.warn(509743564,l.nh.WorkflowDefault,`unexpected priority:'${e.entityType}','${t.entityType}'`),e.entityType.localeCompare(t.entityType)):i-o},S=(e,t,o)=>{t||l.tG.warn(e,l.nh.WorkflowDefault,o)};class C{constructor(){this.seqCounter=0,this.seqCounter=0}async init(e){this.seqCounter=0}async execute(e,t,o,i){const r=(new Date).toISOString();l.tG.info(524066818,l.nh.WorkflowDefault,`Executing oa-client client-server ranker workflow. sequence number : ${this.seqCounter}`),this.seqCounter++;const s=(0,c.K)("Ranker_Ecc",o).start(),a=this.getRankedResults(t,s);a&&i.setAnnotations(e,n.c$.getTypeName(),[a]);const u=(new Date).toISOString();s.setDataFields({startTimeStamp:r,endTimeStamp:u}),l.tG.info(512500928,l.nh.WorkflowDefault,s.stop()),i.done()}dispose(){this.seqCounter=0}getRankedResults(e,t){var o,i,s,a,c,u,d,g,h,p,m,y;if(0===e.length||this.seqCounter<0)return t.success=!1,t.resultDescription="oa-client-server ecc result ranker lambda has no inputs",void l.tG.warn(524066819,l.nh.WorkflowDefault,t.resultDescription);if(e.length>2)return t.success=!1,t.resultDescription="Unexpected. Client-server ranker can never have more than 2 inputs",void l.tG.warn(523854672,l.nh.WorkflowDefault,t.resultDescription);const C=null!==(i=null===(o=e[0])||void 0===o?void 0:o.conversationId)&&void 0!==i?i:"",w=null!==(a=null===(s=e[0])||void 0===s?void 0:s.logicalId)&&void 0!==a?a:"";if(t.setDataFields({conversationId:C,logicalId:w}),0===(e=e.filter((e=>e.status!==r.i.EarlyExit))).length)return t.success=!0,t.resultDescription="oa-client-server ecc result ranker skipping execution due to receiving early-exit annotations only",void l.tG.warn(509112707,l.nh.WorkflowDefault,t.resultDescription);const k=e.length.toString(),T=e.map((e=>e.ownerId)).join(";");let x;if(t.setDataFields({providerCount:k,souces:T}),1===e.length&&e[0].entityResults)x=new n.c$({conversationId:C,entityResults:e[0].entityResults,logicalId:w,status:e[0].status,treatments:e[0].treatments});else{const t=new Map,o=e[0].entityResults.length>=e[1].entityResults.length?0:1,i=(o+1)%2,s=new Set,a=e[o];for(let o=0;o<a.entityResults.length;++o){const n=a.entityResults[o],r=n.entityType;s.add(r);const l=n.entities,c=e[i];let u=n.modelInfo,d=l,g=a.entityResults[o].intent;for(let e=0;e<c.entityResults.length;++e){const t=c.entityResults[e];if(r===t.entityType){const o=c.entityResults[e].intent;o&&(g=Math.max(null!=g?g:0,o)),d=this.getDeDupedEntityList(l,t.entities),u=this.getMergedModelInfo(n.modelInfo,t.modelInfo);break}}const h={entities:d,entityType:r,modelInfo:u,intent:g};t.set(r,h)}const k=e[i];for(let e=0;e<k.entityResults.length;++e){const o=k.entityResults[e],i=o.entityType;s.has(i)||t.set(i,o)}const T=Array.from(t.values()).sort(b),_=[];let I=[],E=!1;if(f("UseLocallyGeneratedBM")&&(null===(c=null==a?void 0:a.entityResults)||void 0===c?void 0:c.length)>0&&"GraphSearchClient"===(null==a?void 0:a.ownerId)&&(null===(d=null===(u=null==a?void 0:a.treatments)||void 0===u?void 0:u.bestMatchEntries)||void 0===d?void 0:d.length)>0)I=a.treatments.bestMatchEntries;else if(f("UseLocallyGeneratedBM")&&(null===(g=null==k?void 0:k.entityResults)||void 0===g?void 0:g.length)>0&&"GraphSearchClient"===(null==k?void 0:k.ownerId)&&(null===(p=null===(h=null==k?void 0:k.treatments)||void 0===h?void 0:h.bestMatchEntries)||void 0===p?void 0:p.length)>0)I=k.treatments.bestMatchEntries;else{const e=null===(m=null==a?void 0:a.treatments)||void 0===m?void 0:m.bestMatchEntries,t=null===(y=null==k?void 0:k.treatments)||void 0===y?void 0:y.bestMatchEntries;if(e)for(let t=0;t<e.length;t++)_.push(e[t]);if(t)for(let e=0;e<t.length;e++)_.push(t[e]);I=_.sort(((e,t)=>v(t.confidence)-v(e.confidence))).sort(b).slice(0,3),E=((e,t)=>{var o;const i=null===(o=t.find((e=>e.entities.length>0)))||void 0===o?void 0:o.entityType,n=i&&!e.some((e=>e.entityType!=i));return n&&l.tG.info(509662157,l.nh.WorkflowDefault,"Best Match results suppressed"),n})(I,T)}S(520135894,(null==a?void 0:a.conversationId)===(null==k?void 0:k.conversationId),"Unexpected mismatch of conversation id in ranker"),S(520135893,(null==a?void 0:a.logicalId)===(null==k?void 0:k.logicalId),"Unexpected mismatch of logical id in ranker"),x=new n.c$({conversationId:null!=C?C:"",entityResults:T,logicalId:null!=w?w:"",status:0===T.length?r.i.NoResults:r.i.Success,treatments:new n.Fe({bestMatchEntries:E?[]:I})})}var _;return t.setDataFields({entityCount:(_=[x],_.reduce(((e,t)=>{var o;return e+((null===(o=t.entityResults)||void 0===o?void 0:o.reduce(((e,t)=>{var o;return e+((null===(o=t.entities)||void 0===o?void 0:o.length)||0)}),0))||0)}),0).toString())}),x}getDeDupedEntityList(e,t){const o=[],i=new Set;for(let t=0;t<e.length;++t){const n=e[t],r=n.text.toLocaleLowerCase();i.has(r)||(i.add(r),o.push(n))}for(let e=0;e<t.length;++e){const n=t[e];i.has(n.text.toLocaleLowerCase())||o.push(n)}return o}getMergedModelInfo(e,t){return{elapsedTime:Math.max(e.elapsedTime,t.elapsedTime),name:`${e.name}|${t.name}`,version:`${e.version}|${t.version}`}}}const w=()=>new C,k=(e,t)=>a.a.create("OaClientServerEccResultRanker").setCollectionScopeType(s.Cg.getTypeName()).setInputTypes(t).setOutputTypes([n.c$.getTypeName()]).setMaxAnnotations(e).setMaxDelayTime(3400).setLambdaType(w),T=(k(2,[n.J2.getTypeName(),n.os.getTypeName()]),k(2,[n.os.getTypeName()]))},20391:(e,t,o)=>{"use strict";if(o.d(t,{K:()=>n}),3023==o.j)var i=o(76839);const n=(e,t)=>{var o,n;const r=new i.I({operationName:e,success:!0,resultDescription:"",ariaTenant:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ariaNamespace:"Oa_Client"});return r.setClientMetadata(null==t?void 0:t.clientMetadata),r.setUserContext(null==t?void 0:t.userContext),r.setDataFields({contextId:null===(n=null===(o=null==t?void 0:t.model)||void 0===o?void 0:o.scopeItem)||void 0===n?void 0:n.getContextId()}),r}},46421:(e,t,o)=>{"use strict";var i;o.d(t,{N:()=>i}),function(e){e[e.GENERIC=0]="GENERIC",e[e.OFFICE=1]="OFFICE",e[e.SVG=2]="SVG"}(i||(i={}))},23987:(e,t,o)=>{"use strict";o.d(t,{z:()=>i});const i=(0,o(48366).f)("IEditorSettingsState")},55266:(e,t,o)=>{"use strict";function i(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const o=new URL(e),i=t.trim();return o.pathname.endsWith("/")?o.pathname+=i:o.pathname=`${o.pathname}/${i}`,o.toString()}o.d(t,{W:()=>i})},78204:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(55266);function n(e,t=""){const o=null===t?e:(0,i.W)(e,t);window.open(o,"_blank","noopener,noreferrer")}},20510:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>a}),3023==o.j)var i=o(37801);if(3023==o.j)var n=o(10351);if(3023==o.j)var r=o(22411);if(3023==o.j)var s=o(57767);class a{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918409)}configureRootServices(e){e.bind(i.C).toDynamicValue((e=>{const t=e.get(s.n);return new n.t(t.defaultLocale)}))}}},43179:(e,t,o)=>{"use strict";o.d(t,{t:()=>r});var i=o(30206),n=o(48828);let r=class{setOnFeedbackIconClicked(e){this._onFeedbackIconClicked=e}feedbackIconClicked(e,t){this._onFeedbackIconClicked&&this._onFeedbackIconClicked(e,t)}};r=(0,i.__decorate)([(0,n._)()],r)},24480:(e,t,o)=>{"use strict";if(o.d(t,{cl:()=>s,nv:()=>l}),3023==o.j)var i=o(81411);if(3023==o.j)var n=o(47174);if(3023==o.j)var r=o(33800);const s=(0,o(48366).f)("HostCallbacksTransformer");class a{constructor(e,t,o,i,n,r){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=o,this.logger=i,this.clientRuntime=n,this.aggregateLogger=r}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let o=t;for(const t of e)o=t(o,this);return o},this}async build(e,t){try{const e=await this.createClientMetadata(),o=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),i=this.createRuntimeOptions();return await this.runPreRuntimeInit(e,i),await this.initClientRuntime(e,o,i),{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const o=n.h.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:o,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(o,t)}logAnnotationResultItem(e,t){var o;const i=t.body?n.h.getTypeNameFor(t.body):"unknown";null===(o=this.aggregateLogger)||void 0===o||o.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:i,operationType:e}))}async createClientMetadata(){var e,t,o,i,n,r;const s={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(i=null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.appPlatform)&&void 0!==i?i:"Online",releaseAudienceGroup:null===(n=this.hostSettings.hostMetadata)||void 0===n?void 0:n.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(r=this.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId},a=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return a&&(s.flights=a.value),s}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var o;let i;return i=(null===(o=this.hostSettings.orchestratorSettings)||void 0===o?void 0:o.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,i},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(0,r.U)(this.telemetrySink)}}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var o;(null===(o=this.hostSettings.orchestratorSettings)||void 0===o?void 0:o.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((o=>o(e,t))))}async initClientRuntime(e,t,o){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,o)}createSession(e){var t;const o=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new i.L).generate();return this.clientRuntime.createSession({docSessionId:o})}}const l=(e,t,o,i,n,r)=>new a(e,t,o,i,n,r)},38534:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>p}),3023==o.j)var i=o(70608);if(3023==o.j)var n=o(22411);if(3023==o.j)var r=o(57767);if(3023==o.j)var s=o(72098);if(3023==o.j)var a=o(76509);if(3023==o.j)var l=o(41046);if(3023==o.j)var c=o(8617);if(3023==o.j)var u=o(97042);if(3023==o.j)var d=o(96687);if(3023==o.j)var g=o(24480);const h=(0,o(48366).f)("IClientRuntime");class p{constructor(){this.imports=[u.E]}get uniqueId(){return(0,n.z)(507918289)}configureRootServices(e){var t;const o=e.get(r.n);(null===(t=o.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&o.orchestratorSettings.augLoopEndpoint&&(e.bind(h).toDynamicValue((()=>(0,d.xB)())),e.bind(i.a).toDynamicValue((e=>(t,o)=>{const i=e.get(r.n),n=e.get(c.o),u=e.get(s.qy),d=e.get(a.g),p=e.getOptional(l.v),f=e.get(h),m=(0,g.nv)(i,n,u,d,f,p),v=e.getAll(g.cl);return m.withHostCallbacksCustomizations(v),m.build(t,o)})))}}},34139:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>c}),3023==o.j)var i=o(22411);if(3023==o.j)var n=o(57767);if(3023==o.j)var r=o(48935);if(3023==o.j)var s=o(8013);if(3023==o.j)var a=o(37337);if(3023==o.j)var l=o(62460);class c{constructor(){this.imports=[a.g]}get uniqueId(){return(0,i.z)(507918402)}configureRootServices(e){e.bind(s.R9).toDynamicValue((e=>{const t=e.get(n.n);return new s.R9({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(r.S).to(l.M)}}},33800:(e,t,o)=>{"use strict";o.d(t,{U:()=>r});const i="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",n=(e,t)=>{const o=[];for(const n of Object.keys(e)){if(void 0===e[n]||null===e[n])continue;const r={name:t?`${t}.${n}`:n,dataType:(i=e[n],"string"==typeof i?0:"boolean"==typeof i?1:"number"==typeof i?2:0),value:e[n],classification:4};o.push(r)}var i;return o};function r(e){return(t,o,r,s,a,l,c,u)=>{const d=t===i;let g,h=n(r);if(s){let e=n(a,s.split(".").slice(-1)[0]);d&&(e=[...e,...h],h=[]),g={name:s,dataFields:e}}const p={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:o,dataFields:h,eventFlags:{dataCategories:c,diagnosticLevel:u},eventContract:g};e.sendTelemetryEvent(p)}}},62460:(e,t,o)=>{"use strict";o.d(t,{M:()=>h});var i=o(30206),n=o(55077),r=o(33081),s=o(57767),a=o(76509),l=o(14996),c=o(8013),u=o(48828),d=o(90424),g=o(82784);let h=class{constructor(e,t,o,i,n,r){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=o,this._hostSettings=i,this._logger=n,this._sessionContextProvider=r}async initialize(){this._hostEmitter.on(n.pD.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const o=await this._sessionContextProvider();return o.sessionId&&(this._editorService.xUserSessionId=o.sessionId),o.composeSessionId&&(this._editorService.xUserComposeSessionId=o.composeSessionId),function(e,t,o){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let i=g.G_.NoLicense;t?i=g.G_.Subscription:o&&(i=o),null==e||e.push({name:"LicenseType",value:i})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};h=(0,i.__decorate)([(0,u._)(),(0,i.__param)(0,(0,d.W)(r.e)),(0,i.__param)(1,(0,d.W)(n.M5)),(0,i.__param)(2,(0,d.W)(c.R9)),(0,i.__param)(3,(0,d.W)(s.n)),(0,i.__param)(4,(0,d.W)(a.g)),(0,i.__param)(5,(0,d.W)(l.a))],h)},17916:(e,t,o)=>{"use strict";o.d(t,{u:()=>c});var i=o(95734),n=o(97069),r=o(93261),s=o(71866),a=o(12470);const l=(0,n.F5)({stateStore:r.A.on(s.JY),featureFlagsReader:r.A.on(a.c)}),c=()=>{const{featureFlagsReader:e,stateStore:t}=(0,n.KN)(l),[o,r]=i.useState(void 0);return i.useEffect((()=>(t.subscribe("stateUpdated",r),()=>{t.unsubscribe("stateUpdated",r)})),[t]),o?i.createElement(u,{enableAriaStatusInNonRootIFrames:e.flags.enableAriaStatusInNonRootIFrames,politeUpdates:o.politeUpdates,assertiveUpdates:o.assertiveUpdates,status:o.status,statusSeverity:o.statusSeverity}):null},u=e=>{const{enableAriaStatusInNonRootIFrames:t,politeUpdates:o,assertiveUpdates:n,status:r,statusSeverity:s}=e,a={width:0,height:0,color:"transparent",background:"none",border:"none",outline:"none",overflow:"hidden",pointerEvents:"none"};return window.self===window.top||t?i.createElement(i.Fragment,null,r&&i.createElement("div",{role:"status","aria-live":s,"aria-label":r,style:a}),0!==n.length&&i.createElement("div",{role:"log","aria-live":"assertive",style:a},n),0!==o.length&&i.createElement("div",{role:"log","aria-live":"polite",style:a},o)):null}},91139:(e,t,o)=>{"use strict";o.d(t,{Jx:()=>i,XG:()=>d,mU:()=>u});var i,n=o(30206),r=o(87333),s=o(71866),a=o(48366),l=o(48828),c=o(90424);!function(e){e[e.KeepOriginal=0]="KeepOriginal",e[e.AutoCorrectAppearance=1]="AutoCorrectAppearance",e[e.AutoCorrectHover=2]="AutoCorrectHover",e[e.SingleIssueOnLine=3]="SingleIssueOnLine",e[e.IssuesOnLine=4]="IssuesOnLine"}(i||(i={}));const u=(0,a.f)("IAriaStatusUniqueProxy");let d=class{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.existingCritiques=new Set,this.completeStatusMessage=(e,t)=>{const o=this.getMessageKey(t);if(!o)return e;let n=this.localizer.getMessage(o,e);return t===i.AutoCorrectHover&&(n=`${n} ${this.localizer.getMessage("ebx_autoCorrectedKeyboardAccess")}`),n},this.getMessageKey=e=>e===i.AutoCorrectAppearance||e===i.AutoCorrectHover?"ebx_autoCorrected":e===i.SingleIssueOnLine?"ebx_issuesOnLineSingular":e===i.IssuesOnLine?"ebx_issuesOnLinePlural":void 0}setStatus(e,t,o=!1,i,n){if(i&&o){if(this.existingCritiques.has(i))return;this.existingCritiques.add(i)}const r=void 0===n?e:this.completeStatusMessage(e,n);this.ariaStatusStateStore.setStatus(r,t,o)}addPreservedStatuses(e,t){const o=e.filter((e=>{const t=this.existingCritiques.has(e.id);return t||this.existingCritiques.add(e.id),!t})).map((e=>void 0===e.messageKind?e.text:this.completeStatusMessage(e.text,e.messageKind)));this.ariaStatusStateStore.addPreservedStatuses([o.join(". ")],t)}setLineNavStatus(e,t,o){e<1||this.setStatus(e.toLocaleString(),t,o,void 0,1===e?i.SingleIssueOnLine:i.IssuesOnLine)}};d=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,c.W)(s.JY)),(0,n.__param)(1,(0,c.W)(r.H))],d)},12378:(e,t,o)=>{"use strict";o.d(t,{v:()=>p});var i=o(97069),n=o(93261),r=o(318),s=o(57767),a=o(31702),l=o(20694),c=o(73900),u=o(47632),d=o(30862),g=o(95734);const h=(0,i.F5)({languageScriptDirectionDetector:n.A.on(r.iw).optional(),hostSettings:n.A.on(s.n).optional(),targetWindow:n.A.on(a.sh).optional()}),p=g.forwardRef(((e,t)=>{var o,n,r,s;const{hostSettings:a,languageScriptDirectionDetector:p,targetWindow:f}=(0,i.SM)(h),m=g.useRef(null),v=(null===(o=e.popover)||void 0===o?void 0:o.positioning).target;return g.useImperativeHandle(t,(()=>({getElementRef:()=>m}))),g.useEffect((()=>{var t;return null===(t=null==a?void 0:a.onCalloutOpened)||void 0===t||t.call(a,null,v,void 0),e.moveFocusIntoModalizer&&setTimeout((()=>{var e,t,o,i;const n=(0,d.OT)(null!==(e=null==f?void 0:f.deref())&&void 0!==e?e:window),r=m.current?null===(i=null===(o=null===(t=null==n?void 0:n.core)||void 0===t?void 0:t.storageEntry)||void 0===o?void 0:o.call(t,m.current))||void 0===i?void 0:i.tabster:void 0;n&&(null==r?void 0:r.modalizer)&&(0,d.Az)(n).setActive(r.modalizer)}),0),()=>{var e;null===(e=null==a?void 0:a.onCalloutClosed)||void 0===e||e.call(a,null,v,void 0)}}),[a,e.moveFocusIntoModalizer,v]),g.createElement(l.A,Object.assign({},e.popover),g.createElement(c.H,Object.assign({},e.surface,{ref:m,dir:null==p?void 0:p.dir(),role:null===(n=e.popover)||void 0===n?void 0:n.ariaRole,"aria-label":null===(r=e.popover)||void 0===r?void 0:r.ariaLabel,"aria-labelledby":null===(s=e.popover)||void 0===s?void 0:s.ariaLabelledBy}),void 0===p?e.children:g.createElement(u.K,{rtl:p.isRtl()},e.children)))}))},35612:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=(0,o(48366).f)("ICritiqueCalloutStateStoreBase")},76706:(e,t,o)=>{"use strict";o.d(t,{x:()=>i});const i=(0,o(48366).f)("IUndoCalloutStateStoreBase")},75362:(e,t,o)=>{"use strict";o.d(t,{D:()=>r,Y:()=>i});var i,n=o(48366);!function(e){e.critique="critique",e.inlineSuggestions="inlineSuggestions",e.languageAutoDetection="languageAutoDetection"}(i||(i={}));const r=(0,n.f)("IFooterFreStore")},36340:(e,t,o)=>{"use strict";if(o.d(t,{J:()=>r}),3023==o.j)var i=o(57568);const n=3023==o.j?'[\\.\\:\\;\\,\\s-_\\(\\)\\/\\"\\u2018\\u2019\\u201c\\u201d\\xab\\xbb\\!\\?\\#\\&\\+\\¤\\<\\>\\@\\+\\=\\xa1\\xbf\\xaa\\xba]':null;function r(e,t,o,n){if(t){const r=e.map((e=>(0,i.S)(e))),l=(0,i.S)(t);return 1===e.length&&""===e[0]?[]:function(e,t,o,i){let n;t=t.toUpperCase();const r={};for(const o of e){if(!o)continue;const e=i(o.toUpperCase());for(;n=e.exec(t);)a(o,n,r)}const s=function(e,t){const o=[];for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&o.push({offset:parseInt(i,10),word:e[i],propertyHit:t});return o.sort(((e,t)=>t.offset-e.offset))}(r,o);return s.length&&function(e,t){let o=e[e.length-1].offset+e[e.length-1].word.length;for(let i=e.length-2;i>=0;i--){const n=e[i].offset+e[i].word.length-1;e[i].offset<o?n>o?e[i].offset<o&&(e[i].word=t.substring(o,e[i].offset+e[i].word.length),e[i].offset=o):e.splice(i,1):o=n}}(s,t),s}(r,l,o,n||s)}return[]}function s(e){return new RegExp("(^|"+n+")"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"ig")}function a(e,t,o){var i;const n=(null===(i=t[1])||void 0===i?void 0:i.length)?t.index+t[1].length:t.index;(!o[n]||o[n].length<e.length)&&(o[n]=e)}},57568:(e,t,o)=>{"use strict";function i(e){if(null===r&&function(){r={};for(const e in s)r[e]=new RegExp("["+s[e]+"]","g")}(),e&&!function(e){null===n&&function(){let e="[";for(const t in s)e+=s[t];e+="]",n=new RegExp(e)}();return!(null==n?void 0:n.test(e.toLowerCase()))}(e))for(const t in r)e=e.replace(r[t],t);return e}o.d(t,{S:()=>i});let n=null,r=null;const s={a:"AÀÁÂÃÄÅàáâãäåĀāĂăĄąǍǎǞǟǠǡǺǻȀȁȂȃȦȧᴀḀḁẠạẢảẤấẦầẨẩẪẫẬậẮắẰằẲẳẴẵẶặÅⒶⓐＡ",b:"BƀƁƂƃɃʙḂḃḄḅḆḇⒷⓑＢ",c:"CÇçĆćĈĉĊċČčƇƈᴄḈḉⒸⓒＣ",d:"DÐðĎďĐđƉƊƋƌȡᴅḊḋḌḍḎḏḐḑḒḓⒹⓓＤ",e:"EÈÉÊËèéêëĒēĔĕĖėĘęĚěȄȅȆȇȨȩᴇḔḕḖḗḘḙḚḛḜḝẸẹẺẻẼẽẾếỀềỂểỄễỆệⒺⓔＥ",f:"FƑƒḞḟⒻⓕＦ",g:"GĜĝĞğĠġĢģƓǤǥǦǧǴǵɢḠḡⒼⓖＧ",h:"HĤĥĦħȞȟʜʰḢḣḤḥḨḩḪḫẖⒽⓗＨ",i:"IÌÍÎÏìíîïĨĩĪīĬĭĮįİıƗǏǐȈȉȊȋɪḬḭḮḯỈỉỊịⒾⓘＩ",j:"JĴĵǰʲᴊⒿⓙＪ",k:"KĶķƘƙǨǩᴋḰḱḲḳḴḵKⓀⓚＫ",l:"LĹĺĻļĽľŁłƚȴȽʟḶḷḸḹḺḻḼḽⓁⓛＬ",m:"MᴍḾḿṀṁṂṃⓂⓜＭ",n:"NÑñŃńŅņŇňƝƞǸǹȠȵɴṄṅṆṇṈṉṊṋⓃⓝＮ",o:"OÒÓÔÕÖØòóôõöøŌōŎŏŐőƟƠơǑǒǪǫǬǭǾǿȌȍȎȏȪȫȬȭȮȯȰȱᴏṌṍṎṏṐṑṒṓỌọỎỏỐốỒồỔổỖỗỘộỚớỜờỞởỠỡỢợⓄⓞＯ",p:"PƤƥᴘṔṕṖṗⓅⓟＰ",q:"QⓆⓠＱ",r:"RŔŕŖŗŘřȐȑȒȓʀʳṘṙṚṛṜṝṞṟⓇⓡＲ",s:"SŚśŜŝŞşŠšſȘșṠṡṢṣṤṥṦṧṨṩẛⓈⓢＳ",t:"TŢţŤťŦŧƫƬƭƮȚțᴛṪṫṬṭṮṯṰṱⓉⓣＴ",u:"UÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųƯưǓǔǕǖǗǘǙǚǛǜȔȕȖȗᴜṲṳṴṵṶṷṸṹṺṻỤụỦủỨứỪừỬửỮữỰựⓊⓤＵ",v:"VƲᴠṼṽṾṿⓋⓥＶ",w:"WŴŵʷᴡẀẁẂẃẆẇẈẉⓌⓦＷ",x:"XƳƴẊẋⓍⓧＸ",y:"YÝýÿŶŷŸƵƶȲȳʏʸẎẏỲỳỴỵỶỷỸỹⓎⓨＹ",z:"ZŹźŻżŽžȤȥᴢẐẑẒẓẔẕⓏⓩＺ",2:"²②",3:"³③",μ:"µΜ",1:"¹①",ae:"ÆæǢǣǼǽ",th:"Þþ",ss:"ßẞ",ŋ:"Ŋ",oe:"Œœ",ƅ:"Ƅ",ɔ:"Ɔᴐ",ǝ:"Ǝ",ə:"Ə",ɛ:"Ɛ",ɣ:"Ɣ",ɩ:"Ɩ",ɯ:"Ɯ",ƣ:"Ƣ",ʀ:"Ʀ",ƨ:"Ƨ",ʃ:"Ʃ",ʊ:"Ʊ",ʒ:"ƷǮǯᴣ",ƹ:"Ƹ",ƽ:"Ƽ",ƕ:"Ƕ",ƿ:"Ƿ",ȝ:"Ȝ",ȣ:"Ȣ",ⱥ:"Ⱥ",ȼ:"Ȼ",ⱦ:"Ⱦ",ʔ:"Ɂɂ",ʉ:"Ʉ",ʌ:"Ʌ",ɇ:"Ɇ",ɉ:"Ɉ",ɋ:"Ɋ",ɍ:"Ɍ",ɏ:"Ɏ",œ:"ɶ",ɠ:"ʛ",ɦ:"ʱ",ɹ:"ʴ",ɻ:"ʵ",ʁ:"ʶ",ͱ:"Ͱ",ͳ:"Ͳ",ͷ:"Ͷ",α:"ΆΑάἀἁἂἃἄἅἆἇἈἉἊἋἌἍἎἏὰάᾀᾁᾂᾃᾄᾅᾆᾇᾈᾉᾊᾋᾌᾍᾎᾏᾰᾱᾲᾳᾴᾶᾷᾸᾹᾺΆᾼ",ε:"ΈΕέϵἐἑἒἓἔἕἘἙἚἛἜἝὲέῈΈ",η:"ΉΗήἠἡἢἣἤἥἦἧἨἩἪἫἬἭἮἯὴήᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾞᾟῂῃῄῆῇῊΉῌ",ι:"ΊΙίἰἱἲἳἴἵἶἷἸἹἺἻἼἽἾἿὶίιῐῑῖῘῙῚΊ",ο:"ΌΟόὀὁὂὃὄὅὈὉὊὋὌὍὸόῸΌ",υ:"ΎΥύϒϓϔὐὑὒὓὔὕὖὗὙὛὝὟὺύῠῡῦῨῩῪΎ",ω:"ΏΩώὠὡὢὣὤὥὦὧὨὩὪὫὬὭὮὯὼώᾠᾡᾢᾣᾤᾥᾦᾧᾨᾩᾪᾫᾬᾭᾮᾯῲῳῴῶῷῺΏῼΩ",ϊ:"ΐΪῒΐῗ",β:"Βϐ",γ:"Γᴦ",δ:"Δ",ζ:"Ζ",θ:"Θϑϴ",κ:"Κϰ",λ:"Λᴧ",ν:"Ν",ξ:"Ξ",π:"Πϖᴨ",ρ:"ΡϱᴩῤῥῬ",σ:"ΣςϹ",τ:"Τ",φ:"Φϕ",χ:"Χ",ψ:"Ψᴪ",ϋ:"Ϋΰῢΰῧ",ϙ:"Ϙ",ϛ:"Ϛ",ϝ:"Ϝ",ϟ:"Ϟ",ϡ:"Ϡ",ϣ:"Ϣ",ϥ:"Ϥ",ϧ:"Ϧ",ϩ:"Ϩ",ϫ:"Ϫ",ϭ:"Ϭ",ϯ:"Ϯ",ς:"ϲ",ϸ:"Ϸ",ϻ:"Ϻ",е:"ЀЁЕѐёӖӗ",ђ:"Ђ",г:"ЃГѓ",є:"Є",ѕ:"Ѕ",і:"І",ї:"Ї",ј:"Ј",љ:"Љ",њ:"Њ",ћ:"Ћ",к:"ЌКќ",и:"ЍИЙйѝӢӣ",у:"ЎУўӮӯӲӳ",џ:"Џ",а:"АӐӑ",б:"Б",в:"В",д:"Д",ж:"ЖӁӂ",з:"З",л:"Лᴫ",м:"М",н:"Н",о:"О",п:"П",р:"Р",с:"С",т:"Т",ф:"Ф",х:"Х",ц:"Ц",ч:"Ч",ш:"Ш",щ:"Щ",ъ:"Ъ",ы:"Ы",ь:"Ь",э:"Э",ю:"Ю",я:"Я",ѡ:"Ѡ",ѣ:"Ѣ",ѥ:"Ѥ",ѧ:"Ѧ",ѩ:"Ѩ",ѫ:"Ѫ",ѭ:"Ѭ",ѯ:"Ѯ",ѱ:"Ѱ",ѳ:"Ѳ",ѵ:"ѴѶѷ",ѹ:"Ѹ",ѻ:"Ѻ",ѽ:"Ѽ",ѿ:"Ѿ",ҁ:"Ҁ",ҋ:"Ҋ",ҍ:"Ҍ",ҏ:"Ҏ",ґ:"Ґ",ғ:"Ғ",ҕ:"Ҕ",җ:"Җ",ҙ:"Ҙ",қ:"Қ",ҝ:"Ҝ",ҟ:"Ҟ",ҡ:"Ҡ",ң:"Ң",ҥ:"Ҥ",ҧ:"Ҧ",ҩ:"Ҩ",ҫ:"Ҫ",ҭ:"Ҭ",ү:"Ү",ұ:"Ұ",ҳ:"Ҳ",ҵ:"Ҵ",ҷ:"Ҷ",ҹ:"Ҹ",һ:"Һ",ҽ:"Ҽ",ҿ:"Ҿ",ӄ:"Ӄ",ӆ:"Ӆ",ӈ:"Ӈ",ӊ:"Ӊ",ӌ:"Ӌ",ӎ:"Ӎ",ӓ:"Ӓ",ӕ:"Ӕ",ә:"Ә",ӛ:"Ӛ",ӝ:"Ӝ",ӟ:"Ӟ",ӡ:"Ӡ",ӥ:"Ӥ",ӧ:"Ӧ",ө:"Ө",ӫ:"Ӫ",ӭ:"Ӭ",ӱ:"Ӱ",ӵ:"Ӵ",ӷ:"Ӷ",ӹ:"Ӹ",ӻ:"Ӻ",ӽ:"Ӽ",ӿ:"Ӿ",ԁ:"Ԁ",ԃ:"Ԃ",ԅ:"Ԅ",ԇ:"Ԇ",ԉ:"Ԉ",ԋ:"Ԋ",ԍ:"Ԍ",ԏ:"Ԏ",ԑ:"Ԑ",ԓ:"Ԓ",ԕ:"Ԕ",ԗ:"Ԗ",ԙ:"Ԙ",ԛ:"Ԛ",ԝ:"Ԝ",ԟ:"Ԟ",ԡ:"Ԡ",ԣ:"Ԣ",ԥ:"Ԥ",ԧ:"Ԧ",ա:"Ա",բ:"Բ",գ:"Գ",դ:"Դ",ե:"Ե",զ:"Զ",է:"Է",ը:"Ը",թ:"Թ",ժ:"Ժ",ի:"Ի",լ:"Լ",խ:"Խ",ծ:"Ծ",կ:"Կ",հ:"Հ",ձ:"Ձ",ղ:"Ղ",ճ:"Ճ",մ:"Մ",յ:"Յ",ն:"Ն",շ:"Շ",ո:"Ո",չ:"Չ",պ:"Պ",ջ:"Ջ",ռ:"Ռ",ս:"Ս",վ:"Վ",տ:"Տ",ր:"Ր",ց:"Ց",ւ:"Ւ",փ:"Փ",ք:"Ք",օ:"Օ",ֆ:"Ֆ",ا:"آأإ",و:"ؤ",ي:"ئى",ه:"ة",ە:"ۀ",ہ:"ۂ",ے:"ۓ",न:"ऩ",र:"ऱ",ळ:"ऴ",क:"क़",ख:"ख़",ग:"ग़",ज:"ज़",ड:"ड़",ढ:"ढ़",फ:"फ़",य:"य़",ড:"ড়",ঢ:"ঢ়",য:"য়",ਲ:"ਲ਼",ਸ:"ਸ਼",ਖ:"ਖ਼",ਗ:"ਗ਼",ਜ:"ਜ਼",ਫ:"ਫ਼",ଡ:"ଡ଼",ଢ:"ଢ଼",ஒ:"ஔ",ག:"གྷ",ཌ:"ཌྷ",ད:"དྷ",བ:"བྷ",ཛ:"ཛྷ",ཀ:"ཀྵ",ဥ:"ဦ",ⴀ:"Ⴀ",ⴁ:"Ⴁ",ⴂ:"Ⴂ",ⴃ:"Ⴃ",ⴄ:"Ⴄ",ⴅ:"Ⴅ",ⴆ:"Ⴆ",ⴇ:"Ⴇ",ⴈ:"Ⴈ",ⴉ:"Ⴉ",ⴊ:"Ⴊ",ⴋ:"Ⴋ",ⴌ:"Ⴌ",ⴍ:"Ⴍ",ⴎ:"Ⴎ",ⴏ:"Ⴏ",ⴐ:"Ⴐ",ⴑ:"Ⴑ",ⴒ:"Ⴒ",ⴓ:"Ⴓ",ⴔ:"Ⴔ",ⴕ:"Ⴕ",ⴖ:"Ⴖ",ⴗ:"Ⴗ",ⴘ:"Ⴘ",ⴙ:"Ⴙ",ⴚ:"Ⴚ",ⴛ:"Ⴛ",ⴜ:"Ⴜ",ⴝ:"Ⴝ",ⴞ:"Ⴞ",ⴟ:"Ⴟ",ⴠ:"Ⴠ",ⴡ:"Ⴡ",ⴢ:"Ⴢ",ⴣ:"Ⴣ",ⴤ:"Ⴤ",ⴥ:"Ⴥ",æ:"ᴁ",ð:"ᴆ",ł:"ᴌ",ḧ:"Ḧ",ẅ:"Ẅ",ẍ:"Ẍ",ỻ:"Ỻ",ỽ:"Ỽ",ỿ:"Ỿ",pts:"₧",tm:"™",ⅎ:"Ⅎ",4:"④",5:"⑤",6:"⑥",7:"⑦",8:"⑧",9:"⑨",10:"⑩",11:"⑪",12:"⑫",13:"⑬",14:"⑭",15:"⑮",16:"⑯",17:"⑰",18:"⑱",19:"⑲",20:"⑳",0:"⓪",ⰰ:"Ⰰ",ⰱ:"Ⰱ",ⰲ:"Ⰲ",ⰳ:"Ⰳ",ⰴ:"Ⰴ",ⰵ:"Ⰵ",ⰶ:"Ⰶ",ⰷ:"Ⰷ",ⰸ:"Ⰸ",ⰹ:"Ⰹ",ⰺ:"Ⰺ",ⰻ:"Ⰻ",ⰼ:"Ⰼ",ⰽ:"Ⰽ",ⰾ:"Ⰾ",ⰿ:"Ⰿ",ⱀ:"Ⱀ",ⱁ:"Ⱁ",ⱂ:"Ⱂ",ⱃ:"Ⱃ",ⱄ:"Ⱄ",ⱅ:"Ⱅ",ⱆ:"Ⱆ",ⱇ:"Ⱇ",ⱈ:"Ⱈ",ⱉ:"Ⱉ",ⱊ:"Ⱊ",ⱋ:"Ⱋ",ⱌ:"Ⱌ",ⱍ:"Ⱍ",ⱎ:"Ⱎ",ⱏ:"Ⱏ",ⱐ:"Ⱐ",ⱑ:"Ⱑ",ⱒ:"Ⱒ",ⱓ:"Ⱓ",ⱔ:"Ⱔ",ⱕ:"Ⱕ",ⱖ:"Ⱖ",ⱗ:"Ⱗ",ⱘ:"Ⱘ",ⱙ:"Ⱙ",ⱚ:"Ⱚ",ⱛ:"Ⱛ",ⱜ:"Ⱜ",ⱝ:"Ⱝ",ⱞ:"Ⱞ",ⱡ:"Ⱡ",ɫ:"Ɫ",ᵽ:"Ᵽ",ɽ:"Ɽ",ⱨ:"Ⱨ",ⱪ:"Ⱪ",ⱬ:"Ⱬ",ɑ:"Ɑ",ɱ:"Ɱ",ɐ:"Ɐ",ⱳ:"Ⱳ",ⱶ:"Ⱶ",ȿ:"Ȿ",ɀ:"Ɀ",ⲁ:"Ⲁ",ⲃ:"Ⲃ",ⲅ:"Ⲅ",ⲇ:"Ⲇ",ⲉ:"Ⲉ",ⲋ:"Ⲋ",ⲍ:"Ⲍ",ⲏ:"Ⲏ",ⲑ:"Ⲑ",ⲓ:"Ⲓ",ⲕ:"Ⲕ",ⲗ:"Ⲗ",ⲙ:"Ⲙ",ⲛ:"Ⲛ",ⲝ:"Ⲝ",ⲟ:"Ⲟ",ⲡ:"Ⲡ",ⲣ:"Ⲣ",ⲥ:"Ⲥ",ⲧ:"Ⲧ",ⲩ:"Ⲩ",ⲫ:"Ⲫ",ⲭ:"Ⲭ",ⲯ:"Ⲯ",ⲱ:"Ⲱ",ⲳ:"Ⲳ",ⲵ:"Ⲵ",ⲷ:"Ⲷ",ⲹ:"Ⲹ",ⲻ:"Ⲻ",ⲽ:"Ⲽ",ⲿ:"Ⲿ",ⳁ:"Ⳁ",ⳃ:"Ⳃ",ⳅ:"Ⳅ",ⳇ:"Ⳇ",ⳉ:"Ⳉ",ⳋ:"Ⳋ",ⳍ:"Ⳍ",ⳏ:"Ⳏ",ⳑ:"Ⳑ",ⳓ:"Ⳓ",ⳕ:"Ⳕ",ⳗ:"Ⳗ",ⳙ:"Ⳙ",ⳛ:"Ⳛ",ⳝ:"Ⳝ",ⳟ:"Ⳟ",ⳡ:"Ⳡ",ⳣ:"Ⳣ",ブ:"ヴ",21:"㉑",22:"㉒",23:"㉓",24:"㉔",25:"㉕",26:"㉖",27:"㉗",28:"㉘",29:"㉙",30:"㉚",31:"㉛",32:"㉜",33:"㉝",34:"㉞",35:"㉟",ㄱ:"㉠",ㄴ:"㉡",ㄷ:"㉢",ㄹ:"㉣",ㅁ:"㉤",ㅂ:"㉥",ㅅ:"㉦",ㅇ:"㉧",ㅈ:"㉨",ㅊ:"㉩",ㅋ:"㉪",ㅌ:"㉫",ㅍ:"㉬",ㅎ:"㉭",가:"㉮",나:"㉯",다:"㉰",라:"㉱",마:"㉲",바:"㉳",사:"㉴",아:"㉵",자:"㉶",차:"㉷",카:"㉸",타:"㉹",파:"㉺",하:"㉻",참고:"㉼",주의:"㉽",우:"㉾",一:"㊀",二:"㊁",三:"㊂",四:"㊃",五:"㊄",六:"㊅",七:"㊆",八:"㊇",九:"㊈",十:"㊉",月:"㊊",火:"㊋",水:"㊌",木:"㊍",金:"㊎",土:"㊏",日:"㊐",株:"㊑",有:"㊒",社:"㊓",名:"㊔",特:"㊕",財:"㊖",祝:"㊗",労:"㊘",秘:"㊙",男:"㊚",女:"㊛",適:"㊜",優:"㊝",印:"㊞",注:"㊟",項:"㊠",休:"㊡",写:"㊢",正:"㊣",上:"㊤",中:"㊥",下:"㊦",左:"㊧",右:"㊨",医:"㊩",宗:"㊪",学:"㊫",監:"㊬",企:"㊭",資:"㊮",協:"㊯",夜:"㊰",36:"㊱",37:"㊲",38:"㊳",39:"㊴",40:"㊵",41:"㊶",42:"㊷",43:"㊸",44:"㊹",45:"㊺",46:"㊻",47:"㊼",48:"㊽",49:"㊾",50:"㊿","1月":"㋀","2月":"㋁","3月":"㋂","4月":"㋃","5月":"㋄","6月":"㋅","7月":"㋆","8月":"㋇","9月":"㋈","10月":"㋉","11月":"㋊","12月":"㋋",hg:"㋌",erg:"㋍",ev:"㋎",ltd:"㋏",ア:"㋐",イ:"㋑",ウ:"㋒",エ:"㋓",オ:"㋔",カ:"㋕",キ:"㋖",ク:"㋗",ケ:"㋘",コ:"㋙",サ:"㋚",シ:"㋛",ス:"㋜",セ:"㋝",ソ:"㋞",タ:"㋟",チ:"㋠",ツ:"㋡",テ:"㋢",ト:"㋣",ナ:"㋤",ニ:"㋥",ヌ:"㋦",ネ:"㋧",ノ:"㋨",ハ:"㋩",ヒ:"㋪",フ:"㋫",ヘ:"㋬",ホ:"㋭",マ:"㋮",ミ:"㋯",ム:"㋰",メ:"㋱",モ:"㋲",ヤ:"㋳",ユ:"㋴",ヨ:"㋵",ラ:"㋶",リ:"㋷",ル:"㋸",レ:"㋹",ロ:"㋺",ワ:"㋻",ヰ:"㋼",ヱ:"㋽",ヲ:"㋾",アパート:"㌀",アルファ:"㌁",アンペア:"㌂",アール:"㌃",イニング:"㌄",インチ:"㌅",ウォン:"㌆",エスクード:"㌇",エーカー:"㌈",オンス:"㌉",オーム:"㌊",カイリ:"㌋",カラット:"㌌",カロリー:"㌍",ガロン:"㌎",ガンマ:"㌏",ギガ:"㌐",ギニー:"㌑",キュリー:"㌒",ギルダー:"㌓",キロ:"㌔",キログラム:"㌕",キロメートル:"㌖",キロワット:"㌗",グラム:"㌘",グラムトン:"㌙",クルゼイロ:"㌚",クローネ:"㌛",ケース:"㌜",コルナ:"㌝",コーポ:"㌞",サイクル:"㌟",サンチーム:"㌠",シリング:"㌡",センチ:"㌢",セント:"㌣",ダース:"㌤",デシ:"㌥",ドル:"㌦",トン:"㌧",ナノ:"㌨",ノット:"㌩",ハイツ:"㌪",パーセント:"㌫",パーツ:"㌬",バーレル:"㌭",ピアストル:"㌮",ピクル:"㌯",ピコ:"㌰",ビル:"㌱",ファラッド:"㌲",フィート:"㌳",ブッシェル:"㌴",フラン:"㌵",ヘクタール:"㌶",ペソ:"㌷",ペニヒ:"㌸",ヘルツ:"㌹",ペンス:"㌺",ページ:"㌻",ベータ:"㌼",ポイント:"㌽",ボルト:"㌾",ホン:"㌿",ポンド:"㍀",ホール:"㍁",ホーン:"㍂",マイクロ:"㍃",マイル:"㍄",マッハ:"㍅",マルク:"㍆",マンション:"㍇",ミクロン:"㍈",ミリ:"㍉",ミリバール:"㍊",メガ:"㍋",メガトン:"㍌",メートル:"㍍",ヤード:"㍎",ヤール:"㍏",ユアン:"㍐",リットル:"㍑",リラ:"㍒",ルピー:"㍓",ルーブル:"㍔",レム:"㍕",レントゲン:"㍖",ワット:"㍗","0点":"㍘","1点":"㍙","2点":"㍚","3点":"㍛","4点":"㍜","5点":"㍝","6点":"㍞","7点":"㍟","8点":"㍠","9点":"㍡","10点":"㍢","11点":"㍣","12点":"㍤","13点":"㍥","14点":"㍦","15点":"㍧","16点":"㍨","17点":"㍩","18点":"㍪","19点":"㍫","20点":"㍬","21点":"㍭","22点":"㍮","23点":"㍯","24点":"㍰",hpa:"㍱",da:"㍲",au:"㍳",bar:"㍴",ov:"㍵",pc:"㍶",dm:"㍷",dm2:"㍸",dm3:"㍹",iu:"㍺",平成:"㍻",昭和:"㍼",大正:"㍽",明治:"㍾",株式会社:"㍿",pa:"㎀㎩",na:"㎁",μa:"㎂",ma:"㎃",ka:"㎄",kb:"㎅",mb:"㎆㏔",gb:"㎇",cal:"㎈",kcal:"㎉",pf:"㎊",nf:"㎋",μf:"㎌",μg:"㎍",mg:"㎎",kg:"㎏",hz:"㎐",khz:"㎑",mhz:"㎒",ghz:"㎓",thz:"㎔",μℓ:"㎕",mℓ:"㎖",dℓ:"㎗",kℓ:"㎘",fm:"㎙",nm:"㎚",μm:"㎛",mm:"㎜",cm:"㎝",km:"㎞㏎",mm2:"㎟",cm2:"㎠",m2:"㎡",km2:"㎢",mm3:"㎣",cm3:"㎤",m3:"㎥",km3:"㎦",ms:"㎧㎳",ms2:"㎨",kpa:"㎪",mpa:"㎫",gpa:"㎬",rad:"㎭",rads:"㎮",rads2:"㎯",ps:"㎰",ns:"㎱",μs:"㎲",pv:"㎴",nv:"㎵",μv:"㎶",mv:"㎷㎹",kv:"㎸",pw:"㎺",nw:"㎻",μw:"㎼",mw:"㎽㎿",kw:"㎾",kω:"㏀",mω:"㏁",am:"㏂",bq:"㏃",cc:"㏄",cd:"㏅",ckg:"㏆",co:"㏇",db:"㏈",gy:"㏉",ha:"㏊",hp:"㏋",in:"㏌",kk:"㏍",kt:"㏏",lm:"㏐",ln:"㏑",log:"㏒",lx:"㏓",mil:"㏕",mol:"㏖",ph:"㏗",pm:"㏘",ppm:"㏙",pr:"㏚",sr:"㏛",sv:"㏜",wb:"㏝","1日":"㏠","2日":"㏡","3日":"㏢","4日":"㏣","5日":"㏤","6日":"㏥","7日":"㏦","8日":"㏧","9日":"㏨","10日":"㏩","11日":"㏪","12日":"㏫","13日":"㏬","14日":"㏭","15日":"㏮","16日":"㏯","17日":"㏰","18日":"㏱","19日":"㏲","20日":"㏳","21日":"㏴","22日":"㏵","23日":"㏶","24日":"㏷","25日":"㏸","26日":"㏹","27日":"㏺","28日":"㏻","29日":"㏼","30日":"㏽","31日":"㏾",ꙁ:"Ꙁ",ꙃ:"Ꙃ",ꙅ:"Ꙅ",ꙇ:"Ꙇ",ꙉ:"Ꙉ",ꙋ:"Ꙋ",ꙍ:"Ꙍ",ꙏ:"Ꙏ",ꙑ:"Ꙑ",ꙓ:"Ꙓ",ꙕ:"Ꙕ",ꙗ:"Ꙗ",ꙙ:"Ꙙ",ꙛ:"Ꙛ",ꙝ:"Ꙝ",ꙟ:"Ꙟ",ꙣ:"Ꙣ",ꙥ:"Ꙥ",ꙧ:"Ꙧ",ꙩ:"Ꙩ",ꙫ:"Ꙫ",ꙭ:"Ꙭ",ꚁ:"Ꚁ",ꚃ:"Ꚃ",ꚅ:"Ꚅ",ꚇ:"Ꚇ",ꚉ:"Ꚉ",ꚋ:"Ꚋ",ꚍ:"Ꚍ",ꚏ:"Ꚏ",ꚑ:"Ꚑ",ꚓ:"Ꚓ",ꚕ:"Ꚕ",ꚗ:"Ꚗ",ꜣ:"Ꜣ",ꜥ:"Ꜥ",ꜧ:"Ꜧ",ꜩ:"Ꜩ",ꜫ:"Ꜫ",ꜭ:"Ꜭ",ꜯ:"Ꜯ",ꜳ:"Ꜳ",ꜵ:"Ꜵ",ꜷ:"Ꜷ",ꜹ:"Ꜹ",ꜻ:"Ꜻ",ꜽ:"Ꜽ",ꜿ:"Ꜿ",ꝁ:"Ꝁ",ꝃ:"Ꝃ",ꝅ:"Ꝅ",ꝇ:"Ꝇ",ꝉ:"Ꝉ",ꝋ:"Ꝋ",ꝍ:"Ꝍ",ꝏ:"Ꝏ",ꝑ:"Ꝑ",ꝓ:"Ꝓ",ꝕ:"Ꝕ",ꝗ:"Ꝗ",ꝙ:"Ꝙ",ꝛ:"Ꝛ",ꝝ:"Ꝝ",ꝟ:"Ꝟ",ꝡ:"Ꝡ",ꝣ:"Ꝣ",ꝥ:"Ꝥ",ꝧ:"Ꝧ",ꝩ:"Ꝩ",ꝫ:"Ꝫ",ꝭ:"Ꝭ",ꝯ:"Ꝯ",ꝺ:"Ꝺ",ꝼ:"Ꝼ",ᵹ:"Ᵹ",ꝿ:"Ꝿ",ꞁ:"Ꞁ",ꞃ:"Ꞃ",ꞅ:"Ꞅ",ꞇ:"Ꞇ",ꞌ:"Ꞌ",ꞑ:"Ꞑ",ꞡ:"Ꞡ",ꞣ:"Ꞣ",ꞥ:"Ꞥ",ꞧ:"Ꞧ",ꞩ:"Ꞩ",י:"יִיּ",ײ:"ײַ",ש:"שׁשׂשּׁשּׂשּ",א:"אַאָאּ",ב:"בּבֿ",ג:"גּ",ד:"דּ",ה:"הּ",ו:"וּוֹ",ז:"זּ",ט:"טּ",ך:"ךּ",כ:"כּכֿ",ל:"לּ",מ:"מּ",נ:"נּ",ס:"סּ",ף:"ףּ",פ:"פּפֿ",צ:"צּ",ק:"קּ",ר:"רּ",ת:"תּ"}},84124:(e,t,o)=>{"use strict";o.r(t),o.d(t,{mockInlineSuggestions:()=>r});var i=o(91519),n=o(44010);const r=[{entities:[{entityType:i.c.People,Id:"0",text:"Annie Reid",EmailAddresses:["areid@microsoft.com"],confidence:0},{entityType:i.c.People,Id:"0",text:"Ed Taylor",EmailAddresses:["et@microsoft.com"],confidence:0},{entityType:i.c.People,Id:"0",text:"Clippy",EmailAddresses:["clippy@microsoft.com"],confidence:0}],entityType:i.c.People},{entities:[{entityType:i.c.File,Id:"0",FileSourceType:"Unknown",text:"Feature Spec",FileName:"Feature Spec",FileExtension:"Docx",FileSize:1e3,AccessUrl:"mockFile.gg/FeatureSpec",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"1",FileSourceType:"Unknown",text:"Planning Deck",FileName:"Planning Deck",FileExtension:"pptx",FileSize:1e3,AccessUrl:"mockFile.gg/PlanningDeck",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",isBestMatch:!0,confidence:0},{entityType:i.c.File,Id:"2",FileSourceType:"Unknown",text:"Crunched Numbers",FileName:"Crunched Numbers",FileExtension:"xls",FileSize:1e3,AccessUrl:"mockFile.gg/CrunchedNumbers",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"3",FileSourceType:"Unknown",text:"Some Contract with a very very long name",FileName:"Some Contract with a very very long name",FileExtension:"pdf",FileSize:1e3,AccessUrl:"mockFile.gg/contract",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"4",FileSourceType:"Unknown",text:"Even more files",FileName:"Even more files",FileExtension:"txt",FileSize:1e3,AccessUrl:"mockFile.gg/txt",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0}],entityType:i.c.File},{entities:[{ContentDomainName:"People",ScopeTitle:"Insert People",ScopeDescription:"Search people in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",entityType:i.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",text:"Insert People",scopeInfo:{entityType:"People",contentSource:""},confidence:0},{ContentDomainName:"Files",ScopeTitle:"Insert Files",ScopeDescription:"Search files in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",entityType:i.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",text:"Insert Files",scopeInfo:{entityType:"File",contentSource:""},confidence:0},{ItemId:"Ci7lEZX87y1MfPYPsAnbHw",Title:"FL Desktop 2.0",Url:"https://www.figma.com/file/Ci7lEZX87y1MfPYPsAnbHw",IconUrl:"https://figmaconnector.blob.core.windows.net/assets/icons/figma-logo.svg",ContentDomainId:"nonEssFigmaConnector",Authors:[],LastModifiedDateTimeUtc:"2022-04-26T03:57:42",CreatedTimeUtc:"2022-04-26T03:57:42",Text:"FL Desktop 2.0",PropertyHits:[],ReferenceId:"e60f6f30-9164-8d5e-7451-1da86e66df64.7000.22",entityType:i.c.External,Id:"Ci7lEZX87y1MfPYPsAnbHw",text:"FL Desktop 2.0",confidence:0}],entityType:i.c.Scope},{entities:[{entityType:i.c.Loop,Id:"0",text:"Action Items",icon:{iconName:"FFXCCompleted"},confidence:0},{entityType:i.c.Loop,Id:"0",text:"Bulleted List",icon:{iconName:"FFXCBulletedList"},confidence:0},{entityType:i.c.Loop,Id:"0",text:"Checklist",icon:{iconName:"FFXCChecklist"},confidence:0}],entityType:i.c.Loop},{entities:[{entityType:i.c.MessageExtensionApp,AppId:"ExcelOnline",DisplayName:"Excel",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.1",Id:"ExcelOnline",text:"Excel",confidence:0},{entityType:i.c.MessageExtensionApp,AppId:"f12466e6-a66c-495f-86f5-135938125391",DisplayName:"Azure DevOps (Internal)",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.2",Id:"f12466e6-a66c-495f-86f5-135938125391",text:"Azure DevOps (Internal)",confidence:0}],entityType:i.c.MessageExtensionApp},{entityType:i.c.Event,entities:[{entityType:i.c.Event,confidence:1,text:"Multiday meeting",EventId:{Id:"id1"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",HasRecording:!0,isBestMatch:!0},{entityType:i.c.Event,confidence:1,text:"Sameday meeting",EventId:{Id:"id2"},Start:"2023-05-12T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",isBestMatch:!0},{entityType:i.c.Event,confidence:1,text:"Multiday all day meeting",EventId:{Id:"id3"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",IsAllDay:!0}]},{entityType:i.c.Message,entities:[{entityType:i.c.Message,confidence:1,text:"Error while running Local IIS",Subject:"Error while running Local IIS",From:{EmailAddress:{Name:"John Doe"}},ItemId:{Id:"id1"}},{entityType:i.c.Message,confidence:1,text:"RE: Enable console logging question",Subject:"RE: Enable console logging question",From:{EmailAddress:{Name:"Jane Doe"}},ItemId:{Id:"id2"}}]},{entityType:i.c.Chat,entities:[{entityType:i.c.Chat,confidence:1,text:"Group Chat",Name:"Group Chat",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4,ChatMembers:[{Id:"1",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"John Doe"}]},{entityType:i.c.Chat,confidence:1,text:"Group Chat 2",Name:"Group Chat 2",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:5,ChatMembers:[{Id:"1",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"John Doe"},{Id:"2",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"Jane Doe"}]}]},{entityType:i.c.Channel,entities:[{entityType:i.c.Channel,confidence:1,text:"Developer Channel",Name:"Developer Channel",TeamName:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entityType:i.c.Team,entities:[{entityType:i.c.Team,confidence:1,text:"Editor-SDK",Name:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entities:[{entityType:i.c.App,id:"id",Title:"Sales meetings",text:"",subtitle:"Turned on last week",imageUrl:"https://vivasales.dynamics.com/outlookaddin/manifestimages/appLogoCopilotForSales_64px.png",confidence:0},{entityType:i.c.App,Title:"Bing",subtitle:"Available on Copilot",text:"Turned on last week",imageUrl:"https://content.powerapps.com/resource/powerbiwfe/images/PowerBI96x96.c2c49fdb8eb6008a98b3.png",confidence:0}],entityType:i.c.App}]},18230:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});const i=(0,o(48366).f)("IMultilingualFreStore")},75245:(e,t,o)=>{"use strict";o.d(t,{QE:()=>m});var i=o(30206),n=o(95734),r=o(96632),s=o(71826),a=o(38693),l=o(49081),c=o(24511),u=o(15301),d=o(48828),g=o(73256);const h=function(e){return t=>{var o,i;const{critique:r,data:s,element:l,squiggleKind:c,onCallOut:d,closeCallout:g,setInitializationProgress:h,showTooltip:p,closeTooltip:f}=t,m=a.Bn.AutoCorrectSquiggle,v=t.squiggleRef||n.useRef(null),y=null!==(o=l.ownerDocument.defaultView)&&void 0!==o?o:window,b=n.useRef(0),[S,C]=n.useState(1-t.initializationProgress),w=n.useCallback((()=>t.isCaretOver||t.isMouseOver||t.isCalloutOpened),[t.isCaretOver,t.isMouseOver,t.isCalloutOpened]),k=n.useCallback((()=>w()||void 0!==S&&S>0?"ms-squiggle ms-squiggle-autocorrect-hl ":"ms-squiggle ms-squiggle-autocorrect"),[S,w]),[T,x]=n.useState(k());n.useEffect((()=>{x(k())}),[k]);const _=t.useSvgUnderline?a.fQ[m]:0,I=n.useCallback((e=>{var t;d(v.current,r,null!==(t=r.textInContext)&&void 0!==t?t:"","keyboard"===e,(()=>{}),l,c,(0,u.eO)(s),_)}),[r,s,l,_,d,c,v]),E=n.useCallback((()=>{0!==b.current&&(C(void 0),x(k()),y.clearInterval(b.current),b.current=0)}),[k,y]),A=n.useCallback((()=>g(r.traceId)),[g,r.traceId]);n.useEffect((()=>{t.openCalloutOnHover?t.isMouseOver?I("mouse"):t.isCalloutOpened||g(r.traceId):(t.isMouseOver||t.isCaretOver)&&(E(),C(void 0),x(k()))}),[t.isMouseOver,t.isCalloutOpened,t.openCalloutOnHover,I,g,r.traceId,E,k,t.isCaretOver]);const B=t.isCaretOver&&!t.isCalloutOpened;n.useEffect((()=>{B?p(c,v.current,r,"keyboard"):f(r.traceId)}),[f,r,p,c,v,B]);const R=n.useCallback((()=>{C((e=>{let t;return!e||e<.01?(t=void 0,E()):t=e-.02,r.traceId&&h(r.traceId,1-(null!=t?t:0)),t}))}),[E,r.traceId,h]);if(n.useEffect((()=>(E(),b.current=y.setInterval(R,100),()=>{E(),g(r.traceId),f(r.traceId)})),[]),null===(i=t.autoCorrectionBroker)||void 0===i?void 0:i.getAutoCorrectionIsBeingApplied(t.critique))return null;const M=t.openCalloutOnHover?void 0:()=>I("mouse");return e(Object.assign(Object.assign({},t),{patternName:m,className:T,squiggleRef:v,opacity:S,openCalloutPredicate:e=>!e.shiftKey&&!e.altKey&&"Control"===e.key,onClick:M,onNonLeftClick:A,onKeyboardEvent:()=>I("keyboard"),onEscapePress:()=>t.closeTooltip(t.critique.traceId)}))}},p=n.memo(h(s.m),c.I),f=n.memo(h(l.G),c.P);let m=class{constructor(e,t,o){this.hostSettings=e,this.featureFlagsReader=t,this.autoCorrectionBroker=o}getSquiggles(e,t,o,i){if((0,g.v4)(this.featureFlagsReader))return n.createElement(n.Fragment,null,t.map(((e,t)=>n.createElement(r.X,{key:t.toString(),autoCorrectProps:e,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings}))));{const s=((0,g.l9)(this.featureFlagsReader)||(0,g.YY)(this.featureFlagsReader))&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!0,ariaStatusUpdatesOnlyForSpellingGrammar:(0,g.YY)(this.featureFlagsReader)});return n.createElement(n.Fragment,null,s,t.map(((e,t)=>n.createElement(p,Object.assign({key:t.toString()},e,{useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey,autoCorrectionBroker:this.autoCorrectionBroker})))))}}getFormInputSquiggle(e,t,o,i){return n.createElement(f,Object.assign({key:e},t,{initializationProgress:o,setInitializationProgress:i}))}};m=(0,i.__decorate)([(0,d._)()],m)},11534:(e,t,o)=>{"use strict";o.d(t,{FY:()=>b,hJ:()=>v});var i=o(30206),n=o(95734),r=o(96632),s=o(9782),a=o(71826),l=o(87063),c=o(15301),u=o(38693),d=o(49081),g=o(24511),h=o(48828),p=o(73256);const f=function(e){return t=>{var o;const{critique:i,squiggleKind:r,closeCallout:a,showTooltip:l,closeTooltip:d}=t,g=null!==(o=t.squiggleRef)&&void 0!==o?o:n.useRef(null),h=(0,u.H7)(i,!!t.isAutoCorrectionEnabled,c.Ah.critique),f=e=>{var o;const n=t.useSvgUnderline?u.fQ[h]:0;t.onCallOut(g.current,i,null!==(o=i.textInContext)&&void 0!==o?o:"","keyboard"===e,(()=>{}),t.element,c.Ah.critique,(0,c.eO)(t.data),n)},m=n.useCallback((()=>a(i.traceId)),[a,i]),v=i.typeId?"ms-squiggle-"+function(e,t){const o=Object.keys(e).filter((o=>e[o]===t));return o.length>0?o[0]:null}(s.L9,i.typeId):void 0,y=`ms-squiggle ms-squiggle-${i.priority} ${v} ${t.isCalloutOpened||t.isHighlighted?"hl":""} ${t.stealth?"stealth":""}`,b=t.isMouseOver?"mouse":t.isCaretOver?"keyboard":void 0,S=b&&!t.isCalloutOpened;return n.useEffect((()=>{S?l(r,g.current,i,b):d(i.traceId)}),[i,S,g,b,l,r,d]),n.useEffect((()=>()=>{d(i.traceId)}),[d,i]),e(Object.assign(Object.assign({},t),{patternName:h,className:y,squiggleRef:g,openCalloutPredicate:e=>(0,p.iN)()||t.useAltHotkey?!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key:!e.shiftKey&&!e.ctrlKey&&e.altKey&&"ArrowDown"===e.key,onKeyboardEvent:()=>f("keyboard"),onClick:()=>f("mouse"),onContextMenuClick:()=>{d(i.traceId,!0)},onNonLeftClick:m,onEscapePress:()=>d(i.traceId)}))}},m=n.memo(f(a.m),g.I),v=n.memo(f(l.z),g.I),y=n.memo(f(d.G),g.P);let b=class{constructor(e,t){this.hostSettings=e,this.featureFlagsReader=t}getSquiggles(e,t,o,i){if((0,p.v4)(this.featureFlagsReader))return n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!1,ariaStatusUpdatesOnlyForSpellingGrammar:!1});{const s=((0,p.l9)(this.featureFlagsReader)||(0,p.YY)(this.featureFlagsReader))&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!0,ariaStatusUpdatesOnlyForSpellingGrammar:(0,p.YY)(this.featureFlagsReader)});return n.createElement(n.Fragment,null,s,t.map((e=>n.createElement(m,Object.assign({key:e.id},e,{isAutoCorrectionEnabled:this.hostSettings.enableAutoCorrect,squiggleKind:c.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,o,i){return n.createElement(y,Object.assign({key:e},t,{squiggleKind:c.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey}))}};b=(0,i.__decorate)([(0,h._)()],b)},62070:(e,t,o)=>{"use strict";o.d(t,{g:()=>i});const i=(0,o(48366).f)("ISquigglerUXFactory")},24511:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n,P:()=>r}),3023==o.j)var i=o(20712);function n(e,t){const o=e.stealth===t.stealth,n=e.isHighlighted===t.isHighlighted,r=e.isCaretOver===t.isCaretOver,s=e.isMouseOver===t.isMouseOver,a=e.isCalloutOpened===t.isCalloutOpened,l=(0,i.a)(e.data.clientRect,t.data.clientRect);return r&&s&&a&&l&&n&&o}function r(e,t){const o=e.isHighlighted===t.isHighlighted,i=e.isCaretOver===t.isCaretOver,n=e.isMouseOver===t.isMouseOver,r=e.isCalloutOpened===t.isCalloutOpened,s=e.data.start===t.data.start,a=e.data.end===t.data.end,l=e.data.text===t.data.text,c=e.data.overlayCss.height===t.data.overlayCss.height,u=e.data.overlayCss.width===t.data.overlayCss.width;return r&&i&&a&&c&&u&&n&&s&&l&&o}},96632:(e,t,o)=>{"use strict";if(o.d(t,{X:()=>d,u:()=>g}),3023==o.j)var i=o(11534);var n=o(97069),r=o(93261);if(3023==o.j)var s=o(15301);if(3023==o.j)var a=o(38693);var l=o(31702),c=o(95734);const u=(0,n.F5)({targetWindow:r.A.on(l.sh)}),d=e=>{const{targetWindow:t}=(0,n.KN)(u),{autoCorrectProps:o}=e,{critique:i,initializationProgress:r}=o,s=c.useRef(0),[a,l]=c.useState(1-r);return c.useEffect((()=>{const e=()=>{var e;0!==s.current&&(null===(e=t.deref())||void 0===e||e.clearInterval(s.current),s.current=0)},n=()=>{l((t=>t<.01?(e(),0):t-.02)),i.traceId&&o.setInitializationProgress(i.traceId,1-a)};return(()=>{if(a>0){e();const o=t.deref();o&&(s.current=o.setInterval(n,100))}})(),()=>{e()}}),[o,i.traceId,a,t]),c.createElement(g,Object.assign({},e,{squigglerId:o.id,squigglesProps:[o],opacity:a,isAutoCorrection:!0,ariaStatusUpdatesOnly:!1,ariaStatusUpdatesOnlyForSpellingGrammar:!1}))},g=e=>{var t;const{squigglerId:o,squigglesProps:n,theme:r,forcedHighContrast:l,opacity:u,hostSettings:d,isAutoCorrection:g,ariaStatusUpdatesOnly:f,ariaStatusUpdatesOnlyForSpellingGrammar:m}=e,v=CSS.highlights;if(!v)return null;for(const e in a.Bn){const t=a.Bn[e];g===(t===a.Bn.AutoCorrectSquiggle)&&(v.delete(h(t,o,!1)),v.delete(h(t,o,!0)))}const y=new Map,b=[];for(const e of n){const i=(0,a.H7)(e.critique,!!d.enableAutoCorrect,e.squiggleKind),n=h(i,o,!1),r=h(i,o,e.isHighlighted),l=null!==(t=y.get(r))&&void 0!==t?t:new Highlight;switch(i){case"SpellingSquiggle":if(m&&(e.squiggleKind===s.Ah.autocorrection||e.squiggleKind===s.Ah.personalizedAutocorrection))continue;l.type="spelling-error";break;case"GrammarSquiggle":l.type="grammar-error";break;default:if(m)continue;l.type="highlight"}l.add(e.data.range),y.set(r,l),b.push([n,i,u])}for(const[e,t]of y)v.set(e,t);return f?c.createElement(c.Fragment,null):c.createElement(c.Fragment,null,n.map(((e,t)=>c.createElement(i.hJ,Object.assign({key:t.toString()},e,{squiggleKind:s.Ah.critique,useAltHotkey:!!d.useAlternativeSquiggleHotkey})))),c.createElement("style",null,"@media not print {\n        ",b.map((e=>{const[t,o,i]=e,n=e=>l?"highlight":e;let s="",c="";switch(o){case a.Bn.SpellingSquiggle:s=`text-decoration: ${n(r.highPriorityColors.tile)} wavy underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 1px;\n                   text-underline-offset: 0px;`,c=`background-color: ${n(r.highPriorityColors.highlight)};`;break;case a.Bn.GrammarSquiggle:s=`text-decoration: ${n(r.mediumPriorityColors.tile)} double underline;\n                   text-decoration-skip-ink: none;\n                   text-underline-offset: 0.5px;`,c=`background-color: ${n(r.mediumPriorityColors.highlight)};`;break;case a.Bn.AdvancedSquiggle:s=`text-decoration: ${n(r.lowPriorityColors.tile)} dashed underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 2px;`,c=`background-color: ${n(r.lowPriorityColors.highlight)};`;break;case a.Bn.CIQFlagSquiggle:s=`text-decoration: ${n(r.ciqFlagColors.tile)} dotted underline;\n                   text-decoration-skip-ink: none;\n                   text-underline-offset: 1px;\n                   text-decoration-thickness: 3px;`,c=`background-color: ${n(r.ciqFlagColors.highlight)};`;break;case a.Bn.HeadingDetectionSquiggle:s=`text-decoration: ${n(r.headingDetectionColors.tile)} dashed underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 2px;`,c=`background-color: ${n(r.headingDetectionColors.highlight)};`;break;case a.Bn.AutoCorrectSquiggle:s=`text-decoration: ${n(p(r.autoCorrectColors.tile,i))} solid underline;\n                    background-color: ${n(p(r.autoCorrectColors.highlight,i))};\n                    text-decoration-skip-ink: none;\n                    text-underline-offset: 1px;\n                    text-decoration-thickness: 1px;`,c=`text-decoration: ${n(r.autoCorrectColors.tile)} solid underline;\n                background-color: ${n(r.autoCorrectColors.highlight)};`}return`\n            ::highlight(${t}) {\n              ${s}\n            }\n            ::highlight(${t}-hl) {\n              ${s}\n              ${c}\n            }\n            `})),"}"))};function h(e,t,o){return e+"-"+t+(o?"-hl":"")}const p=(e,t)=>{const o=Math.max(0,Math.min(1,t));if(7===e.length)return e+Math.floor(255*o).toString(16).padStart(2,"0");{const t=parseInt(e.slice(-2),16)/255,i=Math.floor(o*t*255).toString(16).padStart(2,"0");return e.slice(0,-2)+i}}},67366:(e,t,o)=>{"use strict";o.d(t,{M:()=>r});var i=o(95734);if(3023==o.j)var n=o(46546);const r=e=>{const[t,o]=i.useState(0),r=i.useRef([]);i.useEffect((()=>(0,n.observe)(e.map,(e=>{r.current.push(e.name),o((e=>e+1))}))),[e.map]);const a=r.current;return r.current=[],i.createElement(i.Fragment,null,Array.from(e.map).map((([t,o])=>i.createElement(s,{key:t,id:t,value:o,changedReferences:a,renderEntry:e.renderEntry}))))},s=i.memo((e=>e.renderEntry(e.id,e.value)),((e,t)=>e.id===t.id&&t.changedReferences.length>0&&!t.changedReferences.includes(e.id)))},14560:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>n}),3023==o.j)var i=o(60832);class n{constructor(e,t,o,i){this.calloutStateStore=e,this.inlineSuggestionsRenderer=t,this.undoCalloutStateStore=o,this.logger=i}async showFlagCritique(e){var t,o,n,r,s,a;(0,i.r3)(e.critique)?e.onApplyFlag?this.inlineSuggestionsRenderer?(await this.inlineSuggestionsRenderer.showFlag(e.critique,e.onApplyFlag,((e,t)=>{var o,i,n;t?null===(o=this.calloutStateStore)||void 0===o||o.hide():null===(i=this.calloutStateStore)||void 0===i||i.clickNoActionHide(e),null===(n=this.undoCalloutStateStore)||void 0===n||n.hide()}),e.onFlagIgnoreOnce,e.onFlagIgnoreAll,e.onDisableFlag,e.onShowFeedback,null===(r=this.calloutStateStore)||void 0===r?void 0:r.navInfo,null===(s=this.calloutStateStore)||void 0===s?void 0:s.navigate),null===(a=this.calloutStateStore)||void 0===a||a.markAsShown(e.critique,e.onDismiss)):null===(n=this.logger)||void 0===n||n.error(508909200,"Got flag callout display, but no inlineSuggestionRenderer"):null===(o=this.logger)||void 0===o||o.error(508909201,"Got flag callout display, but no function for onApplyFlag was specified"):null===(t=this.logger)||void 0===t||t.error(0,"Got a critique that is not a flag critique, but expected a flag critique")}}},71826:(e,t,o)=>{"use strict";o.d(t,{m:()=>s});var i=o(95734);if(3023==o.j)var n=o(87063);if(3023==o.j)var r=o(84872);const s=e=>{const{top:t,left:o,width:s,height:a}=e.data.clientRect,l=e.isVisible?void 0:"none";return i.createElement(i.Fragment,null,i.createElement(n.z,{anchor:e.anchor,disableCalloutOnDoubleClick:e.disableCalloutOnDoubleClick,element:e.element,isCaretOver:e.isCaretOver,isMouseOver:e.isMouseOver,isCalloutOpened:e.isCalloutOpened,onClick:e.onClick,onContextMenuClick:e.onContextMenuClick,onEscapePress:e.onEscapePress,onKeyboardEvent:e.onKeyboardEvent,onNonLeftClick:e.onNonLeftClick,openCalloutPredicate:e.openCalloutPredicate}),i.createElement("span",{role:e.role,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,ref:e.squiggleRef,className:e.className,style:{top:t,left:o,width:s,height:a,zIndex:e.data.zIndex,display:l,opacity:e.opacity}}),e.useSvgUnderline&&i.createElement(r.a,{width:s,left:o,squiggleHeight:t+a,patternName:e.patternName,className:e.className,styleOverrides:{display:l,opacity:e.opacity}}))}},87063:(e,t,o)=>{"use strict";o.d(t,{z:()=>s});var i=o(95734);if(3023==o.j)var n=o(55287);if(3023==o.j)var r=o(98141);const s=e=>{const{anchor:t,isCalloutOpened:o,disableCalloutOnDoubleClick:s,element:a,isCaretOver:l,isMouseOver:c,onClick:u,onEscapePress:d,onKeyboardEvent:g,onNonLeftClick:h,openCalloutPredicate:p}=e,f=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),m=i.useRef(null);return i.useEffect((()=>{var i;const r=t=>{var o;null===(o=e.onContextMenuClick)||void 0===o||o.call(e)},l=e=>{var t;if(c&&!o){const e=(null!==(t=a.ownerDocument.defaultView)&&void 0!==t?t:window).getSelection();e&&e.focusNode===e.anchorNode&&e.focusOffset===e.anchorOffset&&(null==u||u())}},d=e=>{o&&0!==e.button&&(null==h||h())};if(s){const e=null!==(i=a.ownerDocument.defaultView)&&void 0!==i?i:window,o=t=>{const o=t;0===o.button?1===o.detail&&(m.current=e.setTimeout(l,200)):null==h||h()},s=()=>{m.current&&(e.clearTimeout(m.current),m.current=null)},c=e=>s(),u=new n.J(t);return u.addListener("contextmenu",r),u.addListener("click",o),u.addListener("dblclick",c),u.addListener("mouseup",d),()=>{u.removeAllListeners(),s()}}{const e=new n.J(t);return e.addListener("contextmenu",r),e.addListener("click",l),e.addListener("mouseup",d),()=>{e.removeAllListeners()}}}),[t,s,a,h,c,o,u]),i.useEffect((()=>{if(l||c||o){const e=(0,r.a2)(t),i=new n.J(e),s=e=>{const t=e;l&&(null==p?void 0:p(t))&&!o?"keyup"===t.type?null==g||g():f(e):"Escape"===t.key&&"keyup"===t.type&&(null==d||d())};return i.addListener("keyup",s),o||(i.addListener("focus",f),i.addListener("blur",f),i.addListener("keydown",s)),()=>{i.removeAllListeners()}}}),[c,l,o,t,p,g,d]),null}},38693:(e,t,o)=>{"use strict";o.d(t,{Bn:()=>l,H7:()=>c,K3:()=>d,VA:()=>g,fQ:()=>u});var i=o(95734);if(3023==o.j)var n=o(9782);if(3023==o.j)var r=o(76158);if(3023==o.j)var s=o(15301);if(3023==o.j)var a=o(66932);const l={SpellingSquiggle:"SpellingSquiggle",GrammarSquiggle:"GrammarSquiggle",AdvancedSquiggle:"AdvancedSquiggle",CIQFlagSquiggle:"CIQFlagSquiggle",HeadingDetectionSquiggle:"HeadingDetectionSquiggle",AutoCorrectSquiggle:"AutoCorrectSquiggle",UnknownSquiggle:"UnknownSquiggle"};function c(e,t,o){switch(e.priority){case n.bx.High:return(0,a.MG)(e)&&t&&o!==s.Ah.critique?"AutoCorrectSquiggle":"SpellingSquiggle";case n.bx.Medium:return"GrammarSquiggle";case n.bx.Low:return"AdvancedSquiggle";case n.bx.Informational:return e.typeId===n.L9.HeadingDetection?"HeadingDetectionSquiggle":"CIQFlagSquiggle";default:return"UnknownSquiggle"}}const u={SpellingSquiggle:4,GrammarSquiggle:3,AdvancedSquiggle:2,CIQFlagSquiggle:3,HeadingDetectionSquiggle:2,AutoCorrectSquiggle:1,UnknownSquiggle:0},d={SpellingSquiggle:0,GrammarSquiggle:0,AdvancedSquiggle:0,CIQFlagSquiggle:1,HeadingDetectionSquiggle:0,AutoCorrectSquiggle:0,UnknownSquiggle:0},g=e=>{const{theme:t}=e,o="squiggleHighlightStrokeColor",n="squiggleHighlightFillColor",s=`\n      ${r.Rr} {\n        .${o} {\n          stroke: highlight;\n        }\n        .${n} {\n          fill: highlight;\n        }\n      }`;return i.createElement(i.Fragment,null,i.createElement("style",null,s),i.createElement("svg",{width:"0",height:"0",style:{position:"absolute"}},i.createElement("defs",null,i.createElement("pattern",{id:l.SpellingSquiggle,width:"5",height:u.SpellingSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("path",{d:"M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3",className:o,stroke:t.highPriorityColors.tile,strokeWidth:"1",fill:"transparent"})),i.createElement("pattern",{id:l.GrammarSquiggle,width:"5",height:u.GrammarSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round"},i.createElement("g",{className:o,stroke:t.mediumPriorityColors.tile},i.createElement("path",{d:"M0,0.5 L5,0.5"}),i.createElement("path",{d:"M0,2.5 L5,2.5"})))),i.createElement("pattern",{id:l.AdvancedSquiggle,width:"10",height:u.AdvancedSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M1,1 L5,1",className:o,stroke:t.lowPriorityColors.tile,strokeWidth:"2",strokeLinecap:"round"}))),i.createElement("pattern",{id:l.AutoCorrectSquiggle,width:"5",height:u.AutoCorrectSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none"},i.createElement("path",{d:"M0,0.5 L5,0.5",className:o,strokeWidth:"1",stroke:t.autoCorrectColors.tile}))),i.createElement("pattern",{id:l.CIQFlagSquiggle,width:"6",height:u.CIQFlagSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("circle",{cx:"1.5",cy:"1.5",r:"1.5",className:n,fill:t.ciqFlagColors.tile}))),i.createElement("pattern",{id:l.HeadingDetectionSquiggle,width:"10",height:u.HeadingDetectionSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M1,1 L5,1",className:o,stroke:t.headingDetectionColors.tile,strokeWidth:"2",strokeLinecap:"round"}))))))}},84872:(e,t,o)=>{"use strict";o.d(t,{a:()=>r});var i=o(95734);if(3023==o.j)var n=o(38693);const r=e=>{const{className:t,left:o,patternName:r,squiggleHeight:s,styleOverrides:a,width:l}=e,c=n.fQ[r],u=n.K3[r];return i.createElement("svg",{width:l,height:c,viewBox:`0 0 ${l} ${c}`,className:t,style:Object.assign({top:s?s-c+u:void 0,bottom:s?void 0:-1*(c+u),left:o,position:"absolute"},a)},i.createElement("rect",{fill:`url(#${r})`,width:l,height:c}))}},5623:(e,t,o)=>{"use strict";o.d(t,{$:()=>A});var i=o(95734),n=o(97069),r=o(93261),s=o(69849),a=o(12470),l=o(3998),c=o(19454),u=o(25808),d=o(46421),g=o(91702),h=o(62070),p=o(67366),f=o(15301),m=o(7051);const v=e=>i.createElement(p.M,{map:e.squigglerState.squigglesMap,renderEntry:(t,o)=>i.createElement(y,Object.assign({key:t,squiggles:o,anchorId:t},e))}),y=(0,m.PA)((e=>{const t=[],o=[];let n=0,r=0;for(const i of e.squiggles.values()){const s=i.filter((t=>{var o;return t.isVisible&&e.squigglerState.anchorElement&&(null===(o=e.squigglerState.hostElement)||void 0===o?void 0:o.shouldRenderSquiggle(t.data.range.startContainer,e.squigglerState.anchorElement))})),a=e.squigglerState.getSquiggleProps(s);a.length>0&&a[0].squiggleKind!==f.Ah.critique?o.push(...a):t.push(...a);for(const e of a)n=Math.max(n,e.data.clientRect.right),r=Math.max(r,e.data.clientRect.bottom)}const s=i.createElement(i.Fragment,null,i.createElement(b,Object.assign({},e,{squiggles:t,squiggleKind:f.Ah.critique})),i.createElement(b,Object.assign({},e,{squiggles:o,squiggleKind:f.Ah.autocorrection})));if(e.squigglerState.disableAutoBrowserVirtualizationOfSquiggles)return s;const a=n,l=r;return i.createElement("div",{key:e.anchorId,style:{contentVisibility:"auto",containIntrinsicSize:`${a}px ${l}px`,contain:"strict",position:"absolute",width:a,height:l}},s)})),b=(0,m.PA)((e=>{const t=e.squigglerUXFactory(e.squiggleKind);return i.createElement(i.Fragment,{key:e.squiggleKind},t.getSquiggles(e.squigglerId+e.anchorId,e.squiggles,e.theme,e.forcedHighContrast))}));var S=o(38693),C=o(73256),w=o(4984),k=o(9782),T=o(76158);const x=(e=d.N.GENERIC,t,o,i)=>{const n=function(e,t){switch(e){case d.N.OFFICE:return function(e){return`\n    span.ms-squiggle-${k.bx.High} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.spellingTile};\n    }\n\n    span.ms-squiggle-${k.bx.Medium} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.grammarTile};\n    }\n\n    span.ms-squiggle-${k.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.insightTile};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 1px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      border-image-source: ${e.autoCorrectTile};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t);case d.N.SVG:return function(e){return`\n  span.ms-squiggle-autocorrect-hl, svg.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      box-sizing: border-box;\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-autocorrect, svg.ms-squiggle-autocorrect {\n      opacity: 0%;\n    }\n  `}(t);case d.N.GENERIC:default:return function(e){return`\n    span.ms-squiggle-${k.bx.High} {\n      border-bottom: 4px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.highPriorityColors.tile};\n      border-image-source: ${e.spellingTileBorder};\n    }\n\n    span.ms-squiggle-${k.bx.Medium} {\n      border-bottom: 3px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.mediumPriorityColors.tile};\n      border-image-source: ${e.grammarTileBorder};\n    }\n\n    span.ms-squiggle-${k.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px solid;\n      border-image-slice: 0 1 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.lowPriorityColors.tile};\n      border-image-source: ${e.insightTileBorder};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-image-source: ${e.autoCorrectTileBorder};\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t)}}(e,t),r=`\n        span.ms-squiggle {\n            position: absolute;\n            border-radius: 2px;\n            border-image-repeat: repeat;\n            background-clip: content-box;\n            cursor: text;\n            pointer-events: none;\n            box-sizing: ${e===d.N.OFFICE?"content-box":"border-box"};\n        }\n\n        span.ms-squiggle.stealth, svg.ms-squiggle.stealth {\n          opacity: 0%;\n          transition: opacity 0.25s;\n        }\n\n        span.ms-squiggle.stealth.hl, svg.ms-squiggle.stealth.hl {\n          opacity: 100%;\n        }\n\n        ${n}\n        ${function(e){return`\n    span.ms-squiggle-${k.bx.High}.hl {\n      background-color: ${e.theme.highPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${k.bx.Medium}.hl {\n      background-color: ${e.theme.mediumPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${k.bx.Low}.hl:not(.ms-squiggle-TopicSuggestion.hl) {\n      background-color: ${e.theme.lowPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition.hl, .ms-squiggle-CIQFlag_DateEntityRecognition.hl, .ms-squiggle-CIQFlag_SatoriEntityRecognition.hl, .ms-squiggle-CIQFlag_Location.hl, .ms-squiggle-CIQFlag_File.hl, .ms-squiggle-CIQFlag_Time.hl, .ms-squiggle-CIQFlag_Topic.hl, .ms-squiggle-CIQFlag_TaskRecognition.hl, .ms-squiggle-TopicSuggestion.hl, .ms-squiggle-CIQFlag_LocalBusiness.hl {\n      background-color: ${e.theme.ciqFlagColors.highlight};\n    }\n\n    span.ms-squiggle-HeadingDetection.hl {\n      background-color:${e.theme.headingDetectionColors.highlight};\n    }\n  `}(t)}\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n    `,s=`\n        span.hc-noadjust {\n          -ms-high-contrast-adjust: none;\n          forced-color-adjust: none;\n        }\n\n        span.ms-squiggle {\n          forced-color-adjust:none;\n          cursor: text;\n          box-sizing: border-box;\n          pointer-events: none;\n          border-color: highlight;\n          border-image-source: none;\n          background-image: none;\n          position: absolute;\n          border-radius: 0px;\n        }\n\n        ${function(e){return e===d.N.SVG?"":`\n    span.ms-squiggle-${k.bx.High} {\n      border-bottom: 4px solid highlight;\n    }\n\n    span.ms-squiggle-${k.bx.Medium} {\n      border-bottom: 3px double highlight;\n    }\n\n    span.ms-squiggle-${k.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px dashed highlight;\n    }\n\n    span.ms-squiggle-autocorrect {\n      border-bottom: none;\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid highlight;\n    }\n  `}(e)}\n\n        span.ms-squiggle-autocorrect {\n          border-bottom: none;\n        }\n\n        span.hl {\n          outline: 2px solid highlight;\n        }\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n\n        span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition,, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n          background-image: linear-gradient(to right, #3c97dd 33%, rgba(0,0,0,0) 0%);\n          background-position: bottom;\n          background-size: 6px 2px;\n          background-repeat: repeat-x;\n        }\n    `;return o?s:i?`\n    @media not (forced-colors: active) {\n      ${r}\n    }\n    ${T.Rr} {\n      ${s}\n    }`:r};var _=o(38883),I=o(13956);const E=(0,n.F5)({featureFlagsReader:r.A.on(a.c),squigglerUXFactory:r.A.on(h.g),safeWindow:r.A.on(l.j),highConstrastModeDetector:r.A.on(g.P)});class A extends i.Component{constructor(e){super(e),this.connectSquiggler=()=>{this.squigglerEvents.connectSquiggler()},this.disconnectSquiggler=()=>{this.squigglerEvents.disconnectSquiggler()},this.setSquigglerRef=e=>{this.props.state.setSquigglerRef(e),this.squigglerEvents.updatePositionIfRelative()},this.shouldRender=()=>{var e,t;return null!==(t=null===(e=this.props.state.hostElement)||void 0===e?void 0:e.shouldRender(this.props.state.anchorElement))&&void 0!==t&&t},this.selectorRef=i.createRef();const t=new c.O(this.props.state.anchorElement?(0,u.e)(this.props.state.anchorElement):window);this.squigglerEvents=this.props.state.squigglerEventManager.createEventManager(t,this.props.state,this.props.deps.safeWindow)}componentDidUpdate(e){var t;const o=this.props.state.isVisible,i=e.state.isVisible;o?(this.props.state.reactOnComponentUpdate&&(this.squigglerEvents.updatePositionIfRelative(),this.squigglerEvents.checkHighlight()),i||this.connectSquiggler()):i&&this.disconnectSquiggler(),this.selectorRef.current&&(null===(t=this.props.state.hostElement)||void 0===t||t.squigglerUpdated(this.selectorRef.current))}async componentDidMount(){this.connectSquiggler(),await this.props.state.updateRanges(),this.squigglerEvents.checkHighlight(),this.squigglerEvents.updatePositionIfRelative()}componentWillUnmount(){this.disconnectSquiggler(),this.props.state.disconnectVisibilityTracker(),this.squigglerEvents.dispose()}render(){let e={};const{isRelativePositionEnabled:t,squiggleStyleType:o,id:n,top:r,left:s,anchorElement:a,isVisible:l,parentToRenderTo:c,hostElement:u,theme:g,scaleTransformValue:h,forcedHighContrast:p}=this.props.state;if(!a||!c||!u)return null;e=t?{pointerEvents:"none",position:"relative",flexGrow:0,msHighContrastAdjust:"none",display:"block",top:`${r}px`,left:`${s}px`}:{pointerEvents:"none",position:"absolute",msHighContrastAdjust:"none",flexGrow:0,top:`${r}px`,left:`${s}px`};const f=u.squigglerInlineStyles(a,h),m=o===d.N.SVG,y=x(o,g,p,this.props.deps.highConstrastModeDetector.browserSupportsHighContrastMode),b=i.createElement(v,{squigglerState:this.props.state,squigglerId:n,theme:g.theme,forcedHighContrast:p,squigglerUXFactory:this.props.deps.squigglerUXFactory});return(0,C.v4)(this.props.deps.featureFlagsReader)?l&&this.shouldRender()?b:null:_.createPortal(i.createElement("editor-squiggler",{"aria-hidden":this.props.state.ariaEnabled,tabindex:-1,style:{height:"0px",width:"0px"},ref:this.selectorRef},i.createElement(i.Fragment,null,i.createElement("style",null,"\n  @media print {\n    .ms-editor-squiggler {\n        display:none !important;\n    }\n  }\n  .ms-editor-squiggler {\n    all: initial;\n    display: block !important;\n    height: 0px !important;\n    width: 0px !important;\n  }"),i.createElement(I.Ay.div,{className:"ms-editor-squiggler",ref:this.setSquigglerRef,style:f},i.createElement("style",{type:"text/css"},y),m&&i.createElement(S.VA,{theme:g.theme}),i.createElement("div",{style:e},l&&this.shouldRender()&&b)))),c)}}(0,s.r)((0,w.PA)(A),E)},98141:(e,t,o)=>{"use strict";o.d(t,{a2:()=>u,pT:()=>a});var i=o(30206),n=o(55287),r=o(41131),s=o(48828);let a=class{createEventManager(e,t,o){return new c(e,t,o)}};a=(0,i.__decorate)([(0,s._)()],a);const l={passive:!1};class c{constructor(e,t,o){var i;this.targetWindowRef=e,this.state=t,this.safeWindow=o,this.isMouseWithinElement=!1,this.disconnectAdditionalHandlers=()=>null,this.connectedEventListeners=[],this.connectSquiggler=()=>{for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[];const e=this.targetWindowRef.deref();if(!e)return;const t=new n.J(e),o=new n.J(e.document);if(this.connectedEventListeners.push(t),this.connectedEventListeners.push(o),t.addListener("resize",this.reRenderDeferred,l),o.addListener("mouseup",this.onDocumentMouseUp,l),o.addListener("pointerup",this.onDocumentMouseUp,l),o.addListener("selectionchange",this.checkHighlight,l),this.state.anchorElement&&this.state.hostElement){const e=new n.J(this.state.anchorElement);if(this.connectedEventListeners.push(e),e.addListener("mouseenter",this.onMouseEnter,l),e.addListener("mouseleave",this.onMouseLeave,l),this.resizeObserver){this.resizeObserver.observe(this.state.anchorElement);for(const e of this.state.hostElement.shouldObserveSize(this.state.anchorElement))e&&this.resizeObserver.observe(e)}const t=u(this.state.anchorElement),o=new n.J(t);this.connectedEventListeners.push(o),o.addListener("input",this.onInputHandler,l),o.addListener("keyup",this.throttleKeyUp,l),this.isScrollable&&(o.addListener("scroll",this.throttleScroll,l),o.addListener("mousewheel",this.throttleScroll,l),o.addListener("touchmove",this.throttleScroll,l)),o.addListener("focusin",this.checkHighlight,l),o.addListener("focusout",this.throttleFocusOut,l),this.disconnectAdditionalHandlers=this.state.hostElement.addHandlers(this.state.anchorElement,this,this.state.proofedElements.map((e=>e.id)))}},this.disconnectSquiggler=()=>{var e;for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[],this.lastMouseMoveEvent=void 0,null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,this.disconnectAdditionalHandlers(),this.disconnectAdditionalHandlers=()=>{}},this.dispose=()=>{this.disconnectSquiggler(),this.throttledCheckCursorHighlight=void 0},this.reRender=()=>{this.state.updateRanges()},this.updatePositionIfRelative=()=>{this.requiresUpdateForRelativePosition()&&this.reRender()},this.checkHighlight=()=>{var e,t;const o=this.targetWindowRef.deref();o&&this.state.anchorElement&&(o.document.activeElement===this.state.anchorElement||this.state.anchorElement.contains(o.document.activeElement)||(null===(e=o.document.activeElement)||void 0===e?void 0:e.contains(this.state.anchorElement)))&&(this.onMouseEnter(),this.checkCaretPosition(),null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this))},this.onMouseEnter=()=>{var e;this.isMouseWithinElement=!0,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.anchorElement&&(this.mouseWithinElementEventListener=new n.J(this.state.anchorElement),this.connectedEventListeners.push(this.mouseWithinElementEventListener),this.mouseWithinElementEventListener.addListener("mousemove",this.onMouseMove,l))},this.onMouseLeave=()=>{var e;this.isMouseWithinElement=!1,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.setLastMousePosition(void 0),this.state.trivializeAllSquiggles("cursor")},this.onFocusOut=()=>{this.state.trivializeAllSquiggles("caret"),this.state.closeTooltip()},this.onInputHandler=()=>{this.onInput()},this.onInput=()=>{(this.getShouldReactToInput()||this.state.isAutoCorrectionOnly||this.requiresUpdateForRelativePosition())&&this.reRender()},this.onKeyup=e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key)?this.checkCaretPosition():("Delete"===e.key||"Backspace"===e.key||this.isTabPressed(e)||this.state.isAutoCorrectionOnly)&&this.onInput()},this.isTabPressed=e=>"Tab"===e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey,this.checkCaretPosition=()=>{var e;const t=((null===(e=this.state.anchorElement)||void 0===e?void 0:e.ownerDocument)||document).getSelection();t&&t.rangeCount>0&&this.state.updateSelectionHighlightState(t)},this.onMouseMove=e=>{var t;this.state.anchorElement&&this.isMouseWithinElement?(this.lastMouseMoveEvent=e,null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this)):this.lastMouseMoveEvent=void 0},this.checkCursorHighlight=()=>{if(this.lastMouseMoveEvent&&this.state.anchorElement){const e={x:this.lastMouseMoveEvent.clientX,y:this.lastMouseMoveEvent.clientY};this.state.setLastMousePosition(e)}this.state.updateCursorHighlightState(),this.lastMouseMoveEvent=void 0},this.onDocumentMouseUp=e=>{this.onMouseClick(e),this.reRenderDeferred()},this.onMouseClick=e=>{const{anchorElement:t,updateCursorHighlightState:o,setLastMousePosition:i}=this.state;t&&(i({x:e.clientX,y:e.clientY}),this.checkCaretPosition(),o())},this.throttleScroll=()=>{this.reRenderDeferred()},this.reRenderDeferred=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRender()),this.targetWindowRef)},this.throttleKeyUp=e=>{this.safeWindow.requestAnimationFrame((()=>this.onKeyup(e)),this.targetWindowRef)},this.throttleFocusOut=()=>{this.safeWindow.requestAnimationFrame((()=>this.onFocusOut()),this.targetWindowRef)},this.throttleUpdateOnResize=()=>{this.safeWindow.requestAnimationFrame((()=>{this.state.updatePosition(this.state.isRelativePositionEnabled),this.reRender()}),this.targetWindowRef)},this.requiresUpdateForRelativePosition=()=>{const{isRelativePositionEnabled:e}=this.state;return e&&this.state.updatePosition(e)},this.determineIfScrollable=e=>{switch(e){case"scroll":return!0;case"hidden":case"visible":return!1;default:return null}};const s=e.deref();if(s&&(this.throttledCheckCursorHighlight=(0,r.hQ)(this.safeWindow,s,this.checkCursorHighlight,"After"),this.state.anchorElement)){if(this.isScrollable=null===(i=this.state.hostElement)||void 0===i?void 0:i.isScrollable(this.state.anchorElement),void 0===this.isScrollable){const e=this.getAnchorElementComputedStyle();this.isScrollable=e&&!(!1===this.determineIfScrollable(e.overflowX)&&!1===this.determineIfScrollable(e.overflowY))}s.ResizeObserver&&(this.resizeObserver=new s.ResizeObserver((()=>this.throttleUpdateOnResize())))}}getAnchorElementComputedStyle(){var e;return this.anchorElementComputedStyle||(this.anchorElementComputedStyle=this.state.anchorElement&&(null===(e=this.targetWindowRef.deref())||void 0===e?void 0:e.getComputedStyle(this.state.anchorElement))),this.anchorElementComputedStyle}getShouldReactToInput(){if(void 0!==this.reactToOnInput)return this.reactToOnInput;const e=this.getAnchorElementComputedStyle();return this.reactToOnInput=["center","right"].includes((null==e?void 0:e.textAlign)||"")||"rtl"===(null==e?void 0:e.direction),this.reactToOnInput}}function u(e){let t=e;if("true"!==t.contentEditable&&t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(t=e)}return t}},29631:(e,t,o)=>{"use strict";o.d(t,{i:()=>pe});var i=o(30206),n=o(74711),r=o(61854),s=o(56554),a=o(5275),l=o(97569),c=o(9005),u=o(83773),d=o(91139),g=o(1845),h=o(98556),p=o(15228),f=o(67680),m=o(99654),v=o(89968),y=o(1208),b=o(55077),S=o(9782),C=o(3998),w=o(44074),k=o(57767),T=o(76509),x=o(23987),_=o(19989),I=o(6814),E=o(92049),A=o(17966),B=o(95734),R=o(46546),M=o(77251);class D{constructor(e,t,o){this.range=e,this.zIndex=o,this.originalStartContainerOfRange=e.startContainer,this.clientRect=t}isRangeInValidState(){return this.range.startContainer===this.originalStartContainerOfRange&&!this.range.collapsed}updateRange(e){e&&(this.range=e)}}class P{constructor(e,t,o,i,n,r,s,a){this.id=e,this.element=t,this.squiggleKind=o,this.critique=i,this.isVisible=n,this.stealth=r,this.data=s,this.squiggleRef=a,(0,M.Gn)(this)}updateFromRect(e,t){var o;this.isVisible!==e.visible&&(this.isVisible=e.visible),e.visible&&(this.data=new D(t,e,this.data.zIndex));const i=null!==(o=this.critique.isStealth)&&void 0!==o&&o;i!==this.stealth&&(this.stealth=i)}}(0,i.__decorate)([R.observable],P.prototype,"isVisible",void 0),(0,i.__decorate)([R.observable],P.prototype,"stealth",void 0),(0,i.__decorate)([R.observable],P.prototype,"data",void 0),(0,i.__decorate)([R.action],P.prototype,"updateFromRect",null);var N,F=o(58943),O=o(33894),j=o(78204),q=o(25808),L=o(19454),H=o(46421),z=o(45080);function W(e,t,o,i){return e&&o>=e.top&&o<=e.bottom?t>=e.left&&t<=e.right?N.direct:i&&t>=e.right-i&&t<=e.left?N.indirect:N.line:N.none}function G(e,t){if("Caret"!==t.type||!t.focusNode)return N.none;if(e.isPointInRange(t.focusNode,t.focusOffset))return N.direct;const o=e.getBoundingClientRect(),i=t.getRangeAt(0).getBoundingClientRect();return o.top<=i.top&&o.bottom>=i.bottom?N.line:N.none}function U(e,t){return!("Caret"!==t.type||!t.focusNode)&&e.isPointInRange(t.focusNode,t.focusOffset)}!function(e){e.none="none",e.direct="direct",e.line="line",e.indirect="indirect"}(N||(N={}));var V=o(73701),$=o(15301),K=o(75507),J=o(98141),Z=o(20712);function Y(e){if(!e||"auto"===e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t+1}function Q(e,t){return e.bottom>t.bottom+e.height/4||e.left>t.right||e.right<t.left||e.bottom<t.top}function X(e){if(!e)return 0;const t=parseFloat(e);return isNaN(t)?0:t}var ee=o(71793),te=o(66932),oe=o(65339),ie=o(75026);const ne=()=>!0;var re=o(12535);class se extends F.z{constructor(e,t,o,i,n,r,s,a,l,c,u,g){var h,p,f,m,v,y,b,w;super(),this.tileContent=t,this.hostSettings=o,this.proofingDom=i,this._squiggleThemeStore=n,this.critiqueApplicationHandler=r,this.critiqueRangeBuilder=s,this.autoCorrectionBroker=a,this.getIsHighContrastTheme=l,this.logger=c,this.upsellStore=u,this.editorSettingsState=g,this.diffPrecision=.01,this.isTooltipShown=!1,this.squigglesMap=new R.ObservableMap,this.autoCorrectDisabledLanguages=[],this.proofedElements=[],this.proofedElementDomRects=[],this.calloutOpenedForCritique=void 0,this.mouseHoveredElement=void 0,this.mouseIndirectlyHoveredElement=void 0,this.disabledCritiqueIdToShowTooltip=void 0,this.caretHoveredElement=void 0,this.scaleTransformValue=1,this.top=0,this.left=0,this.hadUpdateWithoutAnyValidSquiggles=!1,this.recalculateRelativePosition=()=>{this.isRelativePositionEnabledValue=this.calculateRelativePosition()},this.isVisible=!1,this.onCalloutPositionUpdated=(e,t)=>{this.isUndoCalloutAlignedRight=e,this.undoCalloutRect=t},this.setAutoCorrectLanguages=e=>{this.autoCorrectDisabledLanguages=e},this.setCritiques=async(e,t=!1)=>{var o;const i=this.proofedElements.find((t=>t.id===e.id));let n=!0;if(i){if(t){const t=e.critiques.length!==i.critiques.length||!e.critiques.every(((e,t)=>(0,O.gS)(e,i.critiques[t]))),r=(null===(o=this.squigglesMap.get(e.id))||void 0===o?void 0:o.size)!==e.critiques.length;n=t||r||this.hadUpdateWithoutAnyValidSquiggles,this.hadUpdateWithoutAnyValidSquiggles=!1}i.critiques=e.critiques}else this.proofedElements.push(e);n&&await this.updateRanges([e.id])},this.removeCritiques=async e=>{const t=this.proofedElements.findIndex((t=>t.id===e));-1!==t&&(this.squigglesMap.delete(e),this.proofedElements.splice(t,1),await this.updateRanges())},this.updateRanges=async e=>{var t;this.throttledUpdateRanges?(this.throttledUpdateRangesProofedElementsToCheck=e?[...null!==(t=this.throttledUpdateRangesProofedElementsToCheck)&&void 0!==t?t:[],...e]:void 0,await this.throttledUpdateRanges()):await this.updateRangesImmediately(e)},this.updateSquiggles=()=>{this.throttledUpdateSquiggles?this.throttledUpdateSquiggles():this.innerUpdateSquiggles()},this.setVisible=e=>{this.isVisible=e,e&&(this.cancelSetVisibleFrame(),this.setVisibleFrameRequestId=this.safeWindow.requestAnimationFrame((async()=>{await this.updateRanges()}),this.targetWindowRef))},this.setLastMousePosition=e=>{this.lastMousePosition=e},this.disconnectVisibilityTracker=()=>{var e;null===(e=this._visibilityTracker)||void 0===e||e.disconnect()},this.getCritiques=()=>this.proofedElements.reduce(((e,t)=>e.concat(t.critiques)),[]),this.showCallout=(e,t)=>{var o,i;const n=null===(o=this.targetWindowRef)||void 0===o?void 0:o.deref();if(!e.traceId||!n)return;const r=this.findSquiggle(e.traceId);if(r){const o=null!==(i=r.data.range.startContainer.parentElement)&&void 0!==i?i:r.element;this.cancelShowCalloutFrame(),this.showCalloutFrameRequestId=this.safeWindow.requestAnimationFrame((()=>{o.scrollIntoView({behavior:"auto"}),this.clearOnCalloutShownCallbackTimeout(),this.onCalloutShownCallbackTimeout=n.setTimeout((()=>{var o,i;ae(r)&&(this.onShowCallout(null!==(i=null===(o=r.squiggleRef)||void 0===o?void 0:o.current)&&void 0!==i?i:null,e,r.data.range.toString(),!0,(()=>{}),r.element,$.Ah.critique),null==t||t())}),100)}),n)}},this.updateSelectionHighlightState=e=>{let t,o=0;this.forEachCritique((i=>{var n,r;for(const s of i.squiggles){if(!s.isVisible)continue;let a=N.none;this.ariaLineNavUpdatesEnabled?a=G(s.data.range,e):U(s.data.range,e)&&(a=N.direct),a===N.direct?(this.caretHoveredCritiqueId=s.critique.traceId,(1===i.squiggles.length||this.checkSquiggleSelection(s,e))&&(this.caretHoveredElement=s.id,ae(s)&&this.showTooltipAt(s.squiggleKind,null===(n=s.squiggleRef)||void 0===n?void 0:n.current,s.critique,"keyboard")),t=s,this.caretPosition={node:e.focusNode,offset:e.focusOffset}):(this.caretHoveredElement===s.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),a===N.line&&(o+=1),this.trivializeSquiggle(s,"caret"))}})),this.updateAriaStatus(o,t)},this.updateSelectionHighlightStateFromCoordinates=e=>{let t,o=0;this.forEachCritique((i=>{var n,r;for(const s of i.squiggles){if(!s.isVisible)continue;const i=W(s.data.clientRect,e.x,e.y);i===N.direct?(this.caretHoveredCritiqueId=s.critique.traceId,this.caretHoveredElement=s.id,ae(s)&&this.showTooltipAt(s.squiggleKind,null===(n=s.squiggleRef)||void 0===n?void 0:n.current,s.critique,"keyboard",e),t=s):(i===N.line&&(o+=1),this.caretHoveredElement===s.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),this.trivializeSquiggle(s,"caret"))}})),this.updateAriaStatus(o,t)},this.startUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=t.setTimeout((()=>{this.lastMousePosition?this.setMouseIndirectlyHoveredElement(void 0):this.clearUndoCardTimeout()}),2e3))},this.clearUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=void 0)},this.isMouseWithinUndoCallout=()=>{if(!this.undoCalloutRect||!this.lastMousePosition||!this.anchorElement)return!1;const e=(e,t,o)=>e>=t&&e<=t+o;return e(this.lastMousePosition.x,this.undoCalloutRect.x,this.undoCalloutRect.width)&&e(this.lastMousePosition.y,this.undoCalloutRect.y,this.undoCalloutRect.height)},this.updateCursorHighlightState=()=>{var e;if(this.lastMousePosition&&this.anchorElement)if(null===(e=this.options)||void 0===e?void 0:e.enableCursorIntersectionObserver){const e=new IntersectionObserver((t=>{this.updateCursorHighlightStateWithAnchorBoundingBox(t[0].boundingClientRect),e.disconnect()}));e.observe(this.anchorElement)}else{const e=this.anchorElement.getBoundingClientRect();this.updateCursorHighlightStateWithAnchorBoundingBox(e)}},this.updateCursorHighlightStateWithAnchorBoundingBox=e=>{if(!this.lastMousePosition)return;const{x:t,y:o}=this.lastMousePosition;let i,n=0;this.forEachCritique((r=>{var s,a,l,c;for(const u of r.squiggles){if(!u.isVisible||!this.anchorElement)continue;const r=this.mouseIndirectlyHoveredElement===u.id?null===(s=this.undoCalloutRect)||void 0===s?void 0:s.width:void 0;let d=W({left:u.data.clientRect.left+e.left,top:u.data.clientRect.top+e.top,right:u.data.clientRect.right+e.left,bottom:u.data.clientRect.bottom+e.top,width:u.data.clientRect.width,height:u.data.clientRect.height},t,o,r);const g=(0,$.kI)(u.squiggleKind);if(this.ariaLineNavUpdatesEnabled||d!==N.line||(d=N.none),g)if(this.mouseIndirectlyHoveredElement===u.id)if(d===N.indirect){if(void 0!==this.indirectTimer)continue;this.startUndoCardTimeout()}else this.setMouseIndirectlyHoveredElement(void 0),this.clearUndoCardTimeout();else(null===(a=this.options)||void 0===a?void 0:a.disableOpenAutoCorrectCalloutOnHover)||this.calloutOpenedForCritique!==u.critique.traceId||d!==N.none||this.isMouseWithinUndoCallout()||(null===(l=this.critiqueCalloutHandler)||void 0===l||l.hideCallout(),this.undoCalloutRect=void 0);if(d===N.direct)return i=u,this.mouseHoveredCritiqueId=u.critique.traceId,this.mouseHoveredElement=u.id,this.isUndoCalloutAlignedRight&&this.setMouseIndirectlyHoveredElement(u.id),void(u.squiggleKind===$.Ah.critique&&ae(u)&&this.showTooltipAt(u.squiggleKind,null===(c=u.squiggleRef)||void 0===c?void 0:c.current,u.critique,"mouse"));d===N.line&&(n+=1),this.trivializeSquiggle(u,"cursor")}})),this.updateAriaStatus(n,i),i||this.trivializeCursorSquiggle()},this.trivializeAllSquiggles=e=>{"caret"===e?this.trivializeCaretSquiggle():this.trivializeCursorSquiggle()},this.trivializeSquiggle=(e,t,o=!1)=>{"caret"===t?this.trivializeSquiggleCaretHover(e.critique.traceId):this.mouseHoveredCritiqueId!==e.critique.traceId||o&&(0,$.kI)(e.squiggleKind)||(this.trivializeCursorSquiggle(),this.trivializeDisabledCritiqueIdToShowTooltip())},this.trivializeSquiggleCaretHover=e=>{this.caretHoveredCritiqueId===e&&this.trivializeCaretSquiggle()},this.trivializeDisabledCritiqueIdToShowTooltip=()=>{this.disabledCritiqueIdToShowTooltip=void 0},this.trivializeCursorSquiggle=()=>{this.mouseHoveredCritiqueId=void 0,this.mouseHoveredElement=void 0},this.trivializeCaretSquiggle=()=>{this.caretHoveredCritiqueId=void 0,this.caretHoveredElement=void 0},this.flagShowFeedback=(e,t)=>{var o,i,n,r;this.proofedElements.find((t=>t.element===e))&&((null==t?void 0:t.typeId)===S.L9.CIQFlag_Topic?(0,j.z)((0,re.S)({topicIds:(null===(o=t.suggestionItems)||void 0===o?void 0:o.map((e=>e.entities.map((e=>e.TopicId)))).join(","))||"",topicNames:(null===(i=t.suggestionItems)||void 0===i?void 0:i.map((e=>e.entities.map((e=>e.DisplayName)))).join(","))||"",highlightedText:t.textInContext||"",hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),requestId:t.nodeId,source:"EditorFlag",traceId:t.traceId||""})):this.publishEvent("feedbackIconClicked",{suggestionText:null!==(n=null==t?void 0:t.textInContext)&&void 0!==n?n:"",mode:null!==(r=null==t?void 0:t.typeId)&&void 0!==r?r:""}))},this.scaleTransform=e=>{this.scaleTransformValue=e,this.innerUpdateSquiggles()},this.updateAriaStatus=(e,t)=>{t&&this.isAriaFeatureEnabled(A.j.highlight)?this.isAriaFeatureEnabled(A.j.highlight,t.critique)?this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:this.getAriaStatusString(t),severity:"assertive",preserve:!1,id:void 0,messageKind:t.squiggleKind===$.Ah.critique?d.Jx.KeepOriginal:d.Jx.AutoCorrectHover}):this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:"",severity:"assertive",preserve:!1,id:void 0}):this.ariaLineNavUpdatesEnabled&&this.publishEvent("ariaStatusUpdated",{eventKind:"lineNav",issuesCount:e,severity:"polite",preserve:!1})},this.updateRangesImmediately=async e=>{var t,o,i,n,r,s,a;if(!this.isVisible)return;const l=new Set(this.squigglesMap.keys()),c=!!(null===(t=this.options)||void 0===t?void 0:t.autoCorrectionEnabled)&&!!this.autoCorrectionCache;let u=!1;const d=new Map;for(const t of this.proofedElements){if(e&&!e.includes(t.id)){l.delete(t.id);continue}const g=[],h=this.squigglesMap.has(t.id),p=null!==(o=this.squigglesMap.get(t.id))&&void 0!==o?o:new R.ObservableMap,f=new Set(p.keys());for(const e of t.critiques)e.traceId&&f.delete(e.traceId),g.push(e);const m=await this.critiqueRangeBuilder.getCritiqueRanges(g,t.element);let v=[];if(g.length>0){const e=this.determineValidSquiggles(m);v=e.validRanges;for(const t of e.critiquesInInvalidRanges)f.add(t)}if(f.size>0&&this.removeCritiquesFromCache(f,p),v.length>0){this.hadUpdateWithoutAnyValidSquiggles=!1;const e=await this.buildSquigglesForCritiques(t.element,v,p,c),o=[];if(this.autoCorrectionBroker){for(let l=e.length-1;l>=0;l-=1){const c=e[l];if(!(null===(i=this.autoCorrectionCache)||void 0===i?void 0:i.process(c.critique.traceId)))continue;const u=null!==(n=c.critique.nodeId)&&void 0!==n?n:null===(r=c.critique.tileId)||void 0===r?void 0:r.nodeId,d=u?this.proofingDom.findNode(u):null;if(!d){null===(s=this.logger)||void 0===s||s.error(508146701,"Unable to find node while applying autocorrection");continue}this.autoCorrectionBroker.setIsApplyingAutoCorrection(c.critique);const g=await this.tileContent.autoCorrect(d,t.element,c.critique.start,c.critique.length,c.suggestion.text,c.range,null===(a=this.options)||void 0===a?void 0:a.autoCorrectionInputCacheEnabled);if(g){o.push({replacedText:g,critique:c.critique});const e=(0,te.dP)(c.suggestion);this.publishEvent("autoCorrectionTriggered",{critique:c.critique,isPersonalized:e})}else this.autoCorrectionBroker.convertToNormalSquiggle(c.critique)}let l=0;for(let e=o.length-1;e>=0;e-=1)l+=this.autoCorrectionBroker.setIsFinishedApplyingAutoCorrection(o[e].critique,l),u=!0}}else this.hadUpdateWithoutAnyValidSquiggles=g.length>0;h||d.set(t.id,p),l.delete(t.id)}l.size>0&&this.removeMissingElements(l),this.updatePosition(this.isRelativePositionEnabled),d.size>0&&this.squigglesMap.merge(d),u&&await this.updateRangesImmediately(e)},this.getValidCritiques=async e=>{const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.critiques,e.element);return this.determineValidSquiggles(t).validRanges.map((e=>e.critique))},this.removeCritiquesFromCache=(e,t)=>{var o;for(const i of e.keys())t.delete(i),this.calloutOpenedForCritique===i&&(null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.mouseHoveredCritiqueId!==i&&this.caretHoveredCritiqueId!==i||(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle())},this.removeMissingElements=e=>{var t;for(const o of e){const e=this.squigglesMap.get(o);if(e)for(const o of e.values())for(const e of o)null===(t=this._visibilityTracker)||void 0===t||t.unTrackSquiggle(e.data.range.startContainer);this.squigglesMap.delete(o)}},this.buildSquigglesForCritiques=async(e,t,o,i,n=$.Ah.critique)=>{var r,s,a,l,c,u;const d=[];if(this.anchorElement){const g=this.anchorElement.getBoundingClientRect(),h=null===(r=this.anchorElement.ownerDocument.activeElement)||void 0===r?void 0:r.contains(e),p=null===(s=this.targetWindowRef)||void 0===s?void 0:s.deref(),f=p&&(null===(a=this.hostElement)||void 0===a?void 0:a.getForbiddenRects(p)),m=(e,t)=>{var o;return null===(o=this.hostElement)||void 0===o?void 0:o.transformSquiggleRects(e,t,f)},v=[];for(const r of t){if(!r.range||!r.critique.traceId)continue;const t=o.get(r.critique.traceId);let s=null!==(l=null==t?void 0:t[0].squiggleKind)&&void 0!==l?l:n;if(i&&!t&&h){const e=(0,te.MG)(r.critique);if(e){const t=r.critique;if(this.autoCorrectionBroker&&!this.autoCorrectionBroker.getHasAutoCorrectionBeenConvertedToNormalSquiggle(t))if(this.autoCorrectionBroker.getHasAutoCorrectionBeenApplied(t))s=(null===(u=this.options)||void 0===u?void 0:u.personalizedAutoCorrectionEnabled)&&(0,te.dP)(e)?$.Ah.personalizedAutocorrection:$.Ah.autocorrection;else{if(this.enableAutoCorrectionForLanguages(e.languages)&&await(null===(c=this._visibilityTracker)||void 0===c?void 0:c.checkImmediateVisibility(r.range.startContainer))&&this.isAutoCorrectApplicable(r.range)){d.push({critique:t,suggestion:e,range:r.range});continue}this.autoCorrectionBroker.convertToNormalSquiggle(t)}}}this.createOrUpdateSquiggleStates(r.critique,r.range,e,o,s,g,t,m).shouldAnnounce&&v.push({critique:r.critique,squiggleKind:s})}v.length&&this.setAriaStatuses(v)}return d},this.isAutoCorrectApplicable=e=>{var t;const o=null===(t=this.targetWindowRef)||void 0===t?void 0:t.deref();if(!o)return!1;const i=o.document.getSelection();if(!(null==i?void 0:i.focusNode)||!i.isCollapsed)return!1;const n=e.comparePoint(i.focusNode,i.focusOffset);if(0===n)return!1;const r=o.document.createRange();return 1===n?(r.setStart(e.endContainer,e.endOffset),r.setEnd(i.focusNode,i.focusOffset)):(r.setStart(i.focusNode,i.focusOffset),r.setEnd(e.startContainer,e.startOffset)),r.toString().length<=$.tB},this.createOrUpdateSquiggleStates=(e,t,o,i,n,r,s,a)=>e.traceId&&this.anchorElement&&this.hostElement?this.updateSquiggle(s,t,e,o,n,r,a,i,e.traceId):{shouldAnnounce:!1},this.setAriaStatuses=e=>{const t=e.map((e=>{if(!this.isAriaFeatureEnabled(A.j.appearance,e.critique))return;const{critique:t,squiggleKind:o}=e,i=t.textInContext;if(!i)return;const n=o===$.Ah.critique?`${t.categoryTitle} ${i}`:i,r=o===$.Ah.critique?d.Jx.KeepOriginal:d.Jx.AutoCorrectAppearance;return{text:n,id:t.traceId,messageKind:r}}));this.publishEvent("ariaStatusUpdated",{eventKind:"statusList",statuses:t.filter((e=>!!e)),severity:"assertive"})},this.findSquiggle=e=>{let t;for(const o of this.squigglesMap.values()){const i=o.get(e);if(null==i?void 0:i.length){t=i[0];break}}return t},this.onShowCallout=(e,t,o,i,n,r,s,a,l)=>{var c,u,d,g,h;if(!this.isVisible)return;if(this.calloutOpenedForCritique===t.traceId)return;this.calloutOpenedForCritique&&this.onCalloutClosed(n,!1,this.calloutOpenedForCritique),this.closeTooltip(),this.setCalloutOpenedForCritique(t.traceId);const p=this.proofedElements.find((e=>e.element===r));let f=null===(c=null==p?void 0:p.graphNode)||void 0===c?void 0:c.element;if(!f&&t.nodeId){const e=this.proofingDom.findNode(t.nodeId);(0,oe.l)(e)?f=e.parent.element:e&&(f=e.element)}if(!f)return void(null===(u=this.logger)||void 0===u||u.error(508146700,"Unable to find graph node while showing callout"));const m=null!=e?e:a;if(!m)return void(null===(d=this.logger)||void 0===d||d.error(507562183,"Unable to find target location while showing callout"));const v=e&&(0,q.C)(e,"HTMLElement")?e.ownerDocument:null===(g=this.anchorElement)||void 0===g?void 0:g.ownerDocument;null===(h=this.critiqueCalloutHandler)||void 0===h||h.showCallout({critique:t,issueText:o,setInitialFocus:i,target:m,gapSpace:l,targetDocumentRef:v&&new L.O(v),squiggleKind:s,onDismiss:e=>{this.onCalloutClosed(n,e,t.traceId)},onApplySuggestion:async(e,t)=>{var o,i;this.caretPosition=void 0,await this.critiqueApplicationHandler.applyCritiqueSuggestion(f,r,null!==(o=e.nodeId)&&void 0!==o?o:null==p?void 0:p.id,e,t,(null===(i=this.options)||void 0===i?void 0:i.disableRangeWhenApplyingCritiqueSuggestions)?void 0:a,s)},onApplyFlag:async(e,t,o)=>{await this.critiqueApplicationHandler.applyFlagSuggestion(f,r,e.nodeId,e,t,o)},onIgnoreOnce:e=>{var t,o,i;this.critiqueApplicationHandler.ignoreCritiqueOnce(f,r,null!==(i=null!==(t=e.nodeId)&&void 0!==t?t:null===(o=e.tileId)||void 0===o?void 0:o.nodeId)&&void 0!==i?i:null==p?void 0:p.id,e)},onIgnoreAll:e=>{var t;this.critiqueApplicationHandler.ignoreAllOfCritique(f,r,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onFlagIgnoreOnce:e=>{this.critiqueApplicationHandler.ignoreFlagOnce(f,r,e.nodeId,e)},onFlagIgnoreAll:e=>{this.critiqueApplicationHandler.ignoreAllOfFlag(f,r,e)},onDisableFlag:e=>{this.critiqueApplicationHandler.disableFlagType(f,r,e.nodeId,e)},onShowFeedback:e=>{this.flagShowFeedback(r,e)},onDisableCritiqueType:async e=>{var t;await this.critiqueApplicationHandler.disableCritiqueType(f,r,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onCalloutPositionUpdated:this.onCalloutPositionUpdated})},this.setCalloutOpenedForCritique=e=>{this.calloutOpenedForCritique=e},this.setMouseIndirectlyHoveredElement=e=>{this.mouseIndirectlyHoveredElement=e},this.innerUpdateSquiggles=async()=>{const e=[];if(this.forEachCritique((t=>{if(t.squiggles.length)for(const o of t.squiggles)o.data.isRangeInValidState()||e.push(o)})),e.length){const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.map((e=>e.critique)));if(t.length===e.length)for(let o=0;o<e.length;o++)e[o].data.updateRange(t[o].range)}this.innerUpdateSquigglesWithValidRanges()},this.innerUpdateSquigglesWithValidRanges=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();if(!(this.isVisible&&this.anchorElement&&t&&this.hostElement))return;const o=this.anchorElement.getBoundingClientRect(),i=this.hostElement.getForbiddenRects(t),n=(e,t)=>{var o;return null===(o=this.hostElement)||void 0===o?void 0:o.transformSquiggleRects(e,t,i)},r=[];(0,R.transaction)((()=>{this.forEachCritique((e=>{if(!e.squiggles.length)return;const t=e.squiggles[0];this.updateSquiggle(e.squiggles,t.data.range,t.critique,t.element,t.squiggleKind,o,n,e.elementCritiques,e.key).shouldAnnounce&&r.push(t)}))})),r.length&&this.setAriaStatuses(r)},this.updateSquiggle=(e,t,o,i,n,r,s,a,l)=>{var c,u,d,g,h,p;let f=!0;e?f=null===(d=null===(u=this._visibilityTracker)||void 0===u?void 0:u.isSquiggleVisible(t.startContainer))||void 0===d||d:null===(c=this._visibilityTracker)||void 0===c||c.trackSquiggle(t.startContainer);let m=!1;if(f&&this.anchorElement){const c=function(e,t,o,i=1){const n=o,r=t(function(e){if(e.startContainer===e.endContainer)return Array.from(e.getClientRects());const t=e.startContainer.ownerDocument||document,o=t.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ALL),i=[];for(;o.nextNode()&&(0===i.length&&o.referenceNode!==e.startContainer||(i.push(o.referenceNode),o.referenceNode!==e.endContainer)););const n=[],r=t.createRange();for(const t of i)t.nodeType===t.TEXT_NODE&&(r.selectNode(t),t===e.startContainer?r.setStart(t,e.startOffset):t===e.endContainer&&r.setEnd(t,e.endOffset),n.push(...Array.from(r.getClientRects())));let s=!0;for(const e of n)if(e.top!==n[0].top||e.height!==n[0].height){s=!1;break}return s?[n.reduce(((e,t)=>new DOMRect(Math.min(e.left,t.left),e.top,Math.max(e.right,t.right)-Math.min(e.left,t.left),e.height)))]:n}(e),e),s=[];if(r)for(const e of r){const t=(n.right-n.left)/i,o=e.left-n.left,r=Math.min(e.right-n.left,t),a={top:e.top-n.top,left:o,bottom:e.bottom-n.top,right:r,width:r-o,height:e.height,visible:!Q(e,n)};s.push(a)}return s}(t,s,r,this.scaleTransformValue);if(e&&c.length===e.length)for(let i=0;i<c.length;i+=1){const n=this.adjustVerticalPosition(c[i]),r=e[i];n.visible===r.isVisible&&(0,Z.a)(n,r.data.clientRect)||e[i].updateFromRect(n,t),r.critique.start!==o.start&&(r.critique.start=o.start),r.stealth!==(null!==(g=r.critique.isStealth)&&void 0!==g&&g)&&(r.stealth=null!==(h=r.critique.isStealth)&&void 0!==h&&h)}else{const r=[];for(const e of c){const s=new P((0,ee.h)(),i,n,o,e.visible,null!==(p=o.isStealth)&&void 0!==p&&p,new D(t,this.adjustVerticalPosition(e),this.zIndex),B.createRef());r.push(s)}r.length>0&&(e||(m=!0),a.set(l,r))}}else if(e)for(const t of e)t.isVisible&&(t.isVisible=!1);return{shouldAnnounce:m}},this.adjustVerticalPosition=e=>{var t;return void 0!==(null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment)&&(e.bottom+=this.options.squiggleVerticalAdjustment,e.height+=this.options.squiggleVerticalAdjustment),e},this.forEachCritique=e=>{this.forEachCritiqueInCache(this.squigglesMap,e)},this.forEachCritiqueInCache=(e,t)=>{const o=new Map;for(const i of e){const e=i[0],n=i[1],r=[];for(const o of n){const i=o[0],s=o[1];s.length>0&&r.push(s[0].critique),t({squiggles:s,key:i,elementCritiques:n,elementId:e})}o.set(e,r)}return o},this.showTooltipAt=(e,t,o,i,n)=>{var r,s,a,l,c,u;if(!(null===(r=this.options)||void 0===r?void 0:r.tooltipEnabled)||(null===(s=this.upsellStore)||void 0===s?void 0:s.isSquiggleBeingPreviewed(o)))return;if(this.calloutOpenedForCritique||(null===(a=this.editorSettingsState)||void 0===a?void 0:a.currentlyOpen))return void this.closeTooltip();const d=(null==t?void 0:t.ownerDocument)||(null===(l=this.anchorElement)||void 0===l?void 0:l.ownerDocument)||document;let g;if("keyboard"===i)if(n)g=this.getTooltipCoordinatesFromLocalPosition(n);else{const e=d.getSelection();if(!(e&&e.rangeCount>0))return;{const t=e.getRangeAt(0);let o;o=t.collapsed&&t.getClientRects().length?t.getClientRects()[0]:t.getBoundingClientRect(),g={x:o.left,y:o.bottom}}}else{if(this.mouseHoveredCritiqueId===this.disabledCritiqueIdToShowTooltip)return;if(!this.lastMousePosition)return;if(this.options.disableSquiggleTooltipOnTextSelection){const e=d.getSelection();if(e&&0!==e.toString().length)return}g=this.getTooltipCoordinatesFromGlobalPoint(this.lastMousePosition)}this.clearTooltipTimeout();const h=(0,ie.m)(d.activeElement);this.tooltipTimeout=null===(u=null===(c=this.targetWindowRef)||void 0===c?void 0:c.deref())||void 0===u?void 0:u.setTimeout((()=>{var n;if("keyboard"===i){const e=(0,ie.m)(d.activeElement);if(h!==e)return}this.isTooltipShown=!0,null===(n=this.tooltipHandler)||void 0===n||n.showTooltip({squiggleKind:e,critique:o,position:g,origin:null!=t?t:void 0,isAbsolute:void 0,targetDocument:d})}),1e3)},this.getTooltipCoordinatesFromGlobalPoint=e=>({x:e.x+6,y:e.y+16}),this.getTooltipCoordinatesFromLocalPosition=e=>{var t,o,i;const n=null===(t=this.anchorElement)||void 0===t?void 0:t.getBoundingClientRect();return this.getTooltipCoordinatesFromGlobalPoint({x:e.x+(null!==(o=null==n?void 0:n.left)&&void 0!==o?o:0),y:e.y+(null!==(i=null==n?void 0:n.top)&&void 0!==i?i:0)})},this.closeTooltip=(e,t)=>{var o;this.clearTooltipTimeout(),this.isTooltipShown&&(this.isTooltipShown=!1,null===(o=this.tooltipHandler)||void 0===o||o.hideTooltip()),t&&(this.disabledCritiqueIdToShowTooltip=e)},this.onSquigglerVisibilityChange=e=>{this.setVisible(e)},this.onSquigglesVisibilityChange=()=>{this.updateSquiggles()},this.isAriaFeatureEnabled=(e,t)=>{var o,i;const n=null!==(i=null===(o=this.options)||void 0===o?void 0:o.ariaFeatures)&&void 0!==i?i:A.j.none;return e!==A.j.appearance&&e!==A.j.highlight||!this.isAriaFeatureEnabled(A.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar)?e===A.j.none?n===e:(n&e)===e:!((null==t?void 0:t.priority)===S.bx.High||(null==t?void 0:t.priority)===S.bx.Medium)},this.restoreCaretOnCalloutClose=()=>{var e,t,o,i,n;if((null===(e=this.options)||void 0===e?void 0:e.restoreCaretPosition)&&void 0!==this.caretPosition){const{node:e,offset:r}=this.caretPosition;if(void 0!==e){const s=((null===(t=this.anchorElement)||void 0===t?void 0:t.ownerDocument)||document).getSelection();if(!s||!e)return;const a=null!==(i=null===(o=e.textContent)||void 0===o?void 0:o.length)&&void 0!==i?i:0,l=Math.min(r,a);try{s.removeAllRanges(),s.setPosition(e,l)}catch(e){null===(n=this.logger)||void 0===n||n.error(539824961,"Error while restoring the IP on callout dismissed",e)}}}},this.checkSquiggleSelection=(e,t)=>{var o,i,n;if(!ae(e)||t.rangeCount<1)return!1;const r=t.getRangeAt(0);let s;s=r.collapsed&&r.getClientRects().length?r.getClientRects()[0]:r.getBoundingClientRect();const a=null!==(n=null===(i=null===(o=e.squiggleRef)||void 0===o?void 0:o.current)||void 0===i?void 0:i.getBoundingClientRect())&&void 0!==n?n:e.data.range.getBoundingClientRect();return!(a.left>s.right||a.right<s.left||a.top>s.bottom||a.bottom<s.top)},this.onCalloutClosed=(e,t,o)=>{e(),this.calloutOpenedForCritique===o&&this.setCalloutOpenedForCritique(void 0),t?this.restoreCaretOnCalloutClose():this.caretPosition=void 0},this.getAriaStatusString=e=>{const t=e.data.range.toString();return e.squiggleKind===$.Ah.critique?`${e.critique.categoryTitle} ${t}`:t},this.closeCalloutCallback=e=>{var t;e&&this.calloutOpenedForCritique===e&&(null===(t=this.critiqueCalloutHandler)||void 0===t||t.hideCallout())},this.getSquiggleProps=e=>{var t;const o=this.anchorElement;if(!o)return[];const i=!this.isAriaFeatureEnabled(A.j.none),n=i?"none presentation":"status",r=i?"off":"assertive",s=(null===(t=this.options)||void 0===t?void 0:t.squiggleStyleType)===H.N.SVG;return e.map((e=>{var t,a,l;const{critique:c,id:u}=e,d=c.traceId===this.caretHoveredCritiqueId||c.traceId===this.mouseHoveredCritiqueId||c.traceId===this.calloutOpenedForCritique;let g=u===this.mouseHoveredElement;(0,$.kI)(e.squiggleKind)&&(g=g||u===this.mouseIndirectlyHoveredElement);const h=Object.assign(Object.assign({},e),{isHighlighted:d,isCaretOver:u===this.caretHoveredElement,isMouseOver:g,isCalloutOpened:c.traceId===this.calloutOpenedForCritique,useSvgUnderline:s,disableCalloutOnDoubleClick:(null===(t=this.options)||void 0===t?void 0:t.disableCalloutOnDoubleClick)&&(null===(a=this.hostElement)||void 0===a?void 0:a.disableCalloutOnDoubleClick),role:n,ariaLive:r,ariaLabel:i?"":this.getAriaStatusString(e),describedBy:K.y,anchor:o,onCallOut:this.onShowCallout,closeCallout:this.closeCalloutCallback,showTooltip:this.showTooltipAt,closeTooltip:this.closeTooltip});return(0,$.kI)(e.squiggleKind)&&this.autoCorrectionCache?Object.assign(Object.assign({},h),{squiggleKind:e.squiggleKind,initializationProgress:this.autoCorrectionCache.getSquiggleInitializationProgress(e.critique.traceId),setInitializationProgress:this.autoCorrectionCache.setInitializationProgress,openCalloutOnHover:!(!0===(null===(l=this.options)||void 0===l?void 0:l.disableOpenAutoCorrectCalloutOnHover))}):Object.assign(Object.assign({},h),{squiggleKind:$.Ah.critique})}))},this.clearTooltipTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();this.tooltipTimeout&&t&&(t.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=void 0)},this.clearOnCalloutShownCallbackTimeout=()=>{var e;if(!this.onCalloutShownCallbackTimeout)return;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.onCalloutShownCallbackTimeout),this.onCalloutShownCallbackTimeout=void 0)},this.cancelSetVisibleFrame=()=>{this.setVisibleFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.setVisibleFrameRequestId),this.setVisibleFrameRequestId=void 0)},this.cancelShowCalloutFrame=()=>{this.showCalloutFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.showCalloutFrameRequestId),this.showCalloutFrameRequestId=void 0)};const{anchorElement:k,anchorId:T,proofedItem:x,critiqueCalloutHandler:_,tooltipHandler:E,options:F}=e;let X;this.critiqueCalloutHandler=_,this.tooltipHandler=E,this.id=T,this.options=F,this.anchorElement=k,this.proofedElements.push(x),this.targetWindowRef=new L.O((0,q.e)(this.anchorElement)),this.safeWindow=new C.c(o),this.throttleManager=new z._(null!==(h=this.targetWindowRef)&&void 0!==h?h:new L.O(window)),this.squigglerEventManager=new J.pT,this.autoCorrectionCache=new I.Qr;const se=()=>X||(X=getComputedStyle(k));this.hostElement=((e,t,o,i,n=!0)=>{var r,s,a,l,c,u,d,g,h,p,f,m;const v=o.find((t=>t.match(e))),y=null!==(r=null==v?void 0:v.shouldRender)&&void 0!==r?r:ne,b=null!==(s=null==v?void 0:v.shouldRenderSquiggle)&&void 0!==s?s:ne,S=null!==(a=null==v?void 0:v.shouldObserveSize)&&void 0!==a?a:()=>[],C=null!==(l=null==v?void 0:v.addHandlers)&&void 0!==l?l:()=>()=>null,w=null!==(c=null==v?void 0:v.squigglerInlineStyles)&&void 0!==c?c:()=>{},k=null!==(u=null==v?void 0:v.transformSquiggleRects)&&void 0!==u?u:e=>e,T=null!==(d=null==v?void 0:v.getForbiddenRects)&&void 0!==d?d:()=>[],x=null!==(g=null==v?void 0:v.isScrollable)&&void 0!==g?g:()=>{},_=null!==(h=null==v?void 0:v.squigglerUpdated)&&void 0!==h?h:()=>{},I=e.tagName.toLowerCase(),E="editor-shadow-element"===I?window.document.body:e.parentElement,A=null!==(p=null==v?void 0:v.getSquigglerTopOffset)&&void 0!==p?p:e=>e.getBoundingClientRect().height,B={element:null!==(f=e.parentElement)&&void 0!==f?f:window.document.body,zIndex:null!==(m=null==v?void 0:v.zIndex)&&void 0!==m?m:"auto",shouldRender:y,shouldRenderSquiggle:b,shouldObserveSize:S,addHandlers:C,squigglerInlineStyles:w,transformSquiggleRects:k,getForbiddenRects:T,isScrollable:x,squigglerUpdated:_,getTopOffset:A,disableCalloutOnDoubleClick:null==v?void 0:v.disableCalloutOnDoubleClick};if("body"===I||!E)return B;if(null==v?void 0:v.selector){const t="string"==typeof v.selector?e.closest(v.selector):v.selector(e,null==i?void 0:i.element);if(t)return B.element=t,B}return B.element=n?((e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let o=e.parentElement,i=window.getComputedStyle(o);for(;o&&"relative"!==i.position&&o!==document.body;)o=o.parentElement,i=window.getComputedStyle(o);return o})(e,t()):E,B})(k,(()=>se().position),null!==(p=null==F?void 0:F.edgeCases)&&void 0!==p?p:[],x,!1),(null===(f=this.hostElement.element)||void 0===f?void 0:f.parentElement)===this.anchorElement&&(this.anchorElement.firstElementChild===this.hostElement.element?this.top=0:this.top=-1*this.hostElement.getTopOffset(this.anchorElement)),this.zIndex=this.hostElement.zIndex?Y(this.hostElement.zIndex.toString()):Y(se().zIndex),this.parentToRenderTo=this.hostElement.element,this._visibilityTracker=null!==(m=null==F?void 0:F.visibilityTracker)&&void 0!==m?m:V.Y,this.isVisible=this._visibilityTracker===V.Y,this._visibilityTracker.connect({trackSquiggler:!0,trackSquiggles:null===(y=null===(v=this.options)||void 0===v?void 0:v.visibilityTrackerShouldTrackSquiggles)||void 0===y||y,anchorElement:k,onSquigglerVisibilityChange:this.onSquigglerVisibilityChange,onSquigglesVisibilityChange:this.onSquigglesVisibilityChange}),(null===(b=this.options)||void 0===b?void 0:b.mutationObserverBasedRelativePosition)&&(this.recalculateRelativePosition(),this._relativePositionMutationObserver=new MutationObserver((e=>this.recalculateRelativePosition())),this._relativePositionMutationObserver.observe(this.parentToRenderTo,{attributeFilter:["class","style"]})),(null==F?void 0:F.throttleUpdates)&&(this.throttledUpdateSquiggles=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,this.innerUpdateSquiggles,16,"After"),this.throttledUpdateRanges=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,(()=>{const e=this.throttledUpdateRangesProofedElementsToCheck;return this.throttledUpdateRangesProofedElementsToCheck=void 0,this.updateRangesImmediately(e)}),16,"After")),this.autoCorrectDisabledLanguages=null!==(w=null==F?void 0:F.autoCorrectDisabledLanguages)&&void 0!==w?w:[],(0,M.Gn)(this)}get isAutoCorrectionOnly(){let e=!1;for(const t of this.squigglesMap.values())for(const o of t.values())for(const t of o.values()){if(!(0,$.kI)(t.squiggleKind)||!this.autoCorrectionCache)return!1;e=!0}return e}get squiggles(){const e=[];return this.forEachCritique((t=>{const o=t.squiggles.filter((e=>{var t;return e.isVisible&&this.anchorElement&&(null===(t=this.hostElement)||void 0===t?void 0:t.shouldRenderSquiggle(e.data.range.startContainer,this.anchorElement))}));e.push(...o)})),e}get isRelativePositionEnabled(){return this.isRelativePositionEnabledValue?this.isRelativePositionEnabledValue:this.calculateRelativePosition()}calculateRelativePosition(){return!!this.parentToRenderTo&&"static"===(""!==this.parentToRenderTo.style.position?this.parentToRenderTo.style.position:getComputedStyle(this.parentToRenderTo).position)}get isEmpty(){return 0===this.proofedElements.length}get theme(){return this._squiggleThemeStore}get squiggleStyleType(){var e;return null===(e=this.options)||void 0===e?void 0:e.squiggleStyleType}get reactOnComponentUpdate(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.reactOnComponentUpdate)&&void 0!==t&&t}get disableAutoBrowserVirtualizationOfSquiggles(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.disableAutoBrowserVirtualizationOfSquiggles)&&void 0!==t&&t}get ariaEnabled(){return this.isAriaFeatureEnabled(A.j.none)}get ariaLineNavUpdatesEnabled(){return this.isAriaFeatureEnabled(A.j.lineNavigation)}get forcedHighContrast(){var e,t;return null!==(t=null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))&&void 0!==t&&t}setSquigglerRef(e){this._squigglerElement=e}checkProofingElementsPosition(){let e=this.proofedElementDomRects.length!==this.proofedElements.length;const t=[];return this.proofedElements.forEach(((o,i)=>{const n=o.element.getBoundingClientRect();t.push(n);const r=this.proofedElementDomRects[i],s=!r||!(n.x===r.x&&n.y===r.y&&n.width===r.width&&n.height===r.height);e=e||s})),e&&(this.proofedElementDomRects=t),e}updatePosition(e){var t,o,i,n,r;if(e){if(this._squigglerElement&&this.anchorElement){if((null===(o=null===(t=this.hostElement)||void 0===t?void 0:t.element)||void 0===o?void 0:o.parentElement)===this.anchorElement&&this.anchorElement.firstElementChild===this.hostElement.element&&0===this.top&&0===this.left)return!1;let e=!1;const s=this._squigglerElement.getBoundingClientRect(),a=this.anchorElement.getBoundingClientRect(),l=a.top-s.top-this.top,c=a.left-s.left-this.left;return Math.abs(l)>(null!==(i=this.diffPrecision)&&void 0!==i?i:.01)&&(this.top+=l,e=!0),Math.abs(c)>(null!==(n=this.diffPrecision)&&void 0!==n?n:.01)&&(this.left+=c,e=!0),!e&&(null===(r=this.options)||void 0===r?void 0:r.trackProofingElementsPositionEnabled)&&(e=this.checkProofingElementsPosition()),e}}else if(this.anchorElement)if(this.anchorElement===this.parentToRenderTo)if(["body","html"].includes(this.anchorElement.nodeName.toLowerCase())){const e=function(e){const t=getComputedStyle(e),o=X(t.marginTop);return{x:X(t.marginLeft),y:o}}(this.anchorElement);this.left=this.anchorElement.offsetLeft+e.x,this.top=this.anchorElement.offsetTop+e.y}else this.left=0,this.top=0;else["tbody"].includes(this.anchorElement.nodeName.toLowerCase())?(this.left=0,this.top=0):(this.left=this.anchorElement.offsetLeft,this.top=this.anchorElement.offsetTop);return!1}dispose(){var e,t,o,i;this.clearUndoCardTimeout(),this.anchorElement&&(this.cancelSetVisibleFrame(),this.cancelShowCalloutFrame(),this.clearOnCalloutShownCallbackTimeout(),this.clearTooltipTimeout(),this.squigglesMap.clear(),null===(e=this._visibilityTracker)||void 0===e||e.disconnect(),this._visibilityTracker=void 0,null===(t=this._relativePositionMutationObserver)||void 0===t||t.disconnect(),this._relativePositionMutationObserver=void 0,this.proofedElements=[],this.anchorElement=void 0,this.parentToRenderTo=void 0,this.hostElement=void 0,this._squigglerElement=void 0,this.targetWindowRef=void 0,this.throttledUpdateSquiggles=void 0,this.throttledUpdateRanges=void 0,null===(o=this.throttleManager)||void 0===o||o.dispose(),(this.caretHoveredCritiqueId||this.mouseHoveredCritiqueId)&&(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle()),this.calloutOpenedForCritique&&(null===(i=this.critiqueCalloutHandler)||void 0===i||i.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.critiqueCalloutHandler=void 0,this.tooltipHandler=void 0)}determineValidSquiggles(e){var t,o,i,n,r,s,a,l,c,u;const d=[],g=[],h=new Map;for(const p of e){if(!p.range)continue;const e=p.range.commonAncestorContainer.nodeType!==Node.TEXT_NODE&&(0,q.C)(p.range.commonAncestorContainer,"HTMLElement")?p.range.commonAncestorContainer:p.range.commonAncestorContainer.parentElement;if(!e)continue;let f=!0;const m=h.get(e);if(void 0!==m)f=m;else{("a"===e.nodeName.toLowerCase()||!0===(null===(i=null===(o=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.squigglerSettings)||void 0===o?void 0:o.checkSquigglePositionValidity)||void 0===i?void 0:i.call(o,p.critique,p.range))||(null===(r=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.squigglerSettings)||void 0===r?void 0:r.invalidSquiggleParentSelectors)&&e.closest(this.hostSettings.serviceSettings.squigglerSettings.invalidSquiggleParentSelectors.join(", ")))&&(f=!1);const d=[...null!==(l=null===(a=null===(s=this.hostSettings.serviceSettings)||void 0===s?void 0:s.squigglerSettings)||void 0===a?void 0:a.invalidSquiggleSelectors)&&void 0!==l?l:[],".ms-prediction","a"].join(", ");let g=p.range.startContainer;if((0,q.C)(g,"HTMLElement")?g.closest(d):null===(c=null==g?void 0:g.parentElement)||void 0===c?void 0:c.closest(d))f=!1;else for(;g=this.getNextNode(p.range.startContainer,!1,p.range.endContainer);){((0,q.C)(g,"HTMLElement")?g.closest(d):null===(u=null==g?void 0:g.parentElement)||void 0===u?void 0:u.closest(d))&&(f=!1);break}h.set(e,f)}f?d.push(p):p.critique.traceId&&g.push(p.critique.traceId)}return{validRanges:d,critiquesInInvalidRanges:g}}getNextNode(e,t,o){var i;if(o!==e){if(e.firstChild&&!t)return e.firstChild;if(e.parentNode)return null!==(i=e.nextSibling)&&void 0!==i?i:this.getNextNode(e.parentNode,!0,o)}}enableAutoCorrectionForLanguages(e=[]){return 0===this.autoCorrectDisabledLanguages.length||e.some((e=>!this.autoCorrectDisabledLanguages.includes(e)))}}function ae(e){return!e.squiggleRef||!!e.squiggleRef.current}(0,i.__decorate)([R.observable],se.prototype,"squigglesMap",void 0),(0,i.__decorate)([R.observable],se.prototype,"calloutOpenedForCritique",void 0),(0,i.__decorate)([R.observable],se.prototype,"mouseHoveredElement",void 0),(0,i.__decorate)([R.observable],se.prototype,"mouseIndirectlyHoveredElement",void 0),(0,i.__decorate)([R.observable],se.prototype,"caretHoveredElement",void 0),(0,i.__decorate)([R.observable],se.prototype,"scaleTransformValue",void 0),(0,i.__decorate)([R.observable],se.prototype,"top",void 0),(0,i.__decorate)([R.observable],se.prototype,"left",void 0),(0,i.__decorate)([R.computed],se.prototype,"squiggles",null),(0,i.__decorate)([R.observable],se.prototype,"isVisible",void 0),(0,i.__decorate)([R.action],se.prototype,"removeCritiques",void 0),(0,i.__decorate)([R.action],se.prototype,"setVisible",void 0),(0,i.__decorate)([R.action],se.prototype,"updatePosition",null),(0,i.__decorate)([R.action],se.prototype,"updateSelectionHighlightState",void 0),(0,i.__decorate)([R.action],se.prototype,"updateSelectionHighlightStateFromCoordinates",void 0),(0,i.__decorate)([R.action],se.prototype,"updateCursorHighlightState",void 0),(0,i.__decorate)([R.action],se.prototype,"trivializeCursorSquiggle",void 0),(0,i.__decorate)([R.action],se.prototype,"trivializeCaretSquiggle",void 0),(0,i.__decorate)([R.action],se.prototype,"scaleTransform",void 0),(0,i.__decorate)([R.action],se.prototype,"dispose",null),(0,i.__decorate)([R.action],se.prototype,"updateRangesImmediately",void 0),(0,i.__decorate)([R.action],se.prototype,"removeCritiquesFromCache",void 0),(0,i.__decorate)([R.action],se.prototype,"removeMissingElements",void 0),(0,i.__decorate)([R.action],se.prototype,"setCalloutOpenedForCritique",void 0),(0,i.__decorate)([R.action],se.prototype,"setMouseIndirectlyHoveredElement",void 0),(0,i.__decorate)([R.action],se.prototype,"innerUpdateSquigglesWithValidRanges",void 0),(0,i.__decorate)([R.action],se.prototype,"updateSquiggle",void 0);var le=o(48366),ce=o(48828),ue=o(90424),de=o(30122),ge=o(30225);const he=(0,le.f)("SquigglerV2StateStoreOptionsToken");let pe=class{constructor(e,t,o,i,s,a,l,c,u,d,g,h,p,f,m,v,y,w,k,T,x,_,I){var E;this.tileContent=t,this.instrumentationProcessor=o,this._hostEmitters=i,this.hostEmitter=s,this.hostSettings=a,this.proofingDom=l,this._squiggleThemeStore=c,this.logger=u,this._tileNodeTraverser=d,this.upsellStore=g,this.editorSettingsState=p,this.feedbackStore=f,this._disableCritiqueHandler=m,this.critiqueStore=v,this.applyCritiqueSuggestionHandler=y,this.applyFlagHandler=w,this.wordDictionary=k,this.editorSettingsManager=T,this._formElementAutoCorrectionCache=x,this.autoCorrectionBroker=_,this.getIsHighContrastTheme=I,this.onFeedbackIconClicked=async e=>{var t;null===(t=this.feedbackStore)||void 0===t||t.feedbackIconClicked(e.suggestionText,e.mode)},this.onAutoCorrectionTriggered=e=>{this.hostEmitter.emit(b.pD.autoCorrectionTriggered);const t={isPersonalized:e.isPersonalized.toString()};this.instrumentationProcessor.process({critique:e.critique,eventId:15,customProperties:t})},this.onAriaStatusUpdated=e=>{if(this.ariaStatusStateStore)switch(e.eventKind){case"status":this.ariaStatusStateStore.setStatus(e.statusText,e.severity,e.preserve,e.id,e.messageKind);break;case"statusList":this.ariaStatusStateStore.addPreservedStatuses(e.statuses,e.severity);break;case"lineNav":this.ariaStatusStateStore.setLineNavStatus(e.issuesCount,e.severity,e.preserve)}},this.autoCorrectLanguagesUpdated=async e=>{this._squigglerCore.setAutoCorrectLanguages(e.message)},this.setCritiques=async(e,t=!1)=>this._squigglerCore.setCritiques(e,t),this.removeCritiques=async e=>this._squigglerCore.removeCritiques(e),this.updateRanges=async e=>this._squigglerCore.updateRanges(e),this.updateSquiggles=()=>this._squigglerCore.updateSquiggles(),this.setVisible=e=>this._squigglerCore.setVisible(e),this.setLastMousePosition=e=>{this._squigglerCore.setLastMousePosition(e)},this.disconnectVisibilityTracker=()=>{this._squigglerCore.disconnectVisibilityTracker()},this.getCritiques=()=>this._squigglerCore.getCritiques(),this.showCallout=(e,t)=>{this._squigglerCore.showCallout(e,t)},this.updateSelectionHighlightState=e=>{this._squigglerCore.updateSelectionHighlightState(e)},this.updateSelectionHighlightStateFromCoordinates=e=>{this._squigglerCore.updateSelectionHighlightStateFromCoordinates(e)},this.updateCursorHighlightState=()=>{this._squigglerCore.updateCursorHighlightState()},this.trivializeAllSquiggles=e=>{this._squigglerCore.trivializeAllSquiggles(e)},this.flagShowFeedback=(e,t)=>{this._squigglerCore.flagShowFeedback(e,t)},this.scaleTransform=e=>{this._squigglerCore.scaleTransform(e)},this.updateRangesImmediately=async e=>this._squigglerCore.updateRangesImmediately(e),this.getValidCritiques=async e=>this._squigglerCore.getValidCritiques(e),this.onShowCallout=(e,t,o,i,n,r,s,a,l)=>{this._squigglerCore.onShowCallout(e,t,o,i,n,r,s,a,l)},this.closeTooltip=(e,t)=>{this._squigglerCore.closeTooltip(e,t)},this.isAriaFeatureEnabled=(e,t)=>{var o,i;const n=null!==(i=null===(o=this.options)||void 0===o?void 0:o.ariaFeatures)&&void 0!==i?i:A.j.none;return e!==A.j.appearance&&e!==A.j.highlight||!this.isAriaFeatureEnabled(A.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar)?e===A.j.none?n===e:(n&e)===e:!((null==t?void 0:t.priority)===S.bx.High||(null==t?void 0:t.priority)===S.bx.Medium)},this.getSquiggleProps=e=>this._squigglerCore.getSquiggleProps(e),this.options=e.options,this.ariaStatusStateStore=(null===(E=this.options)||void 0===E?void 0:E.ariaFeatures)?h:void 0,this.critiqueRangeBuilder=new r.$(this.tileContent,this.proofingDom,this._tileNodeTraverser),this.safeWindow=new C.c(a),this.critiqueApplicationHandler=new n.n(this._hostEmitters,this.tileContent,this.critiqueRangeBuilder,this.proofingDom,this.safeWindow,this._disableCritiqueHandler,this.logger,this.critiqueStore,this.applyCritiqueSuggestionHandler,this.applyFlagHandler,this.wordDictionary,this.editorSettingsManager,this._formElementAutoCorrectionCache),this._squigglerCore=new se(e,this.tileContent,this.hostSettings,this.proofingDom,this._squiggleThemeStore,this.critiqueApplicationHandler,this.critiqueRangeBuilder,this.autoCorrectionBroker,this.getIsHighContrastTheme,this.logger,this.upsellStore,this.editorSettingsState),this.hostEmitter.on(b.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),this._squigglerCore.subscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.subscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.subscribe("feedbackIconClicked",this.onFeedbackIconClicked)}get squigglesMap(){return this._squigglerCore.squigglesMap}get proofedElements(){return this._squigglerCore.proofedElements}get calloutOpenedForCritique(){return this._squigglerCore.calloutOpenedForCritique}get mouseHoveredElement(){return this._squigglerCore.mouseHoveredElement}get mouseIndirectlyHoveredElement(){return this._squigglerCore.mouseIndirectlyHoveredElement}get mouseHoveredCritiqueId(){return this._squigglerCore.mouseHoveredCritiqueId}get disabledCritiqueIdToShowTooltip(){return this._squigglerCore.disabledCritiqueIdToShowTooltip}get id(){return this._squigglerCore.id}get caretHoveredElement(){return this._squigglerCore.caretHoveredElement}get caretHoveredCritiqueId(){return this._squigglerCore.caretHoveredCritiqueId}get scaleTransformValue(){return this._squigglerCore.scaleTransformValue}get top(){return this._squigglerCore.top}get left(){return this._squigglerCore.left}get isAutoCorrectionOnly(){return this._squigglerCore.isAutoCorrectionOnly}get squiggles(){return this._squigglerCore.squiggles}get parentToRenderTo(){return this._squigglerCore.parentToRenderTo}get hostElement(){return this._squigglerCore.hostElement}get isRelativePositionEnabled(){return this._squigglerCore.isRelativePositionEnabled}get isEmpty(){return this._squigglerCore.isEmpty}get theme(){return this._squigglerCore.theme}get isVisible(){return this._squigglerCore.isVisible}get squiggleStyleType(){return this._squigglerCore.squiggleStyleType}get reactOnComponentUpdate(){return this._squigglerCore.reactOnComponentUpdate}get disableAutoBrowserVirtualizationOfSquiggles(){return this._squigglerCore.disableAutoBrowserVirtualizationOfSquiggles}get ariaEnabled(){return this._squigglerCore.ariaEnabled}get ariaLineNavUpdatesEnabled(){return this._squigglerCore.ariaLineNavUpdatesEnabled}get forcedHighContrast(){return this._squigglerCore.forcedHighContrast}get anchorElement(){return this._squigglerCore.anchorElement}get squigglerEventManager(){return this._squigglerCore.squigglerEventManager}setSquigglerRef(e){this._squigglerCore.setSquigglerRef(e)}updatePosition(e){return this._squigglerCore.updatePosition(e)}dispose(){this._squigglerCore.unsubscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.unsubscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.unsubscribe("feedbackIconClicked",this.onFeedbackIconClicked),this._squigglerCore.dispose(),this.hostEmitter.off(b.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated)}};pe=(0,i.__decorate)([(0,ce._)(),(0,i.__param)(0,(0,ue.W)(he)),(0,i.__param)(1,(0,ue.W)(g.d)),(0,i.__param)(2,(0,ue.W)(w.f)),(0,i.__param)(3,(0,de.t)(b.zJ)),(0,i.__param)(4,(0,ue.W)(b.M5)),(0,i.__param)(5,(0,ue.W)(k.n)),(0,i.__param)(6,(0,ue.W)(h.w)),(0,i.__param)(7,(0,ue.W)(E.Vw)),(0,i.__param)(8,(0,ge.l)()),(0,i.__param)(8,(0,ue.W)(T.g)),(0,i.__param)(9,(0,ge.l)()),(0,i.__param)(9,(0,ue.W)(p.M)),(0,i.__param)(10,(0,ge.l)()),(0,i.__param)(10,(0,ue.W)(f.Ey)),(0,i.__param)(11,(0,ge.l)()),(0,i.__param)(11,(0,ue.W)(d.mU)),(0,i.__param)(12,(0,ge.l)()),(0,i.__param)(12,(0,ue.W)(x.z)),(0,i.__param)(13,(0,ge.l)()),(0,i.__param)(13,(0,ue.W)(m.M)),(0,i.__param)(14,(0,ge.l)()),(0,i.__param)(14,(0,ue.W)(v.W)),(0,i.__param)(15,(0,ge.l)()),(0,i.__param)(15,(0,ue.W)(s.$)),(0,i.__param)(16,(0,ge.l)()),(0,i.__param)(16,(0,ue.W)(a.a)),(0,i.__param)(17,(0,ge.l)()),(0,i.__param)(17,(0,ue.W)(l.K)),(0,i.__param)(18,(0,ge.l)()),(0,i.__param)(18,(0,ue.W)(y.s)),(0,i.__param)(19,(0,ge.l)()),(0,i.__param)(19,(0,ue.W)(_.rI)),(0,i.__param)(20,(0,ge.l)()),(0,i.__param)(20,(0,ue.W)(I.PF)),(0,i.__param)(21,(0,ge.l)()),(0,i.__param)(21,(0,ue.W)(c.m)),(0,i.__param)(22,(0,ge.l)()),(0,i.__param)(22,(0,ue.W)(u.A))],pe)},73701:(e,t,o)=>{"use strict";if(o.d(t,{J:()=>r,Y:()=>s}),3023==o.j)var i=o(19454);if(3023==o.j)var n=o(25808);class r{constructor(){this._targetWindow=new i.O(window),this._visibleSquigglesRangeContainers=new Map,this._checkedElements=new Map,this._isAnchorElementVisible=!0,this.connect=e=>{var t;this._targetWindow=new i.O((0,n.e)(e.anchorElement)),(null===(t=this._targetWindow.deref())||void 0===t?void 0:t.IntersectionObserver)&&(this.initSquigglerObserver(e.trackSquiggler,e.anchorElement,e.onSquigglerVisibilityChange),this.initSquigglesObserver(e.trackSquiggles,e.onSquigglesVisibilityChange))},this.disconnect=()=>{this._squigglesVisibilityObserver&&this._squigglesVisibilityObserver.disconnect(),this._squigglerVisibilityObserver&&this._squigglerVisibilityObserver.disconnect(),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.disconnect()},this.trackSquiggle=e=>{var t;let o;if(!this._squigglesVisibilityObserver||!(o=this.getElementFromRange(e)))return;const i=null!==(t=this._visibleSquigglesRangeContainers.get(o))&&void 0!==t?t:{visible:void 0,handles:0};i.handles=i.handles+1,this._visibleSquigglesRangeContainers.set(o,i),this._squigglesVisibilityObserver.observe(o)},this.unTrackSquiggle=e=>{var t;let o;if(!this._squigglesVisibilityObserver||!(o=this.getElementFromRange(e)))return;const i=null!==(t=this._visibleSquigglesRangeContainers.get(o))&&void 0!==t?t:{visible:!1,handles:0};i.handles=i.handles-1,this._visibleSquigglesRangeContainers.set(o,i),i.handles<=0&&this.untrackElement(o)},this.isSquiggleVisible=e=>{const t=this.getElementFromRange(e);if(!t)return;if(!this._visibleSquigglesRangeContainers.has(t))return void this.trackSquiggle(e);const o=this._visibleSquigglesRangeContainers.get(t);return null==o?void 0:o.visible},this.checkImmediateVisibility=async e=>{const t=this.getElementFromRange(e);if(!t)return!1;const o=await this.asyncCheckVisibility(t);return this._checkedElements.delete(t),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.unobserve(t),o},this.asyncCheckVisibility=async e=>new Promise((t=>this.checkVisibility(e,t))),this.asyncVisibilityCallback=e=>{for(const t of e){const e=this._checkedElements.get(t.target);e&&e(t.isIntersecting)}},this.checkVisibility=(e,t)=>{if(!this._asyncVisibilityObserver){const e=this._targetWindow.deref();if(!e)return;this._asyncVisibilityObserver=new e.IntersectionObserver(this.asyncVisibilityCallback,{rootMargin:"0px",threshold:[0,1]})}this._checkedElements.set(e,t),this._asyncVisibilityObserver.observe(e)},this.untrackElement=e=>{var t;null===(t=this._squigglesVisibilityObserver)||void 0===t||t.unobserve(e),this._visibleSquigglesRangeContainers.delete(e)},this.initSquigglerObserver=(e,t,o)=>{if(!e)return;const i=this._targetWindow.deref();i&&(this._squigglerVisibilityObserver=new i.IntersectionObserver((e=>{o(this.getSquigglerIsVisible(e))}),{rootMargin:"0px",threshold:[0,1]}),this._squigglerVisibilityObserver.observe(t))},this.initSquigglesObserver=(e,t)=>{if(!e)return;const o=this._targetWindow.deref();o&&(this._squigglesVisibilityObserver=new o.IntersectionObserver((e=>{t(this.getVisibleSquigglesRangeContainers(e))}),{rootMargin:"0px",threshold:[0,1]}))},this.getVisibleSquigglesRangeContainers=e=>{var t;let o=!1;for(const i of e.values())if(i.target.isConnected){const e=null!==(t=this._visibleSquigglesRangeContainers.get(i.target))&&void 0!==t?t:{visible:!1,handles:1};e.visible=i.isIntersecting,this._visibleSquigglesRangeContainers.set(i.target,e)}else o=!0;return o&&this.removeZombies(),e},this.removeZombies=()=>{for(const e of this._visibleSquigglesRangeContainers.keys())e.isConnected&&this.untrackElement(e)},this.getSquigglerIsVisible=e=>(this._isAnchorElementVisible=e[e.length-1].isIntersecting,this._isAnchorElementVisible),this.getElementFromRange=e=>1===e.nodeType?e:e.parentElement}}const s={connect:()=>null,disconnect:()=>null,isSquiggleVisible:()=>!0,trackSquiggle:()=>null,unTrackSquiggle:()=>null,checkImmediateVisibility:async()=>!0}},17966:(e,t,o)=>{"use strict";var i;o.d(t,{j:()=>i}),function(e){e[e.none=0]="none",e[e.appearance=1]="appearance",e[e.highlight=2]="highlight",e[e.lineNavigation=4]="lineNavigation",e[e.cssHighlightsAPIAnnouncement=8]="cssHighlightsAPIAnnouncement",e[e.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar=16]="cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar"}(i||(i={}))},2980:(e,t,o)=>{"use strict";o.d(t,{f:()=>n,u:()=>r});var i=o(48366);const n=(0,i.f)("ISquigglerStateStoreFactory"),r=(0,i.f)("ContentEditableSquigglerComponent")},84858:(e,t,o)=>{"use strict";o.d(t,{_:()=>i});const i=(0,o(48366).f)("ISquigglePositioningEdgeCases")},92049:(e,t,o)=>{"use strict";o.d(t,{Vw:()=>i,pz:()=>n});const i=(0,o(48366).f)("ISquiggleThemeStore"),n={highPriorityColors:{tile:"#EB0000",highlight:"#FF30001A"},mediumPriorityColors:{tile:"#3355FF",highlight:"#0055CC1A"},lowPriorityColors:{tile:"#7160E8",highlight:"#7160E833"},autoCorrectColors:{tile:"#38BA62",highlight:"#5BC55240"},ciqFlagColors:{tile:"#0F6CBD",highlight:"#0F6CBD1A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}};n.autoCorrectColors.tile,n.ciqFlagColors.tile,n.headingDetectionColors.tile,n.mediumPriorityColors.tile,n.highPriorityColors.tile,n.lowPriorityColors.tile},293:(e,t,o)=>{"use strict";o.d(t,{$K:()=>r,iV:()=>n});var i=o(48366);(0,i.f)("InputControlsV2ProxyOptionsToken");const n=(0,i.f)("IInputControlsStateStoreFactory"),r=(0,i.f)("InputControlsSquigglerComponent")},49081:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>s}),3023==o.j)var i=o(55287);if(3023==o.j)var n=o(84872);var r=o(95734);const s=e=>{const t=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1);r.useEffect((()=>{const t=new i.J(e.anchor);return t.addListener("click",(()=>{var t;e.isMouseOver&&!e.isCalloutOpened&&(null===(t=e.onClick)||void 0===t||t.call(e))})),()=>{t.removeAllListeners()}}),[e.isCalloutOpened,e.critique,e.isMouseOver,e.anchor,e.onClick]);const o=o=>{var i,n,r;const s=o;e.isCaretOver&&(null===(i=e.openCalloutPredicate)||void 0===i?void 0:i.call(e,s))&&!e.isCalloutOpened?(t(o),"keyup"===s.type&&(null===(n=e.onKeyboardEvent)||void 0===n||n.call(e))):"Escape"===s.key&&"keyup"===s.type&&(null===(r=e.onEscapePress)||void 0===r||r.call(e))};return r.useEffect((()=>{if(e.isCaretOver||e.isMouseOver){const n=new i.J(e.anchor);return n.addListener("keyup",o),n.addListener("focus",t),n.addListener("blur",t),n.addListener("keydown",o),()=>{n.removeAllListeners()}}}),[e.isCaretOver,e.isMouseOver,e.isCalloutOpened,e.critique,e.anchor,e.openCalloutPredicate,e.onKeyboardEvent,e.onEscapePress]),r.createElement("span",{ref:e.squiggleRef,id:e.id,role:e.role,className:e.className,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,style:{opacity:e.opacity}},r.createElement("span",{"aria-hidden":"true"},e.data.text),e.useSvgUnderline&&r.createElement(n.a,{width:"100%",left:0,patternName:e.patternName,styleOverrides:{opacity:e.opacity}}))}},26371:(e,t,o)=>{"use strict";o.d(t,{U:()=>h});var i=o(30206);const n=(0,o(48366).f)("ISquiggleThemeFactory");var r=o(46546),s=o(77251),a=o(92049),l=o(83773),c=o(48828),u=o(30225),d=o(90424);const g=e=>`url("data:image/svg+xml,${encodeURIComponent(e.trim())}")`;let h=class{constructor(e,t){this.getIsHighContrastTheme=t,this._grammarTile="",this._grammarTileBorder="",this._insightTile="",this._insightTileBorder="",this._spellingTile="",this._spellingTileBorder="",this._autoCorrectTile="",this._autoCorrectBorder="",this._ciqFlagTile="",this._ciqFlagBorder="",this._headingDetectionTile="",this._headingDetectionBorder="",this.setSquiggleTheme=e=>{this._theme={highPriorityColors:e.highPriorityColors||this._theme.highPriorityColors,mediumPriorityColors:e.mediumPriorityColors||this._theme.mediumPriorityColors,lowPriorityColors:e.lowPriorityColors||this._theme.lowPriorityColors,autoCorrectColors:e.autoCorrectColors||this._theme.autoCorrectColors,ciqFlagColors:e.ciqFlagColors||this._theme.ciqFlagColors,headingDetectionColors:e.headingDetectionColors||this._theme.headingDetectionColors},this.setGrammarTiles(this._theme),this.setInsightTiles(this._theme),this.setSpellingTiles(this._theme),this.setAutoCorrectTiles(this._theme),this.setCiqFlagTiles(this._theme),this.setHeadingDetectionTiles(this._theme)},this.setGrammarTiles=e=>{this._grammarTile=g(`\n      <svg width="5px" height="3px" viewBox="0 0 5 3" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>grammar_double_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="grammar_double_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n            <path d="M0,2.5 L5,2.5" id="Line-2-Copy-11"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._grammarTileBorder=g(`\n    <svg width="15px" height="9px" viewBox="0 0 15 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n      <title>grammar_double_line</title>\n      <desc>Created with Sketch.</desc>\n      <g id="grammar_double_line" stroke="none" stroke-width="3" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n        <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n          <path d="M0,1.5 L15,1.5" id="Line-2-Copy-10"></path>\n          <path d="M0,7.5 L15,7.5" id="Line-2-Copy-11"></path>\n        </g>\n      </g>\n    </svg>\n  `)},this.setInsightTiles=e=>{this._insightTile=g(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._insightTileBorder=g(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this.setSpellingTiles=e=>{this._spellingTile=g(`\n      <svg width="5px" height="4px" viewBox="0 0 5 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="1"></path>\n              <rect id="Rectangle" x="0" y="0" width="5" height="4"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `),this._spellingTileBorder=g(`\n      <svg width="17px" height="9px" viewBox="0 0 17 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M 0,7.5 H 1 C 4.75,7.5 4.75,1.5 8.5,1.5 12.25,1.5 12.25,7.5 16,7.5 H 17" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="3"></path>\n              <rect id="Rectangle" x="0" y="0" width="17" height="9"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `)},this.setAutoCorrectTiles=e=>{this._autoCorrectTile=g(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._autoCorrectBorder=g(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `)},this.setCiqFlagTiles=e=>{this._ciqFlagTile=g(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n          <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `),this._ciqFlagBorder=g(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n            <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `)},this.setHeadingDetectionTiles=e=>{this._headingDetectionTile=g(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._headingDetectionBorder=g(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this._theme=a.pz;const o=null==e?void 0:e();o&&this.setSquiggleTheme(o),(0,s.Gn)(this)}get theme(){var e,t;return(null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))?(t=this._theme,Object.assign(Object.assign({},t),{highPriorityColors:Object.assign(Object.assign({},t.highPriorityColors),{tile:"highlight"}),mediumPriorityColors:Object.assign(Object.assign({},t.mediumPriorityColors),{tile:"highlight"}),lowPriorityColors:Object.assign(Object.assign({},t.lowPriorityColors),{tile:"highlight"}),autoCorrectColors:Object.assign(Object.assign({},t.autoCorrectColors),{tile:"highlight"}),ciqFlagColors:Object.assign(Object.assign({},t.ciqFlagColors),{tile:"highlight"}),headingDetectionColors:Object.assign(Object.assign({},t.headingDetectionColors),{tile:"highlight"})})):this._theme}get grammarTile(){return this._grammarTile||this.setGrammarTiles(this._theme),this._grammarTile}get grammarTileBorder(){return this._grammarTileBorder||this.setGrammarTiles(this._theme),this._grammarTileBorder}get insightTile(){return this._insightTile||this.setInsightTiles(this._theme),this._insightTile}get insightTileBorder(){return this._insightTileBorder||this.setInsightTiles(this._theme),this._insightTileBorder}get spellingTile(){return this._spellingTile||this.setSpellingTiles(this._theme),this._spellingTile}get spellingTileBorder(){return this._spellingTileBorder||this.setSpellingTiles(this._theme),this._spellingTileBorder}get autoCorrectTile(){return this._autoCorrectTile||this.setAutoCorrectTiles(this._theme),this._autoCorrectTile}get autoCorrectTileBorder(){return this._autoCorrectBorder||this.setAutoCorrectTiles(this._theme),this._autoCorrectBorder}get ciqFlagTile(){return this._ciqFlagTile||this.setCiqFlagTiles(this._theme),this._ciqFlagTile}get ciqFlagTileBorder(){return this._ciqFlagBorder||this.setCiqFlagTiles(this._theme),this._ciqFlagBorder}get headingDetectionTile(){return this._headingDetectionTile||this.setHeadingDetectionTiles(this._theme),this._headingDetectionTile}get headingDetectionTileBorder(){return this._headingDetectionBorder||this.setHeadingDetectionTiles(this._theme),this._headingDetectionBorder}};(0,i.__decorate)([r.observable],h.prototype,"_theme",void 0),(0,i.__decorate)([r.observable],h.prototype,"_grammarTile",void 0),(0,i.__decorate)([r.observable],h.prototype,"_grammarTileBorder",void 0),(0,i.__decorate)([r.observable],h.prototype,"_insightTile",void 0),(0,i.__decorate)([r.observable],h.prototype,"_insightTileBorder",void 0),(0,i.__decorate)([r.observable],h.prototype,"_spellingTile",void 0),(0,i.__decorate)([r.observable],h.prototype,"_spellingTileBorder",void 0),(0,i.__decorate)([r.observable],h.prototype,"_autoCorrectTile",void 0),(0,i.__decorate)([r.observable],h.prototype,"_autoCorrectBorder",void 0),(0,i.__decorate)([r.observable],h.prototype,"_ciqFlagTile",void 0),(0,i.__decorate)([r.observable],h.prototype,"_ciqFlagBorder",void 0),(0,i.__decorate)([r.observable],h.prototype,"_headingDetectionTile",void 0),(0,i.__decorate)([r.observable],h.prototype,"_headingDetectionBorder",void 0),(0,i.__decorate)([r.computed],h.prototype,"theme",null),(0,i.__decorate)([r.computed],h.prototype,"grammarTile",null),(0,i.__decorate)([r.computed],h.prototype,"grammarTileBorder",null),(0,i.__decorate)([r.computed],h.prototype,"insightTile",null),(0,i.__decorate)([r.computed],h.prototype,"insightTileBorder",null),(0,i.__decorate)([r.computed],h.prototype,"spellingTile",null),(0,i.__decorate)([r.computed],h.prototype,"spellingTileBorder",null),(0,i.__decorate)([r.computed],h.prototype,"autoCorrectTile",null),(0,i.__decorate)([r.computed],h.prototype,"autoCorrectTileBorder",null),(0,i.__decorate)([r.computed],h.prototype,"ciqFlagTile",null),(0,i.__decorate)([r.computed],h.prototype,"ciqFlagTileBorder",null),(0,i.__decorate)([r.computed],h.prototype,"headingDetectionTile",null),(0,i.__decorate)([r.computed],h.prototype,"headingDetectionTileBorder",null),(0,i.__decorate)([r.action],h.prototype,"setSquiggleTheme",void 0),h=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,u.l)()),(0,i.__param)(0,(0,d.W)(n)),(0,i.__param)(1,(0,u.l)()),(0,i.__param)(1,(0,d.W)(l.A))],h)},91799:(e,t,o)=>{"use strict";o.d(t,{$:()=>i});const i=(0,o(48366).f)("IStyleDefinitions")},75507:(e,t,o)=>{"use strict";o.d(t,{y:()=>i});const i="ms-squiggle-tooltip"},38214:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});const i=(0,o(48366).f)("ISquiggleTooltipStateStore")},47529:(e,t,o)=>{"use strict";o.d(t,{F:()=>g});var i=o(95734),n=o(97069),r=o(93261),s=o(87333);if(3023==o.j)var a=o(55287);var l=o(38214);if(3023==o.j)var c=o(75507);var u=o(13956);const d=(0,n.F5)({state:r.A.on(l.A),localizer:r.A.on(s.H)}),g=()=>{const{state:e,localizer:t}=(0,n.KN)(d),[o,r]=i.useState(e.isVisible);i.useEffect((()=>{const t=e=>{r(e.visible)};return e.subscribe("tooltipStateUpdated",t),()=>{e.unsubscribe("tooltipStateUpdated",t)}}),[e]);const{styles:s,fontsUrl:l,targetDocumentRef:g}=e,h=i.useCallback((()=>{e.hide()}),[e]),p=i.useCallback((()=>{e.emergencyDismiss("Tooltip dismissed on click.")}),[e]);return i.useEffect((()=>{var e,t;const o=new a.J(g),i=new a.J(null!==(t=null===(e=g.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window);return o.addListener("scroll",h,{capture:!0}),i.addListener("resize",h,{capture:!0}),()=>{o.removeAllListeners(),i.removeAllListeners()}}),[h,g]),i.createElement("div",{style:s.container},l&&i.createElement("link",{rel:"stylesheet",href:l}),i.createElement(u.Ay.div,{style:s.shadowBoundary},(()=>{const{top:n,right:r,left:s,ariaLabel:a,title:l,text:u,styles:d,isEccOpen:g}=e;return!o||g?null:i.createElement("div",{role:"status","aria-live":"polite",id:c.y,style:d.shadowRoot},i.createElement("div",{onClick:p,style:Object.assign(Object.assign({},d.root),{top:n,left:s,right:r}),role:"tooltip","aria-label":t.getMessage("combineSentences",[l,a])},i.createElement("div",{"aria-hidden":!0,style:d.tooltipMain},i.createElement("div",{"aria-hidden":!0,style:d.title},l),i.createElement("div",{"aria-hidden":!0,style:d.text},u))))})()))}},90371:(e,t,o)=>{"use strict";o.d(t,{X:()=>k});var i=o(30206),n=o(58943),r=o(9782),s=o(19454),a=o(86336),l=o(59834),c=o(41863),u=o(87333),d=o(57767),g=o(76509),h=o(318),p=o(46921),f=o(30528),m=o(3368),v=o(91799),y=o(48828),b=o(90424),S=o(30225),C=o(15301),w=o(73256);let k=class extends n.z{constructor(e,t,o,i,n,s,a,l){super(),this.localizer=e,this.hostSettings=t,this.presentationDomSettings=o,this.logger=i,this.scriptDirectionDetector=n,this.styleDefinitions=s,this.urlFormatter=a,this.inlineSuggestionsRenderer=l,this._position=void 0,this._title=void 0,this._isVisible=!1,this._targetDocumentRef=void 0,this.getTitleCritique=e=>{var t;switch(e.priority){case r.bx.Low:return e.typeId===r.L9.TopicSuggestion?this.localizer.getMessage("ebx_SquiggleTooltipTopicTitle"):this.localizer.getMessage("ebx_SquiggleTooltipRefinementTitle");case r.bx.Medium:return this.localizer.getMessage("ebx_SquiggleTooltipGrammarTitle");case r.bx.High:return this.localizer.getMessage("ebx_SquiggleTooltipSpellingTitle");case r.bx.Informational:return null!==(t=e.tooltipTitle)&&void 0!==t?t:""}},this.getTitleAutocorrect=()=>this.localizer.getMessage("ebx_SquiggleTooltipAutoCorrectTitle"),this.resetTimeout=()=>{this.originStatusCheckTimer&&(window.clearTimeout(this.originStatusCheckTimer),this.originStatusCheckTimer=void 0)},this.checkOriginState=()=>{var e;null===(null===(e=this.origin)||void 0===e?void 0:e.parentElement)?this.emergencyDismiss("Tooltip dismissed on timeout: the origin is orphaned."):this.setOriginStateCheckTimeout()},this.setOriginStateCheckTimeout=()=>{this.originStatusCheckTimer=window.setTimeout(this.checkOriginState,3e3)}}get fontsUrl(){var e;return null===(e=this.urlFormatter)||void 0===e?void 0:e.getUrl(this.presentationDomSettings.fabricFontsDefinitionPath)}get title(){var e;return null!==(e=this._title)&&void 0!==e?e:""}get text(){if((0,C.kI)(this.squiggleKind))return this.localizer.getMessage("ebx_AutoCorrectTooltipText");{const e=(0,w.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipCombinationMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipCombinationAlt":"ebx_SquiggleTooltipCombination");return`${this.localizer.getMessage("ebx_SquiggleTooltipText")} ${e}`}}get ariaLabel(){return(0,C.kI)(this.squiggleKind)?this.localizer.getMessage("ebx_AutocorrectTooltipAriaText"):(0,w.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipAriaTextMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipAriaTextAlt":"ebx_SquiggleTooltipAriaText")}get isVisible(){return this._isVisible}get top(){return this._position?`${this._position.y}px`:"auto"}get left(){return!this._position||this.scriptDirectionDetector.isRtl()?"auto":`calc(min(100vw - ${this._position.x+300}px, 0px) + ${this._position.x}px)`}get right(){return this._position&&this.scriptDirectionDetector.isRtl()?`calc(100vw - max(${this._position.x}px, 300px))`:"auto"}get styles(){return this.styleDefinitions.tooltip}get isEccOpen(){var e;return!!(null===(e=this.inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo())}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new s.O(document)}async initialize(){}shutDown(){this.hide()}show(e,t,o,i,n){this.resetTimeout(),this.squiggleKind=e,this._title=(0,C.kI)(this.squiggleKind)?this.getTitleAutocorrect():this.getTitleCritique(t),this._position=o,this._isVisible=!!this.hostSettings.showSquiggleTooltip,this.origin=i;const r=null!=n?n:null==i?void 0:i.ownerDocument;this._targetDocumentRef=r&&new s.O(r),this.setOriginStateCheckTimeout();const u=this.logger.getNewActivity(a.n.SquiggleTooltipShown,l.o.SamplingPolicy.CriticalExperimentation);u&&(u.dataFields.push((0,c.n)("CritiqueTypeId",t.typeId)),u.success=!0,u.endNow()),this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:this._position})}hide(){this.resetTimeout(),this.origin=void 0,this._targetDocumentRef=void 0,this._isVisible=!1,this._position=void 0,this.squiggleKind=void 0,this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:void 0})}emergencyDismiss(e){this.logger.warn(545910989,e),this.hide()}};k=(0,i.__decorate)([(0,y._)(),(0,i.__param)(0,(0,b.W)(u.H)),(0,i.__param)(1,(0,b.W)(d.n)),(0,i.__param)(2,(0,b.W)(m.D)),(0,i.__param)(3,(0,b.W)(g.g)),(0,i.__param)(4,(0,b.W)(h.iw)),(0,i.__param)(5,(0,b.W)(v.$)),(0,i.__param)(6,(0,b.W)(p.n)),(0,i.__param)(6,(0,S.l)()),(0,i.__param)(7,(0,S.l)()),(0,i.__param)(7,(0,b.W)(f.V))],k)},4653:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>c}),3023==o.j)var i=o(17916);if(3023==o.j)var n=o(71866);if(3023==o.j)var r=o(91139);if(3023==o.j)var s=o(19955);if(3023==o.j)var a=o(22411);if(3023==o.j)var l=o(48935);class c{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918365)}configureRootServices(e){e.bind(s.i).toValue(i.u),e.bind(n.JY).to(n.yi),e.bind(l.S).toExisting(n.JY),e.bind(r.mU).to(r.XG)}}},80745:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>u}),3023==o.j)var i=o(4653);if(3023==o.j)var n=o(9218);if(3023==o.j)var r=o(91702);if(3023==o.j)var s=o(65871);if(3023==o.j)var a=o(19485);if(3023==o.j)var l=o(99654);if(3023==o.j)var c=o(43179);class u{constructor(){this.imports=[a.r,i.E]}configureRootServices(e){e.bind(l.M).to(c.t),e.bind(n.$).to(n.I),e.bind(r.P).to(s.Q)}}},18846:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>d}),3023==o.j)var i=o(4653);if(3023==o.j)var n=o(19955);if(3023==o.j)var r=o(22411);if(3023==o.j)var s=o(48935);if(3023==o.j)var a=o(38214);if(3023==o.j)var l=o(47529);if(3023==o.j)var c=o(90371);if(3023==o.j)var u=o(28354);class d{constructor(){this.imports=[i.E,u.f]}get uniqueId(){return(0,r.z)(507918353)}configureRootServices(e){e.bind(a.A).to(c.X),e.bind(s.S).toExisting(a.A),e.bind(n.i).toValue(l.F)}}},28354:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>d}),3023==o.j)var i=o(75245);if(3023==o.j)var n=o(11534);if(3023==o.j)var r=o(9005);if(3023==o.j)var s=o(22411);if(3023==o.j)var a=o(57767);if(3023==o.j)var l=o(12470);if(3023==o.j)var c=o(62070);if(3023==o.j)var u=o(15301);class d{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918356)}configureRootServices(e){e.bind(c.g).toDynamicValue((e=>{const t=e.get(a.n),o=e.get(l.c),s=e.getOptional(r.m);return e=>{switch(e){case u.Ah.critique:return new n.FY(t,o);case u.Ah.autocorrection:case u.Ah.personalizedAutocorrection:return new i.QE(t,o,s);default:throw new Error("Unknown squiggle kind")}}}))}}},12535:(e,t,o)=>{"use strict";o.d(t,{S:()=>i});const i=({topicIds:e,topicNames:t,highlightedText:o,hostMetadata:i,requestId:n,source:r,traceId:s})=>{const a=`&body=${encodeURIComponent(`Tell us about your experience with this topic suggestion. Was the suggestion accurate or helpful?\n    \n\n\n\nEngineering notes:\n_______________________________\n\n    TopicIds: ${e}\n\n    TopicNames: ${t}\n\n    HighlightedText: ${o}\n\n    HostMetadata: ${i}\n\n    KMAPIRequestId: ${n}\n\n    Source: ${r}\n\n    TraceId: ${s}\n_______________________________\n`)}`;return"mailto:projecthedleyfeedback@service.microsoft.com?subject=Viva Topics Editor Suggestion Feedback"+encodeURIComponent(": "+o)+a}},65871:(e,t,o)=>{"use strict";o.d(t,{Q:()=>c});var i=o(30206),n=o(76158),r=o(26923),s=o(48828),a=o(30225),l=o(90424);let c=class{constructor(e){var t,o;this.themeStore=e,this.browserSupportsHighContrastMode=null!==(o=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"not all and (forced-colors), (forced-colors), not all and (-ms-high-contrast), (-ms-high-contrast)").matches)&&void 0!==o&&o}get enabled(){var e,t;return(null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme)===r.SV.highContrast||(null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,n.Rr.replace("@media ","")).matches)}};c=(0,i.__decorate)([(0,s._)(),(0,i.__param)(0,(0,a.l)()),(0,i.__param)(0,(0,l.W)(r.YQ))],c)},91702:(e,t,o)=>{"use strict";o.d(t,{P:()=>i});const i=(0,o(48366).f)("IHighContrastModeDetector")},20712:(e,t,o)=>{"use strict";function i(e,t){return e===t||n(e.bottom,t.bottom)&&n(e.height,t.height)&&n(e.left,t.left)&&n(e.right,t.right)&&n(e.top,t.top)&&n(e.width,t.width)}function n(e,t,o=.01){return Math.abs(e-t)<o}o.d(t,{a:()=>i})},9218:(e,t,o)=>{"use strict";o.d(t,{$:()=>l,I:()=>c});var i=o(30206),n=o(48366),r=o(48828),s=o(90424),a=o(13844);const l=(0,n.f)("IContentValidator");let c=class{constructor(e){this.presentationSettings=e}validate(e){if(!e)return"";let t=e;return t.includes("￼")&&(t=t.replace(/￼/g,"")),t.slice(0,this.presentationSettings.maxServiceContentLengthInChars)}};c=(0,i.__decorate)([(0,r._)(),(0,i.__param)(0,(0,s.W)(a.z))],c)},83543:(e,t,o)=>{"use strict";o.d(t,{f:()=>r});var i=o(30206),n=o(48828);let r=class{get tooltip(){return{tooltipMain:{background:"window",boxShadow:"none",border:"1px solid windowframe"},title:{color:"windowtext"},text:{color:"windowtext"}}}};r=(0,i.__decorate)([(0,n._)()],r)},12185:(e,t,o)=>{"use strict";o.d(t,{U:()=>u});var i=o(30206),n=(0,o(62520).a)({}),r=o(58546),s=o(26923);const a=e=>{let t="'Segoe UI'";if(e)switch(e.toLowerCase()){case"ar":t="'Segoe UI Web (Arabic)'";break;case"bg-bg":case"ru-ru":case"uk-ua":t="'Segoe UI Web (Cyrillic)'";break;case"cs-cz":case"et-ee":case"hr-hr":case"hu-hu":case"lt-lt":case"lv-lv":case"pl-pl":case"lt-sr-sp":case"tr-tr":case"sk-sk":case"kk-kz":t="'Segoe UI Web (East European)'";break;case"el-gr":t="'Segoe UI Web (Greek)'";break;case"he-il":t="'Segoe UI Web (Hebrew)'";break;case"vi-vn":t="'Segoe UI Web (Vietnamese)'";break;case"ja-jp":t="YuGothic, 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka";break;case"ko-kr":t="'Malgun Gothic', Gulim";break;case"ch-zhs":t="'Microsoft Yahei', Verdana, Simsun";break;case"ch-zht":t="'Microsoft Jhenghei', Pmingliu";break;case"hi-in":t="'Nirmala UI'";break;case"th-th":t="'Leelawadee UI Regular', 'Kmer UI'";break;default:t="'Segoe UI Web (West European)'"}return`${t}, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif`};var l=o(48828),c=o(94664);let u=class{constructor(e,t,o){this.uxLanguageCode=e,this.themeStore=t,this.useFluentV9=o,this._calloutZIndex=Number.MAX_SAFE_INTEGER-1}get critiqueCallout(){return{shadowHost:{all:"initial",position:"absolute",zIndex:this._calloutZIndex},calloutMain:{root:{fontFamily:a(this.uxLanguageCode),borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:[{borderRadius:8,MsHighContrastAdjust:"auto",fontFamily:a(this.uxLanguageCode)}]},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get undoCallout(){return{buttonIcon:{borderRadius:"2px"},logoButtonBase:{cursor:"default",pointerEvents:"all",lineHeight:"24px",fontSize:r.s.size12,fontWeight:r.BO.semibold,WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",padding:0,margin:"0 8px",flexGrow:0,whiteSpace:"nowrap",overflow:"visible",color:n.palette.blue,alignSelf:"center"},calloutContainer:{height:"40px",borderRadius:"4px",padding:"4px"},calloutMain:{root:{borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:{borderRadius:8,MsHighContrastAdjust:"auto",background:c.L.colorNeutralBackground1}},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get tooltip(){var e,t,o,i,r;const l=this.useFluentV9||null===(e=this.themeStore)||void 0===e?void 0:e.getComponentActiveTheme(s.yF.squiggleTooltipComponentName);return{container:{all:"initial",position:"absolute",zIndex:Number.MAX_SAFE_INTEGER},shadowBoundary:{all:"initial"},shadowRoot:{width:"0px !important",height:"0px !important",overflowX:"hidden"},root:{position:"fixed",maxWidth:300,background:this.useFluentV9?c.L.colorNeutralBackground1:"transparent",border:"none",cursor:"default"},tooltipMain:{msHighContrastAdjust:"none",forcedColorAdjust:"none",fontFamily:a(this.uxLanguageCode),fontSize:"12px",fontWeight:600,background:this.useFluentV9?void 0:null!==(t=null==l?void 0:l.background)&&void 0!==t?t:n.palette.white,padding:"6px 12px",display:"inline-block",boxShadow:this.useFluentV9?`0 6.4px 14.4px 0 ${c.L.colorNeutralShadowKey}, 0 1.2px 3.6px 0 ${c.L.colorNeutralShadowAmbient}`:null!==(o=null==l?void 0:l.shadow)&&void 0!==o?o:"0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",border:"none",borderRadius:4},title:{marginBottom:"4px",color:this.useFluentV9?c.L.colorNeutralForeground2:null!==(i=null==l?void 0:l.text)&&void 0!==i?i:n.palette.neutralSecondary},text:{color:this.useFluentV9?c.L.colorNeutralForeground3:null!==(r=null==l?void 0:l.altText)&&void 0!==r?r:n.palette.black}}}};u=(0,i.__decorate)([(0,l._)()],u)},77277:(e,t,o)=>{"use strict";o.d(t,{Y:()=>m,bb:()=>b,c$:()=>y});var i=o(30206),n=o(22779),r=o(85937),s=o(24902),a=o(50413),l=o(67686),c=o(91702),u=o(46546),d=o(48366),g=o(48828),h=o(90424),p=o(30225),f=o(77251);const m=(0,d.f)("IDefaultStyleDefinitionsFactory"),v=(0,d.f)("IDefaultStyleOverrides"),y=(0,d.f)("IHighContrastStyleOverrides");let b=class{constructor(e,t,o,i,s,a,l){this.highContrastModeDetector=e,this.proofingStore=t,this.emitter=o,this.defaultStyleDefinitionsFactory=s,this.highContrastStyleOverrides=a,this.styleOverrides=l,this.onProofingLanguageChanged=e=>{this.styles=this.defineStyles()},this.defineStyles=()=>{const e=this.defaultStyleDefinitionsFactory(this.uxLanguage);return this.styleOverrides?{critiqueCallout:this.applyOverrides(e.critiqueCallout,this.styleOverrides.critiqueCallout),undoCallout:this.applyOverrides(e.undoCallout,this.styleOverrides.undoCallout),tooltip:this.applyOverrides(e.tooltip,this.styleOverrides.tooltip)}:e},this.getAdjustedStyle=e=>{let t=this.styles[e];return this.highContrastModeDetector.enabled&&this.highContrastStyleOverrides&&(t=this.applyOverrides(t,this.highContrastStyleOverrides[e])),t},this.applyOverrides=(e,t)=>{if(!t)return e;const o={};for(const i of Object.keys(e))o[i]=Object.assign(Object.assign({},e[i]),t[i]);return o},this.uxLanguage=i.getUILanguage(),this.styles=this.defineStyles(),this.proofingStore.read(n.l.ProofingLanguages).then((e=>{this.onProofingLanguageChanged(r.I.getDefaultLanguageCode(e))})).catch((()=>{})),this.emitter.on("proofingLanguageChanged",(async e=>{this.onProofingLanguageChanged(e.data.defaultLanguageCode)})),(0,f.Gn)(this)}get critiqueCallout(){return this.getAdjustedStyle("critiqueCallout")}get undoCallout(){return this.getAdjustedStyle("undoCallout")}get tooltip(){return this.getAdjustedStyle("tooltip")}};(0,i.__decorate)([u.observable],b.prototype,"styles",void 0),(0,i.__decorate)([u.computed],b.prototype,"critiqueCallout",null),(0,i.__decorate)([u.computed],b.prototype,"undoCallout",null),(0,i.__decorate)([u.computed],b.prototype,"tooltip",null),(0,i.__decorate)([u.action],b.prototype,"onProofingLanguageChanged",void 0),b=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,h.W)(c.P)),(0,i.__param)(1,(0,h.W)(s.K)),(0,i.__param)(2,(0,h.W)(a.o)),(0,i.__param)(3,(0,h.W)(l.v)),(0,i.__param)(4,(0,h.W)(m)),(0,i.__param)(5,(0,p.l)()),(0,i.__param)(5,(0,h.W)(y)),(0,i.__param)(6,(0,p.l)()),(0,i.__param)(6,(0,h.W)(v))],b)},91096:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>l}),3023==o.j)var i=o(4653);if(3023==o.j)var n=o(19955);if(3023==o.j)var r=o(81317);if(3023==o.j)var s=o(2834);if(3023==o.j)var a=o(22411);class l{constructor(){this.imports=[s.Q,i.E]}get uniqueId(){return(0,a.z)(507918302)}configureRootServices(e){e.bind(n.i).toValue(r._)}}},96801:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>v}),3023==o.j)var i=o(80745);if(3023==o.j)var n=o(35612);if(3023==o.j)var r=o(91799);if(3023==o.j)var s=o(51705);if(3023==o.j)var a=o(2713);if(3023==o.j)var l=o(12185);if(3023==o.j)var c=o(19955);if(3023==o.j)var u=o(83543);if(3023==o.j)var d=o(77277);if(3023==o.j)var g=o(22411);if(3023==o.j)var h=o(48935);if(3023==o.j)var p=o(57767);var f=o(26923);if(3023==o.j)var m=o(34139);class v{constructor(){this.imports=[i.E,m.h]}get uniqueId(){return(0,g.z)(507918293)}configureRootServices(e){e.bind(c.i).toValue(s.r),e.bind(n.v).to(a.b),e.bind(h.S).toExisting(n.v),e.bind(r.$).to(d.bb),e.bind(d.c$).to(u.f),e.bind(d.Y).toDynamicValue((e=>{const t=e.getOptional(f.YQ),o=e.get(p.n);return e=>new l.U(e,t,!!o.useFluentV9)}))}}},24319:(e,t,o)=>{"use strict";if(o.d(t,{O:()=>a}),3023==o.j)var i=o(18846);if(3023==o.j)var n=o(28354);if(3023==o.j)var r=o(8238);if(3023==o.j)var s=o(22411);class a{constructor(){this.imports=[r.C,i.D,n.f]}get uniqueId(){return(0,s.z)(507918281)}configureRootServices(e){}}},94725:(e,t,o)=>{"use strict";o.d(t,{C:()=>u});var i=o(82154),n=o(2980),r=o(293),s=o(97069),a=o(93261),l=o(95734);const c=(0,s.F5)({squigglerCanvasRenderingState:a.A.on(i.C),contentEditableSquigglerComponent:a.A.on(n.u).optional(),inputControlsSquigglerComponent:a.A.on(r.$K).optional()}),u=()=>{const{contentEditableSquigglerComponent:e,inputControlsSquigglerComponent:t,squigglerCanvasRenderingState:o}=(0,s.KN)(c),i=[],n=[],[r,a]=l.useState(o);if(l.useEffect((()=>(o.subscribe("stateUpdated",a),()=>{o.unsubscribe("stateUpdated",a)})),[o]),!r.visible)return null;if(e)for(const[t,n]of r.squigglers)o.getTileVisibility(n.proofedElements[0].id)&&i.push(e(t,n));if(t)for(const e of r.inputControlsProxyList)n.push(t(e));return l.createElement(l.Fragment,null,...n,...i)}},76805:(e,t,o)=>{"use strict";o.d(t,{D:()=>j});var i=o(30206),n=o(58943),r=o(60832),s=o(85921),a=o(19454),l=o(25808),c=o(50413),u=o(82448),d=o(76509),g=o(3998),h=o(12470),p=o(57767),f=o(14560),m=o(15301);class v{constructor(e,t,o,i,n,r,s){this.hostSettings=e,this.calloutStateStore=t,this.undoCalloutStateStore=o,this.squiggleTooltipStateStore=i,this.critiqueStore=s,this.squigglerFlagCritiqueHandler=new f.G(t,n,o,r)}hideCallout(){var e;this.calloutStateStore.isVisible&&!this.calloutStateStore.isApplyingCritiqueAction&&(this.calloutStateStore.recordInstrumentationEventId(12),this.calloutStateStore.hide()),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}async showCallout(e){var t,o,i,n;null===(t=this.squiggleTooltipStateStore)||void 0===t||t.hide();const s=null===(o=this.critiqueStore)||void 0===o?void 0:o.getCritique(e.critique.traceId,e.critique.nodeId),a=Object.assign(Object.assign({},e),{critique:s?(0,r.OE)(s):e.critique});if(!(null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.squigglerSettings)||void 0===n?void 0:n.onSquiggleClicked)||this.hostSettings.serviceSettings.squigglerSettings.onSquiggleClicked(a.critique))if((0,r.r3)(a.critique))await this.squigglerFlagCritiqueHandler.showFlagCritique(a);else{if(this.undoCalloutStateStore&&e.squiggleKind===m.Ah.autocorrection)return this.undoCalloutStateStore.show(a);await this.calloutStateStore.show(a)}}}class y{constructor(e,t,o,i){this.squiggleTooltipStateStore=e,this.calloutStateStore=t,this.undoCalloutStateStore=o,this.featureFlagsReader=i}showTooltip(e){var t,o,i,n,r;const{squiggleKind:s,critique:a,position:l,origin:c,targetDocument:u}=e;if(!(null===(t=this.calloutStateStore)||void 0===t?void 0:t.isVisible)&&!(null===(o=this.undoCalloutStateStore)||void 0===o?void 0:o.isVisible)){if(!c&&!(null===(i=this.featureFlagsReader)||void 0===i?void 0:i.flags.enableCSSHighlightApiSquiggleRendering))return;(null===(n=this.squiggleTooltipStateStore)||void 0===n?void 0:n.isVisible)&&this.squiggleTooltipStateStore.hide(),null===(r=this.squiggleTooltipStateStore)||void 0===r||r.show(s,a,l,c,u)}}hideTooltip(){var e;null===(e=this.squiggleTooltipStateStore)||void 0===e||e.hide()}}var b=o(2980),S=o(293),C=o(35612),w=o(38214),k=o(59708),T=o(30528),x=o(84858),_=o(76706),I=o(48366);const E=(0,I.f)("ICritiqueCardNativeApi");(0,I.f)("IECCNativeApi");var A=o(56554),B=o(65339),R=o(55431),M=o(98556),D=o(1845),P=o(48828),N=o(90424),F=o(30225),O=o(46546);let j=class extends n.z{constructor(e,t,o,i,n,c,u,d,g,h,p,f,m,b,S,C,w,k,T){super(),this.proofingEventListener=e,this.squigglerStateStoreFactory=t,this.inputControlsStateStoreFactory=o,this.calloutStateStore=i,this.settings=n,this.guidGenerator=c,this.squiggleTooltipStateStore=u,this._logger=d,this.critiqueApplicationHandler=g,this.proofingDom=h,this.safeWindow=p,this.tileContent=f,this.featureFlagsReader=m,this.hostSettings=b,this.inlineSuggestionsRenderer=S,this.squigglePositioningEdgeCases=C,this.undoCalloutStateStore=w,this.nativeApi=k,this.critiqueStore=T,this.anchorElements=new Map,this.squigglers=new Map,this.visible=!0,this.tileVisibility=new Map,this.inputControlsProxyList=[],this._inputControlsProxyListCache=[],this.setVisibility=e=>{this.visible=e,this.publishStateChange()},this.setVisibilityForTile=(e,t)=>{var o,i,n,r,s,a,l,c;if(this.tileVisibility.set(e,t),!t){e===(null===(i=null===(o=this.inlineSuggestionsRenderer)||void 0===o?void 0:o.getCurrentMenuInfo())||void 0===i?void 0:i.parentTileId)&&this.inlineSuggestionsRenderer.dismissMenu();const t=null===(n=this.calloutStateStore.critique)||void 0===n?void 0:n.nodeId,u=this.proofingDom.findParagraphNode(null!=t?t:"");e===(null===(r=null==u?void 0:u.parent)||void 0===r?void 0:r.id)&&this.calloutStateStore.hide();const d=null===(a=null===(s=this.undoCalloutStateStore)||void 0===s?void 0:s.critique)||void 0===a?void 0:a.nodeId,g=this.proofingDom.findParagraphNode(null!=d?d:"");e===(null===(l=null==g?void 0:g.parent)||void 0===l?void 0:l.id)&&(null===(c=this.undoCalloutStateStore)||void 0===c||c.hide())}this.publishStateChange()},this.getTileVisibility=e=>{var t;return null===(t=this.tileVisibility.get(e))||void 0===t||t},this.getSquigglerForTile=e=>{const t=this.anchorElements.get(e);return t?this.squigglers.get(t.id):void 0},this.getCritiqueCount=e=>{var t;return!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null!==(t=null==e?void 0:e.getCritiques().length)&&void 0!==t?t:0},this.update=e=>(!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null==e?void 0:e.updateSquiggles()),this.updateSquiggleRanges=e=>{if(e)return void e.updateRanges();if(0===this.squigglers.size)return;const t=new Set(this.squigglers.values());for(const e of t)e.updateRanges()},this.navigate=(e,t)=>{!t&&this.squigglers.size>0&&(t=Array.from(this.squigglers.values())),t&&(this.calloutStateStore.setNavInfo({stores:t,ctr:"contenteditable",currentIndex:0,category:"category",onCloseNavigation:()=>{e()},onNavSuggestionApplied:()=>{this.calloutStateStore.navigate(0)}}),this.calloutStateStore.navigate(0))},this.clearSquiggles=(e,t,o)=>{1===e.proofedElements.length&&e.proofedElements[0].id===t?(this.anchorElements.delete(t),this.squigglers.delete(o),this.publishStateChange(),e.dispose()):e.removeCritiques(t).then((()=>{e.isEmpty&&(this.squigglers.delete(o),this.anchorElements.delete(t),e.dispose()),this.publishStateChange()}))},this.displayFlag=async e=>{const t={critique:e,issueText:"",setInitialFocus:!1,onDismiss(e){},onIgnoreOnce:this.onIgnoreOnce,onIgnoreAll:this.onIgnoreAll,onApplyFlag:this.onApplyFlag};await this.critiqueCalloutHandler.showCallout(t)},this.onApplyFlag=async(e,t,o)=>{await this.applyChange(e,(async(i,n)=>{await i.applyFlagSuggestion(n,void 0,e.nodeId,e,t,o)}))},this.applyChange=(e,t)=>{const o=this.proofingDom.findParagraphNode(e.nodeId);return(0,B.l)(o)&&o.parent.element?t(this.critiqueApplicationHandler,o.parent.element):Promise.resolve()},this.onIgnoreOnce=e=>{(0,r.r3)(e)&&this.applyChange(e,((t,o)=>{t.ignoreFlagOnce(o,void 0,e.nodeId,e)}))},this.onIgnoreAll=e=>{(0,r.r3)(e)&&this.applyChange(e,((t,o)=>{t.ignoreAllOfCritique(o,void 0,e.nodeId,e)}))},this.setSquiggler=(e,t)=>{this.squigglers.set(e,t),this.publishStateChange()},this.notifyHost=e=>{var t,o;const i=e.data.critiquesToElementsMap;if(e.messageType===s.G.NewData)for(const e of i)null===(t=this.nativeApi)||void 0===t||t.critiqueCountChanged(e.critiques.length);else if(e.messageType===s.G.RemoveData)for(const e of i)this.anchorElements.get(e.elementId)&&(null===(o=this.nativeApi)||void 0===o||o.critiqueCountChanged(e.critiques.length))},this.getAnchorElement=(e,t)=>{var o;let i=this.anchorElements.get(e);if(i){const t=i.elementRef.deref();if(null==t?void 0:t.isConnected)return i;this.clearSquiggler(e),this.anchorElements.delete(e)}let n=t;const r=null===(o=this.squigglePositioningEdgeCases)||void 0===o?void 0:o.getEdgeCases(),s=null==r?void 0:r.find((e=>e.match(t)));if(null==s?void 0:s.getAnchorElement){let o;n=s.getAnchorElement(t);for(const t of this.anchorElements.values())t.elementRef.deref()===n&&(this.anchorElements.set(e,t),o=t);i=o}else{if(t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(n=e)}if("true"===n.getAttribute(this.settings.editorSpellcheckAttribute)){let t;for(const o of this.anchorElements.values())o.elementRef.deref()===n&&(this.anchorElements.set(e,o),t=o);i=t}}return i||(i={id:this.guidGenerator.generate(),elementRef:new a.O(n)},this.anchorElements.set(e,i)),i},this._zoomScale=1,this.updateInputControlsProxyListCache=e=>{0===this._inputControlsProxyListCache.length&&0===e.length||(this._inputControlsProxyListCache=e,this.safeWindow.requestAnimationFrame((()=>{0===this.inputControlsProxyList.length&&0===this._inputControlsProxyListCache.length||(this.inputControlsProxyList=this._inputControlsProxyListCache,this.publishStateChange())})))},this.buildInputAndTextAreaList=e=>{if(!this.inputControlsStateStoreFactory)return;this._inputControlsProxyListCache=this._inputControlsProxyListCache.map((e=>(e.messageItem.changed=!1,e)));const t=e.data.critiquesToElementsMap;for(const e of t){if(!e.element)continue;const t=this.tileContent.getContainingElement(e.element);if(!t)continue;if(!(0,l.C)(t,"HTMLInputElement")&&!(0,l.C)(t,"HTMLTextAreaElement"))continue;const o=this.getAnchorElement(e.elementId,t);if(o){this._inputControlsProxyListCache=this._inputControlsProxyListCache.filter((e=>e.messageItem.anchor.id!==o.id));const t={entry:{elementId:e.elementId,element:e.element,critiques:e.critiques},anchor:{element:o.elementRef.deref(),id:o.id},changed:!0};this._inputControlsProxyListCache.push(this.inputControlsStateStoreFactory({messageItem:t,critiqueCalloutHandler:this.critiqueCalloutHandler,tooltipHandler:this.tooltipHandler,disableClearOnFocusFix:!1}))}}this.updateInputControlsProxyListCache(this._inputControlsProxyListCache)},this.buildContentEditableList=async e=>{if(!this.squigglerStateStoreFactory)return;const t=e.data.critiquesToElementsMap;if(e.messageType===s.G.NewData||e.messageType===s.G.ChangeData)await(0,O.transaction)((async()=>{if(this.squigglerStateStoreFactory)for(const o of t){if(!o.element)continue;const t=this.proofingDom.findTileNode(o.elementId);if(!t)continue;const i=this.tileContent.getContainingElement(o.element);if(!i)continue;if((0,l.C)(i,"HTMLInputElement")||(0,l.C)(i,"HTMLTextAreaElement")||!(0,l.C)(i,"HTMLElement"))continue;const n=this.getAnchorElement(o.elementId,i);let r;if(n&&(r=this.squigglers.get(n.id)),!n||!o.critiques.length){n&&r&&!o.critiques.length&&this.clearSquiggles(r,o.elementId,n.id);continue}const s={id:o.elementId,graphNode:t,element:i,critiques:o.critiques};r?await r.setCritiques(s,e.data.isVisualStateChange):(r=this.squigglerStateStoreFactory(s,n.elementRef.deref(),n.id,this.critiqueCalloutHandler,this.tooltipHandler),1!==this._zoomScale&&r.scaleTransform(this._zoomScale),this.setSquiggler(n.id,r))}}));else if(e.messageType===s.G.RemoveData)for(const e of t)this.clearSquiggler(e.elementId)},this.critiqueCalloutHandler=new v(this.hostSettings,this.calloutStateStore,this.undoCalloutStateStore,this.squiggleTooltipStateStore,this.inlineSuggestionsRenderer,this._logger,this.critiqueStore),this.tooltipHandler=new y(this.squiggleTooltipStateStore,this.calloutStateStore,this.undoCalloutStateStore,this.featureFlagsReader)}async initialize(){this.proofingEventListener.emit("squiggleUXReadyEvent",{messageType:s.G.NewData})}shutDown(){var e;if(this.squigglers.size)for(const e of this.squigglers.values())e.dispose();this.squigglers.clear(),this.anchorElements.clear(),this.calloutStateStore.hide(),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide(),this.publishStateChange()}publishStateChange(){this.publishEvent("stateUpdated",{squigglers:this.squigglers,inputControlsProxyList:this.inputControlsProxyList,visible:this.visible})}clearSquiggler(e){const t=this.anchorElements.get(e);if(!t)return;const o=this.squigglers.get(t.id);o&&this.clearSquiggles(o,e,t.id)}async onCritiqueForUiEvent(e){this.buildInputAndTextAreaList(e),await this.buildContentEditableList(e),this.notifyHost(e)}setZoomScale(e){this._zoomScale=e;for(const[,t]of this.squigglers)t.scaleTransform(e)}};j=(0,i.__decorate)([(0,P._)(),(0,i.__param)(0,(0,N.W)(c.o)),(0,i.__param)(1,(0,F.l)()),(0,i.__param)(1,(0,N.W)(b.f)),(0,i.__param)(2,(0,F.l)()),(0,i.__param)(2,(0,N.W)(S.iV)),(0,i.__param)(3,(0,N.W)(C.v)),(0,i.__param)(4,(0,N.W)(R.k)),(0,i.__param)(5,(0,N.W)(u.G)),(0,i.__param)(6,(0,N.W)(w.A)),(0,i.__param)(6,(0,F.l)()),(0,i.__param)(7,(0,N.W)(d.g)),(0,i.__param)(8,(0,N.W)(k.i)),(0,i.__param)(9,(0,N.W)(M.w)),(0,i.__param)(10,(0,N.W)(g.j)),(0,i.__param)(11,(0,N.W)(D.d)),(0,i.__param)(12,(0,N.W)(h.c)),(0,i.__param)(13,(0,N.W)(p.n)),(0,i.__param)(14,(0,F.l)()),(0,i.__param)(14,(0,N.W)(T.V)),(0,i.__param)(15,(0,F.l)()),(0,i.__param)(15,(0,N.W)(x._)),(0,i.__param)(16,(0,F.l)()),(0,i.__param)(16,(0,N.W)(_.x)),(0,i.__param)(17,(0,F.l)()),(0,i.__param)(17,(0,N.W)(E)),(0,i.__param)(18,(0,F.l)()),(0,i.__param)(18,(0,N.W)(A.$))],j)},93161:(e,t,o)=>{"use strict";const i=new(o(68008).diff_match_patch);i.Diff_Timeout=0;const n=(e,t)=>e.index>=0?(e.index=t,e):t;addEventListener("message",(e=>{"get-url"!==e.data[0]?(e=>{try{const o=[],r=e.data[0],s=e.data[1],a=e.data[2],l=i.diff_main(r,s);1===l.length&&0===l[0][0]&&e.ports[0].postMessage({result:a});let c=0,u=0,d=0,g=0,h=0,p=0;for(const e of l){const i=e[0],r=e[1].length;switch(i){case 0:h=r,p=r;break;case 1:h=0,p=r;break;case-1:d+=r;continue}u+=d,d=0;for(let e=c;e<a.length;e+=1){const r=(t=a[e]).index>=0?t.index:t;if(r<g)throw new Error("Indices are not sorted!");if(!(r>=g&&r<g+p))break;o[e]=n(a[e],0===i?r+u-g:u),c+=1}if(c===a.length)break;u+=h,g+=p}for(let e=c;e<a.length;e+=1)o[e]=n(a[e],u);e.ports[0].postMessage({result:o})}catch(t){e.ports[0].postMessage({error:t})}var t})(e):e.ports[0].postMessage({url:self.location.href})}),!1)},93589:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>F}),3023==o.j)var i=o(28354);if(3023==o.j)var n=o(2980);if(3023==o.j)var r=o(62070);if(3023==o.j)var s=o(5623);if(3023==o.j)var a=o(92049);if(3023==o.j)var l=o(26371);if(3023==o.j)var c=o(91139);if(3023==o.j)var u=o(6814);if(3023==o.j)var d=o(83773);if(3023==o.j)var g=o(29631);if(3023==o.j)var h=o(91702);if(3023==o.j)var p=o(56554);if(3023==o.j)var f=o(5275);if(3023==o.j)var m=o(97569);if(3023==o.j)var v=o(9005);if(3023==o.j)var y=o(1845);if(3023==o.j)var b=o(98556);if(3023==o.j)var S=o(15228);if(3023==o.j)var C=o(67680);if(3023==o.j)var w=o(99654);if(3023==o.j)var k=o(89968);if(3023==o.j)var T=o(1208);if(3023==o.j)var x=o(22411);if(3023==o.j)var _=o(3998);if(3023==o.j)var I=o(12470);if(3023==o.j)var E=o(44074);if(3023==o.j)var A=o(76509);if(3023==o.j)var B=o(55077);if(3023==o.j)var R=o(57767);if(3023==o.j)var M=o(23987);if(3023==o.j)var D=o(19989);if(3023==o.j)var P=o(34732);var N=o(95734);class F{constructor(){this.imports=[i.f]}get uniqueId(){return(0,x.z)(507847257)}configureRootServices(e){e.bind(n.u).toDynamicValue((e=>{const t=e.get(_.j),o=e.get(I.c),i=e.get(r.g),n=e.get(h.P);return(e,r)=>N.createElement(s.$,{key:`squiggler-${e}`,state:r,deps:{safeWindow:t,featureFlagsReader:o,squigglerUXFactory:i,highConstrastModeDetector:n}})})),e.bind(a.Vw).to(l.U),e.bind(n.f).toDynamicValue((t=>{const o=e.get(y.d),i=e.get(E.f),n=e.get(A.g),r=e.getAll(B.zJ),s=e.get(B.M5),l=e.get(R.n),h=e.get(b.w),x=e.get(a.Vw),_=e.getOptional(S.M),I=e.getOptional(C.Ey),N=e.getOptional(c.mU),F=e.getOptional(M.z),O=e.getOptional(w.M),j=e.getOptional(k.W),q=e.getOptional(p.$),L=e.getOptional(f.a),H=e.getOptional(m.K),z=e.getOptional(T.s),W=e.getOptional(D.rI),G=e.getOptional(u.PF),U=e.getOptional(v.m),V=e.getOptional(d.A);return(t,a,c,u,d,p={})=>new g.i({proofedItem:t,anchorElement:a,anchorId:c,critiqueCalloutHandler:u,tooltipHandler:d,options:e.get(P.z)(p)},o,i,r,s,l,h,x,n,_,I,N,F,O,j,q,L,H,z,W,G,U,V)}))}}},34732:(e,t,o)=>{"use strict";if(o.d(t,{S:()=>d,z:()=>u}),3023==o.j)var i=o(22411);if(3023==o.j)var n=o(12470);if(3023==o.j)var r=o(57767);if(3023==o.j)var s=o(46421);if(3023==o.j)var a=o(84858);if(3023==o.j)var l=o(73701);if(3023==o.j)var c=o(17966);const u=(0,o(48366).f)("ISquigglerOptionsFactory");class d{constructor(){this.imports=[]}get uniqueId(){return(0,i.z)(507918274)}configureRootServices(e){e.bind(u).toDynamicValue((e=>{const t=e.get(n.c),o=e.get(r.n),i=e.getOptional(a._);return(e={})=>{const n=t.flags.enableSvgSquiggleUnderline?s.N.SVG:o.sessionType===r.d.OWA_New_Email||o.sessionType===r.d.OWA_Draft_Email?s.N.OFFICE:s.N.GENERIC;e.edgeCases=null==i?void 0:i.getEdgeCases(),e.visibilityTracker=t.flags.enableVisibilityTracker?new l.J:l.Y,e.throttleUpdates=t.flags.enableSquigglesUpdateThrottling,e.visibilityTrackerShouldTrackSquiggles=t.flags.visibilityTrackerShouldTrackSquiggles,e.mutationObserverBasedRelativePosition=t.flags.mutationObserverBasedRelativePosition,e.enableCursorIntersectionObserver=t.flags.enableCursorIntersectionObserver,e.disableAutoBrowserVirtualizationOfSquiggles=t.flags.disableAutoBrowserVirtualizationOfSquiggles;let a=c.j.none;t.flags.enableAriaStatusElement&&(t.flags.enableCssHighlightApiAnnouncementsOnly?a|=c.j.cssHighlightsAPIAnnouncement:t.flags.enableCssHighlightApiAnnouncementsOnlyForSpellingAndGrammar?a|=c.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar:a|=c.j.appearance|c.j.highlight,t.flags.enableLineNavAriaAnnouncement&&(a|=c.j.lineNavigation));const u=e;return u.restoreCaretPosition=!!o.enableCaretPositionRestore,u.ariaFeatures=a,u.tooltipEnabled=!!o.showSquiggleTooltip,u.disableSquiggleTooltipOnTextSelection=!!o.disableSquiggleTooltipOnTextSelection,u.squiggleStyleType=n,u.autoCorrectionEnabled=o.enableAutoCorrect,u.personalizedAutoCorrectionEnabled=o.enablePersonalizedAutoCorrect,u.autoCorrectionInputCacheEnabled=o.enableAutoCorrect&&t.flags.enableAutoCorrectInputCache,u.trackProofingElementsPositionEnabled=o.dynamicProofingElementsEnabled,u.disableRangeWhenApplyingCritiqueSuggestions=o.disableRangeWhenApplyingCritiqueSuggestions,u.disableOpenAutoCorrectCalloutOnHover=o.disableOpenAutoCorrectCalloutOnHover,u}}))}}},8238:(e,t,o)=>{"use strict";if(o.d(t,{C:()=>u}),3023==o.j)var i=o(19955);if(3023==o.j)var n=o(22411);if(3023==o.j)var r=o(48935);if(3023==o.j)var s=o(28354);if(3023==o.j)var a=o(82154);if(3023==o.j)var l=o(94725);if(3023==o.j)var c=o(76805);class u{constructor(){this.imports=[s.f]}get uniqueId(){return(0,n.z)(507918273)}configureRootServices(e){e.bind(i.i).toValue(l.C),e.bind(a.C).to(c.D),e.bind(r.S).toExisting(a.C)}}},76158:(e,t,o)=>{"use strict";o.d(t,{CJ:()=>r,Rr:()=>n});const i="(-ms-high-contrast: active), (forced-colors: active)",n="@media screen and "+i;class r{get isHighContrastActive(){return window.matchMedia(i).matches}get isHighContrastBlack(){return window.matchMedia("(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)").matches}get isHighContrastWhite(){return window.matchMedia("(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)").matches}}new r},69849:(e,t,o)=>{"use strict";if(o.d(t,{r:()=>r}),3023==o.j)var i=o(97069);var n=o(95734);function r(e,t){var o;const r=o=>{const r=(0,i.KN)(t);return o.deps?n.createElement(e,Object.assign({},o)):n.createElement(e,Object.assign({},o,{deps:r}))},s=null!==(o=e.displayName)&&void 0!==o?o:e.name;return r.displayName=`${s}DepsResolver`,r}},83273:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>v}),3023==o.j)var i=o(24259);if(3023==o.j)var n=o(85209);if(3023==o.j)var r=o(25426);if(3023==o.j)var s=o(55384);if(3023==o.j)var a=o(83757);if(3023==o.j)var l=o(50725);if(3023==o.j)var c=o(70168);if(3023==o.j)var u=o(1513);if(3023==o.j)var d=o(74654);if(3023==o.j)var g=o(1972);if(3023==o.j)var h=o(16137);const p={requiredFlights:["mc-editor-oa","mc-editor-oa-client-ecc"],isFeatureEnabled:(e,t)=>!0===(null==t?void 0:t.some((t=>t===e)))},f={};class m{constructor(e,t,o,i){this.refreshCadence=e,this.augloopSession=t,this.timer=o,this._logger=i}start(){this.timer.setIntervalWithDelay("refreshGraphSearchData",(()=>this.tryRefresh()),this.refreshCadence,this.refreshCadence)}stop(){this.timer.clearTimer("refreshGraphSearchData")}async tryRefresh(){if(this.augloopSession.isClosed)return;const e={parentPath:["session","doc"],items:[{id:"0",body:new n.$9({forceRefresh:!1})}]};this.augloopSession.submitOperation(new i.Xr(e))}onRefreshDone(){this._logger.info(507349215,"Graph search data refresh done")}}class v{constructor(e,t,o){var i,n,r,s,a,l,c,u,d,g;this.timer=o,this.defaultRefreshInterval=3e5,this.annotationListenerType="",this.config=e,this._logger=t,this.requiredSetting(null===(i=this.config.oaSettings)||void 0===i?void 0:i.enableOaClient,"oaSettings.enableOaClient"),this.requiredSetting(null===(r=null===(n=this.config.serviceSettings)||void 0===n?void 0:n.hybridAugloop)||void 0===r?void 0:r.enabled,"serviceSettings.hybridAugloop.enabled"),this.requiredSetting(null===(a=null===(s=this.config.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.enableGraphSearchLocal,"serviceSettings.hybridAugloop.enableGraphSearchLocal"),this.requiredSetting(null===(l=this.config.orchestratorSettings)||void 0===l?void 0:l.enableAugLoop,"orchestratorSettings.enableAugLoop"),this.requiredSetting(!!(null===(c=this.config.orchestratorSettings)||void 0===c?void 0:c.substrateAuthTokenCallback),"orchestratorSettings.substrateAuthTokenCallback"),this.checkRequiredFlights(this.config.flightsToTrack),this.cacheGetter=(null===(g=null===(d=null===(u=this.config.serviceSettings)||void 0===u?void 0:u.hybridAugloop)||void 0===d?void 0:d.wasmConfig)||void 0===g?void 0:g.disableModuleCache)?()=>f:void 0,this.config.orchestratorSettings?(this.config.orchestratorSettings.preRuntimeInit=this.config.orchestratorSettings.preRuntimeInit||[],this.config.orchestratorSettings.preRuntimeInit.push(((e,t)=>this.preRuntimeInit(e,t)))):this._logger.error(507349214,"OrchestratorSettings missing. Required for Hybrid ECC"),this.eccEnabled=(e=>{var t;return!!(null===(t=e.oaSettings)||void 0===t?void 0:t.enableOaClient)})(e),this.eccEnabled||this._logger.warn(507349213,"Hybrid ECC workflows are not enabled.  Consider excluding Hybrid plugin support to reduce overall package size.")}get wasmScriptPath(){var e,t,o;return(0,d.Gm)(null===(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.wasmConfig)||void 0===o?void 0:o.scriptPath)}preRuntimeInit(e,t){return t.inferenceServiceFactory=l._.createFactory(this.wasmScriptPath,(0,d.$A)(this.config),this.cacheGetter),t.modelDownloader=new a.$(e.appName,"fs.microsoft.com/fs/augmentationLoop","res.cdn.office.net/polymer/models"),Promise.resolve()}requiredSetting(e,t){e||this._logger.error(507349212,`Required setting ${t} for hybrid wasn't set.`,t)}checkRequiredFlights(e){const t=p.requiredFlights.filter((t=>!p.isFeatureEnabled(t,e)));0!==t.length&&this._logger.error(507349211,`Hybrid requires these flights be enabled: ${t}`,t)}async activateAnnotations(e){if(!e||!this.eccEnabled)return;e.registerLocalWorkflow(g.A);const t=this.wasmScriptPath||"",o=(0,d.uz)(this.config),i={wasmRoot:t,locateFile:e=>(0,d.$A)(this.config,e),cacheModule:!0,wasmModuleCache:this.cacheGetter};e.registerLocalWorkflow((0,c.X8)(o,i)),e.registerLocalWorkflow((0,u.L4)(o,i)),e.activateAnnotation(r.NG.getTypeName()),e.registerLocalWorkflow(h.TE),e.activateAnnotation(s.os.getTypeName()),this.isUpdateSchedulerEnabled()?this.setupGraphSearchDataRefreshScheduler(e):e.activateAnnotation(n.$9.getTypeName())}isUpdateSchedulerEnabled(){var e,t,o;return null!==(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.enablePeriodicUpdates)&&void 0!==o&&o}getUpdateInterval(){var e,t,o;return null!==(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.periodicUpdateInterval)&&void 0!==o?o:this.defaultRefreshInterval}setupGraphSearchDataRefreshScheduler(e){this.graphSearchDataRefreshScheduler&&this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=new m(this.getUpdateInterval(),e,this.timer,this._logger),this.graphSearchDataRefreshScheduler.start(),e.activateAnnotation(n.$9.getTypeName(),{callback:this.graphSearchDataRefreshScheduler.onRefreshDone.bind(this.graphSearchDataRefreshScheduler)})}async deactivateAnnotations(e){return!(!e||!this.eccEnabled||(this.graphSearchDataRefreshScheduler&&(this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=void 0),e.releaseAnnotation(r.NG.getTypeName()),e.releaseAnnotation(s.os.getTypeName()),e.releaseAnnotation(n.$9.getTypeName()),0))}async updateAnnotationActivationConfig(){}}},43260:(e,t,o)=>{"use strict";o.d(t,{g:()=>u});var i=o(30206),n=o(83273),r=o(57767),s=o(76509),a=o(8055),l=o(48828),c=o(90424);let u=class{constructor(e,t,o){this.isEnabled=!0,this.graphSearchLocalAnnotationListener=new n.N(e,t,o)}onInitialize(){}register(e,t){}unregister(){}createAnnotationListener(){return this.graphSearchLocalAnnotationListener}onSessionReconnected(){}onDocumentCreated(){}};u=(0,i.__decorate)([(0,l._)(),(0,i.__param)(0,(0,c.W)(r.n)),(0,i.__param)(1,(0,c.W)(s.g)),(0,i.__param)(2,(0,c.W)(a.J))],u)},46592:(e,t,o)=>{"use strict";if(o.d(t,{p:()=>u}),3023==o.j)var i=o(84824);if(3023==o.j)var n=o(12032);if(3023==o.j)var r=o(24480);if(3023==o.j)var s=o(43260);if(3023==o.j)var a=o(37538);if(3023==o.j)var l=o(22411);if(3023==o.j)var c=o(81636);class u{constructor(){this.imports=[i.J,a.k]}get uniqueId(){return(0,l.z)(507918226)}configureRootServices(e){e.bind(n.T).to(s.g),e.bind(r.cl).toDynamicValue((e=>(e,t)=>{var o;const i=(0,c.g)(e,null===(o=t.hostSettings.orchestratorSettings)||void 0===o?void 0:o.substrateAuthTokenCallback);return Object.assign(Object.assign({},e),{isFeatureEnabled:i.isFeatureEnabled,requestAuthToken:i.requestAuthToken})}))}}},81636:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>r}),3023==o.j)var i=o(77972);function n(e,t){return async o=>o.TokenType===i.OY.Substrate&&t?{Token:await t(o)}:e(o)}function r(e,t){return{isFeatureEnabled:(o=e.isFeatureEnabled,async(e,t)=>{switch(e){case"Microsoft.Office.AugLoop.AnnotationsOrderingEnabled":case"Microsoft.Office.AugLoop.EarlyJoinCompletionEnabled":return!1;case"Microsoft.Office.AugLoop.DeltaOperationsEnabled":return!0}return o(e,t)}),requestAuthToken:n(e.requestAuthToken,t)};var o}},74654:(e,t,o)=>{"use strict";o.d(t,{$A:()=>s,Gm:()=>r,uz:()=>a});var i=o(900);if(3023==o.j)var n=o(83086);const r=e=>{if(e){try{return new URL(e),"/"===e[e.length-1]?e.substring(0,e.length-1):e}catch(e){}const t=e.split("/").filter((e=>0!==e.length));if(0!==t.length)return["/",t.join("/")].join("")}return e},s=(e,t)=>{var o,i,n,s,a,l;return((e,t)=>["/"===e?"":r(e),t].join("/"))((null===(n=null===(i=null===(o=e.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===i?void 0:i.wasmConfig)||void 0===n?void 0:n.binaryPath)||(null===(l=null===(a=null===(s=e.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.wasmConfig)||void 0===l?void 0:l.scriptPath),t)},a=e=>{var t,o,r,s,a;const c=(0,n.e)(e);return{emailId:e.userId.email,puid:e.userId.puid,scenarios:[i.Nz.BIZ_CHAT,"PowerPoint"===(null===(t=e.hostMetadata)||void 0===t?void 0:t.appName)?i.Nz.COPILOT_POWERPOINT:i.Nz.WORKPLACE_SEARCH],tenantId:e.userId.tenantId,substrateAuthTokenType:l[e.userId.identityProvider],entityTypes:[],clientConfig:{getConfig:()=>c},prefetchOnly:!1,market:e.defaultLocale,useLocalFileRanker:null===(r=null===(o=e.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===r?void 0:r.useLocalFileRanker,includeLoopFiles:null===(a=null===(s=e.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.includeLoopFiles}},l=[i.Xe.SUBSTRATE_MSA,i.Xe.SUBSTRATE_AAD]},49018:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{GraphSearchLocalAnnotationListener:()=>i.N,HybridModule:()=>n.p,graphSearchLocalOverrideHostCallbacks:()=>s.g,hostConfigToGraphConfig:()=>r.uz}),3023==o.j)var i=o(83273);if(3023==o.j)var n=o(46592);if(3023==o.j)var r=o(74654);if(3023==o.j)var s=o(81636)},10351:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>u}),3023==o.j)var i=o(12553);if(3023==o.j)var n=o(90874);if(3023==o.j)var r=o(85985);if(3023==o.j)var s=o(58262);if(3023==o.j)var a=o(82113);if(3023==o.j)var l=o(14118);if(3023==o.j)var c=o(75289);class u{constructor(e,t){this._displayLanguage=e,this._stringProvider=t,this._defaultUiLocale="en-us",this._categoryNameToLocalizedName=new Map,this._localizationTableFallbackMapping=(0,c.mO)(),this._localizedNameToCategoryName=new Map,this._nonEditorCategories=new Set([s.s.Perspectives,s.s.TonalRewrite]),this.uiLocale="",this.isCategorySupportedInCurrentUiLanguage=e=>!!this._categoriesForUILocale&&e in this._categoriesForUILocale&&this._categoriesForUILocale[e].IsImplemented,this.setUiLocale(this._displayLanguage)}async setUiLocale(e){const t=e;this.uiLocale=t?t.toLowerCase():this._defaultUiLocale;const o=this._localizationTableFallbackMapping.get(this.uiLocale);if(o&&(this.uiLocale=o),this._categoriesForUILocale=await(0,a.oZ)(this.uiLocale),!this._categoriesForUILocale)throw Error(`Failed to load categories strings from localization file dynamically: ${this.uiLocale}`);this.cacheLocalizedCategories(this.uiLocale.toLowerCase(),this._categoriesForUILocale)}cacheLocalizedCategories(e,t){for(const o of Object.keys(t))this.cacheCategoryNames(o,t[o].LocalizedName,e)}get NonEditorCategories(){return this._nonEditorCategories}categoryNameToLocale(e,t){var o;const s=t.toLowerCase(),a=null===(o=this._categoryNameToLocalizedName.get(e))||void 0===o?void 0:o.get(s);if(a)return a;if(this._nonEditorCategories.has(e)){const t=this.localizeNonEditorCategoryNameToUiLocale(e);return this.cacheCategoryNames(e,t,s),t}return(0,i.C)().logEvent(571281556,"CategoryLocalizationNotFoundInLocalizationTable",n.h.Host,r.q.Error,{category:e,language:s}),e}toUiLocale(e){return this.categoryNameToLocale(e,this.uiLocale)}async localizedNameToStandardizedName(e,t){if(t===s.s.Spelling||t===s.s.Grammar||this.NonEditorCategories.has(t))return t;const o=this._localizedNameToCategoryName.get(t);if(o)return o;const i=await(0,a.oZ)(null!=e?e:this.uiLocale);if(i){const o=Object.keys(i).find((e=>{const o=i[e];return o&&o.LocalizedName===t}));if(o)return this.cacheCategoryNames(o,t,null!=e?e:this.uiLocale),o}const n=this.mapNonEditorCategoryNameToStandardizedName(t);return n?(this.cacheCategoryNames(n,t,this.uiLocale),n):t}cacheCategoryNames(e,t,o){const i=this._categoryNameToLocalizedName.get(e),n=null==i?void 0:i.get(o),r=this._localizedNameToCategoryName.get(t);if(!n)if(i)i.set(o,t);else{const i=new Map;i.set(o,t),this._categoryNameToLocalizedName.set(e,i)}r||this._localizedNameToCategoryName.set(t,e)}localizeNonEditorCategoryNameToUiLocale(e){var t;const o=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,i=o.getString.bind(o);switch(e){case s.s.Perspectives:return i("CritiqueCategoryStrings","Perspectives");case s.s.TonalRewrite:return i("CritiqueCategoryStrings","TonalRewrite");default:return e}}mapNonEditorCategoryNameToStandardizedName(e){var t;const o=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,i=o.getString.bind(o);switch(e){case i("CritiqueCategoryStrings","Perspectives"):return s.s.Perspectives;case i("CritiqueCategoryStrings","TonalRewrite"):return s.s.TonalRewrite;default:return e}}}},75289:(e,t,o)=>{"use strict";var i;o.d(t,{mO:()=>n}),function(e){e.CATALAN="ca",e.CATALANCATALAN="ca-es",e.CHINESE="zh",e.CHINESESIMPLIFIED="zh-hans",e.CHINESETRADITIONAL="zh-hant",e.ENGLISH="en",e.ENGLISH_AUSTRALIA="en-au",e.ENGLISH_CANADA="en-ca",e.ENGLISH_INDIA="en-in",e.ENGLISH_UNITEDKINGDOM="en-gb",e.ENGLISH_UNITEDSTATES="en-us",e.FRENCH="fr",e.FRENCH_CANADA="fr-ca",e.FRENCH_FRANCE="fr-fr",e.GERMAN="de",e.ITALIAN="it",e.JAPANESE="ja",e.PORTUGUESE="pt",e.SPANISH="es",e.SPANISH_MEXICO="es-mx",e.SPANISH_SPAIN="es-es",e.VALENCIAN="ca-es-valencia",e.RUSSIAN="ru",e.BRAZILIAN="br"}(i||(i={}));const n=()=>new Map([[i.ENGLISH_AUSTRALIA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_CANADA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_INDIA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_UNITEDKINGDOM,i.ENGLISH_UNITEDSTATES],[i.FRENCH_CANADA,i.FRENCH_FRANCE],[i.SPANISH_MEXICO,i.SPANISH_SPAIN]]);var r;!function(e){e.Goals="Goals"}(r||(r={}))},58262:(e,t,o)=>{"use strict";var i;o.d(t,{s:()=>i}),function(e){e.Clarity="Clarity",e.Conciseness="Conciseness",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Vocabulary="Vocabulary",e.TonalRewrite="Tone",e.Synonyms="Synonyms",e.DistinctWords="DistinctWords",e.Readability="Readability",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Similarity="SimilarityCategoryLevel",e.Goals="GoalsCard"}(i||(i={}))},82113:(e,t,o)=>{"use strict";if(o.d(t,{oZ:()=>l}),3023==o.j)var i=o(12553);if(3023==o.j)var n=o(90874);if(3023==o.j)var r=o(85985);if(3023==o.j)var s=o(71780);const a=new Map([["es-419","es-MX"]]);async function l(e,t=!1){var c;const u=null!==(c=a.get(e))&&void 0!==c?c:e,d=(0,i.C)();try{return await o(29879)(`./${u.toLowerCase()}.json`)}catch(o){try{if(!t){const t=e.split("-")[0];if(t in s.Y){const e=s.Y[t];return l(Array.isArray(e)?e[0]:e,!0)}}d.logEvent(0,"Diagnostics",n.h.Undefined,r.q.Error,`Failed to load categories strings for locale ${e} from localization file dynamically: ${o}`,void 0,void 0,void 0,"Text_Message")}catch(t){d.logEvent(0,"Diagnostics",n.h.Undefined,r.q.Error,`Failed to load neutral categories strings for locale ${e} from localization file dynamically: ${o}`,void 0,void 0,void 0,"Text_Message")}return}}},51705:(e,t,o)=>{"use strict";o.d(t,{r:()=>qt,h:()=>Ot});var i=o(95734),n=o(97069),r=o(93261),s=o(69849),a=o(35612),l=o(75362),c=o(39176),u=o(51687),d=o(26064),g=o(12378),h=o(87333),p=o(57767),f=o(55287),m=o(61953),v=o(25808),y=o(72212),b=o(95909),S=o(74774),C=o(76158),w=o(26923),k=o(16441),T=o(75753),x=o(62670);function _(e){return{background:{resting:e,disabled:"transparent"},border:"#D1D1D1",focusRing:"black",title:{resting:"transparent"}}}const I={marginHorizontal:16,marginTop:0,marginBottom:0},E={marginHorizontal:0,marginTop:2,marginBottom:0};x.R.Center;var A=o(74505),B=o(27326);function R(e){return{paddingHorizontal:T.QL,paddingVertical:9,backgroundColor:e.addOnFooterBackground}}function M(e,t,o){return{fontSize:t.xxsmall,fontFamily:A.V,cssColor:o?e.addOnAction:e.addOnFooterMessage,underlineType:o?B.RV.Single:B.RV.None,wrapMode:o?B.bd.NoWrap:B.bd.Normal}}function D(e){return e.premiumEmphasis}var P=o(87253),N=o(43463),F=o(6422),O=o(78218),j=o(72124),q=o(30760),L=o(85936),H=o(17321),z=o(36865),W=o(67612),G=o(57683),U=o(67762),V=o(4515),$=o(59523),K=o(5779),J=o(89810),Z=o(14018),Y=o(7798),Q=o(53092),X=o(74495),ee=o(37834);class te extends i.Component{constructor(e){super(e),this.firstSuggestionRef=i.createRef(),this.firstSuggestionButtonRef=i.createRef(),this.footerRef=i.createRef(),this.state={definition:e.definition}}setDefinition(e){this.setState({definition:e})}componentDidMount(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)}componentDidUpdate(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}render(){var e,t,o;const{automationId:n,fontTable:r,layerHostId:s,onAction:a,settings:l,spacing:c,strings:u,style:d,theme:g}=this.props,h=T.uI(this.getTheme(),this.props.style,{useFluentV9:!!this.context});return i.createElement(j.S,{style:h,align:q.j5.Stretch},this.renderHeader(),this.renderBody(),this.renderFooterTitle(),i.createElement(Z.w,{automationId:n,layerHostId:s,definition:this.state.definition,theme:g,fontTable:r,spacing:c,style:d,strings:u,settings:l,onAction:a,overflowMenuCalloutStyle:null===(e=null==d?void 0:d.footerStyle)||void 0===e?void 0:e.overflowMenuCalloutStyle,footerContainerStyle:Y.m$(null==d?void 0:d.footerStyle),footerButtonStyle:T.B7(null===(t=null==d?void 0:d.footerStyle)||void 0===t?void 0:t.buttonStyles),overflowMenuButtonStyle:T.B7(null===(o=null==d?void 0:d.footerStyle)||void 0===o?void 0:o.buttonStyles),ref:this.footerRef}),this.renderAddOnFooter())}focus(){var e;this.firstSuggestionRef.current?this.firstSuggestionRef.current.focus():this.firstSuggestionButtonRef.current?this.firstSuggestionButtonRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()}executeBadgedAction(e){if(!this.props.onAction)return;const t=Y.do(this.getDefinition(),this.props.strings),o={actionSourceId:P.tR.VoiceDictationBadge,maxBadgeId:t.reduce(((e,t)=>Math.max(e,t.badgeId)),0)},i=t.filter((t=>t.badgeId===e));i.length>0?(o.executedBadgeId=i[0].badgeId,this.props.onAction(i[0].action,i[0].suggestionIndex,void 0,o)):this.props.onAction(N._R.Dismiss,void 0,void 0,o)}getBooleanSetting(e){return!!this.props.settings&&"true"===this.props.settings[e]}getDefinition(){return this.state.definition}renderContext(e){if(!e.showContext||!e.contextText||!e.contextText.length)return null;const t=(0,F.y)(this.props.strings.textFormatting,e.critiqueType,e.contextText,e.contextDecorations),o=Y.xt(e,N._R.ReadContext),n=o?Object.assign(Object.assign({},T.YV),{flexibleSize:!0}):T.YV,r=i.createElement(j.S,{style:n,accessibleLive:q.pq.Polite},i.createElement(L.c,{text:(0,O.EE)(e.contextText,te.contextMaxLength),style:T.yl(this.getTheme(),this.getFontTable()),formatting:(0,H.S)(e.contextText.length,this.getTheme(),e.contextDecorations),accessibilityLabel:t}));if(!o)return r;const s=this.getBooleanSetting("NoTooltipForReadContext")?void 0:Y.a4(e,this.props.strings,N._R.ReadContext);return i.createElement(j.S,{direction:q.PR.LeftToRight,align:q.j5.Center},r,Y.o2(this.getDefinition(),this.getTheme(),N._R.ReadContext,T.Bd(this.getFontTable()),this.props.strings,{action:"readcontext",context:t||e.contextText},void 0,void 0,s,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId))}getCardHeaderText(){var e,t,o,i;const n=this.getDefinition();let r;switch(n.critiqueType){case N.L9.Classification:r=this.props.strings.critique("sensitiveContentCardHeader");break;case N.L9.Spelling:case N.L9.RepeatedWord:r=this.props.strings.critique("spellingCardHeader");break;case N.L9.Grammar:r=this.props.strings.critique("grammarCardHeader");break;case N.L9.NeuralRewrite:r=this.getBooleanSetting("renderNRForAIFeedback")?void 0:this.props.strings.critique("neuralRewriteCardHeader");break;case N.L9.SimilarityChecker:r=this.props.strings.critique("similarityCheckerCardHeader");break;case N.L9.TonalRewrite:r=this.props.strings.critique("tonalRewriteCardHeader");break;case N.L9.AccColorChecker:r=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardHeader");break;case N.L9.TextPenAlternates:r=null===(i=(o=this.props.strings).textPenAlternates)||void 0===i?void 0:i.call(o,"textPenAlternatesGroupTitle");break;default:r=this.props.definition.header}return n.showDictationCommandUx&&!r&&(r=this.props.strings.critique("dictationCorrectionsGroupTitle")),r}getCardSubheaderText(){var e,t;const o=this.getDefinition();let i;switch(o.critiqueType){case N.L9.Spelling:i=void 0;break;case N.L9.RepeatedWord:i=this.props.strings.critique("repeatedWordCardSubheader");break;case N.L9.NeuralRewrite:i=this.getBooleanSetting("renderNRForAIFeedback")?this.props.strings.critique("aIFeedbackCardSubHeader"):this.props.strings.critique("neuralRewriteCardSubheader");break;case N.L9.SimilarityChecker:i=this.props.strings.critique("similarityCheckerCardSubheader");break;case N.L9.AccColorChecker:i=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardSubheader");break;default:i=o.subheader}return o.showDictationCommandUx&&!i&&(i=this.props.strings.critique("dictationCorrectionCommandCardTitle")),i}renderPreviewMarker(){return i.createElement(L.c,{text:this.props.strings.critique("previewHeaderLabel"),style:T.HV(this.getTheme(),this.getFontTable())})}renderCardHeader(e){const t=e.critiqueType===N.L9.NeuralRewrite||e.critiqueType===N.L9.SimilarityChecker||e.critiqueType===N.L9.TonalRewrite?this.renderPreviewMarker():void 0,o=this.getCardHeaderText(),n=o?i.createElement(L.c,{text:o,style:T.k(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null,r=n?this.getDefinition().showPremiumIcon?i.createElement(j.S,{direction:q.PR.LeftToRight},i.createElement(z.In,{type:"PremiumDiamond",primaryColor:this.getTheme().header}),i.createElement(j.S,{style:{minWidth:6}}),n):n:null;return t?i.createElement(j.S,{align:q.j5.Stretch,direction:q.PR.LeftToRight},r,i.createElement(j.S,{style:{flexibleSize:!0,minWidth:16}}),t):r}renderCardFooterTitle(e){return e.showDictationCommandUx&&this.props.strings.critique("dictationSpelloutCommandCardTitle"),null}renderCardSubheader(){const e=this.getCardSubheaderText();return e?i.createElement(L.c,{text:e,style:T.GP(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null}renderHeader(){const e=this.getDefinition();return i.createElement(j.S,{style:T.WC,align:q.j5.Stretch},this.renderCardHeader(e),this.renderCardSubheader(),this.renderContext(e))}getAllSuggestionOverflowActions(){switch(this.getDefinition().critiqueType){case N.L9.Spelling:return[N._R.Accept,N._R.ReadAloud,N._R.SpellOut,N._R.ChangeAll,N._R.AddToAutoCorrect,N._R.AutoCorrectOptions];case N.L9.Grammar:case N.L9.Refinement:case N.L9.NeuralRewrite:return[N._R.Accept,N._R.ReadAloud,N._R.SpellOut];case N.L9.SimilarityChecker:return[N._R.LearnMore,N._R.ReadAloud,N._R.SpellOut];case N.L9.AccColorChecker:return[N._R.LearnMore];case N.L9.AddinCritique:return[N._R.Accept,N._R.ReadAloud,N._R.SpellOut];default:return[]}}shouldShowSuggestionDescription(e){return Y.eS(this.getDefinition(),N._R.Accept,e)&&this.getDefinition().showDescription&&e.subtitle&&e.subtitle.length>0}getSuggestionButtonProps(e,t,o,i){const n=this.getDefinition(),r=this.getSuggestionButtonKind(n.critiqueType,e),s=n.critiqueType===N.L9.Topic?`#${e.title}`:e.title,a=s.length,l=Y.t$(n,o,e),c=Y.EH(n,this.props.strings,this.getTheme(),l,o,t),u=void 0!==i?{type:i,filled:n.critiqueType===N.L9.RepeatedWord}:void 0,d={title:s,titleStyle:void 0!==r&&o!==N._R.MoreSources?T.D0(this.getFontTable(),a):(0,H.S)(a,this.getTheme(),e.titleDecorations),tag:e.tag,tagStyle:T.RU(this.getFontTable()),icon:u,disabled:l,onClick:()=>{var e,i;null===(i=(e=this.props).onAction)||void 0===i||i.call(e,o,t)},theme:n.critiqueType===N.L9.RepeatedWord?T.P4(this.getTheme(),r,!0):T.P4(this.getTheme(),r),strings:Y.Eh(this.props.strings.common),accessibilityRole:"menuitem",accessibilityLabel:this.getSuggestionAccessibilityLabel(e),automationLabel:"CritiqueSuggestionButton_"+e.id,badgeProps:c};return this.shouldShowSuggestionDescription(e)&&(d.subtitle=e.subtitle,d.subtitleStyle=T.qw(this.getFontTable())),d}getSuggestionButtonKind(e,t){if(!(t.titleDecorations&&t.titleDecorations.length>0))switch(e){case N.L9.Grammar:return"grammar";case N.L9.Refinement:case N.L9.Topic:return"refinement";default:return"suggestion"}}getSuggestionAccessibilityLabel(e){const t=this.getDefinition(),o=e.tagAccessibilityLabel||e.tag||"";return t.critiqueType!==N.L9.Spelling&&t.critiqueType!==N.L9.NeuralRewrite||!t.showDescription||!e.subtitle||0===e.subtitle.trim().length?o?this.props.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",o).replace("{1}",e.title):void 0:o&&t.critiqueType===N.L9.Spelling?this.props.strings.critique("spellingSuggestionTagAndDescriptionAccessibilityLabel").replace("{0}",o).replace("{1}",e.title).replace("{2}",e.subtitle):(t.critiqueType===N.L9.Spelling?this.props.strings.critique("spellingSuggestionDescriptionAccessibilityLabel"):this.props.strings.critique("neuralRewriteSuggestionAccessibilityLabel")).replace("{0}",e.title).replace("{1}",e.subtitle)}renderSplitButtonSuggestion(e,t,o,n,r,s){const a=this.getTheme();return i.createElement(W.f,{key:e,ref:t,buttonProps:Object.assign(Object.assign({},o),{disableAccessibilityExpanded:void 0===n}),menuProps:n,style:T.kw,theme:{splitMenuHoverBackground:a.suggestionMenuHoverBackground,splitMenuHoverForeground:a.suggestionMenuHoverForeground},strings:Y.Hz(this.props.strings.common),accessibilityPositionInSet:void 0!==r?r:1,accessibilitySetSize:void 0!==s?s:1,layerHostId:this.props.layerHostId})}renderSingleSuggestion(e,t,o,i,n,r,s,a){return[this.renderSplitButtonSuggestion(e,o,this.getSuggestionButtonProps({title:t,actions:n?[]:[i]},e,i,r),void 0,s,a)]}renderActionListAsSuggestions(e){const t=this.getDefinition();return e.filter((e=>Y.a4(t,this.props.strings,e))).map(((e,o,i)=>this.renderSingleSuggestion(o,Y.a4(t,this.props.strings,e),0===o?this.firstSuggestionRef:void 0,e,void 0,Y.g$(e),o+1,i.length)[0]))}renderSpecialSuggestions(e,t){return e.critiqueType===N.L9.RepeatedWord?this.renderSingleSuggestion(0,this.props.strings.critique("deleteRepeatedWord"),this.firstSuggestionRef,t[0],!1,"Delete"):e.critiqueType===N.L9.SimilarityChecker?this.renderActionListAsSuggestions(t):[i.createElement(G.v,{key:0,shimmerCount:T.Wi,styles:T.B8(this.getSpacing()),render:()=>{const e=this.renderSingleSuggestion(0,this.props.strings.common("suggestionsGroupLoadingSuggestionsText"),void 0,N._R.Accept,!0);return e.length>0?e[0]:null}})]}renderSuggestions(){const e=this.getDefinition(),t=Y.zh(e,this.props.strings);if(t)return this.renderSpecialSuggestions(e,t);const o=Y.KW(e),n=o.map(((t,n)=>{const r=this.renderSplitButtonSuggestion(n,0===n?this.firstSuggestionRef:void 0,this.getSuggestionButtonProps(t,n,N._R.Accept,this.getSuggestionIcon(e.critiqueType,t,o.length)),Y.ms(e,this.getTheme(),this.props.strings,this.getFontTable(),this.getAllSuggestionOverflowActions(),this.getBooleanSetting("NoTooltipForFooterOverflow"),void 0,n,this.props.automationId,this.props.layerHostId,this.props.onAction),n+1,o.length);return n>0&&t.tag!==o[n-1].tag?i.createElement(i.Fragment,null,i.createElement(U.w,{key:n,color:this.props.theme&&this.props.theme.separator,style:T.cK}),r):r}));return 0===n.length?this.renderSingleSuggestion(0,e.critiqueType===N.L9.NeuralRewrite?this.props.strings.critique("neuralRewriteNoSuggestionsText"):this.props.strings.common("suggestionsGroupNoSuggestionsText"),void 0,N._R.Accept,!0):n}getSuggestionIcon(e,t,o){return e===N.L9.Classification&&1===o?"Delete":e===N.L9.Grammar&&this.props.critiqueSource===P.UD.Inference?"Cloud":e!==N.L9.NeuralRewrite||Y.eS(this.getDefinition(),N._R.Accept,t)?void 0:"Info"}renderSourceUrlAsHyperlink(e,t){return i.createElement(V.R,{url:e,theme:T.ki(this.getTheme()),style:T.eO(this.getFontTable()),text:t})}renderSourceUrlAsText(e){return i.createElement(L.c,{text:e,style:T.lb(this.getTheme(),this.getFontTable())})}renderSource(){const e=this.getDefinition(),t=this.props.sourceIndex||0;if(!e.sources)return;const o=e.sources[t].sourceUrl,n=e.sources[t].sourceTitle;if(!o||!n)return;const r=(0,O.SE)(o);return i.createElement(j.S,{style:T.ID,align:q.j5.Stretch},i.createElement(L.c,{text:n,style:T.F6(this.getFontTable(),this.getTheme())}),i.createElement(j.S,{direction:q.PR.LeftToRight,align:q.j5.Baseline},i.createElement(j.S,{direction:q.PR.LeftToRight,align:q.j5.Baseline,style:{flexibleSize:!0}},e.sourceUrlClickable?this.renderSourceUrlAsHyperlink(o,r):this.renderSourceUrlAsText(r)),i.createElement(L.c,{text:this.props.strings.critique("poweredByBing"),style:T.Ps(this.getFontTable())})))}generateButtonProps(e,t,o){return{onClick:()=>{this.props.onAction&&this.props.onAction(N._R.ApplyColor,o)},hoverRing:!0,style:{width:32,height:32,borderRadius:2,marginEnd:8,borderThickness:2},theme:_(e),automationLabel:`ColorPickerButton_${this.props.automationId}`,tooltip:t,tooltipProps:{layerHostId:this.props.layerHostId}}}renderColors(){var e,t,o;const n=(this.getDefinition().suggestions||[]).map(((e,t)=>i.createElement($.u,Object.assign({key:e.id,ref:0===t?this.firstSuggestionButtonRef:void 0},this.generateButtonProps(e.title,e.subtitle,t)))));return i.createElement(j.S,{align:q.j5.Start,justifyContent:q.Pr.Start,style:I},i.createElement(L.c,{text:null!==(o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerSecondCardSubheader"))&&void 0!==o?o:"",style:T.qL(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}),i.createElement(j.S,{direction:q.PR.LeftToRight,align:q.j5.Start,justifyContent:q.Pr.Start,style:E},n))}renderHelpLink(){const e=this.getDefinition();if(e.helpLink)return i.createElement(j.S,{direction:q.PR.LeftToRight,style:T.cq,align:q.j5.Stretch},i.createElement(V.R,{text:e.helpLink.text,url:e.helpLink.url,theme:T.dG(this.getTheme()),style:T.ej(this.getFontTable())}))}getCustomSuggestions(){return this.props.customSuggestions?this.props.customSuggestions:this.props.definition.critiqueType===N.L9.Grammar?function(e,t){var o;const n=i.createRef(),r=null!=e.definition.showAIRewriteNudgeForCritiqueType&&e.definition.showAIRewriteNudgeForCritiqueType.length>0&&e.definition.showAIRewriteNudgeForCritiqueType.includes(e.definition.critiqueType),s=Object.assign(Object.assign(Object.assign({},e),(0,X.m)(e,void 0)),{definition:Object.assign(Object.assign({},e.definition),{header:e.strings.critique("grammarCardHeader")}),suggestionOverflowActions:[N._R.Accept,N._R.ReadAloud,N._R.SpellOut],suggestionKind:()=>"grammar",suggestionIcon:()=>e.critiqueSource===P.UD.Inference?"Cloud":void 0});return s.customSuggestions=r?i.createElement(ee.Y,Object.assign({},s,{ref:null!==(o=s.firstSuggestionRef)&&void 0!==o?o:n})):void 0,s}(this.props).customSuggestions:this.props.definition.critiqueType===N.L9.Refinement?function(e,t){var o;const n=i.createRef(),r=null!=e.definition.showAIRewriteNudgeForCritiqueType&&e.definition.showAIRewriteNudgeForCritiqueType.length>0&&e.definition.showAIRewriteNudgeForCritiqueType.includes(e.definition.critiqueType),s=Object.assign(Object.assign(Object.assign({},e),(0,X.m)(e,void 0)),{suggestionOverflowActions:[N._R.Accept,N._R.ReadAloud,N._R.SpellOut],suggestionKind:()=>"refinement"});return s.customSuggestions=r?i.createElement(ee.Y,Object.assign({},s,{ref:null!==(o=s.firstSuggestionRef)&&void 0!==o?o:n})):void 0,s}(this.props).customSuggestions:this.props.customSuggestions}renderBodySuggestions(){const e=this.getDefinition(),t=this.getCustomSuggestions(),o=e.critiqueType!==N.L9.SimilarityChecker?this.props.strings.critique("suggestionsGroupAccessibilityLabel"):void 0,n=null!=t?t:this.renderSuggestions();return(0,Q.R2)()?i.createElement(j.S,{align:q.j5.Stretch,accessible:!1},n):i.createElement(j.S,{align:q.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:o},n)}renderBody(){const e=this.getDefinition();return i.createElement(j.S,{align:q.j5.Stretch},e.critiqueType===N.L9.SimilarityChecker?this.renderSource():void 0,i.createElement(K.R,{disableInitialFocus:!0},e.critiqueType===N.L9.AccColorChecker?this.renderColors():this.renderBodySuggestions()),this.renderHelpLink())}renderFooterTitle(){const e=this.getDefinition(),t=this.renderCardFooterTitle(e);return t?i.createElement(j.S,{style:T.WC,align:q.j5.Stretch},t):null}renderAddOnFooter(){if(!this.props.addOnFooterData)return null;const{addOnFooterData:e}=this.props,t={onClick:()=>{var e,t;null===(t=(e=this.props).onAction)||void 0===t||t.call(e,N._R.AddOnFooterAction)},style:T.Oc,theme:(o=this.getTheme(),{background:{resting:"transparent"},title:{resting:o.addOnAction||o.background.resting}}),automationLabel:`AddonFooterButton_${e.actionText}_${this.props.automationId}`};var o,n;return i.createElement(j.S,{style:R(this.getTheme()),direction:q.PR.LeftToRight,align:q.j5.Center,accessible:!0,accessibilityLabel:e.message},e.icon&&i.createElement(i.Fragment,null,i.createElement(z.In,{type:e.icon,primaryColor:D(this.getTheme()),fontSize:(n=this.getFontTable(),n.xsmall)}),i.createElement(j.S,{style:{width:8}})),this.getAddOnFooterFormattedText(),i.createElement(j.S,{style:{width:4}}),i.createElement($.u,Object.assign({},t),i.createElement(L.c,{text:e.actionText,style:M(this.getTheme(),this.getFontTable(),!0)})))}getAddOnFooterFormattedText(){if(!this.props.addOnFooterData)return;const{addOnFooterData:e}=this.props;return i.createElement(L.c,{text:e.message,style:M(this.getTheme(),this.getFontTable(),!1),formatting:e.footerDecorations?(0,H.S)(e.message.length,this.getTheme(),e.footerDecorations):void 0})}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?T.ol:T.vy}getFontTable(){return this.props.fontTable?this.props.fontTable:T.d4}getSpacing(){return this.props.spacing?this.props.spacing:T.lT}}te.contextMaxLength=120,te.contextType=J.O;var oe,ie,ne,re,se=o(31075),ae=o(70325),le=o(56568),ce=o(7969),ue=o(60565),de=(oe=function(e){var t=e.semanticColors,o=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:o.medium.fontFamily,fontWeight:o.medium.fontWeight,fontSize:o.medium.fontSize,MozOsxFontSmoothing:o.medium.MozOsxFontSmoothing,WebkitFontSmoothing:o.medium.WebkitFontSmoothing}]}},ie=new Map,ne=new Set,re=function(e){var t=e.currentTarget,o=t.__id__;ie.delete(o),t.removeEventListener("unload",re),ne.delete(o)},function(e){void 0===e&&(e={});var t,o=e.theme,n=(0,ae.ox)();n&&(n.__id__=n.__id__||(0,ce.O)(),t=n.__id__,ne.has(t)||(ne.add(t),n.addEventListener("unload",re)));var r=(0,le.D)();o=o||r;var s=ue.K.getId(),a=[t,s,o],l=function(e,t){var o,i,n,r=t[0],s=t[1],a=t[2];return null===(n=null===(i=null===(o=e.get(r))||void 0===o?void 0:o.get(s))||void 0===i?void 0:i.get(a))||void 0===n?void 0:n.classMap}(ie,a);if((0,i.useEffect)((function(){return function(e,t){var o,i,n=t[0],r=t[1],s=t[2],a=null===(i=null===(o=e.get(n))||void 0===o?void 0:o.get(r))||void 0===i?void 0:i.get(s);a&&a.refCount++}(ie,[t,s,o]),function(){return function(e,t){var o,i,n,r,s,a,l,c,u=t[0],d=t[1],g=t[2],h=null===(i=null===(o=e.get(u))||void 0===o?void 0:o.get(d))||void 0===i?void 0:i.get(g);h&&(h.refCount--,0===h.refCount&&(null===(r=null===(n=e.get(u))||void 0===n?void 0:n.get(d))||void 0===r||r.delete(g),0===(null===(a=null===(s=e.get(u))||void 0===s?void 0:s.get(d))||void 0===a?void 0:a.size)&&(null===(l=e.get(u))||void 0===l||l.delete(d),0===(null===(c=e.get(u))||void 0===c?void 0:c.size)&&e.delete(u))))}(ie,[t,s,o])}}),[t,s,o]),!l){var c=function(e){return"function"==typeof e}(oe)?oe(o):oe;l=ue.K.renderStyles(c,{targetWindow:n,rtl:!!o.rtl}),function(e,t,o){var i,n,r=t[0],s=t[1],a=t[2],l=null!==(i=e.get(r))&&void 0!==i?i:new Map;e.set(r,l);var c=null!==(n=l.get(s))&&void 0!==n?n:new Map;l.set(s,c),c.set(a,{classMap:o,refCount:0})}(ie,a,l)}return l});var ge=o(9214),he=o(36068),pe=o(35226),fe=o(78950),me=i.forwardRef((function(e,t){var o=function(e,t){var o=(0,pe.N)(t,e);return(0,he.T)(o),{state:o,render:ge.j}}(e,{ref:(0,fe.a)(t,i.useRef(null)),as:"div",applyTo:"element"}),n=o.render,r=o.state;return function(e){var t=de(e),o=e.className,n=e.applyTo;!function(e,t){var o,n="body"===e.applyTo,r=null===(o=(0,ae.ZY)())||void 0===o?void 0:o.body;i.useEffect((function(){if(n&&r){for(var e=0,o=t;e<o.length;e++){var i=o[e];i&&r.classList.add(i)}return function(){if(n&&r)for(var e=0,o=t;e<o.length;e++){var i=o[e];i&&r.classList.remove(i)}}}}),[n,r,t])}(e,[t.root,t.body]),e.className=(0,se.A)(o,t.root,"element"===n&&t.body)}(r),n(r)}));me.displayName="ThemeProvider";var ve=o(4336),ye=o(86619),be=o(84096);const Se={primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#969696",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000"},Ce={marginHorizontal:16,marginTop:12},we={marginBottom:16,marginTop:16},ke={marginBottom:16,marginTop:8},Te={marginVertical:12,marginStart:16,maxWidth:236},xe={paddingVertical:5,textAlign:be.R.Center,borderRadius:2,borderThickness:1},_e={paddingHorizontal:0,paddingVertical:0};function Ie(e,t){return{fontSize:14,lineHeight:20,fontFamily:ye.V,cssColor:t?null==e?void 0:e.link:null==e?void 0:e.rejectionTextColor,underlineType:t?ve.RV.Single:ve.RV.None,wrapMode:t?ve.bd.NoWrap:ve.bd.Normal}}function Ee(e,t){return{fontFamily:ye.V,fontSize:12,lineHeight:t?12:16,cssColor:t?null==e?void 0:e.titleColor:null==e?void 0:e.descriptionColor,fontWeight:t?ve.IT.SemiBold:ve.IT.Normal}}function Ae(e,t){return{background:t?e.primaryButtonBackground:e.defaultButtonBackground,title:t?e.primaryButtonText:e.defaultButtonText,border:t?e.primaryBorder:e.defaultBorder,focusRing:t?e.primaryButtonFocusRing:e.defaultButtonFocusRing}}function Be(e){return{background:{resting:e.backgroundColor},title:{resting:e.link},focusRing:e.defaultButtonFocusRing}}function Re(e){return{background:{resting:e.backgroundColor},title:{resting:e.dismissButtonColor},focusRing:e.defaultButtonFocusRing}}const Me={iconFontWeight:ve.IT.SemiBold,iconFontSize:12,paddingHorizontal:8,paddingVertical:8,textAlign:be.R.Center};var De=o(44142),Pe=o(90866),Ne=o(22405),Fe=o(68462),Oe=o(43753),je=o(80896),qe=o(58546),Le=o(37024),He=o(74906),ze=o(60351),We=o(70210),Ge=o(20919);(0,o(54167).hN)([{rawString:"@media screen and (-ms-high-contrast: active),(forced-colors: active){.hasKeyboardFocus_67b207b6{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials:hover{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}}"}]);class Ue extends i.Component{render(){var e;const t=-16-(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.horizontalSpacing)?this.props.style.horizontalSpacing:0);return i.createElement("div",{style:{height:24,width:24,position:"fixed",background:this.props.theme.badgeBackground,border:"1px solid "+this.props.theme.badgeText,borderTopRightRadius:"50%",borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",boxSizing:"border-box",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13)",marginLeft:t,marginTop:-16,textAlign:"center",color:this.props.theme.badgeText,paddingTop:2,zIndex:1,userSelect:"none"}},this.props.text)}}var Ve=o(18470);class $e{constructor(e){this._event=e}get isOriginal(){return this._event.currentTarget===this._event.target}stopPropagation(){this._event.stopPropagation()}}var Ke=o(92482),Je=o(53203);let Ze=0;var Ye=o(28998),Qe=o(72906),Xe=o(15575),et=o(51869);const tt=(e,t,o)=>{const i=e.accessibilityLabel||e.title||e.subtitle;return o&&t&&e.strings&&e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment?e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment.replace("{0}",i||"").replace("{1}",e.accessibilityPositionInSet.toString(10)).replace("{2}",e.accessibilitySetSize.toString(10)):i},ot=e=>void 0!==e.accessibilityPositionInSet&&void 0!==e.accessibilitySetSize&&e.accessibilityPositionInSet>0&&e.accessibilityPositionInSet<=e.accessibilitySetSize&&e.accessibilitySetSize>=1,it=e=>{if(void 0!==e.personaCoinProps&&!e.icon)return i.createElement(De.S,{accessible:e.iconShouldBeAccessible},i.createElement(Ye.c,Object.assign({},e.personaCoinProps)))},nt=(e,t,o,n,r,s)=>{if(e.title)return i.createElement(Fe.c,{text:e.title,style:Object.assign(Object.assign({},e.titleRootStyle),lt(e,o,n,r,s)||{}),formatting:t(ut(e,o,n,r,s)),accessibilityHidden:!0})},rt=(e,t,o,n,r)=>e.tag?i.createElement(De.S,{style:{marginHorizontal:8}},i.createElement(Fe.c,{text:e.tag,style:ct(e,t,o,n,r),accessibilityHidden:!0})):void 0,st=(e,t,o,n,r)=>e.subtitle?i.createElement(De.S,{style:{paddingTop:2,width:"100%"}},i.createElement(Fe.c,{text:e.subtitle,style:dt(e,t,o,n,r),formatting:gt(e,t,o,n,r),accessibilityHidden:!0})):void 0,at=e=>e.title&&e.titleStyle&&0!==e.titleStyle.length?1===e.titleStyle.length&&0===e.titleStyle[0].start&&e.titleStyle[0].length===e.title.length?Object.assign({},e.titleStyle[0]):void 0:{},lt=(e,t,o,i,n)=>{const r=at(e);if(!r)return;const s=Xe.O4(e,n),a=(null==n?void 0:n.useFluentV9)&&(0,et.I)()?"CanvasText":Xe.gZ(t,o,e.disabled,Xe.uk(e,i),s.title);return Xe.hM(r,a)},ct=(e,t,o,i,n)=>{const r=Xe.O4(e,n),s=(null==n?void 0:n.useFluentV9)&&(0,et.I)()?"CanvasText":Xe.gZ(t,o,e.disabled,Xe.uk(e,i),r.tag||r.title);return Xe.hM(e.tagStyle,s)},ut=(e,t,o,i,n)=>{var r;if(!e.titleFormatting_DONOTUSE&&at(e))return;const s=Xe.O4(e,n),a=Xe.gZ(t,o,e.disabled,Xe.uk(e,i),s.title);return Xe.EF(null!==(r=e.titleFormatting_DONOTUSE)&&void 0!==r?r:e.titleStyle,a,o)},dt=(e,t,o,i,n)=>{const r=Xe.O4(e,n),s=(null==n?void 0:n.useFluentV9)&&(0,et.I)()?"CanvasText":Xe.gZ(t,o,e.disabled,Xe.uk(e,i),r.subtitle||r.title);return Xe.hM(e.subtitleStyle,s)},gt=(e,t,o,i,n)=>{if(!e.subtitleFormatting)return;const r=Xe.O4(e,n),s=Xe.gZ(t,o,e.disabled,Xe.uk(e,i),r.subtitle||r.title);return Xe.EF(e.subtitleFormatting,s,o)},ht=(e,t,o,n,r,s)=>{var a;if(void 0===e.icon)return;const{type:l,style:c,primaryColor:u,filled:d,fontSize:g}=e.icon,h={type:l,style:c,primaryColor:u||mt(e,t,o,n,r,s),filled:o&&d,fontSize:g||(null===(a=e.style)||void 0===a?void 0:a.iconFontSize)};return Ne.In.shouldRender(h,s)?i.createElement(De.S,{accessible:e.iconShouldBeAccessible},i.createElement(Ne.In,Object.assign({},h))):void 0},pt=(e,t)=>{var o,i;if((0,et.I)())return{resting:"CanvasText",focused:(null===(i=null===(o=e.icon)||void 0===o?void 0:o.style)||void 0===i?void 0:i.backgroundColor)?"CanvasText":t?"Highlight":"HighlightText",pressed:"Canvas"}},ft=e=>e,mt=(e,t,o,i,n,r)=>{const s=null!=n?n:((e,t)=>{const o=Xe.O4(e,t);return o.icon||o.title})(e,r);return Xe.gZ(t,o,e.disabled,Xe.uk(e,i),s)},vt=(e,t)=>mt(e,!1,!1,!1,pt(e,!!(null==t?void 0:t.useFluentV9)),t),yt=(e,t)=>mt(e,!1,!0,!1,pt(e,!!(null==t?void 0:t.useFluentV9)),t),bt=(e,t)=>mt(e,!1,!1,!0,pt(e,!!(null==t?void 0:t.useFluentV9)),t),St=(e,t)=>mt(e,!0,!1,!1,pt(e,!!(null==t?void 0:t.useFluentV9)),t);var Ct=o(63649),wt=o(22919),kt=o(50213),Tt=o(40226);const xt=["gridcell","option","row","tab"],_t=i.memo(i.forwardRef(((e,t)=>{var o,n,r;const s=!1,a=i.useRef(null),l=i.useRef(null),c=(Ze++,`CompositeButtonBase${Ze}`),u=i.useRef(null),d=i.useRef(null),g=i.useContext(je.O),[h,p]=i.useState(!1),[f,m]=i.useState(!1),[v,y]=i.useState(!1);i.useImperativeHandle(t,(()=>({focus:S,getElementRef:k,updateState_StorybookTestOnly:()=>{}})));const b=()=>{var t,o,i,n;g?e.updateItemHeight&&(null===(i=l.current)||void 0===i?void 0:i.offsetHeight)&&e.updateItemHeight(null===(n=l.current)||void 0===n?void 0:n.offsetHeight):e.updateItemHeight&&(null===(t=u.current)||void 0===t?void 0:t.offsetHeight)&&e.updateItemHeight(null===(o=u.current)||void 0===o?void 0:o.offsetHeight)};i.useEffect((()=>{b()}),[b]);const S=()=>{var t,o;e.refusesKeyboardFocus||(g?null===(t=l.current)||void 0===t||t.focus():null===(o=a.current)||void 0===o||o.focus())},C=(0,qe.Zq)({":focus-visible":{outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important"},".fui-CompoundButton__contentContainer":{width:"100%",justifyContent:"center"}}),w=(0,qe.Zq)({outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important","@media (forced-colors: active)":{outline:"var(--strokeWidthThick) solid highlight !important"}}),k=()=>u,T=null!==(o=e.children)&&void 0!==o?o:null===(n=e.renderChildren)||void 0===n?void 0:n.call(e,e,h,v,f),x=t=>(0,qe.Zq)({selectors:{svg:{color:vt(e,{useFluentV9:t})},":hover":{svg:{color:yt(e,{useFluentV9:t})}},":active":{svg:{color:St(e,{useFluentV9:t})}},":focus":{svg:{color:bt(e,{useFluentV9:t})}}}});i.useEffect((()=>{g||e.tooltip&&d.current&&(e.isSelectedByKeyboard?d.current.show():d.current.dismiss())}),[e.isSelectedByKeyboard,g,d]);const _=()=>{var t;e.disabled||(null===(t=e.onHoverIn)||void 0===t||t.call(e),y(!0))},I=()=>{var t;e.disabled||(null===(t=e.onHoverOut)||void 0===t||t.call(e),y(!1),p(!1))},E=()=>{var t;e.disabled||(null===(t=e.onPressIn)||void 0===t||t.call(e),p(!0))},A=()=>{var t;e.disabled||(null===(t=e.onPressOut)||void 0===t||t.call(e),p(!1))},B=()=>{var t;!e.disabled&&(null===(t=e.onClick)||void 0===t||t.call(e))},R=t=>{var o;const i=new $e(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,i),m(!0))},M=t=>{var o;const i=new $e(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,i),m(!1))},D=()=>{var t;const o=ot(e),i=(e=>("overflow"===e.accessibilityRole||"splitbutton"===e.accessibilityRole)&&void 0!==e.accessibilityState&&void 0!==e.onAccessibilityExpandCollapse)(e),n=xt.includes(null!==(t=e.accessibilityRole)&&void 0!==t?t:"")?e.hasKeyboardFocus:void 0,r={role:O(),"aria-label":tt(e,s,o),"aria-posinset":o?e.accessibilityPositionInSet:void 0,"aria-setsize":o?e.accessibilitySetSize:void 0,"aria-haspopup":i,"aria-selected":n,"aria-labelledby":!g&&e.tooltip?c:void 0};return i&&!e.disableAccessibilityExpanded&&(r["aria-expanded"]=e.accessibilityState),r},P=t=>{var o,i,n,r,s,a,l,c,u,d,h,p,f;const m=Xe.O4(e,{useFluentV9:g}),v=Qe.f6(e),y=m.focusRing?{[`.${He.Y2} &:focus`]:{selectors:{":after":{border:"none",outlineColor:m.focusRing}}}}:void 0,b=Qe.DF(e.style),S=Qe.Q6(e.style),C=Qe.ot(e.style),w=Qe.Xo(e.style),k=Qe.Cl(e.style,"start"),T=Qe.Cl(e.style,"end"),x=(0,Je.W)(e.style,"topStart"),_=(0,Je.W)(e.style,"topEnd"),I=(0,Je.W)(e.style,"bottomStart"),E=(0,Je.W)(e.style,"bottomEnd"),A={borderWidth:Qe.Cl(e.style),borderLeftWidth:t?T:k,borderTopWidth:Qe.Cl(e.style,"top"),borderRightWidth:t?k:T,borderBottomWidth:Qe.Cl(e.style,"bottom"),borderRadius:(0,Je.W)(e.style),borderTopLeftRadius:t?_:x,borderTopRightRadius:t?x:_,borderBottomRightRadius:t?I:E,borderBottomLeftRadius:t?E:I,border:null===(o=e.style)||void 0===o?void 0:o.border};return Object.assign(Object.assign({backgroundColor:m.background.resting,paddingTop:Qe.AF(e.style),paddingLeft:t?S:b,paddingBottom:Qe.em(e.style),paddingRight:t?b:S,marginTop:Qe.rf(e.style),marginRight:t?C:w,marginBottom:Qe.dV(e.style),marginLeft:t?w:C},A),{boxShadow:null===(i=e.style)||void 0===i?void 0:i.boxShadow,opacity:Qe.qr(e),flexGrow:v,flexShrink:v,textAlign:Qe.AW(e.style),width:e.useFullWidth?"100%":null===(n=e.style)||void 0===n?void 0:n.width,minWidth:null!==(s=null===(r=e.style)||void 0===r?void 0:r.minWidth)&&void 0!==s?s:0,maxWidth:null!==(l=null===(a=e.style)||void 0===a?void 0:a.maxWidth)&&void 0!==l?l:"none",height:null===(c=e.style)||void 0===c?void 0:c.height,minHeight:null!==(d=null===(u=e.style)||void 0===u?void 0:u.minHeight)&&void 0!==d?d:"min-content",maxHeight:null===(h=e.style)||void 0===h?void 0:h.maxHeight,position:null===(p=e.style)||void 0===p?void 0:p.position,bottom:null===(f=e.style)||void 0===f?void 0:f.bottom,selectors:y})},N=()=>({justifyContent:Qe.XI(e.style),flexDirection:"row",alignItems:"stretch"}),F=t=>{const o=Object.assign(Object.assign({},Xe.O4(e,{useFluentV9:g})),{focusRing:void 0}),i=Xe.SL(h&&!e.topPanelScopeButton,v&&!e.topPanelScopeButton,e.hoverRing,Xe.uk(e,f),e.disabled,e.showBorderWhenDisabled,o,{useFluentV9:g});return Object.assign(Object.assign({},P(t)),i)},O=()=>{switch(e.accessibilityRole){case"menuitem":case"option":case"tab":return e.accessibilityRole;case"overflow":return"menuitem";default:return"button"}},{badgeProps:j,theme:q,tooltip:L,tooltipProps:H,refusesKeyboardFocus:z}=e,{tooltip:W,title:G}=null!=q?q:{},U=null!==(r=null==W?void 0:W.backgroundColor)&&void 0!==r?r:null==q?void 0:q.background.resting,V=i.createElement(i.Fragment,null,j?i.createElement(Ue,Object.assign({},j)):void 0,i.createElement(Ve.q.Consumer,null,(t=>{const o=g?(t=>{var o,n;const r=(s=Object.assign(Object.assign({lineHeight:"normal",fontWeight:"normal"},F(t)),N()),Object.keys(s).forEach((e=>void 0===s[e]&&delete s[e])),s);var s;const a=x(!0),c=Object.assign({onFocus:R,onBlur:M,onClick:B,onPointerEnter:_,onPointerLeave:I,onPointerDown:E,onPointerUp:A,style:r,disabled:e.disabled},D());e.onHeightChange&&(null==l?void 0:l.current)&&e.onHeightChange(l.current.getBoundingClientRect().height);const u=i.createElement(wt._,Object.assign({className:Xe.uk(e,f)?(0,Ct.z)(a,C,w):(0,Ct.z)(a,C),as:"button","data-automation-id":e.automationLabel,id:e.htmlId,ref:l,appearance:e.appearance},c),T);return e.topPanelScopeButton?i.createElement(De.S,null,u,i.createElement("div",{style:{paddingLeft:r.paddingLeft,paddingRight:r.paddingRight,width:"100%",boxSizing:"border-box"}},i.createElement("div",{style:{width:"100%",height:"3px",background:null!==(n=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==n?n:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):u})(t):(t=>{var o,n;const r=F(t),l=x(!1),c=Object.assign({onFocus:R,onBlur:M,onClick:B,onPointerEnter:_,onPointerLeave:I,onPointerDown:E,onPointerUp:A,styles:{root:r,rootPressed:r,rootFocused:r,rootHovered:r,rootDisabled:r,flexContainer:N()},disabled:e.disabled,ariaLabel:tt(e,s,ot(e))},D());Ke.tO(e,c),e.onHeightChange&&u.current&&e.onHeightChange(u.current.getBoundingClientRect().height);const d=(0,qe.Zq)({selectors:{":hover":{[`.${Tt.ru}`]:{display:"inline !important"},[`.${Tt.$C}`]:{display:"none !important"}}}}),g=i.createElement(Le._,Object.assign({role:e.topPanelScopeButton?"tab":"button",id:e.htmlId,elementRef:u,componentRef:a,className:Xe.uk(e,f)?(0,Ct.z)("hasKeyboardFocus_67b207b6",l,d):(0,Ct.z)(l,d)},c,{"data-automation-id":e.automationLabel}),T);return e.topPanelScopeButton?i.createElement(De.S,null,g,i.createElement("div",{style:{paddingLeft:r.paddingLeft,paddingRight:r.paddingRight,width:"100%",boxSizing:"border-box"}},i.createElement("div",{style:{width:"100%",height:"3px",background:null!==(n=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==n?n:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):g})(t);return z?(t=>{const o=P(t),n=N(),r=Object.assign({onMouseEnter:_,onMouseLeave:I,onMouseDown:E,onMouseUp:A,onClick:B,style:Object.assign(Object.assign(Object.assign(Object.assign({},o),{display:"flex"}),n),{cursor:"pointer"})},D());return i.createElement("div",Object.assign({},r),e.children)})(t):o})));return L?g?i.createElement(Ve.q.Consumer,null,(t=>{var o,n,r,s,a,l,u;const d=(0,qe.Zq)({maxWidth:null==H?void 0:H.calloutMaxWidth,borderRadius:null==H?void 0:H.borderRadius,paddingLeft:t?null==H?void 0:H.paddingEnd:null==H?void 0:H.paddingStart,paddingTop:null==H?void 0:H.paddingTop,paddingRight:t?null==H?void 0:H.paddingStart:null==H?void 0:H.paddingEnd,paddingBottom:null==H?void 0:H.paddingBottom});return i.createElement(kt.m,{withArrow:null==H?void 0:H.showBeak,content:{children:L,className:d},relationship:"inaccessible",mountNode:document.getElementById(null!==(n=null===(o=e.tooltipProps)||void 0===o?void 0:o.layerHostId)&&void 0!==n?n:c),positioning:null!==(s=null===(r=e.tooltipProps)||void 0===r?void 0:r.positioning)&&void 0!==s?s:It(null!==(l=null===(a=e.tooltipProps)||void 0===a?void 0:a.directionHint)&&void 0!==l?l:ze.A.bottomCenter)},(null===(u=e.tooltipProps)||void 0===u?void 0:u.layerHostId)?V:i.createElement("div",{id:c,style:{display:"flex"}},V))})):i.createElement(Ve.q.Consumer,null,(e=>{var t,o;return i.createElement(We.S,{componentRef:d,directionalHint:null!==(t=null==H?void 0:H.directionHint)&&void 0!==t?t:ze.A.bottomCenter,content:L,styles:{root:{display:"flex"}},id:c,calloutProps:{coverTarget:null==H?void 0:H.coverTarget,isBeakVisible:null==H?void 0:H.showBeak,onClick:B,backgroundColor:U,gapSpace:null==H?void 0:H.gapSpace,calloutMaxWidth:null==H?void 0:H.calloutMaxWidth,layerProps:(null==H?void 0:H.layerHostId)?{hostId:H.layerHostId}:void 0,styles:{beakCurtain:{backgroundColor:U},root:{backgroundColor:U,cursor:"pointer",borderRadius:null==H?void 0:H.borderRadius,paddingLeft:e?null==H?void 0:H.paddingEnd:null==H?void 0:H.paddingStart,paddingTop:null==H?void 0:H.paddingTop,paddingRight:e?null==H?void 0:H.paddingStart:null==H?void 0:H.paddingEnd,paddingBottom:null==H?void 0:H.paddingBottom}}},tooltipProps:{styles:{content:{backgroundColor:U},subText:{color:null!==(o=null==W?void 0:W.textColor)&&void 0!==o?o:null==G?void 0:G.resting,borderRadius:8}}},delay:Ge.H.long},V)})):V})));function It(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case ze.A.topLeftEdge:return{position:"above",align:"start"};case ze.A.topCenter:case ze.A.topAutoEdge:return{position:"above",align:"center"};case ze.A.topRightEdge:return{position:"above",align:"end"};case ze.A.bottomLeftEdge:return{position:"below",align:"start"};case ze.A.bottomCenter:case ze.A.bottomAutoEdge:return{position:"below",align:"center"};case ze.A.bottomRightEdge:return{position:"below",align:"end"};case ze.A.leftTopEdge:return{position:"before",align:"top"};case ze.A.leftCenter:return{position:"before",align:"center"};case ze.A.leftBottomEdge:return{position:"before",align:"bottom"};case ze.A.rightTopEdge:return{position:"after",align:"top"};case ze.A.rightCenter:return{position:"after",align:"center"};case ze.A.rightBottomEdge:return{position:"after",align:"bottom"}}}_t.displayName="CompositeButtonBase";const Et=i.memo(i.forwardRef(((e,t)=>{const o=i.useContext(je.O),[n,r]=i.useState(!1),[s,a]=i.useState(!1),[l,c]=i.useState(!1);return i.createElement(_t,Object.assign({ref:t},e,{onHoverIn:()=>{var t;null===(t=e.onHoverIn)||void 0===t||t.call(e),c(!0)},onHoverOut:()=>{var t;null===(t=e.onHoverOut)||void 0===t||t.call(e),c(!1),r(!1)},onFocus:t=>{var o;!t.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,t),a(!0))},onBlur:t=>{var o;!t.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,t),a(!1))},onPressIn:()=>{var t;null===(t=e.onPressIn)||void 0===t||t.call(e),r(!0)},onPressOut:()=>{var t;null===(t=e.onPressOut)||void 0===t||t.call(e),r(!1)}}),((e,t,o,n,r,s,a,l)=>{var c,u,d,g,h,p,f,m,v,y,b;if(e.children)return e.children;const S={flexibleSize:Qe.f6(e)?"center"!==Qe.AW(e.style):void 0},C=s(e,o,n,r,a,l),w=it(e),k=nt(e,t,o,n,r,l),T=rt(e,o,n,r,l),x=C||w;if(!x&&!k)return null;let _=null!==(u=null===(c=e.style)||void 0===c?void 0:c.textPaddingStart)&&void 0!==u?u:null===(d=e.style)||void 0===d?void 0:d.textHorizontalPadding,I=null!==(h=null===(g=e.style)||void 0===g?void 0:g.textPaddingEnd)&&void 0!==h?h:null===(p=e.style)||void 0===p?void 0:p.textHorizontalPadding;if(void 0===_&&void 0===I){const e=C||w?8:0;_=e,I=e}const E=k?i.createElement(De.S,{justifyContent:Pe.Pr.Center,align:"center"!==Qe.AW(e.style)?Pe.j5.Stretch:void 0,style:Object.assign({paddingStart:_,paddingEnd:I,minWidth:0},x?{flexibleSize:!0}:S)},T?i.createElement(De.S,{direction:Pe.PR.LeftToRight,align:Pe.j5.Baseline,style:{flexibleSize:!0}},k,T):k,st(e,o,n,r,l)):void 0,A=e.tagText?i.createElement(De.S,{align:Pe.j5.Center,justifyContent:Pe.Pr.Center,style:null===(f=e.tagStyles)||void 0===f?void 0:f.containerStyles},i.createElement(Fe.c,{text:e.tagText,style:null===(m=e.tagStyles)||void 0===m?void 0:m.textStyles,accessibilityHidden:e.disableTagAccessibility})):void 0;return x?i.createElement(De.S,{direction:Pe.PR.LeftToRight,align:Pe.j5.Center,style:Object.assign({minWidth:0},S)},null!=C?C:w,void 0!==(null===(v=e.style)||void 0===v?void 0:v.iconTextSpacing)&&0!==(null===(y=e.style)||void 0===y?void 0:y.iconTextSpacing)&&i.createElement(De.S,{style:{paddingHorizontal:null===(b=e.style)||void 0===b?void 0:b.iconTextSpacing}}),E,A):E})(e,ft,n,l,s,ht,pt(e,o),{useFluentV9:o}))})));Et.displayName="CompositeButton";var At,Bt=o(74246);!function(e){e[e.Default=0]="Default",e[e.RejectMessage=1]="RejectMessage"}(At||(At={}));class Rt extends i.Component{constructor(e){super(e),this.acceptButtonRef=i.createRef(),this.showSettingsButtonRef=i.createRef(),this.state={tonalFirstRunState:At.Default},this.onAccept=this.onClickAction.bind(this,Bt.h.Accept),this.onIgnore=this.onClickAction.bind(this,Bt.h.Ignore),this.onReject=this.onClickAction.bind(this,Bt.h.Reject),this.onOpenEditorSettings=this.onClickAction.bind(this,Bt.h.OpenEditorSettings),this.onDismissRejectMessage=this.onClickAction.bind(this,Bt.h.DismissRejectMessage)}componentDidUpdate(e,t){if(t.tonalFirstRunState!==this.state.tonalFirstRunState)switch(this.state.tonalFirstRunState){case At.Default:this.acceptButtonRef.current&&this.acceptButtonRef.current.focus();break;case At.RejectMessage:this.showSettingsButtonRef.current&&this.showSettingsButtonRef.current.focus()}}render(){return this.state.tonalFirstRunState===At.RejectMessage?this.renderRejectionMessageCard():this.renderFreCard()}renderFreCard(){return i.createElement(De.S,{direction:Pe.PR.LeftToRight,align:Pe.j5.Start,style:(e=this.theme,{backgroundColor:null==e?void 0:e.backgroundColor,minWidth:292})},this.renderNewFeatureIcon(),i.createElement(De.S,null,this.renderText(),this.renderButtons()));var e}renderNewFeatureIcon(){var e,t;return i.createElement(De.S,{style:Ce},i.createElement(Ne.In,{type:"NewFeature",primaryColor:this.context?"var(--editorTonalFreCardIconPrimaryColor, var(--colorPaletteBlueBackground2))":null===(e=this.theme)||void 0===e?void 0:e.iconPrimaryColor,secondaryColor:this.context?"var(--editorTonalFreCardIconSecondaryColor, var(--colorPaletteBlueBorderActive))":null===(t=this.theme)||void 0===t?void 0:t.iconSecondaryColor}))}renderText(){const{strings:e}=this.props;return i.createElement(De.S,{style:we},i.createElement(De.S,{direction:Pe.PR.TopToBottom,justifyContent:Pe.Pr.SpaceBetween,style:{maxWidth:184}},i.createElement(De.S,{style:{marginBottom:4}},i.createElement(Fe.c,{text:e.cardTitle,style:Ee(this.theme,!0),accessibilityRole:"heading"})),i.createElement(Fe.c,{text:e.textDescription,style:Ee(this.theme,!1),accessibilityRole:"text"})))}renderButtons(){const{strings:e,automationId:t}=this.props;return i.createElement(De.S,null,i.createElement(De.S,{align:Pe.j5.Baseline,direction:Pe.PR.LeftToRight},i.createElement(De.S,{style:{marginEnd:6}},this.renderAnswerButton(e.acceptButtonText,this.onAccept,!0)),this.renderAnswerButton(e.ignoreButtonText,this.onIgnore,!1)),i.createElement(De.S,{style:ke},this.context?i.createElement(Oe.R,{text:e.rejectLinkText,onClick:this.onReject,style:{fontSize:10,fontWeight:ve.IT.Normal,underlineType:ve.RV.Single}}):i.createElement(Et,{onClick:this.onReject,style:_e,theme:void 0===this.theme?void 0:Be(this.theme),automationLabel:`TonalFirstRunLinkButton_${t}`},i.createElement(Fe.c,{text:e.rejectLinkText,style:(o=this.theme,{fontSize:10,lineHeight:12,fontFamily:ye.V,cssColor:null==o?void 0:o.link,underlineType:ve.RV.Single,wrapMode:ve.bd.NoWrap})}))));var o}renderAnswerButton(e,t,o){const n=o?"Primary":"Default";return i.createElement(Et,{ref:o?this.acceptButtonRef:void 0,title:e,titleStyle:(r=e.length,[{start:0,length:r,fontWeight:ve.IT.SemiBold,fontFamily:ye.V,fontSize:12,lineHeight:16}]),onClick:t,appearance:o?"primary":"secondary",theme:void 0===this.theme?void 0:Ae(this.theme,o),disabled:!1,style:xe,automationLabel:`TonalFirstRunAnswerButton_${n}_${this.props.automationId}`});var r}renderRejectionMessageCard(){const{strings:e,automationId:t}=this.props;return i.createElement(De.S,{direction:Pe.PR.LeftToRight,align:Pe.j5.Start,style:(o=this.theme,{backgroundColor:null==o?void 0:o.backgroundColor})},i.createElement(De.S,{align:Pe.j5.Baseline,style:Te,direction:Pe.PR.TopToBottom},i.createElement(Fe.c,{text:e.rejectionMessage,style:Ie(this.theme,!1),accessibilityRole:"text"}),this.context?i.createElement(Oe.R,{text:e.editorSettingsText,onClick:this.onOpenEditorSettings,style:{fontSize:14,fontWeight:ve.IT.Normal,underlineType:ve.RV.Single}}):i.createElement(Et,{ref:this.showSettingsButtonRef,onClick:this.onOpenEditorSettings,style:_e,theme:void 0===this.theme?void 0:Be(this.theme),automationLabel:`OpenEditorSettings_${t}`},i.createElement(Fe.c,{text:e.editorSettingsText,style:Ie(this.theme,!0)}))),i.createElement(Et,{automationLabel:`DismissRejectMessage_${t}`,icon:{type:"Cancel"},onClick:this.onDismissRejectMessage,appearance:"subtle",theme:void 0===this.theme?void 0:Re(this.theme),style:Me,accessibilityLabel:e.dissmissButtonAccessibilityLabel}));var o}onClickAction(e){e===Bt.h.Reject&&this.setState({tonalFirstRunState:At.RejectMessage}),this.props.onClickAction(e)}get theme(){var e;return this.context?void 0:null!==(e=this.props.theme)&&void 0!==e?e:Se}}Rt.contextType=je.O;var Mt=o(83402),Dt=o(62520);let Pt;var Nt=o(4984);const Ft="editor-critique-card-id",Ot=(0,n.F5)({store:r.A.on(a.v),footerFREStore:r.A.on(l.D).optional(),themeStore:r.A.on(w.YQ).optional(),localizer:r.A.on(h.H),calloutDismissalHandler:r.A.on(c.J).optional(),styleStore:r.A.on(w.UC).optional(),hostSettings:r.A.on(p.n)});class jt extends i.Component{constructor(e){super(e),this.hasPositioned=!1,this.critiqueCalloutRef=i.createRef(),this.handleKeyDown=e=>{var t;this.store.isVisible&&(e.key===S.m.arrowDown||e.key===S.m.arrowUp?(e.stopPropagation(),e.preventDefault(),null===(t=this.critiqueCalloutRef.current)||void 0===t||t.focus()):"Escape"===e.key&&this.dismiss())},this.renderCallout=()=>i.createElement("div",null,i.createElement(me,Object.assign({},null!=Pt?Pt:Pt={settings:{theme:(0,Mt.I)((0,Dt.a)())},scopedSettings:{}}),this.renderSharedCallout())),this.emitClick=e=>{const t=new MouseEvent("click",{clientX:e.clientX,clientY:e.clientY});window.document.documentElement.dispatchEvent(t)},this.onAfterRender=()=>{var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),null===(t=this.documentEventListener)||void 0===t||t.addListener("contextmenu",this.emitClick,{capture:!0}),this.parentElement||(this.parentElement=this.store.getParentElement()),this.parentElement&&!this.parentElementEventListener&&(this.parentElementEventListener=new f.J(this.parentElement),this.parentElementEventListener.addListener("keydown",this.handleKeyDown)),this.store.afterRender()},this.dismiss=()=>{var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.store.clickNoActionHide()},this.renderTonalFreCard=()=>{const{themeStore:e,localizer:t}=this.props.deps,{onTonalFreAction:o}=this.store,n=null==e?void 0:e.getComponentActiveTheme(w.yF.tonalFreComponentName);if(n){let t;const o=null==e?void 0:e.getComponentThemes(w.yF.tonalFreComponentName),i=new C.CJ;o&&(i.isHighContrastWhite?t=o.get(w.SV.light):i.isHighContrastBlack&&(t=o.get(w.SV.dark)),t&&(n.iconPrimaryColor=t.highContrast.iconPrimaryColor,n.iconSecondaryColor=t.highContrast.iconSecondaryColor))}return i.createElement(Rt,{automationId:"tonal_fre_card",onClickAction:o,strings:{cardTitle:t.getMessage("ebx_tonalFreTitle"),textDescription:t.getMessage("ebx_tonalFreDescription"),acceptButtonText:t.getMessage("ebx_tonalFreAcceptButton"),ignoreButtonText:t.getMessage("ebx_tonalFreIgnoreButton"),rejectLinkText:t.getMessage("ebx_tonalFreRejectButton"),rejectionMessage:t.getMessage("ebx_tonalFreRejectMessage"),editorSettingsText:t.getMessage("ebx_tonalFreOpenEditorSettings"),dissmissButtonAccessibilityLabel:t.getMessage("ebx_tonalFreDismissButtonAccessibilityLabel")},theme:n})},this.renderSharedCard=()=>{var e,t;const{deps:o}=this.props,{footerFREStore:n,themeStore:r,styleStore:s,hostSettings:a}=o,{addOnFooterData:c,critiqueSource:g,critiqueType:h,calloutCategory:p,calloutTitle:f,suggestionsToRender:m,showSynonyms:v,dropDownActions:y,navInfo:S,brandingMode:C,explanation:k,explanationTitle:T,onCalloutAction:x,settings:_,isUpsell:I}=this.store,E=null==r?void 0:r.getComponentActiveTheme(w.iN.critiqueCalloutComponentName),A=null==s?void 0:s.getComponentStyle(w.iN.critiqueCalloutComponentName),B=null==s?void 0:s.getComponentStyle(w.iN.footerFreComponentName),R=null===(t=null===(e=a.serviceSettings)||void 0===e?void 0:e.multilingual)||void 0===t?void 0:t.hideFooterFreIcon;E&&I&&(E.addOnFooterBackground=E.upsellFooterColor);const M=null==n?void 0:n.footerProps.get(l.Y.critique);return i.createElement(u.d.Consumer,null,(e=>{var t,o,n,r;return i.createElement(i.Fragment,null,i.createElement(te,{ref:this.critiqueCalloutRef,addOnFooterData:(null==M?void 0:M.display)?void 0:c,automationId:"browser_extension",critiqueSource:g,definition:{definitionType:"CritiqueDefinition",critiqueType:h,header:p,subheader:f,contextText:void 0,contextDecorations:void 0,suggestions:m,maximumSuggestions:m.length,showContext:!1,showDescription:v,actions:y,critiqueSetSize:S?(0,d.v)(S).length:void 0,critiquePosition:null==S?void 0:S.currentIndex,brandingMode:C,explanation:k,explanationTitle:T},onAction:x,onAfterUpdate:this.onAfterRender,settings:_,strings:this.getLocalizedSharedStrings(),style:Object.assign(Object.assign({},A),{minWidth:null!==(t=null==A?void 0:A.minWidth)&&void 0!==t?t:300,maxWidth:null!==(o=null==A?void 0:A.maxWidth)&&void 0!==o?o:420,hasBottomAttachment:(null==M?void 0:M.display)&&!M.pages.size}),theme:E,layerHostId:e}),i.createElement(b.b,{target:l.Y.critique,styles:{container:Object.assign({borderRadius:{topStart:0,topEnd:0,bottomStart:2,bottomEnd:2},minWidth:null!==(n=null==A?void 0:A.minWidth)&&void 0!==n?n:300,maxWidth:null!==(r=null==A?void 0:A.maxWidth)&&void 0!==r?r:420},null==B?void 0:B.container),dismissContainerStyle:null==B?void 0:B.dismissContainerStyle,textContainerStyle:null==B?void 0:B.textContainerStyle},hideIcon:R}))}))},this.renderSharedCallout=()=>{var e,t,o;const{localizer:n,themeStore:r}=this.props.deps,{target:s,setInitialFocus:a,shouldShowTonalFre:l,gapSpace:c,styles:d}=this.store,h=null==r?void 0:r.getComponentActiveTheme(w.yF.critiqueCalloutComponentName);if(!0!==this.context){const o=(0,qe.Zq)(null===(e=d.calloutMain)||void 0===e?void 0:e.root,{marginLeft:this.state.marginLeft,marginRight:this.state.marginRight,border:(null===(t=null==h?void 0:h.callout)||void 0===t?void 0:t.borderColor)?`1px solid ${h.callout.borderColor}`:void 0});return i.createElement(u.U,{id:Ft,className:"ms-critique-callout","aria-label":n.getMessage("ebx_brandText"),calloutMaxWidth:450,doNotLayer:!1,gapSpace:c,isBeakVisible:!1,onDismiss:this.dismiss,onPositioned:e=>{e&&!this.hasPositioned&&(this.hasPositioned=!0,e.alignmentEdge===k.x.left?e.elementPosition.left?this.setState({marginLeft:-15,marginRight:0}):this.setState({marginLeft:0,marginRight:15}):e.alignmentEdge===k.x.right?e.elementPosition.left?this.setState({marginLeft:15,marginRight:0}):this.setState({marginLeft:0,marginRight:-15}):this.setState({marginLeft:0,marginRight:0}))},role:"dialog",target:(0,m.KV)(s),preventDismissOnLostFocus:!1,preventDismissOnEvent:this.onPreventDismissCalloutOnEvent,styles:Object.assign(Object.assign({},d.calloutMain),{root:o})},i.createElement(y.Y,{disableFirstFocus:!a,isClickableOutsideFocusTrap:!0},l?this.renderTonalFreCard():this.renderSharedCard()))}{const e=e=>void 0!==(null==e?void 0:e.key),t={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!0,withArrow:!1,open:this.store.isVisible,onOpenChange:(t,o)=>{if((o.open||!this.onPreventDismissCalloutOnEvent(t))&&!o.open){const o=t.nativeEvent;e(o)&&"Escape"===o.key&&this.store.restoreCaretToPreviousPosition(),this.dismiss()}},positioning:{target:(0,m.ug)(s),align:"start",position:"below",offset:e=>({mainAxis:c,crossAxis:"start"===e.alignment?-15:0})},ariaLabel:this.store.ariaLabelToReadWhenCardIsOpened},surface:{className:"ms-critique-callout",style:Object.assign({padding:0,maxWidth:450,border:(null===(o=null==h?void 0:h.callout)||void 0===o?void 0:o.borderColor)?`1px solid ${h.callout.borderColor}`:void 0},d.calloutV9)}};return i.createElement(i.Fragment,null,i.createElement("div",{id:Ft,"aria-live":"polite","aria-label":this.store.ariaLabelToReadWhenCardIsOpened}),i.createElement(g.v,Object.assign({},t),l?this.renderTonalFreCard():this.renderSharedCard()))}},this.onPreventDismissCalloutOnEvent=e=>{const{deps:t}=this.props,{calloutDismissalHandler:o}=t;if(o&&!o.shouldDismissCallout(e,"CritiqueCallout",void 0))return!0;if("click"===e.type){const t=this.store.target;if((0,v.C)(t,"HTMLElement")){if(i=t.getBoundingClientRect(),n=e.pageX,r=e.pageY,i.x<=n&&n<=i.x+i.width&&i.y<=r&&r<=i.y+i.height)return!0}}var i,n,r;return!1},this.store=e.deps.store,this.state={marginLeft:-15,marginRight:-15},this.documentEventListener=new f.J(this.store.targetDocumentRef)}componentDidUpdate(e,t,o){var i,n,r,s,a,l,c;this.parentElement||(this.parentElement=this.store.getParentElement()),this.store.isVisible?(null===(i=this.parentElement)||void 0===i||i.setAttribute("aria-activedescendant",Ft),null===(n=this.parentElement)||void 0===n||n.setAttribute("aria-controls",Ft),null===(r=this.parentElement)||void 0===r||r.setAttribute("aria-owns",Ft),this.store.setInitialFocus&&(null===(s=this.critiqueCalloutRef.current)||void 0===s||s.focus())):(null===(a=this.parentElement)||void 0===a||a.removeAttribute("aria-activedescendant"),null===(l=this.parentElement)||void 0===l||l.removeAttribute("aria-controls"),null===(c=this.parentElement)||void 0===c||c.removeAttribute("aria-owns"))}componentWillUnmount(){var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.documentEventListener=void 0,this.parentElement=void 0,null===(t=this.parentElementEventListener)||void 0===t||t.removeAllListeners(),this.parentElementEventListener=void 0}render(){const{styles:e,target:t}=this.store;let o=this.store.isVisible;return(!t||"x"in t&&"y"in t&&0===t.x&&0===t.y||(0,v.C)(t,"HTMLElement")&&!t.isConnected)&&(o=!1),i.createElement("div",{style:e.shadowHost},o?this.renderCallout():null)}getCommonStringsMap(){return{suggestionsGroupNoSuggestionsText:this.store.noSuggestionLabel}}getTextFormattingStringsMap(){const{localizer:e}=this.props.deps,{text:t,textInContext:o}=this.store;return{contextAccessibilityLabelForSpelling:e.getMessage("contextAccessibilityLabelForSpelling",[t,o]),contextAccessibilityLabelForRepeatedWord:e.getMessage("contextAccessibilityLabelForRepeatedWord",[t,o]),contextAccessibilityLabelForGrammar:e.getMessage("contextAccessibilityLabelForGrammar",[t,o]),contextAccessibilityLabelForRefinement:e.getMessage("contextAccessibilityLabelForRefinement",[t,o]),contextAccessibilityLabelForCorrection:e.getMessage("contextAccessibilityLabelForCorrection",[t,o])}}getCritiqueExplanationStringsMap(){const{localizer:e}=this.props.deps;return{explanationTableBefore:e.getMessage("explanationTableBefore"),explanationTableAfter:e.getMessage("explanationTableAfter"),explanationTableSeparator:e.getMessage("explanationTableSeparator"),explanationTableAccessibilityLabel:e.getMessage("explanationTableAccessibilityLabel")}}getCritiqueStringsMap(){var e;const{localizer:t}=this.props.deps,{calloutCategory:o,calloutTitle:i,navInfo:n}=this.store,r=t.getMessage("ebx_asInSynonyms"),s=`{0} ${r} {1}`,a=`{0}, {1} ${r} {2}`,l=n?(0,d.v)(n).length:0,c=null!==(e=null==n?void 0:n.currentIndex)&&void 0!==e?e:0,u=l-c-1;return{previewHeaderLabel:t.getMessage("ebx_previewLabel"),spellingCardHeader:o,repeatedWordCardSubheader:i,grammarCardHeader:o,tonalRewriteCardHeader:t.getMessage("ebx_toneLabel"),deleteRepeatedWord:t.getMessage("ebx_deleteRepeatedWord"),spellingSuggestionDescriptionAccessibilityLabel:s,suggestionWithTagAccessibilityLabel:"{0}, {1}",spellingSuggestionTagAndDescriptionAccessibilityLabel:a,ignoreAll:t.getMessage("ebx_ignoreAllButtonLabel"),ignoreOnce:t.getMessage("ebx_ignoreOnceButtonLabel"),addToDictionary:t.getMessage("ebx_addToDictionaryButtonLabel"),microsoftEditorBranding:t.getMessage("ebx_brandText"),microsoftEditorBrandingAccessibilityLabel:t.getMessage("ebx_brandTextArialLabel"),editorButtonTooltipContent:t.getMessage("ebx_settingsButtonTooltip"),footerSeeMoreActionsAccessibilityLabel:t.getMessage("ebx_moreButtonArialLabel"),changeAll:t.getMessage("ebx_changeAllCommandLabel"),giveFeedbackButtonText:t.getMessage("ebx_giveFeedback"),hideSynonyms:t.getMessage("ebx_hideSynonyms"),showSynonyms:t.getMessage("ebx_showSynonyms"),ignoreRule:t.getMessage("ebx_disableCritiqueButton"),options:t.getMessage("ebx_changeSettingsCommandLabel"),manageLanguages:t.getMessage("ebx_manageLanguages"),nextIssue:t.getMessage("ebx_nextIssueWithCount",u.toString()),nextIssueWithCount:t.getMessage("ebx_nextIssueWithCount",u.toString()),previousIssue:t.getMessage("ebx_previousIssueWithCount",c.toString()),previousIssueWithCount:t.getMessage("ebx_previousIssueWithCount",c.toString()),readAloudOriginalSentenceAccessibilityLabel:t.getMessage("readAloudOriginalSentenceAccessibilityLabel"),explanationFlyoutAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),footerExplanationButtonAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),editorButtonText:t.getMessage("editorButtonText")}}getLocalizedSharedStrings(){const e=this.getCritiqueStringsMap(),t=this.getCommonStringsMap(),o=this.getCritiqueExplanationStringsMap(),i=this.getTextFormattingStringsMap();return{critique:t=>e[t]||"",common:e=>t[e]||"",critiqueExplanation:e=>o[e]||"",textFormatting:e=>i[e]||""}}}jt.contextType=w.O1;const qt=(0,s.r)((0,Nt.PA)(jt),Ot)},2713:(e,t,o)=>{"use strict";o.d(t,{b:()=>re});var i,n,r=o(30206),s=o(68669),a=o(22779),l=o(48366);!function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(i||(i={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(n||(n={}));const c=(0,l.f)("IUpsellFeature");var u=o(66284),d=o(86336),g=o(59834),h=o(41863),p=o(9782),f=o(78204),m=o(16269);const v=(e,t,o,i)=>{if(i){let i=t;for(;" "!==e.charAt(i)&&i<o;)i+=1;return i}{let i=o;const n=o;for(;" "!==e.charAt(i)&&i>t;)i-=1;return i+1<=n&&(i+=1),i}};var y=o(46975),b=o(19454),S=o(21739),C=o(24902),w=o(87333),k=o(57767),T=o(44074),x=o(76509),_=o(2750),I=o(12470),E=o(71091),A=o(90804),B=o(67680),R=o(66932),M=o(1208),D=o(98556),P=o(1845),N=o(99654);const F=(0,l.f)("ITonalFreStore");var O=o(16022),j=o(14643),q=o(77251),L=o(12535),H=o(26064),z=o(15301),W=o(91799),G=o(71866),U=o(18230),V=o(9218),$=o(9005),K=o(37801),J=o(27032),Z=o(46546),Y=o(48828),Q=o(90424),X=o(30225),ee=o(43463),te=o(87253),oe=o(74246),ie=o(75026),ne=o(74906);let re=class{constructor(e,t,o,r,l,c,b,S,C,w,k,T,x,_,I,E,A,M,D,P,N,F,O,W,G,U){var V;this.proofingStore=e,this.localizerService=t,this.hostSettings=o,this.wordDictionary=r,this.instrumentationProcessor=l,this.logger=c,this.validator=b,this._showSynonymsFeature=S,this._proofingDom=C,this._tileContent=w,this._upsellFeature=k,this.styleDefinitions=T,this._roamingDictionaryBroker=x,this._upsellStore=_,this._featureFlagsReader=I,this._unSignedInEditorFeature=E,this._ariaStatusStateStore=A,this._feedbackStore=M,this._tonalFreStore=D,this._categoryLocalization=P,this._paneOpenState=N,this._externalSettingsFeature=F,this._roamingDictionaryFeature=O,this._indicatorStore=W,this._multilingualFreStore=G,this._autoCorrectionBroker=U,this.wasMarkedAsShown=!1,this.enableUpsell=!1,this._setInitialFocus=!1,this._isVisible=!1,this._target=void 0,this.showSynonymsState=!1,this._suggestionsToRender=[],this.isApplyingCritiqueAction=!1,this.navInfo=void 0,this._gapSpace=void 0,this._unsignedInEditorFeatureEnabled=!1,this.show=async e=>{var t,o,r,l,c,d;const{critique:g,setInitialFocus:h,target:p,onDismiss:f,onApplySuggestion:m,onIgnoreOnce:v,onIgnoreAll:y,onDisableCritiqueType:b,onShowFeedback:S,targetDocumentRef:C,gapSpace:w}=e,k=null!==(o=null===(t=this._upsellStore)||void 0===t?void 0:t.reducePreviewCount(g))&&void 0!==o?o:B.nz.Visible,T=null===(r=this._upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(g);if(k!==B.nz.Hidden&&!T){if(this._unsignedInEditorFeatureEnabled=await this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:s.o9.CalloutShown,sender:s.v$.CritiqueCallout}),this.setSynonymsState(await this.proofingStore.read(a.l.ShowSynonyms)),this._suggestionsToRender=[],this._setInitialFocus=h,this.critique=g,this._targetDocumentRef=C,this.enableUpsell=!!(null===(l=this._upsellFeature)||void 0===l?void 0:l.emitAndEvaluate({eventId:i.CritiqueClicked,sender:n.ShowCritiqueCallout,critique:this.critique})),g.suggestions.length>0)for(const[e,t]of g.suggestions.entries()){if((0,u.gA)(t.action))continue;let o={id:e.toString(),title:this.getSuggestionTitle(t),subtitle:this.getSuggestionDescription(t),tag:this.getLanguageTags(t),actions:[ee._R.Accept]};this.isRewrite&&(o=Object.assign(Object.assign({},o),this.getSuggestionTitleWithDecorations(t))),this.suggestionsToRender.push(o)}this.critique.shouldShowMultilingualFre?null===(c=this._multilingualFreStore)||void 0===c||c.addMultilingualProofingFre():null===(d=this._multilingualFreStore)||void 0===d||d.removeMultilingualProofingFre(),this.onAfterShownCallback=()=>{this._setInitialFocus&&(0,ne.Fy)(!0),this.onAfterShownCallback=void 0},this._gapSpace=w,(0,Z.runInAction)((()=>{this._target=p})),this.onApplySuggestion=m,this.onIgnoreOnce=v,this.onIgnoreAll=y,this.onDisableCritiqueType=b,this.onShowFeedback=S,this.setIsVisible(!0),this.onShown(g,f)}},this.setSynonymsState=e=>{this.showSynonymsState=e},this.setIsVisible=e=>{this._isVisible=e,this.wasMarkedAsShown=!1},this.hide=()=>{var e;(this._isVisible||this.wasMarkedAsShown)&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isRewrite&&(null===(e=this._tonalFreStore)||void 0===e||e.checkIfDisableTonalCritiqueInitiatedAndCompleteIt()),this._isVisible=!1,this.wasMarkedAsShown=!1,this.instrumentationEventId=void 0,this.critique=void 0,this._target=void 0,this._targetDocumentRef=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onDisableCritiqueType=void 0,this.footerAction=void 0,this._gapSpace=void 0,this._suggestionsToRender=[],this.onDismiss()},this.onDismiss=()=>{var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this),this.onDismissCallback=void 0},this.afterRender=()=>{var e;null===(e=this.onAfterShownCallback)||void 0===e||e.call(this)},this.onCalloutAction=(e,t,o)=>{this.isApplyingCritiqueAction=!0;try{this.isCritiqueAction(e)?this.onCritiqueAction(e,t):this.onCardAction(e)}finally{this.isApplyingCritiqueAction=!1}},this.onTonalFreAction=e=>{var t;if(this._tonalFreStore){this.isApplyingCritiqueAction=!0;try{let o=!1;switch(e){case oe.h.Accept:this._tonalFreStore.acceptTonalRewriteCritique();break;case oe.h.Ignore:this.ignoreOnce(),o=!0,this._tonalFreStore.logTonalFreIgnored();break;case oe.h.Reject:void 0!==(null===(t=this.critique)||void 0===t?void 0:t.typeId)&&this._tonalFreStore.disableTonalRewriteCritique(this.critique.typeId);break;case oe.h.OpenEditorSettings:this._tonalFreStore.showEditorSettings(),o=!0;break;case oe.h.DismissRejectMessage:o=!0}o&&this.hide()}finally{this.isApplyingCritiqueAction=!1}}},this.changeShowSynonymsState=()=>{const e=!this.showSynonymsState;this.proofingStore.write(a.l.ShowSynonyms,e).then((()=>{this.updateShowSynonyms(e)}))},this.updateShowSynonyms=e=>{this.showSynonymsState=e;const t=this.logger.getNewActivity(this.showSynonyms?d.n.ActionShowSynonymsFromCallout:d.n.ActionHideSynonymsFromCallout,g.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())},this.goPremium=e=>{var t;null===(t=this._upsellFeature)||void 0===t||t.goPremium(n.ShowCritiqueCallout,this.critique,e)},this.tryPremiumPreview=()=>{var e;null===(e=this._upsellStore)||void 0===e||e.tryPremiumPreview(this.critique)},this.signIn=()=>{chrome.runtime.sendMessage({activity:"authentication",type:"msidUserService"});const e=this.logger.getNewActivity(d.n.SignInInitialized,g.o.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push((0,h.n)("Entry","CritiqueCallout")),e.success=!0,e.endNow())},this.clickNoActionHide=()=>{const e=this.shouldShowTonalFre;!this.isVisible&&!this.wasMarkedAsShown||e||this.recordInstrumentationEventId(J.xp.ClickNoAction),this.hide()},this.notifyAriaStatusChange=e=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(e,"assertive")},this.applySuggestion=(e,t)=>{var o;this.critique&&this.onApplySuggestion&&(null===(o=this._upsellStore)||void 0===o||o.removePremiumCritique(this.critique),this.onApplySuggestion(this.critique,e))},this.ignoreOnce=()=>{var e,t;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&(null===(t=this.onIgnoreOnce)||void 0===t||t.call(this,this.critique))},this.ignoreAll=()=>{var e;this.critique&&(null===(e=this.onIgnoreAll)||void 0===e||e.call(this,this.critique))},this.addToDictionary=()=>{var e;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&this.wordDictionary.addWordToCustomDictionary(this.critique.textInContext)},this.disableCritiqueType=async()=>{var e;const t=this.critique;if(void 0===(null==t?void 0:t.typeId))return void this.logger.error(571326788,"Undefined critique or typeId while trying to disable a critique type");await(null===(e=this.onDisableCritiqueType)||void 0===e?void 0:e.call(this,t));const o=this.logger.getNewActivity(d.n.ActionDisableCritique,g.o.SamplingPolicy.CriticalExperimentation);o&&(o.dataFields.push((0,h.n)("CritiqueTypeId",t.typeId)),t.typeId===p.L9.TopicSuggestion&&o.dataFields.push((0,h.n)("CritiqueMetadataJSON",JSON.stringify(t.metadata))),o.success=!0,o.endNow()),this.recordInstrumentationEventId(J.xp.DoNotCheckThisIssue),this.notifyAriaStatusChange(t.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",t.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel")),this.hide()},this.onRewriteFeedback=()=>{if(this.isRewrite){const e=this.suggestionsToRender.length>0?this.suggestionsToRender[0].title:"";this._feedbackStore.feedbackIconClicked(e,"tonal"),this.hide()}},this.isCritiqueAction=e=>{switch(e){case ee._R.Accept:case ee._R.IgnoreOnce:case ee._R.IgnoreAll:case ee._R.AddToDictionary:case ee._R.IgnoreRule:return!0;default:return!1}},this.onCritiqueAction=(e,t)=>{var o;if(!this.critique)return void this.logger.error(562438878,`Undefined critique on action: ${e}`);const i=void 0!==t?this.critique.suggestions[t]:void 0;let n,r;switch(e){case ee._R.Accept:i&&void 0!==t?(this.applySuggestion(i,t),n=this.localizer.getMessage("ebx_SuggestionAppliedMessage",i.text),r=this.isSpellingDeletion?J.xp.Delete:Math.min(t+J.xp.ChangeSugg0,J.xp.ChangeSuggOther)):this.logger.error(543495585,`Undefined suggestionIndex or suggestion on Accept: ${t}, ${i}`);break;case ee._R.IgnoreOnce:this.ignoreOnce(),n=this.localizer.getMessage("ebx_GrammarIgnored"),r=J.xp.Ignore;break;case ee._R.IgnoreAll:this.ignoreAll(),n=this.localizer.getMessage("ebx_SpellingIgnored"),r=J.xp.IgnoreAll;break;case ee._R.AddToDictionary:this.addToDictionary(),n=this.localizer.getMessage("ebx_AddedToDictionary",this.critique.textInContext),r=J.xp.AddToDictionary;break;case ee._R.IgnoreRule:this.disableCritiqueType(),n=this.critique.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",this.critique.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel"),r=J.xp.DoNotCheckThisIssue}void 0!==r?this.recordInstrumentationEventId(r):this.logger.error(562438879,`Undefined actionInstrumentationEventId on action: ${e}`),void 0!==n?this.notifyAriaStatusChange(n):this.logger.error(562438880,`Undefined actionAriaNotification on action: ${e}`),this.hide(),null===(o=this.navInfo)||void 0===o||o.onNavSuggestionApplied()},this.executeActionIfDefined=(e,t)=>{t?t():this.logger.error(561853783,`Undefined action clicked: ${e}`)},this.onCardAction=e=>{var t,o;switch(e){case ee._R.Options:this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide();break;case ee._R.ManageLanguages:this.executeActionIfDefined("manageLanguagesAction",this.manageLanguagesAction),this.hide();break;case ee._R.ShowExplanation:break;case ee._R.Feedback:if(this.isRewrite)this.onRewriteFeedback();else if(this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback){let e;try{e=this.critique.suggestions.map((e=>{var t;return JSON.parse(null!==(t=e.metadataJSON)&&void 0!==t?t:"{}")}))}catch(e){this.logger.error(537778203,"Error parsing topic metadata json.")}(0,f.z)((0,L.S)({topicIds:(null==e?void 0:e.map((e=>e.id)).join(", "))||"",topicNames:(null==e?void 0:e.map((e=>e.displayName)).join(", "))||"",highlightedText:this.critique.textInContext||"",requestId:this.critique.metadata[0].value,hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),source:"EditorFlag",traceId:this.critique.traceId||""}))}else this.executeActionIfDefined("onShowFeedback",this.onShowFeedback);break;case ee._R.ToggleDescription:this.changeShowSynonymsState();break;case ee._R.AddOnFooterAction:this.executeActionIfDefined("footerAction",this.footerAction);break;case ee._R.Next:this.navigate(1);break;case ee._R.Previous:this.navigate(-1);break;case ee._R.OpenEditorPane:this._indicatorStore?null===(o=(t=this._indicatorStore).onOpenEditorPane)||void 0===o||o.call(t,j.k.ContextualCard):this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide()}},this.getSuggestionTitle=e=>!(0,R.qB)(e)&&this.critique&&(0,R.ht)(this.critique)?this.localizer.getMessage("ebx_deleteRepeatedWord"):this.validator.validate(e.text),this.getSuggestionTitleWithDecorations=e=>{var t;if(null===(t=this.critique)||void 0===t?void 0:t.textInContext){const{truncatedPrefix:t,truncatedSubstring:o,truncatedSuffix:i}=((e,t)=>{const o=t.length,i=((e,t)=>{const o=e.length,i=t.length;let n=0,r=0;for(let s=0;s<Math.min(o,i)&&e.charAt(s)===t.charAt(s);s+=1)n+=1,(0,m.Yv)(e.charCodeAt(s))&&(r=n);return r})(e,t),n=Math.min(((e,t)=>{const o=e.length,i=t.length;let n=0,r=0;for(let s=0;s<Math.min(o,i)&&e.charAt(o-s-1)===t.charAt(i-s-1);s+=1)n+=1,(0,m.Yv)(e.charCodeAt(o-s-1))&&(r=n);return r})(e,t),Math.min(o,e.length)-i),r=i+n,s=o-r,a=Math.min(130,s),l=Math.min(150-a,r),c=Math.min(l,i),u=Math.min(l,n),{actualLeftContextLength:d,actualRightContextLength:g}=((e,t,o)=>{let i,n;const r=e/2;return t<r&&o<r?(i=t,n=o):t<r?(i=t,n=Math.min(o,e-i)):o<r?(n=o,i=Math.min(t,e-n)):(i=r,n=r),{actualLeftContextLength:i,actualRightContextLength:n}})(l,c,u),h=t.substring(i-d,i),p=t.substring(i,o-n),f=t.substring(o-n,o-n+g);let y=h,b=p,S=f;if(i>d){const e=v(h,0,h.length,!0);y=`...${h.substring(e,h.length)}`}if(p.length>a){const e=v(p,0,a/2,!1),t=v(p,a/2,p.length,!0);b=`${p.substring(0,e)}...${p.substring(t,p.length)}`}if(n>g){const e=v(f,0,f.length,!1);S=`${f.substring(0,e)}...`}return{truncatedPrefix:y,truncatedSubstring:b,truncatedSuffix:S}})(this.critique.textInContext,e.text);return{title:t+o+i,titleDecorations:[{start:e.text.indexOf(o),length:o.length,decorationType:ee.vr.Rewrite}]}}return{title:this.getSuggestionTitle(e),titleDecorations:void 0}},this.getSuggestionDescription=e=>{if(!this.isSynonymsEnabled)return;if(!this.isSynonymsAvailable)return;let t=this.validator.validate(e.description);return this.isTopicSuggestionCritique&&(t=t.slice(0,125),e.description&&e.description.length>t.length&&(t+="...")),t||this.localizer.getMessage("ebx_synonymsNotAvailable")},this.getNeutralLanguageCode=e=>{const t=e.indexOf("-");return(t<0?e:e.slice(0,t)).toUpperCase()},this.getLanguageTags=e=>{const t=this.proofingStore.getCachedEntry(a.l.ProofingLanguages).storeEntryValue;if(!t||t.length<2||!e.languages)return"";const o=[];for(const t of e.languages){const e=this.getNeutralLanguageCode(t);o.includes(e)||o.push(e)}return o.join(", ")},this.setNavInfo=e=>{this.navInfo=e},this.navigate=(e=0)=>{const t=(0,H.v)(this.navInfo),o=t.length;if(!this.navInfo||0===o)return this.resetNavigation(),this.clickNoActionHide(),!1;const i=((this.navInfo.currentIndex+e)%o+o)%o,n=t[i];return this.navInfo=Object.assign(Object.assign({},this.navInfo),{currentIndex:i}),this.hide(),"contenteditable"===this.navInfo.ctr?this.navigateCe(n.store,n.critique):this.navigateV2(n.store,n.critique),!0},this.navigateCe=(e,t)=>{const o=this.navInfo;e.showCallout(t,(()=>{this.setNavInfo(o)}))},this.navigateV2=(e,t)=>{const o=e.messageItem.anchor.element,i=this.navInfo;e.showCallout(t,o,o.innerText,!0,(()=>{this.setNavInfo(i)}),z.Ah.critique)},this.resetNavigation=()=>{var e;null===(e=this.navInfo)||void 0===e||e.onCloseNavigation(),this.navInfo=void 0},this.recordInstrumentationEventId=e=>{var t;this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e),e===J.xp.ClickNoAction&&this.resetNavigation(),null===(t=this._indicatorStore)||void 0===t||t.userInputEvent()},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,Z.toJS)(this.critique),eventId:e})},(0,q.Gn)(this),(null===(V=this._externalSettingsFeature)||void 0===V?void 0:V.openSettings)&&(this.showOptionsAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(y.kY.dropdown)},this.manageLanguagesAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(y.kY.manageLanguages)})}get roamingDictionaryEnabled(){var e,t;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!(null===(t=this._roamingDictionaryFeature)||void 0===t?void 0:t.isReady())}get cloudIconEnabled(){return this.hostSettings.inferenceCritiqueCloudIconEnabled&&!this.isRewrite}get shouldShowAddToDictionary(){return!!this.critique&&this.roamingDictionaryEnabled&&this.isSpelling&&!(0,R.dt)(this.critique)}get isUpsell(){return this.enableUpsell}get setInitialFocus(){return this._setInitialFocus}get isVisible(){return this._isVisible}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new b.O(document)}getParentElement(){var e,t;if(null===(e=this.critique)||void 0===e?void 0:e.nodeId){const e=this._proofingDom.findParagraphNode(this.critique.nodeId);if(!e)return;const o=this._tileContent.getContainingElement(e);if(o)return null!==(t=(0,ie.m)(o))&&void 0!==t?t:o}}get target(){return this._target}get isSynonymsEnabled(){return this._showSynonymsFeature.emitAndEvaluate({eventId:S.OV.GetMoreCommands,sender:S.xr.CritiqueCallout})}get showSynonyms(){return this.showSynonymsState||this.isTopicSuggestionCritique}get brandingMode(){return this.hostSettings.brandingMode}get suggestionsToRender(){return this._suggestionsToRender}get noSuggestionLabel(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.suggestions.length)&&(0,u.gA)(this.critique.suggestions[0].action)?this.critique.suggestions[0].text:""}get calloutTitle(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}return(0,R.dt)(this.critique)?this.localizer.getMessage("ebx_repeatedWordsExplanationTitle"):(0,R.r)(this.critique)?this.localizer.getMessage("ebx_spellingExplanationTitle"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionExplanationTitle"):this.validator.validate(this.critique.explanationTitle)}get text(){var e,t,o;return null!==(o=null===(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)||void 0===t?void 0:t.substring(this.critique.start,this.critique.start+this.critique.length))&&void 0!==o?o:""}get textInContext(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&void 0!==t?t:""}get calloutCategory(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}const e=this.critique.categoryTitle?this._categoryLocalization.toUiLocale(this.critique.categoryTitle):void 0,t=this.isRewrite?this.localizer.getMessage("ebx_toneLabel"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionLabel"):e;return this.validator.validate(t)}get explanation(){var e;return this.hostSettings.critiqueCalloutExplanationFlyout&&this.critique&&null!==(e=this.critique.explanation)&&void 0!==e?e:""}get explanationTitle(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.explanationLabel)&&void 0!==t?t:""}get localizer(){return this.localizerService}get styles(){return this.styleDefinitions.critiqueCallout}get ariaLabelToReadWhenCardIsOpened(){return this.localizer.getMessage("ebx_critiqueCalloutAriaLabel",[this.calloutCategory,this.explanationTitle,this.calloutTitle,this.textInContext])}get isSpelling(){return(0,R.r)(this.critique)}get isRepeatedWords(){return(0,R.dt)(this.critique)}get isRewrite(){return(0,R.r6)(this.critique)}get isTopicSuggestionCritique(){return(0,R.W)(this.critique)}get isAutoCorrection(){var e;return!!(this.hostSettings.enableAutoCorrect&&this.critique&&(0,R.MG)(this.critique)&&(null===(e=this._autoCorrectionBroker)||void 0===e?void 0:e.getHasAutoCorrectionBeenApplied(this.critique)))}get isSpellingDeletion(){return!!this.critique&&(0,R.ht)(this.critique)}get shouldShowTonalFre(){return this.isRewrite&&!!this.hostSettings.tonalFreEnabledForUser&&!!this._tonalFreStore&&!this._tonalFreStore.isTonalFreAccepted}get settings(){const e={RenderFooterIcons:"true"};return this.hostSettings.isFeedbackEnabled&&this.isRewrite&&(e.EnableFeedback="true"),this.hostSettings.ignoreAllEnabled&&(e.EnableIgnoreAll="true"),e}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:4}get critiqueType(){return this.critique&&(0,R.dt)(this.critique)?ee.L9.RepeatedWord:(0,R.r)(this.critique)?ee.L9.Spelling:(0,R.W)(this.critique)?ee.L9.Topic:this.critique&&this.critique.priority===p.bx.Medium?ee.L9.Grammar:this.isRewrite?ee.L9.TonalRewrite:ee.L9.Refinement}get critiqueSource(){if(this.critique&&this.cloudIconEnabled){const e=this.critique.metadata;if(e&&e.length>0)for(const t of e)if("CritiqueSource"===t.name&&"Inference"===t.value)return te.UD.Inference}return te.UD.Unknown}get isSynonymsAvailable(){var e;const t=null===(e=this.critique)||void 0===e?void 0:e.suggestions.find((e=>!!e.description&&!e.description.match(/\[(.*)\]/g)));return(this.isSpelling||this.isTopicSuggestionCritique)&&!this.isAutoCorrection&&!!t}get showDisableCritiqueTypeMenuItem(){return!!this.hostSettings.enableStopCheckingForThis&&!!this.critique&&this.critique.priority!==p.bx.High&&!this.isTopicSuggestionCritique}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}async initialize(){}shutDown(){this._target=void 0,this._targetDocumentRef=void 0,this.onDisableCritiqueType=void 0,this.onDismissCallback=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onAfterShownCallback=void 0,this.onShowFeedback=void 0,this.showOptionsAction=void 0,this.manageLanguagesAction=void 0,this.footerAction=void 0}markAsShown(e,t){this.wasMarkedAsShown=!0,this.onShown(e,t)}onShown(e,t){var o;this.shouldShowTonalFre&&(null===(o=this._tonalFreStore)||void 0===o||o.logTonalFreShown());const i=this.logger.getNewActivity(d.n.ActionShowCallout,g.o.SamplingPolicy.CriticalExperimentation);i&&(i.dataFields.push((0,h.n)("CritiqueTypeId",e.typeId)),e.typeId===p.L9.TopicSuggestion&&i.dataFields.push((0,h.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata))),i.success=!0,i.endNow()),this.onDismiss(),this.onDismissCallback=t}get dropDownActions(){var e;const t=[];return this.isAutoCorrection?t.push(ee._R.AutoCorrectOptions):this.isSpelling&&!this.isSpellingDeletion?(this.hostSettings.ignoreAllEnabled&&t.push(ee._R.IgnoreAll),this.hostSettings.isMultilingualProofingEnabled&&this.hostSettings.enableManageLanguagesInCritiqueCallout&&t.push(ee._R.ManageLanguages)):this.hostSettings.ignoreOnceEnabled&&t.push(ee._R.IgnoreOnce),this.isTopicSuggestionCritique&&this.hostSettings.ignoreAllEnabled&&t.push(ee._R.IgnoreAll),this.isSynonymsAvailable&&this.isSynonymsEnabled&&!this.isTopicSuggestionCritique&&t.push(ee._R.ToggleDescription),this.hostSettings.showOptionsButton&&t.push(ee._R.Options),(this._featureFlagsReader.flags.enableOcvFeedbackUi||this.hostSettings.isFeedbackEnabled&&this.isRewrite||this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback)&&t.push(ee._R.Feedback),this.showDisableCritiqueTypeMenuItem&&t.push(ee._R.IgnoreRule),!this.isAutoCorrection&&this.shouldShowAddToDictionary&&t.push(ee._R.AddToDictionary),this.navInfo&&(t.push(ee._R.Next),t.push(ee._R.Previous)),(null===(e=this._paneOpenState)||void 0===e?void 0:e.isPaneOpen)||this.brandingMode!==ee.nH.IconButton&&this.brandingMode!==ee.nH.IconAndTextButton||t.push(ee._R.OpenEditorPane),t}get addOnFooterData(){var e,t;if(this.unsignedInEditorFeatureEnabled)return this.footerAction=this.signIn,{actionText:this.localizer.getMessage("ebx_signIntoEditor"),message:`${this.localizer.getMessage("ebx_addGrammarChecking")}${this.localizer.getMessage("ebx_enhancedUpsellCategoriesComma")}`};if(!this.enableUpsell)return;if(!this.hostSettings.areAdditionalPaneEntryPointsEnabled||!this._indicatorStore)return this.premiumPreviewFooter;this.footerAction=()=>{var e,t;null===(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.onOpenEditorPane)||void 0===t||t.call(e,j.k.ContextualCard),this.hide()};const o=null!==(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.getPremiumCritiquesCount())&&void 0!==t?t:0;return{actionText:this.localizer.getMessage("ebx_openEditorLabel"),message:o>0?this.localizer.getMessage("ebx_editorAdvancedCritiquesLabel",o.toString()):this.localizer.getMessage("ebx_tryEditorLabel"),icon:"Editor"}}get premiumPreviewFooter(){if(!this.hostSettings.enhancedUpsellEnabled||!this._upsellStore)return this.footerAction=()=>this.goPremium("Regular_CCard"),{actionText:this.localizer.getMessage("ebx_goPremiumLinkText"),message:this.localizer.getMessage("ebx_goPremiumLine"),icon:"PremiumDiamond"};const e=this._upsellStore.previewModeActive,t=this.hostSettings.premiumPreviewEnabled,o=this._upsellStore.previewUnit,i=e?this._upsellStore.previewCount:this._upsellStore.premiumCount,n=t&&!e&&i>0;let r="ebx_premiumPreviewGeneralLine";const s=1===i;e&&o===B.mq.Suggestions?r=s?"ebx_premiumPreviewSuggestionsSingular":"ebx_premiumPreviewSuggestionsPlural":e&&o===B.mq.Days?r=s?"ebx_premiumPreviewDaysSingular":"ebx_premiumPreviewDaysPlural":i>0&&(r=s?"ebx_enhancedUpsellLineSingular":"ebx_enhancedUpsellLinePlural");const a=i.toLocaleString(),l=this.localizer.getMessage(r,a);return this.footerAction=n?()=>{var e;return null===(e=this._upsellStore)||void 0===e?void 0:e.tryPremiumPreview(this.critique)}:()=>this.goPremium("ContextualUpsell_CCard"),{actionText:n?this.localizer.getMessage("ebx_tryPremiumPreviewLink"):this.localizer.getMessage("ebx_goPremiumLinkText"),footerDecorations:i>0||e?[{decorationType:ee.vr.PremiumEmphasis,length:a.length,start:l.indexOf(a)}]:void 0,message:l,icon:"PremiumDiamond"}}restoreCaretToPreviousPosition(){var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this,!0)}};(0,r.__decorate)([Z.observable],re.prototype,"enableUpsell",void 0),(0,r.__decorate)([Z.computed],re.prototype,"isUpsell",null),(0,r.__decorate)([Z.observable],re.prototype,"_setInitialFocus",void 0),(0,r.__decorate)([Z.computed],re.prototype,"setInitialFocus",null),(0,r.__decorate)([Z.observable],re.prototype,"_isVisible",void 0),(0,r.__decorate)([Z.computed],re.prototype,"isVisible",null),(0,r.__decorate)([Z.observable],re.prototype,"_target",void 0),(0,r.__decorate)([Z.computed],re.prototype,"target",null),(0,r.__decorate)([Z.observable],re.prototype,"showSynonymsState",void 0),(0,r.__decorate)([Z.computed],re.prototype,"showSynonyms",null),(0,r.__decorate)([Z.computed],re.prototype,"brandingMode",null),(0,r.__decorate)([Z.observable],re.prototype,"_suggestionsToRender",void 0),(0,r.__decorate)([Z.computed],re.prototype,"suggestionsToRender",null),(0,r.__decorate)([Z.computed],re.prototype,"noSuggestionLabel",null),(0,r.__decorate)([Z.observable],re.prototype,"navInfo",void 0),(0,r.__decorate)([Z.computed],re.prototype,"calloutTitle",null),(0,r.__decorate)([Z.computed],re.prototype,"text",null),(0,r.__decorate)([Z.computed],re.prototype,"textInContext",null),(0,r.__decorate)([Z.computed],re.prototype,"calloutCategory",null),(0,r.__decorate)([Z.computed],re.prototype,"explanation",null),(0,r.__decorate)([Z.computed],re.prototype,"explanationTitle",null),(0,r.__decorate)([Z.computed],re.prototype,"styles",null),(0,r.__decorate)([Z.computed],re.prototype,"ariaLabelToReadWhenCardIsOpened",null),(0,r.__decorate)([Z.computed],re.prototype,"shouldShowTonalFre",null),(0,r.__decorate)([Z.computed],re.prototype,"settings",null),(0,r.__decorate)([Z.observable],re.prototype,"_gapSpace",void 0),(0,r.__decorate)([Z.computed],re.prototype,"gapSpace",null),(0,r.__decorate)([Z.computed],re.prototype,"critiqueType",null),(0,r.__decorate)([Z.computed],re.prototype,"critiqueSource",null),(0,r.__decorate)([Z.action],re.prototype,"show",void 0),(0,r.__decorate)([Z.action],re.prototype,"setSynonymsState",void 0),(0,r.__decorate)([Z.action],re.prototype,"setIsVisible",void 0),(0,r.__decorate)([Z.action],re.prototype,"hide",void 0),(0,r.__decorate)([Z.action],re.prototype,"onDismiss",void 0),(0,r.__decorate)([Z.action],re.prototype,"afterRender",void 0),(0,r.__decorate)([Z.action],re.prototype,"onCalloutAction",void 0),(0,r.__decorate)([Z.action],re.prototype,"onTonalFreAction",void 0),(0,r.__decorate)([Z.computed],re.prototype,"dropDownActions",null),(0,r.__decorate)([Z.action],re.prototype,"updateShowSynonyms",void 0),(0,r.__decorate)([Z.computed],re.prototype,"addOnFooterData",null),(0,r.__decorate)([Z.action],re.prototype,"setNavInfo",void 0),(0,r.__decorate)([Z.action],re.prototype,"navigate",void 0),(0,r.__decorate)([Z.action],re.prototype,"resetNavigation",void 0),re=(0,r.__decorate)([(0,Y._)(),(0,r.__param)(0,(0,Q.W)(C.K)),(0,r.__param)(1,(0,Q.W)(w.H)),(0,r.__param)(2,(0,Q.W)(k.n)),(0,r.__param)(3,(0,Q.W)(M.s)),(0,r.__param)(4,(0,Q.W)(T.f)),(0,r.__param)(5,(0,Q.W)(x.g)),(0,r.__param)(6,(0,Q.W)(V.$)),(0,r.__param)(7,(0,Q.W)(S.DS)),(0,r.__param)(8,(0,Q.W)(D.w)),(0,r.__param)(9,(0,Q.W)(P.d)),(0,r.__param)(10,(0,Q.W)(c)),(0,r.__param)(10,(0,X.l)()),(0,r.__param)(11,(0,Q.W)(W.$)),(0,r.__param)(12,(0,Q.W)(_.C)),(0,r.__param)(12,(0,X.l)()),(0,r.__param)(13,(0,Q.W)(B.Ey)),(0,r.__param)(13,(0,X.l)()),(0,r.__param)(14,(0,Q.W)(I.c)),(0,r.__param)(15,(0,Q.W)(s.tq)),(0,r.__param)(16,(0,Q.W)(G.JY)),(0,r.__param)(17,(0,Q.W)(N.M)),(0,r.__param)(18,(0,Q.W)(F)),(0,r.__param)(18,(0,X.l)()),(0,r.__param)(19,(0,Q.W)(K.C)),(0,r.__param)(20,(0,X.l)()),(0,r.__param)(20,(0,Q.W)(E.F)),(0,r.__param)(21,(0,X.l)()),(0,r.__param)(21,(0,Q.W)(y.In)),(0,r.__param)(22,(0,X.l)()),(0,r.__param)(22,(0,Q.W)(A.Zp)),(0,r.__param)(23,(0,X.l)()),(0,r.__param)(23,(0,Q.W)(O.y)),(0,r.__param)(24,(0,X.l)()),(0,r.__param)(24,(0,Q.W)(U.j)),(0,r.__param)(25,(0,X.l)()),(0,r.__param)(25,(0,Q.W)($.m))],re)},64510:(e,t,o)=>{"use strict";var i;o.d(t,{u:()=>i}),function(e){e.calloutMain="calloutMain",e.moreActions="moreActions"}(i||(i={}))},96382:(e,t,o)=>{"use strict";o.d(t,{$:()=>b,v:()=>y});var i=o(95734);if(3023==o.j)var n=o(46914);if(3023==o.j)var r=o(91122);if(3023==o.j)var s=o(51451);if(3023==o.j)var a=o(94664);var l=o(97069),c=o(93261),u=o(76706);if(3023==o.j)var d=o(51687);if(3023==o.j)var g=o(12378);if(3023==o.j)var h=o(16441);if(3023==o.j)var p=o(98332);var f=o(26923);if(3023==o.j)var m=o(61953);if(3023==o.j)var v=o(43800);const y=(0,l.F5)({state:c.A.on(u.x)}),b=()=>{const e=i.useContext(f.O1),{state:t}=(0,l.KN)(y),[o,c]=i.useState(!1);i.useEffect((()=>(t.subscribe("visibilityUpdated",c),()=>{t.unsubscribe("visibilityUpdated",c)})),[t]);const{undoAriaLabel:u,undoTitle:b,localizer:S,target:C,styles:w,showEditorBranding:k,gapSpace:T}=t,x=S.getMessage("ebx_settingsButtonTooltip"),_=S.getMessage("ebx_undoCalloutAriaLabel"),I=i.useCallback((()=>{t.applyUndo()}),[t]),E=i.useCallback((()=>{t.openSettings()}),[t]),A=i.useCallback((e=>{t.updateCalloutPosition((null==e?void 0:e.alignmentEdge)===h.x.right,!1)}),[t]),B=(0,v.I)(),R=i.createElement("div",{style:Object.assign({display:"flex",flexDirection:"row",flexWrap:"nowrap"},w.calloutContainer)},i.createElement(s.$,{icon:i.createElement(n.t2R,{style:e?void 0:w.buttonIcon.icon,className:B.icon}),appearance:"subtle",className:`${p.g.undoButton}`,"data-automation-id":"undo-callout-undo-button",key:"Undo",role:"button",style:w.buttonIcon,title:b,"aria-label":u,onClick:I}),i.createElement(s.$,{icon:i.createElement(r.$Dw,{style:e?void 0:w.buttonIcon.icon,className:B.icon}),appearance:"subtle",className:p.g.settingsButton,key:"Settings","data-automation-id":"undo-callout-settings-button",role:"button",style:Object.assign({marginLeft:2},w.buttonIcon),title:x,"aria-label":x,onClick:E}),k&&i.createElement("span",{role:"none presentation","aria-hidden":!0,style:w.logoButtonBase},S.getMessage("ebx_brandText")));if(e){const e={popover:{trapFocus:t.setInitialFocus,withArrow:!1,open:o,ariaLabel:_,ariaRole:"group",positioning:{target:(0,m.ug)(C),align:"center",position:"above",offset:e=>(t.updateCalloutPosition("end"===e.alignment,!0),{mainAxis:T})}},surface:{style:Object.assign({padding:0,background:a.L.colorNeutralBackground1,borderRadius:8},w.calloutV9)}};return i.createElement(g.v,Object.assign({ref:t.undoCardV9Ref},e),R)}return o?i.createElement(d.U,{ref:t.undoCardRef,isBeakVisible:!1,gapSpace:T,target:(0,m.KV)(C),doNotLayer:!0,role:"group",ariaLabel:_,setInitialFocus:t.setInitialFocus,onRestoreFocus:()=>{},onPositioned:A,styles:w.calloutMain},R):i.createElement(i.Fragment,null)}},43800:(e,t,o)=>{"use strict";o.d(t,{I:()=>r});var i=o(78814),n=o(94664);const r=(0,i.n)({icon:{color:n.L.colorNeutralForeground1}})},98332:(e,t,o)=>{"use strict";o.d(t,{f:()=>k,g:()=>w});var i=o(30206),n=o(58943),r=o(61953),s=o(46975),a=o(86336),l=o(59834),c=o(87333),u=o(57767),d=o(76509),g=o(12470),h=o(44074),p=o(71866),f=o(91799),m=o(9218),v=o(1208),y=o(48828),b=o(90424),S=o(30225),C=o(95734);const w={undoButton:"ebx_undoButton",settingsButton:"ebx_settingsButton"};let k=class extends n.z{constructor(e,t,o,i,n,a,l,c,u,d){var g;let h;super(),this.localizer=e,this.hostSettings=t,this.externalSettingsFeature=o,this.logger=i,this.wordDictionary=n,this._ariaStatusStateStore=a,this._featureFlagsReader=l,this.validator=c,this.instrumentationProcessor=u,this.styleDefinitions=d,this._undoCardRef=C.createRef(),this._undoCardV9Ref=C.createRef(),this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._unsignedInEditorFeatureEnabled=!1,this.getTargetRect=()=>{var e,t;if(this.target)return(0,r.Pe)(this.target)?{left:this.target.x,right:this.target.x,top:this.target.y,bottom:this.target.y,width:0,height:0}:(0,r.K2)(this.target)?{left:this.target.left,right:null!==(e=this.target.right)&&void 0!==e?e:0,top:this.target.top,bottom:null!==(t=this.target.bottom)&&void 0!==t?t:0,width:this.target.width,height:this.target.height}:this.target.getBoundingClientRect()},this.executeShowOptionsAction=()=>{this.showOptionsAction&&this.showOptionsAction()},this.setShowOptionsAction=e=>{e&&(this.showOptionsAction=e)},this.notifyAriaStatusChange=(e,t)=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(this.localizer.getMessage(e,t),"assertive")},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:this.critique,eventId:e})},(null===(g=this.externalSettingsFeature)||void 0===g?void 0:g.openSettings)&&(h=()=>{var e;null===(e=this.externalSettingsFeature)||void 0===e||e.openSettings(s.kY.dropdown)}),this.setShowOptionsAction(h)}get undoCardRef(){return this._undoCardRef}get undoCardV9Ref(){return this._undoCardV9Ref}get isVisible(){return this._isVisible}get target(){return this._target}get targetRect(){return this._targetRect||(this._targetRect=this.getTargetRect()),this._targetRect}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:0}get setInitialFocus(){var e;return null!==(e=this._setInitialFocus)&&void 0!==e&&e}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}get mainFocusZoneId(){return"calloutMain--undo"}get undoTitle(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,o=this.localizer.getMessage("ebx_autoCorrectRevertTo",t);return this.validator.validate(o)}get undoAriaLabel(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,o=t.split("").join(" "),i=this.localizer.getMessage("ebx_autoCorrectRevertTo",t),n=this.localizer.getMessage("ebx_undoButtonAriaLabel");return this.validator.validate(`${n}, ${i}, ${o}`)}get showEditorBranding(){return!!this.hostSettings.undoCardShowEditorLogo}get styles(){return this.styleDefinitions.undoCallout}checkShowConditions(e){return!!this.hostSettings.enableAutoCorrect}async prepareShowContent(e){const{onApplySuggestion:t,critique:o,onCalloutPositionUpdated:i}=e;this.critique=o,this.onApplySuggestion=t,this.onCalloutPositionUpdated=i}hide(e){this.isVisible&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isVisible&&(this.resetVariablesAfterHide(),this.onDismiss(e))}resetVariablesAfterHide(){this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._gapSpace=void 0,this.instrumentationEventId=void 0,this.onApplySuggestion=void 0,this.critique=void 0,this.publishEvent("visibilityUpdated",this._isVisible)}onDismiss(e){var t;null===(t=this.onDismissCallback)||void 0===t||t.call(this,e),this.onDismissCallback=void 0}async show(e){if(!this.checkShowConditions(e))return;const{setInitialFocus:t,target:o,onDismiss:i,gapSpace:n}=e;this._target=o,this._gapSpace=n,this._setInitialFocus=t,this.onDismiss(!1),this.onDismissCallback=i,await this.prepareShowContent(e),this._isVisible=!0,this.publishEvent("visibilityUpdated",this._isVisible),this.doAfterShow()}doAfterShow(){this.logUndoCalloutOpened()}logUndoCalloutOpened(){const e=this.logger.getNewActivity(a.n.UndoCalloutShown,l.o.SamplingPolicy.CriticalExperimentation);e&&(e.success=!0,e.endNow())}clickNoActionHide(e){this.isVisible&&this.recordInstrumentationEventId(12),this.hide(e)}applyUndo(){if(this.onApplySuggestion&&this.critique&&this.critique.suggestions.length){const e=this.critique.suggestions[0];this.onApplySuggestion(this.critique,e),this.wordDictionary.addWordToIgnoreList(e.text),this.notifyAriaStatusChange("ebx_autoCorrectIgnored",e.text),this.recordInstrumentationEventId(16)}this.hide()}openSettings(){this.executeShowOptionsAction(),this.hide()}updateCalloutPosition(e,t){var o,i,n;if(this.onCalloutPositionUpdated){const r=t?null===(n=null===(i=this._undoCardV9Ref.current)||void 0===i?void 0:i.getElementRef().current)||void 0===n?void 0:n.firstChild:null===(o=this._undoCardRef.current)||void 0===o?void 0:o.firstChild;if(r){const t=r.getBoundingClientRect();this.onCalloutPositionUpdated(e,t)}}}};k=(0,i.__decorate)([(0,y._)(),(0,i.__param)(0,(0,b.W)(c.H)),(0,i.__param)(1,(0,b.W)(u.n)),(0,i.__param)(2,(0,S.l)()),(0,i.__param)(2,(0,b.W)(s.In)),(0,i.__param)(3,(0,b.W)(d.g)),(0,i.__param)(4,(0,b.W)(v.s)),(0,i.__param)(5,(0,b.W)(p.JY)),(0,i.__param)(6,(0,b.W)(g.c)),(0,i.__param)(7,(0,b.W)(m.$)),(0,i.__param)(8,(0,b.W)(h.f)),(0,i.__param)(9,(0,b.W)(f.$))],k)},95909:(e,t,o)=>{"use strict";o.d(t,{b:()=>f});var i=o(95734),n=o(97069),r=o(93261);if(3023==o.j)var s=o(56928);var a=o(75362),l=o(318),c=o(26923);if(3023==o.j)var u=o(47632);if(3023==o.j)var d=o(14118);const g=e=>{switch(e){case a.Y.critique:return"footer_fre_in_critique_callout";case a.Y.inlineSuggestions:return"footer_fre_in_inline_suggestion_callout";default:return"footer_fre_generic"}},h=()=>{const e=(0,d.$)().getStringsFor("OnCanvasCalloutStrings"),t={nextPageTooltip:e("footerFRE_nextPageTooltip"),paginationTipsText:e("footerFRE_paginationTipsText"),previousPageTooltip:e("footerFRE_previousPageTooltip")};return{footer:e=>t[e]||""}},p=(0,n.F5)({themeStore:r.A.on(c.YQ).optional(),footerFreStore:r.A.on(a.D).optional(),languageScriptDirectionDetector:r.A.on(l.iw).optional()}),f=e=>{const{target:t,styles:o}=e,{footerFreStore:r,languageScriptDirectionDetector:a,themeStore:l}=(0,n.SM)(p),[d,f]=i.useState((()=>null==r?void 0:r.footerProps.get(t)));i.useEffect((()=>{if(!r)return;const e=e=>{const o=e.footerProps.get(t);f(o?Object.assign({},o):void 0)};return r.subscribe("stateUpdated",e),()=>{r.unsubscribe("stateUpdated",e)}}),[r,t]);const[m,v]=i.useState(null==l?void 0:l.getComponentActiveTheme(c.yF.footerFreComponentName,!0));if(i.useEffect((()=>{if(!l)return()=>{};const e=()=>{v(l.getComponentActiveTheme(c.yF.footerFreComponentName,!0))};return l.subscribe("currentThemeUpdated",e),l.subscribe("defaultThemeUpdated",e),l.subscribe("themesUpdated",e),()=>{l.unsubscribe("currentThemeUpdated",e),l.unsubscribe("defaultThemeUpdated",e),l.unsubscribe("themesUpdated",e)}}),[l]),!(null==d?void 0:d.display)||!d.pages.size)return null;const y=i.createElement(s.J,{automationId:g(t),pages:Array.from(d.pages.values()),animated:d.animated,styles:o,strings:h(),theme:m,onDismiss:()=>null==r?void 0:r.setFooterDisplay(t,!1),hideIcon:e.hideIcon});return a?i.createElement(u.K,{rtl:a.isRtl()},y):y}},29e3:(e,t,o)=>{"use strict";o.d(t,{o:()=>s});var i=o(30206),n=o(58943),r=o(48828);let s=class extends n.z{constructor(){super(...arguments),this.footerProps=new Map}publishStateChange(){this.publishEvent("stateUpdated",{footerProps:this.footerProps})}setFooterDisplay(e,t){const o=this.footerProps.get(e);o&&(this.footerProps.set(e,Object.assign(Object.assign({},o),{display:t})),this.publishStateChange())}setFooterAnimated(e,t){const o=this.footerProps.get(e);o&&(this.footerProps.set(e,Object.assign(Object.assign({},o),{animated:t})),this.publishStateChange())}addFooterPage(e,t,o){var i;const n=null!==(i=this.footerProps.get(e))&&void 0!==i?i:{display:!0,pages:new Map,animated:!0};n.pages.set(t,o),n.display=!0,this.footerProps.set(e,n),this.publishStateChange()}removeFooterPage(e,t){const o=this.footerProps.get(e);o&&(o.pages.delete(t),0===o.pages.size&&(o.display=!1),this.footerProps.set(e,o),this.publishStateChange())}};s=(0,i.__decorate)([(0,r._)()],s)},99096:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>d}),3023==o.j)var i=o(51451);var n=o(97069),r=o(93261);if(3023==o.j)var s=o(16278);var a=o(75362),l=o(87333),c=o(95734);const u=(0,n.F5)({localizer:r.A.on(l.H),footerFreStore:r.A.on(a.D)}),d=e=>{var t;const{theme:o,style:r,languageName:l,undoCallback:d,manageLanguagesCallback:g}=e,{localizer:h,footerFreStore:p}=(0,n.KN)(u),f=()=>{p.removeFooterPage(a.Y.languageAutoDetection,s.Id)};return c.createElement("div",{style:Object.assign({color:null!==(t=null==o?void 0:o.textColor)&&void 0!==t?t:"#323130",minWidth:250},r)},c.createElement("div",{style:{marginBottom:12,paddingRight:14}},h.getMessage("autoDetectionFRE_HeadingText",l)),c.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},c.createElement(i.$,{appearance:"transparent",style:{fontSize:12,padding:2,minWidth:"fit-content",height:"revert",minHeight:24},onClick:()=>{d(),f()}},h.getMessage("autoDetectionFRE_UndoButtonText",l)),c.createElement(i.$,{style:{borderRadius:4,marginLeft:8,fontSize:12,height:"fit-content",minHeight:24,textAlign:"left",paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2},onClick:()=>{g(),f()}},h.getMessage("autoDetectionFRE_ManageLanguagesText",l))))}},16278:(e,t,o)=>{"use strict";o.d(t,{Id:()=>m,lP:()=>v,sy:()=>y});var i=o(97069),n=o(93261);if(3023==o.j)var r=o(60351);var s=o(75362);if(3023==o.j)var a=o(51687);if(3023==o.j)var l=o(12378);if(3023==o.j)var c=o(55287);if(3023==o.j)var u=o(61953);if(3023==o.j)var d=o(95909);var g=o(26923);if(3023==o.j)var h=o(63503);var p=o(95734);const f=(0,i.F5)({footerFreStore:n.A.on(s.D)}),m="LanguageAutoDetection",v="lang-auto-detect-footer",y=()=>{const{footerFreStore:e}=(0,i.KN)(f),[t,o]=p.useState((()=>e.footerProps.get(s.Y.languageAutoDetection)));return p.useEffect((()=>{const t=e=>{const t=e.footerProps.get(s.Y.languageAutoDetection);o(t?Object.assign({},t):void 0)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),(null==t?void 0:t.display)&&1===t.pages.size?p.createElement(b,null):null},b=()=>{var e,t;const o=p.useContext(g.O1),i=null!==(e=(0,h.ZY)())&&void 0!==e?e:document,n=null!==(t=i.defaultView)&&void 0!==t?t:window,[f,m]=p.useState(S(i)),[y,b]=p.useState(!0),C=p.useCallback((()=>{m(S(i))}),[i,m]);if(p.useEffect((()=>{const e=new c.J(n);return e.addListener("resize",C,{passive:!0,capture:!0}),()=>{e.removeAllListeners()}}),[C,n]),o){const e={popover:{id:v,withArrow:!1,open:y,onOpenChange:(e,t)=>{b(t.open)},positioning:{target:(0,u.ug)(f),align:"center",position:"above",offset:e=>({mainAxis:8})}},surface:{style:{padding:0,background:"transparent",borderRadius:8}}};return p.createElement(l.v,Object.assign({},e),p.createElement(d.b,{target:s.Y.languageAutoDetection}))}return p.createElement(a.U,{id:v,target:f,directionalHint:r.A.topCenter,isBeakVisible:!1,gapSpace:8,style:{borderRadius:8},styles:{root:{borderRadius:8},calloutMain:{background:"transparent"}}},p.createElement(d.b,{target:s.Y.languageAutoDetection}))};function S(e){return{x:e.body.clientWidth-240,y:e.body.clientHeight-13}}},53864:(e,t,o)=>{"use strict";o.d(t,{Nt:()=>l,cu:()=>c});var i=o(49942),n=o(89810),r=o(19454),s=o(95734),a=o(38883);function l(e,t,o){return new d(e,t,o)}function c(e,t){const o=new u(e);return{element:s.createElement(g,{eccUxReplacement:o,commonOptions:t}),eccUxReplacement:o}}class u{constructor(e){this.iframeElement=e,this.eccStateChanged=e=>{var t;null===(t=this.listener)||void 0===t||t.call(this,e)},this.setListener=e=>{this.listener=e}}dispose(){this.listener&&(this.listener(void 0),this.listener=void 0)}}class d extends u{constructor(e,t,o){super(t),this.editorCard=document.createElement("external-editor-card"),this.editorCard.setAttribute("style","position:absolute;top:0px;left:0px;z-index:auto;display: block !important"),e.appendChild(this.editorCard),a.render(s.createElement(g,{eccUxReplacement:this,commonOptions:o}),this.editorCard)}dispose(){this.editorCard&&(a.unmountComponentAtNode(this.editorCard),this.editorCard.remove(),this.editorCard=void 0),super.dispose()}}const g=e=>{var t;const{iframeElement:o,setListener:a}=e.eccUxReplacement,[l,c]=s.useState(),u=s.useCallback((e=>{c(e)}),[c]);if(s.useEffect((()=>(a(u),()=>{a(void 0)})),[u,a]),!l)return null;const d=function(e,t){var o,i;if(!e||!t||"string"==typeof t)return t;let n=e.getBoundingClientRect();const r=getComputedStyle(e),s=parseFloat(r.borderWidth.replace("px",""));return n=new DOMRect(n.left+s,n.top+s,n.width-s-s,n.height-s-s),"left"in t&&"top"in t&&t.left&&t.top?"width"in t&&"height"in t?{left:t.left+n.left,right:t.left+n.left+t.width,top:t.top+n.top,bottom:t.top+n.top+t.height,width:t.width,height:t.height}:{x:(null!==(o=t.left)&&void 0!==o?o:0)+n.left,y:(null!==(i=t.top)&&void 0!==i?i:0)+n.top}:"x"in t&&"y"in t?{x:t.x+n.left,y:t.y+n.top}:t}(o,l.targetLocation);return d?s.createElement(n.O.Provider,{value:!!(null===(t=e.commonOptions)||void 0===t?void 0:t.useFluentV9)},s.createElement("div",{dir:l.calloutProps.isRtl?"rtl":"ltr",style:{all:"initial"}},s.createElement(i.$,Object.assign({},l,{targetWindow:new r.O(window),targetLocation:d,isMobile:!1,isRtl:l.calloutProps.isRtl})))):null}},28816:(e,t,o)=>{"use strict";o.d(t,{V:()=>k});var i=o(95734);if(3023==o.j)var n=o(91519);if(3023==o.j)var r=o(55287);if(3023==o.j)var s=o(30021);if(3023==o.j)var a=o(51732);if(3023==o.j)var l=o(92700);if(3023==o.j)var c=o(95909);if(3023==o.j)var u=o(94292);if(3023==o.j)var d=o(22306);if(3023==o.j)var g=o(36340);if(3023==o.j)var h=o(30528);if(3023==o.j)var p=o(59531);if(3023==o.j)var f=o(75362);if(3023==o.j)var m=o(89810);if(3023==o.j)var v=o(33362);if(3023==o.j)var y=o(98099);if(3023==o.j)var b=o(98904);if(3023==o.j)var S=o(90875);function C(e,t,o){var i;return o?o.message:null!==(i=null==e?void 0:e.customizedEmptyECCSuggestionsString)&&void 0!==i?i:t("suggestionsGroupNoSuggestionsText")}function w(e,t,o,i){const n={clearSearchLabel:t("clearSearchLabel"),showAvailableSuggestionsLabel:t("showAvailableSuggestionsLabel"),somethingWentWrongLabel:t("somethingWentWrongLabel"),tryAgainLabel:t("tryAgainLabel"),suggestionsGroupSearchResultAccessibilityLabel:t("suggestionsGroupSearchResultAccessibilityLabel"),combineSentences:t("combineSentences"),newTagText:t("newTagText"),discoveryPromoFooterText:t("discoveryPromoFooterText"),emailSentBy:t("emailSentBy"),feedbackText:t("feedbackText"),meetingSeries:t("meetingSeries"),recordText:t("recordText"),tabAriaLabel:t("allTabAriaLabel"),overflowTabAriaLabel:t("overflowTabAriaLabel"),expandedInlineSuggestionsSearchBarPlaceholder:t("expandedInlineSuggestionsSearchBarPlaceholder"),startTypingToSearch:t("startTypingToSearch")},r={ignoreAll:o("ebx_ignoreAllButtonLabel"),ignoreOnce:o("ebx_ignoreOnceButtonLabel"),ignoreRule:o("ebx_disableCritiqueButton"),options:o("ebx_changeSettingsCommandLabel"),giveFeedbackButtonText:o("ebx_giveFeedback"),editorButtonTooltipContent:o("ebx_settingsButtonTooltip"),editorButtonText:o("editorButtonText"),footerSeeMoreActionsAccessibilityLabel:o("ebx_moreButtonArialLabel")},s={suggestionsGroupNoSuggestionsText:C(e,t,i)};return Object.assign(Object.assign({},function(){const e=Array(),t={};for(const o of e)t[o]=e=>"";return t}()),{inlineSuggestions:e=>n[e]||"",common:e=>s[e]||"",critique:e=>r[e]||""})}const k=e=>{var t,o,y,C,k,x,_,I,E,A,B,R,M,D,P,N,F,O;const j=i.useContext(m.O),{calloutProps:q,layerHostId:L,isRtl:H,styles:z}=e,{calloutStrings:W,currentScope:G,enableExpandedECC:U,enableScopedHeader:V,expandedEccSearchBarConfig:$,getLocale:K,expandedECCHeader:J,inlineSuggestionsStrings:Z,isDividerShown:Y,isFeedbackEnabled:Q,isFeedbackButtonEnabled:X,onFeedbackButtonClicked:ee,isFlightEnabled:te,isLoading:oe,oaSettings:ie,onGroupSelected:ne,onItemSelected:re,onProcessedResults:se,onUserInteraction:ae,resultReset:le,suggestions:ce,style:ue,theme:de,handleKeyDown:ge,triggerMethod:he,appGptConfig:pe,unsupportedEntities:fe,removeComposingBoxQuery:me}=q,ve=q.searchBoxQueryString.length>0?q.searchBoxQueryString:q.queryString,ye=null==fe?void 0:fe.find((e=>e.entityType===(null==G?void 0:G.entityType))),be=null===(t=null==ie?void 0:ie.bestMatchConfig)||void 0===t?void 0:t.enabled,Se=null==ie?void 0:ie.enablePrefixHighlighting,Ce=new Map,we=i.useRef([]),ke=[],Te=i.useRef(J),[xe,_e]=i.useState(null);U&&(Te.current=Te.current.map((e=>{var t,o,i;return Object.assign(Object.assign({},e),{isSelected:!(null==G?void 0:G.entityType)&&!(null===(t=e.scopeInfo)||void 0===t?void 0:t.entityType)||(null==G?void 0:G.entityType)===(null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType)||!G&&e.isSelected&&1===(null===(i=null==ie?void 0:ie.entitiesEnabled)||void 0===i?void 0:i.length)})})),Te.current.length&&!Te.current.some((e=>e.isSelected))&&(Te.current=[Object.assign(Object.assign({},Te.current[0]),{isSelected:!0}),...Te.current.slice(1)]));let Ie=!1;if(!oe){const e=ce.slice().sort(((e,t)=>{var o,i;return(null!==(o=e.priority)&&void 0!==o?o:0)-(null!==(i=t.priority)&&void 0!==i?i:0)}));let t;for(const i of e)for(const[,r]of i.entities.entries()){Ie=Ie||r.entityType===n.c.PIM;const s=be&&r.isBestMatch,a=s?"":null!==(o=i.groupTitle)&&void 0!==o?o:r.entityType===n.c.PIM?(0,u.X)(r.type,r.IntentId):(0,u.X)(r.type);if(r.icon&&(r.icon.iconName=(0,d.S)(r.icon.iconName)),r.entityType===n.c.People&&T(r,H),r.entityType===n.c.Scope&&(null===(y=r.scopeInfo)||void 0===y?void 0:y.entityType)&&r.scopeInfo.entityType!==n.c.External&&(r.title=(0,u.X)(r.scopeInfo.entityType)),Se&&!r.hitHighlightIndexes){const e=r[null!==(C=r.titleHitHighlightProperty)&&void 0!==C?C:"title"],t=r[null!==(k=r.subtitleHitHighlightProperty)&&void 0!==k?k:"subtitle"];r.hitHighlightIndexes=(0,g.J)([ve],e,"title").concat(t?(0,g.J)([ve],t,"subTitle"):[])}let l=Ce.get(a);if(!l)if(l=Object.assign(Object.assign(Object.assign({title:a,subtitle:i.groupSubtitle,suggestions:[]},(null==G?void 0:G.entityType)===e[0].entityType&&{isScoped:!0}),r.entityType===n.c.Scope&&{isScopingEnabled:!1,showSeparator:!0}),Y&&{showSeparator:!0}),Ce.set(a,l),s)ke.unshift(l);else if(i.entityType===n.c.Scope)t=l;else{if(G&&G.entityType!==i.entityType)continue;if(!G&&(null==fe?void 0:fe.some((e=>e.entityType===i.entityType))))continue;ke.push(l)}l.suggestions.push(r)}if(t&&ke.push(t),null==ie?void 0:ie.preventAllTabBackfill){const e=!G,t=(null===(x=ke[0])||void 0===x?void 0:x.suggestions.length)>0;U&&e&&t&&ke.splice(1)}(null==ie?void 0:ie.gptResultsLengthCap)&&"App"===(null===(_=ke[0])||void 0===_?void 0:_.title)&&(null===(I=ke[0])||void 0===I||I.suggestions.splice(ie.gptResultsLengthCap)),ke.length&&(ke[0].showSeparator=!1),se()}const Ee=i.useCallback((()=>{ae()}),[ae]),Ae=i.useCallback((e=>{if(xe){if($&&he!==h.P.AttachFile&&he!==h.P.Fre){const t=xe.querySelectorAll("input[type=search]")[0];0===(null==t?void 0:t.value.length)&&e.target===t&&setTimeout((()=>{t.value=ve||""}),100)}if(!U&&(0,p.m)(e.target)&&"BUTTON"!==e.target.nodeName&&"INPUT"!==e.target.nodeName){e.preventDefault();const t=e.relatedTarget;null==t||t.focus()}}}),[xe,U,$,ve,he]),[Be,Re]=i.useState(!1),[Me,De]=i.useState(!1),Pe=i.useRef(!0);i.useEffect((()=>{if(!xe)return;const e=xe.ownerDocument,t=xe.querySelectorAll("input[type=search]")[0],o=e.querySelectorAll('[data-ms-editor="true"]')[0];$&&t&&(he===h.P.AttachFile||o&&e.activeElement===o)&&Pe.current&&(Pe.current=!1,he===h.P.AttachFile||he===h.P.Fre?null==me||me(""!==ve):t.setAttribute("placeholder",""!==ve?ve:Z("expandedInlineSuggestionsSearchBarPlaceholder")))}),[xe,$,Z,ve,me,he]),i.useEffect((()=>{var e;if(!xe)return;const t=null!==(e=xe.ownerDocument.defaultView)&&void 0!==e?e:window;function o(){Re(t.matchMedia("(max-width: 480px)").matches),De(t.matchMedia("(max-height: 480px)").matches)}o();const i=new r.J(t);i.addListener("resize",o);const n=xe.closest(".ms-ecc-callout"),s=n&&new r.J(n);return null==s||s.addListener("keydown",ge),()=>{i.removeAllListeners(),null==s||s.removeAllListeners()}}),[xe,ge]);const Ne=te("mc-editor-expanded-ecc-responsive"),Fe=te("mc-editor-enable-meeting-banner");(le||!oe||ke.length)&&(we.current=V?(0,S.k)(ke):ke);const Oe=Z("managePersonalInfoLinkText"),je=Z("managePersonalInfoLinkUrl"),qe=Z("meetingBannerText"),Le=null!==(E=null==K?void 0:K())&&void 0!==E?E:"en-US",He={results:we.current,queryString:ve,onItemSelected:re,onGroupSelected:ne,theme:de,style:ue,styles:z,isError:q.isError,strings:w(ie,Z,W,ye),onAction:q.onAction,isLoading:q.isLoading,keyboardHandlerTarget:U?void 0:q.keyboardHandlerTarget,expandedKeyboardHandlerTarget:U?q.keyboardHandlerTarget:void 0,menuType:q.menuType,onFooterAction:q.onFooterAction,enablePrefixHighlighting:Se,showMoreEntitiesConfig:q.showMoreEntitiesConfig,browseThisComputerConfig:q.browseThisComputerConfig,layerHostId:L,showDiscoveryPromoFooter:null==ie?void 0:ie.enableDiscoveryPromoFooter,noSuggestionsHeaderInfo:q.noSuggestionsHeaderInfo,locale:Le,appGptConfig:pe,enableMeetingBanner:Fe,showMeetingBanner:Fe&&(null==G?void 0:G.entityType)===n.c.Event,meetingBannerText:qe,isUnsupported:!!ye},ze=i.useMemo((()=>(0,v.jI)()?"rtl":"ltr"),[]),We=(0,b.Z)(q.menuParentElement,null!==(A=q.enableExpandedECC)&&void 0!==A&&A,q.accessibilitySettings);return i.createElement("div",{ref:_e,onMouseEnter:Ee,onFocus:Ae},U?i.createElement(l.q,{theme:q.fluentTheme,dir:ze},i.createElement(s._,Object.assign({},He,{scopes:{title:"",isScopingEnabled:!1,suggestions:Te.current},useFURNTabList:j,onItemFocused:We,disableTooltips:!0,isFeedbackEnabledForEcc:Q,isFeedbackButtonEnabled:X,onFeedbackButtonClicked:ee,enableResponsiveLayout:Ne,isSmallWindow:Ne&&Be,isSmallHeight:Ne&&Me,expandedEccSearchBarConfig:$}))):i.createElement(a.x,Object.assign({},He,{onFocus:We,enableScopedHeader:V,disableTooltips:null==ie?void 0:ie.disableInlineSuggestionTooltips})),Ie?i.createElement("div",{style:{height:"32px",padding:"4px 12px"}},i.createElement("a",{href:je,target:"_blank",rel:"noreferrer","aria-label":Oe,style:{textDecoration:"unset",color:"#0078D4",fontSize:12,lineHeight:"16px"}},Oe)):null,i.createElement(c.b,{target:f.Y.inlineSuggestions,styles:{container:{borderRadius:{topStart:0,topEnd:0,bottomStart:null!==(R=null===(B=null==z?void 0:z.containerStyles)||void 0===B?void 0:B.borderRadius)&&void 0!==R?R:8,bottomEnd:null!==(D=null===(M=null==z?void 0:z.containerStyles)||void 0===M?void 0:M.borderRadius)&&void 0!==D?D:8},minWidth:null!==(N=null===(P=null==z?void 0:z.containerStyles)||void 0===P?void 0:P.minWidth)&&void 0!==N?N:300,maxWidth:null!==(O=null===(F=null==z?void 0:z.containerStyles)||void 0===F?void 0:F.maxWidth)&&void 0!==O?O:420}}}))};function T(e,t){e.initials=(0,y.I)(e.displayName,t)}},62784:(e,t,o)=>{"use strict";o.d(t,{b:()=>d});var i=o(97069),n=o(93261),r=o(57767),s=o(318),a=o(30528);if(3023==o.j)var l=o(49942);var c=o(95734);const u=(0,i.F5)({hostSettings:n.A.on(r.n),inlineSuggestionsRenderer:n.A.on(a.V),languageScriptDirectionDetector:n.A.on(s.iw).optional()}),d=()=>{var e,t,o,n,r;const{hostSettings:s,inlineSuggestionsRenderer:a,languageScriptDirectionDetector:d}=(0,i.KN)(u),[g,h]=c.useState(null!==(e=a.getCalloutStateStore().getCalloutState())&&void 0!==e?e:null);return c.useEffect((()=>{const e=a.getCalloutStateStore(),t=()=>{var t;h(null!==(t=e.getCalloutState())&&void 0!==t?t:null)};return e.subscribe("menuUpdated",t),()=>{e.unsubscribe("menuUpdated",t)}}),[a]),(null==g?void 0:g.targetLocation)?c.createElement(l.$,Object.assign({},g,{isRtl:null!==(t=null==d?void 0:d.isRtl())&&void 0!==t&&t,isMobile:null!==(r=null===(n=null===(o=s.oaSettings)||void 0===o?void 0:o.enableECCForMobileDevice)||void 0===n?void 0:n.enabled)&&void 0!==r&&r})):null}},49942:(e,t,o)=>{"use strict";if(o.d(t,{$:()=>g}),3023==o.j)var i=o(30206);var n=o(95734);if(3023==o.j)var r=o(51687);if(3023==o.j)var s=o(12378);if(3023==o.j)var a=o(28816);if(3023==o.j)var l=o(48507);if(3023==o.j)var c=o(74774);var u=o(26923);if(3023==o.j)var d=o(61953);const g=e=>{var t,o,g,h,p,f,m,v,y,b,S,C,w,k,T,x,_;const I=n.useContext(u.O1),{maxHeightCallback:E,targetLocation:A,isMobile:B}=e,{isLoading:R,isFlightEnabled:M,onDismissed:D,onFirstRender:P,onPreventDismissOnEvent:N,onRenderResults:F,onRestoreFocus:O,style:j,styles:q,theme:L}=e.calloutProps;let H=!0;const[z,W]=n.useState(!0);n.useEffect((()=>{P()}),[P]),n.useEffect((()=>{R||F()}),[R,F]);const G=n.useCallback((e=>{e&&"key"in e&&l.x.isKey(e,c.m.escape)&&(e.preventDefault(),e.stopPropagation()),e&&"focus"===e.type&&(H=!1),D(!1)}),[D]),U=n.useCallback((e=>{H&&O(e,(()=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()}))}),[O,H]),V=q||{},{calloutStyles:$}=V,K=(0,i.__rest)(V,["calloutStyles"]),J=K.containerStyles||{},Z=M("mc-editor-expanded-ecc-responsive"),Y=null!==(h=null!==(o=null===(t=null==q?void 0:q.calloutStyles)||void 0===t?void 0:t.borderRadius)&&void 0!==o?o:null===(g=null==L?void 0:L.callout)||void 0===g?void 0:g.borderRadius)&&void 0!==h?h:8;if(!e.targetLocation)return null;const Q=null==E?void 0:E(e.targetLocation,null!==(p=e.targetWindow.deref())&&void 0!==p?p:window),X=null===(f=e.directionalHintCallback)||void 0===f?void 0:f.call(e,e.targetLocation,null!==(m=e.targetWindow.deref())&&void 0!==m?m:window,Q);let ee,te="absolute";if(B&&(te="fixed",ee=!0),I){const t=Z?{borderRadius:Y,width:"fit-content"}:Object.assign({borderRadius:Y,width:null===(w=null==L?void 0:L.callout)||void 0===w?void 0:w.width},$),o={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!1,withArrow:null!==(T=null===(k=null==L?void 0:L.callout)||void 0===k?void 0:k.isBeakVisible)&&void 0!==T&&T,open:z,onOpenChange:(e,t)=>{!t.open&&(null==N?void 0:N(e))||(W(t.open),t.open||G())},positioning:Object.assign(Object.assign({},(0,d.Sg)(X)),{target:(0,d.ug)(A),strategy:te,autoSize:ee})},surface:{className:"ms-ecc-callout",style:Object.assign({padding:0,maxWidth:480,maxHeight:Q,overflow:"hidden",border:null===(x=null==L?void 0:L.callout)||void 0===x?void 0:x.border,boxShadow:null===(_=null==L?void 0:L.callout)||void 0===_?void 0:_.shadow},t)}};return n.createElement(s.v,Object.assign({},o),n.createElement(a.V,{calloutProps:e.calloutProps,isRtl:e.isRtl,styles:(null==j?void 0:j.fitToContent)||J.maxHeight?Object.assign(Object.assign({},K),{containerStyles:Object.assign(Object.assign({},J),{maxHeight:Q})}):K}))}return n.createElement(r.U,{className:"ms-ecc-callout",target:(0,d.KV)(A),shouldDismissOnWindowFocus:!1,onDismiss:G,preventDismissOnEvent:N,gapSpace:0,doNotLayer:!1,isBeakVisible:null!==(y=null===(v=null==L?void 0:L.callout)||void 0===v?void 0:v.isBeakVisible)&&void 0!==y&&y,directionalHint:X,alignTargetEdge:!0,onRestoreFocus:U,calloutMaxHeight:Q,style:Z?{borderRadius:Y,width:"fit-content"}:Object.assign({borderRadius:Y,width:null===(b=null==L?void 0:L.callout)||void 0===b?void 0:b.width},$),styles:{beakCurtain:{borderRadius:Y},calloutMain:{overflow:"hidden",border:null===(S=null==L?void 0:L.callout)||void 0===S?void 0:S.border,borderRadius:Y,boxShadow:null===(C=null==L?void 0:L.callout)||void 0===C?void 0:C.shadow},root:{borderRadius:Y,width:"fit-content",maxHeight:"none !important"}}},n.createElement(r.d.Consumer,null,(t=>n.createElement(a.V,{calloutProps:e.calloutProps,isRtl:e.isRtl,styles:(null==j?void 0:j.fitToContent)||J.maxHeight?Object.assign(Object.assign({},K),{containerStyles:Object.assign(Object.assign({},J),{maxHeight:Q})}):K,layerHostId:t}))))}},98904:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var i=o(95734);if(3023==o.j)var n=o(91519);if(3023==o.j)var r=o(3998);if(3023==o.j)var s=o(25808);const a=(e,t,o)=>{const a=i.useRef(),l=i.useRef(),c=i.useRef(new r.c({enableClearingOfRequestedAnimationFrames:!0})),u=i.useCallback((()=>{a.current&&(a.current.remove(),a.current=void 0),l.current?(l.current.removeAttribute("aria-activedescendant"),l.current.removeAttribute("aria-controls"),l.current.removeAttribute("aria-owns"),l.current=void 0):(null==e||e.removeAttribute("aria-activedescendant"),null==e||e.removeAttribute("aria-controls"),null==e||e.removeAttribute("aria-owns"))}),[e]),d=i.useCallback(((e,t)=>{c.current.requestAnimationFrame((()=>{var i,n;const r=e.getRootNode(),l=e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`);if(!(null==l?void 0:l.ariaLabel)||!(0,s.C)(r,"ShadowRoot"))return;if(null==o?void 0:o.enableExpandedECCAccessibilityElement){if(a.current)a.current.removeAttribute("aria-label"),a.current.removeAttribute("role");else{a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listBox");const t=e.ownerDocument.querySelector("#inlineSuggestionsEnclosingDiv");a.current.setAttribute("aria-label",(null==t?void 0:t.getAttribute("aria-label"))||"")}a.current.style.cssText="width: 0; height: 0; overflow: hidden;"}a.current||(a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listbox"),a.current.style.cssText="width: 0; height: 0; overflow: hidden;");const c=e.ownerDocument.createElement("button");(null==o?void 0:o.enableExpandedECCAccessibilityElement)?(c.setAttribute("role",l.getAttribute("role")||"option"),c.setAttribute("type",l.getAttribute("type")||"button"),c.id=t.focusedItemHtmlId,c.innerText=l.ariaLabel,c.ariaLabel=l.ariaLabel,l.id.includes("header")||l.id.includes("overflow")?(a.current.setAttribute("aria-label","tablist"),c.ariaPosInSet=String(Number(l.id.substring(l.id.length-1,l.id.length))+1),c.ariaSetSize=String(null===(n=null===(i=l.parentElement)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.children.length),c.ariaSelected=l.getAttribute("aria-selected")):(c.ariaPosInSet=l.ariaPosInSet,c.ariaSetSize=l.ariaSetSize,c.ariaSelected="true")):(c.setAttribute("role","option"),c.setAttribute("type","button"),c.id=t.focusedItemHtmlId,c.innerText=l.ariaLabel,c.ariaLabel=l.ariaLabel,c.ariaPosInSet=l.ariaPosInSet,c.ariaSetSize=l.ariaSetSize,c.ariaSelected="true"),a.current.children.length&&a.current.children[0].remove(),a.current.appendChild(c),r.appendChild(a.current)}))}),[null==o?void 0:o.enableExpandedECCAccessibilityElement]),g=i.useCallback((t=>{c.current.requestAnimationFrame((()=>{var o;const i=null==e?void 0:e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`),r=(null===(o=t.selection)||void 0===o?void 0:o.type)===n.c.Scope.toLowerCase();i&&r&&(t.selection&&"scope"in t.selection&&t.selection.scope.isSelected?i.ariaSelected="true":i.ariaSelected="false")}))}),[e]),h=i.useCallback((i=>{if(i.focusedItemHtmlId){if(!e)return;t&&g(i),(null==o?void 0:o.enableDetachedAccessibilityElementForEcc)&&d(e,i),e.setAttribute("aria-activedescendant",i.focusedItemHtmlId),e.setAttribute("aria-controls",i.focusedItemHtmlId),e.setAttribute("aria-owns",i.focusedItemHtmlId),l.current=e}else u()}),[o,t,d,g,e,u]);return i.useEffect((()=>()=>{u()}),[u]),h}},86390:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>l}),3023==o.j)var i=o(29e3);if(3023==o.j)var n=o(75362);if(3023==o.j)var r=o(18230);if(3023==o.j)var s=o(1240);if(3023==o.j)var a=o(22411);class l{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918212)}configureRootServices(e){e.bind(n.D).to(i.o),e.bind(r.j).to(s.S)}}},10583:(e,t,o)=>{"use strict";if(o.d(t,{Q:()=>l}),3023==o.j)var i=o(19955);if(3023==o.j)var n=o(62784);if(3023==o.j)var r=o(34659);if(3023==o.j)var s=o(34139);if(3023==o.j)var a=o(22411);class l{constructor(){this.imports=[r.N,s.h]}get uniqueId(){return(0,a.z)(507918216)}configureRootServices(e){e.bind(i.i).toValue(n.b)}}},62389:(e,t,o)=>{"use strict";o.d(t,{R:()=>d});var i=o(97069),n=o(93261),r=o(18230),s=o(35612),a=o(87333);if(3023==o.j)var l=o(92858);var c=o(95734);const u=(0,i.F5)({multilingualStore:n.A.on(r.j),critiqueCalloutStateStore:n.A.on(s.v),localizer:n.A.on(a.H)}),d=e=>{var t;const{theme:o,style:n}=e,{critiqueCalloutStateStore:r,multilingualStore:s,localizer:a}=(0,i.KN)(u);return c.createElement("div",{style:Object.assign({color:null!==(t=null==o?void 0:o.textColor)&&void 0!==t?t:"#323130"},n)},c.createElement("div",{style:{marginBottom:8}},c.createElement("b",null,a.getMessage("multilingualFRE_HeadingText"))),a.getMessage("multilingualFRE_DescriptionText")," ",c.createElement("br",null),c.createElement(l.N,{style:{fontSize:12},onClick:()=>{r.hide(),s.showEditorSettings()},"aria-label":a.getMessage("multilingualFRE_DescriptionButtonLinkAriaLabel"),"data-is-focusable":!0},a.getMessage("multilingualFRE_DescriptionButtonLink")))}},1240:(e,t,o)=>{"use strict";o.d(t,{S:()=>u});var i=o(30206),n=o(95734),r=o(75362),s=o(62389),a=o(48828),l=o(90424);const c="multilingualProofingFre";let u=class{constructor(e){this.footerFreStore=e}addMultilingualProofingFre(){this.footerFreStore.addFooterPage(r.Y.critique,c,{icon:"LocaleLanguage",content:(e,t)=>n.createElement(s.R,{style:e,theme:t})})}removeMultilingualProofingFre(){this.footerFreStore.removeFooterPage(r.Y.critique,c)}setOnShowEditorSettings(e){this._onShowEditorSettings=e}showEditorSettings(){this._onShowEditorSettings&&this._onShowEditorSettings(!0)}};u=(0,i.__decorate)([(0,a._)(),(0,i.__param)(0,(0,l.W)(r.D))],u)},69691:(e,t,o)=>{"use strict";o.d(t,{a:()=>y});var i=o(95734),n=o(97069),r=o(93261);if(3023==o.j)var s=o(60351);if(3023==o.j)var a=o(22306);if(3023==o.j)var l=o(51687);if(3023==o.j)var c=o(12378);if(3023==o.j)var u=o(55287);if(3023==o.j)var d=o(61953);var g=o(26923);if(3023==o.j)var h=o(36865);if(3023==o.j)var p=o(48507);if(3023==o.j)var f=o(74774);if(3023==o.j)var m=o(94664);const v=(0,n.F5)({styleStore:r.A.on(g.UC).optional(),themeStore:r.A.on(g.YQ).optional()}),y=e=>{var t,o,r,y,b,S,C,w,k,T,x;const _=i.useContext(g.O1),{styleStore:I,themeStore:E}=(0,n.KN)(v),{nudge:A,nudgeDisplayLocation:B,nudgeTargetDocumentRef:R,onAcceptNudgeAction:M,onHideNudge:D,inlineNudge:P,insertionCharacter:N}=e,F=null!==(o=null===(t=R.deref())||void 0===t?void 0:t.defaultView)&&void 0!==o?o:window,[O,j]=i.useState(null==E?void 0:E.getComponentActiveTheme(P?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName));i.useEffect((()=>{if(!E)return()=>{};const e=()=>{j(E.getComponentActiveTheme(P?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName))};return E.subscribe("currentThemeUpdated",e),E.subscribe("defaultThemeUpdated",e),E.subscribe("themesUpdated",e),()=>{E.unsubscribe("currentThemeUpdated",e),E.unsubscribe("defaultThemeUpdated",e),E.unsubscribe("themesUpdated",e)}}),[P,E]);const[q,L]=i.useState(!1),[H,z]=i.useState(!0),W=i.useRef(void 0),G=i.useCallback((e=>{F.clearTimeout(W.current),W.current=e}),[F]),U=i.useCallback(((e,t)=>{F.clearTimeout(W.current),D(e,t)}),[D,F]),V=i.useCallback((()=>{F.clearTimeout(W.current),L(!0)}),[L,F]),$=i.useCallback((()=>{G(F.setTimeout((()=>{U("timeout 5000")}),5e3)),L(!1)}),[U,G,F]),K=i.useCallback((()=>M("click",!0)),[M]);i.useEffect((()=>(G(F.setTimeout((()=>{U("timeout 5000")}),5e3)),()=>{F.clearTimeout(W.current)})),[]);const J=i.useCallback((e=>{p.x.isKey(e,f.m.escape)?(e.stopPropagation(),e.preventDefault(),U(e.key)):p.x.isKey(e,f.m.enter)||p.x.isKey(e,f.m.backspace)?U(e.key):p.x.isKey(e,"v",void 0,!0)?U("user pasted text",!0):(p.x.isKey(e,f.m.tab)||e.key===N)&&(e.stopPropagation(),e.preventDefault(),M(e.key,!0))}),[U,N,M]),Z=i.useCallback((()=>{U("MouseDown")}),[U]),Y=i.useCallback((()=>{U("Scroll")}),[U]),Q=i.useCallback((()=>{U("Resize")}),[U]);i.useEffect((()=>{const e=new u.J(R),t=new u.J(F);return e.addListener("keydown",J,{capture:!0}),e.addListener("mouseup",Z),t.addListener("resize",Q),t.addListener("scroll",Y,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[J,Z,Y,Q,R,F]);const X=null==I?void 0:I.getComponentStyle(P?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName),ee=_?function(e){return e?{background:{resting:m.L.colorNeutralBackground5,hover:m.L.colorNeutralBackground5Hover},text:{resting:m.L.colorNeutralForeground3}}:{background:{resting:m.L.colorNeutralBackground1,hover:m.L.colorNeutralBackground1Hover},text:{resting:m.L.colorNeutralForeground1},highlight:{text:{resting:m.L.colorNeutralForeground1},background:{resting:m.L.colorNeutralBackground3,hover:m.L.colorNeutralBackground3Hover}}}}(P):O,te=A.entityResults?(0,a.S)(null!==(y=null===(r=A.entityResults.entities[0].icon)||void 0===r?void 0:r.iconName)&&void 0!==y?y:""):void 0,oe=null!==(b=null==X?void 0:X.borderRadius)&&void 0!==b?b:P?4:15,ie=null!==(S=null==X?void 0:X.fontSize)&&void 0!==S?S:"10pt",ne=null==X?void 0:X.fontWeight,re=null!==(C=null==X?void 0:X.paddingTop)&&void 0!==C?C:2,se=null!==(w=null==X?void 0:X.paddingBottom)&&void 0!==w?w:2,ae=null!==(k=null==X?void 0:X.paddingLeftRight)&&void 0!==k?k:8,le=null==X?void 0:X.lineHeight,ce=P?s.A.rightTopEdge:s.A.bottomCenter,ue=P?"none":null==X?void 0:X.boxShadow,de=A.text.split(/(@|\/)/g),ge=P?{align:"center",position:"after",offset:e=>({mainAxis:1})}:{align:"center",position:"below",offset:e=>({mainAxis:8})},he=i.createElement("div",{style:{borderRadius:oe,display:"flex",cursor:"pointer"}},te?i.createElement("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8}},i.createElement(h.In,{type:te,style:{width:void 0,height:void 0},primaryColor:q&&null!==(T=null==ee?void 0:ee.text.hover)&&void 0!==T?T:null==ee?void 0:ee.text.resting,fontSize:void 0})):void 0,i.createElement("span",{className:"ms-nudge-text",style:{color:q&&null!==(x=null==ee?void 0:ee.text.hover)&&void 0!==x?x:null==ee?void 0:ee.text.resting,fontSize:ie,fontWeight:ne,paddingTop:re,paddingBottom:se,paddingLeft:ae,paddingRight:ae,textDecoration:"none",userSelect:"none",lineHeight:le}},de.map((e=>{var t,o,n,r;return"@"===e||"/"===e?i.createElement("span",{key:e,style:Object.assign({backgroundColor:(null==ee?void 0:ee.highlight)?q?ee.highlight.background.hover:ee.highlight.background.resting:q&&null!==(t=null==ee?void 0:ee.background.hover)&&void 0!==t?t:null==ee?void 0:ee.background.resting,color:(null==ee?void 0:ee.highlight)?q?ee.highlight.text.hover:ee.highlight.text.resting:q&&null!==(o=null==ee?void 0:ee.text.hover)&&void 0!==o?o:null==ee?void 0:ee.text.resting,paddingLeft:null===(n=null==X?void 0:X.highlightStyle)||void 0===n?void 0:n.paddingLeftRight,paddingRight:null===(r=null==X?void 0:X.highlightStyle)||void 0===r?void 0:r.paddingLeftRight},null==X?void 0:X.highlightStyle)},e):i.createElement("span",{key:e},e)}))));if(_||P){const e={popover:{trapFocus:!0,withArrow:!1,open:H,onOpenChange:(e,t)=>{z(t.open)},positioning:Object.assign({target:(0,d.ug)(B)},ge)},surface:{className:"ms-ecc-callout",style:{padding:0,overflowY:"hidden",borderRadius:oe,backgroundColor:q?null==ee?void 0:ee.background.hover:null==ee?void 0:ee.background.resting,boxShadow:ue,cursor:"pointer"}}};return i.createElement("div",{role:"button",tabIndex:-1,onMouseOver:V,onMouseLeave:$,onMouseUp:K,onFocus:V,onBlur:$},i.createElement(c.v,Object.assign({},e),he))}return i.createElement(l.U,{target:B,directionalHint:ce,isBeakVisible:!1,gapSpace:8,onMouseOver:V,onMouseLeave:$,onMouseUp:K,style:{overflowY:"hidden"},styles:{root:{borderRadius:oe,boxShadow:ue,cursor:"pointer"},calloutMain:{borderRadius:oe,backgroundColor:q?null==ee?void 0:ee.background.hover:null==ee?void 0:ee.background.resting}}},he)}},81317:(e,t,o)=>{"use strict";o.d(t,{_:()=>c});var i=o(97069),n=o(93261),r=o(39168);if(3023==o.j)var s=o(69691);var a=o(95734);const l=(0,i.F5)({nudgeStateStore:n.A.on(r.V)}),c=()=>{const{nudgeStateStore:e}=(0,i.KN)(l),[t,o]=a.useState(e);a.useEffect((()=>(e.subscribe("stateUpdated",o),()=>{e.unsubscribe("stateUpdated",o)})),[e]);const{nudge:n,nudgeDisplayLocation:r,nudgeTargetDocumentRef:c}=t;return n&&r&&c?a.createElement(s.a,{nudge:n,inlineNudge:e.enableInlineNudge,insertionCharacter:e.insertionCharacter,nudgeTargetDocumentRef:c,nudgeDisplayLocation:r,onAcceptNudgeAction:(t,o)=>{e.onNudgeAccepted(t,o)},onHideNudge:(t,o)=>{e.onNudgeDismiss(t,o)}}):null}},90875:(e,t,o)=>{"use strict";if(o.d(t,{k:()=>r}),3023==o.j)var i=o(91519);const n=e=>!(void 0===e.isScopingEnabled&&void 0===e.showSeparator),r=e=>{if(e.length>0&&e.some(n))return e;const t=e.findIndex((e=>{var t;return(null===(t=e.suggestions[0])||void 0===t?void 0:t.type)===i.c.Scope}));return-1!==t?(e[t]=Object.assign(Object.assign({},e[t]),{isScopingEnabled:!1,showSeparator:!0}),e.concat(e.splice(t,1))):e}},14910:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CritiqueCallout:()=>i.r,CritiqueCalloutStateStore:()=>n.b,FOOTER_FRE_PAGE_ID:()=>l.Id,FocusZoneId:()=>r.u,FooterFre:()=>d.b,FooterFreModule:()=>m.B,FooterFreStore:()=>u.o,IPredictionStateStore:()=>C.Tc,InlineSuggestions:()=>h.V,InlineSuggestionsCalloutPortal:()=>p.b,InlineSuggestionsWebUXModule:()=>v.Q,InlineSuggestionsWithCallout:()=>f.$,InsertionPredictionStateStore:()=>w.l,LanguageAutoDetectionFRE:()=>c.a,LanguageAutoDetectionFRECallout:()=>l.sy,LayeredPrediction:()=>k.q,LayeredPredictionStateStore:()=>T.O,MultilingualFre:()=>b.R,MultilingualFreStore:()=>S.S,NudgeCallout:()=>x._,PredictionCoreModule:()=>y.B,PredictionDismissalReason:()=>C.R8,UndoCallout:()=>s.$,UndoCalloutStateStore:()=>a.f,UndoQuerySelectorClass:()=>a.g,critiqueCalloutDeps:()=>i.h,getEccUxReplacement:()=>g.Nt,getEccUxReplacementUX:()=>g.cu,langAutoDetectFooterId:()=>l.lP,undoCalloutDeps:()=>s.v}),3023==o.j)var i=o(51705);if(3023==o.j)var n=o(2713);if(3023==o.j)var r=o(64510);if(3023==o.j)var s=o(96382);if(3023==o.j)var a=o(98332);if(3023==o.j)var l=o(16278);if(3023==o.j)var c=o(99096);if(3023==o.j)var u=o(29e3);if(3023==o.j)var d=o(95909);if(3023==o.j)var g=o(53864);if(3023==o.j)var h=o(28816);if(3023==o.j)var p=o(62784);if(3023==o.j)var f=o(49942);if(3023==o.j)var m=o(86390);if(3023==o.j)var v=o(10583);if(3023==o.j)var y=o(66e3);if(3023==o.j)var b=o(62389);if(3023==o.j)var S=o(1240);if(3023==o.j)var C=o(36762);if(3023==o.j)var w=o(41836);if(3023==o.j)var k=o(4340);if(3023==o.j)var T=o(45528);if(3023==o.j)var x=o(81317)},85849:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>r}),3023==o.j)var i=o(49341);if(3023==o.j)var n=o(35308);function r(e,t,o){var r=(0,i.w)(e,(function(e){return t===e||e.hasAttribute(n.r)}),o);return null!==r&&r.hasAttribute(n.r)}},62346:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,W:()=>i});const i="data-overflowing",n="data-overflow-group"},49588:(e,t,o)=>{"use strict";function i(e,t){var o;const i=null===(o=e.ownerDocument.defaultView)||void 0===o?void 0:o.ResizeObserver;if(!i)return()=>null;let n=new i(t);return n.observe(e),()=>{null==n||n.disconnect(),n=void 0}}o.d(t,{v:()=>i})},57481:(e,t,o)=>{"use strict";function i(e){let t;return()=>{t||(t=!0,queueMicrotask((()=>{t=!1,e()})))}}o.d(t,{s:()=>i})},61201:(e,t,o)=>{"use strict";if(o.d(t,{A:()=>a}),3023==o.j)var i=o(62346);if(3023==o.j)var n=o(49588);if(3023==o.j)var r=o(57481);if(3023==o.j)var s=o(91039);function a(){const e=new Map;let t,o,a=!1,c=!0;const u={padding:10,overflowAxis:"horizontal",overflowDirection:"end",minimumVisible:0,onUpdateItemVisibility:()=>{},onUpdateOverflow:()=>{}},d={},g={};let h=()=>null;const p=(e,t)=>{const o=e.dequeue();return t.enqueue(o),d[o]},f=l();function m(e,t){if(!e||!t)return 0;const o=d[e],i=d[t];if(o.priority!==i.priority)return o.priority>i.priority?1:-1;const n="end"===u.overflowDirection?Node.DOCUMENT_POSITION_FOLLOWING:Node.DOCUMENT_POSITION_PRECEDING;return o.element.compareDocumentPosition(i.element)&n?1:-1}function v(t,o,i){return e.has(i)||e.set(i,"horizontal"===u.overflowAxis?i[t]:i[o]),e.get(i)}const y=v.bind(null,"offsetWidth","offsetHeight"),b=v.bind(null,"clientWidth","clientHeight"),S=(0,s.w)(((e,t)=>-1*m(e,t))),C=(0,s.w)(m);function w(){return C.all().map((e=>d[e].element)).map(y).reduce(((e,t)=>e+t),0)+Object.entries(f.groupVisibility()).reduce(((e,[t,o])=>e+("hidden"!==o&&g[t]?y(g[t].element):0)),0)+(S.size()>0&&o?y(o):0)}const k=()=>{const e=p(S,C);var t;u.onUpdateItemVisibility({item:e,visible:!0}),e.groupId&&(f.showItem(e.id,e.groupId),f.isSingleItemVisible(e.id,e.groupId)&&(null===(t=g[e.groupId])||void 0===t||t.element.removeAttribute(i.W)))},T=()=>{const e=p(C,S);var t;(u.onUpdateItemVisibility({item:e,visible:!1}),e.groupId)&&(f.isSingleItemVisible(e.id,e.groupId)&&(null===(t=g[e.groupId])||void 0===t||t.element.setAttribute(i.W,"")),f.hideItem(e.id,e.groupId))},x=()=>{((()=>{if(!t)return!1;e.clear();const o=b(t)-u.padding,i=C.peek(),n=S.peek();for(;m(S.peek(),C.peek())>0;)T();for(let e=0;e<2;e++){for(;w()<o&&S.size()>0||1===S.size();)k();for(;w()>o&&C.size()>u.minimumVisible;)T()}return C.peek()!==i||S.peek()!==n})()||c)&&(c=!1,(()=>{const e=C.all(),t=S.all(),o=e.map((e=>d[e])),i=t.map((e=>d[e]));u.onUpdateOverflow({visibleItems:o,invisibleItems:i,groupVisibility:f.groupVisibility()})})())},_=(0,r.s)(x),I=()=>{o=void 0},E=e=>{if(!g[e])return;const t=g[e];t.groupId&&(delete g[e],t.element.removeAttribute(i.Q))},A=t=>{if(!d[t])return;a&&(c=!0);const o=d[t];C.remove(t),S.remove(t),o.groupId&&(f.removeItem(o.id,o.groupId),o.element.removeAttribute(i.Q)),e.delete(o.element),delete d[t],_()};return{addItem:e=>{d[e.id]||(d[e.id]=e,a&&(c=!0,C.enqueue(e.id)),e.groupId&&(f.addItem(e.id,e.groupId),e.element.setAttribute(i.Q,e.groupId)),_())},disconnect:()=>{h(),t=void 0,a=!1,c=!0,Object.keys(d).forEach((e=>A(e))),Object.keys(g).forEach((e=>E(e))),I(),e.clear()},forceUpdate:x,observe:(e,o)=>{Object.assign(u,o),a=!0,Object.values(d).forEach((e=>C.enqueue(e.id))),t=e,h=(0,n.v)(t,(e=>{e[0]&&t&&_()}))},removeItem:A,update:_,addOverflowMenu:e=>{o=e},removeOverflowMenu:I,addDivider:e=>{e.groupId&&!g[e.groupId]&&(e.element.setAttribute(i.Q,e.groupId),g[e.groupId]=e)},removeDivider:E}}const l=()=>{const e={},t={};function o(o){const i=t[o];i.invisibleItemIds.size&&i.visibleItemIds.size?e[o]="overflow":0===i.visibleItemIds.size?e[o]="hidden":e[o]="visible"}return{groupVisibility:()=>e,isSingleItemVisible:(o,i)=>function(t){return"visible"===e[t]||"overflow"===e[t]}(i)&&t[i].visibleItemIds.has(o)&&1===t[i].visibleItemIds.size,addItem(e,i){var n,r,s;null!==(s=(n=t)[r=i])&&void 0!==s||(n[r]={visibleItemIds:new Set,invisibleItemIds:new Set}),t[i].visibleItemIds.add(e),o(i)},removeItem(e,i){t[i].invisibleItemIds.delete(e),t[i].visibleItemIds.delete(e),o(i)},showItem(e,i){t[i].invisibleItemIds.delete(e),t[i].visibleItemIds.add(e),o(i)},hideItem(e,i){t[i].invisibleItemIds.add(e),t[i].visibleItemIds.delete(e),o(i)}}}},91039:(e,t,o)=>{"use strict";function i(e){const t=[];let o=0;const i=e=>Math.floor((e-1)/2),n=(e,o)=>{const i=t[e];t[e]=t[o],t[o]=i},r=i=>{let s=i;const a=(e=>2*e+1)(i),l=(e=>2*e+2)(i);a<o&&e(t[a],t[s])<0&&(s=a),l<o&&e(t[l],t[s])<0&&(s=l),s!==i&&(n(s,i),r(s))};return{all:()=>t.slice(0,o),clear:()=>{o=0},contains:e=>{const i=t.indexOf(e);return i>=0&&i<o},dequeue:()=>{if(0===o)throw new Error("Priority queue empty");const e=t[0];return t[0]=t[--o],r(0),e},enqueue:r=>{t[o++]=r;let s=o-1,a=i(s);for(;s>0&&e(t[a],t[s])>0;)n(a,s),s=a,a=i(s)},peek:()=>0===o?null:t[0],remove:e=>{const i=t.indexOf(e);-1===i||i>=o||(t[i]=t[--o],r(i))},size:()=>o}}o.d(t,{w:()=>i})},87372:(e,t,o)=>{"use strict";if(o.d(t,{F:()=>r}),3023==o.j)var i=o(34837);if(3023==o.j)var n=o(81585);function r(e,t){const{disabled:o,disabledFocusable:r=!1,"aria-disabled":s,onClick:a,onKeyDown:l,onKeyUp:c,...u}=null!=t?t:{},d="string"==typeof s?"true"===s:s,g=o||r||d,h=(0,n.D)((e=>{g?(e.preventDefault(),e.stopPropagation()):null==a||a(e)})),p=(0,n.D)((e=>{if(null==l||l(e),e.isDefaultPrevented())return;const t=e.key;if(g&&(t===i.xyI||t===i.$xS))return e.preventDefault(),void e.stopPropagation();t!==i.$xS?t===i.xyI&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()})),f=(0,n.D)((e=>{if(null==c||c(e),e.isDefaultPrevented())return;const t=e.key;if(g&&(t===i.xyI||t===i.$xS))return e.preventDefault(),void e.stopPropagation();t===i.$xS&&(e.preventDefault(),e.currentTarget.click())}));if("button"===e||void 0===e)return{...u,disabled:o&&!r,"aria-disabled":!!r||d,onClick:r?void 0:h,onKeyUp:r?void 0:c,onKeyDown:r?void 0:l};{const t={role:"button",tabIndex:o&&!r?void 0:0,...u,onClick:h,onKeyUp:f,onKeyDown:p,"aria-disabled":o||r||d};return"a"===e&&g&&(t.href=void 0),t}}o(95734)},51451:(e,t,o)=>{"use strict";o.d(t,{$:()=>c});var i=o(95734),n=o(60171),r=o(27408),s=o(25061),a=o(17543),l=o(89161);const c=i.forwardRef(((e,t)=>{const o=(0,s.P)(e,t);return(0,a.B)(o),(0,l.$e)("useButtonStyles_unstable")(o),(e=>{(0,r.C)(e);const{iconOnly:t,iconPosition:o}=e;return(0,n.FD)(e.root,{children:["after"!==o&&e.icon&&(0,n.Y)(e.icon,{}),!t&&e.root.children,"after"===o&&e.icon&&(0,n.Y)(e.icon,{})]})})(o)}));c.displayName="Button"},25061:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>a}),o(95734),3023==o.j)var i=o(87372);if(3023==o.j)var n=o(7143);if(3023==o.j)var r=o(54694);if(3023==o.j)var s=o(15742);const a=(e,t)=>{const{size:o}=(0,s.j)(),{appearance:a="secondary",as:l="button",disabled:c=!1,disabledFocusable:u=!1,icon:d,iconPosition:g="before",shape:h="rounded",size:p=(null!=o?o:"medium")}=e,f=n.lq(d,{elementType:"span"});return{appearance:a,disabled:c,disabledFocusable:u,iconPosition:g,shape:h,size:p,iconOnly:Boolean((null==f?void 0:f.children)&&!e.children),components:{root:"button",icon:"span"},root:n.Gk((0,r.g)(l,(0,i.F)(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"}}),icon:f}}},17543:(e,t,o)=>{"use strict";o.d(t,{B:()=>h});var i=o(11612),n=o(27760);if(3023==o.j)var r=o(63649);const s=(0,i.y)("r1alrhcs",null,{r:[".r1alrhcs{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1alrhcs:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1alrhcs:hover:active{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1alrhcs[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1alrhcs{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1alrhcs:focus{border-color:ButtonText;}.r1alrhcs:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1alrhcs:hover:active{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1alrhcs[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),a=3023==o.j?(0,i.y)("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]):null,l=(0,n.X)({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",iro3zm:"fwiml72"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",iro3zm:"fnp9lpt",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1d6v5y2",Bsw6fvg:"f1rirnrt",Bjwas2f:"f1uu00uk",Bn1d65q:["fkvaka8","f9a0qzu"],Bxeuatn:"f1ux7til",n51gp8:["f9a0qzu","fkvaka8"],Bbusuzp:"f1lkg8j3",ycbfsm:"fkc42ay",Bqrx1nm:"fq7113v",pgvf35:"ff1wgvm",Bh7lczh:["fiob0tu","f1x4h75k"],dpv3f4:"f1j6scgf",Bpnjhaq:["f1x4h75k","fiob0tu"],ze5xyy:"f4xjyn1",g2kj27:"fbgcvur",Bf756sw:"f1ks1yx8",Bow2dr7:["f1o6qegi","fmxjhhp"],Bvhedfk:"fcnxywj",Gye4lf:["fmxjhhp","f1o6qegi"],pc6evw:"f9ddjv3"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",iro3zm:"fsv2rcd",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1omzyqd",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",x3br3k:"fj8yq94",ze5xyy:"f4xjyn1",Bx3q9su:"f1et0tmh",pc6evw:"f9ddjv3",xd2cci:"f1wi8ngl"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",iro3zm:"fwiml72",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1fg1p5m",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",Bqrx1nm:"f1tme0vf",ze5xyy:"f4xjyn1",g2kj27:"f18onu3q",pc6evw:"f9ddjv3"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fwiml72:hover:active{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".fnp9lpt:hover:active{background-color:var(--colorBrandBackgroundPressed);}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}",".f1d6v5y2:hover:active{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".fsv2rcd:hover:active{background-color:var(--colorSubtleBackgroundPressed);}",".f1omzyqd:hover:active{color:var(--colorNeutralForeground2Pressed);}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}",".fj8yq94:hover:active .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1fg1p5m:hover:active{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1rirnrt{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1uu00uk{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9a0qzu{border-left-color:HighlightText;}.fkvaka8{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ux7til{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lkg8j3{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkc42ay{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fq7113v:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff1wgvm:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1x4h75k:hover{border-left-color:Highlight;}.fiob0tu:hover{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1j6scgf:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbgcvur:hover:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ks1yx8:hover:active{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o6qegi:hover:active{border-right-color:Highlight;}.fmxjhhp:hover:active{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcnxywj:hover:active{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9ddjv3:hover:active{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1et0tmh:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wi8ngl:hover:active .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tme0vf:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18onu3q:hover:active{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),c=(0,n.X)({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",iro3zm:"f1t6o4dc",b661bw:"f10ztigi",Bk6r4ia:["f1ft5sdu","f1gzf82w"],B9zn80p:"f12zbtn2",Bpld233:["f1gzf82w","f1ft5sdu"],B2d53fq:"fcvwxyo",c3iz72:"f8w4c43",em6i61:"f1ol4fw6",vm6p8p:"f1q1lw4e",x3br3k:"f1dwjv2g"},highContrast:{Bsw6fvg:"f4lkoma",Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bbusuzp:"f1dcs8yz",G867l3:"fjwq6ea",gdbnj:["f1lr3nhc","f1mbxvi6"],mxns5l:"fn5gmvv",o3nasb:["f1mbxvi6","f1lr3nhc"],Bqrx1nm:"f1vmkb5g",pgvf35:"f53ppgq",Bh7lczh:["f1663y11","f80fkiy"],dpv3f4:"f18v5270",Bpnjhaq:["f80fkiy","f1663y11"],ze5xyy:"f1kc2mi9",g2kj27:"f1y0svfh",Bf756sw:"fihuait",Bow2dr7:["fnxhupq","fyd6l6x"],Bvhedfk:"fx507ft",Gye4lf:["fyd6l6x","fnxhupq"],pc6evw:"fb3rf2x"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",iro3zm:"f3h1zc4"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1t6o4dc:hover:active{background-color:var(--colorNeutralBackgroundDisabled);}",".f10ztigi:hover:active{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ft5sdu:hover:active{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1gzf82w:hover:active{border-left-color:var(--colorNeutralStrokeDisabled);}",".f12zbtn2:hover:active{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f8w4c43:hover:active{cursor:not-allowed;}",".f1ol4fw6:hover:active .fui-Icon-filled{display:none;}",".f1q1lw4e:hover:active .fui-Icon-regular{display:inline;}",".f1dwjv2g:hover:active .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f3h1zc4:hover:active{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f4lkoma{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjwq6ea:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lr3nhc:focus{border-right-color:GrayText;}.f1mbxvi6:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn5gmvv:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1vmkb5g:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f53ppgq:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1663y11:hover{border-right-color:GrayText;}.f80fkiy:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18v5270:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1y0svfh:hover:active{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fihuait:hover:active{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fnxhupq:hover:active{border-right-color:GrayText;}.fyd6l6x:hover:active{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fx507ft:hover:active{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fb3rf2x:hover:active{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),u=(0,n.X)({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Boium3a:["f12k37oa","fdnykm2"],tm8e47:"fr96u23"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f12k37oa[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fdnykm2[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.fr96u23[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),d=(0,n.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),g=(0,n.X)({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]}),h=e=>{const t=s(),o=a(),i=l(),n=c(),h=u(),p=d(),f=g(),{appearance:m,disabled:v,disabledFocusable:y,icon:b,iconOnly:S,iconPosition:C,shape:w,size:k}=e;return e.root.className=(0,r.z)("fui-Button",t,m&&i[m],i[k],b&&"small"===k&&i.smallWithIcon,b&&"large"===k&&i.largeWithIcon,i[w],(v||y)&&n.base,(v||y)&&n.highContrast,m&&(v||y)&&n[m],"primary"===m&&h.primary,h[k],h[w],S&&p[k],e.root.className),e.icon&&(e.icon.className=(0,r.z)("fui-Button__icon",o,!!e.root.children&&f[C],f[k],e.icon.className)),e}},22919:(e,t,o)=>{"use strict";o.d(t,{_:()=>v});var i=o(95734),n=o(60171),r=o(27408),s=o(7143),a=o(25061),l=o(27760),c=o(63649),u=o(17543);const d=(0,l.X)({base:{Bqenvij:"f11ysow2",J657lq:"f1um431h",Jlnjib:"fte7hqw",Bc29nj9:"f1yh8ef3"},highContrast:{pu7qz5:"fi3u9nm",B10010i:"f1tdgb9w"},outline:{},primary:{J657lq:"foe7gw6",Jlnjib:"fvxlz81",Bc29nj9:"f1c2mdy",B8ia98v:"f1r39r2s"},secondary:{},subtle:{J657lq:"f1um431h",Jlnjib:"fte7hqw",Bc29nj9:"f1yh8ef3",pu7qz5:"f1xoeh18",B10010i:"f1ca1nd7"},transparent:{J657lq:"f1um431h",Jlnjib:"f1wn9xqz",Bc29nj9:"f1a8q4d0"},small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ge6w2w",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fnnf4v2",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f14s4sho",Be2twd7:"fod5ikn",Bg96gwp:"faaz57k"},disabled:{J657lq:"f1rlv8bf",Jlnjib:"fd1dbtm",Bc29nj9:"f1vqmdmi"},disabledHighContrast:{B8ia98v:"f1csacz4",pu7qz5:"f1s5tkfe",B10010i:"fs0rda3"}},{d:[".f11ysow2{height:auto;}",".f1um431h .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2);}",".foe7gw6 .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",[".f1ge6w2w{padding:var(--spacingHorizontalS) var(--spacingHorizontalS) var(--spacingHorizontalMNudge) var(--spacingHorizontalS);}",{p:-1}],".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".fnnf4v2{padding:14px var(--spacingHorizontalM) var(--spacingHorizontalL) var(--spacingHorizontalM);}",{p:-1}],[".f14s4sho{padding:18px var(--spacingHorizontalL) var(--spacingHorizontalXL) var(--spacingHorizontalL);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1rlv8bf .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}"],h:[".fte7hqw:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2Hover);}",".f1yh8ef3:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2Pressed);}",".fvxlz81:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",".f1c2mdy:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",".f1wn9xqz:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2BrandHover);}",".f1a8q4d0:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2BrandPressed);}",".fd1dbtm:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}",".f1vqmdmi:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.fi3u9nm:hover .fui-CompoundButton__secondaryContent{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tdgb9w:hover:active .fui-CompoundButton__secondaryContent{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1r39r2s .fui-CompoundButton__secondaryContent{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1xoeh18:hover .fui-CompoundButton__secondaryContent{color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ca1nd7:hover:active .fui-CompoundButton__secondaryContent{color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1csacz4 .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1s5tkfe:hover .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fs0rda3:hover:active .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),g=(0,l.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1t35pdg",B2u0y6b:"ft5vyj6",Bf4jedk:"f17suaiq"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1r1wyb6",B2u0y6b:"fdczgix",Bf4jedk:"fjdcg9m"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bnz8pu",B2u0y6b:"fww51uw",Bf4jedk:"f1qhsl2h"}},{d:[[".f1t35pdg{padding:var(--spacingHorizontalXS);}",{p:-1}],".ft5vyj6{max-width:48px;}",".f17suaiq{min-width:48px;}",[".f1r1wyb6{padding:var(--spacingHorizontalSNudge);}",{p:-1}],".fdczgix{max-width:52px;}",".fjdcg9m{min-width:52px;}",[".f1bnz8pu{padding:var(--spacingHorizontalS);}",{p:-1}],".fww51uw{max-width:56px;}",".f1qhsl2h{min-width:56px;}"]}),h=(0,l.X)({base:{Be2twd7:"fndrnj9",Bqenvij:"fbhnoac",a9b677:"feqmc2u"},before:{t21cq0:["fkujibs","f199hnxi"]},after:{Frg6f3:["f199hnxi","fkujibs"]}},{d:[".fndrnj9{font-size:40px;}",".fbhnoac{height:40px;}",".feqmc2u{width:40px;}",".fkujibs{margin-right:var(--spacingHorizontalM);}",".f199hnxi{margin-left:var(--spacingHorizontalM);}"]}),p=(0,l.X)({base:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",fsow6f:["f1o700av","fes3tcz"]}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}"]}),f=(0,l.X)({base:{Bg96gwp:"flkuc6h",Bhrd7zp:"figsok6"},small:{Be2twd7:"fy9rknc"},medium:{Be2twd7:"fy9rknc"},large:{Be2twd7:"fkhj508"}},{d:[".flkuc6h{line-height:100%;}",".figsok6{font-weight:var(--fontWeightRegular);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fkhj508{font-size:var(--fontSizeBase300);}"]});var m=o(89161);const v=i.forwardRef(((e,t)=>{const o=(({contentContainer:e,secondaryContent:t,...o},i)=>{var n,r;const l={...(0,a.P)(o,i),components:{root:"button",icon:"span",contentContainer:"span",secondaryContent:"span"},contentContainer:s.Gk(e,{elementType:"span"}),secondaryContent:s.lq(t,{elementType:"span"})};return l.iconOnly=Boolean((null===(n=l.icon)||void 0===n?void 0:n.children)&&!o.children&&!(null===(r=l.secondaryContent)||void 0===r?void 0:r.children)),l})(e,t);return(e=>{const t=d(),o=g(),i=h(),n=p(),r=f(),{appearance:s,disabled:a,disabledFocusable:l,iconOnly:m,iconPosition:v,size:y}=e;e.root.className=(0,c.z)("fui-CompoundButton",t.base,t.highContrast,s&&t[s],t[y],(a||l)&&t.disabled,(a||l)&&t.disabledHighContrast,m&&o[y],e.root.className),e.contentContainer.className=(0,c.z)("fui-CompoundButton__contentContainer",n.base,e.contentContainer.className),e.icon&&(e.icon.className=(0,c.z)("fui-CompoundButton__icon",i.base,void 0!==e.root.children&&null!==e.root.children&&i[v],e.icon.className)),e.secondaryContent&&(e.secondaryContent.className=(0,c.z)("fui-CompoundButton__secondaryContent",r.base,r[y],e.secondaryContent.className)),(0,u.B)(e)})(o),(0,m.$e)("useCompoundButtonStyles_unstable")(o),(e=>{(0,r.C)(e);const{iconOnly:t,iconPosition:o}=e;return(0,n.FD)(e.root,{children:["after"!==o&&e.icon&&(0,n.Y)(e.icon,{}),!t&&(0,n.FD)(e.contentContainer,{children:[e.root.children,e.secondaryContent&&(0,n.Y)(e.secondaryContent,{})]}),"after"===o&&e.icon&&(0,n.Y)(e.icon,{})]})})(o)}));v.displayName="CompoundButton"},15742:(e,t,o)=>{"use strict";o.d(t,{j:()=>s});var i=o(95734);const n=i.createContext(void 0),r={},s=(n.Provider,()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r})},88256:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>s}),3023==o.j)var i=o(47586);var n=o(95734),r=o(85453);const s=e=>{const t=n.createContext({value:{current:e},version:{current:-1},listeners:[]});var o;return t.Provider=(o=t.Provider,e=>{const t=n.useRef(e.value),s=n.useRef(0),a=n.useRef();return a.current||(a.current={value:t,version:s,listeners:[]}),(0,i.E)((()=>{t.current=e.value,s.current+=1,(0,r.unstable_runWithPriority)(r.unstable_NormalPriority,(()=>{a.current.listeners.forEach((t=>{t([s.current,e.value])}))}))}),[e.value]),n.createElement(o,{value:a.current},e.children)}),delete t.Consumer,t}},43080:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(81585);if(3023==o.j)var n=o(47586);var r=o(95734);const s=(e,t)=>{const o=r.useContext(e),{value:{current:s},version:{current:a},listeners:l}=o,c=t(s),[u,d]=r.useState([s,c]),g=e=>{d((o=>{if(!e)return[s,c];if(e[0]<=a)return Object.is(o[1],c)?o:[s,c];try{if(Object.is(o[0],e[1]))return o;const i=t(e[1]);return Object.is(o[1],i)?o:[e[1],i]}catch(e){}return[o[0],o[1]]}))};Object.is(u[1],c)||g(void 0);const h=(0,i.D)(g);return(0,n.E)((()=>(l.push(h),()=>{const e=l.indexOf(h);l.splice(e,1)})),[h,l]),u[1]}},12411:(e,t,o)=>{"use strict";o.d(t,{V:()=>n});var i=o(95734);function n(e){const t=i.useContext(e);return!!t.version&&-1!==t.version.current}},73747:(e,t,o)=>{"use strict";o.d(t,{c:()=>f});var i=o(95734),n=o(60171),r=o(27408),s=o(49749),a=o(7143),l=o(54694),c=o(27760),u=o(63649);const d=(0,c.X)({base:{Bt984gj:"f122n59",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bh6795r:"fqerorx",qhf8xq:"f10pi13n",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",fsow6f:"f17mccla",Bcvre1j:"fyl8oag",Br0sdwz:"f16vkdww",Bn78ew0:"fhsnbul",li1rpt:"f1gw3sf2",ap17g6:"f1ly5f7u",B771hl4:"f1s3tz6t"},childless:{susq4k:"f1kyqvp9",Bicfajf:["fzynn9s","f1z0ukd1"],jwcpgy:["fekrn8e","ftdg338"],B4rk6o:"fesgyo"},start:{Bsft5z2:"f13zj6fq"},center:{Ftih45:"f1wl9k8s",Bsft5z2:"f13zj6fq"},end:{Ftih45:"f1wl9k8s"},brand:{sj55zd:"f16muhyy",Bq4z7u6:"fcbuu2a",Bk5zm6e:["f1wdw2dr","f1ttio3w"],Bqjgrrk:"f1582fpk",Bm6vgfq:["f1ttio3w","f1wdw2dr"],B0n5ga8:"f1ahrvm8",s924m2:["f1cd3wbc","f17hbk9y"],B1q35kw:"fvrapl0",Gp14am:["f17hbk9y","f1cd3wbc"]},default:{sj55zd:"fkfq4zb",Bq4z7u6:"f1vccso1",Bk5zm6e:["f1geml7w","fjml6kk"],Bqjgrrk:"f1r7kh1m",Bm6vgfq:["fjml6kk","f1geml7w"],B0n5ga8:"f16j7guv",s924m2:["fx01ahm","fj1a37q"],B1q35kw:"fl8d8yv",Gp14am:["fj1a37q","fx01ahm"]},subtle:{sj55zd:"f11d4kpn",Bq4z7u6:"f5g06un",Bk5zm6e:["f13sxdku","f1n015lb"],Bqjgrrk:"f1x6bl8t",Bm6vgfq:["f1n015lb","f13sxdku"],B0n5ga8:"fvod1wy",s924m2:["fwslg65","flk0e17"],B1q35kw:"f103fvts",Gp14am:["flk0e17","fwslg65"]},strong:{sj55zd:"f19n0e5",Bq4z7u6:"f10tv6oz",Bk5zm6e:["f16xp3sf","f1seuxxq"],Bqjgrrk:"fwrmqbx",Bm6vgfq:["f1seuxxq","f16xp3sf"],B0n5ga8:"ft83z1f",s924m2:["f1g4150c","f192dr6e"],B1q35kw:"f1qnawh6",Gp14am:["f192dr6e","f1g4150c"]}},{d:[".f122n59{align-items:center;}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fqerorx{flex-grow:1;}",".f10pi13n{position:relative;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f17mccla{text-align:center;}",".fyl8oag::before{box-sizing:border-box;}",".f16vkdww::before{display:flex;}",".fhsnbul::before{flex-grow:1;}",".f1gw3sf2::after{box-sizing:border-box;}",".f1ly5f7u::after{display:flex;}",".f1s3tz6t::after{flex-grow:1;}",".f1kyqvp9::before{margin-bottom:0;}",".fzynn9s::before{margin-right:0;}",".f1z0ukd1::before{margin-left:0;}",".fekrn8e::after{margin-left:0;}",".ftdg338::after{margin-right:0;}",".fesgyo::after{margin-top:0;}",'.f13zj6fq::after{content:"";}','.f1wl9k8s::before{content:"";}',".f16muhyy{color:var(--colorBrandForeground1);}",".fcbuu2a::before{border-top-color:var(--colorBrandStroke1);}",".f1wdw2dr::before{border-right-color:var(--colorBrandStroke1);}",".f1ttio3w::before{border-left-color:var(--colorBrandStroke1);}",".f1582fpk::before{border-bottom-color:var(--colorBrandStroke1);}",".f1ahrvm8::after{border-top-color:var(--colorBrandStroke1);}",".f1cd3wbc::after{border-right-color:var(--colorBrandStroke1);}",".f17hbk9y::after{border-left-color:var(--colorBrandStroke1);}",".fvrapl0::after{border-bottom-color:var(--colorBrandStroke1);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f1vccso1::before{border-top-color:var(--colorNeutralStroke2);}",".f1geml7w::before{border-right-color:var(--colorNeutralStroke2);}",".fjml6kk::before{border-left-color:var(--colorNeutralStroke2);}",".f1r7kh1m::before{border-bottom-color:var(--colorNeutralStroke2);}",".f16j7guv::after{border-top-color:var(--colorNeutralStroke2);}",".fx01ahm::after{border-right-color:var(--colorNeutralStroke2);}",".fj1a37q::after{border-left-color:var(--colorNeutralStroke2);}",".fl8d8yv::after{border-bottom-color:var(--colorNeutralStroke2);}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f5g06un::before{border-top-color:var(--colorNeutralStroke3);}",".f13sxdku::before{border-right-color:var(--colorNeutralStroke3);}",".f1n015lb::before{border-left-color:var(--colorNeutralStroke3);}",".f1x6bl8t::before{border-bottom-color:var(--colorNeutralStroke3);}",".fvod1wy::after{border-top-color:var(--colorNeutralStroke3);}",".fwslg65::after{border-right-color:var(--colorNeutralStroke3);}",".flk0e17::after{border-left-color:var(--colorNeutralStroke3);}",".f103fvts::after{border-bottom-color:var(--colorNeutralStroke3);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f10tv6oz::before{border-top-color:var(--colorNeutralStroke1);}",".f16xp3sf::before{border-right-color:var(--colorNeutralStroke1);}",".f1seuxxq::before{border-left-color:var(--colorNeutralStroke1);}",".fwrmqbx::before{border-bottom-color:var(--colorNeutralStroke1);}",".ft83z1f::after{border-top-color:var(--colorNeutralStroke1);}",".f1g4150c::after{border-right-color:var(--colorNeutralStroke1);}",".f192dr6e::after{border-left-color:var(--colorNeutralStroke1);}",".f1qnawh6::after{border-bottom-color:var(--colorNeutralStroke1);}"]}),g=(0,c.X)({base:{a9b677:"fly5x3f",Bdkvgpv:"f163fonl",B0qfbqy:"f51yk4v",pbipgd:"f13rof3u",Bm2nyyq:"f8rth92",xrcqlc:"f6czdpx",i5u598:"f1iyka9k"},inset:{uwmqm3:["fjlbh76","f11qrl6u"],z189sj:["f11qrl6u","fjlbh76"]},start:{Ftih45:"f1wl9k8s",Bicfajf:["f1ojjlep","fk1kexq"],Bxwl2t9:"f1he2m4d",jwcpgy:["f12w1bnb","f1558wlj"]},center:{Bicfajf:["f1ojjlep","fk1kexq"],jwcpgy:["f12w1bnb","f1558wlj"]},end:{Bicfajf:["f1ojjlep","fk1kexq"],Bsft5z2:"f13zj6fq",jwcpgy:["f12w1bnb","f1558wlj"],Iy66sp:"f1ayce8x"}},{d:[".fly5x3f{width:100%;}",".f163fonl::before{border-top-style:solid;}",".f51yk4v::before{border-top-width:var(--strokeWidthThin);}",".f13rof3u::before{min-width:8px;}",".f8rth92::after{border-top-style:solid;}",".f6czdpx::after{border-top-width:var(--strokeWidthThin);}",".f1iyka9k::after{min-width:8px;}",".fjlbh76{padding-left:12px;}",".f11qrl6u{padding-right:12px;}",'.f1wl9k8s::before{content:"";}',".f1ojjlep::before{margin-right:12px;}",".fk1kexq::before{margin-left:12px;}",".f1he2m4d::before{max-width:8px;}",".f12w1bnb::after{margin-left:12px;}",".f1558wlj::after{margin-right:12px;}",'.f13zj6fq::after{content:"";}',".f1ayce8x::after{max-width:8px;}"]}),h=(0,c.X)({base:{Beiy3e4:"f1vx9l62",sshi5w:"f16gbxbe",m598lv:["f1yq6w5o","f1jpmc5p"],B4f6apu:["f9sc749","f1x8pvcy"],zkzzav:"fhkwbjy",Barhvk9:["flthirb","ftkbnf5"],Ihftqj:["f13hvwk3","f1en4csx"],Bde111x:"f19onpk6"},inset:{B6of3ja:"f1xdg43u",jrapky:"f1jlhsmd"},withChildren:{sshi5w:"f1tjaq3g"},start:{Ftih45:"f1wl9k8s",susq4k:"fg2pwug",Bbdr6tz:"fkjtzyi",B4rk6o:"f8vk40g"},center:{susq4k:"fg2pwug",B4rk6o:"f8vk40g"},end:{susq4k:"fg2pwug",Bsft5z2:"f13zj6fq",B4rk6o:"f8vk40g",gn64ia:"fqg5mu5"}},{d:[".f1vx9l62{flex-direction:column;}",".f16gbxbe{min-height:20px;}",".f1yq6w5o::before{border-right-style:solid;}",".f1jpmc5p::before{border-left-style:solid;}",".f9sc749::before{border-right-width:var(--strokeWidthThin);}",".f1x8pvcy::before{border-left-width:var(--strokeWidthThin);}",".fhkwbjy::before{min-height:8px;}",".flthirb::after{border-right-style:solid;}",".ftkbnf5::after{border-left-style:solid;}",".f13hvwk3::after{border-right-width:var(--strokeWidthThin);}",".f1en4csx::after{border-left-width:var(--strokeWidthThin);}",".f19onpk6::after{min-height:8px;}",".f1xdg43u{margin-top:12px;}",".f1jlhsmd{margin-bottom:12px;}",".f1tjaq3g{min-height:84px;}",'.f1wl9k8s::before{content:"";}',".fg2pwug::before{margin-bottom:12px;}",".fkjtzyi::before{max-height:8px;}",".f8vk40g::after{margin-top:12px;}",'.f13zj6fq::after{content:"";}',".fqg5mu5::after{max-height:8px;}"]});var p=o(89161);const f=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{alignContent:o="center",appearance:i="default",inset:n=!1,vertical:r=!1,wrapper:c}=e,u=(0,s.Bi)("divider-");return{alignContent:o,appearance:i,inset:n,vertical:r,components:{root:"div",wrapper:"div"},root:a.Gk((0,l.g)("div",{role:"separator","aria-orientation":r?"vertical":"horizontal","aria-labelledby":e.children?u:void 0,...e,ref:t}),{elementType:"div"}),wrapper:a.Gk(c,{defaultProps:{id:u,children:e.children},elementType:"div"})}})(e,t);return(e=>{const t=d(),o=g(),i=h(),{alignContent:n,appearance:r,inset:s,vertical:a}=e;e.root.className=(0,u.z)("fui-Divider",t.base,t[n],r&&t[r],!a&&o.base,!a&&s&&o.inset,!a&&o[n],a&&i.base,a&&s&&i.inset,a&&i[n],a&&void 0!==e.root.children&&i.withChildren,void 0===e.root.children&&t.childless,e.root.className),e.wrapper&&(e.wrapper.className=(0,u.z)("fui-Divider__wrapper",e.wrapper.className))})(o),(0,p.$e)("useDividerStyles_unstable")(o),(e=>((0,r.C)(e),(0,n.Y)(e.root,{children:void 0!==e.root.children&&(0,n.Y)(e.wrapper,{children:e.root.children})})))(o)}));f.displayName="Divider"},12137:(e,t,o)=>{"use strict";o.d(t,{o:()=>r});var i=o(95734);const n=i.createContext(void 0),r=(n.Provider,()=>i.useContext(n))},25386:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>n}),3023==o.j)var i=o(12137);function n(e,t){return function(e,t,o){if(!e)return t;t={...t};const{generatedControlId:i,hintId:n,labelFor:r,labelId:s,required:a,validationMessageId:l,validationState:c}=e;var u,d,g,h,p,f,m,v,y,b,S,C,w;(i&&(null!==(d=(u=t).id)&&void 0!==d||(u.id=i)),!s||(null==o?void 0:o.supportsLabelFor)&&r===t.id||null!==(p=(g=t)[h="aria-labelledby"])&&void 0!==p||(g[h]=s),(l||n)&&(t["aria-describedby"]=[l,n,null==t?void 0:t["aria-describedby"]].filter(Boolean).join(" ")),"error"===c&&(null!==(m=(f=t)["aria-invalid"])&&void 0!==m||(f["aria-invalid"]=!0)),a)&&((null==o?void 0:o.supportsRequired)?null!==(S=(b=t).required)&&void 0!==S||(b.required=!0):null!==(w=(C=t)["aria-required"])&&void 0!==w||(C["aria-required"]=!0));return(null==o?void 0:o.supportsSize)&&(null!==(y=(v=t).size)&&void 0!==y||(v.size=e.size)),t}((0,i.o)(),e,t)}},19728:(e,t,o)=>{"use strict";o.d(t,{R:()=>N});var i,n=o(30206),r=o(95734),s=o(88891),a=o(20405),l=o(93293),c=o(74421),u=o(42093),d=o(33362),g=o(37128),h=o(7969),p=o(98885),f=o(35143),m=o(31075),v=o(49863),y=o(85849),b=o(87886),S=o(27031),C=o(24280),w=o(58546),k="data-is-focusable",T="data-focuszone-id",x="tabindex",_="data-no-vertical-wrap",I="data-no-horizontal-wrap",E=999999999,A=-999999999;function B(e,t){var o;"function"==typeof MouseEvent?o=new MouseEvent("click",{ctrlKey:null==t?void 0:t.ctrlKey,metaKey:null==t?void 0:t.metaKey,shiftKey:null==t?void 0:t.shiftKey,altKey:null==t?void 0:t.altKey,bubbles:null==t?void 0:t.bubbles,cancelable:null==t?void 0:t.cancelable}):(o=document.createEvent("MouseEvents")).initMouseEvent("click",!!t&&t.bubbles,!!t&&t.cancelable,window,0,0,0,0,0,!!t&&t.ctrlKey,!!t&&t.altKey,!!t&&t.shiftKey,!!t&&t.metaKey,0,null),e.dispatchEvent(o)}var R={},M=new Set,D=["text","number","password","email","tel","url","search","textarea"],P=!1,N=function(e){function t(o){var i,n,p,f,m=this;(m=e.call(this,o)||this)._root=r.createRef(),m._mergedRef=(0,a.K)(),m._onFocus=function(e){var t;if(!m._portalContainsElement(e.target)){var o,i=(t=m.props).onActiveElementChanged,n=t.doNotAllowFocusEventToPropagate,r=t.stopFocusPropagation,s=t.onFocusNotification,a=t.onFocus,u=t.shouldFocusInnerElementWhenReceivedFocus,d=t.defaultTabbableElement,g=m._isImmediateDescendantOfZone(e.target);if(g)o=e.target;else for(var h=e.target;h&&h!==m._root.current;){if((0,l.S0)(h,void 0,m._inShadowRoot)&&m._isImmediateDescendantOfZone(h)){o=h;break}h=(0,c.P)(h,P)}if(u&&e.target===m._root.current){var p=d&&"function"==typeof d&&m._root.current&&d(m._root.current);p&&(0,l.S0)(p,void 0,m._inShadowRoot)?(o=p,p.focus()):(m.focus(!0),m._activeElement&&(o=null))}var f=!m._activeElement;o&&o!==m._activeElement&&((g||f)&&m._setFocusAlignment(o,!0,!0),m._activeElement=o,f&&m._updateTabIndexes()),i&&i(m._activeElement,e),(r||n)&&e.stopPropagation(),a?a(e):s&&s()}},m._onBlur=function(){m._setParkedFocus(!1)},m._onMouseDown=function(e){if(!m._portalContainsElement(e.target)&&!m.props.disabled){for(var t=e.target,o=[];t&&t!==m._root.current;)o.push(t),t=(0,c.P)(t,P);for(;o.length&&((t=o.pop())&&(0,l.S0)(t,void 0,m._inShadowRoot)&&m._setActiveElement(t,!0),!(0,l.HC)(t)););}},m._onKeyDown=function(e,t){var o;if(!m._portalContainsElement(e.target)){var i=(o=m.props).direction,n=o.disabled,r=o.isInnerZoneKeystroke,a=o.pagingSupportDisabled,c=o.shouldEnterInnerZone;if(!(n||(m.props.onKeyDown&&m.props.onKeyDown(e),e.isDefaultPrevented()||m._getDocument().activeElement===m._root.current&&m._isInnerZone))){if((c&&c(e)||r&&r(e))&&m._isImmediateDescendantOfZone(e.target)){var g=m._getFirstInnerZone();if(g){if(!g.focus(!0))return}else{if(!(0,l.Z5)(e.target))return;if(!m.focusElement((0,l.eX)(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case u.c.space:if(m._shouldRaiseClicksOnSpace&&m._tryInvokeClickForFocusable(e.target,e))break;return;case u.c.left:if(i!==s.E.vertical&&(m._preventDefaultWhenHandled(e),m._moveFocusLeft(t)))break;return;case u.c.right:if(i!==s.E.vertical&&(m._preventDefaultWhenHandled(e),m._moveFocusRight(t)))break;return;case u.c.up:if(i!==s.E.horizontal&&(m._preventDefaultWhenHandled(e),m._moveFocusUp()))break;return;case u.c.down:if(i!==s.E.horizontal&&(m._preventDefaultWhenHandled(e),m._moveFocusDown()))break;return;case u.c.pageDown:if(!a&&m._moveFocusPaging(!0))break;return;case u.c.pageUp:if(!a&&m._moveFocusPaging(!1))break;return;case u.c.tab:if(m.props.allowTabKey||m.props.handleTabKey===s.l.all||m.props.handleTabKey===s.l.inputOnly&&m._isElementInput(e.target)){var h=!1;if(m._processingTabKey=!0,h=i!==s.E.vertical&&m._shouldWrapFocus(m._activeElement,I)?((0,d.jI)(t)?!e.shiftKey:e.shiftKey)?m._moveFocusLeft(t):m._moveFocusRight(t):e.shiftKey?m._moveFocusUp():m._moveFocusDown(),m._processingTabKey=!1,h)break;m.props.shouldResetActiveElementWhenTabFromZone&&(m._activeElement=null)}return;case u.c.home:if(m._isContentEditableElement(e.target)||m._isElementInput(e.target)&&!m._shouldInputLoseFocus(e.target,!1))return!1;var p=m._root.current&&m._root.current.firstChild;if(m._root.current&&p&&m.focusElement((0,l.eX)(m._root.current,p,!0)))break;return;case u.c.end:if(m._isContentEditableElement(e.target)||m._isElementInput(e.target)&&!m._shouldInputLoseFocus(e.target,!0))return!1;var f=m._root.current&&m._root.current.lastChild;if(m._root.current&&m.focusElement((0,l.yv)(m._root.current,f,!0,!0,!0)))break;return;case u.c.enter:if(m._shouldRaiseClicksOnEnter&&m._tryInvokeClickForFocusable(e.target,e))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}},m._getHorizontalDistanceFromCenter=function(e,t,o){var i=m._focusAlignment.left||m._focusAlignment.x||0,n=Math.floor(o.top),r=Math.floor(t.bottom),s=Math.floor(o.bottom),a=Math.floor(t.top);return e&&n>r||!e&&s<a?i>=o.left&&i<=o.left+o.width?0:Math.abs(o.left+o.width/2-i):m._shouldWrapFocus(m._activeElement,_)?E:A},(0,g.f)(m),m._id=(0,h.O)("FocusZone"),m._focusAlignment={left:0,top:0},m._processingTabKey=!1;var v=null===(n=null!==(i=o.shouldRaiseClicks)&&void 0!==i?i:t.defaultProps.shouldRaiseClicks)||void 0===n||n;return m._shouldRaiseClicksOnEnter=null!==(p=o.shouldRaiseClicksOnEnter)&&void 0!==p?p:v,m._shouldRaiseClicksOnSpace=null!==(f=o.shouldRaiseClicksOnSpace)&&void 0!==f?f:v,m}return(0,n.__extends)(t,e),t.getOuterZones=function(){return M.size},t._onKeyDownCapture=function(e){e.which===u.c.tab&&M.forEach((function(e){return e._updateTabIndexes()}))},t.prototype.componentDidMount=function(){var e,o=this._root.current;if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),R[this._id]=this,o){for(var i=(0,c.P)(o,P);i&&i!==this._getDocument().body&&1===i.nodeType;){if((0,l.HC)(i)){this._isInnerZone=!0;break}i=(0,c.P)(i,P)}this._isInnerZone||(M.add(this),this._root.current&&this._root.current.addEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},t.prototype.componentDidUpdate=function(){var e,t=this._root.current,o=this._getDocument();if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),(this._activeElement&&!(0,p.s)(this._root.current,this._activeElement,P)||this._defaultFocusElement&&!(0,p.s)(this._root.current,this._defaultFocusElement,P))&&(this._activeElement=null,this._defaultFocusElement=null,this._updateTabIndexes()),!this.props.preventFocusRestoration&&o&&this._lastIndexPath&&(o.activeElement===o.body||null===o.activeElement||o.activeElement===t)){var i=(0,l.nA)(t,this._lastIndexPath);i?(this._setActiveElement(i,!0),i.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},t.prototype.componentWillUnmount=function(){delete R[this._id],this._isInnerZone||(M.delete(this),this._root.current&&this._root.current.removeEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},t.prototype.render=function(){var e,t=this,o=(e=this.props).as,s=e.elementType,a=e.rootProps,l=e.ariaDescribedBy,c=e.ariaLabelledBy,u=e.className,d=(0,f.G1)(this.props,f.vt),g=o||s||"div";this._evaluateFocusBeforeRender();var h=(0,w.O4)();return r.createElement(g,(0,n.__assign)({"aria-labelledby":c,"aria-describedby":l},d,a,{className:(0,m.A)((i||(i=(0,C.Z)({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),i),u),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(e){return t._onKeyDown(e,h)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},t.prototype.focus=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._root.current){if(!e&&"true"===this._root.current.getAttribute(k)&&this._isInnerZone){var o=this._getOwnerZone(this._root.current);if(o!==this._root.current){var i=R[o.getAttribute(T)];return!!i&&i.focusElement(this._root.current)}return!1}if(!e&&this._activeElement&&(0,p.s)(this._root.current,this._activeElement)&&(0,l.S0)(this._activeElement,void 0,this._inShadowRoot)&&(!t||(0,l.F2)(this._activeElement)))return this._activeElement.focus(),!0;var n=this._root.current.firstChild;return this.focusElement((0,l.eX)(this._root.current,n,!0,void 0,void 0,void 0,void 0,void 0,t))}return!1},t.prototype.focusLast=function(){if(this._root.current){var e=this._root.current&&this._root.current.lastChild;return this.focusElement((0,l.yv)(this._root.current,e,!0,!0,!0))}return!1},t.prototype.focusElement=function(e,t){var o,i=(o=this.props).onBeforeFocus,n=o.shouldReceiveFocus;return!(n&&!n(e)||i&&!i(e)||!e||(this._setActiveElement(e,t),this._activeElement&&this._activeElement.focus(),0))},t.prototype.setFocusAlignment=function(e){this._focusAlignment=e},Object.defineProperty(t.prototype,"defaultFocusElement",{get:function(){return this._defaultFocusElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeElement",{get:function(){return this._activeElement},enumerable:!1,configurable:!0}),t.prototype._evaluateFocusBeforeRender=function(){var e=this._root.current,t=this._getDocument();if(t){var o=t.activeElement;if(o!==e){var i=(0,p.s)(e,o,!1);this._lastIndexPath=i?(0,l.Ep)(e,o):void 0}}},t.prototype._setParkedFocus=function(e){var t=this._root.current;t&&this._isParked!==e&&(this._isParked=e,e?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},t.prototype._setActiveElement=function(e,t){var o=this._activeElement;this._activeElement=e,o&&((0,l.HC)(o)&&this._updateTabIndexes(o),o.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)},t.prototype._preventDefaultWhenHandled=function(e){this.props.preventDefaultWhenHandled&&e.preventDefault()},t.prototype._tryInvokeClickForFocusable=function(e,t){var o=e;if(o===this._root.current)return!1;do{if("BUTTON"===o.tagName||"A"===o.tagName||"INPUT"===o.tagName||"TEXTAREA"===o.tagName||"SUMMARY"===o.tagName)return!1;if(this._isImmediateDescendantOfZone(o)&&"true"===o.getAttribute(k)&&"true"!==o.getAttribute("data-disable-click-on-enter"))return B(o,t),!0;o=(0,c.P)(o,P)}while(o!==this._root.current);return!1},t.prototype._getFirstInnerZone=function(e){if(!(e=e||this._activeElement||this._root.current))return null;if((0,l.HC)(e))return R[e.getAttribute(T)];for(var t=e.firstElementChild;t;){if((0,l.HC)(t))return R[t.getAttribute(T)];var o=this._getFirstInnerZone(t);if(o)return o;t=t.nextElementSibling}return null},t.prototype._moveFocus=function(e,t,o,i){void 0===i&&(i=!0);var n=this._activeElement,r=-1,a=void 0,c=!1,u=this.props.direction===s.E.bidirectional;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,e))return!1;var d=u?n.getBoundingClientRect():null;do{if(n=e?(0,l.eX)(this._root.current,n):(0,l.yv)(this._root.current,n),!u){a=n;break}if(n){var g=t(d,n.getBoundingClientRect());if(-1===g&&-1===r){a=n;break}if(g>-1&&(-1===r||g<r)&&(r=g,a=n),r>=0&&g<0)break}}while(n);if(a&&a!==this._activeElement)c=!0,this.focusElement(a);else if(this.props.isCircularNavigation&&i)return e?this.focusElement((0,l.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,l.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return c},t.prototype._moveFocusDown=function(){var e=this,t=-1,o=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(i,n){var r=-1,s=Math.floor(n.top),a=Math.floor(i.bottom);return s<a?e._shouldWrapFocus(e._activeElement,_)?E:A:((-1===t&&s>=a||s===t)&&(t=s,r=o>=n.left&&o<=n.left+n.width?0:Math.abs(n.left+n.width/2-o)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusUp=function(){var e=this,t=-1,o=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(i,n){var r=-1,s=Math.floor(n.bottom),a=Math.floor(n.top),l=Math.floor(i.top);return s>l?e._shouldWrapFocus(e._activeElement,_)?E:A:((-1===t&&s<=l||a===t)&&(t=a,r=o>=n.left&&o<=n.left+n.width?0:Math.abs(n.left+n.width/2-o)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusLeft=function(e){var t=this,o=this._shouldWrapFocus(this._activeElement,I);return!!this._moveFocus((0,d.jI)(e),(function(i,n){var r=-1;return((0,d.jI)(e)?parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)):parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)))&&n.right<=i.right&&t.props.direction!==s.E.vertical?r=i.right-n.right:o||(r=A),r}),void 0,o)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusRight=function(e){var t=this,o=this._shouldWrapFocus(this._activeElement,I);return!!this._moveFocus(!(0,d.jI)(e),(function(i,n){var r=-1;return((0,d.jI)(e)?parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)):parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)))&&n.left>=i.left&&t.props.direction!==s.E.vertical?r=n.left-i.left:o||(r=A),r}),void 0,o)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusPaging=function(e,t){void 0===t&&(t=!0);var o=this._activeElement;if(!o||!this._root.current)return!1;if(this._isElementInput(o)&&!this._shouldInputLoseFocus(o,e))return!1;var i=(0,v.Hc)(o);if(!i)return!1;var n=-1,r=void 0,s=-1,a=-1,c=i.clientHeight,u=o.getBoundingClientRect();do{if(o=e?(0,l.eX)(this._root.current,o):(0,l.yv)(this._root.current,o)){var d=o.getBoundingClientRect(),g=Math.floor(d.top),h=Math.floor(u.bottom),p=Math.floor(d.bottom),f=Math.floor(u.top),m=this._getHorizontalDistanceFromCenter(e,u,d);if(e&&g>h+c||!e&&p<f-c)break;m>-1&&(e&&g>s?(s=g,n=m,r=o):!e&&p<a?(a=p,n=m,r=o):(-1===n||m<=n)&&(n=m,r=o))}}while(o);var y=!1;if(r&&r!==this._activeElement)y=!0,this.focusElement(r),this._setFocusAlignment(r,!1,!0);else if(this.props.isCircularNavigation&&t)return e?this.focusElement((0,l.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,l.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return y},t.prototype._setFocusAlignment=function(e,t,o){if(this.props.direction===s.E.bidirectional&&(!this._focusAlignment||t||o)){var i=e.getBoundingClientRect(),n=i.left+i.width/2,r=i.top+i.height/2;this._focusAlignment||(this._focusAlignment={left:n,top:r}),t&&(this._focusAlignment.left=n),o&&(this._focusAlignment.top=r)}},t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this._root.current},t.prototype._getOwnerZone=function(e){for(var t=(0,c.P)(e,P);t&&t!==this._root.current&&t!==this._getDocument().body;){if((0,l.HC)(t))return t;t=(0,c.P)(t,P)}return t},t.prototype._updateTabIndexes=function(e){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!e&&this._root.current&&(this._defaultFocusElement=null,e=this._root.current,this._activeElement&&!(0,p.s)(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!(0,l.S0)(this._activeElement,void 0,this._inShadowRoot)&&(this._activeElement=null);for(var t=e&&e.children,o=0;t&&o<t.length;o++){var i=t[o];(0,l.HC)(i)?"true"===i.getAttribute(k)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(x)&&i.setAttribute(x,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(x)&&i.setAttribute(x,"0"))):(i.getAttribute&&"false"===i.getAttribute(k)&&i.setAttribute(x,"-1"),(0,l.S0)(i,void 0,this._inShadowRoot)?this.props.disabled?i.setAttribute(x,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(x)&&i.setAttribute(x,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(x)&&i.setAttribute(x,"0")):"svg"===i.tagName&&"false"!==i.getAttribute("focusable")&&i.setAttribute("focusable","false")),this._updateTabIndexes(i)}},t.prototype._isContentEditableElement=function(e){return e&&"true"===e.getAttribute("contenteditable")},t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())},t.prototype._shouldInputLoseFocus=function(e,t){if(!this._processingTabKey&&e&&e.type&&D.indexOf(e.type.toLowerCase())>-1){var o=e.selectionStart,i=o!==e.selectionEnd,n=e.value,r=e.readOnly;if(i||o>0&&!t&&!r||o!==n.length&&t&&!r||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(e)))return!1}return!0},t.prototype._shouldWrapFocus=function(e,t){return!this.props.checkForNoWrap||(0,l._l)(e,t)},t.prototype._portalContainsElement=function(e){return e&&!!this._root.current&&(0,y.s)(e,this._root.current)},t.prototype._getDocument=function(){return(0,b.Y)(this._root.current)},t.contextType=S.c,t.defaultProps={isCircularNavigation:!1,direction:s.E.bidirectional,shouldRaiseClicks:!0,"data-tabster":'{"uncontrolled": {}}'},t}(r.Component)},88891:(e,t,o)=>{"use strict";o.d(t,{E:()=>i,l:()=>n});var i,n={none:0,all:1,inputOnly:2};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(i||(i={}))},26557:(e,t,o)=>{"use strict";o.d(t,{B:()=>r});var i=o(95734);if(3023==o.j)var n=o(7969);function r(e,t){var o=i.useRef(t);return o.current||(o.current=(0,n.O)(e)),o.current}},99269:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var i=o(95734);function n(e){var t=(0,i.useRef)();return(0,i.useEffect)((function(){t.current=e})),t.current}},46914:(e,t,o)=>{"use strict";o.d(t,{Ncu:()=>a,WG1:()=>r,pTW:()=>s,t2R:()=>n});var i=o(14774);const n=(0,i.U)("ArrowUndo16Regular","16",["M3 2.5a.5.5 0 0 1 1 0v3.84l3.17-3.17a4 4 0 0 1 5.66 5.66L7.8 13.85a.5.5 0 0 1-.7-.7l5.02-5.03a3 3 0 1 0-4.24-4.24L4.76 7H8.5a.5.5 0 0 1 0 1H3.6a.6.6 0 0 1-.6-.6V2.5Z"],{flipInRtl:!0}),r=3023==o.j?(0,i.U)("ArrowUpload16Filled","16",["M3.75 2a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5Zm4.78 2.72a.75.75 0 0 0-1.06 0L4.22 7.97a.75.75 0 0 0 1.06 1.06l1.97-1.97v6.19a.75.75 0 0 0 1.5 0V7.06l1.97 1.97a.75.75 0 1 0 1.06-1.06L8.53 4.72Z"]):null,s=3023==o.j?(0,i.U)("BookQuestionMark20Filled","20",["M6 2a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6Zm2.76 4.4a.9.9 0 0 0-.26.6.5.5 0 0 1-1 0c0-.37.14-.87.54-1.28C8.45 5.29 9.09 5 10 5c.91 0 1.55.29 1.96.72.4.41.54.91.54 1.28 0 1.05-.73 1.55-1.28 1.82a8 8 0 0 1-.39.18h-.01a5.75 5.75 0 0 0-.32.15V10a.5.5 0 0 1-1 0V9c0-.25.13-.43.24-.53.11-.1.24-.18.35-.23l.32-.15.02-.01a7 7 0 0 0 .35-.16c.45-.22.72-.47.72-.92a.9.9 0 0 0-.26-.6c-.19-.19-.55-.4-1.24-.4s-1.05.21-1.24.4ZM10 13a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"]):null,a=3023==o.j?(0,i.U)("BookQuestionMark20Regular","20",["M4 4v12c0 1.1.9 2 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2Zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8ZM8.76 6.4c.19-.19.55-.4 1.24-.4s1.05.21 1.24.4c.2.22.26.47.26.6 0 .45-.27.7-.72.92a7 7 0 0 1-.35.16l-.02.01-.32.15c-.1.05-.24.12-.35.23A.73.73 0 0 0 9.5 9v1a.5.5 0 1 0 1 0v-.85l.04-.02.28-.13h.01a8 8 0 0 0 .4-.18c.54-.27 1.27-.77 1.27-1.82 0-.37-.14-.87-.54-1.28C11.55 5.29 10.91 5 10 5c-.91 0-1.55.29-1.96.72-.4.41-.54.91-.54 1.28a.5.5 0 0 0 1 0 .9.9 0 0 1 .26-.6ZM10 13a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"]):null},91122:(e,t,o)=>{"use strict";o.d(t,{$Dw:()=>n});var i=o(14774);const n=3023==o.j?(0,i.U)("Settings16Regular","16",["M8 6a2 2 0 1 0 0 4 2 2 0 0 0 0-4ZM7 8a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm3.62-3.6a.7.7 0 0 1-.83-.57l-.26-1.42a.35.35 0 0 0-.27-.28 6.07 6.07 0 0 0-2.52 0 .35.35 0 0 0-.27.29L6.2 3.83a.71.71 0 0 1-.94.54l-1.36-.49a.36.36 0 0 0-.38.1c-.57.63-1 1.37-1.26 2.17-.05.14 0 .29.1.38l1.1.93a.7.7 0 0 1 0 1.08l-1.1.93c-.1.1-.15.24-.1.38.26.8.69 1.54 1.26 2.17.1.1.25.14.38.1l1.36-.49a.7.7 0 0 1 .94.54l.26 1.41c.02.15.13.26.27.29a6.07 6.07 0 0 0 2.52 0 .35.35 0 0 0 .27-.29l.26-1.41a.71.71 0 0 1 .94-.54l1.36.49c.13.04.28 0 .38-.1.57-.63 1-1.37 1.26-2.17a.35.35 0 0 0-.1-.38l-1.1-.93a.7.7 0 0 1 0-1.08l1.1-.93c.1-.1.15-.24.1-.38-.26-.8-.69-1.54-1.26-2.17a.36.36 0 0 0-.38-.1l-1.36.49a.71.71 0 0 1-.11.03ZM4 4.98l.94.33a1.71 1.71 0 0 0 2.25-1.3l.18-.97a5.1 5.1 0 0 1 1.26 0l.18.97a1.7 1.7 0 0 0 2.25 1.3l.94-.33c.26.33.47.7.63 1.08l-.75.64a1.7 1.7 0 0 0 0 2.6l.75.64c-.16.39-.37.75-.63 1.08l-.94-.33a1.7 1.7 0 0 0-2.25 1.3l-.18.97a5.1 5.1 0 0 1-1.26 0l-.18-.97a1.7 1.7 0 0 0-2.25-1.3l-.94.33c-.26-.33-.47-.7-.63-1.08l.75-.64a1.7 1.7 0 0 0 0-2.6l-.75-.64c.16-.39.37-.75.63-1.08Z"]):null},31248:(e,t,o)=>{"use strict";o.d(t,{_:()=>g});var i=o(95734),n=o(60171),r=o(27408),s=o(7143),a=o(54694),l=o(27760),c=o(63649);const u=(0,l.X)({base:{g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw",B7ck84d:"f1ewtqcl",mc9l5x:"f14t3ns0"},bordered:{icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"]},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},square:{},shadow:{E5pizo:"f1whvlc6"},center:{st4lth:"f1plgu50",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},contain:{st4lth:"f1kle4es",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},default:{},cover:{st4lth:"f1ps3kmd",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},none:{st4lth:"f1plgu50",Ermj5k:["f13uwng7","fjmyj0p"],Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},block:{a9b677:"fly5x3f"}},{d:[".fj3muxo{border-top-color:var(--colorNeutralStroke1);}",".f1akhkt{border-right-color:var(--colorNeutralStroke1);}",".f1lxtadh{border-left-color:var(--colorNeutralStroke1);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".f14t3ns0{display:inline-block;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1whvlc6{box-shadow:var(--shadow4);}",".f1plgu50{object-fit:none;}",".f14xojzb{object-position:center;}",".f1l02sjl{height:100%;}",".fly5x3f{width:100%;}",".f1kle4es{object-fit:contain;}",".f1ps3kmd{object-fit:cover;}",".f13uwng7{object-position:left top;}",".fjmyj0p{object-position:right top;}"]});var d=o(89161);const g=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{bordered:o=!1,fit:i="default",block:n=!1,shape:r="square",shadow:l=!1}=e;return{bordered:o,fit:i,block:n,shape:r,shadow:l,components:{root:"img"},root:s.Gk((0,a.g)("img",{ref:t,...e}),{elementType:"img"})}})(e,t);return(e=>{const t=u();e.root.className=(0,c.z)("fui-Image",t.base,e.block&&t.block,e.bordered&&t.bordered,e.shadow&&t.shadow,t[e.fit],t[e.shape],e.root.className)})(o),(0,d.$e)("useImageStyles_unstable")(o),(e=>((0,r.C)(e),(0,n.Y)(e.root,{})))(o)}));g.displayName="Image"},12908:(e,t,o)=>{"use strict";if(o.d(t,{n:()=>c}),o(95734),3023==o.j)var i=o(25386);if(3023==o.j)var n=o(59906);if(3023==o.j)var r=o(30343);if(3023==o.j)var s=o(7143);if(3023==o.j)var a=o(81585);if(3023==o.j)var l=o(79379);const c=(e,t)=>{e=(0,i.c)(e,{supportsLabelFor:!0,supportsRequired:!0,supportsSize:!0});const o=(0,l.Pv)();var c;const{size:u="medium",appearance:d=(null!==(c=o.inputDefaultAppearance)&&void 0!==c?c:"outline"),onChange:g}=e,[h,p]=(0,n.i)({state:e.value,defaultState:e.defaultValue,initialState:""}),f=(0,r.n)({props:e,primarySlotTagName:"input",excludedPropNames:["size","onChange","value","defaultValue"]}),m={size:u,appearance:d,components:{root:"span",input:"input",contentBefore:"span",contentAfter:"span"},input:s.Gk(e.input,{defaultProps:{type:"text",ref:t,...f.primary},elementType:"input"}),contentAfter:s.lq(e.contentAfter,{elementType:"span"}),contentBefore:s.lq(e.contentBefore,{elementType:"span"}),root:s.Gk(e.root,{defaultProps:f.root,elementType:"span"})};return m.input.value=h,m.input.onChange=(0,a.D)((e=>{const t=e.target.value;null==g||g(e,{value:t}),p(t)})),m}},28156:(e,t,o)=>{"use strict";o.d(t,{d:()=>h});var i=o(94664),n=o(11612),r=o(27760);if(3023==o.j)var s=o(63649);const a=(i.L.spacingHorizontalSNudge,i.L.spacingHorizontalMNudge,i.L.spacingHorizontalM,i.L.spacingHorizontalXXS,i.L.spacingHorizontalXXS,i.L.spacingHorizontalSNudge,i.L.spacingHorizontalS,i.L.spacingHorizontalM,i.L.spacingHorizontalM,i.L.spacingHorizontalSNudge,(0,n.y)("r1oeeo9n","r9sxh5",{r:[".r1oeeo9n{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r1oeeo9n::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-left-radius:var(--borderRadiusMedium);border-bottom-right-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r1oeeo9n:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r1oeeo9n:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r1oeeo9n:focus-within{outline:2px solid transparent;}",".r9sxh5{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r9sxh5::after{box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-right-radius:var(--borderRadiusMedium);border-bottom-left-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r9sxh5:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r9sxh5:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r9sxh5:focus-within{outline:2px solid transparent;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]})),l=(0,r.X)({small:{sshi5w:"f1pha7fy",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},medium:{},large:{sshi5w:"f1w5jphr",Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},outline:{},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1l4zc64",gg5e9n:["f1m52nbi","f1ub3y4t"],Drbcw7:"f8vnjqi",udz0bu:["fz1etlk","f1hc16gm"],Be8ivqh:"f1klwx88",ofdepl:["f1hc16gm","fz1etlk"]},underline:{De3pzq:"f1c21dwh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],wvpqe5:["f1deefiw","f1n71otn"],Eqx8gd:["f1n6gb5g","f15yvnhg"],B1piin3:["f15yvnhg","f1n6gb5g"]},underlineInteractive:{oetu4i:"f1l4zc64",Be8ivqh:"f1klwx88",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f2ale1x"},filled:{g2u3we:"fghlq4f",h3c5rm:["f1gn591s","fjscplz"],B9xav0g:"fb073pr",zhjwy3:["fjscplz","f1gn591s"]},filledInteractive:{q7v0qe:"ftmjh5b",kmh5ft:["f17blpuu","fsrcdbj"],nagaa4:"f1tpwn32",B1yhkcb:["fsrcdbj","f17blpuu"]},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},"filled-darker":{De3pzq:"f16xq7d1"},"filled-lighter":{De3pzq:"fxugw4r"},"filled-darker-shadow":{De3pzq:"f16xq7d1",E5pizo:"fyed02w"},"filled-lighter-shadow":{De3pzq:"fxugw4r",E5pizo:"fyed02w"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bsft5z2:"fhr9occ",Bduesf4:"f99w1ws"},smallWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},smallWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},mediumWithContentBefore:{uwmqm3:["f1ng84yb","f11gcy0p"]},mediumWithContentAfter:{z189sj:["f11gcy0p","f1ng84yb"]},largeWithContentBefore:{uwmqm3:["f1uw59to","fw5db7e"]},largeWithContentAfter:{z189sj:["fw5db7e","f1uw59to"]}},{d:[".f1pha7fy{min-height:24px;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1w5jphr{min-height:40px;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".fokr779{border-radius:0;}",{p:-1}],".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",[".f2ale1x::after{border-radius:0;}",{p:-1}],".fghlq4f{border-top-color:var(--colorTransparentStroke);}",".f1gn591s{border-right-color:var(--colorTransparentStroke);}",".fjscplz{border-left-color:var(--colorTransparentStroke);}",".fb073pr{border-bottom-color:var(--colorTransparentStroke);}",".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".fyed02w{box-shadow:var(--shadow2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fhr9occ::after{content:unset;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}"],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".ftmjh5b:hover,.ftmjh5b:focus-within{border-top-color:var(--colorTransparentStrokeInteractive);}",".f17blpuu:hover,.f17blpuu:focus-within{border-right-color:var(--colorTransparentStrokeInteractive);}",".fsrcdbj:hover,.fsrcdbj:focus-within{border-left-color:var(--colorTransparentStrokeInteractive);}",".f1tpwn32:hover,.f1tpwn32:focus-within{border-bottom-color:var(--colorTransparentStrokeInteractive);}"],a:[".f8vnjqi:active,.f8vnjqi:focus-within{border-top-color:var(--colorNeutralStroke1Pressed);}",".fz1etlk:active,.fz1etlk:focus-within{border-right-color:var(--colorNeutralStroke1Pressed);}",".f1hc16gm:active,.f1hc16gm:focus-within{border-left-color:var(--colorNeutralStroke1Pressed);}",".f1klwx88:active,.f1klwx88:focus-within{border-bottom-color:var(--colorNeutralStrokeAccessiblePressed);}"],m:[["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],w:[".f99w1ws:focus-within{outline-style:none;}"]}),c=3023==o.j?(0,n.y)("r12stul0",null,[".r12stul0{align-self:stretch;box-sizing:border-box;flex-grow:1;min-width:0;border-style:none;padding:0 var(--spacingHorizontalM);color:var(--colorNeutralForeground1);background-color:transparent;outline-style:none;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;}",".r12stul0::-webkit-input-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::-moz-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::placeholder{color:var(--colorNeutralForeground4);opacity:1;}"]):null,u=(0,r.X)({small:{uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},medium:{},large:{uwmqm3:["fnphzt9","flt1dlf"],z189sj:["flt1dlf","fnphzt9"]},smallWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},smallWithContentAfter:{z189sj:["ffczdla","fgiv446"]},mediumWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},mediumWithContentAfter:{z189sj:["ffczdla","fgiv446"]},largeWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},largeWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},disabled:{sj55zd:"f1s2aq7o",De3pzq:"f1c21dwh",Bceei9c:"fdrzuqr",yvdlaj:"fahhnxm"}},{d:[".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".fnphzt9{padding-left:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".flt1dlf{padding-right:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".fgiv446{padding-left:var(--spacingHorizontalXXS);}",".ffczdla{padding-right:var(--spacingHorizontalXXS);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fdrzuqr{cursor:not-allowed;}",".fahhnxm::-webkit-input-placeholder{color:var(--colorNeutralForegroundDisabled);}",".fahhnxm::-moz-placeholder{color:var(--colorNeutralForegroundDisabled);}"]}),d=3023==o.j?(0,n.y)("r1572tok",null,[".r1572tok{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;}",".r1572tok>svg{font-size:20px;}"]):null,g=(0,r.X)({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),h=e=>{const{size:t,appearance:o}=e,i=e.input.disabled,n="true"==`${e.input["aria-invalid"]}`,r=o.startsWith("filled"),h=l(),p=u(),f=g();e.root.className=(0,s.z)("fui-Input",a(),h[t],e.contentBefore&&h[`${t}WithContentBefore`],e.contentAfter&&h[`${t}WithContentAfter`],h[o],!i&&"outline"===o&&h.outlineInteractive,!i&&"underline"===o&&h.underlineInteractive,!i&&r&&h.filledInteractive,r&&h.filled,!i&&n&&h.invalid,i&&h.disabled,e.root.className),e.input.className=(0,s.z)("fui-Input__input",c(),p[t],e.contentBefore&&p[`${t}WithContentBefore`],e.contentAfter&&p[`${t}WithContentAfter`],i&&p.disabled,e.input.className);const m=[d(),i&&f.disabled,f[t]];return e.contentBefore&&(e.contentBefore.className=(0,s.z)("fui-Input__contentBefore",...m,e.contentBefore.className)),e.contentAfter&&(e.contentAfter.className=(0,s.z)("fui-Input__contentAfter",...m,e.contentAfter.className)),e}},88239:(e,t,o)=>{"use strict";o.d(t,{D:()=>M});var i=o(95734),n=o(7143),r=o(54694),s=o(2430),a=o(81585),l=o(99677),c=o(28687),u=o(19414),d=o(60222),g=o(87579),h=o(33122),p=o(17998),f=o(87372),m=o(34837);const v=(0,d.A)(g.oAB,g.Crl),y=(0,d.A)(g.NGN,g.nUb);var b=o(60171),S=o(27408),C=o(11612),w=o(27760),k=o(63649),T=o(1222);const x=(0,C.y)("r11normc","r1lnj0i0",{r:[".r11normc{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-right:var(--spacingVerticalSNudge);padding-left:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r11normc:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r11normc:hover .fui-Icon-filled{display:inline;}",".r11normc:hover .fui-Icon-regular{display:none;}",".r11normc:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r11normc:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r11normc:focus{outline-style:none;}",".r11normc:focus-visible{outline-style:none;}",".r11normc[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.r11normc[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".r1lnj0i0{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-left:var(--spacingVerticalSNudge);padding-right:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r1lnj0i0:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r1lnj0i0:hover .fui-Icon-filled{display:inline;}",".r1lnj0i0:hover .fui-Icon-regular{display:none;}",".r1lnj0i0:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r1lnj0i0:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r1lnj0i0:focus{outline-style:none;}",".r1lnj0i0:focus-visible{outline-style:none;}",".r1lnj0i0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.r1lnj0i0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:['@media (forced-colors: active){.r11normc:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r11normc:focus{outline-style:none;}.r11normc:focus-visible{outline-style:none;}.r11normc[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}@media (forced-colors: active){.r11normc[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}.r11normc[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}}',"@media (forced-colors: active){.r11normc[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}",'@media (forced-colors: active){.r1lnj0i0:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r1lnj0i0:focus{outline-style:none;}.r1lnj0i0:focus-visible{outline-style:none;}.r1lnj0i0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}@media (forced-colors: active){.r1lnj0i0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}.r1lnj0i0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}}',"@media (forced-colors: active){.r1lnj0i0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),_=(0,C.y)("r1ls86vo","rpbc5dr",[".r1ls86vo{padding-left:2px;padding-right:2px;background-color:transparent;flex-grow:1;}",".rpbc5dr{padding-right:2px;padding-left:2px;background-color:transparent;flex-grow:1;}"]),I=(0,C.y)("r12mwwux","r1ewgu5j",[".r12mwwux{padding-left:2px;padding-right:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r12mwwux:hover{color:var(--colorNeutralForeground3Hover);}",".r12mwwux:focus{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j{padding-right:2px;padding-left:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r1ewgu5j:hover{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j:focus{color:var(--colorNeutralForeground3Hover);}"]),E=(0,C.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),A=(0,C.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),B=(0,w.X)({checkmark:{B6of3ja:"fmnzpld"},splitItemMain:{Bh6795r:"fqerorx"},splitItemTrigger:{Btl43ni:["f1ozlkrg","f10ostut"],Beyfa6y:["f1deotkl","f1krrbdw"],uwmqm3:["f1cnd47f","fhxju0i"],Ftih45:"f1wl9k8s",Ccq8qp:"f1yn80uh",Baz25je:"f68mna0",cmx5o7:"f1p5zmk"},disabled:{sj55zd:"f1s2aq7o",Bi91k9c:"fvgxktp",Jwef8y:"f1ijtazh",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bg7n49j:"f1q1x1ba",B2d53fq:"fcvwxyo",iro3zm:"f1to34ca",t0hwav:"ft33916",Bbusuzp:"f1dcs8yz",ze5xyy:"f1kc2mi9",Bqrx1nm:"fkavljg",Bctn1xl:"fk56vqo",h5esng:"ff3wi9b",Bh6z0a4:"f1ikwg0d",Bh953qp:"f10l1t5h"}},{d:[".fmnzpld{margin-top:2px;}",".fqerorx{flex-grow:1;}",".f1ozlkrg{border-top-left-radius:0;}",".f10ostut{border-top-right-radius:0;}",".f1deotkl{border-bottom-left-radius:0;}",".f1krrbdw{border-bottom-right-radius:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}",'.f1wl9k8s::before{content:"";}',".f1yn80uh::before{width:var(--strokeWidthThin);}",".f68mna0::before{height:24px;}",".f1p5zmk::before{background-color:var(--colorNeutralStroke1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"],h:[".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1ijtazh:hover{background-color:var(--colorNeutralBackground1);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1q1x1ba:hover .fui-MenuItem__icon{color:var(--colorNeutralForegroundDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f1to34ca:hover:active{background-color:var(--colorNeutralBackground1);}"],f:[".ft33916:focus{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkavljg:hover{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fk56vqo:hover .fui-MenuItem__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff3wi9b:hover .fui-MenuItem__icon{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ikwg0d:focus{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f10l1t5h:focus{background-color:Canvas;}}",{m:"(forced-colors: active)"}]]});var R=o(89161);const M=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,u.T)(),d=(0,p.tv)((e=>e.persistOnItemClick)),{as:g="div",disabled:b=!1,hasSubmenu:S=o,persistOnClick:C=d}=e,w=(0,h.f_)((e=>e.hasIcons)),k=(0,h.f_)((e=>e.hasCheckmarks)),T=(0,p.tv)((e=>e.setOpen)),{dir:x}=(0,l.Y)(),_=i.useRef(null),I=i.useRef(!1),E={hasSubmenu:S,disabled:b,persistOnClick:C,components:{root:"div",icon:"span",checkmark:"span",submenuIndicator:"span",content:"span",secondaryContent:"span"},root:n.Gk((0,r.g)(g,(0,f.F)(g,{role:"menuitem",...e,disabled:!1,disabledFocusable:b,ref:(0,s.a)(t,_),onKeyDown:(0,a.D)((t=>{var o;null===(o=e.onKeyDown)||void 0===o||o.call(e,t),t.isDefaultPrevented()||t.key!==m.$xS&&t.key!==m.xyI||(I.current=!0)})),onMouseEnter:(0,a.D)((t=>{var o,i;null===(o=_.current)||void 0===o||o.focus(),null===(i=e.onMouseEnter)||void 0===i||i.call(e,t)})),onClick:(0,a.D)((t=>{var o;S||C||(T(t,{open:!1,keyboard:I.current,bubble:!0,type:"menuItemClick",event:t}),I.current=!1),null===(o=e.onClick)||void 0===o||o.call(e,t)}))})),{elementType:"div"}),icon:n.lq(e.icon,{renderByDefault:w,elementType:"span"}),checkmark:n.lq(e.checkmark,{renderByDefault:k,elementType:"span"}),submenuIndicator:n.lq(e.submenuIndicator,{renderByDefault:S,defaultProps:{children:"ltr"===x?i.createElement(v,null):i.createElement(y,null)},elementType:"span"}),content:n.lq(e.content,{renderByDefault:!!e.children,defaultProps:{children:e.children},elementType:"span"}),secondaryContent:n.lq(e.secondaryContent,{elementType:"span"})};return(0,c.t)(E,_),E})(e,t);return(e=>{const t=B(),o=x(),i=_(),n=I(),r=E(),s=A();e.root.className=(0,k.z)("fui-MenuItem",o,e.disabled&&t.disabled,e.root.className),e.content&&(e.content.className=(0,k.z)("fui-MenuItem__content",i,e.content.className)),e.checkmark&&(e.checkmark.className=(0,k.z)("fui-MenuItem__checkmark",t.checkmark,e.checkmark.className)),e.secondaryContent&&(e.secondaryContent.className=(0,k.z)("fui-MenuItem__secondaryContent",!e.disabled&&n,e.secondaryContent.className)),e.icon&&(e.icon.className=(0,k.z)("fui-MenuItem__icon",r,e.icon.className)),e.submenuIndicator&&(e.submenuIndicator.className=(0,k.z)("fui-MenuItem__submenuIndicator",s,e.submenuIndicator.className)),(0,T.Y)(e)})(o),(0,R.$e)("useMenuItemStyles_unstable")(o),(e=>((0,S.C)(e),(0,b.FD)(e.root,{children:[e.checkmark&&(0,b.Y)(e.checkmark,{}),e.icon&&(0,b.Y)(e.icon,{}),e.content&&(0,b.Y)(e.content,{}),e.secondaryContent&&(0,b.Y)(e.secondaryContent,{}),e.submenuIndicator&&(0,b.Y)(e.submenuIndicator,{})]})))(o)}));M.displayName="MenuItem"},28687:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>n}),o(95734),3023==o.j)var i=o(33122);const n=(e,t)=>{const o=(0,i.f_)((e=>e.setFocusByFirstCharacter)),{onKeyDown:n}=e.root;return e.root.onKeyDown=e=>{var i;null==n||n(e),(null===(i=e.key)||void 0===i?void 0:i.length)>1||t.current&&(null==o||o(e,t.current))},e}},30850:(e,t,o)=>{"use strict";o.d(t,{c:()=>w});var i=o(95734),n=o(59906),r=o(81585),s=o(7143),a=o(54694),l=o(2430),c=o(68436),u=o(84027),d=o(30862),g=o(99677),h=o(12411),p=o(17998);var f=o(60171),m=o(27408),v=o(33122),y=o(27760),b=o(63649);const S=(0,y.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",i8kkvl:0,Belr9w4:0,rmohyg:"f1t6b6ee"},hasMenuContext:{Bqenvij:"f1l02sjl"}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",[".f1t6b6ee{gap:2px;}",{p:-1}],".f1l02sjl{height:100%;}"]});var C=o(89161);const w=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{findAllFocusable:o}=(0,c.r)(),{targetDocument:f}=(0,g.Y)(),m={checkedValues:(0,p.tv)((e=>e.checkedValues)),onCheckedValueChange:(0,p.tv)((e=>e.onCheckedValueChange)),triggerId:(0,p.tv)((e=>e.triggerId)),hasIcons:(0,p.tv)((e=>e.hasIcons)),hasCheckmarks:(0,p.tv)((e=>e.hasCheckmarks))},v=(0,h.V)(p.xu),y=(0,u.i)({circular:!0});((e,t,o)=>{let i=!1;for(const o in t)e[o]&&(i=!0);return o&&i})(e,m,v)&&console.warn("You are using both MenuList and Menu props, we recommend you to use Menu props when available");const b=i.useRef(null);i.useEffect((()=>{const e=b.current;if(v&&f&&e){const t=t=>{const o=t.detail.next;o&&e.contains(f.activeElement)&&!e.contains(o)&&t.preventDefault()};return f.addEventListener(d.GD,t),()=>{f.removeEventListener(d.GD,t)}}}),[b,f,v]);const S=i.useCallback(((e,t)=>{const i=["menuitem","menuitemcheckbox","menuitemradio"];if(!b.current)return;const n=o(b.current,(e=>e.hasAttribute("role")&&-1!==i.indexOf(e.getAttribute("role"))));let r=n.indexOf(t)+1;r===n.length&&(r=0);const s=n.map((e=>{var t;return null===(t=e.textContent)||void 0===t?void 0:t.charAt(0).toLowerCase()})),a=e.key.toLowerCase(),l=(e,t)=>{for(let t=e;t<s.length;t++)if(a===s[t])return t;return-1};let c=l(r);-1===c&&(c=l(0)),c>-1&&n[c].focus()}),[o]);var C;const[w,k]=(0,n.i)({state:null!==(C=e.checkedValues)&&void 0!==C?C:v?m.checkedValues:void 0,defaultState:e.defaultCheckedValues,initialState:{}});var T;const x=null!==(T=e.onCheckedValueChange)&&void 0!==T?T:v?m.onCheckedValueChange:void 0,_=(0,r.D)(((e,t,o,i)=>{const n=[...(null==w?void 0:w[t])||[]];i?n.splice(n.indexOf(o),1):n.push(o),null==x||x(e,{name:t,checkedItems:n}),k((e=>({...e,[t]:n})))})),I=(0,r.D)(((e,t,o)=>{const i=[o];k((e=>({...e,[t]:i}))),null==x||x(e,{name:t,checkedItems:i})}));return{components:{root:"div"},root:s.Gk((0,a.g)("div",{ref:(0,l.a)(t,b),role:"menu","aria-labelledby":m.triggerId,...y,...e}),{elementType:"div"}),hasIcons:m.hasIcons||!1,hasCheckmarks:m.hasCheckmarks||!1,checkedValues:w,hasMenuContext:v,setFocusByFirstCharacter:S,selectRadio:I,toggleCheckbox:_}})(e,t),y=function(e){const{checkedValues:t,hasCheckmarks:o,hasIcons:i,selectRadio:n,setFocusByFirstCharacter:r,toggleCheckbox:s}=e;return{menuList:{checkedValues:t,hasCheckmarks:o,hasIcons:i,selectRadio:n,setFocusByFirstCharacter:r,toggleCheckbox:s}}}(o);return(e=>{const t=S();e.root.className=(0,b.z)("fui-MenuList",t.root,e.hasMenuContext&&t.hasMenuContext,e.root.className)})(o),(0,C.$e)("useMenuListStyles_unstable")(o),((e,t)=>((0,m.C)(e),(0,f.Y)(v.j4,{value:t.menuList,children:(0,f.Y)(e.root,{})})))(o,y)}));w.displayName="MenuList"},62611:(e,t,o)=>{"use strict";o.d(t,{b:()=>w});var i=o(95734),n=o(34837),r=o(82261),s=o(7143),a=o(54694),l=o(2430),c=o(81585),u=o(17998),d=o(76),g=o(99677),h=o(97553),p=o(21955),f=o(27760),m=o(63649);const v=(0,f.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",De3pzq:"fxugw4r",sj55zd:"f19n0e5",B7ck84d:"f1ewtqcl",Bf4jedk:"fl8fusi",B2u0y6b:"f1kaai3v",B68tc82:"f1p9o1ba",a9b677:"f1ahpp82",E5pizo:"f1hg901r",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fd3pd8h",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f18k4bn6",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",Bvtglag:"fjp4h9y"}},{d:[[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1ewtqcl{box-sizing:border-box;}",".fl8fusi{min-width:138px;}",".f1kaai3v{max-width:300px;}",".f1p9o1ba{overflow-x:hidden;}",".f1ahpp82{width:max-content;}",".f1hg901r{box-shadow:var(--shadow16);}",[".fd3pd8h{padding:4px;}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f18k4bn6{animation-composition:accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}"],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]});var y=o(60171),b=o(27408),S=o(24396),C=o(89161);const w=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,u.tv)((e=>e.menuPopoverRef)),f=(0,u.tv)((e=>e.setOpen)),m=(0,u.tv)((e=>e.open)),v=(0,u.tv)((e=>e.openOnHover)),y=(0,u.tv)((e=>e.triggerRef)),b=(0,h.R)(),S=i.useRef(!0),C=(0,p.P)(),[w,k]=(0,r.Z)(),{dir:T}=(0,g.Y)(),x="ltr"===T?n.nkM:n.Qpb,_=i.useCallback((e=>{e&&e.addEventListener("mouseover",(e=>{S.current&&(S.current=!1,(0,d.uD)(o.current,e),w((()=>S.current=!0),250))}))}),[o,w]);var I;i.useEffect((()=>{}),[k]);const E=null!==(I=(0,u.tv)((e=>e.inline)))&&void 0!==I&&I,A=(0,u.tv)((e=>e.mountNode)),B=s.Gk((0,a.g)("div",{role:"presentation",...C,...e,ref:(0,l.a)(t,o,_)}),{elementType:"div"}),{onMouseEnter:R,onKeyDown:M}=B;return B.onMouseEnter=(0,c.D)((e=>{(v||b)&&f(e,{open:!0,keyboard:!1,type:"menuPopoverMouseEnter",event:e}),null==R||R(e)})),B.onKeyDown=(0,c.D)((e=>{const t=e.key;var i,r;(t===n.uf9||b&&t===x)&&m&&(null===(i=o.current)||void 0===i?void 0:i.contains(e.target))&&!e.isDefaultPrevented()&&(f(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),e.preventDefault()),t===n.ozo&&(f(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),b||null===(r=y.current)||void 0===r||r.focus()),null==M||M(e)})),{inline:E,mountNode:A,components:{root:"div"},root:B}})(e,t);return(e=>{const t=v();e.root.className=(0,m.z)("fui-MenuPopover",t.root,e.root.className)})(o),(0,C.$e)("useMenuPopoverStyles_unstable")(o),(e=>((0,b.C)(e),e.inline?(0,y.Y)(e.root,{}):(0,y.Y)(S.Z,{mountNode:e.mountNode,children:(0,y.Y)(e.root,{})})))(o)}));w.displayName="MenuPopover"},62956:(e,t,o)=>{"use strict";o.d(t,{c:()=>y});var i=o(95734),n=o(17998),r=o(97553),s=o(68436),a=o(99677),l=o(34837),c=o(81461),u=o(2430),d=o(81585),g=o(45896),h=o(67719),p=o(58013),f=o(87372);const m=e=>{const t=e=>e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&"true"===e.getAttribute("aria-disabled");return!(!(0,p.s)(e.target)||!t(e.target))||(0,p.s)(e.currentTarget)&&t(e.currentTarget)};var v=o(19414);const y=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:o=!1}=e,p=(0,n.tv)((e=>e.triggerRef)),v=(0,n.tv)((e=>e.menuPopoverRef)),y=(0,n.tv)((e=>e.setOpen)),b=(0,n.tv)((e=>e.open)),S=(0,n.tv)((e=>e.triggerId)),C=(0,n.tv)((e=>e.openOnHover)),w=(0,n.tv)((e=>e.openOnContext)),k=(0,r.R)(),{findFirstFocusable:T}=(0,s.r)(),x=i.useCallback((()=>{const e=T(v.current);null==e||e.focus()}),[T,v]),_=i.useRef(!1),I=i.useRef(!1),{dir:E}=(0,a.Y)(),A="ltr"===E?l.Qpb:l.nkM,B=(0,c.h)(t),R={id:S,...null==B?void 0:B.props,ref:(0,u.a)(p,null==B?void 0:B.ref),onMouseEnter:(0,d.D)((0,g.p)(null==B?void 0:B.props.onMouseEnter,(e=>{m(e)||C&&I.current&&y(e,{open:!0,keyboard:!1,type:"menuTriggerMouseEnter",event:e})}))),onMouseLeave:(0,d.D)((0,g.p)(null==B?void 0:B.props.onMouseLeave,(e=>{m(e)||C&&y(e,{open:!1,keyboard:!1,type:"menuTriggerMouseLeave",event:e})}))),onContextMenu:(0,d.D)((0,g.p)(null==B?void 0:B.props.onContextMenu,(e=>{m(e)||e.isDefaultPrevented()||w&&(e.preventDefault(),y(e,{open:!0,keyboard:!1,type:"menuTriggerContextMenu",event:e}))}))),onMouseMove:(0,d.D)((0,g.p)(null==B?void 0:B.props.onMouseMove,(e=>{m(e)||C&&!I.current&&(y(e,{open:!0,keyboard:!1,type:"menuTriggerMouseMove",event:e}),I.current=!0)})))},M={"aria-haspopup":"menu","aria-expanded":b||k?b:void 0,...R,onClick:(0,d.D)((0,g.p)(null==B?void 0:B.props.onClick,(e=>{m(e)||w||(y(e,{open:!b,keyboard:_.current,type:"menuTriggerClick",event:e}),_.current=!1)}))),onKeyDown:(0,d.D)((0,g.p)(null==B?void 0:B.props.onKeyDown,(e=>{if(m(e))return;const t=e.key;!w&&(k&&t===A||!k&&t===l.yd$)&&y(e,{open:!0,keyboard:!0,type:"menuTriggerKeyDown",event:e}),t!==l.uf9||k||y(e,{open:!1,keyboard:!0,type:"menuTriggerKeyDown",event:e}),b&&t===A&&k&&x()})))},D=(0,f.F)("button"===(null==B?void 0:B.type)||"a"===(null==B?void 0:B.type)?B.type:"div",M);return{isSubmenu:k,children:(0,h.L)(t,w?R:o?M:D)}})(e);return(e=>i.createElement(v._,{value:e.isSubmenu},e.children))(t)};y.displayName="MenuTrigger",y.isFluentTriggerComponent=!0},7926:(e,t,o)=>{"use strict";o.d(t,{W:()=>C});var i=o(95734),n=o(22302),r=o(17142),s=o(64686),a=o(49749),l=o(59906),c=o(81585),u=o(82261),d=o(44854),g=o(65373),h=o(53657),p=o(62987),f=o(99677),m=o(68436),v=o(17998),y=o(76),b=o(97553);const S=["after","after-bottom","before-top","before","before-bottom","above"],C=e=>{const t=(e=>{const t=(0,b.R)(),{hoverDelay:o=500,inline:C=!1,hasCheckmarks:w=!1,hasIcons:k=!1,closeOnScroll:T=!1,openOnContext:x=!1,persistOnItemClick:_=!1,openOnHover:I=t,defaultCheckedValues:E,mountNode:A=null}=e,B=(0,a.Bi)("menu"),[R,M]=(0,n.N)(),D={position:t?"after":"below",align:t?"top":"start",target:e.openOnContext?R:void 0,fallbackPositions:t?S:void 0,...(0,r.P)(e.positioning)},P=i.Children.toArray(e.children);let N,F;2===P.length?(N=P[0],F=P[1]):1===P.length&&(F=P[0]);const{targetRef:O,containerRef:j}=(0,s.T)(D),[q,L]=(e=>{const{targetDocument:t}=(0,f.Y)(),o=(0,v.tv)((e=>e.setOpen)),n=(0,c.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),r=i.useRef(!1),[s,a]=(0,l.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1}),b=(0,c.D)(((t,i)=>{const r=t instanceof CustomEvent&&t.type===y.C4?t.detail.nativeEvent:t;null==n||n(r,{...i}),i.open&&"contextmenu"===t.type&&e.setContextTarget(t),i.open||e.setContextTarget(void 0),i.bubble&&o(t,{...i}),a(i.open)})),[S,C]=(0,u.Z)(),w=(0,c.D)(((t,o)=>{var i;C(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type||"mouseenter"===t.type||"mousemove"===t.type||t.type===y.C4?((null===(i=e.triggerRef.current)||void 0===i?void 0:i.contains(t.target))&&(r.current="mouseenter"===t.type||"mousemove"===t.type),S((()=>b(t,o)),e.hoverDelay)):b(t,o)}));(0,d.W)({contains:g.s,disabled:!s,element:t,refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),callback:e=>w(e,{open:!1,type:"clickOutside",event:e})});const k=e.openOnContext||e.closeOnScroll;(0,h.z)({contains:g.s,element:t,callback:e=>w(e,{open:!1,type:"scrollOutside",event:e}),refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),disabled:!s||!k}),(0,y.Ji)({element:t,callback:e=>{r.current||w(e,{open:!1,type:"menuMouseEnter",event:e})},disabled:!s,refs:[e.menuPopoverRef]});const{findFirstFocusable:T}=(0,m.r)(),x=i.useCallback((()=>{const t=T(e.menuPopoverRef.current);null==t||t.focus()}),[T,e.menuPopoverRef]),_=(0,p.t)();return i.useEffect((()=>{var o;s?x():_||(null==t?void 0:t.activeElement)===(null==t?void 0:t.body)&&(null===(o=e.triggerRef.current)||void 0===o||o.focus())}),[e.triggerRef,e.isSubmenu,s,x,t,e.menuPopoverRef]),[s,w]})({hoverDelay:o,isSubmenu:t,setContextTarget:M,closeOnScroll:T,menuPopoverRef:j,triggerRef:O,open:e.open,defaultOpen:e.defaultOpen,onOpenChange:e.onOpenChange,openOnContext:x}),[H,z]=(e=>{const[t,o]=(0,l.i)({state:e.checkedValues,defaultState:e.defaultCheckedValues,initialState:{}});return[t,(0,c.D)(((t,{name:i,checkedItems:n})=>{var r;null===(r=e.onCheckedValueChange)||void 0===r||r.call(e,t,{name:i,checkedItems:n}),o((e=>({...e,[i]:n})))}))]})({checkedValues:e.checkedValues,defaultCheckedValues:E,onCheckedValueChange:e.onCheckedValueChange});return{inline:C,hoverDelay:o,triggerId:B,isSubmenu:t,openOnHover:I,contextTarget:R,setContextTarget:M,hasCheckmarks:w,hasIcons:k,closeOnScroll:T,menuTrigger:N,menuPopover:F,mountNode:A,triggerRef:O,menuPopoverRef:j,components:{},openOnContext:x,open:q,setOpen:L,checkedValues:H,onCheckedValueChange:z,persistOnItemClick:_}})(e),o=function(e){const{checkedValues:t,hasCheckmarks:o,hasIcons:i,inline:n,isSubmenu:r,menuPopoverRef:s,mountNode:a,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:g,setOpen:h,triggerId:p,triggerRef:f}=e;return{menu:{checkedValues:t,hasCheckmarks:o,hasIcons:i,inline:n,isSubmenu:r,menuPopoverRef:s,mountNode:a,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:g,setOpen:h,triggerId:p,triggerRef:f}}}(t);return((e,t)=>i.createElement(v.BV,{value:t.menu},e.menuTrigger,e.open&&e.menuPopover))(t,o)};C.displayName="Menu"},17998:(e,t,o)=>{"use strict";o.d(t,{BV:()=>a,tv:()=>l,xu:()=>r}),o(95734);var i=o(88256);if(3023==o.j)var n=o(43080);const r=(0,i.q)(void 0),s={open:!1,setOpen:()=>!1,checkedValues:{},onCheckedValueChange:()=>null,isSubmenu:!1,triggerRef:{current:null},menuPopoverRef:{current:null},mountNode:null,triggerId:"",openOnContext:!1,openOnHover:!1,hasIcons:!1,hasCheckmarks:!1,inline:!1,persistOnItemClick:!1},a=r.Provider,l=e=>(0,n.i)(r,((t=s)=>e(t)))},33122:(e,t,o)=>{"use strict";o.d(t,{VU:()=>r,f_:()=>l,j4:()=>a}),o(95734);var i=o(88256);if(3023==o.j)var n=o(43080);const r=(0,i.q)(void 0),s={checkedValues:{},setFocusByFirstCharacter:()=>null,toggleCheckbox:()=>null,selectRadio:()=>null,hasIcons:!1,hasCheckmarks:!1},a=r.Provider,l=e=>(0,n.i)(r,((t=s)=>e(t)))},19414:(e,t,o)=>{"use strict";o.d(t,{T:()=>s,_:()=>r});var i=o(95734);const n=i.createContext(void 0),r=n.Provider,s=()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e&&e}},1222:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(27760);if(3023==o.j)var n=o(63649);const r=(0,i.X)({root:{a9b677:"fjw5fx7",Bqenvij:"fd461yt",Bcdw1i0:"fd7fpy0"},rootChecked:{Bcdw1i0:"f1022m68"}},{d:[".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".fd7fpy0{visibility:hidden;}",".f1022m68{visibility:visible;}"]}),s=e=>{const t=r();e.checkmark&&(e.checkmark.className=(0,n.z)(t.root,e.checked&&t.rootChecked,e.checkmark.className))}},97553:(e,t,o)=>{"use strict";if(o.d(t,{R:()=>s}),3023==o.j)var i=o(12411);if(3023==o.j)var n=o(17998);if(3023==o.j)var r=o(33122);function s(){const e=(0,n.tv)((e=>e.isSubmenu)),t=(0,i.V)(r.VU);return e||t}},76:(e,t,o)=>{"use strict";o.d(t,{C4:()=>s,Ji:()=>a,uD:()=>l});var i=o(95734);if(3023==o.j)var n=o(81585);if(3023==o.j)var r=o(65373);const s="fuimenuenter",a=e=>{const{refs:t,callback:o,element:a,disabled:l}=e,c=(0,n.D)((e=>{const i=t[0],n=e.target;var s;!(0,r.s)(null!==(s=i.current)&&void 0!==s?s:null,n)&&!l&&o(e)}));i.useEffect((()=>{if(null!=a)return l||a.addEventListener(s,c),()=>{a.removeEventListener(s,c)}}),[c,a,l])},l=(e,t)=>{e.dispatchEvent(new CustomEvent(s,{bubbles:!0,detail:{nativeEvent:t}}))}},17307:(e,t,o)=>{"use strict";o.d(t,{I:()=>i});const i=(0,o(27760).X)({overflowMenu:{Brvla84:"fyfkpbf"},overflowingItems:{zb22lx:"f10570jf"}},{d:[".fyfkpbf [data-overflow-menu]{flex-shrink:0;}",".f10570jf [data-overflowing]{display:none;}"]})},79214:(e,t,o)=>{"use strict";o.d(t,{K7:()=>n,My:()=>s,Od:()=>r,Wg:()=>i});const i="data-overflowing",n="data-overflow-item",r="data-overflow-menu",s="data-overflow-divider"},51882:(e,t,o)=>{"use strict";o.d(t,{J:()=>a,a:()=>r});var i=o(88256);if(3023==o.j)var n=o(43080);const r=(0,i.q)(void 0),s={itemVisibility:{},groupVisibility:{},hasOverflow:!1,registerItem:()=>()=>null,updateOverflow:()=>null,registerOverflowMenu:()=>()=>null,registerDivider:()=>()=>null},a=e=>(0,n.i)(r,((t=s)=>e(t)))},60803:(e,t,o)=>{"use strict";o.d(t,{K:()=>g,f:()=>d});var i=o(95734);if(3023==o.j)var n=o(61201);if(3023==o.j)var r=o(81585);if(3023==o.j)var s=o(62987);if(3023==o.j)var a=o(22756);if(3023==o.j)var l=o(47586);if(3023==o.j)var c=o(79214);const u=()=>null,d=(e,t)=>{const{overflowAxis:o="horizontal",overflowDirection:d="end",padding:g=10,minimumVisible:h=0,onUpdateItemVisibility:p=u}=t,f=(0,r.D)(e),m=i.useMemo((()=>({overflowAxis:o,overflowDirection:d,padding:g,minimumVisible:h,onUpdateItemVisibility:p,onUpdateOverflow:f})),[h,p,o,d,g,f]),v=(0,s.t)(),y=i.useRef(null),[b,S]=i.useState((()=>(0,a.S)()?(0,n.A)():null));return(0,l.E)((()=>{v&&y.current&&(null==b||b.observe(y.current,m))}),[v,b,m]),(0,l.E)((()=>{if(!y.current||!(0,a.S)()||v)return;const e=(0,n.A)();e.observe(y.current,m),S(e)}),[m]),i.useEffect((()=>()=>{null==b||b.disconnect()}),[b]),{registerItem:i.useCallback((e=>(null==b||b.addItem(e),e.element.setAttribute(c.K7,""),()=>{e.element.removeAttribute(c.Wg),e.element.removeAttribute(c.K7),null==b||b.removeItem(e.id)})),[b]),registerDivider:i.useCallback((e=>{const t=e.element;return null==b||b.addDivider(e),t.setAttribute(c.My,""),()=>{e.groupId&&(null==b||b.removeDivider(e.groupId)),t.removeAttribute(c.My)}}),[b]),registerOverflowMenu:i.useCallback((e=>(null==b||b.addOverflowMenu(e),e.setAttribute(c.Od,""),()=>{null==b||b.removeOverflowMenu(),e.removeAttribute(c.Od)})),[b]),updateOverflow:i.useCallback((()=>{null==b||b.update()}),[b]),containerRef:y}},g=({item:e,visible:t})=>{t?e.element.removeAttribute(c.Wg):e.element.setAttribute(c.Wg,"")}},49463:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>n}),3023==o.j)var i=o(51882);const n=()=>(0,i.J)((e=>Object.entries(e.itemVisibility).reduce(((e,[t,o])=>(o||e++,e)),0)))},73900:(e,t,o)=>{"use strict";o.d(t,{H:()=>p});var i=o(95734),n=o(7143),r=o(54694),s=o(2430),a=o(13285),l=o(58085),c=o(60171),u=o(27408),d=o(24396),g=o(97988),h=o(89161);const p=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,l.pO)((e=>e.contentRef)),i=(0,l.pO)((e=>e.openOnHover)),c=(0,l.pO)((e=>e.setOpen)),u=(0,l.pO)((e=>e.mountNode)),d=(0,l.pO)((e=>e.arrowRef)),g=(0,l.pO)((e=>e.size)),h=(0,l.pO)((e=>e.withArrow)),p=(0,l.pO)((e=>e.appearance)),f=(0,l.pO)((e=>e.trapFocus)),m=(0,l.pO)((e=>e.inertTrapFocus)),v=(0,l.pO)((e=>e.inline)),{modalAttributes:y}=(0,a.y)({trapFocus:f,legacyTrapFocus:!m,alwaysFocusable:!f}),b={inline:v,appearance:p,withArrow:h,size:g,arrowRef:d,mountNode:u,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:(0,s.a)(t,o),role:f?"dialog":"group","aria-modal":!!f||void 0,...y,...e}),{elementType:"div"})},{onMouseEnter:S,onMouseLeave:C,onKeyDown:w}=b.root;return b.root.onMouseEnter=e=>{i&&c(e,!0),null==S||S(e)},b.root.onMouseLeave=e=>{i&&c(e,!1),null==C||C(e)},b.root.onKeyDown=e=>{var t;"Escape"===e.key&&(null===(t=o.current)||void 0===t?void 0:t.contains(e.target))&&(e.preventDefault(),c(e,!1)),null==w||w(e)},b})(e,t);return(0,g.Ls)(o),(0,h.$e)("usePopoverSurfaceStyles_unstable")(o),(e=>{(0,u.C)(e);const t=(0,c.FD)(e.root,{children:[e.withArrow&&(0,c.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.root.children]});return e.inline?t:(0,c.Y)(d.Z,{mountNode:e.mountNode,children:t})})(o)}));p.displayName="PopoverSurface"},97988:(e,t,o)=>{"use strict";o.d(t,{Ls:()=>a,aT:()=>r});var i=o(27760);if(3023==o.j)var n=o(63649);const r={small:6,medium:8,large:8},s=(0,i.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f18k4bn6",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",Bvtglag:"fjp4h9y",Bhu2qc9:"fymb6k8"},inline:{Bj3rh1h:"f19g0ac"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},brand:{De3pzq:"ffp7eso",sj55zd:"f1phragk"},smallPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1sy4kr4"},mediumPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4zyqsv"},largePadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fop8ug2"},smallArrow:{rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz"},mediumLargeArrow:{rhnwrx:"f1f72gjr",Bdy53xb:"f69yoe5"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f18k4bn6{animation-composition:accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}",".fymb6k8{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 8px 16px var(--colorNeutralShadowKey));}",".f19g0ac{z-index:1;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",[".f1sy4kr4{padding:12px;}",{p:-1}],[".f4zyqsv{padding:16px;}",{p:-1}],[".fop8ug2{padding:20px;}",{p:-1}],".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1f72gjr{--fui-positioning-arrow-height:11.312px;}",".f69yoe5{--fui-positioning-arrow-offset:-5.656px;}",".f1ewtqcl{box-sizing:border-box;}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}'],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]}),a=e=>{const t=s();return e.root.className=(0,n.z)("fui-PopoverSurface",t.root,e.inline&&t.inline,"small"===e.size&&t.smallPadding,"medium"===e.size&&t.mediumPadding,"large"===e.size&&t.largePadding,"inverted"===e.appearance&&t.inverted,"brand"===e.appearance&&t.brand,e.root.className),e.arrowClassName=(0,n.z)(t.arrow,"small"===e.size?t.smallArrow:t.mediumLargeArrow),e}},47982:(e,t,o)=>{"use strict";o.d(t,{W:()=>g}),o(95734);var i=o(81461),n=o(81585),r=o(45896),s=o(2430),a=o(67719),l=o(13285),c=o(58085),u=o(87372),d=o(34837);const g=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:o=!1}=e,g=(0,i.h)(t),h=(0,c.pO)((e=>e.open)),p=(0,c.pO)((e=>e.setOpen)),f=(0,c.pO)((e=>e.toggleOpen)),m=(0,c.pO)((e=>e.triggerRef)),v=(0,c.pO)((e=>e.openOnHover)),y=(0,c.pO)((e=>e.openOnContext)),{triggerAttributes:b}=(0,l.y)(),S={...b,"aria-expanded":`${h}`,...null==g?void 0:g.props,onMouseEnter:(0,n.D)((0,r.p)(null==g?void 0:g.props.onMouseEnter,(e=>{v&&p(e,!0)}))),onMouseLeave:(0,n.D)((0,r.p)(null==g?void 0:g.props.onMouseLeave,(e=>{v&&p(e,!1)}))),onContextMenu:(0,n.D)((0,r.p)(null==g?void 0:g.props.onContextMenu,(e=>{y&&(e.preventDefault(),p(e,!0))}))),ref:(0,s.a)(m,null==g?void 0:g.ref)},C={...S,onClick:(0,n.D)((0,r.p)(null==g?void 0:g.props.onClick,(e=>{y||f(e)}))),onKeyDown:(0,n.D)((0,r.p)(null==g?void 0:g.props.onKeyDown,(e=>{e.key===d.uf9&&h&&!e.isDefaultPrevented()&&(p(e,!1),e.preventDefault())})))},w=(0,u.F)("button"===(null==g?void 0:g.type)||"a"===(null==g?void 0:g.type)?g.type:"div",C);return{children:(0,a.L)(e.children,(0,u.F)("button"===(null==g?void 0:g.type)||"a"===(null==g?void 0:g.type)?g.type:"div",y?S:o?C:w))}})(e);return(e=>e.children)(t)};g.displayName="PopoverTrigger",g.isFluentTriggerComponent=!0},20694:(e,t,o)=>{"use strict";o.d(t,{A:()=>b});var i=o(95734),n=o(82261),r=o(81585),s=o(44854),a=o(65373),l=o(53657),c=o(59906),u=o(99677),d=o(22302),g=o(17142),h=o(84434),p=o(64686),f=o(68436),m=o(97988),v=o(29417);var y=o(58085);const b=e=>(e=>{const{appearance:t,arrowRef:o,contentRef:n,inline:r,mountNode:s,open:a,openOnContext:l,openOnHover:c,setOpen:u,size:d,toggleOpen:g,trapFocus:h,triggerRef:p,withArrow:f,inertTrapFocus:m}=e;return i.createElement(y.nt.Provider,{value:{appearance:t,arrowRef:o,contentRef:n,inline:r,mountNode:s,open:a,openOnContext:l,openOnHover:c,setOpen:u,toggleOpen:g,triggerRef:p,size:d,trapFocus:h,inertTrapFocus:m,withArrow:f}},e.popoverTrigger,e.open&&e.popoverSurface)})((e=>{const[t,o]=(0,d.N)(),y={size:"medium",contextTarget:t,setContextTarget:o,...e},b=i.Children.toArray(e.children);let S,C;2===b.length?(S=b[0],C=b[1]):1===b.length&&(C=b[0]);const[w,k]=function(e){const t=(0,r.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),[o,n]=(0,c.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1});e.open=void 0!==o?o:e.open;const s=e.setContextTarget;return[o,i.useCallback(((e,o)=>{o&&"contextmenu"===e.type&&s(e),o||s(void 0),n(o),null==t||t(e,{open:o})}),[n,t,s])]}(y),[T,x]=(0,n.Z)(),_=(0,r.D)(((t,o)=>{var i;x(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type?T((()=>{k(t,o)}),null!==(i=e.mouseLeaveDelay)&&void 0!==i?i:500):k(t,o)})),I=i.useCallback((e=>{_(e,!w)}),[_,w]),E=function(e){const t={position:"above",align:"center",arrowPadding:2*v.v,target:e.openOnContext?e.contextTarget:void 0,...(0,g.P)(e.positioning)};t.coverTarget&&(e.withArrow=!1),e.withArrow&&(t.offset=(0,h.H)(t.offset,m.aT[e.size]));const{targetRef:o,containerRef:i,arrowRef:n}=(0,p.T)(t);return{triggerRef:o,contentRef:i,arrowRef:n}}(y),{targetDocument:A}=(0,u.Y)();var B;(0,s.W)({contains:a.s,element:A,callback:e=>_(e,!1),refs:[E.triggerRef,E.contentRef],disabled:!w,disabledFocusOnIframe:!(null===(B=e.closeOnIframeFocus)||void 0===B||B)});const R=y.openOnContext||y.closeOnScroll;(0,l.z)({contains:a.s,element:A,callback:e=>_(e,!1),refs:[E.triggerRef,E.contentRef],disabled:!w||!R});const{findFirstFocusable:M}=(0,f.r)();var D,P;return i.useEffect((()=>{if(!e.unstable_disableAutoFocus&&w&&E.contentRef.current){var t;const e=null!==(t=E.contentRef.current.getAttribute("tabIndex"))&&void 0!==t?t:void 0,o=isNaN(e)?M(E.contentRef.current):E.contentRef.current;null==o||o.focus()}}),[M,w,E.contentRef,e.unstable_disableAutoFocus]),{...y,...E,inertTrapFocus:null!==(D=e.inertTrapFocus)&&void 0!==D?D:void 0!==e.legacyTrapFocus&&!e.legacyTrapFocus,popoverTrigger:S,popoverSurface:C,open:w,setOpen:_,toggleOpen:I,setContextTarget:o,contextTarget:t,inline:null!==(P=e.inline)&&void 0!==P&&P}})(e));b.displayName="Popover"},29417:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=4},58085:(e,t,o)=>{"use strict";o.d(t,{nt:()=>r,pO:()=>a});var i=o(88256);if(3023==o.j)var n=o(43080);const r=(0,i.q)(void 0),s={open:!1,setOpen:()=>null,toggleOpen:()=>null,triggerRef:{current:null},contentRef:{current:null},arrowRef:{current:null},openOnContext:!1,openOnHover:!1,size:"medium",trapFocus:!1,inline:!1},a=(r.Provider,e=>(0,n.i)(r,((t=s)=>e(t))))},24396:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var i=o(95734),n=o(16545),r=o(73085),s=o(33633),a=o(38883);const l=e=>{const t=(e=>{const{element:t,className:o}=(0,r.h)(e.mountNode),a=i.useRef(null),l=(0,s.v)({disabled:!!t,className:o}),c=null!=t?t:l,u={children:e.children,mountNode:c,virtualParentRootRef:a};return i.useEffect((()=>{if(!c)return;const e=a.current,t=c.contains(e);return e&&!t?((0,n.g)(c,e),()=>{(0,n.g)(c,void 0)}):void 0}),[a,c]),u})(e);return(e=>i.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&a.createPortal(e.children,e.mountNode)))(t)};l.displayName="Portal"},33633:(e,t,o)=>{"use strict";var i;o.d(t,{v:()=>h});var n=o(95734);if(3023==o.j)var r=o(79639);if(3023==o.j)var s=o(62212);if(3023==o.j)var a=o(75011);if(3023==o.j)var l=o(63649);if(3023==o.j)var c=o(34593);if(3023==o.j)var u=o(9264);if(3023==o.j)var d=o(30595);const g=(i||(i=o.t(n,2))).useInsertionEffect,h=e=>{const{targetDocument:t,dir:o}=(0,r.Y)(),i=(0,s.v)(),h=(0,c.Y)(),p=(0,d.B)(),f=(0,a.q)(),m=(0,l.z)(f,p.root,e.className),v=null!=i?i:null==t?void 0:t.body,y=(0,u.K)((()=>{if(void 0===v||e.disabled)return[null,()=>null];const t=v.ownerDocument.createElement("div");return v.appendChild(t),[t,()=>t.remove()]}),[v]);return g?g((()=>{if(!y)return;const e=m.split(" ").filter(Boolean);return y.classList.add(...e),y.setAttribute("dir",o),y.setAttribute("data-portal-node","true"),h.current=y,()=>{y.classList.remove(...e),y.removeAttribute("dir")}}),[m,o,y,h]):n.useMemo((()=>{y&&(y.className=m,y.setAttribute("dir",o),y.setAttribute("data-portal-node","true"),h.current=y)}),[m,o,y,h]),y}},30595:(e,t,o)=>{"use strict";o.d(t,{B:()=>i});const i=(0,o(27760).X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]})},73085:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(61369);function n(e){return(0,i.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}},3801:(e,t,o)=>{"use strict";o.d(t,{Hz:()=>n,Pg:()=>s,VJ:()=>i,a_:()=>r,l7:()=>a});const i="data-popper-is-intersecting",n="data-popper-escaped",r="data-popper-reference-hidden",s="data-popper-placement",a="fui-positioningend"},42550:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>d}),3023==o.j)var i=o(90124);if(3023==o.j)var n=o(58013);if(3023==o.j)var r=o(66276);if(3023==o.j)var s=o(6090);if(3023==o.j)var a=o(20251);if(3023==o.j)var l=o(17748);if(3023==o.j)var c=o(3801);if(3023==o.j)var u=o(62978);function d(e){let t=!1;const{container:o,target:d,arrow:g,strategy:h,middleware:p,placement:f,useTransform:m=!0,disableUpdateOnResize:v=!1}=e,y=o.ownerDocument.defaultView;if(!d||!o||!y)return{updatePosition:()=>{},dispose:()=>{}};const b=v?null:(0,u.J)(y,(e=>{e.every((e=>e.contentRect.width>0&&e.contentRect.height>0))&&w()}));let S=!0;const C=new Set;Object.assign(o.style,{position:"fixed",left:0,top:0,margin:0});const w=(0,a.s)((()=>{t||(S&&((0,l.X)(o).forEach((e=>C.add(e))),(0,n.s)(d)&&(0,l.X)(d).forEach((e=>C.add(e))),C.forEach((e=>{e.addEventListener("scroll",w,{passive:!0})})),null==b||b.observe(o),(0,n.s)(d)&&(null==b||b.observe(d)),S=!1),Object.assign(o.style,{position:h}),(0,i.rD)(d,o,{placement:f,middleware:p,strategy:h}).then((({x:e,y:i,middlewareData:n,placement:a})=>{t||((0,r.P)({arrow:g,middlewareData:n}),(0,s.f)({container:o,middlewareData:n,placement:a,coordinates:{x:e,y:i},lowPPI:((null==y?void 0:y.devicePixelRatio)||1)<=1,strategy:h,useTransform:m}),o.dispatchEvent(new CustomEvent(c.l7)))})).catch((e=>{})))}));return y&&(y.addEventListener("scroll",w,{passive:!0}),y.addEventListener("resize",w)),w(),{updatePosition:w,dispose:()=>{t=!0,y&&(y.removeEventListener("scroll",w),y.removeEventListener("resize",w)),C.forEach((e=>{e.removeEventListener("scroll",w)})),C.clear(),null==b||b.disconnect()}}}},9111:(e,t,o)=>{"use strict";function i(e){const t=e.clientX,o=e.clientY,i=t+1,n=o+1;return{getBoundingClientRect:function(){return{left:t,top:o,right:i,bottom:n,x:t,y:o,height:1,width:1}}}}o.d(t,{S:()=>i})},39747:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(11358);function n(){return{name:"coverTarget",fn:e=>{const{placement:t,rects:o,x:n,y:r}=e,s={x:n,y:r};switch((0,i.n)(t).side){case"bottom":s.y-=o.reference.height;break;case"top":s.y+=o.reference.height;break;case"left":s.x+=o.reference.width;break;case"right":s.x-=o.reference.width}return s}}}},32338:(e,t,o)=>{"use strict";if(o.d(t,{U:()=>a}),3023==o.j)var i=o(90124);if(3023==o.j)var n=o(17142);if(3023==o.j)var r=o(56934);if(3023==o.j)var s=o(99888);function a(e){const{hasScrollableElement:t,flipBoundary:o,container:a,fallbackPositions:l=[],isRtl:c}=e,u=l.reduce(((e,t)=>{const{position:o,align:i}=(0,n.P)(t),s=(0,r.h)(i,o,c);return s&&e.push(s),e}),[]);return(0,i.UU)({...t&&{boundary:"clippingAncestors"},...o&&{altBoundary:!0,boundary:(0,s.r)(a,o)},fallbackStrategy:"bestFit",...u.length&&{fallbackPlacements:u}})}},50398:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>n}),3023==o.j)var i=o(90124);function n(){return{name:"intersectionObserver",fn:async e=>{const t=e.rects.floating,o=await(0,i.__)(e,{altBoundary:!0}),n=o.top<t.height&&o.top>0,r=o.bottom<t.height&&o.bottom>0;return{data:{intersecting:n||r}}}}}},99324:(e,t,o)=>{"use strict";o.d(t,{_:()=>n});const i="--fui-match-target-size";function n(){return{name:"matchTargetSize",fn:async e=>{const{rects:{reference:t,floating:o},elements:{floating:n},middlewareData:{matchTargetSize:{matchTargetSizeAttempt:r=!1}={}}}=e;if(t.width===o.width||r)return{};const{width:s}=t;return n.style.setProperty(i,`${s}px`),n.style.width||(n.style.width=`var(${i})`),{data:{matchTargetSizeAttempt:!0},reset:{rects:!0}}}}}},45710:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>s,e:()=>a}),3023==o.j)var i=o(90124);if(3023==o.j)var n=o(99888);if(3023==o.j)var r=o(27360);const s=e=>({name:"resetMaxSize",fn({middlewareData:t,elements:o}){var i;if(null===(i=t.resetMaxSize)||void 0===i?void 0:i.maxSizeAlreadyReset)return{};const{applyMaxWidth:n,applyMaxHeight:r}=e;return n&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-width"),o.floating.style.removeProperty("width")),r&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-height"),o.floating.style.removeProperty("height")),{data:{maxSizeAlreadyReset:!0},reset:{rects:!0}}}});function a(e,t){const{container:o,overflowBoundary:s,overflowBoundaryPadding:a,isRtl:l}=t;return(0,i.Ej)({...a&&{padding:(0,r.z)(a,l)},...s&&{altBoundary:!0,boundary:(0,n.r)(o,s)},apply({availableHeight:t,availableWidth:o,elements:i,rects:n}){const r=(e,t,o)=>{if(e&&(i.floating.style.setProperty("box-sizing","border-box"),i.floating.style.setProperty(`max-${t}`,`${o}px`),n.floating[t]>o)){i.floating.style.setProperty(t,`${o}px`);const e="width"===t?"x":"y";i.floating.style.getPropertyValue(`overflow-${e}`)||i.floating.style.setProperty(`overflow-${e}`,"auto")}},{applyMaxWidth:s,applyMaxHeight:a}=e;r(s,"width",o),r(a,"height",t)}})}},79622:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>r}),3023==o.j)var i=o(90124);if(3023==o.j)var n=o(55965);function r(e){const t=(0,n.u)(e);return(0,i.cY)(t)}},51565:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(90124);if(3023==o.j)var n=o(27360);if(3023==o.j)var r=o(99888);function s(e){const{hasScrollableElement:t,disableTether:o,overflowBoundary:s,container:a,overflowBoundaryPadding:l,isRtl:c}=e;return(0,i.BN)({...t&&{boundary:"clippingAncestors"},...o&&{crossAxis:"all"===o,limiter:(0,i.ER)({crossAxis:"all"!==o,mainAxis:!1})},...l&&{padding:(0,n.z)(l,c)},...s&&{altBoundary:!0,boundary:(0,r.r)(a,s)}})}},64686:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>w}),3023==o.j)var i=o(90124);if(3023==o.j)var n=o(99677);if(3023==o.j)var r=o(22756);if(3023==o.j)var s=o(81585);if(3023==o.j)var a=o(47586);var l=o(95734);if(3023==o.j)var c=o(38281);if(3023==o.j)var u=o(40291);if(3023==o.j)var d=o(89143);if(3023==o.j)var g=o(56934);if(3023==o.j)var h=o(45710);if(3023==o.j)var p=o(99324);if(3023==o.j)var f=o(79622);if(3023==o.j)var m=o(39747);if(3023==o.j)var v=o(32338);if(3023==o.j)var y=o(51565);if(3023==o.j)var b=o(50398);if(3023==o.j)var S=o(42550);if(3023==o.j)var C=o(3801);function w(e){const t=l.useRef(null),o=l.useRef(null),w=l.useRef(null),k=l.useRef(null),T=l.useRef(null),{enabled:x=!0}=e,_=function(e){const{align:t,arrowPadding:o,autoSize:r,coverTarget:s,flipBoundary:a,offset:c,overflowBoundary:S,pinned:C,position:w,unstable_disableTether:k,positionFixed:T,strategy:x,overflowBoundaryPadding:_,fallbackPositions:I,useTransform:E,matchTargetSize:A,disableUpdateOnResize:B=!1}=e,{dir:R,targetDocument:M}=(0,n.Y)(),D="rtl"===R,P=(null!=x?x:T)?"fixed":"absolute",N=(0,u.a)(r);return l.useCallback(((e,n)=>{const r=(0,d.iv)(e),l=[N&&(0,h.D)(N),A&&(0,p._)(),c&&(0,f.c)(c),s&&(0,m.z)(),!C&&(0,v.U)({container:e,flipBoundary:a,hasScrollableElement:r,isRtl:D,fallbackPositions:I}),(0,y.B)({container:e,hasScrollableElement:r,overflowBoundary:S,disableTether:k,overflowBoundaryPadding:_,isRtl:D}),N&&(0,h.e)(N,{container:e,overflowBoundary:S,overflowBoundaryPadding:_,isRtl:D}),(0,b.M)(),n&&(0,i.UE)({element:n,padding:o}),(0,i.jD)({strategy:"referenceHidden"}),(0,i.jD)({strategy:"escaped"}),!1].filter(Boolean);return{placement:(0,g.h)(t,w,D),middleware:l,strategy:P,useTransform:E,disableUpdateOnResize:B}}),[t,o,N,s,k,a,D,c,S,C,w,P,_,I,E,A,M,B])}(e),I=l.useCallback((()=>{var e;t.current&&t.current.dispose(),t.current=null;const i=null!==(e=w.current)&&void 0!==e?e:o.current;x&&(0,r.S)()&&i&&k.current&&(t.current=(0,S.h)({container:k.current,target:i,arrow:T.current,..._(k.current,T.current)}))}),[x,_]),E=(0,s.D)((e=>{w.current=e,I()}));l.useImperativeHandle(e.positioningRef,(()=>({updatePosition:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.updatePosition()},setTarget:t=>{e.target,E(t)}})),[e.target,E]),(0,a.E)((()=>{var t;E(null!==(t=e.target)&&void 0!==t?t:null)}),[e.target,E]),(0,a.E)((()=>{I()}),[I]);const A=(0,c.c)(null,(e=>{o.current!==e&&(o.current=e,I())})),B=(0,s.D)((()=>{var t;return null===(t=e.onPositioningEnd)||void 0===t?void 0:t.call(e)}));return{targetRef:A,containerRef:(0,c.c)(null,(e=>{var t;k.current!==e&&(null===(t=k.current)||void 0===t||t.removeEventListener(C.l7,B),null==e||e.addEventListener(C.l7,B),k.current=e,I())})),arrowRef:(0,c.c)(null,(e=>{T.current!==e&&(T.current=e,I())}))}}},22302:(e,t,o)=>{"use strict";o.d(t,{N:()=>r});var i=o(95734);if(3023==o.j)var n=o(9111);const r=e=>{const[t,o]=i.useState(e);return[t,e=>{if(null==e)return void o(void 0);let t;t=e instanceof MouseEvent?e:e.nativeEvent,MouseEvent;const i=(0,n.S)(t);o(i)}]}},62978:(e,t,o)=>{"use strict";function i(e,t){return new e.ResizeObserver(t)}o.d(t,{J:()=>i})},20251:(e,t,o)=>{"use strict";function i(e){let t;return()=>(t||(t=new Promise((o=>{Promise.resolve().then((()=>{t=void 0,o(e())}))}))),t)}o.d(t,{s:()=>i})},5249:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>n}),3023==o.j)var i=o(11358);const n=e=>{const{side:t,alignment:o}=(0,i.n)(e),n={top:"above",bottom:"below",right:"after",left:"before"}[t],r=o&&(e=>"above"===e||"below"===e?{start:"start",end:"end"}:{start:"top",end:"bottom"})(n)[o];return{position:n,alignment:r}}},99888:(e,t,o)=>{"use strict";if(o.d(t,{r:()=>n}),3023==o.j)var i=o(89143);function n(e,t){if("window"===t)return null==e?void 0:e.ownerDocument.documentElement;if("clippingParents"===t)return"clippingAncestors";if("scrollParent"===t){let t=(0,i.mH)(e);return"BODY"===t.nodeName&&(t=null==e?void 0:e.ownerDocument.documentElement),t}return t}},55965:(e,t,o)=>{"use strict";if(o.d(t,{u:()=>n}),3023==o.j)var i=o(5249);function n(e){return e?"number"==typeof e||"object"==typeof e?e:({rects:{floating:t,reference:o},placement:n})=>{const{position:r,alignment:s}=(0,i.y)(n);return e({positionedRect:t,targetRect:o,position:r,alignment:s})}:e}},89143:(e,t,o)=>{"use strict";o.d(t,{iv:()=>n,mH:()=>i});const i=e=>{const t=e&&(e=>"HTML"===e.nodeName?e:e.parentNode||e.host)(e);if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:o,overflowX:n,overflowY:r}=(e=>{var t;return 1!==e.nodeType?{}:(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView).getComputedStyle(e,null)})(t);return/(auto|scroll|overlay)/.test(o+r+n)?t:i(t)},n=e=>{var t;const o=i(e);return!!o&&o!==(null===(t=o.ownerDocument)||void 0===t?void 0:t.body)}},17748:(e,t,o)=>{"use strict";if(o.d(t,{X:()=>n}),3023==o.j)var i=o(89143);function n(e){const t=[];let o=e;for(;o;){const n=(0,i.mH)(o);if(e.ownerDocument.body===n){t.push(n);break}if("BODY"===n.nodeName&&n!==e.ownerDocument.body)break;t.push(n),o=n}return t}},84434:(e,t,o)=>{"use strict";function i(e,t){return"number"==typeof e||"object"==typeof e&&null!==e?n(e,t):"function"==typeof e?o=>{const i=e(o);return n(i,t)}:{mainAxis:t}}o.d(t,{H:()=>i});const n=(e,t)=>{return"number"==typeof e?{mainAxis:e+t}:{...e,mainAxis:(null!==(o=e.mainAxis)&&void 0!==o?o:0)+t};var o}},40291:(e,t,o)=>{"use strict";o.d(t,{a:()=>i});const i=e=>{switch(e){case"always":case!0:return{applyMaxWidth:!0,applyMaxHeight:!0};case"width-always":case"width":return{applyMaxWidth:!0,applyMaxHeight:!1};case"height-always":case"height":return{applyMaxWidth:!1,applyMaxHeight:!0};default:return!1}}},11358:(e,t,o)=>{"use strict";function i(e){const t=e.split("-");return{side:t[0],alignment:t[1]}}o.d(t,{n:()=>i})},17142:(e,t,o)=>{"use strict";o.d(t,{P:()=>n});const i={above:{position:"above",align:"center"},"above-start":{position:"above",align:"start"},"above-end":{position:"above",align:"end"},below:{position:"below",align:"center"},"below-start":{position:"below",align:"start"},"below-end":{position:"below",align:"end"},before:{position:"before",align:"center"},"before-top":{position:"before",align:"top"},"before-bottom":{position:"before",align:"bottom"},after:{position:"after",align:"center"},"after-top":{position:"after",align:"top"},"after-bottom":{position:"after",align:"bottom"}};function n(e){return null==e?{}:"string"==typeof e?i[e]:e}},27360:(e,t,o)=>{"use strict";function i(e,t){if("number"==typeof e)return e;const{start:o,end:i,...n}=e,r=n,s=t?"end":"start",a=t?"start":"end";return e[s]&&(r.left=e[s]),e[a]&&(r.right=e[a]),r}o.d(t,{z:()=>i})},56934:(e,t,o)=>{"use strict";o.d(t,{h:()=>i});const i=(e,t,o)=>{const i=((e,t)=>{const o="above"===e||"below"===e,i="top"===t||"bottom"===t;return o&&i||!o&&!i})(t,e)?"center":e,n=t&&(e=>({above:"top",below:"bottom",before:e?"right":"left",after:e?"left":"right"}))(o)[t],r=i&&{start:"start",end:"end",top:"start",bottom:"end",center:void 0}[i];return n&&r?`${n}-${r}`:n}},38281:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i=o(95734);if(3023==o.j)var n=o(47586);function r(e,t,o){const r=i.useRef(!0),[s]=i.useState((()=>({value:e,callback:t,facade:{get current(){return s.value},set current(e){const t=s.value;if(t!==e){if(s.value=e,o&&r.current)return;s.callback(e,t)}}}})));return(0,n.E)((()=>{r.current=!1}),[]),s.callback=t,s.facade}},66276:(e,t,o)=>{"use strict";function i(e){const{arrow:t,middlewareData:o}=e;if(!o.arrow||!t)return;const{x:i,y:n}=o.arrow;Object.assign(t.style,{left:`${i}px`,top:`${n}px`})}o.d(t,{P:()=>i})},6090:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(3801);function n(e){var t,o,n;const{container:r,placement:s,middlewareData:a,strategy:l,lowPPI:c,coordinates:u,useTransform:d=!0}=e;if(!r)return;r.setAttribute(i.Pg,s),r.removeAttribute(i.VJ),a.intersectionObserver.intersecting&&r.setAttribute(i.VJ,""),r.removeAttribute(i.Hz),(null===(t=a.hide)||void 0===t?void 0:t.escaped)&&r.setAttribute(i.Hz,""),r.removeAttribute(i.a_),(null===(o=a.hide)||void 0===o?void 0:o.referenceHidden)&&r.setAttribute(i.a_,"");const g=(null===(n=r.ownerDocument.defaultView)||void 0===n?void 0:n.devicePixelRatio)||1,h=Math.round(u.x*g)/g,p=Math.round(u.y*g)/g;Object.assign(r.style,{position:l}),d?Object.assign(r.style,{transform:c?`translate(${h}px, ${p}px)`:`translate3d(${h}px, ${p}px, 0)`}):Object.assign(r.style,{left:`${h}px`,top:`${p}px`})}},64576:(e,t,o)=>{"use strict";o.d(t,{G:()=>T});var i=o(95734),n=o(59906),r=o(7143),s=o(81585),a=o(95848),l=o(2430),c=o(45896),u=o(12908),d=o(51485),g=o(87579),h=o(60171),p=o(27408),f=o(27760),m=o(11612),v=o(63649),y=o(28156);const b=(0,f.X)({small:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["fk8j09s","fdw0yi8"],z189sj:["fdw0yi8","fk8j09s"]},medium:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},large:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["f1ng84yb","f11gcy0p"],z189sj:["f11gcy0p","f1ng84yb"]},input:{uwmqm3:["fk8j09s","fdw0yi8"],z189sj:["fhxju0i","f1cnd47f"],Boqhc8c:"f18izjht",B8uat0v:"fcoa6sg"},unfocusedNoContentAfter:{z189sj:["fhxju0i","f1cnd47f"]}},{d:[".fjuset5{column-gap:0;}",".f1xzfw5u{max-width:468px;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".fhxju0i{padding-right:0;}",".f1cnd47f{padding-left:0;}",".f18izjht::-webkit-search-decoration{display:none;}",".fcoa6sg::-webkit-search-cancel-button{display:none;}"]}),S=(0,f.X)({small:{z189sj:["fdw0yi8","fk8j09s"]},medium:{z189sj:["f1vdfbxk","f1f5gg8d"]},large:{z189sj:["f11gcy0p","f1ng84yb"]}},{d:[".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}"]}),C=(0,f.X)({contentAfter:{uwmqm3:["f1uw59to","fw5db7e"],i8kkvl:"f1ufnopg"},rest:{abs64n:"fk73vx1",Bqenvij:"fniina8",a9b677:"f3tsq5r",uwmqm3:["f1cnd47f","fhxju0i"]}},{d:[".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}",".f1ufnopg{column-gap:var(--spacingHorizontalXS);}",".fk73vx1{opacity:0;}",".fniina8{height:0;}",".f3tsq5r{width:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}"]}),w=(0,m.y)("r1pvzcuu",null,[".r1pvzcuu{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;cursor:pointer;}",".r1pvzcuu>svg{font-size:20px;}"]),k=(0,f.X)({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),T=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{size:o="medium",disabled:h=!1,root:p,contentBefore:f,dismiss:m,contentAfter:v,value:y,defaultValue:b,...S}=e,C=i.useRef(null),w=i.useRef(null),[k,T]=(0,n.i)({state:y,defaultState:b,initialState:""}),[x,_]=i.useState(!1),I=i.useCallback((()=>{_(!0)}),[_]),E=i.useCallback((e=>{var t;_(!!(null===(t=C.current)||void 0===t?void 0:t.contains(e.relatedTarget)))}),[_]),A=r.Gf(p),B=(0,s.D)((t=>{var o,i;(0,a.g)(m)&&(null===(i=m.onClick)||void 0===i||i.call(m,t)),T(""),null===(o=e.onChange)||void 0===o||o.call(e,t,{value:""})})),R=(0,u.n)({type:"search",disabled:h,size:o,value:k,root:r.Gk({...A,ref:(0,l.a)(null==A?void 0:A.ref,C),onFocus:(0,c.p)(null==A?void 0:A.onFocus,I),onBlur:(0,c.p)(null==A?void 0:A.onBlur,E)},{elementType:"span"}),contentBefore:r.lq(f,{renderByDefault:!0,defaultProps:{children:i.createElement(d.vMY,null)},elementType:"span"}),contentAfter:r.lq(v,{renderByDefault:!0,elementType:"span"}),...S,onChange:(0,s.D)((t=>{var o;const i=t.target.value;null===(o=e.onChange)||void 0===o||o.call(e,t,{value:i}),T(i)}))},(0,l.a)(w,t)),M={...R,components:{...R.components,dismiss:"span"},dismiss:r.lq(m,{defaultProps:{children:i.createElement(g.BEt,null),role:"button","aria-label":"clear",tabIndex:-1},renderByDefault:!0,elementType:"span"}),disabled:h,focused:x,size:o};return M.dismiss&&(M.dismiss.onClick=B),M})(e,t);return(e=>{const{disabled:t,focused:o,size:i}=e,n=b(),r=S(),s=C(),a=w(),l=k();e.root.className=(0,v.z)("fui-SearchBox",n[i],!o&&n.unfocusedNoContentAfter,e.root.className),e.input.className=(0,v.z)("fui-SearchBox__input",n.input,!o&&r[i],e.input.className),e.dismiss&&(e.dismiss.className=(0,v.z)("fui-SearchBox__dismiss",a,t&&l.disabled,l[i],e.dismiss.className)),e.contentBefore&&(e.contentBefore.className=(0,v.z)("fui-SearchBox__contentBefore",e.contentBefore.className)),e.contentAfter?e.contentAfter.className=(0,v.z)("fui-SearchBox__contentAfter",s.contentAfter,!o&&s.rest,e.contentAfter.className):e.dismiss&&(e.dismiss.className=(0,v.z)(e.dismiss.className,s.contentAfter)),(0,y.d)(e)})(o),(e=>((0,p.C)(e),(0,h.FD)(e.root,{children:[e.contentBefore&&(0,h.Y)(e.contentBefore,{}),(0,h.Y)(e.input,{}),e.contentAfter&&(0,h.FD)(e.contentAfter,{children:[e.contentAfter.children,e.dismiss&&(0,h.Y)(e.dismiss,{})]})]})))(o)}));T.displayName="SearchBox"},62212:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i=o(95734);const n=i.createContext(void 0);function r(){return i.useContext(n)}n.Provider},79639:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(95734);const n=i.createContext(void 0),r={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"};function s(){var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}n.Provider},75011:(e,t,o)=>{"use strict";o.d(t,{q:()=>s});var i=o(95734);const n=i.createContext(void 0),r="";function s(){var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}n.Provider},34936:(e,t,o)=>{"use strict";o.d(t,{H:()=>f});var i=o(95734),n=o(7143),r=o(54694),s=o(38522),a=o(60171),l=o(27408),c=o(27760),u=o(63649);const d=(0,c.X)({root:{qhf8xq:"f10pi13n",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Bsft5z2:"f13zj6fq",ap17g6:"f2gz7yw",E3zdtr:"f1mdlcz9",By385i5:0,Eqx8gd:0,B1piin3:0,bn5sak:0,B58onuk:"f1nt53hs",s9ouvv:"f18xs7ez",xr36ep:"ffm3629",Bitv4sc:"f1f9zsvm",Jx5sug:"f1ub80pn",Hzyzrh:"f1e7twep"},wave:{De3pzq:"f1gjxg63",Br128sd:["f3fo419","f6m9r4"],h62rwi:["ftnv2js","f12jzhyt"],b1kco5:["fig1c6l","f1rv5y9h"],oi31me:"f103n15n"},pulse:{Br128sd:"f171zwvm",xr36ep:"fs3pcyf",Bjyk6c5:"f1yu5riq"},translucent:{De3pzq:"f162mh4z",h62rwi:["flvf4r0","f1uek97b"]},translucentPulse:{De3pzq:"flu3bqm",Bjyk6c5:"fxucc0w"}},{d:[".f10pi13n{position:relative;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],'.f13zj6fq::after{content:"";}',".f2gz7yw::after{display:block;}",".f1mdlcz9::after{position:absolute;}",[".f1nt53hs::after{inset:0;}",{p:-1}],".f18xs7ez::after{animation-iteration-count:infinite;}",".ffm3629::after{animation-duration:3s;}",".f1f9zsvm::after{animation-timing-function:ease-in-out;}",".f1gjxg63{background-color:var(--colorNeutralStencil1);}",".f3fo419::after{animation-name:f1efwx7q;}",".f6m9r4::after{animation-name:f1kkgpz1;}",".ftnv2js::after{background-image:linear-gradient(\n        to right,\n        var(--colorNeutralStencil1) 0%,\n        var(--colorNeutralStencil2) 50%,\n        var(--colorNeutralStencil1) 100%);}",".f12jzhyt::after{background-image:linear-gradient(\n        to left,\n        var(--colorNeutralStencil1) 0%,\n        var(--colorNeutralStencil2) 50%,\n        var(--colorNeutralStencil1) 100%);}",".fig1c6l::after{transform:translate(-100%);}",".f1rv5y9h::after{transform:translate(100%);}",".f171zwvm::after{animation-name:f12o7gg6;}",".fs3pcyf::after{animation-duration:1s;}",".f1yu5riq::after{background-color:var(--colorNeutralStencil1);}",".f162mh4z{background-color:var(--colorNeutralStencil1Alpha);}",".flvf4r0::after{background-image:linear-gradient(\n      to right,\n      transparent 0%,\n      var(--colorNeutralStencil1Alpha) 50%,\n      transparent 100%);}",".f1uek97b::after{background-image:linear-gradient(\n      to left,\n      transparent 0%,\n      var(--colorNeutralStencil1Alpha) 50%,\n      transparent 100%);}",".flu3bqm{background-color:none;}",".fxucc0w::after{background-color:var(--colorNeutralStencil1Alpha);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1ub80pn::after{animation-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1e7twep::after{animation-iteration-count:1;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (forced-colors: active){.f103n15n::after{background-color:WindowText;}}",{m:"screen and (forced-colors: active)"}]],k:["@keyframes f1efwx7q{to{transform:translate(100%);}}","@keyframes f1kkgpz1{to{transform:translate(-100%);}}","@keyframes f12o7gg6{0%{opacity:1;}50%{opacity:0.4;}100%{opacity:1;}}"]}),g=(0,c.X)({8:{Bqenvij:"f1x82gua"},12:{Bqenvij:"fvblgha"},16:{Bqenvij:"fd461yt"},20:{Bqenvij:"fjamq6b"},24:{Bqenvij:"frvgh55"},28:{Bqenvij:"fxldao9"},32:{Bqenvij:"f1d2rq10"},36:{Bqenvij:"f8ljn23"},40:{Bqenvij:"fbhnoac"},48:{Bqenvij:"ff2sm71"},56:{Bqenvij:"fzki0ko"},64:{Bqenvij:"f16k9i2m"},72:{Bqenvij:"f1shusfg"},96:{Bqenvij:"fypu0ge"},120:{Bqenvij:"fjr5b71"},128:{Bqenvij:"fele2au"},root:{a9b677:"fly5x3f",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ff3glw6"}},{d:[".f1x82gua{height:8px;}",".fvblgha{height:12px;}",".fd461yt{height:16px;}",".fjamq6b{height:20px;}",".frvgh55{height:24px;}",".fxldao9{height:28px;}",".f1d2rq10{height:32px;}",".f8ljn23{height:36px;}",".fbhnoac{height:40px;}",".ff2sm71{height:48px;}",".fzki0ko{height:56px;}",".f16k9i2m{height:64px;}",".f1shusfg{height:72px;}",".fypu0ge{height:96px;}",".fjr5b71{height:120px;}",".fele2au{height:128px;}",".fly5x3f{width:100%;}",[".ff3glw6{border-radius:4px;}",{p:-1}]]}),h=(0,c.X)({8:{a9b677:"f1o3cbw4",Bqenvij:"f1x82gua"},12:{a9b677:"frx94fk",Bqenvij:"fvblgha"},16:{a9b677:"fjw5fx7",Bqenvij:"fd461yt"},20:{a9b677:"f64fuq3",Bqenvij:"fjamq6b"},24:{a9b677:"fq4mcun",Bqenvij:"frvgh55"},28:{a9b677:"f1w9dchk",Bqenvij:"fxldao9"},32:{a9b677:"f1szoe96",Bqenvij:"f1d2rq10"},36:{a9b677:"fpdz1er",Bqenvij:"f8ljn23"},40:{a9b677:"feqmc2u",Bqenvij:"fbhnoac"},48:{a9b677:"f124akge",Bqenvij:"ff2sm71"},56:{a9b677:"f1u66zr1",Bqenvij:"fzki0ko"},64:{a9b677:"fa9ln6p",Bqenvij:"f16k9i2m"},72:{a9b677:"fhcae8x",Bqenvij:"f1shusfg"},96:{a9b677:"f1kyr2gn",Bqenvij:"fypu0ge"},120:{a9b677:"fwfqyga",Bqenvij:"fjr5b71"},128:{a9b677:"f1iksgmy",Bqenvij:"fele2au"}},{d:[".f1o3cbw4{width:8px;}",".f1x82gua{height:8px;}",".frx94fk{width:12px;}",".fvblgha{height:12px;}",".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f64fuq3{width:20px;}",".fjamq6b{height:20px;}",".fq4mcun{width:24px;}",".frvgh55{height:24px;}",".f1w9dchk{width:28px;}",".fxldao9{height:28px;}",".f1szoe96{width:32px;}",".f1d2rq10{height:32px;}",".fpdz1er{width:36px;}",".f8ljn23{height:36px;}",".feqmc2u{width:40px;}",".fbhnoac{height:40px;}",".f124akge{width:48px;}",".ff2sm71{height:48px;}",".f1u66zr1{width:56px;}",".fzki0ko{height:56px;}",".fa9ln6p{width:64px;}",".f16k9i2m{height:64px;}",".fhcae8x{width:72px;}",".f1shusfg{height:72px;}",".f1kyr2gn{width:96px;}",".fypu0ge{height:96px;}",".fwfqyga{width:120px;}",".fjr5b71{height:120px;}",".f1iksgmy{width:128px;}",".fele2au{height:128px;}"]}),p=(0,c.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f5q2cvs"}},{d:[[".f5q2cvs{border-radius:50%;}",{p:-1}]]}),f=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{animation:o,appearance:i}=(0,s.O)(),{animation:a=(null!=o?o:"wave"),appearance:l=(null!=i?i:"opaque"),size:c=16,shape:u="rectangle"}=e;return{appearance:l,animation:a,size:c,shape:u,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:t,...e}),{elementType:"div"})}})(e,t);return(e=>{const{animation:t,appearance:o,size:i,shape:n}=e,r=d(),s=g(),a=h(),l=p();e.root.className=(0,u.z)("fui-SkeletonItem",r.root,"wave"===t&&r.wave,"pulse"===t&&r.pulse,"translucent"===o&&r.translucent,"pulse"===t&&"translucent"===o&&r.translucentPulse,"rectangle"===n&&s.root,"rectangle"===n&&s[i],"square"===n&&a[i],"circle"===n&&l.root,"circle"===n&&a[i],e.root.className)})(o),(e=>((0,l.C)(e),(0,a.Y)(e.root,{})))(o)}));f.displayName="SkeletonItem"},39134:(e,t,o)=>{"use strict";o.d(t,{E:()=>u});var i=o(95734),n=o(7143),r=o(54694),s=o(38522),a=o(60171),l=o(27408),c=o(63649);const u=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{animation:o,appearance:i}=(0,s.O)(),{animation:a=(null!=o?o:"wave"),appearance:l=(null!=i?i:"opaque")}=e;return{animation:a,appearance:l,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:t,role:"progressbar","aria-busy":!0,...e}),{elementType:"div"})}})(e,t),u=(e=>{const{animation:t,appearance:o}=e;return{skeletonGroup:i.useMemo((()=>({animation:t,appearance:o})),[t,o])}})(o);return(e=>{e.root.className=(0,c.z)("fui-Skeleton",e.root.className)})(o),((e,t)=>((0,l.C)(e),(0,a.Y)(s.Q,{value:t.skeletonGroup,children:(0,a.Y)(e.root,{})})))(o,u)}));u.displayName="Skeleton"},38522:(e,t,o)=>{"use strict";o.d(t,{O:()=>a,Q:()=>s});var i=o(95734);const n=i.createContext(void 0),r={},s=n.Provider,a=()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}},55006:(e,t,o)=>{"use strict";o.d(t,{H:()=>l,bd:()=>a});var i=o(88256);if(3023==o.j)var n=o(43080);const r={appearance:"transparent",reserveSelectedTabSpace:!0,selectTabOnFocus:!1,disabled:!1,selectedValue:void 0,onRegister:()=>{},onUnregister:()=>{},onSelect:()=>{},getRegisteredTabs:()=>({registeredTabs:{}}),size:"medium",vertical:!1},s=(0,i.q)(void 0),a=s.Provider,l=e=>(0,n.i)(s,((t=r)=>e(t)))},51284:(e,t,o)=>{"use strict";o.d(t,{U:()=>u});var i=o(95734),n=o(27760);if(3023==o.j)var r=o(63649);if(3023==o.j)var s=o(55006);const a=(0,n.X)({base:{B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1gl81tg"},animated:{Ba2ppi3:"fhwpy7i",F2fol1:"f6zz20j",B1dyfl9:"f1ai4sc1",B0vmy72:"f9qxlq5",u9bimw:"f1aql376"},horizontal:{sjv3b2:["fug4aj8","f1i5xzg7"],b1kco5:"f1q7ujh"},vertical:{sjv3b2:"f1hqboyk",b1kco5:"f1dxupa6"}},{d:[[".f1gl81tg{overflow:visible;}",{p:-1}],".fhwpy7i::after{transition-property:transform;}",".f6zz20j::after{transition-duration:var(--durationSlow);}",".f1ai4sc1::after{transition-timing-function:var(--curveDecelerateMax);}",".fug4aj8::after{transform-origin:left;}",".f1i5xzg7::after{transform-origin:right;}",".f1q7ujh::after{transform:translateX(var(--fui-Tab__indicator--offset)) scaleX(var(--fui-Tab__indicator--scale));}",".f1hqboyk::after{transform-origin:top;}",".f1dxupa6::after{transform:translateY(var(--fui-Tab__indicator--offset)) scaleY(var(--fui-Tab__indicator--scale));}"],m:[["@media (prefers-reduced-motion: reduce){.f9qxlq5::after{transition-property:none;}}",{m:"(prefers-reduced-motion: reduce)"}],["@media (prefers-reduced-motion: reduce){.f1aql376::after{transition-duration:0.01ms;}}",{m:"(prefers-reduced-motion: reduce)"}]]}),l=(e,t)=>{var o;const i=c(t)?null===(o=e[JSON.stringify(t)])||void 0===o?void 0:o.ref.current:void 0;return i?(e=>{if(e){var t;const o=(null===(t=e.parentElement)||void 0===t?void 0:t.getBoundingClientRect())||{x:0,y:0,width:0,height:0},i=e.getBoundingClientRect();return{x:i.x-o.x,y:i.y-o.y,width:i.width,height:i.height}}})(i):void 0},c=e=>null!=e,u=e=>{const{disabled:t,selected:o,vertical:n}=e,u=a(),[d,g]=i.useState(),[h,p]=i.useState({offset:0,scale:1}),f=(0,s.H)((e=>e.getRegisteredTabs));if(i.useEffect((()=>{c(d)&&p({offset:0,scale:1})}),[d]),o){const{previousSelectedValue:e,selectedValue:t,registeredTabs:o}=f();if(c(e)&&d!==e){const i=l(o,e),r=l(o,t);if(r&&i){const t=n?i.y-r.y:i.x-r.x,o=n?i.height/r.height:i.width/r.width;p({offset:t,scale:o}),g(e)}}}else c(d)&&g(void 0);if(t)return e;const m=0===h.offset&&1===h.scale;e.root.className=(0,r.z)(e.root.className,o&&u.base,o&&m&&u.animated,o&&(n?u.vertical:u.horizontal));const v={"--fui-Tab__indicator--offset":`${h.offset}px`,"--fui-Tab__indicator--scale":`${h.scale}`};return e.root.style={...v,...e.root.style},e}},84027:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(30862);if(3023==o.j)var n=o(65643);if(3023==o.j)var r=o(34734);const s=(e={})=>{const{circular:t,axis:o,memorizeCurrent:s=!0,tabbable:l,ignoreDefaultKeydown:c,unstable_hasDefault:u}=e,d=(0,r.p)();return d&&(0,i.S)(d),(0,n.g)({mover:{cyclic:!!t,direction:a(null!=o?o:"vertical"),memorizeCurrent:s,tabbable:l,hasDefault:u},...c&&{focusable:{ignoreKeydown:c}}})};function a(e){switch(e){case"horizontal":return i.iA.Horizontal;case"grid":return i.iA.Grid;case"grid-linear":return i.iA.GridLinear;case"both":return i.iA.Both;default:return i.iA.Vertical}}},68436:(e,t,o)=>{"use strict";o.d(t,{r:()=>s});var i=o(95734);if(3023==o.j)var n=o(99677);if(3023==o.j)var r=o(34734);const s=()=>{const e=(0,r.p)(),{targetDocument:t}=(0,n.Y)();return{findAllFocusable:i.useCallback(((t,o)=>(null==e?void 0:e.focusable.findAll({container:t,acceptCondition:o}))||[]),[e]),findFirstFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findFirst({container:t})),[e]),findLastFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findLast({container:t})),[e]),findNextFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findNext({currentElement:o,container:n})}),[e,t]),findPrevFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findPrev({currentElement:o,container:n})}),[e,t])}}},13285:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>a}),3023==o.j)var i=o(49749);if(3023==o.j)var n=o(65643);if(3023==o.j)var r=o(30862);if(3023==o.j)var s=o(34734);const a=(e={})=>{const{trapFocus:t,alwaysFocusable:o,legacyTrapFocus:a}=e,l=(0,s.p)();l&&((0,r.Az)(l),(0,r.mz)(l));const c=(0,i.Bi)("modal-",e.id);return{modalAttributes:(0,n.g)({restorer:{type:r.CP.Source},...t&&{modalizer:{id:c,isOthersAccessible:!t,isAlwaysAccessible:o,isTrapped:a&&t}}}),triggerAttributes:(0,n.g)({restorer:{type:r.CP.Target}})}}},21955:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>r}),3023==o.j)var i=o(30862);if(3023==o.j)var n=o(34734);function r(){const e=(0,n.p)();return e&&(0,i.mz)(e),(0,i.U6)({restorer:{type:i.CP.Source}})}},34734:(e,t,o)=>{"use strict";o.d(t,{p:()=>l});var i=o(95734);if(3023==o.j)var n=o(99677);if(3023==o.j)var r=o(30862);if(3023==o.j)var s=o(98456);if(3023==o.j)var a=o(47586);const l=()=>{const{targetDocument:e}=(0,n.Y)(),t=(null==e?void 0:e.defaultView)||void 0,o=null==t?void 0:t.__tabsterShadowDOMAPI,l=i.useMemo((()=>t?(0,r._A)(t,{autoRoot:{},controlTab:!1,getParent:s.P,checkUncontrolledTrappingFocus:e=>{var t;return!!(null===(t=e.firstElementChild)||void 0===t?void 0:t.hasAttribute("data-is-focus-trap-zone-bumper"))},DOMAPI:o}):null),[t,o]);return(0,a.E)((()=>()=>{l&&(0,r.hC)(l)}),[l]),l}},65643:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(30862);if(3023==o.j)var n=o(34734);var r=o(95734);const s=e=>{(0,n.p)();const t=(0,i.U6)(e,!0);return r.useMemo((()=>({[i.h7]:t})),[t])}},2945:(e,t,o)=>{"use strict";o.d(t,{A7:()=>i});const i="data-fui-focus-visible"},14427:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>s}),3023==o.j)var i=o(61369);if(3023==o.j)var n=o(96406);if(3023==o.j)var r=o(2945);function s(e,t){if(a(e))return()=>{};const o={current:void 0},s=(0,n.SQ)(t);function l(e){s.isNavigatingWithKeyboard()&&(0,i.s)(e)&&(o.current=e,e.setAttribute(r.A7,""))}function c(){o.current&&(o.current.removeAttribute(r.A7),o.current=void 0)}s.subscribe((e=>{e||c()}));const u=e=>{c(),l(e.composedPath()[0])},d=t=>{(!t.relatedTarget||(0,i.s)(t.relatedTarget)&&!e.contains(t.relatedTarget))&&c()};return e.addEventListener(n.Oy,u),e.addEventListener("focusout",d),e.focusVisible=!0,e.contains(t.document.activeElement)&&l(t.document.activeElement),()=>{c(),e.removeEventListener(n.Oy,u),e.removeEventListener("focusout",d),delete e.focusVisible,(0,n.bd)(s)}}function a(e){return!!e&&(!!e.focusVisible||a(null==e?void 0:e.parentElement))}},34593:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(95734);if(3023==o.j)var n=o(79639);if(3023==o.j)var r=o(14427);function s(e={}){const t=(0,n.Y)(),o=i.useRef(null);var s;const a=null!==(s=e.targetDocument)&&void 0!==s?s:t.targetDocument;return i.useEffect((()=>{if((null==a?void 0:a.defaultView)&&o.current)return(0,r.y)(o.current,a.defaultView)}),[o,a]),o}},50213:(e,t,o)=>{"use strict";o.d(t,{m:()=>B});var i=o(95734),n=o(17142),r=o(84434),s=o(64686),a=o(54299),l=o(99677),c=o(96406),u=o(53144),d=o(82261),g=o(59906),h=o(7143),p=o(49749),f=o(2430),m=o(47586),v=o(45896),y=o(81461),b=o(67719),S=o(81585),C=o(98881),w=o(34837),k=o(60171),T=o(24396),x=o(27408),_=o(89161),I=o(27760),E=o(63649);const A=(0,I.X)({root:{mc9l5x:"fjseox",B7ck84d:"f1ewtqcl",B2u0y6b:"f132xexn",Bceei9c:"f158kwzp",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm",Btd35i7:"fokg9q4",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bzqsji",De3pzq:"fxugw4r",sj55zd:"f19n0e5",Bhu2qc9:"fxeb0a7"},visible:{mc9l5x:"ftgm304"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".fjseox{display:none;}",".f1ewtqcl{box-sizing:border-box;}",".f132xexn{max-width:240px;}",".f158kwzp{cursor:default;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fokg9q4{overflow-wrap:break-word;}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],[".f1bzqsji{padding:4px 11px 6px 11px;}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".fxeb0a7{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 4px 8px var(--colorNeutralShadowKey));}",".ftgm304{display:block;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}']}),B=e=>{const t=(e=>{var t,o,k,T;const x=(0,a.n)(),_=(0,u.wR)(),{targetDocument:I}=(0,l.Y)(),[E,A]=(0,d.Z)(),{appearance:B="normal",children:R,content:M,withArrow:D=!1,positioning:P="above",onVisibleChange:N,relationship:F,showDelay:O=250,hideDelay:j=250,mountNode:q}=e,[L,H]=(0,g.i)({state:e.visible,initialState:!1}),z=i.useCallback(((e,t)=>{A(),H((o=>(t.visible!==o&&(null==N||N(e,t)),t.visible)))}),[A,H,N]),W={withArrow:D,positioning:P,showDelay:O,hideDelay:j,relationship:F,visible:L,shouldRenderTooltip:L,appearance:B,mountNode:q,components:{content:"div"},content:h.Gk(M,{defaultProps:{role:"tooltip"},elementType:"div"})};W.content.id=(0,p.Bi)("tooltip-",W.content.id);const G={enabled:W.visible,arrowPadding:2*C.Q,position:"above",align:"center",offset:4,...(0,n.P)(W.positioning)};W.withArrow&&(G.offset=(0,r.H)(G.offset,C.d));const{targetRef:U,containerRef:V,arrowRef:$}=(0,s.T)(G);W.content.ref=(0,f.a)(W.content.ref,V),W.arrowRef=$,(0,m.E)((()=>{if(L){var e;const t={hide:e=>z(void 0,{visible:!1,documentKeyboardEvent:e})};null===(e=x.visibleTooltip)||void 0===e||e.hide(),x.visibleTooltip=t;const o=e=>{e.key!==w.uf9||e.defaultPrevented||(t.hide(e),e.preventDefault())};return null==I||I.addEventListener("keydown",o,{capture:!0}),()=>{x.visibleTooltip===t&&(x.visibleTooltip=void 0),null==I||I.removeEventListener("keydown",o,{capture:!0})}}}),[x,I,L,z]);const K=i.useRef(!1),J=i.useCallback((e=>{if("focus"===e.type&&K.current)return void(K.current=!1);const t=x.visibleTooltip?0:W.showDelay;E((()=>{z(e,{visible:!0})}),t),e.persist()}),[E,z,W.showDelay,x]),[Z]=i.useState((()=>{const e=e=>{var t;(null===(t=e.detail)||void 0===t?void 0:t.isFocusedProgrammatically)&&(K.current=!0)};let t=null;return o=>{null==t||t.removeEventListener(c.Oy,e),null==o||o.addEventListener(c.Oy,e),t=o}})),Y=i.useCallback((e=>{let t=W.hideDelay;"blur"===e.type&&(t=0,K.current=(null==I?void 0:I.activeElement)===e.target),E((()=>{z(e,{visible:!1})}),t),e.persist()}),[E,z,W.hideDelay,I]);W.content.onPointerEnter=(0,v.p)(W.content.onPointerEnter,A),W.content.onPointerLeave=(0,v.p)(W.content.onPointerLeave,Y),W.content.onFocus=(0,v.p)(W.content.onFocus,A),W.content.onBlur=(0,v.p)(W.content.onBlur,Y);const Q=(0,y.h)(R),X={};return"label"===F?"string"==typeof W.content.children?X["aria-label"]=W.content.children:(X["aria-labelledby"]=W.content.id,W.shouldRenderTooltip=!0):"description"===F&&(X["aria-describedby"]=W.content.id,W.shouldRenderTooltip=!0),_&&(W.shouldRenderTooltip=!1),W.children=(0,b.L)(R,{...X,...null==Q?void 0:Q.props,ref:(0,f.a)(null==Q?void 0:Q.ref,Z,void 0===G.target?U:void 0),onPointerEnter:(0,S.D)((0,v.p)(null==Q||null===(t=Q.props)||void 0===t?void 0:t.onPointerEnter,J)),onPointerLeave:(0,S.D)((0,v.p)(null==Q||null===(o=Q.props)||void 0===o?void 0:o.onPointerLeave,Y)),onFocus:(0,S.D)((0,v.p)(null==Q||null===(k=Q.props)||void 0===k?void 0:k.onFocus,J)),onBlur:(0,S.D)((0,v.p)(null==Q||null===(T=Q.props)||void 0===T?void 0:T.onBlur,Y))}),W})(e);return(e=>{const t=A();e.content.className=(0,E.z)("fui-Tooltip__content",t.root,"inverted"===e.appearance&&t.inverted,e.visible&&t.visible,e.content.className),e.arrowClassName=t.arrow})(t),(0,_.$e)("useTooltipStyles_unstable")(t),(e=>((0,x.C)(e),(0,k.FD)(i.Fragment,{children:[e.children,e.shouldRenderTooltip&&(0,k.Y)(T.Z,{mountNode:e.mountNode,children:(0,k.FD)(e.content,{children:[e.withArrow&&(0,k.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.content.children]})})]})))(t)};B.displayName="Tooltip",B.isFluentTriggerComponent=!0},98881:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,d:()=>i});const i=6,n=4},95848:(e,t,o)=>{"use strict";o.d(t,{g:()=>n});var i=o(95734);function n(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&!(0,i.isValidElement)(e)}},12541:(e,t,o)=>{"use strict";o.d(t,{X:()=>n});var i=o(95734);function n(e,t){const o=i.useRef(void 0),n=i.useCallback(((i,n)=>(void 0!==o.current&&t(o.current),o.current=e(i,n),o.current)),[t,e]),r=i.useCallback((()=>{void 0!==o.current&&(t(o.current),o.current=void 0)}),[t]);return i.useEffect((()=>r),[r]),[n,r]}},59906:(e,t,o)=>{"use strict";o.d(t,{i:()=>n});var i=o(95734);const n=e=>{const[t,o]=i.useState((()=>void 0===e.defaultState?e.initialState:"function"==typeof e.defaultState?e.defaultState():e.defaultState)),n=i.useRef(e.state);i.useEffect((()=>{n.current=e.state}),[e.state]);const s=i.useCallback((e=>{(function(e){return"function"==typeof e})(e)&&e(n.current)}),[]);return r(e.state)?[e.state,s]:[t,o]},r=e=>{const[t]=i.useState((()=>void 0!==e));return t}},81585:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});var i=o(95734);if(3023==o.j)var n=o(47586);const r=e=>{const t=i.useRef((()=>{throw new Error("Cannot call an event handler while rendering")}));return(0,n.E)((()=>{t.current=e}),[e]),i.useCallback(((...e)=>(0,t.current)(...e)),[t])}},62987:(e,t,o)=>{"use strict";o.d(t,{t:()=>n});var i=o(95734);function n(){const e=i.useRef(!0);return e.current?(e.current=!1,!0):e.current}},44854:(e,t,o)=>{"use strict";o.d(t,{W:()=>a});var i=o(95734);if(3023==o.j)var n=o(81585);if(3023==o.j)var r=o(99677);const s=(e,t)=>!!(null==e?void 0:e.contains(t)),a=e=>{const{targetDocument:t}=(0,r.Y)(),o=null==t?void 0:t.defaultView,{refs:a,callback:c,element:d,disabled:g,disabledFocusOnIframe:h,contains:p=s}=e,f=i.useRef(void 0);u({element:d,disabled:h||g,callback:c,refs:a,contains:p});const m=i.useRef(!1),v=(0,n.D)((e=>{if(m.current)return void(m.current=!1);const t=e.composedPath()[0];a.every((e=>!p(e.current||null,t)))&&!g&&c(e)})),y=(0,n.D)((e=>{m.current=a.some((t=>p(t.current||null,e.target)))}));i.useEffect((()=>{if(g)return;let e=l(o);const t=t=>{t!==e?v(t):e=void 0};return null==d||d.addEventListener("click",t,!0),null==d||d.addEventListener("touchstart",t,!0),null==d||d.addEventListener("contextmenu",t,!0),null==d||d.addEventListener("mousedown",y,!0),f.current=null==o?void 0:o.setTimeout((()=>{e=void 0}),1),()=>{null==d||d.removeEventListener("click",t,!0),null==d||d.removeEventListener("touchstart",t,!0),null==d||d.removeEventListener("contextmenu",t,!0),null==d||d.removeEventListener("mousedown",y,!0),null==o||o.clearTimeout(f.current),e=void 0}}),[v,d,g,y,o])},l=e=>{var t,o,i;if(e)return"object"==typeof e.window&&e.window===e?e.event:null!==(i=null===(o=e.ownerDocument)||void 0===o||null===(t=o.defaultView)||void 0===t?void 0:t.event)&&void 0!==i?i:void 0},c="fuiframefocus",u=e=>{const{disabled:t,element:o,callback:r,contains:a=s,pollDuration:l=1e3,refs:u}=e,d=i.useRef(),g=(0,n.D)((e=>{u.every((t=>!a(t.current||null,e.target)))&&!t&&r(e)}));i.useEffect((()=>{if(!t)return null==o||o.addEventListener(c,g,!0),()=>{null==o||o.removeEventListener(c,g,!0)}}),[o,t,g]),i.useEffect((()=>{var e;if(!t)return d.current=null==o||null===(e=o.defaultView)||void 0===e?void 0:e.setInterval((()=>{const e=null==o?void 0:o.activeElement;if("IFRAME"===(null==e?void 0:e.tagName)||"WEBVIEW"===(null==e?void 0:e.tagName)){const t=new CustomEvent(c,{bubbles:!0});e.dispatchEvent(t)}}),l),()=>{var e;null==o||null===(e=o.defaultView)||void 0===e||e.clearTimeout(d.current)}}),[o,t,l])}},53657:(e,t,o)=>{"use strict";o.d(t,{z:()=>r});var i=o(95734);if(3023==o.j)var n=o(81585);const r=e=>{const{refs:t,callback:o,element:r,disabled:s,contains:a}=e,l=(0,n.D)((e=>{const i=a||((e,t)=>!!(null==e?void 0:e.contains(t))),n=e.composedPath()[0];t.every((e=>!i(e.current||null,n)))&&!s&&o(e)}));i.useEffect((()=>{if(!s)return null==r||r.addEventListener("wheel",l),null==r||r.addEventListener("touchmove",l),()=>{null==r||r.removeEventListener("wheel",l),null==r||r.removeEventListener("touchmove",l)}}),[l,r,s])}},82261:(e,t,o)=>{"use strict";if(o.d(t,{Z:()=>a}),3023==o.j)var i=o(12541);if(3023==o.j)var n=o(99677);const r=e=>-1,s=e=>{};function a(){const{targetDocument:e}=(0,n.Y)(),t=null==e?void 0:e.defaultView,o=t?t.setTimeout:r,a=t?t.clearTimeout:s;return(0,i.X)(o,a)}},67719:(e,t,o)=>{"use strict";o.d(t,{L:()=>r});var i=o(95734);if(3023==o.j)var n=o(33457);function r(e,t){return"function"==typeof e?e(t):e?s(e,t):e||null}function s(e,t){if(!i.isValidElement(e)||e.type===i.Fragment)throw new Error("A trigger element must be a single element for this component. Please ensure that you're not using React Fragments.");if((0,n.Z)(e)){const o=s(e.props.children,t);return i.cloneElement(e,void 0,o)}return i.cloneElement(e,t)}},81461:(e,t,o)=>{"use strict";o.d(t,{h:()=>r});var i=o(95734);if(3023==o.j)var n=o(33457);function r(e){return i.isValidElement(e)?(0,n.Z)(e)?r(e.props.children):e:null}},33457:(e,t,o)=>{"use strict";function i(e){return Boolean(e.type.isFluentTriggerComponent)}o.d(t,{Z:()=>i}),o(95734)},44585:(e,t,o)=>{"use strict";function i(e,t){const o={};for(const i in e)-1===t.indexOf(i)&&e.hasOwnProperty(i)&&(o[i]=e[i]);return o}o.d(t,{c:()=>i})},65373:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>n}),3023==o.j)var i=o(98456);function n(e,t){if(!e||!t)return!1;if(e===t)return!0;{const o=new WeakSet;for(;t;){const n=(0,i.P)(t,{skipVirtual:o.has(t)});if(o.add(t),n===e)return!0;t=n}}return!1}},98456:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>n}),3023==o.j)var i=o(223);function n(e,t={}){if(!e)return null;if(!t.skipVirtual){const t=function(e){return(0,i.q)(e)&&e._virtual.parent||null}(e);if(t)return t}const o=e.parentNode;return o&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o}},223:(e,t,o)=>{"use strict";function i(e){return e&&!!e._virtual}o.d(t,{q:()=>i})},61369:(e,t,o)=>{"use strict";function i(e,t){var o;const i=e;var n;return Boolean((null==i||null===(o=i.ownerDocument)||void 0===o?void 0:o.defaultView)&&i instanceof i.ownerDocument.defaultView[null!==(n=null==t?void 0:t.constructorName)&&void 0!==n?n:"HTMLElement"])}o.d(t,{s:()=>i})},16545:(e,t,o)=>{"use strict";function i(e,t){if(!e)return;const o=e;o._virtual||(o._virtual={}),o._virtual.parent=t}o.d(t,{g:()=>i})},37024:(e,t,o)=>{"use strict";o.d(t,{_:()=>mt});var i=o(30206),n=o(95734),r=o(20405),s=o(77732),a=o(31075),l=o(85849),c=o(42093),u=o(74906),d=o(37128),g=o(12928),h=o(55125),p=o(7969),f=o(35143),m=o(77825);function v(e,t,o){var i=e[o],n=t[o];(i||n)&&(e[o]=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return n&&(e=n.apply(this,t)),i!==n&&(e=i.apply(this,t)),e})}function y(){return null}!function(e){function t(o,i){var n=e.call(this,o,i)||this;return function(e,t,o){for(var i=0,n=o.length;i<n;i++)v(e,t,o[i])}(n,t.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),n}(0,i.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this._updateComponentRef(e,this.props)},t.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},t.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var o=this.__disposables[e];o.dispose&&o.dispose()}this.__disposables=null}},Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_async",{get:function(){return this.__async||(this.__async=new g.j(this),this._disposables.push(this.__async)),this.__async},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_events",{get:function(){return this.__events||(this.__events=new h.g(this),this._disposables.push(this.__events)),this.__events},enumerable:!1,configurable:!0}),t.prototype._resolveRef=function(e){var t=this;return this.__resolves||(this.__resolves={}),this.__resolves[e]||(this.__resolves[e]=function(o){return t[e]=o}),this.__resolves[e]},t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={}),e&&t&&e.componentRef!==t.componentRef&&(this._setComponentRef(e.componentRef,null),this._setComponentRef(t.componentRef,this))},t.prototype._warnDeprecations=function(e){this.className,this.props},t.prototype._warnMutuallyExclusive=function(e){this.className,this.props},t.prototype._warnConditionallyRequiredProps=function(e,t,o){this.className,this.props},t.prototype._setComponentRef=function(e,t){!this._skipComponentRefResolution&&e&&("function"==typeof e&&e(t),"object"==typeof e&&(e.current=t))}}(n.Component);var b,S=o(3453),C=o(34907),w=o(3749);!function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(b||(b={}));var k=o(2193),T=o(14523),x=o(49166),_=o(59197),I=(0,x.Z)({cacheSize:100}),E=function(e){function t(t){var o=e.call(this,t)||this;return o._onImageLoadingStateChange=function(e){o.props.imageProps&&o.props.imageProps.onLoadingStateChange&&o.props.imageProps.onLoadingStateChange(e),e===T.P6.error&&o.setState({imageLoadError:!0})},o.state={imageLoadError:!1},o}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,o=e.className,r=e.styles,s=e.iconName,a=e.imageErrorAs,l=e.theme,c="string"==typeof s&&0===s.length,u=!!this.props.imageProps||this.props.iconType===b.image||this.props.iconType===b.Image,d=(0,_.ne)(s)||{},g=d.iconClassName,h=d.children,p=d.mergeImageProps,m=I(r,{theme:l,className:o,iconClassName:g,isImage:u,isPlaceholder:c}),v=u?"span":"i",y=(0,f.G1)(this.props,f.vt,["aria-label"]),S=this.state.imageLoadError,C=(0,i.__assign)((0,i.__assign)({},this.props.imageProps),{onLoadingStateChange:this._onImageLoadingStateChange}),w=S&&a||k._,T=this.props["aria-label"]||this.props.ariaLabel,x=C.alt||T||this.props.title,E=x||this.props["aria-labelledby"]||C["aria-label"]||C["aria-labelledby"]?{role:u||p?void 0:"img","aria-label":u||p?void 0:x}:{"aria-hidden":!0},A=h;return p&&h&&"object"==typeof h&&x&&(A=n.cloneElement(h,{alt:x})),n.createElement(v,(0,i.__assign)({"data-icon-name":s},E,y,p?{title:void 0,"aria-label":void 0}:{},{className:m.root}),u?n.createElement(w,(0,i.__assign)({},C)):t||A)},t}(n.Component),A=o(87542),B=(0,w.I)(E,A.$f,void 0,{scope:"Icon"},!0);B.displayName="Icon";var R,M=function(e){var t=e.className,o=e.imageProps,r=(0,f.G1)(e,f.vt,["aria-label","aria-labelledby","title","aria-describedby"]),s=o.alt||e["aria-label"],l=s||e["aria-labelledby"]||e.title||o["aria-label"]||o["aria-labelledby"]||o.title,c={"aria-labelledby":e["aria-labelledby"],"aria-describedby":e["aria-describedby"],title:e.title},u=l?{}:{"aria-hidden":!0};return n.createElement("div",(0,i.__assign)({},u,r,{className:(0,a.A)(A.xD,A.xW.root,A.xW.image,t)}),n.createElement(k._,(0,i.__assign)({},c,o,{alt:l?s:""})))},D=o(60351),P=(0,s.J5)((function(e){return(0,s.J5)((function(t){var o=(0,s.J5)((function(e){return function(o){return t(o,e)}}));return function(i,n){return e(i,n?o(n):t)}}))}));!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.Section=3]="Section"}(R||(R={}));var N,F=o(88891),O=o(19728),j=o(33362),q=o(87886),L=o(93293),H=o(34959);function z(e){var t;if(void 0===N||e){var o=(0,H.z)(),i=null===(t=null==o?void 0:o.navigator)||void 0===t?void 0:t.userAgent;N=!!i&&-1!==i.indexOf("Macintosh")}return!!N}var W=function(){return!!(window&&window.navigator&&window.navigator.userAgent)&&/iPad|iPhone|iPod/i.test(window.navigator.userAgent)},G=o(35226),U=(0,s.J5)((function(e){var t=e;return(0,s.J5)((function(o){if(e===o)throw new Error("Attempted to compose a component with itself.");var r=o,a=(0,s.J5)((function(e){return function(t){return n.createElement(r,(0,i.__assign)({},t,{defaultRender:e}))}}));return function(e){var o=e.defaultRender;return n.createElement(t,(0,i.__assign)({},e,{defaultRender:o?a(o):r}))}}))}));function V(e,t){return U(e)(t)}function $(e){return e.canCheck?!(!e.isChecked&&!e.checked):"boolean"==typeof e.isChecked?e.isChecked:"boolean"==typeof e.checked?e.checked:null}function K(e){return!(!e.subMenuProps&&!e.items)}function J(e){return!(!e.isDisabled&&!e.disabled)}function Z(e){return null!==$(e)?"menuitemcheckbox":"menuitem"}var Y=o(24189),Q=function(e){var t=e.item,o=e.classNames,r=t.iconProps;return n.createElement(B,(0,i.__assign)({},r,{className:o.icon}))},X=function(e){var t=e.item;return e.hasIcons?t.onRenderIcon?t.onRenderIcon(e,Q):Q(e):null},ee=function(e){var t=e.onCheckmarkClick,o=e.item,i=e.classNames,r=$(o);return t?n.createElement(B,{iconName:!1!==o.canCheck&&r?"CheckMark":"",className:i.checkmarkIcon,onClick:function(e){return t(o,e)}}):null},te=function(e){var t=e.item,o=e.classNames;return t.text||t.name?n.createElement("span",{className:o.label},t.text||t.name):null},oe=function(e){var t=e.item,o=e.classNames;return t.secondaryText?n.createElement("span",{className:o.secondaryText},t.secondaryText):null},ie=function(e){var t=e.item,o=e.classNames,r=e.theme;return K(t)?n.createElement(B,(0,i.__assign)({iconName:(0,j.jI)(r)?"ChevronLeft":"ChevronRight"},t.submenuIconProps,{className:o.subMenuIcon})):null},ne=function(e){function t(t){var o=e.call(this,t)||this;return o.openSubMenu=function(){var e=o.props,t=e.item,i=e.openSubMenu,n=e.getSubmenuTarget;if(n){var r=n();K(t)&&i&&r&&i(t,r)}},o.dismissSubMenu=function(){var e=o.props,t=e.item,i=e.dismissSubMenu;K(t)&&i&&i()},o.dismissMenu=function(e){var t=o.props.dismissMenu;t&&t(void 0,e)},(0,d.f)(o),o}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,o=e.classNames,i=t.onRenderContent||this._renderLayout;return n.createElement("div",{className:t.split?o.linkContentMenu:o.linkContent},i(this.props,{renderCheckMarkIcon:ee,renderItemIcon:X,renderItemName:te,renderSecondaryText:oe,renderSubMenuIcon:ie}))},t.prototype._renderLayout=function(e,t){return n.createElement(n.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),t.renderItemName(e),t.renderSecondaryText(e),t.renderSubMenuIcon(e))},t}(n.Component),re=o(58546),se=(0,s.J9)((function(e){return(0,re.l8)({wrapper:{display:"inline-flex",height:"100%",alignItems:"center"},divider:{width:1,height:"100%",backgroundColor:e.palette.neutralTertiaryAlt}})})),ae=o(46161),le="28px",ce=(0,re.L6)(0,re.mm),ue=(0,s.J9)((function(e){var t;return(0,re.l8)(se(e),{wrapper:{position:"absolute",right:28,selectors:(t={},t[ce]={right:32},t)},divider:{height:16,width:1}})})),de={item:"ms-ContextualMenu-item",divider:"ms-ContextualMenu-divider",root:"ms-ContextualMenu-link",isChecked:"is-checked",isExpanded:"is-expanded",isDisabled:"is-disabled",linkContent:"ms-ContextualMenu-linkContent",linkContentMenu:"ms-ContextualMenu-linkContent",icon:"ms-ContextualMenu-icon",iconColor:"ms-ContextualMenu-iconColor",checkmarkIcon:"ms-ContextualMenu-checkmarkIcon",subMenuIcon:"ms-ContextualMenu-submenuIcon",label:"ms-ContextualMenu-itemText",secondaryText:"ms-ContextualMenu-secondaryText",splitMenu:"ms-ContextualMenu-splitMenu",screenReaderText:"ms-ContextualMenu-screenReaderText"},ge=(0,s.J9)((function(e,t,o,i,n,r,s,a,l,c,d,g){var h,p,f,m,v=(0,ae.J)(e),y=(0,re.Km)(de,e);return(0,re.l8)({item:[y.item,v.item,s],divider:[y.divider,v.divider,a],root:[y.root,v.root,i&&[y.isChecked,v.rootChecked],n&&v.anchorLink,o&&[y.isExpanded,v.rootExpanded],t&&[y.isDisabled,v.rootDisabled],!t&&!o&&[{selectors:(h={":hover":v.rootHovered,":active":v.rootPressed},h[".".concat(u.Y2," &:focus, .").concat(u.Y2," &:focus:hover, :host(.").concat(u.Y2,") &:focus, :host(.").concat(u.Y2,") &:focus:hover")]=v.rootFocused,h[".".concat(u.Y2," &:hover, :host(.").concat(u.Y2,") &:hover")]={background:"inherit;"},h)}],g],splitPrimary:[v.root,{width:"calc(100% - ".concat(le,")")},i&&["is-checked",v.rootChecked],(t||d)&&["is-disabled",v.rootDisabled],!(t||d)&&!i&&[{selectors:(p={":hover":v.rootHovered},p[":hover ~ .".concat(y.splitMenu)]=v.rootHovered,p[":active"]=v.rootPressed,p[".".concat(u.Y2," &:focus, .").concat(u.Y2," &:focus:hover, :host(.").concat(u.Y2,") &:focus, :host(.").concat(u.Y2,") &:focus:hover")]=v.rootFocused,p[".".concat(u.Y2," &:hover, :host(.").concat(u.Y2,") &:hover")]={background:"inherit;"},p)}]],splitMenu:[y.splitMenu,v.root,{flexBasis:"0",padding:"0 8px",minWidth:le},o&&["is-expanded",v.rootExpanded],t&&["is-disabled",v.rootDisabled],!t&&!o&&[{selectors:(f={":hover":v.rootHovered,":active":v.rootPressed},f[".".concat(u.Y2," &:focus, .").concat(u.Y2," &:focus:hover, :host(.").concat(u.Y2,") &:focus, :host(.").concat(u.Y2,") &:focus:hover")]=v.rootFocused,f[".".concat(u.Y2," &:hover, :host(.").concat(u.Y2,") &:hover")]={background:"inherit;"},f)}]],anchorLink:v.anchorLink,linkContent:[y.linkContent,v.linkContent],linkContentMenu:[y.linkContentMenu,v.linkContent,{justifyContent:"center"}],icon:[y.icon,r&&v.iconColor,v.icon,l,t&&[y.isDisabled,v.iconDisabled]],iconColor:v.iconColor,checkmarkIcon:[y.checkmarkIcon,r&&v.checkmarkIcon,v.icon,l],subMenuIcon:[y.subMenuIcon,v.subMenuIcon,c,o&&{color:e.palette.neutralPrimary},t&&[v.iconDisabled]],label:[y.label,v.label],secondaryText:[y.secondaryText,v.secondaryText],splitContainer:[v.splitButtonFlexContainer,!t&&!i&&[{selectors:(m={},m[".".concat(u.Y2," &:focus, .").concat(u.Y2," &:focus:hover, :host(.").concat(u.Y2,") &:focus, :host(.").concat(u.Y2,") &:focus:hover")]=v.rootFocused,m)}]],screenReaderText:[y.screenReaderText,v.screenReaderText,re.dX,{visibility:"hidden"}]})})),he=function(e){var t=e.theme,o=e.disabled,i=e.expanded,n=e.checked,r=e.isAnchorLink,s=e.knownIcon,a=e.itemClassName,l=e.dividerClassName,c=e.iconClassName,u=e.subMenuClassName,d=e.primaryDisabled,g=e.className;return ge(t,o,i,n,r,s,a,l,c,u,d,g)},pe=(0,w.I)(ne,he,void 0,{scope:"ContextualMenuItem"}),fe=function(e){function t(t){var o=e.call(this,t)||this;return o._onItemMouseEnter=function(e){var t=o.props,i=t.item,n=t.onItemMouseEnter;n&&n(i,e,e.currentTarget)},o._onItemClick=function(e){var t=o.props,i=t.item,n=t.onItemClickBase;n&&n(i,e,e.currentTarget)},o._onItemMouseLeave=function(e){var t=o.props,i=t.item,n=t.onItemMouseLeave;n&&n(i,e)},o._onItemKeyDown=function(e){var t=o.props,i=t.item,n=t.onItemKeyDown;n&&n(i,e)},o._onItemMouseMove=function(e){var t=o.props,i=t.item,n=t.onItemMouseMove;n&&n(i,e,e.currentTarget)},o._getSubmenuTarget=function(){},(0,d.f)(o),o}return(0,i.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return!(0,m.ab)(e,this.props)},t}(n.Component),me=o(50602),ve=o(53803),ye=function(e){var t,o=e.children,n=(0,i.__rest)(e,["children"]),r=(0,ve.i)(n),s=r.keytipId,a=r.ariaDescribedBy;return o(((t={})[me.aR]=s,t[me.er]=s,t["aria-describedby"]=a,t))},be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._anchor=n.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,s.J9)((function(e){return(0,i.__assign)((0,i.__assign)({},e),{hasMenu:!0})})),t._getSubmenuTarget=function(){return t._anchor.current?t._anchor.current:void 0},t._onItemClick=function(e){var o=t.props,i=o.item,n=o.onItemClick;n&&n(i,e)},t._renderAriaDescription=function(e,o){return e?n.createElement("span",{id:t._ariaDescriptionId,className:o},e):null},t}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.item,r=t.classNames,s=t.index,a=t.focusableElementIndex,l=t.totalItemCount,c=t.hasCheckmarks,u=t.hasIcons,d=t.expandedMenuItemKey,g=t.onItemClick,h=t.openSubMenu,m=t.dismissSubMenu,v=t.dismissMenu,y=pe;this.props.item.contextualMenuItemAs&&(y=V(this.props.item.contextualMenuItemAs,y)),this.props.contextualMenuItemAs&&(y=V(this.props.contextualMenuItemAs,y));var b=o.rel;o.target&&"_blank"===o.target.toLowerCase()&&(b=b||"nofollow noopener noreferrer");var S=K(o),w=(0,f.G1)(o,f.t0),k=J(o),T=o.itemProps,x=o.ariaDescription,_=o.keytipProps;_&&S&&(_=this._getMemoizedMenuButtonKeytipProps(_)),x&&(this._ariaDescriptionId=(0,p.O)());var I=(0,C._)(o.ariaDescribedBy,x?this._ariaDescriptionId:void 0,w["aria-describedby"]),E={"aria-describedby":I};return n.createElement("div",null,n.createElement(ye,{keytipProps:o.keytipProps,ariaDescribedBy:I,disabled:k},(function(t){return n.createElement("a",(0,i.__assign)({},E,w,t,{ref:e._anchor,href:o.href,target:o.target,rel:b,className:r.root,role:"menuitem","aria-haspopup":S||void 0,"aria-expanded":S?o.key===d:void 0,"aria-posinset":a+1,"aria-setsize":l,"aria-disabled":J(o),style:o.style,onClick:e._onItemClick,onMouseEnter:e._onItemMouseEnter,onMouseLeave:e._onItemMouseLeave,onMouseMove:e._onItemMouseMove,onKeyDown:S?e._onItemKeyDown:void 0}),n.createElement(y,(0,i.__assign)({componentRef:o.componentRef,item:o,classNames:r,index:s,onCheckmarkClick:c&&g?g:void 0,hasIcons:u,openSubMenu:h,dismissSubMenu:m,dismissMenu:v,getSubmenuTarget:e._getSubmenuTarget},T)),e._renderAriaDescription(x,r.screenReaderText))})))},t}(fe),Se=(0,x.Z)(),Ce=n.forwardRef((function(e,t){var o=e.styles,i=e.theme,r=e.getClassNames,s=e.className,a=Se(o,{theme:i,getClassNames:r,className:s});return n.createElement("span",{className:a.wrapper,ref:t},n.createElement("span",{className:a.divider}))}));Ce.displayName="VerticalDividerBase";var we=(0,w.I)(Ce,(function(e){var t=e.theme,o=e.getClassNames,i=e.className;if(!t)throw new Error("Theme is undefined or null.");if(o){var n=o(t);return{wrapper:[n.wrapper],divider:[n.divider]}}return{wrapper:[{display:"inline-flex",height:"100%",alignItems:"center"},i],divider:[{width:1,height:"100%",backgroundColor:t.palette.neutralTertiaryAlt}]}}),void 0,{scope:"VerticalDivider"}),ke=function(e){function t(t){var o=e.call(this,t)||this;return o._getMemoizedMenuButtonKeytipProps=(0,s.J9)((function(e){return(0,i.__assign)((0,i.__assign)({},e),{hasMenu:!0})})),o._onItemKeyDown=function(e){var t=o.props,i=t.item,n=t.onItemKeyDown;e.which===c.c.enter?(o._executeItemClick(e),e.preventDefault(),e.stopPropagation()):n&&n(i,e)},o._getSubmenuTarget=function(){return o._splitButton},o._renderAriaDescription=function(e,t){return e?n.createElement("span",{id:o._ariaDescriptionId,className:t},e):null},o._onItemMouseEnterPrimary=function(e){var t=o.props,n=t.item,r=t.onItemMouseEnter;r&&r((0,i.__assign)((0,i.__assign)({},n),{subMenuProps:void 0,items:void 0}),e,o._splitButton)},o._onItemMouseEnterIcon=function(e){var t=o.props,i=t.item,n=t.onItemMouseEnter;n&&n(i,e,o._splitButton)},o._onItemMouseMovePrimary=function(e){var t=o.props,n=t.item,r=t.onItemMouseMove;r&&r((0,i.__assign)((0,i.__assign)({},n),{subMenuProps:void 0,items:void 0}),e,o._splitButton)},o._onItemMouseMoveIcon=function(e){var t=o.props,i=t.item,n=t.onItemMouseMove;n&&n(i,e,o._splitButton)},o._onIconItemClick=function(e){var t=o.props,i=t.item,n=t.onItemClickBase;n&&n(i,e,o._splitButton?o._splitButton:e.currentTarget)},o._executeItemClick=function(e){var t=o.props,i=t.item,n=t.executeItemClick,r=t.onItemClick;if(!i.disabled&&!i.isDisabled)return o._processingTouch&&!i.canCheck&&r?r(i,e):void(n&&n(i,e))},o._onTouchStart=function(e){o._splitButton&&!("onpointerdown"in o._splitButton)&&o._handleTouchAndPointerEvent(e)},o._onPointerDown=function(e){"touch"===e.pointerType&&(o._handleTouchAndPointerEvent(e),e.preventDefault(),e.stopImmediatePropagation())},o._async=new g.j(o),o._events=new h.g(o),o._dismissLabelId=(0,p.O)(),o}return(0,i.__extends)(t,e),t.prototype.componentDidMount=function(){this._splitButton&&"onpointerdown"in this._splitButton&&this._events.on(this._splitButton,"pointerdown",this._onPointerDown,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e,t=this,o=this.props,r=o.item,s=o.classNames,a=o.index,l=o.focusableElementIndex,c=o.totalItemCount,u=o.hasCheckmarks,d=o.hasIcons,g=o.onItemMouseLeave,h=o.expandedMenuItemKey,f=K(r),m=r.keytipProps;m&&(m=this._getMemoizedMenuButtonKeytipProps(m));var v=r.ariaDescription;v&&(this._ariaDescriptionId=(0,p.O)());var y=null!==(e=$(r))&&void 0!==e?e:void 0;return n.createElement(ye,{keytipProps:m,disabled:J(r)},(function(e){return n.createElement("div",{"data-ktp-target":e["data-ktp-target"],ref:function(e){return t._splitButton=e},role:Z(r),"aria-label":r.ariaLabel,className:s.splitContainer,"aria-disabled":J(r),"aria-expanded":f?r.key===h:void 0,"aria-haspopup":!0,"aria-describedby":(0,C._)(r.ariaDescribedBy,v?t._ariaDescriptionId:void 0,e["aria-describedby"]),"aria-checked":y,"aria-posinset":l+1,"aria-setsize":c,onMouseEnter:t._onItemMouseEnterPrimary,onMouseLeave:g?g.bind(t,(0,i.__assign)((0,i.__assign)({},r),{subMenuProps:null,items:null})):void 0,onMouseMove:t._onItemMouseMovePrimary,onKeyDown:t._onItemKeyDown,onClick:t._executeItemClick,onTouchStart:t._onTouchStart,tabIndex:0,"data-is-focusable":!0,"aria-roledescription":r["aria-roledescription"]},t._renderSplitPrimaryButton(r,s,a,u,d),t._renderSplitDivider(r),t._renderSplitIconButton(r,s,a,e),t._renderAriaDescription(v,s.screenReaderText))}))},t.prototype._renderSplitPrimaryButton=function(e,t,o,r,s){var a=this.props,l=a.contextualMenuItemAs,c=void 0===l?pe:l,u=a.onItemClick,d={key:e.key,disabled:J(e)||e.primaryDisabled,name:e.name,text:e.text||e.name,secondaryText:e.secondaryText,className:t.splitPrimary,canCheck:e.canCheck,isChecked:e.isChecked,checked:e.checked,iconProps:e.iconProps,id:this._dismissLabelId,onClick:e.onClick,onRenderIcon:e.onRenderIcon,data:e.data,"data-is-focusable":!1},g=e.itemProps;return n.createElement("button",(0,i.__assign)({},(0,f.G1)(d,f.uw)),n.createElement(c,(0,i.__assign)({"data-is-focusable":!1,item:d,classNames:t,index:o,onCheckmarkClick:r&&u?u:void 0,hasIcons:s},g)))},t.prototype._renderSplitDivider=function(e){var t=e.getSplitButtonVerticalDividerClassNames||ue;return n.createElement(we,{getClassNames:t})},t.prototype._renderSplitIconButton=function(e,t,o,r){var s=this.props,a=s.onItemMouseLeave,l=s.onItemMouseDown,c=s.openSubMenu,u=s.dismissSubMenu,d=s.dismissMenu,g=pe;this.props.item.contextualMenuItemAs&&(g=V(this.props.item.contextualMenuItemAs,g)),this.props.contextualMenuItemAs&&(g=V(this.props.contextualMenuItemAs,g));var h={onClick:this._onIconItemClick,disabled:J(e),className:t.splitMenu,subMenuProps:e.subMenuProps,submenuIconProps:e.submenuIconProps,split:!0,key:e.key,"aria-labelledby":this._dismissLabelId},p=(0,i.__assign)((0,i.__assign)({},(0,f.G1)(h,f.uw)),{onMouseEnter:this._onItemMouseEnterIcon,onMouseLeave:a?a.bind(this,e):void 0,onMouseDown:function(t){return l?l(e,t):void 0},onMouseMove:this._onItemMouseMoveIcon,"data-is-focusable":!1,"data-ktp-execute-target":r["data-ktp-execute-target"],"aria-haspopup":!0}),m=e.itemProps;return n.createElement("button",(0,i.__assign)({},p),n.createElement(g,(0,i.__assign)({componentRef:e.componentRef,item:h,classNames:t,index:o,hasIcons:!1,openSubMenu:c,dismissSubMenu:u,dismissMenu:d,getSubmenuTarget:this._getSubmenuTarget},m)))},t.prototype._handleTouchAndPointerEvent=function(e){var t=this,o=this.props.onTap;o&&o(e),this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){t._processingTouch=!1,t._lastTouchTimeoutId=void 0}),500)},t}(fe),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._btn=n.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,s.J9)((function(e){return(0,i.__assign)((0,i.__assign)({},e),{hasMenu:!0})})),t._renderAriaDescription=function(e,o){return e?n.createElement("span",{id:t._ariaDescriptionId,className:o},e):null},t._getSubmenuTarget=function(){return t._btn.current?t._btn.current:void 0},t}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.item,r=t.classNames,s=t.index,a=t.focusableElementIndex,l=t.totalItemCount,c=t.hasCheckmarks,u=t.hasIcons,d=t.contextualMenuItemAs,g=t.expandedMenuItemKey,h=t.onItemMouseDown,m=t.onItemClick,v=t.openSubMenu,y=t.dismissSubMenu,b=t.dismissMenu,S=pe;o.contextualMenuItemAs&&(S=V(o.contextualMenuItemAs,S)),d&&(S=V(d,S));var w=$(o),k=null!==w,T=Z(o),x=K(o),_=o.itemProps,I=o.ariaLabel,E=o.ariaDescription,A=(0,f.G1)(o,f.uw);delete A.disabled;var B=o.role||T;E&&(this._ariaDescriptionId=(0,p.O)());var R=(0,C._)(o.ariaDescribedBy,E?this._ariaDescriptionId:void 0,A["aria-describedby"]),M={className:r.root,onClick:this._onItemClick,onKeyDown:x?this._onItemKeyDown:void 0,onMouseEnter:this._onItemMouseEnter,onMouseLeave:this._onItemMouseLeave,onMouseDown:function(e){return h?h(o,e):void 0},onMouseMove:this._onItemMouseMove,href:o.href,title:o.title,"aria-label":I,"aria-describedby":R,"aria-haspopup":x||void 0,"aria-expanded":x?o.key===g:void 0,"aria-posinset":a+1,"aria-setsize":l,"aria-disabled":J(o),"aria-checked":"menuitemcheckbox"!==B&&"menuitemradio"!==B||!k?void 0:!!w,"aria-selected":"menuitem"===B&&k?!!w:void 0,role:B,style:o.style},D=o.keytipProps;return D&&x&&(D=this._getMemoizedMenuButtonKeytipProps(D)),n.createElement(ye,{keytipProps:D,ariaDescribedBy:R,disabled:J(o)},(function(t){return n.createElement("button",(0,i.__assign)({ref:e._btn},A,M,t),n.createElement(S,(0,i.__assign)({componentRef:o.componentRef,item:o,classNames:r,index:s,onCheckmarkClick:c&&m?m:void 0,hasIcons:u,openSubMenu:v,dismissSubMenu:y,dismissMenu:b,getSubmenuTarget:e._getSubmenuTarget},_)),e._renderAriaDescription(E,r.screenReaderText))}))},t}(fe),xe=o(99269),_e=o(26557),Ie=o(61037),Ee=o(84586),Ae=o(9477),Be=o(6625),Re=o(99719),Me=o(70325),De=n.createContext({}),Pe=(0,x.Z)(),Ne=(0,x.Z)(),Fe={items:[],shouldFocusOnMount:!0,gapSpace:0,directionalHint:D.A.bottomAutoEdge,beakWidth:16};function Oe(e){for(var t=0,o=0,i=e;o<i.length;o++){var n=i[o];n.itemType!==R.Divider&&n.itemType!==R.Header&&(t+=n.customOnRenderListLength?n.customOnRenderListLength:1)}return t}function je(e,t){var o=null==t?void 0:t.target,n=e.subMenuProps?e.subMenuProps.items:e.items;if(n){for(var r=[],s=0,a=n;s<a.length;s++){var l=a[s];if(l.preferMenuTargetAsEventTarget){var c=l.onClick,u=(0,i.__rest)(l,["onClick"]);r.push((0,i.__assign)((0,i.__assign)({},u),{onClick:$e(c,o)}))}else r.push(l)}return r}}var qe="ContextualMenu",Le=(0,s.J9)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return re.pB.apply(void 0,(0,i.__spreadArray)([t,he],e,!1))}}));function He(e,t){var o=e.hidden,i=e.items,r=e.theme,s=e.className,a=e.id,l=e.target,c=n.useState(),u=c[0],d=c[1],g=n.useState(),h=g[0],p=g[1],f=n.useState(),v=f[0],y=f[1],b=(0,_e.B)(qe,a),S=n.useCallback((function(){y(void 0),d(void 0),p(void 0)}),[]),C=n.useCallback((function(e,t,o){var i=e.key;u!==i&&(t.focus(),y(o),d(i),p(t))}),[u]);n.useEffect((function(){o&&S()}),[o,S]);var w=function(e,t){var o=n.useRef(!1);n.useEffect((function(){return o.current=!0,function(){o.current=!1}}),[]);return function(i,n){n?e(i,n):o.current&&t()}}(t,S);return[u,C,function(){var e=Ve(u,i),t=null;if(e&&(t={items:je(e,{target:l}),target:h,onDismiss:w,isSubMenu:!0,id:b,shouldFocusOnMount:!0,shouldFocusOnContainer:v,directionalHint:(0,j.jI)(r)?D.A.leftTopEdge:D.A.rightTopEdge,className:s,gapSpace:0,isBeakVisible:!1},e.subMenuProps&&(0,m.kp)(t,e.subMenuProps),e.preferMenuTargetAsEventTarget)){var o=e.onItemClick;t.onItemClick=$e(o,l)}return t},w]}var ze=n.memo(n.forwardRef((function(e,t){var o,r=(0,G.N)(Fe,e),s=(r.ref,(0,i.__rest)(r,["ref"])),l=n.useRef(null),u=(0,Ee.Y)(),d=(0,_e.B)(qe,s.id),g=function(e,t){var o;return null===(o=s.onDismiss)||void 0===o?void 0:o.call(s,e,t)},h=(0,Ae.P)(s.target,l),p=h[0],m=h[1],v=function(e,t,o){var i=e.hidden,r=e.onRestoreFocus,s=n.useRef(),a=n.useCallback((function(e){var t,o;r?r(e):(null==e?void 0:e.documentContainsFocus)&&(null===(o=null===(t=s.current)||void 0===t?void 0:t.focus)||void 0===o||o.call(t))}),[r]);return(0,Ie.E)((function(){var e,n;if(i)s.current&&(a({originalElement:s.current,containsFocus:!0,documentContainsFocus:(null===(n=(0,q.Y)())||void 0===n?void 0:n.hasFocus())||!1}),s.current=void 0);else{var r=null==t?void 0:t.document.activeElement;(null===(e=o.current)||void 0===e?void 0:e.contains(r))||"BODY"===r.tagName||(s.current=r)}}),[i,null==t?void 0:t.document.activeElement,a,o]),[a]}(s,m,l)[0],y=He(s,g),b=y[0],C=y[1],w=y[2],k=y[3],T=function(e){var t=e.delayUpdateFocusOnHover,o=e.hidden,i=n.useRef(!t),r=n.useRef(!1);n.useEffect((function(){i.current=!t,r.current=!o&&!t&&r.current}),[t,o]);var s=n.useCallback((function(){t&&(i.current=!1)}),[t]);return[i,r,s]}(s),x=T[0],_=T[1],I=T[2],E=function(e){var t=n.useRef(!0),o=n.useRef();return[function(){t.current||void 0===o.current?t.current=!1:(e.clearTimeout(o.current),o.current=void 0),o.current=e.setTimeout((function(){t.current=!0}),250)},t]}(u),A=E[0],B=E[1],M=function(e,t){var o=e.subMenuHoverDelay,i=void 0===o?250:o,r=n.useRef(void 0),s=function(){void 0!==r.current&&(t.clearTimeout(r.current),r.current=void 0)};return[s,function(e){r.current=t.setTimeout((function(){e(),s()}),i)},r]}(s,u),D=M[0],P=M[1],N=M[2],U=function(e,t){var o=n.useState((0,Re.YF)()),i=o[0],r=o[1],s=n.useCallback((function(){var t=(0,Re.kA)((0,H.z)(e.current));i!==t&&r(t)}),[e,i]),a=(0,Me.ox)();return(0,Be.x)(a,"resize",s),n.useEffect((function(){void 0===t&&s()}),[t]),null!=t?t:i}(l,s.responsiveMode);!function(e,t){var o=e.hidden,i=void 0!==o&&o,r=e.onMenuDismissed,s=e.onMenuOpened,a=(0,xe.Z)(i),l=n.useRef(s),c=n.useRef(r),u=n.useRef(e);l.current=s,c.current=r,u.current=e,n.useEffect((function(){var e,t;i&&!1===a?null===(e=c.current)||void 0===e||e.call(c,u.current):i||!1===a||null===(t=l.current)||void 0===t||t.call(l,u.current)}),[i,a]),n.useEffect((function(){return function(){var e;return null===(e=c.current)||void 0===e?void 0:e.call(c,u.current)}}),[])}(s);var Z,Q=function(e,t,o,i){var r=e.theme,s=e.isSubMenu,a=e.focusZoneProps,l=void 0===a?{}:a,u=l.checkForNoWrap,d=l.direction,g=void 0===d?F.E.vertical:d,h=n.useRef(),p=function(e,o,i){var n=!1;return o(e)&&(t(e,i),e.preventDefault(),e.stopPropagation(),n=!0),n},f=function(e){return e.which===c.c.escape||function(e){var t=(0,j.jI)(r)?c.c.right:c.c.left;return!(e.which!==t||!s||g!==F.E.vertical&&(!u||(0,L._l)(e.target,"data-no-horizontal-wrap")))}(e)||e.which===c.c.up&&(e.altKey||e.metaKey)},m=function(e){h.current=We(e);var t=e.which===c.c.escape&&(z()||W());return p(e,f,t)},v=function(e){var t=h.current&&We(e);return h.current=!1,!!t&&!(W()||z())};return[m,function(e){return p(e,v,!0)},function(e){if(!m(e)&&o.current){var t=!(!e.altKey&&!e.metaKey),i=e.which===c.c.up,n=e.which===c.c.down;if(!t&&(i||n)){var r=i?(0,L.dm)(o.current,o.current.lastChild,!0):(0,L.j5)(o.current,o.current.firstChild,!0);r&&(r.focus(),e.preventDefault(),e.stopPropagation())}}},function(e,t){var o=(0,j.jI)(r)?c.c.left:c.c.right;e.disabled||t.which!==o&&t.which!==c.c.enter&&(t.which!==c.c.down||!t.altKey&&!t.metaKey)||(i(e,t.currentTarget),t.preventDefault())}]}(s,g,l,C),X=Q[0],ee=Q[1],te=Q[2],oe=Q[3],ie=function(e,t,o,i,n,r,s,a,l,c,u,d,g){var h=e.target,p=function(){return!t.current||!r.current},f=function(e,t,o){var i=o||t.currentTarget;e.key!==s&&(c(),void 0===s&&i.focus(),K(e)?(t.stopPropagation(),l((function(){i.focus(),u(e,i,!0)}))):l((function(){d(t),i.focus()})))},m=function(t,o,i){var n=je(t,{target:h});if(c(),K(t)||n&&n.length){if(t.key!==s){var r="boolean"==typeof e.shouldFocusOnContainer?e.shouldFocusOnContainer:"mouse"===o.nativeEvent.pointerType;u(t,i,r)}}else v(t,o);o.stopPropagation(),o.preventDefault()},v=function(t,o){if(!t.disabled&&!t.isDisabled){t.preferMenuTargetAsEventTarget&&Ke(o,h);var i=!1;t.onClick?i=!!t.onClick(o,t):e.onItemClick&&(i=!!e.onItemClick(o,t)),!i&&o.defaultPrevented||g(o,!0)}};return[function(e,t,o){n.current&&(r.current=!0),p()||f(e,t,o)},function(e,s,a){var l=s.currentTarget;n.current&&(r.current=!0,t.current&&void 0===o.current&&l!==(null==i?void 0:i.document.activeElement)&&f(e,s,a))},function(e,t){var o;if(!p()&&(c(),void 0===s))if(a.current.setActive)try{a.current.setActive()}catch(e){}else null===(o=a.current)||void 0===o||o.focus()},function(e,t){m(e,t,t.currentTarget)},function(e,t){v(e,t),t.stopPropagation()},v,m]}(s,B,N,m,x,_,b,l,P,D,C,k,g),ne=ie[0],re=ie[1],se=ie[2],ae=ie[3],le=ie[4],ce=ie[5],ue=ie[6],de=function(e,t,o){var i=0,r=e.items,s=e.totalItemCount,a=e.hasCheckmarks,l=e.hasIcons;return n.createElement("ul",{className:t.list,onKeyDown:X,onKeyUp:ee,role:"presentation"},r.map((function(e,o){var n=ge(e,o,i,s,a,l,t);if(e.itemType!==R.Divider&&e.itemType!==R.Header){var r=e.customOnRenderListLength?e.customOnRenderListLength:1;i+=r}return n})))},ge=function(e,t,o,i,r,a,l){var c,u,d=[],g=e.iconProps||{iconName:"None"},h=e.getItemClassNames,p=e.itemProps,f=p?p.styles:void 0,m=e.itemType===R.Divider?e.className:void 0,v=e.submenuIconProps?e.submenuIconProps.className:"";if(h)u=h(s.theme,J(e),b===e.key,!!$(e),!!e.href,"None"!==g.iconName,e.className,m,g.className,v,e.primaryDisabled);else{var y={theme:s.theme,disabled:J(e),expanded:b===e.key,checked:!!$(e),isAnchorLink:!!e.href,knownIcon:"None"!==g.iconName,itemClassName:e.className,dividerClassName:m,iconClassName:g.className,subMenuClassName:v,primaryDisabled:e.primaryDisabled};u=Ne(Le(null===(c=l.subComponentStyles)||void 0===c?void 0:c.menuItem,f),y)}switch("-"!==e.text&&"-"!==e.name||(e.itemType=R.Divider),e.itemType){case R.Divider:d.push(me(t,u));break;case R.Header:d.push(me(t,u));var S=ye(e,u,l,t,r,a);d.push(fe(S,e.key||t,u,e.title));break;case R.Section:d.push(he(e,u,l,t,r,a));break;default:var C=function(){return ve(e,u,t,o,i,r,a)},w=s.onRenderContextualMenuItem?s.onRenderContextualMenuItem(e,C):C();d.push(fe(w,e.key||t,u,e.title))}return n.createElement(n.Fragment,{key:e.key},d)},he=function(e,t,o,r,s,a){var l=e.sectionProps;if(l){var c,u;if(l.title){var g=void 0,h="";if("string"==typeof l.title){var p=d+l.title.replace(/\s/g,"");g={key:"section-".concat(l.title,"-title"),itemType:R.Header,text:l.title,id:p},h=p}else{var f=l.title.id||d+l.title.key.replace(/\s/g,"");g=(0,i.__assign)((0,i.__assign)({},l.title),{id:f}),h=f}g&&(u={role:"group","aria-labelledby":h},c=ye(g,t,o,r,s,a))}if(l.items&&l.items.length>0){var m=0;return n.createElement("li",{role:"presentation",key:l.key||e.key||"section-".concat(r)},n.createElement("div",(0,i.__assign)({},u),n.createElement("ul",{className:o.list,role:"presentation"},l.topDivider&&me(r,t,!0,!0),c&&fe(c,e.key||r,t,e.title),l.items.map((function(e,t){var i=ge(e,t,m,Oe(l.items),s,a,o);if(e.itemType!==R.Divider&&e.itemType!==R.Header){var n=e.customOnRenderListLength?e.customOnRenderListLength:1;m+=n}return i})),l.bottomDivider&&me(r,t,!1,!0))))}}},fe=function(e,t,o,i){return n.createElement("li",{role:"presentation",title:i,key:t,className:o.item},e)},me=function(e,t,o,i){return i||e>0?n.createElement("li",{role:"separator",key:"separator-"+e+(void 0===o?"":o?"-top":"-bottom"),className:t.divider,"aria-hidden":"true"}):null},ve=function(e,t,o,r,a,l,c){if(e.onRender)return e.onRender((0,i.__assign)({"aria-posinset":r+1,"aria-setsize":a},e),g);var u={item:e,classNames:t,index:o,focusableElementIndex:r,totalItemCount:a,hasCheckmarks:l,hasIcons:c,contextualMenuItemAs:s.contextualMenuItemAs,onItemMouseEnter:ne,onItemMouseLeave:se,onItemMouseMove:re,onItemMouseDown:Ge,executeItemClick:ce,onItemKeyDown:oe,expandedMenuItemKey:b,openSubMenu:C,dismissSubMenu:k,dismissMenu:g};if(e.href){var d=be;return e.contextualMenuItemWrapperAs&&(d=V(e.contextualMenuItemWrapperAs,d)),n.createElement(d,(0,i.__assign)({},u,{onItemClick:le}))}if(e.split&&K(e)){var h=ke;return e.contextualMenuItemWrapperAs&&(h=V(e.contextualMenuItemWrapperAs,h)),n.createElement(h,(0,i.__assign)({},u,{onItemClick:ae,onItemClickBase:ue,onTap:D}))}var p=Te;return e.contextualMenuItemWrapperAs&&(p=V(e.contextualMenuItemWrapperAs,p)),n.createElement(p,(0,i.__assign)({},u,{onItemClick:ae,onItemClickBase:ue}))},ye=function(e,t,o,r,a,l){var c=pe;e.contextualMenuItemAs&&(c=V(e.contextualMenuItemAs,c)),s.contextualMenuItemAs&&(c=V(s.contextualMenuItemAs,c));var u=e.itemProps,d=e.id,g=u&&(0,f.G1)(u,f.JM);return n.createElement("div",(0,i.__assign)({id:d,className:o.header},g,{style:e.style}),n.createElement(c,(0,i.__assign)({item:e,classNames:t,index:r,onCheckmarkClick:a?ae:void 0,hasIcons:l},u)))},Se=s.isBeakVisible,Ce=s.items,we=s.labelElementId,ze=s.id,Ve=s.className,$e=s.beakWidth,Je=s.directionalHint,Ze=s.directionalHintForRTL,Ye=s.alignTargetEdge,Qe=s.gapSpace,Xe=s.coverTarget,et=s.ariaLabel,tt=s.doNotLayer,ot=s.target,it=s.bounds,nt=s.useTargetWidth,rt=s.useTargetAsMinWidth,st=s.directionalHintFixed,at=s.shouldFocusOnMount,lt=s.shouldFocusOnContainer,ct=s.title,ut=s.styles,dt=s.theme,gt=s.calloutProps,ht=s.onRenderSubMenu,pt=void 0===ht?Ue:ht,ft=s.onRenderMenuList,mt=void 0===ft?function(e,t){return de(e,bt)}:ft,vt=s.focusZoneProps,yt=s.getMenuClassNames,bt=yt?yt(dt,Ve):Pe(ut,{theme:dt,className:Ve}),St=function e(t){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(n.iconProps)return!0;if(n.itemType===R.Section&&n.sectionProps&&e(n.sectionProps.items))return!0}return!1}(Ce),Ct=(0,i.__assign)((0,i.__assign)({direction:F.E.vertical,handleTabKey:F.l.all,isCircularNavigation:!0,"data-tabster":'{"uncontrolled": {}, "focusable": { "excludeFromMover": true }}'},vt),{className:(0,a.A)(bt.root,null===(o=s.focusZoneProps)||void 0===o?void 0:o.className)}),wt=function(e){return e.some((function(e){return!!e.canCheck||!(!e.sectionProps||!e.sectionProps.items.some((function(e){return!0===e.canCheck})))}))}(Ce),kt=b&&!0!==s.hidden?w():null;Se=void 0===Se?U<=Re.AR.medium:Se;var Tt=p.current;if((nt||rt)&&Tt&&Tt.offsetWidth){var xt=Tt.getBoundingClientRect().width-2;nt?Z={width:xt}:rt&&(Z={minWidth:xt})}if(Ce&&Ce.length>0){var _t=Oe(Ce),It=bt.subComponentStyles?bt.subComponentStyles.callout:void 0;return n.createElement(De.Consumer,null,(function(e){return n.createElement(Y.P,(0,i.__assign)({styles:It,onRestoreFocus:v},gt,{target:ot||e.target,isBeakVisible:Se,beakWidth:$e,directionalHint:Je,directionalHintForRTL:Ze,gapSpace:Qe,coverTarget:Xe,doNotLayer:tt,className:(0,a.A)("ms-ContextualMenu-Callout",gt&&gt.className),setInitialFocus:at,onDismiss:s.onDismiss||e.onDismiss,onScroll:A,bounds:it,directionalHintFixed:st,alignTargetEdge:Ye,hidden:s.hidden||e.hidden,ref:t}),n.createElement("div",{style:Z,ref:l,id:ze,className:bt.container,tabIndex:lt?0:-1,onKeyDown:te,onKeyUp:ee,onFocusCapture:I,"aria-label":et,"aria-labelledby":we,role:"menu"},ct&&n.createElement("div",{className:bt.title}," ",ct," "),Ce&&Ce.length?function(e,t){var o=s.focusZoneAs,r=void 0===o?O.R:o;return n.createElement(r,(0,i.__assign)({},t),e)}(mt({ariaLabel:et,items:Ce,totalItemCount:_t,hasCheckmarks:wt,hasIcons:St,defaultMenuItemRenderer:function(e){return function(e,t){var o=e.index,i=e.focusableElementIndex,n=e.totalItemCount,r=e.hasCheckmarks,s=e.hasIcons;return ge(e,o,i,n,r,s,t)}(e,bt)},labelElementId:we},(function(e,t){return de(e,bt)})),Ct):null,kt&&pt(kt,Ue)),n.createElement(S.MO,null))}))}return null})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,m.ab)(e,t)}));function We(e){return e.which===c.c.alt||"Meta"===e.key}function Ge(e,t){var o;null===(o=e.onMouseDown)||void 0===o||o.call(e,e,t)}function Ue(e,t){throw Error("ContextualMenuBase: onRenderSubMenu callback is null or undefined. Please ensure to set `onRenderSubMenu` property either manually or with `styled` helper.")}function Ve(e,t){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(n.itemType===R.Section&&n.sectionProps){var r=Ve(e,n.sectionProps.items);if(r)return r}else if(n.key&&n.key===e)return n}}function $e(e,t){return e?function(o,i){return Ke(o,t),e(o,i)}:e}function Ke(e,t){e&&t&&(e.persist(),t instanceof Event?e.target=t.target:t instanceof Element&&(e.target=t))}ze.displayName="ContextualMenuBase";var Je={root:"ms-ContextualMenu",container:"ms-ContextualMenu-container",list:"ms-ContextualMenu-list",header:"ms-ContextualMenu-header",title:"ms-ContextualMenu-title",isopen:"is-open"};function Ze(e){return n.createElement(Ye,(0,i.__assign)({},e))}var Ye=(0,w.I)(ze,(function(e){var t=e.className,o=e.theme,i=(0,re.Km)(Je,o),n=o.fonts,r=o.semanticColors,s=o.effects;return{root:[o.fonts.medium,i.root,i.isopen,{backgroundColor:r.menuBackground,minWidth:"180px"},t],container:[i.container,{selectors:{":focus":{outline:0}}}],list:[i.list,i.isopen,{listStyleType:"none",margin:"0",padding:"0"}],header:[i.header,n.small,{fontWeight:re.BO.semibold,color:r.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:ae.C,lineHeight:ae.C,cursor:"default",padding:"0px 6px",userSelect:"none",textAlign:"left"}],title:[i.title,{fontSize:n.mediumPlus.fontSize,paddingRight:"14px",paddingLeft:"14px",paddingBottom:"5px",paddingTop:"5px",backgroundColor:r.menuItemBackgroundPressed}],subComponentStyles:{callout:{root:{boxShadow:s.elevation8}},menuItem:{}}}}),(function(e){return{onRenderSubMenu:e.onRenderSubMenu?(t=e.onRenderSubMenu,o=Ze,P(t)(o)):Ze};var t,o}),{scope:"ContextualMenu"}),Qe=Ye;Qe.displayName="ContextualMenu";var Xe={msButton:"ms-Button",msButtonHasMenu:"ms-Button--hasMenu",msButtonIcon:"ms-Button-icon",msButtonMenuIcon:"ms-Button-menuIcon",msButtonLabel:"ms-Button-label",msButtonDescription:"ms-Button-description",msButtonScreenReaderText:"ms-Button-screenReaderText",msButtonFlexContainer:"ms-Button-flexContainer",msButtonTextContainer:"ms-Button-textContainer"},et=(0,s.J9)((function(e,t,o,i,n,r,s,a,l,c,u){var d,g,h=(0,re.Km)(Xe,e||{}),p=c&&!u;return(0,re.l8)(t.__shadowConfig__,{root:[h.msButton,t.root,i,l&&["is-checked",t.rootChecked],p&&["is-expanded",t.rootExpanded,(d={},d[":hover .".concat(h.msButtonIcon)]=t.iconExpandedHovered,d[":hover .".concat(h.msButtonMenuIcon)]=t.menuIconExpandedHovered||t.rootExpandedHovered,d[":hover"]=t.rootExpandedHovered,d)],a&&[Xe.msButtonHasMenu,t.rootHasMenu],s&&["is-disabled",t.rootDisabled],!s&&!p&&!l&&(g={":hover":t.rootHovered},g[":hover .".concat(h.msButtonLabel)]=t.labelHovered,g[":hover .".concat(h.msButtonIcon)]=t.iconHovered,g[":hover .".concat(h.msButtonDescription)]=t.descriptionHovered,g[":hover .".concat(h.msButtonMenuIcon)]=t.menuIconHovered,g[":focus"]=t.rootFocused,g[":active"]=t.rootPressed,g[":active .".concat(h.msButtonIcon)]=t.iconPressed,g[":active .".concat(h.msButtonDescription)]=t.descriptionPressed,g[":active .".concat(h.msButtonMenuIcon)]=t.menuIconPressed,g),s&&l&&[t.rootCheckedDisabled],!s&&l&&{":hover":t.rootCheckedHovered,":active":t.rootCheckedPressed},o],flexContainer:[h.msButtonFlexContainer,t.flexContainer],textContainer:[h.msButtonTextContainer,t.textContainer],icon:[h.msButtonIcon,n,t.icon,p&&t.iconExpanded,l&&t.iconChecked,s&&t.iconDisabled],label:[h.msButtonLabel,t.label,l&&t.labelChecked,s&&t.labelDisabled],menuIcon:[h.msButtonMenuIcon,r,t.menuIcon,l&&t.menuIconChecked,s&&!u&&t.menuIconDisabled,!s&&!p&&!l&&{":hover":t.menuIconHovered,":active":t.menuIconPressed},p&&["is-expanded",t.menuIconExpanded]],description:[h.msButtonDescription,t.description,l&&t.descriptionChecked,s&&t.descriptionDisabled],screenReaderText:[h.msButtonScreenReaderText,t.screenReaderText]})})),tt=(0,s.J9)((function(e,t,o,i,n){return{root:(0,re.Zq)(e.splitButtonMenuButton,o&&[e.splitButtonMenuButtonExpanded],t&&[e.splitButtonMenuButtonDisabled],i&&!t&&[e.splitButtonMenuButtonChecked],n&&!t&&[{":focus":e.splitButtonMenuFocused}]),splitButtonContainer:(0,re.Zq)(e.splitButtonContainer,!t&&i&&[e.splitButtonContainerChecked,{":hover":e.splitButtonContainerCheckedHovered}],!t&&!i&&[{":hover":e.splitButtonContainerHovered,":focus":e.splitButtonContainerFocused}],t&&e.splitButtonContainerDisabled),icon:(0,re.Zq)(e.splitButtonMenuIcon,t&&e.splitButtonMenuIconDisabled,!t&&n&&e.splitButtonMenuIcon),flexContainer:(0,re.Zq)(e.splitButtonFlexContainer),divider:(0,re.Zq)("ms-SplitButton-divider",e.splitButtonDivider,(n||t)&&e.splitButtonDividerDisabled)}})),ot=function(e){function t(t){var o=e.call(this,t)||this;return o._buttonElement=n.createRef(),o._splitButtonContainer=n.createRef(),o._mergedRef=(0,r.K)(),o._renderedVisibleMenu=!1,o._getMemoizedMenuButtonKeytipProps=(0,s.J9)((function(e){return(0,i.__assign)((0,i.__assign)({},e),{hasMenu:!0})})),o._onRenderIcon=function(e,t){var r=o.props.iconProps;if(r&&(void 0!==r.iconName||r.imageProps)){var s=r.className,l=r.imageProps,c=(0,i.__rest)(r,["className","imageProps"]);if(r.styles)return n.createElement(B,(0,i.__assign)({className:(0,a.A)(o._classNames.icon,s),imageProps:l},c));if(r.iconName)return n.createElement(_.l8,(0,i.__assign)({className:(0,a.A)(o._classNames.icon,s)},c));if(l)return n.createElement(M,(0,i.__assign)({className:(0,a.A)(o._classNames.icon,s),imageProps:l},c))}return null},o._onRenderTextContents=function(){var e,t,i,r,s=(e=o.props).text,a=e.children,l=void 0===(t=e.secondaryText)?o.props.description:t,c=void 0===(i=e.onRenderText)?o._onRenderText:i,u=void 0===(r=e.onRenderDescription)?o._onRenderDescription:r;return s||"string"==typeof a||l?n.createElement("span",{className:o._classNames.textContainer},c(o.props,o._onRenderText),u(o.props,o._onRenderDescription)):[c(o.props,o._onRenderText),u(o.props,o._onRenderDescription)]},o._onRenderText=function(){var e=o.props.text,t=o.props.children;return void 0===e&&"string"==typeof t&&(e=t),o._hasText()?n.createElement("span",{key:o._labelId,className:o._classNames.label,id:o._labelId},e):null},o._onRenderChildren=function(){var e=o.props.children;return"string"==typeof e?null:e},o._onRenderDescription=function(e){var t,i=void 0===(t=e.secondaryText)?o.props.description:t;return i?n.createElement("span",{key:o._descriptionId,className:o._classNames.description,id:o._descriptionId},i):null},o._onRenderAriaDescription=function(){var e=o.props.ariaDescription;return e?n.createElement("span",{className:o._classNames.screenReaderText,id:o._ariaDescriptionId},e):null},o._onRenderMenuIcon=function(e){var t=o.props.menuIconProps;return n.createElement(_.l8,(0,i.__assign)({iconName:"ChevronDown"},t,{className:o._classNames.menuIcon}))},o._onRenderMenu=function(e){var t=o.props.menuAs?V(o.props.menuAs,Qe):Qe;return n.createElement(t,(0,i.__assign)({},e))},o._onDismissMenu=function(e){var t=o.props.menuProps;t&&t.onDismiss&&t.onDismiss(e),e&&e.defaultPrevented||o._dismissMenu()},o._dismissMenu=function(){o._menuShouldFocusOnMount=void 0,o._menuShouldFocusOnContainer=void 0,o.setState({menuHidden:!0})},o._openMenu=function(e,t){void 0===t&&(t=!0),o.props.menuProps&&(o._menuShouldFocusOnContainer=e,o._menuShouldFocusOnMount=t,o._renderedVisibleMenu=!0,o.setState({menuHidden:!1}))},o._onToggleMenu=function(e){var t=!0;o.props.menuProps&&!1===o.props.menuProps.shouldFocusOnMount&&(t=!1),o.state.menuHidden?o._openMenu(e,t):o._dismissMenu()},o._onSplitContainerFocusCapture=function(e){var t=o._splitButtonContainer.current;!t||e.target&&(0,l.s)(e.target,t)||t.focus()},o._onSplitButtonPrimaryClick=function(e){o.state.menuHidden||o._dismissMenu();var t=o._processingTouch&&!o.props.toggle;!t&&o.props.onClick?o.props.onClick(e):t&&o._onMenuClick(e)},o._onKeyDown=function(e){!o.props.disabled||e.which!==c.c.enter&&e.which!==c.c.space?o.props.disabled||(o.props.menuProps?o._onMenuKeyDown(e):void 0!==o.props.onKeyDown&&o.props.onKeyDown(e)):(e.preventDefault(),e.stopPropagation())},o._onKeyUp=function(e){o.props.disabled||void 0===o.props.onKeyUp||o.props.onKeyUp(e)},o._onKeyPress=function(e){o.props.disabled||void 0===o.props.onKeyPress||o.props.onKeyPress(e)},o._onMouseUp=function(e){o.props.disabled||void 0===o.props.onMouseUp||o.props.onMouseUp(e)},o._onMouseDown=function(e){o.props.disabled||void 0===o.props.onMouseDown||o.props.onMouseDown(e)},o._onClick=function(e){o.props.disabled||(o.props.menuProps?o._onMenuClick(e):void 0!==o.props.onClick&&o.props.onClick(e))},o._onSplitButtonContainerKeyDown=function(e){e.which===c.c.enter||e.which===c.c.space?o._buttonElement.current&&(o._buttonElement.current.click(),e.preventDefault(),e.stopPropagation()):o._onMenuKeyDown(e)},o._onMenuKeyDown=function(e){var t;if(!o.props.disabled){o.props.onKeyDown&&o.props.onKeyDown(e);var i=e.which===c.c.up,n=e.which===c.c.down;if(!e.defaultPrevented&&o._isValidMenuOpenKey(e)){var r=o.props.onMenuClick;r&&r(e,o.props),o._onToggleMenu(!1),e.preventDefault(),e.stopPropagation()}e.which!==c.c.enter&&e.which!==c.c.space||(0,u.Fy)(!0,e.target,null===(t=o.context)||void 0===t?void 0:t.registeredProviders),e.altKey||e.metaKey||!i&&!n||!o.state.menuHidden&&o.props.menuProps&&((void 0!==o._menuShouldFocusOnMount?o._menuShouldFocusOnMount:o.props.menuProps.shouldFocusOnMount)||(e.preventDefault(),e.stopPropagation(),o._menuShouldFocusOnMount=!0,o.forceUpdate()))}},o._onTouchStart=function(){o._isSplitButton&&o._splitButtonContainer.current&&!("onpointerdown"in o._splitButtonContainer.current)&&o._handleTouchAndPointerEvent()},o._onMenuClick=function(e){var t,i=(t=o.props).onMenuClick,n=t.menuProps;i&&i(e,o.props);var r="boolean"==typeof(null==n?void 0:n.shouldFocusOnContainer)?n.shouldFocusOnContainer:"mouse"===e.nativeEvent.pointerType;e.defaultPrevented||(o._onToggleMenu(r),e.preventDefault(),e.stopPropagation())},(0,d.f)(o),o._async=new g.j(o),o._events=new h.g(o),o.props.split,o._labelId=(0,p.O)(),o._descriptionId=(0,p.O)(),o._ariaDescriptionId=(0,p.O)(),o.state={menuHidden:!0},o}return(0,i.__extends)(t,e),Object.defineProperty(t.prototype,"_isSplitButton",{get:function(){return!!this.props.menuProps&&!!this.props.onClick&&!0===this.props.split},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t,o,i,n=(e=this.props).ariaDescription,r=e.ariaLabel,s=e.ariaHidden,a=e.className,l=e.disabled,c=e.allowDisabledFocus,u=e.primaryDisabled,d=void 0===(t=e.secondaryText)?this.props.description:t,g=e.href,h=e.iconProps,p=e.menuIconProps,v=e.styles,b=e.checked,S=e.variantClassName,C=e.theme,w=e.toggle,k=e.getClassNames,T=e.role,x=this.state.menuHidden,_=l||u;this._classNames=k?k(C,a,S,h&&h.className,p&&p.className,_,b,!x,!!this.props.menuProps,this.props.split,!!c):et(C,v,a,S,h&&h.className,p&&p.className,_,!!this.props.menuProps,b,!x,this.props.split);var I=this._ariaDescriptionId,E=this._labelId,A=this._descriptionId,B=!_&&!!g,R=B?"a":"button",M=(0,f.G1)((0,m.kp)(B?{}:{type:"button"},this.props.rootProps,this.props),B?f.t0:f.uw,["disabled"]),D=r||M["aria-label"],P=void 0;n?P=I:d&&this.props.onRenderDescription!==y?P=A:M["aria-describedby"]&&(P=M["aria-describedby"]);var N=void 0;M["aria-labelledby"]?N=M["aria-labelledby"]:P&&!D&&(N=this._hasText()?E:void 0);var F=!(!1===this.props["data-is-focusable"]||l&&!c||this._isSplitButton),O="menuitemcheckbox"===T||"checkbox"===T,j=O||!0===w?!!b:void 0,q=(0,m.kp)(M,((o={className:this._classNames.root,ref:this._mergedRef(this.props.elementRef,this._buttonElement),disabled:_&&!c,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onClick:this._onClick,"aria-label":D,"aria-labelledby":N,"aria-describedby":P,"aria-disabled":_,"data-is-focusable":F})[O?"aria-checked":"aria-pressed"]=j,o));if(s&&(q["aria-hidden"]=!0),this._isSplitButton)return this._onRenderSplitButtonContent(R,q);if(this.props.menuProps){var L=void 0===(i=this.props.menuProps.id)?"".concat(this._labelId,"-menu"):i;(0,m.kp)(q,{"aria-expanded":!x,"aria-controls":x?null:L,"aria-haspopup":!0})}return this._onRenderContent(R,q)},t.prototype.componentDidMount=function(){this._isSplitButton&&this._splitButtonContainer.current&&("onpointerdown"in this._splitButtonContainer.current&&this._events.on(this._splitButtonContainer.current,"pointerdown",this._onPointerDown,!0),"onpointerup"in this._splitButtonContainer.current&&this.props.onPointerUp&&this._events.on(this._splitButtonContainer.current,"pointerup",this.props.onPointerUp,!0))},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&!t.menuHidden&&this.state.menuHidden&&this.props.onAfterMenuDismiss()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.focus=function(){var e,t;this._isSplitButton&&this._splitButtonContainer.current?((0,u.Fy)(!0,void 0,null===(e=this.context)||void 0===e?void 0:e.registeredProviders),this._splitButtonContainer.current.focus()):this._buttonElement.current&&((0,u.Fy)(!0,void 0,null===(t=this.context)||void 0===t?void 0:t.registeredProviders),this._buttonElement.current.focus())},t.prototype.dismissMenu=function(){this._dismissMenu()},t.prototype.openMenu=function(e,t){this._openMenu(e,t)},t.prototype._onRenderContent=function(e,t){var o,r,s,a,l,c=this,u=this.props,d=e,g=u.menuIconProps,h=u.menuProps,p=void 0===(o=u.onRenderIcon)?this._onRenderIcon:o,f=void 0===(r=u.onRenderAriaDescription)?this._onRenderAriaDescription:r,m=void 0===(s=u.onRenderChildren)?this._onRenderChildren:s,v=void 0===(a=u.onRenderMenu)?this._onRenderMenu:a,y=void 0===(l=u.onRenderMenuIcon)?this._onRenderMenuIcon:l,b=u.disabled,C=u.keytipProps;C&&h&&(C=this._getMemoizedMenuButtonKeytipProps(C));var w=function(e){return n.createElement(d,(0,i.__assign)({},t,e),n.createElement("span",{className:c._classNames.flexContainer,"data-automationid":"splitbuttonprimary"},p(u,c._onRenderIcon),c._onRenderTextContents(),f(u,c._onRenderAriaDescription),m(u,c._onRenderChildren),!c._isSplitButton&&(h||g||c.props.onRenderMenuIcon)&&y(c.props,c._onRenderMenuIcon),h&&!h.doNotLayer&&c._shouldRenderMenu()&&v(c._getMenuProps(h),c._onRenderMenu)))},k=C?n.createElement(ye,{keytipProps:this._isSplitButton?void 0:C,ariaDescribedBy:t["aria-describedby"],disabled:b},(function(e){return w(e)})):w();return h&&h.doNotLayer?n.createElement(n.Fragment,null,k,this._shouldRenderMenu()&&v(this._getMenuProps(h),this._onRenderMenu)):n.createElement(n.Fragment,null,k,n.createElement(S.MO,null))},t.prototype._shouldRenderMenu=function(){var e,t=this.state.menuHidden,o=(e=this.props).persistMenu,i=e.renderPersistedMenuHiddenOnMount;return!t||!(!o||!this._renderedVisibleMenu&&!i)},t.prototype._hasText=function(){return null!==this.props.text&&(void 0!==this.props.text||"string"==typeof this.props.children)},t.prototype._getMenuProps=function(e){var t=this.props.persistMenu,o=this.state.menuHidden;return e.ariaLabel||e.labelElementId||!this._hasText()||(e=(0,i.__assign)((0,i.__assign)({},e),{labelElementId:this._labelId})),(0,i.__assign)((0,i.__assign)({id:this._labelId+"-menu",directionalHint:D.A.bottomLeftEdge},e),{shouldFocusOnContainer:this._menuShouldFocusOnContainer,shouldFocusOnMount:this._menuShouldFocusOnMount,hidden:t?o:void 0,className:(0,a.A)("ms-BaseButton-menuhost",e.className),target:this._isSplitButton?this._splitButtonContainer.current:this._buttonElement.current,onDismiss:this._onDismissMenu})},t.prototype._onRenderSplitButtonContent=function(e,t){var o,r,s=this,a=void 0===(r=(o=this.props).styles)?{}:r,l=o.disabled,c=o.allowDisabledFocus,u=o.checked,d=o.getSplitButtonClassNames,g=o.primaryDisabled,h=o.menuProps,p=o.toggle,v=o.role,y=o.primaryActionButtonProps,b=this.props.keytipProps,S=this.state.menuHidden,w=d?d(!!l,!S,!!u,!!c):a&&tt(a,!!l,!S,!!u,!!g);(0,m.kp)(t,{onClick:void 0,onPointerDown:void 0,onPointerUp:void 0,tabIndex:-1,"data-is-focusable":!1}),b&&h&&(b=this._getMemoizedMenuButtonKeytipProps(b));var k=(0,f.G1)(t,[],["disabled"]);y&&(0,m.kp)(t,y);var T=function(o){return n.createElement("div",(0,i.__assign)({},k,{"data-ktp-target":o?o["data-ktp-target"]:void 0,role:v||"button","aria-disabled":l,"aria-haspopup":!0,"aria-expanded":!S,"aria-pressed":p?!!u:void 0,"aria-describedby":(0,C._)(t["aria-describedby"],o?o["aria-describedby"]:void 0),className:w&&w.splitButtonContainer,onKeyDown:s._onSplitButtonContainerKeyDown,onTouchStart:s._onTouchStart,ref:s._splitButtonContainer,"data-is-focusable":!0,onClick:l||g?void 0:s._onSplitButtonPrimaryClick,tabIndex:!l&&!g||c?0:void 0,"aria-roledescription":t["aria-roledescription"],onFocusCapture:s._onSplitContainerFocusCapture}),n.createElement("span",{style:{display:"flex",width:"100%"}},s._onRenderContent(e,t),s._onRenderSplitButtonMenuButton(w,o),s._onRenderSplitButtonDivider(w)))};return b?n.createElement(ye,{keytipProps:b,disabled:l},(function(e){return T(e)})):T()},t.prototype._onRenderSplitButtonDivider=function(e){return e&&e.divider?n.createElement("span",{className:e.divider,"aria-hidden":!0,onClick:function(e){e.stopPropagation()}}):null},t.prototype._onRenderSplitButtonMenuButton=function(e,o){var r,s=(r=this.props).allowDisabledFocus,a=r.checked,l=r.disabled,c=r.splitButtonMenuProps,u=r.splitButtonAriaLabel,d=r.primaryDisabled,g=this.state.menuHidden,h=this.props.menuIconProps;void 0===h&&(h={iconName:"ChevronDown"});var p=(0,i.__assign)((0,i.__assign)({},c),{styles:e,checked:a,disabled:l,allowDisabledFocus:s,onClick:this._onMenuClick,menuProps:void 0,iconProps:(0,i.__assign)((0,i.__assign)({},h),{className:this._classNames.menuIcon}),ariaLabel:u,"aria-haspopup":!0,"aria-expanded":!g,"data-is-focusable":!1});return n.createElement(t,(0,i.__assign)({},p,{"data-ktp-execute-target":o?o["data-ktp-execute-target"]:o,onMouseDown:this._onMouseDown,tabIndex:d&&!s?0:-1}))},t.prototype._onPointerDown=function(e){var t=this.props.onPointerDown;t&&t(e),"touch"===e.pointerType&&(this._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0,e.state.menuHidden&&e.focus()}),500)},t.prototype._isValidMenuOpenKey=function(e){return this.props.menuTriggerKeyCode?e.which===this.props.menuTriggerKeyCode:!!this.props.menuProps&&e.which===c.c.down&&(e.altKey||e.metaKey)},t.defaultProps={baseClassName:"ms-Button",styles:{},split:!1},t.contextType=S.dM,t}(n.Component),it=o(97285),nt=o(97628),rt=o(90305),st=o(20018),at=o(3758),lt=o(39142),ct=(0,s.J9)(st.HD),ut=(0,s.J9)((function(e,t,o){return(0,i.__assign)((0,i.__assign)((0,i.__assign)({},e),t),{__shadowConfig__:o})})),dt={outline:0},gt=function(e){return{fontSize:e,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",flexShrink:0}},ht=(0,s.J9)((function(e){var t,o,i=e.semanticColors,n=e.effects,r=e.fonts,s=i.buttonBorder,a=i.disabledBackground,l=i.disabledText,c={left:-2,top:-2,bottom:-2,right:-2,outlineColor:"ButtonText"};return{root:[(0,re.gm)(e,{inset:1,highContrastStyle:c,borderColor:"transparent"}),e.fonts.medium,{border:"1px solid "+s,borderRadius:n.roundedCorner2,boxSizing:"border-box",cursor:"pointer",display:"inline-block",padding:"0 16px",textDecoration:"none",textAlign:"center",userSelect:"none",":active > span":{position:"relative",left:0,top:0}}],rootDisabled:[(0,re.gm)(e,{inset:1,highContrastStyle:c,borderColor:"transparent"}),{backgroundColor:a,borderColor:a,color:l,cursor:"default",":hover":dt,":focus":dt}],iconDisabled:(t={color:l},t[re.up]={color:"GrayText"},t),menuIconDisabled:(o={color:l},o[re.up]={color:"GrayText"},o),flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},description:{display:"block"},textContainer:{flexGrow:1,display:"block"},icon:gt(r.mediumPlus.fontSize),menuIcon:gt(r.small.fontSize),label:{margin:"0 4px",lineHeight:"100%",display:"block"},screenReaderText:re.dX}})),pt=(0,s.J9)((function(e,t){var o,n,r,s,a,l,c,u,d,g,h,p,f,m,v,y,b=e.effects,S=e.palette,C=e.semanticColors,w={left:-2,top:-2,bottom:-2,right:-2,border:"none"},k={position:"absolute",width:1,right:31,top:8,bottom:8},T={splitButtonContainer:[(0,re.gm)(e,{highContrastStyle:w,inset:2,pointerEvents:"none"}),{display:"inline-flex",".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none",flexGrow:"1"},".ms-Button--primary":(o={borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",flexGrow:"1",":hover":{border:"none"},":active":{border:"none"}},o[re.up]=(0,i.__assign)((0,i.__assign)({color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0"},(0,re.Qg)()),{":hover":{backgroundColor:"Highlight",border:"1px solid Highlight",borderRightWidth:"0",color:"HighlightText"},":active":{border:"1px solid Highlight"}}),o),".ms-Button--default + .ms-Button":(n={},n[re.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,i.__assign)({backgroundColor:"HighlightText",color:"Highlight"},(0,re.Qg)())}},n),'.ms-Button--default + .ms-Button[aria-expanded="true"]':(r={},r[re.up]={backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,i.__assign)({backgroundColor:"HighlightText",color:"Highlight"},(0,re.Qg)())},r),".ms-Button--primary + .ms-Button":(s={border:"none"},s[re.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{borderLeftWidth:"0",backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",".ms-Button-menuIcon":(0,i.__assign)((0,i.__assign)({},(0,re.Qg)()),{color:"HighlightText"})}},s),'.ms-Button--primary + .ms-Button[aria-expanded="true"]':(0,i.__assign)((0,i.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},(0,re.Qg)()),{".ms-Button-menuIcon":{color:"HighlightText"}}),".ms-Button.is-disabled":(a={},a[re.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)}],splitButtonContainerHovered:{".ms-Button--default.is-disabled":(l={backgroundColor:C.buttonBackgroundDisabled,color:C.buttonTextDisabled},l[re.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},l),".ms-Button--primary.is-disabled":(c={backgroundColor:C.primaryButtonBackgroundDisabled,color:C.primaryButtonTextDisabled},c[re.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c)},splitButtonContainerChecked:{".ms-Button--primary":(u={},u[re.up]=(0,i.__assign)({color:"Window",backgroundColor:"WindowText"},(0,re.Qg)()),u)},splitButtonContainerCheckedHovered:{".ms-Button--primary":(d={},d[re.up]=(0,i.__assign)({color:"Window",backgroundColor:"WindowText"},(0,re.Qg)()),d)},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:(g={padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:b.roundedCorner2,borderBottomRightRadius:b.roundedCorner2,border:"1px solid ".concat(S.neutralSecondaryAlt),borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},g[re.up]={".ms-Button-menuIcon":{color:"WindowText"}},g),splitButtonDivider:(0,i.__assign)((0,i.__assign)({},k),(h={},h[re.up]={backgroundColor:"WindowText"},h)),splitButtonDividerDisabled:(0,i.__assign)((0,i.__assign)({},k),(p={},p[re.up]={backgroundColor:"GrayText"},p)),splitButtonMenuButtonDisabled:(f={pointerEvents:"none",border:"none",":hover":{cursor:"default"},".ms-Button--primary":(m={},m[re.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},m),".ms-Button-menuIcon":(v={},v[re.up]={color:"GrayText"},v)},f[re.up]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},f),splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:(y={outline:"none",border:"none"},y[re.up]=(0,i.__assign)({color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},(0,re.Qg)()),y),splitButtonMenuFocused:(0,i.__assign)({},(0,re.gm)(e,{highContrastStyle:w,inset:2}))};return(0,re.TW)(T,t)})),ft=(0,s.J9)((function(e,t,o){var n,r,s,a,l,c=e.fonts,d=e.palette,g=ht(e),h=pt(e),p={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"16px 12px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:re.BO.semibold},description:[c.small,{lineHeight:"100%"}]},f={description:{color:d.neutralSecondary},descriptionHovered:{color:d.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},m={description:(n={color:d.white},n[re.up]=(0,i.__assign)({backgroundColor:"WindowText",color:"Window"},(0,re.Qg)()),n),descriptionHovered:(r={color:d.white},r[re.up]={backgroundColor:"Highlight",color:"Window"},r),descriptionPressed:(s={color:"inherit"},s[re.up]=(0,i.__assign)({color:"Window",backgroundColor:"WindowText"},(0,re.Qg)()),s),descriptionChecked:(a={color:"inherit"},a[re.up]=(0,i.__assign)({color:"Window",backgroundColor:"WindowText"},(0,re.Qg)()),a),descriptionDisabled:(l={color:"inherit"},l[re.up]={color:"inherit"},l)};return(0,re.TW)(g,p,o?function(e){var t,o,n,r,s,a,l,c,d,g=e.palette,h=e.semanticColors;return{root:(t={backgroundColor:h.primaryButtonBackground,border:"1px solid ".concat(h.primaryButtonBackground),color:h.primaryButtonText},t[re.up]=(0,i.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,re.Qg)()),t[".".concat(u.Y2," &:focus, :host(.").concat(u.Y2,") &:focus")]={":after":{border:"none",outlineColor:g.white}},t),rootHovered:(o={backgroundColor:h.primaryButtonBackgroundHovered,border:"1px solid ".concat(h.primaryButtonBackgroundHovered),color:h.primaryButtonTextHovered},o[re.up]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},o),rootPressed:(n={backgroundColor:h.primaryButtonBackgroundPressed,border:"1px solid ".concat(h.primaryButtonBackgroundPressed),color:h.primaryButtonTextPressed},n[re.up]=(0,i.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,re.Qg)()),n),rootExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootChecked:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:h.primaryButtonBackgroundPressed,color:h.primaryButtonTextPressed},rootDisabled:(r={color:h.primaryButtonTextDisabled,backgroundColor:h.primaryButtonBackgroundDisabled},r[re.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},r),splitButtonContainer:(s={},s[re.up]={border:"none"},s),splitButtonDivider:(0,i.__assign)((0,i.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(a={backgroundColor:g.white},a[re.up]={backgroundColor:"Window"},a)),splitButtonMenuButton:(l={backgroundColor:h.primaryButtonBackground,color:h.primaryButtonText},l[re.up]={backgroundColor:"Canvas"},l[":hover"]=(c={backgroundColor:h.primaryButtonBackgroundHovered},c[re.up]={color:"Highlight"},c),l),splitButtonMenuButtonDisabled:{backgroundColor:h.primaryButtonBackgroundDisabled,":hover":{backgroundColor:h.primaryButtonBackgroundDisabled}},splitButtonMenuButtonChecked:{backgroundColor:h.primaryButtonBackgroundPressed,":hover":{backgroundColor:h.primaryButtonBackgroundPressed}},splitButtonMenuButtonExpanded:{backgroundColor:h.primaryButtonBackgroundPressed,":hover":{backgroundColor:h.primaryButtonBackgroundPressed}},splitButtonMenuIcon:{color:h.primaryButtonText},splitButtonMenuIconDisabled:(d={color:g.neutralTertiary},d[re.up]={color:"GrayText"},d)}}(e):function(e){var t,o,n,r,s,a=e.semanticColors,l=e.palette,c=a.buttonBackground,u=a.buttonBackgroundPressed,d=a.buttonBackgroundHovered,g=a.buttonBackgroundDisabled,h=a.buttonText,p=a.buttonTextHovered,f=a.buttonTextDisabled,m=a.buttonTextChecked,v=a.buttonTextCheckedHovered;return{root:{backgroundColor:c,color:h},rootHovered:(t={backgroundColor:d,color:p},t[re.up]={borderColor:"Highlight",color:"Highlight"},t),rootPressed:{backgroundColor:u,color:m},rootExpanded:{backgroundColor:u,color:m},rootChecked:{backgroundColor:u,color:m},rootCheckedHovered:{backgroundColor:u,color:v},rootDisabled:(o={color:f,backgroundColor:g},o[re.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},o),splitButtonContainer:(n={},n[re.up]={border:"none"},n),splitButtonMenuButton:{color:l.white,backgroundColor:"transparent",":hover":(r={backgroundColor:l.neutralLight},r[re.up]={color:"Highlight"},r)},splitButtonMenuButtonDisabled:{backgroundColor:a.buttonBackgroundDisabled,":hover":{backgroundColor:a.buttonBackgroundDisabled}},splitButtonDivider:(0,i.__assign)((0,i.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(s={backgroundColor:l.neutralTertiaryAlt},s[re.up]={backgroundColor:"WindowText"},s)),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:l.neutralQuaternaryAlt,":hover":{backgroundColor:l.neutralQuaternaryAlt}},splitButtonMenuButtonExpanded:{backgroundColor:l.neutralQuaternaryAlt,":hover":{backgroundColor:l.neutralQuaternaryAlt}},splitButtonMenuIcon:{color:a.buttonText},splitButtonMenuIconDisabled:{color:a.buttonTextDisabled}}}(e),o?m:f,h,t)})),mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o,r;return(0,i.__extends)(t,e),t.prototype.render=function(){var e,t,o=void 0!==(t=(e=this.props).primary)&&t,r=e.styles,s=e.theme;return n.createElement(ot,(0,i.__assign)({},this.props,{variantClassName:o?"ms-Button--compoundPrimary":"ms-Button--compound",styles:ft(s,r,o)}))},t=(0,i.__decorate)([(o="CompoundButton",r=["theme","styles"],!0,function(e){var t,s=(t=function(t){function s(e){var o=t.call(this,e)||this;return o._styleCache={},o._onSettingChanged=o._onSettingChanged.bind(o),o}return(0,i.__extends)(s,t),s.prototype.componentDidMount=function(){it.X.observe(this._onSettingChanged)},s.prototype.componentWillUnmount=function(){it.X.unobserve(this._onSettingChanged)},s.prototype.render=function(){var t=this;return n.createElement(lt.f,{stylesheetKey:o},(function(s){return n.createElement(rt.z.Consumer,null,(function(a){var l,c=it.X.getSettings(r,o,a.customizations),u=null!==(l=t.context.window)&&void 0!==l?l:(0,H.z)(),d=ct(o,s,u),g=t.props;if(c.styles&&"function"==typeof c.styles&&(c.styles=c.styles((0,i.__assign)((0,i.__assign)({},c),g))),c.styles){if(t._styleCache.default!==c.styles||t._styleCache.component!==g.styles){var h=(0,at.T)(c.styles,g.styles);h.__shadowConfig__=d,t._styleCache.default=c.styles,t._styleCache.component=g.styles,t._styleCache.merged=h}return n.createElement(e,(0,i.__assign)({},c,g,{styles:t._styleCache.merged}))}var p=ut(c.styles,g.styles,d);return n.createElement(e,(0,i.__assign)({},c,g,{styles:p}))}))}))},s.prototype._onSettingChanged=function(){this.forceUpdate()},s}(n.Component),t.displayName="Customized"+o,t.contextType=Me._0,t);return(0,nt.D)(e,s)})],t),t}(n.Component)},46161:(e,t,o)=>{"use strict";o.d(t,{C:()=>s,J:()=>l});var i=o(30206),n=o(58546),r=o(77732),s=36,a=(0,n.L6)(0,n.mm),l=(0,r.J9)((function(e){var t,o,r,l,c,u=e.semanticColors,d=e.fonts,g=e.palette,h=u.menuItemBackgroundHovered,p=u.menuItemTextHovered,f=u.menuItemBackgroundPressed,m=u.bodyDivider,v={item:[d.medium,{color:u.bodyText,position:"relative",boxSizing:"border-box"}],divider:{display:"block",height:"1px",backgroundColor:m,position:"relative"},root:[(0,n.gm)(e),d.medium,{color:u.bodyText,backgroundColor:"transparent",border:"none",width:"100%",height:s,lineHeight:s,display:"block",cursor:"pointer",padding:"0px 8px 0 4px",textAlign:"left"}],rootDisabled:{color:u.disabledBodyText,cursor:"default",pointerEvents:"none",selectors:(t={},t[n.up]={color:"GrayText",opacity:1},t)},rootHovered:{backgroundColor:h,color:p,selectors:{".ms-ContextualMenu-icon":{color:g.themeDarkAlt},".ms-ContextualMenu-submenuIcon":{color:g.neutralPrimary}}},rootFocused:{backgroundColor:g.white},rootChecked:{selectors:{".ms-ContextualMenu-checkmarkIcon":{color:g.neutralPrimary}}},rootPressed:{backgroundColor:f,selectors:{".ms-ContextualMenu-icon":{color:g.themeDark},".ms-ContextualMenu-submenuIcon":{color:g.neutralPrimary}}},rootExpanded:{backgroundColor:f,color:u.bodyTextChecked,selectors:(o={".ms-ContextualMenu-submenuIcon":(r={},r[n.up]={color:"inherit"},r)},o[n.up]=(0,i.__assign)({},(0,n.Qg)()),o)},linkContent:{whiteSpace:"nowrap",height:"inherit",display:"flex",alignItems:"center",maxWidth:"100%"},anchorLink:{padding:"0px 8px 0 4px",textRendering:"auto",color:"inherit",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",textDecoration:"none",boxSizing:"border-box"},label:{margin:"0 4px",verticalAlign:"middle",display:"inline-block",flexGrow:"1",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},secondaryText:{color:e.palette.neutralSecondary,paddingLeft:"20px",textAlign:"right"},icon:{display:"inline-block",minHeight:"1px",maxHeight:s,fontSize:n.fF.medium,width:n.fF.medium,margin:"0 4px",verticalAlign:"middle",flexShrink:"0",selectors:(l={},l[a]={fontSize:n.fF.large,width:n.fF.large},l)},iconColor:{color:u.menuIcon},iconDisabled:{color:u.disabledBodyText},checkmarkIcon:{color:u.bodySubtext},subMenuIcon:{height:s,lineHeight:s,color:g.neutralSecondary,textAlign:"center",display:"inline-block",verticalAlign:"middle",flexShrink:"0",fontSize:n.fF.small,selectors:(c={":hover":{color:g.neutralPrimary},":active":{color:g.neutralPrimary}},c[a]={fontSize:n.fF.medium},c)},splitButtonFlexContainer:[(0,n.gm)(e),{display:"flex",height:s,flexWrap:"nowrap",justifyContent:"center",alignItems:"flex-start"}]};return(0,n.TW)(v)}))},72212:(e,t,o)=>{"use strict";o.d(t,{Y:()=>T});var i=o(30206),n=o(95734),r=o(68185),s=o(35226),a=o(93293),l=o(98885),c=function(e){for(var t=e.activeElement;null==t?void 0:t.shadowRoot;)t=t.shadowRoot.activeElement;return t},u=function(e){var t=e.target;return t&&t.shadowRoot&&(t=e.composedPath()[0]),t},d=o(75610),g=o(78091),h=o(35143),p=o(78950),f=o(99269),m=o(97245),v=o(26557),y=o(61037);function b(e){var t=n.useRef((function(){throw new Error("Cannot call an event handler while rendering")}));return(0,y.E)((function(){t.current=e}),[e]),(0,m.d)((function(){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.current.apply(void 0,e)}}))}var S=o(19390),C=o(70325),w=o(64925),k={disabled:!1,disableFirstFocus:!1,forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!1,"data-tabster":'{"uncontrolled": {"completely": true}}'},T=n.forwardRef((function(e,t){var o,y=n.useRef(null),x=n.useRef(null),_=n.useRef(null),I=(0,p.a)(y,t),E=(0,C.ZY)(),A=(0,w.bX)(),B=(0,r.h)(),R=null===(o=(0,f.Z)(!1))||void 0===o||o,M=(0,s.N)(k,e),D=(0,m.d)({hasFocus:!1,focusStackId:(0,v.B)("ftz-",M.id)}),P=M.children,N=M.componentRef,F=M.disabled,O=M.disableFirstFocus,j=M.forceFocusInsideTrap,q=M.focusPreviouslyFocusedInnerElement,L=M.firstFocusableSelector,H=M.firstFocusableTarget,z=M.disableRestoreFocus,W=void 0===z?M.ignoreExternalFocusing:z,G=M.isClickableOutsideFocusTrap,U=M.enableAriaHiddenSiblings,V={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:F?-1:0,"data-is-visible":!0,"data-is-focus-trap-zone-bumper":!0},$=n.useCallback((function(e){e!==x.current&&e!==_.current&&(0,a.lo)(e)}),[]),K=b((function(){if(y.current){var e=D.previouslyFocusedElementInTrapZone;if(q&&e&&(0,l.s)(y.current,e))$(e);else{var t=null;if("string"==typeof H)t=y.current.querySelector(H);else if(H)t=H(y.current);else if(L){var o="string"==typeof L?L:L();t=y.current.querySelector("."+o)}t||(t=(0,a.eX)(y.current,y.current.firstChild,!1,!1,!1,!0,void 0,void 0,void 0,B)),t&&$(t)}}})),J=function(e){if(!F&&y.current){var t=e===D.hasFocus?(0,a.Cm)(y.current,_.current,!0,!1,B):(0,a.oR)(y.current,x.current,!0,!1,B);t&&(t===x.current||t===_.current?K():t.focus())}},Z=b((function(e){if(T.focusStack=T.focusStack.filter((function(e){return D.focusStackId!==e})),E){var t=E.activeElement;W||"function"!=typeof(null==e?void 0:e.focus)||!(0,l.s)(y.current,t)&&t!==E.body&&!t.shadowRoot||$(e)}})),Y=b((function(e){if(!F&&D.focusStackId===T.focusStack.slice(-1)[0]){var t=u(e);t&&!(0,l.s)(y.current,t)&&(E&&c(E)===E.body?setTimeout((function(){E&&c(E)===E.body&&(K(),D.hasFocus=!0)}),0):(K(),D.hasFocus=!0),e.preventDefault(),e.stopPropagation())}}));return n.useEffect((function(){var e=[];return j&&e.push((0,d.on)(A,"focus",Y,!0)),G||e.push((0,d.on)(A,"click",Y,!0)),function(){e.forEach((function(e){return e()}))}}),[j,G,A]),n.useEffect((function(){if(!F&&(R||j)&&y.current){T.focusStack.push(D.focusStackId);var e=M.elementToFocusOnDismiss||c(E);return O||(0,l.s)(y.current,e)||K(),function(){return Z(e)}}}),[j,F]),n.useEffect((function(){if(!F&&U)return(0,g.q)(y.current)}),[F,U,y]),(0,S.i)((function(){delete D.previouslyFocusedElementInTrapZone})),function(e,t,o){n.useImperativeHandle(e,(function(){return{get previouslyFocusedElement(){return t},focus:o}}),[o,t])}(N,D.previouslyFocusedElementInTrapZone,K),n.createElement("div",(0,i.__assign)({"aria-labelledby":M.ariaLabelledBy},(0,h.G1)(M,h.JM),{ref:I,onFocusCapture:function(e){var t;null===(t=M.onFocusCapture)||void 0===t||t.call(M,e),e.target===x.current?J(!0):e.target===_.current&&J(!1),D.hasFocus=!0,e.target!==e.currentTarget&&e.target!==x.current&&e.target!==_.current&&(D.previouslyFocusedElementInTrapZone=u(e.nativeEvent))},onBlurCapture:function(e){var t;null===(t=M.onBlurCapture)||void 0===t||t.call(M,e);var o=e.relatedTarget;null===e.relatedTarget&&(o=c(E)),(0,l.s)(y.current,o)||(D.hasFocus=!1)}}),n.createElement("div",(0,i.__assign)({},V,{ref:x})),P,n.createElement("div",(0,i.__assign)({},V,{ref:_})))}));T.displayName="FocusTrapZone",T.focusStack=[]},2193:(e,t,o)=>{"use strict";o.d(t,{_:()=>v});var i=o(3749),n=o(30206),r=o(95734),s=o(49166),a=o(35143),l=o(14523),c=o(61037),u=o(78950),d=(0,s.Z)(),g=/\.svg$/i,h=r.forwardRef((function(e,t){var o=r.useRef(),i=r.useRef(),s=function(e,t){var o=e.onLoadingStateChange,i=e.onLoad,n=e.onError,s=e.src,a=r.useState(l.P6.notLoaded),u=a[0],d=a[1];(0,c.E)((function(){d(l.P6.notLoaded)}),[s]),r.useEffect((function(){u===l.P6.notLoaded&&t.current&&(s&&t.current.naturalWidth>0&&t.current.naturalHeight>0||t.current.complete&&g.test(s))&&d(l.P6.loaded)})),r.useEffect((function(){null==o||o(u)}),[u]);var h=r.useCallback((function(e){null==i||i(e),s&&d(l.P6.loaded)}),[s,i]),p=r.useCallback((function(e){null==n||n(e),d(l.P6.error)}),[n]);return[u,h,p]}(e,i),h=s[0],p=s[1],f=s[2],m=(0,a.G1)(e,a.xM,["width","height"]),v=e.src,y=e.alt,b=e.width,S=e.height,C=e.shouldFadeIn,w=void 0===C||C,k=e.shouldStartVisible,T=e.className,x=e.imageFit,_=e.role,I=e.maximizeFrame,E=e.styles,A=e.theme,B=e.loading,R=function(e,t,o,i){var n=r.useRef(t),s=r.useRef();return(void 0===s||n.current===l.P6.notLoaded&&t===l.P6.loaded)&&(s.current=function(e,t,o,i){var n=e.imageFit,r=e.width,s=e.height;if(void 0!==e.coverStyle)return e.coverStyle;if(t===l.P6.loaded&&(n===l.N_.cover||n===l.N_.contain||n===l.N_.centerContain||n===l.N_.centerCover)&&o.current&&i.current){var a;if(a="number"==typeof r&&"number"==typeof s&&n!==l.N_.centerContain&&n!==l.N_.centerCover?r/s:i.current.clientWidth/i.current.clientHeight,o.current.naturalWidth/o.current.naturalHeight>a)return l.Aw.landscape}return l.Aw.portrait}(e,t,o,i)),n.current=t,s.current}(e,h,i,o),M=d(E,{theme:A,className:T,width:b,height:S,maximizeFrame:I,shouldFadeIn:w,shouldStartVisible:k,isLoaded:h===l.P6.loaded||h===l.P6.notLoaded&&e.shouldStartVisible,isLandscape:R===l.Aw.landscape,isCenter:x===l.N_.center,isCenterContain:x===l.N_.centerContain,isCenterCover:x===l.N_.centerCover,isContain:x===l.N_.contain,isCover:x===l.N_.cover,isNone:x===l.N_.none,isError:h===l.P6.error,isNotImageFit:void 0===x});return r.createElement("div",{className:M.root,style:{width:b,height:S},ref:o},r.createElement("img",(0,n.__assign)({},m,{onLoad:p,onError:f,key:"fabricImage"+e.src||"",className:M.image,ref:(0,u.a)(i,t),src:v,alt:y,role:_,loading:B})))}));h.displayName="ImageBase";var p=o(58546),f=o(34959),m={root:"ms-Image",rootMaximizeFrame:"ms-Image--maximizeFrame",image:"ms-Image-image",imageCenter:"ms-Image-image--center",imageContain:"ms-Image-image--contain",imageCover:"ms-Image-image--cover",imageCenterContain:"ms-Image-image--centerContain",imageCenterCover:"ms-Image-image--centerCover",imageNone:"ms-Image-image--none",imageLandscape:"ms-Image-image--landscape",imagePortrait:"ms-Image-image--portrait"},v=(0,i.I)(h,(function(e){var t=e.className,o=e.width,i=e.height,n=e.maximizeFrame,r=e.isLoaded,s=e.shouldFadeIn,a=e.shouldStartVisible,l=e.isLandscape,c=e.isCenter,u=e.isContain,d=e.isCover,g=e.isCenterContain,h=e.isCenterCover,v=e.isNone,y=e.isError,b=e.isNotImageFit,S=e.theme,C=(0,p.Km)(m,S),w={position:"absolute",left:"50% /* @noflip */",top:"50%",transform:"translate(-50%,-50%)"},k=(0,f.z)(),T=void 0!==k&&void 0===k.navigator.msMaxTouchPoints,x=u&&l||d&&!l?{width:"100%",height:"auto"}:{width:"auto",height:"100%"};return{root:[C.root,S.fonts.medium,{overflow:"hidden"},n&&[C.rootMaximizeFrame,{height:"100%",width:"100%"}],r&&s&&!a&&p.lw.fadeIn400,(c||u||d||g||h)&&{position:"relative"},t],image:[C.image,{display:"block",opacity:0},r&&["is-loaded",{opacity:1}],c&&[C.imageCenter,w],u&&[C.imageContain,T&&{width:"100%",height:"100%",objectFit:"contain"},!T&&x,!T&&w],d&&[C.imageCover,T&&{width:"100%",height:"100%",objectFit:"cover"},!T&&x,!T&&w],g&&[C.imageCenterContain,l&&{maxWidth:"100%"},!l&&{maxHeight:"100%"},w],h&&[C.imageCenterCover,l&&{maxHeight:"100%"},!l&&{maxWidth:"100%"},w],v&&[C.imageNone,{width:"auto",height:"auto"}],b&&[!!o&&!i&&{height:"auto",width:"100%"},!o&&!!i&&{height:"100%",width:"auto"},!!o&&!!i&&{height:"100%",width:"100%"}],l&&C.imageLandscape,!l&&C.imagePortrait,!r&&"is-notLoaded",s&&"is-fadeIn",y&&"is-error"]}}),void 0,{scope:"Image"},!0);v.displayName="Image"},14523:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{Aw:()=>n,N_:()=>i,P6:()=>r}),function(e){e[e.center=0]="center",e[e.contain=1]="contain",e[e.cover=2]="cover",e[e.none=3]="none",e[e.centerCover=4]="centerCover",e[e.centerContain=5]="centerContain"}(i||(i={})),function(e){e[e.landscape=0]="landscape",e[e.portrait=1]="portrait"}(n||(n={})),function(e){e[e.notLoaded=0]="notLoaded",e[e.loaded=1]="loaded",e[e.error=2]="error",e[e.errorLoaded=3]="errorLoaded"}(r||(r={}))},53803:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>d}),3023==o.j)var i=o(30206);var n=o(95734);if(3023==o.j)var r=o(97245);if(3023==o.j)var s=o(99269);if(3023==o.j)var a=o(61037);if(3023==o.j)var l=o(34907);if(3023==o.j)var c=o(28848);if(3023==o.j)var u=o(19954);function d(e){var t=n.useRef(),o=e.keytipProps?(0,i.__assign)({disabled:e.disabled},e.keytipProps):void 0,d=(0,r.d)(c._.getInstance()),g=(0,s.Z)(e);(0,a.E)((function(){t.current&&o&&((null==g?void 0:g.keytipProps)!==e.keytipProps||(null==g?void 0:g.disabled)!==e.disabled)&&d.update(o,t.current)})),(0,a.E)((function(){return o&&(t.current=d.register(o)),function(){o&&d.unregister(o,t.current)}}),[]);var h={ariaDescribedBy:void 0,keytipId:void 0};return o&&(h=function(e,t,o){var n=e.addParentOverflow(t),r=(0,l._)(o,(0,u.gt)(n.keySequences)),s=(0,i.__spreadArray)([],n.keySequences,!0);return n.overflowSetSequence&&(s=(0,u.YY)(s,n.overflowSetSequence)),{ariaDescribedBy:r,keytipId:(0,u.Z2)(s)}}(d,o,e.ariaDescribedBy)),h}},20919:(e,t,o)=>{"use strict";var i;o.d(t,{H:()=>i}),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(i||(i={}))},70210:(e,t,o)=>{"use strict";o.d(t,{S:()=>I});var i,n=o(3749),r=o(30206),s=o(95734),a=o(58546),l=o(49166),c=o(7969),u=o(85849),d=o(42093),g=o(37128),h=o(77825),p=o(35143),f=o(12928);!function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(i||(i={}));var m=o(24189),v=o(60351),y=(0,l.Z)(),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"==typeof e.content?s.createElement("p",{className:t._classNames.subText},e.content):s.createElement("div",{className:t._classNames.subText},e.content)},t}return(0,r.__extends)(t,e),t.prototype.render=function(){var e,t,o=(e=this.props).className,i=e.calloutProps,n=e.directionalHint,a=e.directionalHintForRTL,l=e.styles,c=e.id,u=e.maxWidth,d=void 0===(t=e.onRenderContent)?this._onRenderContent:t,g=e.targetElement,h=e.theme;return this._classNames=y(l,{theme:h,className:o||i&&i.className,beakWidth:i&&i.isBeakVisible?i.beakWidth:0,gapSpace:i&&i.gapSpace,maxWidth:u}),s.createElement(m.P,(0,r.__assign)({target:g,directionalHint:n,directionalHintForRTL:a},i,(0,p.G1)(this.props,p.JM,["id"]),{className:this._classNames.root}),s.createElement("div",{className:this._classNames.content,id:c,onFocus:this.props.onFocus,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},d(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:v.A.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(s.Component),S=(0,n.I)(b,(function(e){var t=e.className,o=e.beakWidth,i=void 0===o?16:o,n=e.gapSpace,r=void 0===n?0:n,s=e.maxWidth,l=e.theme,c=l.semanticColors,u=l.fonts,d=l.effects,g=-(Math.sqrt(i*i/2)+r)+1/window.devicePixelRatio;return{root:["ms-Tooltip",l.fonts.medium,a.lw.fadeIn200,{background:c.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:g,left:g,right:g,top:g,zIndex:0}}},t],content:["ms-Tooltip-content",u.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"}),C=o(20919),w=o(70325),k=o(64925),T=(0,l.Z)(),x=function(e){function t(o){var n=e.call(this,o)||this;return n._tooltipHost=s.createRef(),n._defaultTooltipId=(0,c.O)("tooltip"),n.show=function(){n._toggleTooltip(!0)},n.dismiss=function(){n._hideTooltip()},n._getTargetElement=function(){if(n._tooltipHost.current){var e=n.props.overflowMode;if(void 0!==e)switch(e){case i.Parent:return n._tooltipHost.current.parentElement;case i.Self:return n._tooltipHost.current}return n._tooltipHost.current}},n._onTooltipFocus=function(e){n._ignoreNextFocusEvent?n._ignoreNextFocusEvent=!1:n._onTooltipMouseEnter(e)},n._onTooltipContentFocus=function(e){t._currentVisibleTooltip&&t._currentVisibleTooltip!==n&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=n,n._clearDismissTimer(),n._clearOpenTimer()},n._onTooltipBlur=function(e){var t;n._ignoreNextFocusEvent=(null===(t=(0,k.LW)(n.context))||void 0===t?void 0:t.activeElement)===e.target,n._dismissTimerId=n._async.setTimeout((function(){n._hideTooltip()}),0)},n._onTooltipMouseEnter=function(e){var o,i,r=(o=n.props).overflowMode,s=o.delay,a=(0,k.LW)(n.context);if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==n&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=n,void 0!==r){var l=n._getTargetElement();if(l&&!function(e){return e.clientWidth<e.scrollWidth}(i=l)&&!function(e){return e.clientHeight<e.scrollHeight}(i))return}if(!e.target||!(0,u.s)(e.target,n._getTargetElement(),a))if(n._clearDismissTimer(),n._clearOpenTimer(),s!==C.H.zero){var c=n._getDelayTime(s);n._openTimerId=n._async.setTimeout((function(){n._toggleTooltip(!0)}),c)}else n._toggleTooltip(!0)},n._onTooltipMouseLeave=function(e){var o=n.props.closeDelay;n._clearDismissTimer(),n._clearOpenTimer(),o?n._dismissTimerId=n._async.setTimeout((function(){n._toggleTooltip(!1)}),o):n._toggleTooltip(!1),t._currentVisibleTooltip===n&&(t._currentVisibleTooltip=void 0)},n._onTooltipKeyDown=function(e){(e.which===d.c.escape||e.ctrlKey)&&n.state.isTooltipVisible&&(n._hideTooltip(),e.stopPropagation())},n._clearDismissTimer=function(){n._async.clearTimeout(n._dismissTimerId)},n._clearOpenTimer=function(){n._async.clearTimeout(n._openTimerId)},n._hideTooltip=function(){n._clearOpenTimer(),n._clearDismissTimer(),n._toggleTooltip(!1)},n._toggleTooltip=function(e){n.state.isTooltipVisible!==e&&n.setState({isTooltipVisible:e},(function(){return n.props.onTooltipToggle&&n.props.onTooltipToggle(e)}))},n._getDelayTime=function(e){switch(e){case C.H.medium:return 300;case C.H.long:return 500;default:return 0}},(0,g.f)(n),n.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},n}return(0,r.__extends)(t,e),t.prototype.render=function(){var e,t,o=(e=this.props).calloutProps,i=e.children,n=e.content,l=e.directionalHint,c=e.directionalHintForRTL,u=e.hostClassName,d=e.id,g=void 0===(t=e.setAriaDescribedBy)||t,f=e.tooltipProps,m=e.styles,v=e.theme;this._classNames=T(m,{theme:v,className:u});var y=this.state.isTooltipVisible,b=d||this._defaultTooltipId,C=(0,r.__assign)((0,r.__assign)({id:"".concat(b,"--tooltip"),content:n,targetElement:this._getTargetElement(),directionalHint:l,directionalHintForRTL:c,calloutProps:(0,h.kp)({},o,{onDismiss:this._hideTooltip,onFocus:this._onTooltipContentFocus,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},(0,p.G1)(this.props,p.JM,["id"])),f),w=(null==f?void 0:f.onRenderContent)?f.onRenderContent(C,(function(e){return(null==e?void 0:e.content)?s.createElement(s.Fragment,null,e.content):null})):n,k=y&&!!w,x=g&&y&&w?b:void 0;return s.createElement("div",(0,r.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipFocus},{onBlurCapture:this._onTooltipBlur},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":x}),i,k&&s.createElement(S,(0,r.__assign)({},C)),s.createElement("div",{hidden:!0,id:b,style:a.dX},w))},t.prototype.componentDidMount=function(){this._async=new f.j(this)},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:C.H.medium},t.contextType=w._0,t}(s.Component),_={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"},I=(0,n.I)(x,(function(e){var t=e.className,o=e.theme;return{root:[(0,a.Km)(_,o).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},61028:(e,t,o)=>{"use strict";o.d(t,{D:()=>i});var i=o(95734).createContext(void 0)},9214:(e,t,o)=>{"use strict";if(o.d(t,{j:()=>u}),3023==o.j)var i=o(30206);var n=o(95734);if(3023==o.j)var r=o(47177);if(3023==o.j)var s=o(77825);if(3023==o.j)var a=o(90305);if(3023==o.j)var l=o(74416);if(3023==o.j)var c=o(61028);var u=function(e){var t=e.customizerContext,o=e.ref,u=e.theme,d=e.as||"div",g="string"==typeof e.as?(0,r._)(e.as,e):e.as===n.Fragment?{children:e.children}:(0,s.cJ)(e,["as"]);return n.createElement(c.D.Provider,{value:u},n.createElement(a.z.Provider,{value:t},n.createElement(l.N,{providerRef:o},n.createElement(d,(0,i.__assign)({},g)))))}},60565:(e,t,o)=>{"use strict";o.d(t,{K:()=>l});var i=o(78340),n=o(68224),r=o(78104),s=o(95839),a=0,l={reset:function(){i.nr.getInstance().onReset((function(){return a++}))},getId:function(){return a},renderStyles:function(e,t){return(0,n.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,r.n)(e)},renderKeyframes:function(e){return(0,s.i)(e)}}},56568:(e,t,o)=>{"use strict";o.d(t,{D:()=>a});var i=o(95734);if(3023==o.j)var n=o(80618);if(3023==o.j)var r=o(62520);if(3023==o.j)var s=o(61028);var a=function(){var e=(0,i.useContext)(s.D),t=(0,n.m)(["theme"]).theme;return e||t||(0,r.a)({})}},36068:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>l}),3023==o.j)var i=o(30118);var n=o(95734);if(3023==o.j)var r=o(56568);if(3023==o.j)var s=o(7969);var a=new Map,l=function(e){var t=e.theme,o=(0,r.D)(),l=e.theme=n.useMemo((function(){var e=(0,i.z)(o,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=[],i=0,n=e;i<n.length;i++){var r=n[i];if(r){var l=r.id||a.get(r);l||(l=(0,s.O)(""),a.set(r,l)),o.push(l)}}return o.join("-")}(o,t),e}),[o,t]);e.customizerContext=n.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:l},scopedSettings:l.components||{}}}}),[l]),e.theme.rtl!==o.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")}},99719:(e,t,o)=>{"use strict";var i;o.d(t,{AR:()=>i,YF:()=>a,kA:()=>c}),o(95734),function(e){e[e.small=0]="small",e[e.medium=1]="medium",e[e.large=2]="large",e[e.xLarge=3]="xLarge",e[e.xxLarge=4]="xxLarge",e[e.xxxLarge=5]="xxxLarge",e[e.unknown=999]="unknown"}(i||(i={}));var n,r,s=3023==o.j?[479,639,1023,1365,1919,99999999]:null;function a(){var e;return null!==(e=null!=n?n:r)&&void 0!==e?e:i.large}function l(e){try{return e.document.documentElement.clientWidth}catch(t){return e.innerWidth}}function c(e){var t=i.small;if(e){try{for(;l(e)>s[t];)t++}catch(e){t=a()}r=t}else{if(void 0===n)throw new Error("Content was rendered in a server environment without providing a default responsive mode. Call setResponsiveMode to define what the responsive mode is.");t=n}return t}},50602:(e,t,o)=>{"use strict";o.d(t,{Cm:()=>l,aR:()=>s,er:()=>a,fy:()=>n,oQ:()=>r,uA:()=>i});var i,n="ktp",r="-",s="data-ktp-target",a="data-ktp-execute-target",l="ktp-layer-id";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(i||(i={}))},28848:(e,t,o)=>{"use strict";o.d(t,{_:()=>a});var i=o(30206),n=o(55125),r=o(7969),s=o(50602),a=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var o=e;t||(o=this.addParentOverflow(e),this.sequenceMapping[o.keySequences.toString()]=o);var i=this._getUniqueKtp(o);if(t?this.persistedKeytips[i.uniqueID]=i:this.keytips[i.uniqueID]=i,this.inKeytipMode||!this.delayUpdatingKeytipChange){var r=t?s.uA.PERSISTED_KEYTIP_ADDED:s.uA.KEYTIP_ADDED;n.g.raise(this,r,{keytip:o,uniqueID:i.uniqueID})}return i.uniqueID},e.prototype.update=function(e,t){var o=this.addParentOverflow(e),i=this._getUniqueKtp(o,t),r=this.keytips[t];r&&(i.keytip.visible=r.keytip.visible,this.keytips[t]=i,delete this.sequenceMapping[r.keytip.keySequences.toString()],this.sequenceMapping[i.keytip.keySequences.toString()]=i.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||n.g.raise(this,s.uA.KEYTIP_UPDATED,{keytip:i.keytip,uniqueID:i.uniqueID}))},e.prototype.unregister=function(e,t,o){void 0===o&&(o=!1),o?delete this.persistedKeytips[t]:delete this.keytips[t],!o&&delete this.sequenceMapping[e.keySequences.toString()];var i=o?s.uA.PERSISTED_KEYTIP_REMOVED:s.uA.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||n.g.raise(this,i,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){n.g.raise(this,s.uA.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){n.g.raise(this,s.uA.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=(0,i.__spreadArray)([],e.keySequences,!0);if(t.pop(),0!==t.length){var o=this.sequenceMapping[t.toString()];if(o&&o.overflowSetSequence)return(0,i.__assign)((0,i.__assign)({},e),{overflowSetSequence:o.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){n.g.raise(this,s.uA.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=(0,r.O)()),{keytip:(0,i.__assign)({},e),uniqueID:t}},e._instance=new e,e}()},19954:(e,t,o)=>{"use strict";if(o.d(t,{YY:()=>a,Z2:()=>s,gt:()=>l}),3023==o.j)var i=o(30206);if(3023==o.j)var n=o(50602);if(3023==o.j)var r=o(32693);function s(e){return e.reduce((function(e,t){return e+n.oQ+t.split("").join(n.oQ)}),n.fy)}function a(e,t){var o=t.length,n=(0,i.__spreadArray)([],t,!0).pop(),s=(0,i.__spreadArray)([],e,!0);return(0,r.Ty)(s,o-1,n)}function l(e){var t=" "+n.Cm;return e.length?t+" "+s(e):t}},83402:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n}),3023==o.j)var i=o(41994);function n(e){e.schemes={strong:(0,i.pw)(e),soft:(0,i.uy)(e),neutral:(0,i.h9)(e)}}},41994:(e,t,o)=>{"use strict";if(o.d(t,{h9:()=>s,pw:()=>l,uy:()=>a}),3023==o.j)var i=o(30206);if(3023==o.j)var n=o(11058);function r(e,t,o){var r=(0,n.a)({palette:(0,i.__assign)((0,i.__assign)({},e.palette),t)});return r.semanticColors=(0,i.__assign)((0,i.__assign)({},r.semanticColors),o),(0,i.__assign)((0,i.__assign)({},e),{palette:r.palette,semanticColors:r.semanticColors})}function s(e){var t=(0,n.a)(e),o=t.palette;return r(t,{themeDark:o.themeDarker,themeDarkAlt:o.themeDark,themePrimary:o.themeDarkAlt,themeSecondary:o.themePrimary,themeTertiary:o.themeSecondary,themeLight:o.themeTertiary,themeLighter:o.themeLight,themeLighterAlt:o.themeLighterAlt,neutralQuaternary:o.neutralTertiaryAlt,neutralQuaternaryAlt:o.neutralQuaternary,neutralLight:o.neutralQuaternaryAlt,neutralLighter:o.neutralLight,neutralLighterAlt:o.neutralLight,white:o.neutralLighter},{bodyBackground:o.neutralLighter,bodyStandoutBackground:o.neutralLight,bodyFrameBackground:t.isInverted?o.neutralLighter:o.neutralLight,bodyFrameDivider:t.isInverted?o.neutralQuaternaryAlt:o.neutralLight,bodyText:o.neutralPrimary,bodySubtext:o.neutralSecondary,bodyDivider:o.neutralQuaternaryAlt,focusBorder:o.neutralSecondary,variantBorder:o.neutralLight,variantBorderHovered:o.neutralTertiary,defaultStateBackground:o.neutralLight,actionLink:o.neutralPrimary,actionLinkHovered:o.neutralDark,link:o.themeDarkAlt,linkHovered:o.themeDarker,disabledBackground:t.isInverted?o.neutralLighter:o.neutralLight,disabledText:o.neutralTertiary,disabledBodyText:o.neutralTertiary,disabledBodySubtext:o.neutralTertiaryAlt,inputBorder:o.neutralTertiary,inputBorderHovered:o.neutralPrimary,inputBackground:o.white,inputFocusBorderAlt:o.themePrimary,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,buttonBackground:o.neutralQuaternaryAlt,buttonBackgroundHovered:o.neutralQuaternary,buttonBackgroundPressed:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBackgroundDisabled:o.neutralLight,buttonBorder:o.neutralSecondaryAlt,buttonText:o.neutralPrimary,buttonTextHovered:o.neutralDark,buttonTextPressed:o.neutralDark,buttonTextDisabled:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBorderDisabled:o.neutralLighter,primaryButtonBackground:o.themePrimary,primaryButtonBackgroundHovered:o.themeDarkAlt,primaryButtonBackgroundPressed:o.themeDark,primaryButtonBorder:"transparent",primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,accentButtonBackground:o.accent,accentButtonText:o.white,menuBackground:o.white,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.neutralLighter,menuItemBackgroundPressed:o.neutralLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.neutralPrimary:o.neutralDark})}function a(e){var t=(0,n.a)(e),o=t.palette;return r(t,{themeDark:o.themeDarker,themeDarkAlt:o.themeDark,themePrimary:o.themeDarkAlt,themeSecondary:o.themePrimary,themeTertiary:o.themeSecondary,themeLight:o.themeTertiary,themeLighter:o.themeLight,themeLighterAlt:o.themeLighter,neutralTertiaryAlt:t.isInverted?o.themeDarker:o.themeDarkAlt,neutralQuaternary:t.isInverted?o.themeDark:o.themePrimary,neutralQuaternaryAlt:t.isInverted?o.themeDarkAlt:o.themeSecondary,neutralLight:t.isInverted?o.themePrimary:o.themeTertiary,neutralLighter:t.isInverted?o.themeSecondary:o.themeLight,neutralLighterAlt:t.isInverted?o.themeTertiary:o.themeLighter,white:t.isInverted?o.themeLight:o.themeLighterAlt},{bodyBackground:t.isInverted?o.themeLight:o.themeLighterAlt,bodyStandoutBackground:t.isInverted?o.themeTertiary:o.themeLighter,bodyFrameBackground:t.isInverted?o.themeLight:o.themeLighter,bodyFrameDivider:t.isInverted?o.neutralQuaternary:o.themeLighter,bodyText:o.neutralPrimary,bodySubtext:o.neutralSecondary,bodyDivider:o.neutralQuaternaryAlt,inputBorder:o.neutralTertiary,inputBackground:o.white,inputForegroundChecked:o.themeLighter,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,focusBorder:o.neutralSecondary,variantBorder:o.neutralLight,variantBorderHovered:o.neutralTertiary,defaultStateBackground:o.neutralLight,actionLink:o.neutralPrimary,actionLinkHovered:o.neutralDark,link:o.themeDarkAlt,linkHovered:o.themeDarker,disabledBackground:o.neutralLight,disabledText:o.neutralTertiary,disabledBodyText:o.neutralTertiary,disabledBodySubtext:o.neutralTertiaryAlt,buttonBackground:o.neutralQuaternaryAlt,buttonBackgroundHovered:o.neutralQuaternary,buttonBackgroundPressed:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBackgroundDisabled:o.neutralLight,buttonBorder:"transparent",buttonText:o.neutralPrimary,buttonTextHovered:o.neutralDark,buttonTextPressed:o.neutralDark,buttonTextDisabled:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBorderDisabled:"transparent",primaryButtonBackground:o.themePrimary,primaryButtonBackgroundHovered:o.themeDarkAlt,primaryButtonBackgroundPressed:o.themeDark,primaryButtonBorder:"transparent",primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,accentButtonBackground:o.accent,accentButtonText:o.white,menuBackground:o.white,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.neutralLighter,menuItemBackgroundPressed:o.neutralLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.neutralPrimary:o.neutralDark})}function l(e){var t=(0,n.a)(e),o=t.palette,r={themeDarker:o.white,themeDark:o.neutralLighterAlt,themeDarkAlt:o.neutralLighterAlt,themePrimary:o.white,themeSecondary:o.neutralLighter,themeTertiary:o.neutralLight,themeLight:o.neutralQuaternaryAlt,themeLighter:o.neutralQuaternary,themeLighterAlt:o.neutralTertiaryAlt,black:o.neutralLighterAlt,neutralDark:o.neutralLighter,neutralPrimary:o.white,neutralPrimaryAlt:o.neutralLight,neutralSecondary:o.neutralQuaternaryAlt,neutralTertiary:o.neutralQuaternary,neutralTertiaryAlt:o.themeLighterAlt,neutralQuaternary:o.themeLighterAlt,neutralQuaternaryAlt:o.themeLighter,neutralLight:o.themeLight,neutralLighter:o.themeTertiary,neutralLighterAlt:o.themeSecondary,white:o.themePrimary},s={bodyBackground:o.themePrimary,bodyStandoutBackground:o.themeDarkAlt,bodyFrameBackground:t.isInverted?o.themePrimary:o.themeDarkAlt,bodyFrameDivider:t.isInverted?o.themeTertiary:o.themeDarkAlt,bodyText:o.white,bodySubtext:o.white,bodyDivider:o.themeTertiary,inputBorder:o.themeDarkAlt,inputBorderHovered:o.themeDarker,inputBackground:o.white,inputBackgroundChecked:o.white,inputBackgroundCheckedHovered:o.themePrimary,inputForegroundChecked:o.themeDark,inputFocusBorderAlt:o.themeTertiary,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,focusBorder:o.white,variantBorder:o.themeDarkAlt,variantBorderHovered:o.themeDarker,defaultStateBackground:o.neutralLighterAlt,actionLink:o.white,actionLinkHovered:o.white,link:o.white,linkHovered:o.white,disabledBackground:o.themeDarkAlt,disabledText:o.themeTertiary,disabledBodyText:o.neutralQuaternary,disabledBodySubtext:o.neutralTertiaryAlt,buttonBackground:o.themePrimary,buttonBackgroundHovered:o.themeDarkAlt,buttonBackgroundPressed:o.themeDark,buttonBackgroundDisabled:t.isInverted?o.themeLight:o.themeLighter,buttonBorder:o.white,buttonText:o.white,buttonTextHovered:o.white,buttonTextPressed:o.white,buttonTextDisabled:o.themeTertiary,buttonBorderDisabled:"transparent",primaryButtonBackground:o.white,primaryButtonBackgroundHovered:t.isInverted?o.themeLight:o.themeLighter,primaryButtonBackgroundPressed:t.isInverted?o.themeTertiary:o.themeLight,primaryButtonBorder:"transparent",primaryButtonText:t.isInverted?o.neutralPrimary:o.themePrimary,primaryButtonTextHovered:t.isInverted?o.neutralDark:o.themeDark,primaryButtonTextPressed:t.isInverted?o.neutralDark:o.themeDark,accentButtonBackground:o.white,accentButtonText:t.isInverted?o.neutralPrimary:o.themePrimary,menuBackground:o.themePrimary,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.themeTertiary,menuItemBackgroundPressed:o.themeLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.white:o.neutralLighter},a=(0,n.a)({palette:(0,i.__assign)((0,i.__assign)({},t.palette),r)});return a.semanticColors=(0,i.__assign)((0,i.__assign)({},a.semanticColors),s),(0,i.__assign)((0,i.__assign)({},t),{palette:a.palette,semanticColors:a.semanticColors,isInverted:!t.isInverted})}},55125:(e,t,o)=>{"use strict";o.d(t,{g:()=>r});var i=o(87886),n=o(77825),r=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,o,r,s,a){var l,c=null!=a?a:(0,i.Y)();if(e._isElement(t)){if(void 0!==c&&c.createEvent){var u=c.createEvent("HTMLEvents");u.initEvent(o,s||!1,!0),(0,n.kp)(u,r),l=t.dispatchEvent(u)}else if(void 0!==c&&c.createEventObject){var d=c.createEventObject(r);t.fireEvent("on"+o,d)}}else for(;t&&!1!==l;){var g=t.__events__,h=g?g[o]:null;if(h)for(var p in h)if(h.hasOwnProperty(p))for(var f=h[p],m=0;!1!==l&&m<f.length;m++){var v=f[m];v.objectCallback&&(l=v.objectCallback.call(v.parent,r))}t=s?t.parent:null}return l},e.isObserved=function(e,t){var o=e&&e.__events__;return!!o&&!!o[t]},e.isDeclared=function(e,t){var o=e&&e.__declaredEvents;return!!o&&!!o[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,o){for(var i in t)t.hasOwnProperty(i)&&this.on(e,i,t[i],o)},e.prototype.on=function(t,o,i,n){var r=this;if(o.indexOf(",")>-1)for(var s=o.split(/[ ,]+/),a=0;a<s.length;a++)this.on(t,s[a],i,n);else{var l=this._parent,c={target:t,eventName:o,parent:l,callback:i,options:n};if((s=t.__events__=t.__events__||{})[o]=s[o]||{count:0},s[o][this._id]=s[o][this._id]||[],s[o][this._id].push(c),s[o].count++,e._isElement(t)){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed){var o;try{if(!1===(o=i.apply(l,e))&&e[0]){var n=e[0];n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0}}catch(n){}return o}};c.elementCallback=u,t.addEventListener?t.addEventListener(o,u,n):t.attachEvent&&t.attachEvent("on"+o,u)}else c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed)return i.apply(l,e)};this._eventRecords.push(c)}},e.prototype.off=function(e,t,o,i){for(var n=0;n<this._eventRecords.length;n++){var r=this._eventRecords[n];if(!(e&&e!==r.target||t&&t!==r.eventName||o&&o!==r.callback||"boolean"==typeof i&&i!==r.options)){var s=r.target.__events__,a=s[r.eventName],l=a?a[this._id]:null;l&&(1!==l.length&&o?(a.count--,l.splice(l.indexOf(r),1)):(a.count-=l.length,delete s[r.eventName][this._id]),a.count||delete s[r.eventName]),r.elementCallback&&(r.target.removeEventListener?r.target.removeEventListener(r.eventName,r.elementCallback,r.options):r.target.detachEvent&&r.target.detachEvent("on"+r.eventName,r.elementCallback)),this._eventRecords.splice(n--,1)}}},e.prototype.raise=function(t,o,i){return e.raise(this._parent,t,o,i)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var o=0;o<e.length;o++)t[e[o]]=!0},e._uniqueId=0,e}()},78970:(e,t,o)=>{"use strict";function i(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return t.length<2?t[0]:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];t.forEach((function(t){return t&&t.apply(e,o)}))}}o.d(t,{$:()=>i})},34907:(e,t,o)=>{"use strict";function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=e.filter((function(e){return e})).join(" ").trim();return""===o?void 0:o}o.d(t,{_:()=>i})},32693:(e,t,o)=>{"use strict";function i(e,t,o){var i=e.slice();return i.splice(t,0,o),i}function n(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}o.d(t,{Ty:()=>i,r1:()=>n})},20405:(e,t,o)=>{"use strict";if(o.d(t,{K:()=>n}),3023==o.j)var i=o(32693);var n=function(e){var t={refs:[]};return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.resolver&&(0,i.r1)(t.refs,e)||(t.resolver=function(e){return function(t){for(var o=0,i=e.refs;o<i.length;o++){var n=i[o];"function"==typeof n?n(t):n&&(n.current=t)}}}(t)),t.refs=e,t.resolver}}},17103:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>n}),3023==o.j)var i=o(78970);function n(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=(0,i.$)(e,e[o],t[o]))}},47177:(e,t,o)=>{"use strict";o.d(t,{_:()=>r});var i=o(35143),n={label:i.q6,audio:i.Sg,video:i.Fo,ol:i.p3,li:i.P4,a:i.t0,button:i.uw,input:i.QQ,textarea:i.Sh,select:i.Cq,option:i.tK,table:i.al,tr:i.g0,th:i.cr,td:i.k3,colGroup:i.lA,col:i.Qf,form:i.Gp,iframe:i.Cs,img:i.xM};function r(e,t,o){var r=e&&n[e]||i.vt;return(0,i.G1)(t,r,o)}},97628:(e,t,o)=>{"use strict";function i(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}o.d(t,{D:()=>i})},37128:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(17103);function n(e){(0,i.i)(e,{componentDidMount:r,componentDidUpdate:s,componentWillUnmount:a})}function r(){l(this.props.componentRef,this)}function s(e){e.componentRef!==this.props.componentRef&&(l(e.componentRef,null),l(this.props.componentRef,this))}function a(){l(this.props.componentRef,null)}function l(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}},98099:(e,t,o)=>{"use strict";o.d(t,{I:()=>l});var i=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,n=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,r=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,s=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function l(e,t,o){return e?(e=function(e){return(e=(e=(e=e.replace(i,"")).replace(n,"")).replace(s," ")).trim()}(e),a.test(e)||!o&&r.test(e)?"":function(e,t){var o="",i=e.split(" ");return 2===i.length?(o+=i[0].charAt(0).toUpperCase(),o+=i[1].charAt(0).toUpperCase()):3===i.length?(o+=i[0].charAt(0).toUpperCase(),o+=i[2].charAt(0).toUpperCase()):0!==i.length&&(o+=i[0].charAt(0).toUpperCase()),t&&o.length>1?o.charAt(1)+o.charAt(0):o}(e,t)):""}},39142:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>s}),3023==o.j)var i=o(20018);if(3023==o.j)var n=o(7767);if(3023==o.j)var r=o(68185);var s=function(e){var t=e.stylesheetKey,o=e.children,s=(0,n.A)(),a=s.useAdoptedStylesheetEx,l=s.useMergeStylesRootStylesheets,c=s.useWindow,u=(0,r.v)(),d=l(),g=c();return a(i.P6,u,d,g),a(t,u,d,g),o(!!u)}},27031:(e,t,o)=>{"use strict";o.d(t,{c:()=>i});var i=o(95734).createContext(void 0)},68185:(e,t,o)=>{"use strict";o.d(t,{h:()=>r,v:()=>s});var i=o(95734);if(3023==o.j)var n=o(27031);var r=function(){return!!s()},s=function(){return i.useContext(n.c)}},91942:(e,t,o)=>{"use strict";o.d(t,{w:()=>n});var i=o(95734);(0,o(54167).hN)([{rawString:"@-webkit-keyframes rollout_09ccd899{0%{left:-100px}100%{left:calc(100% + 100px)}}@keyframes rollout_09ccd899{0%{left:-100px}100%{left:calc(100% + 100px)}}.backgroundShimmer_09ccd899{position:absolute;background:var(--background-color);width:80px;height:calc(100% + 100px);left:0;top:-50px;-webkit-transform:rotate(30deg);transform:rotate(30deg);-webkit-box-shadow:0 0 15px 8px var(--background-color);box-shadow:0 0 15px 8px var(--background-color);z-index:0;-webkit-animation:rollout_09ccd899 var(--animation-time) forwards;animation:rollout_09ccd899 var(--animation-time) forwards}"}]);const n=i.memo((e=>{var t;const{animationTimeMs:o,theme:n}=e;return i.createElement("div",{className:"backgroundShimmer_09ccd899",style:{"--background-color":null!==(t=null==n?void 0:n.shimmerColor)&&void 0!==t?t:"rgba(255, 255, 255, 0.8)","--animation-time":`${null!=o?o:1750}ms`}})}));n.displayName="BackgroundShimmer"},16014:(e,t,o)=>{"use strict";o.d(t,{i:()=>a});var i=o(95734);if(3023==o.j)var n=o(72124);if(3023==o.j)var r=o(30760);if(3023==o.j)var s=o(6143);const a=e=>i.createElement(n.S,{style:e.style,align:r.j5.Stretch,onKeyDown:e.onKeyDown,handledKeys:[s.h.Tab]},e.baseItems)},59523:(e,t,o)=>{"use strict";o.d(t,{u:()=>L});var i=o(89810),n=o(95734),r=o(30368),s=o(72124),a=o(30760),l=o(85936),c=o(36865),u=o(79951),d=o(48852),g=o(90437);const h=(e,t,o)=>{const i=e.accessibilityLabel||e.title||e.subtitle;return o&&t&&e.strings&&e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment?e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment.replace("{0}",i||"").replace("{1}",e.accessibilityPositionInSet.toString(10)).replace("{2}",e.accessibilitySetSize.toString(10)):i},p=e=>void 0!==e.accessibilityPositionInSet&&void 0!==e.accessibilitySetSize&&e.accessibilityPositionInSet>0&&e.accessibilityPositionInSet<=e.accessibilitySetSize&&e.accessibilitySetSize>=1,f=e=>e.title&&e.titleStyle&&0!==e.titleStyle.length?1===e.titleStyle.length&&0===e.titleStyle[0].start&&e.titleStyle[0].length===e.title.length?Object.assign({},e.titleStyle[0]):void 0:{},m=(e,t,o,i,n)=>{const s=f(e);if(!s)return;const a=g.O4(e,n),l=(null==n?void 0:n.useFluentV9)&&(0,r.I)()?"CanvasText":g.gZ(t,o,e.disabled,g.uk(e,i),a.title);return g.hM(s,l)},v=(e,t,o,i,n)=>{const s=g.O4(e,n),a=(null==n?void 0:n.useFluentV9)&&(0,r.I)()?"CanvasText":g.gZ(t,o,e.disabled,g.uk(e,i),s.tag||s.title);return g.hM(e.tagStyle,a)},y=(e,t,o,i,n)=>{var r;if(!e.titleFormatting_DONOTUSE&&f(e))return;const s=g.O4(e,n),a=g.gZ(t,o,e.disabled,g.uk(e,i),s.title);return g.EF(null!==(r=e.titleFormatting_DONOTUSE)&&void 0!==r?r:e.titleStyle,a,o)},b=(e,t,o,i,n)=>{const s=g.O4(e,n),a=(null==n?void 0:n.useFluentV9)&&(0,r.I)()?"CanvasText":g.gZ(t,o,e.disabled,g.uk(e,i),s.subtitle||s.title);return g.hM(e.subtitleStyle,a)},S=(e,t,o,i,n)=>{if(!e.subtitleFormatting)return;const r=g.O4(e,n),s=g.gZ(t,o,e.disabled,g.uk(e,i),r.subtitle||r.title);return g.EF(e.subtitleFormatting,s,o)},C=(e,t,o,i,n,r)=>{const s=null!=n?n:((e,t)=>{const o=g.O4(e,t);return o.icon||o.title})(e,r);return g.gZ(t,o,e.disabled,g.uk(e,i),s)};var w=o(58546),k=o(37024),T=o(74906),x=o(60351),_=o(70210),I=o(20919);(0,o(54167).hN)([{rawString:"@media screen and (-ms-high-contrast: active),(forced-colors: active){.hasKeyboardFocus_67b207b6{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials:hover{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}}"}]);class E extends n.Component{render(){var e;const t=-16-(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.horizontalSpacing)?this.props.style.horizontalSpacing:0);return n.createElement("div",{style:{height:24,width:24,position:"fixed",background:this.props.theme.badgeBackground,border:"1px solid "+this.props.theme.badgeText,borderTopRightRadius:"50%",borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",boxSizing:"border-box",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13)",marginLeft:t,marginTop:-16,textAlign:"center",color:this.props.theme.badgeText,paddingTop:2,zIndex:1,userSelect:"none"}},this.props.text)}}var A=o(47632);class B{constructor(e){this._event=e}get isOriginal(){return this._event.currentTarget===this._event.target}stopPropagation(){this._event.stopPropagation()}}var R=o(75885),M=o(99413);let D=0;var P=o(22919),N=o(63649),F=o(50213);const O=["gridcell","option","row","tab"],j=n.memo(n.forwardRef(((e,t)=>{var o;const r=!1,a=n.useRef(null),l=n.useRef(null),c=(D++,`CompositeButtonBase${D}`),u=n.useRef(null),f=n.useRef(null),m=n.useContext(i.O),[v,y]=n.useState(!1),[b,S]=n.useState(!1),[C,j]=n.useState(!1);n.useImperativeHandle(t,(()=>({focus:H,getElementRef:G,updateState_StorybookTestOnly:()=>{}})));const L=()=>{var t,o,i,n;m?e.updateItemHeight&&(null===(i=l.current)||void 0===i?void 0:i.offsetHeight)&&e.updateItemHeight(null===(n=l.current)||void 0===n?void 0:n.offsetHeight):e.updateItemHeight&&(null===(t=u.current)||void 0===t?void 0:t.offsetHeight)&&e.updateItemHeight(null===(o=u.current)||void 0===o?void 0:o.offsetHeight)};n.useEffect((()=>{L()}),[L]);const H=()=>{var t,o;e.refusesKeyboardFocus||(m?null===(t=l.current)||void 0===t||t.focus():null===(o=a.current)||void 0===o||o.focus())},z=(0,w.Zq)({":focus-visible":{outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important"},".fui-CompoundButton__contentContainer":{width:"100%",justifyContent:"center"}}),W=(0,w.Zq)({outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important","@media (forced-colors: active)":{outline:"var(--strokeWidthThick) solid highlight !important"}}),G=()=>u;n.useEffect((()=>{m||e.tooltip&&f.current&&(e.isSelectedByKeyboard?f.current.show():f.current.dismiss())}),[e.isSelectedByKeyboard,m,f]);const U=()=>{var t;e.disabled||(null===(t=e.onHoverIn)||void 0===t||t.call(e),j(!0))},V=()=>{var t;e.disabled||(null===(t=e.onHoverOut)||void 0===t||t.call(e),j(!1),y(!1))},$=()=>{var t;e.disabled||(null===(t=e.onPressIn)||void 0===t||t.call(e),y(!0))},K=()=>{var t;e.disabled||(null===(t=e.onPressOut)||void 0===t||t.call(e),y(!1))},J=()=>{var t;!e.disabled&&(null===(t=e.onClick)||void 0===t||t.call(e))},Z=t=>{var o;const i=new B(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,i),S(!0))},Y=t=>{var o;const i=new B(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,i),S(!1))},Q=()=>{var t;const o=p(e),i=(e=>("overflow"===e.accessibilityRole||"splitbutton"===e.accessibilityRole)&&void 0!==e.accessibilityState&&void 0!==e.onAccessibilityExpandCollapse)(e),n=O.includes(null!==(t=e.accessibilityRole)&&void 0!==t?t:"")?e.hasKeyboardFocus:void 0,s={role:oe(),"aria-label":h(e,r,o),"aria-posinset":o?e.accessibilityPositionInSet:void 0,"aria-setsize":o?e.accessibilitySetSize:void 0,"aria-haspopup":i,"aria-selected":n,"aria-labelledby":!m&&e.tooltip?c:void 0};return i&&!e.disableAccessibilityExpanded&&(s["aria-expanded"]=e.accessibilityState),s},X=t=>{var o,i,n,r,s,a,l,c,u,h,p,f,v;const y=g.O4(e,{useFluentV9:m}),b=d.f6(e),S=y.focusRing?{[`.${T.Y2} &:focus`]:{selectors:{":after":{border:"none",outlineColor:y.focusRing}}}}:void 0,C=d.DF(e.style),w=d.Q6(e.style),k=d.ot(e.style),x=d.Xo(e.style),_=d.Cl(e.style,"start"),I=d.Cl(e.style,"end"),E=(0,M.W)(e.style,"topStart"),A=(0,M.W)(e.style,"topEnd"),B=(0,M.W)(e.style,"bottomStart"),R=(0,M.W)(e.style,"bottomEnd"),D={borderWidth:d.Cl(e.style),borderLeftWidth:t?I:_,borderTopWidth:d.Cl(e.style,"top"),borderRightWidth:t?_:I,borderBottomWidth:d.Cl(e.style,"bottom"),borderRadius:(0,M.W)(e.style),borderTopLeftRadius:t?A:E,borderTopRightRadius:t?E:A,borderBottomRightRadius:t?B:R,borderBottomLeftRadius:t?R:B,border:null===(o=e.style)||void 0===o?void 0:o.border};return Object.assign(Object.assign({backgroundColor:y.background.resting,paddingTop:d.AF(e.style),paddingLeft:t?w:C,paddingBottom:d.em(e.style),paddingRight:t?C:w,marginTop:d.rf(e.style),marginRight:t?k:x,marginBottom:d.dV(e.style),marginLeft:t?x:k},D),{boxShadow:null===(i=e.style)||void 0===i?void 0:i.boxShadow,opacity:d.qr(e),flexGrow:b,flexShrink:b,textAlign:d.AW(e.style),width:e.useFullWidth?"100%":null===(n=e.style)||void 0===n?void 0:n.width,minWidth:null!==(s=null===(r=e.style)||void 0===r?void 0:r.minWidth)&&void 0!==s?s:0,maxWidth:null!==(l=null===(a=e.style)||void 0===a?void 0:a.maxWidth)&&void 0!==l?l:"none",height:null===(c=e.style)||void 0===c?void 0:c.height,minHeight:null!==(h=null===(u=e.style)||void 0===u?void 0:u.minHeight)&&void 0!==h?h:"min-content",maxHeight:null===(p=e.style)||void 0===p?void 0:p.maxHeight,position:null===(f=e.style)||void 0===f?void 0:f.position,bottom:null===(v=e.style)||void 0===v?void 0:v.bottom,selectors:S})},ee=()=>({justifyContent:d.XI(e.style),flexDirection:"row",alignItems:"stretch"}),te=t=>{const o=Object.assign(Object.assign({},g.O4(e,{useFluentV9:m})),{focusRing:void 0}),i=g.SL(v&&!e.topPanelScopeButton,C&&!e.topPanelScopeButton,e.hoverRing,g.uk(e,b),e.disabled,e.showBorderWhenDisabled,o,{useFluentV9:m});return Object.assign(Object.assign({},X(t)),i)},oe=()=>{switch(e.accessibilityRole){case"menuitem":case"option":case"tab":return e.accessibilityRole;case"overflow":return"menuitem";default:return"button"}},{badgeProps:ie,theme:ne,tooltip:re,tooltipProps:se,refusesKeyboardFocus:ae}=e,{tooltip:le,title:ce}=null!=ne?ne:{},ue=null!==(o=null==le?void 0:le.backgroundColor)&&void 0!==o?o:null==ne?void 0:ne.background.resting,de=n.createElement(n.Fragment,null,ie?n.createElement(E,Object.assign({},ie)):void 0,n.createElement(A.q.Consumer,null,(t=>{const o=m?(t=>{var o,i;const r=(a=Object.assign(Object.assign({lineHeight:"normal",fontWeight:"normal"},te(t)),ee()),Object.keys(a).forEach((e=>void 0===a[e]&&delete a[e])),a);var a;const c=Object.assign({onFocus:Z,onBlur:Y,onClick:J,onPointerEnter:U,onPointerLeave:V,onPointerDown:$,onPointerUp:K,style:r,disabled:e.disabled},Q());e.onHeightChange&&(null==l?void 0:l.current)&&e.onHeightChange(l.current.getBoundingClientRect().height);const u=n.createElement(P._,Object.assign({className:g.uk(e,b)?(0,N.z)(z,W):z,as:"button","data-automation-id":e.automationLabel,id:e.htmlId,ref:l,appearance:e.appearance},c),e.children);return e.topPanelScopeButton?n.createElement(s.S,null,u,n.createElement("div",{style:{paddingLeft:r.paddingLeft,paddingRight:r.paddingRight,width:"100%",boxSizing:"border-box"}},n.createElement("div",{style:{width:"100%",height:"3px",background:null!==(i=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==i?i:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):u})(t):(t=>{var o,i;const l=te(t),c=Object.assign({onFocus:Z,onBlur:Y,onClick:J,onPointerEnter:U,onPointerLeave:V,onPointerDown:$,onPointerUp:K,styles:{root:l,rootPressed:l,rootFocused:l,rootHovered:l,rootDisabled:l,flexContainer:ee()},disabled:e.disabled,ariaLabel:h(e,r,p(e))},Q());R.tO(e,c),e.onHeightChange&&u.current&&e.onHeightChange(u.current.getBoundingClientRect().height);const d=n.createElement(k._,Object.assign({role:e.topPanelScopeButton?"tab":"button",id:e.htmlId,elementRef:u,componentRef:a,className:g.uk(e,b)?"hasKeyboardFocus_67b207b6":void 0},c,{"data-automation-id":e.automationLabel}),e.children);return e.topPanelScopeButton?n.createElement(s.S,null,d,n.createElement("div",{style:{paddingLeft:l.paddingLeft,paddingRight:l.paddingRight,width:"100%",boxSizing:"border-box"}},n.createElement("div",{style:{width:"100%",height:"3px",background:null!==(i=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==i?i:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):d})(t);return ae?(t=>{const o=X(t),i=ee(),r=Object.assign({onMouseEnter:U,onMouseLeave:V,onMouseDown:$,onMouseUp:K,onClick:J,style:Object.assign(Object.assign(Object.assign(Object.assign({},o),{display:"flex"}),i),{cursor:"pointer"})},Q());return n.createElement("div",Object.assign({},r),e.children)})(t):o})));return re?m?n.createElement(A.q.Consumer,null,(t=>{var o,i,r,s,a,l,u;const d=(0,w.Zq)({maxWidth:null==se?void 0:se.calloutMaxWidth,borderRadius:null==se?void 0:se.borderRadius,paddingLeft:t?null==se?void 0:se.paddingEnd:null==se?void 0:se.paddingStart,paddingTop:null==se?void 0:se.paddingTop,paddingRight:t?null==se?void 0:se.paddingStart:null==se?void 0:se.paddingEnd,paddingBottom:null==se?void 0:se.paddingBottom});return n.createElement(F.m,{withArrow:null==se?void 0:se.showBeak,content:{children:re,className:d},relationship:"inaccessible",mountNode:document.getElementById(null!==(i=null===(o=e.tooltipProps)||void 0===o?void 0:o.layerHostId)&&void 0!==i?i:c),positioning:null!==(s=null===(r=e.tooltipProps)||void 0===r?void 0:r.positioning)&&void 0!==s?s:q(null!==(l=null===(a=e.tooltipProps)||void 0===a?void 0:a.directionHint)&&void 0!==l?l:x.A.bottomCenter)},(null===(u=e.tooltipProps)||void 0===u?void 0:u.layerHostId)?de:n.createElement("div",{id:c,style:{display:"flex"}},de))})):n.createElement(A.q.Consumer,null,(e=>{var t,o;return n.createElement(_.S,{componentRef:f,directionalHint:null!==(t=null==se?void 0:se.directionHint)&&void 0!==t?t:x.A.bottomCenter,content:re,styles:{root:{display:"flex"}},id:c,calloutProps:{coverTarget:null==se?void 0:se.coverTarget,isBeakVisible:null==se?void 0:se.showBeak,onClick:J,backgroundColor:ue,gapSpace:null==se?void 0:se.gapSpace,calloutMaxWidth:null==se?void 0:se.calloutMaxWidth,layerProps:(null==se?void 0:se.layerHostId)?{hostId:se.layerHostId}:void 0,styles:{beakCurtain:{backgroundColor:ue},root:{backgroundColor:ue,cursor:"pointer",borderRadius:null==se?void 0:se.borderRadius,paddingLeft:e?null==se?void 0:se.paddingEnd:null==se?void 0:se.paddingStart,paddingTop:null==se?void 0:se.paddingTop,paddingRight:e?null==se?void 0:se.paddingStart:null==se?void 0:se.paddingEnd,paddingBottom:null==se?void 0:se.paddingBottom}}},tooltipProps:{styles:{content:{backgroundColor:ue},subText:{color:null!==(o=null==le?void 0:le.textColor)&&void 0!==o?o:null==ce?void 0:ce.resting,borderRadius:8}}},delay:I.H.long},de)})):de})));function q(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case x.A.topLeftEdge:return{position:"above",align:"start"};case x.A.topCenter:case x.A.topAutoEdge:return{position:"above",align:"center"};case x.A.topRightEdge:return{position:"above",align:"end"};case x.A.bottomLeftEdge:return{position:"below",align:"start"};case x.A.bottomCenter:case x.A.bottomAutoEdge:return{position:"below",align:"center"};case x.A.bottomRightEdge:return{position:"below",align:"end"};case x.A.leftTopEdge:return{position:"before",align:"top"};case x.A.leftCenter:return{position:"before",align:"center"};case x.A.leftBottomEdge:return{position:"before",align:"bottom"};case x.A.rightTopEdge:return{position:"after",align:"top"};case x.A.rightCenter:return{position:"after",align:"center"};case x.A.rightBottomEdge:return{position:"after",align:"bottom"}}}j.displayName="CompositeButtonBase";const L=n.memo(n.forwardRef(((e,t)=>{const o=n.useContext(i.O),[g,h]=n.useState(!1),[p,f]=n.useState(!1),[w,k]=n.useState(!1);return n.createElement(j,Object.assign({ref:t},e,{onHoverIn:()=>{var t;null===(t=e.onHoverIn)||void 0===t||t.call(e),k(!0)},onHoverOut:()=>{var t;null===(t=e.onHoverOut)||void 0===t||t.call(e),k(!1),h(!1)},onFocus:t=>{var o;!t.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,t),f(!0))},onBlur:t=>{var o;!t.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,t),f(!1))},onPressIn:()=>{var t;null===(t=e.onPressIn)||void 0===t||t.call(e),h(!0)},onPressOut:()=>{var t;null===(t=e.onPressOut)||void 0===t||t.call(e),h(!1)}}),((e,t,o,i,r,g,h)=>{var p,f,w,k,T,x,_,I,E,A,B;if(e.children)return e.children;const R={flexibleSize:d.f6(e)?"center"!==d.AW(e.style):void 0},M=((e,t,o,i,r,a)=>{var l,u;if(void 0===e.icon)return;const d={type:e.icon.type,style:e.icon.style,primaryColor:e.icon.primaryColor||C(e,t,o,i,r,a),filled:o&&(null===(l=e.icon)||void 0===l?void 0:l.filled),fontSize:e.icon.fontSize||(null===(u=e.style)||void 0===u?void 0:u.iconFontSize)};return c.In.shouldRender(d,a)?n.createElement(s.S,{accessible:e.iconShouldBeAccessible},n.createElement(c.In,Object.assign({},d))):void 0})(e,o,i,r,g,h),D=(e=>{if(void 0!==e.personaCoinProps&&!e.icon)return n.createElement(s.S,{accessible:e.iconShouldBeAccessible},n.createElement(u.c,Object.assign({},e.personaCoinProps)))})(e),P=((e,t,o,i,r,s)=>{if(e.title)return n.createElement(l.c,{text:e.title,style:Object.assign(Object.assign({},e.titleRootStyle),m(e,o,i,r,s)||{}),formatting:t(y(e,o,i,r,s)),accessibilityHidden:!0})})(e,(e=>e),o,i,r,h),N=((e,t,o,i,r)=>e.tag?n.createElement(s.S,{style:{marginHorizontal:8}},n.createElement(l.c,{text:e.tag,style:v(e,t,o,i,r),accessibilityHidden:!0})):void 0)(e,o,i,r,h),F=M||D;if(!F&&!P)return null;let O=null!==(f=null===(p=e.style)||void 0===p?void 0:p.textPaddingStart)&&void 0!==f?f:null===(w=e.style)||void 0===w?void 0:w.textHorizontalPadding,j=null!==(T=null===(k=e.style)||void 0===k?void 0:k.textPaddingEnd)&&void 0!==T?T:null===(x=e.style)||void 0===x?void 0:x.textHorizontalPadding;if(void 0===O&&void 0===j){const e=M||D?8:0;O=e,j=e}const q=P?n.createElement(s.S,{justifyContent:a.Pr.Center,align:"center"!==d.AW(e.style)?a.j5.Stretch:void 0,style:Object.assign({paddingStart:O,paddingEnd:j,minWidth:0},F?{flexibleSize:!0}:R)},N?n.createElement(s.S,{direction:a.PR.LeftToRight,align:a.j5.Baseline,style:{flexibleSize:!0}},P,N):P,((e,t,o,i,r)=>e.subtitle?n.createElement(s.S,{style:{paddingTop:2,width:"100%"}},n.createElement(l.c,{text:e.subtitle,style:b(e,t,o,i,r),formatting:S(e,t,o,i,r),accessibilityHidden:!0})):void 0)(e,o,i,r,h)):void 0,L=e.tagText?n.createElement(s.S,{align:a.j5.Center,justifyContent:a.Pr.Center,style:null===(_=e.tagStyles)||void 0===_?void 0:_.containerStyles},n.createElement(l.c,{text:e.tagText,style:null===(I=e.tagStyles)||void 0===I?void 0:I.textStyles,accessibilityHidden:e.disableTagAccessibility})):void 0;return F?n.createElement(s.S,{direction:a.PR.LeftToRight,align:a.j5.Center,style:Object.assign({minWidth:0},R)},null!=M?M:D,void 0!==(null===(E=e.style)||void 0===E?void 0:E.iconTextSpacing)&&0!==(null===(A=e.style)||void 0===A?void 0:A.iconTextSpacing)&&n.createElement(s.S,{style:{paddingHorizontal:null===(B=e.style)||void 0===B?void 0:B.iconTextSpacing}}),q,L):q})(e,0,g,w,p,(()=>{var t,i;if((0,r.I)())return{resting:"CanvasText",focused:(null===(i=null===(t=e.icon)||void 0===t?void 0:t.style)||void 0===i?void 0:i.backgroundColor)?"CanvasText":o?"Highlight":"HighlightText",pressed:"Canvas"}})(),{useFluentV9:o}))})));L.displayName="CompositeButton"},62670:(e,t,o)=>{"use strict";var i,n;o.d(t,{A:()=>i,R:()=>n}),function(e){e[e.bottomCenter=5]="bottomCenter",e[e.rightCenter=12]="rightCenter"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center"}(n||(n={}))},48852:(e,t,o)=>{"use strict";if(o.d(t,{AF:()=>s,AW:()=>f,Cl:()=>g,DF:()=>n,Q6:()=>r,XI:()=>m,Xo:()=>c,dV:()=>d,em:()=>a,f6:()=>p,ot:()=>l,qr:()=>h,rf:()=>u}),3023==o.j)var i=o(62670);const n=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingStart)&&void 0!==o?o:0)},r=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingEnd)&&void 0!==o?o:0)},s=e=>{var t;return null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8},a=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingBottom)&&void 0!==o?o:0)},l=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginStart)&&void 0!==o?o:0)},c=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginEnd)&&void 0!==o?o:0)},u=e=>{var t;return null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0},d=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginBottom)&&void 0!==o?o:0)},g=(e,t)=>{var o,i;return void 0===t?void 0===(null==e?void 0:e.borderThickness)||"number"==typeof(null==e?void 0:e.borderThickness)?null!==(o=null==e?void 0:e.borderThickness)&&void 0!==o?o:1:void 0:"object"==typeof(null==e?void 0:e.borderThickness)?null!==(i=e.borderThickness[t])&&void 0!==i?i:0:void 0},h=e=>e.hidden?0:1,p=e=>{var t;return(null===(t=e.style)||void 0===t?void 0:t.flexibleSize)?1:void 0},f=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"start",m=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"flex-start"},90437:(e,t,o)=>{"use strict";if(o.d(t,{$C:()=>r,EF:()=>c,G7:()=>n,O4:()=>g,SL:()=>a,gZ:()=>l,hM:()=>u,uk:()=>d}),3023==o.j)var i=o(30368);const n={background:{resting:"#FFFFFF",hover:"#D2D2D2",pressed:"#B1B1B1"},title:{resting:"#262626",disabled:"#666666"},tag:{resting:"#605e5c",disabled:"#666666"},subtitle:{resting:"#666666",disabled:"#666666"},focusRing:"#969696"},r={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},tag:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},subtitle:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},s={background:{resting:"var(--colorBrandBackground)",hover:"var(--colorBrandBackgroundHover)",pressed:"var(--colorBrandBackgroundPressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForegroundOnBrand)"},tag:{resting:"var(--colorNeutralForegroundOnBrand)"},subtitle:{resting:"var(--colorNeutralForegroundOnBrand)"},icon:{resting:"var(--colorNeutralForegroundOnBrand)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},a=(e,t,o,n,r,s,a,l)=>{const c={};r?a.background.disabled&&(c.backgroundColor=a.background.disabled,s&&a.border&&(c.borderColor=a.border)):(t&&((null==l?void 0:l.useFluentV9)&&(0,i.I)()?(c.backgroundColor="Canvas",c.borderColor="Highlight"):(a.background.hover&&(c.backgroundColor=a.background.hover),a.focusRing&&o&&(c.borderColor=a.focusRing))),n&&(a.background.focused&&(c.backgroundColor=a.background.focused),a.focusRing&&(c.borderColor=a.focusRing)),e&&a.background.pressed&&(c.backgroundColor=a.background.pressed),a.border&&!c.borderColor&&(c.borderColor=a.border));const u=c.backgroundColor||((null==l?void 0:l.useFluentV9)&&(0,i.I)()?"Canvas":a.background.resting);return{backgroundColor:u,borderColor:c.borderColor||u}},l=(e,t,o,i,n)=>{let r=n.resting;return o?n.disabled&&(r=n.disabled):(t&&n.hover&&(r=n.hover),i&&n.focused&&(r=n.focused),e&&n.pressed&&(r=n.pressed)),r},c=(e,t,o)=>e.map((e=>{var i;let n=null!==(i=e.cssColor)&&void 0!==i?i:t;return o&&e.cssColorHover&&(n=e.cssColorHover),Object.assign(Object.assign({},e),{cssColor:n})})).filter((e=>!!e)),u=(e,t)=>e&&e.cssColor?e:e&&t?Object.assign(Object.assign({},e),{cssColor:t}):t?{cssColor:t}:e,d=(e,t)=>{const o=!(!e.showUnderline||!e.topPanelScopeButton);return t||!!e.hasKeyboardFocus||o},g=(e,t)=>e.theme?e.theme:(null==t?void 0:t.useFluentV9)?"primary"===e.appearance?s:r:n},5779:(e,t,o)=>{"use strict";o.d(t,{R:()=>u,y:()=>d});var i=o(95734),n=o(89810),r=o(86373),s=o(88891),a=o(19728),l=o(68436),c=o(84027);const u=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useContext(n.O),l=i.useRef(null),c=i.useRef(null);(0,i.useImperativeHandle)(t,(()=>({focus:u})));const u=()=>{var e,t;o?null===(e=c.current)||void 0===e||e.focus():null===(t=l.current)||void 0===t||t.focus()};return o?i.createElement(d,Object.assign({},e,{ref:c})):i.createElement(a.R,{direction:(()=>{switch(e.direction){case r.E.Horizontal:return s.E.horizontal;case r.E.Vertical:return s.E.vertical;default:return s.E.bidirectional}})(),componentRef:l},e.children)})));u.displayName="FocusZone";const d=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useRef(null),{findFirstFocusable:n}=(0,l.r)(),{children:s,disableInitialFocus:a,direction:u=r.E.Default}=e;(0,i.useEffect)((()=>{a||d()}),[]),(0,i.useImperativeHandle)(t,(()=>({focus:d})));const d=()=>{var e;o.current&&(null===(e=n(o.current))||void 0===e||e.focus())},g=(0,c.i)({circular:u===r.E.Default,axis:u===r.E.Default?"grid":u===r.E.Horizontal?"horizontal":"vertical"}),h=u!==r.E.None?g:{};return i.createElement("div",Object.assign({ref:o},h),s)})));d.displayName="FocusZoneV9"},86373:(e,t,o)=>{"use strict";var i;o.d(t,{E:()=>i}),function(e){e[e.Default=0]="Default",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal",e[e.None=3]="None"}(i||(i={}))},80034:(e,t,o)=>{"use strict";o.d(t,{Y:()=>a});var i=o(95734);if(3023==o.j)var n=o(72124);if(3023==o.j)var r=o(30760);if(3023==o.j)var s=o(85936);function a(e){var t,o,a,l;const c=i.useRef(0),u=i.useRef(0),d=()=>{if(!e.onHeaderHeightChange)return;const t=e.componentStackStyle.marginTop?e.componentStackStyle.marginTop:e.componentStackStyle.marginVertical,o=e.componentStackStyle.paddingTop?e.componentStackStyle.paddingTop:e.componentStackStyle.paddingVertical;let i=0;e.componentStackStyle.borderWidth&&(i="object"==typeof e.componentStackStyle.borderWidth?e.componentStackStyle.borderWidth.top?e.componentStackStyle.borderWidth.top:0:e.componentStackStyle.borderWidth),e.onHeaderHeightChange((t||0)+(o||0)+i+c.current+u.current)},g=e.tagText?i.createElement(n.S,{align:r.j5.Center,justifyContent:r.Pr.Center,style:null===(t=e.tagStyles)||void 0===t?void 0:t.containerStyles},i.createElement(s.c,{text:e.tagText,style:null===(o=e.tagStyles)||void 0===o?void 0:o.textStyles,accessibilityHidden:!0})):void 0;return i.createElement(n.S,{direction:e.stackDirection,style:e.componentStackStyle,align:e.stackAlignment,accessibleLive:null!==(a=e.accessibleLive)&&void 0!==a?a:r.pq.Polite,accessibilityLabel:null!==(l=e.accessibleLabel)&&void 0!==l?l:e.header,accessibilityRole:"group",accessible:!0,focusable:e.focusable},e.header&&i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Center},i.createElement(s.c,{onHeightChange:e=>{e!=c.current&&(c.current=e,d())},text:e.header,style:e.headerStyle,accessibilityHidden:!0}),g),e.subheader&&e.subheaderStyle?i.createElement(s.c,{onHeightChange:e=>{e!=u.current&&(u.current=e,d())},text:e.subheader,style:e.subheaderStyle,accessibilityRole:"text"}):i.createElement(i.Fragment,null),e.children)}},30368:(e,t,o)=>{"use strict";function i(){return window.matchMedia("@media screen and (-ms-high-contrast: active), (forced-colors: active)").matches}o.d(t,{I:()=>i})},97328:(e,t,o)=>{"use strict";o.d(t,{_:()=>r});var i=o(95734);if(3023==o.j)var n=o(31248);const r=e=>{var t,o;return i.createElement(i.Fragment,null,i.createElement(n._,{src:e.uri,width:null===(t=e.style)||void 0===t?void 0:t.width,height:null===(o=e.style)||void 0===o?void 0:o.height,alt:e.altText}))}},16563:(e,t,o)=>{"use strict";o.d(t,{o:()=>I});var i=o(95734),n=o(90437),r=o(59523),s=o(6143),a=o(89810);const l=e=>e.accessibilityLabel||e.title||e.strings&&e.strings.defaultOverflowButtonAccessibilityLabel,c=(e,t,o)=>{var i,r;const s=Object.assign({},null!==(r=null!==(i=t.buttonOnlyTheme)&&void 0!==i?i:t.theme)&&void 0!==r?r:(null==o?void 0:o.useFluentV9)?n.$C:n.G7);return e&&(s.background.hover&&(s.background=Object.assign(Object.assign({},s.background),{resting:s.background.hover})),s.title.hover&&(s.title=Object.assign(Object.assign({},s.title),{resting:s.title.hover})),s.subtitle&&s.subtitle.hover&&(s.subtitle=Object.assign(Object.assign({},s.subtitle),{resting:s.subtitle.hover})),s.icon&&s.icon.hover&&(s.icon=Object.assign(Object.assign({},s.icon),{resting:s.icon.hover}))),s},u=e=>{const t=e.style;return t&&void 0!==t.paddingHorizontal?t:Object.assign(Object.assign({},t),{paddingHorizontal:8})};var d=o(84027),g=o(20694),h=o(47982),p=o(73900),f=o(36865),m=o(67762),v=o(16014);function y(e){return void 0!==e.iconType?{type:e.iconType,filled:!0}:void 0}function b(e,t,o){var i,n,r;const s={paddingHorizontal:8,flexibleSize:!0,iconFontSize:20,borderRadius:null!==(n=null===(i=e.style)||void 0===i?void 0:i.borderRadius)&&void 0!==n?n:4};return!t||o||(s.paddingStart=8+(0,f.SL)(null===(r=e.icon)||void 0===r?void 0:r.fontSize)),s}const S=e=>{const t=[];if(e.items){const o=e.items.filter((e=>"item"===e.type)),n=o.some((e=>{const t=y(e);return!!t&&f.In.shouldRender(t)})),s=(null==e?void 0:e.id)||"";let a=1;t.push(e.items.map((t=>{switch(t.type){case"item":return function(e,t,o,n,s,a,l){const c=y(t),{itemTheme:u,automationLabelType:d,automationId:g}=e;return i.createElement(r.u,{appearance:"subtle",key:t.key,title:t.title,titleStyle:t.titleStyle,onClick:()=>o(t),disabled:t.disabled,theme:u,htmlId:l+t.key,accessibilityRole:"menuitem",automationLabel:`${d}_${t.title}_${g}`,icon:c,style:b(e,a,void 0!==t.iconType),accessibilityPositionInSet:n,accessibilitySetSize:s})}(e,t,e.onItemClick,a++,o.length,n,s);case"separator":return i.createElement(m.w,{key:t.key,color:e.theme&&e.theme.separator});default:return null}})))}return i.createElement(v.i,Object.assign({},e,{baseItems:t}))};class C extends i.PureComponent{getAccessibilityLabel(){return this.props.accessibilityLabel||this.props.title||this.props.strings&&this.props.strings.defaultOverflowButtonAccessibilityLabel}renderButton(e,t,o,n,s,a,l){var c,u,d,g,h;const p=Object.assign(Object.assign({},l),{layerHostId:this.props.layerHostId?this.props.layerHostId:void 0});return i.createElement(r.u,{ref:s,key:t,htmlId:a,title:this.props.title,icon:{type:null!==(u=null===(c=this.props.icon)||void 0===c?void 0:c.type)&&void 0!==u?u:"Overflow",filled:(null===(d=this.props.icon)||void 0===d?void 0:d.filled)||o},tooltip:null!==(g=this.props.tooltip)&&void 0!==g?g:null===(h=this.props.strings)||void 0===h?void 0:h.defaultOverflowButtonAccessibilityLabel,tooltipProps:p,disabled:this.props.disabled,hidden:this.props.hidden,refusesKeyboardFocus:this.props.refusesKeyboardFocus,style:this.getStyle(),theme:this.getCompositeButtonTheme(),strings:this.props.strings,onClick:e,onHoverIn:this.props.onHoverIn,onHoverOut:this.props.onHoverOut,onFocus:this.props.onFocus,onBlur:this.props.onBlur,accessibilityLabel:this.getAccessibilityLabel(),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:o,onAccessibilityExpandCollapse:n,automationLabel:`${this.props.automationLabelType}_${this.props.title||"OverFlow"}_${this.props.automationId}`,hasKeyboardFocus:this.props.hasKeyboardFocus,onHeightChange:this.props.onHeightChange})}getCompositeButtonTheme(){return this.props.buttonOnlyTheme?this.props.buttonOnlyTheme:this.props.theme?this.props.theme:n.G7}getStyle(){const e=this.props.style;return e&&void 0!==e.paddingHorizontal?e:Object.assign(Object.assign({},e),{paddingHorizontal:8})}}class w extends C{constructor(e){super(e),this.state={menuOpen:!!e.startOpen},this.buttonRef=i.createRef(),this.onMenuDismiss=this.onMenuDismiss.bind(this),this.onButtonClick=this.onButtonClick.bind(this),this.onItemClick=this.onItemClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this)}componentDidUpdate(){this.props.startOpen&&this.openMenu()}openMenu(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.handleMenuOpen())}focus(){var e;null===(e=this.buttonRef.current)||void 0===e||e.focus()}performAccessibilityExpandCollapse(e){this.onAccessibilityExpandCollapse(e)}renderAnchorButtonAndMaybeCallout(){var e;const t=this.renderButton(this.onButtonClick,"button",this.state.menuOpen,this.onAccessibilityExpandCollapse,this.buttonRef,this.props.id,null===(e=this.props.style)||void 0===e?void 0:e.tooltipProps),o=this.state.menuOpen?this.renderCallout("callout",this.onMenuDismiss):void 0;return o?[t,o]:[t]}calculateBorderRadiusForCalloutItem(){var e,t,o,i,n;if(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.borderRadius))return"number"==typeof(null===(t=this.props.style)||void 0===t?void 0:t.borderRadius)?null===(o=this.props.style)||void 0===o?void 0:o.borderRadius:null===(n=null===(i=this.props.style)||void 0===i?void 0:i.borderRadius)||void 0===n?void 0:n.topEnd}renderCalloutItems(){return i.createElement(S,Object.assign({},this.props,{style:Object.assign(Object.assign({},this.props.style),{borderRadius:this.calculateBorderRadiusForCalloutItem()}),onItemClick:this.onItemClick,onKeyDown:this.onKeyDown}))}getCompositeButtonTheme(){const e=Object.assign({},super.getCompositeButtonTheme());return this.state.menuOpen&&(e.background.hover&&(e.background=Object.assign(Object.assign({},e.background),{resting:e.background.hover})),e.title.hover&&(e.title=Object.assign(Object.assign({},e.title),{resting:e.title.hover})),e.subtitle&&e.subtitle.hover&&(e.subtitle=Object.assign(Object.assign({},e.subtitle),{resting:e.subtitle.hover})),e.icon&&e.icon.hover&&(e.icon=Object.assign(Object.assign({},e.icon),{resting:e.icon.hover}))),e}handleMenuOpen(){this.props.onMenuOpen&&this.props.onMenuOpen()}handleMenuDismiss(e){this.props.onMenuDismiss&&this.props.onMenuDismiss(e),this.shouldFocusButtonOnDismiss()&&this.focus()}onMenuDismiss(e){this.handleMenuDismiss(e),this.setState({menuOpen:!1})}onButtonClick(){this.setState((e=>{const t={menuOpen:!e.menuOpen};return t.menuOpen?this.handleMenuOpen():this.handleMenuDismiss(),t}))}onItemClick(e){this.props.onClick&&this.props.onClick(e),e.preventDismiss||this.onMenuDismiss()}onKeyDown(e){this.props.onTabClose&&e.key===s.h.Tab&&this.onMenuDismiss(!0)}onAccessibilityExpandCollapse(e){"expand"===e&&this.state.menuOpen||"collapse"===e&&!this.state.menuOpen||this.onButtonClick()}}var k=o(24189),T=o(60351),x=o(19728),_=o(88891);class I extends w{constructor(e){super(e),this.overflowButtonRef=i.createRef()}render(){return this.context?i.createElement(E,Object.assign({},this.props,{ref:this.props.refV9})):i.createElement("div",{ref:this.overflowButtonRef,style:{display:"flex"},role:"menu"},this.renderAnchorButtonAndMaybeCallout())}shouldFocusButtonOnDismiss(){var e;return null===(e=this.props.shouldFocusButtonOnDismiss)||void 0===e||e}renderCallout(e,t){var o,n,r,s;const a=null===(n=null===(o=this.props.style)||void 0===o?void 0:o.calloutStyle)||void 0===n?void 0:n.borderRadius;return i.createElement(k.P,{layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:a},calloutMain:{backgroundColor:null===(r=this.props.theme)||void 0===r?void 0:r.background.resting,borderRadius:a},root:{backgroundColor:null===(s=this.props.theme)||void 0===s?void 0:s.background.resting,borderRadius:a}},key:e,role:"menu",target:this.overflowButtonRef,isBeakVisible:!1,alignTargetEdge:!0,directionalHint:T.A.bottomLeftEdge,onDismiss:t,setInitialFocus:!0},i.createElement(x.R,{isCircularNavigation:!0,handleTabKey:_.l.all},this.renderCalloutItems()))}}I.contextType=a.O;const E=i.memo((0,i.forwardRef)(((e,t)=>{var o,n,f,m,v;const y=i.useRef(null),{menuOpen:b,button:C,buttonRef:w,focus:k,setMenuOpen:T,onAccessibilityExpandCollapse:x,onMenuOpen:_,onMenuDismiss:I,onItemClick:E,onKeyDown:A}=(e=>{const t=i.useRef(null),o=i.useRef(null),[n,d]=i.useState(!!e.startOpen),g=i.useContext(a.O),h=()=>{var e;null===(e=t.current)||void 0===e||e.focus()},p=t=>{var i;null===(i=e.onMenuDismiss)||void 0===i||i.call(e,t),!1!==e.shouldFocusButtonOnDismiss?h():(()=>{var e;null===(e=o.current)||void 0===e||e.focus()})(),o.current=null},f=e=>{p(e),d(!1)},m=()=>{d((t=>{var o;const i=!t;return i?null===(o=e.onMenuOpen)||void 0===o||o.call(e):p(),i}))},v=e=>{"expand"===e&&n||"collapse"===e&&!n||m()},y=((e,t,o,n=!1,s,a,d,g)=>{var h,p,f,m,v;return i.createElement(r.u,{appearance:"subtle",ref:a,key:o,htmlId:d,title:e.title,icon:{type:null!==(p=null===(h=e.icon)||void 0===h?void 0:h.type)&&void 0!==p?p:"Overflow",filled:(null===(f=e.icon)||void 0===f?void 0:f.filled)||n},tooltip:null!==(m=e.tooltip)&&void 0!==m?m:null===(v=e.strings)||void 0===v?void 0:v.defaultOverflowButtonAccessibilityLabel,tooltipProps:e.layerHostId?{layerHostId:e.layerHostId}:void 0,disabled:e.disabled,hidden:e.hidden,refusesKeyboardFocus:e.refusesKeyboardFocus,style:u(e),theme:c(n,e,g),strings:e.strings,onClick:t,onHoverIn:e.onHoverIn,onHoverOut:e.onHoverOut,onFocus:e.onFocus,onBlur:e.onBlur,accessibilityLabel:l(e),accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:n,onAccessibilityExpandCollapse:s,automationLabel:`${e.automationLabelType}_${e.title||"OverFlow"}_${e.automationId}`,hasKeyboardFocus:e.hasKeyboardFocus,onHeightChange:e.onHeightChange})})(e,m,"button",n,v,t,e.id,{useFluentV9:g});return{menuOpen:n,button:y,buttonRef:t,focus:h,setMenuOpen:d,onAccessibilityExpandCollapse:v,onMenuOpen:t=>{var i;n||(o.current=t?document.activeElement:null,d(!0),null===(i=e.onMenuOpen)||void 0===i||i.call(e))},onMenuDismiss:f,onItemClick:t=>{var o;null===(o=e.onClick)||void 0===o||o.call(e,t),t.preventDismiss||f()},onKeyDown:t=>{e.onTabClose&&t.key===s.h.Tab&&f(!0)}}})(Object.assign(Object.assign({},e),{shouldFocusButtonOnDismiss:null===(o=e.shouldFocusButtonOnDismiss)||void 0===o||o}));(0,i.useImperativeHandle)(t,(()=>({focus:k,openMenu:_,onAccessibilityExpandCollapse:x})));const B=(0,d.i)({circular:!0,axis:"vertical"});return i.createElement(g.A,{trapFocus:!0,open:b,onOpenChange:(e,t)=>{T(t.open),t.open?_():I()},closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(f=null===(n=w.current)||void 0===n?void 0:n.getElementRef())||void 0===f?void 0:f.current}},i.createElement(h.W,null,i.createElement("div",{id:e.layerHostId,role:"menu",style:{display:"flex"},ref:y,tabIndex:-1},C)),i.createElement(p.H,{style:{padding:4,borderWidth:"0px",borderRadius:null===(v=null===(m=e.style)||void 0===m?void 0:m.calloutStyle)||void 0===v?void 0:v.borderRadius}},i.createElement("div",Object.assign({style:{display:"flex",flexDirection:"column"},role:"menu",className:"ms-cc-overflow"},B),i.createElement(S,Object.assign({},e,{style:Object.assign(Object.assign({},e.style),{borderRadius:(()=>{var t,o,i,n,r;if(void 0!==(null===(t=e.style)||void 0===t?void 0:t.borderRadius))return"number"==typeof(null===(o=e.style)||void 0===o?void 0:o.borderRadius)?null===(i=e.style)||void 0===i?void 0:i.borderRadius:null===(r=null===(n=e.style)||void 0===n?void 0:n.borderRadius)||void 0===r?void 0:r.topEnd})()}),onItemClick:E,onKeyDown:A})))))})))},18876:(e,t,o)=>{"use strict";o.d(t,{B:()=>l});var i=o(95734),n=o(47632);(0,o(54167).hN)([{rawString:".customScrollBar_cfe9a557{scrollbar-width:none}.customScrollBar_cfe9a557::-webkit-scrollbar{display:none}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:6px;top:4px;overflow:hidden}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{position:absolute;width:3px;border-radius:6px;background:var(--thumb-color);opacity:.7}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557:hover{width:5px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.ltr_cfe9a557{right:3px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.rtl_cfe9a557{left:3px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{background:highlight !important}}"}]);var r=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function s(e,t,o){return a((e=>setTimeout(e,t)),e,o)}function a(e,t,o){let i=!1,n=!1;const s=[];let l=!1;return()=>new Promise((c=>r(this,void 0,void 0,(function*(){if("Immediately"===o){if(!i){i=!0;try{yield t()}catch(e){}e((()=>{i=!1,c()}))}}else i?(l&&(n=!0),s.push(c)):(i=!0,e((()=>r(this,void 0,void 0,(function*(){l=!0;try{yield t()}catch(e){}l=!1,i=!1,c();for(const e of s)e();n&&(n=!1,a(e,t,o))})))))}))))}const l=i.memo((e=>{var t,o,r,a;const l=!!e.alwaysShowScrollbar,[u,d]=i.useState(l),[g,h]=i.useState(20),[p,f]=i.useState((null===(t=e.style)||void 0===t?void 0:t.paddingScrollTop)?e.style.paddingScrollTop:0),[m,v]=i.useState(0),[y,b]=i.useState(!1),S=i.useRef({delta:{x:0,y:0}}),C=i.useRef(null),w=i.useRef(null),k=(null===(o=e.style)||void 0===o?void 0:o.scrollbarThumbWidth)?e.style.scrollbarThumbWidth:6,T=(null===(r=e.style)||void 0===r?void 0:r.scrollbarPaddingBottom)?e.style.scrollbarPaddingBottom:0,x=()=>{var t,o;if(C.current){const{style:i}=e,{clientHeight:n,scrollHeight:r}=C.current;return{clientHeight:n,contentHeight:r,viewableRatio:(n-(null!==(t=null==i?void 0:i.paddingTop)&&void 0!==t?t:0)-(null!==(o=null==i?void 0:i.paddingBottom)&&void 0!==o?o:0))/(r+T)}}return{clientHeight:0,contentHeight:0,viewableRatio:0}},_=(null===(a=e.style)||void 0===a?void 0:a.paddingScrollTop)?e.style.paddingScrollTop:0,I=i.useCallback((()=>{var t;if(C.current){const{viewableRatio:e}=x();f(Math.max(e*C.current.scrollTop,_))}null===(t=e.onScroll)||void 0===t||t.call(e)}),[e.onScroll]),E={scrollableContainer:{scroll:y?I:s(I,50,"After"),mouseOver:()=>{if(!u&&c(C,u,p,l)){const{onScrollStatusChange:t}=e;t&&t(!0),d(!0)}},mouseUp:()=>{b(!1),S.current.delta={x:0,y:0}}},scrollbarContainer:{mouseDown:e=>{if(e.preventDefault(),C.current&&w.current){const{clientHeight:t,contentHeight:o}=x(),i=e.clientY-w.current.getBoundingClientRect().top;C.current.scroll({top:i/t*o}),b(!0)}}},scrollbarThumb:{mouseDown:e=>{e.stopPropagation(),e.preventDefault(),b(!0)}}},{scrollTo:A}=e;let B;switch(i.useEffect((()=>{if(C.current){if(u)return;const t=c(C,u,p,l);if(t!==u){const{onScrollStatusChange:o}=e;o&&o(t),d(t)}}}),[C.current,u,p,l,e.onScrollStatusChange]),i.useEffect((()=>(()=>{if(C.current&&e.scrollTo){const{top:t,bottom:o,isNewRender:i}=e.scrollTo,n=6,r=Math.max(t-n,0),s=Math.min(o+n,C.current.scrollHeight);if(r<C.current.scrollTop?C.current.scrollTo({top:r,behavior:"smooth"}):s>=C.current.scrollTop+C.current.offsetHeight&&C.current.scrollTo({top:s-C.current.offsetHeight,behavior:"smooth"}),!i&&c(C,u,p,l)){const{onScrollStatusChange:t}=e;t&&t(!0),d(!0)}}})()),[null==A?void 0:A.top,null==A?void 0:A.bottom]),i.useEffect((()=>(()=>{if(C.current){const{clientHeight:e,viewableRatio:t}=x();h(Math.round(t*e)),v(e)}})())),i.useEffect((()=>{if(!y)return;const e=()=>b(!1);return window.addEventListener("mouseup",e,{once:!0,passive:!0}),()=>window.removeEventListener("mouseup",e)}),[y]),i.useEffect((()=>{if(!y)return;let e;const t=t=>{y&&(t.movementX||t.movementY)&&(S.current.delta.x+=t.movementX,S.current.delta.y+=t.movementY,null==e&&(e=requestAnimationFrame((()=>{if(e=void 0,C.current){const{y:e}=S.current.delta;S.current.delta={x:0,y:0};const{clientHeight:t,contentHeight:o}=x();C.current.scroll({top:C.current.scrollTop+e/t*o})}}))))};return window.addEventListener("mousemove",t,{passive:!0}),()=>window.removeEventListener("mousemove",t)}),[y]),e.scrollDirection){case"horizontal":B={overflowY:"hidden",overflowX:"auto",display:"flex",flexDirection:"row"};break;case"both":B={overflowY:"auto",overflowX:"auto",display:"block",flexDirection:"row"};break;default:B={overflowY:"auto",overflowX:"hidden",display:"block",flexDirection:"column"}}const R=i.useContext(n.q),M="horizontal"!==e.scrollDirection?i.createElement("div",{style:{height:m,opacity:e.hidden?0:1},className:"scrollbarContainer_cfe9a557 "+(R?"rtl_cfe9a557":"ltr_cfe9a557"),ref:w,onMouseDown:E.scrollbarContainer.mouseDown},u&&i.createElement("div",{style:{height:g,top:p,width:k,transition:y?void 0:"all 0.1s ease-out"},className:"scrollbarThumb_cfe9a557",onMouseDown:E.scrollbarThumb.mouseDown})):void 0;return i.createElement("div",{style:(t=>{let o=Object.assign({},t);const{style:i,theme:n}=e;if(i){if(i.paddingHorizontal)o.paddingRight=i.paddingHorizontal,o.paddingLeft=i.paddingHorizontal;else{const e=R?i.paddingEnd:i.paddingStart,t=R?i.paddingStart:i.paddingEnd;void 0!==t&&(o.paddingRight=t),void 0!==e&&(o.paddingLeft=e)}i.paddingTop&&(o.paddingTop=i.paddingTop),i.paddingBottom&&(o.paddingBottom=i.paddingBottom),i.borderRadius&&(o.borderRadius=i.borderRadius),i.width&&(o.width=i.width)}return n&&n.thumbColor&&(o=Object.assign(Object.assign({},o),{"--thumb-color":n.thumbColor})),o})(B),className:"customScrollBar_cfe9a557",ref:C,onScroll:E.scrollableContainer.scroll,onMouseUp:E.scrollableContainer.mouseUp,onMouseOver:E.scrollableContainer.mouseOver},e.children,M)}));function c(e,t,o,i){if(e.current){const{clientHeight:n,scrollHeight:r}=e.current;return r>n&&(o>4||t||i)}return!1}l.displayName="ScrollView"},29088:(e,t,o)=>{"use strict";o.d(t,{G:()=>u});var i=o(95734);if(3023==o.j)var n=o(75885);if(3023==o.j)var r=o(58546);if(3023==o.j)var s=o(47632);if(3023==o.j)var a=o(64576);if(3023==o.j)var l=o(87579);if(3023==o.j)var c=o(51485);const u=({htmlId:e,theme:t,styles:o,accessibilityLabel:u,accessibilitySetSize:d,accessibilityPositionInSet:g,placeholder:h,disabled:p,handledKeys:f,spellCheck:m,value:v,hideDismiss:y,autoFocus:b,isSearchBoxHighlighted:S,onValueChange:C,onKeyDown:w,onClear:k})=>{var T,x,_;const I={};n.tO({onKeyDown:w,handledKeys:f},I);const E=i.useContext(s.q),A=(0,r.Zq)({"& input":{color:null==t?void 0:t.textColor,"::placeholder":{color:null==t?void 0:t.placeholderTextColor}}}),B=(0,r.Zq)({backgroundColor:null===(T=null==t?void 0:t.clearButton)||void 0===T?void 0:T.resting,":hover":{backgroundColor:null===(x=null==t?void 0:t.clearButton)||void 0===x?void 0:x.hover}}),R=i.useRef(null);return i.useEffect((()=>{var e;S&&(null===(e=R.current)||void 0===e||e.focus())}),[S]),i.useEffect((()=>{var e;b&&(null===(e=R.current)||void 0===e||e.focus())}),[]),i.createElement(a.G,{ref:R,className:A,style:{background:null==t?void 0:t.background,borderColor:null===(_=null==t?void 0:t.borderColor)||void 0===_?void 0:_.resting,borderRadius:null==o?void 0:o.borderRadius,borderBottom:null==o?void 0:o.borderBottom,width:null==o?void 0:o.width,marginTop:null==o?void 0:o.marginTop,marginBottom:null==o?void 0:o.marginBottom,marginLeft:E?null==o?void 0:o.marginEnd:null==o?void 0:o.marginStart,marginRight:E?null==o?void 0:o.marginStart:null==o?void 0:o.marginEnd},autoComplete:"off",placeholder:h,onChange:(e,t)=>null==C?void 0:C(t.value),id:e,"aria-label":u,"aria-posinset":g,"aria-setsize":d,disabled:p,defaultValue:v,onKeyDown:I.onKeyDown,dismiss:y?null:i.createElement(l.BEt,{color:null==t?void 0:t.textColor,className:B,onClick:k}),spellCheck:m,contentBefore:i.createElement(c.vMY,{color:null==t?void 0:t.iconColor})})}},67762:(e,t,o)=>{"use strict";o.d(t,{w:()=>s});var i=o(95734);if(3023==o.j)var n=o(73747);if(3023==o.j)var r=o(47632);const s=({style:e,onHeightChange:t})=>{var o;const s=(null==e?void 0:e.marginHorizontal)?e.marginHorizontal:0,a=(null==e?void 0:e.marginVertical)?e.marginVertical:0,l=void 0!==(null==e?void 0:e.marginTop)?e.marginTop:a||0,c=void 0!==(null==e?void 0:e.marginBottom)?e.marginBottom:a||0,u=void 0!==(null==e?void 0:e.marginStart)?e.marginStart:s||0,d=void 0!==(null==e?void 0:e.marginEnd)?e.marginEnd:s||0,g=i.useContext(r.q),h=g?d:u,p=g?u:d,f=null!==(o=null==e?void 0:e.height)&&void 0!==o?o:2;t&&t(f+l+c);const m={height:`${f}px`,padding:"0px"};return i.createElement("div",{style:{marginTop:l,marginBottom:c,marginLeft:h,marginRight:p}},i.createElement(n.c,{style:m}))}},57683:(e,t,o)=>{"use strict";o.d(t,{v:()=>c});var i=o(95734);if(3023==o.j)var n=o(72124);if(3023==o.j)var r=o(30760);if(3023==o.j)var s=o(34936);if(3023==o.j)var a=o(39134);function l(e){if(e)return{paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingHorizontal:e.paddingHorizontal}}const c=e=>{var t,o,c;if(e.styles&&e.styles.widths&&e.shimmerCount!==e.styles.widths.length)return null;const u=[];for(let n=0;n<e.shimmerCount;n+=1)u.push(i.createElement("div",{style:{width:null!==(c=null===(o=null===(t=e.styles)||void 0===t?void 0:t.widths)||void 0===o?void 0:o[n])&&void 0!==c?c:void 0}},i.createElement(s.H,{style:{marginBottom:5}})));return i.createElement(n.S,{style:l(e.styles),direction:r.PR.TopToBottom,align:r.j5.Stretch},i.createElement(a.E,{appearance:"translucent"},u))}},67612:(e,t,o)=>{"use strict";o.d(t,{f:()=>m});var i=o(95734);function n(e,t){return e.hover?t?Object.assign(Object.assign({},e),{resting:e.hover}):Object.assign(Object.assign({},e),{hover:void 0}):e}function r(e,t){return Object.assign(Object.assign({},e),{resting:t,hover:void 0})}function s(e,t,o,i){return Object.assign(Object.assign({},e),{background:t&&t.splitMenuHoverBackground&&o&&i?r(e.background,t.splitMenuHoverBackground):n(e.background,o),title:t&&t.splitMenuHoverForeground&&o&&i?r(e.title,t.splitMenuHoverForeground):n(e.title,o),icon:t&&t.splitMenuHoverForeground&&o&&i?r(e.icon,t.splitMenuHoverForeground):e.icon&&n(e.icon,o)})}function a(e){var t;return null!==(t=null==e?void 0:e.borderThickness)&&void 0!==t?t:1}function l(e){var t;return null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:0}function c(e){return!(!e.menuProps||!e.menuProps.items)&&e.menuProps.items.length>0}var u=o(90437),d=o(72124),g=o(30760),h=o(59523),p=o(16563),f=o(89810);class m extends i.PureComponent{constructor(e){super(e),this.state={buttonHover:!1,buttonFocus:!1,overflowHover:!1,overflowFocus:!1,menuOpened:!1,overflowTimeout:void 0,highlightTimeout:void 0},this.buttonRef=i.createRef(),this.onButtonHoverIn=this.handleEvent.bind(this,"buttonHover",!0),this.onButtonHoverOut=this.handleEvent.bind(this,"buttonHover",!1),this.onButtonFocus=this.handleEvent.bind(this,"buttonFocus",!0),this.onButtonBlur=this.handleEvent.bind(this,"buttonFocus",!1),this.onOverflowHoverIn=this.handleEvent.bind(this,"overflowHover",!0),this.onOverflowHoverOut=this.handleEvent.bind(this,"overflowHover",!1),this.onOverflowFocus=this.handleEvent.bind(this,"overflowFocus",!0),this.onOverflowBlur=this.handleEvent.bind(this,"overflowFocus",!1),this.onMenuOpened=this.handleEvent.bind(this,"menuOpened",!0),this.onMenuDismissed=this.handleEvent.bind(this,"menuOpened",!1)}static shouldShowHighlight(e,t){return e.buttonHover||e.overflowHover||e.menuOpened||!t&&void 0!==e.highlightTimeout}static shouldSetHighlightTimerForEvent(e){return"buttonHover"===e||"overflowHover"===e}static shouldShowOverflow(e,t){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened||!t&&void 0!==e.overflowTimeout}static isSplitButtonEntered(e){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened}static setTimerHighlightedInstance(e){this.timerHighlightedInstance!==e&&(void 0!==e&&void 0!==this.timerHighlightedInstance&&void 0!==this.timerHighlightedInstance.state.highlightTimeout&&this.timerHighlightedInstance.cancelUnhighlightTimer(!1),this.timerHighlightedInstance=e)}render(){var e,t;const o=this.props.style,n={marginHorizontal:null==o?void 0:o.marginHorizontal,marginVertical:null==o?void 0:o.marginVertical,flexibleSize:null==o?void 0:o.flexibleSize,height:null==o?void 0:o.height,minHeight:null==o?void 0:o.minHeight,maxHeight:null==o?void 0:o.maxHeight},r=this.context;if(this.drawBorderOnRoot()&&!r){const o=null!==(e=this.props.buttonProps.theme)&&void 0!==e?e:u.G7;n.borderColor=null!==(t=o.border)&&void 0!==t?t:m.shouldShowHighlight(this.state)?o.background.hover:o.background.resting,n.borderStyle="solid",n.borderWidth=a(this.props.style),n.borderRadius=l(this.props.style)}return i.createElement(d.S,{direction:g.PR.LeftToRight,align:g.j5.Stretch,style:n},i.createElement(h.u,Object.assign({ref:this.buttonRef},this.computeButtonProps())),c(this.props)?i.createElement(p.o,Object.assign({},this.computeOverflowMenuProps())):null)}focus(){this.buttonRef.current&&this.buttonRef.current.focus()}componentWillUnmount(){m.timerHighlightedInstance===this&&m.setTimerHighlightedInstance(void 0),this.cancelOverflowTimer(!1),this.cancelUnhighlightTimer(!1),super.componentWillUnmount&&super.componentWillUnmount()}cancelOverflowTimer(e){void 0!==this.state.overflowTimeout&&(clearTimeout(this.state.overflowTimeout),e||this.setState({overflowTimeout:void 0}))}cancelUnhighlightTimer(e){void 0!==this.state.highlightTimeout&&(clearTimeout(this.state.highlightTimeout),e||this.setState({highlightTimeout:void 0}))}computeButtonProps(){var e;const t=this.context,o=a(this.props.style),i=l(this.props.style),r=Object.assign(Object.assign({},this.props.style),{paddingEnd:o,borderRadius:{topStart:i,bottomStart:i}});c(this.props)||(r.borderRadius={topStart:i,topEnd:i,bottomStart:i,bottomEnd:i}),this.drawBorderOnRoot()||t?r.borderThickness=0:r.borderThickness={start:o,top:o,bottom:o},this.props.menuProps||delete r.paddingEnd,delete r.marginHorizontal,delete r.marginVertical,delete r.height,delete r.minHeight,delete r.maxHeight;const s=this.props.buttonProps,d=(null==s?void 0:s.icon)?null==s?void 0:s.icon:void 0,g=function(e,t){return Object.assign(Object.assign({},e),{background:n(e.background,t),title:n(e.title,t),subtitle:e.subtitle&&n(e.subtitle,t),icon:e.icon&&n(e.icon,t)})}(null!==(e=s.theme)&&void 0!==e?e:t?u.$C:u.G7,m.shouldShowHighlight(this.state)),h=function(e,t){if(null!=e)return e.map((e=>{const o=Object.assign({},e);return t&&o.cssColorHover&&(o.cssColor=o.cssColorHover),o}))}(s.titleStyle,m.shouldShowHighlight(this.state));return Object.assign(Object.assign({},s),{titleStyle:h,appearance:"subtle",icon:d,style:r,theme:g,tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0,onHoverIn:this.onButtonHoverIn,onHoverOut:this.onButtonHoverOut,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize})}computeOverflowMenuProps(){var e;const t=a(this.props.style),o=l(this.props.style),i={paddingStart:t,borderRadius:{topEnd:o,bottomEnd:o}},n=this.context;this.drawBorderOnRoot()||n?i.borderThickness=0:i.borderThickness={top:t,end:t,bottom:t};const r=this.props.menuProps,c=null!==(e=r.theme)&&void 0!==e?e:n?u.$C:u.G7;return Object.assign(Object.assign({},r),{icon:{type:"Overflow",filled:!0},hidden:!m.shouldShowOverflow(this.state),style:i,theme:s(c,this.props.theme,m.shouldShowHighlight(this.state),this.state.overflowHover||this.state.menuOpened),accessibilityLabel:(d=this.props,d.menuProps&&d.menuProps.accessibilityLabel?d.menuProps.accessibilityLabel:d.buttonProps.title&&d.strings&&d.strings.defaultSplitButtonOverflowAccessibilityLabel?d.strings.defaultSplitButtonOverflowAccessibilityLabel.replace("{0}",d.buttonProps.title):void 0),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,layerHostId:this.props.layerHostId,onHoverIn:this.onOverflowHoverIn,onHoverOut:this.onOverflowHoverOut,onFocus:this.onOverflowFocus,onBlur:this.onOverflowBlur,onMenuOpen:this.onMenuOpened,onMenuDismiss:this.onMenuDismissed});var d}setOverflowTimer(){if(!(m.hideOverflowLagInMs<=0))return this.cancelOverflowTimer(!0),setTimeout((()=>{this.setState({overflowTimeout:void 0})}),m.hideOverflowLagInMs)}setUnhighlightTimer(){if(!(m.unhoverLagInMs<=0))return this.cancelUnhighlightTimer(!0),setTimeout((()=>{m.timerHighlightedInstance===this&&m.setTimerHighlightedInstance(void 0),this.setState({highlightTimeout:void 0})}),m.unhoverLagInMs)}handleEvent(e,t){m.shouldSetHighlightTimerForEvent(e)&&t&&m.setTimerHighlightedInstance(this),this.setState((o=>{var i,n,r,s;if(o[e]===t)return;const a=Object.assign({},o);a[e]=t,t&&("overflowHover"===e&&(a.buttonHover=!1),"buttonHover"===e&&(a.overflowHover=!1)),a.highlightTimeout=m.shouldShowHighlight(o)&&!m.shouldShowHighlight(a)?this.setUnhighlightTimer():void 0,a.overflowTimeout=m.shouldShowOverflow(o)&&!m.shouldShowOverflow(a)?this.setOverflowTimer():void 0;const l=m.isSplitButtonEntered(o),c=m.isSplitButtonEntered(a);return!l&&c?null===(n=(i=this.props.buttonProps).onSplitButtonIn)||void 0===n||n.call(i):l&&!c&&(null===(s=(r=this.props.buttonProps).onSplitButtonOut)||void 0===s||s.call(r)),a}))}drawBorderOnRoot(){return!this.props.menuProps||!m.shouldShowOverflow(this.state)}}m.hideOverflowLagInMs=5,m.unhoverLagInMs=5,m.timerHighlightedInstance=void 0,m.contextType=f.O},74505:(e,t,o)=>{"use strict";o.d(t,{V:()=>i,m:()=>n});const i='"Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif',n='Bahnschrift, "Bahnschrift Web", "Segoe UI", "Helvetica Neue"'},95389:(e,t,o)=>{"use strict";o.d(t,{w:()=>$});var i=o(95734),n=o(51882),r=o(88239),s=o(49749),a=o(47586),l=o(49463),c=o(7926),u=o(62956),d=o(51451),g=o(62611),h=o(30850),p=o(84027),f=o(59906),m=o(81585),v=o(7143),y=o(54694),b=o(2430),S=o(60171),C=o(27408),w=o(55006),k=o(27760),T=o(63649);const x=(0,k.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bnnss6s:"fi64zpg",Eh141a:"flvyvdh",qhf8xq:"f10pi13n"},horizontal:{Bt984gj:"f1q9h2pe",Beiy3e4:"f1063pyq"},vertical:{Bt984gj:"f1q9h2pe",Beiy3e4:"f1vx9l62"},roundedSmall:{i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},rounded:{i8kkvl:0,Belr9w4:0,rmohyg:"faqewft"}},{d:[".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fi64zpg{flex-shrink:0;}",".flvyvdh{flex-wrap:nowrap;}",".f10pi13n{position:relative;}",".f1q9h2pe{align-items:stretch;}",".f1vx9l62{flex-direction:column;}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],[".faqewft{gap:var(--spacingHorizontalS);}",{p:-1}]]});var _=o(89161);const I=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{appearance:o="transparent",reserveSelectedTabSpace:n=!0,disabled:r=!1,onTabSelect:s,selectTabOnFocus:a=!1,size:l="medium",vertical:c=!1}=e,u=i.useRef(null),d=(0,p.i)({circular:!0,axis:c?"vertical":"horizontal",memorizeCurrent:!0}),[g,h]=(0,f.i)({state:e.selectedValue,defaultState:e.defaultSelectedValue,initialState:void 0}),S=i.useRef(void 0),C=i.useRef(void 0);i.useEffect((()=>{C.current=S.current,S.current=g}),[g]);const w=(0,m.D)(((e,t)=>{h(t.value),null==s||s(e,t)})),k=i.useRef({}),T=(0,m.D)((e=>{k.current[JSON.stringify(e.value)]=e})),x=(0,m.D)((e=>{delete k.current[JSON.stringify(e.value)]})),_=i.useCallback((()=>({selectedValue:S.current,previousSelectedValue:C.current,registeredTabs:k.current})),[]);return{components:{root:"div"},root:v.Gk((0,y.g)("div",{ref:(0,b.a)(t,u),role:"tablist","aria-orientation":c?"vertical":"horizontal",...d,...e}),{elementType:"div"}),appearance:o,reserveSelectedTabSpace:n,disabled:r,selectTabOnFocus:a,selectedValue:g,size:l,vertical:c,onRegister:T,onUnregister:x,onSelect:w,getRegisteredTabs:_}})(e,t),n=function(e){const{appearance:t,reserveSelectedTabSpace:o,disabled:i,selectTabOnFocus:n,selectedValue:r,onRegister:s,onUnregister:a,onSelect:l,getRegisteredTabs:c,size:u,vertical:d}=e;return{tabList:{appearance:t,reserveSelectedTabSpace:o,disabled:i,selectTabOnFocus:n,selectedValue:r,onSelect:l,onRegister:s,onUnregister:a,getRegisteredTabs:c,size:u,vertical:d}}}(o);return(e=>{const{appearance:t,vertical:o,size:i}=e,n=x(),r="subtle-circular"===t||"filled-circular"===t;e.root.className=(0,T.z)("fui-TabList",n.root,o?n.vertical:n.horizontal,r&&("small"===i?n.roundedSmall:n.rounded),e.root.className)})(o),(0,_.$e)("useTabListStyles_unstable")(o),((e,t)=>((0,C.C)(e),(0,S.Y)(e.root,{children:(0,S.Y)(w.bd,{value:t.tabList,children:e.root.children})})))(o,n)}));I.displayName="TabList";var E=o(45896),A=o(44585),B=o(51284);const R=(0,k.X)({root:{Bt984gj:"f122n59",mc9l5x:"f13qh94s",Bnnss6s:"fi64zpg",Bxotwcr:"f1u07yai",Budl1dq:"frn2hmy",wkccdc:"f1olsevy",oeaueh:"f1s6fcnf",qhf8xq:"f10pi13n"},button:{Bt984gj:"f122n59",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bceei9c:"f1k6fduh",mc9l5x:"f13qh94s",Bnnss6s:"fi64zpg",Bxotwcr:"f1u07yai",Budl1dq:"frn2hmy",wkccdc:"f1olsevy",Bahqtrf:"fk6fouc",Bg96gwp:"f1i3iumi",oeaueh:"f1s6fcnf",qhf8xq:"f10pi13n",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B9bfxx9:"f1cxpek8"},horizontal:{Brf1p80:"f4d9j23"},vertical:{Brf1p80:"f1s9ku6b"},smallHorizontal:{i8kkvl:"f14mj54c",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1wmopi4"},smallVertical:{i8kkvl:"f14mj54c",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f12or63q"},mediumHorizontal:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1w08f2p"},mediumVertical:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fymxs25"},largeHorizontal:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ssfvub"},largeVertical:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fwkd1rq"},transparent:{De3pzq:"f1c21dwh",B95qlz1:"f9rvdkv",B7xitij:"f1051ucx",Bptxc3x:"fmmjozx",Bwqhzpy:"fqhzt5g",iyk698:"f7l5cgy",cl4aha:"fpkze5g",B0q3jbp:"f1iywnoi",Be9ayug:"f9n45c4"},subtle:{De3pzq:"fhovq9v",B95qlz1:"f1bifk9c",B7xitij:"fo6hitd",Bptxc3x:"fmmjozx",Bwqhzpy:"fqhzt5g",iyk698:"f7l5cgy",cl4aha:"fpkze5g",B0q3jbp:"f1iywnoi",Be9ayug:"f9n45c4"},disabled:{De3pzq:"f1c21dwh",Bptxc3x:"fato7r6",cl4aha:"fao1bnu",Bceei9c:"fdrzuqr"},selected:{Bptxc3x:"f1cadz5z",Bwqhzpy:"fwhdxxj",iyk698:"fintccb",cl4aha:"ffplhdr",B0q3jbp:"fjo17wb",Be9ayug:"f148789c"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9",Bptxc3x:"ftorr8m",cl4aha:"f16lqpmv"},subtleCircular:{De3pzq:"f1c21dwh",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fp7rvkm",sj55zd:"fkfq4zb",B95qlz1:"f1yywxnv",Eo63ln:0,r9osk6:0,Itrz8y:0,zeg6vx:0,l65xgk:0,Bw4olcx:0,Folb0i:0,I2h8y4:0,Bgxgoyi:0,Bvlkotb:0,Fwyncl:0,Byh5edv:0,Becqvjq:0,uumbiq:0,B73q3dg:0,Bblwbaf:0,B0ezav:"ft57sj0",r4wkhp:"f1fcoy83",B7xitij:"f1lzpamt",d3wsvi:0,Hdqn7s:0,zu5y1p:0,owqphb:0,g9c53k:0,Btmu08z:0,Bthxvy6:0,gluvuq:0,tb88gp:0,wns6jk:0,kdfdk4:0,Bbw008l:0,Bayi1ib:0,B1kkfu3:0,J1oqyp:0,kem6az:0,goa3yj:"fhn220o",p743kt:"f15qf7sh"},subtleCircularSelected:{De3pzq:"f16xkysk",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f1c2pc3t",sj55zd:"faj9fo0",B95qlz1:"fsm7zmf",Eo63ln:0,r9osk6:0,Itrz8y:0,zeg6vx:0,l65xgk:0,Bw4olcx:0,Folb0i:0,I2h8y4:0,Bgxgoyi:0,Bvlkotb:0,Fwyncl:0,Byh5edv:0,Becqvjq:0,uumbiq:0,B73q3dg:0,Bblwbaf:0,B0ezav:"f1wo0sfq",r4wkhp:"f1afuynh",B7xitij:"f94ddyl",d3wsvi:0,Hdqn7s:0,zu5y1p:0,owqphb:0,g9c53k:0,Btmu08z:0,Bthxvy6:0,gluvuq:0,tb88gp:0,wns6jk:0,kdfdk4:0,Bbw008l:0,Bayi1ib:0,B1kkfu3:0,J1oqyp:0,kem6az:0,goa3yj:"fmle6oo",p743kt:"f1d3itm4"},subtleCircularDisabled:{De3pzq:"f1c21dwh",sj55zd:"f1s2aq7o",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fp7rvkm"},subtleCircularDisabledSelected:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fegtqic"},filledCircular:{De3pzq:"f16xq7d1",sj55zd:"fkfq4zb",B95qlz1:"fwwxidx",r4wkhp:"f1fcoy83",B7xitij:"f14i52sd",p743kt:"f15qf7sh"},filledCircularSelected:{De3pzq:"ffp7eso",sj55zd:"f1phragk",B95qlz1:"f1lm9dni",r4wkhp:"f1mn5ei1",B7xitij:"f1g6ncd0",p743kt:"fl71aob"},filledCircularDisabled:{De3pzq:"f1bg9a2p",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fp7rvkm",sj55zd:"f1s2aq7o"},filledCircularDisabledSelected:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fegtqic"}},{d:[".f122n59{align-items:center;}",".f13qh94s{display:grid;}",".fi64zpg{flex-shrink:0;}",".f1u07yai{grid-auto-flow:column;}",".frn2hmy{grid-template-columns:auto;}",".f1olsevy{grid-template-rows:auto;}",".f1s6fcnf{outline-style:none;}",".f10pi13n{position:relative;}",[".f3bhgqh{border:none;}",{p:-2}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1k6fduh{cursor:pointer;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f1cxpek8{text-transform:none;}",".f4d9j23{justify-content:center;}",".f1s9ku6b{justify-content:start;}",".f14mj54c{column-gap:var(--spacingHorizontalXXS);}",[".f1wmopi4{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalSNudge);}",{p:-1}],[".f12or63q{padding:var(--spacingVerticalXXS) var(--spacingHorizontalSNudge);}",{p:-1}],".f1rjii52{column-gap:var(--spacingHorizontalSNudge);}",[".f1w08f2p{padding:var(--spacingVerticalM) var(--spacingHorizontalMNudge);}",{p:-1}],[".fymxs25{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalMNudge);}",{p:-1}],[".f1ssfvub{padding:var(--spacingVerticalL) var(--spacingHorizontalMNudge);}",{p:-1}],[".fwkd1rq{padding:var(--spacingVerticalS) var(--spacingHorizontalMNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f9rvdkv:enabled:hover{background-color:var(--colorTransparentBackgroundHover);}",".f1051ucx:enabled:active{background-color:var(--colorTransparentBackgroundPressed);}",".fmmjozx .fui-Tab__icon{color:var(--colorNeutralForeground2);}",".fqhzt5g:enabled:hover .fui-Tab__icon{color:var(--colorNeutralForeground2Hover);}",".f7l5cgy:enabled:active .fui-Tab__icon{color:var(--colorNeutralForeground2Pressed);}",".fpkze5g .fui-Tab__content{color:var(--colorNeutralForeground2);}",".f1iywnoi:enabled:hover .fui-Tab__content{color:var(--colorNeutralForeground2Hover);}",".f9n45c4:enabled:active .fui-Tab__content{color:var(--colorNeutralForeground2Pressed);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".f1bifk9c:enabled:hover{background-color:var(--colorSubtleBackgroundHover);}",".fo6hitd:enabled:active{background-color:var(--colorSubtleBackgroundPressed);}",".fato7r6 .fui-Tab__icon{color:var(--colorNeutralForegroundDisabled);}",".fao1bnu .fui-Tab__content{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f1cadz5z .fui-Tab__icon{color:var(--colorCompoundBrandForeground1);}",".fwhdxxj:enabled:hover .fui-Tab__icon{color:var(--colorCompoundBrandForeground1Hover);}",".fintccb:enabled:active .fui-Tab__icon{color:var(--colorCompoundBrandForeground1Pressed);}",".ffplhdr .fui-Tab__content{color:var(--colorNeutralForeground1);}",".fjo17wb:enabled:hover .fui-Tab__content{color:var(--colorNeutralForeground1Hover);}",".f148789c:enabled:active .fui-Tab__content{color:var(--colorNeutralForeground1Pressed);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],".ftorr8m .fui-Tab__icon{color:inherit;}",".f16lqpmv .fui-Tab__content{color:inherit;}",[".fp7rvkm{border:solid var(--strokeWidthThin) var(--colorTransparentStroke);}",{p:-2}],".fkfq4zb{color:var(--colorNeutralForeground2);}",".f1yywxnv:enabled:hover{background-color:var(--colorNeutralBackground1Hover);}",[".ft57sj0:enabled:hover{border:solid var(--strokeWidthThin) var(--colorNeutralStroke1Hover);}",{p:-2}],".f1fcoy83:enabled:hover{color:var(--colorNeutralForeground2Hover);}",".f1lzpamt:enabled:active{background-color:var(--colorNeutralBackground1Pressed);}",[".fhn220o:enabled:active{border:solid var(--strokeWidthThin) var(--colorNeutralStroke1Pressed);}",{p:-2}],".f15qf7sh:enabled:active{color:var(--colorNeutralForeground2Pressed);}",".f16xkysk{background-color:var(--colorBrandBackground2);}",[".f1c2pc3t{border:solid var(--strokeWidthThin) var(--colorCompoundBrandStroke);}",{p:-2}],".faj9fo0{color:var(--colorBrandForeground2);}",".fsm7zmf:enabled:hover{background-color:var(--colorBrandBackground2Hover);}",[".f1wo0sfq:enabled:hover{border:solid var(--strokeWidthThin) var(--colorCompoundBrandStrokeHover);}",{p:-2}],".f1afuynh:enabled:hover{color:var(--colorBrandForeground2Hover);}",".f94ddyl:enabled:active{background-color:var(--colorBrandBackground2Pressed);}",[".fmle6oo:enabled:active{border:solid var(--strokeWidthThin) var(--colorCompoundBrandStrokePressed);}",{p:-2}],".f1d3itm4:enabled:active{color:var(--colorBrandForeground2Pressed);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",[".fp7rvkm{border:solid var(--strokeWidthThin) var(--colorTransparentStroke);}",{p:-2}],[".fegtqic{border:solid var(--strokeWidthThin) var(--colorNeutralStrokeDisabled);}",{p:-2}],".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fwwxidx:enabled:hover{background-color:var(--colorNeutralBackground3Hover);}",".f14i52sd:enabled:active{background-color:var(--colorNeutralBackground3Pressed);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".f1lm9dni:enabled:hover{background-color:var(--colorBrandBackgroundHover);}",".f1mn5ei1:enabled:hover{color:var(--colorNeutralForegroundOnBrand);}",".f1g6ncd0:enabled:active{background-color:var(--colorBrandBackgroundPressed);}",".fl71aob:enabled:active{color:var(--colorNeutralForegroundOnBrand);}",".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",[".fp7rvkm{border:solid var(--strokeWidthThin) var(--colorTransparentStroke);}",{p:-2}],[".fegtqic{border:solid var(--strokeWidthThin) var(--colorNeutralStrokeDisabled);}",{p:-2}]]}),M=(0,k.X)({base:{B8q5s1w:"f8hki3x",Bci5o5g:["f1d2448m","ffh67wi"],n8qw10:"f1bjia2o",Bdrgwmp:["ffh67wi","f1d2448m"],Bn4voq9:"f1p7hgxw",Bfpq7zp:"f1way5bb",g9k6zt:"f9znhxp",j6ew2k:["fqa318h","fqa318h"],Bhxq17a:"f1vjpng2"}},{d:[".f8hki3x[data-fui-focus-visible]{border-top-color:transparent;}",".f1d2448m[data-fui-focus-visible]{border-right-color:transparent;}",".ffh67wi[data-fui-focus-visible]{border-left-color:transparent;}",".f1bjia2o[data-fui-focus-visible]{border-bottom-color:transparent;}",".f1p7hgxw[data-fui-focus-visible]{outline-width:var(--strokeWidthThick);}",".f1way5bb[data-fui-focus-visible]{outline-color:transparent;}",".f9znhxp[data-fui-focus-visible]{outline-style:solid;}",".fqa318h[data-fui-focus-visible]{box-shadow:var(--shadow4),0 0 0 var(--strokeWidthThick) var(--colorStrokeFocus2);}",".f1vjpng2[data-fui-focus-visible]{z-index:1;}"]}),D=(0,k.X)({base:{az7l2e:"fhw179n",vqofr:0,Bv4n3vi:0,Bgqb9hq:0,B0uxbk8:0,Bf3jju6:"fg9j5n4",amg5m6:"f1kmhr4c",zkfqfm:"fl1ydde",Bkydozb:"f1y7maxz",Bka2azo:0,vzq8l0:0,csmgbd:0,Br4ovkg:0,aelrif:"fceyvr4",y36c18:"f16cxu0",B1ctymy:"f1nwgacf",Bgvrrv0:"f15ovonk",ddr6p5:"fvje46l"},disabled:{az7l2e:"f1ut20fw",Bkydozb:"fhrzcfn"},smallHorizontal:{lawp4y:"fchca7p",Baz25je:"f1r53b5e",Fbdkly:["f1s6rxz5","fo35v8s"],mdwyqc:["fo35v8s","f1s6rxz5"]},smallVertical:{lawp4y:"fze4zud",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"fdp32p8",Ccq8qp:"f1aij3q"},mediumHorizontal:{lawp4y:"fchca7p",Baz25je:"f1s2r9ax",Fbdkly:["f1o0nnkk","fxb7rol"],mdwyqc:["fxb7rol","f1o0nnkk"]},mediumVertical:{lawp4y:"f17jracn",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"f117lcb2",Ccq8qp:"f1aij3q"},largeHorizontal:{lawp4y:"fchca7p",Baz25je:"f1s2r9ax",Fbdkly:["f1o0nnkk","fxb7rol"],mdwyqc:["fxb7rol","f1o0nnkk"]},largeVertical:{lawp4y:"fel9d3z",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"f6vqlre",Ccq8qp:"f1aij3q"}},{h:[".fhw179n:hover::before{background-color:var(--colorNeutralStroke1Hover);}",[".fg9j5n4:hover::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f1kmhr4c:hover::before{content:"";}',".fl1ydde:hover::before{position:absolute;}",".f1ut20fw:hover::before{background-color:var(--colorTransparentStroke);}"],a:[".f1y7maxz:active::before{background-color:var(--colorNeutralStroke1Pressed);}",[".fceyvr4:active::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f16cxu0:active::before{content:"";}',".f1nwgacf:active::before{position:absolute;}",".fhrzcfn:active::before{background-color:var(--colorTransparentStroke);}"],m:[["@media (forced-colors: active){.f15ovonk:hover::before{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fvje46l:active::before{background-color:Highlight;}}",{m:"(forced-colors: active)"}]],d:[".fchca7p::before{bottom:0;}",".f1r53b5e::before{height:var(--strokeWidthThick);}",".f1s6rxz5::before{left:var(--spacingHorizontalSNudge);}",".fo35v8s::before{right:var(--spacingHorizontalSNudge);}",".fze4zud::before{bottom:var(--spacingVerticalXS);}",".f1fzr1x6::before{left:0;}",".f1f351id::before{right:0;}",".fdp32p8::before{top:var(--spacingVerticalXS);}",".f1aij3q::before{width:var(--strokeWidthThicker);}",".f1s2r9ax::before{height:var(--strokeWidthThicker);}",".f1o0nnkk::before{left:var(--spacingHorizontalM);}",".fxb7rol::before{right:var(--spacingHorizontalM);}",".f17jracn::before{bottom:var(--spacingVerticalS);}",".f117lcb2::before{top:var(--spacingVerticalS);}",".fel9d3z::before{bottom:var(--spacingVerticalMNudge);}",".f6vqlre::before{top:var(--spacingVerticalMNudge);}"]}),P=(0,k.X)({base:{Bjyk6c5:"f1rp0jgh",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f3b9emi",Bsft5z2:"f13zj6fq",E3zdtr:"f1mdlcz9"},selected:{Bjyk6c5:"f1ksivud",Bej4dhw:"f1476jrx",B7wqxwa:"f18q216b",f7digc:"fy7ktjt",Bvuzv5k:"f1033yux",k4sdgo:"fkh9b8o"},disabled:{Bjyk6c5:"f13lkzet"},smallHorizontal:{By385i5:"fo72kxq",Dlnsje:"f9bb2ob",Eqx8gd:["f1q70ajw","f18rbzdx"],B1piin3:["f18rbzdx","f1q70ajw"]},smallVertical:{By385i5:"fqbue9b",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"fk1klkt",a2br6o:"f1o25lip"},mediumHorizontal:{By385i5:"fo72kxq",Dlnsje:"f1vx7lu8",Eqx8gd:["fna7m5n","f1oxpfwv"],B1piin3:["f1oxpfwv","fna7m5n"]},mediumVertical:{By385i5:"fipylg0",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"fqchiol",a2br6o:"f1o25lip"},largeHorizontal:{By385i5:"fo72kxq",Dlnsje:"f1vx7lu8",Eqx8gd:["fna7m5n","f1oxpfwv"],B1piin3:["f1oxpfwv","fna7m5n"]},largeVertical:{By385i5:"f1w7dm5g",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"f1p6em4m",a2br6o:"f1o25lip"}},{d:[".f1rp0jgh::after{background-color:var(--colorTransparentStroke);}",[".f3b9emi::after{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f13zj6fq::after{content:"";}',".f1mdlcz9::after{position:absolute;}",".f1ksivud::after{background-color:var(--colorCompoundBrandStroke);}",".f1476jrx:enabled:hover::after{background-color:var(--colorCompoundBrandStrokeHover);}",".f18q216b:enabled:active::after{background-color:var(--colorCompoundBrandStrokePressed);}",".f13lkzet::after{background-color:var(--colorNeutralForegroundDisabled);}",".fo72kxq::after{bottom:0;}",".f9bb2ob::after{height:var(--strokeWidthThick);}",".f1q70ajw::after{left:var(--spacingHorizontalSNudge);}",".f18rbzdx::after{right:var(--spacingHorizontalSNudge);}",".fqbue9b::after{bottom:var(--spacingVerticalXS);}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",".fk1klkt::after{top:var(--spacingVerticalXS);}",".f1o25lip::after{width:var(--strokeWidthThicker);}",".f1vx7lu8::after{height:var(--strokeWidthThicker);}",".fna7m5n::after{left:var(--spacingHorizontalM);}",".f1oxpfwv::after{right:var(--spacingHorizontalM);}",".fipylg0::after{bottom:var(--spacingVerticalS);}",".fqchiol::after{top:var(--spacingVerticalS);}",".f1w7dm5g::after{bottom:var(--spacingVerticalMNudge);}",".f1p6em4m::after{top:var(--spacingVerticalMNudge);}"],m:[["@media (forced-colors: active){.fy7ktjt::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1033yux:enabled:hover::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkh9b8o:enabled:active::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}]]}),N=(0,k.X)({base:{Br312pm:"fwpfdsa",Ijaq50:"f16hsg94",Bt984gj:"f122n59",mc9l5x:"ftuwxu6",Brf1p80:"f4d9j23",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",D0sxk3:"f16u1re",t6yez3:"f8bsbmo"},small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3"},medium:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3"},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun"},selected:{D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"}},{d:[".fwpfdsa{grid-column-start:1;}",".f16hsg94{grid-row-start:1;}",".f122n59{align-items:center;}",".ftuwxu6{display:inline-flex;}",".f4d9j23{justify-content:center;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f16u1re .fui-Icon-filled{display:none;}",".f8bsbmo .fui-Icon-regular{display:inline;}",".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}"]}),F=(0,k.X)({base:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bwptpd"},selected:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"fl43uef",Bg96gwp:"f1i3iumi"},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k"},largeSelected:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},noIconBefore:{Br312pm:"fwpfdsa",Ijaq50:"f16hsg94"},iconBefore:{Br312pm:"fd46tj4",Ijaq50:"f16hsg94"},placeholder:{Bcdw1i0:"fd7fpy0"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],[".f1bwptpd{padding:var(--spacingVerticalNone) var(--spacingHorizontalXXS);}",{p:-1}],".fl43uef{font-weight:var(--fontWeightSemibold);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fwpfdsa{grid-column-start:1;}",".f16hsg94{grid-row-start:1;}",".fd46tj4{grid-column-start:2;}",".fd7fpy0{visibility:hidden;}"]}),O=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{content:o,disabled:n=!1,icon:r,onClick:s,onFocus:a,value:l}=e,c=(0,w.H)((e=>e.appearance)),u=(0,w.H)((e=>e.reserveSelectedTabSpace)),d=(0,w.H)((e=>e.selectTabOnFocus)),g=(0,w.H)((e=>e.disabled)),h=(0,w.H)((e=>e.selectedValue===l)),p=(0,w.H)((e=>e.onRegister)),f=(0,w.H)((e=>e.onUnregister)),S=(0,w.H)((e=>e.onSelect)),C=(0,w.H)((e=>e.size)),k=(0,w.H)((e=>!!e.vertical)),T=g||n,x=i.useRef(null),_=e=>S(e,{value:l}),I=(0,m.D)((0,E.p)(s,_)),B=(0,m.D)((0,E.p)(a,_));i.useEffect((()=>(p({value:l,ref:x}),()=>{f({value:l,ref:x})})),[p,f,x,l]);const R=v.lq(r,{elementType:"span"}),M=v.Gk(o,{defaultProps:{children:e.children},elementType:"span"}),D=o&&"object"==typeof o?(0,A.c)(o,["ref"]):o,P=Boolean((null==R?void 0:R.children)&&!M.children);return{components:{root:"button",icon:"span",content:"span",contentReservedSpace:"span"},root:v.Gk((0,y.g)("button",{ref:(0,b.a)(t,x),role:"tab",type:"button","aria-selected":T?void 0:`${h}`,...e,disabled:T,onClick:I,onFocus:d?B:a}),{elementType:"button"}),icon:R,iconOnly:P,content:M,contentReservedSpace:v.lq(D,{renderByDefault:!h&&!P&&u,defaultProps:{children:e.children},elementType:"span"}),appearance:c,disabled:T,selected:h,size:C,value:l,vertical:k}})(e,t);return(e=>{(e=>{const t=R(),o=D(),i=P(),{appearance:n,disabled:r,selected:s,size:a,vertical:l}=e,c=["fui-Tab",t.root];"subtle-circular"!==n&&"filled-circular"!==n&&c.push(o.base,"small"===a&&(l?o.smallVertical:o.smallHorizontal),"medium"===a&&(l?o.mediumVertical:o.mediumHorizontal),"large"===a&&(l?o.largeVertical:o.largeHorizontal),r&&o.disabled,s&&i.base,s&&!r&&i.selected,s&&"small"===a&&(l?i.smallVertical:i.smallHorizontal),s&&"medium"===a&&(l?i.mediumVertical:i.mediumHorizontal),s&&"large"===a&&(l?i.largeVertical:i.largeHorizontal),s&&r&&i.disabled),e.root.className=(0,T.z)(...c,e.root.className),(0,B.U)(e)})(e),((e,t)=>{const o=R(),i=M(),{appearance:n,disabled:r,selected:s,size:a,vertical:l}=e,c="subtle-circular"===n,u="filled-circular"===n,d=c||u,g=[o.circular,c&&o.subtleCircular,s&&c&&o.subtleCircularSelected,r&&c&&o.subtleCircularDisabled,s&&r&&c&&o.subtleCircularDisabledSelected,u&&o.filledCircular,s&&u&&o.filledCircularSelected,r&&u&&o.filledCircularDisabled,s&&r&&u&&o.filledCircularDisabledSelected];t.className=(0,T.z)(o.button,l?o.vertical:o.horizontal,"small"===a&&(l?o.smallVertical:o.smallHorizontal),"medium"===a&&(l?o.mediumVertical:o.mediumHorizontal),"large"===a&&(l?o.largeVertical:o.largeHorizontal),i.base,!r&&"subtle"===n&&o.subtle,!r&&"transparent"===n&&o.transparent,...d?g:[!r&&s&&o.selected],r&&o.disabled,t.className)})(e,e.root),(e=>{const t=N(),o=F(),{selected:i,size:n}=e;e.icon&&(e.icon.className=(0,T.z)("fui-Tab__icon",t.base,t[n],i&&t.selected,e.icon.className)),e.contentReservedSpace&&(e.contentReservedSpace.className=(0,T.z)("fui-Tab__content--reserved-space",o.base,"large"===n?o.largeSelected:o.selected,e.icon?o.iconBefore:o.noIconBefore,o.placeholder,e.content.className),e.contentReservedSpaceClassName=e.contentReservedSpace.className),e.content.className=(0,T.z)("fui-Tab__content",o.base,"large"===n&&o.large,i&&("large"===n?o.largeSelected:o.selected),e.icon?o.iconBefore:o.noIconBefore,e.content.className)})(e)})(o),(0,_.$e)("useTabStyles_unstable")(o),(e=>((0,C.C)(e),(0,S.FD)(e.root,{children:[e.icon&&(0,S.Y)(e.icon,{}),!e.iconOnly&&(0,S.Y)(e.content,{}),e.contentReservedSpace&&(0,S.Y)(e.contentReservedSpace,{})]})))(o)}));O.displayName="Tab";var j=o(81461),q=o(67719);const L=i.forwardRef(((e,t)=>{const{id:o,groupId:r,priority:s,children:l}=e,c=function(e,t,o){const r=i.useRef(null),s=(0,n.J)((e=>e.registerItem));return(0,a.E)((()=>{if(r.current)return s({element:r.current,id:e,priority:null!=t?t:0,groupId:o})}),[e,t,s,o]),r}(o,s,r),u=(0,j.h)(l);return(0,q.L)(l,{ref:(0,b.a)(c,t,null==u?void 0:u.ref)})}));L.isFluentTriggerComponent=!0;var H=o(60803),z=o(17307);const W=i.forwardRef(((e,t)=>{const o=(0,z.I)(),{children:r,minimumVisible:s,overflowAxis:a="horizontal",overflowDirection:l,padding:c}=e,[u,d]=i.useState({hasOverflow:!1,itemVisibility:{},groupVisibility:{}}),{containerRef:g,registerItem:h,updateOverflow:p,registerOverflowMenu:f,registerDivider:m}=(0,H.f)((e=>{const{visibleItems:t,invisibleItems:o,groupVisibility:i}=e,n={};t.forEach((e=>{n[e.id]=!0})),o.forEach((e=>n[e.id]=!1)),d((()=>({hasOverflow:e.invisibleItems.length>0,itemVisibility:n,groupVisibility:i})))}),{overflowDirection:l,overflowAxis:a,padding:c,minimumVisible:s,onUpdateItemVisibility:H.K}),v=(0,j.h)(r),y=(0,q.L)(r,{ref:(0,b.a)(g,t,null==v?void 0:v.ref),className:(0,T.z)("fui-Overflow",o.overflowMenu,o.overflowingItems,r.props.className)});return i.createElement(n.a.Provider,{value:{itemVisibility:u.itemVisibility,groupVisibility:u.groupVisibility,hasOverflow:u.hasOverflow,registerItem:h,updateOverflow:p,registerOverflowMenu:f,registerDivider:m}},y)}));var G=o(36865);const U=e=>{const{onItemClick:t,disabled:o,label:s,tabKey:a,theme:l}=e,c=(u=a,!!(0,n.J)((e=>e.itemVisibility[u])));var u;const d=i.useCallback((()=>{null==t||t(a)}),[t,a]);return c?null:i.createElement(r.D,{onFocus:e=>{l&&(e.currentTarget.style.backgroundColor=l.overflowItem.hover)},onBlur:e=>{l&&(e.currentTarget.style.backgroundColor=l.overflowItem.resting)},onClick:d,disabled:o},s)},V=({appearance:e,size:t,items:o,onTabSelect:r,theme:p})=>{const{ref:f,isOverflowing:m}=function(e){const t=(0,s.Bi)("overflow-menu",void 0),o=(0,l.D)(),r=(0,n.J)((e=>e.registerOverflowMenu)),c=(0,n.J)((e=>e.updateOverflow)),u=i.useRef(null),d=o>0;return(0,a.E)((()=>{if(u.current)return r(u.current)}),[r,d,t]),(0,a.E)((()=>{d&&c()}),[d,c,u]),{ref:u,overflowCount:o,isOverflowing:d}}();return m?i.createElement(c.W,null,i.createElement(u.c,null,i.createElement(d.$,{appearance:e,icon:i.createElement(G.In,{type:"Overflow"}),ref:f,role:"tab",size:t})),i.createElement(g.b,{style:{backgroundColor:null==p?void 0:p.overflowItem.resting}},i.createElement(h.c,null,o.map((e=>i.createElement(U,Object.assign({theme:p,key:e.tabKey,onItemClick:r},e))))))):null},$=i.forwardRef(((e,t)=>{const{items:o,overflow:n=!0,onTabSelect:r,defaultSelectedKey:s,selectedKey:a,ref:l}=e,c=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["items","overflow","onTabSelect","defaultSelectedKey","selectedKey","ref"]),[u,d]=i.useState(null!=s?s:o[0].tabKey),g=null!=a?a:u,h=i.useCallback((e=>{null==r||r(e),a||d(e)}),[r,d]),p=i.useCallback(((e,t)=>{"string"==typeof t.value&&h(t.value)}),[h]),f=i.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.currentTarget.click())}),[]),m=i.useMemo((()=>{const e={};return o.forEach((t=>{e[t.tabKey]=i.createRef()})),e}),[o]);i.useImperativeHandle(t,(()=>({focus:()=>{var e,t;null===(t=null===(e=m[g])||void 0===e?void 0:e.current)||void 0===t||t.focus()}})));const v=i.useMemo((()=>{var e,t;return Object.assign(Object.assign({},c),{appearance:null!==(e=c.appearance)&&void 0!==e?e:"transparent",onTabSelect:p,size:null!==(t=c.size)&&void 0!==t?t:"medium",selectedValue:g,defaultSelectedValue:s,theme:c.theme})}),[c,p]),y={items:o,appearance:v.appearance,size:v.size,onTabSelect:h,theme:v.theme};let b=i.createElement(I,Object.assign({},v,{style:{width:"100%"}}),o.map((e=>{const{tabKey:t,label:o,disabled:r,overflowPriority:s=0}=e;let a=i.createElement(O,{value:t,disabled:r,key:t,ref:m[t],onKeyDown:f},o);return n&&(a=i.createElement(L,{priority:s,key:t,id:t,ref:m[t]},a)),a})),n&&i.createElement(V,Object.assign({},y)));return n&&(b=i.createElement(W,{minimumVisible:1},b)),b}));$.displayName="TabList"},17321:(e,t,o)=>{"use strict";if(o.d(t,{S:()=>s,v:()=>r}),3023==o.j)var i=o(74505);if(3023==o.j)var n=o(27326);var r;function s(e,t,o){const i=o?o.filter((e=>!!e)).sort(((e,t)=>e.start-t.start)):[],n=[];for(let o=0;o<i.length;o+=1){if(e<i[o].start+i[o].length)continue;const s=0===o?0:i[o-1].start+i[o-1].length;s<i[o].start&&a(n,s,i[o].start-s,r.None,t),a(n,i[o].start,i[o].length,i[o].decorationType,t);const l=i[o].start+i[o].length;o===i.length-1&&l<e&&a(n,l,e-l,r.None,t)}return 0===n.length&&a(n,0,e,r.None,t),n}function a(e,t,o,s,a){var l,c;const u={start:t,length:o};switch(s){case r.Spelling:u.emphasizedColor=a.errorText,u.underlineType=n.RV.SpellingSquiggle;break;case r.Grammar:u.emphasizedColor=a.errorText,u.underlineType=n.RV.GrammarSquiggle;break;case r.Refinement:u.emphasizedColor=a.errorText,u.underlineType=n.RV.CritiqueSquiggle;break;case r.Rewrite:case r.SimilarityChecker:u.fontWeight=n.IT.Bold,u.cssColor=null===(l=a.rewriteText)||void 0===l?void 0:l.resting,u.cssColorHover=null===(c=a.rewriteText)||void 0===c?void 0:c.hover;break;case r.Modification:u.highlightColor=a.correctionHighlight,u.highlightRadius=2,u.fontWeight=n.IT.SemiBold;break;case r.PremiumEmphasis:u.cssColor=a.premiumEmphasis,u.fontFamily=i.m;break;case r.TrackChangeContent:u.italic=!0;break;case r.TrackChangePlaceholder:u.cssColor=a.trackChangePlaceholderText;break;case r.CatchUp:u.cssColor=a.catchUpDescriptorText,u.fontWeight=n.IT.SemiBold}e.push(u)}!function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.AccColorChecker=6]="AccColorChecker",e[e.Modification=7]="Modification",e[e.PremiumEmphasis=8]="PremiumEmphasis",e[e.TrackChangeContent=9]="TrackChangeContent",e[e.TrackChangePlaceholder=10]="TrackChangePlaceholder",e[e.CatchUp=11]="CatchUp"}(r||(r={}))},19974:(e,t,o)=>{"use strict";o.d(t,{i:()=>i});const i=()=>!1},174:(e,t,o)=>{"use strict";o.d(t,{c:()=>n});var i=o(95734);const n=e=>{i.useEffect((()=>(window.addEventListener("mousemove",e,{capture:!0,passive:!0}),()=>window.removeEventListener("mousemove",e,{capture:!0}))),[])}},44142:(e,t,o)=>{"use strict";o.d(t,{S:()=>l});var i=o(95734),n=o(92482),r=o(90866),s=o(53203),a=o(18470);class l extends i.PureComponent{constructor(){super(...arguments),this.divRef=i.createRef()}render(){return i.createElement(a.q.Consumer,null,(e=>i.createElement("div",Object.assign({},this.getRootDivAttributes(e),{ref:this.divRef}),this.props.children)))}focus(e){var t,o,i;e&&(null===(o=null===(t=this.divRef.current)||void 0===t?void 0:t.children[e])||void 0===o||o.focus()),null===(i=this.divRef.current)||void 0===i||i.focus()}el(){return this.divRef.current}getChildItem(e,t=0){const o=this.el(),i=null==o?void 0:o.querySelectorAll(e);return(null==i?void 0:i.length)&&(null==i?void 0:i.length)>=t+1?i[t]:null}getRootDivAttributes(e){const t={style:this.computeStyles(this.props.style,e)};return n.tO(this.props,t),this.props.accessible?(t["aria-hidden"]=!1,t["aria-label"]=this.props.accessibilityLabel,t.role=this.getAccessibilityRole()):!1===this.props.accessible&&(t["aria-hidden"]=!0),this.props.focusable&&(t.tabIndex=0),void 0!==this.props.accessibleLive&&(t["aria-live"]=this.getAriaLive()),t.id=this.props.nativeID,t}computeStyles(e,t){const o={display:"flex",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0};switch(this.props.direction===r.PR.LeftToRight?o.flexDirection="row":o.flexDirection="column",this.props.align){case r.j5.Stretch:o.alignItems="stretch";break;case r.j5.Center:o.alignItems="center";break;case r.j5.Baseline:o.alignItems="baseline";break;default:o.alignItems="flex-start"}switch(this.props.justifyContent){case r.Pr.Center:o.justifyContent="center";break;case r.Pr.End:o.justifyContent="flex-end";break;case r.Pr.SpaceBetween:o.justifyContent="space-between";break;default:o.justifyContent="flex-start"}if(e){switch(e.flexibleSize&&(o.flexGrow=1,o.flexShrink=1),void 0!==e.paddingStart&&(o.paddingLeft=t?e.paddingEnd:e.paddingStart),void 0!==e.paddingEnd&&(o.paddingRight=t?e.paddingStart:e.paddingEnd),void 0!==e.paddingHorizontal&&(o.paddingRight=e.paddingHorizontal,o.paddingLeft=e.paddingHorizontal),void 0!==e.paddingTop&&(o.paddingTop=e.paddingTop),void 0!==e.paddingBottom&&(o.paddingBottom=e.paddingBottom),void 0!==e.paddingVertical&&(o.paddingTop=o.paddingTop||0+e.paddingVertical,o.paddingBottom=o.paddingBottom||0+e.paddingVertical),void 0!==e.marginTop&&(o.marginTop=e.marginTop),void 0!==e.marginBottom&&(o.marginBottom=e.marginBottom),void 0!==e.marginVertical&&(o.marginTop=(e.marginTop||0)+e.marginVertical,o.marginBottom=(e.marginBottom||0)+e.marginVertical),t?(void 0!==e.marginStart&&(o.marginRight=e.marginStart),void 0!==e.marginEnd&&(o.marginLeft=e.marginEnd)):(void 0!==e.marginStart&&(o.marginLeft=e.marginStart),void 0!==e.marginEnd&&(o.marginRight=e.marginEnd)),void 0!==e.marginHorizontal&&(o.marginLeft=(t?e.marginEnd||0:e.marginStart||0)+e.marginHorizontal,o.marginRight=(t?e.marginStart||0:e.marginEnd||0)+e.marginHorizontal),void 0!==e.gap&&(o.gap=e.gap),void 0!==e.maxWidth&&(o.maxWidth=e.maxWidth),void 0!==e.minWidth&&(o.minWidth=e.minWidth),void 0!==e.width&&(o.width=e.width),void 0!==e.minHeight&&(o.minHeight=e.minHeight),void 0!==e.maxHeight&&(o.maxHeight=e.maxHeight),void 0!==e.height&&(o.height=e.height),e.backgroundColor&&(o.backgroundColor=e.backgroundColor),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),void 0!==e.borderColor&&(o.borderColor=e.borderColor),void 0!==e.borderStyle&&(o.borderStyle=e.borderStyle),typeof e.borderWidth){case"number":o.borderWidth=e.borderWidth;break;case"object":o.borderTopWidth=e.borderWidth.top,o.borderRightWidth=t?e.borderWidth.start:e.borderWidth.end,o.borderBottomWidth=e.borderWidth.bottom,o.borderLeftWidth=t?e.borderWidth.end:e.borderWidth.start}switch(typeof e.borderRadius){case"number":o.borderRadius=(0,s.W)(e);break;case"object":const i=(0,s.W)(e,"topStart",0),n=(0,s.W)(e,"topEnd",0),r=(0,s.W)(e,"bottomStart",0),a=(0,s.W)(e,"bottomEnd",0);o.borderTopLeftRadius=t?n:i,o.borderTopRightRadius=t?i:n,o.borderBottomRightRadius=t?r:a,o.borderBottomLeftRadius=t?a:r}e.hideFocusBox&&(o.outline="none"),e.transform&&(o.transform=e.transform),void 0!==e.zIndex&&(o.zIndex=e.zIndex),e.position&&(o.position=e.position),(e.top||0===e.top)&&(o.top=e.top),(e.bottom||0===e.bottom)&&(o.bottom=e.bottom),(e.right||0===e.right)&&(o.right=e.right),(e.left||0===e.left)&&(o.left=e.left),e.overflow&&(o.overflow=e.overflow),e.boxShadow&&(o.boxShadow=e.boxShadow)}return o}getAccessibilityRole(){switch(this.props.accessibilityRole){case"list":case"listbox":case"menu":case"tablist":case"application":return this.props.accessibilityRole;default:return"group"}}getAriaLive(){return this.props.accessibleLive===r.pq.Polite?"polite":void 0}}},90866:(e,t,o)=>{"use strict";var i,n,r,s;o.d(t,{PR:()=>i,Pr:()=>r,j5:()=>n,pq:()=>s}),function(e){e[e.TopToBottom=0]="TopToBottom",e[e.LeftToRight=1]="LeftToRight"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Stretch=1]="Stretch",e[e.Baseline=2]="Baseline",e[e.Center=3]="Center"}(n||(n={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.SpaceBetween=2]="SpaceBetween",e[e.End=3]="End"}(r||(r={})),function(e){e[e.Polite=0]="Polite",e[e.Off=1]="Off"}(s||(s={}))},84096:(e,t,o)=>{"use strict";var i,n;o.d(t,{R:()=>n}),function(e){e[e.bottomCenter=5]="bottomCenter",e[e.rightCenter=12]="rightCenter"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center"}(n||(n={}))},72906:(e,t,o)=>{"use strict";if(o.d(t,{AF:()=>s,AW:()=>f,Cl:()=>g,DF:()=>n,Q6:()=>r,XI:()=>m,Xo:()=>c,dV:()=>d,em:()=>a,f6:()=>p,ot:()=>l,qr:()=>h,rf:()=>u}),3023==o.j)var i=o(84096);const n=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingStart)&&void 0!==o?o:0)},r=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingEnd)&&void 0!==o?o:0)},s=e=>{var t;return null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8},a=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingBottom)&&void 0!==o?o:0)},l=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginStart)&&void 0!==o?o:0)},c=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginEnd)&&void 0!==o?o:0)},u=e=>{var t;return null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0},d=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginBottom)&&void 0!==o?o:0)},g=(e,t)=>{var o,i;return void 0===t?void 0===(null==e?void 0:e.borderThickness)||"number"==typeof(null==e?void 0:e.borderThickness)?null!==(o=null==e?void 0:e.borderThickness)&&void 0!==o?o:1:void 0:"object"==typeof(null==e?void 0:e.borderThickness)?null!==(i=e.borderThickness[t])&&void 0!==i?i:0:void 0},h=e=>e.hidden?0:1,p=e=>{var t;return(null===(t=e.style)||void 0===t?void 0:t.flexibleSize)?1:void 0},f=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"start",m=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"flex-start"},15575:(e,t,o)=>{"use strict";if(o.d(t,{EF:()=>c,O4:()=>g,SL:()=>a,gZ:()=>l,hM:()=>u,uk:()=>d}),3023==o.j)var i=o(51869);const n={background:{resting:"#FFFFFF",hover:"#D2D2D2",pressed:"#B1B1B1"},title:{resting:"#262626",disabled:"#666666"},tag:{resting:"#605e5c",disabled:"#666666"},subtitle:{resting:"#666666",disabled:"#666666"},focusRing:"#969696"},r={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},tag:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},subtitle:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},s={background:{resting:"var(--colorBrandBackground)",hover:"var(--colorBrandBackgroundHover)",pressed:"var(--colorBrandBackgroundPressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForegroundOnBrand)"},tag:{resting:"var(--colorNeutralForegroundOnBrand)"},subtitle:{resting:"var(--colorNeutralForegroundOnBrand)"},icon:{resting:"var(--colorNeutralForegroundOnBrand)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},a=(e,t,o,n,r,s,a,l)=>{const c={};r?a.background.disabled&&(c.backgroundColor=a.background.disabled,s&&a.border&&(c.borderColor=a.border)):(t&&((null==l?void 0:l.useFluentV9)&&(0,i.I)()?(c.backgroundColor="Canvas",c.borderColor="Highlight"):(a.background.hover&&(c.backgroundColor=a.background.hover),a.focusRing&&o&&(c.borderColor=a.focusRing))),n&&(a.background.focused&&(c.backgroundColor=a.background.focused),a.focusRing&&(c.borderColor=a.focusRing)),e&&a.background.pressed&&(c.backgroundColor=a.background.pressed),a.border&&!c.borderColor&&(c.borderColor=a.border));const u=c.backgroundColor||((null==l?void 0:l.useFluentV9)&&(0,i.I)()?"Canvas":a.background.resting);return{backgroundColor:u,borderColor:c.borderColor||u}},l=(e,t,o,i,n)=>{let r=n.resting;return o?n.disabled&&(r=n.disabled):(t&&n.hover&&(r=n.hover),i&&n.focused&&(r=n.focused),e&&n.pressed&&(r=n.pressed)),r},c=(e,t,o)=>e.map((e=>{var i;let n=null!==(i=e.cssColor)&&void 0!==i?i:t;return o&&e.cssColorHover&&(n=e.cssColorHover),Object.assign(Object.assign({},e),{cssColor:n})})).filter((e=>!!e)),u=(e,t)=>e&&e.cssColor?e:e&&t?Object.assign(Object.assign({},e),{cssColor:t}):t?{cssColor:t}:e,d=(e,t)=>{const o=!(!e.showUnderline||!e.topPanelScopeButton);return t||!!e.hasKeyboardFocus||o},g=(e,t)=>e.theme?e.theme:(null==t?void 0:t.useFluentV9)?"primary"===e.appearance?s:r:n},68462:(e,t,o)=>{"use strict";o.d(t,{c:()=>l});var i=o(95734),n=o(4336);class r extends i.PureComponent{constructor(e){super(e),this.state={focused:!1},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this)}getRunText(e,t){const o=this.props.text.length,i=Math.max(0,Math.min(o,e)),n=Math.max(0,Math.min(o,t));return i<n?this.props.text.substr(i,n-i):""}renderTextRuns(){const e=[];if(this.props.formatting&&this.props.formatting.length>0){let t=0,o=0;const i=this.props.text.length;for(;t<i;)if(o<this.props.formatting.length){const n=this.props.formatting[o],r=n.start,s=r+n.length,a=Math.max(t,Math.min(i,r)),l=Math.max(t,Math.min(i,s));if(a>=l){o+=1;continue}t<a&&(e.push(this.renderTextRun(t,a)),t=a),t<l&&(e.push(this.renderTextRun(t,l,n)),t=l),o+=1}else t<i&&(e.push(this.renderTextRun(t,i)),t=i)}return e}onFocus(){this.setState({focused:!0})}onBlur(){this.setState({focused:!1})}computeTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:r.defaultTheme}computeBorderColor(){const e=this.computeTheme();return this.state.focused?e.focusRing:e.border}computePadding(e){var t,o,i,n,r,s;const a=null!==(t=this.props.style)&&void 0!==t?t:{},l=null!==(i=null===(o=this.props.style)||void 0===o?void 0:o.padding)&&void 0!==i?i:this.props.focusable?1:0,c=(null!==(n=a[e])&&void 0!==n?n:0)+l,u=null!==(s=null===(r=this.props.style)||void 0===r?void 0:r.borderWidth)&&void 0!==s?s:this.props.focusable?1:0;return void 0!==this.computeBorderColor()?c:c+u}computeMargin(e){var t,o,i;const n=null!==(t=this.props.style)&&void 0!==t?t:{};return(null!==(o=n[e])&&void 0!==o?o:0)+(null!==(i=n["marginStart"===e||"marginEnd"===e?"marginHorizontal":"marginVertical"])&&void 0!==i?i:0)}computeBorderWidth(){var e,t;const o=null!==(t=null===(e=this.props.style)||void 0===e?void 0:e.borderWidth)&&void 0!==t?t:this.props.focusable?1:0;return void 0!==this.computeBorderColor()?o:0}getAccessibilityLabel(){return this.props.accessibilityHidden?void 0:this.props.accessibilityLabel?this.props.accessibilityLabel:this.props.text}}r.defaultTheme={focusRing:"#000000"},r.baseFontWeightValuesByType={[n.IT.Bold]:"bold",[n.IT.Normal]:"normal"};var s=o(43753),a=o(18470);class l extends r{constructor(){super(...arguments),this.spanRef=i.createRef()}render(){const e={},t=this.renderTextRuns();if(this.props.focusable&&(e.tabIndex=0,e.onFocus=this.onFocus,e.onBlur=this.onBlur),this.props.onHeightChange&&this.spanRef.current){const e=this.spanRef.current.getBoundingClientRect().height,t=this.computeMargin("marginTop"),o=this.computeMargin("marginBottom");this.props.onHeightChange(e+o+t)}return i.createElement(a.q.Consumer,null,(o=>i.createElement("span",Object.assign({},e,{ref:this.spanRef,style:this.renderRootFormatting(this.props.style,o,t.length>0),"aria-hidden":this.props.accessibilityHidden,"aria-posinset":this.props.accessibilityPositionInSet,"aria-setsize":this.props.accessibilitySetSize,"aria-label":0===t.length?this.getAccessibilityLabel():void 0,"aria-level":this.props.accessibilityHidden||"heading"!==this.props.accessibilityRole?void 0:1,role:this.props.accessibilityHidden?void 0:this.getAccessibilityRole(),"data-automation-id":this.props.accessibilityHidden?void 0:this.props.automationLabel}),0!==t.length?t:this.props.text)))}focus(){this.props.focusable&&this.spanRef.current&&this.spanRef.current.focus()}renderTextRun(e,t,o){return(null==o?void 0:o.hyperlink)?i.createElement(s.R,Object.assign({},o.hyperlink)):i.createElement("span",{key:e,style:this.renderFormatting(o)},this.getRunText(e,t))}computeTheme(){const e=super.computeTheme();return delete e.focusRing,e}renderBold(e,t){e.fontWeight=l.fontWeightValueByType[t]}renderUnderline(e,t){let o=!1;switch(t){case n.RV.Single:e.textDecorationLine="underline",e.textDecorationSkipInk="none";break;case n.RV.Double:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmRvdWJsZV9saW5lPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImRvdWJsZV9saW5lIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIGlkPSJUaWxlLUNvcHkiIHN0cm9rZT0iIzAwMDAwMCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",o=!0;break;case n.RV.SpellingSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjRweCIgdmlld0JveD0iMCAwIDUgNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTYuMiAoODE2NzIpIC0gaHR0cHM6Ly9za2V0Y2guY29tIC0tPgogICAgPHRpdGxlPnNwZWxsaW5nX3NxdWlnZ2xlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkZsYWdzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTAxMC4wMDAwMDAsIC0yOTYuMDAwMDAwKSIgaWQ9InNwZWxsaW5nX3NxdWlnZ2xlIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAxMC4wMDAwMDAsIDI5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDMgQzEuMjUsMyAxLjI1LDEgMi41LDEgQzMuNzUsMSAzLjc1LDMgNSwzIiBpZD0iUGF0aCIgc3Ryb2tlPSIjRUIwMDAwIiBzdHJva2Utd2lkdGg9IjEiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",o=!0;break;case n.RV.GrammarSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmdyYW1tYXJfZG91YmxlX2xpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZ3JhbW1hcl9kb3VibGVfbGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iR3JhbW1hci1UaWxlLUNvcHkiIHN0cm9rZT0iIzMzNTVGRiI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",o=!0;break;case n.RV.CritiqueSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIycHgiIHZpZXdCb3g9IjAgMCAxMCAyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Ny4xICg4MzA4OCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+aW5zaWdodF90ZXh0dXJlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imluc2lnaHRfdGV4dHVyZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTItQ29weSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIyIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDEgTDUsMSIgaWQ9IkxpbmUtNCIgc3Ryb2tlPSIjNzE2MEU4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",o=!0}o&&(e.backgroundRepeat="repeat-x",e.backgroundPosition="bottom left",e.borderBottom="solid 1px transparent")}renderFormatting(e){const t={};return(null==e?void 0:e.fontWeight)&&this.renderBold(t,e.fontWeight),t.fontFamily=null==e?void 0:e.fontFamily,t.fontSize=null==e?void 0:e.fontSize,t.fontStyle=(null==e?void 0:e.italic)?"italic":void 0,t.color=null==e?void 0:e.cssColor,(null==e?void 0:e.underlineType)&&this.renderUnderline(t,e.underlineType),(null==e?void 0:e.lineHeight)&&(t.lineHeight=e.lineHeight+"px"),(null==e?void 0:e.wrapMode)===n.bd.NoWrap?t.whiteSpace="nowrap":(t.whiteSpace="normal",t.overflowWrap="anywhere"),(null==e?void 0:e.highlightColor)&&(t.background=null==e?void 0:e.highlightColor,(null==e?void 0:e.highlightRadius)&&(t.borderRadius=e.highlightRadius+"px")),t.paddingLeft=null==e?void 0:e.paddingHorizontal,t.paddingRight=null==e?void 0:e.paddingHorizontal,t.marginLeft=null==e?void 0:e.marginHorizontal,t.marginRight=null==e?void 0:e.marginHorizontal,t}renderRootFormatting(e,t,o){var i;const n=this.computeTheme(),r=this.renderFormatting(e),s=this.computeMargin("marginStart"),a=this.computeMargin("marginEnd");return r.backgroundColor=n.background,r.paddingLeft=this.computePadding("paddingHorizontal"),r.paddingRight=this.computePadding("paddingHorizontal"),r.paddingTop=this.computePadding("paddingVertical"),r.paddingBottom=this.computePadding("paddingVertical"),r.marginLeft=t?a:s,r.marginRight=t?s:a,r.marginTop=this.computeMargin("marginTop"),r.marginBottom=this.computeMargin("marginBottom"),r.borderWidth=this.computeBorderWidth(),r.borderColor=this.computeBorderColor(),r.borderRadius=null===(i=this.props.style)||void 0===i?void 0:i.borderRadius,r.borderStyle="solid",r.width=null==e?void 0:e.width,r.height=null==e?void 0:e.height,r.textAlign=null==e?void 0:e.textAlign,void 0!==(null==e?void 0:e.userSelectable)&&(r.userSelect=e.userSelectable?"auto":"none"),(null==e?void 0:e.truncate)&&(r.overflow="hidden",r.textOverflow="ellipsis",r.whiteSpace="nowrap",o&&(r.display="-webkit-box",r.WebkitLineClamp=1,r["-webkit-box-orient"]="vertical")),r}getAccessibilityRole(){return"heading"===this.props.accessibilityRole?this.props.accessibilityRole:"text"}}l.fontWeightValueByType=Object.assign(Object.assign({},r.baseFontWeightValuesByType),{[n.IT.SemiBold]:600})},4336:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{IT:()=>i,RV:()=>n,bd:()=>r}),function(e){e[e.Normal=0]="Normal",e[e.Bold=1]="Bold",e[e.SemiBold=2]="SemiBold"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SpellingSquiggle=3]="SpellingSquiggle",e[e.GrammarSquiggle=4]="GrammarSquiggle",e[e.CritiqueSquiggle=5]="CritiqueSquiggle"}(n||(n={})),function(e){e[e.Normal=0]="Normal",e[e.NoWrap=1]="NoWrap"}(r||(r={}))},51869:(e,t,o)=>{"use strict";function i(){return window.matchMedia("@media screen and (-ms-high-contrast: active), (forced-colors: active)").matches}o.d(t,{I:()=>i})},43753:(e,t,o)=>{"use strict";o.d(t,{R:()=>c});var i=o(95734),n=o(92858),r=o(68462),s=o(4336);class a extends i.PureComponent{constructor(e){super(e),this.state={isFocused:!1,isHovered:!1,isPressed:!1},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onHoverIn=this.onHoverIn.bind(this),this.onHoverOut=this.onHoverOut.bind(this),this.onPressIn=this.onPressIn.bind(this),this.onPressOut=this.onPressOut.bind(this)}computeTextColor(){const e=this.props.theme;return this.state.isPressed&&(null==e?void 0:e.pressedColor)?null==e?void 0:e.pressedColor:this.state.isHovered&&(null==e?void 0:e.hoverColor)?null==e?void 0:e.hoverColor:this.state.isFocused&&(null==e?void 0:e.focusColor)?null==e?void 0:e.focusColor:null==e?void 0:e.color}computeTextStyling(){var e;const t=this.props.style;return{fontSize:t.fontSize,fontWeight:t.fontWeight,cssColor:this.computeTextColor(),underlineType:null!==(e=this.props.style.underlineType)&&void 0!==e?e:s.RV.Single}}renderContents(){return this.props.text?i.createElement(r.c,{text:this.props.text,style:this.props.theme||this.props.style?this.computeTextStyling():void 0}):void 0}onFocus(){this.setState({isFocused:!0})}onBlur(){this.setState({isFocused:!1})}onHoverIn(){this.setState({isHovered:!0})}onHoverOut(){this.setState({isHovered:!1})}onPressIn(){this.setState({isPressed:!0})}onPressOut(){this.setState({isPressed:!1})}}var l=o(80896);class c extends a{constructor(e){super(e)}render(){const{inline:e,url:t,text:o,onClick:s}=this.props;return this.context?i.createElement("div",{style:{display:e?"inline-flex":"block"}},i.createElement(n.N,{target:"_blank",href:t,style:{boxShadow:"none"},onClick:s},o?i.createElement(r.c,{text:o,style:Object.assign(Object.assign({},this.computeTextStyling()),{cssColor:void 0})}):void 0)):i.createElement("div",{style:{display:e?"inline-flex":"block"}},i.createElement(n.N,{target:"_blank",href:t,style:this.getStyle(),onMouseEnter:this.onHoverIn,onMouseLeave:this.onHoverOut,onPointerDown:this.onPressIn,onPointerUp:this.onPressOut,onFocus:this.onFocus,onBlur:this.onBlur},this.renderContents()))}getStyle(){return{color:this.computeTextColor(),boxShadow:"none"}}}c.contextType=l.O},61115:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>n,w:()=>r}),3023==o.j)var i=o(58546);const n=(e,t)=>void 0!==r(e,t),r=(e,t)=>{const o=`${e}Filled`;return t&&(0,i.sW)(o)?o:(0,i.sW)(e)?e:void 0}},92342:(e,t,o)=>{"use strict";o.d(t,{X:()=>i});const i={}},8061:(e,t,o)=>{"use strict";if(o.d(t,{Vm:()=>c,j2:()=>a,ku:()=>l}),3023==o.j)var i=o(68462);if(3023==o.j)var n=o(22405);if(3023==o.j)var r=o(92342);const s=3023==o.j?["Accept","Accessibility","AddBot","AddPeople","AddToDictionary","Apps","ArrowReset","ArrowUpload","BowTie","Cancel","ChatBubblesQuestion","Checkmark","Cloud","Color","Completed","Copy","Delete","Dislike","DropdownChevron","ECCFeedback","EditorSettings","Emails","ErrorBadge","Event","EventRecorded","EventSeries","FFXCBulletedList","FFXCCallout","FFXCChecklist","FFXCCodeBlock","FFXCCompleted","FFXCInsertTextBox","FFXCKanbanBoard","FFXCNumberedList","FFXQuestionAnswer","FFXCQuote","FFXCRetroBoard","FFXCStatusTracker","FFXCTable","FFXCVote","Files","FirstRowAsHeader","Hide","GiveFeedback","Hashtag","Ignore","IgnoreAll","IgnoreRule","Info","Laptop","Location","Like","Link","Meeting","Member","MergeCells","Next","Overflow","People","Person","PhoneNumber","Plus","PremiumDiamond","Previous","ReadAloud","Record","Repeat","ShowExplanation","Sparkle","SplitCells","TeamsChat","Undo","Upload"]:null,a=e=>s.some((t=>t===e)),l=e=>void 0!==r.X[e],c=e=>{const{primaryColor:t,fontWeight:o,style:r,fontSize:s}=e;return{primaryFill:t,color:t,"aria-hidden":"true",fontSize:null!=s?s:n.Q.fontSize,style:Object.assign({fontSize:null!=s?s:n.Q.fontSize,margin:null==r?void 0:r.margin},r),fontWeight:o?i.c.fontWeightValueByType[o]:n.Q.fontWeight}}},22405:(e,t,o)=>{"use strict";o.d(t,{Q:()=>v,In:()=>y});var i=o(95734),n=o(80896),r=o(99509),s=o(61115),a=o(59197);function l(e){return i.createElement(a.l8,{iconName:(0,s.w)(e.type,e.filled),style:(0,r.MD)(e),"aria-hidden":!0})}var c=o(8061),u=o(87579);function d(e){return i.createElement(u.iNx,Object.assign({},(0,c.Vm)(Object.assign(Object.assign({},e),{primaryColor:"transparent"}))))}var g=o(92342),h=o(18470);function p(e){var t,o;const n=i.useContext(h.q),r=e.type,s=g.X[r];let a;return n&&(a=e.filled&&null!==(t=s.rtlFilled)&&void 0!==t?t:s.rtlRegular),void 0===a&&(a=e.filled&&null!==(o=s.filled)&&void 0!==o?o:s.regular),i.createElement(a,Object.assign({},(0,c.Vm)(e),{pointerEvents:"none"}))}const f=i.lazy((()=>Promise.all([o.e(1804),o.e(1519)]).then(o.bind(o,20204)))),m=i.lazy((()=>Promise.all([o.e(1804),o.e(490)]).then(o.bind(o,91544)))),v={fontSize:20,fontWeight:400};class y extends i.Component{static shouldRender(e,t){return this.shouldRenderTypeName(e.type,e.filled,t)}static shouldRenderTypeName(e,t,o){return!!((0,c.j2)(e)||(0,c.ku)(e)||(0,r.tv)(e))||!(null==o?void 0:o.useFluentV9)&&(0,s.q)(e,t)}render(){const e=!!this.context;return y.shouldRender(this.props,{useFluentV9:e})?i.createElement(b,Object.assign({},this.props)):null}}y.contextType=n.O;const b=e=>{const t=i.useContext(n.O);return(0,c.j2)(e.type)?i.createElement(i.Suspense,{fallback:i.createElement(d,Object.assign({},e))},i.createElement(f,Object.assign({},e))):(0,c.ku)(e.type)?i.createElement(p,Object.assign({},e)):(0,r.tv)(e.type)?i.createElement(i.Suspense,{fallback:i.createElement(d,Object.assign({},e))},i.createElement(m,Object.assign({},e))):t?null:(0,s.q)(e.type,e.filled)?i.createElement(l,Object.assign({},e)):null}},99509:(e,t,o)=>{"use strict";if(o.d(t,{MD:()=>a,tv:()=>s}),3023==o.j)var i=o(22405);if(3023==o.j)var n=o(68462);const r=3023==o.j?["AllItems","ClipboardList","ColorfulCopilot","Dot","Editor","EditorSingleColor","EditorWithStars","EditorWithStarsAnimated","EditorWithStarsDarkMode","EditorWithStarsDarkModeAnimated","Excel","ForwardSlashPromo","ExploreMoreCopilot","LineCopilot","LocalLanguage","LocaleLanguage","Loop","OneDrive","OneNoteNotebook","NewFeature","Pdf","PowerPoint","QuickSync","SignUpSheet","UnknownFile","Visio","Word"]:null,s=e=>r.some((t=>t===e)),a=e=>{const{primaryColor:t,fontSize:o,fontWeight:r,style:s}=e;return Object.assign({color:t,fontSize:null!=o?o:i.Q.fontSize,width:null!=o?o:i.Q.fontSize,height:null!=o?o:i.Q.fontSize,fontWeight:r?n.c.fontWeightValueByType[r]:i.Q.fontWeight,display:"flex",alignItems:"center",justifyContent:"center"},s)}},28998:(e,t,o)=>{"use strict";o.d(t,{c:()=>a});var i=o(95734);if(3023==o.j)var n=o(84458);if(3023==o.j)var r=o(44142);if(3023==o.j)var s=o(28486);const a=e=>{var t,o,a,c,u,d,g,h,p;const[f,m]=i.useState(!1),v=i.useRef(void 0),y=i.useRef(void 0);v.current===e.imageUrl||f||m(!0),i.useEffect((()=>(f&&!y.current&&(y.current=setTimeout((()=>{y.current=void 0,v.current=e.imageUrl,m(!1)}),e.animationTimeMs?e.animationTimeMs+200:1e3)),()=>clearTimeout(y.current))),[f,y.current]);const b=Object.assign({left:0,top:0,position:"absolute","--animation-time":`${null!==(t=e.animationTimeMs)&&void 0!==t?t:800}ms`},e.borderColor?{border:`2px solid ${e.borderColor}`,borderRadius:"50%"}:{}),S={animation:"none !important"},C=l(e.coinSize);return i.createElement(r.S,{style:{position:"relative",width:null!==(o=e.size)&&void 0!==o?o:C,height:null!==(a=e.size)&&void 0!==a?a:C}},f&&i.createElement(n.e,Object.assign({},e,{image:{src:v.current,style:S},className:s.SD,style:Object.assign({},b),initials:null!==(c=e.initials)&&void 0!==c?c:e.imageInitials,name:e.text,color:null!==(u=e.color)&&void 0!==u?u:"brand",size:null!==(d=e.size)&&void 0!==d?d:C})),i.createElement(n.e,Object.assign({},e,{image:{src:e.imageUrl,style:S},className:f?s.Dd:"",style:Object.assign({},b),initials:null!==(g=e.initials)&&void 0!==g?g:e.imageInitials,name:e.text,color:null!==(h=e.color)&&void 0!==h?h:"brand",size:null!==(p=e.size)&&void 0!==p?p:C})))},l=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},28486:(e,t,o)=>{"use strict";o.d(t,{Dd:()=>i,SD:()=>n}),(0,o(54167).hN)([{rawString:"@-webkit-keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}@keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}.coinFadeIn_04b4b0a2{-webkit-animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important;animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important}.coinFadeOut_04b4b0a2{-webkit-animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important;animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important}"}]);const i="coinFadeIn_04b4b0a2",n="coinFadeOut_04b4b0a2"},18470:(e,t,o)=>{"use strict";o.d(t,{q:()=>r});var i=o(95734),n=o(33362);const r=i.createContext((0,n.jI)());i.Component},86619:(e,t,o)=>{"use strict";o.d(t,{V:()=>i});const i='"Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif'},53203:(e,t,o)=>{"use strict";function i(e,t,o=1){var i,n;return void 0===t?void 0===(null==e?void 0:e.borderRadius)||"number"==typeof(null==e?void 0:e.borderRadius)?null!==(i=null==e?void 0:e.borderRadius)&&void 0!==i?i:o:void 0:"object"==typeof(null==e?void 0:e.borderRadius)?null!==(n=e.borderRadius[t])&&void 0!==n?n:0:void 0}o.d(t,{W:()=>i})},80896:(e,t,o)=>{"use strict";o.d(t,{O:()=>i});const i=o(95734).createContext(!1);i.displayName="UseFluentV9Context"},92482:(e,t,o)=>{"use strict";var i,n;o.d(t,{tO:()=>a}),(n=i||(i={}))[n.ArrowDown=0]="ArrowDown",n[n.ArrowUp=1]="ArrowUp",n[n.ArrowLeft=2]="ArrowLeft",n[n.ArrowRight=3]="ArrowRight",n[n.End=4]="End",n[n.Enter=5]="Enter",n[n.Escape=6]="Escape",n[n.Home=7]="Home",n[n.Space=8]="Space",n[n.Tab=9]="Tab";const r={ArrowDown:i.ArrowDown,ArrowUp:i.ArrowUp,ArrowLeft:i.ArrowLeft,ArrowRight:i.ArrowRight,Enter:i.Enter,End:i.End,Escape:i.Escape,Home:i.Home,Tab:i.Tab," ":i.Space,Down:i.ArrowDown,Up:i.ArrowUp,Left:i.ArrowLeft,Right:i.ArrowRight,Spacebar:i.Space,Esc:i.Escape};function s(e,t,o){void 0!==r[o.key]&&-1!==t.indexOf(r[o.key])&&(e({key:r[o.key],alt:o.altKey,ctrl:o.ctrlKey,shift:o.shiftKey,meta:o.metaKey}),o.preventDefault(),o.stopPropagation())}function a(e,t){e.onKeyDown&&e.handledKeys&&(t.onKeyDown=s.bind(void 0,e.onKeyDown,e.handledKeys)),e.onKeyUp&&e.handledKeys&&(t.onKeyUp=s.bind(void 0,e.onKeyUp,e.handledKeys))}},53092:(e,t,o)=>{"use strict";function i(){return!1}o.d(t,{R2:()=>i})},7798:(e,t,o)=>{"use strict";o.d(t,{EH:()=>p,Eh:()=>l,HP:()=>_,Hz:()=>u,KW:()=>f,OF:()=>T,T4:()=>y,a4:()=>b,do:()=>m,eS:()=>x,g$:()=>S,m$:()=>E,ms:()=>d,o2:()=>g,pj:()=>h,rj:()=>C,t$:()=>k,xt:()=>w,zh:()=>v});var i=o(95734);if(3023==o.j)var n=o(75753);if(3023==o.j)var r=o(43463);if(3023==o.j)var s=o(59523);if(3023==o.j)var a=o(36865);function l(e){return{oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function c(e){return{defaultOverflowButtonAccessibilityLabel:e("defaultOverflowButtonAccessibilityLabel"),oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function u(e){return{defaultSplitButtonOverflowAccessibilityLabel:e("defaultSplitButtonOverflowAccessibilityLabel"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function d(e,t,o,i,s,a,l,u,d,g,h,p,m,v){const y=f(e),S=void 0!==u;if(void 0!==u&&(u<0||u>=y.length))return;const C=S?y[u]:void 0,k=s.filter((t=>w(e,t,C))).filter((t=>b(e,o,t))).map((t=>I(e,o,i,t)));return!S&&w(e,r._R.ShowMenu)&&(k.length>0&&k.push({type:"separator",key:"separator"}),k.push(I(e,o,i,r._R.ShowMenu))),0!==k.length?{tooltip:S||a?void 0:l,items:k,onClick:e=>{if(h){const t=parseInt(e.key,10);h(t,u)}},style:S?{}:Object.assign(Object.assign({},n.lI(v)),{calloutStyle:null==v?void 0:v.calloutStyle}),theme:n.B1(t,p),itemTheme:n.P4(t,void 0,!0),strings:c(o.common),accessibilityLabel:l,automationLabelType:"CritiqueActionButton",automationId:d||"",hasKeyboardFocus:p,layerHostId:g,onHeightChange:m,shouldFocusButtonOnDismiss:e.critiqueType!==r.L9.InlineSuggestion&&void 0}:void 0}function g(e,t,o,r,a,l,c,u,d,g,h,p,f,m,v,b,C,w,T,x){const I=Object.assign(Object.assign({},r.tooltipProps),{layerHostId:x||void 0}),E=S(o),A=void 0!==E?{type:E,filled:v}:void 0,B={onClick:()=>{null==m||m(o,void 0,l)},title:c,titleStyle:u,tooltip:d,tooltipProps:I,disabled:k(e,o),style:r,theme:n.P4(t,void 0,v,C),accessibilityLabel:y(e,a,o),automationLabel:null!=g?g:_(o,f),badgeProps:p,icon:A,htmlId:b,onHeightChange:T,uiAnchorId:w,hasKeyboardFocus:C,appearance:"subtle"};return i.createElement(s.u,Object.assign({ref:h},B,{key:o.toString()}))}function h(e,t,o,a,l,c,u,d,g){const h=b(e,a,r._R.Feedback);if(!h)return null;const p={type:S(r._R.Feedback),filled:!0},f=n.$d(t,u),m={onClick:()=>{null==c||c(r._R.Feedback,void 0,void 0)},title:h,tooltip:h,tooltipProps:{layerHostId:g},disabled:k(e,r._R.Feedback),style:o,theme:f,accessibilityLabel:y(e,a,r._R.Feedback),automationLabel:`CritiqueActionButton_${h}_${l}`,icon:p,onHeightChange:d};return i.createElement(s.u,Object.assign({},m,{key:r._R.Feedback.toString()}))}function p(e,t,o,i,n,r,s){if(e.showDictationCommandUx&&!i){const i=function(e,t,o,i){const n=m(e,t).filter((e=>e.action===o&&e.suggestionIndex===i));return n.length>0?n[0].badgeId:void 0}(e,t,n,r);if(void 0!==i)return{text:i.toString(),theme:o,style:s}}}function f(e){const t=e.maximumSuggestions||n.gc;return e.suggestions?e.suggestions.length>t?e.suggestions.slice(0,t):e.suggestions:[]}function m(e,t){var o;const i=v(e,t),n=[];let s=1;return i?i.forEach(((e,t)=>{n.push({action:e,badgeId:s++,suggestionIndex:t})})):null===(o=f(e))||void 0===o||o.forEach(((t,o)=>{k(e,r._R.Accept,t)||n.push({action:r._R.Accept,badgeId:s++,suggestionIndex:o})})),n}function v(e,t){switch(e.critiqueType){case r.L9.RepeatedWord:return[r._R.Accept];case r.L9.SimilarityChecker:return(w(e,r._R.MoreSources)?[r._R.IntextCitation,r._R.FullCitation,r._R.MoreSources]:[r._R.IntextCitation,r._R.FullCitation]).filter((o=>b(e,t,o)))}if(e.isContentPending)return[]}function y(e,t,o){switch(o){case r._R.Previous:case r._R.Next:if(e.wrapAroundNavigation&&void 0!==e.critiqueSetSize&&e.critiqueSetSize>1){const i=e.critiqueSetSize.toString(10);return o===r._R.Previous?t.critique("previousIssueWithCount").replace("{0}",i):t.critique("nextIssueWithCount").replace("{0}",i)}return o===r._R.Previous?t.critique("previousIssue"):t.critique("nextIssue")}return b(e,t,o)}function b(e,t,o){var i,n,s,a,l,c,u,d,g,h,p,f,m,v,y,b;switch(o){case r._R.ReadAloud:return t.critique("readAloud");case r._R.SpellOut:return t.critique("spellOut");case r._R.ChangeAll:return t.critique("changeAll");case r._R.AddToAutoCorrect:return t.critique("addToAutoCorrect");case r._R.AutoCorrectOptions:return t.critique("autoCorrectOptions");case r._R.IgnoreOnce:return t.critique("ignoreOnce");case r._R.IgnoreAll:return t.critique("ignoreAll");case r._R.IgnoreRule:return t.critique("ignoreRule");case r._R.AddToDictionary:return t.critique("addToDictionary");case r._R.Options:return t.critique("options");case r._R.ShowExplanation:return t.critique("footerExplanationButtonAccessibilityLabel");case r._R.ManageLanguages:return t.critique("manageLanguages");case r._R.Next:return t.critique("nextIssue");case r._R.Previous:return t.critique("previousIssue");case r._R.ToggleContext:return e.showContext?t.critique("hideContext"):t.critique("showContext");case r._R.ToggleDescription:return e.critiqueType===r.L9.Spelling?e.showDescription?t.critique("hideSynonyms"):t.critique("showSynonyms"):e.critiqueType===r.L9.NeuralRewrite?e.showDescription?t.critique("hideExplanationButtonText"):t.critique("showExplanationButtonText"):void 0;case r._R.ReadContext:return t.critique("readAloudOriginalSentenceAccessibilityLabel");case r._R.ShowMenu:return t.critique("showMenuButtonText");case r._R.Feedback:return t.critique("giveFeedbackButtonText");case r._R.Dismiss:return t.common("cancelButton");case r._R.OpenEditorPane:return t.critique("accessibilityLabelForEditorButton");case r._R.LearnMore:return t.critique("learnMore");case r._R.IntextCitation:return t.critique("addInTextCitation");case r._R.FullCitation:return t.critique("copyFullCitation");case r._R.MoreSources:return t.critique("moreSources");case r._R.Accessibility:return null===(i=t.accChecker)||void 0===i?void 0:i.call(t,"accAssistant");case r._R.OpenColorPicker:return null===(n=t.accChecker)||void 0===n?void 0:n.call(t,"moreColors");case r._R.MoreFontColors:return null===(s=t.accChecker)||void 0===s?void 0:s.call(t,"moreFontColors");case r._R.ChangeColors:return null===(a=t.accChecker)||void 0===a?void 0:a.call(t,"changeColors");case r._R.ResetGraphic:return null===(l=t.accChecker)||void 0===l?void 0:l.call(t,"resetGraphic");case r._R.TurnOffAccChecker:return null===(c=t.accChecker)||void 0===c?void 0:c.call(t,"turnOffAccChecker");case r._R.Allow:return null===(u=t.accChecker)||void 0===u?void 0:u.call(t,"allowTextColorIssue");case r._R.AllowAll:return null===(d=t.accChecker)||void 0===d?void 0:d.call(t,"allowAllTextColorIssues");case r._R.FixSimilarColors:return null===(g=t.accChecker)||void 0===g?void 0:g.call(t,"fixSimilarColors");case r._R.FixAllColors:return null===(h=t.accChecker)||void 0===h?void 0:h.call(t,"fixAllColors");case r._R.AutoGenAltText:case r._R.MissingAltText:return null===(p=t.accChecker)||void 0===p?void 0:p.call(t,"altText");case r._R.UseFirstRowAsHeader:return null===(f=t.accChecker)||void 0===f?void 0:f.call(t,"useFirstRowAsHeader");case r._R.SplitCell:return null===(m=t.accChecker)||void 0===m?void 0:m.call(t,"splitCell");case r._R.MergeCells:return null===(v=t.accChecker)||void 0===v?void 0:v.call(t,"mergeCells");case r._R.MarkAsDecorative:return null===(y=t.accChecker)||void 0===y?void 0:y.call(t,"markAsDecorative");case r._R.MarkAsLayout:return null===(b=t.accChecker)||void 0===b?void 0:b.call(t,"markAsLayout");case r._R.Accept:case r._R.AddOnFooterAction:case r._R.Report:case r._R.RejectHoverIn:case r._R.RejectHoverOut:case r._R.AcceptHoverIn:case r._R.AcceptHoverOut:case r._R.Reject:case r._R.OpenCustomDictionary:case r._R.SourceSelected:case r._R.ApplyColor:case r._R.RefreshSummary:case r._R.UndoInsertSummarization:case r._R.Overflow:case r._R.InsertBelow:case r._R.Regenerate:case r._R.Cancel:case r._R.StopGenerating:case r._R.ContainerHoverIn:case r._R.ContainerHoverOut:case r._R.LaunchAIRewrite:case r._R.LaunchAIRewriteHoverIn:case r._R.LaunchAIRewriteHoverOut:return}}function S(e){switch(e){case r._R.Allow:return"Ignore";case r._R.AllowAll:return"IgnoreAll";case r._R.IgnoreOnce:return"Ignore";case r._R.IgnoreAll:return"IgnoreAll";case r._R.IgnoreRule:return"IgnoreRule";case r._R.FixAllColors:return"Completed";case r._R.AddToDictionary:return"AddToDictionary";case r._R.ShowExplanation:return"ShowExplanation";case r._R.Next:return"Next";case r._R.Previous:return"Previous";case r._R.ReadContext:return"ReadAloud";case r._R.Feedback:return"GiveFeedback";case r._R.Dismiss:return"Cancel";case r._R.OpenEditorPane:return"Editor";case r._R.ManageLanguages:return"LocaleLanguage";case r._R.Options:return"EditorSettings";case r._R.IntextCitation:return"Plus";case r._R.FullCitation:return"Copy";case r._R.Accessibility:return"Accessibility";case r._R.OpenColorPicker:case r._R.MoreFontColors:case r._R.ChangeColors:return"Color";case r._R.TurnOffAccChecker:return"Hide";case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return"BowTie";case r._R.UseFirstRowAsHeader:return"FirstRowAsHeader";case r._R.ResetGraphic:return"ArrowReset"}}function C(e,t){switch(e){case r.L9.Refinement:case r.L9.RepeatedWord:case r.L9.SimilarityChecker:case r.L9.AccColorChecker:case r.L9.TonalRewrite:case r.L9.Grammar:case r.L9.DictationCorrection:case r.L9.TextPenAlternates:return r._R.IgnoreOnce;case r.L9.Spelling:case r.L9.Topic:return r._R.IgnoreAll;case r.L9.InlineSuggestion:switch(t){case r.z4.Person:case r.z4.File:case r.z4.Location:case r.z4.SatoriEntity:return r._R.IgnoreOnce;case r.z4.Topic:return r._R.IgnoreAll;default:return}case r.L9.AddinCritique:return r._R.IgnoreOnce;case r.L9.NeuralRewrite:case r.L9.Classification:case r.L9.WritersUnblock:default:return}}function w(e,t,o){switch(t){case r._R.Previous:case r._R.Next:return T(e)&&x(e,t);case r._R.ToggleContext:if(void 0===e.contextText)return!1;break;case r._R.ReadContext:const o=S(t);if(void 0===o||!a.In.shouldRender({type:o}))return!1;break;case r._R.IgnoreOnce:if(e.critiqueType===r.L9.SimilarityChecker)return!0;break;case r._R.Accessibility:case r._R.OpenColorPicker:case r._R.Allow:case r._R.AllowAll:case r._R.FixSimilarColors:case r._R.FixAllColors:case r._R.AutoGenAltText:case r._R.MissingAltText:case r._R.UseFirstRowAsHeader:case r._R.SplitCell:case r._R.MergeCells:case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return!0;case r._R.Feedback:case r._R.TurnOffAccChecker:if(e.critiqueType===r.L9.AccColorChecker||e.critiqueType===r.L9.AltText||e.critiqueType===r.L9.MergeSplitCell||e.critiqueType===r.L9.MissingTableHeader)return!0}return x(e,t,o)}function k(e,t,o){switch(t){case r._R.Next:case r._R.Previous:return!T(e)||!x(e,t)||!e.wrapAroundNavigation&&(t===r._R.Previous?e.critiquePosition<=0:e.critiquePosition>=e.critiqueSetSize-1);case r._R.Dismiss:case r._R.Accessibility:case r._R.OpenColorPicker:case r._R.Allow:case r._R.AllowAll:case r._R.FixSimilarColors:case r._R.FixAllColors:case r._R.Overflow:case r._R.AutoGenAltText:case r._R.MissingAltText:case r._R.UseFirstRowAsHeader:case r._R.SplitCell:case r._R.MergeCells:case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return!1;default:return!x(e,t,o)}}function T(e){return void 0!==e.critiquePosition&&void 0!==e.critiqueSetSize&&e.critiquePosition>=0&&e.critiqueSetSize>0}function x(e,t,o){const{actions:i}=e,n=o?o.actions:i;return!!n&&n.indexOf(t)>=0}function _(e,t){switch(e){case r._R.Previous:return`CritiqueNavButton_Left_${t}`;case r._R.Next:return`CritiqueNavButton_Right_${t}`;case r._R.Dismiss:return`CritiqueCloseButton_${t}`;case r._R.OpenEditorPane:return`EditorPaneOpenButton_${t}`}return"undefined"}function I(e,t,o,i){const r=b(e,t,i);return{type:"item",key:i.toString(),title:r,titleStyle:n.Ot(o,r.length),iconType:S(i)}}function E(e={}){return Object.assign(Object.assign({},n.Y_),e)}},87253:(e,t,o)=>{"use strict";var i,n;o.d(t,{UD:()=>i,tR:()=>n}),function(e){e[e.Unknown=0]="Unknown",e[e.Inference=1]="Inference"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.VoiceDictationBadge=1]="VoiceDictationBadge",e[e.VoiceDictationPhrase=2]="VoiceDictationPhrase"}(n||(n={}))},37834:(e,t,o)=>{"use strict";o.d(t,{Y:()=>u});var i=o(95734),n=o(67612),r=o(89810),s=o(7798),a=o(43463),l=o(75753),c=o(1636);const u=i.forwardRef(((e,t)=>{var o;const u=e.definition,d=i.useContext(r.O),g=(0,l.W0)(e,d),h=(0,c.OL)(e,t,u,g,1);let p=h.length+1;return 0===h.length&&(h.push((0,c.nb)(e,t,0,e.noSuggestionsLabel||e.strings.common("suggestionsGroupNoSuggestionsText"),a._R.Accept,g,!0)),p-=1),h.push(((e,t,o,r,c,u,d)=>{const g={title:r,actions:[a._R.LaunchAIRewrite]},h=e.suggestionKind?e.suggestionKind(g):void 0,p={title:r,titleStyle:(0,l.D0)(e.fontTable||l.d4,r.length),tag:void 0,tagStyle:(0,l.RU)(e.fontTable||l.d4),icon:{type:"ColorfulCopilot"},disabled:!1,onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,a._R.LaunchAIRewrite,o)},onSplitButtonIn:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,a._R.LaunchAIRewriteHoverIn,o)},onSplitButtonOut:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,a._R.LaunchAIRewriteHoverOut,o)},theme:(0,l.P4)(c,h),strings:(0,s.Eh)(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:e.suggestionAccessibilityLabel&&e.suggestionAccessibilityLabel(g),automationLabel:"CritiqueSuggestionButton_"+g.id};return i.createElement(n.f,{key:o,ref:t,buttonProps:p,menuProps:void 0,style:l.kw,theme:{splitMenuHoverBackground:c.suggestionMenuHoverBackground,splitMenuHoverForeground:c.suggestionMenuHoverForeground},strings:(0,s.Hz)(e.strings.common),accessibilityPositionInSet:void 0!==u?u:1,accessibilitySetSize:void 0!==d?d:1,layerHostId:e.layerHostId})})(e,t,h.length,null!==(o=u.aIRewriteButtonText)&&void 0!==o?o:e.strings.critique("defaultCritiqueAIRewriteText"),g,p,p)),i.createElement(i.Fragment,null,h)}));u.displayName="AIRewriteSuggestions"},1636:(e,t,o)=>{"use strict";o.d(t,{OL:()=>m,nb:()=>v});var i=o(95734),n=o(17321),r=o(67612),s=o(67762),a=o(89810),l=o(72124),c=o(30760),u=o(53092),d=o(7798),g=o(43463),h=o(75753);const p=(e,t,o,i,r,s,a)=>{const l=e.suggestionKind?e.suggestionKind(t):void 0,c=e.definition,u=t.title,p=u.length,f=(0,d.t$)(c,i,t),m=(0,d.EH)(c,e.strings,r,f,i,o),v=void 0!==s?{type:s}:void 0,y={title:u,titleStyle:void 0!==l&&i!==g._R.MoreSources?(0,h.D0)(e.fontTable||h.d4,p):(0,n.S)(p,r,t.titleDecorations),tag:t.tag,tagStyle:(0,h.RU)(e.fontTable||h.d4),icon:v,disabled:f,onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,i,o)},theme:(0,h.P4)(r,l),strings:(0,d.Eh)(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:e.suggestionAccessibilityLabel&&e.suggestionAccessibilityLabel(t),automationLabel:"CritiqueSuggestionButton_"+t.id,badgeProps:m,uiAnchorId:a};return((e,t)=>!!((0,d.eS)(e,g._R.Accept,t)&&e.showDescription&&t.subtitle&&t.subtitle.length>0))(e.definition,t)&&(y.subtitle=t.subtitle,y.subtitleStyle=(0,h.qw)(e.fontTable||h.d4)),y},f=(e,t,o,n,s,a,l,c)=>i.createElement(r.f,{key:o,ref:t,buttonProps:n,menuProps:a,style:h.kw,theme:{splitMenuHoverBackground:s.suggestionMenuHoverBackground,splitMenuHoverForeground:s.suggestionMenuHoverForeground},strings:(0,d.Hz)(e.strings.common),accessibilityPositionInSet:void 0!==l?l:1,accessibilitySetSize:void 0!==c?c:1,layerHostId:e.layerHostId});function m(e,t,o,n,r){const a=(0,d.KW)(o);return a.map(((l,c)=>{const u=f(e,0===c?t:void 0,c,p(e,l,c,g._R.Accept,n,e.suggestionIcon?e.suggestionIcon(l):void 0),n,(0,d.ms)(o,n,e.strings,e.fontTable||h.d4,e.suggestionOverflowActions||[],!(!e.settings||"true"!==e.settings.NoTooltipForFooterOverflow),void 0,c,e.automationId,e.layerHostId,e.onAction),c+1,a.length+(null!=r?r:0));return c>0&&l.tag!==a[c-1].tag?i.createElement(i.Fragment,null,i.createElement(s.w,{key:c,color:e.theme&&e.theme.separator,style:h.cK}),u):u}))}const v=(e,t,o,i,n,r,s,a,l,c,u)=>f(e,0===o?t:void 0,o,p(e,{title:i,actions:s?[]:[n]},o,n,r,a,u),r,void 0,l,c),y=i.forwardRef(((e,t)=>{const o=e.definition,n=i.useContext(a.O),r=(0,h.W0)(e,n),s=m(e,t,o,r);return 0===s.length?v(e,t,0,e.noSuggestionsLabel||e.strings.common("suggestionsGroupNoSuggestionsText"),g._R.Accept,r,!0):i.createElement(i.Fragment,null,s)}));y.displayName="Suggestions",i.forwardRef(((e,t)=>{var o;const n=e.suggestionsGroupAriaLabel,r=null!==(o=e.customSuggestions)&&void 0!==o?o:i.createElement(y,Object.assign({},e,{ref:t}));return(0,u.R2)()?i.createElement(l.S,{align:c.j5.Stretch,accessible:!1},r):i.createElement(l.S,{align:c.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:n},r)})).displayName="BodySuggestions"},74495:(e,t,o)=>{"use strict";if(o.d(t,{m:()=>c}),3023==o.j)var i=o(5779);if(3023==o.j)var n=o(57683);var r=o(95734);if(3023==o.j)var s=o(43463);if(3023==o.j)var a=o(75753);if(3023==o.j)var l=o(1636);const c=(e,t)=>({suggestionKind:e=>{if(!(e.titleDecorations&&e.titleDecorations.length>0))return"suggestion"},suggestionOverflowActions:[],suggestionsGroupAriaLabel:e.strings.critique("suggestionsGroupAccessibilityLabel"),suggestionAccessibilityLabel:t=>{const o=e.definition,i=t.tagAccessibilityLabel||t.tag||"";return o.showDescription&&t.subtitle&&0!==t.subtitle.trim().length?e.strings.critique("neuralRewriteSuggestionAccessibilityLabel").replace("{0}",t.title).replace("{1}",t.subtitle):i?e.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",i).replace("{1}",t.title):""},customBody:e.definition.isContentPending?r.createElement(i.R,null,r.createElement(n.v,{key:0,shimmerCount:a.Wi,styles:(0,a.B8)(e.spacing||a.lT),render:()=>(0,l.nb)(e,void 0,0,e.strings.common("suggestionsGroupLoadingSuggestionsText"),s._R.Accept,(0,a.W0)(e,!!(null==t?void 0:t.useFluentV9)),!0)})):void 0})},91050:(e,t,o)=>{"use strict";o.d(t,{R:()=>c});var i=o(95734);if(3023==o.j)var n=o(75753);if(3023==o.j)var r=o(72124);if(3023==o.j)var s=o(30760);if(3023==o.j)var a=o(36865);if(3023==o.j)var l=o(85936);const c=e=>i.createElement(r.S,{direction:s.PR.LeftToRight,style:n.JP},i.createElement(a.In,{type:"ForwardSlashPromo",style:n.VP}),i.createElement(l.c,{text:e.strings.inlineSuggestions("discoveryPromoFooterText"),style:n.vP}))},14018:(e,t,o)=>{"use strict";o.d(t,{w:()=>z,k:()=>H});var i=o(95734),n=o(75753),r=o(6422),s=o(72212),a=o(89810),l=o(5779),c=o(86373);const u=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useContext(a.O),n=i.useRef(null),r=i.useRef(null);(0,i.useImperativeHandle)(t,(()=>({focus:u})));const u=()=>{var e,t;o?null===(e=r.current)||void 0===e||e.focus():null===(t=n.current)||void 0===t||t.focus()};return o?i.createElement(l.y,Object.assign({},e,{ref:r,direction:c.E.None})):i.createElement(s.Y,{disabled:e.disabled,componentRef:n,forceFocusInsideTrap:!1},e.children)})));u.displayName="FocusTrapZone";var d=o(80034),g=o(30760),h=o(72124),p=o(85936),f=o(36865),m=o(27326);class v extends i.PureComponent{render(){return i.createElement("tr",null,this.props.children)}}class y extends i.PureComponent{render(){return this.props.header?i.createElement("th",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children):i.createElement("td",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableCellStyle(){const e={};return this.props.style&&this.props.style.paddingVertical&&(e.paddingBottom=this.props.style.paddingVertical,e.paddingTop=this.props.style.paddingVertical),this.props.style&&this.props.style.paddingHorizontal&&(e.paddingLeft=this.props.style.paddingHorizontal,e.paddingRight=this.props.style.paddingHorizontal),this.props.style&&this.props.style.paddingStart&&(e.paddingInlineStart=this.props.style.paddingStart),this.props.style&&this.props.style.paddingEnd&&(e.paddingInlineEnd=this.props.style.paddingEnd),this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),this.props.style&&this.props.style.marginHorizontal&&(e.marginLeft=this.props.style.marginHorizontal,e.marginRight=this.props.style.marginHorizontal),this.props.style&&this.props.style.verticalAlign&&(e.verticalAlign=this.props.style.verticalAlign),this.props.style&&this.props.style.horizontalAlign&&(e.textAlign=this.props.style.horizontalAlign),e}}var b=o(17321);class S extends i.PureComponent{render(){return i.createElement("table",{style:this.getTableStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableStyle(){const e={borderCollapse:"collapse"};return this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),e}}var C,w=o(43463);!function(e){e[e.Exposition=0]="Exposition",e[e.Example=1]="Example"}(C||(C={}));class k extends i.PureComponent{componentDidMount(){const e=this.getDefinition();e&&e.explanationTitle,this.getExplanationText()}render(){const e=this.parseExplanationText(this.getExplanationText()),t=this.getDefinition(),o=t&&t.explanationTitle||"";return i.createElement(u,null,i.createElement(d.Y,{componentStackStyle:n.tJ(this.props.style,this.props.theme),stackAlignment:g.j5.Stretch,stackDirection:g.PR.TopToBottom,header:o,headerStyle:n.J2(this.props.theme,this.props.fontTable)},this.renderExplanationText(e),this.renderAccessibleColorsLearningTip(),this.renderMergeSplitCellsLearningTip()))}renderAccessibleColorsLearningTip(){var e,t,o,r,s,a;if(this.props.definition.critiqueType!==w.L9.AccColorChecker)return null;const l={height:16,width:16},c={type:"ErrorBadge",primaryColor:"#E41323",style:l},u={type:"Completed",primaryColor:"#0B6A0B",style:l},d={backgroundColor:"#CCCCCC",borderRadius:2,minHeight:24,marginVertical:4,marginStart:10,paddingHorizontal:15},v={width:"50%"};return i.createElement(h.S,null,i.createElement(h.S,{direction:g.PR.LeftToRight},i.createElement(h.S,{style:v},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableBefore"),style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})),i.createElement(h.S,{style:v},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableAfter"),style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(h.S,{direction:g.PR.LeftToRight},i.createElement(h.S,{style:v},i.createElement(h.S,{direction:g.PR.LeftToRight},i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Center,style:{height:32}},i.createElement(f.In,Object.assign({},c))),i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Center,style:d},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#BECFFA",fontSize:this.props.fontTable.xsmall,fontWeight:m.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(h.S,{direction:g.PR.LeftToRight},i.createElement(h.S,{style:{width:26}}),i.createElement(p.c,{text:null!==(o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"poorContrast"))&&void 0!==o?o:"",style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(h.S,{style:v},i.createElement(h.S,{direction:g.PR.LeftToRight},i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Center,style:{height:32}},i.createElement(f.In,Object.assign({},u))),i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Center,style:d},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#002EA3",fontSize:this.props.fontTable.xsmall,fontWeight:m.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(h.S,{direction:g.PR.LeftToRight},i.createElement(h.S,{style:{width:26}}),i.createElement(p.c,{text:null!==(a=null===(s=(r=this.props.strings).accChecker)||void 0===s?void 0:s.call(r,"goodContrast"))&&void 0!==a?a:"",style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))))}renderMergeSplitCellsLearningTip(){const{critiqueType:e}=this.props.definition,t=this.props.strings.accChecker;return e===w.L9.MergeSplitCell&&t?i.createElement(h.S,null,["mergeSplitCellStepsTitle","mergeSplitCellStepsLine1","mergeSplitCellStepsLine2","mergeSplitCellStepsLine3","mergeSplitCellStepsLine4","mergeSplitCellStepsEnd"].map((e=>i.createElement(p.c,{key:e,text:null==t?void 0:t(e),style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))):null}getDefinition(){return this.props.definition}getExplanationText(){const e=this.getDefinition();return e&&e.explanation?e.explanation.replace("\\r\\n","\r\n"):""}parseExplanationText(e){const t=[];let o=[],n=null,r=!0,s=!1,a=0,l=0,c=0,u=this.props.strings.critiqueExplanation("explanationTableBefore"),d=this.props.strings.critiqueExplanation("explanationTableAfter");const g=e.split("\r\n");for(const e of g)if(0!==e.length)if("•"===e[0]){const t=e.indexOf(":"),g=e.substr(2,t-1),h=e.substr(t+2);r?(u=g,n=this.renderBeforeText(h,l++),r=!1,s=!0):s?(d=g,o.push(i.createElement(v,{key:a++},this.renderTableHeaderText(u,l++,0===o.length,!0),this.renderTableHeaderText(d,c++,0===o.length,!1))),o.push(i.createElement(v,{key:a++},n,this.renderAfterText(h,c++))),n=null,s=!1):(o.push(i.createElement(v,{key:a++},this.renderPlaceholder(l++),this.renderExampleSeparator(c++))),o.push(i.createElement(v,{key:a++},this.renderPlaceholder(l++),this.renderAfterText(h,c++))))}else o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t.push(this.renderExplanationNonExampleText(e));else n=null,r=!0,s=!1;return o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t}analyzeExampleText(e){const t={trimmedText:e,emphasisStart:-1,emphasisLength:-1},o=e.indexOf("{ul}");if(-1!==o){const i=e.indexOf("{ul 0}",o);if(-1!==i){const n=o+4,r=i-n;t.trimmedText=e.substr(0,o)+e.substr(n,r)+e.substr(i+6),t.emphasisStart=o,t.emphasisLength=r}}return t}renderTableHeaderText(e,t,o,r){const s=r?n.i6():n.db();return o?i.createElement(y,{header:!0,key:t,style:s},i.createElement(p.c,{text:e,style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})):i.createElement(y,{key:t,style:s}," ")}renderCurrentTable(e){return{explanationPartType:C.Example,data:e}}getDecorationType(e){switch(e){case w.L9.Grammar:return w.vr.Grammar;case w.L9.Refinement:return w.vr.Refinement;default:return w.vr.None}}renderBeforeText(e,t){return this.renderExampleText(e,t,this.getDecorationType(this.getDefinition().critiqueType),this.props.strings.critiqueExplanation("explanationTableBefore"),!0)}renderAfterText(e,t){return this.renderExampleText(e,t,w.vr.Modification,this.props.strings.critiqueExplanation("explanationTableAfter"),!1)}renderExampleText(e,t,o,s,a){const l=[],c=this.analyzeExampleText(e);-1!==c.emphasisStart&&-1!==c.emphasisLength&&l.push({start:c.emphasisStart,length:c.emphasisLength,decorationType:o});const u=s+" "+(0,r.y)(this.props.strings.textFormatting,this.getDefinition().critiqueType,c.trimmedText,l),d=a?n.i6():n.db();return i.createElement(y,{key:t,style:d},i.createElement(p.c,{text:c.trimmedText,style:n._e(this.props.theme,this.props.fontTable),formatting:(0,b.S)(e.length,this.props.theme,l),accessibilityRole:"text",accessibilityLabel:u}))}renderExampleSeparator(e){return i.createElement(y,{key:e,style:n.db()},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableSeparator"),style:n.LO(this.props.theme,this.props.fontTable),accessibilityRole:"text"}))}renderPlaceholder(e){return i.createElement(y,{key:e,style:n.i6()})}renderExplanationNonExampleText(e){return{explanationPartType:C.Exposition,data:[i.createElement(p.c,{key:0,text:e,style:n.MW(this.props.theme,this.props.fontTable),accessibilityRole:"text"})]}}renderExplanationText(e){const t=[];for(const o of e)switch(o.explanationPartType){case C.Exposition:o.data[0]&&t.push(o.data[0]);break;case C.Example:t.push(i.createElement(S,{style:n.PN(),accessibilityLabel:this.props.strings.critiqueExplanation("explanationTableAccessibilityLabel")},o.data))}return t}}var T=o(59523),x=o(97328),_=o(55672),I=o(7798);const E=e=>{const{brandingMode:t,theme:o}=e,n={useFluentV9:i.useContext(a.O)};switch(t){case w.nH.Text:const{strings:t,fontTable:r}=e,s=t.critique("microsoftEditorBranding"),a=_.ET(o,r,n),l=t.critique("microsoftEditorBrandingAccessibilityLabel"),c=i.createElement(p.c,{text:s,accessibilityLabel:l,style:a});return A(c);case w.nH.Icon:return A(i.createElement(f.In,{type:"Editor",primaryColor:_.C_(o,n)}));case w.nH.MonochromeIcon:return A(i.createElement(f.In,{type:"EditorSingleColor",primaryColor:_.C_(o,n)}));case w.nH.IconButton:return B(e,n);case w.nH.IconAndTextButton:return R(e,n);case w.nH.CustomImageAndText:return D(e,n);default:return i.createElement(i.Fragment,null)}},A=e=>i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Center,style:{paddingHorizontal:6,paddingVertical:6}},e),B=(e,t)=>{const{definition:o,strings:n,theme:r,automationId:s,onAction:a,fontTable:l,htmlId:c,hasKeyboardFocus:u,isDisabled:d,showPreviewTooltipForBranding:p,layerHostId:f}=e,m=_.m7(r,u,t),v=_.qv(l),y=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Stretch},M(o,m,v,n,void 0,void 0,y,s,a,c,d,u,f))},R=(e,t)=>{const{definition:o,strings:n,theme:r,automationId:s,onAction:a,fontTable:l,htmlId:c,hasKeyboardFocus:u,isDisabled:d,showPreviewTooltipForBranding:p,layerHostId:f}=e,m=_._s(r,u,t),v=_.Eq(l),y=n.critique("editorButtonText"),b=_.zB(l),S=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Stretch},M(o,m,v,n,y,b,S,s,a,c,d,u,f))},M=(e,t,o,n,r,s,a,l,c,u,d,g,h)=>{const p=I.g$(w._R.OpenEditorPane),f=void 0!==p?{type:p}:void 0,m={appearance:"subtle",onClick:()=>{null==c||c(w._R.OpenEditorPane,void 0,void 0)},title:r,titleRootStyle:s,tooltip:a,tooltipProps:h?{layerHostId:h}:void 0,disabled:d,style:o,theme:t,accessibilityLabel:I.T4(e,n,w._R.OpenEditorPane),automationLabel:I.HP(w._R.OpenEditorPane,l),icon:f,htmlId:u,hasKeyboardFocus:g};return i.createElement(T.u,Object.assign({},m,{key:w._R.OpenEditorPane.toString()}))},D=(e,t)=>{const{theme:o,fontTable:n,definition:r}=e;return r.brandingImageUri&&r.brandingText?i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Center,style:{paddingHorizontal:8,paddingVertical:8}},i.createElement(i.Fragment,null,i.createElement(x._,{uri:r.brandingImageUri,style:{width:20,height:20}}),i.createElement(h.S,{style:{paddingHorizontal:3}},i.createElement(i.Fragment,null)),i.createElement(p.c,{text:r.brandingText,style:_.pd(o,n,t)}))):i.createElement(i.Fragment,null)};var P=o(16563),N=o(57683),F=o(20694),O=o(47982),j=o(73900),q=o(24189);class L extends i.PureComponent{constructor(e){super(e),this.shouldFocusButtonOnUpdate=!1,this.buttonRef=i.createRef(),this.flyoutAnchorRef=i.createRef(),this.buttonId="FlyoutAnchor"+L.ids,L.ids+=1,this.handleClick=this.handleClick.bind(this),this.closeCallout=this.closeCallout.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this),this.onPopoverOpenChange=this.onPopoverOpenChange.bind(this),this.state={calloutVisible:!1}}render(){var e,t,o,n;if(!this.context){const t=this.renderButton();if(this.state.calloutVisible){const o=null===(e=this.props.calloutStyle)||void 0===e?void 0:e.borderRadius,n={role:"dialog",target:"#"+this.buttonId,isBeakVisible:!1,ariaLabel:this.props.calloutAccessibilityLabel,setInitialFocus:!0,onDismiss:this.closeCallout,layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:o},calloutMain:{borderRadius:o},root:{borderRadius:o}}},r=i.createElement(q.P,Object.assign({},n),this.props.children);return i.createElement("div",{id:this.buttonId,style:{display:"flex"}},t,r)}return t}return i.createElement(F.A,{trapFocus:!0,inline:!0,open:this.state.calloutVisible,onOpenChange:this.onPopoverOpenChange,closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(o=null===(t=this.buttonRef.current)||void 0===t?void 0:t.getElementRef())||void 0===o?void 0:o.current}},i.createElement(O.W,null,i.createElement("div",{role:void 0,"aria-expanded":void 0,id:this.props.layerHostId,ref:this.flyoutAnchorRef,tabIndex:-1},this.renderButton())),i.createElement(j.H,{role:"dialog","aria-lable":this.props.calloutAccessibilityLabel,style:{padding:0,borderWidth:"0px",borderRadius:null===(n=this.props.calloutStyle)||void 0===n?void 0:n.borderRadius}},this.props.children))}componentDidUpdate(){var e;this.shouldFocusButtonOnUpdate&&(null===(e=this.buttonRef.current)||void 0===e||e.focus(),this.shouldFocusButtonOnUpdate=!1)}renderButton(){const e=Object.assign(Object.assign({},this.props.buttonProps),{htmlId:this.buttonId,onClick:this.context?this.props.buttonProps.onClick:this.handleClick,accessibilityState:this.state.calloutVisible,accessibilityRole:this.props.buttonAccessibilityRole||"button",tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0});return this.state.calloutVisible&&e.theme&&e.theme.background.hover&&(e.theme=Object.assign(Object.assign({},e.theme),{background:Object.assign(Object.assign({},e.theme.background),{resting:e.theme.background.hover})})),i.createElement(T.u,Object.assign({},e,{onAccessibilityExpandCollapse:this.onAccessibilityExpandCollapse,ref:this.buttonRef}))}onPopoverOpenChange(e,t){t.open||(this.shouldFocusButtonOnUpdate=!0),this.setState((e=>Object.assign(Object.assign({},e),{calloutVisible:t.open})))}handleClick(){this.props.buttonProps.onClick&&this.props.buttonProps.onClick(),this.setState((e=>({calloutVisible:!e.calloutVisible})))}closeCallout(){this.shouldFocusButtonOnUpdate=!0,this.setState((e=>({calloutVisible:!1})))}onAccessibilityExpandCollapse(e){var t,o;"expand"===e&&this.state.calloutVisible||"collapse"===e&&!this.state.calloutVisible||(this.context?null===(o=(t=this.props.buttonProps).onClick)||void 0===o||o.call(t):this.handleClick())}}L.contextType=a.O,L.ids=0;const H=e=>"footerButton"+e.toString();class z extends i.Component{constructor(e){super(e),this.defaultActionButtonRef=i.createRef(),this.overflowMenuRef=i.createRef(),this.overflowMenuRefV9=i.createRef(),this.isFirstTimeRendering=i.createRef(),this.actionIds=i.createRef(),this.state={actionIdShowAppearFocusMap:{}},this.addActionId=this.addActionId.bind(this),this.isFirstTimeRendering.current=!0}componentDidMount(){var e;this.props.setFooterActionIdList&&this.props.setFooterActionIdList(null!==(e=this.actionIds.current)&&void 0!==e?e:[]),this.isFirstTimeRendering.current=!1}componentDidUpdate(e,t){const{selectedButtonIndex:o}=this.props,i=e.selectedButtonIndex;o!==i&&(void 0!==i&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[i],o=Object.assign({},e.actionIdShowAppearFocusMap);return o[t]=!1,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:o})}return e})),void 0!==o&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[o],i=Object.assign({},e.actionIdShowAppearFocusMap);return i[t]=!0,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:i})}return e})))}render(){return i.createElement(h.S,{direction:g.PR.LeftToRight,style:this.getFooterStyle(),align:g.j5.Stretch},this.renderIcons(),i.createElement(h.S,{style:{flexibleSize:!0}}),this.props.definition.critiqueType===w.L9.AccColorChecker||this.props.definition.critiqueType===w.L9.AltText||this.props.definition.critiqueType===w.L9.MergeSplitCell||this.props.definition.critiqueType===w.L9.MissingTableHeader?this.renderFooterButton(w._R.Accessibility):null,this.renderBrandingOrPrevNextButton())}focus(){var e,t;this.defaultActionButtonRef.current?this.defaultActionButtonRef.current.focus():this.context?null===(e=this.overflowMenuRefV9.current)||void 0===e||e.focus():null===(t=this.overflowMenuRef.current)||void 0===t||t.focus()}openOverflowMenu(e){var t,o;this.context?null===(t=this.overflowMenuRefV9.current)||void 0===t||t.openMenu(e):null===(o=this.overflowMenuRef.current)||void 0===o||o.openMenu()}componentWillUnmount(){this.props.setFooterActionIdList&&this.props.setFooterActionIdList([]),this.isFirstTimeRendering.current=null}renderIcons(){return this.props.definition.onlyShowFeedbackButton?this.renderFeedbackIcon():i.createElement(i.Fragment,null,this.renderDefaultActionButtons(),this.renderExplanation(),this.renderOverflowMenu())}renderFeedbackIcon(){const{definition:e,strings:t,layerHostId:o,onAction:i,automationId:r}=this.props;return I.xt(e,w._R.Feedback)?(this.addActionId(w._R.Feedback),I.pj(e,this.getTheme(),n.Vn(this.props.footerButtonStyle),t,r,i,this.state.actionIdShowAppearFocusMap[w._R.Feedback],void 0,o)):null}addActionId(e){I.t$(this.props.definition,e)||this.isFirstTimeRendering.current&&(null===this.actionIds.current&&(this.actionIds.current=[]),this.actionIds.current.push(e))}parseBooleanSetting(e){return!!this.props.settings&&"true"===this.props.settings[e]}renderOverflowMenu(){const{definition:e,layerHostId:t,strings:o,onAction:n,automationId:r}=this.props,{critiqueType:s,isContentPending:a}=e;if(s===w.L9.NeuralRewrite&&a||s===w.L9.NeuralRewrite&&this.parseBooleanSetting("renderNRForAIFeedback")||s===w.L9.DictationCorrection)return null;const l=this.state.actionIdShowAppearFocusMap[w._R.Overflow],c=I.ms(e,this.getTheme(),o,this.getFontTable(),this.calculateOverflowActions(),this.parseBooleanSetting("NoTooltipForFooterOverflow"),o.critique("footerSeeMoreActionsAccessibilityLabel"),void 0,r,t,n,l,void 0,Object.assign(Object.assign({},this.props.overflowMenuButtonStyle),{calloutStyle:this.props.overflowMenuCalloutStyle}));return c?(this.addActionId(w._R.Overflow),i.createElement(P.o,Object.assign({ref:this.overflowMenuRef,refV9:this.overflowMenuRefV9},c,{icon:{type:"Overflow",filled:!0}}))):null}calculateOverflowActions(){const{actions:e}=this.props.definition;return void 0===e||0===e.length?[]:this.getAllFooterOverflowActions().filter((t=>void 0!==t&&-1!==e.indexOf(t)))}getTheme(e){var t;const o=null!==(t=this.props.theme)&&void 0!==t?t:this.context?n.ol:n.vy,i=o.altIcon;return e===w._R.Accessibility&&o.accessibilityIcon?Object.assign(Object.assign({},o),{altIcon:Object.assign(Object.assign({},i),{resting:o.accessibilityIcon})}):o}getBrandingTheme(){var e,t;return null!==(t=null===(e=this.props.theme)||void 0===e?void 0:e.branding)&&void 0!==t?t:_.m0(this.props.definition.brandingMode,{useFluentV9:!!this.context})}getFontTable(){var e;return null!==(e=this.props.fontTable)&&void 0!==e?e:n.d4}getFooterStyle(){var e;return null!==(e=this.props.footerContainerStyle)&&void 0!==e?e:n.Y_}renderFooterButton(e,t,o){var r;const{definition:s,strings:a,onAction:l,automationId:c}=this.props;if(!I.xt(s,e))return null;const u=I.a4(s,a,e);if(!u)return null;this.addActionId(e);const d=`CritiqueActionButton_${u}_${c}`,g=I.t$(s,e),h=e===w._R.IgnoreOnce||e===w._R.IgnoreAll?I.EH(s,a,this.getTheme(),g,e,void 0,{horizontalSpacing:null===(r=this.getFooterStyle())||void 0===r?void 0:r.paddingHorizontal}):void 0;if(!this.shouldRenderFooterIconActionInOverflow(e))return I.o2(s,this.getTheme(e),e,n.Vn(this.props.footerButtonStyle),a,void 0,void 0,void 0,u,d,t?this.defaultActionButtonRef:void 0,h,c,l,!0,H(e),this.state.actionIdShowAppearFocusMap[e],o,void 0,this.props.layerHostId);const p={appearance:"subtle",title:u,titleStyle:n.Dd(this.getFontTable(),u.length),onClick:()=>{null==l||l(e)},style:n.Vn(this.props.footerButtonStyle),theme:n.P4(this.getTheme(e)),automationLabel:d,disabled:g};return i.createElement(T.u,Object.assign({key:e,ref:this.defaultActionButtonRef},p))}renderDefaultActionButtons(){const{definition:e,strings:t,onAction:o,automationId:r}=this.props,{critiqueType:s,actions:a}=e;let l=[];return void 0!==a&&a.length>0&&(l=this.getDefaultActions().filter((e=>void 0!==e&&-1!==a.indexOf(e)))),s!==w.L9.NeuralRewrite?i.createElement(i.Fragment,null,l.map((e=>e===w._R.OpenColorPicker?this.renderFooterButton(w._R.OpenColorPicker,0===l.indexOf(e),"ACCF2E3E-7EC7-46DF-AB25-A1AFEDBC6B7B"):this.renderFooterButton(e,0===l.indexOf(e)))),this.props.definition.critiqueType===w.L9.AltText&&this.renderFooterButton(w._R.MarkAsDecorative),this.props.definition.critiqueType===w.L9.MissingTableHeader&&this.renderFooterButton(w._R.MarkAsLayout)):0===l.length?i.createElement(N.v,{shimmerCount:1,styles:n.ys(this.getSpacing())}):i.createElement(i.Fragment,null,l.map((i=>i===w._R.Dismiss?(this.addActionId(i),I.o2(e,this.getTheme(i),w._R.Dismiss,n.nV(this.getFontTable()),t,void 0,void 0,void 0,void 0,void 0,this.defaultActionButtonRef,void 0,r,o,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId)):this.renderFooterButton(i))))}getDefaultActions(){const{definition:e}=this.props,{critiqueType:t,isContentPending:o,flagType:i}=e,n=I.rj(t,i),r=this.parseBooleanSetting("EnableFeedback"),s=this.parseBooleanSetting("FirstActionTurnOffAccChecker");switch(t){case w.L9.Refinement:case w.L9.Topic:const a=[n];return I.xt(e,w._R.Feedback)&&(this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)&&t!==w.L9.Topic||a.push(w._R.Feedback)),a;case w.L9.Spelling:return[n,I.xt(e,w._R.Feedback)&&!this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0,this.shouldRenderFooterIconActionInOverflow(w._R.AddToDictionary)?void 0:w._R.AddToDictionary];case w.L9.AccColorChecker:{const e=this.parseBooleanSetting("AllowTextColorIssueEnabled"),t=[];return e&&t.push(w._R.Allow),!e&&s&&t.push(w._R.TurnOffAccChecker),t.push(w._R.OpenColorPicker),t}case w.L9.AltText:case w.L9.MissingTableHeader:case w.L9.MergeSplitCell:return[s?w._R.TurnOffAccChecker:void 0];case w.L9.RepeatedWord:case w.L9.SimilarityChecker:case w.L9.DictationCorrection:case w.L9.TextPenAlternates:return[n];case w.L9.Grammar:return[n,r&&!this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0];case w.L9.TonalRewrite:return[n,r?w._R.Feedback:void 0];case w.L9.NeuralRewrite:return o?[]:0===I.KW(e).length?[w._R.Dismiss]:[w._R.Feedback];case w.L9.InlineSuggestion:if(void 0===i)return[n,I.xt(e,w._R.Feedback)&&!this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0];switch(i){case w.z4.Location:case w.z4.SatoriEntity:case w.z4.Topic:return[n];case w.z4.File:case w.z4.Person:return[n,w._R.Feedback];default:return[]}case w.L9.AddinCritique:return[n];default:return[]}}renderExplanation(){const{automationId:e,footerButtonStyle:t,layerHostId:o,onAction:r,overflowMenuCalloutStyle:s,strings:a,style:l}=this.props,c=Object.assign({},this.props.definition),u=this.getTheme(),d=this.getFontTable();if(!c.explanationTitle||!c.explanation)return null;const g={appearance:"subtle",onClick:()=>{null==r||r(w._R.ShowExplanation)},style:n.uY(d,t),theme:n.P4(u,void 0,!0),tooltip:I.a4(c,a,w._R.ShowExplanation),accessibilityLabel:I.T4(c,a,w._R.ShowExplanation),automationLabel:`CritiqueExplanationButton_${e}`,icon:{type:"ShowExplanation",filled:!0},tooltipProps:{layerHostId:o}};this.addActionId(w._R.ShowExplanation);const h={definition:c,strings:a,style:l,theme:u,fontTable:d};return i.createElement(L,{calloutAccessibilityLabel:a.critique("explanationFlyoutAccessibilityLabel"),calloutStyle:s,layerHostId:o,buttonAccessibilityRole:"button",buttonProps:g,showCloseButton_DONOTUSE:!0,closeButtonAccessibilityLabel_DONOTUSE:a.critique("explanationFlyoutCloseLabel")},i.createElement(k,Object.assign({},h)))}renderBrandingOrPrevNextButton(){const{definition:e,showPreviewTooltipForBranding:t}=this.props,{brandingMode:o}=e;if(I.OF(e))return this.renderPrevNextButtons();if(void 0===o)return null;const{strings:n,automationId:r,layerHostId:s,onAction:a}=this.props,l=I.t$(e,w._R.OpenEditorPane);return o!==w.nH.IconButton&&o!==w.nH.IconAndTextButton||this.addActionId(w._R.OpenEditorPane),i.createElement(E,{strings:n,theme:this.getBrandingTheme(),fontTable:this.getFontTable(),definition:e,automationId:r,brandingMode:o,onAction:a,htmlId:H(w._R.OpenEditorPane),hasKeyboardFocus:l?void 0:this.state.actionIdShowAppearFocusMap[w._R.OpenEditorPane],isDisabled:l,showPreviewTooltipForBranding:t,layerHostId:s})}renderPrevNextButtons(){if(!I.xt(this.props.definition,w._R.Previous)||!I.xt(this.props.definition,w._R.Next))return null;const e=n.nV(this.getFontTable()),t=!this.parseBooleanSetting("NoTooltipForPrevNext");return this.addActionId(w._R.Previous),this.addActionId(w._R.Next),i.createElement(h.S,{direction:g.PR.LeftToRight,align:g.j5.Stretch},I.o2(this.props.definition,this.getTheme(),w._R.Previous,e,this.props.strings,void 0,void 0,void 0,t?I.a4(this.props.definition,this.props.strings,w._R.Previous):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,H(w._R.Previous),this.state.actionIdShowAppearFocusMap[w._R.Previous],void 0,void 0,this.props.layerHostId),I.o2(this.props.definition,this.getTheme(),w._R.Next,e,this.props.strings,void 0,void 0,void 0,t?I.a4(this.props.definition,this.props.strings,w._R.Next):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,H(w._R.Next),this.state.actionIdShowAppearFocusMap[w._R.Next],void 0,void 0,this.props.layerHostId))}getAllFooterOverflowActions(){const{critiqueType:e,flagType:t}=this.props.definition,o=this.parseBooleanSetting("EnableFeedback"),i=this.parseBooleanSetting("FirstActionTurnOffAccChecker");switch(e){case w.L9.Spelling:return[w._R.IgnoreOnce,this.shouldRenderFooterIconActionInOverflow(w._R.AddToDictionary)?w._R.AddToDictionary:void 0,w._R.ToggleContext,w._R.ToggleDescription,w._R.Options,w._R.ManageLanguages];case w.L9.RepeatedWord:return[w._R.ToggleContext,w._R.Options];case w.L9.Grammar:return[w._R.IgnoreAll,w._R.IgnoreRule,w._R.ShowExplanation,w._R.ToggleContext,o&&this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0,w._R.Options];case w.L9.Refinement:return[w._R.IgnoreRule,w._R.ToggleContext,o&&this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0,w._R.Options];case w.L9.TonalRewrite:return[w._R.IgnoreAll,w._R.IgnoreRule,w._R.ToggleContext,w._R.Options];case w.L9.Topic:return[w._R.IgnoreOnce,w._R.IgnoreRule,w._R.ToggleContext,w._R.Options];case w.L9.NeuralRewrite:return[w._R.ToggleContext,w._R.ToggleDescription];case w.L9.SimilarityChecker:return[w._R.Feedback,w._R.LearnMore];case w.L9.AccColorChecker:{const e=this.parseBooleanSetting("AllowTextColorIssueEnabled");return[this.parseBooleanSetting("BulkFixTextColorIssuesEnabled")?w._R.FixAllColors:void 0,e?w._R.AllowAll:void 0,e||!i?w._R.TurnOffAccChecker:void 0,w._R.Feedback]}case w.L9.AltText:case w.L9.MergeSplitCell:case w.L9.MissingTableHeader:return[i?void 0:w._R.TurnOffAccChecker];case w.L9.InlineSuggestion:if(void 0!==t)switch(t){case w.z4.Location:case w.z4.SatoriEntity:return[w._R.IgnoreRule,w._R.Feedback,w._R.ReadAloud,w._R.Options];case w.z4.File:case w.z4.Person:return[w._R.IgnoreRule,w._R.IgnoreAll,w._R.ReadAloud,w._R.Options];case w.z4.Topic:return[w._R.Feedback,w._R.Options];default:return[]}return[w._R.IgnoreRule,w._R.IgnoreAll,w._R.ReadAloud,w._R.Options];default:return[]}}shouldRenderFooterIconActionInOverflow(e){const t=I.g$(e);return!this.parseBooleanSetting("RenderFooterIcons")||!t||!f.In.shouldRender({type:t})}getSpacing(){var e;return null!==(e=this.props.spacing)&&void 0!==e?e:n.lT}}z.contextType=a.O},56928:(e,t,o)=>{"use strict";o.d(t,{J:()=>h});var i=o(95734);if(3023==o.j)var n=o(59523);if(3023==o.j)var r=o(36865);if(3023==o.j)var s=o(27326);if(3023==o.j)var a=o(72124);if(3023==o.j)var l=o(30760);if(3023==o.j)var c=o(85936);if(3023==o.j)var u=o(91942);if(3023==o.j)var d=o(20518);if(3023==o.j)var g=o(78218);const h=e=>{var t,o,h,p,f,m,v;const y=new Map([["EditorWithStars","EditorWithStarsAnimated"],["EditorWithStarsDarkMode","EditorWithStarsDarkModeAnimated"]]),[b,S]=i.useState(0),C=i.useRef(!0);i.useEffect((()=>{C.current&&(C.current=!1)}));const{theme:w,styles:k,animated:T,strings:x}=e,_=(0,d.v)(),I=C.current&&null!=T&&T,E=e.pages[b].icon,A=()=>{b>0&&S(b-1)},B=()=>{b<e.pages.length-1&&S(b+1)};return i.createElement(a.S,{style:Object.assign(Object.assign(Object.assign({},_.containerStyle),{paddingEnd:e.onDismiss?28:_.containerStyle.paddingEnd,borderRadius:null!==(o=null===(t=null==k?void 0:k.container)||void 0===t?void 0:t.borderRadius)&&void 0!==o?o:_.containerStyle.borderRadius,minWidth:null!==(p=null===(h=null==k?void 0:k.container)||void 0===h?void 0:h.minWidth)&&void 0!==p?p:_.containerStyle.minWidth,maxWidth:null!==(m=null===(f=null==k?void 0:k.container)||void 0===f?void 0:f.maxWidth)&&void 0!==m?m:_.containerStyle.maxWidth,backgroundImage:null!==(v=null==w?void 0:w.background)&&void 0!==v?v:"#FFFFFF"}),null==k?void 0:k.container)},i.createElement(a.S,{style:Object.assign(Object.assign({},_.dismissContainerStyle),null==k?void 0:k.dismissContainerStyle)},(()=>{if(e.onDismiss)return i.createElement(n.u,{theme:{background:{resting:"transparent"},title:{resting:"transparent"}},style:_.buttonStyle,onClick:e.onDismiss,automationLabel:""},i.createElement(r.In,{type:"Cancel",primaryColor:null==w?void 0:w.dismissColor,fontSize:12,fontWeight:s.IT.Bold}))})()),i.createElement(a.S,{direction:l.PR.LeftToRight,style:{zIndex:1}},(()=>{var t;if(!e.hideIcon)return i.createElement(a.S,{style:_.iconContainerStyle,justifyContent:l.Pr.SpaceBetween},i.createElement(r.In,{type:I&&null!==(t=y.get(E))&&void 0!==t?t:E,primaryColor:null==w?void 0:w.iconColor}))})(),i.createElement(a.S,{justifyContent:l.Pr.SpaceBetween,style:Object.assign(Object.assign({},_.textContainerStyle),null==k?void 0:k.textContainerStyle)},i.createElement(a.S,{direction:l.PR.LeftToRight,align:l.j5.Center},(()=>{var t,o;const n=e.pages[b].newTag;if(n)return i.createElement(a.S,{style:Object.assign(Object.assign({},_.newTagContainerStyle),{backgroundColor:null!==(t=null==w?void 0:w.newTag.background)&&void 0!==t?t:"#FFFFFF",boxShadow:null==w?void 0:w.newTag.shadow})},i.createElement(c.c,{style:Object.assign(Object.assign({},_.newTagTextStyle),{cssColor:null!==(o=null==w?void 0:w.newTag.textColor)&&void 0!==o?o:"#000000"}),text:n}))})(),(()=>{const t=e.pages[b].title;if(t)return i.createElement(a.S,{style:_.titleContainerStyle},i.createElement(c.c,{style:Object.assign(Object.assign({},_.titleTextStyle),{cssColor:null==w?void 0:w.textColor}),text:t}))})()),e.pages[b].content(_.contentContainerStyle,w))),(()=>{var t,o,s;if(1===e.pages.length)return;let u=null==w?void 0:w.pagination.textColor,d=null==w?void 0:w.pagination.textColor;return 0===b?u=null==w?void 0:w.pagination.arrow.disabledButtonColor:b===e.pages.length-1&&(d=null==w?void 0:w.pagination.arrow.disabledButtonColor),i.createElement(a.S,{style:Object.assign(Object.assign({},_.pageArrowContainerStyle),{zIndex:1}),direction:l.PR.LeftToRight,justifyContent:l.Pr.Center,align:l.j5.Center},i.createElement(n.u,{theme:{background:{resting:null!==(t=null==w?void 0:w.pagination.arrow.background.resting)&&void 0!==t?t:"transparent",hover:null==w?void 0:w.pagination.arrow.background.hover},title:{resting:"transparent"},tooltip:{backgroundColor:null==w?void 0:w.tooltip.background,textColor:null==w?void 0:w.tooltip.textColor}},style:_.buttonStyle,onClick:A,tooltip:x.footer("previousPageTooltip"),automationLabel:"",tooltipProps:{layerHostId:e.layerHostId}},i.createElement(r.In,{type:"Previous",primaryColor:u})),i.createElement(c.c,{style:Object.assign(Object.assign({},_.paginationTextStyle),{cssColor:null!==(o=null==w?void 0:w.pagination.textColor)&&void 0!==o?o:"black"}),text:(0,g.JT)(x.footer("paginationTipsText"),b+1,e.pages.length)}),i.createElement(n.u,{theme:{background:{resting:null!==(s=null==w?void 0:w.pagination.arrow.background.resting)&&void 0!==s?s:"transparent",hover:null==w?void 0:w.pagination.arrow.background.hover},title:{resting:"transparent"},tooltip:{backgroundColor:null==w?void 0:w.tooltip.background,textColor:null==w?void 0:w.tooltip.textColor}},style:_.buttonStyle,onClick:B,tooltip:x.footer("nextPageTooltip"),automationLabel:"",tooltipProps:{layerHostId:e.layerHostId}},i.createElement(r.In,{type:"Next",primaryColor:d})))})(),(()=>{if(I)return i.createElement(u.w,{theme:null==w?void 0:w.shimmer})})())}},20518:(e,t,o)=>{"use strict";if(o.d(t,{v:()=>n}),3023==o.j)var i=o(27326);const n=()=>({containerStyle:{position:"relative",borderRadius:8,paddingVertical:14,paddingStart:12,paddingEnd:12,maxWidth:309,minWidth:309,overflow:"hidden"},dismissContainerStyle:{position:"absolute",top:12.65,right:12.65,zIndex:2},iconContainerStyle:{marginEnd:12},textContainerStyle:{maxWidth:220},newTagContainerStyle:{borderRadius:3,paddingHorizontal:4,paddingVertical:2,marginEnd:8,marginBottom:4},newTagTextStyle:{fontSize:10,lineHeight:12},titleContainerStyle:{marginBottom:4},titleTextStyle:{fontSize:12,lineHeight:16,fontWeight:i.IT.SemiBold},contentContainerStyle:{fontSize:12,lineHeight:1.25},tryLinkContainerStyle:{marginTop:10},pageArrowContainerStyle:{marginTop:14,width:"100%"},paginationTextStyle:{fontSize:12,lineHeight:16,fontWeight:i.IT.SemiBold,marginHorizontal:13,marginVertical:0},buttonStyle:{paddingHorizontal:0,paddingVertical:0}})},30021:(e,t,o)=>{"use strict";o.d(t,{_:()=>A});var i=o(95734);if(3023==o.j)var n=o(75753);if(3023==o.j)var r=o(65315);if(3023==o.j)var s=o(89810);if(3023==o.j)var a=o(6143);if(3023==o.j)var l=o(72124);if(3023==o.j)var c=o(30760);if(3023==o.j)var u=o(5779);if(3023==o.j)var d=o(95389);if(3023==o.j)var g=o(47632);if(3023==o.j)var h=o(59523);if(3023==o.j)var p=o(67762);if(3023==o.j)var f=o(18876);if(3023==o.j)var m=o(53817);if(3023==o.j)var v=o(6209);if(3023==o.j)var y=o(85321);if(3023==o.j)var b=o(44943);if(3023==o.j)var S=o(10428);if(3023==o.j)var C=o(33719);if(3023==o.j)var w=o(33705);if(3023==o.j)var k=o(97928);if(3023==o.j)var T=o(7218);const x="overflow-expanded-ecc",_="uploadFileButton",I="eccFeedbackButton",E="eccSearchBar",A=({definition:e,theme:t,style:o,styles:A,strings:B,layerHostId:R,queryString:M,results:D,scopes:P,isError:N,isLoading:F,enablePrefixHighlighting:O,keyboardHandlerTarget:j,expandedKeyboardHandlerTarget:q,showMoreEntitiesConfig:L,browseThisComputerConfig:H,listID:z,disableTooltips:W,isFeedbackEnabledForEcc:G,isSmallWindow:U,isSmallHeight:V,enableResponsiveLayout:$,refocus:K,showPartialLoadingEntities:J,onGroupSelected:Z,onAction:Y,onFocusSuggestionList:Q,onItemSelected:X,onItemFocused:ee,onAfterUpdate:te,noSuggestionsHeaderInfo:oe,expandedEccSearchBarConfig:ie,showMeetingBanner:ne,enableMeetingBanner:re,meetingBannerText:se,isFeedbackButtonEnabled:ae,onFeedbackButtonClicked:le,isUnsupported:ce,locale:ue,useFURNTabList:de})=>{var ge,he,pe,fe,me;const ve=!!G&&!ae,ye=i.useContext(s.O),[be,Se]=i.useState(!1),Ce=()=>{Se(!be)},we=D.every((e=>!e.suggestions||0===e.suggestions.length)),[ke,Te]=i.useState([]),xe=i.useCallback((e=>{e.type===b.E9?e.id===b.Es?null==Y||Y(y.L.Retry):e.id===b.WM&&(it(""),null==Y||Y(y.L.ClearSearch)):X(e)}),[Y,X]),_e=null!=t?t:k.nk(void 0,ye),Ie=null!=o?o:r.Ss,Ee=(0,v.W)(A,Ie,U&&$),Ae=i.useRef(null),Be=i.useRef(null),Re=i.useRef(null),Me=i.useRef(null),De=i.useRef(null),Pe=i.useRef(null),Ne=i.useRef({groupLayouts:[]}),[Fe,Oe]=i.useState({value:0}),[je,qe]=i.useState({value:-1}),[Le,He]=i.useState(!1),[ze,We]=i.useState(!1),[Ge,Ue]=i.useState(!1),[Ve,$e]=i.useState(!1),[Ke,Je]=i.useState(!0),[Ze,Ye]=i.useState(!1),[Qe,Xe]=i.useState(),[et,tt]=i.useState(!1),[ot,it]=i.useState(""),[nt,rt]=i.useState(!1),[st,at]=i.useState(!1),[lt,ct]=i.useState(!1),[ut,dt]=i.useState(P.suggestions.length),[gt,ht]=i.useState(!1),pt=i.useRef(!0),[ft,mt]=i.useState(!1),[vt,yt]=i.useState(!1),bt=i.useRef(null),St=ke.reduce(((e,t)=>t.suggestions.length+e),0),Ct=i.useCallback((e=>{var t;Je(e),e&&(null==Q||Q(),null===(t=De.current)||void 0===t||t.focus())}),[Q,Je]),wt=i.useCallback((e=>{X(e),He(!1),Ct(!0),qe({value:_t(je.value,-1)}),Oe({value:It(je.value,0)})}),[X,He]);i.useEffect((()=>{if(-1===Fe.value)return void(Be.current=null);let e=0;for(const t of ke)e++,Fe.value>=e&&Fe.value<e+t.suggestions.length&&(Be.current=t.suggestions[Fe.value-e]),e+=t.suggestions.length}),[Fe,ke]),i.useEffect((()=>{!F&&Te((0,b.Oz)(F,N,we,B,D,oe,ce))}),[F,N,we,B,D,oe,ce]),i.useEffect((()=>{F||et&&(null==H?void 0:H.isBrowseThisComputerEnabled)||(Ke&&(It(Fe.value,0),Oe({value:0})),_t(je.value,-1),qe({value:-1}))}),[F,et,Ke,K,ke,H]),i.useEffect((()=>{ze&&Xe({top:0,bottom:0,isNewRender:!1})}),[ze]),i.useEffect((()=>{Ge&&Xe({top:0,bottom:0,isNewRender:!1})}),[Ge]),i.useEffect((()=>{Ae.current&&(clearTimeout(Ae.current),Ae.current=null),F?ke&&ke.length?Ae.current=setTimeout((()=>Ye(!0)),b.al):Ye(!0):Ye(!1)}),[F,ke]),i.useEffect((()=>{te&&e&&te(e)}));const kt=i.useCallback(((e,t)=>{t.type===b.E9?t.id===b.Es?null==ee||ee({focusedItemHtmlId:b.E9,selection:{type:"retryButton"}}):t.id===b.WM&&(null==ee||ee({focusedItemHtmlId:b.E9,selection:{type:"clearSearchButton"}})):null==ee||ee({focusedItemHtmlId:(0,b.Bn)(e),selection:{type:"item",item:t,positionInSet:e,setSize:St}})}),[ee,St]),Tt=(e,t)=>{var o,i,n,r,s;let a=0;const l={top:0,bottom:0};for(let c=0;c<ke.length;c++){const u=ke[c];l.top=l.bottom+(null===(o=Ne.current.groupLayouts[c])||void 0===o?void 0:o.separatorHeight),l.bottom=l.top+(null===(i=Ne.current.groupLayouts[c])||void 0===i?void 0:i.headerHeight);for(let o=0;o<u.suggestions.length;o++){const i=u.suggestions[o];if(0!==o&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(r=null===(n=Ne.current.groupLayouts[c])||void 0===n?void 0:n.itemHeights[o])&&void 0!==r?r:0),o===u.suggestions.length-1&&(l.bottom+=null===(s=Ne.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return i.isHighlighted=t,t&&(Xe(Object.assign(Object.assign({},l),{isNewRender:pt.current})),pt.current=!1,kt(e,i)),void Te((e=>(c<e.length&&(e[c].isHighlighted=t),e)));a++}}},xt=(e,t)=>{e>=0&&e<P.suggestions.length&&(P.suggestions[e].isHighlighted=t)},_t=(e,t)=>(e>=0&&xt(e,!1),t<0?-1:(t%=P.suggestions.length,xt(t,!0),null==ee||ee({focusedItemHtmlId:(0,b.Bn)(t,!0),selection:{type:"scope",scope:P.suggestions[t],positionInSet:t,setSize:P.suggestions.length}}),t)),It=(e,t)=>(e>=0&&Tt(e,!1),t<0?-1:(Tt(t%=St,!0),t)),Et=()=>{var e;tt(!0),rt(!1),null===(e=null==L?void 0:L.onClickShowMoreEntities)||void 0===e||e.call(L,!0),Oe({value:-1})},At=e=>{switch(e){case a.h.ArrowDown:nt?(rt(!1),Ct(!0),Oe({value:It(-1,0)})):(Tt(Fe.value,!1),rt(!0),Ct(!1),Xe({top:1e4,bottom:1e4,isNewRender:!1}));break;case a.h.ArrowUp:nt?(rt(!1),Ct(!0),Oe({value:It(-1,St-1)})):(Tt(Fe.value,!1),rt(!0),Ct(!1),Xe({top:1e4,bottom:1e4,isNewRender:!1}));break;case a.h.Enter:case a.h.Tab:Et()}},Bt=e=>{var t;switch(e){case a.h.ArrowDown:return at(!0),We(!1),Ct(!0),Oe({value:It(je.value,0)}),!0;case a.h.ArrowUp:return at(!0),We(!1),Ct(!0),Oe({value:It(je.value,St-1)}),!0;case a.h.Tab:return Rt(),!0;case a.h.Enter:return Se(!be),null===(t=null==H?void 0:H.onClickBrowseThisComputer)||void 0===t||t.call(H),!0}return!1},Rt=()=>{var e;at(!0),Le||ft?(He(!1),qe({value:_t(je.value,-1)}),mt(!1),ae?($e(!0),null==ee||ee({focusedItemHtmlId:I})):(null==H?void 0:H.isUploadFileButtonEnabled)?(We(!0),null==ee||ee({focusedItemHtmlId:_})):(null==ie?void 0:ie.enableExpandedECCSearchBar)?(Ue(!0),null==ee||ee({focusedItemHtmlId:E})):(Ct(!0),Oe({value:It(je.value,0)}))):Ve?($e(!1),(null==H?void 0:H.isUploadFileButtonEnabled)?(We(!0),null==ee||ee({focusedItemHtmlId:_})):(null==ie?void 0:ie.enableExpandedECCSearchBar)?(Ue(!0),null==ee||ee({focusedItemHtmlId:E})):(Ct(!0),Oe({value:It(je.value,0)}))):ze?(We(!1),(null==ie?void 0:ie.enableExpandedECCSearchBar)?(Ue(!0),null==ee||ee({focusedItemHtmlId:E})):(null===(e=De.current)||void 0===e||e.focus(),Ct(!0),Oe({value:It(je.value,0)}))):Ge?(Ue(!1),Ct(!0),Oe({value:It(je.value,0)})):(He(!0),Ct(!1),Oe({value:It(Fe.value,-1)}),qe({value:_t(je.value,0)}))},Mt=e=>Dt(e,!1),Dt=(e,t)=>{var o,i,n,r,s,l;if(e!==a.h.ArrowDown&&e!==a.h.ArrowUp&&e!==a.h.ArrowLeft&&e!==a.h.ArrowRight&&e!==a.h.Enter&&e!==a.h.Tab&&e!==a.h.Home&&e!==a.h.End)return!1;if(t&&e!==a.h.ArrowDown&&e!==a.h.ArrowUp)return!1;if(Le)return(e=>{switch(e){case a.h.ArrowLeft:{at(!0);let e=je.value-1;return e<0&&(lt?(mt(!0),He(!1),null==ee||ee({focusedItemHtmlId:x}),e=-1):e=ut-1),qe({value:_t(je.value,e)}),!0}case a.h.ArrowRight:{at(!0);let e=je.value+1;return e>=ut&&(lt?(mt(!0),He(!1),null==ee||ee({focusedItemHtmlId:x}),e=-1):e=0),qe({value:_t(je.value,e)}),!0}case a.h.ArrowDown:return at(!0),He(!1),Ct(!0),qe({value:_t(je.value,-1)}),Oe({value:It(je.value,0)}),!0;case a.h.ArrowUp:return at(!0),He(!1),Ct(!0),qe({value:_t(je.value,-1)}),Oe({value:It(je.value,St-1)}),!0;case a.h.Tab:return Rt(),!0;case a.h.Enter:return!de&&(je.value>=0&&je.value<P.suggestions.length&&(He(!1),Ct(!0),X(P.suggestions[je.value])),!0)}return!1})(e);if(ft)return(e=>{switch(e){case a.h.ArrowLeft:return at(!0),He(!0),mt(!1),qe({value:_t(je.value,ut-1)}),!0;case a.h.ArrowRight:return at(!0),He(!0),mt(!1),qe({value:_t(je.value,0)}),!0;case a.h.ArrowDown:return at(!0),mt(!1),Ct(!0),Oe({value:It(je.value,0)}),null==ee||ee({focusedItemHtmlId:x+je.value}),!0;case a.h.ArrowUp:return at(!0),mt(!1),Ct(!0),Oe({value:It(je.value,St-1)}),null==ee||ee({focusedItemHtmlId:x+je.value}),!0;case a.h.Tab:return Rt(),!0;case a.h.Enter:return yt(!0),null==ee||ee({focusedItemHtmlId:x+0}),!0}return!1})(e);if(ze)return Bt(e);if(Ge)return e===a.h.Tab&&(Rt(),!0);if(Ve)return(e=>{switch(e){case a.h.ArrowDown:return at(!0),$e(!1),Ct(!0),Oe({value:It(je.value,0)}),!0;case a.h.ArrowUp:return at(!0),$e(!1),Ct(!0),Oe({value:It(je.value,St-1)}),!0;case a.h.Tab:return Rt(),!0;case a.h.Enter:return null==le||le(),!0}return!1})(e);switch(e){case a.h.ArrowDown:if(at(!0),t){Le&&(null===(o=bt.current)||void 0===o||o.focus(1)),!Le&&(null===(i=Me.current)||void 0===i||i.focus(je.value)),ht(!0),Oe({value:It(Fe.value,-1)}),Ct(!1),He(!0),de&&(null===(n=Pe.current)||void 0===n||n.focus());const e=P.suggestions.findIndex((e=>e.isSelected));qe({value:_t(je.value,e)})}else if(Fe.value===St-1||nt)if((null==L?void 0:L.isShowMoreEntitiesEnabled)&&!et)At(e);else{if(!(null==H?void 0:H.isBrowseThisComputerEnabled))return!0;Bt(e)}else{const e=It(Fe.value,Fe.value+1);Oe({value:e})}break;case a.h.ArrowUp:if(t)if(Le&&(null===(r=bt.current)||void 0===r||r.focus(1)),!Le&&(null===(s=Me.current)||void 0===s||s.focus(je.value)),ht(!0),Oe({value:It(Fe.value,-1)}),Ct(!1),null==H?void 0:H.isUploadFileButtonEnabled)We(!0);else{He(!0),de&&(null===(l=Pe.current)||void 0===l||l.focus());const e=P.suggestions.findIndex((e=>e.isSelected));qe({value:_t(je.value,e)})}else{if(at(!0),0===Fe.value&&et)return!0;if(0===Fe.value||nt){if(!(nt||0===Fe.value&&(null==L?void 0:L.isShowMoreEntitiesEnabled)&&!et))return!0;At(e)}else Oe({value:It(Fe.value,0===Fe.value?(St||1)-1:Fe.value-1)})}break;case a.h.Home:at(!0),Oe({value:It(Fe.value,0)});break;case a.h.End:at(!0),Oe({value:It(Fe.value,St-1)});break;case a.h.Enter:if(nt){At(e);break}if(F&&Be.current)xe(Be.current);else{let e=0;ke.forEach((t=>{Fe.value>=e&&Fe.value<e+t.suggestions.length&&xe(t.suggestions[Fe.value-e]),e+=t.suggestions.length}))}break;case a.h.Tab:if(!gt)return!1;Rt();break;case a.h.ArrowLeft:case a.h.ArrowRight:default:return!1}return!0},Pt=e=>{(gt||!j&&!q)&&Dt(e.key,e.alt)},Nt=i.useCallback((e=>{e(Ne.current)}),[]);i.useEffect((()=>void 0!==q?(q.setKeyPressHandler(Dt),()=>{q.setKeyPressHandler(void 0)}):(null==j||j.setKeyPressHandler(Mt),()=>{null==j||j.setKeyPressHandler(void 0)})));const Ft=Ee.containerStyles||{},{paddingStart:Ot,paddingEnd:jt,paddingHorizontal:qt,paddingTop:Lt,paddingBottom:Ht,paddingVertical:zt,paddingScrollTop:Wt,scrollbarThumbWidth:Gt}=Ft,Ut=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(Ft,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth"]),Vt=(null==L?void 0:L.isShowMoreEntitiesEnabled)&&!et&&!(N||we||ce),$t=V?"30%":250,Kt=P.suggestions.findIndex((e=>e.isSelected)),[Jt,Zt]=i.useState(null===(ge=P.suggestions[Kt])||void 0===ge?void 0:ge.id);i.useEffect((()=>{var e;Zt(null===(e=P.suggestions[Kt])||void 0===e?void 0:e.id)}),[Kt]);const Yt=P.suggestions.map((e=>{var t;return{label:null!==(t=e.title)&&void 0!==t?t:"",tabKey:e.id,overflowPriority:e.id===Jt?1:0}})),Qt=i.useCallback((e=>{for(let t=0;t<P.suggestions.length;t++)if(P.suggestions[t].id===e){wt(P.suggestions[t]);break}Zt(e)}),[P,wt,Zt]);return i.createElement(l.S,{style:Object.assign(Object.assign(Object.assign({},n.uI(_e,void 0,{useFluentV9:ye})),Ut),{hideFocusBox:!0}),align:c.j5.Stretch,focusable:!0,ref:De,onKeyDown:Pt,handledKeys:[a.h.ArrowDown,a.h.ArrowUp,a.h.ArrowLeft,a.h.ArrowRight,a.h.Enter,a.h.Tab,a.h.Home,a.h.End],accessibilityRole:Ze||N||we||ce?void 0:"application",accessible:!0,accessibilityLabel:B.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:z},i.createElement(u.R,{disableInitialFocus:!0},i.createElement(l.S,{style:{minHeight:44,marginVertical:2,marginEnd:12},ref:Re,direction:c.PR.LeftToRight,align:c.j5.Center},de?i.createElement(l.S,{accessibilityRole:"tablist",direction:c.PR.LeftToRight,align:c.j5.Center,accessible:!0,ref:Me,style:{flexibleSize:!0}},i.createElement(d.w,{overflow:!0,selectedKey:Jt,onTabSelect:Qt,theme:k.T_(_e),style:r.vC(Ee),items:Yt,ref:Pe})):i.createElement(l.S,{accessibilityRole:"tablist",direction:c.PR.LeftToRight,align:c.j5.Center,accessible:!0,ref:Me},i.createElement(m.U,{theme:_e,headerRef:Re,headerScopesRef:Me,styles:(0,v.o)(A,Ie),overflowUid:x,strings:B,scopes:P,groupLayouts:Ne.current.groupLayouts,itemQueryString:M,onGroupSelected:Z,onItemSelected:wt,onOverflowCalculated:(e,t)=>{ct(e||ve),dt(e?t:P.suggestions.length)},isOverflowHighlighted:ft,isOverflowMenuOpened:vt,onOverflowClose:e=>{var t;e||(null===(t=bt.current)||void 0===t||t.focus(),mt(!1),Ct(!0),qe({value:_t(je.value,-1)}),He(!1)),yt(!1)},enablePrefixHighlighting:O,hasSelectionBeenModifiedViaKeyboard:st,layerHostId:R,isFeedbackEnabledForEcc:ve,isSmallWindow:U,enableResponsiveLayout:$})),(null==H?void 0:H.isUploadFileButtonEnabled)||ae?i.createElement(g.q.Consumer,null,(e=>i.createElement(l.S,{nativeID:"uploadFileButtonContainer",style:de?{}:e?{position:"absolute",left:12}:{position:"absolute",right:12}},i.createElement(l.S,{accessibilityRole:"menu",accessibilityLabel:null==B?void 0:B.inlineSuggestions("expandedInlineSuggestionsFeedbackButtonAndUploadButtonGroupLabel"),accessible:!0,direction:c.PR.LeftToRight,align:c.j5.Center},ae?i.createElement(h.u,{htmlId:I,style:r.gl,accessibilityRole:"menuitem",accessibilityLabel:B.inlineSuggestions("feedbackText"),automationLabel:"InlineSuggestionsFeedback",icon:{type:"ECCFeedback",style:r.p},title:void 0,onClick:le,theme:k.$d(_e,Ve),isSelectedByKeyboard:st}):null,(null==H?void 0:H.isUploadFileButtonEnabled)?i.createElement(w.Y,Object.assign({handledKeys:[a.h.Enter,a.h.Tab,a.h.Home,a.h.End],onKeyDown:Pt,strings:B,isUploadButtonHighlighted:ze,hasSelectionBeenModifiedViaKeyboard:st,theme:k.wK(_e,ze),iconOnly:U&&$,open:be,onOpenChange:Ce},H)):null)))):null),i.createElement(p.w,null),et&&i.createElement(l.S,{direction:c.PR.LeftToRight},i.createElement(l.S,{style:{flexibleSize:!1}},i.createElement(h.u,{style:r.Ek,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;tt(!1),null===(e=null==L?void 0:L.onCloseShowMoreEntities)||void 0===e||e.call(L,!1),Oe({value:0})},theme:k.VD(_e),icon:{type:"ChevronLeftMed",style:r.dt}}),i.createElement(C.y,{theme:_e,style:null==A?void 0:A.searchBoxStyles,htmlId:null==L?void 0:L.searchBoxHtmlId,autoFocus:!0,handledKeys:[a.h.ArrowDown,a.h.ArrowUp,a.h.Enter,a.h.Tab,a.h.Home,a.h.End],onKeyDown:Pt,placeholder:(null==L?void 0:L.searchBoxPlaceHolder)||"",value:ot,onValueChange:e=>{var t;it(e),null===(t=null==L?void 0:L.onSearchChange)||void 0===t||t.call(L,e)},onClear:()=>{var e;it(""),null===(e=null==L?void 0:L.onSearchClear)||void 0===e||e.call(L)}}))),(null==ie?void 0:ie.enableExpandedECCSearchBar)&&i.createElement(l.S,{direction:c.PR.LeftToRight},i.createElement(T.V,{placeholder:(null==B?void 0:B.inlineSuggestions("expandedInlineSuggestionsSearchBarPlaceholder"))||"",onValueChange:e=>{var t;it(e),null===(t=null==ie?void 0:ie.onSearchChange)||void 0===t||t.call(ie,e)},onClear:()=>{var e;it(""),null===(e=null==ie?void 0:ie.onSearchClear)||void 0===e||e.call(ie)},dismiss:null,accessibilityLabel:(null==B?void 0:B.inlineSuggestions("expandedInlineSuggestionsSearchBarPlaceholder"))||"",theme:_e,style:Ie,htmlId:null==ie?void 0:ie.searchBoxHtmlId,autoFocus:null==ie?void 0:ie.autoFocus,handledKeys:[a.h.ArrowDown,a.h.ArrowUp,a.h.Enter,a.h.Tab,a.h.Home,a.h.End],onKeyDown:Pt,value:ot,showIcon:!0,isSearchBoxHighlighted:Ge,hideDismiss:ie.hideDismiss})),i.createElement(l.S,{nativeID:"inlineSuggestionsEnclosingDiv",accessible:!0,accessibilityLabel:(0===Kt?`${B.inlineSuggestions("startTypingToSearch")} `:"").concat((null!==(he=B.inlineSuggestions("tabAriaLabel"))&&void 0!==he?he:"{0} tab, press alt + down to change tabs").replace("{0}",null!==(fe=null===(pe=P.suggestions[Kt])||void 0===pe?void 0:pe.title)&&void 0!==fe?fe:"")),accessibilityRole:"menu",style:{position:"relative",maxHeight:$t}},i.createElement(f.B,{scrollDirection:"vertical",style:{paddingStart:Ot,paddingEnd:jt,paddingHorizontal:qt,paddingTop:Lt,paddingBottom:Ht,paddingVertical:zt,paddingScrollTop:Wt,scrollbarThumbWidth:Gt,borderRadius:Ut.borderRadius,width:"100%"},theme:{thumbColor:null===(me=null==_e?void 0:_e.scroll)||void 0===me?void 0:me.thumbColor},scrollTo:Qe,alwaysShowScrollbar:!0,hidden:Ze},i.createElement(S.p,{theme:_e,suggestionsRef:bt,styles:Ee,strings:B,locale:ue,results:ke,isShimmerVisible:Ze,showPartialLoadingEntities:J,enableScopedHeader:!1,itemsCount:St,updateMenuLayout:Nt,itemQueryString:M,onGroupSelected:Z,onItemSelected:xe,enablePrefixHighlighting:O,isGroupHeaderVisible:!1,hasSelectionBeenModifiedViaKeyboard:st,layerHostId:R,disableTooltips:W,showMeetingBanner:ne,enableMeetingBanner:re,meetingBannerText:se,isSmallWindow:U}))),Vt&&i.createElement(h.u,{automationLabel:"InlineSuggestionMoreEntitiesButton",title:L.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:k.zN(_e,nt),onClick:Et})))}},53817:(e,t,o)=>{"use strict";o.d(t,{U:()=>u});var i=o(95734),n=o(89810),r=o(47632),s=o(16563),a=o(97928);const l=i.memo((({group:e,onItemSelected:t,overflowIndex:o,theme:r,isFeedbackEnabledForEcc:l,strings:c,isHighlighted:u,isOpen:d,onOverflowClose:g,overflowUid:h})=>{const p=i.useContext(n.O);r||(r=a.nk(void 0,p));let f=[];o&&o>0&&(f=e.suggestions.slice(o,e.suggestions.length).filter((e=>!!e.title)).map(((e,t)=>{var o;return{title:e.title,type:"item",key:t.toString(),entityType:null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType}})));const m=a.JE(r,u),v={title:r.text,background:r.background};if(l){f.length&&f.push({type:"separator",key:"separator"});const e=f.length?f.length-1:0;f.push({type:"item",title:c.inlineSuggestions("feedbackText"),key:e.toString()})}return f.length?i.createElement(s.o,{items:f,onClick:t,shouldFocusButtonOnDismiss:!1,hasKeyboardFocus:u,theme:v,buttonOnlyTheme:m,itemTheme:v,id:h,icon:{type:"Overflow",filled:!1},automationLabelType:"",automationId:"",startOpen:d,onTabClose:!0,onMenuDismiss:g,accessibilityLabel:c.inlineSuggestions("overflowTabAriaLabel")}):null}));l.displayName="ExpandedInlineSuggestionsOverflow";var c=o(54e3);const u=i.memo((({theme:e,styles:t,strings:o,scopes:s,enablePrefixHighlighting:u,layerHostId:g,groupLayouts:h,itemQueryString:p,hasSelectionBeenModifiedViaKeyboard:f,isFeedbackEnabledForEcc:m,isSmallWindow:v,enableResponsiveLayout:y,overflowUid:b,headerRef:S,headerScopesRef:C,onGroupSelected:w,onItemSelected:k,onOverflowCalculated:T,isOverflowHighlighted:x,isOverflowMenuOpened:_,onOverflowClose:I})=>{var E,A,B;const R=i.useContext(n.O),M=null!=e?e:a.nk(void 0,R);let D=0;const[P,N]=i.useState(0),[F,O]=i.useState(0),j=function(e){const t=i.useRef();return i.useEffect((()=>{t.current=e})),t.current}(v),q=null===(E=S.current)||void 0===E?void 0:E.el(),L=null===(A=C.current)||void 0===A?void 0:A.el(),H=document.getElementById("uploadFileButtonContainer"),z=H?H.clientWidth+12:0,W=null!==(B=null==q?void 0:q.clientWidth)&&void 0!==B?B:0;return i.useEffect((()=>{if(y&&(0===P||j!==v||(null==q?void 0:q.clientWidth)&&F>=q.clientWidth)){const e=d(q,z,L);null==T||T(0!==e[0],e[0]),N(e[0]),O(e[1])}}),[y,P,j,v,F,T,q]),i.useEffect((()=>{if(!y){const e=d(q,z,L);D=e[0],N(D),O(e[1]),null==T||T(0!==D,D)}}),[W]),D=P,i.createElement(i.Fragment,null,i.createElement(c.K,{theme:M,strings:o,key:"scopes",group:s,layerHostId:g,accessibilitySetSize:s.suggestions.length,headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:0,accessibilityRole:"tab",enablePrefixHighlighting:u,onHeaderClick:()=>null==w?void 0:w(s),onHeaderHeightChange:e=>{h[0]||(h[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),h[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{h[0]||(h[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),h[0].extraSpaceBottomHeight=e},onSeparatorHeightChange:e=>{h[0]||(h[0]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),h[0].separatorHeight=e},itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:p,onItemSelected:k,onItemHeightChange:(e,t)=>{h[0]||(h[0]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),h[0].itemHeights[t]=e},showSeparator:!1,separatorProps:void 0,hasSelectionBeenModifiedViaKeyboard:f,disableTooltips:!0,enableExpandedECCScopeLayout:!0,overflowIndex:y?P:D}),y&&0===P&&!m||!y&&0===D&&!m?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,i.createElement(r.q.Consumer,null,(e=>i.createElement("div",{style:0!==F&&y?e?{position:"absolute",right:F}:{position:"absolute",left:F}:{}},i.createElement(l,{overflowIndex:y?P:D,group:s,onItemSelected:k,theme:M,isFeedbackEnabledForEcc:m,strings:o,isHighlighted:x,isOpen:_,onOverflowClose:I,overflowUid:b}))))))})),d=(e,t,o)=>{if(!e||!o)return[0,0];const i=(null==e?void 0:e.clientWidth)-38-t,n=Array.from(o.children);let r=0,s=0;for(let e=0;e<n.length;e++){if(!(n[e].clientWidth+r<i)){s=e;break}r+=n[e].clientWidth}return[s,r]}},7218:(e,t,o)=>{"use strict";o.d(t,{V:()=>s});var i=o(95734),n=o(72124),r=o(29088);const s=i.memo((e=>{var t,o,s,a,l,c,{theme:u,accessibilityLabel:d}=e,g=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["theme","accessibilityLabel"]);return i.createElement(i.Fragment,null,i.createElement(n.S,{style:{marginTop:10,marginStart:12,marginEnd:12,width:"100%",minWidth:0}},i.createElement(r.G,Object.assign({},g,{autoComplete:!1,spellCheck:!1,accessibilityLabel:d,styles:{borderRadius:4,width:"100%",borderBottom:`${null===(t=null==u?void 0:u.searchBox)||void 0===t?void 0:t.borderBottomColor} solid 3px`},theme:{iconColor:null===(o=null==u?void 0:u.searchBox)||void 0===o?void 0:o.iconColor,borderColor:{hover:null===(a=null===(s=null==u?void 0:u.searchBox)||void 0===s?void 0:s.borderColor)||void 0===a?void 0:a.hover,resting:null===(c=null===(l=null==u?void 0:u.searchBox)||void 0===l?void 0:l.borderColor)||void 0===c?void 0:c.resting}}}))))}));s.displayName="ExpandedInlineSuggestionsSearchBox"},6209:(e,t,o)=>{"use strict";if(o.d(t,{W:()=>r,o:()=>s}),3023==o.j)var i=o(75753);if(3023==o.j)var n=o(65315);const r=(e={},t,o)=>({containerStyles:a(e.containerStyles,t,o),shimmerStyles:l(e),headerStyles:c(e.headerStyles),itemsStyles:d(e.itemsStyles,t),footerStyles:C(e.footerStyles)}),s=(e={},t)=>({containerStyles:a(e.containerStyles,t),shimmerStyles:l(e),headerStyles:c(e.headerStyles),itemsStyles:d(e.itemsStyles,t),footerStyles:C(e.footerStyles)}),a=(e={},t,o)=>{var i,n,r;return Object.assign({minWidth:o?304:null!==(i=null==t?void 0:t.menuMaxWidth)&&void 0!==i?i:480,maxWidth:o?304:null!==(n=null==t?void 0:t.menuMaxWidth)&&void 0!==n?n:480,minHeight:100,maxHeight:o?280:null!==(r=null==t?void 0:t.menuHeight)&&void 0!==r?r:300,paddingHorizontal:4,paddingTop:4,paddingBottom:4,marginEnd:10,scrollbarThumbWidth:10},e)},l=(e={})=>{var t,o,i,n,r,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({titleLineHeight:null!==(i=null===(o=null==e?void 0:e.headerStyles)||void 0===o?void 0:o.titleLineHeight)&&void 0!==i?i:16,itemPaddingVertical:null!==(n=null==l?void 0:l.paddingVertical)&&void 0!==n?n:6,itemPaddingHorizontal:null!==(r=null==l?void 0:l.paddingHorizontal)&&void 0!==r?r:12,textPaddingLeft:null!==(s=null==l?void 0:l.textPaddingStart)&&void 0!==s?s:8,personaCoinSize:null!==(a=null==l?void 0:l.personaCoinSize)&&void 0!==a?a:32},e.shimmerStyles)},c=(e={})=>Object.assign({},e),u=(e={},t={},o={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),n.ZD.item),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),n.ZD.description),t),e.description)}),d=(e={},t)=>({genericItemStyles:p(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:f(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:m(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:v(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:y(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:b(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:S(e.chatItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:u(e.noSuggestionsStyles,e.sharedItemStyles,t)}),g=e=>{var t,o;return Object.assign(Object.assign({},n.cK),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:n.cK.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:n.cK.height})},h=e=>Object.assign(Object.assign({},n.nI),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),p=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},f=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:32}),t),e),{paddingVertical:6})},m=(e={},t={},o)=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles),{backgroundColor:"#EBEBEB",borderRadius:20})}),{paddingVertical:6}),v=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{height:40,iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)}),{paddingHorizontal:12,paddingVertical:10})},y=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},h(o)),{width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"}),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},b=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},h(o)),{width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"}),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},S=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:32}),t),e),{iconStyles:Object.assign({width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"},null==e?void 0:e.iconStyles)}),{paddingVertical:6})},C=(e={})=>Object.assign(Object.assign(Object.assign({},i.Y_),{height:40,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},65315:(e,t,o)=>{"use strict";o.d(t,{B3:()=>v,Ek:()=>m,Js:()=>r,L_:()=>S,MG:()=>T,RR:()=>p,Ss:()=>s,XC:()=>y,ZD:()=>x,cK:()=>a,dm:()=>b,dt:()=>f,g4:()=>k,gl:()=>d,mX:()=>h,nI:()=>u,p:()=>g,v9:()=>C,vC:()=>w,z0:()=>c,zx:()=>l});var i=o(27326);if(3023==o.j)var n=o(74505);const r={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:24,menuHeight:252},s={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:32,menuHeight:300},a={flexibleSize:!0,borderRadius:4},l={width:300,maxHeight:48};function c(e){const t=Object.assign(Object.assign({},u),{margin:8}),o={borderRadius:4,paddingHorizontal:1,paddingVertical:1,fontWeight:i.IT.Bold,height:35,border:"1px solid var(--color-neutral-stroke-1-rest, #D1D1D1)"};return e?Object.assign(Object.assign({},u),{minWidth:"unset",style:{width:32,borderRadius:4,paddingHorizontal:6,paddingVertical:6,fontWeight:i.IT.Bold,height:32,border:"1px solid var(--color-neutral-stroke-1-rest, #D1D1D1)"}}):{icon:Object.assign(Object.assign({},t),{marginRight:0}),style:Object.assign({width:100},o)}}i.IT.Bold;const u={width:24,height:24,minWidth:24},d={width:24,height:30,marginHorizontal:12,paddingHorizontal:0,paddingVertical:0},g={width:16,height:16,margin:2};function h(e,t){var o,n,r,s,a,l,c,u,d;return{containerStyles:{paddingHorizontal:null!==(o=null==t?void 0:t.paddingHorizontal)&&void 0!==o?o:2,paddingVertical:null!==(n=null==t?void 0:t.paddingVertical)&&void 0!==n?n:6,minWidth:null!==(r=null==t?void 0:t.minWidth)&&void 0!==r?r:33,height:null!==(s=null==t?void 0:t.height)&&void 0!==s?s:18,backgroundColor:null===(a=e.tag)||void 0===a?void 0:a.background,borderRadius:null!==(l=null==t?void 0:t.borderRadius)&&void 0!==l?l:4},textStyles:{width:null!==(c=null==t?void 0:t.minWidth)&&void 0!==c?c:33,height:(null==t?void 0:t.height)?(null==t?void 0:t.height)-4:20,fontSize:null!==(u=null==t?void 0:t.fontSize)&&void 0!==u?u:10,cssColor:null===(d=e.tag)||void 0===d?void 0:d.textColor,fontFamily:"Segoe UI",fontWeight:i.IT.Bold,textAlign:"center"}}}const p=Object.assign(Object.assign({},u),{margin:8}),f=(Object.assign(Object.assign({},u),{margin:8,marginRight:0}),{marginTop:6,fontSize:20}),m={paddingHorizontal:12};function v(e,t,o){var r,s;return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:o.xsmall,paddingHorizontal:8,marginVertical:null!==(r=t.headerMarginVertical)&&void 0!==r?r:4,cssColor:e.text.resting,lineHeight:null!==(s=t.headerLineHeight)&&void 0!==s?s:20}}function y(e,t,o){var r,s,a;return{fontWeight:i.IT.Normal,fontFamily:n.V,fontSize:o.xsmall,marginTop:0,marginBottom:null!==(r=t.headerMarginVertical)&&void 0!==r?r:4,paddingHorizontal:8,cssColor:null!==(a=null===(s=e.altText)||void 0===s?void 0:s.resting)&&void 0!==a?a:"#605e5c"}}function b(e,t){return{fontWeight:i.IT.Normal,fontFamily:n.V,fontSize:t.small,cssColor:e,lineHeight:20}}function S(e){const t={};return e&&(t.borderWidth={top:0,end:0,start:0,bottom:1},t.borderStyle="solid"),t}function C(){return{fontSize:12,fontWeight:600}}function w(e){var t;return{overflow:{width:null===(t=e.containerStyles)||void 0===t?void 0:t.maxWidth}}}const k={style:{marginStart:-8,marginEnd:-12,marginTop:8,marginBottom:8,height:1}},T={paddingTop:12,paddingBottom:8,paddingHorizontal:12},x={description:T,item:{paddingVertical:8,paddingStart:4,borderRadius:8}}},69931:(e,t,o)=>{"use strict";o.d(t,{i:()=>l});var i=o(95734),n=o(72124),r=o(30760),s=o(59523),a=o(65315);const l=i.memo((e=>{var{strings:t,theme:o,browseThisComputerButtonLabel:l,isBrowseThisComputerEnabled:c,onClickBrowseThisComputer:u,hasSelectionBeenModifiedViaKeyboard:d}=e,g=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["strings","theme","browseThisComputerButtonLabel","isBrowseThisComputerEnabled","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard"]);return i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Stretch},i.createElement(s.u,Object.assign({},g,{style:a.zx,accessibilityRole:"option",automationLabel:"InlineSuggestionsBrowseThisComputer",title:l,icon:{type:"Laptop",style:a.RR},onClick:u,hasKeyboardFocus:c,theme:o,isSelectedByKeyboard:c&&d})))}));l.displayName="InlineSuggestionsBrowseThisComputer"},54e3:(e,t,o)=>{"use strict";o.d(t,{K:()=>A});var i=o(95734),n=o(67762),r=o(36865),s=o(39386),a=o(43463),l=o(27326),c=o(89810),u=o(62670),d=o(30368),g=o(59523),h=o(75753),p=o(65315),f=o(58743),m=o(97928),v=o(5232);function y(e,t){if(!t)return;e=e.toLocaleLowerCase();const o=(t=t.toLocaleLowerCase()).indexOf(e);return o<0?void 0:[{start:o,length:e.length,fontWeight:l.IT.SemiBold,wrapMode:l.bd.NoWrap}]}function b(e,t,o){if(!e)return;const i=o?null==t?void 0:t.filter((e=>e.propertyHit===o)):t,n=[];return i&&i.forEach((e=>{n.push({start:e.offset,length:e.word.length,fontWeight:l.IT.SemiBold,wrapMode:l.bd.NoWrap})})),n}const S=({htmlId:e,theme:t,style:o,strings:n,suggestionId:r,suggestionType:l,queryString:S,title:C,titleFontSize:w,subtitle:k,subtitleFontSize:T,truncateSubtitle:x,tooltip:_,icon:I,layerHostId:E,personaCoinProps:A,isHighlighted:B,hasSelectionBeenModifiedViaKeyboard:R,showKeyboardTooltip:M,isInitialSelection:D,accessibilityRole:P,accessibilityPositionInSet:N,accessibilitySetSize:F,disableAccessibilityExpanded:O,onHeightChange:j,onHoverIn:q,onClick:L,enablePrefixHighlighting:H,hitHighlightIndexes:z,displayNewItemTag:W,newItemTagStyles:G,disableTooltips:U,enableExpandedECCScopeLayout:V,isScopeSelected:$,isDisabled:K,updateItemHeight:J})=>{var Z,Y,Q,X,ee,te,oe,ie,ne,re,se,ae,le;const ce=i.useContext(c.O),ue=l===s.c.Topic,de=null!=t?t:m.nk(void 0,ce);let ge=u.A.rightCenter;switch(null===(Z=null==de?void 0:de.tooltip)||void 0===Z?void 0:Z.directionHint){case a.A8.centered:ge=void 0;break;case a.A8.rightCenter:ge=u.A.rightCenter;break;case a.A8.bottomCenter:ge=u.A.bottomCenter;break;default:ge=ue?u.A.rightCenter:void 0}const he=m.yi(l,t,B);let pe=C&&k?(0,f.w)(n,C,k):C;W&&(pe=n.inlineSuggestions("combineTag").replace("{0}",null!=pe?pe:"").replace("{1}",n.inlineSuggestions("newTagText")));const{borderThickness:fe,shadows:me}=(0,v.j)(o,ce?(0,d.I)()?"Highlight":null!==(Y=de.focusRing)&&void 0!==Y?Y:"var(--colorStrokeFocus2)":null!==(Q=he.border)&&void 0!==Q?Q:"#000",null!=D&&D,null!=R&&R,null!=B&&B,{useFluentV9:ce});return i.createElement(g.u,{appearance:"subtle",htmlId:e,onClick:L,onHoverIn:q,accessibilityLabel:pe,accessibilityRole:P,accessibilityPositionInSet:N,accessibilitySetSize:F,disableAccessibilityExpanded:O,onHeightChange:j,automationLabel:`Inline${l}Suggestion-${r}`,tooltipProps:{showBeak:null!==(ee=null===(X=null==de?void 0:de.tooltip)||void 0===X?void 0:X.showBeak)&&void 0!==ee?ee:ue,gapSpace:null===(te=null==de?void 0:de.tooltip)||void 0===te?void 0:te.gapSpace,borderRadius:null===(oe=null==de?void 0:de.tooltip)||void 0===oe?void 0:oe.borderRadius,calloutMaxWidth:null===(ie=null==de?void 0:de.tooltip)||void 0===ie?void 0:ie.calloutMaxWidth,paddingStart:null===(ne=null==de?void 0:de.tooltip)||void 0===ne?void 0:ne.paddingStart,paddingEnd:null===(re=null==de?void 0:de.tooltip)||void 0===re?void 0:re.paddingEnd,paddingTop:null===(se=null==de?void 0:de.tooltip)||void 0===se?void 0:se.paddingTop,paddingBottom:null===(ae=null==de?void 0:de.tooltip)||void 0===ae?void 0:ae.paddingBottom,coverTarget:void 0===ge,directionHint:ge,layerHostId:E},title:C,titleStyle:h.D0(h.d4,C?C.length:0,!0,w),titleRootStyle:h.Xp(),personaCoinProps:A,style:o?Object.assign(Object.assign({},o),{borderThickness:me?0:fe,boxShadow:(null!==(le=null==me?void 0:me.length)&&void 0!==le?le:0)>0?me:void 0}):void 0,subtitle:k,subtitleStyle:h.qw(h.d4,!0,x,T),theme:he,hasKeyboardFocus:B,isSelectedByKeyboard:B&&R&&M,tooltip:U?"":_,icon:I?Object.assign(Object.assign({},I),{filled:!0}):void 0,iconShouldBeAccessible:!1,titleFormatting_DONOTUSE:S?H?b(C,z,"title"):y(S,C):void 0,subtitleFormatting:S?H?b(k,z,"subTitle"):y(S,k):void 0,disableTagAccessibility:!0,tagStyles:p.mX(de,G),tagText:W?n.inlineSuggestions("newTagText"):void 0,topPanelScopeButton:V,showUnderline:$,disabled:K,updateItemHeight:J})};var C=o(72124),w=o(30760),k=o(85936),T=o(94948),x=o(44943);const _=i.memo((e=>{var t,o,{suggestion:n,theme:r,styles:s,newItemTagStyles:a,onItemHovered:l,onItemSelected:u,strings:d,enableExpandedECCScopeLayout:g,enableMeetingBanner:f,locale:v}=e,y=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["suggestion","theme","styles","newItemTagStyles","onItemHovered","onItemSelected","strings","enableExpandedECCScopeLayout","enableMeetingBanner","locale"]);const b=i.useContext(c.O),_=null!=r?r:m.nk(void 0,b),I=i.useCallback((()=>{u(n)}),[n,u]),E=i.useCallback((()=>{null==l||l(n)}),[n,l]),A=(0,T.D)(n,d,s,_,g,f,v),B=n.type===x.E9&&(null===(t=null==s?void 0:s.noSuggestionsStyles)||void 0===t?void 0:t.item)?s.noSuggestionsStyles.item:A.style,R=i.createElement(S,Object.assign({},y,A,{style:B,newItemTagStyles:a,strings:d,theme:r,onClick:I,onHoverIn:E,isDisabled:n.isDisabled}));if(n.noSuggestionsDescription){const e=n.type===x.E9?null===(o=null==s?void 0:s.noSuggestionsStyles)||void 0===o?void 0:o.description:void 0;return i.createElement(C.S,{align:w.j5.Stretch,direction:w.PR.TopToBottom},i.createElement(C.S,{style:null!=e?e:p.MG},i.createElement(k.c,{text:n.noSuggestionsDescription,style:p.dm(m.FP(n,r),h.d4)})),R)}return R}));_.displayName="InlineSuggestionsItem";var I=o(26980),E=o(74853);const A=i.memo((({theme:e,group:t,accessibilitySetSize:o,strings:a,headerHtmlId:l,isHeaderVisible:c,headerStyles:u,containerStyles:d,hasScopableHeader:g,headerAccessibilityPositionInSet:h,enablePrefixHighlighting:p,showSeparator:f,separatorProps:m,hasSelectionBeenModifiedViaKeyboard:v,showKeyboardTooltip:y,isInitialSelection:b,layerHostId:S,showPartialLoadingEntities:C,shimmerStyles:w,itemsStyles:k,newItemTagStyles:T,itemQueryString:_,onHeaderClick:A,onHeaderHeightChange:R,onSeparatorHeightChange:M,onHeightExtraSpaceBottomChange:D,onGroupHovered:P,onItemHovered:N,onItemSelected:F,onItemHeightChange:O,disableTooltips:j,enableExpandedECCScopeLayout:q,overflowIndex:L,showMeetingBanner:H,enableMeetingBanner:z,meetingBannerText:W,accessibilityRole:G="menuitem",isSmallWindow:U,updateItemHeight:V,locale:$})=>{var K,J,Z,Y;const Q=t.suggestions;let X=!1,ee=!1;const te=Q.map(((t,n)=>{if(L&&L<=n)return;const r=h+(g?++n:n);return X=X||t.isNew&&t.type===s.c.Scope||!1,ee=H&&t.type===s.c.Event||!1,i.createElement(B,{styles:k,containerStyles:d,newItemTagStyles:T,strings:a,suggestion:t,key:`suggestion-item-${n}`,index:n,locale:$,htmlId:q?(0,x.Bn)(n,!0):t.type===x.E9?x.E9:(0,x.Bn)(r),theme:e,queryString:""!==_?_:void 0,accessibilityRole:G,accessibilityPositionInSet:r+1,accessibilitySetSize:o,truncateSubtitle:!0,onItemHovered:N,onItemSelected:F,onItemHeightChange:O,enablePrefixHighlighting:p,hasSelectionBeenModifiedViaKeyboard:v,showKeyboardTooltip:y&&!!t.isHighlighted,isInitialSelection:b,layerHostId:S,disableTooltips:j,enableExpandedECCScopeLayout:q,enableMeetingBanner:z,hasScopableHeader:g,updateItemHeight:V})})),oe=[];for(let e=0;e<(C||0);e++)oe.push(i.createElement(E.n,{style:w,key:`shimmer-skeleton-${e}`}));return i.createElement(i.Fragment,null,f&&i.createElement(n.w,Object.assign({},m,{onHeightChange:M})),ee&&i.createElement("div",{style:{display:"flex",width:"100%",height:U?"52px":"36px",alignItems:"center",gap:"12px",borderRadius:"6px",backgroundColor:`${null===(K=null==e?void 0:e.meetingBanner)||void 0===K?void 0:K.backgroundColor}`,padding:"6px 12px",border:`1px solid ${null===(J=null==e?void 0:e.meetingBanner)||void 0===J?void 0:J.borderColor}`,margin:"6px 0",boxSizing:"border-box"},"aria-label":W},i.createElement(r.In,{type:"Info",filled:!0,primaryColor:null===(Z=null==e?void 0:e.meetingBanner)||void 0===Z?void 0:Z.iconPrimaryColor}),i.createElement("span",{style:{fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",padding:"1px 0px 3px 0px",color:`${null===(Y=null==e?void 0:e.meetingBanner)||void 0===Y?void 0:Y.text}`}},W)),c?i.createElement(I.h,{theme:e,styles:u,htmlId:l,group:t,isScopableHeader:g,accessibilityPositionInSet:h+1,accessibilitySetSize:o,onClick:A,onGroupHovered:P,onHeightChange:R,onHeightExtraSpaceBottomChange:D,strings:a,displayNewItemTag:X,newItemTagStyles:T,hasSelectionBeenModifiedViaKeyboard:v},te):te,oe)}));A.displayName="InlineSuggestionsGroup";const B=e=>{var{index:t,hasScopableHeader:o,onItemHeightChange:n}=e,r=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["index","hasScopableHeader","onItemHeightChange"]);const s=i.useCallback((e=>n(e,t-(o?1:0))),[t,o]);return i.createElement(_,Object.assign({},r,{onHeightChange:s}))}},26980:(e,t,o)=>{"use strict";o.d(t,{h:()=>p});var i=o(95734),n=o(75753),r=o(65315),s=o(89810),a=o(30368),l=o(59523),c=o(36865),u=o(80034),d=o(30760),g=o(97928),h=o(5232);const p=i.memo((({group:e,htmlId:t,theme:o,style:p,styles:f,isScopableHeader:m,accessibilityPositionInSet:v,accessibilitySetSize:y,onClick:b,onGroupHovered:S,onHeightChange:C,onHeightExtraSpaceBottomChange:w,children:k,strings:T,displayNewItemTag:x,newItemTagStyles:_,hasSelectionBeenModifiedViaKeyboard:I})=>{var E,A,B,R,M,D;const P=i.useContext(s.O),{title:N,subtitle:F,isScoped:O=!1,isHighlighted:j,addBottomBorder:q}=e,[L,H]=i.useState(!1),z=null!=o?o:g.nk(void 0,P),W=null!=p?p:r.Js,G=Object.assign(Object.assign({},g.Fr(z)),r.L_(q)),U=i.useCallback((()=>{H(!0),null==S||S(e)}),[e,S]);if(w){let e=0;G.borderWidth&&(e="object"==typeof G.borderWidth?G.borderWidth.bottom?G.borderWidth.bottom:0:G.borderWidth),w(e)}if(m&&N){const e=null!==(E=null==f?void 0:f.titleLineHeight)&&void 0!==E?E:10,r=null!==(A=null==f?void 0:f.headerIconSize)&&void 0!==A?A:10;let s;s=(0,a.I)()?j?P?"CanvasText":"HighlightText":"CanvasText":(j||L)&&null!==(B=null==z?void 0:z.text.hover)&&void 0!==B?B:null==z?void 0:z.text.resting;const u={lineHeight:e+"px",display:"flex",width:O?"auto":"100%",flexDirection:O?"row-reverse":"row",justifyContent:"flex-end"},d={color:s,marginLeft:"4px",fontWeight:"600",flexGrow:O?0:1,fontSize:n.d4.xsmall,display:"flex",alignItems:"center"},p=O?"Previous":"Next",m=g.vA(z,j),{borderThickness:S,shadows:w}=(0,h.j)(f,P?(0,a.I)()?"Highlight":null!==(R=null==o?void 0:o.focusRing)&&void 0!==R?R:"var(--colorStrokeFocus2)":null!==(M=m.border)&&void 0!==M?M:"#000",!1,null!=I&&I,null!=j&&j,{useFluentV9:P});return i.createElement(i.Fragment,null,i.createElement(l.u,{appearance:"subtle",hasKeyboardFocus:j,htmlId:t,icon:{type:p},automationLabel:N,title:N,titleStyle:n.D0(n.d4,(null==N?void 0:N.length)||0,!0),theme:m,onClick:b,style:Object.assign(Object.assign({flexibleSize:!0,borderRadius:4},f),{borderThickness:w?0:S,boxShadow:(null!==(D=null==w?void 0:w.length)&&void 0!==D?D:0)>0?w:void 0}),onHeightChange:C,onHoverIn:U,onHoverOut:()=>H(!1),accessibilityRole:"option",accessibilityPositionInSet:v,accessibilitySetSize:y,useFullWidth:!0},i.createElement("span",{"data-is-focusable":!0,style:u},i.createElement("span",{style:d},N),i.createElement(c.In,{type:p,primaryColor:s,fontSize:r,style:{margin:(e-r)/2}}))),k)}const V=x?null==T?void 0:T.inlineSuggestions("combineTag").replace("{0}",null!=N?N:"").replace("{1}",null==T?void 0:T.inlineSuggestions("newTagText")):N;return i.createElement(u.Y,{header:N,headerStyle:Object.assign(Object.assign(Object.assign({},r.B3(z,W,n.d4)),f),{userSelectable:!1}),subheader:F,subheaderStyle:Object.assign(Object.assign({},r.XC(z,W,n.d4)),f),componentStackStyle:G,stackDirection:d.PR.TopToBottom,stackAlignment:d.j5.Stretch,accessibleLive:d.pq.Off,accessibleLabel:V,onHeaderHeightChange:C,tagStyles:r.mX(z,_),tagText:x?null==T?void 0:T.inlineSuggestions("newTagText"):void 0},k)}));p.displayName="InlineSuggestionsGroupHeader"},94948:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>m,r:()=>f}),3023==o.j)var i=o(39386);if(3023==o.j)var n=o(75834);if(3023==o.j)var r=o(79090);var s=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};function a(e){return e.type===i.c.Event}function l(e){return e.type===i.c.Message}function c(e){return e.type===i.c.File}function u(e){return e.type===i.c.People}function d(e){return e.type===i.c.Scope}function g(e){return e.type===i.c.Chat}function h(e){return e.type===i.c.CopilotPlugin}function p(e){return e.type===i.c.App}function f(e){return a(e)?e.eventId:l(e)?e.emailId:c(e)?e.fileName:u(e)?e.displayName:d(e)?e.id:g(e)?e.name:h(e)?e.previewCard.title:(p(e),e.title)}const m=(e,t,o,i,f,m,y)=>{var b,S,C,w,k,T,x,_,I,E,A,B,R,M,D;if(c(e)){const t=e.hitFileName||`${e.fileName}.${e.fileExtension}`,n=(null==o?void 0:o.fileItemStyles)||{},{iconStyles:a,titleFontSize:l,subtitleFontSize:c}=n,u=s(n,["iconStyles","titleFontSize","subtitleFontSize"]),d=(0,r.Z)(e.fileExtension),g="Files"===d,h=g?(null===(b=null==i?void 0:i.fallbackIcon)||void 0===b?void 0:b.background)||(null==a?void 0:a.backgroundColor):void 0,p=g?`.${e.fileExtension}`:"",f=g?6:void 0;return{suggestionId:e.itemId,suggestionType:e.type,title:t+p,titleFontSize:l,icon:{type:d,style:Object.assign(Object.assign({},a),{backgroundColor:h,padding:f,fontSize:16})||{backgroundColor:h}},style:u,subtitle:e.subject,subtitleFontSize:c,tooltip:t,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(u(e)){const t=(null==o?void 0:o.personItemStyles)||{},{personaCoinSize:n,titleFontSize:r,subtitleFontSize:a}=t,l=s(t,["personaCoinSize","titleFontSize","subtitleFontSize"]);return Object.assign(Object.assign({suggestionId:e.displayName,suggestionType:e.type,title:e.displayName,titleFontSize:r,personaCoinProps:{text:"",size:v(n),imageUrl:e.imageUrl,initials:e.initials,borderColor:null==i?void 0:i.userAvatarBorderColor}},e.iconName&&{icon:{type:e.iconName}}),{style:l,subtitle:null!==(S=e.subtitleOverride)&&void 0!==S?S:e.primaryEmailAddress,subtitleFontSize:a,truncateSubtitle:!0,tooltip:e.primaryEmailAddress,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes})}if(d(e)){const t=(null==o?void 0:o.scopeItemStyles)||{},{iconStyles:i,titleFontSize:r,subtitleFontSize:a,personaCoinSize:l}=t,c=s(t,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),u=(0,n.S)(e.iconName);return{suggestionId:e.id,suggestionType:e.type,title:e.title,titleFontSize:r,icon:void 0===u||f?void 0:{type:u,style:i||{}},personaCoinProps:!e.imageUrl&&!e.iconName||f?void 0:{text:"",size:v(l),imageUrl:e.imageUrl,color:"neutral"},style:c,subtitle:e.subtitle,subtitleFontSize:a,tooltip:null!==(C=e.tooltip)&&void 0!==C?C:e.title,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew,enableExpandedECCScopeLayout:f,isScopeSelected:e.isSelected}}if(a(e)){const{eventId:n,eventName:r,eventStartDateTime:a,eventEndDateTime:l,isAllDay:c,isSeries:u,hasRecording:d}=e,g=(null==o?void 0:o.eventItemStyles)||{},{iconStyles:h,titleFontSize:p,subtitleFontSize:f}=g,v=s(g,["iconStyles","titleFontSize","subtitleFontSize"]),b=function(e,t,o,i="en-US"){let n="";const r=Date.parse(e);if(!Number.isNaN(r)){const e=new Date(r),s=Date.parse(t);if(Number.isNaN(s))n=o?e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i):e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"});else{const t=new Date(s);n=e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()?o?e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i):e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"}):o?e.toLocaleDateString(i)+" - "+t.toLocaleDateString(i):e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleDateString(i)+" "+t.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})}}return n}(a,l,c,y),S=(null==t?void 0:t.inlineSuggestions("recordText"))||"",C=m&&d?b+" | "+S:b;return{suggestionId:n,suggestionType:e.type,title:r,titleFontSize:p,icon:{type:m&&d?"EventRecorded":u?"EventSeries":"Event",fontSize:u?16:14,style:Object.assign(Object.assign({},h),{backgroundColor:(null===(w=null==i?void 0:i.fallbackIcon)||void 0===w?void 0:w.background)||(null==h?void 0:h.backgroundColor)}),primaryColor:null===(k=null==i?void 0:i.fallbackIcon)||void 0===k?void 0:k.color},style:v,subtitle:C,subtitleFontSize:f,truncateSubtitle:!0,tooltip:r+" "+C,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(l(e)){const{subject:n,sender:r,emailId:a}=e,l=(null==o?void 0:o.emailItemStyles)||{},{iconStyles:c,titleFontSize:u,subtitleFontSize:d}=l,g=s(l,["iconStyles","titleFontSize","subtitleFontSize"]),h=null===(T=t.inlineSuggestions("emailSentBy"))||void 0===T?void 0:T.replace("{0}",r);return{suggestionId:a,suggestionType:e.type,title:n,titleFontSize:u,icon:{type:"Emails",fontSize:null!==(x=g.iconFontSize)&&void 0!==x?x:16,style:Object.assign(Object.assign({},c),{backgroundColor:(null===(_=null==i?void 0:i.fallbackIcon)||void 0===_?void 0:_.background)||(null==c?void 0:c.backgroundColor)}),primaryColor:null===(I=null==i?void 0:i.fallbackIcon)||void 0===I?void 0:I.color},style:g,subtitle:h,subtitleFontSize:d,truncateSubtitle:!0,tooltip:n,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(p(e)){const{title:t,imageUrl:o,collectorId:n,appType:r,subtitle:s,isMoreButton:a}=e;return{tooltip:t,suggestionId:n,suggestionType:e.type,title:t,appType:r,subtitle:s,icon:o?void 0:a?{type:"ExploreMoreCopilot",fontSize:32,style:{backgroundColor:null===(E=null==i?void 0:i.fallbackIcon)||void 0===E?void 0:E.background,height:32,width:32}}:{type:"ChatBubblesQuestion",fontSize:32,style:{backgroundColor:null===(A=null==i?void 0:i.fallbackIcon)||void 0===A?void 0:A.background,height:32,width:32}},personaCoinProps:o?{text:t,imageUrl:o,color:"neutral",size:32}:void 0,truncateSubtitle:!0,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,disableAccessibilityExpanded:!0,style:{minWidth:260,maxWidth:260}}}if(g(e)){const{name:t,chatMembers:n,threadId:r,lastMessageTime:a,imageUrl:l}=e,c=(null==o?void 0:o.chatItemStyles)||{},{iconStyles:u,titleFontSize:d,subtitleFontSize:g,personaCoinSize:h}=c,p=s(c,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),f=2,m=n.length-f;let y=n.slice(0,f).map((e=>e.displayName)).join(", ");m>0&&(y+=`, +${m}`);const b=t||y,S=new Date(a),C=S.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric",hour12:!0}),w=`${S.toLocaleDateString("en-US")} ${C}`;return Object.assign({title:b,tooltip:b,subtitle:t?y:w,suggestionId:r,suggestionType:e.type,truncateSubtitle:!0,titleFontSize:d,subtitleFontSize:g,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,style:p},l?{personaCoinProps:{text:b,imageUrl:l,size:v(h),borderColor:null==i?void 0:i.userAvatarBorderColor}}:{icon:{type:"TeamsChat",style:Object.assign(Object.assign({},u),{backgroundColor:(null===(B=null==i?void 0:i.fallbackIcon)||void 0===B?void 0:B.background)||(null==u?void 0:u.backgroundColor)}),primaryColor:null===(R=null==i?void 0:i.fallbackIcon)||void 0===R?void 0:R.color}})}if(h(e)){const t=(null==o?void 0:o.genericItemStyles)||{},{iconStyles:i,personaCoinSize:n,titleFontSize:r,subtitleFontSize:a}=t,l=s(t,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),c=e.previewCard,u=null===(D=null===(M=c.images)||void 0===M?void 0:M[0])||void 0===D?void 0:D.url;return{suggestionId:c.title,suggestionType:e.type,title:c.title,titleFontSize:r,personaCoinProps:u?{text:"",size:v(n),imageUrl:u,color:"neutral"}:void 0,style:l,subtitle:c.subtitle,subtitleFontSize:a,tooltip:c.title,displayNewItemTag:e.isNew,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}const{id:P,title:N,subtitle:F,imageUrl:O,tooltip:j,type:q,isHighlighted:L}=e,H=(null==o?void 0:o.genericItemStyles)||{},{iconStyles:z,personaCoinSize:W,titleFontSize:G,subtitleFontSize:U}=H,V=s(H,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),$=(0,n.S)(e.iconName);return{suggestionId:P,suggestionType:q,title:N,titleFontSize:G,icon:void 0!==$?{type:$,style:z}:void 0,personaCoinProps:O||$?{text:"",size:v(W),imageUrl:O,color:"neutral"}:void 0,style:V,subtitle:F,subtitleFontSize:U,truncateSubtitle:!!j,tooltip:null!=j?j:N,isHighlighted:L,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew}},v=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},5232:(e,t,o)=>{"use strict";if(o.d(t,{j:()=>n}),3023==o.j)var i=o(30368);function n(e,t,o,n,r,s){const a=o?null==e?void 0:e.borderThicknessInitialSelection:n?null==e?void 0:e.borderThicknessWithKeyboardFocus:void 0,l=r&&a?a:null==e?void 0:e.borderThickness;let c="number"==typeof l?l:null==l?void 0:l.start,u="number"==typeof l?l:null==l?void 0:l.end,d="number"==typeof l?l:null==l?void 0:l.top,g="number"==typeof l?l:null==l?void 0:l.bottom;(0,i.I)()&&(null==s?void 0:s.useFluentV9)&&(c=0===c?1:c,u=0===u?1:u,d=0===d?1:d,g=0===g?1:g);let h="";return c&&(h+=`inset ${c}px 0 0 0 ${t},`),u&&(h+=`inset -${u}px 0 0 0 ${t},`),d&&(h+=`inset 0 ${d}px 0 0 ${t},`),g&&(h+=`inset 0 -${g}px 0 0 ${t},`),h.length>0&&(h=h.substring(0,h.length-1)),{borderThickness:l,shadows:h}}},51732:(e,t,o)=>{"use strict";o.d(t,{x:()=>B});var i=o(95734);if(3023==o.j)var n=o(75753);if(3023==o.j)var r=o(65315);if(3023==o.j)var s=o(43463);if(3023==o.j)var a=o(89810);if(3023==o.j)var l=o(19974);if(3023==o.j)var c=o(174);if(3023==o.j)var u=o(6143);if(3023==o.j)var d=o(72124);if(3023==o.j)var g=o(30760);if(3023==o.j)var h=o(18876);if(3023==o.j)var p=o(5779);if(3023==o.j)var f=o(59523);if(3023==o.j)var m=o(4515);if(3023==o.j)var v=o(44943);if(3023==o.j)var y=o(14018);if(3023==o.j)var b=o(85321);if(3023==o.j)var S=o(10428);if(3023==o.j)var C=o(5610);if(3023==o.j)var w=o(33719);if(3023==o.j)var k=o(69931);if(3023==o.j)var T=o(91050);if(3023==o.j)var x=o(97928);if(3023==o.j)var _=o(26980);if(3023==o.j)var I=o(94948);if(3023==o.j)var E=o(39386);var A=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const B=({definition:e,theme:t,style:o,styles:B,strings:R,layerHostId:M,queryString:D,results:P,isError:N,isLoading:F,menuType:O,enableScopedHeader:j,enablePrefixHighlighting:q,enableStickyFooter:L,keyboardHandlerTarget:H,showMoreEntitiesConfig:z,browseThisComputerConfig:W,showDiscoveryPromoFooter:G,listID:U,noSuggestionsHeaderInfo:V,disableTooltips:$,moveSelectionOnHover:K,locale:J,showMeetingBanner:Z,enableMeetingBanner:Y,meetingBannerText:Q,isUnsupported:X,showPartialLoadingEntities:ee,onGroupSelected:te,onAction:oe,onItemSelected:ie,onFocus:ne,onFooterAction:re,onAfterUpdate:se,appGptConfig:ae})=>{var le,ce,ue;const de=i.useContext(a.O),ge=P.every((e=>{var t;return!(null===(t=e.suggestions)||void 0===t?void 0:t.length)||e.alwaysDisplay})),[he,pe]=i.useState({type:"item",groupIndex:0,itemIndex:0}),fe=i.useCallback((e=>{var t;e.type===v.E9?e.id===v.Es?null==oe||oe(b.L.Retry):e.id===v.WM&&(je(""),null==oe||oe(b.L.ClearSearch)):e.type===E.c.App&&void 0===e.AppType?null===(t=null==ae?void 0:ae.onClickExploreMoreCopilots)||void 0===t||t.call(ae):ie(e)}),[oe,ie]),me=null!=o?o:r.Js,ve=i.useMemo((()=>(0,C.H)(B,me)),[B,me]),ye={RenderFooterIcons:"true"},be=i.useRef(null),Se=i.createRef(),Ce=i.useRef({groupLayouts:[]}),[we,ke]=i.useState(0),[Te,xe]=i.useState(!1),[_e,Ie]=i.useState(void 0),[Ee,Ae]=i.useState([]),Be=i.useCallback((e=>{Ae(e)}),[Ae]),[Re,Me]=i.useState(!1),[De,Pe]=i.useState(),[Ne,Fe]=i.useState(!1),[Oe,je]=i.useState(""),[qe,Le]=i.useState(!1),[He,ze]=i.useState(!1),[We,Ge]=i.useState(!1),[Ue,Ve]=i.useState(!0),$e=i.useRef(null),{baseInlineSuggestionsGroups:Ke,isScopedHeaderEnabled:Je,itemsCount:Ze,itemsAndGroupHeadingCount:Ye,isGptMenu:Qe}=i.useMemo((()=>{var e,t;let o=!1;if(null==ae?void 0:ae.enableAppGpt){P[0]||(P[0]={suggestions:[]}),o=null===(e=P[0].suggestions)||void 0===e?void 0:e.every((e=>e.type===E.c.App));const i=null===(t=P[0].suggestions)||void 0===t?void 0:t.some((e=>e.isMoreButton));if((null==ae?void 0:ae.onClickExploreMoreCopilots)&&o&&!i){const e={type:E.c.App,title:(null==ae?void 0:ae.moreCopilotsStringOverride)||"Get Copilot extensions",isMoreButton:!0};P[0].suggestions.push(e)}}const i=(0,v.Oz)(F,N,ge,R,P,V,X),n=i.filter((e=>!1!==e.isScopingEnabled&&!!e.title)).length,r=j&&!Ne&&n>0&&!o,s=i.reduce(((e,t)=>t.suggestions.length+e),0);return{baseInlineSuggestionsGroups:i,isScopedHeaderEnabled:r,itemsCount:s,itemsAndGroupHeadingCount:r?s+n:s,isGptMenu:o}}),[F,N,ge,R,P,V]),Xe=i.useRef(),et=i.useMemo((()=>void 0===he?Ke:"group"===he.type?Ke.map(((e,t)=>t===he.groupIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e)):Ke.map(((e,t)=>t===he.groupIndex?Object.assign(Object.assign({},e),{suggestions:e.suggestions.map(((e,t)=>t===he.itemIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e))}):e))),[he,Ke]),tt=(0,v.O5)(O),ot=O&&"brandingMode"in O&&void 0!==O.brandingMode?O.brandingMode:void 0,it=O&&"flag"in O?O.critiquePosition:void 0,nt=O&&"flag"in O?O.critiqueSetSize:void 0,rt=null!=t?t:x.nk(ot,de);i.useEffect((()=>{Pe({top:0,bottom:0,isNewRender:!0})}),[D]),i.useEffect((()=>{if(F)return;let e=Je&&Ke.length>0&&Ke[0].title?1:0;Ne&&(null==W?void 0:W.isBrowseThisComputerEnabled)&&(e=-1,Pe({top:0,bottom:0,isNewRender:!0}),xe(!0)),ct(e,1===e),ke(e)}),[F,Ne,Ke]);const st=Ke.length;i.useEffect((()=>{be.current&&(clearTimeout(be.current),be.current=null),F?st?be.current=setTimeout((()=>Me(!0)),v.al):Me(!0):Me(!1)}),[F,st]),i.useEffect((()=>{se&&e&&se(e)}));const at=i.useCallback((e=>{e(Ce.current)}),[]),lt=i.useCallback(((e,t)=>{t.type===v.E9?t.id===v.Es?null==ne||ne({focusedItemHtmlId:v.E9,selection:{type:"retryButton"}}):t.id===v.WM&&(null==ne||ne({focusedItemHtmlId:v.E9,selection:{type:"clearSearchButton"}})):null==ne||ne({focusedItemHtmlId:(0,v.Bn)(e),selection:{type:"item",item:t,positionInSet:e,setSize:Ye}})}),[Ye,ne]),ct=i.useCallback(((e,t)=>{var o,i,n,r,s;if(void 0===e)return pe(void 0),-1;e%=Ye;let a=0;const l={top:0,bottom:0};for(let c=0;c<Ke.length;c++){const u=Ke[c];if(l.top=l.bottom+(null===(o=Ce.current.groupLayouts[c])||void 0===o?void 0:o.separatorHeight),l.bottom=l.top+(null===(i=Ce.current.groupLayouts[c])||void 0===i?void 0:i.headerHeight),Je&&!1!==u.isScopingEnabled&&u.title){if(e===a)return Pe(Object.assign(Object.assign({},l),{isNewRender:!!t})),null==ne||ne({focusedItemHtmlId:(0,v.Bn)(e),selection:{type:"group",group:u,positionInSet:e,setSize:Ye}}),c<Ke.length&&pe({type:"group",groupIndex:c}),e;a++}for(let o=0;o<u.suggestions.length;o++){const i=u.suggestions[o];if(0!==o&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(r=null===(n=Ce.current.groupLayouts[c])||void 0===n?void 0:n.itemHeights[o])&&void 0!==r?r:0),o===u.suggestions.length-1&&(l.bottom+=null===(s=Ce.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return Pe(Object.assign(Object.assign({},l),{isNewRender:!!t})),lt(e,i),c<Ke.length&&o<Ke[c].suggestions.length&&pe({type:"item",groupIndex:c,itemIndex:o}),e;a++}}return e}),[Ke]),ut=i.useCallback((e=>{Ie(e),null==ne||ne({focusedItemHtmlId:(0,y.k)(Ee[e]),selection:{type:"action",action:Ee[e],positionInSet:e,setSize:Ee.length}})}),[Ee,ne,Ie]),dt=i.useRef(!0),gt=i.useCallback((e=>{K?(Ve(!1),ke(ct(e))):(dt.current||(0,l.i)())&&(ke(e),ct(void 0))}),[K,Ke,ct]),ht=i.useCallback((e=>{const t=(0,I.r)(e);if(!t)return;const o=(()=>{let o=0;for(const i of Ke){Je&&!1!==i.isScopingEnabled&&i.title&&o++;for(const n of i.suggestions){if(n.type===e.type&&(0,I.r)(n)===t)return o;o++}}return o})();gt(o)}),[gt]),pt=i.useCallback((e=>{const t=(()=>{let t=0;for(const o of Ke){if(Je&&!1!==o.isScopingEnabled&&o.title){if(e.title===o.title&&e.subtitle===o.subtitle)return t;t++}t+=o.suggestions.length}return t})();gt(t)}),[gt]);(0,c.c)((()=>{dt.current=!0}));const ft=e=>{var t;switch(e){case u.h.ArrowDown:void 0===_e?(ut(0),pe(void 0),Pe({top:1e4,bottom:1e4,isNewRender:!1})):_e<Ee.length-1?(ut(_e+1),Pe({top:1e4,bottom:1e4,isNewRender:!1})):Ne&&(null==W?void 0:W.isBrowseThisComputerEnabled)?yt(e):(ke(ct(0)),Ie(void 0));break;case u.h.ArrowUp:0===_e?(Ie(void 0),(null==z?void 0:z.isShowMoreEntitiesEnabled)&&!Ne?(pe(void 0),Le(!0),Pe({top:1e4,bottom:1e4,isNewRender:!1})):ke(ct(Ye-1))):void 0!==_e&&_e>0?(ut(_e-1),Pe({top:1e4,bottom:1e4,isNewRender:!1})):(ct(void 0,!1),ut(Ee.length-1),Pe({top:1e4,bottom:1e4,isNewRender:!1}));break;case u.h.Enter:case u.h.Tab:if(void 0===_e)break;Ee[_e]===s._R.Overflow?null===(t=Se.current)||void 0===t||t.openOverflowMenu(!0):null==re||re(Ee[_e])}},mt=()=>{var e;Xe.current=et[0],Fe(!0),Le(!1),null===(e=null==z?void 0:z.onClickShowMoreEntities)||void 0===e||e.call(z,!0),ke(void 0)},vt=e=>{switch(e){case u.h.ArrowDown:qe?Ee.length>0?(Le(!1),Ie(0)):(Le(!1),ke(ct(0))):(ct(we,!1),Le(!0),Pe({top:1e4,bottom:1e4,isNewRender:!1}));break;case u.h.ArrowUp:qe?(Le(!1),ke(ct(Ye-1))):(ct(we,!1),Ie(void 0),Le(!0),Pe({top:1e4,bottom:1e4,isNewRender:!1}));break;case u.h.Enter:case u.h.Tab:mt()}},yt=e=>{var t;const o=Ze-1===we;switch(e){case u.h.ArrowDown:if(tt&&_e===Ee.length-1)Ie(void 0),ke(ct(void 0)),xe(!0);else{const e=!tt&&o&&!Te;xe(e),ke(e?void 0:ct((null!=we?we:-1)+1))}break;case u.h.ArrowUp:Te?(xe(!1),tt&&void 0===_e?ft(e):ke(ct(Ye-1))):(ct(we,!1),ke(void 0),xe(!0));break;case u.h.Enter:case u.h.Tab:null===(t=null==W?void 0:W.onClickBrowseThisComputer)||void 0===t||t.call(W)}},bt=e=>{if(e!==u.h.ArrowDown&&e!==u.h.ArrowUp&&e!==u.h.Enter&&e!==u.h.Tab&&e!==u.h.Home&&e!==u.h.End)return!1;switch(e){case u.h.ArrowDown:if(ze(!0),Ge(!1),Ve(!1),dt.current=!1,void 0!==_e||we===Ye-1||qe)!(null==z?void 0:z.isShowMoreEntitiesEnabled)||Ne||void 0!==_e&&!qe?Ee.length>0?ft(e):(null==W?void 0:W.isBrowseThisComputerEnabled)&&!Qe?yt(e):ke(ct(0)):vt(e);else if(!(null==W?void 0:W.isBrowseThisComputerEnabled)||Qe){const e=ct((null!=we?we:-1)+1);ke(e)}else yt(e);break;case u.h.ArrowUp:ze(!0),Ge(!1),Ve(!1),dt.current=!1,Te&&Ne?yt(e):0===we&&Ne?(null==W?void 0:W.isBrowseThisComputerEnabled)?yt(e):tt?ft(e):ke(ct(Ye-1)):void 0!==_e||0===we||qe?(0===we||void 0!==_e)&&Ee.length>0&&!qe?ft(e):qe||0===we&&(null==z?void 0:z.isShowMoreEntitiesEnabled)&&!Ne&&(0===_e||void 0===_e)?vt(e):ke(ct(Ye-1)):ke(ct((null!=we?we:-1)-1));break;case u.h.Home:ze(!0),Ge(!1),Ve(!1),ke(ct(0)),dt.current=!1;break;case u.h.End:ze(!0),Ge(!1),Ve(!1),ke(ct(Ye-1)),dt.current=!1;break;case u.h.Enter:case u.h.Tab:{if(qe){vt(e);break}if(void 0!==_e){ft(e);break}if(Te){yt(e);break}let t=0;Ke.forEach((e=>{Je&&!1!==e.isScopingEnabled&&e.title&&(we===t&&(null==te||te(e)),t++),void 0!==we&&we>=t&&we<t+e.suggestions.length&&fe(e.suggestions[we-t]),t+=e.suggestions.length}));break}default:return!1}return!0},St=e=>{H||bt(e.key)};i.useEffect((()=>(null==H||H.setKeyPressHandler(bt),()=>{null==H||H.setKeyPressHandler(void 0)})));const Ct=i.useRef(),wt=()=>{Ct.current&&clearTimeout(Ct.current),Ct.current=setTimeout((()=>{clearTimeout(Ct.current),Ct.current=void 0,Ge(!0)}),50)};i.useEffect(wt,[De]);const kt=ve.containerStyles||{},{paddingStart:Tt,paddingEnd:xt,paddingHorizontal:_t,paddingTop:It,paddingBottom:Et,paddingVertical:At,paddingScrollTop:Bt,scrollbarThumbWidth:Rt,scrollbarPaddingBottom:Mt}=kt,Dt=A(kt,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth","scrollbarPaddingBottom"]),[Pt,Nt]=i.useState(null!==(ce=null===(le=ve.gptViewStyles)||void 0===le?void 0:le.defaultContainerHeight)&&void 0!==ce?ce:250),{maxHeight:Ft}=Dt,Ot=A(Dt,["maxHeight"]),jt=(null==ae?void 0:ae.enableAppGpt)&&Qe?Object.assign(Object.assign({},Ot),{minWidth:260,maxWidth:260,maxHeight:Pt,height:Pt}):Dt,qt=null!=Tt?Tt:_t,Lt=null!=xt?xt:_t,Ht=G&&O&&"flag"in O&&O.flag===s.z4.File,zt=()=>i.createElement(T.R,{strings:{inlineSuggestions:R.inlineSuggestions}}),Wt=()=>{var e,t;return!tt||(null==ae?void 0:ae.enableAppGpt)?i.createElement(i.Fragment,null):i.createElement(y.w,{ref:Se,theme:x.Dj(rt),definition:{critiqueType:s.L9.InlineSuggestion,flagType:O&&"flag"in O?O.flag:void 0,brandingMode:ot,onlyShowFeedbackButton:L,actions:(0,v.Jx)(O),critiquePosition:it,critiqueSetSize:nt},layerHostId:M,strings:R,settings:ye,onAction:re,overflowMenuCalloutStyle:null===(e=null==ve?void 0:ve.footerStyles)||void 0===e?void 0:e.overflowMenuCalloutStyles,footerContainerStyle:ve.footerStyles,footerButtonStyle:ve.footerStyles.buttonStyles,overflowMenuButtonStyle:null!==(t=ve.footerStyles.buttonStyles)&&void 0!==t?t:ve.footerStyles.overFlowButtonStyles,setFooterActionIdList:Be,selectedButtonIndex:_e,showPreviewTooltipForBranding:!0})},Gt=(null==z?void 0:z.isShowMoreEntitiesEnabled)&&!Ne&&!(N||ge||X);return i.createElement(d.S,{style:Object.assign(Object.assign(Object.assign({},n.uI(rt,void 0,{useFluentV9:de})),jt),{hideFocusBox:!0}),align:g.j5.Stretch,focusable:!0,onKeyDown:St,handledKeys:[u.h.ArrowDown,u.h.ArrowUp,u.h.Enter,u.h.Tab,u.h.Home,u.h.End],accessibilityRole:Re||N||ge||X?void 0:"group",accessible:!0,accessibilityLabel:R.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:U},i.createElement(h.B,{scrollDirection:"vertical",style:{paddingStart:qt,paddingEnd:Lt,paddingTop:It,paddingBottom:Et,paddingVertical:At,paddingScrollTop:Bt,scrollbarThumbWidth:Rt,scrollbarPaddingBottom:Mt,borderRadius:Dt.borderRadius},theme:{thumbColor:null===(ue=null==rt?void 0:rt.scroll)||void 0===ue?void 0:ue.thumbColor},onScroll:wt,onScrollStatusChange:e=>{e&&Ve(!1)},scrollTo:De,hidden:Re,alwaysShowScrollbar:(null==ae?void 0:ae.enableAppGpt)&&Qe},i.createElement(p.R,{disableInitialFocus:!0},i.createElement(d.S,{align:g.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:R.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel")},Ne&&i.createElement(i.Fragment,null,(null==z?void 0:z.displayGroupHeaderDuringSearch)&&Xe.current?i.createElement(_.h,{theme:rt,styles:null==ve?void 0:ve.headerStyles,group:Xe.current,isScopableHeader:!1,onHeightChange:e=>{Ce.current.groupLayouts[0]||(Ce.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),Ce.current.groupLayouts[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{Ce.current.groupLayouts[0]||(Ce.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),Ce.current.groupLayouts[0].extraSpaceBottomHeight=e},strings:R,displayNewItemTag:!1}):void 0,i.createElement(d.S,{direction:g.PR.LeftToRight},!0!==(null==z?void 0:z.shouldOnlyShowSearchBox)?i.createElement("span",{style:{flexGrow:0,flexShrink:0}},i.createElement(f.u,{appearance:"subtle",style:r.Ek,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;Fe(!1),null===(e=null==z?void 0:z.onCloseShowMoreEntities)||void 0===e||e.call(z,!1),ke(0)},theme:x.VD(rt),icon:{type:"Previous",style:r.dt}})):void 0,i.createElement(w.y,{theme:rt,style:null==ve?void 0:ve.searchBoxStyles,htmlId:null==z?void 0:z.searchBoxHtmlId,autoFocus:!0,handledKeys:[u.h.ArrowDown,u.h.ArrowUp,u.h.Enter,u.h.Tab,u.h.Home,u.h.End],onKeyDown:e=>{bt(e.key)},placeholder:(null==z?void 0:z.searchBoxPlaceHolder)||"",value:Oe,onValueChange:e=>{var t;je(e),null===(t=null==z?void 0:z.onSearchChange)||void 0===t||t.call(z,e)},onClear:()=>{var e;je(""),null===(e=null==z?void 0:z.onSearchClear)||void 0===e||e.call(z)}}))),(null==W?void 0:W.isBrowseThisComputerEnabled)&&Ne&&i.createElement(k.i,{handledKeys:[u.h.ArrowDown,u.h.ArrowUp,u.h.Enter,u.h.Tab,u.h.Home,u.h.End],onKeyDown:St,strings:R,browseThisComputerButtonLabel:null==W?void 0:W.browseThisComputerButtonLabel,isBrowseThisComputerEnabled:Te,hasSelectionBeenModifiedViaKeyboard:He,browseThisComputerHtmlId:null==W?void 0:W.browseThisComputerHtmlId,onClickBrowseThisComputer:null==W?void 0:W.onClickBrowseThisComputer,theme:x.Ui(rt,Te)}),i.createElement(S.p,{suggestionsRef:$e,theme:rt,styles:ve,strings:R,locale:J,results:et,isShimmerVisible:Re,enableScopedHeader:Je,itemsCount:Ye,itemQueryString:D,onGroupSelected:te,onGroupHovered:pt,onItemHovered:ht,onItemSelected:fe,enablePrefixHighlighting:q,isGroupHeaderVisible:!Ne&&!Qe,hasSelectionBeenModifiedViaKeyboard:He,showKeyboardTooltip:We,isInitialSelection:Ue,layerHostId:M,disableTooltips:$,updateMenuLayout:at,updateItemHeight:e=>{var t,o;const i=Math.min(null!==(o=null===(t=P[0])||void 0===t?void 0:t.suggestions.length)&&void 0!==o?o:1,5);Nt(e*i+(null!=It?It:0)+(null!=Et?Et:0))},showMeetingBanner:Z,enableMeetingBanner:Y,meetingBannerText:Q,showPartialLoadingEntities:ee}),Gt&&i.createElement(f.u,{appearance:"subtle",automationLabel:"InlineSuggestionMoreEntitiesButton",title:z.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:x.zN(rt,qe),onClick:mt}))),O&&"flag"in O&&O.flag===s.z4.SatoriEntity&&i.createElement(d.S,{style:{paddingHorizontal:n.QL}},i.createElement(m.R,{url:(0,v.MN)(D),text:R.inlineSuggestions("seeMoreHyperLinkLabel"),theme:x.fj(rt),style:r.v9(),inline:!1})),!L&&Wt(),!L&&Ht&&zt()),L&&Wt(),L&&Ht&&zt())}},10428:(e,t,o)=>{"use strict";o.d(t,{p:()=>g});var i=o(95734),n=o(89810),r=o(72124),s=o(30760),a=o(74853),l=o(54e3),c=o(44943),u=o(65315),d=o(97928);const g=i.memo((({theme:e,styles:t,strings:o,results:l,isShimmerVisible:g,enableScopedHeader:p,enablePrefixHighlighting:f,layerHostId:m,itemsCount:v,itemQueryString:y,isGroupHeaderVisible:b,hasSelectionBeenModifiedViaKeyboard:S,showKeyboardTooltip:C,isInitialSelection:w,disableTooltips:k,showMeetingBanner:T,enableMeetingBanner:x,meetingBannerText:_,isSmallWindow:I,suggestionsRef:E,locale:A,showPartialLoadingEntities:B,onGroupSelected:R,onGroupHovered:M,onItemHovered:D,onItemSelected:P,updateMenuLayout:N,updateItemHeight:F})=>{var O,j;const q=i.useContext(n.O),L=null!=e?e:d.nk(void 0,q);let H=0;return g?i.createElement(a.I,{hideTitle:!b,style:null==t?void 0:t.shimmerStyles,inlineSuggestionsTheme:L}):i.createElement(r.S,{ref:E,style:{marginEnd:null===(O=null==t?void 0:t.containerStyles)||void 0===O?void 0:O.marginEnd,height:null===(j=null==t?void 0:t.gptViewStyles)||void 0===j?void 0:j.height},align:s.j5.Stretch},l.map(((e,n)=>{const r=e.suggestions,s=p&&!1!==e.isScopingEnabled&&void 0!==e.title,a=i.createElement(h,{theme:L,styles:t,strings:o,key:`suggestion-group-${n}`,entryIndex:n,itemsCount:v,cumulativeCount:H,group:e,locale:A,layerHostId:m,accessibilitySetSize:v,headerHtmlId:(0,c.Bn)(H),headerStyles:null==t?void 0:t.headerStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:H,hasScopableHeader:s,enablePrefixHighlighting:f,onGroupSelected:R,onGroupHovered:M,itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:y,onItemHovered:D,onItemSelected:P,showSeparator:e.showSeparator,isHeaderVisible:b,separatorProps:e.showSeparator&&u.g4||void 0,hasSelectionBeenModifiedViaKeyboard:S,showKeyboardTooltip:C,isInitialSelection:w,disableTooltips:k||e.disableTooltips,showMeetingBanner:T&&0===n,enableMeetingBanner:x,meetingBannerText:_,isSmallWindow:I,updateMenuLayout:N,updateItemHeight:F,showPartialLoadingEntities:B,shimmerStyles:null==t?void 0:t.shimmerStyles});return s&&(H+=1),H+=r.length,a})))}));g.displayName="InlineSuggestionsResultBody";const h=e=>{var{styles:t,group:o,entryIndex:n,itemsCount:r,cumulativeCount:s,onGroupSelected:a,updateMenuLayout:u,updateItemHeight:d,showPartialLoadingEntities:g}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["styles","group","entryIndex","itemsCount","cumulativeCount","onGroupSelected","updateMenuLayout","updateItemHeight","showPartialLoadingEntities"]);const p=i.useCallback((()=>null==a?void 0:a(o)),[a,o]),f=i.useCallback((e=>u((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[n].headerHeight=e}))),[]),m=i.useCallback((e=>u((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),t.groupLayouts[n].extraSpaceBottomHeight=e}))),[]),v=i.useCallback((e=>u((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[n].separatorHeight=e}))),[]),y=i.useCallback(((e,t)=>u((o=>{o.groupLayouts[n]||(o.groupLayouts[n]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),o.groupLayouts[n].itemHeights[t]=e}))),[]);return i.createElement(l.K,Object.assign({},h,{group:o,accessibilitySetSize:r,headerHtmlId:(0,c.Bn)(s),headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:s,onHeaderClick:p,onHeaderHeightChange:f,onHeightExtraSpaceBottomChange:m,onSeparatorHeightChange:v,itemsStyles:null==t?void 0:t.itemsStyles,onItemHeightChange:y,updateItemHeight:d,showPartialLoadingEntities:g}))}},44943:(e,t,o)=>{"use strict";o.d(t,{Bn:()=>a,E9:()=>i,Es:()=>r,Jx:()=>c,MN:()=>u,O5:()=>l,Oz:()=>d,WM:()=>s,al:()=>n});const i="noSuggestions",n=2e3,r="Retry",s="ClearSearch",a=(e,t)=>(t?"header-option":"option")+e,l=e=>!!e&&("InlineSuggestionsResultsUserInitiatedMenuType"===e.menuType?void 0!==e.brandingMode:"InlineSuggestionsResultsFlagMenuType"===e.menuType),c=e=>e&&"actions"in e?e.actions:[],u=e=>"https://www.bing.com/q="+e,d=(e=!1,t,o,n,a,l,c)=>{if(e&&o)return[];const u=g(a);if(t)return[Object.assign(Object.assign({},l),{disableTooltips:!0,suggestions:[{id:r,type:i,title:n.inlineSuggestions("tryAgainLabel"),noSuggestionsDescription:n.inlineSuggestions("somethingWentWrongLabel")}]}),...u.filter((e=>e.alwaysDisplay))];if(o||c){const e=o?"clearSearchLabel":"showAvailableSuggestionsLabel";return[Object.assign(Object.assign({},l),{disableTooltips:!0,suggestions:[{id:s,type:i,title:n.inlineSuggestions(e),noSuggestionsDescription:n.common("suggestionsGroupNoSuggestionsText")}]}),...u.filter((e=>e.alwaysDisplay))]}return u},g=e=>{if(e instanceof Array){const t=[];return e.forEach((e=>t.push(g(e)))),t}if("object"==typeof e){const t={};for(const o in e)t[o]=g(e[o]);return t}return e}},33719:(e,t,o)=>{"use strict";o.d(t,{y:()=>s});var i=o(95734),n=o(72124),r=o(29088);const s=i.memo((e=>{var t,o,s,a,l,c,u,d,g,h,p,f,m,v,{style:y,theme:b}=e,S=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["style","theme"]);return i.createElement(i.Fragment,null,i.createElement(n.S,{style:{marginBottom:null!==(t=null==y?void 0:y.marginBottom)&&void 0!==t?t:8,marginTop:null!==(o=null==y?void 0:y.marginTop)&&void 0!==o?o:8,marginStart:null!==(s=null==y?void 0:y.marginStart)&&void 0!==s?s:0,marginEnd:null!==(a=null==y?void 0:y.marginEnd)&&void 0!==a?a:12,width:"100%",minWidth:0}},i.createElement(r.G,Object.assign({},S,{autoComplete:!1,spellCheck:!1,accessibilityLabel:"InlineSuggestionsSearchBox",styles:{borderRadius:4,width:"100%",borderBottom:`${null===(l=null==b?void 0:b.searchBox)||void 0===l?void 0:l.borderBottomColor} solid 1px`},theme:{background:null==b?void 0:b.background.resting,textColor:null===(c=null==b?void 0:b.text)||void 0===c?void 0:c.resting,placeholderTextColor:null===(u=null==b?void 0:b.text)||void 0===u?void 0:u.disabled,clearButton:{hover:null===(d=null==b?void 0:b.background)||void 0===d?void 0:d.hover,resting:null===(g=null==b?void 0:b.background)||void 0===g?void 0:g.resting},iconColor:null===(h=null==b?void 0:b.searchBox)||void 0===h?void 0:h.iconColor,borderColor:{hover:null===(f=null===(p=null==b?void 0:b.searchBox)||void 0===p?void 0:p.borderColor)||void 0===f?void 0:f.hover,resting:null===(v=null===(m=null==b?void 0:b.searchBox)||void 0===m?void 0:m.borderColor)||void 0===v?void 0:v.resting}}}))))}));s.displayName="InlineSuggestionsSearchBox"},74853:(e,t,o)=>{"use strict";o.d(t,{I:()=>c,n:()=>l});var i=o(95734);if(3023==o.j)var n=o(39134);if(3023==o.j)var r=o(34936);if(3023==o.j)var s=o(72124);if(3023==o.j)var a=o(30760);const l=({style:e})=>{var t,o,s,a;const l=null!==(t=null==e?void 0:e.itemPaddingVertical)&&void 0!==t?t:6,c=null!==(o=null==e?void 0:e.itemPaddingHorizontal)&&void 0!==o?o:12,u=null!==(s=null==e?void 0:e.textPaddingLeft)&&void 0!==s?s:8,d=null!==(a=null==e?void 0:e.personaCoinSize)&&void 0!==a?a:24;return i.createElement(n.E,{style:{paddingTop:l,paddingBottom:l,paddingLeft:c,paddingRight:c}},i.createElement("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:u,alignItems:"center"}},i.createElement(r.H,{shape:"circle",style:{width:d,height:d}}),i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:4,paddingTop:4,paddingBottom:4}},i.createElement(r.H,{style:{height:14}}),i.createElement(r.H,{style:{height:10,width:"80%"}}))))},c=({hideTitle:e,style:t})=>{var o,c;const u=null!==(o=null==t?void 0:t.itemPaddingHorizontal)&&void 0!==o?o:12,d=((null!==(c=null==t?void 0:t.titleLineHeight)&&void 0!==c?c:16)-12)/2+10;return i.createElement(s.S,{align:a.j5.Stretch,style:{width:"100%"}},!e&&i.createElement(n.E,{style:{paddingLeft:u,paddingRight:u}},i.createElement(r.H,{style:{height:12,width:80,marginTop:d,marginBottom:d}})),i.createElement(l,{style:t}),i.createElement(l,{style:t}),i.createElement(l,{style:t}),i.createElement(l,{style:t}),i.createElement(l,{style:t}))}},5610:(e,t,o)=>{"use strict";if(o.d(t,{H:()=>r}),3023==o.j)var i=o(75753);if(3023==o.j)var n=o(65315);const r=(e={},t)=>Object.assign(Object.assign({},e),{containerStyles:s(e.containerStyles,t),shimmerStyles:a(e),headerStyles:l(e.headerStyles),itemsStyles:u(e.itemsStyles,t),footerStyles:C(e.footerStyles)}),s=(e={},t)=>{var o,i;return Object.assign({minWidth:240,maxWidth:null!==(o=null==t?void 0:t.menuMaxWidth)&&void 0!==o?o:240,maxHeight:null!==(i=null==t?void 0:t.menuHeight)&&void 0!==i?i:252,borderRadius:8,paddingTop:4,paddingBottom:4,paddingHorizontal:4},e)},a=(e={})=>{var t,o,i,n,r,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({itemPaddingVertical:null!==(o=null==l?void 0:l.paddingVertical)&&void 0!==o?o:6,itemPaddingHorizontal:null!==(i=null==l?void 0:l.paddingHorizontal)&&void 0!==i?i:12,textPaddingLeft:null!==(n=null==l?void 0:l.textPaddingStart)&&void 0!==n?n:8,personaCoinSize:null!==(r=null==l?void 0:l.personaCoinSize)&&void 0!==r?r:24,titleLineHeight:null!==(a=null===(s=null==e?void 0:e.headerStyles)||void 0===s?void 0:s.titleLineHeight)&&void 0!==a?a:16},e.shimmerStyles)},l=(e={})=>Object.assign({},e),c=(e={},t={},o={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),n.ZD.item),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),n.ZD.description),t),e.description)}),u=(e={},t)=>({genericItemStyles:h(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:p(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:f(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:m(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:v(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:y(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:S(e.chatItemStyles,e.sharedItemStyles,t),appGptItemStyles:b(e.appGptItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:c(e.noSuggestionsStyles,e.sharedItemStyles,t)}),d=e=>{var t,o;return Object.assign(Object.assign({},n.cK),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:n.cK.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:n.cK.height})},g=e=>Object.assign(Object.assign({},n.nI),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),h=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)})},p=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e)},f=(e={},t={},o)=>Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)}),m=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)})},v=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)})},y=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)})},b=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)})},S=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign({width:24,height:24,borderRadius:20},null==e?void 0:e.iconStyles)})},C=(e={})=>Object.assign(Object.assign(Object.assign({},i.Y_),{height:45,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},33705:(e,t,o)=>{"use strict";o.d(t,{Y:()=>E});var i=o(95734),n=o(88239),r=o(7926),s=o(62956),a=o(60171),l=o(27408),c=o(87579),u=o(7143),d=o(25061),g=o(27760),h=o(63649),p=o(17543);const f=(0,g.X)({base:{D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"},outline:{g2u3we:"f1ly1fcm",h3c5rm:["fi8bssc","fj6btzu"],B9xav0g:"f1s9tnsa",zhjwy3:["fj6btzu","fi8bssc"],B4j52fo:"fgx37oo",Bekrc4i:["f130t4y6","f1efpmoh"],Bn0qgzm:"fv51ejd",ibv6hh:["f1efpmoh","f130t4y6"],sj55zd:"f14nttnl"},primary:{De3pzq:"f8w4g0q"},secondary:{De3pzq:"f1nfm20t",g2u3we:"f1ly1fcm",h3c5rm:["fi8bssc","fj6btzu"],B9xav0g:"f1s9tnsa",zhjwy3:["fj6btzu","fi8bssc"],sj55zd:"f14nttnl"},subtle:{De3pzq:"fq5gl1p",sj55zd:"f1eryozh"},transparent:{De3pzq:"f1q9pm1r",sj55zd:"f1qj7y59"}},{d:[".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}",".f1ly1fcm{border-top-color:var(--colorNeutralStroke1Selected);}",".fi8bssc{border-right-color:var(--colorNeutralStroke1Selected);}",".fj6btzu{border-left-color:var(--colorNeutralStroke1Selected);}",".f1s9tnsa{border-bottom-color:var(--colorNeutralStroke1Selected);}",".fgx37oo{border-top-width:var(--strokeWidthThicker);}",".f130t4y6{border-right-width:var(--strokeWidthThicker);}",".f1efpmoh{border-left-width:var(--strokeWidthThicker);}",".fv51ejd{border-bottom-width:var(--strokeWidthThicker);}",".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f8w4g0q{background-color:var(--colorBrandBackgroundSelected);}",".f1nfm20t{background-color:var(--colorNeutralBackground1Selected);}",".fq5gl1p{background-color:var(--colorSubtleBackgroundSelected);}",".f1eryozh{color:var(--colorNeutralForeground2Selected);}",".f1q9pm1r{background-color:var(--colorTransparentBackgroundSelected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"]}),m=(0,g.X)({outline:{sj55zd:"f14nttnl"},primary:{},secondary:{sj55zd:"f14nttnl"},subtle:{sj55zd:"f1qj7y59"},transparent:{sj55zd:"f1qj7y59"},highContrast:{ze5xyy:"f4xjyn1"}},{d:[".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"],m:[["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}]]}),v=(0,g.X)({base:{Bg96gwp:"fez10in"},small:{Be2twd7:"f1ugzwwg",Bqenvij:"fvblgha",Bg96gwp:"fwrc4pm",a9b677:"frx94fk"},medium:{Be2twd7:"f1ugzwwg",Bqenvij:"fvblgha",Bg96gwp:"fwrc4pm",a9b677:"frx94fk"},large:{Be2twd7:"f4ybsrx",Bqenvij:"fd461yt",Bg96gwp:"faaz57k",a9b677:"fjw5fx7"},notIconOnly:{Frg6f3:["fbyavb5","fm0x6gh"]}},{d:[".fez10in{line-height:0;}",".f1ugzwwg{font-size:12px;}",".fvblgha{height:12px;}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".frx94fk{width:12px;}",".f4ybsrx{font-size:16px;}",".fd461yt{height:16px;}",".faaz57k{line-height:var(--lineHeightBase400);}",".fjw5fx7{width:16px;}",".fbyavb5{margin-left:var(--spacingHorizontalXS);}",".fm0x6gh{margin-right:var(--spacingHorizontalXS);}"]});var y=o(89161);const b=i.forwardRef(((e,t)=>{const o=(({menuIcon:e,...t},o)=>{const n=(0,d.P)(t,o);return n.root["aria-expanded"]=!!t["aria-expanded"]&&("true"===t["aria-expanded"]||!0===t["aria-expanded"]),{...n,iconOnly:Boolean(!t.children),components:{root:"button",icon:"span",menuIcon:"span"},menuIcon:u.lq(e,{defaultProps:{children:i.createElement(c.yuG,null)},renderByDefault:!0,elementType:"span"})}})(e,t);return(e=>{const t=f(),o=m(),i=v();e.root.className=(0,h.z)("fui-MenuButton",e.root["aria-expanded"]&&t.base,e.root["aria-expanded"]&&t[e.appearance],e.root.className),e.icon&&(e.icon.className=(0,h.z)("fui-MenuButton__icon",e.root["aria-expanded"]&&o[e.appearance]&&o.highContrast,e.icon.className)),e.menuIcon&&(e.menuIcon.className=(0,h.z)("fui-MenuButton__menuIcon",i.base,i[e.size],!e.iconOnly&&i.notIconOnly,e.menuIcon.className)),(0,p.B)({...e,iconPosition:"before"})})(o),(0,y.$e)("useMenuButtonStyles_unstable")(o),(e=>{(0,l.C)(e);const{icon:t,iconOnly:o}=e;return(0,a.FD)(e.root,{children:[e.icon&&(0,a.Y)(e.icon,{}),!o&&e.root.children,(!o||!(null==t?void 0:t.children))&&e.menuIcon&&(0,a.Y)(e.menuIcon,{})]})})(o)}));b.displayName="MenuButton";var S=o(62611),C=o(30850),w=o(36865);const k=i.memo((({menuButtonText:e,menuButtonIcon:t,enableMenuButtonIcon:o,menuItems:a,open:l,isUploadButtonHighlighted:c,onOpenChange:u,onClick:d})=>{const g=i.useRef(null);i.useEffect((()=>{var e;c&&(null===(e=g.current)||void 0===e||e.focus())}),[c]);const h=a.map(((e,t)=>i.createElement(n.D,{key:t,icon:e.enableMenuItemIcon&&e.menuItemIcon?i.createElement(w.In,{type:e.menuItemIcon,filled:!0}):void 0,onClick:()=>e.onClickHandler()},e.menuItemText)));return i.createElement(r.W,{positioning:"below-end",open:l,onOpenChange:u},i.createElement(s.c,{disableButtonEnhancement:!0},i.createElement(b,{ref:g,id:"uploadFileButton",menuIcon:null,onClick:d,icon:o&&t?i.createElement(w.In,{type:t}):void 0},e)),i.createElement(S.b,null,i.createElement(C.c,null,h)))}));k.displayName="FluentMenu";var T=o(59523),x=o(72124),_=o(30760),I=o(65315);const E=i.memo((e=>{var{fluentMenuConfig:t,enableCloudPicker:o,strings:n,theme:r,uploadFileButtonLabel:s,onClickBrowseThisComputer:a,hasSelectionBeenModifiedViaKeyboard:l,iconOnly:c,isUploadButtonHighlighted:u,open:d,onOpenChange:g}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["fluentMenuConfig","enableCloudPicker","strings","theme","uploadFileButtonLabel","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard","iconOnly","isUploadButtonHighlighted","open","onOpenChange"]);const p=(0,I.z0)(c),f=o&&t?i.createElement(k,{enableMenuButtonIcon:t.enableMenuButtonIcon,menuButtonIcon:"ArrowUpload",menuButtonText:t.menuButtonText,menuItems:t.menuItems,isUploadButtonHighlighted:u,open:d,onOpenChange:g,onClick:a}):i.createElement(T.u,Object.assign({},h,{style:p.style,accessibilityRole:"menuitem",automationLabel:"InlineSuggestionsBrowseThisComputer",title:c?void 0:s,icon:{type:"ArrowUpload",style:Object.assign(Object.assign({},p.icon),{width:16,height:16})},onClick:a,theme:r,isSelectedByKeyboard:l}));return i.createElement(x.S,{direction:_.PR.LeftToRight,align:_.j5.Stretch},f)}));E.displayName="InlineSuggestionsUploadFile"},58743:(e,t,o)=>{"use strict";function i(e,t,o){var i;return(null!==(i=e.inlineSuggestions("combineSentences"))&&void 0!==i?i:"{0}. {1}").replace("{0}",t).replace("{1}",o)}o.d(t,{w:()=>i})},97928:(e,t,o)=>{"use strict";if(o.d(t,{$d:()=>f,Dj:()=>S,FP:()=>y,Fr:()=>C,JE:()=>c,T_:()=>b,Ui:()=>h,VD:()=>m,fj:()=>v,nk:()=>l,vA:()=>d,wK:()=>p,yi:()=>u,zN:()=>g}),3023==o.j)var i=o(44943);if(3023==o.j)var n=o(55672);if(3023==o.j)var r=o(43463);const s={background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},text:{resting:"#201F1E",disabled:"#707070"},altText:{resting:"#605E5C"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5",highlightingBorderColor:"#201f1e",shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},focusRing:"#323130",searchBox:{borderColor:{resting:"#D1D1D1",hover:"#D1D1D1"},borderBottomColor:"#464FEB",iconColor:"#424242"},tooltip:{directionHint:1},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}},a={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)",highlightingBorderColor:"var(--colorStrokeFocus2)",focusRing:"var(--colorStrokeFocus2)",footerButtonBackground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},noSuggestions:{descriptionTextColor:"var(--colorNeutralForeground2)",item:{background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorNoSuggestionsTextColorHover, var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover)))",disabled:"var(--colorNeutralForegroundDisabled)"},actionButtonForeground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)"}},actionButtonForeground:{resting:"var(--editorActionButtonForegroundResting)",hover:"var(--editorActionButtonForegroundHover)",pressed:"var(--editorActionButtonForegroundPressed)",disabled:"var(--editorActionButtonForegroundDisabled)"},shimmer:{shimmerColor:"var(--editorShimmerColor)",shimmerWaveColor:"var(--editorShimmerWaveColor)"},scroll:{thumbColor:"var(--editorScrollThumbColor)"},searchBox:{borderColor:{resting:"var(--editorSearchBoxBorderColorResting)",hover:"var(--editorSearchBoxBorderColorHover)"},borderBottomColor:"var(--editorSearchBoxBorderBottomColor)",iconColor:"var(--editorSearchBoxIconColor)"},tooltip:{directionHint:1},tag:{background:"var(--editorTagBackground)",textColor:"var(--editorTagTextColor)"},meetingBanner:{backgroundColor:"var(--editorMeetingBannerBackgroundColor)",text:"var(--editorMeetingBannerText)",iconPrimaryColor:"var(--editorMeetingBannerIconPrimaryColor)",borderColor:"var(--editorMeetingBannerBorderColor)"}},l=(e,t)=>{var o,i;return t?Object.assign(Object.assign({},a),{branding:e?null===(o=n.no[e])||void 0===o?void 0:o.v9:void 0}):Object.assign(Object.assign({},s),{branding:e?null===(i=n.no[e])||void 0===i?void 0:i.v8[r.SV.light]:void 0})};function c(e,t){const o=Object.assign({},e.background);let i;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,border:i,title:Object.assign({},e.text)}}function u(e,t,o){return e===i.E9?function(e,t){var o,i,n;const r=null===(o=null==e?void 0:e.noSuggestions)||void 0===o?void 0:o.item;if(r){const e=Object.assign(Object.assign({},r.background),{disabled:void 0}),o=Object.assign(Object.assign({},r.text),{focused:r.text.hover});return t&&r.highlighting&&(o.resting=null!==(i=o.focused)&&void 0!==i?i:o.resting,e.resting=r.highlighting),{background:e,title:o,focusRing:"transparent"}}const a=null!=e?e:s,l=Object.assign(Object.assign({},a.background),{disabled:void 0}),c=Object.assign(Object.assign({},a.actionButtonForeground),{focused:a.actionButtonForeground.hover});return t&&a.highlighting&&(c.resting=null!==(n=c.focused)&&void 0!==n?n:c.resting,l.resting=a.highlighting),{background:l,title:c,focusRing:"transparent"}}(t,o):d(null!=t?t:s,o)}function d(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0}),i=Object.assign({},e.text),n=e.altText?Object.assign({},e.altText):void 0;let r;return t&&(e.highlighting&&(o.resting=e.highlighting,r=e.highlightingBorderColor),i.hover&&(i.resting=i.hover),(null==n?void 0:n.hover)&&(n.resting=n.hover)),{background:o,title:i,subtitle:n,focusRing:"transparent",border:r,tooltip:e.tooltip,underline:e.headerUnderlineColor}}function g(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});let i;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,title:e.actionButtonForeground,subtitle:e.altText,focusRing:"transparent",border:i}}function h(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function p(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent",border:"1px solid #D1D1D1"}}function f(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function m(e){return{background:{resting:"transparent",hover:"transparent"},title:e.actionButtonForeground}}function v(e){var t;return{focusRing:null!==(t=e.focusRing)&&void 0!==t?t:"#323130"}}function y(e,t){var o,n,r,a;const l=null!==(o=s.text.disabled)&&void 0!==o?o:s.text.resting;return e.type===i.E9?null!==(r=null===(n=null==t?void 0:t.noSuggestions)||void 0===n?void 0:n.descriptionTextColor)&&void 0!==r?r:l:null!==(a=null==t?void 0:t.text.disabled)&&void 0!==a?a:l}function b(e){var t,o;return{overflowItem:{resting:e.background.resting,hover:null!==(t=e.background.hover)&&void 0!==t?t:"#F5F5F5",color:null===(o=e.fallbackIcon)||void 0===o?void 0:o.color}}}const S=e=>{var t,o;if(e)return Object.assign(Object.assign({},e),{background:null!==(t=e.footerButtonBackground)&&void 0!==t?t:e.background,header:"",subheader:"",dialogText:"",iconText:"",contextText:"",errorText:"",border:"",separator:"",focusRing:null!==(o=e.focusRing)&&void 0!==o?o:"",link:"",linkPressed:"",tag:void 0})},C=(e,t)=>{const o={backgroundColor:e.background.resting};return t&&(o.borderColor="#E1DFDD"),o}},55672:(e,t,o)=>{"use strict";if(o.d(t,{C_:()=>g,ET:()=>u,Eq:()=>f,_s:()=>p,m0:()=>c,m7:()=>h,no:()=>a,pd:()=>d,qv:()=>v,zB:()=>m}),3023==o.j)var i=o(27326);if(3023==o.j)var n=o(74505);if(3023==o.j)var r=o(62670);var s=o(43463);const a={[s.nH.Text]:{v8:{[s.SV.light]:{type:"Text",textColor:"#616161"},[s.SV.dark]:{type:"Text",textColor:"#616161"}},v9:{type:"Text",textColor:"var(--editorTextBrandingTextColor, var(--colorNeutralForeground2))"}},[s.nH.Icon]:{v8:{[s.SV.light]:{type:"Icon",iconColor:"#616161"},[s.SV.dark]:{type:"Icon",iconColor:"#616161"}},v9:{type:"Icon",iconColor:"var(--editorIconBrandingIconColor, var(--colorNeutralForeground2))"}},[s.nH.IconButton]:{v8:{[s.SV.light]:{type:"IconButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#616161",disabled:"#BDBDBD"},focusRing:"#323130"},[s.SV.dark]:{type:"IconButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1"},focusRing:"#323130"}},v9:{type:"IconButton",background:{resting:"var(--editorIconButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconButtonBrandingIconResting, var(--colorNeutralForeground2))",disabled:"var(--editorIconButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconButtonBrandingFocusRing, var(--colorStrokeFocus2))"}},[s.nH.IconAndTextButton]:{v8:{[s.SV.light]:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},[s.SV.dark]:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#6794D7"},title:{resting:"#6794D7"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"}},v9:{type:"IconAndTextButton",background:{resting:"var(--editorIconAndTextButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconAndTextButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconAndTextButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconAndTextButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},title:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconAndTextButtonBrandingFocusRing, var(--colorStrokeFocus2))"}}};function l(e,t){const o=Object.assign({},e);return t&&(null==o?void 0:o.hover)&&(o.resting=o.hover),o}const c=(e,t)=>{var o,i;if(void 0===e)return;e===s.nH.MonochromeIcon&&(e=s.nH.Icon);const n=a[e];if(void 0===n)return;const r=null!==(o=null==t?void 0:t.themeType)&&void 0!==o?o:s.SV.light;return(null==t?void 0:t.useFluentV9)?n.v9:null!==(i=n.v8[r])&&void 0!==i?i:n.v9};function u(e,t,o){const n="Text"===(null==e?void 0:e.type)?e:c(s.nH.Text,o);return{fontWeight:i.IT.SemiBold,fontSize:t.xsmall,cssColor:null==n?void 0:n.textColor}}function d(e,t,o){const r="Text"===(null==e?void 0:e.type)?e:c(s.nH.Text,o);return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:t.small,cssColor:null==r?void 0:r.textColor,userSelectable:!1}}function g(e,t){return("Icon"===(null==e?void 0:e.type)?e:c(s.nH.Icon,t)).iconColor}function h(e,t,o){var i;const n="IconButton"===(null==e?void 0:e.type)?e:c(s.nH.IconButton,o),r=l(n.icon,t);return Object.assign(Object.assign({},n),{background:Object.assign(Object.assign({},n.background),{resting:t&&null!==(i=n.background.hover)&&void 0!==i?i:n.background.resting}),title:r,icon:r,border:t?n.focusRing:void 0})}function p(e,t,o){var i;const n="IconAndTextButton"===(null==e?void 0:e.type)?e:c(s.nH.IconAndTextButton,o);return Object.assign(Object.assign({},n),{background:Object.assign(Object.assign({},n.background),{resting:t&&null!==(i=n.background.hover)&&void 0!==i?i:n.background.resting}),title:l(n.title,t),icon:l(n.icon,t),border:t?n.focusRing:void 0})}function f(e){return{textAlign:r.R.Center,borderRadius:4,iconFontSize:e.xlarge,paddingHorizontal:7,paddingBottom:0,textHorizontalPadding:0,iconTextSpacing:3}}function m(e){return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:e.small}}function v(e){return{textAlign:r.R.Center,borderRadius:4,iconFontSize:e.xsmall}}},78218:(e,t,o)=>{"use strict";function i(e,t){return t<0||e.length<=t?e:e.substring(0,t).concat("…")}function n(e){const t=(e=(e=e.replace(/https:\/\//i,"")).replace(/http:\/\//i,"")).indexOf("/");return t>0?e.substring(0,t):e}function r(e,...t){if(t&&Array.isArray(t))for(let o=0;o<t.length;o++)e=e.replace(`{${o}}`,t[o].toString());return e}o.d(t,{EE:()=>i,JT:()=>r,SE:()=>n})},75753:(e,t,o)=>{"use strict";o.d(t,{$d:()=>H,B1:()=>z,B7:()=>w,B8:()=>se,Bd:()=>J,D0:()=>G,Dd:()=>$,F6:()=>Q,GP:()=>A,HV:()=>ie,ID:()=>f,J2:()=>M,JP:()=>v,LO:()=>F,MW:()=>D,Oc:()=>_,Ot:()=>K,P4:()=>L,PN:()=>de,Ps:()=>oe,QL:()=>a,RU:()=>U,VP:()=>y,Vn:()=>C,W0:()=>pe,WC:()=>p,Wi:()=>l,Xp:()=>ne,YV:()=>T,Y_:()=>m,_e:()=>P,cK:()=>I,cq:()=>ue,d4:()=>g,dG:()=>le,dU:()=>N,db:()=>he,eO:()=>X,ej:()=>ce,gc:()=>s,i6:()=>ge,k:()=>E,ki:()=>ee,kw:()=>S,lI:()=>k,lT:()=>h,lb:()=>te,nV:()=>Z,ol:()=>d,qL:()=>B,qw:()=>re,tJ:()=>x,uI:()=>W,uY:()=>Y,vP:()=>b,vy:()=>u,yl:()=>R,ys:()=>ae});var i=o(27326),n=o(62670);if(3023==o.j)var r=o(74505);const s=3,a=16,l=3,c=8,u={background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#F3F2F1"},text:{resting:"#201F1E",disabled:"#A19F9D"},tooltip:{textColor:"#201F1E",backgroundColor:"#FFFFFF"},tag:{resting:"#201F1E"},altText:{resting:"#605E5C"},icon:{resting:"#757470",disabled:"#CCCCCC"},altIcon:{resting:"#616161",hover:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A45B6"},rewriteText:{resting:"#5A45B6"},suggestionMenuHoverBackground:"#E1DFDD",primaryButtonBackground:{resting:"#2E6AC5",hover:"#1651AA",pressed:"#0E336A",disabled:"#F3F2F1"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},header:"#3B3A39",subheader:"#605E5C",dialogText:"#323130",iconText:"#201F1E",contextText:"#201F1E",errorText:"red",border:"#201F1E",separator:"#E6E6E6",focusRing:"#969696",link:"#1651AA",linkPressed:"#002050",addOnFooterBackground:"#F2F6FD",addOnFooterMessage:"#11100F",addOnHeaderBackground:"#ebf3fc",premiumEmphasis:"#2E6AC5",addOnAction:"#2E6AC5",editorIcon:"#185ABD",accessibilityIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",focused:"#1651AA",pressed:"#0E336A"},focusRing:"#323130"},badgeBackground:"#185ABD",badgeText:"#FFFFFF"},d={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},suggestionMenuHoverForeground:"var(--colorNeutralForeground1Hover)",suggestionMenuHoverBackground:"var(--colorNeutralBackground1Hover)",tag:{resting:"var(--editorTagResting)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--editorAltTextResting)",disabled:"var(--colorNeutralForegroundDisabled)"},grammarText:{resting:"var(--editorGrammarTextResting)",hover:"var(--editorGrammarTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},refinementText:{resting:"var(--editorRefinementTextResting)",hover:"var(--editorRefinementTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},rewriteText:{resting:"var(--editorRewriteTextResting)",hover:"var(--editorRewriteTextHover)"},primaryButtonBackground:{resting:"var(--editorPrimaryButtonBackgroundResting)",hover:"var(--editorPrimaryButtonBackgroundHover)",pressed:"var(--editorPrimaryButtonBackgroundPressed)",disabled:"var(--editorPrimaryButtonBackgroundDisabled)"},primaryButtonText:{resting:"var(--editorPrimaryButtonTextResting)",disabled:"var(--editorPrimaryButtonTextDisabled)"},header:"var(--editorHeader)",subheader:"var(--editorSubheader)",dialogText:"var(--editorDialogText)",iconText:"var(--editorIconText)",contextText:"var(--editorContextText)",errorText:"var(--editorErrorText)",border:"var(--editorBorder)",separator:"var(--editorSeparator)",focusRing:"var(--editorFocusRing)",addOnFooterBackground:"var(--editorAddOnFooterBackground)",addOnFooterMessage:"var(--editorAddOnFooterMessage)",addOnHeaderBackground:"var(--editorAddOnHeaderBackground)",premiumEmphasis:"var(--editorPremiumEmphasis)",addOnAction:"var(--editorAddOnAction)",editorIcon:"var(--editorEditorIcon)",accessibilityIcon:"var(--editorAccessibilityIcon)",correctionHighlight:"var(--editorCorrectionHighlight)",helpLink:{text:{resting:"var(--editorHelpLinkTextResting)",hover:"var(--editorHelpLinkTextHover)",focused:"var(--editorHelpLinkTextFocused)",pressed:"var(--editorHelpLinkTextPressed)"},focusRing:"var(--editorHelpLinkFocusRing)"},badgeBackground:"var(--editorBadgeBackground)",badgeText:"var(--editorBadgeText)"},g=(i.RV.Single,n.R.Center,{x4small:7,x3small:8,xxsmall:10,xsmall:12,small:14,medium:16,large:18,xlarge:20,xxlarge:22}),h={xsmall:8,small:12,medium:16},p={paddingHorizontal:a,paddingTop:10,paddingBottom:8},f={paddingHorizontal:a,paddingBottom:8},m={paddingHorizontal:c,paddingVertical:4,gap:4},v={paddingHorizontal:12,paddingVertical:8,backgroundColor:"#EBF3FC",marginTop:4,marginBottom:-8},y={width:32,height:32},b={paddingHorizontal:8,fontSize:12},S={paddingHorizontal:a,flexibleSize:!0,borderRadius:4};function C(e){var t,o;return Object.assign(Object.assign({},e),{paddingHorizontal:null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:a-c,borderRadius:null!==(o=null==e?void 0:e.borderRadius)&&void 0!==o?o:4})}function w(e){var t;return Object.assign(Object.assign({},e),{tooltipProps:null==e?void 0:e.tooltipButtonStyles,borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:4})}function k(e){var t;return Object.assign(Object.assign({},e),{borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:4})}n.R.Center;const T={marginTop:14};function x(e,t){return{backgroundColor:null==t?void 0:t.background.resting,minWidth:e?e.minWidth:void 0,maxWidth:e?e.maxWidth:void 0,paddingHorizontal:16,paddingTop:6,paddingBottom:22}}const _={paddingHorizontal:0,paddingVertical:0,borderThickness:0},I={marginHorizontal:a};function E(e,t,o){return{fontWeight:i.IT.SemiBold,fontFamily:r.V,fontSize:t.xsmall,cssColor:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralForeground1)":e.header}}function A(e,t,o){let n=t.xsmall;((null==o?void 0:o.isLargeHeader)||(null==o?void 0:o.isIconHeader))&&(n=(null==o?void 0:o.isLargeHeader)?t.xxlarge:t.xxsmall);const s=(null==o?void 0:o.isIconHeader)?e.iconText:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralForeground2)":e.subheader;return{fontWeight:(null==o?void 0:o.isIconHeader)?i.IT.SemiBold:i.IT.Normal,fontFamily:r.V,fontSize:n,cssColor:s}}function B(e,t){return{fontWeight:i.IT.SemiBold,fontFamily:r.V,fontSize:t.xsmall,cssColor:e.subheader}}function R(e,t){return{cssColor:e.contextText,fontSize:t.small}}function M(e,t){return{cssColor:e.addOnAction,fontSize:t.xlarge,fontWeight:i.IT.SemiBold,marginVertical:6}}function D(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,marginVertical:6,lineHeight:16}}function P(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,lineHeight:16}}function N(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,fontWeight:i.IT.SemiBold,lineHeight:16}}function F(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,lineHeight:16,fontWeight:i.IT.SemiBold,italic:!0}}function O(e,t,o){var i;return"primary"===t&&e.primaryButtonBackground?Object.assign(Object.assign({},e.primaryButtonBackground),{focused:e.primaryButtonBackground.hover}):"dialog"===t?Object.assign(Object.assign({},e.background),{focused:e.background.hover}):o?{resting:null!==(i=e.background.hover)&&void 0!==i?i:"",disabled:void 0}:Object.assign(Object.assign({},e.background),{disabled:void 0})}function j(e,t){return"primary"===t&&e.primaryButtonText?e.primaryButtonText:"grammar"===t&&e.grammarText?e.grammarText:"refinement"===t&&e.refinementText?e.refinementText:e.text}function q(e,t,o){var i;let n=t&&null!==(i=e.altIcon)&&void 0!==i?i:e.icon;return n=n&&Object.assign({},n),o&&(null==n?void 0:n.hover)&&(n.resting=n.hover),n}function L(e,t,o,i){return{background:O(e,t,i),title:j(e,t),tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:q(e,o,i),border:"dialog"===t||"primary"===t?e.border:i?e.focusRing:void 0,focusRing:e.focusRing}}function H(e,t){var o;let i=null!==(o=e.altIcon)&&void 0!==o?o:e.icon;return i=Object.assign(Object.assign({},i),{resting:i.hover}),{background:O(e,void 0,t),title:i,tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:i,border:t?e.focusRing:void 0,focusRing:e.focusRing}}function z(e,t){return Object.assign(Object.assign({},L(e,void 0,!0,t)),{separator:e.separator})}function W(e,t,o){return{minWidth:t?t.minWidth:void 0,maxWidth:t?t.maxWidth:void 0,minHeight:t?t.minHeight:void 0,maxHeight:t?t.maxHeight:void 0,backgroundColor:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralBackground1)":e.background.resting,borderRadius:(null==t?void 0:t.hasBottomAttachment)?{topStart:8,topEnd:8}:8}}function G(e,t,o,n){return[{start:0,length:t,fontWeight:o?i.IT.Normal:i.IT.SemiBold,fontFamily:r.V,fontSize:n||e.small}]}function U(e){return{fontFamily:r.V,fontWeight:i.IT.Normal,fontSize:e.xsmall}}function V(e,t){return[{start:0,length:t,fontWeight:i.IT.Normal,fontFamily:r.V,fontSize:e.small}]}const $=3023==o.j?V:null,K=3023==o.j?V:null;function J(e){return{paddingHorizontal:8,borderRadius:2,iconFontSize:e.medium}}function Z(e){return{paddingHorizontal:8,borderRadius:4,iconFontSize:e.xlarge}}function Y(e,t){var o;return{paddingHorizontal:8,borderRadius:null!==(o=null==t?void 0:t.borderRadius)&&void 0!==o?o:4,iconFontSize:e.xlarge}}function Q(e,t){return{fontWeight:i.IT.Normal,fontSize:e.xsmall,cssColor:t.subheader}}function X(e){return{fontSize:e.xsmall,fontWeight:i.IT.SemiBold}}function ee(e){return{color:e.subheader,hoverColor:e.link,pressedColor:e.linkPressed,focusRing:e.focusRing}}function te(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,fontWeight:i.IT.SemiBold}}function oe(e){return{fontWeight:i.IT.Normal,fontSize:e.xxsmall}}function ie(e,t){return{fontWeight:i.IT.SemiBold,fontSize:t.xxsmall,cssColor:e.text.resting}}function ne(){return{lineHeight:20,truncate:!0}}function re(e,t,o,n){return{fontWeight:i.IT.Normal,fontFamily:r.V,fontSize:n||(t?e.xxsmall:e.xsmall),width:"100%",truncate:!!o,height:14}}function se(e){return{paddingTop:e.small,paddingBottom:3*e.small,paddingHorizontal:e.medium,widths:["91%","96%","71%"]}}function ae(e){return{paddingHorizontal:e.xsmall,widths:[5*e.medium]}}function le(e){var t,o,i,n,r;return{color:null===(t=e.helpLink)||void 0===t?void 0:t.text.resting,hoverColor:null===(o=e.helpLink)||void 0===o?void 0:o.text.hover,focusColor:null===(i=e.helpLink)||void 0===i?void 0:i.text.focused,pressedColor:null===(n=e.helpLink)||void 0===n?void 0:n.text.pressed,focusRing:e.helpLink?null===(r=e.helpLink)||void 0===r?void 0:r.focusRing:e.focusRing}}function ce(e){return{fontSize:e.xxsmall}}const ue={marginHorizontal:16,marginVertical:10};function de(){return{marginVertical:6}}function ge(){return{paddingStart:0,paddingEnd:10,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}}function he(){return{paddingStart:10,paddingEnd:0,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}}i.IT.SemiBold,n.R.Center;const pe=(e,t)=>{var o;return null!==(o=e.theme)&&void 0!==o?o:t?d:u}},6422:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>r}),3023==o.j)var i=o(43463);if(3023==o.j)var n=o(17321);function r(e,t,o,r){if(o&&r)for(const s of r)switch(s.decorationType){case n.v.Spelling:{const n=o.substr(s.start,s.length);return t===i.L9.RepeatedWord?e("contextAccessibilityLabelForRepeatedWord").replace("{0}",n).replace("{1}",o):e("contextAccessibilityLabelForSpelling").replace("{0}",n).replace("{1}",o)}case n.v.Grammar:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForGrammar").replace("{0}",t).replace("{1}",o)}case n.v.Refinement:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForRefinement").replace("{0}",t).replace("{1}",o)}case n.v.Modification:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForCorrection").replace("{0}",t).replace("{1}",o)}}}},74246:(e,t,o)=>{"use strict";var i;o.d(t,{h:()=>i}),function(e){e[e.Accept=0]="Accept",e[e.Ignore=1]="Ignore",e[e.Reject=2]="Reject",e[e.OpenEditorSettings=3]="OpenEditorSettings",e[e.DismissRejectMessage=4]="DismissRejectMessage"}(i||(i={}))},68008:e=>{var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},o=-1;t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,o,i,n){void 0===n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==e||null==o)throw new Error("Null input. (diff_main)");if(e==o)return e?[new t.Diff(0,e)]:[];void 0===i&&(i=!0);var s=i,a=this.diff_commonPrefix(e,o),l=e.substring(0,a);e=e.substring(a),o=o.substring(a),a=this.diff_commonSuffix(e,o);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),o=o.substring(0,o.length-a);var u=this.diff_compute_(e,o,s,r);return l&&u.unshift(new t.Diff(0,l)),c&&u.push(new t.Diff(0,c)),this.diff_cleanupMerge(u),u},t.prototype.diff_compute_=function(e,i,n,r){var s;if(!e)return[new t.Diff(1,i)];if(!i)return[new t.Diff(o,e)];var a=e.length>i.length?e:i,l=e.length>i.length?i:e,c=a.indexOf(l);if(-1!=c)return s=[new t.Diff(1,a.substring(0,c)),new t.Diff(0,l),new t.Diff(1,a.substring(c+l.length))],e.length>i.length&&(s[0][0]=s[2][0]=o),s;if(1==l.length)return[new t.Diff(o,e),new t.Diff(1,i)];var u=this.diff_halfMatch_(e,i);if(u){var d=u[0],g=u[1],h=u[2],p=u[3],f=u[4],m=this.diff_main(d,h,n,r),v=this.diff_main(g,p,n,r);return m.concat([new t.Diff(0,f)],v)}return n&&e.length>100&&i.length>100?this.diff_lineMode_(e,i,r):this.diff_bisect_(e,i,r)},t.prototype.diff_lineMode_=function(e,i,n){var r=this.diff_linesToChars_(e,i);e=r.chars1,i=r.chars2;var s=r.lineArray,a=this.diff_main(e,i,!1,n);this.diff_charsToLines_(a,s),this.diff_cleanupSemantic(a),a.push(new t.Diff(0,""));for(var l=0,c=0,u=0,d="",g="";l<a.length;){switch(a[l][0]){case 1:u++,g+=a[l][1];break;case o:c++,d+=a[l][1];break;case 0:if(c>=1&&u>=1){a.splice(l-c-u,c+u),l=l-c-u;for(var h=this.diff_main(d,g,!1,n),p=h.length-1;p>=0;p--)a.splice(l,0,h[p]);l+=h.length}u=0,c=0,d="",g=""}l++}return a.pop(),a},t.prototype.diff_bisect_=function(e,i,n){for(var r=e.length,s=i.length,a=Math.ceil((r+s)/2),l=a,c=2*a,u=new Array(c),d=new Array(c),g=0;g<c;g++)u[g]=-1,d[g]=-1;u[l+1]=0,d[l+1]=0;for(var h=r-s,p=h%2!=0,f=0,m=0,v=0,y=0,b=0;b<a&&!((new Date).getTime()>n);b++){for(var S=-b+f;S<=b-m;S+=2){for(var C=l+S,w=(I=S==-b||S!=b&&u[C-1]<u[C+1]?u[C+1]:u[C-1]+1)-S;I<r&&w<s&&e.charAt(I)==i.charAt(w);)I++,w++;if(u[C]=I,I>r)m+=2;else if(w>s)f+=2;else if(p&&(x=l+h-S)>=0&&x<c&&-1!=d[x]&&I>=(T=r-d[x]))return this.diff_bisectSplit_(e,i,I,w,n)}for(var k=-b+v;k<=b-y;k+=2){for(var T,x=l+k,_=(T=k==-b||k!=b&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-k;T<r&&_<s&&e.charAt(r-T-1)==i.charAt(s-_-1);)T++,_++;if(d[x]=T,T>r)y+=2;else if(_>s)v+=2;else if(!p){var I;if((C=l+h-k)>=0&&C<c&&-1!=u[C])if(w=l+(I=u[C])-C,I>=(T=r-T))return this.diff_bisectSplit_(e,i,I,w,n)}}}return[new t.Diff(o,e),new t.Diff(1,i)]},t.prototype.diff_bisectSplit_=function(e,t,o,i,n){var r=e.substring(0,o),s=t.substring(0,i),a=e.substring(o),l=t.substring(i),c=this.diff_main(r,s,!1,n),u=this.diff_main(a,l,!1,n);return c.concat(u)},t.prototype.diff_linesToChars_=function(e,t){var o=[],i={};function n(e){for(var t="",n=0,s=-1,a=o.length;s<e.length-1;){-1==(s=e.indexOf("\n",n))&&(s=e.length-1);var l=e.substring(n,s+1);(i.hasOwnProperty?i.hasOwnProperty(l):void 0!==i[l])?t+=String.fromCharCode(i[l]):(a==r&&(l=e.substring(n),s=e.length),t+=String.fromCharCode(a),i[l]=a,o[a++]=l),n=s+1}return t}o[0]="";var r=4e4,s=n(e);return r=65535,{chars1:s,chars2:n(t),lineArray:o}},t.prototype.diff_charsToLines_=function(e,t){for(var o=0;o<e.length;o++){for(var i=e[o][1],n=[],r=0;r<i.length;r++)n[r]=t[i.charCodeAt(r)];e[o][1]=n.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var o=0,i=Math.min(e.length,t.length),n=i,r=0;o<n;)e.substring(r,n)==t.substring(r,n)?r=o=n:i=n,n=Math.floor((i-o)/2+o);return n},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var o=0,i=Math.min(e.length,t.length),n=i,r=0;o<n;)e.substring(e.length-n,e.length-r)==t.substring(t.length-n,t.length-r)?r=o=n:i=n,n=Math.floor((i-o)/2+o);return n},t.prototype.diff_commonOverlap_=function(e,t){var o=e.length,i=t.length;if(0==o||0==i)return 0;o>i?e=e.substring(o-i):o<i&&(t=t.substring(0,o));var n=Math.min(o,i);if(e==t)return n;for(var r=0,s=1;;){var a=e.substring(n-s),l=t.indexOf(a);if(-1==l)return r;s+=l,0!=l&&e.substring(n-s)!=t.substring(0,s)||(r=s,s++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var o=e.length>t.length?e:t,i=e.length>t.length?t:e;if(o.length<4||2*i.length<o.length)return null;var n=this;function r(e,t,o){for(var i,r,s,a,l=e.substring(o,o+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var d=n.diff_commonPrefix(e.substring(o),t.substring(c)),g=n.diff_commonSuffix(e.substring(0,o),t.substring(0,c));u.length<g+d&&(u=t.substring(c-g,c)+t.substring(c,c+d),i=e.substring(0,o-g),r=e.substring(o+d),s=t.substring(0,c-g),a=t.substring(c+d))}return 2*u.length>=e.length?[i,r,s,a,u]:null}var s,a,l,c,u,d=r(o,i,Math.ceil(o.length/4)),g=r(o,i,Math.ceil(o.length/2));return d||g?(s=g?d&&d[4].length>g[4].length?d:g:d,e.length>t.length?(a=s[0],l=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],a=s[2],l=s[3]),[a,l,c,u,s[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var i=!1,n=[],r=0,s=null,a=0,l=0,c=0,u=0,d=0;a<e.length;)0==e[a][0]?(n[r++]=a,l=u,c=d,u=0,d=0,s=e[a][1]):(1==e[a][0]?u+=e[a][1].length:d+=e[a][1].length,s&&s.length<=Math.max(l,c)&&s.length<=Math.max(u,d)&&(e.splice(n[r-1],0,new t.Diff(o,s)),e[n[r-1]+1][0]=1,r--,a=--r>0?n[r-1]:-1,l=0,c=0,u=0,d=0,s=null,i=!0)),a++;for(i&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]==o&&1==e[a][0]){var g=e[a-1][1],h=e[a][1],p=this.diff_commonOverlap_(g,h),f=this.diff_commonOverlap_(h,g);p>=f?(p>=g.length/2||p>=h.length/2)&&(e.splice(a,0,new t.Diff(0,h.substring(0,p))),e[a-1][1]=g.substring(0,g.length-p),e[a+1][1]=h.substring(p),a++):(f>=g.length/2||f>=h.length/2)&&(e.splice(a,0,new t.Diff(0,g.substring(0,f))),e[a-1][0]=1,e[a-1][1]=h.substring(0,h.length-f),e[a+1][0]=o,e[a+1][1]=g.substring(f),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){function o(e,o){if(!e||!o)return 6;var i=e.charAt(e.length-1),n=o.charAt(0),r=i.match(t.nonAlphaNumericRegex_),s=n.match(t.nonAlphaNumericRegex_),a=r&&i.match(t.whitespaceRegex_),l=s&&n.match(t.whitespaceRegex_),c=a&&i.match(t.linebreakRegex_),u=l&&n.match(t.linebreakRegex_),d=c&&e.match(t.blanklineEndRegex_),g=u&&o.match(t.blanklineStartRegex_);return d||g?5:c||u?4:r&&!a&&l?3:a||l?2:r||s?1:0}for(var i=1;i<e.length-1;){if(0==e[i-1][0]&&0==e[i+1][0]){var n=e[i-1][1],r=e[i][1],s=e[i+1][1],a=this.diff_commonSuffix(n,r);if(a){var l=r.substring(r.length-a);n=n.substring(0,n.length-a),r=l+r.substring(0,r.length-a),s=l+s}for(var c=n,u=r,d=s,g=o(n,r)+o(r,s);r.charAt(0)===s.charAt(0);){n+=r.charAt(0),r=r.substring(1)+s.charAt(0),s=s.substring(1);var h=o(n,r)+o(r,s);h>=g&&(g=h,c=n,u=r,d=s)}e[i-1][1]!=c&&(c?e[i-1][1]=c:(e.splice(i-1,1),i--),e[i][1]=u,d?e[i+1][1]=d:(e.splice(i+1,1),i--))}i++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var i=!1,n=[],r=0,s=null,a=0,l=!1,c=!1,u=!1,d=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(u||d)?(n[r++]=a,l=u,c=d,s=e[a][1]):(r=0,s=null),u=d=!1):(e[a][0]==o?d=!0:u=!0,s&&(l&&c&&u&&d||s.length<this.Diff_EditCost/2&&l+c+u+d==3)&&(e.splice(n[r-1],0,new t.Diff(o,s)),e[n[r-1]+1][0]=1,r--,s=null,l&&c?(u=d=!0,r=0):(a=--r>0?n[r-1]:-1,u=d=!1),i=!0)),a++;i&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var i,n=0,r=0,s=0,a="",l="";n<e.length;)switch(e[n][0]){case 1:s++,l+=e[n][1],n++;break;case o:r++,a+=e[n][1],n++;break;case 0:r+s>1?(0!==r&&0!==s&&(0!==(i=this.diff_commonPrefix(l,a))&&(n-r-s>0&&0==e[n-r-s-1][0]?e[n-r-s-1][1]+=l.substring(0,i):(e.splice(0,0,new t.Diff(0,l.substring(0,i))),n++),l=l.substring(i),a=a.substring(i)),0!==(i=this.diff_commonSuffix(l,a))&&(e[n][1]=l.substring(l.length-i)+e[n][1],l=l.substring(0,l.length-i),a=a.substring(0,a.length-i))),n-=r+s,e.splice(n,r+s),a.length&&(e.splice(n,0,new t.Diff(o,a)),n++),l.length&&(e.splice(n,0,new t.Diff(1,l)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,s=0,r=0,a="",l=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),c=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),c=!0)),n++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var i,n=0,r=0,s=0,a=0;for(i=0;i<e.length&&(1!==e[i][0]&&(n+=e[i][1].length),e[i][0]!==o&&(r+=e[i][1].length),!(n>t));i++)s=n,a=r;return e.length!=i&&e[i][0]===o?a:a+(t-s)},t.prototype.diff_prettyHtml=function(e){for(var t=[],i=/&/g,n=/</g,r=/>/g,s=/\n/g,a=0;a<e.length;a++){var l=e[a][0],c=e[a][1].replace(i,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(s,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case o:t[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[a]="<span>"+c+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],o=0;o<e.length;o++)1!==e[o][0]&&(t[o]=e[o][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==o&&(t[i]=e[i][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,i=0,n=0,r=0;r<e.length;r++){var s=e[r][0],a=e[r][1];switch(s){case 1:i+=a.length;break;case o:n+=a.length;break;case 0:t+=Math.max(i,n),i=0,n=0}}return t+Math.max(i,n)},t.prototype.diff_toDelta=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i][0]){case 1:t[i]="+"+encodeURI(e[i][1]);break;case o:t[i]="-"+e[i][1].length;break;case 0:t[i]="="+e[i][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,i){for(var n=[],r=0,s=0,a=i.split(/\t/g),l=0;l<a.length;l++){var c=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{n[r++]=new t.Diff(1,decodeURI(c))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var u=parseInt(c,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(s,s+=u);"="==a[l].charAt(0)?n[r++]=new t.Diff(0,d):n[r++]=new t.Diff(o,d);break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(s!=e.length)throw new Error("Delta length ("+s+") does not equal source text length ("+e.length+").");return n},t.prototype.match_main=function(e,t,o){if(null==e||null==t||null==o)throw new Error("Null input. (match_main)");return o=Math.max(0,Math.min(o,e.length)),e==t?0:e.length?e.substring(o,o+t.length)==t?o:this.match_bitap_(e,t,o):-1},t.prototype.match_bitap_=function(e,t,o){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(t),n=this;function r(e,i){var r=e/t.length,s=Math.abs(o-i);return n.Match_Distance?r+s/n.Match_Distance:s?1:r}var s=this.Match_Threshold,a=e.indexOf(t,o);-1!=a&&(s=Math.min(r(0,a),s),-1!=(a=e.lastIndexOf(t,o+t.length))&&(s=Math.min(r(0,a),s)));var l,c,u=1<<t.length-1;a=-1;for(var d,g=t.length+e.length,h=0;h<t.length;h++){for(l=0,c=g;l<c;)r(h,o+c)<=s?l=c:g=c,c=Math.floor((g-l)/2+l);g=c;var p=Math.max(1,o-c+1),f=Math.min(o+c,e.length)+t.length,m=Array(f+2);m[f+1]=(1<<h)-1;for(var v=f;v>=p;v--){var y=i[e.charAt(v-1)];if(m[v]=0===h?(m[v+1]<<1|1)&y:(m[v+1]<<1|1)&y|(d[v+1]|d[v])<<1|1|d[v+1],m[v]&u){var b=r(h,v-1);if(b<=s){if(s=b,!((a=v-1)>o))break;p=Math.max(1,2*o-a)}}}if(r(h+1,o)>s)break;d=m}return a},t.prototype.match_alphabet_=function(e){for(var t={},o=0;o<e.length;o++)t[e.charAt(o)]=0;for(o=0;o<e.length;o++)t[e.charAt(o)]|=1<<e.length-o-1;return t},t.prototype.patch_addContext_=function(e,o){if(0!=o.length){if(null===e.start2)throw Error("patch not initialized");for(var i=o.substring(e.start2,e.start2+e.length1),n=0;o.indexOf(i)!=o.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=o.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var r=o.substring(e.start2-n,e.start2);r&&e.diffs.unshift(new t.Diff(0,r));var s=o.substring(e.start2+e.length1,e.start2+e.length1+n);s&&e.diffs.push(new t.Diff(0,s)),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+s.length,e.length2+=r.length+s.length}},t.prototype.patch_make=function(e,i,n){var r,s;if("string"==typeof e&&"string"==typeof i&&void 0===n)r=e,(s=this.diff_main(r,i,!0)).length>2&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(e&&"object"==typeof e&&void 0===i&&void 0===n)s=e,r=this.diff_text1(s);else if("string"==typeof e&&i&&"object"==typeof i&&void 0===n)r=e,s=i;else{if("string"!=typeof e||"string"!=typeof i||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,s=n}if(0===s.length)return[];for(var a=[],l=new t.patch_obj,c=0,u=0,d=0,g=r,h=r,p=0;p<s.length;p++){var f=s[p][0],m=s[p][1];switch(c||0===f||(l.start1=u,l.start2=d),f){case 1:l.diffs[c++]=s[p],l.length2+=m.length,h=h.substring(0,d)+m+h.substring(d);break;case o:l.length1+=m.length,l.diffs[c++]=s[p],h=h.substring(0,d)+h.substring(d+m.length);break;case 0:m.length<=2*this.Patch_Margin&&c&&s.length!=p+1?(l.diffs[c++]=s[p],l.length1+=m.length,l.length2+=m.length):m.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(l,g),a.push(l),l=new t.patch_obj,c=0,g=h,u=d)}1!==f&&(u+=m.length),f!==o&&(d+=m.length)}return c&&(this.patch_addContext_(l,g),a.push(l)),a},t.prototype.patch_deepCopy=function(e){for(var o=[],i=0;i<e.length;i++){var n=e[i],r=new t.patch_obj;r.diffs=[];for(var s=0;s<n.diffs.length;s++)r.diffs[s]=new t.Diff(n.diffs[s][0],n.diffs[s][1]);r.start1=n.start1,r.start2=n.start2,r.length1=n.length1,r.length2=n.length2,o[i]=r}return o},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var i=this.patch_addPadding(e);t=i+t+i,this.patch_splitMax(e);for(var n=0,r=[],s=0;s<e.length;s++){var a,l,c=e[s].start2+n,u=this.diff_text1(e[s].diffs),d=-1;if(u.length>this.Match_MaxBits?-1!=(a=this.match_main(t,u.substring(0,this.Match_MaxBits),c))&&(-1==(d=this.match_main(t,u.substring(u.length-this.Match_MaxBits),c+u.length-this.Match_MaxBits))||a>=d)&&(a=-1):a=this.match_main(t,u,c),-1==a)r[s]=!1,n-=e[s].length2-e[s].length1;else if(r[s]=!0,n=a-c,u==(l=-1==d?t.substring(a,a+u.length):t.substring(a,d+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[s].diffs)+t.substring(a+u.length);else{var g=this.diff_main(u,l,!1);if(u.length>this.Match_MaxBits&&this.diff_levenshtein(g)/u.length>this.Patch_DeleteThreshold)r[s]=!1;else{this.diff_cleanupSemanticLossless(g);for(var h,p=0,f=0;f<e[s].diffs.length;f++){var m=e[s].diffs[f];0!==m[0]&&(h=this.diff_xIndex(g,p)),1===m[0]?t=t.substring(0,a+h)+m[1]+t.substring(a+h):m[0]===o&&(t=t.substring(0,a+h)+t.substring(a+this.diff_xIndex(g,p+m[1].length))),m[0]!==o&&(p+=m[1].length)}}}}return[t=t.substring(i.length,t.length-i.length),r]},t.prototype.patch_addPadding=function(e){for(var o=this.Patch_Margin,i="",n=1;n<=o;n++)i+=String.fromCharCode(n);for(n=0;n<e.length;n++)e[n].start1+=o,e[n].start2+=o;var r=e[0],s=r.diffs;if(0==s.length||0!=s[0][0])s.unshift(new t.Diff(0,i)),r.start1-=o,r.start2-=o,r.length1+=o,r.length2+=o;else if(o>s[0][1].length){var a=o-s[0][1].length;s[0][1]=i.substring(s[0][1].length)+s[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}return 0==(s=(r=e[e.length-1]).diffs).length||0!=s[s.length-1][0]?(s.push(new t.Diff(0,i)),r.length1+=o,r.length2+=o):o>s[s.length-1][1].length&&(a=o-s[s.length-1][1].length,s[s.length-1][1]+=i.substring(0,a),r.length1+=a,r.length2+=a),i},t.prototype.patch_splitMax=function(e){for(var i=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=i)){var r=e[n];e.splice(n--,1);for(var s=r.start1,a=r.start2,l="";0!==r.diffs.length;){var c=new t.patch_obj,u=!0;for(c.start1=s-l.length,c.start2=a-l.length,""!==l&&(c.length1=c.length2=l.length,c.diffs.push(new t.Diff(0,l)));0!==r.diffs.length&&c.length1<i-this.Patch_Margin;){var d=r.diffs[0][0],g=r.diffs[0][1];1===d?(c.length2+=g.length,a+=g.length,c.diffs.push(r.diffs.shift()),u=!1):d===o&&1==c.diffs.length&&0==c.diffs[0][0]&&g.length>2*i?(c.length1+=g.length,s+=g.length,u=!1,c.diffs.push(new t.Diff(d,g)),r.diffs.shift()):(g=g.substring(0,i-c.length1-this.Patch_Margin),c.length1+=g.length,s+=g.length,0===d?(c.length2+=g.length,a+=g.length):u=!1,c.diffs.push(new t.Diff(d,g)),g==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(g.length))}l=(l=this.diff_text2(c.diffs)).substring(l.length-this.Patch_Margin);var h=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==h&&(c.length1+=h.length,c.length2+=h.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=h:c.diffs.push(new t.Diff(0,h))),u||e.splice(++n,0,c)}}},t.prototype.patch_toText=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=e[o];return t.join("")},t.prototype.patch_fromText=function(e){var i=[];if(!e)return i;for(var n=e.split("\n"),r=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var a=n[r].match(s);if(!a)throw new Error("Invalid patch string: "+n[r]);var l=new t.patch_obj;for(i.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),r++;r<n.length;){var c=n[r].charAt(0);try{var u=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+u)}if("-"==c)l.diffs.push(new t.Diff(o,u));else if("+"==c)l.diffs.push(new t.Diff(1,u));else if(" "==c)l.diffs.push(new t.Diff(0,u));else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+u)}r++}}return i},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:e="+";break;case o:e="-";break;case 0:e=" "}t[i+1]=e+encodeURI(this.diffs[i][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=o,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},85430:e=>{"use strict";var t=Object.prototype.hasOwnProperty,o="~";function i(){}function n(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function r(e,t,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,r||e,s),l=o?o+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),a.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(o?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=o?o+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,r=i.length,s=new Array(r);n<r;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(e){var t=o?o+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,n,r,s){var a=o?o+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,r),!0;case 6:return u.fn.call(u.context,t,i,n,r,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var g,h=u.length;for(c=0;c<h;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,n);break;default:if(!l)for(g=1,l=new Array(d-1);g<d;g++)l[g-1]=arguments[g];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,o){return r(this,e,t,o,!1)},a.prototype.once=function(e,t,o){return r(this,e,t,o,!0)},a.prototype.removeListener=function(e,t,i,n){var r=o?o+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||n&&!a.once||i&&a.context!==i||s(this,r);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[r]=1===c.length?c[0]:c:s(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=o,a.EventEmitter=a,e.exports=a},26394:e=>{"use strict";e.exports=function e(t,o){if(t===o)return!0;if(t&&o&&"object"==typeof t&&"object"==typeof o){if(t.constructor!==o.constructor)return!1;var i,n,r;if(Array.isArray(t)){if((i=t.length)!=o.length)return!1;for(n=i;0!=n--;)if(!e(t[n],o[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(o).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(o,r[n]))return!1;for(n=i;0!=n--;){var s=r[n];if(!e(t[s],o[s]))return!1}return!0}return t!=t&&o!=o}},91803:(e,t,o)=>{var i=null;"undefined"!=typeof WebSocket?i=WebSocket:"undefined"!=typeof MozWebSocket?i=MozWebSocket:void 0!==o.g?i=o.g.WebSocket||o.g.MozWebSocket:"undefined"!=typeof window?i=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(i=self.WebSocket||self.MozWebSocket),e.exports=i},7051:(e,t,o)=>{"use strict";o.d(t,{Pe:()=>c.P,PA:()=>v});var i=o(46546),n=o(95734);if(!n.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!i.makeObservable)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var r=o(38883);var s=o(30540),a=function(){function e(e){var t=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=1e4),clearTimeout(t.sweepTimeout),t.sweepTimeout=void 0;var o=Date.now();t.registrations.forEach((function(i,n){o-i.registeredAt>=e&&(t.finalize(i.value),t.registrations.delete(n))})),t.registrations.size>0&&t.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){t.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,o){this.registrations.set(o,{value:t,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){void 0===this.sweepTimeout&&(this.sweepTimeout=setTimeout(this.sweep,1e4))}}),e}(),l=new("undefined"!=typeof FinalizationRegistry?FinalizationRegistry:a)((function(e){var t;null===(t=e.reaction)||void 0===t||t.dispose(),e.reaction=null})),c=o(9983),u=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var i,n,r=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return s};function d(e){return"observer".concat(e)}var g=function(){};function h(){return new g}var p="function"==typeof Symbol&&Symbol.for,f=p?Symbol.for("react.forward_ref"):"function"==typeof n.forwardRef&&(0,n.forwardRef)((function(e){return null})).$$typeof,m=p?Symbol.for("react.memo"):"function"==typeof n.memo&&(0,n.memo)((function(e){return null})).$$typeof;function v(e,t){var o;if(m&&e.$$typeof===m)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");if((0,c.P)())return e;var r=null!==(o=null==t?void 0:t.forwardRef)&&void 0!==o&&o,a=e,g=e.displayName||e.name;if(f&&e.$$typeof===f&&(r=!0,"function"!=typeof(a=e.render)))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var p,v,y=function(e,t){return function(e,t){if(void 0===t&&(t="observed"),(0,c.P)())return e();var o=u(n.useState(h),1)[0],r=u(n.useState(),2)[1],a=function(){return r([])},g=n.useRef(null);g.current||(g.current={reaction:null,mounted:!1,changedBeforeMount:!1});var p,f,m=g.current;if(m.reaction||(m.reaction=new i.Reaction(d(t),(function(){m.mounted?a():m.changedBeforeMount=!0})),l.register(o,m,m)),n.useDebugValue(m.reaction,s.E),n.useEffect((function(){return l.unregister(m),m.mounted=!0,m.reaction?m.changedBeforeMount&&(m.changedBeforeMount=!1,a()):(m.reaction=new i.Reaction(d(t),(function(){a()})),a()),function(){m.reaction.dispose(),m.reaction=null,m.mounted=!1,m.changedBeforeMount=!1}}),[]),m.reaction.track((function(){try{p=e()}catch(e){f=e}})),f)throw f;return p}((function(){return a(e,t)}),g)};return""!==g&&(y.displayName=g),e.contextTypes&&(y.contextTypes=e.contextTypes),r&&(y=(0,n.forwardRef)(y)),y=(0,n.memo)(y),p=e,v=y,Object.keys(p).forEach((function(e){b[e]||Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(p,e))})),y}var y,b={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};(y=r.unstable_batchedUpdates)||(y=function(e){e()}),(0,i.configure)({reactionScheduler:y}),l.finalizeAllImmediately},9983:(e,t,o)=>{"use strict";o.d(t,{P:()=>n});var i=!1;function n(){return i}},30540:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>n}),3023==o.j)var i=o(46546);function n(e){return(0,i.getDependencyTree)(e)}},4984:(e,t,o)=>{"use strict";o.d(t,{PA:()=>E});var i=o(46546),n=o(95734),r=o(7051),s=0,a={};function l(e){return a[e]||(a[e]=function(e){if("function"==typeof Symbol)return Symbol(e);var t="__$mobx-react "+e+" ("+s+")";return s++,t}(e)),a[e]}function c(e,t){if(u(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(var n=0;n<o.length;n++)if(!Object.hasOwnProperty.call(t,o[n])||!u(e[o[n]],t[o[n]]))return!1;return!0}function u(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function d(e,t,o){Object.hasOwnProperty.call(e,t)?e[t]=o:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:o})}var g=3023==o.j?l("patchMixins"):null,h=3023==o.j?l("patchedDefinition"):null;function p(e,t){for(var o=this,i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];t.locks++;try{var s;return null!=e&&(s=e.apply(this,n)),s}finally{t.locks--,0===t.locks&&t.methods.forEach((function(e){e.apply(o,n)}))}}function f(e,t){return function(){for(var o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];p.call.apply(p,[this,e,t].concat(i))}}function m(e,t,o){var i=function(e,t){var o=e[g]=e[g]||{},i=o[t]=o[t]||{};return i.locks=i.locks||0,i.methods=i.methods||[],i}(e,t);i.methods.indexOf(o)<0&&i.methods.push(o);var n=Object.getOwnPropertyDescriptor(e,t);if(!n||!n[h]){var r=e[t],s=v(e,t,n?n.enumerable:void 0,i,r);Object.defineProperty(e,t,s)}}function v(e,t,o,i,n){var r,s=f(n,i);return(r={})[h]=!0,r.get=function(){return s},r.set=function(n){if(this===e)s=f(n,i);else{var r=v(this,t,o,i,n);Object.defineProperty(this,t,r)}},r.configurable=!0,r.enumerable=o,r}var y=3023==o.j?i.$mobx||"$mobx":null,b=3023==o.j?l("isMobXReactObserver"):null,S=3023==o.j?l("isUnmounted"):null,C=3023==o.j?l("skipRender"):null,w=3023==o.j?l("isForcingUpdate"):null;function k(e){var t=e.prototype;if(e[b]){var o=T(t);console.warn("The provided component class ("+o+")\n                has already been declared as an observer component.")}else e[b]=!0;if(t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==n.PureComponent)if(t.shouldComponentUpdate){if(t.shouldComponentUpdate!==_)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}else t.shouldComponentUpdate=_;I(t,"props"),I(t,"state"),e.contextType&&I(t,"context");var i=t.render;if("function"!=typeof i){var s=T(t);throw new Error("[mobx-react] class component ("+s+") is missing `render` method.\n`observer` requires `render` being a function defined on prototype.\n`render = () => {}` or `render = function() {}` is not supported.")}return t.render=function(){return this.render=(0,r.Pe)()?i:x.call(this,i),this.render()},m(t,"componentDidMount",(function(){this[S]=!1,this.render[y]||n.Component.prototype.forceUpdate.call(this)})),m(t,"componentWillUnmount",(function(){if(!(0,r.Pe)()){var e=this.render[y];if(e)e.dispose(),this.render[y]=null;else{var t=T(this);console.warn("The reactive render of an observer class component ("+t+")\n                was overridden after MobX attached. This may result in a memory leak if the\n                overridden reactive render was not properly disposed.")}this[S]=!0}})),e}function T(e){return e.displayName||e.name||e.constructor&&(e.constructor.displayName||e.constructor.name)||"<component>"}function x(e){var t=this;d(this,C,!1),d(this,w,!1);var o=T(this),r=e.bind(this),s=!1;return function e(){var a;s=!1;var l=null!=(a=e[y])?a:e[y]=function(){var e=new i.Reaction(o+".render()",(function(){if(!s&&(s=!0,!0!==t[S])){var o=!0;try{d(t,w,!0),t[C]||n.Component.prototype.forceUpdate.call(t),o=!1}finally{d(t,w,!1),o&&(e.dispose(),t.render[y]=null)}}}));return e.reactComponent=t,e}(),c=void 0,u=void 0;if(l.track((function(){try{u=(0,i._allowStateChanges)(!1,r)}catch(e){c=e}})),c)throw c;return u}}function _(e,t){return(0,r.Pe)()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t||!c(this.props,e)}function I(e,t){var o=l("reactProp_"+t+"_valueHolder"),n=l("reactProp_"+t+"_atomHolder");function r(){return this[n]||d(this,n,(0,i.createAtom)("reactive "+t)),this[n]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){var e=!1;return i._allowStateReadsStart&&i._allowStateReadsEnd&&(e=(0,i._allowStateReadsStart)(!0)),r.call(this).reportObserved(),i._allowStateReadsStart&&i._allowStateReadsEnd&&(0,i._allowStateReadsEnd)(e),this[o]},set:function(e){this[w]||c(this[o],e)?d(this,o,e):(d(this,o,e),d(this,C,!0),r.call(this).reportChanged(),d(this,C,!1))}})}function E(e){return!0===e.isMobxInjector&&console.warn("Mobx observer: You are trying to use `observer` on a component that already has `inject`. Please apply `observer` before applying `inject`"),Object.prototype.isPrototypeOf.call(n.Component,e)||Object.prototype.isPrototypeOf.call(n.PureComponent,e)?k(e):(0,r.PA)(e)}if(!n.Component)throw new Error("mobx-react requires React to be available");if(!i.observable)throw new Error("mobx-react requires mobx to be available")},67278:e=>{"use strict";e.exports={r:"2.35.1335"}}}]);
//# sourceMappingURL=shared.js.map