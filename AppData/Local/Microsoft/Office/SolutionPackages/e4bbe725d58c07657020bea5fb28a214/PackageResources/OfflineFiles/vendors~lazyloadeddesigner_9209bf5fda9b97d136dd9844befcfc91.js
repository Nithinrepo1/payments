"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[9412],{25667:(e,t,n)=>{n.d(t,{E:()=>Yn});var i={};n.r(i),n.d(i,{hasBrowserEnv:()=>ye,hasStandardBrowserEnv:()=>ve,hasStandardBrowserWebWorkerEnv:()=>Te,navigator:()=>Ee,origin:()=>Se});var r=n(79490),s=n(78461);function o(e,t){return function(){return e.apply(t,arguments)}}var a=n(72715);const{toString:l}=Object.prototype,{getPrototypeOf:c}=Object,u=(d=Object.create(null),e=>{const t=l.call(e);return d[t]||(d[t]=t.slice(8,-1).toLowerCase())});var d;const h=e=>(e=e.toLowerCase(),t=>u(t)===e),p=e=>t=>typeof t===e,{isArray:g}=Array,f=p("undefined");const m=h("ArrayBuffer");const y=p("string"),E=p("function"),v=p("number"),T=e=>null!==e&&"object"==typeof e,S=e=>{if("object"!==u(e))return!1;const t=c(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},C=h("Date"),R=h("File"),b=h("Blob"),w=h("FileList"),O=h("URLSearchParams"),[I,_,A,D]=["ReadableStream","Request","Response","Headers"].map(h);function U(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let i,r;if("object"!=typeof e&&(e=[e]),g(e))for(i=0,r=e.length;i<r;i++)t.call(null,e[i],i,e);else{const r=n?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let o;for(i=0;i<s;i++)o=r[i],t.call(null,e[o],o,e)}}function P(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,M=e=>!f(e)&&e!==N;const x=(L="undefined"!=typeof Uint8Array&&c(Uint8Array),e=>L&&e instanceof L);var L;const B=h("HTMLFormElement"),F=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),k=h("RegExp"),H=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};U(n,((n,r)=>{let s;!1!==(s=t(n,r,e))&&(i[r]=s||n)})),Object.defineProperties(e,i)},j="abcdefghijklmnopqrstuvwxyz",q="0123456789",z={DIGIT:q,ALPHA:j,ALPHA_DIGIT:j+j.toUpperCase()+q};const G=h("AsyncFunction"),W=($="function"==typeof setImmediate,J=E(N.postMessage),$?setImmediate:J?(V=`axios@${Math.random()}`,Q=[],N.addEventListener("message",(({source:e,data:t})=>{e===N&&t===V&&Q.length&&Q.shift()()}),!1),e=>{Q.push(e),N.postMessage(V,"*")}):e=>setTimeout(e));var $,J,V,Q;const K="undefined"!=typeof queueMicrotask?queueMicrotask.bind(N):void 0!==a&&a.nextTick||W,Y={isArray:g,isArrayBuffer:m,isBuffer:function(e){return null!==e&&!f(e)&&null!==e.constructor&&!f(e.constructor)&&E(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||E(e.append)&&("formdata"===(t=u(e))||"object"===t&&E(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&m(e.buffer),t},isString:y,isNumber:v,isBoolean:e=>!0===e||!1===e,isObject:T,isPlainObject:S,isReadableStream:I,isRequest:_,isResponse:A,isHeaders:D,isUndefined:f,isDate:C,isFile:R,isBlob:b,isRegExp:k,isFunction:E,isStream:e=>T(e)&&E(e.pipe),isURLSearchParams:O,isTypedArray:x,isFileList:w,forEach:U,merge:function e(){const{caseless:t}=M(this)&&this||{},n={},i=(i,r)=>{const s=t&&P(n,r)||r;S(n[s])&&S(i)?n[s]=e(n[s],i):S(i)?n[s]=e({},i):g(i)?n[s]=i.slice():n[s]=i};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&U(arguments[e],i);return n},extend:(e,t,n,{allOwnKeys:i}={})=>(U(t,((t,i)=>{n&&E(t)?e[i]=o(t,n):e[i]=t}),{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,s,o;const a={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),s=r.length;s-- >0;)o=r[s],i&&!i(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&c(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:u,kindOfTest:h,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(g(e))return e;let t=e.length;if(!v(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:B,hasOwnProperty:F,hasOwnProp:F,reduceDescriptors:H,freezeMethods:e=>{H(e,((t,n)=>{if(E(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];E(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach((e=>{n[e]=!0}))};return g(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:P,global:N,isContextDefined:M,ALPHABET:z,generateString:(e=16,t=z.ALPHA_DIGIT)=>{let n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n},isSpecCompliantForm:function(e){return!!(e&&E(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(T(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const r=g(e)?[]:{};return U(e,((e,t)=>{const s=n(e,i+1);!f(s)&&(r[t]=s)})),t[i]=void 0,r}}return e};return n(e,0)},isAsyncFn:G,isThenable:e=>e&&(T(e)||E(e))&&E(e.then)&&E(e.catch),setImmediate:W,asap:K};function X(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Y.inherits(X,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Y.toJSONObject(this.config),code:this.code,status:this.status}}});const Z=X.prototype,ee={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{ee[e]={value:e}})),Object.defineProperties(X,ee),Object.defineProperty(Z,"isAxiosError",{value:!0}),X.from=(e,t,n,i,r,s)=>{const o=Object.create(Z);return Y.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),X.call(o,e.message,t,n,i,r),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const te=X;var ne=n(37542).Buffer;function ie(e){return Y.isPlainObject(e)||Y.isArray(e)}function re(e){return Y.endsWith(e,"[]")?e.slice(0,-2):e}function se(e,t,n){return e?e.concat(t).map((function(e,t){return e=re(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const oe=Y.toFlatObject(Y,{},null,(function(e){return/^is[A-Z]/.test(e)}));const ae=function(e,t,n){if(!Y.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=Y.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!Y.isUndefined(t[e])}))).metaTokens,r=n.visitor||c,s=n.dots,o=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&Y.isSpecCompliantForm(t);if(!Y.isFunction(r))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(Y.isDate(e))return e.toISOString();if(!a&&Y.isBlob(e))throw new te("Blob is not supported. Use a Buffer instead.");return Y.isArrayBuffer(e)||Y.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):ne.from(e):e}function c(e,n,r){let a=e;if(e&&!r&&"object"==typeof e)if(Y.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(Y.isArray(e)&&function(e){return Y.isArray(e)&&!e.some(ie)}(e)||(Y.isFileList(e)||Y.endsWith(n,"[]"))&&(a=Y.toArray(e)))return n=re(n),a.forEach((function(e,i){!Y.isUndefined(e)&&null!==e&&t.append(!0===o?se([n],i,s):null===o?n:n+"[]",l(e))})),!1;return!!ie(e)||(t.append(se(r,n,s),l(e)),!1)}const u=[],d=Object.assign(oe,{defaultVisitor:c,convertValue:l,isVisitable:ie});if(!Y.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!Y.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),Y.forEach(n,(function(n,s){!0===(!(Y.isUndefined(n)||null===n)&&r.call(t,n,Y.isString(s)?s.trim():s,i,d))&&e(n,i?i.concat(s):[s])})),u.pop()}}(e),t};function le(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function ce(e,t){this._pairs=[],e&&ae(e,this,t)}const ue=ce.prototype;ue.append=function(e,t){this._pairs.push([e,t])},ue.toString=function(e){const t=e?function(t){return e.call(this,t,le)}:le;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const de=ce;function he(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function pe(e,t,n){if(!t)return e;const i=n&&n.encode||he,r=n&&n.serialize;let s;if(s=r?r(t,n):Y.isURLSearchParams(t)?t.toString():new de(t,n).toString(i),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const ge=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Y.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},fe={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},me={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:de,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},ye="undefined"!=typeof window&&"undefined"!=typeof document,Ee="object"==typeof navigator&&navigator||void 0,ve=ye&&(!Ee||["ReactNative","NativeScript","NS"].indexOf(Ee.product)<0),Te="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Se=ye&&window.location.href||"http://localhost",Ce={...i,...me};const Re=function(e){function t(e,n,i,r){let s=e[r++];if("__proto__"===s)return!0;const o=Number.isFinite(+s),a=r>=e.length;if(s=!s&&Y.isArray(i)?i.length:s,a)return Y.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!o;i[s]&&Y.isObject(i[s])||(i[s]=[]);return t(e,n,i[s],r)&&Y.isArray(i[s])&&(i[s]=function(e){const t={},n=Object.keys(e);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],t[s]=e[s];return t}(i[s])),!o}if(Y.isFormData(e)&&Y.isFunction(e.entries)){const n={};return Y.forEachEntry(e,((e,i)=>{t(function(e){return Y.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),i,n,0)})),n}return null};const be={transitional:fe,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=Y.isObject(e);r&&Y.isHTMLForm(e)&&(e=new FormData(e));if(Y.isFormData(e))return i?JSON.stringify(Re(e)):e;if(Y.isArrayBuffer(e)||Y.isBuffer(e)||Y.isStream(e)||Y.isFile(e)||Y.isBlob(e)||Y.isReadableStream(e))return e;if(Y.isArrayBufferView(e))return e.buffer;if(Y.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ae(e,new Ce.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return Ce.isNode&&Y.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=Y.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ae(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),function(e,t,n){if(Y.isString(e))try{return(t||JSON.parse)(e),Y.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||be.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(Y.isResponse(e)||Y.isReadableStream(e))return e;if(e&&Y.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw te.from(e,te.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ce.classes.FormData,Blob:Ce.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Y.forEach(["delete","get","head","post","put","patch"],(e=>{be.headers[e]={}}));const we=be,Oe=Y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ie=Symbol("internals");function _e(e){return e&&String(e).trim().toLowerCase()}function Ae(e){return!1===e||null==e?e:Y.isArray(e)?e.map(Ae):String(e)}function De(e,t,n,i,r){return Y.isFunction(i)?i.call(this,t,n):(r&&(t=n),Y.isString(t)?Y.isString(i)?-1!==t.indexOf(i):Y.isRegExp(i)?i.test(t):void 0:void 0)}class Ue{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=_e(t);if(!r)throw new Error("header name must be a non-empty string");const s=Y.findKey(i,r);(!s||void 0===i[s]||!0===n||void 0===n&&!1!==i[s])&&(i[s||t]=Ae(e))}const s=(e,t)=>Y.forEach(e,((e,n)=>r(e,n,t)));if(Y.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(Y.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,i,r;return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&Oe[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)})),t})(e),t);else if(Y.isHeaders(e))for(const[t,i]of e.entries())r(i,t,n);else null!=e&&r(t,e,n);return this}get(e,t){if(e=_e(e)){const n=Y.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(Y.isFunction(t))return t.call(this,e,n);if(Y.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=_e(e)){const n=Y.findKey(this,e);return!(!n||void 0===this[n]||t&&!De(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=_e(e)){const r=Y.findKey(n,e);!r||t&&!De(0,n[r],r,t)||(delete n[r],i=!0)}}return Y.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];e&&!De(0,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return Y.forEach(this,((i,r)=>{const s=Y.findKey(n,r);if(s)return t[s]=Ae(i),void delete t[r];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(r):String(r).trim();o!==r&&delete t[r],t[o]=Ae(i),n[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Y.forEach(this,((n,i)=>{null!=n&&!1!==n&&(t[i]=e&&Y.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[Ie]=this[Ie]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=_e(e);t[i]||(!function(e,t){const n=Y.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})}))}(n,e),t[i]=!0)}return Y.isArray(e)?e.forEach(i):i(e),this}}Ue.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Y.reduceDescriptors(Ue.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),Y.freezeMethods(Ue);const Pe=Ue;function Ne(e,t){const n=this||we,i=t||n,r=Pe.from(i.headers);let s=i.data;return Y.forEach(e,(function(e){s=e.call(n,s,r.normalize(),t?t.status:void 0)})),r.normalize(),s}function Me(e){return!(!e||!e.__CANCEL__)}function xe(e,t,n){te.call(this,null==e?"canceled":e,te.ERR_CANCELED,t,n),this.name="CanceledError"}Y.inherits(xe,te,{__CANCEL__:!0});const Le=xe;function Be(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new te("Request failed with status code "+n.status,[te.ERR_BAD_REQUEST,te.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Fe=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,s=0,o=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),c=i[o];r||(r=l),n[s]=a,i[s]=l;let u=o,d=0;for(;u!==s;)d+=n[u++],u%=e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),l-r<t)return;const h=c&&l-c;return h?Math.round(1e3*d/h):void 0}};const ke=function(e,t){let n,i,r=0,s=1e3/t;const o=(t,s=Date.now())=>{r=s,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),a=t-r;a>=s?o(e,t):(n=e,i||(i=setTimeout((()=>{i=null,o(n)}),s-a)))},()=>n&&o(n)]},He=(e,t,n=3)=>{let i=0;const r=Fe(50,250);return ke((n=>{const s=n.loaded,o=n.lengthComputable?n.total:void 0,a=s-i,l=r(a);i=s;e({loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&s<=o?(o-s)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})}),n)},je=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},qe=e=>(...t)=>Y.asap((()=>e(...t))),ze=Ce.hasStandardBrowserEnv?function(){const e=Ce.navigator&&/(msie|trident)/i.test(Ce.navigator.userAgent),t=document.createElement("a");let n;function i(n){let i=n;return e&&(t.setAttribute("href",i),i=t.href),t.setAttribute("href",i),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(e){const t=Y.isString(e)?i(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0},Ge=Ce.hasStandardBrowserEnv?{write(e,t,n,i,r,s){const o=[e+"="+encodeURIComponent(t)];Y.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),Y.isString(i)&&o.push("path="+i),Y.isString(r)&&o.push("domain="+r),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function We(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const $e=e=>e instanceof Pe?{...e}:e;function Je(e,t){t=t||{};const n={};function i(e,t,n){return Y.isPlainObject(e)&&Y.isPlainObject(t)?Y.merge.call({caseless:n},e,t):Y.isPlainObject(t)?Y.merge({},t):Y.isArray(t)?t.slice():t}function r(e,t,n){return Y.isUndefined(t)?Y.isUndefined(e)?void 0:i(void 0,e,n):i(e,t,n)}function s(e,t){if(!Y.isUndefined(t))return i(void 0,t)}function o(e,t){return Y.isUndefined(t)?Y.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function a(n,r,s){return s in t?i(n,r):s in e?i(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t)=>r($e(e),$e(t),!0)};return Y.forEach(Object.keys(Object.assign({},e,t)),(function(i){const s=l[i]||r,o=s(e[i],t[i],i);Y.isUndefined(o)&&s!==a||(n[i]=o)})),n}const Ve=e=>{const t=Je({},e);let n,{data:i,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:l}=t;if(t.headers=a=Pe.from(a),t.url=pe(We(t.baseURL,t.url),e.params,e.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Y.isFormData(i))if(Ce.hasStandardBrowserEnv||Ce.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];a.setContentType([e||"multipart/form-data",...t].join("; "))}if(Ce.hasStandardBrowserEnv&&(r&&Y.isFunction(r)&&(r=r(t)),r||!1!==r&&ze(t.url))){const e=s&&o&&Ge.read(o);e&&a.set(s,e)}return t},Qe="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const i=Ve(e);let r=i.data;const s=Pe.from(i.headers).normalize();let o,a,l,c,u,{responseType:d,onUploadProgress:h,onDownloadProgress:p}=i;function g(){c&&c(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let f=new XMLHttpRequest;function m(){if(!f)return;const i=Pe.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());Be((function(e){t(e),g()}),(function(e){n(e),g()}),{data:d&&"text"!==d&&"json"!==d?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:i,config:e,request:f}),f=null}f.open(i.method.toUpperCase(),i.url,!0),f.timeout=i.timeout,"onloadend"in f?f.onloadend=m:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(m)},f.onabort=function(){f&&(n(new te("Request aborted",te.ECONNABORTED,e,f)),f=null)},f.onerror=function(){n(new te("Network Error",te.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||fe;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new te(t,r.clarifyTimeoutError?te.ETIMEDOUT:te.ECONNABORTED,e,f)),f=null},void 0===r&&s.setContentType(null),"setRequestHeader"in f&&Y.forEach(s.toJSON(),(function(e,t){f.setRequestHeader(t,e)})),Y.isUndefined(i.withCredentials)||(f.withCredentials=!!i.withCredentials),d&&"json"!==d&&(f.responseType=i.responseType),p&&([l,u]=He(p,!0),f.addEventListener("progress",l)),h&&f.upload&&([a,c]=He(h),f.upload.addEventListener("progress",a),f.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(o=t=>{f&&(n(!t||t.type?new Le(null,e,f):t),f.abort(),f=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);y&&-1===Ce.protocols.indexOf(y)?n(new te("Unsupported protocol "+y+":",te.ERR_BAD_REQUEST,e)):f.send(r||null)}))},Ke=(e,t)=>{let n,i=new AbortController;const r=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;i.abort(t instanceof te?t:new Le(t instanceof Error?t.message:t))}};let s=t&&setTimeout((()=>{r(new te(`timeout ${t} of ms exceeded`,te.ETIMEDOUT))}),t);const o=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach((e=>{e&&(e.removeEventListener?e.removeEventListener("abort",r):e.unsubscribe(r))})),e=null)};e.forEach((e=>e&&e.addEventListener&&e.addEventListener("abort",r)));const{signal:a}=i;return a.unsubscribe=o,[a,()=>{s&&clearTimeout(s),s=null}]},Ye=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},Xe=(e,t,n,i,r)=>{const s=async function*(e,t,n){for await(const i of e)yield*Ye(ArrayBuffer.isView(i)?i:await n(String(i)),t)}(e,t,r);let o,a=0,l=e=>{o||(o=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await s.next();if(t)return l(),void e.close();let r=i.byteLength;if(n){let e=a+=r;n(e)}e.enqueue(new Uint8Array(i))}catch(e){throw l(e),e}},cancel:e=>(l(e),s.return())},{highWaterMark:2})},Ze="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,et=Ze&&"function"==typeof ReadableStream,tt=Ze&&("function"==typeof TextEncoder?(nt=new TextEncoder,e=>nt.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var nt;const it=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},rt=et&&it((()=>{let e=!1;const t=new Request(Ce.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),st=et&&it((()=>Y.isReadableStream(new Response("").body))),ot={stream:st&&(e=>e.body)};var at;Ze&&(at=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!ot[e]&&(ot[e]=Y.isFunction(at[e])?t=>t[e]():(t,n)=>{throw new te(`Response type '${e}' is not supported`,te.ERR_NOT_SUPPORT,n)})})));const lt=async(e,t)=>{const n=Y.toFiniteNumber(e.getContentLength());return null==n?(async e=>null==e?0:Y.isBlob(e)?e.size:Y.isSpecCompliantForm(e)?(await new Request(e).arrayBuffer()).byteLength:Y.isArrayBufferView(e)||Y.isArrayBuffer(e)?e.byteLength:(Y.isURLSearchParams(e)&&(e+=""),Y.isString(e)?(await tt(e)).byteLength:void 0))(t):n},ct=Ze&&(async e=>{let{url:t,method:n,data:i,signal:r,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=Ve(e);c=c?(c+"").toLowerCase():"text";let p,g,[f,m]=r||s||o?Ke([r,s],o):[];const y=()=>{!p&&setTimeout((()=>{f&&f.unsubscribe()})),p=!0};let E;try{if(l&&rt&&"get"!==n&&"head"!==n&&0!==(E=await lt(u,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(Y.isFormData(i)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=je(E,He(qe(l)));i=Xe(n.body,65536,e,t,tt)}}Y.isString(d)||(d=d?"include":"omit");const r="credentials"in Request.prototype;g=new Request(t,{...h,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",credentials:r?d:void 0});let s=await fetch(g);const o=st&&("stream"===c||"response"===c);if(st&&(a||o)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=s[t]}));const t=Y.toFiniteNumber(s.headers.get("content-length")),[n,i]=a&&je(t,He(qe(a),!0))||[];s=new Response(Xe(s.body,65536,n,(()=>{i&&i(),o&&y()}),tt),e)}c=c||"text";let p=await ot[Y.findKey(ot,c)||"text"](s,e);return!o&&y(),m&&m(),await new Promise(((t,n)=>{Be(t,n,{data:p,headers:Pe.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:g})}))}catch(t){if(y(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new te("Network Error",te.ERR_NETWORK,e,g),{cause:t.cause||t});throw te.from(t,t&&t.code,e,g)}}),ut={http:null,xhr:Qe,fetch:ct};Y.forEach(ut,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const dt=e=>`- ${e}`,ht=e=>Y.isFunction(e)||null===e||!1===e,pt=e=>{e=Y.isArray(e)?e:[e];const{length:t}=e;let n,i;const r={};for(let s=0;s<t;s++){let t;if(n=e[s],i=n,!ht(n)&&(i=ut[(t=String(n)).toLowerCase()],void 0===i))throw new te(`Unknown adapter '${t}'`);if(i)break;r[t||"#"+s]=i}if(!i){const e=Object.entries(r).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(dt).join("\n"):" "+dt(e[0]):"as no adapter specified";throw new te("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function gt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Le(null,e)}function ft(e){gt(e),e.headers=Pe.from(e.headers),e.data=Ne.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return pt(e.adapter||we.adapter)(e).then((function(t){return gt(e),t.data=Ne.call(e,e.transformResponse,t),t.headers=Pe.from(t.headers),t}),(function(t){return Me(t)||(gt(e),t&&t.response&&(t.response.data=Ne.call(e,e.transformResponse,t.response),t.response.headers=Pe.from(t.response.headers))),Promise.reject(t)}))}const mt="1.7.5";var yt=n(58651);const Et={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Et[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const vt={};Et.transitional=function(e,t,n){function i(e,t){return"[Axios v1.7.5] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,s)=>{if(!1===e)throw new te(i(r," has been removed"+(t?" in "+t:"")),te.ERR_DEPRECATED);return t&&!vt[r]&&(vt[r]=!0,yt.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,s)}};const Tt={assertOptions:function(e,t,n){if("object"!=typeof e)throw new te("options must be an object",te.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const s=i[r],o=t[s];if(o){const t=e[s],n=void 0===t||o(t,s,e);if(!0!==n)throw new te("option "+s+" must be "+n,te.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new te("Unknown option "+s,te.ERR_BAD_OPTION)}},validators:Et},St=Tt.validators;class Ct{constructor(e){this.defaults=e,this.interceptors={request:new ge,response:new ge}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Je(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&Tt.assertOptions(n,{silentJSONParsing:St.transitional(St.boolean),forcedJSONParsing:St.transitional(St.boolean),clarifyTimeoutError:St.transitional(St.boolean)},!1),null!=i&&(Y.isFunction(i)?t.paramsSerializer={serialize:i}:Tt.assertOptions(i,{encode:St.function,serialize:St.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&Y.merge(r.common,r[t.method]);r&&Y.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete r[e]})),t.headers=Pe.concat(s,r);const o=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let u,d=0;if(!a){const e=[ft.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,l),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=o.length;let h=t;for(d=0;d<u;){const e=o[d++],t=o[d++];try{h=e(h)}catch(e){t.call(this,e);break}}try{c=ft.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,u=l.length;d<u;)c=c.then(l[d++],l[d++]);return c}getUri(e){return pe(We((e=Je(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}Y.forEach(["delete","get","head","options"],(function(e){Ct.prototype[e]=function(t,n){return this.request(Je(n||{},{method:e,url:t,data:(n||{}).data}))}})),Y.forEach(["post","put","patch"],(function(e){function t(t){return function(n,i,r){return this.request(Je(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Ct.prototype[e]=t(),Ct.prototype[e+"Form"]=t(!0)}));const Rt=Ct;class bt{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e,i,r){n.reason||(n.reason=new Le(e,i,r),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new bt((function(t){e=t})),cancel:e}}}const wt=bt;const Ot={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ot).forEach((([e,t])=>{Ot[t]=e}));const It=Ot;const _t=function e(t){const n=new Rt(t),i=o(Rt.prototype.request,n);return Y.extend(i,Rt.prototype,n,{allOwnKeys:!0}),Y.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(Je(t,n))},i}(we);_t.Axios=Rt,_t.CanceledError=Le,_t.CancelToken=wt,_t.isCancel=Me,_t.VERSION=mt,_t.toFormData=ae,_t.AxiosError=te,_t.Cancel=_t.CanceledError,_t.all=function(e){return Promise.all(e)},_t.spread=function(e){return function(t){return e.apply(null,t)}},_t.isAxiosError=function(e){return Y.isObject(e)&&!0===e.isAxiosError},_t.mergeConfig=Je,_t.AxiosHeaders=Pe,_t.formToJSON=e=>Re(Y.isHTMLForm(e)?new FormData(e):e),_t.getAdapter=pt,_t.HttpStatusCode=It,_t.default=_t;const At=_t;var Dt,Ut=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Pt{constructor(e,t){this.defaultRequestTimeoutMS=8e3,this.axiosInstance=Pt.setAxiosInstance(t),this.clientParams=e,this.lastAbortController=new AbortController}static setAxiosInstance(e){return null!=e?e:At.create()}static getGuid(e){return null==e||32!=e.length?e:e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20,e.length+1)}isCancelledByClient(e){return At.isCancel(e)}postProxy(e,t,i,r){var s;return Ut(this,void 0,void 0,(function*(){if(e){const e=null===(s=n.g.SydneyDesignerInlayEditing_Commands)||void 0===s?void 0:s.dascall;if(e){const n=t.toLowerCase(),r=new URL(n),s=n.indexOf(r.pathname),o=n.substring(s),a=yield e(o,i),l={},c=Pt.getGuid(a.traceId);if("string"==typeof c&&(l[Nt.CorrelationId]=c),"string"==typeof a.errorMsg&&a.errorMsg.length>0||void 0!==a.errorCode){let e=`errorCode=[${a.errorCode}], subCode=[${a.errorSubCode}], `;e+=`reason=[${a.errorMsg}], status=[${a.responseCode}]`,l[Nt.FailureReason]=e}else if(200==a.responseCode&&void 0!==a.data){l["content-type"]=a.data.contentType;try{if(a.data.contentType.startsWith("text/plain"))return{data:atob(a.data.content),headers:l,status:a.responseCode};const e=yield fetch(`data:${a.data.contentType};base64,${a.data.content}`);return{data:yield e.blob(),headers:l,status:a.responseCode}}catch(e){l[Nt.FailureReason]=`Failed to decode or create blob: ${e}`}}return{data:"",headers:l,status:a.responseCode}}}return yield this.axiosInstance.post(t,i,r)}))}}!function(e){e[e.prod=0]="prod",e[e.edog=1]="edog",e[e.int=2]="int",e[e.local=3]="local",e[e.canary=4]="canary",e[e.euc=5]="euc",e[e.gcc=6]="gcc"}(Dt||(Dt={}));const Nt={AccessToken:"AccessToken",Action:"Action",AudienceGroup:"AudienceGroup",Authorization:"Authorization",Caller:"Caller",ClientBuild:"ClientBuild",ClientId:"ClientId",ClientName:"ClientName",ContainerId:"ContainerId",ContentType:"Content-Type",CorrelationId:"X-Correlation",Correlation_Id:"X-Correlation-ID",DataCenterHint:"X-DC-Hint",DeviceId:"DeviceId",DocId:"DocId",EnvironmentHint:"X-Environment-Hint",ErrorCode:"X-ErrorCode",FailureReason:"X-FailureReason",FileToken:"FileToken",Handler:"Handler",HostApp:"HostApp",InviteCode:"InviteCode",InviteProgram:"InviteProgram",Locale:"Locale",PersistentId:"PersistentId",Platform:"Platform",ReleaseChannel:"ReleaseChannel",SessionId:"SessionId",StatusCode:"StatusCode",ThemeMetadatas:"ThemeMetadatas",Trigger:"Trigger",UploadToStorage:"x-upload-to-storage-das",UserAgent:"User-Agent",UserId:"UserId",UserSessionId:"X-UserSessionId",UserType:"UserType"},Mt={NotEnoughSuggestions:"NotEnoughSuggestions"},xt="http://localhost:8087",Lt="https://designerapp.edog.officeapps.live.com",Bt="https://designerapp.officeapps.live-int.com",Ft="https://canary.designerapp.officeapps.live.com",kt="https://euc.designerapp.officeapps.live.com",Ht="https://designerapp.officeapps.live.com";class jt{static getBaseUrl(e){switch(e){case Dt.local:return xt;case Dt.edog:return Lt;case Dt.int:return Bt;case Dt.canary:return Ft;case Dt.euc:return kt;case Dt.gcc:return"";case Dt.prod:default:return Ht}}static getGettyUsageReportUrl(e){switch(e){case Dt.euc:return"https://euc.hubblecontent.osi.office.net/contentsvc/api/telemetry/getty";case Dt.local:case Dt.edog:case Dt.int:return"https://hubblecontent.df.osi.office.net/contentsvc/api/telemetry/getty";case Dt.gcc:return"";case Dt.canary:case Dt.prod:default:return"https://hubblecontent.osi.office.net/contentsvc/api/telemetry/getty"}}static getDasRing(e){const t=e.toString();if(t===new URL(xt).toString())return Dt.local;if(t===new URL(Lt).toString())return Dt.edog;if(t===new URL(Bt).toString())return Dt.int;if(t===new URL(Ft).toString())return Dt.canary;if(t===new URL(kt).toString())return Dt.euc;if(t===new URL(Ht).toString())return Dt.prod;throw new Error("Invalid DAS URL")}static getAccountUrl(e){return this.getBaseUrl(e)+"/designerapp/Account.ashx"}static getAnimationsUrl(e){return this.getBaseUrl(e)+"/designerapp/Animation.ashx"}static getAnimationTemplatesUrl(e){return this.getAnimationsUrl(e)+"/?Action=GetAllAnimationTemplates"}static getAppsIntegrationUrl(e){return this.getBaseUrl(e)+"/designerapp/OAuth.ashx"}static getBrandKitEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/BrandKit.ashx"}static getDallEBaseUrl(e){return this.getBaseUrl(e)+"/designerapp/DallE.ashx"}static getDallEImageUrl(e){return`${this.getDallEBaseUrl(e)}?action=GetDallEImagesCogSci`}static getDallEReportImageUrl(e){return`${this.getDallEBaseUrl(e)}?action=ReportDallEImage`}static getDocumentEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/Document.ashx"}static getImageTransformUrl(e){return this.getBaseUrl(e)+"/designerapp/imagetransformation.ashx"}static getLoggingUrl(e){return this.getBaseUrl(e)+"/designerapp/RemoteUls.ashx"}static getMediaEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/MediaSuggestions.ashx"}static getMediaUploadUrl(e){return this.getBaseUrl(e)+"/designerapp/Media.ashx"}static getMediaPollUrl(e,t){return this.getBaseUrl(e)+`/designerapp/Media.ashx?action=poll&id=${t}`}static getObjectLevelAnimationUrl(e){return this.getAnimationsUrl(e)+"/?Action=ObjectLevelAnimation"}static getPhoneUploadServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/mobileupload.ashx"}static getProactiveSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/proactivesuggestions.ashx"}static getPublishUrl(e){return this.getBaseUrl(e)+"/designerapp/Publish.ashx"}static getRealTimeChannelUrl(e){return(this.getBaseUrl(e)+"/designerapp/RealTimeChannel.ashx").replace("http","ws")}static getRecommendedImageServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/FilterRecommendations.ashx"}static getSocialMediaOAuthURL(e,t,n){return this.getBaseUrl(e)+`/designerapp/SocialMedia.ashx?state=${t}&social_media=${n.toLocaleLowerCase()}`}static getStableDiffusionUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx"}static getSAMEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/sam.ashx/?Action=SAM"}static getMediaProcessorUrl(e){return this.getBaseUrl(e)+"/designerapp/mediaprocessor.ashx"}static getStableDiffusionGenerativeFontEffectUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=TextEffects"}static getStableDiffusionObjectRemovalUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=MIRObjRem"}static getStableDiffusionProductPlacementUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=ProductPlacement"}static getStableDiffusionReportImageUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=Report"}static getSubmitTemplateUrl(e){return this.getBaseUrl(e)+"/designerapp/SubmitTemplate.ashx"}static getSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/suggestions.ashx"}static getSuggestionThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx"}static getSuggestionCompressedThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx/?action=GetCompressedThumbnail"}static getTraceRequestEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/TraceRequest.ashx"}static getUserAssetsServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/userasset.ashx"}static getWhatsNewEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/notifications.ashx"}static getTryItPromptsUrl(e){return this.getBaseUrl(e)+"/designerapp/TryItPrompts.ashx"}static getOCPSClientUrl(e){return this.getBaseUrl(e)+"/designerapp/OCPSClient.ashx"}static getBotAssetUrl(e,t,n){return this.getBaseUrl(e)+`/designerapp/BotAsset.ashx?chatId=${t}&messageId=${n}`}static getAbuseMonitoringUrl(e){return this.getBaseUrl(e)+"/designerapp/AbuseMonitoring.ashx"}static getTemplateSearchUrl(e){return this.getBaseUrl(e)+"/designerapp/TemplateSearch.ashx"}}var qt;!function(e){e[e.InProgress=0]="InProgress",e[e.Completed=1]="Completed",e[e.Failed=2]="Failed"}(qt||(qt={}));var zt=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Gt{}Gt.tryPopulatePageDataFromUrlForMultiPageSuggestions=(e,t,n,i,r)=>zt(void 0,void 0,void 0,(function*(){var s,o,a,l,c,u,d,h;let p=!0;if(null!=t.multipageSuggestionUrls){const g=yield Promise.all(t.multipageSuggestionUrls.map((t=>e.getSuggestionDataFromFileCacheUrl(t,n,i,r))));for(let e=0;e<g.length;e++)null!=(null===(o=null===(s=g[e])||void 0===s?void 0:s.content)||void 0===o?void 0:o.pageData)?t.multiPageData[e]=null===(l=null===(a=g[e])||void 0===a?void 0:a.content)||void 0===l?void 0:l.pageData:p=!1,null!=(null===(u=null===(c=g[e])||void 0===c?void 0:c.content)||void 0===u?void 0:u.relationshipsData)?t.multiRelationshipsData[e]=null===(h=null===(d=g[e])||void 0===d?void 0:d.content)||void 0===h?void 0:h.relationshipsData:p=!1}return p}));var Wt,$t,Jt,Vt,Qt,Kt,Yt=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Xt extends Pt{constructor(){super(...arguments),this.defaultRequestTimeoutMS=8e3}fetchSuggestions(e,t,n,i){var r,s,o,a,l;return Yt(this,void 0,void 0,(function*(){e.cancelLastRequest&&this.lastAbortController.abort();try{this.lastAbortController=new AbortController;const l=ln.createRequestHeaders(this.clientParams,e.requestParams);l["Content-Type"]=e.contentType;const c=n?yield this.fetchSuggestionAsStreamData(e,l,this.lastAbortController,i):yield this.axiosInstance.request({url:this.url,data:e.data,headers:l,method:e.method,params:e.queryParams,timeout:null!==(s=null===(r=e.requestParams)||void 0===r?void 0:r.RequestTimeoutMS)&&void 0!==s?s:this.defaultRequestTimeoutMS,responseType:"arraybuffer",signal:this.lastAbortController.signal}),u=Xt.parseDASResponse(c.data,c.headers,c.status,t,n);return(null===(a=null===(o=e.requestParams)||void 0===o?void 0:o.hints)||void 0===a?void 0:a.ShouldPrefetchPictureThumbnails)&&u.then((t=>Yt(this,void 0,void 0,(function*(){var n,i,r;(null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.suggestions)&&(yield ln.prefetchThumbnails(t.content.suggestions,null!==(r=null===(i=e.requestParams)||void 0===i?void 0:i.ThumbnailPrefetchTimeoutInMs)&&void 0!==r?r:this.defaultRequestTimeoutMS))})))),yield u}catch(e){const t=this.isCancelledByClient(e),i=n&&"AbortError"===e.name,r=n&&!e.response&&e instanceof DOMException&&(null===(l=e.message)||void 0===l?void 0:l.includes("abort"));if(t||r||i)return{error:Wt.ClientCanceled};throw e}}))}static parseDASResponse(e,t,n,i,r){var s;return Yt(this,void 0,void 0,(function*(){if(n){const e=ln.getSuggestionRequestErrorFromStatusCode(n,t);if(e!==Wt.None)return{headers:t,statusCode:n,error:e}}const o=r?ln.validateAndGetContentBody(e):new Uint8Array(e);if(!o||o instanceof Uint8Array&&!o.length)return{headers:t,statusCode:n,error:Wt.NoResponse};const a=null!==(s=t[Nt.ContentType])&&void 0!==s?s:t[Nt.ContentType.toLowerCase()];if(!a)return{headers:t,statusCode:n,error:Wt.NoResponse};let l={};const c=ln.getContentType(a);return c==$t.Multipart?l=yield Xt.parseMultipartSuggestions(a,o,i,r):c==$t.JSON&&o instanceof Uint8Array&&(yield pn.parseJSONPart(o,l)),{content:l,headers:t,statusCode:n,error:Wt.None}}))}fetchSuggestionAsStreamData(e,t,n,i){var r,s;return Yt(this,void 0,void 0,(function*(){const o=null!==(s=null===(r=e.requestParams)||void 0===r?void 0:r.RequestTimeoutMS)&&void 0!==s?s:this.defaultRequestTimeoutMS;let a;const l=new Promise((e=>a=setTimeout(e,o))),c=fetch(`${this.url}?${e.queryParams.toString()}`,{method:e.method,headers:t,body:e.data,signal:n.signal}),u=yield Promise.race([c,l]);if(!u)throw this.lastAbortController.abort(),new Error(`timeout of ${o}ms exceeded`);if(!u.ok)throw{response:u};a&&clearTimeout(a);const d=u,h=ln.convertHeadersToLowerCase(d.headers);return null==i||i(h),{data:d.body,headers:h,status:d.status}}))}static parseMultipartSuggestions(e,t,n,i){return Yt(this,void 0,void 0,(function*(){return n==Jt.SCHEMA_V2?yield En.parseMultipartSuggestions(e,t,i):n==Jt.SCHEMA_V1?yield gn.parseMultipartSuggestions(e,t,i):yield pn.parseMultipartSuggestions(e,t,i)}))}}class Zt extends Xt{constructor(){super(...arguments),this.url=jt.getSuggestionEndpointUrl(this.clientParams.ServiceRing)}getSuggestions(e,t,n,i,r){return Yt(this,void 0,void 0,(function*(){const s=JSON.stringify(e),o=new URLSearchParams,a=null==t?void 0:t.DocumentId;return void 0!==a&&o.append("documentId",a),yield this.fetchSuggestions({cancelLastRequest:n,contentType:"application/json",data:s,method:"POST",requestParams:t,queryParams:o},void 0,i,r)}))}getMultiPageSuggestions(e,t,n,i,r,s=Jt.SCHEMA_V1){return Yt(this,void 0,void 0,(function*(){const o=JSON.stringify(e),a=new URLSearchParams,l=null==t?void 0:t.DocumentId;return void 0!==l&&a.append("documentId",l),yield this.fetchSuggestions({cancelLastRequest:n,contentType:"application/json",data:o,method:"POST",requestParams:t,queryParams:a},s,i,r)}))}getSuggestionDataFromFileCacheUrl(e,t,n,i){var r;return Yt(this,void 0,void 0,(function*(){const s=null!=n?n:1,o=null!=i?i:500;let a,l;for(let n=0;n<s;n++)try{const i=yield this.axiosInstance.request({url:`${e}&action=getSuggestionData`,method:"GET",timeout:null!==(r=null==t?void 0:t.RequestTimeoutMS)&&void 0!==r?r:this.defaultRequestTimeoutMS,responseType:"arraybuffer",signal:this.lastAbortController.signal});if(a=yield Xt.parseDASResponse(i.data,i.headers,i.status),a.error==Wt.None)return a;n<s-1&&(l&&clearTimeout(l),yield new Promise((e=>{l=setTimeout(e,o)})))}catch(e){n<s-1&&(l&&clearTimeout(l),yield new Promise((e=>{l=setTimeout(e,o)})))}return l&&clearTimeout(l),null!=a?a:{error:Wt.NoResponse}}))}getSuggestionsWithImageContent(e,t,n,i,r){return Yt(this,void 0,void 0,(function*(){const s=yield pn.buildMultipartMixedRequest(e),o=new URLSearchParams,a=null==t?void 0:t.DocumentId;return void 0!==a&&o.append("documentId",a),yield this.fetchSuggestions({contentType:s.contentType,cancelLastRequest:n,data:s.body,method:"POST",queryParams:o,requestParams:t},void 0,i,r)}))}getMultiPageSuggestionsWithImageContent(e,t,n,i,r,s=Jt.SCHEMA_V1){return Yt(this,void 0,void 0,(function*(){const o=yield pn.buildMultipartMixedRequest(e),a=new URLSearchParams,l=null==t?void 0:t.DocumentId;return void 0!==l&&a.append("documentId",l),yield this.fetchSuggestions({contentType:o.contentType,cancelLastRequest:n,data:o.body,method:"POST",queryParams:a,requestParams:t},s,i,r)}))}static parseSuggestionsResponse(e,t,n){const i=Object.create(null,{parseDASResponse:{get:()=>super.parseDASResponse}});return Yt(this,void 0,void 0,(function*(){const r=i.parseDASResponse.call(this,e,t,n);return yield r}))}}!function(e){e.ClientCanceled="Client canceled request",e.None="None",e.NoResults="No Results",e.NoResponse="No Response",e.Timeout="Timeout",e.NotEnoughSuggestions="Not Enough Suggestions"}(Wt||(Wt={})),function(e){e[e.Multipart=0]="Multipart",e[e.JSON=1]="JSON",e[e.Default=2]="Default"}($t||($t={})),function(e){e[e.SCHEMA=0]="SCHEMA",e[e.SCHEMA_V1=1]="SCHEMA_V1",e[e.SCHEMA_V2=2]="SCHEMA_V2"}(Jt||(Jt={})),function(e){e[e.None=0]="None",e[e.IdeasNetworkError=1]="IdeasNetworkError",e[e.TemplatesNetworkError=2]="TemplatesNetworkError"}(Vt||(Vt={})),function(e){e[e.prod=0]="prod",e[e.edog=1]="edog",e[e.int=2]="int",e[e.local=3]="local",e[e.canary=4]="canary",e[e.euc=5]="euc",e[e.gcc=6]="gcc"}(Qt||(Qt={})),function(e){e[e.other=0]="other",e[e.mediaSuggestions=1]="mediaSuggestions",e[e.document=2]="document",e[e.rtc=3]="rtc",e[e.traceRequest=4]="traceRequest",e[e.userassets=5]="userassets"}(Kt||(Kt={}));const en="x-designerappservice-third-party";var tn,nn,rn,sn;!function(e){e.OpenDesignInNewTab="OpenDesignInNewTab",e.ResizeInNewTab="ResizeInNewTab",e.HomePageImageEffectToolAction="HomePageImageEffectToolAction",e.CleanupPostMessageHandler="CleanupPostMessageHandler"}(tn||(tn={})),function(e){e.PostMessage="PostMessage",e.ReduxPersist="ReduxPersist"}(nn||(nn={})),function(e){e[e.None=0]="None",e[e.Train=1]="Train",e[e.Resize=2]="Resize",e[e.Edit=3]="Edit",e[e.New=4]="New"}(rn||(rn={})),function(e){e[e.CONTINUE=100]="CONTINUE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.PROCESSING=102]="PROCESSING",e[e.EARLY_HINTS=103]="EARLY_HINTS",e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.MOVED_TEMPORARILY=302]="MOVED_TEMPORARILY",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.USE_PROXY=305]="USE_PROXY",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_TOO_LONG=413]="REQUEST_TOO_LONG",e[e.REQUEST_URI_TOO_LONG=414]="REQUEST_URI_TOO_LONG",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.IM_A_TEAPOT=418]="IM_A_TEAPOT",e[e.INSUFFICIENT_SPACE_ON_RESOURCE=419]="INSUFFICIENT_SPACE_ON_RESOURCE",e[e.METHOD_FAILURE=420]="METHOD_FAILURE",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.LOCKED=423]="LOCKED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"}(sn||(sn={}));var on=n(78126),an=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class ln{static createRequestHeaders(e,t){var n;const i={};i[Nt.AudienceGroup]=e.AudienceGroup,i[Nt.Caller]=e.Caller,i[Nt.ClientId]=e.ClientId,i[Nt.SessionId]=e.SessionId,i[Nt.UserId]=e.UserId,e.ClientName&&(i[Nt.ClientName]=e.ClientName);const r=null!==(n=null==t?void 0:t.CorrelationId)&&void 0!==n?n:(0,on.A)();return i[Nt.CorrelationId]=r,i[Nt.Correlation_Id]=r,t&&(t.ContainerId&&(i[Nt.ContainerId]=t.ContainerId),t.DocumentId&&(i[Nt.DocId]=t.DocumentId),t.FileToken&&(i[Nt.FileToken]=t.FileToken),t.AuthToken&&(i[Nt.Authorization]=t.AuthToken),t.EnvHint&&(i[Nt.EnvironmentHint]=t.EnvHint),t.DcHint&&(i[Nt.DataCenterHint]=t.DcHint),t.ClientBuild&&(i[Nt.ClientBuild]=t.ClientBuild),t.ClientName&&(i[Nt.ClientName]=t.ClientName),t.HostApp&&(i[Nt.HostApp]=t.HostApp),t.Platform&&(i[Nt.Platform]=t.Platform),t.ReleaseChannel&&(i[Nt.ReleaseChannel]=t.ReleaseChannel),t.DesignerappserviceThirdParty&&(i[en]=t.DesignerappserviceThirdParty)),e.UserType&&(i[Nt.UserType]=e.UserType),i["x-req-start"]=String(performance.now()),i}static prefetchThumbnails(e,t){return an(this,void 0,void 0,(function*(){if((null==e?void 0:e.length)>0){const n=new Array;for(const t of e)if(t.relationshipsData){const e=t.relationshipsData;if(null==e?void 0:e.Relationship)for(const t of e.Relationship)t.Thumbnail&&n.push(t.Thumbnail)}n.length>0&&(yield Promise.all(n.map((e=>At.get(e,{timeout:t})))))}}))}static getSuggestionRequestErrorFromStatusCode(e,t){var n,i;switch(e){case sn.OK:return Wt.None;case sn.NO_CONTENT:return(null!==(i=null===(n=null==t?void 0:t[Nt.FailureReason.toLowerCase()])||void 0===n?void 0:n.toString())&&void 0!==i?i:"").toLowerCase()===Mt.NotEnoughSuggestions.toLowerCase()?Wt.NotEnoughSuggestions:Wt.NoResults;default:return Wt.NoResponse}}static getContentType(e){return-1!=e.indexOf("multipart/mixed")?$t.Multipart:-1!=e.indexOf("application/json")?$t.JSON:$t.Default}static convertHeadersToLowerCase(e){if(!e)return{};const t={};for(const[n,i]of e.entries())t[n.toLowerCase()]=i;return t}static validateAndGetContentBody(e){if(!e)return null;if(e instanceof ArrayBuffer){const t=new Uint8Array(e);return(null==t?void 0:t.length)?t:null}return e instanceof ReadableStream?e.getReader():null}}ln.tryPopulateSuggestionPayloadFromURL=(e,t,n,i,r)=>an(void 0,void 0,void 0,(function*(){var s,o,a;if(t.isMultiPage)return yield Gt.tryPopulatePageDataFromUrlForMultiPageSuggestions(e,t,n,i,r);if(void 0!==(null==t?void 0:t.suggestionUrl)){const l=yield e.getSuggestionDataFromFileCacheUrl(t.suggestionUrl,n,i,r);if(null===(s=null==l?void 0:l.content)||void 0===s?void 0:s.pageData)return t.pageData=null===(o=null==l?void 0:l.content)||void 0===o?void 0:o.pageData,t.relationshipsData=null===(a=null==l?void 0:l.content)||void 0===a?void 0:a.relationshipsData,!0}return!1}));class cn{async processMultipartResponse(e,t,n){if(null==e)throw"multipartContentBuffer is empty";try{const i=new TextDecoder("utf-8").decode(e);this.parseMultipart(i,t).forEach((e=>{const t=this.parseResponsePart(e);n(t)}))}catch(e){const t={Err:new Error(e)};n(t)}}fetchBoundary(e){let t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,n){if(!e)throw"multipartContentBufferOrStream is empty";let i,r,s="",o=0,a=[],l=null;const c=e instanceof Uint8Array;try{for(;;){if(c)r=e;else{const{done:t,value:n}=await e.read();if(t)break;r=n}for(const e of r){const r=10===e||13===e,c=10===e&&13===l,u=10===l&&13===e;if(a.push(e),r||(s+=String.fromCharCode(e)),0===o&&c)`--${t}`===s&&(o=1,s="",a=[]);else if(1===o&&u)i=new Uint8Array(a),o=2,s="",a=[];else if(2===o&&c)o=3,s="",a=[];else if(3===o){if(s.length>t.length+4&&(s=""),`--${t}`===s){let e=a.length-s.length,t=a.slice(0,e-1);o=1,n({Headers:this.processHeader(i),Body:new Uint8Array(t)}),s="",i=void 0,a=[]}c&&(s="")}l=e}if(c)break}}catch(e){n({Err:new Error(e)})}}parseMultipart(e,t){const n=`--${t}`;return e.split(n).map((e=>e.trim())).filter((e=>""!==e&&"--"!==e))}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),n=new Map;t.forEach((e=>{const t=e.split(": ");2===t.length&&n.set(t[0],t[1])}));const i=this.parseResponseBodyFromPart(e),r=(new TextEncoder).encode(i);return{Headers:n,Body:r}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){let t=new Map;if(e){let n="";for(let t=0;t<e.byteLength;t+=1)n+=String.fromCharCode(e[t]);n.split("\n").forEach((e=>{let n=e.split(": ");2===n.length&&t.set(n[0],n[1])}))}return t}}var un=n(37542).Buffer,dn=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},hn=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class pn{static buildMultipartMixedRequest(e){var t,n;return dn(this,void 0,void 0,(function*(){const i="...Boundary_Outer";let r="",s=[],o=[];if("ImageFiles"in e&&e.ImageFiles.length>0){const{ImageFiles:t}=e,n=hn(e,["ImageFiles"]);s=t,r=JSON.stringify(n)}else if("ImageBuffers"in e&&e.ImageBuffers.length>0){const{ImageBuffers:t}=e,n=hn(e,["ImageBuffers"]);o=t,r=JSON.stringify(n)}else("ImageUrls"in e&&(null===(t=e.ImageUrls)||void 0===t?void 0:t.length)||(null===(n=e.MediaContent)||void 0===n?void 0:n.length))&&(r=JSON.stringify(e));const a=`--${i}\r\nContent-Type: application/json\r\n\r\n${r}`,l=un.from(a),c=[];let u=l.length;if(c.push(l),(null==s?void 0:s.length)>0){for(const e of s)if(e.size>0&&e.type.length>0){const t=`\r\n--${i}\r\nContent-Type: ${e.type}\r\n\r\n`,n=un.from(t),r=yield e.arrayBuffer(),s=new Uint8Array(r);c.push(n),c.push(s),u+=n.length,u+=s.length}}else if(o.length>0)for(const e of o)if(e.buffer.byteLength>0&&e.type.length>0){const t=`\r\n--${i}\r\nContent-Type: ${e.type}\r\n\r\n`,n=un.from(t);c.push(n),c.push(e.buffer),u+=n.length,u+=e.buffer.length}const d=un.from(`\r\n--${i}--`);c.push(d),u+=d.length;const h=new Uint8Array(u);let p=0;return c.forEach((e=>{h.set(e,p),p+=e.length})),{contentType:`multipart/mixed; boundary=${i}`,body:h}}))}static parseMultipartSuggestions(e,t,n){return dn(this,void 0,void 0,(function*(){const i={suggestions:[]},r=n?e=>{this.parseSuggestionPartContent(e,i,n)}:void 0,s=yield this.getSuggestionsPartContent(e,t,r);if(!n)for(const e of s)this.parseSuggestionPartContent(e,i);return i}))}static parseSuggestionPartContent(e,t,n){return dn(this,void 0,void 0,(function*(){const{Headers:i,Body:r}=e,s=null==i?void 0:i.get(Nt.ContentType);if(r&&s)if(!0===s.startsWith("application/json"))this.parseJSONPart(r,t,n);else this.parseDesignContent(e,t,n)}))}static getSuggestionsPartContent(e,t,n){return dn(this,void 0,void 0,(function*(){const i=new cn,r=i.fetchBoundary(e),s=[];let o="";return yield i.processMultipartBinaryResponse(t,r,(e=>{e.Err?o=`Designer Response: Error parsing response body ${e.Err}`:(null==n||n(e),s.push(e))})),o?Promise.reject(o):s}))}static parseDesignJSONPart(e,t){const n=(new TextDecoder).decode(e),i=JSON.parse(n);t.designData=i}static parseJSONPart(e,t,n){var i,r,s,o,a;return dn(this,void 0,void 0,(function*(){const l=(new TextDecoder).decode(e),c=JSON.parse(l);if(c.pageIds)return this.parseDesignJSONPart(e,t),void(null==n||n(t));if(c.KeyPhrases&&c.KeyPhrases.length>0)return t.keyphrase=null!==(i=c.KeyPhrases[0].KeyPhraseText)&&void 0!==i?i:"",void(null==n||n(t));if(c.Metadata){const e=c.Metadata;(null===(r=e.PromptEngineering)||void 0===r?void 0:r.PromptGuidance)&&(t.promptGuidance=e.PromptEngineering.PromptGuidance),(null===(s=e.PromptEngineering)||void 0===s?void 0:s.ParsedHeading)&&(t.parsedHeading=e.PromptEngineering.ParsedHeading),(null===(o=e.Prompt)||void 0===o?void 0:o.DetectedPromptIntent)&&(t.promptIntent=e.Prompt.DetectedPromptIntent)}if(c.PageData&&(t.pageData=c.PageData),c.RelationshipsData&&(t.relationshipsData=c.RelationshipsData),c.DesignData&&(t.designData=c.DesignData),null==n||n(t),c.DesignId){const e={data:new Uint8Array,metadata:""};this.populateDesignContentFromJson(e,c),null==n||n(e),null===(a=t.suggestions)||void 0===a||a.push(e)}}))}static parseDesignContent(e,t,n){var i;return dn(this,void 0,void 0,(function*(){const{Headers:r,Body:s}=e,o=null==r?void 0:r.get(Nt.ContentType);if(!o||!s)return;const a={data:new Uint8Array,metadata:""},l=new cn,c=l.fetchBoundary(o).trim();let u="";if(yield l.processMultipartBinaryResponse(s,c,(e=>{e.Err?u=`error parsing inner response body ${e.Err}`:this.populateDesignContent(e,a)})),u)throw new Error(u);null==n||n(a),null===(i=t.suggestions)||void 0===i||i.push(a)}))}static populateDesignContent(e,t){var n;return dn(this,void 0,void 0,(function*(){const{Headers:i,Body:r}=e,s=null===(n=null==i?void 0:i.get(Nt.ContentType))||void 0===n?void 0:n.trim();if(s&&r)if(s.startsWith("application/json")){const e=JSON.parse((new TextDecoder).decode(r));this.populateDesignContentFromJson(t,e)}else if(this.supportedMimeTypesForBinaryData.has(s)){if(r.length<=1)return;t.data=r}}))}}pn.supportedMimeTypesForBinaryData=new Set(["image/jpeg","image/png","image/bmp"]),pn.populateDesignContentFromJson=(e,t)=>{var n,i,r,s,o,a,l,c;t&&(e.metadata=null!==(n=t.Metadata)&&void 0!==n?n:"",e.pageData=null!==(i=t.PageData)&&void 0!==i?i:{},e.relationshipsData=null!==(r=t.RelationshipsData)&&void 0!==r?r:{},e.dimension=t.Dimension,e.slideSize=t.SlideSize,e.highResThumbnailUrl=null!==(s=t.HighResThumbnailUrl)&&void 0!==s?s:"",e.suggestionUrl=t.SuggestionUrl,e.urlIdentifier=t.UrlIdentifier,e.isMotionSuggestion=null!==(o=t.IsMotionSuggestion)&&void 0!==o&&o,t.additionalMetadata&&(e.proactiveSuggestionMetadata=t.additionalMetadata),e.debugInfo=t.DebugInfo,e.isMultiPage=t.IsMultiPage,e.apsEventId=t.ApsEventId,e.designLocale=t.DesignLocale,e.designExperiments=t.DesignExperiments,e.designId=t.DesignId,e.thumbnailUrl=t.SuggestionThumbnailUrl?t.SuggestionThumbnailUrl:t.ThumbnailUrl,e.thirdPartyData=t.ThirdPartyData,e.recipeType=null===(a=t.DesignExtendedInfo)||void 0===a?void 0:a.Recipetype,e.designDescription=null!==(l=t.DesignDescription)&&void 0!==l?l:"",e.designExtendedInfo=null!==(c=t.DesignExtendedInfo)&&void 0!==c?c:{})};class gn extends pn{static parseDesignJSONPart(e,t){var n;const i=(new TextDecoder).decode(e),r=JSON.parse(i);t.designData=null!==(n=t.designData)&&void 0!==n?n:[],t.designData.push(r)}}var fn,mn,yn=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n};class En extends pn{static parseDesignJSONPart(e,t){var n;const i=(new TextDecoder).decode(e),r=JSON.parse(i);t.designInfo=null!==(n=t.designInfo)&&void 0!==n?n:[];const{RelationshipsData:s}=r,o={designData:yn(r,["RelationshipsData"]),designRels:s};t.designInfo.push(o)}}!function(e){e.ClientCanceled="Client canceled request",e.EmptyBody="Empty Body",e.None="None",e.NoResults="No Results",e.NoResponse="No Response"}(fn||(fn={})),function(e){e.ClientCanceled="Client canceled request",e.ContentTypeMissing="Content type header missing",e.EmptyBody="Empty Body",e.None="None",e.NoResults="No Results",e.NoResponse="No Response"}(mn||(mn={}));var vn=n(27420),Tn=n(76916),Sn=n(26529);class Cn{constructor(e,t,n){this.targetOrigin=e,this.hostWindow=t,this.iframeid=n,this.boundOnMessage=this.onMessage.bind(this),this.callbacks=new Map,this.hostWindow.addEventListener("message",this.boundOnMessage)}removeMessageHandler(){this.off(),this.hostWindow.removeEventListener("message",this.boundOnMessage)}on(e,t){if(this.callbacks.has(e))throw new Error(`"${e}" already registered`);this.callbacks.set(e,t)}off(e){if(e){if(!this.callbacks.has(e))throw new Error(`"${e}" not registered`);this.callbacks.delete(e)}else this.callbacks.clear()}setTarget(e){this.target=e}send(e,t){if(!this.target)throw new Error("Must call initialize first");this.target.postMessage({type:e,data:t},this.targetOrigin)}destroy(){this.removeMessageHandler(),this.target=void 0,this.hostWindow=void 0}onMessage(e){var t;const{origin:n,data:i}=e,r=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.iframeid;if(new URL(n).origin!==new URL(this.targetOrigin).origin||r&&r!=this.iframeid)return;const{type:s,data:o}=i,a=this.callbacks.get(s);a&&a(o)}}const Rn=["https://designerappservice.officeapps.live.com/designerappservice.all"],bn=["https://designerappserviceppe.officeapps.live.com/designerappservice.all"];class wn extends Error{constructor(e,t){super(e),this.canRetry=t}}var On=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class In{constructor(e,t){this.m_appMessageHandler=e,this.m_settings=t}initialize(){this.m_appMessageHandler.on("auth_fetch",this.onAuthMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_settings=void 0}onAuthMessage(){return On(this,void 0,void 0,(function*(){try{const e=yield this.getAuthToken();this.m_appMessageHandler.send("auth_token",e)}catch(e){this.m_appMessageHandler.send("auth_error",e)}}))}getAuthToken(){return On(this,void 0,void 0,(function*(){if(this.m_settings.hostTokenProvider){const e=!1?bn:Rn;return yield this.m_settings.hostTokenProvider.getToken(e)}throw new wn("No host auth callback provided")}))}}var _n=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class An{constructor(e,t){this.m_appMessageHandler=e,this.m_hostSessionStorage=t}initialize(){this.m_appMessageHandler.on("dcHint",this.onDcHintMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_hostSessionStorage=void 0}onDcHintMessage(e){return _n(this,void 0,void 0,(function*(){(null==e?void 0:e.dcHint)&&"string"==typeof(null==e?void 0:e.dcHint)&&this.m_hostSessionStorage.setDcHint(null==e?void 0:e.dcHint)}))}}class Dn{constructor(e){var t,n,i;this.fileCacheInfoChangeHandler=null===(t=e.fileCacheInfoConfig)||void 0===t?void 0:t.hostCallback;const r=null===(n=e.fileCacheInfoConfig)||void 0===n?void 0:n.fileCacheInfo;if(r)this.containerId=r.containerId,this.fileToken=r.fileToken,this.dcHint=r.dcHint;else{const t=null===(i=e.hostTokenProvider)||void 0===i?void 0:i.identityType,n=e.telemetryConfig.clientName.toLowerCase().trim().replaceAll(" ","-");this.containerId=""+("AAD"===t?`aad-${n}-${(0,on.A)()}`:`${n}-${(0,on.A)()}`),this.fileToken=(0,on.A)(),this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo())}}getContainerId(){return this.containerId}getFileToken(){return this.fileToken}getDcHint(){return this.dcHint}setDcHint(e){e!==this.dcHint&&(this.dcHint=e,this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo()))}getFileCacheInfo(){return{containerId:this.containerId,fileToken:this.fileToken,dcHint:this.dcHint}}}const{parseSuggestionsResponse:Un}=Zt;var Pn,Nn,Mn,xn,Ln;!function(e){e.DownloadDesign="downloadDesign",e.GenerateImage="generateImage",e.UpdateDesignDescription="updateDesignDescription",e.UploadImage="uploadImage",e.LoadThumbnails="loadThumbnails",e.CompleteBoot="completeBoot",e.OpenMini="openMini",e.CloseMini="closeMini"}(Pn||(Pn={})),function(e){e[e.Like=0]="Like",e[e.Dislike=1]="Dislike"}(Nn||(Nn={})),function(e){e.Pane="pane",e.Chat="chat"}(Mn||(Mn={})),function(e){e.Auto="auto",e.Dark="dark",e.Light="light",e.HighContrast="highContrast"}(xn||(xn={})),function(e){e[e.Done=0]="Done",e[e.Insert=1]="Insert"}(Ln||(Ln={}));var Bn=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};const Fn=new Map([["image/jpeg","jpg"],["image/png","png"],["image/x-png","png"],["image/webp","webp"],["image/heic","heic"]]);var kn=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Hn{constructor(e){var t,n;this.m_settings=e,this.axiosInstance=At.create(),this.iframeid=(0,on.A)(),this.m_hostWindow=null!==(n=null===(t=e.container.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==n?n:window,this.m_appMessageHandler=new Cn(this.m_settings.miniURL.origin,this.m_hostWindow,this.iframeid),this.m_authMessageHandler=new In(this.m_appMessageHandler,this.m_settings),this.m_iframe=this.createAppFrame(),this.m_hostSessionStorage=new Dn(this.m_settings),this.m_dcHintMessageHandler=new An(this.m_appMessageHandler,this.m_hostSessionStorage);this.axiosInstance.interceptors.response.use((e=>{const t=e.headers[Nt.DataCenterHint.toLowerCase()];return t&&this.m_hostSessionStorage.setDcHint(t),e}))}getSuggestions(e,t,n,i,r,s){var o,a,l;return kn(this,void 0,void 0,(function*(){if(!this.m_suggestionClient){const e=null===(o=this.m_settings.hostTokenProvider)||void 0===o?void 0:o.identityType,t=null===(a=this.m_settings.hostTokenProvider)||void 0===a?void 0:a.accountInfo.userId,n=this.m_settings.telemetryConfig.clientId,i=t?"AAD"===e?t:function(e,t){if(36===(null==e?void 0:e.length))return e.substr(19,4)+e.substr(24);return 16===(null==e?void 0:e.length)&&!0===t?e:(vn.Hv.sendTraceTag(507873103,Tn.n.msoulscat_Wac_Telemetry,Sn.k.Error,"Unexpected localAccountId length"),"")}(t):n;this.m_suggestionClient=new Zt({AudienceGroup:this.m_settings.telemetryConfig.audienceGroup,Caller:"DesignerEcosystem",ClientId:this.m_settings.telemetryConfig.clientId,ClientName:this.m_settings.telemetryConfig.clientName,ServiceRing:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),SessionId:this.m_settings.telemetryConfig.sessionId,UserId:i},this.axiosInstance)}const c=this.m_hostSessionStorage.getFileCacheInfo(),u={ContainerId:c.containerId,FileToken:c.fileToken,DcHint:c.dcHint},d={Title:{Text:""},SubTitle:{Text:""},Expectations:{Dimension:t,TypeMetadata:[null!==(l=this.m_settings.preferredImageOutputFormat)&&void 0!==l?l:"jpg","oxsd"],MinCount:n,MaxCount:i||(h=this.m_settings.viewConfig.view,h===Mn.Chat?4:14)},Hints:{DesignQuery:e,Trigger:"DesignFromScratch",DisableMotionSuggestions:"true",image2HeadingsForDFS:"true"},Scenario:s};var h;if(null==r?void 0:r.length){if("string"==typeof r[0]){const e=yield Promise.all(r.map((e=>{return t=e,Bn(void 0,void 0,void 0,(function*(){try{const e=yield fetch(t),i=yield e.blob(),r=Fn.get(i.type)||"jpg";let s=n;if(!s){const e=new URL(t).pathname.split("/").pop();s=(null==e?void 0:e.slice(0,e.lastIndexOf(".")))||(0,on.A)()}return new File([i],s+"."+r,{type:i.type})}catch(e){throw new Error(`Failed to fetch image: ${e.message}`)}}));var t,n})));return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},d),{ImageFiles:e}),u)}return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},d),{ImageBuffers:r}),u)}return yield this.m_suggestionClient.getSuggestions(d,u)}))}initialize(e){return kn(this,void 0,void 0,(function*(){const t=Date.now();this.m_authMessageHandler.initialize(),this.m_dcHintMessageHandler.initialize();const n=new Promise(((n,i)=>{this.m_appMessageHandler.on("ready",(()=>{try{this.m_appMessageHandler.send("initialize",{designerEnvironment:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),telemetryConfig:this.m_settings.telemetryConfig,packageVersion:"0.23.9",appStartTimestamp:t,config:{insertMode:this.m_settings.insertMode,useDoneCta:this.m_settings.ctaButtonLabel===Ln.Done,hideSizeSelector:this.m_settings.hideSizeSelector,preferredImageOutputFormat:this.m_settings.preferredImageOutputFormat,disableOptionalConnectedExperiences:this.m_settings.disableOptionalConnectedExperiences,hostCanProvideAuthToken:!!this.m_settings.hostTokenProvider,hostAuthConfig:this.m_settings.hostTokenProvider?{hostAccountInfo:this.m_settings.hostTokenProvider.accountInfo,hostIdentityType:this.m_settings.hostTokenProvider.identityType,hostCanProvideAuthToken:!0,isEUDBUser:this.m_settings.hostTokenProvider.isEUDBUser}:void 0,useEnterpriseTOULink:this.m_settings.useEnterpriseTOULink,isSovereignUser:this.m_settings.isSovereignUser,hideGenImageEntryPoint:this.m_settings.hideGenImageEntryPoint},suggestionsConfig:e,viewConfig:this.m_settings.viewConfig,fileCacheInfo:this.m_hostSessionStorage.getFileCacheInfo()}),this.m_appMessageHandler.off("ready"),n()}catch(e){i(e)}})),this.m_iframe.onerror=e=>{i(new Error(`Error loading iframe: ${e}`))}}));this.m_settings.container.appendChild(this.m_iframe),this.m_iframe.contentWindow&&this.m_appMessageHandler.setTarget(this.m_iframe.contentWindow),yield n}))}update(e){this.m_appMessageHandler.send("update",e)}updateAfterSignIn(){this.m_appMessageHandler.send("update_after_sign_in")}destroy(){this.m_appMessageHandler.destroy(),this.m_authMessageHandler.destroy(),this.m_dcHintMessageHandler.destroy(),this.m_iframe.remove(),this.m_hostWindow=void 0,this.m_settings=void 0}on(e,t){this.m_appMessageHandler.on(e,t)}off(e){this.m_appMessageHandler.off(e)}toggleInsertMode(e){this.m_appMessageHandler.send("insert_mode",e)}switchDesignerMiniAppTheme(e){this.m_appMessageHandler.send("switch_theme",e)}enableRedirectAuth(e){this.m_appMessageHandler.send("enable_redirect_auth",e)}createAppFrame(){var e,t,n;const i=new URL(this.m_settings.miniURL.toString());i.searchParams.append("view",null===(e=this.m_settings.viewConfig)||void 0===e?void 0:e.view),i.searchParams.append("theme",null!==(n=null===(t=this.m_settings.viewConfig)||void 0===t?void 0:t.theme)&&void 0!==n?n:"auto"),i.searchParams.append("sessionId",this.m_settings.telemetryConfig.sessionId),i.searchParams.append("clientId",this.m_settings.telemetryConfig.clientId),i.searchParams.append("clientName",this.m_settings.telemetryConfig.clientName),i.searchParams.append("iframeid",this.iframeid),this.m_settings.lng&&i.searchParams.append("lng",this.m_settings.lng),this.m_settings.loginHint&&i.searchParams.append("loginHint",this.m_settings.loginHint);const r=this.m_hostWindow.document.createElement("iframe");return r.allow="clipboard-write",r.width="100%",r.height="100%",r.style.border="none",r.name="Microsoft Designer",r.src=i.toString(),this.m_settings.enableSandboxing&&r.sandbox.add("allow-scripts","allow-same-origin","allow-downloads","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation"),this.m_settings.disableEmbeddedCSPEnforcement||r.setAttribute("csp","object-src 'none'; base-uri 'none'; require-trusted-types-for 'script'; trusted-types default; "),r}getDesignerEnvironment(e){return jt.getDasRing(e)}}const{parseSuggestionsResponse:jn}=Zt;var qn=n(8520),zn=(0,n(68383).Ex)("officeaicopilot-designer.DesignerStrings.DesignerPreviewLabel"),Gn=n(10020);function Wn(e,t){var n=Array.from(e),i=new Blob([new Uint8Array(n)],{type:t||"image/png"}),r=new FileReader;return r.readAsDataURL(i),new Promise((function(e,t){r.onload=function(){var t=r.result;e(t)},r.onerror=function(){t(r.error)}}))}var $n=n(42850),Jn=n(58651),Vn=(0,n(98226).l8)({lightThemeWithChatCard:{backgroundColor:"#FFFFFF"},darkThemeWithChatCard:{backgroundColor:"#292929"}}),Qn=n(58651),Kn={designerPreviewAriaLabel:zn},Yn=function(e){var t,n,i=qn.useMemo((function(){return(0,on.A)()}),[]),o=qn.useRef(),a=qn.useRef(!1),l=(0,s.kQ)(Kn);Qn.log("Designer Log: historyEventData sent to Designer",e.historyEventData);var c=function(e){var t,n=e.clientSettings,i=e.hostTokenProvider,s=e.isAuthEnabled,o=e.isRehydration,a=e.turnId,l=e.hostCallback,c=e.fileCacheInfo,u=e.isPlugAndPlay,d=e.historyEventData,h=(0,$n.eR)(null===(t=e.clientSettings)||void 0===t?void 0:t.selectedDesignerEnv,s),p=(0,$n.iK)(null==n?void 0:n.selectedDesignerEnv,null==i?void 0:i.isEUDBUser),g=(null==n?void 0:n.clientId)||(0,on.A)(),f=(null==n?void 0:n.sessionId)||(0,on.A)(),m=(null==n?void 0:n.correlationId)||(0,on.A)(),y=null==n?void 0:n.hostAppName,E=(null==n?void 0:n.scenarioName)||"Other",v=null==n?void 0:n.platformType,T=null==n?void 0:n.hostBuildVersion,S="".concat(y,"-").concat(v),C=null==n?void 0:n.audienceGroup;Jn.log("Designer Log: is Plug and Play enabled: ",u);var R=e.parentContainerIdentifier,b=qn.useMemo((function(){var t,r,s,o,a,d,E,v;return{miniURL:h,serviceBaseURL:p,viewConfig:{view:Mn.Chat,theme:null!==(t=null==n?void 0:n.designerTheme)&&void 0!==t?t:xn.Light,showFeedbackSection:null!==(r=null==n?void 0:n.showFeedBackSection)&&void 0!==r&&r,tempPlugNPlay:u},fileCacheInfoConfig:{hostCallback:null!=l?l:function(e){Jn.log("FileCacheInfo updated: ".concat(JSON.stringify(e)))},fileCacheInfo:c},telemetryConfig:{audienceGroup:null!=C?C:Gn.EW.Other,clientId:g,clientName:null!=y?y:"unknown",hostBuildVersion:null!=T?T:"unknown",hostEnvironment:S,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:f,correlationId:m,platform:(v=null!==(s=null==n?void 0:n.platformType)&&void 0!==s?s:Gn.lt.Web,v===Gn.lt.iOS?{platform:"iOS"}:v===Gn.lt.Web?{platform:"Web"}:v===Gn.lt.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform,tenantId:null!==(o=null==i?void 0:i.accountInfo.tenantId)&&void 0!==o?o:""},container:document.getElementById(R),insertMode:!0,enableSandboxing:!0,ctaButtonLabel:null!==(a=e.preferredCtaButtonLabel)&&void 0!==a?a:Ln.Insert,hideSizeSelector:!0,preferredImageOutputFormat:null!==(d=e.preferredImageFormat)&&void 0!==d?d:"png",hostTokenProvider:i,lng:null!==(E=null==n?void 0:n.uiLanguage)&&void 0!==E?E:"en-US"}}),[h,p,null==n?void 0:n.designerTheme,null==n?void 0:n.platformType,null==n?void 0:n.uiLanguage,l,c,g,y,T,S,f,m,R,e.preferredCtaButtonLabel,e.preferredImageFormat,i]),w=qn.useCallback((function(e,t,n,i,s,l,c,u,h,p){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var g;return(0,r.__generator)(this,(function(f){switch(f.label){case 0:return[4,(g=new Hn((0,r.__assign)((0,r.__assign)({},b),{container:document.getElementById(e)}))).initialize((0,r.__assign)((0,r.__assign)({turnId:a,isRehydration:o,scenario:E,minCount:3,maxCount:4},null!=t?t:{}),{historyEventData:d}))];case 1:return f.sent(),n&&g.on("done",n),i&&g.on("customize",i),l&&g.on("feedback",l),s&&g.on("AnswerCardResize",s),c&&g.on("persist_results",c),u&&g.on("error",u),h&&g.on("telemetry",h),p&&g.on("keyboardEvent",p),[2,g]}}))}))}),[b,d,o,E,a]);return{designerMiniSettings:b,initializeDesignerMini:w}}({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:i,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo,isPlugAndPlay:e.isPlugAndPlay,historyEventData:e.historyEventData}),u=c.initializeDesignerMini,d=c.designerMiniSettings;Qn.log("Designer Log: Designer Mini initialized with settings: ",d);var h=qn.useCallback((function(t){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var n,i,s,o,a;return(0,r.__generator)(this,(function(l){switch(l.label){case 0:return(null===(i=t.options)||void 0===i?void 0:i.isUrl)&&t.uri?(null===(s=e.insertImagesInCanvas)||void 0===s||s.call(e,t.uri,(0,r.__assign)((0,r.__assign)({},t.options),{altText:t.altText,sourceUrl:t.uri}),t.correlationId,t.imageType),[3,3]):[3,1];case 1:return[4,Wn(t.media,t.mimeType)];case 2:n=l.sent(),null===(o=e.insertImagesInCanvas)||void 0===o||o.call(e,n,(0,r.__assign)((0,r.__assign)({},t.options),{altText:t.altText,sourceUrl:(null===(a=t.options)||void 0===a?void 0:a.isUrl)?t.uri:void 0}),t.correlationId,t.imageType),l.label=3;case 3:return[2]}}))}))}),[e]),p=qn.useCallback((function(e){var t=document.getElementById(i);t&&(t.style.height="".concat(e.height,"px"))}),[i]),g=qn.useCallback((function(t){var n;null===(n=null==e?void 0:e.onDesignerCustomize)||void 0===n||n.call(e,t,d)}),[d,e]),f=qn.useCallback((function(t){!function(e,t,n,i){e===Nn.Like?i?null==t||t(i):null==t||t():e===Nn.Dislike&&(i?null==n||n(i):null==n||n())}(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),m=qn.useCallback((function(t){var n;Qn.log("Designer Log: data received after image generation",t),null===(n=null==e?void 0:e.persistentChatHistoryCallback)||void 0===n||n.call(e,t)}),[e]),y=qn.useCallback((function(t){var n;null===(n=null==e?void 0:e.handleDesignerError)||void 0===n||n.call(e,t)}),[e]),E=qn.useCallback((function(t){var n;null===(n=null==e?void 0:e.handleDesignerTelemetry)||void 0===n||n.call(e,t)}),[e]),v=qn.useCallback((function(e){var t;if("Escape"===e.key){var n=null===(t=document.getElementById(i))||void 0===t?void 0:t.closest("."+Gn.lc.CopilotMessage),r=document.getElementsByClassName(Gn.lc.UserMessage)[0];null==r||r.focus({preventScroll:!0}),null==n||n.focus()}}),[e]),T=qn.useMemo((function(){var t,n={imageType:e.imageType};return e.isStockQuery?(0,r.__assign)((0,r.__assign)({},n),{stockContent:e.stockImages,artifactType:Gn.FR.DesignSuggestions,companyName:e.companyName}):"banner"===(null===(t=e.imageType)||void 0===t?void 0:t.toLowerCase())?(0,r.__assign)((0,r.__assign)({},n),{dimensions:e.dimensions,text:e.userInput.trim(),artifactType:Gn.FR.DesignSuggestions}):(0,r.__assign)((0,r.__assign)({},n),{text:e.userInput.trim(),artifactType:Gn.FR.DallEImages})}),[e.companyName,e.dimensions,e.imageType,e.isStockQuery,e.stockImages,e.userInput]);return qn.useEffect((function(){a.current?Qn.log("Designer Log: Designer Mini already initialized, skipping initializeDesignerMini. doneInitializing: ".concat(null!==o.current)):(a.current=!0,Qn.log("Designer Log: Calling initializeDesignerMini"),u(i,T,h,g,p,f,m,y,E,v).then((function(e){o.current=e})).catch((function(e){a.current=!1,Qn.error(e)})))}),[T,u,p,g,h,f,i,m,y,E,v]),qn.useEffect((function(){var t;(null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme)&&o.current&&o.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme]),qn.createElement(qn.Fragment,null,qn.createElement("div",{id:i,key:i,className:"".concat((null===(n=e.clientSettings)||void 0===n?void 0:n.designerTheme)===xn.Dark?Vn.darkThemeWithChatCard:Vn.lightThemeWithChatCard),tabIndex:-1,"aria-label":l.designerPreviewAriaLabel()}))}}}]);
//# sourceMappingURL=vendors~lazyloadeddesigner.js.map