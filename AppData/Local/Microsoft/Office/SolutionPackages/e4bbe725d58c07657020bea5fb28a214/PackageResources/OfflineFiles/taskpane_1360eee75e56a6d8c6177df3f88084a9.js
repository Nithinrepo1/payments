/*! For license information please see taskpane.js.LICENSE.txt */
var TypeScriptModule;(()=>{var e,t,n,r,o,i={81933:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var r=function(){return"Get Agents"}},7271:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var r=n(8520),o=function(){return r.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),r.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),r.createElement("defs",null,r.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},r.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),r.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),r.createElement("stop",{offset:"1",stopColor:"#0736C4"})),r.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},r.createElement("stop",{stopColor:"#FFB657"}),r.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),r.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),r.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),r.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),r.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),r.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),r.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#3DCBFF"}),r.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),r.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},r.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),r.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),r.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),r.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),r.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))}},78483:(e,t,n)=>{"use strict";var r;n.d(t,{Y:()=>r}),function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(r||(r={}))},73998:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var r=n(8520),o=function(){return r.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),r.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),r.createElement("defs",null,r.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},r.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),r.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),r.createElement("stop",{offset:"1",stopColor:"#0736C4"})),r.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},r.createElement("stop",{stopColor:"#FFB657"}),r.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),r.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),r.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),r.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),r.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),r.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),r.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#3DCBFF"}),r.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),r.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},r.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),r.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),r.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),r.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),r.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))}},30968:(e,t,n)=>{"use strict";n.d(t,{QA:()=>a.Q,T$:()=>o.T,Yj:()=>i.Y,eU:()=>r.e});var r=n(7271),o=n(73998),i=n(78483),a=n(81933)},66524:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var r=n(75119),o=n(23905);function i(e,t,n,i){var a;void 0===i&&(i=!1);var s=function(e){return 0===(e||[]).length?0:e.filter((function(e){return!!e.adaptiveCardJson})).length}(e);return s>0?((0,r.cY)("Getting apiPluginProp for ApiPluginCard here.."),a={attributions:e,clientInfo:t,hideSingleCitation:n},i&&(0,o.ys)(s)):(0,r.cY)("No data(adaptiveCardJson) found for ApiPluginCard."),a}},50294:(e,t,n)=>{"use strict";n.d(t,{k:()=>r.k});var r=n(66524)},17425:(e,t,n)=>{"use strict";n.d(t,{Ss:()=>s,ky:()=>i,mr:()=>a,w8:()=>o,xk:()=>r});var r="d2eb9fef-f34c-40ec-b6a3-4bf524065158",o={loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",sharepoint:"https://microsoft-my.sharepoint-df.com",onenote:"https://onenote.com",substrate:"https://substrate.office.com/search"},i="6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",a="https://login.microsoftonline.com/common",s="https://titles.prod.mos.microsoft.com"},48526:(e,t,n)=>{"use strict";n.d(t,{v:()=>l});var r=n(17425),o=n(32197),i=n(75119),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},l=function(e,t){return a(void 0,void 0,void 0,(function(){var n,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:r.w8.graph)];case 1:return n=s.sent(),[2,(0,o.t)(n)];case 2:throw a=s.sent(),(0,i.cY)("Error fetching Graph token:",a),a;case 3:return[2]}}))}))}},96931:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var r=n(75119),o=n(17425),i=n(32197),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},l=function(e,t){return a(void 0,void 0,void 0,(function(){var n,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.loki)];case 1:return n=s.sent(),[2,(0,i.t)(n)];case 2:throw a=s.sent(),(0,r.cY)("Error fetching Loki token:",a),a;case 3:return[2]}}))}))}},72102:(e,t,n)=>{"use strict";n.d(t,{V:()=>l});var r=n(75119),o=n(17425),i=n(32197),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},l=function(e){return a(void 0,void 0,void 0,(function(){var t,n;return s(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,e.getToken(o.w8.onenote)];case 1:return t=a.sent(),[2,(0,i.t)(t)];case 2:throw n=a.sent(),(0,r.cY)("Error fetching OneNote token:",n),n;case 3:return[2]}}))}))}},89881:(e,t,n)=>{"use strict";n.d(t,{O:()=>l});var r=n(75119),o=n(17425),i=n(32197),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},l=function(e,t){return a(void 0,void 0,void 0,(function(){var n,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.sharepoint)];case 1:return n=s.sent(),[2,(0,i.t)(n)];case 2:throw a=s.sent(),(0,r.cY)("Error fetching SharePoint token:",a),a;case 3:return[2]}}))}))}},87295:(e,t,n)=>{"use strict";n.d(t,{s:()=>l});var r=n(75119),o=n(17425),i=n(32197),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},l=function(e,t){return a(void 0,void 0,void 0,(function(){var n,a;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.substrate)];case 1:return n=s.sent(),[2,(0,i.t)(n)];case 2:throw a=s.sent(),(0,r.cY)("Error fetching Substrate token:",a),a;case 3:return[2]}}))}))}},32197:(e,t,n)=>{"use strict";n.d(t,{t:()=>r});var r=function(e){var t,n;return{accessToken:e.accessToken,expirationTime:null!==(n=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0}}},6220:(e,t,n)=>{"use strict";n.d(t,{Oz:()=>o.O,Ss:()=>l.Ss,VE:()=>a.V,Wu:()=>i.W,sJ:()=>s.s,v5:()=>r.v,xk:()=>l.xk});var r=n(48526),o=n(89881),i=n(96931),a=n(72102),s=n(87295),l=n(17425)},55657:(e,t,n)=>{"use strict";n.d(t,{Uk:()=>b,aW:()=>v,ro:()=>S});var r=n(22606),o=n(81707),i=n(10229),a=n(93176),s=n(24643),l=n(83437),c=n(60606),u=n(23905),d=n(41273),p=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},h=!1,g=function(){return h},m=function(e){(0,c.cY)("setting ClpOfficeJSApiError to ".concat(e)),h=e},y=!1;function v(){return p(this,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:return c.t6.IsClpEnabledInEnterpriseForSydney()?(y=!0,[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]):[3,3];case 1:return e=t.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([o.n.getInstance().getInDocSensitiveLabelInfo(),e])];case 2:if(t.sent(),g())return m(!1),y=!1,[2,!1];t.label=3;case 3:return y=!1,[2,!0]}}))}))}var S="2147205115";function C(e,t){var n,r={chatEventType:l.a5.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:l.T_.Client,ashaErrorDetails:{vetoName:(0,u.CI)(l.kD.UnclearIntent,l.G8.UserInputIssue),errorString:l.av.SensitivityExecutionFailed,featureName:l.CC.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(function(e,t,n,r,l){void 0===l&&(l=!0);var d={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:i.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:r?(0,u.YI)(r):void 0},p=!0,f=o.n.getInstance();(null==f?void 0:f.getShouldStopLoadingUi)&&(p=f.getShouldStopLoadingUi());var h={chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:d,stopLoadingUi:p,startAugloopTimerForStreaming:!1,addCardToChatHistory:l};return(0,u.IT)(t,n,!0),(0,c.cY)("CLP error response message: ".concat(h)),h}(t,!0,r))}function b(e,t,n,i){var a,s,p;if(null===(p=null==e?void 0:e.current)||void 0===p?void 0:p.getIsExecuting()){var f=function(e,t){switch(e){case d.YY.ApplyLabelUnsupportedCrossTenantErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.Sh)();case d.YY.ApplyLabelDocumentReadOnlyErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.w3)();case d.YY.ApplyLabelInsufficientPermissionErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.bX)();case d.YY.ApplyLabelLabelDisabledErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.pS)();case d.YY.ApplyLabelUnsupportedUdpErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.hf)();case d.YY.ApplyLabelLabelingDisabledErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.f4)();case d.YY.ApplyLabelUnsupportedContentTypeErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.TZ)();case d.YY.ApplyLabelUnsupportedDkeErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.O1)();case d.YY.ApplyLabelLabelNotFoundErrorCode:case d.YY.ErrorCode2147647531:return t===d.OZ.CLP_Get?r.u1:(0,r.aE)();case d.YY.OsfControlContainerErrorCode:case d.YY.OfficeSolutionFrameworkHostErrorCode:case d.YY.DocCookieErrorCode:case d.YY.HostIntegrationManagerErrorCode:case d.YY.MsoOLDocumentErrorCode:case d.YY.ClpSessionErrorCode:return(0,r.VQ)();case d.YY.OMWorkflowUserNotFoundErrorCode:return(0,r.W2)();case d.YY.OMOfficePerpetualNotSupportedErrorCode:return(0,r.MH)();case d.YY.LabelingDisabledProtectedViewErrorCode:return(0,r.s_)();case d.YY.LabelingDisabledAppguardErrorCode:return(0,r.Ng)();case d.YY.LabelingDisabledPrivacySettingsErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.KA)();case d.YY.LabelingDisabledUnsupportedLabelClientErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.H9)();case d.YY.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.oM)();case d.YY.OMOfficeClientNotLicensedForLabelingErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.Td)();case d.YY.PolicyManagerUnavailableErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.VQ)();case d.YY.ApplyLabelNewLabelSensitivityOrderErrorCode:return r.u1;case d.YY.ErrorCode2147500033:default:return t===d.OZ.CLP_Get?r.u1:(0,r.VQ)()}}(t,n);if(f){y&&m(!0),(0,c.cY)("clp error: ".concat(f)),C(e,f);var h=!0,g=o.n.getInstance();(null==g?void 0:g.getShouldStopLoadingUi)&&(h=g.getShouldStopLoadingUi()),i&&h&&i(),c.EG.sendChatEventTelemetry((0,u.pN)(((a={})[l.h3.ChatEventType]=l.a5.CLPErrorShown,a[l.h3.ChatEventParameters]=n+"_"+t,a)))}else(0,c.cY)("clp error string is empty"),c.EG.sendChatEventTelemetry((0,u.pN)(((s={})[l.h3.ChatEventType]=l.a5.CLPErrorIgnored,s[l.h3.ChatEventParameters]=n+"_"+t,s)));return f}return r.u1}},16510:(e,t,n)=>{"use strict";var r,o;n.d(t,{T:()=>r,q:()=>o}),function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(r||(r={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(o||(o={}))},81707:(e,t,n)=>{"use strict";n.d(t,{n:()=>y});var r=n(22606),o=n(16510),i=n(48544),a=n(60606),s=n(38753),l=n(23905),c=n(98483),u=n(55657),d=n(41273),p=function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},h=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},g=null,m=(0,c.A)(),y=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:r.u1,tenantId:r.u1},this.externalDocLabelInfo={labelId:r.u1,tenantId:r.u1},this.inDocLabelInfo.labelId=r.u1,this.inDocLabelInfo.tenantId=r.u1,this.externalDocLabelInfo.labelId=r.u1,this.externalDocLabelInfo.tenantId=r.u1}return e.getInstance=function(t,n,r,o){return(0,s.hX)(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),(0,s.hX)(t)||(e.clpSensitivityHandler.setBasicChatProps=t),(0,s.hX)(n)||(e.clpSensitivityHandler.copilotChatRef=n),(0,s.hX)(r)||(e.clpSensitivityHandler.removeCurrentContextId=r),(0,s.hX)(o)||(e.clpSensitivityHandler.getShouldStopLoadingUi=o),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return f(this,void 0,void 0,(function(){var e,t;return h(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 1:return e=n.sent(),this.setInDocSensitivityLabelInfo(e),(0,l.Zy)("setInDocSensitiveLabelInfoUsingOfcJs"),[3,3];case 2:return t=n.sent(),(0,l.mQ)("error in getLabel Api: ".concat(t.message),t.code),(0,u.Uk)(this.copilotChatRef,t.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,a.cY)("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,3];case 3:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return f(this,void 0,void 0,(function(){var e,t;return h(this,(function(n){switch(n.label){case 0:(0,a.cY)("Getting label"),e={labelId:r.u1,tenantId:r.u1},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=n.sent(),(0,l.Zy)("getLabel"),[3,4];case 3:return t=n.sent(),(0,l.mQ)("error in getLabel Api : ".concat(t.message),t.code),(0,u.Uk)(this.copilotChatRef,t.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,a.cY)("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return(0,a.cY)("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;(0,a.cY)("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var r,a;return p(p({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(r=e.description)&&void 0!==r?r:"",badgeText:null!==(a=e.displayName)&&void 0!==a?a:"",iconType:e.encryptionType!==o.T.None?i.JF.Encryption:i.JF.NonEncryption}:void 0})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return f(this,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:r.u1}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):((0,a.cY)("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?((0,a.cY)("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){var t;return f(this,void 0,void 0,(function(){var n,i,s,c,p,y,v=this;return h(this,(function(S){switch(S.label){case 0:(0,l.Zy)("tryUpgradeLabel"),(0,a.cY)("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=o.q[o.q.S_APPLYLABEL_OK],i=r.u1,S.label=1;case 1:return S.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,m)];case 2:return S.sent(),[2,{status:o.q[o.q.S_APPLYLABEL_OK]}];case 3:return s=function(){return f(v,void 0,void 0,(function(){return h(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,m)]}catch(e){(0,l.mQ)("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code),i=(0,u.Uk)(this.copilotChatRef,e.code,d.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,a.cY)("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},c=new Promise((function(e){g=e})),p=new Promise((function(e,t){var n=r.qO;setTimeout((function(){return t(new Error("CallbackTimeout"))}),n)})),[4,Promise.race([Promise.all([c,s()]),p])];case 4:S.sent(),S.label=5;case 5:return[3,7];case 6:return y=S.sent(),(0,l.mQ)("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(y.message),y.code),(0,u.Uk)(this.copilotChatRef,y.code,d.OZ.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===y.message?(0,a.cY)("Callback Timeout"):(0,a.cY)("Exception while upgrading sensitivity label: ".concat(y.message,", error code: ").concat(y.code)),n=null!==(t=o.q[y.message])&&void 0!==t?t:y.message,[3,7];case 7:return g=null,[2,{status:n,errorMessage:i}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:v),(0,l.Zy)("Label Change Event Listener"),(0,a.cY)("Sensitivity Label Change Event Listener Set")}catch(e){(0,l.mQ)("error in setting listener for CLP : ".concat(e.message),e.code),(0,u.Uk)(this.copilotChatRef,e.code,d.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,a.cY)("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return f(this,void 0,void 0,(function(){var t,n;return h(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 1:return t=r.sent(),(0,a.cY)("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),(0,l.Zy)("External Doc HighestSensitivityLabel"),[3,3];case 2:return n=r.sent(),(0,l.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),(0,u.Uk)(this.copilotChatRef,n.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,a.cY)("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,3];case 3:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return f(this,void 0,void 0,(function(){return h(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return f(this,void 0,void 0,(function(){var t,n;return h(this,(function(o){switch(o.label){case 0:t={labelId:r.u1,tenantId:r.u1},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=o.sent(),(0,a.cY)("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),(0,l.Zy)("HighestSensitivityLabel"),[3,4];case 3:return n=o.sent(),(0,l.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),(0,u.Uk)(this.copilotChatRef,n.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,a.cY)("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return f(this,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.T.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){(0,a.cY)("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return(0,l.Zy)("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===r.u1)),this.externalDocLabelInfo.labelId!==r.u1&&a.t6.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return(0,l.Zy)("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===r.u1)),this.inDocLabelInfo.labelId!==r.u1&&a.t6.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.T.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.T.None},e}();function v(e,t,n,r){return f(this,void 0,void 0,(function(){return h(this,(function(i){switch(i.label){case 0:return(0,a.cY)("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(r)),(0,l.Zy)("Label change callback received, context:  ".concat(n)),g&&n===m&&(g("ignore"),g=null),r!==o.q.S_APPLYLABEL_OK?((0,l.mQ)("error in upgrading label : ".concat(r),r.code),[2]):a.t6.IsClpEnabledInEnterpriseForSydney()&&(y.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,y.getInstance().setSensitivityLabelToHighestSensitivity([y.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return i.sent(),[2];case 2:return a.t6.IsApplyLabelUsingTryUpgradeLabelEnabled(),y.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}},56933:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>p,Yw:()=>d});var r=n(22606),o=n(81707),i=n(16510),a=n(83437),s=n(60606),l=n(23905),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function d(){!1}var p=function(e,t){return c(void 0,void 0,void 0,(function(){var n,c,d,p,f,h,g,m,y,v,S,C;return u(this,(function(u){switch(u.label){case 0:return n=o.n.getInstance().getInDocSensitiveLabelInfo(),s.t6.IsClpEnabledInEnterpriseForSydney()?[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return c=u.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([o.n.getInstance().getInDocSensitiveLabelInfo(),c])];case 2:(n=u.sent()).isDke=c.isDke,n.hasExtractForUser=c.hasExtractForUser,u.label=3;case 3:return d={id:n.labelId,displayName:null!==(S=n.displayName)&&void 0!==S?S:"",tooltip:n.description,color:n.color,isEncrypted:n.encryptionType!==i.T.None,priority:null!==(C=n.order)&&void 0!==C?C:0},m={documentSensitivity:d},null==t?[3,4]:(f=t,[3,6]);case 4:return[4,s.t6.getOfficeJSDocumentURL()];case 5:f=u.sent(),u.label=6;case 6:return m.documentURL=f,m.hasExtract=n.labelId===r.u1||n.hasExtractForUser,m.isDKE=n.labelId!==r.u1&&n.isDke,p=m,(h={copilotConfig:e(),documentConfig:p}).copilotConfig&&s.EG.sendChatEventTelemetry((0,l.pN)(((y={})[a.h3.ChatEventType]=a.a5.CopilotConfig,y[a.h3.ChatEventParameters]=JSON.stringify(h.copilotConfig),y))),g=void 0===p.hasExtract&&void 0===p.isDKE,s.EG.sendChatEventTelemetry((0,l.pN)(((v={})[a.h3.ChatEventType]=a.a5.IsDocumentProtected,v[a.h3.ChatEventParameters]=!!g||!(!p.hasExtract||p.isDKE),v))),[2,h]}}))}))}},42567:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>o.Eb,Tz:()=>r.T,Yw:()=>o.Yw,aW:()=>i.aW,n6:()=>a.n,qH:()=>r.q,ro:()=>i.ro});var r=n(16510),o=n(56933),i=n(55657),a=n(81707)},2965:(e,t,n)=>{"use strict";n.d(t,{c:()=>r,v:()=>o});var r=function(e){var t,n=null===(t=null==e?void 0:e.adaptiveCards)||void 0===t?void 0:t[0];return n?{body:n}:null},o=function(e){return"bot"===e.author&&"ConfirmationCard"===e.messageType}},63958:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var r,o=n(8520),i=n(26818),a=n(75119),s=n(52297),l=n(23905),c=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};const p=function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return u(n,void 0,void 0,(function(){var e,t,n,r,o,i,s,l;return d(this,(function(c){switch(c.label){case 0:e=null!==(i=null===(o=this.state.error)||void 0===o?void 0:o.message)&&void 0!==i?i:"No error message",t=null!==(l=null===(s=this.state.error)||void 0===s?void 0:s.stack)&&void 0!==l?l:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return c.sent(),[3,4];case 3:return r=c.sent(),(0,a.cY)("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",r),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}return c(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){(0,a.cY)("ErrorBoundary caught an error ",e),(0,a.sZ)(),this.props.errorLogOverride?this.props.errorLogOverride(e):(0,l.Wx)(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?o.createElement(s.L,{theme:this.props.copilotChatTheme,shouldUseFluentV9Tokens:!0},o.createElement(i.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children},t}(o.Component)},25842:(e,t,n)=>{"use strict";n.d(t,{t:()=>r.A});var r=n(63958)},525:(e,t,n)=>{"use strict";n.d(t,{Q:()=>d});var r=n(52033),o=n(4260),i=n(38151),a=n(83781),s=n(98483),l=n(70825),c=n(65167),u=n(60197),d=function(){function e(e){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set;var t=this.getDocumentHandoffMessageId();t&&this.pendingHandoffMessageIds.add(t)}return e.prototype.getDocumentHandoffMessageId=function(){var e=a.kH.getSettingAsString(a.zj.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,s.A)(),i=this.getHandoffMessageIdSignal(n,t,e),a=new l.g0({parentPath:["Signal",r.uC.getTypeName()],items:[{id:c.r.generateId(),body:i}]});e===o.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(i.H_.T_,{operation:a,workflowAnnotationType:r.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(i)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.handleHandoffMessage=function(e,t){try{if(!(null==e?void 0:e.body)||!r.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var n=e.body;if(this.HandoffOperations.onAnnotationReceived(r.uC.getTypeName(),n,this.handoffMessageIdRequestSubmitTime,t),n.scenarioName===i.Cu.INAPP)return void this.processHandoffMessage(n);if(!this.isHandoffMessageIdSignalTracked(n.queryId))return;if(n.error){if(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+n.error),n.error.includes("Unable to download content. The specified blob does not exist")||n.error.includes("Unable to download content. Request failed with status code 500"))return;return void this.HandoffOperations.onError(u.Fc.HandoffMessageResponse,u.I5)}var a=this.getHandoffMessageIdFromSignal(n.queryId);return this.sendHandoffMessageId(o.Q.PROCESSED,a),this.completeTrackedHandoffMessageIdSignal(n.queryId),this.processHandoffMessage(n),a}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)},e}()},44120:(e,t,n)=>{"use strict";var r=n(52033),o=n(70825),i=n(65167),a=n(60197),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};!function(){function e(e){this.HandoffOperations=e}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e),n=new o.Xr({parentPath:["session","doc"],items:[{id:i.r.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:r.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return s(this,void 0,void 0,(function(){var n,o;return l(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,6,,7]),!r.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return n=e.body,this.HandoffOperations.onAnnotationReceived(r.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(a.Fc.OutboundMessageResponse,n.error),[3,5]):[3,1];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(a.Fc.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:return i.sent(),[3,5];case 4:this.HandoffOperations.onError(a.Fc.NoGeneratedLinks),i.label=5;case 5:return[3,7];case 6:throw o=i.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+o.message),o;case 7:return[2]}}))}))}}()},60197:(e,t,n)=>{"use strict";var r;n.d(t,{Fc:()=>r,I5:()=>o,xT:()=>i}),function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(r||(r={}));var o="I ran into a problem while completing your request. Please try again.",i="The query in handoff message is empty or undefined."},91392:(e,t,n)=>{"use strict";n.d(t,{Fc:()=>o.Fc,I5:()=>o.I5,Q6:()=>r.Q,xT:()=>o.xT});var r=n(525),o=(n(44120),n(60197))},24498:(e,t,n)=>{"use strict";n.d(t,{G4:()=>o.G,Qk:()=>r.Q,lq:()=>i.l});var r=n(15751),o=n(31257),i=n(13392);n(24181)},13392:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var r=n(75119),o=n(8520),i=n(91208),a=n(23905),s=n(83437),l=function(e){var t,n=e.clientInfoRef,l=e.theme,c=e.locale,u=e.clientId,d=e.redirectUri,p=e.isWebPlatform,f=o.useRef(void 0),h=function(){t&&t.close(),t=void 0},g=o.useCallback((function(e){f.current=e;var o=window.location.href.replace("taskpane.html","CloudFilePickerDialog.html"),g=l===i.G.defaultBlack,m=function(e){var o,i,l,m,y,v,S=JSON.parse(e);switch(S.type){case r.zg.Ack:var C={userPrincipalName:null!==(l=null===(i=n.current)||void 0===i?void 0:i.userPrincipalName)&&void 0!==l?l:"",clientId:u,redirectUri:d,locale:c,isDarkMode:g};r.EG.sendChatEventTelemetry((0,a.pN)(((o={})[s.h3.ChatEventType]=s.a5.CloudFilesDialogOpened,o))),t&&t.messageChild(JSON.stringify(C),{targetOrigin:"*"});break;case r.zg.CloseEvent:h(),p?setTimeout((function(){var e;null===(e=f.current)||void 0===e||e.closeCiqCallback()}),700):null===(m=f.current)||void 0===m||m.closeCiqCallback();break;case r.zg.OnItemSelected:h();var b=S.files;p?setTimeout((function(){var e;null===(e=f.current)||void 0===e||e.onItemSelected(b)}),700):null===(y=f.current)||void 0===y||y.onItemSelected(b);break;case r.zg.OnErrorInLoading:h(),p?setTimeout((function(){var e;null===(e=f.current)||void 0===e||e.onErrorInLoading()}),700):null===(v=f.current)||void 0===v||v.onErrorInLoading()}};p?Office.context.ui.displayDialogAsync(o,{displayInIframe:!0,hideTitle:!0,height:65,width:60},(function(e){null==(t=e.value)||t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){var t;m(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"")}))})):OfficeFirstPartyDialog.displayWebDialog(o,{displayInIframe:!0,dialogTitle:"",hideTitle:!0,height:65,width:60,onMessage:m,onClose:function(){var e;null===(e=f.current)||void 0===e||e.closeCiqCallback()}}).then((function(e){t=e}))}),[n,l,f]);return{onAttachCloudFiles:g}}},24181:(e,t,n)=>{"use strict";n(8520),n(73744)},15751:(e,t,n)=>{"use strict";n.d(t,{Q:()=>l});var r=n(68383),o=n(42658),i=n(8520),a=function(e){},s=(0,r.mL)(o.N,{currentLocale:void 0,strings:{},errorHandler:a,loaders:[],stringMapInitialized:!1});function l(e,t){void 0===t&&(t=a);var n=(0,i.useState)(s),o=n[0],l=n[1];return(0,i.useEffect)((function(){(0,r.Au)((0,r.U5)(e,"en-us"),o).then(l)}),[e]),(0,i.useEffect)((function(){l((0,r._c)(t,o))}),[t]),(0,r.zB)(o)}},2061:(e,t,n)=>{"use strict";n.d(t,{$dc:()=>p.$d,$nm:()=>o.$n,BDr:()=>m.B,BIF:()=>d.B,Bp2:()=>o.Bp,Csj:()=>o.Cs,DLk:()=>s.DL,DYx:()=>o.DY,Dl2:()=>i.D,Ebk:()=>r.Eb,FcJ:()=>h.Fc,FqH:()=>o.Fq,G41:()=>u.G4,GZA:()=>o.GZ,GmK:()=>o.Gm,Hrz:()=>o.Hr,I51:()=>h.I5,IdZ:()=>o.Id,JI8:()=>o.JI,KjQ:()=>o.Kj,M79:()=>p.M7,MCQ:()=>p.MC,Ne4:()=>o.Ne,NnE:()=>o.Nn,OzJ:()=>g.Oz,PrQ:()=>y.P,Q6w:()=>h.Q6,QAh:()=>f.QA,Qk5:()=>u.Qk,RBg:()=>p.RB,RkY:()=>o.Rk,Rs7:()=>o.Rs,Sdf:()=>o.Sd,Ssr:()=>g.Ss,T$y:()=>f.T$,TRs:()=>o.TR,TzT:()=>r.Tz,VEG:()=>g.VE,W$G:()=>o.W$,Wu7:()=>g.Wu,YPU:()=>o.YP,Yj6:()=>f.Yj,YwR:()=>r.Yw,Zl2:()=>o.Zl,_Qu:()=>p._Q,_pQ:()=>p._p,_sV:()=>o._s,aWC:()=>r.aW,b_z:()=>o.b_,cY_:()=>o.cY,cqx:()=>c.c,dDr:()=>o.dD,eU_:()=>f.eU,gIB:()=>o.gI,hUL:()=>o.hU,iBH:()=>o.iB,j92:()=>o.j9,jPo:()=>o.jP,jYE:()=>o.jY,jwY:()=>o.jw,kqr:()=>l.k,lqj:()=>u.lq,n6d:()=>r.n6,piD:()=>o.pi,qAn:()=>o.qA,qHn:()=>r.qH,quJ:()=>p.qu,roB:()=>r.ro,sJD:()=>g.sJ,tHk:()=>a.t,tO0:()=>s.tO,tpg:()=>p.tp,u1i:()=>o.u1,utd:()=>o.ut,v5s:()=>g.v5,v_Q:()=>o.v_,vfc:()=>c.v,vqz:()=>p.vq,wI1:()=>y.w,xRn:()=>d.x,xTN:()=>h.xT,xkN:()=>g.xk,y8L:()=>o.y8,zRu:()=>o.zR,zt4:()=>o.zt});var r=n(42567),o=(n(80858),n(75119)),i=n(95261),a=n(25842),s=n(31287),l=n(50294),c=n(2965),u=n(24498),d=n(47428),p=n(62610),f=n(30968),h=n(91392),g=n(6220),m=n(8531),y=n(30935)},80591:(e,t,n)=>{"use strict";n.d(t,{B:()=>l,x:()=>s});var r=n(93176),o=n(26940),i=new Set([o.n3.TriggerConfirmation,o.n3.TriggerPluginAuth]),a=function(e){return i.has(null==e?void 0:e.messageType)},s=function(e){var t,n=null!==(t=e.messages)&&void 0!==t?t:[],r=n[n.length-1];return a(r)?r.messageType:void 0},l=function(e,t,n){var o,i;void 0===n&&(n=!1);var s=null!==(o=e.messages)&&void 0!==o?o:[],l=s[s.length-1];return!(0===s.length||!a(l))&&(null===(i=t.current)||void 0===i||i.addResponseMessage({chatCardType:r._.InterstitialMessage,stopLoadingUi:!0,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:n?s:[l]}},chatMessageBodyData:{messageId:l.messageId},addCardToChatHistory:!1}),!0)}},47428:(e,t,n)=>{"use strict";n.d(t,{B:()=>r.B,x:()=>r.x});var r=n(80591)},79576:(e,t,n)=>{"use strict";n(8520),n(94329),n(75119),n(95132),n(54451)},62073:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(75119),o=n(23905);function i(e,t,n,i){var a;void 0===i&&(i=!1);var s=function(e){return 0===(e||[]).length?0:e.filter((function(e){return!!e.cardJson})).length}(e);return s>0?((0,r.cY)("Getting msgExtProp for MsgExtCard here.."),a={attributions:e,clientInfo:t,hideSingleCitation:n},i&&(0,o.d_)(s)):(0,r.cY)("No data(cardJson) found for MsgExtCard."),a}},95132:(e,t,n)=>{"use strict";var r=n(19588),o=n(47513),i=n(44479),a=n(8520),s=n(28849),l=n(59559),c=n(74355),u=n(99046),d=n(13201);a.memo((function(e){var t=e.dialogContent,n=e.appDefinition,p=e.userContext,f=e.hostContext,h=e.clientInfo,g=e.handleCloseButtonClick,m=e.shouldShowDismissIcon,y=e.copilotChatThemeV2,v=e.shouldDisplayInNewWindow,S=e.cardInfo,C=a.useMemo((function(){return l.E.getInstance()}),[]),b=a.useMemo((function(){return d.d.getInstance()}),[]),E=a.useMemo((function(){return c.G.getInstance()}),[]),T=a.useMemo((function(){return u.N.getInstance()}),[]),w=a.useMemo((function(){return new o.R}),[]);return a.createElement(r.q,{theme:y},a.createElement(i.K,{dialogContent:t,botService:E,appDefinition:n,tokenService:b,telemetryService:T,userContext:p,hostContext:f,appService:C,externalAuthService:w,clientInfo:h,isCardRenderingInTaskModuleEnabled:!0,handleCloseButtonClick:g,taskModuleLauncher:s.D.getInstance().launchTaskModule.bind(null,v),shouldShowDismissIcon:m,cardInfo:S,isDialogAcRendererEnabledForTaskModule:!0,createAndSendSignalsToSubstrate:!1}))}))},28849:(e,t,n)=>{"use strict";n.d(t,{D:()=>p});var r=n(35212),o=n(61699),i=n(75119),a=n(4804),s=n(23905),l=n(83437),c=function(){return c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},c.apply(this,arguments)},u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},p=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},(0,i.cY)("MsgExtDialogLauncher : Task Module dialog closed")},this.onMessageCallback=function(e){return u(t,void 0,void 0,(function(){var t,n,o,u,p,f,h,g,m,y;return d(this,(function(d){switch(d.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(e)).type!==r.o.Ack?[3,1]:(n=(0,a.jX)(this.taskModuleProps),u={dialogContent:this.taskModuleProps.dialogContent,appDefinition:this.taskModuleProps.appDefinition,clientInfo:this.taskModuleProps.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:n},this.openedDialog.dialog.messageChild(JSON.stringify(u),{targetOrigin:window.location.origin}),[3,6]):[2];case 1:return t.type!==r.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==r.o.onServiceRequest)return[3,6];null===(y=i.EG.setQueryGuid)||void 0===y||y.call(i.EG,t.requestId),(0,i.cY)("MsgExtDialogLauncher : Received service request from dialog",t),o={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},i.EG.sendChatEventTelemetry((0,s.pN)(((h={})[l.h3.ChatEventType]=l.a5.TaskModuleServiceRequest,h[l.h3.ChatEventParameters]=JSON.stringify(o),h))),u={requestId:t.requestId,messageType:r.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},d.label=3;case 3:return d.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(p=d.sent())&&(u.result=p),(0,i.cY)("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),i.EG.sendChatEventTelemetry((0,s.pN)(((g={})[l.h3.ChatEventType]=l.a5.TaskModuleServiceResponse,g[l.h3.ChatEventParameters]=JSON.stringify(o),g))),this.openedDialog.dialog.messageChild(JSON.stringify(u),{targetOrigin:window.location.origin}),[3,6];case 5:return f=d.sent(),(0,i.cY)("MsgExtDialogLauncher : Error executing plugin operation",f),i.EG.sendErrorTelemetry((0,s.pN)(((m={})[l.IC.ErrorMessage]=JSON.stringify(c(c({},o),{error:f})),m[l.IC.ErrorCategory]=l.S2.MsgExtTaskModule,m[l.IC.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),m))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return u(t,void 0,void 0,(function(){var t,r,o=this;return d(this,(function(i){switch(i.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=(0,a.jX)(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return r=(0,a.zC)(),[4,Office.context.ui.displayDialogAsync(r,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return u(o,void 0,void 0,(function(){var n=this;return d(this,(function(r){return this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:this.taskModuleProps.triggeringActionTitle},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return u(n,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return u(n,void 0,void 0,(function(){return d(this,(function(t){return e.error===a.Y7&&this.closeActiveDialog(),[2]}))}))})),[2]}))}))}))];case 1:return i.sent(),[2]}}))}))},this.openDialogForWebPlatformAsIframe=function(e,n){return u(t,void 0,void 0,(function(){var t,r=this;return d(this,(function(o){switch(o.label){case 0:return t=(0,a.zC)(),[4,Office.context.ui.displayDialogAsync(t,{displayInIframe:!0,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return u(r,void 0,void 0,(function(){var t=this;return d(this,(function(n){return this.openedDialog.dialog=e.value,this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return u(t,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),[2]}))}))}))];case 1:return o.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return u(t,void 0,void 0,(function(){var t,r,o,s=this;return d(this,(function(l){return this.shouldDisplayDismissIcon=!1,t=(0,a.zC)(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(o=null===(r=this.taskModuleProps)||void 0===r?void 0:r.dialogTitle)&&void 0!==o?o:i.$9,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){s.openedDialog.dialog=e})).catch((function(e){(0,i.cY)("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e,n){return u(t,void 0,void 0,(function(){var t,r,i,s,l,c;return d(this,(function(u){return this.taskModuleProps=n,t=null===(l=n.clientInfo)||void 0===l?void 0:l.clientType,r=e&&t===o.WK.web?(0,a.aT)(n):(0,a.rT)(n),i=r.dialogHeight,s=r.dialogWidth,(null===(c=n.clientInfo)||void 0===c?void 0:c.clientType)===o.WK.web?e?this.openDialogForWebPlatformAsNewWindow(i,s):this.openDialogForWebPlatformAsIframe(i,s):this.openDialogForNativePlatform(i,s),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e}()},4804:(e,t,n)=>{"use strict";n.d(t,{Y7:()=>c,aT:()=>s,jX:()=>a,rT:()=>l,zC:()=>i});var r=n(93176),o=n(75119),i=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},a=function(e){var t={appId:"",botId:"",cardId:""};try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){(0,o.cY)("msgExtension Utils: Failed to extract cardId from cardData")}return t},s=function(e){var t,n;if(e.viewMode===r.S.TaskViewMode){var o=null===(t=e.dialogContent)||void 0===t?void 0:t.height,i=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!o||!i||"number"!=typeof i||"number"!=typeof o)return{dialogHeight:55,dialogWidth:50};var a=screen.width,s=screen.height;return{dialogHeight:Math.floor(o/s*100),dialogWidth:Math.floor(i/a*100)}}return{dialogHeight:80,dialogWidth:80}},l=function(e){var t,n,i,a,s=e.viewMode,l=s===r.S.TaskViewMode?window.outerWidth:window.innerWidth,c=s===r.S.TaskViewMode?window.outerHeight:window.innerHeight,u=s===r.S.TaskViewMode?o.nG:0,d=s===r.S.TaskViewMode?o.ae:0,p=null===(t=e.dialogContent)||void 0===t?void 0:t.height,f=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof f&&"number"==typeof p&&f<=l&&p<=c){var h=Math.floor(p/c*100),g=Math.floor(f/l*100);i=h+u,a=g+d}else i=55,a=50}catch(e){i=55,a=50}return{dialogHeight:i,dialogWidth:a}},c=12006},31287:(e,t,n)=>{"use strict";n.d(t,{DL:()=>r.D,tO:()=>o.t});n(79576);var r=n(28849),o=n(62073)},59559:(e,t,n)=>{"use strict";n.d(t,{E:()=>c});var r=n(47809),o=n(54451),i=n(98483),a=n(87733),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},c=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return s(this,void 0,void 0,(function(){var t,n,s;return l(this,(function(l){switch(l.label){case 0:return t=(0,i.A)(),(0,o.d)(t,r.o.AppService,r.L.GetApp,{request:e}),n=new a.N,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return s=l.sent(),[2,JSON.parse(s)]}}))}))},e.prototype.getApps=function(){return s(this,void 0,void 0,(function(){var e,t,n;return l(this,(function(s){switch(s.label){case 0:return e=(0,i.A)(),(0,o.d)(e,r.o.AppService,r.L.GetApps),t=new a.N,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=s.sent(),[2,JSON.parse(n)]}}))}))},e}()},74355:(e,t,n)=>{"use strict";n.d(t,{G:()=>c});var r=n(47809),o=n(54451),i=n(98483),a=n(87733),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},c=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return s(this,void 0,void 0,(function(){var t,n,s;return l(this,(function(l){switch(l.label){case 0:return t=(0,i.A)(),(0,o.d)(t,r.o.ChannelService,r.L.BotInvoke,{request:e}),n=new a.N,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return s=l.sent(),[2,JSON.parse(s)]}}))}))},e}()},13201:(e,t,n)=>{"use strict";n.d(t,{d:()=>c});var r=n(47809),o=n(54451),i=n(98483),a=n(87733),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},c=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return s(this,void 0,void 0,(function(){var t,n,s;return l(this,(function(l){switch(l.label){case 0:return t=(0,i.A)(),(0,o.d)(t,r.o.AuthService,r.L.GetToken,{request:e}),n=new a.N,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return s=l.sent(),[2,JSON.parse(s)]}}))}))},e}()},87733:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var r=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}()},99046:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(47809),o=n(54451),i=n(98483),a=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,i.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,i.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,i.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,i.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,i.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,i.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogMetric,{request:e})},e}()},54451:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var r=n(35212),o=(n(75119),n(13201),n(74355),n(59559),function(e,t,n,o){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:r.o.onServiceRequest,serviceName:t,apiName:n,requestData:o}),{targetOrigin:window.location.origin})})},7545:(e,t,n)=>{"use strict";n.d(t,{k:()=>i,z:()=>r});var r,o=n(38753);!function(e){e.AugloopSharedSessionID="AugloopSharedSessionID",e.HandoffMessageId="HandoffMessageId"}(r||(r={}));var i=function(){function e(){}return e.getSettingAsString=function(e){var t=Office.context.document.settings.get(e.toString());return(0,o.hX)(t)?t:t.toString()},e}()},60032:(e,t,n)=>{"use strict";var r=n(8520),o=n(41273);n(52233),(0,r.createContext)({officePlatform:o.yx.web,officeTheme:void 0})},52233:(e,t,n)=>{"use strict";var r=n(75119),o=n(58651),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},a=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};!function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return i(t,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){o.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===r.yx.win32?this.handleDefaultThemeChange():this.platform===r.yx.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}}()},83781:(e,t,n)=>{"use strict";n.d(t,{kH:()=>r.k,zj:()=>r.z});var r=n(7545);n(60032)},27537:(e,t,n)=>{"use strict";n.d(t,{$:()=>l});var r=n(83437),o=n(23905),i=n(75119),a=n(22606),s=n(85088),l=function(e,t,n){var l,c,u;void 0===n&&(n=a.u1);var d,p=e.category,f=e.message,h=null!==(c=e.json)&&void 0!==c?c:a.u1,g=a.u1;try{(0,i.hX)(h)||(d=JSON.parse(h))}catch(e){(0,i.cY)("Exception occured during parsing of json Data for User profile annotation error : ".concat(e))}(0,i.cY)("UserProfile Annotation Error Detected, Category: ".concat(p,", ErrorMessage: ").concat(f,", JsonData: ").concat(h)),void 0!==d&&(g=d.code),i.EG.sendErrorTelemetry((0,o.pN)(((l={})[r.IC.ErrorMessage]="User Profile Annotation Error Detected, Category: ".concat(p,", ErrorCode: ").concat(g),l[r.IC.ErrorCategory]=r.S2.Personalization,l)));var m=r.wV.Unknown,y=r.G8.UnclassifiedError,v=(0,a.de)();switch(p){case i.$m.InvalidSignal:if(g===i.eB.MissingProfileId)m=r.wV.MissingProfileId,y=r.G8.LLMIssue;break;case i.$m.InvalidInput:switch(g){case i.eB.StaleProfileId:m=r.wV.StaleProfileId,y=r.G8.UserInputIssue;break;case i.eB.NotSupportedProfileOperation:m=r.wV.NotSupportedProfileOperation,y=r.G8.UnsupportedFunctionality;break;case i.eB.InvalidUserQuery:m=r.wV.InvalidUserQuery,y=r.G8.UserInputIssue}break;case i.$m.RoamingServiceError:switch(g){case i.eB.FailedToRead:m=r.wV.FailedToRead,y=r.G8.LLMIssue;break;case i.eB.FailedToWrite:m=r.wV.FailedToWrite,y=r.G8.LLMIssue;break;case i.eB.UninitializedUserStoreEntities:m=r.wV.UninitializedUserStoreEntities,y=r.G8.LLMIssue;break;case i.eB.UndefinedUserStoreEntities:m=r.wV.UndefinedUserStoreEntities,y=r.G8.LLMIssue}break;case i.$m.OpenAITextClientError:case i.$m.OpenAIChatClientError:switch(g){case i.eB.BadResponse:m=r.wV.BadResponse,y=r.G8.LLMIssue;break;case i.eB.Timeout:m=r.wV.Timeout,y=r.G8.TimedOut;break;case i.eB.Throttled:m=r.wV.Throttled,y=r.G8.CapacityIssue;break;case i.eB.UserThrottled:m=r.wV.UserThrottled,y=r.G8.CapacityIssue;break;case i.eB.ScenarioThrottled:m=r.wV.ScenarioThrottled,y=r.G8.CapacityIssue;break;case i.eB.Token:m=r.wV.Token,y=r.G8.UserAccessIssue;break;case i.eB.Unknown:m=r.wV.Unknown,y=r.G8.UnclassifiedError;break;case i.eB.NotAvailable:m=r.wV.NotAvailable,y=r.G8.LLMIssue;break;case i.eB.EmptyResponse:m=r.wV.EmptyResponse,y=r.G8.LLMIssue}break;case i.$m.SkillExecutionError:switch(g){case i.eB.Unknown:m=r.wV.SkillFailed,y=r.G8.LLMIssue;break;case i.eB.NotAvailable:m=r.wV.IncorrectServiceResponse,y=r.G8.LLMIssue}}var S={errorType:"".concat(p,"-").concat(g),featureName:r.CC.Customize,errorMessage:v,subFeatureName:r.Ff.PersonalizationUserProfile};null===(u=t.current)||void 0===u||u.addResponseMessage((0,s.hk)(v,S,n));var C=(0,o.A9)(r.kD.Customize,y);return(0,i.hX)(i.EG.logAshaErrorEvent)||i.EG.logAshaErrorEvent(C,m,r.CC.Customize),g}},53668:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(69038),o=n(75119),i=function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}return e.getInstance=function(){return(0,o.hX)(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=(0,r.WU)(this.personalizationHITLCardActivationTime)},e}()},85088:(e,t,n)=>{"use strict";n.d(t,{$d:()=>C,Bh:()=>x,M7:()=>D,MC:()=>E,_Q:()=>k,_p:()=>O,hk:()=>N,qu:()=>L,tp:()=>b,vq:()=>S});var r=n(43479),o=n(93176),i=n(24643),a=n(10229),s=n(61542),l=n(91222),c=n(876),u=n(88938),d=n(98483),p=n(83437),f=n(23905),h=n(75119),g=n(22606),m=n(53668),y=n(76554),v=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},S=function(e,t,n){var r;(void 0===n&&(n=!1),n)?m.z.getInstance().resetPersonalizationHITLActionState():(void 0===(r=e)&&(r=[]),(null==r?void 0:r.length)>0&&(null==r?void 0:r.some((function(e){return e.responseType===s.yl.Confirm_Set_Personalization_Profile||e.responseType===s.yl.Confirm_Delete_Personalization_Profile})))&&(m.z.getInstance().setIsPersonalizationHITLResponseCardActive(!0),m.z.getInstance().setPersonalizationHITLActionButtonList(T(e,t))))},C=function(){return m.z.getInstance().getIsPersonalizationHITLResponseCardActive()?m.z.getInstance().getPersonalizationHITLActionButtonList():[]},b=function(){return m.z.getInstance().getIsPersonalizationHITLResponseCardActive()},E=function(e){m.z.getInstance().setPersonalizationHITLCardActivationTime(e)},T=function(e,t){var n,r=[],o="";return null==e||e.forEach((function(e){switch(e.responseType){case s.yl.Confirm_Set_Personalization_Profile:r.push(w(e,t)),o=s.yl.Confirm_Delete_Personalization_Profile.toString();break;case s.yl.Confirm_Delete_Personalization_Profile:r.push(P(e,t)),o=s.yl.Confirm_Delete_Personalization_Profile.toString()}})),h.EG.sendChatEventTelemetry((0,f.pN)(((n={})[p.h3.ChatEventType]=p.a5.PersonalizationHITLCardShown,n[p.h3.ChatEventParameters]=o,n))),r},w=function(e,t){return{type:r.jA.Default,title:(0,g.np)(),text:(0,g.np)(),iconRegular:c.N5_,iconHover:c.FUA,handleButtonOnClick:function(n,r,o){I(t,e,(0,g.np)(),o)},isDisabled:!0}},I=function(e,t,n,r){var o,i;void 0===r&&(r=g.u1),A(e,n);var a=(0,f.zq)(r).correlationId;void 0===a&&((0,h.cY)("Invalid correlationId from original profile update query."),h.EG.sendChatEventTelemetry((0,f.pN)(((o={})[p.h3.ChatEventType]=p.a5.UndefinedQueryIDInHITLCard,o))),a=(0,d.A)()),(0,h.hX)(h.EG.setQueryGuid)||h.EG.setQueryGuid(a),(0,h.hX)(h.EG.logKeptEvent)||h.EG.logKeptEvent(p.CC.Customize,p.CC.Customize);var s=t.argumentKeys.findIndex((function(e){return e===g.iX}));if(-1===s)return(0,h.cY)("Failed to find profile ID in required action parameters for personalization confirm button."),void(null===(i=e.current)||void 0===i||i.addResponseMessage(N()));var c=t.argumentValues[s],u=t.queryLanguage;(0,y.c)(e,a,l.X.SET_PROFILE,c,u),m.z.getInstance().resetPersonalizationHITLActionState()},P=function(e,t){return{type:r.jA.Default,title:(0,g.OZ)(),text:(0,g.OZ)(),iconRegular:u.va_,iconHover:u.TTy,handleButtonOnClick:function(n,r,o){_(t,e,(0,g.OZ)(),o)},isDisabled:!0}},_=function(e,t,n,r){var o;void 0===r&&(r=g.u1),A(e,n);var i=(0,f.zq)(r).correlationId;void 0===i&&((0,h.cY)("Failed to find correlation ID in required action parameters for personalization delete button."),h.EG.sendChatEventTelemetry((0,f.pN)(((o={})[p.h3.ChatEventType]=p.a5.UndefinedQueryIDInHITLCard,o))),i=(0,d.A)()),(0,h.hX)(h.EG.setQueryGuid)||h.EG.setQueryGuid(i);var a=t.queryLanguage;(0,y.c)(e,i,l.X.DELETE_PROFILE,g.u1,a),m.z.getInstance().resetPersonalizationHITLActionState()},A=function(e,t){var n,r,a;k(e),m.z.getInstance().setPersonalizationHITLUserInteractionTime(),h.EG.sendLatencyTelemetry((0,f.pN)(((n={})[p.CT.PersonalizationCardUserInteractionTime]=m.z.getInstance().getPersonalizationHITLUserInteractionTime(),n))),null===(r=e.current)||void 0===r||r.addResponseMessage({chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:t}}}}),null===(a=e.current)||void 0===a||a.startLoadingUi()},k=function(e){for(var t,n,r,i,a,s=null===(t=e.current)||void 0===t?void 0:t.getLastMessage(!0),l=null!==(n=null==s?void 0:s.messageType)&&void 0!==n?n:o._.MarkdownCard,c=null!==(i=null===(r=null==s?void 0:s.actionBarButtons)||void 0===r?void 0:r.slice())&&void 0!==i?i:[],u=0,d=c;u<d.length;u++){var p=d[u];p.text!==(0,g.np)()&&p.text!==(0,g.OZ)()||(p.isDisabled=!0)}null===(a=e.current)||void 0===a||a.updateLastMessage({chatCardType:l,chatMessageBodyData:{actionButtonList:v([],c,!0)}})},x=function(e){var t={correlationId:e,featureName:p.CC.Customize},n=g.u1;try{n=JSON.stringify(t)}catch(e){(0,h.cY)("Failed to stringify telemetry data for Personalization ",e)}return n},N=function(e,t,n){var r={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:x(n),feedbackData:(0,h.hX)(h.t6.getFeedbackData)?void 0:h.t6.getFeedbackData(void 0,t)};return{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:null!=e?e:(0,g.de)()}}},chatMessageBodyData:r,stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0}},O=function(e){var t;m.z.getInstance().getIsPersonalizationHITLResponseCardActive()&&(k(e),h.EG.sendChatEventTelemetry((0,f.pN)(((t={})[p.h3.ChatEventType]=p.a5.UserOverridedPersonalizationHITL,t))),h.EG.sendLatencyTelemetry([],!0),m.z.getInstance().resetPersonalizationHITLActionState())},D=function(e){var t,n,r,o,i=null===(t=e.current)||void 0===t?void 0:t.getLastMessage(!0),a=null!==(n=i.actionBarButtons)&&void 0!==n?n:[];if(m.z.getInstance().getIsPersonalizationHITLResponseCardActive()){for(var s=null!==(o=null===(r=null==i?void 0:i.actionBarButtons)||void 0===r?void 0:r.slice())&&void 0!==o?o:[],l=0,c=s;l<c.length;l++){var u=c[l];u.text!==(0,g.np)()&&u.text!==(0,g.OZ)()||(u.isDisabled=!1)}a=s}return a},L=function(){return{featureName:p.CC.Customize,subFeatureName:p.Ff.PersonalizationHITL}}},76554:(e,t,n)=>{"use strict";n.d(t,{R:()=>C,c:()=>v});var r,o=n(93176),i=n(70825),a=n(91479),s=n(95364),l=n(91222),c=n(83437),u=n(23905),d=n(60606),p=n(65167),f=n(22606),h=n(27537),g=n(85088),m=n(75119),y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},y.apply(this,arguments)},v=function(e,t,n,o,h){var g,m;void 0===h&&(h=f.u1);var y={profileOperation:n,queryId:t,profileId:o,queryLanguage:h};r=(new Date).getTime();var v=new i.Xr({parentPath:["Signal",a.t.getTypeName()],items:[{id:p.r.generateId(),body:new a.t(y)}]});null===(m=e.current)||void 0===m||m.submitOperation({operation:v,workflowAnnotationType:s.H.getTypeName()}),(0,d.cY)("Sending User Profile Signal: ",v),d.EG.sendChatEventTelemetry((0,u.pN)(((g={})[c.h3.ChatEventType]=c.a5.UserProfileOperationSubmitted,g[c.h3.ChatEventParameters]=l.X[n],g[c.h3.UserQueryGuid]=t,g)))},S=function(e){return"bot"===e.author&&"Chat"===e.messageType},C=function(e,t,n,i,a){var l,p,v,C=null==e?void 0:e.body,b=C.queryId;b&&!(0,m.hX)(d.EG.setQueryGuid)&&d.EG.setQueryGuid(b),d.EG.updateTelemetryOnAnnotationReceived(s.H.getTypeName(),b,c.CT.UserProfileResponseTime,c.CC.Customize,void 0,r,a);var E=!1,T={featureName:c.CC.Customize,subFeatureName:c.Ff.PersonalizationUserProfile};if(C.error){var w=(0,h.$)(C.error,i,b);return(0,u.AQ)(t,"".concat(s.H.getTypeName(),"_Error"),C.error.category.concat((0,m.jw)(w)?f.u1:"_".concat(w)),c.T_.Server),void n(b)}if(C.chatResponse&&0===C.chatResponse.status){var I=C.chatResponse.messagesToAddOrReplace;if(!(0,m.hX)(I)&&I.length>0)for(var P=0,_=I;P<_.length;P++){var A=_[P];S(A)&&A.text&&((0,d.cY)("rendered user Profile Annotation response:  ",A.text),null===(p=i.current)||void 0===p||p.addResponseMessage({chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:A.text}},chatMessageBodyData:y(y({},(0,m.Hm)(T)),{telemetryData:(0,g.Bh)(b)}),addCardToChatHistory:!0}),E=!0)}}E?d.EG.sendChatEventTelemetry((0,u.pN)(((l={})[c.h3.ChatEventType]=c.a5.QuerySuccessful,l[c.h3.ChatEventParameters]=c.CC.Customize,l))):((0,d.cY)("Error in User Profile Annotation response, showing default error message"),null===(v=i.current)||void 0===v||v.addResponseMessage((0,g.hk)(void 0,y(y({},T),{errorType:c.a5.IncompleteUserProfileResponse}),b))),(0,u.AQ)(t,E?void 0:c.a5.IncompleteUserProfileResponse,void 0,E?void 0:c.T_.Server),n(b)}},62610:(e,t,n)=>{"use strict";n.d(t,{$d:()=>i.$d,M7:()=>i.M7,MC:()=>i.MC,RB:()=>o.R,_Q:()=>i._Q,_p:()=>i._p,qu:()=>i.qu,tp:()=>i.tp,vq:()=>i.vq,zF:()=>r.z});var r=n(53668),o=n(76554),i=n(85088)},18067:(e,t,n)=>{"use strict";n.d(t,{B:()=>a});var r=n(60606),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},a=function(){function e(){this.apiHandlers=new Map}return e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return o(this,void 0,void 0,(function(){var e,t=this;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){return o(t,void 0,void 0,(function(){var t,n,o;return i(this,(function(i){(0,r.cY)("PrivateApi event: "+e),t=!1;try{n=JSON.parse(e)}catch(e){n=null}return(null==n?void 0:n.eventName)&&(o=this.apiHandlers.get(n.eventName))&&(o(n),t=!0),t||(0,r.cY)("Could not dispatch PrivateApi event"),[2]}))}))}))];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),(0,r.cY)("Error initializing PrivateApi: "+e),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return o(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e={dispidMethod:2001},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.execute=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))];case 1:return t.sent(),[2]}}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&(0,r.cY)("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)},e}()},8531:(e,t,n)=>{"use strict";n.d(t,{B:()=>r.B});var r=n(18067)},9500:(e,t,n)=>{"use strict";n.d(t,{P:()=>c,w:()=>l});var r=n(43479),o=n(93176),i=n(80664),a=n(88938),s=n(75119),l=function(e){var t=e.toLocaleLowerCase();return t===(0,s.cU)().toLocaleLowerCase()||t===(0,s.$H)().toLocaleLowerCase()},c=function(e){var t=(0,s.$H)(),n={type:r.jA.Default,title:t,text:(0,i.dD)()?void 0:t,iconRegular:a.T75,handleButtonOnClick:e},l=(0,s.rb)();return{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:l}}},chatMessageBodyData:{actionButtonList:[n]}}}},30935:(e,t,n)=>{"use strict";n.d(t,{P:()=>r.P,w:()=>r.w});var r=n(9500)},83437:(e,t,n)=>{"use strict";var r,o,i,a,s,l,c,u,d,p,f,h;n.d(t,{CC:()=>l,CT:()=>r,Ff:()=>u,G8:()=>d,IC:()=>s,S2:()=>o,T_:()=>c,a5:()=>a,av:()=>h,h3:()=>i,kD:()=>f,wV:()=>p}),function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(r||(r={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.MsgExtTaskModule="MsgExtTaskModule"}(o||(o={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(i||(i={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response"}(a||(a={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode"}(s||(s={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat"}(l||(l={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(c||(c={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile"}(u||(u={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(d||(d={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(p||(p={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(f||(f={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(h||(h={}))},23905:(e,t,n)=>{"use strict";n.d(t,{A9:()=>h,AQ:()=>f,CI:()=>S,Dl:()=>d,IT:()=>y,Wx:()=>p,YI:()=>m,Zy:()=>c,d_:()=>b,mQ:()=>l,pN:()=>u,ys:()=>C,zq:()=>g});var r=n(83437),o=n(60606),i=(n(56933),n(69038)),a=n(75119),s=n(62610),l=function(e,t){var n;o.EG.sendErrorTelemetry(u(((n={})[r.IC.ErrorMessage]="".concat(e),n[r.IC.ErrorCategory]=r.S2.CLP,n[r.IC.ErrorCode]=t,n)))},c=function(e){var t;o.EG.sendChatEventTelemetry(u(((t={})[r.h3.ChatEventType]=r.a5.OfficeJsApiCallForCLP,t[r.h3.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},u=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};function d(){var e;o.EG.sendChatEventTelemetry(u(((e={})[r.h3.ChatEventType]=r.a5.SummaryFromNudgeTriggered,e)))}var p=function(e){var t;o.EG.sendChatEventTelemetry(u(((t={})[r.h3.ChatEventType]=r.a5.ErrorBoundaryCaughtError,t[r.h3.ChatEventParameters]=e,t))),v({vetoName:S(r.kD.UnclearIntent,r.G8.UnclassifiedError),errorString:r.av.UnexpectedFailure,featureName:r.CC.CopilotChat})},f=function(e,t,n,l,c,d){var p,f;t&&""!==t&&o.EG.sendChatEventTelemetry(u(((p={})[r.h3.ChatEventType]=t,p[r.h3.ChatEventParameters]=n||"",p[r.h3.ChatErrorType]=l||"",p)));var h=s.zF.getInstance().shouldConsiderPersonalizationHITLUserInteractionLatency()?s.zF.getInstance().getPersonalizationHITLUserInteractionTime():0;o.EG.sendLatencyTelemetry(u(((f={})[r.CT.UserPerceivedLatency]=(0,i.WU)(e)-h,f[r.CT.IsQuerySuccess]=void 0===t,f[r.CT.ErrorType]=l||"",f[r.CT.ErrorParameter]=(!0===c?t:n)||"",f[r.CT.ErrorChatEventType]=t&&""!==t?t:"",f[r.CT.ErrorChatEventParameter]=t&&""!==t&&n||"",f)),null==d||d),o.EG.setQueryGuid(a.u1),s.zF.getInstance().resetPersonalizationLatencyState()},h=function(e,t){return(0,a.Px)(e,t)},g=function(e){var t={};try{t=JSON.parse(e)}catch(e){(0,o.cY)("Error parsing telemetry data ",e.message)}return t},m=function(e){return e||(e=r.CC.CopilotChat),JSON.stringify({featureName:e})};function y(e,t,n){var a,s;void 0===n&&(n=!0);var l={};if(t){o.EG.sendChatEventTelemetry(u(((a={})[r.h3.ChatEventType]=t.chatEventType,a[r.h3.ChatEventParameters]=t.chatEventParam,a[r.h3.ChatErrorType]=t.chatErrorType,a))),(s={})[r.CT.ErrorType]=r.T_.Client,s[r.CT.ErrorParameter]=t.chatEventType,s[r.CT.ErrorChatEventType]=t.chatEventType,s[r.CT.ErrorChatEventParameter]=t.chatEventParam,l=s;var c=t.ashaErrorDetails;c&&v(c)}e&&((0,o.cY)("User Perceived Latency :  ".concat((0,i.WU)(i.qD)," sec")),l[r.CT.UserPerceivedLatency]=(0,i.WU)(i.qD),l[r.CT.IsQuerySuccess]=!1,o.EG.sendLatencyTelemetry(u(l),n))}function v(e){o.EG.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function S(e,t){return e+" "+t}var C=function(e){var t;o.EG.sendChatEventTelemetry(u(((t={})[r.h3.ChatEventType]=r.a5.ApiPluginDataReceived,t[r.h3.ChatEventParameters]=e.toString(),t)))},b=function(e){var t;o.EG.sendChatEventTelemetry(u(((t={})[r.h3.ChatEventType]=r.a5.MsgExtDataReceived,t[r.h3.ChatEventParameters]=e.toString(),t)))}},95261:(e,t,n)=>{"use strict";n.d(t,{D:()=>r.Dl});var r=n(23905)},29739:(e,t,n)=>{"use strict";n.d(t,{j:()=>u});var r=n(60606),o=n(23905),i=n(83437),a=n(17425),s=n(58651),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},u=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return l(this,void 0,void 0,(function(){var e,t,r;return c(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,89761))];case 3:return t.msalModule=o.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(r=o.sent(),s.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),r),3===e)throw r;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createPublicClientApplication=function(e){var t,n;return l(this,void 0,void 0,(function(){var r,o;return c(this,(function(i){return r=null!==(n=null===(t=this.params)||void 0===t?void 0:t.clientId)&&void 0!==n?n:a.ky,o=this.params.redirectUri,[2,new e({auth:{clientId:r,authority:a.mr,redirectUri:new URL(o,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t){var n;return l(this,void 0,void 0,(function(){var t,a,s,l,u;return c(this,(function(c){switch(c.label){case 0:return(0,r.cY)("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:c.sent(),c.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=c.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&r.EG.sendChatEventTelemetry((0,o.pN)(((u={})[i.h3.ChatEventType]=i.a5.MSALTokenRequested,u))),a=void 0,c.label=4;case 4:return c.trys.push([4,10,,14]),[4,t.initialize()];case 5:return c.sent(),0!==(null==(s=t.getAllAccounts())?void 0:s.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,c.sent()];case 7:return[4,this.getSelectedAccount(s,t)];case 8:if(!(a=c.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,a,t)];case 9:return[2,c.sent()];case 10:return l=c.sent(),(0,r.cY)("Failed to get access token: ".concat(null==l?void 0:l.message)),this.msalModule&&l instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,a,t)]:[3,12];case 11:return[2,c.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),l;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getSelectedAccount=function(e,t){var n;return l(this,void 0,void 0,(function(){var r,o,i,a=this;return c(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(i=s.sent())?void 0:i.account];case 2:if(!e||0===e.length)return[2,null];if(r=this.params?null!==(n=e.find((function(e){var t,n,r;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(r=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===r?void 0:r.toLowerCase())})))&&void 0!==n?n:null:e[0],r)return[2,r];o=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(o),[4,this.loginPopupPromise];case 4:return[2,null==(i=s.sent())?void 0:i.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){var n;return l(this,void 0,void 0,(function(){var r,o;return c(this,(function(i){switch(i.label){case 0:return r={scopes:["".concat(e,"/.default")],loginHint:null===(n=this.params)||void 0===n?void 0:n.userPrincipalName},[4,t.ssoSilent(r)];case 1:return(o=i.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n){return l(this,void 0,void 0,(function(){var r,o;return c(this,(function(i){switch(i.label){case 0:return r={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(r)];case 1:return(o=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return l(this,void 0,void 0,(function(){var r,o;return c(this,(function(i){switch(i.label){case 0:return r={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(r)];case 1:return(o=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,o]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&r.EG.sendErrorTelemetry((0,o.pN)(((t={})[i.IC.ErrorCategory]=i.S2.MSAL,t[i.IC.ErrorMessage]=e,t)))},e}()},38753:(e,t,n)=>{"use strict";n.d(t,{Bp:()=>S,Cs:()=>b,Hm:()=>w,Id:()=>y,Ne:()=>E,Px:()=>C,hU:()=>v,hX:()=>g,jw:()=>T,sZ:()=>m,zR:()=>I});var r=n(23905),o=n(10229),i=n(41273),a=n(22606),s=n(62284),l=n(40144),c=n(61542),u=n(60606),d=n(83437),p=function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)},f=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},h=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function g(e){return null==e}function m(){var e;null===(e=window.document.getElementById(a.Os))||void 0===e||e.style.setProperty("display","none")}var y=function(e,t,n,r){var o=t!==i.Gm.defaultWhite&&t!==i.Gm.themeColorful?p({isDarkModeEnabled:!0,isHighContrastModeEnabled:n},(0,s.W)(e)):p({isDarkModeEnabled:!1,isHighContrastModeEnabled:n},(0,l.a)(e));return o.dir=r,o},v=function(e){return{displayCategory:e.map((function(e){return{value:e}}))}};function S(e){(0,u.cY)("launchThisVersionOfSDX():"+e),""===e?(0,u.cY)("launchThisVersionOfSDX() is empty"):e!==window.location.href.split("/")[4]&&((0,u.cY)("launchThisVersionOfSDX difference detected"),window.location.href.split("/").length>4&&(window.location.href=window.location.href.replace(window.location.href.split("/")[4],e)))}function C(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.join(" ")}var b=function(){return"undefined"!=typeof OfficeaicopilotStrings},E=function(e){var t,n,o,i;if(!g(e))return(0,u.cY)("Chat Message header received in response chatMessageHeaderType: ",e.chatMessageHeaderType),e.chatMessageHeaderType===c.Hu.Personalization_Indicator&&((0,u.cY)("Personalization header received in response"),u.EG.sendChatEventTelemetry((0,r.pN)(((t={})[d.h3.ChatEventType]=d.a5.PersonalizationIndicatorShown,t[d.h3.IsPersonalizedResponse]=!0,t))),u.EG.sendLatencyTelemetry((0,r.pN)(((n={})[d.CT.IsPersonalizedResponse]=!0,n)))),{titleText:null!==(o=null==e?void 0:e.title)&&void 0!==o?o:"",popoverText:null!==(i=null==e?void 0:e.expandedTitle)&&void 0!==i?i:void 0}};function T(e){return""===e}function w(e,t){return{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,showAnimation:!0,isFailure:!1,feedbackData:g(u.t6.getFeedbackData)?void 0:u.t6.getFeedbackData(t,e)}}var I=function(e,t,n,r){return f(void 0,void 0,void 0,(function(){var o;return h(this,(function(i){switch(i.label){case 0:return[4,e(a.oU,["ResourceConstrainedToken.PAC"])];case 1:return o=i.sent(),[2,fetch(t,p(p({},r),{headers:p(p({},null==r?void 0:r.headers),{Authorization:o.token,"X-SPOPacToken":n})}))]}}))}))}},2296:(e,t,n)=>{"use strict";n.d(t,{N:()=>a});var r=n(75119),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},a=function(){return o(void 0,void 0,void 0,(function(){var e,t;return i(this,(function(n){switch(n.label){case 0:if(!(0,r.$$)()&&!(0,r.fU)())return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.PrivateApi.execute("SHOW_COPILOT_PRODIGY_UPSELL_FLOW")];case 2:return e=n.sent(),(0,r.cY)(e),[3,4];case 3:return t=n.sent(),(0,r.cY)("Error Executing SHOW_COPILOT_PRODIGY_UPSELL_FLOW"+t),[3,4];case 4:return[3,7];case 5:return[4,Office.license.launchUpsellExperience("copilotsidepanel_creditlimit")];case 6:n.sent(),n.label=7;case 7:return[2]}}))}))}},62841:(e,t,n)=>{"use strict";n.d(t,{JI:()=>l,j9:()=>c,v_:()=>s,zt:()=>u});var r=n(4460),o=n(26940),i=n(60606),a=n(41273),s=function(e){var t=e.invocation;if(t){var n=t.match(/designer_graphic_art\(\s*[^)]*prompt\s*=\s*"([^"]*)"/);return n?n[1]:void 0}},l=function(e){var t=s(e);return"bot"===e.author&&e.messageType===o.n3.GenerateContentQuery&&(null==e?void 0:e.contentType)===a.lL.Image&&void 0!==t},c=function(e){return"bot"===e.author&&e.messageType===o.n3.GenerateContentQuery&&(null==e?void 0:e.contentType)===a.lL.Video&&(!!(t=e.invocation)&&null!==t.match(/clipchamp_create_video\(\s*[^)]*userPrompt\s*=\s*"([^"]*)"/));var t},u=function(e,t,n){return t?"dogfood":n&&(0,i.Rs)(e)===r.O.GCC?"gcc":"production"}},41273:(e,t,n)=>{"use strict";var r,o,i,a,s,l,c,u,d,p,f,h;n.d(t,{$m:()=>l,Gm:()=>a,OZ:()=>u,W$:()=>s,YY:()=>d,eB:()=>c,lL:()=>f,ut:()=>r,yx:()=>i,zg:()=>p}),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(r||(r={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(o||(o={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(i||(i={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(a||(a={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(s||(s={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(l||(l={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(c||(c={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(u||(u={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(d||(d={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(p||(p={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(f||(f={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(h||(h={}))},8849:(e,t,n)=>{"use strict";n.d(t,{GZ:()=>v,Hr:()=>p,Kj:()=>h,Sd:()=>C,TR:()=>m,gI:()=>g,iB:()=>S,jP:()=>f,y8:()=>y});var r=n(66382),o=n(42441),i=n(22606),a=n(60606),s=n(8531),l=n(23905),c=n(83437),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},p=function(e){if(e&&e.appType===r.b.MessageExtension)return[{id:"CopilotPlugins.".concat(e.appType,".").concat(e.appId),source:"MOS3"}]},f=function(){var e,t=i.ps;null===(e=null===window||void 0===window?void 0:window.open)||void 0===e||e.call(window,t,"_blank","noopener,noreferrer")},h=function(){s.B.getInstance().openMOSDialog()};function g(e){return void 0===e||""===e}var m=function(e,t,n){var r=(0,o.ZA)(e),i=t===n?void 0:t;return(0,a.cY)("AtMentioned GPT: ",r),(0,a.cY)("Selected menu GPT: ",i),null!=r?r:i};function y(e,t){var n=(0,o.ZA)(t);return!g(e)||void 0!==n}function v(e){return u(this,void 0,void 0,(function(){var t,n,r;return d(this,(function(o){switch(o.label){case 0:t=function(t){var n;(0,a.cY)("handleCopilotAgentEvent in client",JSON.stringify(t)),a.EG.sendChatEventTelemetry((0,l.pN)(((n={})[c.h3.ChatEventType]=c.a5.MOSStoreDialogResponse,n[c.h3.ChatEventParameters]=JSON.stringify(t),n))),e(t)},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.UnifiedStore.onCopilotAgentEvent(t)];case 2:return o.sent(),[3,4];case 3:return n=o.sent(),(0,a.cY)("Error in initializing CopilotAgent listener",n),a.EG.sendErrorTelemetry((0,l.pN)(((r={})[c.IC.ErrorMessage]="".concat(n),r[c.IC.ErrorCategory]=c.a5.MOSStoreDialogResponse,r))),[3,4];case 4:return[2]}}))}))}var S=function(e,t){return u(void 0,void 0,void 0,(function(){var n,r,o;return d(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),e?[4,OfficeFirstParty.UnifiedStore.launchStore(i.Bx)]:[3,2];case 1:return u.sent(),[3,5];case 2:return t?[4,s.B.getInstance().openMOSDialog()]:[3,4];case 3:return u.sent(),[3,5];case 4:f(),u.label=5;case 5:return a.EG.sendChatEventTelemetry((0,l.pN)(((r={})[c.h3.ChatEventType]=c.a5.OpenMOSDialog,r[c.h3.ChatEventParameters]="RichAPI: ".concat(e,", PrivateAPI: ").concat(t),r))),[3,7];case 6:return n=u.sent(),(0,a.cY)("Error in launching MOS dialog",n),f(),a.EG.sendErrorTelemetry((0,l.pN)(((o={})[c.IC.ErrorMessage]="".concat(n),o[c.IC.ErrorCategory]=c.a5.OpenMOSDialog,o))),[3,7];case 7:return[2]}}))}))},C=function(e,t){return e?JSON.stringify({gptId:null!=e?e:i.u1,agentType:null!=t?t:i.u1}):i.u1}},51903:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});var r=n(70533),o=n(98483),i=function(e){if(/^data:image\/[a-zA-Z]+;base64,/.test(e)){for(var t=e.split(",")[1],n=atob(t),i=new Uint8Array(new ArrayBuffer(n.length)),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);var s=function(e){return e.startsWith("data:image/png")?{format:r.f.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:r.f.Jpg}:e.startsWith("data:image/bmp")?{format:r.f.Bmp}:{format:r.f.Other,otherFormat:e.split(";")[0].split(":")[1]}}(e),l=s.format,c=s.otherFormat;return{contents:[{id:(0,o.A)(),size:r.h.Unspecified,format:l,otherFormat:c,data:Array.from(i),sizeBytes:i.length}],widthPx:0,heightPx:0}}}},41167:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(8520),o=n(58651),i=function(e,t,n){return void 0===n&&(n=3),(0,r.lazy)((function(){return new Promise((function(r,i){var a=0,s=function(){e().then((function(e){return r(e)})).catch((function(e){++a>=n?i(e):(o.error("Error in lazy loading package ".concat(t),e),s())}))};s()}))}))}},52628:(e,t,n)=>{"use strict";n.d(t,{$n:()=>l,LJ:()=>s,b_:()=>i,h7:()=>r,k$:()=>o,zi:()=>a});var r=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],o=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],i=["ar-SA","he-IL"],a=["ca-ES","cy-GB"],s=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],l=["ar-SA","fa-IR","he-IL","ug-CN","ur-PK"]},65167:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});var r=n(60606),o="AugLoopChat".concat(r.JB),i=function(){function e(){}return e.generateId=function(){return e.operationId++,o+e.operationId.toString()},e.operationId=0,e}()},72096:(e,t,n)=>{"use strict";n.d(t,{$$:()=>i,fU:()=>o});var r=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e}(),o=(r.isWebPlatform,r.isMacPlatform),i=r.isIOSPlatform},11443:(e,t,n)=>{"use strict";n.d(t,{DY:()=>s,_s:()=>o,dD:()=>l});var r,o,i=n(52628),a=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t}(function(e){function t(t,n){var r=e.call(this,n)||this;return r.name=t,r}return a(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(o||(o={}));var l=function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.supportedLanguages=[]}return Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var r=this.supportedLanguages[n];if(t[0]===r.split("-")[0])return r}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new s(o.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=i.h7,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(i.k$),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(i.b_))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(i.LJ)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(i.zi))},e}()},22606:(e,t,n)=>{"use strict";n.d(t,{$9:()=>h,$H:()=>R,Bx:()=>l,Fq:()=>s,H9:()=>N,KA:()=>x,MH:()=>_,Ng:()=>k,O1:()=>T,OZ:()=>f,Os:()=>i,Rk:()=>a,Sh:()=>m,TZ:()=>E,Td:()=>D,VQ:()=>I,W2:()=>P,aE:()=>w,ae:()=>U,bX:()=>v,cU:()=>F,de:()=>u,f4:()=>b,hf:()=>C,iX:()=>d,nG:()=>B,np:()=>p,oM:()=>O,oU:()=>L,pS:()=>S,ps:()=>z,qA:()=>g,qO:()=>c,rb:()=>M,s_:()=>A,u1:()=>o,w3:()=>y});var r=n(75119),o="",i="shimmer",a=2e3,s=10,l="CopilotAgentsPage",c=3e4,u=function(){return(0,r.Cs)()?OfficeaicopilotStrings.PersonalizationProfileErrorResponse:"Sorry, something went wrong. Please try again in a moment or ask me to help with something else."},d="ProfileId",p=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ConfirmButtonLabel:"Confirm"},f=function(){return(0,r.Cs)()?OfficeaicopilotStrings.DeleteButtonLabel:"Delete"},h="Copilot Extensions Dialog",g="3068386c-7a16-4f6a-a664-043b6b232816",m=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},y=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that cant be applied when a file is read-only."},v=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},S=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},C=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},b=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},E=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},T=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},w=function(){return(0,r.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},I=function(){return(0,r.Cs)()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},P=function(){return(0,r.Cs)()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},_=function(){return(0,r.Cs)()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},A=function(){return(0,r.Cs)()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},k=function(){return(0,r.Cs)()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},x=function(){return(0,r.Cs)()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},N=function(){return(0,r.Cs)()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},O=function(){return(0,r.Cs)()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},D=function(){return(0,r.Cs)()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},L="00000003-0000-0ff1-ce00-000000000000",R=function(){return(0,r.Cs)()?OfficeaicopilotStrings.SpeakWithCopilotText:"Speak with Copilot"},F=function(){return(0,r.Cs)()?OfficeaicopilotStrings.PromptGuideMenuItemSpeakWithCopilot:"Speak with Copilot about document insights"},M=function(){return(0,r.Cs)()?OfficeaicopilotStrings.SpeakWithCopilotResponseMessage:"Sure! I can answer questions and summarize key points from this document. Click 'Speak with Copilot' to start."},B=5,U=2,z="https://go.microsoft.com/fwlink/?linkid=2271054"},60606:(e,t,n)=>{"use strict";n.d(t,{EG:()=>r,JB:()=>a,Rs:()=>c,YP:()=>l,cY:()=>s,t6:()=>o});var r,o,i=n(4460),a=void 0,s=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},l=function(e,t,n,i){a=e,s=t,r=n,o=i};function c(e){return e?e.indexOf("augloop.office.com")>=0||e.indexOf("augloop-int.officeppe.com")>=0?i.O.Prod:e.indexOf("augloop-gcc.office.com")>=0?i.O.GCC:e.indexOf("augloop.gov.online.office365.us")>=0?i.O.GCCHigh:e.indexOf("augloop.dod.online.office365.us")>=0?i.O.DOD:e.includes("dogfood")?i.O.DogFood:i.O.None:i.O.None}},73744:(e,t,n)=>{"use strict";new(n(76653).A)({iteration:0})},76653:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}()},75119:(e,t,n)=>{"use strict";n.d(t,{$$:()=>h.$$,$9:()=>u.$9,$H:()=>u.$H,$m:()=>c.$m,$n:()=>p.$n,Bp:()=>o.Bp,Cs:()=>o.Cs,DY:()=>d.DY,EG:()=>l.EG,Fq:()=>u.Fq,GZ:()=>g.GZ,Gm:()=>c.Gm,Hm:()=>o.Hm,Hr:()=>g.Hr,Id:()=>o.Id,JI:()=>a.JI,Kj:()=>g.Kj,Ne:()=>o.Ne,Nn:()=>i.N,Px:()=>o.Px,Rk:()=>u.Rk,Rs:()=>l.Rs,Sd:()=>g.Sd,TR:()=>g.TR,W$:()=>c.W$,YP:()=>l.YP,Zl:()=>f.Z,_s:()=>d._s,ae:()=>u.ae,b_:()=>p.b_,cU:()=>u.cU,cY:()=>l.cY,dD:()=>d.dD,eB:()=>c.eB,fU:()=>h.fU,gI:()=>g.gI,hU:()=>o.hU,hX:()=>o.hX,iB:()=>g.iB,j9:()=>a.j9,jP:()=>g.jP,jY:()=>r.j,jw:()=>o.jw,nG:()=>u.nG,pi:()=>s.p,qA:()=>u.qA,rb:()=>u.rb,sZ:()=>o.sZ,t6:()=>l.t6,u1:()=>u.u1,ut:()=>c.ut,v_:()=>a.v_,y8:()=>g.y8,yx:()=>c.yx,zR:()=>o.zR,zg:()=>c.zg,zt:()=>a.zt});var r=n(29739),o=n(38753),i=n(2296),a=n(62841),s=n(51903),l=n(60606),c=n(41273),u=n(22606),d=n(11443),p=n(52628),f=n(41167),h=(n(76653),n(73744),n(72096)),g=n(8849)},68553:(e,t,n)=>{"use strict";n(22606),n(65167),n(23905),n(38753),n(7545),n(83437)},57852:(e,t,n)=>{"use strict";n(7545),n(65167),n(83437),n(23905),n(38753),n(22606)},80858:(e,t,n)=>{"use strict";n(57852),n(68553)},31257:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var r=n(8520),o=n(29953);function i(e){var t=e.lookupString,n=e.children,i=(0,o.eO)(),a=r.useMemo((function(){return{lookupString:(e=t,n=i.lookupString,function(t){return function(r){var o=e(t)(r);if(o!==t)return o;var i=n(t)(r);return i!==t?i:t}})};var e,n}),[t,i]);return r.createElement(o.d7,{value:a},n)}},88539:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});const r=e=>({chatUiStack:e.chatUiStack??{},chatFreStack:e.chatFreStack??{},chatUiStackForBundled:e.chatUiStackForBundled??{},chatFreStackForBundled:e.chatFreStackForBundled??{},shimmerUi:e.shimmerUi??{},shimmerUiZoom:e.shimmerUiZoom??{},chatUiStackZoom:e.chatUiStackZoom??{},chatFreStackZoom:e.chatFreStackZoom??{},chatUiStackZoomForBundled:e.chatUiStackZoomForBundled??{},chatFreStackZoomForBundled:e.chatFreStackZoomForBundled??{},chatFreStackContainer:e.chatFreStackContainer??{},spinner:e.spinner??{},headerElement:e.headerElement??{},incomingShimmerCard:e.incomingShimmerCard??{},outgoingShimmerCard:e.outgoingShimmerCard??{},incomingShimmerCardWrapper:e.incomingShimmerCardWrapper??{},outgoingShimmerCardWrapper:e.outgoingShimmerCardWrapper??{},voicePageContainer:e.voicePageContainer??{}});function o(e){return r(e)}},96447:(e,t,n)=>{"use strict";n.d(t,{W:()=>h});var r,o=n(83248),i=n(70825),a=n(98483),s=n(84735),l=n(1373),c=n(95044),u=n(85535),d=n(89125),p=n(71977),f=n(70110);!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(r||(r={}));const h=async(e,t,n,h)=>{try{const m=JSON.parse(e),y=(new Date).toISOString(),{AnswerType:v,FeedbackReasonType:S}=(e=>{const t=e?.elements?.options??[];let n="CopilotChatFeedback",o=0;for(const e of t)switch(e.displayedText?.toLowerCase()){case r.INACCURATE_OR_IRRELEVANT:o=33554432;break;case r.OFFENSIVE:n="CopilotChatReportHarm",o=32;break;case r.OTHER:o=64}return{AnswerType:n,FeedbackReasonType:o}})(m?.responseContent),C=(0,f.Rx)(),b=m?.responseContent?.elements.find((e=>e.userVerbatim))?.userVerbatim??(m?.responseContent?JSON.stringify(m.responseContent):""),E=(g=C,g?.contextData?.sydneyContextData?g?.contextData?.sydneyContextData:{conversationId:p.c.currentChatId,feedbackMessageId:(0,f.Xf)(),locale:(0,f.Tw)(),sydneyEndpoint:(0,f.cy)(),utteranceTimeStamp:(new Date).toISOString()}),T=(0,f.cy)();if(!E.feedbackMessageId&&!n||!E.conversationId||!T&&!E.sydneyEndpoint)return void d.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.FeedbackDataSydneyDataMissing},{key:u.h3.ChatEventParameters,value:(C.contextData?.feedbackContextData?.errorMessage??"")+(C.contextData?.feedbackContextData?.errorType??"")}]);const w=Object.assign(new o.n,{responseData:{AnswerType:v,ClientName:t+"CopilotOCV",CorrelationId:(0,a.A)(),Date:y,Description:b,FeedbackId:m?.diagnosticsUploadId??(0,a.A)(),FeedbackRating:"Frown"===m?.feedbackType?1:2,FeedbackReasonType:S,UserConsentGiven:m?.hostManagedContextDataConsent??!0,OptionalFields:{ConvId:E.conversationId,Endpoint:E.sydneyEndpoint??T,Locale:E.locale??"en-us",TraceId:E.feedbackMessageId??(E.requestId?.length?E.requestId:"!TRACE_ID_NA"),FeedbackSourceType:"OCV",UtteranceHappenTime:E.utteranceTimeStamp??y,ContactMe:!!m?.userEmail}}}),I=new i.g0({parentPath:["Signal",o.n.getTypeName()],items:[{id:l.r.generateId(),body:w}]});(0,c.cY)(`Submitting FeedbackDiagnosticDataSignal to Augloop : ${o.n.getTypeName()} with signal: ${JSON.stringify(I)}`),h?h(I,o.n.getTypeName()):s.E.getInstance().submitOperation(I,o.n.getTypeName()),d.j.getInstance().sendTelemetryChatEventData([{key:u.h3.ChatEventType,value:u.a5.FeedbackDataUploadOperationSubmitted}])}catch(e){(0,c.cY)("Error parsing feedback response data",e.message)}var g}},43100:(e,t,n)=>{"use strict";n.d(t,{h:()=>ce});var r,o=n(11906);!function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(r||(r={}));var i=n(91208),a=n(10229),s=n(78126),l=n(68262),c=n(97790),u=n(79490),d=n(56350),p="OcvInappFeedback Iframe";function f(e,t,n){(0,d.Rm)({id:e,type:d.JV.Info,message:"".concat(p,": ").concat(t),data:(0,u.__assign)((0,u.__assign)({},n),{timestamp:Date.now()})})}var h=n(8520),g=n(94329),m=n(77727),y=n(29039),v=n(3445),S=(0,h.createContext)({}),C=["local"],b=function(e){var t=e.initializationInfo,n=e.feedbackInitOptions,r=e.children,o=h.useMemo((function(){var e,r="admin.microsoft.com",o=[["appname","ocvfeedback"],["feature","host-ocv-inapp-feedback"],["platform","web"]],i=null!==(e=t.iFrameAppId)&&void 0!==e?e:n.appId;i&&o.push(["appId",String(i)]);var a,s=t.specificHvcVersion;s&&(r="admin-ignite.microsoft.com",a=s,C.some((function(e){return a.includes(e)}))||o.push(["pkgver",s])),t.locale&&o.push(["culture",t.locale]);var l=o.map((function(e){var t=(0,u.__read)(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join("&");return"https://".concat(r,"/centrohost?").concat(l,"#/hostedpage")}),[n.appId,t.iFrameAppId,t.locale,t.specificHvcVersion]),i=h.useCallback((function(){var e;g.unmountComponentAtNode(t.inAppFeedbackRef),null===(e=t.returnElementRef)||void 0===e||e.focus()}),[t]);return h.createElement(S.Provider,{value:{iFrameSrc:o,initializationInfo:t,feedbackInitOptions:n,cleanUp:i}},r)},E=n(14113),T=n(31043),w=n(55033),I=n(30112),P=n(658),_=n(16895),A=(0,P.n)({iFrame:(0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)({},_.Pt.margin(0)),_.Pt.padding(0)),_.Pt.border("none")),{flexGrow:1}),iFrameLoading:{visibility:"hidden"},spinner:{position:"absolute",height:"max(100%, 100px)",width:"max(100%, 100px)",zIndex:1,top:0}}),k=function(e){var t,n,r,o,i,a,s,l,c,d,p=e.onDimensionUpdate,f=e.onLoadingComplete,g=e.onClose,y=e.className,v=h.useContext(S),C=v.feedbackInitOptions,b=v.iFrameSrc,E=h.useRef(null),T=function(e){var t,n=h.useContext(S),r=n.feedbackInitOptions,o=n.iFrameSrc,i=h.useCallback((function(){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.provideDynamicScreenshot)||void 0===n||n.call(t).then((function(t){var n,r,i={event:"InAppFeedbackScreenshot",data:t};null===(r=null===(n=e.current)||void 0===n?void 0:n.contentWindow)||void 0===r||r.postMessage(i,o)}))}),[r.callbackFunctions,e,o]),a=h.useCallback((function(){var t,n;if(r.feedbackConfig&&(null===(t=e.current)||void 0===t?void 0:t.contentWindow)){var i={event:"InAppFeedbackInitOptions",data:(0,u.__assign)((0,u.__assign)({},r),{callbackFunctions:void 0,feedbackConfig:(0,u.__assign)((0,u.__assign)({},r.feedbackConfig),{diagnosticsConfig:(0,u.__assign)((0,u.__assign)({},r.feedbackConfig.diagnosticsConfig),{extractFeedbackDataForHost:void 0,getContextData:void 0,attachDiagnostics:void 0}),hostPlatform:m.Lq.IFrame,calloutTarget:void 0})})};null===(n=e.current.contentWindow)||void 0===n||n.postMessage(i,o)}}),[r,e,o]),s=h.useCallback((function(t){var n,i,a,s,l;null===(i=null===(n=r.callbackFunctions)||void 0===n?void 0:n.attachDiagnosticsLogs)||void 0===i||i.call(n,t.diagnosticsUploadId,t.diagnosticsEndpoint),(null===(a=r.callbackFunctions)||void 0===a?void 0:a.attachDiagnosticsLogs)&&(null===(l=null===(s=e.current)||void 0===s?void 0:s.contentWindow)||void 0===l||l.postMessage({event:"InAppFeedbackScreenshot",data:{error:"Success"}},o))}),[r.callbackFunctions,e,o]),l=h.useCallback((function(){var t,n,i;null===(i=null===(n=null===(t=r.feedbackConfig)||void 0===t?void 0:t.diagnosticsConfig)||void 0===n?void 0:n.getContextData)||void 0===i||i.call(n).then((function(t){var n,r,i={event:"InAppFeedbackGetContextData",data:t};null===(r=null===(n=e.current)||void 0===n?void 0:n.contentWindow)||void 0===r||r.postMessage(i,o)}))}),[null===(t=r.feedbackConfig)||void 0===t?void 0:t.diagnosticsConfig,e,o]),c=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.setCurrentPage)||void 0===n||n.call(t,e.pageName)}),[r]),d=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.setSubmitButtonState)||void 0===n||n.call(t,e.isDisabled)}),[r]),p=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.onDismiss)||void 0===n||n.call(t,Boolean(e.isSuccess))}),[r]),f=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.onError)||void 0===n||n.call(t,e.errorMessage)}),[r]),g=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.onSuccess)||void 0===n||n.call(t,e.clientFeedbackId)}),[r]),y=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.initializationComplete)||void 0===n||n.call(t,e)}),[r]),v=h.useCallback((function(e){var t,n;null===(n=null===(t=r.callbackFunctions)||void 0===t?void 0:t.onResize)||void 0===n||n.call(t,e)}),[r]),C=h.useCallback((function(){var e,t;null===(t=null===(e=r.callbackFunctions)||void 0===e?void 0:e.supportCallback)||void 0===t||t.call(e)}),[r]),b=h.useCallback((function(t){var n,i;null===(i=null===(n=r.callbackFunctions)||void 0===n?void 0:n.getUserAccessToken)||void 0===i||i.call(n,t.audience,t.userUpn).then((function(t){var n,r,i={event:"InAppFeedbackGetUserAccessTokenResult",data:t};null===(r=null===(n=e.current)||void 0===n?void 0:n.contentWindow)||void 0===r||r.postMessage(i,o)}))}),[r,e,o]);return{InAppFeedbackScreenshot:i,InAppFeedbackInitOptions:a,InAppFeedbackAttachDiagnosticLogs:s,InAppFeedbackGetContextData:l,InAppFeedbackSetCurrentPage:c,InAppFeedbackSetSubmitButtonState:d,InAppFeedbackOnThemeChange:function(){},InAppFeedbackDismissWithResult:p,InAppFeedbackOnError:f,InAppFeedbackOnSuccess:g,InAppFeedbackDiagnosticLogsResult:function(){},InAppFeedbackInitializationComplete:y,InAppFeedbackExtractFeedbackDataForHost:function(){},InAppFeedbackOnResize:v,InAppFeedbackSupportCallback:C,InAppFeedbackGetUserAccessToken:b,InAppFeedbackGetUserAccessTokenResult:function(){}}}(E),P=null!==(n=null===(t=C.feedbackConfig)||void 0===t?void 0:t.maxHeight)&&void 0!==n?n:606,_=(0,u.__read)((0,h.useState)(100),2),k=_[0],x=_[1],N=(0,u.__read)((0,h.useState)(!1),2),O=N[0],D=N[1],L=null!==(a=null!==(o=null===(r=C.feedbackConfig)||void 0===r?void 0:r.width)&&void 0!==o?o:null===(i=C.feedbackConfig)||void 0===i?void 0:i.maxWidth)&&void 0!==a?a:320;(0,h.useEffect)((function(){null==p||p({height:k,width:L})}),[k,L,p]);var R=(0,u.__read)(h.useState(!0),2),F=R[0],M=R[1],B=A(),U=h.useCallback((function(){M(!1),null==f||f()}),[f]),z=(0,h.useCallback)((function(e){var t,n,r=e.data;if(r){switch(r.Event){case"InAppFeedbackOnResize":if((null===(t=C.feedbackConfig)||void 0===t?void 0:t.feedbackUiType)===m.CS.IFrameWithinSidePane)break;var o=r.EventArgs,i=Math.min(P,window.innerHeight-40,o.scrollHeight)+4;x(i),null==p||p({height:i,width:L});break;case"InAppFeedbackDismissWithResult":g();break;case"InAppFeedbackInitializationComplete":D(!0)}E.current&&(null===(n=T[r.Event])||void 0===n||n.call(T,r.EventArgs))}}),[null===(s=C.feedbackConfig)||void 0===s?void 0:s.feedbackUiType,T,P,g,p,L]);h.useEffect((function(){return window.addEventListener("message",z),function(){window.removeEventListener("message",z)}}),[z]);var H=F||!O,G=h.useMemo((function(){var e,t;return(null===(t=null===(e=C.feedbackConfig)||void 0===e?void 0:e.screenshotInfo)||void 0===t?void 0:t.providedScreenshotType)===m.Bv.AutoCapture?"display-capture;":void 0}),[null===(c=null===(l=C.feedbackConfig)||void 0===l?void 0:l.screenshotInfo)||void 0===c?void 0:c.providedScreenshotType]);return h.createElement(h.Fragment,null,H&&h.createElement(w.y,{size:"medium",className:B.spinner,"data-testid":"iframe-spinner"}),h.createElement("iframe",{title:"inapp-feedback-iframe",height:(null===(d=C.feedbackConfig)||void 0===d?void 0:d.feedbackUiType)!==m.CS.SidePane?k:void 0,width:L,src:b,allow:G,sandbox:"allow-scripts allow-same-origin allow-forms allow-popups",onLoad:U,ref:E,className:(0,I.z)(B.iFrame,H&&B.iFrameLoading,y)}))},x=(0,P.n)({popoverSurface:(0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)({zIndex:1},_.Pt.margin(0)),_.Pt.padding(0)),_.Pt.border("none")),{display:"flex",flexDirection:"column"}),iFrame:{maxWidth:"calc(100vw - 40px)"}}),N="inapp-feedback-iframe-callout-surface",O=function(e){var t,n,r=e.mountNode,o=x(),i=(0,u.__read)((0,h.useState)(!1),2),a=i[0],s=i[1],l=(0,u.__read)((0,h.useState)(),2),c=l[0],d=l[1],p=h.useContext(S),f=p.feedbackInitOptions,g=p.cleanUp,m=(0,h.useRef)(null),y=h.useMemo((function(){var e,t;return(null===(e=f.feedbackConfig)||void 0===e?void 0:e.calloutTarget)?f.feedbackConfig.calloutTarget:(null===(t=f.feedbackConfig)||void 0===t?void 0:t.calloutTargetID)?document.getElementById(f.feedbackConfig.calloutTargetID):void 0}),[null===(t=f.feedbackConfig)||void 0===t?void 0:t.calloutTarget,null===(n=f.feedbackConfig)||void 0===n?void 0:n.calloutTargetID]);(0,h.useEffect)((function(){y&&m.current&&(m.current.setTarget(y),s(!0))}),[y]);var v=(0,h.useCallback)((function(){s(!1),g()}),[g]),C=(0,u.__read)((0,h.useState)(),2),b=C[0],w=C[1],I=(0,h.useCallback)((function(e){e.target.closest("#".concat(N))||(e.stopPropagation(),e.preventDefault())}),[]),P=(0,h.useCallback)((function(){if((null==c?void 0:c.height)&&(null==c?void 0:c.width)&&y){var e=y.getBoundingClientRect();e.left>c.width+40?w("before"):window.innerWidth-e.right>c.width+40?w("after"):window.innerHeight-e.bottom>c.height+40?w("below"):e.top>c.height+40?w("above"):w(void 0)}else w(void 0)}),[null==c?void 0:c.width,null==c?void 0:c.height,y]);(0,h.useEffect)((function(){return P(),window.addEventListener("resize",P),window.addEventListener("click",I,!0),function(){window.removeEventListener("resize",P),window.removeEventListener("click",I,!0)}}),[I,P]);var _=(0,h.useCallback)((function(e,t){return t.open||v()}),[v]);return h.createElement(E.A,{positioning:{positioningRef:m,position:b,autoSize:"height",overflowBoundaryPadding:20},open:a,mountNode:r,trapFocus:!0,inertTrapFocus:!0,withArrow:!0,onOpenChange:_},h.createElement(T.H,{tabIndex:-1,className:o.popoverSurface,id:N},h.createElement(k,{onDimensionUpdate:d,onClose:v,className:o.iFrame})))},D=n(59925),L=n(70242),R=n(50240),F=n(68198),M=n(80617),B=(0,P.n)({dialogSurface:(0,u.__assign)((0,u.__assign)({},_.Pt.padding("0 !important")),_.Pt.border("0 !important")),dialogBody:(0,u.__assign)((0,u.__assign)((0,u.__assign)({},_.Pt.padding("0 !important")),_.Pt.margin("0 !important")),{maxHeight:"calc(100vh - 32px) !important"}),dialogContent:(0,u.__assign)((0,u.__assign)((0,u.__assign)((0,u.__assign)({},_.Pt.padding("0 !important")),_.Pt.margin("0 !important")),_.Pt.gridArea(1,1,-1,-1)),{display:"flex"}),iFrame:{borderRadius:M.L.borderRadiusXLarge,maxHeight:"calc(100vh - 32px) !important"}}),U=function(){var e=B(),t=(0,u.__read)(h.useState(!0),2),n=t[0],r=t[1],o=h.useContext(S).cleanUp,i=h.useCallback((function(){r(!1),o()}),[o]),a=h.useCallback((function(e,t){return t.open||i()}),[i]);return h.createElement(D.l,{open:n,onOpenChange:a,modalType:"alert"},h.createElement(L.E,{className:e.dialogSurface},h.createElement(R.R,{className:e.dialogBody},h.createElement(F.C,{className:e.dialogContent},h.createElement(k,{onClose:i,className:e.iFrame})))))},z=n(82095),H=n(71951),G=(0,P.n)({drawerRoot:{width:"unset"},drawerBody:(0,u.__assign)((0,u.__assign)((0,u.__assign)({},_.Pt.margin("0 !important")),_.Pt.padding("0 !important")),{display:"flex",flexDirection:"column"})}),V=function(){var e=G(),t=(0,u.__read)(h.useState(!0),2),n=t[0],r=t[1],o=h.useContext(S).cleanUp,i=h.useCallback((function(){r(!1),o()}),[o]),a=h.useCallback((function(e,t){t.open||i()}),[i]);return h.createElement(z.e,{open:n,onOpenChange:a,position:"end",className:e.drawerRoot,modalType:"alert"},h.createElement(H.y,{className:e.drawerBody},h.createElement(k,{onClose:i})))},j=function(e){var t,n=e.fluentProviderElement;switch(null===(t=h.useContext(S).feedbackInitOptions.feedbackConfig)||void 0===t?void 0:t.feedbackUiType){case m.CS.IFrameWithinCallOut:return h.createElement(O,{mountNode:n.current});case m.CS.IFrameWithinSidePane:return h.createElement(V,null);case m.CS.IFrameWithinModal:default:return h.createElement(U,null)}},q=function(){var e,t,n=(0,h.useRef)(null),r=h.useContext(S).feedbackInitOptions;return h.createElement(v.q,{theme:null!==(t=null===(e=r.themeOptions)||void 0===e?void 0:e.v9Theme)&&void 0!==t?t:l.o,ref:n},h.createElement(j,{fluentProviderElement:n}))},W=function(e){var t=e.initializationInfo,n=e.feedbackInitOptions;return h.createElement(b,{initializationInfo:t,feedbackInitOptions:n},h.createElement(q,null))},Y=function(e){var t=e.hostName,n=e.locale,r=e.centroUrl,o=e.specificHvcVersion,i=e.majorVersion,a=e.centroHvcData,s=e.telemetryAppId,l=e.useCentroConfig,c={hostName:t,locale:n,appId:s,perfPrefix:"".concat(y._V,"_").concat(t),useCentroConfig:l},u={centroEnvironmentBaseUrl:null!=r?r:y.O4,preConfig:c,forHostVersion:null!=i?i:y.Pz,hvcVersion:"",centroHvcData:null!=a?a:"",enableUxVersionQueryParam:!0};return o?(u.hvcVersion=o,u.forHostVersion="",u):u};function Q(e,t){return(0,u.__awaiter)(this,void 0,void 0,(function(){var n,r,o,i,a,s,l,c,f,h,g;return(0,u.__generator)(this,(function(v){switch(v.label){case 0:return n=e.inAppFeedbackRef,r=e.hostName,o=e.locale,i=e.telemetryAppId,a=e.iFrameAppId,s="is a mandatory parameter",l=[],n||l.push("inAppFeedbackRef ".concat(s)),r||(l.push("hostName ".concat(s)),e.hostName="OcvFeedbackDemoHostingApp"),o||(l.push("locale ".concat(s)),e.locale="en"),i&&!y.$E.test(i)&&l.push("telemetryAppId needs to be GUID"),a||t.appId||l.push("either iFrameAppId or IFeedbackInitOptions.appId is mandatory"),(null===(f=t.themeOptions)||void 0===f?void 0:f.v9Theme)||l.push("themeOptions.v9Theme is mandatory for initializing feedback inside an iframe"),(S=null===(h=t.feedbackConfig)||void 0===h?void 0:h.feedbackUiType)&&[m.CS.IFrameWithinCallOut,m.CS.IFrameWithinModal,m.CS.IFrameWithinSidePane].includes(S)||l.push("Only feedbackUiTypes ".concat(m.CS.IFrameWithinSidePane,", ").concat(m.CS.IFrameWithinModal,", and ").concat(m.CS.IFrameWithinCallOut," are allowed")),l.length>0?[4,(0,d.n_)(Y(e))]:[3,2];case 1:throw v.sent(),function(e,t,n,r){throw(0,d.Rm)({id:e,type:d.JV.Error,message:"".concat(p,": ").concat(t),error:n,data:(0,u.__assign)((0,u.__assign)({},r),{timestamp:Date.now()})}),n}("533188","Iframe initialization parameter Error: ",c=new Error(JSON.stringify(l))),null===(g=e.onInitializationError)||void 0===g||g.call(e,c),c;case 2:return[2]}var S}))}))}var J=function(e,t){return(0,u.__awaiter)(void 0,void 0,void 0,(function(){var n,r;return(0,u.__generator)(this,(function(o){return f("533041","Request to to open feedback in an iframe",{clientFeedbackId:null!==(n=t.clientFeedbackId)&&void 0!==n?n:null}),Q(e,t),function(e,t){g.render(h.createElement(W,{feedbackInitOptions:t,initializationInfo:e},null),e.inAppFeedbackRef)}(e,t),f("533042","Feedback opened as an iframe",{clientFeedbackId:null!==(r=t.clientFeedbackId)&&void 0!==r?r:null}),[2]}))}))},X=n(33145);const K="AppChatCopilot",Z=e=>{switch(e){case o.CS.IFrameWithinCallOut:case o.CS.IFrameWithinModal:case o.CS.IFrameWithinSidePane:return o.CS.IFrameWithinCallOut;default:return o.CS.CallOut}},$=e=>{const t="inapp-feedback-element-id";let n;return e&&(n=document.getElementById(e)),n||(n=document.getElementById(t)),n||(n=document.createElement("div"),n.id=t,document.body.appendChild(n)),n},ee=(e,t,n)=>{if(e)return e;let r=`${t}Web`;switch(n){case"PC":r=`${t}Win32`;break;case"MAC":r=`${t}Mac`;break;case"IOS":r=`${t}iOS`}return r};var te=n(11099),ne=n(95044),re=n(62096),oe=n(24643),ie=n(38626),ae=n(96447),se=n(70110),le=n(78064);class ce{isFeatureGateEnabledFromClient(e){return(0,ne.cY)("Feature gate: ",e),!1}getNumberFeatureGateValueFromClient(e){return(0,ne.cY)("Feature gate: ",e),NaN}sendLoggingEventToClient(e,t){(0,ne.cY)("sendLoggingEventToClient: ",e),(0,ne.cY)("loggingEventArgs: ",t)}updateCopilotState(e){(0,ne.cY)("updateCopilotState: "+e)}feedbackButtonClicked(e,t,n,u,d,p){const f=ie.w.getFeedbackSettings(),h=te.U.getInstance().getIsFluxFlowEnabled(),g=d&&document.getElementById(d)?.innerText?document.getElementById(d).innerText:void 0;(0,se.$s)(t),f&&f.feedbackInitOptions?.appId&&(async({appData:e,featureAreaName:t="Copilot",inAppFeedbackRef:n,specificHvcVersion:u,majorVersion:d,feedbackInitOptions:p,ocvFeedbackHost:f,platform:h,appEnvironment:g=r.DEV,language:m="en",feedbackType:y,feedbackData:v,buttonTarget:S,isSydneyEnabled:C,aiResponseMessage:b,lightTheme:E,darkTheme:T,createAndSubmitFeedbackDataUploadSignal:w})=>{const I=(0,s.A)();p={...p,authenticationType:p?.authenticationType??o.sO.Unauthenticated,clientFeedbackId:I,clientName:f};const P=(0,X.$x)()===i.G.defaultWhite;E&&T?p.themeOptions=P?E:T:p.themeOptions||(p.themeOptions=E??{baseTheme:P?"WindowsLight":"WindowsDark",v9Theme:P?l.o:c.C}),void 0!==p.isProduction&&null!==p.isProduction||(p.isProduction=g===r.PRODUCTION),p.telemetry={...p.telemetry,featureArea:v?.feedbackArea??t,sourceContext:C?"CopilotChatFeedback":p.telemetry?.sourceContext,featureName:v?.contextData?.featureName,subFeatureName:v?.contextData?.subFeatureName,entryPoint:v?.contextData?.entryPoint,integrationSource:v?.contextData?.integrationSource};const _=v?.contextData?.feedbackCategory===a.E.Error?o.wd.AIError:y==o.MW.Smile?o.wd.AIThumbsUp:o.wd.AIThumbsDown;p.feedbackConfig={...p.feedbackConfig,appData:p.feedbackConfig?.appData??JSON.stringify(e),calloutTarget:S,featureAreas:void 0,feedbackForumUrl:void 0,feedbackUiType:Z(p.feedbackConfig?.feedbackUiType),initialFeedbackType:y,isDisplayed:!0,isFeedbackForumEnabled:void 0,isFileUploadEnabled:void 0,isMyFeedbackEnabled:void 0,isThankYouPageDisabled:!0,maxHeight:600,maxWidth:320,minHeight:void 0,minWidth:void 0,myFeedbackUrl:void 0,privacyUrl:void 0,retentionDurationDays:void 0,scenarioConfig:{isScenarioEnabled:!0,scenarioType:_},supportUrl:void 0,width:void 0,msInternalTitleTarget:void 0},p.userData={...p.userData,aiPrompt:v?.contextData?.feedbackContextData?.prompt,aiPromptId:v?.contextData?.feedbackContextData?.promptId,aiErrorType:v?.contextData?.feedbackContextData?.errorType,aiInteractionId:v?.contextData?.feedbackContextData?.interactionId,aiResponseMessage:v?.contextData?.feedbackContextData?.errorMessage??b,aiConversationId:v?.contextData?.feedbackContextData?.conversationId},p.feedbackConfig.diagnosticsConfig={...p.feedbackConfig.diagnosticsConfig,diagnosticsEndPoint:"ODS",diagnosticsUploadId:I,waitForDiagnosticsUpload:void 0,isShareContextDataEnabled:!0,getContextData:p.feedbackConfig.diagnosticsConfig?.getContextData??(async()=>{const e=new File([v?.contextData?.cardMetaData],"contextData.json",{type:"text/json"});return new Promise((t=>{t([e])}))})},!p.feedbackConfig?.tenantFeedbackServiceOptions?.useTenantFeedbackService&&w&&(p.feedbackConfig.diagnosticsConfig={...p.feedbackConfig.diagnosticsConfig,extractFeedbackDataForHost:e=>{w(JSON.stringify(e),ee(v?.contextData?.feedbackClientAppName,f,h))},isHostManagedContextDataEnabled:!0,isRetrieveFormDataEnabled:!0}),p.performanceTimestamps={invocationTimestamp:v?.invocationTimestamp,integrationInitTimestamp:Date.now()},p.feedbackConfig.feedbackUiType===o.CS.IFrameWithinCallOut?J({hostName:K,locale:m,inAppFeedbackRef:$(n),majorVersion:d,returnElementRef:S},p):await(0,o.LR)({hostName:K,locale:m,inAppFeedbackRef:$(n),specificHvcVersion:u,majorVersion:d},p)})({...f,feedbackData:t,ocvFeedbackHost:ie.w.getAppName(),platform:ie.w.getAppPlatform(),language:ie.w.getLanguage(),appEnvironment:ie.w.getEnvironment(),feedbackType:e==re.Gb.LIKE?o.MW.Smile:o.MW.Frown,appData:n??f.appData,buttonTarget:u,isSydneyEnabled:h,aiResponseMessage:this.isFeatureGateEnabledFromClient(oe.WT.ExtractContentFromCardForFeedback)?g:void 0,createAndSubmitFeedbackDataUploadSignal:this.isFeatureGateEnabledFromClient(oe.WT.EnableSendTenantFeedback)?(e,t)=>{(0,ae.W)(e,t,void 0,p)}:void 0}),(0,ne.cY)("feedbackButtonClicked: "+e),(0,ne.cY)("feedbackData: "+t),(0,ne.cY)("telemetryData: "+n)}async copyButtonClicked(e,t,n){(0,ne.cY)("Copy button clicked"),(0,le.Cu)(e),(0,ne.cY)("messageContentElementId: "+e),(0,ne.cY)("chatCardIndex: "+t),(0,ne.cY)("telemetryData: "+n)}getALSession(){throw new Error("Method not implemented.")}getHostSettings(){throw new Error("Method not implemented.")}getAuthToken(){throw new Error("Method not implemented.")}getPythonMode(){return!1}getIsAutoScrollingEnabled(){return!0}async shouldIgnoreResponse(e){return!1}async shouldSendRequestToAugloop(e,t,n,r){return(0,ne.cY)("shouldSendRequestToAugloop"),!0}getFeedbackData(){return{}}getOnClickHandler(e){return()=>{}}getCanvasSelection(){return Promise.resolve({})}getPreloadSignal(e){}}},30218:(e,t,n)=>{"use strict";n.d(t,{Sv:()=>l,WG:()=>o,l$:()=>a,wr:()=>s,y7:()=>i});var r=n(68383);const o=(0,r.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatLoadErrorHeader"),i=(0,r.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatLoadErrorText"),a=(0,r.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatGPTListLoadErrorText"),s=(0,r.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotExtensionChatInputPlaceholderText"),l=(0,r.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatGetAgentsText")},88358:(e,t,n)=>{"use strict";n.d(t,{UD:()=>g,WU:()=>l,YF:()=>h,YI:()=>u,_F:()=>m,cY:()=>s,jA:()=>a,xp:()=>c});var r=n(78854),o=n(58651);let i=!1;function a(e){i=e}const s=(e,t)=>{i&&(null==t?o.log("CopilotGPT Log:",e):o.log("CopilotGPT Log:",e,t))},l=e=>((new Date).getTime()-e)/1e3,c=(e,t,n)=>{const r={...t.chatUiProps,...e,suggestionPillsUiProps:{suggestionList:[]},chatInputV2Props:{...t.chatUiProps.chatInputV2Props,isImageInputButtonEnabled:!1,buttonProps:{groundingButtonEnabled:!1,ciqButtonEnabled:!1,menuButtonEnabled:!1},chatPlaceholderMessage:n}};return s("Updated Copilot Chat Props for GPTs",r),{...t,chatUiProps:r}},u=(e,t,n)=>{let r="";try{r=JSON.stringify({fetchedGPTListLength:e,isCopilotExtensibilityDisabledByAdmin:t,gptTypeRecorder:n})}catch(e){s("Error in stringifying data",e)}return r},d=e=>e.includes("ProjectedDeclarativeAgent.MessageExtension"),p=e=>e.includes("ProjectedDeclarativeAgent.PowerPlatform"),f=e=>e.includes("ProjectedDeclarativeAgent.DataVerse"),h=e=>d(e)||p(e)||f(e),g=e=>d(e)?r.zU.SearchMEProjectedAsDA:p(e)?r.zU.PPProjectedAsDA:f(e)?r.zU.DataVerseProjectedAsDA:r.zU.DeclarativeAgent,m=e=>{const t={[r.zU.SearchMEProjectedAsDA]:0,[r.zU.PPProjectedAsDA]:0,[r.zU.DataVerseProjectedAsDA]:0,[r.zU.DeclarativeAgent]:0};return e.reduce(((e,t)=>{const n=g(t.id);return e[n]=(e[n]||0)+1,e}),t)}},42850:(e,t,n)=>{"use strict";n.d(t,{dW:()=>a,eR:()=>i,iK:()=>o});var r=n(10020),o=function(e,t){return void 0===e&&(e=r.KJ.Production),void 0===t&&(t=!0),t?new URL("https://euc.designerapp.officeapps.live.com"):e===r.KJ.Dogfood?new URL("https://designerapp.edog.officeapps.live.com"):e===r.KJ.GCC?new URL("https://designerapp.gcc.osi.office365.us"):new URL("https://designerapp.officeapps.live.com")},i=function(e,t){return void 0===e&&(e=r.KJ.Production),void 0===t&&(t=!0),e===r.KJ.Dogfood?new URL('https://cdn.edog.designerapp.osi.office.net/mini-app/index.html?fgoverrideJSON={"Microsoft.Designer.MiniApp.WindowResizeThrottleIntervalInMS":20}'.concat(t?"&enableOnePrompt=true":"")):new URL("https://cdn.designerapp.osi.office.net/mini-app/index.html".concat(t?"?enableOnePrompt=true":""))},a="https://designerappservice.officeapps.live.com"},10020:(e,t,n)=>{"use strict";var r,o,i,a,s,l,c,u;n.d(t,{EW:()=>c,FR:()=>l,KJ:()=>i,lc:()=>u,lt:()=>s}),function(e){e.UploadImage="Upload an image",e.GenerateImage="Generate image"}(r||(r={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent"}(o||(o={})),function(e){e.Dogfood="dogfood",e.Production="production",e.GCC="gcc"}(i||(i={})),function(e){e.WordCopilotChat="WordCopilotChat",e.PowerPointCopilotChat="PowerPointCopilotChat",e.ExcelCopilotChat="ExcelCopilotChat",e.M365CopilotChat="M365CopilotChat",e.TestApp="MiniTestApp",e.DesignerSDKTestApp="Designer-SDK-TestApp"}(a||(a={})),function(e){e.Web="Web",e.Android="Android",e.iOS="iOS",e.MacOS="MacOS",e.Win32="Win32",e.WinRT="WinRT"}(s||(s={})),function(e){e.DallEImages="DallEImages",e.DesignSuggestions="DesignSuggestions"}(l||(l={})),function(e){e.Production="Production",e.Dogfood="Dogfood",e.Automation="Automation",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Other="Other"}(c||(c={})),function(e){e.CopilotMessage="fai-CopilotMessage",e.UserMessage="fai-UserMessage"}(u||(u={}))},47350:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});var r=n(33675),o=n(69020),i=n(58651);class a{constructor(){this.latestQueryId="",this.queryIdToSectionsMap=new Map,this.queryIdToSubscribersMap=new Map}static getInstance(){return a.instance||(a.instance=new a),a.instance}destroy(){this.clearMaps(),a.instance=null}clearMaps(){this.queryIdToSectionsMap.clear(),this.queryIdToSubscribersMap.clear()}getLatestQueryId(){return this.latestQueryId}getSectionById(e,t){const n=this.queryIdToSectionsMap.get(e);return n?this.findSectionById(n,t):void 0}findSectionById(e,t){for(const n of e){if(n.id===t)return n;const e=this.findSectionById(n.subSections||[],t);if(e)return e}}getSectionsByQueryId(e){return this.queryIdToSectionsMap.get(e)}addSections(e,t,n){n?this.addSectionsToParent(e,t,n):this.addSectionsToQuery(e,t)}addSectionsToParent(e,t,n){const r=this.getSectionById(e,n);r?r.subSections=(r.subSections||[]).concat(t):i.warn(`Parent section with ID ${n} not found.`)}addSectionsToQuery(e,t){const n=this.queryIdToSectionsMap.get(e);this.queryIdToSectionsMap.set(e,n?n.concat(t):t)}insertSections(e,t){e?(this.latestQueryId=e,this.queryIdToSectionsMap.set(e,t)):i.error("QueryId is empty")}subscribe(e,t){const n=this.queryIdToSubscribersMap.get(e)||[];n.push(t),this.queryIdToSubscribersMap.set(e,n)}unsubscribe(e,t){const n=this.queryIdToSubscribersMap.get(e)||[];this.queryIdToSubscribersMap.set(e,n.filter((e=>e!==t)))}updateSections(e,t){this.latestQueryId=e;const n=this.queryIdToSectionsMap.get(e);if(!n){i.error(`Sections not found for queryId ${e}`),i.info(`Adding new sections for queryId ${e}`);const n=t.map(o.tE);return void this.addSections(e,n)}const r=this.updateSectionsRecursively(n,t);this.queryIdToSectionsMap.set(e,r)}updateSectionsRecursively(e,t){return t.map((t=>{var n,i;const a=e.find((e=>e.id===t.id));if(!a){return(0,o.tE)(t)}return t.sectionState=a.sectionState===r.B.LOADING&&(null!==(i=null===(n=t.subSections)||void 0===n?void 0:n.length)&&void 0!==i?i:0)>0?r.B.OPENED:a.sectionState,t.timeStamp=a.timeStamp,t.subSections=this.updateSectionsRecursively(a.subSections||[],t.subSections||[]),t}))}notifySubscribers(e){const t=this.queryIdToSectionsMap.get(e)||[];(this.queryIdToSubscribersMap.get(e)||[]).forEach((n=>n(e,t)))}}},69020:(e,t,n)=>{"use strict";n.d(t,{Ar:()=>o,PQ:()=>i,tE:()=>r});const r=e=>{const t=Object.assign(Object.assign({},e),{timeStamp:Date.now()});return t.subSections&&(t.subSections=t.subSections.map(r)),t},o=(e,t,n=0)=>{const r=t.find((t=>t.id===e));if(r)return r.level!==n&&(r.level=n),r;for(const r of t)if(r.subSections){const t=o(e,r.subSections,n+1);if(t)return t}},i=(e,t=0)=>{const n=Array(10).fill(void 0);return a(e,t,n),n.filter((e=>void 0!==e))},a=(e,t,n)=>{if(!e.length)return;let r=1/0,o=-1/0;for(const i of e)void 0!==i.timeStamp&&(r=Math.min(r,i.timeStamp),o=Math.max(o,i.timeStamp)),i.subSections&&a(i.subSections,t+1,n);r!==1/0&&o!==-1/0&&(n[t]?(n[t].LevelStartTimestamp=Math.min(n[t].LevelStartTimestamp,r),n[t].LevelEndTimestamp=Math.max(n[t].LevelEndTimestamp,o)):n[t]={LevelNumber:t,LevelStartTimestamp:r,LevelEndTimestamp:o})}},96578:(e,t,n)=>{"use strict";n.d(t,{$q:()=>v,A0:()=>h,NY:()=>c,Qt:()=>g,UM:()=>u,Vh:()=>d,it:()=>f,kr:()=>a,r9:()=>l,tn:()=>s,vX:()=>m,yb:()=>y,z_:()=>p});var r=n(78461),o=n(30218),i=n(78854);const a="CopilotSwitcherMenuContainer",s=[i.NV.ClientProvided,i.NV.Agent],l="copilotChat",c="GetCopilotExtensions",u="GetMosCopilotExtensions",d="https://go.microsoft.com/fwlink/?linkid=2271054",p=16,f=8,h=1e3,g=e=>{const t=(0,r.Lh)(o.WG),n=e??"this agent";return t?`${t} ${n}`:`Unable to load ${n}`},m=()=>{const e=(0,r.Lh)(o.y7);return e||"Please try reopening via the menu or switch to a different agent"},y=()=>{const e=(0,r.Lh)(o.l$);return e||"Some extensions failed to load. Try relaunching Copilot."},v=()=>{const e=(0,r.Lh)(o.Sv);return e||"Get Agents"}},78854:(e,t,n)=>{"use strict";var r,o;n.d(t,{NV:()=>r,p8:()=>i,zU:()=>o}),function(e){e.Default="Default",e.CustomGPT="CustomGPT",e.Agent="Agent",e.ClientProvided="ClientProvided"}(r||(r={})),function(e){e.SearchMEProjectedAsDA="Search_ME_Projected_As_DA",e.PPProjectedAsDA="PP_Projected_As_DA",e.DataVerseProjectedAsDA="DV_Projected_As_DA",e.DeclarativeAgent="Declarative_Agent"}(o||(o={}));const i={[r.Default]:0,[r.ClientProvided]:1,[r.CustomGPT]:2,[r.Agent]:3}},54108:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var r=new(n(6115).H)({iteration:0})},71951:(e,t,n)=>{"use strict";n.d(t,{y:()=>E});var r=n(8520),o=n(18331),i=n(61713),a=n(18671);const s=e=>(e(0),0),l=e=>e;var c=n(85382),u=n(35819),d=n(78277),p=n(15498),f=n(284),h=n(53787);const g=(e,t)=>{const{setScrollState:n}=(0,h.ls)(),o=r.useRef(null),[g,m]=function(){const{targetDocument:e}=(0,a.Y)(),t=null==e?void 0:e.defaultView,n=t?t.requestAnimationFrame:s,r=t?t.cancelAnimationFrame:l;return(0,i.X)(n,r)}(),y=r.useCallback((()=>{o.current&&n((({scrollTop:e,scrollHeight:t,clientHeight:n})=>t<=n?"none":0===e?"top":e+n===t?"bottom":"middle")(o.current))}),[n]),v=r.useCallback((()=>{m(),g((()=>y()))}),[m,g,y]);return(0,c.E)((()=>{y()}),[e.children,y]),(0,c.E)((()=>(y(),()=>m())),[m,y]),{components:{root:"div"},root:u.Gk((0,d.g)("div",{ref:(0,p.a)(t,o),...e,onScroll:(0,f.p)(e.onScroll,v)}),{elementType:"div"})}};var m=n(19615),y=n(39900);var v=n(96641),S=n(30112);const C="fui-DrawerBody",b=(0,v.y)("ri6rvx7",null,[".ri6rvx7{padding:0 var(--spacingHorizontalXXL);flex:1;align-self:stretch;position:relative;z-index:1;overflow:auto;}",".ri6rvx7:last-child{padding-bottom:calc(var(--spacingHorizontalXXL) + 1px);}",".ri6rvx7:first-child{padding-top:calc(var(--spacingHorizontalXXL) + 1px);}"]),E=r.forwardRef(((e,t)=>{const n=g(e,t);return(e=>{const t=b();e.root.className=(0,S.z)(C,t,e.root.className)})(n),(0,o.$e)("useDrawerBodyStyles_unstable")(n),(e=>((0,y.C)(e),(0,m.Y)(e.root,{})))(n)}));E.displayName="DrawerBody"},82095:(e,t,n)=>{"use strict";n.d(t,{e:()=>B});var r=n(8520),o=n(18331),i=n(53787),a=n(59925),s=n(35819),l=n(18671),c=n(7894),u=n(23162),d=n(84080),p=n(80617),f=n(90166),h=n(30112);const g="--fui-Drawer--size",m=(p.L.colorNeutralBackground1,p.L.colorNeutralForeground1,(0,f.X)({start:{h3c5rm:0,vrafjx:0,Bekrc4i:0,u1mtju:["f1xteiwb","fsqykmd"],oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["fvfyk4","frppm18"]},end:{zhjwy3:0,wvpqe5:0,ibv6hh:0,B4g9neb:["fsqykmd","f1xteiwb"],j35jbq:["f1e31b4d","f1vgc2s3"],oyh7mz:["frppm18","fvfyk4"]},bottom:{B5kzvoi:"f1yab3r1",Bhzewxz:"f198g47y"},small:{Bjr0ffy:"f1exhnwo"},medium:{Bjr0ffy:"fqofjzu"},large:{Bjr0ffy:"fce6y3m"},full:{Bjr0ffy:"fsdmzs6"}},{d:[[".f1xteiwb{border-right:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],[".fsqykmd{border-left:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".fvfyk4{right:auto;}",".frppm18{left:auto;}",[".fsqykmd{border-left:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],[".f1xteiwb{border-right:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],".f1yab3r1{bottom:0;}",".f198g47y{top:auto;}",".f1exhnwo{--fui-Drawer--size:320px;}",".fqofjzu{--fui-Drawer--size:592px;}",".fce6y3m{--fui-Drawer--size:940px;}",".fsdmzs6{--fui-Drawer--size:100vw;}"]})),y=(0,f.X)({small:{Bjr0ffy:"f1exhnwo"},medium:{Bjr0ffy:"fqofjzu"},large:{Bjr0ffy:"fce6y3m"},full:{Bjr0ffy:"f1rat34m"}},{d:[".f1exhnwo{--fui-Drawer--size:320px;}",".fqofjzu{--fui-Drawer--size:592px;}",".fce6y3m{--fui-Drawer--size:940px;}",".f1rat34m{--fui-Drawer--size:100%;}"]}),v={small:u.TV.durationGentle,medium:u.TV.durationSlow,large:u.TV.durationSlower,full:u.TV.durationUltraSlow};function S(e,t,n){const r=`translate3d(var(${t}), 0, 0)`,o=`translate3d(calc(var(${t}) * -1), 0, 0)`;return"start"===e?"ltr"===n?o:r:"end"===e?"ltr"===n?r:o:"bottom"===e?`translate3d(0, var(${t}), 0)`:"translate3d(0, 0, 0)"}(0,d.$)((({position:e,size:t,dir:n})=>{const r=[{transform:S(e,g,n),opacity:0},{transform:"translate3d(0, 0, 0)",opacity:1}],o=v[t];return{enter:{keyframes:r,duration:o,easing:u.TV.curveDecelerateMid},exit:{keyframes:[...r].reverse(),duration:o,easing:u.TV.curveAccelerateMin}}}));const C=(0,d.$)((({position:e,size:t,dir:n})=>{const r=[{transform:S(e,g,n),boxShadow:`0px ${p.L.colorTransparentBackground}`,opacity:0},{transform:"translate3d(0, 0, 0)",boxShadow:p.L.shadow64,opacity:1}],o=v[t];return{enter:{keyframes:r,duration:o,easing:u.TV.curveDecelerateMid},exit:{keyframes:[...r].reverse(),duration:o,easing:u.TV.curveAccelerateMin}}})),b=(0,d.$)((({size:e})=>{const t=[{opacity:0},{opacity:1}],n=v[e];return{enter:{keyframes:t,easing:u.TV.curveLinear,duration:n},exit:{keyframes:[...t].reverse(),easing:u.TV.curveLinear,duration:n}}}));var E=n(74135),T=n(34669),w=n(84749),I=n(96641);const P=(0,I.y)("rmnljus",null,[".rmnljus{inset:0px;position:fixed;background-color:rgba(0, 0, 0, 0.4);}"]),_=(0,f.X)({nested:{De3pzq:"f1c21dwh"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}"]}),A=r.forwardRef(((e,t)=>{const n=(0,E.W)({...e,as:e.as},t),r=(0,T.l)(n);return(e=>{const t=P(),n=_();e.backdrop&&(e.backdrop.className=(0,h.z)(t,e.isNestedDialog&&n.nested,e.backdrop.className))})(n),(0,w.V)(n,r)}));function k(e,t,n){return null===e?null:{...e,children:(o,i)=>(null==e?void 0:e.children)?e.children(t,{...i,...n}):r.createElement(t,{...i,...n},i.children)}}A.displayName="OverlayDrawerSurface";const x={active:!0,canRender:!0,ref:r.createRef(),type:"idle"};var N=n(19615),O=n(39900);const D="fui-OverlayDrawer",L="fui-OverlayDrawer__backdrop",R=(0,I.y)("r7dfyj8","rmx02j7",{r:[".r7dfyj8{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:fixed;top:0;bottom:0;}",".r7dfyj8:focus{outline-style:none;}",".r7dfyj8:focus-visible{outline-style:none;}",".r7dfyj8[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.r7dfyj8[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".rmx02j7{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:fixed;top:0;bottom:0;}",".rmx02j7:focus{outline-style:none;}",".rmx02j7:focus-visible{outline-style:none;}",".rmx02j7[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.rmx02j7[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:["@media (forced-colors: active){.r7dfyj8[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}","@media (forced-colors: active){.rmx02j7[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),F=(0,f.X)({start:{},end:{},bottom:{Bhzewxz:"f198g47y",Bqenvij:"fub80nq",a9b677:"fr97h3j"},absolute:{qhf8xq:"f1euv43f"}},{d:[".f198g47y{top:auto;}",".fub80nq{height:var(--fui-Drawer--size);}",".fr97h3j{width:100vw;}",".f1euv43f{position:absolute;}"]}),M=e=>{const t=(({position:e,size:t})=>{const n=m(),r=y();return(0,h.z)(n[e],"bottom"===e&&r[t],"bottom"!==e&&n[t])})(e),n=R(),r=F(),o=e.hasMountNodeElement&&r.absolute,i=e.root.backdrop;return e.root.className=(0,h.z)(D,t,n,r[e.position],o,e.root.className),i&&(i.className=(0,h.z)(L,o,i.className)),e},B=r.forwardRef(((e,t)=>{const n=((e,t)=>{const{open:n,size:r,position:o}=function(e){const{open:t=!1,size:n="small",position:r="start"}=e;return{size:n,position:r,open:t}}(e),{backdropMotion:i,modalType:u="modal",inertTrapFocus:d,onOpenChange:p,surfaceMotion:f,mountNode:h}=e,{dir:g,targetDocument:m}=(0,l.Y)(),{element:y}=(0,c.h)(h),v=Boolean(y&&(null==m?void 0:m.body)!==y),S=s.Gf(e.backdrop),E="non-modal"!==u&&null!==S,T=s.Gk({...e,ref:t,backdrop:E?{...S}:null,backdropMotion:k(i,b,{size:r})},{elementType:A}),w=s.Gk({open:n,onOpenChange:p,inertTrapFocus:d,modalType:u,surfaceMotion:k(f,C,{position:o,size:r,dir:g}),children:null},{elementType:a.l});return{components:{root:A,dialog:a.l},root:T,dialog:w,open:n,size:r,position:o,hasMountNodeElement:v,mountNode:h,motion:x}})(e,t),r=(0,i.X3)();return M(n),(0,o.$e)("useDrawerOverlayStyles_unstable")(n),(0,o.$e)("useOverlayDrawerStyles_unstable")(n),((e,t)=>((0,O.C)(e),(0,N.Y)(i.Th,{value:t,children:(0,N.Y)(e.dialog,{children:(0,N.Y)(e.root,{})})})))(n,r)}));B.displayName="OverlayDrawer"},53787:(e,t,n)=>{"use strict";n.d(t,{Th:()=>a,X3:()=>l,ls:()=>s});var r=n(8520);const o={scrollState:"none",setScrollState:()=>({})},i=r.createContext(void 0),a=i.Provider,s=()=>{var e;return null!==(e=r.useContext(i))&&void 0!==e?e:o},l=()=>{const[e,t]=r.useState("none");return{setScrollState:t,scrollState:e}}},56350:(e,t,n)=>{"use strict";n.d(t,{JV:()=>o.JV,Px:()=>r.Px,Rm:()=>i.Rm,n_:()=>r.n_,sz:()=>r.sz});var r=n(87362),o=(n(38739),n(57996),n(13470)),i=n(34696);n(58096)},23842:(e,t,n)=>{"use strict";n.d(t,{n:()=>u});var r=n(79490),o=n(58651);function i(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function a(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,new Promise((function(r,o){var a=t.createElement("script");(null==n?void 0:n.createScriptURL)?a.src=n.createScriptURL(e.content):a.src=e.content,a.onload=function(){r()},a.onerror=function(){o(new Error("Dynamically loading script "+e.content+" failed"))},i(a,e.attributes),t.body.appendChild(a)}))]}))}))}function s(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n){var r=t.createElement("script"),o=t.createTextNode(e.content);r.appendChild(o),i(r,e.attributes),t.body.appendChild(r),n()}))]}))}))}function l(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=e.content,r.onload=function(){t()},r.onerror=function(){n(new Error("Dynamically loading style "+e.content+" failed"))},i(r,e.attributes),document.head.appendChild(r)}))]}))}))}function c(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var r=document.createTextNode(e.content);n.appendChild(r),i(n,e.attributes),document.head.appendChild(n),t()}))]}))}))}function u(e,t,n){return void 0===n&&(n=document),(0,r.__awaiter)(this,void 0,void 0,(function(){var i,d,p,f,h,g,m;return(0,r.__generator)(this,(function(y){switch(y.label){case 0:switch(e.type){case"parallel":return[3,1];case"sequential":return[3,5];case"scriptUrl":return[3,16];case"script":return[3,18];case"styleUrl":return[3,20];case"style":return[3,22]}return[3,24];case 1:return y.trys.push([1,3,,4]),[4,Promise.all(e.children.map((function(e){return u(e,t)})))];case 2:return y.sent(),[3,4];case 3:if(i=y.sent(),!e.optional)throw i;return o.log("Dynamic loading of optional script failed",i),[3,4];case 4:return[2];case 5:y.trys.push([5,14,,15]),y.label=6;case 6:y.trys.push([6,11,12,13]),d=(0,r.__values)(e.children),p=d.next(),y.label=7;case 7:return p.done?[3,10]:[4,u(p.value,t)];case 8:y.sent(),y.label=9;case 9:return p=d.next(),[3,7];case 10:return[3,13];case 11:return f=y.sent(),g={error:f},[3,13];case 12:try{p&&!p.done&&(m=d.return)&&m.call(d)}finally{if(g)throw g.error}return[7];case 13:return[3,15];case 14:if(h=y.sent(),!e.optional)throw h;return o.log("Dynamic loading of optional script failed",h),[3,15];case 15:return[2];case 16:return[4,a(e,n,t)];case 17:return y.sent(),[2];case 18:return[4,s(e,n)];case 19:return y.sent(),[2];case 20:return[4,l(e)];case 21:return y.sent(),[2];case 22:return[4,c(e)];case 23:return y.sent(),[2];case 24:throw new Error("Invalid script loader object "+JSON.stringify(e))}}))}))}},56303:(e,t,n)=>{"use strict";n.d(t,{Kx:()=>d,J8:()=>p});var r=n(79490),o=(n(40544),void 0);var i=n(13470);n(34696);function a(e){var t=e;try{"string"==typeof e&&(t=(t=t.replaceAll(/[a-zA-Z0-9_\-'.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/g,"<upn>").replaceAll(/[a-zA-Z0-9_\-'.]+%40[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/g,"<upn>")).replaceAll(/eyJ0eX[A-Za-z0-9-_]+\.+[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=/]+/g,"<token>").replaceAll(/eyJhbG[A-Za-z0-9-_]+\.+[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=/]+/g,"<token>"))}catch(e){}return t}var s,l=n(58651);!function(e){e[e.Trace=0]="Trace",e[e.Info=1]="Info",e[e.Comment=2]="Comment",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(s||(s={}));var c=526460,u=!0;function d(e,t,n,d){var p=[],f=Promise.resolve(),h=0,g=e,m=t,y=n,v=d,S=!1,C=function(){0===p.length||u?S=!1:(S=!0,setTimeout((function(){b().catch((function(){}))}),1e3))},b=function(){return 0===p.length||u?(C(),Promise.resolve()):(f=new Promise((function(e,t){var n=new XMLHttpRequest;n.open("POST",m,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("x-ms-mac-hostingapp",y),n.setRequestHeader("x-ms-mac-appid",g),n.setRequestHeader("x-ms-mac-version",v),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(204!==n.status){var r=new Error("Request to /api/instrument/logclient failed, server responseCode: "+n.status+" body: "+n.response);return l.log(r),void t(r)}e()}};var r=p.splice(0,p.length);n.send(JSON.stringify(r))}))).then(C)};C();var E=function(e){p.push(e),S||C()};return{logger:function(e){if(!((0,i.fs)(e)||(0,i.pi)(e)||(0,i.Rj)(e))){h+=1;var t="",n="";try{if(null!==(t=function(){if(void 0===o)throw new Error("History object has not been set");return o}().location.pathname)&&-1!==t.indexOf(":")){var r=t.split(":");t=r[0],n=r[1]}}catch(e){t="",n=""}if((0,i.lf)(e))E({TagId:c,LogLevel:s.Info,LogCategory:i.nh.ClientAnalytics,Message:"UI Flight: "+e.flightName,Adhoc0:e.flightName,Adhoc1:JSON.stringify(e.flightData),Adhoc2:a(JSON.stringify(e.data)),Adhoc3:h.toString(),Adhoc5:a(n),PageName:a(t)});else{var l=parseInt(e.id,10);if(E({TagId:l,LogLevel:s.Info,LogCategory:e.logCategory||i.nh.ClientInfo,Message:a(e.message||""),Adhoc0:g,Adhoc1:h.toString(),Adhoc2:a(JSON.stringify({data:e.data})),Adhoc5:a(n),PageName:a(t)}),(0,i.bJ)(e)){var u=e.error.stack||"";E({TagId:500781,LogLevel:s.Error,LogCategory:e.logCategory||i.nh.ClientError,Message:a("UI Exception: "+(e.error.message||"")),Adhoc0:g,Adhoc1:h.toString(),Adhoc2:a(JSON.stringify({version:v,stack:u})),Adhoc3:l.toString(),Adhoc5:a(n),PageName:a(t)})}}}},flush:function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,Promise.all([f,b()]).then((function(){}))]}))}))}}}function p(){u=!1}},33144:(e,t,n)=>{"use strict";n.d(t,{LR:()=>p});var r,o,i=n(79490),a=n(56350),s=n(24883),l=n(3518),c=n(82050),u=n(8419),d=(r={},o=[],{register:function(e){return e&&o.push(e),r},unregister:function(e){var t=o.indexOf(e);t>-1&&o.splice(t,1)},updateFeedbackObject:function(e){var t=(0,s.r)({},r,e);t=(0,u.UZ)(t),o.forEach((function(e){return e(t)}))},openFeedbackObject:function(e){e.feedbackConfig.isDisplayed=!0,e=(0,u.UZ)(e),o.forEach((function(t){return t(e)}))}}),p=function(e,t){return(0,i.__awaiter)(void 0,void 0,void 0,(function(){var n,r,o,a,s,d,p,f,g,m,y;return(0,i.__generator)(this,(function(v){switch(v.label){case 0:return t.performanceTimestamps=(0,i.__assign)((0,i.__assign)({},t.performanceTimestamps),{integrationInitTimestamp:Date.now(),useCentroConfig:e.useCentroConfig,isPrefetched:null===(a=window.__inappfeedback_centro_integration_config)||void 0===a?void 0:a.isPrefetched}),[4,(0,u.fi)(e)];case 1:return v.sent(),h(),(null===(s=window.__inappfeedback_centro_integration_config)||void 0===s?void 0:s.unmountFunction)&&window.__inappfeedback_centro_integration_config.unmountFunction(),[4,window.__inappfeedback_centro_integration_config.loadInAppFeedbackPackage(e,null==t?void 0:t.clientFeedbackId)];case 2:v.sent(),v.label=3;case 3:return v.trys.push([3,6,,7]),(0,c.fH)("532392","DOM Bootstrap Started.",{clientFeedbackId:null!==(d=null==t?void 0:t.clientFeedbackId)&&void 0!==d?d:null,isPrefetched:null===(p=window.__inappfeedback_centro_integration_config)||void 0===p?void 0:p.isPrefetched}),[4,window.__inappfeedback_centro_integration_config.bootstrapFeature({featureName:l.Cw})];case 4:return n=v.sent(),r=window.__inappfeedback_centro_integration_config,[4,n.main(e.inAppFeedbackRef)];case 5:return r.unmountFunction=v.sent(),(0,c.fH)("532392","DOM Bootstrap Completed."),[3,7];case 6:return o=v.sent(),(0,c.vV)("532385","Centro DOM bootstrap failed",o,{hostName:e.hostName,locale:e.locale,inAppFeedbackRefAvailable:!!e.inAppFeedbackRef,specificHvcVersion:null!==(f=e.specificHvcVersion)&&void 0!==f?f:null,majorVersion:null!==(g=e.majorVersion)&&void 0!==g?g:null,centroUrl:null!==(m=e.centroUrl)&&void 0!==m?m:null}),[3,7];case 7:return(0,c.fH)("532386","InAppFeedback Component Initialization Completed."),null===(y=window.__inappfeedback_centro_integration_config)||void 0===y||y.openFeedback(t),[2]}}))}))};function f(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function(){var n,r,o,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,(0,a.n_)((0,u.s1)(e)).catch((function(t){var n,r,o;(0,c.vV)("532383","Centro initialize failed",t,{hostName:e.hostName,locale:e.locale,inAppFeedbackRefAvailable:!!e.inAppFeedbackRef,specificHvcVersion:null!==(n=e.specificHvcVersion)&&void 0!==n?n:null,majorVersion:null!==(r=e.majorVersion)&&void 0!==r?r:null,centroUrl:null!==(o=e.centroUrl)&&void 0!==o?o:null})}))];case 1:return i.sent(),(0,c.fH)("532444","Centro Runtime Initialization Completed.",{clientFeedbackId:null!=t?t:null,isPrefetched:null!==(s=null===(o=window.__inappfeedback_centro_integration_config)||void 0===o?void 0:o.isPrefetched)&&void 0!==s&&s}),n={dataSources:function(e){e(l.xx,d)}},r={featureName:l.Cw,adapters:n},(0,c.fH)("532448","Centro preloadFeature Started."),[4,(0,a.sz)(r).catch((function(t){var n,r,o;(0,c.vV)("532384","centro preloadFeature failed",t,{hostName:e.hostName,locale:e.locale,inAppFeedbackRefAvailable:!!e.inAppFeedbackRef,specificHvcVersion:null!==(n=e.specificHvcVersion)&&void 0!==n?n:null,majorVersion:null!==(r=e.majorVersion)&&void 0!==r?r:null,centroUrl:null!==(o=e.centroUrl)&&void 0!==o?o:null})}))];case 2:return i.sent(),(0,c.fH)("532449","Centro preloadFeature Completed."),[2]}}))}))}var h=function(){window.__inappfeedback_centro_integration_config||(window.__inappfeedback_centro_integration_config={updateFeedbackOptions:d.updateFeedbackObject,openFeedback:d.openFeedbackObject,logInfo:c.fH,logError:c.vV,unmountFunction:function(){},bootstrapFeature:a.Px,loadInAppFeedbackPackage:f,isPrefetched:!1})}},82050:(e,t,n)=>{"use strict";n.d(t,{fH:()=>s,vV:()=>a});var r=n(79490),o=n(56350),i=n(3518);function a(e,t,n,a){throw(0,o.Rm)({id:e,type:o.JV.Error,message:"".concat(i.Q3,": ").concat(t),error:n,data:(0,r.__assign)((0,r.__assign)({},a),{timestamp:Date.now()})}),n}function s(e,t,n){(0,o.Rm)({id:e,type:o.JV.Info,message:"".concat(i.Q3,": ").concat(t),data:(0,r.__assign)((0,r.__assign)({},n),{timestamp:Date.now()})})}},93127:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0,function(e){e.Automatic="automatic",e.Manual="manual"}(t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var o=function(e,t){this.code=e,this.message=t};t.ActivityRequestError=o;var i=function(e){this.request=e};t.ActivityResponse=i;var a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.request=t,r.rawContent=n,r}return r(t,e),t}(i);t.SuccessResponse=a;var s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.request=t,r.error=n,r}return r(t,e),t}(i);t.ErrorResponse=s;var l=function(e){function t(t,n){var r=e.call(this,t)||this;r.request=t,r._auth=n;for(var o=0,i=r._auth.buttons;o<i.length;o++){var a=i[o];if("signin"===a.type&&void 0!==a.value)try{new URL(a.value),r.signinButton=a;break}catch(e){}}return r}return r(t,e),Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:!1,configurable:!0}),t}(i);t.LoginRequestResponse=l},86821:function(e,t,n){"use strict";var r=n(58651),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveApplet=void 0;var a=n(91654),s=n(96765),l=n(27583),c=n(93127),u=n(42510),d=n(6856),p=n(65120);function f(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(l.GlobalSettings.applets.logEnabled)if(l.GlobalSettings.applets.onLogEvent)l.GlobalSettings.applets.onLogEvent(e,t,n);else switch(e){case a.LogLevel.Warning:r.warn(t,n);break;case a.LogLevel.Error:r.error(t,n);break;default:r.log(t,n)}}var h=function(){function e(e,t,n){this.action=e,this.trigger=t,this.consecutiveRefreshes=n,this.attemptNumber=0}return e.prototype.retryAsync=function(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return this.onSend&&this.onSend(this),[2]}))}))},e}(),g=function(){function e(){this._allowAutomaticCardUpdate=!1,this.renderedElement=document.createElement("div"),this.renderedElement.className="aaf-cardHost",this.renderedElement.style.position="relative",this.renderedElement.style.display="flex",this.renderedElement.style.flexDirection="column",this._cardHostElement=document.createElement("div"),this._refreshButtonHostElement=document.createElement("div"),this._refreshButtonHostElement.className="aaf-refreshButtonHost",this._refreshButtonHostElement.style.display="none",this.renderedElement.appendChild(this._cardHostElement),this.renderedElement.appendChild(this._refreshButtonHostElement)}return e.prototype.displayCard=function(e){if(!e.renderedElement)throw new Error("displayCard: undefined card.");s.clearElementChildren(this._cardHostElement),this._refreshButtonHostElement.style.display="none",this._cardHostElement.appendChild(e.renderedElement)},e.prototype.showManualRefreshButton=function(e){var t=this;if(!this.onShowManualRefreshButton||this.onShowManualRefreshButton(this)){this._refreshButtonHostElement.style.display="none";var n=void 0;if(this.onRenderManualRefreshButton)n=this.onRenderManualRefreshButton(this);else{var r=u.Strings.runtime.refreshThisCard();if(l.GlobalSettings.applets.refresh.mode===a.RefreshMode.Automatic){var o=u.Strings.runtime.automaticRefreshPaused();" "!==o[o.length-1]&&(o+=" "),r=u.Strings.runtime.clckToRestartAutomaticRefresh()}var i={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:r,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]},f=new d.AdaptiveCard;f.parse(i,new d.SerializationContext(p.Versions.v1_2)),f.onExecuteAction=function(n){"refreshCard"===n.id&&(s.clearElementChildren(t._refreshButtonHostElement),t.internalExecuteAction(e,c.ActivityRequestTrigger.Automatic,0))},n=f.render()}n&&(s.clearElementChildren(this._refreshButtonHostElement),this._refreshButtonHostElement.appendChild(n),this._refreshButtonHostElement.style.removeProperty("display"))}},e.prototype.createActivityRequest=function(e,t,n){var r=this;if(this.card){var o=new h(e,t,n);return o.onSend=function(e){e.attemptNumber++,r.internalSendActivityRequestAsync(o)},!!this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,o,e)?void 0:o}throw new Error("createActivityRequest: no card has been set.")},e.prototype.createMagicCodeInputCard=function(t){var n={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:1===t?void 0:"That didn't work... let's try again.",wrap:!0,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:!0,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:e.submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:e.cancelMagicCodeAuthActionId,title:"Cancel"}]}]},r=new d.AdaptiveCard;return r.parse(n),r},e.prototype.cancelAutomaticRefresh=function(){this._allowAutomaticCardUpdate&&f(a.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card."),this._allowAutomaticCardUpdate=!1},e.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new d.SerializationContext},e.prototype.internalSetCard=function(e,t){var n=this;if("object"==typeof e&&"AdaptiveCard"===e.type&&(this._cardPayload=e),this._cardPayload)try{var r=new d.AdaptiveCard;this.hostConfig&&(r.hostConfig=this.hostConfig);var o=this.createSerializationContext();if(r.parse(this._cardPayload,o),(!this.onCardChanging||this.onCardChanging(this,this._cardPayload))&&(this._card=r,this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken&&this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource),this._card.onExecuteAction=function(e){n.cancelAutomaticRefresh(),n.internalExecuteAction(e,c.ActivityRequestTrigger.Manual,0)},this._card.onInputValueChanged=function(e){n.cancelAutomaticRefresh()},this._card.render(),this._card.renderedElement&&(this.displayCard(this._card),this.onCardChanged&&this.onCardChanged(this),this._card.refresh)))if(l.GlobalSettings.applets.refresh.mode===a.RefreshMode.Automatic&&t<l.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes)if(l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0)f(a.LogLevel.Info,"Triggering automatic card refresh number "+(t+1)),this.internalExecuteAction(this._card.refresh.action,c.ActivityRequestTrigger.Automatic,t+1);else{f(a.LogLevel.Info,"Scheduling automatic card refresh number "+(t+1)+" in "+l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var i=this._card.refresh.action;this._allowAutomaticCardUpdate=!0,window.setTimeout((function(){n._allowAutomaticCardUpdate&&n.internalExecuteAction(i,c.ActivityRequestTrigger.Automatic,t+1)}),l.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}else l.GlobalSettings.applets.refresh.mode!==a.RefreshMode.Disabled&&(f(a.LogLevel.Warning,t>0?"Stopping automatic refreshes after "+t+" consecutive refreshes.":"The card has a refresh section, but automatic refreshes are disabled."),(l.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||l.GlobalSettings.applets.refresh.mode===a.RefreshMode.Manual)&&(f(a.LogLevel.Info,"Showing manual refresh button."),this.showManualRefreshButton(this._card.refresh.action)))}catch(e){f(a.LogLevel.Error,"setCard: "+e)}},e.prototype.internalExecuteAction=function(e,t,n){if(e instanceof d.ExecuteAction){if(!this.channelAdapter)throw new Error("internalExecuteAction: No channel adapter set.");var r=this.createActivityRequest(e,t,n);r&&r.retryAsync()}this.onAction&&this.onAction(this,e)},e.prototype.createProgressOverlay=function(e){if(!this._progressOverlay)if(this.onCreateProgressOverlay)this._progressOverlay=this.onCreateProgressOverlay(this,e);else{this._progressOverlay=document.createElement("div"),this._progressOverlay.className="aaf-progress-overlay";var t=document.createElement("div");t.className="aaf-spinner",t.style.width="28px",t.style.height="28px",this._progressOverlay.appendChild(t)}return this._progressOverlay},e.prototype.removeProgressOverlay=function(e){this.onRemoveProgressOverlay&&this.onRemoveProgressOverlay(this,e),void 0!==this._progressOverlay&&(this.renderedElement.removeChild(this._progressOverlay),this._progressOverlay=void 0)},e.prototype.activityRequestSucceeded=function(e,t){this.onActivityRequestSucceeded&&this.onActivityRequestSucceeded(this,e,t)},e.prototype.activityRequestFailed=function(e){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,e):l.GlobalSettings.applets.defaultTimeBetweenRetryAttempts},e.prototype.showAuthCodeInputDialog=function(t){var n=this;if(!this.onShowAuthCodeInputDialog||this.onShowAuthCodeInputDialog(this,t)){var r=this.createMagicCodeInputCard(t.attemptNumber);r.render(),r.onExecuteAction=function(r){if(n.card&&r instanceof d.SubmitAction)switch(r.id){case e.submitMagicCodeActionId:var o=void 0;r.data&&"string"==typeof r.data.magicCode&&(o=r.data.magicCode),o?(n.displayCard(n.card),t.authCode=o,t.retryAsync()):alert("Please enter the magic code you received.");break;case e.cancelMagicCodeAuthActionId:f(a.LogLevel.Warning,"Authentication cancelled by user."),n.displayCard(n.card);break;default:f(a.LogLevel.Error,"Unespected action taken from magic code input card (id = "+r.id+")"),alert(u.Strings.magicCodeInputCard.somethingWentWrong())}},this.displayCard(r)}},e.prototype.internalSendActivityRequestAsync=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o;return i(this,(function(s){switch(s.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(t=this.createProgressOverlay(e))&&this.renderedElement.appendChild(t),n=!1,r=function(){var t,r,s,d,p,h,g;return i(this,(function(i){switch(i.label){case 0:t=void 0,1===e.attemptNumber?f(a.LogLevel.Info,"Sending activity request to channel (attempt "+e.attemptNumber+")"):f(a.LogLevel.Info,"Re-sending activity request to channel (attempt "+e.attemptNumber+")"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.channelAdapter.sendRequestAsync(e)];case 2:return t=i.sent(),[3,4];case 3:return r=i.sent(),f(a.LogLevel.Error,"Activity request failed: "+r),o.removeProgressOverlay(e),n=!0,[3,4];case 4:if(!t)return[3,10];if(!(t instanceof c.SuccessResponse))return[3,5];if(o.removeProgressOverlay(e),void 0===t.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");s=t.rawContent;try{s=JSON.parse(t.rawContent)}catch(e){}if("string"==typeof s)f(a.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s)."),o.activityRequestSucceeded(t,s);else{if("object"!=typeof s||"AdaptiveCard"!==s.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof t.rawContent+")");f(a.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s)."),o.internalSetCard(s,e.consecutiveRefreshes),o.activityRequestSucceeded(t,o.card)}return n=!0,[3,10];case 5:return t instanceof c.ErrorResponse?(d=o.activityRequestFailed(t))>=0&&e.attemptNumber<l.GlobalSettings.applets.maximumRetryAttempts?(f(a.LogLevel.Warning,"Activity request failed: "+t.error.message+". Retrying in "+d+"ms"),e.attemptNumber++,[4,new Promise((function(e,t){window.setTimeout((function(){e()}),d)}))]):[3,7]:[3,9];case 6:return i.sent(),[3,8];case 7:f(a.LogLevel.Error,"Activity request failed: "+t.error.message+". Giving up after "+e.attemptNumber+" attempt(s)"),o.removeProgressOverlay(e),n=!0,i.label=8;case 8:return[3,10];case 9:if(t instanceof c.LoginRequestResponse){if(f(a.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s)."),e.attemptNumber<=l.GlobalSettings.applets.maximumRetryAttempts){if(p=!0,t.tokenExchangeResource&&o.onSSOTokenNeeded&&(p=!o.onSSOTokenNeeded(o,e,t.tokenExchangeResource)),p){if(o.removeProgressOverlay(e),void 0===t.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");f(a.LogLevel.Info,"Login required at "+t.signinButton.value),o.onShowSigninPrompt?o.onShowSigninPrompt(o,e,t.signinButton):(o.showAuthCodeInputDialog(e),h=window.screenX+(window.outerWidth-l.GlobalSettings.applets.authPromptWidth)/2,g=window.screenY+(window.outerHeight-l.GlobalSettings.applets.authPromptHeight)/2,window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width="+l.GlobalSettings.applets.authPromptWidth+",height="+l.GlobalSettings.applets.authPromptHeight+",left="+h+",top="+g))}}else f(a.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)"),alert(u.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+t.toString());case 10:return[2]}}))},o=this,s.label=1;case 1:return n?[3,3]:[5,r()];case 2:return"break"===s.sent()?[3,3]:[3,1];case 3:return[2]}}))}))},e.prototype.refreshCard=function(){this._card&&this._card.refresh&&this.internalExecuteAction(this._card.refresh.action,c.ActivityRequestTrigger.Manual,0)},e.prototype.setCard=function(e){this.internalSetCard(e,0)},Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),e.submitMagicCodeActionId="submitMagicCode",e.cancelMagicCodeAuthActionId="cancelMagicCodeAuth",e}();t.AdaptiveApplet=g},27409:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(65120),t),o(n(24685),t),o(n(19146),t),o(n(6856),t),o(n(91654),t),o(n(65235),t),o(n(27583),t),o(n(96765),t),o(n(42510),t),o(n(29833),t),o(n(93127),t),o(n(86821),t)},6856:function(e,t,n){"use strict";var r,o=n(58651),i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.SerializationContext=t.GlobalRegistry=t.AdaptiveCard=t.Authentication=t.TokenExchangeResource=t.AuthCardButton=t.RefreshDefinition=t.RefreshActionProperty=t.ContainerWithActions=t.ColumnSet=t.Column=t.Container=t.BackgroundImage=t.StylableCardElementContainer=t.ActionSet=t.ShowCardAction=t.HttpAction=t.HttpHeader=t.ToggleVisibilityAction=t.OpenUrlAction=t.ExecuteAction=t.SubmitAction=t.SubmitActionBase=t.Action=t.TimeInput=t.TimeProperty=t.DateInput=t.NumberInput=t.ChoiceSetInput=t.Choice=t.ToggleInput=t.TextInput=t.Input=t.Media=t.MediaSource=t.ImageSet=t.CardElementContainer=t.Image=t.FactSet=t.Fact=t.RichTextBlock=t.TextRun=t.TextBlock=t.BaseTextBlock=t.ActionProperty=t.CardElement=void 0;var s=n(91654),l=n(27583),c=n(96765),u=n(65235),d=n(9893),p=n(19146),f=n(65120),h=n(24685),g=n(42510),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._truncatedDueToOverflow=!1,t}return i(t,e),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){l.GlobalSettings.useAdvancedCardBottomTruncation&&!e&&this.undoOverflowTruncation(),this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.updateRenderedElementVisibility(),this._renderedElement&&ae(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",e.toString())},enumerable:!1,configurable:!0}),t.prototype.internalRenderSeparator=function(){var e=c.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(l.GlobalSettings.alwaysBleedSeparators&&e&&this.separatorOrientation==s.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px",e.style.marginRight="-"+n.right+"px"}}return e},t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(e?this._renderedElement.style.display=e:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":e?this._separatorElement.style.display=e:this._separatorElement.style.removeProperty("display"))},t.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,ae(this,!1))},t.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,ae(this,!1))},t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow,t?t&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},t.prototype.resetOverflow=function(){var e=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,e=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),e},t.prototype.getDefaultSerializationContext=function(){return new me},t.prototype.createPlaceholderElement=function(){var e=this.getEffectiveStyleDefinition(),t=c.stringToCssColor(e.foregroundColors.default.subtle),n=document.createElement("div");return n.style.border="1px dashed "+t,n.style.padding="4px",n.style.minHeight="32px",n.style.fontSize="10px",n.style.color=t,n.innerText="Empty "+this.getJsonTypeName(),n},t.prototype.adjustRenderedElementSize=function(e){"auto"===this.height?e.style.flex="0 0 auto":e.style.flex="1 1 auto"},t.prototype.isDisplayed=function(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===s.Orientation.Horizontal)if(l.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var e=new l.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},t.prototype.truncateOverflow=function(e){return!1},t.prototype.undoOverflowTruncation=function(){},t.prototype.getDefaultPadding=function(){return new l.PaddingDefinition},t.prototype.getHasBackground=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return s.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return s.ContainerStyle.Default},enumerable:!1,configurable:!0}),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n||new me)},t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getForbiddenActionTypes=function(){return[]},t.prototype.getImmediateSurroundingPadding=function(e,t,n,r,o){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),void 0===o&&(o=!0),this.parent){var i=t&&this.parent.isTopElement(this),a=n&&this.parent.isRightMostElement(this),l=r&&this.parent.isBottomElement(this),c=o&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(i&&u.top!=s.Spacing.None&&(e.top=u.top,i=!1),a&&u.right!=s.Spacing.None&&(e.right=u.right,a=!1),l&&u.bottom!=s.Spacing.None&&(e.bottom=u.bottom,l=!1),c&&u.left!=s.Spacing.None&&(e.left=u.left,c=!1)),(i||a||l||c)&&this.parent.getImmediateSurroundingPadding(e,i,a,l,c)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(g.Strings.errors.indexOutOfRange(e))},t.prototype.remove=function(){return!!(this.parent&&this.parent instanceof P)&&this.parent.removeItem(this)},t.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},t.prototype.updateLayout=function(e){void 0===e&&(e=!0),this.updateRenderedElementVisibility(),this.applyPadding()},t.prototype.indexOf=function(e){return-1},t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof fe&&e.designMode},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.isHiddenDueToOverflow=function(){return void 0!==this._renderedElement&&"hidden"==this._renderedElement.style.visibility},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof ee)return e;e=e.parent}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e&&this.allowCustomPadding?e:this.getDefaultPadding()},Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:u.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.langProperty=new f.StringProperty(f.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),t.isVisibleProperty=new f.BoolProperty(f.Versions.v1_2,"isVisible",!0),t.separatorProperty=new f.BoolProperty(f.Versions.v1_0,"separator",!1),t.heightProperty=new f.ValueSetProperty(f.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new f.EnumProperty(f.Versions.v1_0,"horizontalAlignment",s.HorizontalAlignment,s.HorizontalAlignment.Left),t.spacingProperty=new f.EnumProperty(f.Versions.v1_0,"spacing",s.Spacing,s.Spacing.Default),a([f.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),a([f.property(t.spacingProperty)],t.prototype,"spacing",void 0),a([f.property(t.separatorProperty)],t.prototype,"separator",void 0),a([f.property(t.heightProperty)],t.prototype,"height",void 0),a([f.property(t.langProperty)],t.prototype,"lang",null),a([f.property(t.isVisibleProperty)],t.prototype,"isVisible",null),t}(p.CardObject);t.CardElement=m;var y=function(e){function t(t,n,r){void 0===r&&(r=[]);var o=e.call(this,t,n,void 0)||this;return o.targetVersion=t,o.name=n,o.forbiddenActionTypes=r,o}return i(t,e),t.prototype.parse=function(e,t,n){var r=e;return n.parseAction(r,t[this.name],this.forbiddenActionTypes,r.isDesignMode())},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)},t}(f.PropertyDefinition);t.ActionProperty=y;var v=function(e){function t(t){var n=e.call(this)||this;return n.size=s.TextSize.Default,n.weight=s.TextWeight.Default,n.color=s.TextColor.Default,n.isSubtle=!1,n.ariaHidden=!1,t&&(n.text=t),n}return i(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:!1,configurable:!0}),t.prototype.getFontSize=function(e){switch(this.size){case s.TextSize.Small:return e.fontSizes.small;case s.TextSize.Medium:return e.fontSizes.medium;case s.TextSize.Large:return e.fontSizes.large;case s.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.getColorDefinition=function(e,t){switch(t){case s.TextColor.Accent:return e.accent;case s.TextColor.Dark:return e.dark;case s.TextColor.Light:return e.light;case s.TextColor.Good:return e.good;case s.TextColor.Warning:return e.warning;case s.TextColor.Attention:return e.attention;default:return e.default}},t.prototype.setText=function(e){this.setValue(t.textProperty,e)},t.prototype.init=function(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle},t.prototype.asString=function(){return this.text},t.prototype.applyStylesTo=function(e){var t,n=this.hostConfig.getFontTypeDefinition(this.fontType);switch(n.fontFamily&&(e.style.fontFamily=n.fontFamily),this.size){case s.TextSize.Small:t=n.fontSizes.small;break;case s.TextSize.Medium:t=n.fontSizes.medium;break;case s.TextSize.Large:t=n.fontSizes.large;break;case s.TextSize.ExtraLarge:t=n.fontSizes.extraLarge;break;default:t=n.fontSizes.default}e.style.fontSize=t+"px";var r,o=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);switch(e.style.color=c.stringToCssColor(this.isSubtle?o.subtle:o.default),this.weight){case s.TextWeight.Lighter:r=n.fontWeights.lighter;break;case s.TextWeight.Bolder:r=n.fontWeights.bolder;break;default:r=n.fontWeights.default}e.style.fontWeight=r.toString(),this.ariaHidden&&e.setAttribute("aria-hidden","true")},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return this.color?this.color:s.TextColor.Default},enumerable:!1,configurable:!0}),t.textProperty=new f.StringProperty(f.Versions.v1_0,"text",!0),t.sizeProperty=new f.EnumProperty(f.Versions.v1_0,"size",s.TextSize,s.TextSize.Default),t.weightProperty=new f.EnumProperty(f.Versions.v1_0,"weight",s.TextWeight,s.TextWeight.Default),t.colorProperty=new f.EnumProperty(f.Versions.v1_0,"color",s.TextColor,s.TextColor.Default),t.isSubtleProperty=new f.BoolProperty(f.Versions.v1_0,"isSubtle",!1),t.fontTypeProperty=new f.EnumProperty(f.Versions.v1_2,"fontType",s.FontType),t.selectActionProperty=new y(f.Versions.v1_1,"selectAction",["Action.ShowCard"]),a([f.property(t.sizeProperty)],t.prototype,"size",void 0),a([f.property(t.weightProperty)],t.prototype,"weight",void 0),a([f.property(t.colorProperty)],t.prototype,"color",void 0),a([f.property(t.fontTypeProperty)],t.prototype,"fontType",void 0),a([f.property(t.isSubtleProperty)],t.prototype,"isSubtle",void 0),a([f.property(t.textProperty)],t.prototype,"text",null),a([f.property(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(m);t.BaseTextBlock=v;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!1,t._treatAsPlainText=!0,t.useMarkdown=!0,t}return i(t,e),t.prototype.restoreOriginalContent=function(){void 0!==this.renderedElement&&(this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px"),this.renderedElement.innerHTML=this._originalInnerHtml)},t.prototype.truncateIfSupported=function(e){if(void 0!==this.renderedElement){var t=this.renderedElement.children,n=!t.length;if(n||1==t.length&&"p"==t[0].tagName.toLowerCase()){var r=n?this.renderedElement:t[0];return c.truncate(r,e,this._computedLineHeight),!0}}return!1},t.prototype.setText=function(t){e.prototype.setText.call(this,t),this._processedText=void 0},t.prototype.internalRender=function(){var e=this;if(this._processedText=void 0,this.text){var t=this.preProcessPropertyValue(v.textProperty),n=this.hostConfig,r=void 0;if(this.forElementId){var o=document.createElement("label");o.htmlFor=this.forElementId,r=o}else r=document.createElement("div");if(r.classList.add(n.makeCssClassName("ac-textBlock")),r.style.overflow="hidden",this.applyStylesTo(r),this.selectAction&&(r.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction&&e.selectAction.execute()},n.supportsInteractivity&&(r.tabIndex=0,r.setAttribute("role",this.selectAction.getAriaRole()),this.selectAction.title&&(r.setAttribute("aria-label",this.selectAction.title),r.title=this.selectAction.title),r.classList.add(n.makeCssClassName("ac-selectable")))),!this._processedText){this._treatAsPlainText=!0;var i=d.formatText(this.lang,t);if(this.useMarkdown&&i){l.GlobalSettings.allowMarkForTextHighlighting&&(i=i.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var a=fe.applyMarkdown(i);if(a.didProcess&&a.outputHtml){if(this._processedText=a.outputHtml,this._treatAsPlainText=!1,l.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var s="",u=this.getEffectiveStyleDefinition();u.highlightBackgroundColor&&(s+="background-color: "+u.highlightBackgroundColor+";"),u.highlightForegroundColor&&(s+="color: "+u.highlightForegroundColor+";"),s&&(s='style="'+s+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+s+">").replace(/\/==\//g,"</mark>")}}else this._processedText=i,this._treatAsPlainText=!0}else this._processedText=i,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText?r.innerText=this._processedText:r.innerHTML=this._processedText,r.firstElementChild instanceof HTMLElement){var p=r.firstElementChild;p.style.marginTop="0px",p.style.width="100%",this.wrap||(p.style.overflow="hidden",p.style.textOverflow="ellipsis")}r.lastElementChild instanceof HTMLElement&&(r.lastElementChild.style.marginBottom="0px");for(var f=r.getElementsByTagName("a"),h=0;h<f.length;h++){var g=f[h];g.classList.add(n.makeCssClassName("ac-anchor")),g.target="_blank",g.onclick=function(t){oe(e,t.target,t)&&(t.preventDefault(),t.cancelBubble=!0)},g.oncontextmenu=function(t){return!oe(e,t.target,t)||(t.preventDefault(),t.cancelBubble=!0,!1)}}return this.wrap?(r.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(r.style.overflow="hidden",c.isInternetExplorer()||!l.GlobalSettings.useWebkitLineClamp?r.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(r.style.removeProperty("line-height"),r.style.display="-webkit-box",r.style.webkitBoxOrient="vertical",r.style.webkitLineClamp=this.maxLines.toString()))):(r.style.whiteSpace="nowrap",r.style.textOverflow="ellipsis"),(l.GlobalSettings.useAdvancedTextBlockTruncation||l.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=r.innerHTML),r}},t.prototype.truncateOverflow=function(e){return e>=this._computedLineHeight&&this.truncateIfSupported(e)},t.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),l.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}},t.prototype.applyStylesTo=function(t){e.prototype.applyStylesTo.call(this,t);var n=this.getParentContainer(),r=!!n&&n.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.textAlign="center";break;case s.HorizontalAlignment.Right:t.style.textAlign=r?"left":"right";break;default:t.style.textAlign=r?"right":"left"}var o=this.hostConfig.lineHeights;if(o)switch(this.size){case s.TextSize.Small:this._computedLineHeight=o.small;break;case s.TextSize.Medium:this._computedLineHeight=o.medium;break;case s.TextSize.Large:this._computedLineHeight=o.large;break;case s.TextSize.ExtraLarge:this._computedLineHeight=o.extraLarge;break;default:this._computedLineHeight=o.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType));t.style.lineHeight=this._computedLineHeight+"px"},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.updateLayout=function(t){void 0===t&&(t=!1),e.prototype.updateLayout.call(this,t),l.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},t.wrapProperty=new f.BoolProperty(f.Versions.v1_0,"wrap",!1),t.maxLinesProperty=new f.NumProperty(f.Versions.v1_0,"maxLines"),a([f.property(t.wrapProperty)],t.prototype,"wrap",void 0),a([f.property(t.maxLinesProperty)],t.prototype,"maxLines",void 0),t}(v);t.TextBlock=S;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.italic=!1,t.strikethrough=!1,t.highlight=!1,t.underline=!1,t}return i(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.add(v.selectActionProperty)},t.prototype.internalRender=function(){var e=this;if(this.text){var t=this.preProcessPropertyValue(v.textProperty),n=this.hostConfig,r=d.formatText(this.lang,t);r||(r="");var o=document.createElement("span");if(o.classList.add(n.makeCssClassName("ac-textRun")),this.applyStylesTo(o),this.selectAction&&n.supportsInteractivity){var i=document.createElement("a");i.classList.add(n.makeCssClassName("ac-anchor"));var a=this.selectAction.getHref();i.href=a||"",i.target="_blank",i.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction&&e.selectAction.execute()},this.selectAction.title&&(i.setAttribute("aria-label",this.selectAction.title),i.title=this.selectAction.title),i.innerText=r,o.appendChild(i)}else o.innerText=r;return o}},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);t.style.backgroundColor=c.stringToCssColor(this.isSubtle?n.highlightColors.subtle:n.highlightColors.default)}this.underline&&(t.style.textDecoration="underline")},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),t.italicProperty=new f.BoolProperty(f.Versions.v1_2,"italic",!1),t.strikethroughProperty=new f.BoolProperty(f.Versions.v1_2,"strikethrough",!1),t.highlightProperty=new f.BoolProperty(f.Versions.v1_2,"highlight",!1),t.underlineProperty=new f.BoolProperty(f.Versions.v1_3,"underline",!1),a([f.property(t.italicProperty)],t.prototype,"italic",void 0),a([f.property(t.strikethroughProperty)],t.prototype,"strikethrough",void 0),a([f.property(t.highlightProperty)],t.prototype,"highlight",void 0),a([f.property(t.underlineProperty)],t.prototype,"underline",void 0),t}(v);t.TextRun=C;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inlines=[],t}return i(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(g.Strings.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!=this)throw new Error(g.Strings.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))for(var r=0,o=t.inlines;r<o.length;r++){var i=o[r],a=void 0;if("string"==typeof i){var s=new C;s.text=i,a=s}else a=n.parseElement(this,i,!1);a&&this.internalAddInline(a,!0)}},t.prototype.internalToJSON=function(t,n){if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){for(var r=[],o=0,i=this._inlines;o<i.length;o++){var a=i[o];r.push(a.toJSON(n))}n.serializeValue(t,"inlines",r)}},t.prototype.internalRender=function(){if(this._inlines.length>0){var e=void 0;if(this.forElementId){var t=document.createElement("label");t.htmlFor=this.forElementId,e=t}else e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var n=this.getParentContainer(),r=!!n&&n.isRtl();switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:e.style.textAlign="center";break;case s.HorizontalAlignment.Right:e.style.textAlign=r?"left":"right";break;default:e.style.textAlign=r?"right":"left"}for(var o=0,i=0,a=this._inlines;i<a.length;i++){var l=a[i].render();l&&(e.appendChild(l),o++)}if(o>0)return e}},t.prototype.asString=function(){for(var e="",t=0,n=this._inlines;t<n.length;t++){e+=n[t].asString()}return e},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(g.Strings.errors.indexOutOfRange(e))},t.prototype.addInline=function(e){"string"==typeof e?this.internalAddInline(new C(e)):this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)},t}(m);t.RichTextBlock=b;var E=function(e){function t(t,n){var r=e.call(this)||this;return r.name=t,r.value=n,r}return i(t,e),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new f.StringProperty(f.Versions.v1_0,"title"),t.valueProperty=new f.StringProperty(f.Versions.v1_0,"value"),a([f.property(t.titleProperty)],t.prototype,"name",void 0),a([f.property(t.valueProperty)],t.prototype,"value",void 0),t}(f.SerializableObject);t.Fact=E;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=void 0,t=this.hostConfig;if(this.facts.length>0){(e=document.createElement("table")).style.borderWidth="0px",e.style.borderSpacing="0px",e.style.borderStyle="none",e.style.borderCollapse="collapse",e.style.display="block",e.style.overflow="hidden",e.classList.add(t.makeCssClassName("ac-factset")),e.setAttribute("role","presentation");for(var n=0;n<this.facts.length;n++){var r=document.createElement("tr");n>0&&(r.style.marginTop=t.factSet.spacing+"px");var o=document.createElement("td");o.style.padding="0",o.classList.add(t.makeCssClassName("ac-fact-title")),t.factSet.title.maxWidth&&(o.style.maxWidth=t.factSet.title.maxWidth+"px"),o.style.verticalAlign="top";var i=new S;i.setParent(this),i.text=!this.facts[n].name&&this.isDesignMode()?"Title":this.facts[n].name,i.size=t.factSet.title.size,i.color=t.factSet.title.color,i.isSubtle=t.factSet.title.isSubtle,i.weight=t.factSet.title.weight,i.wrap=t.factSet.title.wrap,i.spacing=s.Spacing.None,c.appendChild(o,i.render()),c.appendChild(r,o),(o=document.createElement("td")).style.width="10px",c.appendChild(r,o),(o=document.createElement("td")).style.padding="0",o.style.verticalAlign="top",o.classList.add(t.makeCssClassName("ac-fact-value")),(i=new S).setParent(this),i.text=this.facts[n].value,i.size=t.factSet.value.size,i.color=t.factSet.value.color,i.isSubtle=t.factSet.value.isSubtle,i.weight=t.factSet.value.weight,i.wrap=t.factSet.value.wrap,i.spacing=s.Spacing.None,c.appendChild(o,i.render()),c.appendChild(r,o),c.appendChild(e,r)}}return e},t.prototype.getJsonTypeName=function(){return"FactSet"},t.factsProperty=new f.SerializableObjectCollectionProperty(f.Versions.v1_0,"facts",E),a([f.property(t.factsProperty)],t.prototype,"facts",void 0),t}(m);t.FactSet=T;var w=function(e){function t(t,n,r,o){var i=e.call(this,t,n)||this;return i.targetVersion=t,i.name=n,i.internalName=r,i.fallbackProperty=o,i}return i(t,e),t.prototype.getInternalName=function(){return this.internalName},t.prototype.parse=function(e,t,n){var r=void 0,o=t[this.name];if(void 0===o)return this.defaultValue;var i=!1;if("string"==typeof o){try{var a=l.SizeAndUnit.parse(o,!0);a.unit==s.SizeUnit.Pixel&&(r=a.physicalSize,i=!0)}catch(e){}!i&&this.fallbackProperty&&(i=this.fallbackProperty.isValidValue(o,n))}return i||n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,g.Strings.errors.invalidPropertyValue(o,this.name)),r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(f.PropertyDefinition),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.size=s.Size.Auto,t.style=s.ImageStyle.Default,t}return i(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(m.heightProperty)},t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width=this.pixelWidth+"px"),this.pixelHeight&&(e.style.height=this.pixelHeight+"px");else if(this.maxHeight){switch(this.size){case s.Size.Small:e.style.height=this.hostConfig.imageSizes.small+"px";break;case s.Size.Large:e.style.height=this.hostConfig.imageSizes.large+"px";break;default:e.style.height=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case s.Size.Stretch:e.style.width="100%";break;case s.Size.Auto:e.style.maxWidth="100%";break;case s.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case s.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case s.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight="100%"}},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this,n=void 0;if(this.url){switch((n=document.createElement("div")).style.display="flex",n.style.alignItems="flex-start",n.onkeypress=function(t){!e.selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},n.onclick=function(t){e.selectAction&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.horizontalAlignment){case s.HorizontalAlignment.Center:n.style.justifyContent="center";break;case s.HorizontalAlignment.Right:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start"}var r=this.hostConfig,o=document.createElement("img");o.onload=function(t){re(e)},o.onerror=function(t){if(e.renderedElement){var n=e.getRootElement();if(e.renderedElement.innerHTML="",n&&n.designMode){var r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.backgroundColor="#EEEEEE",r.style.color="black",r.innerText=":-(",r.style.padding="10px",e.applySize(r),e.renderedElement.appendChild(r)}}re(e)},o.style.minWidth="0",o.classList.add(r.makeCssClassName("ac-image")),void 0!==this.selectAction&&r.supportsInteractivity&&(o.tabIndex=0,o.setAttribute("role",this.selectAction.getAriaRole()),this.selectAction.title&&(o.setAttribute("aria-label",this.selectAction.title),o.title=this.selectAction.title),o.classList.add(r.makeCssClassName("ac-selectable"))),this.applySize(o),this.style===s.ImageStyle.Person&&(o.style.borderRadius="50%",o.style.backgroundPosition="50% 50%",o.style.backgroundRepeat="no-repeat"),o.style.backgroundColor=c.stringToCssColor(this.backgroundColor),o.src=this.preProcessPropertyValue(t.urlProperty);var i=this.preProcessPropertyValue(t.altTextProperty);i&&(o.alt=i),n.appendChild(o)}return n},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},t.urlProperty=new f.StringProperty(f.Versions.v1_0,"url"),t.altTextProperty=new f.StringProperty(f.Versions.v1_0,"altText"),t.backgroundColorProperty=new f.StringProperty(f.Versions.v1_1,"backgroundColor"),t.styleProperty=new f.EnumProperty(f.Versions.v1_0,"style",s.ImageStyle,s.ImageStyle.Default),t.sizeProperty=new f.EnumProperty(f.Versions.v1_0,"size",s.Size,s.Size.Auto),t.pixelWidthProperty=new w(f.Versions.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new w(f.Versions.v1_1,"height","pixelHeight",m.heightProperty),t.selectActionProperty=new y(f.Versions.v1_1,"selectAction",["Action.ShowCard"]),a([f.property(t.urlProperty)],t.prototype,"url",void 0),a([f.property(t.altTextProperty)],t.prototype,"altText",void 0),a([f.property(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0),a([f.property(t.sizeProperty)],t.prototype,"size",void 0),a([f.property(t.styleProperty)],t.prototype,"style",void 0),a([f.property(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0),a([f.property(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0),a([f.property(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(m);t.Image=I;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowVerticalOverflow=!1,t}return i(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),this.isSelectable||n.remove(t.selectActionProperty)},t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new l.SpacingDefinition;this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var r=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&r.isInteractive&&t.addFailure(this,s.ValidationEvent.InteractivityNotAllowed,g.Strings.errors.interactivityNotAllowed()),this.isElementAllowed(r)||t.addFailure(this,s.ValidationEvent.InteractivityNotAllowed,g.Strings.errors.elementTypeNotAllowed(r.getJsonTypeName())),r.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this);if(n){var r=this.hostConfig;this.allowVerticalOverflow&&(n.style.overflowX="hidden",n.style.overflowY="auto"),n&&this.isSelectable&&this._selectAction&&r.supportsInteractivity&&(n.classList.add(r.makeCssClassName("ac-selectable")),n.tabIndex=0,n.setAttribute("role",this._selectAction.getAriaRole()),this._selectAction.title&&(n.setAttribute("aria-label",this._selectAction.title),n.title=this._selectAction.title),n.onclick=function(e){void 0!==t._selectAction&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},n.onkeypress=function(e){void 0===t._selectAction||13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())})}return n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<this.getItemCount();n++)t=t.concat(this.getItemAt(n).getAllInputs(e));return t},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e=e.concat(this.getItemAt(t).getResourceInformation());return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var r=0;r<this.getItemCount()&&!(n=this.getItemAt(r).getElementById(t));r++);return n},t.prototype.findDOMNodeOwner=function(t){for(var n=void 0,r=0;r<this.getItemCount();r++)if(n=this.getItemAt(r).findDOMNodeOwner(t))return n;return e.prototype.findDOMNodeOwner.call(this,t)},t.selectActionProperty=new y(f.Versions.v1_1,"selectAction",["Action.ShowCard"]),a([f.property(t.selectActionProperty)],t.prototype,"_selectAction",void 0),t}(m);t.CardElementContainer=P;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._images=[],t.imageSize=s.ImageSize.Medium,t}return i(t,e),t.prototype.internalRender=function(){var e=void 0;if(this._images.length>0){(e=document.createElement("div")).style.display="flex",e.style.flexWrap="wrap";for(var t=0,n=this._images;t<n.length;t++){var r=n[t];switch(this.imageSize){case s.ImageSize.Small:r.size=s.Size.Small;break;case s.ImageSize.Large:r.size=s.Size.Large;break;default:r.size=s.Size.Medium}r.maxHeight=this.hostConfig.imageSet.maxImageHeight;var o=r.render();o&&(o.style.display="inline-flex",o.style.margin="0px",o.style.marginRight="10px",c.appendChild(e,o))}}return e},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},t.prototype.removeItem=function(e){if(e instanceof I){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof I?this._images.indexOf(e):-1},t.imagesProperty=new f.SerializableObjectCollectionProperty(f.Versions.v1_0,"images",I,(function(e,t){t.setParent(e)})),t.imageSizeProperty=new f.EnumProperty(f.Versions.v1_0,"imageSize",s.ImageSize,s.ImageSize.Medium),a([f.property(t.imagesProperty)],t.prototype,"_images",void 0),a([f.property(t.imageSizeProperty)],t.prototype,"imageSize",void 0),t}(P);t.ImageSet=_;var A=function(e){function t(t,n){var r=e.call(this)||this;return r.url=t,r.mimeType=n,r}return i(t,e),t.prototype.getSchemaKey=function(){return"MediaSource"},t.prototype.isValid=function(){return!(!this.mimeType||!this.url)},t.prototype.render=function(){var e=void 0;return this.isValid()&&((e=document.createElement("source")).src=this.url,e.type=this.mimeType),e},t.mimeTypeProperty=new f.StringProperty(f.Versions.v1_1,"mimeType"),t.urlProperty=new f.StringProperty(f.Versions.v1_1,"url"),a([f.property(t.mimeTypeProperty)],t.prototype,"mimeType",void 0),a([f.property(t.urlProperty)],t.prototype,"url",void 0),t}(f.SerializableObject);t.MediaSource=A;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sources=[],t}return i(t,e),t.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},t.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var e=0,n=this.sources;e<n.length;e++){var r=n[e],o=r.mimeType?r.mimeType.split("/"):[];if(2==o.length){if(!this._selectedMediaType){var i=t.supportedMediaTypes.indexOf(o[0]);i>=0&&(this._selectedMediaType=t.supportedMediaTypes[i])}o[0]==this._selectedMediaType&&this._selectedSources.push(r)}}},t.prototype.handlePlayButtonInvoke=function(e){if(this.hostConfig.media.allowInlinePlayback){if(e.preventDefault(),e.cancelBubble=!0,this.renderedElement){var n=this.renderMediaPlayer();this.renderedElement.innerHTML="",this.renderedElement.appendChild(n),n.play(),n.focus()}}else t.onPlay&&(e.preventDefault(),e.cancelBubble=!0,t.onPlay(this))},t.prototype.renderPoster=function(){var e=this,t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-media-poster"),t.setAttribute("role","contentinfo"),t.setAttribute("aria-label",this.altText?this.altText:g.Strings.defaults.mediaPlayerAriaLabel()),t.style.position="relative",t.style.display="flex";var n=this.getPosterUrl();if(n){var r=document.createElement("img");r.style.width="100%",r.style.height="100%",r.setAttribute("role","presentation"),r.onerror=function(e){r.parentNode&&r.parentNode.removeChild(r),t.classList.add("empty"),t.style.minHeight="150px"},r.src=n,t.appendChild(r)}else t.classList.add("empty"),t.style.minHeight="150px";if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var o=document.createElement("div");o.tabIndex=0,o.setAttribute("role","button"),o.setAttribute("aria-label",g.Strings.defaults.mediaPlayerPlayMedia()),o.className=this.hostConfig.makeCssClassName("ac-media-playButton"),o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.onclick=function(t){e.handlePlayButtonInvoke(t)},o.onkeypress=function(t){13!=t.keyCode&&32!=t.keyCode||e.handlePlayButtonInvoke(t)};var i=document.createElement("div");i.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),i.style.width="12px",i.style.height="15px",i.style.borderTopWidth="7.5px",i.style.borderBottomWidth="7.5px",i.style.borderLeftWidth="12px",i.style.borderRightWidth="0",i.style.borderStyle="solid",i.style.borderTopColor="transparent",i.style.borderRightColor="transparent",i.style.borderBottomColor="transparent",i.style.transform="translate(1.2px,0px)",o.appendChild(i);var a=document.createElement("div");a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.width="100%",a.style.height="100%",a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.appendChild(o),t.appendChild(a)}return t},t.prototype.renderMediaPlayer=function(){var e;if("video"==this._selectedMediaType){var t=document.createElement("video"),n=this.getPosterUrl();n&&(t.poster=n),e=t}else e=document.createElement("audio");e.setAttribute("aria-label",this.altText?this.altText:g.Strings.defaults.mediaPlayerAriaLabel()),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),e.autoplay=!0,e.controls=!0,c.isMobileOS()&&(e.muted=!0),e.preload="none",e.style.width="100%";for(var r=0,o=this.sources;r<o.length;r++){var i=o[r].render();c.appendChild(e,i)}return e},t.prototype.internalRender=function(){var e=document.createElement("div");return e.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),e.appendChild(this.renderPoster()),e},t.prototype.getJsonTypeName=function(){return"Media"},t.prototype.getResourceInformation=function(){var e=[],t=this.getPosterUrl();t&&e.push({url:t,mimeType:"image"});for(var n=0,r=this.sources;n<r.length;n++){var o=r[n];o.isValid()&&e.push({url:o.url,mimeType:o.mimeType})}return e},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.sourcesProperty=new f.SerializableObjectCollectionProperty(f.Versions.v1_1,"sources",A),t.posterProperty=new f.StringProperty(f.Versions.v1_1,"poster"),t.altTextProperty=new f.StringProperty(f.Versions.v1_1,"altText"),t.supportedMediaTypes=["audio","video"],a([f.property(t.sourcesProperty)],t.prototype,"sources",void 0),a([f.property(t.posterProperty)],t.prototype,"poster",void 0),a([f.property(t.altTextProperty)],t.prototype,"altText",void 0),t}(m);t.Media=k;var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getAllLabelIds=function(){var e=[];return this._renderedLabelElement&&e.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&e.push(this._renderedErrorMessageElement.id),e},t.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var e=this.getAllLabelIds();this.labelledBy&&e.push(this.labelledBy),this._renderedLabelElement&&e.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&e.push(this._renderedErrorMessageElement.id),e.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),t.prototype.overrideInternalRender=function(){var e=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column";var t=c.generateUniqueId();if(this.label){var n=new b;n.setParent(this),n.forElementId=t;var r=new C(this.label);if(n.addInline(r),this.isRequired){r.init(e.inputs.label.requiredInputs);var o=new C(e.inputs.label.requiredInputs.suffix);o.color=e.inputs.label.requiredInputs.suffixColor,o.ariaHidden=!0,n.addInline(o)}else r.init(e.inputs.label.optionalInputs);this._renderedLabelElement=n.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=c.generateUniqueId(),this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement)return this._renderedInputControlElement.id=t,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.setAttribute("aria-required","true"),this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required"))),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this.updateInputControlAriaLabelledBy(),this._outerContainerElement},t.prototype.valueChanged=function(){var e,t,n;this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),t=(e=this).getRootElement(),(n=t&&t.onInputValueChanged?t.onInputValueChanged:fe.onInputValueChanged)&&n(e)},t.prototype.resetValidationFailureCue=function(){this.renderedInputControlElement&&(this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))},t.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&l.GlobalSettings.displayInputValidationErrors){var e=new S;e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=e.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=c.generateUniqueId(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}},t.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},t.prototype.isValid=function(){return!0},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.id||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||t.addFailure(this,s.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||t.addFailure(this,s.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},t.prototype.validateValue=function(){this.resetValidationFailureCue();var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!e&&this.renderedInputControlElement&&(this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),e},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[this]},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.labelProperty=new f.StringProperty(f.Versions.v1_3,"label",!0),t.isRequiredProperty=new f.BoolProperty(f.Versions.v1_3,"isRequired",!1),t.errorMessageProperty=new f.StringProperty(f.Versions.v1_3,"errorMessage",!0),a([f.property(t.labelProperty)],t.prototype,"label",void 0),a([f.property(t.isRequiredProperty)],t.prototype,"isRequired",void 0),a([f.property(t.errorMessageProperty)],t.prototype,"errorMessage",void 0),t}(m);t.Input=x;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiline=!1,t.style=s.InputTextStyle.Text,t}return i(t,e),t.prototype.setupInput=function(e){var t=this;e.style.flex="1 1 auto",e.tabIndex=0,this.placeholder&&(e.placeholder=this.placeholder,e.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(e.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(e.maxLength=this.maxLength),e.oninput=function(){t.valueChanged()},e.onkeypress=function(e){e.ctrlKey&&"Enter"===e.code&&t.inlineAction&&t.inlineAction.execute()}},t.prototype.internalRender=function(){var e;return this.isMultiline?((e=document.createElement("textarea")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(e.style.height="initial")):((e=document.createElement("input")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),e.type=s.InputTextStyle[this.style].toLowerCase()),this.setupInput(e),e},t.prototype.overrideInternalRender=function(){var t=this,n=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var r=document.createElement("button");if(r.className=this.hostConfig.makeCssClassName("ac-inlineActionButton"),r.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.inlineAction&&t.inlineAction.execute()},this.inlineAction.iconUrl){r.classList.add("iconOnly");var o=document.createElement("img");o.style.height="100%",o.setAttribute("role","presentation"),o.style.display="none",o.onload=function(){o.style.removeProperty("display")},o.onerror=function(){r.removeChild(o),r.classList.remove("iconOnly"),r.classList.add("textOnly"),r.textContent=t.inlineAction&&t.inlineAction.title?t.inlineAction.title:g.Strings.defaults.inlineActionTitle()},o.src=this.inlineAction.iconUrl,r.appendChild(o),r.title=this.inlineAction.title?this.inlineAction.title:g.Strings.defaults.inlineActionTitle()}else r.classList.add("textOnly"),r.textContent=this.inlineAction.title?this.inlineAction.title:g.Strings.defaults.inlineActionTitle();r.style.marginLeft="8px",this.inputControlContainerElement.appendChild(r)}return n},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))},Object.defineProperty(t.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0},enumerable:!1,configurable:!0}),t.valueProperty=new f.StringProperty(f.Versions.v1_0,"value"),t.maxLengthProperty=new f.NumProperty(f.Versions.v1_0,"maxLength"),t.isMultilineProperty=new f.BoolProperty(f.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new f.StringProperty(f.Versions.v1_0,"placeholder"),t.styleProperty=new f.EnumProperty(f.Versions.v1_0,"style",s.InputTextStyle,s.InputTextStyle.Text),t.inlineActionProperty=new y(f.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new f.StringProperty(f.Versions.v1_3,"regex",!0),a([f.property(t.valueProperty)],t.prototype,"defaultValue",void 0),a([f.property(t.maxLengthProperty)],t.prototype,"maxLength",void 0),a([f.property(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),a([f.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),a([f.property(t.styleProperty)],t.prototype,"style",void 0),a([f.property(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),a([f.property(t.regexProperty)],t.prototype,"regex",void 0),t}(x);t.TextInput=N;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}return i(t,e),t.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var e=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(e+=" "+this._checkboxInputLabelElement.id),e?this._checkboxInputElement.setAttribute("aria-labelledby",e):this._checkboxInputElement.removeAttribute("aria-labelledby")}},t.prototype.internalRender=function(){var e=this,t=document.createElement("div");if(t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),t.style.width="100%",t.style.display="flex",t.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=c.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){e.valueChanged()},c.appendChild(t,this._checkboxInputElement),this.title||this.isDesignMode()){var n=new S;if(n.setParent(this),n.forElementId=this._checkboxInputElement.id,n.hostConfig=this.hostConfig,n.text=this.title?this.title:this.getJsonTypeName(),n.useMarkdown=l.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,n.wrap=this.wrap,this._checkboxInputLabelElement=n.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=c.generateUniqueId(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";var r=document.createElement("div");r.style.width="6px",c.appendChild(t,r),c.appendChild(t,this._checkboxInputLabelElement)}}return t},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.focus=function(){this._checkboxInputElement&&this._checkboxInputElement.focus()},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},Object.defineProperty(t.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new f.StringProperty(f.Versions.v1_0,"value"),t.titleProperty=new f.StringProperty(f.Versions.v1_0,"title"),t.valueOnProperty=new f.StringProperty(f.Versions.v1_0,"valueOn",!0,void 0,"true",(function(e){return"true"})),t.valueOffProperty=new f.StringProperty(f.Versions.v1_0,"valueOff",!0,void 0,"false",(function(e){return"false"})),t.wrapProperty=new f.BoolProperty(f.Versions.v1_2,"wrap",!1),a([f.property(t.valueProperty)],t.prototype,"defaultValue",void 0),a([f.property(t.titleProperty)],t.prototype,"title",void 0),a([f.property(t.valueOnProperty)],t.prototype,"valueOn",void 0),a([f.property(t.valueOffProperty)],t.prototype,"valueOff",void 0),a([f.property(t.wrapProperty)],t.prototype,"wrap",void 0),t}(x);t.ToggleInput=O;var D=function(e){function t(t,n){var r=e.call(this)||this;return r.title=t,r.value=n,r}return i(t,e),t.prototype.getSchemaKey=function(){return"Choice"},t.titleProperty=new f.StringProperty(f.Versions.v1_0,"title"),t.valueProperty=new f.StringProperty(f.Versions.v1_0,"value"),a([f.property(t.titleProperty)],t.prototype,"title",void 0),a([f.property(t.valueProperty)],t.prototype,"value",void 0),t}(f.SerializableObject);t.Choice=D;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiSelect=!1,t.wrap=!1,t.choices=[],t}return i(t,e),Object.defineProperty(t.prototype,"isCompact",{get:function(){return"expanded"!==this.style},set:function(e){this.style=e?void 0:"expanded"},enumerable:!1,configurable:!0}),t.getUniqueCategoryName=function(){var e="__ac-category"+t.uniqueCategoryCounter;return t.uniqueCategoryCounter++,e},t.prototype.internalApplyAriaCurrent=function(){var e=this._selectElement.options;if(e)for(var t=0;t<e.length;t++)e[t].selected?e[t].setAttribute("aria-current","true"):e[t].removeAttribute("aria-current")},t.prototype.renderCompoundInput=function(e,t,n){var r=this,o=document.createElement("div");o.className=this.hostConfig.makeCssClassName("ac-input",e),o.style.width="100%",this._toggleInputs=[],this._labels=[];for(var i=0,a=this.choices;i<a.length;i++){var s=a[i],u=document.createElement("input");u.id=c.generateUniqueId(),u.type=t,u.style.margin="0",u.style.display="inline-block",u.style.verticalAlign="middle",u.style.flex="0 0 auto",u.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&u.setAttribute("aria-required","true"),s.value&&(u.value=s.value),s.title&&u.setAttribute("aria-label",s.title),n&&s.value&&n.indexOf(s.value)>=0&&(u.checked=!0),u.onchange=function(){r.valueChanged()},this._toggleInputs.push(u);var d=document.createElement("div");d.style.display="flex",d.style.alignItems="center",c.appendChild(d,u);var p=new S;p.setParent(this),p.forElementId=u.id,p.hostConfig=this.hostConfig,p.text=s.title?s.title:"Choice "+this._toggleInputs.length,p.useMarkdown=l.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,p.wrap=this.wrap;var f=p.render();if(this._labels.push(f),f){f.id=c.generateUniqueId(),f.style.display="inline-block",f.style.flex="1 1 auto",f.style.marginLeft="6px",f.style.verticalAlign="middle";var h=document.createElement("div");h.style.width="6px",c.appendChild(d,h),c.appendChild(d,f)}c.appendChild(o,d)}return o},t.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels)for(var t=this.getAllLabelIds(),n=0;n<this._toggleInputs.length;n++){var r=t.join(" "),o=this._labels[n];o&&o.id&&(r+=" "+o.id),r?this._toggleInputs[n].setAttribute("aria-labelledby",r):this._toggleInputs[n].removeAttribute("aria-labelledby")}else e.prototype.updateInputControlAriaLabelledBy.call(this)},t.prototype.internalRender=function(){var e=this;if(this._uniqueCategoryName=t.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%";var n=document.createElement("option");n.selected=!0,n.disabled=!0,n.hidden=!0,n.value="",this.placeholder&&(n.text=this.placeholder),c.appendChild(this._selectElement,n);for(var r=0,o=this.choices;r<o.length;r++){var i=o[r],a=document.createElement("option");a.value=i.value,a.text=i.title,a.setAttribute("aria-label",i.title),i.value==this.defaultValue&&(a.selected=!0),c.appendChild(this._selectElement,a)}return this._selectElement.onchange=function(){e.internalApplyAriaCurrent(),e.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.focus=function(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():e.prototype.focus.call(this)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0==this.choices.length&&t.addFailure(this,s.ValidationEvent.CollectionCantBeEmpty,g.Strings.errors.choiceSetMustHaveAtLeastOneChoice());for(var n=0,r=this.choices;n<r.length;n++){var o=r[n];o.title&&o.value||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}},t.prototype.isSet=function(){return!!this.value},Object.defineProperty(t.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return;for(var e="",t=0,n=this._toggleInputs;t<n.length;t++){(i=n[t]).checked&&(""!=e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=i.value)}return e||void 0}if(this.isCompact)return this._selectElement&&this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._toggleInputs&&0!=this._toggleInputs.length)for(var r=0,o=this._toggleInputs;r<o.length;r++){var i;if((i=o[r]).checked)return i.value}},enumerable:!1,configurable:!0}),t.valueProperty=new f.StringProperty(f.Versions.v1_0,"value"),t.choicesProperty=new f.SerializableObjectCollectionProperty(f.Versions.v1_0,"choices",D),t.styleProperty=new f.ValueSetProperty(f.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact"),t.isMultiSelectProperty=new f.BoolProperty(f.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new f.StringProperty(f.Versions.v1_0,"placeholder"),t.wrapProperty=new f.BoolProperty(f.Versions.v1_2,"wrap",!1),t.uniqueCategoryCounter=0,a([f.property(t.valueProperty)],t.prototype,"defaultValue",void 0),a([f.property(t.styleProperty)],t.prototype,"style",void 0),a([f.property(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),a([f.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),a([f.property(t.wrapProperty)],t.prototype,"wrap",void 0),a([f.property(t.choicesProperty)],t.prototype,"choices",void 0),t}(x);t.ChoiceSetInput=L;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.internalRender=function(){var e=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){e.valueChanged()},this._numberInputElement},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},t.prototype.isValid=function(){if(void 0===this.value)return!this.isRequired;var e=!0;return void 0!==this.min&&(e=e&&this.value>=this.min),void 0!==this.max&&(e=e&&this.value<=this.max),e},Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new f.NumProperty(f.Versions.v1_0,"value"),t.placeholderProperty=new f.StringProperty(f.Versions.v1_0,"placeholder"),t.minProperty=new f.NumProperty(f.Versions.v1_0,"min"),t.maxProperty=new f.NumProperty(f.Versions.v1_0,"max"),a([f.property(t.valueProperty)],t.prototype,"defaultValue",void 0),a([f.property(t.minProperty)],t.prototype,"min",void 0),a([f.property(t.maxProperty)],t.prototype,"max",void 0),a([f.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(x);t.NumberInput=R;var F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.internalRender=function(){var e=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){e.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=new Date(this.value),t=!0;if(this.min){var n=new Date(this.min);t=t&&e>=n}if(this.max){var r=new Date(this.max);t=t&&e<=r}return t},Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new f.StringProperty(f.Versions.v1_0,"value"),t.placeholderProperty=new f.StringProperty(f.Versions.v1_0,"placeholder"),t.minProperty=new f.StringProperty(f.Versions.v1_0,"min"),t.maxProperty=new f.StringProperty(f.Versions.v1_0,"max"),a([f.property(t.valueProperty)],t.prototype,"defaultValue",void 0),a([f.property(t.minProperty)],t.prototype,"min",void 0),a([f.property(t.maxProperty)],t.prototype,"max",void 0),a([f.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(x);t.DateInput=F;var M=function(e){function t(t,n){var r=e.call(this,t,n,(function(e,t,n,r){var o=n[t.name];if("string"==typeof o&&o&&/^[0-9]{2}:[0-9]{2}$/.test(o))return o}),(function(e,t,n,r,o){o.serializeValue(n,t.name,r)}))||this;return r.targetVersion=t,r.name=n,r}return i(t,e),t}(f.CustomProperty);t.TimeProperty=M;var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.convertTimeStringToDate=function(e){return new Date("1973-09-04T"+e+":00Z")},t.prototype.internalRender=function(){var e=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.setAttribute("min",this.min),this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){e.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=t.convertTimeStringToDate(this.value),n=!0;if(this.min){var r=t.convertTimeStringToDate(this.min);n=n&&e>=r}if(this.max){var o=t.convertTimeStringToDate(this.max);n=n&&e<=o}return n},Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new M(f.Versions.v1_0,"value"),t.placeholderProperty=new f.StringProperty(f.Versions.v1_0,"placeholder"),t.minProperty=new M(f.Versions.v1_0,"min"),t.maxProperty=new M(f.Versions.v1_0,"max"),a([f.property(t.valueProperty)],t.prototype,"defaultValue",void 0),a([f.property(t.minProperty)],t.prototype,"min",void 0),a([f.property(t.maxProperty)],t.prototype,"max",void 0),a([f.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(x);t.TimeInput=B;var U=function(){function e(e,t){this._state=0,this.action=e,this._parentContainerStyle=t}return e.prototype.updateCssStyle=function(){var e,t;if(this.action.parent&&this.action.renderedElement){var n=this.action.parent.hostConfig;switch(this.action.renderedElement.className=n.makeCssClassName("ac-pushButton"),this._parentContainerStyle&&this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action.updateActionButtonCssStyle(this.action.renderedElement,this._state),this.action.renderedElement.classList.remove(n.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(n.makeCssClassName("subdued")),this._state){case 1:this.action.renderedElement.classList.add(n.makeCssClassName("expanded"));break;case 2:this.action.renderedElement.classList.add(n.makeCssClassName("subdued"))}this.action.style&&(this.action.style===s.ActionStyle.Positive?(e=this.action.renderedElement.classList).add.apply(e,n.makeCssClassNames("primary","style-positive")):(t=this.action.renderedElement.classList).add.apply(t,n.makeCssClassNames("style-"+this.action.style.toLowerCase())))}},e.prototype.render=function(){var e=this;this.action.render(),this.action.renderedElement&&(this.action.renderedElement.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.click()},this.updateCssStyle())},e.prototype.click=function(){void 0!==this.onClick&&this.onClick(this)},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.updateCssStyle()},enumerable:!1,configurable:!0}),e}(),z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.style=s.ActionStyle.Default,t}return i(t,e),t.prototype.getDefaultSerializationContext=function(){return new me},t.prototype.addCssClasses=function(e){},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t=[];if(e)for(var n=0,r=Object.keys(e);n<r.length;n++){var o=e[r[n]];o.validateValue()||t.push(o)}return t},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.raiseExecuteActionEvent=function(){var e,t,n;this.onExecute&&this.onExecute(this),t=(e=this).parent?e.parent.getRootElement():void 0,n=t&&t.onExecuteAction?t.onExecuteAction:fe.onExecuteAction,e.prepareForExecution()&&n&&n(e)},t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.updateActionButtonCssStyle=function(e,t){void 0===t&&(t=0)},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new me)},t.prototype.render=function(e){void 0===e&&(e="ac-pushButton");var t=this.hostConfig,n=document.createElement("button");this.addCssClasses(n),this.accessibleTitle?n.setAttribute("aria-label",this.accessibleTitle):this.title&&n.setAttribute("aria-label",this.title),null!=this.expanded&&n.setAttribute("aria-expanded",this.expanded.toString()),n.type="button",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.setAttribute("role",this.getAriaRole());var r=document.createElement("div");if(r.style.overflow="hidden",r.style.textOverflow="ellipsis",t.actions.iconPlacement==s.ActionIconPlacement.AboveTitle||t.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),this.title&&(r.innerText=this.title),this.iconUrl){var o=document.createElement("img");o.src=this.iconUrl,o.style.width=t.actions.iconSize+"px",o.style.height=t.actions.iconSize+"px",o.style.flex="0 0 auto",t.actions.iconPlacement==s.ActionIconPlacement.AboveTitle?(n.classList.add("iconAbove"),n.style.flexDirection="column",this.title&&(o.style.marginBottom="6px")):(n.classList.add("iconLeft"),o.style.maxHeight="100%",this.title&&(o.style.marginRight="6px")),n.appendChild(o),n.appendChild(r)}else n.classList.add("noIcon"),n.appendChild(r);this._renderedElement=n},t.prototype.execute=function(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent()},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style==s.ActionStyle.Positive},set:function(e){e?this.style=s.ActionStyle.Positive:this.style==s.ActionStyle.Positive&&(this.style=s.ActionStyle.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:u.defaultHostConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.titleProperty=new f.StringProperty(f.Versions.v1_0,"title"),t.iconUrlProperty=new f.StringProperty(f.Versions.v1_1,"iconUrl"),t.styleProperty=new f.ValueSetProperty(f.Versions.v1_2,"style",[{value:s.ActionStyle.Default},{value:s.ActionStyle.Positive},{value:s.ActionStyle.Destructive}],s.ActionStyle.Default),a([f.property(t.titleProperty)],t.prototype,"title",void 0),a([f.property(t.iconUrlProperty)],t.prototype,"iconUrl",void 0),a([f.property(t.styleProperty)],t.prototype,"style",void 0),t}(p.CardObject);t.Action=z;var H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isPrepared=!1,t}return i(t,e),t.prototype.internalGetReferencedInputs=function(){var e={};if("none"!==this.associatedInputs){for(var t=this.parent,n=[];t;)n=n.concat(t.getAllInputs(!1)),t=t.parent;for(var r=0,o=n;r<o.length;r++){var i=o[r];i.id&&(e[i.id]=i)}}return e},t.prototype.internalPrepareForExecution=function(e){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&e)for(var t=0,n=Object.keys(e);t<n.length;t++){var r=e[n[t]];r.id&&r.isSet()&&(this._processedData[r.id]="string"==typeof r.value?r.value:r.value.toString())}this._isPrepared=!0},Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new f.PropertyDefinition(f.Versions.v1_0,"data"),t.associatedInputsProperty=new f.CustomProperty(f.Versions.v1_3,"associatedInputs",(function(e,t,n,r){var o=n[t.name];if(void 0!==o&&"string"==typeof o)return"none"===o.toLowerCase()?"none":"auto"}),(function(e,t,n,r,o){o.serializeValue(n,t.name,r)})),a([f.property(t.dataProperty)],t.prototype,"_originalData",void 0),a([f.property(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0),t}(z);t.SubmitActionBase=H;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Submit",t}(H);t.SubmitAction=G;var V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Execute",t.verbProperty=new f.StringProperty(f.Versions.v1_4,"verb"),a([f.property(t.verbProperty)],t.prototype,"verb",void 0),t}(H);t.ExecuteAction=V;var j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.getAriaRole=function(){return"link"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.propertyMustBeSet("url"))},t.prototype.getHref=function(){return this.url},t.urlProperty=new f.StringProperty(f.Versions.v1_0,"url"),t.JsonTypeName="Action.OpenUrl",a([f.property(t.urlProperty)],t.prototype,"url",void 0),t}(z);t.OpenUrlAction=j;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetElements={},t}return i(t,e),t.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);this._renderedElement&&(e.length>0?this._renderedElement.setAttribute("aria-controls",e.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.targetElements||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.propertyMustBeSet("targetElements"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.render=function(t){void 0===t&&(t="ac-pushButton"),e.prototype.render.call(this,t),this.updateAriaControlsAttribute()},t.prototype.execute=function(){if(this.parent)for(var e=0,t=Object.keys(this.targetElements);e<t.length;e++){var n=t[e],r=this.parent.getRootElement().getElementById(n);r&&("boolean"==typeof this.targetElements[n]?r.isVisible=this.targetElements[n]:r.isVisible=!r.isVisible)}},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t,this.updateAriaControlsAttribute()},t.prototype.removeTargetElement=function(e){delete this.targetElements[e],this.updateAriaControlsAttribute()},t.targetElementsProperty=new f.CustomProperty(f.Versions.v1_2,"targetElements",(function(e,t,n,r){var o={};if(Array.isArray(n[t.name]))for(var i=0,a=n[t.name];i<a.length;i++){var s=a[i];if("string"==typeof s)o[s]=void 0;else if("object"==typeof s){var l=s.elementId;"string"==typeof l&&(o[l]=c.parseBool(s.isVisible))}}return o}),(function(e,t,n,r,o){for(var i=[],a=0,s=Object.keys(r);a<s.length;a++){var l=s[a];"boolean"==typeof r[l]?i.push({elementId:l,isVisible:r[l]}):i.push(l)}o.serializeArray(n,t.name,i)}),{},(function(e){return{}})),t.JsonTypeName="Action.ToggleVisibility",a([f.property(t.targetElementsProperty)],t.prototype,"targetElements",void 0),t}(z);t.ToggleVisibilityAction=q;var W=function(e){function t(t,n){var r=e.call(this,t,n,void 0,(function(){return new l.StringWithSubstitutions}))||this;return r.targetVersion=t,r.name=n,r}return i(t,e),t.prototype.parse=function(e,t,n){var r=new l.StringWithSubstitutions;return r.set(c.parseString(t[this.name])),r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n.getOriginal())},t}(f.PropertyDefinition),Y=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n="");var r=e.call(this)||this;return r.name=t,r.value=n,r}return i(t,e),t.prototype.getSchemaKey=function(){return"HttpHeader"},t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)},t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,l.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:!1,configurable:!0}),t.nameProperty=new f.StringProperty(f.Versions.v1_0,"name"),t.valueProperty=new W(f.Versions.v1_0,"value"),a([f.property(t.nameProperty)],t.prototype,"name",void 0),a([f.property(t.valueProperty)],t.prototype,"_value",void 0),t}(f.SerializableObject);t.HttpHeader=Y;var Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ignoreInputValidation=!1,t}return i(t,e),t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[],t={};this._url.getReferencedInputs(e,t);for(var n=0,r=this.headers;n<r.length;n++){r[n].getReferencedInputs(e,t)}return this._body.getReferencedInputs(e,t),t},t.prototype.internalPrepareForExecution=function(e){if(e){this._url.substituteInputValues(e,l.ContentTypes.applicationXWwwFormUrlencoded);for(var t=l.ContentTypes.applicationJson,n=0,r=this.headers;n<r.length;n++){var o=r[n];o.prepareForExecution(e),o.name&&"content-type"==o.name.toLowerCase()&&(t=o.value)}this._body.substituteInputValues(e,t)}},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){if(e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var n=0,r=this.headers;n<r.length;n++){r[n].name||t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:!1,configurable:!0}),t.urlProperty=new W(f.Versions.v1_0,"url"),t.bodyProperty=new W(f.Versions.v1_0,"body"),t.methodProperty=new f.StringProperty(f.Versions.v1_0,"method"),t.headersProperty=new f.SerializableObjectCollectionProperty(f.Versions.v1_0,"headers",Y),t.ignoreInputValidationProperty=new f.BoolProperty(f.Versions.v1_3,"ignoreInputValidation",!1),t.JsonTypeName="Action.Http",a([f.property(t.urlProperty)],t.prototype,"_url",void 0),a([f.property(t.bodyProperty)],t.prototype,"_body",void 0),a([f.property(t.methodProperty)],t.prototype,"method",void 0),a([f.property(t.headersProperty)],t.prototype,"headers",void 0),a([f.property(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0),t}(z);t.HttpAction=Q;var J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.card=new he,t}return i(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var r=t.card;r?this.card.parse(r,n):n.logParseEvent(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.showCardMustHaveCard())},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this.card&&n.serializeValue(t,"card",this.card.toJSON(n))},t.prototype.addCssClasses=function(t){e.prototype.addCssClasses.call(this,t),this.parent&&t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},t.prototype.raiseExecuteActionEvent=function(){this.hostConfig.actions.showCard.actionMode===s.ShowCardActionMode.Popup&&e.prototype.raiseExecuteActionEvent.call(this)},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.updateActionButtonCssStyle=function(t,n){void 0===n&&(n=0),e.prototype.updateActionButtonCssStyle.call(this,t),this.parent&&(t.classList.add(this.parent.hostConfig.makeCssClassName("expandable")),t.setAttribute("aria-expanded",(1===n).toString()))},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),this.card.getAllInputs(e)},t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},t.JsonTypeName="Action.ShowCard",t}(z);t.ShowCardAction=J;var X=function(){function e(e){this._renderedActionCount=0,this.items=[],this.buttons=[],this._owner=e}return e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t)for(var n=0,r=t;n<r.length;n++){var o=r[n];if(e.constructor===o)return!1}return!0},e.prototype.refreshContainer=function(){if(this._actionCardContainer.innerHTML="",this._actionCard){this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);this._actionCard&&(this._actionCard.style.paddingLeft=t.left+"px",this._actionCard.style.paddingRight=t.right+"px",this._actionCard.style.marginLeft="-"+t.left+"px",this._actionCard.style.marginRight="-"+t.right+"px",0==t.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=t.bottom+"px",this._actionCard.style.marginBottom="-"+t.bottom+"px"),c.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},e.prototype.showActionCard=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.card.suppressStyle=t;var r=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=r,this._expandedAction=e,this.refreshContainer(),n&&(this.layoutChanged(),ie(e,!0))},e.prototype.collapseExpandedAction=function(){for(var e=0,t=this.buttons;e<t.length;e++){t[e].state=0}var n=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),n&&(this.layoutChanged(),ie(n,!1))},e.prototype.expandShowCardAction=function(e,t){for(var n=0,r=this.buttons;n<r.length;n++){var o=r[n];o.action!==e?o.state=2:o.state=1}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)},e.prototype.getParentContainer=function(){return this._owner instanceof ee?this._owner:this._owner.getParentContainer()},e.prototype.findActionButton=function(e){for(var t=0,n=this.buttons;t<n.length;t++){var r=n[t];if(r.action==e)return r}},e.prototype.actionExecuted=function(e){e instanceof J?e===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(e,!0):this.collapseExpandedAction()},e.prototype.parse=function(e,t){if(this.clear(),Array.isArray(e))for(var n=0,r=e;n<r.length;n++){var o=r[n],i=t.parseAction(this._owner,o,[],!this._owner.isDesignMode());i&&this.addAction(i)}},e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this.items)},e.prototype.getActionById=function(e){for(var t=void 0,n=0,r=this.items;n<r.length;n++){if(t=r[n].getActionById(e))break}return t},e.prototype.validateProperties=function(e){this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,s.ValidationEvent.TooManyActions,g.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this.items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,s.ValidationEvent.InteractivityNotAllowed,g.Strings.errors.interactivityNotAllowed());for(var t=0,n=this.items;t<n.length;t++){var r=n[t];this.isActionAllowed(r)||e.addFailure(this._owner,s.ValidationEvent.ActionTypeNotAllowed,g.Strings.errors.actionTypeNotAllowed(r.getJsonTypeName())),r.internalValidateProperties(e)}},e.prototype.render=function(e,t){var n=this._owner.hostConfig;if(n.supportsInteractivity){var r=document.createElement("div"),o=n.actions.maxActions?Math.min(n.actions.maxActions,this.items.length):this.items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,n.actions.preExpandSingleShowCardAction&&1==o&&this.items[0]instanceof J&&this.isActionAllowed(this.items[0]))this.showActionCard(this.items[0],!0),this._renderedActionCount=1;else{var i=document.createElement("div");if(i.className=n.makeCssClassName("ac-actionSet"),i.style.display="flex",i.setAttribute("role","menubar"),e==s.Orientation.Horizontal)if(i.style.flexDirection="row",this._owner.horizontalAlignment&&n.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:i.style.justifyContent="center";break;case s.HorizontalAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}else switch(n.actions.actionAlignment){case s.ActionAlignment.Center:i.style.justifyContent="center";break;case s.ActionAlignment.Right:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}else if(i.style.flexDirection="column",this._owner.horizontalAlignment&&n.actions.actionAlignment!=s.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case s.HorizontalAlignment.Center:i.style.alignItems="center";break;case s.HorizontalAlignment.Right:i.style.alignItems="flex-end";break;default:i.style.alignItems="flex-start"}else switch(n.actions.actionAlignment){case s.ActionAlignment.Center:i.style.alignItems="center";break;case s.ActionAlignment.Right:i.style.alignItems="flex-end";break;case s.ActionAlignment.Stretch:i.style.alignItems="stretch";break;default:i.style.alignItems="flex-start"}var a=this.getParentContainer();if(a)for(var l=a.getEffectiveStyle(),u=this.items.filter(this.isActionAllowed.bind(this)),d=0;d<u.length;d++){var p=this.findActionButton(u[d]);if(p||((p=new U(u[d],l)).onClick=function(e){e.action.execute()},this.buttons.push(p)),p.render(),p.action.renderedElement){if(u.length>1&&(p.action.renderedElement.setAttribute("aria-posinset",(d+1).toString()),p.action.renderedElement.setAttribute("aria-setsize",u.length.toString()),p.action.renderedElement.setAttribute("role","menuitem")),n.actions.actionsOrientation==s.Orientation.Horizontal&&n.actions.actionAlignment==s.ActionAlignment.Stretch?p.action.renderedElement.style.flex="0 1 100%":p.action.renderedElement.style.flex="0 1 auto",i.appendChild(p.action.renderedElement),this._renderedActionCount++,this._renderedActionCount>=n.actions.maxActions||d==this.items.length-1)break;if(n.actions.buttonSpacing>0){var f=document.createElement("div");e===s.Orientation.Horizontal?(f.style.flex="0 0 auto",f.style.width=n.actions.buttonSpacing+"px"):f.style.height=n.actions.buttonSpacing+"px",c.appendChild(i,f)}}}var h=document.createElement("div");h.style.overflow="hidden",h.appendChild(i),c.appendChild(r,h)}c.appendChild(r,this._actionCardContainer);for(var g=0,m=this.buttons;g<m.length;g++){var y=m[g];if(1==y.state){this.expandShowCardAction(y.action,!1);break}}return this._renderedActionCount>0?r:void 0}},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this.items.indexOf(e)<0))throw new Error(g.Strings.errors.actionAlreadyParented());this.items.push(e),e.parent||e.setParent(this._owner),e._actionCollection=this},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction==e&&this.collapseExpandedAction();var t=this.items.indexOf(e);if(t>=0){this.items.splice(t,1),e.setParent(void 0),e._actionCollection=void 0;for(var n=0;n<this.buttons.length;n++)if(this.buttons[n].action==e){this.buttons.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this.items=[],this.buttons=[],this._expandedAction=void 0,this._renderedActionCount=0},e.prototype.getAllInputs=function(e){void 0===e&&(e=!0);var t=[];if(e)for(var n=0,r=this.items;n<r.length;n++){var o=r[n];t=t.concat(o.getAllInputs())}return t},e.prototype.getResourceInformation=function(){for(var e=[],t=0,n=this.items;t<n.length;t++){var r=n[t];e=e.concat(r.getResourceInformation())}return e},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}(),K=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new X(t),t}return i(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},t.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.items.length},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.items[t]:e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),e?this._actionCollection.getAllInputs():[]},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.findDOMNodeOwner=function(t){for(var n=void 0,r=0,o=this._actionCollection.items;r<o.length;r++){if(n=o[r].findDOMNodeOwner(t))return n}return e.prototype.findDOMNodeOwner.call(this,t)},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new f.EnumProperty(f.Versions.v1_1,"orientation",s.Orientation),a([f.property(t.orientationProperty)],t.prototype,"orientation",void 0),t}(m);t.ActionSet=K;var Z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bleed=!1,t}return i(t,e),Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.adjustRenderedElementSize=function(t){e.prototype.adjustRenderedElementSize.call(this,t),this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=c.stringToCssColor(e.backgroundColor);this.renderedElement.style.backgroundColor=t,this.renderedElement.style.border="1px solid "+t}}},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new l.SpacingDefinition;if(this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.isBleeding()){var n=new l.PaddingDefinition;this.getImmediateSurroundingPadding(n);var r=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.renderedElement.style.marginRight="-"+r.right+"px",this.renderedElement.style.marginLeft="-"+r.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+r.top+"px",this.renderedElement.style.marginBottom="-"+r.bottom+"px"),this.separatorElement&&this.separatorOrientation==s.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+r.left+"px",this.separatorElement.style.marginRight="-"+r.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===s.Orientation.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},t.prototype.getHasBackground=function(){for(var e=this.parent;e;){var n=e instanceof ee&&e.backgroundImage.isValid();if(e instanceof t&&this.hasExplicitStyle&&(e.getEffectiveStyle()!=this.getEffectiveStyle()||n))return!0;e=e.parent}return!1},t.prototype.getDefaultPadding=function(){return this.getHasBackground()?new l.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(t.styleProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var r=this.getValue(t.styleProperty);void 0!==r&&(this.hostConfig.containerStyles.getStyleByName(r)||n.addFailure(this,s.ValidationEvent.InvalidPropertyValue,g.Strings.errors.invalidPropertyValue(r,"style")))},t.prototype.render=function(){var t=e.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),t},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},t.styleProperty=new f.ValueSetProperty(f.Versions.v1_0,"style",[{value:s.ContainerStyle.Default},{value:s.ContainerStyle.Emphasis},{targetVersion:f.Versions.v1_2,value:s.ContainerStyle.Accent},{targetVersion:f.Versions.v1_2,value:s.ContainerStyle.Good},{targetVersion:f.Versions.v1_2,value:s.ContainerStyle.Attention},{targetVersion:f.Versions.v1_2,value:s.ContainerStyle.Warning}]),t.bleedProperty=new f.BoolProperty(f.Versions.v1_2,"bleed",!1),t.minHeightProperty=new f.PixelSizeProperty(f.Versions.v1_2,"minHeight"),a([f.property(t.styleProperty)],t.prototype,"style",null),a([f.property(t.bleedProperty)],t.prototype,"_bleed",void 0),a([f.property(t.minHeightProperty)],t.prototype,"minPixelHeight",void 0),t}(P);t.StylableCardElementContainer=Z;var $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getSchemaKey=function(){return"BackgroundImage"},t.prototype.internalParse=function(t,n){if("string"!=typeof t)return e.prototype.internalParse.call(this,t,n);this.resetDefaultValues(),this.url=t},t.prototype.apply=function(e){if(this.url&&e.renderedElement){switch(e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(t.urlProperty,this.url)+"')",this.fillMode){case s.FillMode.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case s.FillMode.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case s.FillMode.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case s.FillMode.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat",e.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case s.HorizontalAlignment.Center:e.renderedElement.style.backgroundPositionX="center";break;case s.HorizontalAlignment.Right:e.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case s.VerticalAlignment.Center:e.renderedElement.style.backgroundPositionY="center";break;case s.VerticalAlignment.Bottom:e.renderedElement.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){return!!this.url},t.urlProperty=new f.StringProperty(f.Versions.v1_0,"url"),t.fillModeProperty=new f.EnumProperty(f.Versions.v1_2,"fillMode",s.FillMode,s.FillMode.Cover),t.horizontalAlignmentProperty=new f.EnumProperty(f.Versions.v1_2,"horizontalAlignment",s.HorizontalAlignment,s.HorizontalAlignment.Left),t.verticalAlignmentProperty=new f.EnumProperty(f.Versions.v1_2,"verticalAlignment",s.VerticalAlignment,s.VerticalAlignment.Top),a([f.property(t.urlProperty)],t.prototype,"url",void 0),a([f.property(t.fillModeProperty)],t.prototype,"fillMode",void 0),a([f.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),a([f.property(t.verticalAlignmentProperty)],t.prototype,"verticalAlignment",void 0),t}(f.SerializableObject);t.BackgroundImage=$;var ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.verticalContentAlignment=s.VerticalAlignment.Top,t._items=[],t._renderedItems=[],t}return i(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),t.prototype.insertItemAt=function(e,t,n){if(e.parent&&!n)throw new Error(g.Strings.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(g.Strings.errors.elementTypeNotStandalone(e.getJsonTypeName()));t<0||t>=this._items.length?this._items.push(e):this._items.splice(t,0,e),e.setParent(this)},t.prototype.supportsExcplitiHeight=function(){return!0},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),e.prototype.applyBackground.call(this)},t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig,t=document.createElement("div");switch(void 0!==this.rtl&&this.rtl&&(t.dir="rtl"),t.classList.add(e.makeCssClassName("ac-container")),t.style.display="flex",t.style.flexDirection="column",l.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case s.VerticalAlignment.Center:t.style.justifyContent="center";break;case s.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}if(this._items.length>0)for(var n=0,r=this._items;n<r.length;n++){var o=r[n],i=this.isElementAllowed(o)?o.render():void 0;i&&(this._renderedItems.length>0&&o.separatorElement&&(o.separatorElement.style.flex="0 0 auto",c.appendChild(t,o.separatorElement)),c.appendChild(t,i),this._renderedItems.push(o))}else if(this.isDesignMode()){var a=this.createPlaceholderElement();a.style.width="100%",a.style.height="100%",t.appendChild(a)}return t},t.prototype.truncateOverflow=function(e){if(this.renderedElement){for(var t=this.renderedElement.offsetTop+e+1,n=function(e){var r=e.renderedElement;if(r)switch(c.getFitStatus(r,t)){case s.ContainerFitStatus.FullyInContainer:e.resetOverflow()&&n(e);break;case s.ContainerFitStatus.Overflowing:var o=t-r.offsetTop;e.handleOverflow(o);break;case s.ContainerFitStatus.FullyOutOfContainer:e.handleOverflow(0)}},r=0,o=this._items;r<o.length;r++){var i=o[r];n(i)}return!0}return!1},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++){t[e].resetOverflow()}},t.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var r=t[this.getItemsCollectionPropertyName()];if(Array.isArray(r))for(var o=0,i=r;o<i.length;o++){var a=i[o],s=n.parseElement(this,a,!this.isDesignMode());s&&this.insertItemAt(s,-1,!0)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getItemsCollectionPropertyName(),this._items)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=0,t=this._renderedItems;e<t.length;e++){var n=t[e];if(n.isVisible)return n}},t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){for(var t=this.isDesignMode(),n=0,r=this._items;n<r.length;n++){var o=r[n];if(o.isVisible||t)return o==e}return!1},t.prototype.isLastElement=function(e){for(var t=this.isDesignMode(),n=this._items.length-1;n>=0;n--)if(this._items[n].isVisible||t)return this._items[n]==e;return!1},t.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()==this.getEffectiveStyle())},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.addItem=function(e){this.insertItemAt(e,-1,!1)},t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),!1)},t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.clear=function(){this._items=[],this._renderedItems=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&(this.selectAction&&(n=this.selectAction.getActionById(t)),!n))for(var r=0,o=this._items;r<o.length;r++){if(n=o[r].getActionById(t))break}return n},Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new f.SerializableObjectProperty(f.Versions.v1_0,"backgroundImage",$),t.verticalContentAlignmentProperty=new f.EnumProperty(f.Versions.v1_1,"verticalContentAlignment",s.VerticalAlignment,s.VerticalAlignment.Top),t.rtlProperty=new f.BoolProperty(f.Versions.v1_0,"rtl"),a([f.property(t.backgroundImageProperty)],t.prototype,"backgroundImage",null),a([f.property(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0),a([f.property(t.rtlProperty)],t.prototype,"rtl",void 0),t}(Z);t.Container=ee;var te=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n.width="stretch",n._computedWeight=0,n.width=t,n}return i(t,e),t.prototype.adjustRenderedElementSize=function(e){this.isDesignMode()?(e.style.minWidth="20px",e.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.style.minWidth="0",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?e.style.flex="0 1 auto":"stretch"===this.width?e.style.flex="1 1 50px":this.width instanceof l.SizeAndUnit&&(this.width.unit==s.SizeUnit.Pixel?(e.style.flex="0 0 auto",e.style.width=this.width.physicalSize+"px"):e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return s.Orientation.Vertical},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof ne)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new f.CustomProperty(f.Versions.v1_0,"width",(function(e,t,n,r){var o=t.defaultValue,i=n[t.name],a=!1;if("number"!=typeof i||isNaN(i))if("auto"===i||"stretch"===i)o=i;else if("string"==typeof i)try{(o=l.SizeAndUnit.parse(i)).unit===s.SizeUnit.Pixel&&t.targetVersion.compareTo(r.targetVersion)>0&&(a=!0)}catch(e){a=!0}else a=!0;else o=new l.SizeAndUnit(i,s.SizeUnit.Weight);return a&&(r.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,g.Strings.errors.invalidColumnWidth(i)),o="auto"),o}),(function(e,t,n,r,o){r instanceof l.SizeAndUnit?r.unit===s.SizeUnit.Pixel?o.serializeValue(n,"width",r.physicalSize+"px"):o.serializeNumber(n,"width",r.physicalSize):o.serializeValue(n,"width",r)}),"stretch"),a([f.property(t.widthProperty)],t.prototype,"width",void 0),t}(ee);t.Column=te;var ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t}return i(t,e),t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),(function(e){return e&&"Column"!==e?void 0:new te}),(function(e,n){t.logParseEvent(void 0,s.ValidationEvent.ElementTypeNotAllowed,g.Strings.errors.elementTypeNotAllowed(e))}))},t.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",l.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case s.HorizontalAlignment.Center:t.style.justifyContent="center";break;case s.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}for(var n=0,r=0,o=this._columns;r<o.length;r++){(u=o[r]).width instanceof l.SizeAndUnit&&u.width.unit==s.SizeUnit.Weight&&(n+=u.width.physicalSize)}for(var i=0,a=this._columns;i<a.length;i++){var u;if((u=a[i]).width instanceof l.SizeAndUnit&&u.width.unit==s.SizeUnit.Weight&&n>0){var d=100/n*u.width.physicalSize;u._computedWeight=d}var p=u.render();p&&(this._renderedColumns.length>0&&u.separatorElement&&(u.separatorElement.style.flex="0 0 auto",c.appendChild(t,u.separatorElement)),c.appendChild(t,p),this._renderedColumns.push(u))}return this._renderedColumns.length>0?t:void 0}},t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++){n[t].handleOverflow(e)}return!0},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++){t[e].resetOverflow()}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var r=t.columns;if(Array.isArray(r))for(var o=0,i=r;o<i.length;o++){var a=i[o],s=this.createColumnInstance(a,n);s&&this._columns.push(s)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,"columns",this._columns)},t.prototype.isFirstElement=function(e){for(var t=0,n=this._columns;t<n.length;t++){var r=n[t];if(r.isVisible)return r==e}return!1},t.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtTop())return!0}return!1},t.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtBottom())return!0}return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0,r=0,o=0,i=this._columns;o<i.length;o++){var a=i[o];"number"==typeof a.width?n++:"stretch"===a.width&&r++}n>0&&r>0&&t.addFailure(this,s.ValidationEvent.Hint,g.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())},t.prototype.addColumn=function(e){if(e.parent)throw new Error(g.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(e),e.setParent(this)},t.prototype.removeItem=function(e){if(e instanceof te){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof te?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0==this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)==this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){for(var t=void 0,n=0,r=this._columns;n<r.length;n++){if(t=r[n].getActionById(e))break}return t},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(Z);function re(e){var t=e.getRootElement(),n=t&&t.onImageLoaded?t.onImageLoaded:fe.onImageLoaded;n&&n(e)}function oe(e,t,n){var r=e.getRootElement(),o=r&&r.onAnchorClicked?r.onAnchorClicked:fe.onAnchorClicked;return void 0!==o&&o(e,t,n)}function ie(e,t){var n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:fe.onInlineCardExpanded;r&&r(e,t)}function ae(e,t){void 0===t&&(t=!0);var n=e.getRootElement();t&&n.updateLayout();var r=n,o=r&&r.onElementVisibilityChanged?r.onElementVisibilityChanged:fe.onElementVisibilityChanged;void 0!==o&&o(e)}t.ColumnSet=ne;var se=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new X(t),t}return i(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(t){var n=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return n&&(c.appendChild(t,c.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},s.Orientation.Horizontal)),c.appendChild(t,n)),this.renderIfEmpty||t.children.length>0?t:void 0}},t.prototype.getHasExpandedAction=function(){return 0!=this.renderedActionCount&&(1==this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getActionCount=function(){return this._actionCollection.items.length},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.items[t]:e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0==this._actionCollection.items.length},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var n=e.prototype.getAllInputs.call(this,t);return t&&(n=n.concat(this._actionCollection.getAllInputs(t))),n},t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},t.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(ee);t.ContainerWithActions=se;var le=function(e){function t(t,n){var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r}return i(t,e),t.prototype.parse=function(e,t,n){var r=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==r){if(r instanceof V)return r;n.logParseEvent(e,s.ValidationEvent.ActionTypeNotAllowed,g.Strings.errors.actionTypeNotAllowed(r.getJsonTypeName()))}n.logParseEvent(e,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.propertyMustBeSet("action"))},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)},t}(f.PropertyDefinition);t.RefreshActionProperty=le;var ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e),e&&e.setParent(this.parent)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"RefreshDefinition"},t.actionProperty=new le(f.Versions.v1_4,"action"),t.userIdsProperty=new f.StringArrayProperty(f.Versions.v1_4,"userIds"),a([f.property(t.actionProperty)],t.prototype,"action",null),a([f.property(t.userIdsProperty)],t.prototype,"userIds",void 0),t}(f.SerializableObject);t.RefreshDefinition=ce;var ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getSchemaKey=function(){return"AuthCardButton"},t.typeProperty=new f.StringProperty(f.Versions.v1_4,"type"),t.titleProperty=new f.StringProperty(f.Versions.v1_4,"title"),t.imageProperty=new f.StringProperty(f.Versions.v1_4,"image"),t.valueProperty=new f.StringProperty(f.Versions.v1_4,"value"),a([f.property(t.typeProperty)],t.prototype,"type",void 0),a([f.property(t.titleProperty)],t.prototype,"title",void 0),a([f.property(t.imageProperty)],t.prototype,"image",void 0),a([f.property(t.valueProperty)],t.prototype,"value",void 0),t}(f.SerializableObject);t.AuthCardButton=ue;var de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getSchemaKey=function(){return"TokenExchangeResource"},t.idProperty=new f.StringProperty(f.Versions.v1_4,"id"),t.uriProperty=new f.StringProperty(f.Versions.v1_4,"uri"),t.providerIdProperty=new f.StringProperty(f.Versions.v1_4,"providerId"),a([f.property(t.idProperty)],t.prototype,"id",void 0),a([f.property(t.uriProperty)],t.prototype,"uri",void 0),a([f.property(t.providerIdProperty)],t.prototype,"providerId",void 0),t}(f.SerializableObject);t.TokenExchangeResource=de;var pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.getSchemaKey=function(){return"Authentication"},t.textProperty=new f.StringProperty(f.Versions.v1_4,"text"),t.connectionNameProperty=new f.StringProperty(f.Versions.v1_4,"connectionName"),t.buttonsProperty=new f.SerializableObjectCollectionProperty(f.Versions.v1_4,"buttons",ue),t.tokenExchangeResourceProperty=new f.SerializableObjectProperty(f.Versions.v1_4,"tokenExchangeResource",de,!0),a([f.property(t.textProperty)],t.prototype,"text",void 0),a([f.property(t.connectionNameProperty)],t.prototype,"connectionName",void 0),a([f.property(t.buttonsProperty)],t.prototype,"buttons",void 0),a([f.property(t.tokenExchangeResourceProperty)],t.prototype,"tokenExchangeResource",void 0),t}(f.SerializableObject);t.Authentication=pe;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.designMode=!1,t}return i(t,e),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e),e&&(e.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error(g.Strings.errors.processMarkdownEventRemoved())},set:function(e){throw new Error(g.Strings.errors.processMarkdownEventRemoved())},enumerable:!1,configurable:!0}),t.applyMarkdown=function(e){var n={didProcess:!1};if(t.onProcessMarkdown)t.onProcessMarkdown(e,n);else if(window.markdownit){var r=window.markdownit;n.outputHtml=r().render(e),n.didProcess=!0}else o.warn(g.Strings.errors.markdownProcessingNotEnabled);return n},t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major==this.version.major&&this.maxVersion.minor<this.version.minor)},t.prototype.getDefaultSerializationContext=function(){return new me(this.version)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.internalParse=function(n,r){this._fallbackCard=void 0;var o=r.parseElement(void 0,n.fallback,!this.isDesignMode());o&&(this._fallbackCard=new t,this._fallbackCard.addItem(o)),e.prototype.internalParse.call(this,n,r)},t.prototype.internalToJSON=function(n,r){this.setValue(t.versionProperty,r.targetVersion),e.prototype.internalToJSON.call(this,n,r)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return l.GlobalSettings.useAdvancedCardBottomTruncation&&t&&t.style.removeProperty("minHeight"),t},t.prototype.getHasBackground=function(){return!0},t.prototype.getDefaultPadding=function(){return new l.PaddingDefinition(s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding,s.Spacing.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!==this.getValue(m.typeNameProperty)&&t.addFailure(this,s.ValidationEvent.MissingCardType,g.Strings.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,s.ValidationEvent.UnsupportedCardVersion,g.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):t.addFailure(this,s.ValidationEvent.PropertyCantBeNull,g.Strings.errors.propertyMustBeSet("version"))},t.prototype.render=function(t){var n;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,n=this._fallbackCard.render()):(n=e.prototype.render.call(this))&&(n.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),l.GlobalSettings.setTabIndexAtCardRoot&&(n.tabIndex=0),this.speak&&n.setAttribute("aria-label",this.speak)),t&&(c.appendChild(t,n),this.updateLayout()),n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),l.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var n=this.hostConfig.getEffectiveSpacing(s.Spacing.Default);this.handleOverflow(this.renderedElement.offsetHeight-n)}},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new f.CustomProperty(f.Versions.v1_0,"$schema",(function(e,n,r,o){return t.schemaUrl}),(function(e,n,r,o,i){i.serializeValue(r,n.name,t.schemaUrl)})),t.versionProperty=new f.CustomProperty(f.Versions.v1_0,"version",(function(e,t,n,r){var o=f.Version.parse(n[t.name],r);return void 0===o&&(o=f.Versions.latest,r.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,g.Strings.errors.invalidCardVersion(o.toString()))),o}),(function(e,t,n,r,o){void 0!==r&&o.serializeValue(n,t.name,r.toString())}),f.Versions.v1_0),t.fallbackTextProperty=new f.StringProperty(f.Versions.v1_0,"fallbackText"),t.speakProperty=new f.StringProperty(f.Versions.v1_0,"speak"),t.refreshProperty=new f.SerializableObjectProperty(f.Versions.v1_4,"refresh",ce,!0),t.authenticationProperty=new f.SerializableObjectProperty(f.Versions.v1_4,"authentication",pe,!0),a([f.property(t.versionProperty)],t.prototype,"version",void 0),a([f.property(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0),a([f.property(t.speakProperty)],t.prototype,"speak",void 0),a([f.property(t.refreshProperty)],t.prototype,"refresh",null),a([f.property(t.authenticationProperty)],t.prototype,"authentication",void 0),t}(se);t.AdaptiveCard=fe;var he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suppressStyle=!1,t}return i(t,e),t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(fe.$schemaProperty,fe.versionProperty)},t.prototype.getDefaultPadding=function(){return new l.PaddingDefinition(this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding,this.suppressStyle?s.Spacing.None:s.Spacing.Padding,s.Spacing.Padding)},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?s.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:s.ContainerStyle.Emphasis},enumerable:!1,configurable:!0}),t.prototype.render=function(t){var n=e.prototype.render.call(this,t);return n&&(n.setAttribute("aria-live","polite"),n.removeAttribute("tabindex")),n},t}(fe),ge=function(){function e(){}return e.populateWithDefaultElements=function(e){e.clear(),e.register("Container",ee),e.register("TextBlock",S),e.register("RichTextBlock",b,f.Versions.v1_2),e.register("TextRun",C,f.Versions.v1_2),e.register("Image",I),e.register("ImageSet",_),e.register("Media",k,f.Versions.v1_1),e.register("FactSet",T),e.register("ColumnSet",ne),e.register("ActionSet",K,f.Versions.v1_2),e.register("Input.Text",N),e.register("Input.Date",F),e.register("Input.Time",B),e.register("Input.Number",R),e.register("Input.ChoiceSet",L),e.register("Input.Toggle",O)},e.populateWithDefaultActions=function(e){e.clear(),e.register(j.JsonTypeName,j),e.register(G.JsonTypeName,G),e.register(J.JsonTypeName,J),e.register(q.JsonTypeName,q,f.Versions.v1_2),e.register(V.JsonTypeName,V,f.Versions.v1_4)},e.reset=function(){e.populateWithDefaultElements(e.elements),e.populateWithDefaultActions(e.actions)},e.elements=new h.CardObjectRegistry,e.actions=new h.CardObjectRegistry,e}();t.GlobalRegistry=ge,ge.reset();var me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.internalParseCardObject=function(e,t,n,r,o,i){var a=void 0;if(t&&"object"==typeof t){var s=c.parseString(t.type);if(s)if(n.indexOf(s)>=0)i(s,1);else{var u=!1;if((a=o(s))?(a.setParent(e),a.parse(t,this),u=l.GlobalSettings.enableFallback&&r&&a.shouldFallback()):(u=l.GlobalSettings.enableFallback&&r,i(s,0)),u){var d=t.fallback;!d&&e&&e.setShouldFallback(!0),"string"==typeof d&&"drop"===d.toLowerCase()?a=void 0:"object"==typeof d&&(a=this.internalParseCardObject(e,d,n,!0,o,i))}}}return a},t.prototype.cardObjectParsed=function(e,t){e instanceof z&&this.onParseAction?this.onParseAction(e,t,this):e instanceof m&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof z?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof m)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,r,o,i){var a=this.internalParseCardObject(e,t,n,r,o,i);return void 0!==a&&this.cardObjectParsed(a,t),a},t.prototype.parseElement=function(e,t,n){var r=this;return this.parseCardObject(e,t,[],n,(function(e){return r.elementRegistry.createInstance(e,r.targetVersion)}),(function(e,t){0===t?r.logParseEvent(void 0,s.ValidationEvent.UnknownElementType,g.Strings.errors.unknownElementType(e)):r.logParseEvent(void 0,s.ValidationEvent.ElementTypeNotAllowed,g.Strings.errors.elementTypeNotAllowed(e))}))},t.prototype.parseAction=function(e,t,n,r){var o=this;return this.parseCardObject(e,t,n,r,(function(e){return o.actionRegistry.createInstance(e,o.targetVersion)}),(function(e,t){0==t?o.logParseEvent(void 0,s.ValidationEvent.UnknownActionType,g.Strings.errors.unknownActionType(e)):o.logParseEvent(void 0,s.ValidationEvent.ActionTypeNotAllowed,g.Strings.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){return this._elementRegistry?this._elementRegistry:ge.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){return this._actionRegistry?this._actionRegistry:ge.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t}(f.BaseSerializationContext);t.SerializationContext=me},19146:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.CardObject=t.ValidationResults=void 0;var a=n(91654),s=n(42510),l=n(27583),c=n(35387),u=n(65120),d=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:a.ValidationPhase.Validation,source:e,event:t,message:n})},e}();t.ValidationResults=d;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldFallback=!1,t}return o(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e){return!!this._renderedElement&&this._renderedElement.contains(e)},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(l.GlobalSettings.allowPreProcessingPropertyValues){for(var r=this;r&&!r.onPreProcessPropertyValue;)r=r.parent;if(r&&r.onPreProcessPropertyValue)return r.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1==e.allIds[this.id]&&e.addFailure(this,a.ValidationEvent.DuplicateId,s.Strings.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.validateProperties=function(){var e=new d;return this.internalValidateProperties(e),e},t.prototype.findDOMNodeOwner=function(e){return this.contains(e)?this:void 0},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),t.typeNameProperty=new u.StringProperty(u.Versions.v1_0,"type",void 0,void 0,void 0,(function(e){return e.getJsonTypeName()})),t.idProperty=new u.StringProperty(u.Versions.v1_0,"id"),t.requiresProperty=new u.SerializableObjectProperty(u.Versions.v1_2,"requires",c.HostCapabilities,!1,new c.HostCapabilities),i([u.property(t.idProperty)],t.prototype,"id",void 0),i([u.property(t.requiresProperty)],t.prototype,"requires",null),t}(u.SerializableObject);t.CardObject=p},29833:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelAdapter=void 0;var n=function(){};t.ChannelAdapter=n},91654:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.RefreshMode=t.ContainerFitStatus=t.ValidationEvent=t.ValidationPhase=t.ContainerStyle=t.InputTextStyle=t.ActionIconPlacement=t.FillMode=t.Orientation=t.ShowCardActionMode=t.ImageStyle=t.ActionAlignment=t.VerticalAlignment=t.HorizontalAlignment=t.TextColor=t.Spacing=t.FontType=t.TextWeight=t.TextSize=t.SizeUnit=t.ImageSize=t.Size=t.ActionStyle=void 0;var n=function(){function e(){}return e.Default="default",e.Positive="positive",e.Destructive="destructive",e}();t.ActionStyle=n,function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(t.ImageSize||(t.ImageSize={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(t.SizeUnit||(t.SizeUnit={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(t.FontType||(t.FontType={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacing={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(t.TextColor||(t.TextColor={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.FillMode||(t.FillMode={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(t.ActionIconPlacement||(t.ActionIconPlacement={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email"}(t.InputTextStyle||(t.InputTextStyle={}));var r=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();t.ContainerStyle=r,function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(t.ValidationPhase||(t.ValidationPhase={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other"}(t.ValidationEvent||(t.ValidationEvent={})),function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatus={})),function(e){e[e.Disabled=0]="Disabled",e[e.Manual=1]="Manual",e[e.Automatic=2]="Automatic"}(t.RefreshMode||(t.RefreshMode={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(t.LogLevel||(t.LogLevel={}))},35387:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.HostCapabilities=void 0;var i=n(65120),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._capabilities={},t}return o(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var r in t){var o=t[r];if("string"==typeof o)if("*"==o)this.addCapability(r,"*");else{var a=i.Version.parse(o,n);a&&a.isValid&&this.addCapability(r,a)}}},t.prototype.internalToJSON=function(t,n){for(var r in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[r]=this._capabilities[r]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"==t||"*"==this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(i.SerializableObject);t.HostCapabilities=a},65235:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHostConfig=t.HostConfig=t.FontTypeSet=t.FontTypeDefinition=t.ContainerStyleSet=t.ContainerStyleDefinition=t.ColorSetDefinition=t.ActionsConfig=t.ShowCardActionConfig=t.FactSetConfig=t.FactTitleDefinition=t.FactTextDefinition=t.InputConfig=t.InputLabelConfig=t.RequiredInputLabelTextDefinition=t.BaseTextDefinition=t.MediaConfig=t.ImageSetConfig=t.AdaptiveCardConfig=t.TextColorDefinition=t.ColorDefinition=void 0;var i=n(91654),a=n(96765),s=n(27583),l=n(35387);function c(e,t,n){if("string"==typeof t){var r=a.parseEnum(e,t,n);return void 0!==r?r:n}return"number"==typeof t?t:n}var u=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}();t.ColorDefinition=u;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.highlightColors=new u("#22000000","#11000000"),t}return o(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(u);t.TextColorDefinition=d;var p=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)};t.AdaptiveCardConfig=p;var f=function(){function e(e){this.imageSize=i.Size.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=a.parseNumber(e.maxImageHeight,100))}return e.prototype.toJSON=function(){return{imageSize:i.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},e}();t.ImageSetConfig=f;var h=function(){function e(e){this.allowInlinePlayback=!0,e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},e}();t.MediaConfig=h;var g=function(){function e(e){this.size=i.TextSize.Default,this.color=i.TextColor.Default,this.isSubtle=!1,this.weight=i.TextWeight.Default,e&&(this.size=c(i.TextSize,e.size,this.size),this.color=c(i.TextColor,e.color,this.color),this.isSubtle=e.isSubtle||this.isSubtle,this.weight=c(i.TextWeight,e.weight,this.getDefaultWeight()))}return e.prototype.getDefaultWeight=function(){return i.TextWeight.Default},e.prototype.toJSON=function(){return{size:i.TextSize[this.size],color:i.TextColor[this.color],isSubtle:this.isSubtle,weight:i.TextWeight[this.weight]}},e}();t.BaseTextDefinition=g;var m=function(e){function t(t){var n=e.call(this,t)||this;return n.suffix=" *",n.suffixColor=i.TextColor.Attention,t&&(n.suffix=t.suffix||n.suffix,n.suffixColor=c(i.TextColor,t.suffixColor,n.suffixColor)),n}return o(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=i.TextColor[this.suffixColor],t},t}(g);t.RequiredInputLabelTextDefinition=m;var y=function(e){this.inputSpacing=i.Spacing.Small,this.requiredInputs=new m,this.optionalInputs=new g,e&&(this.inputSpacing=c(i.Spacing,e.inputSpacing,this.inputSpacing),this.requiredInputs=new m(e.requiredInputs),this.optionalInputs=new g(e.optionalInputs))};t.InputLabelConfig=y;var v=function(e){this.label=new y,this.errorMessage=new g({color:i.TextColor.Attention}),e&&(this.label=new y(e.label),this.errorMessage=new g(e.errorMessage))};t.InputConfig=v;var S=function(e){function t(t){var n=e.call(this,t)||this;return n.wrap=!0,t&&(n.wrap=null!=t.wrap?t.wrap:n.wrap),n}return o(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(g);t.FactTextDefinition=S;var C=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=i.TextWeight.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=c(i.TextWeight,t.weight,i.TextWeight.Bolder)),n}return o(t,e),t.prototype.getDefaultWeight=function(){return i.TextWeight.Bolder},t}(S);t.FactTitleDefinition=C;var b=function(e){this.title=new C,this.value=new S,this.spacing=10,e&&(this.title=new C(e.title),this.value=new S(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)};t.FactSetConfig=b;var E=function(){function e(e){this.actionMode=i.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=i.ContainerStyle.Emphasis,e&&(this.actionMode=c(i.ShowCardActionMode,e.actionMode,i.ShowCardActionMode.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:i.ContainerStyle.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:i.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}();t.ShowCardActionConfig=E;var T=function(){function e(e){if(this.maxActions=5,this.spacing=i.Spacing.Default,this.buttonSpacing=20,this.showCard=new E,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=i.Orientation.Horizontal,this.actionAlignment=i.ActionAlignment.Left,this.iconPlacement=i.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=c(i.Spacing,e.spacing&&e.spacing,i.Spacing.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new E(e.showCard),this.preExpandSingleShowCardAction=a.parseBool(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=c(i.Orientation,e.actionsOrientation,i.Orientation.Horizontal),this.actionAlignment=c(i.ActionAlignment,e.actionAlignment,i.ActionAlignment.Left),this.iconPlacement=c(i.ActionIconPlacement,e.iconPlacement,i.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap;try{var t=s.SizeAndUnit.parse(e.iconSize);t.unit==i.SizeUnit.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:i.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:i.Orientation[this.actionsOrientation],actionAlignment:i.ActionAlignment[this.actionAlignment]}},e}();t.ActionsConfig=T;var w=function(){function e(e){this.default=new d,this.dark=new d,this.light=new d,this.accent=new d,this.good=new d,this.warning=new d,this.attention=new d,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e}();t.ColorSetDefinition=w;var I=function(){function e(e){this.foregroundColors=new w({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}();t.ContainerStyleDefinition=I;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(I),_=function(){function e(e){if(this._allStyles={},this._allStyles[i.ContainerStyle.Default]=new P,this._allStyles[i.ContainerStyle.Emphasis]=new P,this._allStyles[i.ContainerStyle.Accent]=new P,this._allStyles[i.ContainerStyle.Good]=new P,this._allStyles[i.ContainerStyle.Attention]=new P,this._allStyles[i.ContainerStyle.Warning]=new P,e){this._allStyles[i.ContainerStyle.Default].parse(e[i.ContainerStyle.Default]),this._allStyles[i.ContainerStyle.Emphasis].parse(e[i.ContainerStyle.Emphasis]),this._allStyles[i.ContainerStyle.Accent].parse(e[i.ContainerStyle.Accent]),this._allStyles[i.ContainerStyle.Good].parse(e[i.ContainerStyle.Good]),this._allStyles[i.ContainerStyle.Attention].parse(e[i.ContainerStyle.Attention]),this._allStyles[i.ContainerStyle.Warning].parse(e[i.ContainerStyle.Warning]);var t=e.customStyles;if(t&&Array.isArray(t))for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o){var a=o.name;a&&"string"==typeof a&&(this._allStyles.hasOwnProperty(a)?this._allStyles[a].parse(o.style):this._allStyles[a]=new I(o.style))}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[i.ContainerStyle.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[i.ContainerStyle.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[i.ContainerStyle.Emphasis]},enumerable:!1,configurable:!0}),e}();t.ContainerStyleSet=_;var A=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}();t.FontTypeDefinition=A;var k=function(){function e(e){this.default=new A,this.monospace=new A("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case i.FontType.Monospace:return this.monospace;case i.FontType.Default:default:return this.default}},e}();t.FontTypeSet=k;var x=function(){function e(e){this.hostCapabilities=new l.HostCapabilities,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new _,this.inputs=new v,this.actions=new T,this.adaptiveCard=new p,this.imageSet=new f,this.media=new h,this.factSet=new b,this.alwaysAllowBleed=!1,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new A,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new k(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new _(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new v(e.inputs||this.inputs),this.actions=new T(e.actions||this.actions),this.adaptiveCard=new p(e.adaptiveCard||this.adaptiveCard),this.imageSet=new f(e.imageSet),this.factSet=new b(e.factSet))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e==i.FontType.Monospace?A.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case i.Spacing.Small:return this.spacing.small;case i.Spacing.Default:return this.spacing.default;case i.Spacing.Medium:return this.spacing.medium;case i.Spacing.Large:return this.spacing.large;case i.Spacing.ExtraLarge:return this.spacing.extraLarge;case i.Spacing.Padding:return this.spacing.padding;default:return 0}},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new s.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r];n.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+i)}return n},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,e).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}();t.HostConfig=x,t.defaultHostConfig=new x({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{color:i.TextColor.Accent,size:i.TextSize.ExtraLarge,weight:i.TextWeight.Bolder,isSubtle:!0,suffix:" (required)",suffixColor:i.TextColor.Good},optionalInputs:{color:i.TextColor.Warning,size:i.TextSize.Medium,weight:i.TextWeight.Lighter,isSubtle:!1}},errorMessage:{color:i.TextColor.Accent,size:i.TextSize.Small,weight:i.TextWeight.Bolder}},actions:{maxActions:5,spacing:i.Spacing.Default,buttonSpacing:10,showCard:{actionMode:i.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:i.Orientation.Horizontal,actionAlignment:i.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:i.Size.Medium,maxImageHeight:100},factSet:{title:{color:i.TextColor.Default,size:i.TextSize.Default,isSubtle:!1,weight:i.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:i.TextColor.Default,size:i.TextSize.Default,isSubtle:!1,weight:i.TextWeight.Default,wrap:!0},spacing:10}})},24685:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CardObjectRegistry=void 0;var r=n(65120),o=function(){function e(){this._items={}}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.register=function(e,t,n){void 0===n&&(n=r.Versions.v1_0);var o=this.findByName(e);void 0!==o?o.objectType=t:o={typeName:e,objectType:t,schemaVersion:n},this._items[e]=o},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.createInstance=function(e,t){var n=this.findByName(e);return n&&n.schemaVersion.compareTo(t)<=0?new n.objectType:void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e}();t.CardObjectRegistry=o},65120:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableObject=t.property=t.SerializableObjectSchema=t.CustomProperty=t.SerializableObjectCollectionProperty=t.SerializableObjectProperty=t.EnumProperty=t.ValueSetProperty=t.StringArrayProperty=t.PixelSizeProperty=t.NumProperty=t.BoolProperty=t.StringProperty=t.PropertyDefinition=t.BaseSerializationContext=t.isVersionLessOrEqual=t.Versions=t.Version=void 0;var i=n(27583),a=n(96765),s=n(91654),l=n(42510),c=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var r=new e;r._versionString=t;var o=/(\d+).(\d+)/gi.exec(t);return null!=o&&3==o.length?(r._major=parseInt(o[1]),r._minor=parseInt(o[2])):r._isValid=!1,r._isValid||n.logParseEvent(void 0,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidVersionString(r._versionString)),r}},e.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}();t.Version=c;var u=function(){function e(){}return e.v1_0=new c(1,0),e.v1_1=new c(1,1),e.v1_2=new c(1,2),e.v1_3=new c(1,3),e.v1_4=new c(1,4),e.latest=e.v1_4,e}();t.Versions=u,t.isVersionLessOrEqual=function(e,t){return!(e instanceof c)||(!(t instanceof c)||t.compareTo(e)>=0)};var d=function(){function e(e){void 0===e&&(e=u.latest),this.targetVersion=e,this._validationEvents=[]}return e.prototype.serializeValue=function(e,t,n,r,o){void 0===r&&(r=void 0),void 0===o&&(o=!1),null==n||n===r?i.GlobalSettings.enableFullJsonRoundTrip&&!o||delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeBool=function(e,t,n,r){null==n||n===r?delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,r){null==n||n===r||isNaN(n)?delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,r,o){void 0===o&&(o=void 0);var i=t[n],a=null==i||void 0!==e[i];r==o||null==r?a&&delete t[n]:t[n]=e[r]},e.prototype.serializeArray=function(e,t,n){var r=[];if(n)for(var o=0,i=n;o<i.length;o++){var a=i[o],s=void 0;void 0!==(s=a instanceof I?a.toJSON(this):a.toJSON?a.toJSON():a)&&r.push(s)}0==r.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,r)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,r){this._validationEvents.push({source:e,phase:t,event:n,message:r})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,s.ValidationPhase.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e}();t.BaseSerializationContext=d;var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t}(d),f=function(){function e(t,n,r,o){this.targetVersion=t,this.name=n,this.defaultValue=r,this.onGetInitialValue=o,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,n,this.defaultValue)},e._sequentialNumber=0,e}();t.PropertyDefinition=f;var h=function(e){function t(t,n,r,o,i,a){void 0===r&&(r=!0);var s=e.call(this,t,n,i,a)||this;return s.targetVersion=t,s.name=n,s.treatEmptyAsUndefined=r,s.regEx=o,s.defaultValue=i,s.onGetInitialValue=a,s}return o(t,e),t.prototype.parse=function(e,t,n){var r=a.parseString(t[this.name],this.defaultValue);if(!(void 0===r||""===r&&this.treatEmptyAsUndefined)&&void 0!==this.regEx&&!this.regEx.exec(r))return void n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(r,this.name));return r},t.prototype.toJSON=function(e,t,n,r){r.serializeString(t,this.name,""===n&&this.treatEmptyAsUndefined?void 0:n,this.defaultValue)},t}(f);t.StringProperty=h;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parse=function(e,t,n){return a.parseBool(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)},t}(f);t.BoolProperty=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parse=function(e,t,n){return a.parseNumber(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,r){r.serializeNumber(t,this.name,n,this.defaultValue)},t}(f);t.NumProperty=m;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.parse=function(e,t,n){var r=void 0,o=t[this.name];if("string"==typeof o){var a=!1;try{var c=i.SizeAndUnit.parse(o,!0);c.unit==s.SizeUnit.Pixel&&(r=c.physicalSize,a=!0)}catch(e){}a||n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(t[this.name],"minHeight"))}return r},t.prototype.toJSON=function(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(f);t.PixelSizeProperty=y;var v=function(e){function t(t,n,r,o){var i=e.call(this,t,n,r,o)||this;return i.targetVersion=t,i.name=n,i.defaultValue=r,i.onGetInitialValue=o,i}return o(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r||!Array.isArray(r))return this.defaultValue;for(var o=[],i=0,a=r;i<a.length;i++){var l=a[i];"string"==typeof l?o.push(l):n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,'Invalid array value "'+l+'" of type "'+typeof l+'" ignored for "'+this.name+'".')}return o},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t}(f);t.StringArrayProperty=v;var S=function(e){function t(t,n,r,o,i){var a=e.call(this,t,n,o,i)||this;return a.targetVersion=t,a.name=n,a.values=r,a.defaultValue=o,a.onGetInitialValue=i,a}return o(t,e),t.prototype.isValidValue=function(e,t){for(var n=0,r=this.values;n<r.length;n++){var o=r[n];if(e.toLowerCase()===o.value.toLowerCase())return(o.targetVersion?o.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}return!1},t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.defaultValue;if("string"==typeof r)for(var o=0,i=this.values;o<i.length;o++){var a=i[o];if(r.toLowerCase()===a.value.toLowerCase()){var c=a.targetVersion?a.targetVersion:this.targetVersion;return c.compareTo(n.targetVersion)<=0?a.value:(n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(r,this.name,c.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(r,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){for(var o=!1,i=0,a=this.values;i<a.length;i++){var c=a[i];if(c.value===n){var u=c.targetVersion?c.targetVersion:this.targetVersion;if(u.compareTo(r.targetVersion)<=0){o=!0;break}r.logEvent(e,s.ValidationPhase.ToJSON,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(n,this.name,u.toString(),r.targetVersion.toString()))}}o&&r.serializeValue(t,this.name,n,this.defaultValue)},t}(f);t.ValueSetProperty=S;var C=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,o,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=r,s.defaultValue=o,s.onGetInitialValue=a,s._values=[],i)s._values=i;else for(var l in r){var c=parseInt(l,10);c>=0&&s._values.push({value:c})}return s}return o(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if("string"!=typeof r)return this.defaultValue;var o=a.getEnumValueByName(this.enumType,r);if(void 0!==o)for(var i=0,c=this.values;i<c.length;i++){var u=c[i];if(u.value===o){var d=u.targetVersion?u.targetVersion:this.targetVersion;return d.compareTo(n.targetVersion)<=0?o:(n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(r,this.name,d.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(r,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,r){if(void 0!==n){for(var o=!1,i=0,a=this.values;i<a.length;i++){var c=a[i];if(c.value===n){if((c.targetVersion?c.targetVersion:this.targetVersion).compareTo(r.targetVersion)<=0){o=!0;break}r.logEvent(e,s.ValidationPhase.ToJSON,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(n,this.name))}}o&&r.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)}},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(f);t.EnumProperty=C;var b=function(e){function t(t,n,r,o,i){void 0===o&&(o=!1);var a=e.call(this,t,n,i,(function(e){return a.nullable?void 0:new a.objectType}))||this;return a.targetVersion=t,a.name=n,a.objectType=r,a.nullable=o,a}return o(t,e),t.prototype.parse=function(e,t,n){var r=t[this.name];if(void 0===r)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var o=new this.objectType;return o.parse(r,n),o},t.prototype.toJSON=function(e,t,n,r){var o=void 0;void 0===n||n.hasAllDefaultValues()||(o=n.toJSON(r)),"object"==typeof o&&0===Object.keys(o).length&&(o=void 0),r.serializeValue(t,this.name,o,this.defaultValue,!0)},t}(f);t.SerializableObjectProperty=b;var E=function(e){function t(t,n,r,o){var i=e.call(this,t,n,void 0,(function(e){return[]}))||this;return i.targetVersion=t,i.name=n,i.objectType=r,i.onItemAdded=o,i}return o(t,e),t.prototype.parse=function(e,t,n){var r=[],o=t[this.name];if(Array.isArray(o))for(var i=0,a=o;i<a.length;i++){var s=a[i],l=new this.objectType;l.parse(s,n),r.push(l),this.onItemAdded&&this.onItemAdded(e,l)}return r.length>0?r:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,r){r.serializeArray(t,this.name,n)},t}(f);t.SerializableObjectCollectionProperty=E;var T=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t,n,i,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=r,s.onToJSON=o,s.defaultValue=i,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}return o(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,r){this.onToJSON(e,this,t,n,r)},t}(f);t.CustomProperty=T;var w=function(){function e(){this._properties=[]}return e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++)if(this._properties[t]===e)return t;return-1},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;n++)-1===this.indexOf(e[n])&&this._properties.push(e[n])},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++)for(var o=r[n];;){var i=this.indexOf(o);if(!(i>=0))break;this._properties.splice(i,1)}},e.prototype.getItemAt=function(e){return this._properties[e]},e.prototype.getCount=function(){return this._properties.length},e}();t.SerializableObjectSchema=w,t.property=function(e){return function(t,n){var r=Object.getOwnPropertyDescriptor(t,n)||{};r.get||r.set||(r.get=function(){return this.getValue(e)},r.set=function(t){this.setValue(e,t)},Object.defineProperty(t,n,r))}};var I=function(){function e(){this._propertyBag={},this._rawProperties={},this.maxVersion=e.defaultMaxVersion;for(var t=this.getSchema(),n=0;n<t.getCount();n++){var r=t.getItemAt(n);r.onGetInitialValue&&this.setValue(r,r.onGetInitialValue(this))}}return e.prototype.getDefaultSerializationContext=function(){return new p},e.prototype.populateSchema=function(t){var n=this.constructor,r=[];for(var o in n)try{var i=n[o];i instanceof f&&r.push(i)}catch(e){}if(r.length>0){var a=r.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,a)}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){null==t?delete this._propertyBag[e.getInternalName()]:this._propertyBag[e.getInternalName()]=t},e.prototype.internalParse=function(e,t){if(this._propertyBag={},this._rawProperties=i.GlobalSettings.enableFullJsonRoundTrip&&e||{},e)for(var n=this.getSchema(),r=0;r<n.getCount();r++){var o=n.getItemAt(r);if(o.isSerializationEnabled){var a=o.onGetInitialValue?o.onGetInitialValue(this):void 0;e.hasOwnProperty(o.name)&&(o.targetVersion.compareTo(t.targetVersion)<=0?a=o.parse(this,e,t):t.logParseEvent(this,s.ValidationEvent.UnsupportedProperty,l.Strings.errors.propertyNotSupported(o.name,o.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(o,a)}}else this.resetDefaultValues()},e.prototype.internalToJSON=function(e,t){for(var n=this.getSchema(),r=[],o=0;o<n.getCount();o++){var i=n.getItemAt(o);i.isSerializationEnabled&&i.targetVersion.compareTo(t.targetVersion)<=0&&-1===r.indexOf(i.name)&&(i.toJSON(this,e,this.getValue(i),t),r.push(i.name))}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.parse=function(e,t){this.internalParse(e,t||new p)},e.prototype.toJSON=function(e){var t;if(e&&e instanceof d?t=e:(t=this.getDefaultSerializationContext()).toJSONOriginalParam=e,this.shouldSerialize(t)){var n=void 0;return n=i.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);if(!this.hasDefaultValue(n))return!1}return!0},e.prototype.resetDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);this.setValue(n,n.defaultValue)}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new w,this.populateSchema(t),e._schemaCache[this.getSchemaKey()]=t),t},e.defaultMaxVersion=u.v1_3,e._schemaCache={},e}();t.SerializableObject=I},27583:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UUID=t.SizeAndUnit=t.PaddingDefinition=t.SpacingDefinition=t.StringWithSubstitutions=t.ContentTypes=t.GlobalSettings=void 0;var r=n(91654),o=function(){function e(){}return e.useAdvancedTextBlockTruncation=!0,e.useAdvancedCardBottomTruncation=!1,e.useMarkdownInRadioButtonAndCheckbox=!0,e.allowMarkForTextHighlighting=!1,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.setTabIndexAtCardRoot=!0,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.applets={logEnabled:!0,logLevel:r.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:r.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}},e}();t.GlobalSettings=o,t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var i=function(){function e(){this._isProcessed=!1}return e.prototype.getReferencedInputs=function(e,t){if(!t)throw new Error("The referencedInputs parameter cannot be null.");for(var n=0,r=e;n<r.length;n++){var o=r[n];null!=new RegExp("\\{{2}("+o.id+").value\\}{2}","gi").exec(this._original)&&o.id&&(t[o.id]=o)}},e.prototype.substituteInputValues=function(e,n){if(this._processed=this._original,this._original)for(var r=/\{{2}([a-z0-9_$@]+).value\}{2}/gi,o=void 0;null!==(o=r.exec(this._original));)for(var i=0,a=Object.keys(e);i<a.length;i++){var s=a[i];if(s.toLowerCase()==o[1].toLowerCase()){var l=e[s],c="";l.value&&(c=l.value),n===t.ContentTypes.applicationJson?c=(c=JSON.stringify(c)).slice(1,-1):n===t.ContentTypes.applicationXWwwFormUrlencoded&&(c=encodeURIComponent(c)),this._processed=this._processed.replace(o[0],c);break}}this._isProcessed=!0},e.prototype.getOriginal=function(){return this._original},e.prototype.get=function(){return this._isProcessed?this._processed:this._original},e.prototype.set=function(e){this._original=e,this._isProcessed=!1},e}();t.StringWithSubstitutions=i;var a=function(e,t,n,r){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=r};t.SpacingDefinition=a;var s=function(e,t,n,o){void 0===e&&(e=r.Spacing.None),void 0===t&&(t=r.Spacing.None),void 0===n&&(n=r.Spacing.None),void 0===o&&(o=r.Spacing.None),this.top=r.Spacing.None,this.right=r.Spacing.None,this.bottom=r.Spacing.None,this.left=r.Spacing.None,this.top=e,this.right=t,this.bottom=n,this.left=o};t.PaddingDefinition=s;var l=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var o=new e(0,r.SizeUnit.Weight);if("number"==typeof t)return o.physicalSize=t,o;if("string"==typeof t){var i=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(i&&i.length>=a)return o.physicalSize=parseInt(i[1]),3==i.length&&"px"==i[2]&&(o.unit=r.SizeUnit.Pixel),o}throw new Error("Invalid size: "+t)},e}();t.SizeAndUnit=l;var c=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&r|128]+e.lut[r>>8&255]+"-"+e.lut[r>>16&255]+e.lut[r>>24&255]+e.lut[255&o]+e.lut[o>>8&255]+e.lut[o>>16&255]+e.lut[o>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();t.UUID=c,c.initialize()},42510:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0;var n=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'+e+'". Fallback will be used if present.'},unknownActionType:function(e){return'Unknown action type "'+e+'". Fallback will be used if present.'},elementTypeNotAllowed:function(e){return'Element type "'+e+'" is not allowed in this context.'},actionTypeNotAllowed:function(e){return'Action type "'+e+'" is not allowed in this context.'},invalidPropertyValue:function(e,t){return'Invalid value "'+e+'" for property "'+t+'".'},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'+e+'" - defaulting to "auto".'},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'+e+'".'},invalidVersionString:function(e){return'Invalid version string "'+e+'".'},propertyValueNotSupported:function(e,t,n,r){return'Value "'+e+'" for property "'+t+'" is supported in version '+n+", but you are using version "+r+"."},propertyNotSupported:function(e,t,n){return'Property "'+e+'" is supported in version '+t+", but you are using version "+n+"."},indexOutOfRange:function(e){return"Index out of range ("+e+")."},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'+e+'" must be set.'},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded ("+e+")."},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version ("+e+") is not supported. The maximum supported card version is "+t+"."},duplicateId:function(e){return'Duplicate Id "'+e+'".'},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type "+e+" cannot be used as standalone elements."}},e.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}},e.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}},e.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.defaults={inlineActionTitle:function(){return"Inline Action"},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"}},e}();t.Strings=n},9893:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},n(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.formatText=void 0;var o=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){var n;if(t){for(var r=t;null!=(n=this._regularExpression.exec(t));)r=r.replace(n[0],this.internalFormat(e,n));return r}return t},e}(),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),r=null!=t[2]?t[2].toLowerCase():"compact";return"compact"!=r?n.toLocaleDateString(e,{day:"numeric",weekday:r,month:r,year:"numeric"}):n.toLocaleDateString()},t}(o),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(o);t.formatText=function(e,t){for(var n=t,r=0,o=[new i(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new a(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];r<o.length;r++){n=o[r].format(e,n)}return n}},96765:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearElementChildren=t.getFitStatus=t.truncate=t.stringToCssColor=t.renderSeparation=t.parseEnum=t.getEnumValueByName=t.parseBool=t.parseNumber=t.parseString=t.appendChild=t.generateUniqueId=t.isMobileOS=t.isInternetExplorer=void 0;var r=n(91654),o=n(27583);function i(e,t){for(var n in e){var r=parseInt(n,10);if(r>=0){var o=e[n];if(o&&"string"==typeof o&&o.toLowerCase()===t.toLowerCase())return r}}}function a(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+n+")"}}return e}function s(e,t){for(t+=1;t<e.length&&"<"==e[t];)for(;t<e.length&&">"!=e[t++];);return t}t.isInternetExplorer=function(){return void 0!==window.document.documentMode},t.isMobileOS=function(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)},t.generateUniqueId=function(){return"__ac-"+o.UUID.generate()},t.appendChild=function(e,t){t&&e.appendChild(t)},t.parseString=function(e,t){return"string"==typeof e?e:t},t.parseNumber=function(e,t){return"number"==typeof e?e:t},t.parseBool=function(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t},t.getEnumValueByName=i,t.parseEnum=function(e,t,n){if(!t)return n;var r=i(e,t);return void 0!==r?r:n},t.renderSeparation=function(e,t,n){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var o=document.createElement("div");o.className=e.makeCssClassName("ac-"+(n==r.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),o.setAttribute("aria-hidden","true");var i=t.lineColor?a(t.lineColor):"";return n==r.Orientation.Horizontal?t.lineThickness?(o.style.paddingTop=t.spacing/2+"px",o.style.marginBottom=t.spacing/2+"px",o.style.borderBottom=t.lineThickness+"px solid "+i):o.style.height=t.spacing+"px":t.lineThickness?(o.style.paddingLeft=t.spacing/2+"px",o.style.marginRight=t.spacing/2+"px",o.style.borderRight=t.lineThickness+"px solid "+i):o.style.width=t.spacing+"px",o.style.overflow="hidden",o.style.flex="0 0 auto",o}},t.stringToCssColor=a,t.truncate=function(e,t,n){var r=function(){return t-e.scrollHeight>=-1};if(!r()){for(var o=e.innerHTML,i=function(t){e.innerHTML=o.substring(0,t)+"..."},a=function(e){var t=[],n=s(e,-1);for(;n<e.length;)" "==e[n]&&t.push(n),n=s(e,n);return t}(o),l=0,c=a.length,u=0;l<c;){var d=Math.floor((l+c)/2);i(a[d]),r()?(u=a[d],l=d+1):c=d}if(i(u),n&&t-e.scrollHeight>=n-1){for(var p=s(o,u);p<o.length&&(i(p),r());)u=p,p=s(o,p);i(u)}}},t.getFitStatus=function(e,t){var n=e.offsetTop;return n+e.clientHeight<=t?r.ContainerFitStatus.FullyInContainer:n<t?r.ContainerFitStatus.Overflowing:r.ContainerFitStatus.FullyOutOfContainer},t.clearElementChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},86824:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(73090),o=n.n(r),i=n(28354),a=n.n(i)()(o());a.push([e.id,":root {\n  --bgColor: transparent;\n}\nhtml,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n  -webkit-font-smoothing: antialiased;\n}\n","",{version:3,sources:["webpack://./src/sharedCopilot/pages/ChatUi.css"],names:[],mappings:"AAAA;EACE,sBAAsB;AACxB;AACA;;EAEE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,gCAAgC;EAChC,mCAAmC;AACrC",sourcesContent:[":root {\r\n  --bgColor: transparent;\r\n}\r\nhtml,\r\nbody {\r\n  height: 100%;\r\n  width: 100%;\r\n  overflow: hidden;\r\n  background-color: var(--bgColor);\r\n  -webkit-font-smoothing: antialiased;\r\n}\r\n"],sourceRoot:""}]);const s=a},28354:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},73090:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},55203:(e,t,n)=>{var r,o=n(58651);e.exports=function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,(function(e){var n=t[a][1][e];return o(n||e)}),c,c.exports,e,t,n,r)}return n[a].exports}for(var i=void 0,a=0;a<r.length;a++)o(r[a]);return o}({"./aesprim":[function(e,t,n){!function(e,t){"use strict";"function"==typeof r&&r.amd?r(["exports"],t):t(void 0!==n?n:e.esprima={})}(this,(function(e){"use strict";var t,n,r,o,i,a,s,l,c,u,d,p,f,h,g,m,y,v;function S(e,t){if(!e)throw new Error("ASSERT: "+t)}function C(e){return e>=48&&e<=57}function b(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function E(e){return"01234567".indexOf(e)>=0}function T(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function w(e){return 10===e||13===e||8232===e||8233===e}function I(e){return 64==e||36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&s.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function P(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&s.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function _(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function A(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function k(e){return"eval"===e||"arguments"===e}function x(e){if(u&&A(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}function N(e,t,n,r,o){var i;S("number"==typeof n,"Comment must have valid position"),y.lastCommentStart>=n||(y.lastCommentStart=n,i={type:e,value:t},v.range&&(i.range=[n,r]),v.loc&&(i.loc=o),v.comments.push(i),v.attachComment&&(v.leadingComments.push(i),v.trailingComments.push(i)))}function O(e){var t,n,r,o;for(t=d-e,n={start:{line:p,column:d-f-e}};d<h;)if(r=c.charCodeAt(d),++d,w(r))return v.comments&&(o=c.slice(t+e,d-1),n.end={line:p,column:d-f-1},N("Line",o,t,d-1,n)),13===r&&10===c.charCodeAt(d)&&++d,++p,void(f=d);v.comments&&(o=c.slice(t+e,d),n.end={line:p,column:d-f},N("Line",o,t,d,n))}function D(){var e,t,n,r;for(v.comments&&(e=d-2,t={start:{line:p,column:d-f-2}});d<h;)if(w(n=c.charCodeAt(d)))13===n&&10===c.charCodeAt(d+1)&&++d,++p,++d,f=d,d>=h&&oe({},a.UnexpectedToken,"ILLEGAL");else if(42===n){if(47===c.charCodeAt(d+1))return++d,++d,void(v.comments&&(r=c.slice(e+2,d-2),t.end={line:p,column:d-f},N("Block",r,e,d,t)));++d}else++d;oe({},a.UnexpectedToken,"ILLEGAL")}function L(){var e,t;for(t=0===d;d<h;)if(T(e=c.charCodeAt(d)))++d;else if(w(e))++d,13===e&&10===c.charCodeAt(d)&&++d,++p,f=d,t=!0;else if(47===e)if(47===(e=c.charCodeAt(d+1)))++d,++d,O(2),t=!0;else{if(42!==e)break;++d,++d,D()}else if(t&&45===e){if(45!==c.charCodeAt(d+1)||62!==c.charCodeAt(d+2))break;d+=3,O(3)}else{if(60!==e)break;if("!--"!==c.slice(d+1,d+4))break;++d,++d,++d,++d,O(4)}}function R(e){var t,n,r,o=0;for(n="u"===e?4:2,t=0;t<n;++t){if(!(d<h&&b(c[d])))return"";r=c[d++],o=16*o+"0123456789abcdef".indexOf(r.toLowerCase())}return String.fromCharCode(o)}function F(){var e,t;for(e=c.charCodeAt(d++),t=String.fromCharCode(e),92===e&&(117!==c.charCodeAt(d)&&oe({},a.UnexpectedToken,"ILLEGAL"),++d,(e=R("u"))&&"\\"!==e&&I(e.charCodeAt(0))||oe({},a.UnexpectedToken,"ILLEGAL"),t=e);d<h&&P(e=c.charCodeAt(d));)++d,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==c.charCodeAt(d)&&oe({},a.UnexpectedToken,"ILLEGAL"),++d,(e=R("u"))&&"\\"!==e&&P(e.charCodeAt(0))||oe({},a.UnexpectedToken,"ILLEGAL"),t+=e);return t}function M(){var e,t;for(e=d++;d<h;){if(92===(t=c.charCodeAt(d)))return d=e,F();if(!P(t))break;++d}return c.slice(e,d)}function B(){var e,n;return e=d,{type:1===(n=92===c.charCodeAt(d)?F():M()).length?t.Identifier:x(n)?t.Keyword:"null"===n?t.NullLiteral:"true"===n||"false"===n?t.BooleanLiteral:t.Identifier,value:n,lineNumber:p,lineStart:f,start:e,end:d}}function U(){var e,n,r,o,i=d,s=c.charCodeAt(d),l=c[d];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++d,v.tokenize&&(40===s?v.openParenToken=v.tokens.length:123===s&&(v.openCurlyToken=v.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(s),lineNumber:p,lineStart:f,start:i,end:d};default:if(61===(e=c.charCodeAt(d+1)))switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return d+=2,{type:t.Punctuator,value:String.fromCharCode(s)+String.fromCharCode(e),lineNumber:p,lineStart:f,start:i,end:d};case 33:case 61:return d+=2,61===c.charCodeAt(d)&&++d,{type:t.Punctuator,value:c.slice(i,d),lineNumber:p,lineStart:f,start:i,end:d}}}return">>>="===(o=c.substr(d,4))?(d+=4,{type:t.Punctuator,value:o,lineNumber:p,lineStart:f,start:i,end:d}):">>>"===(r=o.substr(0,3))||"<<="===r||">>="===r?(d+=3,{type:t.Punctuator,value:r,lineNumber:p,lineStart:f,start:i,end:d}):l===(n=r.substr(0,2))[1]&&"+-<>&|".indexOf(l)>=0||"=>"===n?(d+=2,{type:t.Punctuator,value:n,lineNumber:p,lineStart:f,start:i,end:d}):"<>=!+-*%&|^/".indexOf(l)>=0?(++d,{type:t.Punctuator,value:l,lineNumber:p,lineStart:f,start:i,end:d}):void oe({},a.UnexpectedToken,"ILLEGAL")}function z(e){for(var n="";d<h&&b(c[d]);)n+=c[d++];return 0===n.length&&oe({},a.UnexpectedToken,"ILLEGAL"),I(c.charCodeAt(d))&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+n,16),lineNumber:p,lineStart:f,start:e,end:d}}function H(e){for(var n="0"+c[d++];d<h&&E(c[d]);)n+=c[d++];return(I(c.charCodeAt(d))||C(c.charCodeAt(d)))&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(n,8),octal:!0,lineNumber:p,lineStart:f,start:e,end:d}}function G(){var e,n,r;if(S(C((r=c[d]).charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),n=d,e="","."!==r){if(e=c[d++],r=c[d],"0"===e){if("x"===r||"X"===r)return++d,z(n);if(E(r))return H(n);r&&C(r.charCodeAt(0))&&oe({},a.UnexpectedToken,"ILLEGAL")}for(;C(c.charCodeAt(d));)e+=c[d++];r=c[d]}if("."===r){for(e+=c[d++];C(c.charCodeAt(d));)e+=c[d++];r=c[d]}if("e"===r||"E"===r)if(e+=c[d++],"+"!==(r=c[d])&&"-"!==r||(e+=c[d++]),C(c.charCodeAt(d)))for(;C(c.charCodeAt(d));)e+=c[d++];else oe({},a.UnexpectedToken,"ILLEGAL");return I(c.charCodeAt(d))&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:p,lineStart:f,start:n,end:d}}function V(){var e,n,r,o,i,s,l,u,g="",m=!1;for(l=p,u=f,S("'"===(e=c[d])||'"'===e,"String literal must starts with a quote"),n=d,++d;d<h;){if((r=c[d++])===e){e="";break}if("\\"===r)if((r=c[d++])&&w(r.charCodeAt(0)))++p,"\r"===r&&"\n"===c[d]&&++d,f=d;else switch(r){case"u":case"x":s=d,(i=R(r))?g+=i:(d=s,g+=r);break;case"n":g+="\n";break;case"r":g+="\r";break;case"t":g+="\t";break;case"b":g+="\b";break;case"f":g+="\f";break;case"v":g+="\v";break;default:E(r)?(0!==(o="01234567".indexOf(r))&&(m=!0),d<h&&E(c[d])&&(m=!0,o=8*o+"01234567".indexOf(c[d++]),"0123".indexOf(r)>=0&&d<h&&E(c[d])&&(o=8*o+"01234567".indexOf(c[d++]))),g+=String.fromCharCode(o)):g+=r}else{if(w(r.charCodeAt(0)))break;g+=r}}return""!==e&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:g,octal:m,startLineNumber:l,startLineStart:u,lineNumber:p,lineStart:f,start:n,end:d}}function j(e,t){var n;try{n=new RegExp(e,t)}catch(e){oe({},a.InvalidRegExp)}return n}function q(){var e,t,n,r;for(S("/"===(e=c[d]),"Regular expression literal must start with a slash"),t=c[d++],n=!1,r=!1;d<h;)if(t+=e=c[d++],"\\"===e)w((e=c[d++]).charCodeAt(0))&&oe({},a.UnterminatedRegExp),t+=e;else if(w(e.charCodeAt(0)))oe({},a.UnterminatedRegExp);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||oe({},a.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}function W(){var e,t,n,r;for(t="",n="";d<h&&P((e=c[d]).charCodeAt(0));)if(++d,"\\"===e&&d<h)if("u"===(e=c[d])){if(r=++d,e=R("u"))for(n+=e,t+="\\u";r<d;++r)t+=c[r];else d=r,n+="u",t+="\\u";ie({},a.UnexpectedToken,"ILLEGAL")}else t+="\\",ie({},a.UnexpectedToken,"ILLEGAL");else n+=e,t+=e;return{value:n,literal:t}}function Y(){var e,n,r,o;return m=null,L(),e=d,n=q(),r=W(),o=j(n.value,r.value),v.tokenize?{type:t.RegularExpression,value:o,lineNumber:p,lineStart:f,start:e,end:d}:{literal:n.literal+r.literal,value:o,start:e,end:d}}function Q(){var e,t,n,r;return L(),e=d,t={start:{line:p,column:d-f}},n=Y(),t.end={line:p,column:d-f},v.tokenize||(v.tokens.length>0&&(r=v.tokens[v.tokens.length-1]).range[0]===e&&"Punctuator"===r.type&&("/"!==r.value&&"/="!==r.value||v.tokens.pop()),v.tokens.push({type:"RegularExpression",value:n.literal,range:[e,d],loc:t})),n}function J(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}function X(){var e,t;if(!(e=v.tokens[v.tokens.length-1]))return Q();if("Punctuator"===e.type){if("]"===e.value)return U();if(")"===e.value)return!(t=v.tokens[v.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?U():Q();if("}"===e.value){if(v.tokens[v.openCurlyToken-3]&&"Keyword"===v.tokens[v.openCurlyToken-3].type){if(!(t=v.tokens[v.openCurlyToken-4]))return U()}else{if(!v.tokens[v.openCurlyToken-4]||"Keyword"!==v.tokens[v.openCurlyToken-4].type)return U();if(!(t=v.tokens[v.openCurlyToken-5]))return Q()}return r.indexOf(t.value)>=0?U():Q()}return Q()}return"Keyword"===e.type?Q():U()}function K(){var e;return L(),d>=h?{type:t.EOF,lineNumber:p,lineStart:f,start:d,end:d}:I(e=c.charCodeAt(d))?B():40===e||41===e||59===e?U():39===e||34===e?V():46===e?C(c.charCodeAt(d+1))?G():U():C(e)?G():v.tokenize&&47===e?X():U()}function Z(){var e,r,o;return L(),e={start:{line:p,column:d-f}},r=K(),e.end={line:p,column:d-f},r.type!==t.EOF&&(o=c.slice(r.start,r.end),v.tokens.push({type:n[r.type],value:o,range:[r.start,r.end],loc:e})),r}function $(){var e;return d=(e=m).end,p=e.lineNumber,f=e.lineStart,m=void 0!==v.tokens?Z():K(),d=e.end,p=e.lineNumber,f=e.lineStart,e}function ee(){var e,t,n;e=d,t=p,n=f,m=void 0!==v.tokens?Z():K(),d=e,p=t,f=n}function te(e,t){this.line=e,this.column=t}function ne(e,t,n,r){this.start=new te(e,t),this.end=new te(n,r)}function re(){var e,t,n,r;return e=d,t=p,n=f,L(),r=p!==t,d=e,p=t,f=n,r}function oe(e,t){var n,r=Array.prototype.slice.call(arguments,2),o=t.replace(/%(\d)/g,(function(e,t){return S(t<r.length,"Message reference must be in range"),r[t]}));throw"number"==typeof e.lineNumber?((n=new Error("Line "+e.lineNumber+": "+o)).index=e.start,n.lineNumber=e.lineNumber,n.column=e.start-f+1):((n=new Error("Line "+p+": "+o)).index=d,n.lineNumber=p,n.column=d-f+1),n.description=o,n}function ie(){try{oe.apply(null,arguments)}catch(e){if(!v.errors)throw e;v.errors.push(e)}}function ae(e){if(e.type===t.EOF&&oe(e,a.UnexpectedEOS),e.type===t.NumericLiteral&&oe(e,a.UnexpectedNumber),e.type===t.StringLiteral&&oe(e,a.UnexpectedString),e.type===t.Identifier&&oe(e,a.UnexpectedIdentifier),e.type===t.Keyword){if(_(e.value))oe(e,a.UnexpectedReserved);else if(u&&A(e.value))return void ie(e,a.StrictReservedWord);oe(e,a.UnexpectedToken,e.value)}oe(e,a.UnexpectedToken,e.value)}function se(e){var n=$();n.type===t.Punctuator&&n.value===e||ae(n)}function le(e){var n=$();n.type===t.Keyword&&n.value===e||ae(n)}function ce(e){return m.type===t.Punctuator&&m.value===e}function ue(e){return m.type===t.Keyword&&m.value===e}function de(){var e;return m.type===t.Punctuator&&("="===(e=m.value)||"*="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e)}function pe(){var e;59===c.charCodeAt(d)||ce(";")?$():(e=p,L(),p===e&&(m.type===t.EOF||ce("}")||ae(m)))}function fe(e){return e.type===o.Identifier||e.type===o.MemberExpression}function he(){var e,t=[];for(e=m,se("[");!ce("]");)ce(",")?($(),t.push(null)):(t.push(De()),ce("]")||se(","));return $(),g.markEnd(g.createArrayExpression(t),e)}function ge(e,t){var n,r,o;return n=u,o=m,r=at(),t&&u&&k(e[0].name)&&ie(t,a.StrictParamName),u=n,g.markEnd(g.createFunctionExpression(null,e,[],r),o)}function me(){var e,n;return n=m,(e=$()).type===t.StringLiteral||e.type===t.NumericLiteral?(u&&e.octal&&ie(e,a.StrictOctalLiteral),g.markEnd(g.createLiteral(e),n)):g.markEnd(g.createIdentifier(e.value),n)}function ye(){var e,n,r,o,i,s;return s=m,(e=m).type===t.Identifier?(r=me(),"get"!==e.value||ce(":")?"set"!==e.value||ce(":")?(se(":"),o=De(),g.markEnd(g.createProperty("init",r,o),s)):(n=me(),se("("),(e=m).type!==t.Identifier?(se(")"),ie(e,a.UnexpectedToken,e.value),o=ge([])):(i=[Me()],se(")"),o=ge(i,e)),g.markEnd(g.createProperty("set",n,o),s)):(n=me(),se("("),se(")"),o=ge([]),g.markEnd(g.createProperty("get",n,o),s))):e.type!==t.EOF&&e.type!==t.Punctuator?(n=me(),se(":"),o=De(),g.markEnd(g.createProperty("init",n,o),s)):void ae(e)}function ve(){var e,t,n,r,s,l=[],c={},d=String;for(s=m,se("{");!ce("}");)t=(e=ye()).key.type===o.Identifier?e.key.name:d(e.key.value),r="init"===e.kind?i.Data:"get"===e.kind?i.Get:i.Set,n="$"+t,Object.prototype.hasOwnProperty.call(c,n)?(c[n]===i.Data?u&&r===i.Data?ie({},a.StrictDuplicateProperty):r!==i.Data&&ie({},a.AccessorDataProperty):r===i.Data?ie({},a.AccessorDataProperty):c[n]&r&&ie({},a.AccessorGetSet),c[n]|=r):c[n]=r,l.push(e),ce("}")||se(",");return se("}"),g.markEnd(g.createObjectExpression(l),s)}function Se(){var e;return se("("),e=Le(),se(")"),e}function Ce(){var e,n,r,o;if(ce("("))return Se();if(ce("["))return he();if(ce("{"))return ve();if(e=m.type,o=m,e===t.Identifier)r=g.createIdentifier($().value);else if(e===t.StringLiteral||e===t.NumericLiteral)u&&m.octal&&ie(m,a.StrictOctalLiteral),r=g.createLiteral($());else if(e===t.Keyword){if(ue("function"))return ct();ue("this")?($(),r=g.createThisExpression()):ae($())}else e===t.BooleanLiteral?((n=$()).value="true"===n.value,r=g.createLiteral(n)):e===t.NullLiteral?((n=$()).value=null,r=g.createLiteral(n)):ce("/")||ce("/=")?(r=void 0!==v.tokens?g.createLiteral(Q()):g.createLiteral(Y()),ee()):ae($());return g.markEnd(r,o)}function be(){var e=[];if(se("("),!ce(")"))for(;d<h&&(e.push(De()),!ce(")"));)se(",");return se(")"),e}function Ee(){var e,t;return t=m,J(e=$())||ae(e),g.markEnd(g.createIdentifier(e.value),t)}function Te(){return se("."),Ee()}function we(){var e;return se("["),e=Le(),se("]"),e}function Ie(){var e,t,n;return n=m,le("new"),e=_e(),t=ce("(")?be():[],g.markEnd(g.createNewExpression(e,t),n)}function Pe(){var e,t,n,r,o;for(o=m,e=y.allowIn,y.allowIn=!0,t=ue("new")?Ie():Ce(),y.allowIn=e;;){if(ce("."))r=Te(),t=g.createMemberExpression(".",t,r);else if(ce("("))n=be(),t=g.createCallExpression(t,n);else{if(!ce("["))break;r=we(),t=g.createMemberExpression("[",t,r)}g.markEnd(t,o)}return t}function _e(){var e,t,n,r;for(r=m,e=y.allowIn,t=ue("new")?Ie():Ce(),y.allowIn=e;ce(".")||ce("[");)ce("[")?(n=we(),t=g.createMemberExpression("[",t,n)):(n=Te(),t=g.createMemberExpression(".",t,n)),g.markEnd(t,r);return t}function Ae(){var e,n,r=m;return e=Pe(),m.type===t.Punctuator&&(!ce("++")&&!ce("--")||re()||(u&&e.type===o.Identifier&&k(e.name)&&ie({},a.StrictLHSPostfix),fe(e)||ie({},a.InvalidLHSInAssignment),n=$(),e=g.markEnd(g.createPostfixExpression(n.value,e),r))),e}function ke(){var e,n,r;return m.type!==t.Punctuator&&m.type!==t.Keyword?n=Ae():ce("++")||ce("--")?(r=m,e=$(),n=ke(),u&&n.type===o.Identifier&&k(n.name)&&ie({},a.StrictLHSPrefix),fe(n)||ie({},a.InvalidLHSInAssignment),n=g.createUnaryExpression(e.value,n),n=g.markEnd(n,r)):ce("+")||ce("-")||ce("~")||ce("!")?(r=m,e=$(),n=ke(),n=g.createUnaryExpression(e.value,n),n=g.markEnd(n,r)):ue("delete")||ue("void")||ue("typeof")?(r=m,e=$(),n=ke(),n=g.createUnaryExpression(e.value,n),n=g.markEnd(n,r),u&&"delete"===n.operator&&n.argument.type===o.Identifier&&ie({},a.StrictDelete)):n=Ae(),n}function xe(e,n){var r=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=n?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function Ne(){var e,t,n,r,o,i,a,s,l,c;if(e=m,l=ke(),0===(o=xe(r=m,y.allowIn)))return l;for(r.prec=o,$(),t=[e,m],i=[l,r,a=ke()];(o=xe(m,y.allowIn))>0;){for(;i.length>2&&o<=i[i.length-2].prec;)a=i.pop(),s=i.pop().value,l=i.pop(),n=g.createBinaryExpression(s,l,a),t.pop(),e=t[t.length-1],g.markEnd(n,e),i.push(n);(r=$()).prec=o,i.push(r),t.push(m),n=ke(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)n=g.createBinaryExpression(i[c-1].value,i[c-2],n),c-=2,e=t.pop(),g.markEnd(n,e);return n}function Oe(){var e,t,n,r,o;return o=m,e=Ne(),ce("?")&&($(),t=y.allowIn,y.allowIn=!0,n=De(),y.allowIn=t,se(":"),r=De(),e=g.createConditionalExpression(e,n,r),g.markEnd(e,o)),e}function De(){var e,t,n,r,i;return e=m,i=m,r=t=Oe(),de()&&(fe(t)||ie({},a.InvalidLHSInAssignment),u&&t.type===o.Identifier&&k(t.name)&&ie(e,a.StrictLHSAssignment),e=$(),n=De(),r=g.markEnd(g.createAssignmentExpression(e.value,t,n),i)),r}function Le(){var e,t=m;if(e=De(),ce(",")){for(e=g.createSequenceExpression([e]);d<h&&ce(",");)$(),e.expressions.push(De());g.markEnd(e,t)}return e}function Re(){for(var e,t=[];d<h&&!ce("}")&&void 0!==(e=ut());)t.push(e);return t}function Fe(){var e,t;return t=m,se("{"),e=Re(),se("}"),g.markEnd(g.createBlockStatement(e),t)}function Me(){var e,n;return n=m,(e=$()).type!==t.Identifier&&ae(e),g.markEnd(g.createIdentifier(e.value),n)}function Be(e){var t,n,r=null;return n=m,t=Me(),u&&k(t.name)&&ie({},a.StrictVarName),"const"===e?(se("="),r=De()):ce("=")&&($(),r=De()),g.markEnd(g.createVariableDeclarator(t,r),n)}function Ue(e){var t=[];do{if(t.push(Be(e)),!ce(","))break;$()}while(d<h);return t}function ze(){var e;return le("var"),e=Ue(),pe(),g.createVariableDeclaration(e,"var")}function He(e){var t,n;return n=m,le(e),t=Ue(e),pe(),g.markEnd(g.createVariableDeclaration(t,e),n)}function Ge(){return se(";"),g.createEmptyStatement()}function Ve(){var e=Le();return pe(),g.createExpressionStatement(e)}function je(){var e,t,n;return le("if"),se("("),e=Le(),se(")"),t=it(),ue("else")?($(),n=it()):n=null,g.createIfStatement(e,t,n)}function qe(){var e,t,n;return le("do"),n=y.inIteration,y.inIteration=!0,e=it(),y.inIteration=n,le("while"),se("("),t=Le(),se(")"),ce(";")&&$(),g.createDoWhileStatement(e,t)}function We(){var e,t,n;return le("while"),se("("),e=Le(),se(")"),n=y.inIteration,y.inIteration=!0,t=it(),y.inIteration=n,g.createWhileStatement(e,t)}function Ye(){var e,t,n;return n=m,e=$(),t=Ue(),g.markEnd(g.createVariableDeclaration(t,e.value),n)}function Qe(){var e,t,n,r,o,i,s;return e=t=n=null,le("for"),se("("),ce(";")?$():(ue("var")||ue("let")?(y.allowIn=!1,e=Ye(),y.allowIn=!0,1===e.declarations.length&&ue("in")&&($(),r=e,o=Le(),e=null)):(y.allowIn=!1,e=Le(),y.allowIn=!0,ue("in")&&(fe(e)||ie({},a.InvalidLHSInForIn),$(),r=e,o=Le(),e=null)),void 0===r&&se(";")),void 0===r&&(ce(";")||(t=Le()),se(";"),ce(")")||(n=Le())),se(")"),s=y.inIteration,y.inIteration=!0,i=it(),y.inIteration=s,void 0===r?g.createForStatement(e,t,n,i):g.createForInStatement(r,o,i)}function Je(){var e,n=null;return le("continue"),59===c.charCodeAt(d)?($(),y.inIteration||oe({},a.IllegalContinue),g.createContinueStatement(null)):re()?(y.inIteration||oe({},a.IllegalContinue),g.createContinueStatement(null)):(m.type===t.Identifier&&(e="$"+(n=Me()).name,Object.prototype.hasOwnProperty.call(y.labelSet,e)||oe({},a.UnknownLabel,n.name)),pe(),null!==n||y.inIteration||oe({},a.IllegalContinue),g.createContinueStatement(n))}function Xe(){var e,n=null;return le("break"),59===c.charCodeAt(d)?($(),y.inIteration||y.inSwitch||oe({},a.IllegalBreak),g.createBreakStatement(null)):re()?(y.inIteration||y.inSwitch||oe({},a.IllegalBreak),g.createBreakStatement(null)):(m.type===t.Identifier&&(e="$"+(n=Me()).name,Object.prototype.hasOwnProperty.call(y.labelSet,e)||oe({},a.UnknownLabel,n.name)),pe(),null!==n||y.inIteration||y.inSwitch||oe({},a.IllegalBreak),g.createBreakStatement(n))}function Ke(){var e=null;return le("return"),y.inFunctionBody||ie({},a.IllegalReturn),32===c.charCodeAt(d)&&I(c.charCodeAt(d+1))?(e=Le(),pe(),g.createReturnStatement(e)):re()?g.createReturnStatement(null):(ce(";")||ce("}")||m.type===t.EOF||(e=Le()),pe(),g.createReturnStatement(e))}function Ze(){var e,t;return u&&(L(),ie({},a.StrictModeWith)),le("with"),se("("),e=Le(),se(")"),t=it(),g.createWithStatement(e,t)}function $e(){var e,t,n,r=[];for(n=m,ue("default")?($(),e=null):(le("case"),e=Le()),se(":");d<h&&!(ce("}")||ue("default")||ue("case"));)t=it(),r.push(t);return g.markEnd(g.createSwitchCase(e,r),n)}function et(){var e,t,n,r,o;if(le("switch"),se("("),e=Le(),se(")"),se("{"),t=[],ce("}"))return $(),g.createSwitchStatement(e,t);for(r=y.inSwitch,y.inSwitch=!0,o=!1;d<h&&!ce("}");)null===(n=$e()).test&&(o&&oe({},a.MultipleDefaultsInSwitch),o=!0),t.push(n);return y.inSwitch=r,se("}"),g.createSwitchStatement(e,t)}function tt(){var e;return le("throw"),re()&&oe({},a.NewlineAfterThrow),e=Le(),pe(),g.createThrowStatement(e)}function nt(){var e,t,n;return n=m,le("catch"),se("("),ce(")")&&ae(m),e=Me(),u&&k(e.name)&&ie({},a.StrictCatchVariable),se(")"),t=Fe(),g.markEnd(g.createCatchClause(e,t),n)}function rt(){var e,t=[],n=null;return le("try"),e=Fe(),ue("catch")&&t.push(nt()),ue("finally")&&($(),n=Fe()),0!==t.length||n||oe({},a.NoCatchOrFinally),g.createTryStatement(e,[],t,n)}function ot(){return le("debugger"),pe(),g.createDebuggerStatement()}function it(){var e,n,r,i,s=m.type;if(s===t.EOF&&ae(m),s===t.Punctuator&&"{"===m.value)return Fe();if(i=m,s===t.Punctuator)switch(m.value){case";":return g.markEnd(Ge(),i);case"(":return g.markEnd(Ve(),i)}if(s===t.Keyword)switch(m.value){case"break":return g.markEnd(Xe(),i);case"continue":return g.markEnd(Je(),i);case"debugger":return g.markEnd(ot(),i);case"do":return g.markEnd(qe(),i);case"for":return g.markEnd(Qe(),i);case"function":return g.markEnd(lt(),i);case"if":return g.markEnd(je(),i);case"return":return g.markEnd(Ke(),i);case"switch":return g.markEnd(et(),i);case"throw":return g.markEnd(tt(),i);case"try":return g.markEnd(rt(),i);case"var":return g.markEnd(ze(),i);case"while":return g.markEnd(We(),i);case"with":return g.markEnd(Ze(),i)}return(e=Le()).type===o.Identifier&&ce(":")?($(),r="$"+e.name,Object.prototype.hasOwnProperty.call(y.labelSet,r)&&oe({},a.Redeclaration,"Label",e.name),y.labelSet[r]=!0,n=it(),delete y.labelSet[r],g.markEnd(g.createLabeledStatement(e,n),i)):(pe(),g.markEnd(g.createExpressionStatement(e),i))}function at(){var e,n,r,i,s,l,p,f,v=[];for(f=m,se("{");d<h&&m.type===t.StringLiteral&&(n=m,e=ut(),v.push(e),e.expression.type===o.Literal);)"use strict"===c.slice(n.start+1,n.end-1)?(u=!0,r&&ie(r,a.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(i=y.labelSet,s=y.inIteration,l=y.inSwitch,p=y.inFunctionBody,y.labelSet={},y.inIteration=!1,y.inSwitch=!1,y.inFunctionBody=!0;d<h&&!ce("}")&&void 0!==(e=ut());)v.push(e);return se("}"),y.labelSet=i,y.inIteration=s,y.inSwitch=l,y.inFunctionBody=p,g.markEnd(g.createBlockStatement(v),f)}function st(e){var t,n,r,o,i,s,l=[];if(se("("),!ce(")"))for(o={};d<h&&(n=m,t=Me(),i="$"+n.value,u?(k(n.value)&&(r=n,s=a.StrictParamName),Object.prototype.hasOwnProperty.call(o,i)&&(r=n,s=a.StrictParamDupe)):e||(k(n.value)?(e=n,s=a.StrictParamName):A(n.value)?(e=n,s=a.StrictReservedWord):Object.prototype.hasOwnProperty.call(o,i)&&(e=n,s=a.StrictParamDupe)),l.push(t),o[i]=!0,!ce(")"));)se(",");return se(")"),{params:l,stricted:r,firstRestricted:e,message:s}}function lt(){var e,t,n,r,o,i,s,l,c,d=[];return c=m,le("function"),n=m,e=Me(),u?k(n.value)&&ie(n,a.StrictFunctionName):k(n.value)?(i=n,s=a.StrictFunctionName):A(n.value)&&(i=n,s=a.StrictReservedWord),d=(o=st(i)).params,r=o.stricted,i=o.firstRestricted,o.message&&(s=o.message),l=u,t=at(),u&&i&&oe(i,s),u&&r&&ie(r,s),u=l,g.markEnd(g.createFunctionDeclaration(e,d,[],t),c)}function ct(){var e,t,n,r,o,i,s,l,c=null,d=[];return l=m,le("function"),ce("(")||(e=m,c=Me(),u?k(e.value)&&ie(e,a.StrictFunctionName):k(e.value)?(n=e,r=a.StrictFunctionName):A(e.value)&&(n=e,r=a.StrictReservedWord)),d=(o=st(n)).params,t=o.stricted,n=o.firstRestricted,o.message&&(r=o.message),s=u,i=at(),u&&n&&oe(n,r),u&&t&&ie(t,r),u=s,g.markEnd(g.createFunctionExpression(c,d,[],i),l)}function ut(){if(m.type===t.Keyword)switch(m.value){case"const":case"let":return He(m.value);case"function":return lt();default:return it()}if(m.type!==t.EOF)return it()}function dt(){for(var e,n,r,i=[];d<h&&(n=m).type===t.StringLiteral&&(e=ut(),i.push(e),e.expression.type===o.Literal);)"use strict"===c.slice(n.start+1,n.end-1)?(u=!0,r&&ie(r,a.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(;d<h&&void 0!==(e=ut());)i.push(e);return i}function pt(){var e,t;return L(),ee(),t=m,u=!1,e=dt(),g.markEnd(g.createProgram(e),t)}function ft(){var e,t,n,r=[];for(e=0;e<v.tokens.length;++e)n={type:(t=v.tokens[e]).type,value:t.value},v.range&&(n.range=t.range),v.loc&&(n.loc=t.loc),r.push(n);v.tokens=r}function ht(e,n){var r;"string"==typeof e||e instanceof String||(e=String(e)),g=l,d=0,p=(c=e).length>0?1:0,f=0,h=c.length,m=null,y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},v={},(n=n||{}).tokens=!0,v.tokens=[],v.tokenize=!0,v.openParenToken=-1,v.openCurlyToken=-1,v.range="boolean"==typeof n.range&&n.range,v.loc="boolean"==typeof n.loc&&n.loc,"boolean"==typeof n.comment&&n.comment&&(v.comments=[]),"boolean"==typeof n.tolerant&&n.tolerant&&(v.errors=[]);try{if(ee(),m.type===t.EOF)return v.tokens;for($();m.type!==t.EOF;)try{$()}catch(e){if(v.errors){v.errors.push(e);break}throw e}ft(),r=v.tokens,void 0!==v.comments&&(r.comments=v.comments),void 0!==v.errors&&(r.errors=v.errors)}catch(e){throw e}finally{v={}}return r}function gt(e,t){var n,r;r=String,"string"==typeof e||e instanceof String||(e=r(e)),g=l,d=0,p=(c=e).length>0?1:0,f=0,h=c.length,m=null,y={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},v={},void 0!==t&&(v.range="boolean"==typeof t.range&&t.range,v.loc="boolean"==typeof t.loc&&t.loc,v.attachComment="boolean"==typeof t.attachComment&&t.attachComment,v.loc&&null!==t.source&&void 0!==t.source&&(v.source=r(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(v.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(v.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(v.errors=[]),v.attachComment&&(v.range=!0,v.comments=[],v.bottomRightStack=[],v.trailingComments=[],v.leadingComments=[]));try{n=pt(),void 0!==v.comments&&(n.comments=v.comments),void 0!==v.tokens&&(ft(),n.tokens=v.tokens),void 0!==v.errors&&(n.errors=v.errors)}catch(e){throw e}finally{v={}}return n}(n={})[(t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",n[t.EOF]="<end>",n[t.Identifier]="Identifier",n[t.Keyword]="Keyword",n[t.NullLiteral]="Null",n[t.NumericLiteral]="Numeric",n[t.Punctuator]="Punctuator",n[t.StringLiteral]="String",n[t.RegularExpression]="RegularExpression",r=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],o={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},i={Data:1,Get:2,Set:4},a={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},s={NonAsciiIdentifierStart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]"),NonAsciiIdentifierPart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]")},l={name:"SyntaxTree",processComment:function(e){var t,n;if(!(e.type===o.Program&&e.body.length>0)){for(v.trailingComments.length>0?v.trailingComments[0].range[0]>=e.range[1]?(n=v.trailingComments,v.trailingComments=[]):v.trailingComments.length=0:v.bottomRightStack.length>0&&v.bottomRightStack[v.bottomRightStack.length-1].trailingComments&&v.bottomRightStack[v.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(n=v.bottomRightStack[v.bottomRightStack.length-1].trailingComments,delete v.bottomRightStack[v.bottomRightStack.length-1].trailingComments);v.bottomRightStack.length>0&&v.bottomRightStack[v.bottomRightStack.length-1].range[0]>=e.range[0];)t=v.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):v.leadingComments.length>0&&v.leadingComments[v.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=v.leadingComments,v.leadingComments=[]),n&&(e.trailingComments=n),v.bottomRightStack.push(e)}},markEnd:function(e,t){return v.range&&(e.range=[t.start,d]),v.loc&&(e.loc=new ne(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),p,d-f),this.postProcess(e)),v.attachComment&&this.processComment(e),e},postProcess:function(e){return v.source&&(e.loc.source=v.source),e},createArrayExpression:function(e){return{type:o.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,n){return{type:o.AssignmentExpression,operator:e,left:t,right:n}},createBinaryExpression:function(e,t,n){return{type:"||"===e||"&&"===e?o.LogicalExpression:o.BinaryExpression,operator:e,left:t,right:n}},createBlockStatement:function(e){return{type:o.BlockStatement,body:e}},createBreakStatement:function(e){return{type:o.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:o.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:o.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,n){return{type:o.ConditionalExpression,test:e,consequent:t,alternate:n}},createContinueStatement:function(e){return{type:o.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:o.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:o.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:o.EmptyStatement}},createExpressionStatement:function(e){return{type:o.ExpressionStatement,expression:e}},createForStatement:function(e,t,n,r){return{type:o.ForStatement,init:e,test:t,update:n,body:r}},createForInStatement:function(e,t,n){return{type:o.ForInStatement,left:e,right:t,body:n,each:!1}},createFunctionDeclaration:function(e,t,n,r){return{type:o.FunctionDeclaration,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,n,r){return{type:o.FunctionExpression,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:o.Identifier,name:e}},createIfStatement:function(e,t,n){return{type:o.IfStatement,test:e,consequent:t,alternate:n}},createLabeledStatement:function(e,t){return{type:o.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:o.Literal,value:e.value,raw:c.slice(e.start,e.end)}},createMemberExpression:function(e,t,n){return{type:o.MemberExpression,computed:"["===e,object:t,property:n}},createNewExpression:function(e,t){return{type:o.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:o.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:o.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:o.Program,body:e}},createProperty:function(e,t,n){return{type:o.Property,key:t,value:n,kind:e}},createReturnStatement:function(e){return{type:o.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:o.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:o.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:o.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:o.ThisExpression}},createThrowStatement:function(e){return{type:o.ThrowStatement,argument:e}},createTryStatement:function(e,t,n,r){return{type:o.TryStatement,block:e,guardedHandlers:t,handlers:n,finalizer:r}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:o.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:o.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:o.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:o.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:o.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:o.WithStatement,object:e,body:t}}},e.version="1.2.2",e.tokenize=ht,e.parse=gt,e.Syntax=function(){var e,t={};for(e in"function"==typeof Object.create&&(t=Object.create(null)),o)o.hasOwnProperty(e)&&(t[e]=o[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()}))},{}],1:[function(e,t,n){(function(r){var i=function(){var e={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(e,n,r,o,i,a,s){o.ast||(o.ast=t,t.initialize());var l=a.length-1;switch(i){case 1:return o.ast.set({expression:{type:"root",value:a[l]}}),o.ast.unshift(),o.ast.yield();case 2:return o.ast.set({expression:{type:"root",value:a[l-1]}}),o.ast.unshift(),o.ast.yield();case 3:return o.ast.unshift(),o.ast.yield();case 4:return o.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:a[l-1]}}),o.ast.unshift(),o.ast.yield();case 5:case 6:case 11:case 13:case 18:case 21:case 22:case 23:break;case 7:o.ast.set({operation:"member"}),o.ast.push();break;case 8:o.ast.set({operation:"subscript"}),o.ast.push();break;case 9:case 19:o.ast.set({scope:"child"});break;case 10:case 20:o.ast.set({scope:"descendant"});break;case 12:o.ast.set({scope:"child",operation:"member"});break;case 14:o.ast.set({expression:{type:"wildcard",value:a[l]}});break;case 15:o.ast.set({expression:{type:"identifier",value:a[l]}});break;case 16:o.ast.set({expression:{type:"script_expression",value:a[l]}});break;case 17:o.ast.set({expression:{type:"numeric_literal",value:parseInt(a[l])}});break;case 24:a[l].length>1?o.ast.set({expression:{type:"union",value:a[l]}}):this.$=a[l];break;case 25:this.$=[a[l]];break;case 26:this.$=a[l-2].concat(a[l]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(a[l])}},o.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:a[l]}},o.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:a[l]}},o.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:a[l]}},o.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:a[l]}},o.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:a[l]}},o.ast.set(this.$);break;case 33:case 34:this.$=a[l]}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],r=[null],o=[],i=this.table,a="",s=0,l=0,c=0,u=2,d=1,p=o.slice.call(arguments,1);this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;o.push(f);var h=this.lexer.options&&this.lexer.options.ranges;function g(){var e;return"number"!=typeof(e=t.lexer.lex()||d)&&(e=t.symbols_[e]||e),e}"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,y,v,S,C,b,E,T,w,I={};;){if(v=n[n.length-1],this.defaultActions[v]?S=this.defaultActions[v]:(null==m&&(m=g()),S=i[v]&&i[v][m]),void 0===S||!S.length||!S[0]){var P="";for(b in w=[],i[v])this.terminals_[b]&&b>u&&w.push("'"+this.terminals_[b]+"'");P=this.lexer.showPosition?"Parse error on line "+(s+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(s+1)+": Unexpected "+(m==d?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(P,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:f,expected:w})}if(S[0]instanceof Array&&S.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+m);switch(S[0]){case 1:n.push(m),r.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(S[1]),m=null,y?(m=y,y=null):(l=this.lexer.yyleng,a=this.lexer.yytext,s=this.lexer.yylineno,f=this.lexer.yylloc,c>0&&c--);break;case 2:if(E=this.productions_[S[1]][1],I.$=r[r.length-E],I._$={first_line:o[o.length-(E||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(E||1)].first_column,last_column:o[o.length-1].last_column},h&&(I._$.range=[o[o.length-(E||1)].range[0],o[o.length-1].range[1]]),void 0!==(C=this.performAction.apply(I,[a,l,s,this.yy,S[1],r,o].concat(p))))return C;E&&(n=n.slice(0,-1*E*2),r=r.slice(0,-1*E),o=o.slice(0,-1*E)),n.push(this.productions_[S[1]][0]),r.push(I.$),o.push(I._$),T=i[n[n.length-2]][n[n.length-1]],n.push(T);break;case 3:return!0}}return!0}},t={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(e){for(var t in e)this._node[t]=e[t];return this._node},node:function(e){return arguments.length&&(this._node=e),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var e=this._nodes;return this.initialize(),e}},n={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(r=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((n=this._input.match(this.rules[o[i]]))&&(!t||n[0].length>t[0].length)){if(t=n,r=i,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,o[i])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,o[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return t.yytext=t.yytext.substr(1,t.yyleng-2),32;case 11:return t.yytext=t.yytext.substr(1,t.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function r(){this.yy={}}return e.lexer=n,r.prototype=e,e.Parser=r,new r}();void 0!==e&&void 0!==n&&(n.parser=i,n.Parser=i.Parser,n.parse=function(){return i.parse.apply(i,arguments)},n.main=function(t){t[1]||(o.log("Usage: "+t[0]+" FILE"),r.exit(1));var i=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(i)},void 0!==t&&e.main===t&&n.main(r.argv.slice(1)))}).call(this,e("_process"))},{_process:14,fs:12,path:13}],2:[function(e,t,n){t.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(e,t,n){var r=e("./dict"),o=e("fs"),i={lex:{macros:{esc:"\\\\",int:r.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[r.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[r.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[r.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};o.readFileSync&&(i.moduleInclude=o.readFileSync(e.resolve("../include/module.js")),i.actionInclude=o.readFileSync(e.resolve("../include/action.js"))),t.exports=i},{"./dict":2,fs:12}],4:[function(e,t,n){var r=e("./aesprim"),o=e("./slice"),i=e("static-eval"),a=e("underscore").uniq,s=function(){return this.initialize.apply(this,arguments)};function l(t,n,o){var i=e("./index"),a=h(r.parse(n).body[0].expression,{"@":t.value}),s=o.replace(/\{\{\s*value\s*\}\}/g,a),l=i.nodes(t.value,s);return l.forEach((function(e){e.path=t.path.concat(e.path.slice(1))})),l}function c(e){return Array.isArray(e)}function u(e){return e&&!(e instanceof Array)&&e instanceof Object}function d(e){return function(t,n,r,o){var i=t.value,a=t.path,s=[],l=function(t,i){c(t)?(t.forEach((function(e,t){s.length>=o||r(t,e,n)&&s.push({path:i.concat(t),value:e})})),t.forEach((function(t,n){s.length>=o||e&&l(t,i.concat(n))}))):u(t)&&(this.keys(t).forEach((function(e){s.length>=o||r(e,t[e],n)&&s.push({path:i.concat(e),value:t[e]})})),this.keys(t).forEach((function(n){s.length>=o||e&&l(t[n],i.concat(n))})))}.bind(this);return l(i,a),s}}function p(e){return function(t,n,r){return this.descend(n,t.expression.value,e,r)}}function f(e){return function(t,n,r){return this.traverse(n,t.expression.value,e,r)}}function h(){try{return i.apply(this,arguments)}catch(e){}}function g(e){return e=e.filter((function(e){return e})),a(e,(function(e){return e.path.map((function(e){return String(e).replace("-","--")})).join("-")}))}function m(e){var t=String(e);return t.match(/^-?[0-9]+$/)?parseInt(t):null}s.prototype.initialize=function(){this.traverse=d(!0),this.descend=d()},s.prototype.keys=Object.keys,s.prototype.resolve=function(e){var t=[e.operation,e.scope,e.expression.type].join("-"),n=this._fns[t];if(!n)throw new Error("couldn't resolve key: "+t);return n.bind(this)},s.prototype.register=function(e,t){if(!t instanceof Function)throw new Error("handler must be a function");this._fns[e]=t},s.prototype._fns={"member-child-identifier":function(e,t){var n=e.expression.value,r=t.value;if(r instanceof Object&&n in r)return[{value:r[n],path:t.path.concat(n)}]},"member-descendant-identifier":f((function(e,t,n){return e==n})),"subscript-child-numeric_literal":p((function(e,t,n){return e===n})),"member-child-numeric_literal":p((function(e,t,n){return String(e)===String(n)})),"subscript-descendant-numeric_literal":f((function(e,t,n){return e===n})),"member-child-wildcard":p((function(){return!0})),"member-descendant-wildcard":f((function(){return!0})),"subscript-descendant-wildcard":f((function(){return!0})),"subscript-child-wildcard":p((function(){return!0})),"subscript-child-slice":function(e,t){if(c(t.value)){var n=e.expression.value.split(":").map(m),r=t.value.map((function(e,n){return{value:e,path:t.path.concat(n)}}));return o.apply(null,[r].concat(n))}},"subscript-child-union":function(e,t){var n=[];return e.expression.value.forEach((function(e){var r={operation:"subscript",scope:"child",expression:e.expression},o=this.resolve(r)(r,t);o&&(n=n.concat(o))}),this),g(n)},"subscript-descendant-union":function(t,n,r){var o=e(".."),i=this,a=[];return o.nodes(n,"$..*").slice(1).forEach((function(e){a.length>=r||t.expression.value.forEach((function(t){var n={operation:"subscript",scope:"child",expression:t.expression},r=i.resolve(n)(n,e);a=a.concat(r)}))})),g(a)},"subscript-child-filter_expression":function(e,t,n){var o=e.expression.value.slice(2,-1),i=r.parse(o).body[0].expression,a=function(e,t){return h(i,{"@":t})};return this.descend(t,null,a,n)},"subscript-descendant-filter_expression":function(e,t,n){var o=e.expression.value.slice(2,-1),i=r.parse(o).body[0].expression,a=function(e,t){return h(i,{"@":t})};return this.traverse(t,null,a,n)},"subscript-child-script_expression":function(e,t){return l(t,e.expression.value.slice(1,-1),"$[{{value}}]")},"member-child-script_expression":function(e,t){return l(t,e.expression.value.slice(1,-1),"$.{{value}}")},"member-descendant-script_expression":function(e,t){return l(t,e.expression.value.slice(1,-1),"$..value")}},s.prototype._fns["subscript-child-string_literal"]=s.prototype._fns["member-child-identifier"],s.prototype._fns["member-descendant-numeric_literal"]=s.prototype._fns["subscript-descendant-string_literal"]=s.prototype._fns["member-descendant-identifier"],t.exports=s},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(e,t,n){var r=e("assert"),o=e("./dict"),i=e("./parser"),a=e("./handlers"),s=function(){this.initialize.apply(this,arguments)};function l(e){return"[object String]"==Object.prototype.toString.call(e)}s.prototype.initialize=function(){this.parser=new i,this.handlers=new a},s.prototype.parse=function(e){return r.ok(l(e),"we need a path"),this.parser.parse(e)},s.prototype.parent=function(e,t){r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path");var n=this.nodes(e,t)[0];return n.path.pop(),this.value(e,n.path)},s.prototype.apply=function(e,t,n){r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),r.equal(typeof n,"function","fn needs to be function");var o=this.nodes(e,t).sort((function(e,t){return t.path.length-e.path.length}));return o.forEach((function(t){var r=t.path.pop(),o=this.value(e,this.stringify(t.path)),i=t.value=n.call(e,o[r]);o[r]=i}),this),o},s.prototype.value=function(e,t,n){if(r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),arguments.length>=3){var o=this.nodes(e,t).shift();if(!o)return this._vivify(e,t,n);var i=o.path.slice(-1).shift();this.parent(e,this.stringify(o.path))[i]=n}return this.query(e,this.stringify(t),1).shift()},s.prototype._vivify=function(e,t,n){var o=this;r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path");var i=this.parser.parse(t).map((function(e){return e.expression.value})),a=function(t,n){var r=t.pop(),i=o.value(e,t);i||(a(t.concat(),"string"==typeof r?{}:[]),i=o.value(e,t)),i[r]=n};return a(i,n),this.query(e,t)[0]},s.prototype.query=function(e,t,n){return r.ok(e instanceof Object,"obj needs to be an object"),r.ok(l(t),"we need a path"),this.nodes(e,t,n).map((function(e){return e.value}))},s.prototype.paths=function(e,t,n){return r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),this.nodes(e,t,n).map((function(e){return e.path}))},s.prototype.nodes=function(e,t,n){if(r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),0===n)return[];var o=this.parser.parse(t),i=this.handlers,a=[{path:["$"],value:e}],s=[];return o.length&&"root"==o[0].expression.type&&o.shift(),o.length?(o.forEach((function(e,t){if(!(s.length>=n)){var r=i.resolve(e),l=[];a.forEach((function(i){if(!(s.length>=n)){var a=r(e,i,n);t==o.length-1?s=s.concat(a||[]):l=l.concat(a||[])}})),a=l}})),n?s.slice(0,n):s):a},s.prototype.stringify=function(e){r.ok(e,"we need a path");var t="$",n={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return(e=this._normalize(e)).forEach((function(e){if("root"!=e.expression.type){var r,o=[e.scope,e.operation].join("-"),i=n[o];if(r="string_literal"==e.expression.type?JSON.stringify(e.expression.value):e.expression.value,!i)throw new Error("couldn't find template "+o);t+=i.replace(/{{value}}/,r)}})),t},s.prototype._normalize=function(e){if(r.ok(e,"we need a path"),"string"==typeof e)return this.parser.parse(e);if(Array.isArray(e)&&"string"==typeof e[0]){var t=[{expression:{type:"root",value:"$"}}];return e.forEach((function(e,n){if("$"!=e||0!==n)if("string"==typeof e&&e.match("^"+o.identifier+"$"))t.push({operation:"member",scope:"child",expression:{value:e,type:"identifier"}});else{var r="number"==typeof e?"numeric_literal":"string_literal";t.push({operation:"subscript",scope:"child",expression:{value:e,type:r}})}})),t}if(Array.isArray(e)&&"object"==typeof e[0])return e;throw new Error("couldn't understand path "+e)},s.Handlers=a,s.Parser=i;var c=new s;c.JSONPath=s,t.exports=c},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(e,t,n){var r=e("./grammar"),o=e("../generated/parser"),i=function(){var e=new o.Parser,t=e.parseError;return e.yy.parseError=function(){e.yy.ast&&e.yy.ast.initialize(),t.apply(e,arguments)},e};i.grammar=r,t.exports=i},{"../generated/parser":1,"./grammar":3}],7:[function(e,t,n){function r(e){return String(e).match(/^[0-9]+$/)?parseInt(e):Number.isFinite(e)?parseInt(e,10):0}t.exports=function(e,t,n,o){if("string"==typeof t)throw new Error("start cannot be a string");if("string"==typeof n)throw new Error("end cannot be a string");if("string"==typeof o)throw new Error("step cannot be a string");var i=e.length;if(0===o)throw new Error("step cannot be zero");if(o=o?r(o):1,n=n<0?i+n:n,t=r(0===(t=t<0?i+t:t)?0:t||(o>0?0:i-1)),n=r(0===n?0:n||(o>0?i:-1)),t=o>0?Math.max(0,t):Math.min(i,t),n=o>0?Math.min(n,i):Math.max(-1,n),o>0&&n<=t)return[];if(o<0&&t<=n)return[];for(var a=[],s=t;s!=n&&!(o<0&&s<=n||o>0&&s>=n);s+=o)a.push(e[s]);return a}},{}],8:[function(e,t,n){var r=e("util/"),o=Array.prototype.slice,i=Object.prototype.hasOwnProperty,a=t.exports=d;function s(e,t){return r.isUndefined(t)?""+t:r.isNumber(t)&&!isFinite(t)||r.isFunction(t)||r.isRegExp(t)?t.toString():t}function l(e,t){return r.isString(e)?e.length<t?e:e.slice(0,t):e}function c(e){return l(JSON.stringify(e.actual,s),128)+" "+e.operator+" "+l(JSON.stringify(e.expected,s),128)}function u(e,t,n,r,o){throw new a.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:o})}function d(e,t){e||u(e,!0,t,"==",a.ok)}function p(e,t){if(e===t)return!0;if(r.isBuffer(e)&&r.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return r.isDate(e)&&r.isDate(t)?e.getTime()===t.getTime():r.isRegExp(e)&&r.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:r.isObject(e)||r.isObject(t)?h(e,t):e==t}function f(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function h(e,t){if(r.isNullOrUndefined(e)||r.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(r.isPrimitive(e)||r.isPrimitive(t))return e===t;var n=f(e),i=f(t);if(n&&!i||!n&&i)return!1;if(n)return p(e=o.call(e),t=o.call(t));var a,s,l=y(e),c=y(t);if(l.length!=c.length)return!1;for(l.sort(),c.sort(),s=l.length-1;s>=0;s--)if(l[s]!=c[s])return!1;for(s=l.length-1;s>=0;s--)if(!p(e[a=l[s]],t[a]))return!1;return!0}function g(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function m(e,t,n,o){var i;r.isString(n)&&(o=n,n=null);try{t()}catch(e){i=e}if(o=(n&&n.name?" ("+n.name+").":".")+(o?" "+o:"."),e&&!i&&u(i,n,"Missing expected exception"+o),!e&&g(i,n)&&u(i,n,"Got unwanted exception"+o),e&&i&&n&&!g(i,n)||!e&&i)throw i}a.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=c(this),this.generatedMessage=!0);var t=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,o=t.name,i=r.indexOf("\n"+o);if(i>=0){var a=r.indexOf("\n",i+1);r=r.substring(a+1)}this.stack=r}}},r.inherits(a.AssertionError,Error),a.fail=u,a.ok=d,a.equal=function(e,t,n){e!=t&&u(e,t,n,"==",a.equal)},a.notEqual=function(e,t,n){e==t&&u(e,t,n,"!=",a.notEqual)},a.deepEqual=function(e,t,n){p(e,t)||u(e,t,n,"deepEqual",a.deepEqual)},a.notDeepEqual=function(e,t,n){p(e,t)&&u(e,t,n,"notDeepEqual",a.notDeepEqual)},a.strictEqual=function(e,t,n){e!==t&&u(e,t,n,"===",a.strictEqual)},a.notStrictEqual=function(e,t,n){e===t&&u(e,t,n,"!==",a.notStrictEqual)},a.throws=function(e,t,n){m.apply(this,[!0].concat(o.call(arguments)))},a.doesNotThrow=function(e,t){m.apply(this,[!1].concat(o.call(arguments)))},a.ifError=function(e){if(e)throw e};var y=Object.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t}},{"util/":11}],9:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],10:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],11:[function(e,t,r){(function(t,n){var i=/%[sdj%]/g;r.format=function(e){if(!T(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(l(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])C(s)||!_(s)?a+=" "+s:a+=" "+l(s);return a},r.deprecate=function(e,i){if(I(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var a=!1;function s(){if(!a){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?o.trace(i):o.error(i),a=!0}return e.apply(this,arguments)}return s};var a,s={};function l(e,t){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),S(t)?n.showHidden=t:t&&r._extend(n,t),I(n.showHidden)&&(n.showHidden=!1),I(n.depth)&&(n.depth=2),I(n.colors)&&(n.colors=!1),I(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),p(n,e,n.depth)}function c(e,t){var n=l.styles[t];return n?"["+l.colors[n][0]+"m"+e+"["+l.colors[n][1]+"m":e}function u(e,t){return e}function d(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}function p(e,t,n){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(n,e);return T(o)||(o=p(e,o,n)),o}var i=f(e,t);if(i)return i;var a=Object.keys(t),s=d(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),k(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(t);if(0===a.length){if(x(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(P(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(A(t))return e.stylize(Date.prototype.toString.call(t),"date");if(k(t))return h(t)}var c,u="",S=!1,C=["{","}"];return v(t)&&(S=!0,C=["[","]"]),x(t)&&(u=" [Function"+(t.name?": "+t.name:"")+"]"),P(t)&&(u=" "+RegExp.prototype.toString.call(t)),A(t)&&(u=" "+Date.prototype.toUTCString.call(t)),k(t)&&(u=" "+h(t)),0!==a.length||S&&0!=t.length?n<0?P(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=S?g(e,t,n,s,a):a.map((function(r){return m(e,t,n,s,r,S)})),e.seen.pop(),y(c,u,C)):C[0]+u+C[1]}function f(e,t){if(I(t))return e.stylize("undefined","undefined");if(T(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return E(t)?e.stylize(""+t,"number"):S(t)?e.stylize(""+t,"boolean"):C(t)?e.stylize("null","null"):void 0}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)F(t,String(a))?i.push(m(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(m(e,t,n,r,o,!0))})),i}function m(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),F(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=C(n)?p(e,l.value,null):p(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),I(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function y(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function v(e){return Array.isArray(e)}function S(e){return"boolean"==typeof e}function C(e){return null===e}function b(e){return null==e}function E(e){return"number"==typeof e}function T(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function I(e){return void 0===e}function P(e){return _(e)&&"[object RegExp]"===O(e)}function _(e){return"object"==typeof e&&null!==e}function A(e){return _(e)&&"[object Date]"===O(e)}function k(e){return _(e)&&("[object Error]"===O(e)||e instanceof Error)}function x(e){return"function"==typeof e}function N(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function O(e){return Object.prototype.toString.call(e)}function D(e){return e<10?"0"+e.toString(10):e.toString(10)}r.debuglog=function(e){if(I(a)&&(a=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(a)){var n=t.pid;s[e]=function(){var t=r.format.apply(r,arguments);o.error("%s %d: %s",e,n,t)}}else s[e]=function(){};return s[e]},r.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=v,r.isBoolean=S,r.isNull=C,r.isNullOrUndefined=b,r.isNumber=E,r.isString=T,r.isSymbol=w,r.isUndefined=I,r.isRegExp=P,r.isObject=_,r.isDate=A,r.isError=k,r.isFunction=x,r.isPrimitive=N,r.isBuffer=e("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var e=new Date,t=[D(e.getHours()),D(e.getMinutes()),D(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){o.log("%s - %s",R(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(e,t,n){},{}],13:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,o=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!o){n=t+1;break}}else-1===r&&(o=!1,r=t+1);return-1===r?"":e.slice(n,r)}function o(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}n.resolve=function(){for(var n="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,r="/"===a.charAt(0))}return(r?"/":"")+(n=t(o(n.split("/"),(function(e){return!!e})),!r).join("/"))||"."},n.normalize=function(e){var r=n.isAbsolute(e),a="/"===i(e,-1);return(e=t(o(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&a&&(e+="/"),(r?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(o(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var o=r(e.split("/")),i=r(t.split("/")),a=Math.min(o.length,i.length),s=a,l=0;l<a;l++)if(o[l]!==i[l]){s=l;break}var c=[];for(l=s;l<o.length;l++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,o=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!o){r=i;break}}else o=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},n.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,o=!0,i=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===r&&(o=!1,r=a+1),46===s?-1===t?t=a:1!==i&&(i=1):-1!==t&&(i=-1);else if(!o){n=a+1;break}}return-1===t||-1===r||0===i||1===i&&t===r-1&&t===n+1?"":e.slice(t,r)};var i=function(e,t,n){return e.substr(t,n)}}).call(this,e("_process"))},{_process:14}],14:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}function c(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{return o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,d=[],p=!1,f=-1;function h(){p&&u&&(p=!1,u.length?d=u.concat(d):f=-1,d.length&&g())}function g(){if(!p){var e=l(h);p=!0;for(var t=d.length;t;){for(u=d,d=[];++f<t;)u&&u[f].run();f=-1,t=d.length}u=null,p=!1,c(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||p||l(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],15:[function(e,t,n){var r=e("escodegen").generate;t.exports=function(e,t){t||(t={});var n={},o=function e(o,i){if("Literal"===o.type)return o.value;if("UnaryExpression"===o.type){var a=e(o.argument);return"+"===o.operator?+a:"-"===o.operator?-a:"~"===o.operator?~a:"!"===o.operator?!a:n}if("ArrayExpression"===o.type){for(var s=[],l=0,c=o.elements.length;l<c;l++){if((y=e(o.elements[l]))===n)return n;s.push(y)}return s}if("ObjectExpression"===o.type){var u={};for(l=0;l<o.properties.length;l++){var d=null===(v=o.properties[l]).value?v.value:e(v.value);if(d===n)return n;u[v.key.value||v.key.name]=d}return u}if("BinaryExpression"===o.type||"LogicalExpression"===o.type){if((c=e(o.left))===n)return n;var p=e(o.right);if(p===n)return n;var f=o.operator;return"=="===f?c==p:"==="===f?c===p:"!="===f?c!=p:"!=="===f?c!==p:"+"===f?c+p:"-"===f?c-p:"*"===f?c*p:"/"===f?c/p:"%"===f?c%p:"<"===f?c<p:"<="===f?c<=p:">"===f?c>p:">="===f?c>=p:"|"===f?c|p:"&"===f?c&p:"^"===f?c^p:"&&"===f?c&&p:"||"===f?c||p:n}if("Identifier"===o.type)return{}.hasOwnProperty.call(t,o.name)?t[o.name]:n;if("ThisExpression"===o.type)return{}.hasOwnProperty.call(t,"this")?t.this:n;if("CallExpression"===o.type){var h=e(o.callee);if(h===n)return n;if("function"!=typeof h)return n;var g=o.callee.object?e(o.callee.object):n;g===n&&(g=null);var m=[];for(l=0,c=o.arguments.length;l<c;l++){var y;if((y=e(o.arguments[l]))===n)return n;m.push(y)}return h.apply(g,m)}var v;if("MemberExpression"===o.type)return(u=e(o.object))===n||"function"==typeof u?n:"Identifier"===o.property.type?u[o.property.name]:(v=e(o.property))===n?n:u[v];if("ConditionalExpression"===o.type)return(a=e(o.test))===n?n:e(a?o.consequent:o.alternate);if("ExpressionStatement"===o.type)return(a=e(o.expression))===n?n:a;if("ReturnStatement"===o.type)return e(o.argument);if("FunctionExpression"===o.type){var S=o.body.body,C={};for(Object.keys(t).forEach((function(e){C[e]=t[e]})),l=0;l<o.params.length;l++){var b=o.params[l];if("Identifier"!=b.type)return n;t[b.name]=null}for(var l in S)if(e(S[l])===n)return n;t=C;var E=Object.keys(t),T=E.map((function(e){return t[e]}));return Function(E.join(", "),"return "+r(o)).apply(null,T)}if("TemplateLiteral"===o.type){var w="";for(l=0;l<o.expressions.length;l++)w+=e(o.quasis[l]),w+=e(o.expressions[l]);return w+=e(o.quasis[l])}if("TaggedTemplateExpression"===o.type){var I=e(o.tag),P=o.quasi,_=P.quasis.map(e),A=P.expressions.map(e);return I.apply(null,[_].concat(A))}return"TemplateElement"===o.type?o.value.cooked:n}(e);return o===n?void 0:o}},{escodegen:12}],jsonpath:[function(e,t,n){t.exports=e("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")},77551:(e,t,n)=>{"use strict";var r=n(58651),o=n(8520),i=n(23401),a=n(40847);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!o)throw Error(s(227));var l=new Set,c={};function u(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(c[e]=t,e=0;e<t.length;e++)l.add(t[e])}var p=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h=Object.prototype.hasOwnProperty,g={},m={};function y(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new y(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new y(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new y(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new y(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new y(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new y(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new y(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new y(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new y(e,5,!1,e.toLowerCase(),null,!1,!1)}));var S=/[\-:]([a-z])/g;function C(e){return e[1].toUpperCase()}function b(e,t,n,r){var o=v.hasOwnProperty(t)?v[t]:null;(null!==o?0===o.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!h.call(m,e)||!h.call(g,e)&&(f.test(e)?m[e]=!0:(g[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(S,C);v[t]=new y(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(S,C);v[t]=new y(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(S,C);v[t]=new y(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new y(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new y(e,1,!1,e.toLowerCase(),null,!0,!0)}));var E=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,T=60103,w=60106,I=60107,P=60108,_=60114,A=60109,k=60110,x=60112,N=60113,O=60120,D=60115,L=60116,R=60121,F=60128,M=60129,B=60130,U=60131;if("function"==typeof Symbol&&Symbol.for){var z=Symbol.for;T=z("react.element"),w=z("react.portal"),I=z("react.fragment"),P=z("react.strict_mode"),_=z("react.profiler"),A=z("react.provider"),k=z("react.context"),x=z("react.forward_ref"),N=z("react.suspense"),O=z("react.suspense_list"),D=z("react.memo"),L=z("react.lazy"),R=z("react.block"),z("react.scope"),F=z("react.opaque.id"),M=z("react.debug_trace_mode"),B=z("react.offscreen"),U=z("react.legacy_hidden")}var H,G="function"==typeof Symbol&&Symbol.iterator;function V(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=G&&e[G]||e["@@iterator"])?e:null}function j(e){if(void 0===H)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||""}return"\n"+H+e}var q=!1;function W(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var o=e.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s])return"\n"+o[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function Y(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=W(e.type,!1);case 11:return e=W(e.type.render,!1);case 22:return e=W(e.type._render,!1);case 1:return e=W(e.type,!0);default:return""}}function Q(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case I:return"Fragment";case w:return"Portal";case _:return"Profiler";case P:return"StrictMode";case N:return"Suspense";case O:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case k:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case D:return Q(e.type);case R:return Q(e._render);case L:t=e._payload,e=e._init;try{return Q(e(t))}catch(e){}}return null}function J(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=X(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function $(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function ee(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function te(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=J(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ne(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function re(e,t){ne(e,t);var n=J(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,J(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function oe(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ae(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return o.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function se(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+J(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function le(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:J(n)}}function ue(e,t){var n=J(t.value),r=J(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function de(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var pe={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function fe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function he(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?fe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ge,me,ye=(me=function(e,t){if(e.namespaceURI!==pe.svg||"innerHTML"in e)e.innerHTML=t;else{for((ge=ge||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ge.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return me(e,t)}))}:me);function ve(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Se={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ce=["Webkit","ms","Moz","O"];function be(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||Se.hasOwnProperty(e)&&Se[e]?(""+t).trim():t+"px"}function Ee(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=be(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(Se).forEach((function(e){Ce.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Se[t]=Se[e]}))}));var Te=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function we(e,t){if(t){if(Te[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62))}}function Ie(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Pe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Ae=null,ke=null;function xe(e){if(e=ro(e)){if("function"!=typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=io(t),_e(e.stateNode,e.type,t))}}function Ne(e){Ae?ke?ke.push(e):ke=[e]:Ae=e}function Oe(){if(Ae){var e=Ae,t=ke;if(ke=Ae=null,xe(e),t)for(e=0;e<t.length;e++)xe(t[e])}}function De(e,t){return e(t)}function Le(e,t,n,r,o){return e(t,n,r,o)}function Re(){}var Fe=De,Me=!1,Be=!1;function Ue(){null===Ae&&null===ke||(Re(),Oe())}function ze(e,t){var n=e.stateNode;if(null===n)return null;var r=io(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}var He=!1;if(p)try{var Ge={};Object.defineProperty(Ge,"passive",{get:function(){He=!0}}),window.addEventListener("test",Ge,Ge),window.removeEventListener("test",Ge,Ge)}catch(me){He=!1}function Ve(e,t,n,r,o,i,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var je=!1,qe=null,We=!1,Ye=null,Qe={onError:function(e){je=!0,qe=e}};function Je(e,t,n,r,o,i,a,s,l){je=!1,qe=null,Ve.apply(Qe,arguments)}function Xe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ke(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ze(e){if(Xe(e)!==e)throw Error(s(188))}function $e(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Ze(o),e;if(i===r)return Ze(o),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,ot,it=!1,at=[],st=null,lt=null,ct=null,ut=new Map,dt=new Map,pt=[],ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ht(e,t,n,r,o){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:o,targetContainers:[r]}}function gt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":lt=null;break;case"mouseover":case"mouseout":ct=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(t.pointerId)}}function mt(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e=ht(t,n,r,o,i),null!==t&&(null!==(t=ro(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function yt(e){var t=no(e.target);if(null!==t){var n=Xe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ke(n)))return e.blockedOn=t,void ot(e.lanePriority,(function(){a.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function vt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ro(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function St(e,t,n){vt(e)&&n.delete(t)}function Ct(){for(it=!1;0<at.length;){var e=at[0];if(null!==e.blockedOn){null!==(e=ro(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&at.shift()}null!==st&&vt(st)&&(st=null),null!==lt&&vt(lt)&&(lt=null),null!==ct&&vt(ct)&&(ct=null),ut.forEach(St),dt.forEach(St)}function bt(e,t){e.blockedOn===t&&(e.blockedOn=null,it||(it=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ct)))}function Et(e){function t(t){return bt(t,e)}if(0<at.length){bt(at[0],e);for(var n=1;n<at.length;n++){var r=at[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==st&&bt(st,e),null!==lt&&bt(lt,e),null!==ct&&bt(ct,e),ut.forEach(t),dt.forEach(t),n=0;n<pt.length;n++)(r=pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<pt.length&&null===(n=pt[0]).blockedOn;)yt(n),null===n.blockedOn&&pt.shift()}function Tt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wt={animationend:Tt("Animation","AnimationEnd"),animationiteration:Tt("Animation","AnimationIteration"),animationstart:Tt("Animation","AnimationStart"),transitionend:Tt("Transition","TransitionEnd")},It={},Pt={};function _t(e){if(It[e])return It[e];if(!wt[e])return e;var t,n=wt[e];for(t in n)if(n.hasOwnProperty(t)&&t in Pt)return It[e]=n[t];return e}p&&(Pt=document.createElement("div").style,"AnimationEvent"in window||(delete wt.animationend.animation,delete wt.animationiteration.animation,delete wt.animationstart.animation),"TransitionEvent"in window||delete wt.transitionend.transition);var At=_t("animationend"),kt=_t("animationiteration"),xt=_t("animationstart"),Nt=_t("transitionend"),Ot=new Map,Dt=new Map,Lt=["abort","abort",At,"animationEnd",kt,"animationIteration",xt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Nt,"transitionEnd","waiting","waiting"];function Rt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],o=e[n+1];o="on"+(o[0].toUpperCase()+o.slice(1)),Dt.set(r,t),Ot.set(r,o),u(o,[r])}}(0,a.unstable_now)();var Ft=8;function Mt(e){if(1&e)return Ft=15,1;if(2&e)return Ft=14,2;if(4&e)return Ft=13,4;var t=24&e;return 0!==t?(Ft=12,t):32&e?(Ft=11,32):0!==(t=192&e)?(Ft=10,t):256&e?(Ft=9,256):0!==(t=3584&e)?(Ft=8,t):4096&e?(Ft=7,4096):0!==(t=4186112&e)?(Ft=6,t):0!==(t=62914560&e)?(Ft=5,t):67108864&e?(Ft=4,67108864):134217728&e?(Ft=3,134217728):0!==(t=805306368&e)?(Ft=2,t):1073741824&e?(Ft=1,1073741824):(Ft=8,e)}function Bt(e,t){var n=e.pendingLanes;if(0===n)return Ft=0;var r=0,o=0,i=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==i)r=i,o=Ft=15;else if(0!==(i=134217727&n)){var l=i&~a;0!==l?(r=Mt(l),o=Ft):0!==(s&=i)&&(r=Mt(s),o=Ft)}else 0!==(i=n&~a)?(r=Mt(i),o=Ft):0!==s&&(r=Mt(s),o=Ft);if(0===r)return 0;if(r=n&((0>(r=31-jt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&!(t&a)){if(Mt(t),o<=Ft)return t;Ft=o}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-jt(t)),r|=e[n],t&=~o;return r}function Ut(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function zt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Ht(24&~t))?zt(10,t):e;case 10:return 0===(e=Ht(192&~t))?zt(8,t):e;case 8:return 0===(e=Ht(3584&~t))&&(0===(e=Ht(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Ht(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function Ht(e){return e&-e}function Gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Vt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-jt(t)]=n}var jt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(qt(e)/Wt|0)|0},qt=Math.log,Wt=Math.LN2;var Yt=a.unstable_UserBlockingPriority,Qt=a.unstable_runWithPriority,Jt=!0;function Xt(e,t,n,r){Me||Re();var o=Zt,i=Me;Me=!0;try{Le(o,e,t,n,r)}finally{(Me=i)||Ue()}}function Kt(e,t,n,r){Qt(Yt,Zt.bind(null,e,t,n,r))}function Zt(e,t,n,r){var o;if(Jt)if((o=!(4&t))&&0<at.length&&-1<ft.indexOf(e))e=ht(null,e,t,n,r),at.push(e);else{var i=$t(e,t,n,r);if(null===i)o&&gt(e,r);else{if(o){if(-1<ft.indexOf(e))return e=ht(i,e,t,n,r),void at.push(e);if(function(e,t,n,r,o){switch(t){case"focusin":return st=mt(st,e,t,n,r,o),!0;case"dragenter":return lt=mt(lt,e,t,n,r,o),!0;case"mouseover":return ct=mt(ct,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return ut.set(i,mt(ut.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,dt.set(i,mt(dt.get(i)||null,e,t,n,r,o)),!0}return!1}(i,e,t,n,r))return;gt(e,r)}Rr(e,t,r,null,n)}}}function $t(e,t,n,r){var o=Pe(r);if(null!==(o=no(o))){var i=Xe(o);if(null===i)o=null;else{var a=i.tag;if(13===a){if(null!==(o=Ke(i)))return o;o=null}else if(3===a){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;o=null}else i!==o&&(o=null)}}return Rr(e,t,r,o,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,o="value"in en?en.value:en.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return nn=o.slice(e,1<t?1-t:void 0)}function on(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function an(){return!0}function sn(){return!1}function ln(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?an:sn,this.isPropagationStopped=sn,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),t}var cn,un,dn,pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fn=ln(pn),hn=i({},pn,{view:0,detail:0}),gn=ln(hn),mn=i({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dn&&(dn&&"mousemove"===e.type?(cn=e.screenX-dn.screenX,un=e.screenY-dn.screenY):un=cn=0,dn=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:un}}),yn=ln(mn),vn=ln(i({},mn,{dataTransfer:0})),Sn=ln(i({},hn,{relatedTarget:0})),Cn=ln(i({},pn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=i({},pn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),En=ln(bn),Tn=ln(i({},pn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},In={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _n(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Pn[e])&&!!t[e]}function An(){return _n}var kn=i({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=on(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?In[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?on(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?on(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=ln(kn),Nn=ln(i({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=ln(i({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Dn=ln(i({},pn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ln=i({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=ln(Ln),Fn=[9,13,27,32],Mn=p&&"CompositionEvent"in window,Bn=null;p&&"documentMode"in document&&(Bn=document.documentMode);var Un=p&&"TextEvent"in window&&!Bn,zn=p&&(!Mn||Bn&&8<Bn&&11>=Bn),Hn=String.fromCharCode(32),Gn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Fn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Qn(e,t,n,r){Ne(r),0<(t=Mr(t,"onChange")).length&&(n=new fn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Jn=null,Xn=null;function Kn(e){kr(e,0)}function Zn(e){if(Z(oo(e)))return e}function $n(e,t){if("change"===e)return t}var er=!1;if(p){var tr;if(p){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"==typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function or(){Jn&&(Jn.detachEvent("onpropertychange",ir),Xn=Jn=null)}function ir(e){if("value"===e.propertyName&&Zn(Xn)){var t=[];if(Qn(t,Xn,e,Pe(e)),e=Kn,Me)e(t);else{Me=!0;try{De(e,t)}finally{Me=!1,Ue()}}}}function ar(e,t,n){"focusin"===e?(or(),Xn=n,(Jn=t).attachEvent("onpropertychange",ir)):"focusout"===e&&or()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zn(Xn)}function lr(e,t){if("click"===e)return Zn(t)}function cr(e,t){if("input"===e||"change"===e)return Zn(t)}var ur="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},dr=Object.prototype.hasOwnProperty;function pr(e,t){if(ur(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!dr.call(t,n[r])||!ur(e[n[r]],t[n[r]]))return!1;return!0}function fr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hr(e,t){var n,r=fr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=fr(r)}}function gr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?gr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function mr(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function yr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var vr=p&&"documentMode"in document&&11>=document.documentMode,Sr=null,Cr=null,br=null,Er=!1;function Tr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Er||null==Sr||Sr!==$(r)||("selectionStart"in(r=Sr)&&yr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&pr(br,r)||(br=r,0<(r=Mr(Cr,"onSelect")).length&&(t=new fn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Sr)))}Rt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Rt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Rt(Lt,2);for(var wr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ir=0;Ir<wr.length;Ir++)Dt.set(wr[Ir],0);d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_r=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Ar(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,a,l,c){if(Je.apply(this,arguments),je){if(!je)throw Error(s(198));var u=qe;je=!1,qe=null,We||(We=!0,Ye=u)}}(r,t,void 0,e),e.currentTarget=null}function kr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;Ar(o,s,c),i=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;Ar(o,s,c),i=l}}}if(We)throw e=Ye,We=!1,Ye=null,e}function xr(e,t){var n=ao(t),r=e+"__bubble";n.has(r)||(Lr(t,e,2,!1),n.add(r))}var Nr="_reactListening"+Math.random().toString(36).slice(2);function Or(e){e[Nr]||(e[Nr]=!0,l.forEach((function(t){_r.has(t)||Dr(t,!1,e,null),Dr(t,!0,e,null)})))}function Dr(e,t,n,r){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=n;if("selectionchange"===e&&9!==n.nodeType&&(i=n.ownerDocument),null!==r&&!t&&_r.has(e)){if("scroll"!==e)return;o|=2,i=r}var a=ao(i),s=e+"__"+(t?"capture":"bubble");a.has(s)||(t&&(o|=4),Lr(i,e,o,t),a.add(s))}function Lr(e,t,n,r){var o=Dt.get(t);switch(void 0===o?2:o){case 0:o=Xt;break;case 1:o=Kt;break;default:o=Zt}n=o.bind(null,t,n,e),o=void 0,!He||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Rr(e,t,n,r,o){var i=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===o||8===l.nodeType&&l.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=no(s)))return;if(5===(l=a.tag)||6===l){r=i=a;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(Be)return e(t,n);Be=!0;try{return Fe(e,t,n)}finally{Be=!1,Ue()}}((function(){var r=i,o=Pe(n),a=[];e:{var s=Ot.get(e);if(void 0!==s){var l=fn,c=e;switch(e){case"keypress":if(0===on(n))break e;case"keydown":case"keyup":l=xn;break;case"focusin":c="focus",l=Sn;break;case"focusout":c="blur",l=Sn;break;case"beforeblur":case"afterblur":l=Sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=yn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=On;break;case At:case kt:case xt:l=Cn;break;case Nt:l=Dn;break;case"scroll":l=gn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=En;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Nn}var u=!!(4&t),d=!u&&"scroll"===e,p=u?null!==s?s+"Capture":null:s;u=[];for(var f,h=r;null!==h;){var g=(f=h).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==p&&(null!=(g=ze(h,p))&&u.push(Fr(h,g,f)))),d)break;h=h.return}0<u.length&&(s=new l(s,c,null,n,o),a.push({event:s,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||16&t||!(c=n.relatedTarget||n.fromElement)||!no(c)&&!c[eo])&&(l||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?no(c):null)&&(c!==(d=Xe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=yn,g="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(u=Nn,g="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==l?s:oo(l),f=null==c?s:oo(c),(s=new u(g,h+"leave",l,n,o)).target=d,s.relatedTarget=f,g=null,no(o)===r&&((u=new u(p,h+"enter",c,n,o)).target=f,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(p=c,h=0,f=u=l;f;f=Br(f))h++;for(f=0,g=p;g;g=Br(g))f++;for(;0<h-f;)u=Br(u),h--;for(;0<f-h;)p=Br(p),f--;for(;h--;){if(u===p||null!==p&&u===p.alternate)break e;u=Br(u),p=Br(p)}u=null}else u=null;null!==l&&Ur(a,s,l,u,!1),null!==c&&null!==d&&Ur(a,d,c,u,!0)}if("select"===(l=(s=r?oo(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=$n;else if(Yn(s))if(er)m=cr;else{m=sr;var y=ar}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=lr);switch(m&&(m=m(e,r))?Qn(a,m,n,o):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ie(s,"number",s.value)),y=r?oo(r):window,e){case"focusin":(Yn(y)||"true"===y.contentEditable)&&(Sr=y,Cr=r,br=null);break;case"focusout":br=Cr=Sr=null;break;case"mousedown":Er=!0;break;case"contextmenu":case"mouseup":case"dragend":Er=!1,Tr(a,n,o);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":Tr(a,n,o)}var v;if(Mn)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else qn?Vn(e,n)&&(S="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(S="onCompositionStart");S&&(zn&&"ko"!==n.locale&&(qn||"onCompositionStart"!==S?"onCompositionEnd"===S&&qn&&(v=rn()):(tn="value"in(en=o)?en.value:en.textContent,qn=!0)),0<(y=Mr(r,S)).length&&(S=new Tn(S,e,null,n,o),a.push({event:S,listeners:y}),v?S.data=v:null!==(v=jn(n))&&(S.data=v))),(v=Un?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Gn=!0,Hn);case"textInput":return(e=t.data)===Hn&&Gn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Mn&&Vn(e,t)?(e=rn(),nn=tn=en=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return zn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Mr(r,"onBeforeInput")).length&&(o=new Tn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=v))}kr(a,t)}))}function Fr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Mr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=ze(e,n))&&r.unshift(Fr(e,i,o)),null!=(i=ze(e,t))&&r.push(Fr(e,i,o))),e=e.return}return r}function Br(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ur(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(l=ze(n,i))&&a.unshift(Fr(n,l,s)):o||null!=(l=ze(n,i))&&a.push(Fr(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}function zr(){}var Hr=null,Gr=null;function Vr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function jr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var qr="function"==typeof setTimeout?setTimeout:void 0,Wr="function"==typeof clearTimeout?clearTimeout:void 0;function Yr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Qr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Jr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Xr=0;var Kr=Math.random().toString(36).slice(2),Zr="__reactFiber$"+Kr,$r="__reactProps$"+Kr,eo="__reactContainer$"+Kr,to="__reactEvents$"+Kr;function no(e){var t=e[Zr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[eo]||n[Zr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Jr(e);null!==e;){if(n=e[Zr])return n;e=Jr(e)}return t}n=(e=n).parentNode}return null}function ro(e){return!(e=e[Zr]||e[eo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function oo(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function io(e){return e[$r]||null}function ao(e){var t=e[to];return void 0===t&&(t=e[to]=new Set),t}var so=[],lo=-1;function co(e){return{current:e}}function uo(e){0>lo||(e.current=so[lo],so[lo]=null,lo--)}function po(e,t){lo++,so[lo]=e.current,e.current=t}var fo={},ho=co(fo),go=co(!1),mo=fo;function yo(e,t){var n=e.type.contextTypes;if(!n)return fo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function vo(e){return null!=(e=e.childContextTypes)}function So(){uo(go),uo(ho)}function Co(e,t,n){if(ho.current!==fo)throw Error(s(168));po(ho,t),po(go,n)}function bo(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(s(108,Q(t)||"Unknown",o));return i({},n,r)}function Eo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fo,mo=ho.current,po(ho,e),po(go,go.current),!0}function To(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=bo(e,t,mo),r.__reactInternalMemoizedMergedChildContext=e,uo(go),uo(ho),po(ho,e)):uo(go),po(go,n)}var wo=null,Io=null,Po=a.unstable_runWithPriority,_o=a.unstable_scheduleCallback,Ao=a.unstable_cancelCallback,ko=a.unstable_shouldYield,xo=a.unstable_requestPaint,No=a.unstable_now,Oo=a.unstable_getCurrentPriorityLevel,Do=a.unstable_ImmediatePriority,Lo=a.unstable_UserBlockingPriority,Ro=a.unstable_NormalPriority,Fo=a.unstable_LowPriority,Mo=a.unstable_IdlePriority,Bo={},Uo=void 0!==xo?xo:function(){},zo=null,Ho=null,Go=!1,Vo=No(),jo=1e4>Vo?No:function(){return No()-Vo};function qo(){switch(Oo()){case Do:return 99;case Lo:return 98;case Ro:return 97;case Fo:return 96;case Mo:return 95;default:throw Error(s(332))}}function Wo(e){switch(e){case 99:return Do;case 98:return Lo;case 97:return Ro;case 96:return Fo;case 95:return Mo;default:throw Error(s(332))}}function Yo(e,t){return e=Wo(e),Po(e,t)}function Qo(e,t,n){return e=Wo(e),_o(e,t,n)}function Jo(){if(null!==Ho){var e=Ho;Ho=null,Ao(e)}Xo()}function Xo(){if(!Go&&null!==zo){Go=!0;var e=0;try{var t=zo;Yo(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),zo=null}catch(t){throw null!==zo&&(zo=zo.slice(e+1)),_o(Do,Jo),t}finally{Go=!1}}}var Ko=E.ReactCurrentBatchConfig;function Zo(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var $o=co(null),ei=null,ti=null,ni=null;function ri(){ni=ti=ei=null}function oi(e){var t=$o.current;uo($o),e.type._context._currentValue=t}function ii(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function ai(e,t){ei=e,ni=ti=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(Ma=!0),e.firstContext=null)}function si(e,t){if(ni!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(ni=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ti){if(null===ei)throw Error(s(308));ti=t,ei.dependencies={lanes:0,firstContext:t,responders:null}}else ti=ti.next=t;return e._currentValue}var li=!1;function ci(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ui(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function pi(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function fi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function hi(e,t,n,r){var o=e.updateQueue;li=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var c=l,u=c.next;c.next=null,null===s?a=u:s.next=u,s=c;var d=e.alternate;if(null!==d){var p=(d=d.updateQueue).lastBaseUpdate;p!==s&&(null===p?d.firstBaseUpdate=u:p.next=u,d.lastBaseUpdate=c)}}if(null!==a){for(p=o.baseState,s=0,d=u=c=null;;){l=a.lane;var f=a.eventTime;if((r&l)===l){null!==d&&(d=d.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var h=e,g=a;switch(l=t,f=n,g.tag){case 1:if("function"==typeof(h=g.payload)){p=h.call(f,p,l);break e}p=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null==(l="function"==typeof(h=g.payload)?h.call(f,p,l):h))break e;p=i({},p,l);break e;case 2:li=!0}}null!==a.callback&&(e.flags|=32,null===(l=o.effects)?o.effects=[a]:l.push(a))}else f={eventTime:f,lane:l,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(u=d=f,c=p):d=d.next=f,s|=l;if(null===(a=a.next)){if(null===(l=o.shared.pending))break;a=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===d&&(c=p),o.baseState=c,o.firstBaseUpdate=u,o.lastBaseUpdate=d,Gs|=s,e.lanes=s,e.memoizedState=p}}function gi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(s(191,o));o.call(r)}}}var mi=(new o.Component).refs;function yi(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var vi={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=fl(),o=hl(e),i=di(r,o);i.payload=t,null!=n&&(i.callback=n),pi(e,i),gl(e,o,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=fl(),o=hl(e),i=di(r,o);i.tag=1,i.payload=t,null!=n&&(i.callback=n),pi(e,i),gl(e,o,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=fl(),r=hl(e),o=di(n,r);o.tag=2,null!=t&&(o.callback=t),pi(e,o),gl(e,r,n)}};function Si(e,t,n,r,o,i,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!pr(n,r)||!pr(o,i))}function Ci(e,t,n){var r=!1,o=fo,i=t.contextType;return"object"==typeof i&&null!==i?i=si(i):(o=vo(t)?mo:ho.current,i=(r=null!=(r=t.contextTypes))?yo(e,o):fo),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=vi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function bi(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vi.enqueueReplaceState(t,t.state,null)}function Ei(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=mi,ci(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=si(i):(i=vo(t)?mo:ho.current,o.context=yo(e,i)),hi(e,n,o,r),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(yi(e,t,i,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&vi.enqueueReplaceState(o,o.state,null),hi(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4)}var Ti=Array.isArray;function wi(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===mi&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Ii(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Pi(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Yl(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function a(t){return e&&null===t.alternate&&(t.flags=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Kl(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=o(t,n.props)).ref=wi(e,t,n),r.return=e,r):((r=Ql(n.type,n.key,n.props,null,e.mode,r)).ref=wi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Zl(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Jl(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Kl(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case T:return(n=Ql(t.type,t.key,t.props,null,e.mode,n)).ref=wi(e,null,t),n.return=e,n;case w:return(t=Zl(t,e.mode,n)).return=e,t}if(Ti(t)||V(t))return(t=Jl(t,e.mode,n,null)).return=e,t;Ii(e,t)}return null}function f(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==o?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case T:return n.key===o?n.type===I?d(e,t,n.props.children,r,o):c(e,t,n,r):null;case w:return n.key===o?u(e,t,n,r):null}if(Ti(n)||V(n))return null!==o?null:d(e,t,n,r,null);Ii(e,n)}return null}function h(e,t,n,r,o){if("string"==typeof r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case T:return e=e.get(null===r.key?n:r.key)||null,r.type===I?d(t,e,r.props.children,o,r.key):c(t,e,r,o);case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o)}if(Ti(r)||V(r))return d(t,e=e.get(n)||null,r,o,null);Ii(t,r)}return null}function g(o,a,s,l){for(var c=null,u=null,d=a,g=a=0,m=null;null!==d&&g<s.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=f(o,d,s[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(o,d),a=i(y,a,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===s.length)return n(o,d),c;if(null===d){for(;g<s.length;g++)null!==(d=p(o,s[g],l))&&(a=i(d,a,g),null===u?c=d:u.sibling=d,u=d);return c}for(d=r(o,d);g<s.length;g++)null!==(m=h(d,o,g,s[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),a=i(m,a,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(o,e)})),c}function m(o,a,l,c){var u=V(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var S=f(o,g,v.value,c);if(null===S){null===g&&(g=y);break}e&&g&&null===S.alternate&&t(o,g),a=i(S,a,m),null===d?u=S:d.sibling=S,d=S,g=y}if(v.done)return n(o,g),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=p(o,v.value,c))&&(a=i(v,a,m),null===d?u=v:d.sibling=v,d=v);return u}for(g=r(o,g);!v.done;m++,v=l.next())null!==(v=h(g,o,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=i(v,a,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(o,e)})),u}return function(e,r,i,l){var c="object"==typeof i&&null!==i&&i.type===I&&null===i.key;c&&(i=i.props.children);var u="object"==typeof i&&null!==i;if(u)switch(i.$$typeof){case T:e:{for(u=i.key,c=r;null!==c;){if(c.key===u){if(7===c.tag){if(i.type===I){n(e,c.sibling),(r=o(c,i.props.children)).return=e,e=r;break e}}else if(c.elementType===i.type){n(e,c.sibling),(r=o(c,i.props)).ref=wi(e,c,i),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}i.type===I?((r=Jl(i.props.children,e.mode,l,i.key)).return=e,e=r):((l=Ql(i.type,i.key,i.props,null,e.mode,l)).ref=wi(e,r,i),l.return=e,e=l)}return a(e);case w:e:{for(c=i.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=o(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Zl(i,e.mode,l)).return=e,e=r}return a(e)}if("string"==typeof i||"number"==typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=o(r,i)).return=e,e=r):(n(e,r),(r=Kl(i,e.mode,l)).return=e,e=r),a(e);if(Ti(i))return g(e,r,i,l);if(V(i))return m(e,r,i,l);if(u&&Ii(e,i),void 0===i&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,Q(e.type)||"Component"))}return n(e,r)}}var _i=Pi(!0),Ai=Pi(!1),ki={},xi=co(ki),Ni=co(ki),Oi=co(ki);function Di(e){if(e===ki)throw Error(s(174));return e}function Li(e,t){switch(po(Oi,t),po(Ni,e),po(xi,ki),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:he(null,"");break;default:t=he(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}uo(xi),po(xi,t)}function Ri(){uo(xi),uo(Ni),uo(Oi)}function Fi(e){Di(Oi.current);var t=Di(xi.current),n=he(t,e.type);t!==n&&(po(Ni,e),po(xi,n))}function Mi(e){Ni.current===e&&(uo(xi),uo(Ni))}var Bi=co(0);function Ui(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var zi=null,Hi=null,Gi=!1;function Vi(e,t){var n=ql(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function ji(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function qi(e){if(Gi){var t=Hi;if(t){var n=t;if(!ji(e,t)){if(!(t=Qr(n.nextSibling))||!ji(e,t))return e.flags=-1025&e.flags|2,Gi=!1,void(zi=e);Vi(zi,n)}zi=e,Hi=Qr(t.firstChild)}else e.flags=-1025&e.flags|2,Gi=!1,zi=e}}function Wi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;zi=e}function Yi(e){if(e!==zi)return!1;if(!Gi)return Wi(e),Gi=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!jr(t,e.memoizedProps))for(t=Hi;t;)Vi(e,t),t=Qr(t.nextSibling);if(Wi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Hi=Qr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Hi=null}}else Hi=zi?Qr(e.stateNode.nextSibling):null;return!0}function Qi(){Hi=zi=null,Gi=!1}var Ji=[];function Xi(){for(var e=0;e<Ji.length;e++)Ji[e]._workInProgressVersionPrimary=null;Ji.length=0}var Ki=E.ReactCurrentDispatcher,Zi=E.ReactCurrentBatchConfig,$i=0,ea=null,ta=null,na=null,ra=!1,oa=!1;function ia(){throw Error(s(321))}function aa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function sa(e,t,n,r,o,i){if($i=i,ea=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ki.current=null===e||null===e.memoizedState?Da:La,e=n(r,o),oa){i=0;do{if(oa=!1,!(25>i))throw Error(s(301));i+=1,na=ta=null,t.updateQueue=null,Ki.current=Ra,e=n(r,o)}while(oa)}if(Ki.current=Oa,t=null!==ta&&null!==ta.next,$i=0,na=ta=ea=null,ra=!1,t)throw Error(s(300));return e}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===na?ea.memoizedState=na=e:na=na.next=e,na}function ca(){if(null===ta){var e=ea.alternate;e=null!==e?e.memoizedState:null}else e=ta.next;var t=null===na?ea.memoizedState:na.next;if(null!==t)na=t,ta=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ta=e).memoizedState,baseState:ta.baseState,baseQueue:ta.baseQueue,queue:ta.queue,next:null},null===na?ea.memoizedState=na=e:na=na.next=e}return na}function ua(e,t){return"function"==typeof t?t(e):t}function da(e){var t=ca(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ta,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(null!==o){o=o.next,r=r.baseState;var l=a=i=null,c=o;do{var u=c.lane;if(($i&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(a=l=d,i=r):l=l.next=d,ea.lanes|=u,Gs|=u}c=c.next}while(null!==c&&c!==o);null===l?i=r:l.next=a,ur(r,t.memoizedState)||(Ma=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function pa(e){var t=ca(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{i=e(i,a.action),a=a.next}while(a!==o);ur(i,t.memoizedState)||(Ma=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function fa(e,t,n){var r=t._getVersion;r=r(t._source);var o=t._workInProgressVersionPrimary;if(null!==o?e=o===r:(e=e.mutableReadLanes,(e=($i&e)===e)&&(t._workInProgressVersionPrimary=r,Ji.push(t))),e)return n(t._source);throw Ji.push(t),Error(s(350))}function ha(e,t,n,r){var o=Ls;if(null===o)throw Error(s(349));var i=t._getVersion,a=i(t._source),l=Ki.current,c=l.useState((function(){return fa(o,t,n)})),u=c[1],d=c[0];c=na;var p=e.memoizedState,f=p.refs,h=f.getSnapshot,g=p.source;p=p.subscribe;var m=ea;return e.memoizedState={refs:f,source:t,subscribe:r},l.useEffect((function(){f.getSnapshot=n,f.setSnapshot=u;var e=i(t._source);if(!ur(a,e)){e=n(t._source),ur(d,e)||(u(e),e=hl(m),o.mutableReadLanes|=e&o.pendingLanes),e=o.mutableReadLanes,o.entangledLanes|=e;for(var r=o.entanglements,s=e;0<s;){var l=31-jt(s),c=1<<l;r[l]|=e,s&=~c}}}),[n,t,r]),l.useEffect((function(){return r(t._source,(function(){var e=f.getSnapshot,n=f.setSnapshot;try{n(e(t._source));var r=hl(m);o.mutableReadLanes|=r&o.pendingLanes}catch(e){n((function(){throw e}))}}))}),[t,r]),ur(h,n)&&ur(g,t)&&ur(p,r)||((e={pending:null,dispatch:null,lastRenderedReducer:ua,lastRenderedState:d}).dispatch=u=Na.bind(null,ea,e),c.queue=e,c.baseQueue=null,d=fa(o,t,n),c.memoizedState=c.baseState=d),d}function ga(e,t,n){return ha(ca(),e,t,n)}function ma(e){var t=la();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ua,lastRenderedState:e}).dispatch=Na.bind(null,ea,e),[t.memoizedState,e]}function ya(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ea.updateQueue)?(t={lastEffect:null},ea.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function va(e){return e={current:e},la().memoizedState=e}function Sa(){return ca().memoizedState}function Ca(e,t,n,r){var o=la();ea.flags|=e,o.memoizedState=ya(1|t,n,void 0,void 0===r?null:r)}function ba(e,t,n,r){var o=ca();r=void 0===r?null:r;var i=void 0;if(null!==ta){var a=ta.memoizedState;if(i=a.destroy,null!==r&&aa(r,a.deps))return void ya(t,n,i,r)}ea.flags|=e,o.memoizedState=ya(1|t,n,i,r)}function Ea(e,t){return Ca(516,4,e,t)}function Ta(e,t){return ba(516,4,e,t)}function wa(e,t){return ba(4,2,e,t)}function Ia(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Pa(e,t,n){return n=null!=n?n.concat([e]):null,ba(4,2,Ia.bind(null,t,e),n)}function _a(){}function Aa(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&aa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ka(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&aa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function xa(e,t){var n=qo();Yo(98>n?98:n,(function(){e(!0)})),Yo(97<n?97:n,(function(){var n=Zi.transition;Zi.transition=1;try{e(!1),t()}finally{Zi.transition=n}}))}function Na(e,t,n){var r=fl(),o=hl(e),i={lane:o,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?i.next=i:(i.next=a.next,a.next=i),t.pending=i,a=e.alternate,e===ea||null!==a&&a===ea)oa=ra=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=a(s,n);if(i.eagerReducer=a,i.eagerState=l,ur(l,s))return}catch(e){}gl(e,o,r)}}var Oa={readContext:si,useCallback:ia,useContext:ia,useEffect:ia,useImperativeHandle:ia,useLayoutEffect:ia,useMemo:ia,useReducer:ia,useRef:ia,useState:ia,useDebugValue:ia,useDeferredValue:ia,useTransition:ia,useMutableSource:ia,useOpaqueIdentifier:ia,unstable_isNewReconciler:!1},Da={readContext:si,useCallback:function(e,t){return la().memoizedState=[e,void 0===t?null:t],e},useContext:si,useEffect:Ea,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Ca(4,2,Ia.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ca(4,2,e,t)},useMemo:function(e,t){var n=la();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=la();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Na.bind(null,ea,e),[r.memoizedState,e]},useRef:va,useState:ma,useDebugValue:_a,useDeferredValue:function(e){var t=ma(e),n=t[0],r=t[1];return Ea((function(){var t=Zi.transition;Zi.transition=1;try{r(e)}finally{Zi.transition=t}}),[e]),n},useTransition:function(){var e=ma(!1),t=e[0];return va(e=xa.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=la();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},ha(r,e,t,n)},useOpaqueIdentifier:function(){if(Gi){var e=!1,t=function(e){return{$$typeof:F,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Xr++).toString(36))),Error(s(355))})),n=ma(t)[1];return!(2&ea.mode)&&(ea.flags|=516,ya(5,(function(){n("r:"+(Xr++).toString(36))}),void 0,null)),t}return ma(t="r:"+(Xr++).toString(36)),t},unstable_isNewReconciler:!1},La={readContext:si,useCallback:Aa,useContext:si,useEffect:Ta,useImperativeHandle:Pa,useLayoutEffect:wa,useMemo:ka,useReducer:da,useRef:Sa,useState:function(){return da(ua)},useDebugValue:_a,useDeferredValue:function(e){var t=da(ua),n=t[0],r=t[1];return Ta((function(){var t=Zi.transition;Zi.transition=1;try{r(e)}finally{Zi.transition=t}}),[e]),n},useTransition:function(){var e=da(ua)[0];return[Sa().current,e]},useMutableSource:ga,useOpaqueIdentifier:function(){return da(ua)[0]},unstable_isNewReconciler:!1},Ra={readContext:si,useCallback:Aa,useContext:si,useEffect:Ta,useImperativeHandle:Pa,useLayoutEffect:wa,useMemo:ka,useReducer:pa,useRef:Sa,useState:function(){return pa(ua)},useDebugValue:_a,useDeferredValue:function(e){var t=pa(ua),n=t[0],r=t[1];return Ta((function(){var t=Zi.transition;Zi.transition=1;try{r(e)}finally{Zi.transition=t}}),[e]),n},useTransition:function(){var e=pa(ua)[0];return[Sa().current,e]},useMutableSource:ga,useOpaqueIdentifier:function(){return pa(ua)[0]},unstable_isNewReconciler:!1},Fa=E.ReactCurrentOwner,Ma=!1;function Ba(e,t,n,r){t.child=null===e?Ai(t,null,n,r):_i(t,e.child,n,r)}function Ua(e,t,n,r,o){n=n.render;var i=t.ref;return ai(t,o),r=sa(e,t,n,r,i,o),null===e||Ma?(t.flags|=1,Ba(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,as(e,t,o))}function za(e,t,n,r,o,i){if(null===e){var a=n.type;return"function"!=typeof a||Wl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ql(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ha(e,t,a,r,o,i))}return a=e.child,o&i||(o=a.memoizedProps,!(n=null!==(n=n.compare)?n:pr)(o,r)||e.ref!==t.ref)?(t.flags|=1,(e=Yl(a,r)).ref=t.ref,e.return=t,t.child=e):as(e,t,i)}function Ha(e,t,n,r,o,i){if(null!==e&&pr(e.memoizedProps,r)&&e.ref===t.ref){if(Ma=!1,!(i&o))return t.lanes=e.lanes,as(e,t,i);16384&e.flags&&(Ma=!0)}return ja(e,t,n,r,i)}function Ga(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(4&t.mode){if(!(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Tl(t,e),null;t.memoizedState={baseLanes:0},Tl(t,null!==i?i.baseLanes:n)}else t.memoizedState={baseLanes:0},Tl(t,n);else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Tl(t,r);return Ba(e,t,o,n),t.child}function Va(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function ja(e,t,n,r,o){var i=vo(n)?mo:ho.current;return i=yo(t,i),ai(t,o),n=sa(e,t,n,r,i,o),null===e||Ma?(t.flags|=1,Ba(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,as(e,t,o))}function qa(e,t,n,r,o){if(vo(n)){var i=!0;Eo(t)}else i=!1;if(ai(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Ci(t,n,r),Ei(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;"object"==typeof c&&null!==c?c=si(c):c=yo(t,c=vo(n)?mo:ho.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==c)&&bi(t,a,r,c),li=!1;var p=t.memoizedState;a.state=p,hi(t,r,a,o),l=t.memoizedState,s!==r||p!==l||go.current||li?("function"==typeof u&&(yi(t,n,u,r),l=t.memoizedState),(s=li||Si(t,n,s,r,p,l,c))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4)):("function"==typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4),r=!1)}else{a=t.stateNode,ui(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Zo(t.type,s),a.props=c,d=t.pendingProps,p=a.context,"object"==typeof(l=n.contextType)&&null!==l?l=si(l):l=yo(t,l=vo(n)?mo:ho.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||p!==l)&&bi(t,a,r,l),li=!1,p=t.memoizedState,a.state=p,hi(t,r,a,o);var h=t.memoizedState;s!==d||p!==h||go.current||li?("function"==typeof f&&(yi(t,n,f,r),h=t.memoizedState),(c=li||Si(t,n,c,r,p,h,l))?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,h,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,h,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=h),a.props=r,a.state=h,a.context=l,r=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),r=!1)}return Wa(e,t,n,r,i,o)}function Wa(e,t,n,r,o,i){Va(e,t);var a=!!(64&t.flags);if(!r&&!a)return o&&To(t,n,!1),as(e,t,i);r=t.stateNode,Fa.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=_i(t,e.child,null,i),t.child=_i(t,null,s,i)):Ba(e,t,s,i),t.memoizedState=r.state,o&&To(t,n,!0),t.child}function Ya(e){var t=e.stateNode;t.pendingContext?Co(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Co(0,t.context,!1),Li(e,t.containerInfo)}var Qa,Ja,Xa,Ka,Za={dehydrated:null,retryLane:0};function $a(e,t,n){var r,o=t.pendingProps,i=Bi.current,a=!1;return(r=!!(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&!!(2&i)),r?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(i|=1),po(Bi,1&i),null===e?(void 0!==o.fallback&&qi(t),e=o.children,i=o.fallback,a?(e=es(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Za,e):"number"==typeof o.unstable_expectedLoadTime?(e=es(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Za,t.lanes=33554432,e):((n=Xl({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(o=ns(e,t,o.children,o.fallback,n),a=t.child,i=e.child.memoizedState,a.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=Za,o):(n=ts(e,t,o.children,n),t.memoizedState=null,n))}function es(e,t,n,r){var o=e.mode,i=e.child;return t={mode:"hidden",children:t},2&o||null===i?i=Xl(t,o,0,null):(i.childLanes=0,i.pendingProps=t),n=Jl(n,o,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function ts(e,t,n,r){var o=e.child;return e=o.sibling,n=Yl(o,{mode:"visible",children:n}),!(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function ns(e,t,n,r,o){var i=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 2&i||t.child===a?n=Yl(a,s):((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null),null!==e?r=Yl(e,r):(r=Jl(r,i,o,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function rs(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ii(e.return,t)}function os(e,t,n,r,o,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o,lastEffect:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o,a.lastEffect=i)}function is(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Ba(e,t,r.children,n),2&(r=Bi.current))r=1&r|2,t.flags|=64;else{if(null!==e&&64&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&rs(e,n);else if(19===e.tag)rs(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(po(Bi,r),2&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===Ui(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),os(t,!1,o,n,i,t.lastEffect);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Ui(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}os(t,!0,n,null,i,t.lastEffect);break;case"together":os(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function as(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Gs|=t.lanes,n&t.childLanes){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Yl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Yl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function ss(e,t){if(!Gi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ls(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return vo(t.type)&&So(),null;case 3:return Ri(),uo(go),uo(ho),Xi(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Yi(t)?t.flags|=4:r.hydrate||(t.flags|=256)),Ja(t),null;case 5:Mi(t);var o=Di(Oi.current);if(n=t.type,null!==e&&null!=t.stateNode)Xa(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Di(xi.current),Yi(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Zr]=t,r[$r]=a,n){case"dialog":xr("cancel",r),xr("close",r);break;case"iframe":case"object":case"embed":xr("load",r);break;case"video":case"audio":for(e=0;e<Pr.length;e++)xr(Pr[e],r);break;case"source":xr("error",r);break;case"img":case"image":case"link":xr("error",r),xr("load",r);break;case"details":xr("toggle",r);break;case"input":te(r,a),xr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},xr("invalid",r);break;case"textarea":ce(r,a),xr("invalid",r)}for(var l in we(n,a),e=null,a)a.hasOwnProperty(l)&&(o=a[l],"children"===l?"string"==typeof o?r.textContent!==o&&(e=["children",o]):"number"==typeof o&&r.textContent!==""+o&&(e=["children",""+o]):c.hasOwnProperty(l)&&null!=o&&"onScroll"===l&&xr("scroll",r));switch(n){case"input":K(r),oe(r,a,!0);break;case"textarea":K(r),de(r);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(r.onclick=zr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(l=9===o.nodeType?o:o.ownerDocument,e===pe.html&&(e=fe(n)),e===pe.html?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Zr]=t,e[$r]=r,Qa(e,t,!1,!1),t.stateNode=e,l=Ie(n,r),n){case"dialog":xr("cancel",e),xr("close",e),o=r;break;case"iframe":case"object":case"embed":xr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Pr.length;o++)xr(Pr[o],e);o=r;break;case"source":xr("error",e),o=r;break;case"img":case"image":case"link":xr("error",e),xr("load",e),o=r;break;case"details":xr("toggle",e),o=r;break;case"input":te(e,r),o=ee(e,r),xr("invalid",e);break;case"option":o=ae(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=i({},r,{value:void 0}),xr("invalid",e);break;case"textarea":ce(e,r),o=le(e,r),xr("invalid",e);break;default:o=r}we(n,o);var u=o;for(a in u)if(u.hasOwnProperty(a)){var d=u[a];"style"===a?Ee(e,d):"dangerouslySetInnerHTML"===a?null!=(d=d?d.__html:void 0)&&ye(e,d):"children"===a?"string"==typeof d?("textarea"!==n||""!==d)&&ve(e,d):"number"==typeof d&&ve(e,""+d):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(c.hasOwnProperty(a)?null!=d&&"onScroll"===a&&xr("scroll",e):null!=d&&b(e,a,d,l))}switch(n){case"input":K(e),oe(e,r,!1);break;case"textarea":K(e),de(e);break;case"option":null!=r.value&&e.setAttribute("value",""+J(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?se(e,!!r.multiple,a,!1):null!=r.defaultValue&&se(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=zr)}Vr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Ka(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));n=Di(Oi.current),Di(xi.current),Yi(t)?(r=t.stateNode,n=t.memoizedProps,r[Zr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Zr]=t,t.stateNode=r)}return null;case 13:return uo(Bi),r=t.memoizedState,64&t.flags?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&Yi(t):n=null!==e.memoizedState,r&&!n&&2&t.mode&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||1&Bi.current?0===Us&&(Us=3):(0!==Us&&3!==Us||(Us=4),null===Ls||!(134217727&Gs)&&!(134217727&Vs)||Sl(Ls,Fs))),(r||n)&&(t.flags|=4),null);case 4:return Ri(),Ja(t),null===e&&Or(t.stateNode.containerInfo),null;case 10:return oi(t),null;case 19:if(uo(Bi),null===(r=t.memoizedState))return null;if(a=!!(64&t.flags),null===(l=r.rendering))if(a)ss(r,!1);else{if(0!==Us||null!==e&&64&e.flags)for(e=t.child;null!==e;){if(null!==(l=Ui(e))){for(t.flags|=64,ss(r,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return po(Bi,1&Bi.current|2),t.child}e=e.sibling}null!==r.tail&&jo()>Ys&&(t.flags|=64,a=!0,ss(r,!1),t.lanes=33554432)}else{if(!a)if(null!==(e=Ui(l))){if(t.flags|=64,a=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ss(r,!0),null===r.tail&&"hidden"===r.tailMode&&!l.alternate&&!Gi)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*jo()-r.renderingStartTime>Ys&&1073741824!==n&&(t.flags|=64,a=!0,ss(r,!1),t.lanes=33554432);r.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=r.last)?n.sibling=l:t.child=l,r.last=l)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=jo(),n.sibling=null,t=Bi.current,po(Bi,a?1&t|2:1&t),n):null;case 23:case 24:return wl(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function cs(e){switch(e.tag){case 1:vo(e.type)&&So();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Ri(),uo(go),uo(ho),Xi(),64&(t=e.flags))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return Mi(e),null;case 13:return uo(Bi),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return uo(Bi),null;case 4:return Ri(),null;case 10:return oi(e),null;case 23:case 24:return wl(),null;default:return null}}function us(e,t){try{var n="",r=t;do{n+=Y(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o}}function ds(e,t){try{r.error(t.value)}catch(e){setTimeout((function(){throw e}))}}Qa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ja=function(){},Xa=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Di(xi.current);var a,s=null;switch(n){case"input":o=ee(e,o),r=ee(e,r),s=[];break;case"option":o=ae(e,o),r=ae(e,r),s=[];break;case"select":o=i({},o,{value:void 0}),r=i({},r,{value:void 0}),s=[];break;case"textarea":o=le(e,o),r=le(e,r),s=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=zr)}for(d in we(n,r),n=null,o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var l=o[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(c.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var u=r[d];if(l=null!=o?o[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(null!=u||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(s||(s=[]),s.push(d,n)),n=u;else"dangerouslySetInnerHTML"===d?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(s=s||[]).push(d,u)):"children"===d?"string"!=typeof u&&"number"!=typeof u||(s=s||[]).push(d,""+u):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(c.hasOwnProperty(d)?(null!=u&&"onScroll"===d&&xr("scroll",e),s||l===u||(s=[])):"object"==typeof u&&null!==u&&u.$$typeof===F?u.toString():(s=s||[]).push(d,u))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Ka=function(e,t,n,r){n!==r&&(t.flags|=4)};var ps="function"==typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ks||(Ks=!0,Zs=r),ds(0,t)},n}function hs(e,t,n){(n=di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return ds(0,t),r(o)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===$s?$s=new Set([this]):$s.add(this),ds(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var gs="function"==typeof WeakSet?WeakSet:Set;function ms(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Hl(e,t)}else t.current=null}function ys(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Zo(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Yr(t.stateNode.containerInfo))}throw Error(s(163))}function vs(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(!(3&~e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var o=e;r=o.next,4&(o=o.tag)&&1&o&&(Bl(n,e),Ml(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Zo(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&gi(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}gi(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Vr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Et(n)))))}throw Error(s(163))}function Ss(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var o=n.memoizedProps.style;o=null!=o&&o.hasOwnProperty("display")?o.display:null,r.style.display=be("display",o)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Cs(e,t){if(Io&&"function"==typeof Io.onCommitFiberUnmount)try{Io.onCommitFiberUnmount(wo,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,o=r.destroy;if(r=r.tag,void 0!==o)if(4&r)Bl(t,n);else{r=t;try{o()}catch(e){Hl(r,e)}}n=n.next}while(n!==e)}break;case 1:if(ms(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Hl(t,e)}break;case 5:ms(t);break;case 4:Ps(e,t)}}function bs(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Es(e){return 5===e.tag||3===e.tag||4===e.tag}function Ts(e){e:{for(var t=e.return;null!==t;){if(Es(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(ve(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Es(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?ws(e,n,t):Is(e,n,t)}function ws(e,t,n){var r=e.tag,o=5===r||6===r;if(o)e=o?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=zr));else if(4!==r&&null!==(e=e.child))for(ws(e,t,n),e=e.sibling;null!==e;)ws(e,t,n),e=e.sibling}function Is(e,t,n){var r=e.tag,o=5===r||6===r;if(o)e=o?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Is(e,t,n),e=e.sibling;null!==e;)Is(e,t,n),e=e.sibling}function Ps(e,t){for(var n,r,o=t,i=!1;;){if(!i){i=o.return;e:for(;;){if(null===i)throw Error(s(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===o.tag||6===o.tag){e:for(var a=e,l=o,c=l;;)if(Cs(a,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===l)break e;for(;null===c.sibling;){if(null===c.return||c.return===l)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(a=n,l=o.stateNode,8===a.nodeType?a.parentNode.removeChild(l):a.removeChild(l)):n.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){n=o.stateNode.containerInfo,r=!0,o.child.return=o,o=o.child;continue}}else if(Cs(e,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(i=!1)}o.sibling.return=o.return,o=o.sibling}}function _s(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{!(3&~r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var o=null!==e?e.memoizedProps:r;e=t.type;var i=t.updateQueue;if(t.updateQueue=null,null!==i){for(n[$r]=r,"input"===e&&"radio"===r.type&&null!=r.name&&ne(n,r),Ie(e,o),t=Ie(e,r),o=0;o<i.length;o+=2){var a=i[o],l=i[o+1];"style"===a?Ee(n,l):"dangerouslySetInnerHTML"===a?ye(n,l):"children"===a?ve(n,l):b(n,a,l,t)}switch(e){case"input":re(n,r);break;case"textarea":ue(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(i=r.value)?se(n,!!r.multiple,i,!1):e!==!!r.multiple&&(null!=r.defaultValue?se(n,!!r.multiple,r.defaultValue,!0):se(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,Et(n.containerInfo)));case 13:return null!==t.memoizedState&&(Ws=jo(),Ss(t.child,!0)),void As(t);case 19:return void As(t);case 23:case 24:return void Ss(t,null!==t.memoizedState)}throw Error(s(163))}function As(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new gs),t.forEach((function(t){var r=Vl.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ks(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var xs=Math.ceil,Ns=E.ReactCurrentDispatcher,Os=E.ReactCurrentOwner,Ds=0,Ls=null,Rs=null,Fs=0,Ms=0,Bs=co(0),Us=0,zs=null,Hs=0,Gs=0,Vs=0,js=0,qs=null,Ws=0,Ys=1/0;function Qs(){Ys=jo()+500}var Js,Xs=null,Ks=!1,Zs=null,$s=null,el=!1,tl=null,nl=90,rl=[],ol=[],il=null,al=0,sl=null,ll=-1,cl=0,ul=0,dl=null,pl=!1;function fl(){return 48&Ds?jo():-1!==ll?ll:ll=jo()}function hl(e){if(!(2&(e=e.mode)))return 1;if(!(4&e))return 99===qo()?1:2;if(0===cl&&(cl=Hs),0!==Ko.transition){0!==ul&&(ul=null!==qs?qs.pendingLanes:0),e=cl;var t=4186112&~ul;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=qo(),4&Ds&&98===e?e=zt(12,cl):e=zt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),cl),e}function gl(e,t,n){if(50<al)throw al=0,sl=null,Error(s(185));if(null===(e=ml(e,t)))return null;Vt(e,t,n),e===Ls&&(Vs|=t,4===Us&&Sl(e,Fs));var r=qo();1===t?8&Ds&&!(48&Ds)?Cl(e):(yl(e,n),0===Ds&&(Qs(),Jo())):(!(4&Ds)||98!==r&&99!==r||(null===il?il=new Set([e]):il.add(e)),yl(e,n)),qs=e}function ml(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function yl(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,o=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var l=31-jt(a),c=1<<l,u=i[l];if(-1===u){if(!(c&r)||c&o){u=t,Mt(c);var d=Ft;i[l]=10<=d?u+250:6<=d?u+5e3:-1}}else u<=t&&(e.expiredLanes|=c);a&=~c}if(r=Bt(e,e===Ls?Fs:0),t=Ft,0===r)null!==n&&(n!==Bo&&Ao(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Bo&&Ao(n)}15===t?(n=Cl.bind(null,e),null===zo?(zo=[n],Ho=_o(Do,Xo)):zo.push(n),n=Bo):14===t?n=Qo(99,Cl.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),n=Qo(n,vl.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function vl(e){if(ll=-1,ul=cl=0,48&Ds)throw Error(s(327));var t=e.callbackNode;if(Fl()&&e.callbackNode!==t)return null;var n=Bt(e,e===Ls?Fs:0);if(0===n)return null;var r=n,o=Ds;Ds|=16;var i=_l();for(Ls===e&&Fs===r||(Qs(),Il(e,r));;)try{xl();break}catch(t){Pl(e,t)}if(ri(),Ns.current=i,Ds=o,null!==Rs?r=0:(Ls=null,Fs=0,r=Us),Hs&Vs)Il(e,0);else if(0!==r){if(2===r&&(Ds|=64,e.hydrate&&(e.hydrate=!1,Yr(e.containerInfo)),0!==(n=Ut(e))&&(r=Al(e,n))),1===r)throw t=zs,Il(e,0),Sl(e,n),yl(e,jo()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:case 5:Dl(e);break;case 3:if(Sl(e,n),(62914560&n)===n&&10<(r=Ws+500-jo())){if(0!==Bt(e,0))break;if(((o=e.suspendedLanes)&n)!==n){fl(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=qr(Dl.bind(null,e),r);break}Dl(e);break;case 4:if(Sl(e,n),(4186112&n)===n)break;for(r=e.eventTimes,o=-1;0<n;){var a=31-jt(n);i=1<<a,(a=r[a])>o&&(o=a),n&=~i}if(n=o,10<(n=(120>(n=jo()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xs(n/1960))-n)){e.timeoutHandle=qr(Dl.bind(null,e),n);break}Dl(e);break;default:throw Error(s(329))}}return yl(e,jo()),e.callbackNode===t?vl.bind(null,e):null}function Sl(e,t){for(t&=~js,t&=~Vs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jt(t),r=1<<n;e[n]=-1,t&=~r}}function Cl(e){if(48&Ds)throw Error(s(327));if(Fl(),e===Ls&&e.expiredLanes&Fs){var t=Fs,n=Al(e,t);Hs&Vs&&(n=Al(e,t=Bt(e,t)))}else n=Al(e,t=Bt(e,0));if(0!==e.tag&&2===n&&(Ds|=64,e.hydrate&&(e.hydrate=!1,Yr(e.containerInfo)),0!==(t=Ut(e))&&(n=Al(e,t))),1===n)throw n=zs,Il(e,0),Sl(e,t),yl(e,jo()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dl(e),yl(e,jo()),null}function bl(e,t){var n=Ds;Ds|=1;try{return e(t)}finally{0===(Ds=n)&&(Qs(),Jo())}}function El(e,t){var n=Ds;Ds&=-2,Ds|=8;try{return e(t)}finally{0===(Ds=n)&&(Qs(),Jo())}}function Tl(e,t){po(Bs,Ms),Ms|=t,Hs|=t}function wl(){Ms=Bs.current,uo(Bs)}function Il(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Wr(n)),null!==Rs)for(n=Rs.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&So();break;case 3:Ri(),uo(go),uo(ho),Xi();break;case 5:Mi(r);break;case 4:Ri();break;case 13:case 19:uo(Bi);break;case 10:oi(r);break;case 23:case 24:wl()}n=n.return}Ls=e,Rs=Yl(e.current,null),Fs=Ms=Hs=t,Us=0,zs=null,js=Vs=Gs=0}function Pl(e,t){for(;;){var n=Rs;try{if(ri(),Ki.current=Oa,ra){for(var r=ea.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ra=!1}if($i=0,na=ta=ea=null,oa=!1,Os.current=null,null===n||null===n.return){Us=1,zs=t,Rs=null;break}e:{var i=e,a=n.return,s=n,l=t;if(t=Fs,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l;if(!(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.lanes=u.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=!!(1&Bi.current),p=a;do{var f;if(f=13===p.tag){var h=p.memoizedState;if(null!==h)f=null!==h.dehydrated;else{var g=p.memoizedProps;f=void 0!==g.fallback&&(!0!==g.unstable_avoidThisFallback||!d)}}if(f){var m=p.updateQueue;if(null===m){var y=new Set;y.add(c),p.updateQueue=y}else m.add(c);if(!(2&p.mode)){if(p.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var v=di(-1,1);v.tag=2,pi(s,v)}s.lanes|=1;break e}l=void 0,s=t;var S=i.pingCache;if(null===S?(S=i.pingCache=new ps,l=new Set,S.set(c,l)):void 0===(l=S.get(c))&&(l=new Set,S.set(c,l)),!l.has(s)){l.add(s);var C=Gl.bind(null,i,c,s);c.then(C,C)}p.flags|=4096,p.lanes=t;break e}p=p.return}while(null!==p);l=Error((Q(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Us&&(Us=2),l=us(l,s),p=a;do{switch(p.tag){case 3:i=l,p.flags|=4096,t&=-t,p.lanes|=t,fi(p,fs(0,i,t));break e;case 1:i=l;var b=p.type,E=p.stateNode;if(!(64&p.flags||"function"!=typeof b.getDerivedStateFromError&&(null===E||"function"!=typeof E.componentDidCatch||null!==$s&&$s.has(E)))){p.flags|=4096,t&=-t,p.lanes|=t,fi(p,hs(p,i,t));break e}}p=p.return}while(null!==p)}Ol(n)}catch(e){t=e,Rs===n&&null!==n&&(Rs=n=n.return);continue}break}}function _l(){var e=Ns.current;return Ns.current=Oa,null===e?Oa:e}function Al(e,t){var n=Ds;Ds|=16;var r=_l();for(Ls===e&&Fs===t||Il(e,t);;)try{kl();break}catch(t){Pl(e,t)}if(ri(),Ds=n,Ns.current=r,null!==Rs)throw Error(s(261));return Ls=null,Fs=0,Us}function kl(){for(;null!==Rs;)Nl(Rs)}function xl(){for(;null!==Rs&&!ko();)Nl(Rs)}function Nl(e){var t=Js(e.alternate,e,Ms);e.memoizedProps=e.pendingProps,null===t?Ol(e):Rs=t,Os.current=null}function Ol(e){var t=e;do{var n=t.alternate;if(e=t.return,2048&t.flags){if(null!==(n=cs(t)))return n.flags&=2047,void(Rs=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(null!==(n=ls(n,t,Ms)))return void(Rs=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||1073741824&Ms||!(4&n.mode)){for(var r=0,o=n.child;null!==o;)r|=o.lanes|o.childLanes,o=o.sibling;n.childLanes=r}null!==e&&!(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(null!==(t=t.sibling))return void(Rs=t);Rs=t=e}while(null!==t);0===Us&&(Us=5)}function Dl(e){var t=qo();return Yo(99,Ll.bind(null,e,t)),null}function Ll(e,t){do{Fl()}while(null!==tl);if(48&Ds)throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,o=r,i=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var a=e.eventTimes,l=e.expirationTimes;0<i;){var c=31-jt(i),u=1<<c;o[c]=0,a[c]=-1,l[c]=-1,i&=~u}if(null!==il&&!(24&r)&&il.has(e)&&il.delete(e),e===Ls&&(Rs=Ls=null,Fs=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(o=Ds,Ds|=32,Os.current=null,Hr=Jt,yr(a=mr())){if("selectionStart"in a)l={start:a.selectionStart,end:a.selectionEnd};else e:if(l=(l=a.ownerDocument)&&l.defaultView||window,(u=l.getSelection&&l.getSelection())&&0!==u.rangeCount){l=u.anchorNode,i=u.anchorOffset,c=u.focusNode,u=u.focusOffset;try{l.nodeType,c.nodeType}catch(e){l=null;break e}var d=0,p=-1,f=-1,h=0,g=0,m=a,y=null;t:for(;;){for(var v;m!==l||0!==i&&3!==m.nodeType||(p=d+i),m!==c||0!==u&&3!==m.nodeType||(f=d+u),3===m.nodeType&&(d+=m.nodeValue.length),null!==(v=m.firstChild);)y=m,m=v;for(;;){if(m===a)break t;if(y===l&&++h===i&&(p=d),y===c&&++g===u&&(f=d),null!==(v=m.nextSibling))break;y=(m=y).parentNode}m=v}l=-1===p||-1===f?null:{start:p,end:f}}else l=null;l=l||{start:0,end:0}}else l=null;Gr={focusedElem:a,selectionRange:l},Jt=!1,dl=null,pl=!1,Xs=r;do{try{Rl()}catch(e){if(null===Xs)throw Error(s(330));Hl(Xs,e),Xs=Xs.nextEffect}}while(null!==Xs);dl=null,Xs=r;do{try{for(a=e;null!==Xs;){var S=Xs.flags;if(16&S&&ve(Xs.stateNode,""),128&S){var C=Xs.alternate;if(null!==C){var b=C.ref;null!==b&&("function"==typeof b?b(null):b.current=null)}}switch(1038&S){case 2:Ts(Xs),Xs.flags&=-3;break;case 6:Ts(Xs),Xs.flags&=-3,_s(Xs.alternate,Xs);break;case 1024:Xs.flags&=-1025;break;case 1028:Xs.flags&=-1025,_s(Xs.alternate,Xs);break;case 4:_s(Xs.alternate,Xs);break;case 8:Ps(a,l=Xs);var E=l.alternate;bs(l),null!==E&&bs(E)}Xs=Xs.nextEffect}}catch(e){if(null===Xs)throw Error(s(330));Hl(Xs,e),Xs=Xs.nextEffect}}while(null!==Xs);if(b=Gr,C=mr(),S=b.focusedElem,a=b.selectionRange,C!==S&&S&&S.ownerDocument&&gr(S.ownerDocument.documentElement,S)){null!==a&&yr(S)&&(C=a.start,void 0===(b=a.end)&&(b=C),"selectionStart"in S?(S.selectionStart=C,S.selectionEnd=Math.min(b,S.value.length)):(b=(C=S.ownerDocument||document)&&C.defaultView||window).getSelection&&(b=b.getSelection(),l=S.textContent.length,E=Math.min(a.start,l),a=void 0===a.end?E:Math.min(a.end,l),!b.extend&&E>a&&(l=a,a=E,E=l),l=hr(S,E),i=hr(S,a),l&&i&&(1!==b.rangeCount||b.anchorNode!==l.node||b.anchorOffset!==l.offset||b.focusNode!==i.node||b.focusOffset!==i.offset)&&((C=C.createRange()).setStart(l.node,l.offset),b.removeAllRanges(),E>a?(b.addRange(C),b.extend(i.node,i.offset)):(C.setEnd(i.node,i.offset),b.addRange(C))))),C=[];for(b=S;b=b.parentNode;)1===b.nodeType&&C.push({element:b,left:b.scrollLeft,top:b.scrollTop});for("function"==typeof S.focus&&S.focus(),S=0;S<C.length;S++)(b=C[S]).element.scrollLeft=b.left,b.element.scrollTop=b.top}Jt=!!Hr,Gr=Hr=null,e.current=n,Xs=r;do{try{for(S=e;null!==Xs;){var T=Xs.flags;if(36&T&&vs(S,Xs.alternate,Xs),128&T){C=void 0;var w=Xs.ref;if(null!==w){var I=Xs.stateNode;Xs.tag,C=I,"function"==typeof w?w(C):w.current=C}}Xs=Xs.nextEffect}}catch(e){if(null===Xs)throw Error(s(330));Hl(Xs,e),Xs=Xs.nextEffect}}while(null!==Xs);Xs=null,Uo(),Ds=o}else e.current=n;if(el)el=!1,tl=e,nl=t;else for(Xs=r;null!==Xs;)t=Xs.nextEffect,Xs.nextEffect=null,8&Xs.flags&&((T=Xs).sibling=null,T.stateNode=null),Xs=t;if(0===(r=e.pendingLanes)&&($s=null),1===r?e===sl?al++:(al=0,sl=e):al=0,n=n.stateNode,Io&&"function"==typeof Io.onCommitFiberRoot)try{Io.onCommitFiberRoot(wo,n,void 0,!(64&~n.current.flags))}catch(e){}if(yl(e,jo()),Ks)throw Ks=!1,e=Zs,Zs=null,e;return 8&Ds||Jo(),null}function Rl(){for(;null!==Xs;){var e=Xs.alternate;pl||null===dl||(8&Xs.flags?et(Xs,dl)&&(pl=!0):13===Xs.tag&&ks(e,Xs)&&et(Xs,dl)&&(pl=!0));var t=Xs.flags;256&t&&ys(e,Xs),!(512&t)||el||(el=!0,Qo(97,(function(){return Fl(),null}))),Xs=Xs.nextEffect}}function Fl(){if(90!==nl){var e=97<nl?97:nl;return nl=90,Yo(e,Ul)}return!1}function Ml(e,t){rl.push(t,e),el||(el=!0,Qo(97,(function(){return Fl(),null})))}function Bl(e,t){ol.push(t,e),el||(el=!0,Qo(97,(function(){return Fl(),null})))}function Ul(){if(null===tl)return!1;var e=tl;if(tl=null,48&Ds)throw Error(s(331));var t=Ds;Ds|=32;var n=ol;ol=[];for(var r=0;r<n.length;r+=2){var o=n[r],i=n[r+1],a=o.destroy;if(o.destroy=void 0,"function"==typeof a)try{a()}catch(e){if(null===i)throw Error(s(330));Hl(i,e)}}for(n=rl,rl=[],r=0;r<n.length;r+=2){o=n[r],i=n[r+1];try{var l=o.create;o.destroy=l()}catch(e){if(null===i)throw Error(s(330));Hl(i,e)}}for(l=e.current.firstEffect;null!==l;)e=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=e;return Ds=t,Jo(),!0}function zl(e,t,n){pi(e,t=fs(0,t=us(n,t),1)),t=fl(),null!==(e=ml(e,1))&&(Vt(e,1,t),yl(e,t))}function Hl(e,t){if(3===e.tag)zl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){zl(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===$s||!$s.has(r))){var o=hs(n,e=us(t,e),1);if(pi(n,o),o=fl(),null!==(n=ml(n,1)))Vt(n,1,o),yl(n,o);else if("function"==typeof r.componentDidCatch&&(null===$s||!$s.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function Gl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=fl(),e.pingedLanes|=e.suspendedLanes&n,Ls===e&&(Fs&n)===n&&(4===Us||3===Us&&(62914560&Fs)===Fs&&500>jo()-Ws?Il(e,0):js|=n),yl(e,t)}function Vl(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(2&(t=e.mode)?4&t?(0===cl&&(cl=Hs),0===(t=Ht(62914560&~cl))&&(t=4194304)):t=99===qo()?1:2:t=1),n=fl(),null!==(e=ml(e,t))&&(Vt(e,t,n),yl(e,n))}function jl(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ql(e,t,n,r){return new jl(e,t,n,r)}function Wl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Yl(e,t){var n=e.alternate;return null===n?((n=ql(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ql(e,t,n,r,o,i){var a=2;if(r=e,"function"==typeof e)Wl(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case I:return Jl(n.children,o,i,t);case M:a=8,o|=16;break;case P:a=8,o|=1;break;case _:return(e=ql(12,n,t,8|o)).elementType=_,e.type=_,e.lanes=i,e;case N:return(e=ql(13,n,t,o)).type=N,e.elementType=N,e.lanes=i,e;case O:return(e=ql(19,n,t,o)).elementType=O,e.lanes=i,e;case B:return Xl(n,o,i,t);case U:return(e=ql(24,n,t,o)).elementType=U,e.lanes=i,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case A:a=10;break e;case k:a=9;break e;case x:a=11;break e;case D:a=14;break e;case L:a=16,r=null;break e;case R:a=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=ql(a,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Jl(e,t,n,r){return(e=ql(7,e,r,t)).lanes=n,e}function Xl(e,t,n,r){return(e=ql(23,e,r,t)).elementType=B,e.lanes=n,e}function Kl(e,t,n){return(e=ql(6,e,null,t)).lanes=n,e}function Zl(e,t,n){return(t=ql(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $l(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Gt(0),this.expirationTimes=Gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gt(0),this.mutableSourceEagerHydrationData=null}function ec(e,t,n,r){var o=t.current,i=fl(),a=hl(o);e:if(n){t:{if(Xe(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(vo(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(s(171))}if(1===n.tag){var c=n.type;if(vo(c)){n=bo(n,c,l);break e}}n=l}else n=fo;return null===t.context?t.context=n:t.pendingContext=n,(t=di(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),pi(o,t),gl(o,a,i),a}function tc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function nc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function rc(e,t){nc(e,t),(e=e.alternate)&&nc(e,t)}function oc(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new $l(e,t,null!=n&&!0===n.hydrate),t=ql(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ci(t),e[eo]=n.current,Or(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var o=(t=r[e])._getVersion;o=o(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,o]:n.mutableSourceEagerHydrationData.push(t,o)}this._internalRoot=n}function ic(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ac(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i._internalRoot;if("function"==typeof o){var s=o;o=function(){var e=tc(a);s.call(e)}}ec(t,a,e,o)}else{if(i=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new oc(e,0,t?{hydrate:!0}:void 0)}(n,r),a=i._internalRoot,"function"==typeof o){var l=o;o=function(){var e=tc(a);l.call(e)}}El((function(){ec(t,a,e,o)}))}return tc(a)}function sc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ic(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}Js=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||go.current)Ma=!0;else{if(!(n&r)){switch(Ma=!1,t.tag){case 3:Ya(t),Qi();break;case 5:Fi(t);break;case 1:vo(t.type)&&Eo(t);break;case 4:Li(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var o=t.type._context;po($o,o._currentValue),o._currentValue=r;break;case 13:if(null!==t.memoizedState)return n&t.child.childLanes?$a(e,t,n):(po(Bi,1&Bi.current),null!==(t=as(e,t,n))?t.sibling:null);po(Bi,1&Bi.current);break;case 19:if(r=!!(n&t.childLanes),64&e.flags){if(r)return is(e,t,n);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),po(Bi,Bi.current),r)break;return null;case 23:case 24:return t.lanes=0,Ga(e,t,n)}return as(e,t,n)}Ma=!!(16384&e.flags)}else Ma=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=yo(t,ho.current),ai(t,n),o=sa(null,t,r,e,o,n),t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,vo(r)){var i=!0;Eo(t)}else i=!1;t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,ci(t);var a=r.getDerivedStateFromProps;"function"==typeof a&&yi(t,r,a,e),o.updater=vi,t.stateNode=o,o._reactInternals=t,Ei(t,r,e,n),t=Wa(null,t,r,!0,i,n)}else t.tag=0,Ba(null,t,o,n),t=t.child;return t;case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(i=o._init)(o._payload),t.type=o,i=t.tag=function(e){if("function"==typeof e)return Wl(e)?1:0;if(null!=e){if((e=e.$$typeof)===x)return 11;if(e===D)return 14}return 2}(o),e=Zo(o,e),i){case 0:t=ja(null,t,o,e,n);break e;case 1:t=qa(null,t,o,e,n);break e;case 11:t=Ua(null,t,o,e,n);break e;case 14:t=za(null,t,o,Zo(o.type,e),r,n);break e}throw Error(s(306,o,""))}return t;case 0:return r=t.type,o=t.pendingProps,ja(e,t,r,o=t.elementType===r?o:Zo(r,o),n);case 1:return r=t.type,o=t.pendingProps,qa(e,t,r,o=t.elementType===r?o:Zo(r,o),n);case 3:if(Ya(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,ui(e,t),hi(t,r,null,n),(r=t.memoizedState.element)===o)Qi(),t=as(e,t,n);else{if((i=(o=t.stateNode).hydrate)&&(Hi=Qr(t.stateNode.containerInfo.firstChild),zi=t,i=Gi=!0),i){if(null!=(e=o.mutableSourceEagerHydrationData))for(o=0;o<e.length;o+=2)(i=e[o])._workInProgressVersionPrimary=e[o+1],Ji.push(i);for(n=Ai(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Ba(e,t,r,n),Qi();t=t.child}return t;case 5:return Fi(t),null===e&&qi(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,a=o.children,jr(r,o)?a=null:null!==i&&jr(r,i)&&(t.flags|=16),Va(e,t),Ba(e,t,a,n),t.child;case 6:return null===e&&qi(t),null;case 13:return $a(e,t,n);case 4:return Li(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=_i(t,null,r,n):Ba(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Ua(e,t,r,o=t.elementType===r?o:Zo(r,o),n);case 7:return Ba(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ba(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,o=t.pendingProps,a=t.memoizedProps,i=o.value;var l=t.type._context;if(po($o,l._currentValue),l._currentValue=i,null!==a)if(l=a.value,0===(i=ur(l,i)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,i):1073741823))){if(a.children===o.children&&!go.current){t=as(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){a=l.child;for(var u=c.firstContext;null!==u;){if(u.context===r&&u.observedBits&i){1===l.tag&&((u=di(-1,n&-n)).tag=2,pi(l,u)),l.lanes|=n,null!==(u=l.alternate)&&(u.lanes|=n),ii(l.return,n),c.lanes|=n;break}u=u.next}}else a=10===l.tag&&l.type===t.type?null:l.child;if(null!==a)a.return=l;else for(a=l;null!==a;){if(a===t){a=null;break}if(null!==(l=a.sibling)){l.return=a.return,a=l;break}a=a.return}l=a}Ba(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=(i=t.pendingProps).children,ai(t,n),r=r(o=si(o,i.unstable_observedBits)),t.flags|=1,Ba(e,t,r,n),t.child;case 14:return i=Zo(o=t.type,t.pendingProps),za(e,t,o,i=Zo(o.type,i),r,n);case 15:return Ha(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Zo(r,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,vo(r)?(e=!0,Eo(t)):e=!1,ai(t,n),Ci(t,r,o),Ei(t,r,o,n),Wa(null,t,r,!0,e,n);case 19:return is(e,t,n);case 23:case 24:return Ga(e,t,n)}throw Error(s(156,t.tag))},oc.prototype.render=function(e){ec(e,this._internalRoot,null,null)},oc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;ec(null,e,null,(function(){t[eo]=null}))},tt=function(e){13===e.tag&&(gl(e,4,fl()),rc(e,4))},nt=function(e){13===e.tag&&(gl(e,67108864,fl()),rc(e,67108864))},rt=function(e){if(13===e.tag){var t=fl(),n=hl(e);gl(e,n,t),rc(e,n)}},ot=function(e,t){return t()},_e=function(e,t,n){switch(t){case"input":if(re(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=io(r);if(!o)throw Error(s(90));Z(r),re(r,o)}}}break;case"textarea":ue(e,n);break;case"select":null!=(t=n.value)&&se(e,!!n.multiple,t,!1)}},De=bl,Le=function(e,t,n,r,o){var i=Ds;Ds|=4;try{return Yo(98,e.bind(null,t,n,r,o))}finally{0===(Ds=i)&&(Qs(),Jo())}},Re=function(){!(49&Ds)&&(function(){if(null!==il){var e=il;il=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,yl(e,jo())}))}Jo()}(),Fl())},Fe=function(e,t){var n=Ds;Ds|=2;try{return e(t)}finally{0===(Ds=n)&&(Qs(),Jo())}};var lc={Events:[ro,oo,io,Ne,Oe,Fl,{current:!1}]},cc={findFiberByHostInstance:no,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},uc={bundleType:cc.bundleType,version:cc.version,rendererPackageName:cc.rendererPackageName,rendererConfig:cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=$e(e))?null:e.stateNode},findFiberByHostInstance:cc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var dc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dc.isDisabled&&dc.supportsFiber)try{wo=dc.inject(uc),Io=dc}catch(me){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lc,t.createPortal=sc,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=$e(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Ds;if(48&n)return e(t);Ds|=1;try{if(e)return Yo(99,e.bind(null,t))}finally{Ds=n,Jo()}},t.hydrate=function(e,t,n){if(!ic(t))throw Error(s(200));return ac(null,e,t,!0,n)},t.render=function(e,t,n){if(!ic(t))throw Error(s(200));return ac(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!ic(e))throw Error(s(40));return!!e._reactRootContainer&&(El((function(){ac(null,null,e,!1,(function(){e._reactRootContainer=null,e[eo]=null}))})),!0)},t.unstable_batchedUpdates=bl,t.unstable_createPortal=function(e,t){return sc(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ic(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return ac(e,t,n,!1,r)},t.version="17.0.2"},65227:(e,t,n)=>{var r=n(37542),o=r.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=a),a.prototype=Object.create(o.prototype),i(o,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=o(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},98597:(e,t,n)=>{var r=n(65227).Buffer;function o(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}o.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var n=this._block,o=this._blockSize,i=e.length,a=this._len,s=0;s<i;){for(var l=a%o,c=Math.min(i-s,o-l),u=0;u<c;u++)n[l+u]=e[s+u];s+=c,(a+=c)%o==0&&this._update(n)}return this._len+=i,this},o.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,o=(n-r)/4294967296;this._block.writeUInt32BE(o,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var i=this._hash();return e?i.toString(e):i},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=o},23909:(e,t,n)=>{var r=e.exports=function(e){e=e.toLowerCase();var t=r[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};r.sha=n(66403),r.sha1=n(87484),r.sha224=n(54811),r.sha256=n(5077),r.sha384=n(28618),r.sha512=n(28875)},66403:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function l(){this.init(),this._w=s,o.call(this,64,56)}function c(e){return e<<30|e>>>2}function u(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,o),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,l=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=n[d-3]^n[d-8]^n[d-14]^n[d-16];for(var p=0;p<80;++p){var f=~~(p/20),h=0|((t=r)<<5|t>>>27)+u(f,o,i,s)+l+n[p]+a[f];l=s,s=i,i=c(o),o=r,r=h}this._a=r+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},87484:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function l(){this.init(),this._w=s,o.call(this,64,56)}function c(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function d(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,o),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,l=0|this._e,p=0;p<16;++p)n[p]=e.readInt32BE(4*p);for(;p<80;++p)n[p]=(t=n[p-3]^n[p-8]^n[p-14]^n[p-16])<<1|t>>>31;for(var f=0;f<80;++f){var h=~~(f/20),g=c(r)+d(h,o,i,s)+l+n[f]+a[h]|0;l=s,s=i,i=u(o),o=r,r=g}this._a=r+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},54811:(e,t,n)=>{var r=n(12523),o=n(5077),i=n(98597),a=n(65227).Buffer,s=new Array(64);function l(){this.init(),this._w=s,i.call(this,64,56)}r(l,o),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},5077:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function l(){this.init(),this._w=s,o.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function p(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(l,o),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,l=0|this._e,h=0|this._f,g=0|this._g,m=0|this._h,y=0;y<16;++y)n[y]=e.readInt32BE(4*y);for(;y<64;++y)n[y]=0|(((t=n[y-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[y-7]+f(n[y-15])+n[y-16];for(var v=0;v<64;++v){var S=m+p(l)+c(l,h,g)+a[v]+n[v]|0,C=d(r)+u(r,o,i)|0;m=g,g=h,h=l,l=s+S|0,s=i,i=o,o=r,r=S+C|0}this._a=r+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0,this._f=h+this._f|0,this._g=g+this._g|0,this._h=m+this._h|0},l.prototype._hash=function(){var e=i.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},28618:(e,t,n)=>{var r=n(12523),o=n(28875),i=n(98597),a=n(65227).Buffer,s=new Array(160);function l(){this.init(),this._w=s,i.call(this,128,112)}r(l,o),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},28875:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function l(){this.init(),this._w=s,o.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function p(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function h(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function g(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function y(e,t){return e>>>0<t>>>0?1:0}r(l,o),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,o=0|this._ch,i=0|this._dh,s=0|this._eh,l=0|this._fh,v=0|this._gh,S=0|this._hh,C=0|this._al,b=0|this._bl,E=0|this._cl,T=0|this._dl,w=0|this._el,I=0|this._fl,P=0|this._gl,_=0|this._hl,A=0;A<32;A+=2)t[A]=e.readInt32BE(4*A),t[A+1]=e.readInt32BE(4*A+4);for(;A<160;A+=2){var k=t[A-30],x=t[A-30+1],N=f(k,x),O=h(x,k),D=g(k=t[A-4],x=t[A-4+1]),L=m(x,k),R=t[A-14],F=t[A-14+1],M=t[A-32],B=t[A-32+1],U=O+F|0,z=N+R+y(U,O)|0;z=(z=z+D+y(U=U+L|0,L)|0)+M+y(U=U+B|0,B)|0,t[A]=z,t[A+1]=U}for(var H=0;H<160;H+=2){z=t[H],U=t[H+1];var G=u(n,r,o),V=u(C,b,E),j=d(n,C),q=d(C,n),W=p(s,w),Y=p(w,s),Q=a[H],J=a[H+1],X=c(s,l,v),K=c(w,I,P),Z=_+Y|0,$=S+W+y(Z,_)|0;$=($=($=$+X+y(Z=Z+K|0,K)|0)+Q+y(Z=Z+J|0,J)|0)+z+y(Z=Z+U|0,U)|0;var ee=q+V|0,te=j+G+y(ee,q)|0;S=v,_=P,v=l,P=I,l=s,I=w,s=i+$+y(w=T+Z|0,T)|0,i=o,T=E,o=r,E=b,r=n,b=C,n=$+te+y(C=Z+ee|0,Z)|0}this._al=this._al+C|0,this._bl=this._bl+b|0,this._cl=this._cl+E|0,this._dl=this._dl+T|0,this._el=this._el+w|0,this._fl=this._fl+I|0,this._gl=this._gl+P|0,this._hl=this._hl+_|0,this._ah=this._ah+n+y(this._al,C)|0,this._bh=this._bh+r+y(this._bl,b)|0,this._ch=this._ch+o+y(this._cl,E)|0,this._dh=this._dh+i+y(this._dl,T)|0,this._eh=this._eh+s+y(this._el,w)|0,this._fh=this._fh+l+y(this._fl,I)|0,this._gh=this._gh+v+y(this._gl,P)|0,this._hh=this._hh+S+y(this._hl,_)|0},l.prototype._hash=function(){var e=i.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},28679:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],u=i[c]||0,d="".concat(c," ").concat(u);i[c]=u+1;var p=n(d),f={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(f);else{var h=o(f,r);r.byIndex=s,t.splice(s,0,{identifier:d,updater:h,references:1})}a.push(d)}return a}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var l=r(e,o),c=0;c<i.length;c++){var u=n(i[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},87720:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},11843:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},34159:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},22180:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},79216:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},16912:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Basin=t.BasinCursor=void 0;var s=a(n(3110)),l=a(n(55203));t.BasinCursor=function e(t,n,o){r(this,e),i(this,"jsonPath",void 0),i(this,"position",void 0),i(this,"deleteCount",void 0),i(this,"j",void 0),i(this,"p",void 0),i(this,"d",void 0),this.jsonPath=t,this.position=n,this.deleteCount=o};var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;r(this,e),i(this,"items",void 0),i(this,"_cursor",void 0),i(this,"_currentKey",void 0),this.items=t,this._cursor=n,void 0!==n&&this.setCursor(n)}var t,n,a;return t=e,(n=[{key:"applyPatches",value:function(e){s.default.applyPatch(this.items,e);var t=new Set,n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value,u=c.path.indexOf("/",1);u=-1==u?c.path.length:u;var d=c.path.slice(1,u).replace(/~1/g,"/").replace(/~0/g,"~");t.has(d)||(n.push(this.items[d]),t.add(d))}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}},{key:"setCursor",value:function(e){this._cursor=e,void 0!==e.j&&(e.jsonPath=e.j,delete e.j),void 0!==e.p&&(e.position=e.p,delete e.p),void 0!==e.d&&(e.deleteCount=e.d,delete e.d);var t=l.default.parse(e.jsonPath),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if("root"!==s.expression.type){this._currentKey=s.expression.value;break}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"write",value:function(e){var t=this._cursor,n=t.position,r=t.jsonPath;return"number"!=typeof n?l.default.value(this.items,r,e):l.default.apply(this.items,r,(function(r){if(Array.isArray(r))return void 0!==t.deleteCount?r.splice(n,t.deleteCount):-1===n?r.push(e):r.splice(n,0,e),r;if(-1===n)return r+e;t.position+=e.length;var o=t.deleteCount||0;return r.slice(0,n)+e+r.slice(n+o)})),this.items[this._currentKey]}}])&&o(t.prototype,n),a&&o(t,a),e}();t.Basin=c},14014:(e,t,n)=>{"use strict";n.d(t,{p3:()=>fe,Ay:()=>De,NY:()=>he});var r,o=n(43032),i=n(42652),a=n(79490),s=n(8520),l=n(30325),c=n(72218),u=n(55564),d=n(19588),p=n(91208),f=n(40389);!function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(r||(r={}));var h=[{pptPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:p.G.defaultWhite},{pptPrimaryBackgroundColor:"#262626",sdxPrimaryBackgroundColor:"#525252",sdxTheme:p.G.defaultBlack},{pptPrimaryBackgroundColor:"#f0f0f0",sdxPrimaryBackgroundColor:"#0a0a0a",sdxTheme:p.G.defaultBlack},{pptPrimaryBackgroundColor:"#323232",sdxPrimaryBackgroundColor:"#323232",sdxTheme:p.G.defaultBlack},{pptPrimaryBackgroundColor:"#1B1A19",sdxPrimaryBackgroundColor:"#1B1A19",sdxTheme:p.G.defaultBlack}],g=[{pptPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:p.G.defaultWhite},{pptPrimaryBackgroundColor:"#000000",sdxPrimaryBackgroundColor:"#0a0a0a",sdxTheme:p.G.defaultBlack}],m=function(e,t){var n,r,o=(0,f.dD)()?g.find((function(t){return t.pptPrimaryBackgroundColor===e})):h.find((function(t){return t.pptPrimaryBackgroundColor===e}));return t&&y(null!==(n=null==o?void 0:o.sdxPrimaryBackgroundColor)&&void 0!==n?n:"#F5F5F5"),null!==(r=null==o?void 0:o.sdxTheme)&&void 0!==r?r:p.G.defaultWhite},y=function(e){document.body.style.backgroundColor=e},v=n(43277),S=n(7567),C=n(39726),b=n(71731),E=n(81849);var T=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},r=0,o=e;r<o.length;r++)for(var i=o[r],a=0,s=Array.isArray(i)?i:Object.keys(i);a<s.length;a++){n[s[a]]=1}return n},w=T(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),I=T(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),P=T(I,w),_=(T(P,["form"]),T(P,["height","loop","muted","preload","src","width"])),A=(T(_,["poster"]),T(P,["start"]),T(P,["value"]),T(P,["download","href","hrefLang","media","rel","target","type"]),T(P,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"])),k=(T(A,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),T(A,["autoCapitalize","cols","dirname","form","maxLength","minLength","placeholder","readOnly","required","rows","wrap"]),T(A,["form","multiple","required"]),T(P,["selected","value"]),T(P,["cellPadding","cellSpacing"]),T(P,["rowSpan","scope"]),T(P,["colSpan","headers","rowSpan","scope"]),T(P,["span"]),T(P,["span"]),T(P,["acceptCharset","action","encType","encType","method","noValidate","target"]),T(P,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),T(P,["alt","crossOrigin","height","src","srcSet","useMap","width"]),P);function x(e,t,n){for(var r=Array.isArray(t),o={},i=0,a=Object.keys(e);i<a.length;i++){var s=a[i];!(!r&&t[s]||r&&t.indexOf(s)>=0||0===s.indexOf("data-")||0===s.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(s))||(o[s]=e[s])}return o}function N(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r];if(i)if("string"==typeof i)n.push(i);else if(i.hasOwnProperty("toString")&&"function"==typeof i.toString)n.push(i.toString());else for(var a in i)i[a]&&n.push(a)}return n.join(" ")}var O=n(98226),D={root:"ms-StackItem"},L={start:"flex-start",end:"flex-end"},R=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},F=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},M=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?R(e,t):n.reduce((function(e,n){return R(e,t)+" "+R(n,t)}))},B={start:"flex-start",end:"flex-end"},U={root:"ms-Stack",inner:"ms-Stack-inner",child:"ms-Stack-child"},z=(0,E.a)((function(e){var t=e.children,n=x(e,P);if(null==t)return null;var r=(0,b.Sk)(e,{root:"div"});return(0,b.WL)(r.root,(0,a.__assign)({},n),t)}),{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,o=e.shrink,i=e.disableShrink,a=e.align,s=e.verticalFill,l=e.order,c=e.className,u=e.basis,d=void 0===u?"auto":u,p=(0,O.Km)(D,t);return{root:[t.fonts.medium,p.root,{flexBasis:d,margin:n.margin,padding:n.padding,height:s?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(i||!r&&!o)&&{flexShrink:0},o&&!i&&{flexShrink:1},a&&{alignSelf:L[a]||a},l&&{order:l},c]}}});function H(e,t){var n=t.disableShrink,r=t.enableScopedSelectors,o=t.doNotRenderFalsyValues,i=s.Children.toArray(e);return i=s.Children.map(i,(function(e){if(!e)return o?null:e;if(!s.isValidElement(e))return e;if(e.type===s.Fragment)return e.props.children?H(e.props.children,{disableShrink:n,enableScopedSelectors:r,doNotRenderFalsyValues:o}):null;var t,i=e,l={};(t=e)&&"object"==typeof t&&t.type&&t.type.displayName===z.displayName&&(l={shrink:!n});var c=i.props.className;return s.cloneElement(i,(0,a.__assign)((0,a.__assign)((0,a.__assign)((0,a.__assign)({},l),i.props),c&&{className:c}),r&&{className:N(U.child,c)}))}))}var G={Item:z},V=(0,E.a)((function(e){var t=e.as,n=void 0===t?"div":t,r=e.disableShrink,o=void 0!==r&&r,i=e.doNotRenderFalsyValues,s=void 0!==i&&i,l=e.enableScopedSelectors,c=void 0!==l&&l,u=e.wrap,d=(0,a.__rest)(e,["as","disableShrink","doNotRenderFalsyValues","enableScopedSelectors","wrap"]),p=H(e.children,{disableShrink:o,enableScopedSelectors:c,doNotRenderFalsyValues:s}),f=x(d,P),h=(0,b.Sk)(e,{root:n,inner:"div"});return u?(0,b.WL)(h.root,(0,a.__assign)({},f),(0,b.WL)(h.inner,null,p)):(0,b.WL)(h.root,(0,a.__assign)({},f),p)}),{displayName:"Stack",styles:function(e,t,n){var r,o,i,s,l,c,u,d,p,f,h,g,m,y=e.className,v=e.disableShrink,S=e.enableScopedSelectors,C=e.grow,b=e.horizontal,E=e.horizontalAlign,T=e.reversed,w=e.verticalAlign,I=e.verticalFill,P=e.wrap,_=(0,O.Km)(U,t),A=n&&n.childrenGap?n.childrenGap:e.gap,k=n&&n.maxHeight?n.maxHeight:e.maxHeight,x=n&&n.maxWidth?n.maxWidth:e.maxWidth,N=n&&n.padding?n.padding:e.padding,L=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:F(R(n[0],t)),columnGap:F(R(n[1],t))};var r=F(R(e,t));return{rowGap:r,columnGap:r}}(A,t),z=L.rowGap,H=L.columnGap,G="".concat(-.5*H.value).concat(H.unit),V="".concat(-.5*z.value).concat(z.unit),j={textOverflow:"ellipsis"},q="> "+(S?"."+U.child:"*"),W=((r={})["".concat(q,":not(.").concat(D.root,")")]={flexShrink:0},r);return P?{root:[_.root,{flexWrap:"wrap",maxWidth:x,maxHeight:k,width:"auto",overflow:"visible",height:"100%"},E&&(o={},o[b?"justifyContent":"alignItems"]=B[E]||E,o),w&&(i={},i[b?"alignItems":"justifyContent"]=B[w]||w,i),y,{display:"flex"},b&&{height:I?"100%":"auto"}],inner:[_.inner,(s={display:"flex",flexWrap:"wrap",marginLeft:G,marginRight:G,marginTop:V,marginBottom:V,overflow:"visible",boxSizing:"border-box",padding:M(N,t),width:0===H.value?"100%":"calc(100% + ".concat(H.value).concat(H.unit,")"),maxWidth:"100vw"},s[q]=(0,a.__assign)({margin:"".concat(.5*z.value).concat(z.unit," ").concat(.5*H.value).concat(H.unit)},j),s),v&&W,E&&(l={},l[b?"justifyContent":"alignItems"]=B[E]||E,l),w&&(c={},c[b?"alignItems":"justifyContent"]=B[w]||w,c),b&&(u={flexDirection:T?"row-reverse":"row",height:0===z.value?"100%":"calc(100% + ".concat(z.value).concat(z.unit,")")},u[q]={maxWidth:0===H.value?"100%":"calc(100% - ".concat(H.value).concat(H.unit,")")},u),!b&&(d={flexDirection:T?"column-reverse":"column",height:"calc(100% + ".concat(z.value).concat(z.unit,")")},d[q]={maxHeight:0===z.value?"100%":"calc(100% - ".concat(z.value).concat(z.unit,")")},d)]}:{root:[_.root,(p={display:"flex",flexDirection:b?T?"row-reverse":"row":T?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:I?"100%":"auto",maxWidth:x,maxHeight:k,padding:M(N,t),boxSizing:"border-box"},p[q]=j,p),v&&W,C&&{flexGrow:!0===C?1:C},E&&(f={},f[b?"justifyContent":"alignItems"]=B[E]||E,f),w&&(h={},h[b?"alignItems":"justifyContent"]=B[w]||w,h),b&&H.value>0&&(g={},g["".concat(q,T?":not(:last-child)":":not(:first-child)")]={marginLeft:"".concat(H.value).concat(H.unit)},g),!b&&z.value>0&&(m={},m["".concat(q,T?":not(:last-child)":":not(:first-child)")]={marginTop:"".concat(z.value).concat(z.unit)},m),y]}},statics:G});var j=n(92109),q=n(75505),W=function(){return!1},Y=function(){return q.ou},Q=function(){return new Map},J=function(){},X=s.createContext({stylesheets:new Map,useAdoptedStylesheetEx:W,useAdoptedStylesheet:W,useShadowConfig:Y,useMergeStylesShadowRootContext:J,useHasMergeStylesShadowRootContext:W,useMergeStylesRootStylesheets:Q,useWindow:J,useStyled:J}),K=n(722),Z=n(24275);function $(e,t){var n,r=(n=s.useState(0)[1],function(){return n((function(e){return++e}))}),o=s.useContext(Z.z).customizations,i=o.inCustomizerContext;return s.useEffect((function(){return i||K.X.observe(r),function(){i||K.X.unobserve(r)}}),[i]),K.X.getSettings(e,t,o)}var ee,te,ne=["theme","styles"];!function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(ee||(ee={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(te||(te={}));var re=n(32035),oe=n(39871),ie=n(6289),ae=n(92161),se=n(58651),le=0,ce=re.nr.getInstance();ce&&ce.onReset&&ce.onReset((function(){return le++}));var ue="__retval__";function de(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function pe(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,r=t.__cachedInputs__;n<r.length;n++){e=de(e,r[n])}else e=de(e,t);else if("object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(e=de(e,t[o]));return e}var fe,he,ge,me=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:void 0===(0,ae.z)()},n}return(0,a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?s.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(s.Component),ye=function(e){void 0===e&&(e={});var t=new Map,n=0,r=0,o=le;return function(i,a){var s;if(void 0===a&&(a={}),e.useStaticStyles&&"function"==typeof i&&i.__noStyleOverride__)return i(a);r++;var l=i?i.__shadowConfig__:void 0,c=l&&l.window?l.window:"__default__";t.has(c)||t.set(c,new Map);var u=t.get(c),d=a.theme,p=d&&void 0!==d.rtl?d.rtl:(0,ie.jI)(),f=e.disableCaching;if(o!==le&&(o=le,t.set(c,new Map),u=t.get(c),n=0),e.disableCaching||(u=pe(t.get(c),i),u=pe(u,a)),!f&&u[ue]||(u[ue]=void 0===i?{}:(0,oe.L)(["function"==typeof i?i(a):i],{shadowConfig:i.__shadowConfig__,rtl:!!p,specificityMultiplier:e.useStaticStyles?5:void 0}),f||n++),n>(e.cacheSize||50)){var h=(0,ae.z)();(null===(s=null==h?void 0:h.FabricConfig)||void 0===s?void 0:s.enableClassNameCacheFullWarning)&&(se.warn("Styles are being recalculated too frequently. Cache miss rate is ".concat(n,"/").concat(r,".")),se.trace()),t.get(c).clear(),n=0,e.disableCaching=!0}return u[ue]}}(),ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e,t=(e=this.props).type,n=e.size,r=e.ariaLabel,o=e.ariaLive,i=e.styles,l=e.label,c=e.theme,u=e.className,d=e.labelPosition,p=r,f=x(this.props,k,["size"]),h=n;void 0===h&&void 0!==t&&(h=t===te.large?ee.large:ee.medium);var g=ye(i,{theme:c,size:h,className:u,labelPosition:d});return s.createElement("div",(0,a.__assign)({},f,{className:g.root}),s.createElement("div",{className:g.circle}),l&&s.createElement("div",{className:g.label},l),p&&s.createElement("div",{role:"status","aria-live":o},s.createElement(me,null,s.createElement("div",{className:g.screenReaderText},p))))},t.defaultProps={size:ee.medium,ariaLive:"polite",labelPosition:"bottom"},t}(s.Component),Se=n(16386),Ce={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},be=(0,Se.J9)((function(){return(0,O.i7)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})})),Ee=function(e,t,n,r,o){var i=(r=r||{scope:"",fields:void 0}).scope,l=r.fields,c=void 0===l?ne:l,u=s.forwardRef((function(r,o){var l,u=s.useRef(),d=$(c,i),p=d.styles,f=(d.dir,(0,a.__rest)(d,["styles","dir"])),h=n?n(r):void 0,g=(l=s.useContext(X),{useAdoptedStylesheet:l.useAdoptedStylesheet,useAdoptedStylesheetEx:l.useAdoptedStylesheetEx,useShadowConfig:l.useShadowConfig,useMergeStylesShadowRootContext:l.useMergeStylesShadowRootContext,useHasMergeStylesShadowRootContext:l.useHasMergeStylesShadowRootContext,useMergeStylesRootStylesheets:l.useMergeStylesRootStylesheets,useWindow:l.useWindow,useStyled:l.useStyled}).useStyled,m=u.current&&u.current.__cachedInputs__||[],y=r.styles;if(!u.current||p!==m[1]||y!==m[2]){var v=function(e){return(0,j.p)(e,t,p,y)};v.__cachedInputs__=[t,p,y],v.__noStyleOverride__=!p&&!y,u.current=v}return u.current.__shadowConfig__=g(i),s.createElement(e,(0,a.__assign)({ref:o},f,h,r,{styles:u.current}))}));u.displayName="Styled".concat(e.displayName||e.name);var d=o?s.memo(u):u;return u.displayName&&(d.displayName=u.displayName),d}(ve,(function(e){var t,n=e.theme,r=e.size,o=e.className,i=e.labelPosition,s=n.palette,l=(0,O.Km)(Ce,n);return{root:[l.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===i&&{flexDirection:"column-reverse"},"right"===i&&{flexDirection:"row"},"left"===i&&{flexDirection:"row-reverse"},o],circle:[l.circle,{boxSizing:"border-box",borderRadius:"50%",borderWidth:"1.5px",borderStyle:"solid",borderTopColor:s.themePrimary,borderRightColor:s.themeLight,borderBottomColor:s.themeLight,borderLeftColor:s.themeLight,animationName:be(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[O.up]=(0,a.__assign)({borderTopColor:"Highlight"},(0,O.Qg)()),t)},r===ee.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===ee.small&&["ms-Spinner--small",{width:16,height:16}],r===ee.medium&&["ms-Spinner--medium",{width:20,height:20}],r===ee.large&&["ms-Spinner--large",{width:28,height:28}]],label:[l.label,n.fonts.small,{color:s.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===i&&{margin:"0 0 8px"},"right"===i&&{margin:"0 0 0 8px"},"left"===i&&{margin:"0 8px 0 0"}],screenReaderText:O.dX}}),void 0,{scope:"Spinner"}),Te=n(89125),we=n(18758),Ie=n(37745),Pe=n(4277),_e=n(2061),Ae=n(34948),ke=n(41722),xe=n(58651),Ne=!1,Oe=(ge=(0,o._)((function(){return(0,a.__generator)(this,(function(e){return Ne||(OfficeFirstPartyAuth.autoPopup=!0,OfficeFirstPartyAuth.upnCheck=!1,OfficeFirstPartyAuth.useMsal3=!0,Ne=!0),[2]}))})),function(){return ge.apply(this,arguments)});const De=function(e){fe=(new Date).getTime(),Oe();var t=(0,i._)(s.useState(!1),2),n=t[0],p=t[1],h=(0,i._)(s.useState(_e.GmK.defaultWhite),2),g=h[0],y=h[1],b=(0,i._)(s.useState(r.disabled),2),E=b[0],T=b[1],w=function(e){var t=window.matchMedia("(prefers-color-scheme: light)").matches;if(e)T(t?r.light:r.dark);else{T(r.disabled);var n=m(v.i.GetHostAppPlatform()===c.nAd?Office.context.officeTheme.controlForegroundColor:(0,u.bw)(u.WT.IsCopilotThemeForWebEnabled)||(0,f.OK)()?Office.context.officeTheme.bodyBackgroundColor:"ffffff",!1);y(n)}};window.matchMedia("(forced-colors: active)").addEventListener("change",(function(e){e.matches?w(!0):w(!1)})),window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",(function(e){window.matchMedia("(forced-colors: active)").matches&&T(e.matches?r.light:r.dark)}));var I=function(e){var t;(0,we.cY)("OfficeTheme Changed"),t=(0,u.bw)(u.WT.IsCopilotThemeForWebEnabled)?m(v.i.GetHostAppPlatform()===c.nAd?e.officeTheme.controlForegroundColor:e.officeTheme.bodyBackgroundColor,!0):m((0,f.OK)()?e.officeTheme.bodyBackgroundColor:e.officeTheme.controlForegroundColor,!0),y(t)},P=function(){var e=(0,o._)((function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,I)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}));return function(){return e.apply(this,arguments)}}();s.useEffect((function(){(0,o._)((function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(0,Pe.Nd)()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),(0,we.cY)("Auth initialization failed with exception ".concat(e)),[3,3];case 3:return[2]}}))}))();var e=_e.GmK.defaultWhite,t=v.i.GetHostAppPlatform();if(t===c.nAd)e=m(Office.context.officeTheme.controlForegroundColor,!0),P().catch((function(e){(0,we.cY)("Register Theme Callback() error: "+e),Te.j.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,c.uEI,c.Vgs,!1)}));else if((0,f.OK)()){var n,r;null===(r=Office.context)||void 0===r||null===(n=r.themeManager)||void 0===n||n.getOfficeThemeAsync((function(t){if("succeeded"===t.status){var n=t.value;e=m(n.bodyBackgroundColor,!0),y(e),P().catch((function(e){(0,we.cY)("Register Theme Callback() error: "+e),Te.j.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,c.uEI,c.Vgs,!1)}))}}))}else t===c.q93&&(0,u.bw)(u.WT.IsCopilotThemeForWebEnabled)&&(e=m(Office.context.officeTheme.controlBackgroundColor,!0),P().catch((function(e){(0,we.cY)("Register Theme Callback() error: "+e),Te.j.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,c.uEI,c.Vgs,!1)})));window.matchMedia("(forced-colors: active)").matches&&w(!0),y(e),he=(new Date).getTime(),(0,S.Fd)(p),window.addEventListener("beforeunload",(function(){xe.log("beforeunload"),_e.DLk.getInstance().closeActiveDialog()}))}),[]),s.useEffect((function(){switch(E){case r.light:y(_e.GmK.defaultWhite);break;case r.dark:y(_e.GmK.defaultBlack)}}),[E]),s.useEffect((function(){n&&(document.title=PowerpointCopilotStrings.CopilotPaneTitle)}),[n]),(0,we.cY)("App Execution completed in: ".concat(((new Date).getTime()-fe)/1e3," sec"));var _=s.createElement(l.ys,{theme:g,isHighContrast:E!==r.disabled}),A=g!==_e.GmK.defaultWhite?"./assets/error-boundary-dark.webp":"./assets/error-boundary-light.webp",k=s.createElement(_e.tHk,{copilotChatTheme:(0,_e.IdZ)(Ae.Os,g,E!==r.disabled),errorBoundaryImagePath:A},_),x=(0,_e.Qk5)((0,Ie.hD)(v.i.GetHostAppDisplayLanguage()),void 0),N=s.createElement(_e.G41,{lookupString:x}," ",k),O=s.createElement(ke.D,null,N);return n?s.createElement("div",{className:"ms-welcome"},s.createElement(d.q,{dir:(0,Ie.xt)()?C.K3.RTL:C.K3.LTR},O)):s.createElement(V,null,s.createElement(Ee,null))}},99838:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OfficeAddinCalledTime:()=>L,appLoadStartTime:()=>J,isCopilotPreloaded:()=>Z,isSDXRenderingForPreload:()=>K,officeOnReadyTime:()=>O,pptTaskPaneStartTime:()=>Q,preloadCopilot:()=>D,setPreloadedCopilotSessionObject:()=>ee,setPreloadedCopilotVisibility:()=>$});var r=n(43032),o=n(90813),i=n(79490),a=n(8520),s=n(94329),l=n(98226);function c(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('".concat(e,"fabric-icons-a13498cf.woff') format('woff')")},icons:{GlobalNavButton:"",ChevronDown:"",ChevronUp:"",Edit:"",Add:"",Cancel:"",More:"",Settings:"",Mail:"",Filter:"",Search:"",Share:"",BlockedSite:"",FavoriteStar:"",FavoriteStarFill:"",CheckMark:"",Delete:"",ChevronLeft:"",ChevronRight:"",Calendar:"",Megaphone:"",Undo:"",Flag:"",Page:"",Pinned:"",View:"",Clear:"",Download:"",Upload:"",Folder:"",Sort:"",AlignRight:"",AlignLeft:"",Tag:"",AddFriend:"",Info:"",SortLines:"",List:"",CircleRing:"",Heart:"",HeartFill:"",Tiles:"",Embed:"",Glimmer:"",Ascending:"",Descending:"",SortUp:"",SortDown:"",SyncToPC:"",LargeGrid:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",ClearFilter:"",Flow:"",StatusCircleCheckmark:"",MoreVertical:""}};(0,l.K1)(n,t)}function u(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('".concat(e,"fabric-icons-0-467ee27f.woff') format('woff')")},icons:{PageLink:"",CommentSolid:"",ChangeEntitlements:"",Installation:"",WebAppBuilderModule:"",WebAppBuilderFragment:"",WebAppBuilderSlot:"",BullseyeTargetEdit:"",WebAppBuilderFragmentCreate:"",PageData:"",PageHeaderEdit:"",ProductList:"",UnpublishContent:"",DependencyAdd:"",DependencyRemove:"",EntitlementPolicy:"",EntitlementRedemption:"",SchoolDataSyncLogo:"",PinSolid12:"",PinSolidOff12:"",AddLink:"",SharepointAppIcon16:"",DataflowsLink:"",TimePicker:"",UserWarning:"",ComplianceAudit:"",InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",People:"",Phone:"",Pin:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Attach:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Back:"",Refresh:"",Lock:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",RealEstate:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",EaseOfAccess:"",ContactInfo:"",Unpin:"",Contact:"",Memo:"",IncomingCall:""}};(0,l.K1)(n,t)}function d(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('".concat(e,"fabric-icons-1-4d521695.woff') format('woff')")},icons:{Paste:"",WindowsLogo:"",Error:"",GripperBarVertical:"",Unlock:"",Slideshow:"",Trim:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ViewOriginal:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",TVMonitor:"",Speakers:"",Game:"",HorizontalTabKey:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",History:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",USB:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:""}};(0,l.K1)(n,t)}function p(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('".concat(e,"fabric-icons-2-63c99abf.woff') format('woff')")},icons:{Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",Library:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",Comment:"",DockLeft:"",DockRight:"",Repair:"",Accounts:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",CompassNW:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorAddition:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",Health:"",Webcam2:"",FrontCamera:"",ChevronUpSmall:""}};(0,l.K1)(n,t)}function f(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('".concat(e,"fabric-icons-3-089e217a.woff') format('woff')")},icons:{ChevronDownSmall:"",ChevronLeftSmall:"",ChevronRightSmall:"",ChevronUpMed:"",ChevronDownMed:"",ChevronLeftMed:"",ChevronRightMed:"",Devices2:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Freezing:"",FunnelChart:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:""}};(0,l.K1)(n,t)}function h(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('".concat(e,"fabric-icons-4-a656cc0a.woff') format('woff')")},icons:{HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",Devices3:"",Focus:"",VideoLightOff:"",Lightbulb:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",Ringer:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",AddToShoppingList:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Market:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:""}};(0,l.K1)(n,t)}function g(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('".concat(e,"fabric-icons-5-f95ba260.woff') format('woff')")},icons:{Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",ReminderTime:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",HomeGroup:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",Calories:"",POI:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",Toolbox:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",Diamond:"",ScaleUp:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",OpenFolderHorizontal:"",CalendarMirrored:""}};(0,l.K1)(n,t)}function m(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('".concat(e,"fabric-icons-6-ef6fd590.woff') format('woff')")},icons:{SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",DelveLogoInverse:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:""}};(0,l.K1)(n,t)}function y(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('".concat(e,"fabric-icons-7-2b97bb99.woff') format('woff')")},icons:{SingleBookmark:"",SingleBookmarkSolid:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ProductionFloorManagement:"",ProductRelease:"",ProductVariant:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",GoToDashboard:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:""}};(0,l.K1)(n,t)}function v(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('".concat(e,"fabric-icons-8-6fdf1528.woff') format('woff')")},icons:{CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",RecycleBin:"",EmptyRecycleBin:"",Hide2:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",CRMProcesses:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",CRMServices:"",EditContact:"",ConnectContacts:"",AppIconDefaultAdd:"",AppIconDefaultList:"",ActivateOrders:"",DeactivateOrders:"",ProductCatalog:"",ScatterChart:"",AccountActivity:"",DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",PageShared:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",Compare:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",ChatBot:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolder:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",PhotoVideoMedia:"",AddFavorite:""}};(0,l.K1)(n,t)}function S(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('".concat(e,"fabric-icons-9-c6162b42.woff') format('woff')")},icons:{AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",GroupList:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",MuteChat:"",AddHome:"",AddWork:"",MobileReport:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",ToggleLeft:"",ToggleRight:"",TriangleShape:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogo:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:""}};(0,l.K1)(n,t)}function C(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('".concat(e,"fabric-icons-10-c4ded8e4.woff') format('woff')")},icons:{ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",Insert:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",Signin:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:""}};(0,l.K1)(n,t)}function b(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('".concat(e,"fabric-icons-11-2a8393d6.woff') format('woff')")},icons:{BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:""}};(0,l.K1)(n,t)}function E(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('".concat(e,"fabric-icons-12-7e945a1e.woff') format('woff')")},icons:{FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:"",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",CRMCustomerInsightsApp:"",EditCreate:"",PlayReverseResume:"",PlayReverse:"",SearchData:"",UnSetColor:"",DeclineCall:""}};(0,l.K1)(n,t)}function T(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('".concat(e,"fabric-icons-13-c3989a02.woff') format('woff')")},icons:{RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:""}};(0,l.K1)(n,t)}function w(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('".concat(e,"fabric-icons-14-5cf58db8.woff') format('woff')")},icons:{Snooze:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",GreetingCard:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:""}};(0,l.K1)(n,t)}function I(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('".concat(e,"fabric-icons-15-3807251b.woff') format('woff')")},icons:{CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",ReportWarning:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",BullseyeTarget:"",AnalyticsView:"",Video360Generic:"",Untag:"",Leave:"",Trending12:"",Blocked12:"",Warning12:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",VersionControlPush:"",StackedColumnChart2:"",TripleColumnWide:"",QuadColumn:"",WhiteBoardApp16:"",WhiteBoardApp32:"",PinnedSolid:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",TagUnknown12:"",TagUnknown12Mirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",BlockedSiteSolid12:"",TagSolid:"",OfficeChat:""}};(0,l.K1)(n,t)}function P(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('".concat(e,"fabric-icons-16-9cf93f3b.woff') format('woff')")},icons:{OfficeChatSolid:"",MailSchedule:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioOnlineLogoFill32:"",VisioOnlineLogo32:"",VisioOnlineLogoCloud32:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",GripperDotsVertical:"",MailAttached:"",AddIn:"",LinkedDatabase:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicOff2:"",MicrosoftTranslatorLogo:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",RemoveFromShoppingList:"",ShieldAlert:"",FabricTextHighlightComposite:"",Dataflows:"",GenericScanFilled:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",ShowGrid:"",SnapToGrid:"",ContactList:"",NewMail:"",EyeShadow:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:"",Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:""}};(0,l.K1)(n,t)}function _(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('".concat(e,"fabric-icons-17-0c4ed701.woff') format('woff')")},icons:{CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",MailOptions:"",Childof:"",Footer:"",Header:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",PlainText:"",AccessibiltyChecker:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",BulletedTreeList:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",AddReaction:"",ContactHeart:"",VisuallyImpaired:"",EventToDoLogo:"",Variable2:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2:"",Uneditable2Mirrored:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",PollResults:"",Rerun:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TrimStart:"",TrimEnd:"",TableComputed:"",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:""}};(0,l.K1)(n,t)}var A=function(){(0,l.aH)("trash","delete"),(0,l.aH)("onedrive","onedrivelogo"),(0,l.aH)("alertsolid12","eventdatemissed12"),(0,l.aH)("sixpointstar","6pointstar"),(0,l.aH)("twelvepointstar","12pointstar"),(0,l.aH)("toggleon","toggleleft"),(0,l.aH)("toggleoff","toggleright")};var k=n(22160);(0,n(77502).v)("@fluentui/font-icons-mdl2","8.5.55");var x="".concat(l.pD,"/assets/icons/"),N=(0,k.z)();var O,D,L,R=n(40389),F=n(14014),M=n(18384),B=n(12542),U=n(44632),z=n(72218),H=n(34045),G=n(54108),V=n(80202),j=n(99586),q=n(18758),W=n(63900),Y=n(55564),Q=window.pptTaskPaneStartTime,J=(new Date).getTime().toString(),X=!1,K=!1;function Z(){var e,t=null===(e=sessionStorage)||void 0===e?void 0:e.getItem("preloadCopilot");return!!t&&JSON.parse(t).isPreloaded}function $(e){var t;(null===(t=sessionStorage)||void 0===t?void 0:t.getItem("preloadCopilot"))&&ee(e)}function ee(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=sessionStorage)||void 0===e||e.setItem("preloadCopilot",JSON.stringify({isPreloaded:!0,isHidden:t}))}var te;(te=(0,r._)((function(){function e(){var e,t,n,r;(0,q.cY)("renderUIToScreen"),O=(new Date).getTime().toString(),(0,R.Ok)(),void 0===e&&(e=(null===(n=null==N?void 0:N.FabricConfig)||void 0===n?void 0:n.iconBaseUrl)||(null===(r=null==N?void 0:N.FabricConfig)||void 0===r?void 0:r.fontBaseUrl)||x),[c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_].forEach((function(n){return n(e,t)})),A(),s.render(a.createElement("div",null,a.createElement(F.Ay,null)),document.getElementById("container"))}return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(e){var t=function(){"undefined"!=typeof Office?e():setTimeout(t,50)};t()}))];case 1:return t.sent(),Office.onReady((function(t){(null==t?void 0:t.addin)?(t.addin.visibilityMode===z.HoP&&((0,q.cY)("hostAndPlatform.addin.visibilityMode: Hidden"),K=!0,(0,Y.bw)(Y.WT.IsTriggerPptVisualOperationEnabled)&&(0,W.E)(),Z()&&e(),L=(new Date).getTime().toString(),G.I.setValue({iteration:G.I.getValue().iteration+1})),Office.addin.onVisibilityModeChanged((function(e){(0,M.xH)(e.visibilityMode),e.visibilityMode===z.DwS?((0,q.cY)("Office.addin.onVisibilityModeChanged: Taskpane"),X&&(H.Vv.getSetting(H.zj.CopilotPaneStartTimestamp),X=!1),K=!1,U.B.getInstance().releaseHeldTelemetryEvents(),$(!1)):e.visibilityMode===z.HoP&&((0,q.cY)("Office.addin.onVisibilityModeChanged: Hidden"),$(!0),V.w.setValue({iteration:V.w.getValue().iteration+1}))}))):((0,q.cY)("hostAndPlatform.addin is null"),e())})),Office.actions.associate("ShowPreloadedCopilot",(function(e){if(X=!0,K=!1,null==e?void 0:e.copilotPaneStartTimestamp){var t=e.copilotPaneStartTimestamp;(0,M.Nx)(t),H.Vv.setHostSettings(e)}var n;j.U.setValue({iteration:j.U.getValue().iteration+1}),U.B.getInstance().sendChatEventTelemetry((0,M.pN)((n={},(0,o._)(n,B.h3.ChatEventType,B.a5.ShowPreloadedCopilot),(0,o._)(n,B.h3.ChatEventParameters,(new Date).getTime()),n))),Office.addin.showAsTaskpane()})),Office.actions.associate("PreloadCopilot",(function(){D=(new Date).getTime().toString(),ee(),e()})),[2]}}))})),function(){return te.apply(this,arguments)})()},7567:(e,t,n)=>{"use strict";n.d(t,{Fd:()=>f,Jo:()=>r,Ms:()=>p});var r,o=n(43032),i=n(74292),a=n(79490),s=n(55564),l=n(72218),c=n(37745),u=n(18758),d=n(2061),p=l.u1i;function f(e){return h.apply(this,arguments)}function h(){return(h=(0,o._)((function(e){var t,n,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t=(new Date).getTime(),[4,(0,c.TN)()];case 1:return a.sent(),r=((new Date).getTime()-t)/1e3,(0,u.cY)("LoadCopilotStringsTask completed in : ".concat(r," sec")),[3,3];case 2:return n=a.sent(),(0,i._)(n,d.DYx)&&(0,u.cY)(n.message),[3,3];case 3:(0,d.Bp2)((0,s.be)(s.WT.LaunchThisVersionOfSDX.toString(),"")),a.label=4;case 4:return a.trys.push([4,7,,8]),(0,s.bw)(s.WT.IsFeedbackAppChatIntegrationEnabled)?[4,OfficeFirstParty.UserFeedback.GetInitializationData()]:[3,6];case 5:p=a.sent(),a.label=6;case 6:return[3,8];case 7:return o=a.sent(),(0,u.cY)("Error in OfficeFirstParty UserFeedback GetInitializationData ",o),[3,8];case 8:try{(0,s.bw)(s.WT.IsAcquirePluginsFromMosEnabled)&&!(0,s.bw)(s.WT.IsRichAPIForAcquirePluginsEnabled)&&d.BDr.getInstance().initializePrivateApi()}catch(e){(0,u.cY)("Error in AppChatPrivateApi initializePrivateApi ",e)}return e(!0),[2]}}))}))).apply(this,arguments)}},37745:(e,t,n)=>{"use strict";n.d(t,{TN:()=>f,hD:()=>u,xt:()=>c});var r=n(43032),o=n(79490),i=n(55564),a=n(43277),s=n(18758),l=n(2061);function c(){var e=p();return l.$nm.includes(e)||l.b_z.includes(e)}function u(e){return p()}function d(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e,(0,s.cY)("Loading Localized strings for Language: "+e+"Z"+t);var r=new Promise((function(e,r){n.onload=function(){e()},n.onerror=n.onabort=function(){var e=a.i.GetHostAppDisplayLanguage();r(new l.DYx(l._sV.FailedToLoadStrings,"Failed to load strings with mapped language = "+t+" and display language = "+e))}}));return document.head.appendChild(n),r}function p(){var e=a.i.GetHostAppDisplayLanguage(),t=new l.dDr;return t.IsTier2LanguageSupportEnabled=!0,t.IsTier2RTLLanguageEnabled=!0,t.IsTier3LanguagesEnabled=(0,i.bw)(i.WT.Tier3LanguageSupport),t.IsTier2Point5LanguagesEnabled=(0,i.bw)(i.WT.Tier2Point5LanguageSupport),t.getUserLanguage(e)}function f(){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(){var e,t,n,r,i;return(0,o.__generator)(this,(function(o){e=p().toLowerCase(),n=(t="office-online-strings")+"/"+e+"/powerpoint-copilot-strings.min.js",r=t+"/"+e+"/officeaicopilot-strings.min.js";try{return[2,Promise.all([d(n,e),d(r,e)])]}catch(t){throw i=a.i.GetHostAppDisplayLanguage(),new l.DYx(l._sV.FailedToLoadStrings,"Failed to load strings with mapped language = "+e+" and display language = "+i)}return[2]}))}))).apply(this,arguments)}},46866:(e,t,n)=>{"use strict";n.d(t,{LN:()=>y,N6:()=>p,mf:()=>h});var r,o=n(43032),i=n(79490),a=n(72218),s=n(43277),l=n(96447),c=n(18758),u=n(1543),d=n(39041);function p(e,t,n,r){var o=(0,u.b8)()&&(0,u.z4)()?n+a.tSR:n;OfficeFirstParty.UserFeedback.CollectUserFeedback(e,t,o,r)}var f,h=function(){r=document.activeElement},g=function(e){if((0,u.b8)()&&(0,u.z4)()&&e.length){var t="PPTWeb";switch(s.i.GetHostAppPlatform()){case a.nAd:t="PPTWin32";break;case a.xb6:t="PPTMac";break;case a.TTX:t="PPTiOS"}(0,c.cY)("initiating feedback signal for "+t),(0,l.W)(e,t).finally((function(){(0,c.cY)("Feedback diagnostic data upload signal called")}))}},m=(f=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return(0,c.cY)("Feedback was ".concat(e?"sent":"not sent",".")),(0,c.cY)("Adding delay of 2 sec before setting focus"),[4,(0,d.uk)(2e3)];case 1:return t.sent(),r&&r.focus(),[2]}}))})),function(e){return f.apply(this,arguments)}),y=function(){var e=(0,o._)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,c.cY)("Register OfficeFirstParty On Submit feedback response event"),[4,OfficeFirstParty.UserFeedback.onUserFeedbackResponse(g)];case 1:return e.sent(),(0,c.cY)("Register OfficeFirstParty feedback dismissed event"),[4,OfficeFirstParty.UserFeedback.onUserFeedbackUIDismissed(m)];case 2:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}()},72807:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(72218),o=n(39726),i=function(){return new Map([[o.Ae.CreatePresentation,[PowerpointCopilotStrings.LoadingUIGettingEverythingReadyStep,PowerpointCopilotStrings.LoadingUIAddingTextStep2,PowerpointCopilotStrings.LoadingUITextIntentStep2,PowerpointCopilotStrings.LoadingUISlideIntentStep4,PowerpointCopilotStrings.LoadingUISlideIntentStep3,PowerpointCopilotStrings.LoadingUiFinishingUpStep]],[o.Ae.AddSlides,[PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.AddImage,[PowerpointCopilotStrings.LoadingUISearchingImages,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIMakingChanges,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.AddText,[PowerpointCopilotStrings.LoadingUICreatingADraft,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.RewriteText,[PowerpointCopilotStrings.LoadingUIRewritingTextStep1,PowerpointCopilotStrings.LoadingUIRewritingTextStep2,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.ChangeStyle,[PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIMakingChanges,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.PresentationSummary,[PowerpointCopilotStrings.LoadingUIWorkingOnIt,PowerpointCopilotStrings.LoadingUIScanningTheDeck,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUIGeneratingTheSummary,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.PresentationSummaryWithVisual,[r.hdV,r.aBH,r.hUI,r.agv,r.VDh]],[o.Ae.ImportantSlides,[PowerpointCopilotStrings.LoadingUIWorkingOnIt,PowerpointCopilotStrings.LoadingUIScanningTheDeck,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.CallToAction,[PowerpointCopilotStrings.LoadingUIWorkingOnIt,PowerpointCopilotStrings.LoadingUIScanningTheDeck,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[o.Ae.TransformDocument,[PowerpointCopilotStrings.LoadingUITransformingDocumentStep1,PowerpointCopilotStrings.LoadingUITransformingDocumentStep2,PowerpointCopilotStrings.LoadingUITransformingDocumentStep3,PowerpointCopilotStrings.LoadingUITransformingDocumentStep4]],[o.Ae.OrganizePresentation,[PowerpointCopilotStrings.LoadingUIOrganizePresentationStep1,PowerpointCopilotStrings.LoadingUIOrganizePresentationStep2,PowerpointCopilotStrings.LoadingUIOrganizePresentationStep3,PowerpointCopilotStrings.LoadingUIOrganizePresentationStep4]],[o.Ae.UserCancellation,[PowerpointCopilotStrings.CancellingLabel]],[o.Ae.Default,[PowerpointCopilotStrings.LoadingUIWorkingOnResponseForYou,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUISlideIntentStep4]]])}},5851:(e,t,n)=>{"use strict";n.d(t,{A:()=>r.A});var r=n(72807)},18758:(e,t,n)=>{"use strict";n.d(t,{$1:()=>A,M$:()=>k,R3:()=>v,X9:()=>b,Yy:()=>x,Zi:()=>I,cY:()=>C,gu:()=>w,h:()=>m,k7:()=>y,nM:()=>E,sQ:()=>_,sZ:()=>N,vX:()=>T,zU:()=>P});var r=n(43032),o=n(79490),i=n(2061),a=n(55564),s=n(34045),l=n(72218),c=n(65917),u=n(39041),d=n(52174),p=n(21659),f=n(1543),h=n(4277),g=n(58651),m=function(){var e,t=(0,l.QjY)();return t[(e=t.length,Math.floor(Math.random()*e))]},y=function(){return PowerpointCopilotStrings.PartialSuccessErrorMessage};function v(e){for(var t,n=e.length;0!==n;){var r;t=Math.floor(Math.random()*n),n--,r=[e[t],e[n]],e[n]=r[0],e[t]=r[1]}return e}var S,C=function(e,t){(l.MYv||(0,s.I_)())&&(null==t?g.log("ChatPPT Log:",e):g.log("ChatPPT Log:",e,t))},b=(S=(0,r._)((function(e,t){var n,r,a,s,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t?[3,2]:[4,fetch(e)];case 1:return r=o.sent(),[3,4];case 2:return[4,(0,i.zRu)(h.gf,e,t)];case 3:r=o.sent(),o.label=4;case 4:if(!(n=r)||n&&!n.ok)throw a="toDataUrl: Could not fetch image at ".concat(e),C(a),new Error(a);o.label=5;case 5:return o.trys.push([5,7,,8]),[4,n.blob()];case 6:return s=o.sent(),[2,new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result.toString())},n.onerror=function(){return t()},n.readAsDataURL(s)}))];case 7:throw o.sent(),l="toDataUrl: Could not get base64 encoding of image at ".concat(e),C(l),new Error(l);case 8:return[2]}}))})),function(e,t){return S.apply(this,arguments)}),E=function(e){var t=e.match(/^data:image\/([a-zA-Z]+);base64,/);if(t&&2===t.length){var n=t[1];if(["jpeg","png"].includes(n))return e.replace(t[0],"")}return""},T=function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,new Promise((function(t,n){var r=new Image;r.onload=function(){t({height:r.height,width:r.width})},r.onerror=function(){n("Could not load image to calculate size")},r.src=e}))]}))}));return function(t){return e.apply(this,arguments)}}(),w=function(e){var t={actionFound:!1};return e=e.toLowerCase(),(0,l.KdH)().some((function(n){return n.phrases.some((function(t){return t.split(",").every((function(t){return e.includes(t)}))}))&&(t={actionFound:!0,actionType:n.actionType,responseHeader:n.responseHeader,response:n.response}),t.actionFound})),t},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";return e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e},P=(function(){var e=(0,r._)((function(e){var t,n,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(n=null===(t=document.getElementById(e))||void 0===t?void 0:t.textContent)?[4,navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([n],{type:"text/plain"})})])]:[3,2];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:return r=o.sent(),C("An error occurred while copying text to clipboard:",r.message),[3,4];case 4:return[2]}}))}))}(),function(e,t,n){var r=[],o=-1;for(v(e);r.length<t&&o<e.length;)o++,r.find((function(t){return t===e[o%e.length]}))||n.find((function(t){return t===e[o%e.length]}))||r.push(e[o%e.length]);return r});function _(e){return C("UserType: ".concat(e,", ").concat(s.Vv.getSettingAsString(s.zj.PPTIsConsumerUserAndLicensed))),(0,u.hX)(e)||e===i.utd.Unknown?!(!(0,u.hX)(s.Vv.getSettingAsString(s.zj.PPTIsConsumerUserAndLicensed))&&(0,a.PA)(a.IY.IsUserTypeFromHostSettingsEnabled))||"false"!==s.Vv.getSettingAsString(s.zj.PPTIsConsumerUserAndLicensed).toLowerCase():e===i.utd.Consumer}function A(e){return e===i.utd.Enterprise||!_(e)}function k(){return(0,f.H_)()&&(0,a.bw)(a.WT.IsAllEntitiesSupported)&&(0,a.PA)(a.IY.IsUnsupportedEntitiesEnabled)}function x(e,t){if(e<1||t<(0,p.i$)())return!1;var n=c._.getInstance().getDocumentState().hasSection;return!(!(0,d.r)()&&n)}function N(){var e;null===(e=window.document.getElementById(l.OsU))||void 0===e||e.style.setProperty("display","none")}},61339:(e,t,n)=>{"use strict";n.d(t,{R:()=>c});var r=n(11912),o=n(91165),i=n(90813),a=n(69038),s=n(72218),l=n(39041),c=function(){function e(){(0,r._)(this,e),(0,i._)(this,"isWarningMessageActive",!1),(0,i._)(this,"warningCardDisplayTimeInMs",void 0),(0,i._)(this,"warningCardUserInteractionTimeInSec",void 0),(0,i._)(this,"shouldAccountForWarningCardUserInteractionLatency",!1),(0,i._)(this,"cachedRequestParameters",{prompt:"",sources:[],groundingInfo:""}),this.isWarningMessageActive=!1,this.shouldAccountForWarningCardUserInteractionLatency=!1,this.warningCardDisplayTimeInMs=0,this.warningCardUserInteractionTimeInSec=0}return(0,o._)(e,[{key:"setWarningMessageActive",value:function(e){this.isWarningMessageActive=e}},{key:"getIsWarningMessageActive",value:function(){return this.isWarningMessageActive}},{key:"setCachedRequestParameters",value:function(e,t,n){this.cachedRequestParameters.prompt=null!=e?e:s.u1i,this.cachedRequestParameters.sources=null!=t?t:[],this.cachedRequestParameters.groundingInfo=null!=n?n:s.u1i}},{key:"getCachedRequestParameters",value:function(){return this.cachedRequestParameters}},{key:"resetCachedRequestParameters",value:function(){this.cachedRequestParameters.prompt=s.u1i,this.cachedRequestParameters.sources=[],this.cachedRequestParameters.groundingInfo=s.u1i}},{key:"setWarningCardDisplayTimeInMs",value:function(){this.warningCardDisplayTimeInMs=(new Date).getTime()}},{key:"getWarningCardDisplayTimeInMs",value:function(){return this.warningCardDisplayTimeInMs}},{key:"getWarningCardUserInteractionTimeInSec",value:function(){return this.warningCardUserInteractionTimeInSec}},{key:"setWarningCardUserInteractionTimeInSec",value:function(){this.warningCardUserInteractionTimeInSec=(0,a.WU)(this.warningCardDisplayTimeInMs)}},{key:"getShouldAccountForWarningCardUserInteractionLatency",value:function(){return this.shouldAccountForWarningCardUserInteractionLatency}},{key:"setShouldAccountForWarningCardUserInteractionLatency",value:function(e){this.shouldAccountForWarningCardUserInteractionLatency=e}},{key:"resetWarningCardLatencyParameters",value:function(){this.shouldAccountForWarningCardUserInteractionLatency=!1,this.warningCardDisplayTimeInMs=0,this.warningCardUserInteractionTimeInSec=0}}],[{key:"getInstance",value:function(){return(0,l.hX)(e.warningMessageStateHandler)&&(e.warningMessageStateHandler=new e),e.warningMessageStateHandler}}]),e}();(0,i._)(c,"warningMessageStateHandler",void 0)},57308:(e,t,n)=>{"use strict";n.d(t,{Cr:()=>w,Hg:()=>r,Iw:()=>P,Jw:()=>c,Lg:()=>E,NV:()=>_,R7:()=>u,_5:()=>v,_t:()=>g,bq:()=>C,f6:()=>I,g3:()=>h,r_:()=>y,sw:()=>m,z:()=>b,zd:()=>S});var r,o=n(48544),i=n(55564),a=n(26940),s=n(18758),l=n(39726);function c(e){return(null==e?void 0:e.locale)&&(r=e.locale),(0,i.Ik)()?"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType||e.messageType===a.n3.RenderCardRequest||e.messageType===a.n3.RequireHumanInTheLoop)||!1:"bot"===e.author&&e.adaptiveCards&&(void 0===e.messageType||"Chat"===e.messageType||e.messageType===a.n3.RenderCardRequest||e.messageType===a.n3.RequireHumanInTheLoop)||!1}function u(e){return"bot"===e.author&&e.messageType===a.n3.Disengaged}function d(e){var t;return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&(null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase())===l.wz.COPILOT_POWERPOINT_SUMMARY}function p(e){var t;return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&(null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase())===l.wz.COPILOT_POWERPOINT_SPEAKER_NOTES}function f(e){var t;return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&(null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase())===l.wz.COPILOT_POWERPOINT_TRANSLATION}function h(e){return e===l.wz.PERSONALIZATION_START||e===l.wz.PERSONALIZATION_END||e===l.wz.PERSONALIZATION_EXPLAIN||e===l.wz.PERSONALIZATION_UPDATE||e===l.wz.PERSONALIZATION_FORCED_DELETE}function g(e){var t;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return function(e){return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===l.wz.BASIC_CHAT}(e)}))}function m(e){var t;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return function(e){return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===l.wz.SUMMARIZE}(e)}))}function y(e){var t,n;return e.chatResponse.messages?null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return d(e)})):e.chatResponse.messagesToAddOrReplace?null===(n=e.chatResponse.messagesToAddOrReplace)||void 0===n?void 0:n.find((function(e){return d(e)})):void 0}function v(e){var t,n;return e.chatResponse.messages?null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return p(e)})):e.chatResponse.messagesToAddOrReplace?null===(n=e.chatResponse.messagesToAddOrReplace)||void 0===n?void 0:n.find((function(e){return p(e)})):void 0}function S(e){var t,n;if(e.chatResponse)return e.chatResponse.messages?null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return f(e)})):e.chatResponse.messagesToAddOrReplace?null===(n=e.chatResponse.messagesToAddOrReplace)||void 0===n?void 0:n.find((function(e){return f(e)})):void 0}function C(e){return e.messageType===a.n3.InternalSearchQuery||e.messageType===a.n3.InternalLoaderMessage}function b(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;"Suggestion"===s.messageType&&t.push(s.text)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}function E(e){e.conversationId&&(0,s.cY)("conversation id from PowerPoint Flux Copilot: "+e.conversationId)}var T=new Map([[a.YA.PowerPoint,o._R.PowerPoint],[a.YA.Excel,o._R.Excel],[a.YA.Word,o._R.Word],[a.YA.OneNote,o._R.OneNote],[a.YA.Outlook,o._R.Outlook],[a.YA.Teams,o._R.Teams],[a.YA.Event,o._R.Event],[a.YA.Meeting,o._R.Meeting],[a.YA.TeamsMeeting,o._R.Meeting],[a.YA.SharePoint,o._R.SharePoint],[a.YA.PDF,o._R.Pdf],[a.YA.Zip,o._R.Pdf],[a.YA.Visio,o._R.Visio],[a.YA.Fluid,o._R.Loop],[a.YA.Txt,o._R.Txt]]);function w(e,t,n){return(0,i.bw)(i.WT.IsCitationSupportForAvalonEnabled)?(null==n?void 0:n.path)?o._2.Internal:e===a.YA.Web||void 0===e?o._2.External:void 0!==e&&Object.values(o._R).includes(e)?o._2.CrossApp:o._2.External:void 0===t?o._2.External:(null==n?void 0:n.path)&&!(null==n?void 0:n.seeMoreUrl)?o._2.Internal:T.has(t)?o._2.CrossApp:o._2.External}function I(e){if(void 0!==e)return T.has(e)?T.get(e):void 0}function P(e){if(void 0!==e)return Object.values(o._R).includes(e)?e:void 0}var _=function(e){return e.length>150?e.substring(0,150)+'..."':e}},82808:(e,t,n)=>{"use strict";n.d(t,{A:()=>T});var r=n(11912),o=n(91165),i=n(90813),a=n(48544),s=n(93176),l=n(72218),c=n(69038),u=n(18758),d=n(55564),p=n(41853),f=n(72468),h=n(39041),g=n(18384),m=n(12542),y=n(2061),v=n(44632),S=n(39726),C=n(85612);var b=v.B.getInstance(),E=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"updateActiveCardForInProgressNotification",value:function(e,t,n){var r,o,s,c,d,p,v=this,C=arguments.length>3&&void 0!==arguments[3]&&arguments[3],E=null!==(s=null===(r=(0,f.ox)(e))||void 0===r?void 0:r.messageID)&&void 0!==s?s:l.u1i;if((0,h.hX)(E)||E===l.u1i)return(0,u.cY)("No message Id to update card for inprogressNotification, queryId: ".concat(e)),b.sendErrorTelemetry((0,g.pN)((p={},(0,i._)(p,m.h3.UserQueryGuid,e),(0,i._)(p,m.IC.ErrorMessage,l.eUJ),(0,i._)(p,m.IC.ErrorCategory,m.S2.Notification),(0,i._)(p,m.CT.ErrorType,S.T_.Client),(0,i._)(p,m.IC.UniqueActionId,null!==(d=null===(c=(0,f.ox)(e))||void 0===c?void 0:c.uniqueActionID)&&void 0!==d?d:l.u1i),p))),null;(0,u.cY)("updating card for in progress Notification");var T={loadingMessage:(0,l.GEA)(),loadingSpinnerLabel:this.getLabelFromPreviewMessage(n),loadingState:a.Kg.InProgress};this.updateMessageForNotification(t,T,E);var w,I,P,_,A,k,x,N,O=(P=e,w=function(){(0,u.cY)("Timer expired for updatingCardForNotification"),(0,u.cY)("queryId: ".concat(P,", value : ").concat((0,f.ox)(P))),v.updateActiveCardForInFailureNotification(P,t,l.RC5)},I=l.dGJ,setTimeout(w,I));C&&b.sendChatEventTelemetry((0,g.pN)((k={},(0,i._)(k,m.h3.UserQueryGuid,e),(0,i._)(k,m.h3.ChatEventType,m.a5.NotificationCardUpdated),(0,i._)(k,m.h3.ChatEventParameters,null!=n?n:l.u1i),(0,i._)(k,m.h3.NotificationState,y.W$G.IN_PROGRESS),(0,i._)(k,m.h3.UniqueActionId,null!==(A=null===(_=(0,f.ox)(e))||void 0===_?void 0:_.uniqueActionID)&&void 0!==A?A:l.u1i),k)),void 0);return b.sendChatEventTelemetry((0,g.pN)((N={},(0,i._)(N,m.h3.UserQueryGuid,e),(0,i._)(N,m.h3.ChatEventType,m.a5.SetNotificationTimer),(0,i._)(N,m.h3.UniqueActionId,null!==(x=null===(o=(0,f.ox)(e))||void 0===o?void 0:o.uniqueActionID)&&void 0!==x?x:l.u1i),(0,i._)(N,m.h3.ChatEventParameters,O?O.toString():l.u1i),N)),void 0),O}},{key:"updateActiveCardForCompleteNotification",value:function(e,t,n){var r,o,s,d,v,E=arguments.length>3&&void 0!==arguments[3]&&arguments[3],T=null!==(o=null===(r=(0,f.ox)(e))||void 0===r?void 0:r.messageID)&&void 0!==o?o:l.u1i;if((0,h.hX)(T)||T===l.u1i)return(0,u.cY)("No message Id to update card for completeNotification, messgaeId: ".concat(T)),b.sendErrorTelemetry((0,g.pN)((v={},(0,i._)(v,m.h3.UserQueryGuid,e),(0,i._)(v,m.IC.ErrorMessage,l.hrI),(0,i._)(v,m.IC.ErrorCategory,m.S2.Notification),(0,i._)(v,m.CT.ErrorType,S.T_.Client),(0,i._)(v,m.IC.UniqueActionId,null!==(d=null===(s=(0,f.ox)(e))||void 0===s?void 0:s.uniqueActionID)&&void 0!==d?d:l.u1i),v))),null;(0,u.cY)("updating card for complete Notification");var w,I,P,_,A,k,x,N={loadingMessage:(0,l.GEA)(),successButtonProps:{successButtonIconRegular:p.P60,successButtonIconHover:p.P60,successButtonText:null!=n?n:(0,l.psP)(),successButtonOnClick:f.zH},loadingState:a.Kg.Success};(this.updateMessageForNotification(t,N,T),E)&&(b.sendChatEventTelemetry((0,g.pN)((A={},(0,i._)(A,m.h3.UserQueryGuid,e),(0,i._)(A,m.h3.ChatEventType,m.a5.NotificationCardUpdated),(0,i._)(A,m.h3.ChatEventParameters,l.OpF),(0,i._)(A,m.h3.NotificationState,y.W$G.COMPLETED),(0,i._)(A,m.h3.UniqueActionId,null!==(_=null===(w=(0,f.ox)(e))||void 0===w?void 0:w.uniqueActionID)&&void 0!==_?_:l.u1i),(0,i._)(A,m.h3.UsedVDPercentage,(0,C.EJ)(e)),A)),void 0),b.sendLatencyTelemetryForNotifications((0,g.pN)((x={},(0,i._)(x,m.CT.LastNotificationReceivedTime,(0,c.WU)(null===(I=(0,f.ox)(e))||void 0===I?void 0:I.querySubmissionTime)),(0,i._)(x,m.CT.FeatureName,m.S2.Notification),(0,i._)(x,m.CT.SubFeatureName,m.Ff.VisualSummary),(0,i._)(x,m.CT.UniqueActionId,null!==(k=null===(P=(0,f.ox)(e))||void 0===P?void 0:P.uniqueActionID)&&void 0!==k?k:l.u1i),x)),e,E))}},{key:"disableSuccessButton",value:function(){var e,t,n,r,o,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.u1i,c=arguments.length>1?arguments[1]:void 0,d=null!==(t=null===(e=(0,f.ox)(s))||void 0===e?void 0:e.messageID)&&void 0!==t?t:l.u1i;if((0,h.hX)(d)||d===l.u1i)return(0,u.cY)("No message Id to disable success button, queryId: ".concat(s)),b.sendErrorTelemetry((0,g.pN)((o={},(0,i._)(o,m.h3.UserQueryGuid,s),(0,i._)(o,m.IC.ErrorMessage,l.MEV),(0,i._)(o,m.IC.ErrorCategory,m.S2.Notification),(0,i._)(o,m.CT.ErrorType,S.T_.Client),(0,i._)(o,m.IC.UniqueActionId,null!==(r=null===(n=(0,f.ox)(s))||void 0===n?void 0:n.uniqueActionID)&&void 0!==r?r:l.u1i),o))),null;(0,u.cY)("disabling success button");var y={loadingMessage:(0,l.GEA)(),successButtonProps:{isDisabled:!0,successButtonIconRegular:p.P60,successButtonIconHover:p.P60,successButtonText:(0,l.psP)()},loadingState:a.Kg.Success};this.updateMessageForNotification(c,y,d)}},{key:"updateActiveCardForInFailureNotification",value:function(e,t,n){var r,o,s,d,p,v,C,E,T,w=null!==(v=null===(r=(0,f.ox)(e))||void 0===r?void 0:r.messageID)&&void 0!==v?v:l.u1i;if((0,h.hX)(w)||w===l.u1i)return(0,u.cY)("No message Id to update card for completeNotification, queryId: ".concat(e)),b.sendErrorTelemetry((0,g.pN)((T={},(0,i._)(T,m.h3.UserQueryGuid,e),(0,i._)(T,m.IC.ErrorMessage,l.tWQ),(0,i._)(T,m.IC.ErrorCategory,m.S2.Notification),(0,i._)(T,m.CT.ErrorType,S.T_.Client),(0,i._)(T,m.IC.UniqueActionId,null!==(E=null===(C=(0,f.ox)(e))||void 0===C?void 0:C.uniqueActionID)&&void 0!==E?E:l.u1i),T))),null;(0,u.cY)("updating card for failure Notification");var I,P,_,A,k,x,N={loadingMessage:(0,l.GEA)(),failureText:(0,l.KY_)(),loadingState:a.Kg.Failure};this.updateMessageForNotification(t,N,w),b.sendChatEventTelemetry((0,g.pN)((P={},(0,i._)(P,m.h3.UserQueryGuid,e),(0,i._)(P,m.h3.ChatEventType,m.a5.NotificationError),(0,i._)(P,m.h3.ChatEventParameters,null!=n?n:l.u1i),(0,i._)(P,m.h3.UniqueActionId,null!==(I=null===(o=(0,f.ox)(e))||void 0===o?void 0:o.uniqueActionID)&&void 0!==I?I:l.u1i),(0,i._)(P,m.h3.NotificationState,"".concat(y.W$G.FAILED)),(0,i._)(P,m.h3.ChatErrorType,S.T_.Server),P)),void 0),b.sendErrorTelemetry((0,g.pN)((A={},(0,i._)(A,m.h3.UserQueryGuid,e),(0,i._)(A,m.IC.ErrorMessage,null!=n?n:l.u1i),(0,i._)(A,m.IC.ErrorCategory,m.S2.Notification),(0,i._)(A,m.CT.ErrorType,S.T_.Server),(0,i._)(A,m.IC.UniqueActionId,null!==(_=null===(s=(0,f.ox)(e))||void 0===s?void 0:s.uniqueActionID)&&void 0!==_?_:l.u1i),A))),b.sendLatencyTelemetryForNotifications((0,g.pN)((x={},(0,i._)(x,m.CT.LastNotificationReceivedTime,(0,c.WU)(null===(d=(0,f.ox)(e))||void 0===d?void 0:d.querySubmissionTime)),(0,i._)(x,m.CT.FeatureName,m.S2.Notification),(0,i._)(x,m.CT.SubFeatureName,m.Ff.VisualSummary),(0,i._)(x,m.CT.UniqueActionId,null!==(k=null===(p=(0,f.ox)(e))||void 0===p?void 0:p.uniqueActionID)&&void 0!==k?k:l.u1i),x)),e,!0),(0,f.Hv)(e)}},{key:"updateMessageForNotification",value:function(e,t,n){var r;null===(r=e.current)||void 0===r||r.updateMessage({chatCardType:(0,d.bw)(d.WT.IsMarkdownSummarizationEnabled)?(0,d.D$)()?s._.ChatCardWrapper:s._.MarkdownCard:s._.Default,chatMessageBodyData:{progressSpinnerData:t,messageId:n},addCardToChatHistory:!1})}},{key:"getLabelFromPreviewMessage",value:function(e){var t=(0,l.cbD)().find((function(t){return t.key===e}));return t?t.value:(0,l.DjU)()}},{key:"clearTimerForNotification",value:function(e,t){var n,r,o;b.sendChatEventTelemetry((0,g.pN)((o={},(0,i._)(o,m.h3.UserQueryGuid,e),(0,i._)(o,m.h3.ChatEventType,m.a5.ClearNotificationTimer),(0,i._)(o,m.h3.ChatEventParameters,t?t.toString():l.u1i),(0,i._)(o,m.IC.UniqueActionId,null!==(r=null===(n=(0,f.ox)(e))||void 0===n?void 0:n.uniqueActionID)&&void 0!==r?r:l.u1i),o)),void 0),null!==t?((0,u.cY)("clearing timer for Notification: ".concat(t)),clearTimeout(t)):(0,u.cY)("timer id is null")}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(E,"instance",void 0);const T=E.getInstance()},34045:(e,t,n)=>{"use strict";n.d(t,{IZ:()=>h,I_:()=>v,TB:()=>S,Vv:()=>f,zj:()=>r});var r,o=n(43032),i=n(11912),a=n(91165),s=n(79490),l=n(18758),c=n(55564),u=n(32854),d=n(39041);!function(e){e.AugLoopCloudALServiceUrl="AugloopClouldALServiceUrl",e.ChatPPTSessionID="ChatPPTSessionID",e.AugloopSharedSessionID="AugloopSharedSessionID",e.PPTCreatorEnabled="PPTCreatorEnabled",e.PPTClientOrigin="PPTClientOrigin",e.PPTHandoffMessageId="HandoffMessageId",e.PPTHandoffMessage="HandoffMessage",e.PPTCopilotSearchEnabled="PPTCopilotSearchEnabled",e.PPTShowSuggestionsPill="PPTShowSuggestionsPill",e.PPTCIQDocMenuEnabled="PPTCIQDocMenuEnabled",e.PPTCopilotScnInsertImage="PPTCopilotScnInsertImage",e.PPTCopilotTextToImageEnabled="PPTCopilotEnableTextToImage",e.PPTStoryTellerExecutionResponse="PPTStoryTellerExecutionResponse",e.PPTEnableFluentVisualRefresh="PPTEnableFluentVisualRefresh",e.PPTCopilotScnCreatePresFromDoc="PPTCopilotScnCreatePresFromDoc",e.PPTCopilotScnCreatePresFromPrompt="PPTCopilotScnCreatePresFromPrompt",e.PPTCopilotScnAddSlide="PPTCopilotScnAddSlide",e.PPTCopilotScnAnimate="PPTCopilotScnAnimate",e.PPTCopilotScnOrganize="PPTCopilotScnOrganize",e.PPTCopilotDebugJOfcPayload="PPTCopilotDebugJOfcPayload",e.PPTCopilotScnBeautify="PPTCopilotScnBeautify",e.PPTCopilotScnCreatePresQueryAppState="PPTCopilotScnCreatePresQueryAppState",e.PPTDocumentState="PPTDocumentState",e.PPTBBPresOutlineEnabled="PPTBBPresOutlineEnabled",e.PPTContentGenerationDisabledByAdmin="PPTContentGenerationDisabledByAdmin",e.PPTCopilotUseScenarioOptionsTelemetry="PPTCopilotUseScenarioOptionsTelemetry",e.PPTJsonCmdAPIVersion="PPTJsonCmdAPIVersion",e.PPTIsConsumerUserAndLicensed="PPTIsConsumerUserAndLicensed",e.TriggerSummary="triggerSummary",e.TriggerCreatePresentationAbout="TriggerCreatePresentationAbout",e.TriggerCreatePresentationFromFile="TriggerCreatePresentationFromFile",e.TriggerAddASlide="TriggerAddASlide",e.TriggerCshCopilot="TriggerCshCopilot",e.FeedbackEnabled="FeedbackEnabled",e.InitiatorView="InitiatorView",e.PPTDocumentFileName="PPTDocumentFileName",e.AppStartTimestamp="AppStartTimestamp",e.CopilotPaneStartTimestamp="copilotPaneStartTimestamp",e.ProactiveSummarySignalEnabled="ProactiveSummarySignalEnabled",e.PPTCopilotAPISupportNotLogTriedKept="PPTCopilotAPISupportNotLogTriedKept"}(r||(r={}));var p=!1,f=function(){function e(){(0,i._)(this,e)}return(0,a._)(e,null,[{key:"getSettingAsString",value:function(e){var t=Office.context.hostSettings.get(e.toString());return(0,d.hX)(t)?t:"object"==typeof t?JSON.stringify(t):t.toString()}},{key:"getSetting",value:function(e){var t;return null===(t=Office.context.hostSettings)||void 0===t?void 0:t.get(e.toString())}},{key:"set",value:function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))}},{key:"setByKey",value:function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))}},{key:"setHostSettings",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=(0,d.gZ)(e[n]);t.setByKey(n,r)}))}},{key:"IsSettingTrue",value:function(e){var t=this.getSettingAsString(e);return!!t&&"true"===t.toLowerCase()}}]),e}();function h(){return g.apply(this,arguments)}function g(){return(g=(0,o._)((function(){var e,t;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return(0,c.sn)(c.WT.UseCanCollectCopilotFeedbackAPI)?[2,(0,u.S8)()]:[3,1];case 1:return e=!0,(t=f.getSettingAsString("FeedbackEnabled"))?(e="true"===t.toLowerCase(),[3,4]):[3,2];case 2:return[4,m()];case 3:e=n.sent(),n.label=4;case 4:return(0,l.cY)("Feedback Button View Enabled: "+e),[2,e];case 5:return[2]}}))}))).apply(this,arguments)}function m(){return y.apply(this,arguments)}function y(){return(y=(0,o._)((function(){var e,t;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:e=!0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.UserFeedback.CanCollectUserFeedback()];case 2:return e=n.sent(),(0,l.cY)("OfficeFirstParty CanCollectUserFeedback : "+e),[3,4];case 3:return t=n.sent(),(0,l.cY)("Error in OfficeFirstParty CanCollectUserFeedback : ",t),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function v(){return!!p||!((0,d.hX)(f.getSettingAsString("AugloopClouldALServiceUrl"))||!f.getSettingAsString("AugloopClouldALServiceUrl").includes("dogfood"))&&(p=!0,!0)}function S(){var e=f.getSettingAsString("AugloopClouldALServiceUrl");return!!(null==e?void 0:e.toLowerCase().includes("augloop-gcc"))&&((0,l.cY)("Environment is GCC"),!0)}},47941:(e,t,n)=>{"use strict";n.d(t,{Dt:()=>c,Os:()=>l,Zw:()=>r,iU:()=>f,ky:()=>h});var r,o=n(98483),i=n(39041),a=n(18758),s=n(34308),l=(0,o.A)(),c=function(){return""},u="ALDummySession",d=u,p=function(){return(0,i.hX)(d)?u:d},f=function(e){(0,a.cY)("setting doc session id:",e),(0,i.hX)(e)||(d=e)},h=function(){return((0,i.hX)(r)||r.isClosed)&&((0,a.cY)("getting AL session for doc session id:",p()),r=(0,s.wB)(p())),r}},66888:(e,t,n)=>{"use strict";n.d(t,{r:()=>a});var r=n(11912),o=n(91165),i=n(90813),a=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"generateId",value:function(){return e.operationId++,"AugLoopChatPPT"+e.operationId.toString()}}]),e}();(0,i._)(a,"operationId",0)},12063:(e,t,n)=>{"use strict";n.d(t,{U:()=>u});var r=n(43032),o=n(11912),i=n(91165),a=n(90813),s=n(79490),l=n(39041),c=n(18758),u=function(){function e(){(0,o._)(this,e)}return(0,i._)(e,null,[{key:"addImage",value:function(t){e.images.push(t)}},{key:"findImageDataArrayFromDescription",value:function(t,n){return(0,r._)((function(){return(0,s.__generator)(this,(function(r){switch(r.label){case 0:return(0,c.cY)("findImageDataArrayFromDescription: "+t+" "+n),[4,(0,l.ue)((function(){var r=e.images.filter((function(e){return e.description===t}));return r.length>=n?(e.images=e.images.filter((function(e){return e.description!==t})),Promise.resolve(r)):Promise.reject(new Error("Image not found"))}),15,200)];case 1:return[2,r.sent()]}}))}))()}},{key:"findImageDataFromDescription",value:function(t){return(0,r._)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,l.ue)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!==n){var r=e.images.splice(n,1);return Promise.resolve(r[0])}return Promise.reject(new Error("Image not found"))}),15,200)];case 1:return[2,n.sent()]}}))}))()}},{key:"findImageUrlFromDescription",value:function(t){return(0,r._)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,l.ue)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!==n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return[2,n.sent()]}}))}))()}},{key:"insertImage",value:function(t){return(0,r._)((function(){var n,r;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,(0,l.ue)((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!==n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return(n=o.sent())?[3,2]:((0,c.cY)("insertImageFromAl: Could not find image matching description"),[2,void 0]);case 2:return o.trys.push([2,4,,5]),[4,(0,c.X9)(n)];case 3:return[2,o.sent()];case 4:return o.sent(),(0,c.cY)("failed to fetch image from url and encode it as base64"),[2,void 0];case 5:return[3,7];case 6:return r=o.sent(),(0,c.cY)("insertImageFromAl: Could not find image matching description error: "+r+":"+(null==r?void 0:r.message)),[2,void 0];case 7:return[2]}}))}))()}}]),e}();(0,a._)(u,"images",[])},19464:(e,t,n)=>{"use strict";n.d(t,{og:()=>l,xy:()=>c});var r=n(55564),o=n(1543),i=n(2061),a=n(99838),s=[r.WT.EnableNewZQMsForNewPresentation,r.WT.EnableNewZQMsForExistingPresentation,r.WT.enableProactiveZQMWithSuggestedQnA,r.WT.enableProactiveZQMWith3SAPISuggestions,r.WT.EnableInsightsCard,r.WT.IsQnASuggestionPillCachingEnabled];function l(){return{isSpaceRequiredAfterInput:(0,r.PA)(r.IY.IsSpaceRequiredAfterInput),isChatCardFactoryMemoizationEnabled:!0,isSccVoiceEnabled:(0,r.bw)(r.WT.IsSccVoiceEnabled),isSccReadAloudEnabled:(0,r.bw)(r.WT.IsSccReadAloudEnabled),isSccPromptSuggestionsEnabled:(0,r.bw)(r.WT.IsSccPromptSuggestionsEnabled),isSccCiqEnabled:!0,isCustomGPTsEnabled:(0,o.jO)(),isClaimsChallengeMessageInAnnotationEnabled:(0,r.PA)(r.IY.isClaimsChallengeMessageInAnnotationEnabled),isSccElaboratePromptEnabled:(0,r.PA)(r.IY.IsHydratedEntityEnabled)&&(0,r.bw)(r.WT.EnableElaboratedPrompt),isGroupedCopilotPluginEnabled:!(0,r.bw)(r.WT.ShowPluginsAsAgents)&&(0,r.PA)(r.IY.IsGroupedCopilotPluginEnabled),isCustomHandlingForChatHistoryEnabled:(0,r.bw)(r.WT.IsCustomHandlingForChatHistoryEnabled),isApiPluginsEnabled:(0,r.bw)(r.WT.IsApiPluginsEnabled),isInputMessageEnabled:(0,r.PA)(r.IY.IsInputMessageEnabled),isChatHistorySignalDeferred:(0,r.bw)(r.WT.IsChatHistorySignalDeferred),isSketchImageCardEnabled:(0,r.PA)(r.IY.IsSketchImageCardEnabled),isSketchImageResizeEnabled:(0,r.PA)(r.IY.IsSketchImageResizeEnabled),shouldRenderAllHyperLinks:(0,r.bw)(r.WT.ShouldRenderAllHyperLinks),isPasteUnfurlingEnabled:(0,r.bw)(r.WT.IsPasteUnfurlingEnabled),enableMorePlugins:(0,r.PA)(r.IY.EnableMorePlugins),useExternalAuthService:(0,r.PA)(r.IY.UseExternalAuthService),showSystemMessageOnPluginToggle:(0,r.PA)(r.IY.ShowSystemMessageOnPluginToggle),isDragDropWrapperEnabled:(0,r.PA)(r.IY.IsDragDropWrapperEnabled),isStringReplacementAnchorTagOverrideEnabled:(0,r.PA)(r.IY.IsStringReplacementAnchorTagOverrideEnabled),isViewMorePromptsIconV2Enabled:(0,r.bw)(r.WT.IsViewMorePromptsIconV2Enabled),isViewMorePromptsOneClickEnabled:(0,r.bw)(r.WT.IsViewMorePromptsOneClickEnabled),enableCreatePpcConnections:(0,r.bw)(r.WT.EnableCreatePpcConnections),isQueryWarmupSignalEnabled:(0,r.PA)(r.WT.IsQueryWarmupSignalEnabled),isQueryWarmupSignalEnabledOnChatPaneOpens:(0,r.PA)(r.WT.IsQueryWarmupSignalEnabledOnChatPaneOpens),isCreditsUIEnabled:(0,r.bw)(r.WT.IsCreditsUIInternalEnabled),isPluginStatePersist:!(0,r.bw)(r.WT.ShowPluginsAsAgents)&&(0,r.bw)(r.WT.IsPluginStatePersistEnabled),isPowerPlatformPluginsEnabled:(0,r.bw)(r.WT.IsPowerPlatformPluginsEnabled),shouldUseMsalSsoSilentLogin:(0,r.bw)(r.IY.ShouldUseMsalSsoSilentLogin),isChatClickForGPTsEnabled:(0,r.bw)(r.WT.IsChatClickForGPTsEnabled),showNewChatOnGPTItem:(0,r.bw)(r.WT.IsNewChatOnGPTItemsEnabled),enableNewChatOnlyOnCopilot:(0,r.bw)(r.WT.IsNewChatOnCopilotGPTItemEnabled),showPluginReferencesV3:(0,r.PA)(r.IY.ShowPluginReferencesV3),isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:(0,r.bw)(r.WT.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled),enableProactiveZQMWith3SAPISuggestions:(0,r.bw)(r.WT.enableProactiveZQMWith3SAPISuggestions),enableProactiveZQMWithSuggestedQnA:(0,r.bw)(r.WT.enableProactiveZQMWithSuggestedQnA),enableQueryBeforeAnnotationLoad:(0,r.bw)(r.WT.EnableQueryBeforeAnnotationLoad),isCloudFileUploadEnabled:(0,r.bw)(r.WT.IsCloudFileUploadEnabled),isLocalFileUploadEnabled:!1,enablePluginSearchInFlyout:(0,r.PA)(r.IY.EnablePluginSearchInFlyout),enableMorePluginHyperLinkInFlyout:(0,r.PA)(r.IY.EnableMorePluginHyperLinkInFlyout),isAttachmentListEnabled:(0,r.bw)(r.WT.IsAttachmentListEnabled),useUpdatedGroundingButtonTitle:(0,o.dV)()&&(0,r.bw)(r.WT.UseUpdatedGroundingButtonTitle),enableQueryEndOnGptSwitch:(0,r.PA)(r.IY.EnableQueryEndOnGptSwitch),promptInputLength:(0,r.Z8)(r.WT.PromptInputLength,i.RkY),isInterstitialConfirmationEnabled:(0,r.PA)(r.IY.EnableInterstitialAuthentication),isInterstitialAuthEnabled:(0,r.PA)(r.IY.EnableInterstitialAuthentication),enableSystemMessageActions:(0,r.bw)(r.WT.EnableSystemMessageActions),isOutputV2Enabled:(0,r.bw)(r.WT.isOutputV2Enabled),shouldUseHybridAppService:(0,r.PA)(r.IY.ShouldUseHybridAppService),isChatCardRendererMemoizationEnabled:(0,r.PA)(r.IY.IsChatCardRendererMemoizationEnabled),enableFileUrlUnFurlingWithGraphAPI:(0,r.bw)(r.WT.IsUrlUnfurlingUsingGraphAPIEnabled),maxVisibleAttachments:i.FqH,useResponsiveSystemMessage:(0,r.PA)(r.IY.UseResponsiveSystemMessage),shouldUseMsalLocalSilentFlag:(0,r.PA)(r.IY.ShouldUseMsalLocalSilentFlag),showPluginsAsAgents:(0,r.bw)(r.WT.ShowPluginsAsAgents),isAcquirePluginsFromMosEnabled:(0,r.bw)(r.WT.IsAcquirePluginsFromMosEnabled)||(0,r.dA)(),isHandoffButtonEnabled:(0,r.bw)(r.WT.IsHandoffButtonEnabled),isApiPluginsCardsEnabled:(0,r.bw)(r.WT.IsApiPluginsCardsEnabled),useCacheForGPTDetails:(0,r.PA)(r.IY.UseCacheForGPTDetails),stopMenuShimmerAfterFirstCall:(0,r.PA)(r.IY.StopMenuShimmerAfterFirstCall),enableSwitcherMenuV2:(0,r.bw)(r.WT.EnableSwitcherMenuV2),loadGptListOnCopilotIconClick:(0,r.bw)(r.WT.LoadGptListOnCopilotIconClick),isSaveSharePromptEnabled:(0,r.bw)(r.WT.IsSaveSharePromptEnabled),isSavePromptEnabled:(0,r.bw)(r.WT.IsSavePromptEnabled),isSharePromptEnabled:(0,r.bw)(r.WT.IsSharePromptEnabled),isDAOutputV2Enabled:(0,r.PA)(r.IY.IsDAOutputV2Enabled),isDABrandingEnabled:(0,r.PA)(r.WT.IsDACopilotBrandingEnabled),enableButtonHidingWithAtMention:(0,r.PA)(r.IY.EnableButtonHidingWithAtMention),shouldUseMsalGetTokenRequestCaching:(0,r.PA)(r.WT.ShouldUseMsalGetTokenRequestCaching),isFocusChatInputOnMount:!a.isSDXRenderingForPreload,isInsertImageEnabledForDAs:(0,r.bw)(r.WT.IsInsertImageEnabledForDAs),isRealtimeVoiceEnabled:(0,r.bw)(r.WT.IsRealtimeVoiceEnabled),isRealtimeVoiceChatHistoryEnabled:(0,r.bw)(r.WT.IsRealtimeVoiceChatHistoryEnabled),isRealtimeVoiceDynamicBufferSizeEnabled:(0,r.PA)(r.IY.IsRealtimeVoiceDynamicBufferSizeEnabled),realtimeVoicePlayerVersion:1,realtimeVoiceClientVersion:2,scrollToBottomThrottleDelay:(0,r.Z8)(r.WT.ScrollToBottomThrottleDelay,500),enableInsightsCard:(0,r.bw)(r.WT.EnableInsightsCard),addExtensibiltyDataToFeedbackOCV:(0,r.PA)(r.IY.AddExtensibiltyDataToFeedbackOCV),enableCustomWidthPropOnAC:(0,r.PA)(r.IY.IsCustomWidthPropOnACEnabled),restrictConversationStartersForDA:(0,r.PA)(r.IY.RestrictConversationStartersForDA),isALHookEnabled:(0,r.bw)(r.WT.IsALHookEnabled),isSimplifiedChatInputEnabled:(0,r.bw)(r.WT.IsUXRefreshEnabledForInput),isAddMenuUxRefreshEnabled:(0,r.bw)(r.WT.IsUXRefreshEnabledForInput)}}var c=function(){return u(s)},u=function(e){var t=[],n=!0,o=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var c=s.value,u=(0,r.sn)(c,!1),d="".concat(c).concat(u?i.u1i:":0");t.push(d)}}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}var p=t.join(";")+";";if(p.length>24e3){var f=(p=p.substring(0,24e3)).lastIndexOf(";");-1!==f&&(p=p.substring(0,f)),p+=";"}return p}},55564:(e,t,n)=>{"use strict";n.d(t,{D$:()=>k,Dl:()=>v,IY:()=>o,Ik:()=>h,JO:()=>S,PA:()=>y,V3:()=>C,V7:()=>P,WT:()=>r,Z8:()=>l,Z_:()=>T,_S:()=>g,az:()=>_,be:()=>u,bw:()=>p,dA:()=>d,jv:()=>b,n8:()=>f,pu:()=>x,qH:()=>w,sT:()=>c,sW:()=>A,sn:()=>s,ti:()=>I,tm:()=>E,wB:()=>m});var r,o,i="Microsoft.Office.PowerPointOnline.FA000000129.",a="Microsoft.Office.PowerPoint.fa000000129.";function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OfficeRuntime.experimentation.getBooleanFeatureGate(i+e,t)||OfficeRuntime.experimentation.getBooleanFeatureGate(a+e,t)}function l(e,t){return OfficeRuntime.experimentation.getIntFeatureGate(i+e,t)||OfficeRuntime.experimentation.getIntFeatureGate(i+e,t)}function c(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return OfficeRuntime.experimentation.getBooleanFeatureGate(i+e,t)&&OfficeRuntime.experimentation.getBooleanFeatureGate(a+e,t)}function u(e,t){var n=OfficeRuntime.experimentation.getStringFeatureGate(i+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getStringFeatureGate(a+e);return void 0!==r?r:t}function d(){return s("IsRichAPIForAcquirePluginsEnabled",!1)&&Office.context.requirements.isSetSupported("unifiedstoreservice","1.1")}function p(e){return s(e)}function f(e){return e}function h(){return s("IsFinalResponseFromALEnabled",!0)}function g(){return s("IsReviewerAgentEnabled",!1)}function m(){return g()&&s("IsReviewerAgentToggleEnabled",!1)}function y(e){return c(e)}function v(){return c("IncrementalAshaTelemetryLoggingEnabled")}function S(){return c("LogChatPaneLoadTelemetryEventEnabled")}function C(){return c("LogAuthFlowForDesignerTelemetryEnabled")}function b(){return c("IsGroundingPhase2UxEnabled")}function E(){return c("RenameToAgentsEnabled")}function T(){return!0}function w(){return c("IsSydneyWorkflowForConsumerUserEnabled")}function I(){return u("SingleShotAllowedContentOrigins","")}function P(){return c("EnableALCorrelationLogs")}function _(){return c("showUpdatedAshaStrings")}function A(){return s("HVCAppHandOffScenarioEnabled")}function k(){return s("IsSummarySizeGenerationEnabled")}function x(){return s("IsOutputV2Enabled")}!function(e){e.IsPlanBuilderEnabled="IsPlanBuilderEnabled",e.SpeakerNotesEnabled="SpeakerNotesEnabled",e.InAppHandoffEnabled="InAppHandoffEnabled",e.TryNewDesignOptionInMenuEnabled="TryNewDesignOptionInMenuEnabled",e.LearnMoreOptionInMenuEnabled="LearnMoreOptionInMenuEnabled",e.ChatHistoryTimeoutRetryFix="ChatHistoryTimeoutRetryFix",e.IsSuggestionsForCommandingEnabled="IsSuggestionsForCommandingEnabled",e.isNetworkCheckEnabled="isNetworkCheckEnabled",e.IsHubbleEnterpriseEnabled="EnableHubbleEnterprise",e.IsCommandingWorkflowEnabled="EnableCommandingWorkflow",e.IsjOFCCommandingWorkflowEnabled="EnablejOFCCommandingWorkflow",e.IsCommandingScopeAppChatV2Enabled="EnableCommandingScopeAppChatV2",e.ShouldEnableTryNewDesign="EnableTryNewDesign",e.Tier3LanguageSupport="Tier3LanguageSupport",e.Tier2Point5LanguageSupport="Tier2Point5LanguageSupport",e.UseOfficeJSDocumentURL="UseOfficeJSDocumentURL",e.IsAllEntitiesSupported="IsAllEntitiesSupported",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsPresentationTransformerWFEnabled="IsPresentationTransformerWFEnabled",e.IsPreTriggerContentProcessingWorkflowEnabled="IsPreTriggerContentProcessingWorkflowEnabled",e.IsSelfHelpSearchRenderingEnabled="SelfHelpSearchRenderingEnabled",e.IsApplyLabelUsingTryUpgradeLabelEnabled="IsApplyLabelUsingTryUpgradeLabelEnabled",e.ShouldSendTelemetrySink="ShouldSendTelemetrySink",e.IsSydneyDebugToggleEnabled="IsSydneyDebugToggleEnabled",e.IsPresentationRecommendationEnabled="IsPresentationRecommendationEnabled",e.IsCopilotThemeForWebEnabled="IsCopilotThemeForWebEnabled",e.IsDesignerCopilotEnabled="IsDesignerCopilotEnabled",e.IsEnterpriseBase64ImageEnabled="IsEnterpriseBase64ImageEnabled",e.EnableSemanticSelectionWithPaginatedCards="EnableSemanticSelectionWithPaginatedCards",e.IsCreateJsonCmdListForBumbleBeeEnabled="IsCreateJsonCmdListForBumbleBeeEnabled",e.IsCIQPaperClipButtonEnabled="IsCIQPaperClipButtonEnabled",e.EnableEnterpriseToggleInPhase2Ux="EnableEnterpriseToggleInPhase2Ux",e.IsDesignerDogfoodEndpointEnabled="IsDesignerDogfoodEndpointEnabled",e.RedirectURLEndpointOverride="RedirectURLEndpointOverride",e.TriggerPresentationRecommendationWithBeautify="TriggerPresentationRecommendationWithBeautify",e.DisableXPIAMitigationFix="DisableXPIAMitigationFix",e.UseUpdatedZQMV2PromptString="UseUpdatedZQMV2PromptString",e.EnableFluent2Tokens="EnableFluent2Tokens",e.RehydrateMessagesConsumer="RehydrateMessagesConsumer",e.IsChatHistoryHydrationErrorEnabled="IsChatHistoryHydrationErrorEnabled",e.IsPersistentChatHistoryEnabledForConsumer="IsPersistentChatHistoryEnabledForConsumer",e.IsBumbleBeeEnabledForConsumer="IsBumbleBeeEnabledForConsumer",e.IsContentValidatorWorkflowEnabled="IsContentValidatorWorkflowEnabled",e.ExcelAsInput="ExcelAsInput",e.EnableMultiDocumentsTransformation="EnableMultiDocumentsTransformation",e.IsFeedbackAppChatIntegrationEnabled="IsFeedbackAppChatIntegrationEnabled",e.IsImageInputEnabled="IsImageInputEnabled",e.IsSketchToImageEnabled="IsSketchToImageEnabled",e.ImageSizeLimitInMB="ImageSizeLimitInMB",e.ImageSizeLimitInKB="ImageSizeLimitInKB",e.UseImageSizeLimitInKB="UseImageSizeLimitInKB",e.ImageSizeLimitInMBWhenResizing="ImageSizeLimitInMBWhenResizing",e.ImageResizedSizeInKB="ImageResizedSizeInKB",e.ImageResizeCompressionQuality="ImageResizeCompressionQuality",e.ImageResizePreferredSizeInPx="ImageResizePreferredSizeInPx",e.IsVisualSummaryUIEnabled="IsVisualSummaryUIEnabled",e.UseDesignerChatCardWrapper="UseDesignerChatCardWrapper",e.IsCitationSupportForAvalonEnabled="IsCitationSupportForAvalonEnabled",e.IsBumbleBeeZQMVisibleForConsumer="IsBumbleBeeZQMVisibleForConsumer",e.ShowPersonalizationSuggestionPill="ShowPersonalizationSuggestionPill",e.IsDebugSectionV2Enabled="IsDebugSectionV2Enabled",e.IsCIQEnabledForConsumerAccount="IsCIQEnabledForConsumerAccount",e.IsMarkdownSummarizationEnabled="IsMarkdownSummarizationEnabled",e.IsPersonalizationUXEnabled="IsPersonalizationUXEnabled",e.IsMsgExtEnabled="IsMsgExtEnabled",e.IsApiPluginsEnabled="IsApiPluginsEnabled",e.IsApiPluginsCardsEnabled="IsApiPluginsCardsEnabled",e.LogMSALTokenRequestTelemetry="LogMSALTokenRequestTelemetry",e.EnableCreatePpcConnections="EnableCreatePpcConnections",e.IsPowerPlatformPluginsEnabled="IsPowerPlatformPluginsEnabled",e.IsSccVoiceEnabled="IsSccVoiceEnabled",e.IsSccReadAloudEnabled="IsSccReadAloudEnabled",e.IsSccPromptSuggestionsEnabled="IsSccPromptSuggestionsEnabled",e.IsCopilotPluginEnabled="IsCopilotPluginEnabled",e.IsCustomGPTsEnabled="IsCustomGPTsEnabled",e.IsPersonalizationConfirmationResponseEnabled="IsPersonalizationConfirmationResponseEnabled",e.IsMultiFileURLScreenFeatureEnabled="IsMultiFileURLScreenFeatureEnabled",e.ContentProcessingResponseTimeoutDuration="ContentProcessingResponseTimeoutDuration",e.StorytellerOutlineResponseTimeoutDuration="StorytellerOutlineResponseTimeoutDuration",e.IsMidgardComponentsLocalizationEnabled="IsMidgardComponentsLocalizationEnabled",e.AreCannedQueriesEnabledForAvalon="AreCannedQueriesEnabledForAvalon",e.EnableDesignerFeedbackDataForDebugMode="EnableDesignerFeedbackDataForDebugMode",e.IsWikipediaTransformFeatureEnabled="IsWikipediaTransformFeatureEnabled",e.IsEmptyLabelFixForCLPv2FeatureEnabled="IsEmptyLabelFixForCLPv2FeatureEnabled",e.IsSwitcherMenuContainerEnabled="IsSwitcherMenuContainerEnabled",e.IsNotificationEnabledForSummary="IsNotificationEnabledForSummary",e.UseDesignerPromptForDalle="UseDesignerPromptForDalle",e.IsReviewerAgentEnabled="IsReviewerAgentEnabled",e.IsUrlUnfurlingUsingGraphAPIEnabled="IsUrlUnfurlingUsingGraphAPIEnabled",e.IsReviewerAgentToggleEnabled="IsReviewerAgentToggleEnabled",e.isViewActionForCopilotActionAsyncAPIEnabled="isViewActionForCopilotActionAsyncAPIEnabled",e.IsCopilotPlayKeySlidesEnabled="IsCopilotPlayKeySlidesEnabled",e.IsClickableCopilotKeySlidesEnabled="IsClickableCopilotKeySlidesEnabled",e.EnableAnchorTagOverrideForKeySlides="EnableAnchorTagOverrideForKeySlides",e.IsCopilotSharedHeaderEnabled="IsCopilotSharedHeaderEnabled",e.EditorFluentV9SettingEnabled="EditorFluentV9SettingEnabled",e.IsCustomHandlingForChatHistoryEnabled="IsCustomHandlingForChatHistoryEnabled",e.UseCanCollectCopilotFeedbackAPI="UseCanCollectCopilotFeedbackAPI",e.UseSketchImageCardForBeautifyingInk="UseSketchImageCardForBeautifyingInk",e.IsChatHistoryOnSwitcherMenuEnabled="IsChatHistoryOnSwitcherMenuEnabled",e.ShouldRenderAllHyperLinks="ShouldRenderAllHyperLinks",e.IsPasteUnfurlingEnabled="IsPasteUnfurlingEnabled",e.IsCreditsUIInternalEnabled="IsCreditsUIInternalEnabled",e.IsQueryWarmupSignalEnabled="IsQueryWarmupSignalEnabled",e.IsQueryWarmupSignalEnabledOnChatPaneOpens="IsQueryWarmupSignalEnabledOnChatPaneOpens",e.UrlDetailedErrorEnabled="UrlDetailedErrorEnabled",e.DisableSuggestionOnImageInsert="DisableSuggestionOnImageInsert",e.IsPluginStatePersistEnabled="IsPluginStatePersistEnabled",e.UseDisengagedMessageType="UseDisengagedMessageType",e.IsEnableAppGptsInCIQ="IsEnableAppGptsInCIQ",e.IsEnableAppPluginsInCIQ="IsEnableAppPluginsInCIQ",e.IsEnableTopicECC="IsEnableTopicECC",e.IsCopilotCommandingSteerabilityEnabled="IsCopilotCommandingSteerabilityEnabled",e.IsDesignerShownInZQM="IsDesignerShownInZQM",e.IsViewMorePromptsIconV2Enabled="IsViewMorePromptsIconV2Enabled",e.IsViewMorePromptsOneClickEnabled="IsViewMorePromptsOneClickEnabled",e.IsEnableAppMsgExtInCIQ="IsEnableAppMsgExtInCIQ",e.IsEnableAppPPInCIQ="IsEnableAppPPInCIQ",e.IsEnableAppTypeBInCIQ="IsEnableAppTypeBInCIQ",e.IsChatClickForGPTsEnabled="IsChatClickForGPTsEnabled",e.IsNewChatOnCopilotGPTItemEnabled="IsNewChatOnCopilotGPTItemEnabled",e.IsNewChatOnGPTItemsEnabled="IsNewChatOnGPTItemsEnabled",e.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled="IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled",e.enableProactiveZQMWith3SAPISuggestions="enableProactiveZQMWith3SAPISuggestions",e.enableProactiveZQMWithSuggestedQnA="enableProactiveZQMWithSuggestedQnA",e.EnableQueryBeforeAnnotationLoad="EnableQueryBeforeAnnotationLoad",e.IsCloudFileUploadEnabled="IsCloudFileUploadEnabled",e.IsLocalFileUploadEnabled="IsLocalFileUploadEnabled",e.isCreatePresentationViaNBInChatEnabled="isCreatePresentationViaNBInChatEnabled",e.IsAttachmentListEnabled="IsAttachmentListEnabled",e.IsTriggerPptVisualOperationEnabled="IsTriggerPptVisualOperationEnabled",e.IsPluginToolboxEnabledForPlugins="IsPluginToolboxEnabledForPlugins",e.PromptInputLength="PromptInputLength",e.UseUpdatedGroundingButtonTitle="UseUpdatedGroundingButtonTitle",e.EnableSystemMessageActions="EnableSystemMessageActions",e.UseAIResponsesInODSLForSydney="UseAIResponsesInODSLForSydney",e.IsHardcodedClientErrorMessagingEnabled="IsHardcodedClientErrorMessagingEnabled",e.ShowBrandingInZQM="ShowBrandingInZQM",e.EnableCopilotTranslatePresentation="EnableCopilotTranslatePresentation",e.isOutputV2Enabled="IsOutputV2Enabled",e.ShowPluginsAsAgents="ShowPluginsAsAgents",e.IsAcquirePluginsFromMosEnabled="IsAcquirePluginsFromMosEnabled",e.IsAddSlideWorkflowEnabled="IsAddSlideWorkflowEnabled",e.IsHandoffButtonEnabled="IsHandoffButtonEnabled",e.EnableSwitcherMenuV2="EnableSwitcherMenuV2",e.LoadGptListOnCopilotIconClick="LoadGptListOnCopilotIconClick",e.EnableSummaryTriggerAtPreload="EnableSummaryTriggerAtPreload",e.IsChatHistorySignalDeferred="IsChatHistorySignalDeferred",e.EnableElaboratedPrompt="EnableElaboratedPrompt",e.IsUploadImageFromPhoneEnabled="IsUploadImageFromPhoneEnabled",e.IsPasteFromClipboardButtonEnabled="IsPasteFromClipboardButtonEnabled",e.IsSaveSharePromptEnabled="IsSaveSharePromptEnabled",e.IsSavePromptEnabled="IsSavePromptEnabled",e.IsSharePromptEnabled="IsSharePromptEnabled",e.IsDACopilotBrandingEnabled="IsDACopilotBrandingEnabled",e.ShouldUseMsalGetTokenRequestCaching="ShouldUseMsalGetTokenRequestCaching",e.IsInsertImageEnabledForDAs="IsInsertImageEnabledForDAs",e.IsRealtimeVoiceEnabled="isRealtimeVoiceEnabled",e.IsRealtimeVoiceChatHistoryEnabled="IsRealtimeVoiceChatHistoryEnabled",e.EnableNewZQMsForNewPresentation="EnableNewZQMsForNewPresentation",e.EnableNewZQMsForExistingPresentation="EnableNewZQMsForExistingPresentation",e.EnableSearchBarInCIQECC="EnableSearchBarInCIQECC",e.ScrollToBottomThrottleDelay="ScrollToBottomThrottleDelay",e.EnabledSecondaryComprehensionSignal="EnabledSecondaryComprehensionSignal",e.IsRichAPIForAcquirePluginsEnabled="IsRichAPIForAcquirePluginsEnabled",e.IsRedirectToNBForCreatingGroundedPresentationEnabled="IsRedirectToNBForCreatingGroundedPresentationEnabled",e.IsRedirectToNBForCreatingNonGroundedPresentationEnabled="IsRedirectToNBForCreatingNonGroundedPresentationEnabled",e.ShouldCallPostSeedingPptInsights="ShouldCallPostSeedingPptInsights",e.EnableInsightsCard="EnableInsightsCard",e.LaunchThisVersionOfSDX="LaunchThisVersionOfSDX",e.ShowPluginAsDAInFlyout="ShowPluginAsDAInFlyout",e.IsALHookEnabled="IsALHookEnabled",e.IsUXRefreshEnabledForInput="IsUXRefreshEnabledForInput",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled"}(r||(r={})),function(e){e.AddSlideIdFluxSignalSpeakerNotes="AddSlideIdFluxSignalSpeakerNotes",e.IsGenerateContentForDesignerEnabled="IsGenerateContentForDesignerEnabled",e.AddSlideParseLayout="AddSlideParseLayout",e.CreatePresentationInMenuEnabled="CreatePresentationInMenuEnabled",e.TransformFileInMenuEnabled="TransformFileInMenuEnabled",e.AddSlideInMenuEnabled="AddSlideInMenuEnabled",e.AddImageInMenuEnabled="AddImageInMenuEnabled",e.ChangeTextFormatInMenuEnabled="ChangeTextFormatInMenuEnabled",e.EnableClientEnvironmentDetection="EnableClientEnvironmentDetection",e.ConvertURLsBasedOnClientEnvironment="ConvertURLsBasedOnClientEnvironment",e.StructurePresentationInMenuEnabled="StructurePresentationInMenuEnabled",e.AnimateInMenuEnabled="AnimateInMenuEnabled",e.SummarizeInMenuEnabled="SummarizeInMenuEnabled",e.LearnMoreOptionInMenuEnabled="LearnMoreOptionInMenuEnabled",e.ScreenshotInFeedbackEnabled="ScreenshotInFeedbackEnabled",e.UseApplyJOfcCommandsAsyncForiOS="UseApplyJOfcCommandsAsyncForiOS",e.ShouldCheckJOFCCommandAPIVersion="CheckJOFCCommandAPIVersion",e.ShouldForceOfficeJSImplementationForCommanding="ForceOfficeJSImplementationForCommanding",e.ShouldEnableCommandingErrorCard="EnableCommandingErrorCard",e.ShouldEnableTextRangeInJOFCCommands="EnableTextRangeInJOFCCommands",e.ShouldSupportHVCDetectionOnClientSide="SupportHVCDetectionOnClientSide",e.IsCardSpanWrappingEnabled="CardSpanWrappingEnabled",e.IsSpaceRequiredAfterInput="IsSpaceRequiredAfterInput",e.isClaimsChallengeMessageInAnnotationEnabled="isClaimsChallengeMessageInAnnotationEnabled",e.ShouldSupportLastSlideSelection="SupportLastSlideSelection",e.UseCorrectSlideIndexInPPTOdslSignal="UseCorrectSlideIndexInPPTOdslSignal",e.HandleCommandingFailuresWithoutShowMe="HandleCommandingFailuresWithoutShowMe",e.LogChatEventWhenMakingAJOFCCall="LogChatEventWhenMakingAJOFCCall",e.LogChatEventWhenPromptAndSourceInSingleGenerateSlides="LogChatEventWhenPromptAndSourceInSingleGenerateSlides",e.LogChatEventWhenAnimationIsFalse="LogChatEventWhenAnimationIsFalse",e.HandleUnsupportedCommandErrorCode="HandleUnsupportedCommandErrorCode",e.HandleResolveDelegationInvalidSourceErrorCode="HandleResolveDelegationInvalidSourceErrorCode",e.HandoffEnabled="HandoffEnabled",e.IsHandoffAutoSubmitPromptsEnabled="isHandoffAutoSubmitPromptsEnabled",e.IsStoryTellerBlockedWithEmptyPrompt="IsStoryTellerBlockedWithEmptyPrompt",e.ShowErrorIfContentInsertionFailed="ShowErrorIfContentInsertionFailed",e.IsCreatePresentationEnabled="IsCreatePresentationEnabled",e.ShouldDisableAllCommandsAfterGenerateSlides="DisableAllCommandsAfterGenerateSlides",e.IsAddSlideEnabled="IsAddSlideEnabled",e.IsAddTextEnabled="IsAddTextEnabled",e.IsFormatTextEnabled="IsFormatTextEnabled",e.IsAddImageEnabled="IsAddImageEnabled",e.IsCommandingBlockedWithDismissedArgument="IsCommandingBlockedWithDismissedArgument",e.IsEntitiesLogRemovedFromChatEventParameters="IsEntitiesLogRemovedFromChatEventParameters",e.IsBumbleBeeWhenSourcePresent="IsBumbleBeeWhenSourcePresent",e.IsScenarioErrorTelemetryEnabled="IsScenarioErrorTelemetryEnabled",e.IsSendSlideMonikerEnabled="IsSendSlideMonikerEnabled",e.ShowErrorIfAnimationAlreadyExists="ShowErrorIfAnimationAlreadyExists",e.IsUserTypeFromHostSettingsEnabled="IsUserTypeFromHostSettingsEnabled",e.UseOrganizePresentationJOfcCmds="UseOrganizePresentationJOfcCmds",e.StorytellerLogDebugDataEnabled="StorytellerLogDebugDataEnabled",e.ShouldStorytellerSetScenarioFromAddSlideParam="ShouldStorytellerSetScenarioFromAddSlideParam",e.ShouldUseNewStorytellerErrors="ShouldUseNewStorytellerErrors",e.IsSegmentToSlideSendTemplateIdEnabled="IsSegmentToSlideSendTemplateIdEnabled",e.IsNewPptCopilotWorkflowIntegrationEnabled="IsNewPptCopilotWorkflowIntegrationEnabled",e.IsGroundingPhase2UxEnabled="IsGroundingPhase2UxEnabled",e.IsGroundingPhase2UxEnabledForConsumer="IsGroundingPhase2UxEnabledForConsumer",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.IsWebSearchDefaultOn="IsWebSearchDefaultOn",e.ShowLoadingMessagesFromSydney="ShowLoadingMessagesFromSydney",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsClpEnabledInEnterpriseForSydney="IsClpEnabledInEnterpriseForSydney",e.ShouldSendALConfigForRAI="ShouldSendALConfigForRAI",e.EnableSendTenantFeedback="EnableSendTenantFeedback",e.isODSLResponseCheckEnabled="IsODSLResponseCheckEnabled",e.ShouldInsertedShapeAutoFitToText="EnableInsertedShapeAutoFitToText",e.ShouldEnableCommandingTelemetry="EnableCommandingTelemetry",e.ShouldLaunchTaskModuleInNewWindow="ShouldLaunchTaskModuleInNewWindow",e.UseStoryTellerJsonCmdEnabled="UseStoryTellerJsonCmdEnabled",e.IsErrorMessageLogAllowedForCommanding="EnableErrorMessageLogForCommanding",e.IsCitationsEnabled="IsCitationsEnabled",e.ShouldRenderErrorResponseFromFinalAnnotation="ShouldRenderErrorResponseFromFinalAnnotation",e.ShouldShowVideoNotSupportedMessage="ShouldShowVideoNotSupportedMessage",e.ShouldUseCreationIdsForShapeCommands="UseCreationIdsForShapeCommands",e.EnableGetJsonCmdVersion="EnableGetJsonCmdVersion",e.ShouldUseSeparateHorizontalVerticalCommands="UseSeparateHorizontalVerticalCommands",e.ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion="ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion",e.IsCreatePresentaionCIQAppScenarioEnabled="IsCreatePresentaionCIQAppScenarioEnabled",e.EnableCheckBeforeSplit="EnableCheckBeforeSplit",e.IsTransformFileSensitivityLabelErrorMessageEnabled="IsTransformFileSensitivityLabelErrorMessageEnabled",e.IsCommandingUserPerceivedLatencyTelemetryEnabled="IsCommandingUserPerceivedLatencyTelemetryEnabled",e.IsASHATelemetryToBeLoggedAtStreamEndOnce="IsASHATelemetryToBeLoggedAtStreamEndOnce",e.IsTelemetryEnabledForCommandingFailureCases="IsTelemetryEnabledForCommandingFailureCases",e.ShouldStoreNonStreamingSydneyMessageInChatHistory="ShouldStoreNonStreamingSydneyMessageInChatHistory",e.ChooseGenerateWithSourceOverPrompt="ChooseGenerateWithSourceOverPrompt",e.IsApplyCLPLabelErrorChangeEnabled="IsApplyCLPLabelErrorChangeEnabled",e.IsAllPptCommandErrorLogEnabled="IsAllPptCommandErrorLogEnabled",e.IsMultipleGenerateSlidesCommandDisabled="IsMultipleGenerateSlidesCommandDisabled",e.ErrorMessageInAIContextEnabledPPT="ErrorMessageInAIContextEnabledPPT",e.UseImageOutOfScopeIntentErrorForImageInvalid="UseImageOutOfScopeIntentErrorForImageInvalid",e.IsJofcCommandErrorTelemetryEnabled="IsJofcCommandErrorTelemetryEnabled",e.IsCommandingScopeAppChatV2EnabledCG="EnableCommandingScopeAppChatV2CG",e.LogOrganizeWorkflowDuration="LogOrganizeWorkflowDurations",e.LogTimeToIntentDetectionDuration="LogTimeToIntentDetectionDuration",e.ShouldReturnCustomStringForNoTopic="ShouldReturnCustomStringForNoTopic",e.LogQuerySubmitTime="LogQuerySubmitTime",e.ShouldAddLinkSuffixForErrorMessage="ShouldAddLinkSuffixForErrorMessage",e.IsCreatePresentationWarningTypeLogEnabled="IsCreatePresentationWarningTypeLogEnabled",e.UseNewCopilotSharedPackage="UseNewCopilotSharedPackage",e.IgnoreMarkerForHvcPrefixFinding="IgnoreMarkerForHvcPrefixFinding",e.UseSortedHVCTokenList="UseSortedHVCTokenList",e.ShouldAddFeatureNameInLatencyTableIfEmpty="AddFeatureNameInLatencyTableIfEmpty",e.IsNERBlockingUIEnabled="IsNERBlockingUIEnabled",e.IsFeedbackAIThumbsUpScenarioEnabled="IsFeedbackAIThumbsUpScenarioEnabled",e.OrganizeDesignerOptions="OrganizeDesignerOptions",e.EnableALCorrelationLogs="EnableALCorrelationLogs",e.EnableZQMQuerySubmissionThroughChatInputBox="EnableZQMQuerySubmissionThroughChatInputBox",e.EnableCIQWithUserTypeCheck="EnableCIQWithUserTypeCheck",e.ShowSpecificErrorsForEncryptedFiles="ShowSpecificErrorsForEncryptedFiles",e.IsPersonalizationEntryPointInPromptMenuEnabled="IsPersonalizationEntryPointInPromptMenuEnabled",e.ShouldCLPExceptionDisableEnterpriseSearch="ShouldCLPExceptionDisableEnterpriseSearch",e.IsUpdatedCannedStringsEnabled="IsUpdatedCannedStringsEnabled",e.IsPersonalizationIndicatorHeaderEnabled="IsPersonalizationIndicatorHeaderEnabled",e.SetScenarioNameEnabled="SetScenarioNameEnabled",e.DifferentiateCancelFromWarningCard="DifferentiateCancelFromWarningCard",e.IsExtraStopGenLogEnabled="IsExtraStopGenLogEnabled",e.IsInitiatorViewTelemetryFieldAdded="IsInitiatorViewTelemetryFieldAdded",e.isMSAAuthWorkaroundEnabled="isMSAAuthWorkaroundEnabled",e.IsUnsupportedEntitiesEnabled="IsUnsupportedEntitiesEnabled",e.CustomerOneDriveOnlyUrlChange="CustomerOneDriveOnlyUrlChange",e.ShouldSendCopilotLabCategories="ShouldSendCopilotLabCategories",e.IsShouldSendStopGeneratingSignaltoALEnabled="IsShouldSendStopGeneratingSignaltoALEnabled",e.IsGroupedCopilotPluginEnabled="IsGroupedCopilotPluginEnabled",e.IsSketchImageCardEnabled="IsSketchImageCardEnabled",e.IsImageResizeEnabled="IsImageResizeEnabled",e.IsSketchImageResizeEnabled="IsSketchImageResizeEnabled",e.IsNoopOnSameSensitivityLabel="IsNoopOnSameSensitivityLabel",e.IsPACTokenEnabled="IsPACTokenEnabled",e.UseDataURIToImageTileShared="UseDataURIToImageTileShared",e.IsFeedbackAppChatThemingEnabled="IsFeedbackAppChatThemingEnabled",e.IsDalleImageRehydrationEnabled="IsDalleImageRehydrationEnabled",e.IsAtMentionRedirectURLSetup="IsAtMentionRedirectURLSetup",e.IsMsgExtTelemetryEnabled="IsMsgExtTelemetryEnabled",e.IsCopilotExtTelemetryEnabled="IsCopilotExtTelemetryEnabled",e.GetUserPresentationDetails="GetUserPresentationDetails",e.IsAriaAnnouncerEnabled="IsAriaAnnouncerEnabled",e.IsStringReplacementAnchorTagOverrideEnabled="IsStringReplacementAnchorTagOverrideEnabled",e.ShouldUseMsalSsoSilentLogin="ShouldUseMsalSsoSilentLogin",e.IsClickableCopilotKeySlidesDependentOnSlideIds="IsClickableCopilotKeySlidesDependentOnSlideIds",e.IsHideSingleCitationEnabled="IsHideSingleCitationEnabled",e.SendFeedbackClientAppName="sendFeedbackClientAppName",e.ShowPluginReferencesV3="ShowPluginReferencesV3",e.ShouldUseOfficeHubName="ShouldUseOfficeHubName",e.EnablePluginSearchInFlyout="EnablePluginSearchInFlyout",e.EnableMorePluginHyperLinkInFlyout="EnableMorePluginHyperLinkInFlyout",e.EnableQueryEndOnGptSwitch="EnableQueryEndOnGptSwitch",e.EnableMorePlugins="EnableMorePlugins",e.UseExternalAuthService="UseExternalAuthService",e.ShowSystemMessageOnPluginToggle="ShowSystemMessageOnPluginToggle",e.EnableInterstitialConfirmation="EnableInterstitialConfirmation",e.EnableInterstitialAuthentication="EnableInterstitialAuthentication",e.ShouldPassAllInterstitialMessages="ShouldPassAllInterstitialMessages",e.EnableProdigiOutOfCreditsErrorHandling="EnableProdigiOutOfCreditsErrorHandling",e.IsASHAErrorLoggingEnabledForDesignerSideErrors="IsASHAErrorLoggingEnabledForDesignerSideErrors",e.ShouldUseHybridAppService="ShouldUseHybridAppService",e.IsHindiSupportEnabledInTranslationCard="IsHindiSupportEnabledInTranslationCard",e.IsChatCardRendererMemoizationEnabled="IsChatCardRendererMemoizationEnabled",e.UseResponsiveSystemMessage="UseResponsiveSystemMessage",e.ShouldUseMsalLocalSilentFlag="ShouldUseMsalLocalSilentFlag",e.RemoveContextFromInputSignalEnabled="RemoveContextFromInputSignalEnabled",e.IsDragDropWrapperEnabled="IsDragDropWrapperEnabled",e.IsInputMessageEnabled="IsInputMessageEnabled",e.IsSummaryCachingDisabledForConsumer="IsSummaryCachingDisabledForConsumer",e.ShouldStopOpenPaneWithSummaryScenario="ShouldStopOpenPaneWithSummaryScenario",e.IsHydratedEntityEnabled="IsHydratedEntityEnabled",e.UseCacheForGPTDetails="UseCacheForGPTDetails",e.StopMenuShimmerAfterFirstCall="StopMenuShimmerAfterFirstCall",e.IsTellMeCopilotHandoffEnabled="IsTellMeCopilotHandoffEnabled",e.EnableButtonHidingWithAtMention="EnableButtonHidingWithAtMention",e.IsAddSlideErrorHandlerEnabled="IsAddSlideErrorHandlerEnabled",e.AddScenarioNameReportStopGeneration="AddScenarioNameReportStopGeneration",e.IsDACopilotBrandingEnabled="IsDACopilotBrandingEnabled",e.IsShowLaunchNBResponseCardEnabled="IsShowLaunchNBResponseCardEnabled",e.IsLaunchNBFromZQMEnabled="IsLaunchNBFromZQMEnabled",e.IgnoreExtraResponseForSpeakerNotes="IgnoreExtraResponseForSpeakerNotes",e.LogSpeakerNotesResponse="LogSpeakerNotesResponse",e.IsDAOutputV2Enabled="IsDAOutputV2Enabled",e.ShouldValidateAllSlidesInNotesJofcResponseAreValid="ShouldValidateAllSlidesInNotesJofcResponseAreValid",e.IsVisualSpeakerNotesHandlingEnabled="IsVisualSpeakerNotesHandlingEnabled",e.AddExtensibiltyDataToFeedbackOCV="AddExtensibiltyDataToFeedbackOCV",e.IsCustomWidthPropOnACEnabled="IsCustomWidthPropOnACEnabled",e.RestrictConversationStartersForDA="RestrictConversationStartersForDA",e.IsSharedHandoffHandlerEnabled="IsCreateSharedHandoffHandlerEnabled",e.IsRealtimeVoiceDynamicBufferSizeEnabled="IsRealtimeVoiceDynamicBufferSizeEnabled",e.IsRealtimeVoiceZQMEnabled="IsRealtimeVoiceZQMEnabled"}(o||(o={}))},1543:(e,t,n)=>{"use strict";n.d(t,{B_:()=>w,FG:()=>u,H_:()=>I,J2:()=>k,Nr:()=>C,OJ:()=>E,T$:()=>f,V9:()=>b,X8:()=>x,Z5:()=>S,b8:()=>l,dV:()=>_,jO:()=>A,pm:()=>T,r3:()=>m,vI:()=>h,vf:()=>d,x6:()=>v,xw:()=>y,yV:()=>p,z4:()=>P});var r=n(34045),o=n(18758),i=n(30325),a=n(55564),s=n(40389);function l(){return(0,o.$1)((0,i.wo)())&&(0,a.PA)(a.IY.IsNewPptCopilotWorkflowIntegrationEnabled)||c()}function c(){return(0,o.sQ)((0,i.wo)())&&(0,a.qH)()}function u(e){return e&&((0,o.$1)((0,i.wo)())||c())}function d(){return(0,o.$1)((0,i.wo)())||(0,o.sQ)((0,i.wo)())&&(0,a.PA)(a.WT.IsPersistentChatHistoryEnabledForConsumer)}function p(){return(0,a.bw)(a.WT.IsChatHistoryHydrationErrorEnabled)&&((0,o.$1)((0,i.wo)())||(0,o.sQ)((0,i.wo)())&&(0,a.bw)(a.WT.RehydrateMessagesConsumer))}var f=function(){return(0,a.bw)("HideChangeTopicButton")||(0,o.sQ)((0,i.wo)())&&!(0,a.qH)()};function h(){return(0,o.$1)((0,i.wo)())&&(0,a.jv)()||(0,o.sQ)((0,i.wo)())&&(0,a.PA)(a.IY.IsGroundingPhase2UxEnabledForConsumer)}function g(e){return(0,o.$1)((0,i.wo)())&&(0,a.bw)(e)}function m(){return g("IsEnableAtMentionButtonForUser")&&y()}function y(){return g(a.WT.IsEnableAppGptsInCIQ)}function v(){return g(a.WT.IsEnableAppPluginsInCIQ)}function S(){return!(0,a.bw)(a.WT.ShowPluginsAsAgents)&&g(a.WT.IsEnableAppMsgExtInCIQ)}function C(){return g(a.WT.IsEnableAppPPInCIQ)}function b(){return g(a.WT.IsEnableAppTypeBInCIQ)}function E(){return g(a.WT.IsEnableTopicECC)}function T(){return(0,a.PA)("enableChatHistoryV2ForEnterprise")&&(0,o.$1)((0,i.wo)())||(0,a.bw)("enableChatHistoryV2ForConsumer")&&(0,o.sQ)((0,i.wo)())}function w(){return T()&&((0,a.bw)("enableChatHistoryLocalStorageForEnterprise")&&(0,o.$1)((0,i.wo)())||(0,a.bw)("enableChatHistoryLocalStorageForConsumer")&&(0,o.sQ)((0,i.wo)()))}function I(){return(0,o.$1)((0,i.wo)())||(0,o.sQ)((0,i.wo)())&&(0,a.bw)(a.WT.IsCIQEnabledForConsumerAccount)}function P(){return(0,o.$1)((0,i.wo)())&&!(0,r.TB)()}function _(){return(0,o.$1)((0,i.wo)())&&(0,a.bw)(a.WT.IsCopilotPluginEnabled)&&!(0,a.bw)(a.WT.ShowPluginsAsAgents)}function A(){return(0,o.$1)((0,i.wo)())&&(0,a.bw)(a.WT.IsCustomGPTsEnabled)}function k(){return(0,o.sQ)((0,i.wo)())&&(0,a.sT)("IsSummaryCachingDisabledForConsumer")}var x=function(e){return(0,a.bw)(a.WT.isCreatePresentationViaNBInChatEnabled)&&(0,a.PA)(a.IY.IsLaunchNBFromZQMEnabled)&&!(0,s.dD)()&&(e?(0,a.bw)(a.WT.IsRedirectToNBForCreatingGroundedPresentationEnabled):(0,a.bw)(a.WT.IsRedirectToNBForCreatingNonGroundedPresentationEnabled))}},31041:(e,t,n)=>{"use strict";n.d(t,{n:()=>u});var r=n(93176),o=n(24643),i=n(43479),a=n(18758),s=n(5847),l=n(32854),c=n(44121);function u(e,t){return{chatCardType:r._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.LaunchNBToCreatePresentation}}},chatMessageBodyData:{actionButtonList:[{type:i.jA.Default,title:PowerpointCopilotStrings.CreateNewPresentation,text:PowerpointCopilotStrings.CreateNewPresentation,tooltip:PowerpointCopilotStrings.CreateNewPresentation,iconRegular:s.KRq,iconHover:s.eF2,handleButtonOnClick:function(){var n;(0,a.cY)("Launching NB and removing action button"),null==e||null===(n=e.current)||void 0===n||n.updateLastMessage({chatCardType:r._.Default,chatMessageBodyData:{actionButtonList:[]}});var o={userPrompt:t,sourceComponent:c.FX.Submit,initiatorView:l.ff};(0,l.VL)(o)}}]},stopLoadingUi:!0,addCardToChatHistory:!0}}},78289:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R,Co:()=>F,ei:()=>T,Zl:()=>E});var r=n(90813),o=n(81092),i=n(69020),a=n(47350),s=n(44632),l=n(18384),c=n(93176),u=n(95044),d=n(63028),p=n(61542),f=n(55564),h=n(9669),g=n(2061),m=n(39726),y=n(83048),v=n(72218),S=new Map([[m.IU.TooShort,y.Nr.LessContentToSummarizeError],[m.IU.MissingPPTContent,y.Nr.LessContentToSummarizeError],[m.IU.OutputBlockedByDynamicGuardList,y.Nr.OffensiveContentToSummarizeError],[m.IU.OffensiveOutputContent,y.Nr.OffensiveContentToSummarizeError],[m.IU.BadResponse,y.Nr.ErrorRequestTimedOut],[m.IU.BadRequest,y.Nr.ErrorRequestTimedOut],[m.IU.Token,y.Nr.ErrorRequestTimedOut],[m.IU.Unknown,y.Nr.ErrorRequestTimedOut],[m.IU.EmptyResponse,y.Nr.EmptySummaryResponseMessage],[m.IU.Timeout,y.Nr.ErrorServerBusy],[m.IU.NotAvailable,y.Nr.ErrorServerBusy],[m.IU.InputRAIDependency,y.Nr.ErrorRequestTimedOut],[m.IU.OutputRAIDependency,y.Nr.ErrorRequestTimedOut],[m.IU.Throttled,y.Nr.ThrottlingErrorMessage],[m.IU.UserThrottled,y.Nr.ThrottlingErrorMessage],[m.IU.ScenarioThrottled,y.Nr.ThrottlingErrorMessage],[m.IU.NotSupported,y.Nr.ErrorDetectedOtherLanguage],[m.IU.FailedToGetInputLanguage,y.Nr.ErrorRequestTimedOut],[m.IU.FailedToGenerateVisualDescription,y.Nr.ErrorRequestTimedOut],[m.IU.Bad_Token,y.Nr.LicenseValidationErrorMessage],[m.IU.Missing,y.Nr.ErrorRequestTimedOut],[m.IU.WrongType,y.Nr.ErrorRequestTimedOut],[m.IU.Invalid,y.Nr.ErrorRequestTimedOut]]),C=n(50481),b=s.B.getInstance(),E=function(e,t,n){var o,a=(0,i.Ar)(e,n);(0,u.cY)("Interactive Summary Toggle: with section clicked",a),b.sendChatEventTelemetry((0,l.pN)((o={},(0,r._)(o,y.h3.ChatEventType,y.a5.InteractiveSummaryToggle),(0,r._)(o,y.h3.ChatEventParameters,JSON.stringify({NodeLevel:null==a?void 0:a.level,isExpanded:t,NodeClickedTimeInMs:Date.now(),NodeReceivedTimeFromALInMs:null==a?void 0:a.timeStamp,isLeafNode:null==a?void 0:a.isLeafNode})),o)))},T=function(e,t,n,o){if(!w(e))return!1;var i=P(t),s=a.U.getInstance();if(i)return N(i,s,o),!0;var c,d=I(t);if(!_(d))return(0,u.cY)("PPT Summary finalMessage is not Section type"),b.sendErrorTelemetry((0,l.pN)((c={},(0,r._)(c,y.IC.ErrorMessage,"Interactive Summary Workflow Error Detected, Final Message is not a valid section"),(0,r._)(c,y.IC.ErrorCategory,y.S2.Summary),c))),!0;(0,u.cY)("PPT Summary finalMessage ID ",null==d?void 0:d.messageId);var p=null==d?void 0:d.sections,f=(0,C.pe)(null==d?void 0:d.sourceAttributions);if(F(p,f),A(null==d?void 0:d.messageId,p),k(n)){var h=s.getSectionsByQueryId(null==d?void 0:d.messageId);x(o,null==d?void 0:d.messageId,h,f),L(null==d?void 0:d.messageId,h)}return!0},w=function(e){return(0,f.D$)()&&e===d._n.PPT_SUMMARY},I=function(e){var t,n,r,o,i,a;return null==e||null===(a=e[0])||void 0===a||null===(i=a.annotations)||void 0===i||null===(o=i[0])||void 0===o||null===(r=o.value)||void 0===r||null===(n=r.body)||void 0===n||null===(t=n.chatResponse)||void 0===t?void 0:t.messages[0]},P=function(e){var t,n,r,o,i;return null==e||null===(i=e[0])||void 0===i||null===(o=i.annotations)||void 0===o||null===(r=o[0])||void 0===r||null===(n=r.value)||void 0===n||null===(t=n.body)||void 0===t?void 0:t.error},_=function(e){var t;return(null==e?void 0:e.dataType)===p.pe.Section&&(null===(t=e.sections)||void 0===t?void 0:t.length)>0},A=function(e,t){var n=a.U.getInstance();n.updateSections(e,(0,o._)(t)),n.notifySubscribers(e)},k=function(e){var t,n;return(null==e||null===(t=e[0])||void 0===t?void 0:t.name)===d.jQ.STATE&&(null==e||null===(n=e[0])||void 0===n?void 0:n.value)===g.W$G.COMPLETED},x=function(e,t,n,r,o){var i;null===(i=e.current)||void 0===i||i.updateMessage({chatCardType:c._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",renderData:{component:m.uz.InteractiveSummaryCard,props:{messageId:t,initialSections:n,statusMessage:o},shouldMemoizeComponent:!1}}},chatMessageBodyData:{messageId:t,references:r},addCardToChatHistory:!0})},N=function(e,t,n){O(e);var r=t.getLatestQueryId(),o=t.getSectionsByQueryId(r),i=D(e),a=M(i)?"Some content is missing in the summary details as it is not compliant with our responsible AI policies.":void 0;x(n,r,o,void 0,a),L(r,o)},O=function(e){var t,n=D(e);(0,u.cY)("Summary Error Detected, Category: ".concat(e.category,", ErrorCode: ").concat(n,", ErrorMessage: ").concat(e.message)),b.sendErrorTelemetry((0,l.pN)((t={},(0,r._)(t,y.IC.ErrorMessage,"Interactive summary Workflow Error Detected while getting nodes, Category: ".concat(e.category,", ErrorCode: ").concat(n)),(0,r._)(t,y.IC.ErrorCategory,y.S2.Summary),(0,r._)(t,y.IC.ErrorCode,n),t)));var o,i="".concat(h.c.getTypeName(),"_Error"),a=e.category.concat((0,g.jwY)(n)?v.u1i:"_".concat(n));b.sendChatEventTelemetry((0,l.pN)((o={},(0,r._)(o,y.h3.ChatEventType,i),(0,r._)(o,y.h3.ChatEventParameters,a),(0,r._)(o,y.h3.ChatErrorType,m.T_.Server),(0,r._)(o,y.h3.ChatErrorKey,function(e){return S.get(e)}(n)),o)))},D=function(e){try{return JSON.parse(e.json).code}catch(e){var t;return(0,u.cY)("Error parsing error code from summary error",e.message),b.sendErrorTelemetry((0,l.pN)((t={},(0,r._)(t,y.IC.ErrorMessage,"Error parsing error code from Interactive summary error, ".concat(e.message)),(0,r._)(t,y.IC.ErrorCategory,y.S2.Summary),t))),v.u1i}},L=function(e,t){var n=(0,i.PQ)(t);(0,u.cY)("PPT Summary Section Latency sectionLatencies = ",n),n.forEach((function(t){var n,o;b.sendLatencyTelemetryForNotifications((0,l.pN)((n={},(0,r._)(n,y.CT.FeatureName,y.S2.Summary),(0,r._)(n,y.CT.IsFromCache,!1),(0,r._)(n,y.CT.SubFeatureName,y.Ff.InteractiveSummary),(0,r._)(n,y.CT.InteractiveSummaryLevel,t.LevelNumber),(0,r._)(n,y.CT.InteractiveSummaryLevelStreamingTimeInMs,t.LevelEndTimestamp-t.LevelStartTimestamp),n)),e,!0),b.sendChatEventTelemetry((0,l.pN)((o={},(0,r._)(o,y.h3.ChatEventType,y.a5.InteractiveSummaryLevelReceivedTimeInMs),(0,r._)(o,y.h3.IsFromCache,!1),(0,r._)(o,y.h3.ChatEventParameters,JSON.stringify({NodeLevel:t.LevelNumber,LevelStreamingStartTimeInMs:t.LevelStartTimestamp,LevelStreamingEndTimeInMs:t.LevelEndTimestamp})),o)))}))},R=function(e){var t;return!!e&&(e.dataType===p.pe.Section&&(null===(t=e.sections)||void 0===t?void 0:t.length)>0)},F=function(e,t){e.forEach((function(e){e.subSections&&F(e.subSections,t),e.sourceAttributionIndex&&(e.citationPillProps=e.sourceAttributionIndex.map((function(e){return t.filter((function(t){return t.referenceIndex===e+1}))})).flat())}))},M=function(e){return e===m.IU.InputBlockedByDynamicGuardList||e===m.IU.OutputBlockedByDynamicGuardList||e===m.IU.OffensiveInputContent||e===m.IU.OffensiveOutputContent||e===m.IU.InputRAIDependency||e===m.IU.OutputRAIDependency}},78172:(e,t,n)=>{"use strict";n.d(t,{Y:()=>g});var r=n(5847),o=n(41853),i=n(876),a=n(34235),s=n(55564),l=n(34045),c=n(32854),u=n(65917),d=n(62096),p=n(72218),f=n(18758),h=n(21659),g=function(e,t){var n,u=[],g=m(e,t,(n=[],l.Vv.IsSettingTrue(l.zj.PPTContentGenerationDisabledByAdmin)||(n.push({nodeType:"ActionSet",text:p.UeP.createPresentationFrom(),data:{ciqEntity:"File",unSupportedEntities:(0,f.M$)()?(0,c.lS)([d.ck.Event,d.ck.People,d.ck.Message]):void 0}}),n.push({nodeType:"ActionSet",text:p.UeP.createPresentationAboutContoso()}),n.push({nodeType:"ActionSet",text:p.UeP.addSlideAbout()})),n));g.length>0&&u.push({nodeType:"Category",text:p.hn.menuSectionCreate(),promptCategory:"Create",iconRegular:r.vfO,iconHover:r.Dal,children:g});var y,v=((y=[]).push({nodeType:"ActionSet",text:p.UeP.summarize(),data:{shouldSubmitQueryOnClick:!0}}),y.push({nodeType:"ActionSet",text:p.UeP.datesAndDeadLines()}),y.push({nodeType:"ActionSet",text:p.UeP.showActionItems(),data:{shouldSubmitQueryOnClick:!0}}),y.push({nodeType:"ActionSet",text:p.UeP.showKeySlides(),data:{shouldSubmitQueryOnClick:!0}}),y);e>=(0,h.i$)()&&v.length>0&&u.push({nodeType:"Category",text:p.hn.menuSectionUnderstand(),promptCategory:"Understand",iconRegular:o.uJg,iconHover:o._38,children:v});var S,C=m(e,t,(S=[],(0,s.bw)(s.WT.TryNewDesignOptionInMenuEnabled)&&S.push({nodeType:"ActionSet",text:p.UeP.tryNewDesign()}),S.push({nodeType:"ActionSet",text:p.UeP.addImage()}),(0,s.bw)(s.WT.IsHubbleEnterpriseEnabled)&&S.push({nodeType:"ActionSet",text:p.UeP.addEnterpriseImage()}),S.push({nodeType:"ActionSet",text:p.UeP.organizePresentation(),data:{shouldSubmitQueryOnClick:!0}}),S));C.length>0&&u.push({nodeType:"Category",text:p.hn.menuSectionEdit(),promptCategory:"Edit",iconRegular:r.RIf,iconHover:r.FBb,children:C});var b,E,T=((b=[]).push({nodeType:"ActionSet",text:p.UeP.help(),data:{shouldSubmitQueryOnClick:!0}}),b.push({nodeType:"ActionSet",text:p.UeP.improvePresentation()}),b);if(u.push({nodeType:"Category",text:p.hn.menuSectionAsk(),promptCategory:"Ask",iconRegular:i.I11,iconHover:i.kNP,children:T}),(0,s.bw)(s.WT.IsPersonalizationUXEnabled)&&(0,s.PA)(s.IY.IsPersonalizationEntryPointInPromptMenuEnabled)){var w=((E=[]).push({nodeType:"ActionSet",text:p.UeP.whatCanCopilotProfileDo(),data:{shouldSubmitQueryOnClick:!0}}),E.push({nodeType:"ActionSet",text:p.UeP.createMyCopilotProfile()}),E);u.push({nodeType:"Category",text:p.hn.menuSectionCustomize(),promptCategory:"Customize",iconRegular:a.afj,iconHover:a.MOA,children:w})}return u},m=function(e,t,n){var r=[],o=u._.getInstance().getSlideCount(),i=u._.getInstance().isCreatePresentationEnabled(),a=!0,s=!1,l=void 0;try{for(var d,h=n[Symbol.iterator]();!(a=(d=h.next()).done);a=!0){var g=d.value;switch(g.text){case p.UeP.organizePresentation():if(!(0,f.Yy)(o,e))continue;break;case p.UeP.createPresentationFrom():if((0,f.sQ)(t)&&!1===(0,c.f5)())continue;break;case p.UeP.createPresentationAbout():break;case p.UeP.tryNewDesign():case p.UeP.changeBodyText():if(o<2||i)continue}r.push(g)}}catch(e){s=!0,l=e}finally{try{a||null==h.return||h.return()}finally{if(s)throw l}}return r}},89375:(e,t,n)=>{"use strict";n.d(t,{z:()=>m});var r=n(90813),o=n(12542),i=n(17235),a=n(44121),s=n(44632),l=n(39726),c=n(18758),u=n(18384),d=n(24464),p=n(21659),f=n(55564),h=n(72218),g=s.B.getInstance();function m(e,t,n){var s,m,y=arguments.length>3&&void 0!==arguments[3]&&arguments[3],v=e.category,S=h.u1i;try{S=JSON.parse(e.json).code}catch(e){var C;return(0,c.cY)("Error parsing error code from summary error",e.message),(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y),g.sendErrorTelemetry((0,u.pN)((C={},(0,r._)(C,o.IC.ErrorMessage,"Error parsing error code from summary error, ".concat(e.message)),(0,r._)(C,o.IC.ErrorCategory,o.S2.Summary),C))),{errorCode:S,errorKey:o.Nr.ErrorRequestTimedOut}}(0,c.cY)("Summary Error Detected, Category: ".concat(v,", ErrorCode: ").concat(S,", ErrorMessage: ").concat(e.message)),g.sendErrorTelemetry((0,u.pN)((m={},(0,r._)(m,o.IC.ErrorMessage,"Summary Workflow Error Detected, Category: ".concat(v,", ErrorCode: ").concat(S)),(0,r._)(m,o.IC.ErrorCategory,o.S2.Summary),m)));var b=(0,u.A9)(o._5.Summarize,o.G8.UnclassifiedAshaError),E=o._I.Fallback,T=b,w={errorType:"".concat(v,"-").concat(S),featureName:o.CC.Summary};switch(v){case l.ll.InvalidInput:switch(E=o._I.InvalidInput,T=o.G8.SummarizeUnableToComplete,S){case l.IU.TooShort:E=o._I.TooShort,T=o.G8.SummarizeUnableToComplete,w.errorMessage=PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",(0,p.i$)().toString()),(0,d.r5)(n,PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",(0,p.i$)().toString()),void 0,void 0,y,w),s=o.Nr.LessContentToSummarizeError;break;case l.IU.MissingPPTContent:E=o._I.MissingPPTContent,T=o.G8.SummarizeUnableToComplete,w.errorMessage=PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",(0,p.i$)().toString()),(0,d.r5)(n,PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",(0,p.i$)().toString()),void 0,void 0,y,w),s=o.Nr.LessContentToSummarizeError;break;default:w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut}break;case l.ll.OffensiveContent:switch(E=o._I.OffensiveContent,T=o.G8.SummarizeBlockedResponse,w.errorMessage=PowerpointCopilotStrings.OffensiveContentToSummarizeError,S){case l.IU.OutputBlockedByDynamicGuardList:E=o._I.OutputBlockedByFilters,T=o.G8.SummarizeRAIError;break;case l.IU.OffensiveOutputContent:E=o._I.OffensiveOutputBlockedByContentModerator,T=o.G8.SummarizeRAIError}(0,d.r5)(n,PowerpointCopilotStrings.OffensiveContentToSummarizeError,void 0,void 0,y,w),s=o.Nr.OffensiveContentToSummarizeError;break;case l.ll.InferenceAPIError:switch(S){case l.IU.BadResponse:E=o._I.BadResponse,T=o.G8.SummarizeLLMServiceSideIssue,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.BadRequest:E=o._I.BadRequest,T=b,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.Token:E=o._I.Token,T=o.G8.SummarizeUserAccessIssue,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.Unknown:E=o._I.Unknown,T=b,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.EmptyResponse:if(t!==i.N.Unknown){var I=PowerpointCopilotStrings.ErrorRequestTimedOut;t===i.N.Summary||t===i.N.SegmentedSummary||t===i.N.StyledSummary?(E=o._I.NoSummaryPoints,I=PowerpointCopilotStrings.EmptySummaryResponseMessage,s=o.Nr.EmptySummaryResponseMessage):t===i.N.CallsForAction?(E=o._I.NoActionItems,I=PowerpointCopilotStrings.NoActionItemsFoundMessage,s=o.Nr.NoActionItemsFoundMessage):(E=o._I.NoImportantSlides,I=PowerpointCopilotStrings.EmptyKeySlidesResponseMessage,s=o.Nr.EmptyKeySlidesResponseMessage),w.errorMessage=I,T=o.G8.SummarizeUnableToComplete,(0,d.r5)(n,I,void 0,void 0,y,w)}else w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.Timeout:E=o._I.Timeout,T=o.G8.SummarizeTimedOut,w.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,(0,d.r5)(n,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,w),s=o.Nr.ErrorServerBusy;break;case l.IU.NotAvailable:w.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,E=o._I.APIUnavailable,T=o.G8.SummarizeLLMServiceSideIssue,(0,d.r5)(n,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,y,w),s=o.Nr.ErrorServerBusy;break;case l.IU.InputRAIDependency:w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,E=o._I.RAIOnInputError,T=o.G8.SummarizeBlockedResponse,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.OutputRAIDependency:w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,E=o._I.RAIOnOutputError,T=o.G8.SummarizeBlockedResponse,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.Throttled:E=o._I.Throttled,T=o.G8.SummarizeCapacityIssue,w.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,d.r5)(n,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,w),s=o.Nr.ThrottlingErrorMessage;break;case l.IU.UserThrottled:E=o._I.UserThrottled,T=o.G8.SummarizeCapacityIssue,w.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,d.r5)(n,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,y,w),s=o.Nr.ThrottlingErrorMessage;break;case l.IU.ScenarioThrottled:E=o._I.ScenarioThrottled,T=o.G8.SummarizeCapacityIssue,w.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,d.r5)(n,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,y,w),s=o.Nr.ThrottlingErrorMessage;break;default:w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut}break;case l.ll.InvalidLanguage:switch(S){case l.IU.NotSupported:E=o._I.InvalidInputLanguage,T=o.G8.SummarizeUnsupportedFunctionality,w.errorMessage=PowerpointCopilotStrings.ErrorDetectedOtherLanguage,(0,d.r5)(n,PowerpointCopilotStrings.ErrorDetectedOtherLanguage,void 0,void 0,y,w),s=o.Nr.ErrorDetectedOtherLanguage;break;case l.IU.FailedToGetInputLanguage:E=o._I.FailedToGetInputLanguage,T=o.G8.SummarizeUnsupportedFunctionality,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;default:(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut}break;case l.ll.VisualDescriptionGeneration:switch(S){case l.IU.Unknown:E=o._I.VisualDescriptionGenerationUnknownError,T=o.G8.SummarizeLLMServiceSideIssue,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.IU.FailedToGenerateVisualDescription:E=o._I.VisualDescriptionGenerationError,T=o.G8.SummarizeLLMServiceSideIssue,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;default:w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut}break;case l.ll.InputQueryError:if(S===l.IU.Bad_Token)E=(0,f.az)()?o._I.InvalidTokens:o._I.Token,T=o.G8.SummarizeUserAccessIssue,w.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,(0,d.r5)(n,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,y,w),s=o.Nr.LicenseValidationErrorMessage;else w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.ll.LicensingError:E=(0,f.az)()?o._I.Licensing:o._I.LicensingOld,T=o.G8.SummarizeUserAccessIssue,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,y,w),s=o.Nr.LicenseValidationErrorMessage;break;case l.ll.PromptInjection:E=o._I.PromptInjection,T=o.G8.SummarizeBlockedResponse,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.ll.InvalidSignal:switch(E=o._I.InvalidSignal,T=b,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,S){case l.IU.Missing:E=o._I.MissingSignal,T=o.G8.SummarizeLLMServiceSideIssue;break;case l.IU.WrongType:T=o.G8.SummarizeLLMServiceSideIssue}(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;case l.ll.InvalidIntent:switch(E=o._I.InvalidIntent,T=b,w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,S){case l.IU.Missing:E=o._I.MissingSubIntent,T=o.G8.SummarizeLLMServiceSideIssue;break;case l.IU.Invalid:E=o._I.InvalidSubIntent,T=o.G8.SummarizeLLMServiceSideIssue}(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut;break;default:w.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,d.r5)(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,y,w),s=o.Nr.ErrorRequestTimedOut}return g.logAshaErrorEvent(T,E,a.SD.Summarize),{errorCode:S,errorKey:s}}},65905:(e,t,n)=>{"use strict";n.d(t,{c:()=>T});var r=n(90813),o=n(12542),i=n(39726),a=n(24643),s=n(69038),l=n(69510),c=n(72218),u=n(44121),d=n(14213),p=n(44632),f=n(18758),h=n(30325),g=n(24464),m=n(18384),y=n(55564),v=n(39041),S=n(9669),C=n(50481),b=p.B.getInstance(),E=d.K.getInstance(),T=function(e,t,n,d,p,T,w,I){var P,_,A=I?i.UY.DisengagedError:null==e?void 0:e.category,k=null==e?void 0:e.message,x=null==e?void 0:e.json,N=c.u1i;try{(0,v.hX)(x)||(P=JSON.parse(x))}catch(e){(0,f.cY)("Exception occred during parsing of json Data for ODSL Error : ".concat(e))}(0,f.cY)("CopilotODSL Annotation Error Detected, Category: ".concat(A,", ErrorMessage: ").concat(k,", JsonData: ").concat(x)),void 0!==P&&(_=P.code);var O,D=o.NW.Fallback,L=o.G8.CommandNotExecuted,R={errorType:"".concat(A,"-").concat(_),featureName:o.CC.Commanding};switch((0,y.Dl)()&&function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=a?i.UY.DisengagedError:null==e?void 0:e.category,l=null==e?void 0:e.json,c=o.av.NoResponseFromSydney,u=o.G8.UnclassifiedAshaError;try{(0,v.hX)(l)||(t=JSON.parse(l))}catch(e){(0,f.cY)("Exception occured during parsing of json Data for ODSL Error : ".concat(e))}void 0!==t&&(n=t.code);var d=null==n?void 0:n.toLowerCase();switch(s.toLowerCase()){case i.Z4.ClientProgramResponseError.toLowerCase():switch(d){case i.iE.ProgramFailed.toLowerCase():c=o.av.ODSLExecutionFailure,u=o.G8.UnclassifiedAshaError;break;case i.iE.Timeout.toLowerCase():c=o.av.ProgramExecutionTimeout,u=o.G8.ResponseDelayedOrTimedOut}break;case i.Z4.DisambiguationError.toLowerCase():switch(d){case i.iE.DisambiguationRequired.toLowerCase():c=o.av.DisambiguationRequired,u=o.G8.ServiceSideIssuePreventsOutput;break;case i.iE.PerpetualDisambiguationLoop.toLowerCase():c=o.av.PerpetualDisambiguationLoop,u=o.G8.ServiceSideIssuePreventsOutput}break;case i.Z4.DisengagedError.toLowerCase():c=o.av.SydneyDisengagement,u=o.G8.UnableToCompleteTask;break;case i.Z4.InferenceAPIError.toLowerCase():switch(d){case i.iE.BadResponse.toLowerCase():c=o.av.BadResponse,u=o.G8.ServiceSideIssuePreventsOutput;break;case i.iE.EmptyResponse.toLowerCase():c=o.av.EmptyGeneratedResponse,u=o.G8.ServiceSideIssuePreventsOutput;break;case i.iE.NotAvailable.toLowerCase():c=o.av.APIUnavailable,u=o.G8.UnclassifiedAshaError;break;case i.iE.OutputRAIDependency.toLowerCase():c=o.av.RAIGeneratedAnswerCheckError,u=o.G8.RAIError;break;case i.iE.Scenario_throttled.toLowerCase():c=o.av.ScenarioThrottled,u=o.G8.UnableToGenerateResponseDueToCapacityIssue;break;case i.iE.Throttled.toLowerCase():c=o.av.Throttled,u=o.G8.UnableToGenerateResponseDueToCapacityIssue;break;case i.iE.TimeOut.toLowerCase():c=o.av.ServerTimeout,u=o.G8.ResponseDelayedOrTimedOut;break;case i.iE.Token.toLowerCase():c=o.av.TokenError,u=o.G8.UserAccessIssueForCopilot;break;case i.iE.Unknown.toLowerCase():c=o.av.UnknownError,u=o.G8.ServiceSideIssuePreventsOutput;break;case i.iE.User_throttled.toLowerCase():c=o.av.UserThrottled,u=o.G8.UnableToGenerateResponseDueToCapacityIssue}break;case i.Z4.InputQueryError.toLowerCase():switch(c=o.av.InvalidInputQuery,u=o.G8.UserInputCouldNotBeProcessed,d){case i.iE.Bad_Token.toLowerCase():c=(0,y.az)()?o.av.InvalidTokens:o.av.InvalidTokensOld;break;case i.iE.DocumentProcessingDenied.toLowerCase():c=o.av.DocumentProcessingDenied;break;case i.iE.Invalid.toLowerCase():c=o.av.InvalidInputQuery;break;case i.iE.OutOfScope.toLowerCase():c=o.av.InputOutOfScope;break;case i.iE.Too_long.toLowerCase():c=o.av.InputTooLong;break;case i.iE.Too_short.toLowerCase():c=o.av.InputTooShort;break;case i.iE.UnsupportedMultiAgent.toLowerCase():c=o.av.UnsupportedMultiAgent}break;case i.Z4.InvalidInputError.toLowerCase():if(u=o.G8.CommandUnableToCompleteTask,d===i.iE.Too_short.toLowerCase())c=o.av.InputContentTooShort;break;case i.Z4.InvalidIntentError.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.Invalid.toLowerCase():c=o.av.InvalidSubIntent;break;case i.iE.Missing.toLowerCase():c=o.av.MissingSubIntent}break;case i.Z4.InvalidLanguageError.toLowerCase():switch(u=o.G8.UnsupportedCopilotFunctionality,d){case i.iE.FailedToGetInputLanguage.toLowerCase():c=o.av.FailedToGetInputLanguage;break;case i.iE.NotSupported.toLowerCase():c=o.av.UnsupportedInputLanguage}break;case i.Z4.InvalidSignalError.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.Missing.toLowerCase():c=o.av.MissingSignalInWorkflow;break;case i.iE.WrongType.toLowerCase():c=o.av.InvalidSignal}break;case i.Z4.LicensingError.toLowerCase():if(u=o.G8.UserAccessIssueForCopilot,d===i.iE.Missing_Service_Plan.toLowerCase())c=o.av.MissingServicePlan;else c=(0,y.az)()?o.av.LicenseValidationFailed:o.av.LicenseValidationFailedOld;break;case i.Z4.ODSLParseError.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.NoOp.toLowerCase():c=o.av.NoEffectProgram;break;case i.iE.Truncated.toLowerCase():c=o.av.TruncatedODSL;break;case i.iE.Unexpected.toLowerCase():c=o.av.ODSLParsingError;break;case i.iE.ZeroParsed.toLowerCase():c=o.av.EmptyODSLCreation}break;case i.Z4.ODSLSyntaxError.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.BadValue.toLowerCase():c=o.av.ODSLArgumentTypeMismatch;break;case i.iE.DismissedInvalidRequiredArguments.toLowerCase():c=o.av.ODSLBadArgumentValue;break;case i.iE.MissingRequiredArguments.toLowerCase():c=o.av.MissingODSLArgument;break;case i.iE.Unexpected.toLowerCase():c=o.av.ODSLSyntaxValidationError;break;case i.iE.UnknownStatement.toLowerCase():c=o.av.ODSLStatementSchemaMismatch;break;case i.iE.Unsupported.toLowerCase():c=o.av.ODSLValueOutOfRange;break;case i.iE.UnsupportedByAdmin.toLowerCase():c=o.av.ODSLStatementBlocked;break;case i.iE.VariableUnknownName.toLowerCase():c=o.av.UndefinedODSLVariableReference;break;case i.iE.VariableWrongType.toLowerCase():c=o.av.ODSLArgumentWrongType}break;case i.Z4.OffensiveContent.toLowerCase():switch(c=o.av.OffensiveContentError,u=o.G8.RAIError,d){case i.iE.Generated_output.toLowerCase():c=o.av.OffensiveGeneratedOutput;break;case i.iE.Generated_sydney_output.toLowerCase():c=o.av.OffensiveGeneratedSydneyOutput;break;case i.iE.Input_content.toLowerCase():c=o.av.OffensiveInputContent;break;case i.iE.Input_query.toLowerCase():c=o.av.OffensiveInputQuery}break;case i.Z4.OffensiveContentError.toLowerCase():switch(u=o.G8.RAIError,d){case i.iE.OffensiveOutputContent.toLowerCase():c=o.av.OffensiveOutputBlocked;break;case i.iE.OutputBlockedByDynamicGuardList.toLowerCase():c=o.av.OutputBlockedByFilters}break;case i.Z4.PostProcessProgramError.toLowerCase():if(d===i.iE.Unsupported_Program.toLowerCase())c=o.av.UnsupportedInputQuery,u=o.G8.UnsupportedCopilotFunctionality;break;case i.Z4.ResolveDelegationsError.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.EmptyGeneratePrompt.toLowerCase():case i.iE.EmptyGenerateSource.toLowerCase():c=o.av.ODSLMissingRequiredArgument;break;case i.iE.GetProgramFailed.toLowerCase():c=o.av.LLMSlideJSONGenerationFailed;break;case i.iE.GetImageDetailsFailed.toLowerCase():c=o.av.LLMImageDetailsGenerationFailed;break;case i.iE.InvalidPrompt.toLowerCase():c=o.av.IncorrectlyFormattedODSL;break;case i.iE.InvalidReplaceTextResponse.toLowerCase():c=o.av.LLMContentGenerationFailed;break;case i.iE.InvalidGenerateSource.toLowerCase():c=o.av.UnparsableODSL;break;case i.iE.InvalidRewriteResponse.toLowerCase():c=o.av.LLMContentRewritingFailed;break;case i.iE.ParseJsonFailed.toLowerCase():c=o.av.SlideJSONParsingFailure;break;case i.iE.InvalidSource.toLowerCase():c=o.av.InvalidFileURL,u=o.G8.UserInputCouldNotBeProcessed}break;case i.Z4.SkillFailedError.toLowerCase():c=o.av.SkillsFailed,u=o.G8.UnclassifiedAshaError;break;case i.Z4.SydneyCancelledError.toLowerCase():if(d===i.iE.Cancelled.toLowerCase())c=o.av.SydneyConnectionCancelled,u=o.G8.UserCancelledResponse;break;case i.Z4.Text2ImageError.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.NoImages.toLowerCase():c=o.av.NoImagesGenerated;break;case i.iE.UnrecognizedBaseUrl.toLowerCase():c=o.av.UnrecognizedText2ImageModelBaseURL;break;case i.iE.ResponseFailed.toLowerCase():c=o.av.Text2ImageModelResponseFailure}break;case i.Z4.TokenCountError.toLowerCase():switch(d){case i.iE.ExcessTokensRequest.toLowerCase():c=o.av.ExcessTokensRequest,u=o.G8.UserInputCouldNotBeProcessed;break;case i.iE.ExcessTokensResponse.toLowerCase():c=o.av.ExcessTokensResponse,u=o.G8.UnableToCompleteTask}break;case i.Z4.UnsupportedLanguageError.toLowerCase():switch(c=o.av.UnsupportedLanguage,u=o.G8.UnsupportedCopilotFunctionality,d){case i.iE.LowScore.toLowerCase():c=o.av.LowLanguageScore;break;case i.iE.SydneyUnsupportedLang.toLowerCase():c=o.av.UnsupportedSydneyLanguage;break;case i.iE.UnknownLang.toLowerCase():c=o.av.UnknownDetectedLanguage;break;case i.iE.Unsupported_language.toLowerCase():c=o.av.UnsupportedLanguage}break;case i.Z4.VisualDescriptionGeneration.toLowerCase():switch(u=o.G8.ServiceSideIssuePreventsOutput,d){case i.iE.Unknown.toLowerCase():c=o.av.VisualDescriptionsGenerationUnknownError;break;case i.iE.FailedToGenerateVisualDescription.toLowerCase():c=o.av.VisualDescriptionsGenerationError}break;case i.HK.UserThrottled:if(d===i.HK.UserThrottled)c=o.av.Throttled}if(r)return E.setAshaErrorString(c),void E.setAshaVetoString(u);var p=o.CC.CopilotChat,h=o._5.UnclearIntent,g=(0,m.A9)(h,u);b.logAshaErrorEvent(g,c,p)}(e,d,I),A){case i.Z4.InferenceAPIError:if(D=o.NW.ServiceBusy,_)switch(_){case i.iE.Throttled:R.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,(0,g.r5)(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,R),O=o.Nr.ErrorServerBusy;break;case i.iE.Timeout:D=o.fj,R.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,(0,g.r5)(t,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,!0,R),O=o.Nr.ErrorRequestTimedOut;break;case i.iE.User_throttled:D=o.NW.UserThrottled,L=o.G8.CommandCapacityIssue,R.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,R),O=o.Nr.ThrottlingErrorMessage;break;case i.iE.Scenario_throttled:D=o.NW.ScenarioThrottled,L=o.G8.CommandCapacityIssue,R.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,R),O=o.Nr.ThrottlingErrorMessage;break;default:R.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,(0,g.r5)(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,R),O=o.Nr.ErrorServerBusy}else R.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,(0,g.r5)(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,R),O=o.Nr.ErrorServerBusy;break;case i.Z4.OffensiveContent:if(D=o.NW.OffensiveContent,void 0!==P)switch(_=P.source){case i.iE.Input_query:D=o.NW.InputQuery,L=o.G8.CommandBlockedResponse,R.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,(0,g.r5)(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,R),O=o.Nr.ErrorOffensiveContentBlocked;break;case i.iE.Generated_output:L=o.G8.CommandBlockedResponse,D=o.NW.GeneratedOutput,R.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,(0,g.r5)(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,R),O=o.Nr.ErrorOffensiveContentBlocked;break;default:R.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,(0,g.r5)(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,R),O=o.Nr.ErrorOffensiveContentBlocked}else R.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,(0,g.r5)(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,R),O=o.Nr.ErrorOffensiveContentBlocked;break;case i.Z4.InputQueryError:if(D=o.NW.InvalidInput,_)switch(_){case i.iE.Too_long:D=o.NW.TooLong,L=o.G8.CommandInputCouldNotBeProcessed,R.errorMessage=PowerpointCopilotStrings.ErrorQueryTooLarge,(0,g.r5)(t,PowerpointCopilotStrings.ErrorQueryTooLarge,void 0,void 0,!0,R),O=o.Nr.ErrorQueryTooLarge;break;case i.iE.Too_short:R.errorMessage=PowerpointCopilotStrings.ErrorQueryTooSmall,(0,g.r5)(t,PowerpointCopilotStrings.ErrorQueryTooSmall,void 0,void 0,!0,R),O=o.Nr.ErrorQueryTooSmall;break;case i.iE.DocumentProcessingDenied:D=o.NW.DocumentPermission,L=o.G8.CommandFileReferencingFailed,R.errorMessage=OfficeaicopilotStrings.DKEAndNotExtractLabelErrorString,(0,g.r5)(t,OfficeaicopilotStrings.DKEAndNotExtractLabelErrorString,void 0,void 0,!0,R),O=o.Nr.DKEAndNotExtractLabelErrorString;break;case i.iE.Bad_Token:D=(0,y.az)()?o.av.InvalidTokens:o.NW.Licensing,R.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,(0,g.r5)(t,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,!0,R),O=o.Nr.LicenseValidationErrorMessage;break;default:R.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,(0,g.r5)(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,R),O=o.Nr.ErrorServerBusy}else R.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,(0,g.r5)(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,R),O=o.Nr.ErrorServerBusy;break;case i.Z4.UnsupportedLanguageError:var F,M,B;if(D=o.NW.InvalidLanguage,p&&(B=(0,v.Pz)(p,PowerpointCopilotStrings.CopilotUnsupportedLanguageError,c.wv1)),B){R.errorMessage=B;var U=(0,y.PA)(y.IY.ShouldAddLinkSuffixForErrorMessage)?"\n\n"+PowerpointCopilotStrings.FeedbackPrompt:"";M={linkText:PowerpointCopilotStrings.CopilotSupportedLanguagesLearnMoreLink,linkPrefix:B,linkSuffix:U},O=o.Nr.CopilotUnsupportedLanguageError}else R.errorMessage=PowerpointCopilotStrings.CopilotUnsupportedlanguageMessage,M={linkText:PowerpointCopilotStrings.LeanMoreHyperlinkText,linkPrefix:PowerpointCopilotStrings.CopilotUnsupportedlanguageMessage,linkSuffix:""},O=o.Nr.CopilotUnsupportedlanguageMessage;null===(F=t.current)||void 0===F||F.addResponseMessage((0,g.FL)(M,n,c.vIf,g.x5,!0,i.Xw.CHATPPT,void 0,void 0,R));break;case i.Z4.InvalidInputError:if(void 0!==_)if(_===i.iE.Too_short)R.errorMessage=PowerpointCopilotStrings.ErrorNotEnoughContent,(0,g.r5)(t,PowerpointCopilotStrings.ErrorNotEnoughContent,void 0,void 0,!0,R),O=o.Nr.ErrorNotEnoughContent;else R.errorMessage=PowerpointCopilotStrings.ErrorInExecution,(0,g.r5)(t,PowerpointCopilotStrings.ErrorInExecution,void 0,void 0,!0,R),O=o.Nr.ErrorInExecution;else R.errorMessage=PowerpointCopilotStrings.ErrorInExecution,(0,g.r5)(t,PowerpointCopilotStrings.ErrorInExecution,void 0,void 0,!0,R),O=o.Nr.ErrorInExecution;break;case i.Z4.LicensingError:D=(0,y.az)()?o.av.LicenseValidationFailed:o.NW.Licensing,R.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,(0,g.r5)(t,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,!0,R),O=o.Nr.LicenseValidationErrorMessage;break;case i.UY.IgnorableError:case i.UY.SydneyError:if(_)switch(_){case i.HK.UserThrottled:D=o.NW.Throttled,R.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,R),O=o.Nr.ThrottlingErrorMessage;break;case i.HK.OutOfCredits:D=o.NW.OutOfCredits,R.errorMessage=(0,c.R_I)(),(0,g.r5)(t,(0,c.R_I)(),void 0,void 0,!0,R),O=o.Nr.OutOfCreditsError;break;default:R.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,R),O=o.Nr.ServerErrorMessage}else R.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,R),O=o.Nr.ServerErrorMessage;break;case i.UY.DisengagedError:D=o.NW.Disengaged,R.errorMessage=PowerpointCopilotStrings.DisengagedError,(0,g.r5)(t,OfficeaicopilotStrings.DisengagedError,void 0,void 0,!0,R),O=o.Nr.DisengagedError;break;case i.Z4.PostProcessProgramError:if((0,y.PA)(y.IY.HandleUnsupportedCommandErrorCode))if(_)if(_===i.iE.Unsupported_Program)(0,f.cY)("User requested command is not supported"),R.errorMessage=PowerpointCopilotStrings.CommandNotSupportedMessage,(0,g.r5)(t,PowerpointCopilotStrings.CommandNotSupportedMessage,void 0,void 0,!0,R),O=o.Nr.CommandNotSupportedMessage;else R.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,R),O=o.Nr.ServerErrorMessage;else R.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,R),O=o.Nr.ServerErrorMessage;break;case i.Z4.ResolveDelegationsError:if((0,y.PA)(y.IY.HandleResolveDelegationInvalidSourceErrorCode)&&_)if(_===i.iE.InvalidSource)(0,f.cY)("Invalid source detected"),R.errorMessage=(0,f.$1)((0,h.wo)())?PowerpointCopilotStrings.DocumentUrlNotFromSharePoint:PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError,(0,g.r5)(t,R.errorMessage,void 0,void 0,!0,R),O=o.Nr.DocumentUrlNotFromSharePoint;else R.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,(0,g.r5)(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,R),O=o.Nr.ServerErrorMessage;break;default:var z=(0,f.gu)(e.message);if(z.actionFound){var H,G;N="UnsupportedActionDetected".concat((0,v.hX)(z.actionType)?c.u1i:"_".concat(z.actionType)),(0,f.cY)("Action only supported in ribbon detected. Action type: "+z.actionType);var V={errorMessage:PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,errorType:i.Qp.ActionOnlySupportedInRibbonMessage,featureName:o.CC.Commanding};null===(H=t.current)||void 0===H||H.addResponseMessage((0,g.qi)(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,g.OT,!1,i.Xw.CHATPPT,void 0,!1,!0,void 0,V)),null===(G=t.current)||void 0===G||G.addResponseMessage((0,g.BK)(z.responseHeader,z.response,g.OT,!0,i.Xw.CHATPPT,void 0,void 0,V)),O=o.Nr.ActionOnlySupportedInRibbonMessage}else{var j,q={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:i.Qp.ServerErrorMessage,featureName:o.CC.Commanding};null===(j=t.current)||void 0===j||j.addResponseMessage((0,g.qi)(PowerpointCopilotStrings.ServerErrorMessage,g.OT,!0,i.Xw.CHATPPT,void 0,!1,!0,void 0,q)),O=o.Nr.ServerErrorMessage}}if((0,y.bw)(y.WT.IsDebugSectionV2Enabled)&&w&&T){var W,Y=[],Q=null===(W=t.current)||void 0===W?void 0:W.getLastMessage(!1);(null==Q?void 0:Q.body.user)===a.Q9.Chat&&((0,g.FY)(Y,C.pq,w,T),Q.actionBarButtons=Y)}var J,X=(0,y.n8)(h.BJ),K="".concat(X?S.c.getTypeName():l.YO.getTypeName(),"_Error");(0,m.AQ)(b,s.qD,K,N===c.u1i?null==e?void 0:e.category.concat((0,v.hX)(_)?c.u1i:"_".concat(_)):N,N===c.u1i?i.T_.Server:i.T_.UnsupportedAction,void 0,void 0,O),b.sendErrorTelemetry((0,m.pN)((J={},(0,r._)(J,o.IC.ErrorCategory,X?o.S2.FluxCopilot:o.S2.CopilotODSL),(0,r._)(J,o.IC.ErrorMessage,X?"Failure Received From PPT Flux Copilot Workflow":"Failure Received From CopilotODSL Workflow"),J))),(0,y.Dl)()||b.logAshaErrorEvent(L,D,u.SD.BasicCommand)}},86204:(e,t,n)=>{"use strict";n.d(t,{R:()=>h});var r=n(90813),o=n(1335),i=n(64855),a=n(44632),s=n(12542),l=n(72218),c=n(18384),u=n(39041),d=n(24464),p=n(44121),f=n(55564);function h(e,t,n,h,g){var m,y=arguments.length>5&&void 0!==arguments[5]&&arguments[5];a.B.getInstance().sendErrorTelemetry((0,c.pN)((m={},(0,r._)(m,s.IC.ErrorMessage,"Error in StoryTeller Workflow , Code : ".concat(o.lC[n],", ErrorMsg: ").concat(h,", Scenario: ").concat(t)),(0,r._)(m,s.IC.ErrorCategory,s.S2.StoryTellerWorkflow),m)));var v,S={errorType:"".concat(o.lC[n]),featureName:t===p.Cu.AddSlide?s.CC.AddSlide:s.CC.CreatePresentationFromDoc};switch(n){case o.lC.ModelContentFilter:(0,f.PA)(f.IY.ShouldUseNewStorytellerErrors)&&(S.errorMessage=PowerpointCopilotStrings.StorytellerRaiBlockedMessage,(0,d.r5)(e,PowerpointCopilotStrings.StorytellerRaiBlockedMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.StorytellerRaiBlockedMessage),v=s.Nr.StorytellerRaiBlockedMessage);break;case o.lC.RaiUnsupportedLanguageInContentInput:case o.lC.RaiUnsupportedLanguageInContentOutput:S.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,(0,d.r5)(e,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.ErrorOffensiveContentBlocked),v=s.Nr.ErrorOffensiveContentBlocked;break;case o.lC.OutOfCredits:if((0,f.PA)(f.IY.EnableProdigiOutOfCreditsErrorHandling)){S.errorMessage=(0,l.R_I)(),(0,d.r5)(e,(0,l.R_I)(),void 0,void 0,!0,S),(0,u.hX)(g)||(g.error=(0,l.R_I)()),v=s.Nr.OutOfCreditsError;break}case o.lC.Overloaded:case o.lC.UserThrottled:case o.lC.ScenarioThrottled:S.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,d.r5)(e,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.ThrottlingErrorMessage),v=s.Nr.ThrottlingErrorMessage;break;case o.lC.BadRequest:(0,f.PA)(f.IY.ShouldUseNewStorytellerErrors)&&(h===i.Kw.LLMOutput_NoTopicSpecified?(S.errorMessage=PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage,(0,d.r5)(e,PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage),v=s.Nr.StorytellerNoTopicSpecifiedMessage):h===i.Kw.LLMOutput_InvalidTopic?t===p.Cu.AddSlide?(S.errorMessage=PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage,(0,d.r5)(e,PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage),v=s.Nr.StorytellerInvalidSlidesTopicMessage):(S.errorMessage=PowerpointCopilotStrings.StorytellerInvalidPresentationTopicMessage,(0,d.r5)(e,PowerpointCopilotStrings.StorytellerInvalidPresentationTopicMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.StorytellerInvalidPresentationTopicMessage),v=s.Nr.StorytellerInvalidPresentationTopicMessage):(S.errorMessage=PowerpointCopilotStrings.StorytellerFailureMessage,(0,d.r5)(e,PowerpointCopilotStrings.StorytellerFailureMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.StorytellerFailureMessage)));break;default:S.errorMessage=PowerpointCopilotStrings.StorytellerFailureMessage,(0,d.r5)(e,PowerpointCopilotStrings.StorytellerFailureMessage,void 0,void 0,y,S),(0,u.hX)(g)||(g.error=PowerpointCopilotStrings.StorytellerFailureMessage),v=s.Nr.StorytellerFailureMessage}return v}},6224:(e,t,n)=>{"use strict";n.d(t,{y:()=>q,l:()=>j});var r=n(43032),o=n(90813),i=n(79490),a=n(69038),s=n(84499),l=n(1216),c=n(1134),u=n(39726),d=n(53154),p=n(17223),f=n(81789),h=n(52318),g=n(12542),m=n(18384),y=n(70825),v=n(1373),S=n(44632),C=n(18758),b=n(14213),E=n(39041),T=n(74930),w=n(27465),I=n(1335),P=n(44121),_=n(29336),A=n(50481),k=n(23343),x=n(86204),N=n(72218),O=n(24464),D=n(55564),L=n(92097);function R(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];t.errorMessage=n,(0,O.r5)(e,n,void 0,void 0,o,t),(0,E.hX)(r)||(r.error=n)}var F,M,B=n(40389),U=n(65817),z=n(21659),H=n(13403),G=b.K.getInstance(),V=S.B.getInstance(),j=(M=(0,r._)((function(){var e,t,n,r,S,C,b,E,T,w,I=arguments;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return e=I.length>0&&void 0!==I[0]?I[0]:null,t=I.length>1?I[1]:void 0,n=I.length>2?I[2]:void 0,S=p.t.getInstance().getChatRef(),F=(new Date).getTime(),f.R.getInstance().getState()!==u.Nj.IDLE&&d.G.getInstance().addContextId(a.dB),b=Object.assign,E=[new s.l],T={prompt:null!==e?e:"",outputLanguage:h.U9,correlationId:a.dB},[4,(0,c.Oc)(t)];case 1:return T.selectedSlide=i.sent(),[4,(0,c.Oc)(t,n)];case 2:return C=b.apply(Object,E.concat([(T.after=i.sent(),T.entryPoint=N.$kB.Chat,T)])),w=new y.Xr({parentPath:["Signal",s.l.getTypeName()],items:[{id:v.r.generateId(),body:C}]}),f.R.getInstance().getState()===u.Nj.IDLE||(null===(r=S.current)||void 0===r||r.submitOperation({operation:w,workflowAnnotationType:l.C.getTypeName()}),V.sendChatEventTelemetry((0,m.pN)((0,o._)({},g.h3.ChatEventType,g.a5.AddSlideOperationSubmitted))),f.R.getInstance().setState(u.Nj.WAITING_FOR_ADDSLIDE_WF_RESPONSE)),[2]}}))})),function(){return M.apply(this,arguments)}),q=function(){var e=(0,r._)((function(e,t,n,s,c,p){var y,v,S,b,x,L,R,M,j,q,Y,Q,J,X,K,Z,$,ee,te,ne,re,oe,ie;return(0,i.__generator)(this,(function(ae){switch(ae.label){case 0:return(0,C.cY)("".concat(l.C.getTypeName()," response received\n Time Taken: ").concat((0,a.WU)(F),"s ")),f.R.getInstance().getState()===u.Nj.IDLE?((0,C.cY)("CopilotODSLAnnotationProcessor: ExecutionStateManager is in IDLE state. Returning"),[2]):(G.setResponseTime((0,a.WU)(a.qD)),f.R.getInstance().setState(u.Nj.EXECUTING),y=e.body,v=null==y?void 0:y.addSlidePayloads,S=null==y?void 0:y.status,b={status:u.rI.SUCCESS},void 0!==y.correlationId&&(0,m.Zp)(y.correlationId),x=V.getQueryGuid(),(0,m.$j)(V,l.C.getTypeName(),F,g.CT.AddSlideWorkflowResponseTime,g.CC.AddSlide,p),L=null==y?void 0:y.debugMetadata,(0,E.hX)(L)||(0,C.cY)("AddSlide debugData: ".concat(JSON.stringify(L))),G.setScenarioName(P.Cu.AddSlide),_.r.getInstance().setSkillName(u.B2.AddSlide),R=new T.DA({status:w.Aw.failed,queryId:x,error:void 0}),(null==S?void 0:S.code)===I.lC.Success?[3,2]:[4,W(t,S,R)]);case 1:return ae.sent(),[2];case 2:if(M=(new Date).getTime(),j=[],(q=(null==v?void 0:v.length)?v[0]:void 0)?(j=q.jsonCmdPayload.cmds,(0,C.cY)("JSON commands generated from Augloop, total payloads count: ".concat(v.length))):((0,C.cY)("Response is undefined"),b={status:u.rI.FAILED}),!(j.length>0))return[3,7];J={scenarioName:G.getScenarioName(),startTime:G.getStartTime(),entryPoint:N.$kB.Chat,correlationId:x,timeToODSLMS:1e3*G.getResponseTime(),timeODSLToJOfcMS:0,capability:G.getCapability(),featureName:G.getFeatureName(),subFeatureName:G.getSubFeatureName(),querySubmitTime:a.qD},(0,C.cY)("scenarioOptions : ",JSON.stringify(J)),X={scenarioOptions:JSON.stringify(J)},(0,E.hX)(null===(Y=q.jsonCmdOptions)||void 0===Y?void 0:Y.designerOptions)||(X.designerOptions=JSON.stringify(q.jsonCmdOptions.designerOptions)),(0,E.hX)(null===(Q=q.jsonCmdOptions)||void 0===Q?void 0:Q.selectionOptions)||(X.selectionOptions=JSON.stringify(q.jsonCmdOptions.selectionOptions)),ae.label=3;case 3:return ae.trys.push([3,5,,6]),(0,B.dD)()?s(!0):s(!1),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,U.Rf)(e,j,X)];case 1:return b=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 4:return ae.sent(),(0,C.cY)("log result : ",JSON.stringify(b)),[3,6];case 5:return K=ae.sent(),(0,C.cY)("Execution failed"+JSON.stringify(K)),b={status:u.rI.FAILED,error:u.Re.JOFC_EXCEPTION},[3,6];case 6:return(0,D.PA)(D.IY.IsJofcCommandErrorTelemetryEnabled)&&b.status!==u.rI.SUCCESS&&V.sendChatEventTelemetry((0,m.pN)(($={},(0,o._)($,g.h3.ChatEventType,g.a5.AddSlideJOfcCommandsError),(0,o._)($,g.h3.ChatEventParameters,u.Re[null!==(Z=b.error)&&void 0!==Z?Z:u.Re.UNKNOWN_ERROR]),$))),[3,8];case 7:(0,k.k)(!1,"AddSlideWorkflow_NoCmdsGenerated",G.getScenarioName()),ae.label=8;case 8:switch(V.sendLatencyTelemetry((0,m.pN)((0,o._)({},g.CT.QueryExecutionTime,(0,a.WU)(M)))),ee=h.Lo.length>0&&""!==h.Lo[0]&&(0,E._r)(h.U9),b.status){case u.rI.BLOCKED:case u.rI.UNSUPPORTED:case u.rI.FAILED:case u.rI.UNEXPECTED_VERSION:case u.rI.USER_ABORTED:case u.rI.PARTIAL_SUCCESS:return[3,9];case u.rI.SUCCESS:return[3,10]}return[3,12];case 9:return(0,H.af)(b,t,c,l.C.getTypeName(),R,!(0,A.w_)()),[3,12];case 10:return R.status=w.Aw.success,[4,(0,A.Yb)(u.rI.SUCCESS)];case 11:return ae.sent(),ne={linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseAddSlidePrefix,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseAddSlideLine2},ee&&(ne.linkPrefix=h.Lo.filter((function(e){return e})).join(" ")+" "),re=!(0,A.w_)(),oe={featureName:G.getFeatureName(),subFeatureName:g.Ff.AddSlide},null===(te=t.current)||void 0===te||te.addResponseMessage((0,O.FL)(ne,n,void 0,O.tc,re,u.Xw.CHATPPT,void 0,void 0,oe)),V.sendChatEventTelemetry((0,m.pN)((ie={},(0,o._)(ie,g.h3.ChatEventType,g.a5.QuerySuccessful),(0,o._)(ie,g.h3.ChatEventParameters,l.C.getTypeName()),ie))),(0,m.AQ)(V,a.qD,void 0,void 0,void 0,void 0,re),[3,12];case 12:return G.resetData(),(0,A.gj)()?[3,13]:(f.R.getInstance().setState(u.Nj.IDLE),d.G.getInstance().emptyContextIdListandCleanup(),[3,15]);case 13:return[4,(0,A.Ge)(R,t)];case 14:ae.sent(),ae.label=15;case 15:return[4,(0,z.Ep)(t)];case 16:return ae.sent(),[2]}}))}));return function(t,n,r,o,i,a){return e.apply(this,arguments)}}(),W=function(){var e=(0,r._)((function(e,t,n){var r;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(0,C.cY)("Error from AddSlide WF status error name : ".concat(null==t?void 0:t.errorName,"\n error response : ").concat(null==t?void 0:t.errorMessage)),r=(0,D.PA)(D.IY.IsAddSlideErrorHandlerEnabled)?function(e,t,n,r,i){var a,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=n?"".concat(L.O[n]):"";S.B.getInstance().sendErrorTelemetry((0,m.pN)((a={},(0,o._)(a,g.IC.ErrorMessage,"Error in Add Slide Workflow , Code : ".concat(l,", ErrorMsg: ").concat(r,", Scenario: ").concat(t)),(0,o._)(a,g.IC.ErrorCategory,g.S2.AddSlideWorkflow),a)));var c,u={errorType:l,featureName:g.CC.AddSlide};switch(n){case L.O.raiBlockedContent:R(e,u,PowerpointCopilotStrings.StorytellerRaiBlockedMessage,i,s),c=g.Nr.StorytellerRaiBlockedMessage;break;case L.O.outOfCredits:(0,D.PA)(D.IY.EnableProdigiOutOfCreditsErrorHandling)&&(R(e,u,(0,N.R_I)(),i,!0),c=g.Nr.OutOfCreditsError);break;case L.O.resourceThrottled:case L.O.userThrottled:case L.O.scenarioThrottled:R(e,u,PowerpointCopilotStrings.ThrottlingErrorMessage,i,s),c=g.Nr.ThrottlingErrorMessage;break;case L.O.noTopicSpecified:R(e,u,PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage,i,s),c=g.Nr.StorytellerNoTopicSpecifiedMessage;break;case L.O.unreadableTopic:R(e,u,PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage,i,s),c=g.Nr.StorytellerInvalidSlidesTopicMessage;break;default:R(e,u,PowerpointCopilotStrings.AddSlideFailureMessage,i,s),c=g.Nr.AddSlideFailureMessage}return c}(e,P.Cu.AddSlide,null==t?void 0:t.errorName,null==t?void 0:t.errorMessage,n,!(0,A.w_)()):(0,x.R)(e,P.Cu.AddSlide,null==t?void 0:t.code,null==t?void 0:t.errorMessage,n,!(0,A.w_)()),(0,m.AQ)(V,a.qD,"".concat(l.C.getTypeName(),"_Error"),null==t?void 0:t.errorName,u.T_.Server,void 0,!(0,A.w_)(),r),(0,A.gj)()?[3,1]:(f.R.getInstance().setState(u.Nj.IDLE),d.G.getInstance().emptyContextIdListandCleanup(),[3,3]);case 1:return[4,(0,A.Ge)(n,e)];case 2:i.sent(),i.label=3;case 3:return(0,k.k)(!1,"AddSlideWorkflow_".concat(null==t?void 0:t.errorName),G.getScenarioName()),G.resetData(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}()},48694:(e,t,n)=>{"use strict";n.d(t,{Bx:()=>q,Mp:()=>G,SQ:()=>V,uK:()=>J,wW:()=>Q});var r,o=n(43032),i=n(90813),a=n(57835),s=n(61838),l=n(79490),c=n(70825),u=n(53154),d=n(39726),p=n(69038),f=n(85535),h=n(8349),g=n(17235),m=n(85658),y=n(17223),v=n(72218),S=n(44121),C=n(29336),b=n(43277),E=n(37745),T=n(18384),w=n(66888),I=n(44632),P=n(12542),_=n(18758),A=n(24464),k=n(39041),x=n(29862),N=n(50481),O=n(32854),D=n(5851),L=n(23343),R=n(89375),F=n(98483),M=n(21659),B=n(55564),U=n(9669),z=I.B.getInstance(),H=!1,G=!1,V=(r=(0,o._)((function(e,t,n,r,o){var a,s,c,g,m,y,b,E,w,I,A,x,D,F,M,U,V;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return a=null==e?void 0:e.body,s=null==a?void 0:a.intent,c=null==a?void 0:a.summary,g=null==a?void 0:a.error,m=null==a?void 0:a.queryId,H=null!==(y=null==a?void 0:a.isVisual)&&void 0!==y&&y,G=null!==(b=null==a?void 0:a.analyzingVisuals)&&void 0!==b&&b,w=null!==(E=null==a?void 0:a.chatMessageHeader)&&void 0!==E?E:void 0,(0,_.cY)("".concat(h.yG.getTypeName()," response. Time Taken : ").concat((0,p.WU)(p.qD)," sec \n, intent: ").concat(s," \n, Summary : ").concat(c)),void 0!==m&&(0,T.Zp)(m),(0,N.w_)()||(!(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)||(0,O.AN)(s)&&W()||!(0,O.AN)(s))&&u.G.getInstance().removeContextId(null===(I=e.body)||void 0===I?void 0:I.queryId),C.r.getInstance().setSkillName(d.B2.Summary),(0,T.$j)(z,h.yG.getTypeName(),0===r?p.qD:r,P.CT.SummaryResponseTime,P.CC.Summary,o),z.logTriedEvent(S.SD.Summarize,Q(s),f.RX.Summarize),z.sendChatEventTelemetry((0,T.pN)((F={},(0,i._)(F,P.h3.ChatEventType,P.a5.ResponseReceivedFromAL),(0,i._)(F,P.h3.ChatEventParameters,h.yG.getTypeName()),(0,i._)(F,P.h3.IsFromCache,null!==(A=null==a?void 0:a.fromCache)&&void 0!==A&&A),(0,i._)(F,P.h3.IsVisual,null!==(x=null==a?void 0:a.isVisual)&&void 0!==x&&x),(0,i._)(F,P.h3.IsAnalyzingVisual,null!==(D=null==a?void 0:a.analyzingVisuals)&&void 0!==D&&D),F))),z.sendChatEventTelemetry((0,T.pN)((M={},(0,i._)(M,P.h3.ChatEventType,P.a5.SummaryIntentDetectedFromAL),(0,i._)(M,P.h3.ChatEventParameters,s),M))),U=!(0,N.w_)(),void 0!==(null==g?void 0:g.category)?(V=(0,R.z)(g,s,t,!(0,N.w_)()).errorCode,(0,T.AQ)(z,p.qD,"".concat(h.yG.getTypeName(),"_Error"),g.category.concat((0,k.jw)(V)?v.u1i:"_".concat(V)),d.T_.Server,void 0,U),(0,L.k)(!1,"SummaryWorkflow_".concat(g.category),S.Cu.Summary),[2]):[4,j(c,s,n,t,w)];case 1:return l.sent()?(0,L.k)(!0,void 0,S.Cu.Summary):((0,T.AQ)(z,p.qD,"".concat(h.yG.getTypeName(),"_Error"),"IncorrectResponse",d.T_.Server,void 0,U),(0,L.k)(!1,"SummaryWorkflow_IncorrectResponse",S.Cu.Summary)),[2]}}))})),function(e,t,n,o,i){return r.apply(this,arguments)}),j=function(){var e=(0,o._)((function(e,t,n,r,o){var c,u,f,m,y,C,b,E,w,I,k,L,R,F,U,H,G,V,j,q,Q,J,X,K,Z,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be,Ee,Te;return(0,l.__generator)(this,(function(l){c=[],u={featureName:P.CC.Summary,subFeatureName:(0,O.AN)(t)&&W()?P.Ff.VisualSummary:P.Ff.Summarize};try{c=JSON.parse(e)}catch(e){return(0,_.cY)("Error in parsing summary response",e.message),m=(0,s._)((0,a._)({},u),{errorMessage:PowerpointCopilotStrings.ErrorRequestTimedOut,errorType:d.Qp.ParseSummaryError}),null===(f=r.current)||void 0===f||f.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.ErrorRequestTimedOut,A.OT,!0,d.Xw.CHATPPT,void 0,!1,!0,void 0,m)),z.sendErrorTelemetry((0,T.pN)((y={},(0,i._)(y,P.IC.ErrorMessage,"Error parsing summary response, ".concat(e.message)),(0,i._)(y,P.IC.ErrorCategory,P.S2.Summary),y))),[2,!1]}if(C=!(0,N.w_)(),b=[],t===g.N.Summary||t===g.N.SegmentedSummary||t===g.N.StyledSummary){w=[],I=!0,k=!1,L=void 0;try{for(R=c[Symbol.iterator]();!(I=(F=R.next()).done);I=!0)U=F.value,(H={title:"",text:""}).title=U.topic+": ",H.text=(0,x.LE)(U)?(0,x.lM)(U.keyPoint,b,U.citations):U.keyPoint,w.push(H)}catch(e){k=!0,L=e}finally{try{I||null==R.return||R.return()}finally{if(k)throw L}}t!==g.N.SegmentedSummary&&t!==g.N.StyledSummary||(u.subFeatureName=t===g.N.SegmentedSummary?P.Ff.SegmentedSummary:P.Ff.StyledSummary,null===(G=r.current)||void 0===G||G.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.UnsupportedSummaryError,A.tc,!1,d.Xw.DECKSUMMARY,S.SD.Summarize,!1,!0,void 0,u))),n>(0,M.Wo)()&&(j=(0,s._)((0,a._)({},u),{errorMessage:PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",(0,M.Wo)().toString()),errorType:d.Qp.TooLargeContentToSummarizeError}),null===(V=r.current)||void 0===V||V.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",(0,M.Wo)().toString()),A.tc,!1,d.Xw.DECKSUMMARY,S.SD.Summarize,!1,!0,void 0,j)),z.sendErrorTelemetry((0,T.pN)((q={},(0,i._)(q,P.IC.ErrorMessage,"Word Count does not meet max bar requirement"),(0,i._)(q,P.IC.ErrorCategory,P.S2.Summary),q))),z.sendChatEventTelemetry((0,T.pN)((Q={},(0,i._)(Q,P.h3.ChatEventType,P.a5.MoreWordCount),(0,i._)(Q,P.h3.ChatEventParameters,"WordCountError"),Q)))),J=(0,O.AN)(t)&&W()?P.Ff.VisualSummary:P.Ff.Summarize,u.subFeatureName=J,X=(0,A.Wm)(w,(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)&&(0,O.AN)(t)&&W()?v.f4e:PowerpointCopilotStrings.AssistantResponseSummarizePrefix,(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)&&(0,O.AN)(t)&&W()?PowerpointCopilotStrings.AssistantResponseSummarizeSuffix:(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)&&(0,O.AN)(t)&&Y()?v.Fhl:PowerpointCopilotStrings.AssistantResponseSummarizeSuffix,PowerpointCopilotStrings.SummaryMainIdeas,(0,s._)((0,a._)({},A.tc),{chatMessageHeaderData:(0,A.Ne)(o)}),!((0,O.AN)(t)&&Y()),d.Xw.DECKSUMMARY,S.SD.Summarize,J,u),b.length>0&&(X.chatMessageBodyData=(0,s._)((0,a._)({},X.chatMessageBodyData),{references:b})),X.startAugloopTimerForStreaming=(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)&&(0,O.AN)(t)&&Y(),null===(E=r.current)||void 0===E||E.addResponseMessage(X),(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)&&(0,O.AN)(t)&&Y()&&(null===(K=r.current)||void 0===K||K.updateLoadingComponentProps((0,a._)({loadingUiStringList:null!==(Z=(0,D.A)().get(d.Ae.PresentationSummaryWithVisual))&&void 0!==Z?Z:[]},(0,O.$2)())))}else if(t===g.N.CallsForAction){ee={listItems:[],listHeader:""},te=[],ne=[],re=!0,oe=!1,ie=void 0;try{for(ae=c[Symbol.iterator]();!(re=(se=ae.next()).done);re=!0)le=se.value,ce=le.action,(0,x.LE)(le)&&(ce=(0,x.lM)(ce,b,le.citations)),"inferred"===(ue=le.source)?ne.push({text:ce}):"explicit"===ue&&te.push({text:ce})}catch(e){oe=!0,ie=e}finally{try{re||null==ae.return||ae.return()}finally{if(oe)throw ie}}if(te.length>0)ee.listHeader=PowerpointCopilotStrings.SummaryActionItems,ee.listItems=te;else{if(!(ne.length>0))return pe=(0,s._)((0,a._)({},u),{errorMessage:PowerpointCopilotStrings.SummaryNoActionItemsIdentified,errorType:d.Qp.SummaryNoActionItemsIdentified}),null===(de=r.current)||void 0===de||de.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.SummaryNoActionItemsIdentified,A.tc,!(0,N.w_)(),d.Xw.DECKSUMMARY,S.SD.Summarize,!1,!0,void 0,pe)),z.sendChatEventTelemetry((0,T.pN)((fe={},(0,i._)(fe,P.h3.ChatEventType,P.a5.CallsToActionResponseShown),(0,i._)(fe,P.h3.ChatEventParameters,"NO_ACTION_ITEMS"),fe))),(0,T.AQ)(z,p.qD,void 0,void 0,void 0,void 0,C),[2,!0];ee.listHeader=PowerpointCopilotStrings.SummaryActionItemsInferred,ee.listItems=ne}null===($=r.current)||void 0===$||$.addResponseMessage((0,A.Wm)(ee.listItems,void 0,void 0,ee.listHeader,(0,s._)((0,a._)({},A.tc),{chatMessageHeaderData:(0,A.Ne)(o),references:b}),!0,d.Xw.DECKSUMMARY,S.SD.Summarize,void 0,u))}else if(t===g.N.ImportantSlides){ge=[],me=!0,ye=!1,ve=void 0;try{for(Se=c[Symbol.iterator]();!(me=(Ce=Se.next()).done);me=!0)be=Ce.value,(Ee={text:"",title:""}).title=be.slideTitle+": ",Ee.text="Slide ".concat(be.slideNumber),ge.push(Ee)}catch(e){ye=!0,ve=e}finally{try{me||null==Se.return||Se.return()}finally{if(ye)throw ve}}null===(he=r.current)||void 0===he||he.addResponseMessage((0,A.Wm)(ge,PowerpointCopilotStrings.SummaryImportantSlides,void 0,void 0,(0,s._)((0,a._)({},A.tc),{chatMessageHeaderData:(0,A.Ne)(o)}),!(0,N.w_)(),d.Xw.DECKSUMMARY,S.SD.Summarize,void 0,u))}return(0,N.K2)(h.yG.getTypeName(),(0,p.WU)(p.qD),!1),z.sendChatEventTelemetry((0,T.pN)((Te={},(0,i._)(Te,P.h3.ChatEventType,P.a5.QuerySuccessful),(0,i._)(Te,P.h3.ChatEventParameters,P.S2.Summary),Te))),(0,T.AQ)(z,p.qD,void 0,void 0,void 0,void 0,C),[2,!0]}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),q=function(){var e=(0,o._)((function(){var e,t,n,r,o,a,s,u;return(0,l.__generator)(this,(function(l){return t=(0,B.bw)(B.WT.EnabledSecondaryComprehensionSignal),n=y.t.getInstance(),r=n.getChatRef(),o=(0,F.A)(),a={intent:g.N.Summary,queryLanguage:(0,_.Zi)((0,E.hD)(b.i.GetHostAppDisplayLanguage())),queryId:o,isStreaming:!1,source:d.bV.AppChat_PreFetchQuery},s=t?new c.Xr({parentPath:["Signal",m.Rm.getTypeName()],items:[{id:w.r.generateId(),body:new m.Rm(a)}]}):new c.Xr({parentPath:["Signal",m.Bc.getTypeName()],items:[{id:w.r.generateId(),body:new m.Bc(a)}]}),z.sendChatEventTelemetry((0,T.pN)((u={},(0,i._)(u,P.h3.ChatEventType,P.a5.SummarizationOperationSubmitted),(0,i._)(u,P.h3.UserQueryGuid,o),(0,i._)(u,P.h3.RequestSignalSource,d.bV.AppChat_PreFetchQuery),(0,i._)(u,P.h3.ChatEventParameters,"SecondarySignalEnabled: ".concat(t)),u))),null===(e=r.current)||void 0===e||e.submitOperation({operation:s,workflowAnnotationType:h.yG.getTypeName()}),[2]}))}));return function(){return e.apply(this,arguments)}}(),W=function(){return H},Y=function(){return!!(0,B.bw)(B.WT.IsVisualSummaryUIEnabled)&&G},Q=function(e){switch(e){case g.N.Summary:case g.N.SegmentedSummary:case g.N.StyledSummary:return P.Ff.Summarize;case g.N.CallsForAction:return P.Ff.ShowActionItems;case g.N.ImportantSlides:return P.Ff.KeySlides}return P.Ff.Unset},J=function(){var e,t,n,r=(0,B.bw)(B.WT.EnabledSecondaryComprehensionSignal),o=y.t.getInstance().getChatRef(),a=(0,F.A)(),s="".concat(v.v3k,"_").concat(a),l={intent:g.N.Summary,queryLanguage:(0,_.Zi)((0,E.hD)(b.i.GetHostAppDisplayLanguage())),queryId:s,isStreaming:!1,source:d.bV.InsightCard_Query};t=r?new c.Xr({parentPath:["Signal",m.Rm.getTypeName()],items:[{id:w.r.generateId(),body:new m.Rm(l)}]}):new c.Xr({parentPath:["Signal",m.Bc.getTypeName()],items:[{id:w.r.generateId(),body:new m.Bc(l)}]}),null===(e=o.current)||void 0===e||e.submitOperation({operation:t,workflowAnnotationType:U.c.getTypeName()},!0),(0,_.cY)("Summarization operation for InsightCard submitted",t),z.sendChatEventTelemetry((0,T.pN)((n={},(0,i._)(n,P.h3.ChatEventType,P.a5.SummarizationOperationForInsightCardSubmitted),(0,i._)(n,P.h3.UserQueryGuid,s),(0,i._)(n,P.h3.RequestSignalSource,d.bV.InsightCard_Query),(0,i._)(n,P.h3.ChatEventParameters,"SecondarySignalEnabled: ".concat(r)),n)))}},72702:(e,t,n)=>{"use strict";n.d(t,{Pb:()=>Q,O0:()=>X,a3:()=>J});var r=n(43032),o=n(90813),i=n(57835),a=n(61838),s=n(79490),l=n(70825),c=n(53154),u=n(72218),d=n(45002),p=n(54009),f=n(10813),h=n(55564),g=n(39726),m=n(73606),y=n(44632),v=n(12542),S=n(18758),C=n(18384),b=n(44001),E=n(39041),T=n(24464),w=n(30325);function I(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,a=e[0];if(!(0,E.hX)(a)){var s;(0,S.cY)("Error in contentProcessing, Type : ".concat(a.errorType,", Message : ").concat(a.message,"\n")),y.B.getInstance().sendErrorTelemetry((0,C.pN)((s={},(0,o._)(s,v.IC.ErrorMessage,"Error in contentProcessing Workflow , Type : ".concat(a.errorType)),(0,o._)(s,v.IC.ErrorCategory,v.S2.ContextIQ),s)));var l={errorType:"".concat(a.errorType),featureName:v.CC.CreatePresentationFromDoc};if((0,h.PA)(h.IY.ShowSpecificErrorsForEncryptedFiles)){var c=new Map([[u.oKZ,PowerpointCopilotStrings.TransformFileDocumentHasUDPLabelError],[u.FVn,PowerpointCopilotStrings.TransformFileDocumentHasUnsupportedLabelTypeError],[u.vQp,PowerpointCopilotStrings.TransformFileDocumentHasOtherExpectedProtectionError],[u.yWt,PowerpointCopilotStrings.TransformFileUserHasNoRightsInLabelError],[u.W$r,PowerpointCopilotStrings.TransformFileUserHasNoExtractRightsInLabelError],[u.fLf,(0,b.iZ)().errorString],[u._1d,PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted]]),d=!0,f=!1,g=void 0;try{for(var m,I=c.keys()[Symbol.iterator]();!(d=(m=I.next()).done);d=!0){var P=m.value;if(a.message.includes(P)){var _=c.get(P);return l.errorMessage=_,(0,T.r5)(t,_,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=_),v.Nr.DocumentPasswordProtectedOrEncrypted}}}catch(e){f=!0,g=e}finally{try{d||null==I.return||I.return()}finally{if(f)throw g}}}switch(a.errorType){case p.jz.Encrypted:l.errorMessage=PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted,(0,T.r5)(t,PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted),n=v.Nr.DocumentPasswordProtectedOrEncrypted;break;case p.jz.DocumentTooLarge:l.errorMessage=PowerpointCopilotStrings.DocumentTooLargeToDownloadError,(0,T.r5)(t,PowerpointCopilotStrings.DocumentTooLargeToDownloadError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.DocumentTooLargeToDownloadError),n=v.Nr.DocumentTooLargeToDownloadError;break;case p.jz.DocumentIrmProtected:var A=(0,b.iZ)(),k=A.errorString;n=A.errorKey||n,l.errorMessage=k,(0,T.r5)(t,k,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=k);break;case p.jz.DocumentNotFound:l.errorMessage=(0,S.$1)((0,w.wo)())?PowerpointCopilotStrings.DocumentNotFoundToTransformError:PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError,(0,T.r5)(t,l.errorMessage,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=l.errorMessage),n=v.Nr.DocumentNotFoundToTransformError;break;case p.jz.ContentTooShort:l.errorMessage=PowerpointCopilotStrings.DocumentTooShortToTransformError,(0,T.r5)(t,PowerpointCopilotStrings.DocumentTooShortToTransformError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.DocumentTooShortToTransformError),n=v.Nr.DocumentTooShortToTransformError;break;case p.jz.DocumentDownloadFailed:l.errorMessage=PowerpointCopilotStrings.DocumentDownloadFailedError,(0,T.r5)(t,PowerpointCopilotStrings.DocumentDownloadFailedError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.DocumentDownloadFailedError),n=v.Nr.DocumentDownloadFailedError;break;case p.jz.Unauthorized:l.errorMessage=PowerpointCopilotStrings.CLPNoAccessPermission,(0,T.r5)(t,PowerpointCopilotStrings.CLPNoAccessPermission,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.CLPNoAccessPermission),n=v.Nr.CLPNoAccessPermission;break;case p.jz.RMSDisabled:l.errorMessage=PowerpointCopilotStrings.TransformFileSPSensitivityLabelsDisabledError,(0,T.r5)(t,PowerpointCopilotStrings.TransformFileSPSensitivityLabelsDisabledError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.TransformFileSPSensitivityLabelsDisabledError),n=v.Nr.RMSDisabled;break;case p.jz.UnsupportedFileType:var x=function(e,t){var n,r;if(t)switch(t){case"Excel":case"ExcelXls":r=PowerpointCopilotStrings.UnsupportedExcelFileError,n=v.Nr.UnsupportedExcelFileError;break;case"PowerPoint":case"PowerPointPpt":r=PowerpointCopilotStrings.UnsupportedPptFileError,n=v.Nr.UnsupportedPptFileError;break;case"Pdf":r=PowerpointCopilotStrings.UnsupportedPdfFileError,n=v.Nr.UnsupportedPdfFileError;break;case"WordDoc":r=PowerpointCopilotStrings.UnsupportedWordFileError,n=v.Nr.UnsupportedWordFileError;break;default:e.includes(u.R4r)?(r=PowerpointCopilotStrings.UnsupportedWordFileError,n=v.Nr.UnsupportedWordFileError):(r=PowerpointCopilotStrings.UnsupportedFileError,n=v.Nr.UnsupportedFileError)}else r=PowerpointCopilotStrings.UnsupportedFileError,n=v.Nr.UnsupportedFileError;return{errorString:r,errorKey:n}}(a.message,a.customErrorData),N=x.errorString,O=x.errorKey;l.errorMessage=N,(0,T.r5)(t,N,void 0,void 0,r,l),n=O||n,(0,E.hX)(i)||(i.error=N);break;case p.jz.InvalidInput:var D=PowerpointCopilotStrings.DocumentUrlInvalidError;n=v.Nr.DocumentUrlInvalidError,a.message.includes(u.oTl)&&(D=PowerpointCopilotStrings.DocumentUrlEmptyError,n=v.Nr.DocumentUrlEmptyError),l.errorMessage=D,(0,T.r5)(t,D,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=D);break;case p.jz.Consumer:l.errorMessage=PowerpointCopilotStrings.ErrorConsumerQueryTranformFile,(0,T.r5)(t,PowerpointCopilotStrings.ErrorConsumerQueryTranformFile,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.ErrorConsumerQueryTranformFile),n=v.Nr.ErrorConsumerQueryTranformFile;break;case p.jz.FailedToGetSensitivityLabels:l.errorMessage=PowerpointCopilotStrings.CLPGeneralSensitivityLabelError,(0,T.r5)(t,PowerpointCopilotStrings.CLPGeneralSensitivityLabelError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.CLPGeneralSensitivityLabelError),n=v.Nr.CLPGeneralSensitivityLabelError;break;case p.jz.UserTokenUnavailable:l.errorMessage=PowerpointCopilotStrings.DocumentAccessPermissionError,(0,T.r5)(t,PowerpointCopilotStrings.DocumentAccessPermissionError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.DocumentAccessPermissionError),n=v.Nr.DocumentAccessPermissionError;break;case p.jz.CopilotLicensingError:l.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,(0,T.r5)(t,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=OfficeaicopilotStrings.LicenseValidationErrorMessage),n=v.Nr.LicenseValidationErrorMessage;break;case p.jz.SegmentationError:case p.jz.Error:default:l.errorMessage=PowerpointCopilotStrings.TransformFileGeneralError,(0,T.r5)(t,PowerpointCopilotStrings.TransformFileGeneralError,void 0,void 0,r,l),(0,E.hX)(i)||(i.error=PowerpointCopilotStrings.TransformFileGeneralError),n=v.Nr.TransformFileGeneralError}}return n}var P,_,A,k=n(69038),x=n(17223),N=n(81789),O=n(44121),D=n(29336),L=n(34045),R=n(43277),F=n(66888),M=n(74930),B=n(27465),U=n(32854),z=n(4085),H=n(50481),G=n(23343),V=n(98483),j=n(13403),q=n(37542).Buffer,W=y.B.getInstance(),Y=new Map,Q=(A=(0,r._)((function(){var e,t,n,y,E,T,w,I,A,O,G,J,X,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce=arguments;return(0,s.__generator)(this,(function(be){switch(be.label){case 0:if(e=Ce.length>0&&void 0!==Ce[0]?Ce[0]:[],t=Ce.length>1?Ce[1]:void 0,_=!1,y=m.n.getInstance(),N.R.getInstance().getState()===g.Nj.IDLE)return[2];if(W.sendChatEventTelemetry((0,C.pN)((E={},(0,o._)(E,v.h3.ChatEventType,v.a5.MultipleFileSourcesDetected),(0,o._)(E,v.h3.ChatEventParameters,e.length>1),E))),T=k.dB===u.u1i?(0,V.A)():k.dB,w=x.t.getInstance().getChatRef(),!(0,h.bw)(h.WT.IsContentValidatorWorkflowEnabled))return[3,17];I=(0,h.bw)(h.WT.IsEmptyLabelFixForCLPv2FeatureEnabled),A=!1,O=T+(0,U.gl)(e.join("")),G=!0,J=!1,X=void 0,be.label=1;case 1:be.trys.push([1,9,10,11]),$=e[Symbol.iterator](),be.label=2;case 2:return(G=(ee=$.next()).done)?[3,8]:(te=ee.value,(0,U.f1)(te)?[3,7]:(ne=(0,z.yw)(T+(0,U.gl)(te)))&&ne.state===g.cc.Processing?(null!==(re=Y.get(O))&&void 0!==re?re:0)<u.H47?(N.R.getInstance().setState(g.Nj.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),(0,S.cY)("ContentProcessing retrying because content validator is still processing \n"),oe=1,Y&&Y.has(O)&&(oe+=Y.get(O)),Y.set(O,oe),W.sendChatEventTelemetry((0,C.pN)((ie={},(0,o._)(ie,v.h3.ChatEventType,v.a5.RetryingContentProcessingAnnotationCall),(0,o._)(ie,v.h3.ChatEventParameters,oe),ie))),setTimeout((0,r._)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,Q(e,t)];case 1:return n.sent(),[2]}}))})),u.mr4),[2]):[3,7]:[3,3]);case 3:return ne&&ne.state===g.cc.Failed?(N.R.getInstance().setState(g.Nj.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[4,Z(ne.errors,w)]):[3,5];case 4:return be.sent(),[2];case 5:return ne&&ne.state===g.cc.Success&&(0,h.PA)(h.IY.IsTransformFileSensitivityLabelErrorMessageEnabled)&&ne.sensitivityLabel?[4,K(ne.sensitivityLabel)]:[3,7];case 6:be.sent(),A=!0,be.label=7;case 7:return G=!0,[3,2];case 8:return[3,11];case 9:return ye=be.sent(),J=!0,X=ye,[3,11];case 10:try{G||null==$.return||$.return()}finally{if(J)throw X}return[7];case 11:return(0,h.bw)(h.WT.IsApplyLabelUsingTryUpgradeLabelEnabled)&&(0,b.ID)()&&(I||!(0,U.Of)(y))&&A?I&&(0,U.Of)(y)?[3,17]:(ae={status:g.rI.SUCCESS},[4,(0,U.E$)(y,ae)]):[3,17];case 12:return be.sent()?[3,16]:(ae=(0,a._)((0,i._)({},ae),{status:g.rI.FAILED,error:g.Re.APPLY_CLP_LABEL_FAILED}),se=new M.DA({status:B.Aw.failed,queryId:k.dB,error:void 0}),(0,j.af)(ae,w,!1,d.yg.getTypeName(),se,!(0,H.w_)()),N.R.getInstance().setState(g.Nj.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),(0,H.gj)()?[3,13]:(N.R.getInstance().setState(g.Nj.IDLE),c.G.getInstance().emptyContextIdListandCleanup(),[3,15]));case 13:return[4,(0,H.Ge)(se,w)];case 14:be.sent(),be.label=15;case 15:return(0,S.cY)("Early label application failed"),[2];case 16:_=!0,be.label=17;case 17:P=(new Date).getTime(),N.R.getInstance().getState()!==g.Nj.IDLE&&c.G.getInstance().addContextId(T),le=[],ce=!0,ue=!1,de=void 0,be.label=18;case 18:be.trys.push([18,24,25,26]),pe=e[Symbol.iterator](),be.label=19;case 19:return(ce=(fe=pe.next()).done)?[3,23]:(he=fe.value,ge=(0,U.f1)(he),me="",ge?[4,(0,U.ND)(he)]:[3,21]);case 20:me=be.sent(),be.label=21;case 21:le.push({contentType:ge?p.EA.Html:p.EA.FileUrl,sourceBuffer:new Uint8Array(me?q.from(me,"utf8"):[]),fileType:ge?"html":"docx",url:null!==he?he:"",lastModified:""}),be.label=22;case 22:return ce=!0,[3,19];case 23:return[3,26];case 24:return ye=be.sent(),ue=!0,de=ye,[3,26];case 25:try{ce||null==pe.return||pe.return()}finally{if(ue)throw de}return[7];case 26:return ve={correlationId:T,sourceContent:le,entryPoint:u.$kB.Chat,userPrompt:t,language:R.i.GetHostAppDisplayLanguage(),fCreateNewPresentation:L.Vv.IsSettingTrue(L.zj.PPTBBPresOutlineEnabled),templateId:(0,U.so)(),jsonCmdApiVersion:(0,U.zx)(),fCreateJsonCmdList:(0,h.bw)(h.WT.IsCreateJsonCmdListForBumbleBeeEnabled)},Se=new l.Xr({parentPath:["Signal",f.F.getTypeName()],items:[{id:F.r.generateId(),body:new f.F(ve)}]}),N.R.getInstance().getState()===g.Nj.IDLE||(null===(n=w.current)||void 0===n||n.submitOperation({operation:Se,workflowAnnotationType:d.yg.getTypeName()}),D.r.getInstance().setSkillName(g.B2.ContentTransform),W.sendChatEventTelemetry((0,C.pN)((0,o._)({},v.h3.ChatEventType,v.a5.ContentProcessingOperationSubmitted))),N.R.getInstance().setState(g.Nj.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE)),[2]}}))})),function(){return A.apply(this,arguments)});function J(){return null!=_&&_}var X=function(){var e=(0,r._)((function(e,t,n){var r,o,i,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return N.R.getInstance().getState()===g.Nj.IDLE?((0,S.cY)("ContentProcessingWorkflowHandler: ExecutionStateManager is in IDLE state. Returning \n"),[2]):((0,S.cY)("".concat(d.yg.getTypeName()," response. Time Taken : ").concat((0,k.WU)(P)," sec \n,")),N.R.getInstance().setState(g.Nj.EXECUTING),r=null==e?void 0:e.body,o=null==r?void 0:r.segmentBlobs,i=null==r?void 0:r.errors,a=null==r?void 0:r.sourceDocumentSensitivityLabels,!J()&&(0,h.PA)(h.IY.IsTransformFileSensitivityLabelErrorMessageEnabled)&&a&&null!=i&&i.length>0?[4,K(a)]:[3,2]);case 1:s.sent(),s.label=2;case 2:return void 0!==r.correlationId&&(0,C.Zp)(r.correlationId),(0,S.cY)("Segments received : "+o),(0,C.$j)(W,d.yg.getTypeName(),P,v.CT.ContentProcessingResponseTime,v.CC.CreatePresentationFromDoc,n),[4,Z(i,t)];case 3:return s.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),K=function(){var e=(0,r._)((function(e){var t,n,r,o,i,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),t=JSON.parse(e),n=t.id,r=t.tenantId,n?(i={labelId:n,tenantId:r},[4,null===(o=m.n.getInstance())||void 0===o?void 0:o.updateExternalDocSensitivityLabelUsingOfsJs([i])]):[3,2];case 1:s.sent(),s.label=2;case 2:return[3,4];case 3:return a=s.sent(),(0,S.cY)("Getting error while parsing sourceDocumentSensitivityLabels: ".concat(a.message)),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=(0,r._)((function(e,t){var n,r;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return null==e||0===e.length?[2]:(n=new M.DA({status:B.Aw.failed,queryId:k.dB,error:void 0}),r=I(e,t,!(0,H.w_)(),n),(0,C.AQ)(W,k.qD,"".concat(d.yg.getTypeName(),"_Error"),e[0].errorType+((i=e[0].customErrorData)&&/[a-zA-Z0-9_]+/.test(i)?"_".concat(i):""),g.T_.Server,void 0,!(0,H.w_)(),r),(0,H.gj)()?[3,1]:(N.R.getInstance().setState(g.Nj.IDLE),c.G.getInstance().emptyContextIdListandCleanup(),[3,3]));case 1:return[4,(0,H.Ge)(n,t)];case 2:o.sent(),o.label=3;case 3:return(0,G.k)(!1,"ContentProcessingWorkflow_".concat(e[0].errorType),O.Cu.CreatePresentationFromDoc),[2]}var i}))}));return function(t,n){return e.apply(this,arguments)}}()},88645:(e,t,n)=>{"use strict";n.d(t,{hn:()=>F,lY:()=>D,qv:()=>N,uT:()=>O});var r,o=n(43032),i=n(90813),a=n(57835),s=n(61838),l=n(79490),c=n(53154),u=n(85535),d=n(93176),p=n(73606),f=n(45002),h=n(54009),g=n(72218),m=n(44121),y=n(44632),v=n(12542),S=n(18758),C=n(44001),b=n(32854),E=n(24464),T=n(18384),w=n(39726),I=n(72702),P=[],_=!0,A=y.B.getInstance(),k=g.u1i,x=g.u1i,N=!1,O=!1,D=(r=(0,o._)((function(e,t,n){var r,o,u,d,g,y,_,N,D,B,U,z,H,G,V,j,q,W,Y,Q,J,X;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:if(!e.body||!f.P0.typeGuard(e.body))return[2];if(r={featureName:v.CC.CreatePresentationFromDoc,subFeatureName:v.Ff.CreateFromFile},o=e.body,u=o.correlationId,!c.G.getInstance().isValidAnnotationResponse(u))return(0,S.cY)("Ignoring contentProcessingProgressAnnotationProcessor for correlationId: ".concat(u)),A.sendChatEventTelemetry((0,T.pN)((_={},(0,i._)(_,v.h3.ChatEventType,v.a5.InvalidContextIdResponse),(0,i._)(_,v.h3.ChatEventParameters,null!==(y=null===(g=e.body)||void 0===g||null===(d=g.H_)||void 0===d?void 0:d.T_)&&void 0!==y?y:""),(0,i._)(_,v.h3.Cv,null!=n?n:""),(0,i._)(_,v.h3.UserQueryGuid,u),_))),[2];if(N=o.progress,D=o.jsonData,B=p.n.getInstance(),A.sendChatEventTelemetry((0,T.pN)((U={},(0,i._)(U,v.h3.ChatEventType,v.a5.ContentProcessingProgress),(0,i._)(U,v.h3.ChatEventParameters,N),(0,i._)(U,v.h3.Cv,null!=n?n:""),(0,i._)(U,v.h3.UserQueryGuid,u),U))),z=o.sourceDocumentSensitivityLabels,(0,I.a3)()||void 0===z||""!==k||""!==x)return[3,2];try{H=JSON.parse(z),k=H.id,x=H.tenantId}catch(e){(0,S.cY)("Getting error while parsing sourceDocumentSensitivityLabels: ".concat(e.message)),A.sendErrorTelemetry((0,T.pN)((G={},(0,i._)(G,v.IC.ErrorMessage,"Getting error while parsing sourceDocumentSensitivityLabels: ".concat(e.message)),(0,i._)(G,v.IC.ErrorCategory,v.S2.ContextIQ),G)))}return V={labelId:k,tenantId:x},[4,B.updateExternalDocSensitivityLabelUsingOfsJs([V])];case 1:l.sent(),l.label=2;case 2:switch((0,S.cY)("".concat(f.P0.getTypeName()," response. correlationId: ").concat(u,", progress: ").concat(N,", jsonData: ").concat(JSON.stringify(D),", sourceDocumentSensitivityLabels: ").concat(z)),N){case h.aX.DocumentDownloadStart:null===(j=t.current)||void 0===j||j.updateLoadingComponentProps((0,a._)({loadingUiStringList:[PowerpointCopilotStrings.LoadingUIDocumentDownloadStarted]},(0,b.$2)()));break;case h.aX.SegmentationStart:null===(q=t.current)||void 0===q||q.updateLoadingComponentProps((0,a._)({loadingUiStringList:[PowerpointCopilotStrings.LoadingUIDraftingAPresentation]},(0,b.$2)()));break;case h.aX.SlideOutlineGenerated:if(D&&L(D))return null===(W=t.current)||void 0===W||W.addResponseMessage((0,E.BK)(PowerpointCopilotStrings.OutlineStreamingHeader,P,(0,s._)((0,a._)({},E.tc),{clpSensitivityIndicatorData:B.shouldShowExternalDocSensitivityLabel()?(0,C.fS)():void 0}),!1,w.Xw.CHATPPT,m.SD.CreatePresentation,v.Ff.CreateFromFile,r)),B.shouldShowExternalDocSensitivityLabel()&&A.sendChatEventTelemetry((0,T.pN)((Y={},(0,i._)(Y,v.h3.ChatEventType,v.a5.TransformFileUsedWithCLPForOutline),(0,i._)(Y,v.h3.ChatEventParameters,"IsEncrypted_".concat(B.isExternalDocSensitivityLabelEncrypted())),(0,i._)(Y,v.h3.UserQueryGuid,u),Y))),[2];break;case h.aX.SlideOutlineStreaming:if(D&&L(D))return Q=(0,E.Lc)(P,PowerpointCopilotStrings.OutlineStreamingHeader,o.isContentShort?PowerpointCopilotStrings.ContentTransformShortContentMessage:void 0,(0,s._)((0,a._)({},E.tc),{clpSensitivityIndicatorData:B.shouldShowExternalDocSensitivityLabel()?(0,C.fS)():void 0}),!1,w.Xw.CHATPPT,m.SD.CreatePresentation,v.Ff.CreateFromFile,r),O=!0,R(t,Q,!1),[2];break;case h.aX.SlideOutlineStreamingCompleted:J=(0,s._)((0,a._)({},E.tc),{feedbackData:(0,b.as)(w.Xw.CHATPPT,r)}),R(t,M((0,s._)((0,a._)({},J),{clpSensitivityIndicatorData:B.shouldShowExternalDocSensitivityLabel()?(0,C.fS)():void 0}),!1),!0),B.shouldShowExternalDocSensitivityLabel()&&A.sendChatEventTelemetry((0,T.pN)((X={},(0,i._)(X,v.h3.ChatEventType,v.a5.TransformFileUsedWithCLPForOutline),(0,i._)(X,v.h3.ChatEventParameters,"IsEncrypted_".concat(B.isExternalDocSensitivityLabelEncrypted())),(0,i._)(X,v.h3.UserQueryGuid,u),X))),F()}return[2]}}))})),function(e,t,n){return r.apply(this,arguments)}),L=function(e){var t=[];try{t=JSON.parse(e).slideOutlineList}catch(e){var n;return(0,S.cY)("Error in parsing outline response for bumblebee",e.message),A.sendErrorTelemetry((0,T.pN)((n={},(0,i._)(n,v.IC.ErrorMessage,"Error in parsing outline response for bumblebee: ".concat(e.message)),(0,i._)(n,v.IC.ErrorCategory,v.S2.ContextIQ),n))),!1}var r=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;P.push(c.topic)}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return(0,S.cY)("outlineTopicPoint: ".concat(JSON.stringify(t))),!0},R=function(e,t,n){if(n?(t.addCardToChatHistory=!0,N=!0):t.addCardToChatHistory=!1,_){var r;A.logTriedEvent(m.SD.CreatePresentation,v.Ff.CreateFromFile,u.RX.Create);var o=(0,s._)((0,a._)({},t.chatMessageBodyData),{feedbackData:(0,b.as)(),telemetryData:(0,b.YI)(m.SD.CreatePresentation)});t.chatMessageBodyData=o,null===(r=e.current)||void 0===r||r.addResponseMessage(t),_=!1}else{var i;null===(i=e.current)||void 0===i||i.updateLastMessage(t)}},F=function(){P=[],_=!0,k=g.u1i,x=g.u1i,N=!1,O=!1},M=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{chatCardType:d._.Default,chatMessageData:void 0,chatMessageBodyData:e,stopLoadingUi:t}}},4085:(e,t,n)=>{"use strict";n.d(t,{Mz:()=>L,XY:()=>R,yw:()=>F});var r,o,i,a=n(43032),s=n(90813),l=n(81092),c=n(79490),u=n(70825),d=n(53154),p=n(54009),f=n(31093),h=n(60946),g=n(39726),m=n(69038),y=n(85535),v=n(17223),S=n(72218),C=n(81789),b=n(44121),E=n(1373),T=n(44632),w=n(12542),I=n(18758),P=n(32854),_=n(18384),A=n(23343),k=n(98483),x=n(55564),N=["docx","pdf"],O=T.B.getInstance(),D=new Map,L=(i=(0,a._)((function(e,t){var n,i,a,l,p,h,T,I,A,x,N,L,R,F;return(0,c.__generator)(this,(function(c){if(!(i=M(e,t))||0===i.length)return[2];C.R.getInstance().setState(g.Nj.EXECUTING),a=m.dB===S.u1i?(0,k.A)():m.dB,o=e,l=!0,p=!1,h=void 0;try{for(T=i[Symbol.iterator]();!(l=(I=T.next()).done);l=!0)A=I.value,x=m.dB+(0,P.gl)(A),N={state:g.cc.Processing,errors:[],sensitivityLabel:""},D.set(x,N)}catch(e){p=!0,h=e}finally{try{l||null==T.return||T.return()}finally{if(p)throw h}}return r=(new Date).getTime(),L=v.t.getInstance().getChatRef(),C.R.getInstance().getState()!==g.Nj.IDLE&&d.G.getInstance().addContextId(a),R={correlationId:a,fileURLs:i,validateCLP:!0,scenarioName:"ContentTransform"},F=new u.Xr({parentPath:["Signal",f.w.getTypeName()],items:[{id:E.r.generateId(),body:new f.w(R)}]}),C.R.getInstance().getState()===g.Nj.IDLE||(null===(n=L.current)||void 0===n||n.submitOperation({operation:F,workflowAnnotationType:f.w.getTypeName()}),O.logTriedEvent(b.SD.CreatePresentation,w.Ff.CreateFromFile,y.RX.Create),O.sendChatEventTelemetry((0,_.pN)((0,s._)({},w.h3.ChatEventType,w.a5.ContentValidatorOperationSubmitted))),C.R.getInstance().setState(g.Nj.WAITING_FOR_CONTENT_VALIDATOR_WF_RESPONSE)),[2]}))})),function(e,t){return i.apply(this,arguments)}),R=function(){var e=(0,a._)((function(e,t){var n,i,a,s,l,u,d,f,y,v,S;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return C.R.getInstance().getState()===g.Nj.IDLE?((0,I.cY)("ContentValidatorWorkflowHandler: ExecutionStateManager is in IDLE state. Returning \n"),[2]):((0,I.cY)("".concat(h.F.getTypeName()," response. Time Taken : ").concat((0,m.WU)(r)," sec \n,")),C.R.getInstance().setState(g.Nj.EXECUTING),(0,x.bw)(x.WT.ExcelAsInput)&&N.push("xlsx"),n=e.body,(i=null==n?void 0:n.correlationId)&&(0,_.Zp)(i),a=null==n?void 0:n.errors,s=null==n?void 0:n.validationResults,a&&a.length>0?o&&((0,P.MV)(o)||(0,P.lp)(o))?[4,B("ContentValidatorWorkflow_".concat(a[0].errorType),w.a5.ContentValidatorURLValidationFailed)]:[3,2]:[3,3]);case 1:t.sent(),t.label=2;case 2:return[2];case 3:l=!0,u=!1,d=void 0;try{for(f=s[Symbol.iterator]();!(l=(y=f.next()).done);l=!0)v=y.value,S=m.dB+(0,P.gl)(v.fileURL),v.errors&&v.errors.length>0?D.set(S,{state:g.cc.Failed,errors:v.errors,sensitivityLabel:v.documentSensitivityLabel}):N.includes(v.fileExtension)?D.set(S,{state:g.cc.Success,errors:[],sensitivityLabel:v.documentSensitivityLabel}):D.set(S,{state:g.cc.Failed,errors:[{errorType:p.jz.UnsupportedFileType,message:"Transformation is not supported for file with extension ".concat(v.fileExtension)}],sensitivityLabel:v.documentSensitivityLabel})}catch(e){u=!0,d=e}finally{try{l||null==f.return||f.return()}finally{if(u)throw d}}return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),F=function(e){return D.get(e)},M=function(e,t){var n=[];if(t&&t.length>0){var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value;n.push(c.value)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}if(e){var u,d=new RegExp("https://[^\\s]*","gi"),p=e.match(d)||[];(u=n).push.apply(u,(0,l._)(p))}return n},B=function(){var e=(0,a._)((function(e,t){return(0,c.__generator)(this,(function(n){return O.sendChatEventTelemetry((0,_.pN)((0,s._)({},w.h3.ChatEventType,t))),(0,A.k)(!1,e,b.Cu.CreatePresentationFromDoc),[2]}))}));return function(t,n){return e.apply(this,arguments)}}()},52318:(e,t,n)=>{"use strict";n.d(t,{Lo:()=>Z,ci:()=>re,mk:()=>oe,U9:()=>$});var r,o=n(43032),i=n(90813),a=n(57835),s=n(61838),l=n(79490),c=n(39726),u=n(53154),d=n(55564),p=n(69038),f=n(93176),h=n(69510),g=n(61339),m=n(81789),y=n(18384),v=n(74930),S=n(27465),C=n(44121),b=n(14213),E=n(44632),T=n(12542),w=n(21659),I=n(39041),P=n(65905),_=n(18758),A=n(30325),k=n(65817),x=n(24464),N=n(32854),O=n(50481),D=n(60801),L=n(52174),R=n(13403),F=n(40389),M=n(23343),B=n(72218),U=n(42652),z=n(60697),H=n(81092),G=n(39521),V=n(59e3),j=function(e){return(0,z._)(e.split(":")).slice(2).join(":")},q=(r=(0,o._)((function(e){return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return[4,PowerPoint.run(function(){var t=(0,o._)((function(t){return(0,l.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,G.sW)(t,e,(function(e){}),!1,!1,!1)];case 1:return n.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return t.sent(),[2]}}))})),function(e){return r.apply(this,arguments)}),W=function(){var e=(0,o._)((function(e,t){var n;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return(0,_.cY)("Preparing modified ODSL program for semantic selection of textIndex: ".concat(t)),n=function(e,t){return[{name:"selectTextIndex",returns:"textRanges",arguments:{index:{type:"string",string:t}},argumentsArray:[{key:"index",value:{type:"string",string:t}}]}].concat((0,H._)(e))}(e,t),[4,q(n)];case 1:return r.sent(),(0,_.cY)("Finished executing modified ODSL program for semantic selection textIndex: ".concat(t)),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Y=function(){var e=(0,o._)((function(e){var t,n;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return t=(0,U._)(e.split(":"),1),n=t[0],[4,PowerPoint.run(function(){var e=(0,o._)((function(e){return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return void 0!==n&&e.presentation.setSelectedSlides([n]),[4,e.sync()];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return r.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=(0,o._)((function(e,t){var n;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return(0,_.cY)("Preparing modified ODSL program for semantic selection of all textIndices"),n=function(e,t){var n=t.join(",");return[{name:"selectIndicesText",returns:"textRanges",arguments:{indices:{type:"string",string:n}},argumentsArray:[{key:"indices",value:{type:"string",string:n}}]}].concat((0,H._)(e))}(e,t),[4,q(n)];case 1:return r.sent(),(0,_.cY)("Finished executing modified ODSL program for semantic selection of all textIndices"),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),J=n(73733),X=n(83048),K=n(29336),Z=[],$="",ee=b.K.getInstance(),te=E.B.getInstance(),ne=g.R.getInstance(),re=function(){var e=(0,o._)((function(e,t,n,r,o,i,a,s){var c,u;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return c=0===o?p.qD:o,(0,_.cY)("".concat(h.YO.getTypeName()," response. Time Taken :\n      ").concat((0,p.WU)(c)," sec \n")),(0,y.$j)(te,h.YO.getTypeName(),c,T.CT.CopilotODSLResponseTime,T.CC.Commanding,s),void 0!==(null==(u=null==e?void 0:e.body)?void 0:u.queryId)&&(0,y.Zp)(null==u?void 0:u.queryId),ee.setResponseTime((0,p.WU)(p.qD)),[4,oe(u,t,n,r,i,a)];case 1:return l.sent(),[2]}}))}));return function(t,n,r,o,i,a,s,l){return e.apply(this,arguments)}}(),oe=function(){var e=(0,o._)((function(e,t,n,r,g,b,E,B,U){var z,H,G,q,re,oe,se,le,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be,Ee,Te,we,Ie,Pe,_e,Ae,ke,xe,Ne,Oe,De,Le,Re,Fe,Me,Be,Ue,ze;return(0,l.__generator)(this,(function(He){switch(He.label){case 0:if((0,d.PA)(d.IY.LogTimeToIntentDetectionDuration)&&(null==U?void 0:U.timeToIntentDetectionMs)&&(ee.setTimeToIntentDetection(U.timeToIntentDetectionMs),H=(new Date).getTime()-p.qD,ee.setTimeToIntentDetectionOverTheWireTime(H-ee.getTimeToIntentDetection())),m.R.getInstance().setState(c.Nj.EXECUTING),G={status:c.rI.SUCCESS},q=null==e?void 0:e.prompt,re=null==e?void 0:e.raw,oe=null==e?void 0:e.entities,se=null==e?void 0:e.error,le=null==e||null===(z=e.odsl)||void 0===z?void 0:z.statements,ce=null==e?void 0:e.intent,$=null==e?void 0:e.outputAnswerLanguage,ue=(new Date).getTime(),K.r.getInstance().setSkillName(c.B2.Commanding),de=[],(null==(pe=null==e?void 0:e.aiResponses)?void 0:pe.length)>0){fe=!0,he=!1,ge=void 0;try{for(me=pe[Symbol.iterator]();!(fe=(ye=me.next()).done);fe=!0)(ve=ye.value).type===c.xS.EXPLANATIONS&&(null===(Se=ve.value)||void 0===Se?void 0:Se.explanations)?Z=null===(Ee=ve.value)||void 0===Ee?void 0:Ee.explanations:ve.type===c.xS.SUGGESTIONS&&(null===(be=ve.value)||void 0===be||null===(Ce=be.suggestions)||void 0===Ce?void 0:Ce.length)>0&&(de=null===(we=ve.value)||void 0===we||null===(Te=we.suggestions)||void 0===Te?void 0:Te.slice(0,3))}catch(e){he=!0,ge=e}finally{try{fe||null==me.return||me.return()}finally{if(he)throw ge}}}return q&&(0,_.cY)("Prompt:\n".concat(q)),re&&(0,_.cY)("ODSL:\n".concat(re)),oe&&(0,_.cY)("Entities:\n".concat(oe)),ce&&(0,_.cY)("Intent:\n".concat(ce)),ce===c.jd.Help||ce===c.jd.Icon||ce===c.jd.Undo||ce===c.jd.ImageOutOfScope?(function(e,t){switch(te.sendChatEventTelemetry((0,y.pN)((0,i._)({},T.h3.ChatEventType,T.a5.PPTCopilotIntentDetected)),!1),e){case c.jd.Help:var n,r={featureName:T.CC.Commanding,subFeatureName:T.Ff.Help};te.sendChatEventTelemetry((0,y.pN)((0,i._)({},T.h3.ChatEventParameters,c.jd.Help))),null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:f._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:PowerpointCopilotStrings.AssistantChatHelpSuggestion,renderData:{component:c.uz.HelpResponse,props:{}}}},chatMessageBodyData:(0,s._)((0,a._)({},x.OT),{feedbackData:(0,N.as)(void 0,r),telemetryData:(0,N.YI)()}),addCardToChatHistory:!0});break;case c.jd.Undo:var o,l,u,d={featureName:T.CC.Commanding,errorMessage:PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,errorType:c.Qp.UnsupportedAction_Undo};te.sendChatEventTelemetry((0,y.pN)((u={},(0,i._)(u,T.h3.ChatEventParameters,c.jd.Undo),(0,i._)(u,T.h3.ChatErrorType,c.T_.UnsupportedAction),(0,i._)(u,T.h3.ChatErrorKey,X.Nr.ActionOnlySupportedInRibbonMessage),u)));var p=PowerpointCopilotStrings.UndoPhraseResponseHeader,h=[PowerpointCopilotStrings.UndoPhraseResponseInstruction1,PowerpointCopilotStrings.UndoPhraseResponseInstruction2];null===(o=t.current)||void 0===o||o.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,x.OT,!1,c.Xw.CHATPPT,void 0,!1,!0,void 0,d)),null===(l=t.current)||void 0===l||l.addResponseMessage((0,x.BK)(p,h,x.OT,!0,c.Xw.CHATPPT,void 0,void 0,d));break;case c.jd.Icon:var g,m,v;te.sendChatEventTelemetry((0,y.pN)((v={},(0,i._)(v,T.h3.ChatEventParameters,c.jd.Icon),(0,i._)(v,T.h3.ChatErrorType,c.T_.UnsupportedAction),(0,i._)(v,T.h3.ChatErrorKey,X.Nr.ActionOnlySupportedInRibbonMessage),v)));var S=PowerpointCopilotStrings.RibbonOnlyActionInsertIconInstructionsHeader,C=[(0,I.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),(0,I.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonIcon),PowerpointCopilotStrings.RibbonOnlyActionInsertIconInstruction3,PowerpointCopilotStrings.RibbonOnlyActionInsertIconInstruction4],b={featureName:T.CC.Commanding,errorMessage:PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,errorType:c.Qp.UnsupportedAction_Icon};null===(g=t.current)||void 0===g||g.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,x.OT,!1,c.Xw.CHATPPT,void 0,!1,!0,void 0,b)),null===(m=t.current)||void 0===m||m.addResponseMessage((0,x.BK)(S,C,x.OT,!0,c.Xw.CHATPPT,void 0,void 0,b));break;case c.jd.ImageOutOfScope:var E,w;te.sendChatEventTelemetry((0,y.pN)((w={},(0,i._)(w,T.h3.ChatEventParameters,c.jd.ImageOutOfScope),(0,i._)(w,T.h3.ChatErrorType,c.T_.UnsupportedAction),(0,i._)(w,T.h3.ChatErrorKey,X.Nr.ImageOutOfScopeIntentError),w)));var P={featureName:T.CC.Commanding,errorMessage:PowerpointCopilotStrings.ImageOutOfScopeIntentError,errorType:c.Qp.UnsupportedAction_ImageOutOfScope};null===(E=t.current)||void 0===E||E.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.ImageOutOfScopeIntentError,x.OT,!0,c.Xw.CHATPPT,void 0,!1,!0,void 0,P))}}(ce,t),ce===c.jd.Help?((0,y.AQ)(te,p.qD),(0,M.k)(!0,void 0,C.Cu.CopilotChat)):((0,y.AQ)(te,p.qD,"","CopilotODSLWorkflow_UnsupportedIntent_".concat(ce),c.T_.UnsupportedAction),(0,M.k)(!1,"CopilotODSLWorkflow_UnsupportedIntent_".concat(ce),C.Cu.CopilotChat)),m.R.getInstance().setState(c.Nj.IDLE),ce==c.jd.ImageOutOfScope&&(0,J.yS)(le,!1,X.by.DismissedCommand,"Image Out of Scope"),[2]):(Ie=Z.length>0&&""!==Z[0]&&(0,I._r)($),Pe=new v.DA({status:S.Aw.failed,queryId:p.dB,error:void 0}),se?((0,_.cY)("AL Error:\n".concat(se.message," Error category : ").concat(se.category)),(0,P.c)(se,t,r,!1),(0,O.gj)()||m.R.getInstance().setState(c.Nj.IDLE),(0,J.yS)(le,!1,X.by.Failed,se.message.length?"Error from AL":"No Error from AL"),(0,y.ni)(te,(0,p.WU)(p.qD),!1,ue),(0,M.k)(!1,"CopilotODSLWorkflow_".concat(se.category),C.Cu.CopilotChat),[2]):le?(ke=JSON.stringify(le),(0,_.cY)("Program:\n".concat(ke)),[4,ae(ke,t,Pe)]):(Ae={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:c.Qp.ODSLServerErrorMessage,featureName:T.CC.Commanding},null===(_e=t.current)||void 0===_e||_e.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.ServerErrorMessage,x.OT,!0,c.Xw.CHATPPT,void 0,!1,!0,void 0,Ae)),(0,y.AQ)(te,p.qD,"".concat(h.YO.getTypeName(),"_Error"),"Undefined_Program",c.T_.Server,void 0,!(0,O.w_)(),X.Nr.ServerErrorMessage),m.R.getInstance().setState(c.Nj.IDLE),(0,J.yS)(le,!1,X.by.Failed,"No Program Present"),te.sendLatencyTelemetry((0,y.pN)((0,i._)({},T.CT.QueryExecutionTime,(0,p.WU)(ue)))),(0,M.k)(!1,"CopilotODSLWorkflow_UndefinedProgram",C.Cu.CopilotChat),[2]));case 1:return He.sent()?(m.R.getInstance().setState(c.Nj.IDLE),(0,O.gj)()?[4,(0,O.Ge)(Pe,t)]:[3,3]):[3,4];case 2:He.sent(),He.label=3;case 3:return(0,y.ni)(te,(0,p.WU)(p.qD),!1,ue),[2];case 4:return le&&(0,d.bw)(d.WT.EnableSemanticSelectionWithPaginatedCards)&&((je=le).length>0&&"selectIndicesText"===je[0].name)?(Ge=le[0],Ve=Ge.arguments.indices.string,xe=(0,V.ty)(Ve),Ne=le.slice(1),function(e,t,n,r){var o;null===(o=e.current)||void 0===o||o.addResponseMessage({chatCardType:f._.PaginatedCard,chatMessageData:{paginatedCardProps:{user:"chat",textIndices:t,extractTextToDisplay:j,handleApplyOnClick:n,locateTextIndex:Y,handleApplyAllOnClick:r}},addCardToChatHistory:!1})}(t,xe,W.bind(null,Ne),Q.bind(null,Ne)),(0,O.gj)()?[4,(0,O.Ge)(Pe,t)]:[3,6]):[3,7];case 5:He.sent(),He.label=6;case 6:return[2];case 7:return He.trys.push([7,9,,10]),[4,PowerPoint.run(function(){var e=(0,o._)((function(e){return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,k.sW)(e,le,n,!1,E,B)];case 1:return G=t.sent(),(0,d.PA)(d.IY.HandleCommandingFailuresWithoutShowMe)&&G.status==c.rI.DISMISSED&&(G.status=c.rI.FAILED),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 8:return He.sent(),(0,_.cY)("log result : ",JSON.stringify(G)),le.some((function(e){return"selectText"===e.name&&e.dismissedArguments&&'"Presentation"'===e.dismissedArguments.scope.string}))&&(0,_.cY)("Known ODSL issue detected: selectText with scope Presentation causes issues. (BUG 9341634)\n        Until resolved, avoid calling the selectText statement with scope Presentation.\n        To debug this issue or to develop a patch, refer to the validateArgument function in utils\\copilot-odsl-generator\\src\\odslProgramValidator.ts (augloop-workflows repo)."),[3,10];case 9:return Oe=He.sent(),(0,_.cY)("Execute failed:"+JSON.stringify(Oe)),G={status:c.rI.FAILED},[3,10];case 10:return G.status!==c.rI.PAUSED_ON_WARNING?[3,14]:(0,I.hX)(G.error)?[3,13]:(Re={featureName:T.CC.Commanding,subFeatureName:void 0},Fe=(0,D.kb)(t,(0,L.b)(G.error),g,(0,O.w_)(),Re),ne.setWarningMessageActive(!0),null==t||null===(De=t.current)||void 0===De||De.addResponseMessage(Fe),m.R.getInstance().setState(c.Nj.IDLE),null==t||null===(Le=t.current)||void 0===Le||Le.updateLoadingComponentProps({shouldShowLoadingUi:(0,O.w_)()}),(0,d.n8)(A.BJ)||(ne.setWarningCardDisplayTimeInMs(),ne.setShouldAccountForWarningCardUserInteractionLatency(!0)),te.sendChatEventTelemetry((0,y.pN)((Me={},(0,i._)(Me,T.h3.ChatEventType,T.a5.WarningMessageCardShown),(0,i._)(Me,T.h3.ChatEventParameters,c.e0[(0,L.b)(G.error)]),Me))),(0,O.gj)()?(Pe.status=S.Aw.success,[4,(0,O.Ge)(Pe,t)]):[3,12]);case 11:He.sent(),He.label=12;case 12:return(0,y.ni)(te,(0,p.WU)(p.qD),!1,ue),[2];case 13:return[3,17];case 14:return(0,d.PA)(d.IY.IsStoryTellerBlockedWithEmptyPrompt)&&G.status==c.rI.BLOCKED&&G.error==c.Re.ADD_SLIDE_BLOCKED?(Ue={errorMessage:PowerpointCopilotStrings.StorytellerFailureMessage,errorType:c.Qp.AddSlideBlocked,featureName:T.CC.Commanding},null===(Be=t.current)||void 0===Be||Be.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.StorytellerFailureMessage,x.OT,!0,c.Xw.CHATPPT,void 0,!1,!0,void 0,Ue)),m.R.getInstance().setState(c.Nj.IDLE),(0,y.AQ)(te,p.qD,"StorytellerInvocationBlocked","",c.T_.UnsupportedAction,void 0,!(0,O.w_)(),X.Nr.StorytellerFailureMessage),(0,O.gj)()?(Pe.status=S.Aw.failed,[4,(0,O.Ge)(Pe,t)]):[3,16]):[3,17];case 15:He.sent(),He.label=16;case 16:return(0,y.ni)(te,(0,p.WU)(p.qD),!1,ue),[2];case 17:return de.length>0&&(0,_.cY)("updating actionai suggestion pills in chat"),m.R.getInstance().getState()===c.Nj.EXECUTING||(0,F.dD)()&&m.R.getInstance().getState()===c.Nj.EXECUTING_APPLYJOFC_PROTOCOL?[4,(0,R.uK)(G,t,r,Pe,ke,Ie,Z,ee,b,!(0,O.w_)())]:((0,y.ni)(te,(0,p.WU)(p.qD),G.status===c.rI.SUCCESS,ue),[2]);case 18:return He.sent(),(0,O.gj)()?[4,(0,O.Ge)(Pe,t)]:[3,20];case 19:return He.sent(),[3,21];case 20:u.G.getInstance().emptyContextIdListandCleanup(),m.R.getInstance().setState(c.Nj.IDLE),He.label=21;case 21:return G.status===c.rI.SUCCESS?(te.sendChatEventTelemetry((0,y.pN)((0,i._)({},T.h3.ChatEventParameters,h.YO.getTypeName()))),(0,y.AQ)(te,p.qD,void 0,void 0,void 0,void 0,!(0,O.w_)()),te.sendLatencyTelemetry((0,y.pN)((0,i._)({},T.CT.QueryExecutionTime,(0,p.WU)(ue))))):(te.sendLatencyTelemetry((0,y.pN)((ze={},(0,i._)(ze,T.CT.UserPerceivedLatency,(0,p.WU)(p.qD)),(0,i._)(ze,T.CT.IsQuerySuccess,G.status===c.rI.PARTIAL_SUCCESS),(0,i._)(ze,T.CT.QueryExecutionTime,(0,p.WU)(ue)),ze))),(0,_.cY)("User Perceived Latency :  ".concat((0,p.WU)(p.qD)," sec"))),ie(te,G.status),[4,(0,w.Ep)(t)];case 22:return He.sent(),ee.resetData(!(0,d.PA)(d.IY.IsASHATelemetryToBeLoggedAtStreamEndOnce)),m.R.getInstance().setState(c.Nj.IDLE),[2]}var Ge,Ve,je}))}));return function(t,n,r,o,i,a,s,l,c){return e.apply(this,arguments)}}(),ie=function(e,t){if((0,d.PA)(d.IY.IsASHATelemetryToBeLoggedAtStreamEndOnce)){var n=X.G8.Unset,r=X.av.Unset;t===c.rI.UNSUPPORTED?(n=X.G8.UnsupportedCopilotFunctionality,r=X.av.UnsupportedInputQuery):t===c.rI.UNEXPECTED_VERSION?(n=X.G8.CommandNotExecuted,r=X.NW.UnexpectedVersion):t===c.rI.CONTENT_GENERATION_DISABLED&&(n=X.G8.ContentGeneration,r=X.IT.Disabled),ee.setAshaErrorString(r),ee.setAshaVetoString(n)}else t===c.rI.UNSUPPORTED?e.logAshaErrorEvent(X.G8.CommandNotExecuted,X.NW.IncorrectODSLVersion):t===c.rI.UNEXPECTED_VERSION?e.logAshaErrorEvent(X.G8.CommandNotExecuted,X.NW.UnexpectedVersion):t===c.rI.CONTENT_GENERATION_DISABLED&&e.logAshaErrorEvent(X.G8.ContentGeneration,X.IT.Disabled)},ae=function(){var e=(0,o._)((function(e,t,n){var r,o,i,a,s,u,f,h,g,m;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return e.includes("formatShapes")&&e.includes("insertImages")||e.includes("insertShapes")&&e.includes('"shapeType":{"type":"string","string":"Textbox"')?((0,_.cY)("Allowed case of shape detection , insert formatted image or insert textbox"),[2,!1]):(r=(0,d.bw)(d.WT.IsjOFCCommandingWorkflowEnabled),o=e.includes("formatShapes"),i=e.includes("insertShapes"),a=e.includes("deleteSlides"),s=a&&!r,(o||i)&&!r?((0,_.cY)("Shape intent action detected"),(0,d.n8)(A.BJ)||(h={errorMessage:PowerpointCopilotStrings.StorytellerFailureMessage,errorType:c.Qp.AddSlideBlocked,featureName:T.CC.Commanding},null===(u=t.current)||void 0===u||u.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,x.OT,!1,c.Xw.CHATPPT,void 0,!1,!0,void 0,h)),null===(f=t.current)||void 0===f||f.addResponseMessage((0,x.BK)((0,B.OAU)(),(0,B.AGQ)(),x.OT,!0,c.Xw.CHATPPT,void 0,void 0,h))),(0,I.hX)(n)||(n.error=PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage),(0,y.AQ)(te,p.qD,T.a5.UnsupportedActionDetected,"ShapeOperation",c.T_.UnsupportedAction,void 0,void 0,X.Nr.ActionOnlySupportedInRibbonMessage),[4,(0,w.Ep)(t)]):[3,2]);case 1:case 3:return l.sent(),[2,!0];case 2:return s?((0,_.cY)("Delete intent action detected"),g={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:c.Qp.RequireDeleteIntentResponse,featureName:T.CC.Commanding},(0,d.n8)(A.BJ)||null===(m=t.current)||void 0===m||m.addResponseMessage((0,x.qi)(PowerpointCopilotStrings.ServerErrorMessage,x.OT,!0,c.Xw.CHATPPT,void 0,!1,!0,void 0,g)),(0,I.hX)(n)||(n.error=PowerpointCopilotStrings.ServerErrorMessage),(0,y.AQ)(te,p.qD,T.a5.UnsupportedActionDetected,"DeleteOperation",c.T_.UnsupportedAction,void 0,void 0,X.Nr.ServerErrorMessage),[4,(0,w.Ep)(t)]):[3,4];case 4:return[2,!1]}}))}));return function(t,n,r){return e.apply(this,arguments)}}()},85612:(e,t,n)=>{"use strict";n.d(t,{EJ:()=>_,Xn:()=>I,l3:()=>P,rp:()=>T});var r,o=n(43032),i=n(90813),a=n(79490),s=n(39041),l=n(18758),c=n(63685),u=n(63028),d=n(69038),p=n(72218),f=n(82808),h=n(2061),g=n(72468),m=n(18384),y=n(44632),v=n(83048),S=n(39726),C=n(9669),b=n(78289),E=y.B.getInstance(),T=(r=(0,o._)((function(e,t,n){var r,o,h,y,C,T,I,P,_,A,k,x,N,O,D,L,R,F,M,B,U,z,H,G,V,j,q,W,Y,Q,J;return(0,a.__generator)(this,(function(n){return C=null==e?void 0:e.body,I=null!==(T=null==C?void 0:C.queryId)&&void 0!==T?T:p.u1i,P=null==C?void 0:C.notificationType,_=null==C?void 0:C.previewMessage,A=null==C?void 0:C.attributes,k=null==C?void 0:C.actionParameters,(0,b.ei)(P,k,A,t)?[2]:((0,l.cY)("NotificationAnnotationProcessor: queryId: ".concat(I,", notificationType: ").concat(P,", previewMessage: ").concat(_,", Time: ").concat((new Date).toLocaleTimeString(),", attributes ").concat(JSON.stringify(null!=A?A:p.u1i),", actionParameters ").concat(JSON.stringify(null!=k?k:p.u1i))),E.sendChatEventTelemetry((0,m.pN)((N={},(0,i._)(N,v.h3.UserQueryGuid,I),(0,i._)(N,v.h3.ChatEventType,v.a5.ResponseReceivedFromAL),(0,i._)(N,v.h3.ChatEventParameters,c.l.getTypeName()),(0,i._)(N,v.h3.UniqueActionId,null!==(x=null===(r=(0,g.ox)(I))||void 0===r?void 0:r.uniqueActionID)&&void 0!==x?x:p.u1i),N)),void 0),(0,s.hX)(C)?((0,l.cY)("NotificationAnnotationProcessor: body is null or undefined"),E.sendErrorTelemetry((0,m.pN)((O={},(0,i._)(O,v.h3.UserQueryGuid,I),(0,i._)(O,v.IC.ErrorMessage,p.H19),(0,i._)(O,v.IC.ErrorCategory,v.S2.Notification),(0,i._)(O,v.CT.ErrorType,S.T_.Server),O))),E.sendChatEventTelemetry((0,m.pN)((D={},(0,i._)(D,v.h3.UserQueryGuid,I),(0,i._)(D,v.h3.NotificationType,P),(0,i._)(D,v.h3.ChatEventType,v.a5.CheckNotification),(0,i._)(D,v.h3.ChatEventParameters,p.H19),(0,i._)(D,v.h3.ChatErrorType,S.T_.Server),D)),void 0),[2]):(0,s.hX)(I)||I===p.u1i?((0,l.cY)("Received Notification for null queryID, ignoring"),E.sendErrorTelemetry((0,m.pN)((L={},(0,i._)(L,v.h3.UserQueryGuid,I),(0,i._)(L,v.IC.ErrorMessage,p.r1E),(0,i._)(L,v.IC.ErrorCategory,v.S2.Notification),(0,i._)(L,v.CT.ErrorType,S.T_.Server),L))),E.sendChatEventTelemetry((0,m.pN)((R={},(0,i._)(R,v.h3.UserQueryGuid,I),(0,i._)(R,v.h3.NotificationType,P),(0,i._)(R,v.h3.ChatEventType,v.a5.CheckNotification),(0,i._)(R,v.h3.ChatEventParameters,p.r1E),(0,i._)(R,v.h3.ChatErrorType,S.T_.Server),R)),void 0),[2]):(0,g.EL)(I)?((0,s.hX)(null===(o=(0,g.ox)(I))||void 0===o?void 0:o.NotificationAnnotation)&&E.sendLatencyTelemetryForNotifications((0,m.pN)((q={},(0,i._)(q,v.CT.FirstNotificationReceivedTime,(0,d.WU)(null===(G=(0,g.ox)(I))||void 0===G?void 0:G.querySubmissionTime)),(0,i._)(q,v.CT.UniqueActionId,null!==(j=null===(V=(0,g.ox)(I))||void 0===V?void 0:V.uniqueActionID)&&void 0!==j?j:p.u1i),(0,i._)(q,v.CT.FeatureName,v.S2.Notification),(0,i._)(q,v.CT.SubFeatureName,v.Ff.VisualSummary),q)),I,!1),(0,g.rc)(I,{NotificationAnnotation:C}),(null===(h=(0,g.ox)(I))||void 0===h?void 0:h.startShowingNotification)?(f.A.clearTimerForNotification(I,null!==(J=null===(y=(0,g.ox)(I))||void 0===y?void 0:y.timerId)&&void 0!==J?J:null),P===u._n.PROGRESS?((0,l.cY)("NotificationAnnotationProcessor: Progress Notification received"),w(I,A,t,_)):(0,l.cY)("NotificationAnnotationProcessor: Unknown Notification Type: ".concat(P)),[2]):((0,l.cY)("Final Chunk Not received for card content, ignoring notification, queryId: ".concat(I)),E.sendChatEventTelemetry((0,m.pN)((Q={},(0,i._)(Q,v.h3.UserQueryGuid,I),(0,i._)(Q,v.h3.ChatEventParameters,"".concat(p.NPs,"_").concat(_)),(0,i._)(Q,v.h3.ChatEventType,v.a5.CheckNotification),(0,i._)(Q,v.h3.UniqueActionId,null!==(Y=null===(W=(0,g.ox)(I))||void 0===W?void 0:W.uniqueActionID)&&void 0!==Y?Y:p.u1i),Q)),void 0),[2])):((0,l.cY)("Received Notification for stale queryID, ignoring, queryId: ".concat(I)),E.sendChatEventTelemetry((0,m.pN)((U={},(0,i._)(U,v.h3.UserQueryGuid,I),(0,i._)(U,v.h3.NotificationType,P),(0,i._)(U,v.h3.ChatEventType,v.a5.CheckNotification),(0,i._)(U,v.h3.ChatEventParameters,"".concat(p.dcx,"_").concat(_)),(0,i._)(U,v.h3.ChatErrorType,S.T_.Client),(0,i._)(U,v.h3.UniqueActionId,null!==(B=null===(F=(0,g.ox)(I))||void 0===F?void 0:F.uniqueActionID)&&void 0!==B?B:p.u1i),U)),void 0),E.sendErrorTelemetry((0,m.pN)((H={},(0,i._)(H,v.h3.UserQueryGuid,I),(0,i._)(H,v.IC.ErrorMessage,p.dcx),(0,i._)(H,v.IC.ErrorCategory,v.S2.Notification),(0,i._)(H,v.CT.ErrorType,S.T_.Client),(0,i._)(H,v.IC.UniqueActionId,null!==(z=null===(M=(0,g.ox)(I))||void 0===M?void 0:M.uniqueActionID)&&void 0!==z?z:p.u1i),H))),[2]))}))})),function(e,t,n){return r.apply(this,arguments)}),w=function(e,t,n,r){(0,s.hX)(t)?(0,l.cY)("NotificationAnnotationProcessor: Progress Notification attributes are null or undefined"):null==t||t.forEach((function(t){var o=t.name,i=t.value;if((0,l.cY)("NotificationAnnotationProcessor: Progress Notification attribute: ".concat(o," - ").concat(i)),o===u.jQ.STATE)switch(i){case h.W$G.STARTED:case h.W$G.IN_PROGRESS:var a=f.A.updateActiveCardForInProgressNotification(e,n,r,!0);(0,g.rc)(e,{timerId:a});break;case h.W$G.COMPLETED:var s;f.A.updateActiveCardForCompleteNotification(e,n,void 0,!0),(null==n||null===(s=n.current)||void 0===s?void 0:s.getIsExecuting())&&f.A.disableSuccessButton(e,n);break;case h.W$G.FAILED:f.A.updateActiveCardForInFailureNotification(e,n,r);break;default:(0,l.cY)("Unknown State Received for Notification: ".concat(i," for attribute: ").concat(o))}}))},I=function(e){var t=(0,g.ox)(e),n=null==t?void 0:t.NotificationAnnotation,r=null==n?void 0:n.attributes;if(void 0!==r&&r.length>0){var o,i,a=null===(o=r[0])||void 0===o?void 0:o.name,s=null===(i=r[0])||void 0===i?void 0:i.value;return a===u.jQ.STATE&&s===h.W$G.IN_PROGRESS}return!1},P=function(e){var t=(0,g.ox)(e),n=null==t?void 0:t.NotificationAnnotation,r=null==n?void 0:n.attributes;if(void 0!==r&&r.length>0){var o,i,a=null===(o=r[0])||void 0===o?void 0:o.name,s=null===(i=r[0])||void 0===i?void 0:i.value;return a===u.jQ.STATE&&s===h.W$G.COMPLETED}return!1},_=function(e){var t,n,r=p.u1i,o=null===(n=(0,g.ox)(null!=e?e:p.u1i))||void 0===n||null===(t=n.NotificationAnnotation)||void 0===t?void 0:t.actionParameters;if(void 0!==o){var i=o[0].annotations;if(void 0!==i&&i.length>0){var a=i[0].type,s=i[0].value;if(a===C.c.getTypeName()){var c,u=null==s?void 0:s.body;r=(null==u||null===(c=u.comprehensionSummaryConfig)||void 0===c?void 0:c.usedVDPercentage).toString()}}}return(0,l.cY)("Visual Summary Notification vdPercentageUsage: ".concat(r)),r}},25420:(e,t,n)=>{"use strict";n.d(t,{O:()=>G,N:()=>V});var r=n(43032),o=n(90813),i=n(79490),a=n(70825),s=n(53154),l=n(55564),c=n(39726),u=n(69038),d=n(17223),p=n(98127),f=n(14552),h=n(31817),g=n(81789),m=n(44121),y=n(34045),v=n(18384),S=n(66888),C=n(65917),b=n(44632),E=n(12542),T=n(18758),w=n(39041),I=n(24464),P=n(72218);var _,A,k=n(74930),x=n(27465),N=n(14213),O=n(65817),D=n(9212),L=n(50481),R=n(1134),F=n(13403),M=n(52318),B=n(23343),U=n(29336),z=N.K.getInstance(),H=b.B.getInstance(),G=(A=(0,r._)((function(e){var t,n,r,h,m,b,w;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return n=d.t.getInstance(),r=n.getChatRef(),g.R.getInstance().getState()!==c.Nj.IDLE&&s.G.getInstance().addContextId(u.dB),(0,l.PA)(l.IY.IsSendSlideMonikerEnabled)?[4,(0,R.Oc)(e)]:[3,2];case 1:return m=i.sent(),[3,3];case 2:m=void 0,i.label=3;case 3:return h=m,b={outputExplanationLanguage:M.U9,correlationId:u.dB,hasSections:C._.getInstance().getDocumentState().hasSection,slideCount:C._.getInstance().getSlideCount(),jsonCmdApiVersion:y.Vv.getSettingAsString(y.zj.PPTJsonCmdAPIVersion),selectedSlide:h},w=new a.Xr({parentPath:["Signal",p.Y.getTypeName()],items:[{id:S.r.generateId(),body:new p.Y(b)}]}),_=(new Date).getTime(),null===(t=r.current)||void 0===t||t.submitOperation({operation:w,workflowAnnotationType:f.B.getTypeName()}),U.r.getInstance().setSkillName(c.B2.OrganizePresentation),H.sendChatEventTelemetry((0,v.pN)((0,o._)({},E.h3.ChatEventType,E.a5.OrganizePresentationOperationSubmitted))),(0,T.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(w)+"\nat Time : "+new Date+"\nSessionKey: "+(0,D.Dt)()+"\n\n\n"),g.R.getInstance().setState(c.Nj.WAITING_FOR_ORGANIZE_WF_RESPONSE),[2]}}))})),function(e){return A.apply(this,arguments)}),V=function(){var e=(0,r._)((function(e,t,n,a,d,p){var y,S,A,N,D,R,M,U,G,V,j,q,W,Y,Q,J,X,K,Z,$,ee,te,ne,re,oe,ie,ae,se,le,ce;return(0,i.__generator)(this,(function(ue){switch(ue.label){case 0:if(g.R.getInstance().setState(c.Nj.EXECUTING),(0,T.cY)("".concat(f.B.getTypeName()," response. Time Taken : ").concat((0,u.WU)(_)," sec \n")),N=e.body,D=null==N?void 0:N.status,R=null==N?void 0:N.error,M=null==N||null===(y=N.odsl)||void 0===y?void 0:y.statements,U=null==N||null===(S=N.explanation)||void 0===S?void 0:S.embeddedLists,G=null==N?void 0:N.jofcPayload,V=null==N?void 0:N.jofcOptions,j=null==N?void 0:N.usage,q=null==N?void 0:N.documentLanguage,W=null==N?void 0:N.additionalSystemMetadataInfo,(0,l.PA)(l.IY.LogOrganizeWorkflowDuration))try{A=JSON.stringify({Usage:j,OrgAdditionalInfo:W,TimeToIntentDetection:z.getTimeToIntentDetection(),TimeToIntentDetectionOverTheWireTime:z.getTimeToIntentDetectionOverTheWireTime()})}catch(e){(0,T.cY)("Parsing additionalInfo failed: ".concat(e))}return void 0!==N.correlationId&&(0,v.Zp)(N.correlationId),Y=H.getQueryGuid(),(0,v.$j)(H,f.B.getTypeName(),_,E.CT.OrganizePresentationResponseTime,E.CC.Organize,p),z.setResponseTime((0,u.WU)(u.qD)),Q=new k.DA({status:x.Aw.failed,queryId:Y,error:void 0}),R&&0!==R.errorCode?((0,T.cY)("Error received from ODSL for Organize Presentation :"+JSON.stringify(R)),J=function(e,t,n,r,i){var a,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6?arguments[6]:void 0;(0,T.cY)("Error in OrganizePresentation, Type : ".concat(e.errorCode,", Message : ").concat(e.message,"\n")),b.B.getInstance().sendErrorTelemetry((0,v.pN)((a={},(0,o._)(a,E.IC.ErrorMessage,"Error in OrganizePresentation Workflow , Code: ".concat(h.O[e.errorCode],", SignalSubmitTime: ").concat(r,", LastSlideCountUpdateTime: ").concat(C._.getInstance().getLastSlideCountUpdateTime(),", LastHasSectionUpdateTime: ").concat(C._.getInstance().getLastHasSectionUpdateTime())),(0,o._)(a,E.IC.ErrorCategory,E.S2.OrganizePresentation),a)));var d,p={errorType:"".concat(e.errorCode),featureName:E.CC.Organize};switch(e.errorCode){case h.O.RaiErrorInputContent:case h.O.RaiErrorOrganizeOutput:case h.O.PromptInjectionAttackDetected:p.errorMessage=PowerpointCopilotStrings.OrganizePresentationRAIError,(0,I.r5)(t,PowerpointCopilotStrings.OrganizePresentationRAIError,void 0,void 0,s,p),(0,w.hX)(i)||(i.error=PowerpointCopilotStrings.OrganizePresentationRAIError),d=E.Nr.OrganizePresentationRAIError;break;case h.O.FileTooLarge:p.errorMessage=PowerpointCopilotStrings.OrganizePresentationTooLargeFile,(0,I.r5)(t,PowerpointCopilotStrings.OrganizePresentationTooLargeFile,void 0,void 0,s,p),(0,w.hX)(i)||(i.error=PowerpointCopilotStrings.OrganizePresentationTooLargeFile),d=E.Nr.OrganizePresentationTooLargeFile;break;case h.O.InsufficientSlideContent:p.errorMessage=PowerpointCopilotStrings.OrganizePresentationInsufficientSlideContent,(0,I.r5)(t,PowerpointCopilotStrings.OrganizePresentationInsufficientSlideContent,void 0,void 0,s,p),(0,w.hX)(i)||(i.error=PowerpointCopilotStrings.OrganizePresentationInsufficientSlideContent),d=E.Nr.OrganizePresentationInsufficientSlideContent;break;case h.O.InvalidPresentationLanguage:var f;if(u&&(f=(0,w.Pz)(u,PowerpointCopilotStrings.OrganizePresentationUnsupportedLanguage,P.kL$)),f){var g;p.errorMessage=f;var m=(0,l.PA)(l.IY.ShouldAddLinkSuffixForErrorMessage)?"\n\n"+PowerpointCopilotStrings.FeedbackPrompt:"",y={linkText:PowerpointCopilotStrings.CopilotSupportedLanguagesLearnMoreLink,linkPrefix:f,linkSuffix:m};null===(g=t.current)||void 0===g||g.addResponseMessage((0,I.FL)(y,n,P.vIf,I.x5,!0,c.Xw.CHATPPT,void 0,void 0,p)),(0,w.hX)(i)||(i.error=f),d=E.Nr.OrganizePresentationUnsupportedLanguage}else p.errorMessage=PowerpointCopilotStrings.OrganizePresentationInvalidLanguaguage,(0,I.r5)(t,PowerpointCopilotStrings.OrganizePresentationInvalidLanguaguage,void 0,void 0,s,p),(0,w.hX)(i)||(i.error=PowerpointCopilotStrings.OrganizePresentationInvalidLanguaguage),d=E.Nr.OrganizePresentationInvalidLanguaguage;break;case h.O.UserThrottled:case h.O.ScenarioThrottled:case h.O.ResourceThrottled:p.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,I.r5)(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,s,p),(0,w.hX)(i)||(i.error=PowerpointCopilotStrings.ThrottlingErrorMessage),d=E.Nr.ThrottlingErrorMessage;break;case h.O.OutOfCredits:if((0,l.PA)(l.IY.EnableProdigiOutOfCreditsErrorHandling)){p.errorMessage=(0,P.R_I)(),(0,I.r5)(t,(0,P.R_I)(),void 0,void 0,!0,p),(0,w.hX)(i)||(i.error=(0,P.R_I)()),d=E.Nr.OutOfCreditsError;break}case h.O.Unknown:case h.O.FailedToFindCachedSlides:case h.O.SlideParserError:case h.O.OdslGenerationError:case h.O.SectionCreationError:case h.O.SectionValidationError:case h.O.SlideOrderGenerationError:case h.O.AgendaSlideTitleCreationError:case h.O.ExplanationGenerationError:default:p.errorMessage=PowerpointCopilotStrings.OrganizePresentationServiceUnavailable,(0,I.r5)(t,PowerpointCopilotStrings.OrganizePresentationServiceUnavailable,void 0,void 0,s,p),(0,w.hX)(i)||(i.error=PowerpointCopilotStrings.OrganizePresentationServiceUnavailable),d=E.Nr.OrganizePresentationServiceUnavailable}return d}(R,t,n,_,Q,!(0,L.w_)(),q),(0,L.gj)()?[3,1]:(g.R.getInstance().setState(c.Nj.IDLE),s.G.getInstance().emptyContextIdListandCleanup(),[3,3])):[3,4];case 1:return[4,(0,L.Ge)(Q,t)];case 2:ue.sent(),ue.label=3;case 3:return(0,v.AQ)(H,u.qD,"".concat(f.B.getTypeName(),"_Error"),h.O[R.errorCode],c.T_.Server,void 0,!(0,L.w_)(),J),(0,B.k)(!1,"OrganizePresentationWorkflow_".concat(h.O[R.errorCode]),m.Cu.Organize,A),[2];case 4:(0,T.cY)("Statements received from ODSL for organize Presentation :"+JSON.stringify(M)+"status: "+D),X={status:c.rI.SUCCESS},K=!0,Z=(new Date).getTime(),z.setScenarioName(m.Cu.Organize),ue.label=5;case 5:return ue.trys.push([5,10,,11]),(0,l.PA)(l.IY.UseOrganizePresentationJOfcCmds)&&(null==G||null===($=G.cmds)||void 0===$?void 0:$.length)?(a(!1),(0,T.cY)("jOfcPayload received from Organize Presentation :"+JSON.stringify(G)),ee=(0,l.PA)(l.IY.LogQuerySubmitTime)?{scenarioName:m.Cu.Organize,startTime:z.getStartTime(),entryPoint:P.$kB.Chat,correlationId:Y,timeToODSLMS:1e3*z.getResponseTime(),timeODSLToJOfcMS:0,capability:z.getCapability(),featureName:z.getFeatureName(),subFeatureName:z.getSubFeatureName(),querySubmitTime:u.qD,additionalSystemMetadataInfo:A}:{scenarioName:m.Cu.Organize,startTime:z.getStartTime(),entryPoint:P.$kB.Chat,correlationId:Y,timeToODSLMS:1e3*z.getResponseTime(),timeODSLToJOfcMS:0,capability:z.getCapability(),featureName:z.getFeatureName(),subFeatureName:z.getSubFeatureName(),additionalSystemMetadataInfo:A},(0,T.cY)("scenarioOptions : ",JSON.stringify(ee)),te={scenarioOptions:JSON.stringify(ee)},(0,l.PA)(l.IY.OrganizeDesignerOptions)&&V&&(ne=V.designerOptions?JSON.stringify(V.designerOptions):void 0,(0,T.cY)("designerOptions : ",ne),te.designerOptions=ne),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,O.Rf)(e,G.cmds,te)];case 1:return X=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())]):[3,7];case 6:return ue.sent(),[3,9];case 7:return[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,O.sW)(e,M,a,K)];case 1:return X=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 8:ue.sent(),ue.label=9;case 9:return(0,T.cY)("log result : ",JSON.stringify(X)),[3,11];case 10:return re=ue.sent(),(0,T.cY)("Execute failed:"+JSON.stringify(re)),X={status:c.rI.FAILED,error:c.Re.JOFC_EXCEPTION},[3,11];case 11:switch(H.sendLatencyTelemetry((0,v.pN)((0,o._)({},E.CT.QueryExecutionTime,(0,u.WU)(Z)))),(0,l.PA)(l.IY.IsJofcCommandErrorTelemetryEnabled)&&X.status!==c.rI.SUCCESS&&H.sendChatEventTelemetry((0,v.pN)((ie={},(0,o._)(ie,E.h3.ChatEventType,E.a5.OrganizePresentationJOfcCommandsError),(0,o._)(ie,E.h3.ChatEventParameters,c.Re[null!==(oe=X.error)&&void 0!==oe?oe:c.Re.UNKNOWN_ERROR]),ie))),X.status){case c.rI.BLOCKED:case c.rI.UNSUPPORTED:case c.rI.FAILED:case c.rI.UNEXPECTED_VERSION:case c.rI.USER_ABORTED:case c.rI.PARTIAL_SUCCESS:(0,F.af)(X,t,d,f.B.getTypeName(),Q,!(0,L.w_)());break;case c.rI.SUCCESS:Q.status=x.Aw.success,se=!(0,L.w_)(),le={featureName:E.CC.Organize,subFeatureName:E.Ff.Organize},null===(ae=t.current)||void 0===ae||ae.addResponseMessage((0,I.YL)(U,PowerpointCopilotStrings.AssistantResponseOrganizePrefix,void 0,I.tc,se,void 0,m.SD.Organize,void 0,le)),H.sendChatEventTelemetry((0,v.pN)((ce={},(0,o._)(ce,E.h3.ChatEventType,E.a5.QuerySuccessful),(0,o._)(ce,E.h3.ChatEventParameters,f.B.getTypeName()),ce))),(0,v.AQ)(H,u.qD,void 0,void 0,void 0,void 0,se)}return(0,L.gj)()?[4,(0,L.Ge)(Q,t)]:[3,13];case 12:return ue.sent(),[3,14];case 13:g.R.getInstance().setState(c.Nj.IDLE),s.G.getInstance().emptyContextIdListandCleanup(),ue.label=14;case 14:return z.resetData(),[2]}}))}));return function(t,n,r,o,i,a){return e.apply(this,arguments)}}()},65917:(e,t,n)=>{"use strict";n.d(t,{_:()=>d});var r=n(11912),o=n(91165),i=n(90813),a=n(18758),s=n(39041),l=n(44632),c=n(18384),u=n(12542),d=function(){function e(){(0,r._)(this,e),(0,i._)(this,"lastSlideCountUpdateTime",-1),(0,i._)(this,"lastHasSectionUpdateTime",-1),(0,i._)(this,"documentState",{isCreateNew:!1,isDocDirty:!1,isIrm:!1,slideCount:0,hasSection:!1,themeId:"",isCreateNewFromBlank:!1}),(0,i._)(this,"cachedDocumentState",{isCreateNew:!1,isDocDirty:!1,isIrm:!1,slideCount:0,hasSection:!1,themeId:"",isCreateNewFromBlank:!1}),this.documentState.isDocDirty=!1,this.documentState.isIrm=!1,this.documentState.isCreateNew=!1,this.documentState.slideCount=0,this.documentState.hasSection=!1,this.documentState.themeId="",this.documentState.isCreateNewFromBlank=!1,this.cachedDocumentState.isDocDirty=!1,this.cachedDocumentState.isIrm=!1,this.cachedDocumentState.isCreateNew=!1,this.cachedDocumentState.slideCount=0,this.cachedDocumentState.hasSection=!1,this.cachedDocumentState.themeId="",this.cachedDocumentState.isCreateNewFromBlank=!1}return(0,o._)(e,[{key:"powerpointDocumentStateAnnotationProcessor",value:function(e,t){var n=e.body;this.documentState.isDocDirty=null==n?void 0:n.isDocDirty,this.documentState.isIrm=null==n?void 0:n.isIrm,this.documentState.isCreateNew=null==n?void 0:n.isCreateNew;var r=this.documentState.slideCount;this.documentState.slideCount=null==n?void 0:n.slideCount,this.documentState.slideCount!==r&&(this.lastSlideCountUpdateTime=Date.now());var o=this.documentState.hasSection;this.documentState.hasSection=null==n?void 0:n.hasSection,this.documentState.hasSection!==o&&(this.lastHasSectionUpdateTime=Date.now()),this.documentState.themeId=null==n?void 0:n.themeId,this.documentState.isCreateNewFromBlank=(null==n?void 0:n.isCreateNewFromBlank)||!1,this.documentState.latestDownloadUrl=null==n?void 0:n.latestDownloadUrl,l.B.getInstance().sendChatEventTelemetry((0,c.pN)((0,i._)({},u.h3.ChatEventType,u.a5.DocumentStateReceived))),t(),(0,a.cY)("Document state received from Document State Powerpoint Workflow ".concat(JSON.stringify(this.documentState)))}},{key:"getDocumentState",value:function(){return this.documentState}},{key:"setDocumentState",value:function(e){this.documentState.isDocDirty=e.isDocDirty,this.documentState.isIrm=e.isIrm,this.documentState.isCreateNew=e.isCreateNew,this.documentState.slideCount=e.slideCount,this.documentState.hasSection=e.hasSection,this.documentState.themeId=e.themeId,this.documentState.isCreateNewFromBlank=e.isCreateNewFromBlank,this.documentState.latestDownloadUrl=e.latestDownloadUrl}},{key:"getCachedDocumentState",value:function(){return this.cachedDocumentState}},{key:"setCachedDocumentState",value:function(){this.cachedDocumentState.isDocDirty=this.documentState.isDocDirty,this.cachedDocumentState.isIrm=this.documentState.isIrm,this.cachedDocumentState.isCreateNew=this.documentState.isCreateNew,this.cachedDocumentState.slideCount=this.documentState.slideCount,this.cachedDocumentState.hasSection=this.documentState.hasSection,this.cachedDocumentState.themeId=this.documentState.themeId,this.cachedDocumentState.isCreateNewFromBlank=this.documentState.isCreateNewFromBlank,this.cachedDocumentState.latestDownloadUrl=this.documentState.latestDownloadUrl}},{key:"getSlideCount",value:function(){return this.documentState.slideCount}},{key:"getLastSlideCountUpdateTime",value:function(){return this.lastSlideCountUpdateTime}},{key:"getLastHasSectionUpdateTime",value:function(){return this.lastHasSectionUpdateTime}},{key:"isCreatePresentationEnabled",value:function(){return!(!this.documentState.isCreateNew||this.documentState.isIrm||this.documentState.isDocDirty)}},{key:"isCreatePresentationEnabledCached",value:function(){return!(!this.cachedDocumentState.isCreateNew||this.cachedDocumentState.isIrm||this.cachedDocumentState.isDocDirty)}},{key:"isDocumentIrm",value:function(){return!!this.documentState.isIrm}},{key:"isDocumentIrmCached",value:function(){return!!this.cachedDocumentState.isIrm}},{key:"getSlideCountCached",value:function(){return this.cachedDocumentState.slideCount}},{key:"isCreateNewFromBlank",value:function(){return this.documentState.isCreateNewFromBlank}}],[{key:"getInstance",value:function(){return(0,s.hX)(e.documentStateHandler)&&(e.documentStateHandler=new e),e.documentStateHandler}}]),e}();(0,i._)(d,"documentStateHandler",void 0)},50481:(e,t,n)=>{"use strict";n.d(t,{Cg:()=>tn,gK:()=>ht,b4:()=>Ue,pe:()=>sn,d3:()=>$t,w_:()=>Kt,qF:()=>rn,pq:()=>vt,K2:()=>Zt,My:()=>en,Mb:()=>kt,gj:()=>Ot,Ge:()=>Dt,Ob:()=>St,wu:()=>Xt,vE:()=>nn,S6:()=>ze,Yb:()=>Rt});var r=n(43032),o=n(90813),i=n(57835),a=n(61838);function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=n(81092),c=n(79490),u=n(53154),d=n(16912),p=n(55564),f=n(39726),h=n(2061),g=n(69038),m=n(85535),y=n(70825),v=n(24643),S=n(93176),C=n(48544);const b=[{name:"undo_application",alternateNames:["reverse","undo"],description:"Reverse the previous action taken by the user.",returnVariable:{type:"void",description:""},args:[]},{name:"insert_images",alternateNames:["insertImages","insert_image"],description:"Generates an image from the given text description and inserts it into the given slides.",returnVariable:{type:"shapes",description:"The images that were inserted."},args:[{name:"description",required:!0,description:"Text description of the image to insert.",type:"string"},{name:"slides",alternateNames:["scope"],required:!0,description:"The slides on which to insert the image.",type:"slides",promptAlternative:{name:"scope"},validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"imageType",required:!1,description:"The type of image to insert.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Default","Icon","Sticker","Cutout","Cartoon"]}}]},{name:"image_invalid",alternateNames:[],description:"insert_images statements that contained an invalid image description are corrected to this statement. This statement should only be inserted during post processing.",returnVariable:{type:"void",description:""},args:[]},{name:"invalid_request",alternateNames:["invalidRequest"],description:"user requests that are not currently supported should return this statement.",returnVariable:{type:"void",description:""},args:[]},{name:"select_shapes",alternateNames:["selectShapes","select_shape"],description:"Selects shapes as specified by the given scope and index.",returnVariable:{type:"shapes",description:"The shapes that match the given selection criteria."},args:[{name:"scope",required:!0,description:"The slides from which shapes should be selected.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"index",required:!1,description:"The index of the shape to select. index is 0-based. For example, index of fourth shape is 3.",type:"selectionIndex"},{name:"shapeType",required:!1,description:"The type of shape to select.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["GeometricShape","Image","Textbox","Curve","Elbow","Straight","LineInverse","Triangle","RightTriangle","Rectangle","Diamond","Parallelogram","Trapezoid","NonIsoscelesTrapezoid","Pentagon","Hexagon","Heptagon","Octagon","Decagon","Dodecagon","Star4","Star5","Star6","Star7","Star8","Star10","Star12","Star16","Star24","Star32","RoundRectangle","Round1Rectangle","Round2SameRectangle","Round2DiagonalRectangle","SnipRoundRectangle","Snip1Rectangle","Snip2SameRectangle","Snip2DiagonalRectangle","Plaque","Ellipse","Teardrop","HomePlate","Chevron","PieWedge","Pie","BlockArc","Donut","NoSmoking","RightArrow","LeftArrow","UpArrow","DownArrow","StripedRightArrow","NotchedRightArrow","BentUpArrow","LeftRightArrow","UpDownArrow","LeftUpArrow","LeftRightUpArrow","QuadArrow","LeftArrowCallout","RightArrowCallout","UpArrowCallout","DownArrowCallout","LeftRightArrowCallout","UpDownArrowCallout","QuadArrowCallout","BentArrow","UturnArrow","CircularArrow","LeftCircularArrow","LeftRightCircularArrow","CurvedRightArrow","CurvedLeftArrow","CurvedUpArrow","CurvedDownArrow","SwooshArrow","Cube","Can","LightningBolt","Heart","Sun","Moon","SmileyFace","IrregularSeal1","IrregularSeal2","FoldedCorner","Bevel","Frame","HalfFrame","Corner","DiagonalStripe","Chord","Arc","LeftBracket","RightBracket","LeftBrace","RightBrace","BracketPair","BracePair","Callout1","Callout2","Callout3","AccentCallout1","AccentCallout2","AccentCallout3","BorderCallout1","BorderCallout2","BorderCallout3","AccentBorderCallout1","AccentBorderCallout2","AccentBorderCallout3","WedgeRectCallout","WedgeRRectCallout","WedgeEllipseCallout","CloudCallout","Cloud","Ribbon","Ribbon2","EllipseRibbon","EllipseRibbon2","LeftRightRibbon","VerticalScroll","HorizontalScroll","Wave","DoubleWave","Plus","FlowChartProcess","FlowChartDecision","FlowChartInputOutput","FlowChartPredefinedProcess","FlowChartInternalStorage","FlowChartDocument","FlowChartMultidocument","FlowChartTerminator","FlowChartPreparation","FlowChartManualInput","FlowChartManualOperation","FlowChartConnector","FlowChartPunchedCard","FlowChartPunchedTape","FlowChartSummingJunction","FlowChartOr","FlowChartCollate","FlowChartSort","FlowChartExtract","FlowChartMerge","FlowChartOfflineStorage","FlowChartOnlineStorage","FlowChartMagneticTape","FlowChartMagneticDisk","FlowChartMagneticDrum","FlowChartDisplay","FlowChartDelay","FlowChartAlternateProcess","FlowChartOffpageConnector","ActionButtonBlank","ActionButtonHome","ActionButtonHelp","ActionButtonInformation","ActionButtonForwardNext","ActionButtonBackPrevious","ActionButtonEnd","ActionButtonBeginning","ActionButtonReturn","ActionButtonDocument","ActionButtonSound","ActionButtonMovie","Gear6","Gear9","Funnel","MathPlus","MathMinus","MathMultiply","MathDivide","MathEqual","MathNotEqual","CornerTabs","SquareTabs","PlaqueTabs","ChartX","ChartStar","ChartPlus"],enumValuesAlternateNames:["WedgeEllipseCallout:SpeechBubble","RightArrow:Arrow","MathEqual:Equation","Ellipse:Oval","Ellipse:Circle","FlowChartConnector:Connector","Straight:Line","Rectangle:Square","Image:Picture"],enumValuesToReject:["Flowchart"]}},{name:"name",required:!1,description:"Name of the shapes to select. This filter is unioned with shapeType.",type:"string"},{name:"shapeIds",required:!1,description:"The shape IDs that match the given selection criteria.",type:"string"},{name:"left",required:!1,description:"The left position of the shape.",type:"positiveNumber"},{name:"top",required:!1,description:"The top position of the shape.",type:"positiveNumber"},{name:"height",required:!1,description:"The height of the shape.",type:"positiveNumber"},{name:"width",required:!1,description:"The width of the shape.",type:"positiveNumber"},{name:"area",required:!1,description:"The area of the shape.",type:"positiveNumber"},{name:"lineColor",required:!1,description:"The color of the shape's outline.",type:"color"},{name:"lineDashStyle",required:!1,description:"The dash style of the shape's outline.",type:"enum",validationArgs:{enumValues:["Dash","DashDot","DashDotDot","LongDash","LongDashDot","RoundDot","Solid","SquareDot","LongDashDotDot","SystemDash","SystemDot","SystemDashDot"]}},{name:"lineWeight",required:!1,description:"The weight of the shape's outline.",type:"positiveNumber"},{name:"lineTransparency",required:!1,description:"The transparency of the shape's outline.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"fillColor",required:!1,description:"The color of the shape's fill.",type:"color"},{name:"fillTransparency",required:!1,description:"The transparency of the shape's fill.",type:"rangedNumber",validationArgs:{min:0,max:1}}]},{name:"insert_shapes",alternateNames:["insertShapes","insert_shape"],description:"Inserts shapes of shapeType in the provided slides.",returnVariable:{type:"shapes",description:"The shapes that were inserted."},args:[{name:"slides",required:!0,description:"The slides on which shapes has to be inserted.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"shapeType",required:!0,description:"The type of shape to insert.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["InjectForShapesCircleSquare"],enumValues:["Textbox","Curve","Elbow","Straight","LineInverse","Triangle","RightTriangle","Rectangle","Diamond","Parallelogram","Trapezoid","NonIsoscelesTrapezoid","Pentagon","Hexagon","Heptagon","Octagon","Decagon","Dodecagon","Star4","Star5","Star6","Star7","Star8","Star10","Star12","Star16","Star24","Star32","RoundRectangle","Round1Rectangle","Round2SameRectangle","Round2DiagonalRectangle","SnipRoundRectangle","Snip1Rectangle","Snip2SameRectangle","Snip2DiagonalRectangle","Plaque","Ellipse","Teardrop","HomePlate","Chevron","PieWedge","Pie","BlockArc","Donut","NoSmoking","RightArrow","LeftArrow","UpArrow","DownArrow","StripedRightArrow","NotchedRightArrow","BentUpArrow","LeftRightArrow","UpDownArrow","LeftUpArrow","LeftRightUpArrow","QuadArrow","LeftArrowCallout","RightArrowCallout","UpArrowCallout","DownArrowCallout","LeftRightArrowCallout","UpDownArrowCallout","QuadArrowCallout","BentArrow","UturnArrow","CircularArrow","LeftCircularArrow","LeftRightCircularArrow","CurvedRightArrow","CurvedLeftArrow","CurvedUpArrow","CurvedDownArrow","SwooshArrow","Cube","Can","LightningBolt","Heart","Sun","Moon","SmileyFace","IrregularSeal1","IrregularSeal2","FoldedCorner","Bevel","Frame","HalfFrame","Corner","DiagonalStripe","Chord","Arc","LeftBracket","RightBracket","LeftBrace","RightBrace","BracketPair","BracePair","Callout1","Callout2","Callout3","AccentCallout1","AccentCallout2","AccentCallout3","BorderCallout1","BorderCallout2","BorderCallout3","AccentBorderCallout1","AccentBorderCallout2","AccentBorderCallout3","WedgeRectCallout","WedgeRRectCallout","WedgeEllipseCallout","CloudCallout","Cloud","Ribbon","Ribbon2","EllipseRibbon","EllipseRibbon2","LeftRightRibbon","VerticalScroll","HorizontalScroll","Wave","DoubleWave","Plus","FlowChartProcess","FlowChartDecision","FlowChartInputOutput","FlowChartPredefinedProcess","FlowChartInternalStorage","FlowChartDocument","FlowChartMultidocument","FlowChartTerminator","FlowChartPreparation","FlowChartManualInput","FlowChartManualOperation","FlowChartConnector","FlowChartPunchedCard","FlowChartPunchedTape","FlowChartSummingJunction","FlowChartOr","FlowChartCollate","FlowChartSort","FlowChartExtract","FlowChartMerge","FlowChartOfflineStorage","FlowChartOnlineStorage","FlowChartMagneticTape","FlowChartMagneticDisk","FlowChartMagneticDrum","FlowChartDisplay","FlowChartDelay","FlowChartAlternateProcess","FlowChartOffpageConnector","ActionButtonBlank","ActionButtonHome","ActionButtonHelp","ActionButtonInformation","ActionButtonForwardNext","ActionButtonBackPrevious","ActionButtonEnd","ActionButtonBeginning","ActionButtonReturn","ActionButtonDocument","ActionButtonSound","ActionButtonMovie","Gear6","Gear9","Funnel","MathPlus","MathMinus","MathMultiply","MathDivide","MathEqual","MathNotEqual","CornerTabs","SquareTabs","PlaqueTabs","ChartX","ChartStar","ChartPlus"],enumValuesAlternateNames:["WedgeEllipseCallout:SpeechBubble","RightArrow:Arrow","MathEqual:Equation","Ellipse:Oval","Ellipse:Circle","FlowChartConnector:Connector","Straight:Line"],enumValuesToReject:["Flowchart"]}},{name:"description",required:!1,description:"The description of the shapeType that needs to be inserted.",type:"string"}]},{name:"format_shapes",alternateNames:["formatShapes","format_shape"],description:"Format the specified shapes using the given parameters.",returnVariable:{type:"void",description:""},args:[{name:"shapes",alternateNames:["scope"],required:!0,description:"The shapes to format.",type:"shapes",promptAlternative:{name:"scope"}},{name:"left",required:!1,description:"The left position of the shape.",type:"positiveNumber"},{name:"top",required:!1,description:"The top position of the shape.",type:"positiveNumber"},{name:"height",required:!1,description:"The height of the shape.",type:"positiveNumber"},{name:"width",required:!1,description:"The width of the shape.",type:"positiveNumber"},{name:"lineColor",required:!1,description:"The color of the shape's outline.",type:"color"},{name:"lineDashStyle",required:!1,description:"The dash style of the shape's outline.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Dash","DashDot","DashDotDot","LongDash","LongDashDot","RoundDot","Solid","SquareDot","LongDashDotDot","SystemDash","SystemDot","SystemDashDot"]}},{name:"lineStyle",required:!1,description:"The style of the shape's outline.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Single","ThickBetweenThin","ThickThin","ThinThick","ThinThin"]}},{name:"lineWeight",required:!1,description:"The weight of the shape's outline.",type:"positiveNumber"},{name:"lineTransparency",required:!1,description:"The transparency of the shape's outline.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"fillColor",required:!1,description:"The color of the shape's fill.",type:"color"},{name:"fillTransparency",required:!1,description:"The transparency of the shape's fill.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"shadowPreset",required:!1,description:"The preset type of the shadow.",type:"enum",validationArgs:{enumValues:["TopLeftInner","TopInner","TopRightInner","LeftInner","RightInner","BottomRightInner","BottomInner","BottomLeftInner","CenterInner","TopLeftOuter","TopOuter","TopRightOuter","LeftOuter","RightOuter","BottomRightOuter","BottomOuter","BottomLeftOuter","CenterOuter","Perspective1","Perspective2","Perspective3","Perspective4","Perspective5"]}},{name:"shadowAlign",required:!1,description:"The alignment of the shadow.",type:"enum",validationArgs:{enumValues:["TopLeft","Top","TopRight","Left","Right","BottomLeft","Bottom","BottomRight","Center"]}},{name:"shadowColor",required:!1,description:"The color of the shape's shadow.",type:"color"},{name:"shadowTransparency",required:!1,description:"The transparency of the shape's shadow.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"shadowScaleX",required:!1,description:"The horizontal scale of the shape's shadow in percentage of the size of the shape.",type:"number"},{name:"shadowScaleY",required:!1,description:"The vertical scale of the shape's shadow in percentage of the size of the shape.",type:"number"},{name:"shadowSkewX",required:!1,description:"The horizontal skew of the shape's shadow.",type:"number"},{name:"shadowSkewY",required:!1,description:"The vertical skew of the shape's shadow.",type:"number"},{name:"shadowRadius",required:!1,description:"The blur radius of the shape's shadow in points.",type:"number"},{name:"shadowAngle",required:!1,description:"The angle of the shape's shadow.",type:"rangedNumber",validationArgs:{min:0,max:359}},{name:"shadowDistance",required:!1,description:"The distance of the shape's shadow in points.",type:"rangedNumber",validationArgs:{min:0,max:200}},{name:"alignHorizontal",required:!1,description:"aligning shapes horizontally.",type:"enum",validationArgs:{enumValues:["Left","Right","Center"]}},{name:"alignVertical",required:!1,description:"aligning shapes vertically.",type:"enum",validationArgs:{enumValues:["Top","Middle","Bottom"]}},{name:"distribute",required:!1,description:"distributing shapes around the slide.",type:"enum",validationArgs:{enumValues:["Horizontal","Vertical"]}},{name:"alignRelative",required:!1,description:"aligning shapes with respect to a reference.",type:"enum",validationArgs:{enumValues:["Slide","SelectedObjects"]}},{name:"animation",required:!1,description:"If an animation should be applied.",type:"boolean",validationArgs:{correctionStrategy:["StringAsTrue"]}},{name:"animationType",required:!1,description:"The type of animation to be applied, default is entrance.",type:"enum",validationArgs:{enumValues:["Entrance","Exit","Emphasis"]}},{name:"animationName",required:!1,description:"The name of the animation to be applied, default is appear.",type:"enum",validationArgs:{enumValues:["Appear","Fade","FlyIn","FloatIn","Split","Wipe","Shape","Wheel","RandomBars","GrowAndTurn","Zoom","Swivel","Bounce","Pulse","ColorPulse","Teeter","Spin","GrowShrink","Desaturate","Darken","Lighten","Transparency","ObjectColor","ComplementaryColor","LineColor","FillColor","BrushColor","FontColor","Underline","BoldFlash","BoldReveal","Wave","Disappear","FlyOut","FloatOut","ShrinkAndTurn"]}},{name:"animationDuration",required:!1,description:"The duration of the animation to be applied in milliseconds.",type:"number"},{name:"animationDelay",required:!1,description:"The delay of the animation to be applied in milliseconds.",type:"number"},{name:"zOrder",required:!1,description:"The order of the shape along the depth axis.",type:"enum",validationArgs:{enumValues:["Front","Forward","Backward","Back"]}}]},{name:"delete_shapes",alternateNames:["deleteShapes","delete_shape"],description:"Delete the specified shapes.",returnVariable:{type:"void",description:""},args:[{name:"shapes",alternateNames:["scope"],required:!0,description:"The shapes to delete.",type:"shapes",promptAlternative:{name:"scope"}}]},{name:"select_semantic_shape",alternateNames:["selectSemanticShape"],description:"Selects shapes based on natural language descriptions of their content within the presentation. This function is best used when you want to select shapes based on its text content, rather than its style, position, or location within the presentation. For example, if you want to select shapes containing text that discusses a specific topic, you can use this function to describe the desired text content within the shape in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"shapes",description:"The shapes that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the shapes to select.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body","Image:Picture"]}}]},{name:"select_indices_shape",alternateNames:[],description:"Selects shapes using the given shape indices.",returnVariable:{type:"shapes",description:"The shapes matching the given shape indices."},args:[{name:"indices",required:!0,description:"The shape indices that match the given selection criteria.",type:"string"}]},{name:"select_slides",alternateNames:["selectSlides","select_slide"],description:"Selects slides using the given scope and index.",returnVariable:{type:"slides",description:"The slides that match the given selection criteria."},args:[{name:"scope",required:!1,description:'The scope from which slides should be selected. The default value is "Selection", which selects the current selection of slide(s). Use "Presentation" to select all slides in the presentation.',type:"enum",validationArgs:{enumValues:["Selection","Presentation"]}},{name:"index",required:!1,description:"The index of the slide to select. index is 0-based. For example, index of fourth slide is 3.",type:"selectionIndexExtended"},{name:"id",required:!1,description:"The creation ID of the slide to select.",type:"string"}]},{name:"create_new_presentation_using_source",alternateNames:["createNewPresentationUsingSource","create_new_presentation_using_source"],description:"Generates and inserts a new presentation of slides by transforming a source file. Use when creating a slideshow, presentation, or PPT.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides we will be replacing when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"source",alternateNames:["file","document"],required:!0,description:"The source file to use when generating slides.",type:"string"}]},{name:"create_new_presentation_using_prompt",alternateNames:["createNewPresentationUsingPrompt","create_new_presentation_using_prompt"],description:"Generates a new presentation of slides from a prompt and replaces the existing slides with it. Use when creating a slideshow, presentation, or PPT.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides we will be replacing when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!0,description:"The prompt to use when generating a new presentation.",type:"string"}]},{name:"create_slides_using_prompt",alternateNames:["createSlidesUsingPrompt","create_slides_using_prompt"],description:"Generates new slide(s) from a prompt and inserts them after the given slides.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!0,description:"The prompt to use when generating slides.",type:"string"}]},{name:"generate_slides",alternateNames:["generateSlides","generate_slide"],description:"Do Not use this function",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides. Required when adding slides, but not needed when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!1,description:"The prompt to use when generating slides.",type:"string",validationArgs:{correctionStrategy:["EnsureSingleValue"]}},{name:"source",alternateNames:["file","document"],required:!1,description:"The source file to use when generating slides.",type:"string"},{name:"createPresentation",required:!1,description:"If the generate_slides statement is for presentation creation. Default is false. True when generating a new presentation via prompt or from source file.",type:"boolean"}]},{name:"generate_slides",alternateNames:["generateSlides","generate_slide"],description:"Performs 1 of 3 tasks, all of which insert new slide(s). 1) Generate new slide(s) from a prompt and inserts them after the given slides. 2) Generate a new presentation of slides by transforming a source file. 3) Generate a new presentation of slides from a prompt.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides. Required when adding slides, but not needed when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!1,description:"The prompt to use when generating slides. Default is false.",type:"string"},{name:"source",alternateNames:["file","document"],required:!1,description:"The source file to use when generating slides. Default is blank.",type:"string"},{name:"createPresentation",required:!1,description:"If the generate_slides statement is for presentation creation. Default is false. True when generating a new presentation via prompt or from source file.",type:"boolean"}]},{name:"format_slides",alternateNames:["formatSlides","format_slide"],description:"Arranges the given slide or presentation in a particular style when Human asks for it. Powerpoint uses designer to format the slides.",returnVariable:{type:"slides",description:"The slides that were formatted."},args:[{name:"slides",alternateNames:["scope"],required:!0,description:"The slides to format.",type:"slides",promptAlternative:{name:"scope"},validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"strategy",required:!1,description:'The formatting strategy to apply. Use "beautify" on 1+ slides to making them prettier. Use "organize" to reorganize the entire presentation, making it more structured. Use "ThemeIdeas" to try a new design on the entire presentation.',type:"enum",validationArgs:{enumValues:["beautify","organize","ThemeIdeas"],enumValuesAlternateNames:["organize:structure"],correctionStrategy:["Dismissable","ReplaceStructureWithOrganize"]}},{name:"animation",required:!1,description:"If an animation should be applied.",type:"boolean",validationArgs:{correctionStrategy:["StringAsTrue"]}},{name:"isVisible",required:!1,description:"If the slide is visible.",type:"boolean"},{name:"targetFormatSlideByIndex",required:!1,description:"The index of the slides whose format we should follow for transform.",type:"selectionIndexExtended"}]},{name:"delete_slides",alternateNames:["deleteSlides","delete_slide"],description:"Deletes the given slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",alternateNames:["scope"],required:!0,description:"The slides to delete.",type:"slides",promptAlternative:{name:"scope"}}]},{name:"move_slides",alternateNames:["moveSlides","move_slide"],description:"Moves slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!0,description:"The slides to move.",type:"slides"},{name:"precededBy",alternateNames:["target"],required:!0,description:"The target slides besides which we move the slides to.",type:"slides",promptAlternative:{name:"target"}},{name:"before",required:!1,description:"Whether to move the slides before or after the target. The default value is false.",type:"boolean"}]},{name:"transition_slides",alternateNames:["transitionSlides","transition_slide"],description:"Transitions slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!1,description:"The slides to transition.",type:"slides"},{name:"type",required:!1,description:"The type of the transition.",type:"enum",validationArgs:{enumValues:["None","Morph","Fade","Push","Wipe","Split","Reveal","Cut","RandomBars","Shape","Uncover","Cover","Flash","FallOver","Drape","Curtains","Wind","Prestige","Fracture","Crush","PeelOff","PageCurl","Airplane","Origami","Dissolve","Checkerboard","Blinds","Clock","Ripple","Honeycomb","Glitter","Vortex","Shred","Switch","Flip","Gallery","Cube","Doors","Box","Comb","Zoom","Random","Pan","FerrisWheel","Conveyor","Rotate","Window","Orbit","FlyThrough"]}},{name:"time",required:!1,description:"The length of the transition in seconds.",type:"positiveNumber"},{name:"delay",required:!1,description:"The number of second to delay before moving to the next slide.",type:"positiveNumber"}]},{name:"select_semantic_slide",alternateNames:["selectSemanticSlide"],description:"Selects slides based on natural language descriptions of their content within the presentation. This function is best used when you want to select slides based on its text content, rather than its position or location within the presentation. For example, if you want to select slides containing text that discusses a specific topic, you can use this function to describe the desired text content in the slide in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"slides",description:"The slides that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the shapes on a slide to evaluate the selection criteria.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body"]}}]},{name:"select_indices_slide",alternateNames:[],description:"Selects slides using the given slide indices.",returnVariable:{type:"slides",description:"The slides matching the given shape indices."},args:[{name:"indices",required:!0,description:"The slide indices that match the given selection criteria.",type:"string"}]},{name:"rewrite_slides",alternateNames:["rewriteSlides","rewrite_slide"],description:"Rewrites slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!0,description:"The slides to rewrite.",type:"slides"},{name:"prompt",required:!0,description:"The prompt to use when rewriting slides.",type:"string"}]},{name:"select_text",alternateNames:["selectText"],description:"Selects text using the given scope, text pattern, or index. Defaults to current user selection if no parameters are provided.",returnVariable:{type:"textRanges",description:"The textRanges that match the given selection criteria."},args:[{name:"scope",required:!1,description:'The scope from which text should be selected. Default is user selection. shapes and slides are target entities obtained from other functions. "Presentation" selects all text in the presentation.',type:["shapes","slides","Presentation"],validationArgs:{correctionStrategy:["Dismissable"]}},{name:"text",required:!1,description:"The text to select.",type:"stringOrRegex"},{name:"index",required:!1,description:"The occurrence of matched text to select.",type:"selectionIndex"},{name:"name",required:!1,description:"The name of the text boxes to select.",type:"string",validationArgs:{correctionStrategy:["TitleSubtitleNameFixup"]}}]},{name:"insert_text",alternateNames:["insertText"],description:"Inserts provided text after the selected textRanges.",returnVariable:{type:"textRanges",description:"The textRanges that were inserted."},args:[{name:"precededBy",required:!0,description:"The textRange after which we should insert the text.",type:"textRanges",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_text"]}},{name:"text",required:!0,description:"The text to insert.",type:"string"}]},{name:"format_text",alternateNames:["formatText"],description:"Format the specified textRanges using the given arguments.",returnVariable:{type:"void",description:""},args:[{name:"textRanges",alternateNames:["scope"],required:!0,description:"The textRanges to format.",type:"textRanges",promptAlternative:{name:"scope"}},{name:"color",alternateNames:["fontColor"],required:!1,description:"The text color to apply.",type:"color"},{name:"bold",required:!1,description:"Whether the text should be bold.",type:"boolean"},{name:"italic",required:!1,description:"Whether the text should be italic.",type:"boolean"},{name:"underline",required:!1,description:"The underline style to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Dash","DashHeavy","DashLong","DashLongHeavy","DotDash","DotDashHeavy","DotDotDash","DotDotDashHeavy","Dotted","DottedHeavy","Double","Heavy","None","Single","Wavy","WavyDouble","WavyHeavy"],enumValuesAlternateNames:["None:false","Wavy:Wave"]}},{name:"fontName",required:!1,description:"The font name to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Abadi","Agency FB","Aharoni","Aldhabi","Algerian","Amasis MT Pro","Angsana New","AngsanaUPC","Aparajita","Aptos","Arabic Typesetting","Arial","Arial Nova","Arial Rounded MT","Avenir Next LT Pro","Baguet Script","Bahnschrift","Baskerville Old Face","Batang","BatangChe","Bell MT","Berlin Sans FB","Bernard MT","Bierstadt","Bierstadt Display","Biome","Blackadder ITC","Bodoni MT","Bodoni MT Poster","Book Antiqua","Bookman Old Style","Bradley Hand ITC","Britannic","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Calibri","Californian FB","Calisto MT","Cambria","Cambria Math","Candara","Castellar","Cavolini","Century","Century Gothic","Century Schoolbook","Chamberi Super Display","Chiller","Cochocib Script Latin Pro","Colonna MT","Comic Sans MS","Congenial","Consolas","Constantia","Cooper","Copperplate Gothic","Corbel","Cordia New","CordiaUPC","Courier New","Curlz MT","DaunPenh","David","Daytona","DengXian","DilleniaUPC","DokChampa","Dotum","DotumChe","Dreaming Outloud Pro","Calibri Light","Georgia Pro","Sitka Heading","Sitka Text","Times New Roman","Verdana Pro","Dreaming Outloud Script Pro","Dubai","Ebrima","Edwardian Script ITC","Elephant Pro","Eras ITC","EucrosiaUPC","Euphemia","Fairwater Script","FangSong","Fave Script Pro","Felix Titling","Footlight MT","Forte","Forte Forward","Franklin Gothic","Franklin Gothic Book","FrankRuehl","FreesiaUPC","Freestyle Script","Gabriola","Gadugi","Garamond","Gautami","Georgia","Gigi","Gill Sans MT","Gill Sans Nova","Gisha","Gloucester MT","Goudy Old Style","Goudy Type","Grandview","Grandview Display","Grotesque","Gulim","GulimChe","Gungsuh","GungsuhChe","Hadassah Friedlaender","Harrington","HGGothicE","HGMaruGothicMPRO","HGMinchoE","HGPGothicE","HGPMinchoE","HGPSoeiKakugothicUB","HGSGothicE","HGSMinchoE","HGSoeiKakugothicUB","HGSSoeiKakugothicUB","High Tower Text","Impact","Imprint MT Shadow","Ink Free","IrisUPC","Iskoola Pota","JasmineUPC","Javanese Text","Jokerman","Juice ITC","Jumble","KaiTi","Kalinga","Kartika","Khmer UI","Kigelia","Kigelia Arabic","KodchiangUPC","Kokila","Kristen ITC","Kunstler Script","Lao UI","Latha","Leelawadee","Leelawadee UI","Levenim MT","LilyUPC","Lucida Bright","Lucida Calligraphy","Lucida Fax","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Magneto","Maiandra GD","Malgun Gothic","Mangal","Mangal Pro","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft GothicNeo","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft YaHei UI","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Miriam","Miriam Fixed","Mistral","Modern Love","Modern Love Caps","Modern Love Grunge","Modern No. 20","Mongolian Baiti","MoolBoran","MS Gothic","MS Mincho","MS PGothic","MS PMincho","MS UI Gothic","MT Extra","MV Boli","Myanmar Text","Mystical Woods Rough Script","Mystical Woods Smooth Script","Narkisim","Neue Haas Grotesk Text Pro","News Gothic MT","Niagara Engraved","Niagara Solid","Nirmala Text","Nirmala UI","Nordique Inline","NSimSun","Nyala","OCRB","Onyx","Palace Script MT","Palatino Linotype","Papyrus","Perpetua","Perpetua Titling MT","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Posterama","Pristina","Quire Sans","Raavi","Rage","Rastanty Cortez","Ravie","Rockwell","Rockwell Nova","Rod","Sabon Next LT","Sagona","Sagona Book","Sakkal Majalla","Sanskrit Text","Script MT","Seaford","Seaford Display","Segoe Print","Segoe Script","Segoe UI","Segoe UI Emoji","Segoe UI Historic","Segoe UI Symbol","Segoe UI Semibold","Selawik","Shonar Bangla","Shruti","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Small","Sitka Subheading","Skeena","Skeena Display","Snap ITC","Source Sans Pro","Speak Pro","STCaiyun","STFangsong","STHupo","STKaiti","STXihei","STXingkai","STXinwei","STZhongsong","Sylfaen","Symbol","Tahoma","Tempus Sans ITC","Tenorite","Tenorite Display","TH SarabunPSK","The Hand","The Serif Hand","Tisa Offc Serif Pro","Trade Gothic Inline","Trade Gothic Next","Trade Gothic Next Rounded","Traditional Arabic","Trebuchet MS","Tunga","Tw Cen MT","UD Digi Kyokasho N-B","UD Digi Kyokasho N-R","UD Digi Kyokasho NK-B","UD Digi Kyokasho NK-R","UD Digi Kyokasho NP-B","UD Digi Kyokasho NP-R","Univers","Urdu Typesetting","Utsaah","Vani","Verdana","Vijaya","Viner Hand ITC","Vivaldi","Vladimir Script","Vrinda","Walbaum Display","Walbaum Heading","Walbaum Text","Webdings","Wide Latin","Wingdings","Wingdings 2","Wingdings 3","Yu Gothic","Yu Gothic UI","Yu Mincho"]}},{name:"size",alternateNames:["fontSize"],required:!1,description:"The font size to apply.",type:"integer"},{name:"bulleted",required:!1,description:"Whether the text should be bulleted.",type:"boolean"},{name:"horizontalAlignment",required:!1,description:"The horizontal alignment to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Center","Distributed","Justify","JustifyLow","Left","Right","ThaiDistributed"],enumValuesAlternateNames:["Center:Middle"]}},{name:"verticalAlignment",required:!1,description:"The vertical alignment to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Bottom","BottomCentered","Middle","MiddleCentered","Top","TopCentered"],enumValuesAlternateNames:["Middle:Center"]}}]},{name:"delete_text",alternateNames:["deleteText"],description:"Clears the text in the specified textRanges.",returnVariable:{type:"void",description:""},args:[{name:"textRanges",alternateNames:["scope"],required:!0,description:"The textRanges to delete.",type:"textRanges",promptAlternative:{name:"scope"}}]},{name:"replace_text",alternateNames:["replaceText"],description:"Replaces the specified text with the specified new text.",returnVariable:{type:"void",description:""},args:[{name:"textToReplace",required:!0,description:"The text to replace.",type:"string"},{name:"newText",required:!0,description:"The new text to insert.",type:"string"}]},{name:"select_semantic_text",alternateNames:["selectSemanticText"],description:"Selects text ranges based on natural language descriptions of their content within the presentation. This function is best used when you want to select text ranges based on its content, rather than its exact wording, position, or location within the presentation. For example, if you want to select text ranges that discuss a specific topic, you can use this function to describe the desired selection in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"textRanges",description:"The text ranges that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the text boxes to select.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body"]}}]},{name:"select_indices_text",alternateNames:[],description:"Selects text ranges using the given shape reference and text.",returnVariable:{type:"textRanges",description:"The text ranges that reference the matching shape reference and text."},args:[{name:"indices",required:!0,description:"The text range reference that matches the given selection criteria.",type:"string"}]}];class E{constructor(e){this.validOdslExpression=[],this.handleApply=e=>{const t=this.planBuilderTasksToOdsl(e);this.planExecutor(t)},this.validOdslExpression=e.validOdslExpression||b,this.copilotChatRef=e.copilotChatRef,this.odslResponse=e.odslResponse,this.planExecutor=e.planExecutor}generateCard(){const e=this.generateInitialCardInput();this.copilotChatRef.addPlanBuilderResponseMessage(e,this.handleApply)}planBuilderTasksToOdsl(e){var t,n,r,o;if(e.length!==(null===(n=null===(t=this.odslResponse)||void 0===t?void 0:t.odsl)||void 0===n?void 0:n.statements.length))return{};const i=[];for(let t=0;t<e.length;t++){const n=null===(o=null===(r=this.odslResponse)||void 0===r?void 0:r.odsl)||void 0===o?void 0:o.statements[t],a=e[t].taskProperties,s=n&&a?this.replaceOdslStatementParameters(n,a):n;s&&i.push(s)}return{odsl:{statements:i}}}replaceOdslStatementParameters(e,t){const n=[];return t.forEach((e=>{n.push({key:e.name,value:this.destringifyArgumentValue(e)})})),{name:e.name,returns:e.returns,arguments:this.convertArgsArrayToOdslArguments(n),dismissedArguments:e.dismissedArguments,argumentsArray:n}}convertArgsArrayToOdslArguments(e){const t={};return e.forEach((e=>{t[e.key]=e.value})),t}generateInitialCardInput(){var e,t;const n=[];return null===(t=null===(e=this.odslResponse.odsl)||void 0===e?void 0:e.statements)||void 0===t||t.forEach((e=>{var t;const r=this.getExpressionByName(e.name);if(!r)return;const o=[];null===(t=e.argumentsArray)||void 0===t||t.forEach((e=>{const t=this.stringifyArgumentValue(e.value),n={name:e.key,value:t,type:e.value.type,enumOptions:this.getEnumOptions(e.value,r)};o.push(n)})),n.push({title:r.name,description:r.description,taskProperties:o})})),n}getExpressionByName(e){return this.validOdslExpression.find((t=>{var n;return t.name===e||(null===(n=t.alternateNames)||void 0===n?void 0:n.includes(e))}))}getEnumOptions(e,t){var n,r;return null===(r=null===(n=t.args.find((t=>t.name===e.name)))||void 0===n?void 0:n.validationArgs)||void 0===r?void 0:r.enumValues}stringifyArgumentValue(e){var t,n;try{switch(e.type){case"string":case"color":case"formattedString":return e.string?e.string:"";case"regex":return e.regex?e.regex:"";case"var":case"scope":case"enum":return e.name?e.name:"";case"boolean":return e.boolean?"true":"false";case"number":return e.number?e.number.toString():"";case"jsonGrid":return e.json?e.json:"";case"stringList":return(null===(t=e.stringList)||void 0===t?void 0:t.join(", "))||"";case"numberList":return(null===(n=e.numberList)||void 0===n?void 0:n.join(", "))||"";default:return"Unsupported argument value type."}}catch(t){return"Failed to stringify argument value of type "+e.type}}destringifyArgumentValue(e){const t={type:e.type};try{switch(e.type){case"string":case"color":case"formattedString":t.string=e.value;break;case"regex":t.regex=e.value;break;case"var":case"scope":case"enum":t.name=e.value;break;case"boolean":t.boolean="true"===e.value.toLowerCase();break;case"number":t.number=parseInt(e.value);break;case"jsonGrid":t.json=e.value;break;case"stringList":t.stringList=e.value.split(", ");break;case"numberList":t.numberList=e.value.split(", ").map((e=>parseInt(e)));break;default:t.string="Unsupported argument value type."}}catch(e){return{type:"string",string:"Failed to destringify argument value"}}return t}}var T=n(10229),w=n(77383),I=n(96944),P=n(27465),_=n(61542),A=n(73606),k=n(14213),x=n(17235),N=n(8349),O=n(61339),D=n(72218),L=n(81789),R=n(44121),F=n(9669),M=n(74930),B=n(18384),U=n(26940),z=n(66888),H=n(44632),G=n(12542),V=n(12063),j=n(70941),q=n(20570),W=n(11912),Y=n(91165),Q=n(7182),J=n(99243),X=n(19640),K=n(27409),Z=n(32854),$=n(29336),ee=H.B.getInstance();function te(e){return!!(0,p.bw)(p.WT.IsSelfHelpSearchRenderingEnabled)&&("bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===f.wz.SELF_HELP_SEARCH)}function ne(e,t){var n=e.adaptiveCards&&e.adaptiveCards.length>0,r=[],o="";$.r.getInstance().setSkillName(f.B2.SelfHelp);var i={featureName:G.CC.CopilotChat,subFeatureName:G.Ff.SelfHelpSearch},a=(0,D.Vgn)();if(n&&e.hiddenText===D.xZn.QuickAnswer){o=D.xZn.QuickAnswer;var s=e.adaptiveCards[0],c=re(s,a,e.messageId,i);r.push(c)}else if(n&&e.hiddenText===D.xZn.HelpArticle)if(o=D.xZn.HelpArticle,1===e.adaptiveCards.length){var u=e.adaptiveCards[0],d=re(u,a,e.messageId,i);r.push(d)}else{var p,h={chatCardType:S._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,D.sj0)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:T.O.None,isFailure:!1,messageId:e.messageId,telemetryData:(0,Z.YI)(R.SD.ChatQnA)},addCardToChatHistory:!0},g=e.adaptiveCards.map((function(t){return re(t,a,e.messageId,i)}));(p=r).push.apply(p,[h].concat((0,l._)(g)))}else{o="N/A";var m={chatCardType:S._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,D.ZAw)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:T.O.None,isFailure:!0,messageId:e.messageId,telemetryData:(0,Z.YI)(R.SD.ChatQnA),feedbackData:(0,Z.as)(f.Xw.SELFHELPSEARCH,i)},addCardToChatHistory:!0};r.push(m)}oe(o);var y=!0,v=!1,C=void 0;try{for(var b,E=r[Symbol.iterator]();!(y=(b=E.next()).done);y=!0){var w,I=b.value;null===(w=t.current)||void 0===w||w.addResponseMessage(I)}}catch(e){v=!0,C=e}finally{try{y||null==E.return||E.return()}finally{if(v)throw C}}}var re=function(e,t,n,r){var i;return{chatCardType:S._.SelfHelpAdaptiveCard,chatMessageData:{selfHelpAdaptiveCardProps:{user:"chat",headerText:t,sourceLabel:{iconName:"unknown",text:(0,D.Y1T)()},cardData:e,customActions:(i={},(0,o._)(i,ae.JsonTypeName,ae),(0,o._)(i,le.JsonTypeName,le),(0,o._)(i,ce.JsonTypeName,ce),(0,o._)(i,se.JsonTypeName,se),i)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:T.O.Footer,feedbackData:(0,Z.as)(f.Xw.SELFHELPSEARCH,r),isFailure:!1,messageId:n,telemetryData:(0,Z.YI)(R.SD.ChatQnA)},addCardToChatHistory:!0}},oe=function(e){var t;ee.sendChatEventTelemetry((0,B.pN)((t={},(0,o._)(t,G.h3.ChatEventType,G.a5.SelfHelpContentShown),(0,o._)(t,G.h3.ChatEventParameters,JSON.stringify({ContentType:e})),t))),ee.logTriedEvent(R.SD.ChatQnA,G.Ff.SelfHelpSearch,m.RX.Ask)},ie=function(e,t){var n,r=ee.getQueryGuid();if(t){var i=(0,Z.zq)(t),a=i.correlationId;i.featureName;void 0!==a&&ee.setQueryGuid(a)}ee.sendChatEventTelemetry((0,B.pN)((n={},(0,o._)(n,G.h3.ChatEventType,G.a5.SelfHelpActionClicked),(0,o._)(n,G.h3.ChatEventParameters,JSON.stringify({ActionType:e})),n))),ee.logKeptEvent(R.SD.ChatQnA,G.Ff.SelfHelpSearch,m.RX.Ask),t&&ee.setQueryGuid(r)},ae=function(e){(0,Q._)(n,e);var t=(0,J._)(n);function n(){var e;return(0,W._)(this,n),e=t.apply(this,arguments),(0,o._)((0,q._)(e),"tcid",void 0),e}return(0,Y._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){ie("ExecuteTCID",e),this.tcid&&Office.context.ui.executeFeature(this.tcid)}}]),n}(X.Y);(0,o._)(ae,"JsonTypeName","SelfHelpAction.ExecuteTCID"),(0,o._)(ae,"tcidProperty",new K.NumProperty(K.Versions.v1_0,"tcid")),(0,c.__decorate)([K.property(ae.tcidProperty)],ae.prototype,"tcid",void 0);var se=function(e){(0,Q._)(n,e);var t=(0,J._)(n);function n(){var e;return(0,W._)(this,n),e=t.apply(this,arguments),(0,o._)((0,q._)(e),"tabId",void 0),(0,o._)((0,q._)(e),"anchorId",void 0),(0,o._)((0,q._)(e),"calloutTitle",void 0),(0,o._)((0,q._)(e),"calloutText",void 0),(0,o._)((0,q._)(e),"delay",void 0),e}return(0,Y._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){ie("ShowTeachingCallout",e),this.tabId&&this.anchorId&&this.calloutTitle&&this.calloutText&&OfficeFirstParty.Notification.addNotification(OfficeFirstParty.Notification.callout({target:this.tabId,title:this.calloutTitle,content:this.calloutText,useTeachingStyles:!0}),{navigationalOptions:{controlToFind:this.anchorId}})}}]),n}(X.Y);(0,o._)(se,"JsonTypeName","SelfHelpAction.ShowTeachingCallout"),(0,o._)(se,"tabIdProperty",new K.NumProperty(K.Versions.v1_0,"tabId")),(0,o._)(se,"anchorIdProperty",new K.NumProperty(K.Versions.v1_0,"anchorId")),(0,o._)(se,"calloutTitleProperty",new K.StringProperty(K.Versions.v1_0,"calloutTitle")),(0,o._)(se,"calloutTextProperty",new K.StringProperty(K.Versions.v1_0,"calloutText")),(0,o._)(se,"delayProperty",new K.NumProperty(K.Versions.v1_0,"delay")),(0,c.__decorate)([K.property(se.tabIdProperty)],se.prototype,"tabId",void 0),(0,c.__decorate)([K.property(se.anchorIdProperty)],se.prototype,"anchorId",void 0),(0,c.__decorate)([K.property(se.calloutTitleProperty)],se.prototype,"calloutTitle",void 0),(0,c.__decorate)([K.property(se.calloutTextProperty)],se.prototype,"calloutText",void 0),(0,c.__decorate)([K.property(se.delayProperty)],se.prototype,"delay",void 0);var le=function(e){(0,Q._)(n,e);var t=(0,J._)(n);function n(){var e;return(0,W._)(this,n),e=t.apply(this,arguments),(0,o._)((0,q._)(e),"url",void 0),e}return(0,Y._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){var t;(ie("OpenUrl",e),this.url)&&(null===(t=window)||void 0===t||t.open(this.url))}}]),n}(X.Y);(0,o._)(le,"JsonTypeName","SelfHelpAction.OpenUrl"),(0,o._)(le,"urlProperty",new K.StringProperty(K.Versions.v1_0,"url")),(0,c.__decorate)([K.property(le.urlProperty)],le.prototype,"url",void 0);var ce=function(e){(0,Q._)(n,e);var t=(0,J._)(n);function n(){var e;return(0,W._)(this,n),e=t.apply(this,arguments),(0,o._)((0,q._)(e),"articleId",void 0),e}return(0,Y._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){ie("ShowHelpPane",e),this.articleId&&OfficeFirstParty.Copilot.launchHelpPaneByArticleIdString(this.articleId)}}]),n}(X.Y);(0,o._)(ce,"JsonTypeName","SelfHelpAction.ShowHelpPane"),(0,o._)(ce,"articleIdProperty",new K.StringProperty(K.Versions.v1_0,"articleId")),(0,c.__decorate)([K.property(ce.articleIdProperty)],ce.prototype,"articleId",void 0);var ue=n(65905),de=n(18758),pe=n(30325),fe=n(24464),he=n(57308),ge=n(32217),me=n(44001),ye=n(52318),ve=n(29862),Se=n(48694),Ce=n(39041),be=n(1543),Ee=n(5851),Te=n(4809),we=n(89375),Ie=n(23343),Pe=n(21659),_e=n(60801),Ae=n(82808),ke=n(72468),xe=n(85612),Ne=n(8520),Oe=function(e,t,n){var i,a=!1,s=-1,l=void 0;try{var u,d=null===(u=e.children)||void 0===u?void 0:u[0];s=Number(d),a=Number.isInteger(s)&&s>0}catch(e){var h;return t.sendErrorTelemetry((0,B.pN)((h={},(0,o._)(h,G.IC.ErrorMessage,D.s81),(0,o._)(h,G.IC.ErrorCategory,G.S2.ClickableKeySlides),(0,o._)(h,G.CT.ErrorType,f.T_.Client),h))),Ne.createElement(Ne.Fragment,null)}if(a&&s>=0){if((0,p.bw)(p.WT.IsClickableCopilotKeySlidesEnabled)){if((0,p.PA)(p.IY.IsClickableCopilotKeySlidesDependentOnSlideIds))try{l=function(e,t){if(void 0===t)throw new Error("Hidden text not found");if(0===t.length)throw new Error("Hidden text is empty");var n=JSON.parse(t).find((function(t){return(null==t?void 0:t.slideNumber)===e}));if(void 0===(null==n?void 0:n.mappedId))throw new Error("Key slide id not found");var r=(0,fe.Qs)(n.mappedId);if(!r||2!==r.length)throw new Error("Key slide id is not in the correct format");if(r[0]<0||r[1]<0)throw new Error("Slide Ids not valid");return n.mappedId}(s,n)}catch(e){var g;t.sendErrorTelemetry((0,B.pN)((g={},(0,o._)(g,G.IC.ErrorMessage,D.cvN),(0,o._)(g,G.IC.ErrorCategory,G.S2.ClickableKeySlides),(0,o._)(g,G.CT.ErrorType,f.T_.Client),g)))}var m=(i=(0,r._)((function(e){var n,i,a,s,l,u=arguments;return(0,c.__generator)(this,(function(d){switch(d.label){case 0:n=u.length>1&&void 0!==u[1]?u[1]:void 0;try{t.sendChatEventTelemetry((0,B.pN)((i={},(0,o._)(i,G.h3.ChatEventType,G.a5.ClickableKeySlidesClicked),(0,o._)(i,G.h3.ChatEventParameters,JSON.stringify({isClickableKeySlidesEnabled:(0,p.bw)(p.WT.IsClickableCopilotKeySlidesEnabled),isClickableCopilotKeySlidesDependentOnSlideIds:(0,p.PA)(p.IY.IsClickableCopilotKeySlidesDependentOnSlideIds)})),i)))}catch(e){t.sendErrorTelemetry((0,B.pN)((a={},(0,o._)(a,G.IC.ErrorMessage,D.ysX),(0,o._)(a,G.IC.ErrorCategory,G.S2.ClickableKeySlides),(0,o._)(a,G.CT.ErrorType,f.T_.Client),a)))}s=e-1,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){var t,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return(0,p.PA)(p.IY.IsClickableCopilotKeySlidesDependentOnSlideIds)?(n&&e.presentation.setSelectedSlides([n]),[4,e.sync()]):[3,2];case 1:return o.sent(),[3,5];case 2:return(t=e.presentation.slides).load("items, items/id"),[4,e.sync()];case 3:return o.sent(),s>=0&&s<t.items.length?(void 0!==(r=t.items[s].id)&&e.presentation.setSelectedSlides([r]),[4,e.sync()]):[3,5];case 4:o.sent(),o.label=5;case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return d.sent(),[3,4];case 3:return d.sent(),t.sendErrorTelemetry((0,B.pN)((l={},(0,o._)(l,G.IC.ErrorMessage,D.avp),(0,o._)(l,G.IC.ErrorCategory,G.S2.ClickableKeySlides),(0,o._)(l,G.CT.ErrorType,f.T_.Server),l))),[3,4];case 4:return[2,Promise.resolve()]}}))})),function(e){return i.apply(this,arguments)});return Ne.createElement("div",{style:{display:"contents",cursor:"pointer"},onClick:function(){return m(s,l)},role:"button",onKeyDown:function(e){"Enter"===e.key&&m(s,l)},tabIndex:0},Ne.createElement("u",null,(0,D.Puy)(s)))}return Ne.createElement("div",{style:{display:"contents"}},(0,D.Puy)(s))}return Ne.createElement(Ne.Fragment,null)},De=n(65817),Le=n(13403),Re=n(1335),Fe=n(50502),Me=n(23905),Be=H.B.getInstance();var Ue,ze,He,Ge,Ve=n(46657),je=n(64090),qe=n(98483),We=n(47350),Ye=function(){function e(t){(0,W._)(this,e),(0,o._)(this,"copilotChatRef",void 0),this.copilotChatRef=t}return(0,Y._)(e,[{key:"addPlanBuilderResponseMessage",value:function(e,t){var n,r;null===(r=this.copilotChatRef)||void 0===r||null===(n=r.current)||void 0===n||n.addResponseMessage({stopLoadingUi:!0,chatCardType:S._.PlanBuilderCard,chatMessageData:{planBuilderCardProps:{user:v.Q9.Chat,chatMessage:"",tasks:e,handleStartClicked:t}}})}}]),e}(),Qe=n(78289),Je=new d.Basin,Xe=!0,Ke=D.u1i,Ze=D.u1i,$e=!1,et=!0,tt=!0,nt=!0,rt=new Map,ot=H.B.getInstance(),it=k.K.getInstance(),at=!1,st=!1,lt=!1,ct=!1,ut=[],dt=O.R.getInstance(),pt=[],ft=[],ht=[],gt=[],mt=[],yt=[],vt={},St="",Ct=x.N.Unknown,bt=!1,Et=!1,Tt=0,wt=!1,It=void 0,Pt=void 0,_t=!1,At=!1,kt=(Ge=(0,r._)((function(e,t,n,s,d,y,v,S,C,b,T){var I,P,_,A,k,N,O,M,U,z,H,q,W,Y,Q,J,X,K,Z,$,ee,te,ne,re,oe,ie,ae,se,le,ce,pe,fe,ge,me,ve,Se,be,Ee,Te,we,Ie,Pe,Ae,xe,Ne,Oe,De,Le,Re,Me,Be,Ge,Ve,je,qe,We,Qe,Je,Ke,Ze,$e,et,tt,rt,at,ct,ut,pt,ft,mt,yt,St,It=arguments;return(0,c.__generator)(this,(function(Pt){switch(Pt.label){case 0:return I=It.length>11&&void 0!==It[11]&&It[11],P=It.length>12?It[12]:void 0,_=It.length>13&&void 0!==It[13]?It[13]:0,A=It.length>14?It[14]:void 0,k=It.length>15?It[15]:void 0,N=It.length>16?It[16]:void 0,O=0===y?g.qD:y,(M=null==e?void 0:e.body)?((0,p.bw)(p.WT.IsMarkdownSummarizationEnabled)&&!(0,Ce.hX)(M.comprehensionSummaryConfig)&&(z=null!==(U=M.comprehensionSummaryConfig)&&void 0!==U?U:{intent:x.N.Unknown,isVisual:!1,cache:!1},Ct=null!==(q=x.N[null!==(H=z.intent)&&void 0!==H?H:"Unknown"])&&void 0!==q?q:x.N.Unknown,Et=null!==(W=z.isVisual)&&void 0!==W&&W,wt=null!==(Y=z.analyzingVisuals)&&void 0!==Y&&Y,bt=null!==(Q=z.cache)&&void 0!==Q&&Q,Tt=null!==(J=z.usedVDPercentage)&&void 0!==J?J:0,(0,de.cY)("Summary Intent: ".concat(Ct,", isVisualSummary: ").concat(Et,", summaryFromCache: ").concat(bt,", analyzingVisuals: ").concat(wt,", usedVDPercentage: ").concat(Tt))),X="Unknown",K=void 0,Z=!1,$=!1,ee=!1,(te=(0,p.bw)(p.WT.SpeakerNotesEnabled))&&!(0,Ce.hX)(M.speakerNotesConfig)&&(ne=M.speakerNotesConfig,X=null!==(re=ne.intent)&&void 0!==re?re:"Unknown",K=ne.jsonCmdPayload,Z=null!==(oe=ne.analyzingVisuals)&&void 0!==oe&&oe,$=null!==(ie=ne.isVisual)&&void 0!==ie&&ie,ee=null!==(ae=ne.partialVDsAvailable)&&void 0!==ae&&ae,(0,de.cY)("Speaker Notes Intent: ".concat(X,", isAnalyzingVisualSpeakerNotes: ").concat(Z,", isVisualSpeakerNotes: ").concat($,", isPartialSpeakerNotesVDs: ").concat(ee))),le=null!==(se=M.requiredActionParameters)&&void 0!==se?se:[],(0,p.bw)(p.WT.IsPersonalizationUXEnabled)&&(0,p.bw)(p.WT.IsPersonalizationConfirmationResponseEnabled)&&(0,h.vqz)(le,t),(ce=M.queryId)&&ot.setQueryGuid(ce),L.R.getInstance().setState(f.Nj.EXECUTING),pe=[{key:G.h3.ChatEventType,value:G.a5.ResponseReceivedFromAL},{key:G.h3.ChatEventParameters,value:F.c.getTypeName()},{key:G.h3.Cv,value:null!=P?P:""}],ot.sendChatEventTelemetry(pe),nt&&(fe=[{key:G.CT.FirstServiceResponse,value:(0,g.WU)(O)},{key:G.CT.AnnotationType,value:F.c.getTypeName()},{key:G.CT.IsFluxUsed,value:!(0,Ce.hX)(M.sydneyEndpoint)}],ge=[{key:G.h3.ChatEventType,value:G.a5.FirstResponseReceivedFromAL},{key:G.h3.ChatEventParameters,value:F.c.getTypeName()}],ot.sendLatencyTelemetry(fe),ot.sendChatEventTelemetry(ge),Ue=null!==(me=M.conversationId)&&void 0!==me?me:"",ze=null!==(ve=M.sydneyEndpoint)&&void 0!==ve?ve:"",nt=!1),!(0,p.bw)(p.WT.EnableCopilotTranslatePresentation)||!(0,he.zd)(M)&&(0,Ce.hX)(M.translatePresentationConfig)?[3,1]:((0,Ce.hX)(M.translatePresentationConfig)?null===(Ae=t.current)||void 0===Ae||Ae.addResponseMessage((0,Fe.Rb)()):(Se=M.translatePresentationConfig,Ee=null!==(be=Se.intent)&&void 0!==be?be:"Unknown",we=null!==(Te=Se.targetLanguages)&&void 0!==Te?Te:[D.u1i],Ee===D.bwY&&(ot.sendChatEventTelemetry((0,B.pN)((Pe={},(0,o._)(Pe,G.h3.ChatEventType,G.a5.TranslatePresentationIntentDetectedFromAL),(0,o._)(Pe,G.h3.ChatEventParameters,we.join(",")),Pe))),null===(Ie=t.current)||void 0===Ie||Ie.addResponseMessage((0,Fe.Rb)(we[0])))),[3,11])):((0,de.cY)("Empty body in flux response. Returning"),ot.sendErrorTelemetry([{key:G.IC.ErrorCategory,value:G.S2.FluxCopilot},{key:G.IC.ErrorMessage,value:"Empty body in PPT Copilot annotation received"}]),L.R.getInstance().setState(f.Nj.IDLE),[2]);case 1:return M.chatResponse?(xe=(0,p.bw)(p.WT.IsMarkdownSummarizationEnabled)&&void 0!==(0,he.r_)(M),(0,de.cY)("MarkDown Summary FG Enabled : ".concat((0,p.bw)(p.WT.IsMarkdownSummarizationEnabled),", isSkillResponse : ").concat(xe)),Ne=te&&void 0!==(0,he._5)(M),(0,de.cY)("Speaker Notes FG Enabled : ".concat(te,", isSpeakerNotesResponse : ").concat(Ne)),(0,p.PA)(p.IY.LogSpeakerNotesResponse)&&!(0,Ce.hX)(M.speakerNotesConfig)&&ot.sendChatEventTelemetry((0,B.pN)((Oe={},(0,o._)(Oe,G.h3.ChatEventType,G.a5.SpeakerNotesResponseDetectedFromAL),(0,o._)(Oe,G.h3.ChatEventParameters,JSON.stringify({isSpeakerNotesEnabled:te,isSpeakerNotesResponse:Ne})),Oe))),(0,p.PA)(p.IY.IgnoreExtraResponseForSpeakerNotes)&&!xe&&!Ne&&At?((0,de.cY)("Ignore the response as we are currently handling speaker notes"),ot.sendChatEventTelemetry((0,B.pN)((De={},(0,o._)(De,G.h3.ChatEventType,G.a5.SpeakerNotesIgnoreExtraResponse),(0,o._)(De,G.h3.ChatEventParameters,At),De))),[2]):(fn(xe,M.chatResponse.status),Ne?[4,Vt(M,X,K,Z,$,ee,t,!0,n,b)]:[3,3])):[3,6];case 2:return Pt.sent()&&((0,de.cY)("Stop Loading UI for Speaker Notes Response"),u.G.getInstance().removeContextId(null==M?void 0:M.queryId),tn(),L.R.getInstance().setState(f.Nj.IDLE),it.resetData()),[2];case 3:return(null==M?void 0:M.conversationId)&&ot.setConversationId(null==M?void 0:M.conversationId),0!==M.chatResponse.status?[3,5]:(0,h.BIF)(M.chatResponse,t,(0,p.PA)(p.IY.ShouldPassAllInterstitialMessages))?(Le=(0,h.xRn)(M.chatResponse),Re=JSON.stringify({interstitialMessageType:Le}),(0,de.cY)("Extensibility handled interstitial message: ".concat(Re)),ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.InterstitialMessageShown},{key:G.h3.ChatEventParameters,value:Re}]),tn(),[2]):(Me=void 0,(0,p.PA)(p.IY.ShouldShowVideoNotSupportedMessage)&&(null===(Be=M.chatResponse.messages)||void 0===Be?void 0:Be.find((function(e){return(0,h.j92)(e)})))&&(Me=(0,D.pHk)()),(0,p.PA)(p.IY.IsGenerateContentForDesignerEnabled)&&(Ve=null===(Ge=M.chatResponse.messages)||void 0===Ge?void 0:Ge.find((function(e){return(0,h.JI8)(e)})),(0,Ce.hX)(Ve)||(0,j.dG)(Ve,t)),xe?(ot.sendChatEventTelemetry((0,B.pN)((Ze={},(0,o._)(Ze,G.h3.ChatEventType,G.a5.SummaryIntentDetectedFromAL),(0,o._)(Ze,G.h3.ChatEventParameters,Ct),(0,o._)(Ze,G.h3.IsFromCache,bt),(0,o._)(Ze,G.h3.IsVisual,Et),(0,o._)(Ze,G.h3.IsAnalyzingVisual,wt),(0,o._)(Ze,G.h3.UsedVDPercentage,Tt),Ze))),ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.IsFromCache,bt)))):((0,de.cY)("PowerPoint Flux Copilot streaming ended."),(0,p.bw)(p.WT.IsDebugSectionV2Enabled)&&nn(M,g.qD),(null==M?void 0:M.conversationId)&&S(null==M?void 0:M.conversationId),qe=null==M||null===(je=M.chatResponse)||void 0===je?void 0:je.telemetry,ce&&qe&&qe.metrics&&(Ke=null!==(Je=null==M||null===(Qe=M.chatResponse)||void 0===Qe?void 0:Qe.messages)&&void 0!==Je?Je:[],(We=gt).push.apply(We,(0,l._)(Ke)),C(ce,qe))),[4,qt(M,t,d,xe,T,k,A,N,Me)]);case 4:return Pt.sent(),[2];case 5:return function(e,t,n,r,o,i){Yt.apply(this,arguments)}(M,t,I,xe,_,T),[3,11];case 6:return M.odslResponse?(fn(!1),(0,B.$j)(ot,F.c.getTypeName(),null!=O?O:0,G.CT.CopilotODSLResponseTime,G.CC.Commanding),st=!0,ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.ODSLResponseReceivedFromSydney},{key:G.h3.ChatEventParameters,value:F.c.getTypeName()}]),(0,p.PA)(p.IY.IsClpEnabledInEnterpriseForSydney)&&(lt=e.body.odslResponse.odslAction===w.b.Insertion),He=null!==(et=null===($e=M.odslResponse.odsl)||void 0===$e?void 0:$e.responseRequired)&&void 0!==et&&et,(tt=M.odslResponse.images)&&tt.length>0&&M.odslResponse.imageBaseUrl&&(ot.logTriedEvent(R.SD.AddContent,G.Ff.AddImage,m.RX.Create),tt.forEach((function(e){var t;V.U.addImage({url:(null===(t=M.odslResponse)||void 0===t?void 0:t.imageBaseUrl)+e.imageId,description:e.description,altText:e.altText,license:e.license,companyName:e.companyName})}))),(0,p.bw)(p.WT.IsPlanBuilderEnabled)?(rt={odslResponse:M.odslResponse,planExecutor:function(){var e=(0,r._)((function(e){var r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r=M.odslResponse,[4,(0,ye.mk)((0,a._)((0,i._)({},r,e),{queryId:ce}),t,n,s,v,b,M.odslResponse.groundingInfo,M.odslResponse.chatConversations,M.odslResponseExtension)];case 1:return o.sent(),L.R.getInstance().setState(f.Nj.WAITING_FOR_COPILOT_WF_RESPONSE),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),copilotChatRef:new Ye(t)},new E(rt).generateCard(),[3,9]):[3,7]):[3,10];case 7:return[4,(0,ye.mk)((0,a._)((0,i._)({},M.odslResponse),{queryId:ce}),t,n,s,v,b,M.odslResponse.groundingInfo,M.odslResponse.chatConversations,M.odslResponseExtension)];case 8:Pt.sent(),Pt.label=9;case 9:return Xe=(0,p.bw)(p.WT.IsSuggestionsForCommandingEnabled),L.R.getInstance().setState(f.Nj.WAITING_FOR_COPILOT_WF_RESPONSE),[3,11];case 10:M.error?((0,p.bw)(p.WT.IsDebugSectionV2Enabled)&&(nn(M,g.qD,void 0,!0),at=(0,i._)({},vt),ht.push(at),N()),ct=!1,(0,p.bw)(p.WT.IsMarkdownSummarizationEnabled)&&M.comprehensionSummaryConfig&&(ct=!0),ut=!1,te&&M.speakerNotesConfig&&(ut=!0),(0,de.cY)("PPT Flux copilot Error:\n".concat(M.error.message," Error category : ").concat(M.error.category,", From Summary Skill: ").concat(ct,", From Speaker Notes: ").concat(ut)),fn(ct),pt=!Kt(),ft=!ct||ct&&pt,ct?((0,p.bw)(p.WT.IsNotificationEnabledForSummary)&&(0,ke.Hv)(it.getUserQueryGuid()),function(e,t,n){xt.apply(this,arguments)}(M.error,t,ft)):ut?((0,de.cY)("Error response came from Speaker Notes workflow"),ot.sendErrorTelemetry((0,B.pN)((mt={},(0,o._)(mt,G.IC.ErrorMessage,"Error response came from Speaker Notes workflow"),(0,o._)(mt,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(mt,G.CT.ErrorType,f.T_.Server),mt))),ot.sendChatEventTelemetry((0,B.pN)((yt={},(0,o._)(yt,G.h3.ChatEventType,G.a5.SpeakerNotesErrorDetectedFromAL),(0,o._)(yt,G.h3.ChatEventParameters,JSON.stringify({speakerNotesIntent:X,isVisualSpeakerNotes:$,isPartialSpeakerNotesVDs:ee,speakerNotesError:JSON.stringify(M.error)})),yt))),function(e,t,n){Nt.apply(this,arguments)}(M.error,t,!0)):(ot.sendLatencyTelemetry((0,B.pN)((St={},(0,o._)(St,G.CT.FeatureName,G.CC.CopilotChat),(0,o._)(St,G.CT.SydneyResponseTime,(0,g.WU)(g.qD)),St))),dt.getIsWarningMessageActive()&&(0,_e.A)(t),(0,ue.c)(M.error,t,s,!0,M.outputAnswerLanguage,k,A)),ft&&(u.G.getInstance().removeContextId(null==M?void 0:M.queryId),tn(),L.R.getInstance().setState(f.Nj.IDLE))):(fn(p.WT.IsMarkdownSummarizationEnabled&&void 0!==M.comprehensionSummaryConfig),(0,de.cY)("ChatResponse, odslResponse, and error not present in PPT Copilot annotation received"),ot.sendErrorTelemetry([{key:G.IC.ErrorCategory,value:G.S2.FluxCopilot},{key:G.IC.ErrorMessage,value:"ChatResponse, odslResponse, and error not present in PPT Copilot annotation received"}]),tn(),L.R.getInstance().setState(f.Nj.IDLE),u.G.getInstance().removeContextId(null==M?void 0:M.queryId)),Pt.label=11;case 11:return[2]}}))})),function(e,t,n,r,o,i,a,s,l,c,u){return Ge.apply(this,arguments)});function xt(){return(xt=(0,r._)((function(e,t,n){var r,o,i;return(0,c.__generator)(this,(function(a){return r=(0,we.z)(e,Ct,t,n),o=r.errorCode,i=r.errorKey,(0,B.Lu)(ot,g.qD,G.CT.SummaryResponseTime,G.CT.SummaryChunkInfo,ut,G.S2.Summary,"".concat(F.c.getTypeName(),"_Error"),e.category.concat((0,Ce.jw)(o)?D.u1i:"_".concat(o)),f.T_.Server,n,void 0,void 0,i),it.setResponseTime((0,g.WU)(g.qD)),(0,Ie.k)(!1,"PowerPointCopilotWorkflow_".concat(e.category),R.Cu.Summary),[2]}))}))).apply(this,arguments)}function Nt(){return Nt=(0,r._)((function(e,t,n){var r,i,a;return(0,c.__generator)(this,(function(s){return r=function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=R.SD.SpeakerNotes,s=G.Ff.SpeakerNotes,l=e.category,c=D.u1i;try{c=JSON.parse(e.json).code}catch(e){var u;return(0,de.cY)("Error parsing error code from speaker notes error",e.message),(0,fe.r5)(t,PowerpointCopilotStrings.ErrorRequestTimedOut,a,s,i),Be.sendErrorTelemetry((0,Me.pN)((u={},(0,o._)(u,G.IC.ErrorMessage,"Error parsing error code from speaker notes error, ".concat(e.message)),(0,o._)(u,G.IC.ErrorCategory,G.S2.SpeakerNotes),u))),{errorCode:c,errorKey:G.Nr.ErrorRequestTimedOut}}(0,de.cY)("Speaker Notes Error Detected, Category: ".concat(l,", ErrorCode: ").concat(c,", ErrorMessage: ").concat(e.message)),Be.sendErrorTelemetry((0,Me.pN)((r={},(0,o._)(r,G.IC.ErrorMessage,"Speaker Notes Workflow Error Detected, Category: ".concat(l,", ErrorCode: ").concat(c)),(0,o._)(r,G.IC.ErrorCategory,G.S2.SpeakerNotes),r)));var d={errorType:"".concat(l,"-").concat(c),featureName:R.SD.SpeakerNotes,subFeatureName:G.Ff.SpeakerNotes};switch(l){case f.Z4.InvalidInputError:switch(c){case f.iE.TooShort:case f.iE.MissingPPTContent:d.errorMessage=PowerpointCopilotStrings.LessContentForSpeakerNotesError,n=G.Nr.LessContentForSpeakerNotesError;break;case f.iE.TooManySlides:d.errorMessage=PowerpointCopilotStrings.TooManySlidesSpeakerNotesError.replace("%s",D.F9A.toString()),n=G.Nr.TooManySlidesSpeakerNotesError;break;default:d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut}break;case f.Z4.OffensiveContent:d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut;break;case f.Z4.InferenceAPIError:switch(c){case f.iE.BadResponse:case f.iE.BadRequest:case f.iE.Token:case f.iE.Unknown:case f.iE.EmptyResponse:d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut;break;case f.iE.Timeout:case f.iE.NotAvailable:d.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,n=G.Nr.ErrorServerBusy;break;case f.iE.InputRAIDependency:case f.iE.OutputRAIDependency:d.errorMessage=PowerpointCopilotStrings.RAIBlockedSpeakerNotesError,n=G.Nr.RAIBlockedSpeakerNotesError;break;case f.iE.Throttled:case f.iE.UserThrottled:case f.iE.ScenarioThrottled:d.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,n=G.Nr.ThrottlingErrorMessage;break;default:d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut}break;case f.Z4.InvalidLanguageError:switch(c){case f.iE.NotSupported:d.errorMessage=PowerpointCopilotStrings.ErrorDetectedOtherLanguage,n=G.Nr.ErrorDetectedOtherLanguage;break;case f.iE.FailedToGetInputLanguage:default:d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut}break;case f.Z4.VisualDescriptionGeneration:switch(c){case f.iE.Unknown:case f.iE.FailedToGenerateVisualDescription:}d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut;break;case f.Z4.InputQueryError:c===f.iE.Bad_Token?(d.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,n=G.Nr.LicenseValidationErrorMessage):(d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut);break;case f.Z4.LicensingError:d.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,n=G.Nr.LicenseValidationErrorMessage;break;case f.Z4.PromptInjection:case f.Z4.InvalidSignalError:case f.Z4.InvalidIntentError:default:d.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,n=G.Nr.ErrorRequestTimedOut}return(0,fe.r5)(t,d.errorMessage,a,s,i,d),{errorCode:c,errorKey:n}}(e,t,n),i=r.errorCode,a=r.errorKey,Gt(e.category,n,f.T_.Server,i,a),[2]}))})),Nt.apply(this,arguments)}function Ot(){return(0,be.FG)(pe.BJ)&&$e&&He}function Dt(e,t,n){return Lt.apply(this,arguments)}function Lt(){return(Lt=(0,r._)((function(e,t,n){var r,o;return(0,c.__generator)(this,(function(i){return u.G.getInstance().isValidAnnotationResponse(e.queryId)?(o=new y.g0({parentPath:["Signal",I.GJ.getTypeName()],items:[{id:z.r.generateId(),body:e}]}),at=e.status===P.Aw.failed,null===(r=t.current)||void 0===r||r.submitOperation({operation:o,workflowAnnotationType:F.c.getTypeName()})):((0,de.cY)("ODSL Execution Timeout for PPT Flux Copilot workflow."),ot.sendChatEventTelemetry((0,l._)(n||[]).concat([{key:G.h3.ChatEventType,value:G.a5.ODSLExecutionTimeout},{key:G.h3.ChatEventParameters,value:F.c.getTypeName()},{key:G.h3.ChatErrorType,value:f.T_.Client}]))),[2]}))}))).apply(this,arguments)}function Rt(e){return Ft.apply(this,arguments)}function Ft(){return(Ft=(0,r._)((function(e){var t,n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return(0,p.n8)(pe.BJ)&&(0,p.PA)(p.IY.IsClpEnabledInEnterpriseForSydney)&&lt&&e===f.rI.SUCCESS?(null===(t=A.n.getInstance())||void 0===t?void 0:t.shouldShowInDocSensitivityLabel())?((0,de.cY)("Insertion scenario, updating document sensitivity"),[4,null===(r=A.n.getInstance())||void 0===r?void 0:r.upgradeSensitivityLabelUsingOfcJs(null===(n=A.n.getInstance())||void 0===n?void 0:n.getInDocSensitiveLabelInfo())]):[3,2]:[3,3];case 1:o.sent(),o.label=2;case 2:ct=(0,p.PA)(p.IY.ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion),o.label=3;case 3:return[2]}}))}))).apply(this,arguments)}function Mt(e){var t=e.adaptiveCards?e.adaptiveCards[0]:null,n="";if(t){var r=t.body,o=!0,i=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;"TextBlock"===c.type&&(n+=c.text)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}return n}function Bt(e,t){return Ut.apply(this,arguments)}function Ut(){return Ut=(0,r._)((function(e,t){var n,i,a,s,l,u;return(0,c.__generator)(this,(function(d){switch(d.label){case 0:if(!e||0===e.length)return[2,e];n=[],d.label=1;case 1:return d.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){var t;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.presentation.slides).load("id"),[4,e.sync()];case 1:return n.sent(),[2,t.items.map((function(e){return e.id.split("#")[0]}))]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return n=d.sent(),[3,4];case 3:return i=d.sent(),(0,de.cY)("Error fetching current slides:",i),ot.sendErrorTelemetry((0,B.pN)((a={},(0,o._)(a,G.IC.ErrorMessage,"Exception while fetching current slides, execution error:: "+i.message),(0,o._)(a,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(a,G.CT.ErrorType,f.T_.Client),a))),[2,e];case 4:return s=e.map((function(e){var t,n,r,o;return null===(o=e.data)||void 0===o||null===(r=o.target[0])||void 0===r||null===(n=r.notesId)||void 0===n||null===(t=n.id)||void 0===t?void 0:t.toString()})).filter((function(e){return!!e})),(l=s.filter((function(e){return!n.includes(e)}))).length>0&&ot.sendChatEventTelemetry((0,B.pN)((u={},(0,o._)(u,G.h3.ChatEventType,G.a5.JOfcSlidesNotInPresentation),(0,o._)(u,G.h3.ChatEventParameters,JSON.stringify({speakerNotesIntent:t,missingSlidesCount:l.length})),u))),[2,e.filter((function(e){var t,n,r,o,i=null===(o=e.data)||void 0===o||null===(r=o.target[0])||void 0===r||null===(n=r.notesId)||void 0===n||null===(t=n.id)||void 0===t?void 0:t.toString(),a=i&&l.includes(i);return(0,de.cY)("Processing slideId: ".concat(i,", isMissing: ").concat(a)),!a}))]}}))})),Ut.apply(this,arguments)}function zt(e,t,n,r,o,i,a,s,l,c,u){return Ht.apply(this,arguments)}function Ht(){return Ht=(0,r._)((function(e,t,n,s,l,u,d,h,m,y,S){var C,b,E,T,w,I,_,A,k,x,N,O,U,z,H,V,j,q,W,Y,Q,J,X,K;return(0,c.__generator)(this,(function(Z){switch(Z.label){case 0:return L.R.getInstance().getState()===f.Nj.IDLE?((0,de.cY)("handleJOfcSpeakerNotes:: ExecutionStateManager is in IDLE state. Returning"),[2]):(L.R.getInstance().setState(f.Nj.EXECUTING),C=null==e?void 0:e.queryId,b={status:f.rI.SUCCESS},E=[],void 0!==C&&(0,B.Zp)(C),T=ot.getQueryGuid(),$.r.getInstance().setSkillName(f.B2.SpeakerNotes),t?E=t.cmds:(0,de.cY)("handleJOfcSpeakerNotes:: Speaker Notes JOfc Command Payload is undefined"),ot.sendLatencyTelemetry((0,B.pN)((w={},(0,o._)(w,G.CT.SpeakerNotesResponseTime,(0,g.WU)(g.qD)),(0,o._)(w,G.CT.AnnotationType,F.c.getTypeName()),w))),I=(new Date).getTime(),(0,p.PA)(p.IY.ShouldValidateAllSlidesInNotesJofcResponseAreValid)?[4,Bt(E,n)]:[3,2]);case 1:E=Z.sent(),Z.label=2;case 2:if(ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.ValidateSlidesJOfcTime,(0,g.WU)(I)))),_=(new Date).getTime(),!(E.length>0))return[3,7];A={},k={scenarioName:it.getScenarioName(),startTime:it.getStartTime(),entryPoint:D.$kB.Chat,correlationId:T,conversationId:ot.getConversationId(),capability:it.getCapability(),featureName:it.getFeatureName(),subFeatureName:it.getSubFeatureName(),timeToODSLMS:-1,timeODSLToJOfcMS:-1,querySubmitTime:g.qD},A.scenarioOptions=JSON.stringify(k),(0,de.cY)("handleJOfcSpeakerNotes:: scenarioOptions : ",JSON.stringify(k)),Z.label=3;case 3:return Z.trys.push([3,5,,6]),m(!1),N=(0,fe.qi)(PowerpointCopilotStrings.SpeakerNotesAddingNotesMessage,{messageId:d},!1,f.Xw.CHATPPT,R.SD.SpeakerNotes,!1,!0,G.Ff.SpeakerNotes,y),O=null===(x=u.current)||void 0===x?void 0:x.getLastMessage(!1),(0,p.PA)(p.IY.IsVisualSpeakerNotesHandlingEnabled)&&O&&O.body.user===v.Q9.Chat?null===(U=u.current)||void 0===U||U.updateMessage(N):null===(z=u.current)||void 0===z||z.addResponseMessage(N),H={actionName:R.R4.ShowNotesPane,actionData:"",correlationId:k.correlationId},(0,de.cY)("handleJOfcSpeakerNotes:: Triggering Speaker Notes JOfc command execution via async Copilot Action API with view action to open notes pane"),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,De.Rf)(e,E,A,H)];case 1:return b=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 4:return Z.sent(),(0,de.cY)("handleJOfcSpeakerNotes:: log result : ",JSON.stringify(b)),[3,6];case 5:return V=Z.sent(),(0,de.cY)("handleJOfcSpeakerNotes:: Execution failed"+JSON.stringify(V)),b={status:f.rI.FAILED,error:f.Re.JOFC_EXCEPTION},[3,6];case 6:return[3,8];case 7:(0,Ie.k)(!1,"SpeakerNotesWorkflow_NoJOfcCmdsGenerated",it.getScenarioName()),b={status:f.rI.FAILED},Z.label=8;case 8:switch(ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.QueryExecutionTime,(0,g.WU)(_)))),j=new M.DA({status:P.Aw.failed,queryId:T,error:void 0}),b.status){case f.rI.BLOCKED:case f.rI.UNSUPPORTED:case f.rI.FAILED:case f.rI.UNEXPECTED_VERSION:case f.rI.USER_ABORTED:case f.rI.PARTIAL_SUCCESS:(0,de.cY)("handleJOfcSpeakerNotes:: JOfc Speaker Notes execution failed with result"+JSON.stringify(b)),(0,Le.af)(b,u,S,F.c.getTypeName(),j,h),ot.sendChatEventTelemetry((0,B.pN)((q={},(0,o._)(q,G.h3.ChatEventType,G.a5.SpeakerNotesJOfcCommandsError),(0,o._)(q,G.h3.ChatEventParameters,JSON.stringify({speakerNotesIntent:n,isVisualSpeakerNotes:s,isPartialSpeakerNotesVDs:l,speakerNotesJOfcResult:JSON.stringify(b)})),q))),ot.sendErrorTelemetry((0,B.pN)((W={},(0,o._)(W,G.IC.ErrorMessage,"Exception while executing Speaker Notes JOfc command, execution status:: "+b.status),(0,o._)(W,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(W,G.CT.ErrorType,f.T_.Client),W)));break;case f.rI.SUCCESS:j.status=P.Aw.success,Q=function(e,t){var n;n=e?t?PowerpointCopilotStrings.SpeakerNotesAllSlidesPartialVDsSuccess:PowerpointCopilotStrings.SpeakerNotesAllSlidesSuccess:PowerpointCopilotStrings.SpeakerNotesAllSlidesNoVDsSuccess;var r,i=e?PowerpointCopilotStrings.SpeakerNotesSingleSlideSuccess:PowerpointCopilotStrings.SpeakerNotesSingleSlideNoVDsSuccess;return r={},(0,o._)(r,Ve.d.AddSpeakerNotesToAllSlides,n),(0,o._)(r,Ve.d.AddSpeakerNotesToCurrentSlide,i),(0,o._)(r,Ve.d.AddSpeakerNotesToThisSlide,i),r}(s,l),J=Q[n],X=(0,a._)((0,i._)({},fe.tc),{messageId:d}),null===(Y=u.current)||void 0===Y||Y.updateMessage((0,fe.qi)(J,X,h,f.Xw.CHATPPT,R.SD.SpeakerNotes,!1,!0,G.Ff.SpeakerNotes,y)),ot.sendChatEventTelemetry((0,B.pN)((K={},(0,o._)(K,G.h3.ChatEventType,G.a5.SpeakerNotesQuerySuccess),(0,o._)(K,G.h3.ChatEventParameters,JSON.stringify({speakerNotesIntent:n,isVisualSpeakerNotes:s,isPartialSpeakerNotesVDs:l,speakerNotesJOfcResult:JSON.stringify(b)})),K))),(0,B.AQ)(ot,g.qD,void 0,void 0,void 0,void 0,h)}return[2]}}))})),Ht.apply(this,arguments)}function Gt(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:D.u1i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;ot.sendLatencyTelemetry((0,B.pN)((r={},(0,o._)(r,G.CT.FeatureName,R.SD.SpeakerNotes),(0,o._)(r,G.CT.SpeakerNotesResponseTime,(0,g.WU)(g.qD)),(0,o._)(r,G.CT.AnnotationType,F.c.getTypeName()),r))),(0,B.AQ)(ot,g.qD,G.a5.SpeakerNotesQueryFailure,e.concat((0,Ce.jw)(i)?D.u1i:"_".concat(i)),n,void 0,t,a),(0,Ie.k)(!1,"SpeakerNotesWorkflow_".concat(e),R.Cu.SpeakerNotes)}function Vt(e,t,n,r,o,i,a,s,l,c){return jt.apply(this,arguments)}function jt(){return(jt=(0,r._)((function(e,t,n,r,i,a,s,l,u,d){var h,m,y,v,S,C,b,E,T,w,I,P;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:if(At=!0,it.setScenarioName(R.Cu.SpeakerNotes),y={featureName:R.SD.SpeakerNotes,subFeatureName:G.Ff.SpeakerNotes},t===Ve.d.Unknown)return(0,de.cY)("Speaker Notes intent is unknown"),(0,fe.r5)(s,PowerpointCopilotStrings.ErrorRequestTimedOut,R.SD.SpeakerNotes,G.Ff.SpeakerNotes,l,y),Gt("IntentIsUnknown",l,f.T_.Server),ot.sendErrorTelemetry((0,B.pN)((v={},(0,o._)(v,G.IC.ErrorMessage,"Speaker Notes intent is unknown"),(0,o._)(v,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(v,G.CT.ErrorType,f.T_.Server),v))),[2,!0];if((0,de.cY)("Speaker Notes intent: ".concat(t)),(S=null==e||null===(m=e.chatResponse)||void 0===m||null===(h=m.messages[0])||void 0===h?void 0:h.messageId)||((0,de.cY)("Speaker Notes messageId is undefined"),ot.sendErrorTelemetry((0,B.pN)((C={},(0,o._)(C,G.IC.ErrorMessage,"Speaker Notes messageId is undefined"),(0,o._)(C,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(C,G.CT.ErrorType,f.T_.Server),C))),S=(0,qe.A)()),e.chatResponse.status!==Re.lC.Success)return[3,5];(0,de.cY)("Speaker Notes response received with success status"),ot.sendChatEventTelemetry((0,B.pN)((b={},(0,o._)(b,G.h3.ChatEventType,G.a5.SpeakerNotesSuccessResponseDetectedFromAL),(0,o._)(b,G.h3.ChatEventParameters,JSON.stringify({speakerNotesIntent:t,isVisualSpeakerNotes:i,isPartialSpeakerNotesVDs:a})),b))),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,zt(e,n,t,i,a,s,S,l,u,y,d)];case 2:return c.sent(),[3,4];case 3:return E=c.sent(),(0,de.cY)("Failed to handle Speaker Notes JOfc response: "+(null==E?void 0:E.message)),(0,fe.r5)(s,PowerpointCopilotStrings.ErrorRequestTimedOut,R.SD.SpeakerNotes,G.Ff.SpeakerNotes,l,y),Gt("FailureHandlingJOfcResponse",l,f.T_.Client),ot.sendErrorTelemetry((0,B.pN)((T={},(0,o._)(T,G.IC.ErrorMessage,"Exception while handling Speaker Notes JOfc response:: "+(null==E?void 0:E.message)),(0,o._)(T,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(T,G.CT.ErrorType,f.T_.Client),T))),[3,4];case 4:return[2,!0];case 5:return(0,p.PA)(p.IY.IsVisualSpeakerNotesHandlingEnabled)&&e.chatResponse.status===Re.lC.PartialResult&&r?((0,de.cY)("Analyzing visual descriptions, increase the timer to wait for visual speaker notes"),ot.sendChatEventTelemetry((0,B.pN)((I={},(0,o._)(I,G.h3.ChatEventType,G.a5.SpeakerNotesAnalyzingVisualsResponse),(0,o._)(I,G.h3.ChatEventParameters,JSON.stringify({speakerNotesIntent:t,isAnalyzingForVisualSpeakerNotes:r,isVisualSpeakerNotes:i,isPartialSpeakerNotesVDs:a})),I))),ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.SpeakerNotesAnalyzingVisualsResponseTime,(0,g.WU)(g.qD)))),null===(w=s.current)||void 0===w||w.addResponseMessage((0,fe.qi)(PowerpointCopilotStrings.SpeakerNotesAnalyzingVisualsMessage,{messageId:S},!1,f.Xw.CHATPPT,R.SD.SpeakerNotes,!0,!0,G.Ff.SpeakerNotes,y,je.m.getTypeName())),[2,!1]):((0,de.cY)("Not received Speaker Notes response with success status"),(0,fe.r5)(s,PowerpointCopilotStrings.ErrorRequestTimedOut,R.SD.SpeakerNotes,G.Ff.SpeakerNotes,l,y),Gt("ResponseNotSuccess",l,f.T_.Server),ot.sendErrorTelemetry((0,B.pN)((P={},(0,o._)(P,G.IC.ErrorMessage,"Received Speaker Notes response with status:: "+e.chatResponse.status),(0,o._)(P,G.IC.ErrorCategory,G.S2.SpeakerNotes),(0,o._)(P,G.CT.ErrorType,f.T_.Server),P))),[2,!0]);case 6:return[2]}}))}))).apply(this,arguments)}function qt(e,t,n,r,o,i,a,s,l){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,r._)((function(e,t,n,a,s,d,y,C,b){var E,T,w,I,P,_,k,x,O,D,M,z,H,V,q,W,Y,Q,J,X,K,ee,ne,re,oe,ie,ae,se,le,ce,pe,ge,me,ye,Ce,be,we,Ie,Pe,_e,Ne,Oe,De,Le,Re,Fe,Me,Be,He,Ge,Ve,je,qe,We,Ye,Je,Xe,Ze,$e,et,nt,rt,lt,ct,pt,ft,gt,mt,yt,St,bt,Tt,wt,It,Pt,kt,xt,Nt,Ot,Dt,Lt,Rt,Ft,Mt,Bt,Ut,zt,Ht,Gt,Vt,jt,qt,Wt,Yt,Xt,$t,en,rn,on,an,sn,ln;return(0,c.__generator)(this,(function(un){switch(un.label){case 0:(0,he.Lg)(e),I=!0,P=!1,_=void 0;try{for(k=ut[Symbol.iterator]();!(I=(x=k.next()).done);I=!0)O=x.value,Zt(F.c.getTypeName(),O.augloopResponseTime,!0,O.status)}catch(e){P=!0,_=e}finally{try{I||null==k.return||k.return()}finally{if(P)throw _}}return Zt(F.c.getTypeName(),(0,g.WU)(g.qD),!1,e.chatResponse.status),a||(null==Ue?void 0:Ue.length)||(Ue=e.conversationId),(null==ze?void 0:ze.length)||(ze=e.sydneyEndpoint),D=null===(E=e.chatResponse.messages)||void 0===E?void 0:E.find((function(e){return(0,j.Ep)(e)})),M=null===(T=e.chatResponse.messages)||void 0===T?void 0:T.find((function(e){return(0,he.Jw)(e)})),(0,p.PA)(p.IY.ShouldShowVideoNotSupportedMessage)&&b&&(M.text=b),z=(0,he.sw)(e),H=(null==M?void 0:M.contentOrigin)===f.wz.EDIT_DOCUMENT,V=(0,he._t)(e),(0,Te.MK)(M),(0,p.Dl)()&&!(0,p.PA)(p.IY.IsASHATelemetryToBeLoggedAtStreamEndOnce)&&it.getAshaErrorString()!=G.av.Unset&&(q=(0,Te.Uv)(it.getAshaVetoString(),it.getAshaErrorString()),ot.logAshaErrorEvent(q.vetoName,q.errorString,q.featureName)),ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.ContentOrigin,null!==(W=null==M?void 0:M.contentOrigin)&&void 0!==W?W:f.wz.UNKNOWN))),Y=$.r.getInstance().getSkillName(),vt.skill=Y,(0,p.bw)(p.WT.UseDisengagedMessageType)&&_t?((0,ue.c)(e.error,t,(0,r._)((function(){return(0,c.__generator)(this,(function(e){return[2]}))})),!0,e.outputAnswerLanguage,d,y,_t),u.G.getInstance().removeContextId(null==e?void 0:e.queryId),L.R.getInstance().setState(f.Nj.IDLE),tn(),[2]):((D||z||Y===f.B2.Designer||Y===f.B2.Summary||Y===f.B2.Sydney)&&(Q={},(0,o._)(Q,G.h3.ChatEventType,G.a5.QnAResponseReceivedFromSydney),(0,o._)(Q,G.h3.ChatEventParameters,F.c.getTypeName()),J=Q,(null==e?void 0:e.queryId)&&(vt.queryId=e.queryId,J[G.h3.UserQueryGuid]=e.queryId),D||Y===f.B2.Designer?((0,j.Vq)((0,j.Bx)(J[G.h3.UserQueryGuid])),(0,j.zP)(!0),J[G.h3.ChatEventType]=G.a5.DesignerGraphicsResponseReceivedFromSydney,J[G.CT.FeatureName]=R.SD.DesignerVisuals,J[G.CT.SubFeatureName]=G.Ff.AddDesignerImage):(z||Y===f.B2.Summary)&&(J[G.h3.ChatEventType]=a?G.a5.SummaryResponseReceivedFromSkill:G.a5.SummaryResponseReceivedFromSydney),ot.sendChatEventTelemetry((0,B.pN)(J))),K=null!==(X=null==e?void 0:e.chatMessageHeader)&&void 0!==X?X:void 0,ee=(0,Te.EJ)(M,!0),ne=null==M||null===(w=M.contentOrigin)||void 0===w?void 0:w.toLowerCase(),(Y===f.B2.Sydney||(0,he.g3)(ne)||ne===f.wz.CANNED_RESPONSE)&&ot.logTriedEvent(ee.featureName,ee.subFeature,ee.verb),(0,p.bw)(p.WT.IsPersonalizationUXEnabled)&&(0,he.g3)(ne)&&(ot.sendLatencyTelemetry([{key:G.CT.PersonalizationResponseTime,value:(0,g.WU)(ot.getQuerySubmitTime())},{key:G.CT.FeatureName,value:G.CC.Customize}]),(0,h.tpg)()&&(0,h.MCQ)((new Date).getTime())),[4,Qt(e)]);case 1:if(un.sent(),(0,de.cY)("Final message: ".concat(JSON.stringify(M)," and message id: ").concat(Ke," and isSkillResponse ").concat(a)),M&&((0,p.bw)(p.WT.IsDebugSectionV2Enabled)&&nn(e,g.qD,M),ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.FinalValidMessageReceivedFromSydney},{key:G.h3.ChatEventParameters,value:"messageIds_".concat(M.messageId,", ").concat(Ke,"; ContentOrigin: ").concat(null==M?void 0:M.contentOrigin)}]),at=null!=at?at:void 0!==(null==M?void 0:M.error)||(null==M?void 0:M.resultType)===U.gL.ApologyResponseReturned),re=!1,oe=!Kt(),ie=!a||a&&oe,Ke||a)M&&!te(M)&&!(0,j.Ep)(M)&&(M.messageId===Ke||H&&(0,p.PA)(p.IY.isODSLResponseCheckEnabled))?((0,de.cY)("Updating last rendered message with final message"),et=(null===(Ze=A.n.getInstance())||void 0===Ze?void 0:Ze.shouldShowInDocSensitivityLabel())?null===($e=A.n.getInstance())||void 0===$e?void 0:$e.getInDocSensitiveLabelInfo():void 0,Jt(t,M,n,H,s,et,ie,y,d,C,K,e.comprehensionSummaryConfig,a)):!(0,p.bw)(p.WT.IsMarkdownSummarizationEnabled)||a||D?re=!0:((0,de.cY)("Stopping loading ui with last Sydney message after Skill final response"),null===(nt=t.current)||void 0===nt||nt.updateLastMessage({chatCardType:S._.MarkdownCard,stopLoadingUi:ie,addCardToChatHistory:ie,startAugloopTimerForStreaming:ie}));else if(se=null===(ae=t.current)||void 0===ae?void 0:ae.getLastMessage(!1),le=null==se?void 0:se.body.user,(0,de.cY)("Message Id does not exist, ChatUser: ".concat(le)),ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.LastChatMessageUserType},{key:G.h3.ChatEventParameters,value:"MessageUserType_".concat(le)}]),se&&le===v.Q9.Chat){if((0,p.bw)(p.WT.IsDebugSectionV2Enabled)&&(pe=(0,i._)({},vt),ht.push(pe),C(),me=null!==(ge=null===(ce=se.actionBarButtons)||void 0===ce?void 0:ce.slice())&&void 0!==ge?ge:[],(0,fe.FY)(me,pe,y,d),se.actionBarButtons=me),(0,h.tpg)()){we=null!==(be=null==se?void 0:se.messageType)&&void 0!==be?be:S._.MarkdownCard,Pe=null!==(Ie=null==se||null===(ye=se.actionBarButtons)||void 0===ye?void 0:ye.slice())&&void 0!==Ie?Ie:[],_e=!0,Ne=!1,Oe=void 0;try{for(De=Pe[Symbol.iterator]();!(_e=(Le=De.next()).done);_e=!0)Le.value.isDisabled=!1}catch(e){Ne=!0,Oe=e}finally{try{_e||null==De.return||De.return()}finally{if(Ne)throw Oe}}null==t||null===(Ce=t.current)||void 0===Ce||Ce.updateLastMessage({chatCardType:we,chatMessageBodyData:{actionButtonList:(0,l._)((0,h.M79)(t)),feedbackData:(0,Z.as)(void 0,(0,h.quJ)())},stopLoadingUi:!0,addCardToChatHistory:!1})}if(dt.getIsWarningMessageActive()){if((0,de.cY)("Keep chat input disabled because warning message is active. Enable action buttons now that streaming is done."),Ge=null===(Be=t.current)||void 0===Be?void 0:Be.getLastMessage(),Ve=null==Ge?void 0:Ge.warningActionButtons){qe=!0,We=!1,Ye=void 0;try{for(Je=Ve[Symbol.iterator]();!(qe=(Xe=Je.next()).done);qe=!0)Xe.value.isDisabled=!1}catch(e){We=!0,Ye=e}finally{try{qe||null==Je.return||Je.return()}finally{if(We)throw Ye}}null==t||null===(je=t.current)||void 0===je||je.updateLastMessage({chatCardType:S._.WarningMessage,chatMessageBodyData:{warningActionButtons:(0,l._)(Ve)},addCardToChatHistory:!1})}null==t||null===(He=t.current)||void 0===He||He.updateLoadingComponentProps({shouldShowLoadingUi:!1}),dt.setWarningCardDisplayTimeInMs(),dt.setShouldAccountForWarningCardUserInteractionLatency(!0)}else ve.NY||Se.Mp||At?At?(0,de.cY)("Not stopping loading UI as handling speaker notes"):((0,de.cY)("Not stopping loading UI as waiting for Visual Summary from Summary Skill"),re=!0):(Me=null!==(Fe=null==se?void 0:se.messageType)&&void 0!==Fe?Fe:S._.MarkdownCard,(0,de.cY)("Stopping loading ui with last message"),null===(Re=t.current)||void 0===Re||Re.updateLastMessage({chatCardType:Me,stopLoadingUi:!0,addCardToChatHistory:!1}))}else re=!0;if(ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.AnnotationType,F.c.getTypeName()))),rt=at?G.a5.ErrorResponseSignalSent:void 0,ct=re&&function(e){var t,n,r=null==e||null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase();return!!(r===f.wz.CANNED_RESPONSE||r===f.wz.TRANSFORM_CONTENT||r===f.wz.COPILOT_POWERPOINT_SUMMARY.toLowerCase()||r===f.wz.IMAGE_CHAT||(0,p.bw)(p.WT.AreCannedQueriesEnabledForAvalon)&&r===f.wz.DESIGNER_INSERT_GRAPHIC)||(0,p.ti)().split("@").includes(null!==(n=null==e?void 0:e.contentOrigin)&&void 0!==n?n:"")}(M),(0,de.cY)("Single shot response message: ".concat(ct,", checkContentOrigin: ").concat(re)),ct&&((null==M?void 0:M.text)||(0,Qe.Z)(M)))pt=!1,(0,j.Ep)(M)?!(mt=null===(ft=t.current)||void 0===ft?void 0:ft.getLastMessage(!1))||mt.messageType===S._.ChatCardWrapper&&(null===(gt=mt.body.renderData)||void 0===gt?void 0:gt.component)===f.uz.DesignerCard||((0,j.fw)(M,t),pt=!0):(yt=(0,Z.yw)(M),cn(M.text,t,M.messageId,ie,!1,M.contentOrigin,yt,a,K,null==M?void 0:M.dataType,null==M?void 0:M.sections),pt=!0,Jt(t,M,n,H,s,void 0,ie,y,d,C,K,e.comprehensionSummaryConfig,a)),pt&&(St=(0,Te.EJ)(M),ot.sendLatencyTelemetry((0,B.pN)((Tt={},(0,o._)(Tt,G.CT.UserPerceivedLatency,(0,g.WU)(g.qD)),(0,o._)(Tt,G.CT.FeatureName,St.featureName),(0,o._)(Tt,G.CT.SubFeatureName,null!==(bt=St.subFeature)&&void 0!==bt?bt:""),Tt))));else if((0,p.PA)(p.IY.ShouldRenderErrorResponseFromFinalAnnotation)){if(It=!0,null==e?void 0:e.error){Pt="";try{Ot=(null==e||null===(kt=e.error)||void 0===kt?void 0:kt.json)?JSON.parse(null==e||null===(xt=e.error)||void 0===xt?void 0:xt.json):void 0,Pt=(null!==(Dt=null==e||null===(Nt=e.error)||void 0===Nt?void 0:Nt.category)&&void 0!==Dt?Dt:"")+"_"+(Ot?Ot.code:"")}catch(e){(0,de.cY)("failed to parse error object on the Final Message"),ot.sendErrorTelemetry((0,B.pN)((Lt={},(0,o._)(Lt,G.IC.ErrorMessage,"failed to parse error object on the Final Message"),(0,o._)(Lt,G.IC.ErrorCategory,G.S2.FluxCopilot),Lt)))}(null==Pt?void 0:Pt.includes("insert_graphic"))?(Rt=(0,j.jo)(Pt),Ft=Rt.designerVisualsErrorResultType,Mt=Rt.designerVisualsASHAErrorDetails,rt=Ft,lt=Mt):(ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.UnexpectedErrorObjectReceived},{key:G.h3.ChatEventParameters,value:Pt}]),(0,p.PA)(p.IY.IsASHATelemetryToBeLoggedAtStreamEndOnce)?it.getAshaErrorString()==G.av.Unset&&(it.setAshaErrorString(G.av.UnclassifiedIssue),it.setAshaVetoString(G.G8.UnclassifiedAshaError)):lt=(0,Te.Uv)(G.G8.UnclassifiedAshaError,G.av.UnclassifiedIssue)),It=!1}else(null==M?void 0:M.offense)&&M.offense!==U.h2.None&&M.offense!==U.h2.Unknown&&(pn(M.offense),rt=G.a5.RaiErrorMessage,It=!1);(Bt=null===(wt=t.current)||void 0===wt?void 0:wt.getLastMessage(!1))&&Bt.body.user===v.Q9.Human&&(ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.ContentOriginUnhandled},{key:G.h3.ChatEventParameters,value:null!==(Ut=null==M?void 0:M.contentOrigin)&&void 0!==Ut?Ut:f.wz.UNKNOWN}]),ot.sendLatencyTelemetry((0,B.pN)((0,o._)({},G.CT.UserQueryGuid,null==e?void 0:e.queryId))),(0,de.cY)("No chat message has been rendered. Rendering error response from final annotation if any."),zt=(0,Te.EJ)(M,!0),Ht={featureName:zt.featureName,subFeatureName:zt.subFeature},(null==M?void 0:M.text)||(0,Qe.Z)(M)?cn(M.text,t,M.messageId,ie,!1,M.contentOrigin,Ht,a,K,null==M?void 0:M.dataType,null==M?void 0:M.sections):(Vt={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:f.Qp.PowerPointALServerError,featureName:zt.featureName,subFeatureName:zt.subFeature},ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.FinalMessageTextNotFound},{key:G.h3.ChatErrorKey,value:G.Nr.ServerErrorMessage}]),null===(Gt=t.current)||void 0===Gt||Gt.addResponseMessage((0,fe.qi)(PowerpointCopilotStrings.ServerErrorMessage,fe.OT,ie,f.Xw.CHATPPT,void 0,!1,ie,void 0,Vt))),ot.sendLatencyTelemetry((0,B.pN)((qt={},(0,o._)(qt,G.CT.UserPerceivedLatency,(0,g.WU)(g.qD)),(0,o._)(qt,G.CT.FeatureName,zt.featureName),(0,o._)(qt,G.CT.SubFeatureName,null!==(jt=zt.subFeature)&&void 0!==jt?jt:""),qt))),at=!0,It&&((0,p.PA)(p.IY.IsASHATelemetryToBeLoggedAtStreamEndOnce)?it.getAshaErrorString()==G.av.Unset&&(it.setAshaErrorString(G.av.NoResponseFromSydney),it.setAshaVetoString(G.G8.UnclassifiedAshaError)):lt=(0,Te.Uv)(G.G8.UnclassifiedAshaError,G.av.NoResponseFromSydney),rt=G.a5.NoChatResponseRenderedFromSydney))}return Wt=void 0!==rt||!st&&!z&&!V&&!(0,h.tpg)(),a?(0,B.Lu)(ot,g.qD,Et?G.CT.VisualSummaryResponseTime:G.CT.SummaryResponseTime,G.CT.SummaryChunkInfo,ut,G.S2.Summary,void 0,void 0,void 0,ie):((0,p.PA)(p.IY.IsASHATelemetryToBeLoggedAtStreamEndOnce)&&it.getAshaErrorString()!=G.av.Unset&&(lt=(0,Te.Uv)(it.getAshaVetoString(),it.getAshaErrorString())),(0,B.Lu)(ot,g.qD,G.CT.SydneyResponseTime,G.CT.SydneyChunkInfoJson,ut,G.S2.FluxCopilot,rt,void 0,at?f.T_.Client:void 0,!ve.NY&&!Se.Mp&&!dt.getIsWarningMessageActive()&&!(0,h.tpg)()&&ie,Wt,lt)),at=!1,rt=void 0,a&&tt&&(ot.logTriedEvent(R.SD.Summarize,(0,Se.wW)(Ct),m.RX.Summarize),tt=!1,(0,p.bw)(p.WT.IsNotificationEnabledForSummary)&&(0,ke.rc)(it.getUserQueryGuid(),{messageID:null==M?void 0:M.messageId})),ie&&(0,p.bw)(p.WT.IsNotificationEnabledForSummary)&&((0,ke.rc)(it.getUserQueryGuid(),{startShowingNotification:!0}),(0,xe.Xn)(it.getUserQueryGuid())?(en=Ae.A.updateActiveCardForInProgressNotification(it.getUserQueryGuid(),t,null!==($t=null===(Xt=(0,ke.ox)(it.getUserQueryGuid()))||void 0===Xt||null===(Yt=Xt.NotificationAnnotation)||void 0===Yt?void 0:Yt.previewMessage)&&void 0!==$t?$t:f.VC.THUMBNAILS_DOWNLOADED,!0),(0,ke.rc)(it.getUserQueryGuid(),{timerId:en})):(0,xe.l3)(it.getUserQueryGuid())&&Ae.A.updateActiveCardForCompleteNotification(it.getUserQueryGuid(),t,void 0,!0)),(0,de.cY)("Final Annotation : isAnalyzingForVisualSummary: ".concat(ve.NY,", isAnalyzingForVisualSummaryNonStreaming : ").concat(Se.Mp," ,stopLoadingUI: ").concat(ie)),ve.NY||Se.Mp||!ie?a||(an=null===(rn=t.current)||void 0===rn?void 0:rn.getLastMessage(!1),null===(on=t.current)||void 0===on||on.updateLastMessage({chatCardType:null!==(sn=null==an?void 0:an.messageType)&&void 0!==sn?sn:S._.Default,startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:N.SB.getTypeName(),stopLoadingUi:!1,addCardToChatHistory:!1})):(u.G.getInstance().removeContextId(null==e?void 0:e.queryId),L.R.getInstance().setState(f.Nj.IDLE),tn()),(0,p.PA)(p.IY.ShowLoadingMessagesFromSydney)&&(null===(ln=t.current)||void 0===ln||ln.updateLoadingComponentProps({loadingUiStringList:(0,Ee.A)().get(f.Ae.Default)})),[2]}}))}))).apply(this,arguments)}function Yt(){return(Yt=(0,r._)((function(e,t,n,r,s,l){var u,d,y,v,C,b,E,T,w,I,P,_,A,k,N,O,D,L,M,U,z,V,q,W,Y,Q,J,X,K,ee,re,oe,ie,ae,se,le,ce,ue,pe,ge,me,ye,ve,be,Ee,Te,we,Ie,_e,Ae,xe,Ne,Oe,De,Le;return(0,c.__generator)(this,(function(c){if(u=e.chatResponse.basinCursor,d=e.chatResponse.basinWrite,y=e.chatResponse.messagesToAddOrReplace,v=e.chatResponse.messagesToDelete,C=e.chatResponse.messagesToUpdate,E=null!==(b=e.chatMessageHeader)&&void 0!==b?b:void 0,!(0,Ce.hX)(v)){T=!0,w=!1,I=void 0;try{for(P=v[Symbol.iterator]();!(T=(_=P.next()).done);T=!0)A=_.value,(0,de.cY)("Deleting message id: ",A),null===(k=t.current)||void 0===k||k.deleteMessage({chatCardType:(0,p.D$)()&&Ct===x.N.Summary?S._.ChatCardWrapper:S._.MarkdownCard,messageIdToDelete:A}),delete Je.items[A]}catch(e){w=!0,I=e}finally{try{T||null==P.return||P.return()}finally{if(w)throw I}}}if((0,Ce.hX)(u)||(N=JSON.parse(u),(0,de.cY)("Setting basin cursor: ",N),Je.setCursor(N)),!(0,Ce.hX)(y)&&y.length>0){O=!0,D=!1,L=void 0;try{for(M=y[Symbol.iterator]();!(O=(U=M.next()).done);O=!0){if(z=U.value,(0,p.bw)(p.WT.UseDisengagedMessageType)&&((0,he.R7)(z)||_t))return _t=!0,[2];(0,he.Jw)(z)?(z.messageId!==Ke?(et&&(W=n?(0,o._)({},G.CT.FeatureName,G.CC.BasicChat):{},ot.sendLatencyTelemetry((0,B.pN)((0,i._)((0,o._)({},G.CT.UserPerceivedLatency,(0,g.WU)(g.qD)),W))),z.contentOrigin==f.wz.DESIGNER_INSERT_GRAPHIC&&$.r.getInstance().setSkillName(f.B2.Designer),et=!1),r&&tt&&((0,de.cY)("Summary Skill First chunk received"),ot.logTriedEvent(R.SD.Summarize,(0,Se.wW)(Ct),m.RX.Summarize),(0,p.bw)(p.WT.IsNotificationEnabledForSummary)&&(0,ke.rc)(it.getUserQueryGuid(),{messageID:null==z?void 0:z.messageId}),$.r.getInstance().setSkillName(f.B2.Summary),(0,p.PA)(p.IY.IsScenarioErrorTelemetryEnabled)&&it.setScenarioName(R.Cu.Summary),ot.sendLatencyTelemetry((0,B.pN)((Y={},(0,o._)(Y,G.CT.UserPerceivedLatency,(0,g.WU)(g.qD)),(0,o._)(Y,G.CT.AnnotationType,F.c.getTypeName()),(0,o._)(Y,G.CT.FeatureName,G.CC.Summary),Y))),Q={featureName:G.CC.Summary,subFeatureName:(0,Z.AN)(Ct)&&Et?G.Ff.VisualSummary:G.Ff.Summarize},Ct!==x.N.SegmentedSummary&&Ct!==x.N.StyledSummary||(Q.subFeatureName=Ct===x.N.SegmentedSummary?G.Ff.SegmentedSummary:G.Ff.StyledSummary,X=(0,a._)((0,i._)({},Q),{errorMessage:PowerpointCopilotStrings.UnsupportedSummaryError,errorType:f.Qp.SummaryUnsupportedSummaryError}),null===(J=t.current)||void 0===J||J.addResponseMessage((0,fe.qi)(PowerpointCopilotStrings.UnsupportedSummaryError,fe.tc,!1,f.Xw.DECKSUMMARY,void 0,!1,!0,void 0,X))),s>(0,Pe.Wo)()&&(ee=(0,a._)((0,i._)({},Q),{errorMessage:PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",(0,Pe.Wo)().toString()),errorType:f.Qp.TooLargeContentToSummarizeError}),null===(K=t.current)||void 0===K||K.addResponseMessage((0,fe.qi)(PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",(0,Pe.Wo)().toString()),fe.tc,!1,f.Xw.DECKSUMMARY,void 0,!1,!0,void 0,ee)),ot.sendErrorTelemetry((0,B.pN)((re={},(0,o._)(re,G.IC.ErrorMessage,"Word Count does not meet max bar requirement"),(0,o._)(re,G.IC.ErrorCategory,G.S2.Summary),re))),ot.sendChatEventTelemetry((0,B.pN)((oe={},(0,o._)(oe,G.h3.ChatEventType,G.a5.MoreWordCount),(0,o._)(oe,G.h3.ChatEventParameters,"WordCountError"),(0,o._)(oe,G.h3.ChatErrorKey,G.Nr.DeckTooLargeToSummarizeError),oe)))),ie=Mt(z),(0,de.cY)("Full text: ",ie),cn(ie||z.text,t,z.messageId,!1,!0,f.wz.COPILOT_POWERPOINT_SUMMARY,Q,r,E,null==z?void 0:z.dataType,null==z?void 0:z.sections)),Ke=z.messageId,ot.sendChatEventTelemetry((0,B.pN)((ae={},(0,o._)(ae,G.h3.ChatEventType,G.a5.FirstChunkReceivedFromSydney),(0,o._)(ae,G.h3.ChatEventParameters,Ke),ae))),(0,j.Ep)(z)?(0,j.fw)(z,t):te(z)?ne(z,t):(r&&!tt||!r)&&(se=Mt(z),(0,de.cY)("Full text: ",se),cn(se||z.text,t,z.messageId,void 0,void 0,void 0,void 0,void 0,E,null==z?void 0:z.dataType,null==z?void 0:z.sections)),r&&(tt=!1)):(0,j.Ep)(z)?((0,de.cY)("Duplicate message id received for Designer response"),ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.DesignerDuplicateResponse}])):((0,de.cY)("Adding Response Card for messagesToAddOrReplace:",z),le=Mt(z),(0,de.cY)("Full text: ",le),ce=z.sourceAttributions,pt=ce?sn(ce):[],ft=ce?sn(ce,!0):[],ue=(0,p.bw)(p.WT.IsMsgExtEnabled)?(0,h.tO0)(z.sourceAttributions,l,(0,p.PA)(p.IY.IsHideSingleCitationEnabled)):void 0,pe=(0,p.bw)(p.WT.IsApiPluginsCardsEnabled)?(0,h.kqr)(z.sourceAttributions,l,(0,p.PA)(p.IY.IsHideSingleCitationEnabled)):void 0,r?(ge={featureName:G.CC.Summary,subFeatureName:(0,Z.AN)(Ct)&&Et?G.Ff.VisualSummary:G.Ff.Summarize},dn(le||z.text,t,{references:pt,annotationReferences:ft,msgExtCardProps:1===(null==ue?void 0:ue.attributions.length)?void 0:ue,apiPluginCardProps:1===(null==pe?void 0:pe.attributions.length)?void 0:pe,messageAttributionProps:(0,fe.hF)(z),messageId:z.messageId},!0,r,ge,E,null==z?void 0:z.dataType,null==z?void 0:z.sections)):dn(le||z.text,t,{references:pt,annotationReferences:ft,msgExtCardProps:1===(null==ue?void 0:ue.attributions.length)?void 0:ue,apiPluginCardProps:1===(null==pe?void 0:pe.attributions.length)?void 0:pe,messageAttributionProps:(0,fe.hF)(z),messageId:z.messageId},!0,void 0,void 0,E,null==z?void 0:z.dataType,null==z?void 0:z.sections)),pn(z.offense),Je.items[z.messageId]=z):(0,p.PA)(p.IY.ShowLoadingMessagesFromSydney)&&(0,he.bq)(z)?null===(me=t.current)||void 0===me||me.updateLoadingComponentProps({loadingUiStringList:[z.text]}):(0,h.vfc)(z)?Pt=(0,h.cqx)(z):(null===(V=z.authErrors)||void 0===V?void 0:V.length)&&(null===(q=z.authErrors)||void 0===q?void 0:q[0])&&(It=z.authErrors[0],(0,de.cY)("Plugin Auth Error received"),(0,p.PA)(p.IY.IsMsgExtTelemetryEnabled)&&H.B.getInstance().sendErrorTelemetry((0,B.pN)((ye={},(0,o._)(ye,G.IC.ErrorCategory,G.S2.Error),(0,o._)(ye,G.IC.ErrorMessage,"Plugin Auth Error Received"),ye))))}}catch(e){D=!0,L=e}finally{try{O||null==M.return||M.return()}finally{if(D)throw L}}}if((0,Ce.hX)(d)||_t||(Ee=JSON.parse(d),(0,de.cY)("Basin write received: ",Ee),Je.write(Ee),Te=Mt(Je.items[Ke]),(0,de.cY)("Full text from Adaptive Card: ",Te),dn(Te||Ee,t,{references:pt,annotationReferences:ft,messageId:Ke},!0,void 0,void 0,E,null===(ve=Je.items[Ke])||void 0===ve?void 0:ve.dataType,null===(be=Je.items[Ke])||void 0===be?void 0:be.sections)),!(0,Ce.hX)(C)&&C.length>0){we=!0,Ie=!1,_e=void 0;try{for(Ae=C[Symbol.iterator]();!(we=(xe=Ae.next()).done);we=!0){if(Ne=xe.value,(0,p.bw)(p.WT.UseDisengagedMessageType)&&((0,he.R7)(Ne)||_t))return _t=!0,[2];Ke=(0,Ce.jw)(Ke)||(0,Ce.hX)(Ke)?Ne.messageId:Ke,Oe=Ne.sourceAttributions,pt=Oe?sn(Oe):[],ft=Oe?sn(Oe,!0):[],De=(0,p.bw)(p.WT.IsMsgExtEnabled)?(0,h.tO0)(Ne.sourceAttributions,l,(0,p.PA)(p.IY.IsHideSingleCitationEnabled)):void 0,Le=(0,p.bw)(p.WT.IsApiPluginsCardsEnabled)?(0,h.kqr)(Ne.sourceAttributions,l,(0,p.PA)(p.IY.IsHideSingleCitationEnabled)):void 0,Ne.messageId===Ke&&dn(Ne.appendText,t,{references:pt,annotationReferences:ft,msgExtCardProps:1===(null==De?void 0:De.attributions.length)?void 0:De,apiPluginCardProps:1===(null==Le?void 0:Le.attributions.length)?void 0:Le,messageAttributionProps:(0,fe.hF)(Ne),messageId:Ne.messageId},void 0,r,void 0,E,null==Ne?void 0:Ne.dataType,null==Ne?void 0:Ne.sections)}}catch(e){Ie=!0,_e=e}finally{try{we||null==Ae.return||Ae.return()}finally{if(Ie)throw _e}}}return[2]}))}))).apply(this,arguments)}var Qt=function(){var e=(0,r._)((function(e){var t,n,r,i,a,s,l,u,d,f,g,m,y;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:if(!(n=(0,ge.pX)()&&(0,p.PA)(p.IY.IsClpEnabledInEnterpriseForSydney)?e.chatResponse.conversationSensitivityLabel:void 0))return(0,de.cY)("conversationSensitivityLabel is undefined or not applicable"),(0,ge.pX)()&&ot.sendChatEventTelemetry((0,B.pN)((0,o._)({},G.h3.ChatEventType,G.a5.ConversationSensitivityLabelNotFound))),[2];if((0,de.cY)("Enterprise search"),(0,p.PA)(p.IY.UseNewCopilotSharedPackage)?(0,h.YwR)():(0,ge.Yw)(),r={labelId:n.id,tenantId:"",encryptionType:n.isEncrypted?h.TzT.IRMTemplate:h.TzT.None,displayName:n.displayName,description:n.tooltip,color:n.color,order:n.priority},!n.labelId&&!(null===(t=A.n.getInstance())||void 0===t?void 0:t.shouldShowInDocSensitivityLabel()))return[3,7];c.label=1;case 1:return c.trys.push([1,6,,7]),[4,null===(a=A.n.getInstance())||void 0===a?void 0:a.getHighestDocumentSensitivityInfo([null===(i=A.n.getInstance())||void 0===i?void 0:i.getInDocSensitiveLabelInfo(),r])];case 2:return u=c.sent(),[4,null===(s=A.n.getInstance())||void 0===s?void 0:s.getInDocSensitiveLabelUsingOfcJs()];case 3:return d=c.sent(),u.isDke=d.isDke,u.hasExtractForUser=d.hasExtractForUser,(0,de.cY)("Enterprise search: setting sensitivity to "+u),null===(l=A.n.getInstance())||void 0===l||l.setInDocSensitivityLabelInfo(u),ct?((0,de.cY)("Handling end of stream. Odsl executed successfully and and odsl program is insertion scenario, updating document sensitivity"),[4,null===(g=A.n.getInstance())||void 0===g?void 0:g.upgradeSensitivityLabelUsingOfcJs(null===(f=A.n.getInstance())||void 0===f?void 0:f.getInDocSensitiveLabelInfo())]):[3,5];case 4:c.sent(),c.label=5;case 5:return[3,7];case 6:return m=c.sent(),(0,de.cY)("Enterprise search: Office JS sensitivity api failed: "+m.message),ot.sendErrorTelemetry((0,B.pN)((y={},(0,o._)(y,G.IC.ErrorMessage,"Exception while calling Office JS sensitivity api in Flux Copilot Workflow: "+m.message),(0,o._)(y,G.IC.ErrorCategory,G.S2.OfficeJsApi),y))),[3,7];case 7:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Jt=function(e,t,n,r,l,c){var u,d,g=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],m=arguments.length>7?arguments[7]:void 0,y=arguments.length>8?arguments[8]:void 0,v=arguments.length>9?arguments[9]:void 0,C=arguments.length>10&&void 0!==arguments[10]?arguments[10]:void 0,b=arguments.length>11&&void 0!==arguments[11]?arguments[11]:void 0,E=arguments.length>12&&void 0!==arguments[12]&&arguments[12],T=c?c.displayName:void 0;if(rt.clear(),pt=[],ft=[],(0,p.PA)(p.IY.IsCitationsEnabled))if((t.citations||[]).length>0){var w=t.citations,I=!0,P=!1,A=void 0;try{for(var k,N=w[Symbol.iterator]();!(I=(k=N.next()).done);I=!0){var O=k.value;pt.push(rn(O,T))}}catch(e){P=!0,A=e}finally{try{I||null==N.return||N.return()}finally{if(P)throw A}}}else(t.sourceAttributions||[]).length>0&&(pt=sn(t.sourceAttributions),ft=sn(t.sourceAttributions,!0));var L=!(r||Pt),R=L&&!(0,p.pu)()?(0,fe.y_)():[];try{if(!r&&(0,p.bw)(p.WT.IsCopilotPlayKeySlidesEnabled)&&(null==b?void 0:b.intent)===x.N.ImportantSlides){var F,M=(0,fe.rz)(null==t?void 0:t.hiddenText);if(M)R.push(M),ot.sendChatEventTelemetry((0,B.pN)((F={},(0,o._)(F,G.h3.ChatEventType,G.a5.PlayKeySlidesButtonAdded),(0,o._)(F,G.h3.ChatEventParameters,JSON.stringify({handler:"PowerpointFluxCopilotAnnotationHandler"})),F)))}}catch(e){var U;(0,de.cY)("Failed to add PlayKeySlides button: "+(null==e?void 0:e.message)),ot.sendErrorTelemetry((0,B.pN)((U={},(0,o._)(U,G.IC.ErrorMessage,"Exception while adding PlayKeySlides button from Powerpoint flux: "+(null==e?void 0:e.message)),(0,o._)(U,G.IC.ErrorCategory,G.S2.PlayKeySlides),U)))}if((0,p.bw)(p.WT.IsDebugSectionV2Enabled)){var z=(0,i._)({},vt);ht.push(z),v(),(0,fe.FY)(R,z,m,y)}var H=(0,p.bw)(p.WT.IsMsgExtEnabled)?(0,h.tO0)(t.sourceAttributions,l,(0,p.PA)(p.IY.IsHideSingleCitationEnabled),!0):void 0,V=(0,p.bw)(p.WT.IsApiPluginsCardsEnabled)?(0,h.kqr)(t.sourceAttributions,l,(0,p.PA)(p.IY.IsHideSingleCitationEnabled),!0):void 0,j=(0,p.bw)(p.WT.EnableAnchorTagOverrideForKeySlides)&&(null==b?void 0:b.intent)===x.N.ImportantSlides&&!r,q=(0,Z.yw)(t);try{var W;if((null==b?void 0:b.intent)===x.N.ImportantSlides)ot.sendChatEventTelemetry((0,B.pN)((W={},(0,o._)(W,G.h3.ChatEventType,G.a5.ClickableKeySlidesEnabled),(0,o._)(W,G.h3.ChatEventParameters,JSON.stringify({isClickableKeySlidesEnabled:j,anchorTagOverrideEnabled:(0,p.bw)(p.WT.EnableAnchorTagOverrideForKeySlides)})),W)))}catch(e){var Y;ot.sendErrorTelemetry((0,B.pN)((Y={},(0,o._)(Y,G.IC.ErrorMessage,D.dIF),(0,o._)(Y,G.IC.ErrorCategory,G.S2.ClickableKeySlides),(0,o._)(Y,G.CT.ErrorType,f.T_.Client),Y)))}var Q=S._.MarkdownCard,J={markDownCardProps:{user:"chat",message:t.text,disableLinksProcessing:(null===(u=t.contentOrigin)||void 0===u?void 0:u.toLowerCase())===f.wz.CANNED_RESPONSE,componentsOverride:j?{a:function(e){e.node;var n=s(e,["node"]);return Oe(n,ot,null==t?void 0:t.hiddenText)}}:void 0,stringReplacementAnchorComponentOverride:j&&(0,p.PA)(p.IY.IsStringReplacementAnchorTagOverrideEnabled)?PowerpointCopilotStrings.SlideN:void 0}};if((0,p.D$)()&&Ct===x.N.Summary&&(null==t?void 0:t.dataType)===_.pe.Section){var X,K,$,ee=We.U.getInstance(),te=(0,Z.Xh)(null!==(X=null==t?void 0:t.MessageId)&&void 0!==X?X:ee.getLatestQueryId(),null==t?void 0:t.sections,pt);Q=null!==(K=te.chatCardType)&&void 0!==K?K:Q,J=null!==($=te.chatCardMessageData)&&void 0!==$?$:J}null===(d=e.current)||void 0===d||d.updateLastMessage({chatCardType:Q,chatMessageData:J,chatMessageBodyData:(0,a._)((0,i._)({},fe.tc),{feedbackData:(0,Z.cd)(t)?(0,Z.as)(f.Xw.CHATPPT,q):null===fe.tc||void 0===fe.tc?void 0:fe.tc.feedbackData,telemetryData:un(t.contentOrigin,q,E),actionButtonList:R,references:pt,annotationReferences:ft,clpSensitivityIndicatorData:c?(0,me.ny)():void 0,msgExtCardProps:H,apiPluginCardProps:V,confirmationCardProps:Pt,pluginAuthError:It,chatMessageHeaderData:(0,fe.Ne)(C),messageAttributionProps:(0,fe.hF)(t),shouldShowCopyButton:(0,p.pu)()&&L,shouldShowHandoffButton:(0,p.pu)()&&L,shouldShowReadAloudButton:(0,p.pu)()&&L}),stopLoadingUi:g,addCardToChatHistory:(0,p.D$)()&&Ct===x.N.Summary&&(null==t?void 0:t.dataType)===_.pe.Section?null==b?void 0:b.cache:g});var ne=t.suggestedResponses;if(Xe&&ne&&ne.length>0){var re=(0,he.z)(ne);(0,de.cY)("updating suggestion pills from Powerpoint Flux Copilot. Suggestions received in response: "+re),n(re,G.Ff.Sydney)}},Xt=function(){$e=!0},Kt=function(){return $e},Zt=function(e,t,n,r){var o={annotationType:e,isStreamingAnnotation:n,responseTime:t,status:r};mt.push(o)},$t=function(){return ht},en=function(e){yt.push(e)},tn=function(){Je=new d.Basin,Xe=!0,$e=!1,He=!1,Ke="",Ze="",nt=!0,et=!0,tt=!0,at=!1,st=!1,lt=!1,ct=!1,ut=[],$.r.getInstance().resetData(),pt=[],Ct=x.N.Unknown,Et=!1,bt=!1,It=void 0,Pt=void 0,mt=[],yt=[],vt={},_t=!1,At=!1},nn=function(e,t,n,r,o){var i,a,s,l,c,u,d;(o?vt.skill=f.B2.Summary:vt.skill||(vt.skill=f.B2.Sydney),St)||(St=null===(l=e.chatResponse)||void 0===l?void 0:l.sessionKey);if(vt.sessionId=St,vt.status=null!==(c=null===(i=e.chatResponse)||void 0===i?void 0:i.status)&&void 0!==c?c:e.status,vt.queryId=null!==(u=vt.queryId)&&void 0!==u?u:e.queryId,vt.timestamp=e.timestamp,r)Zt(F.c.getTypeName(),(0,g.WU)(t),!1,e.status),vt.messageType=null!==(d=vt.messageType)&&void 0!==d?d:"null",vt.error=e.error,vt.FCFR=(0,g.WU)(t),vt.LCFR=(0,g.WU)(t);else if(n){var p,h,m;vt.queryId=null!==(h=vt.queryId)&&void 0!==h?h:n.queryId,vt.messageType=n.messageType,vt.LCFR=(0,g.WU)(t),vt.FCFR=null!==(m=vt.FCFR)&&void 0!==m?m:vt.LCFR,vt.timestamp=n.timestamp,vt.sensitivity=null===(p=n.sensitivityLabel)||void 0===p?void 0:p.displayName,vt.groundingDataCount=n.groundingDataCount}vt.resultType=null===(a=e.chatResponse)||void 0===a?void 0:a.resultType,vt.optionSets=null===(s=e.chatResponse)||void 0===s?void 0:s.optionsSets,vt.annotationResponses=mt,vt.signals=yt},rn=function(e,t){var n;return rt.set(e.contentIndex,e.path),{referenceIndex:e.contentIndex,referenceProps:{title:null!==(n=on(e.content))&&void 0!==n?n:D.u1i,primarySubtitle:(0,D.t28)(),snippet:(0,Z.KN)(e.content),referenceType:C._2.Internal,iconAppName:e.type,citationPosition:e.position,onClickCitationLink:an,path:e.path,sensitivityLabel:t}}},on=function(e){return e?'"'+(e.length>18?e.slice(0,18).trim():e)+D.GrL+'"':null},an=function(){var e=(0,r._)((function(e,t,n){var r,i;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return t=null!=t?t:rt.get(e),n&&(r=(0,Z.zq)(n),i=r.correlationId,r.featureName,void 0!==i&&ot.setQueryGuid(i)),ot.sendChatEventTelemetry((0,B.pN)((0,o._)({},G.h3.ChatEventType,G.a5.CitationClicked))),n&&ot.setQueryGuid(""),[4,(0,Z.P3)(null!=t?t:[])];case 1:return a.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),sn=function(e,t){return e.filter((function(e){return t?e.sourceType===D.YgX:e.sourceType!==D.YgX})).map((function(e,t){var n,r,o=void 0;e.referenceMetadata&&(o=JSON.parse(e.referenceMetadata));var i,a,s,l,c,u=(0,he.Cr)(null==o?void 0:o.type,null==o?void 0:o.referenceType,e),d=u===C._2.Internal?on(null!==(i=null==o?void 0:o.snippet)&&void 0!==i?i:""):null!==(a=on(e.providerDisplayName))&&void 0!==a?a:u,f=u===C._2.Internal?(0,D.t28)():null!==(s=null==o?void 0:o.typeDescription)&&void 0!==s?s:D.u1i,h=null==o||null===(n=o.iconUrl)||void 0===n?void 0:n.replace(/\/$/,""),g=function(e){return e.sourceType===D.YgX?C.GH.Annotation:C.GH.Citation}(e);return{referenceIndex:t+1,referenceProps:{title:d,primarySubtitle:f,secondarySubtitle:null!==(l=null==o?void 0:o.context)&&void 0!==l?l:ln(e),snippet:(0,he.NV)(null!==(c=null==o?void 0:o.snippet)&&void 0!==c?c:D.u1i),referenceType:u,iconAppName:u===C._2.CrossApp||u===C._2.Internal?(0,p.bw)(p.WT.IsCitationSupportForAvalonEnabled)?(0,he.Iw)(null==o?void 0:o.type):(0,he.f6)(null==o?void 0:o.referenceType):void 0,url:ln(e),path:[e.path],onClickCitationLink:an,sensitivityLabel:(0,p.PA)(p.IY.IsClpEnabledInEnterpriseForSydney)?null==o||null===(r=o.sensitivityLabel)||void 0===r?void 0:r.displayName:void 0,iconUrl:h,linkType:g},isFlux:!0}}))};function ln(e){return(0,p.bw)(p.WT.IsCitationSupportForAvalonEnabled)?(0,Ce.hX)(e.path)?e.seeMoreUrl:void 0:(0,Ce.hX)(e.seeMoreUrl)?void 0:e.seeMoreUrl}function cn(e,t,n,r,i,a,s,l){var c,u,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,g=arguments.length>9?arguments[9]:void 0,m=arguments.length>10?arguments[10]:void 0;if((0,Ce.hX)(e)){var y,v;(0,de.cY)("Returning as message is empty"),l?ot.sendChatEventTelemetry((0,B.pN)((y={},(0,o._)(y,G.h3.ChatEventType,G.a5.EmptyMessageReceivedFromSummarySkill),(0,o._)(y,G.h3.ChatEventParameters,"Empty Markdown message card"),y))):ot.sendChatEventTelemetry((0,B.pN)((v={},(0,o._)(v,G.h3.ChatEventType,G.a5.EmptyMessageReceivedFromSydney),(0,o._)(v,G.h3.ChatEventParameters,"Empty Markdown message card"),v)))}else{Ze=e;var C=S._.MarkdownCard,b={markDownCardProps:{user:"chat",message:Ze,disableLinksProcessing:(null==a?void 0:a.toLowerCase())===f.wz.CANNED_RESPONSE}};if((0,p.D$)()&&Ct===x.N.Summary&&g===_.pe.Section){var E,w,I=(0,Z.Xh)(n,m);C=null!==(E=I.chatCardType)&&void 0!==E?E:C,b=null!==(w=I.chatCardMessageData)&&void 0!==w?w:b}null===(u=t.current)||void 0===u||u.addResponseMessage({chatCardType:C,chatMessageData:b,chatMessageBodyData:{actionButtonList:(0,h.tpg)()?(0,h.$dc)():[],shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:l&&(null===(c=A.n.getInstance())||void 0===c?void 0:c.shouldShowInDocSensitivityLabel())?(0,me.ny)():void 0,feedbackSectionPosition:T.O.Footer,feedbackData:(0,Z.as)(f.Xw.CHATPPT,s),telemetryData:un(a,s,l),showAnimation:!0,isFailure:!1,messageId:n,chatMessageHeaderData:(0,fe.Ne)(d)},stopLoadingUi:!!r,startAugloopTimerForStreaming:null==i||i,workflowAnnotationTypeForAugloopTimer:F.c.getTypeName(),addCardToChatHistory:!1})}}function un(e,t,n){if(n)return(0,Z.YI)(R.SD.Summarize,(0,Z.AN)(Ct)&&Et?G.Ff.VisualSummary:G.Ff.Summarize);if(e===f.wz.IMAGE_CHAT&&(null==t?void 0:t.featureName)===R.SD.AddContent)return(0,Z.YI)(R.SD.AddContent,t.subFeatureName);var r=(0,Te.Ux)(e);return(0,Z.YI)(r.featureName,r.subFeature)}function dn(e,t,n,r,s,l){var c,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,g=arguments.length>8?arguments[8]:void 0;if((0,Ce.hX)(e))(0,de.cY)("Returning as message is undefined");else{var m,y,v,C=e;if(C=C.replace("\\n","\n"),Ze=r?C:Ze+C,((null==n?void 0:n.references)||[]).length>0)ot.sendChatEventTelemetry((0,B.pN)((v={},(0,o._)(v,G.h3.ChatEventType,G.a5.CitationReceived),(0,o._)(v,G.h3.ChatEventParameters,null!==(y=null==n||null===(m=n.references)||void 0===m?void 0:m.length)&&void 0!==y?y:0),v)));var b=S._.MarkdownCard,E={markDownCardProps:{user:"chat",message:Ze}};if((0,p.D$)()&&Ct===x.N.Summary&&d===_.pe.Section){var T,w,I=(0,Z.Xh)(n.messageId,g,null==n?void 0:n.references);b=null!==(T=I.chatCardType)&&void 0!==T?T:b,E=null!==(w=I.chatCardMessageData)&&void 0!==w?w:E}null===(c=t.current)||void 0===c||c.updateLastMessage({chatCardType:b,chatMessageData:E,chatMessageBodyData:(0,a._)((0,i._)({},n),{chatMessageHeaderData:(0,fe.Ne)(u),actionButtonList:(0,h.tpg)()?(0,h.$dc)():[],feedbackData:s?(0,Z.as)(f.Xw.DECKSUMMARY,l):void 0,telemetryData:s?(0,Z.YI)(R.SD.Summarize,(0,Z.AN)(Ct)&&Et?G.Ff.VisualSummary:G.Ff.Summarize):(0,Z.YI)(R.SD.CopilotChat)}),startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:F.c.getTypeName(),stopLoadingUi:!1,addCardToChatHistory:!1})}}var pn=function(e){if(e!==U.h2.None&&e!==U.h2.Unknown){ot.sendChatEventTelemetry([{key:G.h3.ChatEventType,value:G.a5.RaiErrorMessage},{key:G.h3.ChatEventParameters,value:e}]);var t=(0,Te.Uv)(G.G8.RAIError,G.av.OffensiveContentError);ot.logAshaErrorEvent(t.vetoName,t.errorString,t.featureName)}};function fn(e,t){ut.push({augloopResponseTime:(0,g.WU)(g.qD),isSkillResponse:e,status:t})}},94831:(e,t,n)=>{"use strict";n.d(t,{G:()=>z,t:()=>H});var r,o,i=n(43032),a=n(90813),s=n(79490),l=n(70825),c=n(69038),u=n(93176),d=n(32854),p=n(39726),f=n(17223),h=n(55564),g=n(1134),m=n(81789),y=n(66888),v=n(34045),S=n(11420),C=n(41829),b=n(66887),E=n(18758),T=n(47941),w=n(14213),I=n(44632),P=n(53154),_=n(18384),A=n(12542),k=n(44121),x=n(50481),N=n(23343),O=n(74930),D=n(27465),L=n(98483),R=n(65817),F=n(13403),M=n(72218),B=w.K.getInstance(),U=I.B.getInstance(),z=(o=(0,i._)((function(e){var t,n,o,i,u,d;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return r=(new Date).getTime(),m.R.getInstance().getState()!==p.Nj.IDLE&&P.G.getInstance().addContextId(c.dB),(0,h.PA)(h.IY.IsSendSlideMonikerEnabled)?[4,(0,g.Oc)(e)]:[3,2];case 1:return o=s.sent(),[3,3];case 2:o=void 0,s.label=3;case 3:return n=o,i=Object.assign(new S.q,{targetSlides:[n],trigger:C.C.SlideNav,correlationId:c.dB,jsonCmdApiVersion:v.Vv.getSettingAsString(v.zj.PPTJsonCmdAPIVersion)}),u=new l.Xr({parentPath:["Signal",S.q.getTypeName()],items:[{id:y.r.generateId(),body:i}]}),d=f.t.getInstance().getChatRef(),null===(t=d.current)||void 0===t||t.submitOperation({operation:u,workflowAnnotationType:b.T.getTypeName()}),(0,E.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(u)+"\nat Time : "+new Date+"\nSessionKey: "+(0,T.Dt)()+"\n\n\n"),U.sendChatEventTelemetry((0,_.pN)((0,a._)({},A.h3.ChatEventType,A.a5.PresentationRecommendationOperationSubmitted))),m.R.getInstance().setState(p.Nj.WAITING_FOR_PRESENTATION_RECOMMENDATION_WF_RESPONSE),[2]}}))})),function(e){return o.apply(this,arguments)}),H=function(){var e=(0,i._)((function(e,t,n,o,l){var f,g,y,v,S,C,T,w,I,P,z,H,G,V,j,q,W,Y,Q,J,X,K,Z,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,fe,he;return(0,s.__generator)(this,(function(ge){switch(ge.label){case 0:return(0,E.cY)("".concat(b.T.getTypeName()," response received\n Time Taken: ").concat((0,c.WU)(r),"s ")),y=m.R.getInstance().getState(),(0,h.bw)(h.WT.TriggerPresentationRecommendationWithBeautify)||y===p.Nj.IDLE||y===p.Nj.WAITING_FOR_PRESENTATION_RECOMMENDATION_WF_RESPONSE?(B.setResponseTime((0,c.WU)(c.qD)),m.R.getInstance().setState(p.Nj.EXECUTING),v=null==e?void 0:e.body,S=null==v?void 0:v.presentationRecommendations,C=null==v?void 0:v.loggableSkillResults,(0,E.cY)("PresentationRecommendation received recommendations: ".concat(JSON.stringify(S))),(0,E.cY)("PresentationRecommendation received loggableSkillResults: ".concat(JSON.stringify(C))),T=null==v?void 0:v.error,w=null==v?void 0:v.correlationId,I={status:p.rI.SUCCESS},void 0!==w&&(0,_.Zp)(v.correlationId),P=new O.DA({status:D.Aw.failed,queryId:c.dB,error:void 0}),T&&0!==T.code?((0,E.cY)("Error code received from PresentationRecommendation:"+JSON.stringify(T.code)),(0,E.cY)("Error message received from PresentationRecommendation:"+JSON.stringify(T.message)),(0,_.AQ)(U,c.qD,"".concat(b.T.getTypeName(),"_Error"),JSON.stringify(T.code),p.T_.Server,void 0,!(0,x.w_)()),(0,x.gj)()?[3,1]:(m.R.getInstance().setState(p.Nj.IDLE),[3,3])):[3,4]):((0,E.cY)("presentationRecommendationAnnotationProcessor: Invalid ExecutionState: ".concat(y,". Expected idle or waiting for presentation recommendation workflow response. Returning")),[2]);case 1:return[4,(0,x.Ge)(P,t)];case 2:ge.sent(),ge.label=3;case 3:return(0,N.k)(!1,"PresentationRecommendationWorkflow_".concat(JSON.stringify(T.code))),B.resetData(),[2];case 4:if((0,_.$j)(U,b.T.getTypeName(),r,A.CT.PresentationRecommendationWorkflowResponseTime,A.CC.PresentationRecommendation,l),z=(new Date).getTime(),B.setScenarioName(k.Cu.PresentationRecommendation),H=(null===(f=S[0])||void 0===f?void 0:f.jsonCmds)?JSON.parse(S[0].jsonCmds).cmds:[],G=(null===(g=S[0])||void 0===g?void 0:g.jsonCmdOptions)?JSON.parse(S[0].jsonCmdOptions):{},V={designerOptions:(null==G?void 0:G.designerOptions)?JSON.stringify(G.designerOptions):void 0,selectionOptions:(null==G?void 0:G.selectionOptions)?JSON.stringify(G.selectionOptions):void 0},j=B.getStartTime(),!(H.length>0))return[3,9];q={scenarioName:B.getScenarioName(),startTime:j||(new Date).toISOString(),entryPoint:M.$kB.Chat,correlationId:w||(0,L.A)(),timeToODSLMS:1e3*B.getResponseTime(),timeODSLToJOfcMS:0,capability:B.getCapability(),featureName:B.getFeatureName(),subFeatureName:B.getSubFeatureName(),fGeneratePreviews:!0},V.scenarioOptions=JSON.stringify(q),ge.label=5;case 5:return ge.trys.push([5,7,,8]),n(!1),[4,PowerPoint.run(function(){var e=(0,i._)((function(e){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,R.Rf)(e,H,V)];case 1:return I=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 6:return ge.sent(),(0,E.cY)("log result : ",JSON.stringify(I)),[3,8];case 7:return W=ge.sent(),(0,E.cY)("Execution failed"+JSON.stringify(W)),I={status:p.rI.FAILED,error:p.Re.JOFC_EXCEPTION},[3,8];case 8:return(0,h.PA)(h.IY.IsJofcCommandErrorTelemetryEnabled)&&I.status!==p.rI.SUCCESS&&U.sendChatEventTelemetry((0,_.pN)((Q={},(0,a._)(Q,A.h3.ChatEventType,A.a5.PresentationRecommendationJOfcCommandsError),(0,a._)(Q,A.h3.ChatEventParameters,p.Re[null!==(Y=I.error)&&void 0!==Y?Y:p.Re.UNKNOWN_ERROR]),Q))),[3,10];case 9:(0,N.k)(!1,"PresentationRecommendationWorkflow_NoCmdsGenerated"),ge.label=10;case 10:switch(U.sendLatencyTelemetry((0,_.pN)((0,a._)({},A.CT.QueryExecutionTime,(0,c.WU)(z)))),I.status){case p.rI.BLOCKED:case p.rI.UNSUPPORTED:case p.rI.FAILED:case p.rI.UNEXPECTED_VERSION:case p.rI.USER_ABORTED:case p.rI.PARTIAL_SUCCESS:return[3,11];case p.rI.SUCCESS:return[3,12]}return[3,14];case 11:return(0,F.af)(I,t,b.T.getTypeName(),o,P),[3,14];case 12:return P.status=D.Aw.success,[4,(0,x.Yb)(p.rI.SUCCESS)];case 13:return ge.sent(),(ce=(null==I||null===(K=I.payload)||void 0===K||null===(X=K.jOfcApiResult)||void 0===X||null===(J=X.Thumbnails)||void 0===J?void 0:J.length)>0)?(de={featureName:A.CC.PresentationRecommendation,subFeatureName:A.Ff.ProactiveRecommendation},null===(ue=t.current)||void 0===ue||ue.addResponseMessage({chatCardType:u._.ProactiveSuggestionCard,chatMessageData:{proactiveSuggestionCardProps:{user:"chat",skillType:"",imageSrc:I.payload.jOfcApiResult.Thumbnails[0],handleApplyClicked:(0,i._)((function(){var e;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,PowerPoint.run(function(){var e=(0,i._)((function(e){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,R.Rf)(e,H,V)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),(0,E.cY)("PresentationRecommendation: Continuing protocol execution failed"+JSON.stringify(e)),[3,3];case 3:return m.R.getInstance().setState(p.Nj.IDLE),[2,Promise.resolve((0,E.cY)("ProactiveSuggestionCard Apply Clicked"))]}}))})),handleMouseOver:function(){return Promise.resolve((0,E.cY)("ProactiveSuggestionCard Mouse Over"))},handleMouseLeave:function(){return Promise.resolve((0,E.cY)("ProactiveSuggestionCard Mouse Leave"))}}},chatMessageBodyData:{feedbackData:(0,d.as)(p.Xw.CHATPPT,de)}})):(0,E.cY)("PresentationRecommendation: No thumbnail received. Preview card will not be shown."),pe={FSuccess:null==I||null===($=I.payload)||void 0===$||null===(Z=$.jOfcApiResult)||void 0===Z?void 0:Z.FSuccess,JOfcCommandStatusCode:null==I||null===(te=I.payload)||void 0===te||null===(ee=te.jOfcApiResult)||void 0===ee?void 0:ee.JOfcCommandStatusCode,JOfcCommandErrorReason:null==I||null===(re=I.payload)||void 0===re||null===(ne=re.jOfcApiResult)||void 0===ne?void 0:ne.JOfcCommandErrorReason,JOfcCmdResultId:null==I||null===(ie=I.payload)||void 0===ie||null===(oe=ie.jOfcApiResult)||void 0===oe?void 0:oe.JOfcCmdResultId,NumThumbnails:(null==I||null===(le=I.payload)||void 0===le||null===(se=le.jOfcApiResult)||void 0===se||null===(ae=se.Thumbnails)||void 0===ae?void 0:ae.length)||0},U.sendChatEventTelemetry((0,_.pN)((fe={},(0,a._)(fe,A.h3.ChatEventType,b.T.getTypeName()),(0,a._)(fe,A.h3.ChatEventParameters,JSON.stringify(pe)),fe))),he=!(0,x.w_)(),(0,_.AQ)(U,c.qD,ce?void 0:A.a5.PresentationRecommendationThumbnailNotReceived,void 0,void 0,void 0,he),[3,14];case 14:return B.resetData(),(0,x.gj)()?[4,(0,x.Ge)(P,t)]:[3,16];case 15:ge.sent(),ge.label=16;case 16:return m.R.getInstance().setState(p.Nj.IDLE),[2]}}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}()},67815:(e,t,n)=>{"use strict";n.d(t,{$:()=>D,G:()=>O});var r,o,i=n(43032),a=n(79490),s=n(70825),l=n(39726),c=n(53154),u=n(69038),d=n(17223),p=n(81789),f=n(28248),h=n(57155),g=n(66888),m=n(74930),y=n(65917),v=n(27465),S=n(44121),C=n(14213),b=n(52318),E=n(65817),T=n(39041),w=n(18758),I=n(9212),P=n(24464),_=n(50481),A=n(1134),k=n(13403),x=n(72218),N=C.K.getInstance(),O=(o=(0,i._)((function(e,t){var n,o,i,m,v,S;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return o=d.t.getInstance().getChatRef(),r=(new Date).getTime(),p.R.getInstance().getState()!==l.Nj.IDLE&&c.G.getInstance().addContextId(u.dB),[4,(0,A.Mp)(e)];case 1:return i=a.sent(),v={targetFileDownloadUrl:null!==(m=y._.getInstance().getCachedDocumentState().latestDownloadUrl)&&void 0!==m?m:"",targetSlideIndexList:t,transformSlideIndexList:i},S=new s.Xr({parentPath:["Signal",f.Q.getTypeName()],items:[{id:g.r.generateId(),body:new f.Q(v)}]}),null===(n=o.current)||void 0===n||n.submitOperation({operation:S,workflowAnnotationType:h.x.getTypeName()}),(0,w.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(S)+"\nat Time : "+new Date+"\nSessionKey: "+(0,I.Dt)()+"\n\n\n"),p.R.getInstance().setState(l.Nj.WAITING_FOR_PRESENTATIONTRANSFORM_WF_RESPONSE),[2]}}))})),function(e,t){return o.apply(this,arguments)}),D=function(){var e=(0,i._)((function(e,t,n,o,s){var c,d,g,y,C,I,A,O,D,L,R,F;return(0,a.__generator)(this,(function(M){switch(M.label){case 0:(0,w.cY)("".concat(h.x.getTypeName()," response. Time Taken : ").concat((0,u.WU)(r)," sec \n")),N.setResponseTime((0,u.WU)(u.qD)),N.setScenarioName(S.Cu.PresentationTransform),p.R.getInstance().setState(l.Nj.EXECUTING),c=null==e?void 0:e.body,d=null==c?void 0:c.jofcCommandsString,g=new m.DA({status:v.Aw.failed,queryId:u.dB,error:void 0}),(0,w.cY)("Statements received from ODSL for organize Presentation :"+d),y={status:l.rI.SUCCESS},M.label=1;case 1:return M.trys.push([1,3,,4]),o(!1),C={scenarioName:N.getScenarioName(),startTime:N.getStartTime(),entryPoint:x.$kB.Chat,correlationId:u.dB,timeToODSLMS:1e3*N.getResponseTime(),timeODSLToJOfcMS:0,capability:N.getCapability(),featureName:N.getFeatureName(),subFeatureName:N.getSubFeatureName()},I={scenarioOptions:JSON.stringify(C)},[4,PowerPoint.run(function(){var e=(0,i._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,E.G_)(e,d,I)];case 1:return y=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return M.sent(),(0,w.cY)("log result : ",JSON.stringify(y)),[3,4];case 3:return A=M.sent(),(0,w.cY)("Execute failed:"+JSON.stringify(A)),y={status:l.rI.FAILED},[3,4];case 4:switch(O=b.Lo.length>0&&""!==b.Lo[0]&&(0,T._r)(b.U9),y.status){case l.rI.BLOCKED:case l.rI.UNSUPPORTED:case l.rI.FAILED:case l.rI.UNEXPECTED_VERSION:case l.rI.USER_ABORTED:case l.rI.PARTIAL_SUCCESS:(0,k.af)(y,t,s,f.Q.getTypeName(),g);break;case l.rI.SUCCESS:g.status=v.Aw.success,L={linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseContentCreationLine1Option1,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseContentCreationLine2},O&&(L.linkPrefix=b.Lo.filter((function(e){return e})).join(" ")+" "),R=!(0,_.w_)(),F={featureName:N.getFeatureName()},null===(D=t.current)||void 0===D||D.addResponseMessage((0,P.FL)(L,n,void 0,P.tc,R,l.Xw.CHATPPT,void 0,void 0,F))}return N.resetData(),(0,_.gj)()?[4,(0,_.Ge)(g,t)]:[3,6];case 5:M.sent(),M.label=6;case 6:return[2]}}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}()},60849:(e,t,n)=>{"use strict";n.d(t,{A:()=>J,Z:()=>X});var r,o,i=n(43032),a=n(90813),s=n(57835),l=n(61838),c=n(79490),u=n(70825),d=n(53154),p=n(55564),f=n(39726),h=n(1335),g=n(69038),m=n(93176),y=n(17223),v=n(81789),S=n(24449),C=n(37086),b=n(18384),E=n(44121),T=n(1373),w=n(74930),I=n(65917),P=n(27465),_=n(14213),A=n(44632),k=n(86204),x=n(12542),N=n(52318),O=n(65817),D=n(21659),L=n(39041),R=n(18758),F=n(1134),M=n(24464),B=n(50481),U=n(13403),z=n(40389),H=n(23343),G=n(29336),V=n(34045),j=n(32854),q=n(72218),W=n(58651),Y=_.K.getInstance(),Q=A.B.getInstance(),J=(o=(0,i._)((function(){var e,t,n,o,i,s,l,h,m,E,w,P,_,A,k,O=arguments;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return e=O.length>0&&void 0!==O[0]?O[0]:null,t=O.length>1&&void 0!==O[1]&&O[1],n=O.length>2?O[2]:void 0,o=O.length>3?O[3]:void 0,i=O.length>4?O[4]:void 0,s=O.length>5?O[5]:void 0,h=y.t.getInstance().getChatRef(),r=(new Date).getTime(),v.R.getInstance().getState()!==f.Nj.IDLE&&d.G.getInstance().addContextId(g.dB),m=6,E=I._.getInstance().isCreateNewFromBlank()?"":"NonEmptyTemplateId",(0,p.PA)(p.IY.IsSendSlideMonikerEnabled)?[4,(0,F.Oc)(n)]:[3,2];case 1:return P=c.sent(),[3,3];case 2:P=void 0,c.label=3;case 3:return w=P,[4,(0,F.Oc)(n,s)];case 4:return _=c.sent(),A=Object.assign(new S.eX,{prompt:null!==e?e:"",numSlides:m,contextId:g.dB,groundingData:o,chatConversations:i,debugParams:{debugMetadataEnabled:!0,outlinePromptTemplate:"instructions3PlusWithOutline"},settingParams:{textToImageEnabled:!1,hubbleEnabled:!0,hubbleAggregateApiEnabled:!0,templateId:E,fCreateJsonCmdList:(0,p.PA)(p.IY.UseStoryTellerJsonCmdEnabled),entryPoint:q.$kB.Chat},fAddSlidesToExistingPres:t,outputLanguage:N.U9,selectedSlide:w,after:_,jsonCmdApiVersion:V.Vv.getSettingAsString(V.zj.PPTJsonCmdAPIVersion)}),k=new u.Xr({parentPath:["Signal",S.eX.getTypeName()],items:[{id:T.r.generateId(),body:A}]}),v.R.getInstance().getState()===f.Nj.IDLE||(null===(l=h.current)||void 0===l||l.submitOperation({operation:k,workflowAnnotationType:C._t.getTypeName()}),Q.sendChatEventTelemetry((0,b.pN)((0,a._)({},x.h3.ChatEventType,x.a5.StoryTellerOperationSubmitted))),v.R.getInstance().setState(f.Nj.WAITING_FOR_STORY_TELLER_WF_RESPONSE)),[2]}}))})),function(){return o.apply(this,arguments)}),X=function(){var e=(0,i._)((function(e,t,n,o,u,y,S){var T,I,_,A,V,W,J,X,Z,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be,Ee,Te,we,Ie,Pe,_e,Ae,ke,xe,Ne,Oe,De,Le,Re;return(0,c.__generator)(this,(function(Fe){switch(Fe.label){case 0:if((0,R.cY)("".concat(C._t.getTypeName()," response received\n Time Taken: ").concat((0,g.WU)(r),"s ")),v.R.getInstance().getState()===f.Nj.IDLE)return(0,R.cY)("CopilotODSLAnnotationProcessor: ExecutionStateManager is in IDLE state. Returning"),[2];Y.setResponseTime((0,g.WU)(g.qD)),v.R.getInstance().setState(f.Nj.EXECUTING),T=e.body,I=null==T?void 0:T.slides,_=null==T?void 0:T.after,A=null==T?void 0:T.presentationOutline,V=null==T?void 0:T.imageTelemetry,W=null==T?void 0:T.status,J=null==T?void 0:T.designerOptions,X=null==T?void 0:T.selectionOptions,Z=null==T?void 0:T.fAddSlidesToExistingPres,$=Z?E.Cu.AddSlide:E.Cu.CreatePresentation,ee=null==T?void 0:T.additionalSystemMetadataInfo,te=null==T?void 0:T.jsonCmdPayload;try{ne=(0,p.PA)(p.IY.LogTimeToIntentDetectionDuration)?JSON.stringify({STAdditionalInfo:ee,TimeToIntentDetection:Y.getTimeToIntentDetection(),TimeToIntentDetectionOverTheWireTime:Y.getTimeToIntentDetectionOverTheWireTime()}):JSON.stringify({STAdditionalInfo:ee})}catch(e){(0,R.cY)("Parsing additionalInfo failed")}return re={status:f.rI.SUCCESS},oe=!0,ie=[],void 0!==T.contextId&&(0,b.Zp)(T.contextId),ae=Q.getQueryGuid(),se=Q.getConversationId(),(0,b.$j)(Q,C._t.getTypeName(),r,x.CT.StoryTellerWorkflowResponseTime,(0,L.hX)(A)?x.CC.AddSlide:x.CC.CreatePresentation,S),(0,p.PA)(p.IY.StorytellerLogDebugDataEnabled)&&(le=null==T?void 0:T.debugMetadata,(0,L.hX)(le)||(0,R.cY)("Storyteller debugData: ".concat(JSON.stringify(le)))),(0,p.PA)(p.IY.ShouldStorytellerSetScenarioFromAddSlideParam)?(Y.setScenarioName($),G.r.getInstance().setSkillName($===E.Cu.AddSlide?f.B2.AddSlide:f.B2.CreatePresentation)):Y.setScenarioName((0,L.hX)(A)?E.Cu.AddSlide:E.Cu.CreatePresentation),ce=new w.DA({status:P.Aw.failed,queryId:ae,error:void 0}),W.code===h.lC.Success?[3,4]:((0,R.cY)("Error from Storyteller WF status code : ".concat(W.code,"\n error response : ").concat(W.errorMessage)),ue=(0,k.R)(t,$,W.code,W.errorMessage,ce,!(0,B.w_)()),(0,b.AQ)(Q,g.qD,"".concat(C._t.getTypeName(),"_Error"),h.lC[W.code],f.T_.Server,void 0,!(0,B.w_)(),ue),(0,B.gj)()?[3,1]:(v.R.getInstance().setState(f.Nj.IDLE),d.G.getInstance().emptyContextIdListandCleanup(),[3,3]));case 1:return[4,(0,B.Ge)(ce,t)];case 2:Fe.sent(),Fe.label=3;case 3:return(0,H.k)(!1,"StoryTellerWorkflow_".concat(h.lC[W.code]),Y.getScenarioName(),ne),Y.resetData(),[2];case 4:if(de=(new Date).getTime(),(0,p.PA)(p.IY.UseStoryTellerJsonCmdEnabled)&&te?(ie=te.cmds,(0,R.cY)("JSON commands generated from Augloop")):(0,L.hX)(A)?(0,L.hX)(I)?((0,R.cY)("Response is undefined"),re={status:f.rI.FAILED}):(oe=!1,fe={name:E._u.AddSlidesCmd,version:E.xv,data:{slides:I}},ie.push(fe)):(pe={name:E._u.CreatePresentationCmd,version:E.xv,data:A},ie.push(pe)),!(ie.length>0))return[3,9];he={},ge=(0,p.PA)(p.IY.LogQuerySubmitTime)?{scenarioName:Y.getScenarioName(),startTime:Y.getStartTime(),entryPoint:q.$kB.Chat,correlationId:ae,conversationId:se,timeToODSLMS:1e3*Y.getResponseTime(),timeODSLToJOfcMS:0,capability:Y.getCapability(),featureName:Y.getFeatureName(),subFeatureName:Y.getSubFeatureName(),querySubmitTime:g.qD,additionalSystemMetadataInfo:ne}:{scenarioName:Y.getScenarioName(),startTime:Y.getStartTime(),entryPoint:q.$kB.Chat,correlationId:ae,conversationId:se,timeToODSLMS:1e3*Y.getResponseTime(),timeODSLToJOfcMS:0,capability:Y.getCapability(),featureName:Y.getFeatureName(),subFeatureName:Y.getSubFeatureName(),additionalSystemMetadataInfo:ne},he.scenarioOptions=JSON.stringify(ge),(0,R.cY)("scenarioOptions : ",JSON.stringify(ge)),(0,L.hX)(J)||(he.designerOptions=JSON.stringify(J)),(0,L.hX)(X)||(he.selectionOptions=JSON.stringify(X)),Fe.label=5;case 5:return Fe.trys.push([5,7,,8]),(0,z.dD)()?o(!0):o(!1),[4,PowerPoint.run(function(){var e=(0,i._)((function(e){var t,n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,(0,F.q0)(e)];case 1:return t=o.sent(),ie[0].name!==E._u.AddSlidesCmd||0===t.length?[3,4]:(n=_,(0,L.hX)(n)?[4,(0,F.o2)(e,t)]:[3,3]);case 2:r=o.sent().split("#"),n={type:E.kk.Slide,id:+r[0],cId:+r[1]},o.label=3;case 3:ie[0].after=n,o.label=4;case 4:return[4,(0,O.Rf)(e,ie,he)];case 5:return re=o.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 6:return Fe.sent(),(0,R.cY)("log result : ",JSON.stringify(re)),[3,8];case 7:return me=Fe.sent(),(0,R.cY)("Execution failed"+JSON.stringify(me)),re={status:f.rI.FAILED,error:f.Re.JOFC_EXCEPTION},[3,8];case 8:return(0,p.PA)(p.IY.IsJofcCommandErrorTelemetryEnabled)&&re.status!==f.rI.SUCCESS&&Q.sendChatEventTelemetry((0,b.pN)((ve={},(0,a._)(ve,x.h3.ChatEventType,x.a5.StoryTellerJOfcCommandsError),(0,a._)(ve,x.h3.ChatEventParameters,f.Re[null!==(ye=re.error)&&void 0!==ye?ye:f.Re.UNKNOWN_ERROR]),ve))),[3,10];case 9:(0,H.k)(!1,"StoryTellerWorkflow_NoCmdsGenerated",Y.getScenarioName(),ne),Fe.label=10;case 10:switch(Q.sendLatencyTelemetry((0,b.pN)((0,a._)({},x.CT.QueryExecutionTime,(0,g.WU)(de)))),Se=N.Lo.length>0&&""!==N.Lo[0]&&(0,L._r)(N.U9),Ce=!(!(0,p.PA)(p.IY.ShouldReturnCustomStringForNoTopic)||!W.isNoTopicPresentation)&&!(0,L.hX)(A),re.status){case f.rI.BLOCKED:case f.rI.UNSUPPORTED:case f.rI.FAILED:case f.rI.UNEXPECTED_VERSION:case f.rI.USER_ABORTED:case f.rI.PARTIAL_SUCCESS:return[3,11];case f.rI.SUCCESS:return[3,12]}return[3,14];case 11:return be=void 0,(0,p.PA)(p.IY.IsUpdatedCannedStringsEnabled)&&Ce&&re.status==f.rI.PARTIAL_SUCCESS&&(be=PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateMessageNew+"\n\n"+PowerpointCopilotStrings.StorytellerNoTopicAutoGeneratePartialMessage),(0,U.af)(re,t,y,C._t.getTypeName(),ce,!(0,B.w_)(),be),[3,14];case 12:return ce.status=P.Aw.success,[4,(0,B.Yb)(f.rI.SUCCESS)];case 13:if(Fe.sent(),Ee={linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseContentCreationLine1Option1,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseAddSlideLine2},oe||(Ee.linkPrefix=PowerpointCopilotStrings.AssistantResponseAddSlidePrefix),Se&&(Ee.linkPrefix=N.Lo.filter((function(e){return e})).join(" ")+" "),(0,L.hX)(A)||u(),Te=!(0,B.w_)(),we={},we=(0,p.PA)(p.IY.GetUserPresentationDetails)&&(null==ie?void 0:ie.length)&&ie[0].name===E._u.CreatePresentationCmd?K(V,ie,Y.getFeatureName()):{featureName:Y.getFeatureName()},Ce)(0,p.PA)(p.IY.IsUpdatedCannedStringsEnabled)?null===(Ie=t.current)||void 0===Ie||Ie.addResponseMessage((0,M.qi)(PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateMessageNew+"\n\n"+PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateSecondLineMessage,M.tc,Te,f.Xw.CHATPPT,void 0,!1,!0,void 0,we)):null===(Pe=t.current)||void 0===Pe||Pe.addResponseMessage((0,M.qi)(PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateMessage,M.tc,Te,f.Xw.CHATPPT,void 0,!1,!0,void 0,we));else{if(_e=[],(0,p.PA)(p.IY.IsNERBlockingUIEnabled))try{Ae=null==T?void 0:T.featuresDataDictionary,void 0!==(ke=null==Ae?void 0:Ae.NERDroppedSlideIndices)&&""!==ke&&(xe=ke.split(","),Ne=xe.map(Number),Oe=Ne.map((function(e){return e+1})),_e=Oe.map(String).sort())}catch(e){(0,R.cY)("StoryTellerAnnotationHandler - error parsing nerDroppedSlideIndicesArray: ".concat(e))}(0,p.PA)(p.IY.IsNERBlockingUIEnabled)&&_e.length>0?null===(De=t.current)||void 0===De||De.addResponseMessage({chatCardType:m._.SlideLinksCard,chatMessageData:{slideLinksCardProps:{user:"chat",aIExplanationMessage:Se?N.Lo.filter((function(e){return e})).join(" "):"",slideIndices:_e,handleSlideLinkClicked:function(){var e=(0,i._)((function(e){var t,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:t=e-1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,i._)((function(e){var n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return(n=e.presentation.slides).load("items, items/id"),[4,e.sync()];case 1:return o.sent(),t>=0&&t<n.items.length?(void 0!==(r=n.items[t].id)&&e.presentation.setSelectedSlides([r]),[4,e.sync()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),(0,R.cY)("StoryTellerAnnotationHandler::SlideLinksCard failed to select slide link for index: "+t+" error :"+n),[3,4];case 4:return[2,Promise.resolve((0,R.cY)("StoryTellerAnnotationHandler::SlideLinksCard slide link clicked"))]}}))}));return function(t){return e.apply(this,arguments)}}()}},chatMessageBodyData:(0,l._)((0,s._)({},M.tc),{feedbackData:(0,j.as)(f.Xw.CHATPPT,we),telemetryData:(0,j.YI)(void 0,void 0)}),stopLoadingUi:Te}):null===(Le=t.current)||void 0===Le||Le.addResponseMessage((0,M.FL)(Ee,n,void 0,M.tc,Te,f.Xw.CHATPPT,void 0,void 0,we))}return Q.sendChatEventTelemetry((0,b.pN)((Re={},(0,a._)(Re,x.h3.ChatEventType,x.a5.QuerySuccessful),(0,a._)(Re,x.h3.ChatEventParameters,C._t.getTypeName()),Re))),(0,b.AQ)(Q,g.qD,void 0,void 0,void 0,void 0,Te),[3,14];case 14:return Y.resetData(),(0,B.gj)()?[3,15]:(v.R.getInstance().setState(f.Nj.IDLE),d.G.getInstance().emptyContextIdListandCleanup(),[3,17]);case 15:return[4,(0,B.Ge)(ce,t)];case 16:Fe.sent(),Fe.label=17;case 17:return[4,(0,D.Ep)(t)];case 18:return Fe.sent(),[2]}}))}));return function(t,n,r,o,i,a,s){return e.apply(this,arguments)}}(),K=function(e,t,n){try{if(!(null==e?void 0:e.length)||!(null==t?void 0:t.length))return{featureName:n};var r=JSON.parse(e),o=JSON.stringify(t),i=!0,a=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;if(null==u?void 0:u.imageResults){var d=!0,p=!1,f=void 0;try{for(var h,g=u.imageResults[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value,y=!0,v=!1,S=void 0;try{for(var C,b=m.images[Symbol.iterator]();!(y=(C=b.next()).done);y=!0){var E=C.value,T=E.url;T&&(E.url="",o=o.replace(T,""))}}catch(e){v=!0,S=e}finally{try{y||null==b.return||b.return()}finally{if(v)throw S}}}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}}}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return{featureName:n,featureContent:Z(o),featureAdditionalTelemetry:Z(JSON.stringify(r))}}catch(e){throw W.error("Error in getOCVContextData: ",e),e}},Z=function(e){var t=(new DOMParser).parseFromString(e,"text/html").body.textContent||"";return JSON.parse(t.trim())}},29862:(e,t,n)=>{"use strict";n.d(t,{LE:()=>$,Mv:()=>q,NY:()=>J,R1:()=>ie,So:()=>W,UP:()=>X,hi:()=>Z,lM:()=>te,lb:()=>oe});var r,o=n(43032),i=n(90813),a=n(57835),s=n(61838),l=n(79490),c=n(53154),u=n(55564),d=n(39726),p=n(69038),f=n(85535),h=n(10229),g=n(48544),m=n(24643),y=n(93176),v=n(73606),S=n(8349),C=n(17235),b=n(72218),E=n(44121),T=n(29336),w=n(14213),I=n(44632),P=n(12542),_=n(18758),A=n(24464),k=n(32854),x=n(44001),N=n(39041),O=n(50481),D=n(48694),L=n(18384),R=n(5851),F=n(23343),M=n(89375),B=n(21659),U=!0,z=[],H=new Map,G=w.K.getInstance(),V=I.B.getInstance(),j=[],q=!1,W=!1,Y=!1,Q=!1,J=!1,X=(r=(0,o._)((function(e,t,n,r){var o,a,s,c,h,g,m,y,v,C,w,I,k,x,R;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return o=null==e?void 0:e.body,a=null==o?void 0:o.intent,s=null==o?void 0:o.summary,c=null==o?void 0:o.error,Q=null==o?void 0:o.isVisual,J=null==o?void 0:o.analyzingVisuals,h=null==o?void 0:o.chatMessageHeader,(0,_.cY)("".concat(S.SB.getTypeName()," response. Time Taken : ").concat((0,p.WU)(p.qD)," sec \n, intent: ").concat(a," \n, Summary : ").concat(s)),void 0!==o.queryId&&(G.setUserQueryGuid(o.queryId),(0,L.Zp)(o.queryId)),W=!0,U&&(V.logTriedEvent(E.SD.Summarize,(0,D.wW)(a),f.RX.Summarize),T.r.getInstance().setSkillName(d.B2.Summary),(0,u.PA)(u.IY.IsScenarioErrorTelemetryEnabled)&&G.setScenarioName(E.Cu.Summary),V.sendLatencyTelemetry((0,L.pN)((g={},(0,i._)(g,P.CT.UserPerceivedLatency,(0,p.WU)(p.qD)),(0,i._)(g,P.CT.AnnotationType,S.SB.getTypeName()),(0,i._)(g,P.CT.FeatureName,P.CC.Summary),g)))),V.sendChatEventTelemetry((0,L.pN)((m={},(0,i._)(m,P.h3.ChatEventType,P.a5.ResponseReceivedFromAL),(0,i._)(m,P.h3.ChatEventParameters,S.SB.getTypeName()),(0,i._)(m,P.h3.Cv,null!=r?r:""),m))),V.sendChatEventTelemetry((0,L.pN)((y={},(0,i._)(y,P.h3.ChatEventType,P.a5.SummaryIntentDetectedFromAL),(0,i._)(y,P.h3.ChatEventParameters,a),y))),j.push({augloopResponseTime:(0,p.WU)(p.qD)}),v=!(0,O.w_)(),void 0!==(null==c?void 0:c.category)?(U||K(t,ae(A.OT,!0),!0,h),C=(0,M.z)(c,a,t,v),w=C.errorCode,I=C.errorKey,(0,L.Lu)(V,p.qD,P.CT.SummaryResponseTime,P.CT.SummaryChunkInfo,j,P.S2.Summary,"".concat(S.SB.getTypeName(),"_Error"),c.category.concat((0,N.jw)(w)?b.u1i:"_".concat(w)),d.T_.Server,v,void 0,void 0,I),Z(),G.setResponseTime((0,p.WU)(p.qD)),(0,F.k)(!1,"SummaryStreamingWorkflow_".concat(c.category),E.Cu.Summary),[2]):[4,ee(s,a,n,t)];case 1:return k=l.sent(),x=k.result,R=k.errorKey,x||((0,L.Lu)(V,p.qD,P.CT.SummaryResponseTime,P.CT.SummaryChunkInfo,j,P.S2.Summary,"".concat(S.SB.getTypeName(),"_Error"),"IncorrectResponse",d.T_.Server,v,void 0,void 0,R),G.setResponseTime((0,p.WU)(p.qD)),Z(),(0,F.k)(!1,"SummaryStreamingWorkflow_IncorrectResponse",E.Cu.Summary)),[2]}}))})),function(e,t,n,o){return r.apply(this,arguments)}),K=function(e,t,n,r,o){var i,l,c;if(t.chatMessageBodyData=(0,s._)((0,a._)({},t.chatMessageBodyData),{chatMessageHeaderData:(0,A.Ne)(o),feedbackSectionPosition:h.O.Footer,feedbackData:(0,k.as)(d.Xw.DECKSUMMARY,r),clpSensitivityIndicatorData:(null===(i=v.n.getInstance())||void 0===i?void 0:i.shouldShowInDocSensitivityLabel())?(0,x.ny)():void 0,telemetryData:JSON.stringify({correlationId:V.getQueryGuid(),featureName:E.SD.Summarize,subFeatureName:Q?P.Ff.VisualSummary:P.Ff.Summarize})}),n){var u;t.chatMessageBodyData=(0,s._)((0,a._)({},t.chatMessageBodyData),{actionButtonList:(null!==(u=t.chatMessageBodyData.actionButtonList)&&void 0!==u?u:[]).concat((0,A.y_)())}),t.addCardToChatHistory=!0,t.stopLoadingUi=!(0,O.w_)(),q=!0,t.startAugloopTimerForStreaming=!1}else{var p;if(Y)t.chatMessageBodyData=(0,s._)((0,a._)({},t.chatMessageBodyData),{actionButtonList:(null!==(p=t.chatMessageBodyData.actionButtonList)&&void 0!==p?p:[]).concat((0,A.y_)())}),t.addCardToChatHistory=!0;else t.addCardToChatHistory=!1;t.startAugloopTimerForStreaming=!0,t.workflowAnnotationTypeForAugloopTimer=S.SB.getTypeName()}(r&&(t.chatMessageBodyData=(0,s._)((0,a._)({},t.chatMessageBodyData),{feedbackData:(0,k.as)(void 0,r)})),U)?(null===(l=e.current)||void 0===l||l.addResponseMessage(t),U=!1):null===(c=e.current)||void 0===c||c.updateLastMessage(t)},Z=function(){z=[],j=[],U=!0,q=!1,W=!1,Y=!1,(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(Q=!1,J=!1)},$=function(e){var t;return(0,u.PA)(u.IY.IsCitationsEnabled)&&e.citations&&(null===(t=e.citations)||void 0===t?void 0:t.length)>0},ee=function(){var e=(0,o._)((function(e,t,n,r){var o,c,f,h,g,m,y,v,S,T,w,I,x,N,D,R,F,M,H,G,q,W,Y,J,X,ee,ne,re,oe,ie,ae,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be,Ee,Te,we,Ie,Pe,_e,Ae=arguments;return(0,l.__generator)(this,(function(l){o=Ae.length>4&&void 0!==Ae[4]&&Ae[4],c=Ae.length>5?Ae[5]:void 0,(0,_.cY)("parseSummary called ".concat(e," intent: ").concat(t," deckTokenCount ").concat(n," isStreamEnd ").concat(o)),f=[],h={featureName:P.CC.Summary,subFeatureName:(0,k.AN)(t)&&se()?P.Ff.VisualSummary:P.Ff.Summarize};try{f=JSON.parse(e)}catch(e){return(0,_.cY)("Error in parsing summary response",e.message),Z(),m=(0,s._)((0,a._)({},h),{errorMessage:PowerpointCopilotStrings.ErrorRequestTimedOut,errorType:d.Qp.SummaryErrorRequestTimedOut}),null===(g=r.current)||void 0===g||g.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.ErrorRequestTimedOut,A.OT,!0,d.Xw.CHATPPT,void 0,!1,!0,void 0,m)),V.sendErrorTelemetry((0,L.pN)((y={},(0,i._)(y,P.IC.ErrorMessage,"Error parsing summary response, ".concat(e.message)),(0,i._)(y,P.IC.ErrorCategory,P.S2.Summary),y))),[2,{result:!1,errorKey:P.Nr.ErrorRequestTimedOut}]}if(v=[],t===C.N.Summary||t===C.N.SegmentedSummary||t===C.N.StyledSummary){S=!0,T=!1,w=void 0;try{for(I=f[Symbol.iterator]();!(S=(x=I.next()).done);S=!0)N=x.value,(D={title:"",text:""}).title=N.topic+": ",D.text=$(N)?te(N.keyPoint,v,N.citations):N.keyPoint,z.push(D)}catch(e){T=!0,w=e}finally{try{S||null==I.return||I.return()}finally{if(T)throw w}}R=(0,A.Wm)(z,(0,u.bw)(u.WT.IsVisualSummaryUIEnabled)&&(0,k.AN)(t)&&se()?b.f4e:PowerpointCopilotStrings.AssistantResponseSummarizePrefix,(0,u.bw)(u.WT.IsVisualSummaryUIEnabled)&&(0,k.AN)(t)&&se()?PowerpointCopilotStrings.AssistantResponseSummarizeSuffix:(0,u.bw)(u.WT.IsVisualSummaryUIEnabled)&&(0,k.AN)(t)&&le()?b.Fhl:PowerpointCopilotStrings.AssistantResponseSummarizeSuffix,PowerpointCopilotStrings.SummaryMainIdeas,(0,s._)((0,a._)({},A.tc),{chatMessageHeaderData:(0,A.Ne)(c)}),!1,d.Xw.DECKSUMMARY,E.SD.Summarize,(0,k.AN)(t)&&se()?P.Ff.VisualSummary:P.Ff.Summarize,h),t!==C.N.SegmentedSummary&&t!==C.N.StyledSummary||!U||(h.subFeatureName=t===C.N.SegmentedSummary?P.Ff.SegmentedSummary:P.Ff.StyledSummary,M=(0,s._)((0,a._)({},h),{errorMessage:PowerpointCopilotStrings.UnsupportedSummaryError,errorType:d.Qp.SummaryUnsupportedSummaryError}),null===(F=r.current)||void 0===F||F.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.UnsupportedSummaryError,A.tc,!1,d.Xw.DECKSUMMARY,void 0,!1,!0,void 0,M))),n>(0,B.Wo)()&&U&&(G=(0,s._)((0,a._)({},h),{errorMessage:PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",(0,B.Wo)().toString()),errorType:d.Qp.TooLargeContentToSummarizeError}),null===(H=r.current)||void 0===H||H.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",(0,B.Wo)().toString()),A.tc,!1,d.Xw.DECKSUMMARY,void 0,!1,!0,void 0,G)),V.sendErrorTelemetry((0,L.pN)((q={},(0,i._)(q,P.IC.ErrorMessage,"Word Count does not meet max bar requirement"),(0,i._)(q,P.IC.ErrorCategory,P.S2.Summary),q))),V.sendChatEventTelemetry((0,L.pN)((W={},(0,i._)(W,P.h3.ChatEventType,P.a5.MoreWordCount),(0,i._)(W,P.h3.ChatEventParameters,"WordCountError"),(0,i._)(W,P.h3.ChatErrorKey,P.Nr.DeckTooLargeToSummarizeError),W)))),v.length>0&&(R.chatMessageBodyData=(0,s._)((0,a._)({},R.chatMessageBodyData),{references:v})),K(r,R,o,h,c)}else if(t===C.N.CallsForAction){Y={listItems:[],listHeader:""},J=[],X=[],ee=!0,ne=!1,re=void 0;try{for(oe=f[Symbol.iterator]();!(ee=(ie=oe.next()).done);ee=!0)ae=ie.value,ce=ae.action,$(ae)&&(ce=te(ce,v,ae.citations)),"inferred"===(ue=ae.source)?X.push({text:ce}):"explicit"===ue&&J.push({text:ce}),z.push({text:ce})}catch(e){ne=!0,re=e}finally{try{ee||null==oe.return||oe.return()}finally{if(ne)throw re}}if(J.length>0)Y.listHeader=PowerpointCopilotStrings.SummaryActionItems;else{if(!(X.length>0))return pe=(0,s._)((0,a._)({},h),{errorMessage:PowerpointCopilotStrings.SummaryNoActionItemsIdentified,errorType:d.Qp.SummaryNoActionItemsIdentified}),null===(de=r.current)||void 0===de||de.addResponseMessage((0,A.qi)(PowerpointCopilotStrings.SummaryNoActionItemsIdentified,A.tc,!1,d.Xw.DECKSUMMARY,void 0,!1,!0,void 0,pe)),V.sendChatEventTelemetry((0,L.pN)((fe={},(0,i._)(fe,P.h3.ChatEventType,P.a5.CallsToActionResponseShown),(0,i._)(fe,P.h3.ChatEventParameters,"NO_ACTION_ITEMS"),(0,i._)(fe,P.h3.ChatErrorKey,P.Nr.SummaryNoActionItemsIdentified),fe))),[2,{result:!0,errorKey:void 0}];Y.listHeader=PowerpointCopilotStrings.SummaryActionItemsInferred}K(r,(0,A.Wm)(z,void 0,void 0,Y.listHeader,(0,s._)((0,a._)({},A.tc),{references:v}),!1,d.Xw.DECKSUMMARY,void 0,void 0,h),o,void 0,c)}else if(t===C.N.ImportantSlides){he=!0,ge=!1,me=void 0;try{for(ye=f[Symbol.iterator]();!(he=(ve=ye.next()).done);he=!0)Se=ve.value,(Ce={text:"",title:""}).title=Se.slideTitle+": ",Ce.text="".concat(PowerpointCopilotStrings.AssistantResponseSlide," ").concat(Se.slideNumber),z.push(Ce)}catch(e){ge=!0,me=e}finally{try{he||null==ye.return||ye.return()}finally{if(ge)throw me}}be=(0,A.Wm)(z,PowerpointCopilotStrings.SummaryImportantSlides,void 0,void 0,(0,a._)({},A.tc),!1,d.Xw.DECKSUMMARY,void 0,void 0,h);try{o&&(0,u.bw)(u.WT.IsCopilotPlayKeySlidesEnabled)&&(void 0===be.chatMessageBodyData&&(be.chatMessageBodyData={}),void 0===be.chatMessageBodyData.actionButtonList&&(be.chatMessageBodyData=(0,s._)((0,a._)({},be.chatMessageBodyData),{actionButtonList:[]})),(Ee=(0,A.rz)(e))&&(null===(Te=be.chatMessageBodyData.actionButtonList)||void 0===Te||Te.push(Ee),V.sendChatEventTelemetry((0,L.pN)((we={},(0,i._)(we,P.h3.ChatEventType,P.a5.PlayKeySlidesButtonAdded),(0,i._)(we,P.h3.ChatEventParameters,JSON.stringify({handler:"SummaryStreamingAnnotationHandler"})),we)))))}catch(e){(0,_.cY)("Failed to add PlayKeySlides button: "+(null==e?void 0:e.message)),V.sendErrorTelemetry((0,L.pN)((Ie={},(0,i._)(Ie,P.IC.ErrorMessage,"Exception while adding PlayKeySlides button from Summary Streaming: "+(null==e?void 0:e.message)),(0,i._)(Ie,P.IC.ErrorCategory,P.S2.PlayKeySlides),Ie)))}K(r,be,o,void 0,c)}return v.length>0&&V.sendChatEventTelemetry((0,L.pN)((Pe={},(0,i._)(Pe,P.h3.ChatEventType,P.a5.CitationReceived),(0,i._)(Pe,P.h3.ChatEventParameters,v.length),Pe))),o&&(_e=!(0,O.w_)(),(0,L.Lu)(V,p.qD,Q?P.CT.VisualSummaryResponseTime:P.CT.SummaryResponseTime,P.CT.SummaryChunkInfo,j,P.S2.Summary,void 0,void 0,void 0,_e)),[2,{result:!0,errorKey:void 0}]}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),te=function(e,t,n){var r=e.toString();if(n.length>0)try{n.sort((function(e,t){return e.position-t.position}));var o=0,a=!0,s=!1,l=void 0;try{for(var c,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value,p="%c"+d.contentIndex.toString()+"%c";r=r.slice(0,d.position+o)+p+r.slice(d.position+o),o+=p.length,t.push(ne(d))}}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}}catch(n){var f;return(0,_.cY)("Error in parsing citations in summary response",n.message),t=[],V.sendErrorTelemetry((0,L.pN)((f={},(0,i._)(f,P.IC.ErrorMessage,"Error parsing citations in summary response, ".concat(n.message)),(0,i._)(f,P.IC.ErrorCategory,P.S2.Summary),f))),e}return r},ne=function(e){H.set(e.contentIndex,e.path);var t=v.n.getInstance();return{referenceIndex:e.contentIndex,referenceProps:{title:'"'+(e.content.length>18?e.content.slice(0,18).trim():e.content)+b.GrL+'"',primarySubtitle:(0,b.t28)(),snippet:(0,k.KN)(e.content),referenceType:g._2.Internal,path:e.path,iconAppName:e.type,onClickCitationLink:re,sensitivityLabel:t.shouldShowInDocSensitivityLabel()?t.getInDocSensitiveLabelInfo().displayName:void 0}}},re=function(){var e=(0,o._)((function(e,t,n){var r,o,a,s,c;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return r=P.Ff.Unset,n&&(o=(0,k.zq)(n),a=o.correlationId,o.featureName,(s=o.subFeatureName)&&(r=s),void 0!==a&&V.setQueryGuid(a)),V.sendChatEventTelemetry((0,L.pN)((c={},(0,i._)(c,P.h3.ChatEventType,P.a5.CitationClicked),(0,i._)(c,P.h3.ChatEventParameters,r),c))),n&&V.setQueryGuid(""),t=null!=t?t:H.get(e),[4,(0,k.P3)(t)];case 1:return l.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),oe=function(e){var t;!U&&z.length>0&&(K(e,ae(A.OT,!0),!0),Z()),V.sendChatEventTelemetry((0,L.pN)((t={},(0,i._)(t,P.h3.ChatEventType,P.a5.SummaryStreamingResponseTimeout),(0,i._)(t,P.h3.ChatEventParameters,"SummaryStreamingResponseTimeout"),(0,i._)(t,P.h3.ChatErrorType,d.T_.Server),t)))},ie=function(){var e=(0,o._)((function(e,t,n,r,o,s,h){var g,y,v,w,I,x,B,q,W,X,K,$,te,ne,re,oe,ie,ae,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return g=null==e?void 0:e.body,y=null==g?void 0:g.summary,v=null==g?void 0:g.intent,w=null==g?void 0:g.error,Q=null!==(I=null==g?void 0:g.isVisual)&&void 0!==I&&I,J=null!==(x=null==g?void 0:g.analyzingVisuals)&&void 0!==x&&x,q=null!==(B=null==g?void 0:g.chatMessageHeader)&&void 0!==B?B:void 0,void 0!==(null==g?void 0:g.queryId)&&((0,O.w_)()||(!(0,u.bw)(u.WT.IsVisualSummaryUIEnabled)||(0,k.AN)(v)&&se()||!(0,k.AN)(v))&&c.G.getInstance().removeContextId(null==g?void 0:g.queryId),G.setUserQueryGuid(g.queryId),(0,L.Zp)(g.queryId)),(null==g?void 0:g.fromCache)&&V.sendLatencyTelemetry((0,L.pN)((0,i._)({},P.CT.IsFromCache,!0))),U&&(V.logTriedEvent(E.SD.Summarize,(0,D.wW)(v),f.RX.Summarize),T.r.getInstance().setSkillName(d.B2.Summary),(0,u.PA)(u.IY.IsScenarioErrorTelemetryEnabled)&&G.setScenarioName(E.Cu.Summary),V.sendLatencyTelemetry((0,L.pN)((W={},(0,i._)(W,P.CT.UserPerceivedLatency,(0,p.WU)(p.qD)),(0,i._)(W,P.CT.AnnotationType,S.SB.getTypeName()),(0,i._)(W,P.CT.FeatureName,P.CC.Summary),W)))),(0,_.cY)("".concat(S.kb.getTypeName()," response. Time Taken : ").concat((0,p.WU)(p.qD)," sec \n, intent: ").concat(v," \n, Summary : ").concat(y," \n, Error : ").concat(JSON.stringify(w))),X=!(0,O.w_)(),K=!(!(0,k.AN)(v)||!se())||!((0,k.AN)(v)&&le()),Y=!0,(0,u.bw)(u.WT.IsDebugSectionV2Enabled)&&((0,O.K2)(S.kb.getTypeName(),(0,p.WU)(p.qD),!1,null==g?void 0:g.status),(0,O.vE)(g,p.qD,void 0,!0,!0),$=(0,a._)({},O.pq),O.gK.push($),h()),void 0!==(null==w?void 0:w.category)?(te=(0,M.z)(w,v,t,!(0,O.w_)()),ne=te.errorCode,re=te.errorKey,(0,L.Lu)(V,p.qD,Q?P.CT.VisualSummaryResponseTime:P.CT.SummaryResponseTime,P.CT.SummaryChunkInfo,j,P.S2.Summary,"".concat(S.kb.getTypeName(),"_Error"),w.category.concat((0,N.jw)(ne)?b.u1i:"_".concat(ne)),d.T_.Server,X,void 0,void 0,re),Z(K),G.setResponseTime((0,p.WU)(p.qD)),(0,F.k)(!1,"SummaryStreamingWorkflow_".concat(w.category),E.Cu.Summary),[2]):(V.sendChatEventTelemetry((0,L.pN)((ce={},(0,i._)(ce,P.h3.ChatEventType,P.a5.ResponseReceivedFromAL),(0,i._)(ce,P.h3.ChatEventParameters,S.kb.getTypeName()),(0,i._)(ce,P.h3.IsFromCache,null!==(oe=null==g?void 0:g.fromCache)&&void 0!==oe&&oe),(0,i._)(ce,P.h3.IsVisual,null!==(ie=null==g?void 0:g.isVisual)&&void 0!==ie&&ie),(0,i._)(ce,P.h3.IsAnalyzingVisual,null!==(ae=null==g?void 0:g.analyzingVisuals)&&void 0!==ae&&ae),(0,i._)(ce,P.h3.Cv,null!=r?r:""),ce))),V.sendChatEventTelemetry((0,L.pN)((ue={},(0,i._)(ue,P.h3.ChatEventType,P.a5.SummaryIntentDetectedFromAL),(0,i._)(ue,P.h3.ChatEventParameters,v),ue))),z=[],H.clear(),K||V.sendLatencyTelemetry((0,L.pN)((0,i._)({},P.CT.SummaryResponseTime,(0,p.WU)(p.qD)))),[4,ee(y,v,n,t,K,q)]);case 1:switch(de=l.sent(),pe=de.result,fe=de.errorKey,(0,k.AN)(v)&&le()&&(null===(he=t.current)||void 0===he||he.updateLoadingComponentProps((0,a._)({loadingUiStringList:null!==(ge=(0,R.A)().get(d.Ae.PresentationSummaryWithVisual))&&void 0!==ge?ge:[]},(0,k.$2)()))),me=null,v){case C.N.CallsForAction:me=P.a5.CallsToActionResponseShown;break;case C.N.ImportantSlides:me=P.a5.ImportantSlidesResponseShown;break;case C.N.Summary:case C.N.SegmentedSummary:case C.N.StyledSummary:me=P.a5.SummaryResponseShown}return null!==me&&V.sendChatEventTelemetry((0,L.pN)((ye={},(0,i._)(ye,P.h3.ChatEventType,me),(0,i._)(ye,P.h3.UserQueryGuid,(null==g?void 0:g.queryId)||""),ye))),pe||(0,L.Lu)(V,p.qD,Q?P.CT.VisualSummaryResponseTime:P.CT.SummaryResponseTime,P.CT.SummaryChunkInfo,j,P.S2.Summary,"".concat(S.kb.getTypeName(),"_Error"),"IncorrectResponse",d.T_.Server,X,void 0,void 0,fe),(0,u.bw)(u.WT.IsDebugSectionV2Enabled)&&(null==(Se=null===(ve=t.current)||void 0===ve?void 0:ve.getLastMessage(!1))?void 0:Se.body.user)===m.Q9.Chat&&(be=null===(Ce=Se.actionBarButtons)||void 0===Ce?void 0:Ce.slice(),(0,O.w_)()||((0,A.FY)(be,O.pq,o,s),Se.actionBarButtons=be)),Z(K),G.setResponseTime((0,p.WU)(p.qD)),K&&(0,F.k)(pe,pe?void 0:"SummaryStreamingWorkflow_IncorrectResponse",E.Cu.Summary),[2]}}))}));return function(t,n,r,o,i,a,s){return e.apply(this,arguments)}}(),ae=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{chatCardType:y._.Default,chatMessageData:void 0,chatMessageBodyData:e,stopLoadingUi:t}},se=function(){return Q},le=function(){return!!(0,u.bw)(u.WT.IsVisualSummaryUIEnabled)&&J}},21659:(e,t,n)=>{"use strict";n.d(t,{Ep:()=>w,Wo:()=>E,ZT:()=>I,i$:()=>b});var r,o=n(43032),i=n(90813),a=n(79490),s=n(70825),l=n(69038),c=n(92087),u=n(65412),d=n(18384),p=n(66888),f=n(44632),h=n(98483),g=n(12542),m=n(18758),y=n(55564),v=f.B.getInstance(),S=50,C=2e4;function b(){return S}function E(){return C}var T,w=(T=(0,o._)((function(e){var t,n,o,l,f,S;return(0,a.__generator)(this,(function(a){return n=(0,h.A)(),o=(0,y.bw)(y.WT.ShouldCallPostSeedingPptInsights),l={allowedShapeTypes:[],queryId:n},f=o?new s.Xr({parentPath:["Signal",c.H.getTypeName()],items:[{id:p.r.generateId(),body:new c.H(l)}]}):new s.Xr({parentPath:["Signal",c._.getTypeName()],items:[{id:p.r.generateId(),body:new c._(l)}]}),r=(new Date).getTime(),null===(t=e.current)||void 0===t||t.submitOperation({operation:f,workflowAnnotationType:u.a.getTypeName()}),v.sendChatEventTelemetry((0,d.pN)((S={},(0,i._)(S,g.h3.ChatEventType,g.a5.WordCountOperationSubmitted),(0,i._)(S,g.h3.ChatEventParameters,"Post seeding Signal sent: ".concat(o)),(0,i._)(S,g.h3.UserQueryGuid,n),S))),(0,m.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(f)+"\nat Time : "+new Date+"\n\n\n"),[2]}))})),function(e){return T.apply(this,arguments)}),I=function(){var e=(0,o._)((function(e,t,n){var o,s,c,p,f,h,y,b,E,T,w;return(0,a.__generator)(this,(function(a){return o=null==e?void 0:e.body,s=null==o?void 0:o.error,c=null==o?void 0:o.wordNumber,p=null==o?void 0:o.numberOfTokens,f=null==o?void 0:o.minTokensRequiredToGenerateSummary,h=null==o?void 0:o.maxTokensRequiredToGenerateSummary,(0,d.$j)(v,u.a.getTypeName(),r,g.CT.WordCountResponseTime,g.CC.CopilotChat,n,void 0,!1),(0,m.cY)("".concat(u.a.getTypeName()," response. Time Taken : ").concat((0,l.WU)(r)," sec \n, WordCount : ").concat(c," , NumberOfTokens : ").concat(p,", minValue : ").concat(f,", maxValue : ").concat(h," \n\n\n")),void 0!==f?S=f:v.sendErrorTelemetry((0,d.pN)((y={},(0,i._)(y,g.IC.ErrorMessage,"Undefined minTokenValue received"),(0,i._)(y,g.IC.ErrorCategory,g.S2.WordCount),y))),void 0!==h?C=h:v.sendErrorTelemetry((0,d.pN)((b={},(0,i._)(b,g.IC.ErrorMessage,"Undefined maxTokenValue received"),(0,i._)(b,g.IC.ErrorCategory,g.S2.WordCount),b))),void 0!==(null==s?void 0:s.category)&&((0,m.cY)("Error detected in Word count annotation response: ".concat(s.category,", message : ").concat(s.message)),v.sendErrorTelemetry((0,d.pN)((E={},(0,i._)(E,g.IC.ErrorMessage,"".concat(s.category,"_").concat(s.message)),(0,i._)(E,g.IC.ErrorCategory,g.S2.WordCount),E)))),void 0!==p?(t(p),void 0!==f&&p<f&&v.sendChatEventTelemetry((0,d.pN)((T={},(0,i._)(T,g.h3.ChatEventType,g.a5.LessWordCount),(0,i._)(T,g.h3.ChatEventParameters,"Less Word Count than Min received"),T)))):v.sendErrorTelemetry((0,d.pN)((w={},(0,i._)(w,g.IC.ErrorMessage,"Undefined Word count received_".concat(null==s?void 0:s.message)),(0,i._)(w,g.IC.ErrorCategory,g.S2.WordCount),w))),[2]}))}));return function(t,n,r){return e.apply(this,arguments)}}()},73606:(e,t,n)=>{"use strict";n.d(t,{n:()=>T});var r=n(43032),o=n(11912),i=n(91165),a=n(90813),s=n(57835),l=n(61838),c=n(79490),u=n(48544),d=n(72218),p=n(2061),f=n(55564),h=n(18758),g=n(30325),m=n(39041),y=n(18384),v=n(98483),S=n(17223),C=n(32854),b=null,E=(0,v.A)(),T=function(){function e(){(0,o._)(this,e),(0,a._)(this,"setBasicChatProps",void 0),(0,a._)(this,"inDocLabelInfo",{labelId:d.u1i,tenantId:d.u1i}),(0,a._)(this,"externalDocLabelInfo",{labelId:d.u1i,tenantId:d.u1i}),this.inDocLabelInfo.labelId=d.u1i,this.inDocLabelInfo.tenantId=d.u1i,this.externalDocLabelInfo.labelId=d.u1i,this.externalDocLabelInfo.tenantId=d.u1i}return(0,i._)(e,[{key:"setInDocSensitiveLabelInfoUsingOfcJs",value:function(){var t=this;return(0,r._)((function(){var n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.setInDocSensitiveLabelInfoUsingOfcJs()];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return n=o.sent(),t.setInDocSensitivityLabelInfo(n),(0,y.Zy)("getLabel"),[3,4];case 3:return r=o.sent(),(0,y.mQ)("error in getLabel Api : ".concat(r.message)),r.code!==p.roB&&(0,y.oN)("getLabel"),(0,h.cY)("Error while fetching In Doc sensitivity label: ".concat(r.message)),[3,4];case 4:return[2]}}))}))()}},{key:"getInDocSensitiveLabelUsingOfcJs",value:function(){return(0,r._)((function(){var t,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.getInDocSensitiveLabelUsingOfcJs()];(0,h.cY)("Getting label"),t={labelId:d.u1i,tenantId:d.u1i},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return t=r.sent(),(0,y.Zy)("getLabel"),[3,4];case 3:return n=r.sent(),(0,y.mQ)("error in getLabel Api : ".concat(n.message)),n.code!==p.roB&&(0,y.oN)("getLabel"),(0,h.cY)("Error while fetching In Doc sensitivity label: ".concat(n.message)),[3,4];case 4:return(0,h.cY)("Label is : ",t),[2,t]}}))}))()}},{key:"setInDocSensitivityLabelInfo",value:function(t){var n=this;if(e.clpSensitivityHandlerSharedInstance)return e.clpSensitivityHandlerSharedInstance.setInDocSensitivityLabelInfo(t);(0,h.cY)("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(t))),this.inDocLabelInfo.version=t.version,this.inDocLabelInfo.labelId=t.labelId,this.inDocLabelInfo.tenantId=t.tenantId,this.inDocLabelInfo.isEnabled=t.isEnabled,this.inDocLabelInfo.encryptionType=t.encryptionType,this.inDocLabelInfo.isDke=t.isDke,this.inDocLabelInfo.hasExtractForUser=t.hasExtractForUser,this.inDocLabelInfo.order=t.order,this.inDocLabelInfo.displayName=t.displayName,this.inDocLabelInfo.description=t.description,this.inDocLabelInfo.parentName=t.parentName,this.inDocLabelInfo.color=t.color,this.setBasicChatProps&&this.setBasicChatProps((function(e){var r,o;return(0,l._)((0,s._)({},e),{sensitivityIndicatorData:n.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(r=t.description)&&void 0!==r?r:"",badgeText:null!==(o=t.displayName)&&void 0!==o?o:"",iconType:t.encryptionType!==p.TzT.None?u.JF.Encryption:u.JF.NonEncryption}:void 0})}))}},{key:"upgradeSensitivityLabelUsingOfcJs",value:function(t){var n=this;return(0,r._)((function(){var o,i,a,s,l,u,g;return(0,c.__generator)(this,(function(m){switch(m.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.upgradeSensitivityLabelUsingOfcJs(t)];if((0,y.Zy)("tryUpgradeLabel"),o=p.qHn[p.qHn.S_APPLYLABEL_OK],(i=(0,f.bw)(f.WT.IsEmptyLabelFixForCLPv2FeatureEnabled))&&!(null==t?void 0:t.labelId))return[2,{status:o,errorMessage:d.u1i}];m.label=1;case 1:return m.trys.push([1,7,,8]),i||n.inDocLabelInfo.tenantId!==t.tenantId||n.inDocLabelInfo.labelId!==t.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(t,E)];case 2:return m.sent(),[2,{status:p.qHn[p.qHn.S_APPLYLABEL_OK]}];case 3:return(0,f.PA)(f.IY.IsNoopOnSameSensitivityLabel)&&n.inDocLabelInfo.labelId===t.labelId?[2,{status:o,errorMessage:d.u1i}]:[3,4];case 4:return v=(0,r._)((function(){return(0,c.__generator)(this,(function(e){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(t,E)]}catch(e){(0,y.mQ)("error while calling tryUpgradeLabel() Api : ".concat(e.message)),(0,y.oN)("tryUpgradeLabel"),(0,h.cY)("Error while upgrading sensitivity label: ".concat(e.message)),o=e.message}return[2]}))})),a=function(){return v.apply(this,arguments)},s=new Promise((function(e){b=e})),l=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([s,a()]),l])];case 5:m.sent(),m.label=6;case 6:return[3,8];case 7:return u=m.sent(),(0,y.mQ)("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(u.message)),"CallbackTimeout"===u.message?(0,h.cY)("Callback Timeout"):(0,h.cY)("Exception while upgrading sensitivity label: ".concat(u.message)),o=null!==(g=p.qHn[u.message])&&void 0!==g?g:u.message,[3,8];case 8:return b=null,[2,{status:o,errorMessage:o}]}var v}))}))()}},{key:"setLabelChangeEventListener",value:function(){if(e.clpSensitivityHandlerSharedInstance)return e.clpSensitivityHandlerSharedInstance.setLabelChangeEventListener();try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(w),(0,y.Zy)("Label Change Event Listener"),(0,h.cY)("Sensitivity Label Change Event Listener Set")}catch(e){(0,y.mQ)("error in setting listener for CLP : ".concat(e.message)),(0,y.oN)("onLabelChangedEvent"),(0,h.cY)("Error while setting sensitivity label change event listener: ".concat(e.message))}}},{key:"updateExternalDocSensitivityLabelUsingOfsJs",value:function(t){var n=this;return(0,r._)((function(){var r,o;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.updateExternalDocSensitivityLabelUsingOfsJs(t)];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(t)];case 2:return r=i.sent(),(0,h.cY)("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(r))),n.setExternalDocSensitivityLabelInfo(r),(0,y.Zy)("External Doc HighestSensitivityLabel"),[3,4];case 3:return o=i.sent(),(0,y.mQ)("error in HighestSensitivityLabel Api : ".concat(o.message)),o.code!==p.roB&&(0,y.oN)("External Doc HighestSensitivityLabel"),(0,h.cY)("Error while updating external doc sensitivity label: ".concat(o.message)),[3,4];case 4:return[2]}}))}))()}},{key:"getHighestDocumentSensitivityInfo",value:function(t){return(0,r._)((function(){var n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.getHighestDocumentSensitivityInfo(t)];n={labelId:d.u1i,tenantId:d.u1i},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(t)];case 2:return n=o.sent(),(0,h.cY)("Sensitivity info fetched for label ".concat(JSON.stringify(t),": ").concat(JSON.stringify(n))),(0,y.Zy)("HighestSensitivityLabel"),[3,4];case 3:return r=o.sent(),(0,y.mQ)("error in HighestSensitivityLabel Api : ".concat(r.message)),r.code!==p.roB&&(0,y.oN)("HighestSensitivityLabel"),(0,h.cY)("Error while fetching highest sensitivity label: ".concat(r.message)),[3,4];case 4:return[2,n]}}))}))()}},{key:"setSensitivityLabelToHighestSensitivity",value:function(t){var n=this;return(0,r._)((function(){var r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return e.clpSensitivityHandlerSharedInstance?[2,e.clpSensitivityHandlerSharedInstance.setSensitivityLabelToHighestSensitivity(t)]:[4,n.getHighestDocumentSensitivityInfo(t)];case 1:return r=o.sent(),n.setInDocSensitivityLabelInfo(r),[2]}}))}))()}},{key:"getSensitivity",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.getSensitivity():{id:this.inDocLabelInfo.labelId,displayName:null!==(t=this.inDocLabelInfo.displayName)&&void 0!==t?t:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==p.TzT.None,priority:null!==(n=this.inDocLabelInfo.order)&&void 0!==n?n:0};var t,n}},{key:"setExternalDocSensitivityLabelInfo",value:function(t){if(e.clpSensitivityHandlerSharedInstance)return e.clpSensitivityHandlerSharedInstance.setExternalDocSensitivityLabelInfo(t);(0,h.cY)("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(t))),this.externalDocLabelInfo.version=t.version,this.externalDocLabelInfo.labelId=t.labelId,this.externalDocLabelInfo.tenantId=t.tenantId,this.externalDocLabelInfo.isEnabled=t.isEnabled,this.externalDocLabelInfo.encryptionType=t.encryptionType,this.externalDocLabelInfo.isDke=t.isDke,this.externalDocLabelInfo.hasExtractForUser=t.hasExtractForUser,this.externalDocLabelInfo.order=t.order,this.externalDocLabelInfo.displayName=t.displayName,this.externalDocLabelInfo.description=t.description,this.externalDocLabelInfo.parentName=t.parentName,this.externalDocLabelInfo.color=t.color}},{key:"getInDocSensitiveLabelInfo",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.getInDocSensitiveLabelInfo():this.inDocLabelInfo}},{key:"getExternalDocSensitivityLabelInfo",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.getExternalDocSensitivityLabelInfo():this.externalDocLabelInfo}},{key:"shouldShowExternalDocSensitivityLabel",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.shouldShowExternalDocSensitivityLabel():((0,y.Zy)("Empty External Doc Label : ".concat(this.externalDocLabelInfo.labelId===d.u1i)),this.externalDocLabelInfo.labelId!==d.u1i&&(0,h.$1)((0,g.wo)()))}},{key:"shouldShowInDocSensitivityLabel",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.shouldShowInDocSensitivityLabel():((0,y.Zy)("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===d.u1i)),this.inDocLabelInfo.labelId!==d.u1i&&(0,h.$1)((0,g.wo)()))}},{key:"isInDocSensitivityLabelEncrypted",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.isInDocSensitivityLabelEncrypted():this.inDocLabelInfo.encryptionType!==p.TzT.None}},{key:"isExternalDocSensitivityLabelEncrypted",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.isExternalDocSensitivityLabelEncrypted():this.externalDocLabelInfo.encryptionType!==p.TzT.None}}],[{key:"getInstance",value:function(t){var n=S.t.getInstance().getChatRef();return((0,f.PA)(f.IY.UseNewCopilotSharedPackage)&&(0,m.hX)(e.clpSensitivityHandlerSharedInstance)||!(0,m.hX)(t))&&(e.clpSensitivityHandlerSharedInstance=p.n6d.getInstance(t,n,C.uB,C.Y6)),(0,m.hX)(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),(0,m.hX)(t)||(e.clpSensitivityHandler.setBasicChatProps=t),e.clpSensitivityHandler}}]),e}();function w(e,t,n,r){return I.apply(this,arguments)}function I(){return(I=(0,r._)((function(e,t,n,r){return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return(0,h.cY)("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(r)),(0,y.Zy)("Label change callback received, context:  ".concat(n)),b&&n===E&&(b("ignore"),b=null),r!==p.qHn.S_APPLYLABEL_OK?((0,y.mQ)("error in upgrading label : ".concat(r)),[2]):(0,f.PA)(f.IY.IsClpEnabledInEnterpriseForSydney)&&(T.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,T.getInstance().setSensitivityLabelToHighestSensitivity([T.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return o.sent(),[2];case 2:return!(0,f.bw)(f.WT.IsEmptyLabelFixForCLPv2FeatureEnabled)&&(0,f.bw)(f.WT.IsApplyLabelUsingTryUpgradeLabelEnabled),T.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))).apply(this,arguments)}(0,a._)(T,"clpSensitivityHandler",void 0),(0,a._)(T,"clpSensitivityHandlerSharedInstance",void 0)},13403:(e,t,n)=>{"use strict";n.d(t,{af:()=>N,k:()=>O,uK:()=>_});var r=n(43032),o=n(90813),i=n(57835),a=n(61838),s=n(79490),l=n(39726),c=n(69038),u=n(93176),d=n(55564),p=n(72218),f=n(32854),h=n(27465),g=n(44121),m=n(44632),y=n(12542),v=n(30325),S=n(24464),C=n(18758),b=n(50481),E=n(18384),T=n(39041),w=n(40389),I=(n(8520),n(4809)),P=m.B.getInstance();function _(e,t,n,r,o,i,a,s,l){return A.apply(this,arguments)}function A(){return A=(0,r._)((function(e,t,n,r,o,i,a,c,u){var d,p=arguments;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:switch(d=!(p.length>9&&void 0!==p[9])||p[9],e.status){case l.rI.BLOCKED:case l.rI.PAUSED_ON_WARNING:case l.rI.UNSUPPORTED:case l.rI.FAILED:case l.rI.UNEXPECTED_VERSION:case l.rI.USER_ABORTED:case l.rI.PARTIAL_SUCCESS:case l.rI.CONTENT_GENERATION_DISABLED:return[3,1];case l.rI.SUCCESS:return[3,2]}return[3,4];case 1:return O(e,t,u,r,void 0,d),[3,4];case 2:return[4,k(t,n,r,o,i,a,c)];case 3:return s.sent(),[3,4];case 4:return[2]}}))})),A.apply(this,arguments)}function k(e,t,n,r,o,i,a){return x.apply(this,arguments)}function x(){return(x=(0,r._)((function(e,t,n,r,a,c,u){var f;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return(0,d.n8)(v.BJ)&&!(0,d.bw)(d.WT.UseAIResponsesInODSLForSydney)||(f={featureName:y.CC.CopilotChat},function(e,t,n,r,o,a,s){var c=!(0,d.bw)(d.WT.UseAIResponsesInODSLForSydney)||!(0,b.w_)();if(n.includes("insertImages")){var u,f=PowerpointCopilotStrings.AssistantResponseLoadingImageLine1Option1;r&&(f=o.filter((function(e){return e})).join(" ")+" "),s&&(s.subFeatureName=y.Ff.AddImage),null===(u=e.current)||void 0===u||u.addResponseMessage((0,S.qi)(f+"\n\n"+PowerpointCopilotStrings.AssistantResponseLoadingImageLine2,S.tc,c,l.Xw.CHATPPT,void 0,!1,!0,void 0,s))}else if(n.includes("insertSlides")){var h,m;m=a.getScenarioName()===g.Cu.AddSlide?(0,p.a8z)()[1]:(0,p.a8z)()[2],r&&(m.linkPrefix=o.filter((function(e){return e})).join(" ")+" "),s&&(s.subFeatureName=y.Ff.AddSlide),null===(h=e.current)||void 0===h||h.addResponseMessage((0,S.FL)(m,t,void 0,S.tc,c,l.Xw.CHATPPT,void 0,void 0,s))}else if(n.includes("formatSlides")){var v,E;E=a.getScenarioName()===g.Cu.Beautify?{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseNewDesignPrefix,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseToUseDesignerOption1}:a.getScenarioName()===g.Cu.Animate?{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseAnimatingOption1,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseToUseDesignerOption1}:(0,p.a8z)()[2],r&&(E.linkPrefix=o.filter((function(e){return e})).join(" ")+" "),null===(v=e.current)||void 0===v||v.addResponseMessage((0,S.FL)(E,t,void 0,S.tc,c,l.Xw.CHATPPT,void 0,void 0,s))}else{var T;null===(T=e.current)||void 0===T||T.addResponseMessage((0,i._)({},(0,S.qi)(r?o[0]:(0,C.h)(),S.tc,c,l.Xw.CHATPPT,void 0,!1,!0,void 0,s)))}}(e,t,r,a,c,u,f)),n.status=h.Aw.success,[4,(0,b.Yb)(l.rI.SUCCESS)];case 1:return s.sent(),P.sendChatEventTelemetry((0,E.pN)((0,o._)({},y.h3.ChatEventType,y.a5.QuerySuccessful)),!1),[2]}}))}))).apply(this,arguments)}function N(e,t,n,r,o){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6?arguments[6]:void 0;return(0,T.hX)(e.error)&&(e.error=l.Re.NONE),D(e,t,r,n,o,i,a)}function O(e,t,n,r,i){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];(0,T.hX)(e.error)&&(e.error=l.Re.NONE),!(0,d.n8)(v.BJ)||(0,d.n8)(v.BJ)&&(0,d.bw)(d.WT.IsHardcodedClientErrorMessagingEnabled)?D(e,t,null!=i?i:y.S2.CopilotODSL,n,r,a,void 0,s):function(e,t){switch(e.status){case l.rI.UNSUPPORTED:var n;P.sendChatEventTelemetry((0,E.pN)((n={},(0,o._)(n,y.h3.ChatEventType,y.a5.QueryExecutionNotSupported),(0,o._)(n,y.h3.ChatErrorType,l.T_.Client),(0,o._)(n,y.h3.ChatErrorKey,y.Nr.ServerErrorMessage),n)),!1),(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.ServerErrorMessage);break;case l.rI.FAILED:var r,i=R(e,t),a=i.chatErrorType,s=i.errorKey;P.sendChatEventTelemetry((0,E.pN)((r={},(0,o._)(r,y.h3.ChatEventType,y.a5.QueryExecutionFailed),(0,o._)(r,y.h3.ChatErrorType,""===a?l.T_.Client:a),(0,o._)(r,y.h3.ChatErrorKey,s),r)),!1);break;case l.rI.BLOCKED:var c,u,d=R(e,t),p=d.chatErrorType,f=d.errorKey;P.sendChatEventTelemetry((0,E.pN)((u={},(0,o._)(u,y.h3.ChatEventType,y.a5.QueryExecutionBlocked),(0,o._)(u,y.h3.ChatErrorType,""===p?l.T_.UnsupportedAction:p),(0,o._)(u,y.h3.ChatErrorParameters,null!==(c=e.error)&&void 0!==c?c:""),(0,o._)(u,y.h3.ChatErrorKey,f),u)),!1);break;case l.rI.PAUSED_ON_WARNING:var h,g,m=R(e,t),v=m.chatErrorType,S=m.errorKey;P.sendChatEventTelemetry((0,E.pN)((g={},(0,o._)(g,y.h3.ChatEventType,y.a5.QueryExecutionPausedOnWarning),(0,o._)(g,y.h3.ChatErrorType,""===v?l.T_.UnsupportedAction:v),(0,o._)(g,y.h3.ChatErrorParameters,null!==(h=e.error)&&void 0!==h?h:""),(0,o._)(g,y.h3.ChatErrorKey,S),g)),!1);break;case l.rI.UNEXPECTED_VERSION:var b;P.sendChatEventTelemetry((0,E.pN)((b={},(0,o._)(b,y.h3.ChatEventType,y.a5.QueryExecutionUnexpectedVersionError),(0,o._)(b,y.h3.ChatErrorType,l.T_.Client),(0,o._)(b,y.h3.ChatErrorKey,y.Nr.UnexpectedVersionErrorMessage),b)),!1),(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.UnexpectedVersionErrorMessage);break;case l.rI.USER_ABORTED:var w;P.sendChatEventTelemetry((0,E.pN)((w={},(0,o._)(w,y.h3.ChatEventType,y.a5.QueryExecutionAbortedByUser),(0,o._)(w,y.h3.ChatErrorType,l.T_.Client),(0,o._)(w,y.h3.ChatErrorKey,y.Nr.UserCancelledExecutionMessage),w)),!1),(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.UserCancelledExecutionMessage);break;case l.rI.PARTIAL_SUCCESS:var I,_=function(e,t){if(e.error===l.Re.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS)return(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.ErrorSlideAlreadyAnimated};return(0,T.hX)(t)||(t.error=(0,C.k7)()),{chatErrorType:l.T_.Server,errorKey:y.Nr.PartialSuccessErrorMessage}}(e,t),A=_.chatErrorType,k=_.errorKey;P.sendChatEventTelemetry((0,E.pN)((I={},(0,o._)(I,y.h3.ChatEventType,y.a5.QueryExecutionPartiallySuccessful),(0,o._)(I,y.h3.ChatErrorType,A),(0,o._)(I,y.h3.ChatErrorKey,k),I)),!1);break;case l.rI.CONTENT_GENERATION_DISABLED:var x;P.sendChatEventTelemetry((0,E.pN)((x={},(0,o._)(x,y.h3.ChatEventType,y.a5.ContentGenerationDisabledByAdmin),(0,o._)(x,y.h3.ChatErrorType,l.T_.Client),(0,o._)(x,y.h3.ChatErrorKey,y.Nr.DisabledFeatureErrorMessagePrefix),x)),!1),(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.DisabledFeatureErrorMessagePrefix)}}(e,r)}function D(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s=arguments.length>3?arguments[3]:void 0,d=arguments.length>4?arguments[4]:void 0,h=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],g=arguments.length>6?arguments[6]:void 0,m=arguments.length>7&&void 0!==arguments[7]&&arguments[7],v=!(0,b.w_)();switch(P.sendChatEventTelemetry((0,E.pN)((0,o._)({},y.h3.ChatErrorParameters,null!==(n=e.error)&&void 0!==n?n:"")),!1),e.status){case l.rI.UNSUPPORTED:var _,A,k;if(e.error===l.Re.COMMANDING_DISABLED){var x,N={errorMessage:PowerpointCopilotStrings.CommandNotSupportedMessage,errorType:l.Qp.CommandNotSupported,featureName:y.CC.Commanding,subFeatureName:void 0};null===(x=t.current)||void 0===x||x.addResponseMessage((0,S.vT)(h,!0,N)),A=PowerpointCopilotStrings.CommandNotSupportedMessage,_=y.a5.QueryExecutionNotSupported,k=y.Nr.CommandNotSupportedMessage}else if(e.error===l.Re.MULTIPLE_GENERATE_IN_ODSL){var O,D={errorMessage:PowerpointCopilotStrings.CommandNotSupportedMessage,errorType:l.Qp.CommandNotSupported,featureName:y.CC.Commanding,subFeatureName:void 0};null===(O=t.current)||void 0===O||O.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.CommandNotSupportedMessage,S.OT,h,l.Xw.CHATPPT,void 0,!1,!0,void 0,D)),A=PowerpointCopilotStrings.CommandNotSupportedMessage,_=y.a5.QueryExecutionAbortedForMultiGenerateSlides,k=y.Nr.CommandNotSupportedMessage}else{var R,F={errorMessage:PowerpointCopilotStrings.CommandNotSupportedMessage,errorType:l.Qp.CommandNotSupported,featureName:y.CC.Commanding};null===(R=t.current)||void 0===R||R.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.ServerErrorMessage,S.OT,h,l.Xw.CHATPPT,void 0,!1,!0,void 0,F)),A=PowerpointCopilotStrings.ServerErrorMessage,_=y.a5.QueryExecutionNotSupported,k=y.Nr.ServerErrorMessage}(0,T.hX)(d)||(d.error=A),(0,E.AQ)(P,c.qD,_,r,l.T_.Client,!0,v,k,m);break;case l.rI.FAILED:var M=L(e,t,d,h),B=M.chatErrorType,U=M.errorKey;(0,E.AQ)(P,c.qD,y.a5.QueryExecutionFailed,r,""===B?l.T_.Client:B,!0,v,U,m);break;case l.rI.BLOCKED:var z=L(e,t,d,h),H=z.chatErrorType,G=z.errorKey;(0,E.AQ)(P,c.qD,y.a5.QueryExecutionBlocked,r,""===H?l.T_.UnsupportedAction:H,!0,v,G,m);break;case l.rI.PAUSED_ON_WARNING:var V=L(e,t,d),j=V.chatErrorType,q=V.errorKey;(0,E.AQ)(P,c.qD,y.a5.QueryExecutionPausedOnWarning,r,""===j?l.T_.UnsupportedAction:j,!0,v,q,m);break;case l.rI.UNEXPECTED_VERSION:var W,Y={errorMessage:PowerpointCopilotStrings.UnexpectedVersionErrorMessage,errorType:l.Qp.UnexpectedVersionErrorMessage,featureName:y.CC.Commanding,subFeatureName:void 0};null===(W=t.current)||void 0===W||W.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.UnexpectedVersionErrorMessage,S.OT,h,l.Xw.CHATPPT,void 0,!1,!0,void 0,Y)),(0,T.hX)(d)||(d.error=PowerpointCopilotStrings.UnexpectedVersionErrorMessage),(0,E.AQ)(P,c.qD,y.a5.QueryExecutionUnexpectedVersionError,r,l.T_.Client,!0,v,y.Nr.UnexpectedVersionErrorMessage,m);break;case l.rI.USER_ABORTED:var Q;if((0,w.dD)()&&!0===s.current){var J,X={errorMessage:PowerpointCopilotStrings.StopGeneratingResponseMessage,errorType:l.Qp.StopGeneratingResponseMessage,featureName:y.CC.Commanding,subFeatureName:void 0};null===(J=t.current)||void 0===J||J.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.StopGeneratingResponseMessage,S.OT,h,l.Xw.CHATPPT,void 0,!1,!0,void 0,X)),Q=y.Nr.StopGeneratingResponseMessage}else{var K,Z={errorMessage:PowerpointCopilotStrings.UserCancelledExecutionMessage,errorType:l.Qp.UserCancelledExecutionMessage,featureName:y.CC.Commanding,subFeatureName:void 0};null===(K=t.current)||void 0===K||K.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.UserCancelledExecutionMessage,S.OT,h,l.Xw.CHATPPT,void 0,!1,!0,void 0,Z)),Q=y.Nr.UserCancelledExecutionMessage}(0,E.AQ)(P,c.qD,y.a5.QueryExecutionAbortedByUser,r,l.T_.Client,!0,v,Q,m);var $=(0,I.Uv)(y.G8.UserCancelledResponse,y.av.UserAbortedQueryExecution);P.logAshaErrorEvent($.vetoName,$.errorString,$.featureName),(0,T.hX)(d)||(d.error=PowerpointCopilotStrings.UserCancelledExecutionMessage);break;case l.rI.PARTIAL_SUCCESS:var ee=function(e,t,n,r,o,i){var a=null==r||r;var s;if(e.error===l.Re.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS)return o&&(o.errorMessage=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,o.errorType=l.Qp.ErrorSlideAlreadyAnimated),null===(s=t.current)||void 0===s||s.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,S.OT,a,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.ErrorSlideAlreadyAnimated};var c,u=null!=i?i:(0,C.k7)();return o&&(o.errorMessage=u,o.errorType=void 0),null===(c=t.current)||void 0===c||c.addResponseMessage((0,S.qi)(u,S.OT,a,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=u),{chatErrorType:l.T_.Server,errorKey:y.Nr.ErrorGenericFallback}}(e,t,d,h,{errorMessage:PowerpointCopilotStrings.UserCancelledExecutionMessage,errorType:l.Qp.UserCancelledExecutionMessage,featureName:y.CC.Commanding,subFeatureName:void 0},g),te=ee.chatErrorType,ne=ee.errorKey;(0,E.AQ)(P,c.qD,y.a5.QueryExecutionPartiallySuccessful,r,te,!0,v,ne,m);var re=(0,I.Uv)(y.G8.ServiceSideIssuePreventsOutput,y.av.PartialSuccessErrorMessage);P.logAshaErrorEvent(re.vetoName,re.errorString,re.featureName);break;case l.rI.CONTENT_GENERATION_DISABLED:var oe,ie={errorMessage:PowerpointCopilotStrings.UserCancelledExecutionMessage,errorType:l.Qp.UserCancelledExecutionMessage,featureName:y.CC.Commanding,subFeatureName:void 0};null===(oe=t.current)||void 0===oe||oe.addResponseMessage({chatCardType:u._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:PowerpointCopilotStrings.DisabledFeatureErrorMessagePrefix},messageFooter:{linkText:{text:PowerpointCopilotStrings.DisabledFeatureErrorMessageLinkText,linkOnClick:T.CY,linkUrl:p.HJ4}}}},chatMessageBodyData:(0,a._)((0,i._)({},S.OT),{feedbackData:(0,f.as)(void 0,ie)}),stopLoadingUi:h}),(0,T.hX)(d)||(d.error=PowerpointCopilotStrings.DisabledFeatureErrorMessagePrefix),(0,E.AQ)(P,c.qD,y.a5.ContentGenerationDisabledByAdmin,r,l.T_.Client,!0,v,y.Nr.DisabledFeatureErrorMessagePrefix,m)}}function L(e,t,n,r,o){var i=null==r||r,a=!1;switch(e.error){case l.Re.CREATE_PRESENTATION_BLOCKED:case l.Re.CREATE_PRESENTATION_BLOCKED_ON_WARNING:var s;return o&&(o.errorMessage=PowerpointCopilotStrings.AssistantCreatePresentationResponseHeaderMessage,o.errorType=y.Nr.AssistantCreatePresentationResponseHeaderMessage),null===(s=t.current)||void 0===s||s.addResponseMessage((0,S.BK)(PowerpointCopilotStrings.AssistantCreatePresentationResponseHeaderMessage,(0,p.ppG)(),S.OT,!0,l.Xw.CHATPPT,void 0,void 0,o)),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.AssistantCreatePresentationResponseHeaderMessage};case l.Re.DESIGNER_DISABLED:var c;return o&&(o.errorMessage=PowerpointCopilotStrings.DesignerDisabledErrorMessage,o.errorType=y.Nr.DesignerDisabledErrorMessage),null===(c=t.current)||void 0===c||c.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.DesignerDisabledErrorMessage,S.OT,r,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.DesignerDisabledErrorMessage),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.DesignerDisabledErrorMessage};case l.Re.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING:a=!0;case l.Re.STRUCTURE_PRESENTATION_BLOCKED:var u,f=a||i;return o&&(o.errorMessage=PowerpointCopilotStrings.ErrorPresentationAlreadyStructured,o.errorType=void 0),null===(u=t.current)||void 0===u||u.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.ErrorPresentationAlreadyStructured,S.OT,f,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.ErrorPresentationAlreadyStructured),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.ErrorPresentationAlreadyStructured};case l.Re.SEGMENT_TO_SLIDE_SERVER_ERROR:var h;return o&&(o.errorMessage=PowerpointCopilotStrings.StorytellerErrorMessage,o.errorType=y.Nr.StorytellerErrorMessage),null===(h=t.current)||void 0===h||h.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.StorytellerErrorMessage,S.OT,i,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:l.T_.Server,errorKey:y.Nr.StorytellerErrorMessage};case l.Re.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS:var g;return o&&(o.errorMessage=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,o.errorType=void 0),null===(g=t.current)||void 0===g||g.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,S.OT,i,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.ErrorSlideAlreadyAnimated};case l.Re.APPLY_CLP_LABEL_FAILED:if((0,d.PA)(d.IY.IsApplyCLPLabelErrorChangeEnabled)){o&&(o.errorMessage=PowerpointCopilotStrings.CLPUnableToApplySensitivityLabel,o.errorType=void 0);var m,v=PowerpointCopilotStrings.CLPUnableToApplySensitivityLabel;if(e.errorMessage&&(v=e.errorMessage),(0,d.PA)(d.IY.UseNewCopilotSharedPackage))(0,C.cY)("Error while applying clp label");else null===(m=t.current)||void 0===m||m.addResponseMessage((0,S.qi)(v,S.OT,i,l.Xw.CHATPPT,void 0,!1,!0,void 0,o));return(0,T.hX)(n)||(n.error=v),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.CLPUnableToApplySensitivityLabel}}var b;return o&&(o.errorMessage=PowerpointCopilotStrings.StorytellerErrorMessage,o.errorType=void 0),null===(b=t.current)||void 0===b||b.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.StorytellerErrorMessage,S.OT,i,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:"",errorKey:y.Nr.StorytellerErrorMessage};case l.Re.IMAGE_INVALID_ODSL:var E,w=(0,d.PA)(d.IY.UseImageOutOfScopeIntentErrorForImageInvalid)?PowerpointCopilotStrings.ImageOutOfScopeIntentError:PowerpointCopilotStrings.StorytellerErrorMessage;return o&&(o.errorMessage=w,o.errorType=void 0),null===(E=t.current)||void 0===E||E.addResponseMessage((0,S.qi)(w,S.OT,i,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=w),{chatErrorType:l.T_.UnsupportedAction,errorKey:(0,d.PA)(d.IY.UseImageOutOfScopeIntentErrorForImageInvalid)?y.Nr.ImageOutOfScopeIntentError:y.Nr.StorytellerErrorMessage};default:var I;return o&&(o.errorMessage=PowerpointCopilotStrings.StorytellerErrorMessage,o.errorType=void 0),null===(I=t.current)||void 0===I||I.addResponseMessage((0,S.qi)(PowerpointCopilotStrings.StorytellerErrorMessage,S.OT,i,l.Xw.CHATPPT,void 0,!1,!0,void 0,o)),(0,T.hX)(n)||(n.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:"",errorKey:y.Nr.StorytellerErrorMessage}}}function R(e,t){switch(e.error){case l.Re.CREATE_PRESENTATION_BLOCKED:case l.Re.CREATE_PRESENTATION_BLOCKED_ON_WARNING:return(0,T.hX)(t)||(t.error=function(e,t){var n=e,r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){n=n+" "+a.value}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(PowerpointCopilotStrings.AssistantCreatePresentationResponseHeaderMessage,(0,p.ppG)())),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.AssistantCreatePresentationResponseHeaderMessage};case l.Re.DESIGNER_DISABLED:return(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.DesignerDisabledErrorMessage),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.DesignerDisabledErrorMessage};case l.Re.STRUCTURE_PRESENTATION_BLOCKED:case l.Re.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING:return(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.ErrorPresentationAlreadyStructured),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.ErrorPresentationAlreadyStructured};case l.Re.SEGMENT_TO_SLIDE_SERVER_ERROR:return(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:l.T_.Server,errorKey:y.Nr.StorytellerErrorMessage};case l.Re.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS:return(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:l.T_.UnsupportedAction,errorKey:y.Nr.ErrorSlideAlreadyAnimated};default:return(0,T.hX)(t)||(t.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:"",errorKey:y.Nr.StorytellerErrorMessage}}}},29336:(e,t,n)=>{"use strict";n.d(t,{r:()=>p});var r=n(11912),o=n(91165),i=n(90813),a=n(18758),s=n(12542),l=n(18384),c=n(39726),u=n(39041),d=n(44632),p=function(){function e(){(0,r._)(this,e),(0,i._)(this,"skillName",void 0),this.skillName=c.B2.Unset}return(0,o._)(e,[{key:"resetData",value:function(){this.skillName=c.B2.Unset}},{key:"setSkillName",value:function(e){var t;this.skillName!==e&&this.skillName!==c.B2.CreatePresentation&&this.skillName!=c.B2.AddSlide&&this.skillName!==c.B2.ContentTransform&&(d.B.getInstance().sendChatEventTelemetry((0,l.pN)((t={},(0,i._)(t,s.h3.ChatEventType,s.a5.FluxChatIntentDetected),(0,i._)(t,s.h3.ChatEventParameters,e),t))),(0,a.cY)("Skill name set: ".concat(e)),this.skillName=e)}},{key:"getSkillName",value:function(){return this.skillName}}],[{key:"getInstance",value:function(){return(0,u.hX)(e.FluxSkillHandler)&&(e.FluxSkillHandler=new e),e.FluxSkillHandler}}]),e}();(0,i._)(p,"FluxSkillHandler",void 0)},44632:(e,t,n)=>{"use strict";n.d(t,{B:()=>A});var r,o=n(20570),i=n(11912),a=n(91165),s=n(90813),l=n(7182),c=n(81092),u=n(99243),d=n(130),p=n(53357),f=n(2061),h=n(72218),g=n(44121),m=n(34045),y=n(12542),v=n(18384),S=n(55564),C=n(89125),b=n(69038),E=n(44006),T=n(32060),w=n(70116),I=n(39041),P=n(99838),_=n(32854);!function(e){e.Seen="Seen",e.Tried="Tried"}(r||(r={}));var A=function(e){(0,l._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,i._)(this,n),e=t.call(this),(0,s._)((0,o._)(e),"telemetryLatencyObject",void 0),(0,s._)((0,o._)(e),"telemetryLatencyObjectMap",void 0),(0,s._)((0,o._)(e),"telemetryChatEventObject",void 0),(0,s._)((0,o._)(e),"chatHistoryLog",[]),(0,s._)((0,o._)(e),"telemetryLogger",void 0),(0,s._)((0,o._)(e),"telemetryLoggerUtils",void 0),(0,s._)((0,o._)(e),"userQueryGuid",""),(0,s._)((0,o._)(e),"conversationId",""),(0,s._)((0,o._)(e),"isFluxEnabled",!1),(0,s._)((0,o._)(e),"entryPoint",d.TA.EntryPoint.Chat),(0,s._)((0,o._)(e),"copilotChatSharedSessionId",""),(0,s._)((0,o._)(e),"querySubmitTime",0),(0,s._)((0,o._)(e),"checkPoints",void 0),(0,s._)((0,o._)(e),"checkPointStartTime",void 0),(0,s._)((0,o._)(e),"initialHandoffQuery",void 0),(0,s._)((0,o._)(e),"heldTelemetryEvents",[]),(0,s._)((0,o._)(e),"heldStkTelemetryEvents",[]),e.telemetryLogger=y.MP.getInstance(),C.j.setTelemetryHandler(n.instance),e.telemetryLoggerUtils=C.j.getInstance(),e.telemetryLatencyObject={},e.telemetryLatencyObjectMap=new Map,e.telemetryChatEventObject={},e.userQueryGuid="",e.conversationId="",e.querySubmitTime=0,e.checkPoints={},e.checkPointStartTime=0,e.recordCheckPoint(y._R.TaskPaneStart,Number(P.pptTaskPaneStartTime)),e.recordCheckPoint(y._R.AppLoadStart,Number(P.appLoadStartTime)),e}return(0,a._)(n,[{key:"getDataFields",value:function(e){return e.map((function(e){return"number"==typeof e.value?p.ip(e.key,e.value):"string"==typeof e.value?p.m9(e.key,e.value):"boolean"==typeof e.value?p.LK(e.key,e.value):p.m9(e.key,e.value)}),[])}},{key:"getCopilotScorecardData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.SD.CopilotChat,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.Ff.Unset,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5?arguments[5]:void 0;return i=i.concat((0,c._)(d.TA.getFields({featureActionType:e,isUserInitiated:!0,capability:"",verb:(0,I.hX)(o)?h.u1i:d.TA.Verb[o],featureName:n,entryPoint:d.TA.EntryPoint.Chat,isThumbsUp:a,subFeatureName:r})).concat((0,c._)(this.getDataFields([{key:"SpecificFeatureName",value:r}])))),(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!i.some((function(e){return e.name===y.qN&&e.value}))?i=i.concat(this.getDataFields([{key:y.qN,value:this.userQueryGuid}])):i.some((function(e){return e.name===y.qN&&e.value}))||(i=i.concat(this.getDataFields([{key:y.qN,value:b.dB}]))),new E.Q(T.S2.Chat,T.lr.Chat,i,n,h.u1i,o,!0,!0,T.uk.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,T.PM.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)}},{key:"logSharedTelemetrySTKEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];P.isSDXRenderingForPreload?this.heldStkTelemetryEvents.push({telemetryLog:e,isSeen:t}):this.telemetryLogger.logSharedTelemetrySTKEvent(e,t)}},{key:"releaseHeldTelemetryEvents",value:function(){var e=this;this.heldTelemetryEvents.forEach((function(t){var n=t.eventType,r=t.telemetryData,o=t.entryPoint,i=t.featureName,a=t.capability,s=t.isThumbsUp,l=t.verb,c=t.subFeatureName;"Seen"===n?e.telemetryLoggerUtils.logSeenEvent(r,o,i,a,l,c):"Tried"===n&&e.telemetryLoggerUtils.logTriedEvent(r,o,i,a,s,l,c)})),this.heldStkTelemetryEvents.forEach((function(t){var n=t.telemetryLog,r=t.isSeen;e.telemetryLogger.logSharedTelemetrySTKEvent(n,r)})),this.heldTelemetryEvents=[],this.heldStkTelemetryEvents=[]}},{key:"logSeenEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.SD.CopilotChat,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.Ff.Unset,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((o=o||[]).some((function(e){return e.key===y.qN&&e.value}))||o.push({key:y.qN,value:this.userQueryGuid})),P.isSDXRenderingForPreload?this.heldTelemetryEvents.push({eventType:"Seen",telemetryData:o||[],entryPoint:this.entryPoint,featureName:t,capability:void 0,verb:r,subFeatureName:n}):this.telemetryLoggerUtils.logSeenEvent(o||[],this.entryPoint,t,void 0,r,n)}},{key:"logTriedEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.SD.CopilotChat,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.Ff.Unset,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((o=o||[]).some((function(e){return e.key===y.qN&&e.value}))||o.push({key:y.qN,value:this.userQueryGuid})),P.isSDXRenderingForPreload?this.heldTelemetryEvents.push({eventType:"Tried",telemetryData:o||[],entryPoint:this.entryPoint,featureName:t,capability:void 0,isThumbsUp:void 0,verb:r,subFeatureName:n}):this.telemetryLoggerUtils.logTriedEvent(o||[],this.entryPoint,t,void 0,void 0,r,n)}},{key:"updateTelemetryOnAnnotationReceived",value:function(e,t,r,o,i,a,s){(0,v.$j)(n.instance,e,null!=a?a:this.querySubmitTime,r||void 0,o||void 0,s)}},{key:"logKeptEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.SD.CopilotChat,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.Ff.Unset,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;P.isSDXRenderingForPreload||((null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((o=o||[]).some((function(e){return e.key===y.qN&&e.value}))||o.push({key:y.qN,value:this.userQueryGuid})),this.telemetryLoggerUtils.logKeptEvent(o||[],this.entryPoint,t,void 0,void 0,r,n))}},{key:"logFeedbackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.SD.CopilotChat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.Ff.Unset,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.LogTelemetryEvent(this.getCopilotScorecardData(h.u1i,t,n,r,(o||[]).length>0?this.getDataFields(o):void 0,e))}},{key:"setQueryGuid",value:function(e){this.userQueryGuid=(0,I.hX)(e)?h.u1i:e}},{key:"getQueryGuid",value:function(){var e;return(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0?this.userQueryGuid:b.dB}},{key:"setConversationId",value:function(e){this.conversationId=(0,I.hX)(e)?h.u1i:e}},{key:"getConversationId",value:function(){var e;return(null===(e=this.conversationId)||void 0===e?void 0:e.length)>0?this.conversationId:h.u1i}},{key:"setIsFluxEnabled",value:function(e){this.isFluxEnabled=e}},{key:"setCopilotChatSessionId",value:function(e){this.copilotChatSharedSessionId=e}},{key:"getCopilotChatSessionId",value:function(){return this.copilotChatSharedSessionId}},{key:"setQuerySubmitTime",value:function(e){this.querySubmitTime=e}},{key:"getQuerySubmitTime",value:function(){return this.querySubmitTime}},{key:"recordCheckPoint",value:function(e,t){t&&0!==t&&!Number.isNaN(t)||(t=(new Date).getTime()),0===this.checkPointStartTime?(this.checkPointStartTime=t,this.checkPoints[e]=0):this.checkPoints[e]=t-this.checkPointStartTime}},{key:"sendLatencyTelemetryForCheckPoints",value:function(e){var t=JSON.stringify(this.checkPoints);(0,f.cY_)("sendLatencyTelemetryForCheckPoints: ",t),this.sendLatencyTelemetry((0,v.pN)((0,s._)({},y.CT.CheckPoints,t)),e)}},{key:"setInitialHandoffQuery",value:function(e){(0,f.cY_)("setInitialHandoffQuery: ",e),this.initialHandoffQuery=e}},{key:"sendHandoffQuerySubmittedEvent",value:function(e){if(this.initialHandoffQuery){e=e.trim();var t=this.initialHandoffQuery.trim(),r=!(e===t||e.includes(t));(0,f.cY_)("Handoff query is submitted. IsModified: "+r),n.getInstance().sendChatEventTelemetry([{key:y.h3.ChatEventType,value:y.a5.HandoffQuerySubmittedByUser},{key:y.h3.ChatEventParameters,value:"".concat(y.CD.IsModified,":").concat(r)}]),this.initialHandoffQuery=void 0}}},{key:"sendChatEventTelemetry",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===y.qN&&e.value}))&&e.push({key:y.h3.UserQueryGuid,value:this.userQueryGuid}),e.push({key:y.h3.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}),this.telemetryLoggerUtils.sendTelemetryChatEventData(e,n)}},{key:"sendLatencyTelemetry",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===y.qN&&e.value}))&&e.push({key:y.h3.UserQueryGuid,value:this.userQueryGuid}),e.push({key:y.CT.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}),this.telemetryLoggerUtils.sendTelemetryLatencyData(e,n)}},{key:"sendErrorTelemetry",value:function(e){var t;(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===y.qN&&e.value}))&&e.push({key:y.h3.UserQueryGuid,value:this.userQueryGuid}),e.push({key:y.IC.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}),this.telemetryLoggerUtils.sendTelemetryErrorData(e)}},{key:"sendLatencyTelemetryForNotifications",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((null==t?void 0:t.length)>0){var r=e.findIndex((function(e){return e.key===y.qN}));-1===r?e.push({key:y.h3.UserQueryGuid,value:t}):e[r].value=t}this.telemetryLoggerUtils.sendTelemetryLatencyDataForNotification(e,n)}},{key:"logAshaErrorEvent",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.SD.CopilotChat,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(null===(n=this.userQueryGuid)||void 0===n?void 0:n.length)>0&&!i.some((function(e){return e.key===y.qN&&e.value}))&&i.push({key:y.qN,value:this.userQueryGuid}),void 0!==r&&i.push({key:"AshaScenarioName",value:r}),this.telemetryLoggerUtils.logErrorWithAshaVetoAndError(i,r,"",e,t,o)}},{key:"logAshaEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!n.some((function(e){return e.key===y.qN&&e.value}))&&n.push({key:y.qN,value:this.userQueryGuid}),this.telemetryLoggerUtils.logEventWithAshaPillar(n,"","",e)}},{key:"LogTelemetryEvent",value:function(e){var t=this;switch(e.GetEventName()){case T.lr.ChatEvents:if(!e.GetShouldLog()){var n=!0,r=!1,o=void 0;try{for(var i,a=e.GetLogs()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.name!==y.h3.UserQueryGuid&&(this.telemetryChatEventObject[s.name]=s.value)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}break}e.SetIsRequired(!0),e.SetLogs((0,c._)(e.GetLogs()).concat((0,c._)(this.getDataFields([{key:y.h3.ChatPPTSessionId,value:m.Vv.getSettingAsString(m.zj.ChatPPTSessionID)},{key:y.h3.IsDevBuild,value:h.MYv},{key:y.h3.CopilotChatSessionId,value:this.copilotChatSharedSessionId}].concat((0,c._)(Object.keys(this.telemetryChatEventObject).map((function(e){return{key:e,value:t.telemetryChatEventObject[e]}}))),[{key:y.h3.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}]))))),this.telemetryLogger.logSharedTelemetryEvent(e),this.telemetryChatEventObject={};break;case T.lr.Chat:if(!e.GetShouldLog())break;e.SetIsRequired(!0),(0,S.PA)(S.IY.IsInitiatorViewTelemetryFieldAdded)&&m.Vv.getSettingAsString(m.zj.InitiatorView)&&e.SetLogs((0,c._)(e.GetLogs()).concat((0,c._)(this.getDataFields([{key:y.sY.InitiatorView,value:m.Vv.getSettingAsString(m.zj.InitiatorView)}])))),this.logSharedTelemetrySTKEvent(e,e.GetLogs().some((function(e){return"Copilot.FeatureActionType"===e.name&&e.value===d.TA.FeatureActionType.IsSeen})));break;case T.lr.Latency:e.GetEventType()===T.S2.Latency?this.logLatencyForEventTypeLatency(e):e.GetEventType()===T.S2.NotificationLatency&&this.logLatencyForEventTypeNotificationLatency(e);break;case T.lr.Error:if(!e.GetShouldLog())break;e.SetLogs((0,c._)(e.GetLogs()).concat((0,c._)(this.getDataFields([{key:y.h3.ChatPPTSessionId,value:m.Vv.getSettingAsString(m.zj.ChatPPTSessionID)},{key:y.h3.IsDevBuild,value:h.MYv}])),(0,c._)(this.getDataFields([{key:y.IC.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}])))),this.telemetryLogger.logSharedErrorEvent(e);break;case T.lr.AshaError:if(!e.GetShouldLog())break;e.SetIsRequired(!0),this.logSharedTelemetrySTKEvent(e)}}},{key:"logLatencyForEventTypeLatency",value:function(e){var t=this;if(e.GetShouldLog()){e.SetIsRequired(!0);var n=[{key:y.CT.ChatPPTSessionId,value:m.Vv.getSettingAsString(m.zj.ChatPPTSessionID)},{key:y.CT.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryLog)},{key:y.CT.IsDevBuild,value:h.MYv},{key:y.CT.IsFluxEnabled,value:this.isFluxEnabled},{key:y.CT.CopilotChatSessionId,value:this.copilotChatSharedSessionId},{key:y.CT.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}];(0,S.JO)()?e.SetLogs((0,c._)(this.getDataFields((0,c._)(Object.keys(this.telemetryLatencyObject).map((function(e){return{key:e,value:t.telemetryLatencyObject[e]}}))).concat((0,c._)(n)))).concat((0,c._)(e.GetLogs().filter((function(e){return e.name!==y.CT.CopilotChatHistoryInfoJson}))))):e.SetLogs((0,c._)(e.GetLogs().filter((function(e){return e.name!==y.CT.CopilotChatHistoryInfoJson}))).concat((0,c._)(this.getDataFields((0,c._)(n).concat((0,c._)(Object.keys(this.telemetryLatencyObject).map((function(e){return{key:e,value:t.telemetryLatencyObject[e]}})))))))),(0,S.PA)(S.IY.ShouldAddFeatureNameInLatencyTableIfEmpty)&&!e.GetLogs().some((function(e){return e.name==y.CT.FeatureName&&!!e.value}))&&e.SetLogs((0,c._)(e.GetLogs()).concat((0,c._)(this.getDataFields([{key:y.CT.FeatureName,value:y.CC.CopilotChat}])))),this.telemetryLogger.logSharedTelemetryEvent(e),this.chatHistoryLog=[],this.telemetryLatencyObject={},this.userQueryGuid="",this.querySubmitTime=0}else{var r=!0,o=!1,i=void 0;try{for(var a,s=e.GetLogs()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.name===y.CT.CopilotChatHistoryInfoJson?this.chatHistoryLog=this.chatHistoryLog.concat(JSON.parse(l.value)):l.name!==y.h3.UserQueryGuid&&(this.telemetryLatencyObject[l.name]=l.value)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}}},{key:"logLatencyForEventTypeNotificationLatency",value:function(e){var t="";if(e.GetShouldLog()){var n=!0,r=!1,o=void 0;try{for(var i,a=e.GetLogs()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.name===y.h3.UserQueryGuid&&(t=s.value)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}e.SetIsRequired(!0);var l,u=[{key:y.CT.ChatPPTSessionId,value:m.Vv.getSettingAsString(m.zj.ChatPPTSessionID)},{key:y.CT.IsDevBuild,value:h.MYv},{key:y.CT.IsFluxEnabled,value:this.isFluxEnabled},{key:y.CT.CopilotChatSessionId,value:this.copilotChatSharedSessionId},{key:y.CT.ExtensibilityInfo,value:(0,f.Sdf)((0,_.Ld)(),(0,_.Gn)())}],d=null!==(l=this.telemetryLatencyObjectMap.get(t))&&void 0!==l?l:{};e.SetLogs((0,c._)(this.getDataFields((0,c._)(Object.keys(d).map((function(e){return{key:e,value:d[e]}}))).concat((0,c._)(u)))).concat((0,c._)(e.GetLogs()))),(0,S.PA)(S.IY.ShouldAddFeatureNameInLatencyTableIfEmpty)&&!e.GetLogs().some((function(e){return e.name==y.CT.FeatureName&&!!e.value}))&&e.SetLogs((0,c._)(e.GetLogs()).concat((0,c._)(this.getDataFields([{key:y.CT.FeatureName,value:y.CC.CopilotChat}])))),this.telemetryLogger.logSharedTelemetryEvent(e),this.telemetryLatencyObjectMap.delete(t)}else{var p=!0,g=!1,v=void 0;try{for(var C,b=e.GetLogs()[Symbol.iterator]();!(p=(C=b.next()).done);p=!0){var E=C.value;E.name===y.h3.UserQueryGuid&&(t=E.value)}}catch(e){g=!0,v=e}finally{try{p||null==b.return||b.return()}finally{if(g)throw v}}this.telemetryLatencyObjectMap.has(t)||this.telemetryLatencyObjectMap.set(t,{});var T=!0,w=!1,I=void 0;try{for(var P,A=e.GetLogs()[Symbol.iterator]();!(T=(P=A.next()).done);T=!0){var k=P.value;this.telemetryLatencyObjectMap.get(t)[k.name]=k.value}}catch(e){w=!0,I=e}finally{try{T||null==A.return||A.return()}finally{if(w)throw I}}}}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),C.j.setTelemetryHandler(n.instance),n.instance}}]),n}(w.M);(0,s._)(A,"instance",void 0)},63900:(e,t,n)=>{"use strict";n.d(t,{E:()=>c,Q:()=>l});var r=n(99586),o=n(80202),i=n(32854),a=n(18758),s=!1,l=function(){(0,a.cY)("ppt visual called on pane launch"),s=!0,(0,i.r9)()},c=function(){(0,a.cY)("subscribing to preload signal for pptVisual");var e=r.U.subscribe((function(){(0,a.cY)("Pane open signal received"),s||((0,i.r9)(),s=!0)})),t=o.w.subscribe((function(){(0,a.cY)("ppt visual hide signal received"),s=!1,(0,i.tV)()}));return function(){e(),t()}}},30325:(e,t,n)=>{"use strict";n.d(t,{ys:()=>Yh,BJ:()=>zh,wo:()=>Qh});var r=n(43032),o=n(90813),i=n(57835),a=n(61838),s=n(42652),l=n(81092),c=n(79490),u=n(28679),d=n.n(u),p=n(22180),f=n.n(p),h=n(87720),g=n.n(h),m=n(34159),y=n.n(m),v=n(11843),S=n.n(v),C=n(79216),b=n.n(C),E=n(86824),T={};T.styleTagTransform=b(),T.setAttributes=y(),T.insert=g().bind(null,"head"),T.domAPI=f(),T.insertStyleElement=S();d()(E.A,T);E.A&&E.A.locals&&E.A.locals;var w,I=n(72218),P=n(12542),_=n(53154),A=n(91208),k=n(78064);!function(e){e[e.pptChat=0]="pptChat",e[e.wordChat=1]="wordChat"}(w||(w={}));var x,N=n(62096),O=n(2884),D=n(94152),L=n(48544),R=n(69038),F=n(4460),M=n(55564),B=n(78854);!function(e){e.Close="close",e.Move="move",e.Resize="resize",e.Help="help",e.ExpandOrCollapse="expandOrCollapse",e.RealtimeVoice="realtimeVoice"}(x||(x={}));var U,z=n(19464);!function(e){e.ChatPPTExitClicked="ChatPPTExitClicked",e.ChatPPTLikeClicked="ChatPPTLikeClicked",e.ChatPPTDislikeClicked="ChatPPTDislikeClicked",e.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked",e.ChatPPTShowDesigner="ChatPPTShowDesigner",e.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart",e.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete",e.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation",e.ChatPPTSearchClicked="ChatPPTSearchClicked",e.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful",e.ChatPPTInsertImageSuccessful="ChatPPTInsertImageSuccessful",e.ChatPPTTriggerCommentHighlight="ChatPPTTriggerCommentHighlight"}(U||(U={}));var H=n(73606),G=n(8349),V=n(2061),j=n(45002),q=n(6693),W=n(17223),Y=n(69510),Q=n(98553),J=n(61339),X=n(44121),K=n(84163),Z=n(39726),$=n(81789),ee=n(37745),te=n(52033),ne=n(4260),re=n(34045),oe=n(43277),ie=n(4277),ae=n(4809),se=n(14552),le=n(93275),ce=n(9669),ue=n(65917),de=n(48601),pe=n(37086),fe=n(1216),he=n(66887),ge=n(57155),me=n(14213),ye=n(40403),ve=n(18758),Se=n(39041);function Ce(e){try{var t="";(0,Se.hX)(re.Vv.getSettingAsString(re.zj.PPTClientOrigin))||re.Vv.getSettingAsString(re.zj.PPTClientOrigin)==I.u1i||(t=re.Vv.getSettingAsString(re.zj.PPTClientOrigin)),window.parent.postMessage(e,t)}catch(t){(0,ve.cY)(" SendMessageToHost failed with exception: "+t.message+" for event: "+JSON.stringify(e))}}var be=n(20570),Ee=n(11912),Te=n(91165),we=n(75965);function Ie(e,t,n){return Ie="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,we.r)(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n||e):o.value}},Ie(e,t,n||e)}var Pe=n(7182),_e=n(99243),Ae=n(24643),ke=n(43100),xe=n(44632),Ne=n(32854),Oe=n(60946),De=n(69806),Le=n(36568),Re=n(70991),Fe=n(65412),Me=n(95364),Be=n(63685),Ue=n(1327),ze=n(64090),He=function(e){var t=I.Uk7,n={staticStrings:(0,I.fGO)()};return e.push({workflowAnnotationType:ce.c.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:t,config:(0,M.PA)(M.IY.ShouldSendALConfigForRAI)?n:void 0}),e.push({workflowAnnotationType:Re.Pd.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:I.glU}),e},Ge=function(e){return He(e),e.push({workflowAnnotationType:Y.MH.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:De.Ml.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,forceReturnCachedAnnotations:!0}),e},Ve=n(72807),je=n(81274),qe=n(47941),We=n(1543),Ye=n(40389),Qe=n(46489),Je=n(80202),Xe=n(54108),Ke=n(99586),Ze=function(e){(0,Pe._)(n,e);var t=(0,_e._)(n);function n(e,r,i,a,s,l,c){var u;return(0,Ee._)(this,n),u=t.call(this),(0,o._)((0,be._)(u),"handleResponseItem",void 0),(0,o._)((0,be._)(u),"sharedCopilotEventHandler",void 0),(0,o._)((0,be._)(u),"sharedCopilotLoggingEventHandler",void 0),(0,o._)((0,be._)(u),"copilotChatRef",void 0),(0,o._)((0,be._)(u),"setIsGeneratingResponse",void 0),(0,o._)((0,be._)(u),"setDisableChatInput",void 0),(0,o._)((0,be._)(u),"signalSubmitTime",void 0),(0,o._)((0,be._)(u),"hvcPromptDetected",le.m.NotACommand),(0,o._)((0,be._)(u),"hvcPromptStringsList",[]),(0,o._)((0,be._)(u),"hvcPromptToHVCCategoryMap",{}),(0,o._)((0,be._)(u),"setSuggestionListPool",void 0),u.handleResponseItem=e,u.sharedCopilotEventHandler=r,u.copilotChatRef=i,u.sharedCopilotLoggingEventHandler=a,u.signalSubmitTime=0,u.setIsGeneratingResponse=s,u.setDisableChatInput=l,u.setSuggestionListPool=c,u}return(0,Te._)(n,[{key:"sendResponseToClient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.u1i;(0,ve.cY)("Item: ",e),(0,ve.cY)("Cv: ",t),this.handleResponseItem(e,this.signalSubmitTime,t)}},{key:"sendEventToClient",value:function(e,t){var n=this;return(0,r._)((function(){return(0,c.__generator)(this,(function(r){return n.sharedCopilotEventHandler(e,t),[2]}))}))()}},{key:"sendLoggingEventToClient",value:function(e,t){var n=this;return(0,r._)((function(){return(0,c.__generator)(this,(function(r){return n.sharedCopilotLoggingEventHandler(e,t),[2]}))}))()}},{key:"isFeatureGateEnabledFromClient",value:function(e){return e===Ae.WT.IsClpSensitivityInChatInputEnabled?(0,M.bw)(M.WT.IsClpSensitivityInChatInputEnabled):e===Ae.WT.EnableALCorrelationLogs?(0,M.PA)(M.IY.EnableALCorrelationLogs):e===Ae.WT.EnableMsgExtCardTelemetry?(0,M.PA)(M.IY.IsMsgExtTelemetryEnabled):e===Ae.WT.IsWebSearchDefaultOn?(0,M.PA)(M.IY.IsWebSearchDefaultOn):e===Ae.WT.IsPersistanceInPhase2UxEnabled?(0,ve.$1)(Qh())&&(0,M.PA)(M.IY.IsPersistanceInPhase2UxEnabled):e===Ae.WT.EnableSendTenantFeedback?(0,We.z4)():e===Ae.WT.IsCopilotPluginEnabled?(0,We.dV)():e===Ae.WT.EnableCopilotExtTelemetry?(0,M.PA)(M.IY.IsCopilotExtTelemetryEnabled):e===Ae.WT.IsDisableChatInputWhenAlSessionCloseEnabled||(!(e!==Ae.WT.IsQnASuggestionPillCachingEnabled&&e!==Ae.WT.IsSharedCopilotLabEnabled||(0,Ye.dD)())||(0,M.bw)(e))}},{key:"getNumberFeatureGateValueFromClient",value:function(e){return(0,M.Z8)(e,NaN)}},{key:"getWorkflowsToRegister",value:function(e){var t=function(e){var t=[];if(e)return(0,ve.cY)("Adding only Flux annotations for Custom GPT",e),Ge(t);var n=I.Uk7,r=(0,M.Z8)(M.WT.StorytellerOutlineResponseTimeoutDuration,I.k1F),o=(0,M.Z8)(M.WT.ContentProcessingResponseTimeoutDuration,I.RKj);return((0,M.bw)(M.WT.IsNotificationEnabledForSummary)||(0,M.D$)())&&t.push({workflowAnnotationType:Be.l.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:Q.i.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:Fe.a.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:K.KJ.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:K.Ob.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),(0,M.bw)(M.WT.IsMarkdownSummarizationEnabled)||(t.push({workflowAnnotationType:G.SB.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:I._hU}),t.push({workflowAnnotationType:G.kb.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:I._hU})),(0,M.bw)(M.WT.SpeakerNotesEnabled)&&t.push({workflowAnnotationType:ze.m.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:I.rH0}),(0,M.Z_)()&&(t.push({workflowAnnotationType:Y.YO.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:Y.N6.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:Y.kD.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1})),t.push({workflowAnnotationType:j.yg.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:o}),t.push({workflowAnnotationType:ye.f.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:o}),t.push({workflowAnnotationType:j.P0.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:ye.i.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),(0,M.bw)(M.WT.IsContentValidatorWorkflowEnabled)&&t.push({workflowAnnotationType:Oe.F.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),t.push({workflowAnnotationType:se.B.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:de.c.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:pe._t.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:r}),(0,M.bw)(M.WT.IsPresentationTransformerWFEnabled)&&t.push({workflowAnnotationType:ge.x.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),((0,M.PA)(M.IY.IsNewPptCopilotWorkflowIntegrationEnabled)||(0,M.qH)())&&(He(t),(0,M.bw)(M.WT.IsPresentationRecommendationEnabled)&&t.push({workflowAnnotationType:he.T.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n})),(0,M.PA)(M.IY.IsNewPptCopilotWorkflowIntegrationEnabled)||(0,M.qH)()||t.push({workflowAnnotationType:Re.tP.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:I.glU}),t.push({workflowAnnotationType:Le.w.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}),((0,M.PA)(M.IY.HandoffEnabled)||(0,M.bw)(M.WT.InAppHandoffEnabled))&&(t.push({workflowAnnotationType:te.uC.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),t.push({workflowAnnotationType:te.dF.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),t.push({workflowAnnotationType:te.kp.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n})),t.push({workflowAnnotationType:Y.MH.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:De.Ml.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,forceReturnCachedAnnotations:!0}),(0,M.bw)(M.WT.IsPersonalizationUXEnabled)&&(0,M.bw)(M.WT.IsPersonalizationConfirmationResponseEnabled)&&t.push({workflowAnnotationType:Me.H.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),(0,M.bw)(M.WT.IsImageInputEnabled)&&(0,M.bw)(M.WT.IsSketchToImageEnabled)&&t.push({workflowAnnotationType:q.k.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),(0,M.bw)(M.WT.IsCreditsUIInternalEnabled)&&(t.push({workflowAnnotationType:Ue.d.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUIAnnotation",shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n})),(0,M.bw)(M.WT.IsAddSlideWorkflowEnabled)&&t.push({workflowAnnotationType:fe.C.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t}(e);return t}},{key:"getALSession",value:function(){return(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){return e=re.Vv.getSettingAsString(re.zj.AugloopSharedSessionID),(0,qe.iU)(e),[2,(0,qe.ky)()]}))}))()}},{key:"getPreloadSignal",value:function(e){switch(e){case Qe.U.HidePane:return Je.w;case Qe.U.StartPreload:return Xe.I;default:return Ke.U}}},{key:"getHostSettings",value:function(){var e={appName:"PowerPoint",appPlatform:oe.i.GetHostAppPlatform(),devBuild:I.MYv||(0,re.I_)(),environment:(0,re.I_)()?N.DF.DOGFOOD:N.DF.PRODUCTION,sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com",getDocumentUrlAsync:(0,M.bw)(M.WT.UseOfficeJSDocumentURL)?oe.i.getDocumentUrlAsync:void 0,language:(0,ee.hD)(oe.i.GetHostAppDisplayLanguage()),substrateScenarioName:I.rGh[oe.i.GetHostAppPlatform()],substrateProactiveZQMScenarioName:I.VeX[oe.i.GetHostAppPlatform()],sessionStorageKey:this.getSessionStorageKey()};return(0,M.bw)(M.WT.IsFeedbackAppChatIntegrationEnabled)&&(e.feedbackSettings=(0,Ne.fC)()),e}},{key:"getSessionStorageKey",value:function(){var e,t,n,r,o=window.Office.context,i=null==o?void 0:o.platform,a=null==o||null===(t=o.hostSettings)||void 0===t||null===(e=t._settings)||void 0===e?void 0:e.IsCopilotPreloaded;if(i===window.Office.PlatformType.OfficeOnline)n=null==o||null===(r=o.hostSettings)||void 0===r?void 0:r.get("AppStartTimestamp");else if(a){var s,l,c,u=null==o||null===(c=o.document)||void 0===c||null===(l=c.settings)||void 0===l||null===(s=l._clientSettingsManager)||void 0===s?void 0:s._osfClientContext,d=null==u?void 0:u.GetCorrelationId(),p=null==u?void 0:u.GetDocUrl();d&&(d=d.replace(/[{}]/g,"")),p&&d&&(n="".concat(d).concat("string"==typeof p?btoa(p):""))}return n}},{key:"handleHVCPromptDetection",value:function(e){var t=this;return(0,r._)((function(){var n,r;return(0,c.__generator)(this,(function(o){try{(n=(0,je.vV)(e,t.hvcPromptStringsList)).length>0?(r=(0,je.MD)(n,t.hvcPromptToHVCCategoryMap),t.hvcPromptDetected=r):t.hvcPromptDetected=le.m.NotACommand}catch(e){(0,ve.cY)("An error occurred while checking for hvc prompt. "+e),t.hvcPromptDetected=le.m.NotACommand}return[2]}))}))()}},{key:"getDefaultSignalOperation",value:function(e,t,n,o,a,s,l,u,d,p,f,h){var g=this;return(0,r._)((function(){var r,m,y,v,S,C,b;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return(0,M.PA)(M.IY.ShouldSupportHVCDetectionOnClientSide)&&g.handleHVCPromptDetection(e),(0,ve.cY)("HVC Prompt sent to AL: ",g.hvcPromptDetected),[4,(0,Ne.Bs)(g.copilotChatRef,e,t,o,n,a,s,l,u,g.hvcPromptDetected,p,d,f,h)];case 1:return v=c.sent(),S=v.operation.items.length>0?null===(y=v.operation.items[0])||void 0===y||null===(m=y.body)||void 0===m||null===(r=m.H_)||void 0===r?void 0:r.T_:"",xe.B.getInstance().sendLatencyTelemetry([{key:P.CT.RequestSignalType,value:S}]),(0,ve.cY)("getDefaultSignalOperation: ".concat(JSON.stringify(v))),v.workflowAnnotationType!==G.yG.getTypeName()&&v.workflowAnnotationType!==G.SB.getTypeName()&&(null===(C=g.copilotChatRef.current)||void 0===C||C.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(b=(0,Ve.A)().get(Z.Ae.Default))&&void 0!==b?b:[]},(0,Ne.$2)()))),g.setIsGeneratingResponse(!0),g.signalSubmitTime=(new Date).getTime(),_.G.getInstance().addContextId(t),[2,v]}}))}))()}},{key:"shouldSendRequestToAugloop",value:function(e,t,n){var o=this;return(0,r._)((function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return(0,M.PA)(M.IY.IsScenarioErrorTelemetryEnabled)&&(me.K.getInstance().setStartTime((new Date).toISOString()),me.K.getInstance().setUserQueryGuid(R.dB)),((0,M.PA)(M.IY.HandoffEnabled)||(0,M.bw)(M.WT.InAppHandoffEnabled))&&xe.B.getInstance().sendHandoffQuerySubmittedEvent(e),[4,(0,Ne.Ir)(o.copilotChatRef)];case 1:return r.sent()?(0,Ne.Ld)()!==I.u1i?[2,!0]:[4,(0,Ne.TJ)(o.copilotChatRef,e,o.setDisableChatInput,t,o.setSuggestionListPool)]:[2,!1];case 2:return n=r.sent(),[2,Promise.resolve(n)]}}))}))()}},{key:"shouldIgnoreResponse",value:function(e){var t=(0,Ne.q9)(e);return(0,ve.cY)("shouldIgnoreResponse: ",t),t}},{key:"feedbackButtonClicked",value:function(e,t,r,o,s){if((0,M.bw)(M.WT.IsFeedbackAppChatIntegrationEnabled))return(0,M.PA)(M.IY.SendFeedbackClientAppName)&&(t.contextData=(0,a._)((0,i._)({},t.contextData),{feedbackClientAppName:this.getfeedbackCientAppName()})),(0,Ne.HK)(e,t,r),void Ie((0,we._)(n.prototype),"feedbackButtonClicked",this).call(this,e,t,r,o,s);e===N.Gb.LIKE?(0,Ne.vp)(t,r):(0,Ne.Ox)(t,r)}},{key:"setHVCPromptDetected",value:function(e){this.hvcPromptDetected=e}},{key:"setHVCPromptStringsList",value:function(e){this.hvcPromptStringsList=e}},{key:"setHVCPromptToHVCCategoryMap",value:function(e){this.hvcPromptToHVCCategoryMap=e}},{key:"getfeedbackCientAppName",value:function(){var e="PPTWeb";switch(oe.i.GetHostAppPlatform()){case I.nAd:e="PPTWin32";break;case I.xb6:e="PPTMac";break;case I.TTX:e="PPTiOS"}return e}},{key:"copyButtonClicked",value:function(e,t,n){return(0,r._)((function(){return(0,c.__generator)(this,(function(r){return(0,ve.cY)("Copy button clicked called"),(0,Ne.Cu)(e,t,n),[2]}))}))()}}],[{key:"getInstance",value:function(e,t,r,o,i,a,s){return this.instance||(this.instance=new n(e,t,r,o,i,a,s)),n.instance}}]),n}(ke.h);(0,o._)(Ze,"instance",void 0);var $e,et,tt=n(70825),nt=n(72758),rt=n(18384),ot=n(66888),it=xe.B.getInstance(),at=(et=(0,r._)((function(e){var t,n;return(0,c.__generator)(this,(function(r){return n=new tt.Xr({parentPath:["Signal",nt.P.getTypeName()],items:[{id:ot.r.generateId(),body:new nt.P}]}),$e=(new Date).getTime(),null===(t=e.current)||void 0===t||t.submitOperation({operation:n,workflowAnnotationType:Q.i.getTypeName()}),it.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventType,P.a5.UserTypeOperationSubmitted))),(0,ve.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(n)+"\nat Time : "+new Date+"\n\n\n"),[2]}))})),function(e){return et.apply(this,arguments)}),st=function(){var e=(0,r._)((function(e,t,n){var r,o,i;return(0,c.__generator)(this,(function(a){return r=null==e?void 0:e.body,o=null==r?void 0:r.userType,i=null==r?void 0:r.isEUDBUser,(0,rt.$j)(it,Q.i.getTypeName(),$e,P.CT.UserIdentityTypeResponseTime,P.CC.CopilotChat,n,void 0,!1),(0,ve.cY)("".concat(Q.i.getTypeName()," response. Time Taken : ").concat((0,R.WU)($e)," sec \n, UserType : ").concat(o,", isEUDBUser : ").concat(i)),t(o,i),[2]}))}));return function(t,n,r){return e.apply(this,arguments)}}(),lt=n(21659),ct=n(48694),ut=n(24464),dt=n(88645),pt=n(29862),ft=n(50481),ht=n(72702),gt=n(52318),mt=n(12063),yt=xe.B.getInstance(),vt=function(){var e=(0,r._)((function(e,t,n){var r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r=e.body,[4,St(r)];case 1:return o.sent(),(0,rt.$j)(yt,Y.N6.getTypeName(),0===t?R.qD:t,P.CT.CopilotODSLImageResponseTime,P.CC.InsertImage,n),(0,ve.cY)("".concat(Y.N6.getTypeName()," response.")),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),St=function(){var e=(0,r._)((function(e){var t;return(0,c.__generator)(this,(function(n){return t=e.images,(0,ve.cY)("CopilotOdslImageAnnotation received "+JSON.stringify(t)+" "+e.baseUrl),t&&t.length&&e.baseUrl?(t.forEach((function(t){mt.U.addImage({url:e.baseUrl+t.imageId,description:t.description,altText:t.altText,license:t.license})})),[2]):[2]}))}));return function(t){return e.apply(this,arguments)}}(),Ct=n(85535),bt=n(5851),Et=xe.B.getInstance(),Tt=me.K.getInstance(),wt=function(){var e=(0,r._)((function(e,t){var n,r,a,s,l,u,d,p,f,h,g,m,y,v,S,C;return(0,c.__generator)(this,(function(c){switch(n=e.body,r=n.intent,a=n.rephrasedQuery,s=[],(0,Se.hX)(n.entities)||(s=n.entities),(0,ve.cY)("Intent received from Copilot Odsl Intent Workflow: ".concat(r,", ").concat(s)),a&&(0,ve.cY)("Rephrased query received from Copilot Odsl Intent Workflow: ".concat(a)),Et.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventType,P.a5.PPTCopilotIntentDetected)),!1),r){case Z.jd.Command:switch(Et.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventParameters,(0,M.PA)(M.IY.IsEntitiesLogRemovedFromChatEventParameters)?r:r+" "+s[0]))),s[0]){case Z.cn.Slide:null===(l=t.current)||void 0===l||l.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(u=(0,bt.A)().get(Z.Ae.CreatePresentation))&&void 0!==u?u:[]},(0,Ne.$2)()));break;case Z.cn.Text:null===(d=t.current)||void 0===d||d.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(p=(0,bt.A)().get(Z.Ae.AddText))&&void 0!==p?p:[]},(0,Ne.$2)())),Tt.setScenarioName(X.Cu.FormatText);break;case Z.cn.Image:null===(f=t.current)||void 0===f||f.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(h=(0,bt.A)().get(Z.Ae.AddImage))&&void 0!==h?h:[]},(0,Ne.$2)())),Tt.setScenarioName(X.Cu.InsertImage),xe.B.getInstance().logTriedEvent(X.SD.AddContent,P.Ff.AddImage,Ct.RX.Create)}break;case Z.jd.Summarize:case Z.jd.SegmentSummarize:case Z.jd.StyleSummarize:Tt.setScenarioName(X.Cu.Summary),null===(g=t.current)||void 0===g||g.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(m=(0,bt.A)().get(Z.Ae.PresentationSummary))&&void 0!==m?m:[]},(0,Ne.$2)())),Et.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventParameters,r+" "+Z.Ae.PresentationSummary)));break;case Z.jd.ActionItem:Tt.setScenarioName(X.Cu.Summary),null===(y=t.current)||void 0===y||y.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(v=(0,bt.A)().get(Z.Ae.CallToAction))&&void 0!==v?v:[]},(0,Ne.$2)())),Et.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventParameters,r+" "+Z.Ae.CallToAction)));break;case Z.jd.ImportantSlide:Tt.setScenarioName(X.Cu.Summary),null===(S=t.current)||void 0===S||S.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(C=(0,bt.A)().get(Z.Ae.ImportantSlides))&&void 0!==C?C:[]},(0,Ne.$2)())),Et.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventParameters,r+" "+Z.Ae.ImportantSlides)));break;case Z.jd.OutOfScope:case Z.jd.Invalid:Et.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventParameters,r))),(0,M.PA)(M.IY.IsScenarioErrorTelemetryEnabled)&&me.K.getInstance().addScenarioError(X.tp.IntentDetectionFailure)}return[2]}))}));return function(t,n){return e.apply(this,arguments)}}(),It=n(72982),Pt=n(83048),_t=n(8520),At=n.t(_t,2),kt=function(){return _t.createElement("div",null,PowerpointCopilotStrings.AssistantChatHelpSuggestion.substring(0,PowerpointCopilotStrings.AssistantChatHelpSuggestion.indexOf(I.O0f)),_t.createElement(It.ReL,null),PowerpointCopilotStrings.AssistantChatHelpSuggestion.substring(PowerpointCopilotStrings.AssistantChatHelpSuggestion.indexOf(I.O0f)+I.O0f.length))},xt={HelpResponse:_t.memo(kt)},Nt=_t.memo((function(e){var t=e.component;return _t.useEffect((function(){var e;xe.B.getInstance().sendErrorTelemetry((0,rt.pN)((e={},(0,o._)(e,Pt.IC.ErrorMessage,"Missing renderer for ".concat(t)),(0,o._)(e,Pt.IC.ErrorCategory,Pt.S2.Error),e)))}),[t]),_t.createElement("i",null,"Sorry, cannot display this message.")})),Ot={renderers:xt,renderFallback:function(e){return _t.createElement(Nt,{component:e.component})}},Dt=function(e){return{showFeedbackButtons:e,useFluentAIGeneratedIndicator:!0,shouldSupportCitationsInAvalon:(0,M.bw)(M.WT.IsCitationSupportForAvalonEnabled)}},Lt=n(70941),Rt=function(){switch(oe.i.GetHostAppPlatform()){case I.nAd:return"PowerPoint_Win32";case I.xb6:return"PowerPoint_Mac";case I.TTX:return"PowerPoint_iOS";default:return"PowerPoint_Online"}},Ft=function(){switch(oe.i.GetHostAppPlatform()){case I.nAd:return"Win32";case I.xb6:return"Mac";case I.TTX:return"iOS";default:return"Web"}},Mt=n(44001),Bt=n(93176),Ut=n(26419);const zt="Sorry, Something went wrong. Please try again.";var Ht=n(58651);const Gt=[{name:"undo_application",alternateNames:["reverse","undo"],description:"Reverse the previous action taken by the user.",returnVariable:{type:"void",description:""},args:[]},{name:"insert_images",alternateNames:["insertImages","insert_image"],description:"Generates an image from the given text description and inserts it into the given slides.",returnVariable:{type:"shapes",description:"The images that were inserted."},args:[{name:"description",required:!0,description:"Text description of the image to insert.",type:"string"},{name:"slides",alternateNames:["scope"],required:!0,description:"The slides on which to insert the image.",type:"slides",promptAlternative:{name:"scope"},validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"imageType",required:!1,description:"The type of image to insert.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Default","Icon","Sticker","Cutout","Cartoon"]}}]},{name:"image_invalid",alternateNames:[],description:"insert_images statements that contained an invalid image description are corrected to this statement. This statement should only be inserted during post processing.",returnVariable:{type:"void",description:""},args:[]},{name:"invalid_request",alternateNames:["invalidRequest"],description:"user requests that are not currently supported should return this statement.",returnVariable:{type:"void",description:""},args:[]},{name:"select_shapes",alternateNames:["selectShapes","select_shape"],description:"Selects shapes as specified by the given scope and index.",returnVariable:{type:"shapes",description:"The shapes that match the given selection criteria."},args:[{name:"scope",required:!0,description:"The slides from which shapes should be selected.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"index",required:!1,description:"The index of the shape to select. index is 0-based. For example, index of fourth shape is 3.",type:"selectionIndex"},{name:"shapeType",required:!1,description:"The type of shape to select.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["GeometricShape","Image","Textbox","Curve","Elbow","Straight","LineInverse","Triangle","RightTriangle","Rectangle","Diamond","Parallelogram","Trapezoid","NonIsoscelesTrapezoid","Pentagon","Hexagon","Heptagon","Octagon","Decagon","Dodecagon","Star4","Star5","Star6","Star7","Star8","Star10","Star12","Star16","Star24","Star32","RoundRectangle","Round1Rectangle","Round2SameRectangle","Round2DiagonalRectangle","SnipRoundRectangle","Snip1Rectangle","Snip2SameRectangle","Snip2DiagonalRectangle","Plaque","Ellipse","Teardrop","HomePlate","Chevron","PieWedge","Pie","BlockArc","Donut","NoSmoking","RightArrow","LeftArrow","UpArrow","DownArrow","StripedRightArrow","NotchedRightArrow","BentUpArrow","LeftRightArrow","UpDownArrow","LeftUpArrow","LeftRightUpArrow","QuadArrow","LeftArrowCallout","RightArrowCallout","UpArrowCallout","DownArrowCallout","LeftRightArrowCallout","UpDownArrowCallout","QuadArrowCallout","BentArrow","UturnArrow","CircularArrow","LeftCircularArrow","LeftRightCircularArrow","CurvedRightArrow","CurvedLeftArrow","CurvedUpArrow","CurvedDownArrow","SwooshArrow","Cube","Can","LightningBolt","Heart","Sun","Moon","SmileyFace","IrregularSeal1","IrregularSeal2","FoldedCorner","Bevel","Frame","HalfFrame","Corner","DiagonalStripe","Chord","Arc","LeftBracket","RightBracket","LeftBrace","RightBrace","BracketPair","BracePair","Callout1","Callout2","Callout3","AccentCallout1","AccentCallout2","AccentCallout3","BorderCallout1","BorderCallout2","BorderCallout3","AccentBorderCallout1","AccentBorderCallout2","AccentBorderCallout3","WedgeRectCallout","WedgeRRectCallout","WedgeEllipseCallout","CloudCallout","Cloud","Ribbon","Ribbon2","EllipseRibbon","EllipseRibbon2","LeftRightRibbon","VerticalScroll","HorizontalScroll","Wave","DoubleWave","Plus","FlowChartProcess","FlowChartDecision","FlowChartInputOutput","FlowChartPredefinedProcess","FlowChartInternalStorage","FlowChartDocument","FlowChartMultidocument","FlowChartTerminator","FlowChartPreparation","FlowChartManualInput","FlowChartManualOperation","FlowChartConnector","FlowChartPunchedCard","FlowChartPunchedTape","FlowChartSummingJunction","FlowChartOr","FlowChartCollate","FlowChartSort","FlowChartExtract","FlowChartMerge","FlowChartOfflineStorage","FlowChartOnlineStorage","FlowChartMagneticTape","FlowChartMagneticDisk","FlowChartMagneticDrum","FlowChartDisplay","FlowChartDelay","FlowChartAlternateProcess","FlowChartOffpageConnector","ActionButtonBlank","ActionButtonHome","ActionButtonHelp","ActionButtonInformation","ActionButtonForwardNext","ActionButtonBackPrevious","ActionButtonEnd","ActionButtonBeginning","ActionButtonReturn","ActionButtonDocument","ActionButtonSound","ActionButtonMovie","Gear6","Gear9","Funnel","MathPlus","MathMinus","MathMultiply","MathDivide","MathEqual","MathNotEqual","CornerTabs","SquareTabs","PlaqueTabs","ChartX","ChartStar","ChartPlus"],enumValuesAlternateNames:["WedgeEllipseCallout:SpeechBubble","RightArrow:Arrow","MathEqual:Equation","Ellipse:Oval","Ellipse:Circle","FlowChartConnector:Connector","Straight:Line","Rectangle:Square","Image:Picture"],enumValuesToReject:["Flowchart"]}},{name:"name",required:!1,description:"Name of the shapes to select. This filter is unioned with shapeType.",type:"string"},{name:"shapeIds",required:!1,description:"The shape IDs that match the given selection criteria.",type:"string"},{name:"left",required:!1,description:"The left position of the shape.",type:"positiveNumber"},{name:"top",required:!1,description:"The top position of the shape.",type:"positiveNumber"},{name:"height",required:!1,description:"The height of the shape.",type:"positiveNumber"},{name:"width",required:!1,description:"The width of the shape.",type:"positiveNumber"},{name:"area",required:!1,description:"The area of the shape.",type:"positiveNumber"},{name:"lineColor",required:!1,description:"The color of the shape's outline.",type:"color"},{name:"lineDashStyle",required:!1,description:"The dash style of the shape's outline.",type:"enum",validationArgs:{enumValues:["Dash","DashDot","DashDotDot","LongDash","LongDashDot","RoundDot","Solid","SquareDot","LongDashDotDot","SystemDash","SystemDot","SystemDashDot"]}},{name:"lineWeight",required:!1,description:"The weight of the shape's outline.",type:"positiveNumber"},{name:"lineTransparency",required:!1,description:"The transparency of the shape's outline.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"fillColor",required:!1,description:"The color of the shape's fill.",type:"color"},{name:"fillTransparency",required:!1,description:"The transparency of the shape's fill.",type:"rangedNumber",validationArgs:{min:0,max:1}}]},{name:"insert_shapes",alternateNames:["insertShapes","insert_shape"],description:"Inserts shapes of shapeType in the provided slides.",returnVariable:{type:"shapes",description:"The shapes that were inserted."},args:[{name:"slides",required:!0,description:"The slides on which shapes has to be inserted.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"shapeType",required:!0,description:"The type of shape to insert.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["InjectForShapesCircleSquare"],enumValues:["Textbox","Curve","Elbow","Straight","LineInverse","Triangle","RightTriangle","Rectangle","Diamond","Parallelogram","Trapezoid","NonIsoscelesTrapezoid","Pentagon","Hexagon","Heptagon","Octagon","Decagon","Dodecagon","Star4","Star5","Star6","Star7","Star8","Star10","Star12","Star16","Star24","Star32","RoundRectangle","Round1Rectangle","Round2SameRectangle","Round2DiagonalRectangle","SnipRoundRectangle","Snip1Rectangle","Snip2SameRectangle","Snip2DiagonalRectangle","Plaque","Ellipse","Teardrop","HomePlate","Chevron","PieWedge","Pie","BlockArc","Donut","NoSmoking","RightArrow","LeftArrow","UpArrow","DownArrow","StripedRightArrow","NotchedRightArrow","BentUpArrow","LeftRightArrow","UpDownArrow","LeftUpArrow","LeftRightUpArrow","QuadArrow","LeftArrowCallout","RightArrowCallout","UpArrowCallout","DownArrowCallout","LeftRightArrowCallout","UpDownArrowCallout","QuadArrowCallout","BentArrow","UturnArrow","CircularArrow","LeftCircularArrow","LeftRightCircularArrow","CurvedRightArrow","CurvedLeftArrow","CurvedUpArrow","CurvedDownArrow","SwooshArrow","Cube","Can","LightningBolt","Heart","Sun","Moon","SmileyFace","IrregularSeal1","IrregularSeal2","FoldedCorner","Bevel","Frame","HalfFrame","Corner","DiagonalStripe","Chord","Arc","LeftBracket","RightBracket","LeftBrace","RightBrace","BracketPair","BracePair","Callout1","Callout2","Callout3","AccentCallout1","AccentCallout2","AccentCallout3","BorderCallout1","BorderCallout2","BorderCallout3","AccentBorderCallout1","AccentBorderCallout2","AccentBorderCallout3","WedgeRectCallout","WedgeRRectCallout","WedgeEllipseCallout","CloudCallout","Cloud","Ribbon","Ribbon2","EllipseRibbon","EllipseRibbon2","LeftRightRibbon","VerticalScroll","HorizontalScroll","Wave","DoubleWave","Plus","FlowChartProcess","FlowChartDecision","FlowChartInputOutput","FlowChartPredefinedProcess","FlowChartInternalStorage","FlowChartDocument","FlowChartMultidocument","FlowChartTerminator","FlowChartPreparation","FlowChartManualInput","FlowChartManualOperation","FlowChartConnector","FlowChartPunchedCard","FlowChartPunchedTape","FlowChartSummingJunction","FlowChartOr","FlowChartCollate","FlowChartSort","FlowChartExtract","FlowChartMerge","FlowChartOfflineStorage","FlowChartOnlineStorage","FlowChartMagneticTape","FlowChartMagneticDisk","FlowChartMagneticDrum","FlowChartDisplay","FlowChartDelay","FlowChartAlternateProcess","FlowChartOffpageConnector","ActionButtonBlank","ActionButtonHome","ActionButtonHelp","ActionButtonInformation","ActionButtonForwardNext","ActionButtonBackPrevious","ActionButtonEnd","ActionButtonBeginning","ActionButtonReturn","ActionButtonDocument","ActionButtonSound","ActionButtonMovie","Gear6","Gear9","Funnel","MathPlus","MathMinus","MathMultiply","MathDivide","MathEqual","MathNotEqual","CornerTabs","SquareTabs","PlaqueTabs","ChartX","ChartStar","ChartPlus"],enumValuesAlternateNames:["WedgeEllipseCallout:SpeechBubble","RightArrow:Arrow","MathEqual:Equation","Ellipse:Oval","Ellipse:Circle","FlowChartConnector:Connector","Straight:Line"],enumValuesToReject:["Flowchart"]}},{name:"description",required:!1,description:"The description of the shapeType that needs to be inserted.",type:"string"}]},{name:"format_shapes",alternateNames:["formatShapes","format_shape"],description:"Format the specified shapes using the given parameters.",returnVariable:{type:"void",description:""},args:[{name:"shapes",alternateNames:["scope"],required:!0,description:"The shapes to format.",type:"shapes",promptAlternative:{name:"scope"}},{name:"left",required:!1,description:"The left position of the shape.",type:"positiveNumber"},{name:"top",required:!1,description:"The top position of the shape.",type:"positiveNumber"},{name:"height",required:!1,description:"The height of the shape.",type:"positiveNumber"},{name:"width",required:!1,description:"The width of the shape.",type:"positiveNumber"},{name:"lineColor",required:!1,description:"The color of the shape's outline.",type:"color"},{name:"lineDashStyle",required:!1,description:"The dash style of the shape's outline.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Dash","DashDot","DashDotDot","LongDash","LongDashDot","RoundDot","Solid","SquareDot","LongDashDotDot","SystemDash","SystemDot","SystemDashDot"]}},{name:"lineStyle",required:!1,description:"The style of the shape's outline.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Single","ThickBetweenThin","ThickThin","ThinThick","ThinThin"]}},{name:"lineWeight",required:!1,description:"The weight of the shape's outline.",type:"positiveNumber"},{name:"lineTransparency",required:!1,description:"The transparency of the shape's outline.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"fillColor",required:!1,description:"The color of the shape's fill.",type:"color"},{name:"fillTransparency",required:!1,description:"The transparency of the shape's fill.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"shadowPreset",required:!1,description:"The preset type of the shadow.",type:"enum",validationArgs:{enumValues:["TopLeftInner","TopInner","TopRightInner","LeftInner","RightInner","BottomRightInner","BottomInner","BottomLeftInner","CenterInner","TopLeftOuter","TopOuter","TopRightOuter","LeftOuter","RightOuter","BottomRightOuter","BottomOuter","BottomLeftOuter","CenterOuter","Perspective1","Perspective2","Perspective3","Perspective4","Perspective5"]}},{name:"shadowAlign",required:!1,description:"The alignment of the shadow.",type:"enum",validationArgs:{enumValues:["TopLeft","Top","TopRight","Left","Right","BottomLeft","Bottom","BottomRight","Center"]}},{name:"shadowColor",required:!1,description:"The color of the shape's shadow.",type:"color"},{name:"shadowTransparency",required:!1,description:"The transparency of the shape's shadow.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"shadowScaleX",required:!1,description:"The horizontal scale of the shape's shadow in percentage of the size of the shape.",type:"number"},{name:"shadowScaleY",required:!1,description:"The vertical scale of the shape's shadow in percentage of the size of the shape.",type:"number"},{name:"shadowSkewX",required:!1,description:"The horizontal skew of the shape's shadow.",type:"number"},{name:"shadowSkewY",required:!1,description:"The vertical skew of the shape's shadow.",type:"number"},{name:"shadowRadius",required:!1,description:"The blur radius of the shape's shadow in points.",type:"number"},{name:"shadowAngle",required:!1,description:"The angle of the shape's shadow.",type:"rangedNumber",validationArgs:{min:0,max:359}},{name:"shadowDistance",required:!1,description:"The distance of the shape's shadow in points.",type:"rangedNumber",validationArgs:{min:0,max:200}},{name:"alignHorizontal",required:!1,description:"aligning shapes horizontally.",type:"enum",validationArgs:{enumValues:["Left","Right","Center"]}},{name:"alignVertical",required:!1,description:"aligning shapes vertically.",type:"enum",validationArgs:{enumValues:["Top","Middle","Bottom"]}},{name:"distribute",required:!1,description:"distributing shapes around the slide.",type:"enum",validationArgs:{enumValues:["Horizontal","Vertical"]}},{name:"alignRelative",required:!1,description:"aligning shapes with respect to a reference.",type:"enum",validationArgs:{enumValues:["Slide","SelectedObjects"]}},{name:"animation",required:!1,description:"If an animation should be applied.",type:"boolean",validationArgs:{correctionStrategy:["StringAsTrue"]}},{name:"animationType",required:!1,description:"The type of animation to be applied, default is entrance.",type:"enum",validationArgs:{enumValues:["Entrance","Exit","Emphasis"]}},{name:"animationName",required:!1,description:"The name of the animation to be applied, default is appear.",type:"enum",validationArgs:{enumValues:["Appear","Fade","FlyIn","FloatIn","Split","Wipe","Shape","Wheel","RandomBars","GrowAndTurn","Zoom","Swivel","Bounce","Pulse","ColorPulse","Teeter","Spin","GrowShrink","Desaturate","Darken","Lighten","Transparency","ObjectColor","ComplementaryColor","LineColor","FillColor","BrushColor","FontColor","Underline","BoldFlash","BoldReveal","Wave","Disappear","FlyOut","FloatOut","ShrinkAndTurn"]}},{name:"animationDuration",required:!1,description:"The duration of the animation to be applied in milliseconds.",type:"number"},{name:"animationDelay",required:!1,description:"The delay of the animation to be applied in milliseconds.",type:"number"},{name:"zOrder",required:!1,description:"The order of the shape along the depth axis.",type:"enum",validationArgs:{enumValues:["Front","Forward","Backward","Back"]}}]},{name:"delete_shapes",alternateNames:["deleteShapes","delete_shape"],description:"Delete the specified shapes.",returnVariable:{type:"void",description:""},args:[{name:"shapes",alternateNames:["scope"],required:!0,description:"The shapes to delete.",type:"shapes",promptAlternative:{name:"scope"}}]},{name:"select_semantic_shape",alternateNames:["selectSemanticShape"],description:"Selects shapes based on natural language descriptions of their content within the presentation. This function is best used when you want to select shapes based on its text content, rather than its style, position, or location within the presentation. For example, if you want to select shapes containing text that discusses a specific topic, you can use this function to describe the desired text content within the shape in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"shapes",description:"The shapes that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the shapes to select.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body","Image:Picture"]}}]},{name:"select_indices_shape",alternateNames:[],description:"Selects shapes using the given shape indices.",returnVariable:{type:"shapes",description:"The shapes matching the given shape indices."},args:[{name:"indices",required:!0,description:"The shape indices that match the given selection criteria.",type:"string"}]},{name:"select_slides",alternateNames:["selectSlides","select_slide"],description:"Selects slides using the given scope and index.",returnVariable:{type:"slides",description:"The slides that match the given selection criteria."},args:[{name:"scope",required:!1,description:'The scope from which slides should be selected. The default value is "Selection", which selects the current selection of slide(s). Use "Presentation" to select all slides in the presentation.',type:"enum",validationArgs:{enumValues:["Selection","Presentation"]}},{name:"index",required:!1,description:"The index of the slide to select. index is 0-based. For example, index of fourth slide is 3.",type:"selectionIndexExtended"},{name:"id",required:!1,description:"The creation ID of the slide to select.",type:"string"}]},{name:"create_new_presentation_using_source",alternateNames:["createNewPresentationUsingSource","create_new_presentation_using_source"],description:"Generates and inserts a new presentation of slides by transforming a source file. Use when creating a slideshow, presentation, or PPT.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides we will be replacing when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"source",alternateNames:["file","document"],required:!0,description:"The source file to use when generating slides.",type:"string"}]},{name:"create_new_presentation_using_prompt",alternateNames:["createNewPresentationUsingPrompt","create_new_presentation_using_prompt"],description:"Generates a new presentation of slides from a prompt and replaces the existing slides with it. Use when creating a slideshow, presentation, or PPT.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides we will be replacing when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!0,description:"The prompt to use when generating a new presentation.",type:"string"}]},{name:"create_slides_using_prompt",alternateNames:["createSlidesUsingPrompt","create_slides_using_prompt"],description:"Generates new slide(s) from a prompt and inserts them after the given slides.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!0,description:"The prompt to use when generating slides.",type:"string"}]},{name:"generate_slides",alternateNames:["generateSlides","generate_slide"],description:"Do Not use this function",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides. Required when adding slides, but not needed when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!1,description:"The prompt to use when generating slides.",type:"string",validationArgs:{correctionStrategy:["EnsureSingleValue"]}},{name:"source",alternateNames:["file","document"],required:!1,description:"The source file to use when generating slides.",type:"string"},{name:"createPresentation",required:!1,description:"If the generate_slides statement is for presentation creation. Default is false. True when generating a new presentation via prompt or from source file.",type:"boolean"}]},{name:"generate_slides",alternateNames:["generateSlides","generate_slide"],description:"Performs 1 of 3 tasks, all of which insert new slide(s). 1) Generate new slide(s) from a prompt and inserts them after the given slides. 2) Generate a new presentation of slides by transforming a source file. 3) Generate a new presentation of slides from a prompt.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides. Required when adding slides, but not needed when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!1,description:"The prompt to use when generating slides. Default is false.",type:"string"},{name:"source",alternateNames:["file","document"],required:!1,description:"The source file to use when generating slides. Default is blank.",type:"string"},{name:"createPresentation",required:!1,description:"If the generate_slides statement is for presentation creation. Default is false. True when generating a new presentation via prompt or from source file.",type:"boolean"}]},{name:"format_slides",alternateNames:["formatSlides","format_slide"],description:"Arranges the given slide or presentation in a particular style when Human asks for it. Powerpoint uses designer to format the slides.",returnVariable:{type:"slides",description:"The slides that were formatted."},args:[{name:"slides",alternateNames:["scope"],required:!0,description:"The slides to format.",type:"slides",promptAlternative:{name:"scope"},validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"strategy",required:!1,description:'The formatting strategy to apply. Use "beautify" on 1+ slides to making them prettier. Use "organize" to reorganize the entire presentation, making it more structured. Use "ThemeIdeas" to try a new design on the entire presentation.',type:"enum",validationArgs:{enumValues:["beautify","organize","ThemeIdeas"],enumValuesAlternateNames:["organize:structure"],correctionStrategy:["Dismissable","ReplaceStructureWithOrganize"]}},{name:"animation",required:!1,description:"If an animation should be applied.",type:"boolean",validationArgs:{correctionStrategy:["StringAsTrue"]}},{name:"isVisible",required:!1,description:"If the slide is visible.",type:"boolean"},{name:"targetFormatSlideByIndex",required:!1,description:"The index of the slides whose format we should follow for transform.",type:"selectionIndexExtended"}]},{name:"delete_slides",alternateNames:["deleteSlides","delete_slide"],description:"Deletes the given slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",alternateNames:["scope"],required:!0,description:"The slides to delete.",type:"slides",promptAlternative:{name:"scope"}}]},{name:"move_slides",alternateNames:["moveSlides","move_slide"],description:"Moves slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!0,description:"The slides to move.",type:"slides"},{name:"precededBy",alternateNames:["target"],required:!0,description:"The target slides besides which we move the slides to.",type:"slides",promptAlternative:{name:"target"}},{name:"before",required:!1,description:"Whether to move the slides before or after the target. The default value is false.",type:"boolean"}]},{name:"transition_slides",alternateNames:["transitionSlides","transition_slide"],description:"Transitions slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!1,description:"The slides to transition.",type:"slides"},{name:"type",required:!1,description:"The type of the transition.",type:"enum",validationArgs:{enumValues:["None","Morph","Fade","Push","Wipe","Split","Reveal","Cut","RandomBars","Shape","Uncover","Cover","Flash","FallOver","Drape","Curtains","Wind","Prestige","Fracture","Crush","PeelOff","PageCurl","Airplane","Origami","Dissolve","Checkerboard","Blinds","Clock","Ripple","Honeycomb","Glitter","Vortex","Shred","Switch","Flip","Gallery","Cube","Doors","Box","Comb","Zoom","Random","Pan","FerrisWheel","Conveyor","Rotate","Window","Orbit","FlyThrough"]}},{name:"time",required:!1,description:"The length of the transition in seconds.",type:"positiveNumber"},{name:"delay",required:!1,description:"The number of second to delay before moving to the next slide.",type:"positiveNumber"}]},{name:"select_semantic_slide",alternateNames:["selectSemanticSlide"],description:"Selects slides based on natural language descriptions of their content within the presentation. This function is best used when you want to select slides based on its text content, rather than its position or location within the presentation. For example, if you want to select slides containing text that discusses a specific topic, you can use this function to describe the desired text content in the slide in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"slides",description:"The slides that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the shapes on a slide to evaluate the selection criteria.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body"]}}]},{name:"select_indices_slide",alternateNames:[],description:"Selects slides using the given slide indices.",returnVariable:{type:"slides",description:"The slides matching the given shape indices."},args:[{name:"indices",required:!0,description:"The slide indices that match the given selection criteria.",type:"string"}]},{name:"rewrite_slides",alternateNames:["rewriteSlides","rewrite_slide"],description:"Rewrites slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!0,description:"The slides to rewrite.",type:"slides"},{name:"prompt",required:!0,description:"The prompt to use when rewriting slides.",type:"string"}]},{name:"select_text",alternateNames:["selectText"],description:"Selects text using the given scope, text pattern, or index. Defaults to current user selection if no parameters are provided.",returnVariable:{type:"textRanges",description:"The textRanges that match the given selection criteria."},args:[{name:"scope",required:!1,description:'The scope from which text should be selected. Default is user selection. shapes and slides are target entities obtained from other functions. "Presentation" selects all text in the presentation.',type:["shapes","slides","Presentation"],validationArgs:{correctionStrategy:["Dismissable"]}},{name:"text",required:!1,description:"The text to select.",type:"stringOrRegex"},{name:"index",required:!1,description:"The occurrence of matched text to select.",type:"selectionIndex"},{name:"name",required:!1,description:"The name of the text boxes to select.",type:"string",validationArgs:{correctionStrategy:["TitleSubtitleNameFixup"]}}]},{name:"insert_text",alternateNames:["insertText"],description:"Inserts provided text after the selected textRanges.",returnVariable:{type:"textRanges",description:"The textRanges that were inserted."},args:[{name:"precededBy",required:!0,description:"The textRange after which we should insert the text.",type:"textRanges",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_text"]}},{name:"text",required:!0,description:"The text to insert.",type:"string"}]},{name:"format_text",alternateNames:["formatText"],description:"Format the specified textRanges using the given arguments.",returnVariable:{type:"void",description:""},args:[{name:"textRanges",alternateNames:["scope"],required:!0,description:"The textRanges to format.",type:"textRanges",promptAlternative:{name:"scope"}},{name:"color",alternateNames:["fontColor"],required:!1,description:"The text color to apply.",type:"color"},{name:"bold",required:!1,description:"Whether the text should be bold.",type:"boolean"},{name:"italic",required:!1,description:"Whether the text should be italic.",type:"boolean"},{name:"underline",required:!1,description:"The underline style to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Dash","DashHeavy","DashLong","DashLongHeavy","DotDash","DotDashHeavy","DotDotDash","DotDotDashHeavy","Dotted","DottedHeavy","Double","Heavy","None","Single","Wavy","WavyDouble","WavyHeavy"],enumValuesAlternateNames:["None:false","Wavy:Wave"]}},{name:"fontName",required:!1,description:"The font name to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Abadi","Agency FB","Aharoni","Aldhabi","Algerian","Amasis MT Pro","Angsana New","AngsanaUPC","Aparajita","Aptos","Arabic Typesetting","Arial","Arial Nova","Arial Rounded MT","Avenir Next LT Pro","Baguet Script","Bahnschrift","Baskerville Old Face","Batang","BatangChe","Bell MT","Berlin Sans FB","Bernard MT","Bierstadt","Bierstadt Display","Biome","Blackadder ITC","Bodoni MT","Bodoni MT Poster","Book Antiqua","Bookman Old Style","Bradley Hand ITC","Britannic","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Calibri","Californian FB","Calisto MT","Cambria","Cambria Math","Candara","Castellar","Cavolini","Century","Century Gothic","Century Schoolbook","Chamberi Super Display","Chiller","Cochocib Script Latin Pro","Colonna MT","Comic Sans MS","Congenial","Consolas","Constantia","Cooper","Copperplate Gothic","Corbel","Cordia New","CordiaUPC","Courier New","Curlz MT","DaunPenh","David","Daytona","DengXian","DilleniaUPC","DokChampa","Dotum","DotumChe","Dreaming Outloud Pro","Calibri Light","Georgia Pro","Sitka Heading","Sitka Text","Times New Roman","Verdana Pro","Dreaming Outloud Script Pro","Dubai","Ebrima","Edwardian Script ITC","Elephant Pro","Eras ITC","EucrosiaUPC","Euphemia","Fairwater Script","FangSong","Fave Script Pro","Felix Titling","Footlight MT","Forte","Forte Forward","Franklin Gothic","Franklin Gothic Book","FrankRuehl","FreesiaUPC","Freestyle Script","Gabriola","Gadugi","Garamond","Gautami","Georgia","Gigi","Gill Sans MT","Gill Sans Nova","Gisha","Gloucester MT","Goudy Old Style","Goudy Type","Grandview","Grandview Display","Grotesque","Gulim","GulimChe","Gungsuh","GungsuhChe","Hadassah Friedlaender","Harrington","HGGothicE","HGMaruGothicMPRO","HGMinchoE","HGPGothicE","HGPMinchoE","HGPSoeiKakugothicUB","HGSGothicE","HGSMinchoE","HGSoeiKakugothicUB","HGSSoeiKakugothicUB","High Tower Text","Impact","Imprint MT Shadow","Ink Free","IrisUPC","Iskoola Pota","JasmineUPC","Javanese Text","Jokerman","Juice ITC","Jumble","KaiTi","Kalinga","Kartika","Khmer UI","Kigelia","Kigelia Arabic","KodchiangUPC","Kokila","Kristen ITC","Kunstler Script","Lao UI","Latha","Leelawadee","Leelawadee UI","Levenim MT","LilyUPC","Lucida Bright","Lucida Calligraphy","Lucida Fax","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Magneto","Maiandra GD","Malgun Gothic","Mangal","Mangal Pro","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft GothicNeo","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft YaHei UI","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Miriam","Miriam Fixed","Mistral","Modern Love","Modern Love Caps","Modern Love Grunge","Modern No. 20","Mongolian Baiti","MoolBoran","MS Gothic","MS Mincho","MS PGothic","MS PMincho","MS UI Gothic","MT Extra","MV Boli","Myanmar Text","Mystical Woods Rough Script","Mystical Woods Smooth Script","Narkisim","Neue Haas Grotesk Text Pro","News Gothic MT","Niagara Engraved","Niagara Solid","Nirmala Text","Nirmala UI","Nordique Inline","NSimSun","Nyala","OCRB","Onyx","Palace Script MT","Palatino Linotype","Papyrus","Perpetua","Perpetua Titling MT","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Posterama","Pristina","Quire Sans","Raavi","Rage","Rastanty Cortez","Ravie","Rockwell","Rockwell Nova","Rod","Sabon Next LT","Sagona","Sagona Book","Sakkal Majalla","Sanskrit Text","Script MT","Seaford","Seaford Display","Segoe Print","Segoe Script","Segoe UI","Segoe UI Emoji","Segoe UI Historic","Segoe UI Symbol","Segoe UI Semibold","Selawik","Shonar Bangla","Shruti","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Small","Sitka Subheading","Skeena","Skeena Display","Snap ITC","Source Sans Pro","Speak Pro","STCaiyun","STFangsong","STHupo","STKaiti","STXihei","STXingkai","STXinwei","STZhongsong","Sylfaen","Symbol","Tahoma","Tempus Sans ITC","Tenorite","Tenorite Display","TH SarabunPSK","The Hand","The Serif Hand","Tisa Offc Serif Pro","Trade Gothic Inline","Trade Gothic Next","Trade Gothic Next Rounded","Traditional Arabic","Trebuchet MS","Tunga","Tw Cen MT","UD Digi Kyokasho N-B","UD Digi Kyokasho N-R","UD Digi Kyokasho NK-B","UD Digi Kyokasho NK-R","UD Digi Kyokasho NP-B","UD Digi Kyokasho NP-R","Univers","Urdu Typesetting","Utsaah","Vani","Verdana","Vijaya","Viner Hand ITC","Vivaldi","Vladimir Script","Vrinda","Walbaum Display","Walbaum Heading","Walbaum Text","Webdings","Wide Latin","Wingdings","Wingdings 2","Wingdings 3","Yu Gothic","Yu Gothic UI","Yu Mincho"]}},{name:"size",alternateNames:["fontSize"],required:!1,description:"The font size to apply.",type:"integer"},{name:"bulleted",required:!1,description:"Whether the text should be bulleted.",type:"boolean"},{name:"horizontalAlignment",required:!1,description:"The horizontal alignment to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Center","Distributed","Justify","JustifyLow","Left","Right","ThaiDistributed"],enumValuesAlternateNames:["Center:Middle"]}},{name:"verticalAlignment",required:!1,description:"The vertical alignment to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Bottom","BottomCentered","Middle","MiddleCentered","Top","TopCentered"],enumValuesAlternateNames:["Middle:Center"]}}]},{name:"delete_text",alternateNames:["deleteText"],description:"Clears the text in the specified textRanges.",returnVariable:{type:"void",description:""},args:[{name:"textRanges",alternateNames:["scope"],required:!0,description:"The textRanges to delete.",type:"textRanges",promptAlternative:{name:"scope"}}]},{name:"replace_text",alternateNames:["replaceText"],description:"Replaces the specified text with the specified new text.",returnVariable:{type:"void",description:""},args:[{name:"textToReplace",required:!0,description:"The text to replace.",type:"string"},{name:"newText",required:!0,description:"The new text to insert.",type:"string"}]},{name:"select_semantic_text",alternateNames:["selectSemanticText"],description:"Selects text ranges based on natural language descriptions of their content within the presentation. This function is best used when you want to select text ranges based on its content, rather than its exact wording, position, or location within the presentation. For example, if you want to select text ranges that discuss a specific topic, you can use this function to describe the desired selection in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"textRanges",description:"The text ranges that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the text boxes to select.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body"]}}]},{name:"select_indices_text",alternateNames:[],description:"Selects text ranges using the given shape reference and text.",returnVariable:{type:"textRanges",description:"The text ranges that reference the matching shape reference and text."},args:[{name:"indices",required:!0,description:"The text range reference that matches the given selection criteria.",type:"string"}]}];class Vt{static async handle(e,t,n){const r=e.body;if(r&&Ut.u.typeGuard(r))try{if(r?.odslResponse?.odsl?.statements&&r?.odslResponse?.odsl?.statements.length>0){const e=Vt.handleODSLResponse(r.odslResponse.odsl.statements,n);t.current?.addResponseMessage({chatCardType:Bt._.PlanBuilderCard,chatMessageData:{planBuilderCardProps:{user:Ae.Q9.Chat,chatMessage:"",tasks:e,handleStartClicked:e=>{if(e.length!==r?.odslResponse?.odsl?.statements.length)return void Ht.error("Mismatch in the number of confirmed tasks and original statements.");const t=[];for(let n=0;n<e.length;n++){const o=r?.odslResponse?.odsl?.statements[n],i=e[n].taskProperties,a=o&&i?this.replaceOdslStatementParameters(o,i):void 0;a&&t.push(a)}const o={odsl:{statements:t}};n.handlePlanStartClicked(o)}}}})}}catch(e){e instanceof Error&&this.showMarkdownErrorCard("Error displaying a plan for the Agent plan "+e.toString(),t)}}static handleODSLResponse(e,t){const n=[];return e.flatMap((e=>e.arguments.nested?JSON.parse(e.arguments.nested.json||"{}"):e)).forEach((e=>{n.push(this.extractCodeValues(e,t))})),n}static extractCodeValues(e,t){const n=[];e.argumentsArray?.forEach((r=>{const o=r.key,i=this.stringifyArgumentValue(r.value);n.push({name:this.getDescriptiveArgumentName(e.name,o,t),value:i,type:r.value.type,enumOptions:this.getArgumentEnumOptionsIfHas(e.name,o,t)})}));return{title:this.getDescriptiveStatementName(e.name,t),icon:this.getIcon(),taskProperties:n,description:this.getStatementDescription(e.name,t)}}static replaceOdslStatementParameters(e,t){const n=[],r=e.argumentsArray;for(let e=0;e<t.length;e++)r&&n.push({key:r[e].key||"",value:this.destringifyArgumentValue(t[e])});return{name:e.name,returns:e.returns,arguments:this.convertArgsArrayToOdslArguments(n),dismissedArguments:e.dismissedArguments,argumentsArray:n}}static convertArgsArrayToOdslArguments(e){const t={};return e.forEach((e=>{t[e.key]=e.value})),t}static stringifyArgumentValue(e){try{switch(e.type){case"string":case"color":case"formattedString":return e.string?e.string:"";case"regex":return e.regex?e.regex:"";case"var":case"scope":case"enum":return e.name?e.name:"";case"boolean":return e.boolean?"true":"false";case"number":return e.number?e.number.toString():"";case"jsonGrid":return e.json?e.json:"";case"stringList":return e.stringList?.join(", ")||"";case"numberList":return e.numberList?.join(", ")||"";default:return"Unsupported argument value type."}}catch(t){return"Failed to stringify argument value of type "+e.type}}static destringifyArgumentValue(e){const t={type:e.type};try{switch(e.type){case"string":case"color":case"formattedString":t.string=e.value;break;case"regex":t.regex=e.value;break;case"var":case"scope":case"enum":t.name=e.value;break;case"boolean":t.boolean="true"===e.value.toLowerCase();break;case"number":t.number=parseInt(e.value);break;case"jsonGrid":t.json=e.value;break;case"stringList":t.stringList=e.value.split(", ");break;case"numberList":t.numberList=e.value.split(", ").map((e=>parseInt(e)));break;default:t.string="Unsupported argument value type."}}catch(n){Ht.error("Failed to de-stringify argument "+e.value+" of type "+t.type)}return t}static getDescriptiveStatementName(e,t){const n=t.odslPlugins?.find((t=>t.name===e))?.description;return n||e}static getPluginByStatementName(e,t){return t.odslPlugins?.find((t=>t.name===e||t.alternateNames?.includes(e)))}static getStatementDescription(e,t){const n=this.getPluginByStatementName(e,t);return n?n.description:""}static getDescriptiveArgumentName(e,t,n){const r=this.getPluginByStatementName(e,n);if(r){const e=r.args;for(const n of e)if(n.name===t)return n.description}return"Failed to get argument description"}static getArgumentEnumOptionsIfHas(e,t,n){const r=this.getPluginByStatementName(e,n);if(r){const e=r.args;for(const n of e)if(n.name===t&&void 0!==n.validationArgs)return n.validationArgs?.enumValues}}static getIcon(){return"PowerPoint"}static showMarkdownErrorCard(e,t){t.current?.addResponseMessage({chatCardType:Bt._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e}},chatMessageBodyData:void 0,stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!1})}}var jt=n(72360);const qt=(e,t)=>({queryId:t,query:e});class Wt{static generateId(){return Wt.operationId++,"CommandingDisambiguation-Input"+Wt.operationId.toString()}}Wt.operationId=0;class Yt extends ke.h{constructor(e,t,n){super(),this.baseHandler=e,this.copilotChatRef=t,this.settings=n}shouldSendRequestToAugloop(e){return this.baseHandler.shouldSendRequestToAugloop(e)}getWorkflowsToRegister(){return[...this.baseHandler.getWorkflowsToRegister(),{workflowAnnotationType:Ut.u.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:65e3}]}async getDefaultSignalOperation(e,t){const[n,r]=function(e,t){const n=qt(e,t);return[new jt.Q(n),Ut.u.getTypeName()]}(e,t);return{operation:new tt.g0({parentPath:["session"],items:[{id:Wt.generateId(),body:n}]}),workflowAnnotationType:r}}sendResponseToClient(e,t){const n=e.body?.chatResponse?.messages;n&&n.length>0&&this.copilotChatRef.current?.addResponseMessage({chatCardType:Bt._.MarkdownCard,chatMessageData:{markDownCardProps:{message:Qt(n[0].text)??zt}},stopLoadingUi:!0}),Vt.handle(e,this.copilotChatRef,this.settings);const r=e.id;if(!this.annotationId||this.annotationId!==r)return this.annotationId&&this.annotationId===r||(this.annotationId=r),this.baseHandler.sendResponseToClient(e,t)}sendEventToClient(e,t){return this.baseHandler.sendEventToClient(e,t)}getHostSettings(){return this.baseHandler.getHostSettings()}getALSession(){return this.baseHandler.getALSession()}getAuthToken(){return this.baseHandler.getAuthToken()}isFeatureGateEnabledFromClient(e){return this.baseHandler.isFeatureGateEnabledFromClient(e)}}const Qt=e=>{try{const t=JSON.parse(e)?.payload;return t?t.displayMessage:zt}catch(t){return e}};var Jt,Xt=n(88938),Kt=n(5847),Zt=n(41853);function $t(){return(0,M.bw)(M.WT.UseUpdatedZQMV2PromptString)?I.lhA.createPresentationAboutNationalPark():I.lhA.createPresentationConsumer()}function en(){return I.lhA.createFromFile()}function tn(){return(0,M.bw)(M.WT.UseUpdatedZQMV2PromptString)?I.lhA.addSlideAboutMeeting():I.lhA.addSlideAbout()}function nn(){return I.lhA.createPresentationAboutCollaboration()}function rn(e){return(0,ve.sQ)(e)?I.lhA.addAnImageOfCake():I.lhA.showKeySlidesFromThisPresentation()}function on(){return{suggestionCategory:I.hn.menuSectionSpeak(),suggestionText:I.UeP.speakWithCopilot(),iconRegular:Xt.T75,shouldSubmitQueryOnClick:!0}}!function(e){e.New="New",e.Existing="Existing",e.Unknown="Unknown"}(Jt||(Jt={}));var an=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,ve.cY)("getZQMV2Props called with presentationType: ".concat(e,", userType:").concat(t,", shouldRefresh:").concat(n,", deckTokenCount:").concat(r)),void 0===an.lastPresentationState&&(an.lastPresentationState=Jt.Unknown,an.lastStaticZQMs=[]);var o,i=!(0,M.PA)(M.IY.EnableZQMQuerySubmissionThroughChatInputBox),a=(0,M.bw)(M.WT.UseUpdatedZQMV2PromptString),s=(0,M.bw)(M.WT.ShowBrandingInZQM),c=e===Z.Ns.BLANK||e===Z.Ns.LESS_WORD_COUNT,u=(0,ve.$1)(t)&&(0,M.bw)(M.WT.EnableNewZQMsForNewPresentation),d=(0,ve.$1)(t)&&(0,M.bw)(M.WT.EnableNewZQMsForExistingPresentation),p=(0,M.bw)(M.WT.enableProactiveZQMWithSuggestedQnA),f=function(e,t,n,r){var o=[{suggestionCategory:I.hn.menuSectionCreate(),suggestionText:(0,ve.sQ)(e)&&!(0,Ne.f5)()?$t():en(),iconRegular:Kt.vfO,shouldLaunchCIQOnSelection:(0,ve.$1)(e),scopedEntity:N.ck.File,unSupportedEntities:(0,ve.M$)()?(0,Ne.lS)([N.ck.Event,N.ck.People,N.ck.Message]):void 0,promptClickHandledByClient:(0,We.X8)((0,ve.sQ)(e)&&!(0,Ne.f5)())?sn:void 0},{suggestionCategory:I.hn.menuSectionCreate(),suggestionText:r?(0,ve.sQ)(e)?tn():nn():I.lhA.createPresentationAbout(),iconRegular:Kt.vfO,promptClickHandledByClient:r&&(0,ve.sQ)(e)||!(0,We.X8)(!1)?void 0:sn},{suggestionCategory:I.hn.menuSectionUnderstand(),suggestionText:t?I.lhA.datesAndDeadlines():I.lhA.summarize(),iconRegular:Zt.uJg,shouldSubmitQueryOnClick:!t&&n},{suggestionCategory:I.hn.menuSectionUnderstand(),suggestionText:r?rn(e):I.lhA.showKeySlides(),iconRegular:Zt.uJg,shouldSubmitQueryOnClick:!t&&n}];return(0,M.bw)(M.WT.IsDesignerShownInZQM)&&o.push({suggestionCategory:I.hn.menuSectionCreateImage(),suggestionText:I.lhA.generateImage(),iconRegular:Zt.spT}),(0,M.bw)(M.WT.IsRealtimeVoiceEnabled)&&(0,M.PA)(M.IY.IsRealtimeVoiceZQMEnabled)&&o.push(on()),o}(t,c,i,a),h=null!==(o=ue._.getInstance().getSlideCount())&&void 0!==o?o:0,g=function(e){return e>4?"Existing":"New"}(h),m=an.lastPresentationState!==g;if((0,ve.cY)("getZQMV2Props slideCount: ".concat(h,", presentationState: ").concat(g,", isPresentationStateChanged: ").concat(m)),g===Jt.New&&u){var y=function(e,t){return[{suggestionCategory:I.hn.menuSectionCreate(),suggestionText:(0,ve.sQ)(e)&&!(0,Ne.f5)()?$t():en(),iconRegular:Kt.vfO,shouldLaunchCIQOnSelection:(0,ve.$1)(e),scopedEntity:N.ck.File,unSupportedEntities:(0,ve.M$)()?(0,Ne.lS)([N.ck.Event,N.ck.People,N.ck.Message]):void 0,promptClickHandledByClient:(0,We.X8)((0,ve.sQ)(e)&&!(0,Ne.f5)())?sn:void 0},{suggestionCategory:I.hn.menuSectionCreate(),suggestionText:t?(0,ve.sQ)(e)?tn():nn():I.lhA.createPresentationAbout(),iconRegular:Kt.vfO,promptClickHandledByClient:t&&(0,ve.sQ)(e)||!(0,We.X8)(!1)?void 0:sn}]}(t,a);if(m||n){var v=function(){var e=[{suggestionCategory:I.Fw6.TitleAddASlide(),suggestionText:I.Fw6.TextAddASlide(),iconRegular:Kt.vfO},{suggestionCategory:I.Fw6.TitleCoachMe(),suggestionText:I.Fw6.TextCoachMe(),iconRegular:Kt.vfO},{suggestionCategory:I.Fw6.TitleHowDoI(),suggestionText:I.Fw6.TextHowDoI(),iconRegular:Kt.vfO}];if((0,M.bw)(M.WT.IsDesignerShownInZQM)){var t={suggestionCategory:I.hn.menuSectionCreateImage(),suggestionText:I.lhA.generateImage(),iconRegular:Zt.spT},n={suggestionCategory:I.Fw6.TitleAddAStockImage(),suggestionText:I.Fw6.TextAddAStockImage(),iconRegular:Zt.spT};e.push(Math.random()>.5?t:n)}return(0,l._)((0,ve.R3)(e).slice(0,2))}();f=(0,l._)(y).concat((0,l._)(v)),an.lastStaticZQMs=v}else f=(0,l._)(y).concat((0,l._)(an.lastStaticZQMs))}else if(g===Jt.Existing&&d)if(m||n){var S=function(){var e=[{suggestionCategory:I.Fw6.TitleWhatsTheFocus(),suggestionText:I.Fw6.TextWhatsTheFocus(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleShowKeySlides(),suggestionText:I.Fw6.TextShowKeySlides(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleStayOnTrack(),suggestionText:I.Fw6.TextStayOnTrack(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleExtractKeyInformation(),suggestionText:I.Fw6.TextExtractKeyInformation(),iconRegular:Zt.uJg}],t=[{suggestionCategory:I.Fw6.TitleAddASlide(),suggestionText:I.Fw6.TextAddASlide(),iconRegular:Kt.vfO},{suggestionCategory:I.Fw6.TitleAddAnAgenda(),suggestionText:I.Fw6.TextAddAnAgenda(),iconRegular:Kt.vfO}];if((0,M.bw)(M.WT.IsDesignerShownInZQM)){var n,r=[{suggestionCategory:I.Fw6.TitleAddAnImage(),suggestionText:I.Fw6.TextAddAnImage(),iconRegular:Zt.spT},{suggestionCategory:I.Fw6.TitleAddAStockImage(),suggestionText:I.Fw6.TextAddAStockImage(),iconRegular:Zt.spT},{suggestionCategory:I.Fw6.TitleCreateAnImage(),suggestionText:I.Fw6.TextCreateAnImage(),iconRegular:Zt.spT}];(n=t).push.apply(n,(0,l._)(r))}var o=[];(0,M.bw)(M.WT.IsRealtimeVoiceEnabled)&&(0,M.PA)(M.IY.IsRealtimeVoiceZQMEnabled)&&o.push(on());var i=[{suggestionCategory:I.Fw6.TitleQuestionsFromAudience(),suggestionText:I.Fw6.TextQuestionsFromAudience(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleCoachMe(),suggestionText:I.Fw6.TextCoachMe(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleHowDoI(),suggestionText:I.Fw6.TextHowDoI(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleMainPoints(),suggestionText:I.Fw6.TextMainPoints(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleFindSpecificInformation(),suggestionText:I.Fw6.TextFindSpecificInformation(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleQuestionsForAudience(),suggestionText:I.Fw6.TextQuestionsForAudience(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleWhatsTheTone(),suggestionText:I.Fw6.TextWhatsTheTone(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleBePrepared(),suggestionText:I.Fw6.TextBePrepared(),iconRegular:Zt.uJg}];return(0,l._)((0,ve.R3)(e).slice(0,1)).concat((0,l._)((0,ve.R3)(t).slice(0,1)),(0,l._)((0,ve.R3)(o).slice(0,1)),(0,l._)((0,ve.R3)(i).slice(0,2)))}();f=(0,l._)(S),an.lastStaticZQMs=S}else f=(0,l._)(an.lastStaticZQMs);else g===Jt.Existing&&!d&&p&&(f=(0,l._)(function(e){var t=[{suggestionCategory:e?I.Fw6.TitleAddAnAgenda():I.Fw6.TitleExtractKeyInformation(),suggestionText:e?I.Fw6.TextAddAnAgenda():I.Fw6.TextExtractKeyInformation(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleShowKeySlides(),suggestionText:I.Fw6.TextShowKeySlides(),iconRegular:Zt.uJg},{suggestionCategory:I.Fw6.TitleQuestionsForAudience(),suggestionText:I.Fw6.TextQuestionsForAudience(),iconRegular:Zt.uJg}];return(0,M.bw)(M.WT.IsDesignerShownInZQM)&&t.push({suggestionCategory:I.Fw6.TitleAddAnImage(),suggestionText:I.Fw6.TextAddAnImage(),iconRegular:Zt.spT}),(0,M.bw)(M.WT.IsRealtimeVoiceEnabled)&&(0,M.PA)(M.IY.IsRealtimeVoiceZQMEnabled)&&t.push(on()),t}(c)));return an.lastPresentationState=g,{promptSuggestionList:f,showBranding:s,shouldShowInteractiveCard:(0,Ne.fe)(r)}},sn=function(){var e=(0,r._)((function(e,t){var n;return(0,c.__generator)(this,(function(r){return(0,ve.cY)("Create presentation ZQM click received for prompt:",t.suggestionText),n=t.suggestionText===I.lhA.createFromFile(),[2,Promise.resolve((0,Ne.df)(e,X.FX.ZQM,n))]}))}));return function(t,n){return e.apply(this,arguments)}}(),ln=n(13403),cn=n(60801),un=n(25420),dn=n(94831),pn=n(67815),fn=n(46866),hn=n(23343),gn=n(53224),mn=n(1373),yn=n(74930),vn=n(27465),Sn=n(97010);var Cn,bn=n(65817),En=n(46444),Tn=n(29336),wn=me.K.getInstance(),In=xe.B.getInstance(),Pn=(function(){var e=(0,r._)((function(e,t){var n,r,i,a,s;return(0,c.__generator)(this,(function(l){return r=W.t.getInstance().getChatRef(),Cn=(new Date).getTime(),$.R.getInstance().getState()!==Z.Nj.IDLE&&_.G.getInstance().addContextId(R.dB),i=(0,M.PA)(M.IY.IsSegmentToSlideSendTemplateIdEnabled)&&ue._.getInstance().isCreateNewFromBlank()?"":"NonEmptyTemplateId",a={correlationId:R.dB,segmentBlobs:e,language:oe.i.GetHostAppDisplayLanguage(),fCreateNewPresentation:re.Vv.IsSettingTrue(re.zj.PPTBBPresOutlineEnabled),entryPoint:I.$kB.Chat,sourceDocumentSensitivityLabels:t,templateId:i,jsonCmdApiVersion:(0,Ne.zx)(),fCreateJsonCmdList:(0,M.bw)(M.WT.IsCreateJsonCmdListForBumbleBeeEnabled)},s=new tt.Xr({parentPath:["Signal",gn.I.getTypeName()],items:[{id:mn.r.generateId(),body:new gn.I(a)}]}),$.R.getInstance().getState()===Z.Nj.IDLE||(null===(n=r.current)||void 0===n||n.submitOperation({operation:s,workflowAnnotationType:ye.f.getTypeName()}),Tn.r.getInstance().setSkillName(Z.B2.ContentTransform),In.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventType,P.a5.SegmentToSlideOperationSubmitted))),$.R.getInstance().setState(Z.Nj.WAITING_FOR_SEGMENT_TO_SLIDE_WF_RESPONSE)),[2]}))}))}(),function(){var e=(0,r._)((function(e,t,n,s,l,u,d){var p,f,h,g,m,y,v,S,C,b,E,T,w,A,k,x,N,O,D,L,F,B,U,z,G,V,j,q,W,Y,Q,J,K,ee,te,ne;return(0,c.__generator)(this,(function(re){switch(re.label){case 0:return $.R.getInstance().getState()===Z.Nj.IDLE?((0,ve.cY)("SegmentToSlideWorkflowHandler: ExecutionStateManager is in IDLE state. Returning \n"),[2]):((0,ve.cY)("".concat(ye.f.getTypeName()," response received\n Time Taken: ").concat((0,R.WU)(Cn),"s ")),$.R.getInstance().setState(Z.Nj.EXECUTING),wn.setResponseTime((0,R.WU)(R.qD)),p=e.body,f=null==p?void 0:p.slideResponses,h=null==p?void 0:p.presentationOutline,g=null==p?void 0:p.error,m=JSON.stringify(f),y=null==p?void 0:p.designerOptions,v=null==p?void 0:p.sourceDocumentSensitivityLabels,S=null==p?void 0:p.hasAddedImage,C=null==p?void 0:p.numberOfSlides,b=null==p?void 0:p.fileName,E=null==p?void 0:p.jsonCmdPayload,void 0!==p.correlationId&&(0,rt.Zp)(p.correlationId),T=In.getQueryGuid(),(0,rt.$j)(In,ye.f.getTypeName(),Cn,P.CT.SegmentToSlideResponseTime,P.CC.CreatePresentationFromDoc,d),w=new yn.DA({status:vn.Aw.failed,queryId:T,error:void 0}),void 0===g?[3,4]:((0,ve.cY)("Error from SegmentToSlide WF: ".concat(g,"\n json response : ").concat(m)),A=function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,ve.cY)("Error in SegmentToSlide, Type : ".concat(t.errorType,", Message : ").concat(t.message,"\n")),xe.B.getInstance().sendErrorTelemetry((0,rt.pN)((r={},(0,o._)(r,P.IC.ErrorMessage,"Error in SegmentToSlide Workflow , Type : ".concat(t.errorType)),(0,o._)(r,P.IC.ErrorCategory,P.S2.ContextIQ),r)));var a,s={errorType:"".concat(t.errorType),featureName:P.CC.CreatePresentationFromDoc};switch(t.errorType){case Sn.q.Overloaded:s.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,(0,ut.r5)(e,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,i,s),a=P.Nr.ThrottlingErrorMessage;break;case Sn.q.SlideGenerationFailed:case Sn.q.Error:case Sn.q.InvalidInput:case Sn.q.BlockedByRAI:s.errorMessage=PowerpointCopilotStrings.TransformFileGeneralError,(0,ut.r5)(e,PowerpointCopilotStrings.TransformFileGeneralError,void 0,void 0,i,s),a=P.Nr.TransformFileGeneralError;break;case Sn.q.Unauthorized:s.errorMessage=PowerpointCopilotStrings.CLPNoAccessPermission,(0,ut.r5)(e,PowerpointCopilotStrings.CLPNoAccessPermission,void 0,void 0,i,s),a=P.Nr.CLPNoAccessPermission;break;case Sn.q.CopilotLicensingError:s.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,(0,ut.r5)(e,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,i,s),a=P.Nr.LicenseValidationErrorMessage;break;default:s.errorMessage=PowerpointCopilotStrings.TransformFileGeneralError,(0,ut.r5)(e,PowerpointCopilotStrings.TransformFileGeneralError,void 0,void 0,i,s),(0,Se.hX)(n)||(n.error=PowerpointCopilotStrings.TransformFileGeneralError),a=P.Nr.TransformFileGeneralError}return a}(t,g,w,!(0,ft.w_)()),(0,rt.AQ)(In,R.qD,"".concat(ye.f.getTypeName(),"_Error"),g.errorType,Z.T_.Server,void 0,!(0,ft.w_)(),A),(0,ft.gj)()?[3,1]:($.R.getInstance().setState(Z.Nj.IDLE),_.G.getInstance().emptyContextIdListandCleanup(),[3,3])));case 1:return[4,(0,ft.Ge)(w,t)];case 2:re.sent(),re.label=3;case 3:return(0,hn.k)(!1,"SegmentToSlideWorkflow_".concat(g.errorType),X.Cu.CreatePresentationFromDoc),wn.resetData(),[2];case 4:return k=(new Date).getTime(),x={status:Z.rI.SUCCESS},N=[],O=[],wn.setScenarioName(X.Cu.CreatePresentationFromDoc),(0,M.bw)(M.WT.IsCreateJsonCmdListForBumbleBeeEnabled)&&E?(O=E.cmds,(0,ve.cY)("CreatePres Command Object created in Augloop"),[3,12]):[3,5];case 5:if((0,Se.hX)(f))return[3,11];for(D=0;D<f.length;D++)f[D].error?(0,ve.cY)("SlideResponse slide ".concat(D," has error. type: ").concat(null===(L=f[D].error)||void 0===L?void 0:L.errorType,"; message: ").concat(null===(F=f[D].error)||void 0===F?void 0:F.message)):N.push(f[D].slide);re.label=6;case 6:return re.trys.push([6,9,,10]),N.length>0?[4,(0,En.u)({slideResponseFromSegmentWF:N})]:[3,8];case 7:B=re.sent(),O.push(B),re.label=8;case 8:return[3,10];case 9:return U=re.sent(),(0,ve.cY)("CreatePres Command Object creation failed"+JSON.stringify(U)),x={status:Z.rI.FAILED,error:Z.Re.SEGMENT_TO_SLIDE_SERVER_ERROR},[3,10];case 10:return[3,12];case 11:(0,Se.hX)(h)?((0,ve.cY)("SlideResponse and presentationOutline response are undefined"),x={status:Z.rI.FAILED,error:Z.Re.SEGMENT_TO_SLIDE_SERVER_ERROR}):(z={name:X._u.CreatePresentationCmd,version:X.xv,data:h},O.push(z)),re.label=12;case 12:return G=H.n.getInstance(),O.length>0?(V={},j={scenarioName:X.Cu.CreatePresentationFromDoc,startTime:wn.getStartTime(),entryPoint:I.$kB.Chat,correlationId:T,timeToODSLMS:1e3*wn.getResponseTime(),timeODSLToJOfcMS:0,capability:wn.getCapability(),featureName:wn.getFeatureName(),subFeatureName:wn.getSubFeatureName()},(0,ve.cY)("scenarioOptions : ",JSON.stringify(j)),[4,(0,r._)((function(){var e,n,o,l,u;return(0,c.__generator)(this,(function(d){switch(d.label){case 0:return e=(0,M.bw)(M.WT.IsEmptyLabelFixForCLPv2FeatureEnabled),!(0,M.bw)(M.WT.IsApplyLabelUsingTryUpgradeLabelEnabled)||!(0,Mt.ID)()||!e&&(0,Ne.Of)(G)?[3,4]:e&&(0,Ne.Of)(G)?[3,3]:(n=!(0,ht.a3)())?[4,(0,Ne.E$)(G,x)]:[3,2];case 1:n=!d.sent(),d.label=2;case 2:if(n)return x=(0,a._)((0,i._)({},x),{status:Z.rI.FAILED,error:Z.Re.APPLY_CLP_LABEL_FAILED}),[2];d.label=3;case 3:return[3,5];case 4:(0,Se.hX)(v)||((0,ve.cY)("Applying label using docMetaData"),o={labelInfo:v},j.docMetadata=o),d.label=5;case 5:V.scenarioOptions=JSON.stringify(j),(0,Se.hX)(y)||(V.designerOptions=JSON.stringify(y)),d.label=6;case 6:return d.trys.push([6,8,,9]),(0,Ye.dD)()?s(!0):s(!1),null===(l=t.current)||void 0===l||l.updateLoadingComponentProps((0,i._)({loadingUiStringList:[PowerpointCopilotStrings.TransformFileLoadingUIMessage4,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIAlmostThere]},(0,Ne.$2)())),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,bn.Rf)(e,O,V)];case 1:return x=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 7:return d.sent(),(0,ve.cY)("log result : ",JSON.stringify(x)),[3,9];case 8:return u=d.sent(),(0,ve.cY)("Execution failed"+JSON.stringify(u)),x={status:Z.rI.FAILED,error:Z.Re.JOFC_EXCEPTION},[3,9];case 9:return[2]}}))}))()]):[3,14];case 13:return re.sent(),(0,M.PA)(M.IY.IsJofcCommandErrorTelemetryEnabled)&&x.status!==Z.rI.SUCCESS&&In.sendChatEventTelemetry((0,rt.pN)((W={},(0,o._)(W,P.h3.ChatEventType,P.a5.SegmentToSlideJOfcCommandsError),(0,o._)(W,P.h3.ChatEventParameters,Z.Re[null!==(q=x.error)&&void 0!==q?q:Z.Re.UNKNOWN_ERROR]),W))),[3,15];case 14:(0,hn.k)(!1,"SegmentToSlideWorkflow_NoCmdsGenerated",X.Cu.CreatePresentationFromDoc),re.label=15;case 15:switch(In.sendLatencyTelemetry((0,rt.pN)((0,o._)({},P.CT.QueryExecutionTime,(0,R.WU)(k)))),Y=gt.Lo.length>0&&""!==gt.Lo[0]&&(0,Se._r)(gt.U9),x.status){case Z.rI.BLOCKED:case Z.rI.UNSUPPORTED:case Z.rI.FAILED:case Z.rI.UNEXPECTED_VERSION:case Z.rI.USER_ABORTED:case Z.rI.PARTIAL_SUCCESS:return[3,16];case Z.rI.SUCCESS:return[3,17]}return[3,19];case 16:return(0,ln.af)(x,t,u,ye.f.getTypeName(),w,!(0,ft.w_)()),[3,19];case 17:return w.status=vn.Aw.success,[4,(0,ft.Yb)(Z.rI.SUCCESS)];case 18:return re.sent(),J=(0,I.a8z)()[2],Y&&(J.linkPrefix=gt.Lo.filter((function(e){return e})).join(" ")+" "),l(),K=!((0,M.bw)(M.WT.UseAIResponsesInODSLForSydney)&&(0,ft.w_)()),ee={featureName:wn.getFeatureName()},null===(Q=t.current)||void 0===Q||Q.addResponseMessage((0,Mt.a5)(b,S,C,K,n,ee)),In.sendChatEventTelemetry((0,rt.pN)((te={},(0,o._)(te,P.h3.ChatEventType,P.a5.TransformFileUsedWithCLP),(0,o._)(te,P.h3.ChatEventParameters,"IsEncrypted_".concat(G.isInDocSensitivityLabelEncrypted())),te))),In.sendChatEventTelemetry((0,rt.pN)((ne={},(0,o._)(ne,P.h3.ChatEventType,P.a5.QuerySuccessful),(0,o._)(ne,P.h3.ChatEventParameters,ye.f.getTypeName()),ne))),(0,rt.AQ)(In,R.qD,void 0,void 0,void 0,void 0,!(0,ft.w_)()),[3,19];case 19:return wn.resetData(),(0,ft.gj)()?[3,20]:($.R.getInstance().setState(Z.Nj.IDLE),_.G.getInstance().emptyContextIdListandCleanup(),[3,22]);case 20:return[4,(0,ft.Ge)(w,t)];case 21:re.sent(),re.label=22;case 22:return(0,ve.cY)("User Perceived Latency :  ".concat((0,R.WU)(R.qD)," sec")),[4,(0,lt.Ep)(t)];case 23:return re.sent(),[2]}}))}));return function(t,n,r,o,i,a,s){return e.apply(this,arguments)}}()),_n=xe.B.getInstance(),An=function(){var e=(0,r._)((function(e,t,n){var r,a,s,l,u,d,p,f,h,g,m,y;return(0,c.__generator)(this,(function(c){return a=null==e?void 0:e.body,s=null==a?void 0:a.correlationId,l=null==a?void 0:a.generatedSlideNumber,u=null==a?void 0:a.totalSlideNumber,_.G.getInstance().isValidAnnotationResponse(s)?((0,ve.cY)("".concat(ye.i.getTypeName()," response. correlationId: ").concat(s,", generatedSlideNumber: ").concat(l,", totalSlideNumber: ").concat(u)),0===u?(_n.sendChatEventTelemetry((0,rt.pN)((g={},(0,o._)(g,P.h3.ChatEventType,P.a5.SegmentToSlideProgress),(0,o._)(g,P.h3.ChatEventParameters,"total slide count is 0"),(0,o._)(g,P.h3.Cv,null!=n?n:""),(0,o._)(g,P.h3.UserQueryGuid,s),g))),[2,!1]):(m=Math.round(l/u*100).toString(),_n.sendChatEventTelemetry((0,rt.pN)((y={},(0,o._)(y,P.h3.ChatEventType,P.a5.SegmentToSlideProgress),(0,o._)(y,P.h3.ChatEventParameters,m),(0,o._)(y,P.h3.Cv,null!=n?n:""),(0,o._)(y,P.h3.UserQueryGuid,s),y))),"100"===m&&(m="98"),null===(r=t.current)||void 0===r||r.updateLoadingComponentProps((0,i._)({loadingUiStringList:[PowerpointCopilotStrings.LoadingUIGenerateSlides.replace("%s",m)]},(0,Ne.$2)())),[2,!0])):((0,ve.cY)("Ignoring segmentToSlideProgressAnnotationProcessor for correlationId: ".concat(s)),_n.sendChatEventTelemetry((0,rt.pN)((h={},(0,o._)(h,P.h3.ChatEventType,P.a5.InvalidContextIdResponse),(0,o._)(h,P.h3.ChatEventParameters,null!==(f=null===(p=e.body)||void 0===p||null===(d=p.H_)||void 0===d?void 0:d.T_)&&void 0!==f?f:""),(0,o._)(h,P.h3.Cv,null!=n?n:""),(0,o._)(h,P.h3.UserQueryGuid,s),h))),[2,!1])}))}));return function(t,n,r){return e.apply(this,arguments)}}(),kn=n(32217),xn=n(60849),Nn=n(88539),On=n(658),Dn=window.innerHeight-100,Ln=("".concat(Dn,"px"),(0,On.n)((0,Nn.f)({chatFreStack:{height:"calc(100vh - 50px)"}}))),Rn=(0,On.n)({ariaAnnouncer:{position:"absolute",width:"1px",height:"1px",margin:"-1px",padding:"0",overflow:"hidden",border:"0",clipPath:"inset(50%)",whiteSpace:"nowrap"}}),Fn={calloutStyles:{borderRadius:8},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:8,paddingHorizontal:0,paddingTop:8,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Mn=n(78172),Bn=function(e,t){return{promptGuideMenuData:{nodeType:"Root",text:I.hn.menuTitle(),children:(0,Mn.Y)(e,t)}}},Un=n(98483),zn=n(4085),Hn=n(25570),Gn=n(98174),Vn=n(36187);var jn=n(6919);const qn=e=>-1,Wn=e=>{};function Yn(){const{targetDocument:e}=(0,jn.Y)(),t=null==e?void 0:e.defaultView;return function(e,t){const n=_t.useRef(void 0),r=_t.useCallback(((r,o)=>(void 0!==n.current&&t(n.current),n.current=e(r,o),n.current)),[t,e]),o=_t.useCallback((()=>{void 0!==n.current&&(t(n.current),n.current=void 0)}),[t]);return _t.useEffect((()=>o),[o]),[r,o]}(t?t.setTimeout:qn,t?t.clearTimeout:Wn)}var Qn=n(8721),Jn=n(81127);var Xn=n(90166),Kn=n(30112);const Zn="fui-Label",$n="fui-Label__required",er=(0,Xn.X)({root:{Bahqtrf:"fk6fouc",sj55zd:"f19n0e5"},disabled:{sj55zd:"f1s2aq7o",Bbusuzp:"f1dcs8yz"},required:{sj55zd:"f1whyuy6",uwmqm3:["fruq291","f7x41pl"]},small:{Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm"},medium:{Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},large:{Be2twd7:"fod5ikn",Bg96gwp:"faaz57k",Bhrd7zp:"fl43uef"},semibold:{Bhrd7zp:"fl43uef"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1whyuy6{color:var(--colorPaletteRedForeground3);}",".fruq291{padding-left:var(--spacingHorizontalXS);}",".f7x41pl{padding-right:var(--spacingHorizontalXS);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}]]});var tr=n(36947);const nr=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const{disabled:n=!1,required:r=!1,weight:o="regular",size:i="medium"}=e;return{disabled:n,required:Gn.lq(!0===r?"*":r||void 0,{defaultProps:{"aria-hidden":"true"},elementType:"span"}),weight:o,size:i,components:{root:"label",required:"span"},root:Gn.Gk((0,Vn.g)("label",{ref:t,...e}),{elementType:"label"})}})(e,t);return(e=>{const t=er();e.root.className=(0,Kn.z)(Zn,t.root,e.disabled&&t.disabled,t[e.size],"semibold"===e.weight&&t.semibold,e.root.className),e.required&&(e.required.className=(0,Kn.z)($n,t.required,e.disabled&&t.disabled,e.required.className))})(n),(0,tr.$e)("useLabelStyles_unstable")(n),(e=>((0,Jn.C)(e),(0,Qn.FD)(e.root,{children:[e.root.children,e.required&&(0,Qn.Y)(e.required,{})]})))(n)}));nr.displayName="Label";const rr=_t.createContext(void 0),or={},ir=(rr.Provider,(e,t)=>{const{size:n}=null!==(r=_t.useContext(rr))&&void 0!==r?r:or;var r;const{appearance:o="primary",labelPosition:i="after",size:a=(null!=n?n:"medium"),delay:s=0}=e,l=(0,Hn.Bi)("spinner"),{role:c="progressbar",...u}=e,d=Gn.Gk((0,Vn.g)("div",{ref:t,role:c,...u},["size"]),{elementType:"div"}),[p,f]=_t.useState(!1),[h,g]=Yn();_t.useEffect((()=>{if(!(s<=0))return h((()=>{f(!0)}),s),()=>{g()}}),[h,g,s]);const m=Gn.lq(e.label,{defaultProps:{id:l},renderByDefault:!1,elementType:nr}),y=Gn.lq(e.spinner,{renderByDefault:!0,elementType:"span"});m&&d&&!d["aria-labelledby"]&&(d["aria-labelledby"]=m.id);return{appearance:o,delay:s,labelPosition:i,size:a,shouldRenderSpinner:!s||p,components:{root:"div",spinner:"span",spinnerTail:"span",label:nr},root:d,spinner:y,spinnerTail:Gn.Gk(e.spinnerTail,{elementType:"span"}),label:m}});var ar=n(96641);const sr="fui-Spinner",lr="fui-Spinner__spinner",cr="fui-Spinner__spinnerTail",ur="fui-Spinner__label",dr=(0,ar.y)("r82apo5",null,[".r82apo5{display:flex;align-items:center;justify-content:center;line-height:0;gap:8px;overflow:hidden;}"]),pr=(0,Xn.X)({vertical:{Beiy3e4:"f1vx9l62"}},{d:[".f1vx9l62{flex-direction:column;}"]}),fr=(0,ar.y)("rvgcg50","r15nd2jo",{r:[".rvgcg50{position:relative;flex-shrink:0;-webkit-mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);background-color:var(--colorBrandStroke2Contrast);color:var(--colorBrandStroke1);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:rb7n1on;}","@keyframes rb7n1on{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}",".r15nd2jo{position:relative;flex-shrink:0;-webkit-mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);background-color:var(--colorBrandStroke2Contrast);color:var(--colorBrandStroke1);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:r1gx3jof;}","@keyframes r1gx3jof{0%{transform:rotate(0deg);}100%{transform:rotate(-360deg);}}"],s:["@media screen and (forced-colors: active){.rvgcg50{background-color:HighlightText;color:Highlight;forced-color-adjust:none;}}","@media screen and (prefers-reduced-motion: reduce){.rvgcg50{animation-duration:1.8s;}}","@media screen and (forced-colors: active){.r15nd2jo{background-color:HighlightText;color:Highlight;forced-color-adjust:none;}}","@media screen and (prefers-reduced-motion: reduce){.r15nd2jo{animation-duration:1.8s;}}"]}),hr=(0,ar.y)("rxov3xa","r1o544mv",{r:[".rxov3xa{position:absolute;display:block;width:100%;height:100%;-webkit-mask-image:conic-gradient(transparent 105deg, white 105deg);mask-image:conic-gradient(transparent 105deg, white 105deg);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:var(--curveEasyEase);animation-name:r15mim6k;}",'.rxov3xa::before,.rxov3xa::after{content:"";position:absolute;display:block;width:100%;height:100%;animation:inherit;background-image:conic-gradient(currentcolor 135deg, transparent 135deg);}',"@keyframes r15mim6k{0%{transform:rotate(-135deg);}50%{transform:rotate(0deg);}100%{transform:rotate(225deg);}}",".rxov3xa::before{animation-name:r18vhmn8;}","@keyframes r18vhmn8{0%{transform:rotate(0deg);}50%{transform:rotate(105deg);}100%{transform:rotate(0deg);}}",".rxov3xa::after{animation-name:rkgrvoi;}","@keyframes rkgrvoi{0%{transform:rotate(0deg);}50%{transform:rotate(225deg);}100%{transform:rotate(0deg);}}",".r1o544mv{position:absolute;display:block;width:100%;height:100%;-webkit-mask-image:conic-gradient(transparent 105deg, white 105deg);mask-image:conic-gradient(transparent 105deg, white 105deg);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:var(--curveEasyEase);animation-name:r109gmi5;}",'.r1o544mv::before,.r1o544mv::after{content:"";position:absolute;display:block;width:100%;height:100%;animation:inherit;background-image:conic-gradient(currentcolor 135deg, transparent 135deg);}',"@keyframes r109gmi5{0%{transform:rotate(135deg);}50%{transform:rotate(0deg);}100%{transform:rotate(-225deg);}}",".r1o544mv::before{animation-name:r17whflh;}","@keyframes r17whflh{0%{transform:rotate(0deg);}50%{transform:rotate(-105deg);}100%{transform:rotate(0deg);}}",".r1o544mv::after{animation-name:re4odhl;}","@keyframes re4odhl{0%{transform:rotate(0deg);}50%{transform:rotate(-225deg);}100%{transform:rotate(0deg);}}"],s:["@media screen and (prefers-reduced-motion: reduce){.rxov3xa{animation-iteration-count:0;background-image:conic-gradient(transparent 120deg, currentcolor 360deg);}.rxov3xa::before,.rxov3xa::after{content:none;}}","@media screen and (prefers-reduced-motion: reduce){.r1o544mv{animation-iteration-count:0;background-image:conic-gradient(transparent 120deg, currentcolor 360deg);}.r1o544mv::before,.r1o544mv::after{content:none;}}"]}),gr=(0,Xn.X)({inverted:{De3pzq:"fr407j0",sj55zd:"f1f7voed"},rtlTail:{btxmck:"f179dep3",gb5jj2:"fbz9ihp",Br2kee7:"f1wkkxo7"},"extra-tiny":{Bqenvij:"fd461yt",a9b677:"fjw5fx7",qmp6fs:"f1v3ph3m"},tiny:{Bqenvij:"fjamq6b",a9b677:"f64fuq3",qmp6fs:"f1v3ph3m"},"extra-small":{Bqenvij:"frvgh55",a9b677:"fq4mcun",qmp6fs:"f1v3ph3m"},small:{Bqenvij:"fxldao9",a9b677:"f1w9dchk",qmp6fs:"f1v3ph3m"},medium:{Bqenvij:"f1d2rq10",a9b677:"f1szoe96",qmp6fs:"fb52u90"},large:{Bqenvij:"f8ljn23",a9b677:"fpdz1er",qmp6fs:"fb52u90"},"extra-large":{Bqenvij:"fbhnoac",a9b677:"feqmc2u",qmp6fs:"fb52u90"},huge:{Bqenvij:"f1ft4266",a9b677:"fksc0bp",qmp6fs:"fa3u9ii"}},{d:[".fr407j0{background-color:var(--colorNeutralStrokeAlpha2);}",".f1f7voed{color:var(--colorNeutralStrokeOnBrand2);}",".f179dep3{-webkit-mask-image:conic-gradient(white 255deg, transparent 255deg);mask-image:conic-gradient(white 255deg, transparent 255deg);}",".fbz9ihp::before,.fbz9ihp::after{background-image:conic-gradient(transparent 225deg, currentcolor 225deg);}",".fd461yt{height:16px;}",".fjw5fx7{width:16px;}",".f1v3ph3m{--fui-Spinner--strokeWidth:var(--strokeWidthThick);}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".fxldao9{height:28px;}",".f1w9dchk{width:28px;}",".f1d2rq10{height:32px;}",".f1szoe96{width:32px;}",".fb52u90{--fui-Spinner--strokeWidth:var(--strokeWidthThicker);}",".f8ljn23{height:36px;}",".fpdz1er{width:36px;}",".fbhnoac{height:40px;}",".feqmc2u{width:40px;}",".f1ft4266{height:44px;}",".fksc0bp{width:44px;}",".fa3u9ii{--fui-Spinner--strokeWidth:var(--strokeWidthThickest);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1wkkxo7{background-image:conic-gradient(currentcolor 0deg, transparent 240deg);}}",{m:"screen and (prefers-reduced-motion: reduce)"}]]}),mr=(0,Xn.X)({inverted:{sj55zd:"fonrgv7"},"extra-tiny":{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},tiny:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},"extra-small":{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},small:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},medium:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},"extra-large":{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},huge:{Bahqtrf:"fk6fouc",Be2twd7:"f1pp30po",Bhrd7zp:"fl43uef",Bg96gwp:"f106mvju"}},{d:[".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f106mvju{line-height:var(--lineHeightBase500);}"]}),yr=_t.forwardRef(((e,t)=>{const n=ir(e,t);return(e=>{const{labelPosition:t,size:n,appearance:r}=e,{dir:o}=(0,jn.Y)(),i=dr(),a=pr(),s=fr(),l=gr(),c=hr(),u=mr();e.root.className=(0,Kn.z)(sr,i,("above"===t||"below"===t)&&a.vertical,e.root.className),e.spinner&&(e.spinner.className=(0,Kn.z)(lr,s,l[n],"inverted"===r&&l.inverted,e.spinner.className)),e.spinnerTail&&(e.spinnerTail.className=(0,Kn.z)(cr,c,"rtl"===o&&l.rtlTail,e.spinnerTail.className)),e.label&&(e.label.className=(0,Kn.z)(ur,u[n],"inverted"===r&&u.inverted,e.label.className))})(n),(0,tr.$e)("useSpinnerStyles_unstable")(n),(e=>{(0,Jn.C)(e);const{labelPosition:t,shouldRenderSpinner:n}=e;return(0,Qn.FD)(e.root,{children:[e.label&&n&&("above"===t||"before"===t)&&(0,Qn.Y)(e.label,{}),e.spinner&&n&&(0,Qn.Y)(e.spinner,{children:e.spinnerTail&&(0,Qn.Y)(e.spinnerTail,{})}),e.label&&n&&("below"===t||"after"===t)&&(0,Qn.Y)(e.label,{})]})})(n)}));yr.displayName="Spinner";const vr="fui-Text",Sr=(0,Xn.X)({root:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi",Bhrd7zp:"figsok6",fsow6f:"fpgzoln",mc9l5x:"f1w7gpdv",Huce71:"f6juhto",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1gl81tg",ygn44y:"f2jf649"},nowrap:{Huce71:"fz5stix",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp"},truncate:{ygn44y:"f1cmbuwj"},block:{mc9l5x:"ftgm304"},italic:{B80ckks:"f1j4dglz"},underline:{w71qe1:"f13mvf36"},strikethrough:{w71qe1:"fv5q2k7"},strikethroughUnderline:{w71qe1:"f1drk4o6"},base100:{Be2twd7:"f13mqy1h",Bg96gwp:"fcpl73t"},base200:{Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm"},base400:{Be2twd7:"fod5ikn",Bg96gwp:"faaz57k"},base500:{Be2twd7:"f1pp30po",Bg96gwp:"f106mvju"},base600:{Be2twd7:"f1x0m3f5",Bg96gwp:"fb86gi6"},hero700:{Be2twd7:"fojgt09",Bg96gwp:"fcen8rp"},hero800:{Be2twd7:"fccw675",Bg96gwp:"f1ebx5kk"},hero900:{Be2twd7:"f15afnhw",Bg96gwp:"fr3w3wp"},hero1000:{Be2twd7:"fpyltcb",Bg96gwp:"f1ivgwrt"},monospace:{Bahqtrf:"f1fedwem"},numeric:{Bahqtrf:"f1uq0ln5"},weightMedium:{Bhrd7zp:"fdj6btp"},weightSemibold:{Bhrd7zp:"fl43uef"},weightBold:{Bhrd7zp:"flh3ekv"},alignCenter:{fsow6f:"f17mccla"},alignEnd:{fsow6f:"f12ymhq5"},alignJustify:{fsow6f:"f1j59e10"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fpgzoln{text-align:start;}",".f1w7gpdv{display:inline;}",".f6juhto{white-space:normal;}",[".f1gl81tg{overflow:visible;}",{p:-1}],".f2jf649{text-overflow:clip;}",".fz5stix{white-space:nowrap;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f1cmbuwj{text-overflow:ellipsis;}",".ftgm304{display:block;}",".f1j4dglz{font-style:italic;}",".f13mvf36{text-decoration-line:underline;}",".fv5q2k7{text-decoration-line:line-through;}",".f1drk4o6{text-decoration-line:line-through underline;}",".f13mqy1h{font-size:var(--fontSizeBase100);}",".fcpl73t{line-height:var(--lineHeightBase100);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f106mvju{line-height:var(--lineHeightBase500);}",".f1x0m3f5{font-size:var(--fontSizeBase600);}",".fb86gi6{line-height:var(--lineHeightBase600);}",".fojgt09{font-size:var(--fontSizeHero700);}",".fcen8rp{line-height:var(--lineHeightHero700);}",".fccw675{font-size:var(--fontSizeHero800);}",".f1ebx5kk{line-height:var(--lineHeightHero800);}",".f15afnhw{font-size:var(--fontSizeHero900);}",".fr3w3wp{line-height:var(--lineHeightHero900);}",".fpyltcb{font-size:var(--fontSizeHero1000);}",".f1ivgwrt{line-height:var(--lineHeightHero1000);}",".f1fedwem{font-family:var(--fontFamilyMonospace);}",".f1uq0ln5{font-family:var(--fontFamilyNumeric);}",".fdj6btp{font-weight:var(--fontWeightMedium);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".f17mccla{text-align:center;}",".f12ymhq5{text-align:end;}",".f1j59e10{text-align:justify;}"]});const Cr=function(e){const{useStyles:t,className:n,displayName:r}=e,o=_t.forwardRef(((e,r)=>{const o=t(),i=((e,t)=>{const{wrap:n,truncate:r,block:o,italic:i,underline:a,strikethrough:s,size:l,font:c,weight:u,align:d}=e;return{align:null!=d?d:"start",block:null!=o&&o,font:null!=c?c:"base",italic:null!=i&&i,size:null!=l?l:300,strikethrough:null!=s&&s,truncate:null!=r&&r,underline:null!=a&&a,weight:null!=u?u:"regular",wrap:null==n||n,components:{root:"span"},root:Gn.Gk((0,Vn.g)("span",{ref:t,...e}),{elementType:"span"})}})(e,r);return(e=>{const t=Sr();e.root.className=(0,Kn.z)(vr,t.root,!1===e.wrap&&t.nowrap,e.truncate&&t.truncate,e.block&&t.block,e.italic&&t.italic,e.underline&&t.underline,e.strikethrough&&t.strikethrough,e.underline&&e.strikethrough&&t.strikethroughUnderline,100===e.size&&t.base100,200===e.size&&t.base200,400===e.size&&t.base400,500===e.size&&t.base500,600===e.size&&t.base600,700===e.size&&t.hero700,800===e.size&&t.hero800,900===e.size&&t.hero900,1e3===e.size&&t.hero1000,"monospace"===e.font&&t.monospace,"numeric"===e.font&&t.numeric,"medium"===e.weight&&t.weightMedium,"semibold"===e.weight&&t.weightSemibold,"bold"===e.weight&&t.weightBold,"center"===e.align&&t.alignCenter,"end"===e.align&&t.alignEnd,"justify"===e.align&&t.alignJustify,e.root.className)})(i),i.root.className=(0,Kn.z)(n,i.root.className,o.root,e.className),(e=>((0,Jn.C)(e),(0,Qn.Y)(e.root,{})))(i)}));return o.displayName=r,o}({useStyles:(0,Xn.X)({root:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),className:"fui-Body1",displayName:"Body1"});var br=_t.lazy((function(){return Promise.all([n.e(9412),n.e(3181)]).then(n.bind(n,44371)).then((function(e){return{default:e.LazyLoadedDesigner}}))})),Er=n(42850);function Tr(e){let t=e.length;for(;--t>=0;)e[t]=0}const wr=256,Ir=286,Pr=30,_r=15,Ar=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),kr=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),xr=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Nr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Or=new Array(576);Tr(Or);const Dr=new Array(60);Tr(Dr);const Lr=new Array(512);Tr(Lr);const Rr=new Array(256);Tr(Rr);const Fr=new Array(29);Tr(Fr);const Mr=new Array(Pr);function Br(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let Ur,zr,Hr;function Gr(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Tr(Mr);const Vr=e=>e<256?Lr[e]:Lr[256+(e>>>7)],jr=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},qr=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,jr(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},Wr=(e,t,n)=>{qr(e,n[2*t],n[2*t+1])},Yr=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Qr=(e,t,n)=>{const r=new Array(16);let o,i,a=0;for(o=1;o<=_r;o++)a=a+n[o-1]<<1,r[o]=a;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=Yr(r[t]++,t))}},Jr=e=>{let t;for(t=0;t<Ir;t++)e.dyn_ltree[2*t]=0;for(t=0;t<Pr;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Xr=e=>{e.bi_valid>8?jr(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Kr=(e,t,n,r)=>{const o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]},Zr=(e,t,n)=>{const r=e.heap[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&Kr(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Kr(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r},$r=(e,t,n)=>{let r,o,i,a,s=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+s++],r+=(255&e.pending_buf[e.sym_buf+s++])<<8,o=e.pending_buf[e.sym_buf+s++],0===r?Wr(e,o,t):(i=Rr[o],Wr(e,i+wr+1,t),a=Ar[i],0!==a&&(o-=Fr[i],qr(e,o,a)),r--,i=Vr(r),Wr(e,i,n),a=kr[i],0!==a&&(r-=Mr[i],qr(e,r,a)))}while(s<e.sym_next);Wr(e,256,t)},eo=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.elems;let a,s,l,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<i;a++)0!==n[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,o&&(e.static_len-=r[2*l+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)Zr(e,n,a);l=i;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Zr(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[2*l]=n[2*a]+n[2*s],e.depth[l]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[2*a+1]=n[2*s+1]=l,e.heap[1]=l++,Zr(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,u,d,p,f,h,g=0;for(p=0;p<=_r;p++)e.bl_count[p]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)u=e.heap[c],p=n[2*n[2*u+1]+1]+1,p>l&&(p=l,g++),n[2*u+1]=p,u>r||(e.bl_count[p]++,f=0,u>=s&&(f=a[u-s]),h=n[2*u],e.opt_len+=h*(p+f),i&&(e.static_len+=h*(o[2*u+1]+f)));if(0!==g){do{for(p=l-1;0===e.bl_count[p];)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(p=l;0!==p;p--)for(u=e.bl_count[p];0!==u;)d=e.heap[--c],d>r||(n[2*d+1]!==p&&(e.opt_len+=(p-n[2*d+1])*n[2*d],n[2*d+1]=p),u--)}})(e,t),Qr(n,c,e.bl_count)},to=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=a,a=t[2*(r+1)+1],++s<l&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4))},no=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(o=a,a=t[2*(r+1)+1],!(++s<l&&o===a)){if(s<c)do{Wr(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==i&&(Wr(e,o,e.bl_tree),s--),Wr(e,16,e.bl_tree),qr(e,s-3,2)):s<=10?(Wr(e,17,e.bl_tree),qr(e,s-3,3)):(Wr(e,18,e.bl_tree),qr(e,s-11,7));s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4)}};let ro=!1;const oo=(e,t,n,r)=>{qr(e,0+(r?1:0),3),Xr(e),jr(e,n),jr(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var io=e=>{ro||((()=>{let e,t,n,r,o;const i=new Array(16);for(n=0,r=0;r<28;r++)for(Fr[r]=n,e=0;e<1<<Ar[r];e++)Rr[n++]=r;for(Rr[n-1]=r,o=0,r=0;r<16;r++)for(Mr[r]=o,e=0;e<1<<kr[r];e++)Lr[o++]=r;for(o>>=7;r<Pr;r++)for(Mr[r]=o<<7,e=0;e<1<<kr[r]-7;e++)Lr[256+o++]=r;for(t=0;t<=_r;t++)i[t]=0;for(e=0;e<=143;)Or[2*e+1]=8,e++,i[8]++;for(;e<=255;)Or[2*e+1]=9,e++,i[9]++;for(;e<=279;)Or[2*e+1]=7,e++,i[7]++;for(;e<=287;)Or[2*e+1]=8,e++,i[8]++;for(Qr(Or,287,i),e=0;e<Pr;e++)Dr[2*e+1]=5,Dr[2*e]=Yr(e,5);Ur=new Br(Or,Ar,257,Ir,_r),zr=new Br(Dr,kr,0,Pr,_r),Hr=new Br(new Array(0),xr,0,19,7)})(),ro=!0),e.l_desc=new Gr(e.dyn_ltree,Ur),e.d_desc=new Gr(e.dyn_dtree,zr),e.bl_desc=new Gr(e.bl_tree,Hr),e.bi_buf=0,e.bi_valid=0,Jr(e)},ao=(e,t,n,r)=>{let o,i,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<wr;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),eo(e,e.l_desc),eo(e,e.d_desc),a=(e=>{let t;for(to(e,e.dyn_ltree,e.l_desc.max_code),to(e,e.dyn_dtree,e.d_desc.max_code),eo(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Nr[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=o&&(o=i)):o=i=n+5,n+4<=o&&-1!==t?oo(e,t,n,r):4===e.strategy||i===o?(qr(e,2+(r?1:0),3),$r(e,Or,Dr)):(qr(e,4+(r?1:0),3),((e,t,n,r)=>{let o;for(qr(e,t-257,5),qr(e,n-1,5),qr(e,r-4,4),o=0;o<r;o++)qr(e,e.bl_tree[2*Nr[o]+1],3);no(e,e.dyn_ltree,t-1),no(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),$r(e,e.dyn_ltree,e.dyn_dtree)),Jr(e),r&&Xr(e)},so=(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Rr[n]+wr+1)]++,e.dyn_dtree[2*Vr(t)]++),e.sym_next===e.sym_end),lo={_tr_init:io,_tr_stored_block:oo,_tr_flush_block:ao,_tr_tally:so,_tr_align:e=>{qr(e,2,3),Wr(e,256,Or),(e=>{16===e.bi_valid?(jr(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var co=(e,t,n,r)=>{let o=65535&e,i=e>>>16&65535,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{o=o+t[r++]|0,i=i+o|0}while(--a);o%=65521,i%=65521}return o|i<<16};const uo=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var po=(e,t,n,r)=>{const o=uo,i=r+n;e^=-1;for(let n=r;n<i;n++)e=e>>>8^o[255&(e^t[n])];return~e},fo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ho={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:go,_tr_stored_block:mo,_tr_flush_block:yo,_tr_tally:vo,_tr_align:So}=lo,{Z_NO_FLUSH:Co,Z_PARTIAL_FLUSH:bo,Z_FULL_FLUSH:Eo,Z_FINISH:To,Z_BLOCK:wo,Z_OK:Io,Z_STREAM_END:Po,Z_STREAM_ERROR:_o,Z_DATA_ERROR:Ao,Z_BUF_ERROR:ko,Z_DEFAULT_COMPRESSION:xo,Z_FILTERED:No,Z_HUFFMAN_ONLY:Oo,Z_RLE:Do,Z_FIXED:Lo,Z_DEFAULT_STRATEGY:Ro,Z_UNKNOWN:Fo,Z_DEFLATED:Mo}=ho,Bo=258,Uo=262,zo=42,Ho=113,Go=666,Vo=(e,t)=>(e.msg=fo[t],t),jo=e=>2*e-(e>4?9:0),qo=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Wo=e=>{let t,n,r,o=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=o?n-o:0}while(--t);t=o,r=t;do{n=e.prev[--r],e.prev[r]=n>=o?n-o:0}while(--t)};let Yo=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Qo=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Jo=(e,t)=>{yo(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Qo(e.strm)},Xo=(e,t)=>{e.pending_buf[e.pending++]=t},Ko=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Zo=(e,t,n,r)=>{let o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),n),1===e.state.wrap?e.adler=co(e.adler,t,o,n):2===e.state.wrap&&(e.adler=po(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)},$o=(e,t)=>{let n,r,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match;const l=e.strstart>e.w_size-Uo?e.strstart-(e.w_size-Uo):0,c=e.window,u=e.w_mask,d=e.prev,p=e.strstart+Bo;let f=c[i+a-1],h=c[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,c[n+a]===h&&c[n+a-1]===f&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(r=Bo-(p-i),i=p-Bo,r>a){if(e.match_start=t,a=r,r>=s)break;f=c[i+a-1],h=c[i+a]}}}while((t=d[t&u])>l&&0!=--o);return a<=e.lookahead?a:e.lookahead},ei=e=>{const t=e.w_size;let n,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Uo)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Wo(e),r+=t),0===e.strm.avail_in)break;if(n=Zo(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Yo(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Yo(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Uo&&0!==e.strm.avail_in)},ti=(e,t)=>{let n,r,o,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>o&&(n=o),n<i&&(0===n&&t!==To||t===Co||n!==r+e.strm.avail_in))break;a=t===To&&n===r+e.strm.avail_in?1:0,mo(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Qo(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(Zo(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==Co&&t!==To&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(Zo(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,i=o>e.w_size?e.w_size:o,r=e.strstart-e.block_start,(r>=i||(r||t===To)&&t!==Co&&0===e.strm.avail_in&&r<=o)&&(n=r>o?o:r,a=t===To&&0===e.strm.avail_in&&n===r?1:0,mo(e,e.block_start,n,a),e.block_start+=n,Qo(e.strm)),a?3:1)},ni=(e,t)=>{let n,r;for(;;){if(e.lookahead<Uo){if(ei(e),e.lookahead<Uo&&t===Co)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Uo&&(e.match_length=$o(e,n)),e.match_length>=3)if(r=vo(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Yo(e,e.ins_h,e.window[e.strstart+1]);else r=vo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Jo(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===To?(Jo(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Jo(e,!1),0===e.strm.avail_out)?1:2},ri=(e,t)=>{let n,r,o;for(;;){if(e.lookahead<Uo){if(ei(e),e.lookahead<Uo&&t===Co)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Uo&&(e.match_length=$o(e,n),e.match_length<=5&&(e.strategy===No||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=vo(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=Yo(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Jo(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=vo(e,0,e.window[e.strstart-1]),r&&Jo(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=vo(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===To?(Jo(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Jo(e,!1),0===e.strm.avail_out)?1:2};function oi(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}const ii=[new oi(0,0,0,0,ti),new oi(4,4,8,4,ni),new oi(4,5,16,8,ni),new oi(4,6,32,32,ni),new oi(4,4,16,16,ri),new oi(8,16,32,32,ri),new oi(8,16,128,128,ri),new oi(8,32,128,256,ri),new oi(32,128,258,1024,ri),new oi(32,258,258,4096,ri)];function ai(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Mo,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),qo(this.dyn_ltree),qo(this.dyn_dtree),qo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),qo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),qo(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const si=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==zo&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Ho&&t.status!==Go?1:0},li=e=>{if(si(e))return Vo(e,_o);e.total_in=e.total_out=0,e.data_type=Fo;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?zo:Ho,e.adler=2===t.wrap?0:1,t.last_flush=-2,go(t),Io},ci=e=>{const t=li(e);var n;return t===Io&&((n=e.state).window_size=2*n.w_size,qo(n.head),n.max_lazy_match=ii[n.level].max_lazy,n.good_match=ii[n.level].good_length,n.nice_match=ii[n.level].nice_length,n.max_chain_length=ii[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},ui=(e,t,n,r,o,i)=>{if(!e)return _o;let a=1;if(t===xo&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||n!==Mo||r<8||r>15||t<0||t>9||i<0||i>Lo||8===r&&1!==a)return Vo(e,_o);8===r&&(r=9);const s=new ai;return e.state=s,s.strm=e,s.status=zo,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=i,s.method=n,ci(e)};var di={deflateInit:(e,t)=>ui(e,t,Mo,15,8,Ro),deflateInit2:ui,deflateReset:ci,deflateResetKeep:li,deflateSetHeader:(e,t)=>si(e)||2!==e.state.wrap?_o:(e.state.gzhead=t,Io),deflate:(e,t)=>{if(si(e)||t>wo||t<0)return e?Vo(e,_o):_o;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===Go&&t!==To)return Vo(e,0===e.avail_out?ko:_o);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Qo(e),0===e.avail_out)return n.last_flush=-1,Io}else if(0===e.avail_in&&jo(t)<=jo(r)&&t!==To)return Vo(e,ko);if(n.status===Go&&0!==e.avail_in)return Vo(e,ko);if(n.status===zo&&0===n.wrap&&(n.status=Ho),n.status===zo){let t=Mo+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Oo||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Ko(n,t),0!==n.strstart&&(Ko(n,e.adler>>>16),Ko(n,65535&e.adler)),e.adler=1,n.status=Ho,Qo(e),0!==n.pending)return n.last_flush=-1,Io}if(57===n.status)if(e.adler=0,Xo(n,31),Xo(n,139),Xo(n,8),n.gzhead)Xo(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Xo(n,255&n.gzhead.time),Xo(n,n.gzhead.time>>8&255),Xo(n,n.gzhead.time>>16&255),Xo(n,n.gzhead.time>>24&255),Xo(n,9===n.level?2:n.strategy>=Oo||n.level<2?4:0),Xo(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Xo(n,255&n.gzhead.extra.length),Xo(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=po(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Xo(n,0),Xo(n,0),Xo(n,0),Xo(n,0),Xo(n,0),Xo(n,9===n.level?2:n.strategy>=Oo||n.level<2?4:0),Xo(n,3),n.status=Ho,Qo(e),0!==n.pending)return n.last_flush=-1,Io;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=po(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=o,Qo(e),0!==n.pending)return n.last_flush=-1,Io;t=0,r-=o}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=po(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=po(e.adler,n.pending_buf,n.pending-r,r)),Qo(e),0!==n.pending)return n.last_flush=-1,Io;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Xo(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=po(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=po(e.adler,n.pending_buf,n.pending-r,r)),Qo(e),0!==n.pending)return n.last_flush=-1,Io;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Xo(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=po(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Qo(e),0!==n.pending))return n.last_flush=-1,Io;Xo(n,255&e.adler),Xo(n,e.adler>>8&255),e.adler=0}if(n.status=Ho,Qo(e),0!==n.pending)return n.last_flush=-1,Io}if(0!==e.avail_in||0!==n.lookahead||t!==Co&&n.status!==Go){let r=0===n.level?ti(n,t):n.strategy===Oo?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(ei(e),0===e.lookahead)){if(t===Co)return 1;break}if(e.match_length=0,n=vo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Jo(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===To?(Jo(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Jo(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===Do?((e,t)=>{let n,r,o,i;const a=e.window;for(;;){if(e.lookahead<=Bo){if(ei(e),e.lookahead<=Bo&&t===Co)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,r=a[o],r===a[++o]&&r===a[++o]&&r===a[++o])){i=e.strstart+Bo;do{}while(r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&o<i);e.match_length=Bo-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=vo(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=vo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Jo(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===To?(Jo(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Jo(e,!1),0===e.strm.avail_out)?1:2})(n,t):ii[n.level].func(n,t);if(3!==r&&4!==r||(n.status=Go),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Io;if(2===r&&(t===bo?So(n):t!==wo&&(mo(n,0,0,!1),t===Eo&&(qo(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Qo(e),0===e.avail_out))return n.last_flush=-1,Io}return t!==To?Io:n.wrap<=0?Po:(2===n.wrap?(Xo(n,255&e.adler),Xo(n,e.adler>>8&255),Xo(n,e.adler>>16&255),Xo(n,e.adler>>24&255),Xo(n,255&e.total_in),Xo(n,e.total_in>>8&255),Xo(n,e.total_in>>16&255),Xo(n,e.total_in>>24&255)):(Ko(n,e.adler>>>16),Ko(n,65535&e.adler)),Qo(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Io:Po)},deflateEnd:e=>{if(si(e))return _o;const t=e.state.status;return e.state=null,t===Ho?Vo(e,Ao):Io},deflateSetDictionary:(e,t)=>{let n=t.length;if(si(e))return _o;const r=e.state,o=r.wrap;if(2===o||1===o&&r.status!==zo||r.lookahead)return _o;if(1===o&&(e.adler=co(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===o&&(qo(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const i=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,ei(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Yo(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,ei(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=i,r.wrap=o,Io},deflateInfo:"pako deflate (from Nodeca project)"};const pi=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var fi={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)pi(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,o=e.length;t<o;t++){let o=e[t];n.set(o,r),r+=o.length}return n}};let hi=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){hi=!1}const gi=new Uint8Array(256);for(let e=0;e<256;e++)gi[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;gi[254]=gi[254]=1;var mi={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,o,i,a=e.length,s=0;for(o=0;o<a;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),i=0,o=0;i<s;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,o;const i=new Array(2*n);for(o=0,r=0;r<n;){let t=e[r++];if(t<128){i[o++]=t;continue}let a=gi[t];if(a>4)i[o++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?i[o++]=65533:t<65536?i[o++]=t:(t-=65536,i[o++]=55296|t>>10&1023,i[o++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&hi)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(i,o)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+gi[e[n]]>t?n:t}};var yi=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const vi=Object.prototype.toString,{Z_NO_FLUSH:Si,Z_SYNC_FLUSH:Ci,Z_FULL_FLUSH:bi,Z_FINISH:Ei,Z_OK:Ti,Z_STREAM_END:wi,Z_DEFAULT_COMPRESSION:Ii,Z_DEFAULT_STRATEGY:Pi,Z_DEFLATED:_i}=ho;function Ai(e){this.options=fi.assign({level:Ii,method:_i,chunkSize:16384,windowBits:15,memLevel:8,strategy:Pi},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yi,this.strm.avail_out=0;let n=di.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Ti)throw new Error(fo[n]);if(t.header&&di.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?mi.string2buf(t.dictionary):"[object ArrayBuffer]"===vi.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=di.deflateSetDictionary(this.strm,e),n!==Ti)throw new Error(fo[n]);this._dict_set=!0}}function ki(e,t){const n=new Ai(t);if(n.push(e,!0),n.err)throw n.msg||fo[n.err];return n.result}Ai.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let o,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Ei:Si,"string"==typeof e?n.input=mi.string2buf(e):"[object ArrayBuffer]"===vi.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===Ci||i===bi)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=di.deflate(n,i),o===wi)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=di.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===Ti;if(0!==n.avail_out){if(i>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Ai.prototype.onData=function(e){this.chunks.push(e)},Ai.prototype.onEnd=function(e){e===Ti&&(this.result=fi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var xi=function(e,t){return(t=t||{}).raw=!0,ki(e,t)},Ni=function(e,t){return(t=t||{}).gzip=!0,ki(e,t)},Oi={Deflate:Ai,deflate:ki,deflateRaw:xi,gzip:Ni,constants:ho};const Di=16209;var Li=function(e,t){let n,r,o,i,a,s,l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I;const P=e.state;n=e.next_in,w=e.input,r=n+(e.avail_in-5),o=e.next_out,I=e.output,i=o-(t-e.avail_out),a=o+(e.avail_out-257),s=P.dmax,l=P.wsize,c=P.whave,u=P.wnext,d=P.window,p=P.hold,f=P.bits,h=P.lencode,g=P.distcode,m=(1<<P.lenbits)-1,y=(1<<P.distbits)-1;e:do{f<15&&(p+=w[n++]<<f,f+=8,p+=w[n++]<<f,f+=8),v=h[p&m];t:for(;;){if(S=v>>>24,p>>>=S,f-=S,S=v>>>16&255,0===S)I[o++]=65535&v;else{if(!(16&S)){if(64&S){if(32&S){P.mode=16191;break e}e.msg="invalid literal/length code",P.mode=Di;break e}v=h[(65535&v)+(p&(1<<S)-1)];continue t}for(C=65535&v,S&=15,S&&(f<S&&(p+=w[n++]<<f,f+=8),C+=p&(1<<S)-1,p>>>=S,f-=S),f<15&&(p+=w[n++]<<f,f+=8,p+=w[n++]<<f,f+=8),v=g[p&y];;){if(S=v>>>24,p>>>=S,f-=S,S=v>>>16&255,16&S){if(b=65535&v,S&=15,f<S&&(p+=w[n++]<<f,f+=8,f<S&&(p+=w[n++]<<f,f+=8)),b+=p&(1<<S)-1,b>s){e.msg="invalid distance too far back",P.mode=Di;break e}if(p>>>=S,f-=S,S=o-i,b>S){if(S=b-S,S>c&&P.sane){e.msg="invalid distance too far back",P.mode=Di;break e}if(E=0,T=d,0===u){if(E+=l-S,S<C){C-=S;do{I[o++]=d[E++]}while(--S);E=o-b,T=I}}else if(u<S){if(E+=l+u-S,S-=u,S<C){C-=S;do{I[o++]=d[E++]}while(--S);if(E=0,u<C){S=u,C-=S;do{I[o++]=d[E++]}while(--S);E=o-b,T=I}}}else if(E+=u-S,S<C){C-=S;do{I[o++]=d[E++]}while(--S);E=o-b,T=I}for(;C>2;)I[o++]=T[E++],I[o++]=T[E++],I[o++]=T[E++],C-=3;C&&(I[o++]=T[E++],C>1&&(I[o++]=T[E++]))}else{E=o-b;do{I[o++]=I[E++],I[o++]=I[E++],I[o++]=I[E++],C-=3}while(C>2);C&&(I[o++]=I[E++],C>1&&(I[o++]=I[E++]))}break}if(64&S){e.msg="invalid distance code",P.mode=Di;break e}v=g[(65535&v)+(p&(1<<S)-1)]}}break}}while(n<r&&o<a);C=f>>3,n-=C,f-=C<<3,p&=(1<<f)-1,e.next_in=n,e.next_out=o,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=o<a?a-o+257:257-(o-a),P.hold=p,P.bits=f};const Ri=15,Fi=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Mi=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Bi=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Ui=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var zi=(e,t,n,r,o,i,a,s)=>{const l=s.bits;let c,u,d,p,f,h,g=0,m=0,y=0,v=0,S=0,C=0,b=0,E=0,T=0,w=0,I=null;const P=new Uint16Array(16),_=new Uint16Array(16);let A,k,x,N=null;for(g=0;g<=Ri;g++)P[g]=0;for(m=0;m<r;m++)P[t[n+m]]++;for(S=l,v=Ri;v>=1&&0===P[v];v--);if(S>v&&(S=v),0===v)return o[i++]=20971520,o[i++]=20971520,s.bits=1,0;for(y=1;y<v&&0===P[y];y++);for(S<y&&(S=y),E=1,g=1;g<=Ri;g++)if(E<<=1,E-=P[g],E<0)return-1;if(E>0&&(0===e||1!==v))return-1;for(_[1]=0,g=1;g<Ri;g++)_[g+1]=_[g]+P[g];for(m=0;m<r;m++)0!==t[n+m]&&(a[_[t[n+m]]++]=m);if(0===e?(I=N=a,h=20):1===e?(I=Fi,N=Mi,h=257):(I=Bi,N=Ui,h=0),w=0,m=0,g=y,f=i,C=S,b=0,d=-1,T=1<<S,p=T-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){A=g-b,a[m]+1<h?(k=0,x=a[m]):a[m]>=h?(k=N[a[m]-h],x=I[a[m]-h]):(k=96,x=0),c=1<<g-b,u=1<<C,y=u;do{u-=c,o[f+(w>>b)+u]=A<<24|k<<16|x}while(0!==u);for(c=1<<g-1;w&c;)c>>=1;if(0!==c?(w&=c-1,w+=c):w=0,m++,0==--P[g]){if(g===v)break;g=t[n+a[m]]}if(g>S&&(w&p)!==d){for(0===b&&(b=S),f+=y,C=g-b,E=1<<C;C+b<v&&(E-=P[C+b],!(E<=0));)C++,E<<=1;if(T+=1<<C,1===e&&T>852||2===e&&T>592)return 1;d=w&p,o[d]=S<<24|C<<16|f-i}}return 0!==w&&(o[f+w]=g-b<<24|64<<16),s.bits=S,0};const{Z_FINISH:Hi,Z_BLOCK:Gi,Z_TREES:Vi,Z_OK:ji,Z_STREAM_END:qi,Z_NEED_DICT:Wi,Z_STREAM_ERROR:Yi,Z_DATA_ERROR:Qi,Z_MEM_ERROR:Ji,Z_BUF_ERROR:Xi,Z_DEFLATED:Ki}=ho,Zi=16180,$i=16190,ea=16191,ta=16192,na=16194,ra=16199,oa=16200,ia=16206,aa=16209,sa=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function la(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ca=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Zi||t.mode>16211?1:0},ua=e=>{if(ca(e))return Yi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Zi,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,ji},da=e=>{if(ca(e))return Yi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ua(e)},pa=(e,t)=>{let n;if(ca(e))return Yi;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Yi:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,da(e))},fa=(e,t)=>{if(!e)return Yi;const n=new la;e.state=n,n.strm=e,n.window=null,n.mode=Zi;const r=pa(e,t);return r!==ji&&(e.state=null),r};let ha,ga,ma=!0;const ya=e=>{if(ma){ha=new Int32Array(512),ga=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(zi(1,e.lens,0,288,ha,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;zi(2,e.lens,0,32,ga,0,e.work,{bits:5}),ma=!1}e.lencode=ha,e.lenbits=9,e.distcode=ga,e.distbits=5},va=(e,t,n,r)=>{let o;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),i.window.set(t.subarray(n-r,n-r+o),i.wnext),(r-=o)?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};var Sa={inflateReset:da,inflateReset2:pa,inflateResetKeep:ua,inflateInit:e=>fa(e,15),inflateInit2:fa,inflate:(e,t)=>{let n,r,o,i,a,s,l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w=0;const I=new Uint8Array(4);let P,_;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ca(e)||!e.output||!e.input&&0!==e.avail_in)return Yi;n=e.state,n.mode===ea&&(n.mode=ta),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,u=n.bits,d=s,p=l,T=ji;e:for(;;)switch(n.mode){case Zi:if(0===n.wrap){n.mode=ta;break}for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,I[0]=255&c,I[1]=c>>>8&255,n.check=po(n.check,I,2,0),c=0,u=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=aa;break}if((15&c)!==Ki){e.msg="unknown compression method",n.mode=aa;break}if(c>>>=4,u-=4,E=8+(15&c),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=aa;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&c?16189:ea,c=0,u=0;break;case 16181:for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(n.flags=c,(255&n.flags)!==Ki){e.msg="unknown compression method",n.mode=aa;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=aa;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(I[0]=255&c,I[1]=c>>>8&255,n.check=po(n.check,I,2,0)),c=0,u=0,n.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(I[0]=255&c,I[1]=c>>>8&255,I[2]=c>>>16&255,I[3]=c>>>24&255,n.check=po(n.check,I,4,0)),c=0,u=0,n.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(I[0]=255&c,I[1]=c>>>8&255,n.check=po(n.check,I,2,0)),c=0,u=0,n.mode=16184;case 16184:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(I[0]=255&c,I[1]=c>>>8&255,n.check=po(n.check,I,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>s&&(f=s),f&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+f),E)),512&n.flags&&4&n.wrap&&(n.check=po(n.check,r,f,i)),s-=f,i+=f,n.length-=f),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break e;f=0;do{E=r[i+f++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&f<s);if(512&n.flags&&4&n.wrap&&(n.check=po(n.check,r,f,i)),s-=f,i+=f,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break e;f=0;do{E=r[i+f++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&f<s);if(512&n.flags&&4&n.wrap&&(n.check=po(n.check,r,f,i)),s-=f,i+=f,E)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(4&n.wrap&&c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=aa;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=ea;break;case 16189:for(;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}e.adler=n.check=sa(c),c=0,u=0,n.mode=$i;case $i:if(0===n.havedict)return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,Wi;e.adler=n.check=1,n.mode=ea;case ea:if(t===Gi||t===Vi)break e;case ta:if(n.last){c>>>=7&u,u-=7&u,n.mode=ia;break}for(;u<3;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}switch(n.last=1&c,c>>>=1,u-=1,3&c){case 0:n.mode=16193;break;case 1:if(ya(n),n.mode=ra,t===Vi){c>>>=2,u-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=aa}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=aa;break}if(n.length=65535&c,c=0,u=0,n.mode=na,t===Vi)break e;case na:n.mode=16195;case 16195:if(f=n.length,f){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;o.set(r.subarray(i,i+f),a),s-=f,i+=f,l-=f,a+=f,n.length-=f;break}n.mode=ea;break;case 16196:for(;u<14;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=aa;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.lens[A[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[A[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,P={bits:n.lenbits},T=zi(0,n.lens,0,19,n.lencode,0,n.work,P),n.lenbits=P.bits,T){e.msg="invalid code lengths set",n.mode=aa;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;w=n.lencode[c&(1<<n.lenbits)-1],m=w>>>24,y=w>>>16&255,v=65535&w,!(m<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(v<16)c>>>=m,u-=m,n.lens[n.have++]=v;else{if(16===v){for(_=m+2;u<_;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(c>>>=m,u-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=aa;break}E=n.lens[n.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===v){for(_=m+3;u<_;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=m,u-=m,E=0,f=3+(7&c),c>>>=3,u-=3}else{for(_=m+7;u<_;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=m,u-=m,E=0,f=11+(127&c),c>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=aa;break}for(;f--;)n.lens[n.have++]=E}}if(n.mode===aa)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=aa;break}if(n.lenbits=9,P={bits:n.lenbits},T=zi(1,n.lens,0,n.nlen,n.lencode,0,n.work,P),n.lenbits=P.bits,T){e.msg="invalid literal/lengths set",n.mode=aa;break}if(n.distbits=6,n.distcode=n.distdyn,P={bits:n.distbits},T=zi(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,P),n.distbits=P.bits,T){e.msg="invalid distances set",n.mode=aa;break}if(n.mode=ra,t===Vi)break e;case ra:n.mode=oa;case oa:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,Li(e,p),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,u=n.bits,n.mode===ea&&(n.back=-1);break}for(n.back=0;w=n.lencode[c&(1<<n.lenbits)-1],m=w>>>24,y=w>>>16&255,v=65535&w,!(m<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(y&&!(240&y)){for(S=m,C=y,b=v;w=n.lencode[b+((c&(1<<S+C)-1)>>S)],m=w>>>24,y=w>>>16&255,v=65535&w,!(S+m<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=S,u-=S,n.back+=S}if(c>>>=m,u-=m,n.back+=m,n.length=v,0===y){n.mode=16205;break}if(32&y){n.back=-1,n.mode=ea;break}if(64&y){e.msg="invalid literal/length code",n.mode=aa;break}n.extra=15&y,n.mode=16201;case 16201:if(n.extra){for(_=n.extra;u<_;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;w=n.distcode[c&(1<<n.distbits)-1],m=w>>>24,y=w>>>16&255,v=65535&w,!(m<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(!(240&y)){for(S=m,C=y,b=v;w=n.distcode[b+((c&(1<<S+C)-1)>>S)],m=w>>>24,y=w>>>16&255,v=65535&w,!(S+m<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=S,u-=S,n.back+=S}if(c>>>=m,u-=m,n.back+=m,64&y){e.msg="invalid distance code",n.mode=aa;break}n.offset=v,n.extra=15&y,n.mode=16203;case 16203:if(n.extra){for(_=n.extra;u<_;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=aa;break}n.mode=16204;case 16204:if(0===l)break e;if(f=p-l,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=aa;break}f>n.wnext?(f-=n.wnext,h=n.wsize-f):h=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=o,h=a-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{o[a++]=g[h++]}while(--f);0===n.length&&(n.mode=oa);break;case 16205:if(0===l)break e;o[a++]=n.length,l--,n.mode=oa;break;case ia:if(n.wrap){for(;u<32;){if(0===s)break e;s--,c|=r[i++]<<u,u+=8}if(p-=l,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=n.flags?po(n.check,o,p,a-p):co(n.check,o,p,a-p)),p=l,4&n.wrap&&(n.flags?c:sa(c))!==n.check){e.msg="incorrect data check",n.mode=aa;break}c=0,u=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(4&n.wrap&&c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=aa;break}c=0,u=0}n.mode=16208;case 16208:T=qi;break e;case aa:T=Qi;break e;case 16210:return Ji;default:return Yi}return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<aa&&(n.mode<ia||t!==Hi))&&va(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=n.flags?po(n.check,o,p,e.next_out-p):co(n.check,o,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===ea?128:0)+(n.mode===ra||n.mode===na?256:0),(0===d&&0===p||t===Hi)&&T===ji&&(T=Xi),T},inflateEnd:e=>{if(ca(e))return Yi;let t=e.state;return t.window&&(t.window=null),e.state=null,ji},inflateGetHeader:(e,t)=>{if(ca(e))return Yi;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,ji):Yi},inflateSetDictionary:(e,t)=>{const n=t.length;let r,o,i;return ca(e)?Yi:(r=e.state,0!==r.wrap&&r.mode!==$i?Yi:r.mode===$i&&(o=1,o=co(o,t,n,0),o!==r.check)?Qi:(i=va(e,t,n,n),i?(r.mode=16210,Ji):(r.havedict=1,ji)))},inflateInfo:"pako inflate (from Nodeca project)"};var Ca=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ba=Object.prototype.toString,{Z_NO_FLUSH:Ea,Z_FINISH:Ta,Z_OK:wa,Z_STREAM_END:Ia,Z_NEED_DICT:Pa,Z_STREAM_ERROR:_a,Z_DATA_ERROR:Aa,Z_MEM_ERROR:ka}=ho;function xa(e){this.options=fi.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yi,this.strm.avail_out=0;let n=Sa.inflateInit2(this.strm,t.windowBits);if(n!==wa)throw new Error(fo[n]);if(this.header=new Ca,Sa.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=mi.string2buf(t.dictionary):"[object ArrayBuffer]"===ba.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Sa.inflateSetDictionary(this.strm,t.dictionary),n!==wa)))throw new Error(fo[n])}function Na(e,t){const n=new xa(t);if(n.push(e),n.err)throw n.msg||fo[n.err];return n.result}xa.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let i,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?Ta:Ea,"[object ArrayBuffer]"===ba.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=Sa.inflate(n,a),i===Pa&&o&&(i=Sa.inflateSetDictionary(n,o),i===wa?i=Sa.inflate(n,a):i===Aa&&(i=Pa));n.avail_in>0&&i===Ia&&n.state.wrap>0&&0!==e[n.next_in];)Sa.inflateReset(n),i=Sa.inflate(n,a);switch(i){case _a:case Aa:case Pa:case ka:return this.onEnd(i),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||i===Ia))if("string"===this.options.to){let e=mi.utf8border(n.output,n.next_out),t=n.next_out-e,o=mi.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(o)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==wa||0!==s){if(i===Ia)return i=Sa.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},xa.prototype.onData=function(e){this.chunks.push(e)},xa.prototype.onEnd=function(e){e===wa&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=fi.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Oa=function(e,t){return(t=t||{}).raw=!0,Na(e,t)},Da={Inflate:xa,inflate:Na,inflateRaw:Oa,ungzip:Na,constants:ho};const{Deflate:La,deflate:Ra,deflateRaw:Fa,gzip:Ma}=Oi,{Inflate:Ba,inflate:Ua,inflateRaw:za,ungzip:Ha}=Da;var Ga={Deflate:La,deflate:Ra,deflateRaw:Fa,gzip:Ma,Inflate:Ba,inflate:Ua,inflateRaw:za,ungzip:Ha,constants:ho},Va=function(e){var t="\n    let clientSessionId = cluster('odxaugloop.eastus.kusto.windows.net').database('ODX AugLoop Service').WorkflowOperationEvent\n    | where TIMESTAMP > ago(7d)\n    | where operationName == \"FluxCopilot\"\n    | where sessionKey == \"".concat(e,'"\n    | distinct clientSessionId;\n    union Office_Voice_ActionAI*\n        | where Event_ReceivedTime > ago(7d)\n        | where Session_Id in (clientSessionId)\n        | project-reorder Event_Time, Event_ReceivedTime, Event_Name, Data_ChatEventType, Data_UserQueryGuid, Data_OperationName, Data_AugloopSessionGuid, Data_EventState, Data_Type\n        | order by Event_Time asc\n    '),n=ja(t);return{name:"Client Chat Event logs",description:"Get Client Chat Event logs for a given session id",linkUrl:"https://dataexplorer.azure.com/clusters/https%3a%2f%2fkusto.aria.microsoft.com/databases/9783945ebc2b468fbb8a2890cdab903b?query=".concat(n),query:t}},ja=function(e){var t=(new TextEncoder).encode(e),n=Ga.deflate(t);return btoa(String.fromCharCode.apply(null,n))},qa=n(34948),Wa=n(11481),Ya=n(10229),Qa=n(46835),Ja=n(34308),Xa=n(7573),Ka=n(1134);function Za(e){xe.B.getInstance().sendErrorTelemetry([{key:P.IC.ErrorCategory,value:P.S2.SketchToImage},{key:P.IC.ErrorMessage,value:e}])}function $a(e,t){return es.apply(this,arguments)}function es(){return es=(0,r._)((function(e,t){var n,o,i,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:if($.R.getInstance().getState()!==Z.Nj.IDLE)return(0,Qa.debuglog)("Image insertion triggered while in a non-idle execution state"),[2];$.R.getInstance().setState(Z.Nj.EXECUTING),(0,Qa.debuglog)("handleInsertImageOnClick"),n={status:Z.rI.SUCCESS},(o=me.K.getInstance()).setScenarioName(X.Cu.InsertImage),s.label=1;case 1:return s.trys.push([1,3,,4]),i={scenarioName:o.getScenarioName(),startTime:o.getStartTime(),entryPoint:I.$kB.Chat,correlationId:(0,Un.A)(),timeToODSLMS:1e3*o.getResponseTime(),timeODSLToJOfcMS:0,capability:o.getCapability(),featureName:o.getFeatureName(),subFeatureName:o.getSubFeatureName()},a={scenarioOptions:JSON.stringify(i)},[4,PowerPoint.run(function(){var i=(0,r._)((function(r){var i,s,l,u,d,p,f;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return[4,(0,Ka.q0)(r)];case 1:return i=c.sent(),s={},0!==i.length?[3,3]:[4,(0,Ka.MK)(r,i)];case 2:return l=c.sent().split("#"),s={type:1,id:+l[0],cId:+l[1]},[3,4];case 3:u=i[0].id.split("#"),s={type:1,id:+u[0],cId:+u[1]},c.label=4;case 4:return d=[],p={name:X._u.AddPictureCmd,version:X.xv,sourceType:X.fK.Raw64,data:e,altText:t,target:s},d.push(p),[4,(0,bn.Rf)(r,d,a)];case 5:return n=c.sent(),o.resetData(),$.R.getInstance().setState(Z.Nj.IDLE),n.status===Z.rI.SUCCESS?xe.B.getInstance().sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.PPTCopilotSketchInsertImageCompleted}]):(JSON.stringify(null!==(f=n.error)&&void 0!==f?f:Z.Re.UNKNOWN_ERROR),Za("fail to insert the image to slide, result : ${errorString}")),[2]}}))}));return function(e){return i.apply(this,arguments)}}())];case 2:return s.sent(),(0,Qa.debuglog)("log result : ${JSON.stringify(result))}"),[3,4];case 3:return s.sent(),n={status:Z.rI.FAILED},(0,Qa.debuglog)("Execute failed: ${JSON.stringify(result))}"),Za("fail to insert the image to slide"),[3,4];case 4:return[2]}}))})),es.apply(this,arguments)}var ts=function(){var e=(0,r._)((function(e){var t,n,r,o,s,l,u;return(0,c.__generator)(this,(function(c){return n={featureName:P.CC.CopilotChat,subFeatureName:P.Ff.SketchToImage},(r=null==e||null===(t=e.current)||void 0===t?void 0:t.getLastMessage())&&r.messageType===Bt._.ChatCardWrapper&&(0,M.bw)(M.WT.UseSketchImageCardForBeautifyingInk)&&(s=r.body).renderData&&(null===(o=s.renderData)||void 0===o?void 0:o.component)===Z.uz.SketchCard&&(null===(u=e.current)||void 0===u||u.updateLastMessage({chatCardType:Bt._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:s.textContent,renderData:(0,a._)((0,i._)({},s.renderData),{props:(0,a._)((0,i._)({},null===(l=s.renderData)||void 0===l?void 0:l.props),{isRehydration:!0})})}},chatMessageBodyData:{feedbackSectionPosition:Ya.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:(0,Ne.as)(Z.Xw.SKETCHTOIMAGE,n),chatHydrationKeys:{imagesKey:"images"}},addCardToChatHistory:!0})),[2]}))}));return function(t){return e.apply(this,arguments)}}(),ns=function(){var e=(0,r._)((function(e,t){var n,r,o,i,a,s,l,u,d,p,f,h,g,m;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return r=null==e?void 0:e.body,$.R.getInstance().setState(Z.Nj.IDLE),"OK"!=r.status?((0,Qa.debuglog)("sketchAnnotationProcessor: sketchAnnotation.status: ${sketchAnnotation.status}"),Za(r.status),null===(o=t.current)||void 0===o||o.addResponseMessage({chatCardType:Bt._.Default,chatMessageData:{defaultMessageProps:{user:Ae.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.ServerErrorMessage}}}}),[2]):void 0===(i=null===(n=r.blobs)||void 0===n?void 0:n[0])?((0,Qa.debuglog)("sketchAnnotationProcessor: No blob in sketchAnnotation"),Za("No blob in sketchAnnotation"),null===(a=t.current)||void 0===a||a.addResponseMessage({chatCardType:Bt._.Default,chatMessageData:{defaultMessageProps:{user:Ae.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.ServerErrorMessage}}}}),[2]):(s=re.Vv.getSettingAsString(re.zj.AugloopSharedSessionID),[4,(0,Ja.wB)(s).requestBinaryDataForBlob(i)]);case 1:return void 0===(l=c.sent())||0===l.length?((0,Qa.debuglog)("sketchAnnotationProcessor: No storedImage in imageBlob"),Za("No storedImage in imageBlob"),null===(u=t.current)||void 0===u||u.addResponseMessage({chatCardType:Bt._.Default,chatMessageData:{defaultMessageProps:{user:Ae.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.ServerErrorMessage}}}})):(d=l.reduce((function(e,t){return e+String.fromCharCode(t)}),""),p="data:image/png;base64,"+btoa(d),f={featureName:P.CC.CopilotChat,subFeatureName:P.Ff.SketchToImage},h=r.altText?r.altText:"sketch",(0,M.bw)(M.WT.UseSketchImageCardForBeautifyingInk)?null===(g=t.current)||void 0===g||g.addResponseMessage({chatCardType:Bt._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:Ae.Q9.Chat,renderData:{component:Z.uz.SketchCard,props:{images:[p],altText:[h]}}}},chatMessageBodyData:{feedbackSectionPosition:Ya.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:(0,Ne.as)(Z.Xw.SKETCHTOIMAGE,f)},addCardToChatHistory:!1}):null===(m=t.current)||void 0===m||m.addResponseMessage({chatCardType:Bt._.ContentCard,chatMessageData:{contentCardProps:{user:Ae.Q9.Chat,cardContent:{contentBody:_t.createElement("img",{src:p,width:"100%",alt:h}),cardButtons:[{buttonTitle:(0,I.XEH)(),buttonText:(0,I.XEH)(),handleButtonOnClick:function(){return $a(p,h)},icon:_t.createElement(Xa.dLz,null),isDisabled:!1}]}}},chatMessageBodyData:{feedbackSectionPosition:Ya.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:(0,Ne.as)(Z.Xw.SKETCHTOIMAGE,f)}}),xe.B.getInstance().sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.PPTCopilotSketchOperationCompleted}])),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),rs=n(46996),os=n(78461),is=n(52297),as=n(56679),ss=n(30218),ls=n(78447),cs=n(909),us=n(30900),ds=n(78590),ps=n(78126);const fs=new Map,hs=e=>fs.has(e)?(new Date).getTime()-(fs.get(e)??0):-1,gs=e=>{fs.delete(e)};var ms;!function(e){e.GPTRequest="GPTRequest",e.GPTResponse="GPTResponse",e.GPTError="GPTError",e.GPTLatency="GPTLatency",e.GPTTimeout="GPTTimeout",e.GetCachedGPT="GetCachedGPT",e.GPTListUserPerceivedLatency="GPTListUserPerceivedLatency",e.OpenAgentFromMOS="OpenAgentFromMos"}(ms||(ms={}));var ys,vs=n(88358);!function(e){e.Success="success",e.Error="error"}(ys||(ys={}));var Ss=n(876);const Cs=e=>e?.conversationStarters?.conversationStarterList?.map((e=>({text:e?.text??"",title:e?.title??""})));let bs;const Es=us.s3.getTypeName(),Ts=async(e,t,n,r,o)=>{(0,vs.cY)("getGPTDetails from CopilotGPT",e);const i=await Is(cs.S.GetGPT,t,n,e,o);r.setTimeout(cs.S.GetGPT,i?.queryId,3e4)},ws=async(e,t,n,r)=>{(0,vs.cY)("getGPTList from CopilotGPT");const o=await Is(cs.S.GetGPTList,e,t,void 0,r);n.setTimeout(cs.S.GetGPTList,o?.queryId,1e4)},Is=async(e,t,n,r,o)=>{const i=Ps(e,r,n,o),a=new tt.g0({parentPath:["Signal",Es],items:[{id:mn.r.generateId(),body:i}]});var s,l;return(0,vs.cY)(`Submitting signal to Augloop : ${Es} with operation type: ${e} and signal: ${JSON.stringify(i)}`),s=i?.queryId,l=(new Date).getTime(),fs.set(s,l),t(a),bs=(new Date).getTime(),i},Ps=(e,t,n,r)=>{const o=(0,ps.A)();switch(n?.(e,ms.GPTRequest,void 0,r,o),e){case cs.S.GetGPTList:{const e={type:cs.S.GetGPTList};return new us.s3({operation:e,queryId:o})}case cs.S.GetGPT:{const e={type:cs.S.GetGPT,gptId:t};return new us.s3({operation:e,queryId:o})}default:return new us.s3}},_s=async(e,t,n,r,o)=>{(0,vs.cY)(`${us.s3.getTypeName()} response. Time Taken : ${(0,vs.WU)(bs)} sec \n`);const i=e.body.operationResponse,a=i.type;switch(a){case cs.S.GetGPTList:{r(!1);const e=i,n=e?.gptResult?.statusCode,o=e?.isCopilotExtensibilityDisabledByAdmin;if(n!==ds.su.Success)return(0,vs.cY)(`GetGPTList failed with status code: ${n} and message: ${e?.messageToRender}`),t((e=>({copilotSwitcherMenuItemProps:e.copilotSwitcherMenuItemProps,status:ys.Error}))),{operationType:a,statusCode:n,fetchedGPTListLength:0,isCopilotExtensibilityDisabledByAdmin:o};const s=e?.gptListResponse?.gptList??[];if((0,vs.cY)(`GetGPTList response: ${JSON.stringify(s)}`),0===s.length)return(0,vs.cY)("No GPTs found"),{operationType:a,statusCode:n,fetchedGPTListLength:s?.length??0,isCopilotExtensibilityDisabledByAdmin:o};const l=(e=>e.filter((e=>e?.gptIdentifier?.id??!1)).map((e=>({id:e?.gptIdentifier?.id??"",name:e?.name??"",isDefaultCopilot:!1,copilotType:B.NV.CustomGPT,isSelected:!1,menuIconUrl:e.icon,starterPrompts:Cs(e)??[],metaOSAppId:e?.metaOSAppId??""}))))(s);t({copilotSwitcherMenuItemProps:l,status:ys.Success});const c=(0,vs._F)(l);return{operationType:a,statusCode:n,fetchedGPTListLength:s?.length??0,isCopilotExtensibilityDisabledByAdmin:o,gptTypeRecorder:c}}case cs.S.GetGPT:{o(!1);const e=i;(0,vs.cY)(`GetGPT response: ${JSON.stringify(e)}`);const t=e?.gptResult?.statusCode;if(t!==ds.su.Success)return(0,vs.cY)(`GetGPT failed with status code: ${t} and message: ${e?.messageToRender}`),n({copilotChatProps:void 0,gptId:"",status:ys.Error}),{operationType:a,statusCode:t};const r=e.gptResponse?.gptDetails;if(!r)return(0,vs.cY)("No GPT details found"),{operationType:a};const s=(e=>({zeroQueryMessageV2Props:{promptSuggestionList:(e?.conversationStarters?.conversationStarterList??[]).map((e=>({suggestionText:e?.text??"",suggestionCategory:e?.title??"",iconRegular:Ss.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1})))}}))(r),l=t!==ds.su.Success?ys.Error:ys.Success;return n({copilotChatProps:s,gptId:r?.gptIdentifier?.id,status:l}),{operationType:a,statusCode:t}}}return{operationType:a}};class As{constructor(e,t){this.queryTimeoutMap=new Map,this.gptListResponseTimeoutInternal=()=>{(0,vs.cY)("GPT List response timed out"),this.setIsTimeoutForGPTList(!0)},this.gptDetailsResponseTimeoutInternal=()=>{(0,vs.cY)("GPT Details response timed out"),this.setIsTimeoutForGPTDetails(!0)},this.setIsTimeoutForGPTList=e,this.setIsTimeoutForGPTDetails=t}static getInstance(e,t){return As.instance||(As.instance=new As(e,t)),As.instance}static resetInstance(){As.instance=void 0}setTimeout(e,t,n){let r;switch(e){case cs.S.GetGPTList:r=this.gptListResponseTimeoutInternal;break;case cs.S.GetGPT:r=this.gptDetailsResponseTimeoutInternal}const o=window.setTimeout(r,n);this.queryTimeoutMap.set(t,o)}clearTimeout(e){const t=this.queryTimeoutMap.get(e);t&&((0,vs.cY)(`Clearing timeout for queryId: ${e}`),clearTimeout(t),this.queryTimeoutMap.delete(e))}}const ks=e=>{const[t,n]=_t.useState(),r=_t.useRef(!1),{copilotFeatureFlags:o}=e,i=_t.useCallback((async()=>(r.current=!0,(0,vs.jA)(e.copilotCommunicationHandler.getHostSettings().devBuild??!1),e.copilotCommunicationHandler.getALSession().then((e=>{n(e)})),()=>{As.resetInstance(),r.current=!1})),[]),a=!o?.isFocusChatInputOnMount,s=_t.useCallback((async()=>{o?.loadGptListOnCopilotIconClick&&!r.current&&(i(),(0,vs.cY)("AL session is initialized and GPT List has been called when preload chatpane is visible :- "+a))}),[]);return _t.useEffect((()=>{o?.loadGptListOnCopilotIconClick?a||s():((0,vs.cY)("AL session is initialized and GPT List has been called when component was mounted"),i())}),[]),(0,Wa.A)(s),{alSession:t,handlePreloadGptListCall:s}};function xs(e,t,n,r,o,i,a,s){const{copilotFeatureFlags:l}=t,{alSession:c,handlePreloadGptListCall:u}=ks(t),[d,p]=_t.useState({copilotSwitcherMenuItemProps:[],status:ys.Error}),[f,h]=_t.useState(!1),g=_t.useRef(!1),[m,y]=_t.useState({copilotChatProps:t.chatUiProps,gptId:"",status:ys.Success}),[v,S]=_t.useState(!1),[C,b]=_t.useState(!1),[E,T]=_t.useState(!1),w=_t.useRef(a),I=As.getInstance(T,b),{handleAnnotation:P}=function(e,t,n,r,o,i,a,s,l,c){return{handleAnnotation:async u=>{for(const d of u.items){const u=d.body?.H_;if(u?.T_===ls.vF.getTypeName()){const{operationType:u,statusCode:p,fetchedGPTListLength:f,isCopilotExtensibilityDisabledByAdmin:h,gptTypeRecorder:g}=await _s(d,t,e,n,r),m=d.body,y=m?.queryId,v=hs(y);(0,vs.cY)("userPerceivedLatency for GPT LIST",v),gs(y),s.clearTimeout(u),v&&a(u,ms.GPTLatency,v,void 0,y),p===ds.su.Success?(a(u,ms.GPTResponse,(0,vs.YI)(f??0,h,g),void 0,y),u===cs.S.GetGPTList&&i(!1)):(a(u,ms.GPTError,JSON.stringify({statusCode:p}),void 0,y),u===cs.S.GetGPT?o(!0):u!==cs.S.GetGPTList||p===ds.su.GptListNotFound||l?.current||i(!0),u===cs.S.GetGPTList&&l?.current&&c())}}}}}(y,p,h,S,n,r,o,I,w,(()=>{s(!1),w.current=!1,_()}));_t.useEffect((()=>{c&&e&&c.activateAnnotation(ls.vF.getTypeName(),{callback:P}).then((()=>{_()}))}),[c,e]),_t.useEffect((()=>{E&&e&&(h(!1),0===d.copilotSwitcherMenuItemProps.length&&r(!0),o(cs.S.GetGPTList,ms.GPTTimeout,JSON.stringify({statusCode:"GPTListTimeout"})))}),[E]),_t.useEffect((()=>{C&&e&&(S(!1),n(!0),o(cs.S.GetGPT,ms.GPTTimeout,JSON.stringify({statusCode:"GPTDetailsTimeout"})))}),[C]);const _=()=>{if(c&&e&&!f){l?.stopMenuShimmerAfterFirstCall?g?.current||(h(!0),g.current=!0):h(!0);const e=i();ws((t=>{c.submitOperation(t,e)}),o,I,e)}};return{isLoadingMenu:f,isLoadingGPTDetails:v,isTimeoutForGPTList:E,isTimeoutForGPTDetails:C,fetchGPTList:_,gptListProps:d,fetchGPTDetails:async t=>{if(e&&c){S(!0);const e=i();await Ts(t,(t=>{c.submitOperation(t,e)}),o,I,e)}},gptDetailsProps:m,handlePreloadGptListCall:u}}var Ns=n(55633),Os=n(69465),Ds=n(13775),Ls=n(76961),Rs=n(31779),Fs=n(37526),Ms=n(32803),Bs=n(23153),Us=n(85669),zs=n(42603),Hs=n(65906),Gs=n(31498);const Vs=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:n=!1}=e,{close:r}=(0,Gs.T)(),o=(0,Bs.h)(t),i=(0,Us.D)((e=>{var t,n;null==o||null===(t=(n=o.props).onClick)||void 0===t||t.call(n,e),e.isDefaultPrevented()||r()})),a={...null==o?void 0:o.props,ref:null==o?void 0:o.ref,onClick:i},s=(0,Hs.F)("button"===(null==o?void 0:o.type)||"a"===(null==o?void 0:o.type)?o.type:"div",{...a,type:"button"});return{children:(0,zs.L)(t,n?a:s)}})(e);return(e=>e.children)(t)};Vs.displayName="ToastTrigger";var js=n(96713),qs=n(82095),Ws=n(80617),Ys=n(71951),Qs=n(90592),Js=n(51212),Xs=n(52602),Ks=n(75678),Zs=n(65214),$s=n(84860);const el=n(13129).H,tl=e=>{const t=(e=>{var t,n;return{...(0,$s.k)(e),withArrow:null===(t=e.withArrow)||void 0===t||t,trapFocus:null===(n=e.trapFocus)||void 0===n||n}})(e);return el(t)};tl.displayName="TeachingPopover";var nl=n(18331),rl=n(11492);var ol=n(7636);const il="fui-TeachingPopoverSurface",al=(0,Xn.X)({root:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f23zza1",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu",Bf4jedk:"f14hp5dx",B7ck84d:"f1ewtqcl"}},{d:[[".f23zza1{padding:var(--spacingVerticalL) var(--spacingVerticalL);}",{p:-1}],[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".f14hp5dx{min-width:320px;}",".f1ewtqcl{box-sizing:border-box;}"]});var sl=n(39900),ll=n(22323);const cl=_t.forwardRef(((e,t)=>{const n=((e,t)=>(0,rl.X)(e,t))(e,t);return(e=>{const t=al();e.root.className=(0,Kn.z)(il,t.root,e.root.className),(0,ol.Ls)(e)})(n),(0,nl.$e)("useTeachingPopoverSurfaceStyles_unstable")(n),(e=>((0,sl.C)(e),(0,ll._)(e)))(n)}));cl.displayName="TeachingPopoverSurface";var ul=n(35819),dl=n(78277),pl=n(63157);var fl=n(19615);const hl="fui-TeachingPopoverHeader",gl="fui-TeachingPopoverHeader__dismissButton",ml="fui-TeachingPopoverHeader__icon",yl=(0,Xn.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",sj55zd:"f11d4kpn",Bhrd7zp:"fl43uef",Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm",Byoj8tv:"f14wxoun",Bt984gj:"f122n59",B6of3ja:"f1jkagg5",jrapky:"fi2ljxd"},rootBrand:{sj55zd:"f1phragk"},dismissButton:{sj55zd:"fkfq4zb",qhf8xq:"f10pi13n",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:["f1n71otn","f1deefiw"],Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f88035w",mc9l5x:"f22iagw",Bt984gj:"f122n59",Bceei9c:"f1k6fduh",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",De3pzq:"f1c21dwh",B7ck84d:"f1ewtqcl",B7oj6ja:["f3fg2lr","f13av6d4"],Bbmb7ep:["fzi6hpg","fyowgf4"],Jyy4pa:"f1lfeew",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f16d74zd",Bfpq7zp:0,g9k6zt:0,Bn4voq9:0,giviqs:"f89hs3r",Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f2krc9w",B8q5s1w:"f8hki3x",Bci5o5g:["f1d2448m","ffh67wi"],n8qw10:"f1bjia2o",Bdrgwmp:["ffh67wi","f1d2448m"]},dismissBrand:{sj55zd:"f1phragk"},icon:{Bqenvij:"fsv12xs",a9b677:"f19bqwv",Bg96gwp:"fwrc4pm",Be2twd7:"fy9rknc",Bt984gj:"f122n59",B7ck84d:"f1e4lqlz",mc9l5x:"ftuwxu6",Brf1p80:"f4d9j23",w71qe1:"f1iuv45f",ha4doy:"fmrv4ls",qhf8xq:"f10pi13n",De3pzq:"f1c21dwh",sj55zd:"fkfq4zb",Bokbzmb:"fpvr8q1"},iconBrand:{sj55zd:"f1phragk"}},{d:[".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f14wxoun{padding-bottom:var(--spacingVerticalXS);}",".f122n59{align-items:center;}",".f1jkagg5{margin-top:var(--spacingHorizontalNone);}",".fi2ljxd{margin-bottom:var(--spacingHorizontalNone);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f10pi13n{position:relative;}",[".f88035w{border:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-2}],".f1k6fduh{cursor:pointer;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1ewtqcl{box-sizing:border-box;}",".f3fg2lr{border-top-right-radius:var(--borderRadiusNone);}",".f13av6d4{border-top-left-radius:var(--borderRadiusNone);}",".fzi6hpg{border-bottom-right-radius:var(--borderRadiusNone);}",".fyowgf4{border-bottom-left-radius:var(--borderRadiusNone);}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1lfeew{-webkit-margin-start:auto;margin-inline-start:auto;}",[".f16d74zd{padding:var(--spacingVerticalXS) var(--spacingHorizontalXS);}",{p:-1}],[".f89hs3r[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);}",{p:-1}],[".f2krc9w[data-fui-focus-visible]{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f8hki3x[data-fui-focus-visible]{border-top-color:transparent;}",".f1d2448m[data-fui-focus-visible]{border-right-color:transparent;}",".ffh67wi[data-fui-focus-visible]{border-left-color:transparent;}",".f1bjia2o[data-fui-focus-visible]{border-bottom-color:transparent;}",".fsv12xs{height:var(--fontSizeBase200);}",".f19bqwv{width:var(--fontSizeBase200);}",".f1e4lqlz{box-sizing:content-box;}",".ftuwxu6{display:inline-flex;}",".f4d9j23{justify-content:center;}",".f1iuv45f{text-decoration-line:none;}",".fmrv4ls{vertical-align:middle;}",".fpvr8q1{-webkit-margin-end:var(--spacingHorizontalXS);margin-inline-end:var(--spacingHorizontalXS);}"]}),vl=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const{dismissButton:n,icon:r}=e,o=(0,pl.pO)((e=>e.setOpen)),i=(0,pl.pO)((e=>e.triggerRef)),a=(0,pl.pO)((e=>e.appearance)),s=(0,Us.D)((e=>{e.defaultPrevented||o(e,!1),i.current&&i.current.focus()}));return{appearance:a,components:{root:"h3",dismissButton:"button",icon:"div"},root:ul.Gk((0,dl.g)("h3",{ref:t,...e}),{elementType:"h3"}),icon:ul.lq(r,{renderByDefault:!0,defaultProps:{children:_t.createElement(Zt.N4s,null),"aria-hidden":!0},elementType:"div"}),dismissButton:ul.lq(n,{renderByDefault:!0,defaultProps:{children:_t.createElement(Xt.Wyk,null),role:"button","aria-label":"dismiss",onClick:s},elementType:"button"})}})(e,t);return(e=>{const t=yl(),{appearance:n}=e;e.root.className=(0,Kn.z)(hl,t.root,"brand"===n&&t.rootBrand,e.root.className),e.dismissButton&&(e.dismissButton.className=(0,Kn.z)(gl,t.dismissButton,"brand"===n?t.dismissBrand:void 0,e.dismissButton.className)),e.icon&&(e.icon.className=(0,Kn.z)(ml,t.icon,"brand"===n?t.iconBrand:void 0,e.icon.className))})(n),(0,nl.$e)("useTeachingPopoverHeaderStyles_unstable")(n),(e=>((0,sl.C)(e),(0,fl.FD)(e.root,{children:[e.icon&&(0,fl.Y)(e.icon,{}),e.root.children,e.dismissButton&&(0,fl.Y)(e.dismissButton,{})]})))(n)}));vl.displayName="TeachingPopoverHeader";const Sl="fui-TeachingPopoverBody",Cl="fui-TeachingPopoverBody__media",bl=(0,Xn.X)({base:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"fujjg13",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",a9b677:"f14z66ap",jrapky:"f1jlhsmd",ha4doy:"fmrv4ls",Brf1p80:"f4d9j23",mc9l5x:"f22iagw"},short:{Bubjx69:"f1taewuw",Bmuttt3:"fs5pxn9"},medium:{Bubjx69:"f7da563",Bmuttt3:"f98prui"},tall:{Bubjx69:"f9ikmtg",Bmuttt3:"fqws08j"}},{d:[[".fujjg13{grid-area:media;}",{p:-1}],[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f14z66ap{width:auto;}",".f1jlhsmd{margin-bottom:12px;}",".fmrv4ls{vertical-align:middle;}",".f4d9j23{justify-content:center;}",".f22iagw{display:flex;}",".f1taewuw{aspect-ratio:2.4615384615384617;}",".f7da563{aspect-ratio:1.6363636363636365;}",".f9ikmtg{aspect-ratio:1;}"],t:["@supports not (aspect-ratio){.fs5pxn9{height:117px;}}","@supports not (aspect-ratio){.f98prui{height:176px;}}","@supports not (aspect-ratio){.fqws08j{height:288px;}}"]}),El=(0,Xn.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Byoj8tv:"fpe6lb7"}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".fpe6lb7{padding-bottom:12px;}"]}),Tl=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const{mediaLength:n}=e;return{components:{root:"div",media:"span"},root:ul.Gk((0,dl.g)("div",{ref:t,...e}),{elementType:"div"}),media:ul.lq(e.media,{elementType:"span"}),mediaLength:null!=n?n:"short"}})(e,t);return(e=>{const{mediaLength:t}=e,n=El(),r=bl();e.root.className=(0,Kn.z)(Sl,n.root,e.root.className),e.media&&(e.media.className=(0,Kn.z)(Cl,r.base,r[t],e.media.className))})(n),(0,nl.$e)("useTeachingPopoverBodyStyles_unstable")(n),(e=>((0,sl.C)(e),(0,fl.FD)(e.root,{children:[e.media&&(0,fl.Y)(e.media,{}),e.root.children]})))(n)}));Tl.displayName="TeachingPopoverBody";var wl=n(56610),Il=n(19658),Pl=n(44551);const _l=(0,Il.A)(Pl.Z5f,Pl.BEt),Al="fui-TeachingPopoverTitle",kl="fui-TeachingPopoverTitle__dismissButton",xl=(0,Xn.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Brf1p80:"f1869bpl",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",sj55zd:"f19n0e5",Bg96gwp:"faaz57k",Byoj8tv:"f5b47ha",B6of3ja:"f1jkagg5",jrapky:"fi2ljxd"},rootBrand:{sj55zd:"f1phragk"},dismissButton:{qhf8xq:"f10pi13n",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:["f1n71otn","f1deefiw"],Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f88035w",mc9l5x:"f22iagw",Bt984gj:"f122n59",Bceei9c:"f1k6fduh",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",De3pzq:"f1c21dwh",B7ck84d:"f1ewtqcl",B7oj6ja:["f3fg2lr","f13av6d4"],Bbmb7ep:["fzi6hpg","fyowgf4"],Bfpq7zp:0,g9k6zt:0,Bn4voq9:0,giviqs:"f89hs3r",Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f2krc9w",B8q5s1w:"f8hki3x",Bci5o5g:["f1d2448m","ffh67wi"],n8qw10:"f1bjia2o",Bdrgwmp:["ffh67wi","f1d2448m"],Jyy4pa:"f1lfeew"},dismissBrand:{sj55zd:"f1phragk"}},{d:[".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".f1869bpl{justify-content:space-between;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f5b47ha{padding-bottom:var(--spacingVerticalS);}",".f1jkagg5{margin-top:var(--spacingHorizontalNone);}",".fi2ljxd{margin-bottom:var(--spacingHorizontalNone);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".f10pi13n{position:relative;}",[".f88035w{border:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-2}],".f122n59{align-items:center;}",".f1k6fduh{cursor:pointer;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1ewtqcl{box-sizing:border-box;}",".f3fg2lr{border-top-right-radius:var(--borderRadiusNone);}",".f13av6d4{border-top-left-radius:var(--borderRadiusNone);}",".fzi6hpg{border-bottom-right-radius:var(--borderRadiusNone);}",".fyowgf4{border-bottom-left-radius:var(--borderRadiusNone);}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",[".f89hs3r[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);}",{p:-1}],[".f2krc9w[data-fui-focus-visible]{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f8hki3x[data-fui-focus-visible]{border-top-color:transparent;}",".f1d2448m[data-fui-focus-visible]{border-right-color:transparent;}",".ffh67wi[data-fui-focus-visible]{border-left-color:transparent;}",".f1bjia2o[data-fui-focus-visible]{border-bottom-color:transparent;}",".f1lfeew{-webkit-margin-start:auto;margin-inline-start:auto;}"]}),Nl=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const{dismissButton:n}=e,r=(0,pl.pO)((e=>e.setOpen)),o=(0,pl.pO)((e=>e.triggerRef)),i=(0,pl.pO)((e=>e.appearance)),a=(0,Us.D)((e=>{e.defaultPrevented||r(e,!1),o.current&&o.current.focus()}));return{appearance:i,components:{root:"h2",dismissButton:"button"},root:ul.Gk((0,dl.g)("h2",{ref:t,...e}),{elementType:"h2"}),dismissButton:ul.lq(n,{renderByDefault:!1,defaultProps:{children:_t.createElement(_l,null),onClick:a,"aria-label":"dismiss","aria-hidden":!0},elementType:"button"})}})(e,t);return(e=>{const t=xl(),{appearance:n}=e;e.root.className=(0,Kn.z)(Al,t.root,"brand"===n&&t.rootBrand,e.root.className),e.dismissButton&&(e.dismissButton.className=(0,Kn.z)(kl,t.dismissButton,"brand"===n?t.dismissBrand:void 0,e.dismissButton.className))})(n),(0,nl.$e)("useTeachingPopoverTitleStyles_unstable")(n),(e=>((0,sl.C)(e),(0,fl.FD)(e.root,{children:[e.root.children,e.dismissButton&&(0,fl.Y)(e.dismissButton,{})]})))(n)}));Nl.displayName="TeachingPopoverTitle";var Ol=n(284);const Dl="fui-TeachingPopoverFooter",Ll="fui-TeachingPopoverFooter__primary",Rl="fui-TeachingPopoverFooter__secondary",Fl=(0,Xn.X)({root:{mc9l5x:"f22iagw",i8kkvl:0,Belr9w4:0,rmohyg:"f19gb1f4",z8tnut:"f1kcqot9"},rootVertical:{Beiy3e4:"f1vx9l62"},rootHorizontal:{Beiy3e4:"f1063pyq",Brf1p80:"f9c4gz4"},buttonRootVertical:{a9b677:"f14z66ap",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ff3glw6"},buttonRootHorizontal:{Bf4jedk:"f14es27b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ff3glw6"},brandSecondary:{g2u3we:"fm1ebug",h3c5rm:["f28omuz","f1uhflii"],B9xav0g:"f1ixw5o4",zhjwy3:["f1uhflii","f28omuz"]},brandPrimary:{sj55zd:"f16muhyy",De3pzq:"f10s6wn9",Bi91k9c:"f3ymbdj",Jwef8y:"f1rgtb95",B2d53fq:"f1pu27ff",iro3zm:"f1d5c7in"}},{d:[".f22iagw{display:flex;}",[".f19gb1f4{gap:8px;}",{p:-1}],".f1kcqot9{padding-top:12px;}",".f1vx9l62{flex-direction:column;}",".f1063pyq{flex-direction:row;}",".f9c4gz4{justify-content:flex-end;}",".f14z66ap{width:auto;}",[".ff3glw6{border-radius:4px;}",{p:-1}],".f14es27b{min-width:96px;}",[".ff3glw6{border-radius:4px;}",{p:-1}],".fm1ebug{border-top-color:var(--colorNeutralForegroundOnBrand);}",".f28omuz{border-right-color:var(--colorNeutralForegroundOnBrand);}",".f1uhflii{border-left-color:var(--colorNeutralForegroundOnBrand);}",".f1ixw5o4{border-bottom-color:var(--colorNeutralForegroundOnBrand);}",".f16muhyy{color:var(--colorBrandForeground1);}",".f10s6wn9{background-color:var(--colorNeutralForegroundOnBrand);}"],h:[".f3ymbdj:hover{color:var(--colorCompoundBrandForeground1Hover);}",".f1rgtb95:hover{background-color:var(--colorNeutralForegroundOnBrand);}",".f1pu27ff:hover:active{color:var(--colorCompoundBrandForeground1Pressed);}",".f1d5c7in:hover:active{background-color:var(--colorNeutralForegroundOnBrand);}"]}),Ml=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const n=(0,pl.pO)((e=>e.appearance)),r=(0,pl.pO)((e=>e.toggleOpen)),o=(0,Us.D)((e=>{e.isDefaultPrevented()||r(e)})),i=ul.lq(e.secondary,{defaultProps:{appearance:"brand"===n?"primary":void 0},renderByDefault:void 0!==e.secondary,elementType:js.$});i&&(i.onClick=(0,Ol.p)(o,null==i?void 0:i.onClick));const a=ul.Gk(e.primary,{defaultProps:{appearance:"brand"===n?void 0:"primary"},elementType:js.$});var s;return i||(a.onClick=(0,Ol.p)(o,null==a?void 0:a.onClick)),{footerLayout:null!==(s=e.footerLayout)&&void 0!==s?s:"horizontal",appearance:n,components:{root:"div",primary:js.$,secondary:js.$},root:ul.Gk((0,dl.g)("div",{ref:t,...e}),{elementType:"div"}),secondary:i,primary:a}})(e,t);return(e=>{const t=Fl(),{appearance:n,footerLayout:r}=e;e.root.className=(0,Kn.z)(Dl,t.root,"horizontal"===r?t.rootHorizontal:t.rootVertical,e.root.className),e.secondary&&(e.secondary.className=(0,Kn.z)(Rl,"horizontal"===r?t.buttonRootHorizontal:t.buttonRootVertical,"brand"===n?t.brandSecondary:void 0,e.secondary.className)),e.primary.className=(0,Kn.z)(Ll,"horizontal"===r?t.buttonRootHorizontal:t.buttonRootVertical,"brand"===n?t.brandPrimary:void 0,e.primary.className)})(n),(e=>((0,sl.C)(e),(0,fl.FD)(e.root,{children:[(0,fl.Y)(e.primary,{}),e.secondary&&(0,fl.Y)(e.secondary,{})]})))(n)}));Ml.displayName="TeachingPopoverFooter";const Bl=(0,On.n)({root:{maxWidth:"200px"}}),Ul=({onCloseFre:e,mountNode:t,primaryButtonText:n,headerText:r,title:o,image:i,bodyText:a,anchorId:s})=>{const l=i?.src,c={target:document.getElementById(s),position:"above",align:"start"},[u,d]=_t.useState(!0),p=Bl();return _t.createElement(tl,{open:u,size:"large",trapFocus:!0,onOpenChange:()=>{d(!1),e(!1)},mountNode:t,positioning:c,withArrow:!0},_t.createElement(cl,{"aria-label":`${r} ${o} ${a}`,className:p.root},_t.createElement(vl,null,r),_t.createElement(Tl,{media:_t.createElement(wl._,{fit:"contain",src:l})},_t.createElement(Nl,null,o),_t.createElement("div",null,a)),_t.createElement(Ml,{primary:{children:n,onClick:()=>{d(!1),e(!0)},role:"button",tabIndex:-1,"aria-label":n}})))};var zl=n(37407),Hl=n(95468),Gl=n(25373),Vl=n(4402),jl=n(62069);const ql="CopilotSwitcherMenuID",Wl=({copilot:e,handleCopilotChatChange:t,onMenuStateChange:n,copilotListStyle:r,switcherMenuChatHistoryProps:o,newChatLabel:i})=>{const a=!e.isLink,s=e.isSelected&&o?.newConversationClickHandler,[l,c]=_t.useState(!1),u=_t.useRef(null),d=_t.useRef(null),p=s?e=>{"ArrowRight"===e.key&&!l&&d.current?(c(!0),d.current?.focus(),e.preventDefault()):"ArrowLeft"===e.key&&l&&(c(!1),u.current?.focus(),e.preventDefault())}:void 0;return _t.createElement(Js.D,{key:e.id,ref:u,onClick:r=>{t(e.id),n(r,{open:!1,type:"menuItemClick"})},"aria-label":e.name,onKeyDown:p,className:e.isSelected?r.menuItemSelected:r.menuItem},_t.createElement(Os.W,{horizontal:!0,style:r.menuItemParts},_t.createElement(Vl.l,null,_t.createElement(Os.W,{horizontal:!0},!a&&_t.createElement("div",{style:{marginLeft:"3px",color:"transparent"}}),a&&_t.createElement(Vl.l,{style:r.itemSelector},_t.createElement("svg",{width:"3",height:"20",viewBox:"0 0 3 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.createElement("rect",{width:"3",height:"16",rx:"1.5"}))),_t.createElement(Vl.l,{style:r.menuItemIcon},e.menuIconUrl?_t.createElement(jl.Z,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon?e.menuIcon:_t.createElement("div",{style:{width:"20px"}})),_t.createElement(Vl.l,{style:e.isSelected?r.menuItemLabelSelected:r.menuItemLabel},e.name))),_t.createElement(Vl.l,{style:r.actionButtonContainer},s&&_t.createElement(Hl.m,{withArrow:!0,positioning:"below",content:i,relationship:"label"},_t.createElement(Gl.I,{className:r.actionButton,ref:d,icon:_t.createElement(Ss.svB,null),tabIndex:l?0:-1,onClick:()=>{o.newConversationClickHandler({eventName:"Switcher_Menu_Change_Topic_Button_Clicked",gptId:e.id,shouldSetLoadingUIStates:!0})},"aria-label":e.name+","+i})))))};var Yl=n(16895);const Ql={maxWidth:"100%",height:"32px",...Yl.Pt.margin("2px","16px","2px","16px"),...Yl.Pt.padding("0px"),alignItems:"center",cornerRadius:"8px",borderRadius:"8px",backgroundColor:Ws.L.colorNeutralBackground3,":hover":{backgroundColor:Ws.L.colorNeutralBackground3Hover,"& button":{backgroundColor:Ws.L.colorNeutralBackground3Hover}},":hover:active":{backgroundColor:Ws.L.colorNeutralBackground3Selected}},Jl={maxWidth:"100%",height:"32px",...Yl.Pt.margin("2px","8px","2px","8px"),...Yl.Pt.padding("0px"),alignItems:"center",cornerRadius:"8px",backgroundColor:Ws.L.colorNeutralBackground3},Xl={...Yl.Pt.padding("0px"),width:"32px",height:"32px",alignItems:"center",backgroundColor:Ws.L.colorNeutralBackground3,":hover":{backgroundColor:Ws.L.colorNeutralBackground3Hover}},Kl={menuContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},drawerBody:{...Yl.Pt.padding("0px")},menuItem:{...Ql,":hover":{backgroundColor:Ws.L.colorNeutralBackground3Hover,"& rect":{fill:Ws.L.colorNeutralStroke1Hover},"& button":{backgroundColor:Ws.L.colorNeutralBackground3Hover}},":hover:active":{backgroundColor:Ws.L.colorNeutralBackground3Selected,"& rect":{fill:Ws.L.colorNeutralStroke1Hover}},"& rect":{fill:"transparent"}},menuItemSelected:{...Ql,"& rect":{fill:Ws.L.colorBrandForeground1}},menuItemSeeMore:{...Ql,...Yl.Pt.padding("0px","0px","0px","6px")},menuItemParts:{justifyContent:"space-between"},itemSelector:{...Yl.Pt.margin("4px","0px","0px","0px")},menuItemIcon:{...Yl.Pt.padding("0px","0px","0px","5px"),maxWidth:"20px",maxHeight:"20px",alignSelf:"center"},menuItemLabel:{...Yl.Pt.padding("0px","0px","0px","6px"),fontSize:"14px",lineHeight:"14px",alignSelf:"center",color:Ws.L.colorNeutralForeground1},menuItemLabelSelected:{...Yl.Pt.padding("0px","0px","0px","6px"),fontSize:"14px",lineHeight:"14px",alignSelf:"center",fontWeight:Ws.L.fontWeightSemibold,color:Ws.L.colorNeutralForeground1},menuButton:{minWidth:"95%",alignItems:"center"},chatHistoryButton:{...Ql,width:"calc(100% - 32px)",alignSelf:"flex-end",borderRadius:"8px",...Yl.Pt.margin("2px","16px","12px","16px")},actionButtonContainer:{...Yl.Pt.padding("0px","6px","0px","0px")},actionButton:{...Xl},errorToastBody:{alignItems:"start",...Yl.Pt.gap("5px")},errorToastIcon:{...Yl.Pt.padding("5px")},errorToastText:{...Yl.Pt.padding("5px","0px"),width:"200px",fontWeight:"600",fontSize:"300"},errorToastMount:{position:"fixed",top:"90vh",height:"0px",width:"100%"}},Zl={menuItem:{...Jl,":hover":{backgroundColor:Ws.L.colorNeutralBackground3Hover,"& rect":{fill:Ws.L.colorNeutralStroke1Hover}},":hover:active":{backgroundColor:Ws.L.colorNeutralBackground3Selected,"& rect":{fill:Ws.L.colorNeutralStroke1Hover}},"& rect":{fill:"transparent"}},menuItemSelected:{...Jl,":hover":{backgroundColor:Ws.L.colorNeutralBackground3Hover},":hover:active":{backgroundColor:Ws.L.colorNeutralBackground3Selected},"& rect":{fill:Ws.L.colorBrandForeground1}},chatHistoryButton:{...Ql,width:"calc(100% - 32px)",alignSelf:"flex-end",...Yl.Pt.padding("0px")},errorToastBody:{alignItems:"start",...Yl.Pt.gap("5px")},errorToastIcon:{...Yl.Pt.padding("5px")},errorToastText:{...Yl.Pt.padding("5px","0px"),width:"200px",fontWeight:"600",fontSize:"300"},errorToastMount:{position:"fixed",top:"90vh",height:"0px",width:"100%"}},$l=(0,On.n)(Kl),ec=(0,On.n)({...Kl,...Zl});var tc=n(41722),nc=n(99284),rc=n(53787);const oc="fui-DrawerHeader",ic=(0,ar.y)("r3ovn4i",null,[".r3ovn4i{width:100%;max-width:100%;padding:var(--spacingVerticalXXL) var(--spacingHorizontalXXL) var(--spacingVerticalS);gap:var(--spacingHorizontalS);align-self:stretch;display:flex;flex-direction:column;box-sizing:border-box;position:relative;z-index:2;}"]),ac=(0,Xn.X)({separator:{Dlnsje:"fxnjyrl",E3zdtr:"f1mdlcz9",B1piin3:["f15yvnhg","f1n6gb5g"],Eqx8gd:["f1n6gb5g","f15yvnhg"],Bp15pi3:"f1564nw5",Bjyk6c5:"fdlpgxj",F2fol1:"f15cmg8x",Ba2ppi3:"f3f8dgl",B1dyfl9:"fjvo4va",Bsft5z2:"f13zj6fq",By385i5:"fo72kxq"},separatorVisible:{Bp15pi3:"fjsqi2x"}},{d:[".fxnjyrl::after{height:1px;}",".f1mdlcz9::after{position:absolute;}",".f15yvnhg::after{right:0;}",".f1n6gb5g::after{left:0;}",".f1564nw5::after{opacity:0;}",".fdlpgxj::after{background-color:var(--colorNeutralStroke1);}",".f15cmg8x::after{transition-duration:var(--durationNormal);}",".f3f8dgl::after{transition-property:opacity;}",".fjvo4va::after{transition-timing-function:var(--curveEasyEase);}",'.f13zj6fq::after{content:"";}',".fo72kxq::after{bottom:0;}",".fjsqi2x::after{opacity:1;}"]}),sc=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const{scrollState:n}=(0,rc.ls)();return{components:{root:"header"},root:ul.Gk((0,dl.g)("header",{ref:t,role:"none",...e}),{elementType:"header"}),scrollState:n}})(e,t);return(e=>{const t=ic(),n=ac();e.root.className=(0,Kn.z)(oc,t,"none"!==e.scrollState&&n.separator,["middle","bottom"].includes(e.scrollState)&&n.separatorVisible,e.root.className)})(n),(0,nl.$e)("useDrawerHeaderStyles_unstable")(n),(e=>((0,sl.C)(e),(0,fl.Y)(e.root,{})))(n)}));sc.displayName="DrawerHeader";const lc="fui-DrawerHeaderNavigation",cc=(0,ar.y)("r1ig4pwh",null,[".r1ig4pwh{margin:calc(var(--spacingVerticalS) * -1) calc(var(--spacingHorizontalL) * -1);}"]),uc=_t.forwardRef(((e,t)=>{const n=((e,t)=>({components:{root:"nav"},root:ul.Gk((0,dl.g)("nav",{ref:t,...e}),{elementType:"nav"})}))(e,t);return(e=>{const t=cc();e.root.className=(0,Kn.z)(lc,t,e.root.className)})(n),(0,nl.$e)("useDrawerHeaderNavigationStyles_unstable")(n),(e=>((0,sl.C)(e),(0,fl.Y)(e.root,{})))(n)}));uc.displayName="DrawerHeaderNavigation";var dc=n(5315),pc=n(88190),fc=n(14113),hc=n(5925),gc=n(31043),mc=n(71348),yc=n(3310),vc=n(90537),Sc=n(39241),Cc=n(99559),bc=n(88222),Ec=n(69940),Tc=n(39580);const wc=()=>_t.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.createElement("path",{d:"M13 13.5002C13 14.881 10.7614 16.0002 8 16.0002C5.23858 16.0002 3 14.881 3 13.5002C3 12.1195 3 11.5 3 11.5H13C13 11.5 13 12.3899 13 13.5002Z",fill:"url(#paint0_linear_378174_10334)"}),_t.createElement("path",{d:"M13 11.5C13 12.8807 10.7614 14 8 14C5.23858 14 3 12.8807 3 11.5C3 10.1193 5.23858 9 8 9C10.7614 9 13 10.1193 13 11.5Z",fill:"url(#paint1_linear_378174_10334)"}),_t.createElement("path",{d:"M13 9.50025C13 10.881 10.7614 12.0002 8 12.0002C5.23858 12.0002 3 10.881 3 9.50025C3 8.11953 3 7.5 3 7.5H13C13 7.5 13 8.38988 13 9.50025Z",fill:"url(#paint2_linear_378174_10334)"}),_t.createElement("path",{d:"M13 7.5C13 8.88071 10.7614 10 8 10C5.23858 10 3 8.88071 3 7.5C3 6.11929 5.23858 5 8 5C10.7614 5 13 6.11929 13 7.5Z",fill:"url(#paint3_linear_378174_10334)"}),_t.createElement("path",{d:"M13 5.50025C13 6.88096 10.7614 8.00025 8 8.00025C5.23858 8.00025 3 6.88096 3 5.50025C3 4.11953 3 3.5 3 3.5H13C13 3.5 13 4.38988 13 5.50025Z",fill:"url(#paint4_linear_378174_10334)"}),_t.createElement("path",{d:"M13 3.5C13 4.88071 10.7614 6 8 6C5.23858 6 3 4.88071 3 3.5C3 2.11929 5.23858 1 8 1C10.7614 1 13 2.11929 13 3.5Z",fill:"url(#paint5_linear_378174_10334)"}),_t.createElement("defs",null,_t.createElement("linearGradient",{id:"paint0_linear_378174_10334",x1:"5.65236",y1:"12.6044",x2:"7.30179",y2:"16.2736",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{"stop-color":"#FFA43D"}),_t.createElement("stop",{offset:"1","stop-color":"#FB5937"})),_t.createElement("linearGradient",{id:"paint1_linear_378174_10334",x1:"13.0143",y1:"13.9981",x2:"8.70233",y2:"6.9433",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{"stop-color":"#FF8A69"}),_t.createElement("stop",{offset:"1","stop-color":"#FFCD0F"})),_t.createElement("linearGradient",{id:"paint2_linear_378174_10334",x1:"5.65236",y1:"8.60437",x2:"7.30179",y2:"12.2736",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{"stop-color":"#FFA43D"}),_t.createElement("stop",{offset:"1","stop-color":"#FB5937"})),_t.createElement("linearGradient",{id:"paint3_linear_378174_10334",x1:"13.0143",y1:"9.99806",x2:"8.70233",y2:"2.9433",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{"stop-color":"#FF8A69"}),_t.createElement("stop",{offset:"1","stop-color":"#FFCD0F"})),_t.createElement("linearGradient",{id:"paint4_linear_378174_10334",x1:"5.65236",y1:"4.60437",x2:"7.30179",y2:"8.27361",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{"stop-color":"#FFA43D"}),_t.createElement("stop",{offset:"1","stop-color":"#FB5937"})),_t.createElement("linearGradient",{id:"paint5_linear_378174_10334",x1:"13.0143",y1:"5.99806",x2:"8.70233",y2:"-1.0567",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{"stop-color":"#FF8A69"}),_t.createElement("stop",{offset:"1","stop-color":"#FFCD0F"})))),Ic=()=>_t.createElement(Tc.tnW,null),Pc=()=>_t.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.createElement("path",{d:"M2 4.5C2 4.22386 2.22386 4 2.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H2.5C2.22386 5 2 4.77614 2 4.5ZM2 9.5C2 9.22386 2.22386 9 2.5 9H17.5C17.7761 9 18 9.22386 18 9.5C18 9.77614 17.7761 10 17.5 10H2.5C2.22386 10 2 9.77614 2 9.5ZM2.5 14C2.22386 14 2 14.2239 2 14.5C2 14.7761 2.22386 15 2.5 15H17.5C17.7761 15 18 14.7761 18 14.5C18 14.2239 17.7761 14 17.5 14H2.5Z",fill:"#424242"}),_t.createElement("path",{d:"M12.5 4C12.5 5.933 14.067 7.5 16 7.5C17.933 7.5 19.5 5.933 19.5 4C19.5 2.067 17.933 0.5 16 0.5C14.067 0.5 12.5 2.067 12.5 4Z",fill:"#3D7CE8"}),_t.createElement("path",{d:"M12.5 4C12.5 5.933 14.067 7.5 16 7.5C17.933 7.5 19.5 5.933 19.5 4C19.5 2.067 17.933 0.5 16 0.5C14.067 0.5 12.5 2.067 12.5 4Z",stroke:"#3D7CE8"}),_t.createElement("path",{d:"M19 4C19 5.65685 17.6569 7 16 7C14.3431 7 13 5.65685 13 4C13 2.34315 14.3431 1 16 1C17.6569 1 19 2.34315 19 4Z",fill:"#3D7CE8"})),_c={toolbar:{justifyContent:"space-between",...Yl.Pt.padding("8px","6px","8px","6px")},switcherButton:{alignItems:"center",width:"32px",height:"32px",...Yl.Pt.padding("8px","6px","8px","6px")},switcherButtonToggled:{fontSize:"20px",backgroundColor:Ws.L.colorNeutralBackground1Selected,"&:hover":{backgroundColor:Ws.L.colorNeutralBackground2Selected}},drawerHeader:{...Yl.Pt.padding("0px")},drawer:{width:"-webkit-fill-available",justifyContent:"space-between",display:"flex",...Yl.Pt.padding("13px","6px","8px","6px"),...Yl.Pt.margin("0px")},drawerToolbar:{...Yl.Pt.padding("0px")},label:{...Yl.Pt.padding("3px","3px","3px","4px"),fontSize:"14px",lineHeight:"20px",alignSelf:"center",userSelect:"none",color:Ws.L.colorNeutralForeground1},labelIcon:{...Yl.Pt.padding("0px","0px","0px","4px"),maxWidth:"20px",maxHeight:"20px",alignSelf:"center"},toolbarButton:{fontSize:"20px",cursor:"initial"},toolbarButtonToggled:{fontSize:"20px",cursor:"initial",backgroundColor:Ws.L.colorNeutralBackground1Hover},menuItem:{minHeight:"30px",height:"30px",display:"flex"},toolbarGroup:{display:"flex"},toolbarButtonsGroup:{display:"flex"},creditButton:{height:"26px",alignSelf:"center",fontWeight:Ws.L.fontWeightRegular,whiteSpace:"nowrap"},creditTooltip:{maxWidth:"60%"},creditTitle:{marginBottom:"5px"}},Ac={toolbar:{justifyContent:"space-between",cursor:"initial",...Yl.Pt.padding("0px","0px","8px","0px")},drawer:{justifyContent:"space-between",display:"flex",...Yl.Pt.padding("5px","0px","8px","0px"),...Yl.Pt.margin("0px")},switcherButton:{alignItems:"center",width:"32px",cursor:"initial",height:"32px",...Yl.Pt.padding("8px","6px","8px","6px"),"&:hover":{cursor:"initial",...Yl.Pt.borderColor(Ws.L.colorNeutralStroke1)}},switcherButtonToggled:{fontSize:"20px",cursor:"initial",backgroundColor:Ws.L.colorNeutralBackground1Selected,"&:hover":{cursor:"initial",...Yl.Pt.borderColor(Ws.L.colorNeutralStroke1),backgroundColor:Ws.L.colorNeutralBackground2Selected}},label:{...Yl.Pt.padding("3px","3px","3px","4px"),fontSize:"16px",lineHeight:"20px",alignSelf:"center",userSelect:"none",fontWeight:Ws.L.fontWeightSemibold,color:Ws.L.colorNeutralForeground1},toolbarButtonsGroup:{display:"flex",gap:"8px"},toolbarButton:{fontSize:"20px",maxWidth:"24px",minWidth:"24px",maxHeight:"24px",borderRadius:"4px",cursor:"initial",...Yl.Pt.padding("2px"),"&:hover":{...Yl.Pt.borderColor(Ws.L.colorNeutralStroke1),backgroundColor:Ws.L.colorNeutralBackground1Hover,cursor:"initial","> span > svg":{color:Ws.L.colorNeutralForeground2}}},toolbarButtonToggled:{fontSize:"20px",maxWidth:"24px",minWidth:"24px",maxHeight:"24px",borderRadius:"4px",cursor:"initial",...Yl.Pt.padding("2px"),...Yl.Pt.borderColor(Ws.L.colorNeutralStroke1),backgroundColor:Ws.L.colorNeutralBackground1Hover,"> span > svg":{color:Ws.L.colorNeutralForeground2}}},kc=(0,On.n)(_c),xc=(0,On.n)({..._c,...Ac}),Nc=(e,t)=>{switch(e){case"close":return _t.createElement(Xt.LMj,null);case"help":return _t.createElement(bc.XLu,null);case"expandOrCollapse":return t?_t.createElement(Ec.rCp,null):_t.createElement(Ec.lA0,null);default:return null}},Oc={creditButtonText:Ks.nK,creditButtonTooltipTitle:Ks.T_,creditButtonTooltipBody:Ks.f_,sharedHeaderCloseButtonLabel:Ks.rU,sharedHeaderCollapseButtonLabel:Ks.qK,sharedHeaderExpandButtonOptionsLabel:Ks.Vw,sharedHeaderHelpButtonLabel:Ks.Ub,sharedHeaderMoveButtonLabel:Ks.aX,sharedHeaderResizeButtonLabel:Ks.RC,sharedHeaderTaskPaneOptionsLabel:Ks.eT,sharedHeaderActivateRealtimeVoiceButtonLabel:Ks.Z0,sharedHeaderDeactivateRealtimeVoiceButtonLabel:Ks.qV,copilotSwitcherMenuTriggerTitleDesc:Ks.cn,declarativeAgentsSwitcherMenuTriggerTitle:Ks.b2,declarativeAgentsSwitcherMenuTriggerTitleShortened:Ks.xY},Dc=_t.memo((({copilotList:e,isMenuOpen:t,onMenuStateChange:n,isDrawer:r,closeButton:o,closeButtonStyle:i,headerMenuButtonProps:a,afterFirstRender:s,showCreditButton:l,appPlatform:c,appName:u,eventLogger:d,shouldHideCopilotIconInHeader:p,showAgentMenuNudge:f,showAgentMenuTooltip:h})=>{const g=(e=>{const t=(0,os.kQ)(Oc);return _t.useMemo((()=>({...t,sharedHeaderTaskPaneOptionsLabel:()=>e.closePane??t.sharedHeaderTaskPaneOptionsLabel()})),[t,e.closePane])})({closePane:o?.label}),m=e.find((e=>e.isSelected)),y=m?.name,v=m?.menuIcon,S=m?.menuIconUrl,C=m?.iconAltText,b=kc(),E=xc(),T="PC"===c?E:b,w=(0,Kn.z)(T.toolbarButton,i),I=_t.useRef(null),P=_t.useRef(null),_=`https://go.microsoft.com/fwlink/?linkid=2281345&ref=${u}#credits`,[A,k]=_t.useState(!1),N=a?.buttons?.find((e=>e.type===x.Move)),O=!!N?.clickHandler,[D,L]=_t.useState(!1);_t.useEffect((()=>{s?.()}),[]),_t.useEffect((()=>{window.requestAnimationFrame((()=>{t?P.current?.focus():I.current?.focus()}))}),[t]);const R=(e,t)=>{O&&(N?.clickHandler(),d?.(t),e.dataTransfer.setDragImage(new Image,0,0),e.preventDefault())},F=e=>{R(e,"Shared_Header_Drawer_Drag_Started")},M=(0,as.Y$)(),B=M?.showAgentMenuNudgeAndTooltip?f?g.declarativeAgentsSwitcherMenuTriggerTitle():g.declarativeAgentsSwitcherMenuTriggerTitleShortened():g.copilotSwitcherMenuTriggerTitleDesc(),U=M.isRealtimeVoiceEnabled,{modality:z,changeModality:H}=(0,tc.f)(),G=U&&z===nc.S.RealtimeVoice;if(r)return _t.createElement(sc,{className:T.drawerHeader},_t.createElement(uc,{draggable:O,className:T.drawer,onDragStart:F},_t.createElement(dc.M,{size:"large","aria-label":B,className:T.drawerToolbar},_t.createElement(pc.$,{role:"presentation",className:T.toolbarGroup},_t.createElement(Hl.m,{withArrow:!0,positioning:"after",content:B,relationship:"label"},_t.createElement(Gl.I,{id:ql,className:T.switcherButtonToggled,icon:_t.createElement(Ic,null),"aria-checked":!0,ref:P,onClick:e=>n(e,{open:!t})})))),l&&_t.createElement(fc.A,{openOnHover:!0,size:"small",positioning:"below-end"},_t.createElement(hc.W,{disableButtonEnhancement:!0},_t.createElement(js.$,{appearance:"outline",size:"small",icon:_t.createElement(wc,null),className:T.creditButton,onClick:e=>{d?.("Credit_Balance_Button_Clicked"),e.stopPropagation(),window.open(_,"_blank")},"aria-label":g.creditButtonText()},g.creditButtonText())),_t.createElement(gc.H,{tabIndex:-1,className:T.creditTooltip,"aria-label":`${Ks.T_} ${Ks.f_}`},_t.createElement("div",{className:T.creditTitle},_t.createElement(mc.E,{weight:"semibold"},g.creditButtonTooltipTitle())),_t.createElement("div",null,_t.createElement(mc.E,null,g.creditButtonTooltipBody()))))));const V=p&&(!m?.id||"copilotChat"===m?.id),j=G?_t.createElement(Hl.m,{withArrow:!0,positioning:"below",content:B,relationship:"label"},_t.createElement(Gl.I,{id:ql,className:T.switcherButton,icon:_t.createElement(Pl.nUb,null),ref:I,onClick:e=>{H(nc.S.Chat)}})):_t.createElement(Hl.m,{withArrow:!0,positioning:"after",content:B,relationship:"label",visible:D||h,onVisibleChange:(e,t)=>L(t.visible)},_t.createElement(Gl.I,{id:ql,className:T.switcherButton,icon:f?_t.createElement(Pc,null):_t.createElement(Ic,null),ref:I,onClick:e=>n(e,{open:!t})}));return _t.createElement(dc.M,{"aria-label":B,className:T.toolbar,draggable:O,onDragStart:e=>{R(e,"Shared_Header_Toolbar_Drag_Started")}},_t.createElement(pc.$,{role:"presentation",className:T.toolbarGroup},j,!V&&_t.createElement("div",{className:T.labelIcon},S?_t.createElement(jl.Z,{iconUrl:S,iconAltText:C}):v),y&&_t.createElement(yc.J,{weight:"semibold",className:T.label},y)),!G&&_t.createElement(pc.$,{role:"presentation",className:T.toolbarGroup},_t.createElement(Os.W,{horizontal:!0,style:T.toolbarButtonsGroup,customProperties:{id:"TaskPaneToolbarButtons"}},a&&a.buttons&&_t.createElement(vc.W,{positioning:"below",open:A,onOpenChange:(e,t)=>{k?.(t.open)}},_t.createElement(Sc.c,null,_t.createElement(Hl.m,{withArrow:!0,positioning:"below",content:g.sharedHeaderTaskPaneOptionsLabel(),relationship:"label"},_t.createElement(Gl.I,{"data-unique-id":"TaskPaneOptionsBtnShared","aria-label":g.sharedHeaderTaskPaneOptionsLabel(),className:A?T.toolbarButtonToggled:T.toolbarButton,icon:_t.createElement(Ss.geq,null),onClick:e=>{k?.(!A)}}))),_t.createElement(Cc.b,{className:a?.menuStyle},_t.createElement(Qs.c,null,a.buttons.map((e=>{const t=(0,Kn.z)(T.menuItem,a?.menuItemStyle);return _t.createElement(Js.D,{key:e.type,className:t,onClick:t=>{d?.("Options_Menu_Button_Clicked",e.type),e.clickHandler?.()},icon:e.icon??Nc(e.type)??_t.createElement("div",{style:{marginInlineStart:"20px"}})},e.label??((e,t,n)=>{switch(e){case x.Close:return t.sharedHeaderCloseButtonLabel();case x.ExpandOrCollapse:return n?t.sharedHeaderCollapseButtonLabel():t.sharedHeaderExpandButtonOptionsLabel();case x.Help:return t.sharedHeaderHelpButtonLabel();case x.Move:return t.sharedHeaderMoveButtonLabel();case x.Resize:return t.sharedHeaderResizeButtonLabel();default:return""}})(e.type,g))}))))),o&&_t.createElement(Hl.m,{key:o.type,withArrow:!0,positioning:"below",content:g.sharedHeaderCloseButtonLabel(),relationship:"label"},_t.createElement(Gl.I,{"aria-label":g.sharedHeaderCloseButtonLabel(),className:w,icon:o.icon??Nc(x.Close),onClick:o.clickHandler,"data-unique-id":"TaskPaneCloseBtnShared"})))))})),Lc={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAADAFBMVEVHcEw2MzMMFBcREA8FBAQBBQgaGhoFBggRFR0jISEFBANBQ0QNDQwIBwwlJSUPDg4IBgcLCgoODQxeYGhSU1M2NjNDQT4FM29ccXU2SlkVUmpSVVgHRE9ycW+acc6xfG6DkY2EVlGyhNxBQkZDQkXbnGtBP0WncWxNMDLTh1XNRhWOiYc2PEvsrXVLUoAwR3dWUGHncbDBLwrvnFc6ODtQZ4VHS2HNisbjfKvGZDszNEvgJyXxtoBeYGy8h6/KVi6ha8b0mUibcsr5tnsAAACnPhkAJ5n/8aj/86j/8Kj/8an/76j/86n/9qkbGx0AAAH/8Kn/w4ciISQeHiH/woUYGRr/xYslJSctKy0wLjIpKCo1MjV8Va8fHzaBWLL/xImKXrc5Njg9Oj3/x4X/yoooJzlDP0KFW7V3UaxQTVH//7azR3ZIRUj/6ZBwTajKm+z/7Xr/+7LiuPj/4pT/AADcsPTqx/3/64j/76nnv/r/w4z/zoAoKTHBkuTVixpqRqEZHSv/8bD/7YL/zpH20/8yMDzMOyHXqfL/5566iuH6hrBbWFz/yY7/4f/xzv/hlQD/vYRjYWb/7HKpe9beigD/1YqgPnP92v/RW5IiIi+Ua8bye6n/0prSou7/3pH/un3/+IbDUob/2o6wksEuPGXcZZrocKHRhSoLGQDQfBn/xojNbQf/7pf/pGEpMUb/9nmMY73/kVD/96/+chyuRoT7XAYzL6/DTxRgQpyTZcD9kbpaR63/4X7JbiByaW/9mcr/sW//9ZX/vnfTPACidM/HXgr/62b/8KHWfACtgNskMFb/2HPCChT/sGNGNrRKPJr/x273ux/ooABWS2u1c2H/2KTnQgsIHaTpDADVAAD2xP6eS5aJZoz/hTeHO3v+yluTf67+qdyCT6L1pTX/PwD/xp6lb3i2PFJybI13ZLD8yEj7JQDMrd2Fj+j+zLGpAQDoqtO5bsPXfrjHg0JWd9z4lgH7g2/87b28aD/ebADuAGi0cJGPSgD/AAsACwFHcEwnoIJ4AAABAHRSTlMAKAchFgsqAQQmESgfDigoGRwkJigkIRgOEh8rJxr+VyM0/t+MmcZCYHuGMP/Invs+8WPC7vy4pb5S8/vdU33GyNyP+uXmp/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A4zYaCgAAEalJREFUeNrsmF9IW3kWx6/RmGiMjY2tJmZqXRDHFped9mG3tGw7O+ze3JsEbiDkaSEPubBDisVLBIMBRQOShYDBjVJ2g7FCK0aDa1KNMHXRFP8MVqoFrWXG+mCdWVpoH8rM7OzTnnPu1fb5amdfesz/2H4/53vO+f1+V4b5GB/jY3yMj3GM0Cnxf1HWQ2iUwNe/HAeKazRardFYfhRGo1YLHL8EBGSu0YJ0iclUBVEBgc8mUwlgaMEL3YdNHtTLS0pMIFxcXPZeFBcDiKmkpFyLPnyw5CF3FCftysqi96KyUqaoMpEPug8kD8ZXkDhIGgyGaoo6uMMbxECICpNsw4nro3wVypM46NbVmY+iDqMaKRChChF0J5w+mF9VcRp9J3Gz1WqteRfwTsYABigGIBi1J2kCpm8ieczdbK2xWCzWhvr65kaK5ub6BhtiyAxoQ4XpJE3QayD94jKSB/Vao7m+seWLVNzjhxBFeIinvmhprK9TGNCFYjBBoz8p+yH9MjLfarVozc0tqTjoen0+r8/t8+Hd7U6LaU+qpbkBGRBBNuEkykD6lH41JK9tupzy+NNuj88LAKjs9njcGPBGFNPxlnpCIBNOhAD1wX5Kv1ZTfznlF1HNLWfvRvuBwCNTeNw+0XMNEWAkiqAMQHDs+qN+ZaXBYK3RN4B8GpN2d0K2ETESiaQLHqgGtgEwdMaBwJf2tDRZZBNOgEBH+tB9kH7zQsqDpvt8na+TEX9qYXo3NwOR253OLBTESMwTP+iE70Ux3ogmKB7ojjd/UH/S15shfQ+FOxLxLuy++G/7+/EqlymI4kEn/oJPTF9rsFjJA1P5caZRpzdi/xsMNUxTxpOm/9wTixSmX7S3v/gxNRjlnNks74hGUvhJOzCADdgOnnS83kgeVJiMx2hEvbYE5w/0r6z7X/uw4cVYYbe9fSYVlQIQkiRlsxK+lKKpHHyeEUXqSbcYr9daDUhQor4NoADUAFamad3v7sTUksnMq/bpKChmXU6WZTmW41jWbncBhJScBhcKET+NpUxAjai6CGgA6uvNGb887H5vjuSzLtRl7SzncHAQ8MzZs1IgCggZMebBORXj0AdAoN4CNOB0ZZHNov+cms/nfX0w80JEeZ4lYWBwHAXHu7KBwCAYJMZ8B6/Bg2s1NQZDZZlqC8CAYmqACwXs/3Q6cjCTYwMSD7ZzsijL0osQfsBxPAuV4MEjrAL+i0YNFUGlBbIBBpu+ej3sp20nkpuWAk7eaecVYQd7+ILqwHMO1hWQptvXY26a13iTxabeAh2OABpwGfTDsN5t7e9KUojjnU6nnZWlZRK4CTzo82iEPRDYbS/EaIc6aNFb5UHQqaoArkE2zSfrg+GwGA5HPD/0BIQQFN5plwHAdB4BQsAgwGvC4eyB7ItcLOb1ut2xWIOFViNVNdAbsQJWptk/CPJhMbkfDLggU57lUZ51UBMqJXCEBBY+Bx84qMJo+0IMtyxvslFnxRoY9apaABfBGubzQYzwoH8j4IIsnSDjVBhwDllWYAUgEAQWLcDvpMB0DmsAANeoBqqaQKfBRcCmNa4HRwlhIyRh+Z1kNfqvOMDBKIZCHLUkfQ8WDM+kcOHwRjrPWmgpUANAQ2jTN2wER5FgNJzlFQCBEEAX+95BIynQKCgAnCT9mMJDgzcWa9LaaBBVAzBXwgAABKNBSeBJnsNyYwCIvAyEHILsCG9n8XtXIJMR8cjkjV3RqwegIWAuhaPDQDA6HM2GsNN5GD5sfjCfh97nBJQXCIDWBRaHM1DI4IHN1xlpZmAlgDE4HsAwAbhgBlGSMIABbgKYwIdCoI+DSLWAXwGAMAJ4fV7xOAAl7wAgglEXZMthAUgbbyyHvU8FoMUQHwQohCtQWAB1iNgF5rg9cGkvGgwiQRTUBGwBuQNYZT3g2ZDcABy1Ic2GU1pP0ak5GT8WAI4h8+n+ChAEwQE7GU41ONQmMwRlL0ADaD6FLJtxY/6+rQUCULUWywsRAPzcigBAsCKgBYIQEuQewCWAAMh6bD/wgsV9MTC67sMLB+/WLgKUVahbiHAzrGQ+fbO2AvqtwdZoz+Hw0TgetSI0QciB2wI2IgDwWdd6HAG8yeSrSzqbypUQ9gLT6dJSfcOb/cko6gdbV4CAE4R30qy8MgmKA8oC6ZLCC9gAXu9WZueKxgZDoGYvoC48VVpuebO0ttIK8goBlCFE+bOyC/LaxCqBW7IUXKcJAANmdswWW1mxuu0Ym+B0aRXzxzf7i0BAAQTYCHAgcLJ2ZVtQGlNmQP3oQpz0I1vTO1c1NerPZFiDU6XMhXx+b3GS9DuAgFqA8gYLWPkdr0wB3JxH+t6twqudC4xVbQXkQTxVqm3I5yfWiKCjo7cDPHAqeyJ/aAD6Lu+QfFYaPtRPxmZ2tptqbWVVJSovz2gOSiuY60v5xIDsASBM8j1OpfQ0hO+HS2LDoE8TmIzknl29rq85pf7CAC5MwYFSpmF+XibowOhFBCiE8zB9wSHPhZCVnMOFOG0BPvdWLPdsZ7u+1lp2RvUFqtwDZVrmwsT8UmJtcVEm6GjrneR6epRFAfZC3IyEnmzPyvDGBun7fGLSPfPs6vZ163lzdZHaHsApOFVaeUbP/Ok/q/NLq3sji+QAeNAGDCvgw7sIRYNrGxsb4TT93SKZXNgG/b4b5y9erDYc41gO60DZWcb89PHq6tj8xP7AyGIvEbT1DkC0dbROQrROtsLbtY21NTi6+rx4/ShO7zzq295+/k292Ww2qD6WUwXOGJlfP376LyRYSuwhAkUbxMDy8jLelzsGlh9gAIDb44/EMjPPHvX1bQ89v/+782Zzndoa6MursAIMM/cYCBKJMTChHxFGjgjgBve2jrY2Alhb80eSaZR/1Pfw4dDzoft3L2ITQA30alug6Czzm24keJ7oB4L5icTL4MjIyNRUmxJEAAxbg70PHnQMpqZJXtG/f/v3FjM0gbrdkFqgqJz5w625ubnHT+fe9q+OoQurT14uT40QxeJPU6A/BT+tPy2OPFjby+2QfN/DPvAf4vZvawlA5YEENkNogRtfzhHB7HdgQlfX2DgybL5cXh6ZQgi8T40MLO9t/vDzw0ey/MPvh4Zu3r9z587tz2qt0IWqj2TQAlrm3F+6u7vnoA5P//22v78LYnwcarGaePJkc3Pz5Ut42HySWJ1Yyi/l+zBQfgjkb99GgE+qVQPAcQAB/vb3boq5x7Oz34719ye6ZAigyC8tTSxNTEwswfPE+MR4HrPvQ/2bqA+hAJjUA2iYr8/9ufsWANzqnvvq6ey3b/ufKAxd4315fOzK9+XHx8cAKQ/mo/s3Uf8uxj9qa6qPcSwnB3719T9BnaL71lezs93fIQM5MT4uc4x3wZQmEqt5Sh4D9O/du3f33mcaAlDbA7AOlTM3/nruy/+1bzahTWVRHL9JtR9o4xhtTEbaqU2IBYt14ReCLgbXCSSEfEsTeGmCxUAhgcALZpEQ2tJIiBCaklUz0lXIooix0G6ymGbhwrrSMtQuxEIL6rgYGBjmnHPfS6uze6/OwOC/5qN94O93z73v9eb23WcPZIMHz16Aw9Yr6IuXjx+9/P3xI57Hv/7x6r5El/lPnizeZOfgOqBCQHOM/RzfqAA7ipE8wOHp6sOtd+9eUd6929pZXX3428r9lQP+IuTJ4g3241kV03IQOMkuxtOlZnQnGg0EAtFAVMqD1dUXL148xcdTeF6FvHmzsvIFf3Fx9ieGy+Ynlc2KcTqi62IsXp1pNQM7gcD7gJzd3SgKRemFCoNOO6DAxx/wZ2dn4WHUwhDQK7oUS9Pyvn52Ix+faTUQGwjcC9y7B8+7u4FDIRl42dl59kZu/yzlJjOd1aiblmu62HAVDEoVAAP9i6AQhR8LPFh9s0L82dnnz5+DwCX8bKw7qXhajn2gP85uJNBgqDF5b3JycgIewObPUuAA+UQnmh9/kfkQKMCABntA4bT8+A+8BMbEdD6eHhmqTExM8q/JiQn5idD4At83KkMfP36S+Ovr68NMzUopTct5Ce6kUvlqeqbUqjSQKmWS+Pggl2azUhkqjcyk159/WKfcwRGgeJ2SrxWf0p0408vubheSWISZjdZQs9HgFg1JAt82tgHeInw8Xv2AAm/f/nl3eFj6ZaxirVhzdpBZ7PYlNKiCwkipNVSpNJvNxmQDA2+o6UBHfDpezScSibeQT3b75eFLfEKkeK1YhwUY9Czb7elsMpXI5z/vp0c2SiDRGmrsAhfRrVapVNogOuDzienp6dTr18B3tS/SrFjVWjEU4LLgAIOlbDY5Pb2/X02nZ2ZGNkDjcwmzsTEyMjLD6dU4xycL2SW7PRMUeAmUrhVTDxiMPbcEhxMMtgvlwuvpfAJ6Ih5Pg8Y+YAFMQTo0HvCpVDKZLWxD+4PB4K1hPilVulas150wsAs+t8Npc9ntsUS5XEimphPQFflqFT2k7FHPY9shyWw5scn5QeH2oOJBQKtkuhMwBH2iGwTAAIZiOVtIpYAEFqiBSeCoAzzBofjlApQf6k+xGIdVTEpRwMSswjiVwLVMCvPlbDKZTKEGmQBYYhO9jL1vX85wgfZ147CaSalON2BkZo/YFp2ZoIuKYF9Kzs/PlwuF5EFSxAb6fDmJeHsmk1ngFRhXI0BzQiO76vPVRYfT6XJJCu/3CvMoUc5mswX6ykLL0WrvPR63ZZwoIKDALePgGXWTUhDweHw0Dm1BuQr2zaW9Qnn+IOVycm9pkw7ZbE4swGEB5YvVsoAHBZy2TNCGVcjYeTa3tpco21ub0o+WXcB3ZhzIF9DglpYEFM8JUcDq7RhgqCdoQFL+kt8A3AV4ib+AfKFdtzIVH0xoVmxiFi+EGxxWcLmCtuXMMg/WJYh44DuALwqYYL12GQTUTUoN7LZfNugogAT8y8gq0vcAd3K+JCAI9dsML0TK14q7dQbWG/L7/QcGTmylzZYhqPREcQbbiHe4F0QI4ts1z6D2jOI/ndKklAaBHw1oHDjIIZixfR1qewb4brcP8LUar4GVGVVPSg3sSggyVhvziDVRUnAe1MIpBw8hHwS89bpXyEEPXGGDJxT+vaKzSmboZeZQKDxeG/N6a6LopjI4JIeFYAeNcDhMfG/OmxNAwcyMBjWTUlql0pxjZ8PhcGQshN0gwjWJHBYWHM52W2YT3u2o1Xyix5PLgWo9B7lABdCrWyvGT+gWEIiEQ3wkkIJbEBwOUZTRYtvNiw+XDE+t5s9RLLwAiielPVIJDIyZI5AwKHhRQeB1OEhdFHwYxMMpi4M2lxszM2aAjyV65ffRyCUwsd7IFCQyhW3zetp1pIk+KfVxUYIjXcLncuNG/rFEcQH4KOjiBqapTVSYCo+N4XUJYfW2LFDzyPScnxLyw7AdRH638r8WdC5Gp+hiYLoWi83FYrEpPhYg9XGPFB+1nPNDFH/o6iAOgO5T+tOqbqXCG3nQwGBkzBqbg1wjBX5x/CLU8k6svcTv1p8+pup2tp5eGgbUC8wSmysWi1IZwiGykMOxYUotHLYwZiI+fipSeTdbP14PucF581xxDRSKoDCFZwVpAFciyzGfZ9T/yO9Xe2cpN8BxYNAyNjpVXFt7v1acozpsXov8M+HIKGNaw4DuaPjcAMdBdx8WgY2a59YgUAeSwFpIiUwh/yrg6fSD8Xck/EMGUARU6LbGikVyAIniNW5BHpHI9SuIp+bD+D8aPh+JcDZKCvhfXrGYYzgW0KBTB/NlpPfI+K7Tx47s3mZ+Yy8WARXwlOxhPedHLdetZrw2mK3XLaPniWU0EB7Lf0Q39crXA7q1mSv0gYNJyw72duALPLQmoGuw9dT8o7qt+VARSEFyAAmDyWTE3R1ardEEbMPAQB81nvBH2nypmdpDCiCh69MMdKLp0yEc6FB8fnP90W8x6GwwAAcu8VWQ/s22F3QU+rmDHi0kEf4OfnQS6f3fDM87gjvwXSZ6OZ0dJv3fcovJIQct7fE5Bh4UeEM7fbTfni474GYf7fFDwdPhX95yxTd5SXus/pPtXt/zPd/zPf+X/A2C0RxvbxOJzQAAAABJRU5ErkJggg==",alt:"Credits teaching UI",style:{justifyContent:"center"}},Rc={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAADAFBMVEVHcEzBvbvFvbrCvbrgwbzOvr3DvbzWwb7kw73bwL3CvrvBvLnCvLnAvbrAvrq9vLm+vLq7uri9u7nBvLq/vbu7u7m8vbupqam0srLEmNysp6u3t7bd2NWqqan9yZ/4yafIxsX2xaHdyMvi39729PKnpqbn4+Hixsrs6Obw7u36xqH7y6bMt9bv6+vz8fD/ypr2vafPvbPslcDsoMPp6d7pkMC/ld/kzN68tb7AwcvCpdXn4ePaz8z95Zb856/96a/95q//yZb/yJX08vH19PP+57Dx7+3r5+R4R5n96LH/ypp+TJz/ypjv7evs6efp5eLu6+nh2tf/yJLn4uDm4N3b1NDqz/fgxOzy8O/Lw7r+5JT+5InOxsDjye/dv+v49/bRycTj3dv+7rf+9b3mzfD+3qH+4p38+/rVzcjf19P/0ZvYtuhwRJT/2p7/zpTSquP/AADKvbX/06HbuumIU5/GuKhpP4/95rf/0pLyl7mZZrjDgADc0Mq0bC2/jtj0oMDUsOf/zZ3Lmt/Yy8PFwa/hz+SmPWe/dAH/5HrBsaH+7K6md8r/15n2qMuyhdDujLPVx72hbsL/8pL/16e0cxf/4Kf+5aD/tHDmeqf/vXy5idXTwrf/5aykPQTFSjXqg67TpOK4dx9MLJ+xOiX+3JKLWq/gb5/Lod+ve8urTgSAUJ7/zKT/y3/8gyucOWXYztD/755bP5dfOof+6af/xoqsYBnwv0b+6YvMW4vcztr+dgdFOo7+pmLPnHYQBIXXZJmwQ4LAUIDOhgX+iVnQu6v+lUOPOmVwVZA7HJNuS6OnChC/fDH/0oupQ1zlrSOqb2P6z2XKkVrQX5rTrJbTXUW6fkmOY3rZblfovem4TlL+soT/XQuvUivojXXngGH8z7Tss9fKFwXdr+WZPXvqo414ZYT/SACcbG2lVmf/2HzrwNToXwWNYrdlKInanQCMGXH/NgCqrOXXernvtqSHQIb/mQB2mOH/skWyVqt/AHGThqTuElR8sernrnrXvrpHcEwDabOqAAABAHRSTlMAFSAaAwkMAgEGECUyWjlRR29AK3iHZbOm/qaVoIyuYp16hbfpasdHz9XURb7o3OyT0tyz4vfgafjqrPPi//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8ArqxfkQAAD2VJREFUeNrsmWlMk3kex3uXllvALJsJiG9M1EQdx7kSStuELJS+2WYTs5CQbBuaTaWFLQQQUqRsFDJci6WUsoDcwx2OCoZbGC5FuRRXFG/FA9F1ZnZmZ7Ob/f2e52lp5R0PzCu+hfZ5WsL38//+f/8LGIw97WlPe9rTnva0LblR4vP51NWvaw6+HBeRIL+OO+kt+Egkxa4zgD1lzqUEt/hih9hdBqLxpDlnqw2fSzHsFgLVeC6XRxkwPY4Eh4CCj3gIqZ8hGXYFAcMn3Pl4xwoOOia3SwLfsmNBwSziB3cJAZuP9nh9JEgikRC2cupZjm/IZcagI1QMiLALzUd79nEJIbnDWeL0hsx4XEiksLMEZPMxfPcgicLhJ0F/nU4hlThjGINYJMLOETiazw1SbDZXo0dpdDoNIeCQyhUK7BpZEFi7QQg7VAjoD+OOwQhWKBSku+yhXq9TWAcn2vtB7RODFqtCg2+1Yp/IZMZgDGGHuoHwx/iDFNBIiRS+oeHWiXv/SXTWi/ZBm0bTKpciJIRAEuxABnZ/9jGFRIrdLTXqFYP3EhPfj68oTBWRkZHhFSbJyvh7gGi36PRGsiTkx4QkAX0A9Ocw/BTSh2AulYD9xPvEeytmpQqkJIVXphWg6rdoNERMEnkrCwlod4IbXyDgCRjuRHlB2/Qmy73EcT06homc9A1AKPXjkEKbXkfWaSt7BwjIAmTwbBAsRquTtSeOm53dxWL7VVikUmUaT3xh0Rixp4CAQZ8AOwA68zCUH8Qqedja/0IB9pvGYieJwiAGxfvEQY1R0voQCA7TBoAAuNABITboAShuvbG/v4K0p5wdBCIxSaRUiduBAHBhzMhC6BKQATDbFAqdQqczan4cBwPRlqaTBASVKEylHE+0aNBfKm0V4JToRjeAIDBHmX6aUCo3+5xMQOTwF1EMKlX7C5sR61DaGkQvAioAyl9v+zFcJd4EsNfBZgAisktUkffaNTIEkLVyIAJaADweIwRm+zSQ/ietKlzs5C527QrijhgOqrQXViOOGnlrMC4K2wbAHuAyDuNagwRtKpehT3E41aH9PaVqYkKDo1ZupDUQYBLiCvk8m16fn5+flt9mVoa7xG+PQOScASFVfr8Ni1Aia6UNwPCY1WqRIH821bn/7SXgNBQdH4uVynFy6pK3usMGabt9gCUgZHjOavVaBNAqPwYQiUUfDUP7J6pBCzkfG4/QBOAyQmZNWi0QaM2pjsxF9qKnmu9gsX+uslrIfRLsDOgBCBi/mTVrkUBrDhe7DkIHBzkPbiJAAjaLlCCQ0QVwY55oM2vjgCCOAHB2dx4Eos0nYhxYreTejS4Ah+/xZVtpXBwimF0CcLTfpQ/IVQKq0GLDBRF2Z7QA+AK+wPtLS6k5DhHMFWLXKnSuAkcPEA9lhYXYPUqN0mAaqwEsBXzh/q/+W1+BAOq4inBq/XMeBq4RUBjKfCuxfZAYVw7RWQzgOMD0/WppHgEwArF4y0AUORM4AgizKogalEm/P8SgsTF0EwhYvke/61UjgZqKYEsdOkVApiBSzlqJ/aNcb/mexaBxTnQTcN33H/jf0KuwOCcCZ2vnKcn+ECu1VnJnDNvn7+ntCAVcP0//vy/djK5Ae7W6lMxAvKUXXPxLreQBSmYafHaYJoDQz8fzxNJCb08F+BMEW0cCtSDZ52VlnMN/5cGzEHqbcg7P3Wuf/9LQ9flvetSgerW6IjU88uMFaXNdEEVC/tQB0mSbWH3GZPBpAQhYfl4+J5aGxl6RBOrQ6NLI1PDwrXsCMgtlWBrpL5WY5O0PnsGWjA6AG0fI8vLxPrA0dJskCA1VR9cjgmsZUJsxpTJSayPOjzAETLr2O6vPWDAL0ADgC5hQA/4HvhtCgk7MIBQUE10qToUYXLYCqamp5vy2NvL8KjGabO23Hqweh+0InQQ4XKaHt++BE78MDS0YcuY7e0rRPzo6OiYmtLQnMtVJYrN2tq1tViclJgA4wL2purO6+ltoBK1TAY/t4e3/yR+Hu4cWFgzNN3M7O0PVBAAggELVpSDIBW5ftc3Wp6Xp0F9v0k2A/4PVyZ/ZNEchCfDL8PDzoYXbhuaM3j5AiCYiAOXaFR2TW48CADjC6DWWN4+r7tx58PLfoydpAfAFQpaHj+fBmeHh4eWF69cN95vH5ikEKgNS9fBFANSnaUw6S//jx1W30P/p6IcdADgUMDM9MDD8fGEMEJqbx3pDLwJDX4yrQh/mR8M8lW8bfPP4Wl3VrVt3Xr4bHR0dOURrFuAigNfXDW+7uweGpxbGcgiEnI353IsXL3Ze7OsrTUWQvr6+mJ7Uns7oV/Ptj6+BfRUATL4bvXrl6uJBWrMAl4kAnxcDABAMrI1lXK+pMVxGht75XJKCUl/ufO9GTuU1yv8u+F9ZXLyy+Cn8HloAXgCQF9GdktLdPT38/PZYRg3o8uXmyubLGRsbN2/2om5ubIzlNFdW3q9DVVXdvTE5OXplpHFkcQQAOHwaAO5e3vsCC9ffpoC6B6anl29nZOQgQwlANFdeqyQE3pX3LxsMBiQg7CcvXB1pbGwcGTmFJyM3WgA+gZlEBKiB6YHnc4CQU1OCMlyrKwGSkrq6+4YaAwI0g33HZEfHhauLjWVlgHCKxtGMBPD0/jy7PD0lJT6eQOianp5awxhyckpKwJQAqTPUlOQYcjJq7t640QHu4H+lsezSpbKysk8ZblwBTYCj2Zl5M0gQT0B0dU3XTi3PAQRQZBiAJIPQ9bmXLzvQ/kLHDdIfAC6dZMDhhrNtAFgMPfd/XZ1dXtySEh8REU9CxHcNTNfWdk0tL6/Nrc3Nza2tLS9PxXe9fYfuINK/qKjo0qWigwzetgEYJIB/QEIWECQDAIp8AYyurtra2oFaSl2gH54+JQBI/7NFqENuzO0DwEyIa4FvQlZ1YHlxQ8TU84gokiJiaop6jbDnggEhwY27MP7QH1RUdJYpZAppAPDYfj6+/kezkCBvPWIqPorSVJSDxSmWiB+6YfoD/yLCH3Scy6aRAFGF+/YHBGRlZSVklzcVN8zYAVpa7FdIAg98jZqZmfl5kWz+uXPnzsJjH5sFANveE3CIPggIOHrmTFbCt5mFeenryS3JLaCoFuLZlaehYb246cMHyh91kunOFnLpnIyIgejreQaE3VCYV5zegAxRyckAQtHMAEByQ0N6enFeU3lm9inCvuBcQUEBm4f+fBrLEUTA8tgn/CI2KSkJQgjMLGwChvSGhmRKUS1AAk1PLy5uaiosLA/Mrq4uOPeogNAXWEc0/1LLY7Lc2azPzifFxiZhP2Rnlhc2NRUXAwVqfR2e4C6vEMzLMwOzv61OyHry6DXh//oz+v+s4AqZLDbnkz/86XxsLCI8SajODswsLy+EJFBNeU1N2PLC8szMwEBwT8g6cyYp6cmjR48KXv/1bwdpAuCf6aCM/X73+7/8+fzp06djY//xr38+qf5/++bvm7oVxfGHKaQBjMEESABLUQgUpCZTt9cNCyawETE/pBCwhIRRhwg9saGnKJiBjbksb8vIzM5/8JbMHbu9pVOHnnPudYKenjrU7pvyJRCHSPl87jkmXJvrp6ezs7OPsE/+TvmIbBr7/QPh7+46nefnP+f2bOH60xrogBDIac2hPVz2+/B3//7yDK/J+/unT5/O/np8fEQyBOA49t8eGL7T7y/Xs9lqf+G6A/6w4H/fMo2e3dv1IZ0PHegEov64/3Lv5IEN/QP2Ceidfnu3n+33s88L1x0QEsJPunYzGYLBtt8e9bETHdohyOMlBEc6pN3fzlaz6XS/2oTdCUAHIkJO16AEw9uevd6N2tgIlruDQFk6DN4ftdvLzWq130A+b9xNSuG/QDgaLjZMKIE1BIWetRy1RyNsxYtHZ8m/Ex3xCxz+Zr1eb/bTn91NSkP+hJz4RW9ommncggFXaEMrRoQDkSW4LGET02Z44i8Wi/Vm8yv8Q//RhQBMyyNXul7TWk0DaoBFsIc75tAeHaaNWW43hJ8Cfj6fL9brubtJKUxIJPmqXoca3KBBD4oA+0JvuN0x4kGWy+3aBjrgYfjzuYEGC4MmpW6OC6TYVZUMTFYDUujZtt1bbHe7JWW33Q43NowdBz/tEX4ymRjzxdzABRUuJqUwJZNKlSqvwcSwLDJwJOyVTY8w7tmM4L3b24XF+GgwL7qflBbyarUKAjUy2FrW8NUBY0+dIH1oWUhvYsBgm3M/KS1cqF3HwASFVwcA9g7C6AxvmjemCQpN8Z0Hk1K12+2CAXShxRWYAy8EBX6yrFvDcPCU5u5GCPqCAVeTUileKA6YQQOKgApNAwMSmCHcLBz5nNMJzw3M/LHrSWksrlxwAV1v1TRUMFmDScPgmXA4olsQrdWCLdEnuBDgO0FSKQ0qFdgNqvUGFgH/tEkSqAF9Zmiim0TXWFpaEd5M3cyKj9hZKiU5AAMsAu4IqMCGd7MjJoUV3TQZvVaDL7hL4YQQCvz3U4X8wCCr5EEADagPoEBl0Fo8N6jDtwmOdEwuHE24mpY7r4NTpTxQKy9FAAUmwerMTOgHGjj8UodbrVGKRCNhNx1wSiAmM9nLgQoK3Soq4K5AChjkmqzsxG7oLA39fUyWXRbAOTxMJdNkoLI+oAN1gonAm3WjxreJXYebXtXEWCwiuCuA85YsxbPp7NXYUegyhYamY7HZnQ8cnq/jy6VavRIlKRp2WwA6XYsnitCgxA2YAmLqVAoHzOGUbkksiNQAV2fLnYkhGiTTmfx4PHh16DLUC5qT4VatdHPAZw1wv5gLDg78ZHCaPi+PyaHiOHwzqlo+KcQ949PhCRqkTk7TmdwlKWAd6EXxlQY8NVAvcwUlLspe8fkBUjgSE7EImdz1+MABS3EQePo6F1eUuCQnPOM7h2gRGYqQBYXz4iU5qCpz4AH4oFq8UAAvxmD/945PH6MH8RAhJqZOoArp0/P8tTrmlXCilvPnSUXJnqQkKD/u/z94uKwVF/T48CM8VIAyoEQuXypfX0Kuy8V87jyrZDLZJOFx+IFjjxf24oIWPypIYhwdUAKSeckp0OMi4gUfDv/oncc54goRGRxSIJFMZsEDkgU2wFOiFIvi6EPBY4/XNb8uKwqGfP5wIhJFCTGVSsUx8F0EuAx0gfCedv+rJRXMQUCJqCzHKLIM7EiC0QOerGT9VwVy8PnBApNIwIMg+AGO9P+n+N9wCASDoRB4UGArGAww+ve6zOPgMovjALu64ujoe17o4lzqwvN9r7J5y1ve8pa3eJt/AHx8Fr2ymgCjAAAAAElFTkSuQmCC",alt:"Credits teaching UI",style:{justifyContent:"center"}},Fc={teachingCalloutHeaderText:Ks.s1,teachingCalloutPrimaryButtonText:Ks.$k,creditsTeachingCalloutBodyText:Ks.zx,creditsTeachingCalloutTitleText:Ks.Ps,paneSilhouetteSeeLessGPTsLabel:Ks.Dc,paneSilhouetteSeeMoreGPTsLabel:Ks.XC,newConversationButtonTextDesc:Ks.kd},Mc=({isMenuOpen:e,onMenuStateChange:t,handleCopilotChatChange:n,copilotList:r,showLoadingShimmer:o,paneSilhouetteHeaderProps:i,switcherMenuChatHistoryProps:a,featureFlags:s,appPlatform:l,menuErrorProps:c,setShowCreditsTeachingCallout:u,showCreditsTeachingCallout:d,appName:p,eventLogger:f,isDarkMode:h})=>{const g=$l(),m=ec(),y="PC"===l?m:g,v=(0,os.kQ)(Fc),S=(0,Ds.P)(),[C,b]=_t.useState(!1),E=_t.useMemo((()=>r.filter((e=>!e.isLink&&!e.isHandledExternally))),[r]),T=_t.useMemo((()=>r.filter((e=>e.isLink))),[r]),w=_t.useMemo((()=>r.filter((e=>e.isHandledExternally))),[r]);let I=E,P=E.length>5;P&&!C&&(I=E.slice(0,5));const _=C?_t.createElement(Ss.nbk,null):_t.createElement(Ss.geq,null),A=a&&a.isSwitcherMenuChatHistoryPanelOpen&&a.chatHistoryContainer,k=v.teachingCalloutHeaderText(),x=v.teachingCalloutPrimaryButtonText(),N=v.creditsTeachingCalloutBodyText(),O=v.creditsTeachingCalloutTitleText(),D=v.paneSilhouetteSeeLessGPTsLabel(),L=v.paneSilhouetteSeeMoreGPTsLabel(),R=v.newConversationButtonTextDesc(),F=_t.useRef(null),M=window.innerWidth?window.innerWidth:628,B=(0,Ls.Bi)("toaster"),{dispatchToast:U}=(0,Rs.J)(B);return _t.useEffect((()=>{c?.showErrorMessage&&!o&&U(_t.createElement(Fs.y,null,_t.createElement(Ms.S,{action:_t.createElement(Vs,null,_t.createElement(js.$,{appearance:"subtle",size:"small",icon:_t.createElement(Xt.Avk,null)}))},c?.errorMessage)),{intent:"info",timeout:3e3,onStatusChange:(e,{status:t})=>{"unmounted"===t&&c?.onErrorMessageDismiss?.()}})}),[c?.showErrorMessage,o]),_t.createElement(_t.Fragment,null,s.isCreditsUIEnabled&&d&&_t.createElement(Ul,{headerText:k,title:O,bodyText:N,primaryButtonText:x,image:h?Lc:Rc,anchorId:ql,onCloseFre:e=>{u?.(!1)}}),_t.createElement(Dc,{isMenuOpen:e,onMenuStateChange:t,copilotList:r,isDrawer:!1,appPlatform:l,...i}),_t.createElement(qs.e,{...S,style:{width:`${M}px`,backgroundColor:Ws.L.colorNeutralBackground3},position:"start",open:e,onOpenChange:(e,n)=>t(e,{open:n.open})},_t.createElement(Dc,{isMenuOpen:e,onMenuStateChange:t,copilotList:r,isDrawer:!0,appPlatform:l,appName:p,...i}),_t.createElement(Ys.y,{className:y.drawerBody},o?_t.createElement(zl.Y,null):A?a.chatHistoryContainer({onPaneClose:a.handleChatHistoryPanelClose}):_t.createElement("div",{className:(0,Kn.z)(y.menuContainer)},_t.createElement(Qs.c,{style:{width:"100%"}},I.map((e=>_t.createElement(Wl,{copilot:e,key:e.id,handleCopilotChatChange:n,onMenuStateChange:t,copilotListStyle:y,switcherMenuChatHistoryProps:a,newChatLabel:R}))),P&&_t.createElement(Js.D,{key:C?D:L,icon:_,onClick:()=>{b(!C),window.requestAnimationFrame((()=>F.current?.focus())),f?.(C?"See_More_Clicked":"See_Less_Clicked",I.length.toString())},ref:F,"aria-label":C?D:L,className:y.menuItemSeeMore},C?D:L),w.map((e=>_t.createElement(Wl,{copilot:e,key:e.id,handleCopilotChatChange:n,onMenuStateChange:t,copilotListStyle:y,switcherMenuChatHistoryProps:a,newChatLabel:R}))),T.map((e=>_t.createElement(Wl,{copilot:e,key:e.id,handleCopilotChatChange:n,onMenuStateChange:t,copilotListStyle:y,switcherMenuChatHistoryProps:a,newChatLabel:R})))),_t.createElement(Os.W,null,a&&_t.createElement("div",{className:(0,Kn.z)(y.chatHistoryButton)},_t.createElement(Zs.r,{onClick:()=>{a.onClickShowChatHistoryPanel(),a.setIsSwitcherMenuChatHistoryPanelOpen(!0)}})),c?.showErrorMessage&&_t.createElement("div",{style:{position:"relative"}},_t.createElement(Xs.l,{inline:!0,toasterId:B,position:"bottom"})))))))};var Bc=n(64416),Uc=n(9171),zc=n(96578),Hc=n(68383);const Gc=(0,Hc.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.CopilotLabel"),Vc=()=>{const e=(0,os.Lh)(Gc);return e||"Copilot"};var jc=n(41002),qc=n(50033),Wc=n(89125);const Yc=()=>_t.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.createElement("path",{d:"M14.1437 3.34932C13.9101 2.54966 13.177 2 12.3439 2L11.7427 2C10.8467 2 10.0758 2.634 9.90296 3.51321L8.85352 8.85006L9.15094 7.89102C9.39431 7.1063 10.1202 6.57143 10.9418 6.57143L14.2351 6.57143L15.6352 7.74347L16.8818 6.57143H16.4905C15.6574 6.57143 14.9242 6.02177 14.6907 5.22211L14.1437 3.34932Z",fill:"url(#paint0_radial_725_52234)"}),_t.createElement("path",{d:"M6.0492 16.6427C6.28017 17.4462 7.01519 17.9997 7.85121 17.9997H9.07497C10.0844 17.9997 10.9126 17.2006 10.9488 16.1918L11.1295 11.1426L10.842 12.0951C10.6031 12.8867 9.87385 13.4283 9.04701 13.4283L5.73383 13.4283L4.34959 12.5431L3.32812 13.4283H3.71324C4.54926 13.4283 5.28427 13.9818 5.51524 14.7853L6.0492 16.6427Z",fill:"url(#paint1_radial_725_52234)"}),_t.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint2_linear_725_52234)"}),_t.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint3_linear_725_52234)"}),_t.createElement("path",{d:"M7.74902 17.9997H14.3115C16.1865 17.9997 17.3114 15.603 18.0614 13.2063C18.95 10.3668 20.1127 6.56934 16.7489 6.56934H13.8877C13.0557 6.56934 12.3238 7.11559 12.088 7.91346C11.5946 9.58288 10.7343 12.48 10.0582 14.687C9.71358 15.812 9.42651 16.7782 8.98593 17.3799C8.73893 17.7172 8.32725 17.9997 7.74902 17.9997Z",fill:"url(#paint4_radial_725_52234)"}),_t.createElement("path",{d:"M7.74902 17.9997H14.3115C16.1865 17.9997 17.3114 15.603 18.0614 13.2063C18.95 10.3668 20.1127 6.56934 16.7489 6.56934H13.8877C13.0557 6.56934 12.3238 7.11559 12.088 7.91346C11.5946 9.58288 10.7343 12.48 10.0582 14.687C9.71358 15.812 9.42651 16.7782 8.98593 17.3799C8.73893 17.7172 8.32725 17.9997 7.74902 17.9997Z",fill:"url(#paint5_linear_725_52234)"}),_t.createElement("defs",null,_t.createElement("radialGradient",{id:"paint0_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.7128 8.89484) rotate(-129.141) scale(7.20751 6.76953)"},_t.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),_t.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),_t.createElement("stop",{offset:"1",stopColor:"#0736C4"})),_t.createElement("radialGradient",{id:"paint1_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.74347 13.4005) rotate(51.7328) scale(6.58647 6.39483)"},_t.createElement("stop",{stopColor:"#FFB657"}),_t.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),_t.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),_t.createElement("linearGradient",{id:"paint2_linear_725_52234",x1:"5.29507",y1:"3.38547",x2:"6.17192",y2:"13.8705",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),_t.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),_t.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),_t.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),_t.createElement("linearGradient",{id:"paint3_linear_725_52234",x1:"6.11337",y1:"2",x2:"6.59201",y2:"13.4355",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{stopColor:"#3DCBFF"}),_t.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),_t.createElement("radialGradient",{id:"paint4_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.0861 5.45023) rotate(109.881) scale(15.2451 18.7446)"},_t.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),_t.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),_t.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),_t.createElement("linearGradient",{id:"paint5_linear_725_52234",x1:"17.6045",y1:"5.87149",x2:"17.5982",y2:"8.9847",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),_t.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"})))),Qc=e=>Xc(e)?Ct.a5.GetCachedGPTDetails:Ct.a5.GetCachedGPTList,Jc=e=>Xc(e)?Ct.a5.GetGPTDetailsTimeout:Ct.a5.GetGPTListTimeout,Xc=e=>e===cs.S.GetGPT;var Kc,Zc=n(58651);!function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"}(Kc||(Kc={}));const $c=e=>({id:zc.r9,name:e,isSelected:!0,copilotType:B.NV.Default,menuIcon:_t.createElement(Yc,null)}),eu=e=>!e||e===zc.r9,tu=e=>({id:zc.NY,name:e,isSelected:!1,isLink:!0,linkURL:zc.Vh,menuIcon:_t.createElement(Xa.zVV,null)}),nu=e=>({id:zc.UM,name:e,isSelected:!1,isHandledExternally:!0,menuIcon:_t.createElement(Xa.zVV,null)});function ru(e){return e.map(((e,t)=>({item:e,index:t}))).sort(((e,t)=>{if(void 0===e.item.copilotType&&void 0===t.item.copilotType)return 0;if(void 0===e.item.copilotType)return 1;if(void 0===t.item.copilotType)return-1;const n=B.p8[e.item.copilotType]-B.p8[t.item.copilotType];return 0!==n?n:e.index-t.index})).map((({item:e})=>e))}const ou=(e,t)=>t!==B.NV.CustomGPT?void 0:e;let iu=!1;function au(e){iu=e}const su=(e,t)=>{iu&&(null==t?Zc.log("CopilotSwitcherContainer Log:",e):Zc.log("CopilotSwitcherContainer Log:",e,t))},lu=(e,t,n,r,o,i,a)=>{const s=[{key:Ct.h3.UserQueryGuid,value:a??""},{key:Ct.h3.SelectedSwitcherMenuItemId,value:o},{key:Ct.h3.Cv,value:i}];switch(t){case ms.GPTRequest:fu(n).sendTelemetryChatEventData([...s,{key:Ct.h3.ChatEventType,value:e===cs.S.GetGPT?Ct.a5.GetGPTDetailsRequest:Ct.a5.GetGPTListRequest}]);break;case ms.GPTResponse:{const t=[...s,{key:Ct.h3.ChatEventType,value:e===cs.S.GetGPTList?Ct.a5.GetGPTListResponse:Ct.a5.GetGPTDetailsResponse}];r&&e===cs.S.GetGPTList&&t.push({key:Ct.h3.ChatEventParameters,value:r}),fu(n).sendTelemetryChatEventData(t)}break;case ms.GPTError:fu(n).sendTelemetryErrorData([...s,{key:Ct.IC.ErrorCategory,value:e===cs.S.GetGPT?Ct.a5.GetGPTDetailsError:Ct.a5.GetGPTListError},{key:Ct.IC.ErrorMessage,value:r}]);break;case ms.GetCachedGPT:((e,t,n,r)=>{const o=[...n,{key:Ct.h3.ChatEventType,value:Qc(t)}];r&&Xc(t)&&o.push({key:Ct.h3.ChatEventParameters,value:r}),fu(e).sendTelemetryChatEventData(o)})(n,e,s,r);break;case ms.GPTTimeout:((e,t,n,r)=>{fu(e).sendTelemetryErrorData([...n,{key:Ct.IC.ErrorCategory,value:Jc(t)},{key:Ct.IC.ErrorMessage,value:r}])})(n,e,s,r);break;case ms.GPTListUserPerceivedLatency:((e,t,n)=>{fu(e).sendTelemetryLatencyData([...t,{key:Ct.CT.RequestSignalType,value:Ct.a5.GetGPTListUserPerceivedLatency},{key:Ct.CT.FeatureName,value:Ct.Z_.Extensibility},{key:Ct.CT.SubFeatureName,value:Ct.EF.DeclarativeCopilots},{key:Ct.CT.UserPerceivedLatency,value:n}])})(n,s,r);break;case ms.GPTLatency:fu(n).sendTelemetryLatencyData([...s,{key:Ct.CT.RequestSignalType,value:e===cs.S.GetGPT?Ct.a5.GetGPTDetailsLatency:Ct.a5.GetGPTListLatency},{key:Ct.CT.FeatureName,value:Ct.Z_.Extensibility},{key:Ct.CT.SubFeatureName,value:Ct.EF.DeclarativeCopilots},{key:Ct.CT.UserPerceivedLatency,value:r}]);break;case ms.OpenAgentFromMOS:((e,t,n)=>{fu(e).sendTelemetryChatEventData([...t,{key:Ct.CT.RequestSignalType,value:Ct.a5.OpenAgentFromMOS},{key:Ct.CT.FeatureName,value:Ct.Z_.Extensibility},{key:Ct.CT.SubFeatureName,value:Ct.EF.DeclarativeCopilots},{key:Ct.CT.UserPerceivedLatency,value:n}])})(n,s,JSON.stringify({aapId:JSON.parse(r).appId,action:JSON.parse(r).action}))}},cu=(e,t,n,r)=>{fu(e).sendTelemetryErrorData([{key:Ct.IC.ErrorCategory,value:t},{key:Ct.IC.ErrorMessage,value:n},{key:Ct.IC.ErrorCode,value:r}])},uu=()=>jc.w.getInstance().getQueryCv()??(0,qc.N)(),du=e=>e.find((e=>e.isSelected)),pu=(e,t)=>{const n=e.filter((e=>e.copilotType===B.NV.CustomGPT));fu(t).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:Ct.a5.NumInstalledDCs},{key:Ct.h3.ChatEventParameters,value:n.length??0}])};const fu=e=>{const t=Wc.j.getInstance();return Wc.j.setTelemetryHandler(e),t},hu=e=>{const{gptListProps:t,fetchGPTList:n,copilotSwitcherOpenRequest:r,setCopilotSwitcherOpenRequest:o,gptTelemetryHandler:i}=e,a=_t.useRef(0),s=_t.useCallback((()=>{(async()=>{var e;await(e=zc.A0,new Promise(((t,n)=>{setTimeout((()=>{t()}),e)}))),n()})()}),[n]),l=_t.useCallback((e=>{let i=Kc.Failure,l=t.copilotSwitcherMenuItemProps;if(!r||!o)return l;const u=l.find((e=>r.appId?e.metaOSAppId===r.appId:e.id.includes(r?.titleId)));return u?(u.id!==e.id&&(e.isSelected=!1),l=l.map((e=>({...e,isSelected:e.id===u?.id}))),o(null),a.current=0,i=Kc.Success):(a.current++,l=l.map((t=>({...t,isSelected:t.id===e?.id}))),1==a.current?n():a.current<=3?s():(o(null),a.current=0,i=Kc.Failure)),c(i),l}),[t,r,o]),c=e=>{const t={appId:r.appId,action:e};i?.(void 0,ms.OpenAgentFromMOS,JSON.stringify(t))};return l};const gu=(0,Hc.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterTitle1"),mu=(0,Hc.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterText1"),yu=(0,Hc.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterTitle2"),vu=(0,Hc.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.DefaultConversationStarterText2"),Su=()=>{const e=(0,os.kQ)({defaultConversationStarterTitle1:gu,defaultConversationStarterText1:mu,defaultConversationStarterTitle2:yu,defaultConversationStarterText2:vu});return[{suggestionText:e.defaultConversationStarterText1(),suggestionCategory:e.defaultConversationStarterTitle1(),iconRegular:Ss.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1},{suggestionText:e.defaultConversationStarterText2(),suggestionCategory:e.defaultConversationStarterTitle2(),iconRegular:Ss.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}]};var Cu=n(26557);const bu=(0,n(69578).Q)(Cu.zQ),Eu={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:"transparent"},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:"transparent"},chatUiStackItemInContainer:{position:"relative",height:"100%"},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:bu.colorNeutralStroke1Selected,...Yl.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:bu.colorNeutralForeground3,...Yl.Pt.borderRadius("20px"),...Yl.Pt.border("2px","solid",bu.colorNeutralBackground2Hover),":hover":{backgroundColor:bu.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:bu.colorNeutralBackground2Hover,...Yl.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:bu.colorNeutralStroke1Selected,...Yl.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:bu.colorNeutralForeground3,...Yl.Pt.borderRadius("20px"),...Yl.Pt.border("2px","solid",bu.colorNeutralBackground2Hover),":hover":{backgroundColor:bu.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:bu.colorNeutralBackground2Hover,...Yl.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},incomingShimmerCard:{alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative",...Yl.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...Yl.Pt.margin("10px")},outgoingShimmerCard:{alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative",...Yl.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...Yl.Pt.margin("10px","20px","0px","10px")},incomingShimmerCardWrapper:{...Yl.Pt.borderRadius("8px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.margin("4px","16px","16px","48px"),justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:bu.colorNeutralBackground1},outgoingShimmerCardWrapper:{...Yl.Pt.borderRadius("8px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.margin(0,"16px"),height:"124px",opacity:"0.8",backgroundColor:bu.colorNeutralBackground1},inputBox:{...Yl.Pt.borderRadius("8px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.margin(0,"16px"),height:"75px",opacity:"0.8",backgroundColor:bu.colorNeutralBackground1,display:"flex",flexDirection:"column",...Yl.Pt.padding("10px"),justifyContent:"space-between"},pills:{...Yl.Pt.borderRadius("5px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:bu.colorNeutralBackground1,width:"60%"},smallPills:{...Yl.Pt.borderRadius("5px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:bu.colorNeutralBackground1,width:"50%"},bottomContainer:{display:"flex",flexDirection:"column",...Yl.Pt.gap("10px")},pillsContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",...Yl.Pt.gap("10px"),justifyContent:"end",...Yl.Pt.margin(0,"16px"),alignItems:"center"},inputText:{width:"85%"},inputButton:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},Tu={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:Ws.L.colorTransparentBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:Ws.L.colorTransparentBackground},chatUiStackItemInContainer:{position:"relative",height:"100%"},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:Ws.L.colorNeutralStroke1Selected,...Yl.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:Ws.L.colorNeutralForeground3,...Yl.Pt.borderRadius("20px"),...Yl.Pt.border("2px","solid",Ws.L.colorNeutralBackground2Hover),":hover":{backgroundColor:Ws.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:Ws.L.colorNeutralBackground2Hover,...Yl.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":{backgroundColor:Ws.L.colorNeutralStroke1Selected,...Yl.Pt.borderRadius("20px"),width:"11px"},"::-webkit-scrollbar-thumb":{backgroundColor:Ws.L.colorNeutralForeground3,...Yl.Pt.borderRadius("20px"),...Yl.Pt.border("2px","solid",Ws.L.colorNeutralBackground2Hover),":hover":{backgroundColor:Ws.L.colorNeutralForeground2}},"::-webkit-scrollbar-track":{backgroundColor:Ws.L.colorNeutralBackground2Hover,...Yl.Pt.borderRadius("20px")},height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},incomingShimmerCard:{alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative",...Yl.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...Yl.Pt.margin("10px")},outgoingShimmerCard:{alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative",...Yl.Pt.gap("10px"),gridTemplateColumns:"min-content 100%",...Yl.Pt.margin("10px","20px","0px","10px")},incomingShimmerCardWrapper:{...Yl.Pt.borderRadius("8px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.margin("4px","16px","16px","48px"),justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:Ws.L.colorNeutralBackground1},outgoingShimmerCardWrapper:{...Yl.Pt.borderRadius("8px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.margin(0,"16px"),height:"124px",opacity:"0.8",backgroundColor:Ws.L.colorNeutralBackground1},inputBox:{...Yl.Pt.borderRadius("8px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.margin(0,"16px"),height:"75px",opacity:"0.8",backgroundColor:Ws.L.colorNeutralBackground1,display:"flex",flexDirection:"column",...Yl.Pt.padding("10px"),justifyContent:"space-between"},pills:{...Yl.Pt.borderRadius("5px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:Ws.L.colorNeutralBackground1,width:"60%"},smallPills:{...Yl.Pt.borderRadius("5px"),...Yl.Pt.border("1px","solid","rgba(230, 230, 230, 1)"),...Yl.Pt.padding("5px"),height:"8px",opacity:"0.8",backgroundColor:Ws.L.colorNeutralBackground1,width:"50%"},bottomContainer:{display:"flex",flexDirection:"column",...Yl.Pt.gap("10px")},pillsContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",...Yl.Pt.gap("10px"),justifyContent:"end",...Yl.Pt.margin(0,"16px"),alignItems:"center"},inputText:{width:"85%"},inputButton:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},wu=(0,On.n)(Eu),Iu=(0,On.n)(Tu),Pu=(e,t)=>{if(t)for(const n in e)e[n]=(0,Kn.z)(e[n],t[n]);return e};var _u=n(34824),Au=n(5435);const ku=e=>{const{className:t}=e,n=wu();return _t.createElement(Os.W,{style:t},_t.createElement(_u.E,null,_t.createElement("div",{className:n.incomingShimmerCardWrapper},_t.createElement("div",{className:n.incomingShimmerCard},_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}))),_t.createElement("div",{className:n.outgoingShimmerCardWrapper},_t.createElement("div",{className:n.outgoingShimmerCard},_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_}),_t.createElement(Au.H,{size:zc.z_})))),_t.createElement(_u.E,null,_t.createElement("div",{className:n.bottomContainer},_t.createElement("div",{className:n.pillsContainer},_t.createElement("div",{className:n.smallPills},_t.createElement(Au.H,{size:zc.it})),_t.createElement("div",{className:n.pills},_t.createElement(Au.H,{size:zc.it})),_t.createElement(Au.H,{shape:"circle",size:zc.z_})),_t.createElement("div",{className:n.inputBox},_t.createElement("div",{className:n.inputText},_t.createElement(Au.H,{size:zc.z_})),_t.createElement("div",{className:n.inputButton},_t.createElement(Au.H,{size:zc.z_,shape:"circle"}),_t.createElement(Au.H,{size:zc.z_,shape:"circle"}))))))};var xu=n(43766),Nu=n(42651);const Ou=()=>_t.createElement("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.createElement("g",{clipPath:"url(#clip0_4437_102859)"},_t.createElement("path",{d:"M43.2727 4H20.6421C16.8051 4 14.2003 7.90009 15.67 11.4445L27.445 39.8402C29.1305 43.905 34.8911 43.8971 36.5656 39.8277L48.2505 11.4309C49.7082 7.88834 47.1035 4 43.2727 4Z",fill:"url(#paint0_radial_4437_102859)"}),_t.createElement("circle",{cx:"32",cy:"36",r:"22",fill:"url(#paint1_radial_4437_102859)"}),_t.createElement("circle",{cx:"32",cy:"36",r:"22",fill:"url(#paint2_radial_4437_102859)",fillOpacity:"0.5"}),_t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M45.7494 18.8244L37.0286 40.0181C35.1844 44.4998 28.84 44.5085 26.9837 40.0318L18.2051 18.8619C18.3398 18.7533 18.4759 18.6462 18.6132 18.5407L27.4455 39.8403C29.1311 43.9051 34.8917 43.8972 36.5662 39.8278L45.3404 18.5044C45.4781 18.6095 45.6144 18.7162 45.7494 18.8244Z",fill:"url(#paint3_linear_4437_102859)"}),_t.createElement("path",{d:"M45.3348 18.5059C41.6592 15.6919 36.9872 14 32.0006 14C26.9787 14 22.3036 15.6917 18.6152 18.5419L27.4252 39.8402C29.1108 43.905 34.8714 43.8971 36.5459 39.8278L45.3348 18.5059Z",fill:"url(#paint4_radial_4437_102859)"}),_t.createElement("path",{d:"M38.2732 17.9193C38.4165 17.9308 38.5419 17.8239 38.5534 17.6806C38.5649 17.5374 38.458 17.4119 38.3147 17.4004C38.1714 17.389 38.046 17.4958 38.0345 17.6391C38.023 17.7824 38.1299 17.9079 38.2732 17.9193Z",fill:"url(#paint5_linear_4437_102859)"}),_t.createElement("path",{d:"M24.401 19.4206C24.5443 19.4321 24.6697 19.3252 24.6812 19.1819C24.6927 19.0386 24.5858 18.9131 24.4425 18.9017C24.2992 18.8902 24.1737 18.9971 24.1623 19.1404C24.1508 19.2837 24.2577 19.4091 24.401 19.4206Z",fill:"url(#paint6_linear_4437_102859)"}),_t.createElement("path",{d:"M40.2277 22.8628C40.2086 23.1017 39.9995 23.2798 39.7607 23.2607C39.5219 23.2416 39.3437 23.0325 39.3629 22.7936C39.382 22.5548 39.5911 22.3767 39.8299 22.3958C40.0687 22.4149 40.2468 22.624 40.2277 22.8628Z",fill:"url(#paint7_linear_4437_102859)"}),_t.createElement("path",{d:"M24.6881 23.4473C24.8791 23.4626 25.0464 23.3201 25.0617 23.1291C25.077 22.938 24.9345 22.7707 24.7434 22.7555C24.5524 22.7402 24.3851 22.8827 24.3698 23.0737C24.3545 23.2648 24.497 23.4321 24.6881 23.4473Z",fill:"url(#paint8_linear_4437_102859)"}),_t.createElement("path",{d:"M35.4122 24.3054C35.6033 24.3207 35.7705 24.1782 35.7858 23.9871C35.8011 23.7961 35.6586 23.6288 35.4676 23.6135C35.2765 23.5982 35.1092 23.7407 35.0939 23.9318C35.0787 24.1228 35.2211 24.2901 35.4122 24.3054Z",fill:"url(#paint9_linear_4437_102859)"}),_t.createElement("path",{d:"M35.1976 33.5143C35.3887 33.5296 35.556 33.3871 35.5713 33.196C35.5865 33.005 35.444 32.8377 35.253 32.8224C35.0619 32.8071 34.8947 32.9496 34.8794 33.1407C34.8641 33.3317 35.0066 33.499 35.1976 33.5143Z",fill:"url(#paint10_linear_4437_102859)"}),_t.createElement("path",{d:"M34.7617 34.6109C34.7426 34.8497 34.5335 35.0279 34.2947 35.0087C34.0559 34.9896 33.8778 34.7805 33.8969 34.5417C33.916 34.3029 34.1251 34.1248 34.3639 34.1439C34.6027 34.163 34.7808 34.3721 34.7617 34.6109Z",fill:"url(#paint11_linear_4437_102859)"}),_t.createElement("path",{d:"M33.461 33.4624C33.4419 33.7012 33.2328 33.8793 32.994 33.8602C32.7552 33.8411 32.5771 33.632 32.5962 33.3932C32.6153 33.1544 32.8244 32.9763 33.0632 32.9954C33.302 33.0145 33.4801 33.2236 33.461 33.4624Z",fill:"url(#paint12_linear_4437_102859)"}),_t.createElement("path",{d:"M33.0528 38.565C33.3393 38.5879 33.5903 38.3742 33.6132 38.0876C33.6361 37.801 33.4224 37.5501 33.1358 37.5272C32.8492 37.5043 32.5983 37.718 32.5754 38.0046C32.5524 38.2912 32.7662 38.5421 33.0528 38.565Z",fill:"url(#paint13_linear_4437_102859)"}),_t.createElement("path",{d:"M31.4373 25.0318C31.5806 25.0433 31.7061 24.9364 31.7176 24.7931C31.729 24.6498 31.6222 24.5244 31.4789 24.5129C31.3356 24.5014 31.2101 24.6083 31.1986 24.7516C31.1872 24.8949 31.2941 25.0203 31.4373 25.0318Z",fill:"url(#paint14_linear_4437_102859)"}),_t.createElement("path",{d:"M38.6813 28.0485C38.8246 28.0599 38.9501 27.9531 38.9615 27.8098C38.973 27.6665 38.8661 27.541 38.7228 27.5296C38.5795 27.5181 38.4541 27.625 38.4426 27.7683C38.4311 27.9116 38.538 28.037 38.6813 28.0485Z",fill:"url(#paint15_linear_4437_102859)"}),_t.createElement("path",{d:"M24.8264 28.2455C24.8149 28.3888 24.6895 28.4957 24.5462 28.4842C24.4029 28.4728 24.296 28.3473 24.3075 28.204C24.319 28.0607 24.4444 27.9539 24.5877 27.9653C24.731 27.9768 24.8379 28.1022 24.8264 28.2455Z",fill:"url(#paint16_linear_4437_102859)"}),_t.createElement("path",{d:"M29.7179 34.5555C29.7065 34.6988 29.581 34.8057 29.4377 34.7942C29.2944 34.7828 29.1876 34.6573 29.199 34.514C29.2105 34.3707 29.3359 34.2638 29.4792 34.2753C29.6225 34.2868 29.7294 34.4122 29.7179 34.5555Z",fill:"url(#paint17_linear_4437_102859)"}),_t.createElement("path",{d:"M34.8378 40.1875C34.8263 40.3308 34.7009 40.4376 34.5576 40.4262C34.4143 40.4147 34.3074 40.2892 34.3189 40.146C34.3303 40.0027 34.4558 39.8958 34.5991 39.9073C34.7424 39.9187 34.8493 40.0442 34.8378 40.1875Z",fill:"url(#paint18_linear_4437_102859)"}),_t.createElement("circle",{cx:"30.7065",cy:"54.635",r:"10.2651",fill:"url(#paint19_radial_4437_102859)"}),_t.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint20_radial_4437_102859)"}),_t.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint21_radial_4437_102859)"}),_t.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint22_radial_4437_102859)"}),_t.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint23_radial_4437_102859)",fillOpacity:"0.8"}),_t.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint24_radial_4437_102859)",fillOpacity:"0.5"}),_t.createElement("path",{d:"M45.5363 18.026C41.7695 15.1847 37.0813 13.5 31.9996 13.5C26.8959 13.5 22.1891 15.1993 18.4141 18.0629L18.6122 18.5407C22.3207 15.6929 26.9624 14 31.9996 14C37.0152 14 41.6389 15.6785 45.3394 18.5043L45.5363 18.026Z",fill:"url(#paint25_linear_4437_102859)"})),_t.createElement("defs",null,_t.createElement("radialGradient",{id:"paint0_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(12.96 91.5892) rotate(-72.0032) scale(88.3469 77.6412)"},_t.createElement("stop",{offset:"0.693439",stopColor:"#FEE39E"}),_t.createElement("stop",{offset:"0.944453",stopColor:"#E7E7E7"})),_t.createElement("radialGradient",{id:"paint1_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(6.97869 113.113) rotate(-69.2873) scale(101.649 100.571)"},_t.createElement("stop",{offset:"0.54057",stopColor:"#FEE39E"}),_t.createElement("stop",{offset:"0.756027",stopColor:"#E7E7E7"})),_t.createElement("radialGradient",{id:"paint2_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(24.8846 10.6232) rotate(77.745) scale(40.8411 13.4678)"},_t.createElement("stop",{offset:"0.722796",stopColor:"#A99B93"}),_t.createElement("stop",{offset:"1",stopColor:"#E7E7E7",stopOpacity:"0"})),_t.createElement("linearGradient",{id:"paint3_linear_4437_102859",x1:"32.604",y1:"24.5358",x2:"30.1599",y2:"50.2788",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{stopColor:"#E7E7E7"}),_t.createElement("stop",{offset:"1",stopColor:"white"})),_t.createElement("radialGradient",{id:"paint4_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(13.7515 86.4791) rotate(-69.9718) scale(80.4505 48.3189)"},_t.createElement("stop",{offset:"0.557175",stopColor:"#FEE39E"}),_t.createElement("stop",{offset:"0.650777",stopColor:"#FFB900"}),_t.createElement("stop",{offset:"0.791699",stopColor:"#FF5C39"}),_t.createElement("stop",{offset:"0.875",stopColor:"#DF4221"}),_t.createElement("stop",{offset:"1",stopColor:"#711400"})),_t.createElement("linearGradient",{id:"paint5_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint6_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint7_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint8_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint9_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint10_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint11_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint12_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint13_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint14_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint15_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint16_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint17_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("linearGradient",{id:"paint18_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),_t.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),_t.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),_t.createElement("radialGradient",{id:"paint19_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(30.7065 55.1016) rotate(121.43) scale(9.84288 6.65281)"},_t.createElement("stop",{offset:"0.271006",stopColor:"#A9A9A9"}),_t.createElement("stop",{offset:"0.715999",stopColor:"#B1B1B1",stopOpacity:"0.5"}),_t.createElement("stop",{offset:"0.934077",stopColor:"#DCDCDC",stopOpacity:"0"})),_t.createElement("radialGradient",{id:"paint20_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.8709 50.8751) rotate(120.689) scale(10.5254)"},_t.createElement("stop",{offset:"0.103226",stopColor:"#C58FF1"}),_t.createElement("stop",{offset:"0.322917",stopColor:"#9D50EE"}),_t.createElement("stop",{offset:"0.510417",stopColor:"#7B30EA"}),_t.createElement("stop",{offset:"0.78125",stopColor:"#CB5285"})),_t.createElement("radialGradient",{id:"paint21_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.9445 50.0656) rotate(104.486) scale(8.23697)"},_t.createElement("stop",{stopColor:"#DAB0F2"}),_t.createElement("stop",{offset:"0.806053",stopColor:"#D1A5EA",stopOpacity:"0"})),_t.createElement("radialGradient",{id:"paint22_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(33.0917 49.8449) rotate(123.541) scale(3.92887)"},_t.createElement("stop",{stopColor:"#EDDAFD"}),_t.createElement("stop",{offset:"0.573279",stopColor:"#D8BDEF",stopOpacity:"0.57836"}),_t.createElement("stop",{offset:"1",stopColor:"#BC95DC",stopOpacity:"0"})),_t.createElement("radialGradient",{id:"paint23_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.0383 52.4709) rotate(97.8153) scale(9.88655)"},_t.createElement("stop",{offset:"0.446038",stopColor:"white",stopOpacity:"0"}),_t.createElement("stop",{offset:"0.841379",stopColor:"white"})),_t.createElement("radialGradient",{id:"paint24_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(31.8462 58.0405) rotate(-90) scale(4.03312 7.97021)"},_t.createElement("stop",{stopColor:"#FFB3BB"}),_t.createElement("stop",{offset:"1",stopColor:"#FE625D",stopOpacity:"0"})),_t.createElement("linearGradient",{id:"paint25_linear_4437_102859",x1:"18.4141",y1:"19.5907",x2:"18.2667",y2:"10.1574",gradientUnits:"userSpaceOnUse"},_t.createElement("stop",{stopColor:"#F3F3F3"}),_t.createElement("stop",{offset:"0.853323",stopColor:"#E7E7E7"})),_t.createElement("clipPath",{id:"clip0_4437_102859"},_t.createElement("rect",{width:"64",height:"64",fill:"white"})))),Du={root:{position:"relative",alignItems:"center",justifyContent:"space-between",...Yl.Pt.overflow("hidden","auto"),scrollBehavior:"smooth",height:"100%"},mainContent:{alignItems:"center",justifyContent:"center",marginTop:Ws.L.spacingVerticalXXL,rowGap:Ws.L.spacingVerticalL,height:"100%"},textContent:{rowGap:Ws.L.spacingVerticalM,alignItems:"center",maxWidth:"220px"},text:{textAlign:"center"}},Lu=(0,On.n)(Du),Ru=({isDarkMode:e,errorScreenTitle:t,errorScreenText:n})=>{const r=Lu();return _t.createElement(Os.W,{style:r.root},_t.createElement(Os.W,{style:r.mainContent},_t.createElement(Ou,null),_t.createElement(Os.W,{style:r.textContent},_t.createElement(xu.M,{tabIndex:0,block:!0,className:r.text},t),_t.createElement(Nu.c,{tabIndex:0,block:!0,className:r.text},n))))},Fu=_t.forwardRef(((e,t)=>{const{copilotChatProps:n,updatedAgentChatProps:r,copilotList:o,showLoadingShimmer:i,showError:a,shouldClearChatHistory:s,setShouldClearChatHistory:l,finalCopilotSwitcherMenuContainerStyles:c,setAtMentionApp:u,handleCopilotChange:d,getBrandingById:p}=e,f=_t.useMemo((()=>du(o)),[o]),{theme:h,themeV2:g}=n,m=(0,zc.Qt)(f?.name),y=(0,zc.vX)(),{renderExternalComponent:v,selectedComponent:S}=function({copilotChatProps:e,copilotList:t}){const{debugProps:n,copilotPluginProps:r}=e,o=r?.showCopilotSwitcherMenu,[i,a]=_t.useState(null),[s,l]=_t.useState(!1);return _t.useEffect((()=>{const e=t.find((e=>e.isSelected)),n=t.find((e=>e.copilotType===B.NV.Default));e&&n&&e.id===n.id&&l(!1),l(t&&o&&e?.id&&n?.id&&e?.id!==n?.id&&zc.tn.includes(e?.copilotType))}),[t,o,n]),_t.useEffect((()=>{const e=r?.copilotList.find((e=>e.isSelected));a(e?e.copilotComponent:null)}),[r?.copilotList]),{renderExternalComponent:s,selectedComponent:i}}({copilotChatProps:n,copilotList:o});return _t.createElement(_t.Fragment,null,i?_t.createElement(ku,{className:c.chatFreStack}):v?_t.createElement(Uc.K,{componentToRender:S}):a?_t.createElement(Ru,{isDarkMode:g?.isDarkModeEnabled??h?.isDarkModeEnabled,errorScreenTitle:m,errorScreenText:y}):_t.createElement(Os.W,{style:c.chatUiStackItemInContainer},_t.createElement(R.zn,{key:f?.id,...r,theme:h,themeV2:g,ref:t,switcherMenuProps:{currentSelectedGPTId:ou(f?.id,f?.copilotType),shouldClearChatHistory:s,setShouldClearChatHistory:l,getBrandingById:p,setAtMentionApp:u,handleCopilotChange:d}})))}));Fu.displayName="AgentSwitcherMenuChatPanel";const Mu=e=>{const{copilotChatProps:t,copilotList:n,showMenuShimmer:r,showErrorScreen:o,setErrorScreen:i,handleCopilotChange:a,newConversationClickHandler:s,showCreditUI:l,showCreditsTeachingCallout:c,setShowCreditsTeachingCallout:u,onClickShowChatHistoryPanel:d,chatHistoryContainer:p,fetchGPTList:f,gptListUserPerceivedLatencyStartTime:h}=e,{chatUiProps:g,copilotTelemetryHandler:m,copilotCommunicationHandler:y,copilotPluginProps:v,copilotFeatureFlags:S}=t,C=(0,zc.yb)(),b=y.getHostSettings()?.appPlatform,E=y.getHostSettings()?.appName?.toLowerCase(),T=g?.chatHistoryUiProps?.enableChatHistoryV2&&v?.paneSilhouetteHeaderProps?.enableChatHistory,[w,I]=_t.useState(!1),[P,_]=_t.useState(!1),A=(e,t)=>{I(t.open),t.open&&(r&&null===h.current&&(h.current=(new Date).getTime()),S.isCustomGPTsEnabled&&o&&(i(!1),f()),P&&T&&_(!1)),fu(m).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:Ct.a5.SwitcherMenuStateChange},{key:Ct.h3.ChatEventParameters,value:JSON.stringify({isOpen:t.open,isItemClick:"menuItemClick"===t.type,isPaneSilhouetteEnabled:!!v.paneSilhouetteHeaderProps})}]);const n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};R.sU.sendLoggingEventToClient(N.Yk.CopilotSwitcherMenuStateChange,n)},k=(0,as.dg)(S),x=(S?.enableNewChatOnlyOnCopilot?eu(du(n)?.id):S?.showNewChatOnGPTItem)?s:void 0,O=(e,t)=>{fu(m).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:e},{key:Ct.h3.ChatEventParameters,value:t??""}])},D=_t.useCallback((e=>{e?I(!1):_(!1)}),[]),L=_t.useMemo((()=>ru([...n])),[n]);return _t.createElement(_t.Fragment,null,v.paneSilhouetteHeaderProps&&_t.createElement(as.ZJ.Provider,{value:k},_t.createElement(Mc,{isMenuOpen:w,onMenuStateChange:A,handleCopilotChatChange:a,copilotList:L,setShowCreditsTeachingCallout:u,showCreditsTeachingCallout:c,paneSilhouetteHeaderProps:{...v.paneSilhouetteHeaderProps,afterFirstRender:()=>{y?.sendEventToClient(N.PV.SharedHeaderRendered)},showCreditButton:l,eventLogger:O},switcherMenuChatHistoryProps:T?{onClickShowChatHistoryPanel:d,chatHistoryContainer:p,isSwitcherMenuChatHistoryPanelOpen:P,setIsSwitcherMenuChatHistoryPanelOpen:_,handleChatHistoryPanelClose:D,newConversationClickHandler:x}:void 0,featureFlags:S,appPlatform:b,menuErrorProps:S.isCustomGPTsEnabled?{showErrorMessage:o&&w,errorMessage:C}:void 0,appName:E,eventLogger:O})),!v.paneSilhouetteHeaderProps&&_t.createElement(Bc.V,{isMenuOpen:w,onMenuStateChange:A,handleCopilotChatChange:a,copilotList:L,showLoadingShimmer:r}))},Bu=_t.forwardRef(((e,t)=>{const{style:n,theme:r,themeV2:o,copilotTelemetryHandler:i,copilotPluginProps:a}=e,[s,l]=_t.useState(void 0),[c,u]=_t.useState(!1),d=void 0!==o,p=wu(),f=Iu();let h=p;h=Pu(d?f:p,n);const[g,m]=_t.useState((()=>{})),[y,v]=_t.useState((()=>{})),[S,C]=_t.useState((()=>{})),[b,E]=_t.useState(r),[T,w]=_t.useState(o),[I,P]=_t.useState(!1),_=_t.useRef(null),[A,k]=_t.useState(-1);_t.useEffect((()=>{E(r),w(o)}),[r,o]),_t.useEffect((()=>{au(e.copilotCommunicationHandler.getHostSettings().devBuild)}));const{isLoadingMenu:x,isLoadingGPTDetails:N,fetchGPTList:O,fetchGPTDetails:D,gptDetailsProps:L,gptListUserPerceivedLatencyStartTime:R,isTimeoutForGPTDetails:F,showGPTListErrorScreen:M,setShowGPTListErrorScreen:U,showChatErrorScreen:z,copilotListInternal:H,updateSelectedAgent:G}=function({copilotChatProps:e,atMentionApp:t}){const{copilotTelemetryHandler:n,copilotPluginProps:r,copilotFeatureFlags:o}=e,[i,a]=(0,_t.useState)([]),s=Vc(),[l,c]=(0,_t.useState)(!1),[u,d]=(0,_t.useState)(!0),[p,f]=(0,_t.useState)(!1),h=(0,_t.useRef)(null),g=(0,_t.useRef)(!0),m=(e,t,r,o,a)=>{lu(e,t,n,r,du(i)?.id,o,a)},{isLoadingMenu:y,isLoadingGPTDetails:v,isTimeoutForGPTDetails:S,fetchGPTList:C,fetchGPTDetails:b,gptListProps:E,gptDetailsProps:T}=xs(o?.isCustomGPTsEnabled,e,f,c,m,uu,u,d),w=(0,zc.$q)();(0,_t.useEffect)((()=>{if(0===i.length){const e=$c(s);a([e,...r?.copilotList||[],...o.isCustomGPTsEnabled?o.isAcquirePluginsFromMosEnabled?[nu(w)]:[tu(w)]:[]])}else{const e=r?.copilotList.find((e=>e.isSelected));if(e){const t=i.find((e=>e.isSelected));t&&t.id!==e.id&&a((t=>t.map((t=>({...t,isSelected:t.id===e.id})))))}}}),[r?.copilotList]);const I=hu({gptListProps:E,fetchGPTList:C,copilotSwitcherOpenRequest:r?.copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest:r?.setCopilotSwitcherOpenRequest,gptTelemetryHandler:m});(0,_t.useEffect)((()=>{if(o?.isCustomGPTsEnabled&&E.status===ys.Success){su("Updating GPT list in switcher menu");const e=i.filter((e=>e.copilotType!==B.NV.CustomGPT)),t=i.find((e=>e.isSelected));let s=E.copilotSwitcherMenuItemProps;if(r?.copilotSwitcherOpenRequest&&o?.isAcquirePluginsFromMosEnabled?s=I(t):t?.copilotType===B.NV.CustomGPT&&(s=s.map((e=>({...e,isSelected:e.id===t.id})))),a([...e,...s]),g?.current){const e=h?.current?(new Date).getTime()-h?.current:0;lu(null,ms.GPTListUserPerceivedLatency,n,e>0?e:0),g.current=!1}}}),[E,r?.copilotSwitcherOpenRequest]),(0,_t.useEffect)((()=>{const e=i.filter((e=>e.copilotType===B.NV.CustomGPT));if(E.status===ys.Error&&e.length>0){let t="";try{t=JSON.stringify({fetchedGPTListLength:e.length})}catch(e){su("Error in stringifying data",e)}lu(cs.S.GetGPTList,ms.GetCachedGPT,n,t)}}),[E]);const P=(0,_t.useCallback)((e=>{r?.handleCopilotChatChange(e)}),[r]);(0,_t.useEffect)((()=>{pu(i,n);const e=du(i);e&&P(e.id)}),[i]);const _=(0,_t.useCallback)(((e,n)=>{const r=du(i);if(r?.id!==e){const r=i.map((t=>({...t,isSelected:t.id===e})));n&&r.push({id:t.appId,name:t.title,isSelected:!0,menuIconUrl:t.iconUrl,copilotType:B.NV.CustomGPT}),a(r);const s=du(r);o.isCustomGPTsEnabled&&s?.copilotType===B.NV.CustomGPT&&(C(),o?.useCacheForGPTDetails||b(s.id))}}),[i,t]);return{isLoadingMenu:y,isLoadingGPTDetails:v,fetchGPTList:C,fetchGPTDetails:b,gptDetailsProps:T,gptListUserPerceivedLatencyStartTime:h,isTimeoutForGPTDetails:S,showGPTListErrorScreen:l,setShowGPTListErrorScreen:c,showChatErrorScreen:p,copilotListInternal:i,setAgentListInternal:a,updateSelectedAgent:_}}({copilotChatProps:e,atMentionApp:s}),V=_t.useCallback((e=>{const t=H.find((t=>t.id===e));if(t)return su("Returning branding data from copilotListInternal",t),{name:t.name,iconUrl:t.menuIconUrl,id:e};if(s&&s.appId===e)return su("Returning branding data from atMentionApp",s),{name:s.title,iconUrl:s.iconUrl,id:e};throw su("GPT id is invalid. No branding data found"),cu(i,Ct.a5.GPTBrandingIdInvalid,`GPT id ${e} not found in copilotListInternal`),new Error(`Invalid GPT id ${e}`)}),[H,s]),{showCreditUI:j,updatedAgentChatProps:q}=function({copilotChatProps:e,copilotList:t,atMentionApp:n,fetchGPTDetails:r,gptDetailsProps:o,isTimeoutForGPTDetails:i,getBrandingById:a}){const{chatUiProps:s,copilotTelemetryHandler:l,copilotPluginProps:c,copilotFeatureFlags:u,debugProps:d}=e,p=(0,os.Lh)(ss.wr),f=s?.chatInputV2Props?.chatPlaceholderMessage,h=c?.showCopilotSwitcherMenu,[g,m]=_t.useState(null),[y,v]=_t.useState(e),[S,C]=_t.useState(u?.isCreditsUIEnabled),[b,E]=_t.useState(e.chatUiProps.creditsUIProps??{creditUpsellHandler:()=>{},setShowCreditsUI:C,upsellFwdLinkId:"",clientParam:""}),T=Su();return _t.useEffect((()=>{if(u.isCustomGPTsEnabled&&!i&&o.status===ys.Success&&""!==o.gptId){let e;if(u.isDABrandingEnabled&&o.gptId){const t=a(o.gptId);t&&(e={iconName:t.name,iconUrl:t.iconUrl,title:t.name})}su("Updating GPT details in switcher menu container");let t={...o.copilotChatProps.zeroQueryMessageV2Props,brandingInfo:e,showBranding:u.isDABrandingEnabled};if(u?.restrictConversationStartersForDA){const e=o.copilotChatProps?.zeroQueryMessageV2Props?.promptSuggestionList?.length>0?o.copilotChatProps.zeroQueryMessageV2Props.promptSuggestionList:T;t={...t,promptSuggestionList:e.slice(0,6)}}o.copilotChatProps.zeroQueryMessageV2Props=t;const n=(0,vs.xp)(o.copilotChatProps,y,p);v(n)}}),[o]),_t.useEffect((()=>{const n=du(t);if(n?.copilotType===B.NV.CustomGPT?v((t=>{const n={...e};return n.chatUiProps=t.chatUiProps,n})):v({...e}),u?.isCreditsUIEnabled&&b){const e={...s};if(e.creditsUIProps=b,e.creditsUIProps.setShowCreditsUI=C,u?.isCustomGPTsEnabled&&u?.useCacheForGPTDetails&&n?.copilotType===B.NV.CustomGPT){e.zeroQueryMessageV2Props=y.chatUiProps.zeroQueryMessageV2Props;const t=(0,vs.xp)(e,y,y.chatUiProps.chatInputV2Props.chatPlaceholderMessage);v(t)}else v({...y,chatUiProps:e});E(e.creditsUIProps)}}),[e]),_t.useEffect((()=>{const n=du(t);if(u.isCustomGPTsEnabled&&n&&n.copilotType&&n.copilotType===B.NV.CustomGPT){let t;if(u.isDABrandingEnabled&&n.id){const e=a(n.id);e&&(t={iconName:e.name,iconUrl:e.iconUrl,title:e.name})}if(u?.useCacheForGPTDetails){const o=(0,vs.YF)(n.id);if(n?.starterPrompts?.length>0||o){const r={zeroQueryMessageV2Props:{promptSuggestionList:(n.starterPrompts?.length?n.starterPrompts?.map((e=>({suggestionText:e?.text??"",suggestionCategory:e?.title??"",iconRegular:Ss.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}))):T).slice(0,6),brandingInfo:t,showBranding:u.isDABrandingEnabled}},o={...e.chatUiProps,...r},i=(0,vs.xp)(o,e,p);v(i);let a="";try{const e=(0,vs.UD)(n.id);a=JSON.stringify({agentType:e,agentId:n.id})}catch(e){a=JSON.stringify({agentType:B.zU.DeclarativeAgent,agentId:n.id})}lu(cs.S.GetGPT,ms.GetCachedGPT,l,a)}else r(n.id)}}else v({...e})}),[g,h,d]),_t.useEffect((()=>{const e=du(t);e?.id!==g&&m(e?.id)}),[t]),_t.useEffect((()=>{const e=n?p:f;v((t=>({...t,chatUiProps:{...t.chatUiProps,chatInputV2Props:{...t.chatUiProps.chatInputV2Props,chatPlaceholderMessage:e}}})))}),[n]),{isLoadingGPTDetails:!1,showCreditUI:S,updatedAgentChatProps:y}}({copilotChatProps:e,copilotList:H,atMentionApp:s,fetchGPTDetails:D,gptDetailsProps:L,isTimeoutForGPTDetails:F,getBrandingById:V}),W=_t.useRef((()=>{})),Y=e=>{W?.current(),u(!0);const t=H.find((t=>t.id===e));var n;fu(i).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:Ct.a5.CopilotChange},{key:Ct.h3.ChatEventParameters,value:JSON.stringify({id:e,type:t?.copilotType??s?.appType})}]),t?t?.isLink&&t?.linkURL?(n=t?.linkURL,window.open(n,"_blank")):t?.isHandledExternally?a?.handleCopilotChatChange(e):G(e):s&&s.appId===e&&G(e,!0)},Q=_t.useCallback((e=>{if(e.ctrlKey&&"Space"===e.code&&-1===A){const t=window.setTimeout((()=>{const e=document.querySelector("[data-unique-id^=TaskPaneOptionsBtnShared]");e&&document.activeElement!==e&&e.click(),k(-1)}),400);k(t),e.stopPropagation(),e.preventDefault()}}),[A]);return _t.createElement(Ns.V,{copilotChatHistoryContext:{setOnClickShowChatHistoryPanel:m,setChatHistoryContainer:v,setNewConversationClickHandler:C},copilotChatConversationSelectedContext:{conversationId:_,handleChatHistoryConversationClick:async(e,t)=>{const n=e??zc.r9;Y(n),_.current=t}},creditUIContext:{setShowCreditsTeachingCallout:P},stopGeneratingQuery:W},_t.createElement(is.L,{theme:T||b,shouldUseFluentV9Tokens:d,dir:T?T.dir:b.dir},_t.createElement(Os.W,{style:h.chatUiStack,customProperties:{onKeyDown:Q}},_t.createElement(Mu,{copilotChatProps:e,copilotList:H,handleCopilotChange:Y,showMenuShimmer:x,showErrorScreen:M,setErrorScreen:U,newConversationClickHandler:S,showCreditUI:j,showCreditsTeachingCallout:I,setShowCreditsTeachingCallout:P,onClickShowChatHistoryPanel:g,chatHistoryContainer:y,fetchGPTList:O,gptListUserPerceivedLatencyStartTime:R}),_t.createElement(Fu,{copilotChatProps:e,updatedAgentChatProps:q,showLoadingShimmer:N,showError:z,shouldClearChatHistory:c,finalCopilotSwitcherMenuContainerStyles:h,atMentionApp:s,setShouldClearChatHistory:u,setAtMentionApp:l,handleCopilotChange:Y,copilotList:H,ref:t,getBrandingById:V}))))}));Bu.displayName=zc.kr;const Uu=_t.forwardRef(((e,t)=>{const{copilotFeatureFlags:n}=e;return n.enableSwitcherMenuV2?_t.createElement(Bu,{...e,ref:t}):_t.createElement(zu,{...e,ref:t})})),zu=_t.forwardRef(((e,t)=>{const{style:n,copilotCommunicationHandler:r,theme:o,themeV2:i,chatUiProps:a,debugProps:s,copilotTelemetryHandler:l,copilotPluginProps:c,copilotFeatureFlags:u}=e,[d,p]=_t.useState(void 0),[f,h]=_t.useState(void 0),[g,m]=_t.useState(!1),y=void 0!==i,v=wu(),S=Iu(),C=_t.useRef(zc.r9),b=Vc(),E=r.getHostSettings()?.appPlatform,T=r.getHostSettings()?.appName?.toLowerCase(),w=(0,os.Lh)(ss.wr),I=a?.chatInputV2Props?.chatPlaceholderMessage;let P=v;P=Pu(y?S:v,n);const[_,A]=_t.useState((0,ps.A)()),[k,x]=_t.useState((()=>{})),[O,D]=_t.useState((()=>{})),[L,F]=_t.useState((()=>{})),[M,U]=_t.useState(!1),z=a?.chatHistoryUiProps?.enableChatHistoryV2&&c?.paneSilhouetteHeaderProps?.enableChatHistory,H=_t.useCallback((e=>{e?je(!1):U(!1)}),[]),[G,V]=_t.useState(u?.isCreditsUIEnabled),[j,q]=_t.useState(e.chatUiProps.creditsUIProps??{creditUpsellHandler:()=>{},setShowCreditsUI:V,upsellFwdLinkId:"",clientParam:""}),[W,Y]=_t.useState(e),[Q,J]=_t.useState(!0),[X,K]=_t.useState(!1),[Z,$]=_t.useState(!1),[ee,te]=_t.useState(!1),[ne,re]=_t.useState(o),[oe,ie]=_t.useState(i),[ae,se]=_t.useState(!1),le=_t.useRef(null),[ce,ue]=_t.useState(!0),[de,pe]=_t.useState(-1),fe=_t.useRef(null),he=_t.useRef(!0);_t.useEffect((()=>{re(o),ie(i)}),[o,i]),_t.useEffect((()=>{au(e.copilotCommunicationHandler.getHostSettings().devBuild)}));const ge=c?.showCopilotSwitcherMenu,[me,ye]=_t.useState([]),ve=_t.useMemo((()=>me.find((e=>e.id===d))?.name),[d]),Se=(0,zc.yb)(),Ce=(0,zc.Qt)(ve),be=(0,zc.vX)(),Ee=_t.useMemo((()=>me.find((e=>e.id===d))?.copilotType),[me,d]);_t.useEffect((()=>{Y(f?e=>({...e,chatUiProps:{...e.chatUiProps,chatInputV2Props:{...e.chatUiProps.chatInputV2Props,chatPlaceholderMessage:w}}}):e=>({...e,chatUiProps:{...e.chatUiProps,chatInputV2Props:{...e.chatUiProps.chatInputV2Props,chatPlaceholderMessage:I}}}))}),[f]);const Te=_t.useRef(void 0),we=(e,t,n,r,o)=>{lu(e,t,l,n,d,r,o)},{isLoadingMenu:Ie,isLoadingGPTDetails:Pe,isTimeoutForGPTDetails:_e,fetchGPTList:Ae,gptListProps:ke,fetchGPTDetails:xe,gptDetailsProps:Ne}=xs(u.isCustomGPTsEnabled,W,$,te,we,uu,ce,ue),Oe=_t.useCallback((e=>{const t=me.find((t=>t.id===e));return t?(su("Returning branding data from copilotListInternal",t),{name:t.name,iconUrl:t.menuIconUrl,id:e}):f&&f.appId===e?(su("Returning branding data from atMentionApp",f),{name:f.title,iconUrl:f.iconUrl,id:e}):(su("GPT id is invalid. No branding data found"),void cu(l,Ct.a5.GPTBrandingIdInvalid,`GPT id ${e} not found in copilotListInternal`))}),[me,f]);_t.useEffect((()=>{J(!!Ie)}),[Ie]),_t.useEffect((()=>{u.isCustomGPTsEnabled&&!Pe&&K(!1)}),[Pe]);const De=hu({gptListProps:ke,fetchGPTList:Ae,copilotSwitcherOpenRequest:c?.copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest:c?.setCopilotSwitcherOpenRequest,gptTelemetryHandler:we});_t.useEffect((()=>{if(u.isCustomGPTsEnabled&&ke.status===ys.Success){su("Updating GPT list in switcher menu");const e=me.filter((e=>e.copilotType!==B.NV.CustomGPT)),t=me.find((e=>e.isSelected));let n=ke.copilotSwitcherMenuItemProps,r=!1;if(c?.copilotSwitcherOpenRequest&&u?.isAcquirePluginsFromMosEnabled?(n=De(t),r=!0):t?.copilotType===B.NV.CustomGPT&&(n=n.map((e=>({...e,isSelected:e.id===t.id})))),ye([...e,...n]),r){const e=n.find((e=>e.isSelected));Ue(e?.id)}if(he?.current){const e=fe?.current?(new Date).getTime()-fe?.current:0;lu(null,ms.GPTListUserPerceivedLatency,l,e>0?e:0),he.current=!1}}}),[ke,c?.copilotSwitcherOpenRequest]),_t.useEffect((()=>{const e=me.filter((e=>e.copilotType===B.NV.CustomGPT));if(ke.status===ys.Error&&e.length>0){let t="";try{t=JSON.stringify({fetchedGPTListLength:e.length})}catch(e){su("Error in stringifying data",e)}lu(cs.S.GetGPTList,ms.GetCachedGPT,l,t)}}),[ke]);const Le=Su();_t.useEffect((()=>{if(u.isCustomGPTsEnabled&&!_e&&Ne.status===ys.Success&&""!==Ne.gptId){let e;if(su("Updating GPT details in switcher menu container"),u.isDABrandingEnabled&&Ne.gptId){const t=Oe(Ne.gptId);t&&(e={iconName:t.name,iconUrl:t.iconUrl,title:t.name})}Me(Ne.gptId);let t={...Ne.copilotChatProps.zeroQueryMessageV2Props,brandingInfo:e,showBranding:u.isDABrandingEnabled};if(u?.restrictConversationStartersForDA){const e=Ne.copilotChatProps?.zeroQueryMessageV2Props?.promptSuggestionList?.length>0?Ne.copilotChatProps.zeroQueryMessageV2Props.promptSuggestionList:Le;t={...t,promptSuggestionList:e.slice(0,6)}}Ne.copilotChatProps.zeroQueryMessageV2Props=t;const n=(0,vs.xp)(Ne.copilotChatProps,W,w);Y(n)}}),[Ne]);const Re=(0,zc.$q)();_t.useEffect((()=>{if(0===me.length){const e=$c(b);ye([e,...c?.copilotList||[],...u.isCustomGPTsEnabled?u.isAcquirePluginsFromMosEnabled?[nu(Re)]:[tu(Re)]:[]])}else{const e=c?.copilotList.find((e=>e.isSelected));if(e){const t=me.find((e=>e.isSelected));t&&t.id!==e.id&&ye((t=>t.map((t=>({...t,isSelected:t.id===e.id})))))}}}),[c?.copilotList]);const Fe=_t.useCallback((e=>{c?.handleCopilotChatChange(e)}),[c]),Me=(e,t)=>{$(!1);const n=me.map((t=>({...t,isSelected:t.id===e})));t&&n.push({id:f.appId,name:f.title,isSelected:!0,menuIconUrl:f.iconUrl,copilotType:B.NV.CustomGPT}),C.current!=e&&(C.current=e,ye(n),p(e))},Be=_t.useRef((()=>{})),Ue=e=>{Be?.current(),m(!0);const t=me.find((t=>t.id===e));if(fu(l).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:Ct.a5.CopilotChange},{key:Ct.h3.ChatEventParameters,value:JSON.stringify({id:e,type:t?.copilotType??f?.appType})}]),t){if(t?.isLink&&t?.linkURL)n=t?.linkURL,window.open(n,"_blank");else if(t?.isHandledExternally)c?.handleCopilotChatChange(e);else if(C.current!=e){Te.current=ou(e,t?.copilotType),eu(e)&&A((0,ps.A)());t?.copilotType===B.NV.CustomGPT&&u.isCustomGPTsEnabled&&!u?.useCacheForGPTDetails&&K(!0),Me(e)}}else if(f&&f.appId===e){"GPT"===f.appType&&u.isCustomGPTsEnabled&&!u?.useCacheForGPTDetails&&K(!0),Me(e,!0)}var n};_t.useEffect((()=>{pu(me,l);const e=me.find((e=>e.isSelected));e&&Fe(e.id)}),[me]);const ze=_t.useMemo((()=>ru([...me])),[me]),[He,Ge]=_t.useState(_t.createElement(_t.Fragment,null));_t.useEffect((()=>{const e=c?.copilotList.find((e=>e.isSelected));Ge(e?e.copilotComponent:_t.createElement(_t.Fragment,null))}),[c?.copilotList]);const[Ve,je]=_t.useState(!1),qe=(e,t)=>{je(t.open),t.open&&(Q&&null===fe.current&&(fe.current=(new Date).getTime()),u.isCustomGPTsEnabled&&ee&&(te(!1),Ae()),M&&z&&U(!1)),fu(l).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:Ct.a5.SwitcherMenuStateChange},{key:Ct.h3.ChatEventParameters,value:JSON.stringify({isOpen:t.open,isItemClick:"menuItemClick"===t.type,isPaneSilhouetteEnabled:!!c.paneSilhouetteHeaderProps})}]);const n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};R.sU.sendLoggingEventToClient(N.Yk.CopilotSwitcherMenuStateChange,n)},[We,Ye]=_t.useState(!1);_t.useEffect((()=>{const t=me.find((e=>e.isSelected)),n=me.find((e=>e.copilotType===B.NV.Default));t&&n&&t.id===n.id&&Ye(!1),Ye(me&&ge&&t?.id&&n?.id&&t?.id!==n?.id&&zc.tn.includes(t?.copilotType)),n&&n.isSelected&&Y(e)}),[me,ge,s]),_t.useEffect((()=>{const t=me.find((e=>e.isSelected));if(u.isCustomGPTsEnabled&&t&&t.copilotType&&t.copilotType===B.NV.CustomGPT)if(u?.useCacheForGPTDetails){const t={...e.chatUiProps};t.zeroQueryMessageV2Props=W.chatUiProps.zeroQueryMessageV2Props;const n=(0,vs.xp)(t,e,w);Y(n)}else{const t=(0,vs.xp)(Ne.copilotChatProps,e,w);Y(t)}else Y(e);if(u?.isCreditsUIEnabled&&j){const e={...a};if(e.creditsUIProps=j,e.creditsUIProps.setShowCreditsUI=V,u?.isCustomGPTsEnabled&&u?.useCacheForGPTDetails&&Ee===B.NV.CustomGPT){e.zeroQueryMessageV2Props=W.chatUiProps.zeroQueryMessageV2Props;const t=(0,vs.xp)(e,W,W.chatUiProps.chatInputV2Props.chatPlaceholderMessage);Y(t)}else Y({...W,chatUiProps:e});q(e.creditsUIProps)}}),[e]);_t.useEffect((()=>{const t=async()=>{u?.useCacheForGPTDetails?((t=>{const n=me.find((e=>e.id===t));let r;if(u.isDABrandingEnabled&&t){const e=Oe(t);e&&(r={iconName:e.name,iconUrl:e.iconUrl,title:e.name})}if(n){const o=(0,vs.YF)(t);if(n?.starterPrompts?.length>0||o){const o={zeroQueryMessageV2Props:{promptSuggestionList:(n.starterPrompts?.length?n.starterPrompts?.map((e=>({suggestionText:e?.text??"",suggestionCategory:e?.title??"",iconRegular:Ss.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}))):Le).slice(0,6),brandingInfo:r,showBranding:u.isDABrandingEnabled}},i=(0,vs.xp)(o,e,w);Y(i),A((0,ps.A)());let a="";try{const e=(0,vs.UD)(t);a=JSON.stringify({agentType:e,agentId:t})}catch(e){a=JSON.stringify({agentType:B.zU.DeclarativeAgent,agentId:t})}lu(cs.S.GetGPT,ms.GetCachedGPT,l,a)}else K(!0),xe(t)}})(d),Ae()):await Promise.all([Ae(),xe(d)])};u.isCustomGPTsEnabled&&Ee===B.NV.CustomGPT&&t()}),[d]);const Qe=(0,as.dg)(u),Je=_t.useCallback((e=>{if(e.ctrlKey&&"Space"===e.code&&-1===de){const t=window.setTimeout((()=>{const e=document.querySelector("[data-unique-id^=TaskPaneOptionsBtnShared]");e&&document.activeElement!==e&&e.click(),pe(-1)}),400);pe(t),e.stopPropagation(),e.preventDefault()}else if(Qe.isFluentV9TaskPaneEnabled&&"Tab"===e.code){const t=document.getElementById("CopilotSwitcherMenuID"),n=Array.from(document.querySelectorAll("button")),r=n?.slice(0).reverse().find((e=>!e.disabled));!e.shiftKey||e.target!==t&&"TaskPaneToolbarButtons"!==e.target?.parentElement?.id?e.shiftKey||e.target!==r||(e.preventDefault(),t?.focus()):(e.preventDefault(),r?.focus())}}),[de]),Xe=(e,t)=>{fu(l).sendTelemetryChatEventData([{key:Ct.h3.ChatEventType,value:e},{key:Ct.h3.ChatEventParameters,value:t??""}])},Ke=(u?.enableNewChatOnlyOnCopilot?eu(d):u?.showNewChatOnGPTItem)?L:void 0;return _t.createElement(Ns.V,{copilotChatHistoryContext:{setOnClickShowChatHistoryPanel:x,setChatHistoryContainer:D,setNewConversationClickHandler:F},copilotChatConversationSelectedContext:{conversationId:le,handleChatHistoryConversationClick:async(e,t)=>{const n=e??zc.r9;Ue(n),le.current=t}},creditUIContext:{setShowCreditsTeachingCallout:se},stopGeneratingQuery:Be},_t.createElement(is.L,{theme:oe||ne,shouldUseFluentV9Tokens:y,dir:oe?oe.dir:ne.dir},_t.createElement(Os.W,{style:P.chatUiStack,customProperties:{onKeyDown:Je}},c.paneSilhouetteHeaderProps&&_t.createElement(as.ZJ.Provider,{value:Qe},_t.createElement(Mc,{isMenuOpen:Ve,onMenuStateChange:qe,handleCopilotChatChange:Ue,copilotList:ze,setShowCreditsTeachingCallout:se,showCreditsTeachingCallout:ae,paneSilhouetteHeaderProps:{...c.paneSilhouetteHeaderProps,afterFirstRender:()=>{r?.sendEventToClient(N.PV.SharedHeaderRendered)},showCreditButton:G,eventLogger:Xe,shouldHideCopilotIconInHeader:W.chatUiProps.zeroQueryMessageV2Props?.showBranding},switcherMenuChatHistoryProps:z?{onClickShowChatHistoryPanel:k,chatHistoryContainer:O,isSwitcherMenuChatHistoryPanelOpen:M,setIsSwitcherMenuChatHistoryPanelOpen:U,handleChatHistoryPanelClose:H,newConversationClickHandler:Ke}:void 0,featureFlags:u,appPlatform:E,menuErrorProps:u.isCustomGPTsEnabled?{showErrorMessage:ee&&Ve,errorMessage:Se}:void 0,appName:T,eventLogger:Xe,isDarkMode:oe?.isDarkModeEnabled??ne?.isDarkModeEnabled})),!c.paneSilhouetteHeaderProps&&_t.createElement(Bc.V,{isMenuOpen:Ve,onMenuStateChange:qe,handleCopilotChatChange:Ue,copilotList:ze,showLoadingShimmer:Q}),X?_t.createElement(ku,{className:P.chatFreStack}):We?_t.createElement(Uc.K,{componentToRender:He}):Z?_t.createElement(Ru,{isDarkMode:oe?.isDarkModeEnabled??ne?.isDarkModeEnabled,errorScreenTitle:Ce,errorScreenText:be}):_t.createElement(Os.W,{style:P.chatUiStackItemInContainer},_t.createElement(R.zn,{key:_,...W,theme:ne,themeV2:oe,ref:t,switcherMenuProps:{currentSelectedGPTId:Te.current,shouldClearChatHistory:g,setShouldClearChatHistory:m,getBrandingById:Oe,setAtMentionApp:h,handleCopilotChange:Ue}})))))}));Uu.displayName=zc.kr,zu.displayName=zc.kr;var Hu=n(85612),Gu=n(82808),Vu=function(e){var t=(0,V.Zl2)((function(){return Promise.all([n.e(6008),n.e(3062),n.e(1511),n.e(9037),n.e(3341),n.e(7410),n.e(1757)]).then(n.bind(n,34332)).then((function(e){return{default:e.ReviewerAgent}}))}),"ReviewerAgent");return _t.createElement(_t.Suspense,{fallback:_t.createElement(_t.Fragment,null)},_t.createElement(t,e))};function ju(e,t,n){return qu.apply(this,arguments)}function qu(){return(qu=(0,r._)((function(e,t,n){return(0,c.__generator)(this,(function(r){return(0,V.cY_)("Applying suggestion",e,t,n),[2]}))}))).apply(this,arguments)}function Wu(e){return Yu.apply(this,arguments)}function Yu(){return(Yu=(0,r._)((function(e){return(0,c.__generator)(this,(function(e){return[2,""]}))}))).apply(this,arguments)}function Qu(){return Ju.apply(this,arguments)}function Ju(){return Ju=(0,r._)((function(){var e,t,n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:e="",t="",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:return n=o.sent(),e=n.email,t=n.displayName,[3,4];case 3:return r=o.sent(),(0,V.cY_)("Error getting user info: "+r),[2,{displayName:"defaultName",email:"defaultEmail"}];case 4:return[2,{displayName:t,email:e}]}}))})),Ju.apply(this,arguments)}function Xu(){return Ku.apply(this,arguments)}function Ku(){return(Ku=(0,r._)((function(){var e,t,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return e=W.t.getInstance(),t=e.getChatRef(),[4,V.n6d.getInstance(void 0,t,Ne.uB,Ne.Y6).getInDocSensitiveLabelUsingOfcJs()];case 1:return[2,{id:(n=r.sent()).labelId,parent:n.parentName,isEncrypted:n.encryptionType!==V.TzT.None,displayName:n.displayName,priority:n.order}]}}))}))).apply(this,arguments)}function Zu(){return{settings:{hostAppId:Rt(),hostAppName:"PowerPoint",hostAppPlatform:Ft(),hostAppScenario:"Copilot",hostDefaultLocale:(0,ee.hD)(oe.i.GetHostAppDisplayLanguage()),isDogfoodEnvironment:!0,resultTime:1e4,enableAutomaticScoping:!0},telemLogger:{logError:function(e){(0,V.cY_)("Reviewer agent people picker CIQ Error Log: ",e)}},entitiesSupported:[N.ck.People],isExpandedECCEnabled:!1}}function $u(e){(0,V.cY_)("DEBUG Log : Highlight comment with commentid ",+e),Ce({type:U.ChatPPTTriggerCommentHighlight,commentId:e})}var ed=n(72468),td=function(){function e(){(0,Ee._)(this,e)}return(0,Te._)(e,[{key:"onError",value:function(e,t){if(e!==V.FcJ.HandoffMessageResponse)throw(0,V.cY_)("Unhandled Handoff error type: "+e+(t?" Error: ".concat(JSON.stringify(t)):"")),new Error(V.I51);(0,ut.r5)(W.t.getInstance().getChatRef(),V.I51)}},{key:"submitSignal",value:function(e,t){var n;null===(n=W.t.getInstance().getChatRef().current)||void 0===n||n.submitOperation(t)}},{key:"onAnnotationReceived",value:function(e,t,n,r){var o=xe.B.getInstance();te.uC.typeGuard(t)&&(t.queryId&&((0,rt.Zp)(t.queryId),_.G.getInstance().removeContextId(t.queryId)),o.recordCheckPoint(Pt._R.HandoffMessageReceived)),(0,rt.$j)(o,e,n,Pt.CT.HandoffMessageResponseTime,Pt.CC.Handoff,r)}},{key:"onHandoffMessageIdSubmitted",value:function(e){var t,n;switch(_.G.getInstance().addContextId(e.queryId),e.handoffOperation){case ne.Q.GET:t=Pt.a5.HandoffMessageIdGetOperationSubmitted,n=Pt._R.HandoffMessageIdSent;break;case ne.Q.PROCESSED:t=Pt.a5.HandoffMessageIdProcessedOperationSubmitted,n=Pt._R.HandoffMessageIdProcessed}t&&xe.B.getInstance().sendChatEventTelemetry((0,rt.pN)((0,o._)({},Pt.h3.ChatEventType,t))),n&&xe.B.getInstance().recordCheckPoint(n)}},{key:"logDebug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];I.MYv&&(0,V.cY_)(t.join("\n"))}},{key:"submitQuery",value:function(e){var t;null===(t=W.t.getInstance().getChatRef().current)||void 0===t||t.submitUserQuery({text:e})}}]),e}(),nd=n(68494),rd=n(38151);function od(e){e||(0,V.cY_)("Handoff error type:"+V.xTN)}function id(e){if(!e)throw new Error("response context property undefined")}function ad(e){return sd.apply(this,arguments)}function sd(){return(sd=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){return wd.getInstance().autoExecuteQuery(e),xe.B.getInstance().sendChatEventTelemetry((0,rt.pN)((0,o._)({},Pt.h3.ChatEventType,Pt.a5.ContentProcessingOperationSubmitted))),$.R.getInstance().setState(Z.Nj.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[2]}))}))).apply(this,arguments)}var ld="7c614a77-0c4c-47ff-a605-8fe56e10dbeb";function cd(e,t,n){if(e&&e.length>0){var r,i,a=function(e){var t;if(e.toLocaleLowerCase()===ld)t=(0,I.dA5)();else t="";return t}(e);if(a)$.R.getInstance().setState(Z.Nj.EXECUTING),null===(r=t.current)||void 0===r||r.submitUserQuery({text:a}),(0,rt.kl)({query:a,queryId:"",destinationApp:rd.Ww.POWERPOINT,language:""},this.handoffMessageRequestSubmitTime);n.sendChatEventTelemetry((0,rt.pN)((i={},(0,o._)(i,P.h3.ChatEventType,P.a5.CshCopilotLinkClicked),(0,o._)(i,P.h3.ChatEventParameters,JSON.stringify({success:!!a,promptIdGuid:e})),i)))}}var ud=n(50502);function dd(e,t,n){return pd.apply(this,arguments)}function pd(){return(pd=(0,r._)((function(e,t,n){return(0,c.__generator)(this,(function(r){return(!n||n&&!Object.values(Z.CK).includes(n))&&(n=Z.CK.UnknownError),(0,hn.k)(!1,n,X.Cu.TranslatePresentation),(0,ud.tA)(e,t,PowerpointCopilotStrings.ServerErrorMessage),[2]}))}))).apply(this,arguments)}function fd(){return(fd=(0,r._)((function(e,t,n,r,o,i){return(0,c.__generator)(this,(function(a){return(0,hn.k)(!0,void 0,X.Cu.TranslatePresentation),oe.i.isWin32Platform()||oe.i.isMacPlatform()?(0,ud.BG)(e,t,i):oe.i.isWebPlatform()&&(0,ud.Kl)(e,t,n,r,o,i),[2]}))}))).apply(this,arguments)}var hd="triggerSummary",gd="TriggerCreatePresentationAbout",md="TriggerCreatePresentationFromFile",yd="TriggerAskCopilot",vd="TriggerShowKeySlides",Sd=function(){function e(t,n){(0,Ee._)(this,e),(0,o._)(this,"copilotChatRef",void 0),(0,o._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return(0,Te._)(e,[{key:"isFeature",value:function(e){return(0,M.bw)(M.WT.InAppHandoffEnabled)&&e.scenarioName==rd.Cu.INAPP&&e.destinationApp==rd.Ww.POWERPOINT&&e.sourceApp==rd.Ww.POWERPOINT}},{key:"handleValidation",value:function(e){id(e.context)}},{key:"handleExecution",value:function(e){var t=JSON.parse(e.context).featureName;if(void 0===t||t===I.u1i)throw new Error("InAppHandoffMessage - featureName is undefined.");switch(t){case I.g_R.SkittleContextMenuUserClickAction:this.handleNoQueryInAppHandOffMessageForCopilotOnCanvas(e,this.copilotChatRef);break;case I.g_R.ContextSensitiveHelpClickAction:this.handleNoQueryInAppHandOffMessageForCopilotOnContextSensitiveHelp(e,this.copilotChatRef);break;case I.g_R.CopilotTranslatedPPTInfo:this.handleNoQueryInAppHandOffMessageForCopilotTranslation(e,this.copilotChatRef);break;case I.g_R.CopilotRibbonTabButtonClickAction:(0,M.PA)(M.IY.IsSharedHandoffHandlerEnabled)&&this.handleNoQueryInAppHandOffMessageForCopilotFromRibbonTab(e)}}},{key:"handleHandoff",value:function(e,t,n,r,i){var a,s=xe.B.getInstance();n?((0,V.cY_)("handleHandoff: ".concat(e," invoked without manualSendPrompt set as false. No action taken.")),s.sendChatEventTelemetry((0,rt.pN)((a={},(0,o._)(a,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(a,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(a,P.h3.ChatErrorParameters,"{handoffFeature} invoked without manualSendPrompt set as false. No action taken."),a)))):((0,V.cY_)("".concat(e," in app handoff message received")),$.R.getInstance().setState(Z.Nj.EXECUTING),s.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:r}]),wd.getInstance().autoExecuteQuery(t),i=!0);return i}},{key:"handleNoQueryInAppHandOffMessageForCopilotTranslation",value:function(e,t){var n=xe.B.getInstance();try{var r=JSON.parse(e.context),i=r.translatedPPTURL||I.u1i,a=r.translatedPPTODSPPath||I.u1i,s=r.translatedPPTFileName||I.u1i,l=r.translatedPPTLanguage||I.u1i,c=r.messageId||void 0,u=r.isSuccess||"true",d=r.errorType||void 0;!function(e,t,n,r){if(!t)return!1;if("false"===n){if(!r)return!1}else if(oe.i.isWebPlatform()&&!e)return!1;return!0}(i,c,u,d)?dd(t,c,Z.CK.InvalidHandoffMessageReceived):"true"===u?function(e,t,n,r,o,i){fd.apply(this,arguments)}(t,c,i,a,s,l):dd(t,c,d)}catch(e){var p;throw(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotTranslation:"+e.message),n.sendChatEventTelemetry((0,rt.pN)((p={},(0,o._)(p,P.h3.ChatEventType,P.a5.PassingCopilotTranslatedPPTInfoViaInAppHandOffMessageError),(0,o._)(p,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(p,P.h3.ChatErrorParameters,e.message),p))),e}}},{key:"handleNoQueryInAppHandOffMessageForCopilotOnCanvas",value:function(e,t){var n=xe.B.getInstance();try{var r,s,l=JSON.parse(e.context).contextMenuSelection;switch(l){case gd:var c;(0,V.cY_)("TriggerCreatePresentationAbout in app handoff message received"),n.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerCreatePresentationAboutCalledViaInAppHandOffMessage}]),r=PowerpointCopilotStrings.PreFilledPromptGuideItemCreateAPresentationAbout,null===(c=t.current)||void 0===c||c.setInputAreaText(r);break;case md:var u;(0,V.cY_)("TriggerCreatePresentationFromFile in app handoff message received"),n.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerCreatePresentationFromFileCalledViaInAppHandOffMessage}]),r=PowerpointCopilotStrings.PreFilledPromptGuideItemCreatePresentationFrom,null===(u=t.current)||void 0===u||u.setInputAreaText(r);break;case hd:var d,p;if((0,M.PA)(M.IY.IsSharedHandoffHandlerEnabled))s=this.handleHandoff(hd,PowerpointCopilotStrings.PromptMenuItemSummarize,null!==(d=e.manualSendPrompt)&&void 0!==d&&d,P.a5.TriggerSummaryCalledViaInAppHandOffMessage,s);else if(0==e.manualSendPrompt)(0,V.cY_)("TriggerSummary in app handoff message received"),$.R.getInstance().setState(Z.Nj.EXECUTING),n.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerSummaryCalledViaInAppHandOffMessage}]),r=PowerpointCopilotStrings.PromptMenuItemSummarize,wd.getInstance().autoExecuteQuery(r),s=!0;else(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotOnCanvas: TriggerSummary invoked without manualSendPrompt set as false. No action taken."),n.sendChatEventTelemetry((0,rt.pN)((p={},(0,o._)(p,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(p,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(p,P.h3.ChatErrorParameters,"TriggerSummary invoked without manualSendPrompt set as false. No action taken."),p)));break;case yd:var f;(0,V.cY_)("TriggerAskCopilot in app handoff message received"),n.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerAskCopilotCalledViaInAppHandOffMessage}]),null===(f=t.current)||void 0===f||f.setInputAreaText(I.u1i);break;default:var h;(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotOnCanvas: Invoked with an unknown value of contextMenuSelection. No action taken. Value: "+l),n.sendChatEventTelemetry((0,rt.pN)((h={},(0,o._)(h,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(h,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(h,P.h3.ChatErrorParameters,"Invoked with an unknown value of contextMenuSelection. No action taken. Value: "+l),h)))}r&&(0,rt.kl)((0,a._)((0,i._)({},e),{query:r,manualSendPrompt:!s}),this.handoffMessageRequestSubmitTime)}catch(e){var g;throw(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotOnCanvas:"+e.message),n.sendChatEventTelemetry((0,rt.pN)((g={},(0,o._)(g,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(g,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(g,P.h3.ChatErrorParameters,e.message),g))),e}}},{key:"handleNoQueryInAppHandOffMessageForCopilotFromRibbonTab",value:function(e){var t=xe.B.getInstance();try{var n,r,i=JSON.parse(e.context).buttonSelection;switch(i){case vd:var a;r=this.handleHandoff(vd,PowerpointCopilotStrings.PromptMenuItemShowKeySlides,null!==(a=e.manualSendPrompt)&&void 0!==a&&a,P.a5.TriggerShowKeySlidesCalledViaInAppHandOffMessage,r);break;case hd:var s;r=this.handleHandoff(hd,PowerpointCopilotStrings.PromptMenuItemSummarize,null!==(s=e.manualSendPrompt)&&void 0!==s&&s,P.a5.TriggerSummaryCalledViaInAppHandOffMessage,r);break;default:var l;(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotFromRibbonTab: Invoked with an unknown value of buttonSelection. No action taken. Value: "+i),t.sendChatEventTelemetry((0,rt.pN)((l={},(0,o._)(l,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot Ribbon Tab - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(l,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(l,P.h3.ChatErrorParameters,"Invoked with an unknown value of buttonSelection. No action taken. Value: "+i),l)))}n}catch(e){var c;throw(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotFromRibbonTab:"+e.message),t.sendChatEventTelemetry((0,rt.pN)((c={},(0,o._)(c,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot Ribbon Tab - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(c,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(c,P.h3.ChatErrorParameters,e.message),c))),e}}},{key:"handleNoQueryInAppHandOffMessageForCopilotOnContextSensitiveHelp",value:function(e,t){var n=xe.B.getInstance();try{if(!e.context)throw new Error("response.context is undefined");cd(JSON.parse(e.context).promptIdGuid,t,n)}catch(e){var r;throw(0,V.cY_)("handleNoQueryInAppHandOffMessageForCopilotOnContextSensitiveHelp:"+e.message),n.sendChatEventTelemetry((0,rt.pN)((r={},(0,o._)(r,P.h3.ChatEventType,"InAppHandoffMessage handling for Copilot on Context Sensitive Help - ".concat(te.uC.getTypeName(),"_Error")),(0,o._)(r,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(r,P.h3.ChatErrorParameters,e.message),r))),e}}}]),e}(),Cd=function(){function e(t,n){(0,Ee._)(this,e),(0,o._)(this,"copilotChatRef",void 0),(0,o._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return(0,Te._)(e,[{key:"isFeature",value:function(e){var t=JSON.parse(e.context);return(0,M.PA)(M.IY.IsTellMeCopilotHandoffEnabled)&&(null==t?void 0:t.featureName)==I.g_R.TellMe}},{key:"handleValidation",value:function(e){var t=xe.B.getInstance();id(e.context);try{od(e.query)}catch(e){var n;(0,V.cY_)("TellMeHandoffHandler: undefined query received from TellMe handoff message"),t.sendChatEventTelemetry((0,rt.pN)((n={},(0,o._)(n,P.h3.ChatEventType,P.a5.TellMeQueryHandOffError),(0,o._)(n,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(n,P.h3.ChatErrorParameters,e.message),n)))}}},{key:"handleExecution",value:function(e){var t,n,r,o=null===(t=e.query)||void 0===t?void 0:t.trim();null===(n=this.copilotChatRef.current)||void 0===n||n.setInputAreaText(o),null===(r=this.copilotChatRef.current)||void 0===r||r.setInputFocus(),(0,rt.kl)(e,this.handoffMessageRequestSubmitTime);var i=xe.B.getInstance();(0,V.cY_)("Received TellMe handoff query: ",o),!1===e.manualSendPrompt&&o&&wd.getInstance().autoExecuteQuery(o),i.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerTellMeQueryViaInAppHandOffMessage}])}}]),e}(),bd=function(){function e(t,n){(0,Ee._)(this,e),(0,o._)(this,"copilotChatRef",void 0),(0,o._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return(0,Te._)(e,[{key:"isFeature",value:function(e){var t;return null!==(t=e.manualSendPrompt)&&void 0!==t&&t}},{key:"handleValidation",value:function(e){id(e.context),od(e.query)}},{key:"handleExecution",value:function(e){var t,n,r=e.query;null===(t=this.copilotChatRef.current)||void 0===t||t.setInputAreaText(r),null===(n=this.copilotChatRef.current)||void 0===n||n.setInputFocus(),(0,rt.kl)(e,this.handoffMessageRequestSubmitTime)}}]),e}(),Ed=function(){function e(t,n){(0,Ee._)(this,e),(0,o._)(this,"copilotChatRef",void 0),(0,o._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return(0,Te._)(e,[{key:"isFeature",value:function(e){var t;if(!(0,M.sW)())return!1;var n=null===(t=e.content)||void 0===t?void 0:t[0].contentString,r=JSON.parse(null!=n?n:"{}");return(null==r?void 0:r.HVCScenarioName)&&"PPT"===(null==r?void 0:r.HVCScenarioName)?((0,V.cY_)("entityPickerProps: ",n),!0):((0,V.cY_)("entityPickerProps is undefined in handoffMessageResponseProcessor"),!1)}},{key:"handleValidation",value:function(e){id(e.context),od(e.query)}},{key:"handleExecution",value:function(e){var t=this;return(0,r._)((function(){var n,r,a,s,l,u,d;return(0,c.__generator)(this,(function(c){return function(e,t,n,r){var a,s,l,c=/(https:\/\/(www\.)?\S*)(\s|$)/i,u={featureName:Pt.CC.Commanding,subFeatureName:Pt.Ff.HandOff};if(c.test(e.query)){var d,p=JSON.parse(e.context).sourceDocUrl;if(void 0===p||p===I.u1i)throw new Error("sourceDocumentLink is undefined");var f=p.substring(p.lastIndexOf("/")+1),h=e.query.match(c)[1],g=e.query.split(h);null===(d=n.current)||void 0===d||d.addResponseMessage((0,ut.FL)({linkPrefix:g[0],linkText:decodeURI(f),linkSuffix:g.length>1?g[1]:void 0},(function(){return(0,Ne.PJ)(h)}),h,ut.bq,!0,Z.Xw.CHATPPT,void 0,void 0,u))}else{var m;null===(m=n.current)||void 0===m||m.addResponseMessage((0,ut.l6)(e.query,ut.bq,!0,u))}xe.B.getInstance().sendLatencyTelemetry((0,rt.pN)((0,o._)({},Pt.CT.UserPerceivedLatency,(0,R.WU)(r)))),$.R.getInstance().setState(Z.Nj.EXECUTING),null===(a=n.current)||void 0===a||a.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(l=(0,bt.A)().get(t))&&void 0!==l?l:[]},(0,Ne.$2)())),null===(s=n.current)||void 0===s||s.startLoadingUi()}(e,Z.Ae.TransformDocument,t.copilotChatRef,t.handoffMessageRequestSubmitTime),s=JSON.parse(null!==(a=null===(n=e.content)||void 0===n?void 0:n[0].contentString)&&void 0!==a?a:"{}"),u=null!==(l=null==s?void 0:s.entityList)&&void 0!==l?l:[],d={list:u,headerDescription:I.d99,entityInteractionDisabled:!0},null===(r=t.copilotChatRef.current)||void 0===r||r.addResponseMessage((0,ut.i3)(d)),(0,rt.kl)(e,t.handoffMessageRequestSubmitTime),[2]}))}))()}}]),e}(),Td=function(){function e(t,n){(0,Ee._)(this,e),(0,o._)(this,"copilotChatRef",void 0),(0,o._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return(0,Te._)(e,[{key:"isFeature",value:function(e){return!0}},{key:"handleValidation",value:function(e){id(e.context),od(e.query)}},{key:"handleExecution",value:function(e){var t=this;return(0,r._)((function(){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,ad(e.query)];case 1:return n.sent(),(0,rt.kl)(e,t.handoffMessageRequestSubmitTime),[2]}}))}))()}}]),e}(),wd=function(e){(0,Pe._)(n,e);var t=(0,_e._)(n);function n(){return(0,Ee._)(this,n),t.call(this,new td)}return(0,Te._)(n,[{key:"getHandoffMessageIdSignal",value:function(e,t,n){return new yn.sP({handOffMessageId:t,handoffOperation:n,queryId:e})}},{key:"isHandoffAutoSubmitPromptsEnabled",value:function(){return(0,M.PA)(M.IY.IsHandoffAutoSubmitPromptsEnabled)}},{key:"processHandoffMessage",value:function(e){for(var t=W.t.getInstance().getChatRef(),n=[new Cd(t,this.handoffMessageIdRequestSubmitTime),new Sd(t,this.handoffMessageIdRequestSubmitTime),new bd(t,this.handoffMessageIdRequestSubmitTime),new Ed(t,this.handoffMessageIdRequestSubmitTime),new Td(t,this.handoffMessageIdRequestSubmitTime)],r=0;r<n.length;r++){var o=n[r];if(o.isFeature(e)){o.handleValidation(e),o.handleExecution(e);break}}}},{key:"sendHandoffDocUrlSignal",value:function(){var e,t=Office.context.document.url,n=new nd.Ox({documentUrl:t}),r=new tt.Xr({parentPath:["session","doc"],items:[{id:ot.r.generateId(),body:n}]});null===(e=W.t.getInstance().getChatRef().current)||void 0===e||e.submitOperation({operation:r,workflowAnnotationType:nd.Ox.getTypeName()})}}],[{key:"getInstance",value:function(){return n._instance||(n._instance=new n),n._instance}}]),n}(V.Q6w);(0,o._)(wd,"_instance",void 0);var Id=function(){return Office&&"ExtensionLifeCycle"in Office&&"taskpane"in Office.ExtensionLifeCycle};function Pd(){return _d.apply(this,arguments)}function _d(){return(_d=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return(0,ve.cY)("Closing Shared Header"),Id()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.close()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function Ad(){return kd.apply(this,arguments)}function kd(){return(kd=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return(0,ve.cY)("Moving Shared Header"),Id()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.move()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function xd(){return(xd=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return(0,ve.cY)("Shared Header Loaded"),Id()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.notifyHeaderLoaded()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function Nd(){if(oe.i.isWin32Platform())return{buttons:[{type:x.Move,clickHandler:Ad},{type:x.Close,clickHandler:Pd}]}}const Od="fui-Image",Dd=(0,Xn.X)({base:{g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw",B7ck84d:"f1ewtqcl",mc9l5x:"f14t3ns0"},bordered:{icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"]},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},square:{},shadow:{E5pizo:"f1whvlc6"},center:{st4lth:"f1plgu50",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},contain:{st4lth:"f1kle4es",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},default:{},cover:{st4lth:"f1ps3kmd",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},none:{st4lth:"f1plgu50",Ermj5k:["f13uwng7","fjmyj0p"],Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},block:{a9b677:"fly5x3f"}},{d:[".fj3muxo{border-top-color:var(--colorNeutralStroke1);}",".f1akhkt{border-right-color:var(--colorNeutralStroke1);}",".f1lxtadh{border-left-color:var(--colorNeutralStroke1);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".f14t3ns0{display:inline-block;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1whvlc6{box-shadow:var(--shadow4);}",".f1plgu50{object-fit:none;}",".f14xojzb{object-position:center;}",".f1l02sjl{height:100%;}",".fly5x3f{width:100%;}",".f1kle4es{object-fit:contain;}",".f1ps3kmd{object-fit:cover;}",".f13uwng7{object-position:left top;}",".fjmyj0p{object-position:right top;}"]}),Ld=_t.forwardRef(((e,t)=>{const n=((e,t)=>{const{bordered:n=!1,fit:r="default",block:o=!1,shape:i="square",shadow:a=!1}=e;return{bordered:n,fit:r,block:o,shape:i,shadow:a,components:{root:"img"},root:Gn.Gk((0,Vn.g)("img",{ref:t,...e}),{elementType:"img"})}})(e,t);return(e=>{const t=Dd();e.root.className=(0,Kn.z)(Od,t.base,e.block&&t.block,e.bordered&&t.bordered,e.shadow&&t.shadow,t[e.fit],t[e.shape],e.root.className)})(n),(0,tr.$e)("useImageStyles_unstable")(n),(e=>((0,Jn.C)(e),(0,Qn.Y)(e.root,{})))(n)}));Ld.displayName="Image";var Rd=n(1047),Fd=n(89845);const Md=e=>{const t=_t.useRef((()=>{throw new Error("Cannot call an event handler while rendering")}));return(0,Fd.E)((()=>{t.current=e}),[e]),_t.useCallback(((...e)=>(0,t.current)(...e)),[t])};function Bd(e,t){const{disabled:n,disabledFocusable:r=!1,"aria-disabled":o,onClick:i,onKeyDown:a,onKeyUp:s,...l}=null!=t?t:{},c="string"==typeof o?"true"===o:o,u=n||r||c,d=Md((e=>{u?(e.preventDefault(),e.stopPropagation()):null==i||i(e)})),p=Md((e=>{if(null==a||a(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===Rd.xyI||t===Rd.$xS))return e.preventDefault(),void e.stopPropagation();t!==Rd.$xS?t===Rd.xyI&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()})),f=Md((e=>{if(null==s||s(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===Rd.xyI||t===Rd.$xS))return e.preventDefault(),void e.stopPropagation();t===Rd.$xS&&(e.preventDefault(),e.currentTarget.click())}));if("button"===e||void 0===e)return{...l,disabled:n&&!r,"aria-disabled":!!r||c,onClick:r?void 0:d,onKeyUp:r?void 0:s,onKeyDown:r?void 0:a};{const t=!!l.href;let o=t?void 0:"button";!o&&u&&(o="link");const i={role:o,tabIndex:r||!t&&!n?0:void 0,...l,onClick:d,onKeyUp:f,onKeyDown:p,"aria-disabled":u};return"a"===e&&u&&(i.href=void 0),i}}const Ud=_t.createContext(void 0),zd={},Hd=(Ud.Provider,(e,t)=>{const{size:n}=null!==(r=_t.useContext(Ud))&&void 0!==r?r:zd;var r;const{appearance:o="secondary",as:i="button",disabled:a=!1,disabledFocusable:s=!1,icon:l,iconPosition:c="before",shape:u="rounded",size:d=(null!=n?n:"medium")}=e,p=Gn.lq(l,{elementType:"span"});return{appearance:o,disabled:a,disabledFocusable:s,iconPosition:c,shape:u,size:d,iconOnly:Boolean((null==p?void 0:p.children)&&!e.children),components:{root:"button",icon:"span"},root:Gn.Gk((0,Vn.g)(i,Bd(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"===i?"button":void 0}}),icon:p}}),Gd="fui-Button",Vd="fui-Button__icon",jd=(0,ar.y)("r1alrhcs",null,{r:[".r1alrhcs{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1alrhcs:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1alrhcs:hover:active{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1alrhcs[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1alrhcs{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1alrhcs:focus{border-color:ButtonText;}.r1alrhcs:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1alrhcs:hover:active{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1alrhcs[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),qd=(0,ar.y)("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]),Wd=(0,Xn.X)({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",iro3zm:"fwiml72"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",iro3zm:"fnp9lpt",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1d6v5y2",Bsw6fvg:"f1rirnrt",Bjwas2f:"f1uu00uk",Bn1d65q:["fkvaka8","f9a0qzu"],Bxeuatn:"f1ux7til",n51gp8:["f9a0qzu","fkvaka8"],Bbusuzp:"f1lkg8j3",ycbfsm:"fkc42ay",Bqrx1nm:"fq7113v",pgvf35:"ff1wgvm",Bh7lczh:["fiob0tu","f1x4h75k"],dpv3f4:"f1j6scgf",Bpnjhaq:["f1x4h75k","fiob0tu"],ze5xyy:"f4xjyn1",g2kj27:"fbgcvur",Bf756sw:"f1ks1yx8",Bow2dr7:["f1o6qegi","fmxjhhp"],Bvhedfk:"fcnxywj",Gye4lf:["fmxjhhp","f1o6qegi"],pc6evw:"f9ddjv3"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",iro3zm:"fsv2rcd",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1omzyqd",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",x3br3k:"fj8yq94",ze5xyy:"f4xjyn1",Bx3q9su:"f1et0tmh",pc6evw:"f9ddjv3",xd2cci:"f1wi8ngl"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",iro3zm:"fwiml72",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1fg1p5m",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",Bqrx1nm:"f1tme0vf",ze5xyy:"f4xjyn1",g2kj27:"f18onu3q",pc6evw:"f9ddjv3"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fwiml72:hover:active{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".fnp9lpt:hover:active{background-color:var(--colorBrandBackgroundPressed);}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}",".f1d6v5y2:hover:active{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".fsv2rcd:hover:active{background-color:var(--colorSubtleBackgroundPressed);}",".f1omzyqd:hover:active{color:var(--colorNeutralForeground2Pressed);}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}",".fj8yq94:hover:active .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1fg1p5m:hover:active{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1rirnrt{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1uu00uk{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9a0qzu{border-left-color:HighlightText;}.fkvaka8{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ux7til{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lkg8j3{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkc42ay{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fq7113v:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff1wgvm:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1x4h75k:hover{border-left-color:Highlight;}.fiob0tu:hover{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1j6scgf:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbgcvur:hover:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ks1yx8:hover:active{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o6qegi:hover:active{border-right-color:Highlight;}.fmxjhhp:hover:active{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcnxywj:hover:active{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9ddjv3:hover:active{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1et0tmh:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wi8ngl:hover:active .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tme0vf:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18onu3q:hover:active{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),Yd=(0,Xn.X)({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",iro3zm:"f1t6o4dc",b661bw:"f10ztigi",Bk6r4ia:["f1ft5sdu","f1gzf82w"],B9zn80p:"f12zbtn2",Bpld233:["f1gzf82w","f1ft5sdu"],B2d53fq:"fcvwxyo",c3iz72:"f8w4c43",em6i61:"f1ol4fw6",vm6p8p:"f1q1lw4e",x3br3k:"f1dwjv2g"},highContrast:{Bsw6fvg:"f4lkoma",Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bbusuzp:"f1dcs8yz",G867l3:"fjwq6ea",gdbnj:["f1lr3nhc","f1mbxvi6"],mxns5l:"fn5gmvv",o3nasb:["f1mbxvi6","f1lr3nhc"],Bqrx1nm:"f1vmkb5g",pgvf35:"f53ppgq",Bh7lczh:["f1663y11","f80fkiy"],dpv3f4:"f18v5270",Bpnjhaq:["f80fkiy","f1663y11"],ze5xyy:"f1kc2mi9",g2kj27:"f1y0svfh",Bf756sw:"fihuait",Bow2dr7:["fnxhupq","fyd6l6x"],Bvhedfk:"fx507ft",Gye4lf:["fyd6l6x","fnxhupq"],pc6evw:"fb3rf2x"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",iro3zm:"f3h1zc4"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1t6o4dc:hover:active{background-color:var(--colorNeutralBackgroundDisabled);}",".f10ztigi:hover:active{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ft5sdu:hover:active{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1gzf82w:hover:active{border-left-color:var(--colorNeutralStrokeDisabled);}",".f12zbtn2:hover:active{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f8w4c43:hover:active{cursor:not-allowed;}",".f1ol4fw6:hover:active .fui-Icon-filled{display:none;}",".f1q1lw4e:hover:active .fui-Icon-regular{display:inline;}",".f1dwjv2g:hover:active .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f3h1zc4:hover:active{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f4lkoma{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjwq6ea:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lr3nhc:focus{border-right-color:GrayText;}.f1mbxvi6:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn5gmvv:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1vmkb5g:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f53ppgq:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1663y11:hover{border-right-color:GrayText;}.f80fkiy:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18v5270:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1y0svfh:hover:active{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fihuait:hover:active{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fnxhupq:hover:active{border-right-color:GrayText;}.fyd6l6x:hover:active{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fx507ft:hover:active{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fb3rf2x:hover:active{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),Qd=(0,Xn.X)({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Boium3a:["f12k37oa","fdnykm2"],tm8e47:"fr96u23"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f12k37oa[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fdnykm2[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.fr96u23[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),Jd=(0,Xn.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),Xd=(0,Xn.X)({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]}),Kd=_t.forwardRef(((e,t)=>{const n=Hd(e,t);return(e=>{const t=jd(),n=qd(),r=Wd(),o=Yd(),i=Qd(),a=Jd(),s=Xd(),{appearance:l,disabled:c,disabledFocusable:u,icon:d,iconOnly:p,iconPosition:f,shape:h,size:g}=e;e.root.className=(0,Kn.z)(Gd,t,l&&r[l],r[g],d&&"small"===g&&r.smallWithIcon,d&&"large"===g&&r.largeWithIcon,r[h],(c||u)&&o.base,(c||u)&&o.highContrast,l&&(c||u)&&o[l],"primary"===l&&i.primary,i[g],i[h],p&&a[g],e.root.className),e.icon&&(e.icon.className=(0,Kn.z)(Vd,n,!!e.root.children&&s[f],s[g],e.icon.className))})(n),(0,tr.$e)("useButtonStyles_unstable")(n),(e=>{(0,Jn.C)(e);const{iconOnly:t,iconPosition:n}=e;return(0,Qn.FD)(e.root,{children:["after"!==n&&e.icon&&(0,Qn.Y)(e.icon,{}),!t&&e.root.children,"after"===n&&e.icon&&(0,Qn.Y)(e.icon,{})]})})(n)}));Kd.displayName="Button";var Zd={rootStack:(0,i._)({textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},Yl.Pt.gap("12px"),Yl.Pt.padding("0px","0px","10px","0px"))},$d=(0,On.n)(Zd),ep=function(e,t){var n=$d();return{SketchCard:function(o){var i=(0,s._)(_t.useState(0),2),a=i[0],l=i[1],u=function(){var t=(0,r._)((function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,e(o.images[a],o.altText[a])];case 1:return t.sent(),[2]}}))}));return function(){return t.apply(this,arguments)}}(),d=function(){var e=(0,r._)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,t()];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}();return _t.useEffect((function(){o.isRehydration||d()}),[o.isRehydration]),_t.createElement(Os.W,{style:n.rootStack},o.images&&o.images.map((function(e,t){return _t.createElement(Ld,{src:e,key:t,alt:o.altText[t],shape:"rounded",onClick:function(){!function(e){l(e)}(t)},shadow:a===t&&o.images.length>1,"aria-selected":a===t,tabIndex:0})})),_t.createElement(Os.W,{horizontal:!0},_t.createElement(Kd,{size:"small",onClick:u,icon:_t.createElement(Xa.rz9,null),tabIndex:0},"Insert")))}}},tp=n(94757);const np=()=>{},rp={controller:{active:np,blur:np,find:np,first:np,focus:np,focusLastActive:np,scrollActiveIntoView:np,last:np,next:np,prev:np,showAttributes:np,hideAttributes:np,showFocusVisibleAttributes:np,hideFocusVisibleAttributes:np}},op=_t.createContext(void 0),ip=op.Provider,ap=()=>{var e;return null!==(e=_t.useContext(op))&&void 0!==e?e:rp};var sp=n(40847);const lp=e=>{const t=_t.createContext({value:{current:e},version:{current:-1},listeners:[]});var n;return t.Provider=(n=t.Provider,e=>{const t=_t.useRef(e.value),r=_t.useRef(0),o=_t.useRef();return o.current||(o.current={value:t,version:r,listeners:[]}),(0,Fd.E)((()=>{t.current=e.value,r.current+=1,(0,sp.unstable_runWithPriority)(sp.unstable_NormalPriority,(()=>{o.current.listeners.forEach((t=>{t([r.current,e.value])}))}))}),[e.value]),_t.createElement(n,{value:o.current},e.children)}),delete t.Consumer,t},cp={activeOption:void 0,focusVisible:!1,multiselect:!1,getOptionById(){},getOptionsMatchingValue:()=>[],registerOption:()=>()=>{},selectedOptions:[],onOptionClick(){},onActiveDescendantChange(){},selectOption(){},setActiveOption(){}},up=lp(void 0),dp=e=>((e,t)=>{const n=_t.useContext(e),{value:{current:r},version:{current:o},listeners:i}=n,a=t(r),[s,l]=_t.useState([r,a]),c=e=>{l((n=>{if(!e)return[r,a];if(e[0]<=o)return Object.is(n[1],a)?n:[r,a];try{if(Object.is(n[0],e[1]))return n;const r=t(e[1]);return Object.is(n[1],r)?n:[e[1],r]}catch(e){}return[n[0],n[1]]}))};Object.is(s[1],a)||c(void 0);const u=Md(c);return(0,Fd.E)((()=>(i.push(u),()=>{const e=i.indexOf(u);i.splice(e,1)})),[u,i]),s[1]})(up,((t=cp)=>e(t))),pp=up.Provider;var fp=n(58651);const hp=(e,t)=>{const{children:n,disabled:r,text:o,value:i}=e,a=_t.useRef(null),s=function(e,t){if(void 0!==e)return e;let n="",r=!1;return _t.Children.forEach(t,(e=>{"string"==typeof e?n+=e:r=!0})),r&&fp.warn("Provide a `text` prop to Option components when they contain non-string children."),n}(o,n),l=null!=i?i:s,c=(0,Hn.Bi)("fluent-option",e.id),u=_t.useMemo((()=>({id:c,disabled:r,text:s,value:l})),[c,r,s,l]),{controller:d}=ap(),p=dp((e=>e.multiselect)),f=dp((e=>e.registerOption)),h=dp((e=>{const t=e.selectedOptions;return void 0!==l&&void 0!==t.find((e=>e===l))})),g=dp((e=>e.selectOption)),m=dp((e=>e.onOptionClick));let y=_t.createElement(Pl._jO,null);p&&(y=h?_t.createElement(Ss.jvo,null):"");_t.useEffect((()=>{if(c&&a.current)return f(u,a.current)}),[c,u,f]);const v=p?{role:"menuitemcheckbox","aria-checked":h}:{role:"option","aria-selected":h};return{components:{root:"div",checkIcon:"span"},root:Gn.Gk((0,Vn.g)("div",{ref:(0,tp.a)(t,a),"aria-disabled":r?"true":void 0,id:c,...v,...e,onClick:t=>{var n;r?t.preventDefault():(d.focus(c),g(t,u),m(t),null===(n=e.onClick)||void 0===n||n.call(e,t))}}),{elementType:"div"}),checkIcon:Gn.lq(e.checkIcon,{renderByDefault:!0,defaultProps:{"aria-hidden":"true",children:y},elementType:"span"}),disabled:r,multiselect:p,selected:h,focusVisible:!1,active:!1}},gp="fui-Option",mp="fui-Option__checkIcon",yp=(0,Xn.X)({root:{Bt984gj:"f122n59",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",sj55zd:"f19n0e5",i8kkvl:"f1ufnopg",Bceei9c:"f1k6fduh",mc9l5x:"f22iagw",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fm5eomj",qhf8xq:"f10pi13n",Jwef8y:"f1knas48",Bi91k9c:"feu1g3u",zqbkvg:"fo79ri9",h82x05:["f1osiabc","f1e8le25"],cqj998:"f1yusjty",j3hlsh:["f1e8le25","f1osiabc"],ecr2s2:"fb40n2d",lj723h:"f1g4hkjv",Btxx2vb:"f1lnr2zp",sltcwy:["f1ogfk9z","f1g7j8ec"],dnwvvm:"fiuf46r",Blyvkvs:["f1g7j8ec","f1ogfk9z"]},active:{Bowz1zl:"f11vrvdw",oxogb1:"f17hxjb7",Ix2sn8:"f1dha69c",q7v32p:"f1lm7500",B7cbj04:0,Bewtojm:0,b50fsz:0,B1wzb3v:0,Bqwk70n:0,B37u8z8:0,avt0cx:0,f0sref:0,B9fkznv:0,Be3o27t:0,Bertapg:0,B53xpsf:0,Bsv72rj:0,B39dzdd:0,Btq9bd3:0,Bqfxd14:0,atup0s:"fo7xqb",Fffuxt:0,Bttcd12:0,Beitzug:0,Bqougee:0,B86i8pi:"f1kurthe",Bhijsxg:"fwq15dy",kktds4:"f1pb3wry",Bmau3bo:["ftjv2f4","f1flhb1f"],npektv:["f1flhb1f","ftjv2f4"]},disabled:{sj55zd:"f1s2aq7o",Jwef8y:"f9ql6rf",Bi91k9c:"fvgxktp",zqbkvg:"f185j3qj",h82x05:["f1dligi3","f1vydzie"],cqj998:"fjw1di3",j3hlsh:["f1vydzie","f1dligi3"],ecr2s2:"fgj9um3",lj723h:"f19wldhg",Btxx2vb:"f1ss0kt2",sltcwy:["f1t6oli3","fjy9ci8"],dnwvvm:"fresaxk",Blyvkvs:["fjy9ci8","f1t6oli3"],Bbusuzp:"f1dcs8yz"},selected:{},checkIcon:{Bnnss6s:"fi64zpg",Be2twd7:"fod5ikn",Frg6f3:["f18b9hdq","fn6qj8t"],t21cq0:["f1xk557c","f1h9en5y"],Bcdw1i0:"fd7fpy0",Bo70h7d:"fvc9v3g"},selectedCheck:{Bcdw1i0:"f1022m68"},multiselectCheck:{Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f1l3cf7o",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fq9zq91",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Bt984gj:"f122n59",Brf1p80:"f4d9j23",Bkfmm31:"f1w9h62z",Be2twd7:"f1ugzwwg",Bqenvij:"fd461yt",a9b677:"fjw5fx7",Bcdw1i0:"f1022m68"},selectedMultiselectCheck:{De3pzq:"ftywsgz",sj55zd:"fqpbvvt",g2u3we:"f3xi7mh",h3c5rm:["ftovhe4","f1wczvin"],B9xav0g:"f68vbr6",zhjwy3:["f1wczvin","ftovhe4"]},checkDisabled:{sj55zd:"f1s2aq7o",Bbusuzp:"f1dcs8yz"},multiselectCheckDisabled:{g2u3we:"f1r1t4y1",h3c5rm:["fmj8ijw","figx54m"],B9xav0g:"f360ss8",zhjwy3:["figx54m","fmj8ijw"]}},{d:[".f122n59{align-items:center;}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f19n0e5{color:var(--colorNeutralForeground1);}",".f1ufnopg{column-gap:var(--spacingHorizontalXS);}",".f1k6fduh{cursor:pointer;}",".f22iagw{display:flex;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".fm5eomj{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalS);}",{p:-1}],".f10pi13n{position:relative;}",'.f11vrvdw[data-activedescendant-focusvisible]::after{content:"";}',".f17hxjb7[data-activedescendant-focusvisible]::after{position:absolute;}",".f1dha69c[data-activedescendant-focusvisible]::after{pointer-events:none;}",".f1lm7500[data-activedescendant-focusvisible]::after{z-index:1;}",[".fo7xqb[data-activedescendant-focusvisible]::after{border:2px solid var(--colorStrokeFocus2);}",{p:-2}],[".f1kurthe[data-activedescendant-focusvisible]::after{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fwq15dy[data-activedescendant-focusvisible]::after{top:-2px;}",".f1pb3wry[data-activedescendant-focusvisible]::after{bottom:-2px;}",".ftjv2f4[data-activedescendant-focusvisible]::after{left:-2px;}",".f1flhb1f[data-activedescendant-focusvisible]::after{right:-2px;}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fi64zpg{flex-shrink:0;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".f18b9hdq{margin-left:calc(var(--spacingHorizontalXXS) * -1);}",".fn6qj8t{margin-right:calc(var(--spacingHorizontalXXS) * -1);}",".f1xk557c{margin-right:var(--spacingHorizontalXXS);}",".f1h9en5y{margin-left:var(--spacingHorizontalXXS);}",".fd7fpy0{visibility:hidden;}",".fvc9v3g svg{display:block;}",".f1022m68{visibility:visible;}",[".f1l3cf7o{border:var(--strokeWidthThin) solid var(--colorNeutralStrokeAccessible);}",{p:-2}],[".fq9zq91{border-radius:var(--borderRadiusSmall);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".f4d9j23{justify-content:center;}",".f1w9h62z{fill:currentColor;}",".f1ugzwwg{font-size:12px;}",".fd461yt{height:16px;}",".fjw5fx7{width:16px;}",".ftywsgz{background-color:var(--colorCompoundBrandBackground);}",".fqpbvvt{color:var(--colorNeutralForegroundInverted);}",".f3xi7mh{border-top-color:var(--colorCompoundBrandBackground);}",".ftovhe4{border-right-color:var(--colorCompoundBrandBackground);}",".f1wczvin{border-left-color:var(--colorCompoundBrandBackground);}",".f68vbr6{border-bottom-color:var(--colorCompoundBrandBackground);}",".f1r1t4y1{border-top-color:var(--colorNeutralForegroundDisabled);}",".fmj8ijw{border-right-color:var(--colorNeutralForegroundDisabled);}",".figx54m{border-left-color:var(--colorNeutralForegroundDisabled);}",".f360ss8{border-bottom-color:var(--colorNeutralForegroundDisabled);}"],h:[".f1knas48:hover{background-color:var(--colorNeutralBackground1Hover);}",".feu1g3u:hover{color:var(--colorNeutralForeground1Hover);}",".fo79ri9:hover .fui-Option__checkIcon{border-top-color:var(--colorNeutralForeground1Hover);}",".f1osiabc:hover .fui-Option__checkIcon{border-right-color:var(--colorNeutralForeground1Hover);}",".f1e8le25:hover .fui-Option__checkIcon{border-left-color:var(--colorNeutralForeground1Hover);}",".f1yusjty:hover .fui-Option__checkIcon{border-bottom-color:var(--colorNeutralForeground1Hover);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f185j3qj:hover .fui-Option__checkIcon{border-top-color:var(--colorNeutralForegroundDisabled);}",".f1dligi3:hover .fui-Option__checkIcon{border-right-color:var(--colorNeutralForegroundDisabled);}",".f1vydzie:hover .fui-Option__checkIcon{border-left-color:var(--colorNeutralForegroundDisabled);}",".fjw1di3:hover .fui-Option__checkIcon{border-bottom-color:var(--colorNeutralForegroundDisabled);}"],a:[".fb40n2d:active{background-color:var(--colorNeutralBackground1Pressed);}",".f1g4hkjv:active{color:var(--colorNeutralForeground1Pressed);}",".f1lnr2zp:active .fui-Option__checkIcon{border-top-color:var(--colorNeutralForeground1Hover);}",".f1ogfk9z:active .fui-Option__checkIcon{border-right-color:var(--colorNeutralForeground1Hover);}",".f1g7j8ec:active .fui-Option__checkIcon{border-left-color:var(--colorNeutralForeground1Hover);}",".fiuf46r:active .fui-Option__checkIcon{border-bottom-color:var(--colorNeutralForeground1Hover);}",".fgj9um3:active{background-color:var(--colorTransparentBackground);}",".f19wldhg:active{color:var(--colorNeutralForegroundDisabled);}",".f1ss0kt2:active .fui-Option__checkIcon{border-top-color:var(--colorNeutralForegroundDisabled);}",".f1t6oli3:active .fui-Option__checkIcon{border-right-color:var(--colorNeutralForegroundDisabled);}",".fjy9ci8:active .fui-Option__checkIcon{border-left-color:var(--colorNeutralForegroundDisabled);}",".fresaxk:active .fui-Option__checkIcon{border-bottom-color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),vp=_t.forwardRef(((e,t)=>{const n=hp(e,t);return(e=>{const{disabled:t,multiselect:n,selected:r}=e,o=yp();e.root.className=(0,Kn.z)(gp,o.root,o.active,t&&o.disabled,r&&o.selected,e.root.className),e.checkIcon&&(e.checkIcon.className=(0,Kn.z)(mp,o.checkIcon,n&&o.multiselectCheck,r&&o.selectedCheck,r&&n&&o.selectedMultiselectCheck,t&&o.checkDisabled,t&&n&&o.multiselectCheckDisabled,e.checkIcon.className))})(n),(0,tr.$e)("useOptionStyles_unstable")(n),(e=>((0,Jn.C)(e),(0,Qn.FD)(e.root,{children:[e.checkIcon&&(0,Qn.Y)(e.checkIcon,{}),e.root.children]})))(n)}));function Sp(e,t){return""===t||e.toLowerCase().includes(t.toLowerCase())}function Cp(e){return"string"==typeof e?e:e.value}vp.displayName="Option";const bp=_t.createContext(void 0);bp.Provider;var Ep=n(40826),Tp=n(44515);function wp(e){switch(e){case"info":return _t.createElement(Ep.N_H,null);case"warning":return _t.createElement(Tp.BFW,null);case"error":return _t.createElement(Pl.Tox,null);case"success":return _t.createElement(Pl.gcm,null);default:return null}}var Ip=n(72282);const Pp=_t.createContext(void 0),_p={className:"",nodeRef:_t.createRef()},Ap=(Pp.Provider,(e,t)=>{const{layout:n="auto",intent:r="info",politeness:o,shape:i="rounded"}=e,a=(null!=o?o:"info"===r)?"polite":"assertive",s="auto"===n,{ref:l,reflowing:c}=function(e=!1){const{targetDocument:t}=(0,jn.Y)(),n=_t.useReducer((()=>({})),{})[1],r=_t.useRef(!1),o=_t.useRef(null),i=_t.useRef(-1),a=_t.useCallback((e=>{var t,o;const a=e[0];var s;const l=null!==(s=null==a||null===(o=a.borderBoxSize)||void 0===o||null===(t=o[0])||void 0===t?void 0:t.inlineSize)&&void 0!==s?s:null==a?void 0:a.target.getBoundingClientRect().width;if(void 0===l||!a)return;const{target:c}=a;if(!(0,Ip.s)(c))return;let u;r.current?i.current<l&&(u=!1):l<c.scrollWidth&&(u=!0),i.current=l,void 0!==u&&r.current!==u&&(r.current=u,n())}),[n]),s=_t.useCallback((n=>{var r;if(!e||!n||!(null==t?void 0:t.defaultView))return;null===(r=o.current)||void 0===r||r.disconnect();const i=new t.defaultView.ResizeObserver(a);o.current=i,i.observe(n,{box:"border-box"})}),[t,a,e]);return _t.useEffect((()=>()=>{var e;null===(e=o.current)||void 0===e||e.disconnect()}),[]),{ref:s,reflowing:r.current}}(s),u=s?c?"multiline":"singleline":n,{className:d,nodeRef:p}=null!==(f=_t.useContext(Pp))&&void 0!==f?f:_p;var f;const h=_t.useRef(null),g=_t.useRef(null),{announce:m}=function(){var e;return null!==(e=_t.useContext(bp))&&void 0!==e?e:{announce:()=>{}}}(),y=(0,Hn.Bi)();return _t.useEffect((()=>{var e,t;const n=[null===(e=g.current)||void 0===e?void 0:e.textContent,null===(t=h.current)||void 0===t?void 0:t.textContent].filter(Boolean).join(",");m(n,{polite:"polite"===a,alert:"assertive"===a})}),[g,h,m,a]),{components:{root:"div",icon:"div",bottomReflowSpacer:"div"},root:Gn.Gk((0,Vn.g)("div",{ref:(0,tp.a)(t,l,p),role:"group","aria-labelledby":y,...e}),{elementType:"div"}),icon:Gn.lq(e.icon,{renderByDefault:!0,elementType:"div",defaultProps:{children:wp(r)}}),bottomReflowSpacer:Gn.lq(e.bottomReflowSpacer,{renderByDefault:"multiline"===u,elementType:"div"}),layout:u,intent:r,transitionClassName:d,actionsRef:h,bodyRef:g,titleId:y,shape:i}}),kp=_t.createContext(void 0),xp={titleId:"",layout:"singleline",actionsRef:_t.createRef(),bodyRef:_t.createRef()},Np=kp.Provider,Op="fui-MessageBar",Dp="fui-MessageBar__icon",Lp="fui-MessageBar__bottomReflowSpacer",Rp=(0,ar.y)("r2oyxsj","r1wuyrhw",['.r2oyxsj{white-space:nowrap;display:grid;grid-template-columns:auto 1fr auto auto;grid-template-rows:1fr;grid-template-areas:"icon body secondaryActions actions";padding-left:var(--spacingHorizontalM);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);align-items:center;min-height:36px;box-sizing:border-box;background-color:var(--colorNeutralBackground3);}','.r1wuyrhw{white-space:nowrap;display:grid;grid-template-columns:auto 1fr auto auto;grid-template-rows:1fr;grid-template-areas:"icon body secondaryActions actions";padding-right:var(--spacingHorizontalM);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);align-items:center;min-height:36px;box-sizing:border-box;background-color:var(--colorNeutralBackground3);}']),Fp=(0,ar.y)("r1df1z33","rivnfjc",[".r1df1z33{grid-area:icon;font-size:var(--fontSizeBase500);margin-right:var(--spacingHorizontalS);color:var(--colorNeutralForeground3);display:flex;align-items:center;}",".rivnfjc{grid-area:icon;font-size:var(--fontSizeBase500);margin-left:var(--spacingHorizontalS);color:var(--colorNeutralForeground3);display:flex;align-items:center;}"]),Mp=(0,ar.y)("r1vx593n",null,[".r1vx593n{margin-bottom:var(--spacingVerticalS);grid-area:secondaryActions;}"]),Bp=(0,Xn.X)({rootMultiline:{Huce71:"f6juhto",Bt984gj:"f1s2louj",z8tnut:"f1ngh7ph",Budl1dq:"f17g0uqy",zoa1oz:"f1w7oly7"},secondaryActionsMultiline:{Brf1p80:"f1e8xxv9",B6of3ja:"f1gaxbfw",jrapky:"fqcjy3b",t21cq0:["fibjyge","f9yszdx"]},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779"}},{d:[".f6juhto{white-space:normal;}",".f1s2louj{align-items:start;}",".f1ngh7ph{padding-top:var(--spacingVerticalMNudge);}",".f17g0uqy{grid-template-columns:auto 1fr auto;}",'.f1w7oly7{grid-template-areas:"icon body actions" "secondaryActions secondaryActions secondaryActions";}',".f1e8xxv9{justify-content:end;}",".f1gaxbfw{margin-top:var(--spacingVerticalMNudge);}",".fqcjy3b{margin-bottom:var(--spacingVerticalS);}",".fibjyge{margin-right:0px;}",".f9yszdx{margin-left:0px;}",[".fokr779{border-radius:0;}",{p:-1}]]}),Up=(0,Xn.X)({info:{},error:{sj55zd:"f1ca9wz"},warning:{sj55zd:"f14a4cve"},success:{sj55zd:"f36rra6"}},{d:[".f1ca9wz{color:var(--colorStatusDangerForeground1);}",".f14a4cve{color:var(--colorStatusWarningForeground3);}",".f36rra6{color:var(--colorStatusSuccessForeground1);}"]}),zp=(0,Xn.X)({info:{},error:{De3pzq:"f1eon7jj",g2u3we:"f1f8dvr7",h3c5rm:["f1g1ijmo","f1nxacbt"],B9xav0g:"fo25q1j",zhjwy3:["f1nxacbt","f1g1ijmo"]},warning:{De3pzq:"f13ftzij",g2u3we:"frd1ypx",h3c5rm:["f1gyjrma","f18qd5xz"],B9xav0g:"fqyqtrt",zhjwy3:["f18qd5xz","f1gyjrma"]},success:{De3pzq:"f64thcm",g2u3we:"f1b4u7v",h3c5rm:["f1nyd2b1","f70v3om"],B9xav0g:"fk173vo",zhjwy3:["f70v3om","f1nyd2b1"]}},{d:[".f1eon7jj{background-color:var(--colorStatusDangerBackground1);}",".f1f8dvr7{border-top-color:var(--colorStatusDangerBorder1);}",".f1g1ijmo{border-right-color:var(--colorStatusDangerBorder1);}",".f1nxacbt{border-left-color:var(--colorStatusDangerBorder1);}",".fo25q1j{border-bottom-color:var(--colorStatusDangerBorder1);}",".f13ftzij{background-color:var(--colorStatusWarningBackground1);}",".frd1ypx{border-top-color:var(--colorStatusWarningBorder1);}",".f1gyjrma{border-right-color:var(--colorStatusWarningBorder1);}",".f18qd5xz{border-left-color:var(--colorStatusWarningBorder1);}",".fqyqtrt{border-bottom-color:var(--colorStatusWarningBorder1);}",".f64thcm{background-color:var(--colorStatusSuccessBackground1);}",".f1b4u7v{border-top-color:var(--colorStatusSuccessBorder1);}",".f1nyd2b1{border-right-color:var(--colorStatusSuccessBorder1);}",".f70v3om{border-left-color:var(--colorStatusSuccessBorder1);}",".fk173vo{border-bottom-color:var(--colorStatusSuccessBorder1);}"]});const Hp=_t.forwardRef(((e,t)=>{const n=Ap(e,t);return(e=>{const t=Rp(),n=Fp(),r=Up(),o=zp(),i=Mp(),a=Bp();e.root.className=(0,Kn.z)(Op,t,"multiline"===e.layout&&a.rootMultiline,"square"===e.shape&&a.square,o[e.intent],e.transitionClassName,e.root.className),e.icon&&(e.icon.className=(0,Kn.z)(Dp,n,r[e.intent],e.icon.className)),e.bottomReflowSpacer&&(e.bottomReflowSpacer.className=(0,Kn.z)(Lp,i))})(n),(0,tr.$e)("useMessageBarStyles_unstable")(n),((e,t)=>((0,Jn.C)(e),(0,Qn.Y)(Np,{value:t.messageBar,children:(0,Qn.FD)(e.root,{children:[e.icon&&(0,Qn.Y)(e.icon,{}),e.root.children,e.bottomReflowSpacer&&(0,Qn.Y)(e.bottomReflowSpacer,{})]})})))(n,function(e){const{layout:t,actionsRef:n,bodyRef:r,titleId:o}=e;return{messageBar:_t.useMemo((()=>({layout:t,actionsRef:n,bodyRef:r,titleId:o})),[t,n,r,o])}}(n))}));Hp.displayName="MessageBar";const Gp=(e,t)=>{const{bodyRef:n}=null!==(r=_t.useContext(kp))&&void 0!==r?r:xp;var r;return{components:{root:"div"},root:Gn.Gk((0,Vn.g)("div",{ref:(0,tp.a)(t,n),...e}),{elementType:"div"})}},Vp=_t.createContext(void 0),jp=Vp.Provider,qp="fui-MessageBarBody",Wp=(0,ar.y)("rtatq2b","re2rary",[".rtatq2b{font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);grid-area:body;padding-right:var(--spacingHorizontalM);}",".re2rary{font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);grid-area:body;padding-left:var(--spacingHorizontalM);}"]);const Yp=_t.forwardRef(((e,t)=>{const n=Gp(e,t),r={link:_t.useMemo((()=>({inline:!0})),[])};return(e=>{const t=Wp();e.root.className=(0,Kn.z)(qp,t,e.root.className)})(n),(0,tr.$e)("useMessageBarBodyStyles_unstable")(n),((e,t)=>((0,Jn.C)(e),(0,Qn.Y)(jp,{value:t.link,children:(0,Qn.Y)(e.root,{})})))(n,r)}));Yp.displayName="MessageBarBody";var Qp=n(56256);function Jp(){const{targetDocument:e}=(0,jn.Y)(),t=_t.useRef(null);return _t.useEffect((()=>{if(e){const n=(0,Qp.SQ)(e.defaultView);return t.current=n,()=>{(0,Qp.bd)(n),t.current=null}}}),[e]),t}function Xp(e){const t=Jp(),n=Md(e);_t.useEffect((()=>{const e=t.current;if(e){const t=e=>{n(e)};return e.subscribe(t),t(e.isNavigatingWithKeyboard()),()=>{e.unsubscribe(t)}}}),[t,n])}const Kp="data-activedescendant",Zp="data-activedescendant-focusvisible",$p=e=>{if(!e)return;const t=ef(e.parentElement);if(!t)return;const{offsetHeight:n}=e,r=tf(e,t),{scrollMarginTop:o,scrollMarginBottom:i}=nf(e),{offsetHeight:a,scrollTop:s}=t,l=r+n+i>s+a;r-o<s?t.scrollTo(0,r-o-2):l&&t.scrollTo(0,r+n+i-a+2)},ef=e=>e?e.scrollHeight>e.offsetHeight?e:ef(e.parentElement):null,tf=(e,t)=>e&&e!==t?e.contains(t)?-1*t.offsetTop:e.offsetTop+tf(e.offsetParent,t):0,nf=e=>{var t;const n=null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView;if(!n)return{scrollMarginTop:0,scrollMarginBottom:0};const r=n.getComputedStyle(e);var o;var i;return{scrollMarginTop:null!==(o=rf(r.scrollMarginTop))&&void 0!==o?o:rf(r.scrollMarginBlockStart),scrollMarginBottom:null!==(i=rf(r.scrollMarginBottom))&&void 0!==i?i:rf(r.scrollMarginBlockEnd)}},rf=e=>e?parseInt(e,10):0;function of(e){const{imperativeRef:t,matchOption:n}=e,r=_t.useRef(!1),o=_t.useRef(!0),i=_t.useRef(null),a=_t.useRef(null),s=_t.useRef(null),l=_t.useRef(!0),c=_t.useCallback((()=>{var e;null===(e=s.current)||void 0===e||e.removeAttribute("aria-activedescendant")}),[]),u=_t.useCallback((e=>{var t;(e&&(i.current=e),l.current&&i.current)&&(null===(t=s.current)||void 0===t||t.setAttribute("aria-activedescendant",i.current))}),[]);Xp((e=>{r.current=e;const t=g();t&&(e&&o.current?t.setAttribute(Zp,""):t.removeAttribute(Zp))}));const d=Md(n),p=_t.useRef(null),{optionWalker:f,listboxCallbackRef:h}=function(e){const{matchOption:t}=e,{targetDocument:n}=(0,jn.Y)(),r=_t.useRef(null),o=_t.useRef(null),i=_t.useCallback((e=>(0,Ip.s)(e)&&t(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),[t]),a=_t.useCallback((e=>{e&&n?(o.current=e,r.current=n.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,i)):o.current=null}),[n,i]);return{optionWalker:_t.useMemo((()=>({first:()=>r.current&&o.current?(r.current.currentNode=o.current,r.current.firstChild()):null,last:()=>r.current&&o.current?(r.current.currentNode=o.current,r.current.lastChild()):null,next:()=>r.current?r.current.nextNode():null,prev:()=>r.current?r.current.previousNode():null,find:(e,t)=>{if(!r.current||!o.current)return null;const i=t?null==n?void 0:n.getElementById(t):null;r.current.currentNode=null!=i?i:o.current;let a=r.current.currentNode;for(;a&&!e(a.id);)a=r.current.nextNode();return a},setCurrent:e=>{r.current&&(r.current.currentNode=e)}})),[n]),listboxCallbackRef:a}}({matchOption:d}),g=_t.useCallback((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.querySelector(`#${i.current}`)}),[p]),m=_t.useCallback((e=>{o.current=e;const t=g();t&&(e&&r.current?t.setAttribute(Zp,""):t.removeAttribute(Zp))}),[g]),y=_t.useCallback((()=>{const e=g();var t;return e&&(e.removeAttribute(Kp),e.removeAttribute(Zp)),c(),a.current=i.current,i.current=null,null!==(t=null==e?void 0:e.id)&&void 0!==t?t:null}),[g,c]),v=_t.useCallback((e=>{if(!e)return;const t=y();$p(e),u(e.id),e.setAttribute(Kp,""),r.current&&o.current&&e.setAttribute(Zp,"");const n=(i={id:e.id,previousId:t},new CustomEvent("activedescendantchange",{bubbles:!0,cancelable:!1,composed:!0,detail:i}));var i;e.dispatchEvent(n)}),[y,u]),S=_t.useMemo((()=>({first:({passive:e}={})=>{const t=f.first();return e||v(t),null==t?void 0:t.id},last:({passive:e}={})=>{const t=f.last();return e||v(t),null==t?void 0:t.id},next:({passive:e}={})=>{const t=g();if(!t)return;f.setCurrent(t);const n=f.next();return e||v(n),null==n?void 0:n.id},prev:({passive:e}={})=>{const t=g();if(!t)return;f.setCurrent(t);const n=f.prev();return e||v(n),null==n?void 0:n.id},blur:()=>{y()},active:()=>{var e;return null===(e=g())||void 0===e?void 0:e.id},focus:e=>{if(!p.current)return;const t=p.current.querySelector(`#${e}`);t&&v(t)},focusLastActive:()=>{if(!p.current||!a.current)return;const e=p.current.querySelector(`#${a.current}`);return e?(v(e),!0):void 0},find(e,{passive:t,startFrom:n}={}){const r=f.find(e,n);return t||v(r),null==r?void 0:r.id},scrollActiveIntoView:()=>{if(!p.current)return;const e=g();e&&$p(e)},showAttributes(){l.current=!0,u()},hideAttributes(){l.current=!1,c()},showFocusVisibleAttributes(){m(!0)},hideFocusVisibleAttributes(){m(!1)}})),[f,p,u,c,v,y,g,m]);return _t.useImperativeHandle(t,(()=>S)),{listboxRef:(0,tp.a)(p,h),activeParentRef:s,controller:S}}const af=_t.createContext(void 0);af.Provider;function sf(e,t){return function(e,t,n){if(!e)return t;t={...t};const{generatedControlId:r,hintId:o,labelFor:i,labelId:a,required:s,validationMessageId:l,validationState:c}=e;var u,d,p,f,h,g,m,y,v,S;r&&(null!==(d=(u=t).id)&&void 0!==d||(u.id=r));!a||(null==n?void 0:n.supportsLabelFor)&&i===t.id||null!==(h=(p=t)[f="aria-labelledby"])&&void 0!==h||(p[f]=a);(l||o)&&(t["aria-describedby"]=[l,o,null==t?void 0:t["aria-describedby"]].filter(Boolean).join(" "));"error"===c&&(null!==(y=(g=t)[m="aria-invalid"])&&void 0!==y||(g[m]=!0));if(s){var C,b,E,T,w;if(null==n?void 0:n.supportsRequired)null!==(b=(C=t).required)&&void 0!==b||(C.required=!0);else null!==(w=(E=t)[T="aria-required"])&&void 0!==w||(E[T]=!0)}(null==n?void 0:n.supportsSize)&&(null!==(S=(v=t).size)&&void 0!==S||(v.size=e.size));return t}(_t.useContext(af),e,t)}var lf=n(86508);const cf=(e,t)=>!!(null==e?void 0:e.contains(t)),uf=e=>{var t,n,r;if(e)return"object"==typeof e.window&&e.window===e?e.event:null!==(r=null===(n=e.ownerDocument)||void 0===n||null===(t=n.defaultView)||void 0===t?void 0:t.event)&&void 0!==r?r:void 0},df="fuiframefocus",pf=e=>{const{disabled:t,element:n,callback:r,contains:o=cf,pollDuration:i=1e3,refs:a}=e,s=_t.useRef(),l=Md((e=>{a.every((t=>!o(t.current||null,e.target)))&&!t&&r(e)}));_t.useEffect((()=>{if(!t)return null==n||n.addEventListener(df,l,!0),()=>{null==n||n.removeEventListener(df,l,!0)}}),[n,t,l]),_t.useEffect((()=>{var e;if(!t)return s.current=null==n||null===(e=n.defaultView)||void 0===e?void 0:e.setInterval((()=>{const e=null==n?void 0:n.activeElement;if("IFRAME"===(null==e?void 0:e.tagName)||"WEBVIEW"===(null==e?void 0:e.tagName)){const t=new CustomEvent(df,{bubbles:!0});e.dispatchEvent(t)}}),i),()=>{var e;null==n||null===(e=n.defaultView)||void 0===e||e.clearTimeout(s.current)}}),[n,t,i])};function ff(e,t){return(...n)=>{null==e||e(...n),null==t||t(...n)}}var hf=n(94329);const gf=e=>{const[t,n]=_t.useState((()=>void 0===e.defaultState?e.initialState:"function"==typeof e.defaultState?e.defaultState():e.defaultState)),r=_t.useRef(e.state);_t.useEffect((()=>{r.current=e.state}),[e.state]);const o=_t.useCallback((e=>{(function(e){return"function"==typeof e})(e)&&e(r.current)}),[]);return mf(e.state)?[e.state,o]:[t,n]};const mf=e=>{const[t]=_t.useState((()=>void 0!==e));return t},yf=()=>{const e=_t.useRef(new Map),t=_t.useMemo((()=>({getCount:()=>e.current.size,getOptionAtIndex:()=>{},getIndexOfId:()=>-1,getOptionById:t=>e.current.get(t),getOptionsMatchingText:t=>Array.from(e.current.values()).filter((({text:e})=>t(e))),getOptionsMatchingValue:t=>{const n=[];for(const r of e.current.values())t(r.value)&&n.push(r);return n}})),[]),n=_t.useCallback((t=>(e.current.set(t.id,t),()=>e.current.delete(t.id))),[]);return{...t,options:Array.from(e.current.values()),registerOption:n}},vf=e=>{const{defaultSelectedOptions:t,multiselect:n,onOptionSelect:r}=e,[o,i]=gf({state:e.selectedOptions,defaultState:t,initialState:[]});return{clearSelection:e=>{i([]),null==r||r(e,{optionValue:void 0,optionText:void 0,selectedOptions:[]})},selectOption:_t.useCallback(((e,t)=>{if(t.disabled)return;let a=[t.value];if(n){const e=o.findIndex((e=>e===t.value));a=e>-1?[...o.slice(0,e),...o.slice(e+1)]:[...o,t.value]}i(a),null==r||r(e,{optionValue:t.value,optionText:t.text,selectedOptions:a})}),[r,n,o,i]),selectedOptions:o}},Sf=e=>{const{appearance:t="outline",disableAutoFocus:n,children:r,clearable:o=!1,editable:i=!1,inlinePopup:a=!1,mountNode:s,multiselect:l,onOpenChange:c,size:u="medium",activeDescendantController:d,freeform:p=!1,disabled:f=!1,onActiveOptionChange:h=null}=e,g=yf(),{getOptionsMatchingValue:m}=g,{getOptionById:y}=g,v=_t.useCallback((()=>{const e=d.active();return e?y(e):void 0}),[d,y]),S=v(),C=_t.useCallback((e=>{let t;if("function"==typeof e){t=e(v())}t?d.focus(t.id):d.blur()}),[d,v]),[b,E]=_t.useState(!1),[T,w]=_t.useState(!1),I=_t.useRef(!1),P=function(){const e=_t.useRef(!0);return e.current?(e.current=!1,!0):e.current}(),[_,A]=gf({state:e.value,initialState:void 0}),{selectedOptions:k,selectOption:x,clearSelection:N}=vf(e),O=_t.useCallback(((e,t)=>{hf.unstable_batchedUpdates((()=>{A(void 0),x(e,t)}))}),[A,x]),D=_t.useMemo((()=>{if(void 0!==_)return _;if(P&&void 0!==e.defaultValue)return e.defaultValue;const t=m((e=>k.includes(e))).map((e=>e.text));return l?i?"":t.join(", "):t[0]}),[_,i,m,l,k]),[L,R]=gf({state:e.open,defaultState:e.defaultOpen,initialState:!1}),F=_t.useCallback(((e,t)=>{f||(null==c||c(e,{open:t}),hf.unstable_batchedUpdates((()=>{t||p||A(void 0),R(t)})))}),[c,R,A,p,f]);_t.useEffect((()=>{if(L){if(!l&&k.length>0){const e=m((e=>e===k[0])).pop();(null==e?void 0:e.id)&&d.focus(e.id)}}else d.blur()}),[L,d]),_t.useEffect((()=>{!L||n||d.active()||d.first()}),[L,r,n,d,y]);const M=Md((e=>{const t=e.detail.previousId?g.getOptionById(e.detail.previousId):null,n=g.getOptionById(e.detail.id);null==h||h(e,{event:e,type:"change",previousOption:t,nextOption:n})}));return{...g,freeform:p,disabled:f,selectOption:O,clearSelection:N,selectedOptions:k,activeOption:S,appearance:t,clearable:o,focusVisible:b,ignoreNextBlur:I,inlinePopup:a,mountNode:s,open:L,hasFocus:T,setActiveOption:C,setFocusVisible:E,setHasFocus:w,setOpen:F,setValue:A,size:u,value:D,multiselect:l,onOptionClick:Md((e=>{l||F(e,!1)})),onActiveDescendantChange:M}},Cf={above:{position:"above",align:"center"},"above-start":{position:"above",align:"start"},"above-end":{position:"above",align:"end"},below:{position:"below",align:"center"},"below-start":{position:"below",align:"start"},"below-end":{position:"below",align:"end"},before:{position:"before",align:"center"},"before-top":{position:"before",align:"top"},"before-bottom":{position:"before",align:"bottom"},after:{position:"after",align:"center"},"after-top":{position:"after",align:"top"},"after-bottom":{position:"after",align:"bottom"}};function bf(e){return null==e?{}:"string"==typeof e?Cf[e]:e}var Ef=n(83777),Tf=n(95019);function wf(e,t,n){const r=_t.useRef(!0),[o]=_t.useState((()=>({value:e,callback:t,facade:{get current(){return o.value},set current(e){const t=o.value;if(t!==e){if(o.value=e,n&&r.current)return;o.callback(e,t)}}}})));return(0,Fd.E)((()=>{r.current=!1}),[]),o.callback=t,o.facade}const If=e=>{switch(e){case"always":case!0:return{applyMaxWidth:!0,applyMaxHeight:!0};case"width-always":case"width":return{applyMaxWidth:!0,applyMaxHeight:!1};case"height-always":case"height":return{applyMaxWidth:!1,applyMaxHeight:!0};default:return!1}},Pf=e=>{const t=e&&(e=>"HTML"===e.nodeName?e:e.parentNode||e.host)(e);if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:n,overflowX:r,overflowY:o}=(e=>{var t;return 1!==e.nodeType?{}:(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView).getComputedStyle(e,null)})(t);return/(auto|scroll|overlay)/.test(n+o+r)?t:Pf(t)},_f=e=>{var t;const n=Pf(e);return!!n&&n!==(null===(t=n.ownerDocument)||void 0===t?void 0:t.body)},Af=(e,t,n)=>{const r=((e,t)=>{const n="above"===e||"below"===e,r="top"===t||"bottom"===t;return n&&r||!n&&!r})(t,e)?"center":e,o=t&&(e=>({above:"top",below:"bottom",before:e?"right":"left",after:e?"left":"right"}))(n)[t],i=r&&{start:"start",end:"end",top:"start",bottom:"end",center:void 0}[r];return o&&i?`${o}-${i}`:o};function kf(e,t){if("window"===t)return null==e?void 0:e.ownerDocument.documentElement;if("clippingParents"===t)return"clippingAncestors";if("scrollParent"===t){let t=Pf(e);return"BODY"===t.nodeName&&(t=null==e?void 0:e.ownerDocument.documentElement),t}return t}const xf=e=>({name:"resetMaxSize",fn({middlewareData:t,elements:n}){var r;if(null===(r=t.resetMaxSize)||void 0===r?void 0:r.maxSizeAlreadyReset)return{};const{applyMaxWidth:o,applyMaxHeight:i}=e;return o&&(n.floating.style.removeProperty("box-sizing"),n.floating.style.removeProperty("max-width"),n.floating.style.removeProperty("width")),i&&(n.floating.style.removeProperty("box-sizing"),n.floating.style.removeProperty("max-height"),n.floating.style.removeProperty("height")),{data:{maxSizeAlreadyReset:!0},reset:{rects:!0}}}});function Nf(e,t){const{container:n,overflowBoundary:r}=t;return(0,Ef.Ej)({...r&&{altBoundary:!0,boundary:kf(n,r)},apply({availableHeight:t,availableWidth:n,elements:r,rects:o}){const i=(e,t,n)=>{if(e&&(r.floating.style.setProperty("box-sizing","border-box"),r.floating.style.setProperty(`max-${t}`,`${n}px`),o.floating[t]>n)){r.floating.style.setProperty(t,`${n}px`);const e="width"===t?"x":"y";r.floating.style.getPropertyValue(`overflow-${e}`)||r.floating.style.setProperty(`overflow-${e}`,"auto")}},{applyMaxWidth:a,applyMaxHeight:s}=e;i(a,"width",n),i(s,"height",t)}})}function Of(e){const t=e.split("-");return{side:t[0],alignment:t[1]}}const Df=e=>{const{side:t,alignment:n}=Of(e),r={top:"above",bottom:"below",right:"after",left:"before"}[t],o=n&&(e=>"above"===e||"below"===e?{start:"start",end:"end"}:{start:"top",end:"bottom"})(r)[n];return{position:r,alignment:o}};function Lf(e){const t=(n=e)?"number"==typeof n||"object"==typeof n?n:({rects:{floating:e,reference:t},placement:r})=>{const{position:o,alignment:i}=Df(r);return n({positionedRect:e,targetRect:t,position:o,alignment:i})}:n;var n;return(0,Ef.cY)(t)}function Rf(){return{name:"coverTarget",fn:e=>{const{placement:t,rects:n,x:r,y:o}=e,i={x:r,y:o};switch(Of(t).side){case"bottom":i.y-=n.reference.height;break;case"top":i.y+=n.reference.height;break;case"left":i.x+=n.reference.width;break;case"right":i.x-=n.reference.width}return i}}}function Ff(e){const{hasScrollableElement:t,flipBoundary:n,container:r,fallbackPositions:o=[],isRtl:i}=e,a=o.reduce(((e,t)=>{const{position:n,align:r}=bf(t),o=Af(r,n,i);return o&&e.push(o),e}),[]);return(0,Ef.UU)({...t&&{boundary:"clippingAncestors"},...n&&{altBoundary:!0,boundary:kf(r,n)},fallbackStrategy:"bestFit",...a.length&&{fallbackPlacements:a}})}function Mf(e,t){if("number"==typeof e)return e;const{start:n,end:r,...o}=e,i=o,a=t?"end":"start",s=t?"start":"end";return e[a]&&(i.left=e[a]),e[s]&&(i.right=e[s]),i}function Bf(e){const{hasScrollableElement:t,disableTether:n,overflowBoundary:r,container:o,overflowBoundaryPadding:i,isRtl:a}=e;return(0,Ef.BN)({...t&&{boundary:"clippingAncestors"},...n&&{crossAxis:"all"===n,limiter:(0,Ef.ER)({crossAxis:"all"!==n,mainAxis:!1})},...i&&{padding:Mf(i,a)},...r&&{altBoundary:!0,boundary:kf(o,r)}})}function Uf(){return{name:"intersectionObserver",fn:async e=>{const t=e.rects.floating,n=await(0,Ef.__)(e,{altBoundary:!0}),r=n.top<t.height&&n.top>0,o=n.bottom<t.height&&n.bottom>0;return{data:{intersecting:r||o}}}}}var zf=n(50962);const Hf="data-popper-is-intersecting",Gf="data-popper-escaped",Vf="data-popper-reference-hidden",jf="data-popper-placement";function qf(e){const t=[];let n=e;for(;n;){const r=Pf(n);if(e.ownerDocument.body===r){t.push(r);break}t.push(r),n=r}return t}function Wf(e){const{container:t,target:n,arrow:r,strategy:o,middleware:i,placement:a,useTransform:s=!0}=e;let l=!1;if(!n||!t)return{updatePosition:()=>{},dispose:()=>{}};let c=!0;const u=new Set,d=t.ownerDocument.defaultView;Object.assign(t.style,{position:"fixed",left:0,top:0,margin:0});const p=()=>{l||(c&&(qf(t).forEach((e=>u.add(e))),(0,Ip.s)(n)&&qf(n).forEach((e=>u.add(e))),u.forEach((e=>{e.addEventListener("scroll",f,{passive:!0})})),c=!1),Object.assign(t.style,{position:o}),(0,zf.rD)(n,t,{placement:a,middleware:i,strategy:o}).then((({x:e,y:n,middlewareData:i,placement:a})=>{l||(function(e){const{arrow:t,middlewareData:n}=e;if(!n.arrow||!t)return;const{x:r,y:o}=n.arrow;Object.assign(t.style,{left:`${r}px`,top:`${o}px`})}({arrow:r,middlewareData:i}),function(e){var t,n,r;const{container:o,placement:i,middlewareData:a,strategy:s,lowPPI:l,coordinates:c,useTransform:u=!0}=e;if(!o)return;o.setAttribute(jf,i),o.removeAttribute(Hf),a.intersectionObserver.intersecting&&o.setAttribute(Hf,""),o.removeAttribute(Gf),(null===(t=a.hide)||void 0===t?void 0:t.escaped)&&o.setAttribute(Gf,""),o.removeAttribute(Vf),(null===(n=a.hide)||void 0===n?void 0:n.referenceHidden)&&o.setAttribute(Vf,"");const d=(null===(r=o.ownerDocument.defaultView)||void 0===r?void 0:r.devicePixelRatio)||1,p=Math.round(c.x*d)/d,f=Math.round(c.y*d)/d;Object.assign(o.style,{position:s}),u?Object.assign(o.style,{transform:l?`translate(${p}px, ${f}px)`:`translate3d(${p}px, ${f}px, 0)`}):Object.assign(o.style,{left:`${p}px`,top:`${f}px`})}({container:t,middlewareData:i,placement:a,coordinates:{x:e,y:n},lowPPI:((null==d?void 0:d.devicePixelRatio)||1)<=1,strategy:o,useTransform:s}))})).catch((e=>{0})))},f=function(e){let t;return()=>(t||(t=new Promise((n=>{Promise.resolve().then((()=>{t=void 0,n(e())}))}))),t)}((()=>p()));return d&&(d.addEventListener("scroll",f,{passive:!0}),d.addEventListener("resize",f)),f(),{updatePosition:f,dispose:()=>{l=!0,d&&(d.removeEventListener("scroll",f),d.removeEventListener("resize",f)),u.forEach((e=>{e.removeEventListener("scroll",f)})),u.clear()}}}function Yf(e){const t=_t.useRef(null),n=_t.useRef(null),r=_t.useRef(null),o=_t.useRef(null),i=_t.useRef(null),{enabled:a=!0}=e,s=function(e){const{align:t,arrowPadding:n,autoSize:r,coverTarget:o,flipBoundary:i,offset:a,overflowBoundary:s,pinned:l,position:c,unstable_disableTether:u,positionFixed:d,strategy:p,overflowBoundaryPadding:f,fallbackPositions:h,useTransform:g,matchTargetSize:m}=e,{dir:y,targetDocument:v}=(0,jn.Y)(),S="rtl"===y,C=(null!=p?p:d)?"fixed":"absolute",b=If(r);return _t.useCallback(((e,r)=>{const d=_f(e),p=[b&&xf(b),m&&{name:"matchTargetSize",fn:async e=>{const{rects:{reference:t,floating:n},elements:{floating:r},middlewareData:{matchTargetSize:{matchTargetSizeAttempt:o=!1}={}}}=e;if(t.width===n.width||o)return{};const{width:i}=t;return r.style.width=`${i}px`,r.style.boxSizing="border-box",{data:{matchTargetSizeAttempt:!0},reset:{rects:!0}}}},a&&Lf(a),o&&Rf(),!l&&Ff({container:e,flipBoundary:i,hasScrollableElement:d,isRtl:S,fallbackPositions:h}),Bf({container:e,hasScrollableElement:d,overflowBoundary:s,disableTether:u,overflowBoundaryPadding:f,isRtl:S}),b&&Nf(b,{container:e,overflowBoundary:s}),Uf(),r&&(0,Ef.UE)({element:r,padding:n}),(0,Ef.jD)({strategy:"referenceHidden"}),(0,Ef.jD)({strategy:"escaped"}),!1].filter(Boolean);return{placement:Af(t,c,S),middleware:p,strategy:C,useTransform:g}}),[t,n,b,o,u,i,S,a,s,l,c,C,f,h,g,m,v])}(e),l=_t.useCallback((()=>{var e;t.current&&t.current.dispose(),t.current=null;const l=null!==(e=r.current)&&void 0!==e?e:n.current;a&&(0,Tf.S)()&&l&&o.current&&(t.current=Wf({container:o.current,target:l,arrow:i.current,...s(o.current,i.current)}))}),[a,s]),c=Md((e=>{r.current=e,l()}));_t.useImperativeHandle(e.positioningRef,(()=>({updatePosition:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.updatePosition()},setTarget:t=>{e.target,c(t)}})),[e.target,c]),(0,Fd.E)((()=>{var t;c(null!==(t=e.target)&&void 0!==t?t:null)}),[e.target,c]),(0,Fd.E)((()=>{l()}),[l]);return{targetRef:wf(null,(e=>{n.current!==e&&(n.current=e,l())})),containerRef:wf(null,(e=>{o.current!==e&&(o.current=e,l())})),arrowRef:wf(null,(e=>{i.current!==e&&(i.current=e,l())}))}}function Qf(e){const t=_t.useContext(e);return!!t.version&&-1!==t.version.current}function Jf(e,t={}){const{open:n=!0,multiselect:r=!1}=t,o=e.key,{altKey:i,ctrlKey:a,key:s,metaKey:l}=e;return 1!==s.length||o===Rd.$xS||i||a||l?n?o===Rd.DoI&&i||o===Rd.xyI||!r&&o===Rd.$xS?"CloseSelect":r&&o===Rd.$xS?"Select":o===Rd.uf9?"Close":o===Rd.yd$?"Next":o===Rd.DoI?"Previous":o===Rd.ww0?"First":o===Rd.oam?"Last":o===Rd.j0c?"PageUp":o===Rd.e5x?"PageDown":o===Rd.ozo?"Tab":"None":o===Rd.yd$||o===Rd.DoI||o===Rd.xyI||o===Rd.$xS?"Open":"None":"Type"}const Xf={activeOption:void 0,focusVisible:!1,setActiveOption:()=>null},Kf=(e,t)=>{const{multiselect:n,disableAutoFocus:r=!1}=e,o=yf(),{listboxRef:i,activeParentRef:a,controller:s}=of({matchOption:e=>e.classList.contains(gp)}),l=Qf(up),c=dp((e=>e.onActiveDescendantChange)),u=dp((e=>e.getOptionById)),d=dp((e=>e.getOptionsMatchingValue)),p=l?u:o.getOptionById,f=l?d:o.getOptionsMatchingValue,h=_t.useMemo((()=>{let e=null;const t=e=>{null==c||c(e)};return n=>{n?(e=n,e.addEventListener("activedescendantchange",t)):null==e||e.removeEventListener("activedescendantchange",t)}}),[c]),[g,m]=_t.useState(!1);Xp(m);const y=ap(),v=!!_t.useContext(op),S=v?y.controller:s,{clearSelection:C,selectedOptions:b,selectOption:E}=vf(e),T=dp((e=>e.selectedOptions)),w=dp((e=>e.selectOption)),I=l?{selectedOptions:T,selectOption:w,...Xf}:{selectedOptions:b,selectOption:E,...Xf};_t.useEffect((()=>{if(!v){if(S.hideFocusVisibleAttributes(),!r)if(!n&&I.selectedOptions.length>0){const e=f((e=>e===I.selectedOptions[0])).pop();(null==e?void 0:e.id)&&S.focus(e.id)}else S.first();return()=>{S.blur()}}}),[]);const P=_t.useCallback((()=>{v||(S.showFocusVisibleAttributes(),g&&S.scrollActiveIntoView())}),[S,v,g]),_=_t.useCallback((()=>{v||S.hideFocusVisibleAttributes()}),[S,v]),A={components:{root:"div"},root:Gn.Gk((0,Vn.g)("div",{ref:(0,tp.a)(t,a,i,h),role:n?"menu":"listbox",tabIndex:0,...e}),{elementType:"div"}),standalone:!l,multiselect:n,clearSelection:C,activeDescendantController:S,onActiveDescendantChange:c,...o,...I};return A.root.onKeyDown=Md(ff(A.root.onKeyDown,(e=>{const t=Jf(e,{open:!0}),n=S.active(),r=n?p(n):null;switch(t){case"First":case"Last":case"Next":case"Previous":case"PageDown":case"PageUp":case"CloseSelect":case"Select":e.preventDefault()}switch(t){case"Next":r?S.next():S.first();break;case"Previous":r?S.prev():S.first();break;case"PageUp":case"First":S.first();break;case"PageDown":case"Last":S.last();break;case"Select":case"CloseSelect":r&&E(e,r)}}))),A.root.onFocus=Md(ff(A.root.onFocus,P)),A.root.onBlur=Md(ff(A.root.onBlur,_)),A},Zf="fui-Listbox",$f=(0,Xn.X)({root:{De3pzq:"fxugw4r",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Bf4jedk:"f3hsy1e",Bmxbyg5:"f5zp4f",Bw0xxkn:0,oeaueh:0,Bpd4iqm:0,Befb4lg:"f1iepc6i",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1t35pdg",Belr9w4:"fiut8dr"}},{d:[".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f3hsy1e{min-width:160px;}",".f5zp4f{overflow-y:auto;}",[".f1iepc6i{outline:1px solid var(--colorTransparentStroke);}",{p:-1}],[".f1t35pdg{padding:var(--spacingHorizontalXS);}",{p:-1}],".fiut8dr{row-gap:var(--spacingHorizontalXXS);}"]});const eh=_t.forwardRef(((e,t)=>{const n=Kf(e,t),r=function(e){const t=Qf(up),{getOptionById:n,getOptionsMatchingValue:r,multiselect:o,registerOption:i,selectedOptions:a,selectOption:s,activeDescendantController:l}=e,c=dp((e=>e.registerOption));return{listbox:{activeOption:void 0,focusVisible:!1,getOptionById:n,getOptionsMatchingValue:r,multiselect:o,registerOption:t?c:i,selectedOptions:a,selectOption:s,setActiveOption:()=>{},onOptionClick:dp((e=>e.onOptionClick)),onActiveDescendantChange:dp((e=>e.onActiveDescendantChange))},activeDescendant:_t.useMemo((()=>({controller:l})),[l])}}(n);return(e=>{const t=$f();e.root.className=(0,Kn.z)(Zf,t.root,e.root.className)})(n),(0,tr.$e)("useListboxStyles_unstable")(n),((e,t)=>((0,Jn.C)(e),(0,Qn.Y)(ip,{value:t.activeDescendant,children:(0,Qn.Y)(up.Provider,{value:t.listbox,children:(0,Qn.Y)(e.root,{})})})))(n,r)}));function th(e,t,n){const{state:{multiselect:r},triggerRef:o,defaultProps:i}=n,a=(0,Hn.Bi)("fluent-listbox",null===(s=e)||"object"!=typeof s||Array.isArray(s)||_t.isValidElement(s)?void 0:e.id);var s;const l=Gn.lq(e,{renderByDefault:!0,elementType:eh,defaultProps:{id:a,multiselect:r,tabIndex:void 0,...i}}),c=Md(ff((e=>{e.preventDefault()}),null==l?void 0:l.onMouseDown)),u=Md(ff((e=>{var t;e.preventDefault(),null===(t=o.current)||void 0===t||t.focus()}),null==l?void 0:l.onClick)),d=(0,tp.a)(null==l?void 0:l.ref,t);return l&&(l.ref=d,l.onMouseDown=c,l.onClick=u),l}function nh(e,t,n){const{state:{open:r,setOpen:o,setHasFocus:i},defaultProps:a,elementType:s,activeDescendantController:l}=n,c=Gn.Gk(e,{defaultProps:{type:"text","aria-expanded":r,role:"combobox",..."object"==typeof a&&a},elementType:s}),u=_t.useRef(null);return c.ref=(0,tp.a)(u,c.ref,t),c.onBlur=ff((e=>{o(e,!1),i(!1)}),c.onBlur),c.onFocus=ff((e=>{e.target===e.currentTarget&&i(!0)}),c.onFocus),c.onClick=ff((e=>{o(e,!r)}),c.onClick),c.onKeyDown=ff(function(e){const{activeDescendantController:t,getOptionById:n,setOpen:r,selectOption:o,multiselect:i,open:a}=e,s=_t.useCallback((()=>{const e=t.active();return e?n(e):void 0}),[t,n]),l=()=>{t.first()},c=()=>{t.last()},u=e=>{e?t.next():t.first()},d=e=>{e?t.prev():t.first()},p=()=>{for(let e=0;e<10;e++)t.prev()},f=()=>{for(let e=0;e<10;e++)t.next()},h=function(){const e=Jp();return _t.useCallback((t=>{var n;null===(n=e.current)||void 0===n||n.setVal(t)}),[e])}();return Md((e=>{const t=Jf(e,{open:a,multiselect:i}),n=s();switch(t){case"First":case"Last":case"Next":case"Previous":case"PageDown":case"PageUp":case"Open":case"Close":case"CloseSelect":case"Select":e.preventDefault()}switch(h(!0),t){case"First":l();break;case"Last":c();break;case"Next":u(n);break;case"Previous":d(n);break;case"PageDown":f();break;case"PageUp":p();break;case"Open":r(e,!0);break;case"Close":e.stopPropagation(),r(e,!1);break;case"CloseSelect":!i&&!(null==n?void 0:n.disabled)&&r(e,!1);case"Select":n&&o(e,n);break;case"Tab":!i&&n&&o(e,n)}}))}({activeDescendantController:l,...n.state}),c.onKeyDown),c}function rh(e,t,n){const{state:{open:r,value:o,selectOption:i,setValue:a,multiselect:s,selectedOptions:l,clearSelection:c,getOptionById:u,setOpen:d},freeform:p,defaultProps:f,activeDescendantController:h}=n,g=e=>{const t=null==e?void 0:e.trim().toLowerCase();if(!t||0===t.length)return void h.blur();const n=h.find((e=>{const n=u(e);return!!n&&0===n.text.toLowerCase().indexOf(t)}));if(n)return u(n);h.blur()},m=nh(e,t,{state:n.state,defaultProps:f,elementType:"input",activeDescendantController:h});m.onChange=ff(m.onChange,(e=>{const t=e.target.value;a(t);const n=g(t);s||1!==l.length||!(t.length<1)&&n||c(e)})),m.onBlur=ff(m.onBlur,(e=>{if(!r&&!p){const t=h.active(),n=t?u(t):null;o&&n&&o.trim().toLowerCase()===(null==n?void 0:n.text.toLowerCase())&&i(e,n),a(void 0)}}));const[y,v]=_t.useState(!1),S=_t.useRef(!1),C=m.onKeyDown,b=Md((t=>{r||"Type"!==Jf(t)||d(t,!0),t.key===Rd.nkM||t.key===Rd.Qpb?v(!0):v(!1);const n=Jf(t,{open:r,multiselect:s});var o;("Type"===n?S.current=!0:("Open"===n&&" "!==t.key||"Next"===n||"Previous"===n||"First"===n||"Last"===n||"PageUp"===n||"PageDown"===n)&&(S.current=!1),!S.current&&r||" "!==t.key)?null==C||C(t):null==e||null===(o=e.onKeyDown)||void 0===o||o.call(e,t)}));return m.onKeyDown=b,y&&(m["aria-activedescendant"]=void 0),m}eh.displayName="Listbox";const oh=(e,t)=>{var n,r;e=sf(e,{supportsLabelFor:!0,supportsRequired:!0,supportsSize:!0});const{listboxRef:o,activeParentRef:i,controller:a}=of({matchOption:e=>e.classList.contains(gp)}),s=Sf({...e,editable:!0,activeDescendantController:a}),{clearable:l,clearSelection:c,disabled:u,multiselect:d,open:p,selectedOptions:f,setOpen:h,value:g,hasFocus:m}=s,[y,v]=function(e){const{positioning:t}=e,n={position:"below",align:"start",offset:{crossAxis:0,mainAxis:2},fallbackPositions:["above","after","after-top","before","before-top"],matchTargetSize:"width",autoSize:!0,...bf(t)},{targetRef:r,containerRef:o}=Yf(n);return[o,r]}(e),{disableAutoFocus:S=!1,freeform:C,inlinePopup:b}=e,E=(0,Hn.Bi)("combobox-"),{primary:T,root:w}=(0,lf.n)({props:e,primarySlotTagName:"input",excludedPropNames:["children","size"]}),I=_t.useRef(null),P=th(e.listbox,(0,tp.a)(y,o),{state:s,triggerRef:I,defaultProps:{children:e.children,disableAutoFocus:S}});var _;const A=rh(null!==(_=e.input)&&void 0!==_?_:{},(0,tp.a)(I,i,t),{state:s,freeform:C,defaultProps:{type:"text",value:null!=g?g:"","aria-controls":p?null==P?void 0:P.id:void 0,...T},activeDescendantController:a}),k=Gn.Gk(e.root,{defaultProps:{"aria-owns":!b&&p?null==P?void 0:P.id:void 0,...w},elementType:"div"});k.ref=(0,tp.a)(k.ref,v);const x=f.length>0&&!u&&l&&!d,N={components:{root:"div",input:"input",expandIcon:"span",listbox:eh,clearIcon:"span"},root:k,input:A,listbox:p||m?P:void 0,clearIcon:Gn.lq(e.clearIcon,{defaultProps:{"aria-hidden":"true",children:_t.createElement(Pl.BEt,null)},elementType:"span",renderByDefault:!0}),expandIcon:Gn.lq(e.expandIcon,{renderByDefault:!0,defaultProps:{"aria-disabled":u?"true":void 0,"aria-expanded":p,children:_t.createElement(Pl.yuG,null),role:"button"},elementType:"span"}),showClearIcon:x,activeDescendantController:a,...s},{targetDocument:O}=(0,jn.Y)();(e=>{const{targetDocument:t}=(0,jn.Y)(),n=null==t?void 0:t.defaultView,{refs:r,callback:o,element:i,disabled:a,disabledFocusOnIframe:s,contains:l=cf}=e,c=_t.useRef(void 0);pf({element:i,disabled:s||a,callback:o,refs:r,contains:l});const u=_t.useRef(!1),d=Md((e=>{if(u.current)return void(u.current=!1);const t=e.composedPath()[0];r.every((e=>!l(e.current||null,t)))&&!a&&o(e)})),p=Md((e=>{u.current=r.some((t=>l(t.current||null,e.target)))}));_t.useEffect((()=>{if(a)return;let e=uf(n);const t=t=>{t!==e?d(t):e=void 0};return null==i||i.addEventListener("click",t,!0),null==i||i.addEventListener("touchstart",t,!0),null==i||i.addEventListener("contextmenu",t,!0),null==i||i.addEventListener("mousedown",p,!0),c.current=null==n?void 0:n.setTimeout((()=>{e=void 0}),1),()=>{null==i||i.removeEventListener("click",t,!0),null==i||i.removeEventListener("touchstart",t,!0),null==i||i.removeEventListener("contextmenu",t,!0),null==i||i.removeEventListener("mousedown",p,!0),null==n||n.clearTimeout(c.current),e=void 0}}),[d,i,a,p,n])})({element:O,callback:e=>h(e,!1),refs:[I,y,v],disabled:!p});const{onMouseDown:D}=N.expandIcon||{},L=Md(ff(D,(e=>{var t;e.preventDefault(),N.setOpen(e,!N.open),null===(t=I.current)||void 0===t||t.focus()})));if(N.expandIcon){N.expandIcon.onMouseDown=L;const t="Open";if(!(N.expandIcon["aria-label"]||N.expandIcon["aria-labelledby"]))if(e["aria-labelledby"]){var R;const e=null!==(R=N.expandIcon.id)&&void 0!==R?R:`${E}-chevron`,n=`${e} ${N.input["aria-labelledby"]}`;N.expandIcon["aria-label"]=t,N.expandIcon.id=e,N.expandIcon["aria-labelledby"]=n}else e["aria-label"]?N.expandIcon["aria-label"]=`${t} ${e["aria-label"]}`:N.expandIcon["aria-label"]=t}const F=Md(ff(null===(n=N.clearIcon)||void 0===n?void 0:n.onMouseDown,(e=>{e.preventDefault()}))),M=Md(ff(null===(r=N.clearIcon)||void 0===r?void 0:r.onClick,(e=>{c(e)})));return N.clearIcon&&(N.clearIcon.onMouseDown=F,N.clearIcon.onClick=M),d&&(N.clearIcon=void 0),N};function ih(e,t){if(!e)return;const n=e;n._virtual||(n._virtual={}),n._virtual.parent=t}const ah=_t.createContext(void 0);ah.Provider;var sh=n(72627),lh=n(89772);const ch=(0,Xn.X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]}),uh=At.useInsertionEffect,dh=e=>{const{targetDocument:t,dir:n}=(0,jn.Y)(),r=_t.useContext(ah),o=(0,lh.Y)(),i=ch(),a=(0,sh.q)(),s=(0,Kn.z)(a,i.root,e.className),l=null!=r?r:null==t?void 0:t.body,c=function(e,t){var n;const r=_t.useMemo,o=_t.useEffect,[i,a]=null!=(n=r((()=>e()),t))?n:[null,()=>null];return o((()=>a),t),i}((()=>{if(void 0===l||e.disabled)return[null,()=>null];const t=l.ownerDocument.createElement("div");return l.appendChild(t),[t,()=>t.remove()]}),[l]);return uh?uh((()=>{if(!c)return;const e=s.split(" ").filter(Boolean);return c.classList.add(...e),c.setAttribute("dir",n),c.setAttribute("data-portal-node","true"),o.current=c,()=>{c.classList.remove(...e),c.removeAttribute("dir")}}),[s,n,c,o]):_t.useMemo((()=>{c&&(c.className=s,c.setAttribute("dir",n),c.setAttribute("data-portal-node","true"),o.current=c)}),[s,n,c,o]),c},ph=e=>{const{element:t,className:n}=function(e){return(0,Ip.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}(e.mountNode),r=_t.useRef(null),o=dh({disabled:!!t,className:n}),i=null!=t?t:o,a={children:e.children,mountNode:i,virtualParentRootRef:r};return _t.useEffect((()=>{if(!i)return;const e=r.current,t=i.contains(e);return e&&!t?(ih(i,e),()=>{ih(i,void 0)}):void 0}),[r,i]),a},fh=e=>(e=>_t.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&hf.createPortal(e.children,e.mountNode)))(ph(e));fh.displayName="Portal";const hh=lp({activeOption:void 0,appearance:"outline",focusVisible:!1,open:!1,registerOption:()=>()=>{},selectedOptions:[],selectOption(){},setActiveOption(){},setOpen(){},size:"medium"}),gh=(hh.Provider,"fui-Combobox"),mh="fui-Combobox__input",yh="fui-Combobox__expandIcon",vh="fui-Combobox__clearIcon",Sh="fui-Combobox__listbox",Ch=(0,Xn.X)({root:{Bt984gj:"f122n59",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",B7ck84d:"f1ewtqcl",i8kkvl:"f14mj54c",mc9l5x:"fwk3njj",Budl1dq:"fz17x9o",Brf1p80:"f1869bpl",Bf4jedk:"f1exfvgq",qhf8xq:"f10pi13n",ha4doy:"fmrv4ls",Bbr2w1p:"f14a1fxs",Bduesf4:"f3e99gv",Bpq79vn:"fhljsf7",li1rpt:"f1gw3sf2",Bsft5z2:"f13zj6fq",E3zdtr:"f1mdlcz9",Eqx8gd:["f1a7op3","f1cjjd47"],By385i5:"f1gboi2j",B1piin3:["f1cjjd47","f1a7op3"],Dlnsje:"f145g4dw",d9w3h3:["f1kp91vd","f1ibwz09"],B3778ie:["f1ibwz09","f1kp91vd"],B1q35kw:0,Bw17bha:0,Bcgy8vk:0,Bjuhk93:"f1mnjydx",Gjdm7m:"f13evtba",b1kco5:"f1yk9hq",Ba2ppi3:"fhwpy7i",F2fol1:"f14ee0xe",lck23g:"f1xhbsuh",df92cz:"fv8e3ye",I188md:"ftb5wc6",umuwi5:"fjw5xc1",Blcqepd:"f1xdyd5c",nplu4u:"fatpbeo",Bioka5o:"fb7uyps",H713fs:"f1cmft4k",B9ooomg:"f1x58t8o",Bercvud:"f1ibeo51"},listbox:{E5pizo:"f1hg901r",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bxyxcbc:"fmmk62d",B7ck84d:"f1ewtqcl"},listboxCollapsed:{mc9l5x:"fjseox"},inlineListbox:{Bj3rh1h:"f19g0ac"},small:{Bqenvij:"frvgh55",z189sj:["fdw0yi8","fk8j09s"]},medium:{Bqenvij:"f1d2rq10",z189sj:["f11gcy0p","f1ng84yb"]},large:{i8kkvl:"f1rjii52",Bqenvij:"fbhnoac",z189sj:["fw5db7e","f1uw59to"]},outline:{De3pzq:"fxugw4r",Bgfg5da:0,B9xav0g:"f1c1zstj",oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fhz96rm"},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"flmw63s",gg5e9n:["f1m52nbi","f1ub3y4t"],B6oc9vd:"fvs00aa",ak43y8:["f1assf6x","f4ruux4"],wmxk5l:"fqhmt4z",B50zh58:["f4ruux4","f1assf6x"]},underline:{De3pzq:"f1c21dwh",B9xav0g:0,oivjwe:0,Bn0qgzm:0,Bgfg5da:"f9ez7ne",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779"},"filled-lighter":{De3pzq:"fxugw4r",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f88035w"},"filled-darker":{De3pzq:"f16xq7d1",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f88035w"},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},invalidUnderline:{hhx65j:"f1fgmyf4"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"]}},{d:[".f122n59{align-items:center;}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".f14mj54c{column-gap:var(--spacingHorizontalXXS);}",".fwk3njj{display:inline-grid;}",".fz17x9o{grid-template-columns:1fr auto;}",".f1869bpl{justify-content:space-between;}",".f1exfvgq{min-width:250px;}",".f10pi13n{position:relative;}",".fmrv4ls{vertical-align:middle;}",".f1gw3sf2::after{box-sizing:border-box;}",'.f13zj6fq::after{content:"";}',".f1mdlcz9::after{position:absolute;}",".f1a7op3::after{left:-1px;}",".f1cjjd47::after{right:-1px;}",".f1gboi2j::after{bottom:-1px;}",".f145g4dw::after{height:max(2px, var(--borderRadiusMedium));}",".f1kp91vd::after{border-bottom-left-radius:var(--borderRadiusMedium);}",".f1ibwz09::after{border-bottom-right-radius:var(--borderRadiusMedium);}",[".f1mnjydx::after{border-bottom:var(--strokeWidthThick) solid var(--colorCompoundBrandStroke);}",{p:-1}],".f13evtba::after{clip-path:inset(calc(100% - 2px) 0 0 0);}",".f1yk9hq::after{transform:scaleX(0);}",".fhwpy7i::after{transition-property:transform;}",".f14ee0xe::after{transition-duration:var(--durationUltraFast);}",".f1xhbsuh::after{transition-delay:var(--curveAccelerateMid);}",".f1hg901r{box-shadow:var(--shadow16);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fmmk62d{max-height:80vh;}",".fjseox{display:none;}",".f19g0ac{z-index:1;}",".frvgh55{height:24px;}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".f1d2rq10{height:32px;}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f1rjii52{column-gap:var(--spacingHorizontalSNudge);}",".fbhnoac{height:40px;}",".fw5db7e{padding-right:var(--spacingHorizontalM);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",[".fhz96rm{border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);}",{p:-2}],".f1c1zstj{border-bottom-color:var(--colorNeutralStrokeAccessible);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".f9ez7ne{border-bottom:var(--strokeWidthThin) solid var(--colorNeutralStrokeAccessible);}",{p:-1}],[".fokr779{border-radius:0;}",{p:-1}],[".f88035w{border:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-2}],".f16xq7d1{background-color:var(--colorNeutralBackground3);}",[".f88035w{border:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-2}],".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}"],w:[".f14a1fxs:focus-within{outline-width:2px;}",".f3e99gv:focus-within{outline-style:solid;}",".fhljsf7:focus-within{outline-color:transparent;}",".fjw5xc1:focus-within::after{transform:scaleX(1);}",".f1xdyd5c:focus-within::after{transition-property:transform;}",".fatpbeo:focus-within::after{transition-duration:var(--durationNormal);}",".fb7uyps:focus-within::after{transition-delay:var(--curveDecelerateMid);}",".f1ibeo51:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.fv8e3ye::after{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.ftb5wc6::after{transition-delay:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1cmft4k:focus-within::after{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1x58t8o:focus-within::after{transition-delay:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".flmw63s:hover{border-bottom-color:var(--colorNeutralStrokeAccessible);}"],a:[".fvs00aa:active{border-top-color:var(--colorNeutralStroke1Pressed);}",".f1assf6x:active{border-right-color:var(--colorNeutralStroke1Pressed);}",".f4ruux4:active{border-left-color:var(--colorNeutralStroke1Pressed);}",".fqhmt4z:active{border-bottom-color:var(--colorNeutralStrokeAccessible);}"]}),bh=(0,Xn.X)({input:{qb2dma:"f1ub7u0d",De3pzq:"f1c21dwh",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",sj55zd:"f19n0e5",Bahqtrf:"fk6fouc",Brovlpu:"ftqa4ok",yvdlaj:"fwyc1cq",B3o7kgh:"f13ta7ih"},small:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["fxe2rs","f1gflqzi"]},medium:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["fzy81xo","f58b53b"]},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:["f1kdav7a","footqm6"]},disabled:{sj55zd:"f1s2aq7o",De3pzq:"f1c21dwh",Bceei9c:"fdrzuqr",yvdlaj:"fahhnxm"}},{d:[".f1ub7u0d{align-self:stretch;}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".f3bhgqh{border:none;}",{p:-2}],".f19n0e5{color:var(--colorNeutralForeground1);}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fwyc1cq::-webkit-input-placeholder{color:var(--colorNeutralForeground4);}",".fwyc1cq::-moz-placeholder{color:var(--colorNeutralForeground4);}",".f13ta7ih::-webkit-input-placeholder{opacity:1;}",".f13ta7ih::-moz-placeholder{opacity:1;}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",[".fxe2rs{padding:0 0 0 calc(var(--spacingHorizontalSNudge) + var(--spacingHorizontalXXS));}",{p:-1}],[".f1gflqzi{padding:0 calc(var(--spacingHorizontalSNudge) + var(--spacingHorizontalXXS)) 0 0;}",{p:-1}],".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".fzy81xo{padding:0 0 0 calc(var(--spacingHorizontalMNudge) + var(--spacingHorizontalXXS));}",{p:-1}],[".f58b53b{padding:0 calc(var(--spacingHorizontalMNudge) + var(--spacingHorizontalXXS)) 0 0;}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f1kdav7a{padding:0 0 0 calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",{p:-1}],[".footqm6{padding:0 calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge)) 0 0;}",{p:-1}],".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".fahhnxm::-webkit-input-placeholder{color:var(--colorNeutralForegroundDisabled);}",".fahhnxm::-moz-placeholder{color:var(--colorNeutralForegroundDisabled);}"],f:[".ftqa4ok:focus{outline-style:none;}"]}),Eh=(0,Xn.X)({icon:{B7ck84d:"f1ewtqcl",sj55zd:"fxkbij4",Bceei9c:"f1k6fduh",mc9l5x:"ftgm304",Be2twd7:"f1pp30po",Bo70h7d:"fvc9v3g"},hidden:{mc9l5x:"fjseox"},visuallyHidden:{Bh84pgu:"f1ekcaio",Bqenvij:"f1mpe4l3",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1jlpb2r",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1c5fvqg",a9b677:"frkrog8",qhf8xq:"f1euv43f"},small:{Be2twd7:"f4ybsrx",Frg6f3:["f1h9en5y","f1xk557c"]},medium:{Be2twd7:"fe5j1ua",Frg6f3:["f1h9en5y","f1xk557c"]},large:{Be2twd7:"f1rt2boy",Frg6f3:["f1t5qyk5","f1ikr372"]},disabled:{sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr"}},{d:[".f1ewtqcl{box-sizing:border-box;}",".fxkbij4{color:var(--colorNeutralStrokeAccessible);}",".f1k6fduh{cursor:pointer;}",".ftgm304{display:block;}",".f1pp30po{font-size:var(--fontSizeBase500);}",".fvc9v3g svg{display:block;}",".fjseox{display:none;}",".f1ekcaio{clip:rect(0px, 0px, 0px, 0px);}",".f1mpe4l3{height:1px;}",[".f1jlpb2r{margin:-1px;}",{p:-1}],[".f1a3p1vp{overflow:hidden;}",{p:-1}],[".f1c5fvqg{padding:0px;}",{p:-1}],".frkrog8{width:1px;}",".f1euv43f{position:absolute;}",".f4ybsrx{font-size:16px;}",".f1h9en5y{margin-left:var(--spacingHorizontalXXS);}",".f1xk557c{margin-right:var(--spacingHorizontalXXS);}",".fe5j1ua{font-size:20px;}",".f1rt2boy{font-size:24px;}",".f1t5qyk5{margin-left:var(--spacingHorizontalSNudge);}",".f1ikr372{margin-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}"]});const Th=_t.forwardRef(((e,t)=>{const n=oh(e,t),r=function(e){const{appearance:t,open:n,getOptionById:r,getOptionsMatchingValue:o,registerOption:i,selectedOptions:a,selectOption:s,setOpen:l,size:c,activeDescendantController:u,onOptionClick:d,onActiveDescendantChange:p}=e,f={activeOption:void 0,focusVisible:!1,getOptionById:r,getOptionsMatchingValue:o,registerOption:i,selectedOptions:a,selectOption:s,setActiveOption:()=>null,onOptionClick:d,onActiveDescendantChange:p};return{combobox:{activeOption:void 0,appearance:t,focusVisible:!1,open:n,registerOption:i,selectedOptions:a,selectOption:s,setActiveOption:()=>null,setOpen:l,size:c},activeDescendant:_t.useMemo((()=>({controller:u})),[u]),listbox:f}}(n);return(e=>{const{appearance:t,open:n,size:r,showClearIcon:o}=e,i="true"==`${e.input["aria-invalid"]}`,a=e.input.disabled,s=Ch(),l=Eh(),c=bh();e.root.className=(0,Kn.z)(gh,s.root,s[t],s[r],!a&&"outline"===t&&s.outlineInteractive,i&&"underline"!==t&&s.invalid,i&&"underline"===t&&s.invalidUnderline,a&&s.disabled,e.root.className),e.input.className=(0,Kn.z)(mh,c.input,c[r],a&&c.disabled,e.input.className),e.listbox&&(e.listbox.className=(0,Kn.z)(Sh,s.listbox,e.inlinePopup&&s.inlineListbox,!n&&s.listboxCollapsed,e.listbox.className)),e.expandIcon&&(e.expandIcon.className=(0,Kn.z)(yh,l.icon,l[r],a&&l.disabled,o&&l.visuallyHidden,e.expandIcon.className)),e.clearIcon&&(e.clearIcon.className=(0,Kn.z)(vh,l.icon,l[r],a&&l.disabled,!o&&l.hidden,e.clearIcon.className))})(n),(0,tr.$e)("useComboboxStyles_unstable")(n),((e,t)=>((0,Jn.C)(e),(0,Qn.Y)(e.root,{children:(0,Qn.Y)(ip,{value:t.activeDescendant,children:(0,Qn.Y)(pp,{value:t.listbox,children:(0,Qn.FD)(hh.Provider,{value:t.combobox,children:[(0,Qn.Y)(e.input,{}),e.clearIcon&&(0,Qn.Y)(e.clearIcon,{}),e.expandIcon&&(0,Qn.Y)(e.expandIcon,{}),e.listbox&&(e.inlinePopup?(0,Qn.Y)(e.listbox,{}):(0,Qn.Y)(fh,{mountNode:e.mountNode,children:(0,Qn.Y)(e.listbox,{})}))]})})})})))(n,r)}));Th.displayName="Combobox";const wh=function(e){return _t.createElement("svg",{width:e.size,height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.createElement("path",{d:"M18 7H15.5C14.673 7 14 6.327 14 5.5V2H6V18H18V7Z",fill:"white"}),_t.createElement("path",{d:"M18 6.00003V5.70703L15 2.70703V5.50003C15 5.77503 15.225 6.00003 15.5 6.00003H18Z",fill:"white"}),_t.createElement("path",{opacity:"0.67",fillRule:"evenodd",clipRule:"evenodd",d:"M18.707 5L15 1.293C14.8125 1.10545 14.5582 1.00006 14.293 1H6C5.44772 1 5 1.44772 5 2V18C5 18.5523 5.44772 19 6 19H18C18.5523 19 19 18.5523 19 18V5.707C18.9999 5.4418 18.8945 5.18749 18.707 5ZM18 5.707V6H15.5C15.2241 5.99945 15.0006 5.77591 15 5.5V2.707L18 5.707ZM6 2.2V17.8C6 17.9105 6.08954 18 6.2 18H17.8C17.9105 18 18 17.9105 18 17.8V7H15.5C14.6716 7 14 6.32843 14 5.5V2H6.2C6.09 2 6 2.09 6 2.2Z",fill:"#605E5C"}),_t.createElement("path",{d:"M15.95 11H14L13 10L12 11V13.489C12.419 13.805 12.935 14 13.5 14C14.2508 14.0002 14.9619 13.6629 15.4368 13.0813C15.9118 12.4998 16.1002 11.7356 15.95 11Z",fill:"#ED6C47"}),_t.createElement("path",{d:"M13.5 9C12.9578 9.00113 12.4309 9.17992 12 9.509V11H14V9.05C13.8354 9.01665 13.6679 8.9999 13.5 9V9Z",fill:"#FF8F6B"}),_t.createElement("path",{d:"M15 10H17C16.7939 8.99305 16.0069 8.20614 15 8V10H15Z",fill:"#FFC7B5"}),_t.createElement("path",{d:"M2 16H10C10.5523 16 11 15.5523 11 15V7C11 6.44772 10.5523 6 10 6H2C1.44772 6 1 6.44772 1 7V15C1 15.5523 1.44772 16 2 16Z",fill:"#C43E1C"}),_t.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.50521 8.481C7.17621 8.16 6.70021 8 6.08021 8H4.01221V14H5.00021V11.879H6.01521C6.37926 11.8866 6.73903 11.7994 7.05921 11.626C7.36021 11.457 7.59121 11.221 7.75521 10.916C7.91921 10.612 8.00021 10.264 8.00021 9.874C8.00021 9.267 7.83521 8.802 7.50521 8.481ZM5.89921 11H5.00021V8.988H5.93121C6.35921 8.988 7.00021 8.992 7.00021 10C7.00021 10.898 6.40621 11 5.89921 11Z",fill:"#F9F7F7"}))};var Ih=/(\{\d+\})/g,Ph=/[\{\}]/g;function _h(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return _t.createElement(_t.Fragment,null,e.split(Ih).map((function(e){if(!Ph.test(e))return e;var t=parseInt(e.replace(Ph,""),10),r=n[t];return(t>=n.length||t<0)&&(r=e),String(r)})).filter((function(e){return""!==e})))}var Ah=(0,On.n)({dropdownList:{maxHeight:"346px",width:"210px"},dropDown:{marginBlockStart:Ws.L.spacingVerticalL,minWidth:"fit-content"},translateButton:{marginBlockStart:Ws.L.spacingVerticalL,borderRadius:Ws.L.borderRadiusMedium},translateButtonEnabled:{background:Ws.L.colorBrandBackground,transition:"transform 300ms ease-out"},spinner:{pointerEvents:"none",minHeight:"54px",width:"288px",display:"flex",justifyContent:"flex-start",alignItems:"center",gap:Ws.L.spacingVerticalS,paddingInlineEnd:Ws.L.spacingVerticalS,paddingBlock:Ws.L.spacingVerticalXXS},spinnerLabel:{color:Ws.L.colorNeutralForeground3,fontWeight:Ws.L.fontWeightSemibold},spinnerWeb:{paddingInlineStart:Ws.L.spacingVerticalS,marginBlock:Ws.L.spacingVerticalL,background:Ws.L.colorNeutralBackground1,boxSizing:"border-box",borderRadius:Ws.L.borderRadiusLarge,boxShadow:Ws.L.shadow4,"&:hover":{background:Ws.L.colorNeutralBackground1}},downloadTranslatedPPTButton:{minHeight:"54px",width:"288px",display:"flex",gap:Ws.L.spacingVerticalS,justifyContent:"flex-start",paddingInline:Ws.L.spacingVerticalS,paddingBlock:Ws.L.spacingVerticalS,marginBlock:Ws.L.spacingVerticalL,borderRadius:Ws.L.borderRadiusLarge,boxSizing:"border-box"},iconWithText:{display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start"},pptIcon:{minWidth:"20px"},pptNameAndODSPPathText:{display:"grid",gridTemplateRows:"auto auto",alignItems:"flex-start",justifyContent:"flex-start",gap:Ws.L.spacingVerticalXS,marginInlineStart:Ws.L.spacingVerticalS},pptName:{textAlign:"start",color:Ws.L.colorNeutralForeground1,size:"12px",lineHeight:"16px"},ODSPPath:{textAlign:"start",color:Ws.L.colorNeutralForeground4,size:"12px",lineHeight:"16px"},warningIcon:{alignItems:"center"},messageBarStyles:{alignItems:"center",border:"none",boxShadow:"none",marginBlockStart:"-10px",paddingInlineStart:Ws.L.spacingHorizontalXS},messageBarBodyStyles:{width:"100%",fontSize:Ws.L.fontSizeBase200,lineHeight:Ws.L.lineHeightBase100},translateFullDeck:{marginBlockStart:Ws.L.spacingVerticalL,display:"flex",gap:Ws.L.spacingHorizontalS},overflowContent:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},icon:{maxWidth:"16px",maxHeight:"16px"}}),kh=function(e){var t=Ah();return{TranslationCard:function(n){var r,o=(0,l._)((0,I.Hum)()).concat((0,l._)((0,I.Yti)()),(0,l._)((0,I.PGr)()),(0,l._)((0,I.hq9)())),i=o.find((function(e){return e.language===n.targetLanguage})),a=(0,s._)((0,_t.useState)(i?i.code:I.u1i),2),c=a[0],u=a[1],d=(0,s._)((0,_t.useState)(null!==(r=null==i?void 0:i.language)&&void 0!==r?r:I.u1i),2),p=d[0],f=d[1],h=(0,s._)((0,_t.useState)(!1),2),g=h[0],m=h[1],y=(0,s._)((0,_t.useState)(!1),2),v=y[0],S=y[1];(0,M.PA)(M.IY.IsHindiSupportEnabledInTranslationCard)&&o.push(I.vLN),(0,_t.useEffect)((function(){if(n.targetLanguage){var e=o.find((function(e){return e.language.toLowerCase().includes(n.targetLanguage.toLowerCase())}));e?(m(!0),u(e.code),f(e.language)):S(!0)}}),[n.targetLanguage,o]);var C=o.map((function(e){return{children:e.language,value:e.code}})).sort((function(e,t){return e.children.localeCompare(t.children)})),b=function(e,t,n){const{filter:r=Sp,noOptionsMessage:o="We couldn't find any matches.",optionToReactKey:i=Cp,optionToText:a=Cp,renderOption:s=e=>"string"==typeof e?_t.createElement(vp,{key:e},e):_t.createElement(vp,{...e,key:i(e),text:a(e),value:e.value},e.children)}=n,l=_t.useMemo((()=>{const n=e.trim();return t.filter((e=>r(a(e),n)))}),[t,a,r,e]);return 0===l.length?[_t.createElement(vp,{"aria-disabled":"true",key:"no-results",text:""},o)]:l.map((e=>s(e)))}(p,C,{noOptionsMessage:(0,I.IxG)(),optionToText:function(e){return e.children}}),E=new Set(o.map((function(e){return e.language}))),T=function(e){return E.has(e)};switch(n.cardType){case Z.wv.LoaderCard:return _t.createElement(_t.Fragment,null,oe.i.isWebPlatform()?_h((0,I.PR_)(),n.selectedLanguage):_h((0,I.ZVq)(),n.selectedLanguage),_t.createElement(yr,{role:"none",tabIndex:0,size:"tiny",className:oe.i.isWebPlatform()?(0,Kn.z)(t.spinner,t.spinnerWeb):t.spinner,label:oe.i.isWebPlatform()?_t.createElement("span",{className:(0,Kn.z)(t.spinnerLabel,t.overflowContent),"aria-label":"".concat((0,I.XIj)()," ").concat(n.translatedPresentationName)},n.translatedPresentationName):_t.createElement("span",{className:t.spinnerLabel},(0,I.Eip)())}));case Z.wv.TranslatedPPTCard:return _t.createElement(_t.Fragment,null,_h((0,I.Hif)(),n.selectedLanguage),_t.createElement(Kd,{className:t.downloadTranslatedPPTButton,onClick:function(){return(0,ud.qL)(n.translatedFileAbsolutePath,(0,ud.VL)(n.messageId,p,c))},"aria-label":n.translatedPresentationName},_t.createElement("div",{className:t.iconWithText},_t.createElement("div",{className:t.pptIcon},_t.createElement(wh,{size:20})),_t.createElement("div",{className:(0,Kn.z)(t.pptNameAndODSPPathText)},_t.createElement("span",{className:(0,Kn.z)(t.pptName,t.overflowContent)},n.translatedPresentationName),_t.createElement("span",{className:(0,Kn.z)(t.ODSPPath,t.overflowContent)},n.translatedFileRelativePath)))),n.isCharacterCountLimitExceeded&&_t.createElement(Hp,{intent:"info",className:t.messageBarStyles,icon:{className:t.icon}},_t.createElement(Yp,{className:t.messageBarBodyStyles},(0,I.mO0)())));case Z.wv.TranslateFullDeckWarningCard:return _t.createElement(_t.Fragment,null,(0,I.bvJ)(),_t.createElement("div",{className:t.translateFullDeck},_t.createElement(Kd,null,(0,I.FUf)()),_t.createElement(Kd,null,(0,I.hOS)())));case Z.wv.LargeTextualContent:return _t.createElement(_t.Fragment,null,(0,I.c5f)());case Z.wv.DraftModeSuccessCard:return _t.createElement(_t.Fragment,null,_h((0,I.nnn)(),n.selectedLanguage));case Z.wv.TextMessageCard:return _t.createElement(_t.Fragment,null,n.textMessage);default:return _t.createElement(_t.Fragment,null,v?(0,I.Lm3)():g?(0,I.KUu)():oe.i.isWebPlatform()?(0,I.ojN)():(0,I.Yd2)(),_t.createElement("div",null,_t.createElement(Th,{clearable:!0,value:p,className:t.dropDown,onOptionSelect:function(e,t){var n,r;f(null!==(n=t.optionText)&&void 0!==n?n:""),u(null!==(r=t.optionValue)&&void 0!==r?r:"")},placeholder:(0,I.I_l)(),onChange:function(e){return f(e.target.value)},positioning:{autoSize:"width"},listbox:{className:t.dropdownList}},b.map((function(e){return _t.createElement(vp,{key:e.props.value,value:e.props.value,"aria-label":e.props.children,"aria-live":"assertive"},e.props.children)})))),_t.createElement(Kd,{appearance:"primary",className:T(p)?(0,Kn.z)(t.translateButton,t.translateButtonEnabled):t.translateButton,disabled:!T(p),onClick:function(){return(0,ud.uz)(e,(0,ud.VL)(n.messageId,p,c))}},(0,I.Qep)()))}}}},xh=n(63900),Nh=n(6224),Oh=n(47350),Dh=n(24725);var Lh=n(58651);const Rh=_t.memo((({messageId:e,headerText:t,initialSections:n=[],handleToggleChange:r,statusMessage:o})=>{const[i,a]=_t.useState(n);_t.useEffect((()=>{n&&n.length>0&&a(n)}),[n,e]);const s=_t.useCallback(((t,n)=>{t===e&&a(n)}),[e]);_t.useEffect((()=>{const t=Oh.U.getInstance();return t.subscribe(e,s),()=>{t.unsubscribe(e,s)}}),[e,s]);return 0===i.length?(Lh.error("No sections available."),_t.createElement("div",null,"No sections available.")):_t.createElement(Dh.x,{headerText:null!=t?t:"Heres a summary of the deck:",initialSections:i,handleToggleChange:(t,n,o)=>{const i=Oh.U.getInstance();i.insertSections(e,o),i.notifySubscribers(e),null==r||r(t,n,o)},statusMessage:o})}));Rh.displayName="InteractiveSummaryDriverComponent";var Fh=n(78289),Mh=n(99838),Bh=n(58651),Uh=V.utd.Unknown,zh=!1,Hh=!0,Gh=!1,Vh=_.G.getInstance(),jh=me.K.getInstance(),qh=xe.B.getInstance(),Wh=!1,Yh=function(e){var t,u,d,p=e.theme,f=void 0===p?A.G.defaultWhite:p,h=e.isHighContrast,g=void 0!==h&&h,m=function(e){var t={userPrompt:e,sourceComponent:X.FX.CopilotLabs,initiatorView:Ne.ff};return(0,M.bw)(M.WT.IsRedirectToNBForCreatingNonGroundedPresentationEnabled)&&e.toLocaleLowerCase().startsWith(Ne.uv.toLocaleLowerCase())?(t.isCreateFromFile=!1,(0,Ne.VL)(t),Promise.resolve(!1)):(0,M.bw)(M.WT.IsRedirectToNBForCreatingGroundedPresentationEnabled)&&e.toLocaleLowerCase().startsWith(Ne.dK.toLocaleLowerCase())?(t.isCreateFromFile=!0,(0,Ne.VL)(t),Promise.resolve(!1)):Promise.resolve(!0)},y=function(e,t,n,r){if(Cn){var o=In,s=o.find((function(t){return t.queryId===e}));if(void 0!==s){var c=o.indexOf(s);o[c].telemetry=t}else o.push({queryId:e,telemetry:t});if(r){var u=In.map((function(e){return(0,a._)((0,i._)({},e),{requestId:e.queryId})})),d={messages:r,requests:(0,l._)(u),id:n,isFirstMessageTrigger:!0,status:I.qOX};Gn({conversation:d})}_n(o),v()}},v=function(){Dn((0,ft.d3)())},S=function(e){return Ro.apply(this,arguments)},C=function(){return Fo.apply(this,arguments)};(0,M.PA)(M.IY.UseNewCopilotSharedPackage)&&!Wh&&((0,V.YPU)(I.fn_,ve.cY,qh,{IsClpEnabledInEnterpriseForSydney:function(){return(0,M.PA)(M.IY.IsClpEnabledInEnterpriseForSydney)},IsApplyLabelUsingTryUpgradeLabelEnabled:function(){return(0,M.bw)(M.WT.IsApplyLabelUsingTryUpgradeLabelEnabled)},IsUserTypeEnterprise:function(){return(0,ve.$1)(Qh())},getOfficeJSDocumentURL:function(){return(0,Ne.MS)()},shouldCLPExceptionDisableEnterpriseSearch:function(){return(0,M.PA)(M.IY.ShouldCLPExceptionDisableEnterpriseSearch)},setEnableEnterpriseSearchOverride:kn.LA,getFeedbackData:Ne.as}),Wh=!0);var b,E,T,_,me,be,Ee,Te,we=(0,s._)((0,_t.useState)(V.utd.Unknown),2),Ie=we[0],Pe=we[1],_e=(0,s._)(_t.useState({objectId:"",tenantId:""}),2),Ae=_e[0],ke=_e[1],De=(0,_t.useRef)(Ie),Le=(0,s._)((0,_t.useState)(!1),2),Re=Le[0],Ue=Le[1],ze=(0,s._)(_t.useState(void 0),2),He=ze[0],Ge=ze[1],Ve=(0,s._)((0,_t.useState)(Z.Ns.BLANK),2),qe=Ve[0],Qe=Ve[1],Xe=(0,s._)((0,_t.useState)(Dt(!0)),2),Ke=Xe[0],$e=Xe[1],et=(0,s._)((0,_t.useState)(0),2),tt=et[0],nt=et[1],ot=(0,_t.useRef)(tt),it=(0,s._)((0,_t.useState)(an(qe,Ie,!1,ot.current)),2),mt=it[0],yt=it[1],St=(0,_t.useRef)(mt),Ct=(0,s._)((0,_t.useState)(0),2),bt=Ct[0],Et=Ct[1],Tt=_t.useRef([]),It=_t.useRef([]),Pt=_t.useRef(P.Ff.Unset),At=function(e,t,n){var r=(0,s._)((0,_t.useState)(Bn(e,t)),2),o=r[0],i=r[1];return(0,_t.useEffect)((function(){i(Bn(e,t))}),[e,t,n]),o}(tt,Ie,bt),kt=(0,s._)((0,_t.useState)(!1),2),xt=kt[0],Nt=kt[1],Bt=(b=tt,E=_t.useRef(!1),T=_t.useRef(!1),_=_t.useRef(!1),me=_t.useRef(-1),be=function(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!T.current&&_.current)&&(0,Ne.fe)(me.current)&&(T.current=!0,(0,ct.uK)())},Ee=function(){var e=(0,r._)((function(){return(0,c.__generator)(this,(function(e){return(Mh.isSDXRenderingForPreload&&(0,M.bw)(M.WT.EnableSummaryTriggerAtPreload)||!Mh.isSDXRenderingForPreload)&&(E.current||T.current||!(me.current>=(0,lt.i$)())||re.Vv.IsSettingTrue(re.zj.TriggerSummary)||(0,We.J2)()||re.Vv.IsSettingTrue(re.zj.ProactiveSummarySignalEnabled)||(E.current=!0,(0,ct.Bx)())),[2]}))}));return function(){return e.apply(this,arguments)}}(),_t.useEffect((function(){me.current=b,be(),Ee()}),[b]),(0,Wa.A)(Ee),{interactiveSummaryAnnotationActivationHandler:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_.current=!0,be(e)}}).interactiveSummaryAnnotationActivationHandler,Ut=(0,s._)((0,_t.useState)(le.m.NotACommand),2),zt=Ut[0],Ht=Ut[1],Vt=_t.useRef(!1),jt=(0,s._)(_t.useState(void 0),2),qt=jt[0],Wt=(jt[1],(0,s._)(_t.useState((0,We.b8)()),2)),Qt=Wt[0],Jt=Wt[1],Xt=(0,s._)(_t.useState(!1),2),Kt=Xt[0],Zt=Xt[1],$t=(0,s._)((0,_t.useState)(!1),2),en=$t[0],tn=$t[1],nn=(0,s._)(_t.useState(void 0),2),rn=nn[0],on=nn[1],sn=(0,s._)(_t.useState(!1),2),gn=sn[0],mn=sn[1],yn=_t.useRef(!1),vn=_t.useRef((0,Un.A)()),Sn=_t.useRef(null),Cn=(0,M.bw)(M.WT.IsSydneyDebugToggleEnabled)||(0,M.bw)(M.WT.IsDebugSectionV2Enabled),bn=(0,s._)(_t.useState(""),2),En=bn[0],Tn=bn[1],wn=(0,s._)(_t.useState([]),2),In=wn[0],_n=wn[1],Nn=(0,s._)(_t.useState(),2),On=Nn[0],Dn=Nn[1],Mn=(0,s._)(_t.useState(),2),Hn=Mn[0],Gn=Mn[1],Vn=(0,s._)(_t.useState(!1),2),jn=Vn[0],qn=Vn[1],Wn=(0,s._)(_t.useState(),2),Yn=Wn[0],Qn=Wn[1],Jn=(0,s._)(_t.useState(Cn?{conversationId:En,telemetryData:In,isDebugToggleEnabled:Cn,sessionId:ft.Ob,conversationLogObject:On,sydneyConversationObject:Hn,debugMessageInfoObject:Yn,showDebugInfoMessage:jn,setShowDebugInfoOnMessage:qn,sdxVersion:(0,Se.QV)(),augloopKustoQueryURL:"",clientKustoQueryURL:""}:void 0),2),Xn=Jn[0],Kn=Jn[1],Zn=_t.useRef((0,k.XG)()),$n=(0,V.lqj)({clientInfoRef:Zn,theme:f,locale:(0,ee.hD)(oe.i.GetHostAppDisplayLanguage()),clientId:V.xkN,redirectUri:(0,ie.cn)(),isWebPlatform:oe.i.isWebPlatform()}).onAttachCloudFiles,er=wd.getInstance(),tr=er.getDocumentHandoffMessageId(),nr=(0,s._)((0,_t.useState)(!1),2),rr=nr[0],or=nr[1],ir=(0,M._S)(),ar=(0,s._)((0,_t.useState)(null),2),sr=ar[0],lr=ar[1],cr=(0,s._)((0,_t.useState)(!1),2),ur=cr[0],dr=cr[1],pr=(0,s._)(_t.useState(!1),2),fr=pr[0],hr=pr[1],gr=(0,s._)(_t.useState(!1),2),mr=gr[0],vr=gr[1],Sr=(0,s._)(_t.useState(""),2),Tr=Sr[0],wr=Sr[1],Ir=(0,s._)((0,_t.useState)({displayName:I.u1i,email:I.u1i}),2),Pr=Ir[0],_r=Ir[1],Ar=(0,s._)((0,_t.useState)(""),2),kr=Ar[0],xr=Ar[1],Nr=(0,s._)(_t.useState(V.Yj6.LAUNCH_WITH_REVIEWERS),2),Or=Nr[0],Dr=Nr[1];_t.useEffect((function(){ot.current=tt,_o()}),[tt]),_t.useEffect((function(){De.current=Ie}),[Ie]),_t.useEffect((function(){St.current=mt}),[mt]),_t.useEffect((function(){$e(Dt(Kt)),(0,ve.cY)("Feedback button is shown: "+Kt)}),[Kt]),_t.useEffect((function(){var e,t;xt?null===(e=no.current)||void 0===e||e.updateLoadingComponentProps({showStopGeneratingButton:!(0,Ye.dD)(),showInlineStopGeneratingButton:(0,Ye.dD)()}):null===(t=no.current)||void 0===t||t.updateLoadingComponentProps({showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})}),[xt]),_t.useEffect((function(){zh=Qt,So((function(e){return(0,a._)((0,i._)({},e),{isFluxFlowEnabled:Qt})})),qh.setIsFluxEnabled((0,We.FG)(Qt)),To((function(e){return(0,a._)((0,i._)({},e),{toggleUiProps:(0,a._)((0,i._)({},e.toggleUiProps),{trySydneyToggleChecked:void 0!==Qt&&Qt})})}))}),[Qt]),_t.useEffect((function(){var e=!ir&&fr;To((function(t){return(0,a._)((0,i._)({},t),{toggleUiProps:(0,a._)((0,i._)({},t.toggleUiProps),{reviewerAgentToggleChecked:e})})}))}),[fr]);var Lr=_t.useCallback((function(){dr(!0),(0,ve.cY)("handleReviewerAgentToggle User Query: ",Tr),setTimeout((function(){dr(!1)}),2e3)}),[]),Rr=_t.useCallback((function(e,t){var n=null==t?void 0:t.checked;(0,ve.cY)("Toggling Reviewer Agent to "+(n?"on":"off")),Yo(n?I.ZUM:I.ssU),hr(null!=n&&n),wr(""),vr(!1),Dr(V.Yj6.LAUNCH_FROM_TOGGLE),Lr()}),[Lr]);_t.useEffect((function(){To((function(e){return(0,a._)((0,i._)({},e),{streamingUiProps:{cardDataValue:qt}})}))}),[qt]);var Fr,Mr,Br,Ur=_t.useMemo((function(){var e=Zn.current.userPrincipalName;return new V.jYE({userPrincipalName:e,redirectUri:(0,ie.cn)(),logTelemetry:(0,M.bw)(M.WT.LogMSALTokenRequestTelemetry)})}),[Zn.current]),zr=_t.useMemo((function(){var e=Zn.current.userPrincipalName;return new V.jYE({userPrincipalName:e,redirectUri:(0,ie.cn)(),clientId:V.xkN,logTelemetry:(0,M.bw)(M.WT.LogMSALTokenRequestTelemetry)})}),[Zn.current]),Hr=function(e,t,n,r){return{trySydneyToggleOnChange:e,trySydneyToggleChecked:t,trySydneyToggleEnabled:!1,tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryReviewerAgentToggleOnChange:n,tryReviewerAgentToggleChecked:r,tryReviewerAgentToggleEnabled:(0,M.wB)()}}((function(e,t){var n=null==t?void 0:t.checked;(0,ve.cY)("Toggling Try Sydney to "+(n?"on":"off")),Jt(null!=n&&n)}),Qt,Rr,fr),Gr=function(){var e=(0,r._)((function(){var e,t;return(0,c.__generator)(this,(function(n){return e=(0,ve.zU)(It.current,2,Tt.current),Tt.current=e.slice(0,2),t=(0,ae.Vn)(Pt.current),qh.logSeenEvent(t,Pt.current,(0,ae.d3)(t)),To((function(e){return(0,a._)((0,i._)({},e),{suggestionPillsUiProps:(0,a._)((0,i._)({},e.suggestionPillsUiProps),{suggestionList:Tt.current})})})),[2]}))}));return function(){return e.apply(this,arguments)}}(),Vr=function(e,t){return{suggestionList:t?[(0,I.JDs)()]:[],showRefreshButton:!0,onRefreshButtonClicked:e}}(Gr,(0,M.bw)(M.WT.ShowPersonalizationSuggestionPill)&&Ne.Fn),jr=function(){Tt.current=It.current.slice(0,2),(0,ve.cY)("Setting suggestion list here...   ".concat(Tt.current)),To((function(e){return(0,a._)((0,i._)({},e),{suggestionPillsUiProps:(0,a._)((0,i._)({},e.suggestionPillsUiProps),{suggestionList:Tt.current})})}))},qr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:P.Ff.BasicChat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:X.SD.ChatQnA;(0,ve.cY)("Setting pill Bank to : ".concat(e)),It.current=e,e.length>0?(qh.logSeenEvent(n,t,(0,ae.d3)(n)),Pt.current=t):(0,M.bw)(M.WT.ShowPersonalizationSuggestionPill)&&Ne.Fn&&(It.current=[(0,I.JDs)()].concat((0,l._)(It.current))),jr()},Wr=(0,qa.eS)(f===A.G.defaultBlack,g),Yr={profile:w.pptChat,settings:{hostAppId:Rt(),hostAppName:"PowerPoint",hostAppPlatform:Ft(),hostAppScenario:"Copilot",hostDefaultLocale:(0,ee.hD)(oe.i.GetHostAppDisplayLanguage()),isDogfoodEnvironment:(0,re.I_)(),customizedEmptyECCSuggestionsString:PowerpointCopilotStrings.TransformDocumentCiqEmptyPlaceholderMessage,sessionId:null!==(Fr=vn.current)&&void 0!==Fr?Fr:qh.getCopilotChatSessionId(),useFluentV9:(0,M.bw)(M.WT.EditorFluentV9SettingEnabled)},telemLogger:{logError:function(e){(0,ve.cY)("Shared Copilot CIQ Error Log: ",e)}},telemSink:(0,M.bw)(M.WT.ShouldSendTelemetrySink)?P.MP.getInstance().getTelemetrySink():void 0,transformFileMenuTitle:PowerpointCopilotStrings.TransformDocumentCiqMenuTitle,transformFilePlaceholderText:PowerpointCopilotStrings.TransformDocumentPromptPlaceholder,entitiesSupported:[N.ck.File],isExpandedECCEnabled:!1,getSensitivityInfo:Mt.qH,onOpenGptStorefront:(0,M.PA)("IsAtMentionRedirectURLSetup")?(0,M.bw)(M.WT.IsAcquirePluginsFromMosEnabled)?V.KjQ:V.jPo:void 0,onAttachCloudFiles:$n,featureFlags:{enableAppGptsInCiq:(0,We.xw)(),enableAppPluginsInCiq:(0,We.x6)(),enableTopicECC:(0,We.OJ)(),enableAppMessageExtensionsInCiq:(0,We.Z5)(),enableAppPPInCiq:(0,We.Nr)(),enableAppTypeBInCiq:(0,We.V9)(),enableHydratedEntities:(0,M.PA)(M.IY.IsHydratedEntityEnabled),disablePluginsAsDAInFlyout:!(0,M.bw)(M.WT.ShowPluginAsDAInFlyout)}},Qr={settings:{hostAppId:Rt(),hostAppName:"PowerPoint",hostAppPlatform:Ft(),hostAppScenario:(0,M.PA)(M.IY.IsCreatePresentaionCIQAppScenarioEnabled)?"Copilot":void 0,hostDefaultLocale:(0,ee.hD)(oe.i.GetHostAppDisplayLanguage()),isDogfoodEnvironment:(0,re.I_)(),customizedEmptyECCSuggestionsString:PowerpointCopilotStrings.TransformDocumentCiqEmptyPlaceholderMessage,sessionId:null!==(Mr=vn.current)&&void 0!==Mr?Mr:qh.getCopilotChatSessionId(),enableAutomaticScoping:!0,useFluentV9:(0,M.bw)(M.WT.EditorFluentV9SettingEnabled)},telemLogger:{logError:function(e){(0,ve.cY)("Shared Copilot CIQ Error Log: ",e)}},telemSink:(0,M.bw)(M.WT.ShouldSendTelemetrySink)?P.MP.getInstance().getTelemetrySink():void 0,transformFileMenuTitle:PowerpointCopilotStrings.TransformDocumentCiqMenuTitle,transformFilePlaceholderText:PowerpointCopilotStrings.TransformDocumentPromptPlaceholder,entitiesSupported:[N.ck.People,N.ck.File,N.ck.Event,N.ck.Message],isExpandedECCEnabled:!0,getSensitivityInfo:Mt.qH,featureFlags:{enableAppGptsInCiq:(0,We.xw)(),enableAppPluginsInCiq:(0,We.x6)(),enableTopicECC:(0,We.OJ)(),enableAppMessageExtensionsInCiq:(0,We.Z5)(),enableAppPPInCiq:(0,We.Nr)(),enableAppTypeBInCiq:(0,We.V9)(),enableHydratedEntities:(0,M.PA)(M.IY.IsHydratedEntityEnabled),disablePluginsAsDAInFlyout:!(0,M.bw)(M.WT.ShowPluginAsDAInFlyout),enableSearchBar:(0,M.bw)(M.WT.EnableSearchBarInCIQECC)},onOpenGptStorefront:(0,M.PA)("IsAtMentionRedirectURLSetup")?(0,M.bw)(M.WT.IsAcquirePluginsFromMosEnabled)?V.KjQ:V.jPo:void 0,moreCopilotsStringOverride:(0,M.tm)()?(0,V.QAh)():void 0,onAttachCloudFiles:$n,inlineSuggestionsStyles:Fn},Jr=(0,_t.useCallback)((function(){if((0,We.vI)()){if((0,We.dV)())return[];var e=[];return(0,M.bw)(M.WT.EnableEnterpriseToggleInPhase2Ux)&&e.push({id:O.$.Work,onToggle:function(e){(0,ve.cY)("Microsoft M365 toggle is "+(e?"enabled":"turned off")),(0,kn.LA)(e),on(e)},state:rn?D.p.Enabled:D.p.Disabled}),e.push({id:O.$.Web,onToggle:function(e){(0,ve.cY)("Web Content toggle is "+(e?"enabled":"turned off")),mn(e),(0,kn.u$)(e),Hh?Hh=!1:((0,ve.cY)("Clearing suggestion list and cache on Grounding source change. Web Search:"+(e?"on":"off")),Oo(),qr([]))},state:gn?D.p.Enabled:D.p.Disabled}),e}}),[rn,gn]);if(re.Vv.IsSettingTrue(re.zj.PPTCIQDocMenuEnabled)&&(!(0,M.PA)(M.IY.EnableCIQWithUserTypeCheck)||Re&&(0,We.H_)())){var Xr=(0,M.bw)(M.WT.IsAllEntitiesSupported)&&(0,We.vI)();Br=Yr,Gh&&Xr&&(Br=rn?Qr:Yr)}var Kr=(0,je.$1)(qh),Zr=(0,je.PD)(Kr),$r=(0,je.ND)(Kr);(0,M.PA)(M.IY.UseSortedHVCTokenList)&&($r=(0,je.oe)($r));var eo=(0,_t.useCallback)((function(){return{chatPlaceholderMessage:(0,I.nnF)(),chatRestShyPlaceholderMessage:PowerpointCopilotStrings.AskAQuestionPlaceholder,transfromFileNonCIQPlaceholderMessage:PowerpointCopilotStrings.TransformWordDocumentNonCiqPlaceholder,menuProps:At,voiceInputProps:(0,Ye.dD)()?void 0:{voiceInputLocale:oe.i.GetHostAppDisplayLanguage(),microphonePermissionErrorMessage:(0,I.g_J)(),microphonePermissionErrorTitle:(0,I.Lz_)(),microphonePermissionImagePath:n(83226)},editorConfig:Br,buttonProps:{ciqButtonEnabled:(0,M.bw)(M.WT.IsCIQPaperClipButtonEnabled),groundingButtonEnabled:(0,We.vI)(),atMentionButtonEnabled:(0,We.r3)()},pluginsInfo:Jr(),characterLimitErrorMessage:(0,I.OKS)(),isHVCAppChatV2Enabled:(0,je.cA)(),hvcPromptStringsList:$r,isCardSpanWrappingEnabled:(0,M.PA)(M.IY.IsCardSpanWrappingEnabled),imageInputEnabled:(0,M.bw)(M.WT.IsImageInputEnabled),isImageInputButtonEnabled:(0,M.bw)(M.WT.IsImageInputEnabled),imageSizeLimitInMB:(0,M.PA)(M.IY.IsImageResizeEnabled)?(0,M.Z8)(M.WT.ImageSizeLimitInMBWhenResizing,10):(0,M.bw)(M.WT.UseImageSizeLimitInKB)?Math.round((0,M.Z8)(M.WT.ImageSizeLimitInKB,700)/1024*100)/100:(0,M.Z8)(M.WT.ImageSizeLimitInMB,1),isImageResizeEnabled:(0,M.PA)(M.IY.IsImageResizeEnabled),imageResizedSizeInKB:(0,M.Z8)(M.WT.ImageResizedSizeInKB,290),imageResizePreferredSizeInPx:JSON.parse((0,M.be)(M.WT.ImageResizePreferredSizeInPx,"[2000, 1024, 800, 512]")),imageResizeCompressionQuality:(0,M.Z8)(M.WT.ImageResizeCompressionQuality,85)/100,onChatInputHVCPromptUpdated:function(e,t){if(t){var n=(0,je.MD)(e,Zr);Ht(n),(0,ve.cY)("HVC PPTSupportedCommandCategory detected: ",n),Vt.current=!1}else!1===Vt.current&&(Ht(le.m.NotACommand),(0,ve.cY)("HVC PPTSupportedCommandCategory removed"))},onUserQuerySubmitted:function(){Vt.current=!0},insertImageFlags:{isImageFromPhoneButtonEnabled:(0,M.bw)(M.WT.IsUploadImageFromPhoneEnabled),isPasteFromClipboardButtonEnabled:(0,M.bw)(M.WT.IsPasteFromClipboardButtonEnabled)}}}),[rn,gn,At,Ie,Re]),to=_t.useMemo((function(){(0,ve.cY)("Updating host token provider");var e=(0,ve.$1)(Ie)?"AAD":"MSA";return{getToken:function(e){return(0,ie.gf)(Er.dW,e)},accountInfo:{userId:Ae.objectId,tenantId:Ae.tenantId},identityType:e,isEUDBUser:He}}),[Ie,Ae,He]),no=_t.useRef(null);W.t.getInstance().setChatRef(no);var ro=Ze.getInstance((function(e,t){return Lo.apply(this,arguments)}),(function(e,t){return Uo.apply(this,arguments)}),no,(function(e,t){return zo.apply(this,arguments)}),Nt,or,qr),oo=function(e,t,n){return(0,_t.useMemo)((()=>new Yt(t,e,n)),[t,e,n])}(no,ro,{handlePlanStartClicked:function(e){(0,ve.cY)("User requested to start plan. This is being called from CopilotChatShared in the office monorepo."+JSON.stringify(e)),(0,gt.mk)(e,no,Nt,ko,or,yn)},odslPlugins:Gt}),io=(0,s._)((0,_t.useState)(eo()),2),ao=io[0],so=io[1],lo=function(e,t,n,r,o,s,l){return(0,ve.cY)("Designer Init: useDesignerCard"),{DesignerCard:function(c){c.clientSessionId&&(t.sessionId=c.clientSessionId),c.turnId&&(t.correlationId=c.turnId),r&&r.accountInfo&&(c.objectId&&!r.accountInfo.userId&&(r.accountInfo.userId=c.objectId),c.tenantId&&!r.accountInfo.tenantId&&(r.accountInfo.tenantId=c.tenantId));var u=(0,M.bw)(M.WT.isOutputV2Enabled);return _t.createElement(_t.Suspense,{fallback:_t.createElement(yr,{size:"extra-tiny"})},u&&_t.createElement(Cr,null,I.ofi),_t.createElement(br,(0,a._)((0,i._)({},c),{insertImagesInCanvas:e,hostCallback:n,hostTokenProvider:r,clientSettings:t,handleDesignerHistoryEvent:o,handleDesignerError:s,handleDesignerTelemetry:l})))}}}(function(){var e=(0,r._)((function(e,t,n,r){return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,(0,Lt.eK)(e,null==t?void 0:t.description,null==t?void 0:t.altText,null==t?void 0:t.license,jh,null==t?void 0:t.isUrl,null==t?void 0:t.pac,(function(e,t,n){(0,ln.k)(e,no,yn,t,n,void 0,!0)}),n,r,Sn)];case 1:return o.sent(),[2]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),(0,Lt.NG)(),(function(e){(0,Lt.Gm)(e,no)}),to,(function(e){(0,Lt.Xg)(e,no)}),Lt.CS,Lt.le).DesignerCard;Ot.renderers.DesignerCard=lo;var co=ep($a,(0,r._)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,ts(no)];case 1:return e.sent(),[2]}}))}))).SketchCard;Ot.renderers.SketchCard=co;var uo=kh(no).TranslationCard;(0,M.bw)(M.WT.EnableCopilotTranslatePresentation)&&(Ot.renderers.TranslationCard=uo);var po,fo=(po=Fh.Zl,(0,V.cY_)("Interactive Summary Card Init: useInteractiveSummary"),{InteractiveSummaryCard:function(e){var t=e.initialSections;return t&&0!==t.length||(t=Oh.U.getInstance().getSectionsByQueryId(e.messageId)),_t.createElement(Rh,(0,a._)((0,i._)({},e),{headerText:PowerpointCopilotStrings.AssistantResponseSummarizePrefix,initialSections:t,handleToggleChange:po}))}}).InteractiveSummaryCard;(0,M.D$)()&&(Ot.renderers.InteractiveSummaryCard=fo);var ho,go,mo=(null===(t=H.n.getInstance())||void 0===t?void 0:t.shouldShowInDocSensitivityLabel())?null===(u=H.n.getInstance())||void 0===u?void 0:u.getInDocSensitiveLabelInfo():void 0,yo=(0,s._)((0,_t.useState)({citationTitle:(0,I.t28)(),isFluxFlowEnabled:Qt,sensitivityIndicatorData:mo?{tooltipText:null!==(ho=mo.description)&&void 0!==ho?ho:"",badgeText:null!==(go=mo.displayName)&&void 0!==go?go:"",iconType:mo.encryptionType!==V.TzT.None?L.JF.Encryption:L.JF.NonEncryption}:void 0,isCitationsEnabled:(0,M.PA)(M.IY.IsCitationsEnabled)}),2),vo=yo[0],So=yo[1],Co=_t.useMemo((function(){var e,t=V.DLk.getInstance();no.current&&t.setProxyOperator(null===(e=no.current)||void 0===e?void 0:e.executePluginOperation);return t}),[no.current]),bo=(0,s._)((0,_t.useState)({zeroQueryMessageV2Props:mt,chatInputV2Props:ao,toggleUiProps:Hr,suggestionPillsUiProps:Vr,streamingUiProps:{cardDataValue:qt},chatContainerUiProps:Ke,documentSensitivityProps:null===(d=H.n.getInstance())||void 0===d?void 0:d.getSensitivity(),copilotLabProps:(0,M.bw)(M.WT.IsSharedCopilotLabEnabled)?{isCopilotLabHeaderDisabled:!oe.i.isWebPlatform(),copilotLabLink:(0,Se.pe)(),facets:(0,M.PA)(M.IY.ShouldSendCopilotLabCategories)?(0,V.hUL)((0,Ne.Dz)()):void 0,handlePromptClick:(0,M.bw)(M.WT.IsRedirectToNBForCreatingNonGroundedPresentationEnabled)||(0,M.bw)(M.WT.IsRedirectToNBForCreatingGroundedPresentationEnabled)?m:void 0}:void 0,customMessageRenderers:Ot,changeTopicUiProps:{hideChangeTopicButton:(0,We.T$)()},chatHistoryUiProps:{enableChatHistoryV2:(0,We.pm)(),enableChatHistoryLocalStorage:(0,We.B_)(),isGptsEnabled:(0,We.jO)()},clientInfoProps:Zn.current?{clientInfo:Zn.current,taskModuleLauncher:Co.launchTaskModule.bind(null,(0,M.PA)(M.IY.ShouldLaunchTaskModuleInNewWindow))}:void 0,creditsUIProps:(0,M.bw)(M.WT.IsCreditsUIInternalEnabled)?{creditUpsellHandler:V.NnE,upsellFwdLinkId:(0,I.tMN)(),clientParam:(0,I.DPI)()}:void 0}),2),Eo=bo[0],To=bo[1];function wo(){return(wo=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,Ne.m4)(f,g)];case 1:return e=t.sent(),(0,ve.cY)("SDX ClientInfo : ",e),Zn.current=e,To((function(t){return(0,a._)((0,i._)({},t),{clientInfoProps:{clientInfo:e,taskModuleLauncher:Co.launchTaskModule.bind(null,(0,M.PA)(M.IY.ShouldLaunchTaskModuleInNewWindow))}})})),[2]}}))}))).apply(this,arguments)}(0,_t.useEffect)((function(){To((function(e){return(0,a._)((0,i._)({},e),{chatInputV2Props:(0,a._)((0,i._)({},e.chatInputV2Props),{isDisabled:rr})})}))}),[rr]),(0,_t.useEffect)((function(){yt(an(qe,Ie,!1,ot.current))}),[qe,Ie,bt]),(0,_t.useEffect)((function(){so(eo)}),[eo]),(0,_t.useEffect)((function(){var e;function t(){return(t=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return(0,ve.$1)(Ie)?[4,(e=H.n.getInstance(So)).setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2];case 1:t.sent(),e.setLabelChangeEventListener(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}(0,ve.sZ)(),Io(),(0,fn.LN)(),_o(),qh.setCopilotChatSessionId(null!==(e=vn.current)&&void 0!==e?e:I.u1i),function(){t.apply(this,arguments)}(),null==Vh||Vh.addHandlerCleanup(pt.hi),null==Vh||Vh.addHandlerCleanup(ft.Cg),null==Vh||Vh.addHandlerCleanup(dt.hn),(0,re.IZ)().then((function(e){Zt(e)}));var n=re.Vv.getSettingAsString(re.zj.ChatPPTSessionID);(0,ve.cY)("ChatPPT Session Id - "+((0,Se.hX)(n)?I.u1i:n)),re.Vv.IsSettingTrue(re.zj.PPTCreatorEnabled)&&(0,Ne.K4)(no,ko),(0,M.PA)(M.IY.ShouldSupportHVCDetectionOnClientSide)&&(ro.setHVCPromptStringsList($r),ro.setHVCPromptToHVCCategoryMap(Zr)),ir&&(0,r._)((function(){var e,t,n,r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,ro.getALSession()];case 1:return e=o.sent(),[4,Qu()];case 2:return t=o.sent(),[4,oe.i.getDocumentUrlAsync()];case 3:return n=o.sent(),lr(e),_r(t),xr(n),[3,5];case 4:return r=o.sent(),Bh.error("Failed to fetch session:",r),[3,5];case 5:return[2]}}))}))()}),[]),(0,_t.useEffect)((function(){!function(){var e;To({zeroQueryMessageV2Props:mt,chatInputV2Props:ao,toggleUiProps:Hr,suggestionPillsUiProps:Vr,streamingUiProps:{cardDataValue:qt},chatContainerUiProps:Ke,documentSensitivityProps:null===(e=H.n.getInstance())||void 0===e?void 0:e.getSensitivity(),copilotLabProps:(0,M.bw)(M.WT.IsSharedCopilotLabEnabled)?{isCopilotLabHeaderDisabled:!oe.i.isWebPlatform(),copilotLabLink:(0,Se.pe)(),facets:(0,M.PA)(M.IY.ShouldSendCopilotLabCategories)?(0,V.hUL)((0,Ne.Dz)()):void 0,handlePromptClick:(0,M.bw)(M.WT.IsRedirectToNBForCreatingNonGroundedPresentationEnabled)||(0,M.bw)(M.WT.IsRedirectToNBForCreatingGroundedPresentationEnabled)?m:void 0}:void 0,customMessageRenderers:Ot,changeTopicUiProps:{hideChangeTopicButton:(0,We.T$)()},chatHistoryUiProps:{enableChatHistoryV2:(0,We.pm)(),enableChatHistoryLocalStorage:(0,We.B_)(),isGptsEnabled:(0,We.jO)()},clientInfoProps:Zn.current?{clientInfo:Zn.current,taskModuleLauncher:Co.launchTaskModule.bind(null,(0,M.PA)(M.IY.ShouldLaunchTaskModuleInNewWindow))}:void 0,creditsUIProps:(0,M.bw)(M.WT.IsCreditsUIInternalEnabled)?{creditUpsellHandler:V.NnE,upsellFwdLinkId:(0,I.tMN)(),clientParam:(0,I.DPI)()}:void 0})}()}),[ao,mt,Re]),(0,_t.useEffect)((function(){var e,t,n;Cn&&Kn({conversationId:En,telemetryData:In,isDebugToggleEnabled:Cn,sessionId:ft.Ob,conversationLogObject:On,sydneyConversationObject:Hn,debugMessageInfoObject:Yn,showDebugInfoMessage:jn,setShowDebugInfoOnMessage:qn,sdxVersion:(0,Se.QV)(),augloopKustoQueryURL:(e=ft.Ob,t="\n    let workflows = split('',',');\n    let audienceGroup = split('''',',');\n    let platforms = split('''',',');\n    WorkflowOperationEvent\n    | where operationName in (\"ActionAIExec\", \"FluxCopilot\")\n    | where TIMESTAMP > ago(1d)\n    | where resourceId in  (\"PowerPointFluxCopilot\")\n    | where  workflows[0] == '' or resourceId in~ (workflows)\n    | where  audienceGroup[0] == '' or clientReleaseAudienceGroup in~ (audienceGroup)\n    | where platforms[0] == '' or clientAppPlatform in~(platforms)\n    | extend extraFields = parse_json(dataFields)\n    | extend errMsg = tostring(extraFields[\"errMsg\"]), isChatHistory = tobool(extraFields[\"isOnlyChatHistorySignal\"])\n    | where isChatHistory != true\n    | extend queryId = tostring(extraFields[\"queryId\"])\n    | where isnotempty(queryId)\n    | extend errorName = case (isnotempty(tostring(extraFields[\"errorName\"])),tostring(extraFields[\"errorName\"]),\n                            isnotempty( tostring(extraFields[\"skillErrorName\"])), tostring(extraFields[\"skillErrorName\"]),\"Unknown\")\n    | extend errMsg = strcat(errMsg, '::')\n    | parse errMsg with endReason ':' errCode ':' *\n    | extend errorCategory = case(\n        success == 1, 'Success',\n        errMsg == '::', 'Success',\n        endReason in ('InputQueryError', 'UnsupportedLanguageError', 'Text2ImageError', 'OffensiveContent'), 'User',\n        endReason in ('ActionAIError', 'LicensingError', 'ResolveDelegationsError', 'InferenceAPIError', 'unexpected', 'ODSLSyntaxError', 'ODSLParseError', 'TokenCountError'), 'System',\n        'Uncategorized'\n    )\n    | extend Category = case(errorCategory == \"Success\", errorCategory,\n                            endReason == \"SkillFailedError\", strcat(endReason, \"-\", errCode, \"-\", errorName),\n                            endReason == \"SydneyError\", strcat(endReason, \"-\", errCode ),\n                            endReason)\n    | where sessionKey == '".concat(e,"'\n    | project sessionKey, clientSessionId, queryId, workflow, errorName, endReason, errCode, Category, errorCategory,extraFields\n    "),n=ja(t),{name:"Augloop Operations",description:"Get FluxCopilot operation for a given session id",linkUrl:"https://dataexplorer.azure.com/clusters/https%3a%2f%2fodxaugloop.eastus.kusto.windows.net/databases/ODX%20AugLoop%20Service?query=".concat(n),query:t}).linkUrl,clientKustoQueryURL:Va(ft.Ob).linkUrl})}),[En,In,On,Hn,jn,Yn,ft.Ob]),(0,_t.useEffect)((function(){((0,M.bw)(M.WT.IsMsgExtEnabled)||(0,M.bw)(M.WT.IsApiPluginsCardsEnabled)||(0,M.bw)(M.WT.IsCloudFileUploadEnabled)||(0,M.bw)(M.WT.IsLocalFileUploadEnabled)||(0,M.bw)(M.WT.IsUploadImageFromPhoneEnabled))&&function(){wo.apply(this,arguments)}()}),[f,g]);var Io=function(){var e=re.Vv.getSettingAsString(re.zj.PPTDocumentState),t=null;try{t=JSON.parse(e)}catch(e){return void(0,ve.cY)("failed in parsing json for document state",e.message)}(0,ve.cY)("Received document state from Host App Settings ".concat(e)),(0,Se.hX)(t)||ue._.getInstance().setDocumentState(t)},Po=function(){var e=ue._.getInstance().getSlideCount();Et(e);var t=Z.Ns.BLANK;return e>1&&!ue._.getInstance().isCreatePresentationEnabled()&&(t=ot.current>=(0,lt.i$)()?Z.Ns.USED:Z.Ns.LESS_WORD_COUNT),t},_o=function(){var e=Po();Qe(e),(0,ve.cY)("Presentation type set : ",e)},Ao=function(){var e=(0,r._)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,PowerPoint.run(function(){var e=(0,r._)((function(e){var t,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return(t=e.presentation.getSelectedSlides()).load({select:"id,items"}),[4,e.sync()];case 1:return r.sent(),(n=t.items.length)>1?(e.presentation.setSelectedSlides([t.items[n-1].id]),[4,e.sync()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),ko=function(){var e=(0,r._)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,Ao()];case 1:return e.sent(),oe.i.GetHostAppPlatform()===I.nAd||oe.i.GetHostAppPlatform()===I.xb6||oe.i.GetHostAppPlatform()===I.TTX?Office.context.ui.executeFeature(I.Vii):Ce({type:U.ChatPPTShowDesigner,message:""}),[2]}}))}));return function(){return e.apply(this,arguments)}}(),xo=function(e,t){var n,r;(Uh=e,Pe(e),Ue(!0),Ge(t),Jt((0,We.b8)()),So((function(e){return(0,a._)((0,i._)({},e),{isFluxFlowEnabled:(0,We.b8)()})})),(0,ve.sQ)(e))?qh.sendChatEventTelemetry((0,rt.pN)((n={},(0,o._)(n,P.h3.ChatEventType,P.a5.PrimaryUserType),(0,o._)(n,P.h3.ChatEventParameters,"Consumer"),n))):qh.sendChatEventTelemetry((0,rt.pN)((r={},(0,o._)(r,P.h3.ChatEventType,P.a5.PrimaryUserType),(0,o._)(r,P.h3.ChatEventParameters,V.utd[e]),r)))},No=function(e){nt(e),jr()},Oo=function(){To((function(e){return(0,a._)((0,i._)({},e),{suggestionPillsUiProps:(0,a._)((0,i._)({},e.suggestionPillsUiProps),{clearCacheSuggestionPills:!0})})}))};function Do(){return Do=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){e=(0,Lt.Bx)("00000000-0000-0000-0000-000000000000");try{Office.context.auth.getAuthContextAsync((function(t){if("succeeded"===t.status){var n=t.value;if(n){var r=n.userObjectId||Ae.objectId,o=n.tenantId||Ae.tenantId;ke({objectId:r,tenantId:o})}else(0,ve.cY)("Authcontext is undefined"),xe.B.getInstance().sendErrorTelemetry((0,l._)(e).concat([{key:P.IC.ErrorCategory,value:P.S2.Designer},{key:P.IC.ErrorMessage,value:"Authcontext fetched from OfficeJS is undefined"}]))}else{(0,ve.cY)("Failed to fetch user id from OfficeJS with status: ",t.status);var i="";try{i=JSON.stringify(t)}catch(e){i="".concat(t)}xe.B.getInstance().sendErrorTelemetry((0,l._)(e).concat([{key:P.IC.ErrorCategory,value:P.S2.Designer},{key:P.IC.ErrorMessage,value:"Failed to fetch user object from OfficeJS. Status=".concat(t.status,". Result=").concat(i)}]))}}))}catch(t){(0,ve.cY)("Error getting user id: "+t),xe.B.getInstance().sendErrorTelemetry((0,l._)(e).concat([{key:P.IC.ErrorCategory,value:P.S2.Designer},{key:P.IC.ErrorMessage,value:"Error thrown while fetching user Object. Message=".concat(t.message)},{key:P.IC.ErrorCode,value:t.code}]))}return[2]}))})),Do.apply(this,arguments)}function Lo(){return Lo=(0,r._)((function(e,t){var n,r,o,i=arguments;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:I.u1i,(0,ve.cY)("handleResponseItem cv: ",n),(0,M.V7)()||(n=""),!(null===(r=e.body)||void 0===r?void 0:r.H_))return[3,44];switch(e.body.H_.T_){case Y.YO.getTypeName():return[3,1];case ce.c.getTypeName():return[3,3];case G.yG.getTypeName():return[3,5];case G.SB.getTypeName():return[3,7];case G.kb.getTypeName():return[3,9];case j.yg.getTypeName():return[3,11];case ye.f.getTypeName():return[3,13];case j.P0.getTypeName():return[3,15];case ye.i.getTypeName():return[3,17];case se.B.getTypeName():return[3,19];case fe.C.getTypeName():return[3,21];case pe._t.getTypeName():return[3,23];case ge.x.getTypeName():return[3,25];case Y.N6.getTypeName():return[3,27];case Y.kD.getTypeName():return[3,29];case Fe.a.getTypeName():return[3,31];case Q.i.getTypeName():return[3,33];case de.c.getTypeName():return[3,35];case te.uC.getTypeName():return[3,36];case he.T.getTypeName():return[3,37];case Oe.F.getTypeName():return[3,39];case Me.H.getTypeName():return[3,41];case Be.l.getTypeName():return[3,42];case q.k.getTypeName():return[3,43]}return[3,44];case 1:return Vh.removeContextId(null===(o=e.body)||void 0===o?void 0:o.queryId),[4,(0,gt.ci)(e,no,Nt,ko,t,or,yn,n)];case 2:case 4:case 6:case 8:case 10:case 12:case 14:case 16:case 18:case 20:case 22:case 24:case 26:case 28:case 30:case 32:case 34:case 38:case 40:return a.sent(),[3,44];case 3:return[4,(0,ft.Mb)(e,no,Nt,ko,qr,t,or,Tn,y,yn,Zn.current,en,n,tt,qn,Qn,v)];case 5:return[4,(0,ct.SQ)(e,no,tt,t,n)];case 7:return[4,(0,pt.UP)(e,no,tt,n)];case 9:return[4,(0,pt.R1)(e,no,tt,n,qn,Qn,v)];case 11:return[4,(0,ht.O0)(e,no,n)];case 13:return[4,Pn(e,no,ko,Nt,Oo,yn,n)];case 15:return[4,(0,dt.lY)(e,no,n)];case 17:return[4,An(e,no)];case 19:return[4,(0,un.N)(e,no,ko,Nt,yn,n)];case 21:return[4,(0,Nh.y)(e,no,ko,Nt,yn,n)];case 23:return[4,(0,xn.Z)(e,no,ko,Nt,Oo,yn,n)];case 25:return[4,(0,pn.$)(e,no,ko,Nt,yn)];case 27:return[4,vt(e,t,n)];case 29:return[4,wt(e,no)];case 31:return[4,(0,lt.ZT)(e,No,n)];case 33:return[4,st(e,xo,n)];case 35:return ue._.getInstance().powerpointDocumentStateAnnotationProcessor(e,_o),[3,44];case 36:return er.handleHandoffMessage(e,n),[3,44];case 37:return[4,(0,dn.t)(e,no,Nt,yn,n)];case 39:return[4,(0,zn.XY)(e,no)];case 41:return(0,V.RBg)(e,xe.B.getInstance().getQuerySubmitTime(),Ne.ZB,no,n),[3,44];case 42:return(0,Hu.rp)(e,no,n),[3,44];case 43:return ns(e,no),[3,44];case 44:return[2]}}))})),Lo.apply(this,arguments)}function Ro(){return(Ro=(0,r._)((function(e){var t,n,r,i;return(0,c.__generator)(this,(function(a){(0,ve.cY)("Handoff message from host app: ",e),t=null;try{t=JSON.parse(e)}catch(e){return(0,ve.cY)("failed in parsing json for handoff message",e.message),qh.sendChatEventTelemetry((0,rt.pN)((n={},(0,o._)(n,P.h3.ChatEventType,P.Nr.HandoffMessageFromHostAppSettingsError),(0,o._)(n,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(n,P.h3.ChatErrorParameters,e.message),n))),[2]}return(0,ve.cY)("Received handoff message from Host App Settings ".concat(t)),!(0,Se.hX)(t)&&t.items&&t.items.length>0&&t.items[0]?(er.handleHandoffMessage(t.items[0],""),[2]):(r="invalid operation for handoff message",(0,ve.cY)(r),qh.sendChatEventTelemetry((0,rt.pN)((i={},(0,o._)(i,P.h3.ChatEventType,P.Nr.HandoffMessageFromHostAppSettingsError),(0,o._)(i,P.h3.ChatErrorType,Z.T_.Client),(0,o._)(i,P.h3.ChatErrorParameters,r),i))),[2])}))}))).apply(this,arguments)}function Fo(){return(Fo=(0,r._)((function(){var e,t,n,r,o;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return re.Vv.IsSettingTrue(re.zj.TriggerCreatePresentationAbout)?((0,ve.cY)("TriggerCreatePresentationAbout host setting is true"),qh.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerCreatePresentationAboutCalled}]),null===(e=no.current)||void 0===e||e.setInputAreaText(PowerpointCopilotStrings.PreFilledPromptGuideItemCreateAPresentationAbout)):re.Vv.IsSettingTrue(re.zj.TriggerCreatePresentationFromFile)?((0,ve.cY)("TriggerCreatePresentationFromFile host setting is true"),qh.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerCreatePresentationFromFileCalled}]),null===(t=no.current)||void 0===t||t.setInputAreaText(PowerpointCopilotStrings.PreFilledPromptGuideItemCreatePresentationFrom)):re.Vv.IsSettingTrue(re.zj.TriggerAddASlide)?((0,ve.cY)("TriggerAddASlide host setting is true"),qh.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.TriggerAddASlideCalled}]),null===(n=no.current)||void 0===n||n.setInputAreaText(PowerpointCopilotStrings.PreFilledPromptGuideItemAddASlideAbout)):re.Vv.IsSettingTrue(re.zj.TriggerSummary)?((0,ve.cY)("TriggerSummary host setting is true"),$.R.getInstance().setState(Z.Nj.EXECUTING),(0,ve.cY)("Calling common core component to trigger summary for nudge"),(0,V.Dl2)(),null===(r=no.current)||void 0===r||r.submitUserQuery({text:PowerpointCopilotStrings.PromptMenuItemSummarize}),(0,M.PA)(M.IY.ShouldStopOpenPaneWithSummaryScenario)&&re.Vv.set(re.zj.TriggerSummary,!1)):null!=re.Vv.getSettingAsString(re.zj.TriggerCshCopilot)&&((0,ve.cY)("TriggerCshCopilot host setting has a PromptIdGuid defined"),cd(re.Vv.getSettingAsString(re.zj.TriggerCshCopilot),no,qh)),(o=re.Vv.getSettingAsString(re.zj.PPTHandoffMessage))?[4,S(o)]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))).apply(this,arguments)}(0,_t.useEffect)((function(){null==ro||ro.setHVCPromptDetected(zt)}),[zt]),(0,Wa.A)(C);var Mo=function(){var e=(0,r._)((function(){var e,t,n,r;return(0,c.__generator)(this,(function(o){return n=W.t.getInstance().getChatRef(),(r=document.getElementsByClassName(I.fw9))&&r.length&&r[0].focus(),null===(e=n.current)||void 0===e||e.setInputFocus(),null===(t=n.current)||void 0===t||t.scrollToBottom(),[2]}))}));return function(){return e.apply(this,arguments)}}();(0,Wa.A)(Mo);var Bo=function(){var e=(0,r._)((function(){var e,t,n,r;return(0,c.__generator)(this,(function(o){return e=(0,M.bw)(M.WT.EnableNewZQMsForNewPresentation),t=(0,M.bw)(M.WT.EnableNewZQMsForExistingPresentation),(e||t)&&(n=Po(),r=an(n,Ie,!0,ot.current),yt(r)),[2]}))}));return function(){return e.apply(this,arguments)}}();function Uo(){return Uo=(0,r._)((function(e,t){var n,r,i,a,s,l,u,d,p,f,h,g,m,y,v,S,b,E;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:switch((0,ve.cY)("Event Received from sharedCopilot, Event: ".concat(e)),e){case N.PV.CreateNewConversationButtonClicked:return[3,1];case N.PV.CopilotChatLoaded:return[3,2];case N.PV.AugloopResponseTimeout:return[3,4];case N.PV.AnnotationActivated:return[3,5];case N.PV.StopGeneratingButtonClicked:return[3,12];case N.PV.QueryEndOnGptSwitch:return[3,13];case N.PV.CitationLinkClicked:return[3,14];case N.PV.BasicChatStatus:return[3,15];case N.PV.ChatTopicChanged:return[3,16];case N.PV.BasicChatSuggestionPills:return[3,17];case N.PV.ChatHistoryHydrationFailed:return[3,18];case N.PV.QuerySubmitted:return[3,19];case N.PV.ResetContextId:return[3,20];case N.PV.PluginsStateUpdated:return[3,21];case N.PV.SharedHeaderRendered:return[3,22]}return[3,23];case 1:return Bo(),[3,23];case 2:return t&&t&&(n=t.gptId,(0,ve.cY)("Current Selected Copilot Extension Id: ".concat(n)),(0,Ne.P7)(null!=n?n:I.u1i),(0,V.gIB)(n)&&Bt(!0)),(0,ve.sZ)(),function(){Do.apply(this,arguments)}(),(0,M.bw)(M.WT.IsTriggerPptVisualOperationEnabled)&&!Mh.isSDXRenderingForPreload&&(0,xh.Q)(),(0,Ne.YY)(no),jh.setTelemetryHandler(qh),(0,rt.ud)(qh),[4,C()];case 3:return c.sent(),[3,23];case 4:return Vh.isRequestPending()?(Vh.emptyContextIdListandCleanup(),(null==t?void 0:t.workflowAnnotationType)!==G.SB.getTypeName()&&(null==t?void 0:t.workflowAnnotationType)!==G.kb.getTypeName()||(0,pt.lb)(no),(i=(0,ae.q5)(null==t?void 0:t.workflowAnnotationType))===X.Cu.BasicChat?[2]:(jh.setScenarioName(i),a=jh.getFeatureName(),qh.logTriedEvent(a,P.Ff.Unset,(0,ae.d3)(a)),(0,hn.k)(!1,P.a5.AugloopResponseTimeout),s=P._5.UnclearIntent,l=P.G8.ResponseDelayedOrTimedOut,u=P.f3,i===X.Cu.Summary&&(s=P._5.Summarize),qh.logAshaErrorEvent((0,rt.A9)(s,l),u,i),d={errorMessage:PowerpointCopilotStrings.ErrorInExecution,errorType:Z.Qp.ResponseDelayedOrTimedOut,featureName:a,subFeatureName:P.Ff.Unset},null===(r=no.current)||void 0===r||r.addResponseMessage((0,ut.qi)(PowerpointCopilotStrings.ErrorInExecution,ut.OT,!0,Z.Xw.CHATPPT,void 0,!1,!0,void 0,d)),[3,23])):[2];case 5:return t?((0,ve.cY)("Annotation Activated: ".concat(t.workflowAnnotationType)),t.workflowAnnotationType!==Fe.a.getTypeName()?[3,7]:[4,(0,lt.Ep)(no)]):[3,23];case 6:return c.sent(),[3,11];case 7:return t.workflowAnnotationType!==te.dF.getTypeName()?[3,8]:(er.sendHandoffDocUrlSignal(),[3,11]);case 8:return t.workflowAnnotationType!==te.uC.getTypeName()?[3,9]:(er.sendHandoffMessageId(ne.Q.GET,tr),[3,11]);case 9:return t.workflowAnnotationType!==Q.i.getTypeName()?[3,11]:[4,at(no)];case 10:c.sent(),c.label=11;case 11:return[3,23];case 12:return(0,ve.cY)("Stop Generation Clicked."),(0,Ne.qe)(no,!0,P.a5.StopGeneratingButtonClicked,P.z_.UserAbortedQueryExecution,R.dB,en,yn,Nt,tn),[3,23];case 13:return(0,ve.cY)("Query End On Gpt Switch event received"),(0,z.og)().enableQueryEndOnGptSwitch&&(0,Ne.qe)(no,!1,P.a5.QueryEndOnGptSwitch,P.z_.GptSwitchAbortedQueryExecution,R.dB,en,yn,Nt,tn),[3,23];case 14:return p=t.referencePath,(0,Ne.P3)(p),[3,23];case 15:return tn(!0),t.status===N.y2.Started?jh.setScenarioName(X.Cu.BasicChat):t.status===N.y2.Finished&&(0,hn.k)(!0,void 0,X.Cu.BasicChat),[3,23];case 16:return(0,ve.cY)("Chat Topic Changed: ",t),$.R.getInstance().setState(Z.Nj.IDLE),J.R.getInstance().getIsWarningMessageActive()&&(0,cn.A)(no),h={featureName:P.CC.CopilotChat},null===(f=no.current)||void 0===f||f.addResponseMessage((0,ut.qi)(PowerpointCopilotStrings.TopicChangedResponseMessage,ut.tc,!0,Z.Xw.CHATPPT,void 0,!1,!0,void 0,h)),Oo(),qr([]),[3,23];case 17:return(0,ve.cY)("BasicChat SuggestionPills event triggered: ",t),(g=t).suggestionPills&&0!==g.suggestionPills.length?qr(g.suggestionPills):(0,ve.cY)("No suggestions returned by Basic Chat workflow"),(0,V.tpg)()&&(0,V._Qu)(no),[3,23];case 18:return(0,We.vf)()&&(0,We.yV)()&&(y={errorMessage:OfficeaicopilotStrings.ChatHistoryHydrationError,errorType:Z.Qp.ChatHistoryHydrationError,featureName:P.CC.CopilotChat,subFeatureName:void 0},null===(m=no.current)||void 0===m||m.addResponseMessage((0,ut.qi)(OfficeaicopilotStrings.ChatHistoryHydrationError,ut.OT,!(re.Vv.IsSettingTrue(re.zj.TriggerSummary)&&re.Vv.IsSettingTrue(re.zj.TriggerAddASlide)&&re.Vv.IsSettingTrue(re.zj.TriggerCreatePresentationAbout)&&re.Vv.IsSettingTrue(re.zj.TriggerCreatePresentationFromFile)),Z.Xw.CHATPPT,void 0,!1,!1,void 0,y))),[3,23];case 19:return(0,ve.cY)("QuerySubmitted event triggered: ",t),t&&t.workflowAnnotationType!==rs.T.getTypeName()&&(yn.current=!1,tn(!1)),[3,23];case 20:return(0,ve.cY)("CopilotEvent ResetContextId received"),Vh.emptyContextIdListandCleanup(),[3,23];case 21:return Gh=!0,v=(0,We.vI)()&&!(0,M.bw)(M.WT.EnableEnterpriseToggleInPhase2Ux)&&(0,M.PA)(M.IY.IsEnterpriseSearchDefaultOn),S=!1,v&&(S=t.pluginsInfo.findIndex((function(e){return e&&e.id===I.VMi&&e.state===I.hiv}))>=0)&&((0,kn.LA)(!0),xe.B.getInstance().sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.GroundingSourceUpdated},{key:P.h3.ChatEventParameters,value:"Work:AutoOn"}])),on(S),[3,23];case 22:return(0,M.bw)(M.WT.IsCopilotSharedHeaderEnabled)&&(window.StaticHeaderLoadTime||function(){xd.apply(this,arguments)}(),xe.B.getInstance().sendLatencyTelemetry((0,rt.pN)((E={},(0,o._)(E,P.CT.StaticSharedHeaderLoadTimeInMs,null!==(b=window.StaticHeaderLoadTime)&&void 0!==b?b:""),(0,o._)(E,P.CT.SharedHeaderLoadTimeInMs,window.performance.now()),E)))),[3,23];case 23:return[2]}}))})),Uo.apply(this,arguments)}function zo(){return zo=(0,r._)((function(e,t){var n,r,i,a,l,u,d,p,f,h,g,m,y,v,S,C,b;return(0,c.__generator)(this,(function(c){switch(e){case N.Yk.ZQMLoaded:(0,ae.Qj)(null===(n=St.current)||void 0===n?void 0:n.promptSuggestionList),qh.sendChatEventTelemetry((0,rt.pN)((r={},(0,o._)(r,P.h3.ChatEventType,P.a5.ZQMV2Loaded),(0,o._)(r,P.h3.ChatEventParameters,(new Date).getTime().toString()),r)));break;case N.Yk.MenuButtonItemClicked:t.suggestionClicked===I.UeP.addEnterpriseImage()&&qh.sendChatEventTelemetry([{key:P.h3.ChatEventType,value:P.a5.AddEnterpriseImageClicked}]);break;case N.Yk.MenuButtonItemClickedL1:(0,ae.UZ)(null!==(i=t.suggestionClicked)&&void 0!==i?i:"",ot.current,De.current);break;case N.Yk.AugloopErrorReceived:t.annotationName!==K.KJ.getTypeName()&&t.annotationName!==K.Ob.getTypeName()||(l=t.annotationName===K.KJ.getTypeName()?"BasicChatWorkflow_":"BasicChatStreamingWorkflow_"+JSON.parse(null!==(a=t.chatEventParams)&&void 0!==a?a:"").errorCategory,(0,hn.k)(!1,l,X.Cu.BasicChat));break;case N.Yk.ZQMButtonItemClicked:qh.sendChatEventTelemetry((0,rt.pN)((0,o._)({},P.h3.ChatEventType,P.a5.ZQMV2CardClicked)));break;case N.Yk.AugloopResponseReceived:u=(null==t?void 0:t.timeInMs)?(null==t?void 0:t.timeInMs)/1e3:0,p=null!==(d=null==t?void 0:t.annotationName)&&void 0!==d?d:"",(0,ft.K2)(p,u);break;case N.Yk.InputAreaTextChangedToEmpty:case N.Yk.SuggestionPillClicked:case N.Yk.QueryExecutionCompleted:if(Ht(le.m.NotACommand),N.Yk.QueryExecutionCompleted===e&&((0,pt.hi)(),(0,dt.hn)(),(0,M.bw)(M.WT.IsNotificationEnabledForSummary))){f=!0,h=!1,g=void 0;try{for(m=ed.YT.entries()[Symbol.iterator]();!(f=(y=m.next()).done);f=!0)v=(0,s._)(y.value,2),S=v[0],v[1],(0,Hu.l3)(S)&&Gu.A.updateActiveCardForCompleteNotification(S,no)}catch(e){h=!0,g=e}finally{try{f||null==m.return||m.return()}finally{if(h)throw g}}}break;case N.Yk.VoiceCopilotConnectionStarted:xe.B.getInstance().sendChatEventTelemetry((0,rt.pN)((C={},(0,o._)(C,P.h3.ChatEventType,e),(0,o._)(C,P.h3.ChatEventParameters,t.timestamp),C))),xe.B.getInstance().sendLatencyTelemetry((0,rt.pN)((0,o._)({},P.CT.FeatureName,P.CC.ConversationalCopilot)));break;case N.Yk.VoiceCopilotSessionInitialMessageSent:case N.Yk.VoiceCopilotSessionStarted:case N.Yk.VoiceCopilotUserSpeechStarted:case N.Yk.VoiceCopilotUserSpeechStopped:case N.Yk.VoiceCopilotStateChanged:case N.Yk.VoiceCopilotResponseReceived:case N.Yk.VoiceCopilotPlaybackGlitchDetected:case N.Yk.VoiceCopilotFirstBufferReceived:case N.Yk.VoiceCopilotFinishedPlayerBuffer:case N.Yk.VoiceCopilotSessionStopped:case N.Yk.VoiceCopilotError:xe.B.getInstance().sendChatEventTelemetry((0,rt.pN)((b={},(0,o._)(b,P.h3.ChatEventType,e),(0,o._)(b,P.h3.ChatEventParameters,t.chatEventParams),b)))}return[2]}))})),zo.apply(this,arguments)}!function(e){_t.useEffect((function(){var t=Je.w.subscribe(e);return function(){t()}}),[])}(Bo);var Ho=(0,M.PA)("IsHandleTabKeyEnabled")?function(e){"Tab"===e.key&&e.stopPropagation()}:void 0,Go=(0,s._)(_t.useState((function(){var e=[];return(0,M.bw)(M.WT.IsSwitcherMenuContainerEnabled)||e.push({id:I.ssU,name:I.qQp,isSelected:!0,isDefaultCopilot:!0,menuIcon:_t.createElement(V.eU_,null)}),ir&&e.push({id:I.ZUM,name:I.B9B,isSelected:!1,isDefaultCopilot:!1,copilotType:B.NV.ClientProvided,copilotComponent:_t.createElement(Vu,{alSession:sr,onReviewerAgentToggleChange:Rr,onApplySuggestion:ju,userQuery:Tr,addCommentToFirstLineOfDocument:Wu,onSuggestionCardNavigation:$u,isDarkModeEnabled:Wr.isDarkModeEnabled,isHighContrastModeEnabled:Wr.isHighContrastModeEnabled,documentURL:kr,authorName:Pr.displayName,authorEmail:Pr.email,isReviewerNotAddedButtonClicked:mr,getDocumentSensitivity:Xu,agentLaunchType:Or,peoplePickerEditorConfig:Zu()}),menuIcon:_t.createElement(V.T$y,null),iconAltText:I.B9B}),e})),2),Vo=Go[0],jo=Go[1],qo=(0,s._)(_t.useState(I.ssU),2),Wo=qo[0],Yo=qo[1],Qo=function(e){if((0,ve.cY)("handleCopilotChatChange in client",e),e!==I.Zor){var t=Vo.map((function(t){return e===I.ZUM?(0,a._)((0,i._)({},t),{copilotComponent:_t.createElement(Vu,{alSession:sr,onReviewerAgentToggleChange:Rr,onApplySuggestion:ju,userQuery:Tr,addCommentToFirstLineOfDocument:Wu,onSuggestionCardNavigation:$u,isDarkModeEnabled:Wr.isDarkModeEnabled,isHighContrastModeEnabled:Wr.isHighContrastModeEnabled,documentURL:kr,authorName:Pr.displayName,authorEmail:Pr.email,isReviewerNotAddedButtonClicked:mr,getDocumentSensitivity:Xu,agentLaunchType:Or,peoplePickerEditorConfig:Zu()}),isSelected:t.id===e}):(0,a._)((0,i._)({},t),{isSelected:t.id===e})}));jo(t),Yo(e)}else(0,V.iBH)((0,M.dA)(),(0,M.bw)(M.WT.IsAcquirePluginsFromMosEnabled))},Jo=(0,s._)(_t.useState(void 0),2),Xo=Jo[0],Ko=Jo[1],Zo=function(e){(0,ve.cY)("handleActivateCopilotAgentFromHost in client ",e.titleId),Ko({appId:e.titleId})};_t.useEffect((function(){V.BDr.getInstance().attachPrivateEventHandler("activateCopilotAgent",Zo),(0,M.dA)()&&(0,V.GZA)(Zo)}),[]),_t.useEffect((function(){Qo(Wo)}),[Wo,sr]);var $o=(0,M.bw)(M.WT.IsMsgExtEnabled)?{showCopilotSwitcherMenu:!1,copilotList:[],handleCopilotChatChange:function(e){},copilotSwitcherOpenRequest:Xo,setCopilotSwitcherOpenRequest:Ko,imageInsertionHandler:Se.DP}:void 0,ei={showCopilotSwitcherMenu:!0,copilotList:Vo,handleCopilotChatChange:Qo,showNewChatButtonOnTop:!1,copilotSwitcherOpenRequest:Xo,setCopilotSwitcherOpenRequest:Ko,imageInsertionHandler:Se.DP},ti={closeButton:{type:x.Close,clickHandler:function(){Pd(),Ce({type:U.ChatPPTExitClicked,message:""})}},headerMenuButtonProps:Nd(),enableChatHistory:(0,M.bw)(M.WT.IsChatHistoryOnSwitcherMenuEnabled),showCreditButton:(0,M.bw)(M.WT.IsCreditsUIInternalEnabled)},ni={showCopilotSwitcherMenu:!0,copilotList:Vo,handleCopilotChatChange:Qo,showNewChatButtonOnTop:!1,paneSilhouetteHeaderProps:(0,M.bw)(M.WT.IsCopilotSharedHeaderEnabled)?ti:void 0,copilotSwitcherOpenRequest:Xo,setCopilotSwitcherOpenRequest:Ko,imageInsertionHandler:Se.DP},ri=Ln(),oi=(0,M.bw)(M.WT.IsSwitcherMenuContainerEnabled)?ni:ir?ei:$o,ii=_t.useMemo((function(){return{mosTokenProvider:(0,r._)((function(){return(0,c.__generator)(this,(function(e){return[2,Ur.getToken(V.Ssr).then((function(e){return null==e?void 0:e.accessToken}))]}))}))}}),[Ur]),ai=(0,M.bw)(M.WT.IsCopilotCommandingSteerabilityEnabled),si=_t.useCallback(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,V.v5s)(zr,e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[zr]),li=_t.useCallback(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,V.OzJ)(zr,e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[zr]),ci=_t.useCallback(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,V.Wu7)(Ur,e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[Ur]),ui=_t.useCallback((0,r._)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,V.VEG)(Ur)];case 1:return[2,e.sent()]}}))})),[Ur]),di=_t.useCallback((0,r._)((function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,V.sJD)(Ur)];case 1:return[2,e.sent()]}}))})),[Ur]),pi=_t.useCallback((function(){return(0,M.bw)(M.WT.IsCloudFileUploadEnabled)||(0,M.bw)(M.WT.IsUrlUnfurlingUsingGraphAPIEnabled)||(0,M.bw)(M.WT.IsUploadImageFromPhoneEnabled)?{graphTokenProvider:si,sharepointTokenProvider:li}:{}}),[si,li]),fi=(0,s._)((0,_t.useState)(pi()),2),hi=fi[0],gi=fi[1],mi=(0,s._)((0,_t.useState)((0,z.og)()),2),yi=mi[0],vi=mi[1];_t.useEffect((function(){(0,M.bw)(M.WT.IsLocalFileUploadEnabled)&&""!==Zn.current.userPrincipalName&&(gi((function(e){return(0,a._)((0,i._)({},e),{lokiTokenProvider:ci})})),vi((0,a._)((0,i._)({},yi),{isLocalFileUploadEnabled:!0})))}),[ci]),_t.useEffect((function(){(0,M.bw)(M.WT.IsSccReadAloudEnabled)&&gi((function(e){return(0,a._)((0,i._)({},e),{oneNoteTokenProvider:ui})}))}),[ui]),_t.useEffect((function(){(0,M.bw)(M.WT.IsSccPromptSuggestionsEnabled)&&gi((function(e){return(0,a._)((0,i._)({},e),{substrateTokenProvider:di})}))}),[di]),(0,_t.useEffect)((function(){var e=pi();gi((function(t){return(0,i._)({},t,e)}))}),[pi]);var Si={copilotCommunicationHandler:ai?oo:ro,platformType:(0,Ne.mw)(),environment:(0,M.PA)(M.IY.EnableClientEnvironmentDetection)?(0,V.Rs7)(re.Vv.getSettingAsString(re.zj.AugLoopCloudALServiceUrl)):F.O.None,style:ri,useALRuntime:!1,ref:no,chatUiProps:Eo,theme:Wr,themeV2:(0,M.bw)(M.WT.EnableFluent2Tokens)?(0,V.IdZ)(qa.Os,f,g,(0,ee.xt)()?"rtl":"ltr"):void 0,basicChatProps:vo,copilotTelemetryHandler:xe.B.getInstance(),debugProps:Xn,copilotPluginProps:oi,copilotFeatureFlags:yi,hostTokenProviders:ii,hostAppAuthTokens:hi},Ci=(0,M.PA)(M.IY.IsAriaAnnouncerEnabled),bi=Rn();Ci&&!Sn.current&&(Te=_t.createElement("div",{className:bi.ariaAnnouncer,ref:Sn,"aria-live":"assertive","aria-atomic":"true"}));var Ei=(0,M.bw)(M.WT.IsSwitcherMenuContainerEnabled)?_t.createElement(Uu,Si):_t.createElement(_t.Fragment,null,_t.createElement(R.zn,Si),Ci&&Te),Ti=fr?ur?_t.createElement("div",null,"Loading Reviewer Agent..."):_t.createElement(Vu,{alSession:sr,onReviewerAgentToggleChange:Rr,onApplySuggestion:ju,userQuery:Tr,addCommentToFirstLineOfDocument:Wu,onSuggestionCardNavigation:$u,isDarkModeEnabled:Wr.isDarkModeEnabled,isHighContrastModeEnabled:Wr.isHighContrastModeEnabled,documentURL:kr,authorName:Pr.displayName,authorEmail:Pr.email,isReviewerNotAddedButtonClicked:mr,getDocumentSensitivity:Xu,agentLaunchType:Or,peoplePickerEditorConfig:Zu()}):ur?_t.createElement("div",null,"Loading Chat..."):Ei,wi=ir?Ti:Ei;return _t.createElement("div",{className:"ms-welcome",onKeyDown:Ho},wi)},Qh=function(){return Uh}},32217:(e,t,n)=>{"use strict";n.d(t,{II:()=>d,LA:()=>a,Yw:()=>p,gc:()=>l,pX:()=>i,u$:()=>c});var r=n(55564),o=!1;function i(){return o}function a(e){o=e}var s=!1;function l(){return s}function c(e){s=e}var u=!0,d=function(){return!(!u||!(0,r.PA)(r.IY.ShouldCLPExceptionDisableEnterpriseSearch))&&(a(!1),!0)};function p(){u=!1}},53154:(e,t,n)=>{"use strict";n.d(t,{G:()=>d});var r=n(11912),o=n(91165),i=n(90813),a=n(55564),s=n(44632),l=n(12542),c=n(18384),u=s.B.getInstance(),d=function(){function e(){(0,r._)(this,e),(0,i._)(this,"contextIdList",void 0),(0,i._)(this,"cleanupCallback",void 0),this.contextIdList=new Set,this.cleanupCallback=new Set}return(0,o._)(e,[{key:"addContextId",value:function(e){this.contextIdList.add(e)}},{key:"removeContextId",value:function(e){this.contextIdList.delete(e)}},{key:"isValidAnnotationResponse",value:function(e){var t,n=this.contextIdList.has(e);(0,a.PA)(a.IY.IsExtraStopGenLogEnabled)&&u.sendChatEventTelemetry((0,c.pN)((t={},(0,i._)(t,l.h3.ChatEventType,l.a5.IsContextIDValid),(0,i._)(t,l.h3.ChatEventParameters,n),(0,i._)(t,l.h3.UserQueryGuid,(null==e?void 0:e.toString())||""),t)));return n}},{key:"emptyContextIdListandCleanup",value:function(){this.contextIdList.clear(),(0,a.PA)(a.IY.IsExtraStopGenLogEnabled)&&u.sendChatEventTelemetry([{key:l.h3.ChatEventType,value:l.a5.ContextIDListEmptied}]),this.cleanupCallback.forEach((function(e){return e()}))}},{key:"addHandlerCleanup",value:function(e){this.cleanupCallback.add(e)}},{key:"isRequestPending",value:function(){return this.contextIdList.size>0}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(d,"instance",void 0)},4277:(e,t,n)=>{"use strict";n.d(t,{cn:()=>P,gf:()=>I,Nd:()=>C});var r,o=n(43032),i=n(81092),a=n(79490),s=n(2061),l=n(18758),c=n(55564),u=n(12542),d=n(43277),p=n(44632),f=n(30325),h=n(70941);function g(){return m.apply(this,arguments)}function m(){return(m=(0,o._)((function(){var e,t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:e=s.utd.Unknown,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:switch(t=r.sent(),(0,l.cY)("Primary Identity Info is : ",JSON.stringify(t)),t.identityType){case"OrganizationAccount":e=s.utd.Enterprise;break;case"MicrosoftAccount":e=s.utd.Consumer;break;default:e=s.utd.Unknown}return[3,4];case 3:return n=r.sent(),(0,l.cY)("Error fetching Identity Info :",n),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}!function(e){e.ODP="MicrosoftAccount",e.ODB="OrganizationAccount",e.Unsupported="Unsupported"}(r||(r={}));var y,v=9;!function(e){e.webUrl="https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.5008/en-us_web/login.html",e.spaUrl="https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.9008/en-us_web/login.html"}(y||(y={}));var S=function(e){return 1===e?"https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.5008/en-us_web/login.html":"https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.9008/en-us_web/login.html"};function C(){return b.apply(this,arguments)}function b(){return(b=(0,o._)((function(){var e;return(0,a.__generator)(this,(function(t){return e=S((0,c.Z8)(c.WT.RedirectURLEndpointOverride,0)),(0,l.cY)("Loading auth with reply URL: ".concat(e)),[2,OfficeFirstPartyAuth.load(e)]}))}))).apply(this,arguments)}function E(e,t,n){return T.apply(this,arguments)}function T(){return(T=(0,o._)((function(e,t,n){var r,o,m,y,S,C,b;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return[4,g()];case 1:o=a.sent(),m=0,a.label=2;case 2:if(!(m<=v))return[3,7];m>0&&(0,c.V3)()&&p.B.getInstance().sendChatEventTelemetry((0,i._)((0,h.Bx)(n)).concat([{key:u.h3.ChatEventType,value:u.a5.DesignerAuthTokenFetchRetry}])),a.label=3;case 3:return a.trys.push([3,5,,6]),y={resource:e,scope:t.length>0?t.join(" "):void 0,silentLogin:!0},S=o===s.utd.Unknown?(0,l.sQ)((0,f.wo)()):o===s.utd.Consumer,(0,c.PA)(c.IY.isMSAAuthWorkaroundEnabled)&&!d.i.isWebPlatform()&&S&&(y.policy="DELEGATED",(0,l.cY)("Using DELEGATED policy for MSA token retrieval.")),[4,OfficeFirstPartyAuth.getAccessToken(y)];case 4:return C=a.sent(),(0,l.cY)("Auth token successfully retrieved."),[2,C.accessToken];case 5:return b=a.sent(),r=b,[3,6];case 6:return m++,[3,2];case 7:throw r}}))}))).apply(this,arguments)}var w,I=(w=(0,o._)((function(e,t){var n,r,o,s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:n="",r="00000000-0000-0000-0000-000000000000",o=(0,h.Bx)(r),a.label=1;case 1:return a.trys.push([1,3,,4]),(0,c.V3)()&&p.B.getInstance().sendChatEventTelemetry((0,i._)(o).concat([{key:u.h3.ChatEventType,value:u.a5.DesignerAuthTokenFetchStart}])),[4,E(e,t,r)];case 2:return n=a.sent(),(0,c.V3)()&&p.B.getInstance().sendChatEventTelemetry((0,i._)(o).concat([{key:u.h3.ChatEventType,value:u.a5.DesignerAuthTokenFetchEnd}])),[3,4];case 3:throw s=a.sent(),(0,l.cY)("Failed to get access token: ".concat(s.message)),(0,c.V3)()&&p.B.getInstance().sendErrorTelemetry((0,i._)(o).concat([{key:u.IC.ErrorCategory,value:u.S2.Designer},{key:u.IC.ErrorMessage,value:"Error getting auth token: "+s.message},{key:u.IC.ErrorCode,value:"".concat(s.code)}])),s;case 4:return[2,{token:n}]}}))})),function(e,t){return w.apply(this,arguments)}),P=function(){return new URL("https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.9008/en-us_web/login.html").pathname}},44001:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>w,ID:()=>_,a5:()=>I,fS:()=>T,iZ:()=>A,ny:()=>E,qH:()=>P});var r,o=n(43032),i=n(90813),a=n(57835),s=n(61838),l=n(79490),c=n(55564),u=n(73606),d=n(72218),p=n(39726),f=n(43277),h=n(2061),g=n(48544),m=n(44632),y=n(12542),v=n(18758),S=n(24464),C=n(32854),b=n(18384),E=function(){var e,t,n,r,o;return{iconType:(null===(e=u.n.getInstance())||void 0===e?void 0:e.isInDocSensitivityLabelEncrypted())?g.JF.Encryption:g.JF.NonEncryption,tooltipText:null!==(r=null===(t=u.n.getInstance())||void 0===t?void 0:t.getInDocSensitiveLabelInfo().description)&&void 0!==r?r:"",badgeText:null!==(o=null===(n=u.n.getInstance())||void 0===n?void 0:n.getInDocSensitiveLabelInfo().displayName)&&void 0!==o?o:""}},T=function(){var e,t,n,r,o;return{iconType:(null===(e=u.n.getInstance())||void 0===e?void 0:e.isExternalDocSensitivityLabelEncrypted())?g.JF.Encryption:g.JF.NonEncryption,tooltipText:null!==(r=null===(t=u.n.getInstance())||void 0===t?void 0:t.getExternalDocSensitivityLabelInfo().description)&&void 0!==r?r:"",badgeText:null!==(o=null===(n=u.n.getInstance())||void 0===n?void 0:n.getExternalDocSensitivityLabelInfo().displayName)&&void 0!==o?o:""}},w=(r=(0,o._)((function(e){var t,n,r,o,a,s,p,f,g,v,S,E,T,w,I;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return n=null===(t=u.n.getInstance())||void 0===t?void 0:t.getInDocSensitiveLabelInfo(),(0,c.PA)(c.IY.IsClpEnabledInEnterpriseForSydney)?[4,null===(r=u.n.getInstance())||void 0===r?void 0:r.getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return s=l.sent(),[4,null===(a=u.n.getInstance())||void 0===a?void 0:a.getHighestDocumentSensitivityInfo([null===(o=u.n.getInstance())||void 0===o?void 0:o.getInDocSensitiveLabelInfo(),s])];case 2:(n=l.sent()).isDke=s.isDke,n.hasExtractForUser=s.hasExtractForUser,l.label=3;case 3:return g={id:n.labelId,displayName:null!==(p=n.displayName)&&void 0!==p?p:"",tooltip:n.description,color:n.color,isEncrypted:n.encryptionType!==h.TzT.None,priority:null!==(f=n.order)&&void 0!==f?f:0},S={documentSensitivity:g},[4,(0,C.MS)()];case 4:return S.documentURL=l.sent(),S.hasExtract=n.labelId===d.u1i||n.hasExtractForUser,S.isDKE=n.labelId!==d.u1i&&n.isDke,v=S,E={copilotConfig:e(),documentConfig:v},m.B.getInstance().sendChatEventTelemetry((0,b.pN)((T={},(0,i._)(T,y.h3.ChatEventType,y.a5.CopilotConfig),(0,i._)(T,y.h3.ChatEventParameters,JSON.stringify(E.copilotConfig)),T))),w=void 0===v.hasExtract&&void 0===v.isDKE,m.B.getInstance().sendChatEventTelemetry((0,b.pN)((I={},(0,i._)(I,y.h3.ChatEventType,y.a5.IsDocumentProtected),(0,i._)(I,y.h3.ChatEventParameters,!!w||!(!v.hasExtract||v.isDKE)),I))),[2,E]}}))})),function(e){return r.apply(this,arguments)});function I(e,t,n,r,o,i){var l,c,d,f={text:PowerpointCopilotStrings.TransformFileConfirmationHeader.replace("%s",null!=e?e:PowerpointCopilotStrings.TransformFileDocumentAliasWhenFilenameIsMissing)},h={text:PowerpointCopilotStrings.TransformFileConfirmationDesignerLayoutAdjustmentSuggestion.split(PowerpointCopilotStrings.RibbonButtonDesigner)[0],linkText:{text:PowerpointCopilotStrings.RibbonButtonDesigner,linkOnClick:o,linkSuffix:PowerpointCopilotStrings.TransformFileConfirmationDesignerLayoutAdjustmentSuggestion.split(PowerpointCopilotStrings.RibbonButtonDesigner)[1]}},g=[];if(g.push({text:PowerpointCopilotStrings.TransformFileConfirmationSpeakerNotes}),t&&g.push({text:PowerpointCopilotStrings.TransformFileConfirmationAddedImages}),g.push({text:PowerpointCopilotStrings.TransformFileConfirmationAddedLayouts}),(null===(l=u.n.getInstance())||void 0===l?void 0:l.shouldShowInDocSensitivityLabel())&&""!==(null===(c=u.n.getInstance())||void 0===c?void 0:c.getInDocSensitiveLabelInfo().displayName)){var m,y,v=PowerpointCopilotStrings.TransformFileConfirmationCLPSensitivityLabel1Prefix.replace("%s",null!==(y=null===(m=u.n.getInstance())||void 0===m?void 0:m.getInDocSensitiveLabelInfo().displayName)&&void 0!==y?y:"")+PowerpointCopilotStrings.TransformFileConfirmationCLPSensitivityLabel1LinkText+PowerpointCopilotStrings.TransformFileConfirmationCLPSensitivityLabel1Suffix;g.push({text:v})}var C=[{listHeader:PowerpointCopilotStrings.TransformFileConfirmationListPrefix.replace("%s",n),listItems:g}];return(0,S.fz)(C,f,h,(0,s._)((0,a._)({},S.tc),{clpSensitivityIndicatorData:(null===(d=u.n.getInstance())||void 0===d?void 0:d.shouldShowInDocSensitivityLabel())?E():void 0}),r,p.Xw.CHATPPT,i)}var P=function(){var e=(0,o._)((function(e){var t,n,r,o,i;return(0,l.__generator)(this,(function(a){switch(a.label){case 0:return e?(n={labelId:e.id,tenantId:e.tenantId},[4,null===(t=u.n.getInstance())||void 0===t?void 0:t.getHighestDocumentSensitivityInfo([n])]):[3,2];case 1:return[2,{iconType:(r=a.sent()).encryptionType!==h.TzT.None?g.JF.Encryption:g.JF.NonEncryption,tooltipText:null!==(o=r.description)&&void 0!==o?o:"",badgeText:null!==(i=r.displayName)&&void 0!==i?i:""}];case 2:return[2,{tooltipText:PowerpointCopilotStrings.CLPGeneralSensitivityLabelError,iconType:g.JF.Warning}];case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=!0,t=f.i.GetHostAppPlatform();return t!==d.nAd&&t!==d.xb6&&t!==d.TTX||(e=Office.context.requirements.isSetSupported("SensitivityAPI","1.1")),(0,v.cY)("isV2ClpPipelineEnabled: ".concat(e,", platform: ").concat(t)),e},A=function(){var e,t;if((0,c.PA)(c.IY.IsTransformFileSensitivityLabelErrorMessageEnabled)){var n;t=PowerpointCopilotStrings.TransformFileCLPProtectedErrorMessage,e=y.Nr.TransformFileCLPProtectedErrorMessage;var r=null===(n=u.n.getInstance())||void 0===n?void 0:n.getExternalDocSensitivityLabelInfo().displayName;r&&(t=PowerpointCopilotStrings.TransformFileCLPSensitivityLabelErrorMessage.replace("%s",r),e=y.Nr.TransformFileCLPSensitivityLabelErrorMessage)}else t=PowerpointCopilotStrings.CLPNoUserPermissionForSensitivityLabel,e=y.Nr.CLPNoUserPermissionForSensitivityLabel;return{errorString:t,errorKey:e}}},24464:(e,t,n)=>{"use strict";n.d(t,{FY:()=>Be,bq:()=>Le,OT:()=>Oe,Ne:()=>Xe,y_:()=>Re,qi:()=>Ue,l6:()=>He,i3:()=>ze,FL:()=>Ge,fz:()=>Je,Wm:()=>Ye,YL:()=>Qe,Lc:()=>We,BK:()=>qe,hF:()=>Ze,rz:()=>Fe,vT:()=>je,Qs:()=>Ke,r5:()=>Ve,tc:()=>xe,x5:()=>Ne});var r=n(90813),o=n(57835),i=n(61838),a=n(81092),s=n(10229),l=n(43479),c=n(93176),u=n(24643),d=n(31101),p=n(13456),f=n(30112),h=n(42651),g=n(16126),m=n(50546),y=n(84417),v=n(96713),S=n(8520),C=n(658);const b=(0,C.n)({item:{height:"auto",width:"auto",flexShrink:1}}),E=({children:e,style:t})=>{const n=(0,f.z)(b().item,t);return S.createElement("div",{className:n},e)},T=(0,C.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),w=({children:e,style:t,horizontal:n=!1,reverse:r=!1,customProperties:o})=>{const i=((e,t,n,r)=>{let o=e.root;return t&&(o=(0,f.z)(o,t)),n?o=r?(0,f.z)(o,e.horizontalReverse):(0,f.z)(o,e.horizontal):r&&(o=(0,f.z)(o,e.verticalReverse)),o})(T(),t,n,r);return S.createElement("div",{className:i,...o},e)};var I;!function(e){e.File="File",e.Event="Event",e.Message="Message"}(I||(I={}));n(58651);function P(e){const t=e.lastIndexOf(".");if(-1===t||0===t)return{name:e,extension:""};return{name:e.slice(0,t),extension:e.slice(t+1).toLowerCase()}}function _(e){return e.replace(/[{}]/g,"")}function A(e){const t=e.sharepointIds;if(!t)return;const n=_(t.siteId||""),r=_(t.webId||""),o=_(t.listId||""),i=_(t.listItemUniqueId||"");return n&&r&&o&&i?btoa(`${n},${r},${o}`).replace(/[=]+$/g,""):void 0}const k={doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",pdf:"application/pdf"},x=(e,t)=>e.id&&t.id?e.id===t.id:e.url&&t.url?e.url===t.url:e.text===t.text,N=e=>{let t=e;const n=t.find((e=>e.checked));return t=n?t.map((e=>({...e,checked:x(e,n)}))):t.map((e=>({...e,checked:!1}))),t},O=()=>S.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",alt:"Word",height:20,width:20}),D=()=>S.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",alt:"Excel",height:20,width:20}),L=()=>S.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",alt:"PowerPoint",height:20,width:20});n(58651);new Map([["docx",S.createElement(O,{key:"docx"})],["doc",S.createElement(O,{key:"doc"})],["pptx",S.createElement(L,{key:"pptx"})],["ppt",S.createElement(L,{key:"ppt"})],["xlsx",S.createElement(D,{key:"xlsx"})],["xls",S.createElement(D,{key:"xls"})],["pdf",S.createElement((()=>S.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg",alt:"PDF",height:20,width:20})),{key:"pdf"})],["people",S.createElement((()=>S.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/contact.svg",alt:"People",height:20,width:20})),{key:"people"})]]);const R=new Map([["docx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg"],["pptx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg"],["xlsx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg"],["pdf","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg"],["txt","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg"],["html","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/html.svg"],["people","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/contact.svg"],["eml","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/outlook_24x1.svg"],["teams","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/teams_24x1.svg"]]);var F=n(16895),M=n(80617),B=n(34824),U=n(5435);const z=(0,C.n)({row:{display:"flex",...F.Pt.gap(M.L.spacingHorizontalXL)},contentStyle:{...F.Pt.gap(M.L.spacingVerticalL),background:M.L.colorNeutralBackground1}}),H=({numberOfItems:e=1,headerDescription:t,deleteButtonAvailable:n=!1})=>{const r=z();return S.createElement(w,{style:r.contentStyle},t&&S.createElement(h.c,null,t),(o=e,Array.from(Array(o).keys()).map((e=>S.createElement(g.Z,{size:"small",key:e},S.createElement(B.E,{className:r.row,"aria-label":"Loading Content"},S.createElement(U.H,{size:24,shape:"square"}),S.createElement(U.H,{size:24,shape:"square"}),S.createElement(U.H,{size:24,shape:"rectangle"}),n&&S.createElement(U.H,{size:24,shape:"square"})))))));var o};var G=n(58074),V=n(11290),j=n(90019),q=n(9052),W=n(71758);var Y=n(284);const Q=(0,C.n)({root:{display:"flex",alignItems:"center"},inputWrapper:{borderTopWidth:0},inputWrapperGridStyles:{gridTemplateColumns:"1fr auto auto",borderRadius:"12px","&::after":{left:"3px",right:"3px"}}}),J=S.forwardRef(((e,t)=>{const n=(e=>{var t;const{serviceProvider:{useVoiceInput:n,useLocalFiles:r,useCiq:o,useEntityPlugin:i,useCloudFiles:a,useAttachmentList:s,useHydratedEntityPlugin:l,useInputMessages:c,usePromptSuggestions:u,useElaboratePromptPlugin:d}}=(0,W.Ay)(),p=n(),h=d(),{ChatInputMessages:g,service:m}=c(),{FilePicker:y,useDragAndDropStyle:v}=r(),C=v(),b=Q(),{ciqPlugin:E}=o(),{entityPlugin:T}=i(),{cloudFilePickerCallout:w}=a(),{attachmentList:I}=s(),{hydratedEntityPlugin:P}=l(),{promptListbox:_,cursorPositionPlugin:A,containerRef:k,onChange:x,onSubmit:N,onBlur:O,onFocus:D,onKeyDown:L,isPromptAutocompleteSelectMode:R}=u(),{enableSharedInputControlSimplification:F}=e;if(E&&!T)throw new Error("Entity plugin is required for CIQ plugin");if(y&&!T)throw new Error("Entity plugin is required for local files plugin");const M=S.useCallback(((e,t)=>R?void 0:(0,Y.p)(t,e)),[R]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),void 0===e.attachments&&{attachments:I}),_?{listbox:_}:{}),k?{root:{ref:k}}:{}),x?{onChange:(0,Y.p)(e.onChange,x)}:{}),N?{onSubmit:M(e.onSubmit,N)}:{}),O?{onBlur:(0,Y.p)(e.onBlur,O)}:{}),D?{onFocus:(0,Y.p)(e.onFocus,D)}:{}),L?{onKeyDown:(0,Y.p)(e.onKeyDown,L)}:{}),{actions:Object.assign(Object.assign({},e.actions),{children:S.createElement("span",{className:b.root},null===(t=e.actions)||void 0===t?void 0:t.children,null==p?void 0:p.microphoneButton,null==h?void 0:h.elaboratePromptButton,y&&S.createElement(y,null))}),children:S.createElement(S.Fragment,null,e.children,null==p?void 0:p.ghostTextPlugin,T,E,w,P,A||S.createElement(S.Fragment,null)),banner:(null==m?void 0:m.messages.length)&&(null==m?void 0:m.messages.length)>0&&g?S.createElement(g,null):void 0,inputWrapper:{className:(null==g?void 0:g())?(0,f.z)(b.inputWrapper,F&&b.inputWrapperGridStyles):F?b.inputWrapperGridStyles:void 0},className:(0,f.z)(e.className,C)})})(e);return((e,t)=>{const{serviceProvider:n}=(0,W.Ay)(),{LocalFilesInputWrapper:r,styles:o}=n.useLocalFiles(),i=S.createElement(S.Fragment,null,S.createElement(q.V,Object.assign({ref:t},e)));return r?S.createElement(r,{style:o},i):i})(n,t)}));J.displayName="ChatInput";var X=n(63933),K=n(99520),Z=n(3445);var $=n(40144);const ee={10:"#2B2B40",20:"#2F2F4A",30:"#333357",40:"#383966",50:"#3D3E78",60:"#444791",70:"#4F52B2",80:"#5B5FC7",90:"#7579EB",100:"#7F85F5",110:"#9299F7",120:"#AAB1FA",130:"#B6BCFA",140:"#C5CBFA",150:"#DCE0FA",160:"#E8EBFA"};var te=n(54315);const ne=({alSession:e,editorConfigProps:t,onCIQOutOfFocus:r,onItemSelected:o,graphTokenProvider:i,sharepointTokenProvider:a})=>{const s=S.useRef(null),l=S.useRef(null),c=S.useRef(null),u=S.useRef(null),[d,p]=S.useState(!1),f=async()=>{const e=(await Promise.all([n.e(6008),n.e(3062),n.e(1511),n.e(9037),n.e(3341),n.e(7193),n.e(1034)]).then(n.bind(n,48384))).EditorServiceImplementation.getInstance();return Promise.resolve(e)};const h=(0,te.m)({entityRef:l,controlRef:u,graphTokenProvider:i,sharepointTokenProvider:a,appName:t.appName,locale:t.locale,theme:"default",supportedFileExtensionMimeMap:k,onItemsSelected:function(e){for(const t of e){const e=`SPO_${A(t)}_${t.id}`,n={supportedEntityType:I.File,text:t.name||"",id:e,url:t.webUrl||t.webDavUrl||""};o?.(n)}}}),g=()=>({getEditorService:f,editorProps:e&&s.current?{...t,alSession:e,targetElement:s.current,onClose:()=>p(!1),onOpen:()=>p(!0),browseThisComputerSettings:h.browseThisComputerSettings}:void 0,entityRef:l,insertCiqTriggerPluginRef:c,ciqPlaceholderText:"Search for files",onCIQBootstrap:()=>{c.current?.insertCiqTrigger("/")}}),[m,y]=S.useState(g());(0,S.useEffect)((()=>{y(g())}),[e,s.current]);const v={...W.IB,useCiq:()=>(0,X.o)({...m}),useEntityPlugin:()=>(0,K.a)({entityRef:l}),useCloudFiles:()=>h},C={customNodes:[G.Ho,V.iH],send:null,disableSend:!1,disabled:!1,maxLength:2e3,placeholderValue:"Type / to add another item",ref:s,children:S.createElement(S.Fragment,null,S.createElement(j.J,{ref:u}))};return S.createElement(W.N2,{serviceProvider:v,inputContext:{inputRef:s,entityRef:l,controlRef:u,insertCiqTriggerPluginRef:c}},S.createElement(Z.q,{theme:(0,$.a)(ee)},S.createElement(J,{ref:s,...{...C,actions:{...C.actions,children:S.createElement("span",{style:{display:"flex",alignItems:"center"}})}},onBlur:e=>{r&&!d&&r()}})))},re={entityPickerChildGap:{...F.Pt.gap("12px")},entityPickerScrollableContainer:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},entityScrollableList:{flex:"1 1 auto",overflowY:"auto",overflowX:"hidden",padding:"8px",marginBottom:"8px"},entityCard:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-between",width:"100%"},authorAndDateGap:{},authorGap:{marginLeft:"16px",flexGrow:1,textAlign:"left",minWidth:"200px"},dateModified:{minWidth:"150px",flexGrow:1,textAlign:"left"},authorName:{paddingLeft:"5px"},authorImg:{borderRadius:"50%"},elementGap:{...F.Pt.gap("8px"),justifyContent:"left",overflow:"auto"},submitButtonStyle:{width:"fit-content"},deleteButtonStyle:{marginTop:"auto",marginBottom:"auto",cursor:"pointer"},listCardStyle:{padding:"4px 6px",boxShadow:"none",border:"1px solid",borderRadius:"4px",...F.Pt.borderColor(M.L.colorNeutralStroke1),justifyContent:"space-between"},checkbox:{justifyContent:"space-between"},checkboxLabelWithAuthor:{justifyContent:"left",minWidth:"100px"},checkboxLabel:{justifyContent:"left"},fileLabel:{paddingLeft:"5px"},onHoverUI:{display:"block",position:"absolute",top:"100%",left:"0",backgroundColor:"white",border:"1px solid #ccc",padding:"10px",zIndex:1,width:"100px",height:"100px"},authorImage:{borderRadius:"50%",paddingRight:"5px"},entityHoverCard:{borderRadius:"10px"},entityName:{color:M.L.colorNeutralForeground2},addEntityButtonStyle:{paddingTop:"4px",paddingBottom:"4px"}},oe=(0,C.n)(re);var ie=n(95432),ae=n(76677),se=n(72059),le=n(34235),ce=n(88938);const ue=({list:e,headerDescription:t,addEntityButtonText:n,addAnotherEntityProps:r,entityInteractionDisabled:o=!1,dataAvailable:i=!0,allowEntityDeletion:a=!1,openEntityInputPickerOnStartup:s=!1,maxEntityCount:l,maxSelectionAllowed:c,checkOnlyIdForDuplication:u=!1,contentTypeFilter:C,partialDataAvailable:b=!1,useRadioButtons:T=!1,onEntityChange:_,makeEntityListScrollable:A=!1})=>{const[k,O]=S.useState((()=>{let t=e;return C&&C.length>0&&(t=t.filter((e=>-1!==C.indexOf(e.contentType)))),l&&(t=t.slice(0,l)),T&&(t=N(t)),t})),[D,L]=S.useState(s),[F,B]=S.useState(k.some((e=>e.author||e.dateModified||e.authorIconUrl))),[U,z]=S.useState(k.some((e=>void 0!==e.dateModified))),[G,V]=S.useState(c&&k.filter((e=>e.checked)).length>=c),j=oe();S.useEffect((()=>{let t=e;C&&C.length>0&&(t=t.filter((e=>-1!==C.indexOf(e.contentType)))),l&&(t=t.slice(0,l)),T&&(t=N(t)),t&&t.length>0&&(O(t),z(k.some((e=>void 0!==e.dateModified))),B(t.some((e=>e.author||e.dateModified||e.authorIconUrl))))}),[e]);const q=(e,t)=>{const n={onRenderPlainCard:()=>{return t={onHoverUI:e.onHoverUI},S.createElement(w,null,t.onHoverUI);var t}};return S.createElement(ie.j,{cardDismissDelay:200,type:ae.F.plain,plainCardProps:n,className:j.entityHoverCard,style:{borderRadius:"8px"}},S.createElement(w,{horizontal:!0,style:F?j.checkboxLabelWithAuthor:j.checkboxLabel},S.createElement("img",{src:e.iconUrl,alt:e.text,height:20,width:20}),S.createElement(E,{key:t,style:j.fileLabel},e.url&&e.url.length>0?S.createElement(d.N,{href:e.url,target:"_blank"},S.createElement(p.V,{className:j.entityName},e.text)):S.createElement(p.V,{className:j.entityName},e.text))))};return i||b?S.createElement(w,{style:A?(0,f.z)(j.entityPickerChildGap,j.entityPickerScrollableContainer):j.entityPickerChildGap},t&&S.createElement(h.c,null,t),S.createElement(de,{makeEntityListScrollable:A},S.createElement(w,{style:j.elementGap},k?.map(((e,t)=>S.createElement(S.Fragment,{key:t},S.createElement(g.Z,{key:t,size:"small",className:j.listCardStyle},S.createElement(w,{horizontal:!0,style:j.entityCard},T?S.createElement(m.s,{key:t,className:j.checkbox,checked:e.checked,disabled:o,onChange:()=>(e=>{const t=k.map((t=>({...t,checked:x(t,e)})));_(t),O(t)})(e),label:q(e,t)}):S.createElement(y.S,{key:t,className:j.checkbox,checked:e.checked,disabled:o||!e.checked&&G,onChange:(t,n)=>{((e,t)=>{const n=[...k];n.forEach((n=>{n.text===e.text&&n.url===e.url&&n.id===e.id&&(n.checked=t)})),_(n),O(n),c&&V(n.filter((e=>e.checked)).length>=c)})(e,n.checked)},label:q(e,t)}),F&&S.createElement(w,{horizontal:!0,style:j.authorAndDateGap},U&&S.createElement(E,{style:j.dateModified},S.createElement(h.c,null,e.dateModified)),S.createElement(w,{horizontal:!0,style:j.authorGap},e.authorIconUrl?S.createElement("img",{src:e.authorIconUrl,alt:e.author,height:20,width:20,style:{borderRadius:"50%",paddingRight:"5px"}}):e.author?S.createElement(le.kOd,{height:20,width:20,style:{borderRadius:"50%",paddingRight:"5px"}}):null,e.author&&S.createElement(E,null,S.createElement(h.c,null,e.author)))),a&&S.createElement(se.K,{"aria-label":"Delete",title:"Remove",onClick:()=>(e=>{O((t=>{const n=[...t];return n.splice(e,1),_(n,!1),c&&n.filter((e=>e.checked)).length<c&&V(!1),n}))})(t)},S.createElement(ce.va_,{style:{color:M.L.colorNeutralForeground2}})))))))),b&&S.createElement(w,null,S.createElement(H,{numberOfItems:3,deleteButtonAvailable:a}))),S.createElement(S.Fragment,null,S.createElement("div",null,n&&!D&&S.createElement(v.$,{size:"small",icon:S.createElement(ce.Ibn,null),className:j.addEntityButtonStyle,onClick:()=>L(!0)},"Add another file"),(!n||D&&!o)&&r&&S.createElement(S.Fragment,null,((e,t,n,r,o,i)=>{const a=n;return a.onItemSelected=(e,n,r)=>{switch(e.type){case"File":t({text:e.FileName,url:e.AccessUrl,id:e.SpoId,supportedEntityType:I.File});break;case"Event":t({text:e.Subject,url:e.WebLink,id:e.Id,supportedEntityType:I.Event});break;case"Message":t({text:e.Subject,url:e.Subject,id:e.Id,supportedEntityType:I.Message})}},S.createElement(ne,{alSession:e,editorConfigProps:a,onCIQOutOfFocus:r,onItemSelected:t,graphTokenProvider:o,sharepointTokenProvider:i})})(r.alSession,(e=>{O((t=>{if(C&&C.length>0){const{extension:n}=P(e.text);if(n&&-1===C.indexOf(n))return t}const n=t?.some((t=>t.text===e.text&&t.url===e.url&&t.id===e.id||u&&t.id===e.id&&t.text===e.text));if(n){const n=t.map((t=>((t.text===e.text&&t.url===e.url&&t.id===e.id||u&&t.id===e.id&&t.text===e.text)&&(t.checked=!0),t)));return _(n),n}let{extension:r}=P(e.text);null!=r&&0!==r.length||(r=function(e){switch(e){case I.Event:return"teams";case I.Message:return"eml";default:return""}}(e.supportedEntityType));const o=[...t];return o.push({text:e.text,url:e.url||"",id:e.id,checked:!0,iconUrl:R.get(r),contentType:r}),_(o,!0),c&&o.filter((e=>e.checked)).length>=c&&V(!0),o}))}),r.editorConfiguration,(()=>{L(!1)}),r.graphTokenProvider,r.sharepointTokenProvider))))):S.createElement(H,{numberOfItems:5})},de=({makeEntityListScrollable:e,children:t})=>{const n=oe();return e?S.createElement("div",{className:n.entityScrollableList},t):S.createElement(S.Fragment,null,t)};var pe=n(55564),fe=n(1721),he=n(8979),ge=n(80664),me=n(39726),ye=n(72218),ve=n(32854),Se=n(40389),Ce=n(12542),be=n(14213),Ee=n(81274),Te=n(44632),we=n(18384),Ie=n(39041),Pe=n(50481),_e=n(2061),Ae=n(43277),ke=Te.B.getInstance(),xe={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:s.O.Footer,showAnimation:!0,isFailure:!1},Ne={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:s.O.Footer,showAnimation:!0,isFailure:!1},Oe={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:s.O.Footer,showAnimation:!1,isFailure:!0},De={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:s.O.None,showAnimation:!1,isFailure:!0},Le={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:s.O.None,showAnimation:!1},Re=function(){return[{type:l.jA.Default,title:(0,ye.aUn)(),text:(0,Se.dD)()?void 0:(0,ye.aUn)(),iconRegular:(0,Se.dD)()?fe.c2D:fe.Jg_,iconHover:(0,Se.dD)()?fe.cAv:fe.Z1B,position:(0,Se.dD)()?l.SC.FeedbackSection:l.SC.ActionButtonBar,popoverProps:{popoverTitle:(0,ye.bgh)()},handleButtonOnClick:ve.Cu}]},Fe=function(e){try{if(Ae.i.GetHostAppPlatform()!==ye.q93&&!Office.context.requirements.isSetSupported(ye.Ujq,ye.CA1))throw new Error("CopilotAction viewAction API v".concat(ye.CA1," is not supported"));var t=[];if(void 0===e)throw new Error("Hidden text not found");if(0===e.length)throw new Error("Hidden text is empty");if(JSON.parse(e).forEach((function(e){if(void 0===(null==e?void 0:e.mappedId))throw new Error("Key slide id not found");var n=Ke(e.mappedId);if(null===n||2!==n.length)throw new Error("Key slide id is not in the correct format");t.push({sid:n[0],cid:n[1]})})),t.length>0)return{type:l.jA.Default,title:(0,ye.i6v)(),text:(0,Se.dD)()?void 0:(0,ye.i6v)(),iconRegular:(0,Se.dD)()?le.V$h:le.M1N,iconHover:(0,Se.dD)()?le.lwq:le.yGi,position:(0,Se.dD)()?l.SC.FeedbackSection:l.SC.ActionButtonBar,handleButtonOnClick:function(e){(0,ve.sE)(t)}};throw new Error("Key slides is empty")}catch(e){var n;(0,_e.cY_)("Error parsing key slides",e),ke.sendErrorTelemetry((0,we.pN)((n={},(0,r._)(n,Ce.IC.ErrorMessage,"Error in getViewActionKeySlidesButton method: ".concat(null==e?void 0:e.message)),(0,r._)(n,Ce.IC.ErrorCategory,Ce.S2.PlayKeySlides),n)))}},Me=function(e,t,n){var r=[{type:l.jA.Default,title:ye.EKU,text:ye.EKU,tooltip:ye.EKU,handleButtonOnClick:function(){t(!0),n(e)}},{type:l.jA.Default,title:ye.UlY,tooltip:ye.UlY,iconRegular:he.gip,iconHover:he.gip,handleButtonOnClick:function(){var t,n,r,o;window.open("https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[PowerPoint+Copilot]:&[System.Description]="+(t=e,r=(0,Pe.d3)().length>0&&(0,Pe.d3)()[0].optionSets?(0,Pe.d3)()[0].optionSets:[],o="<ul> <li><strong>SessionId:</strong> "+t.sessionId+"</li><li><strong>AL inspector link:</strong> https://web.augloop-tools.officeppe.com/inspector/"+t.sessionId+"</li><li><strong>appName:</strong> Powerpoint </li>"+"<li><strong>appPlatform:</strong> ".concat((0,ge.xp)(),"</li>")+"<li><strong>sdxVersion: </strong>"+(0,Ie.QV)()+"</li><li><strong>optionSets: </strong>"+r+"</li></ul><br/> Please upload console and sydney logs from debug panel<br/><br/>",(o+="<strong>Skill Name:</strong> ".concat(null!==(n=t.skill)&&void 0!==n?n:"Sydney"," <br/> <strong>Error:</strong> ").concat(JSON.stringify(t.error)," <br/> <strong>FCFR:</strong> ").concat(t.FCFR," <br/> <strong>LCFR:</strong> ").concat(t.LCFR))+"&[System.Area]=OCOffice+AI+ExpChat&[System.Tags]=UserFeedback"),"_blank")}}];return(0,pe.bw)(pe.WT.IsDebugSectionV2Enabled)&&e?r:void 0};var Be=function(e,t,n,r){var o=!0,i=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var u=l.value;if(u.title===ye.EKU||u.title===ye.UlY)return}}catch(e){i=!0,s=e}finally{try{o||null==c.return||c.return()}finally{if(i)throw s}}var d,p=Me(t,n,r);p&&(null==e||(d=e).push.apply(d,(0,a._)(p)))},Ue=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:me.Xw.CHATPPT,a=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],d=arguments.length>7?arguments[7]:void 0,p=arguments.length>8?arguments[8]:void 0,f=arguments.length>9?arguments[9]:void 0;return void 0!==t&&(t=(0,i._)((0,o._)({},t),{feedbackData:(0,ve.as)(r,p),telemetryData:(0,ve.YI)(a,d)})),{chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:t,stopLoadingUi:n,startAugloopTimerForStreaming:s,addCardToChatHistory:l,workflowAnnotationTypeForAugloopTimer:f}},ze=function(e){return{chatCardType:c._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:u.Q9.Chat,element:(t=e,S.createElement(ue,{...t}))}},chatMessageBodyData:xe,stopLoadingUi:!0};var t},He=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return void 0!==t&&(t=(0,i._)((0,o._)({},t),{feedbackData:(0,ve.as)(me.Xw.CHATPPT,r)})),{chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Human,messageHeader:{text:e}}},chatMessageBodyData:t,stopLoadingUi:n}},Ge=function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me.Xw.CHATPPT,l=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,p=arguments.length>8?arguments[8]:void 0;return void 0!==r&&(r=(0,i._)((0,o._)({},r),{feedbackData:(0,ve.as)(s,p),telemetryData:(0,ve.YI)(l,d)})),{chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Chat,messageHeader:{text:e.linkPrefix,linkText:{text:e.linkText,linkOnClick:t,linkUrl:n,linkSuffix:e.linkSuffix}}}},chatMessageBodyData:r,stopLoadingUi:a}},Ve=function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0;if((0,pe.PA)(pe.IY.ErrorMessageInAIContextEnabledPPT)&&void 0!==Oe){var l,d=(0,ve.as)(me.Xw.CHATPPT,s);if(d.contextData&&d.contextData.cardMetaData){var p=JSON.parse(d.contextData.cardMetaData);if(p){var f=(0,i._)((0,o._)({},p),{errorMessage:t,errorType:null==s?void 0:s.errorType,featureName:null==s?void 0:s.featureName,entryPoint:"".concat(ve.K.Chat)});d.contextData.cardMetaData=JSON.stringify(f)}}var h=(0,i._)((0,o._)({},Oe),{feedbackData:d,telemetryData:(0,ve.YI)(n,r)}),g={chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Chat,messageHeader:{text:t}}},chatMessageBodyData:h,stopLoadingUi:a,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0};null===(l=e.current)||void 0===l||l.addResponseMessage(g)}else{var m;null===(m=e.current)||void 0===m||m.addResponseMessage(Ue(t,Oe,a,void 0,n,!1,!0,r,s))}},je=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=(0,pe.PA)(pe.IY.ShouldEnableCommandingErrorCard)&&(0,Ee.cA)(),s=t?Oe:De,l=a?function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=arguments.length>3?arguments[3]:void 0;return ke.sendChatEventTelemetry((0,we.pN)((0,r._)({},Ce.h3.ChatEventType,Ce.a5.CommandingErrorCardLoaded))),e=void 0!==e?(0,i._)((0,o._)({},e),{pillsList:(0,Ee.CQ)(),feedbackData:(0,ve.as)(n?me.Xw.CHATPPT:void 0,a),telemetryData:(0,ve.YI)(be.K.getInstance().getFeatureName(),Ce.Ff.Unset)}):{pillsList:(0,Ee.CQ)()},{chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Chat,messageHeader:{text:(0,Ee.Dy)()}}},chatMessageBodyData:e,stopLoadingUi:t,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0}}(s,e,!0,n):Ue(PowerpointCopilotStrings.CommandNotSupportedMessage,s,e,void 0,void 0,!1,!0,void 0,n);return l},qe=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:me.Xw.CHATPPT;return We(t,e,void 0,n,r,o,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0)},We=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me.Xw.CHATPPT,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=[{listItems:e.map((function(e){return{text:e}}))}];return Qe(c,t,n,r,o,i,a,s,l)},Ye=function(e,t,n,r,o){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:me.Xw.CHATPPT;return Qe([{listHeader:r,listItems:e}],t,n,o,i,a,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0)},Qe=function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me.Xw.CHATPPT,l=arguments.length>6?arguments[6]:void 0,d=arguments.length>7?arguments[7]:void 0,p=arguments.length>8?arguments[8]:void 0;return void 0!==r&&(r=(0,i._)((0,o._)({},r),{feedbackData:(0,ve.as)(s,p),telemetryData:(0,ve.YI)(l,d)})),{chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Chat,messageHeader:{text:t},embeddedLists:e,messageFooter:{text:n}}},chatMessageBodyData:r,stopLoadingUi:a}},Je=function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me.Xw.CHATPPT,l=arguments.length>6?arguments[6]:void 0;return void 0!==r&&(r=(0,i._)((0,o._)({},r),{feedbackData:(0,ve.as)(s,l),telemetryData:(0,ve.YI)()})),{chatCardType:c._.Default,chatMessageData:{defaultMessageProps:{user:u.Q9.Chat,messageHeader:t,embeddedLists:e,messageFooter:n}},chatMessageBodyData:r,stopLoadingUi:a}},Xe=function(e){if((0,pe.bw)(pe.WT.IsPersonalizationUXEnabled)&&(0,pe.PA)(pe.IY.IsPersonalizationIndicatorHeaderEnabled)&&!(0,Ie.hX)(e))return(0,_e.Ne4)(e)},Ke=function(e){var t=e.split("#");if(2!==t.length)return null;var n=parseInt(t[0],10),r=parseInt(t[1],10);return isNaN(n)||isNaN(r)?null:[n,r]},Ze=function(e){if((e.gptIdentifiers||[]).length>0){var t,n=e.gptIdentifiers[0].id;if(n)(0,_e.cY_)("Rendering branding header for response received with GPT ID: ".concat(n)),Te.B.getInstance().sendChatEventTelemetry((0,we.pN)((t={},(0,r._)(t,Ce.h3.ChatEventType,Ce.a5.GptIdForBranding),(0,r._)(t,Ce.h3.ChatEventParameters,n),t)));return n?{id:n,name:""}:void 0}}},17223:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var r=n(11912),o=n(91165),i=n(90813),a=function(){function e(){if((0,r._)(this,e),(0,i._)(this,"chatRef",void 0),e._instance)throw new Error("Error: Instantiation failed: Use CopilotChatRefSingleton.getInstance() instead of new.");e._instance=this}return(0,o._)(e,[{key:"getChatRef",value:function(){return this.chatRef}},{key:"setChatRef",value:function(e){this.chatRef=e}}],[{key:"getInstance",value:function(){return e._instance}}]),e}();(0,i._)(a,"_instance",new a)},50502:(e,t,n)=>{"use strict";n.d(t,{BG:()=>E,Kl:()=>b,Rb:()=>S,VL:()=>w,qL:()=>I,tA:()=>T,uz:()=>C});var r=n(90813),o=n(85535),i=n(93176),a=n(24643),s=n(10229),l=(n(8520),n(98483)),c=n(39726),u=n(32854),d=n(34045),p=n(72218),f=n(44121),h=n(83048),g=n(44632),m=n(18384),y=n(73606),v=n(44001),S=function(e){var t=(0,l.A)();return g.B.getInstance().logSeenEvent(f.SD.Translate,h.Ff.TranslatePresentation,o.RX.Command),{chatCardType:i._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:a.Q9.Chat,renderData:{component:c.uz.TranslationCard,props:{cardType:c.wv.DropDownCard,targetLanguage:null!=e?e:p.u1i,messageId:t},shouldMemoizeComponent:!1}}},chatMessageBodyData:{messageId:t}}},C=function(e,t){var n,r;(0,u.vF)(t);var o=null!==(r=d.Vv.getSettingAsString(d.zj.PPTDocumentFileName))&&void 0!==r?r:"Untitled.pptx";null===(n=e.current)||void 0===n||n.updateMessage({chatCardType:i._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:c.uz.TranslationCard,props:{cardType:c.wv.LoaderCard,selectedLanguage:t.language,translatedPresentationName:P(o,t.language)},shouldMemoizeComponent:!1}}},chatMessageBodyData:{messageId:t.messageId,feedbackSectionPosition:s.O.Footer,shouldShowAIGeneratedIndicator:!0,telemetryData:(0,u.YI)(f.SD.Translate,h.Ff.TranslatePresentation)}})},b=function(e,t,n,r,o,a){var l,d;null===(d=e.current)||void 0===d||d.updateMessage({chatCardType:i._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:c.uz.TranslationCard,props:{cardType:c.wv.TranslatedPPTCard,translatedPresentationName:o,translatedFileRelativePath:r,translatedFileAbsolutePath:n,selectedLanguage:a,messageId:t},shouldMemoizeComponent:!1}}},chatMessageBodyData:{messageId:t,feedbackSectionPosition:s.O.Footer,shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:(null===(l=y.n.getInstance())||void 0===l?void 0:l.shouldShowInDocSensitivityLabel())?(0,v.ny)():void 0,telemetryData:(0,u.YI)(f.SD.Translate,h.Ff.TranslatePresentation)}})},E=function(e,t,n){var r,o;null===(o=e.current)||void 0===o||o.updateMessage({chatCardType:i._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:c.uz.TranslationCard,props:{cardType:c.wv.DraftModeSuccessCard,selectedLanguage:n},shouldMemoizeComponent:!1}}},chatMessageBodyData:{messageId:t,feedbackSectionPosition:s.O.Footer,shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:(null===(r=y.n.getInstance())||void 0===r?void 0:r.shouldShowInDocSensitivityLabel())?(0,v.ny)():void 0,telemetryData:(0,u.YI)(f.SD.Translate,h.Ff.TranslatePresentation)}})},T=function(e,t,n){var r;null===(r=e.current)||void 0===r||r.updateMessage({chatCardType:i._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:c.uz.TranslationCard,props:{cardType:c.wv.TextMessageCard,textMessage:n},shouldMemoizeComponent:!1}}},chatMessageBodyData:{messageId:t}})},w=function(e,t,n){return{language:t,languageCode:n,messageId:e}},I=function(e,t){var n;g.B.getInstance().sendChatEventTelemetry((0,m.pN)((n={},(0,r._)(n,h.h3.ChatEventType,h.a5.TranslatedPresentationURLClicked),(0,r._)(n,h.h3.ChatEventParameters,JSON.stringify(t)),n))),window.open(e,"_blank")},P=function(e,t){var n=e.replace(/\.[^/.]+$/,""),r=e.split(".").pop();return"".concat(n,"_").concat(t,".").concat(r)}},60801:(e,t,n)=>{"use strict";n.d(t,{A:()=>L,kb:()=>O});var r=n(43032),o=n(90813),i=n(79490),a=n(53154),s=n(93176),l=n(24643),c=n(10229),u=n(69038),d=n(61339),p=n(81789),f=n(12542),h=n(39726),g=n(44121),m=n(14213),y=n(44632),v=n(72702),S=n(25420),C=n(60849),b=n(18758),E=n(18384),T=n(23343),w=n(4809),I=n(32854),P=n(55564),_=n(31041),A=n(72218),k=m.K.getInstance(),x=y.B.getInstance(),N=d.R.getInstance(),O=function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=arguments.length>4?arguments[4]:void 0;switch(t){case h.e0.OrganizeStructuredPresentation:return(0,P.PA)(P.IY.SetScenarioNameEnabled)&&k.setScenarioName(g.Cu.Organize),d&&(d.featureName=f.CC.Organize,d.subFeatureName=f.Ff.Organize),{chatCardType:s._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:l.Q9.Chat,warningPrefix:PowerpointCopilotStrings.WarningAlreadyStructuredPresentation}},chatMessageBodyData:{feedbackSectionPosition:c.O.None,feedbackData:(0,I.as)(h.Xw.CHATPPT,d),warningActionButtons:[{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelYesPlease,buttonText:PowerpointCopilotStrings.WarningButtonLabelYesPlease,handleButtonOnClick:(0,r._)((function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return D(PowerpointCopilotStrings.WarningButtonLabelYesPlease,e,!1,n),x.sendChatEventTelemetry((0,E.pN)((0,o._)({},f.h3.ChatEventType,f.a5.OrganizePresentationButtonClicked))),p.R.getInstance().setState(h.Nj.EXECUTING),[4,PowerPoint.run((a=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,S.O)(e)];case 1:return t.sent(),(0,P.PA)(P.IY.SetScenarioNameEnabled)||k.setScenarioName(g.Cu.Organize),[2]}}))})),function(e){return a.apply(this,arguments)}))];case 1:return t.sent(),N.resetCachedRequestParameters(),[2]}var a}))})),isDisabled:u},{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelNoThanks,buttonText:PowerpointCopilotStrings.WarningButtonLabelNoThanks,handleButtonOnClick:(0,r._)((function(){return(0,i.__generator)(this,(function(t){return D(PowerpointCopilotStrings.WarningButtonLabelNoThanks,e,!0,n),R(g.SD.Organize,f.Ff.Organize),a.G.getInstance().emptyContextIdListandCleanup(),p.R.getInstance().setState(h.Nj.IDLE),N.resetCachedRequestParameters(),(0,T.k)(!1,(0,P.PA)(P.IY.DifferentiateCancelFromWarningCard)?g.tp.CancelledFromWarningCard:g.tp.Cancelled),[2]}))})),isDisabled:u}]},stopLoadingUi:!1};case h.e0.CreateNewPresentationFromExisting:var m=N.getCachedRequestParameters();return(0,P.PA)(P.IY.SetScenarioNameEnabled)&&(m.sources&&m.sources.length>0?k.setScenarioName(g.Cu.CreatePresentationFromDoc):k.setScenarioName(g.Cu.CreatePresentation)),d&&(d.featureName=f.CC.CreatePresentationFromDoc,d.subFeatureName=f.Ff.CreateFromFile),{chatCardType:s._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:l.Q9.Chat,warningPrefix:PowerpointCopilotStrings.WarningCreateNewPresentation}},chatMessageBodyData:{feedbackSectionPosition:c.O.None,feedbackData:(0,I.as)(h.Xw.CHATPPT,d),warningActionButtons:[{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelYesPlease,buttonText:PowerpointCopilotStrings.WarningButtonLabelYesPlease,handleButtonOnClick:(0,r._)((function(){var t;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return D(PowerpointCopilotStrings.WarningButtonLabelYesPlease,e,!1,n),null===(t=e.current)||void 0===t||t.startLoadingUi(),x.sendChatEventTelemetry((0,E.pN)((0,o._)({},f.h3.ChatEventType,f.a5.CreatePresentationButtonClicked))),p.R.getInstance().setState(h.Nj.EXECUTING),[4,PowerPoint.run((s=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return m.sources&&m.sources.length>0?((0,b.cY)("generateSlides call callContentProcessingAnnotationWorkflow with source:",m.sources.join(", ")),[4,(0,v.Pb)(m.sources,m.prompt)]):[3,2];case 1:return t.sent(),(0,P.PA)(P.IY.SetScenarioNameEnabled)||k.setScenarioName(g.Cu.CreatePresentationFromDoc),[3,4];case 2:return(0,b.cY)("generateSlides call storyTellerWorkflow with prompt:",prompt),[4,(0,C.A)(m.prompt,!1,e,m.groundingInfo)];case 3:t.sent(),(0,P.PA)(P.IY.SetScenarioNameEnabled)||k.setScenarioName(g.Cu.CreatePresentation),t.label=4;case 4:return N.resetCachedRequestParameters(),[2]}}))})),function(e){return s.apply(this,arguments)}))];case 1:return a.sent(),[2]}var s}))})),isDisabled:u},{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelNoThanks,buttonText:PowerpointCopilotStrings.WarningButtonLabelNoThanks,handleButtonOnClick:(0,r._)((function(){return(0,i.__generator)(this,(function(t){return D(PowerpointCopilotStrings.WarningButtonLabelNoThanks,e,!0,n),R(g.SD.CreatePresentation,k.getScenarioName()==g.Cu.CreatePresentationFromDoc?f.Ff.CreateFromFile:f.Ff.CreatePresentation),a.G.getInstance().emptyContextIdListandCleanup(),p.R.getInstance().setState(h.Nj.IDLE),N.resetCachedRequestParameters(),(0,T.k)(!1,(0,P.PA)(P.IY.DifferentiateCancelFromWarningCard)?g.tp.CancelledFromWarningCard:g.tp.Cancelled),[2]}))})),isDisabled:u}]},stopLoadingUi:!1};case h.e0.LaunchNBToCreatePresentation:return(0,_.n)(e,A.u1i)}return{}},D=function(e,t,n,r){var i,a;L(t),r(!1),null==t||null===(i=t.current)||void 0===i||i.updateLoadingComponentProps({shouldShowLoadingUi:!0}),null==t||null===(a=t.current)||void 0===a||a.addResponseMessage({chatCardType:s._.Default,chatMessageData:{defaultMessageProps:{user:l.Q9.Human,messageHeader:{text:e}}},stopLoadingUi:n}),N.setWarningMessageActive(!1),N.setWarningCardUserInteractionTimeInSec(),x.sendLatencyTelemetry((0,E.pN)((0,o._)({},f.CT.WarningMessageUserInteractionTime,N.getWarningCardUserInteractionTimeInSec())),!1),(0,b.cY)("Warning Message action button clicked - ",e)},L=function(e){null==e||e.current.updateLastMessage({chatCardType:s._.WarningMessage,chatMessageBodyData:{warningActionButtons:[]},stopLoadingUi:!1,addCardToChatHistory:!1})},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.SD.CopilotChat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.Ff.Unset;x.sendChatEventTelemetry((0,E.pN)((0,o._)({},f.h3.ChatEventType,f.a5.CancelButtonClicked)));var n,r=(0,w.Uv)(f.G8.UserCancelledResponse,f.av.UserAbortedQueryExecution);x.logAshaErrorEvent(r.vetoName,r.errorString,r.featureName),x.logTriedEvent(e,t,(0,w.d3)(e)),x.sendLatencyTelemetry((0,E.pN)((n={},(0,o._)(n,f.CT.AnnotationType,f.a5.CancelButtonClicked),(0,o._)(n,f.CT.FeatureName,e),(0,o._)(n,f.CT.SubFeatureName,t),n))),(0,E.AQ)(x,u.qD)}},70941:(e,t,n)=>{"use strict";n.d(t,{Bx:()=>le,CS:()=>re,Ep:()=>J,Gm:()=>te,NG:()=>W,Vq:()=>Y,Xg:()=>ne,dG:()=>K,eK:()=>ee,fw:()=>Z,jo:()=>ce,le:()=>oe,zP:()=>Q});var r,o,i,a=n(43032),s=n(90813),l=n(57835),c=n(61838),u=n(81092),d=n(79490),p=n(27465),f=n(85535),h=n(93176),g=n(24643),m=n(10229),y=n(69038),v=n(33145),S=n(26940),C=n(12542),b=n(18758),E=n(44632),T=n(74930),w=n(34045),I=n(55564),P=n(72218),_=n(43277),A=n(81789),k=n(39726),x=n(44121),N=n(98483),O=n(18384),D=n(71822),L=n(65817),R=n(37745),F=n(29336),M=n(32854),B=n(53935),U=n(2061),z=n(4809),H="",G={};function V(){try{var e=window.location.href.match(/\/([0-9.]+)\/en-us_web\//);return null==e||e.length<2?"":e[1]}catch(e){return(0,b.cY)("Error in getting pane build number, message: ".concat(e.message)),""}}!function(e){e.Text2ImageError="SkillFailedError:Text2ImageError_insert_graphic",e.InputQueryError="SkillFailedError:InputQueryError_insert_graphic",e.InferenceAPIError="SkillFailedError:InferenceAPIError_insert_graphic",e.OffensiveContent="SkillFailedError:OffensiveContent_insert_graphic",e.DesignerBrandImagesNotFound="SkillFailedError:DesignerBrandImagesNotFound_insert_graphic",e.DesignerBrandLibraryNotConfigured="SkillFailedError:DesignerBrandLibraryNotConfigured_insert_graphic",e.UnknownError="SkillFailedError:Error_insert_graphic"}(r||(r={})),function(e){e.Text2ImageError="Text2ImageError",e.InputQueryError="InputQueryError",e.InferenceAPIError="InferenceAPIError",e.OffensiveContent="OffensiveContent",e.ByDesign="ByDesign",e.Unknown="Unknown"}(o||(o={})),function(e){e.RAIBlocklistError="RAIBlocklistError",e.BackendOrUnexpectedError="BackendOrUnexpectedError",e.FailedToProcessDALLEImageInPanelViewError="Failed to process DALLE image in panel view",e.ImageLoadResultsError="ImageLoadResults Error",e.DalleEndpointError="Received back error from DALLE endpoint",e.TemplateRequestError="Template Request Error"}(i||(i={}));var j,q=function(){switch(_.i.GetHostAppPlatform()){case P.xb6:return"MacOS";case P.TTX:return"iOS";case P.nAd:return"Win32";case P.q93:default:return"Web"}},W=function(){return{hostAppName:"PowerPointCopilotChat",clientId:(0,N.A)(),designerTheme:(e=(0,v.$x)(),t=(0,v.R2)(),e===U.GmK.defaultBlack||e===U.GmK.defaultDarkGrey?t?"highContrast":"dark":e===U.GmK.defaultWhite?"light":"auto"),platformType:q(),hostBuildVersion:V(),sessionId:w.Vv.getSettingAsString(w.zj.ChatPPTSessionID),selectedDesignerEnv:(0,U.zt4)(w.Vv.getSettingAsString(w.zj.AugLoopCloudALServiceUrl),(0,I.bw)(I.WT.IsDesignerDogfoodEndpointEnabled),(0,I.PA)(I.IY.EnableClientEnvironmentDetection)),uiLanguage:(0,R.hD)(_.i.GetHostAppDisplayLanguage()),audienceGroup:(0,w.I_)()?"Dogfood":"Production",showFeedBackSection:!1};var e,t},Y=function(e){E.B.getInstance().logTriedEvent(x.SD.DesignerVisuals,C.Ff.AddDesignerImage,f.RX.Create,e)},Q=function(e){var t;E.B.getInstance().sendChatEventTelemetry((0,O.pN)((t={},(0,s._)(t,C.h3.ChatEventType,C.a5.PptCopilotEditScn),(0,s._)(t,C.h3.ChatEventParameters,"isSuccess, + ".concat(e)),t)))},J=function(e){return"bot"===e.author&&e.messageType===S.n3.RenderCardRequest&&e.contentOrigin===k.wz.DESIGNER_INSERT_GRAPHIC},X=function(e){var t="";switch(e){case B.b.Designer:t=(0,U.Csj)()?OfficeaicopilotStrings.DesignerFallbackToDalleApologyMessage:"Apologies, I can't do this yet. Here are some generated images that match your search and may be useful.";break;case B.b.StockImage:default:t=(0,U.Csj)()?OfficeaicopilotStrings.DesignerFallbackToStockApologyMessage:"Apologies, I can't do this yet. Here are some stock images that match your search that may be useful."}return t},K=function(e,t){var n=(0,U.v_Q)(e),r={payload:{designerPrompt:n,stockQuery:n,imageType:B.b.Designer}};e.text=JSON.stringify(r),Z(e,t,!0)},Z=function(e,t,n){F.r.getInstance().setSkillName(k.B2.Designer);var r=E.B.getInstance().getQueryGuid(),o=le(r);try{if((null==e?void 0:e.text)&&(0,I.bw)(I.WT.IsDesignerCopilotEnabled)){var i,a,s,d,p,f,y,v,S,T,w,P,_,A,O;(0,b.cY)("Designer Init: Designer Graphics skill invoked. Payload: ",e.text);var D=JSON.parse(e.text),L=null===(i=D.payload)||void 0===i?void 0:i.imageType,R=null===(a=D.payload)||void 0===a?void 0:a.isFallbackScenario,U=null===(d=D.payload)||void 0===d||null===(s=d.images)||void 0===s?void 0:s.map((function(e){return{url:e.imageId,description:e.description,altText:e.altText,license:e.license,thumbnail:e.thumbnail,pac:e.pac}})),z=null===(p=D.payload)||void 0===p?void 0:p.clientSessionId,V=null===(v=D.payload)||void 0===v||null===(y=v.images)||void 0===y||null===(f=y[0])||void 0===f?void 0:f.companyName,j=null===(S=D.payload)||void 0===S?void 0:S.objectId,q=null===(T=D.payload)||void 0===T?void 0:T.tenantId;R&&function(e,t){var n,r=X(e);null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:h._.Default,chatMessageData:{defaultMessageProps:{user:g.Q9.Chat,messageHeader:{text:r}}}})}(L,t);var W,Y,Q={width:1317,height:366};H=(0,N.A)();var J,K=L===B.b.Banner?null!==(W=null===(w=D.payload)||void 0===w?void 0:w.designerPrompt)&&void 0!==W?W:"":null!==(Y=null===(P=D.payload)||void 0===P?void 0:P.stockQuery)&&void 0!==Y?Y:"",Z=(0,I.bw)(I.WT.IsEnterpriseBase64ImageEnabled)&&!(null==U||null===(A=U[0])||void 0===A||null===(_=A.url)||void 0===_?void 0:_.startsWith("https")),$=[B.b.StockImage,B.b.Icon,!Z&&B.b.Enterprise].includes(L),ee=Z&&L===B.b.Enterprise;if((0,I.bw)(I.WT.UseDesignerPromptForDalle)&&L===B.b.Designer)K=null===(J=D.payload)||void 0===J?void 0:J.designerPrompt;var te=(0,M.as)(k.Xw.DESIGNERCARD,{featureName:x.SD.DesignerVisuals,subFeatureName:C.Ff.AddDesignerImage}),ne=te.contextData,re=(0,c._)((0,l._)({},te),{contextData:(0,c._)((0,l._)({},ne),{feedbackContextData:(0,c._)((0,l._)({},null==ne?void 0:ne.feedbackContextData),{ALGeneratedPrompt:K,imageType:L}),cardMetaData:JSON.stringify((0,c._)((0,l._)({},JSON.parse((null==ne?void 0:ne.cardMetaData)||"{}")),{ALGeneratedPrompt:K,imageType:L}))})});G=(0,I.bw)(I.WT.EnableDesignerFeedbackDataForDebugMode)?re:te,null===(O=t.current)||void 0===O||O.addResponseMessage({chatCardType:h._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:K,renderData:{component:k.uz.DesignerCard,props:{user:g.Q9.Chat,message:K,turnId:r,isStockQuery:$,stockImages:ee?void 0:U,base64ImageData:ee?U.map((function(e){return e.url})):void 0,imageType:L,isAuthEnabled:L!==B.b.Banner,bannerWidth:L===B.b.Banner?Q.width:void 0,bannerHeight:L===B.b.Banner?Q.height:void 0,clientSessionId:z,objectId:j,tenantId:q,companyName:V},shouldMemoizeComponent:!0}}},chatMessageBodyData:{feedbackSectionPosition:m.O.Footer,feedbackData:G,shouldShowAIPoweredIndicator:$||ee,messageId:H},addCardToChatHistory:$||ee}),E.B.getInstance().sendChatEventTelemetry((0,u._)(o).concat([{key:C.h3.ChatEventType,value:n?C.a5.DesignerResponseShownForDCs:C.a5.DesignerResponseShown},{key:C.h3.ImageType,value:L}]))}else{var oe;null===(oe=t.current)||void 0===oe||oe.addResponseMessage({chatCardType:h._.Default,chatMessageData:{defaultMessageProps:{user:g.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.CommandNotSupportedMessage}}},chatMessageBodyData:{messageId:H,feedbackSectionPosition:m.O.Footer,feedbackData:(0,M.as)(k.Xw.DESIGNERCARD)},addCardToChatHistory:!0}),(0,b.cY)("Triggered Designer Graphics: Empty message text"),E.B.getInstance().sendChatEventTelemetry((0,u._)(o).concat([{key:C.h3.ChatEventType,value:C.a5.EmptyDesignerResponse},{key:C.h3.ChatErrorType,value:k.T_.Server},{key:C.h3.ChatErrorKey,value:C.Nr.DesignerVisualsEmptyResponse}]))}return}catch(e){return(0,b.cY)("Error parsing Designer Graphics response message"),E.B.getInstance().sendErrorTelemetry((0,u._)(o).concat([{key:C.IC.ErrorCategory,value:C.S2.Designer},{key:C.IC.ErrorMessage,value:"Error parsing Designer Graphics response message: "+e.message}])),void E.B.getInstance().sendChatEventTelemetry((0,u._)(o).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerSkillResponseParseError},{key:C.h3.ChatEventParameters,value:"Error parsing Designer Graphics response message: ".concat(e.message)},{key:C.h3.ChatErrorType,value:k.T_.Server},{key:C.h3.ChatErrorKey,value:C.Nr.DesignerVisualsSkillResponseParseError}]))}},$=function(e){(null==e?void 0:e.current)&&(e.current.removeAttribute("aria-label"),setTimeout((function(){var t;null==e||null===(t=e.current)||void 0===t||t.setAttribute("aria-label",(0,U.Csj)()?OfficeaicopilotStrings.ImageInsertionSuccessAnnouncement:"Your image has been inserted.")}),1))},ee=(j=(0,a._)((function(e){var t,n,r,o,i,s,l,c,h,g,m,v,S,w,P,_,O,R,F,M,B=arguments;return(0,d.__generator)(this,(function(U){switch(U.label){case 0:if(t=B.length>1&&void 0!==B[1]?B[1]:"",n=B.length>2&&void 0!==B[2]?B[2]:"",r=B.length>3&&void 0!==B[3]?B[3]:"",o=B.length>4?B[4]:void 0,i=B.length>6&&void 0!==B[6]?B[6]:"",s=B.length>7?B[7]:void 0,l=B.length>8&&void 0!==B[8]?B[8]:"",c=B.length>9&&void 0!==B[9]?B[9]:"",h=B.length>10?B[10]:void 0,A.R.getInstance().getState()!==k.Nj.IDLE)return(0,b.cY)("Designer Mini insertion triggered while in a non-idle execution state"),[2];A.R.getInstance().setState(k.Nj.EXECUTING),g=new Date,o.setScenarioName(x.Cu.InsertImageDesignerMini),o.setStartTime(g.toISOString()),m=(0,N.A)(),v=(0,u._)(le(l)).concat([{key:C.h3.UniqueActionId,value:m},{key:C.h3.ImageType,value:c}]),E.B.getInstance().sendChatEventTelemetry((0,u._)(v).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerImageInsertStart}])),S={status:k.rI.FAILED},U.label=1;case 1:return U.trys.push([1,3,,4]),(0,b.cY)("Inserting Image from Designer Mini"),w=[],P={},_={trigger:(0,I.bw)(I.WT.DisableSuggestionOnImageInsert)?x._E.None:x._E.DocumentChanges},P.designerOptions=JSON.stringify(_),O={scenarioName:o.getScenarioName(),featureName:o.getFeatureName(),subFeatureName:o.getSubFeatureName(),capability:o.getCapability(),startTime:o.getStartTime(),entryPoint:"Chat",correlationId:m,uniqueActionId:l,timeToODSLMS:-1,timeODSLToJOfcMS:-1},P.scenarioOptions=JSON.stringify(O),[4,PowerPoint.run(function(){var o=(0,a._)((function(o){var a,s,l;return(0,d.__generator)(this,(function(c){switch(c.label){case 0:return a={url:e,description:t,altText:n,license:r,pac:i},[4,(0,D.R)({context:o,slides:w,imageData:a})];case 1:return s=c.sent(),l=[s],[4,(0,L.Rf)(o,l,P)];case 2:return S=c.sent(),(0,b.cY)("Log result : ",JSON.stringify(S)),[2]}}))}));return function(e){return o.apply(this,arguments)}}())];case 2:return U.sent(),[3,4];case 3:return R=U.sent(),(0,b.cY)("Execute failed:"+JSON.stringify(R)),E.B.getInstance().sendErrorTelemetry((0,u._)(v).concat([{key:C.IC.ErrorCategory,value:C.S2.Designer},{key:C.IC.ErrorMessage,value:"Error thrown during image insertion via AddPictureCmd. Message=".concat(R.message)}])),E.B.getInstance().sendChatEventTelemetry((0,u._)(v).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerImageInsertError},{key:C.h3.ChatEventParameters,value:"Error thrown during image insertion via AddPictureCmd. Message=".concat(R.message)},{key:C.h3.ChatErrorType,value:k.T_.Client},{key:C.h3.ChatErrorKey,value:C.Nr.DesignerVisualsInsertError}])),S={status:k.rI.FAILED,error:k.Re.JOFC_EXCEPTION},[3,4];case 4:return E.B.getInstance().sendLatencyTelemetry((0,u._)(v).concat([{key:C.CT.RequestSignalType,value:"DesignerImageInsertion"},{key:C.CT.ImageInsertionTime,value:(0,y.WU)(g.getTime())},{key:C.CT.IsImageInsertionSuccess,value:S.status===k.rI.SUCCESS||S.status===k.rI.PARTIAL_SUCCESS}]),!0),z=v,E.B.getInstance().logKeptEvent(x.SD.DesignerVisuals,C.Ff.AddDesignerImage,f.RX.Create,z),S.status===k.rI.SUCCESS?($(h),E.B.getInstance().sendChatEventTelemetry((0,u._)(v).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerImageInsertEnd}]))):((0,I.PA)(I.IY.IsJofcCommandErrorTelemetryEnabled)&&E.B.getInstance().sendChatEventTelemetry((0,u._)(v).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerImageInsertJOfcCommandsError},{key:C.h3.ChatEventParameters,value:k.Re[null!==(F=S.error)&&void 0!==F?F:k.Re.UNKNOWN_ERROR]},{key:C.h3.ChatErrorType,value:k.T_.Client},{key:C.h3.ChatErrorKey,value:C.Nr.DesignerVisualsInsertJOfcCommandsError}])),M=new T.DA({status:p.Aw.failed,queryId:l,error:PowerpointCopilotStrings.ErrorInExecution}),s(S,M,C.S2.Designer)),o.resetData(),A.R.getInstance().setState(k.Nj.IDLE),[2]}var z}))})),function(e){return j.apply(this,arguments)}),te=function(){var e=(0,a._)((function(e,t){var n,r,o,i,a,s,u;return(0,d.__generator)(this,(function(d){return(r=null===(n=t.current)||void 0===n?void 0:n.getLastMessage())&&r.messageType===h._.ChatCardWrapper&&e.dcHint&&(i=r.body,(null===(o=i.renderData)||void 0===o?void 0:o.component)===k.uz.DesignerCard&&((0,b.cY)("Updating DesignerMini file cache info:"+JSON.stringify(e)),(s=null===(a=i.renderData)||void 0===a?void 0:a.props).fileCacheInfo||s.isStockQuery||null===(u=t.current)||void 0===u||u.updateLastMessage({chatCardType:h._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:k.uz.DesignerCard,props:(0,c._)((0,l._)({},s),{fileCacheInfo:e}),shouldMemoizeComponent:!0}}},addCardToChatHistory:!1}))),[2]}))}));return function(t,n){return e.apply(this,arguments)}}(),ne=function(e,t){var n;(0,b.cY)("historyEventData received from designer: ",e.data);var r=null==t||null===(n=t.current)||void 0===n?void 0:n.getLastMessage(),o=E.B.getInstance().getQueryGuid(),i=le(o);if(r&&r.messageType===h._.ChatCardWrapper&&e){var a,s=r.body;if((null===(a=s.renderData)||void 0===a?void 0:a.component)===k.uz.DesignerCard){var d,p=null===(d=s.renderData)||void 0===d?void 0:d.props,f=(0,I.PA)(I.IY.IsDalleImageRehydrationEnabled)&&p.imageType===B.b.Designer;if(!p.base64ImageData&&f){var g,y,v,S,T,w,P,_,A=null===(g=p.message)||void 0===g?void 0:g.toString(),x=e.data;E.B.getInstance().sendChatEventTelemetry((0,u._)(i).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerBase64ImagesReceived},{key:C.h3.ChatEventParameters,value:(null!==(w=null===(y=x.data.base64Thumbnail)||void 0===y?void 0:y.length)&&void 0!==w?w:0)>0?"success":"failure"}]));var N=(0,c._)((0,l._)({},p),{base64ImageData:x.data.base64Thumbnail,generatedImageUrls:x.data.imgUrl,historyEventLocale:null!==(P=null===(v=x.metadata)||void 0===v?void 0:v.locale)&&void 0!==P?P:"",historyEventLanguage:null!==(_=null===(S=x.metadata)||void 0===S?void 0:S.language)&&void 0!==_?_:"",historyEventTimeStamp:x.timeStamp});null===(T=t.current)||void 0===T||T.updateLastMessage({chatCardType:h._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:A,renderData:{component:k.uz.DesignerCard,props:N,shouldMemoizeComponent:!0}}},chatMessageBodyData:{feedbackSectionPosition:m.O.Footer,feedbackData:G,messageId:H,chatHydrationKeys:{imagesKey:"base64ImageData"}}})}}}},re=function(e){var t,n,r,o="",i="",a=C.a5.DesignerMiniUnclassifiedError,s="";try{var l;if(t=ae(e.message,"hostCorrelationId"),n=ae(e.message,"imageType"),""!==(o=null===(l=e.message)||void 0===l?void 0:l.split(";")[0])&&o.includes(":")){var c=o.indexOf(":");i=o.substring(c+1).trim(),o=o.substring(0,c).trim()}var d=i.includes("auth");switch(o){case"RAIBlocklistError":a=C.a5.DesignerMiniRAIBlocklistError,r={vetoName:(0,O.A9)(C._5.DesignerVisuals,C.G8.RAIError),errorString:C.av.OffensiveContentError,featureName:C.CC.DesignerVisuals};break;case"BackendOrUnexpectedError":case"Failed to process DALLE image in panel view":case"ImageLoadResults Error":case"Received back error from DALLE endpoint":case"Template Request Error":a=d?C.a5.DesignerMiniAuthError:C.a5.DesignerMiniServiceBlockError,s=i?"".concat(o,": ").concat(i):o,r={vetoName:(0,O.A9)(C._5.DesignerVisuals,C.G8.DesignerMiniError),errorString:d?C.av.DesignerMiniAuthError:C.av.DesignerMiniError,featureName:C.CC.DesignerVisuals};break;default:s=i?"".concat(o,": ").concat(i):o,r={vetoName:(0,O.A9)(C._5.DesignerVisuals,C.G8.UnclassifiedAshaError),errorString:C.av.UnknownError,featureName:C.CC.DesignerVisuals}}E.B.getInstance().sendErrorTelemetry((0,u._)(le(t)).concat([{key:C.IC.ErrorCategory,value:C.S2.Designer},{key:C.IC.ErrorMessage,value:"Designer Mini Error=".concat(e.message)},{key:C.h3.ImageType,value:n}])),E.B.getInstance().sendChatEventTelemetry((0,u._)(le(t)).concat([{key:C.h3.ChatEventType,value:a},{key:C.h3.ChatEventParameters,value:s},{key:C.h3.ImageType,value:n},{key:C.h3.ChatErrorType,value:k.T_.Server},{key:C.h3.ChatErrorKey,value:C.Nr.DesignerMiniError}])),(0,I.PA)(I.IY.IsASHAErrorLoggingEnabledForDesignerSideErrors)&&E.B.getInstance().logAshaErrorEvent(r.vetoName,r.errorString,r.featureName)}catch(e){(0,b.cY)("Error parsing Designer Mini error message"),E.B.getInstance().sendErrorTelemetry((0,u._)(le(t)).concat([{key:C.IC.ErrorCategory,value:C.S2.Designer},{key:C.IC.ErrorMessage,value:"Error parsing Designer Mini error message: "+e.message},{key:C.h3.ImageType,value:n}])),E.B.getInstance().sendChatEventTelemetry((0,u._)(le(t)).concat([{key:C.h3.ChatEventType,value:a},{key:C.h3.ChatEventParameters,value:"Error parsing Designer Mini error message: "+e.message},{key:C.h3.ImageType,value:n},{key:C.h3.ChatErrorType,value:k.T_.Server},{key:C.h3.ChatErrorKey,value:C.Nr.DesignerMiniError}]))}},oe=function(e){try{E.B.getInstance().sendChatEventTelemetry((0,u._)(se).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerMiniEvent},{key:C.h3.ChatEventParameters,value:JSON.stringify(e.data)}])),ie(e.data)}catch(e){(0,b.cY)("Error parsing Designer Mini telemetry message"),E.B.getInstance().sendErrorTelemetry((0,u._)(se).concat([{key:C.IC.ErrorCategory,value:C.S2.Designer},{key:C.IC.ErrorMessage,value:"Error parsing Designer Mini telemetry message: "+e.message}]))}},ie=function(e){if(e.data){var t=JSON.parse(e.data);if(t&&"number"==typeof t.DurationSinceBoot&&t.DurationSinceBoot>0){var n=t.DurationSinceBoot,r="string"==typeof t.hostCorrelationId?t.hostCorrelationId:"",o="boolean"==typeof t.isRehydration&&t.isRehydration,i="string"==typeof t.imageType?t.imageType:"";o||E.B.getInstance().sendLatencyTelemetry((0,u._)(le(r)).concat([{key:C.CT.RequestSignalType,value:"Designer_Boot_Time"},{key:C.CT.DesignerBootTime,value:n},{key:C.CT.ImageType,value:i}]),!0)}}};function ae(e,t){t+=":";var n=e.indexOf("".concat(t));return n<0?"":e.substring(n+t.length).split(";")[0]}var se=[{key:C.CT.FeatureName,value:x.SD.DesignerVisuals},{key:C.CT.SubFeatureName,value:C.Ff.AddDesignerImage}],le=function(e){return void 0===e&&(e=E.B.getInstance().getQueryGuid()),(0,u._)(se).concat([{key:C.h3.UserQueryGuid,value:e}])},ce=function(e){var t,n="Unknown",r=C.Nr.DesignerVisualsUnknownError,o=k.T_.Server,i=C.a5.ErrorResponseSignalSent;switch(e){case"SkillFailedError:Text2ImageError_insert_graphic":n="Text2ImageError",r=C.Nr.DesignerVisualsText2ImageError,t=(0,z.Uv)(C.G8.Text2ImageError,C.av.Text2ImageGenericError);break;case"SkillFailedError:InputQueryError_insert_graphic":n="InputQueryError",o=k.T_.UnsupportedAction,r=C.Nr.DesignerVisualsUnsupportedImageTypeError,t=(0,z.Uv)(C.G8.UnsupportedCopilotFunctionality,C.av.DesignerVisualsUnsupportedImageType);break;case"SkillFailedError:InferenceAPIError_insert_graphic":n="InferenceAPIError",r=C.Nr.DesignerVisualsLLMError,t=(0,z.Uv)(C.G8.ServiceSideIssuePreventsOutput,C.av.DesignerVisualsInferenceAPIError);break;case"SkillFailedError:OffensiveContent_insert_graphic":n="OffensiveContent",r=C.Nr.DesignerVisualsStockRAIError;break;case"SkillFailedError:DesignerBrandImagesNotFound_insert_graphic":case"SkillFailedError:DesignerBrandLibraryNotConfigured_insert_graphic":n="ByDesign",i=C.a5.DesignerDiscountedError;break;default:t=(0,z.Uv)(C.G8.UnclassifiedAshaError,C.av.UnknownError)}return"ByDesign"===n?E.B.getInstance().sendChatEventTelemetry((0,u._)(le()).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerDiscountedError},{key:C.h3.ChatEventParameters,value:e}])):E.B.getInstance().sendChatEventTelemetry((0,u._)(le()).concat([{key:C.h3.ChatEventType,value:C.a5.DesignerSkillError},{key:C.h3.ChatEventParameters,value:n},{key:C.h3.ChatErrorType,value:o},{key:C.h3.ChatErrorKey,value:r}])),{designerVisualsErrorResultType:i,designerVisualsASHAErrorDetails:t}}},81789:(e,t,n)=>{"use strict";n.d(t,{R:()=>l});var r=n(11912),o=n(91165),i=n(90813),a=n(39726),s=n(18758),l=function(){function e(){(0,r._)(this,e),(0,i._)(this,"executionState",void 0),this.executionState=a.Nj.IDLE}return(0,o._)(e,[{key:"setState",value:function(e){(0,s.cY)("Execution state set: ".concat(e)),this.executionState=e}},{key:"getState",value:function(){return this.executionState}}],[{key:"getInstance",value:function(){return e.executionStateManager||(e.executionStateManager=new e),e.executionStateManager}}]),e}();(0,i._)(l,"executionStateManager",void 0)},72468:(e,t,n)=>{"use strict";n.d(t,{EL:()=>M,Hv:()=>F,YT:()=>D,kt:()=>L,ox:()=>B,rc:()=>R,zH:()=>U});var r=n(43032),o=n(90813),i=n(57835),a=n(79490),s=n(61542),l=n(18758),c=n(82808),u=n(17223),d=n(9669),p=n(8349),f=n(93176),h=n(24643),g=n(10229),m=n(72218),y=n(39041),v=n(57308),S=n(12542),C=n(44632),b=n(55564),E=n(18384),T=n(39726),w=n(24464),I=n(50481),P=n(73606),_=n(44001),A=n(32854),k=n(44121),x=n(47350),N=n(78289),O=C.B.getInstance(),D=new Map,L=function(e,t){D.set(e,t)},R=function(e,t){var n=D.get(e);if(n){var r=(0,i._)({},n,t);D.set(e,r)}else(0,l.cY)("Notification with key ".concat(e," does not exist."))},F=function(e){D.has(e)?D.delete(e):(0,l.cY)("Notification with key ".concat(e," does not exist."))},M=function(e){return D.has(e)},B=function(e){return D.get(e)},U=function(e){var t,n,r;(0,l.cY)("completionNotificationSuccessButtonClick, telemetryData: ".concat(e));var i,a,s=(0,A.zq)(null!=e?e:m.u1i).correlationId;c.A.disableSuccessButton(s,u.t.getInstance().getChatRef()),O.sendChatEventTelemetry((0,E.pN)((a={},(0,o._)(a,S.h3.UserQueryGuid,null!=s?s:m.u1i),(0,o._)(a,S.h3.ChatEventType,S.a5.NotificationCardUpdated),(0,o._)(a,S.h3.ChatEventParameters,m.E61),(0,o._)(a,S.h3.UniqueActionId,null!==(i=null===(t=B(null!=s?s:m.u1i))||void 0===t?void 0:t.uniqueActionID)&&void 0!==i?i:m.u1i),a)),void 0);var d=null===(r=B(null!=s?s:m.u1i))||void 0===r||null===(n=r.NotificationAnnotation)||void 0===n?void 0:n.actionParameters;if(void 0!==d){var p=d[0].annotations;if(void 0!==p&&p.length>0)!function(e,t){z.apply(this,arguments)}(p[0].type,p[0].value)}else{var f,h,g;(0,l.cY)("success Button clicked with undefined actionParameters"),O.sendChatEventTelemetry((0,E.pN)((g={},(0,o._)(g,S.h3.UserQueryGuid,null!=s?s:m.u1i),(0,o._)(g,S.h3.ChatEventType,S.a5.NotificationCardUpdated),(0,o._)(g,S.h3.ChatEventParameters,m.kFG),(0,o._)(g,S.h3.ChatErrorType,T.T_.Server),(0,o._)(g,S.h3.UniqueActionId,null!==(h=null===(f=B(null!=s?s:m.u1i))||void 0===f?void 0:f.uniqueActionID)&&void 0!==h?h:m.u1i),g)),void 0)}F(null!=s?s:m.u1i)};function z(){return(z=(0,r._)((function(e,t){return(0,a.__generator)(this,(function(n){switch((0,l.cY)("handleVisualSummaryNotification Response, type: ".concat(e)),e){case d.c.getTypeName():H(t);break;case p.kb.getTypeName():break;default:(0,l.cY)("Unknown type received for Visual Summary Response: ".concat(e))}return[2]}))}))).apply(this,arguments)}var H=function(e){var t,n,r=null==e?void 0:e.body;(0,l.cY)("PowerPointCopilotOutputAnnotation Notification: ".concat(JSON.stringify(r)));var i,a,c,p,C,D,L,R,F,M,U,z,H=null==r||null===(n=r.chatResponse)||void 0===n||null===(t=n.messages)||void 0===t?void 0:t.find((function(e){return(0,v.Jw)(e)}));if((0,y.hX)(r)||(0,y.hX)(H))return(0,l.cY)("finalMessage is undefined for Notification Response"),O.sendChatEventTelemetry((0,E.pN)((D={},(0,o._)(D,S.h3.UserQueryGuid,null!==(c=null==r?void 0:r.queryId)&&void 0!==c?c:m.u1i),(0,o._)(D,S.h3.ChatEventType,S.a5.EmptyMessageReceivedFromSummarySkill),(0,o._)(D,S.h3.ChatEventParameters,m.VwD),(0,o._)(D,S.h3.ChatErrorType,T.T_.Server),(0,o._)(D,S.h3.UniqueActionId,null!==(C=null===(i=B(null!==(p=r.queryId)&&void 0!==p?p:m.u1i))||void 0===i?void 0:i.uniqueActionID)&&void 0!==C?C:m.u1i),D)),void 0),void O.sendErrorTelemetry((0,E.pN)((M={},(0,o._)(M,S.h3.UserQueryGuid,null!==(L=null==r?void 0:r.queryId)&&void 0!==L?L:m.u1i),(0,o._)(M,S.IC.ErrorMessage,m.VwD),(0,o._)(M,S.IC.ErrorCategory,S.S2.Notification),(0,o._)(M,S.CT.ErrorType,T.T_.Server),(0,o._)(M,S.IC.UniqueActionId,null!==(F=null===(a=B(null!==(R=r.queryId)&&void 0!==R?R:m.u1i))||void 0===a?void 0:a.uniqueActionID)&&void 0!==F?F:m.u1i),M)));null===(U=u.t.getInstance().getChatRef().current)||void 0===U||U.addResponseMessage({chatCardType:f._.MarkdownCard,chatMessageData:{markDownCardProps:{user:h.Q9.Human,message:(0,m.psP)()}}});var G,V,j,q,W,Y,Q=null!==(z=null==r?void 0:r.chatMessageHeader)&&void 0!==z?z:void 0;if(!(null==H?void 0:H.text)&&!(0,N.Z)(H))return(0,l.cY)("Empty message received from PowerPointCopilotOutputAnnotation"),void O.sendChatEventTelemetry((0,E.pN)((W={},(0,o._)(W,S.h3.UserQueryGuid,null!==(V=null==r?void 0:r.queryId)&&void 0!==V?V:m.u1i),(0,o._)(W,S.h3.ChatEventType,S.a5.EmptyMessageReceivedFromSummarySkill),(0,o._)(W,S.h3.ChatEventParameters,m.jhk),(0,o._)(W,S.h3.ChatErrorType,T.T_.Server),(0,o._)(W,S.h3.UniqueActionId,null!==(q=null===(G=B(null!==(j=r.queryId)&&void 0!==j?j:m.u1i))||void 0===G?void 0:G.uniqueActionID)&&void 0!==q?q:m.u1i),W)),void 0);!function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=null!==(r=null==e?void 0:e.text)&&void 0!==r?r:m.u1i,a=(0,b.pu)()?[]:(0,w.y_)(),l=[];if((0,b.PA)(b.IY.IsCitationsEnabled))if(((null==e?void 0:e.citations)||[]).length>0){var c=null==e?void 0:e.citations,u=!0,p=!1,y=void 0;try{for(var v,C=c[Symbol.iterator]();!(u=(v=C.next()).done);u=!0){var E=v.value;l.push((0,I.qF)(E))}}catch(e){p=!0,y=e}finally{try{u||null==C.return||C.return()}finally{if(p)throw y}}}else if(void 0!==e&&(e.sourceAttributions||[]).length>0){var N;l=(0,I.pe)(null!==(N=e.sourceAttributions)&&void 0!==N?N:[])}var O=f._.MarkdownCard,D={markDownCardProps:{user:h.Q9.Chat,message:i}};if((0,b.D$)()&&(null==e?void 0:e.dataType)===s.pe.Section){var L,R,F,M,B,U,z,H=x.U.getInstance(),G=(0,A.Xh)(null!==(M=null==e?void 0:e.messageId)&&void 0!==M?M:H.getLatestQueryId(),null==e?void 0:e.sections,l);(null===(F=G.chatCardMessageData)||void 0===F||null===(R=F.chatCardWrapperProps)||void 0===R||null===(L=R.renderData)||void 0===L?void 0:L.props)&&(G.chatCardMessageData.chatCardWrapperProps.renderData.props.initialSections=H.getSectionsByQueryId(null!==(B=null==e?void 0:e.messageId)&&void 0!==B?B:H.getLatestQueryId())),O=null!==(U=G.chatCardType)&&void 0!==U?U:O,D=null!==(z=G.chatCardMessageData)&&void 0!==z?z:D}null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:O,chatMessageData:D,chatMessageBodyData:{actionButtonList:a,shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:P.n.getInstance().shouldShowInDocSensitivityLabel()?(0,_.ny)():void 0,feedbackSectionPosition:g.O.Footer,feedbackData:(0,A.as)(T.Xw.CHATPPT),telemetryData:(0,A.YI)(k.SD.Summarize,S.Ff.VisualSummary),showAnimation:!0,references:l,isFailure:!1,messageId:null==e?void 0:e.messageId,chatMessageHeaderData:(0,w.Ne)(o),shouldShowCopyButton:(0,b.pu)(),shouldShowHandoffButton:(0,b.pu)(),shouldShowReadAloudButton:(0,b.pu)()},workflowAnnotationTypeForAugloopTimer:d.c.getTypeName(),addCardToChatHistory:!0})}(H,u.t.getInstance().getChatRef(),Q);var J,X,K,Z,$,ee,te=(Y={},(0,o._)(Y,S.h3.ChatEventType,S.a5.VisualSummaryShownAfterNotification),(0,o._)(Y,S.h3.ChatEventParameters,d.c.getTypeName()),Y);(null==r?void 0:r.queryId)&&(te[S.h3.UserQueryGuid]=null==r?void 0:r.queryId,te[S.h3.UniqueActionId]=null!==(K=null===(J=B(null!==(X=null==r?void 0:r.queryId)&&void 0!==X?X:m.u1i))||void 0===J?void 0:J.uniqueActionID)&&void 0!==K?K:m.u1i),O.sendChatEventTelemetry((0,E.pN)(te),void 0),O.sendLatencyTelemetry((0,E.pN)((ee={},(0,o._)(ee,S.h3.UserQueryGuid,null!==(Z=null==r?void 0:r.queryId)&&void 0!==Z?Z:m.u1i),(0,o._)(ee,S.CT.ContentOrigin,null!==($=null==H?void 0:H.contentOrigin)&&void 0!==$?$:T.wz.UNKNOWN),ee)))}},4809:(e,t,n)=>{"use strict";n.d(t,{EJ:()=>P,MK:()=>_,Qj:()=>T,UZ:()=>w,Uv:()=>A,Ux:()=>I,Vn:()=>E,d3:()=>C,q5:()=>b});var r=n(8349),o=n(45002),i=n(84163),a=n(44121),s=n(14552),l=n(37086),c=n(72218),u=n(85535),d=n(40403),p=n(44632),f=n(12542),h=n(78172),g=n(29336),m=n(39726),y=n(18384),v=function(e){switch(e){case c.vHI.addSlide():case c.vHI.addEnterpriseImage():case c.UeP.addEnterpriseImage():case c.UeP.addSlideAbout():case c.UeP.addAgendaSlide():case c.vHI.addImage():case c.UeP.addImage():case c.lhA.addAgendaSlide():case c.lhA.addAnImageOfCake():case c.lhA.addSlideAboutMeeting():return a.SD.AddContent;case c.lhA.generateImage():return a.SD.DesignerVisuals;case c.vHI.createPresentation():case c.UeP.createPresentationFrom():case c.UeP.createPresentationAbout():case c.UeP.createPresentationAboutContoso():case c.vHI.transformFile():case c.lhA.createFromFile():case c.lhA.createPresentationAbout():case c.lhA.createPresentationConsumer():case c.lhA.createPresentationAboutCollaboration():case c.lhA.createPresentationAboutNationalPark():return a.SD.CreatePresentation;case c.vHI.structurePresentation():case c.UeP.organizePresentation():return a.SD.Organize;case c.vHI.summarizePresentation():case c.vHI.showActionItems():case c.vHI.showKeySlides():case c.UeP.showKeySlides():case c.UeP.summarize():case c.UeP.datesAndDeadLines():case c.UeP.showActionItems():case c.lhA.summarize():case c.lhA.datesAndDeadlines():case c.lhA.showKeySlidesFromThisPresentation():return a.SD.Summarize;case c.vHI.animate():case c.vHI.tryNewDesign():case c.vHI.showHelpLink():case c.vHI.changeTextFormat():case c.vHI.addText():case c.UeP.tryNewDesign():case c.UeP.changeBodyText():return a.SD.BasicCommand;case c.UeP.improvePresentation():case c.UeP.help():return a.SD.DocumentQnA;case c.vHI.askAQuestion():case c.lhA.fontSize():return a.SD.ChatQnA;case c.UeP.whatCanCopilotProfileDo():case c.UeP.createMyCopilotProfile():case c.UeP.createCopilotProfile():return a.SD.Customize}return a.SD.CopilotChat},S=function(e){switch(e){case c.vHI.addImage():case c.UeP.addImage():case c.lhA.addAnImageOfCake():return f.Ff.AddImage;case c.UeP.addEnterpriseImage():case c.vHI.addEnterpriseImage():return f.Ff.AddEnterpriseImage;case c.vHI.addSlide():case c.UeP.addSlideAbout():case c.UeP.addAgendaSlide():case c.lhA.addAgendaSlide():case c.lhA.addSlideAboutMeeting():return f.Ff.AddSlide;case c.vHI.createPresentation():case c.UeP.createPresentationAbout():case c.UeP.createPresentationAboutContoso():case c.lhA.createPresentationAbout():case c.lhA.createPresentationConsumer():case c.lhA.createPresentationAboutCollaboration():case c.lhA.createPresentationAboutNationalPark():return f.Ff.CreatePresentation;case c.vHI.transformFile():case c.UeP.createPresentationFrom():case c.lhA.createFromFile():return f.Ff.CreateFromFile;case c.vHI.structurePresentation():case c.UeP.organizePresentation():return f.Ff.Organize;case c.vHI.summarizePresentation():case c.UeP.summarize():case c.lhA.summarize():return f.Ff.Summarize;case c.vHI.showActionItems():case c.UeP.datesAndDeadLines():case c.lhA.datesAndDeadlines():return f.Ff.ShowActionItems;case c.vHI.showKeySlides():case c.UeP.showKeySlides():case c.lhA.showKeySlidesFromThisPresentation():return f.Ff.KeySlides;case c.vHI.animate():case c.UeP.animateBulletedList():return f.Ff.Animate;case c.vHI.tryNewDesign():case c.UeP.tryNewDesign():return f.Ff.Beautify;case c.UeP.help():return f.Ff.Help;case c.UeP.improvePresentation():case c.lhA.fontSize():return f.Ff.BasicChat;case c.UeP.whatCanCopilotProfileDo():case c.UeP.createMyCopilotProfile():case c.UeP.createCopilotProfile():return f.Ff.Customize}return f.Ff.Unset},C=function(e){if(e!==a.SD.CopilotChat)switch(e){case a.SD.BasicCommand:case a.SD.Translate:case a.SD.Organize:return u.RX.Command;case a.SD.Summarize:return u.RX.Summarize;case a.SD.SpeakerNotes:return u.RX.Command;case a.SD.ChatQnA:case a.SD.DocumentQnA:return u.RX.Ask;case a.SD.Customize:return;default:return u.RX.Create}},b=function(e){switch(e){case r.yG.getTypeName():case r.SB.getTypeName():case r.kb.getTypeName():return a.Cu.Summary;case s.B.getTypeName():return a.Cu.Organize;case o.yg.getTypeName():case d.f.getTypeName():return a.Cu.CreatePresentationFromDoc;case i.KJ.getTypeName():case i.Ob.getTypeName():return a.Cu.BasicChat;case l._t.getTypeName():return a.Cu.CreatePresentation;default:return a.Cu.CopilotChat}},E=function(e){switch(e){case f.Ff.AddImage:case f.Ff.AddEnterpriseImage:case f.Ff.AddSlide:return a.SD.AddContent;case f.Ff.CreatePresentation:case f.Ff.CreateFromFile:return a.SD.CreatePresentation;case f.Ff.Organize:return a.SD.Organize;case f.Ff.Summarize:case f.Ff.ShowActionItems:case f.Ff.KeySlides:return a.SD.Summarize;case f.Ff.SpeakerNotes:return a.SD.SpeakerNotes;case f.Ff.Animate:case f.Ff.Beautify:return a.SD.BasicCommand;case f.Ff.Help:return a.SD.DocumentQnA;case f.Ff.BasicChat:case f.Ff.Sydney:case f.Ff.SelfHelpSearch:return a.SD.ChatQnA;default:return a.SD.CopilotChat}},T=function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=v(a.suggestionText),l=S(a.suggestionText),c=C(s);p.B.getInstance().logSeenEvent(s,l,c)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}},w=function(e,t,n){var r=(0,h.Y)(t,n).find((function(t){return t.text===e}));if(null==r?void 0:r.children){var o=!0,i=!1,a=void 0;try{for(var s,l=r.children[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var u,d,f=s.value,g=v(null!==(u=f.text)&&void 0!==u?u:c.u1i),m=S(null!==(d=f.text)&&void 0!==d?d:c.u1i),y=C(g);p.B.getInstance().logSeenEvent(g,m,y)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}};function I(e){var t={featureName:a.SD.CopilotChat};if(!e||!e.length)return t;switch(e.toLowerCase()){case m.wz.APOLOGY:case m.wz.DEEPLEO_SYDNEY:return{capability:u.rf.QAandSummaries,featureName:a.SD.ChatQnA,verb:u.RX.Ask,subFeature:f.Ff.Sydney};case m.wz.BASIC_CHAT:return{capability:u.rf.QAandSummaries,featureName:a.SD.ChatQnA,verb:u.RX.Ask,subFeature:f.Ff.BasicChat};case m.wz.SELF_HELP_SEARCH:return{capability:u.rf.QAandSummaries,featureName:a.SD.ChatQnA,verb:u.RX.Ask,subFeature:f.Ff.SelfHelpSearch};case m.wz.CANNED_RESPONSE:return{capability:u.rf.QAandSummaries,featureName:a.SD.ChatQnA,verb:u.RX.Ask,subFeature:f.Ff.CannedResponse};case m.wz.DESIGNER_INSERT_GRAPHIC:return{capability:u.rf.ContentGeneration,featureName:a.SD.DesignerVisuals,verb:u.RX.Create,subFeature:f.Ff.AddDesignerImage};case m.wz.TRANSFORM_CONTENT:return{capability:u.rf.ContentGeneration,featureName:a.SD.CreatePresentation,verb:u.RX.Create,subFeature:f.Ff.CreateFromFile};case m.wz.SUMMARIZE:case m.wz.COPILOT_POWERPOINT_SUMMARY:return{capability:u.rf.QAandSummaries,featureName:a.SD.Summarize,verb:u.RX.Summarize};case m.wz.COPILOT_POWERPOINT_SPEAKER_NOTES:return{capability:u.rf.Commanding,featureName:a.SD.SpeakerNotes,verb:u.RX.Command};case m.wz.PERSONALIZATION_END:case m.wz.PERSONALIZATION_START:case m.wz.PERSONALIZATION_EXPLAIN:case m.wz.PERSONALIZATION_UPDATE:case m.wz.PERSONALIZATION_FORCED_DELETE:return{featureName:a.SD.Customize,subFeature:f.Ff.Customize};case m.wz.EDIT_DOCUMENT:return g.r.getInstance().getSkillName()===m.B2.AddSlide?{capability:u.rf.ContentGeneration,featureName:a.SD.AddContent,verb:u.RX.Create,subFeature:f.Ff.AddSlide}:g.r.getInstance().getSkillName()===m.B2.CreatePresentation?{capability:u.rf.ContentGeneration,featureName:a.SD.CreatePresentation,verb:u.RX.Create,subFeature:f.Ff.CreatePresentation}:g.r.getInstance().getSkillName()===m.B2.ContentTransform?{capability:u.rf.ContentGeneration,featureName:a.SD.CreatePresentation,verb:u.RX.Create,subFeature:f.Ff.CreateFromFile}:g.r.getInstance().getSkillName()===m.B2.OrganizePresentation?{capability:u.rf.Commanding,featureName:a.SD.Organize,verb:u.RX.Command,subFeature:f.Ff.Organize}:{capability:u.rf.Commanding,featureName:a.SD.Commanding,verb:u.RX.Command};case m.wz.IMAGE_CHAT:return{capability:u.rf.ContentGeneration,featureName:a.SD.CopilotChat,verb:u.RX.Create,subFeature:f.Ff.ImageChat}}return t}function P(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=I(null==e?void 0:e.contentOrigin);return n.featureName===a.SD.CopilotChat&&t&&p.B.getInstance().sendChatEventTelemetry([{key:f.h3.ChatEventType,value:f.a5.ContentOriginUnknown},{key:f.h3.ChatEventParameters,value:origin}]),n}function _(e){var t=null==e?void 0:e.contentOrigin;if(g.r.getInstance().getSkillName()===m.B2.Unset&&t&&t.length)switch(t.toLowerCase()){case m.wz.APOLOGY:case m.wz.CANNED_RESPONSE:case m.wz.DEEPLEO_SYDNEY:return void g.r.getInstance().setSkillName(m.B2.Sydney);case m.wz.BASIC_CHAT:return void g.r.getInstance().setSkillName(m.B2.BasicChat);case m.wz.DESIGNER_INSERT_GRAPHIC:return void g.r.getInstance().setSkillName(m.B2.Designer);case m.wz.TRANSFORM_CONTENT:return void g.r.getInstance().setSkillName(m.B2.ContentTransform);case m.wz.SUMMARIZE:case m.wz.COPILOT_POWERPOINT_SUMMARY:return void g.r.getInstance().setSkillName(m.B2.Summary);case m.wz.COPILOT_POWERPOINT_SPEAKER_NOTES:return void g.r.getInstance().setSkillName(m.B2.SpeakerNotes);case m.wz.EDIT_DOCUMENT:return void g.r.getInstance().setSkillName(m.B2.Commanding);case m.wz.SELF_HELP_SEARCH:return void g.r.getInstance().setSkillName(m.B2.SelfHelp);case m.wz.SEARCH_DOC:return void g.r.getInstance().setSkillName(m.B2.SearchDocument);case m.wz.PERSONALIZATION_START:case m.wz.PERSONALIZATION_EXPLAIN:case m.wz.PERSONALIZATION_UPDATE:case m.wz.PERSONALIZATION_END:return void g.r.getInstance().setSkillName(m.B2.Personalization)}}function A(e,t){var n=g.r.getInstance().getSkillName(),r=f.CC.CopilotChat,o=f._5.UnclearIntent;switch(n){case m.B2.Summary:r=f.CC.Summary,o=f._5.Summarize;break;case m.B2.BasicChat:r=f.CC.BasicChat,o=f._5.BasicChat;break;case m.B2.SearchDocument:case m.B2.Sydney:r=f.CC.Sydney,o=f._5.BasicChat;break;case m.B2.Commanding:r=f.CC.Commanding,o=f._5.Command;break;case m.B2.Designer:r=f.CC.DesignerVisuals,o=f._5.DesignerVisuals;break;case m.B2.ContentTransform:r=f.CC.CreatePresentationFromDoc,o=f._5.AddContent}return{vetoName:(0,y.A9)(o,e),errorString:t,featureName:r}}},32854:(e,t,n)=>{"use strict";n.d(t,{uv:()=>Qe,dK:()=>Je,S8:()=>En,K:()=>ee,ff:()=>Xe,f5:()=>Kt,r9:()=>Hn,AN:()=>vn,uB:()=>Fn,ZB:()=>Rn,tV:()=>Gn,fC:()=>In,ND:()=>qt,Xh:()=>vt,m4:()=>xn,so:()=>yn,Gn:()=>at,Ld:()=>ot,Bs:()=>wt,as:()=>Ct,yw:()=>Bn,MS:()=>ln,zx:()=>mn,mw:()=>hn,gl:()=>Sn,Y6:()=>Un,KN:()=>Ht,$2:()=>Et,YI:()=>bt,lS:()=>On,Dz:()=>Dn,P3:()=>Mt,Cu:()=>St,VL:()=>Ot,PJ:()=>Lt,sE:()=>Bt,qe:()=>Ln,Ox:()=>an,vp:()=>on,vF:()=>Ut,lp:()=>kt,Of:()=>_n,cd:()=>Mn,MV:()=>At,f1:()=>Xt,df:()=>Dt,zq:()=>gn,YY:()=>fn,HK:()=>Pn,P7:()=>it,K4:()=>Pt,q9:()=>rn,Ir:()=>xt,TJ:()=>Nt,fe:()=>Vn,Fn:()=>tt,E$:()=>An});var r=n(43032),o=n(90813),i=n(57835),a=n(61838),s=n(42652),l=n(81092),c=n(79490),u=n(15499),d=n(98483),p=n(29352),f=n(26940),h=n(70825),g=n(70533),m=n(38834),y=n(6693),v=n(69510),S=n(53154),C=n(72218),b=n(54009),E=n(10813),T=n(45002),w=n(55564),I=n(39726),P=n(2061),_=n(17235),A=n(85658),k=n(8349),x=n(96578),N=n(93176),O=n(78064),D=n(70110),L=n(69038),R=n(72241),F=n(62096),M=n(61699),B=n(91208),U=n(61339),z=n(84163),H=n(81789),G=n(44121),V=n(37745),j=n(34045),q=n(43277),W=n(9669),Y=n(74930),Q=n(11912),J=n(91165),X=n(44632),K=n(12542),Z=n(18384),$=function(){function e(){var t=this;(0,Q._)(this,e),(0,o._)(this,"connectedToInternet",navigator.onLine),(0,o._)(this,"onOnline",(function(){t.connectedToInternet=!0,S.G.getInstance().isRequestPending()&&X.B.getInstance().sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.InternetReconnected)))})),(0,o._)(this,"onOffline",(function(){t.connectedToInternet=!1})),(0,o._)(this,"IsConnectedToNetwork",(function(){return navigator.onLine&&e.getInstance().connectedToInternet})),this.connectedToInternet=navigator.onLine,window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)}return(0,J._)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,o._)($,"instance",void 0);var ee,te,ne=n(1373),re=n(14552),oe=n(65917),ie=n(29862),ae=n(88645),se=n(37086),le=n(14213),ce=n(40403),ue=n(24464),de=n(1134),pe=n(50481),fe=n(18758),he=n(30325),ge=n(32217),me=n(60801),ye=n(44001),ve=n(4809),Se=n(1543),Ce=n(39041),be=n(46866),Ee=n(5851),Te=n(29336),we=n(4085),Ie=n(23909),Pe=n.n(Ie),_e=n(7567),Ae=n(57308),ke=n(4277),xe=n(34948),Ne=n(82808),Oe=n(65817),De=n(72468),Le=n(85612),Re=n(47941),Fe=n(40389),Me=n(23343),Be=n(85535),Ue=n(1216),ze=n(47350),He=n(31041),Ge=n(88358),Ve=n(78289),je=n(58651),qe=n(37542).Buffer;!function(e){e.Header="Header",e.Footer="Footer",e.Backstage="Backstage",e.HelpMenu="Help Menu",e.Canvas="Canvas",e.Chat="Chat"}(ee||(ee={})),function(e){e.Https="Https",e.Https_OneDrive="Https_OneDrive",e.Https_DropBox="Https_DropBox",e.Https_GoogleDrive="Https_GoogleDrive",e.Https_Wikipedia="Https_Wikipedia",e.Http="Http",e.Unclean="Unclean",e.Empty="Empty",e.Email="Email",e.Calendar="Calendar",e.Invalid="Invalid"}(te||(te={}));var We=u,Ye=X.B.getInstance(),Qe="Create a presentation about",Je="Create a presentation from",Xe="Chat",Ke=C.u1i,Ze=C.u1i,$e=C.u1i,et=C.u1i,tt=!0,nt=null,rt=C.u1i;function ot(){return rt}var it=function(e){rt=e};function at(){if(rt)return(0,Ge.UD)(rt)}var st,lt=function(){if(!(0,w.PA)(w.IY.ConvertURLsBasedOnClientEnvironment))return"https://outlook.office365.com";switch((0,P.Rs7)(j.Vv.getSettingAsString(j.zj.AugLoopCloudALServiceUrl))){case I.OH.GCC:case I.OH.GCCHigh:case I.OH.DOD:return"https://outlook.office365.us";default:return"https://outlook.office365.com"}},ct=(st=(0,r._)((function(e,t,n){var r,o,s,l;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return r=(0,w.PA)(w.IY.UseNewCopilotSharedPackage)?P.Ebk:ye.Eb,o=[(0,i._)({},e)],s={queryId:t,slides:n},(0,fe.$1)((0,he.wo)())?[4,r((function(){return pt()}))]:[3,2];case 1:return l=c.sent(),[3,3];case 2:l=void 0,c.label=3;case 3:return[2,a._.apply(void 0,o.concat([(s.config=l,s)]))]}}))})),function(e,t,n){return st.apply(this,arguments)}),ut=function(e){for(var t=e.split(",")[1],n=atob(t),r=new Uint8Array(new ArrayBuffer(n.length)),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=function(e){var t;return e.startsWith("data:image/png")?{format:g.f.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:g.f.Jpg}:e.startsWith("data:image/bmp")?{format:g.f.Bmp}:{format:g.f.Other,otherFormat:null===(t=e.split(";")[0])||void 0===t?void 0:t.split(":")[1]}}(e),a=i.format,s=i.otherFormat;return{contents:[{id:(0,d.A)(),size:g.h.Unspecified,format:a,otherFormat:s,data:Array.from(r),sizeBytes:r.length}],widthPx:0,heightPx:0}},dt=function(){var e=(0,r._)((function(e,t,n,r,s,u,d,p,f,h,g,m,y,v){var S,C,b,E,T,I,_,A,k,x,N,O;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return S=(0,w.PA)(w.IY.UseDataURIToImageTileShared)?P.piD:ut,(0,Ce.hX)(S)||(C=null==d?void 0:d.map(S)[0]),void 0===C&&d&&d.length>0&&((0,fe.cY)("Bad image data URI in image chat: ".concat(d[0])),Ye.sendErrorTelemetry((0,Z.pN)((b={},(0,o._)(b,K.IC.ErrorMessage,"Image chat bad image data URI in getFluxInputSignal"),(0,o._)(b,K.IC.ErrorCategory,K.S2.Error),b)))),u&&(0,w.PA)(w.IY.IsMsgExtTelemetryEnabled)&&(E=(null==u?void 0:u.map((function(e){return e.id})))||[],T=E.length>0?JSON.stringify(E):"",(0,fe.cY)("Enabled Plugins: ",T),X.B.getInstance().sendChatEventTelemetry((0,Z.pN)((I={},(0,o._)(I,K.h3.UserQueryGuid,n),(0,o._)(I,K.h3.ChatEventType,K.a5.EnabledPlugins),(0,o._)(I,K.h3.ChatEventParameters,T),I)))),_=null!=r?r:pe.b4,A=(0,w.PA)(w.IY.UseNewCopilotSharedPackage)?P.Ebk:ye.Eb,k=(0,P.Hrz)(g),(0,fe.cY)("Mentioned Plugins: ",k),x=(0,l._)(null!=u?u:[]).concat((0,l._)(null!=k?k:[])).some((function(e){return"MOS3"===e.source})),[4,A((function(){return pt(u)}))];case 1:return N=c.sent(),O=(0,a._)((0,i._)({},e),{queryId:n,gptId:p,mentionedPlugins:k,conversationId:(0,Se.vf)()?_:pe.b4,slides:t,config:(0,a._)((0,i._)({},N),{isToolboxEnabled:!!p||x&&(0,w.bw)(w.WT.IsPluginToolboxEnabledForPlugins),isInterstitialConfirmationEnabled:!0,isInterstitialAuthenticationEnabled:!0}),queryAnnotations:s,clientUILanguageAndLocale:(0,V.hD)(q.i.GetHostAppDisplayLanguage()),createJsonCmdList:(0,w.bw)(w.WT.IsCreateJsonCmdListForBumbleBeeEnabled),jsonCmdApiVersion:mn(),templateId:yn(),createNewPresentation:j.Vv.IsSettingTrue(j.zj.PPTBBPresOutlineEnabled),images:C,commandCategory:f,invokeActionConfirmation:h,isWarmUp:m,requestContinuation:y}),(0,w.bw)(w.WT.SpeakerNotesEnabled)&&(0,w.PA)(w.IY.AddSlideIdFluxSignalSpeakerNotes)&&(O=(0,a._)((0,i._)({},O),{selectedSlideId:v?{id:v.id,cId:v.cId}:void 0})),[2,O]}}))}));return function(t,n,r,o,i,a,s,l,c,u,d,p,f,h){return e.apply(this,arguments)}}();function pt(e){return{webGroundingEnabled:!(null==e?void 0:e.length)&&((0,Se.vI)()&&(0,ge.gc)()),enterpriseGroundingEnabled:(0,ge.pX)(),requireExplicitPlugins:(0,Se.vI)(),searchOnlyMode:!1,pluginInfo:null!=e?e:[]}}var ft=function(){var e=(0,r._)((function(e,t){var n,r,i;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return r=C.MYv||(0,j.I_)(),t&&(e=ht(e,t)),(0,w.PA)(w.IY.RemoveContextFromInputSignalEnabled)?(n={query:e,raw:r,links:t,isStreaming:!0},Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.ContextTreeBuildSkipped))),[3,3]):[3,1];case 1:return[4,gt()];case 2:i=a.sent(),n={query:e,context:i,raw:r,links:t,isStreaming:!0},Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.ContextTreeBuildCompleted))),a.label=3;case 3:return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),ht=function(e,t){t.sort((function(e,t){return e.range[0]-t.range[0]}));var n=0,r=!0,o=!1,i=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value,u=(0,s._)(c.range,2),d=u[0],p=u[1];d+=n,p+=n,n+=4;var f="{{"+e.slice(d,p+1)+"}}",h=e.slice(0,d),g=e.slice(p+1);e=h+f+g,c.range=[d,p+4]}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return e},gt=function(){var e=(0,r._)((function(){var e,t,n,i;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:(0,fe.cY)("updateContextTree called"),e="",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var t=(0,r._)((function(t){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,mt(t)];case 1:return e=n.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 2:return a.sent(),[3,4];case 3:return t=a.sent(),(0,fe.cY)("Exception in updateContextTree: ".concat(t)),Ye.sendErrorTelemetry((0,Z.pN)((n={},(0,o._)(n,K.IC.ErrorMessage,"Exception in updateContextTree ".concat(t.message)),(0,o._)(n,K.IC.ErrorCategory,K.S2.Error),n))),Ye.sendChatEventTelemetry((0,Z.pN)((i={},(0,o._)(i,K.h3.ChatEventType,K.a5.ContextTreeBuildError),(0,o._)(i,K.h3.ChatErrorType,I.T_.Client),i))),[3,4];case 4:return[2,e]}}))}));return function(){return e.apply(this,arguments)}}();function mt(e){return yt.apply(this,arguments)}function yt(){return(yt=(0,r._)((function(e){var t,n,r,i;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:t=new Promise((function(e,t){var n=setTimeout((function(){clearTimeout(n),t(new Error("Timed out for context tree build"))}),C.oaP)})),n=We.getSelectionContextTree(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.race([n,t])];case 2:return r=a.sent(),[2,JSON.stringify(r)];case 3:return i=a.sent(),(0,fe.cY)("Timeout occurred for context tree build: ".concat(i)),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.ContextTreeBuildTimeout))),[2,C.u1i];case 4:return[2]}}))}))).apply(this,arguments)}var vt=function(e,t,n){if((0,fe.cY)("PPT Summary finalMessage ID",e),t&&t.length>0){n&&(0,Ve.Co)(t,n);var r=ze.U.getInstance();return r.updateSections(e,(0,l._)(t)),{chatCardType:N._.ChatCardWrapper,chatCardMessageData:{chatCardWrapperProps:{user:"chat",renderData:{component:I.uz.InteractiveSummaryCard,shouldMemoizeComponent:!1,props:{messageId:e,initialSections:r.getSectionsByQueryId(e)}}}}}}return(0,fe.cY)("Section is not available for PPT Summary finalMessage ID",e),{chatCardType:void 0,chatCardMessageData:void 0}},St=function(){var e=(0,r._)((function(e,t,n){var r,i,a,s;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return n&&(r=gn(n),i=r.correlationId,a=r.featureName,s=r.subFeatureName,void 0!==i&&Ye.setQueryGuid(i),void 0!==a?Ye.logKeptEvent(a,s||K.Ff.Unset,(0,ve.d3)(a)):Ye.logKeptEvent(G.SD.CopilotChat)),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.CopyButtonClicked))),n&&Ye.setQueryGuid(""),[4,(0,O.Cu)(e)];case 1:return t.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}();var Ct=function(e,t){e=e||I.Xw.CHATPPT;var n=function(){if((0,w.jv)()){var e="CurrentContext";return(0,ge.pX)()&&(e+="+Work"),(0,ge.gc)()&&(e+="+Web"),e}return(0,ge.pX)()?"Work":"CurrentContext"}(),r=(new Date).toISOString(),o=Ye.getQueryGuid()===C.u1i?et:Ye.getQueryGuid(),s={feedbackContextData:{prompt:Ke,promptId:o,errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType},sydneyContextData:{requestId:o,utteranceTimeStamp:r,feedbackMessageId:(0,D.Xf)(),conversationId:pe.b4,sydneyEndpoint:pe.S6,locale:Ae.Hg},groundingSource:n,featureName:null==t?void 0:t.featureName,subFeatureName:null==t?void 0:t.subFeatureName,entryPoint:"Chat"};return{feedbackArea:(0,w.bw)(w.WT.IsFeedbackAppChatIntegrationEnabled)?I.Xw.OCV_FEATURE_AREA:e,contextData:e===I.Xw.COPILOTSTART?(0,a._)((0,i._)({},s),{cardMetaData:JSON.stringify({prompt:Ke,status:Ze,contextMetaData:$e,copilotExtensionId:rt})}):(0,a._)((0,i._)({},s),{cardMetaData:JSON.stringify({prompt:Ke,promptId:o,featureContent:null==t?void 0:t.featureContent,featureAdditionalTelemetry:null==t?void 0:t.featureAdditionalTelemetry,errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType,copilotExtensionId:rt})})}},bt=function(e,t){var n,r=null!=e?e:le.K.getInstance().getFeatureName();r===G.SD.Unset&&(r=G.SD.CopilotChat);var o=null!==(n=null!=t?t:le.K.getInstance().getSubFeatureName())&&void 0!==n?n:K.Ff.Unset;return JSON.stringify({featureName:r,correlationId:Ye.getQueryGuid()===C.u1i?void 0:Ye.getQueryGuid(),subFeatureName:o})},Et=function(){return q.i.GetHostAppPlatform()===C.TTX?{showInlineStopGeneratingButton:!0}:{showStopGeneratingButton:!0}},Tt=function(){var e=(0,r._)((function(){var e,t,n,i;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,PowerPoint.run(function(){var t=(0,r._)((function(t){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,de.Oc)(t)];case 1:return e=r.sent(),(0,fe.cY)("Current Slide Moniker: ".concat(JSON.stringify(e))),void 0===e&&((0,fe.cY)(C.kVV),Ye.sendErrorTelemetry((0,Z.pN)((n={},(0,o._)(n,K.IC.ErrorMessage,C.kVV),(0,o._)(n,K.IC.ErrorCategory,K.S2.Error),n)))),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return a.sent(),[3,3];case 2:return t=a.sent(),(0,fe.cY)("".concat(C.aGV,": ").concat(t.message)),Ye.sendErrorTelemetry((0,Z.pN)((n={},(0,o._)(n,K.IC.ErrorMessage,"".concat(C.aGV,": ").concat(t.message)),(0,o._)(n,K.IC.ErrorCategory,K.S2.Error),n))),Ye.sendChatEventTelemetry((0,Z.pN)((i={},(0,o._)(i,K.h3.ChatEventType,K.a5.SelectedSlideFetchError),(0,o._)(i,K.h3.ChatErrorType,I.T_.Client),i))),[3,3];case 3:return[2,e]}}))}));return function(){return e.apply(this,arguments)}}(),wt=function(){var e=(0,r._)((function(e,t,n,a,l,u,p,f,g,S,N,O,D,R){var F,M,B,U,z,Q,J,$,ee,te,re,ie,ae,se,ce,ue,de,ge,me,ye,ve,Ce,be,we,Ie,Pe,_e,Ae,ke,xe,Oe,Re,Fe,Me,Be,Ue,ze,He,Ge,Ve,je,qe;return(0,c.__generator)(this,(function(We){switch(We.label){case 0:if((0,fe.cY)("getDefaultSignalOperation called: ".concat(t)),F=(0,P.TRs)(O,g,x.r9),rt=null!=F?F:C.u1i,Ye.sendChatEventTelemetry((0,Z.pN)((M={},(0,o._)(M,K.h3.ChatEventType,K.a5.GetSignalOperationCalled),(0,o._)(M,K.h3.ChatEventParameters,"getDefaultSignalOperation called"),(0,o._)(M,K.h3.UserQueryGuid,n),(0,o._)(M,K.h3.IsWarmUpSignal,null!=D?D:C.u1i),(0,o._)(M,K.h3.SlideCountRange,It(oe._.getInstance().getSlideCount())),M))),(0,w.bw)(w.WT.IsNotificationEnabledForSummary)&&!D){B=(0,d.A)(),(0,De.kt)(n,{querySubmissionTime:L.qD,uniqueActionID:B}),U=!0,z=!1,Q=void 0;try{for(J=De.YT.entries()[Symbol.iterator]();!(U=($=J.next()).done);U=!0)ee=(0,s._)($.value,2),te=ee[0],ee[1],(0,Le.l3)(te)&&Ne.A.disableSuccessButton(te,e)}catch(e){z=!0,Q=e}finally{try{U||null==J.return||J.return()}finally{if(z)throw Q}}}return re=(0,P.y8L)(g,O),Te.r.getInstance().resetData(),ie=function(e,t){var n,r,o,a,s,l,c,u;return t===PowerpointCopilotStrings.PromptMenuItemSummarize?(null===(n=e.current)||void 0===n||n.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(r=(0,Ee.A)().get(I.Ae.PresentationSummary))&&void 0!==r?r:[]},Et())),_.N.Summary):t===PowerpointCopilotStrings.PromptGuideMenuItemShowKeySlides?(null===(o=e.current)||void 0===o||o.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(a=(0,Ee.A)().get(I.Ae.ImportantSlides))&&void 0!==a?a:[]},Et())),_.N.ImportantSlides):t===PowerpointCopilotStrings.PromptMenuItemShowActionItems?(null===(s=e.current)||void 0===s||s.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(l=(0,Ee.A)().get(I.Ae.CallToAction))&&void 0!==l?l:[]},Et())),_.N.CallsForAction):(null===(c=e.current)||void 0===c||c.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(u=(0,Ee.A)().get(I.Ae.Default))&&void 0!==u?u:[]},Et())),_.N.Unknown)}(e,t),et=n,Ke=t,ae=(0,w.PA)(w.IY.UseDataURIToImageTileShared)?P.piD:ut,se=null==f?void 0:f.map(ae)[0],ue=null!==(ce=null==f?void 0:f.length)&&void 0!==ce?ce:0,void 0===se&&f&&ue>0&&((0,fe.cY)("Invalid image data URI in image chat: ".concat(f[0])),X.B.getInstance().sendErrorTelemetry((0,Z.pN)((de={},(0,o._)(de,K.IC.ErrorMessage,"Image chat bad image data URI in getFluxInputSignal"),(0,o._)(de,K.IC.ErrorCategory,K.S2.ImageChat),de)))),ue>0&&((0,fe.cY)("image chat image count: ".concat(ue)),X.B.getInstance().sendChatEventTelemetry((0,Z.pN)((ge={},(0,o._)(ge,K.h3.ChatEventType,K.a5.TriggerImageChatOperation),(0,o._)(ge,K.h3.ChatEventParameters,"image chat image count: ".concat(ue)),(0,o._)(ge,K.h3.UserQueryGuid,n),ge)))),Ke.toLowerCase().includes(C.DHF)&&Ke.toLowerCase().includes(C.wZn)&&!re&&(void 0===se&&f&&f.length>0&&((0,fe.cY)("Bad image data URI in sketch to image: ".concat(f[0])),Ye.sendErrorTelemetry((0,Z.pN)((me={},(0,o._)(me,K.IC.ErrorMessage,"Bad image data URI in sketch to image"),(0,o._)(me,K.IC.ErrorCategory,K.S2.Error),me)))),(0,w.bw)(w.WT.IsImageInputEnabled)&&(0,w.bw)(w.WT.IsSketchToImageEnabled)&&se)?((0,fe.cY)("Sketch to Image Intent Detected"),(0,pe.My)(m.b.getTypeName()),ye={imageTile:se,userPrompt:Ke},ve=new h.Xr({parentPath:["Signal",m.b.getTypeName()],items:[{id:ne.r.generateId(),body:new m.b(ye)}]}),X.B.getInstance().sendChatEventTelemetry([{key:K.h3.ChatEventType,value:K.a5.PPTCopilotSketchOperationSubmitted}]),[2,{operation:ve,workflowAnnotationType:y.k.getTypeName()}]):(Ce=(0,w.bw)(w.WT.IsPreTriggerContentProcessingWorkflowEnabled),Ye.sendChatEventTelemetry((0,Z.pN)((be={},(0,o._)(be,K.h3.ChatEventType,K.a5.PretriggerContentProcessing),(0,o._)(be,K.h3.ChatEventParameters,Ce),be))),ie===_.N.Unknown||re?[3,1]:((0,fe.cY)("Summary Intent Detected: ",ie),(0,pe.My)(A.Bc.getTypeName()),we={intent:ie,queryLanguage:(0,fe.Zi)((0,V.hD)(q.i.GetHostAppDisplayLanguage())),queryId:n,isStreaming:!0,source:j.Vv.IsSettingTrue(j.zj.TriggerSummary)?I.bV.Nudge_UserQuery:I.bV.AppChat_UserQuery},Ie=new h.Xr({parentPath:["Signal",A.Bc.getTypeName()],items:[{id:ne.r.generateId(),body:new A.Bc(we)}]}),Te.r.getInstance().setSkillName(I.B2.Summary),H.R.getInstance().setState(I.Nj.WAITING_FOR_SUMMARY_WF_RESPONSE),Ye.sendChatEventTelemetry((0,Z.pN)((Pe={},(0,o._)(Pe,K.h3.ChatEventType,K.a5.SummarizationOperationSubmitted),(0,o._)(Pe,K.h3.UserQueryGuid,n),(0,o._)(Pe,K.h3.RequestSignalSource,j.Vv.IsSettingTrue(j.zj.TriggerSummary)?I.bV.Nudge_UserQuery:I.bV.AppChat_UserQuery),Pe))),[2,{operation:Ie,workflowAnnotationType:(0,w.bw)(w.WT.IsMarkdownSummarizationEnabled)?W.c.getTypeName():k.SB.getTypeName()}]));case 1:return u&&"File"===u[0].QueryAnnotationType&&!re&&cn(t.toLowerCase(),a)?((0,fe.cY)("Content Transformation Intent Detected"),null===(_e=e.current)||void 0===_e||_e.updateLoadingComponentProps((0,i._)({loadingUiStringList:null!==(Ae=(0,Ee.A)().get(I.Ae.CreatePresentation))&&void 0!==Ae?Ae:[]},Et())),ke={contentType:b.EA.FileUrl,sourceBuffer:new Uint8Array([]),fileType:"docx",url:dn(t,a),lastModified:""},(0,pe.My)(E.F.getTypeName()),xe={correlationId:n,sourceContent:[ke],entryPoint:C.$kB.Chat,language:q.i.GetHostAppDisplayLanguage(),fCreateNewPresentation:j.Vv.IsSettingTrue(j.zj.PPTBBPresOutlineEnabled),templateId:yn(),jsonCmdApiVersion:mn(),fCreateJsonCmdList:(0,w.bw)(w.WT.IsCreateJsonCmdListForBumbleBeeEnabled)},Oe=new h.Xr({parentPath:["Signal",E.F.getTypeName()],items:[{id:ne.r.generateId(),body:new E.F(xe)}]}),Te.r.getInstance().setSkillName(I.B2.ContentTransform),le.K.getInstance().setScenarioName(G.Cu.CreatePresentationFromDoc),H.R.getInstance().setState(I.Nj.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[2,{operation:Oe,workflowAnnotationType:T.yg.getTypeName()}]):[3,2];case 2:return Re=(new Date).getTime(),[4,ft(t,a)];case 3:Fe=We.sent(),(0,fe.cY)("textTile Created: ".concat(JSON.stringify(Fe))),Ye.sendLatencyTelemetry((0,Z.pN)((0,o._)({},K.CT.ContextTreeBuildTime,(0,L.WU)(Re)))),Me=void 0,We.label=4;case 4:return We.trys.push([4,6,,7]),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){var t;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.presentation.slides).load("item/id"),[4,e.sync()];case 1:return n.sent(),[2,t.items.map((function(e){return{id:e.id}}))]}}))}));return function(t){return e.apply(this,arguments)}}())];case 5:return Me=We.sent(),[3,7];case 6:return Be=We.sent(),(0,fe.cY)("Error while getting slide IDs for presentation: ".concat(Be.message)),Ye.sendErrorTelemetry((0,Z.pN)((Ue={},(0,o._)(Ue,K.IC.ErrorMessage,"Error while getting slide IDs for presentation: ".concat(Be.message)),(0,o._)(Ue,K.IC.ErrorCategory,K.S2.Error),Ue))),Ye.sendChatEventTelemetry((0,Z.pN)((ze={},(0,o._)(ze,K.h3.ChatEventType,K.a5.SlideFetchError),(0,o._)(ze,K.h3.ChatErrorType,I.T_.Client),ze))),[3,7];case 7:return(0,w.bw)(w.WT.SpeakerNotesEnabled)&&(0,w.PA)(w.IY.AddSlideIdFluxSignalSpeakerNotes)?[4,Tt()]:[3,9];case 8:He=We.sent(),We.label=9;case 9:return(0,fe.cY)("Retrieved slide IDs for presentation.\n"+JSON.stringify(Me)),(0,Se.FG)(he.BJ)?[4,dt(Fe,Me,n,l,u,p,f,F,S,N,O,D,R,He)]:[3,11];case 10:return Ge=We.sent(),(0,pe.My)(Y.iq.getTypeName()),Ve=new h.g0({parentPath:["Signal",Y.iq.getTypeName()],items:[{id:ne.r.generateId(),body:new Y.iq(Ge)}]}),D||(0,pe.wu)(),X.B.getInstance().sendChatEventTelemetry([{key:K.h3.ChatEventType,value:K.a5.PPTCopilotFluxOperationSubmitted}]),[2,{operation:Ve,workflowAnnotationType:W.c.getTypeName()}];case 11:return(0,pe.My)(Y.QP.getTypeName()),[4,ct(Fe,n,Me)];case 12:return je=We.sent(),qe=new h.Xr({parentPath:["Signal",Y.QP.getTypeName()],items:[{id:ne.r.generateId(),body:new Y.QP(je)}]}),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.PPTCopilotOperationSubmitted))),[2,{operation:qe,workflowAnnotationType:v.YO.getTypeName()}];case 13:return[2]}}))}));return function(t,n,r,o,i,a,s,l,c,u,d,p,f,h){return e.apply(this,arguments)}}(),It=function(e){if(e<0)return"Negative";var t="".concat(e%5==0?e-4:e-e%5+1),n="".concat(e%5==0?e:e+5-e%5);return"".concat(t," - ").concat(n)},Pt=function(e,t){var n=j.Vv.getSettingAsString(j.zj.PPTStoryTellerExecutionResponse);(0,fe.cY)("PPT StoryTeller ResponseJson: "+n);try{var r=JSON.parse(n);if(0===r.length||(0,Ce.hX)(r[r.length-1].query))return;var i,a=r[r.length-1];switch(Ye.sendChatEventTelemetry((0,Z.pN)((i={},(0,o._)(i,K.h3.ChatEventType,K.a5.StoryTellerResponseInChat),(0,o._)(i,K.h3.ChatEventParameters,a.status.toLowerCase()),i))),a.query,Ze=a.status,$e=a.contextData,a.status.toLowerCase()){case I.t4.Failure:var s,l={errorMessage:PowerpointCopilotStrings.StorytellerFailureMessage,errorType:I.Qp.StorytellerFailureMessage,featureName:K.CC.CreatePresentation,subFeatureName:K.Ff.CreatePresentation};null===(s=e.current)||void 0===s||s.addResponseMessage((0,ue.qi)(PowerpointCopilotStrings.StorytellerFailureMessage,ue.OT,!0,I.Xw.COPILOTSTART,void 0,!1,!0,void 0,l));break;case I.t4.Cancelled:var c,u,d={featureName:K.CC.CreatePresentation,subFeatureName:void 0};null===(c=e.current)||void 0===c||c.addResponseMessage((0,ue.l6)(a.query,ue.bq,!0,d)),null===(u=e.current)||void 0===u||u.addResponseMessage((0,ue.qi)(PowerpointCopilotStrings.StorytellerCancelledMessage,ue.OT,!0,I.Xw.COPILOTSTART,void 0,!1,!0,void 0,d));break;case I.t4.Success:var p,f,h={featureName:K.CC.CreatePresentation,subFeatureName:void 0};null===(p=e.current)||void 0===p||p.addResponseMessage((0,ue.l6)(a.query,ue.bq,!0,h));var g=(0,C.a8z)()[3],m=(0,ue.FL)(g,t,void 0,ue.tc,!0,I.Xw.CHATPPT,void 0,void 0,h);null===(f=e.current)||void 0===f||f.addResponseMessage(m)}}catch(e){var y;(0,fe.cY)("Error while getting PPT storyteller execution response: "+e.message),Ye.sendErrorTelemetry((0,Z.pN)((y={},(0,o._)(y,K.IC.ErrorMessage,"Error while getting PPT storyteller execution response"),(0,o._)(y,K.IC.ErrorCategory,K.S2.StoryTeller),y)))}},_t=function(e){if(!(null==e?void 0:e.length))return null;var t=["Empty","Http","Unclean","Https_DropBox","Https_GoogleDrive","Email","Calendar"];(0,w.PA)(w.IY.CustomerOneDriveOnlyUrlChange)&&Kt()&&!(0,fe.$1)((0,he.wo)())?t.push("Https"):t.push("Https_OneDrive"),Zt()||t.push("Https_Wikipedia");var n=e.filter((function(e){return t.includes(e)}));return n.length>0?n[0]:null},At=function(e){return C.vrM.test(e)},kt=function(e){return C.ELJ.test(e)},xt=function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return(0,w.bw)(w.WT.isNetworkCheckEnabled)&&!$.getInstance().IsConnectedToNetwork()?((0,ue.r5)(e,PowerpointCopilotStrings.InternetNotAvailableErrorMessage),Ye.logAshaErrorEvent((0,Z.A9)(K._5.UnclearIntent,K.G8.UnableToCompleteTask),K.z_.InternetDisconnected),(0,Z.AQ)(Ye,L.qD,K.a5.InternetDisconnected,"",I.T_.Client),[2,!1]):[4,(0,P.aWC)()];case 1:return t.sent()?[2,!0]:((0,fe.cY)("Sensitivity Label APIs failed, not sending request to AL"),[2,Promise.resolve(!1)])}}))}));return function(t){return e.apply(this,arguments)}}(),Nt=function(){var e=(0,r._)((function(e,t,n,r,i){var a,s,l,u,d,p,f,h,g,m,y,v,S,b,E,T;return(0,c.__generator)(this,(function(c){if((0,w.bw)(w.WT.IsPersonalizationUXEnabled)&&(0,w.bw)(w.WT.IsPersonalizationConfirmationResponseEnabled)&&(0,P._pQ)(e),Ye.setQuerySubmitTime(L.qD),Ye.setQueryGuid(C.u1i),Ye.sendChatEventTelemetry((0,Z.pN)((a={},(0,o._)(a,K.h3.ChatEventType,K.a5.CIQLinkUsed),(0,o._)(a,K.h3.ChatEventParameters,!0===(r&&r.length>0&&r[0].value.length>0)),a))),s=nn(t,r),(0,w.bw)(w.WT.IsContentValidatorWorkflowEnabled)&&null===_t(s)&&(0,we.Mz)(t,r),oe._.getInstance().setCachedDocumentState(),(0,w.PA)(w.IY.LearnMoreOptionInMenuEnabled)&&t===C.vHI.showHelpLink())return Ye.sendChatEventTelemetry((0,Z.pN)((l={},(0,o._)(l,K.h3.ChatEventType,K.a5.LearnMoreOptionClicked),(0,o._)(l,K.h3.ChatEventParameters,"Help_Message"),l))),(0,Z.AQ)(Ye,L.qD),Ft(e),[2,!1];if(!(0,w.bw)(w.WT.UrlDetailedErrorEnabled)&&Gt(t))return d={errorMessage:PowerpointCopilotStrings.DocumentUrlEmptyError,errorType:I.Qp.DocumentUrlEmptyError,featureName:K.CC.CreatePresentation,subFeatureName:K.Ff.CreateFromFile},null===(u=e.current)||void 0===u||u.addResponseMessage((0,ue.qi)(PowerpointCopilotStrings.DocumentUrlEmptyError,ue.OT,!0,I.Xw.CHATPPT,void 0,!1,!0,void 0,d)),(0,Z.AQ)(Ye,L.qD,K.a5.DocumentUrlEmptyError,"TransformFile_DocumentURLEmpty",I.T_.UnsupportedAction),p=(0,ve.Uv)(K.G8.UserInputCouldNotBeProcessed,K.av.DocumentUrlEmptyError),Ye.logAshaErrorEvent(p.vetoName,p.errorString,p.featureName),[2,!1];if((0,w.bw)(w.WT.UrlDetailedErrorEnabled)&&en(t)&&(null==s?void 0:s.length)&&null!==_t(s)){switch(h=PowerpointCopilotStrings.DocumentUrlInvalidError,_t(s)){case"Empty":h=PowerpointCopilotStrings.DocumentUrlEmptyError;break;case"Http":case"Https_OneDrive":case"Https_DropBox":case"Https_GoogleDrive":case"Https_Wikipedia":h=(0,w.PA)(w.IY.CustomerOneDriveOnlyUrlChange)&&Kt()&&!(0,fe.$1)((0,he.wo)())?PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError:PowerpointCopilotStrings.DocumentUrlNotFromSharePoint;break;case"Unclean":h=PowerpointCopilotStrings.DocumentUrlExtraChars;break;case"Email":h=PowerpointCopilotStrings.UnsupportedPersonUrlError;break;case"Calendar":h=PowerpointCopilotStrings.UnsupportedMeetingUrlError;break;case"Https":if((0,w.PA)(w.IY.CustomerOneDriveOnlyUrlChange)&&Kt()&&!(0,fe.$1)((0,he.wo)())){h=PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError;break}default:h=PowerpointCopilotStrings.DocumentUrlInvalidError}return g={errorMessage:h,errorType:void 0,featureName:K.CC.CreatePresentation,subFeatureName:K.Ff.CreateFromFile},null===(f=e.current)||void 0===f||f.addResponseMessage((0,ue.qi)(h,ue.OT,!0,I.Xw.CHATPPT,void 0,!1,!0,void 0,g)),(0,Z.AQ)(Ye,L.qD,K.a5.DocumentUrlInvalidError,"TransformFile_DocumentURL"+_t(s),I.T_.UnsupportedAction),m=(0,ve.Uv)(K.G8.UserInputCouldNotBeProcessed,K.av.DocumentUrlInvalidError),Ye.logAshaErrorEvent(m.vetoName,m.errorString,m.featureName),[2,!1]}if(cn(t.toLowerCase(),r)&&oe._.getInstance().getSlideCountCached()>1)return v={errorMessage:"CreateNewPresentationFromExisting",errorType:void 0,featureName:K.CC.CopilotChat,subFeatureName:void 0},S=(0,me.kb)(e,I.e0.CreateNewPresentationFromExisting,n,!1,v),U.R.getInstance().setCachedRequestParameters(void 0,dn(t,r),void 0),U.R.getInstance().setWarningMessageActive(!0),null==e||null===(y=e.current)||void 0===y||y.addResponseMessage(S),H.R.getInstance().setState(I.Nj.IDLE),n(!0),[2,!1];if(t===(0,C.JDs)()&&(0,w.bw)(w.WT.ShowPersonalizationSuggestionPill)&&tt)return Rt(e),tt=!1,i([]),[2,!1];if((0,w.bw)(w.WT.IsRealtimeVoiceEnabled)&&(0,w.PA)(w.IY.IsRealtimeVoiceZQMEnabled)&&(0,P.wI1)(t))return null===(b=e.current)||void 0===b||b.addResponseMessage((0,P.PrQ)((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.openRealtimeVoiceCopilot()}))),[2,!1];if(kt(t)){if((0,w.bw)(w.WT.isCreatePresentationViaNBInChatEnabled)&&((0,Ce.hX)(r)||0===(null==r?void 0:r.length))&&!(0,Fe.dD)())return(0,w.PA)(w.IY.IsShowLaunchNBResponseCardEnabled)?(null==e||null===(E=e.current)||void 0===E||E.addResponseMessage((0,He.n)(e,t)),[2,!1]):(T={userPrompt:t,sourceComponent:G.FX.Submit,initiatorView:Xe},[2,Promise.resolve(Ot(T).then((function(e){return!e})))]);if(!oe._.getInstance().isDocumentIrm())return[2,!0]}else if(At(t)&&!oe._.getInstance().isDocumentIrm())return[2,!0];return[2,!0]}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),Ot=function(){var e=(0,r._)((function(e){var t,n,i,a,s,l;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:t={status:I.rI.SUCCESS},(0,fe.cY)("Triggering Launch NB message for Create Presentation with user prompt"),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.TriggerCreatePresentationViaNBCalled))),n=zt(),i={scenarioOptions:JSON.stringify(n)},a={actionName:G.R4.LaunchNarrativeBuilder,actionData:JSON.stringify(e),correlationId:n.correlationId},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,Oe.Rf)(e,[],i,a)];case 1:return t=n.sent(),e.sync(),(0,fe.cY)("Launch NB message Log result : ",JSON.stringify(t)),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return u.sent(),[3,4];case 3:return s=u.sent(),(0,fe.cY)("Launch NB message Execute failed:"+JSON.stringify(s)),t={status:I.rI.FAILED,error:I.Re.JOFC_EXCEPTION},Ye.sendErrorTelemetry((0,Z.pN)((l={},(0,o._)(l,K.IC.ErrorMessage,"Error in handleCreatePresentationNB method: ".concat(null==s?void 0:s.message)),(0,o._)(l,K.IC.ErrorCategory,K.S2.LaunchNarrativeBuilder),l))),[2,!1];case 4:return[2,!0]}}))}));return function(t){return e.apply(this,arguments)}}(),Dt=function(){var e=(0,r._)((function(e,t,n){var r;return(0,c.__generator)(this,(function(o){return(0,fe.cY)("onCreatePresentationPromptClicked promptText: ".concat(e,", source: ").concat(t)),r={userPrompt:e,sourceComponent:t,initiatorView:Xe,isCreateFromFile:n},[2,Promise.resolve(Ot(r).then((function(e){return e})))]}))}));return function(t,n,r){return e.apply(this,arguments)}}(),Lt=function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){return e&&window.open(e,"_blank"),[2]}))}));return function(t){return e.apply(this,arguments)}}(),Rt=function(e){var t,n=(0,C.rq$)()+(0,C.kOX)()+(0,C.FME)()+(0,C.y_q)(),r={chatCardType:N._.MarkdownCard,chatMessageData:{markDownCardProps:{user:I.Q9.Chat,message:n}},chatMessageBodyData:ue.tc};null===(t=e.current)||void 0===t||t.addResponseMessage(r)},Ft=function(e){var t,n={text:PowerpointCopilotStrings.LearnMoreAssistantResponsePrefix},r={linkText:{text:PowerpointCopilotStrings.LearnMoreAssistantResponseSuffix,linkOnClick:Lt,linkUrl:C.iuI}},o=[{listItems:(0,C.sjW)().map((function(e){return{text:e}}))}],i={featureName:K.CC.CopilotChat,subFeatureName:void 0};null===(t=e.current)||void 0===t||t.addResponseMessage((0,ue.fz)(o,n,r,ue.x5,!0,I.Xw.CHATPPT,i))},Mt=function(){var e=(0,r._)((function(e){var t,n;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return t=e[0].split("doc\\"),n=t[t.length-1],[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return void 0!==n&&e.presentation.setSelectedSlides([n]),[4,e.sync()];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return o.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Bt=function(){var e=(0,r._)((function(e){var t,n,i,a,s,l;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:t={status:I.rI.SUCCESS},u.label=1;case 1:return u.trys.push([1,3,,4]),(0,fe.cY)("Triggering Play Key Slides Click for Slide Ids: ",e),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.PlayKeySlidesButtonClicked))),n=zt(),i={scenarioOptions:JSON.stringify(n)},a={actionName:G.R4.KeySlideShow,actionData:JSON.stringify(e),correlationId:n.correlationId},[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,Oe.Rf)(e,[],i,a)];case 1:return t=n.sent(),e.sync(),(0,fe.cY)("Log result : ",JSON.stringify(t)),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return u.sent(),[3,4];case 3:return s=u.sent(),(0,fe.cY)("Execute failed:"+JSON.stringify(s)),t={status:I.rI.FAILED,error:I.Re.JOFC_EXCEPTION},Ye.sendErrorTelemetry((0,Z.pN)((l={},(0,o._)(l,K.IC.ErrorMessage,"Error in handlePlayKeySlidesClick method: ".concat(null==s?void 0:s.message)),(0,o._)(l,K.IC.ErrorCategory,K.S2.PlayKeySlides),l))),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=(0,r._)((function(e){var t,n,i,a,s,l,u;return(0,c.__generator)(this,(function(d){switch(d.label){case 0:t={status:I.rI.SUCCESS},d.label=1;case 1:return d.trys.push([1,3,,4]),(0,fe.cY)("Triggering Translation on user click with data: ",e),Ye.sendChatEventTelemetry((0,Z.pN)((n={},(0,o._)(n,K.h3.ChatEventType,K.a5.TranslatePresentationButtonClicked),(0,o._)(n,K.h3.ChatEventParameters,JSON.stringify(e)),n))),i=zt(),a={scenarioOptions:JSON.stringify(i)},s={actionName:G.R4.TranslatePresentation,actionData:JSON.stringify(e),correlationId:i.correlationId},[4,PowerPoint.run(function(){var e=(0,r._)((function(e){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,Oe.Rf)(e,[],a,s)];case 1:return t=n.sent(),e.sync(),(0,fe.cY)("Log result : ",JSON.stringify(t)),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return d.sent(),[3,4];case 3:return l=d.sent(),(0,fe.cY)("Execute failed:"+JSON.stringify(l)),t={status:I.rI.FAILED,error:I.Re.JOFC_EXCEPTION},Ye.sendErrorTelemetry((0,Z.pN)((u={},(0,o._)(u,K.IC.ErrorMessage,"Error in handleTranslatePresentationClick method: ".concat(null==l?void 0:l.message)),(0,o._)(u,K.IC.ErrorCategory,K.S2.TranslatePresentation),(0,o._)(u,K.h3.ChatErrorType,Be.q0.Client),u))),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();function zt(){var e,t=(null!==(e=null==Ye?void 0:Ye.getQueryGuid())&&void 0!==e?e:"").length>0?Ye.getQueryGuid():(0,d.A)(),n=le.K.getInstance();return{scenarioName:n.getScenarioName(),startTime:n.getStartTime(),entryPoint:C.$kB.Chat,correlationId:t,timeToODSLMS:1e3*n.getResponseTime(),timeODSLToJOfcMS:0,capability:n.getCapability(),featureName:n.getFeatureName(),subFeatureName:n.getSubFeatureName()}}var Ht=function(e){return'"'+(e.length>150?e.slice(0,150)+"...":e)+'"'},Gt=function(e){return C.vHI.transformFile().slice(0,-3).trim()===e.trim()||C.UeP.createPresentationFrom().slice(0,-6).trim()===e.trim()||C.vHI.transformFile().slice(0,-3).trim()+" ".concat(C.iTS)===e.trim()||C.UeP.createPresentationFrom().slice(0,-6).trim()+" ".concat(C.iTS)===e.trim()||C.vHI.transformFile().slice(0,-3).trim()+C.iTS===e.trim()||C.UeP.createPresentationFrom().slice(0,-6).trim()+C.iTS===e.trim()},Vt=function(e){try{return new RegExp("(".concat(["\\bdrive\\.google\\.com\\b"].join("|"),")"),"i").test(e)}catch(e){return(0,fe.cY)("Error during Google Drive pattern matching ",e.message),!1}},jt=function(e){try{return new RegExp("(".concat(["\\bhttps://[\\S]+\\.wikipedia\\.org/wiki/\\b"].join("|"),")"),"i").test(e)}catch(e){return(0,fe.cY)("Error during Wikipedia pattern matching ",e.message),!1}};function qt(e){return Wt.apply(this,arguments)}function Wt(){return(Wt=(0,r._)((function(e){return(0,c.__generator)(this,(function(t){return Zt()&&null!==e&&jt(e)?[2,Yt(e)]:[2,""]}))}))).apply(this,arguments)}function Yt(e){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,r._)((function(e){var t,n,r,i,a,s,l,u,d,p,f,h,g,m;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:t=e,c.label=1;case 1:if(c.trys.push([1,6,,7]),jt(e)&&(y=e.match(/\/wiki\/([^\/?#]+)(?:[\/?#]|$)/i),!(t=y?decodeURIComponent(y[1]):null)))throw new Error("Empty Search Term");return n="https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=".concat(encodeURIComponent(t),"&format=json&origin=*"),[4,fetch(n)];case 2:if(!(r=c.sent()).ok)throw new Error("API Error");return[4,r.json()];case 3:if(0===(i=c.sent()).query.search)throw new Error("Empty Result");if(!(a=i.query.search[0].pageid))throw new Error("No PageId");return s="https://en.wikipedia.org/w/api.php?action=query&prop=extracts&exintro=&format=json&origin=*&pageids=".concat(encodeURIComponent(a)),[4,fetch(s)];case 4:if(!(l=c.sent()).ok)throw new Error("Cannot Retrieve Page");return[4,l.json()];case 5:if(u=c.sent(),d=u.query.pages,p=Object.keys(d)[0],!(f=d[p].extract)||f.includes("NewPP limit report"))throw new Error("Empty Page");return[2,f];case 6:return h=c.sent(),g="Error fetching Wikipedia page: ".concat(h.message),je.error(g),Ye.sendErrorTelemetry((0,Z.pN)((m={},(0,o._)(m,K.IC.ErrorMessage,g),(0,o._)(m,K.IC.ErrorCategory,K.S2.Error),m))),[3,7];case 7:return[2,""]}var y}))}))).apply(this,arguments)}var Jt=function(e){try{return new RegExp("(".concat(["\\bwww\\.dropbox\\.com\\b"].join("|"),")"),"i").test(e)}catch(e){return(0,fe.cY)("Error during DropBox pattern matching ",e.message),!1}},Xt=function(e){return e&&Zt()&&jt(e)},Kt=function(){return(0,w.bw)(w.WT.IsBumbleBeeEnabledForConsumer)},Zt=function(){return(0,w.bw)(w.WT.IsWikipediaTransformFeatureEnabled)},$t=function(e){try{return new RegExp("(".concat(["\\b1drv-int\\.com\\b","\\b1drv\\.com\\b","\\badjust\\.com\\b","\\bapi\\.live\\.net\\b","\\bapis\\.live\\.net\\b","\\baria\\.microsoft\\.com\\b","\\bbranch\\.io\\b","\\bcrashlytics\\.com\\b","\\bdocs\\.live\\.net\\b","\\bfabric\\.io\\b","\\bfavorites\\.live\\.com\\b","\\bg\\.live\\.com\\b","\\bgroups\\.office\\.live\\.com\\b","\\bgroups\\.photos\\.live\\.com\\b","\\bgroups\\.skydrive\\.live\\.com\\b","\\blive\\.com\\b","\\blivefilestore\\.com\\b","\\blogin\\.live\\.com\\b","\\blogin\\.microsoftonline\\.com\\b","\\blogin\\.windows\\.net\\b","\\bmesh\\.com\\b","\\bmicrosoft\\.com\\b","\\bmobileengagement\\.windows\\.net\\b","\\boauth\\.live\\.com\\b","\\bodc\\.officeapps\\.live\\.com\\b","\\boffice\\.com\\b","\\bofficeapps\\.live\\.com\\b","\\boneclient\\.sfx\\.ms\\b","\\bonedrive\\.com\\b","\\bonedrive\\.live\\.com\\b","\\bp\\.sfx\\.ms\\b","\\bphotos\\.live\\.com\\b","\\bpolicies\\.live\\.net\\b","\\bposarprodcssservice\\.accesscontrol\\.windows\\.net\\b","\\bredemptionservices\\.accesscontrol\\.windows\\.net\\b","\\bservicebus\\.windows\\.net\\b","\\bsettings\\.live\\.net\\b","\\bskyapi\\.live\\.net\\b","\\bskydrive\\.live\\.com\\b","\\bsnapi\\.live\\.net\\b","\\bspoprod-a\\.akamaihd\\.net\\b","\\bstorage\\.live\\.com\\b","\\bstorage\\.msn\\.com\\b","\\btoken\\.cp\\.microsoft\\.com\\b","\\btokensit\\.cp\\.microsoft-tst\\.com\\b","\\bvas\\.samsungapps\\.com\\b","\\bvortex\\.data\\.microsoft\\.com\\b","\\b1drv\\.ms\\b","\\bsdrv\\.ms\\b","\\bdf\\.api\\.onedrive\\.com\\b","\\bdf\\.storage\\.live\\.com\\b","\\bdf\\.storage\\.msn\\.com\\b","\\bdf\\.livefilestore\\.com\\b","\\bfiles-df\\.1drv\\.com\\b","\\bdf\\.settings\\.live\\.net\\b","\\bdf\\.settings\\.live\\.net\\b","\\bdocs-df\\.live\\.net\\b","\\bdocs-df\\.live\\.net\\b"].join("|"),")"),"i").test(e)}catch(e){return(0,fe.cY)("Error during OneDrive pattern matching ",e.message),!1}},en=function(e){return e.toLowerCase().startsWith(C.vHI.transformFile().slice(0,-3).toLowerCase())||e.toLowerCase().startsWith(C.UeP.createPresentationFrom().slice(0,-7).toLowerCase())},tn=function(e,t){if(!en(e))return"Https";var n,r=new RegExp("".concat("https://[^\\s]*$"),"i"),o=null!==(n=lt())&&void 0!==n?n:"https://outlook.office365.com",i=new RegExp("".concat(o+"/owa/[^\\s]*path=/calendar/item[^\\s]*$"),"i");if(t&&t.length>0&&t[0].value.length>0)try{var a=new RegExp("^mailto:[^\\s]*$","i");if(t[0].value.match(a))return"Email";if(t[0].value.match(r)){return t[0].value.match(i)?"Calendar":"Https"}return"Invalid"}catch(e){return(0,fe.cY)("Error during URL pattern matching ",e.message),"Https"}try{var s=C.vHI.transformFile().slice(0,-3).trim()+"\\s*".concat(C.iTS,"?"),l=C.UeP.createPresentationFrom().slice(0,-6).trim()+"\\s*".concat(C.iTS,"?"),c=new RegExp("(".concat(s,"|").concat(l,")$"),"i");if(e.match(c))return"Empty";if(e.match(r))return $t(e)?"Https_OneDrive":Jt(e)?"Https_DropBox":Vt(e)?"Https_GoogleDrive":e.match(i)?"Calendar":jt(e)?"Https_Wikipedia":"Https";var u=new RegExp("".concat("http://[^\\s]*$"),"i");if(e.match(u))return"Http";var d=new RegExp("".concat("['\"/]+(https|http)://[^\\s]*$"),"i");if(e.match(d))return"Unclean"}catch(e){return(0,fe.cY)("Error during URL pattern matching ",e.message),"Https"}return"Invalid"},nn=function(e,t){if(!en(e))return["Https"];if(!(0,w.bw)(w.WT.IsMultiFileURLScreenFeatureEnabled))return[tn(e,t)];var n,r=new RegExp("".concat("https://[^\\s]*"),"i"),o=null!==(n=lt())&&void 0!==n?n:"https://outlook.office365.com",i=new RegExp("".concat(o+"/owa/[^\\s]*path=/calendar/item[^\\s]*$"),"i"),a=[];if(t){var s=!0,l=!1,c=void 0;try{for(var u,d=t[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var p=u.value;try{var f=new RegExp("^mailto:[^\\s]*$","i");if(p.value.match(f)&&a.push("Email"),p.value.match(r)){p.value.match(i)?a.push("Calendar"):a.push("Https")}}catch(e){(0,fe.cY)("Error during URL pattern matching ",e.message),a.push("Https")}}}catch(e){l=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}try{var h=C.vHI.transformFile().slice(0,-3).trim()+"\\s*".concat(C.iTS,"?"),g=C.UeP.createPresentationFrom().slice(0,-6).trim()+"\\s*".concat(C.iTS,"?"),m=new RegExp("(".concat(h,"|").concat(g,")$"),"i");e.match(m)&&a.push("Empty"),e.match(r)&&($t(e)&&a.push("Https_OneDrive"),Jt(e)&&a.push("Https_DropBox"),Vt(e)&&a.push("Https_GoogleDrive"),jt(e)&&a.push("Https_Wikipedia"),e.match(i)&&a.push("Calendar"));var y=new RegExp("".concat("http://[^\\s]"),"i");e.match(y)&&a.push("Http");var v=new RegExp("".concat("['\"/](https|http)://[^\\s]"),"i");e.match(v)&&a.push("Unclean")}catch(e){(0,fe.cY)("Error during URL pattern matching ",e.message),a.push("Https")}return a},rn=function(){var e=(0,r._)((function(e){var t,n,r,i,a,s,l,u,d,p,f,h,g,m,y,b,E,w,I,P,_,A,x;return(0,c.__generator)(this,(function(c){if((0,fe.cY)("Checking if Augloop response should be ignored",e.body.H_.T_),null===(t=e.body)||void 0===t?void 0:t.H_){if(a=null===(n=e.body)||void 0===n?void 0:n.queryId,!S.G.getInstance().isValidAnnotationResponse(a))switch(e.body.H_.T_){case W.c.getTypeName():return Ye.setQueryGuid(a),(0,Ae.Lg)(e.body),Ye.sendChatEventTelemetry((0,Z.pN)((d={},(0,o._)(d,K.h3.ChatEventType,K.a5.InvalidContextIdResponse),(0,o._)(d,K.h3.ChatEventParameters,null!==(u=null===(l=e.body)||void 0===l||null===(s=l.H_)||void 0===s?void 0:s.T_)&&void 0!==u?u:""),d))),Ye.setQueryGuid(C.u1i),[2,!0];case v.YO.getTypeName():case k.yG.getTypeName():case k.SB.getTypeName():case k.kb.getTypeName():case z.Ob.getTypeName():case z.KJ.getTypeName():return Ye.setQueryGuid(a),Ye.sendChatEventTelemetry((0,Z.pN)((g={},(0,o._)(g,K.h3.ChatEventType,K.a5.InvalidContextIdResponse),(0,o._)(g,K.h3.ChatEventParameters,null!==(h=null===(f=e.body)||void 0===f||null===(p=f.H_)||void 0===p?void 0:p.T_)&&void 0!==h?h:""),g))),Ye.setQueryGuid(C.u1i),[2,!0]}if(m=null===(r=e.body)||void 0===r?void 0:r.correlationId,!S.G.getInstance().isValidAnnotationResponse(m))switch(e.body.H_.T_){case T.yg.getTypeName():case ce.i.getTypeName():case ce.f.getTypeName():case re.B.getTypeName():case Ue.C.getTypeName():return Ye.setQueryGuid(m),Ye.sendChatEventTelemetry((0,Z.pN)((w={},(0,o._)(w,K.h3.ChatEventType,K.a5.InvalidContextIdResponse),(0,o._)(w,K.h3.ChatEventParameters,null!==(E=null===(b=e.body)||void 0===b||null===(y=b.H_)||void 0===y?void 0:y.T_)&&void 0!==E?E:""),w))),Ye.setQueryGuid(C.u1i),[2,!0]}return I=null===(i=e.body)||void 0===i?void 0:i.contextId,S.G.getInstance().isValidAnnotationResponse(I)||e.body.H_.T_!==se._t.getTypeName()?[2,!1]:(Ye.setQueryGuid(I),Ye.sendChatEventTelemetry((0,Z.pN)((x={},(0,o._)(x,K.h3.ChatEventType,K.a5.InvalidContextIdResponse),(0,o._)(x,K.h3.ChatEventParameters,null!==(A=null===(_=e.body)||void 0===_||null===(P=_.H_)||void 0===P?void 0:P.T_)&&void 0!==A?A:""),x))),Ye.setQueryGuid(C.u1i),[2,!0])}return[2,!1]}))}));return function(t){return e.apply(this,arguments)}}(),on=function(e,t){var n,r,i,a,s,l=null!==(a=null==e?void 0:e.feedbackArea)&&void 0!==a?a:I.Xw.CHATPPT;s=(0,w.PA)(w.IY.IsFeedbackAIThumbsUpScenarioEnabled)?sn(null==e?void 0:e.contextData,I.uo.AIThumbsUp):sn(null==e?void 0:e.contextData);var c=I.Zi.Like,u=I.NX.ModalDialog;q.i.GetHostAppPlatform()===C.nAd&&(u=I.NX.Taskpane);var d,p=K.Ff.Unset;if(t){var f=gn(t),h=f.correlationId,g=f.featureName,m=f.subFeatureName;m&&(p=m),h&&Ye.setQueryGuid(h),g&&Ye.logFeedbackEvent(!0,g,p,(0,ve.d3)(g))}var y,v={groundingSource:null!==(d=null==e||null===(n=e.contextData)||void 0===n?void 0:n.groundingSource)&&void 0!==d?d:"CurrentContext",queryId:null==e||null===(i=e.contextData)||void 0===i||null===(r=i.feedbackContextData)||void 0===r?void 0:r.promptId,feedbackArea:l,subFeatureName:p};Ye.sendChatEventTelemetry((0,Z.pN)((y={},(0,o._)(y,K.h3.ChatEventType,K.a5.ThumbsUpButtonClicked),(0,o._)(y,K.h3.ChatEventParameters,JSON.stringify(v)),y))),t&&Ye.setQueryGuid(""),(0,be.mf)(),(0,be.N6)(c,u,l,s)},an=function(e,t){var n,r,i,a,s=null!==(a=null==e?void 0:e.feedbackArea)&&void 0!==a?a:I.Xw.CHATPPT,l=sn(null==e?void 0:e.contextData,I.uo.AIThumbsDown),c=I.Zi.Dislike,u=I.NX.ModalDialog;q.i.GetHostAppPlatform()===C.nAd&&(u=I.NX.Taskpane);var d,p=K.Ff.Unset;if(t){var f=gn(t),h=f.correlationId,g=f.featureName,m=f.subFeatureName;m&&(p=m),h&&Ye.setQueryGuid(h),g&&Ye.logFeedbackEvent(!1,g,p,(0,ve.d3)(g))}var y,v={groundingSource:null!==(d=null==e||null===(n=e.contextData)||void 0===n?void 0:n.groundingSource)&&void 0!==d?d:"CurrentContext",queryId:null==e||null===(i=e.contextData)||void 0===i||null===(r=i.feedbackContextData)||void 0===r?void 0:r.promptId,feedbackArea:s,subFeatureName:p};Ye.sendChatEventTelemetry((0,Z.pN)((y={},(0,o._)(y,K.h3.ChatEventType,K.a5.ThumbsDownButtonClicked),(0,o._)(y,K.h3.ChatEventParameters,JSON.stringify(v)),y))),t&&Ye.setQueryGuid(""),(0,be.mf)(),(0,be.N6)(c,u,s,l)},sn=function(e,t){var n={},r={isEmailCollectionEnabled:I.Mg.false,isFileUploadEnabled:I.Mg.false,isScreenshotEnabled:I.Mg.false,isThankYouPageDisabled:I.Mg.true},o={isScenarioEnabled:!1,question:{questionUIType:"DropDown",questionInstruction:{displayedString:" ",displayedStringInEnglish:" "},questionOptions:[{displayedString:" ",displayedStringInEnglish:" "}]}};if(t&&(o.isScenarioEnabled=!0,o.scenarioType=t),void 0!==(null==e?void 0:e.cardMetaData)){var i={fileType:"text/plain; charset=utf-8",fileName:"contextData.txt",base64Data:qe.from(e.cardMetaData,"utf8").toString("base64")};r.contextDataFiles=[i]}return(0,w.PA)(w.IY.ScreenshotInFeedbackEnabled)&&(r.isScreenshotEnabled=I.Mg.true),he.BJ&&(0,Se.z4)()&&(r.isEmailCollectionEnabled=I.Mg.false,r.isFileUploadEnabled=I.Mg.false,r.isScreenshotEnabled=I.Mg.false,r.isScreenRecordingEnabled=I.Mg.false,r.isHostManagedContextDataEnabled=I.Mg.true,r.hostManagedContextDataExplanationUrl=C.Lvp,r.isRetrieveFormDataEnabled=I.Mg.true),r.scenarioConfig=o,n.v2Config=r,n},ln=function(){var e=(0,r._)((function(){return(0,c.__generator)(this,(function(e){return[2,(0,w.bw)(w.WT.UseOfficeJSDocumentURL)?q.i.getDocumentUrlAsync():void 0]}))}));return function(){return e.apply(this,arguments)}}(),cn=function(e,t){return(0,w.bw)(w.WT.IsPreTriggerContentProcessingWorkflowEnabled)&&!pn()&&un(e,t)&&en(e)},un=function(e,t){if((0,w.bw)(w.WT.UrlDetailedErrorEnabled)){var n=tn(e,t);return(0,w.PA)(w.IY.CustomerOneDriveOnlyUrlChange)?Kt()&&!(0,fe.$1)((0,he.wo)())?"Https_OneDrive"===n:"Https"===n:"Https"===n||Kt()&&"Https_OneDrive"===n}return""!==dn(e,t)},dn=function(e,t){if(t&&t.length>0)return t[0].value;var n="https://",r=e.indexOf(n);return-1!==r&&-1===e.indexOf(" ",r)?n+e.substring(r+8):""},pn=function(){return j.Vv.IsSettingTrue(j.zj.PPTContentGenerationDisabledByAdmin)},fn=function(e){var t,n=new h.Xr({parentPath:["session","#userContext#"],items:[{id:"myUserContext1",body:new v.MH({isAdminControlTurnedOn:pn()})}]});null===(t=e.current)||void 0===t||t.submitOperation({operation:n,workflowAnnotationType:v.MH.getTypeName()})};function hn(){switch(q.i.GetHostAppPlatform()){case C.nAd:return R.Y.win32;case C.xb6:return R.Y.MACOS;case C.TTX:return R.Y.IOS;default:return R.Y.web}}var gn=function(e){var t={};try{t=JSON.parse(e)}catch(e){(0,fe.cY)("Error parsing telemetry data ",e.message)}return t};function mn(){return(0,w.PA)(w.IY.EnableGetJsonCmdVersion)?j.Vv.getSettingAsString(j.zj.PPTJsonCmdAPIVersion):void 0}function yn(){return(0,w.PA)(w.IY.IsSegmentToSlideSendTemplateIdEnabled)&&oe._.getInstance().isCreateNewFromBlank()?"":"NonEmptyTemplateId"}function vn(e){return(0,fe.cY)("intent: ".concat(e)),e===_.N.Summary}var Sn=function(e){return e&&e.length>0?Pe()("sha256").update(e).digest("hex"):null};function Cn(){return bn.apply(this,arguments)}function bn(){return(bn=(0,r._)((function(){var e,t,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:e={},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.UserFeedback.GetHostScreenshot()];case 2:return e=r.sent(),[3,4];case 3:return t=r.sent(),Ye.sendErrorTelemetry((0,Z.pN)((n={},(0,o._)(n,K.IC.ErrorMessage,"Error in OfficeFirstParty UserFeedback GetHostScreenshot: ".concat(t.message)),(0,o._)(n,K.IC.ErrorCategory,K.S2.Error),n))),(0,fe.cY)("Error in OfficeFirstParty UserFeedback GetHostScreenshot ",t),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function En(){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,r._)((function(){var e,t,n,r,i,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:e=!1,s.label=1;case 1:return s.trys.push([1,3,,8]),[4,OfficeFirstParty.UserFeedback.CanCollectCopilotFeedback()];case 2:return e=s.sent(),(0,fe.cY)("OfficeFirstParty CanCollectCopilotFeedback : "+e),[3,8];case 3:t=s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),Ye.sendErrorTelemetry((0,Z.pN)((n={},(0,o._)(n,K.IC.ErrorMessage,"error in CanCollectCopilotFeedback Api : ".concat(t.message)),(0,o._)(n,K.IC.ErrorCategory,K.S2.Error),n))),(0,fe.cY)("Error in UserFeedback CanCollectCopilotFeedback : ",t),[4,OfficeFirstParty.UserFeedback.CanCollectUserFeedback()];case 5:return e=s.sent(),(0,fe.cY)("OfficeFirstParty CanCollectUserFeedback : ",e),[3,7];case 6:return r=s.sent(),Ye.sendErrorTelemetry((0,Z.pN)((i={},(0,o._)(i,K.IC.ErrorMessage,"error in CanCollectUserFeedback Api : ".concat(r.message)),(0,o._)(i,K.IC.ErrorCategory,K.S2.Error),i))),(0,fe.cY)("Error in UserFeedback CanCollectUserFeedback : ",r),(a=j.Vv.getSettingAsString(j.zj.FeedbackEnabled))&&(e="true"===a.toLowerCase(),(0,fe.cY)("HostAppSetting Feedbackenabled : ",e)),[3,7];case 7:return[3,8];case 8:return[2,e]}}))}))).apply(this,arguments)}var wn=function(e,t){try{OfficeFirstParty.UserFeedback.InvokeDiagnosticsLogsUpload(e)}catch(e){var n;Ye.sendErrorTelemetry((0,Z.pN)((n={},(0,o._)(n,K.IC.ErrorMessage,"Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload: ".concat(e.message)),(0,o._)(n,K.IC.ErrorCategory,K.S2.Error),n))),(0,fe.cY)("Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload ",e)}},In=function(){if(_e.Ms)try{var e=JSON.parse(_e.Ms);return e&&(e=(0,a._)((0,i._)({},e),{callbackFunctions:(0,a._)((0,i._)({},e.callbackFunctions),{provideDynamicScreenshot:Cn}),feedbackConfig:(0,a._)((0,i._)({},e.feedbackConfig),{diagnosticsConfig:(0,a._)((0,i._)({},e.feedbackConfig.diagnosticsConfig),{attachDiagnostics:wn})})})),(0,w.PA)(w.IY.IsFeedbackAppChatThemingEnabled)?{feedbackInitOptions:e,lightTheme:{baseTheme:"PowerPointLightTheme"},darkTheme:{baseTheme:"PowerPointDarkTheme"}}:{feedbackInitOptions:e}}catch(e){var t;return Ye.sendErrorTelemetry((0,Z.pN)((t={},(0,o._)(t,K.IC.ErrorMessage,"Error in parsing feedbackInitializationData to JSON: ".concat(e.message)),(0,o._)(t,K.IC.ErrorCategory,K.S2.Error),t))),void(0,fe.cY)("Error in parsing feedbackInitializationData to JSON ",e)}},Pn=function(e,t,n){var r,i,a,s,l,c=null!==(s=null==t?void 0:t.feedbackArea)&&void 0!==s?s:I.Xw.CHATPPT,u=K.Ff.Unset,d=void 0,p=void 0;if(n){var f=gn(n),h=f.correlationId,g=f.featureName,m=f.subFeatureName,y=f.copilotAgentId;m&&(u=m),h&&(d=h,Ye.setQueryGuid(d)),y&&""!==y&&(p=y),g&&Ye.logFeedbackEvent(e===F.Gb.LIKE,g,u,(0,ve.d3)(g))}var v,S={groundingSource:null!==(l=null==t||null===(r=t.contextData)||void 0===r?void 0:r.groundingSource)&&void 0!==l?l:"CurrentContext",queryId:null==t||null===(a=t.contextData)||void 0===a||null===(i=a.feedbackContextData)||void 0===i?void 0:i.promptId,feedbackArea:c,subFeatureName:u,copilotAgentId:p},C=e===F.Gb.LIKE?K.a5.ThumbsUpButtonClicked:K.a5.ThumbsDownButtonClicked;Ye.sendChatEventTelemetry((0,Z.pN)((v={},(0,o._)(v,K.h3.ChatEventType,C),(0,o._)(v,K.h3.ChatEventParameters,JSON.stringify(S)),v))),d&&Ye.setQueryGuid("")},_n=function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.getExternalDocSensitivityLabelInfo(),a=(t=i)?(0,w.bw)(w.WT.IsEmptyLabelFixForCLPv2FeatureEnabled)||t.tenantId?t.labelId?"":"labelId":"tenantId":"labelInfo";r&&a&&Ye.sendChatEventTelemetry((0,Z.pN)((n={},(0,o._)(n,K.h3.ChatEventType,K.a5.CLPEmptySourceLabel),(0,o._)(n,K.h3.ChatEventParameters,a),n)));return""!==a},An=function(){var e=(0,r._)((function(e,t){var n,r,i;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return(0,fe.cY)("Applying label using tryUpgradeLabel API"),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.CLPUpgradeLabelStart))),_n(e)?(Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.CLPUpgradeLabelAborted))),[2,!0]):(n=e.getExternalDocSensitivityLabelInfo(),[4,e.upgradeSensitivityLabelUsingOfcJs(n)]);case 1:return r=a.sent(),Ye.sendChatEventTelemetry((0,Z.pN)((i={},(0,o._)(i,K.h3.ChatEventType,K.a5.CLPUpgradeLabelStatus),(0,o._)(i,K.h3.ChatEventParameters,r.status),i))),t.payload=r.status,t.errorMessage=r.errorMessage,r.status!==P.qHn[P.qHn.S_APPLYLABEL_OK]&&r.status!==P.qHn[P.qHn.E_APPLYLABEL_NEWLABELSENSITIVITYORDER]?(t={status:I.rI.FAILED,error:I.Re.APPLY_CLP_LABEL_FAILED,errorMessage:r.errorMessage},[2,!1]):[2,!0]}}))}));return function(t,n){return e.apply(this,arguments)}}();function kn(e,t){return t?M.BD.highContrast:e!==B.G.defaultWhite?M.BD.dark:M.BD.default}function xn(){return Nn.apply(this,arguments)}function Nn(){return Nn=(0,r._)((function(){var e,t,n,r,o,s,l,u,d,p,f=arguments;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:e=f.length>0&&void 0!==f[0]?f[0]:B.G.defaultWhite,t=f.length>1&&void 0!==f[1]&&f[1],n={locale:(0,V.hD)(q.i.GetHostAppDisplayLanguage()),sessionId:j.Vv.getSettingAsString(j.zj.ChatPPTSessionID),physicalRing:(0,j.I_)()?"Dogfood":"Prod",clientType:q.i.isWebPlatform()?M.WK.web:M.WK.desktop,hubName:(0,w.PA)(w.IY.ShouldUseOfficeHubName)?M.UH.office:M.UH.orange,theme:kn(e,t),redirectUri:(0,ke.cn)(),clientId:P.qAn,aadUserId:"",userName:"",userPrincipalName:"",copilotChatThemev2:(0,P.IdZ)(xe.Os,e,t)},r="",o="",c.label=1;case 1:return c.trys.push([1,4,,5]),[4,new Promise((function(e){return Office.context.auth.getAuthContextAsync(e)}))];case 2:return s=c.sent(),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 3:return l=c.sent(),u=l.displayName.split(" ")[0],"succeeded"===s.status?(d=s.value,r=(0,w.bw)(w.WT.EnableInsightsCard)?u:d.userObjectId,o=d.userPrincipalName):(0,fe.cY)("Failed to fetch user id from OfficeJS"),[3,5];case 4:return p=c.sent(),(0,fe.cY)("Error getting user info: "+p),[2,n];case 5:return[2,(0,a._)((0,i._)({},n),{aadUserId:o,userName:r,userPrincipalName:o})]}}))})),Nn.apply(this,arguments)}var On=function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l="";switch(s){case F.ck.File:l=(0,C.wjL)();break;case F.ck.Event:l=(0,C.R7i)();break;case F.ck.People:l=(0,C.LMm)();break;case F.ck.Message:l=(0,C.WKk)()}t.push({entityType:s,message:l})}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t},Dn=function(){var e=[I.BJ.Ask,I.BJ.Create,I.BJ.Edit,I.BJ.Understand];return(0,w.bw)(w.WT.IsPersonalizationUXEnabled)&&e.push(I.BJ.Customize),e},Ln=function(e,t,n,r,i,a,s,l,c){var u=le.K.getInstance(),d=S.G.getInstance(),p=K.G8.UserCancelledResponse,f=K._5.UnclearIntent,g=u.getFeatureName();(0,fe.cY)("Stop Generation Clicked.");var m,y=ie.So&&!ie.Mv,v=ae.uT&&!ae.qv;if((y||v)&&!a){var b,E,T,P=null===(b=e.current)||void 0===b?void 0:b.getLastMessage(),_=null!==(T=null==P?void 0:P.messageType)&&void 0!==T?T:N._.MarkdownCard;null===(E=e.current)||void 0===E||E.updateLastMessage({chatCardType:_,stopLoadingUi:!0}),y&&(g=G.SD.Summarize,f=K._5.Summarize)}if(Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,n))),(0,w.PA)(w.IY.IsShouldSendStopGeneratingSignaltoALEnabled)&&function(e,t){var n,r={query:C.u1i,queryId:e,stopResponding:!0},i=new h.g0({parentPath:["Signal",Y.iq.getTypeName()],items:[{id:ne.r.generateId(),body:new Y.iq(r)}]});null===(n=t.current)||void 0===n||n.submitOperation({operation:i,workflowAnnotationType:W.c.getTypeName()}),Ye.sendChatEventTelemetry((0,Z.pN)((0,o._)({},K.h3.ChatEventType,K.a5.StopGeneratingSignalSentToAL))),(0,fe.cY)("Stop Generating Signal Sent to AL")}(i,e),Ye.logAshaErrorEvent((0,Z.A9)(f,p),r,g),Ye.sendLatencyTelemetry((0,Z.pN)((m={},(0,o._)(m,K.CT.StopGeneratingTime,(0,L.WU)(L.qD)),(0,o._)(m,K.CT.AnnotationType,n),(0,o._)(m,K.CT.FeatureName,g),m)),!0),(0,w.bw)(w.WT.IsNotificationEnabledForSummary)&&(0,De.Hv)(u.getUserQueryGuid()),d.emptyContextIdListandCleanup(),U.R.getInstance().getIsWarningMessageActive()&&(0,me.A)(e),t)if(s.current=!0,(0,Fe.dD)()&&H.R.getInstance().getState()===I.Nj.EXECUTING_APPLYJOFC_PROTOCOL){var A,k,x;null===(A=e.current)||void 0===A||A.startLoadingUi(),Office.context.ui.executeFeature(C.x8h),null===(k=e.current)||void 0===k||k.updateLoadingComponentProps({loadingUiStringList:null!==(x=(0,Ee.A)().get(I.Ae.UserCancellation))&&void 0!==x?x:[]}),l(!1)}else{var O;H.R.getInstance().setState(I.Nj.IDLE);var D={errorMessage:PowerpointCopilotStrings.StopGeneratingResponseMessage,errorType:I.Qp.StopGeneratingResponseMessage,featureName:g,subFeatureName:void 0};null===(O=e.current)||void 0===O||O.addResponseMessage((0,ue.qi)(PowerpointCopilotStrings.StopGeneratingResponseMessage,ue.tc,!0,I.Xw.CHATPPT,void 0,!1,!0,void 0,D))}(0,w.PA)(w.IY.AddScenarioNameReportStopGeneration)?(0,Me.k)(!1,G.tp.Cancelled,u.getScenarioName()):(0,Me.k)(!1,G.tp.Cancelled),c(!1)},Rn=function(e){S.G.getInstance().removeContextId(e)},Fn=function(){S.G.getInstance().removeContextId(Ye.getQueryGuid())},Mn=function(e){return"bot"===e.author&&e.messageType===f.n3.Chat&&e.contentOrigin===I.wz.IMAGE_CHAT},Bn=function(e){if(Mn(e)){var t=(0,ve.EJ)(e,!0);return{featureName:t.featureName,subFeatureName:t.subFeature}}};function Un(){return!(0,pe.w_)()}var zn=function(){var e=(0,r._)((function(e){var t,n,r,o;return(0,c.__generator)(this,(function(i){return(0,Ce.hX)(Re.Zw)?((0,fe.cY)("Augloop Session is undefined, stopping ".concat(e," signals.")),nt&&(clearInterval(nt),nt=null),Ye.sendChatEventTelemetry([{key:K.h3.ChatEventType,value:e===I.OY.Add?K.a5.TriggerPptAddVisualOperation:e===I.OY.Update?K.a5.TriggerPptUpdateVisualOperation:K.a5.TriggerPptDeleteVisualOperation},{key:K.h3.ChatEventParameters,value:C.mdg}]),Ye.sendErrorTelemetry([{key:K.IC.ErrorCategory,value:K.S2.PptVisual},{key:K.IC.ErrorMessage,value:C.mdg}]),[2]):(t={triggeredPptVisualOperation:!0,timestamp:(new Date).getTime()},n={lastActiveTimestamp:(new Date).getTime()},r=e===I.OY.Add?new h.Xr({parentPath:["session","doc"],items:[{id:"triggeredPptVisualOperation",body:new p._P(t)}]}):e===I.OY.Update?new h.fZ({parentPath:["session","doc"],items:[{id:"triggeredPptVisualOperation",body:new p._P(t)}]}):new h.n4({parentPath:["session","doc"],items:[{id:"triggeredPptVisualOperation",body:new p._P(t)}]}),o=e===I.OY.Add?new h.Xr({parentPath:["session","doc"],items:[{id:"triggeredPptGenericVisualOperation",body:new p.FR(n)}]}):e===I.OY.Update?new h.fZ({parentPath:["session","doc"],items:[{id:"triggeredPptGenericVisualOperation",body:new p.FR(n)}]}):new h.n4({parentPath:["session","doc"],items:[{id:"triggeredPptGenericVisualOperation",body:new p.FR(n)}]}),(0,fe.cY)("Sending PPT ".concat(e," Visual Operation")),Ye.sendChatEventTelemetry([{key:K.h3.ChatEventType,value:e===I.OY.Add?K.a5.TriggerPptAddVisualOperation:e===I.OY.Update?K.a5.TriggerPptUpdateVisualOperation:K.a5.TriggerPptDeleteVisualOperation},{key:K.h3.ChatEventParameters,value:"Send ".concat(e," Ppt Visual Operation")}]),Re.Zw.submitOperation(r),Re.Zw.submitOperation(o),(0,fe.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(r)+"\nat Time : "+new Date+"\n\n\n"),(0,fe.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(o)+"\nat Time : "+new Date+"\n\n\n"),[2])}))}));return function(t){return e.apply(this,arguments)}}(),Hn=function(){var e=(0,r._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),nt&&(clearInterval(nt),nt=null,zn(I.OY.Delete)),[4,zn(I.OY.Add)];case 1:return t.sent(),nt=setInterval((function(){return zn(I.OY.Update)}),C.bPX),[3,3];case 2:return e=t.sent(),(0,fe.cY)("Error in triggerPptVisualOnPaneLaunch: ".concat(e.message)),Ye.sendChatEventTelemetry([{key:K.h3.ChatEventType,value:K.a5.TriggerPptAddVisualOperation},{key:K.h3.ChatEventParameters,value:"Error in triggerPptVisualOnPaneLaunch: ".concat(e.message)}]),Ye.sendErrorTelemetry([{key:K.IC.ErrorCategory,value:K.S2.PptVisual},{key:K.IC.ErrorMessage,value:"".concat(e.message)}]),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Gn=function(){return(0,fe.cY)("Clearing PPT Visual Timer"),new Promise((function(e){nt&&(clearInterval(nt),nt=null,zn(I.OY.Delete)),e()}))},Vn=function(e){var t,n=null!==(t=oe._.getInstance().getSlideCount())&&void 0!==t?t:0,r=(0,w.bw)(w.WT.EnableInsightsCard),o=(0,fe.$1)((0,he.wo)());return(0,fe.cY)("shouldShowInsightCard with slideCount: ".concat(n,", deckTokenCount: ").concat(e,", isEnterpriseUser : ").concat(o,", featureGate : ").concat(r)),o&&r&&n>0&&e>=C.gcz}},73733:(e,t,n)=>{"use strict";n.d(t,{dv:()=>h,e9:()=>f,r4:()=>g,wC:()=>p,yS:()=>m});var r=n(90813),o=n(55564),i=n(39726),a=n(83048),s=n(18073),l=n(36633),c=n(37484),u=n(39041);function d(e){var t=e.telemetryEventHandler,n=e.commands,o=e.error,i=e.scenario,s=e.success,l=e.errorMessage,c=e.TranspilationLatencyMSec;if(!(0,u.hX)(t)){var d=0,p=!0,f=!1,h=void 0;try{for(var g,m=n[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=g.value,v="None";!(0,u.hX)(i)&&y in i&&i[y]&&(v=i[y]);var S,C=d===n.length-1;t.updateTelemetryCommandingData((S={},(0,r._)(S,a.S9.EventOrder,d),(0,r._)(S,a.S9.CommandName,y),(0,r._)(S,a.S9.Status,a.lK.Executed),(0,r._)(S,a.S9.IsCommandSuccessString,!(0,u.hX)(s)&&s?"true":"false"),(0,r._)(S,a.S9.ErrorCategory,o),(0,r._)(S,a.S9.ScenarioString,v),(0,r._)(S,a.S9.IsLastStatement,C?"true":"false"),(0,r._)(S,a.S9.Message,l||"NA"),(0,r._)(S,a.S9.TranspilationLatencyMSec,c||0),S)),++d}}catch(e){f=!0,h=e}finally{try{p||null==m.return||m.return()}finally{if(f)throw h}}}}function p(e,t,n,r,i){(0,o.PA)(o.IY.ShouldEnableCommandingTelemetry)&&((0,u.hX)(e)||((0,o.PA)(o.IY.IsErrorMessageLogAllowedForCommanding)||(i="LogNotEnabled"),d({telemetryEventHandler:e,commands:t,error:n,scenario:r,success:!1,errorMessage:i})))}function f(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;(0,o.PA)(o.IY.ShouldEnableCommandingTelemetry)&&((0,u.hX)(e)||d({telemetryEventHandler:e,commands:t,error:i?a.by.PartialSuccess:a.by.None,scenario:n,success:!0,TranspilationLatencyMSec:r}))}function h(e,t,n,r,s){if((0,o.PA)(o.IY.ShouldEnableCommandingTelemetry))if(n===i.rI.SUCCESS||n===i.rI.PARTIAL_SUCCESS)f(e,t,r,s);else if(!(0,u.hX)(e)){var l=a.by.Failed;switch(n){case i.rI.FAILED:l=a.by.Failed;break;case i.rI.BLOCKED:l=a.by.Blocked;break;case i.rI.UNSUPPORTED:case i.rI.UNEXPECTED_VERSION:l=a.by.Unsupported;break;case i.rI.USER_ABORTED:l=a.by.UserAborted;break;case i.rI.CONTENT_GENERATION_DISABLED:l=a.by.Unsupported;break;case i.rI.PAUSED_ON_WARNING:default:l=a.by.Failed}p(e,t,l,r)}}function g(e,t,n){var i;(0,o.PA)(o.IY.ShouldEnableCommandingTelemetry)&&((0,u.hX)(e)||(0,o.PA)(o.IY.ShouldEnableCommandingTelemetry)&&e.updateTelemetryCommandingData((i={},(0,r._)(i,a.S9.EventOrder,n),(0,r._)(i,a.S9.CommandName,t),(0,r._)(i,a.S9.Status,a.lK.Initialize),(0,r._)(i,a.S9.IsCommandSuccessString,"false"),(0,r._)(i,a.S9.ErrorCategory,a.by.None),(0,r._)(i,a.S9.ScenarioString,"None"),(0,r._)(i,a.S9.Message,"NA"),i)))}var m=function(e,t,n,r){if((0,o.PA)(o.IY.IsTelemetryEnabledForCommandingFailureCases)){var i=[],u={},d=s.E.getInstance(l.M.getInstance());if(null!=e&&"function"==typeof e[Symbol.iterator]){var h=!0,g=!1,m=void 0;try{for(var y,v=e[Symbol.iterator]();!(h=(y=v.next()).done);h=!0){var S=y.value,C=S.name;i.push(C);var b="";for(var E in S.arguments)(0,c.lu)(E)||(b+=E+",");u[C]=b.slice(0,-1)}}catch(e){g=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(g)throw m}}}else i.push("NoCommand");t?f(d,i,u,0,!1):p(d,i,null!=n?n:a.by.None,u,r)}}},83048:(e,t,n)=>{"use strict";n.d(t,{CC:()=>p,CD:()=>k,CT:()=>r,Dh:()=>o,Ff:()=>I,G8:()=>y,IC:()=>a,IT:()=>T,NW:()=>S,Nr:()=>l,S2:()=>d,S9:()=>f,_5:()=>E,_I:()=>v,_R:()=>A,a5:()=>s,av:()=>b,by:()=>g,f3:()=>_,fj:()=>w,h3:()=>i,lK:()=>h,qN:()=>x,sY:()=>P,tw:()=>m,z_:()=>C});var r,o,i,a,s,l,c=n(57835),u=n(61838);!function(e){e.AddSlideWorkflowResponseTime="AddSlideWorkflowResponseTime",e.AnnotationActivationTime="AnnotationActivationTime",e.AnnotationType="AnnotationType",e.AugloopInitializationTime="AugloopInitializationTime",e.AugloopResponseTime="AugloopResponseTime",e.AugloopSessionGuid="AugloopSessionGuid",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.ChatPPTSessionId="ChatPPTSessionId",e.CheckPoints="CheckPoints",e.ContentOrigin="ContentOrigin",e.ContentProcessingResponseTime="ContentProcessingResponseTime",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.CopilotChatSessionId="CopilotChatSessionId",e.CopilotODSLImageResponseTime="CopilotODSLImageResponseTime",e.CopilotODSLResponseTime="CopilotODSLResponseTime",e.CopilotUserQueryGuid="CopilotUserQueryGuid",e.ContextTreeBuildTime="ContextTreeBuildTime",e.DesignerBootTime="DesignerBootTime",e.ErrorChatEventParameter="ErrorChatEventParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorParameter="ErrorParameter",e.ErrorType="ErrorType",e.FeatureName="FeatureName",e.FirstServiceResponse="FirstServiceResponse",e.HandoffMessageResponseTime="HandoffMessageResponseTime",e.ImageInsertionTime="ImageInsertionTime",e.ImageResponseTime="ImageResponseTime",e.ImageType="ImageType",e.IsDevBuild="IsDevBuild",e.IsFluxEnabled="IsFluxEnabled",e.IsFluxUsed="IsFluxUsed",e.IsFromCache="IsFromCache",e.IsImageInsertionSuccess="IsImageInsertionSuccess",e.IsQuerySuccess="IsQuerySuccess",e.LocalizationStringsLoadTime="LocalizationStringsLoadTime",e.NotificationResponseTime="NotificationResponseTime",e.OrganizePresentationResponseTime="OrganizePresentationResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.PersonalizationResponseTime="PersonalizationResponseTime",e.PresentationRecommendationWorkflowResponseTime="PresentationRecommendationWorkflowResponseTime",e.PresentationTransformerResponseTime="PresentationTransformerResponseTime",e.PPTUserCopilotPaneLoadTime="PPTUserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime_PreloadTime="UserCopilotPaneLoadTime_PreloadTime",e.QueryExecutionTime="QueryExecutionTime",e.QnAChunkInfo="QnAChunkInfo",e.QnAResponseTime="QnAResponseTime",e.RequestSignalType="RequestSignalType",e.SDXResourcesLoadTime="SDXResourcesLoadTime",e.SegmentToSlideResponseTime="SegmentToSlideResponseTime",e.StopGeneratingTime="StopGeneratingTime",e.StoryTellerWorkflowResponseTime="StoryTellerWorkflowResponseTime",e.SubFeatureName="SubFeatureName",e.SummaryChunkInfo="SummaryChunkInfo",e.SummaryResponseTime="SummaryResponseTime",e.SpeakerNotesResponseTime="SpeakerNotesResponseTime",e.SpeakerNotesAnalyzingVisualsResponseTime="SpeakerNotesAnalyzingVisualsResponseTime",e.SydneyChunkInfoJson="SydneyChunkInfoJson",e.SydneyResponseTime="SydneyResponseTime",e.UserIdentityTypeResponseTime="UserIdentityTypeResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.UserProfileResponseTime="UserProfileResponseTime",e.UserQueryGuid="UserQueryGuid",e.VisualSummaryResponseTime="VisualSummaryResponseTime",e.WarningMessageUserInteractionTime="WarningMessageUserInteractionTime",e.WordCountResponseTime="WordCountResponseTime",e.UniqueActionId="UniqueActionId",e.FirstNotificationReceivedTime="FirstNotificationReceivedTime",e.LastNotificationReceivedTime="LastNotificationReceivedTime",e.SharedHeaderLoadTimeInMs="SharedHeaderLoadTimeInMs",e.StaticSharedHeaderLoadTimeInMs="StaticSharedHeaderLoadTimeInMs",e.ExtensibilityInfo="ExtensibilityInfo",e.ValidateSlidesJOfcTime="ValidateSlidesJOfcTime",e.InteractiveSummaryLevelStreamingTimeInMs="InteractiveSummaryLevelStreamingTimeInMs",e.InteractiveSummaryLevel="InteractiveSummaryLevel"}(r||(r={})),function(e){e.UserQueryGuid="UserQueryGuid",e.ChatPPTSessionId="ChatPPTSessionId",e.EventState="EventState",e.OperationOrder="OperationOrder",e.OperationType="OperationType",e.TimeDurationInMs="TimeDurationInMs",e.OperationParameters="OperationParameters",e.UserQueryOrder="UserQueryOrder",e.OfficeJSApi="OfficeJsAPI",e.ReturnedItems="ReturnedItems",e.SlideHints="SlideHints"}(o||(o={})),function(e){e.IsDevBuild="IsDevBuild",e.UserQueryGuid="UserQueryGuid",e.ChatPPTSessionId="ChatPPTSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorParameters="ChatErrorParameters",e.IsFromCache="IsFromCache",e.IsVisual="IsVisual",e.SlideCountRange="SlideCountRange",e.UsedVDPercentage="UsedVDPercentage",e.IsWarmUpSignal="IsWarmUpSignal",e.RequestSignalSource="RequestSignalSource",e.IsAnalyzingVisual="IsAnalyzingVisual",e.CopilotChatSessionId="CopilotChatSessionId",e.Cv="Cv",e.NotificationType="NotificationType",e.NotificationState="NotificationState",e.ImageType="ImageType",e.UniqueActionId="UniqueActionId",e.ExtensibilityInfo="ExtensibilityInfo"}(i||(i={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.UniqueActionId="UniqueActionId",e.ExtensibilityInfo="ExtensibilityInfo"}(a||(a={})),function(e){e.DesignerLinkClicked="Designer_Link_Clicked",e.FailureType2Message="Failure_Type_2_Message",e.FailureType3Message="Failure_Type_3_Message",e.FailureType4Message="Failure_Type_4_Message",e.FailureType5Message="Failure_Type_5_Message",e.FailureType6Message="Failure_Type_6_Message",e.FailureType7Message="Failure_Type_7_Message",e.LongMessageLength="Long_Message_Length",e.JunkPhraseDetected="Junk_Phrase_Detected",e.LicensingError="Licensing_Error",e.ContextTreeBuildError="Context_Tree_Build_Error",e.SlideFetchError="Slide_Fetch_Error",e.SelectedSlideFetchError="Selected_Slide_Fetch_Error",e.ContextTreeBuildCompleted="Context_Tree_Build_Completed",e.ContextTreeBuildSkipped="Context_Tree_Build_Skipped",e.ContextTreeBuildTimeout="Context_Tree_Build_Timeout",e.FinalMessageTextNotFound="Final_MessageText_Not_Found",e.PPTCopilotIntentDetected="PPT_Copilot_Intent_Detected",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.OrganizePresentationOperationSubmitted="Organize_Presentation_Operation_Submitted",e.PresentationTransformerOperationSubmitted="Presentation_Transformer_Operation_Submitted",e.AugloopResponseFailure="Augloop_Response_Failure",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.FirstResponseReceivedFromAL="First_Response_Received_From_Augloop",e.FirstChunkReceivedFromSydney="First_Chunk_Received_From_Sydney",e.SummaryIntentDetectedFromAL="Summary_Intent_Detected_From_Augloop",e.SpeakerNotesResponseDetectedFromAL="Speaker_Notes_Response_Detected_From_Augloop",e.SpeakerNotesSuccessResponseDetectedFromAL="Speaker_Notes_Success_Response_Detected_From_Augloop",e.SpeakerNotesErrorDetectedFromAL="Speaker_Notes_Error_Detected_From_Augloop",e.SpeakerNotesQuerySuccess="Speaker_Notes_Query_Success",e.SpeakerNotesQueryFailure="Speaker_Notes_Query_Failure",e.SpeakerNotesAnalyzingVisualsResponse="Speaker_Notes_Analyzing_Visuals_Response",e.SpeakerNotesIgnoreExtraResponse="Speaker_Notes_Ignore_Extra_Response",e.JOfcSlidesNotInPresentation="JOfc_Slides_Not_In_Presentation",e.QueryExecutionFailed="Query_Execution_Failed",e.QueryExecutionBlocked="Query_Execution_Blocked",e.QueryExecutionPausedOnWarning="Query_Execution_Paused_On_Warning",e.QueryExecutionSuccessful="Query_Execution_Successful",e.QueryExecutionPartiallySuccessful="Query_Execution_Partial_Success_Failure",e.QueryExecutionNotSupported="Query_Execution_Not_Supported_Failure",e.QueryExecutionAbortedForMultiGenerateSlides="Query_Execution_Aborted_For_Multi_Generate_Slides_Failure",e.QueryExecutionAbortedByUser="Query_Execution_Aborted_By_User_Failure",e.QueryExecutionUnexpectedVersionError="Query_Execution_Unexpected_Version_Failure",e.ContentGenerationDisabledByAdmin="Content_Generation_Disabled_By_Admin_Failure",e.StorytellerQuerySent="Storyteller_Query_Sent",e.StorytellerQuerySuccess="Storyteller_Query_Success",e.StorytellerQueryFailure="Storyteller_Query_Failure",e.StorytellerInsertSlideCompleted="Storyteller_Insert_Slide_Completed",e.StorytellerInitialSlideCount="Storyteller_Initial_Slide_Count",e.StorytellerUpdatedSlideCount="Storyteller_Updated_Slide_Count",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.SummarizationOperationSubmitted="Summarization_Operation_Submitted",e.SummarizationOperationForInsightCardSubmitted="Summarization_Operation_Insight_Card_Submitted",e.SummaryResponseShown="Summary_Response_Shown",e.CallsToActionResponseShown="Calls_To_Action_Response_Shown",e.ImportantSlidesResponseShown="Important_Slides_Response_Shown",e.LessWordCount="Less_Word_Count",e.MoreWordCount="More_Word_Count",e.SummaryStreamingResponseTimeout="Summary_Streaming_Response_Timeout",e.WordCountOperationSubmitted="Word_Count_Operation_Submitted",e.UserTypeOperationSubmitted="User_Type_Operation_Submitted",e.InternetReconnected="Internet_Reconnected",e.ThumbsUpButtonClicked="Thumbs_Up_Button_Clicked",e.ThumbsDownButtonClicked="Thumbs_Down_Button_Clicked",e.SegmentToSlideOperationSubmitted="Segment_To_Slide_Operation_Submitted",e.ContentProcessingOperationSubmitted="Content_Processing_Operation_Submitted",e.ContentValidatorOperationSubmitted="Content_Validator_Operation_Submitted",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.PPTCopilotOperationSubmitted="PPT_Copilot_Operation_Submitted",e.PPTCopilotFluxOperationSubmitted="PPT_Copilot_Flux_Operation_Submitted",e.PPTCopilotSketchOperationSubmitted="PPT_Copilot_Sketch_Operation_Submitted",e.PPTCopilotSketchOperationCompleted="PPT_Copilot_Sketch_Operation_Completed",e.PPTCopilotSketchInsertImageCompleted="PPT_Copilot_Sketch_Insert_Image_Completed",e.ChatIntentDetected="Chat_Intent_Detected",e.FluxChatIntentDetected="Flux_Chat_Intent_Detected",e.UnsupportedActionDetected="Unsupported_Action_Detected",e.StoryTellerOperationSubmitted="StoryTeller_Operation_Submitted",e.AddSlideOperationSubmitted="AddSlide_Operation_Submitted",e.CopilotChatHistoryOperationSubmitted="Copilot_Chat_History_Operation_Submitted",e.CopyButtonClicked="Copy_Button_Clicked",e.DocumentUrlEmptyError="Document_Url_Empty_Error",e.DocumentUrlInvalidError="Document_Url_Invalid_Error",e.CIQLinkUsed="CIQ_Link_Used",e.MessageHasLocalFileLink="Message_Has_Local_File_Link",e.PrimaryUserType="Primary_User_Type",e.ContentValidatorURLValidationFailed="Content_Validator_URL_Validation_Failed",e.CommandingSourceAndPromptInGenerates="Commanding_Source_And_Prompt_In_Generates",e.PlayKeySlidesButtonAdded="Play_Key_Slides_Button_Added",e.PlayKeySlidesButtonClicked="Play_Key_Slides_Button_Clicked",e.ClickableKeySlidesEnabled="Clickable_Key_Slides_Enabled",e.ClickableKeySlidesClicked="Clickable_Key_Slides_Clicked",e.JOFCCommandExecuted="JOFC_Command_Executed",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.AppExecutionStart="App_Execution_Start",e.StringLocalizationStart="String_Localization_Start",e.CIQLoadStart="CIQ_Load_Start",e.CIQLoadEnd="CIQ_Load_End",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ChatHistoryTimedOut="Chat_History_Timeout",e.AugloopReconnected="Augloop_Reconnected",e.AugloopDisconnected="Augloop_Disconnected",e.AugloopServerAuthStateChanged="Augloop_Server_Auth_State_Changed",e.InvalidContextIdResponse="Invalid_Context_Id_Response",e.StopGeneratingButtonClicked="Stop_Generating_Button_Clicked",e.QueryEndOnGptSwitch="Query_End_On_Gpt_Switch",e.ContextIDListEmptied="Context_ID_List_Emptied",e.IsContextIDValid="Is_Context_ID_Valid",e.StopGeneratingSignalSentToAL="Stop_Generating_Signal_Sent_To_AL",e.ODSLResponseReceivedFromSydney="ODSL_Response_Received_From_Sydney",e.SummaryResponseReceivedFromSydney="Summary_Response_Received_From_Sydney",e.SummaryResponseReceivedFromSkill="Summary_Response_Received_From_Skill",e.QnAResponseReceivedFromSydney="QnA_Response_Received_From_Sydney",e.FinalValidMessageReceivedFromSydney="Final_Valid_Message_Received_From_Sydney",e.VideoGenerationNotSupportedMessageEnforced="Video_Generation_Not_Supported_Message_Enforced",e.LastChatMessageUserType="Last_Chat_Message_User_Type",e.EmptyMessageReceivedFromSydney="Empty_Message_Received_From_Sydney",e.EmptyMessageReceivedFromSummarySkill="Empty_Message_Received_From_SummarySkill",e.DesignerGraphicsResponseReceivedFromSydney="Designer_Graphics_Response_Received_From_Sydney",e.ODSLExecutionTimeout="ODSL_Execution_Timeout",e.RaiErrorMessage="Rai_Error_Message",e.ErrorResponseSignalSent="Error_Response_Signal_Sent",e.NoChatResponseRenderedFromSydney="No_Chat_Response_Rendered_From_Sydney",e.ContentOriginUnhandled="Content_Origin_Unhandled_Treated_As_Error",e.ContentOriginUnknown="Content_Origin_Unknown",e.UnexpectedErrorObjectReceived="Unexpected_Error_Obj_Received",e.GroundingSourceUpdated="Grounding_Source_Updated",e.CopilotConfig="Copilot_Config",e.DesignerImageInsertStart="Designer_Image_Insert_Start",e.DesignerImageInsertEnd="Designer_Image_Insert_End",e.DesignerImageInsertError="Designer_Image_Insert_Error",e.DesignerResponseShown="Designer_Shown",e.DesignerResponseShownForDCs="Designer_Shown_For_DCs",e.EmptyDesignerResponse="Empty_Designer_Response",e.DesignerDuplicateResponse="Designer_Duplicate_Response",e.DesignerAuthTokenFetchStart="Designer_Auth_Token_Fetch_Start",e.DesignerAuthTokenFetchRetry="Designer_Auth_Token_Fetch_Retry",e.DesignerAuthTokenFetchEnd="Designer_Auth_Token_Fetch_End",e.DesignerBase64ImagesReceived="Designer_Base64_Images_Received",e.DesignerSkillResponseParseError="Designer_Skill_Response_Parse_Error",e.DesignerMiniEvent="Designer_Mini_Event",e.DesignerMiniUnclassifiedError="Designer_Mini_Unclassified_Error",e.DesignerMiniRAIBlocklistError="Designer_Mini_RAI_Blocklist_Error",e.DesignerMiniAuthError="Designer_Mini_Auth_Error",e.DesignerMiniServiceBlockError="Designer_Mini_Service_Block_Error",e.DesignerDiscountedError="Designer_Discounted_Error",e.DesignerSkillError="Designer_Skill_Error",e.ImagePickerClicked="ImagePicker_Clicked",e.ImagePickerShown="ImagePicker_Shown",e.DocumentStateReceived="Document_State_Received",e.TriggerSummaryCalled="Trigger_Summary_Called",e.TriggerCreatePresentationAboutCalled="Trigger_CreatePresentationAbout_Called",e.TriggerCreatePresentationViaNBCalled="Trigger_CreatePresentationViaNB_Called",e.TriggerCreatePresentationFromFileCalled="Trigger_CreatePresentationFromFile_Called",e.TriggerAddASlideCalled="Trigger_AddASlide_Called",e.TriggerCreatePresentationAboutCalledViaInAppHandOffMessage="Trigger_CreatePresentationAbout_Called_ViaInAppHandOffMessage",e.TriggerCreatePresentationFromFileCalledViaInAppHandOffMessage="Trigger_CreatePresentationFromFile_Called_ViaInAppHandOffMessage",e.TriggerSummaryCalledViaInAppHandOffMessage="Trigger_Summary_Called_ViaInAppHandOffMessage",e.TriggerAskCopilotCalledViaInAppHandOffMessage="Trigger_AskCopilot_Called_ViaInAppHandOffMessage",e.TriggerShowKeySlidesCalledViaInAppHandOffMessage="Trigger_ShowKeySlides_Called_ViaInAppHandOffMessage",e.TriggerTellMeQueryViaInAppHandOffMessage="Trigger_TellMeQuery_ViaInAppHandOffMessage",e.TellMeQueryHandOffError="TellMeQuery_HandOff_Error",e.StoryTellerResponseInChat="StoryTeller_Response_In_Chat",e.InternetDisconnected="Internet_Disconnected",e.LearnMoreOptionClicked="Learn_More_Option_Clicked",e.PretriggerContentProcessing="Pretrigger_Content_Processing",e.ContentProcessingProgress="Content_Processing_Progress",e.SegmentToSlideProgress="Segment_To_Slide_Progress",e.ImageOutOfScopeError="Image_Out_Of_Scope_Error",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.IsVoiceCopilotFGEnabled="Is_VoiceCopilot_FG_Enabled",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.WarningMessageCardShown="Warning_Message_Shown",e.OrganizePresentationButtonClicked="Organize_Presentation_Button_Clicked",e.CancelButtonClicked="Cancel_Button_Clicked",e.CreatePresentationButtonClicked="Create_Presentation_Button_Clicked",e.CreatePresentationWarningType="Create_Presentation_Warning_Type",e.QuerySuccessful="Query_Successful",e.TransformFileUsedWithCLP="TransformFile_Used_With_CLP",e.IsDocumentProtected="Is_Document_Protected",e.TransformFileUsedWithCLPForOutline="TransformFile_Used_With_CLP_For_Outline",e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.CLPUpgradeLabelStart="CLP_Upgrade_Label_Start",e.CLPUpgradeLabelAborted="CLP_Upgrade_Label_Aborted",e.CLPUpgradeLabelStatus="CLP_Upgrade_Label_Status",e.CLPEmptySourceLabel="CLP_Empty_Source_Label",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.ConversationSensitivityLabelNotFound="Conversation_Sensitivity_Not_Found",e.HandoffMessageIdGetOperationSubmitted="Handoff_Message_Id_Get_Operation_Submitted",e.HandoffMessageIdProcessedOperationSubmitted="Handoff_Message_Id_Processed_Operation_Submitted",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffQuerySubmittedByUser="Handoff_Query_Submitted_By_User",e.SelfHelpContentShown="SelfHelp_Content_Shown",e.SelfHelpActionClicked="SelfHelp_Action_Clicked",e.ZQMV2Loaded="ZQMV2_Loaded",e.ZQMV2CardClicked="ZQMV2_Card_Clicked",e.CommandingErrorCardLoaded="Commanding_Error_Card_Loaded",e.CommandingErrorCardClicked="Commanding_Error_Card_Clicked",e.PresentationRecommendationOperationSubmitted="PresentationRecommendationOperationSubmitted",e.PresentationRecommendationThumbnailNotReceived="PresentationRecommendationThumbnailNotReceived",e.AddEnterpriseImageClicked="Add_Enterprise_Image_Clicked",e.PptCopilotEditScn="PptCopilotEditScn",e.AddSlideJOfcCommandsError="AddSlide_JOfc_Commands_Error",e.SegmentToSlideJOfcCommandsError="Segment_To_Slide_JOfc_Commands_Error",e.CopilotODSLJOfcCommandsError="Copilot_ODSL_JOfc_Commands_Error",e.OrganizePresentationJOfcCommandsError="Organize_Presentation_JOfc_Commands_Error",e.PresentationRecommendationJOfcCommandsError="Presentation_Recommendation_JOfc_Commands_Error",e.StoryTellerJOfcCommandsError="StoryTeller_JOfc_Commands_Error",e.ImagePickerJOfcCommandsError="ImagePicker_JOfc_Commands_Error",e.DesignerImageInsertJOfcCommandsError="Designer_Image_Insert_JOfc_Commands_Error",e.SpeakerNotesJOfcCommandsError="Speaker_Notes_JOfc_Commands_Error",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.MultipleFileSourcesDetected="Multiple_File_Sources_Detected",e.RetryingContentProcessingAnnotationCall="Retrying_Content_Processing_Annotation_Call",e.NotificationCardUpdated="Notification_Card_Updated",e.NotificationError="Notification_Error",e.StaleNotificationReceived="Stale_Notification_Received",e.CheckNotification="Check_Notification",e.VisualSummaryShownAfterNotification="Visual_Summary_Shown_After_Notification",e.SetNotificationTimer="Set_Notification_Timer",e.ClearNotificationTimer="Clear_Notification_Timer",e.CshCopilotLinkClicked="Help_CSH_Copilot_Link_Clicked",e.TaskModuleLaunched="Task_Module_Launched",e.TaskModuleClosed="Task_Module_Closed",e.MsgExtDataReceived="MsgExt_Data_Received",e.EnabledPlugins="Enabled_Plugins",e.GptIdForBranding="Gpt_Id_For_Branding",e.ExtensibilityConfig="Extensibility_Config",e.InterstitialMessageShown="Interstitial_Message_Shown",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.OfficeAddinCalledTime="OfficeAddinCalledTime",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.PreloadCopilot="PreloadCopilot",e.TranslatePresentationButtonClicked="Translate_Presentation_Button_Clicked",e.TranslatedPresentationURLClicked="Translated_Presentation_URL_Clicked",e.TranslatePresentationIntentDetectedFromAL="Translate_Presentation_Intent_Detected_From_Augloop",e.PassingCopilotTranslatedPPTInfoViaInAppHandOffMessageError="Passing_CopilotTranslatedPPTInfo_ViaInAppHandOffMessage_Error",e.TriggerPptAddVisualOperation="Trigger_Ppt_Add_Visual_Operation",e.TriggerPptUpdateVisualOperation="Trigger_Ppt_Update_Visual_Operation",e.TriggerPptDeleteVisualOperation="Trigger_Ppt_Delete_Visual_Operation",e.TriggerImageChatOperation="Trigger_Image_Chat_Operation",e.GetSignalOperationCalled="Get_Signal_Operation_Called",e.ExperimentFlights="Experiment_Flights",e.InteractiveSummaryToggle="Interactive_Summary_Toggle",e.InteractiveSummaryLevelReceivedTimeInMs="Interactive_Summary_Level_Received_Time_In_Ms"}(s||(s={})),function(e){e.ErrorRequestTimedOut="ErrorRequestTimedOut",e.DeckTooLargeToSummarizeError="DeckTooLargeToSummarizeError",e.SummaryNoActionItemsIdentified="SummaryNoActionItemsIdentified",e.ServerErrorMessage="ServerErrorMessage",e.StorytellerFailureMessage="StorytellerFailureMessage",e.AddSlideFailureMessage="AddSlideFailureMessage",e.ActionOnlySupportedInRibbonMessage="ActionOnlySupportedInRibbonMessage",e.ImageOutOfScopeIntentError="ImageOutOfScopeIntentError",e.CommandNotSupportedMessage="CommandNotSupportedMessage",e.StopGeneratingResponseMessage="StopGeneratingResponseMessage",e.UserCancelledExecutionMessage="UserCancelledExecutionMessage",e.AssistantCreatePresentationResponseHeaderMessage="AssistantCreatePresentationResponseHeaderMessage",e.DesignerDisabledErrorMessage="DesignerDisabledErrorMessage",e.ErrorPresentationAlreadyStructured="ErrorPresentationAlreadyStructured",e.ErrorSlideAlreadyAnimated="ErrorSlideAlreadyAnimated",e.CLPUnableToApplySensitivityLabel="CLPUnableToApplySensitivityLabel",e.ErrorGenericFallback="ErrorGenericFallback",e.UnexpectedVersionErrorMessage="UnexpectedVersionErrorMessage",e.DisabledFeatureErrorMessagePrefix="DisabledFeatureErrorMessagePrefix",e.PartialSuccessErrorMessage="PartialSuccessErrorMessage",e.LessContentToSummarizeError="LessContentToSummarizeError",e.OffensiveContentToSummarizeError="OffensiveContentToSummarizeError",e.LicenseValidationErrorMessage="LicenseValidationErrorMessage",e.DocumentPasswordProtectedOrEncrypted="DocumentPasswordProtectedOrEncrypted",e.DocumentTooLargeToDownloadError="DocumentTooLargeToDownloadError",e.DocumentNotFoundToTransformError="DocumentNotFoundToTransformError",e.DocumentTooShortToTransformError="DocumentTooShortToTransformError",e.DocumentDownloadFailedError="DocumentDownloadFailedError",e.CLPNoAccessPermission="CLPNoAccessPermission",e.ErrorConsumerQueryTranformFile="ErrorConsumerQueryTranformFile",e.CLPGeneralSensitivityLabelError="CLPGeneralSensitivityLabelError",e.RMSDisabled="RMSDisabled",e.DocumentAccessPermissionError="DocumentAccessPermissionError",e.ErrorServerBusy="ErrorServerBusy",e.ThrottlingErrorMessage="ThrottlingErrorMessage",e.ErrorDetectedOtherLanguage="ErrorDetectedOtherLanguage",e.ErrorOffensiveContentBlocked="ErrorOffensiveContentBlocked",e.ErrorQueryTooLarge="ErrorQueryTooLarge",e.ErrorQueryTooSmall="ErrorQueryTooSmall",e.DKEAndNotExtractLabelErrorString="DKEAndNotExtractLabelErrorString",e.CopilotUnsupportedlanguageMessage="CopilotUnsupportedlanguageMessage",e.CopilotUnsupportedLanguageError="CopilotUnsupportedLanguageError",e.DisengagedError="DisengagedError",e.OrganizePresentationRAIError="OrganizePresentationRAIError",e.OrganizePresentationTooLargeFile="OrganizePresentationTooLargeFile",e.OrganizePresentationInsufficientSlideContent="OrganizePresentationInsufficientSlideContent",e.OrganizePresentationInvalidLanguaguage="OrganizePresentationInvalidLanguaguage",e.OrganizePresentationUnsupportedLanguage="OrganizePresentationUnsupportedLanguage",e.OrganizePresentationServiceUnavailable="OrganizePresentationServiceUnavailable",e.TransformFileGeneralError="TransformFileGeneralError",e.StorytellerRaiBlockedMessage="StorytellerRaiBlockedMessage",e.StorytellerNoTopicSpecifiedMessage="StorytellerNoTopicSpecifiedMessage",e.StorytellerInvalidSlidesTopicMessage="StorytellerInvalidSlidesTopicMessage",e.StorytellerInvalidPresentationTopicMessage="StorytellerInvalidPresentationTopicMessage",e.StorytellerErrorMessage="StorytellerErrorMessage",e.EmptySummaryResponseMessage="EmptySummaryResponseMessage",e.NoActionItemsFoundMessage="NoActionItemsFoundMessage",e.EmptyKeySlidesResponseMessage="EmptyKeySlidesResponseMessage",e.TransformFileCLPProtectedErrorMessage="TransformFileCLPProtectedErrorMessage",e.TransformFileCLPSensitivityLabelErrorMessage="TransformFileCLPSensitivityLabelErrorMessage",e.CLPNoUserPermissionForSensitivityLabel="CLPNoUserPermissionForSensitivityLabel",e.UnsupportedExcelFileError="UnsupportedExcelFileError",e.UnsupportedPptFileError="UnsupportedPptFileError",e.UnsupportedPdfFileError="UnsupportedPdfFileError",e.UnsupportedWordFileError="UnsupportedWordFileError",e.UnsupportedFileError="UnsupportedFileError",e.DocumentUrlInvalidError="DocumentUrlInvalidError",e.DocumentUrlEmptyError="DocumentUrlEmptyError",e.UnsupportedSummaryError="UnsupportedSummaryError",e.DocumentUrlNotFromSharePoint="DocumentUrlNotFromSharePoint",e.ErrorInExecution="ErrorInExecution",e.ErrorNotEnoughContent="ErrorNotEnoughContent",e.HandoffMessageIdResponseError="Handoff_MessageIdResponse_Error",e.HandoffMessageFromHostAppSettingsError="HandoffMessageFromHostAppSettingsError",e.DesignerMiniError="DesignerMiniError",e.DesignerVisualsEmptyResponse="DesignerVisualsEmptyResponse",e.DesignerVisualsSkillResponseParseError="DesignerVisualsSkillResponseParseError",e.DesignerVisualsInsertError="DesignerVisualsInsertError",e.DesignerVisualsInsertJOfcCommandsError="DesignerVisualsInsertJOfcCommandsError",e.DesignerVisualsText2ImageError="DesignerVisualsText2ImageError",e.DesignerVisualsLLMError="DesignerVisualsLLMError",e.DesignerVisualsUnsupportedImageTypeError="DesignerVisualsUnsupportedImageTypeError",e.DesignerVisualsStockRAIError="DesignerVisualsStockRAIError",e.DesignerVisualsUnknownError="DesignerVisualsUnknownError",e.OutOfCreditsError="OutOfCreditsError",e.LessContentForSpeakerNotesError="LessContentForSpeakerNotesError",e.TooManySlidesSpeakerNotesError="TooManySlidesSpeakerNotesError",e.RAIBlockedSpeakerNotesError="RAIBlockedSpeakerNotesError"}(l||(l={}));var d,p,f,h,g,m=(0,u._)((0,c._)({},s,r,a),{UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"});!function(e){e.Augloop="Augloop",e.ContextIQ="ContextIQ",e.WordCount="WordCount",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.StoryTeller="StoryTeller",e.StoryTellerWorkflow="StoryTellerWorkflow",e.QueryDetails="QueryDetails",e.OfficeJsApi="OfficeJsApi",e.Summary="Summary",e.SpeakerNotes="SpeakerNotes",e.SearchQuery="SearchQuery",e.SharedAugloop="SharedAugloop",e.SegmentToSlide="SegmentToSlide",e.OrganizePresentation="OrganizePresentation",e.PresentationTransformer="PresentationTransformer",e.CopilotODSL="CopilotODSL",e.BasicChat="BasicChat",e.ChatHistory="ChatHistory",e.FluxCopilot="FluxCopilot",e.Microphone="Microphone",e.Chat="Chat",e.Commanding="Commanding",e.ImagePicker="ImagePicker",e.PresentationRecommendation="PresentationRecommendation",e.Designer="Designer",e.CLP="CLP",e.SketchToImage="SketchToImage",e.Notification="Notification",e.PlayKeySlides="PlayKeySlides",e.ClickableKeySlides="ClickableKeySlides",e.LaunchNarrativeBuilder="LaunchNarrativeBuilder",e.TranslatePresentation="TranslatePresentation",e.PptVisual="PptVisual",e.AddSlideWorkflow="AddSlideWorkflow",e.ImageChat="ImageChat"}(d||(d={})),function(e){e.ChatPaneLoad="ChatPaneLoad",e.Preload_ChatPaneLoad="Preload_ChatPaneLoad",e.CopilotChat="CopilotChat",e.Summary="Summary",e.SpeakerNotes="SpeakerNotes",e.BasicChat="BasicChat",e.Commanding="Commanding",e.Sydney="Sydney",e.CreatePresentation="CreatePresentation",e.CreatePresentationFromDoc="CreatePresentationFromDoc",e.AddSlide="AddSlide",e.InsertImage="InsertImage",e.Organize="Organize",e.Beautify="Beautify",e.Animate="Animate",e.AddText="AddText",e.Handoff="Handoff",e.PresentationRecommendation="PresentationRecommendation",e.Customize="Customize",e.Notification="Notification",e.DesignerVisuals="Designer Visuals",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.ConversationalCopilot="ConversationalCopilot"}(p||(p={})),function(e){e.CommandName="CommandName",e.IsCommandSuccessString="IsCommandSuccessString",e.UserQueryGuid="UserQueryGuid",e.HostSDXSessionID="HostSDXSessionID",e.Status="Status",e.EventOrder="EventOrder",e.ErrorCategory="ErrorCategory",e.ScenarioString="ScenarioString",e.IsLastStatement="IsLastStatement",e.Message="Message",e.TranspilationLatencyMSec="TranspilationLatencyMSec"}(f||(f={})),function(e){e.Initialize="Initialize",e.Executed="Executed"}(h||(h={})),function(e){e.Unsupported="Unsupported",e.Blocked="Blocked",e.Failed="Failed",e.ContentGenerationDisabled="ContentGenerationDisabled",e.UserAborted="UserAborted",e.PartialSuccess="PartialSuccess",e.DismissedCommand="DismissedCommand",e.None="None"}(g||(g={}));var y,v,S,C,b,E,T,w="No response as service timed out";!function(e){e.SummarizeNotPerformed="CopilotDidNotPerformSummarize",e.CommandNotExecuted="CopilotCommandDidNotExecute",e.UnableToCompleteTask="Unable to Complete Task",e.CommandNotGeneratedForOrganize="CopilotDidNotGenerateCommandDuringOrganize",e.ContentGeneration="Error encountered using CopilotChat under Content Generation capability",e.SummarizeTimedOut="Summarize Summarize Response Delayed or Timed Out",e.SummarizeUnsupportedFunctionality="Summarize Summarize Unsupported Copilot Functionality",e.SummarizeUnableToComplete="Summarize Summarize Unable to Complete Task",e.SummarizeLLMServiceSideIssue="Summarize Summarize LLM Service Side Issue Prevents Output",e.SummarizeUserAccessIssue="Summarize Summarize User Access Issue for Copilot",e.UnclassifiedAshaError="Unclassified ASHA Error",e.SummarizeCapacityIssue="Summarize Summarize Unable to Generate Response Due to Capacity Issue",e.SummarizeBlockedResponse="Summarize Summarize Responsible AI Filter Blocked Response",e.SummarizeMissingFunctionality="Summarize Summarize Missing Copilot Functionality",e.UserCancelledResponse="User Rejected or Cancelled Response",e.ResponseDelayedOrTimedOut="Response Delayed or Timed Out",e.CommandCapacityIssue="Command Basic Command Unable to Generate Response Due to Capacity Issue",e.CommandInputCouldNotBeProcessed="Command Basic Command User Input Could Not Be Processed",e.CommandFileReferencingFailed="Command Basic Command Referencing a File Failed",e.CommandBlockedResponse="Command Basic Command Responsible AI Filter Blocked Response",e.CommandUnableToCompleteTask="Command Basic Command Unable to Complete Task",e.RAIError="Responsible AI Filter Blocked Response",e.SummarizeRAIError="Summarize Summarize Responsible AI Filter Blocked Response",e.ServiceSideIssuePreventsOutput="LLM Service Side Issue Prevents Output",e.UserInputCouldNotBeProcessed="User Input Could Not Be Processed",e.Unset="",e.UnsupportedCopilotFunctionality="Unsupported Copilot Functionality",e.UserAccessIssueForCopilot="User Access Issue for Copilot",e.UnableToGenerateResponseDueToCapacityIssue="Unable to Generate Response Due to Capacity Issue",e.Text2ImageError="Text2Image Error",e.DesignerMiniError="Designer Mini Error Prevents Output"}(y||(y={})),function(e){e.Fallback="Error occurred because of an unclassifed issue",e.Timeout="Timeout waiting for server",e.LessContent="Error occurred because document length is too short",e.InvalidInput="Error occurred because the deck is blank",e.OffensiveContent="Error occurred because of offensive content",e.NoActionItems="Error occurred because no action items can be found on this deck",e.NoImportantSlides="Error occurred because no important slides can be found on this deck",e.NoSummaryPoints="Error occurred because no summary points can be found on this deck",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.InvalidLanguage="Error occurred because language is not supported",e.InvalidInputLanguage="Input language is not supported",e.InvalidOutputLanguage="Output language is not supported",e.FailedToGetInputLanguage="Failed to get input language",e.LicensingOld="Error occurred because copilot license couldn't be validated",e.TooShort="Error occurred because content is too short",e.MissingPPTContent="Error occurred because content is missing",e.BadResponse="Error occurred because of bad response",e.BadRequest="Error occurred because of bad request",e.Token="Error occurred because of token",e.Unknown="Error is unknown",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.PromptInjection="Error occurred because prompt injection is detected",e.InvalidSignal="Error occurred because signal is invalid.",e.MissingSignal="Error occurred because signal is missing in workflow",e.InvalidIntent="Error occurred because intent is invalid/missing",e.InvalidSubIntent="Error occurred because sub-intent is invalid",e.MissingSubIntent="Error occurred because sub-intent is missing",e.APIUnavailable="Error occurred because API is not available",e.RAIOnInputError="Error occurred while checking RAI on input query",e.RAIOnOutputError="Error occurred while checking RAI on generated answer",e.OutputBlockedByFilters="Error occurred because output is blocked by filters",e.OffensiveOutputBlockedByContentModerator="Output blocked by content moderator for being offensive",e.VisualDescriptionGenerationUnknownError="Unknown error occurred while generating visual descriptions.",e.VisualDescriptionGenerationError="Error occurred while generating visual descriptions.",e.Licensing="AugLoop failed to validate the user's Copilot entitlement",e.InvalidTokens="AugLoop failed to validate the Copilot user token"}(v||(v={})),function(e){e.OffensiveContent="Command didn't execute because of offensive content",e.Fallback="Command didn't execute due to service side error",e.InvalidInput="Command didn't execute because input query is invalid",e.Licensing="Command didn't execute because copilot license couldn't be validated",e.IncorrectODSLVersion="Command didn't execute because ODSL version is not supported",e.UnexpectedVersion="Command didn't execute because Host version is not supported",e.InvalidLanguage="Command didn't execute because language is not supported",e.ServiceBusy="Command didn't execute because service is busy",e.Throttled="Command didn't execute because number of requests per hour limit exceeded",e.Disengaged="Command didn't execute because of harmful user query",e.UserThrottled="Command didn't execute because user has issued too many requests",e.ScenarioThrottled="Command didn't execute because scenario has issued too many requests",e.TooLong="Command didn't execute because input is too long",e.DocumentPermission="Command didn't execute because of document permission error",e.InputQuery="Command didn't execute because input query is offensive",e.GeneratedOutput="Command didn't execute because generated output is offensive",e.OutOfCredits="Command didn't execute because user is out of credits"}(S||(S={})),function(e){e.InternetDisconnected="Error occurred because internet was disconnected",e.UserAbortedQueryExecution="User aborted query execution",e.RAI="Error occurred because of offensive content",e.NoResponseFromSydney="Error occurred because no chat response/error rendered by sydney",e.UnknownError="Error occurred because of an unclassifed issue",e.GptSwitchAbortedQueryExecution="Gpt switch aborted query execution"}(C||(C={})),function(e){e.DocumentUrlInvalidError="Document URL is invalid",e.DocumentUrlEmptyError="Document URL is empty",e.BadResponse="Error occurred because of bad response",e.InvalidTokensOld="Input query contains invalid tokens",e.ODSLArgumentTypeMismatch="ODSL argument value does not match the type",e.SydneyConnectionCancelled="Connection to Sydney is cancelled",e.DisambiguationRequired="Disambiguation is required",e.SydneyDisengagement="Sydney disengagement error",e.ODSLBadArgumentValue="ODSL required argument has a bad value",e.DocumentProcessingDenied="Processing the document associated with the query is denied",e.ODSLMissingRequiredArgument="ODSL for slide generation failed because it's missing a required argument",e.EmptyGeneratedResponse="Error occurred because generated response is empty",e.ExcessTokensRequest="Excess tokens in the request",e.ExcessTokensResponse="Excess tokens in the response",e.VisualDescriptionsGenerationError="Error occurred while generating visual descriptions.",e.FailedToGetInputLanguage="Failed to get input language",e.Fallback="Failed due to service side error",e.OffensiveGeneratedOutput="Offensive content detected in generated output",e.OffensiveGeneratedSydneyOutput="Offensive content detected in generated Sydney output",e.OperationNotPerformable="Error occurred because copilot cannot perform the operation",e.LLMImageDetailsGenerationFailed="LLM call failed when generating image details for slide JSON.",e.LLMSlideJSONGenerationFailed="LLM call failed to generate slide JSON",e.OffensiveInputContent="Offensive content detected in input content",e.OffensiveInputQuery="Offensive content detected in input query",e.RAIInputQueryCheckError="Error occurred while checking RAI on input query",e.InvalidInputQuery="Input query is invalid",e.InvalidSubIntent="Error occurred because sub-intent is invalid",e.UnparsableODSL="ODSL contained a generate_slides statement that can't parsed",e.UserAbortedQueryExecution="User aborted query execution",e.IncorrectlyFormattedODSL="ODSL for slide generation failed because it's not formatted correctly",e.LLMContentGenerationFailed="LLM call failed when trying to generate content for replacing text on a slide",e.LLMContentRewritingFailed="LLM call failed when trying to generate content for rewriting a slide",e.InvalidFileURL="Input query has a invalid file URL",e.LicenseValidationFailedOld="Error occurred because copilot license couldn't be validated",e.LowLanguageScore="Language score is too low",e.MissingSignalInWorkflow="Error occurred because signal is missing in workflow",e.MissingSubIntent="Error occurred because sub-intent is missing",e.MissingODSLArgument="ODSL is missing a required argument",e.MissingServicePlan="Required service plan is missing",e.NoImagesGenerated="No images generated by Text2Image model",e.NoEffectProgram="The program returned would have no effect",e.NoResponseFromSydney="Error occurred because no chat response/error rendered by sydney",e.APIUnavailable="Error occurred because API is not available",e.UnsupportedInputLanguage="Input language is not supported",e.UnsupportedOutputLanguage="Output language is not supported",e.OffensiveContentError="Error occurred because of offensive content",e.OffensiveOutputBlocked="Output blocked by content moderator for being offensive",e.InputOutOfScope="Input query is out of scope of system",e.OutputBlockedByFilters="Error occurred because output is blocked by filters",e.RAIGeneratedOutputCheckError="Error occurred while checking RAI on generated output",e.RAIGeneratedAnswerCheckError="Error occurred while checking RAI on generated answer",e.SlideJSONParsingFailure="Failure when parsing slide JSON returned from LLM",e.PerpetualDisambiguationLoop="Perpetual disambiguation loop detected",e.ODSLExecutionFailure="ODSL was successfully returned, but the client failed to execute it",e.Text2ImageModelResponseFailure="Failure in receiving response from Text2Image model",e.SameSlotDisambiguationLoop="Disambiguation loop detected with the same slot",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.SkillsFailed="Skills failed",e.UnsupportedSydneyLanguage="Unsupported language for Sydney",e.UnclassifiedIssue="Error occurred because of an unclassified issue",e.Unset="",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.ProgramExecutionTimeout="Timeout occurred during program execution",e.ServerTimeout="Timeout waiting for server",e.TokenError="Error occurred because of token",e.InputTooLong="Input query is too long",e.InputTooShort="Input query is too short",e.TruncatedODSL="ODSL returned by LLM was truncated",e.ODSLParsingError="Unhandled error while parsing ODSL",e.ODSLSyntaxValidationError="Unhandled error when validating ODSL syntax",e.UnknownError="Error is unknown",e.VisualDescriptionsGenerationUnknownError="Unknown error occurred while generating visual descriptions.",e.ModelUnknownError="Unknown error from model",e.UnknownDetectedLanguage="Detected language is unknown",e.ODSLStatementSchemaMismatch="ODSL statement does not belong to the schema",e.UnrecognizedText2ImageModelBaseURL="Base URL for Text2Image model is unrecognized",e.ODSLValueOutOfRange="Value in ODSL is outside range of allowed values",e.ODSLStatementBlocked="ODSL statement is blocked by administrator",e.UnsupportedLanguage="Language is unsupported",e.UnsupportedMultiAgent="Input query involves multiple agents which is unsupported",e.UnsupportedInputQuery="Input query is not supported",e.UserThrottled="Error occurred because user has issued too many requests",e.UndefinedODSLVariableReference="ODSL contains reference to a variable that is not defined",e.ODSLArgumentWrongType="ODSL argument has a wrong type",e.InvalidSignal="Error occurred because signal is invalid.",e.EmptyODSLCreation="LLM call to create ODSL did not have any ODSL in it",e.UnsupportedVersion="Error occurred because version is not supported",e.ServiceBusy="Error occurred because service is busy",e.InputContentTooShort="Error occurred because input content is too short",e.LicenseValidationFailed="AugLoop failed to validate the user's Copilot entitlement",e.InvalidTokens="AugLoop failed to validate the Copilot user token",e.PartialSuccessErrorMessage="Partial success message displayed",e.Text2ImageGenericError="Text2Image failed to return requested image(s)",e.DesignerMiniAuthError="Designer Mini failed to display image options due to authentication error",e.DesignerMiniError="Designer Mini failed to display image options due to error",e.DesignerVisualsInferenceAPIError="Skill failed to properly generate entire response",e.DesignerVisualsUnsupportedImageType="Unsupported image type requested"}(b||(b={})),function(e){e.UnclearIntent="Unclear Intent CopilotChat",e.BasicChat="Ask Chat QnA",e.Summarize="Summarize Summarize",e.Command="Command Basic Command",e.AddContent="Create Add Content",e.DesignerVisuals="Create Designer Visuals"}(E||(E={})),function(e){e.Disabled="Error occurred because content generation is disabled by admin"}(T||(T={}));var I,P,_="Timeout waiting for server";!function(e){e.CreatePresentation="Create a presentation",e.CreateFromFile="Create a presentation from file",e.AddSlide="Add a slide",e.AddImage="Add an image",e.AddEnterpriseImage="Add an enterprise image",e.Organize="Organize this presentation",e.Summarize="Summarize the presentation",e.VisualSummary="Visual Summary",e.KeySlides="Show the key slides",e.ShowActionItems="Show action items",e.Animate="Animate my slides",e.Beautify="Design my presentation",e.ProactiveRecommendation="Proactive Recommendation",e.Help="Help",e.BasicChat="Basic Chat",e.Sydney="Sydney",e.Unset="",e.SelfHelpSearch="Self-Help Search",e.AddDesignerImage="Add an image from Designer",e.CannedResponse="Canned Response",e.SegmentedSummary="Segmented Summary",e.StyledSummary="Styled Summary",e.SpeakerNotes="Speaker Notes",e.HandOff="Hand-Off",e.Customize="Customize",e.SketchToImage="SketchToImage",e.InsertImage="Insert Image",e.ExtensibilityDeclarativeAgents="Extensibility Declarative Agents",e.TranslatePresentation="Translate Presentation",e.InteractiveSummary="Interactive Summary",e.ImageChat="Image Chat"}(I||(I={})),function(e){e.InitiatorView="InitiatorView"}(P||(P={}));var A,k,x="UserQueryGuid";!function(e){e.HandoffStart="Handoff_Start",e.AppStart="App_Start",e.CopilotPaneStart="Copilot_Pane_Start",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.ChatPaneLoaded="Chat_Pane_Loaded",e.HandoffMessageIdSent="Handoff_Message_Id_Sent",e.HandoffMessageIdProcessed="Handoff_Message_Id_Processed",e.HandoffMessageReceived="Handoff_Message_Received",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted"}(A||(A={})),function(e){e.PromptType="promptType",e.SourceApp="sourceApp",e.IsModified="isModified",e.ScenarioName="scenarioName"}(k||(k={}))},18073:(e,t,n)=>{"use strict";n.d(t,{E:()=>c});var r=n(11912),o=n(91165),i=n(90813),a=n(83048),s=n(18384),l=n(39041),c=function(){function e(t){(0,r._)(this,e),(0,i._)(this,"telemetryLatencyObject",void 0),(0,i._)(this,"telemetryChatEventObject",void 0),(0,i._)(this,"telemetryOfficeJsOperationObject",void 0),(0,i._)(this,"telemetryMicrophoneObject",void 0),(0,i._)(this,"telemetryQueryDetailsObject",void 0),(0,i._)(this,"chatHistoryLog",void 0),(0,i._)(this,"telemetryLogger",void 0),(0,i._)(this,"telemetryCommandingObject",void 0),this.telemetryLatencyObject=null,this.telemetryChatEventObject=null,this.telemetryOfficeJsOperationObject=null,this.telemetryQueryDetailsObject={},this.telemetryLogger=t,this.telemetryMicrophoneObject=null,this.telemetryCommandingObject=null,this.chatHistoryLog={chatHistoryTelemetryInfo:[]}}return(0,o._)(e,[{key:"initTelemetryLatencyObject",value:function(){this.telemetryLatencyObject=(0,s.xI)(),this.chatHistoryLog.chatHistoryTelemetryInfo=[]}},{key:"initTelemetryChatEventObject",value:function(){this.telemetryChatEventObject=(0,s.uA)()}},{key:"initTelemetryOfficeJSOperationObject",value:function(){this.telemetryOfficeJsOperationObject=(0,s.b6)()}},{key:"initTelemetryCommandingObject",value:function(){this.telemetryCommandingObject=(0,s.wV)()}},{key:"updateChatHistoryLog",value:function(e){this.chatHistoryLog.chatHistoryTelemetryInfo.push(e)}},{key:"updateTelemetryLatencyData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null!=this.telemetryLatencyObject&&(Object.keys(e).forEach((function(n){t.telemetryLatencyObject[n]=e[n],t.telemetryQueryDetailsObject[n]=e[n]})),n&&this.sendTelemetryLatencyData(this.telemetryLogger))}},{key:"updateTelemetryOfficeJSOperationData",value:function(e){var t=this;null===this.telemetryOfficeJsOperationObject&&this.initTelemetryOfficeJSOperationObject(),Object.keys(e).forEach((function(n){t.telemetryOfficeJsOperationObject[n]=e[n]})),this.sendTelemetryOfficeJSOperationData(this.telemetryLogger)}},{key:"updateTelemetryChatEventData",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===this.telemetryChatEventObject&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(n){t.telemetryChatEventObject[n]=e[n]})),n&&this.sendTelemetryChatEventData(this.telemetryLogger)}},{key:"updateTelemetryQueryDetailsEventData",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.telemetryQueryDetailsObject[n]=e[n]}))}},{key:"updateTelemetryCommandingData",value:function(e){var t=this;null===this.telemetryCommandingObject&&this.initTelemetryCommandingObject(),Object.keys(e).forEach((function(n){t.telemetryCommandingObject[n]=e[n]})),this.sendTelemetryCommandingData(this.telemetryLogger)}},{key:"sendTelemetryLatencyData",value:function(e){if(!(0,l.hX)(this.telemetryLatencyObject)&&!(0,l.hX)(e)){var t=JSON.stringify(this.chatHistoryLog.chatHistoryTelemetryInfo);this.telemetryLatencyObject[a.CT.CopilotChatHistoryInfoJson]=t,e.logEvent((0,s.kX)(this.telemetryLatencyObject)),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e)}}},{key:"sendTelemetryQueryDetailsObject",value:function(e){(0,l.hX)(e)||(0,l.hX)(this.telemetryQueryDetailsObject)||(e.logEvent((0,s.cx)(this.telemetryQueryDetailsObject)),this.telemetryQueryDetailsObject={})}},{key:"sendTelemetryOfficeJSOperationData",value:function(e){(0,l.hX)(e)||(0,l.hX)(this.telemetryOfficeJsOperationObject)||(e.logEvent((0,s.gY)(this.telemetryOfficeJsOperationObject)),this.initTelemetryOfficeJSOperationObject())}},{key:"sendTelemetryChatEventData",value:function(e){if(!(0,l.hX)(e)&&!(0,l.hX)(this.telemetryChatEventObject)){if(e.logEvent((0,s._W)(this.telemetryChatEventObject)),this.telemetryChatEventObject[a.h3.ChatEventType]){var t,n=Object.keys(a.a5)[Object.values(a.a5).indexOf(this.telemetryChatEventObject[a.h3.ChatEventType])];this.telemetryQueryDetailsObject[n]=this.telemetryChatEventObject[a.h3.ChatEventParameters]&&0===(null===(t=this.telemetryChatEventObject[a.h3.ChatEventParameters])||void 0===t?void 0:t.length)?"true":this.telemetryChatEventObject[a.h3.ChatEventParameters]}this.initTelemetryChatEventObject()}}},{key:"sendTelemetryCommandingData",value:function(e){(0,l.hX)(e)||(0,l.hX)(this.telemetryCommandingObject)||(e.logEvent((0,s.Xo)(this.telemetryCommandingObject)),this.initTelemetryCommandingObject())}}],[{key:"getInstance",value:function(t){return(0,l.hX)(e.telemetryEventHandler)&&(e.telemetryEventHandler=new e(t)),e.telemetryEventHandler}}]),e}();(0,i._)(c,"telemetryEventHandler",void 0)},36633:(e,t,n)=>{"use strict";n.d(t,{M:()=>C});var r=n(11912),o=n(91165),i=n(90813),a=n(57835),s=n(81092),l=n(78185),c=n(45242),u=n(130),d=n(53357),p=n(34045),f=n(44632),h=n(83048),g=n(47941),m=n(39041),y="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",v=1763,S=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"sendTelemetryEvent",value:function(e){Office.sendTelemetryEvent(e)}}]),e}(),C=function(){function e(){(0,r._)(this,e),(0,i._)(this,"oTelLogger",void 0),(0,i._)(this,"telemSink",void 0),this.oTelLogger=new l.M,this.setupTelemetryLogger(this.oTelLogger)}return(0,o._)(e,[{key:"getDefaultEventFlags",value:function(){return{dataCategories:c.o.DataCategories.ProductServicePerformance|c.o.DataCategories.ProductServiceUsage,diagnosticLevel:c.o.DiagnosticLevel.Optional}}},{key:"logEvent",value:function(e,t){this.logTelemetryEvent(e,t)}},{key:"logError",value:function(e,t){this.logTelemetryErrorEvent(e,t)}},{key:"getTelemetrySink",value:function(){return this.telemSink}},{key:"getTelemetryProperties",value:function(){return{ariaTenantToken:y,nexusTenantToken:v}}},{key:"logTelemetryEvent",value:function(e,t){var n={telemetryProperties:{ariaTenantToken:y,nexusTenantToken:v},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?(0,a._)({},t,this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)}},{key:"logTelemetryErrorEvent",value:function(e,t){var n={eventName:"Office.Voice.ActionAI."+h.S2.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?(0,a._)({},t,this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:h.qN,value:f.B.getInstance().getQueryGuid()},{key:"ChatPPTSessionId",value:p.Vv.getSettingAsString(p.zj.ChatPPTSessionID)},{key:"ALSessionKey",value:(0,g.Dt)()}])};this.oTelLogger.sendError(n)}},{key:"getCopilotDataFields",value:function(e,t){return(0,s._)(u.TA.getFields({featureActionType:u.TA.FeatureActionType[e],isUserInitiated:!0,capability:(0,m.hX)(t)?"":u.TA.Capability[t],featureName:"PPTCopilotChat"})).concat((0,s._)(this.getDataFields([{key:h.qN,value:f.B.getInstance().getQueryGuid()},{key:"HostSDXSessionId",value:p.Vv.getSettingAsString(p.zj.ChatPPTSessionID)}])))}},{key:"logSharedTelemetryEvent",value:function(e){if(e.GetEventName()===h.S2.Error)return this.logSharedErrorEvent(e);var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.GetEventName(),eventFlags:e.IsRequired()?{dataCategories:c.o.DataCategories.ProductServiceUsage|c.o.DataCategories.ProductServicePerformance,diagnosticLevel:c.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:c.o.SamplingPolicy.CriticalUsage}:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:c.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logSharedErrorEvent",value:function(e){var t,n={eventName:"Office.Voice.ActionAI."+h.S2.Error,error:{errorGroup:null===(t=e.GetLogs().find((function(e){return e.name===h.IC.ErrorCategory})))||void 0===t?void 0:t.value,tag:0},eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?c.o.SamplingPolicy.CriticalUsage:c.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendError(n)}},{key:"logSharedTelemetrySTKEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:e.IsRequired()&&!t?{dataCategories:c.o.DataCategories.ProductServiceUsage|c.o.DataCategories.ProductServicePerformance,diagnosticLevel:c.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:c.o.SamplingPolicy.CriticalUsage}:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?c.o.SamplingPolicy.CriticalUsage:c.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendTelemetryEvent(n)}},{key:"getCopilotEventFlags",value:function(){return{dataCategories:c.o.DataCategories.ProductServiceUsage,diagnosticLevel:c.o.DiagnosticLevel.RequiredServiceData}}},{key:"logSeenEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsSeen,e)};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logTriedEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e)};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logKeptEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsKept,e)};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logEnabledEvent",value:function(){var e={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsEnabled)};this.oTelLogger.sendTelemetryEvent(e)}},{key:"getDataFields",value:function(e){return e.map((function(e){return"number"==typeof e.value?d.ip(e.key,e.value):"string"==typeof e.value?d.m9(e.key,e.value):"boolean"==typeof e.value?d.LK(e.key,e.value):d.m9(e.key,e.value)}),[])}},{key:"setupTelemetryLogger",value:function(e){e.setTenantToken("Office.Voice.ActionAI",y,v),e.setTenantToken("Office.Voice.Copilot",y,v),this.telemSink=new S,e.addSink(this.telemSink)}}],[{key:"getInstance",value:function(){return(0,m.hX)(e.telemetryLogger)&&(e.telemetryLogger=new e),e.telemetryLogger}}]),e}();(0,i._)(C,"telemetryLogger",void 0)},18384:(e,t,n)=>{"use strict";n.d(t,{$j:()=>R,A9:()=>N,AQ:()=>D,Lu:()=>L,Nx:()=>_,Xo:()=>T,Zp:()=>M,Zy:()=>H,_W:()=>P,b6:()=>I,cx:()=>A,gY:()=>w,kX:()=>E,kl:()=>V,mQ:()=>z,ni:()=>U,oN:()=>G,pN:()=>F,uA:()=>k,ud:()=>B,wV:()=>O,xH:()=>x,xI:()=>b});var r=n(90813),o=n(55564),i=n(83048),a=n(44121),s=n(34045),l=n(72218),c=n(44632),u=n(69038),d=n(14014),p=n(99838),f=n(18758),h=n(47941),g=n(7567),m=n(39041),y=n(61339),v=n(32217),S=n(1543),C=n(19464),b=function(){var e={};return Object.keys(i.CT).forEach((function(t){e[t]=0})),e},E=function(e){return e[i.CT.UserQueryGuid]||(e[i.CT.UserQueryGuid]=c.B.getInstance().getQueryGuid()),e[i.CT.AugloopSessionGuid]=h.Os,e[i.CT.ChatPPTSessionId]=s.Vv.getSettingAsString(s.zj.ChatPPTSessionID),e[i.CT.IsDevBuild]=l.MYv,{eventType:i.S2.Latency,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},T=function(e){return e[i.S9.UserQueryGuid]||(e[i.S9.UserQueryGuid]=c.B.getInstance().getQueryGuid()),e[i.S9.HostSDXSessionID]=s.Vv.getSettingAsString(s.zj.ChatPPTSessionID),{eventType:i.S2.Commanding,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},w=function(e){return e[i.Dh.UserQueryGuid]||(e[i.Dh.UserQueryGuid]=c.B.getInstance().getQueryGuid()),e[i.Dh.ChatPPTSessionId]=s.Vv.getSettingAsString(s.zj.ChatPPTSessionID),e[i.Dh.UserQueryOrder]=u.EU,{eventType:i.S2.OfficeJsOperations,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}};function I(){var e={};return Object.keys(i.Dh).forEach((function(t){e[t]=""})),e}var P=function(e){return e[i.h3.UserQueryGuid]||(e[i.h3.UserQueryGuid]=c.B.getInstance().getQueryGuid()),e[i.h3.ChatPPTSessionId]=s.Vv.getSettingAsString(s.zj.ChatPPTSessionID),e[i.h3.UserQueryOrder]=u.EU,e[i.h3.ALSessionKey]=(0,h.Dt)(),e[i.h3.IsDevBuild]=l.MYv,{eventType:i.S2.ChatEvents,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},_=function(e){var t,n=parseFloat((0,m.gZ)(e));c.B.getInstance().sendLatencyTelemetry(F((t={},(0,r._)(t,i.CT.FeatureName,i.CC.Preload_ChatPaneLoad),(0,r._)(t,i.CT.PPTUserCopilotPaneLoadTime,(0,u.WU)(n)),t)),!0),c.B.getInstance().recordCheckPoint(i._R.CopilotPaneStart,n)},A=function(e){return e[i.tw.UserQueryGuid]||(e[i.tw.UserQueryGuid]=c.B.getInstance().getQueryGuid()),e[i.tw.HostSDXSessionID]=s.Vv.getSettingAsString(s.zj.ChatPPTSessionID),e[i.tw.UserQueryOrder]=u.EU,e[i.tw.ALSessionKey]=(0,h.Dt)(),e[i.tw.AugloopSessionGuid]=h.Os,e[i.tw.IsDevBuild]=l.MYv,{eventType:i.S2.QueryDetails,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},k=function(){var e={};return Object.keys(i.h3).forEach((function(t){e[t]=""})),e},x=function(e){var t;c.B.getInstance().sendChatEventTelemetry(F((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.TaskPaneVisibilityModeChanged),(0,r._)(t,i.h3.ChatEventParameters,e),t)))},N=function(e,t){return(0,m.Px)(e,t)},O=function(){var e={};return Object.keys(i.S9).forEach((function(t){e[t]=0})),e},D=function(e,t,n,o,a,s,l,c){var d,p=arguments.length>8&&void 0!==arguments[8]&&arguments[8],f=y.R.getInstance();n&&""!==n&&e.sendChatEventTelemetry(F((d={},(0,r._)(d,i.h3.ChatEventType,n),(0,r._)(d,i.h3.ChatEventParameters,o||""),(0,r._)(d,i.h3.ChatErrorType,a||""),(0,r._)(d,i.h3.ChatErrorKey,c||""),d)));var h,g=f.getShouldAccountForWarningCardUserInteractionLatency()?f.getWarningCardUserInteractionTimeInSec():0;p||e.sendLatencyTelemetry(F((h={},(0,r._)(h,i.CT.UserPerceivedLatency,(0,u.WU)(t)-g),(0,r._)(h,i.CT.IsQuerySuccess,void 0===n),(0,r._)(h,i.CT.ErrorType,a||""),(0,r._)(h,i.CT.ErrorParameter,(!0===s?n:o)||""),(0,r._)(h,i.CT.ErrorChatEventType,n&&""!==n?n:""),(0,r._)(h,i.CT.ErrorChatEventParameter,n&&""!==n&&o||""),h)),null==l||l);f.resetWarningCardLatencyParameters()},L=function(e,t,n,o,a,s,l,c,d,p){var f,h,g=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],m=arguments.length>11?arguments[11]:void 0,y=arguments.length>12?arguments[12]:void 0;l?e.sendChatEventTelemetry(F((f={},(0,r._)(f,i.h3.ChatEventType,l),(0,r._)(f,i.h3.ChatEventParameters,c||""),(0,r._)(f,i.h3.ChatErrorType,d||""),(0,r._)(f,i.h3.ChatErrorKey,y||""),f))):e.sendChatEventTelemetry(F((h={},(0,r._)(h,i.h3.ChatEventType,i.a5.QuerySuccessful),(0,r._)(h,i.h3.ChatEventParameters,s),h)));var v,S,C=[];g?C=F((v={},(0,r._)(v,n,(0,u.WU)(t)),(0,r._)(v,o,JSON.stringify(a)),(0,r._)(v,i.CT.IsQuerySuccess,void 0===l),(0,r._)(v,i.CT.ErrorType,d||""),(0,r._)(v,i.CT.ErrorParameter,c||""),v)):C=F((S={},(0,r._)(S,n,(0,u.WU)(t)),(0,r._)(S,o,JSON.stringify(a)),(0,r._)(S,i.CT.ErrorType,d||""),(0,r._)(S,i.CT.ErrorParameter,c||""),(0,r._)(S,i.CT.ErrorChatEventType,l||""),(0,r._)(S,i.CT.ErrorChatEventParameter,c||""),S));m&&e.logAshaErrorEvent(m.vetoName,m.errorString,m.featureName),e.sendLatencyTelemetry(C,null==p||p)},R=function(e,t,n,o,a,s,l){var c,d,p,f=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],h=null!==(c=null!=l?l:e.getQueryGuid())&&void 0!==c?c:"";e.sendChatEventTelemetry(F((d={},(0,r._)(d,i.h3.UserQueryGuid,h),(0,r._)(d,i.h3.ChatEventType,i.a5.ResponseReceivedFromAL),(0,r._)(d,i.h3.ChatEventParameters,t),(0,r._)(d,i.h3.Cv,null!=s?s:""),d)),void 0);var g=(p={},(0,r._)(p,i.h3.UserQueryGuid,h),(0,r._)(p,i.CT.FeatureName,null!=a?a:i.CC.CopilotChat),p);f&&h&&(g[i.CT.AnnotationType]=t),o&&(g[o]=(0,u.WU)(n)),e.sendLatencyTelemetry(F(g),void 0)},F=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))},M=function(e){c.B.getInstance().setQueryGuid(e)},B=function(e){var t=s.Vv.getSetting(s.zj.AppStartTimestamp);t&&e.recordCheckPoint(i._R.AppStart,t);var n=s.Vv.getSetting(s.zj.CopilotPaneStartTimestamp);n&&!p.preloadCopilot&&e.recordCheckPoint(i._R.CopilotPaneStart,n),e.logSeenEvent(a.SD.CopilotChat);var l,c,h,m,y,v,b,E=[{key:i.CT.SDXResourcesLoadTime,value:(0,u.WU)(p.pptTaskPaneStartTime)},{key:i.CT.LocalizationStringsLoadTime,value:g.Jo}];((0,o.JO)()&&!p.preloadCopilot&&(E.push({key:i.CT.FeatureName,value:i.CC.ChatPaneLoad}),E.push({key:i.CT.PPTUserCopilotPaneLoadTime,value:(0,u.WU)(n)})),e.sendLatencyTelemetry(E,!0),e.logAshaEvent("Copilot:Chat Pane:Chat Pane"),e.sendChatEventTelemetry(F((l={},(0,r._)(l,i.h3.ChatEventType,i.a5.TaskPaneStart),(0,r._)(l,i.h3.ChatEventParameters,p.pptTaskPaneStartTime),l))),e.sendChatEventTelemetry(F((c={},(0,r._)(c,i.h3.ChatEventType,i.a5.AppLoadStart),(0,r._)(c,i.h3.ChatEventParameters,p.appLoadStartTime),c))),e.sendChatEventTelemetry(F((h={},(0,r._)(h,i.h3.ChatEventType,i.a5.OfficeJSReady),(0,r._)(h,i.h3.ChatEventParameters,p.officeOnReadyTime),h))),e.sendChatEventTelemetry(F((m={},(0,r._)(m,i.h3.ChatEventType,i.a5.AppExecutionStart),(0,r._)(m,i.h3.ChatEventParameters,d.p3),m))),e.sendChatEventTelemetry(F((y={},(0,r._)(y,i.h3.ChatEventType,i.a5.StringLocalizationStart),(0,r._)(y,i.h3.ChatEventParameters,d.NY),y))),p.OfficeAddinCalledTime)&&e.sendChatEventTelemetry(F((v={},(0,r._)(v,i.h3.ChatEventType,i.a5.OfficeAddinCalledTime),(0,r._)(v,i.h3.ChatEventParameters,p.OfficeAddinCalledTime),v)));p.preloadCopilot&&e.sendChatEventTelemetry(F((b={},(0,r._)(b,i.h3.ChatEventType,i.a5.PreloadCopilot),(0,r._)(b,i.h3.ChatEventParameters,p.preloadCopilot),b)));var T,w,I=JSON.stringify({isDeclarativeAgentsEnabled:(0,S.jO)(),isUseCacheForGPTDetails:(0,o.PA)(o.IY.UseCacheForGPTDetails),isStopMenuShimmerAfterFirstCall:(0,o.PA)(o.IY.StopMenuShimmerAfterFirstCall),shouldUseMsalGetTokenRequestCaching:(0,o.bw)(o.WT.ShouldUseMsalGetTokenRequestCaching),enableSwitcherMenuV2:(0,o.bw)(o.WT.EnableSwitcherMenuV2),loadGptListOnCopilotIconClick:(0,o.bw)(o.WT.LoadGptListOnCopilotIconClick)});(0,f.cY)("Sending extensibility config telemetry for chat pane load ".concat(I)),e.sendChatEventTelemetry(F((T={},(0,r._)(T,i.h3.ChatEventType,i.a5.ExtensibilityConfig),(0,r._)(T,i.h3.ChatEventParameters,I),T))),e.recordCheckPoint(i._R.ChatPaneLoaded),e.sendChatEventTelemetry(F((w={},(0,r._)(w,i.h3.ChatEventType,i.a5.ExperimentFlights),(0,r._)(w,i.h3.ChatEventParameters,(0,C.xy)()),w)))},U=function(e,t,n,a){var s;(0,o.PA)(o.IY.IsCommandingUserPerceivedLatencyTelemetryEnabled)&&e.sendLatencyTelemetry(F((s={},(0,r._)(s,i.CT.UserPerceivedLatency,t),(0,r._)(s,i.CT.IsQuerySuccess,n),(0,r._)(s,i.CT.QueryExecutionTime,(0,u.WU)(a)),s)))},z=function(e){var t;c.B.getInstance().sendErrorTelemetry(F((t={},(0,r._)(t,i.IC.ErrorMessage,"".concat(e)),(0,r._)(t,i.IC.ErrorCategory,i.S2.CLP),t)))},H=function(e){var t;c.B.getInstance().sendChatEventTelemetry(F((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.OfficeJsApiCallForCLP),(0,r._)(t,i.h3.ChatEventParameters,"CLP_OfficeJsApi : ".concat(e)),t)))},G=function(e){var t;(0,v.II)()&&((0,f.cY)("Disabled enterprise search after hitting CLP exception"),c.B.getInstance().sendChatEventTelemetry(F((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.EnterpriseGroundingDisabled),(0,r._)(t,i.h3.ChatEventParameters,null!=e?e:""),t))))},V=function(e,t){var n,o;e.manualSendPrompt?(n=i.a5.HandoffQueryPerceivedByUser,o=i._R.HandoffQueryPerceivedByUser,e.query&&c.B.getInstance().setInitialHandoffQuery(e.query)):(n=i.a5.HandoffQueryAutoSubmitted,o=i._R.HandoffQueryAutoSubmitted),c.B.getInstance().sendLatencyTelemetry(F((0,r._)({},i.CT.UserPerceivedLatency,(0,u.WU)(t))));var a,s={};if(e.sourceApp&&(s[i.CD.SourceApp]=e.sourceApp),e.context){var l=JSON.parse(e.context).promptType;l&&(s[i.CD.PromptType]=l)}e.scenarioName&&(s[i.CD.ScenarioName]=e.scenarioName),(0,f.cY)("Handoff query perceived by user: ",s),c.B.getInstance().sendChatEventTelemetry(F((a={},(0,r._)(a,i.h3.ChatEventType,n),(0,r._)(a,i.h3.ChatEventParameters,JSON.stringify(s)),a))),e.handoffStartTime&&c.B.getInstance().recordCheckPoint(i._R.HandoffStart,e.handoffStartTime),c.B.getInstance().recordCheckPoint(o),c.B.getInstance().sendLatencyTelemetryForCheckPoints(!0)}},12542:(e,t,n)=>{"use strict";n.d(t,{CC:()=>i.CC,CD:()=>i.CD,CT:()=>i.CT,Dh:()=>i.Dh,ET:()=>r.E,Ff:()=>i.Ff,G8:()=>i.G8,IC:()=>i.IC,MP:()=>o.M,NW:()=>i.NW,Nr:()=>i.Nr,S2:()=>i.S2,_5:()=>i._5,_I:()=>i._I,_R:()=>i._R,a5:()=>i.a5,av:()=>i.av,by:()=>i.by,f3:()=>i.f3,fj:()=>i.fj,h3:()=>i.h3,qN:()=>i.qN,sY:()=>i.sY,z_:()=>i.z_});var r=n(18073),o=n(36633),i=n(83048)},34948:(e,t,n)=>{"use strict";n.d(t,{Os:()=>l,eS:()=>s});var r=n(57835),o=n(37745),i={themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#FFFFFF",black:"#FFFFFF",themeBackground:"#292929"},a={themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1CFF",themeLighter:"#F558A6FF",themeLighterAlt:"#FFB700FF",themeDarkAltTransparent:"#C43E1C00",themeLighterTransparent:"#F558A600",themeLighterAltTransparent:"#FFB70000",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#242424",black:"#000000",themeBackground:"transparent"},s=function(e,t){var n=e?(0,r._)({isDarkModeEnabled:e,isHighContrastModeEnabled:t},i):(0,r._)({isDarkModeEnabled:!1,isHighContrastModeEnabled:t},a);return n.dir=(0,o.xt)()?"rtl":"ltr",n},l={10:"#200D03",20:"#3C1805",30:"#6E220F",40:"#79310A",50:"#952F15",60:"#B13719",70:"#B1470E",80:"#C43E1C",90:"#CB5031",100:"#CA5010",110:"#CF6024",120:"#D67540",130:"#DC816A",140:"#E1966D",150:"#EDBCB0",160:"#F6DBD4"}},15520:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var r=n(43032),o=n(79490),i=n(18758),a=n(55564);function s(e){return l.apply(this,arguments)}function l(){return l=(0,r._)((function(e){var t,n=arguments;return(0,o.__generator)(this,(function(e){return null==(t=n.length>1&&void 0!==n[1]?n[1]:null)?[2,null]:[2,{text:t.text,color:t.font.color,bold:t.font.bold,italic:t.font.italic,underline:t.font.underline,fontName:t.font.name,size:t.font.size,bulleted:t.paragraphFormat.bulletFormat.visible}]}))})),l.apply(this,arguments)}function c(e,t,n){return u.apply(this,arguments)}function u(){return u=(0,r._)((function(e,t,n){var r,i,a,l=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return null==(r=l.length>3&&void 0!==l[3]?l[3]:null)||""==r.text?t.type==PowerPoint.ShapeType.geometricShape&&(i=t.textFrame.textRange):i=r,a={index:n,id:t.id},[4,s(e,i)];case 1:return a.textRange=o.sent(),a.type=t.type,a.name=t.name,a.left=t.left,a.top=t.top,a.height=t.height,a.width=t.width,a.area=t.height*t.width,a.lineColor=t.lineFormat.color,a.lineDashStyle=t.lineFormat.dashStyle,a.lineWeight=t.lineFormat.weight,a.lineTransparency=t.lineFormat.transparency,a.fillColor=t.fill.foregroundColor,a.fillTransparency=t.fill.transparency,[2,a]}}))})),u.apply(this,arguments)}function d(e,t,n){return p.apply(this,arguments)}function p(){return p=(0,r._)((function(e,t,n){var r,i,a,s,l,u,d,p=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:i=p.length>4&&void 0!==p[4]?p[4]:null,a=null==(r=p.length>3&&void 0!==p[3]?p[3]:null)?t.shapes.items:r,s={index:n,id:t.id,shapes:[]},l=0,o.label=1;case 1:return l<a.length?(d=(u=s.shapes).push,[4,c(e,a[l],l,i)]):[3,4];case 2:d.apply(u,[o.sent()]),o.label=3;case 3:return l++,[3,1];case 4:return[2,s]}}))})),p.apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return e.load("type,\n    name,\n    left,\n    top,\n    height,\n    width,\n    lineFormat/color,\n    lineFormat/dashStyle,\n    lineFormat/weight,\n    lineFormat/transparency,\n    fill/foregroundColor,\n    fill/transparency"),[2]}))}))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return e.load("textFrame,\n    textFrame/textRange,\n    textFrame/textRange/text,\n    textFrame/textRange/font/color,\n    textFrame/textRange/font/bold,\n    textFrame/textRange/font/italic,\n    textFrame/textRange/font/underline,\n    textFrame/textRange/font/name,\n    textFrame/textRange/font/size,\n    textFrame/textRange/paragraphFormat/bulletFormat/visible"),[2]}))}))).apply(this,arguments)}function y(){return(y=(0,r._)((function(e){var t,n,r,s,l,c,u,p,h,m,y,v,S,C,b,E,T,w,I,P,_,A;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t={slides:[]},o.label=1;case 1:return o.trys.push([1,33,,34]),(n=e.presentation.getSelectedTextRangeOrNullObject()).load("isNullObject"),(r=e.presentation.getSelectedShapes()).load("items,\n       items/id"),(s=e.presentation.slides).load("items, items/id"),(l=e.presentation.getSelectedSlides()).load("items,\n      items/id"),[4,e.sync()];case 2:if(o.sent(),c=[],u=[],p=[],(0,a.PA)(a.IY.UseCorrectSlideIndexInPPTOdslSignal)&&(c=s.items.map((function(e){return e.id})),u=l.items.map((function(e){return e.id})),p=u.map((function(e){return c.indexOf(e)}))),n.isNullObject&&(n=null),0==r.items.length&&(r=null),null!=r)return[3,17];for(h=0;h<l.items.length;h++)l.items[h].load("Shapes, Shapes/items");return[4,e.sync()];case 3:o.sent(),m=0,o.label=4;case 4:if(!(m<l.items.length))return[3,9];y=l.items[m],v=0,o.label=5;case 5:return v<y.shapes.items.length?[4,f(y.shapes.items[v])]:[3,8];case 6:o.sent(),o.label=7;case 7:return v++,[3,5];case 8:return m++,[3,4];case 9:return[4,e.sync()];case 10:o.sent(),S=0,o.label=11;case 11:if(!(S<l.items.length))return[3,16];C=l.items[S],b=0,o.label=12;case 12:return b<C.shapes.items.length?C.shapes.items[b].type!=PowerPoint.ShapeType.geometricShape?[3,14]:[4,g(C.shapes.items[b])]:[3,15];case 13:o.sent(),o.label=14;case 14:return b++,[3,12];case 15:return S++,[3,11];case 16:return[3,27];case 17:E=0,o.label=18;case 18:return E<r.items.length?[4,f(r.items[E])]:[3,21];case 19:o.sent(),o.label=20;case 20:return E++,[3,18];case 21:return[4,e.sync()];case 22:o.sent(),T=0,o.label=23;case 23:return T<r.items.length?r.items[T].type!=PowerPoint.ShapeType.geometricShape?[3,25]:[4,g(r.items[T])]:[3,26];case 24:o.sent(),o.label=25;case 25:return T++,[3,23];case 26:null!=n&&n.load("text,\n        font/color,\n        font/bold,\n        font/italic,\n        font/underline,\n        font/name,\n        font/size,\n        paragraphFormat/bulletFormat/visible"),o.label=27;case 27:return[4,e.sync()];case 28:o.sent(),w=0,o.label=29;case 29:return w<l.items.length?(_=(P=t.slides).push,[4,d(e,l.items[w],(0,a.PA)(a.IY.UseCorrectSlideIndexInPPTOdslSignal)&&null!==(I=p[w])&&void 0!==I?I:w,null==r?null:r.items,n)]):[3,32];case 30:_.apply(P,[o.sent()]),o.label=31;case 31:return w++,[3,29];case 32:return[3,34];case 33:throw A=o.sent(),(0,i.cY)("exception in getSelectionContextTree: ",A.message+"\n"+A.stack),A;case 34:return[2,t]}}))}))).apply(this,arguments)}const v=function(e){return y.apply(this,arguments)}},2242:(e,t,n)=>{"use strict";n.r(t),n.d(t,{camelFromPascal:()=>p,getDocumentAsCompressed:()=>c,getSliceAsync:()=>u,matchAll:()=>l,onGotAllSlices:()=>d});var r=n(43032),o=n(74292),i=n(79490),a=n(18758),s=n(39041);function l(e,t){for(var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?"g":"gi",i=(0,o._)(t,RegExp)?t:new RegExp(t,r),a=[];null!==(n=i.exec(e));)a.push(n);return a}function c(){return new OfficeExtension.Promise((function(e,t){var n;Office.context.document.getFileAsync(Office.FileType.Compressed,{sliceSize:4194304},(n=(0,r._)((function(n){var r,o,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(n.status!=Office.AsyncResultStatus.Succeeded)return[3,4];r=n.value,o=r.sliceCount,u(r,0,o,!0,[],0,l=[]),i.label=1;case 1:return 0!=l.length?[3,3]:[4,(0,s.uk)(100)];case 2:return i.sent(),[3,1];case 3:return e(l[0]),[3,5];case 4:t((0,a.cY)("Get Document as compressed failed "+n.error.message)),i.label=5;case 5:return[2]}}))})),function(e){return n.apply(this,arguments)}))}))}function u(e,t,n,r,o,i,s){e.getSliceAsync(t,(function(l){if("succeeded"==l.status){if(!r)return void(0,a.cY)("Failed to get all slices, no need to continue.");o[l.value.index]=l.value.data,++i==n?((0,a.cY)("All slices have been received."),e.closeAsync(),d(o,s)):u(e,++t,n,r,o,i,s)}else r=!1,e.closeAsync()}))}function d(e,t){for(var n=[],r=0;r<e.length;r++)n=n.concat(e[r]);for(var o=new String,i=0;i<n.length;i++)o+=String.fromCharCode(n[i]);t.push(btoa(o))}function p(e){return e.charAt(0).toLowerCase()+e.slice(1)}},15499:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteFooters:()=>u.uN,deleteImages:()=>s.KK,deleteShapes:()=>l.wv,deleteSlides:()=>u.yU,deleteText:()=>p.JG,fns:()=>S,formatImages:()=>s.Go,formatList:()=>g.k,formatShapes:()=>l.qQ,formatSlides:()=>c.Ub,formatText:()=>p.vX,generateSlides:()=>f.cd,getSelectionContextTree:()=>h.A,helper:()=>a,imageProvider:()=>v,insertImages:()=>s.eZ,insertList:()=>g.u,insertSection:()=>c.hb,insertShapes:()=>l.AU,insertSlides:()=>c.Ob,insertTables:()=>m.d,insertText:()=>p.bc,moveSlides:()=>c.WN,selectImages:()=>s.$g,selectIndicesShape:()=>l.ZB,selectIndicesSlide:()=>c.Jh,selectIndicesText:()=>p.xk,selectShapes:()=>l.ZJ,selectSlides:()=>c.vy,selectText:()=>p.A0,selectTextIndex:()=>p.W1,server:()=>y,setFooters:()=>u.F_,transitionSlides:()=>f.Ce,undoApplication:()=>d.J});var r,o=n(43032),i=n(79490),a=n(2242),s=n(31510),l=n(99374),c=n(72230),u=n(24992),d=n(84505),p=n(59e3),f=n(39521),h=n(15520),g=n(67548),m=n(27834),y="https://pptcopilotserver.azurewebsites.net",v="sd",S={selectSlides:(r=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,c.vy)(e)]}))})),function(e){return r.apply(this,arguments)}),insertSlides:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,c.Ob)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatSlides:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,c.Ub)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),moveSlides:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,c.WN)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),undoApplication:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,d.J)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertSection:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,c.hb)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),generateSlides:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,f.cd)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteSlides:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,u.yU)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectText:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,p.A0)(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertText:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,p.bc)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatText:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,p.vX)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteText:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,p.JG)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesShape:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.ZB)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesSlide:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,c.Jh)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesText:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,p.xk)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectTextIndex:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,p.W1)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectShapes:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,l.ZJ)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertShapes:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,l.AU)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatShapes:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.qQ)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteShapes:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.wv)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertImages:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,s.eZ)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteFooters:function(e){return(0,u.uN)(e)},setFooters:function(e){return(0,u.F_)(e)},transitionSlides:function(e){return(0,f.Ce)(e)},insertList:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,g.u)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatList:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,g.k)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertTables:function(){var e=(0,o._)((function(e){return(0,i.__generator)(this,(function(t){return[2,(0,m.d)(e)]}))}));return function(t){return e.apply(this,arguments)}}()}},65817:(e,t,n)=>{"use strict";n.d(t,{Rf:()=>K,G_:()=>X,sW:()=>Q});var r=n(43032),o=n(90813),i=n(74292),a=n(79490),s=n(55564),l=["deleteFooters","deleteShapes","deleteSlides","deleteText","formatShapes","formatSlides","formatText","generateSlides","insertImages","insertSection","insertShapes","insertSlides","insertText","moveSlides","selectIndicesShape","selectIndicesSlide","selectIndicesText","selectTextIndex","selectShapes","selectSlides","selectText","setFooters","transitionSlides","undoApplication","insertList","formatList","insertTables"],c=n(33969),u=n(44121),d=n(39726),p=n(72218),f=n(34045),h=n(43277),g=n(14213),m=n(44632),y=n(81789),v=n(11912),S=n(91165),C=function(){function e(){(0,v._)(this,e)}return(0,S._)(e,null,[{key:"generateNewSlideMoniker",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=Math.floor(Math.random()*e.maxCId),r={type:u.kk.Slide,cId:n};if(t){var o=Math.floor(Math.random()*(e.maxId-e.minId))+e.minId;r.id=o}if(!e.isValidSlideMoniker(r))throw new Error("Invalid slide moniker generated");return r}},{key:"isValidSlideMoniker",value:function(t){return t.type===u.kk.Slide&&(void 0===t.id||t.id>=e.minId&&t.id<e.maxId)&&void 0!==t.cId&&t.cId>=0&&t.cId<=e.maxCId}}]),e}();(0,o._)(C,"minId",256),(0,o._)(C,"maxId",2147483648),(0,o._)(C,"maxCId",4294967295);var b,E,T,w=n(12542),I=n(18384),P=n(39041),_=n(18758),A=0,k=!1,x=(T=(0,r._)((function(e,t,n,r){var o,i,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return b={FSuccess:!0},A=0,k=!1,Office.context.requirements.isSetSupported(p.Ujq,p.b0_)?((0,_.cY)("CopilotAction API supported and using : "+Office.context.requirements.isSetSupported(p.Ujq,p.b0_)),E=e.presentation.onCopilotActionCompleted.add(N)):E=e.presentation.onApplyJOfcCommandsCompleted.add(N),[4,e.sync()];case 1:return a.sent(),(0,_.cY)("applyJOfcCommands Payload string: "+t),Office.context.requirements.isSetSupported(p.Ujq,p.b0_)?((0,_.cY)("CopilotAction API supported and using : "+Office.context.requirements.isSetSupported(p.Ujq,p.b0_)),i={scenarioOptions:n.scenarioOptions?JSON.parse(n.scenarioOptions):void 0,designerOptions:n.designerOptions?JSON.parse(n.designerOptions):void 0,selectionOptions:n.selectionOptions?JSON.parse(n.selectionOptions):void 0},t&&t.length>0&&(i.jOfcCommands=JSON.parse(t)),(0,s.bw)(s.WT.isViewActionForCopilotActionAsyncAPIEnabled)&&Office.context.requirements.isSetSupported(p.Ujq,p.CA1)&&r&&(i.viewAction=r),[4,e.presentation.copilotActionAsync(p.crT,JSON.stringify(i))]):[3,3];case 2:return o=a.sent(),[3,5];case 3:return[4,e.presentation.applyJOfcCommandsAsync(t,n)];case 4:o=a.sent(),a.label=5;case 5:return[4,e.sync()];case 6:a.sent(),A=o.m_value,a.label=7;case 7:return a.trys.push([7,9,,10]),[4,D()];case 8:return a.sent(),[3,10];case 9:return l=a.sent(),(0,_.cY)("ApplyJOfcCommands: ",JSON.stringify(l)),b.FSuccess=!1,[3,10];case 10:return(0,_.cY)("applyJOfcCommands result: "+b),null==E?[3,12]:(E.remove(),[4,e.sync()]);case 11:a.sent(),E=null,a.label=12;case 12:return[2,b]}}))})),function(e,t,n,r){return T.apply(this,arguments)});function N(e){return O.apply(this,arguments)}function O(){return O=(0,r._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,PowerPoint.run(function(){var t=(0,r._)((function(t){var n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.sync()];case 1:if(r.sent(),e.requestId!==A)return[2];k=!0,(0,_.cY)("Event Fired: Result: "+e.result+" RequestId: "+e.requestId),n={FSuccess:!1};try{n=JSON.parse(e.result)}catch(e){(0,_.cY)("Error in parsing result event from applyJOfcCommandsAsync api",e.message),w.MP.getInstance().logError({eventType:w.S2.ChatEvents,errorMessage:"Error in parsing result event from applyJOfcCommandsAsync api, ".concat(e.message)})}return b=n,[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return t.sent(),[2]}}))})),O.apply(this,arguments)}function D(){return L.apply(this,arguments)}function L(){return(L=(0,r._)((function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,P.ue)((function(){return!1!==k?Promise.resolve():Promise.reject("Result event didn't received")}),p.KBj,1e3)];case 1:return e.sent(),[2]}}))}))).apply(this,arguments)}var R=function(e,t){var n;if("object"==typeof e){switch(e.type){case"regex":return new RegExp(e.regex);case"var":return t[e.name];case"scope":return e.name;case"string":case"color":case"enum":n=e.string;break;case"number":n=e.number;break;case"boolean":n=e.boolean;break;default:throw new Error("Unexpected complex type: ".concat(e.name))}if(void 0===n)throw new Error("Argument ".concat(e.toString()," not found"));return n}return e},F=n(39521),M=n(69038),B=n(37484),U=n(40389),z=n(73733),H=n(23343),G=null,V=null,j="JOfcCommands",q=g.K.getInstance(),W=0,Y=m.B.getInstance();function Q(e,t,n,r,o,i){return J.apply(this,arguments)}function J(){return J=(0,r._)((function(e,t,n,r,h,g){var y,v,S,C,b,E,T,P,A,k,x,N,O,D,L,Q,J,X,Z,$,te,re,ie,ae,se,le,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be,Ee,Te,we,Ie,Pe,_e,Ae,ke,xe,Ne,Oe,De,Le,Re,Fe,Me,Be,Ue,ze,He,Ge,Ve,je,qe,We;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:G=w.MP.getInstance(),V=w.ET.getInstance(G),y=1,v=!1,S=!1,C=[],b=[],E=null,T={},P={},A=-1,k=!1,x=!1,N=!1,O=[],D={},L=void 0,a.label=1;case 1:if(a.trys.push([1,17,,18]),(0,s.PA)(s.IY.IsMultipleGenerateSlidesCommandDisabled)&&(0,B.Dp)(t))throw new c.Jv("Multiple generateSlides is not supported");Q=!0,J=!1,X=void 0,a.label=2;case 2:a.trys.push([2,14,15,16]),Z=t[Symbol.iterator](),a.label=3;case 3:if(Q=($=Z.next()).done)return[3,13];if(te=$.value,++A,re="",ie=te.name,(0,s.PA)(s.IY.ShouldEnableCommandingTelemetry)&&(O.push(ie),(0,z.r4)(V,ie,y)),"imageInvalid"===te.name)throw L=d.zs.IMAGE_INVALID,new c.ng("Image is invalid");if((0,s.PA)(s.IY.HandleUnsupportedCommandErrorCode)&&"invalidRequest"===te.name)throw new c.do("Command is not supported");if(!l.includes(ie))throw new Error("Unexpected function name: ".concat(ie));if(!F.GP[ie])throw new Error("Function not implemented: ".concat(ie));if("formatText"===ie&&!(0,s.PA)(s.IY.IsFormatTextEnabled))throw new c.do("Format Text is not supported");if("insertText"===ie&&!(0,s.PA)(s.IY.IsAddTextEnabled))throw new c.do("Insert Text is not supported");if("insertImages"===ie&&!(0,s.PA)(s.IY.IsAddImageEnabled))throw new c.do("Insert image is not supported");if((0,s.PA)(s.IY.LogChatEventWhenPromptAndSourceInSingleGenerateSlides)&&"generateSlides"===ie&&(ae=(0,B.cN)(t,A,"source"),se=(0,B.cN)(t,A,"prompt"),ae&&se))throw m.B.getInstance().sendChatEventTelemetry((0,I.pN)((le={},(0,o._)(le,w.h3.ChatEventType,w.a5.CommandingSourceAndPromptInGenerates),(0,o._)(le,w.h3.ChatEventParameters,"SameGenerateStatement"),le))),new c.do("GenerateSlides with prompt and source in single generate statement is not supported.");if((0,s.PA)(s.IY.ShouldDisableAllCommandsAfterGenerateSlides))if("generateSlides"===ie)N=!0;else if(N)return[3,12];if("insertText"===ie&&!r&&f.Vv.IsSettingTrue(f.zj.PPTContentGenerationDisabledByAdmin))throw new c.k7("Content generation is disabled by admin");if(void 0!==te.dismissedArguments&&(v=!0,(0,s.PA)(s.IY.IsCommandingBlockedWithDismissedArgument)))throw L=d.zs.DISMISSED_ARGUMENTS,new c.ng("Dismissed Arguments");if(ce={},(0,B.CW)(ie,t,A))return[3,12];for(var Ye in ce.context=e,ue="",te.arguments)re+=Ye+",",(0,s.PA)(s.IY.ShouldEnableCommandingTelemetry)&&!(0,B.lu)(Ye)&&(ue+=Ye+","),ce[Ye]=R(te.arguments[Ye],P);return de=(0,B.EA)(ce,ie,t,A,P,x),ce=de.args,x=de.isTextReplaceCmd,re=re.slice(0,-1),(0,s.PA)(s.IY.ShouldEnableCommandingTelemetry)&&(D[ie]=ue.slice(0,-1)),ce.isFromOrganizePresentation=r,h&&(ce.groundingInfo=h),g&&(ce.chatConversations=g),pe=F.GP[ie],fe=(new Date).getTime(),[4,pe(ce)];case 4:return he=a.sent(),(0,B.Ho)(ie)&&(k=!0),"insertSlides"!==ie&&"insertImages"!==ie&&"moveSlides"!==ie&&"insertSection"!==ie?[3,11]:f.Vv.IsSettingTrue(f.zj.PPTCopilotScnCreatePresFromPrompt)&&he.name===u._u.CreatePresentationCmd?[4,ee(he,T)]:[3,6];case 5:he=a.sent(),a.label=6;case 6:return he.name!==u._u.CreatePresentationCmd?[3,8]:[4,ne(he)];case 7:he=a.sent(),a.label=8;case 8:return S||he.name!==u._u.AddSlidesCmd?[3,10]:(S=!0,[4,oe(he,T)]);case 9:he=a.sent(),a.label=10;case 10:if("moveSlides"===ie&&(0,i._)(he,Array)){ge=!0,me=!1,ye=void 0;try{for(ve=he[Symbol.iterator]();!(ge=(Se=ve.next()).done);ge=!0)Ce=Se.value,C.push(Ce)}catch(e){me=!0,ye=e}finally{try{ge||null==ve.return||ve.return()}finally{if(me)throw ye}}}else"insertImages"===ie&&"useOfficeJS"in ce&&!0===ce.useOfficeJS||C.push(he);a.label=11;case 11:if("selectShapes"===ie&&(0,s.PA)(s.IY.ShouldUseCreationIdsForShapeCommands)&&(he=(be=he).shapes,ce.shapeIds=be.shapeIds),C=(0,B.Fo)(C,he,ie,ce),"formatSlides"!==ie||null===he||"isVisible"in ce||("trigger"in he?E=he:b.push(he)),(0,s.bw)(s.WT.IsjOFCCommandingWorkflowEnabled)&&"formatShapes"===ie&&null!==he&&Array.isArray(he)){Ee=!0,Te=!1,we=void 0;try{for(Ie=he[Symbol.iterator]();!(Ee=(Pe=Ie.next()).done);Ee=!0)_e=Pe.value,C.push(_e)}catch(e){Te=!0,we=e}finally{try{Ee||null==Ie.return||Ie.return()}finally{if(Te)throw we}}}(0,_.cY)("Execution Completed "+ie+" Time Taken : "+(0,M.xJ)(fe)+" sec.  with args: ",ce),he&&Array.isArray(he)&&(0,_.cY)(ie+" returned "+he.length+" items"),V.updateTelemetryOfficeJSOperationData((Ae={},(0,o._)(Ae,w.Dh.OperationOrder,y),(0,o._)(Ae,w.Dh.EventState,"Success"),(0,o._)(Ae,w.Dh.OperationType,ie),(0,o._)(Ae,w.Dh.OperationParameters,re),(0,o._)(Ae,w.Dh.TimeDurationInMs,(0,M.xJ)(fe)),(0,o._)(Ae,w.Dh.OfficeJSApi,j),Ae)),ke=(0,s.PA)(s.IY.ShouldForceOfficeJSImplementationForCommanding),te.returns&&"formatSlides"!==ie&&"insertSlides"!==ie&&("insertImages"!==ie||ke)&&(P[te.returns]=he),"selectShapes"===ie&&(0,s.PA)(s.IY.ShouldUseCreationIdsForShapeCommands)&&"shapeIds"in ce&&(P.shapeIds=ce.shapeIds),y++,W+=(0,M.xJ)(fe),a.label=12;case 12:return Q=!0,[3,3];case 13:return[3,16];case 14:return xe=a.sent(),J=!0,X=xe,[3,16];case 15:try{Q||null==Z.return||Z.return()}finally{if(J)throw X}return[7];case 16:return[3,18];case 17:return Ne=a.sent(),Oe=null==Ne?void 0:Ne.message,(0,_.cY)("Execute statements failed:"+JSON.stringify(Ne)+" Error message: "+Oe),G.logError({eventType:w.S2.ChatEvents,errorMessage:"Execute statements failed Error message: "+Oe}),(0,i._)(Ne,c.do)?((0,z.wC)(V,O,w.by.Unsupported,D,Oe),(0,H.G)("UnsupportedCommandError"),(0,s.PA)(s.IY.HandleUnsupportedCommandErrorCode)?[2,{status:d.rI.UNSUPPORTED,error:d.Re.COMMANDING_DISABLED}]:[2,{status:d.rI.UNSUPPORTED}]):(0,i._)(Ne,c.Xo)?((0,z.wC)(V,O,w.by.Blocked,D,Oe),(0,H.G)("CreatePresentationBlockedError"),[2,{status:d.rI.BLOCKED,error:d.Re.CREATE_PRESENTATION_BLOCKED}]):(0,i._)(Ne,c.SU)?((0,z.wC)(V,O,w.by.Blocked,D,Oe),(0,H.G)("StructurePresentationBlockedError"),[2,{status:d.rI.BLOCKED,error:d.Re.STRUCTURE_PRESENTATION_BLOCKED}]):(0,i._)(Ne,c.k7)?((0,z.wC)(V,O,w.by.ContentGenerationDisabled,D,Oe),(0,H.G)("DisableContentGenerationError"),[2,{status:d.rI.CONTENT_GENERATION_DISABLED}]):(0,i._)(Ne,c.Lx)?((0,z.wC)(V,O,w.by.Failed,D,Oe),[2,{status:d.rI.PAUSED_ON_WARNING,error:d.Re.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING}]):(0,i._)(Ne,c.Wo)?((0,z.wC)(V,O,w.by.Failed,D,Oe),[2,{status:d.rI.PAUSED_ON_WARNING,error:d.Re.LAUNCH_NB_TO_CREATE_PRESENTATION}]):(0,i._)(Ne,c.uB)?((0,z.wC)(V,O,w.by.Failed,D,Oe),[2,{status:d.rI.PAUSED_ON_WARNING,error:d.Re.CREATE_PRESENTATION_BLOCKED_ON_WARNING}]):(0,i._)(Ne,c.ng)?((0,z.wC)(V,O,w.by.DismissedCommand,D,Oe),(0,H.G)("CommandExecutionDismissedError"),L===d.zs.IMAGE_INVALID?[2,{status:d.rI.DISMISSED,error:d.Re.IMAGE_INVALID_ODSL}]:[2,{status:d.rI.DISMISSED}]):(0,s.PA)(s.IY.IsStoryTellerBlockedWithEmptyPrompt)&&(0,i._)(Ne,c.zw)?((0,z.wC)(V,O,w.by.Unsupported,D,Oe),(0,H.G)("AddSlidePromptUndefinedButSourceDefinedError"),[2,{status:d.rI.BLOCKED,error:d.Re.ADD_SLIDE_BLOCKED}]):(0,i._)(Ne,c.Jv)?((0,z.wC)(V,O,w.by.Unsupported,D,Oe),(0,H.G)("UnsupportedCommandError"),[2,{status:d.rI.UNSUPPORTED,error:d.Re.MULTIPLE_GENERATE_IN_ODSL}]):((0,z.wC)(V,O,w.by.Failed,D,Oe),(0,H.G)("ODSLExecution_Unknown"),[2,{status:d.rI.FAILED}]);case 18:De=(new Date).getTime(),a.label=19;case 19:return a.trys.push([19,22,,23]),0===C.length&&0===b.length&&null===E?[3,21]:(b.length>0?(Le={trigger:u._E.None,slideHints:b},T.designerOptions=JSON.stringify(Le)):null!==E?T.designerOptions=JSON.stringify(E):!0===k&&(Re={trigger:u._E.None},T.designerOptions=JSON.stringify(Re)),Fe={scenarioName:q.getScenarioName(),startTime:q.getStartTime(),entryPoint:p.$kB.Chat,correlationId:Y.getQueryGuid(),timeToODSLMS:1e3*q.getResponseTime(),timeODSLToJOfcMS:W,capability:q.getCapability(),featureName:q.getFeatureName(),subFeatureName:q.getSubFeatureName()},T.scenarioOptions=JSON.stringify(Fe),(0,U.dD)()?n(!0):n(!1),[4,K(e,C,T)]);case 20:return Me=a.sent(),Be=(0,M.xJ)(De),(0,z.dv)(V,O,Me.status,D,W+Be),(0,s.PA)(s.IY.IsJofcCommandErrorTelemetryEnabled)&&Me.status!==d.rI.SUCCESS&&Y.sendChatEventTelemetry((0,I.pN)((ze={},(0,o._)(ze,w.h3.ChatEventType,w.a5.CopilotODSLJOfcCommandsError),(0,o._)(ze,w.h3.ChatEventParameters,d.Re[null!==(Ue=Me.error)&&void 0!==Ue?Ue:d.Re.UNKNOWN_ERROR]),ze))),[2,Me];case 21:return[3,23];case 22:return He=a.sent(),Ge=null==He?void 0:He.message,(0,_.cY)("callApplyJOfcCommandsApi failed:"+JSON.stringify(He)+" Error message: "+Ge),G.logError({eventType:w.S2.ChatEvents,errorMessage:"Execute statements callApplyJOfcCommandsApi failed Error message: "+Ge}),(0,z.wC)(V,O,w.by.Failed,D,Ge),Ve={status:d.rI.FAILED,error:d.Re.JOFC_EXCEPTION},(0,s.PA)(s.IY.IsJofcCommandErrorTelemetryEnabled)&&Ve.status!==d.rI.SUCCESS&&Y.sendChatEventTelemetry((0,I.pN)((qe={},(0,o._)(qe,w.h3.ChatEventType,w.a5.CopilotODSLJOfcCommandsError),(0,o._)(qe,w.h3.ChatEventParameters,d.Re[null!==(je=Ve.error)&&void 0!==je?je:d.Re.UNKNOWN_ERROR]),qe))),[2,Ve];case 23:return We=(0,M.xJ)(De),v?((0,z.e9)(V,O,D,W+We,!0),[2,{status:d.rI.PARTIAL_SUCCESS}]):((0,z.e9)(V,O,D,W+We,!1),[2,{status:d.rI.SUCCESS}])}}))})),J.apply(this,arguments)}var X=function(){var e=(0,r._)((function(e,t,n,r){var i,l,c,u,f,g;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i=(new Date).getTime(),(0,U.dD)()&&y.R.getInstance().setState(d.Nj.EXECUTING_APPLYJOFC_PROTOCOL),(0,_.cY)("officeJsPayload for applyJOfcCommands API",t),(0,_.cY)("designerOptions for applyJOfcCommands API",n.designerOptions),(0,_.cY)("scenarioOptions for applyJOfcCommands API",n.scenarioOptions),(0,_.cY)("selectionOptions for applyJOfcCommands API",n.selectionOptions),(0,_.cY)("viewActions for applyJOfcCommands API",r),h.i.GetHostAppPlatform()===p.xb6||h.i.GetHostAppPlatform()===p.nAd||(0,s.PA)(s.IY.UseApplyJOfcCommandsAsyncForiOS)&&h.i.GetHostAppPlatform()===p.TTX?[4,x(e,t,n,r)]:[3,2];case 1:return l=a.sent(),[3,4];case 2:return[4,Z($(e,t,n,r),p.PGy)];case 3:l=a.sent(),a.label=4;case 4:return(0,_.cY)("Execution Completed applyJOfcCommands Time Taken : "+(0,M.WU)(i)+" sec. return result: ",JSON.stringify(l)),(0,s.PA)(s.IY.LogChatEventWhenMakingAJOFCCall)&&(c="applyJOfcCommand_".concat(l.FSuccess?"Success":"Failure"),m.B.getInstance().sendChatEventTelemetry((0,I.pN)((u={},(0,o._)(u,w.h3.ChatEventType,w.a5.JOFCCommandExecuted),(0,o._)(u,w.h3.ChatEventParameters,c),u)))),null==V||V.updateTelemetryOfficeJSOperationData((f={},(0,o._)(f,w.Dh.EventState,l.FSuccess?"Success":"Failure"),(0,o._)(f,w.Dh.OperationType,"applyJOfcCommands"),(0,o._)(f,w.Dh.OperationParameters,""),(0,o._)(f,w.Dh.TimeDurationInMs,(0,M.xJ)(i)),(0,o._)(f,w.Dh.OfficeJSApi,j),f)),g=function(e){return ae.apply(this,arguments)}(l),[2,g]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),K=function(){var e=(0,r._)((function(e,t,n,r){var o,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return i={cmds:t},o=t.length>0?JSON.stringify(i):"",[4,X(e,o,n,r)];case 1:return[2,a.sent()]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),Z=function(){var e=(0,r._)((function(e,t){var n,r,o,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=new Promise((function(e,r){n=setTimeout((function(){r("Timeout after ".concat(t," ms}"))}),t)})),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.race([e,r])];case 2:return o=a.sent(),clearTimeout(n),[2,o];case 3:return i=a.sent(),clearTimeout(n),(0,_.cY)("execution of applyJOfcCommands",i),[2,{FSuccess:!1}];case 4:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=(0,r._)((function(e,t,n,r){var o,i,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return(0,_.cY)("applyJOfcCommands Payload string: "+t),(0,_.cY)("CopilotAction API supported and using : true"),i={scenarioOptions:n.scenarioOptions?JSON.parse(n.scenarioOptions):void 0,designerOptions:n.designerOptions?JSON.parse(n.designerOptions):void 0,selectionOptions:n.selectionOptions?JSON.parse(n.selectionOptions):void 0},t&&t.length>0&&(i.jOfcCommands=JSON.parse(t)),(0,s.bw)(s.WT.isViewActionForCopilotActionAsyncAPIEnabled)&&r&&(i.viewAction=r),o=e.presentation.copilotAction(p.crT,JSON.stringify(i)),[4,e.sync()];case 1:a.sent(),(0,_.cY)("applyJOfcCommands Result: "+JSON.stringify(o.value)),l={FSuccess:!1};try{l=JSON.parse(o.value)}catch(e){(0,_.cY)("Error while parsing applyJOfcCommands Result: ",e.message),G.logError({eventType:w.S2.ChatEvents,errorMessage:"Error while parsing applyJOfcCommands Result, ".concat(e.message)})}return[2,l]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}();function ee(e,t){return te.apply(this,arguments)}function te(){return(te=(0,r._)((function(e,t){var n,r,o,i,s,l,c;return(0,a.__generator)(this,(function(a){return i=[],(null===(r=e.data)||void 0===r||null===(n=r.slides)||void 0===n?void 0:n.length)>0&&(e.data.slides[0].slideMoniker?o=e.data.slides[0].slideMoniker:((o=C.generateNewSlideMoniker()).id=C.minId,e.data.slides[0].slideMoniker=o),(s={})[u.k2.CanReplaceImageWithLoopingVideo]="true",l={target:o,hints:s},i.push(l),c={trigger:u._E.DocumentChanges,slideHints:i},t.designerOptions=JSON.stringify(c)),[2,e]}))}))).apply(this,arguments)}function ne(e){return re.apply(this,arguments)}function re(){return(re=(0,r._)((function(e){var t,n,r;return(0,a.__generator)(this,(function(o){return(null===(n=e.data)||void 0===n||null===(t=n.slides)||void 0===t?void 0:t.length)>0&&(r={isTitleLayout:!0},e.data.slides[0].layoutInfo=r),[2,e]}))}))).apply(this,arguments)}function oe(e,t){return ie.apply(this,arguments)}function ie(){return(ie=(0,r._)((function(e,t){var n,r,o,i,s;return(0,a.__generator)(this,(function(a){return(null===(r=e.data)||void 0===r||null===(n=r.slides)||void 0===n?void 0:n.length)>0&&(e.data.slides[0].slideMoniker?o=e.data.slides[0].slideMoniker:(o=C.generateNewSlideMoniker(!1),e.data.slides[0].slideMoniker=o),i={slideMonikerList:[o]},s={selectionType:u.hO.Slide,data:i},t.selectionOptions=JSON.stringify(s)),[2,e]}))}))).apply(this,arguments)}function ae(){return(ae=(0,r._)((function(e){var t;return(0,a.__generator)(this,(function(n){if(t={status:d.rI.FAILED},!e.JOfcCommandStatusCode)return t.status=e.FSuccess?d.rI.SUCCESS:d.rI.FAILED,[2,t];switch(e.JOfcCommandStatusCode){case u.rX.CompletedStatusCode:t.status=d.rI.SUCCESS,e.Thumbnails&&(t.payload={jOfcApiResult:e});break;case u.rX.DisabledStatusCode:t.status=d.rI.BLOCKED,t.error=d.Re.DESIGNER_DISABLED;break;case u.rX.ErrorStatusCode:e.JOfcCommandErrorReason&&e.JOfcCommandErrorReason===u.wD.UnexpectedVersion?t.status=d.rI.UNEXPECTED_VERSION:(t.status=d.rI.FAILED,e.JOfcCommandErrorReason&&(t.error=se(e.JOfcCommandErrorReason)));break;case u.rX.CompletedWithErrorsStatusCode:e.JOfcCommandErrorReason&&e.JOfcCommandErrorReason===u.wD.UnexpectedVersion?t.status=d.rI.UNEXPECTED_VERSION:(t.status=d.rI.PARTIAL_SUCCESS,e.JOfcCommandErrorReason&&(t.error=se(e.JOfcCommandErrorReason)));break;case u.rX.UserAbortedStatusCode:t.status=d.rI.USER_ABORTED}return[2,t]}))}))).apply(this,arguments)}function se(e){var t=d.Re.UNKNOWN_ERROR;switch(e){case u.wD.DesignerFailed_Deprecated:t=d.Re.DESIGNER_FAILED;break;case u.wD.ContentInsertionFailed:(0,s.PA)(s.IY.ShowErrorIfContentInsertionFailed)&&(t=d.Re.CREATE_PRESENTATION_BLOCKED);break;case u.wD.DesignerFailedAlreadyHasAnimation:(0,s.PA)(s.IY.ShowErrorIfAnimationAlreadyExists)&&(t=d.Re.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS);break;case u.wD.ApplyCLPLabelFailed:(0,s.PA)(s.IY.IsApplyCLPLabelErrorChangeEnabled)&&(t=d.Re.APPLY_CLP_LABEL_FAILED);break;case u.wD.UnexpectedVersion:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.UNEXPECTED_VERSION);break;case u.wD.DocumentChangedBeforeCommandExecution:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.DOCUMENT_CHANGED_BEFORE_COMMAND_EXECUTION);break;case u.wD.CommandHadNoEffect:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.COMMAND_HAD_NO_EFFECT);break;case u.wD.ParseDesignerOptionsFailed:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.PARSE_DESIGNER_OPTIONS_FAILED);break;case u.wD.FetchDesignSuggestionFailed:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.FETCH_DESIGN_SUGGESTION_FAILED);break;case u.wD.ApplyDesignSuggestionFailed:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.APPLY_DESIGN_SUGGESTION_FAILED);break;case u.wD.PrepDesignInputFailed:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.PREP_DESIGN_INPUT_FAILED);break;case u.wD.DocClosingWithIncompleteProtocol:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.DOC_CLOSING_WITH_INCOMPLETE_PROTOCOL);break;case u.wD.FetchDesignSuggestionPartialSuccess:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.FETCH_DESIGN_SUGGESTION_PARTIAL_SUCCESS);break;case u.wD.PrepareStageTimedOut:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.PREPARE_STAGE_TIMED_OUT);break;case u.wD.EmptyJOfcCmdResultId:(0,s.PA)(s.IY.IsAllPptCommandErrorLogEnabled)&&(t=d.Re.EMPTY_JOFC_CMD_RESULT_ID);case u.wD.Unknown:}return t}},37484:(e,t,n)=>{"use strict";n.d(t,{CW:()=>c,Dp:()=>u,EA:()=>s,Fo:()=>p,Ho:()=>f,cN:()=>l,lu:()=>d});var r=n(55564),o=n(39041);function i(e,t,n){return t<e.length-1&&e[t+1].name===n}function a(e,t,n){return t>0&&e[t-1].name===n}function s(e,t,n,o,s,l){if((0,r.bw)(r.WT.IsjOFCCommandingWorkflowEnabled)&&("insertText"===t&&a(n,o,"deleteText")?(e.isReplaceTextCmd=!0,l=!0):"formatText"===t&&a(n,o,"selectIndicesText")&&(e.useOfficeJS=!0)),(0,r.PA)(r.IY.ShouldForceOfficeJSImplementationForCommanding)){var c=("insertImages"===t||"insertShapes"===t)&&i(n,o,"formatShapes"),u="formatShapes"===t&&(a(n,o,"insertImages")||a(n,o,"insertShapes")),d=!l&&"formatText"===t&&a(n,o,"insertText");(c||u||d)&&(e.useOfficeJS=!0)}return"insertText"===t&&a(n,o,"deleteText")&&(e.insertBeforeSelection=!0),"slides"in s&&("selectShapes"!==t||"slides"in e?"selectSlides"===t&&(a(n,o,"selectSlides")?e.slides=s.slides:delete e.slides):e.slides=s.slides),(0,r.PA)(r.IY.ShouldUseCreationIdsForShapeCommands)&&"shapeIds"in s&&(e.shapeIds=s.shapeIds),{args:e,isTextReplaceCmd:l}}function l(e,t,n){return!(0,o.hX)(n)&&0!==n.length&&(t<e.length&&"generateSlides"===e[t].name&&n in e[t].arguments)}function c(e,t,n){return!(!(0,r.bw)(r.WT.IsjOFCCommandingWorkflowEnabled)||"deleteText"!==e||!i(t,n,"insertText"))||!!((0,r.PA)(r.IY.ChooseGenerateWithSourceOverPrompt)&&"generateSlides"===e&&((0,r.PA)(r.IY.LogChatEventWhenPromptAndSourceInSingleGenerateSlides)&&l(t,n,"prompt")||!(0,r.PA)(r.IY.LogChatEventWhenPromptAndSourceInSingleGenerateSlides)&&function(e,t){return t<e.length&&"generateSlides"===e[t].name&&"prompt"in e[t].arguments}(t,n))&&function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if("generateSlides"===a.name&&"source"in a.arguments)return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!1}(t))}function u(e){var t=0,n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){if("generateSlides"===i.value.name&&++t>1)return!0}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!1}function d(e){return"context"===e||"slides"===e||"shapes"===e||"images"===e||"textRanges"===e}function p(e,t,n,o){if((0,r.bw)(r.WT.IsjOFCCommandingWorkflowEnabled)||"insertTables"===n)switch(n){case"formatText":var i=!0,a=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;e.push(u)}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}break;case"formatSlides":"isVisible"in o&&e.push(t);break;case"deleteSlides":case"setFooters":case"transitionSlides":e.push(t);break;case"insertText":if("isReplaceTextCmd"in o){var d=!0,p=!1,f=void 0;try{for(var h,g=t[Symbol.iterator]();!(d=(h=g.next()).done);d=!0){var m=h.value;e.push(m)}}catch(e){p=!0,f=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw f}}}break;case"formatList":case"insertList":case"insertTables":var y=!0,v=!1,S=void 0;try{for(var C,b=t[Symbol.iterator]();!(y=(C=b.next()).done);y=!0){var E=C.value;e.push(E)}}catch(e){v=!0,S=e}finally{try{y||null==b.return||b.return()}finally{if(v)throw S}}}return e}function f(e){return"setFooters"===e||"insertTables"===e}},39521:(e,t,n)=>{"use strict";n.d(t,{sW:()=>U.sW,GP:()=>Te,cd:()=>pe.cd,Ce:()=>pe.Ce});var r=n(43032),o=n(79490),i=(n(2242),n(84505)),a=n(31510),s=n(99374),l=n(59e3),c=n(55564),u=n(44121),d=n(14213),p=n(91532),f=n(18758),h=n(1134),g=n(39041),m=n(72218);function y(e,t){return(e<<5>>>0)+e+t.charCodeAt(0)>>>0}function v(e,t){return S.apply(this,arguments)}function S(){return(S=(0,r._)((function(e,t){var n,r,i,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n=e.getParentTextFrame(),(r=n.textRange).load("text"),[4,t.sync()];case 1:return o.sent(),i=r.text+"\r",[2,function(e){var t=0;if(e.length){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)t=y(t,i.value)}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}return t}(i)];case 2:return a=o.sent(),(0,f.cY)("Exception while computing hash for text range - "+a.toString()),[2,-1];case 3:return[2]}}))}))).apply(this,arguments)}function C(e,t){return b.apply(this,arguments)}function b(){return(b=(0,r._)((function(e,t){var n,r,i,a,s,l,c,u,d,p,f,h,g,m,y,S,C,b,E;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:n=[],r=!0,i=!1,a=void 0,o.label=1;case 1:o.trys.push([1,10,11,12]),s=e[Symbol.iterator](),o.label=2;case 2:return(r=(l=s.next()).done)?[3,9]:(c=l.value,(u=c.getParentTextFrame().getParentShape()).load("id"),(d=u.getParentSlide()).load("id"),[4,t.sync()]);case 3:return o.sent(),p=d.id.split("#"),f=+p[0],h=+p[1],c.load("start"),c.load("length"),[4,t.sync()];case 4:return o.sent(),g=c.start,-1!==(m=c.length)?[3,6]:(y=c.getParentTextFrame(),(S=y.textRange).load("text"),[4,t.sync()]);case 5:o.sent(),m=S.text.length-g,o.label=6;case 6:return[4,v(c,t)];case 7:if(-1===(C=o.sent()))return[3,8];b={slideId:{id:f,cId:h},shapeId:{id:+u.id},start:g,length:m,hash:C},n.push(b),o.label=8;case 8:return r=!0,[3,2];case 9:return[3,12];case 10:return E=o.sent(),i=!0,a=E,[3,12];case 11:try{r||null==s.return||s.return()}finally{if(i)throw a}return[7];case 12:return[2,n]}}))}))).apply(this,arguments)}function E(e,t,n,r,o,i,a,s,l,c,d,m){var y={};try{if((0,g.hX)(e)||(y.bold=e),(0,g.hX)(t)||(y.italic=t),(0,g.hX)(n)||(y.normalize=n),(0,g.hX)(r)||(y.underline=function(e){switch(e){case"None":default:return u.GH.noUnderline;case"Single":return u.GH.singleLine;case"Words":return u.GH.words;case"Double":return u.GH.doubleLine;case"Heavy":return u.GH.heavyLine;case"Dotted":return u.GH.dottedLine;case"DottedHeavy":return u.GH.dottedHeavyLine;case"Dash":return u.GH.dashLine;case"DashHeavy":return u.GH.dashHeavyLine;case"DashLong":return u.GH.dashLongLine;case"DotDash":return u.GH.dotDashLine;case"DotDashHeavy":return u.GH.dotDashHeavyLine;case"DashLongHeavy":return u.GH.dashLongHeavyLine;case"Wavy":return u.GH.wavyLine;case"WavyHeavy":return u.GH.wavyHeavyLine;case"WavyDouble":return u.GH.wavyDoubleLine;case"DotDotDash":return u.GH.dotDotDashLine;case"DotDotDashHeavy":return u.GH.dotDotDashHeavyLine}}(r)),!(0,g.hX)(o))if(!0===o||!1===o)y.strike=Number(o);else{var v=o.toLowerCase();v in p.BM&&(y.strike=p.BM[v])}if(!(0,g.hX)(i)){var S=i.toLowerCase();S in p.l1&&(y.caps=p.l1[S])}if((0,g.hX)(a)||(y.fontSize=a),(0,g.hX)(s)||(y.spacing=s),(0,g.hX)(l)||(y.lang=l),(0,g.hX)(c)||(y.font=c),!(0,g.hX)(d)){var C=(0,h.j5)(d);(0,g.hX)(C)||(y.fill={solid:C})}if(!(0,g.hX)(m)){var b=(0,h.j5)(m);(0,g.hX)(b)||(y.highlight=b)}return y}catch(e){throw(0,f.cY)("Exception while parsing the program for OfficeJsPayload Json - "+e.toString()),new Error("Exception while parsing the program for OfficeJsPayload Json ")}}function T(e,t,n){if((0,c.PA)(c.IY.ShouldEnableTextRangeInJOFCCommands))return function(e,t,n){var r={range:{pos:t.start,len:t.length},hash:t.hash},o={target:{slideId:t.slideId,shapeId:t.shapeId,stableRange:r},props:n};return{name:e,version:u.xv,data:o}}(e,t,n);var r={slideId:t.slideId,shapeId:t.shapeId,props:n};return{name:e,version:u.xv,data:r}}function w(e){return I.apply(this,arguments)}function I(){return(I=(0,r._)((function(e){var t,n,r,i,a,s,l,c,d,p,h,y,v,S,b,w,I,P,_,A,k,x,N,O,D,L,R,F,M,B,U;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.textRanges,n=e.context,r=e.bold,i=e.italic,a=e.normalize,s=e.underline,l=e.strike,c=e.caps,d=e.fontSize,p=e.spacing,h=e.lang,y=e.fontName,v=e.color,S=e.bulleted,b=e.horizontalAlignment,e.verticalAlignment,w=e.highlight,o.label=1;case 1:return o.trys.push([1,3,,4]),I=[],[4,C(t,n)];case 2:P=o.sent(),_=E(r,i,a,s,l,c,d,p,h,y,v,w),A=function(e){var t={};if(!(0,g.hX)(e))switch(e){case"Left":t.align=u.Yu.AlignLeft;break;case"Center":t.align=u.Yu.AlignCenter;break;case"Right":t.align=u.Yu.AlignRight;break;case"Justify":t.align=u.Yu.AlignJustify;break;case"JustifyLow":t.align=u.Yu.AlignJustifyLow;break;case"Distributed":t.align=u.Yu.AlignDistributed;break;case"ThaiDistributed":t.align=u.Yu.AlignThaiDistributed}return t}(b),k=!0,x=!1,N=void 0;try{for(O=P[Symbol.iterator]();!(k=(D=O.next()).done);k=!0)L=D.value,Object.keys(_).length>0&&(R=T(u._u.ModifyTextPropsCmd,L,_),I.push(R)),Object.keys(A).length>0&&(F=T(u._u.ModifyParaPropsCmd,L,A),I.push(F)),(0,g.hX)(S)||((M={}).bulletSize=m.bRk,M.bulletProp=S?{char:m.mbC}:{},B=T(u._u.ModifyParaPropsCmd,L,M),I.push(B))}catch(e){x=!0,N=e}finally{try{k||null==O.return||O.return()}finally{if(x)throw N}}return[2,I];case 3:throw U=o.sent(),(0,f.cY)("Exception while parsing the program for format_text OfficeJsPayload Json - "+U.toString()),new Error("Exception while parsing the program for format_text OfficeJsPayload Json ");case 4:return[2]}}))}))).apply(this,arguments)}var P=d.K.getInstance();function _(e){return A.apply(this,arguments)}function A(){return(A=(0,r._)((function(e){var t,n,r,i,a,s,l,c,d,p,h,g,m,y,v,S,C,b,E;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.textRanges,r=e.bold,i=e.italic,a=e.normalize,s=e.underline,l=e.strike,c=e.caps,d=e.fontSize,p=e.spacing,h=e.lang,g=e.fontName,m=e.color,y=e.bulleted,v=e.horizontalAlignment,S=e.verticalAlignment,C=e.highlight,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,w({context:t,textRanges:n,bold:r,italic:i,normalize:a,underline:s,strike:l,caps:c,fontSize:d,spacing:p,lang:h,fontName:g,color:m,bulleted:y,horizontalAlignment:v,verticalAlignment:S,highlight:C})];case 2:return b=o.sent(),P.setScenarioName(u.Cu.FormatText),[2,b];case 3:throw E=o.sent(),(0,f.cY)("Exception while parsing the program for format_text OfficeJsPayload Json - "+E.toString()),new Error("Exception while parsing the program for format_text OfficeJsPayload Json ");case 4:return[2]}}))}))).apply(this,arguments)}var k=d.K.getInstance();function x(e){return N.apply(this,arguments)}function N(){return(N=(0,r._)((function(e){var t,n,r,i,a,s,l,c,d,p,m,y,v,S,C;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.textRanges,r=e.text,i=e.textFormat,a=void 0===i?0:i,o.label=1;case 1:return o.trys.push([1,3,,4]),s=[],[4,(0,h.Z$)(n,t)];case 2:l=o.sent(),r=(0,g.WM)(r),c=!0,d=!1,p=void 0;try{for(m=l[Symbol.iterator]();!(c=(y=m.next()).done);c=!0)v=y.value,(0,g.hX)(v.shapeId)||(0,g.hX)(v.slideId)||(S={version:u.xv,name:u._u.ReplaceTextCmd,data:{text:r,textFormat:a,shapeId:v.shapeId,slideId:v.slideId}},s.push(S))}catch(e){d=!0,p=e}finally{try{c||null==m.return||m.return()}finally{if(d)throw p}}return k.setScenarioName(u.Cu.ReplaceText),[2,s];case 3:throw C=o.sent(),(0,f.cY)("Exception while parsing the program for OfficeJsPayload Json - "+C.toString()),new Error("Exception while parsing the program for OfficeJsPayload Json ");case 4:return[2]}}))}))).apply(this,arguments)}var O=n(2061),D=n(33969);function L(e){return R.apply(this,arguments)}function R(){return(R=(0,r._)((function(e){var t,n,r,i,a,s,p,f,m,y,v,S,C,b,E,T,w,I,P,A,k,x,N,D,L,R,F,M,B;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(t=e.context,n=e.textRanges,r=e.color,i=void 0===r?null:r,a=e.bold,s=void 0===a?null:a,p=e.italic,f=void 0===p?null:p,m=e.strikethrough,y=void 0===m?null:m,v=e.underline,S=void 0===v?null:v,C=e.fontName,b=void 0===C?null:C,E=e.size,T=void 0===E?null:E,w=e.bulleted,I=void 0===w?null:w,P=e.horizontalAlignment,A=void 0===P?null:P,k=e.verticalAlignment,x=void 0===k?null:k,N=e.casing,D=void 0===N?null:N,L=e.highlightColor,R=void 0===L?null:L,F=e.useOfficeJS,M=void 0!==F&&F,(0,g.hX)(n)||0===n.length)throw(0,O.cY_)("No text range found format text"),new Error("No text range found for format text");return B=(0,h.Tq)(u.iz),d.K.getInstance().setScenarioName(u.Cu.FormatText),(0,c.bw)(c.WT.IsjOFCCommandingWorkflowEnabled)&&((0,g.hX)(M)||!0!==M)&&B?[3,2]:[4,(0,l.vX)({context:t,textRanges:n,color:i,bold:s,italic:f,underline:S,fontName:b,size:T,bulleted:I,horizontalAlignment:A,verticalAlignment:x})];case 1:return o.sent(),[2,[]];case 2:return[4,_({context:t,textRanges:n,bold:s,italic:f,normalize:null,underline:S,strike:y,caps:D,fontSize:T,spacing:null,lang:null,fontName:b,horizontalAlignment:A,verticalAlignment:x,bulleted:I,color:i,highlight:R})];case 3:return[2,o.sent()]}}))}))).apply(this,arguments)}function F(e){return M.apply(this,arguments)}function M(){return(M=(0,r._)((function(e){var t,n,r,i,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=e.context,n=e.precededBy,r=e.text,i=e.isReplaceTextCmd,a=e.insertBeforeSelection,(0,c.bw)(c.WT.IsjOFCCommandingWorkflowEnabled)&&!(0,g.hX)(i)&&i?[3,2]:[4,(0,l.bc)({context:t,precededBy:n,text:r,insertBeforeSelection:a})];case 1:return[2,o.sent()];case 2:if(!(0,h.Tq)(u.bg))throw new D.do("Unsupported jOFC command");return[4,x({context:t,textRanges:n,text:r,textFormat:0})];case 3:return[2,o.sent()]}}))}))).apply(this,arguments)}var B=n(72230),U=n(65817),z=n(10480),H=n(58651),G=12700;function V(e,t,n,r,o,i,a){return j.apply(this,arguments)}function j(){return(j=(0,r._)((function(e,t,n,r,i,a,s){var l,u,d,p;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,(0,h.pR)(e,t)];case 1:return l=o.sent(),[4,(0,h.NR)(e,t)];case 2:return u=o.sent(),d=function(e,t,n,r){var o={};return(0,g.hX)(e)||(o.x=(null!=e?e:0)*G),(0,g.hX)(t)||(o.y=(null!=t?t:0)*G),(0,g.hX)(n)||(o.cy=(null!=n?n:0)*G),(0,g.hX)(r)||(o.cx=(null!=r?r:0)*G),o}(r,i,a,s),0===Object.keys(d).length?[2,null]:(p={shapeId:{id:+u.id},slideId:{id:+l.id,cId:+l.cId},props:d},(0,c.PA)(c.IY.ShouldUseCreationIdsForShapeCommands)&&+l.id in n&&+u.id in n[+l.id]&&p.shapeId&&(p.shapeId.cId=n[+l.id][+u.id]),[2,p])}}))}))).apply(this,arguments)}function q(e){switch(e){case"Front":default:return u.DR.BringToFront;case"Back":return u.DR.SendToBack;case"Forward":return u.DR.BringForward;case"Backward":return u.DR.SendBackward}}function W(e,t,n,r){return Y.apply(this,arguments)}function Y(){return(Y=(0,r._)((function(e,t,n,r){var i,a,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,(0,h.pR)(e,t)];case 1:return i=o.sent(),[4,(0,h.NR)(e,t)];case 2:return a=o.sent(),s={shapeId:{id:+a.id},slideId:{id:+i.id,cId:+i.cId},orderMode:q(r)},(0,c.PA)(c.IY.ShouldUseCreationIdsForShapeCommands)&&+i.id in n&&+a.id in n[+i.id]&&(s.shapeId.cId=n[+i.id][+a.id]),[2,s]}}))}))).apply(this,arguments)}function Q(e,t,n,r,o,i){return J.apply(this,arguments)}function J(){return(J=(0,r._)((function(e,t,n,r,i,a){var s,l,c;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(0===t.length)throw H.error("No shapes selected"),new Error("No shapes selected");return[4,(0,h.pR)(e,t[0])];case 1:return s=o.sent(),[4,(0,h.a8)(e,t)];case 2:return l=o.sent(),c={slideId:{id:+s.id,cId:+s.cId},shapeIds:l},(0,g.hX)(n)?(0,g.hX)(r)||(c.alignMode=u.gl.has(r)?u.gl.get(r):4):c.alignMode=u.gl.has(n)?u.gl.get(n):0,(0,g.hX)(i)||(c.distributeMode=u.lC.has(i)?u.lC.get(i):0),c.relativeToSelection=l.length>=2,[2,c]}}))}))).apply(this,arguments)}function X(e,t){var n=1;return(0,g.hX)(t)||(n=1-(null!=t?t:0)/100),(0,h.j5)(e,n)}function K(e,t,n,r,o,i,a,s,l,c,u){var d={};if((0,g.hX)(e)||(d.rad=(null!=e?e:0)*G),!(0,g.hX)(t)){var f=X(t,o);(0,g.hX)(f)||(d.clr=f)}return(0,g.hX)(n)||(d.dis=(null!=n?n:0)*G),(0,g.hX)(r)||(d.dir={deg:r}),(0,g.hX)(i)||(d.sx=i),(0,g.hX)(a)||(d.sy=a),(0,g.hX)(s)||(d.kx=s),(0,g.hX)(l)||(d.ky=l),(0,g.hX)(c)?d.align=void 0:(null!=c?c:"")in p.su&&(d.align=p.su[null!=c?c:""]),(0,g.hX)(u)||(d.rotWithShape=u),d}function Z(e,t,n,r,o,i,a,s,l,c,u,d){var f={},h={};switch(null==e?void 0:e.toLowerCase()){case"inner":h=function(e,t,n,r,o){var i={};if((0,g.hX)(e)||(i.rad=(null!=e?e:0)*G),!(0,g.hX)(t)){var a=X(t,o);(0,g.hX)(a)||(i.clr=a)}return(0,g.hX)(n)||(i.dis=(null!=n?n:0)*G),(0,g.hX)(r)||(i.dir={deg:r}),i}(s,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0),0!==Object.keys(h).length&&(f.inShdw=h);break;case"outer":h=K(s,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0,null!=o?o:void 0,i,a,void 0,void 0,n,!0),0!==Object.keys(h).length&&(f.outShdw=h);break;case"perspective":h=function(e,t,n,r,o){var i={};if((0,g.hX)(e)||(null!=e?e:"")in p.fx&&(i.prst=p.fx[null!=e?e:""]),!(0,g.hX)(t)){var a=X(t,o);(0,g.hX)(a)||(i.clr=a)}return(0,g.hX)(n)||(i.dis=(null!=n?n:0)*G),(0,g.hX)(r)||(i.dir={deg:r}),i}(null!=t?t:void 0,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0),0!==Object.keys(h).length&&(f.prstShdw=h);break;default:h=K(s,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0),0!==Object.keys(h).length&&(f.outShdw=h)}return f}function $(e,t,n,r,o,i,a,s,l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T){return ee.apply(this,arguments)}function ee(){return(ee=(0,r._)((function(e,t,n,r,i,a,s,l,c,u,d,f,h,m,y,v,S,C,b,E,T,w,I,P){var _,A,k,x,N;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return _={},t.load("type"),[4,e.sync()];case 1:return n.sent(),A=function(e){var t={};if(!(0,g.hX)(e)){var n=e.toLowerCase();n in p.w7&&(t.prst=p.w7[n])}return t}(t.type),0!==Object.keys(A).length&&(_.geo=A),k=function(e,t){var n={};if(!(0,g.hX)(e)){var r=X(e,t);(0,g.hX)(r)||(n.solid=r)}return n}(d,f),0!==Object.keys(k).length&&(_.fill=k),x=function(e,t,n,r){var o={};if(!(0,g.hX)(e)){var i=X(e,r);if(!(0,g.hX)(i)){var a={solid:i};o.fill=a}}return(0,g.hX)(n)||(o.width=n*G),o}(s,0,c,u),0!==Object.keys(x).length&&(_.line=x),N=Z(h,m,y,v,S,C,b,E,0,0,I,P),0!==Object.keys(N).length&&(_.fx=N),[2,_]}}))}))).apply(this,arguments)}function te(e,t,n,r,o,i,a,s,l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w){return ne.apply(this,arguments)}function ne(){return(ne=(0,r._)((function(e,t,n,r,i,a,s,l,u,d,p,f,g,m,y,v,S,C,b,E,T,w,I,P,_){var A,k,x,N;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,$(e,t,r,i,a,s,l,u,d,p,f,g,m,y,v,S,C,b,E,T,w,I,P,_)];case 1:return A=o.sent(),0===Object.keys(A).length?[2,{}]:[4,(0,h.pR)(e,t)];case 2:return k=o.sent(),[4,(0,h.NR)(e,t)];case 3:return x=o.sent(),N={shapeId:{id:+x.id},slideId:{id:+k.id,cId:+k.cId}},0!==Object.keys(A).length&&(N.props=A),(0,c.PA)(c.IY.ShouldUseCreationIdsForShapeCommands)&&+k.id in n&&+x.id in n[+k.id]&&N.shapeId&&(N.shapeId.cId=n[+k.id][+x.id]),[2,N]}}))}))).apply(this,arguments)}function re(e,t){return oe.apply(this,arguments)}function oe(){return(oe=(0,r._)((function(e,t){var n,r,i,a,s,l,c,u,d,p,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:n={},r=!0,i=!1,a=void 0,o.label=1;case 1:o.trys.push([1,7,8,9]),s=t[Symbol.iterator](),o.label=2;case 2:return(r=(l=s.next()).done)?[3,6]:(c=l.value,[4,(0,h.pR)(e,c)]);case 3:return u=o.sent(),[4,(0,h.NR)(e,c)];case 4:d=o.sent(),u.id in n?n[u.id].shapeIds.push(d):n[u.id]={slideId:u,shapeIds:[d]},o.label=5;case 5:return r=!0,[3,2];case 6:return[3,9];case 7:return p=o.sent(),i=!0,a=p,[3,9];case 8:try{r||null==s.return||s.return()}finally{if(i)throw a}return[7];case 9:for(var g in f=[],n)f.push(n[g]);return[2,f]}}))}))).apply(this,arguments)}function ie(e,t,n,r,o,i,a){return ae.apply(this,arguments)}function ae(){return(ae=(0,r._)((function(e,t,n,r,i,a,s){var l,d,f,h,m,y,v,S,C;return(0,o.__generator)(this,(function(e){if(l=function(e,t,n,r){var o={};if((0,g.hX)(e))o.effectType=u.kx.fxtypeEntrance,o.effectId=u.Ls.fxidFade;else{var i=null==e?void 0:e.toLowerCase();if((null!=i?i:"")in p.gu&&(o.effectType=p.gu[null!=i?i:""]),!(0,g.hX)(t)){var a,s=null!==(a=null==t?void 0:t.toLowerCase())&&void 0!==a?a:"";switch(o.effectType){case u.kx.fxtypeEntrance:case u.kx.fxtypeExit:s in p.bA&&(o.effectId=p.bA[s]);break;case u.kx.fxtypeEmphasis:s in p.tb&&(o.effectId=p.tb[s]);break;case u.kx.fxtypeMotionPath:s in p.yf&&(o.effectId=p.yf[s])}}}return(0,g.hX)(n)||(o.duration=n),(0,g.hX)(r)||(o.delay=r),o}(r,i,a,s),d={slideId:t.slideId,shapeIds:t.shapeIds},(0,g.hX)(l)||0===Object.keys(l).length||(d.props=l),(0,c.PA)(c.IY.ShouldUseCreationIdsForShapeCommands)){h=!0,m=!1,y=void 0;try{for(v=(null!==(f=d.shapeIds)&&void 0!==f?f:[])[Symbol.iterator]();!(h=(S=v.next()).done);h=!0)C=S.value,+t.slideId.id in n&&+C.id in n[+t.slideId.id]&&(C.cId=n[+t.slideId.id][+C.id])}catch(e){m=!0,y=e}finally{try{h||null==v.return||v.return()}finally{if(m)throw y}}}return[2,d]}))}))).apply(this,arguments)}function se(e){return le.apply(this,arguments)}function le(){return(le=(0,r._)((function(e){var t,n,r,i,a,s,l,p,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O,D,L,R,F,M,B,U,H,G,j,q,Y,J,X,K,Z,$,ee,ne,oe,ae,se,le,ce,ue,de,pe,fe,he,ge,me,ye,ve,Se,Ce,be,Ee,Te,we,Ie,Pe,_e,Ae,ke,xe;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.shapes,r=e.shapeIds,i=e.left,a=e.top,s=e.height,l=e.width,p=e.lineColor,m=e.lineDashStyle,e.lineStyle,y=e.lineWeight,v=e.lineTransparency,S=e.fillColor,C=e.fillTransparency,b=e.shadowType,E=e.shadowPreset,T=e.shadowAlign,w=e.shadowColor,I=e.shadowTransparency,P=e.shadowScaleX,_=e.shadowScaleY,A=e.shadowRadius,k=e.shadowSize,x=e.shadowBlur,N=e.shadowAngle,O=e.shadowDistance,D=e.alignHorizontal,L=e.alignVertical,R=e.distribute,F=e.alignRelative,M=e.animation,B=e.animationType,U=e.animationName,H=e.animationDuration,G=e.animationDelay,j=e.zOrder,o.label=1;case 1:o.trys.push([1,33,,34]),q=[],Y={},(0,c.PA)(c.IY.ShouldUseCreationIdsForShapeCommands)&&!(0,g.hX)(r)&&(Y=(0,h.Lp)(null!=r?r:"")),J=!0,X=!1,K=void 0,o.label=2;case 2:o.trys.push([2,10,11,12]),Z=n[Symbol.iterator](),o.label=3;case 3:return(J=($=Z.next()).done)?[3,9]:(ee=$.value,[4,V(t,ee,Y,null!=i?i:void 0,null!=a?a:void 0,null!=s?s:void 0,null!=l?l:void 0)]);case 4:return ne=o.sent(),(0,g.hX)(ne)||(oe={name:u._u.TransformElementCmd,version:u.xv,data:ne},q.push(oe)),(0,g.hX)(j)?[3,6]:[4,W(t,ee,Y,j)];case 5:ae=o.sent(),se={name:u._u.ModifyOrderCmd,version:u.xv,data:ae},q.push(se),o.label=6;case 6:return[4,te(t,ee,Y,null!=i?i:void 0,null!=a?a:void 0,null!=s?s:void 0,null!=l?l:void 0,null!=p?p:void 0,m,null!=y?y:void 0,null!=v?v:void 0,null!=S?S:void 0,null!=C?C:void 0,b,E,T,w,I,P,_,A,k,x,N,O)];case 7:le=o.sent(),(0,g.hX)(le)||0===Object.keys(le).length||(ce={name:u._u.ModifyShapePropsCmd,version:u.xv,data:le},q.push(ce)),o.label=8;case 8:return J=!0,[3,3];case 9:return[3,12];case 10:return ke=o.sent(),X=!0,K=ke,[3,12];case 11:try{J||null==Z.return||Z.return()}finally{if(X)throw K}return[7];case 12:return(0,g.hX)(D)&&(0,g.hX)(L)&&(0,g.hX)(R)?[3,21]:(0,c.PA)(c.IY.ShouldUseSeparateHorizontalVerticalCommands)?(0,g.hX)(D)?[3,14]:[4,Q(t,n,null!=D?D:void 0,void 0,null!=R?R:void 0)]:[3,19];case 13:ue=o.sent(),de={name:R?u._u.DistributeShapesCmd:u._u.ModifyAlignmentCmd,version:u.xv,data:ue},q.push(de),o.label=14;case 14:return(0,g.hX)(L)?[3,16]:[4,Q(t,n,void 0,null!=L?L:void 0,null!=R?R:void 0)];case 15:pe=o.sent(),fe={name:R?u._u.DistributeShapesCmd:u._u.ModifyAlignmentCmd,version:u.xv,data:pe},q.push(fe),o.label=16;case 16:return(0,g.hX)(D)&&(0,g.hX)(L)&&!(0,g.hX)(R)?[4,Q(t,n,void 0,void 0,null!=R?R:void 0)]:[3,18];case 17:he=o.sent(),ge={name:R?u._u.DistributeShapesCmd:u._u.ModifyAlignmentCmd,version:u.xv,data:he},q.push(ge),o.label=18;case 18:return[3,21];case 19:return[4,Q(t,n,null!=D?D:void 0,null!=L?L:void 0,null!=R?R:void 0,null!=F?F:void 0)];case 20:me=o.sent(),ye={name:R?u._u.DistributeShapesCmd:u._u.ModifyAlignmentCmd,version:u.xv,data:me},q.push(ye),o.label=21;case 21:return(0,g.hX)(M)?[3,32]:[4,re(t,n)];case 22:ve=o.sent(),Se=!0,Ce=!1,be=void 0,o.label=23;case 23:o.trys.push([23,30,31,32]),Ee=ve[Symbol.iterator](),o.label=24;case 24:return(Se=(Te=Ee.next()).done)?[3,29]:(we=Te.value,M?[4,ie(t,we,Y,B,U,H,G)]:[3,26]);case 25:return Ie=o.sent(),(0,z.isNull)(Ie)||0===Object.keys(Ie).length||(Pe={name:u._u.NewAnimationEffectCmd,data:Ie},q.push(Pe)),[3,28];case 26:return[4,ie(t,we,Y)];case 27:_e=o.sent(),(0,z.isNull)(_e)||0===Object.keys(_e).length||(Ae={name:u._u.DeleteAllDrawingElementAnimationEffectsCmd,data:_e},q.push(Ae)),o.label=28;case 28:return Se=!0,[3,24];case 29:return[3,32];case 30:return ke=o.sent(),Ce=!0,be=ke,[3,32];case 31:try{Se||null==Ee.return||Ee.return()}finally{if(Ce)throw be}return[7];case 32:return d.K.getInstance().setScenarioName(u.Cu.FormatShape),[2,q];case 33:throw xe=o.sent(),(0,f.cY)("Exception while parsing the program for OfficeJsPayload Json for format_shape - "+xe.toString()),new Error("Exception while parsing the program for OfficeJsPayload Json ");case 34:return[2]}}))}))).apply(this,arguments)}function ce(e){return ue.apply(this,arguments)}function ue(){return(ue=(0,r._)((function(e){var t,n,r,i,a,l,d,p,f,g,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O,L,R,F,M,B,U,z,H,G,V,j,q;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(t=e.context,n=e.shapes,r=e.shapeIds,i=e.left,a=e.top,l=e.height,d=e.width,p=e.lineColor,f=e.lineDashStyle,g=e.lineStyle,m=e.lineWeight,y=e.lineTransparency,v=e.fillColor,S=e.fillTransparency,C=e.shadowType,b=e.shadowPreset,E=e.shadowAlign,T=e.shadowColor,w=e.shadowTransparency,I=e.shadowScaleX,P=e.shadowScaleY,_=e.shadowRadius,A=e.shadowSize,k=e.shadowBlur,x=e.shadowAngle,N=e.shadowDistance,O=e.alignHorizontal,L=e.alignVertical,R=e.distribute,F=e.alignRelative,M=e.zOrder,B=e.animation,U=e.animationType,z=e.animationName,H=e.animationDuration,G=e.animationDelay,V=e.useOfficeJS,!((j=(0,h.Tq)(u.iz))||((0,h.hX)(B)||!0!==B)&&(0,h.hX)(U)&&(0,h.hX)(z)&&(0,h.hX)(H)&&(0,h.hX)(C)&&(0,h.hX)(b)&&(0,h.hX)(T)&&(0,h.hX)(w)&&(0,h.hX)(E)&&(0,h.hX)(I)&&(0,h.hX)(P)&&(0,h.hX)(_)&&(0,h.hX)(A)&&(0,h.hX)(k)&&(0,h.hX)(x)&&(0,h.hX)(N)&&(0,h.hX)(O)&&(0,h.hX)(L)&&(0,h.hX)(R)&&(0,h.hX)(F)&&(0,h.hX)(M)))throw new D.do(u.aP);if(q=(0,c.PA)(c.IY.ShouldForceOfficeJSImplementationForCommanding)&&!(0,h.hX)(V)&&!0===V,!(0,c.bw)(c.WT.IsjOFCCommandingWorkflowEnabled)||!j||q)return[2,(0,s.qQ)({context:t,shapes:n,left:i,top:a,height:l,width:d,lineColor:p,lineDashStyle:f,lineWeight:m,lineTransparency:y,fillColor:v,fillTransparency:S})];if(0===n.length)throw Error("formatShapes: shapes array is empty");return[4,se({context:t,shapes:n,shapeIds:r,left:i,top:a,height:l,width:d,lineColor:p,lineDashStyle:f,lineStyle:g,lineWeight:m,lineTransparency:y,fillColor:v,fillTransparency:S,shadowType:C,shadowPreset:b,shadowAlign:E,shadowColor:T,shadowTransparency:w,shadowScaleX:I,shadowScaleY:P,shadowRadius:_,shadowSize:A,shadowBlur:k,shadowAngle:x,shadowDistance:N,alignHorizontal:O,alignVertical:L,distribute:R,alignRelative:F,animation:B,animationType:U,animationName:z,animationDuration:H,animationDelay:G,zOrder:M})];case 1:return[2,o.sent()]}}))}))).apply(this,arguments)}var de=n(67548),pe=n(24992),fe=n(71822),he=d.K.getInstance();function ge(e){return me.apply(this,arguments)}function me(){return(me=(0,r._)((function(e){var t,n,r,i,s,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=e.context,n=e.description,r=e.slides,i=e.useOfficeJS,s=void 0!==i&&i,!(0,h.Tq)(u.bg)||(0,c.PA)(c.IY.ShouldForceOfficeJSImplementationForCommanding)&&!(0,h.hX)(s)&&s?[2,(0,a.eZ)({context:t,description:n,slides:r})]:[4,(0,fe.I)({context:t,slides:r,description:n})];case 1:return l=o.sent(),he.setScenarioName(u.Cu.InsertImage),[2,l]}}))}))).apply(this,arguments)}function ye(e){return ve.apply(this,arguments)}function ve(){return(ve=(0,r._)((function(e){var t,n,r,i,a,s,l,c,p,f,m,y,v,S,C,b;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides,r=void 0===n?null:n,i=e.slideIds,a=void 0===i?null:i,s=e.name,l=void 0===s?null:s,c=e.id,p=void 0===c?null:c,f=void 0;try{d.K.getInstance().setScenarioName(u.Cu.AddSection)}catch(e){(0,O.cY_)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return d.K.getInstance().setScenarioName(u.Cu.AddSection),(0,g.hX)(a)?[3,1]:((y=null!==(m=null==a?void 0:a.split("#"))&&void 0!==m?m:[]).length>=2&&(f={type:u.kk.Slide,id:+y[0],cId:+y[1]}),[3,3]);case 1:return!(0,g.hX)(r)&&(null!=r?r:[]).length>0?[4,(0,h.MK)(t,null!=r?r:[])]:[3,3];case 2:v=o.sent(),(S=v.split("#")).length>=2&&(f={type:u.kk.Slide,id:+S[0],cId:+S[1]}),o.label=3;case 3:return C={},(0,g.hX)(p)?C.guid=(0,h.gR)():C.guid=null!=p?p:"",(0,g.hX)(l)||(C.title=null!=l?l:""),b={name:u._u.AddSectionCmd,data:C},(0,g.hX)(f)||(b.after=f),[2,b]}}))}))).apply(this,arguments)}function Se(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=(0,r._)((function(e){var t,n,r,i,a,s,l,c,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(t=e.context,n=e.slides,r=void 0===n?null:n,i=e.slideIds,a=void 0===i?null:i,s=e.name,l=void 0===s?null:s,c=e.id,d=void 0===c?null:c,!(0,h.Tq)(u.bg))throw new D.do(u.aP);return[4,ye({context:t,slides:r,slideIds:a,name:l,id:d})];case 1:return[2,o.sent()]}}))}))).apply(this,arguments)}n(15520);var be,Ee=n(27834),Te={selectSlides:(be=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,B.vy)(e)]}))})),function(e){return be.apply(this,arguments)}),insertSlides:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,pe.Ob)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatSlides:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,pe.Ub)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),moveSlides:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,pe.WN)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),undoApplication:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,i.J)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertSection:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,Se(e)]}))}));return function(t){return e.apply(this,arguments)}}(),generateSlides:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,pe.cd)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteSlides:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,pe.yU)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectText:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.A0)(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertText:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,F(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatText:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,L(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteText:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.JG)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesShape:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,s.ZB)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesSlide:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,B.Jh)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesText:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,l.xk)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectTextIndex:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,l.W1)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectShapes:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,s.ZJ)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertShapes:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,s.AU)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatShapes:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,ce(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteShapes:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,s.wv)(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertImages:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,ge(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteFooters:function(e){return(0,pe.uN)(e)},setFooters:function(e){return(0,pe.F_)(e)},transitionSlides:function(e){return(0,pe.Ce)(e)},insertList:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,de.u)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatList:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,de.k)(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertTables:function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return[2,(0,Ee.d)(e)]}))}));return function(t){return e.apply(this,arguments)}}()}},14213:(e,t,n)=>{"use strict";n.d(t,{K:()=>f});var r=n(11912),o=n(91165),i=n(90813),a=n(130),s=n(44121),l=n(12542),c=n(18758),u=n(39041),d=n(18384),p=l.MP.getInstance(),f=(l.ET.getInstance(p),function(){function e(){(0,r._)(this,e),(0,i._)(this,"scenarioName",void 0),(0,i._)(this,"ashaErrorString",void 0),(0,i._)(this,"ashaVetoString",void 0),(0,i._)(this,"responseTime",void 0),(0,i._)(this,"userQueryGuid",void 0),(0,i._)(this,"conversationId",void 0),(0,i._)(this,"startTime",void 0),(0,i._)(this,"scenarioErrors",void 0),(0,i._)(this,"timeToIntentDetection",void 0),(0,i._)(this,"timeToIntentDetectionOverTheWireTime",void 0),(0,i._)(this,"telemetryHandler",void 0),this.scenarioName=s.Cu.Unset,this.responseTime=0,this.userQueryGuid="",this.conversationId="",this.scenarioErrors=[],this.ashaErrorString=l.av.Unset,this.ashaVetoString=l.G8.Unset}return(0,o._)(e,[{key:"resetData",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scenarioName=s.Cu.Unset,this.responseTime=0,this.userQueryGuid="",this.conversationId="",this.scenarioErrors=[],e&&(this.ashaErrorString=l.av.Unset,this.ashaVetoString=l.G8.Unset)}},{key:"setUserQueryGuid",value:function(e){this.userQueryGuid!==e&&(this.resetData(),this.userQueryGuid=e,(0,c.cY)("ScenarioOptionsManager userQueryGuid set: ".concat(e)))}},{key:"getUserQueryGuid",value:function(){return this.userQueryGuid}},{key:"setConversationId",value:function(e){this.conversationId=e}},{key:"getConversationId",value:function(){return this.conversationId}},{key:"setAshaErrorString",value:function(e){this.ashaErrorString=e}},{key:"getAshaErrorString",value:function(){return this.ashaErrorString}},{key:"setAshaVetoString",value:function(e){this.ashaVetoString=e}},{key:"getAshaVetoString",value:function(){return this.ashaVetoString}},{key:"addScenarioError",value:function(e){(0,c.cY)("Scenario error added: ".concat(e)),this.scenarioErrors.push(e)}},{key:"getScenarioErrors",value:function(){return this.scenarioErrors}},{key:"setTelemetryHandler",value:function(e){this.telemetryHandler=e}},{key:"setScenarioName",value:function(e){var t,n,r;this.scenarioName!==e&&(null===(t=this.telemetryHandler)||void 0===t||t.sendChatEventTelemetry((0,d.pN)((r={},(0,i._)(r,l.h3.ChatEventType,l.a5.ChatIntentDetected),(0,i._)(r,l.h3.ChatEventParameters,e),r))),(0,c.cY)("Scenario name set: ".concat(e)),this.scenarioName=e,null===(n=this.telemetryHandler)||void 0===n||n.sendLatencyTelemetry((0,d.pN)((0,i._)({},l.CT.FeatureName,this.getFeatureName()))))}},{key:"getScenarioName",value:function(){return this.scenarioName}},{key:"setResponseTime",value:function(e){this.responseTime=e}},{key:"getResponseTime",value:function(){return this.responseTime}},{key:"setTimeToIntentDetection",value:function(e){this.timeToIntentDetection=e}},{key:"getTimeToIntentDetection",value:function(){return this.timeToIntentDetection}},{key:"setTimeToIntentDetectionOverTheWireTime",value:function(e){this.timeToIntentDetectionOverTheWireTime=e}},{key:"getTimeToIntentDetectionOverTheWireTime",value:function(){return this.timeToIntentDetectionOverTheWireTime}},{key:"setStartTime",value:function(e){this.startTime=e}},{key:"getStartTime",value:function(){return this.startTime}},{key:"getCapability",value:function(){switch(this.scenarioName){case s.Cu.Organize:case s.Cu.Beautify:case s.Cu.Animate:case s.Cu.FormatText:case s.Cu.FormatShape:case s.Cu.ReplaceText:case s.Cu.SetFooters:case s.Cu.SlideTransition:case s.Cu.HideSlide:case s.Cu.TranslatePresentation:case s.Cu.PresentationRecommendation:return a.TA.Capability.Commanding;case s.Cu.Summary:case s.Cu.BasicChat:return a.TA.Capability.QAandSummaries;default:return a.TA.Capability.ContentGeneration}}},{key:"getFeatureName",value:function(){switch(this.scenarioName){case s.Cu.CreatePresentation:case s.Cu.CreatePresentationFromDoc:return s.SD.CreatePresentation;case s.Cu.AddSlide:case s.Cu.InsertImage:return s.SD.AddContent;case s.Cu.InsertImageDesignerMini:return s.SD.DesignerVisuals;case s.Cu.Organize:return s.SD.Organize;case s.Cu.Beautify:case s.Cu.Animate:case s.Cu.FormatText:case s.Cu.FormatShape:case s.Cu.ReplaceText:case s.Cu.SetFooters:case s.Cu.SlideTransition:case s.Cu.HideSlide:case s.Cu.PresentationRecommendation:return s.SD.BasicCommand;case s.Cu.Summary:return s.SD.Summarize;case s.Cu.BasicChat:return s.SD.ChatQnA;case s.Cu.SpeakerNotes:return s.SD.SpeakerNotes;case s.Cu.TranslatePresentation:return s.SD.Translate;default:return s.SD.CopilotChat}}},{key:"getSubFeatureName",value:function(){switch(this.scenarioName){case s.Cu.CreatePresentation:return s.eH.CreateAPresentation;case s.Cu.CreatePresentationFromDoc:return s.eH.CreateAPresentationFromFile;case s.Cu.AddSlide:return s.eH.AddASlide;case s.Cu.InsertImage:return s.eH.AddAnImage;case s.Cu.InsertImageDesignerMini:return s.eH.AddDesignerImage;case s.Cu.Organize:return s.eH.OrganizePresentation;case s.Cu.Beautify:case s.Cu.PresentationRecommendation:return s.eH.DesignPresentation;case s.Cu.Animate:return s.eH.AnimateSlides;case s.Cu.Summary:return s.eH.SummarizePresentation;case s.Cu.SpeakerNotes:return s.eH.SpeakerNotes;case s.Cu.PresentationRecommendation:return s.eH.ProactiveRecommendation;case s.Cu.TranslatePresentation:return s.eH.TranslatePresentation;default:return s.eH.Unset}}}],[{key:"getInstance",value:function(){return(0,u.hX)(e.scenarioOptionsManager)&&(e.scenarioOptionsManager=new e),e.scenarioOptionsManager}}]),e}());(0,i._)(f,"scenarioOptionsManager",void 0)},24992:(e,t,n)=>{"use strict";n.d(t,{uN:()=>ee,yU:()=>Z,Ub:()=>G,cd:()=>W,Ob:()=>z,WN:()=>j,F_:()=>X,Ce:()=>ne});var r=n(43032),o=n(90813),i=n(79490),a=n(55564),s=n(61339),l=n(33969),c=n(44121),u=n(34045),d=n(65917),p=n(14213),f=n(72702),h=n(25420),g=n(94831),m=n(67815),y=n(60849),v=n(56148),S=n(46444),C=n(18758),b=n(1134);function E(){return(E=(0,r._)((function(e){var t,n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides;try{p.K.getInstance().setScenarioName(c.Cu.DeleteSlide)}catch(e){(0,C.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return[4,(0,b.mk)(t,n)];case 1:return r=o.sent(),[2,{name:c._u.DeleteSlidesCmd,version:c.xv,slides:r}]}}))}))).apply(this,arguments)}function T(){return(T=(0,r._)((function(e){var t,n,r,o;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.slides,r=e.hide;try{p.K.getInstance().setScenarioName(c.Cu.HideSlide)}catch(e){(0,C.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return[4,(0,b.mk)(t,n)];case 1:return o=i.sent(),[2,{name:c._u.HideSlidesCmd,slides:o,hide:r}]}}))}))).apply(this,arguments)}function w(e){return I.apply(this,arguments)}function I(){return(I=(0,r._)((function(e){var t,n,r,o,a,s,l,u,d,f,h,g,m,y,v,S,E,T,w,I,P,_,A,k,x,N,O,D,L,R,F;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.slides,r=e.slideIds,o=e.precededBy,a=e.precededById;try{p.K.getInstance().setScenarioName(c.Cu.MoveSlide)}catch(e){(0,C.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return s={},(0,b.hX)(a)?[3,1]:((u=null!==(l=null==a?void 0:a.split("#"))&&void 0!==l?l:[]).length>=2&&(s={type:c.kk.Slide,id:+u[0],cId:+u[1]}),[3,3]);case 1:return(0,b.hX)(o)||0===(null==o?void 0:o.length)?[3,3]:[4,(0,b.o2)(t,null!=o?o:[])];case 2:d=i.sent(),(f=d.split("#")).length>=2&&(s={type:c.kk.Slide,id:+f[0],cId:+f[1]}),i.label=3;case 3:return h=[],(0,b.hX)(r)?[3,4]:((m=null!==(g=null==r?void 0:r.split("#"))&&void 0!==g?g:[]).length>=2&&(y={type:c.kk.Slide,id:+m[0],cId:+m[1]},h.push(y)),[3,6]);case 4:return[4,(0,b.hI)(t,null!=n?n:[])];case 5:v=i.sent(),S=!0,E=!1,T=void 0;try{for(w=v[Symbol.iterator]();!(S=(I=w.next()).done);S=!0)P=I.value,(_=P.split("#")).length>=2&&(A={type:c.kk.Slide,id:+_[0],cId:+_[1]},h.push(A))}catch(e){E=!0,T=e}finally{try{S||null==w.return||w.return()}finally{if(E)throw T}}i.label=6;case 6:k=[],x=!0,N=!1,O=void 0;try{for(D=h[Symbol.iterator]();!(x=(L=D.next()).done);x=!0)R=L.value,F={name:c._u.MoveSlideCmd,target:R},0!==Object.keys(s).length&&(F.after=s),k.push(F)}catch(e){N=!0,O=e}finally{try{x||null==D.return||D.return()}finally{if(N)throw O}}return[2,k]}}))}))).apply(this,arguments)}function P(){return(P=(0,r._)((function(e){var t,n,r,o,a,s,l;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=e.context,n=e.slides,r=e.footer,o=e.includeDateTime,a=e.includeSlideNumber,[4,(0,b.mk)(t,n)];case 1:return s=i.sent(),l={name:c._u.SetSlidesFooterCmd,slides:s,showFooter:!(0,b.hX)(r)},(0,b.hX)(r)||(l.footerText=r),(0,b.hX)(o)||(l.showDate=o),(0,b.hX)(a)||(l.showSlideNumber=a),p.K.getInstance().setScenarioName(c.Cu.SetFooters),[2,l]}}))}))).apply(this,arguments)}var _=n(91532);function A(e){return k.apply(this,arguments)}function k(){return k=(0,r._)((function(e){var t,n,r,o,a,s,l,u,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.slides,r=e.type,o=e.time,a=e.delay,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,(0,b.mk)(t,n)];case 2:return s=i.sent(),(l=p.K.getInstance()).setScenarioName(c.Cu.SlideTransition),"None"===r?[2,{name:c._u.ResetTransitionPropsCmd,version:c.xv,slides:s,props:["transition","duration","advanceTime","autoAdvance","manualAdvance"]}]:(l.setScenarioName(c.Cu.SlideTransition),u=function(e,t,n){var r={},o=!1;if(!(0,b.hX)(e)){var i=null==e?void 0:e.toLowerCase();i&&i in _.xG&&(r.transition=_.xG[i],o=!0)}return!1===o&&(r.transition=c.kV.FX_MORPH),(0,b.hX)(n)?r.manualAdvance=!0:(r.duration=n,r.autoAdvance=!0),(0,b.hX)(t)||(r.advanceTime=t),r}(r,o,a),[2,{name:c._u.ModifyTransitionPropsCmd,version:c.xv,slides:s,props:u}]);case 3:throw d=i.sent(),(0,C.cY)("Error in parsing json content for add slide command"+d.toString()),new Error("Error in parsing json content for add slide command");case 4:return[2]}}))})),k.apply(this,arguments)}var x=n(72230),N=n(39041),O=n(52174),D=n(23343),L=n(44632),R=n(18384),F=n(12542),M=n(6224),B=n(40389),U=p.K.getInstance();function z(e){return H.apply(this,arguments)}function H(){return(H=(0,r._)((function(e){var t,n,r,o,s,p,f,h,g,m,y,C;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.context,n=e.precededBy,r=void 0===n?[]:n,o=e.layout,s=e.content,p=void 0===s?null:s,f=e.createPresentation,h=void 0===f?null:f,g=e.isFromOrganizePresentation,m=void 0===g?null:g,!(0,b.Tq)(c.bg))throw new l.do(c.aP);if(!m&&u.Vv.IsSettingTrue(u.zj.PPTContentGenerationDisabledByAdmin))throw new l.k7("Content generation is disabled by admin");if(!(0,a.PA)(a.IY.IsAddSlideEnabled))throw new l.do("Content generation is not supported");if(!0!==h)return[3,2];if((C=d._.getInstance()).getSlideCountCached()>1&&!C.isCreatePresentationEnabledCached())throw new l.Xo("Create presentation is not supported as required conditions do not meet");return[4,(0,S.u)({slides:r,content:p})];case 1:return y=i.sent(),U.setScenarioName(c.Cu.CreatePresentation),[3,4];case 2:return[4,(0,v.w)({context:t,slides:r,content:p})];case 3:y=i.sent(),U.setScenarioName(c.Cu.AddSlide),i.label=4;case 4:return[2,y]}}))}))).apply(this,arguments)}function G(e){return V.apply(this,arguments)}function V(){return V=(0,r._)((function(e){var t,n,r,s,p,f,y,v,S,E,w,I,P,_,A;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.context,n=e.slides,r=e.strategy,s=void 0===r?null:r,p=e.animation,f=void 0===p?null:p,y=e.isVisible,v=void 0===y?null:y,S=e.targetFormatSlideByIndex,E=void 0===S?null:S,s&&!Object.values(c.qY).includes(s))throw(0,C.cY)("Strategy ".concat(s," is not supported")),new l.do("formatSlides : Strategy ".concat(s," is not supported"));if(!(0,N.hX)(v)&&(0,a.bw)(a.WT.IsjOFCCommandingWorkflowEnabled)){if(!(0,b.Tq)(c.iz))throw new l.do(c.aP);return w=function(e){return T.apply(this,arguments)}({context:t,slides:n,hide:!v}),[2,w]}return I={},s!==c.qY.OrganizeSlide?[3,4]:d._.getInstance().getCachedDocumentState().hasSection?[3,2]:[4,(0,h.O)(t)];case 1:return i.sent(),U.setScenarioName(c.Cu.Organize),[3,3];case 2:throw(0,O.r)()?((0,a.PA)("DoNotSendTelemetryForOrganizeWarning")||(0,D.k)(!1,"StructurePresentationShowWarningError_DocumentHasSection_ShowingWarning",c.Cu.Organize),new l.Lx("Organize Presentation command - presentation already has sections show user warning")):((0,D.k)(!1,"StructurePresentationBlockedError_DocumentHasSection",c.Cu.Organize),new l.SU("Organize Presentation command is not supported"));case 3:return[3,11];case 4:return s!==c.qY.BeautifySlide&&s!==c.qY.DesignerSlide?[3,8]:(0,a.bw)(a.WT.TriggerPresentationRecommendationWithBeautify)?((0,C.cY)("Overriding beautify trigger to send PresentationRecommendation signal"),U.setScenarioName(c.Cu.PresentationRecommendation),[4,(0,g.G)(t)]):[3,6];case 5:return i.sent(),[3,7];case 6:I[c.k2.RunDesigner]="true",U.setScenarioName(c.Cu.Beautify),i.label=7;case 7:return[3,11];case 8:if(s!==c.qY.ThemeIdeas)return[3,9];if(!(0,a.bw)(a.WT.ShouldEnableTryNewDesign))throw new l.do("Theme ideas command is not supported");return I[c.k2.TryNewTheme]="true",U.setScenarioName(c.Cu.Beautify),[2,{trigger:c._E.AllSlides,presentationHints:I}];case 9:return(0,a.bw)(a.WT.IsPresentationTransformerWFEnabled)&&s===c.qY.TransformSlide&&E?[4,(0,m.G)(t,[E])]:[3,11];case 10:i.sent(),U.setScenarioName(c.Cu.PresentationTransform),i.label=11;case 11:if(!0===f){if(!u.Vv.IsSettingTrue(u.zj.PPTCopilotScnAnimate))throw(0,D.k)(!1,"UnsupportedCommandError",c.Cu.Animate),new l.do("Add slide Animation command is not supported");I[c.k2.AddSlideAnimation]="true",U.setScenarioName(c.Cu.Animate)}else if((0,a.PA)(a.IY.LogChatEventWhenAnimationIsFalse)&&!1===f)throw L.B.getInstance().sendChatEventTelemetry((0,R.pN)((0,o._)({},F.h3.ChatEventType,"AnimationPresentButFalse"))),new l.do("Removing animation is not supported");return Object.keys(I).length>0?n&&1===n.length&&Array.isArray(n)?[3,13]:[4,(0,b.q0)(t)]:[3,15];case 12:n=i.sent(),i.label=13;case 13:return[4,(0,b.MK)(t,n)];case 14:return P=i.sent(),(0,a.PA)(a.IY.EnableCheckBeforeSplit)&&(0,N.hX)(P)?[2,null]:(_=P.split("#"),(0,a.PA)(a.IY.EnableCheckBeforeSplit)&&_.length<2?[2,null]:(A={type:1,id:+_[0],cId:+_[1]},[2,{target:A,hints:I}]));case 15:return[2,null]}}))})),V.apply(this,arguments)}function j(e){return q.apply(this,arguments)}function q(){return(q=(0,r._)((function(e){var t,n,r,o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.context,n=e.slides,r=e.slideIds,o=e.precededBy,a=e.precededById,!(0,b.Tq)(c.bg))throw new l.do(c.aP);return[4,w({context:t,slides:n,slideIds:r,precededBy:o,precededById:a})];case 1:return[2,i.sent()]}}))}))).apply(this,arguments)}function W(e){return Y.apply(this,arguments)}function Y(){return(Y=(0,r._)((function(e){var t,n,r,p,h,g,m,v,S,E,T;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.context,n=e.precededBy,r=e.prompt,p=e.source,h=e.createPresentation,g=e.groundingInfo,m=e.chatConversations,v=[],p)if((0,a.bw)(a.WT.EnableMultiDocumentsTransformation))try{v=JSON.parse(p)}catch(e){(0,C.cY)("Error parsing sources in ODSL statement: ".concat(e.message))}else v.push(p);if(!(0,b.Tq)(c.bg))throw new l.do(c.aP);if(S=d._.getInstance(),!r||!u.Vv.IsSettingTrue(u.zj.PPTContentGenerationDisabledByAdmin))return[3,1];throw new l.k7("Content generation is disabled by admin");case 1:if(!(0,a.PA)(a.IY.IsStoryTellerBlockedWithEmptyPrompt)||0!=h||0===v.length||!(0,N.hX)(r)&&0!=r.length)return[3,2];throw(0,C.cY)("AddSlide- Avoiding storyteller call since prompt is undefined, but source is defined"),U.setScenarioName(c.Cu.AddSlide),new l.zw("AddSlide- Avoiding storyteller call since prompt is undefined, but source is defined");case 2:return(void 0!==h||(0,a.PA)(a.IY.IsBumbleBeeWhenSourcePresent)&&0!==v.length)&&!1!==h?[3,7]:(0,a.bw)(a.WT.IsAddSlideWorkflowEnabled)?((0,C.cY)("generateSlides call addSlideWorkflow with prompt:",r),[4,(0,M.l)(r,t,n)]):[3,4];case 3:return i.sent(),[3,6];case 4:return(0,C.cY)("generateSlides call storyTellerWorkflow with prompt:",r),[4,(0,y.A)(r,!0,t,g,m,n)];case 5:i.sent(),i.label=6;case 6:return U.setScenarioName(c.Cu.AddSlide),[3,16];case 7:if(!(S.getSlideCountCached()>1&&0===v.length))return[3,8];throw s.R.getInstance().setCachedRequestParameters(r,v,g),(0,a.PA)(a.IY.IsCreatePresentationWarningTypeLogEnabled)&&L.B.getInstance().sendChatEventTelemetry((0,R.pN)((E={},(0,o._)(E,F.h3.ChatEventType,F.a5.CreatePresentationWarningType),(0,o._)(E,F.h3.ChatEventParameters,F.CC.CreatePresentation),E))),J()?new l.Wo("Create presentation - Slides already present - NB should be launched to create a presentation"):new l.uB("Create presentation - Slides already present - show the user warning");case 8:if(!(S.getSlideCountCached()>1&&v.length>0))return[3,9];throw s.R.getInstance().setCachedRequestParameters(r,v,g),(0,a.PA)(a.IY.IsCreatePresentationWarningTypeLogEnabled)&&L.B.getInstance().sendChatEventTelemetry((0,R.pN)((T={},(0,o._)(T,F.h3.ChatEventType,F.a5.CreatePresentationWarningType),(0,o._)(T,F.h3.ChatEventParameters,F.CC.CreatePresentationFromDoc),T))),Q()?new l.Wo("Create presentation - Slides already present - NB should be launched to create a presentation with grounding info"):new l.uB("Create presentation - Slides already present - show the user warning");case 9:if(0===v.length||(0,a.PA)(a.IY.IsCreatePresentationEnabled))return[3,10];throw new l.do("Content generation is not supported");case 10:if(!(S.getSlideCountCached()>1)||S.isCreatePresentationEnabledCached())return[3,11];throw(0,D.k)(!1,"CreatePresentationBlockedError",c.Cu.CreatePresentation),new l.Xo("Create presentation is not supported as required conditions do not meet");case 11:if(!(v.length>0))return[3,13];if(Q())throw new l.Wo("Create presentation - NB should be launched to create a presentation with grounding info");return U.setScenarioName(c.Cu.CreatePresentationFromDoc),(0,C.cY)("generateSlides call contentProcessingWorkflow with source:",v.join(", ")),[4,(0,f.Pb)(v,r)];case 12:return i.sent(),[3,16];case 13:if(!r)return[3,15];if(J())throw new l.Wo("Create presentation - NB should be launched to create a presentation");return(0,C.cY)("generateSlides call storyTellerWorkflow with prompt:",r),[4,(0,y.A)(r,!1,t,g,m)];case 14:return i.sent(),U.setScenarioName(c.Cu.CreatePresentation),[3,16];case 15:throw new Error("no source or prompt provided");case 16:return[2]}}))}))).apply(this,arguments)}function Q(){return!(0,B.dD)()&&(0,a.bw)(a.WT.isCreatePresentationViaNBInChatEnabled)&&(0,a.bw)(a.WT.IsRedirectToNBForCreatingGroundedPresentationEnabled)&&(0,a.PA)(a.IY.IsShowLaunchNBResponseCardEnabled)}function J(){return!(0,B.dD)()&&(0,a.bw)(a.WT.isCreatePresentationViaNBInChatEnabled)&&(0,a.bw)(a.WT.IsRedirectToNBForCreatingNonGroundedPresentationEnabled)&&(0,a.PA)(a.IY.IsShowLaunchNBResponseCardEnabled)}function X(e){return K.apply(this,arguments)}function K(){return K=(0,r._)((function(e){var t,n,r,o,s,u;return(0,i.__generator)(this,(function(i){if(t=e.context,n=e.slides,r=e.footer,o=e.includeDateTime,s=e.includeSlideNumber,!(0,a.bw)(a.WT.IsjOFCCommandingWorkflowEnabled)||!(0,b.Tq)(c.iz))throw new l.do("slideFooter command is not supported");return u=function(e){return P.apply(this,arguments)}({context:t,slides:n,footer:r,includeDateTime:o,includeSlideNumber:s}),[2,u]}))})),K.apply(this,arguments)}function Z(e){return $.apply(this,arguments)}function $(){return $=(0,r._)((function(e){var t,n,r,o,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=e.context,n=e.slides,r=(0,b.Tq)(c.iz),(0,a.bw)(a.WT.IsjOFCCommandingWorkflowEnabled)&&r?[3,2]:(o={},[4,(0,x.yU)({context:t,slides:n})]);case 1:return i.sent(),[2,o];case 2:return s=function(e){return E.apply(this,arguments)}({context:t,slides:n}),[2,s]}}))})),$.apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return(te=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){throw e.context,e.slides,new l.do("deleteFooter command is not supported")}))}))).apply(this,arguments)}function ne(e){return re.apply(this,arguments)}function re(){return(re=(0,r._)((function(e){var t,n,r,o,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(t=e.context,n=e.slides,r=e.type,o=e.time,s=e.delay,!(0,a.bw)(a.WT.IsjOFCCommandingWorkflowEnabled)||!(0,b.Tq)(c.iz))throw new l.do("transitionSlides command is not supported");return[4,A({context:t,slides:n,type:r,time:o,delay:s})];case 1:return[2,i.sent()]}}))}))).apply(this,arguments)}},27834:(e,t,n)=>{"use strict";n.d(t,{d:()=>f});var r=n(43032),o=n(79490),i=n(44121),a=n(14213),s=n(33969),l=n(2061),c=n(1134);function u(e,t,n,r){var o=function(e,t){for(var n="<html><table><tbody>",r=0;r<e;r++){n+="<tr>";for(var o=0;o<t;o++)n+="<td></td>";n+="</tr>"}return n+"</tbody></table></html>"}(e,t);return{shapeGuid:(0,c.gR)(),tableHtml:o}}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(e){var t,n,r,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides,r=e.rows,d=void 0===r?2:r,p=e.columns,f=void 0===p?5:p,e.insertLocation,e.value;try{a.K.getInstance().setScenarioName(i.Cu.CreateTable)}catch(e){(0,l.cY_)("Exception while setting the scenario name for create_table OfficeJsPayload Json "+e.toString())}if(!(0,c.Tq)(i.iz))throw new s.do(i.aP);o.label=1;case 1:return o.trys.push([1,7,,8]),h=[],g=[],(0,c.hX)(n)?[3,3]:[4,(0,c.mk)(t,n)];case 2:return g=o.sent(),[3,6];case 3:return[4,(0,c.q0)(t)];case 4:return m=o.sent(),[4,(0,c.mk)(t,m)];case 5:if(0===(g=o.sent()).length)throw new Error("No slides selected");g=[g[0]],o.label=6;case 6:y=!0,v=!1,S=void 0;try{for(C=g[Symbol.iterator]();!(y=(b=C.next()).done);y=!0)E=b.value,T=u(d,f),w={name:i._u.AddTableCmd,slideId:E,data:T},h.push(w)}catch(e){v=!0,S=e}finally{try{y||null==C.return||C.return()}finally{if(v)throw S}}return[2,h];case 7:throw I=o.sent(),(0,l.cY_)("Exception while parsing the program for create_table OfficeJsPayload Json "+I.toString()),new Error("Exception while parsing the program for create_table OfficeJsPayload Json ");case 8:return[2]}}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){var t,n,r,i,a,s;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=e.context,n=e.slides,r=e.rows,i=e.columns,a=e.insertLocation,s=e.value,[4,d({context:t,slides:n,rows:r,columns:i,insertLocation:a,value:s})];case 1:return[2,o.sent()]}}))}))).apply(this,arguments)}},67548:(e,t,n)=>{"use strict";n.d(t,{k:()=>f,u:()=>d});var r=n(43032),o=n(79490),i=n(44121),a=n(14213),s=n(33969),l=n(18758),c=n(1134);function u(e,t,n,r){var o={slideId:t,shapeId:n,props:r};return{name:e,version:i.xv,data:o}}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(e){var t,n,r,d,p,f,h;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:try{a.K.getInstance().setScenarioName(i.Cu.InsertList)}catch(e){(0,l.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}if(!(0,c.Tq)(i.iz))throw new s.do(i.aP);return t=e.context,n=e.textRanges,e.paragraphText,e.insertLocation,[4,(0,c.Z$)(n,t)];case 1:if(r=o.sent(),d=[],(p={}).bulletSize=100,p.bulletProp={char:""},Object.keys(r).length>0)for(f=0;f<r.length;f++)Object.keys(p).length>0&&(h=u(i._u.ModifyParaPropsCmd,r[f].slideId,r[f].shapeId,p),d.push(h));return[2,d]}}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){var t,n,r,d,p,f,h,g,m,y,v,S;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:try{a.K.getInstance().setScenarioName(i.Cu.FormatList)}catch(e){(0,l.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}if(!(0,c.Tq)(i.iz))throw new s.do(i.aP);return t=e.context,n=e.textRanges,r=e.listLevel,d=e.listLevelBullet,p=e.listLevelNumbering,[4,(0,c.Z$)(n,t)];case 1:if(f=o.sent(),h=[],(g={}).bulletSize=100,g.bulletProp={char:""},null!=d&&"None"===d?g.bulletProp={}:null!=d&&(m=String.fromCharCode(parseInt(d,16)),g.bulletProp={char:m}),null!=p&&(y=i.rx.has(p)?i.rx.get(p):i.rx.get("arabicPeriod"),g.bulletProp={autoNum:{scheme:y,start:1}}),null!=r&&(g.indentLv=r),Object.keys(f).length>0)for(v=0;v<f.length;v++)Object.keys(g).length>0&&(S=u(i._u.ModifyParaPropsCmd,f[v].slideId,f[v].shapeId,g),h.push(S));return[2,h]}}))}))).apply(this,arguments)}},56148:(e,t,n)=>{"use strict";n.d(t,{w:()=>f,z:()=>d});var r=n(43032),o=n(79490),i=n(44121),a=n(14213),s=n(18758),l=n(1134),c=n(55564),u=n(39041);function d(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(e){var t,n,r,a,l,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O;return(0,o.__generator)(this,(function(o){try{if(t=[],(0,u.hX)(e))return t.push({shapes:[]}),[2,t];n=JSON.parse(e),a=!0,l=!1,d=void 0;try{for(p=n.slides[Symbol.iterator]();!(a=(f=p.next()).done);a=!0){if(h=f.value,r={shapes:[]},h.title&&((m={shapeType:i.IO.Title,text:"",textFormat:i.lk.String}).text=h.title,null===(g=r.shapes)||void 0===g||g.push(m)),h.content&&(v={shapeType:i.IO.Content,text:"",textFormat:i.lk.String},S=(S=h.content).trimStart(),C=S.replace(/\\n/g,"\n").replace(/\n- /g,"\n"),(C=(0,u.WM)(C)).length>0&&"-"===C[0]?v.text=C.substring(2):v.text=C,null===(y=r.shapes)||void 0===y||y.push(v)),h.image){b=!0,E=!1,T=void 0;try{for(w=h.image[Symbol.iterator]();!(b=(I=w.next()).done);b=!0)P=I.value,(A={shapeType:i.IO.Image,sourceType:i.fK.Link,image:"",alt:""}).alt=P.altText,A.image=P.imageUrl,null===(_=r.shapes)||void 0===_||_.push(A)}catch(e){E=!0,T=e}finally{try{b||null==w.return||w.return()}finally{if(E)throw T}}}h.id&&(k=h.id.split("#"),x={type:i.kk.Slide,id:+k[0],cId:+k[1]},r.slideMoniker=x),(0,c.PA)("addSlideParseLayout")&&h.layoutInfo?r.layoutInfo=h.layoutInfo:(N={type:i.xL.Object,minCnt:2},O={phs:[N]},r.layoutInfo=O),t.push(r)}}catch(e){l=!0,d=e}finally{try{a||null==p.return||p.return()}finally{if(l)throw d}}return[2,t]}catch(e){throw(0,s.cY)("Exception while parsing the program for add_slide OfficeJsPayload Json - "+e.toString()),new Error("Exception while parsing the program for add_slide OfficeJsPayload Json ")}return[2]}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){var t,n,r,c,u,p,f;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides,r=e.content;try{a.K.getInstance().setScenarioName(i.Cu.AddSlide)}catch(e){(0,s.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}c={name:i._u.AddSlidesCmd,data:{slides:[]}},o.label=1;case 1:return o.trys.push([1,3,,4]),u=c.data,[4,d(r)];case 2:return u.slides=o.sent(),[3,4];case 3:throw o.sent();case 4:return 0===n.length?[3,6]:[4,(0,l.o2)(t,n)];case 5:p=o.sent().split("#"),f={type:i.kk.Slide,id:+p[0],cId:+p[1]},c.after=f,o.label=6;case 6:return[2,c]}}))}))).apply(this,arguments)}},46444:(e,t,n)=>{"use strict";n.d(t,{u:()=>c});var r=n(43032),o=n(79490),i=n(44121),a=n(14213),s=n(18758),l=n(56148);function c(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)((function(e){var t,n,r,c,u,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e.slides,t=e.content,n=e.slideResponseFromSegmentWF,r=void 0===n?null:n;try{a.K.getInstance().setScenarioName(null===r?i.Cu.CreatePresentation:i.Cu.CreatePresentationFromDoc)}catch(e){(0,s.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}(c={name:i._u.CreatePresentationCmd,version:i.xv,data:{version:i.xv,slides:[]}}).name=i._u.CreatePresentationCmd,o.label=1;case 1:return o.trys.push([1,5,,6]),u=c.data,null===r?[3,2]:(d=r,[3,4]);case 2:return[4,(0,l.z)(t)];case 3:d=o.sent(),o.label=4;case 4:return u.slides=d,[3,6];case 5:throw o.sent();case 6:return[2,c]}}))}))).apply(this,arguments)}},44121:(e,t,n)=>{"use strict";var r,o,i,a,s;n.d(t,{B$:()=>N,BJ:()=>L,Cu:()=>h,Cw:()=>I,DR:()=>E,FX:()=>f,GH:()=>T,IO:()=>i,KS:()=>R,Ls:()=>D,R4:()=>p,SD:()=>S,Yu:()=>b,_E:()=>c,_u:()=>l,aP:()=>x,bg:()=>A,eH:()=>C,fK:()=>a,gl:()=>U,hO:()=>o,iz:()=>k,jb:()=>P,k2:()=>d,kV:()=>w,kk:()=>r,kx:()=>O,lC:()=>z,lk:()=>s,qY:()=>u,rX:()=>y,rx:()=>H,t2:()=>B,tp:()=>g,wD:()=>m,xL:()=>v,xv:()=>_}),function(e){e[e.Presentation=0]="Presentation",e[e.Slide=1]="Slide",e[e.DrawingElement=2]="DrawingElement",e[e.Table=3]="Table",e[e.Section=4]="Section",e[e.Other=100]="Other"}(r||(r={})),function(e){e[e.Slide=0]="Slide",e[e.Shape=1]="Shape",e[e.Text=2]="Text"}(o||(o={})),function(e){e[e.Title=0]="Title",e[e.Subtitle=1]="Subtitle",e[e.Content=2]="Content",e[e.Note=3]="Note",e[e.SmartArt=4]="SmartArt",e[e.Image=5]="Image",e[e.TextBox=6]="TextBox",e[e.Table=7]="Table",e[e.Chart=8]="Chart",e[e.Cameo=9]="Cameo",e[e.Other=100]="Other"}(i||(i={})),function(e){e[e.Link=0]="Link",e[e.Raw64=1]="Raw64"}(a||(a={})),function(e){e[e.String=0]="String",e[e.HTML=1]="HTML"}(s||(s={}));var l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_="1.0.0",A="1.1.0.0",k="1.2.0.0",x="jOFC command version not supported";!function(e){e.CreatePresentationCmd="CreatePresentationCmd",e.AddSlidesCmd="AddSlidesCmd",e.AddPictureCmd="AddPictureCmd",e.MoveSlideCmd="MoveSlideCmd",e.AddSectionCmd="AddSectionCmd",e.ModifyTextPropsCmd="ModifyTextPropsCmd",e.ModifyParaPropsCmd="ModifyParaPropsCmd",e.ReplaceTextCmd="ReplaceTextCmd",e.TransformElementCmd="TransformElementCmd",e.ModifyOrderCmd="ModifyOrderCmd",e.DeleteSlidesCmd="DeleteSlidesCmd",e.SetSlidesFooterCmd="SetSlidesFooterCmd",e.ModifyShapePropsCmd="ModifyShapePropsCmd",e.AddShapeCmd="AddShapeCmd",e.ModifyTransitionPropsCmd="ModifyTransitionPropsCmd",e.ResetTransitionPropsCmd="ResetTransitionPropsCmd",e.HideSlidesCmd="HideSlidesCmd",e.DistributeShapesCmd="DistributeShapesCmd",e.ModifyAlignmentCmd="ModifyAlignmentCmd",e.NewAnimationEffectCmd="NewAnimationEffectCmd",e.DeleteAllDrawingElementAnimationEffectsCmd="DeleteAllDrawingElementAnimationEffectsCmd",e.AddTableCmd="AddTableCmd",e.AppendTextCmd="AppendTextCmd"}(l||(l={})),function(e){e[e.None=0]="None",e[e.DocumentChanges=1]="DocumentChanges",e[e.AllSlides=2]="AllSlides"}(c||(c={})),function(e){e.OrganizeSlide="organize",e.BeautifySlide="beautify",e.DesignerSlide="designer",e.ThemeIdeas="ThemeIdeas",e.TransformSlide="transform"}(u||(u={})),function(e){e.RunDesigner="RunDesigner",e.AddSlideAnimation="AddSlideAnimation",e.CanReplaceImageWithLoopingVideo="CanReplaceImageWithLoopingVideo",e.TryNewTheme="TryNewTheme"}(d||(d={})),function(e){e.KeySlideShow="KeySlideShow",e.TranslatePresentation="TranslatePresentation",e.LaunchNarrativeBuilder="LaunchNarrativeBuilder",e.ShowNotesPane="ShowNotesPane"}(p||(p={})),function(e){e.ZQM="ZQM",e.CopilotLabs="CopilotLabs",e.Submit="Submit"}(f||(f={})),function(e){e.CreatePresentation="CreatePresentation",e.CreatePresentationFromDoc="CreatePresentationFromDoc",e.AddSlide="AddSlide",e.InsertImage="InsertImage",e.Organize="Organize",e.Beautify="Beautify",e.Animate="Animate",e.BasicChat="BasicChat",e.CopilotChat="CopilotChat",e.Summary="Summary",e.SpeakerNotes="SpeakerNotes",e.FormatText="FormatText",e.FormatShape="FormatShape",e.ReplaceText="ReplaceText",e.SetFooters="SetFooters",e.SlideTransition="SlideTransition",e.HideSlide="HideSlide",e.PresentationTransform="PresentationTransform",e.PresentationRecommendation="PresentationRecommendation",e.AddSection="AddSection",e.CreateTable="CreateTable",e.DeleteSlide="DeleteSlide",e.InsertShape="InsertShape",e.MoveSlide="MoveSlide",e.SlideFooter="SlideFooter",e.FormatList="FormatList",e.InsertList="InsertList",e.InsertImageDesignerMini="InsertImageDesignerMini",e.TranslatePresentation="TranslatePresentation",e.Unset="",e.InsertImageAdaptiveCard="InsertImageAdaptiveCard"}(h||(h={})),function(e){e.IntentDetectionFailure="intent-detection-failure",e.Cancelled="cancelled",e.CancelledFromWarningCard="cancelledFromWarningCard"}(g||(g={})),function(e){e[e.None=0]="None",e[e.UnexpectedVersion=1]="UnexpectedVersion",e[e.DesignerFailed_Deprecated=2]="DesignerFailed_Deprecated",e[e.ContentInsertionFailed=3]="ContentInsertionFailed",e[e.ApplyCLPLabelFailed=4]="ApplyCLPLabelFailed",e[e.DesignerFailedAlreadyHasAnimation=5]="DesignerFailedAlreadyHasAnimation",e[e.DocumentChangedBeforeCommandExecution=6]="DocumentChangedBeforeCommandExecution",e[e.CommandHadNoEffect=7]="CommandHadNoEffect",e[e.Unknown=8]="Unknown",e[e.ParseDesignerOptionsFailed=9]="ParseDesignerOptionsFailed",e[e.FetchDesignSuggestionFailed=10]="FetchDesignSuggestionFailed",e[e.ApplyDesignSuggestionFailed=11]="ApplyDesignSuggestionFailed",e[e.PrepDesignInputFailed=12]="PrepDesignInputFailed",e[e.DocClosingWithIncompleteProtocol=13]="DocClosingWithIncompleteProtocol",e[e.FetchDesignSuggestionPartialSuccess=14]="FetchDesignSuggestionPartialSuccess",e[e.PrepareStageTimedOut=100]="PrepareStageTimedOut",e[e.EmptyJOfcCmdResultId=101]="EmptyJOfcCmdResultId"}(m||(m={})),function(e){e[e.None=0]="None",e[e.CompletedStatusCode=1]="CompletedStatusCode",e[e.DisabledStatusCode=2]="DisabledStatusCode",e[e.ErrorStatusCode=3]="ErrorStatusCode",e[e.CompletedWithErrorsStatusCode=4]="CompletedWithErrorsStatusCode",e[e.UserAbortedStatusCode=5]="UserAbortedStatusCode"}(y||(y={})),function(e){e[e.Title=0]="Title",e[e.CenterTitle=2]="CenterTitle",e[e.Subtitle=3]="Subtitle",e[e.Object=8]="Object"}(v||(v={})),function(e){e.CreatePresentation="Create Presentation",e.AddContent="Add Content",e.Organize="Organize",e.BasicCommand="Basic Command",e.CopilotChat="Copilot Chat",e.Summarize="Summarize",e.SpeakerNotes="Speaker Notes",e.DocumentQnA="Document QnA",e.ChatQnA="Chat QnA",e.Commanding="Commanding",e.Customize="Customize",e.DesignerVisuals="Designer Visuals",e.Translate="Translate",e.Unset=""}(S||(S={})),function(e){e.CreateAPresentation="Create a presentation",e.CreateAPresentationFromFile="Create a presentation from file",e.AddASlide="Add a slide",e.AddAnImage="Add an image",e.OrganizePresentation="Organize this presentation",e.ChangeTextFormat="Change text format to",e.AnimateSlides="Animate my slides",e.DesignPresentation="Design my presentation",e.SummarizePresentation="Summarize the presentation",e.SpeakerNotes="Speaker Notes",e.ProactiveRecommendation="Proactive Recommendation",e.ShowKeySlides="Show the key slides",e.ShowActionItems="Show action items",e.AddDesignerImage="Add an image from Designer",e.TranslatePresentation="Translate presentation",e.Unset="Unset"}(C||(C={})),function(e){e[e.AlignLeft=0]="AlignLeft",e[e.AlignCenter=1]="AlignCenter",e[e.AlignRight=2]="AlignRight",e[e.AlignJustify=3]="AlignJustify",e[e.AlignJustifyLow=4]="AlignJustifyLow",e[e.AlignDistributed=5]="AlignDistributed",e[e.AlignThaiDistributed=6]="AlignThaiDistributed",e[e.TextAlignType_MaxEnumIDs=7]="TextAlignType_MaxEnumIDs"}(b||(b={})),function(e){e[e.BringToFront=0]="BringToFront",e[e.BringForward=1]="BringForward",e[e.SendToBack=2]="SendToBack",e[e.SendBackward=3]="SendBackward"}(E||(E={})),function(e){e[e.noUnderline=0]="noUnderline",e[e.words=1]="words",e[e.singleLine=2]="singleLine",e[e.doubleLine=3]="doubleLine",e[e.heavyLine=4]="heavyLine",e[e.dottedLine=5]="dottedLine",e[e.dottedHeavyLine=6]="dottedHeavyLine",e[e.dashLine=7]="dashLine",e[e.dashHeavyLine=8]="dashHeavyLine",e[e.dashLongLine=9]="dashLongLine",e[e.dashLongHeavyLine=10]="dashLongHeavyLine",e[e.dotDashLine=11]="dotDashLine",e[e.dotDashHeavyLine=12]="dotDashHeavyLine",e[e.dotDotDashLine=13]="dotDotDashLine",e[e.dotDotDashHeavyLine=14]="dotDotDashHeavyLine",e[e.wavyLine=15]="wavyLine",e[e.wavyHeavyLine=16]="wavyHeavyLine",e[e.wavyDoubleLine=17]="wavyDoubleLine",e[e.TextUnderlineType_MaxEnumIDs=18]="TextUnderlineType_MaxEnumIDs"}(T||(T={})),function(e){e[e.FX_FIRST=0]="FX_FIRST",e[e.FX_CUT=0]="FX_CUT",e[e.FX_NONE=0]="FX_NONE",e[e.FX_RANDOM=1]="FX_RANDOM",e[e.FX_BLINDS=2]="FX_BLINDS",e[e.FX_CHECKER=3]="FX_CHECKER",e[e.FX_COVER=4]="FX_COVER",e[e.FX_DISSOLVE=5]="FX_DISSOLVE",e[e.FX_FADE=6]="FX_FADE",e[e.FX_PULL=7]="FX_PULL",e[e.FX_RANDOMBAR=8]="FX_RANDOMBAR",e[e.FX_RANDOMBARS=8]="FX_RANDOMBARS",e[e.FX_STRIPS=9]="FX_STRIPS",e[e.FX_WIPE=10]="FX_WIPE",e[e.FX_ZOOM=11]="FX_ZOOM",e[e.FX_FLY=12]="FX_FLY",e[e.FX_SPLIT=13]="FX_SPLIT",e[e.FX_FLASH=14]="FX_FLASH",e[e.FX_PP9=14]="FX_PP9",e[e.DEP_FX_WHEEL=15]="DEP_FX_WHEEL",e[e.DEP_FX_CIRCLE=16]="DEP_FX_CIRCLE",e[e.FX_DIAMOND=17]="FX_DIAMOND",e[e.FX_PLUS=18]="FX_PLUS",e[e.FX_WEDGE=19]="FX_WEDGE",e[e.FX_PUSH=20]="FX_PUSH",e[e.FX_COMB=21]="FX_COMB",e[e.FX_NEWSFLASH=22]="FX_NEWSFLASH",e[e.FX_ALPHAFADE=23]="FX_ALPHAFADE",e[e.FX_BLUR=24]="FX_BLUR",e[e.FX_PUSHELEM=25]="FX_PUSHELEM",e[e.FX_WHEEL=26]="FX_WHEEL",e[e.FX_CIRCLE=27]="FX_CIRCLE",e[e.FX_PPT12_COMPATIBILITY=27]="FX_PPT12_COMPATIBILITY",e[e.FX_VORTEX=28]="FX_VORTEX",e[e.FX_RIPPLE=29]="FX_RIPPLE",e[e.FX_GLITTER=30]="FX_GLITTER",e[e.FX_FLYTHROUGH=31]="FX_FLYTHROUGH",e[e.FX_FLYTHROUGH_CONTENT=32]="FX_FLYTHROUGH_CONTENT",e[e.FX_DOORS=33]="FX_DOORS",e[e.FX_DOORS_CONTENT=34]="FX_DOORS_CONTENT",e[e.FX_PANBOUNCE_CONTENT=36]="FX_PANBOUNCE_CONTENT",e[e.FX_PAN3D_CONTENT=37]="FX_PAN3D_CONTENT",e[e.FX_CONVEYOR=37]="FX_CONVEYOR",e[e.FX_GALLERY=38]="FX_GALLERY",e[e.FX_PAN3D=38]="FX_PAN3D",e[e.FX_CROSSZOOM=39]="FX_CROSSZOOM",e[e.FX_REVEAL=39]="FX_REVEAL",e[e.FX_HONEYCOMB=40]="FX_HONEYCOMB",e[e.FX_FERRIS_CONTENT=41]="FX_FERRIS_CONTENT",e[e.FX_FERRISWHEEL=41]="FX_FERRISWHEEL",e[e.FX_SWITCH=42]="FX_SWITCH",e[e.FX_FLIP=43]="FX_FLIP",e[e.FX_PRISM=44]="FX_PRISM",e[e.FX_FLASHBULB=45]="FX_FLASHBULB",e[e.FX_SHRED=46]="FX_SHRED",e[e.FX_WHEELREVERSE=47]="FX_WHEELREVERSE",e[e.FX_PPT15_PRESET_FIRST=48]="FX_PPT15_PRESET_FIRST",e[e.FX_FALLOVER=48]="FX_FALLOVER",e[e.FX_DRAPE=49]="FX_DRAPE",e[e.FX_CURTAINS=50]="FX_CURTAINS",e[e.FX_WIND=51]="FX_WIND",e[e.FX_PRESTIGE=52]="FX_PRESTIGE",e[e.FX_FRACTURE=53]="FX_FRACTURE",e[e.FX_CRUSH=54]="FX_CRUSH",e[e.FX_PEELOFF=55]="FX_PEELOFF",e[e.FX_PAGECURLSINGLE=56]="FX_PAGECURLSINGLE",e[e.FX_PAGECURLDOUBLE=57]="FX_PAGECURLDOUBLE",e[e.FX_AIRPLANE=58]="FX_AIRPLANE",e[e.FX_ORIGAMI=59]="FX_ORIGAMI",e[e.FX_PPT15_PRESET_LAST=59]="FX_PPT15_PRESET_LAST",e[e.FX_MORPH=60]="FX_MORPH",e[e.FX_CUSTOM=61]="FX_CUSTOM",e[e.FX_LAST=61]="FX_LAST"}(w||(w={})),function(e){e[e.oartsptLine=0]="oartsptLine",e[e.oartsptLineInverse=1]="oartsptLineInverse",e[e.oartsptTriangle=2]="oartsptTriangle",e[e.oartsptRightTriangle=3]="oartsptRightTriangle",e[e.oartsptRectangle=4]="oartsptRectangle",e[e.oartsptDiamond=5]="oartsptDiamond",e[e.oartsptParallelogram=6]="oartsptParallelogram",e[e.oartsptTrapezoid=7]="oartsptTrapezoid",e[e.oartsptNonIsoscelesTrapezoid=8]="oartsptNonIsoscelesTrapezoid",e[e.oartsptPentagon=9]="oartsptPentagon",e[e.oartsptHexagon=10]="oartsptHexagon",e[e.oartsptHeptagon=11]="oartsptHeptagon",e[e.oartsptOctagon=12]="oartsptOctagon",e[e.oartsptDecagon=13]="oartsptDecagon",e[e.oartsptDodecagon=14]="oartsptDodecagon",e[e.oartsptStar4=15]="oartsptStar4",e[e.oartsptStar5=16]="oartsptStar5",e[e.oartsptStar6=17]="oartsptStar6",e[e.oartsptStar7=18]="oartsptStar7",e[e.oartsptStar8=19]="oartsptStar8",e[e.oartsptStar10=20]="oartsptStar10",e[e.oartsptStar12=21]="oartsptStar12",e[e.oartsptStar16=22]="oartsptStar16",e[e.oartsptStar24=23]="oartsptStar24",e[e.oartsptStar32=24]="oartsptStar32",e[e.oartsptRoundRectangle=25]="oartsptRoundRectangle",e[e.oartsptRound1Rectangle=26]="oartsptRound1Rectangle",e[e.oartsptRound2SameRectangle=27]="oartsptRound2SameRectangle",e[e.oartsptRound2DiagonalRectangle=28]="oartsptRound2DiagonalRectangle",e[e.oartsptSnipRoundRectangle=29]="oartsptSnipRoundRectangle",e[e.oartsptSnip1Rectangle=30]="oartsptSnip1Rectangle",e[e.oartsptSnip2SameRectangle=31]="oartsptSnip2SameRectangle",e[e.oartsptSnip2DiagonalRectangle=32]="oartsptSnip2DiagonalRectangle",e[e.oartsptPlaque=33]="oartsptPlaque",e[e.oartsptEllipse=34]="oartsptEllipse",e[e.oartsptTeardrop=35]="oartsptTeardrop",e[e.oartsptHomePlate=36]="oartsptHomePlate",e[e.oartsptChevron=37]="oartsptChevron",e[e.oartsptPieWedge=38]="oartsptPieWedge",e[e.oartsptPie=39]="oartsptPie",e[e.oartsptBlockArc=40]="oartsptBlockArc",e[e.oartsptDonut=41]="oartsptDonut",e[e.oartsptNoSmoking=42]="oartsptNoSmoking",e[e.oartsptRightArrow=43]="oartsptRightArrow",e[e.oartsptLeftArrow=44]="oartsptLeftArrow",e[e.oartsptUpArrow=45]="oartsptUpArrow",e[e.oartsptDownArrow=46]="oartsptDownArrow",e[e.oartsptStripedRightArrow=47]="oartsptStripedRightArrow",e[e.oartsptNotchedRightArrow=48]="oartsptNotchedRightArrow",e[e.oartsptBentUpArrow=49]="oartsptBentUpArrow",e[e.oartsptLeftRightArrow=50]="oartsptLeftRightArrow",e[e.oartsptUpDownArrow=51]="oartsptUpDownArrow",e[e.oartsptLeftUpArrow=52]="oartsptLeftUpArrow",e[e.oartsptLeftRightUpArrow=53]="oartsptLeftRightUpArrow",e[e.oartsptQuadArrow=54]="oartsptQuadArrow",e[e.oartsptLeftArrowCallout=55]="oartsptLeftArrowCallout",e[e.oartsptRightArrowCallout=56]="oartsptRightArrowCallout",e[e.oartsptUpArrowCallout=57]="oartsptUpArrowCallout",e[e.oartsptDownArrowCallout=58]="oartsptDownArrowCallout",e[e.oartsptLeftRightArrowCallout=59]="oartsptLeftRightArrowCallout",e[e.oartsptUpDownArrowCallout=60]="oartsptUpDownArrowCallout",e[e.oartsptQuadArrowCallout=61]="oartsptQuadArrowCallout",e[e.oartsptBentArrow=62]="oartsptBentArrow",e[e.oartsptUturnArrow=63]="oartsptUturnArrow",e[e.oartsptCircularArrow=64]="oartsptCircularArrow",e[e.oartsptLeftCircularArrow=65]="oartsptLeftCircularArrow",e[e.oartsptLeftRightCircularArrow=66]="oartsptLeftRightCircularArrow",e[e.oartsptCurvedRightArrow=67]="oartsptCurvedRightArrow",e[e.oartsptCurvedLeftArrow=68]="oartsptCurvedLeftArrow",e[e.oartsptCurvedUpArrow=69]="oartsptCurvedUpArrow",e[e.oartsptCurvedDownArrow=70]="oartsptCurvedDownArrow",e[e.oartsptSwooshArrow=71]="oartsptSwooshArrow",e[e.oartsptCube=72]="oartsptCube",e[e.oartsptCan=73]="oartsptCan",e[e.oartsptLightningBolt=74]="oartsptLightningBolt",e[e.oartsptHeart=75]="oartsptHeart",e[e.oartsptSun=76]="oartsptSun",e[e.oartsptMoon=77]="oartsptMoon",e[e.oartsptSmileyFace=78]="oartsptSmileyFace",e[e.oartsptIrregularSeal1=79]="oartsptIrregularSeal1",e[e.oartsptIrregularSeal2=80]="oartsptIrregularSeal2",e[e.oartsptFoldedCorner=81]="oartsptFoldedCorner",e[e.oartsptBevel=82]="oartsptBevel",e[e.oartsptFrame=83]="oartsptFrame",e[e.oartsptHalfFrame=84]="oartsptHalfFrame",e[e.oartsptCorner=85]="oartsptCorner",e[e.oartsptDiagonalStripe=86]="oartsptDiagonalStripe",e[e.oartsptChord=87]="oartsptChord",e[e.oartsptArc=88]="oartsptArc",e[e.oartsptLeftBracket=89]="oartsptLeftBracket",e[e.oartsptRightBracket=90]="oartsptRightBracket",e[e.oartsptLeftBrace=91]="oartsptLeftBrace",e[e.oartsptRightBrace=92]="oartsptRightBrace",e[e.oartsptBracketPair=93]="oartsptBracketPair",e[e.oartsptBracePair=94]="oartsptBracePair",e[e.oartsptStraightConnector1=95]="oartsptStraightConnector1",e[e.oartsptBentConnector2=96]="oartsptBentConnector2",e[e.oartsptBentConnector3=97]="oartsptBentConnector3",e[e.oartsptBentConnector4=98]="oartsptBentConnector4",e[e.oartsptBentConnector5=99]="oartsptBentConnector5",e[e.oartsptCurvedConnector2=100]="oartsptCurvedConnector2",e[e.oartsptCurvedConnector3=101]="oartsptCurvedConnector3",e[e.oartsptCurvedConnector4=102]="oartsptCurvedConnector4",e[e.oartsptCurvedConnector5=103]="oartsptCurvedConnector5",e[e.oartsptCallout1=104]="oartsptCallout1",e[e.oartsptCallout2=105]="oartsptCallout2",e[e.oartsptCallout3=106]="oartsptCallout3",e[e.oartsptAccentCallout1=107]="oartsptAccentCallout1",e[e.oartsptAccentCallout2=108]="oartsptAccentCallout2",e[e.oartsptAccentCallout3=109]="oartsptAccentCallout3",e[e.oartsptBorderCallout1=110]="oartsptBorderCallout1",e[e.oartsptBorderCallout2=111]="oartsptBorderCallout2",e[e.oartsptBorderCallout3=112]="oartsptBorderCallout3",e[e.oartsptAccentBorderCallout1=113]="oartsptAccentBorderCallout1",e[e.oartsptAccentBorderCallout2=114]="oartsptAccentBorderCallout2",e[e.oartsptAccentBorderCallout3=115]="oartsptAccentBorderCallout3",e[e.oartsptWedgeRectCallout=116]="oartsptWedgeRectCallout",e[e.oartsptWedgeRRectCallout=117]="oartsptWedgeRRectCallout",e[e.oartsptWedgeEllipseCallout=118]="oartsptWedgeEllipseCallout",e[e.oartsptCloudCallout=119]="oartsptCloudCallout",e[e.oartsptCloud=120]="oartsptCloud",e[e.oartsptRibbon=121]="oartsptRibbon",e[e.oartsptRibbon2=122]="oartsptRibbon2",e[e.oartsptEllipseRibbon=123]="oartsptEllipseRibbon",e[e.oartsptEllipseRibbon2=124]="oartsptEllipseRibbon2",e[e.oartsptLeftRightRibbon=125]="oartsptLeftRightRibbon",e[e.oartsptVerticalScroll=126]="oartsptVerticalScroll",e[e.oartsptHorizontalScroll=127]="oartsptHorizontalScroll",e[e.oartsptWave=128]="oartsptWave",e[e.oartsptDoubleWave=129]="oartsptDoubleWave",e[e.oartsptPlus=130]="oartsptPlus",e[e.oartsptFlowChartProcess=131]="oartsptFlowChartProcess",e[e.oartsptFlowChartDecision=132]="oartsptFlowChartDecision",e[e.oartsptFlowChartInputOutput=133]="oartsptFlowChartInputOutput",e[e.oartsptFlowChartPredefinedProcess=134]="oartsptFlowChartPredefinedProcess",e[e.oartsptFlowChartInternalStorage=135]="oartsptFlowChartInternalStorage",e[e.oartsptFlowChartDocument=136]="oartsptFlowChartDocument",e[e.oartsptFlowChartMultidocument=137]="oartsptFlowChartMultidocument",e[e.oartsptFlowChartTerminator=138]="oartsptFlowChartTerminator",e[e.oartsptFlowChartPreparation=139]="oartsptFlowChartPreparation",e[e.oartsptFlowChartManualInput=140]="oartsptFlowChartManualInput",e[e.oartsptFlowChartManualOperation=141]="oartsptFlowChartManualOperation",e[e.oartsptFlowChartConnector=142]="oartsptFlowChartConnector",e[e.oartsptFlowChartPunchedCard=143]="oartsptFlowChartPunchedCard",e[e.oartsptFlowChartPunchedTape=144]="oartsptFlowChartPunchedTape",e[e.oartsptFlowChartSummingJunction=145]="oartsptFlowChartSummingJunction",e[e.oartsptFlowChartOr=146]="oartsptFlowChartOr",e[e.oartsptFlowChartCollate=147]="oartsptFlowChartCollate",e[e.oartsptFlowChartSort=148]="oartsptFlowChartSort",e[e.oartsptFlowChartExtract=149]="oartsptFlowChartExtract",e[e.oartsptFlowChartMerge=150]="oartsptFlowChartMerge",e[e.oartsptFlowChartOfflineStorage=151]="oartsptFlowChartOfflineStorage",e[e.oartsptFlowChartOnlineStorage=152]="oartsptFlowChartOnlineStorage",e[e.oartsptFlowChartMagneticTape=153]="oartsptFlowChartMagneticTape",e[e.oartsptFlowChartMagneticDisk=154]="oartsptFlowChartMagneticDisk",e[e.oartsptFlowChartMagneticDrum=155]="oartsptFlowChartMagneticDrum",e[e.oartsptFlowChartDisplay=156]="oartsptFlowChartDisplay",e[e.oartsptFlowChartDelay=157]="oartsptFlowChartDelay",e[e.oartsptFlowChartAlternateProcess=158]="oartsptFlowChartAlternateProcess",e[e.oartsptFlowChartOffpageConnector=159]="oartsptFlowChartOffpageConnector",e[e.oartsptActionButtonBlank=160]="oartsptActionButtonBlank",e[e.oartsptActionButtonHome=161]="oartsptActionButtonHome",e[e.oartsptActionButtonHelp=162]="oartsptActionButtonHelp",e[e.oartsptActionButtonInformation=163]="oartsptActionButtonInformation",e[e.oartsptActionButtonForwardNext=164]="oartsptActionButtonForwardNext",e[e.oartsptActionButtonBackPrevious=165]="oartsptActionButtonBackPrevious",e[e.oartsptActionButtonEnd=166]="oartsptActionButtonEnd",e[e.oartsptActionButtonBeginning=167]="oartsptActionButtonBeginning",e[e.oartsptActionButtonReturn=168]="oartsptActionButtonReturn",e[e.oartsptActionButtonDocument=169]="oartsptActionButtonDocument",e[e.oartsptActionButtonSound=170]="oartsptActionButtonSound",e[e.oartsptActionButtonMovie=171]="oartsptActionButtonMovie",e[e.oartsptGear6=172]="oartsptGear6",e[e.oartsptGear9=173]="oartsptGear9",e[e.oartsptFunnel=174]="oartsptFunnel",e[e.oartsptMathPlus=175]="oartsptMathPlus",e[e.oartsptMathMinus=176]="oartsptMathMinus",e[e.oartsptMathMultiply=177]="oartsptMathMultiply",e[e.oartsptMathDivide=178]="oartsptMathDivide",e[e.oartsptMathEqual=179]="oartsptMathEqual",e[e.oartsptMathNotEqual=180]="oartsptMathNotEqual",e[e.oartsptCornerTabs=181]="oartsptCornerTabs",e[e.oartsptSquareTabs=182]="oartsptSquareTabs",e[e.oartsptPlaqueTabs=183]="oartsptPlaqueTabs",e[e.oartsptChartX=184]="oartsptChartX",e[e.oartsptChartStar=185]="oartsptChartStar",e[e.oartsptChartPlus=186]="oartsptChartPlus",e[e.ShapeType_MaxEnumIDs=187]="ShapeType_MaxEnumIDs"}(i||(i={})),function(e){e[e.oartalignTopLeft=0]="oartalignTopLeft",e[e.oartalignTop=1]="oartalignTop",e[e.oartalignTopRight=2]="oartalignTopRight",e[e.oartalignLeft=3]="oartalignLeft",e[e.oartalignCenter=4]="oartalignCenter",e[e.oartalignRight=5]="oartalignRight",e[e.oartalignBottomLeft=6]="oartalignBottomLeft",e[e.oartalignBottom=7]="oartalignBottom",e[e.oartalignBottomRight=8]="oartalignBottomRight",e[e.RectAlignment_MaxEnumIDs=9]="RectAlignment_MaxEnumIDs"}(I||(I={})),function(e){e[e.oartshadow1=0]="oartshadow1",e[e.oartshadow2=1]="oartshadow2",e[e.oartshadow3=2]="oartshadow3",e[e.oartshadow4=3]="oartshadow4",e[e.oartshadow5=4]="oartshadow5",e[e.oartshadow6=5]="oartshadow6",e[e.oartshadow7=6]="oartshadow7",e[e.oartshadow8=7]="oartshadow8",e[e.oartshadow9=8]="oartshadow9",e[e.oartshadow10=9]="oartshadow10",e[e.oartshadow11=10]="oartshadow11",e[e.oartshadow12=11]="oartshadow12",e[e.oartshadow13=12]="oartshadow13",e[e.oartshadow14=13]="oartshadow14",e[e.oartshadow15=14]="oartshadow15",e[e.oartshadow16=15]="oartshadow16",e[e.oartshadow17=16]="oartshadow17",e[e.oartshadow18=17]="oartshadow18",e[e.oartshadow19=18]="oartshadow19",e[e.oartshadow20=19]="oartshadow20",e[e.PresetShadowVal_MaxEnumIDs=20]="PresetShadowVal_MaxEnumIDs"}(P||(P={}));var N,O,D,L,R,F,M,B,U=new Map([["Left",0],["Center",1],["Right",2],["Top",3],["Middle",4],["Bottom",5]]),z=new Map([["Vertical",0],["Horizontal",1]]),H=new Map([["LowerLetter",4],["UpperLetter",5],["Arabic",8],["LowerRoman",14],["UpperRoman",15],["Circlular",16],["EastAsian",21],["Hebrew",30],["ThaiAlpha",31],["ThaiNum",34],["HindiAlpha",37],["HindiNum",38]]);!function(e){e[e.noCaps=0]="noCaps",e[e.smallCaps=1]="smallCaps",e[e.allCaps=2]="allCaps"}(N||(N={})),function(e){e[e.fxtypeUnknown=0]="fxtypeUnknown",e[e.fxtypeEntrance=1]="fxtypeEntrance",e[e.fxtypeExit=2]="fxtypeExit",e[e.fxtypeEmphasis=3]="fxtypeEmphasis",e[e.fxtypeMotionPath=4]="fxtypeMotionPath",e[e.fxtypeActionVerb=5]="fxtypeActionVerb",e[e.fxtypeMediaCommand=6]="fxtypeMediaCommand",e[e.fxtypeHostCommand=7]="fxtypeHostCommand"}(O||(O={})),function(e){e[e.fxidCustomEntrance=0]="fxidCustomEntrance",e[e.fxidCustomExit=0]="fxidCustomExit",e[e.fxid_ENTRANCEEXIT_FIRST=1]="fxid_ENTRANCEEXIT_FIRST",e[e.fxidAppear=1]="fxidAppear",e[e.fxidFly=2]="fxidFly",e[e.fxidBlinds=3]="fxidBlinds",e[e.fxidBox=4]="fxidBox",e[e.fxidCheckerboard=5]="fxidCheckerboard",e[e.fxidCircle=6]="fxidCircle",e[e.fxidCrawl=7]="fxidCrawl",e[e.fxidDiamond=8]="fxidDiamond",e[e.fxidDissolve=9]="fxidDissolve",e[e.fxidFade=10]="fxidFade",e[e.fxidFlashOnce=11]="fxidFlashOnce",e[e.fxidPeek=12]="fxidPeek",e[e.fxidPlus=13]="fxidPlus",e[e.fxidRandomBars=14]="fxidRandomBars",e[e.fxidSpiral=15]="fxidSpiral",e[e.fxidSplit=16]="fxidSplit",e[e.fxidStretch=17]="fxidStretch",e[e.fxidCollapse=17]="fxidCollapse",e[e.fxidStrips=18]="fxidStrips",e[e.fxidSwivel=19]="fxidSwivel",e[e.fxidWedge=20]="fxidWedge",e[e.fxidWheel=21]="fxidWheel",e[e.fxidWipe=22]="fxidWipe",e[e.fxidZoom=23]="fxidZoom",e[e.fxidRandomEffects=24]="fxidRandomEffects",e[e.fxidBoomerang=25]="fxidBoomerang",e[e.fxidBounce=26]="fxidBounce",e[e.fxidColorReveal=27]="fxidColorReveal",e[e.fxidCredits=28]="fxidCredits",e[e.fxidEaseIn=29]="fxidEaseIn",e[e.fxidFloat=30]="fxidFloat",e[e.fxidGrowAndTurn=31]="fxidGrowAndTurn",e[e.OBSOLETE_fxidImpact=32]="OBSOLETE_fxidImpact",e[e.OBSOLETE_fxidIris=33]="OBSOLETE_fxidIris",e[e.fxidLightSpeed=34]="fxidLightSpeed",e[e.fxidPinwheel=35]="fxidPinwheel",e[e.OBSOLETE_fxidPulse=36]="OBSOLETE_fxidPulse",e[e.fxidRiseUp=37]="fxidRiseUp",e[e.fxidSinkDown=37]="fxidSinkDown",e[e.fxidSwish=38]="fxidSwish",e[e.fxidThinLine=39]="fxidThinLine",e[e.fxidUnfold=40]="fxidUnfold",e[e.fxidWhip=41]="fxidWhip",e[e.fxidAscend=42]="fxidAscend",e[e.fxidCenterRevolve=43]="fxidCenterRevolve",e[e.OBSOLETE_fxidFadedAscend=44]="OBSOLETE_fxidFadedAscend",e[e.fxidFadedSwivel=45]="fxidFadedSwivel",e[e.OBSOLETE_fxidFadedWipe=46]="OBSOLETE_fxidFadedWipe",e[e.fxidDescend=47]="fxidDescend",e[e.fxidSling=48]="fxidSling",e[e.fxidSpinner=49]="fxidSpinner",e[e.fxidCompress=50]="fxidCompress",e[e.fxidStretchy=50]="fxidStretchy",e[e.fxidZip=51]="fxidZip",e[e.fxidArcUp=52]="fxidArcUp",e[e.fxidFadedZoom=53]="fxidFadedZoom",e[e.fxidGlide=54]="fxidGlide",e[e.fxidExpand=55]="fxidExpand",e[e.fxidContract=55]="fxidContract",e[e.fxidFlip=56]="fxidFlip",e[e.OBSOLETE_fxidShimmer=57]="OBSOLETE_fxidShimmer",e[e.fxidFold=58]="fxidFold",e[e.fxidAppearAndPlay=59]="fxidAppearAndPlay",e[e.fxid3DArrive=60]="fxid3DArrive",e[e.fxid3DFlyIn=61]="fxid3DFlyIn",e[e.fxid3DRollIn=62]="fxid3DRollIn",e[e.fxidDraw=63]="fxidDraw"}(D||(D={})),function(e){e[e.fxidCustomEmphasis=0]="fxidCustomEmphasis",e[e.fxid_EMPHASIS_FIRST=1]="fxid_EMPHASIS_FIRST",e[e.fxidChangeFillColor=1]="fxidChangeFillColor",e[e.fxidChangeFont=2]="fxidChangeFont",e[e.fxidChangeFontColor=3]="fxidChangeFontColor",e[e.fxidChangeFontSize=4]="fxidChangeFontSize",e[e.fxidChangeFontStyle=5]="fxidChangeFontStyle",e[e.fxidGrowShrink=6]="fxidGrowShrink",e[e.fxidChangeLineColor=7]="fxidChangeLineColor",e[e.fxidSpin=8]="fxidSpin",e[e.fxidTransparency=9]="fxidTransparency",e[e.fxidBoldFlash=10]="fxidBoldFlash",e[e.OBSOLETE_fxidFall=11]="OBSOLETE_fxidFall",e[e.OBSOLETE_fxidPinch=12]="OBSOLETE_fxidPinch",e[e.OBSOLETE_fxidAllCaps=13]="OBSOLETE_fxidAllCaps",e[e.fxidBlast=14]="fxidBlast",e[e.fxidBoldReveal=15]="fxidBoldReveal",e[e.fxidBrushOnColor=16]="fxidBrushOnColor",e[e.OBSOLETE_fxidBrushOnHighlight=17]="OBSOLETE_fxidBrushOnHighlight",e[e.fxidBrushOnUnderline=18]="fxidBrushOnUnderline",e[e.fxidColorBlend=19]="fxidColorBlend",e[e.fxidColorWave=20]="fxidColorWave",e[e.fxidComplementaryColor=21]="fxidComplementaryColor",e[e.fxidComplementaryColor2=22]="fxidComplementaryColor2",e[e.fxidContrastingColor=23]="fxidContrastingColor",e[e.fxidDarken=24]="fxidDarken",e[e.fxidDesaturate=25]="fxidDesaturate",e[e.fxidFlashBulb=26]="fxidFlashBulb",e[e.fxidFlicker=27]="fxidFlicker",e[e.fxidGrowWithColor=28]="fxidGrowWithColor",e[e.OBSOLETE_fxidHighlight=29]="OBSOLETE_fxidHighlight",e[e.fxidLighten=30]="fxidLighten",e[e.fxidStyleEmphasis=31]="fxidStyleEmphasis",e[e.fxidTeeter=32]="fxidTeeter",e[e.fxidVerticalGrow=33]="fxidVerticalGrow",e[e.fxidWave=34]="fxidWave",e[e.fxidBlink=35]="fxidBlink",e[e.fxidShimmer=36]="fxidShimmer",e[e.fxid3DTurntable=37]="fxid3DTurntable",e[e.fxid3DSwing=38]="fxid3DSwing",e[e.fxid3DJumpAndTurn=39]="fxid3DJumpAndTurn",e[e.fxid3DFly=40]="fxid3DFly",e[e.fxid3DHover=41]="fxid3DHover",e[e.fxid_EMPHASIS_COUNT_GENERIC=42]="fxid_EMPHASIS_COUNT_GENERIC",e[e.fxid_EMPHASIS_FIRST_EMBEDDED=100]="fxid_EMPHASIS_FIRST_EMBEDDED",e[e.fxidEmbedded1=100]="fxidEmbedded1",e[e.fxidEmbedded2=101]="fxidEmbedded2",e[e.fxidEmbedded3=102]="fxidEmbedded3",e[e.fxidEmbedded4=103]="fxidEmbedded4",e[e.fxidEmbedded5=104]="fxidEmbedded5",e[e.fxidEmbedded6=105]="fxidEmbedded6",e[e.fxidEmbedded7=106]="fxidEmbedded7",e[e.fxidEmbedded8=107]="fxidEmbedded8",e[e.fxidEmbedded9=108]="fxidEmbedded9",e[e.fxidEmbedded10=109]="fxidEmbedded10",e[e.fxidEmbedded11=110]="fxidEmbedded11",e[e.fxidEmbedded12=111]="fxidEmbedded12",e[e.fxidEmbedded13=112]="fxidEmbedded13",e[e.fxidEmbedded14=113]="fxidEmbedded14",e[e.fxidEmbedded15=114]="fxidEmbedded15",e[e.fxidEmbedded16=115]="fxidEmbedded16",e[e.fxidEmbedded17=116]="fxidEmbedded17",e[e.fxidEmbedded18=117]="fxidEmbedded18",e[e.fxid_EMPHASIS_COUNT_EMBEDDED=18]="fxid_EMPHASIS_COUNT_EMBEDDED",e[e.fxid_EMPHASIS_LAST_EMBEDDED=117]="fxid_EMPHASIS_LAST_EMBEDDED",e[e.fxid_EMPHASIS_LAST=117]="fxid_EMPHASIS_LAST"}(L||(L={})),function(e){e[e.fxidCustomMotionPath=0]="fxidCustomMotionPath",e[e.fxid_MOTIONPATH_FIRST=1]="fxid_MOTIONPATH_FIRST",e[e.fxidPathCircle=1]="fxidPathCircle",e[e.fxidPathRightTriangle=2]="fxidPathRightTriangle",e[e.fxidPathDiamond=3]="fxidPathDiamond",e[e.fxidPathHexagon=4]="fxidPathHexagon",e[e.fxidPath5PointStar=5]="fxidPath5PointStar",e[e.fxidPathCrescentMoon=6]="fxidPathCrescentMoon",e[e.fxidPathSquare=7]="fxidPathSquare",e[e.fxidPathTrapezoid=8]="fxidPathTrapezoid",e[e.fxidPathHeart=9]="fxidPathHeart",e[e.fxidPathOctagon=10]="fxidPathOctagon",e[e.fxidPath6PointStar=11]="fxidPath6PointStar",e[e.fxidPathFootball=12]="fxidPathFootball",e[e.fxidPathEqualTriangle=13]="fxidPathEqualTriangle",e[e.fxidPathParallelogram=14]="fxidPathParallelogram",e[e.fxidPathPentagon=15]="fxidPathPentagon",e[e.fxidPath4PointStar=16]="fxidPath4PointStar",e[e.fxidPath8PointStar=17]="fxidPath8PointStar",e[e.fxidPathTeardrop=18]="fxidPathTeardrop",e[e.fxidPathPointyStar=19]="fxidPathPointyStar",e[e.fxidPathCurvedSquare=20]="fxidPathCurvedSquare",e[e.fxidPathCurvedX=21]="fxidPathCurvedX",e[e.fxidPathVerticalFigure8=22]="fxidPathVerticalFigure8",e[e.fxidPathCurvyStar=23]="fxidPathCurvyStar",e[e.fxidPathLoopdeLoop=24]="fxidPathLoopdeLoop",e[e.fxidPathBuzzsaw=25]="fxidPathBuzzsaw",e[e.fxidPathHorizontalFigure8=26]="fxidPathHorizontalFigure8",e[e.fxidPathPeanut=27]="fxidPathPeanut",e[e.fxidPathFigure8Four=28]="fxidPathFigure8Four",e[e.fxidPathNeutron=29]="fxidPathNeutron",e[e.fxidPathSwoosh=30]="fxidPathSwoosh",e[e.fxidPathBean=31]="fxidPathBean",e[e.fxidPathPlus=32]="fxidPathPlus",e[e.fxidPathInvertedTriangle=33]="fxidPathInvertedTriangle",e[e.fxidPathInvertedSquare=34]="fxidPathInvertedSquare",e[e.fxidPathLeft=35]="fxidPathLeft",e[e.fxidPathTurnRight=36]="fxidPathTurnRight",e[e.fxidPathArcDown=37]="fxidPathArcDown",e[e.fxidPathZigzag=38]="fxidPathZigzag",e[e.fxidPathSCurve2=39]="fxidPathSCurve2",e[e.fxidPathSineWave=40]="fxidPathSineWave",e[e.fxidPathBounceLeft=41]="fxidPathBounceLeft",e[e.fxidPathDown=42]="fxidPathDown",e[e.fxidPathTurnUp=43]="fxidPathTurnUp",e[e.fxidPathArcUp=44]="fxidPathArcUp",e[e.fxidPathHeartbeat=45]="fxidPathHeartbeat",e[e.fxidPathSpiralRight=46]="fxidPathSpiralRight",e[e.fxidPathWave=47]="fxidPathWave",e[e.fxidPathCurvyLeft=48]="fxidPathCurvyLeft",e[e.fxidPathDiagonalDownRight=49]="fxidPathDiagonalDownRight",e[e.fxidPathTurnDown=50]="fxidPathTurnDown",e[e.fxidPathArcLeft=51]="fxidPathArcLeft",e[e.fxidPathFunnel=52]="fxidPathFunnel",e[e.fxidPathSpring=53]="fxidPathSpring",e[e.fxidPathBounceRight=54]="fxidPathBounceRight",e[e.fxidPathSpiralLeft=55]="fxidPathSpiralLeft",e[e.fxidPathDiagonalUpRight=56]="fxidPathDiagonalUpRight",e[e.fxidPathTurnUpRight=57]="fxidPathTurnUpRight",e[e.fxidPathArcRight=58]="fxidPathArcRight",e[e.fxidPathSCurve1=59]="fxidPathSCurve1",e[e.fxidPathDecayingWave=60]="fxidPathDecayingWave",e[e.fxidPathCurvyRight=61]="fxidPathCurvyRight",e[e.fxidPathStairsDown=62]="fxidPathStairsDown",e[e.fxidPathRight=63]="fxidPathRight",e[e.fxidPathUp=64]="fxidPathUp",e[e.fxid_MOTIONPATH_COUNT=65]="fxid_MOTIONPATH_COUNT"}(R||(R={})),function(e){e[e.fxidCustomMediaCommand=0]="fxidCustomMediaCommand",e[e.fxid_MEDIA_FIRST=1]="fxid_MEDIA_FIRST",e[e.fxidMediaPlay=1]="fxidMediaPlay",e[e.fxidMediaPause=2]="fxidMediaPause",e[e.fxidMediaStop=3]="fxidMediaStop",e[e.fxidMediaPlayFromBookmark=4]="fxidMediaPlayFromBookmark",e[e.fxid_MEDIA_COUNT=5]="fxid_MEDIA_COUNT"}(F||(F={})),function(e){e[e.fxidCustomHostCommand=0]="fxidCustomHostCommand",e[e.fxid_HOSTCOMMAND_FIRST=1]="fxid_HOSTCOMMAND_FIRST",e[e.fxidHostGoNextSlide=1]="fxidHostGoNextSlide",e[e.fxid_HOSTCOMMAND_COUNT=2]="fxid_HOSTCOMMAND_COUNT"}(M||(M={})),function(e){e[e.noStrike=0]="noStrike",e[e.singleStrike=1]="singleStrike",e[e.doubleStrike=2]="doubleStrike"}(B||(B={}))},71822:(e,t,n)=>{"use strict";n.d(t,{I:()=>d,R:()=>f});var r=n(43032),o=n(79490),i=n(12063),a=n(44121),s=n(18758),l=n(1134),c=n(14213),u=n(55564);function d(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(e){var t,n,r,u,d,p,f,h,g,m;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides,r=e.description;try{c.K.getInstance().setScenarioName(a.Cu.InsertImage)}catch(e){(0,s.cY)("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}u={version:a.xv,name:a._u.AddPictureCmd,data:"",sourceType:a.fK.Link,altText:"",target:{type:1,id:0,cId:0}},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.U.findImageDataFromDescription(r)];case 2:return d=o.sent(),[3,4];case 3:throw p=o.sent(),(0,s.cY)("Error while fetching url for image with description - "+r),p;case 4:return u.data=d.url,u.altText=null!==(f=d.altText)&&void 0!==f?f:"",0!==n.length?[3,6]:[4,(0,l.q0)(t)];case 5:n=o.sent(),o.label=6;case 6:return h={},0!==n.length?[3,8]:[4,(0,l.MK)(t,n)];case 7:return g=o.sent().split("#"),h={type:1,id:+g[0],cId:+g[1]},[3,9];case 8:m=n[0].id.split("#"),h={type:1,id:+m[0],cId:+m[1]},o.label=9;case 9:return u.target=h,[2,u]}}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){var t,n,r,i,c,d,p,f,h,g,m;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides,r=e.imageData,o.label=1;case 1:if(o.trys.push([1,9,,10]),!r.url)throw i="Invalid url for image data",(0,s.cY)(i),new Error(i);return(0,u.PA)(u.IY.IsPACTokenEnabled)&&r.pac?[4,(0,s.X9)(r.url,r.pac)]:[3,3];case 2:(c=o.sent())?r.url=c:(0,s.cY)("Failed to download image with PAC"),o.label=3;case 3:return p={version:a.xv,name:a._u.AddPictureCmd,data:r.url,sourceType:"data:"===r.url.substring(0,5)?a.fK.Raw64:a.fK.Link,altText:null!==(d=r.altText)&&void 0!==d?d:"",target:{type:1,id:0,cId:0}},0!==n.length?[3,5]:[4,(0,l.q0)(t)];case 4:n=o.sent(),o.label=5;case 5:return f={},0!==n.length?[3,7]:[4,(0,l.MK)(t,n)];case 6:return h=o.sent().split("#"),f={type:1,id:+h[0],cId:+h[1]},[3,8];case 7:g=n[0].id.split("#"),f={type:1,id:+g[0],cId:+g[1]},o.label=8;case 8:return p.target=f,[2,p];case 9:throw m=o.sent(),(0,s.cY)("Error while creating insert image object from image data"),m;case 10:return[2]}}))}))).apply(this,arguments)}},91532:(e,t,n)=>{"use strict";n.d(t,{BM:()=>f,bA:()=>u,fx:()=>a,gu:()=>c,l1:()=>l,su:()=>s,tb:()=>d,w7:()=>i,xG:()=>o,yf:()=>p});var r=n(44121),o={first:r.kV.FX_FIRST,cut:r.kV.FX_CUT,none:r.kV.FX_NONE,random:r.kV.FX_RANDOM,blinds:r.kV.FX_BLINDS,checker:r.kV.FX_CHECKER,checkerboard:r.kV.FX_CHECKER,cover:r.kV.FX_COVER,dissolve:r.kV.FX_DISSOLVE,fade:r.kV.FX_FADE,pull:r.kV.FX_PULL,randombar:r.kV.FX_RANDOMBAR,randombars:r.kV.FX_RANDOMBARS,strips:r.kV.FX_STRIPS,wipe:r.kV.FX_WIPE,zoom:r.kV.FX_ZOOM,fly:r.kV.FX_FLY,split:r.kV.FX_SPLIT,flash:r.kV.FX_FLASH,pp9:r.kV.FX_PP9,DEP_wheel:r.kV.FX_WHEEL,DEP_circle:r.kV.FX_CIRCLE,diamond:r.kV.FX_DIAMOND,plus:r.kV.FX_PLUS,wedge:r.kV.FX_WEDGE,push:r.kV.FX_PUSH,comb:r.kV.FX_COMB,newsflash:r.kV.FX_NEWSFLASH,alphafade:r.kV.FX_ALPHAFADE,blur:r.kV.FX_BLUR,pushelem:r.kV.FX_PUSHELEM,wheel:r.kV.FX_WHEEL,circle:r.kV.FX_CIRCLE,ppt12_compatibility:r.kV.FX_PPT12_COMPATIBILITY,vortex:r.kV.FX_VORTEX,ripple:r.kV.FX_RIPPLE,glitter:r.kV.FX_GLITTER,flythrough:r.kV.FX_FLYTHROUGH,flythrough_content:r.kV.FX_FLYTHROUGH_CONTENT,doors:r.kV.FX_DOORS,doors_content:r.kV.FX_DOORS_CONTENT,panbounce_content:r.kV.FX_PANBOUNCE_CONTENT,pan3d_content:r.kV.FX_PAN3D_CONTENT,conveyor:r.kV.FX_CONVEYOR,pan3d:r.kV.FX_PAN3D,gallery:r.kV.FX_GALLERY,crosszoom:r.kV.FX_CROSSZOOM,reveal:r.kV.FX_REVEAL,honeycomb:r.kV.FX_HONEYCOMB,ferris_content:r.kV.FX_FERRIS_CONTENT,ferriswheel:r.kV.FX_FERRISWHEEL,switch:r.kV.FX_SWITCH,flip:r.kV.FX_FLIP,prism:r.kV.FX_PRISM,flashbulb:r.kV.FX_FLASHBULB,shred:r.kV.FX_SHRED,wheelreverse:r.kV.FX_WHEELREVERSE,ppt15_preset_first:r.kV.FX_PPT15_PRESET_FIRST,fallover:r.kV.FX_FALLOVER,drape:r.kV.FX_DRAPE,curtains:r.kV.FX_CURTAINS,wind:r.kV.FX_WIND,prestige:r.kV.FX_PRESTIGE,fracture:r.kV.FX_FRACTURE,crush:r.kV.FX_CRUSH,peeloff:r.kV.FX_PEELOFF,pagecurl:r.kV.FX_PAGECURLSINGLE,pagecurlsingle:r.kV.FX_PAGECURLSINGLE,pagecurldouble:r.kV.FX_PAGECURLDOUBLE,airplane:r.kV.FX_AIRPLANE,origami:r.kV.FX_ORIGAMI,ppt15_preset_last:r.kV.FX_PPT15_PRESET_LAST,morph:r.kV.FX_MORPH,custom:r.kV.FX_CUSTOM},i={line:r.IO.oartsptLine,lineinverse:r.IO.oartsptLineInverse,triangle:r.IO.oartsptTriangle,righttriangle:r.IO.oartsptRightTriangle,rectangle:r.IO.oartsptRectangle,diamond:r.IO.oartsptDiamond,parallelogram:r.IO.oartsptParallelogram,trapezoid:r.IO.oartsptTrapezoid,nonisoscelestrapezoid:r.IO.oartsptNonIsoscelesTrapezoid,pentagon:r.IO.oartsptPentagon,hexagon:r.IO.oartsptHexagon,heptagon:r.IO.oartsptHeptagon,octagon:r.IO.oartsptOctagon,decagon:r.IO.oartsptDecagon,dodecagon:r.IO.oartsptDodecagon,star4:r.IO.oartsptStar4,star5:r.IO.oartsptStar5,star6:r.IO.oartsptStar6,star7:r.IO.oartsptStar7,star8:r.IO.oartsptStar8,star10:r.IO.oartsptStar10,star12:r.IO.oartsptStar12,star16:r.IO.oartsptStar16,star24:r.IO.oartsptStar24,star32:r.IO.oartsptStar32,roundrectangle:r.IO.oartsptRoundRectangle,round1rectangle:r.IO.oartsptRound1Rectangle,round2samerectangle:r.IO.oartsptRound2SameRectangle,round2diagonalrectangle:r.IO.oartsptRound2DiagonalRectangle,sniproundrectangle:r.IO.oartsptSnipRoundRectangle,snip1rectangle:r.IO.oartsptSnip1Rectangle,snip2samerectangle:r.IO.oartsptSnip2SameRectangle,snip2diagonalrectangle:r.IO.oartsptSnip2DiagonalRectangle,plaque:r.IO.oartsptPlaque,ellipse:r.IO.oartsptEllipse,teardrop:r.IO.oartsptTeardrop,homeplate:r.IO.oartsptHomePlate,chevron:r.IO.oartsptChevron,piewedge:r.IO.oartsptPieWedge,pie:r.IO.oartsptPie,blockarc:r.IO.oartsptBlockArc,donut:r.IO.oartsptDonut,nosmoking:r.IO.oartsptNoSmoking,rightarrow:r.IO.oartsptRightArrow,leftarrow:r.IO.oartsptLeftArrow,uparrow:r.IO.oartsptUpArrow,downarrow:r.IO.oartsptDownArrow,stripedrightarrow:r.IO.oartsptStripedRightArrow,notchedrightarrow:r.IO.oartsptNotchedRightArrow,bentuparrow:r.IO.oartsptBentUpArrow,leftrightarrow:r.IO.oartsptLeftRightArrow,updownarrow:r.IO.oartsptUpDownArrow,leftuparrow:r.IO.oartsptLeftUpArrow,leftrightuparrow:r.IO.oartsptLeftRightUpArrow,quadarrow:r.IO.oartsptQuadArrow,leftarrowcallout:r.IO.oartsptLeftArrowCallout,rightarrowcallout:r.IO.oartsptRightArrowCallout,uparrowcallout:r.IO.oartsptUpArrowCallout,downarrowcallout:r.IO.oartsptDownArrowCallout,leftrightarrowcallout:r.IO.oartsptLeftRightArrowCallout,updownarrowcallout:r.IO.oartsptUpDownArrowCallout,quadarrowcallout:r.IO.oartsptQuadArrowCallout,bentarrow:r.IO.oartsptBentArrow,uturnarrow:r.IO.oartsptUturnArrow,circulararrow:r.IO.oartsptCircularArrow,leftcirculararrow:r.IO.oartsptLeftCircularArrow,leftrightcirculararrow:r.IO.oartsptLeftRightCircularArrow,curvedrightarrow:r.IO.oartsptCurvedRightArrow,curvedleftarrow:r.IO.oartsptCurvedLeftArrow,curveduparrow:r.IO.oartsptCurvedUpArrow,curveddownarrow:r.IO.oartsptCurvedDownArrow,swoosharrow:r.IO.oartsptSwooshArrow,cube:r.IO.oartsptCube,can:r.IO.oartsptCan,lightningbolt:r.IO.oartsptLightningBolt,heart:r.IO.oartsptHeart,sun:r.IO.oartsptSun,moon:r.IO.oartsptMoon,smileyface:r.IO.oartsptSmileyFace,irregularseal1:r.IO.oartsptIrregularSeal1,irregularseal2:r.IO.oartsptIrregularSeal2,foldedcorner:r.IO.oartsptFoldedCorner,bevel:r.IO.oartsptBevel,frame:r.IO.oartsptFrame,halfframe:r.IO.oartsptHalfFrame,corner:r.IO.oartsptCorner,diagonalstripe:r.IO.oartsptDiagonalStripe,chord:r.IO.oartsptChord,arc:r.IO.oartsptArc,leftbracket:r.IO.oartsptLeftBracket,rightbracket:r.IO.oartsptRightBracket,leftbrace:r.IO.oartsptLeftBrace,rightbrace:r.IO.oartsptRightBrace,bracketpair:r.IO.oartsptBracketPair,bracepair:r.IO.oartsptBracePair,straightconnector1:r.IO.oartsptStraightConnector1,bentconnector2:r.IO.oartsptBentConnector2,bentconnector3:r.IO.oartsptBentConnector3,bentconnector4:r.IO.oartsptBentConnector4,bentconnector5:r.IO.oartsptBentConnector5,curvedconnector2:r.IO.oartsptCurvedConnector2,curvedconnector3:r.IO.oartsptCurvedConnector3,curvedconnector4:r.IO.oartsptCurvedConnector4,curvedconnector5:r.IO.oartsptCurvedConnector5,callout1:r.IO.oartsptCallout1,callout2:r.IO.oartsptCallout2,callout3:r.IO.oartsptCallout3,accentcallout1:r.IO.oartsptAccentCallout1,accentcallout2:r.IO.oartsptAccentCallout2,accentcallout3:r.IO.oartsptAccentCallout3,bordercallout1:r.IO.oartsptBorderCallout1,bordercallout2:r.IO.oartsptBorderCallout2,bordercallout3:r.IO.oartsptBorderCallout3,accentbordercallout1:r.IO.oartsptAccentBorderCallout1,accentbordercallout2:r.IO.oartsptAccentBorderCallout2,accentbordercallout3:r.IO.oartsptAccentBorderCallout3,wedgerectcallout:r.IO.oartsptWedgeRectCallout,wedgerrectcallout:r.IO.oartsptWedgeRRectCallout,wedgeellipsecallout:r.IO.oartsptWedgeEllipseCallout,cloudcallout:r.IO.oartsptCloudCallout,cloud:r.IO.oartsptCloud,ribbon:r.IO.oartsptRibbon,ribbon2:r.IO.oartsptRibbon2,ellipseribbon:r.IO.oartsptEllipseRibbon,ellipseribbon2:r.IO.oartsptEllipseRibbon2,leftrightribbon:r.IO.oartsptLeftRightRibbon,verticalscroll:r.IO.oartsptVerticalScroll,horizontalscroll:r.IO.oartsptHorizontalScroll,wave:r.IO.oartsptWave,doublewave:r.IO.oartsptDoubleWave,plus:r.IO.oartsptPlus,flowchartprocess:r.IO.oartsptFlowChartProcess,flowchartdecision:r.IO.oartsptFlowChartDecision,flowchartinputoutput:r.IO.oartsptFlowChartInputOutput,flowchartpredefinedprocess:r.IO.oartsptFlowChartPredefinedProcess,flowchartinternalstorage:r.IO.oartsptFlowChartInternalStorage,flowchartdocument:r.IO.oartsptFlowChartDocument,flowchartmultidocument:r.IO.oartsptFlowChartMultidocument,flowchartterminator:r.IO.oartsptFlowChartTerminator,flowchartpreparation:r.IO.oartsptFlowChartPreparation,flowchartmanualinput:r.IO.oartsptFlowChartManualInput,flowchartmanualoperation:r.IO.oartsptFlowChartManualOperation,flowchartconnector:r.IO.oartsptFlowChartConnector,flowchartpunchedcard:r.IO.oartsptFlowChartPunchedCard,flowchartpunchedtape:r.IO.oartsptFlowChartPunchedTape,flowchartsummingjunction:r.IO.oartsptFlowChartSummingJunction,flowchartor:r.IO.oartsptFlowChartOr,flowchartcollate:r.IO.oartsptFlowChartCollate,flowchartsort:r.IO.oartsptFlowChartSort,flowchartextract:r.IO.oartsptFlowChartExtract,flowchartmerge:r.IO.oartsptFlowChartMerge,flowchartofflinestorage:r.IO.oartsptFlowChartOfflineStorage,flowchartonlinestorage:r.IO.oartsptFlowChartOnlineStorage,flowchartmagnetictape:r.IO.oartsptFlowChartMagneticTape,flowchartmagneticdisk:r.IO.oartsptFlowChartMagneticDisk,flowchartmagneticdrum:r.IO.oartsptFlowChartMagneticDrum,flowchartdisplay:r.IO.oartsptFlowChartDisplay,flowchartdelay:r.IO.oartsptFlowChartDelay,flowchartalternateprocess:r.IO.oartsptFlowChartAlternateProcess,flowchartoffpageconnector:r.IO.oartsptFlowChartOffpageConnector,actionbuttonblank:r.IO.oartsptActionButtonBlank,actionbuttonhome:r.IO.oartsptActionButtonHome,actionbuttonhelp:r.IO.oartsptActionButtonHelp,actionbuttoninformation:r.IO.oartsptActionButtonInformation,actionbuttonforwardnext:r.IO.oartsptActionButtonForwardNext,actionbuttonbackprevious:r.IO.oartsptActionButtonBackPrevious,actionbuttonend:r.IO.oartsptActionButtonEnd,actionbuttonbeginning:r.IO.oartsptActionButtonBeginning,actionbuttonreturn:r.IO.oartsptActionButtonReturn,actionbuttondocument:r.IO.oartsptActionButtonDocument,actionbuttonsound:r.IO.oartsptActionButtonSound,actionbuttonmovie:r.IO.oartsptActionButtonMovie,gear6:r.IO.oartsptGear6,gear9:r.IO.oartsptGear9,funnel:r.IO.oartsptFunnel,mathplus:r.IO.oartsptMathPlus,mathminus:r.IO.oartsptMathMinus,mathmultiply:r.IO.oartsptMathMultiply,mathdivide:r.IO.oartsptMathDivide,mathequal:r.IO.oartsptMathEqual,mathnotequal:r.IO.oartsptMathNotEqual,cornertabs:r.IO.oartsptCornerTabs,squaretabs:r.IO.oartsptSquareTabs,plaquetabs:r.IO.oartsptPlaqueTabs,chartx:r.IO.oartsptChartX,chartstar:r.IO.oartsptChartStar,chartplus:r.IO.oartsptChartPlus},a={shadow1:r.jb.oartshadow1,shadow2:r.jb.oartshadow2,shadow3:r.jb.oartshadow3,shadow4:r.jb.oartshadow4,shadow5:r.jb.oartshadow5,shadow6:r.jb.oartshadow6,shadow7:r.jb.oartshadow7,shadow8:r.jb.oartshadow8,shadow9:r.jb.oartshadow9,shadow10:r.jb.oartshadow10,shadow11:r.jb.oartshadow11,shadow12:r.jb.oartshadow12,shadow13:r.jb.oartshadow13,shadow14:r.jb.oartshadow14,shadow15:r.jb.oartshadow15,shadow16:r.jb.oartshadow16,shadow17:r.jb.oartshadow17,shadow18:r.jb.oartshadow18,shadow19:r.jb.oartshadow19,shadow20:r.jb.oartshadow20},s={TopLeft:r.Cw.oartalignTopLeft,Top:r.Cw.oartalignTop,TopRight:r.Cw.oartalignTopRight,Left:r.Cw.oartalignLeft,Center:r.Cw.oartalignCenter,Right:r.Cw.oartalignRight,BottomLeft:r.Cw.oartalignBottomLeft,Bottom:r.Cw.oartalignBottom,BottomRight:r.Cw.oartalignBottomRight},l={lowercase:r.B$.smallCaps,uppercase:r.B$.allCaps},c={unknown:r.kx.fxtypeUnknown,entrance:r.kx.fxtypeEntrance,exit:r.kx.fxtypeExit,emphasis:r.kx.fxtypeEmphasis,motionpath:r.kx.fxtypeMotionPath,actionverb:r.kx.fxtypeActionVerb,mediacommand:r.kx.fxtypeMediaCommand,hostcommand:r.kx.fxtypeHostCommand},u={customentrance:r.Ls.fxidCustomEntrance,customexit:r.Ls.fxidCustomExit,_entranceexit_first:r.Ls.fxid_ENTRANCEEXIT_FIRST,appear:r.Ls.fxidAppear,disappear:r.Ls.fxidAppear,fly:r.Ls.fxidFly,flyin:r.Ls.fxidFly,flyout:r.Ls.fxidFly,blinds:r.Ls.fxidBlinds,box:r.Ls.fxidBox,checkerboard:r.Ls.fxidCheckerboard,circle:r.Ls.fxidCircle,shape:r.Ls.fxidCircle,crawl:r.Ls.fxidCrawl,diamond:r.Ls.fxidDiamond,dissolve:r.Ls.fxidDissolve,fade:r.Ls.fxidFade,flashonce:r.Ls.fxidFlashOnce,peek:r.Ls.fxidPeek,plus:r.Ls.fxidPlus,randombars:r.Ls.fxidRandomBars,spiral:r.Ls.fxidSpiral,split:r.Ls.fxidSplit,stretch:r.Ls.fxidStretch,collapse:r.Ls.fxidCollapse,strips:r.Ls.fxidStrips,swivel:r.Ls.fxidSwivel,wedge:r.Ls.fxidWedge,wheel:r.Ls.fxidWheel,wipe:r.Ls.fxidWipe,zoom:r.Ls.fxidZoom,randomeffects:r.Ls.fxidRandomEffects,boomerang:r.Ls.fxidBoomerang,bounce:r.Ls.fxidBounce,colorreveal:r.Ls.fxidColorReveal,credits:r.Ls.fxidCredits,easein:r.Ls.fxidEaseIn,float:r.Ls.fxidFloat,growandturn:r.Ls.fxidGrowAndTurn,shrinkandturn:r.Ls.fxidGrowAndTurn,impact:r.Ls.OBSOLETE_fxidImpact,iris:r.Ls.OBSOLETE_fxidIris,lightspeed:r.Ls.fxidLightSpeed,pinwheel:r.Ls.fxidPinwheel,pulse:r.Ls.OBSOLETE_fxidPulse,riseup:r.Ls.fxidRiseUp,sinkdown:r.Ls.fxidSinkDown,swish:r.Ls.fxidSwish,thinline:r.Ls.fxidThinLine,unfold:r.Ls.fxidUnfold,whip:r.Ls.fxidWhip,ascend:r.Ls.fxidAscend,floatout:r.Ls.fxidAscend,centerrevolve:r.Ls.fxidCenterRevolve,fadedascend:r.Ls.OBSOLETE_fxidFadedAscend,fadedswivel:r.Ls.fxidFadedSwivel,fadedwipe:r.Ls.OBSOLETE_fxidFadedWipe,descend:r.Ls.fxidDescend,sling:r.Ls.fxidSling,spinner:r.Ls.fxidSpinner,spin:r.Ls.fxidSpinner,compress:r.Ls.fxidCompress,stretchy:r.Ls.fxidStretchy,zip:r.Ls.fxidZip,arcup:r.Ls.fxidArcUp,fadedzoom:r.Ls.fxidFadedZoom,glide:r.Ls.fxidGlide,expand:r.Ls.fxidExpand,contract:r.Ls.fxidContract,flip:r.Ls.fxidFlip,shimmer:r.Ls.OBSOLETE_fxidShimmer,fold:r.Ls.fxidFold,appearandplay:r.Ls.fxidAppearAndPlay,draw:r.Ls.fxidDraw,"3darrive":r.Ls.fxid3DArrive,"3dflyin":r.Ls.fxid3DFlyIn,"3drollin":r.Ls.fxid3DRollIn},d={customemphasis:r.BJ.fxidCustomEmphasis,_emphasis_first:r.BJ.fxid_EMPHASIS_FIRST,changefillcolor:r.BJ.fxidChangeFillColor,changefont:r.BJ.fxidChangeFont,changefontcolor:r.BJ.fxidChangeFontColor,changefontsize:r.BJ.fxidChangeFontSize,changefontstyle:r.BJ.fxidChangeFontStyle,growshrink:r.BJ.fxidGrowShrink,changelinecolor:r.BJ.fxidChangeLineColor,spin:r.BJ.fxidSpin,transparency:r.BJ.fxidTransparency,boldflash:r.BJ.fxidBoldFlash,fall:r.BJ.OBSOLETE_fxidFall,pinch:r.BJ.OBSOLETE_fxidPinch,allcaps:r.BJ.OBSOLETE_fxidAllCaps,blast:r.BJ.fxidBlast,boldreveal:r.BJ.fxidBoldReveal,brushoncolor:r.BJ.fxidBrushOnColor,brushonhighlight:r.BJ.OBSOLETE_fxidBrushOnHighlight,brushonunderline:r.BJ.fxidBrushOnUnderline,colorblend:r.BJ.fxidColorBlend,objectcolor:r.BJ.fxidColorBlend,colorwave:r.BJ.fxidColorWave,complementarycolor:r.BJ.fxidComplementaryColor,complementarycolor2:r.BJ.fxidComplementaryColor2,contrastingcolor:r.BJ.fxidContrastingColor,darken:r.BJ.fxidDarken,desaturate:r.BJ.fxidDesaturate,flashbulb:r.BJ.fxidFlashBulb,flicker:r.BJ.fxidFlicker,colorpulse:r.BJ.fxidFlicker,growwithcolor:r.BJ.fxidGrowWithColor,highlight:r.BJ.OBSOLETE_fxidHighlight,lighten:r.BJ.fxidLighten,styleemphasis:r.BJ.fxidStyleEmphasis,teeter:r.BJ.fxidTeeter,verticalgrow:r.BJ.fxidVerticalGrow,wave:r.BJ.fxidWave,blink:r.BJ.fxidBlink,shimmer:r.BJ.fxidShimmer,"3dturntable":r.BJ.fxid3DTurntable,"3dswing":r.BJ.fxid3DSwing,"3djumpandturn":r.BJ.fxid3DJumpAndTurn,"3dfly":r.BJ.fxid3DFly,"3dhover":r.BJ.fxid3DHover,_emphasis_count_generic:r.BJ.fxid_EMPHASIS_COUNT_GENERIC,_emphasis_first_embedded:r.BJ.fxid_EMPHASIS_FIRST_EMBEDDED,fxidEmbedded1:r.BJ.fxid_EMPHASIS_FIRST_EMBEDDED,embedded2:r.BJ.fxidEmbedded2,embedded3:r.BJ.fxidEmbedded3,embedded4:r.BJ.fxidEmbedded4,embedded5:r.BJ.fxidEmbedded5,embedded6:r.BJ.fxidEmbedded6,embedded7:r.BJ.fxidEmbedded7,embedded8:r.BJ.fxidEmbedded8,embedded9:r.BJ.fxidEmbedded9,embedded10:r.BJ.fxidEmbedded10,embedded11:r.BJ.fxidEmbedded11,embedded12:r.BJ.fxidEmbedded12,embedded13:r.BJ.fxidEmbedded13,embedded14:r.BJ.fxidEmbedded14,embedded15:r.BJ.fxidEmbedded15,embedded16:r.BJ.fxidEmbedded16,embedded17:r.BJ.fxidEmbedded17,embedded18:r.BJ.fxidEmbedded18},p={custommotionpath:r.KS.fxidCustomMotionPath,_motionpath_first:r.KS.fxid_MOTIONPATH_FIRST,pathcircle:r.KS.fxidPathCircle,pathrighttriangle:r.KS.fxidPathRightTriangle,pathdiamond:r.KS.fxidPathDiamond,pathhexagon:r.KS.fxidPathHexagon,path5pointstar:r.KS.fxidPath5PointStar,pathcrescentmoon:r.KS.fxidPathCrescentMoon,pathsquare:r.KS.fxidPathSquare,pathtrapezoid:r.KS.fxidPathTrapezoid,pathheart:r.KS.fxidPathHeart,pathoctagon:r.KS.fxidPathOctagon,path6pointstar:r.KS.fxidPath6PointStar,pathfootball:r.KS.fxidPathFootball,pathequaltriangle:r.KS.fxidPathEqualTriangle,pathparallelogram:r.KS.fxidPathParallelogram,pathpentagon:r.KS.fxidPathPentagon,path4pointstar:r.KS.fxidPath4PointStar,path8pointstar:r.KS.fxidPath8PointStar,pathteardrop:r.KS.fxidPathTeardrop,pathpointystar:r.KS.fxidPathPointyStar,pathcurvedsquare:r.KS.fxidPathCurvedSquare,pathcurvedx:r.KS.fxidPathCurvedX,pathverticalfigure8:r.KS.fxidPathVerticalFigure8,pathcurvystar:r.KS.fxidPathCurvyStar,pathloopdeloop:r.KS.fxidPathLoopdeLoop,pathbuzzsaw:r.KS.fxidPathBuzzsaw,pathhorizontalfigure8:r.KS.fxidPathHorizontalFigure8,pathpeanut:r.KS.fxidPathPeanut,pathfigure8four:r.KS.fxidPathFigure8Four,pathneutron:r.KS.fxidPathNeutron,pathswoosh:r.KS.fxidPathSwoosh,pathbean:r.KS.fxidPathBean,pathplus:r.KS.fxidPathPlus,pathinvertedtriangle:r.KS.fxidPathInvertedTriangle,pathinvertedsquare:r.KS.fxidPathInvertedSquare,pathleft:r.KS.fxidPathLeft,pathturnright:r.KS.fxidPathTurnRight,patharcdown:r.KS.fxidPathArcDown,pathzigzag:r.KS.fxidPathZigzag,pathscurve2:r.KS.fxidPathSCurve2,pathsinewave:r.KS.fxidPathSineWave,pathbounceleft:r.KS.fxidPathBounceLeft,pathdown:r.KS.fxidPathDown,pathturnup:r.KS.fxidPathTurnUp,patharcup:r.KS.fxidPathArcUp,pathheartbeat:r.KS.fxidPathHeartbeat,pathspiralright:r.KS.fxidPathSpiralRight,pathwave:r.KS.fxidPathWave,pathcurvyleft:r.KS.fxidPathCurvyLeft,pathdiagonaldownright:r.KS.fxidPathDiagonalDownRight,pathturndown:r.KS.fxidPathTurnDown,patharcleft:r.KS.fxidPathArcLeft,pathfunnel:r.KS.fxidPathFunnel,pathspring:r.KS.fxidPathSpring,pathbounceright:r.KS.fxidPathBounceRight,pathspiralleft:r.KS.fxidPathSpiralLeft,pathdiagonalupright:r.KS.fxidPathDiagonalUpRight,pathturnupright:r.KS.fxidPathTurnUpRight,patharcright:r.KS.fxidPathArcRight,pathscurve1:r.KS.fxidPathSCurve1,pathdecayingwave:r.KS.fxidPathDecayingWave,pathcurvyright:r.KS.fxidPathCurvyRight,pathstairsdown:r.KS.fxidPathStairsDown,pathright:r.KS.fxidPathRight,pathup:r.KS.fxidPathUp,_motionpath_count:r.KS.fxid_MOTIONPATH_COUNT},f={nostrike:r.t2.noStrike,singlestrike:r.t2.singleStrike,doublestike:r.t2.doubleStrike}},1134:(e,t,n)=>{"use strict";n.d(t,{Lp:()=>N,MK:()=>p,Mp:()=>y,NR:()=>E,Oc:()=>m,Rk:()=>x,Tq:()=>k,Z$:()=>I,a8:()=>C,gR:()=>A,hI:()=>h,hX:()=>u,j5:()=>_,mk:()=>w,o2:()=>f,pR:()=>v,q0:()=>g});var r=n(43032),o=n(79490),i=n(18758),a=n(34045),s=n(55564),l=n(44121),c=n(98483);function u(e){return null==e}var d,p=(d=(0,r._)((function(e,t){var n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return n="",t.length>0?(t[0].load("id"),[4,e.sync()]):[3,2];case 1:r.sent(),n=t[0].id,r.label=2;case 2:return[2,n]}}))})),function(e,t){return d.apply(this,arguments)}),f=function(){var e=(0,r._)((function(e,t){var n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return n="",t.length>0?(t[t.length-1].load("id"),[4,e.sync()]):[3,2];case 1:r.sent(),n=t[t.length-1].id,r.label=2;case 2:return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=(0,r._)((function(e,t){var n,r,i,a,s,l,c,u;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:n=[],r=!0,i=!1,a=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),s=t[Symbol.iterator](),o.label=2;case 2:return(r=(l=s.next()).done)?[3,5]:((c=l.value).load("id"),[4,e.sync()]);case 3:o.sent(),n.push(c.id),o.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return u=o.sent(),i=!0,a=u,[3,8];case 7:try{r||null==s.return||s.return()}finally{if(i)throw a}return[7];case 8:return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=(0,r._)((function(e){var t;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.presentation.getSelectedSlides()).load({select:"id,items"}),[4,e.sync()];case 1:return n.sent(),[2,t.items]}}))}));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=(0,r._)((function(e){var t,n,r,i,a,s=arguments;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return u(t=s.length>1&&void 0!==s[1]?s[1]:[])||0===t.length?[3,1]:(r=t,[3,3]);case 1:return[4,g(e)];case 2:r=o.sent(),o.label=3;case 3:return 0!==(n=r).length&&(i=n[0])&&(a=i.id?i.id.split("#"):void 0)?[2,{type:l.kk.Slide,id:Number(a[0]),cId:2===a.length?Number(a[1]):void 0}]:[2,void 0]}}))}));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,r._)((function(e){var t,n,r,i,a,s,l,c,u,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return(t=e.presentation).load("slides,id,slides/items"),[4,e.sync()];case 1:return o.sent(),n=t.slides.items,[4,g(e)];case 2:r=o.sent(),i=[],a=!0,s=!1,l=void 0;try{for(c=function(){var e=d.value,t=n.findIndex((function(t){return t.id===e.id}));i.push(t)},u=r[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)c()}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}return[2,i]}}))}));return function(t){return e.apply(this,arguments)}}();function v(e,t){return S.apply(this,arguments)}function S(){return(S=(0,r._)((function(e,t){var n,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),(n=t.getParentSlide()).load("id"),[4,e.sync()];case 1:return o.sent(),r=n.id.split("#"),[2,{id:+r[0],cId:+r[1]}];case 2:throw a=o.sent(),(0,i.cY)("Error in getSlideIdObjectFromShape",a),new Error("".concat(a.message));case 3:return[2]}}))}))).apply(this,arguments)}function C(e,t){return b.apply(this,arguments)}function b(){return(b=(0,r._)((function(e,t){var n,r,i,a,s,l,c,u,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:n=[],r=!0,i=!1,a=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),s=t[Symbol.iterator](),o.label=2;case 2:return(r=(l=s.next()).done)?[3,5]:((c=l.value).load("id"),[4,e.sync()]);case 3:o.sent(),u={id:+c.id},n.push(u),o.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return d=o.sent(),i=!0,a=d,[3,8];case 7:try{r||null==s.return||s.return()}finally{if(i)throw a}return[7];case 8:return[2,n]}}))}))).apply(this,arguments)}function E(e,t){return T.apply(this,arguments)}function T(){return(T=(0,r._)((function(e,t){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return t.load("id"),[4,e.sync()];case 1:return n.sent(),[2,{id:+t.id}]}}))}))).apply(this,arguments)}var w=function(){var e=(0,r._)((function(e,t){var n,r,i,a,l,c,d,p,f,h,g;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return n=[],u(t)?((r=e.presentation.slides).load("items"),[4,e.sync()]):[3,3];case 1:return o.sent(),r.items.forEach((function(e){return e.load("id")})),[4,e.sync()];case 2:return o.sent(),t=r.items,[3,5];case 3:return t.forEach((function(e){return e.load("id")})),[4,e.sync()];case 4:o.sent(),o.label=5;case 5:i=!0,a=!1,l=void 0;try{for(c=t[Symbol.iterator]();!(i=(d=c.next()).done);i=!0)p=d.value,(0,s.PA)(s.IY.EnableCheckBeforeSplit)&&u(p.id)||(f=p.id.split("#"),h=+f[0],g=+f[1],n.push({id:h,cId:g}))}catch(e){a=!0,l=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw l}}return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}();function I(e,t){return P.apply(this,arguments)}function P(){return(P=(0,r._)((function(e,t){var n,r,a,s,l,c,u,d,p,f,h,g,m;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:n=[],r=!0,a=!1,s=void 0,o.label=1;case 1:o.trys.push([1,8,9,10]),l=e[Symbol.iterator](),o.label=2;case 2:if(r=(c=l.next()).done)return[3,7];u=c.value,o.label=3;case 3:return o.trys.push([3,5,,6]),(d=u.getParentTextFrame().getParentShape()).load("id"),(p=d.getParentSlide()).load("id"),[4,t.sync()];case 4:return o.sent(),f=p.id.split("#"),h={shapeId:{id:+d.id},slideId:{id:+f[0],cId:+f[1]}},n.push(h),[3,6];case 5:return g=o.sent(),(0,i.cY)("Error in parseTextRangeAndGetIds",g),[3,6];case 6:return r=!0,[3,2];case 7:return[3,10];case 8:return m=o.sent(),a=!0,s=m,[3,10];case 9:try{r||null==l.return||l.return()}finally{if(a)throw s}return[7];case 10:return[2,n]}}))}))).apply(this,arguments)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e))return(0,i.cY)("Invalid hex color format for formatText"),null;e=e.replace(/^#/,"");var n=parseInt(e,16);return{r:n>>16&255,g:n>>8&255,b:255&n,a:t=Math.min(1,Math.max(0,t))}}function A(){return(0,c.A)()}function k(e){return(0,s.PA)(s.IY.ShouldCheckJOFCCommandAPIVersion),function(e,t){if((0,s.PA)(s.IY.EnableCheckBeforeSplit)&&(u(e)||u(t)||0===e.length||0===t.length))return(0,i.cY)("Error in JSON version check"),!1;for(var n=e.split(".").map((function(e){return parseInt(e)})),r=t.split(".").map((function(e){return parseInt(e)})),o=0;o<n.length;o++){if(n[o]>r[o])return!0;if(n[o]<r[o])return!1}return!0}(a.Vv.getSettingAsString(a.zj.PPTJsonCmdAPIVersion),e)}function x(e,t){return(0,s.PA)(s.IY.ShouldUseCreationIdsForShapeCommands)?{shapes:e,shapeIds:t}:e}function N(e){var t={},n=e.split(","),r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.split(":");if(2===l.length){var c=l[0],u=l[1],d=c.split("#"),p=u.split("#");if(!(d.length<1)){var f=+d[0],h=+p[0];if(2===p.length){var g=p[1].replace("{","").replace("}","");f in t||(t[f]={}),t[f][h]=g}}}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return t}},23343:(e,t,n)=>{"use strict";n.d(t,{G:()=>S,k:()=>y});var r=n(43032),o=n(90813),i=n(79490),a=n(55564),s=n(18384),l=n(72218),c=n(34045),u=n(43277),d=n(44121),p=n(14213),f=n(44632),h=n(69038),g=n(12542),m=n(18758);function y(e,t,n,r){return v.apply(this,arguments)}function v(){return v=(0,r._)((function(e,t,n,d){var y,v,S,C,b,E,T,w,I,P,_;return(0,i.__generator)(this,(function(A){switch(A.label){case 0:if(!c.Vv.IsSettingTrue(c.zj.PPTCopilotUseScenarioOptionsTelemetry))return[2];y=p.K.getInstance(),v=void 0,(S=(0,a.PA)(a.IY.IsScenarioErrorTelemetryEnabled))&&(t&&y.addScenarioError(t),(C=y.getScenarioErrors())&&(v=C.join(","))),n&&n!==y.getScenarioName()&&y.setScenarioName(n),b=y.getUserQueryGuid().length>0?y.getUserQueryGuid():f.B.getInstance().getQueryGuid(),E={scenarioName:y.getScenarioName(),startTime:y.getStartTime(),entryPoint:l.$kB.Chat,correlationId:b,timeToODSLMS:1e3*y.getResponseTime(),timeODSLToJOfcMS:-1,copilotScenarioResult:{Success:e,ErrorReason:S?v:t},capability:y.getCapability(),featureName:y.getFeatureName(),subFeatureName:y.getSubFeatureName(),querySubmitTime:h.qD,additionalSystemMetadataInfo:d},(0,m.cY)("reportCopilotResultToHostApp with scenarioOption: ".concat(JSON.stringify(E))),(T={}).scenarioOptions=JSON.stringify(E),A.label=1;case 1:return A.trys.push([1,3,,4]),[4,PowerPoint.run((k=(0,r._)((function(e){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return u.i.GetHostAppPlatform()!==l.xb6&&u.i.GetHostAppPlatform()!==l.nAd?[3,2]:(Office.context.requirements.isSetSupported(l.Ujq,l.b0_)?((0,m.cY)("CopilotAction API supported and using : "+Office.context.requirements.isSetSupported(l.Ujq,l.b0_)),t={scenarioOptions:T.scenarioOptions?JSON.parse(T.scenarioOptions):void 0,designerOptions:T.designerOptions?JSON.parse(T.designerOptions):void 0,selectionOptions:T.selectionOptions?JSON.parse(T.selectionOptions):void 0},e.presentation.copilotActionAsync(l.Gyr,JSON.stringify(t))):e.presentation.applyJOfcCommandsAsync("",T),[4,e.sync()]);case 1:return r.sent(),[3,4];case 2:return(0,m.cY)("CopilotAction API supported and using : true"),n={scenarioOptions:T.scenarioOptions?JSON.parse(T.scenarioOptions):void 0,designerOptions:T.designerOptions?JSON.parse(T.designerOptions):void 0,selectionOptions:T.selectionOptions?JSON.parse(T.selectionOptions):void 0},e.presentation.copilotAction(l.Gyr,JSON.stringify(n)),[4,e.sync()];case 3:r.sent(),r.label=4;case 4:return[2]}}))})),function(e){return k.apply(this,arguments)}))];case 2:return A.sent(),(0,a.PA)(a.IY.SetScenarioNameEnabled)?(0,a.PA)(a.IY.LogChatEventWhenMakingAJOFCCall)&&f.B.getInstance().sendChatEventTelemetry((0,s.pN)((w={},(0,o._)(w,g.h3.ChatEventType,g.a5.JOFCCommandExecuted),(0,o._)(w,g.h3.ChatEventParameters,"reportCopilotResultToHostApp"),(0,o._)(w,g.h3.UserQueryGuid,b),w))):(0,a.PA)(a.IY.LogChatEventWhenMakingAJOFCCall)&&f.B.getInstance().sendChatEventTelemetry((0,s.pN)((I={},(0,o._)(I,g.h3.ChatEventType,g.a5.JOFCCommandExecuted),(0,o._)(I,g.h3.ChatEventParameters,"reportCopilotResultToHostApp"),I))),[3,4];case 3:return P=A.sent(),_="reportCopilotResultToHostApp applyJOfcCommandsAsync Execution failed: ".concat(null==P?void 0:P.message),(0,m.cY)(_),g.MP.getInstance().logError({eventType:g.S2.ChatEvents,errorMessage:_}),[3,4];case 4:return y.resetData(),[2]}var k}))})),v.apply(this,arguments)}function S(e){return C.apply(this,arguments)}function C(){return(C=(0,r._)((function(e){var t;return(0,i.__generator)(this,(function(n){return(t=p.K.getInstance().getScenarioName())!==d.Cu.CreatePresentation&&t!==d.Cu.CreatePresentationFromDoc&&t!==d.Cu.AddSlide&&t!==d.Cu.InsertImage&&t!==d.Cu.Beautify&&t!==d.Cu.Animate||y(!1,e),[2]}))}))).apply(this,arguments)}},84505:(e,t,n)=>{"use strict";n.d(t,{J:()=>l});var r=n(43032),o=n(79490),i=n(72218),a=n(43277),s=n(18758);function l(e){return c.apply(this,arguments)}function c(){return(c=(0,r._)((function(e){var t;return(0,o.__generator)(this,(function(n){switch(t=e.context,a.i.GetHostAppPlatform()){case i.q93:Office.context.ui.executeFeature(i.na4),(0,s.cY)("UndoApplication: Executed CMD_UNDO_WEB with Id: "+i.na4);break;case i.xb6:case i.TTX:case i.nAd:Office.context.ui.executeFeature(i.VGH),(0,s.cY)("UndoApplication: Executed CMD_UNDO_DESKTOP with Id: "+i.VGH)}return[2]}))}))).apply(this,arguments)}},31510:(e,t,n)=>{"use strict";n.d(t,{$g:()=>g,Go:()=>f,KK:()=>y,eZ:()=>d});var r=n(43032),o=n(79490),i=n(18758),a=n(12063),s=n(55564),l=n(99374);function c(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)((function(e){var t,n,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,(0,i.vX)(e)];case 1:return t=o.sent(),n=t.height,r=t.width,a=(0,i.nM)(e),[2,new OfficeExtension.Promise((function(e,t){Office.context.document.setSelectedDataAsync(a,{coercionType:Office.CoercionType.Image,imageLeft:530,imageTop:70,imageWidth:r/5,imageHeight:n/5},(function(n){(0,i.cY)("Office.context.document.setSelectedDataAsync callback result: "+JSON.stringify(n)),n.status===Office.AsyncResultStatus.Failed?t((0,i.cY)(n.error.message)):e(n)}))}))]}}))}))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(e){var t,n,r,i,s,l,u,d,p,f,h,g,m,y,v,S;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=function(e){i[e].shapes.items.forEach((function(t){u[e].includes(t.id)||s.push(t)}))},n=e.context,r=e.description,i=e.slides,s=[],[4,a.U.insertImage(r)];case 1:if(!(l=o.sent()))throw new Error("Could not find image matching description");return u=[],i.forEach((function(e){return e.load("id, shapes ,shapes/id, shapes/items")})),[4,n.sync()];case 2:o.sent(),d=!0,p=!1,f=void 0,o.label=3;case 3:o.trys.push([3,9,10,11]),h=i[Symbol.iterator](),o.label=4;case 4:return(d=(g=h.next()).done)?[3,8]:(m=g.value,[],y=m.shapes.items.map((function(e){return e.id})),u.push(y),n.presentation.setSelectedSlides([m.id]),[4,n.sync()]);case 5:return o.sent(),[4,c(l)];case 6:o.sent(),m.load("shapes ,shapes/id, shapes/items"),o.label=7;case 7:return d=!0,[3,4];case 8:return[3,11];case 9:return v=o.sent(),p=!0,f=v,[3,11];case 10:try{d||null==h.return||h.return()}finally{if(p)throw f}return[7];case 11:return n.presentation.getSelectedTextRangeOrNullObject(),[4,n.sync()];case 12:for(o.sent(),S=0;S<i.length;S++)t(S);return n.presentation.setSelectedSlides(i.map((function(e){return e.id}))),[4,n.sync()];case 13:return o.sent(),[2,s]}}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){var t,n,r,i,a,s,l,c;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=e.context,n=e.images,r=e.height,i=e.width,a=e.top,s=e.left,l=e.borderColor,c=e.borderWeight,n.forEach((function(e){null!=s&&(e.left=s),null!=a&&(e.top=a),null!=r&&(e.height=r),null!=i&&(e.width=i),null!=l&&(e.lineFormat.visible=!0,e.lineFormat.color=l),null!=c&&(e.lineFormat.visible=!0,e.lineFormat.weight=c)})),[4,t.sync()];case 1:return o.sent(),[2]}}))}))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=(0,r._)((function(e){var t,n,r,i,a,c,u,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,i=e.index,a=void 0===i?-1:i,[4,(0,l.ZJ)({context:t,scope:r,index:a})];case 1:return c=o.sent(),u=[],u=(0,s.PA)(s.IY.ShouldUseCreationIdsForShapeCommands)?c.shapes:c,d=[],u.forEach((function(e){return e.load("type")})),[4,t.sync()];case 2:return o.sent(),u.forEach((function(e){"Image"==e.type&&d.push(e)})),[2,d]}}))}))).apply(this,arguments)}function y(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)((function(e){var t;return(0,o.__generator)(this,(function(n){return t=e.context,e.images.forEach((function(e){e.delete()})),t.sync(),[2]}))}))).apply(this,arguments)}},99374:(e,t,n)=>{"use strict";n.d(t,{AU:()=>v,ZB:()=>m,ZJ:()=>h,qQ:()=>C,wv:()=>E});var r=n(43032),o=n(74292),i=n(81092),a=n(79490),s=n(18758),l=n(2242),c=n(39041),u=n(55564),d=n(1134);function p(e,t,n){return f.apply(this,arguments)}function f(){return(f=(0,r._)((function(e,t,n){var r,l,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),(0,o._)(t,PowerPoint.SlideCollection)||(0,o._)(t,PowerPoint.SlideScopedCollection)?(t=t.items,[3,3]):[3,1];case 1:return t.forEach((function(e){return e.load({expand:"shapes"})})),[4,e.sync()];case 2:a.sent(),a.label=3;case 3:for(r=0;r<t.length;r++)(l=n).push.apply(l,(0,i._)(t[r].shapes.items));return[3,5];case 4:return c=a.sent(),(0,s.cY)("Exception in _selectShapesFromSlides:"+c.message),[3,5];case 5:return[2]}}))}))).apply(this,arguments)}function h(e){return g.apply(this,arguments)}function g(){return(g=(0,r._)((function(e){var t,n,r,u,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,u=e.slides,f=e.index,h=void 0===f?-1:f,g=e.shapeType,m=void 0===g?null:g,y=e.name,v=void 0===y?null:y,S=e.shapeIds,C=void 0===S?null:S,b=[],null==(E=r)&&(E="Selection"),"Selection"!=E?[3,5]:((T=t.presentation.getSelectedShapes()).load("items"),(w=t.presentation.getSelectedSlides()).load({select:"items",expand:"shapes"}),[4,t.sync()]);case 1:return a.sent(),0!=T.items.length?[3,3]:[4,p(t,w,b)];case 2:return a.sent(),[3,4];case 3:(I=b).push.apply(I,(0,i._)(T.items)),a.label=4;case 4:0==b.length&&null==r&&(E="Presentation"),a.label=5;case 5:return"Presentation"!=E?[3,8]:((P=t.presentation).load({expand:"slides, slides/shapes"}),[4,t.sync()]);case 6:return a.sent(),[4,p(t,P.slides.items,b)];case 7:return a.sent(),[3,14];case 8:return Array.isArray(E)&&E.length>0&&(0,o._)(E[0],PowerPoint.Slide)?[4,p(t,E,b)]:[3,10];case 9:return a.sent(),[3,14];case 10:return"slides"!==E?[3,14]:(0,c.hX)(u)?(_=t.presentation,(A=_.getSelectedSlides()).load("id,items"),[4,t.sync()]):[3,12];case 11:a.sent(),u=A.items,a.label=12;case 12:return[4,p(t,u,b)];case 13:a.sent(),a.label=14;case 14:if(null==m&&null==v||(null!=m&&(m=(0,l.camelFromPascal)(m)),k=m?m.toLowerCase():"",x=v?v.toLowerCase():"",b=b.filter((function(e){return m&&(e.type.toLowerCase()===k||e.name.toLowerCase().includes(k)||e.name.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join(" ").includes(k))||v&&e.name.toLowerCase().startsWith(x)}))),-1===h)return[2,(0,d.Rk)(b,C)];try{if(b.length>h)return[2,(0,d.Rk)([b[h]],C)];throw Error("Index value:"+h+" Out of bounds for Occurences length:"+b.length)}catch(e){return(0,s.cY)("Exception in selectShapes:"+e.message),N=new Array,[2,(0,d.Rk)(N,C)]}return[2]}}))}))).apply(this,arguments)}function m(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)((function(e){var t,n,r,o,s,l,c,u,d,f,h,g;return(0,a.__generator)(this,(function(m){switch(m.label){case 0:return t=e.context,n=e.indices,(r=t.presentation).load({expand:"slides, slides/shapes"}),[4,t.sync()];case 1:m.sent(),o=n.split(","),s=[],l=!0,c=!1,u=void 0,m.label=2;case 2:m.trys.push([2,7,8,9]),d=function(){var e,n,o,l,c,u;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return e=h.value,(n=e.match(/(\d+#\d+):(\d+)/))?(o=r.slides.items.find((function(e){return e.id===n[1]})))?[4,p(t,[o],l=[])]:[3,2]:[3,2];case 1:a.sent(),(c=l.filter((function(e){return e.id===n[2]}))).length>0&&(u=s).push.apply(u,(0,i._)(c)),a.label=2;case 2:return[2]}}))},f=o[Symbol.iterator](),m.label=3;case 3:return(l=(h=f.next()).done)?[3,6]:[5,(0,a.__values)(d())];case 4:m.sent(),m.label=5;case 5:return l=!0,[3,3];case 6:return[3,9];case 7:return g=m.sent(),c=!0,u=g,[3,9];case 8:try{l||null==f.return||f.return()}finally{if(c)throw u}return[7];case 9:return[2,s]}}))}))).apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return(S=(0,r._)((function(e){var t,n,r,o,i,s,c,d,p,f,h,g,m,y,v;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.shapeType,r=e.slides,n=(0,l.camelFromPascal)(n),o="",i=[],"textbox"==n?o="TextBox":Object.values(PowerPoint.GeometricShapeType).some((function(e){return(0,l.camelFromPascal)(e)===n}))?o="Geometric":Object.values(PowerPoint.ConnectorType).some((function(e){return(0,l.camelFromPascal)(e)===n}))&&(o="Connector"),r.forEach((function(e){return e.load("shapes")})),[4,t.sync()];case 1:a.sent(),s=!0,c=!1,d=void 0;try{for(p=r[Symbol.iterator]();!(s=(f=p.next()).done);s=!0)h=f.value,"Geometric"===o?((g=h.shapes.addGeometricShape(n)).name=n,g.load("textFrame"),(m=g.textFrame).autoSizeSetting=PowerPoint.ShapeAutoSize.autoSizeNone,(0,u.PA)(u.IY.ShouldInsertedShapeAutoFitToText)||(m.autoSizeSetting=PowerPoint.ShapeAutoSize.autoSizeShapeToFitText),i.push(g)):"Connector"===o?((y=h.shapes.addLine(n)).name=n,i.push(y)):"TextBox"===o&&((v=h.shapes.addTextBox("")).name=n,i.push(v))}catch(e){c=!0,d=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw d}}return[4,t.sync()];case 2:return a.sent(),[2,i]}}))}))).apply(this,arguments)}function C(e){return b.apply(this,arguments)}function b(){return(b=(0,r._)((function(e){var t,n,r,o,i,s,l,c,u,d,p,f;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(t=e.context,n=e.shapes,r=e.left,o=e.top,i=e.height,s=e.width,l=e.lineColor,c=e.lineDashStyle,u=e.lineWeight,d=e.lineTransparency,p=e.fillColor,f=e.fillTransparency,0==n.length)throw Error("formatShapes: shapes array is empty");return n.forEach((function(e){return function(e){e.load("type,\n    lineFormat/color,\n    lineFormat/visible,\n    lineFormat/dashStyle,\n    lineFormat/weight,\n    lineFormat/transparency,\n    fill/foregroundColor,\n    fill/transparency")}(e)})),[4,t.sync()];case 1:return a.sent(),n.forEach((function(e){null!=r&&(e.left=r),null!=o&&(e.top=o),null!=i&&(e.height=i),null!=s&&(e.width=s),null!=l&&(e.lineFormat.color=l,"Image"==e.type&&(e.lineFormat.visible=!0)),null!=c&&(e.lineFormat.dashStyle=c),null!=u&&null!=e.lineFormat.weight&&("Image"==e.type&&(e.lineFormat.visible=!0),e.lineFormat.weight=u),null!=d&&(e.lineFormat.transparency=d),null!=p&&(e.fill.foregroundColor=p),null!=f&&(e.fill.transparency=f)})),[4,t.sync()];case 2:return a.sent(),[2]}}))}))).apply(this,arguments)}function E(e){return T.apply(this,arguments)}function T(){return(T=(0,r._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t=e.context,e.shapes.forEach((function(e){e.delete()})),[4,t.sync()];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}},72230:(e,t,n)=>{"use strict";n.d(t,{Jh:()=>f,Ob:()=>g,Ub:()=>y,WN:()=>S,hb:()=>b,vy:()=>d,yU:()=>T});var r=n(43032),o=n(81092),i=n(79490),a=n(15499),s=n(18758),l=n(1134),c=n(55564);function u(e,t){var n;!(0,l.hX)(e)&&e.length>0&&((n=e).push.apply(n,(0,o._)(t)),t=e);return t}function d(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(e){var t,n,r,o,a,s,d,p,f,h,g,m,y,v,S,C;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,o=e.index,a=void 0===o?(0,c.PA)(c.IY.ShouldSupportLastSlideSelection)?void 0:-1:o,s=e.id,d=void 0===s?void 0:s,p=e.slides,f=void 0===p?void 0:p,h=t.presentation,g=[],null==(m=r)&&(m="Selection"),"Selection"!=m?[3,2]:(y=h.getSelectedSlides(),(0,l.hX)(a)||-1===a||(y=h.slides),y.load("id,items"),[4,t.sync()]);case 1:i.sent(),0==(g=y.items).length&&null==r&&(m="Presentation"),i.label=2;case 2:return"Presentation"!=m?[3,4]:(h.load("slides, id,slides/items"),[4,t.sync()]);case 3:i.sent(),g=h.slides.items,i.label=4;case 4:if(v=(0,c.PA)(c.IY.ShouldSupportLastSlideSelection),S=-1===a,v&&(S=(0,l.hX)(a)),S&&!d)return[2,u(f,g)];try{return d&&(C=g.find((function(e){return e.id===d})))?[2,u(f,[C])]:-1===a&&(0,c.PA)(c.IY.ShouldSupportLastSlideSelection)?[2,u(f,[g[g.length-1]])]:[2,u(f,[g[a]])]}catch(e){return[2,new Array]}return[2]}}))}))).apply(this,arguments)}function f(e){return h.apply(this,arguments)}function h(){return(h=(0,r._)((function(e){var t,n,r,o,a,s,l,c,u,p,f,h;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.indices,r=n.split(","),o=[],a=!0,s=!1,l=void 0,i.label=1;case 1:i.trys.push([1,6,7,8]),c=r[Symbol.iterator](),i.label=2;case 2:return(a=(u=c.next()).done)?[3,5]:(p=u.value,[4,d({context:t,scope:"Presentation",id:p})]);case 3:(f=i.sent()).length>0&&f[0]&&o.push(f[0]),i.label=4;case 4:return a=!0,[3,2];case 5:return[3,8];case 6:return h=i.sent(),s=!0,l=h,[3,8];case 7:try{a||null==c.return||c.return()}finally{if(s)throw l}return[7];case 8:return[2,o]}}))}))).apply(this,arguments)}function g(e){return m.apply(this,arguments)}function m(){return(m=(0,r._)((function(e){var t,n,r,o,s,l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O,D,L,R;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return t=e.context,n=e.precededBy,r=void 0===n?[]:n,o=e.layout,s=void 0===o?"Title and Content":o,l=[],0!=r.length?[3,3]:(t.presentation.getSelectedTextRangeOrNullObject(),t.presentation.slides.add(),[4,t.sync()]);case 1:return i.sent(),t.presentation.load("slides, slides/items,slides/id"),c=t.presentation.slides.getCount(),[4,t.sync()];case 2:return i.sent(),u=t.presentation.slides.items[c.value-1],l.push(u),[2,l];case 3:return(d=t.presentation).load({select:"slides/id,slides/slideMaster/id",expand:"slides,slides/slideMaster/layouts/items"}),r.forEach((function(e){return e.load("id")})),p=t.presentation.slides.getCount(),[4,t.sync()];case 4:for(i.sent(),f=d.slides.items[0],h=f.slideMaster.layouts.items,g=[],r.forEach((function(e){return g.push(e.id)})),m="",y="",v=!1,S=0;S<h.length;S++)if((C=h[S]).name.toLowerCase()==s.toLowerCase()){m=C.id,y=f.slideMaster.id,v=!0;break}if(!v&&s.toLowerCase().includes("content"))for(b=0;b<h.length;b++)if((E=h[b]).name.toLowerCase().includes("introduction")){m=E.id,y=f.slideMaster.id,v=!0;break}if(!v&&s.toLowerCase().includes("content"))for(T=0;T<h.length;T++)if((w=h[T]).name.toLowerCase().includes("content")){m=w.id,y=f.slideMaster.id,v=!0;break}if(!v&&!s.toLowerCase().includes("content"))for(I=0;I<h.length;I++)if((P=h[I]).name.toLowerCase().startsWith("title")){m=P.id,y=f.slideMaster.id,v=!0;break}return v||(s.toLowerCase().includes("content")?(m=f.slideMaster.layouts.items[1].id,y=f.slideMaster.id):(m=f.slideMaster.layouts.items[0].id,y=f.slideMaster.id)),t.presentation.slides.add({slideMasterId:y,layoutId:m}),[4,t.sync()];case 5:return i.sent(),[4,a.helper.getDocumentAsCompressed()];case 6:return _=i.sent(),t.presentation.load("slides"),A=t.presentation.slides.getItemAt(p.value).load("id"),[4,t.sync()];case 7:for(i.sent(),k=p.value+1,x=0;x<r.length;x++)t.presentation.insertSlidesFromBase64(_,{formatting:PowerPoint.InsertSlideFormatting.keepSourceFormatting,targetSlideId:g[x],sourceSlideIds:[A.id]}),k++;return t.presentation.slides.getItemAt(k-1).delete(),N=[],t.presentation.load("slides, slides/items,slides/id"),[4,t.sync()];case 8:for(i.sent(),O=!1,D=0,L=t.presentation.slides.items,R=0;R<t.presentation.slides.items.length&&(!O||(l.push(L[R]),N.push(L[R].id),O=!1,l.length!=r.length));R++)L[R].id==g[D]&&(D++,O=!0);return t.presentation.setSelectedSlides(N),[4,t.sync()];case 9:return i.sent(),[2,l]}}))}))).apply(this,arguments)}function y(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)((function(e){var t,n;return(0,i.__generator)(this,(function(r){return e.context,e.slides,t=e.strategy,n=e.animation,[2,[]]}))}))).apply(this,arguments)}function S(e){return C.apply(this,arguments)}function C(){return(C=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){return e.context,e.slides,e.slideIds,e.precededBy,e.precededById,[2]}))}))).apply(this,arguments)}function b(e){return E.apply(this,arguments)}function E(){return(E=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){return e.context,e.slides,e.slideIds,e.name,e.id,[2]}))}))).apply(this,arguments)}function T(e){return w.apply(this,arguments)}function w(){return(w=(0,r._)((function(e){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return t=e.context,0===(n=e.slides).length&&(0,s.cY)("Deleting "+n.length+" slides"),n.forEach((function(e){e.delete()})),[4,t.sync()];case 1:return r.sent(),[2]}}))}))).apply(this,arguments)}},59e3:(e,t,n)=>{"use strict";n.d(t,{A0:()=>v,JG:()=>P,W1:()=>I,bc:()=>x,ty:()=>b,vX:()=>A,xk:()=>T});var r,o=n(43032),i=n(74292),a=n(60697),s=n(81092),l=n(79490),c=n(2242),u=n(39041),d=n(18758);function p(e,t){return f.apply(this,arguments)}function f(){return(f=(0,o._)((function(e,t){var n;return(0,l.__generator)(this,(function(r){for(n=0;n<e.length;n++)e[n].type==PowerPoint.ShapeType.geometricShape&&t.push(e[n].textFrame.textRange);return[2]}))}))).apply(this,arguments)}function h(e,t,n){return g.apply(this,arguments)}function g(){return(g=(0,o._)((function(e,t,n){var r,o;return(0,l.__generator)(this,(function(a){switch(a.label){case 0:return(0,i._)(t,PowerPoint.SlideCollection)||(0,i._)(t,PowerPoint.SlideScopedCollection)?(t=t.items,[3,3]):[3,1];case 1:return t.forEach((function(e){return e.load({expand:"shapes"})})),[4,e.sync()];case 2:a.sent(),a.label=3;case 3:return o=[],t.forEach((function(e){return(r=o).push.apply(r,(0,s._)(e.shapes.items))})),[4,p(o,n)];case 4:return a.sent(),[2]}}))}))).apply(this,arguments)}function m(e,t){return y.apply(this,arguments)}function y(){return(y=(0,o._)((function(e,t){var n,r,o,i,a;return(0,l.__generator)(this,(function(s){switch(s.label){case 0:for(n=[],r=[],o=0;o<t.length;o++)(i=t[o].getParentTextFrame().getParentShape()).load("name"),r.push(i);return[4,e.sync()];case 1:for(s.sent(),a=0;a<t.length;a++)n.push(r[a].name.toLowerCase());return[2,n]}}))}))).apply(this,arguments)}function v(e){return S.apply(this,arguments)}function S(){return(S=(0,o._)((function(e){var t,n,o,a,s,u,f,g,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O,D,L,R,F,M,B;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:return t=e.context,n=void 0===t?null:t,o=e.scope,a=void 0===o?null:o,s=e.text,u=void 0===s?null:s,f=e.index,g=void 0===f?-1:f,y=e.name,S=[],C=[],r=v=void 0===y?null:y,null==(b=a)&&(b="Selection"),"Selection"!==b?[3,8]:((E=n.presentation.getSelectedTextRangeOrNullObject()).load("isNullObject,text"),(T=n.presentation.getSelectedShapes()).load({select:"items,type"}),(w=n.presentation.getSelectedSlides()).load({select:"items",expand:"shapes"}),[4,n.sync()]);case 1:for(l.sent(),I=0;I<T.items.length;I++)T.items[I].type==PowerPoint.ShapeType.geometricShape&&T.items[I].load("textFrame");return[4,n.sync()];case 2:return l.sent(),0!=E.isNullObject||""==E.text?[3,3]:(S.push(E),[3,7]);case 3:return T.items.length>0&&null==v?[4,p(T.items,S)]:[3,5];case 4:return l.sent(),[3,7];case 5:return[4,h(n,w,S)];case 6:l.sent(),l.label=7;case 7:0==S.length&&null==a&&(b="Presentation"),l.label=8;case 8:return Array.isArray(b)&&b.length>0&&(0,i._)(b[0],PowerPoint.Slide)?[4,h(n,b,S)]:[3,10];case 9:return l.sent(),[3,17];case 10:return Array.isArray(b)&&b.length>0&&(0,i._)(b[0],PowerPoint.Shape)?((P=b).forEach((function(e){return e.load({select:"type"})})),[4,n.sync()]):[3,14];case 11:for(l.sent(),_=0;_<P.length;_++)P[_].type==PowerPoint.ShapeType.geometricShape&&P[_].load("textFrame");return[4,n.sync()];case 12:return l.sent(),[4,p(b,S)];case 13:return l.sent(),[3,17];case 14:return"Presentation"!==b?[3,17]:((A=n.presentation).load({expand:"slides,slides/shapes"}),[4,n.sync()]);case 15:return l.sent(),[4,h(n,A.slides,S)];case 16:l.sent(),l.label=17;case 17:return null!=u?[3,18]:(C=S,[3,20]);case 18:for(k=[],x=0;x<S.length;x++)(N=S[x]).load("text"),k.push(N);return[4,n.sync()];case 19:for(l.sent(),O=0;O<S.length;O++)for(D=k[O].text,L=c.matchAll(D,u,!1),R=0;R<L.length;R++)F=L[R],C.push(k[O].getSubstring(F.index,null!=F[0]?F[0].length:0));l.label=20;case 20:return null==v?[3,22]:(M=[],[4,m(n,C)]);case 21:B=l.sent(),M=C.filter((function(e,t){var n;return null===(n=B[t])||void 0===n?void 0:n.toLowerCase().startsWith(v.toLowerCase())})),0==M.length&&(M=C.filter((function(e,t){return"content"===v.toLowerCase()&&(B[t].includes("text")||B[t].includes("subtitle")||B[t].includes("body")||B[t].includes("placeholder"))}))),0==M.length&&(M=C.filter((function(e,t){return v.toLowerCase().startsWith("title")&&B[t].startsWith("title")}))),0==M.length&&(M=C.filter((function(e,t){return B[t].includes(v.toLowerCase())}))),C=M,l.label=22;case 22:if(-1===g)return[2,C];try{if(C.length>g)return[2,[C[g]]];throw Error("Index value:"+g+" Out of bounds for Occurences length:"+C.length)}catch(e){throw(0,d.cY)("Exception in selectText:"+e.message),Error("Exception in selectText:"+e.message)}return[2]}}))}))).apply(this,arguments)}var C,b=function(e){var t=[],n=[];return e.split(",").map((function(e,r,o){e.match(/^\d+#\d+:\d+:/)?(n.length>0&&t.push(n.join(",")),n=[e]):n.push(e),r===o.length-1&&t.push(n.join(","))})),t},E=(C=(0,o._)((function(e,t,n){var r,o,i,s,c,u,p,f,h,g,m,y,v;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:r=(0,a._)(t.split(":")),o=r[0],i=r[1],s=r.slice(2),c=[],l.label=1;case 1:return l.trys.push([1,4,,5]),(u=n.slides.items.find((function(e){return e.id===o})))?(u.load({select:"shapes, id, shapes/items",expand:"textFrame"}),[4,e.sync()]):[2,[]];case 2:return l.sent(),(p=u.shapes.items.find((function(e){return e.id===i})))?(p.load("textFrame, textFrame/textRange, textFrame/textRange/text"),[4,e.sync()]):[2,[]];case 3:for(l.sent(),f=p.textFrame.textRange,h=s.join(":"),g=1,m=0;m<f.text.length;m=g)(y=f.text.indexOf(h,m))>=0?(c.push(f.getSubstring(y,h.length)),g=y+h.length):g=f.text.length;return[3,5];case 4:return v=l.sent(),(0,d.cY)("Exception in searchTextRangeWithTextIndex:"+v.message+"with id:"+t),[2,[]];case 5:return[2,c]}}))})),function(e,t,n){return C.apply(this,arguments)});function T(e){return w.apply(this,arguments)}function w(){return(w=(0,o._)((function(e){var t,n,r,o,i,a,c,u,p,f,h,g,m,y,v;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:t=e.context,n=e.indices,l.label=1;case 1:return l.trys.push([1,11,,12]),(r=t.presentation).load({select:"slides, id, slides/items",expand:"shapes"}),[4,t.sync()];case 2:l.sent(),o=b(n),i=[],a=!0,c=!1,u=void 0,l.label=3;case 3:l.trys.push([3,8,9,10]),p=o[Symbol.iterator](),l.label=4;case 4:return(a=(f=p.next()).done)?[3,7]:(h=f.value,[4,E(t,h,r)]);case 5:m=l.sent(),(g=i).push.apply(g,(0,s._)(m)),l.label=6;case 6:return a=!0,[3,4];case 7:return[3,10];case 8:return y=l.sent(),c=!0,u=y,[3,10];case 9:try{a||null==p.return||p.return()}finally{if(c)throw u}return[7];case 10:return[2,i];case 11:throw v=l.sent(),(0,d.cY)("Exception in selectIndicesText:"+v.message),Error("Exception in selectIndicesText:"+v.message);case 12:return[2]}}))}))).apply(this,arguments)}var I=function(){var e=(0,o._)((function(e){var t,n,r,o;return(0,l.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.index,i.label=1;case 1:return i.trys.push([1,4,,5]),(r=t.presentation).load({select:"slides, id, slides/items",expand:"shapes"}),[4,t.sync()];case 2:return i.sent(),[4,E(t,n,r)];case 3:return[2,i.sent()];case 4:throw o=i.sent(),(0,d.cY)("selectTextIndex: Unable to select text range for textIndex: "+n+" due to "+o.message),Error("Unable to select textRange"+o.message);case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();function P(e){return _.apply(this,arguments)}function _(){return(_=(0,o._)((function(e){var t,n;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.context,0===(n=e.textRanges).length)throw(0,d.cY)("No text ranges to delete"),Error("No text ranges to delete");return n.reverse().forEach((function(e){e&&(e.text="")})),[4,t.sync()];case 1:return r.sent(),[2]}}))}))).apply(this,arguments)}function A(e){return k.apply(this,arguments)}function k(){return(k=(0,o._)((function(e){var t,n,r,o,i,a,s,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O,D,L,R,F;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:for(t=e.context,n=e.textRanges,r=e.color,o=void 0===r?null:r,i=e.bold,a=void 0===i?null:i,s=e.italic,c=void 0===s?null:s,u=e.underline,d=void 0===u?null:u,p=e.fontName,f=void 0===p?null:p,h=e.size,g=void 0===h?null:h,m=e.bulleted,y=void 0===m?null:m,v=e.horizontalAlignment,S=void 0===v?null:v,C=e.verticalAlignment,b=void 0===C?null:C,E=[],T=0;T<n.length;T++)w=n[T],(I=w.getParentTextFrame().getParentShape().getParentSlide()).load("id"),E.push(I);return[4,t.sync()];case 1:for(l.sent(),P=new Map,_=0;_<n.length;_++)P.has(E[_].id)?P.get(E[_].id).push(n[_]):P.set(E[_].id,[n[_]]);A=!0,k=!1,x=void 0,l.label=2;case 2:l.trys.push([2,7,8,9]),N=P.entries()[Symbol.iterator](),l.label=3;case 3:if(A=(O=N.next()).done)return[3,6];for(D=O.value,L=0;L<D[1].length;L++)R=D[1][L],null!=o&&(R.font.color=o),null!=a&&(R.font.bold=a),null!=c&&(R.font.italic=c),null!=d&&(R.font.underline=d),null!=f&&(R.font.name=f),null!=g&&(R.font.size=g),null!=y&&(R.paragraphFormat.bulletFormat.visible=y),null!=S&&(R.paragraphFormat.horizontalAlignment=S),null!=b&&(R.getParentTextFrame().verticalAlignment=b);return[4,t.sync()];case 4:l.sent(),l.label=5;case 5:return A=!0,[3,3];case 6:return[3,9];case 7:return F=l.sent(),k=!0,x=F,[3,9];case 8:try{A||null==N.return||N.return()}finally{if(k)throw x}return[7];case 9:return[2]}}))}))).apply(this,arguments)}function x(e){return N.apply(this,arguments)}function N(){return(N=(0,o._)((function(e){var t,n,o,i,a,c,d,p,f,h,g,m,y,S,C,b,E,T,w,I,P,_,A,k,x,N,D,L,R,F;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:t=e.context,n=e.precededBy,o=e.text,i=e.insertBeforeSelection,a=[],o=(0,u.WM)(o),c=/(?:^)\d*\.(?=\s)|^[>\*-](?=\s)/gm,d=[],O(n,p=[],f=[],h=[]),l.label=1;case 1:return l.trys.push([1,3,,6]),[4,t.sync()];case 2:return l.sent(),[3,6];case 3:return l.sent(),[4,v({context:t,name:r})];case 4:return O(n=l.sent(),p=[],f=[],h=[]),[4,t.sync()];case 5:return l.sent(),[3,6];case 6:for(g={},m=0;m<n.length;m++)(y=p[m].id)in g?g[y]+=1:g[y]=0,d.push(p[m].id);for(S=[],C=0;C<f.length;C++)b=(0,s._)(o.matchAll(c)),b.length>=o.split("\n").length&&!f[C].text.trim()&&(o=o.replace(c,""),f[C].paragraphFormat.bulletFormat.visible||(f[C].paragraphFormat.bulletFormat.visible=!0)),E=d[C],T=f[C].start,w=T+g[E]*o.length,(I=h[C].textRange.getSubstring(w,f[C].text.length)).load("text"),S.push(I);return[4,t.sync()];case 7:for(l.sent(),P=[],_=[],A=0;A<f.length;A++)k=S[A].text,P.push(S[A].text),S[A].text=i?o+k:k+o,h[A].load("textRange, textRange/text"),_.push(h[A]);return[4,t.sync()];case 8:for(l.sent(),x=0;x<f.length;x++)N=d[x],D=f[x].start,L=D+g[N]*o.length,R=P[x].length+o.length,F=_[x].textRange.getSubstring(L,R),a.push(F);return[2,a]}}))}))).apply(this,arguments)}function O(e,t,n,r){return D.apply(this,arguments)}function D(){return(D=(0,o._)((function(e,t,n,r){var o,i,a,s;return(0,l.__generator)(this,(function(l){for(o=0;o<e.length;o++)try{(i=e[o].getParentTextFrame().getParentShape()).load("id"),t.push(i),(a=e[o]).load("text, start, paragraphFormat/bulletFormat/visible"),n.push(a),(s=e[o].getParentTextFrame()).load("textRange"),r.push(s)}catch(e){(0,d.cY)("Exception in readPropertiesForInsertText:"+e.message);continue}return[2]}))}))).apply(this,arguments)}},72218:(e,t,n)=>{"use strict";n.d(t,{$kB:()=>nt,AGQ:()=>ee,B9B:()=>Rt,CA1:()=>Ht,Cxb:()=>Pt,DHF:()=>b,DPI:()=>x,DjU:()=>Yt,DwS:()=>I,E61:()=>ln,EKU:()=>T,ELJ:()=>ce,Eip:()=>Rn,F9A:()=>v,FME:()=>R,FUf:()=>_n,FVn:()=>De,Fhl:()=>at,Fw6:()=>Gn,GEA:()=>Vt,GrL:()=>ae,Gyr:()=>Bt,H19:()=>Jt,H47:()=>Q,HJ4:()=>Ae,Hif:()=>En,HoP:()=>P,Hum:()=>Fn,I_0:()=>xt,I_l:()=>vn,IxG:()=>xn,JDs:()=>O,KBj:()=>ye,KUu:()=>kn,KY_:()=>qt,KdH:()=>oe,LMm:()=>Ct,Lm3:()=>Tn,Lvp:()=>ke,Lz_:()=>je,MEV:()=>tn,MYv:()=>h,NPs:()=>Zt,O0f:()=>z,OAU:()=>$,OKS:()=>yt,OpF:()=>on,OsU:()=>g,PGr:()=>Bn,PGy:()=>ge,PR_:()=>bn,Puy:()=>Ve,Qep:()=>Cn,QjY:()=>H,R4r:()=>C,R7i:()=>vt,RC5:()=>rn,RFL:()=>$e,RKj:()=>W,R_I:()=>N,TTX:()=>Te,U1n:()=>_t,UeP:()=>ne,Ujq:()=>Ut,Uk7:()=>G,UlY:()=>w,UzE:()=>Ze,VDh:()=>pt,VGH:()=>Xe,VMi:()=>Ye,VeX:()=>tt,Vgn:()=>ht,Vgs:()=>fe,Vii:()=>we,VwD:()=>sn,W$r:()=>Me,WKk:()=>bt,XEH:()=>Wt,XIj:()=>Nn,Y1T:()=>mt,Yd2:()=>Dn,YgX:()=>se,Yti:()=>Mn,ZAw:()=>gt,ZUM:()=>Lt,ZVq:()=>Ln,Zor:()=>Ft,_1d:()=>Re,_hU:()=>V,a8z:()=>U,aBH:()=>ct,aGV:()=>dn,aUn:()=>ze,acE:()=>wt,agv:()=>dt,avp:()=>hn,b0_:()=>zt,bPX:()=>K,bRk:()=>ot,bgh:()=>He,bvJ:()=>wn,bwY:()=>yn,c5f:()=>An,cbD:()=>Gt,crT:()=>Mt,cvN:()=>gn,d99:()=>Ue,dA5:()=>Qt,dGJ:()=>X,dIF:()=>un,dcx:()=>Kt,eUJ:()=>$t,f4e:()=>st,fGO:()=>B,fLf:()=>Be,fn_:()=>f,fw9:()=>m,g_J:()=>qe,g_R:()=>r,g_x:()=>Ke,gcz:()=>A,glU:()=>q,hOS:()=>Pn,hSJ:()=>At,hUI:()=>ut,hdV:()=>lt,hiv:()=>Qe,hn:()=>te,hq9:()=>Un,hrI:()=>en,i6v:()=>Ge,iTS:()=>ve,iuI:()=>_e,jhk:()=>an,k1F:()=>Y,kFG:()=>cn,kL$:()=>y,kOX:()=>L,kVV:()=>pn,l$l:()=>kt,lhA:()=>re,mO0:()=>In,mbC:()=>rt,mdg:()=>Hn,mr4:()=>J,mvw:()=>It,nAd:()=>Ce,na4:()=>Je,nnF:()=>We,nnn:()=>On,oKZ:()=>Oe,oTl:()=>Ne,oaP:()=>me,ofi:()=>Vn,ojN:()=>Sn,pHk:()=>M,ppG:()=>Z,psP:()=>jt,q93:()=>be,qOX:()=>Nt,qQp:()=>Dt,r1E:()=>Xt,rGh:()=>et,rH0:()=>j,rq$:()=>D,s81:()=>mn,sj0:()=>ft,sjW:()=>Pe,ssU:()=>Ot,t28:()=>ue,tDG:()=>Tt,tMN:()=>k,tSR:()=>it,tWQ:()=>nn,u1i:()=>ie,uEI:()=>pe,v3k:()=>_,vHI:()=>Se,vIf:()=>xe,vLN:()=>zn,vQp:()=>Le,vrM:()=>le,wZn:()=>E,wjL:()=>St,wv1:()=>S,x8h:()=>Ie,xZn:()=>he,xb6:()=>Ee,yWt:()=>Fe,y_q:()=>F,ysX:()=>fn});var r,o,i,a=n(39726),s=n(43277),l=n(39041),c=n(40389),u=n(2061),d=n(72241),p=n(32854),f="PPT",h=!1,g="shimmer",m="closeButton",y="I can't organize your presentation because it's in %s. For a list of supported languages, please visit ",v=40,S="I don't yet support %s. For a list of supported languages, please visit ",C="Conversion is not supported for file with extension .doc",b="beautify",E="sketch",T="Debug",w="Report Bug",I="Taskpane",P="Hidden",_="INTERACTIVE_SUMMARY_MESSAGEID",A=260,k=function(){switch((0,p.mw)()){case d.Y.web:return"cmmkg7c4w5f";case d.Y.MACOS:return"cmm56zgpa3b";case d.Y.IOS:return"cmmu71quv8w";default:return"cmmt6q114wy"}},x=function(){return(0,p.mw)()===d.Y.MACOS?"pptmac":"ppt"},N=function(){return(0,u.Csj)()&&OfficeaicopilotStrings.OutOfCreditsError?OfficeaicopilotStrings.OutOfCreditsError:"Unfortunately, I can't complete that request because you're out of AI credits this month. Your credits will refill at the start of the next month."},O=function(){return(0,u.Csj)()&&OfficeaicopilotStrings.PersonalizationSuggestionText?OfficeaicopilotStrings.PersonalizationSuggestionText:"I want to get better responses by creating my Copilot profile."},D=function(){return(0,u.Csj)()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse1?OfficeaicopilotStrings.PersonalizationSuggestionResponse1:"Your Copilot profile should include your instructions to me about how you want me to answer. To create it, type: 'Create my Copilot profile: [followed by your instructions].'\n\n"},L=function(){return(0,u.Csj)()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse2?OfficeaicopilotStrings.PersonalizationSuggestionResponse2:"**For example:** \n\n**Create my Copilot profile: Include key people, numbers, and dates when answering a question or summarizing a document.**\n\n"},R=function(){return(0,u.Csj)()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse3?OfficeaicopilotStrings.PersonalizationSuggestionResponse3:"Once you create your profile, I'll be able to tailor my responses to you and generate personalized summaries and answers. To update your profile, type 'Update my Copilot profile: [followed by your instructions].' You can always ask me to delete your profile.\n\n"},F=function(){return(0,u.Csj)()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse4?OfficeaicopilotStrings.PersonalizationSuggestionResponse4:"This feature is available in Word and PowerPoint in the Inner Ring (Dogfood) environment. Use thumbs up/down to send feedback to Feature Crew."},M=function(){return"Sorry, I cant create videos in Powerpoint yet, but Im pretty handy with generating imageslet me know if I can help."},B=function(){return[{key:"raiError",value:PowerpointCopilotStrings.ErrorOffensiveContentBlocked},{key:"genericError",value:PowerpointCopilotStrings.ServerErrorMessage},{key:"designerMsg",value:PowerpointCopilotStrings.AssistantResponseInsertLine2}]},U=function(){return[{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantSuggestionPrefixToUseDesignerOption1,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption1},{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantSuggestionPrefixToUseDesignerOption2,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption2},{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantSuggestionPrefixToUseDesignerOption3,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption3},{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantStorytellerPromptResponseMessage,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption1}]},z="<%ic>",H=function(){return[PowerpointCopilotStrings.AssistantResponseMessage1,PowerpointCopilotStrings.AssistantResponseMessage2,PowerpointCopilotStrings.AssistantResponseMessage3,PowerpointCopilotStrings.AssistantResponseMessage4,PowerpointCopilotStrings.AssistantResponseMessage5,PowerpointCopilotStrings.AssistantResponseMessage6,PowerpointCopilotStrings.AssistantResponseMessage7]},G=12e4,V=18e4,j=18e4,q=5e3,W=3e5,Y=6e4,Q=3,J=1e3,X=18e4,K=12e4,Z=function(){return[PowerpointCopilotStrings.AssistantCreatePresentationResponseMessageLine1,PowerpointCopilotStrings.AssistantCreatePresentationResponseMessageLine2,PowerpointCopilotStrings.AssistantCreatePresentationResponseMessageLine3]},$=function(){return PowerpointCopilotStrings.RibbonOnlyActionInsertShapeInstructionsHeader},ee=function(){return[(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonShapes),PowerpointCopilotStrings.RibbonOnlyActionInsertShapeInstructions3,PowerpointCopilotStrings.RibbonOnlyActionInsertShapeInstructions4]},te={menuTitle:function(){return PowerpointCopilotStrings.PromptGuideMenuTitlePrompts},menuSectionCreate:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionCreate},menuSectionUnderstand:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionUnderstand},menuSectionEdit:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionEdit},menuSectionAsk:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionAsk},menuSectionCustomize:function(){return OfficeaicopilotStrings.PromptGuideMenuSectionCustomize},menuSectionCreateImage:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionCreateAnImage},menuSectionSpeak:function(){return OfficeaicopilotStrings.PromptGuideMenuSectionSpeak}},ne={createPresentationFrom:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreatePresentationFrom},addAgendaSlide:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddAgendaSlide},createPresentationAbout:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreatePresentationAbout},createPresentationAboutContoso:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreatePresentationAboutContoso},addSlideWithFAQ:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSlideWithFAQ},gatherRelatedFiles:function(){return PowerpointCopilotStrings.PromptGuideMenuItemGatherRelatedFiles},addSlideAbout:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSlideAbout},addSummarySlide:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSummarySlide},summarize:function(){return PowerpointCopilotStrings.PromptGuideMenuItemSummarize},datesAndDeadLines:function(){return PowerpointCopilotStrings.PromptGuideMenuItemDatesAndDeadLines},nextSteps:function(){return PowerpointCopilotStrings.PromptGuideMenuItemNextSteps},showActionItems:function(){return PowerpointCopilotStrings.PromptMenuItemShowActionItems},showKeySlides:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowKeySlides},showFiles:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowFiles},listProsAndCons:function(){return PowerpointCopilotStrings.PromptGuideMenuItemListProsAndCons},tellMeMore:function(){return PowerpointCopilotStrings.PromptGuideMenuItemTellMeMore},changeBodyText:function(){return PowerpointCopilotStrings.PromptGuideMenuItemChangeBodyText},tryNewDesign:function(){return PowerpointCopilotStrings.PromptGuideMenuItemTryNewDesign},addImage:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddImage},addEnterpriseImage:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddEnterpriseImage},rewriteSlide:function(){return PowerpointCopilotStrings.PromptGuideMenuItemRewriteSlide},organizePresentation:function(){return PowerpointCopilotStrings.PromptGuideMenuItemOrganizePresentation},includePageNumbers:function(){return PowerpointCopilotStrings.PromptGuideMenuItemIncludePageNumbers},rewriteBodyText:function(){return PowerpointCopilotStrings.PromptGuideMenuItemRewriteBodyText},showSelectedTextAsTable:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowSelectedTextAsTable},createCopilotProfile:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreateCopilotProfile},help:function(){return PowerpointCopilotStrings.PromptGuideMenuItemHelp},bestPracticesForPresentation:function(){return PowerpointCopilotStrings.PromptGuideMenuItemBestPracticesForPresentation},improvePresentation:function(){return PowerpointCopilotStrings.PromptGuideMenuItemImprovePresentation},animateBulletedList:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAnimateBulletedList},viewMorePrompts:function(){return OfficeaicopilotStrings.CopilotLabMenuSubItem},whatCanCopilotProfileDo:function(){return OfficeaicopilotStrings.PromptGuideMenuItemWhatCanCopilotProfileDo},createMyCopilotProfile:function(){return OfficeaicopilotStrings.PromptGuideMenuItemCreateMyCopilotProfile},speakWithCopilot:function(){return OfficeaicopilotStrings.PromptGuideMenuItemSpeakWithCopilot}},re={createFromFile:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationFromFilePrompt},summarize:function(){return PowerpointCopilotStrings.PromptGuideMenuItemSummarize},addAgendaSlide:function(){return PowerpointCopilotStrings.ZQMV2AddASlidePrompt},fontSize:function(){return PowerpointCopilotStrings.ZQMV2FontSizePrompt},createPresentationConsumer:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationPrompt},datesAndDeadlines:function(){return PowerpointCopilotStrings.ZQMV2DatesAndDeadlinesPrompt},addAnImage:function(){return PowerpointCopilotStrings.ZQMV2AddAnImagePrompt},tableOfContent:function(){return PowerpointCopilotStrings.ZQMV2AddTableOfContents},addSlideAbout:function(){return PowerpointCopilotStrings.ZQMV2AddSlideAbout},showKeySlides:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowKeySlides},createPresentationAbout:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationPrompt},createPresentationAboutNationalPark:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationAboutNationalParkPrompt},createPresentationAboutCollaboration:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationAboutCollaborationPrompt},addAnImageOfCake:function(){return PowerpointCopilotStrings.ZQMV2AddAnImageOfCakePrompt},addSlideAboutMeeting:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSlideAbout},showKeySlidesFromThisPresentation:function(){return PowerpointCopilotStrings.ZQMV2ShowKeySlidesPrompt},generateImage:function(){return PowerpointCopilotStrings.PromptGuideMenuItemGenerateImage}},oe=function(){return[{actionType:a.X2.Animation,phrases:["animate","animation"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionAddAnimationInstructionsHeader,response:[PowerpointCopilotStrings.RibbonOnlyActionAddAnimationInstructions1,(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabAnimations),PowerpointCopilotStrings.RibbonOnlyActionAddAnimationInstructions3]},{actionType:a.X2.SmartArt,phrases:["smartart","designer"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructionsHeader,response:[PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructions1,PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructions2,PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructions3]},{actionType:a.X2.Transition,phrases:["morph","transition","format_slide,entranceeffect"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionTransitionsInstructionsHeader,response:[PowerpointCopilotStrings.RibbonOnlyActionTransitionsInstructions1,(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabTransitions),PowerpointCopilotStrings.RibbonOnlyActionTransitionsInstructions3]},{actionType:a.X2.Table,phrases:["table","create_chart","insert_chart","add_chart"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertTableInstructionsHeader,response:[(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),PowerpointCopilotStrings.RibbonOnlyActionInsertTableInstructions2]},{actionType:a.X2.Background,phrases:["background","format_slides,backgroundcolor"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionFormatBackgroundInstructionsHeader,response:[(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabDesign),(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonBackground),PowerpointCopilotStrings.RibbonOnlyActionFormatBackgroundInstruction3,PowerpointCopilotStrings.RibbonOnlyActionFormatBackgroundInstruction4]},{actionType:a.X2.Audio,phrases:["audio","music","add_sound","insert_sound","upload_sound"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertAudioInstructionsHeader,response:[(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),PowerpointCopilotStrings.RibbonOnlyActionInsertAudioInstruction2]},{actionType:a.X2.Video,phrases:["video"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertVideoInstructionsHeader,response:[(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonVideo),PowerpointCopilotStrings.RibbonOnlyActionInsertVideoInstruction3]},{actionType:a.X2.Shapes,phrases:["shape"],responseHeader:$(),response:ee()},{actionType:a.X2.TextBox,phrases:["textbox","text boxes","text box"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertTextBoxInstructionsHeader,response:[(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),(0,l.JT)(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonTextBox),PowerpointCopilotStrings.RibbonOnlyActionInsertTextBoxInstructions3]}]},ie="",ae="...",se="ANNOTATION",le=/(Create|Transform).*?(document|file)\s*(.*)\.docx/i,ce=/(Create|Make|Build|Construct|Generate|Produce|Start)(?:(?!\bthe\b).)*(presentation|deck)/i,ue=function(){return PowerpointCopilotStrings.InDocCitationTitle};!function(e){e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.ContextSensitiveHelpClickAction="ContextSensitiveHelpClickAction",e.CopilotTranslatedPPTInfo="CopilotTranslatedPPTInfo",e.TellMe="TellMe",e.CopilotRibbonTabButtonClickAction="CopilotRibbonTabButtonClickAction"}(r||(r={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(o||(o={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(i||(i={}));var de,pe="Copilot Chat Pane UI Experience Degraded",fe="There was an error while trying to register the theme for the Copilot Chat pane";!function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(de||(de={}));var he,ge=7e4,me=3e4,ye=60,ve="/",Se={addSlide:function(){return PowerpointCopilotStrings.PromptMenuItemAddSlide},addText:function(){return PowerpointCopilotStrings.PromptMenuItemAddText},changeTextFormat:function(){return PowerpointCopilotStrings.PromptMenuItemTextFormat},addImage:function(){return PowerpointCopilotStrings.PromptMenuItemAddImage},addEnterpriseImage:function(){return PowerpointCopilotStrings.PromptMenuItemAddEnterpriseImage},transformFile:function(){return PowerpointCopilotStrings.PromptMenuItemHumbleTransformFileAlt.trim()},animate:function(){return PowerpointCopilotStrings.PromptMenuItemAnimate},structurePresentation:function(){return(0,c.dD)()?PowerpointCopilotStrings.PromptMenuItemOrganize:PowerpointCopilotStrings.PromptMenuItemOrganizePresentation},createPresentation:function(){return PowerpointCopilotStrings.PromptMenuItemCreatePresentation},tryNewDesign:function(){return PowerpointCopilotStrings.PromptMenuItemTryNewDesign},summarizePresentation:function(){return(0,c.dD)()?PowerpointCopilotStrings.ZQMPromptItemSummarize:PowerpointCopilotStrings.PromptMenuItemSummarize},showKeySlides:function(){return PowerpointCopilotStrings.PromptMenuItemShowKeySlides},showActionItems:function(){return PowerpointCopilotStrings.PromptMenuItemShowActionItems},askAQuestion:function(){return(0,c.dD)()?PowerpointCopilotStrings.ZQMPromptItemAsk+ae:PowerpointCopilotStrings.PromptMenuItemAskAQuestion},showHelpLink:function(){return PowerpointCopilotStrings.PromptGuideMenuItemHelp},viewMorePrompts:function(){return OfficeaicopilotStrings.CopilotLabMenuSubItem}},Ce="PC",be="OFFICEONLINE",Ee="MAC",Te="IOS",we=26891,Ie=34918,Pe=function(){return[PowerpointCopilotStrings.LearnMoreAssistantResponseListItem1,PowerpointCopilotStrings.LearnMoreAssistantResponseListItem2,PowerpointCopilotStrings.LearnMoreAssistantResponseListItem3,PowerpointCopilotStrings.LearnMoreAssistantResponseListItem4]},_e="https://go.microsoft.com/fwlink/?linkid=2246424",Ae="https://go.microsoft.com/fwlink/?linkid=2239972",ke="https://go.microsoft.com/fwlink/?linkid=2250136",xe="https://go.microsoft.com/fwlink/?linkid=2247343",Ne="File url is null or empty.",Oe="Document has UDP label",De="Document has unsupported label type",Le="Document has other expected protection",Re="Document is password protected",Fe="User has no rights in the file's label",Me="User has no extraction rights in the file's label",Be="Document is IRM Protected",Ue="Here is the list of files you have chosen for the presentation creation.",ze=function(){return(0,u.Csj)()?OfficeaicopilotStrings.CopyButtonLabel:"Copy"},He=function(){return(0,u.Csj)()?OfficeaicopilotStrings.CopyButtonPopover:"Copied to clipboard"},Ge=function(){return(0,u.Csj)()?PowerpointCopilotStrings.PlayKeySlidesButtonLabel:"Play Key Slides"},Ve=function(e){return(0,l.Qc)((0,l.JT)(PowerpointCopilotStrings.SlideN,e.toString()),"Slide ".concat(e))},je=function(){return s.i.GetHostAppPlatform()===Ce?OfficeaicopilotStrings.MicrophonPermissionErrorTitleWin32:OfficeaicopilotStrings.MicrophonPermissionErrorTitle},qe=function(){return s.i.GetHostAppPlatform()===Ce?OfficeaicopilotStrings.MicrophonPermissionErrorTextWin32:OfficeaicopilotStrings.MicrophonPermissionErrorText},We=function(){return(0,u.Csj)()?PowerpointCopilotStrings.ChatPlaceholderMessageUpdated:"Ask me anything about this presentation"},Ye="EnterpriseSearch",Qe="acquired",Je=1624461388,Xe=128,Ke="1.2.0.0",Ze="https://copilot.cloud.microsoft/prompts?ocid=",$e={OFFICEONLINE:"copilotlab_powerpointchatweb",PC:"copilotlab_powerpointchatwin32",MAC:"copilotlab_powerpointchatmac",IOS:"copilotlab_powerpointchatios"},et={OFFICEONLINE:"PowerPoint.Web.Copilot_Lib",PC:"PowerPoint.Win32.Copilot_Lib",MAC:"PowerPoint.Mac.Copilot_Lib",IOS:"PowerPoint.iPad.Copilot_Lib"},tt={OFFICEONLINE:"PowerPoint.Web.Copilot_FRE",PC:"PowerPoint.Win32.Copilot_FRE",MAC:"PowerPoint.Mac.Copilot_FRE",IOS:"PowerPoint.iPad.Copilot_FRE"};!function(e){e.QuickAnswer="QuickAnswer",e.HelpArticle="HelpArticle"}(he||(he={}));var nt,rt="",ot=100,it="/Sydney",at="This summary is based on the textual content of presentation. You can read it while your full summary with text and visuals (images, charts, etc.) is being generated.",st="Here's a summary of the presentation based on text and visuals:",lt="Generating full summary...",ct="Including summary from visuals...",ut="Analysing images...",dt="Synthesizing text and visuals...",pt="Almost there...",ft=function(){return(0,u.Csj)()?OfficeaicopilotStrings.CseSelfHelpSkillContentRetrievedQuickAnswer:"Here's what I found:"},ht=function(){return(0,u.Csj)()?OfficeaicopilotStrings.CseSelfHelpSkillContentRetrievedSingleArticle:"Here's what I found:"},gt=function(){return(0,u.Csj)()?OfficeaicopilotStrings.CseSelfHelpSkillErrorOrNoContentRetrieved:"Sorry, I'm having trouble finding information about that. Please rephrase your request and try again."},mt=function(){return(0,u.Csj)()?PowerpointCopilotStrings.CseSelfHelpSkillSourceLabel:"PowerPoint Help"},yt=function(){return(0,u.Csj)()?OfficeaicopilotStrings.ChatInputCharacterLimitExceededMessage:"Character limit exceeded"},vt=function(){return(0,u.Csj)()?OfficeaicopilotStrings.MeetingSuggestionNotAvailable:"Meeting suggestions aren't available"},St=function(){return(0,u.Csj)()?OfficeaicopilotStrings.FileSuggestionNotAvailable:"File suggestions aren't available"},Ct=function(){return(0,u.Csj)()?OfficeaicopilotStrings.PeopleSuggestionNotAvailable:"People suggestions aren't available"},bt=function(){return(0,u.Csj)()?OfficeaicopilotStrings.EmailSuggestionNotAvailable:"Email suggestions aren't available"};!function(e){e.Chat="Chat"}(nt||(nt={}));var Et,Tt="Create presentation from",wt="Create presentation about",It="Add a slide",Pt="Organize this presentation",_t="Add an image of",At="Add an agenda slide",kt="Animate this slide",xt="I don't recognize that wording as something I can do. Here are some examples of ways I can help, with the exact words to use:",Nt="Success",Ot="copilotChat",Dt="Copilot",Lt="reviewerAgent",Rt="Reviewer",Ft="GetMosCopilotExtensions",Mt="execute",Bt="telemetry",Ut="PptCopilotActionApi",zt="1.4",Ht="1.5",Gt=function(){return[{key:a.VC.TRIGGERING_VISUALS_FLOW,value:(0,u.Csj)()?PowerpointCopilotStrings.SummaryProgressStage1:"Scanning presentation again..."},{key:a.VC.GRAPH_API_SUCCEED,value:(0,u.Csj)()?PowerpointCopilotStrings.SummaryProgressStage1:"Scanning presentation again..."},{key:a.VC.THUMBNAILS_DOWNLOADED,value:(0,u.Csj)()?PowerpointCopilotStrings.SummaryProgressImprovementStage:"Checking for any improvement..."},{key:a.VC.VD_GENERATION_ONGOING,value:(0,u.Csj)()?PowerpointCopilotStrings.SummaryProgressImprovementStage:"Checking for any improvement..."},{key:a.VC.VD_GENERATION_COMPLETED,value:(0,u.Csj)()?PowerpointCopilotStrings.LoadingUIWorkingOnItStep:"Working on it..."},{key:a.VC.SUMMARY_SIGNAL_TRIGGERED,value:(0,u.Csj)()?PowerpointCopilotStrings.LoadingUILookingThingsOver:"Looking things over..."},{key:a.VC.VISUAL_SUMMARY_GENERATING,value:(0,u.Csj)()?PowerpointCopilotStrings.LoadingUIAlmostThere:"Almost there..."},{key:a.VC.VISUAL_SUMMARY_FIRST_STREAMING_CHUNK,value:(0,u.Csj)()?PowerpointCopilotStrings.LoadingUiFinishingUpStep:"Finishing up..."},{key:a.VC.VISUAL_SUMMARY_GENERATED,value:(0,u.Csj)()?PowerpointCopilotStrings.LoadingUiFinishingUpStep:"Finishing up..."},{key:a.VC.VISUAL_DESCRIPTION_FAILURE,value:qt()},{key:a.VC.THUMBNAIL_API_FAILURE,value:qt()},{key:a.VC.SUMMARY_SIGNAL_NOT_TRIGGERED,value:qt()},{key:a.VC.GRAPH_API_FAILED,value:qt()},{key:a.VC.NO_THUMBNAILS_FOUND,value:qt()},{key:a.VC.VISUAL_SUMMARY_GENERATION_FAILED,value:qt()}]},Vt=function(){return(0,u.Csj)()?PowerpointCopilotStrings.SummaryProgressGenericMessageHeader:"Working on your summary to improve it"},jt=function(){return(0,u.Csj)()?PowerpointCopilotStrings.SummaryGenericSuccessButtonText:"Show improved summary"},qt=function(){return(0,u.Csj)()?PowerpointCopilotStrings.SummaryProgressGenericFailureMessage:"No improvements in the summary as of now. Feel free to ask me a question about this deck"},Wt=function(){return(0,u.Csj)()?OfficeaicopilotStrings.ChatContainerInsertActionButtonText:"Insert"},Yt=function(){return(0,u.Csj)()?PowerpointCopilotStrings.LoadingUIWorkingOnItStep:"Working on it..."},Qt=function(){return"How do I insert a shape?"},Jt="Empty body in notification",Xt="Empty query in notification",Kt="Stale query in notification",Zt="Ignore notification for incomplete card content",$t="Empty message id for inprogress notification",en="Empty message id for completed notification",tn="Empty message id for disable button notification",nn="Empty message id for failed notification",rn="Timeout occurred for notification",on="Completed notification received",an="Empty visual summary response",sn="No body in visual summary response",ln="Notification success button clicked",cn="Empty action parameter in notification",un="Exception while logging ClickableKeySlidesEnabled event",dn="Error while getting active slide moniker",pn="selectedSlideMoniker is undefined",fn="Exception onLinkClick for clickable key slides: Error while sending telemetry",hn="Exception onLinkClick for clickable key slides: Error while running setSelectedSlides",gn="Exception in getKeySlidesClickableElement: Error while getting slideId",mn="Exception in getKeySlidesClickableElement: Parsing error",yn="translate_ppt",vn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationButtonPlaceHolder:"Select language"},Sn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationLanguageInputMessage:"Choose a language for translation. A new copy of the presentation will be created."},Cn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationButtonText:"Translate"},bn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationProgressMessage:"OK, translating a copy of this presentation into {0}. It might take a while. I'll let you know when your presentation is ready. Meanwhile, I can help you with something else."},En=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSuccessMessage:"A copy of your presentation has been successfully translated into {0}. Select the file to open it in a new tab."},Tn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationUnsupportedLanguageErrorMessage:"This language isn't currently supported. Select a different language. A new copy of the presentation will be created."},wn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslateOnlyFewSlidesErrorMessage:"I can only translate the full presentation into a new file. Would you like me to translate the whole presentation?"},In=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationCharacterSizeLimit:"It looks like this presentation has too much text to translate. Some translations may be missing."},Pn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslateFullDeckWarningCancelButton:"Cancel"},_n=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslateFullDeckButton:"Translate"},An=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationTextualContentTooLarge:"The size of textual content in this presentation is too large. Please reduce textual content and try again."},kn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationTargetLanguagePartiallyMatched:"Please confirm that this is the language you'd like to use. A new copy of the presentation will be created."},xn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationNoOptionMatchedMessage:"No match found. Try again."},Nn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.LoadingTranslatedPPT:"Loading"},On=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSuccessMessageDesktop:"A new translated presentation in {0} has been successfully generated."},Dn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationLanguageInputMessageDesktop:"Choose a language for translation. A new translated presentation will be created."},Ln=function(){return(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationProgressMessageDesktop:"OK, translating this presentation into {0}. It might take a while. I'll let you know when your new presentation is ready. Meanwhile, I can help you with something else."},Rn=function(){return(0,u.Csj)()?PowerpointCopilotStrings.GeneratingTranslatedPresentationMessage:"Generating translated presentation..."};!function(e){e.LocalDraft="LocalDraft",e.ODSP="ODSP"}(Et||(Et={}));var Fn=function(){return[{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationEnglishLanguage:"English",code:"en"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationGermanLanguage:"German",code:"de"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationFrenchFranceLanguage:"French",code:"fr"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationFrenchCanadaLanguage:"French (Canada)",code:"fr-ca"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSpanishLanguage:"Spanish",code:"es"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationJapaneseLanguage:"Japanese",code:"ja"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationPortugueseBrazilLanguage:"Portuguese (Brazil)",code:"pt"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationItalianLanguage:"Italian",code:"it"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSimplifiedChineseLanguage:"Chinese (Simplified)",code:"zh-Hans"}]},Mn=function(){return[{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationDutchLanguage:"Dutch",code:"nl"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSwedishLanguage:"Swedish",code:"sv"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationDanishLanguage:"Danish",code:"da"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationFinnishLanguage:"Finnish",code:"fi"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationRussianLanguage:"Russian",code:"ru"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationNorwegianBokmlLanguage:"Norwegian Bokml",code:"nb"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationKoreanLanguage:"Korean",code:"ko"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationTraditionalChineseLanguage:"Chinese (Traditional)",code:"zh-Hant"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationPolishLanguage:"Polish",code:"pl"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationTurkishLanguage:"Turkish",code:"tr"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationArabicLanguage:"Arabic",code:"ar"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationHebrewLanguage:"Hebrew",code:"he"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationPortuguesePortugalLanguage:"Portuguese (Portugal)",code:"pt-PT"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationCzechLanguage:"Czech",code:"cs"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationHungarianLanguage:"Hungarian",code:"hu"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationThaiLanguage:"Thai",code:"th"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationUkrainianLanguage:"Ukrainian",code:"uk"}]},Bn=function(){return[{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationWelshLanguage:"Welsh",code:"cy"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationCatalanLanguage:"Catalan",code:"ca"}]},Un=function(){return[{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationBulgarianLanguage:"Bulgarian",code:"bg"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationEstonianLanguage:"Estonian",code:"et"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationGreekLanguage:"Greek",code:"el"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationCroatianLanguage:"Croatian",code:"hr"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationIndonesianLanguage:"Indonesian",code:"id"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationLatvianLanguage:"Latvian",code:"lv"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationLithuanianLanguage:"Lithuanian",code:"lt"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationRomanianLanguage:"Romanian",code:"ro"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSlovenianLanguage:"Slovenian",code:"sl"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSlovakLanguage:"Slovak",code:"sk"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationVietnameseLanguage:"Vietnamese",code:"vi"},{language:(0,u.Csj)()?PowerpointCopilotStrings.TranslatePresentationSerbianLatinLanguage:"Serbian (Latin)",code:"sr-latn"}]},zn={language:"Hindi",code:"hi"},Hn="Augloop session is undefined",Gn={TitleAddASlide:function(){return PowerpointCopilotStrings.ProactiveZQMTitleAddASlide},TextAddASlide:function(){return PowerpointCopilotStrings.ProactiveZQMTextAddASlide},TitleAddAStockImage:function(){return PowerpointCopilotStrings.ProactiveZQMTitleAddAStockImage},TextAddAStockImage:function(){return PowerpointCopilotStrings.ProactiveZQMTextAddAStockImage},TitleCoachMe:function(){return PowerpointCopilotStrings.ProactiveZQMTitleCoachMe},TextCoachMe:function(){return PowerpointCopilotStrings.ProactiveZQMTextCoachMe},TitleHowDoI:function(){return PowerpointCopilotStrings.ProactiveZQMTitleHowDoI},TextHowDoI:function(){return PowerpointCopilotStrings.ProactiveZQMTextHowDoI},TitleCreateAnImage:function(){return PowerpointCopilotStrings.ProactiveZQMTitleCreateAnImage},TextCreateAnImage:function(){return PowerpointCopilotStrings.ProactiveZQMTextCreateAnImage},TitleAddAnImage:function(){return PowerpointCopilotStrings.ProactiveZQMTitleAddAnImage},TextAddAnImage:function(){return PowerpointCopilotStrings.ProactiveZQMTextAddAnImage},TitleExtractKeyInformation:function(){return PowerpointCopilotStrings.ProactiveZQMTitleExtractKeyInformation},TextExtractKeyInformation:function(){return PowerpointCopilotStrings.ProactiveZQMTextExtractKeyInformation},TitleWhatsTheFocus:function(){return PowerpointCopilotStrings.ProactiveZQMTitleWhatsTheFocus},TextWhatsTheFocus:function(){return PowerpointCopilotStrings.ProactiveZQMTextWhatsTheFocus},TitleAddAnAgenda:function(){return PowerpointCopilotStrings.ProactiveZQMTitleAddAnAgenda},TextAddAnAgenda:function(){return PowerpointCopilotStrings.ProactiveZQMTextAddAnAgenda},TitleQuestionsFromAudience:function(){return PowerpointCopilotStrings.ProactiveZQMTitleQuestionsFromAudience},TextQuestionsFromAudience:function(){return PowerpointCopilotStrings.ProactiveZQMTextQuestionsFromAudience},TitleShowKeySlides:function(){return PowerpointCopilotStrings.ProactiveZQMTitleShowKeySlides},TextShowKeySlides:function(){return PowerpointCopilotStrings.ProactiveZQMTextShowKeySlides},TitleCreateAnImage2:function(){return PowerpointCopilotStrings.ProactiveZQMTitleCreateAnImage2},TextCreateAnImage2:function(){return PowerpointCopilotStrings.ProactiveZQMTextCreateAnImage2},TitleStayOnTrack:function(){return PowerpointCopilotStrings.ProactiveZQMTitleStayOnTrack},TextStayOnTrack:function(){return PowerpointCopilotStrings.ProactiveZQMTextStayOnTrack},TitleMainPoints:function(){return PowerpointCopilotStrings.ProactiveZQMTitleMainPoints},TextMainPoints:function(){return PowerpointCopilotStrings.ProactiveZQMTextMainPoints},TitleFindSpecificInformation:function(){return PowerpointCopilotStrings.ProactiveZQMTitleFindSpecificInformation},TextFindSpecificInformation:function(){return PowerpointCopilotStrings.ProactiveZQMTextFindSpecificInformation},TitleQuestionsForAudience:function(){return PowerpointCopilotStrings.ProactiveZQMTitleQuestionsForAudience},TextQuestionsForAudience:function(){return PowerpointCopilotStrings.ProactiveZQMTextQuestionsForAudience},TitleWhatsTheTone:function(){return PowerpointCopilotStrings.ProactiveZQMTitleWhatsTheTone},TextWhatsTheTone:function(){return PowerpointCopilotStrings.ProactiveZQMTextWhatsTheTone},TitleBePrepared:function(){return PowerpointCopilotStrings.ProactiveZQMTitleBePrepared},TextBePrepared:function(){return PowerpointCopilotStrings.ProactiveZQMTextBePrepared}},Vn=(0,u.Csj)()?PowerpointCopilotStrings.DesignerCardPrefixForSharedOutput:"Sure, here are some images, choose one to insert into the presentation"},39726:(e,t,n)=>{"use strict";var r,o,i,a,s,l,c,u,d,p,f,h,g,m,y,v,S,C,b,E,T,w,I,P,_,A,k,x,N,O,D,L,R,F,M,B,U,z,H;n.d(t,{Ae:()=>a,B2:()=>O,BJ:()=>E,CK:()=>z,HK:()=>P,IU:()=>A,K3:()=>N,Mg:()=>y,NX:()=>g,Nj:()=>f,Ns:()=>p,OH:()=>B,OY:()=>H,Q9:()=>l,Qp:()=>F,Re:()=>o,T_:()=>C,UY:()=>I,VC:()=>M,X2:()=>c,Xw:()=>u,Z4:()=>T,Zi:()=>m,bV:()=>k,cc:()=>L,cn:()=>S,e0:()=>b,iE:()=>w,jd:()=>v,ll:()=>_,rI:()=>r,t4:()=>s,uo:()=>d,uz:()=>x,wv:()=>U,wz:()=>D,xS:()=>h,zs:()=>R}),function(e){e[e.FAILED=0]="FAILED",e[e.BLOCKED=1]="BLOCKED",e[e.SUCCESS=2]="SUCCESS",e[e.DISMISSED=3]="DISMISSED",e[e.PARTIAL_SUCCESS=4]="PARTIAL_SUCCESS",e[e.UNSUPPORTED=5]="UNSUPPORTED",e[e.UNEXPECTED_VERSION=6]="UNEXPECTED_VERSION",e[e.USER_ABORTED=7]="USER_ABORTED",e[e.CONTENT_GENERATION_DISABLED=8]="CONTENT_GENERATION_DISABLED",e[e.PAUSED_ON_WARNING=9]="PAUSED_ON_WARNING"}(r||(r={})),function(e){e[e.NONE=0]="NONE",e[e.DESIGNER_FAILED=1]="DESIGNER_FAILED",e[e.DESIGNER_DISABLED=2]="DESIGNER_DISABLED",e[e.CREATE_PRESENTATION_BLOCKED=3]="CREATE_PRESENTATION_BLOCKED",e[e.ADD_SLIDE_BLOCKED=4]="ADD_SLIDE_BLOCKED",e[e.CREATE_PRESENTATION_BLOCKED_ON_WARNING=5]="CREATE_PRESENTATION_BLOCKED_ON_WARNING",e[e.LAUNCH_NB_TO_CREATE_PRESENTATION=6]="LAUNCH_NB_TO_CREATE_PRESENTATION",e[e.STRUCTURE_PRESENTATION_BLOCKED=7]="STRUCTURE_PRESENTATION_BLOCKED",e[e.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING=8]="STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING",e[e.SEGMENT_TO_SLIDE_SERVER_ERROR=9]="SEGMENT_TO_SLIDE_SERVER_ERROR",e[e.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS=10]="DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS",e[e.APPLY_CLP_LABEL_FAILED=11]="APPLY_CLP_LABEL_FAILED",e[e.COMMANDING_DISABLED=12]="COMMANDING_DISABLED",e[e.UNEXPECTED_VERSION=13]="UNEXPECTED_VERSION",e[e.CONTENT_INSERTION_FAILED=14]="CONTENT_INSERTION_FAILED",e[e.DESIGNER_FAILED_ALREADY_HAS_ANIMATION=15]="DESIGNER_FAILED_ALREADY_HAS_ANIMATION",e[e.DOCUMENT_CHANGED_BEFORE_COMMAND_EXECUTION=16]="DOCUMENT_CHANGED_BEFORE_COMMAND_EXECUTION",e[e.COMMAND_HAD_NO_EFFECT=17]="COMMAND_HAD_NO_EFFECT",e[e.PARSE_DESIGNER_OPTIONS_FAILED=18]="PARSE_DESIGNER_OPTIONS_FAILED",e[e.FETCH_DESIGN_SUGGESTION_FAILED=19]="FETCH_DESIGN_SUGGESTION_FAILED",e[e.APPLY_DESIGN_SUGGESTION_FAILED=20]="APPLY_DESIGN_SUGGESTION_FAILED",e[e.PREP_DESIGN_INPUT_FAILED=21]="PREP_DESIGN_INPUT_FAILED",e[e.DOC_CLOSING_WITH_INCOMPLETE_PROTOCOL=22]="DOC_CLOSING_WITH_INCOMPLETE_PROTOCOL",e[e.FETCH_DESIGN_SUGGESTION_PARTIAL_SUCCESS=23]="FETCH_DESIGN_SUGGESTION_PARTIAL_SUCCESS",e[e.PREPARE_STAGE_TIMED_OUT=24]="PREPARE_STAGE_TIMED_OUT",e[e.EMPTY_JOFC_CMD_RESULT_ID=25]="EMPTY_JOFC_CMD_RESULT_ID",e[e.JOFC_EXCEPTION=26]="JOFC_EXCEPTION",e[e.MULTIPLE_GENERATE_IN_ODSL=27]="MULTIPLE_GENERATE_IN_ODSL",e[e.IMAGE_INVALID_ODSL=28]="IMAGE_INVALID_ODSL",e[e.UNKNOWN_ERROR=100]="UNKNOWN_ERROR"}(o||(o={})),function(e){e.Text="text",e.Shape="shape",e.Presentation="presentation",e.Slide="slide",e.Image="image"}(i||(i={})),function(e){e.CreatePresentation="CreatePresentation",e.AddSlides="AddSlides",e.AddImage="AddImage",e.AddText="AddText",e.RewriteText="RewriteText",e.ChangeStyle="ChangeStyle",e.PresentationSummary="PresentationSummary",e.PresentationSummaryWithVisual="PresentationSummaryWithVisual",e.ImportantSlides="ImportantSlides",e.CallToAction="CallToAction",e.TransformDocument="TransformDocument",e.OrganizePresentation="OrganizePresentation",e.UserCancellation="UserCancellation",e.Default="Default"}(a||(a={})),function(e){e.Cancelled="cancelled",e.Failure="fail",e.NotHandled="nothandled",e.Success="success"}(s||(s={})),function(e){e.Chat="chat",e.Human="human"}(l||(l={})),function(e){e.Animation="Animation",e.Transition="Transition",e.SmartArt="Smartart",e.Table="Table",e.Background="Background",e.Audio="Audio",e.Video="Video",e.Theme="Theme",e.Shapes="Shapes",e.TextBox="TextBox"}(c||(c={})),function(e){e.CHATPPT="Chat PPT",e.COPILOTSTART="Copilot Start",e.DECKSUMMARY="Deck Summary",e.COPILOTLAB="Copilot Lab",e.SELFHELPSEARCH="SelfHelpSearch",e.DESIGNERCARD="Designer-Card",e.SKETCHTOIMAGE="SketchToImage",e.OCV_FEATURE_AREA="Copilot"}(u||(u={})),function(e){e.AIThumbsDown="AIThumbsDown",e.AIThumbsUp="AIThumbsUp"}(d||(d={})),function(e){e.BLANK="Blank",e.LESS_WORD_COUNT="LessWordCount",e.USED="Used"}(p||(p={})),function(e){e.IDLE="idle",e.QUERY_PROCESSING="query processing",e.EXECUTING="executing",e.STREAMING="streaming",e.WAITING_FOR_COPILOT_WF_RESPONSE="waiting for copilot workflow response",e.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE="waiting for content processing workflow response",e.WAITING_FOR_SEGMENT_TO_SLIDE_WF_RESPONSE="waiting for segment to slide workflow response",e.WAITING_FOR_SUMMARY_WF_RESPONSE="waiting for summary workflow response",e.WAITING_FOR_ORGANIZE_WF_RESPONSE="waiting for organize workflow response",e.WAITING_FOR_ACTION_AI_WF_RESPONSE="waiting for action ai workflow response",e.WAITING_FOR_STORY_TELLER_WF_RESPONSE="waiting for story teller workflow response",e.WAITING_FOR_ADDSLIDE_WF_RESPONSE="waiting for add slide workflow response",e.WAITING_FOR_PRESENTATIONTRANSFORM_WF_RESPONSE="waiting presentation-transform workflow response",e.WAITING_FOR_PRESENTATION_RECOMMENDATION_WF_RESPONSE="waiting for presentation-recommendation workflow response",e.WAITING_FOR_CONTENT_VALIDATOR_WF_RESPONSE="waiting for content validator workflow response",e.EXECUTING_APPLYJOFC_PROTOCOL="executing apply jofc protocol",e.WAITING_FOR_USER_PROFILE_WF_RESPONSE="waiting for user profile workflow response"}(f||(f={})),function(e){e.EXPLANATIONS="explanations",e.SUGGESTIONS="suggestions",e.DISAMBIGUATIONS="disambiguations"}(h||(h={})),function(e){e.ModalDialog="ModalDialog",e.Taskpane="Taskpane"}(g||(g={})),function(e){e.Like="Like",e.Dislike="Dislike",e.Idea="Idea",e.Unclassified="Unclassified"}(m||(m={})),function(e){e.notSet="NotSet",e.true="True",e.false="False"}(y||(y={})),function(e){e.Command="command",e.Summarize="summarize",e.ImportantSlide="importantslide",e.ActionItem="actionitem",e.SegmentSummarize="segmentsummarize",e.StyleSummarize="stylesummarize",e.Help="help",e.Undo="undo",e.Icon="icon",e.Invalid="invalid",e.OutOfScope="out of scope",e.ImageOutOfScope="imageoutofscope"}(v||(v={})),function(e){e.Slide="slide",e.Text="text",e.Image="image"}(S||(S={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(C||(C={})),function(e){e[e.None=0]="None",e[e.CreateNewPresentationFromExisting=1]="CreateNewPresentationFromExisting",e[e.LaunchNBToCreatePresentation=2]="LaunchNBToCreatePresentation",e[e.OrganizeStructuredPresentation=3]="OrganizeStructuredPresentation"}(b||(b={})),function(e){e.CatchUp="Catch Up",e.Create="Create",e.Ask="Ask",e.Understand="Understand",e.Edit="Edit",e.Customize="Customize"}(E||(E={})),function(e){e.OffensiveContent="OffensiveContent",e.UnsupportedLanguageError="UnsupportedLanguageError",e.InferenceAPIError="InferenceAPIError",e.LicensingError="LicensingError",e.InputQueryError="InputQueryError",e.InvalidInputError="InvalidInputError",e.PostProcessProgramError="PostProcessProgramError",e.ResolveDelegationsError="ResolveDelegationsError",e.ODSLSyntaxError="ODSLSyntaxError",e.SydneyCancelledError="SydneyCancelledError",e.DisambiguationError="DisambiguationError",e.DisengagedError="DisengagedError",e.TokenCountError="TokenCountError",e.VisualDescriptionGeneration="VisualDescriptionGeneration",e.InvalidLanguageError="InvalidLanguageError",e.InvalidIntentError="InvalidIntentError",e.InvalidSignalError="InvalidSignalError",e.Text2ImageError="Text2ImageError",e.ODSLParseError="ODSLParseError",e.OffensiveContentError="OffensiveContentError",e.ClientProgramResponseError="ClientProgramResponseError",e.SkillFailedError="SkillFailedError",e.PromptInjection="PromptInjection"}(T||(T={})),function(e){e.Input_query="input-query",e.Input_content="input-content",e.Generated_sydney_output="generated-sydney-output",e.Generated_output="generated-output",e.Too_long="too-long",e.Too_short="too-short",e.Invalid="invalid",e.OutOfScope="out-of-scope",e.UnsupportedMultiAgent="unsupported-multi-agent",e.DocumentProcessingDenied="document-processing-denied",e.Unsupported_language="unsupported-lang",e.Throttled="throttled",e.Timeout="timeout",e.User_throttled="user-throttled",e.Scenario_throttled="scenario-throttled",e.Missing_Service_Plan="missing-service-plan",e.Bad_Token="bad-token",e.Token="token",e.Unsupported_Program="unsupported-program",e.InvalidSource="invalid-source",e.Unknown="unknown",e.BadResponse="bad-response",e.NotAvailable="not-available",e.BadValue="bad-value",e.Cancelled="cancelled",e.DisambiguationRequired="disambiguation-required",e.DismissedInvalidRequiredArguments="dismissed-invalid-required-arguments",e.EmptyGeneratePrompt="empty-generate-prompt",e.EmptyGenerateSource="empty-generate-source",e.EmptyResponse="empty-response",e.ExcessTokensRequest="excess-tokens-request",e.ExcessTokensResponse="excess-tokens-response",e.FailedToGenerateVisualDescription="failed-to-generate-visual-description",e.FailedToGetInputLanguage="failed-to-get-input-language",e.GenericError="GenericError",e.GetImageDetailsFailed="get-image-details-failed",e.GetProgramFailed="get-program-failed",e.ProgramFailed="program-failed",e.InvalidPrompt="invalid-prompt",e.InvalidReplaceTextResponse="invalid-replace-text-response",e.InvalidRewriteResponse="invalid-rewrite-response",e.InvalidGenerateSource="invalid-generate-source",e.LowScore="low-score",e.Missing="missing",e.MissingRequiredArguments="missing-required-arguments",e.NoImages="no-images",e.NoOp="no-op",e.NotSupported="not-supported",e.OutputRAIDependency="output-rai-dependency",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.ParseJsonFailed="parse-json-failed",e.PerpetualDisambiguationLoop="perpetual-disambiguation-loop",e.ResponseFailed="response-failed",e.SkillFailedError="skill-failed-error",e.SydneyUnsupportedLang="sydney-unsupported-lang",e.Truncated="Truncated",e.TimeOut="time-out",e.Unexpected="unexpected",e.UnknownOpenAI="UnknownOpenAI",e.UnknownLang="unknown-lang",e.UnknownStatement="unknown-statement",e.UnrecognizedBaseUrl="unrecognized-base-url",e.Unsupported="unsupported",e.UnsupportedByAdmin="unsupported-by-admin",e.VariableUnknownName="variable-unknown-name",e.VariableWrongType="variable-wrong-type",e.WrongType="wrong-type",e.ZeroParsed="zero-parsed",e.TooShort="too-short",e.MissingPPTContent="missing-ppt-content",e.TooLong="too-long",e.TooManySlides="too-many-slides",e.CouldNotDetect="could-not-detect",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.Detected="detected",e.InputRAIDependency="input-rai-dependency"}(w||(w={})),function(e){e.IgnorableError="IgnorableError",e.SydneyError="SydneyError",e.DisengagedError="DisengagedError"}(I||(I={})),function(e){e.InvalidConversationId="bad-conversation-id",e.InvalidRequest="sydney-invalid-request",e.SydneyValidationFailed="sydney-validation-failed",e.ConnectionNotConnected="connection-not-in-connected-state",e.InvocationCanceled="invocation-canceled",e.CannotProvideToken="cannot-provide-token",e.ServerTimeout="server-timeout",e.WebsocketFailedToConnect="websocket-failed-to-connect",e.WebsocketClosed="websocket-closed-with-1006",e.ServerOnClose="server-on-close",e.InvalidMsgType="invalid-msg-type",e.UserThrottled="user-throttled",e.Ic3="ic3",e.SubstrateSearch="substrate-search",e.PolymerLLM="polymer-llm",e.RequestTooBig="request-too-big",e.Unknown="unknown",e.OutOfCredits="out-of-credits"}(P||(P={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidIntent="InvalidIntentError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPIError="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjection",e.LicensingError="LicensingError",e.InputQueryError="InputQueryError",e.VisualDescriptionGeneration="VisualDescriptionGeneration"}(_||(_={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooShort="too-short",e.MissingPPTContent="missing-ppt-content",e.TooLong="too-long",e.Invalid="invalid",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.EmptyResponse="empty-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.Bad_Token="bad-token",e.FailedToGetInputLanguage="failed-to-get-input-language",e.InputRAIDependency="input-rai-dependency",e.OutputRAIDependency="output-rai-dependency",e.FailedToGenerateVisualDescription="failed-to-generate-visual-description"}(A||(A={})),function(e){e.Nudge_UserQuery="Nudge_UserQuery",e.AppChat_PreFetchQuery="AppChat_PreFetchQuery",e.AppChat_UserQuery="AppChat_UserQuery",e.InsightCard_Query="InsightCard_Query"}(k||(k={})),function(e){e.HelpResponse="HelpResponse",e.DesignerCard="DesignerCard",e.SketchCard="SketchCard",e.TranslationCard="TranslationCard",e.InteractiveSummaryCard="InteractiveSummaryCard"}(x||(x={})),function(e){e.RTL="rtl",e.LTR="ltr"}(N||(N={})),function(e){e.Summary="Summary",e.SpeakerNotes="SpeakerNotes",e.BasicChat="BasicChat",e.Commanding="Commanding",e.Designer="Designer",e.AddSlide="AddSlide",e.CreatePresentation="CreatePresentation",e.ContentTransform="ContentTransform",e.OrganizePresentation="OrganizePresentation",e.SelfHelp="SelfHelp",e.Personalization="Personalization",e.SearchDocument="SearchDocument",e.Sydney="Sydney",e.Unset=""}(O||(O={})),function(e){e.APOLOGY="apology",e.BASIC_CHAT="generate_response",e.CANNED_RESPONSE="annrules",e.DEBUG_COMMAND="debug_command",e.DEEPLEO_SYDNEY="deepleo",e.EDIT_DOCUMENT="edit_document",e.DESIGNER_INSERT_GRAPHIC="insert_graphic",e.PERSONALIZATION_END="personalize_end",e.PERSONALIZATION_EXPLAIN="personalize_explain",e.PERSONALIZATION_START="personalize_start",e.PERSONALIZATION_UPDATE="personalize_update",e.PERSONALIZATION_FORCED_DELETE="personalize_forced_delete",e.SEARCH_DOC="search_document",e.SELF_HELP_SEARCH="self_help_search",e.SUMMARIZE="summarize",e.COPILOT_POWERPOINT_SUMMARY="copilotpowerpointsummary",e.COPILOT_POWERPOINT_SPEAKER_NOTES="pptcopilotspeakernotes",e.COPILOT_POWERPOINT_TRANSLATION="translate_presentation",e.TRANSFORM_CONTENT="transform_content",e.COPILOT_USER_PROFILE_LAMBDA="CopilotUserProfileWorkflowLambda",e.IMAGE_CHAT="image-chat",e.UNKNOWN="Unknown"}(D||(D={})),function(e){e.Processing="Processing",e.Success="Success",e.Failed="Failed"}(L||(L={})),function(e){e[e.IMAGE_INVALID=0]="IMAGE_INVALID",e[e.DISMISSED_ARGUMENTS=1]="DISMISSED_ARGUMENTS"}(R||(R={})),function(e){e.ParseSummaryError="ParseSummaryError",e.TooLargeContentToSummarizeError="TooLargeContentToSummarizeError",e.SummaryNoActionItemsIdentified="SummaryNoActionItemsIdentified",e.ODSLServerErrorMessage="ODSLServerErrorMessage",e.AddSlideBlocked="ADD_SLIDE_BLOCKED",e.RequireDeleteIntentResponse="RequireDeleteIntentResponse",e.UnsupportedAction_Undo="UnsupportedAction_Undo",e.UnsupportedAction_Icon="UnsupportedAction_Icon",e.UnsupportedAction_ImageOutOfScope="UnsupportedAction_ImageOutOfScope",e.ErrorFetchingImages="ErrorFetchingImages",e.PowerPointALServerError="PowerPointALServerError",e.SummaryErrorRequestTimedOut="SummaryErrorRequestTimedOut",e.SummaryUnsupportedSummaryError="SummaryUnsupportedSummaryError",e.CommandNotSupported="CommandNotSupported",e.UnexpectedVersionErrorMessage="UnexpectedVersionErrorMessage",e.StopGeneratingResponseMessage="StopGeneratingResponseMessage",e.UserCancelledExecutionMessage="UserCancelledExecutionMessage",e.ActionOnlySupportedInRibbonMessage="ActionOnlySupportedInRibbonMessage",e.ServerErrorMessage="ServerErrorMessage",e.ResponseDelayedOrTimedOut="ResponseDelayedOrTimedOut",e.ChatHistoryHydrationError="ChatHistoryHydrationError",e.StorytellerFailureMessage="StorytellerFailureMessage",e.DocumentUrlEmptyError="DocumentUrlEmptyError",e.ErrorSlideAlreadyAnimated="ErrorSlideAlreadyAnimated",e.SketchToImageError="SketchToImageError"}(F||(F={})),function(e){e.TRIGGERING_VISUALS_FLOW="TRIGGERING_VISUALS_FLOW",e.GRAPH_API_SUCCEED="GRAPH_API_SUCCEED",e.THUMBNAILS_DOWNLOADED="THUMBNAILS_DOWNLOADED",e.VD_GENERATION_ONGOING="VD_GENERATION_ONGOING",e.VD_GENERATION_COMPLETED="VD_GENERATION_COMPLETED",e.SUMMARY_SIGNAL_TRIGGERED="SUMMARY_SIGNAL_TRIGGERED",e.VISUAL_SUMMARY_GENERATING="VISUAL_SUMMARY_GENERATING",e.VISUAL_SUMMARY_FIRST_STREAMING_CHUNK="VISUAL_SUMMARY_FIRST_STREAMING_CHUNK",e.VISUAL_SUMMARY_GENERATED="VISUAL_SUMMARY_GENERATED",e.VISUAL_DESCRIPTION_FAILURE="VISUAL_DESCRIPTION_FAILURE",e.THUMBNAIL_API_FAILURE="THUMBNAIL_API_FAILURE",e.SUMMARY_SIGNAL_NOT_TRIGGERED="SUMMARY_SIGNAL_NOT_TRIGGERED",e.GRAPH_API_FAILED="GRAPH_API_FAILED",e.NO_THUMBNAILS_FOUND="NO_THUMBNAILS_FOUND",e.VISUAL_SUMMARY_GENERATION_FAILED="VISUAL_SUMMARY_GENERATION_FAILED"}(M||(M={})),function(e){e[e.PPE=0]="PPE",e[e.Prod=1]="Prod",e[e.GCC=2]="GCC",e[e.GCCHigh=3]="GCCHigh",e[e.DOD=4]="DOD"}(B||(B={})),function(e){e.DropDownCard="DropDownCard",e.LoaderCard="LoaderCard",e.TranslatedPPTCard="TranslatedPPTCard",e.TranslateFullDeckWarningCard="TranslateFullDeckWarningCard",e.LargeTextualContent="LargeTextualContent",e.DraftModeSuccessCard="DraftModeSuccessCard",e.TextMessageCard="TextMessageCard"}(U||(U={})),function(e){e.ACSTranslationServiceError="ACSTranslationServiceError",e.MediaContentParsingError="MediaContentParsingError",e.MediaContentRehydrationError="MediaContentRehydrationError",e.TranslatedPresentationDraftOpeningError="TranslatedPresentationDraftOpeningError",e.TimeoutError="TimeoutError",e.TranslatedPPTODSPUploadError="TranslatedPPTODSPUploadError",e.CharacterLimitExceeded="CharacterLimitExceeded",e.TooMuchTextualContent="TooMuchTextualContent",e.SensitivityLabelSettingError="SensitivityLabelSettingError",e.InvalidHandoffMessageReceived="InvalidHandoffMessageReceived",e.UnknownError="UnknownError"}(z||(z={})),function(e){e.Add="Add",e.Update="Update",e.Delete="Delete"}(H||(H={}))},33969:(e,t,n)=>{"use strict";n.d(t,{Jv:()=>f,zw:()=>b,Xo:()=>g,Wo:()=>C,uB:()=>S,k7:()=>y,ng:()=>h,SU:()=>m,Lx:()=>v,do:()=>p});var r=n(20570),o=n(11912),i=n(7182),a=n(44698),s=n(95969);function l(e,t,n){return l=(0,a.E)()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&(0,s.Z)(o,n.prototype),o},l.apply(null,arguments)}var c=n(75965);function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return l(e,arguments,(0,c.r)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,s.Z)(r,e)},u(e)}var d=n(99243),p=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),f=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),h=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),g=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),m=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),y=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),v=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),S=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),C=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error)),b=function(e){(0,i._)(n,e);var t=(0,d._)(n);function n(e){var i;return(0,o._)(this,n),i=t.call(this,e),Object.setPrototypeOf((0,r._)(i),n.prototype),i}return n}(u(Error))},81274:(e,t,n)=>{"use strict";n.d(t,{$1:()=>v,CQ:()=>f,Dy:()=>h,MD:()=>b,ND:()=>C,PD:()=>S,cA:()=>w,oe:()=>T,vV:()=>E});var r=n(90813),o=n(81092),i=n(93275),a=n(18758),s=n(2061),l=n(72218),c=n(32060),u=n(12542),d=n(18384),p=n(55564);function f(){return[{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptMenuItemCreatePresentationFromHVCV2:l.tDG,commandCategory:i.m.CreatePresentationFrom,isCiq:!0},{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptMenuItemCreatePresentationAboutHVCV2:l.acE,commandCategory:i.m.CreatePresentationAbout},{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptMenuItemAddSlideHVCV2:l.mvw,commandCategory:i.m.AddSlide},{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptGuideMenuItemOrganizePresentation:l.Cxb,commandCategory:i.m.Organize},{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptMenuItemAddImageHVCV2:l.U1n,commandCategory:i.m.AddImage},{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptGuideMenuItemAddAgendaSlide:l.hSJ,commandCategory:i.m.Agenda},{data:(0,s.Csj)()?PowerpointCopilotStrings.PromptMenuItemAnimate:l.l$l,commandCategory:i.m.Animate}]}var h=function(){return(0,s.Csj)()?PowerpointCopilotStrings.HVCV2CommandingErrorCardMessage:l.I_0};function g(e){var t=[],n="",r=0,o=e().replace(/{|}/g,""),i=!0,a=!1,s=void 0;try{for(var l,c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;if("("===u||"["===u)n.trim().length>0&&t.push(n.trim()),n="",r++;else{if(r>0){")"!==u&&"]"!==u||r--;continue}0===r&&(n+=u)}}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return n.trim().length>0&&t.push(n.trim()),t}function m(e){var t=function(e){var t={createPresentationFrom:i.m.CreatePresentationFrom,createFromFile:i.m.CreatePresentationFrom,createPresentationAbout:i.m.CreatePresentationAbout,createPresentationAboutContoso:i.m.CreatePresentationAbout,createPresentationConsumer:i.m.CreatePresentationAbout,addSlideWithFAQ:i.m.AddSlide,addSlideAbout:i.m.AddSlide,organizePresentation:i.m.Organize,addImage:i.m.AddImage,addAnImage:i.m.AddImage};return Object.keys(e).map((function(n){var r=t[n]||i.m.NotACommand;return{promptItemAPI:e[n],commandCategory:r}}))}(e),n=null==t?void 0:t.filter((function(e){return e.commandCategory!==i.m.NotACommand}));return null==n?void 0:n.map((function(e){return{hvcPromptList:g(e.promptItemAPI),hvcCategory:e.commandCategory}}))}var y=null;function v(e){if(y)return y;try{var t=(0,o._)(m(l.lhA)).concat((0,o._)(m(l.UeP)),(0,o._)(f().filter((function(e){return e.commandCategory!==i.m.NotACommand})).map((function(e){return{hvcPromptList:g((function(){return e.data})),hvcCategory:e.commandCategory}}))));return(t=t.filter((function(e,t,n){return t===n.findIndex((function(t){return JSON.stringify(t.hvcPromptList)===JSON.stringify(e.hvcPromptList)}))&&0!==e.hvcPromptList.length}))).length>0&&(y=t),t}catch(t){var n;y=null,(0,a.cY)("Error in getFilteredHVCPromptItems:",t),null==e||e.sendErrorTelemetry((0,d.pN)((n={},(0,r._)(n,u.IC.ErrorMessage,"Error parsing high value commanding prompt items, ".concat(t.message)),(0,r._)(n,u.IC.ErrorCategory,c.S2.Error),n)))}return[]}function S(e){try{return e.reduce((function(e,t){return e[t.hvcPromptList.join("").toLocaleLowerCase()]=t.hvcCategory,e}),{})}catch(e){(0,a.cY)("Error in getHVCPromptToCategoryMap:",e)}return{}}function C(e){try{return e.map((function(e){return{tokenPhrases:e.hvcPromptList}}))}catch(e){(0,a.cY)("Error in getHVCPromptStringsAPIs:",e)}return[]}var b=function(e,t){var n=e.toLocaleLowerCase();return t&&t[n]?t[n]:i.m.NotACommand},E=function(e,t){var n=function(e,t){var n,r=t.find((function(t){return t.tokenPhrases.every((function(t){return e.includes(t)}))}));return null!==(n=null==r?void 0:r.tokenPhrases)&&void 0!==n?n:[]}(e,t);return n.reduce((function(e,t){return e+t}),"")},T=function(e){var t=e.map((function(e){var t=e.tokenPhrases.join("");return{concatenatedString:t,length:t.length,tokenList:e}}));return t.sort((function(e,t){return e.concatenatedString.startsWith(t.concatenatedString)?-1:t.concatenatedString.startsWith(e.concatenatedString)?1:e.concatenatedString<t.concatenatedString?-1:e.concatenatedString>t.concatenatedString?1:e.length-t.length})),t.map((function(e){return e.tokenList}))},w=function(){return(0,p.bw)(p.WT.IsCommandingScopeAppChatV2Enabled)&&(0,p.PA)(p.IY.IsCommandingScopeAppChatV2EnabledCG)}},43277:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var r=n(11912),o=n(91165),i=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"GetHostAppContentLaguage",value:function(){return Office.context.contentLanguage}},{key:"GetHostAppDisplayLanguage",value:function(){return Office.context.displayLanguage}},{key:"GetHostAppPlatform",value:function(){return Office.context.diagnostics.platform.toString().toUpperCase()}},{key:"isWin32Platform",value:function(){return"PC"===e.GetHostAppPlatform()}},{key:"isWebPlatform",value:function(){return Office.context.platform===Office.PlatformType.OfficeOnline}},{key:"isMacPlatform",value:function(){return Office.context.platform===Office.PlatformType.Mac}},{key:"isIOSPlatform",value:function(){return Office.context.platform===Office.PlatformType.iOS}},{key:"getDocumentUrlAsync",value:function(){return new Promise((function(e){Office.context.document.getFilePropertiesAsync((function(t){e(t.value.url)}))}))}}]),e}()},40389:(e,t,n)=>{"use strict";n.d(t,{OK:()=>s,Ok:()=>a,dD:()=>l});var r=n(80664),o=n(72241),i=n(58651);function a(){switch(i.log("Platform is - "+Office.context.platform),Office.context.platform){case Office.PlatformType.iOS:(0,r.j_)(o.Y.IOS);break;case Office.PlatformType.Mac:(0,r.j_)(o.Y.MACOS);break;default:(0,r.j_)(o.Y.web)}}var s=function(){return Office.context.platform===Office.PlatformType.iOS||Office.context.platform===Office.PlatformType.Mac},l=function(){return Office.context.platform===Office.PlatformType.iOS}},39041:(e,t,n)=>{"use strict";n.d(t,{CY:()=>I,DP:()=>D,JT:()=>T,Px:()=>A,Pz:()=>x,QV:()=>P,Qc:()=>k,WM:()=>E,_r:()=>w,gZ:()=>N,hX:()=>y,jw:()=>v,pe:()=>_,ue:()=>S,uk:()=>m});var r=n(43032),o=n(79490),i=n(72218),a=n(43277),s=n(18758),l=n(2061),c=n(81789),u=n(39726),d=n(14213),p=n(44121),f=n(65817),h=n(71822),g=n(98483);function m(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function y(e){return null==e}function v(e){return""===e}function S(e,t,n){return C.apply(this,arguments)}function C(){return(C=(0,r._)((function(e,t,n){var r,i,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:i=0,o.label=1;case 1:if(!(i<t))return[3,8];o.label=2;case 2:return o.trys.push([2,6,,7]),i>0?[4,m(n)]:[3,4];case 3:o.sent(),o.label=4;case 4:return[4,e(i)];case 5:return[2,o.sent()];case 6:return a=o.sent(),r=a,[3,7];case 7:return i++,[3,1];case 8:throw r}}))}))).apply(this,arguments)}var b,E=function(e){return e.replace(/\\u([\da-fA-F]{4})|\\b|\\n|\\r|\\t|\\'|\\"/g,(function(e,t){switch(e){case"\\u"+t:return String.fromCharCode(parseInt(t,16));case"\\b":return"\b";case"\\n":case"\\r":return"\r";case"\\t":return"\t";case"\\'":return"'";case'\\"':return'"';default:return""}}))},T=function(e,t){return e.replace("%s",t)},w=function(e){return!!a.i.GetHostAppDisplayLanguage().startsWith(e)},I=(b=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){return(0,s.cY)("Link clicked: "+e),window.open(e),[2]}))})),function(e){return b.apply(this,arguments)}),P=function(){return window.location.href.split("/")[4]};function _(){return i.UzE+i.RFL[a.i.GetHostAppPlatform()]}function A(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(" ")}var k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,l.Csj)()&&null!=e?e:t},x=function(e,t,n){var r=new Intl.DisplayNames([Office.context.displayLanguage],{type:"language"}),o=new Intl.DisplayNames(["en"],{type:"language"}),i=r.of(e),a=o.of(e);if(i&&a)return n===t&&(i=a),T(null!=t?t:"",i.toLocaleLowerCase(e))};function N(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}var O=function(){var e=(0,r._)((function(e){var t,n,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return[4,fetch(e)];case 1:if(!(t=o.sent())||t&&!t.ok)throw n="toDataUrl: Could not fetch image at ".concat(e),(0,s.cY)(n),new Error(n);o.label=2;case 2:return o.trys.push([2,4,,5]),[4,t.blob()];case 3:return r=o.sent(),[2,new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result.toString())},n.onerror=function(){return t()},n.readAsDataURL(r)}))];case 4:throw o.sent(),i="toDataUrl: Could not get base64 encoding of image at ".concat(e),(0,s.cY)(i),new Error(i);case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,r._)((function(e){var t,n,i,a,l,m,y,v,S;return(0,o.__generator)(this,(function(C){switch(C.label){case 0:(0,s.cY)("Data received for image insert",e),C.label=1;case 1:if(C.trys.push([1,7,,8]),t=d.K.getInstance(),c.R.getInstance().getState()!==u.Nj.IDLE)return(0,s.cY)("Adaptive card image insertion triggered while in a non-idle execution state"),[2];c.R.getInstance().setState(u.Nj.EXECUTING),n=new Date,t.setScenarioName(p.Cu.InsertImageAdaptiveCard),t.setStartTime(n.toISOString()),i={status:u.rI.FAILED},C.label=2;case 2:return C.trys.push([2,5,,6]),(0,s.cY)("Inserting Image from Adaptive card"),a=[],l={},m={scenarioName:t.getScenarioName(),featureName:t.getFeatureName(),subFeatureName:t.getSubFeatureName(),capability:t.getCapability(),startTime:t.getStartTime(),entryPoint:"Chat",correlationId:(0,g.A)(),uniqueActionId:(0,g.A)(),timeToODSLMS:-1,timeODSLToJOfcMS:-1},l.scenarioOptions=JSON.stringify(m),[4,O(e.url)];case 3:return y=C.sent(),[4,PowerPoint.run(function(){var t=(0,r._)((function(t){var n,r,c;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return n={url:y,description:e.altText,altText:e.altText,license:"",pac:""},[4,(0,h.R)({context:t,slides:a,imageData:n})];case 1:return r=o.sent(),c=[r],[4,(0,f.Rf)(t,c,l)];case 2:return i=o.sent(),(0,s.cY)("Log result : ",JSON.stringify(i)),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 4:return C.sent(),[3,6];case 5:return v=C.sent(),(0,s.cY)("Execute failed:"+JSON.stringify(v)),i={status:u.rI.FAILED,error:u.Re.JOFC_EXCEPTION},[3,6];case 6:return t.resetData(),c.R.getInstance().setState(u.Nj.IDLE),[3,8];case 7:return S=C.sent(),(0,s.cY)("Error inserting image in canvas",S),[3,8];case 8:return[2]}}))}));return function(t){return e.apply(this,arguments)}}()},52174:(e,t,n)=>{"use strict";n.d(t,{b:()=>s,r:()=>a});var r=n(39726),o=n(34045),i=n(72218),a=function(){return function(e,t){for(var n=e.split(".").map(Number),r=t.split(".").map(Number),o=0;o<Math.max(n.length,r.length);o++){var i=n[o]||0,a=r[o]||0;if(i>a)return 1;if(i<a)return-1}return 0}(o.Vv.getSettingAsString(o.zj.PPTJsonCmdAPIVersion),i.g_x)>=0};var s=function(e){switch(e){case r.Re.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING:return r.e0.OrganizeStructuredPresentation;case r.Re.CREATE_PRESENTATION_BLOCKED_ON_WARNING:return r.e0.CreateNewPresentationFromExisting;case r.Re.LAUNCH_NB_TO_CREATE_PRESENTATION:return r.e0.LaunchNBToCreatePresentation;default:return r.e0.None}}},83226:(e,t,n)=>{"use strict";e.exports=n.p+"assets/mic-permission-dialog-ppt.svg"},76249:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{z:()=>r})},86216:(e,t,n)=>{"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{g:()=>r})},20570:(e,t,n)=>{"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{_:()=>r,a:()=>r})},11912:(e,t,n)=>{"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{_:()=>r})},91165:(e,t,n)=>{"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,{_:()=>o})},99243:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var r=n(75965),o=n(44698),i=n(20570);function a(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?(0,i.a)(e):t;var n}function s(e){var t=(0,o.E)();return function(){var n,o=(0,r.r)(e);if(t){var i=(0,r.r)(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return a(this,n)}}},90813:(e,t,n)=>{"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{_:()=>r,t:()=>r})},75965:(e,t,n)=>{"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{_:()=>r,r:()=>r})},7182:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var r=n(95969);function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&(0,r.Z)(e,t)}},74292:(e,t,n)=>{"use strict";function r(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}n.d(t,{_:()=>r})},44698:(e,t,n)=>{"use strict";function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{E:()=>r})},38840:(e,t,n)=>{"use strict";function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{g:()=>r})},47245:(e,t,n)=>{"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{x:()=>r})},57835:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var r=n(90813);function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){(0,r.t)(e,t,n[t])}))}return e}},61838:(e,t,n)=>{"use strict";function r(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}n.d(t,{_:()=>r})},95969:(e,t,n)=>{"use strict";function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:()=>r})},42652:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var r=n(86216);var o=n(47245),i=n(6464);function a(e,t){return(0,r.g)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||(0,i.U)(e,t)||(0,o.x)()}},60697:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var r=n(86216),o=n(38840),i=n(47245),a=n(6464);function s(e){return(0,r.g)(e)||(0,o.g)(e)||(0,a.U)(e)||(0,i.x)()}},81092:(e,t,n)=>{"use strict";n.d(t,{_:()=>a});var r=n(76249);var o=n(38840);var i=n(6464);function a(e){return function(e){if(Array.isArray(e))return(0,r.z)(e)}(e)||(0,o.g)(e)||(0,i.U)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6464:(e,t,n)=>{"use strict";n.d(t,{U:()=>o});var r=n(76249);function o(e,t){if(e){if("string"==typeof e)return(0,r.z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.z)(e,t):void 0}}},3110:(e,t,n)=>{"use strict";n.r(t),n.d(t,{JsonPatchError:()=>m,_areEquals:()=>_,applyOperation:()=>E,applyPatch:()=>T,applyReducer:()=>w,compare:()=>R,deepClone:()=>u,default:()=>F,escapePathComponent:()=>p,generate:()=>D,getValueByPointer:()=>b,observe:()=>O,unescapePathComponent:()=>f,unobserve:()=>N,validate:()=>P,validator:()=>I});var r={};n.r(r),n.d(r,{JsonPatchError:()=>y,_areEquals:()=>_,applyOperation:()=>E,applyPatch:()=>T,applyReducer:()=>w,deepClone:()=>v,getValueByPointer:()=>b,validate:()=>P,validator:()=>I});var o={};n.r(o),n.d(o,{compare:()=>R,generate:()=>D,observe:()=>O,unobserve:()=>N});var i,a=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=Object.prototype.hasOwnProperty;function l(e,t){return s.call(e,t)}function c(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var o in e)l(e,o)&&r.push(o);return r}function u(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function d(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function p(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function f(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function h(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(h(e[t]))return!0}else if("object"==typeof e)for(var r=c(e),o=r.length,i=0;i<o;i++)if(h(e[r[i]]))return!0;return!1}function g(e,t){var n=[e];for(var r in t){var o="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==o&&n.push(r+": "+o)}return n.join("\n")}var m=function(e){function t(t,n,r,o,i){var a=this.constructor,s=e.call(this,g(t,{name:n,index:r,operation:o,tree:i}))||this;return s.name=n,s.index=r,s.operation=o,s.tree=i,Object.setPrototypeOf(s,a.prototype),s.message=g(t,{name:n,index:r,operation:o,tree:i}),s}return a(t,e),t}(Error),y=m,v=u,S={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=b(n,this.path);r&&(r=u(r));var o=E(n,{op:"remove",path:this.from}).removed;return E(n,{op:"add",path:this.path,value:o}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=b(n,this.from);return E(n,{op:"add",path:this.path,value:u(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:_(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},C={add:function(e,t,n){return d(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:S.move,copy:S.copy,test:S.test,_get:S._get};function b(e,t){if(""==t)return e;var n={op:"_get",path:t};return E(e,n),n.value}function E(e,t,n,r,o,i){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=!0),void 0===i&&(i=0),n&&("function"==typeof n?n(t,0,e,t.path):I(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=b(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=_(e,t.value),!1===a.test)throw new y("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return a}r||(e=u(e));var s=(t.path||"").split("/"),l=e,c=1,p=s.length,h=void 0,g=void 0,m=void 0;for(m="function"==typeof n?n:I;;){if((g=s[c])&&-1!=g.indexOf("~")&&(g=f(g)),o&&("__proto__"==g||"prototype"==g&&c>0&&"constructor"==s[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===h&&(void 0===l[g]?h=s.slice(0,c).join("/"):c==p-1&&(h=t.path),void 0!==h&&m(t,0,e,h)),c++,Array.isArray(l)){if("-"===g)g=l.length;else{if(n&&!d(g))throw new y("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);d(g)&&(g=~~g)}if(c>=p){if(n&&"add"===t.op&&g>l.length)throw new y("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(a=C[t.op].call(t,l,g,e)).test)throw new y("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a}}else if(c>=p){if(!1===(a=S[t.op].call(t,l,g,e)).test)throw new y("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a}if(l=l[g],n&&c<p&&(!l||"object"!=typeof l))throw new y("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}function T(e,t,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=!0),n&&!Array.isArray(t))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=u(e));for(var i=new Array(t.length),a=0,s=t.length;a<s;a++)i[a]=E(e,t[a],n,!0,o,a),e=i[a].newDocument;return i.newDocument=e,i}function w(e,t,n){var r=E(e,t);if(!1===r.test)throw new y("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function I(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new y("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!S[e.op])throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new y("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new y('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new y("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&h(e.value))throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var o=e.path.split("/").length,i=r.split("/").length;if(o!==i+1&&o!==i)throw new y("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new y("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=P([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new y("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function P(e,t,n){try{if(!Array.isArray(e))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)T(u(t),u(e),n||!0);else{n=n||I;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(e){if(e instanceof y)return e;throw e}}function _(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,o,i=Array.isArray(e),a=Array.isArray(t);if(i&&a){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!_(e[n],t[n]))return!1;return!0}if(i!=a)return!1;var s=Object.keys(e);if((r=s.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!_(e[o=s[n]],t[o]))return!1;return!0}return e!=e&&t!=t}var A=new WeakMap,k=function(e){this.observers=new Map,this.obj=e},x=function(e,t){this.callback=e,this.observer=t};function N(e,t){t.unobserve()}function O(e,t){var n,r=function(e){return A.get(e)}(e);if(r){var o=function(e,t){return e.observers.get(t)}(r,t);n=o&&o.observer}else r=new k(e),A.set(e,r);if(n)return n;if(n={},r.value=u(e),t){n.callback=t,n.next=null;var i=function(){D(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(i)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=e,n.unobserve=function(){D(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new x(t,n)),n}function D(e,t){void 0===t&&(t=!1);var n=A.get(e.object);L(n.value,e.object,e.patches,"",t),e.patches.length&&T(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function L(e,t,n,r,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=c(t),a=c(e),s=!1,d=a.length-1;d>=0;d--){var f=e[g=a[d]];if(!l(t,g)||void 0===t[g]&&void 0!==f&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&n.push({op:"test",path:r+"/"+p(g),value:u(f)}),n.push({op:"remove",path:r+"/"+p(g)}),s=!0):(o&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var h=t[g];"object"==typeof f&&null!=f&&"object"==typeof h&&null!=h&&Array.isArray(f)===Array.isArray(h)?L(f,h,n,r+"/"+p(g),o):f!==h&&(o&&n.push({op:"test",path:r+"/"+p(g),value:u(f)}),n.push({op:"replace",path:r+"/"+p(g),value:u(h)}))}}if(s||i.length!=a.length)for(d=0;d<i.length;d++){var g;l(e,g=i[d])||void 0===t[g]||n.push({op:"add",path:r+"/"+p(g),value:u(t[g])})}}}function R(e,t,n){void 0===n&&(n=!1);var r=[];return L(e,t,r,"",n),r}const F=Object.assign({},r,o,{JsonPatchError:m,deepClone:u,escapePathComponent:p,unescapePathComponent:f})}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return i[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=i,e=[],s.O=(t,n,r,o)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,r,o]=e[u],a=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,o<i&&(i=o));if(a){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);s.r(o);var i={};t=t||[null,n({}),n([]),n(n)];for(var a=2&r&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>(({62:"vendors~sr-latn-rs-ui-strings-json",96:"vendors~fi-fi-ui-strings-json",214:"vendors~mk-mk-ui-strings-json",227:"officeaicopilotchatstrings_sv",269:"vendors~sl-si-ui-strings-json",280:"vendors~uk-ua-ui-strings-json",373:"officeaicopilotchatstrings_te",449:"officeaicopilotchatstrings_ur",526:"augloop",622:"vendors~lv-lv-ui-strings-json",626:"vendors~ca-es-ui-strings-json",640:"officeaicopilotchatstrings_ms",643:"vendors~ko-kr-ui-strings-json",673:"officeaicopilotchatstrings_fr-ca",697:"vendors~ar-sa-ui-strings-json",717:"vendors~auth-msal-browser",787:"vendors~sv-se-ui-strings-json",811:"officeaicopilotchatstrings_pa-in",827:"officeaicopilotchatstrings_ca-es-valencia",935:"officeaicopilotchatstrings_ga-ie",1032:"officeaicopilotchatstrings_sd-arab-pk",1034:"sccserviceciq",1039:"officeaicopilotchatstrings_vi",1093:"vendors~gl-es-ui-strings-json",1103:"officeaicopilotchatstrings_zu-za",1182:"vendors~bs-latn-ba-ui-strings-json",1226:"officeaicopilotchatstrings_sw",1285:"vendors~ug-cn-ui-strings-json",1312:"officeaicopilotchatstrings_sr-cyrl-ba",1361:"officeaicopilotchatstrings_ta",1386:"vendors~en-us-ui-strings-json",1414:"vendors~fr-fr-ui-strings-json",1426:"vendors~sk-sk-ui-strings-json",1440:"vendors~it-it-ui-strings-json",1511:"office-iss",1565:"vendors~sccservicevoiceaugloop",1634:"vendors~lo-la-ui-strings-json",1642:"vendors~pl-pl-ui-strings-json",1668:"officeaicopilotchatstrings_quz-pe",1751:"officeaicopilotchatstrings_ru",1757:"ReviewerAgent",1758:"vendors~fr-ca-ui-strings-json",1864:"vendors~ta-in-ui-strings-json",1893:"vendors~cy-gb-ui-strings-json",1950:"officeaicopilotchatstrings_eu",2019:"vendors~nn-no-ui-strings-json",2054:"vendors~gd-gb-ui-strings-json",2119:"vendors~cs-cz-ui-strings-json",2163:"officeaicopilotchatstrings_zh-hans",2337:"officeaicopilotchatstrings_da",2401:"vendors~sq-al-ui-strings-json",2700:"vendors~pa-in-ui-strings-json",2793:"officeaicopilotchatstrings_gd-gb",2820:"vendors~inlinecreationhvcapp",2871:"vendors~nb-no-ui-strings-json",2899:"officeaicopilotchatstrings_mt-mt",2933:"officeaicopilotchatstrings_de",2935:"officeaicopilotchatstrings_ml",3005:"officeaicopilotchatstrings_hi",3036:"officeaicopilotchatstrings_sq",3047:"officeaicopilotchatstrings_sr",3049:"officeaicopilotchatstrings_pt-pt",3071:"officeaicopilotchatstrings_el",3073:"officeaicopilotchatstrings_no",3106:"vendors~lt-lt-ui-strings-json",3124:"vendors~az-latn-az-ui-strings-json",3146:"vendors~fa-ir-ui-strings-json",3151:"vendors~zh-tw-ui-strings-json",3181:"lazyloadeddesigner",3327:"vendors~sr-cyrl-ba-ui-strings-json",3388:"vendors~te-in-ui-strings-json",3431:"officeaicopilotchatstrings_lt",3449:"officeaicopilotchatstrings_mr",3457:"officeaicopilotchatstrings_hu",3494:"vendors~hr-hr-ui-strings-json",3536:"officeaicopilotchatstrings_bn-in",3554:"vendors~nl-nl-ui-strings-json",3561:"officeaicopilotchatstrings_sl",3592:"vendors~ga-ie-ui-strings-json",3601:"officeaicopilotchatstrings_he",3624:"vendors~hu-hu-ui-strings-json",3637:"vendors~ja-jp-ui-strings-json",3670:"officeaicopilotchatstrings_si-lk",3674:"vendors~ml-in-ui-strings-json",3718:"vendors~es-es-ui-strings-json",3790:"vendors~ur-pk-ui-strings-json",3912:"officeaicopilotchatstrings_mk",3936:"vendors~bg-bg-ui-strings-json",3987:"vendors~bn-in-ui-strings-json",4016:"officeaicopilotchatstrings_pt",4121:"officeaicopilotchatstrings_af",4123:"officeaicopilotchatstrings_ja",4135:"vendors~hy-am-ui-strings-json",4156:"officeaicopilotchatstrings_ca",4328:"vendors~ms-my-ui-strings-json",4388:"vendors~uz-latn-uz-ui-strings-json",4445:"officeaicopilotchatstrings_hy",4499:"officeaicopilotchatstrings_it",4569:"people-link-plugin",4692:"officeaicopilotchatstrings_cy",4775:"officeaicopilotchatstrings_be-by",4786:"vendors~af-za-ui-strings-json",4858:"officeaicopilotchatstrings_en-us",4972:"officeaicopilotchatstrings_zh-hant",5016:"vendors~podcastui",5099:"vendors~file-link-plugin",5136:"officeaicopilotchatstrings_th",5202:"vendors~th-th-ui-strings-json",5203:"officeaicopilotchatstrings_kn",5214:"officeaicopilotchatstrings_kk",5273:"officeaicopilotchatstrings_en-gb",5431:"officeaicopilotchatstrings_fa",5501:"officeaicopilotchatstrings_ar",5575:"vendors~am-et-ui-strings-json",5610:"officeaicopilotchatstrings_tr",5612:"officeaicopilotchatstrings_nn-no",5650:"vendors~ka-ge-ui-strings-json",5663:"officeaicopilotchatstrings_fi",5664:"officeaicopilotchatstrings_uk",5717:"vendors~et-ee-ui-strings-json",5756:"vendors~kok-in-ui-strings-json",5812:"officeaicopilotchatstrings_gu",5821:"officeaicopilotchatstrings_kok",5882:"officeaicopilotchatstrings_nl",5905:"vendors~sr-cyrl-rs-ui-strings-json",5939:"officeaicopilotchatstrings_id",5943:"officeaicopilotchatstrings_mi-nz",6008:"editor",6030:"vendors~or-in-ui-strings-json",6102:"vendors~pt-br-ui-strings-json",6121:"officeaicopilotchatstrings_prs",6193:"officeaicopilotchatstrings_fil",6202:"officeaicopilotchatstrings_ko",6223:"vendors~vi-vn-ui-strings-json",6343:"officeaicopilotchatstrings_et",6385:"vendors~lb-lu-ui-strings-json",6470:"officeaicopilotchatstrings_ug-cn",6480:"vendors~ro-ro-ui-strings-json",6746:"officeaicopilotchatstrings_sr-cyrl",6759:"dialog-modal",6814:"vendors~kn-in-ui-strings-json",6852:"vendors~mr-in-ui-strings-json",6862:"officeaicopilotchatstrings_hr",6869:"vendors~tt-ru-ui-strings-json",6932:"officeaicopilotchatstrings_km-kh",6966:"officeaicopilotchatstrings_sk",7033:"officeaicopilotchatstrings_uz",7055:"officeaicopilotchatstrings_az-latn-az",7130:"vendors~pt-pt-ui-strings-json",7153:"officeaicopilotchatstrings_bs-latn-ba",7193:"vendors~sccserviceciq",7288:"officeaicopilotchatstrings_pl",7320:"officeaicopilotchatstrings_es",7358:"vendors~copilotchatdisplay",7392:"vendors~ru-ru-ui-strings-json",7410:"vendors~ReviewerAgent",7420:"officeaicopilotchatstrings_tt",7490:"officeaicopilotchatstrings_lb-lu",7536:"vendors~id-id-ui-strings-json",7587:"vendors~quz-pe-ui-strings-json",7590:"vendors~he-il-ui-strings-json",7628:"officeaicopilotchatstrings_fr",7676:"vendors~hi-in-ui-strings-json",7876:"vendors~eu-es-ui-strings-json",7965:"officeaicopilotchatstrings_ro",7999:"officeaicopilotchatstrings_bn-bd",8021:"officeaicopilotchatstrings_bg",8063:"officeaicopilotchatstrings_ha-latn-ng",8088:"vendors~ca-es-valencia-ui-strings-json",8108:"vendors~el-gr-ui-strings-json",8224:"officeaicopilotchatstrings_as-in",8287:"vendors~gu-in-ui-strings-json",8294:"vendors~is-is-ui-strings-json",8409:"vendors~spfx-react-component",8499:"vendors~km-kh-ui-strings-json",8542:"vendors~da-dk-ui-strings-json",8543:"vendors~kk-kz-ui-strings-json",8582:"officeaicopilotchatstrings_ne-np",8656:"vendors~mt-mt-ui-strings-json",8762:"officeaicopilotchatstrings_am",8767:"officeaicopilotchatstrings_mn-mn",8830:"officeaicopilotchatstrings_es-mx",8892:"officeaicopilotchatstrings_is",8908:"vendors~mi-nz-ui-strings-json",9005:"officeaicopilotchatstrings_lo-la",9203:"officeaicopilotchatstrings_or",9206:"officeaicopilotchatstrings_lv",9269:"vendors~es-mx-ui-strings-json",9412:"vendors~lazyloadeddesigner",9452:"officeaicopilotchatstrings_ky",9537:"vendors~ne-np-ui-strings-json",9638:"vendors~en-gb-ui-strings-json",9669:"officeaicopilotchatstrings_gl",9675:"vendors~zh-cn-ui-strings-json",9693:"officeaicopilotchatstrings_tk-tm",9761:"vendors~fil-ph-ui-strings-json",9832:"vendors~de-de-ui-strings-json",9918:"officeaicopilotchatstrings_cs",9926:"vendors~tr-tr-ui-strings-json",9983:"vendors~as-in-ui-strings-json",9988:"officeaicopilotchatstrings_ka"}[e]||e)+".js"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="TypeScriptModule:",s.l=(e,t,n,i)=>{if(r[e])r[e].push(t);else{var a,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==o+n){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",o+n),a.src=e),r[e]=[t];var p=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var o=r[e];if(delete r[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(n))),t)return t(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=1926,(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={1926:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,a,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var u=l(s)}for(t&&t(n);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var l=s.O(void 0,[3062,9037,3341],(()=>s(99838)));l=s.O(l),TypeScriptModule=l})();
//# sourceMappingURL=taskpane.js.map