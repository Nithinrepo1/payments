"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[7193],{48384:(e,i,t)=>{t.r(i),t.d(i,{EditorServiceImplementation:()=>z});var n,a,r,l,o=t(79490),u=t(99614),d=t(32856);!function(e){e.ResponseReceived="ResponseReceived",e.ResultsRendered="ResultsRendered",e.SearchEntityClicked="SearchEntityClicked",e.SearchEntityActions="SearchEntityActions",e.ClientLayout="ClientLayout",e.EntityActionTaken="EntityActionTaken",e.ChevronClicked="ChevronClicked",e.SearchActions="SearchActions",e.ClientDataSource="ClientDataSource"}(n||(n={})),function(e){e.CopyLink="CopyLink",e.SendCopy="SendCopy",e.Share="Share",e.Download="Download",e.Unsubscribe="Unsubscribe"}(a||(a={})),function(e){e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right"}(r||(r={})),function(e){e.SearchBoxFocus="SearchBoxFocus",e.SearchDone="searchdone",e.ExitSearch="ExitSearch",e.VerticalClicked="VerticalClicked",e.PaginationClicked="PaginationClicked",e.ExpandLinkClicked="ExpandLinkClicked",e.BackButtonClicked="BackButtonClicked",e.UpScopeSearch="UpScopeSearch",e.ScopePaneClicked="ScopePaneClicked",e.ScopeModified="ScopeModified",e.BreadcrumbClicked="BreadcrumbClicked",e.InsertContact="InsertContact",e.RemoveContact="RemoveContact",e.DismissClicked="DismissClicked",e.FilterPaneClicked="FilterPaneClicked",e.FilterModified="FilterModified",e.ClearFilters="ClearFilters",e.ScrollBarMoved="ScrollBarMoved",e.ExpandHiddenItems="ExpandHiddenItems",e.PeoplePillRemoved="PeoplePillRemoved",e.PrivacyInformationClicked="PrivacyInformationClicked",e.PrivacyInformationLinkClicked="PrivacyInformationLinkClicked",e.PeopleScopeVerticalClicked="PeopleScopeVerticalClicked",e.EmailSent="EmailSent",e.EmailCancelled="EmailCancelled",e.MeetingCreated="MeetingCreated",e.MeetingCancelled="MeetingCancelled",e.CrossEntryPointNavigationDone="CrossEntryPointNavigationDone",e.NonSearchedEntityClicked="NonSearchedEntityClicked",e.ClearSearchText="ClearSearchText",e.ScopeHeaderClicked="ScopeHeaderClicked",e.RemoveItem="RemoveItem",e.AccountSwitched="AccountSwitched",e.ChevronClicked="ChevronClicked"}(l||(l={}));const s=[{id:"818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",name:"Frequentlyconfusedwords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4ee98de6-ea40-48db-ae36-ca82fc8473f7",name:"AcademicDegrees",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"5cb7fc16-cd78-449c-86d9-5d047be21ac4",name:"AdjectiveUsedinsteadofAdverb",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8778ba37-ca99-4ab9-a964-55abd18f7eba",name:"AdverbinsteadofAdjective",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f57c12d6-03e4-4f48-9b7b-f95802a6c669",name:"AgreementwithinNounPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a127d2c9-2faf-491b-8d6a-e9b027fec098",name:"AnAnd Confusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"63e72d3d-62d7-4e73-8d66-c137d8841121",name:"Capitalization",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"79d4a5c7-11c0-4be1-8d3c-c322f9941323",name:"Capitalizationof March and May",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"822bb35e-0608-466e-a771-a315fcf95821",name:"CapitalizationofPersonalTitles",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",name:"CommaafterGreetings",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"9d62fd01-8804-4485-a5f0-257131e4f6aa",name:"CommabeforeQuotations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",name:"CommaMissingafterIntroductoryPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"72e604b0-a185-413b-bd45-ad555288c746",name:"CommaSplice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e3994139-ff36-44da-ae72-500b70d9b80f",name:"CommawithConjunctiveAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e805847a-9050-45de-b767-f48ed68ad848",name:"CommawithConjunction",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"0c576af1-54af-4acb-8065-4616bb73820d",name:"CommasaroundDescriptiveClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"413425d5-5a64-4ea6-84df-aae06c596439",name:"CommonlyConfusedPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",name:"CommonlyConfusedWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"02c15397-df70-4f00-aa4d-7269e6d4e712",name:"ComparativeUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"25714ab1-190b-4ef3-8d3d-e45bfd591c45",name:"CorrelativeConjunctionMismatch",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8cf6f68e-f693-4e6f-b253-5092cd19b9e2",name:"DateFormatting",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"03522a58-4044-4bab-b796-0630ae2ad00a",name:"EmbarrassingWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"84275a90-df79-4b9e-a208-9ec8b5e59622",name:"Hyphenation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"708198dd-ecbf-44fb-a428-ff2bc10e4d17",name:"IncorrectAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",name:"IncorrectNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7d9778b3-89e4-4974-b38f-086d39b32c21",name:"IncorrectNumberEnding",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ca649e0f-48de-4f54-b687-2bda07e40728",name:"IncorrectPronounCase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"631a3185-4bb6-4d1a-b275-f16c7f5dcc3a",name:"IncorrectReflexivePronounUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"296f8f65-02fb-45a7-b4ab-5dc137edc563",name:"IncorrectUseof That",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:1,CritiqueTag:0},{id:"0941dabb-e993-4a10-8a92-70a95ca5389d",name:"IncorrectVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7c2ff4d7-41a9-4310-949b-863a0dfa4257",name:"IncorrectVerbFormafterAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6dbfae4c-9818-4dec-a769-2595168927f2",name:"IndefiniteArticle",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e006985e-33eb-42e1-9196-1333c4ecad9c",name:"IndirectQuestions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4b1218e3-a124-4d36-b993-eb9ad6e80ddd",name:"MisheardPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2700d569-bd6f-4806-9bf1-49abd64d9fd3",name:"MissingComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",name:"ModalConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"875c19b3-5769-4e9b-8d32-9c9dd4d74c13",name:"MultipleModals",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",name:"PossessiveandPluralForms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"3f2eda01-e8a5-4ed9-9494-6de566bc5333",name:"Punctuation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"76e3d0aa-bb80-461e-89c3-9fa640190616",name:"QuestionMarkMissing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"12d7f72e-e53e-4b27-b1ed-4ee115f54994",name:"RedundantColon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b956d579-6d99-4278-8b7d-e281ab8c576b",name:"RedundantCommabeforeComplementClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2d08dbe8-c11b-4190-a428-9a2c0a37bd68",name:"RedundantCommabeforeObject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aa78ec66-2078-42bf-84f5-c241eb53a531",name:"RedundantCommafollowingSubject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"1346c3e5-5bf2-4176-ad29-9e25d88da4c6",name:"RedundantQuestionMark",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e8c121e0-1ecd-4e88-8694-2fb17acb519d",name:"RepeatedAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39d0acfc-05aa-4d25-ae88-32ebcee3bbeb",name:"SemicolonUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6d1d8c3d-62d5-45d1-b850-d8a98a24964b",name:"Spacing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"d7746119-e7e5-4e97-9979-bcd2114f9fe9",name:"Subject-VerbAgreement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"27783a58-c44f-4778-9856-36d9eab63693",name:"TooManyDeterminers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a7927082-e6bb-4061-a134-3051e5969222",name:"UnnecessaryHyphen",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"26bdc172-02a8-4f0a-8ec0-6049906f1f7c",name:"UseofPlainVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39e466f1-6ebd-4ada-a7db-e0cc74048f1e",name:"UseoftheWord Lack",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",name:"UseofWillandWould",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"352579fc-6ae6-4eb1-8d3b-895ab239714e",name:"VerbUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",name:"WhoWhomConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6a0e1c97-430e-4d83-889d-8c4fea315a83",name:"WordSplit",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"c4301606-9bc2-4389-bb1a-c08370627172",name:"AdverbPlacement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"0da5de95-d496-4d23-8f93-693ef6592ae6",name:"DoubleNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3be567ea-4951-4e59-bdab-6b99c790f28d",name:"Jargon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ab60d6cb-98df-4b9d-9a69-f6c12d8099fe",name:"PassiveVoice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"8aa31cca-af48-4d21-8fb5-a0f314fab6ce",name:"PassiveVoicewithUnknownActor",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"28c70cb7-e358-4b32-8756-725aa7af1d69",name:"SentenceStructure",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"7f6d979b-d0de-4367-aa9d-589b5134b7a6",name:"SimplerWording",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"79dd443b-0b94-45a1-90ad-02807565324d",name:"SplitInfinitives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"007c6707-7280-4c94-b469-8caee77d8313",name:"UseofEuphemisms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"e24fd819-cc17-4be9-afec-dd103055198e",name:"ConjunctionOveruse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"71384165-a4b9-45a7-9a73-7d0830c8c426",name:"Nominalizations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",name:"Wordiness",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"6bdf8d88-1ed5-4506-9b5f-a17e7f8c2a48",name:"WordsExpressingUncertainty",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"67718619-a6b1-43ec-af18-1c48bbc27acd",name:"ColloquialVerbPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"f4aa4a0a-f81a-41ac-b710-de4a60b99282",name:"Contractions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6d60d9da-9e38-4d1e-bfc5-05a04120eef9",name:"InformalLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d124712e-74ac-43eb-9bb6-373b2398f448",name:"OpinionMarkers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"aa4e5a53-9b76-49fe-8bf1-2f35fd0d091d",name:"Slang",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"c68edc3b-9340-4b68-9d18-268bb82e2d94",name:"SubjunctiveMood",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"932288af-0af4-43f8-94af-206e06e43fce",name:"AgeBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"dd116cd6-2adb-4be9-809f-7b8de7cace91",name:"EthnicSlurs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6cd66cca-c2c2-48cf-8353-9791327aaea1",name:"GenderBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"e77bbc2a-f896-4012-a711-6041ea1e8964",name:"Gender-SpecificLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"36869146-3cc3-40fd-ae3c-bb30f6988335",name:"RacialBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"cbac7e3d-9058-442c-9f24-78fe164069b4",name:"SexualOrientationBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"3f2e6b47-fc23-4f99-ad25-1758e7f179b6",name:"CommawithAdverbials",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"55aa25a5-e28a-4f22-8410-34a4df965e30",name:"OxfordComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3fd9c226-3925-4855-ba1e-49eb9ee46d24",name:"UnnecessaryComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"5b75d94a-856d-461b-9bb4-879f4502b4c3",name:"PunctuationRequiredWithQuotes",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","inside","outside"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"a44ac718-8213-42ff-87a5-1e5d6592c352",name:"SpaceBetweenSentences",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","onespace","twospaces"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"487d4873-3793-45a7-b881-7f18cac3f16c",name:"AvoidFirstPersonReferences",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ac135410-a38a-4398-a759-ac6e2e5f779c",name:"SuperfluousExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2b188727-cb05-4a4b-86a2-b35073e34c0b",name:"UnsuitableExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"348f4088-d907-41dc-9007-3cecf9837b61",name:"VagueQuantifiers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d07b8e0e-37e7-476e-99e6-477fd9f1b394",name:"VagueVerbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"923cc720-1624-4973-946a-30a0c6ec4163",name:"ClichÃ©s",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3ae3b3e9-6e99-4113-9962-b52b7fe539f3",name:"Region-SpecificWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"9725ea09-959d-48b9-9678-1844896547b3",name:"VagueAdjectives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"64213f24-0943-4585-8dd4-ee4f26b47a37",name:"VagueorUnnecessaryAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2e33dc1f-0106-4182-b52a-ad94e479fb9a",name:"WeakVerbs",defaultCritiqueValue:0}];t(42410);var c=t(18620),C=t(80233),p=t(93443),y=t(61898),g=t(72295),q=t(78126),f=t(66382);const T="https://dogfood.augloop.svc.cloud.microsoft",m=15,b="@",v=[{id:"spelling",name:"Spelling"},{id:"grammar",name:"Grammar"}],I=[{id:"headingDetection",name:"Heading Detection"},{id:"entityDetection",name:"People / Date Recognition"},{id:"taskRecognition",name:"Task Recognition"},{id:"textToTable",name:"Table Suggestions"},{id:"addressDetection",name:"Address Detection"},{id:"satoriEntity",name:"Entity Suggestion"}],h=[{id:"clarity",name:"Clarity"},{id:"conciseness",name:"Conciseness"},{id:"formality",name:"Formality"},{id:"inclusiveness",name:"Inclusiveness"},{id:"puncConventions",name:"Punctuation Conventions"},{id:"sensitiveGpRef",name:"Sensitive Geopolitical References"},{id:"vocabulary",name:"Vocabulary"}],S=[f.b.MessageExtension,f.b.PowerPlatform,f.b.OpenAIPlugin];var E,V;!function(e){e.DOGFOOD="dogfood",e.SDFV2="sdfv2",e.MSIT="msit",e.MICROSOFT="microsoft",e.WW="ww"}(E||(E={})),function(e){e.DOGFOOD="Dogfood",e.MICROSOFT="Microsoft",e.PRODUCTION="Production"}(V||(V={}));var P=t(90512);function A(e,i,t){return{Type:"Entity",Name:null,ReferenceId:e,EntityType:i,LayoutType:null,Position:t,ResultsView:null}}function B(e){switch(null==e?void 0:e.toLowerCase()){case E.DOGFOOD:case E.SDFV2:return V.DOGFOOD;case E.MSIT:case E.MICROSOFT:return V.MICROSOFT;case E.WW:default:return V.PRODUCTION}}function M(e,i){if(void 0===e)return T;switch(null==e?void 0:e.toLowerCase()){case E.DOGFOOD:case E.SDFV2:return T;case E.MSIT:case E.MICROSOFT:case E.WW:default:return(null==i?void 0:i.enableLegacyAugLoopEndpoint)?"https://augloop.office.com":"https://augloop.svc.cloud.microsoft"}}const D=e=>{const i=[];return(null==e?void 0:e.enableAppGptsInCiq)&&i.push({Term:{AppType:f.b.GPT}}),(null==e?void 0:e.enableAppMessageExtensionsInCiq)&&i.push({Term:{AppType:f.b.MessageExtension}}),(null==e?void 0:e.enableAppTypeBInCiq)&&i.push({Term:{AppType:f.b.OpenAIPlugin}}),(null==e?void 0:e.enableAppPPInCiq)&&i.push({Term:{AppType:f.b.PowerPlatform}}),(null==e?void 0:e.enableAppPluginsInCiq)&&S.forEach((e=>{i.push({Term:{AppType:e}})})),i},O=(e,i)=>{const t=!!((null==i?void 0:i.enableAppGptsInCiq)||(null==i?void 0:i.enableAppPluginsInCiq)||(null==i?void 0:i.enableAppPPInCiq)||(null==i?void 0:i.enableAppTypeBInCiq)||(null==i?void 0:i.enableAppMessageExtensionsInCiq));let n=[...e,u.c.App,u.c.Topic];n=n.filter((e=>e===u.c.App?t:e!==u.c.Topic||((null==i?void 0:i.enableTopicCIQ)||(null==i?void 0:i.enableTopicECC))));const a=[];return n.forEach((e=>{e===u.c.App&&t?a.push({enabled:!0,entityType:u.c.App,maxResults:m,customProps:[{name:"Filter",value:JSON.stringify({Or:D(i)})}]}):e===u.c.People?a.push({enabled:!0,entityType:u.c.People,maxResults:m,customProps:[{name:"Filter",value:JSON.stringify({And:[{Or:[{Term:{PeopleType:P.E6.Person}},{Term:{PeopleType:P.E6.Other}}]},{Or:[{Term:{PeopleSubtype:P.O2.OrganizationUser}},{Term:{PeopleSubtype:P.O2.Guest}},{Term:{PeopleSubtype:P.O2.OrganizationContact}}]}]})}]}):e===u.c.File?a.push({enabled:!0,entityType:e,maxResults:(null==i?void 0:i.enableSingleEntityStyle)?void 0:m}):(e===u.c.Topic&&((null==i?void 0:i.enableTopicCIQ)||null==i||i.enableTopicECC),a.push({enabled:!0,entityType:e,maxResults:m}))})),a.map((e=>(null==i?void 0:i.enableECCNudge)?Object.assign(Object.assign({},e),{queryPrefix:[e.entityType===u.c.App?b:"/"]}):e)),a},F=(e,i)=>i||"DogFood"===e?C.G.Lab:"GCC"===e?C.G.GCC:"GCCHigh"===e?C.G.GCCHigh:"DOD"===e?C.G.USDoD:C.G.Prod,k=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-enable-meeting-banner"],x=(e,i)=>{const t=[...k];return(null==i?void 0:i.enableChatCIQ)&&t.push("mc-editor-oa-groupchat-ecc"),(null==i?void 0:i.enableEmailCIQ)&&t.push("mc-editor-oa-email-ecc"),((null==i?void 0:i.enableTopicECC)||(null==i?void 0:i.enableTopicCIQ))&&t.push("vivatopics"),((null==i?void 0:i.enableAppGptsInCiq)||(null==i?void 0:i.enableAppPluginsInCiq)||(null==i?void 0:i.enableAppPPInCiq)||(null==i?void 0:i.enableAppTypeBInCiq)||(null==i?void 0:i.enableAppMessageExtensionsInCiq))&&t.push("mc-editor-oa-app-ecc"),e&&t.push("mc-editor-oa-client-ecc"),(null==i?void 0:i.enableResponsiveExpandedECC)&&t.push("mc-editor-expanded-ecc-responsive"),(null==i?void 0:i.enableNewFileTidbits)&&t.push("mc-editor-enable-files-new-tidbits"),(null==i?void 0:i.enableSearchBar)&&(t.push("mc-editor-enable-searchbar"),t.push("mc-editor-attachbutton-searchbar-position")),(null==i?void 0:i.enableECCNudge)&&(t.push("mc-editor-oa-nudge"),t.push("mc-editor-oa-nudge-all-entities")),(null==i?void 0:i.enableGradientPlaceholder)&&t.push("immersive-bizchat-enable-gradient-placeholder"),(null==i?void 0:i.enableExperimentalPredictionTimeout)&&t.push("mc-editor-oa-experimental-prediction-timeout"),(null==i?void 0:i.enableAttachmentHint)&&t.push("mc-editor-enable-attachment-hint"),(null==i?void 0:i.enableShowCIQAfterRemoveAttachment)&&t.push("mc-editor-show-menu-after-remove-attachment"),t},R=(e,i,t,n,a)=>(0,o.__awaiter)(void 0,void 0,void 0,(function*(){return yield(0,c.Rc)((({augLoopAuthTokenCallback:e,getProfilePictureUrl:i,substrateAuthTokenCallback:t,appId:n,appName:a,appPlatform:r,appScenario:l,sessionId:o,isDogfoodEnvironment:u,appEnvironment:d,accountType:s,puid:c,tenantId:f,accountRing:T,locale:b,oaResultsTimeout:S,sourceName:E,browseThisComputerSettings:P,enableZeroQueryHintText:A,customizedEmptyECCSuggestionsString:D,onOpenGptStorefront:k,moreCopilotsStringOverride:R},w,N)=>{const U=`${(0,y.l)({environment:"Prod"})}${g.Tx}`,L=!!(null==N?void 0:N.enableHybridWorkflow),j=!!((null==N?void 0:N.enableAppGptsInCiq)||(null==N?void 0:N.enableAppPluginsInCiq)||(null==N?void 0:N.enableAppPPInCiq)||(null==N?void 0:N.enableAppTypeBInCiq)||(null==N?void 0:N.enableAppMessageExtensionsInCiq));return{appId:n,showSquiggleTooltip:!0,enableStealthSquiggles:!0,showOptionsButton:!0,flightsToTrack:x(L,N),tonalFreEnabledForUser:!0,useFluentV9:null==N?void 0:N.enableECCForMobile,oaSettings:{enableECCForMobileDevice:{enabled:!!(null==N?void 0:N.enableECCForMobile),mainAxisOverride:195},preventAllTabBackfill:null==N?void 0:N.enablePreventAllTabBackfill,isContextualCardEnabled:!0,mockResults:!1,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:A,bestMatchConfig:{enabled:!0,maxResults:m},getProfilePictureUrl:i,scopesConfig:{enabled:!0,maxResults:m,enableAutomaticScoping:!0},enableOaClient:L,entitiesEnabled:O(w,N),e2eMetric:!0,updateResultsTimeout:S||5e3,customizedEmptyECCSuggestionsString:D,scopeToAppGptInlineSuggestion:j},hostMetadata:{appName:a,appPlatform:r,appScenario:l,releaseAudienceGroup:T?B(T):u?V.DOGFOOD:V.PRODUCTION,sessionId:null!=o?o:(0,q.A)()},isTextPredictionEnabled:!0,isFeedbackEnabled:!0,serviceSettings:Object.assign({nudge:{enabled:!!(null==N?void 0:N.enableECCNudge),enableInlineNudge:!0,insertionCharacter:"/",automaticallyScope:!0},hybridAugloop:{enabled:L,enableGraphSearchLocal:L,enablePeriodicUpdates:null==N?void 0:N.enableHybridWorkflowPeriodicUpdates,wasmConfig:{binaryPath:U,scriptPath:U,disableModuleCache:"owa"!=(null==E?void 0:E.toLowerCase())&&"owahub"!=(null==E?void 0:E.toLocaleLowerCase())}},predictions:{enabled:!0,domInsertion:!0,allowMiddleOfSentencePredictions:!1},browseThisComputerSettings:P},j?{appGptConfig:{enableAppGpt:!0,onClickExploreMoreCopilots:k,moreCopilotsStringOverride:R}}:{}),defaultLocale:b||"en-US",controlIconSetName:"FabricMDL2Icons",synonymsEndPoint:C.i.Prod,editorEndPoint:F(d,u),userId:{puid:c||"testUserId",tenantId:f||"testTenantId",userDisplayName:"",identityProvider:"MSA"===s?0:1},licenseType:p.G_.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:3,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,newLineSentenceSeparatorEnabled:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:M(T,N),augLoopAuthTokenCallback:e,substrateAuthTokenCallback:t},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,wordCountDetectorEnabled:!0,enabledCorrectionCategories:v,enabledRefinementCategories:h,enabledEnhancementCategories:I,enableStopCheckingForThis:!0}})(e,i,t),a,n)})),w={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},N={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}};var U=t(58651);let L=!1;const j=(e,i)=>{L&&(null==i?U.log("EditorService:",e):U.log("EditorService:",e,i))},G=(e,i)=>{null==i?U.error("EditorService:",e):U.error("EditorService:",e,i)},Q=(e,i)=>{null==i?U.warn("EditorService:",e):U.warn("EditorService:",e,i)};class z{constructor(){this.editorProps=null,this.editorClient=null,this.currentQuery=null,this.currentTab=null}static getInstance(){return z.instance||(z.instance=new z),z.instance}updateFlyoutStartTime(e=!1){this.flyoutStartTime=e?void 0:Date.now()}getSuggestionUpdateLatencyForFlyout(){if(!this.flyoutStartTime)return;const e=(Date.now()-this.flyoutStartTime)/1e3;return this.updateFlyoutStartTime(!0),e}getEditorProps(){return this.editorProps?this.editorProps:void 0}getEditorClient(){return this.editorClient}getCurrentQuery(){return this.currentQuery}getCurrentTab(){return this.currentTab}getCurrentInvocationSource(){return this.currentInvocationSource}getScenario(){return this.scenario}bootstrapEditor(e){return(0,o.__awaiter)(this,void 0,void 0,(function*(){var i,t,n,a,r,l,u,d,c,C,{eccQueryCharacter:p,targetElement:y,onEntitySelected:g,featureFlags:q,alSession:f,telemetrySink:T,entitiesEnabled:m,telemetryLogger:b}=e,v=(0,o.__rest)(e,["eccQueryCharacter","targetElement","onEntitySelected","featureFlags","alSession","telemetrySink","entitiesEnabled","telemetryLogger"]);C=function(e){var i,t;return null!==(i=null==e?void 0:e.isDogfoodEnvironment)&&void 0!==i?i:(null===(t=null==e?void 0:e.accountRing)||void 0===t?void 0:t.toLowerCase())===E.DOGFOOD}(v),L=C,j("BootstrapEditor Called"),this.telemetryLogger=b,null==b||b.logEvent({eventId:"EditorBootstrapTriggered"});const I=yield R(v,m,q,f,T);var h,S,V;this.editorClient=I,this.scenario=(h=v.appName,S=v.appPlatform,V=null!==(i=v.appScenario)&&void 0!==i?i:"",`${h}.${S}.${V}`),j("EditorClient Created"),null==b||b.logEvent({eventId:"EditorClientCreated",editorSessionId:null===(t=I.hostSettings.hostMetadata)||void 0===t?void 0:t.sessionId,metaData:JSON.stringify({enabledEntities:null===(a=null===(n=I.hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===a?void 0:a.entitiesEnabled})}),I.onError=(e,i)=>{G("EditorClient onError called",e),null==b||b.logEvent({eventId:(null==I?void 0:I.isEditorClientShutdown)?"ESDKShutdownError":"ESDKInitializeError",errorMessage:JSON.stringify(e)})},I.setAvailableCritiqueTypes(s);try{localStorage.removeItem("featureFlags");const e={value:'{"enableVisibilityTracker":"True","enableSimplifiedHost":"True","enableParagraphUpdates":"True","enableOrchestratorEmitAll":"True","enablePhraseTextUnitClientSide":"True","enableParagraphDeltas":"True","enableParagraphDeltasVerboseLogging":"True","enableParagraphDeltasEmptyInitialTile":"True","enableRequiredServiceDataOnly":"True","enableExperimentalECCQueryDetectionFixes":"True","enableLoggingModulesAndBindings":"False"}',lastUpdated:(new Date).getTime(),manualOverride:!0};localStorage.setItem("featureFlags",JSON.stringify(e))}catch(e){G("Error setting localStorage feature flags",e),null==b||b.logEvent({eventId:"EditorClientLocalStorageFFOverrideError",editorSessionId:null===(r=I.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId,errorMessage:String(e)})}return yield I.initializeSDK(),yield I.initializeUX(document),j("EditorClient Initialized"),this.updateEditorClientCorrelationID(null===(l=v.getClientCorrelationId)||void 0===l?void 0:l.call(v)),null==b||b.logEvent({eventId:"EditorClientInitialized",editorSessionId:null===(u=I.hostSettings.hostMetadata)||void 0===u?void 0:u.sessionId,metaData:JSON.stringify({enabledEntities:null===(c=null===(d=I.hostSettings)||void 0===d?void 0:d.oaSettings)||void 0===c?void 0:c.entitiesEnabled})}),I}))}enableInlineSuggestionsMenu({targetElement:e,eccQueryCharacter:i,entitiesEnabled:t,enableExpandedECC:n,onEntitySelected:a,onItemSelected:r,onClose:l,onOpen:o,telemetryLogger:s,featureFlags:c,theme:C=d.SV.light,suggestionTitleAndSubTitle:p,inlineSuggestionsStyles:y}){var g,q,f,T;j("EnableInlineSuggestionsMenu Called");const m=this.editorClient;if(null==m||m.attach(e),!(null==c?void 0:c.disableClientConfigQueryCharacterForEditorService))try{this.enableInlineSuggestions({entitiesEnabled:t,eccQueryCharacter:i,enableExpandedECC:n,onEntitySelected:a,onItemSelected:r,onClose:l,onOpen:o,telemetryLogger:s,featureFlags:c,suggestionTitleAndSubTitle:p,inlineSuggestionsStyles:y})}catch(e){G("Error in enableInlineSuggestionsMenu",e),null===(g=this.telemetryLogger)||void 0===g||g.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${i}. Error: `+JSON.stringify(e)})}if((null==c?void 0:c.enableAppGptsInCiq)||(null==c?void 0:c.enableAppPluginsInCiq)||(null==c?void 0:c.enableAppMessageExtensionsInCiq)||(null==c?void 0:c.enableAppPPInCiq)||(null==c?void 0:c.enableAppTypeBInCiq)){const e=[u.c.App],i=b;try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:i,enableExpandedECC:!1,onEntitySelected:a,onItemSelected:r,onClose:l,onOpen:o,telemetryLogger:s,featureFlags:c,suggestionTitleAndSubTitle:p,inlineSuggestionsStyles:y})}catch(e){G("Error in enableInlineSuggestionsMenu",e),null===(q=this.telemetryLogger)||void 0===q||q.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${i}. Error: `+JSON.stringify(e)})}}if(null==c?void 0:c.enableTopicECC){const e=[u.c.Topic],i="#";try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:i,enableExpandedECC:!0,onEntitySelected:a,onItemSelected:r,onClose:l,onOpen:o,telemetryLogger:s,featureFlags:c,suggestionTitleAndSubTitle:p,inlineSuggestionsStyles:y})}catch(e){G("Error in enableInlineSuggestionsMenu",e),null===(f=this.telemetryLogger)||void 0===f||f.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${i}. Error: `+JSON.stringify(e)})}}null==m||m.updateCurrentTheme(C),null===(T=this.telemetryLogger)||void 0===T||T.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${C} in enableInlineSuggestionsMenu`})}disableInlineSuggestionsMenu({eccQueryCharacter:e,featureFlags:i},t){var n,a,r;j("DisableInlineSuggestionsMenu Called");const l=null!=t?t:this.editorClient;if(!(null==i?void 0:i.disableClientConfigQueryCharacterForEditorService))try{null==l||l.disableInlineSuggestionsMenu(e)}catch(i){G("Error in disableInlineSuggestionsMenu",i),null===(n=this.telemetryLogger)||void 0===n||n.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${e}. Error: `+JSON.stringify(i)})}if(null==i?void 0:i.enableTopicECC)try{null==l||l.disableInlineSuggestionsMenu("#")}catch(e){G("Error in disableInlineSuggestionsMenu",e),null===(a=this.telemetryLogger)||void 0===a||a.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:"Error in Disable Menu for ciq char #. Error: "+JSON.stringify(e)})}if((null==i?void 0:i.enableAppGptsInCiq)||(null==i?void 0:i.enableAppPluginsInCiq)||(null==i?void 0:i.enableAppMessageExtensionsInCiq)||(null==i?void 0:i.enableAppPPInCiq)||(null==i?void 0:i.enableAppTypeBInCiq))try{null==l||l.disableInlineSuggestionsMenu(b)}catch(e){G("Error in disableInlineSuggestionsMenu",e),null===(r=this.telemetryLogger)||void 0===r||r.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${b}. Error: `+JSON.stringify(e)})}}destroyEditor(e){var i,t,n;j("destroyEditor called");try{const i=null!=e?e:this.editorClient;!1===(null==i?void 0:i.isEditorClientShutdown)&&(null==i||i.shutDown())}catch(e){G("Error in destroyEditor",e)}null===(i=this.telemetryLogger)||void 0===i||i.logEvent({eventId:"EditorClientDestroyed",editorSessionId:null===(n=null===(t=this.editorClient)||void 0===t?void 0:t.hostSettings.hostMetadata)||void 0===n?void 0:n.sessionId}),this.editorClient=null}setEntityScope(e){if(!this.editorClient)return;const i=((e="")=>{switch(!0){case/file/i.test(e):return u.c.File;case/(people)|(person)/i.test(e):return u.c.People;case/(event)|(meeting)/i.test(e):return u.c.Event;case/chat/i.test(e):return u.c.Chat;case/(message)|(email)/i.test(e):return u.c.Message;case/(topic)/i.test(e):return u.c.Topic;default:return}})(e);if(void 0===i)return void Q(`Invoked setEntityScope with unsupported entity type ${e}`);const t=this.editorClient.exp_getQueryDetection();null==t||t.setCurrentScope({entityType:i},!1)}eccManuallyInitiated(e){if(!this.editorClient)return;const i=this.editorClient.exp_getQueryDetection();null==i||i.setNextDeltaProgramaticallyInserted(e)}notifyTriggeringType(e){if(!this.editorClient)return;const i=e;this.editorClient.notifyMenuTriggeringMethod(i)}updateCurrentTheme(e){var i,t;if(this.editorClient){try{this.editorClient.updateCurrentTheme(e),j("Theme updated for CIQ to ",e)}catch(e){return G("Exception updating theme for CIQ:",e),void(null===(i=this.telemetryLogger)||void 0===i||i.logEvent({eventId:"EditorClientThemeChangedError",errorMessage:e?`${e}`:""}))}null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${e}`})}else Q("updateCurrentTheme, EditorClient not initialized")}setUnsupportedEntities(e){if(!this.editorClient)return;0===e.length&&Q("unSupported enities list is empty");const i=this.editorClient.exp_getQueryDetection();null==i||i.setUnsupportedEntities(e)}updateEditorClientCorrelationID(e){if(!this.editorClient)return;const i=this.editorClient.exp_getQueryDetection(),t=null!=e?e:"";null==i||i.setClientCorrelationId(t)}onItemSelected(e,i,t,a,r,l){var o,s,c;if(j("onItemSelected called Suggestion: ",e),!i)return void Q("ECC injection failed due to undefined queryRange");const C=e;null==r||r.logEvent({eventId:"ECCEntitySelected",editorSessionId:null===(s=null===(o=this.editorClient)||void 0===o?void 0:o.hostSettings.hostMetadata)||void 0===s?void 0:s.sessionId,entityType:e.type,metaData:JSON.stringify({expansionType:this.currentTab,logicalId:C.logicalId,InvocationSource:this.currentInvocationSource,id:C.ReferenceId})}),(null==r?void 0:r.log3sEvent)&&(null==r||r.log3sEvent({eventType:n.SearchEntityActions,localTime:(new Date).toISOString(),logicalId:null!==(c=C.logicalId)&&void 0!==c?c:"",id:C.ReferenceId,scenario:this.scenario,metaData:JSON.stringify({expansionType:this.currentTab,InvocationSource:this.currentInvocationSource})}));const p=((e,i,t)=>{var n,a,r,l,o,s,c,C,p,y,g,q,f;let T,m,b,v,I,h,S;switch(e.type){case u.c.People:{const r=e;if(!(null==r?void 0:r.EmailAddresses)||!r.DisplayName)return Q("People ECC injection failed due to missing EmailAddresses or DisplayName"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.People,message:"People ECC injection failed due to missing EmailAddresses or DisplayName"}));m=r.DisplayName,b=(null==i?void 0:i.enablePeopleQueryAnnotationV2)&&null!==(n=r.Id)&&void 0!==n?n:r.EmailAddresses[0],v="",T={queryAnnotationType:d.in.People,text:m,id:b},h={id:b,referenceId:null!==(a=r.ReferenceId)&&void 0!==a?a:"",displayName:r.DisplayName,emailAddresses:r.EmailAddresses};break}case u.c.File:{const i=e;if(!(null==i?void 0:i.AccessUrl))return Q("File ECC injection failed due to missing AccessUrl"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.File,message:"File ECC injection failed due to missing AccessUrl"}));m=i.FileName,b=null!==(l=null!==(r=i.SpoId)&&void 0!==r?r:i.SpoUniqueId)&&void 0!==l?l:"",v=i.AccessUrl,I=i.FileExtension,T={queryAnnotationType:d.in.File,text:m,id:b},h={id:b,referenceId:null!==(o=i.ReferenceId)&&void 0!==o?o:"",fileName:i.FileName,accessUrl:i.AccessUrl,spoId:b,dateModified:null!==(s=i.DateModified)&&void 0!==s?s:"",lastModifiedDisplayName:null!==(c=i.ModifiedByDisplayName)&&void 0!==c?c:"",fileSize:i.FileSize};break}case u.c.Event:{const i=e;if(!(null==i?void 0:i.OriginalId))return Q("Event ECC injection failed due to missing OriginalId"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.Event,message:"Event ECC injection failed due to missing OriginalId"}));m=i.Subject,b=i.OriginalId,v=null!==(C=i.WebLink)&&void 0!==C?C:"";const n={id:null!==(y=null===(p=i.EventId)||void 0===p?void 0:p.Id)&&void 0!==y?y:""};T={queryAnnotationType:d.in.Event,text:m,id:b},h={id:b,referenceId:null!==(g=i.ReferenceId)&&void 0!==g?g:"",originalId:i.OriginalId,subject:i.Subject,skypeTeamsMeetingUrl:i.SkypeTeamsMeetingUrl,start:i.Start,end:i.End,organizerName:i.OrganizerName,organizerAddress:i.OrganizerAddress,eventId:n,attendees:null===(q=i.Attendees)||void 0===q?void 0:q.map((e=>{var i,t;return{emailAddress:{name:null!==(i=e.EmailAddress.Name)&&void 0!==i?i:"",address:null!==(t=e.EmailAddress.Address)&&void 0!==t?t:""}}}))};break}case u.c.Chat:{const i=e;if(!(null==i?void 0:i.ThreadId))return Q("Chat ECC injection failed due to missing ThreadId"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.Chat,message:"Chat ECC injection failed due to missing ThreadId"}));if(i.Name)m=i.Name;else if(i.ChatMembers){const e=2,t=i.ChatMembers.length-e;let n=i.ChatMembers.slice(0,e).map((e=>e.DisplayName)).join(", ");t>0&&(n+=`, +${t}`),m=n}else m="";b=i.ThreadId,v="",T={queryAnnotationType:d.in.Chat,text:m,id:b};break}case u.c.Message:{const i=e;if(!(null==i?void 0:i.ImmutableId))return Q("Email ECC injection failed due to missing ImmutableId"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.Message,message:"Email ECC injection failed due to missing ImmutableId"}));m=i.Subject,b=null===(f=i.ImmutableId)||void 0===f?void 0:f.Id,v="",T={queryAnnotationType:d.in.Message,text:m,id:b};break}case u.c.Topic:{const i=e;if(!(null==i?void 0:i.TopicId))return Q("Topic ECC injection failed due to missing TopicId"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.Topic,message:"Topic ECC injection failed due to missing TopicId"}));m=i.DisplayName,b=i.TopicId,v=i.Url,T={queryAnnotationType:d.in.Topic,text:m,id:b};break}case u.c.App:if(!(null==e?void 0:e.AppId))return Q("App ECC injection failed due to missing AppId"),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:u.c.App,message:"App ECC injection failed due to missing AppId"}));b=e.AppId,m="",v="",S={appId:e.AppId,collectorId:e.CollectorId,appType:e.AppType,title:e.Title,iconUrl:e.IconAnonymousUrl};break;default:return Q(`onItemSelected called with unsupported suggestion type ${e.type}`),void(null==t||t.logEvent({eventId:"ECCEntityInjectionFailed",entityType:e.type,message:`onItemSelected called with unsupported suggestion type ${e.type}`}))}return{ciqEntityElement:{entityType:e.type,id:b,text:m,url:v,fileExtension:I},annotation:T,rawEntityData:h,atMentionApp:S}})(e,l,r);p&&(this.currentQuery=null,this.currentTab=null,null==a||a(p.ciqEntityElement,p.annotation,i,t,p.rawEntityData,p.atMentionApp))}onOpen(e,i,t){var n,a;this.currentInvocationSource=e.invocationSource?e.invocationSource:e.triggerCharacter,this.updateFlyoutStartTime(),null==i||i.logEvent({eventId:"ECCOpened",editorSessionId:null===(a=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===a?void 0:a.sessionId,metaData:JSON.stringify({expansionSource:this.currentInvocationSource})}),t&&t()}onClose(e,i,t,n){var a,r;j(`onClose, searchResultAccepted: ${e}, persistTime: `,i),null==t||t.logEvent({eventId:"ECCClosed",editorSessionId:null===(r=null===(a=this.editorClient)||void 0===a?void 0:a.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId,metaData:JSON.stringify({selectedEntity:e,openedTime:i})}),n&&n(e,i)}onAction(e,i){var t,n;j("onAction",e),null==i||i.logEvent({eventId:"ECCAction",editorSessionId:null===(n=null===(t=this.editorClient)||void 0===t?void 0:t.hostSettings.hostMetadata)||void 0===n?void 0:n.sessionId,metaData:JSON.stringify({actionId:e})})}onSuggestionsUpdated(e,i,t,a,r,l,o){var d,s,c,C,p,y,g;j("onSuggestionsUpdated",e);let q,f="";if(0===i&&e[0]&&e[0].entities.length>0&&o&&(null==t?void 0:t.entityType)===u.c.App){const t=e[0].entities.filter((e=>{var i;return!(null===(i=null==e?void 0:e.GptIdentifier)||void 0===i?void 0:i.Id.includes("ProjectedDeclarativeAgent"))}));e[0]=Object.assign(Object.assign({},e[0]),{entities:t}),i=t.length>0?0:1}if(0===i&&e[0]&&e[0].entities.length>0){f=null!==(d=e[0].entities[0].logicalId)&&void 0!==d?d:"",this.currentTab=null!==(s=null==t?void 0:t.entityType)&&void 0!==s?s:"All";const i=((e,i)=>{var t,n,a,r,l;let o=null!==(t=e[0].entities[0].logicalId)&&void 0!==t?t:"",u=1;const d=[];if(i)for(const t of e[0].entities){const e=t;o=""!=o?o:null!==(n=e.logicalId)&&void 0!==n?n:"",d.push(A(null!==(a=e.ReferenceId)&&void 0!==a?a:"",i.entityType,u)),u++}else for(const i of e)for(const e of i.entities)if(e.isBestMatch){const i=e;o=""!=o?o:null!==(r=i.logicalId)&&void 0!==r?r:"",d.push(A(null!==(l=i.ReferenceId)&&void 0!==l?l:"",e.entityType,u)),u++}return d})(e,t);if(t)try{q=JSON.stringify({Type:"Group",Name:this.currentTab,ReferenceId:null,EntityType:null,LayoutType:"Vertical",Position:1,ResultsView:i})}catch(e){G("Error in onSuggestionsUpdated",e)}if(r)for(const i of e)i.groupTitle=r.title,i.groupSubtitle=r.subtitle;const o=this.getSuggestionUpdateLatencyForFlyout();null==a||a.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(C=null===(c=this.editorClient)||void 0===c?void 0:c.hostSettings.hostMetadata)||void 0===C?void 0:C.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:f,suggestionCount:e[0].entities.length.toString(),isQueryStringEmpty:""===l?"true":"false",suggestionUpdateLatency:null!=o?o:void 0})}),(null==a?void 0:a.log3sEvent)&&(null==a||a.log3sEvent({localTime:(new Date).toISOString(),eventType:n.ClientLayout,logicalId:f,id:f,scenario:this.scenario,resultsView:q?JSON.stringify(q):void 0,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:f})}))}else if(1===i||3===i){this.currentTab=null!==(p=null==t?void 0:t.entityType)&&void 0!==p?p:"All";const e=this.getSuggestionUpdateLatencyForFlyout();null==a||a.logEvent({eventId:"ECCEmptySuggestionUpdated",editorSessionId:null===(g=null===(y=this.editorClient)||void 0===y?void 0:y.hostSettings.hostMetadata)||void 0===g?void 0:g.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:f,isQueryStringEmpty:""===l?"true":"false",suggestionUpdateLatency:null!=e?e:void 0,status:1===i?"NoResults":"Timeout"})})}}enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:i,enableExpandedECC:t,onEntitySelected:n,onItemSelected:a,onClose:r,onOpen:l,telemetryLogger:u,featureFlags:d,suggestionTitleAndSubTitle:s,inlineSuggestionsStyles:c}){var C;const p=this.editorClient;null==p||p.enableInlineSuggestionsMenu(e,i,a||((e,i,t)=>{this.onItemSelected(e,i,t,n,u,d)}),void 0,void 0,{fitToContent:!0},c||((null==d?void 0:d.enableSingleEntityStyle)?N:w),(e=>{this.onOpen(e,u,l)}),((e,i)=>{this.onClose(e,i,u,r)}),(e=>{this.onAction(e,u)}),void 0,((e,i,t,n,a,r)=>(0,o.__awaiter)(this,void 0,void 0,(function*(){if(!a)return this.onSuggestionsUpdated(e,n,r,u,s,i,null==d?void 0:d.disablePluginsAsDAInFlyout),e}))),(()=>{}),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,t),null==u||u.logEvent({eventId:"EditorClientInlineSuggestionsEnabled",editorSessionId:null===(C=null==p?void 0:p.hostSettings.hostMetadata)||void 0===C?void 0:C.sessionId,metaData:JSON.stringify({eccQueryCharacter:i})})}}}}]);
//# sourceMappingURL=vendors~sccserviceciq.js.map