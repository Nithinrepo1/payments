"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[6008],{8447:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(76729).f)("ISessionContextProvider")},79343:(e,t,i)=>{var n,s,o;function r(e){return e?Object.values(s).find((t=>t===e)):void 0}function a(e){const t=new Set([s.CIQFlag_DateEntityRecognition,s.CIQFlag_PersonEntityRecognition,s.CIQFlag_Location,s.CIQFlag_LocalBusiness,s.CIQFlag_TaskRecognition,s.HeadingDetection,s.CIQFlag_Topic,s.CIQFlag_SatoriEntityRecognition,s.CIQFlag_File,s.CIQFlag_Time]);return!!e&&t.has(e)}i.d(t,{$w:()=>o,L9:()=>s,bx:()=>n,e3:()=>r,oe:()=>a}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(s||(s={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},95523:(e,t,i)=>{if(i.d(t,{OE:()=>a,_K:()=>l,r3:()=>u,z5:()=>c}),2063!=i.j)var n=i(79490);if(2063!=i.j)var s=i(38540);if(2063!=i.j)var o=i(79343);if(2063!=i.j)var r=i(13849);function a(e){const{annotationId:t,typeId:i,traceId:s,priority:a,supportedActions:l,suggestions:d,textInContext:u,start:h,length:g,metadata:p,nodeId:m,tileId:f,categoryTitle:v,isStealth:_,endNode:y,explanationTitle:I,explanationLabel:C,explanation:S,shouldShowMultilingualFre:b,languageId:T,shouldAttemptLanguageDetection:E}=e,N=(0,n.__rest)(e,["annotationId","typeId","traceId","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{annotationId:t}:{}),{typeId:(0,o.e3)(i)}),i?{typeIdRaw:i}:{}),s?{traceId:s}:{}),{priority:a,supportedActions:c(l),suggestions:d.map(r.SR)}),u?{textInContext:u}:{}),{start:h,length:g}),p?{metadata:p}:{}),m?{nodeId:m}:{}),f?{tileId:f}:{}),v?{categoryTitle:v}:{}),_?{isStealth:_}:{}),y?{endNode:y}:{}),I?{explanationTitle:I}:{}),C?{explanationLabel:C}:{}),S?{explanation:S}:{}),b?{shouldShowMultilingualFre:b}:{}),T?{languageId:T}:{}),E?{shouldAttemptLanguageDetection:E}:{}),N)}function l(e){const{annotationId:t,typeIdRaw:i,traceId:s,priority:o,supportedActions:a,suggestions:l,textInContext:c,start:u,length:h,metadata:g,nodeId:p,tileId:m,categoryTitle:f,isStealth:v,endNode:_,explanationTitle:y,explanationLabel:I,explanation:C,shouldShowMultilingualFre:S,languageId:b,shouldAttemptLanguageDetection:T}=e,E=(0,n.__rest)(e,["annotationId","typeIdRaw","traceId","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{annotationId:t}:{}),i?{typeId:i}:{}),s?{traceId:s}:{}),{priority:o,supportedActions:d(a),suggestions:l.map(r.Io)}),c?{textInContext:c}:{}),{start:u,length:h}),g?{metadata:g}:{}),p?{nodeId:p}:{}),m?{tileId:m}:{}),f?{categoryTitle:f}:{}),v?{isStealth:v}:{}),_?{endNode:_}:{}),y?{explanationTitle:y}:{}),I?{explanationLabel:I}:{}),C?{explanation:C}:{}),S?{shouldShowMultilingualFre:S}:{}),b?{languageId:b}:{}),T?{shouldAttemptLanguageDetection:T}:{}),E)}function d(e){let t=0;return e.notificationOnly&&(t|=s.lb.NotificationOnly),e.delete&&(t|=s.lb.Delete),e.ignore&&(t|=s.lb.Ignore),e.ignoreAll&&(t|=s.lb.IgnoreAll),e.ignoreCritiqueType&&(t|=s.lb.IgnoreCritiqueType),e.addToDictionary&&(t|=s.lb.AddToDictionary),e.showDetails&&(t|=s.lb.ShowDetails),t}function c(e){return{notificationOnly:!!(e&s.lb.NotificationOnly),delete:!!(e&s.lb.Delete),ignore:!!(e&s.lb.Ignore),ignoreAll:!!(e&s.lb.IgnoreAll),ignoreCritiqueType:!!(e&s.lb.IgnoreCritiqueType),addToDictionary:!!(e&s.lb.AddToDictionary),showDetails:!!(e&s.lb.ShowDetails)}}function u(e){return"isFlagCritique"in e}},94600:(e,t,i)=>{var n,s,o;i.d(t,{jf:()=>s}),function(e){e[e.Unknown=0]="Unknown",e[e.Title=1]="Title",e[e.Subtitle=2]="Subtitle",e[e.Heading1=3]="Heading1",e[e.Heading2=4]="Heading2",e[e.Heading3=5]="Heading3"}(n||(n={})),function(e){e.Installed="Installed",e.NotInstalled="NotInstalled"}(s||(s={})),function(e){e.Query="Query",e.Action="Action"}(o||(o={}))},71924:(e,t,i)=>{if(i.d(t,{Bb:()=>r,Q0:()=>o,pf:()=>s}),2063!=i.j)var n=i(69811);var s,o;function r(e){return e.deltaType===n.WI.AttributionUpdate&&void 0!==e.attributionData}!function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(s||(s={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(o||(o={}))},13849:(e,t,i)=>{if(i.d(t,{Io:()=>r,SR:()=>o,fO:()=>d,gA:()=>a}),2063!=i.j)var n=i(79490);if(2063!=i.j)var s=i(38540);function o(e){const{text:t,action:i,languages:s,metadataJSON:o,description:r}=e,a=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:d(i),languages:s,metadataJSON:o,description:r},a)}function r(e){const{text:t,action:i,languages:s,metadataJSON:o,description:r}=e,a=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]),{confidenceLevel:d,source:c}=a;return Object.assign({text:t,action:l(i),languages:s,metadataJSON:o,description:r,confidenceLevel:d||0,source:c||0},a)}function a(e){return!(e.changeOnce||e.changeAll||e.autoCorrect||e.readAloud||e.personalizedAutoCorrect)}function l(e){let t=0;return e.changeOnce&&(t|=s.xv.ChangeOnce),e.changeAll&&(t|=s.xv.ChangeAll),e.autoCorrect&&(t|=s.xv.AutoCorrect),e.readAloud&&(t|=s.xv.ReadAloud),e.personalizedAutoCorrect&&(t|=s.xv.PersonalizedAutoCorrect),t}function d(e){return{changeOnce:(e&s.xv.ChangeOnce)===s.xv.ChangeOnce,changeAll:(e&s.xv.ChangeAll)===s.xv.ChangeAll,autoCorrect:(e&s.xv.AutoCorrect)===s.xv.AutoCorrect,readAloud:(e&s.xv.ReadAloud)===s.xv.ReadAloud,personalizedAutoCorrect:(e&s.xv.PersonalizedAutoCorrect)===s.xv.PersonalizedAutoCorrect}}},59433:(e,t,i)=>{i.d(t,{o:()=>n});const n={NumProofingLanguages:"NumProofingLanguages"}},65024:(e,t,i)=>{var n;i.d(t,{N:()=>n}),function(e){e[e.GENERIC=0]="GENERIC",e[e.OFFICE=1]="OFFICE",e[e.SVG=2]="SVG"}(n||(n={}))},2257:(e,t,i)=>{i.d(t,{W:()=>r});var n,s=i(79490),o=i(29906);!function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(n||(n={}));let r=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let i=!0;return t.forEach((t=>{const[n,s]=t.callback(e);i=this.processCallBackResult(i,n,s)})),i}processCallBackResult(e,t,i){return t!==n.NoReaction?e&&t===n.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const i={callback:t,id:this.nextListenerId()};let n=this._callbacks.get(e);return n||(n=[],this._callbacks.set(e,n)),n.push(i),i.id}removeListener(e){e&&this._callbacks.forEach(((t,i,n)=>{if(t){if(-1!==t.findIndex((t=>t.id===e)))return void n.set(i,t.filter((t=>t.id!==e)))}}))}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let i=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){i=!0;break}return void 0===t?i:i&&t}};r=(0,s.__decorate)([(0,o._)()],r)},10219:(e,t,i)=>{i.d(t,{c:()=>n});const n=(0,i(76729).f)("IFeatureFlagsReader")},609:(e,t,i)=>{i.d(t,{F:()=>a});var n=i(79490),s=i(29906),o=i(2257),r=i(98824);let a=class extends o.W{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:r.d2.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};a=(0,n.__decorate)([(0,s._)()],a)},98824:(e,t,i)=>{i.d(t,{In:()=>r,d2:()=>n,kY:()=>s});var n,s,o=i(76729);!function(e){e[e.SettingsClicked=0]="SettingsClicked"}(n||(n={})),function(e){e[e.dropdown=0]="dropdown",e[e.languageDetectionNotificationBar=1]="languageDetectionNotificationBar",e[e.toneRewriteFre=2]="toneRewriteFre",e[e.multilingualFooterFre=3]="multilingualFooterFre",e[e.manageLanguages=4]="manageLanguages"}(s||(s={}));const r=(0,o.f)("IExternalSettingsFeature")},23957:(e,t,i)=>{i.d(t,{FS:()=>s,U1:()=>n,Zp:()=>r});var n,s,o=i(76729);!function(e){e[e.ClientInitialized=0]="ClientInitialized"}(n||(n={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(s||(s={}));const r=(0,o.f)("IRoamingDictionaryFeature")},34899:(e,t,i)=>{i.d(t,{K:()=>d});var n,s=i(79490);!function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.LOAD_ERROR=3]="LOAD_ERROR"}(n||(n={}));var o=i(29906),r=i(83010),a=i(2257),l=i(11804);let d=class extends a.W{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary&&!this.hostSettings.enableV2RoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}setRoamingDictionary(e){this._roamingDictionary=e}isReady(){return!this.check()&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===n.LOADED}processCallBackResult(e,t,i){return this._roamingDictionary=i.roamingDictionary,super.processCallBackResult(e,t,i)}};d=(0,s.__decorate)([(0,o._)(),(0,s.__param)(0,(0,r.W)(l.n))],d)},31294:(e,t,i)=>{i.d(t,{DS:()=>u,KW:()=>h,OV:()=>n,xr:()=>s});var n,s,o=i(79490),r=i(76729),a=i(29906),l=i(83010),d=i(2257),c=i(21683);!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(s||(s={}));const u=(0,r.f)("IShowSynonymsFeature");let h=class extends d.W{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};h=(0,o.__decorate)([(0,a._)(),(0,o.__param)(0,(0,l.W)(c.r))],h)},90736:(e,t,i)=>{i.d(t,{Gv:()=>p,o9:()=>n,tq:()=>g,v$:()=>s});var n,s,o=i(79490),r=i(76729),a=i(29906),l=i(83010),d=i(2257),c=i(10219),u=i(94453),h=i(7405);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(s||(s={}));const g=(0,r.f)("IUnsignedInEditorFeature");let p=class extends d.W{constructor(e,t,i){super(),this._featureFlagsReader=t,this._languageDetector=i,this.enablers=[!0],this.disablers.push(this),this.disablers.push(e)}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce(((e,t)=>{const i=t.split("-");if(i.length>0){const t=i[0];e.add(t)}return e}),new Set).size}};p=(0,o.__decorate)([(0,a._)(),(0,o.__param)(0,(0,l.W)(h.Z)),(0,o.__param)(1,(0,l.W)(c.c)),(0,o.__param)(2,(0,l.W)(u.v))],p)},21683:(e,t,i)=>{i.d(t,{r:()=>d});var n=i(79490),s=i(29906),o=i(83010),r=i(77322),a=i(93443),l=i(13441);let d=class extends l.t{constructor(e){super(e)}checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===a.G_.Subscription}setGracePeriodUntil(e){this._expiry=e}};d=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.e))],d)},7405:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(79490),s=i(77322),o=i(29906),r=i(83010),a=i(13441);let l=class extends a.t{constructor(e){super(e)}checkUserInfo(){return!!this.isLoggedIn}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.e))],l)},19470:(e,t,i)=>{i.d(t,{W:()=>l});var n=i(79490),s=i(29906),o=i(83010),r=i(10219),a=i(67843);let l=class{constructor(e,t){this._featureFlagsReader=e,this._paragraphDeltasEnabled=t}check(){return this._paragraphDeltasEnabled.check()&&this._featureFlagsReader.flags.enableOptimizedRehydration}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.c)),(0,n.__param)(1,(0,o.W)(a.H))],l)},67843:(e,t,i)=>{i.d(t,{H:()=>l});var n=i(79490),s=i(29906),o=i(83010),r=i(10219),a=i(11804);let l=class{constructor(e,t){this._hostSettings=e,this._featureFlagsReader=t}check(){return!!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableParagraphUpdates&&this._featureFlagsReader.flags.enableParagraphDeltas}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(a.n)),(0,n.__param)(1,(0,o.W)(r.c))],l)},13441:(e,t,i)=>{i.d(t,{t:()=>o});var n=i(79490),s=i(29906);let o=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,(e=>(this.setUserInfo(e),e))),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider,this.ageGroup=e.ageGroup,this.ctry=e.ctry),this.isLoggedIn=!!e}};o=(0,n.__decorate)([(0,s._)()],o)},93443:(e,t,i)=>{var n,s,o,r,a,l;i.d(t,{G_:()=>a,P2:()=>l}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(s||(s={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(r||(r={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},77322:(e,t,i)=>{i.d(t,{e:()=>o});var n,s=i(76729);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(n||(n={}));const o=(0,s.f)("IUserInfoStrategy")},58022:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(76729).f)("IUserInfoUpdater")},66717:(e,t,i)=>{i.d(t,{H:()=>o});var n,s=i(76729);!function(e){e[e.Undefined=0]="Undefined",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(n||(n={}));const o=(0,s.f)("IComponentInitializer")},97446:(e,t,i)=>{i.d(t,{S:()=>n});const n=(0,i(76729).f)("IRegistrable")},44621:(e,t,i)=>{i.d(t,{V:()=>n});const n=(0,i(76729).f)("IRegistrar")},61188:(e,t,i)=>{i.d(t,{w:()=>a});var n=i(79490),s=i(29906),o=i(66008),r=i(97446);let a=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){var e;if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();for(const t of this.registrables)await(null===(e=t.servicesInitialized)||void 0===e?void 0:e.call(t));this.shutDownCalled=!1}}shutDown(){if(!this.shutDownCalled){this.shutDownCalled=!0;for(const e of this.registrables)e.shutDown()}}async addRegistrable(e){var t;await e.initialize(),await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e)),this.registrables.push(e)}async recheckRegistrables(e){var t;const i=e.getAll(r.S),n=[];for(const e of i)this.registrables.includes(e)||(await e.initialize(),this.registrables.push(e),n.push(e));for(const e of n)await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e))}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.t)(r.S))],a)},70899:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(76729).f)("ILanguageInfoProvider")},94453:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(76729).f)("IUxLanguageDetector")},5997:(e,t,i)=>{i.d(t,{U:()=>c});var n=i(79490),s=i(61643),o=i(5730);const r=(e,t=!1,i)=>{let n;const r=e.toLocaleLowerCase(),a=s.p[r];if(a&&(n=Array.isArray(a)?{languageId:e,languageName:a[0],isRtl:a[1]}:{languageId:e,languageName:a,isRtl:!1}),!n&&t){const e=o.Y[r];if(e){const t=Array.isArray(e)?e[0]:e,i=Array.isArray(e)?e[1]:void 0,o=s.p[t.toLocaleLowerCase()],r=!!Array.isArray(o)&&o[1],a=Array.isArray(o)?o[0]:o;n={languageId:t,languageName:null!=i?i:a,isRtl:r}}}if(n&&i){const e=n.languageId.toLocaleLowerCase();i.find((t=>t.toLocaleLowerCase()===e))||(n=void 0)}return n},a=e=>{const t=new Map;for(const i of e){if(!i.languageId)continue;const e=r(i.languageId);e&&!t.has(i.languageId)&&t.set(i.languageId,e)}return Array.from(t.values())};var l=i(29906);const d=["af-ZA","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as-IN","az-Latn-AZ","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-CB","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","kok-IN","ko-KR","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","nso-ZA","or-IN","pa-IN","pl-PL","ps-AF","pt-BR","pt-PT","rm-CH","ro-MD","ro-RO","ru-MD","ru-RU","rw-RW","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tn-BW","tn-ZA","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN","wo-SN","xh-ZA","yo-NG","zu-ZA"];let c=class{constructor(){this.bxSupportedLanguages=d.map((e=>({languageId:e})))}getLanguageInfo(e){return r(e,!0,d)}mapToLanguageInfo(e){return a(e)}bxDefaultSupportedLanguages(){return a(this.bxSupportedLanguages)}};c=(0,n.__decorate)([(0,l._)()],c)},68794:(e,t,i)=>{i.d(t,{I:()=>r});var n=i(79490),s=i(19728),o=i(18574);class r{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0)&&(this._codesList.splice(t,1),!0)},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=i,!0},this.moveDown=e=>{const t=this._codesList.indexOf(e);if(t<0||t===this._codesList.length-1)return!1;const i=this._codesList[t+1];return this._codesList[t+1]=this._codesList[t],this._codesList[t]=i,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=i,!0},this._codesList=e,(0,o.Gn)(this)}get count(){var e;return null!==(e=this._codesList.length)&&void 0!==e?e:0}get defaultLanguageCode(){return r.getDefaultLanguageCode(this._codesList)}static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}get codesList(){return this._codesList||[]}}(0,n.__decorate)([s.observable],r.prototype,"_codesList",void 0),(0,n.__decorate)([s.computed],r.prototype,"count",null),(0,n.__decorate)([s.computed],r.prototype,"defaultLanguageCode",null),(0,n.__decorate)([s.computed],r.prototype,"codesList",null)},83626:(e,t,i)=>{i.d(t,{O:()=>o});var n=i(79490),s=i(29906);let o=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};o=(0,n.__decorate)([(0,s._)()],o)},14775:(e,t,i)=>{i.d(t,{K3:()=>n,aP:()=>r,iw:()=>o});var n,s=i(76729);!function(e){e.auto="auto",e.ltr="ltr",e.rtl="rtl"}(n||(n={}));const o=(0,s.f)("ILanguageScriptDirectionDetector"),r=(0,s.f)("ILanguageScriptDirectionDetectorFactory")},96571:(e,t,i)=>{i.d(t,{H:()=>n});const n=(0,i(76729).f)("ILocalizer")},11994:(e,t,i)=>{i.d(t,{k:()=>c});var n=i(79490),s=i(13290),o=i(45242),r=i(10138),a=i(95834),l=i(29906),d=i(83010);let c=class{constructor(e,t){this.logger=e,this.proofingEmitter=t,this.loggerEventName="AggregateEventCount",this.dataToLog={eventCountMap:{},metadata:{locales:[]}}}async initialize(){this.proofingEmitter.on("proofingLanguageChanged",(e=>{this.updateMetadata({locales:e.data.codesList.slice()})}))}incrementEventCount(e,t,i=1){var n,s,o;const r=null!==(n=(o=this.dataToLog.eventCountMap)[e])&&void 0!==n?n:o[e]={};null!==(s=r[t])&&void 0!==s||(r[t]=0),r[t]+=i}shutDown(){this.logger.logEvent(512304030,this.loggerEventName,s.q.Info,void 0,o.o.SamplingPolicy.Measure,this.dataToLog,void 0)}updateMetadata(e){this.dataToLog.metadata=Object.assign(Object.assign({},this.dataToLog.metadata),e)}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.g)),(0,n.__param)(1,(0,d.W)(a.o))],c)},28831:(e,t,i)=>{var n,s;i.d(t,{f:()=>s,n:()=>n}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(n||(n={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(s||(s={}))},22550:(e,t,i)=>{var n;i.d(t,{M:()=>n}),function(e){e.Diagnostics="Diagnostics"}(n||(n={}))},60503:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(76729).f)("IAggregateLogger")},10138:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(76729).f)("ILogger")},52946:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(76729).f)("IOaLogger")},44656:(e,t,i)=>{i.d(t,{C:()=>n});const n=(0,i(76729).f)("ITransportActivity")},34141:(e,t,i)=>{i.d(t,{l:()=>n});const n=(0,i(76729).f)("ITransportLogger")},95111:(e,t,i)=>{i.d(t,{V:()=>f});var n=i(79490),s=i(91513),o=i(29906),r=i(13290),a=i(58651);const l=(e,t,i,n)=>{const s={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:i,data:n};return JSON.stringify(s)};let d=class{async initialize(e){}addCorrelationID(e){a.log(`CorrelationID is: ${e}`)}log(e,t,i,n){this.dispatchLog(null,e,t,i,n)}debug(e,t,i){this.dispatchLog(null,e,r.q.Debug,t,i)}error(e,t,i){this.dispatchLog(null,e,r.q.Error,t,i)}warn(e,t,i){this.dispatchLog(null,e,r.q.Warn,t,i)}info(e,t,i){this.dispatchLog(null,e,r.q.Info,t,i)}logEvent(e,t,i,n,s,o){this.dispatchLog(t,e,i,n,o)}dispatchLog(e,t,i,n,s){switch(i){case r.q.Debug:a.log(l(e,t,n,s));break;case r.q.Error:a.error(l(e,t,n,s));break;case r.q.Info:a.info(l(e,t,n,s));break;case r.q.Warn:a.warn(l(e,t,n,s));break;default:throw new Error("Invalid logging level")}}};d=(0,n.__decorate)([(0,o._)()],d);var c=i(45242),u=i(44656),h=i(34141),g=i(85924),p=i(66008),m=i(83010);let f=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logActivityBase(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logActivityBase(e,void 0,t,i,n)},this.logActivityBase=(e,t,i,n,s)=>{const o=this.getNewActivity(e,c.o.SamplingPolicy.CriticalExperimentation);t&&(null==o||o.dataFields.push((0,g.n)("message",t))),i&&(null==o||o.dataFields.push((0,g.n)("data",JSON.stringify(i)))),n&&(null==o||o.dataFields.push(...n)),o&&(o.success=!0,o.endNow())}}async initialize(e,t,i,n,o){var r;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(r=await(null==e?void 0:e.read(s.l.DebugMode)))&&void 0!==r&&r,this._debugMode&&this._transports.push(new d);for(const s of this._transports)await s.initialize(e,i,n,t,o);this._activityTransport&&await this._activityTransport.initialize(e,i,n,t,o)}finally{this._initializing=!1}this._initialized=!0}}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,i,n){this.logEvent(e,null,t,i,c.o.SamplingPolicy.Measure,n)}info(e,t,i){this.logEvent(e,null,r.q.Info,t,c.o.SamplingPolicy.Measure,i)}warn(e,t,i){this.logEvent(e,null,r.q.Warn,t,c.o.SamplingPolicy.Measure,i)}error(e,t,i){this.logEvent(e,null,r.q.Error,t,c.o.SamplingPolicy.CriticalBusinessImpact,i)}debug(e,t,i){this.logEvent(e,null,r.q.Debug,t,c.o.SamplingPolicy.Diagnostics,i)}logServiceRequest(e,t,i,n,s){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,i,n,c.o.SamplingPolicy.Measure,s)}logEvent(e,t,i,n,s,o,a){if(this._initialized&&(this._debugMode||i!==r.q.Debug))for(const r of this._transports)r.logEvent(e,t,i,n,s,o,a)}getNewActivity(e,t,i){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,i):void 0}dispose(){}};f=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,p.t)(h.l)),(0,n.__param)(1,(0,m.W)(u.C))],f)},85777:(e,t,i)=>{i.d(t,{h:()=>c});var n=i(79490),s=i(21522),o=i(29906),r=i(83010),a=i(45242),l=i(10138),d=i(85924);let c=class{constructor(e,t){this._queryDetection=e,this._logger=t,this._diagosticEventName="OAPanelDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logInternal(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logInternal(e,void 0,t,i,n)},this.logInternal=(e,t,i,n,s)=>{var o,r;const l=this._logger.getNewActivity(e,a.o.SamplingPolicy.CriticalExperimentation);null==l||l.dataFields.push(...(0,d.W)(["conversationId",null!==(o=null==s?void 0:s.conversationId)&&void 0!==o?o:this._queryDetection.getCurrentQueryConversationId()||""],["logicalId",null!==(r=null==s?void 0:s.logicalId)&&void 0!==r?r:this._queryDetection.getCurrentQueryLogicalId()||""])),t&&(null==l||l.dataFields.push((0,d.n)("message",t))),i&&(null==l||l.dataFields.push((0,d.n)("data",JSON.stringify(i)))),n&&(null==l||l.dataFields.push(...n)),l&&(l.success=!0,l.endNow())}}};c=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.J)),(0,n.__param)(1,(0,r.W)(l.g))],c)},75851:(e,t,i)=>{i.d(t,{L:()=>I});var n,s=i(79490),o=i(84523),r=i(45242),a=i(13290);!function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(n||(n={}));var l=i(40705),d=i(56275),c=i(29906),u=i(83010),h=i(91513),g=i(77322),p=i(85924);const m=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function f(e){return e.map((e=>e[1]?v(e[0],e[1]):void 0)).filter((e=>!!e))}function v(e,t,i){return(0,p.n)(e,t,r.o.DataClassification.SystemMetadata,i)}function _(e){const t={};return function(e,t){var i;const n="object"==typeof e&&null!==e;function s(t){if(!n)return;const i=e[t];return"string"==typeof i?i:void 0}t.errorMessage=null!==(i=s("message"))&&void 0!==i?i:String(e),t.errorName=s("name"),t.stack=s("stack"),t.errorType=s("errorType"),t.errorInstanceId=s("errorInstanceId"),m.forEach((i=>{const n=e[i];n&&(t[i]="object"==typeof n?JSON.stringify(n):n)}))}(e,t),t.message?t.message=`${t.message}\n${t.errorMessage}`:t.message=t.errorMessage,void 0===t.stack&&(t.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),t}var y;let I=y=class{constructor(e,t,i){this._userInfoStrategy=e,this._telemetrySink=t,this._loggerSettings=i,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._configurationId=""}async initialize(e,t,i,n,s){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{this._hostSettings=s,this._sessionContext=t,this._configurationId=await e.read(h.l.ConfigurationId),this._appId=await e.read(h.l.AppId),this._clientId=await e.read(h.l.ClientId),this._internalLogger=new o.V(this._loggerSettings,this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,i,n,s,o,r){if(this._initialized&&this._loggerSettings.defaultEventName){const a=t||this._loggerSettings.defaultEventName;this.sendLog(a,e,i,n,s,o,r)}}getNewActivity(e,t,i){var n,s,o;if(!this._initialized)return;const a=this._internalLogger.createActivity(e,void 0,{dataCategories:r.o.DataCategories.ProductServiceUsage,diagnosticLevel:r.o.DiagnosticLevel.RequiredServiceData});if(this._userInfoStrategy.execute(!1,(e=>(e&&a.dataFields.push(...f([["User_Id",e.userId],["Tenant_Id",e.tenantId],["Identity_Provider",JSON.stringify(e.identityProvider)],["License_Type",e.licenseType]])),e))),a.dataFields.push(...this.getSessionContextDataFields()),a.dataFields.push(...f([["App_Id",this._appId],["Client_Id",this._clientId],["CorrelationID",null!==(n=this._sessionCorrelationId)&&void 0!==n?n:""],["ConfigurationId",this._configurationId],["FlightsToTrack",null===(o=null===(s=this._hostSettings)||void 0===s?void 0:s.flightsToTrack)||void 0===o?void 0:o.join(";")]])),i){const t=y.createFunnelContract(e,i);a.dataFields.push(...t)}return a}getSessionContextDataFields(){var e,t;return this._sessionContext?f([["Browser_Type",this._sessionContext.browserType],["Browser_Version",null!==(e=this._sessionContext.browserVersion)&&void 0!==e?e:""],["Store_Runtime_Id",null!==(t=this._sessionContext.extensionStoreId)&&void 0!==t?t:""],["Extension_Version",this._sessionContext.extensionVersion],["Extension_Version_Name",this._sessionContext.extensionVersionName]]):[]}addCorrelationID(e){this._sessionCorrelationId=e}sendLog(e,t,i,n,s,o,l){var d,c;if(!this._initialized||i===a.q.Debug)return;const u=[];this.serviceRequestId&&u.push(v("Service_Request_Id",this.serviceRequestId,r.o.DataFieldType.Guid.valueOf())),this._sessionContext&&u.push(...this.getSessionContextDataFields());let h="",g="",p="";if(this._userInfoStrategy.execute(!1,(e=>{var t;return e&&(h=e.userId,g=null!==(t=e.tenantId)&&void 0!==t?t:"",p=e.identityProvider.toString()),e})),u.push(...f([["Tag",t.toString()],["Tag_Hex",t.toString(16)],["Level",a.q[i]],["App_Id",this._appId],["Client_Id",this._clientId],["User_Id",h],["Tenant_Id",g],["Identity_Provider",p],["Text_Message",n],["Correlation_Id",this._sessionCorrelationId],["Data",o instanceof Error?JSON.stringify(_(o)):o?JSON.stringify(o):void 0],["FlightsToTrack",null===(c=null===(d=this._hostSettings)||void 0===d?void 0:d.flightsToTrack)||void 0===c?void 0:c.join(";")]])),l){y.createFunnelContract(e,l).forEach((e=>u.push(e)))}this._internalLogger.logStandaloneMetric(e,s,r.o.DiagnosticLevel.RequiredServiceData,r.o.DataCategories.NotSet,u)}static createFunnelContract(e,t){const i=n[t];return l.A.Office.System.Funnel.getFields(e,{name:e,state:i})}};I=y=(0,s.__decorate)([(0,c._)(),(0,s.__param)(0,(0,u.W)(g.e)),(0,s.__param)(1,(0,u.W)(d.qy)),(0,s.__param)(2,(0,u.W)(d.k_))],I)},76778:(e,t,i)=>{i.d(t,{M5:()=>s,pD:()=>r,zJ:()=>o});var n=i(76729);const s=(0,n.f)("IHostEmitter"),o=(0,n.f)("IHostEmitterArray");var r;!function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configV2RequestEvent="configV2RequestEvent",e.hostModelTileStateReset="hostModelTileStateReset",e.hostModelVisualStateChange="hostModelTileVisualStateChange",e.hostModelDelta="hostModelDelta",e.hostModelFormattingDelta="hostModelFormattingDelta",e.hostModelAttributionDelta="hostModelAttributionDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelParagraphTextTiles="hostModelParagraphTextTiles",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelRehydrateTilesFinished="hostModelRehydrateTilesFinished",e.hostModelAddedRootNode="hostModelAddedRootNode",e.hostModelRemovedRootNode="hostModelRemovedRootNode",e.hostModelCritiques="hostModelCritiques",e.hostModelCritiqueAction="hostModelCritiqueAction",e.hostModelFlags="hostModelFlags",e.hostModelTextTileEmittedToAugloop="hostModelTextTileEmittedToAugloop",e.oaRankedAnnotations="oaRankedAnnotations",e.oaAnnotationsTriggered="oaAnnotationsTriggered",e.oaFlagAnnotationsTriggered="oaFlagAnnotationsTriggered",e.oaMenuControlSignal="oaMenuControlSignal",e.predictionTriggered="predictionTriggered",e.nudgeTriggered="nudgeTriggered",e.nudgeAccepted="nudgeAccepted",e.headingDetectionRecognized="headingDetectionRecognized",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configV2ResponseEvent="configV2ResponseEvent",e.clearTileCritiques="clearTileCritiques",e.clearCritiquesForNode="clearCritiquesForNode",e.restoreNodeForCritiqueStore="restoreNodeForCritiqueStore",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange",e.ciqSettingsChange="ciqSettingsChange",e.critiqueValuePerLanguageChanged="critiqueValuePerLanguageChanged",e.saveInlineEditingSettings="saveInlineEditingSettings",e.autoCorrectLanguagesUpdated="autoCorrectLanguagesUpdated",e.addWordToDictionaryLocally="addWordToDictionaryLocally",e.setRoamingDictionaryState="setRoamingDictionaryState",e.enableRoamingDictionary="enableRoamingDictionary",e.updateCurrentSessionDictionary="updateCurrentSessionDictionary",e.setAugLoopState="setAugLoopState",e.getAugLoopState="getAugLoopState",e.squiggleClick="squiggleClick",e.taskRecognitionSignal="taskRecognitionSignal",e.toneDetection="toneDetection",e.autoCorrectionTriggered="autoCorrectionTriggered",e.writeProofingLanguage="writeProofingLanguage",e.readProofingLanguage="readProofingLanguage",e.readProofingUserDictionary="readProofingUserDictionary",e.readRoamingProofingOverriddenOptions="readRoamingProofingOverriddenOptions",e.copywriterRequestSuggestions="copywriterRequestSuggestions",e.copywriterSuggestionsReady="copywriterSuggestionsReady",e.seenEventTriggered="seenEventTriggered",e.addWordsToRoamingUserDictionary="addWordsToRoamingUserDictionary",e.requestSynonyms="requestSynonyms",e.receivedSynonyms="receivedSynonyms",e.writeProofingSettingsToRoaming="writeProofingSettingsToRoaming",e.readOASettings="readOASettings",e.writeOASettings="writeOASettings",e.conditionalOrchestratorSettingsChanged="conditionalOrchestratorSettingsChanged",e.aiInsertRequestSuggestions="aiInsertRequestSuggestions",e.aiInsertSuggestionsReady="aiInsertSuggestionsReady",e.logout="logout",e.textAugmentationCoreResponse="textAugmentationCoreResponse",e.textAugmentationCoreRemovalResponse="textAugmentationCoreRemovalResponse",e.textAugmentationCoreRequest="textAugmentationCoreRequest"}(r||(r={}))},45462:(e,t,i)=>{i.d(t,{f:()=>n});const n=(0,i(76729).f)("IInstrumentationMessageProcessor")},95834:(e,t,i)=>{i.d(t,{o:()=>n});const n=(0,i(76729).f)("IProofingEmitter")},18104:(e,t,i)=>{var n;i.d(t,{G:()=>n}),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(n||(n={}))},63137:(e,t,i)=>{i.d(t,{N:()=>r});var n=i(79490),s=i(45402),o=i(29906);let r=class extends s.bk{constructor(){super(...arguments),this.eventNamesUsed=new Set}async initialize(){}shutDown(){for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}on(e,t){super.on(e,t),this.eventNamesUsed.add(e)}off(e,t){try{super.off(e,t)}catch(e){}}};r=(0,n.__decorate)([(0,o._)()],r)},64509:(e,t,i)=>{if(i.d(t,{A:()=>l}),2063!=i.j)var n=i(11994);if(2063!=i.j)var s=i(37573);if(2063!=i.j)var o=i(60503);if(2063!=i.j)var r=i(97446);if(2063!=i.j)var a=i(51152);class l{constructor(){this.imports=[s.A]}get uniqueId(){return(0,a.z)(507918427)}configureRootServices(e){e.bind(r.S).toExisting(o.v),e.bind(o.v).to(n.k)}}},37573:(e,t,i)=>{if(i.d(t,{A:()=>f}),2063!=i.j)var n=i(55972);if(2063!=i.j)var s=i(97446);if(2063!=i.j)var o=i(12676);if(2063!=i.j)var r=i(52041);if(2063!=i.j)var a=i(31294);if(2063!=i.j)var l=i(94453);if(2063!=i.j)var d=i(67843);if(2063!=i.j)var c=i(83626);if(2063!=i.j)var u=i(80661);if(2063!=i.j)var h=i(68241);if(2063!=i.j)var g=i(19470);if(2063!=i.j)var p=i(40315);if(2063!=i.j)var m=i(51152);class f{constructor(){this.imports=[h.u]}get uniqueId(){return(0,m.z)(507918421)}configureRootServices(e){e.bind(o.n).to(u.y),e.bind(l.v).to(c.O),e.bind(r.j).to(r.c),e.bind(s.S).toExisting(r.j),e.bind(p.oA).toDynamicValue((e=>()=>e.getOptional(p.q4))),e.bind(p.Ze).toDynamicValue((e=>()=>e.getOptional(p.jh))),e.bind(p.cg).toDynamicValue((e=>()=>e.getOptional(p.sh))),e.bind(n.m).to(n.r),e.bind(d.H).toSelf(),e.bind(g.W).toSelf(),e.bind(a.DS).to(a.KW)}}},51152:(e,t,i)=>{function n(e){return e}i.d(t,{z:()=>n})},30913:(e,t,i)=>{i.d(t,{U:()=>a});var n=i(45402);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(83432);if(2063!=i.j)var r=i(29906);class a{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918419)}configureRootServices(e){!function(e,t,i){try{(0,o.Yi)(e,t,i)}catch(e){}}((0,r._)(),n.bk)}}},39826:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(76729).f)("IsMobile")},68241:(e,t,i)=>{if(i.d(t,{u:()=>R}),2063!=i.j)var n=i(30913);if(2063!=i.j)var s=i(96753);if(2063!=i.j)var o=i(84523);if(2063!=i.j)var r=i(95542);if(2063!=i.j)var a=i(609);if(2063!=i.j)var l=i(72622);if(2063!=i.j)var d=i(56275);if(2063!=i.j)var c=i(98824);if(2063!=i.j)var u=i(21711);if(2063!=i.j)var h=i(76778);if(2063!=i.j)var g=i(11804);if(2063!=i.j)var p=i(14775);if(2063!=i.j)var m=i(10138);if(2063!=i.j)var f=i(95834);if(2063!=i.j)var v=i(97446);if(2063!=i.j)var _=i(44621);if(2063!=i.j)var y=i(23957);if(2063!=i.j)var I=i(8447);if(2063!=i.j)var C=i(44656);if(2063!=i.j)var S=i(34141);if(2063!=i.j)var b=i(90736);if(2063!=i.j)var T=i(21683);if(2063!=i.j)var E=i(7405);if(2063!=i.j)var N=i(95111);if(2063!=i.j)var x=i(75851);if(2063!=i.j)var w=i(63137);if(2063!=i.j)var L=i(61188);if(2063!=i.j)var D=i(34899);if(2063!=i.j)var F=i(51152);if(2063!=i.j)var A=i(50873);class R{constructor(){this.imports=[n.U]}get uniqueId(){return(0,F.z)(507918415)}configureRootServices(e){e.bind(_.V).to(L.w),e.bind(h.M5).to(w.N),e.bind(v.S).toExisting(h.M5),e.bind(h.zJ).toExisting(h.M5),e.bind(f.o).to(w.N),e.bind(v.S).toExisting(f.o),e.bind(u.G).to(l.L),e.bind(x.L).toSelf(),e.bind(S.l).toExisting(x.L),e.bind(C.C).toExisting(x.L),e.bind(m.g).to(N.V);const t=new s.a,i=e.getOptional(d.qy);if(i){const{logGroupName:n,tenant:s,logToConsole:a,logToKusto:l}=t,c=new o.V({logGroupName:n,tenant:s,defaultEventName:"",logToConsole:a,logToKusto:l},i,!0);(0,r.L)(c),e.bind(d.ZL).toValue(c)}e.bind(d.k_).toValue(t),e.bind(p.aP).toValue((()=>e.getOptional(p.iw))),e.bind(T.r).toSelf(),e.bind(c.In).to(a.F),e.bind(y.Zp).to(D.K),e.bind(E.Z).toSelf(),e.bind(b.tq).to(b.Gv),e.bind(I.a).toDynamicValue((e=>{let t;const i=e.get(g.n);return async()=>t?Promise.resolve(t):new Promise((n=>{var s,o,r,a,l,d;const c=(0,A.cO)();t={os:void 0,arch:void 0,browserType:null!==(s=null==c?void 0:c.name)&&void 0!==s?s:"",browserVersion:null!==(o=null==c?void 0:c.version)&&void 0!==o?o:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:"",sessionId:null!==(a=null===(r=i.hostMetadata)||void 0===r?void 0:r.sessionId)&&void 0!==a?a:e.get(u.G).generate(),composeSessionId:null!==(d=null===(l=i.hostMetadata)||void 0===l?void 0:l.composeSessionId)&&void 0!==d?d:e.get(u.G).generate()},n(t)}))}))}}},28039:(e,t,i)=>{if(i.d(t,{k:()=>a}),2063!=i.j)var n=i(97446);if(2063!=i.j)var s=i(68336);if(2063!=i.j)var o=i(23219);if(2063!=i.j)var r=i(51152);class a{get uniqueId(){return(0,r.z)(507347844)}configureRootServices(e){e.bind(s.J).to(o.k),e.bind(n.S).toExisting(s.J)}}},40200:(e,t,i)=>{i.d(t,{F:()=>n});const n=(0,i(76729).f)("IPaneOpenState")},91513:(e,t,i)=>{var n;i.d(t,{l:()=>n}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(n||(n={}))},2915:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(76729).f)("IProofingPersistedStore")},48129:(e,t,i)=>{i.d(t,{C:()=>n});const n=(0,i(76729).f)("IRoamingDictionaryBroker")},96753:(e,t,i)=>{if(i.d(t,{a:()=>s}),2063!=i.j)var n=i(22550);class s{constructor(){this.logGroupName="EditorBx",this.tenant={tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},this.defaultEventName=n.M.Diagnostics,this.logToConsole=!1,this.logToKusto=!0}}},68805:(e,t,i)=>{function n(e,t){var i;return!!e&&!0===(null===(i=e.find((e=>e.entityType===t)))||void 0===i?void 0:i.enabled)}function s(e,t){var i;if(e)return null===(i=e.find((e=>e.entityType===t)))||void 0===i?void 0:i.maxResults}function o(e,t,i,s){return!!(null!=e?e:[]).includes(s)||n(t,i)}i.d(t,{Z$:()=>s,f1:()=>o,i$:()=>n})},77854:(e,t,i)=>{i.d(t,{U:()=>s});var n=i(76729);(0,n.f)("IEditorCritiqueGroups");const s=(0,n.f)("ICIQFlagEditorCategories")},91984:(e,t,i)=>{i.d(t,{e:()=>s,rI:()=>o});var n=i(76729);const s=(0,n.f)("ILanguageListStateStore"),o=((0,n.f)("SupportsIndividualCIQFlagDisabling"),(0,n.f)("IEditorSettingsManager"))},44170:(e,t,i)=>{i.d(t,{z:()=>n});const n=(0,i(76729).f)("IEditorSettingsState")},11804:(e,t,i)=>{i.d(t,{d:()=>n,n:()=>o});var n,s=i(76729);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(n||(n={}));const o=(0,s.f)("IHostSettings")},82677:(e,t,i)=>{function n(e,t){return e.dataSource===t.dataSource&&e.userId===t.userId&&e.timestamp===t.timestamp}i.d(t,{G:()=>n})},50873:(e,t,i)=>{i.d(t,{cO:()=>d});var n=i(72715);class s{constructor(e,t){this.name=e,this.version=t}}class o{constructor(e){this.version=e,this.name="node"}}class r{constructor(){this.bot=!0,this.name="bot",this.version=null}}const a=3,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function d(e){return e?c(e):navigator?c(navigator.userAgent):n.version?new o(n.version.slice(1)):null}function c(e){const t=""!==e&&l.reduce(((t,[i,n])=>{if(t)return t;const s=n.exec(e);return!!s&&[i,s]}),!1);if(!t)return null;const[i,n]=t;if("searchbot"===i)return new r;let o=n[1].split(/[._]/).slice(0,3);return o?o.length<a&&(o=[...o,...u(a-o.length)]):o=[],new s(i,o.join("."))}function u(e){const t=[];for(let i=0;i<e;i+=1)t.push("0");return t}},69992:(e,t,i)=>{i.d(t,{L:()=>d});var n=i(79490),s=i(98970),o=i(40315),r=i(29906),a=i(83010),l=i(27603);let d=class{constructor(e){this.targetWindowFactory=e,this.isComposing=!1,this._isInitalized=!1}async initialize(){var e,t;this._isInitalized||(this._windowEventListener=new s.J(null!==(t=null===(e=this.targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:window),this._windowEventListener.addListener("compositionstart",this.onCompositionStart),this._windowEventListener.addListener("compositionend",this.onCompositionEnd),this._isInitalized=!0)}shutDown(){var e;null===(e=this._windowEventListener)||void 0===e||e.removeAllListeners(),this._windowEventListener=void 0,this._isInitalized=!1}onCompositionStart(){this.isComposing=!0}onCompositionEnd(){this.isComposing=!1}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.cg)),(0,n.__param)(0,(0,l.l)())],d)},65099:(e,t,i)=>{function n(e,t){return!(!e||!t)&&(e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext&&e.nodeId===t.nodeId)}function s(e,t){return!(e.start>=t.start+t.length||t.start>=e.start+e.length)}i.d(t,{PD:()=>o,gS:()=>n,tw:()=>s});function o(e){const t=new Map;for(const i of e){if(!i.tileId)continue;const e=t.get(i.tileId.nodeId);e?e.push(i):t.set(i.tileId.nodeId,[i])}return t}},25877:(e,t,i)=>{function n(e){return function(e,t){const i=-e.getTimezoneOffset(),n=i>=0?"+":"-";return e.getFullYear()+"-"+s(e.getMonth()+1)+"-"+s(e.getDate())+"T"+s(e.getHours())+":"+s(e.getMinutes())+":"+s(e.getSeconds())+(t?"."+s(e.getMilliseconds()):"")+n+s(i/60)+":"+s(i%60)}(e,!0)}function s(e){const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}i.d(t,{k:()=>n})},98970:(e,t,i)=>{if(i.d(t,{J:()=>s}),2063!=i.j)var n=i(33511);class s{constructor(e){this.listeners={},this.captureListeners={},this.element=(0,n.E)(e)?e:new n.O(e)}addListener(e,t,i){const n=this.element.deref();if(n){if(null==i?void 0:i.capture){if(e in this.captureListeners)throw new Error(`Event ${e} previously registered.`);this.captureListeners[e]=t}else{if(e in this.listeners)throw new Error(`Event ${e} previously registered.`);this.listeners[e]=t}n.addEventListener(e,t,i)}}removeListener(e,t){const i=this.element.deref();i&&((null==t?void 0:t.capture)?e in this.captureListeners&&(i.removeEventListener(e,this.captureListeners[e],t),delete this.captureListeners[e]):e in this.listeners&&(i.removeEventListener(e,this.listeners[e]),delete this.listeners[e]))}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e);this.listeners={};for(const e of Object.keys(this.captureListeners))this.removeListener(e,{capture:!0});this.captureListeners={}}}},59556:(e,t,i)=>{i.d(t,{z:()=>n});class n{constructor(){this.listeners={}}subscribe(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n.push(t),this.listeners[e]=n}unsubscribe(e,t){var i;let n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.listeners[e]=n}publishEvent(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];for(const e of n)try{e(t)}catch(e){}}}},72622:(e,t,i)=>{i.d(t,{L:()=>r});var n=i(79490),s=i(29906),o=i(78126);let r=class{generate(){return(0,o.A)()}};r=(0,n.__decorate)([(0,s._)()],r)},4891:(e,t,i)=>{i.d(t,{q:()=>n});const n=(0,i(76729).f)("ICompositionEventHandler")},21711:(e,t,i)=>{i.d(t,{G:()=>n});const n=(0,i(76729).f)("IGuidGenerator")},21522:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(76729).f)("IQueryDetection")},12676:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(76729).f)("IResourceUrlFormatter")},18640:(e,t,i)=>{if(i.d(t,{K2:()=>a,KV:()=>l,Pe:()=>r,Sg:()=>c,ug:()=>d}),2063!=i.j)var n=i(18309);if(2063!=i.j)var s=i(61566);if(2063!=i.j)var o=i(1527);const r=e=>{const t=e;return void 0!==t.x&&void 0!==t.y},a=e=>{const t=e;return void 0!==t.left&&void 0!==t.top&&void 0!==t.width&&void 0!==t.height};function l(e){return e?(0,o.C)(e,"HTMLElement")?e:a(e)?new s.M(e.left,e.right,e.top,e.bottom):r(e)?e:e.getBoundingClientRect():null}function d(e){if(e)return a(e)?{getBoundingClientRect:()=>{var t,i;return{x:e.left,y:e.top,top:e.top,left:e.left,bottom:null!==(t=e.bottom)&&void 0!==t?t:0,right:null!==(i=e.right)&&void 0!==i?i:0,width:e.width,height:e.height}}}:r(e)?{getBoundingClientRect:()=>({x:e.x,y:e.y,top:e.y,left:e.x,bottom:e.y,right:e.x,width:0,height:0})}:e}function c(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case n.A.topLeftEdge:return{position:"above",align:"start"};case n.A.topCenter:case n.A.topAutoEdge:return{position:"above",align:"center"};case n.A.topRightEdge:return{position:"above",align:"end"};case n.A.bottomLeftEdge:return{position:"below",align:"start"};case n.A.bottomCenter:case n.A.bottomAutoEdge:return{position:"below",align:"center"};case n.A.bottomRightEdge:return{position:"below",align:"end"};case n.A.leftTopEdge:return{position:"before",align:"top"};case n.A.leftCenter:return{position:"before",align:"center"};case n.A.leftBottomEdge:return{position:"before",align:"bottom"};case n.A.rightTopEdge:return{position:"after",align:"top"};case n.A.rightCenter:return{position:"after",align:"center"};case n.A.rightBottomEdge:return{position:"after",align:"bottom"}}}},68336:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(76729).f)("ITimer")},6142:(e,t,i)=>{i.d(t,{l:()=>s});var n=i(33511);class s extends n.O{constructor(e,t,i){super(e),this.logger=t,this.derefFailedLogMessage=i}deref(){const e=super.deref();return e||this.logger.error(508143266,this.derefFailedLogMessage,new Error(this.derefFailedLogMessage)),e}}},35813:(e,t,i)=>{i.d(t,{e:()=>n});class n{constructor(){this.mutex=Promise.resolve()}lock(){let e=e=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}}},43499:(e,t,i)=>{i.d(t,{I:()=>f});var n=i(79490),s=i(69811),o=i(81628),r=i(72622),a=i(10219),l=i(11804),d=i(10138),c=i(32177),u=i(71924),h=i(85924),g=i(29906),p=i(83010),m=i(27603);let f=class{constructor(e,t,i,n){var a,l;this._featureFlagReader=e,this.hostSettings=t,this._logger=i,this._oaMetric=n,this._isNextDeltaProgrammaticallyInserted=!1,this._augloopReconnectionOccurring=!1,this._unsupportedEntities=[],this.registeredQueryDetectionStartChars=[],this.FORBIDDEN_CHARS=['"',"<",">","/","\\","|"],this.PUNCTUATION_CHARS=[",",".",":","!","?","'",";","&"],this.ALLOWED_PREVIOUS_CHARS=["(","/","+",""],this.registerQueryDetectionStartCharacter=e=>{this.registeredQueryDetectionStartChars.includes(e)||this.registeredQueryDetectionStartChars.push(e)},this.unregisterQueryDetectionStartCharacter=e=>{const t=this.registeredQueryDetectionStartChars.indexOf(e);t>-1&&this.registeredQueryDetectionStartChars.splice(t,1)},this.handleAugloopReconnection=e=>{this._augloopReconnectionOccurring=!0;try{e()}finally{this._augloopReconnectionOccurring=!1}},this.handleTileRemoved=e=>{var t,i;return(null===(t=this._currentQuery)||void 0===t?void 0:t.tileId)===e&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),null===(i=this._currentQuery)||void 0===i?void 0:i.queryRange},this.getCurrentQuery=()=>this._currentQuery,this.getIsSameWordQueriesDismissed=()=>{var e;return null!==(e=this._isCurrentQueryDismissed)&&void 0!==e&&e},this.updateCurrentQuery=e=>{var t,i,n,s,o,r,a;if(this._currentQuery=e,this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1),!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric))return;const l=this._currentQuery.queryRange.length===(null!==(n=null===(i=this._currentQuery.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1),d={logicalId:this._currentQuery.additionalData.logicalId||"",conversationId:this._currentQuery.additionalData.conversationId||"",clientCorrelationId:this._clientCorrelationId||"",triggerCharacter:null!==(s=this._currentQuery.queryRange.prefix)&&void 0!==s?s:"@",isEmptyQuery:l,queryLength:this._currentQuery.queryRange.length-(null!==(r=null===(o=this._currentQuery.queryRange.prefix)||void 0===o?void 0:o.length)&&void 0!==r?r:1)};null===(a=this._oaMetric)||void 0===a||a.startEntry(this._currentQuery.additionalData.logicalId,d)},this.getCurrentQueryTileId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.tileId},this.getCurrentQueryLogicalId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.logicalId},this.getCurrentQueryConversationId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.conversationId},this.getCurrentQueryCorrelationKeys=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData},this.getPreviousQueryCorrelationKeys=()=>this._previousData,this.removeDetectedQuery=()=>{var e;this._previousData=null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData,this._currentQuery=void 0,this._currentScope=void 0,this._unsupportedEntities=[]},this.setCurrentQueryRange=(e,t,i,n,s)=>{var o,a;return this.updateCurrentQuery({tileId:e,queryRange:t,additionalData:{triggerCharacter:s,scopeInfo:n,logicalId:this.registerNewLogicalId(),conversationId:i?(null===(o=this._currentQuery)||void 0===o?void 0:o.additionalData.conversationId)||"":(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||""}}),null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData},this.getCurrentScope=()=>this._currentScope,this.setCurrentScope=(e,t=!0)=>{this._currentScope=e,this._currentQuery&&t&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope})}))},this.getUnsupportedEntities=()=>this._unsupportedEntities,this.setUnsupportedEntities=e=>{this._unsupportedEntities=e,this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{unsupportedEntities:this._unsupportedEntities})}))},this.setClientCorrelationId=e=>{this._clientCorrelationId=e},this.setNextDeltaProgramaticallyInserted=e=>{this._isNextDeltaProgrammaticallyInserted=!0,this._programmaticallyInsertedSource=e},this.resetNextDeltaProgramaticallyInserted=()=>{this._isNextDeltaProgrammaticallyInserted=!1,this._programmaticallyInsertedSource=void 0},this.dismissCurrentQuery=(e,t,i,n)=>{var s,o,r;this._currentQuery&&(e&&(null===(s=this._logger)||void 0===s||s.logActivity(null!=i?i:"OACurrentQueryDismiss",void 0,[...null!=n?n:[],...(0,h.W)(["interaction",null!=t?t:"escape"],["conversationId",null!==(o=this.getCurrentQueryConversationId())&&void 0!==o?o:""],["logicalId",null!==(r=this.getCurrentQueryLogicalId())&&void 0!==r?r:""])])),this._isCurrentQueryDismissed=!0)},this.handleTileDelta=(e,t,i,n,r)=>{var a,l,d,c,u,h,g,p,m,f,v;const{deltaType:_,unit:y,length:I,content:C,position:S}=t;return _!==s.WI.Update||0!==I||C?void 0===I||void 0===S?this.getIfLocal(n)?{queryRange:null===(d=this._currentQuery)||void 0===d?void 0:d.queryRange,additionalData:null===(c=this._currentQuery)||void 0===c?void 0:c.additionalData}:{queryRange:void 0,additionalData:void 0}:y!==s.OD.Sentence&&y!==s.OD.Paragraph||_!==s.WI.Add&&_!==s.WI.Update||!((null!==(h=null===(u=null==C?void 0:C.trim())||void 0===u?void 0:u.length)&&void 0!==h?h:0)>1||0===(null===(g=null==C?void 0:C.trim())||void 0===g?void 0:g.length))||1===(null==C?void 0:C.length)&&o.xC(C.charCodeAt(0))?this.getIfLocal(n)?(this.handleLocalTileDelta(e,S,I,_,C,i,r),{queryRange:null===(f=this._currentQuery)||void 0===f?void 0:f.queryRange,additionalData:null===(v=this._currentQuery)||void 0===v?void 0:v.additionalData}):(this.handleRemoteTileDelta(e,S,I,_,C),{queryRange:void 0,additionalData:void 0}):(this._currentQuery&&this._currentQuery.tileId===e&&_===s.WI.Update&&C&&r&&C.length!==r.length&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this.getIfLocal(n)?{queryRange:null===(p=this._currentQuery)||void 0===p?void 0:p.queryRange,additionalData:null===(m=this._currentQuery)||void 0===m?void 0:m.additionalData}:{queryRange:void 0,additionalData:void 0}):this.getIfLocal(n)?{queryRange:null===(a=this._currentQuery)||void 0===a?void 0:a.queryRange,additionalData:null===(l=this._currentQuery)||void 0===l?void 0:l.additionalData}:{queryRange:void 0,additionalData:void 0}},this.getIfLocal=e=>this._featureFlagReader.flags.enableQueryOnlyOnLocalChange?e===u.Q0.Local:e===u.Q0.Local||e===u.Q0.Code,this.logQueryDetected=()=>{var e,t,i;null===(e=this._logger)||void 0===e||e.logActivity("OAQueryDetected",void 0,(0,h.W)(["conversationId",null!==(t=this.getCurrentQueryConversationId())&&void 0!==t?t:""],["logicalId",null!==(i=this.getCurrentQueryLogicalId())&&void 0!==i?i:""]))},this.handleLocalTileDelta=(e,t,i,n,a,l,d)=>{var c,u,h;const g=this._isNextDeltaProgrammaticallyInserted,p=this._programmaticallyInsertedSource;if(!this._augloopReconnectionOccurring)if(this._currentQuery){if(this._currentQuery.tileId!==e)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const{isWithinSearchQuery:o,updatedEditedPosition:r}=this.isWithinSearchQuery(n,t,i,a,null!==(c=null==a?void 0:a.length)&&void 0!==c?c:0,l,d);if(!o)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(a&&void 0!==this.FORBIDDEN_CHARS.find((e=>a.includes(e))))return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(t=r,n===s.WI.Add&&void 0!==a){const e=l.substring(this._currentQuery.queryRange.start,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length);if(1===a.length&&this.isWhitespace(a.charCodeAt(0))&&this._currentQuery.queryRange.prefix){let t=!0;for(let i=0;i<e.length;i++)if(e.charAt(i)!==this._currentQuery.queryRange.prefix){t=!1;break}if(t)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}this._currentQuery.queryRange.length+=a.length}else if(n===s.WI.Update&&void 0!==a&&i){const e=t-this._currentQuery.queryRange.start,n=this._currentQuery.queryRange.length-e,s=Math.min(i,n);if(this._currentQuery.queryRange.length+=a.length,this._currentQuery.queryRange.length-=s,0===this._currentQuery.queryRange.length)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}else if(n===s.WI.Delete){const e=t-this._currentQuery.queryRange.start,n=Math.min(this._currentQuery.queryRange.length-e,i);this._currentQuery.queryRange.length-=n}if(this._currentQuery.queryRange.length<(null!==(h=null===(u=this._currentQuery.queryRange.prefix)||void 0===u?void 0:u.length)&&void 0!==h?h:1))this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0;else{l.substring(this._currentQuery.queryRange.start+1,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length).trim().split(" ").length>4&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0)}if(this._currentQuery&&this._currentQuery.queryRange.length>this.maxQueryLength)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope,clientCorrelationId:this._clientCorrelationId||"",isUserInsertion:!g,source:p})}))}else if((n===s.WI.Add||n===s.WI.Update)&&a){const i=a,n=a.trim();if(this.registeredQueryDetectionStartChars.includes(n)){const s=i.indexOf(n),o=l[t+s-1];if(o&&!(this.isWhitespace(o.charCodeAt(0),!1)||this.ALLOWED_PREVIOUS_CHARS.includes(o)&&!this.registeredQueryDetectionStartChars.includes(o)))return;this.updateCurrentQuery({tileId:e,queryRange:{start:t+s,length:1,prefix:n},additionalData:{triggerCharacter:n,logicalId:this.registerNewLogicalId(),conversationId:(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!g,source:p}}),this.logQueryDetected()}else if(a.length>0){for(let e=0;e<a.length;e++)o.Yv(a.charCodeAt(e))&&this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1);for(let e=0;e<a.length;e++)if(o.Yv(a.charCodeAt(e))||this.FORBIDDEN_CHARS.includes(a.charAt(e)))return;if(this.PUNCTUATION_CHARS.includes(a))return;const i=this.getWordBeforeChange(l,t+a.length-1);if(this.registeredQueryDetectionStartChars.includes(i[0])){if(i.indexOf(i[0],1)>0)return;if(this._isCurrentQueryDismissed)return;if(i.length>this.maxQueryLength)return;this.updateCurrentQuery({tileId:e,queryRange:{start:t-i.length+a.length,length:i.length,prefix:i[0]},additionalData:{triggerCharacter:i[0],logicalId:this.registerNewLogicalId(),conversationId:(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!g,source:p}}),this.logQueryDetected()}}}},this.handleRemoteTileDelta=(e,t,i,n,o)=>{var r,a;if(!this._currentQuery)return;if(e!==this._currentQuery.tileId)return;if(t>=this._currentQuery.queryRange.start+this._currentQuery.queryRange.length)return;if(t>this._currentQuery.queryRange.start)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const l=n===s.WI.Add?null!==(r=null==o?void 0:o.length)&&void 0!==r?r:0:n===s.WI.Delete?-1*i:n===s.WI.Update?(null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0)-i:0;this._currentQuery.queryRange.start+=l},this.isWithinSearchQuery=(e,t,i,n,o,r,a)=>{let l=t;if(!this._currentQuery)return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(""===this._currentQuery.queryRange.prefix)return{isWithinSearchQuery:!0,updatedEditedPosition:l};if(l<this._currentQuery.queryRange.start)return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(l===this._currentQuery.queryRange.start&&(e!==s.WI.Update||n!==this._currentQuery.queryRange.prefix))return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(e===s.WI.Add&&void 0!==n&&1===o&&l>0){const e=r.charAt(l-1);(e===n||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(n.charCodeAt(0)))&&(l-=1)}if(e===s.WI.Delete&&1===i&&a){const e=r.charAt(l-1),t=a;(e===t||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(t.charCodeAt(0)))&&(l-=1)}return l>this._currentQuery.queryRange.start+this._currentQuery.queryRange.length+(e!==s.WI.Delete?0:-1)?{isWithinSearchQuery:!1,updatedEditedPosition:l}:{isWithinSearchQuery:!0,updatedEditedPosition:l}},this.isWhitespace=(e,t)=>8203===e||o.Yv(e,t),this.getWordBeforeChange=(e,t)=>{let i;for(i=t;i>=0&&!this.isWhitespace(e.charCodeAt(i));i--);return e.substring(i+1,t+1)},this.registerNewLogicalId=()=>(new r.L).generate(),this.maxQueryLength=null!==(l=null===(a=this.hostSettings.oaSettings)||void 0===a?void 0:a.maxQueryLength)&&void 0!==l?l:300}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(a.c)),(0,n.__param)(1,(0,p.W)(l.n)),(0,n.__param)(2,(0,p.W)(d.g)),(0,n.__param)(2,(0,m.l)()),(0,n.__param)(3,(0,p.W)(c.u)),(0,n.__param)(3,(0,m.l)())],f)},1527:(e,t,i)=>{function n(e){var t;const i=e&&(e.commonAncestorContainer||e),n=i&&(i.ownerDocument||("[object HTMLDocument]"===Object.prototype.toString.apply(i)?i:null));return n&&(null!==(t=n.defaultView)&&void 0!==t?t:window)}function s(e,t){const i=n(e),s=i&&i[t],o=window,r=o&&o[t];return r&&e instanceof r||s&&e instanceof s}i.d(t,{C:()=>s,e:()=>n})},52041:(e,t,i)=>{i.d(t,{c:()=>u,j:()=>d});var n=i(79490),s=i(11804),o=i(33511),r=i(76729),a=i(29906),l=i(83010);const d=(0,r.f)("ISafeWindow"),c=1e4;let u=class{constructor(e){this._hostSettings=e,this._clearanceIntervalId=void 0,this._requestedFrames=[],this._requestedIdleFrames=[]}async initialize(){this._hostSettings.enableClearingOfRequestedAnimationFrames&&this.setIntervals()}shutDown(){var e;this._clearanceIntervalId&&(clearInterval(this._clearanceIntervalId),this._clearanceIntervalId=void 0);for(const{id:t,targetWindowRef:i}of this._requestedFrames)null===(e=i.deref())||void 0===e||e.cancelAnimationFrame(t);this._requestedFrames=[]}requestAnimationFrame(e,t=window){const i=(0,o.E)(t)?t:new o.O(t),n=i.deref();if(!n)return-1;const s=n.requestAnimationFrame(e);return this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedFrames.push({id:s,targetWindowRef:i,time:(new Date).getTime()}),s}cancelAnimationFrame(e,t=window){const i=((0,o.E)(t)?t:new o.O(t)).deref();if(i&&(i.cancelAnimationFrame(e),this._hostSettings.enableClearingOfRequestedAnimationFrames)){const t=this._requestedFrames.findIndex((t=>t.id===e));-1!==t&&this._requestedFrames.splice(t,1)}}requestIdleCallback(e,t,i=window){const n=(0,o.E)(i)?i:new o.O(i),s=n.deref();if(!s)return-1;let r;return r="requestIdleCallback"in s?s.requestIdleCallback(e,{timeout:t}):s.setTimeout(e,t),this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedIdleFrames.push({id:r,targetWindowRef:n,time:(new Date).getTime()}),r}cancelIdleCallback(e,t=window){const i=((0,o.E)(t)?t:new o.O(t)).deref();i&&("requestIdleCallback"in i?i.cancelIdleCallback(e):i.clearTimeout(e))}setIntervals(){this._clearanceIntervalId=setInterval((()=>{var e;const t=(new Date).getTime();let i=this._requestedFrames.findIndex((({time:e})=>t-e<c)),n=-1===i?this._requestedFrames.splice(0,this._requestedFrames.length):this._requestedFrames.splice(0,i);if(n.length)for(const{id:t,targetWindowRef:i}of n)null===(e=i.deref())||void 0===e||e.cancelAnimationFrame(t);if(i=this._requestedIdleFrames.findIndex((({time:e})=>t-e<c)),n=-1===i?this._requestedIdleFrames.splice(0,this._requestedIdleFrames.length):this._requestedIdleFrames.splice(0,i),n.length)for(const{id:e,targetWindowRef:t}of n){const i=t.deref();i&&("requestIdleCallback"in i?i.cancelIdleCallback(e):i.clearTimeout(e))}}),c)}};u=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(s.n))],u)},81628:(e,t,i)=>{function n(e,t){let i,n,o={firstDiffLeft:0,firstDiffRight:t.length};e.length<t.length?(i=e,n=t):(i=t,n=e),i=i.replace(""," "),n=n.replace(""," "),n.startsWith(i)?(o.firstDiffLeft=i.length,o.firstDiffRight=0):n.endsWith(i)?(o.firstDiffLeft=0,o.firstDiffRight=i.length):(o=function(e,t){const i={firstDiffLeft:0,firstDiffRight:t.length};return i.firstDiffLeft=s(e,t,!0),i.firstDiffRight=s(e,t,!1),i}(e,t),o.firstDiffLeft+o.firstDiffRight>i.length&&(o.firstDiffRight=i.length-o.firstDiffLeft)),function(e,t,i){if(e.firstDiffLeft>0){const n=e.firstDiffLeft<t.length&&u(t,e.firstDiffLeft),s=e.firstDiffLeft<i.length&&u(i,e.firstDiffLeft);(n||s)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight<=1)return;const n=e.firstDiffRight<t.length&&u(t,t.length-e.firstDiffRight),s=e.firstDiffRight<i.length&&u(i,i.length-e.firstDiffRight);(n||s)&&(e.firstDiffRight-=1)}(o,e,t);o.firstDiffLeft<e.length&&u(e,o.firstDiffLeft)||o.firstDiffLeft<t.length&&u(t,o.firstDiffLeft),o.firstDiffRight>0&&(o.firstDiffRight<e.length&&u(e,e.length-o.firstDiffRight)||o.firstDiffRight<t.length&&u(t,t.length-o.firstDiffRight));return o}function s(e,t,i){let n;for(n=0;n<e.length&&n<t.length;n+=1){const s=e.charCodeAt(i?n:e.length-n-1),o=t.charCodeAt(i?n:t.length-n-1);if(s!==o&&!(l(s,!0)&&l(o,!0)||c(s)&&c(o)))break}return n}let o;function r(e){try{return o||(o=new RegExp("[\\p{Extended_Pictographic}\\u{1F3FB}-\\u{1F3FF}\\u{1F9B0}-\\u{1F9B3}]","u")),o.test(e)}catch(e){return!1}}function a(e){return!!e&&/[\u0E81-\u0EDF\u0f00-\u0FFF\u1000-\u109F\u1780-\u17F9\u1980-\u19DF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\u0E00-\u0E7F\uff66-\uff9f]/g.test(e)}function l(e,t=!1){if(c(e))return!t;if(d(e))return!0;switch(e){case 11:case 9:return!0}return!1}function d(e){switch(e){case 12288:case 8194:case 8195:case 8197:case 32:case 160:return!0}return!1}function c(e){switch(e){case 13:case 10:case 65532:return!0}return!1}function u(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}i.d(t,{CC:()=>n,Fc:()=>g,Yv:()=>l,_1:()=>r,tF:()=>a,xC:()=>d});const h="0123456789";function g(e){return function(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}(e)||function(e){return h.includes(e)}(e)}},40315:(e,t,i)=>{i.d(t,{Ze:()=>l,cg:()=>d,jh:()=>o,oA:()=>a,q4:()=>s,sh:()=>r});var n=i(76729);const s=(0,n.f)("TargetRenderElement"),o=(0,n.f)("TargetDocument"),r=(0,n.f)("TargetWindow"),a=(0,n.f)("TargetRenderElementFactory"),l=(0,n.f)("TargetDocumentFactory"),d=(0,n.f)("TargetWindowFactory")},55972:(e,t,i)=>{i.d(t,{m:()=>f,r:()=>v});var n=i(79490),s=i(76729),o=i(29906),r=i(83010),a=i(45242),l=i(11804),d=i(10138),c=i(91513),u=i(2915),h=i(52041),g=i(728),p=i(59433),m=i(85924);const f=(0,s.f)("IE2eMetric");let v=class{constructor(e,t,i,n){var s;this._logger=e,this._hostSettings=t,this._proofingStore=i,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,a.o.SamplingPolicy.CriticalExperimentation);if(!t)return;const i=this._proofingStore.getCachedEntry(c.l.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>(0,m.n)(e.name,e.duration,void 0,a.o.DataFieldType.Double.valueOf())))),t.dataFields.push(...(0,m.W)([this._alEventName,this._isAlEnabled],[p.o.NumProofingLanguages,i.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(s=this._hostSettings.orchestratorSettings)||void 0===s?void 0:s.enableAugLoop),this.metric=new g.J(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,i){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,i)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};v=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(d.g)),(0,n.__param)(1,(0,r.W)(l.n)),(0,n.__param)(2,(0,r.W)(u.K)),(0,n.__param)(3,(0,r.W)(h.j))],v)},32177:(e,t,i)=>{i.d(t,{u:()=>n});const n=(0,i(76729).f)("IOaMetric")},728:(e,t,i)=>{i.d(t,{J:()=>d});var n,s=i(79490),o=i(28831),r=i(13290),a=i(45242),l=i(29906);let d=n=class{constructor(e,t,i,n,s,o){this._logger=e,this._safeWindow=t,this._eventName=i,this._performanceApiGarbageCollectorIntervalInMs=n,this._logToTelemetry=s,this._onTimeout=o,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,i){const[n]=this._getPerformanceEntryNames(e);let s=window.performance.mark(n);if(void 0===s){const e=window.performance.getEntriesByName(n);if(1!==e.length)return void this._logger.logEvent(541099735,o.f.TelemetryError,r.q.Error,`Unable to find performance entry by name: ${n}`,a.o.SamplingPolicy.CriticalExperimentation);s=e[0]}this._performanceMarksInGarbageCollection.push(s),t&&this._performanceMarksInGCCorrelationKeysHistory.set(s.name,{correlationKeys:t,customData:i}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const i=`${t}-${e}`;return[e,`${i}--${n.END_SUFFIX}`,i]}addMeasure(e,t,i){const[n,s,l]=this._getPerformanceEntryNames(e,t);if(0!==window.performance.getEntriesByName(n).length)try{if(window.performance.mark(s),window.performance.measure(l,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]),window.performance.clearMarks(s),window.performance.clearMeasures(l),i){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,s=e.customData;this._performanceMarksInGCCorrelationKeysHistory.set(n,{correlationKeys:t,customData:Object.assign(Object.assign({},s),i)})}}}catch(e){this._logger.logEvent(523646680,o.f.TelemetryError,r.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e}`,a.o.SamplingPolicy.CriticalExperimentation)}}commitEntry(e,t=this._eventName,i){const[n,s,l]=this._getPerformanceEntryNames(e,t),d=window.performance.getEntriesByName(n);if(0!==d.length)try{window.performance.mark(s),window.performance.measure(l,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]);const o=this._performanceMarksInGCCorrelationKeysHistory.get(n);this._logToTelemetry(this._measuresNames.get(e)||[],null==o?void 0:o.correlationKeys,null==o?void 0:o.customData,i),window.performance.clearMarks(n),window.performance.clearMarks(s),window.performance.clearMeasures(l),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(d[0])}catch(e){this._logger.logEvent(521417349,o.f.TelemetryError,r.q.Error,`Error while commiting a telemetry entry, error: ${e}`,a.o.SamplingPolicy.CriticalExperimentation)}}setOnTimeout(e){this._onTimeout=e}_clearAndReschedule(e){const t=Date.now(),i=[],n=this._performanceMarksInGarbageCollection.filter((n=>{const s=window.performance.timeOrigin+n.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-s<this._performanceApiGarbageCollectorIntervalInMs)return!0;if(this._onTimeout){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n.name)||{};e.isTimeout=!0,this._onTimeout(e.logicalId,e)}return i.push(n),window.performance.clearMarks(n.name),window.performance.clearMeasures(n.name),this._measuresNames.delete(n.name),!1}));for(const e of i)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,n.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||(!e&&"requestIdleCallback"in window?this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs):this._garbageCollectionScheduler=window.setTimeout((()=>{this._clearAndReschedule()}),this._performanceApiGarbageCollectorIntervalInMs))}};d.END_SUFFIX="end",d=n=(0,s.__decorate)([(0,l._)()],d)},46788:(e,t,i)=>{i.d(t,{z:()=>h});var n=i(79490),s=i(29906),o=i(83010),r=i(45242),a=i(11804),l=i(10138),d=i(52041),c=i(728),u=i(85924);let h=class{constructor(e,t,i){this._logger=e,this._hostSettings=t,this._eventName="OASuggestionLoadTime",this._dataEventName="Data",this._performanceApiGarbageCollectorIntervalInMs=12e4,this._logToTelemetry=(e,t,i,n)=>{var s,o,a,l,d;const c=this._logger.getNewActivity(n||this._eventName,r.o.SamplingPolicy.CriticalExperimentation);if(c){for(const t of e)c.dataFields.push((0,u.n)(t.name,t.duration,void 0,r.o.DataFieldType.Double.valueOf()));c.dataFields.push(...(0,u.W)(["conversationId",null!==(s=null==t?void 0:t.conversationId)&&void 0!==s?s:""],["logicalId",null!==(o=null==t?void 0:t.logicalId)&&void 0!==o?o:""],["triggeringChar",null!==(a=null==t?void 0:t.triggerCharacter)&&void 0!==a?a:"@"],[this._dataEventName,JSON.stringify(Object.assign({isEmptyQuery:null===(l=null==t?void 0:t.isEmptyQuery)||void 0===l||l,dataSource:void 0,isAL:!0,workflow:"oa",logicalId:null==t?void 0:t.logicalId},i))],["queryLength",null!==(d=null==t?void 0:t.queryLength)&&void 0!==d?d:0])),c.success=!0,c.endNow()}},this.metric=new c.J(e,i,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry),this.setOnTimeout(((e="",t)=>{t&&this.commitEntry(e,"Timeout")}))}startEntry(e,t,i){var n;(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.e2eMetric)&&this.metric.startEntry(e,t,i)}setOnTimeout(e){var t;(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric)&&this.metric.setOnTimeout(e)}addMeasure(e,t,i){var n;(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.e2eMetric)&&this.metric.addMeasure(e,t,i)}commitEntry(e,t,i){var n;(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.e2eMetric)&&this.metric.commitEntry(e,t,i)}};h=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(l.g)),(0,n.__param)(1,(0,o.W)(a.n)),(0,n.__param)(2,(0,o.W)(d.j))],h)},85924:(e,t,i)=>{if(i.d(t,{W:()=>o,n:()=>s}),2063!=i.j)var n=i(45242);function s(e,t,i,s){return{name:e,value:t,dataType:(null!=s?s:"boolean"==typeof t)?n.o.DataFieldType.Boolean.valueOf():"number"==typeof t?n.o.DataFieldType.Int64.valueOf():n.o.DataFieldType.String.valueOf(),classification:null!=i?i:n.o.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,i,n])=>s(e,t,i,n)))}},59332:(e,t,i)=>{function n(e,t,i,n){return s((i=>e.requestAnimationFrame(i,t)),i,n)}function s(e,t,i){let n=!1,o=!1;const r=[];let a=!1;return()=>new Promise((async l=>{if("Immediately"===i){if(!n){n=!0;try{await t()}catch(e){}e((()=>{n=!1,l()}))}}else n?(a&&(o=!0),r.push(l)):(n=!0,e((async()=>{a=!0;try{await t()}catch(e){}a=!1,n=!1,l();for(const e of r)e();o&&(o=!1,s(e,t,i))})))}))}i.d(t,{ek:()=>s,hQ:()=>n})},97153:(e,t,i)=>{if(i.d(t,{_:()=>s}),2063!=i.j)var n=i(59332);class s{constructor(e){this.targetWindow=e,this.timeoutIds=[]}throttle(e,t,i){return(0,n.ek)((e=>{var i;const n=null===(i=this.targetWindow.deref())||void 0===i?void 0:i.setTimeout(e,t);n&&this.timeoutIds.push(n)}),e,i)}throttleUntilNextAnimationFrameAndAdditionalTime(e,t,i,s){return(0,n.ek)((t=>e.requestAnimationFrame((()=>{var e;const n=null===(e=this.targetWindow.deref())||void 0===e?void 0:e.setTimeout(t,i);n&&this.timeoutIds.push(n)}),this.targetWindow)),t,s)}dispose(){const e=this.targetWindow.deref();if(void 0!==e)for(const t of this.timeoutIds)e.clearTimeout(t);this.timeoutIds=[]}}},61599:(e,t,i)=>{function n(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const i=new URL(e),n=t.trim();return i.pathname.endsWith("/")?i.pathname+=n:i.pathname=`${i.pathname}/${n}`,i.toString()}i.d(t,{W:()=>n})},33511:(e,t,i)=>{var n,s;i.d(t,{E:()=>a,O:()=>r});class o{constructor(e){this[n]="WeakRef",this.weakMap=new WeakMap,this.weakMap.set(this,e)}deref(){return this.weakMap.get(this)}}n=Symbol.toStringTag;class r{constructor(e){this[s]="WeakRef","object"==typeof i.g&&i.g&&void 0===i.g.WeakRef?this.weakRef=new o(e):this.weakRef=new i.g.WeakRef(e)}deref(){return this.weakRef.deref()}}function a(e){return"WeakRef"===e[Symbol.toStringTag]}s=Symbol.toStringTag},80661:(e,t,i)=>{i.d(t,{y:()=>o});var n=i(79490),s=i(29906);let o=class{getUrl(e){return e}};o=(0,n.__decorate)([(0,s._)()],o)},23219:(e,t,i)=>{i.d(t,{k:()=>r});var n=i(79490),s=i(29906);class o{constructor(e){this._customWindow=e,this._timeouts=new Map,this._intervals=new Map}get targetWindow(){var e;return null!==(e=this._customWindow)&&void 0!==e?e:window}clearTimer(e){const t=this._timeouts.get(e);t&&(this.targetWindow.clearTimeout(t),this._timeouts.delete(e));const i=this._intervals.get(e);i&&(this.targetWindow.clearInterval(i),this._intervals.delete(e))}setInterval(e,t,i){this.clearTimer(e);const n=this.targetWindow.setInterval(t,i);return this._intervals.set(e,n),e}setIntervalWithDelay(e,t,i,n){this.clearTimer(e);const s=this.targetWindow.setTimeout((()=>{t();const n=this.targetWindow.setInterval(t,i);this._intervals.set(e,n)}),n);return this._timeouts.set(e,s),e}setTimeout(e,t,i){this.clearTimer(e);const n=this.targetWindow.setTimeout(t,i);return this._timeouts.set(e,n),e}async initialize(){}shutDown(){for(const e of this._timeouts.values())this.targetWindow.clearTimeout(e);for(const e of this._intervals.values())this.targetWindow.clearInterval(e);this._intervals.clear(),this._timeouts.clear()}}let r=class{constructor(){this._timer=new o}clearTimer(e){this._timer.clearTimer(e)}setInterval(e,t,i){return this._timer.setInterval(e,t,i)}setIntervalWithDelay(e,t,i,n){return this._timer.setIntervalWithDelay(e,t,i,n)}setTimeout(e,t,i){return this._timer.setTimeout(e,t,i)}async initialize(){}shutDown(){this._timer.shutDown()}};r=(0,n.__decorate)([(0,s._)()],r)},63201:(e,t,i)=>{if(i.d(t,{z:()=>s}),2063!=i.j)var n=i(61599);function s(e,t=""){const i=null===t?e:(0,n.W)(e,t);window.open(i,"_blank","noopener,noreferrer")}},56275:(e,t,i)=>{i.d(t,{ZL:()=>o,k_:()=>s,qy:()=>r});var n=i(76729);(0,n.f)("IOnCanvasKpiHelper");const s=(0,n.f)("ILoggerSettings"),o=(0,n.f)("IEditorSdkLogger"),r=((0,n.f)("IKpiTracker"),(0,n.f)("TelemetrySink"))},93790:(e,t,i)=>{if(i.d(t,{I6:()=>W,Yx:()=>z,cf:()=>B,fQ:()=>j,gs:()=>M,sb:()=>k}),2063!=i.j)var n=i(21711);if(2063!=i.j)var s=i(10138);if(2063!=i.j)var o=i(11804);if(2063!=i.j)var r=i(67843);if(2063!=i.j)var a=i(19470);if(2063!=i.j)var l=i(76778);if(2063!=i.j)var d=i(21522);if(2063!=i.j)var c=i(10219);if(2063!=i.j)var u=i(2915);if(2063!=i.j)var h=i(68794);if(2063!=i.j)var g=i(91513);if(2063!=i.j)var p=i(15844);if(2063!=i.j)var m=i(33999);if(2063!=i.j)var f=i(8694);if(2063!=i.j)var v=i(68914);if(2063!=i.j)var _=i(5923);if(2063!=i.j)var y=i(29583);if(2063!=i.j)var I=i(99261);if(2063!=i.j)var C=i(95490);if(2063!=i.j)var S=i(23943);if(2063!=i.j)var b=i(9583);if(2063!=i.j)var T=i(51719);if(2063!=i.j)var E=i(92165);if(2063!=i.j)var N=i(72232);if(2063!=i.j)var x=i(61871);if(2063!=i.j)var w=i(754);if(2063!=i.j)var L=i(25530);if(2063!=i.j)var D=i(16762);if(2063!=i.j)var F=i(94526);if(2063!=i.j)var A=i(80214);if(2063!=i.j)var R=i(30844);if(2063!=i.j)var q=i(50518);if(2063!=i.j)var P=i(85474);if(2063!=i.j)var O=i(58862);const k=e=>{e.bind(b.q).toDynamicValue((()=>()=>new R.j))},z=e=>{e.bind(m.WP).toDynamicValue((e=>{const t=e.get(n.G),i=e.get(s.g),u=e.get(E.t),h=e.get(N.B),g=e.get(f.k),p=e.get(_.G),m=e.get(S.w),C=e.get(w.d),b=e.get(o.n),T=e.get(r.H),x=e.get(a.W),F=e.get(v.d),A=e.get(I.W),R=e.getAll(l.zJ),P=e.getOptional(d.J),k=e.getOptional(y.M),z=e.get(c.c);return(e,n,s,o,r,a,l)=>{switch(e){case L.Z.OutlineNode:return new D.T(n,r,s,o,l);case L.Z.TerminalNode:return new q.x(n,s,o,l);case L.Z.TileNode:return new O.b(t,i,u,h,g,p,m,C,b,z,T,x,F,e,n,null!=a?a:A,s,R,k,o,l,P);default:throw Error(`This factory cannot build ${L.Z[e]}.`)}}}))},M=e=>{e.bind(m.Om).toDynamicValue((e=>{const t=e.get(n.G),i=e.get(S.w);return(e,n)=>new F.f(t,i,e,n)}))},j=e=>{e.bind(I.u).toDynamicValue((e=>{const t=e.get(u.K),i=e.get(m.Om),n=e.get(x.D),a=e.get(f.k),l=e.get(o.n),d=e.get(c.c),h=e.get(v.d),g=e.get(C.b),p=e.get(r.H),_=e.get(s.g),I=e.getOptional(y.M);return(e,s)=>new A.zR(t,i,n,a,l,d,h,g,p,_,I,e,s)}))},W=e=>{e.bind(p.q).toDynamicValue((()=>e=>new p.x(e)))},B=e=>{e.bind(T.kK).toDynamicValue((()=>()=>{const t=e.get(o.n),i=e.get(f.k),n=e.get(c.c),a=e.get(r.H),l=e.get(u.K),d=e.get(s.g),p=new h.I(l.getCachedEntry(g.l.ProofingLanguages).storeEntryValue),m=Object.assign(Object.assign(Object.assign(Object.assign({},n.flags),i),t),{paragraphDeltasEnabled:a.check()});return new P.$(m,p,d)}))}},9882:(e,t,i)=>{var n,s;i.d(t,{M:()=>n,s:()=>s}),function(e){e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange",e.TonalFRE="TonalFRE",e.ActionInlineSettingChange="ActionInlineSettingChange"}(n||(n={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(s||(s={}))},84549:(e,t,i)=>{if(i.d(t,{N:()=>a}),2063!=i.j)var n=i(33851);if(2063!=i.j)var s=i(39129);if(2063!=i.j)var o=i(51152);if(2063!=i.j)var r=i(11804);class a{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918409)}configureRootServices(e){e.bind(n.C).toDynamicValue((e=>{const t=e.get(r.n);return new s.t(t.defaultLocale)}))}}},76308:(e,t,i)=>{if(i.d(t,{I:()=>g}),2063!=i.j)var n=i(62514);if(2063!=i.j)var s=i(1976);if(2063!=i.j)var o=i(94372);if(2063!=i.j)var r=i(8332);if(2063!=i.j)var a=i(70243);if(2063!=i.j)var l=i(90014);if(2063!=i.j)var d=i(51152);if(2063!=i.j)var c=i(97446);if(2063!=i.j)var u=i(22696);if(2063!=i.j)var h=i(87117);class g{constructor(){this.imports=[a.l]}get uniqueId(){return(0,d.z)(507908323)}configureRootServices(e){e.bind(l.B).to(n.C),e.bind(c.S).toExisting(l.B),e.bind(r.v).toSelf(),e.bind(c.S).to(s.D),e.bind(c.S).to(o.n),e.bind(c.S).toExisting(u.s),e.bind(u.s).to(h.H)}}},70243:(e,t,i)=>{if(i.d(t,{l:()=>d}),2063!=i.j)var n=i(23928);if(2063!=i.j)var s=i(87309);if(2063!=i.j)var o=i(87582);if(2063!=i.j)var r=i(69936);if(2063!=i.j)var a=i(51152);if(2063!=i.j)var l=i(97446);class d{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507360220)}configureRootServices(e){e.bind(s.g).to(n.p),e.bind(l.S).toExisting(s.g),e.bind(o.D).toExisting(s.g),e.bind(r.p).toExisting(s.g)}}},13682:(e,t,i)=>{if(i.d(t,{Q:()=>d}),2063!=i.j)var n=i(74168);if(2063!=i.j)var s=i(88113);if(2063!=i.j)var o=i(43560);if(2063!=i.j)var r=i(754);if(2063!=i.j)var a=i(43565);if(2063!=i.j)var l=i(51152);class d{constructor(e){this.attachedToParagraphLevelDivs=e,this.imports=[]}get uniqueId(){return(0,l.z)(507918412)}configureRootServices(e){e.bind(r.d).to(this.attachedToParagraphLevelDivs?a.c:s.Z),e.bind(o.l).to(n.h)}}},40811:(e,t,i)=>{if(i.d(t,{V:()=>M}),2063!=i.j)var n=i(37573);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(97446);if(2063!=i.j)var r=i(93555);if(2063!=i.j)var a=i(9889);if(2063!=i.j)var l=i(57458);if(2063!=i.j)var d=i(96238);if(2063!=i.j)var c=i(52022);if(2063!=i.j)var u=i(11551);if(2063!=i.j)var h=i(61871);if(2063!=i.j)var g=i(3826);if(2063!=i.j)var p=i(92165);if(2063!=i.j)var m=i(80232);if(2063!=i.j)var f=i(72232);if(2063!=i.j)var v=i(97029);if(2063!=i.j)var _=i(68598);if(2063!=i.j)var y=i(68914);if(2063!=i.j)var I=i(4464);if(2063!=i.j)var C=i(75502);if(2063!=i.j)var S=i(99261);if(2063!=i.j)var b=i(95490);if(2063!=i.j)var T=i(15168);if(2063!=i.j)var E=i(83544);if(2063!=i.j)var N=i(23943);if(2063!=i.j)var x=i(7926);if(2063!=i.j)var w=i(73598);if(2063!=i.j)var L=i(21574);if(2063!=i.j)var D=i(42629);if(2063!=i.j)var F=i(80214);if(2063!=i.j)var A=i(17795);if(2063!=i.j)var R=i(53861);if(2063!=i.j)var q=i(64355);if(2063!=i.j)var P=i(86314);if(2063!=i.j)var O=i(96667);if(2063!=i.j)var k=i(35400);if(2063!=i.j)var z=i(93790);class M{constructor(){this.imports=[n.A]}get uniqueId(){return(0,s.z)(507918410)}configureRootServices(e){e.bind(S.W).to(F.zR),(0,z.sb)(e),(0,z.Yx)(e),(0,z.gs)(e),(0,z.fQ)(e),(0,z.I6)(e),(0,z.cf)(e),e.bind(_.V).to(r.C),e.bind(L.j).to(O.o),e.bind(E.b).to(q.y),e.bind(w.o).to(w.v),e.bind(x.k).toTransient(x.h),e.bind(C.Y).to(C.B),e.bind(y.d).to(a.m),e.bind(b.b).to(A.S),e.bind(N.w).to(P.D),e.bind(o.S).toExisting(N.w),e.bind(o.S).to(k.j),e.bind(T.b).to(R.o),e.bind(I.n).to(D.C),e.bind(l.hN).to(d.F),e.bind(l.c0).to(c.a),e.bind(l.pT).to(u.R),e.bind(l.b0).to(u.R),e.bind(h.D).to(g._n),e.bind(p.t).to(m.a),e.bind(f.B).to(v.M)}}},27459:(e,t,i)=>{i.d(t,{$:()=>c});var n=i(79490),s=i(1527),o=i(71924),r=i(13290),a=i(45242),l=i(9882),d=i(29906);let c=class{constructor(e,t,i){this._mutationObserverFactory=e,this.elementTransformers=t,this._logger=i,this.connectMutationObserver=(e,t,i,n)=>{this._mutationObserver=this._mutationObserverFactory((e=>{e.forEach(((e,r,a)=>{const l=null==n?void 0:n.filterSelector;let d=!1;t.ignoredMutationElementsSelectors&&(0,s.C)(e.target,"Element")&&(d=e.target.matches(t.ignoredMutationElementsSelectors)),l&&l!==e.target.nodeName&&d||this.handleMutation(e,o.Q0.Local,null==i?void 0:i(e,r,a))}))})),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach(((t,i,n)=>this.handleMutation(t,o.Q0.Local,e?e(t,i,n):void 0)))},this.handleMutation=(e,t,i)=>{var n;try{const n=this.onElementRemoved,s=this.onElementAdded,o=this.onElementChanged;switch(e.type){case"childList":if(n){Array.from(e.removedNodes).forEach((e=>{n(e,t,i)}))}if(s){Array.from(e.addedNodes).forEach((e=>{s(e,t,i)}))}break;case"characterData":o&&o(e.target,t);break;case"attributes":this.handleAttributeChange(e,t,s,o,n)}}catch(e){null===(n=this._logger)||void 0===n||n.logEvent(508146690,l.s.MutationError,r.q.Error,"Error while processing a mutation.",a.o.SamplingPolicy.CriticalBusinessImpact,e)}}}handleAttributeChange(e,t,i,n,s){const o=e.attributeName,r=e.target;this.elementTransformers&&o&&this.elementTransformers.forEach((e=>{e.attributeList.includes(o)&&e.transform(r)})),null==n||n(r,t,void 0)}disconnect(e){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};c=(0,n.__decorate)([(0,d._)()],c)},23381:(e,t,i)=>{i.d(t,{P:()=>u});var n=i(79490),s=i(11804),o=i(10138),r=i(29906),a=i(83010),l=i(27603),d=i(80465),c=i(27459);let u=class extends c.${constructor(e,t,i){super(e,void 0,i),this.mutationObserverFactory=e,this.hostSettings=t,this.logger=i}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,ignoredMutationElementsSelectors:this.hostSettings.ignoredMutationElementsSelectors})}};u=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(d.V)),(0,n.__param)(1,(0,a.W)(s.n)),(0,n.__param)(2,(0,l.l)()),(0,n.__param)(2,(0,a.W)(o.g))],u)},49878:(e,t,i)=>{i.d(t,{o:()=>f});var n=i(79490),s=i(9882),o=i(27459),r=i(71924),a=i(13290),l=i(45242),d=i(98970),c=i(10138),u=i(22923),h=i(80465),g=i(29906),p=i(83010),m=i(27603);let f=class extends o.${constructor(e,t,i){super(e,null==i?void 0:i.elementTransformers,t),this.mutationObserverFactory=e,this._logger=t,this._lastCharacterModificationReplacedCharacters=!1,this.connectMutationObserver=(e,t,i)=>{this._mutationObserver=this._mutationObserverFactory((e=>{var t;let n=!1,o=!1;for(let d=0;d<e.length;d++){const c=e[d],u=e;try{const e=this.onElementRemoved,t=this.onElementAdded,s=this.onElementChanged;switch(c.type){case"childList":if(e){const t=Array.from(c.removedNodes);t.length&&!o&&(e(t.pop(),r.Q0.Local,void 0),o=!0)}if(t){const e=Array.from(c.addedNodes);e.length&&!n&&(t(e.pop(),r.Q0.Local,null==i?void 0:i(c,d,u)),n=!0)}break;case"characterData":s&&s(c.target,r.Q0.Local,void 0,this._lastCharacterModificationReplacedCharacters);break;case"attributes":this.handleAttributeChange(c,r.Q0.Local,t,s,e)}}catch(e){null===(t=this._logger)||void 0===t||t.logEvent(508146694,s.s.MutationError,a.q.Error,"Error while processing a mutation.",l.o.SamplingPolicy.CriticalBusinessImpact,e)}finally{this._lastCharacterModificationReplacedCharacters=!1}}})),this._mutationObserver.observe(e,t),this.eventListener=new d.J(e),this.eventListener.addListener("keypress",this.onKeyPress,{passive:!0,capture:!0})},this.onKeyPress=e=>{const t=e.currentTarget.ownerDocument.getSelection();(null==t?void 0:t.toString().startsWith(e.key))?this._lastCharacterModificationReplacedCharacters=!0:this._lastCharacterModificationReplacedCharacters=!1},this._mutationContextBuilder=null==i?void 0:i.mutationContextBuilder,this.elementTransformers=null==i?void 0:i.elementTransformers}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)for(const i of t.attributeList)e.add(i);e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder),this._styleChangeObserver=this.mutationObserverFactory((e=>{this.onVisualStateChanged&&e.length>0&&this.onVisualStateChanged(e[0].target,"StyleChange")})),this._styleChangeObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]})}disconnect(e){var t,i,n;super.disconnect(e),null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,null===(i=this._styleChangeObserver)||void 0===i||i.takeRecords(),null===(n=this._styleChangeObserver)||void 0===n||n.disconnect()}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(h.V)),(0,n.__param)(1,(0,m.l)()),(0,n.__param)(1,(0,p.W)(c.g)),(0,n.__param)(2,(0,m.l)()),(0,n.__param)(2,(0,p.W)(u.Bc))],f)},95685:(e,t,i)=>{i.d(t,{D:()=>g});var n=i(79490),s=i(27459),o=i(71924),r=i(1527),a=i(98970),l=i(10138),d=i(80465),c=i(29906),u=i(83010),h=i(27603);let g=class extends s.${constructor(e,t){super(e,void 0,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;t&&this._element&&t(this._element,o.Q0.Local,void 0)}}observe(e){var t;((0,r.C)(e,"HTMLInputElement")||(0,r.C)(e,"HTMLTextAreaElement")||(0,r.C)(e,"HTMLDivElement"))&&(this._element=e,null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=new a.J(e),this.eventListener.addListener("input",this._onElementChangedEvent,{passive:!0}),this.eventListener.addListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(e){var t;null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,super.disconnect(e),this._element=void 0}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(d.V)),(0,n.__param)(1,(0,h.l)()),(0,n.__param)(1,(0,u.W)(l.g))],g)},33931:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(76729).f)("IHostModelPersistedStore")},57595:(e,t,i)=>{function n(e,t){e.isApplying||e.suggestions[0].text&&(null==t||t.addWordToIgnoreList(e.suggestions[0].text,!0))}i.d(t,{yf:()=>n})},62514:(e,t,i)=>{i.d(t,{C:()=>b});var n=i(79490),s=i(8332),o=i(11804),r=i(10219),a=i(29906),l=i(83010),d=i(66008),c=i(27603),u=i(76729);const h=(0,u.f)("ISelectedCritiqueCategory");let g=class{constructor(e){this._selectedCritiqueCategory=e}filter(e){return!!e&&(!this._selectedCritiqueCategory.isAnyCategorySelected()||void 0!==e.categoryTitle&&this._selectedCritiqueCategory.isCritiqueCategorySelected(e.categoryTitle))}};g=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(h))],g);var p=i(98085);(0,u.f)("StealthSquiggleEnabledCritiqueTypesArray");const m=(0,u.f)("IStealthSquiggleEnabledCritiqueTypes");var f=i(95523),v=i(87309),_=i(71417);let y=class{constructor(e,t,i){this._enabledCritiqueTypes=e,this._upsellStore=t,this._hostSettings=i}filter(e){var t,i;let n=!0;if(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser){const t=null!==(i=e.typeId)&&void 0!==i?i:"";this._enabledCritiqueTypes.isCritiqueTypePremium(t)&&(this._hostSettings.enableOrchestration&&this._upsellStore.addPremiumCritique((0,f.OE)(e)),n=this._upsellStore.previewPremiumSquiggles)}return n}};y=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(v.g)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(1,(0,l.W)(_.Ey)),(0,n.__param)(2,(0,l.W)(o.n))],y);var I=i(79343);const C=(0,u.f)("ISpellingSettingsStore");let S=class{constructor(e){this._spellingSettingsStore=e}filter(e){var t;if(!e)return!1;if(e.priority!==I.bx.High||!this._spellingSettingsStore.isSpellingDisabledForAnyLanguage())return!0;const i=[];for(const n of e.suggestions){const e=null!==(t=n.languages)&&void 0!==t?t:[];n.languages=e.filter((e=>this._spellingSettingsStore.isSpellingEnabledForLanguage(e))),n.languages.length&&i.push(n)}return e.suggestions=i,!!i.length}};S=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(C))],S);let b=class{constructor(e,t,i,n,s,o,r,a){this._dictionaryCritiqueFilter=e,this._basicCritiqueFilters=t,this._hostSettings=i,this._featureFlagsReader=n,this._premiumCritiqueFilter=s,this._spellingCritiqueFilter=o,this._categoryCritiqueFilter=r,this._stealthSquiggleEnabledCritiqueTypes=a,this._critiqueFilters=[]}async initialize(){this._critiqueFilters.push(this._dictionaryCritiqueFilter),!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableCritiqueSettings&&this._spellingCritiqueFilter&&this._critiqueFilters.push(this._spellingCritiqueFilter),this._critiqueFilters.push(...this._basicCritiqueFilters),this._hostSettings.enhancedUpsellEnabled&&this._premiumCritiqueFilter&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._categoryCritiqueFilter&&this._critiqueFilters.push(this._categoryCritiqueFilter)}shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){if(!e)return[];return e.filter((e=>{var t,i,n;const s=e.isVisible,o=e.isStealth;let r=!0;const a=null!==(n=null===(t=this._stealthSquiggleEnabledCritiqueTypes)||void 0===t?void 0:t.isCritiqueTypeEnabled(null!==(i=e.typeId)&&void 0!==i?i:"",e.priority))&&void 0!==n&&n;for(const t of this._critiqueFilters)if(r=t.filter(e),!r)break;return e.isVisible=r,e.isStealth=a,e.isVisible!==s||e.isStealth!==o}))}};b=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(s.v)),(0,n.__param)(1,(0,d.t)(p.D)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(2,(0,l.W)(o.n)),(0,n.__param)(3,(0,l.W)(r.c)),(0,n.__param)(4,(0,c.l)()),(0,n.__param)(4,(0,l.W)(y)),(0,n.__param)(5,(0,c.l)()),(0,n.__param)(5,(0,l.W)(S)),(0,n.__param)(6,(0,c.l)()),(0,n.__param)(6,(0,l.W)(g)),(0,n.__param)(7,(0,c.l)()),(0,n.__param)(7,(0,l.W)(m))],b)},1976:(e,t,i)=>{i.d(t,{D:()=>I});var n=i(79490),s=i(9882),o=i(13290),r=i(45242),a=i(18104),l=i(71924),d=i(95834),c=i(2915),u=i(11804),h=i(77322),g=i(10138),p=i(55972),m=i(5923),f=i(23943),v=i(29906),_=i(83010),y=i(89266);let I=class{constructor(e,t,i,n,d,c,u,h){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=i,this._proofingPersistedStore=n,this._hostSettings=d,this._userInfoStrategy=c,this._logger=u,this._e2eMetric=h,this._websiteProvedOnce=!1,this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(536978384,s.s.UpdateCritiqueException,o.q.Error,"Error while updating critiques on the shadow graph.",r.o.SamplingPolicy.CriticalBusinessImpact,e)}},this.updateCritiques=e=>{const t=e.data,i=new Map,n=[],s=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;s.has(t)||(this._e2eMetric.commitEntry(t),s.add(t));const o=i.get(e.tileId.nodeId);if(o)o.push(e);else{i.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&n.push(t)}}n.length&&this._nodePoller.pollNodes(a.G.NewData,n,l.Q0.Code,void 0,!1,i)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}shutDown(){}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===a.G.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,(0,y.Q)(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}};I=(0,n.__decorate)([(0,v._)(),(0,n.__param)(0,(0,_.W)(f.w)),(0,n.__param)(1,(0,_.W)(d.o)),(0,n.__param)(2,(0,_.W)(m.G)),(0,n.__param)(3,(0,_.W)(c.K)),(0,n.__param)(4,(0,_.W)(u.n)),(0,n.__param)(5,(0,_.W)(h.e)),(0,n.__param)(6,(0,_.W)(g.g)),(0,n.__param)(7,(0,_.W)(p.m))],I)},8332:(e,t,i)=>{i.d(t,{v:()=>l});var n=i(79490),s=i(79343),o=i(29906),r=i(83010),a=i(22696);let l=class{constructor(e){this._wordDictionary=e}filter(e){return!!e.textInContext&&(e.typeId===s.L9.CIQFlag_DateEntityRecognition||e.typeId===s.L9.CIQFlag_PersonEntityRecognition||e.typeId===s.L9.CIQFlag_Location||e.typeId===s.L9.CIQFlag_Time||e.typeId===s.L9.CIQFlag_LocalBusiness||e.typeId===s.L9.CIQFlag_TaskRecognition||e.typeId===s.L9.CIQFlag_Topic||e.typeId===s.L9.CIQFlag_SatoriEntityRecognition||e.typeId===s.L9.CIQFlag_File||!this._wordDictionary.isWordIgnored(e.textInContext)&&!e.wasAddedToDictionaryInCurrentSession)}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(a.s))],l)},42286:(e,t,i)=>{i.d(t,{p:()=>m});var n=i(79490),s=i(91513),o=i(76778),r=i(18104),a=i(71924),l=i(10138),d=i(2915),c=i(11804),u=i(5923),h=i(23943),g=i(29906),p=i(83010);let m=class{constructor(e,t,i,n,o,r){this._logger=e,this._proofingDom=t,this._proofingPersistedStore=i,this._nodePoller=n,this._hostEmitter=o,this._hostSettings=r,this.getLocalesForSameLanguage=async e=>{var t,i,n,o;const r=[],a=await this._proofingPersistedStore.read(s.l.ProofingLanguages),l=e.suggestions.length&&(null===(t=e.suggestions[0].languages)||void 0===t?void 0:t.length)?e.suggestions[0].languages[0]:null!==(o=null!==(i=a[0])&&void 0!==i?i:null===(n=this._hostSettings.proofingLocales)||void 0===n?void 0:n[0])&&void 0!==o?o:this._hostSettings.defaultLocale;if(l){const e=l.split("-")[0];for(const t of a)e===t.split("-")[0]&&r.push(t)}else this._logger.error(557953868,"Expected language in ISuggestion or the list of Proofing Languages");return r}}async disableCritique(e){if(void 0===e.typeId)return;const t=await this._proofingPersistedStore.read(s.l.OverriddenCritiqueTypeOptions);let i=!1;for(const n of t)n.id===e.typeId&&(n.value="0",i=!0);if(!i){const i=await this.getLocalesForSameLanguage(e);for(const n of i)t.push({id:e.typeId,languageId:n,name:"",value:"0"})}await this._proofingPersistedStore.write(s.l.OverriddenCritiqueTypeOptions,t),this._hostEmitter.emit(o.pD.critiqueSettingsChange,{address:void 0,message:t}),this._nodePoller.pollNodes(r.G.ChangeData,this._proofingDom.tileNodes,a.Q0.Code),this._onDisableCritique&&this._onDisableCritique(e.typeId)}setOnDisableCritique(e){this._onDisableCritique=e}};m=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(l.g)),(0,n.__param)(1,(0,p.W)(h.w)),(0,n.__param)(2,(0,p.W)(d.K)),(0,n.__param)(3,(0,p.W)(u.G)),(0,n.__param)(4,(0,p.W)(o.M5)),(0,n.__param)(5,(0,p.W)(c.n))],m)},23928:(e,t,i)=>{i.d(t,{p:()=>f});var n=i(79490),s=i(91513),o=i(76778),r=i(79343),a=i(2915),l=i(11804),d=i(29906),c=i(83010),u=i(10138);const h="19a112ec-21fd-432a-9d1f-195e5e94a00b";let g=class{constructor(e,t,i){this._hostEmitter=e,this._logger=t,this._proofingPersistedStore=i,this._hasSpellingBeenDisabled=!1,this._spellingSettings=new Set,this._readSpellingSettings=async e=>{const t=new Set;for(const i of e)i.id===h&&"0"===i.value&&(i.languageId?t.add(i.languageId):this._logger.error(545067014,"Undefined languageId in Spelling overriddenCritiqueTypeOption"));this._spellingSettings=t},this._updateSpellingSettings=async e=>{const t=e.message;await this._readSpellingSettings(t)}}async initialize(){const e=await this._proofingPersistedStore.read(s.l.OverriddenCritiqueTypeOptions);await this._readSpellingSettings(e),this._hostEmitter.on(o.pD.critiqueSettingsChange,this._updateSpellingSettings)}shutDown(){}isSpellingDisabledForAnyLanguage(){const e=this._spellingSettings.size>0;return e&&(this._hasSpellingBeenDisabled=!0),this._hasSpellingBeenDisabled||e}isSpellingEnabledForLanguage(e){return!this._spellingSettings.has(e)}};g=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(o.M5)),(0,n.__param)(1,(0,c.W)(u.g)),(0,n.__param)(2,(0,c.W)(a.K))],g);var p=i(93443);function m(e,t,i,n){var s,o,a;e.set(r.L9.ContextualSpelling,1),e.set(r.L9.WrongSpelling,1),(null===(s=null==n?void 0:n.taskRecognition)||void 0===s?void 0:s.enabled)&&e.set(r.L9.CIQFlag_TaskRecognition,1),(null===(o=null==n?void 0:n.headingDetection)||void 0===o?void 0:o.enabled)&&e.set(r.L9.HeadingDetection,1),(null===(a=null==n?void 0:n.flagAnnotationSettings)||void 0===a?void 0:a.enabled)&&(e.set(r.L9.CIQFlag_Location,1),e.set(r.L9.CIQFlag_File,1),e.set(r.L9.CIQFlag_Time,1),e.set(r.L9.CIQFlag_LocalBusiness,1),e.set(r.L9.CIQFlag_Topic,1),e.set(r.L9.CIQFlag_SatoriEntityRecognition,1),e.set(r.L9.CIQFlag_DateEntityRecognition,1),e.set(r.L9.CIQFlag_PersonEntityRecognition,1));for(const n of t){const t=n.toLowerCase();"mc-officeeditortonalenabled"===t&&i===p.G_.Subscription?e.set(r.L9.TonalRewrite,1):"csi-editor-topicsuggestions"===t&&e.set(r.L9.TopicSuggestion,1)}}let f=class{constructor(e,t,i){var n;this._proofingPersistedStore=e,this._hostSettings=t,this._hostEmitter=i,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map,this._premiumCritiqueTypes=new Map,this._ciqFlagsEnabled=!0,this.critiqueSettingsChange=e=>{this.setOverriddenCritiqueTypes(e.message)},this.ciqSettingsChange=e=>{this._ciqFlagsEnabled=e.message.ciqFlagsEnabled};const o=this._proofingPersistedStore.getCachedEntry(s.l.OverriddenCritiqueTypeOptions);m(this._availableCritiqueTypes,null!==(n=this._hostSettings.flightsToTrack)&&void 0!==n?n:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this.setOverriddenCritiqueTypes(o.storeEntryValue),o.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async initialize(){this._hostEmitter.on(o.pD.critiqueSettingsChange,this.critiqueSettingsChange),this._hostEmitter.on(o.pD.ciqSettingsChange,this.ciqSettingsChange)}shutDown(){}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(s.l.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e,t){if((0,r.oe)(e)&&!this._ciqFlagsEnabled)return!1;const i=this._availableCritiqueTypes.get(e);let n=this._overriddenCritiqueTypes.get(e);if(this._critiqueToCategoryIdMap){const i=t===r.bx.High?h:this._critiqueToCategoryIdMap.get(e);if(i){0===this._overriddenCritiqueTypes.get(i)&&(n=0)}}return void 0===n?1===i:1===n}isCritiqueTypePremium(e){return e===r.L9.TonalRewrite||(this._hostSettings.enableOrchestration?1===this._premiumCritiqueTypes.get(e):1!==this._availableCritiqueTypes.get(e))}setOverriddenCritiqueTypes(e){if(e){this._overriddenCritiqueTypes.clear();for(const t of e)this._overriddenCritiqueTypes.set(t.id,parseInt(t.value,10))}}setAvailableCritiqueTypes(e,t){var i;if(e){this._availableCritiqueTypes.clear(),m(this._availableCritiqueTypes,null!==(i=this._hostSettings.flightsToTrack)&&void 0!==i?i:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this._critiqueToCategoryIdMap=t;for(const t of e)this._availableCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}setPremiumCritiqueTypes(e){if(e){this._premiumCritiqueTypes.clear();for(const t of e)this._premiumCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}};f=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(a.K)),(0,n.__param)(1,(0,c.W)(l.n)),(0,n.__param)(2,(0,c.W)(o.M5))],f)},72082:(e,t,i)=>{i.d(t,{H:()=>m});var n=i(79490),s=i(79343),o=i(91513),r=i(40200),a=i(2915),l=i(29906),d=i(83010),c=i(27603),u=i(87309),h=i(67165),g=i(27634),p=i(71417);let m=class{constructor(e,t,i,n,s,o){this._enabledCritiqueTypes=e,this._paneEnabledCritiqueTypes=t,this._paneOpenState=i,this._proofingPersistedStore=n,this._upsellStore=s,this._indicatorStore=o}filter(e){return this.addCritiqueToIndicatorMapIfNeeded(e),void 0!==e.typeId&&this.isCritiqueCategoryEnabled(e.priority)&&this.isCritiqueTypeEnabled(e.typeId,e.priority)||e.typeId===s.L9.TopicSuggestion}isCritiqueCategoryEnabled(e){var t;return e===s.bx.High&&!!this._proofingPersistedStore.getCachedEntry(o.l.EnableSpelling).storeEntryValue||e===s.bx.Medium&&!!this._proofingPersistedStore.getCachedEntry(o.l.EnableGrammar).storeEntryValue||e===s.bx.Low&&((null===(t=this._upsellStore)||void 0===t?void 0:t.previewPremiumSquiggles)||!!this._proofingPersistedStore.getCachedEntry(o.l.EnableRefinements).storeEntryValue)||e===s.bx.Informational}isCritiqueTypeEnabled(e,t){var i,n;const s=void 0!==this._paneOpenState,o=s&&(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen)&&(null===(n=this._paneEnabledCritiqueTypes)||void 0===n?void 0:n.isCritiqueTypeEnabled(e,t));return this._enabledCritiqueTypes.isCritiqueTypeEnabled(e,t)||o||!!this._upsellStore&&(!s||this._upsellStore.previewPremiumSquiggles)&&this._enabledCritiqueTypes.isCritiqueTypePremium(e)}addCritiqueToIndicatorMapIfNeeded(e){var t,i;if(!(e.typeId&&e.traceId&&this._paneEnabledCritiqueTypes&&this._indicatorStore))return;const n=e.priority===s.bx.Low,o=this.isCritiqueCategoryEnabled(e.priority)||(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser)&&n,r=this._paneEnabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority),a=this._enabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority);let l=!0;e.typeId!==s.L9.TopicSuggestion&&e.typeId!==s.L9.CIQFlag_Topic||(l=e.isVisible),o&&(r||a)&&l&&this._indicatorStore.addPaneCritique(e.traceId,n,e.categoryTitle,r&&!a&&!(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen))}};m=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.g)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(1,(0,d.W)(g.M)),(0,n.__param)(2,(0,c.l)()),(0,n.__param)(2,(0,d.W)(r.F)),(0,n.__param)(3,(0,d.W)(a.K)),(0,n.__param)(4,(0,c.l)()),(0,n.__param)(4,(0,d.W)(p.Ey)),(0,n.__param)(5,(0,c.l)()),(0,n.__param)(5,(0,d.W)(h.y))],m)},89732:(e,t,i)=>{i.d(t,{t:()=>o});var n=i(79490),s=i(29906);let o=class{setOnFeedbackIconClicked(e){this._onFeedbackIconClicked=e}feedbackIconClicked(e,t){this._onFeedbackIconClicked&&this._onFeedbackIconClicked(e,t)}};o=(0,n.__decorate)([(0,s._)()],o)},98085:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(76729).f)("ICritiqueFilters")},90014:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(76729).f)("ICritiqueFilterer")},3049:(e,t,i)=>{i.d(t,{A_:()=>_,MG:()=>v,W:()=>c,dP:()=>m,dt:()=>g,ht:()=>u,qB:()=>h,r:()=>d,r6:()=>p});var n=i(79490),s=i(79343),o=i(95523),r=i(13849),a=i(76729),l=i(29906);(0,a.f)("ICritiqueInterpreter");function d(e){const t=[s.L9.ContextualSpelling,s.L9.WrongSpelling];return!!e&&e.typeId!==s.L9.Synonyms&&(e.priority===s.bx.High||!!e.typeId&&t.includes(e.typeId))}function c(e){return!!e&&e.typeId===s.L9.TopicSuggestion}function u(e){return!0===("number"==typeof e.supportedActions?(0,o.z5)(e.supportedActions):e.supportedActions).delete}function h(e){const t="number"==typeof e.action?(0,r.fO)(e.action):e.action;return!0===t.changeAll||!0===t.changeOnce||!0===t.autoCorrect||!0===t.personalizedAutoCorrect}function g(e){return!!e&&(u(e)&&!e.suggestions.some((e=>h(e))))}function p(e){return(null==e?void 0:e.typeId)===s.L9.TonalRewrite}function m(e){return!0===("number"==typeof e.action?(0,r.fO)(e.action):e.action).personalizedAutoCorrect}function f(e){for(const t of e.suggestions)if(4===t.action)return t}function v(e){for(const t of e.suggestions)if(!0===t.action.autoCorrect)return t}function _(e){return!!f(e)}let y=class{isSpellingCritique(e){return!!e&&d({priority:e.priority,typeId:(0,s.e3)(e.typeId)})}isTopicSuggestionCritique(e){return!!e&&c({typeId:(0,s.e3)(e.typeId)})}isDeleteActionAvailable(e){return u(e)}isChangeActionAvailable(e){return h(e)}isRepeatedWord(e){return g(e)}isRewrite(e){return p({typeId:(0,s.e3)(e.typeId)})}isPersonalized(e){return m(e)}hasAtLeastOneSynonym(e){return function(e){return e.suggestions.some((e=>function(e){const t=/\[(.*)\]/g;return!!e.description&&!e.description.match(t)}(e)))}(e)}getAutoCorrectionSuggestion(e){return f(e)}};y=(0,n.__decorate)([(0,l._)()],y)},45311:(e,t,i)=>{i.d(t,{W:()=>n});const n=(0,i(76729).f)("IDisableCritiqueHandler")},87309:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(76729).f)("IEnabledCritiqueTypes")},87582:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(76729).f)("IEnabledCritiqueTypesSetter")},69936:(e,t,i)=>{i.d(t,{p:()=>n});const n=(0,i(76729).f)("IEnabledPremiumCritiqueTypes")},16087:(e,t,i)=>{i.d(t,{M:()=>s,g:()=>o});var n=i(76729);const s=(0,n.f)("IFeedbackStore"),o=(0,n.f)("IFeedbackStoreFactory")},67165:(e,t,i)=>{i.d(t,{y:()=>n});const n=(0,i(76729).f)("IIndicatorStore")},27634:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(76729).f)("IPaneOnlyEnabledCritiqueTypes")},39593:(e,t,i)=>{i.d(t,{S:()=>n});const n=(0,i(76729).f)("IShadowElementsStore")},71417:(e,t,i)=>{i.d(t,{Ey:()=>r,mq:()=>n,nz:()=>s});var n,s,o=i(76729);!function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(n||(n={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(s||(s={}));const r=(0,o.f)("IUpsellStore")},22696:(e,t,i)=>{i.d(t,{s:()=>n});const n=(0,i(76729).f)("IWordDictionary")},48145:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(79490),s=i(29906);const o=String.fromCharCode(65532);let r=class{constructor(){}filter(e){var t;return!(null===(t=e.textInContext)||void 0===t?void 0:t.includes(o))}};r=(0,n.__decorate)([(0,s._)()],r)},89266:(e,t,i)=>{if(i.d(t,{Q:()=>a}),2063!=i.j)var n=i(91513);if(2063!=i.j)var s=i(85924);if(2063!=i.j)var o=i(45242);if(2063!=i.j)var r=i(9882);const a=(e,t,i,a)=>{if(!e||!t)return;const l=e.getNewActivity(r.M.WebSiteProvedOnce,o.o.SamplingPolicy.CriticalBusinessImpact),d=t.getCachedEntry(n.l.ProofingLanguages).storeEntryValue;let c;a.execute(!1,(e=>(c=null==e?void 0:e.regionScope,e))),l&&(l.dataFields.push(...(0,s.W)(["Proofing_Languages",d.join(",")],["Region_Scope",null!=c?c:"unknown"],["IsAL",!0===i.enableOrchestration&&i.orchestratorSettings&&!0===i.orchestratorSettings.enableAugLoop||!1])),l.success=!0,l.endNow())}},87117:(e,t,i)=>{i.d(t,{H:()=>f});var n,s=i(79490),o=i(18104),r=i(71924);!function(e){e.IgnoreListUpdate="IgnoreListUpdate",e.CustomDictionaryUpdate="CustomDictionaryUpdate"}(n||(n={}));var a=i(23957),l=i(95834),d=i(11804),c=i(48129),u=i(5923),h=i(23943),g=i(29906),p=i(83010),m=i(27603);let f=class{constructor(e,t,i,s,a,l){this._proofingDom=e,this._proofingEmitter=t,this.hostSettings=s,this._roamingDictionaryFeature=a,this._roamingDictionaryBroker=l,this._ignoredWords=new Set,this.isWordIgnored=e=>{var t;const i=e.trim();if(this._ignoredWords.has(i))return!0;return!!(null===(t=this._roamingDictionaryFeature.getRoamingDictionary())||void 0===t?void 0:t.testWord(i,!0))},this.clearIgnoredWords=()=>{var e;this._ignoredWords.clear(),null===(e=this._nodePoller)||void 0===e||e.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,r.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:o.G.RemoveData,data:n.IgnoreListUpdate})},this.addWordToIgnoreList=(e,t=!1)=>{this.addWordsToIgnoreList([e],t)},this.addWordsToIgnoreList=(e,t=!1)=>{var i;let s=!1;for(let t=0;t<e.length;t++){const i=e[t];if(i){const e=i.trim();if(this._ignoredWords.has(e))continue;this._ignoredWords.add(e),s=!0}}s&&!t&&(null===(i=this._nodePoller)||void 0===i||i.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,r.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:o.G.NewData,data:n.IgnoreListUpdate}))},this.addWordToCustomDictionary=e=>{var t,i;if(e){if(this.hostSettings.enableV2RoamingDictionary&&(null===(t=this._roamingDictionaryBroker)||void 0===t?void 0:t.isRoamingDictionaryReady))return this._roamingDictionaryBroker.addWordToRoamingDictionary(e),!0;{const t=e.trim();if(this.roamingDictionary&&this._roamingDictionaryFeature.isReady()){return!!this.roamingDictionary.addWord(t)&&(null===(i=this._nodePoller)||void 0===i||i.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,r.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:o.G.NewData,data:n.CustomDictionaryUpdate}),!0)}}}return!1},this._nodePoller=s.enableOrchestration?void 0:i}get roamingDictionary(){if(this.hostSettings.enableRoamingDictionary)return this._roamingDictionaryFeature.getRoamingDictionary()}async initialize(){this.hostSettings.enableRoamingDictionary&&this._roamingDictionaryFeature.emitAndEvaluate({eventId:a.U1.ClientInitialized,sender:a.FS.WordDictionaryInit})}shutDown(){}get roamingDictionaryEnabled(){var e;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!this._roamingDictionaryFeature.isReady()}};f=(0,s.__decorate)([(0,g._)(),(0,s.__param)(0,(0,p.W)(h.w)),(0,s.__param)(1,(0,p.W)(l.o)),(0,s.__param)(2,(0,p.W)(u.G)),(0,s.__param)(3,(0,p.W)(d.n)),(0,s.__param)(4,(0,p.W)(a.Zp)),(0,s.__param)(5,(0,m.l)()),(0,s.__param)(5,(0,p.W)(c.C))],f)},85474:(e,t,i)=>{i.d(t,{$:()=>N});var n=i(59556),s=i(71924),o=i(18104),r=i(69811),a=i(81628),l=i(79343),d=i(65798),c=i(70807);class u{constructor(e,t){this.id=(0,c.h)(),this.range=e,this.parent=t,t.registerChild(this)}retire(){var e;null===(e=this.parent)||void 0===e||e.unregisterChild(this),this.parent=void 0}move(e,t){return e&&(this.range=e),t&&(this.parent=t),this.id=(0,c.h)(),this}}var h=i(3826),g=i(52022),p=i(96238),m=i(11551);function f(e,t=!1){switch(e){case d.fT.Sentence:return new p.F({newLineSentenceSeparatorEnabled:t});case d.fT.Paragraph:return new g.a;default:return new m.R}}var v=i(97029),_=i(80232),y=i(81090),I=i(3033);class C extends n.z{constructor(e,t){super(),this._settings=e,this._logger=t}updateSettings(e){this._settings=e}updateParagraphNodes(e,t,i,n,s,o,r){if(!this._settings.enableOrchestration||!this._settings.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,i,n,s);const a={oldTextInfo:t,newTextInfo:i,tileNode:e,sequenceId:s,minDiffBounds:n,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(a),this._addNewChildren(a),this._buildGraphTransaction(a,o,r),a.graphTransaction}_updateExistingChildren(e){var t,i;if(!e.tileNode.children.length)return;const n=null!==(i=null===(t=e.oldTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"",s=e.newTextInfo.content,o=n!==s,r={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let a=e.tileNode.children.length-1;for(;a>=0;){const t=e.tileNode.children[a].range;if(n.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=s.length-n.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!o)){t.offset<e.minDiffBounds.firstDiffLeft&&(r.firstDiffLeft=Math.min(t.offset,r.firstDiffLeft));const i=n.length-t.offset-t.span;i<e.minDiffBounds.firstDiffRight&&(r.firstDiffRight=Math.min(i,r.firstDiffRight));const s=e.tileNode.children.splice(a,1);e.nodesToRetire.length&&r.firstDiffRight!==i?r.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...s):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...s):e.nodesToRetire.push(...s)}a-=1}e.unitRange={offset:r.firstDiffLeft,span:s.length-r.firstDiffRight-r.firstDiffLeft,enforcedCompleteTileTextUnit:!o&&this._settings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=(0,h.e)(e.newTextInfo.content,e.minDiffBounds,f(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),e.unitRange);for(const i of t){const t=new u(i,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.range.textUnit=(!1===e.range.validEndBoundary&&this._settings.enableOptimizedCallingPattern&&e.range.enforcedCompleteTileTextUnit,this._settings.completeTileTextUnit)}_buildTile(e,t,i,n){const s=t.range.offset,o=t.range.span;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:s,span:o},length:i.length},data:i.slice(s,s+o),proofingLanguages:this._settings.proofingLanguages,textUnit:t.range.textUnit}}_convertToUpdate(e,t,i,n,s,o){var r,a;if(!(null==e?void 0:e.range)||!(null==t?void 0:t.range))return;const l=null!==(a=null===(r=i.oldTextInfo)||void 0===r?void 0:r.content)&&void 0!==a?a:"",d=i.newTextInfo.content,c=l.length-e.range.offset-e.range.span,u=d.length-t.range.offset-t.range.span;if(!n&&e.range.offset!==t.range.offset||n&&c!==u)return;const h=this._emitParagraphDeltaUpdate(e,t,i,s,o);return e.range.offset=t.range.offset,e.range.span=t.range.span,e.range.validEndBoundary=t.range.validEndBoundary,e.range.enforcedCompleteTileTextUnit=t.range.enforcedCompleteTileTextUnit,e.range.textUnit=t.range.textUnit,t.retire(),i.nodesToAdd.splice(n?i.nodesToAdd.length-1:0,1),i.nodesToInsert.splice(n?i.nodesToInsert.length-1:0,1,e),i.nodesToRetire.splice(n?i.nodesToRetire.length-1:0,1),i.nodesToUpdate.push(e),i.graphTransaction.unreconciledContent.find((i=>{const n=i.header.elementId.id===t.id;return n&&(i.header.elementId.id=e.id),n})),h}_buildGraphTransaction(e,t,i){e.nodesToInsert=[...e.nodesToAdd];const n=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,i),s=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,i);S(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();n&&this.publishEvent("deltaEvent",n),s&&this.publishEvent("deltaEvent",s),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,i,n,s){var o;const r={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},a=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",i.content,n,r);return this._addNewChildrenDeprecated(e,i,n,s,a,r)}_updateExistingChildrenDeprecated(e,t,i,n,s){if(e.children.length){const o=Object.assign({},n),r=t!==i;let a=e.children.length-1;for(;a>=0;){const l=e.children[a].range;if(l.offset<n.firstDiffLeft&&l.offset+l.span<n.firstDiffLeft||l.offset+l.span===n.firstDiffLeft&&l.validEndBoundary&&r);else if(t.length-l.offset<n.firstDiffRight)l.offset=i.length-t.length+l.offset,s.updatedNodes.push(e.children[a].id);else{l.offset<n.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const i=t.length-l.offset-l.span;i<n.firstDiffRight&&(o.firstDiffRight=Math.min(i,o.firstDiffRight));const r=e.children.splice(a,1);for(const e of r)s.removedNodes.push(e.id),e.retire()}a-=1}return{offset:o.firstDiffLeft,span:i.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._settings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,i,n,s,o){const r=(0,h.e)(t.content,i,f(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),s),a=[];for(const i of r){const s=new u(i,e);this._attachTextUnit(s),a.push(s),o.unreconciledContent.push(this._buildTile(e,s,t.content,n)),o.addedNodes.push(s.id)}return S(e,a),o}_emitParagraphDeltaUpdate(e,t,i,n,s){if(this._settings.paragraphDeltasEnabled){const o=(0,I.Gn)(i.oldTextInfo,e.range.offset,e.range.offset+e.range.span),r=(0,I.Gn)(i.newTextInfo,t.range.offset,t.range.offset+t.range.span);if(e.registered||this._emitParagraphAdd(i,e,n),void 0!==e.eventSeqId){e.eventSeqId+=1;const i=b(e,o,r,!!t.range.validEndBoundary,!!t.range.enforcedCompleteTileTextUnit,n,s,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,e.cachedWordCount);return e.cachedWordCount=i.wordCount,i}}}_emitParagraphDeltaAdd(e,t){if(this._settings.paragraphDeltasEnabled)for(const i of e.nodesToAdd)this._emitParagraphAdd(e,i,t)}_emitParagraphAdd(e,t,i){var n;if(t.registered)return void(this._settings.enableParagraphDeltasVerboseLogging&&(null===(n=this._logger)||void 0===n||n.info(539002012,"The node has been registered, skipping")));const s=this._settings.enableParagraphDeltasEmptyInitialTile,r=(0,I.Gn)(e.newTextInfo,t.range.offset,t.range.offset+t.range.span);t.eventSeqId=0;const a=e.tileNode.findPreviousChildNode(t),l=e.tileNode.findNextChildNode(t);if(this.publishEvent("nodeEvent",{tileNodeId:e.tileNode.id,id:t.id,content:s?Object.assign(Object.assign({},r),{content:""}):r,eventSeqId:t.eventSeqId,mutationChangeType:i,messageType:o.G.NewData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t),prevTileId:"#head#"===a?a:null==a?void 0:a.id,nextTileId:"#tail#"===l?l:null==l?void 0:l.id}),s){t.eventSeqId+=1;const e=b(t,void 0,r,!!t.range.validEndBoundary,!0,i,!1,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,0);this.publishEvent("deltaEvent",e)}t.registered=!0}_emitParagraphDeltaRetire(e,t){var i;if(this._settings.paragraphDeltasEnabled)for(const n of e.nodesToRetire)n.registered=!1,this.publishEvent("nodeEvent",{tileNodeId:e.tileNode.id,id:n.id,content:{content:""},eventSeqId:null!==(i=n.eventSeqId)&&void 0!==i?i:0,mutationChangeType:t,messageType:o.G.RemoveData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(n)})}getSpecifiedLocaleForNode(e){var t,i;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(i=e.parent)||void 0===i?void 0:i.specifiedLocale}}function S(e,t){if(t.length){const i=t[0].range.offset;if(e.children.length){let n=e.children.length-1,s=t;for(;n>=0;){if(i>e.children[n].range.offset){e.children.splice(n,0,...s),s=[];break}n-=1}s.length&&e.children.splice(0,0,...s)}else e.children=t}}function b(e,t,i,n,s,o,l,c,u,h,g){var p,m;const I=null!==(p=null==t?void 0:t.content)&&void 0!==p?p:"",C=i.content,S=a.CC(I,C);l&&(S.firstDiffLeft-=1);let b=!1;if(!n&&u!==d.fT.Phrase&&u!==c){const e=S.firstDiffLeft,t=C.length-S.firstDiffRight;b=-1!==f(u).findEndBoundary(C,e-1,t)}const T=new v.M(new _.a,h),E=null!=g?g:T.getWordCount(I),N=T.hasWordCountChanged(S,E,C,!0);let x,w=r.OD.Word;if(s?w=(0,y.d)(c):b?w=(0,y.d)(u):N.isWordCountChanged?n&&(w=(0,y.d)(c)):w=r.OD.Chars,c===d.fT.Paragraph&&u===d.fT.Sentence&&w!==r.OD.Paragraph){const e=S.firstDiffLeft,t=f(u),i=t.findBeginBoundary(C,e,0),n=t.findEndBoundary(C,e-1,C.length);x=[{position:i,length:(-1===n?C.length:n)-i,unit:r.OD.Sentence}]}return{textTileNode:e,oldTextInfo:t,newTextInfo:i,minDiffBounds:S,wordCount:N.wordCount,deltaUnit:w,mutationChangeType:o,invalidationRanges:x,wordBoundaries:null!==(m=N.wordBoundaries)&&void 0!==m?m:[]}}class T extends n.z{constructor(e,t,i){super(),this.id=e,this._settings=t,this._logger=i,this._cachedWordCount=0,this._cachedTiles=new Map,this._dirtyParagraphIds=new Set,this.seqId=0,this._eventSeqId=0,this.children=[],this.childrenIdMap=new Map,this._disposed=!1,this._publishDirtyParagraphsDiff=(e,t)=>{for(const i of this._dirtyParagraphIds){const n=this.childrenIdMap.get(i);if(!n)continue;const s=(0,I.Gn)(e,n.range.offset,n.range.offset+n.range.span);this.publishEvent("paragraphDiff",{paragraph:n,textInfo:s,mutationChangeType:t})}this._dirtyParagraphIds.clear()},this._publishLastParagraphDiff=(e,t)=>{if(0===this.children.length)return;let i=this.children[0];for(const e of this.children)e.range.offset>i.range.offset&&(i=e);const n=(0,I.Gn)(e,i.range.offset,i.range.offset+i.range.span);this.publishEvent("paragraphDiff",{paragraph:i,textInfo:n,mutationChangeType:t})},this.isForceRehydrationExpected=!1,this._republishTextTileDeltaEvent=e=>{this._detectDirtyTextTile(e),this.publishEvent("textTileDeltaEvent",e)},this._republishTextTileNodeEvent=e=>{this.publishEvent("textTileNodeEvent",e)},this._detectDirtyTextTile=e=>{e.deltaUnit===r.OD.Sentence||e.deltaUnit===r.OD.Paragraph?this._dirtyParagraphIds.delete(e.textTileNode.id):this._dirtyParagraphIds.add(e.textTileNode.id)},this._wordCount=new _.a,this._wordCountDetector=new v.M(this._wordCount,this._settings),this._textTileNodeManager=new C(this._settings,this._logger),this._textTileNodeManager.subscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.subscribe("nodeEvent",this._republishTextTileNodeEvent),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetInternal()}get eventSeqId(){return this._eventSeqId}get cachedText(){var e;return null!==(e=this._cachedTextInfo)&&void 0!==e?e:{content:""}}get disposed(){return this._disposed}get previousNodeId(){return void 0===this.previousNode||"#head#"===this.previousNode?this.previousNode:this.previousNode.id}get nextNodeId(){return void 0===this.nextNode||"#tail#"===this.nextNode?this.nextNode:this.nextNode.id}resetInternal(){this._cachedTextInfo=void 0,this._cachedWordCount=0,this.documentModel=void 0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();this.children=[],this.childrenIdMap.clear(),this._invalidationDiffBounds=void 0}updateSettings(e){this._settings=e,this._wordCountDetector=new v.M(this._wordCount,this._settings),this._textTileNodeManager.updateSettings(e)}resetState(){if(this.removeAllParagraphNodesFromAugloop(),this.resetInternal(),!this._settings.enableOrchestration){const e={firstDiffLeft:0,firstDiffRight:0};this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:"",newText:"",minDiffBounds:e,maxDiffBounds:e,seqId:this.seqId,forceReflow:!0})}this.publishEvent("stateReset",{tileNodeId:this.id})}async dispose(){this.resetInternal(),this._textTileNodeManager.unsubscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.unsubscribe("nodeEvent",this._republishTextTileNodeEvent),this._disposed=!0}reconcile(e){var t,i,n,s,o,r,l,d,c;if(e.rehydrateCritiques&&e.idleReconcileTrigger&&!this.isForceRehydrationExpected)return;const u=null!==(i=null===(t=this._cachedTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"",h=e.text.content,g=a.CC(u,h);return this.documentModel=e.documentModel,e.mutationWasTextReplacement&&(g.firstDiffLeft-=1),h!==u&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},g)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,g.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,g.firstDiffRight)),this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:null===(n=e.brokerOptions)||void 0===n?void 0:n.critiques,oldText:u,newText:h,minDiffBounds:g,maxDiffBounds:null!==(s=this._invalidationDiffBounds)&&void 0!==s?s:{firstDiffLeft:u.length,firstDiffRight:0},seqId:this.seqId,forceReflow:null!==(r=null===(o=e.brokerOptions)||void 0===o?void 0:o.forceReflow)&&void 0!==r?r:void 0!==(null===(l=e.brokerOptions)||void 0===l?void 0:l.critiques)}),h===u&&this.children.length>0&&(!e.rehydrateCritiques||e.optimizedRehydrationEnabled)?(e.rehydrateCritiques&&(e.useDirtyParagraphReconciliation?this._publishDirtyParagraphsDiff(e.text,e.mutationChangeType):this._publishLastParagraphDiff(e.text,e.mutationChangeType)),this._settings.enableOrchestration&&(e.forceTileDiffEmission||e.rehydrateCritiques)&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,cachedTextInfo:this._cachedTextInfo,newTextInfo:e.text,minDiffBounds:g,hasWordChanges:!1,cachedWordCount:this._cachedWordCount,cachedTiles:Array.from(this._cachedTiles.values()),mutationChangeType:e.mutationChangeType,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e.text),void(this._cachedTextInfo=e.text)):this._reconcileState(e.text,g,null!==(d=e.rehydrateCritiques)&&void 0!==d&&d,e.mutationChangeType,null!==(c=e.mutationWasTextReplacement)&&void 0!==c&&c)}findPreviousChildNode(e){var t;const i=e.range.offset;for(const t of this.children)if(t!==e&&t.range.offset+t.range.span===i)return t;return"#head#"===this.previousNode?this.previousNode:null===(t=this.previousNode)||void 0===t?void 0:t.findLastChildNode()}findNextChildNode(e){var t;const i=e.range.offset+e.range.span;for(const t of this.children)if(t!==e&&t.range.offset===i)return t;return"#tail#"===this.nextNode?this.nextNode:null===(t=this.nextNode)||void 0===t?void 0:t.findFirstChildNode()}findLastChildNode(){let e;for(const t of this.children)(!e||t.range.offset>e.range.offset)&&(e=t);return e}findFirstChildNode(){let e;for(const t of this.children)(!e||t.range.offset<e.range.offset)&&(e=t);return e}_reconcileFormatting(e){var t,i;if(this._cachedTextInfo){if(this._settings.enableAttributionRangeExceptionInFormattedTextDeltas){const i=this._settings.enableAttributionRangeInAddDelta&&!(0,I.V8)(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!(0,I.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)||i){for(const t of this.children){const n=t.range.offset+t.range.span,o=(0,I.Wi)(this._cachedTextInfo,t.range.offset,n),r=(0,I.Wi)(e,t.range.offset,n);(0,I.V8)(o.formattedRanges,r.formattedRanges)&&!i||this.publishEvent("formattingDiff",{paragraph:t,sourceType:s.pf.ParagraphNode,data:{formattedRanges:r.formattedRanges,attributionRanges:i?r.attributionRanges:void 0}})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:s.pf.TileNode,data:null!==(t=e.formattedRanges)&&void 0!==t?t:[]})}}else if(!(0,I.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){const i=(0,I.Wi)(this._cachedTextInfo,t.range.offset,t.range.offset+t.range.span),n=(0,I.Wi)(e,t.range.offset,t.range.offset+t.range.span);(0,I.V8)(i.formattedRanges,n.formattedRanges)&&(0,I.V8)(i.attributionRanges,n.attributionRanges)||this.publishEvent("formattingDiff",{paragraph:t,sourceType:s.pf.ParagraphNode,data:n})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:s.pf.TileNode,data:null!==(i=e.formattedRanges)&&void 0!==i?i:[]})}if(!(0,I.V8)(this._cachedTextInfo.objectReferences,e.objectReferences)||!(0,I.lX)(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of I._E)"objectReferences"!==e&&delete t[e];for(const e of this.children)this.publishEvent("formattingDiff",{paragraph:e,sourceType:s.pf.ParagraphNode,data:t});this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:s.pf.TileNode,data:t})}}}retire(){var e,t,i;this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:null!==(t=null===(e=this._cachedTextInfo)||void 0===e?void 0:e.content)&&void 0!==t?t:"",newText:"",minDiffBounds:this._invalidationDiffBounds,maxDiffBounds:this._invalidationDiffBounds,seqId:this.seqId,forceReflow:!0}),this._settings.enableOrchestration&&(this.publishEvent("removeTileNode",{tileNodeId:this.id}),this.removeAllParagraphNodesFromAugloop()),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),null===(i=this._logger)||void 0===i||i.debug(562057756,"Retire node",this.id)}removeAllParagraphNodesFromAugloop(){if(!this._settings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._settings.paragraphDeltasEnabled)for(const t of e)this.publishEvent("textTileNodeEvent",{tileNodeId:this.id,id:t,eventSeqId:this.seqId,mutationChangeType:s.Q0.Code,messageType:o.G.RemoveData,specifiedLocale:this.specifiedLocale,documentModel:this.documentModel});else this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},mutationChangeType:s.Q0.Code})}move(e){const t=this.id;return this.id=(0,c.h)(),this.publishEvent("brokerNodeChange",{oldNodeId:t,newNodeId:this.id}),this.documentModel=e,this.id}_reconcileState(e,t,i,n,o){const r=this.seqId+1,a=e.content;let l;if(this._settings.paragraphDeltasEnabled)l=!1,this._cachedWordCount=0;else if(this._settings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,a);l=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else l=this._reconcileWordCount(t,a);const d=this._textTileNodeManager.updateParagraphNodes(this,this._cachedTextInfo,e,t,r,n,o);if(this._reconcileParagraphs(d,r),this._settings.enableOrchestration&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,newTextInfo:e,minDiffBounds:t,cachedWordCount:this._cachedWordCount,mutationChangeType:n,hasWordChanges:l,graphTransaction:d,cachedTextInfo:this._cachedTextInfo,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e),this._cachedTextInfo=e,i||l||this._settings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._settings.enableOptimizedCallingPattern&&n!==s.Q0.Code&&this.setIsForceRehydrationExpected(),this._settings.enableOrchestration){for(const e of d.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);d.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._settings.paragraphDeltasEnabled?d.removedNodes.length>0&&this.publishEvent("handleRemovedNodes",{tileNodeId:this.id,nodesToRetire:d.removedNodes}):this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:d,mutationChangeType:n,newTextInfo:e})}return this._resetInvalidationStateAndReturnTiles(d.unreconciledContent,r)}this.setIsForceRehydrationExpected()}setIsForceRehydrationExpected(){this._invalidationDiffBounds&&(this.isForceRehydrationExpected=!0)}clearIsForceRehydrationExpected(){this.isForceRehydrationExpected=!1}critiqueAction(e,t){return!this._settings.enableOrchestration&&(this.publishEvent("brokerProcessCritiqueAction",{tileNodeId:this.id,actionType:e,offset:t}),e===l.$w.ApplySuggestion&&this.reconcile({text:this.cachedText,mutationChangeType:s.Q0.Local}),!0)}_reconcileWordCount(e,t){const i=this._wordCountDetector.getWordCount(t);let n=0;e.firstDiffLeft<=t.length&&(n=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const s=i>0&&(i!==this._cachedWordCount||n>1);return this._cachedWordCount=i,s}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,i]of this._cachedTiles){-1===this.children.findIndex((t=>t.id===e))?this._cachedTiles.delete(e):i.header.seqId=t.toString()}e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._settings.enableOptimizedCallingPattern||this.clearIsForceRehydrationExpected(),this._invalidationDiffBounds=void 0,this.seqId=t,e}registerChild(e){this.childrenIdMap.set(e.id,e),this.publishEvent("registerChildNode",{tileNodeId:this.id,childNodeId:e.id})}unregisterChild(e){this.childrenIdMap.delete(e.id),this.publishEvent("unregisterChildNode",{childNodeId:e.id})}getChildById(e){return this.childrenIdMap.get(e)}}var E=i(10779);class N extends n.z{constructor(e,t,i){super(),this._settings=e,this._proofingLanguages=t,this._logger=i,this._textTileNodes=new Map,this._tileRootNodeToTileNode=new Map,this._textTileNodeToRootNode=new Map,this._disposed=!1,this._brokerMoveEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerMove"},e))},this._brokerCritiqueActionEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerCritiqueAction"},e))},this._brokerReconcileEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerReconcile"},e))},this._removeTileNodeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i={tileId:e.tileNodeId,tileVersion:t.eventSeqId,documentModel:t.documentModel,changeType:s.Q0.Code,isTextNode:!1,tile:void 0};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:i,messageType:o.G.RemoveData})},this._tileDiffEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i=(0,E.qu)(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},i.message)),this._handleAttributionDelta(i.message,i.attributionData)},this._paragraphDiffEventHandler=e=>{var t,i,n;const o=(0,E.IJ)(e.paragraph.id,null!==(t=e.paragraph.eventSeqId)&&void 0!==t?t:0,null===(i=e.paragraph.parent)||void 0===i?void 0:i.documentModel,e.textInfo,e.textInfo,{firstDiffLeft:e.paragraph.range.span,firstDiffRight:0},null!==(n=e.paragraph.cachedWordCount)&&void 0!==n?n:0,r.OD.Sentence,s.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},o.message)),this._handleAttributionDelta(o.message,o.attributionData)},this._paragraphNodeChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i=(0,E.$q)(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableParagraphUpdates);this.publishEvent("tilingEvent",{messageName:"hostModelParagraphTextTiles",data:i})},this._formattingDiffEventHandler=e=>{var t,i,n;let s,o,r=0;if(e.tileNodeId){const i=this.getTileRootNodeById(e.tileNodeId);s=null==i?void 0:i.id,r=null!==(t=null==i?void 0:i.eventSeqId)&&void 0!==t?t:0,o=null==i?void 0:i.documentModel}if(!s&&e.paragraph&&(s=e.paragraph.id,r=null!==(i=e.paragraph.eventSeqId)&&void 0!==i?i:0,o=null===(n=e.paragraph.parent)||void 0===n?void 0:n.documentModel),!s)return;const a=(0,E.Fd)(s,r,o,e.sourceType,e.data);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelFormattingDelta"},a))},this._textTileNodeEventHandler=e=>{const t=(0,E.XH)(e,this._proofingLanguages.defaultLanguageCode);this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:e.messageType})},this._textTileDeltaEventHandler=e=>{var t,i;const n=(0,E.IJ)(e.textTileNode.id,null!==(t=e.textTileNode.eventSeqId)&&void 0!==t?t:0,null===(i=e.textTileNode.parent)||void 0===i?void 0:i.documentModel,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,s.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta,e.invalidationRanges,e.wordBoundaries);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},n.message)),this._handleAttributionDelta(n.message,n.attributionData)},this._handleAttributionDelta=(e,t)=>{(null==t?void 0:t.length)&&this._settings.enableAttributionRangeInAddDelta&&this.publishEvent("tilingEvent",{messageName:"hostModelAttributionDelta",tileId:e.tileId,tileVersion:e.tileVersion,documentModel:e.documentModel,sourceType:e.sourceType,delta:t})},this._stateChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);t&&this._sendNewTextTileEvent(t),e.tileNodeId=this._tileRootNodeToTileNode.get(e.tileNodeId)||e.tileNodeId,this.publishEvent("stateReset",e)},this._handleRemovedNodesEventHandler=e=>{this.publishEvent("handleRemovedNodes",e)},this._registerChildNodeEventHandler=e=>{this._textTileNodeToRootNode.set(e.childNodeId,e.tileNodeId)},this._unregisterChildNodeEventHandler=e=>{this._textTileNodeToRootNode.delete(e.childNodeId)},this._sendNewTextTileEvent=e=>{const t={tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:s.Q0.Code,isTextNode:!1,tile:void 0,prevId:e.previousNodeId,nextId:e.nextNodeId};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:o.G.NewData})},this._findTextTileNodeById=e=>{var t;const i=this._textTileNodeToRootNode.get(e);if(!i)return;const n=this._tileRootNodeToTileNode.get(i);return n?null===(t=this._textTileNodes.get(n))||void 0===t?void 0:t.getChildById(e):void 0}}get disposed(){return this._disposed}async dispose(){if(!this._disposed){for(const e of this._textTileNodes.values())e.unsubscribe("stateReset",this._stateChangeEventHandler),e.unsubscribe("removeTileNode",this._removeTileNodeEventHandler),e.unsubscribe("tileDiff",this._tileDiffEventHandler),e.unsubscribe("paragraphDiff",this._paragraphDiffEventHandler),e.unsubscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),e.unsubscribe("formattingDiff",this._formattingDiffEventHandler),e.unsubscribe("registerChildNode",this._registerChildNodeEventHandler),e.unsubscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),e.unsubscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),e.unsubscribe("textTileNodeEvent",this._textTileNodeEventHandler),e.unsubscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),e.unsubscribe("brokerNodeChange",this._brokerMoveEventHandler),e.unsubscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),e.unsubscribe("brokerReconcile",this._brokerReconcileEventHandler),await e.dispose();this._textTileNodes.clear(),this._tileRootNodeToTileNode.clear(),this._disposed=!0}}resetState(){for(const e of this._textTileNodes.values())e.resetState()}setProofingLanguages(e){this._proofingLanguages=e;for(const e of this._textTileNodes.values())e.reconcile({text:e.cachedText,mutationChangeType:s.Q0.Code})}updateSettings(e){this._settings=e;for(const e of this._textTileNodes.values())e.updateSettings(this._getTileRootNodeSettings())}async pushText(e,t){const i=[];for(const t of e){const e=this._getTileRootNodeForExternalId(t.tileNodeId);e.previousNode=this.getPreviousTileRootNode(t.previousNodeId),e.nextNode=this.getNextTileRootNode(t.nextNodeId);const n=e.reconcile(t);n&&i.push(...n)}if(0===i.length)return;const n=this._buildTilesToSend(i,this._proofingLanguages),s={messageType:t,data:{tiles:n,uxLanguage:this._proofingLanguages.defaultLanguageCode}};t!==o.G.RemoveData?this.publishEvent("tilesAvailable",s):this.publishEvent("clearTiles",n)}retireTileNode(e){const t=this._textTileNodes.get(e);t&&(t.retire(),this._textTileNodes.delete(e),this._tileRootNodeToTileNode.delete(t.id))}moveTileNode(e,t,i){const n=this._textTileNodes.get(e);if(!n)return;const s=n.documentModel,o=null!=i?i:s,r=n.id,a=n.move(o);this._textTileNodes.delete(e),this._tileRootNodeToTileNode.delete(r),this._textTileNodes.set(t,n),this._tileRootNodeToTileNode.set(a,t);const l=(0,E.BX)(r,a,n.eventSeqId,n.cachedText,this._proofingLanguages.defaultLanguageCode,n.previousNodeId,n.nextNodeId,s,o);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelMoveTextTile"},l))}_buildTilesToSend(e,t){const i=[];for(const n of e)for(const e of t.codesList)i.push(Object.assign(Object.assign({},n),{proofingLanguages:[e]}));return i}_getTileRootNodeForExternalId(e){let t=this._textTileNodes.get(e);if(!t){const i=this._tileRootNodeToTileNode.get(e);i&&(t=this._textTileNodes.get(i))}if(!t){const i=(0,c.h)();t=new T(i,this._getTileRootNodeSettings(),this._logger),this._textTileNodes.set(e,t),this._tileRootNodeToTileNode.set(i,e),t.subscribe("stateReset",this._stateChangeEventHandler),t.subscribe("removeTileNode",this._removeTileNodeEventHandler),t.subscribe("tileDiff",this._tileDiffEventHandler),t.subscribe("paragraphDiff",this._paragraphDiffEventHandler),t.subscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),t.subscribe("formattingDiff",this._formattingDiffEventHandler),t.subscribe("textTileNodeEvent",this._textTileNodeEventHandler),t.subscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),t.subscribe("registerChildNode",this._registerChildNodeEventHandler),t.subscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),t.subscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),t.subscribe("brokerNodeChange",this._brokerMoveEventHandler),t.subscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),t.subscribe("brokerReconcile",this._brokerReconcileEventHandler),this._sendNewTextTileEvent(t)}return t}getTileRootNodeById(e){var t;const i=null!==(t=this._tileRootNodeToTileNode.get(e))&&void 0!==t?t:e;if(i)return this._textTileNodes.get(i)}getTileNodeId(e){return this._tileRootNodeToTileNode.get(e)}_getTileRootNodeSettings(){return Object.assign(Object.assign({},this._settings),{proofingLanguages:this._proofingLanguages.codesList})}getParagraphFinder(){return{findParagraph:e=>this._findTextTileNodeById(e),getParagraphText:e=>{const t=e.parent;if(!t)return;return t.cachedText.content.slice(e.range.offset,e.range.offset+e.range.span)},getParagraphTextForCritique:(e,t)=>{const i=e.parent;if(!i)return;const n=t.endNode?this._findTextTileNodeById(t.endNode.nodeId):e;if(!n)return;const s=t.endNode?n.range.offset+t.endNode.end:t.start+t.length,o=i.cachedText.content;if(n.parent===i)return o.substring(t.start,s).replace(/\u00A0/g," ");let r,a=o.substring(t.start)+"\n",l=i;do{if(r=l.nextNode,!r||"#tail#"===r)return;l=r;const e=l===n.parent,t=e?s:void 0,i=e?"":"\n";a+=l.cachedText.content.substring(0,t)+i}while(l!==n.parent);return a},isCritiqueInNode:(e,t)=>t.nodeId!==e.id&&!(t.start>=e.range.offset+e.range.span||e.range.offset>=t.start+t.length),getTileRootNodeById:e=>this.getTileRootNodeById(e),getTileNodeId:e=>this.getTileNodeId(e),getTileNodeParagraphs:e=>{var t;return null===(t=this._textTileNodes.get(e))||void 0===t?void 0:t.children}}}async processTileCritiques(e){const t=this._tileRootNodeToTileNode.get(e.tileNodeId)||e.tileNodeId;for(const i of e.critiques)i.tileId&&(i.tileId.nodeId=t);this.publishEvent("critiquesAvailable",{tileNodeId:t,critiques:e.critiques,messageType:e.messageType})}getPreviousTileRootNode(e){return void 0===e||"#head#"===e?e:this._getTileRootNodeForExternalId(e)}getNextTileRootNode(e){return void 0===e||"#tail#"===e?e:this._getTileRootNodeForExternalId(e)}}},51719:(e,t,i)=>{i.d(t,{kK:()=>b});var n=i(79490),s=i(76778),o=i(18104),r=i(65099),a=i(95523),l=i(95834),d=i(10219),c=i(11804),u=i(67843),h=i(21522),g=i(8694),p=i(23943),m=i(46032),f=i(22696),v=i(76729),_=i(29906),y=i(83010),I=i(66008),C=i(27603),S=i(57595);const b=(0,v.f)("ITextProcessingControllerFactory"),T=(0,v.f)("ITextAugmentationProcessingControllerFactory");(0,v.f)("ITextProcessingControllerLegacyWrapper");let E=class{constructor(e,t,i,n,l,d,c,u,h,g,p,m){this.proofingEmitter=e,this.proofingDom=t,this._textProcessorCoreFactory=i,this._textAugmentationCoreFactory=n,this._hostModelSettings=l,this._textEventPublisher=d,this._hostEmitters=c,this._featureFlagsReader=u,this._hostSettings=h,this._paragraphDeltasEnabled=g,this._queryDetection=p,this._wordDictionary=m,this.handleTextChangeEvent=e=>{this.textProcessingController.pushText(e.data,e.messageType)},this.handleTextStyleChangeEvent=()=>{this.proofingEmitter.emit("recomputeSquiggles")},this.initializeTextProcessingController=()=>{const e=this._textProcessorCoreFactory();return e.subscribe("critiquesAvailable",this._critiquesAvailableHandler),e.subscribe("clearTiles",this._clearTilesHandler),e.subscribe("tilesAvailable",this._tilesAvailableHandler),e.subscribe("stateReset",this._tileStateResetHandler),e.subscribe("tilingEvent",this._tilingEventHandler),e.subscribe("handleRemovedNodes",this._handleRemovedNodesHandler),this.proofingDom.setTextProcessingParagraphFinder(e.getParagraphFinder()),e},this.initializeTextAugmentationCore=()=>{const e=this.textProcessingController.getParagraphFinder(),t=this._textAugmentationCoreFactory(e);return t.subscribe("critiquesReceived",this._onCritiquesReceived),t.subscribe("clearTiles",this._handleOnRemoveTiles),t.subscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),t},this._tilingEventHandler=async e=>this.textAugmentationController.processTilingMessage(e),this._tileStateResetHandler=e=>{for(const t of this._hostEmitters)t.emit(s.pD.hostModelTileStateReset,{address:void 0,message:e.tileNodeId})},this._handleOnRemoveTiles=e=>{const t=e.tiles.map((e=>({tileId:e.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0,languageId:""})));this.proofingEmitter.emit("critiqueEvent",{data:t,messageType:o.G.RemoveData})},this._onCritiquesReceived=e=>{if(e.tileId)return void this.textProcessingController.processTileCritiques({tileNodeId:e.tileId,critiques:e.critiques,messageType:0===e.critiques.length?o.G.RemoveData:o.G.ChangeData});const t=(0,r.PD)(e.critiques);for(const e of t.keys()){const i=t.get(e);this.textProcessingController.processTileCritiques({tileNodeId:e,critiques:null!=i?i:[],messageType:0===(null==i?void 0:i.length)?o.G.RemoveData:o.G.ChangeData})}},this._critiquesAvailableHandler=e=>{const t=this.proofingDom.findNode(e.tileNodeId);t&&this.proofingEmitter.emit("squiggleDataEvent",{messageType:e.messageType,data:{critiquesToElementsMap:[{elementId:e.tileNodeId,element:t.element,critiques:e.critiques.map(a.OE)}]}})},this._clearTilesHandler=e=>{this._handleOnRemoveTiles({tiles:e})},this._handleUserRevertedAutoCorrection=e=>{(0,S.yf)(e.critique,this._wordDictionary)},this._tilesAvailableHandler=async e=>{const{schedulerDefaultWaitingTime:t,schedulerDefaultWaitingTimeIncrement:i,schedulerDefaultMaxTime:n}=this._hostModelSettings;this._proofingTimeout&&(window.clearTimeout(this._proofingTimeout),this._proofingTimeout=void 0,this._timeoutLength||(this._timeoutLength=t),this._timeoutLength=Math.min(this._timeoutLength+i,n)),this._proofingTimeout=window.setTimeout((async()=>{this._timeoutLength=t,await this.textAugmentationController.processTilingMessage(Object.assign({messageName:"textTilesMessage"},e)),this._proofingTimeout=void 0}),this._timeoutLength)},this._onFeatureFlagsChanged=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},e),this._hostModelSettings),this._hostSettings),{paragraphDeltasEnabled:this._paragraphDeltasEnabled.check()});this.textProcessingController.updateSettings(t)},this._handleRemovedNodesHandler=e=>{if(this._queryDetection)for(const t of e.nodesToRetire)this._queryDetection.handleTileRemoved(t)}}async initialize(){this._textEventPublisher.subscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.subscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.subscribe("flagsChanged",this._onFeatureFlagsChanged)}shutDown(){var e,t,i,n,s,o,r,a,l;this._textEventPublisher.unsubscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.unsubscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.unsubscribe("flagsChanged",this._onFeatureFlagsChanged),null===(e=this._textAugmentationController)||void 0===e||e.unsubscribe("critiquesReceived",this._onCritiquesReceived),null===(t=this._textAugmentationController)||void 0===t||t.unsubscribe("clearTiles",this._handleOnRemoveTiles),null===(i=this._textAugmentationController)||void 0===i||i.unsubscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),null===(n=this._textProcessingController)||void 0===n||n.unsubscribe("critiquesAvailable",this._critiquesAvailableHandler),null===(s=this._textProcessingController)||void 0===s||s.unsubscribe("clearTiles",this._clearTilesHandler),null===(o=this._textProcessingController)||void 0===o||o.unsubscribe("tilesAvailable",this._tilesAvailableHandler),null===(r=this._textProcessingController)||void 0===r||r.unsubscribe("stateReset",this._tileStateResetHandler),null===(a=this._textProcessingController)||void 0===a||a.unsubscribe("tilingEvent",this._tilingEventHandler),null===(l=this._textProcessingController)||void 0===l||l.unsubscribe("handleRemovedNodes",this._handleRemovedNodesHandler)}setProofingLanguages(e){this.textProcessingController.setProofingLanguages(e)}async pushText(e,t){return this.textProcessingController.pushText(e,t)}get textProcessingController(){return this._textProcessingController||(this._textProcessingController=this.initializeTextProcessingController()),this._textProcessingController}get textAugmentationController(){return this._textAugmentationController||(this._textAugmentationController=this.initializeTextAugmentationCore()),this._textAugmentationController}};E=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,y.W)(l.o)),(0,n.__param)(1,(0,y.W)(p.w)),(0,n.__param)(2,(0,y.W)(b)),(0,n.__param)(3,(0,y.W)(T)),(0,n.__param)(4,(0,y.W)(g.k)),(0,n.__param)(5,(0,y.W)(m.n)),(0,n.__param)(6,(0,I.t)(s.zJ)),(0,n.__param)(7,(0,y.W)(d.c)),(0,n.__param)(8,(0,y.W)(c.n)),(0,n.__param)(9,(0,y.W)(u.H)),(0,n.__param)(10,(0,C.l)()),(0,n.__param)(10,(0,y.W)(h.J)),(0,n.__param)(11,(0,C.l)()),(0,n.__param)(11,(0,y.W)(f.s))],E)},10779:(e,t,i)=>{if(i.d(t,{$q:()=>p,BX:()=>v,Fd:()=>m,IJ:()=>g,XH:()=>f,qu:()=>h}),2063!=i.j)var n=i(69811);if(2063!=i.j)var s=i(91538);if(2063!=i.j)var o=i(2010);if(2063!=i.j)var r=i(71924);if(2063!=i.j)var a=i(18104);if(2063!=i.j)var l=i(82677);if(2063!=i.j)var d=i(65798);if(2063!=i.j)var c=i(81090);if(2063!=i.j)var u=i(3033);function h(e,t,i,s,o){var a,l;const u=null!==(a=e.graphTransaction)&&void 0!==a?a:{addedNodes:[],unreconciledContent:null!==(l=e.cachedTiles)&&void 0!==l?l:[],removedNodes:[],updatedNodes:[]};let h=n.OD.Chars;u.unreconciledContent.some((e=>e.textUnit===d.fT.Paragraph))?h=n.OD.Paragraph:u.unreconciledContent.some((e=>e.textUnit===d.fT.Sentence))?h=n.OD.Sentence:e.hasWordChanges&&(h=n.OD.Word);const p=u.unreconciledContent.map((e=>{var n;return{position:e.header.elementId.offset,length:e.header.elementId.span,unit:(0,c.d)(e.textUnit),languageId:null!==(n=t.specifiedLocale)&&void 0!==n?n:i}}));return g(e.tileNodeId,t.eventSeqId,s,e.cachedTextInfo,e.newTextInfo,e.minDiffBounds,e.cachedWordCount,h,r.pf.TileNode,e.mutationChangeType,o,p)}function g(e,t,i,o,r,a,d,c,u,h,g,p,m){var f;let v,I,C=0;const S=null!==(f=null==o?void 0:o.content)&&void 0!==f?f:"",b=r.content,T=a.firstDiffLeft,E=S.length-a.firstDiffRight,N=b.length-a.firstDiffRight,x=function(e,t,i,s,o){if(e===t)return n.WI.Update;if(i===o)return n.WI.Add;if(s===o)return n.WI.Delete;return n.WI.Update}(S.length,b.length,E,N,T);let w;const L=()=>function(e,t,i,n){if(!n||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let s;for(s=0;s<e.length;s++){const i=e[s],n=t[s];if(i.start!==n.start||i.length<n.length||!(0,l.G)(i.attribution,n.attribution))break}if(!t[s])return[];if(t[s].start!==i)return t;return t.slice(s)}(null==o?void 0:o.attributionRanges,r.attributionRanges,T,g);switch(x){case n.WI.Update:C=E-T,v=b.substring(T,N),w=L(),I=S.substring(T,E);break;case n.WI.Add:C=0,v=b.substring(T,N),w=L();break;case n.WI.Delete:C=E-T,I=S.substring(T,E),w=L()}return{message:{tileId:e,tileVersion:t,documentModel:i,delta:new s.s({deltaType:x,unit:c,position:T,length:C,content:v,wordCount:d,invalidationRanges:p,userInfo:{userType:_(h)},attributionRanges:w}),sourceType:u,changeType:h,deletedOrReplacedCharacters:I,tileText:b,wordBoundaries:m},attributionData:g?y(w,w===r.attributionRanges):void 0}}function p(e,t,i,n,s){var l,d,c;const u=null!==(l=e.graphTransaction)&&void 0!==l?l:{addedNodes:[],unreconciledContent:[],removedNodes:null!==(d=e.nodesToRetire)&&void 0!==d?d:[],updatedNodes:[]},h=null!==(c=e.mutationChangeType)&&void 0!==c?c:r.Q0.Code,g=u.removedNodes.map((e=>({messageType:a.G.RemoveData,data:{tileId:e,tileVersion:t.eventSeqId,documentModel:n,changeType:h,isTextNode:!0,tile:void 0}})));return g.push(...u.unreconciledContent.map((r=>{const{prev:l,next:d}=function(e,t){const i=e.getChildById(t);if(!i)return{prev:void 0,next:void 0};const n=e.findPreviousChildNode(i),s=e.findNextChildNode(i);return{prev:"#head#"===n?n:null==n?void 0:n.id,next:"#tail#"===s?s:null==s?void 0:s.id}}(t,r.header.elementId.id);return{messageType:s&&!u.addedNodes.includes(r.header.elementId.id)?a.G.ChangeData:a.G.NewData,data:{tileId:r.header.elementId.id,tileVersion:t.eventSeqId,documentModel:n,changeType:h,isTextNode:!0,tile:new o.Cg(Object.assign(Object.assign({},e.newTextInfo),{content:r.data,formattedRanges:[{start:0,length:r.data.length,languageId:i}]})),prevId:l,nextId:d}}}))),g}function m(e,t,i,o,r){return{tileId:e,tileVersion:t,documentModel:i,delta:(0,u.Dt)(r)?new s.s({deltaType:n.WI.FormattingUpdate,formattedRanges:r.formattedRanges,attributionRanges:r.attributionRanges}):Array.isArray(r)?new s.s({deltaType:n.WI.FormattingUpdate,formattedRanges:r}):new s.s({deltaType:n.WI.OtherNonContentUpdate,otherNonContentData:r}),sourceType:o}}function f(e,t){var i;return{tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:e.mutationChangeType,isTextNode:!0,tile:e.content?new o.Cg(Object.assign(Object.assign({},e.content),{formattedRanges:[...null!==(i=e.content.formattedRanges)&&void 0!==i?i:[],{start:0,length:e.content.content.length,languageId:t}]})):void 0,prevId:e.prevTileId,nextId:e.nextTileId}}function v(e,t,i,n,s,r,a,l,d){var c;return{oldTileId:e,newTileId:t,tileVersion:i,oldDocumentModel:l,newDocumentModel:d,tile:new o.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(c=n.formattedRanges)&&void 0!==c?c:[],{start:0,length:n.content.length,languageId:s}]})),prevId:r,nextId:a}}function _(e){switch(e){case r.Q0.Local:return n.HS.SessionUser;case r.Q0.Remote:return n.HS.Collaborator;default:return n.HS.Programmatic}}function y(e,t){if(!e||0===e.length)return;const i={deltaType:n.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},o=new s.s(i);return(0,r.Bb)(o)?o:i}},94372:(e,t,i)=>{i.d(t,{n:()=>m});var n=i(79490),s=i(68794),o=i(91513),r=i(18104),a=i(71924),l=i(2915),d=i(95834),c=i(10138),u=i(29906),h=i(83010),g=i(5923),p=i(23943);let m=class{constructor(e,t,i,n,r){this._proofingStore=e,this._emitter=t,this.nodePoller=i,this.proofingDom=n,this._logger=r,this._proofingLanguages=new s.I(this._proofingStore.getDefaultValue(o.l.ProofingLanguages))}async initialize(){this._proofingLanguages=new s.I(await this._proofingStore.read(o.l.ProofingLanguages)),this._emitter.on("proofingLanguageChanged",(async e=>{this.switchProofingLanguage(e.data)}))}shutDown(){}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(536978383,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map((e=>e.resetState())),this.nodePoller.pollNodes(r.G.NewData,this.proofingDom.tileNodes,a.Q0.Code,void 0,!0))}};m=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(l.K)),(0,n.__param)(1,(0,h.W)(d.o)),(0,n.__param)(2,(0,h.W)(g.G)),(0,n.__param)(3,(0,h.W)(p.w)),(0,n.__param)(4,(0,h.W)(c.g))],m)},5923:(e,t,i)=>{i.d(t,{G:()=>n});const n=(0,i(76729).f)("INodePoller")},83544:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(76729).f)("IPreOrderTraverser")},23943:(e,t,i)=>{i.d(t,{w:()=>n});const n=(0,i(76729).f)("IProofingDom")},21574:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(76729).f)("ITileNodeReader")},64355:(e,t,i)=>{i.d(t,{y:()=>o});var n=i(79490),s=i(29906);let o=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){var e;if(this._rootNodes.length){const t=[];for(t.push(...this._rootNodes);t.length;){const i=t.pop();yield i,(null===(e=null==i?void 0:i.children)||void 0===e?void 0:e.length)&&t.push(...i.children)}}yield}};o=(0,n.__decorate)([(0,s._)()],o)},86314:(e,t,i)=>{i.d(t,{D:()=>g});var n=i(79490),s=i(76778),o=i(25530),r=i(64355),a=i(30844),l=i(29906),d=i(27603),c=i(83010);function u(e,t){const i={nodeType:o.Z.TileNode,id:e.id,parent:t.parent,element:t.element,children:void 0,critiques:[],textFormattingInfo:e.cachedText,plainText:e.cachedText.content,pullText:()=>e.cachedText,retire:()=>e.retire,resetState:()=>e.resetState,reconcile:(t,i,n,s,o,r)=>e.reconcile({text:e.cachedText,mutationChangeType:t,rehydrateCritiques:s,forceTileDiffEmission:o,mutationWasTextReplacement:r,brokerOptions:{critiques:i,forceReflow:n}}),move:(t,n)=>(e.move(),i),getPreviousTileId:()=>e.previousNodeId,getNextTileId:()=>e.nextNodeId};return e.children.length>0&&(i.children=e.children.map((e=>h(e,i)))),i}function h(e,t){const i={nodeType:o.Z.ParagraphNode,id:e.id,element:e.range,parent:t,children:void 0,eventSeqId:e.eventSeqId,retire:()=>e.retire,move:()=>(e.move(),i),resetState:()=>{}};return i}let g=class{constructor(e){this._hostEmitter=e,this._tileNodeDictionary={},this._terminalNodeDictionary={},this._paragraphNodeDictionary={},this._preOrderTraverser=new r.y}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){var t,i;const n=null!==(i=null!==(t=this.findParagraphNode(e))&&void 0!==t?t:this.findTileNode(e))&&void 0!==i?i:this.findTerminalNode(e);return n||(this.ensureCanFindNode()?this._iterateGraph(e):null)}findTileNode(e){var t;return null!==(t=this.findTileRootNode(e))&&void 0!==t?t:this._tileNodeDictionary[e]}get tileNodes(){const e=Object.values(this._tileNodeDictionary);if(!this._paragraphFinder)return e;const t=[];for(const i of e){const e=this.findTileRootNode(i.id);e?t.push(e):t.push(i)}return t}findParagraphNode(e){var t;return null!==(t=this.findTextTileNode(e))&&void 0!==t?t:this._paragraphNodeDictionary[e]}findTerminalNode(e){return this._terminalNodeDictionary[e]}getTileNodeV2Paragraphs(e){var t;const i=null===(t=this._paragraphFinder)||void 0===t?void 0:t.getTileNodeParagraphs(e.id);return i?i.map((t=>h(t,e))):null}addNode(e){var t;if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else{this._shadowGraph||(this._shadowGraph=new a.j),this._shadowGraph.rootNodes.push(e);const i=this._selectDictionary(e.nodeType);i&&(i[e.id]=e),null===(t=this._hostEmitter)||void 0===t||t.emit(s.pD.hostModelAddedRootNode,{address:void 0,message:e.id})}}removeNode(e){var t;if(!this.findNode(e.id))return;let i,n=!1;if(e.parent?i=e.parent.children:this._shadowGraph&&(i=this._shadowGraph.rootNodes,n=!0),n){const i=this._selectDictionary(e.nodeType);i&&delete i[e.id],null===(t=this._hostEmitter)||void 0===t||t.emit(s.pD.hostModelRemovedRootNode,{address:void 0,message:e.id})}!function(e,t){if(t){const i=t.indexOf(e);if(-1!==i)return t.splice(i,1),!0}}(e,i),e.retire()}async initialize(){}shutDown(){var e;this.retireAllShadowGraphRootNodes(),null===(e=this._shadowGraph)||void 0===e||e.clear()}_selectDictionary(e){switch(e){case o.Z.TileNode:return this._tileNodeDictionary;case o.Z.ParagraphNode:return this._paragraphNodeDictionary;case o.Z.TerminalNode:return this._terminalNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let i=t.next();for(;!i.done;){if(i.value&&i.value.id===e)return i.value;i=t.next()}return null}setTextProcessingParagraphFinder(e){this._paragraphFinder=e}findTileRootNode(e){var t;if(!this._paragraphFinder)return null;const i=null!==(t=this.getTileNodeByTileRootNodeId(e))&&void 0!==t?t:this._tileNodeDictionary[e],n=this._paragraphFinder.getTileRootNodeById(e);return n&&i?u(n,i):null}findTextTileNode(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.findParagraph(e);if(!t)return null;let i;if(t.parent){const e=this.getTileNodeByTileRootNodeId(t.parent.id);e&&(i=u(t.parent,e))}return h(t,i)}getTileNodeByTileRootNodeId(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.getTileNodeId(e);return t?this._tileNodeDictionary[t]:null}};g=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.l)()),(0,n.__param)(0,(0,c.W)(s.M5))],g)},96667:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(79490),s=i(29906),o=i(25530);let r=class{isTileNode(e){return e.nodeType===o.Z.TileNode}reconcile(e,t,i,n,s,o,r){return e.reconcile(t,i,!!n,!!s,!!o,!!r)}critiques(e){return e.critiques}getPreviousTileId(e){return e.getPreviousTileId()}getNextTileId(e){return e.getNextTileId()}};r=(0,n.__decorate)([(0,s._)()],r)},8694:(e,t,i)=>{i.d(t,{k:()=>n});const n=(0,i(76729).f)("IHostModelSettings")},38471:(e,t,i)=>{if(i.d(t,{W:()=>s}),2063!=i.j)var n=i(70807);class s{constructor(e,t,i,s,o,r){this._observer=t,this.nodeType=e,this.id=null!=r?r:(0,n.h)(),this._children=i,this.element=s,this.parent=o}get children(){return this._children}set children(e){this._children=e}retire(){if(this._observer.disconnect(this.element),this.children)for(const e of this.children)e.retire();this.children=void 0}move(e,t){return this._observer.disconnect(this.element),this.id=(0,n.h)(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}}},15844:(e,t,i)=>{i.d(t,{q:()=>n,x:()=>s});const n=(0,i(76729).f)("IConditionalAttributeFilterFactory");class s{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach((i=>{t=t||i(e)})),!t}}},81090:(e,t,i)=>{if(i.d(t,{d:()=>o}),2063!=i.j)var n=i(65798);if(2063!=i.j)var s=i(69811);function o(e){switch(e){case n.fT.Word:return s.OD.Word;case n.fT.Sentence:return s.OD.Sentence;case n.fT.Paragraph:return s.OD.Paragraph;default:return s.OD.Sentence}}},93555:(e,t,i)=>{i.d(t,{C:()=>o});var n=i(79490),s=i(29906);let o=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const i=t.join(",");return e.querySelector(i)?Array.from(e.querySelectorAll(i)):[]}};o=(0,n.__decorate)([(0,s._)()],o)},74168:(e,t,i)=>{i.d(t,{h:()=>z});var n=i(79490);const s=(0,i(76729).f)("IChildElementFinderFactory");var o=i(22923),r=i(33999),a=i(1527),l=i(18104),d=i(71924),c=i(76778),u=i(11804),h=i(8694),g=i(80465),p=i(5923),m=i(29583),f=i(99261),v=i(23943),_=i(39593),y=i(46032),I=i(754),C=i(21574),S=i(25530),b=i(3783),T=i(29906),E=i(38471),N=i(70807);let x=class extends E.W{constructor(e,t,i,n,s,o,r,a,l,d){super(i,n,void 0,s,o,r),this._proofingDom=e,this._tileContent=t,this.nodeType=i,this._observer=n,this.element=s,this.parent=o,this._logger=a,this._nodeTraverser=l,this._hostSettings=d,this._children=[],this.id=(0,N.h)(),this._proofingDom.registerNode(this)}get children(){var e,t;return(null===(e=this._hostSettings)||void 0===e?void 0:e.sdkV2Enabled)?null!==(t=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==t?t:[]:this._children}set children(e){this._children=e}retire(){var e;this.parent=void 0,null===(e=this._logger)||void 0===e||e.debug(0,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){return this._proofingDom.unregisterNode(this),super.move(e,t),this._proofingDom.registerNode(this),this}resetState(e){}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,i,n,s,o){}get plainText(){return this.pullText().content}getPreviousTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}};x=(0,n.__decorate)([(0,T._)()],x);var w=i(50518);function L(e,t,i){if(e.spellcheck){const i=e.closest("[contenteditable=true]"),n=null==i?void 0:i.getAttribute("spellcheck"),s=e.getAttribute("spellcheck");return i?i.setAttribute("spellcheck","false"):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(i||e).setAttribute(t.editorSpellcheckAttribute,"true"),i=>{const o=i.closest("[contenteditable=true]");o?n?o.setAttribute("spellcheck",n):o.removeAttribute("spellcheck"):s?(e.setAttribute("spellcheck",s),e.spellcheck=!1):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(o||i).removeAttribute(t.editorSpellcheckAttribute)}}if(null==i?void 0:i.some((t=>t(e)))){return(e.closest("[contenteditable=true]")||e).setAttribute(t.editorSpellcheckAttribute,"true"),e=>{(e.closest("[contenteditable=true]")||e).removeAttribute(t.editorSpellcheckAttribute)}}return()=>{}}var D=i(83010),F=i(27603);let A=class{constructor(e,t,i,n,s,o,r,u,h,g,p,m,f,v,_){this._observerFactory=e,this._tileContent=t,this._proofingDom=i,this._nodePoller=n,this._tileNodeReader=s,this._settings=o,this._hostSettings=r,this._childElementsFinderFactory=u,this._hostEmitter=g,this._graphNodeFactory=p,this.shadowElementsStore=f,this.textEventPublisher=v,this.nodeTraverser=_,this.buildNode=(e,t,i,n)=>{var s,o;const r=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),u=new w.x(r,e,t,n),h=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),g=this._getNewTopology(u,h,u).map((e=>this.createTileNode(e,u)));u.children=g,u.documentModel=i;const p=L(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);return u.registerVisualizationRemovedCallback((()=>{const e=this._tileContent.getContainingElement(u);e&&p(e)})),((0,a.C)(e,"HTMLInputElement")||(0,a.C)(e,"HTMLTextAreaElement"))&&(null===(s=this.shadowElementsStore)||void 0===s||s.setCanvasElement(g[0].id,e)),r.onElementAdded=(e,t)=>{var i;u.element&&!u.element.contains(e)||this._nodePoller.pollNodes(l.G.NewData,null!==(i=u.children)&&void 0!==i?i:[],t,void 0,void 0,void 0,!this._hostSettings.enableOrchestration)},r.onElementChanged=(e,t,i,n)=>{this._nodePoller.pollNodes(l.G.ChangeData,this._getChildrenToReconcile(u,e),t,void 0,void 0,void 0,void 0,n)},r.onElementRemoved=(e,t)=>{var i;this._nodePoller.pollNodes(l.G.ChangeData,null!==(i=u.children)&&void 0!==i?i:[],t)},r.onVisualStateChanged=(e,t)=>{var i,n,s,o,r;if("StyleChange"!==t){if("Created"===t){const e=this._tileContent.getContainingElement(u);if(e){const t=L(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);u.registerRetireCallback((()=>{const e=this._tileContent.getContainingElement(u);e&&t(e)}))}}else u.visualizationWasRemoved();this._nodePoller.pollNodes(l.G.ChangeData,null!==(n=u.children)&&void 0!==n?n:[],d.Q0.Code,void 0,!0,void 0,void 0);for(const e of null!==(s=u.children)&&void 0!==s?s:[])null===(o=this._hostEmitter)||void 0===o||o.emit(c.pD.hostModelVisualStateChange,{address:void 0,message:{tileId:e.id,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,created:"Created"===t}})}else null===(i=this.textEventPublisher)||void 0===i||i.publishTextStyleEvent()},this._nodePoller.pollNodes(l.G.NewData,u.children,null!==(o=this._graphNodeBuilderTerminalRule.initialContentChangeType)&&void 0!==o?o:d.Q0.Code),u},this._getNewTopology=(e,t,i)=>e.element?t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter((e=>this._graphNodeBuilderTerminalRule.filters.every((t=>t(e,i,this._graphNodeBuilderTerminalRule))))):[],this._graphNodeBuilderTerminalRule=h.nodeMetaType,this._paragraphNodesBuilder=null==m?void 0:m(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_getChildrenToReconcile(e,t){return[...(e.children||[]).filter((e=>{var i,n;return null!==(n=null===(i=e.element)||void 0===i?void 0:i.contains(t))&&void 0!==n?n:!this._settings.narrowOnChangeReconciliation&&this._tileNodeReader.critiques(e).length}))]}createTileNode(e,t){const i=this._observerFactory(b.j.AttributeObserver),n=this._paragraphNodesBuilder&&this._graphNodeFactory?this._graphNodeFactory(S.Z.TileNode,i,e,t,void 0,this._paragraphNodesBuilder):new x(this._proofingDom,this._tileContent,S.Z.TileNode,i,e,t,void 0,void 0,this.nodeTraverser,this._hostSettings);return this._hostSettings.disableTileNodeObserver||(i.onElementChanged=(e,t)=>{this._nodePoller.pollNodes(l.G.NewData,[n],t)},i.observe(document.body)),n}};A=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,D.W)(g.C)),(0,n.__param)(1,(0,D.W)(I.d)),(0,n.__param)(2,(0,D.W)(v.w)),(0,n.__param)(3,(0,D.W)(p.G)),(0,n.__param)(4,(0,D.W)(C.j)),(0,n.__param)(5,(0,D.W)(h.k)),(0,n.__param)(6,(0,D.W)(u.n)),(0,n.__param)(7,(0,D.W)(s)),(0,n.__param)(8,(0,D.W)(o.RW)),(0,n.__param)(9,(0,F.l)()),(0,n.__param)(9,(0,D.W)(c.M5)),(0,n.__param)(10,(0,F.l)()),(0,n.__param)(10,(0,D.W)(r.WP)),(0,n.__param)(11,(0,F.l)()),(0,n.__param)(11,(0,D.W)(f.u)),(0,n.__param)(12,(0,F.l)()),(0,n.__param)(12,(0,D.W)(_.S)),(0,n.__param)(13,(0,F.l)()),(0,n.__param)(13,(0,D.W)(y.n)),(0,n.__param)(14,(0,F.l)()),(0,n.__param)(14,(0,D.W)(m.M))],A);var R=i(10138),q=i(40315),P=i(23381),O=i(49878),k=i(95685);let z=class{constructor(e,t,i,n,s,o,r,a,l,d,c,u,h){this.hostSettings=e,this.proofingDom=t,this._settings=i,this._tileContent=n,this._tileNodeReader=s,this._nodePoller=o,this._textEventPublisher=r,this.logger=a,this.targetDocumentFactory=l,this._hostEmitter=d,this._graphNodeFactory=c,this._paragraphNodesBuilderFactory=u,this.shadowElementsStore=h}createGraphNode(e){const{element:t,filterSelector:i,parent:n,initialContentChangeType:s,documentModel:o,terminalNodeId:r}=e;if(!this._validateElementWithProofingDom(t))return;return this.getGraphNodeBuilderFactory(t,i,s).buildNode(t,n,o,r)}getGraphNodeBuilderFactory(e,t,i){const n=this.getObserverTypeBasedOnElement(e),s={ruleName:"",nodeMetaType:{nodeType:S.Z.TerminalNode,observerType:n,filters:[],filterSelector:t,initialContentChangeType:i},childMetaType:null};return new A(((e,t)=>function(e,t,i,n){const s=e=>new MutationObserver(e);switch(e){case b.j.InputNodeObserver:return new k.D(s,i);case b.j.TerminalNodeObserver:return new O.o(s,i);default:return new P.P(s,{ignoredMutationElementsSelectors:n},i)}}(e,0,this.logger,this.hostSettings.ignoredMutationElementsSelectors)),this._tileContent,this.proofingDom,this._nodePoller,this._tileNodeReader,this._settings,this.hostSettings,(()=>({find:e=>[e]})),s,this._hostEmitter,this._graphNodeFactory,this._paragraphNodesBuilderFactory,this.shadowElementsStore,this._textEventPublisher)}getObserverTypeBasedOnElement(e){return(0,a.C)(e,"HTMLInputElement")||(0,a.C)(e,"HTMLTextAreaElement")?b.j.InputNodeObserver:b.j.TerminalNodeObserver}_validateElementWithProofingDom(e){var t,i,n,s;if(!(0,a.C)(e,"HTMLElement"))return!0;for(const i of this.proofingDom.tileNodes.values())if((0,a.C)(i.element,"HTMLElement")&&(i.element.contains(e)||e.contains(i.element)))return null===(t=this.logger)||void 0===t||t.error(508146704,"The element is already contained within another attached element."),!1;if(!this.hostSettings.doNotLimitToTargetDocument&&this.targetDocumentFactory){const t=null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref();if(t&&e.ownerDocument!==t)return null===(n=this.logger)||void 0===n||n.error(508146703,"The element must be within the target document."),!1}return!!((0,a.C)(e,"HTMLInputElement")&&["text","search"].includes(e.type)||(0,a.C)(e,"HTMLTextAreaElement")||e.isContentEditable)||(null===(s=this.logger)||void 0===s||s.error(508146702,"Unsupported element - only input (of type search and text only), textarea, and content editable elements are supported."),!1)}};z=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,D.W)(u.n)),(0,n.__param)(1,(0,D.W)(v.w)),(0,n.__param)(2,(0,D.W)(h.k)),(0,n.__param)(3,(0,D.W)(I.d)),(0,n.__param)(4,(0,D.W)(C.j)),(0,n.__param)(5,(0,D.W)(p.G)),(0,n.__param)(6,(0,F.l)()),(0,n.__param)(6,(0,D.W)(y.n)),(0,n.__param)(7,(0,F.l)()),(0,n.__param)(7,(0,D.W)(R.g)),(0,n.__param)(8,(0,F.l)()),(0,n.__param)(8,(0,D.W)(q.Ze)),(0,n.__param)(9,(0,F.l)()),(0,n.__param)(9,(0,D.W)(c.M5)),(0,n.__param)(10,(0,F.l)()),(0,n.__param)(10,(0,D.W)(r.WP)),(0,n.__param)(11,(0,F.l)()),(0,n.__param)(11,(0,D.W)(f.u)),(0,n.__param)(12,(0,F.l)()),(0,n.__param)(12,(0,D.W)(_.S))],z)},9889:(e,t,i)=>{i.d(t,{m:()=>L});var n=i(79490),s=i(18104),o=i(76778),r=i(71924),a=i(68794),l=i(91513),d=i(82677),c=i(2915),u=i(10219),h=i(10138),g=i(21522),p=i(2010),m=i(69811),f=i(91538),v=i(29583),_=i(23943),y=i(65798),I=i(25530),C=i(81090),S=i(10779),b=i(99648),T=i(29906),E=i(66008),N=i(83010),x=i(27603),w=i(3033);let L=class{constructor(e,t,i,n,s,o,r){this._hostEmitters=e,this._proofingStore=t,this._featureFlagReader=i,this._logger=n,this._proofingDom=s,this._queryDetection=o,this._nodeTraverser=r,this.tileTracked=new Set}emitTileEvent(e,t,i,n,r,a,l,d,c,u){var h,g;r===s.G.NewData?this.tileTracked.add(t):r===s.G.RemoveData&&(this.tileTracked.delete(t),null===(h=this._queryDetection)||void 0===h||h.handleTileRemoved(t));const m=(0,b.F)(e);for(const e of this._hostEmitters)e.emit(o.pD.hostModelTextTile,{address:void 0,message:{messageType:r,data:{tileId:t,tileVersion:n,documentModel:null==m?void 0:m.documentModel,changeType:a,isTextNode:l===I.Z.ParagraphNode,tile:i?new p.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(g=i.formattedRanges)&&void 0!==g?g:[],{start:0,length:i.content.length,languageId:null!=d?d:this.getProofingLanguage()}]})):void 0,prevId:c,nextId:u}}})}emitParagraphDiffEvent(e){this.tileTracked.has(e.paragraphNode.id)||this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(540915291,"Delta event sent when no parent tile node was created."),this.emitDiffEvent(e.paragraphNode,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,r.pf.ParagraphNode,e.mutationChangeType,e.invalidationRanges)}emitTileDiffEvent(e,t,i,n,s,o,a,l,d){const c=a.unreconciledContent.some((e=>e.textUnit===y.fT.Paragraph))?m.OD.Paragraph:a.unreconciledContent.some((e=>e.textUnit===y.fT.Sentence))?m.OD.Sentence:s?m.OD.Word:m.OD.Chars,u=this.getProofingLanguage(),h=a.unreconciledContent.map((e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:(0,C.d)(e.textUnit),languageId:null!=d?d:u})));this.emitDiffEvent(e,t,i,n,o,c,r.pf.TileNode,l,h)}emitMoveTileEvent(e,t,i,n,s,r,a,l,d){var c;for(const u of this._hostEmitters)u.emit(o.pD.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:n,oldDocumentModel:l,newDocumentModel:d,tile:new p.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(c=i.formattedRanges)&&void 0!==c?c:[],{start:0,length:i.content.length,languageId:null!=s?s:this.getProofingLanguage()}]})),prevId:r,nextId:a}})}emitParagraphNodeTileEvents(e,t,i,n){const r=(0,b.F)(e),a=t.removedNodes.map((t=>{var n;return{messageType:s.G.RemoveData,data:{tileId:t,tileVersion:null!==(n=e.eventSeqId)&&void 0!==n?n:0,documentModel:null==r?void 0:r.documentModel,changeType:i,isTextNode:!0,tile:void 0}}}));a.push(...t.unreconciledContent.map((o=>{var a,l,d;const c=this._proofingDom.findParagraphNode(o.header.elementId.id),u=c?null===(a=this._nodeTraverser)||void 0===a?void 0:a.findPreviousParagraphNode(c):void 0,h=c?null===(l=this._nodeTraverser)||void 0===l?void 0:l.findNextParagraphNode(c):void 0;return{messageType:this._featureFlagReader.flags.enableParagraphUpdates&&!t.addedNodes.includes(o.header.elementId.id)?s.G.ChangeData:s.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:null!==(d=e.eventSeqId)&&void 0!==d?d:0,documentModel:null==r?void 0:r.documentModel,changeType:i,isTextNode:!0,tile:new p.Cg(Object.assign(Object.assign({},n),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:this.getProofingLanguage(o.proofingLanguages)}]})),prevId:"#head#"===u?u:null==u?void 0:u.id,nextId:"#tail#"===h?h:null==h?void 0:h.id}}})));for(const e of this._hostEmitters)e.emit(o.pD.hostModelParagraphTextTiles,{address:void 0,message:a})}getProofingLanguage(e){return a.I.getDefaultLanguageCode(null!=e?e:this._proofingStore.getCachedEntry(l.l.ProofingLanguages).storeEntryValue)}findAttributionRangesForDelta(e,t,i){if(!this._featureFlagReader.flags.enableAttributionRangeInAddDelta||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let n;for(n=0;n<e.length;n++){const i=e[n],s=t[n];if(i.start!==s.start||i.length<s.length||!(0,d.G)(i.attribution,s.attribution))break}return t[n]?t[n].start!==i?t:t.slice(n):[]}createAttributionDelta(e,t){const i={deltaType:m.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},n=new f.s(i);return(0,r.Bb)(n)?n:(this._logger.error(506204486,"Delta is not a formatted text tile delta with attribution ranges even though it should be"),i)}emitDiffEvent(e,t,i,n,s,a,l,d,c){var u,h,g,p;const v=null!==(u=null==t?void 0:t.content)&&void 0!==u?u:"",_=i.content,y=n.firstDiffLeft,I=v.length-n.firstDiffRight,C=_.length-n.firstDiffRight,S=v.length===_.length?m.WI.Update:I===y?m.WI.Add:C===y?m.WI.Delete:m.WI.Update;let T,E,N,x;const w=()=>this.findAttributionRangesForDelta(null==t?void 0:t.attributionRanges,i.attributionRanges,y);switch(S){case m.WI.Update:T=I-y,E=_.substring(y,C),x=w(),N=v.substring(y,I);break;case m.WI.Add:T=0,E=_.substring(y,C),x=w();break;case m.WI.Delete:T=I-y,N=v.substring(y,I),x=w()}let L=new f.s({deltaType:S,unit:a,position:y,length:T,content:E,wordCount:s,invalidationRanges:c,userInfo:{userType:d===r.Q0.Local?m.HS.SessionUser:d===r.Q0.Remote?m.HS.Collaborator:m.HS.Programmatic}});const D=l===r.pf.ParagraphNode?null===(h=this._queryDetection)||void 0===h?void 0:h.handleTileDelta(e.id,L,_,d,N):void 0;L=Object.assign(Object.assign({},L),D);const F=(0,b.F)(e);for(const t of this._hostEmitters)t.emit(o.pD.hostModelDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(g=e.eventSeqId)&&void 0!==g?g:0,documentModel:null==F?void 0:F.documentModel,delta:L,sourceType:l,changeType:d,deletedOrReplacedCharacters:N}}),this._featureFlagReader.flags.enableAttributionRangeInAddDelta&&x&&x.length>0&&e.id&&void 0!==e.eventSeqId&&t.emit(o.pD.hostModelAttributionDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(p=e.eventSeqId)&&void 0!==p?p:0,documentModel:null==F?void 0:F.documentModel,sourceType:l,delta:this.createAttributionDelta(x,x===i.attributionRanges)}})}emitFormattingDiffEventDeprecated(e,t,i){var n;const s=(0,b.F)(e),r=Array.isArray(i)?new f.s({deltaType:m.WI.FormattingUpdate,formattedRanges:i}):new f.s({deltaType:m.WI.OtherNonContentUpdate,otherNonContentData:i});for(const i of this._hostEmitters)i.emit(o.pD.hostModelFormattingDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(n=e.eventSeqId)&&void 0!==n?n:0,documentModel:null==s?void 0:s.documentModel,delta:r,sourceType:t}})}emitFormattingDiffEvent(e,t,i){var n;if(!this._featureFlagReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas)return(0,w.Dt)(i)?void this._logger.error(506331489,"Unexpected formatted text range props in deprecated formatted text deltas"):this.emitFormattingDiffEventDeprecated(e,t,i);const s=(0,b.F)(e);for(const r of this._hostEmitters)r.emit(o.pD.hostModelFormattingDelta,{address:void 0,message:(0,S.Fd)(e.id,null!==(n=e.eventSeqId)&&void 0!==n?n:0,null==s?void 0:s.documentModel,t,i)})}};L=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,E.t)(o.zJ)),(0,n.__param)(1,(0,N.W)(c.K)),(0,n.__param)(2,(0,N.W)(u.c)),(0,n.__param)(3,(0,N.W)(h.g)),(0,n.__param)(4,(0,N.W)(_.w)),(0,n.__param)(5,(0,x.l)()),(0,n.__param)(5,(0,N.W)(g.J)),(0,n.__param)(6,(0,x.l)()),(0,n.__param)(6,(0,N.W)(v.M))],L)},68598:(e,t,i)=>{i.d(t,{V:()=>n});const n=(0,i(76729).f)("IElementsRetriever")},22923:(e,t,i)=>{i.d(t,{Bc:()=>s,RW:()=>o});var n=i(76729);const s=(0,n.f)("IGrammarTerminalSymbol"),o=(0,n.f)("IGrammarNonTerminalSymbolExpanded");(0,n.f)("IGrammarRules")},33999:(e,t,i)=>{i.d(t,{Om:()=>o,WP:()=>s,ZR:()=>r});var n=i(76729);const s=(0,n.f)("IGraphNodeFactory"),o=(0,n.f)("IParagraphNodeFactory");function r(e){return!!e&&"id"in e&&"nodeType"in e}},68914:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(76729).f)("IHostTilingEmitter")},80465:(e,t,i)=>{i.d(t,{C:()=>s,V:()=>o});var n=i(76729);const s=(0,n.f)("INodeObserverFactory"),o=(0,n.f)("IMutationObserverFactory")},29583:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(76729).f)("INodeTraverser")},4464:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(76729).f)("IParagraphFormattingExtractor")},99261:(e,t,i)=>{i.d(t,{W:()=>o,u:()=>s});var n=i(76729);const s=(0,n.f)("IParagraphNodesBuilderFactory"),o=(0,n.f)("IParagraphNodesBuilder")},95490:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(76729).f)("IParagraphNodesEventEmitter")},15168:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(76729).f)("IParagraphTextExtractor")},9583:(e,t,i)=>{i.d(t,{q:()=>n});const n=(0,i(76729).f)("IShadowGraphFactory")},43560:(e,t,i)=>{i.d(t,{l:()=>n});const n=(0,i(76729).f)("ITerminalNodeBuilder")},39847:(e,t,i)=>{if(i.d(t,{$:()=>s}),2063!=i.j)var n=i(25530);function s(e){return(null==e?void 0:e.nodeType)===n.Z.TileNode&&!!e.element&&!!e.children&&e.children.every((e=>e.nodeType===n.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element))}},3783:(e,t,i)=>{var n;i.d(t,{j:()=>n}),function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(n||(n={}))},25530:(e,t,i)=>{var n;i.d(t,{Z:()=>n}),function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(n||(n={}))},16762:(e,t,i)=>{i.d(t,{T:()=>a});var n=i(79490),s=i(38471),o=i(25530),r=i(29906);let a=class extends s.W{constructor(e,t,i,n,s){super(o.Z.OutlineNode,e,t,i,n,s),this._observer=e,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};a=(0,n.__decorate)([(0,r._)()],a)},42629:(e,t,i)=>{i.d(t,{C:()=>d});var n=i(79490),s=i(23943),o=i(3033),r=i(29906),a=i(83010),l=i(94526);let d=class{constructor(e){this._proofingDom=e}getFormattingAt(e,t=0,i=-1){let n=null;if(n="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,l.l)(n)){const e=n.parent.textFormattingInfo;if(e){const s=n.element.offset+t;return(0,o.FD)(e,s,i<0?s+n.element.span:s+i)}}}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.w))],d)},94526:(e,t,i)=>{i.d(t,{f:()=>l,l:()=>d});var n=i(79490),s=i(21711),o=i(83010),r=i(23943),a=i(25530);let l=class{constructor(e,t,i,n){this._guidGenerator=e,this._proofingDom=t,this.eventSeqId=0,this.nodeType=a.Z.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=i,this.parent=n,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};function d(e){var t;return(null==e?void 0:e.nodeType)===a.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element&&(null===(t=e.parent)||void 0===t?void 0:t.nodeType)===a.Z.TileNode&&!!e.parent.element&&!!e.parent.children}l=(0,n.__decorate)([(0,n.__param)(0,(0,o.W)(s.G)),(0,n.__param)(1,(0,o.W)(r.w))],l)},75502:(e,t,i)=>{i.d(t,{B:()=>a,Y:()=>r});var n=i(79490),s=i(76729),o=i(29906);const r=(0,s.f)("IParagraphNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,o._)()],a)},80214:(e,t,i)=>{i.d(t,{zR:()=>N});var n=i(79490),s=i(91513),o=i(71924),r=i(18104),a=i(2915),l=i(11804),d=i(10219),c=i(67843),u=i(10138),h=i(8694),g=i(68914),p=i(29583),m=i(33999),f=i(95490),v=i(61871),_=i(25530),y=i(76729),I=i(29906),C=i(83010),S=i(27603),b=i(3033);const T=(0,y.f)("CompleteTileTextUnitToken"),E=(0,y.f)("PartialTileTextUnit");let N=class{constructor(e,t,i,n,s,o,r,a,l,d,c,u,h){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=i,this.settings=n,this._hostSettings=s,this._featureFlagReader=o,this._hostTilingEmitter=r,this._paragraphNodesEventEmitter=a,this._paragraphDeltasEnabled=l,this._logger=d,this.nodeTraverser=c,this._completeTileTextUnit=null!=u?u:n.completeTileTextUnit,this._partialTileTextUnit=null!=h?h:n.partialTileTextUnit}updateParagraphNodes(e,t,i,n,s,o,r){if(!this._hostSettings.enableOrchestration||!this._featureFlagReader.flags.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,i,n,s);const a={oldTextInfo:t,newTextInfo:i,tileNode:e,sequenceId:s,minDiffBounds:n,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(a),this._addNewChildren(a),this._buildGraphTransaction(a,o,r),a.graphTransaction}_updateExistingChildren(e){var t,i,n;if(!(null===(t=e.tileNode.children)||void 0===t?void 0:t.length))return;const s=null!==(n=null===(i=e.oldTextInfo)||void 0===i?void 0:i.content)&&void 0!==n?n:"",o=e.newTextInfo.content,r=s!==o,a={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let l=e.tileNode.children.length-1;for(;l>=0;){const t=e.tileNode.children[l].element;if(t){if(s.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=o.length-s.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!r)){t.offset<e.minDiffBounds.firstDiffLeft&&(a.firstDiffLeft=Math.min(t.offset,a.firstDiffLeft));const i=s.length-t.offset-t.span;i<e.minDiffBounds.firstDiffRight&&(a.firstDiffRight=Math.min(i,a.firstDiffRight));const n=e.tileNode.children.splice(l,1);e.nodesToRetire.length&&a.firstDiffRight!==i?a.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...n):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...n):e.nodesToRetire.push(...n)}l-=1}else l-=1}e.unitRange={offset:a.firstDiffLeft,span:o.length-a.firstDiffRight-a.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._hostSettings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e.newTextInfo.content,e.minDiffBounds,this._completeTileTextUnit,e.unitRange);for(const i of t){const t=this._graphNodeFactory(i,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.element&&(e.element.textUnit=!1===e.element.validEndBoundary&&this._hostSettings.enableOptimizedCallingPattern&&!0!==e.element.enforcedCompleteTileTextUnit?this._partialTileTextUnit:this._completeTileTextUnit)}_buildTile(e,t,i,n){var o,r,a,l,d;const c=null!==(r=null===(o=t.element)||void 0===o?void 0:o.offset)&&void 0!==r?r:0,u=null!==(l=null===(a=t.element)||void 0===a?void 0:a.span)&&void 0!==l?l:i.length;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:c,span:u},length:i.length},data:i.slice(c,c+u),proofingLanguages:this._proofingPersistedStore.getCachedEntry(s.l.ProofingLanguages).storeEntryValue,textUnit:null===(d=t.element)||void 0===d?void 0:d.textUnit}}_convertToUpdate(e,t,i,n,s,o){var r,a;if(!(null==e?void 0:e.element)||!(null==t?void 0:t.element))return;const l=null!==(a=null===(r=i.oldTextInfo)||void 0===r?void 0:r.content)&&void 0!==a?a:"",d=i.newTextInfo.content,c=l.length-e.element.offset-e.element.span,u=d.length-t.element.offset-t.element.span;if(!n&&e.element.offset!==t.element.offset||n&&c!==u)return;const h=this._emitParagraphDeltaUpdate(e,t,i,s,o);return e.element.offset=t.element.offset,e.element.span=t.element.span,e.element.validEndBoundary=t.element.validEndBoundary,e.element.enforcedCompleteTileTextUnit=t.element.enforcedCompleteTileTextUnit,e.element.textUnit=t.element.textUnit,t.retire(),i.nodesToAdd.splice(n?i.nodesToAdd.length-1:0,1),i.nodesToInsert.splice(n?i.nodesToInsert.length-1:0,1,e),i.nodesToRetire.splice(n?i.nodesToRetire.length-1:0,1),i.nodesToUpdate.push(e),i.graphTransaction.unreconciledContent.find((i=>{const n=i.header.elementId.id===t.id;return n&&(i.header.elementId.id=e.id),n})),h}_buildGraphTransaction(e,t,i){e.nodesToInsert=[...e.nodesToAdd];const n=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,i),s=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,i);x(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();n&&this._hostTilingEmitter.emitParagraphDiffEvent(n),s&&this._hostTilingEmitter.emitParagraphDiffEvent(s),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,i,n,s){var o;const r={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},a=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",i.content,n,r);return this._addNewChildrenDeprecated(e,i,n,s,a,r)}_updateExistingChildrenDeprecated(e,t,i,n,s){var o;if(null===(o=e.children)||void 0===o?void 0:o.length){const o=Object.assign({},n),r=t!==i;let a=e.children.length-1;for(;a>=0;){const l=e.children[a].element;if(l)if(l.offset<n.firstDiffLeft&&l.offset+l.span<n.firstDiffLeft||l.offset+l.span===n.firstDiffLeft&&l.validEndBoundary&&r);else if(t.length-l.offset<n.firstDiffRight)l.offset=i.length-t.length+l.offset,s.updatedNodes.push(e.children[a].id);else{l.offset<n.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const i=t.length-l.offset-l.span;i<n.firstDiffRight&&(o.firstDiffRight=Math.min(i,o.firstDiffRight));const r=e.children.splice(a,1);for(const e of r)s.removedNodes.push(e.id),e.retire()}a-=1}return{offset:o.firstDiffLeft,span:i.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._hostSettings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,i,n,s,o){const r=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t.content,i,this._completeTileTextUnit,s),a=[];for(const i of r){const s=this._graphNodeFactory(i,e);this._attachTextUnit(s),a.push(s),o.unreconciledContent.push(this._buildTile(e,s,t.content,n)),o.addedNodes.push(s.id)}return x(e,a),o}_emitParagraphDeltaUpdate(e,t,i,n,s){if(this._paragraphDeltasEnabled.check()){if(!e.element||!t.element)return;const o=(0,b.Gn)(i.oldTextInfo,e.element.offset,e.element.offset+e.element.span),r=(0,b.Gn)(i.newTextInfo,t.element.offset,t.element.offset+t.element.span);if(e.registered||this._emitParagraphAdd(i,e,n),void 0!==e.eventSeqId){e.eventSeqId+=1;const i=this._paragraphNodesEventEmitter.generateDeltaEventInformation(e,o,r,!!t.element.validEndBoundary,!!t.element.enforcedCompleteTileTextUnit,n,s,e.cachedWordCount);return e.cachedWordCount=i.wordCount,i}}}_emitParagraphDeltaAdd(e,t){if(this._paragraphDeltasEnabled.check())for(const i of e.nodesToAdd)this._emitParagraphAdd(e,i,t)}_emitParagraphAdd(e,t,i){var n,s;if(t.registered)return void(this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.info(539002012,"The node has been registered, skipping"));const a=this._featureFlagReader.flags.enableParagraphDeltasEmptyInitialTile&&i===o.Q0.Local;if(t.element){const o=(0,b.Gn)(e.newTextInfo,t.element.offset,t.element.offset+t.element.span);t.eventSeqId=0;const l=null===(n=this.nodeTraverser)||void 0===n?void 0:n.findPreviousParagraphNode(t),d=null===(s=this.nodeTraverser)||void 0===s?void 0:s.findNextParagraphNode(t);this._hostTilingEmitter.emitTileEvent(e.tileNode,t.id,Object.assign(Object.assign({},o),{content:a?"":o.content,attributionRanges:a?[]:o.attributionRanges}),t.eventSeqId,r.G.NewData,i,_.Z.ParagraphNode,this.getSpecifiedLocaleForNode(t),"#head#"===l?l:null==l?void 0:l.id,"#tail#"===d?d:null==d?void 0:d.id),a&&(t.eventSeqId+=1,this._hostTilingEmitter.emitParagraphDiffEvent(this._paragraphNodesEventEmitter.generateDeltaEventInformation(t,void 0,o,!!t.element.validEndBoundary,!0,i,!1,0))),t.registered=!0}else this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(539002013,"Anchor element is undefined for the node to add")}_emitParagraphDeltaRetire(e,t){var i;if(this._paragraphDeltasEnabled.check())for(const n of e.nodesToRetire)n.registered=!1,this._hostTilingEmitter.emitTileEvent(e.tileNode,n.id,{content:""},null!==(i=n.eventSeqId)&&void 0!==i?i:0,r.G.RemoveData,t,_.Z.ParagraphNode,this.getSpecifiedLocaleForNode(n))}getSpecifiedLocaleForNode(e){var t,i;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(i=e.parent)||void 0===i?void 0:i.specifiedLocale}};function x(e,t){if(t.length&&e.children&&t[0].element){const i=t[0].element.offset;if(e.children.length){let n=e.children.length-1,s=t;for(;n>=0;){const t=e.children[n].element;if(t&&i>t.offset){e.children.splice(n,0,...s),s=[];break}n-=1}s.length&&e.children.splice(0,0,...s)}else e.children=t}}N=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.W)(a.K)),(0,n.__param)(1,(0,C.W)(m.Om)),(0,n.__param)(2,(0,C.W)(v.D)),(0,n.__param)(3,(0,C.W)(h.k)),(0,n.__param)(4,(0,C.W)(l.n)),(0,n.__param)(5,(0,C.W)(d.c)),(0,n.__param)(6,(0,C.W)(g.d)),(0,n.__param)(7,(0,C.W)(f.b)),(0,n.__param)(8,(0,C.W)(c.H)),(0,n.__param)(9,(0,C.W)(u.g)),(0,n.__param)(10,(0,C.W)(p.M)),(0,n.__param)(10,(0,S.l)()),(0,n.__param)(11,(0,S.l)()),(0,n.__param)(11,(0,C.W)(T)),(0,n.__param)(12,(0,S.l)()),(0,n.__param)(12,(0,C.W)(E))],N)},17795:(e,t,i)=>{i.d(t,{S:()=>g});var n=i(79490),s=i(8694),o=i(72232),r=i(61871),a=i(65798),l=i(81628),d=i(69811),c=i(81090),u=i(29906),h=i(83010);let g=class{constructor(e,t,i){this._wordCountDetector=e,this._hostModelSettings=t,this._textUnitChunker=i}generateDeltaEventInformation(e,t,i,n,s,o,r,u){var h;const g=null!==(h=null==t?void 0:t.content)&&void 0!==h?h:"",p=i.content,m=l.CC(g,p);r&&(m.firstDiffLeft-=1);let f=!1;if(!n&&this._hostModelSettings.partialTileTextUnit!==a.fT.Phrase&&this._hostModelSettings.partialTileTextUnit!==this._hostModelSettings.completeTileTextUnit){const e=m.firstDiffLeft,t=p.length-m.firstDiffRight;f=-1!==this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit).findEndBoundary(p,e-1,t)}const v=null!=u?u:this._wordCountDetector.getWordCount(g),_=this._wordCountDetector.hasWordCountChanged(m,v,p),y=s?(0,c.d)(this._hostModelSettings.completeTileTextUnit):f?(0,c.d)(this._hostModelSettings.partialTileTextUnit):_.isWordCountChanged?n?(0,c.d)(this._hostModelSettings.completeTileTextUnit):d.OD.Word:d.OD.Chars;let I;if(this._hostModelSettings.completeTileTextUnit===a.fT.Paragraph&&this._hostModelSettings.partialTileTextUnit===a.fT.Sentence&&y!==d.OD.Paragraph){const e=m.firstDiffLeft,t=this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit),i=t.findBeginBoundary(p,e,0),n=t.findEndBoundary(p,e-1,p.length);I=[{position:i,length:(-1===n?p.length:n)-i,unit:d.OD.Sentence}]}return{paragraphNode:e,oldTextInfo:t,newTextInfo:i,minDiffBounds:m,wordCount:_.wordCount,deltaUnit:y,mutationChangeType:o,invalidationRanges:I}}};g=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(o.B)),(0,n.__param)(1,(0,h.W)(s.k)),(0,n.__param)(2,(0,h.W)(r.D))],g)},53861:(e,t,i)=>{i.d(t,{o:()=>c});var n=i(79490),s=i(29583),o=i(23943),r=i(29906),a=i(83010),l=i(27603),d=i(94526);let c=class{constructor(e,t){this._proofingDom=e,this._tileNodeTraverser=t}getParagraphText(e){let t=null;if(t="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,d.l)(t)){const e=t.parent.plainText,i=t.element.offset,n=t.element.span,s=t.element.span?i+n:void 0;return e.substring(i,s).replace(/\u00A0/g," ")}}getQueryString(e,t,i){const n=this.getParagraphText(e);if(!n)return 0===t.start&&0===t.length&&""===t.prefix?"":void 0;return n.substring(t.start+(i?0:void 0===t.prefix?1:t.prefix.length),t.start+t.length)}getTextBetween(e,t,i=0,n=-1){var s;let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let r=null;if(r="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,d.l)(o)&&(0,d.l)(r)){if(o.parent.element===r.parent.element)return this.getSubsetOfParagraph(o.parent,o.element.offset+i,r.element.offset+(-1===n?r.element.span:n));{let e,t=this.getSubsetOfParagraph(o.parent,o.element.offset+i,void 0)+"\n",a=o.parent;do{if(e=null===(s=this._tileNodeTraverser)||void 0===s?void 0:s.findNextTileNode(a),!e||"#tail#"===e)return;a=e,t+=this.getSubsetOfParagraph(a,0,a.id===r.parent.id?r.element.offset+(-1===n?r.element.span:n):void 0)+(a.id===r.parent.id?"":"\n")}while(a.id!==r.parent.id);return t}}}getSubsetOfParagraph(e,t,i){return e.plainText.substring(t,i).replace(/\u00A0/g," ")}};c=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.w)),(0,n.__param)(1,(0,a.W)(s.M)),(0,n.__param)(1,(0,l.l)())],c)},30844:(e,t,i)=>{i.d(t,{j:()=>o});var n=i(79490),s=i(29906);let o=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}clear(){this._contexts=[]}};o=(0,n.__decorate)([(0,s._)()],o)},45634:(e,t,i)=>{i.d(t,{h:()=>g});var n=i(79490),s=i(11804),o=i(19470),r=i(10138),a=i(46032),l=i(21574),d=i(99648),c=i(29906),u=i(83010),h=i(27603);let g=class{constructor(e,t,i,n,s){this._tileNodeReader=e,this._hostSettings=t,this._optimizedRehydrationEnabled=i,this._logger=n,this._textEventPublisher=s}pollNodes(e,t,i,n,s,o,r,a){var l,c,u,h;if(this._textEventPublisher&&!0===this._hostSettings.sdkV2Enabled){const n=[];for(const e of t)if(this._tileNodeReader.isTileNode(e))try{const t=(0,d.F)(e);n.push({text:e.pullText(),mutationChangeType:i,tileNodeId:e.id,rehydrateCritiques:s,forceTileDiffEmission:r,mutationWasTextReplacement:a,documentModel:null==t?void 0:t.documentModel,previousNodeId:this._tileNodeReader.getPreviousTileId(e),nextNodeId:this._tileNodeReader.getNextTileId(e),optimizedRehydrationEnabled:this._optimizedRehydrationEnabled.check(),brokerOptions:{critiques:null==o?void 0:o.get(e.id),forceReflow:!0}})}catch(e){null===(c=this._logger)||void 0===c||c.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(l=this._logger)||void 0===l||l.error(0,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack});this._textEventPublisher.publishTextChangeEvent(n,e)}else for(const e of t)if(this._tileNodeReader.isTileNode(e))try{this._tileNodeReader.reconcile(e,i,null==o?void 0:o.get(e.id),!0,s,r,a)}catch(e){null===(h=this._logger)||void 0===h||h.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(u=this._logger)||void 0===u||u.error(509727256,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack})}removeQueuedTiles(e){}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(l.j)),(0,n.__param)(1,(0,u.W)(s.n)),(0,n.__param)(2,(0,u.W)(o.W)),(0,n.__param)(3,(0,h.l)()),(0,n.__param)(3,(0,u.W)(r.g)),(0,n.__param)(4,(0,h.l)()),(0,n.__param)(4,(0,u.W)(a.n))],g)},50518:(e,t,i)=>{i.d(t,{x:()=>a});var n=i(79490),s=i(29906),o=i(38471),r=i(25530);let a=class extends o.W{constructor(e,t,i,n){super(r.Z.TerminalNode,e,void 0,t,i,n),this._observer=e,this.retiredCallbacks=[],this.visualizationRemovedCallbacks=[],this.element&&this._observer.observe(this.element)}retire(){for(const e of this.retiredCallbacks)e();this.retiredCallbacks=[],this.visualizationWasRemoved(),super.retire()}move(e,t){if(super.move(e,t),this.children)for(const t of this.children)t.move(e);return this.element&&this._observer.observe(this.element),this}resetState(){}registerRetireCallback(e){this.retiredCallbacks.push(e)}registerVisualizationRemovedCallback(e){this.visualizationRemovedCallbacks.push(e)}visualizationWasRemoved(){for(const e of this.visualizationRemovedCallbacks)e();this.visualizationRemovedCallbacks=[]}};a=(0,n.__decorate)([(0,s._)()],a)},7926:(e,t,i)=>{i.d(t,{h:()=>a,k:()=>r});var n=i(79490),s=i(76729),o=i(29906);const r=(0,s.f)("ITerminalNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,o._)()],a)},58862:(e,t,i)=>{i.d(t,{b:()=>p});var n=i(79490),s=i(18104),o=i(71924),r=i(76778),a=i(81628),l=i(29906),d=i(38471),c=i(25530),u=i(69811),h=i(3033),g=i(99648);let p=class extends d.W{constructor(e,t,i,n,r,a,l,d,u,h,g,p,m,f,v,_,y,I,C,S,b,T){super(f,v,void 0,y,S,b),this._guidGenerator=e,this._logger=t,this._wordCount=i,this._wordCountDetector=n,this._settings=r,this._nodePoller=a,this._proofingDom=l,this._tileContent=d,this._hostSettings=u,this.featureFlagsReader=h,this._paragraphDeltasEnabled=g,this._optimizedRehydrationEnabled=p,this._hostTilingEmitter=m,this.nodeType=f,this._observer=v,this._paragraphNodesBuilder=_,this.element=y,this._hostEmitters=I,this.nodeTraverser=C,this.parent=S,this.queryDetection=T,this._children=[],this._cachedWordCount=0,this._cachedTiles=new Map,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetState(!0),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,s.G.NewData,o.Q0.Code,c.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}get children(){var e;return this._hostSettings.sdkV2Enabled?null!==(e=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==e?e:[]:this._children}set children(e){this._children=e}getPreviousTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}retire(){this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this._hostSettings.enableOrchestration&&(this._hostTilingEmitter.emitTileEvent(this,this.id,void 0,this._eventSeqId,s.G.RemoveData,o.Q0.Code,c.Z.TileNode,this.specifiedLocale),this.removeAllParagraphNodesFromAugloop()),this.parent=void 0,this._cachedTextInfo=void 0,this._currentText=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._logger.debug(562057756,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}removeAllParagraphNodesFromAugloop(){if(!this._hostSettings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._paragraphDeltasEnabled.check())for(const t of e)this._hostTilingEmitter.emitTileEvent(this,t,void 0,this._eventSeqId,s.G.RemoveData,o.Q0.Code,c.Z.ParagraphNode,this.specifiedLocale);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},o.Q0.Code,void 0)}move(e,t){var i;const n=(0,g.F)(this),s=(0,g.F)(null!=t?t:this);this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const o=this.id;return super.move(e,t),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(o,this.id,null!==(i=this._cachedTextInfo)&&void 0!==i?i:{content:""},this._eventSeqId,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId(),null==n?void 0:n.documentModel,null==s?void 0:s.documentModel),this._proofingDom.registerNode(this),this}resetState(e){e||this.removeAllParagraphNodesFromAugloop(),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();if(this.children=[],this._invalidationDiffBounds=void 0,!e){for(const e of this._hostEmitters)e.emit(r.pD.hostModelTileStateReset,{address:void 0,message:this.id});this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,s.G.NewData,o.Q0.Code,c.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,i,n,s,o){var r,l,d,c,g,p;if(this.parent){const t=null!==(r=this._tileContent.getText(this))&&void 0!==r?r:{content:""},i=null!==(d=null===(l=this._cachedTextInfo)||void 0===l?void 0:l.content)&&void 0!==d?d:"",m=t.content;this._currentText=t;const f=a.CC(i,m);if(o&&(f.firstDiffLeft-=1),m!==i&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},f)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,f.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,f.firstDiffRight)),m===i&&this.children.length>0&&(!n||this._optimizedRehydrationEnabled.check())){if(n){let i=this.children[0];for(const e of this.children)e.element&&e.element.offset>(null!==(g=null===(c=i.element)||void 0===c?void 0:c.offset)&&void 0!==g?g:0)&&(i=e);if(i.element){const n=(0,h.Gn)(t,i.element.offset,i.element.offset+i.element.span);this._hostTilingEmitter.emitParagraphDiffEvent({paragraphNode:i,oldTextInfo:n,newTextInfo:n,minDiffBounds:{firstDiffLeft:i.element.span,firstDiffRight:0},wordCount:null!==(p=i.cachedWordCount)&&void 0!==p?p:0,deltaUnit:u.OD.Sentence,mutationChangeType:e,invalidationRanges:void 0})}}return this._hostSettings.enableOrchestration&&(s||n)&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,t,f,!1,this._cachedWordCount,{addedNodes:[],removedNodes:[],updatedNodes:[],unreconciledContent:Array.from(this._cachedTiles.values())},e,this.specifiedLocale)),this._reconcileFormatting(t,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),void(this._cachedTextInfo=t)}return this._reconcileState(t,f,null!=n&&n,e,null!=o&&o)}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId)}get critiques(){return[]}get textFormattingInfo(){return this._currentText}_reconcileState(e,t,i,n,s){var r;const a=this._seqId+1,l=e.content;let d;if(this._paragraphDeltasEnabled.check())d=!1,this._cachedWordCount=0;else if(this._hostSettings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,l);d=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else d=this._reconcileWordCount(t,l);const c=this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedTextInfo,e,t,a,n,s);if(this._reconcileParagraphs(c,a),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,e,t,d,this._cachedWordCount,c,n,this.specifiedLocale)),this._reconcileFormatting(e,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),this._cachedTextInfo=e,i||d||this._hostSettings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._hostSettings.enableOptimizedCallingPattern&&n!==o.Q0.Code&&this._tryScheduleReconcileTimer(),this._hostSettings.enableOrchestration){for(const e of c.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);if(c.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._paragraphDeltasEnabled.check())for(const e of c.removedNodes)null===(r=this.queryDetection)||void 0===r||r.handleTileRemoved(e);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,c,n,e)}return this._resetInvalidationStateAndReturnTiles(c.unreconciledContent,a)}this._tryScheduleReconcileTimer()}_reconcileFormatting(e,t){var i,n;if(this._cachedTextInfo){if(this.featureFlagsReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas){const n=t&&!(0,h.V8)(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!(0,h.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)||n){for(const t of this.children){if(!t.element)continue;const i=t.element.offset+t.element.span,s=(0,h.Wi)(this._cachedTextInfo,t.element.offset,i),r=(0,h.Wi)(e,t.element.offset,i);(0,h.V8)(s.formattedRanges,r.formattedRanges)&&!n||(n?this._hostTilingEmitter.emitFormattingDiffEvent(t,o.pf.ParagraphNode,{formattedRanges:r.formattedRanges,attributionRanges:r.attributionRanges}):this._hostTilingEmitter.emitFormattingDiffEvent(t,o.pf.ParagraphNode,{formattedRanges:r.formattedRanges}))}this._hostTilingEmitter.emitFormattingDiffEvent(this,o.pf.TileNode,null!==(i=e.formattedRanges)&&void 0!==i?i:[])}}else if(!(0,h.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){if(!t.element)continue;const i=(0,h.FD)(this._cachedTextInfo,t.element.offset,t.element.offset+t.element.span),n=(0,h.FD)(e,t.element.offset,t.element.offset+t.element.span);(0,h.V8)(i,n)||this._hostTilingEmitter.emitFormattingDiffEvent(t,o.pf.ParagraphNode,n)}this._hostTilingEmitter.emitFormattingDiffEvent(this,o.pf.TileNode,null!==(n=e.formattedRanges)&&void 0!==n?n:[])}if(!(0,h.V8)(this._cachedTextInfo.objectReferences,e.objectReferences)||!(0,h.lX)(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of h._E)"objectReferences"!==e&&delete t[e];for(const e of this.children)e.element&&this._hostTilingEmitter.emitFormattingDiffEvent(e,o.pf.ParagraphNode,t);this._hostTilingEmitter.emitFormattingDiffEvent(this,o.pf.TileNode,t)}}}_reconcileWordCount(e,t){const i=this._wordCountDetector.getWordCount(t);let n=0;e.firstDiffLeft<=t.length&&(n=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const s=i>0&&(i!==this._cachedWordCount||n>1);return this._cachedWordCount=i,s}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,i]of this._cachedTiles){this._proofingDom.findParagraphNode(e)?i.header.seqId=t.toString():this._cachedTiles.delete(e)}e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds)&&(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout((()=>{this._logger.debug(562057757,"Dirty range timer has fired."),this._nodePoller.pollNodes(s.G.NewData,[this],o.Q0.Code,void 0,!0),this._clearReconcileTimer()}),this._settings.reconcileTileNodeTime),!0)}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(562057758,"Dirty range timer has been cleared."))}get eventSeqId(){return this._eventSeqId}get plainText(){var e,t;return null!==(t=null===(e=this._currentText)||void 0===e?void 0:e.content)&&void 0!==t?t:""}};p=(0,n.__decorate)([(0,l._)()],p)},73598:(e,t,i)=>{i.d(t,{o:()=>r,v:()=>a});var n=i(79490),s=i(76729),o=i(29906);const r=(0,s.f)("ITileNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,o._)()],a)},35400:(e,t,i)=>{i.d(t,{j:()=>p});var n=i(79490),s=i(18104),o=i(71924),r=i(76778),a=i(21522),l=i(29906),d=i(66008),c=i(83010),u=i(27603),h=i(5923),g=i(23943);let p=class{constructor(e,t,i,n){this._hostEmitters=e,this._nodePoller=t,this._proofingDom=i,this._queryDetection=n,this.rehydrateTiles=e=>{const t=e.message;if(t.length>0)for(const e of t){const t=this._proofingDom.findTileNode(e);null==t||t.resetState()}else for(const e of this._proofingDom.tileNodes)e.resetState();this._nodePoller.pollNodes(s.G.NewData,this._proofingDom.tileNodes,o.Q0.Code,void 0,!0)}}async initialize(){for(const e of this._hostEmitters)e.on(r.pD.hostModelRehydrateTiles,this._handleRehydrate.bind(this))}shutDown(){}_handleRehydrate(e){this._queryDetection?this._queryDetection.handleAugloopReconnection((()=>{this.rehydrateTiles(e)})):this.rehydrateTiles(e)}};p=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.t)(r.zJ)),(0,n.__param)(1,(0,c.W)(h.G)),(0,n.__param)(2,(0,c.W)(g.w)),(0,n.__param)(3,(0,u.l)()),(0,n.__param)(3,(0,c.W)(a.J))],p)},88113:(e,t,i)=>{i.d(t,{Z:()=>A});var n,s=i(79490);!function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(n||(n={}));class o{constructor(e,t){this._textRetrieverFactory=e,this._indexReadjuster=t,this.findOffsetPositions=async(e,t,i=!1,s)=>{const o=new Map;let r=0;t.sort(((e,t)=>e.index-t.index));const a=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let l,d=0;if(l=void 0!==s?s:this._textRetrieverFactory(e).retrieve().content,t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>l.length)return o;const c=await this._indexReadjuster.getReadjustedIndices(e,t,l);let u;for(;a.nextNode();){const e=a.currentNode,s=r,l=e.textContent?e.textContent.length:0,h=s+l;for(let r=d;r<t.length;r+=1){const a=c[r];if(a.indexType===n.Start&&a.index>=s&&(i?a.index<=h:a.index<h))d+=1,o.set(t[r].startIndex,{startNode:e,startOffset:a.index-s});else{if(!(a.indexType===n.End&&a.index>=s&&a.index<=h))break;{d+=1;const i=o.get(t[r].startIndex);if(!i)throw new Error("The critique's end index has no conforming start index.");i.endNode=e,i.endOffset=a.index-s,o.set(t[r].startIndex,i)}}}if(r+=l,l>0&&(u=e),d===t.length)break}if(d!==t.length)if(u){const e=r-(u.textContent?u.textContent.length:0);for(let i=d;i<t.length;i+=1){const s=c[i];if(s.indexType===n.Start&&s.index===r)d+=1,o.set(t[i].startIndex,{startNode:u,startOffset:s.index-e});else{if(s.indexType!==n.End||s.index!==r)break;{d+=1;const n=o.get(t[i].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=u,n.endOffset=s.index-e,o.set(t[i].startIndex,n)}}}}else for(let i=d;i<t.length;i+=1){const s=c[i];if(s.indexType===n.Start&&0===s.index)o.set(t[i].startIndex,{startNode:e,startOffset:0});else{if(s.indexType!==n.End||0!==s.index)break;{const n=o.get(t[i].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=e,n.endOffset=0,o.set(t[i].startIndex,n)}}}return o},this.createRange=(e,t)=>{if(!(null==t?void 0:t.endNode)||void 0===t.endOffset)return;const i=e.createRange();return i.setStart(t.startNode,t.startOffset),i.setEnd(t.endNode,t.endOffset),i},this.getTargetDocument=e=>{var t;return null!==(t=e.ownerDocument)&&void 0!==t?t:document}}async getCritiqueRanges(e,t){const i=[];for(const e of t)i.push({index:e.start,indexType:n.Start,startIndex:e.start}),i.push({index:e.start+e.length,indexType:n.End,startIndex:e.start});const s=await this.findOffsetPositions(e,i),o=this.getTargetDocument(e);return t.map((e=>{const t=s.get(e.start);return{critique:e,range:this.createRange(o,t)}}))}async getRangeOfNode(e,t,i,s){const o=[];o.push({index:t,indexType:n.Start,startIndex:t}),o.push({index:t+i,indexType:n.End,startIndex:t});const r=await this.findOffsetPositions(e,o,!1,s),a=this.getTargetDocument(e);return this.createRange(a,r.get(t))}async getNodeInsertionPosition(e,t,i){const s=[];s.push({index:t,indexType:n.Start,startIndex:t}),s.push({index:t,indexType:n.End,startIndex:t});const o=await this.findOffsetPositions(e,s,i),r=this.getTargetDocument(e);return this.createRange(r,o.get(t))}includePrecedingSpace(e,t){let i;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))i={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const n=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(n.currentNode=t.startContainer;n.previousNode();){const e=n.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(i={startNode:e,startOffset:e.textContent.length-1});break}}}return i&&t.setStart(i.startNode,i.startOffset),t}}class r{constructor(e){this.element=e}retrieve(){return{content:this.element.value}}}class a{constructor(e){this.element=e}retrieve(){return{content:this.element?l(this.element.innerText):""}}}function l(e){if(!e.includes(""))return e;const t=e.split("");let i="";return t.forEach(((e,t)=>{t%2==0&&(i+=e)})),i}var d=i(36135),c=i(44233);class u extends a{constructor(e){super(e),this.parentContentEditable=(0,c.m)(e)}retrieve(){const e=super.retrieve();return Object.assign(Object.assign(Object.assign({},e),{isInsideTable:this.getIsInsideTable()}),this.getListTypeAndIndentation())}getIsInsideTable(){if(!this.parentContentEditable)return;let e=this.element;for(;e&&e!==this.parentContentEditable;){if("TABLE"===e.nodeName)return!0;e=e.parentElement}return!1}getListTypeAndIndentation(){if(!this.parentContentEditable)return;let e,t,i=this.element;for(;i&&i!==this.parentContentEditable;)"OL"===i.nodeName&&(e||(e=d.pc.Numbered),t=(null!=t?t:-1)+1),"UL"===i.nodeName&&(e||(e=d.pc.Bullet),t=(null!=t?t:-1)+1),i=i.parentElement;return{listType:null!=e?e:d.pc.NoList,indentation:t}}}class h{setHtmlElement(e){this.element!==e&&(this.element=e,this.ownerDocument=e.ownerDocument||void 0)}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}}var g=i(1527),p=i(98970);const m="createUndoCheckpoint",f=(e,t)=>new Promise((i=>t.requestAnimationFrame(i,e)));class v extends h{constructor(e,t,i){super(),this.textNodeRangeBuilder=e,this._safeWindow=t,this._logger=i,this._textInterceptionMaxTimeoutMs=2e3,this._keysCache="",this._disposed=!1,this.documentKeyboardEventHandler=e=>("keydown"!==e.type||1!==e.key.length||e.altKey||e.ctrlKey||e.metaKey||(this._keysCache+=e.key),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),this.inputInterceptionTimeoutHandler=e=>{this._logger&&this._logger.warn(507248854,`Input interception is shutting down on timeout after ${this._textInterceptionMaxTimeoutMs}ms`),this.stopInputInterception(e)},this.getRange=async(e,t)=>{if(this.element&&this.ownerDocument)return this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)},this.selectRange=(e,t)=>{const i=e.getSelection();if(!i)return;const n=[];for(let e=0;e<i.rangeCount;e++)n.push(i.getRangeAt(e));return i.removeAllRanges(),i.addRange(t),i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),n},this.selectRanges=(e,t)=>{const i=e.getSelection();if(!i)return!1;if(i.removeAllRanges(),t)for(const e of t)i.addRange(e);return!0},this.focusElementAndPrepareRange=async(e,t,i,n)=>(i.focus(),this.prepareRange(e,t,n)),this.prepareRange=async(e,t,i)=>(await f(this.targetWindow,this._safeWindow),!i||i.collapsed?this.getRange(e,t):i)}get targetWindow(){return this.element?(0,g.e)(this.element):window}get disposed(){return this._disposed}async dispose(){var e;this.stopInputInterception(null!==(e=this.ownerDocument)&&void 0!==e?e:this.targetWindow.document),this._disposed=!0}async insert(e,t,i,n,s,o=!0){if(!this.element||!this.ownerDocument)return;const r=this.ownerDocument;o&&await f(this.targetWindow,this._safeWindow);let a=n;if(a||(a=await this.textNodeRangeBuilder.getNodeInsertionPosition(this.element,e,i)),a){const e=this.selectRange(r,a);await this.doReplacement(r,t),s&&this.selectRanges(r,e)}}async replace(e,t,i,n){if(!this.element||!this.ownerDocument)return;const{ownerDocument:s,element:o}=this,r=await this.focusElementAndPrepareRange(e,t,o,n);r&&(this.selectRange(s,r),await this.doReplacement(s,i))}async remove(e,t,i,n,s=!0,o){if(!this.element||!this.ownerDocument)return;const{ownerDocument:r}=this;s&&await f(this.targetWindow,this._safeWindow);let a=i;if(a&&!a.collapsed||(a=await this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)),a){o&&this.textNodeRangeBuilder.includePrecedingSpace(this.element,a);const i=this.selectRange(r,a);await this.doRemoval(r,(async()=>this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t))),n&&this.selectRanges(r,i)}return a}async autoCorrect(e,t,i,n,s){if(!this.element||!this.ownerDocument)return;let o,r=null;r=this.ownerDocument.getSelection(),r&&r.rangeCount>0&&(o={node:r.focusNode,offset:r.focusOffset}),s&&(this.startInputInterception(this.ownerDocument),this._interceptStartTime=Date.now(),this._logger&&this._logger.debug(507248859,`Starting text input interception ${this._interceptStartTime}`));let a=0;const l=this.ownerDocument;try{const s=await this.prepareRange(e,t,n);if(s){const e=s.toString();return this.selectRange(l,s),await this.doReplacement(l,i),a=i.length-t,e}}catch(e){throw s&&this._logger&&this._logger.error(507248858,"An error occurred during the auto correction text replacement while text interception is ON",e),e}finally{await this.restoreTextAndPosition(l,a,r,o,s)}}async restoreTextAndPosition(e,t,i,n,s){try{i&&n&&this.restorePosition(i,t,n)}catch(e){throw s&&this._logger&&this._logger.error(507248857,"An error occurred while trying to restore the cursor position after the auto correction and text interception is ON",e),e}finally{s&&await this.restoreText(e)}}restorePosition(e,t,i){var n,s,o;const r=i.offset+t,a=null!==(o=null===(s=null===(n=i.node)||void 0===n?void 0:n.textContent)||void 0===s?void 0:s.length)&&void 0!==o?o:r,l=Math.min(a,r);e.removeAllRanges(),e.setPosition(i.node,l)}async restoreText(e){try{await this.doReplacement(e,this._keysCache)}catch(e){throw this._logger&&this._logger.error(507248856,"An error occurred while trying to restore the cached text after the auto correction.",e),e}finally{if(this.stopInputInterception(e),this._interceptStartTime){const e=Date.now()-this._interceptStartTime;this._logger&&this._logger.debug(507248855,`Stop text input interception. Time take ${e} ms.`),this._interceptStartTime=void 0}}}startInputInterception(e){var t;this._keysCache="",this._textInterceptionTimeout=this.targetWindow.setTimeout((()=>this.inputInterceptionTimeoutHandler(e)),this._textInterceptionMaxTimeoutMs),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=new p.J(e),this._textInterceptionEventListener.addListener("keyup",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keydown",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keypress",this.documentKeyboardEventHandler,{capture:!0})}stopInputInterception(e){var t;this._textInterceptionTimeout&&(this.targetWindow.clearTimeout(this._textInterceptionTimeout),this._textInterceptionTimeout=void 0),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=void 0,this._keysCache=""}doReplacement(e,t){const i=new Event(m);return e.dispatchEvent(i),this.innerDoReplacement(e,t),e.dispatchEvent(i),Promise.resolve()}async doRemoval(e,t){const i=new Event(m);e.dispatchEvent(i),await this.innerDoRemoval(e,t),e.dispatchEvent(i)}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}async innerDoRemoval(e,t){var i,n,s,o;const r=e.getSelection();if(r&&r.anchorNode===r.focusNode&&(null===(i=r.anchorNode)||void 0===i?void 0:i.textContent)){const i=r.anchorNode,a=null===(n=i.textContent)||void 0===n?void 0:n.length;e.execCommand("delete",!1),i.isConnected&&(null===(s=i.textContent)||void 0===s?void 0:s.length)===a&&(null===(o=await t())||void 0===o||o.deleteContents())}else e.execCommand("delete",!1);this.dispatchInputEvent()}}class _ extends h{constructor(){super(...arguments),this.doReplacement=(e,t,i,n,s)=>{e.setRangeText(t,i,n,s),this.dispatchInputEvent()},this.calculateBoundaries=(e,t,i)=>{const n=e.value.length,s=Math.min(t,n);return{start:s,end:Math.min(s+i,n)}}}async insert(e,t){if(!this.element)return;const i=this.calculateBoundaries(this.element,e,0);this.doReplacement(this.element,t,i.start,i.end,"end")}async replace(e,t,i){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,t);this.doReplacement(this.element,i,n.start,n.end,"end")}async autoCorrect(e,t,i){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,t),s=this.element.value.substring(n.start,n.end);return this.doReplacement(this.element,i,n.start,n.end,"preserve"),s}async remove(e,t,i,n,s,o){if(!this.element)return;const r=this.calculateBoundaries(this.element,o?e-1:e,o?t+1:t);this.doReplacement(this.element,"",r.start,r.end)}}class y extends h{constructor(e){super(),this.textRetrieverFactory=e}async insert(e,t){if(!this.element)return;const i=this.getReplacedText(e,e,t);this.element.innerText=i.text}async replace(e,t,i){if(!this.element)return;const n=this.getReplacedText(e,e+t,i);this.element.innerText=n.text}async autoCorrect(e,t,i){if(!this.element)return;const n=this.getReplacedText(e,e+t,i);return this.element.innerText=n.text,n.replacedPart}async remove(e,t,i,n,s,o=!1){if(!this.element)return;const r=this.getReplacedText(e,e+t,void 0,!o);this.element.innerText=r.text}getReplacedText(e,t,i,n){const s=this.getText(),o=s.length;let r=Math.min(e,o);const a=Math.min(t,o);n||i||" "!==s[r-1]||(r-=1);return{text:`${s.substring(0,r)}${null!=i?i:""}${s.substring(a)}`,replacedPart:s.substring(r,a)}}getText(){return this.element?this.textRetrieverFactory(this.element).retrieve().content:""}}var I=i(76752),C=i(52041),S=i(10138),b=i(40315),T=i(23943);class E{constructor(e,t,i,n){this._proofingDom=e,this._tileContent=t,this._indexReadjuster=i,this.targetWindow=n,this.getTextSelection=()=>{var e,t;const i=(null!==(t=null===(e=this.targetWindow)||void 0===e?void 0:e.deref())&&void 0!==t?t:window).getSelection();if(i){const e=this.getParentTileElement(i.anchorNode),t=this.getParentTileElement(i.focusNode);if(e&&t)return this.attemptToFindSelectionRange(e,t,i)}return Promise.resolve(void 0)},this.attemptToFindOffsetsIntoParentElement=(e,t)=>{const i=[],n=e.element&&this._tileContent.getContainingElement(e.element);if(!n)return i;const s=document.createTreeWalker(n,NodeFilter.SHOW_ALL,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let o=0;for(;s.nextNode();){const e=s.currentNode,n=e.textContent&&e.nodeType===e.TEXT_NODE?e.textContent.length:0;for(let n=0;n<t.length;n++)e===t[n]&&(i[n]=o);if(o+=n,i.length===t.length)break}if(0===o)for(let e=0;e<t.length;e++)n===t[e]&&(i[e]=o);return i},this.attemptToFindSelectionRange=async(e,t,i)=>{var n,s,o,r,a,l,d,c,u,h,g,p,m,f;let v,_;if(e.id===t.id){const t=this.attemptToFindOffsetsIntoParentElement(e,[i.anchorNode,i.focusNode]);v=t[0],_=t[1]}else v=this.attemptToFindOffsetsIntoParentElement(e,[i.anchorNode])[0],_=this.attemptToFindOffsetsIntoParentElement(t,[i.focusNode])[0];if(void 0!==v&&void 0!==_&&e.element&&t.element){let y,I,C,S,b,T,E=0,N=0;if(v>_?(E=_+i.focusOffset,N=v+i.anchorOffset,b=t,T=e):(E=v+i.anchorOffset,N=_+i.focusOffset,b=e,T=t),e.id===t.id){const t=this._tileContent.getContainingElement(e.element);if(!t)return;b=T=e;const g=null!==(s=null===(n=this._tileContent.getText(e))||void 0===n?void 0:n.content)&&void 0!==s?s:"";if(this._indexReadjuster)if(E===N){const e=0!==E&&"\n"===g.charAt(E),i=await this._indexReadjuster.getReadjustedIndices(t,[e?E-1:E],g,!0);e?(E=i[0]+1,N=i[0]+1):(E=i[0],N=i[0])}else{const e=await this._indexReadjuster.getReadjustedIndices(t,[E,N],g,!0);E=e[0],N=e[1]}if(!e.children)return{startParentElement:b,endParentElement:T,isCollapsed:i.isCollapsed,selectedText:i.toString(),startPosition:E,endPosition:N,startParagraphNode:y,endParagraphNode:I,startPositionInParagraphNode:C,endPositionInParagraphNode:S};for(const t of e.children){const e=t.element;E===N&&0!==E?E-1>=e.offset&&E-1<e.offset+e.span&&(y=t,C=E-e.offset,I=t,S=E-e.offset):(E>=e.offset&&(E<e.offset+e.span||0===E&&e.offset+e.span===0)&&(y=t,C=E-e.offset),N>=e.offset&&(N<e.offset+e.span||0===N&&e.offset+e.span===0)&&(I=t,S=N-e.offset))}if(!I){let t;for(const i of e.children)(!t||(null!==(r=null===(o=i.element)||void 0===o?void 0:o.offset)&&void 0!==r?r:0)>(null!==(l=null===(a=t.element)||void 0===a?void 0:a.offset)&&void 0!==l?l:0))&&(t=i);if(null==t?void 0:t.element){N===t.element.offset+t.element.span&&(I=t,S=N-t.element.offset)}}if(E===N&&!y&&!I){let t;for(const i of e.children)(!t||(null!==(c=null===(d=i.element)||void 0===d?void 0:d.offset)&&void 0!==c?c:0)>(null!==(h=null===(u=t.element)||void 0===u?void 0:u.offset)&&void 0!==h?h:0))&&(t=i);if(null==t?void 0:t.element){E===t.element.offset+t.element.span+1&&(y=t,C=E-t.element.offset,I=t,S=E-t.element.offset)}}}else{if(E=_+i.focusOffset,N=v+i.anchorOffset,b=t,T=e,!b.element||!T.element)return;const n=this._tileContent.getContainingElement(b.element),s=this._tileContent.getContainingElement(T.element);if(this._indexReadjuster&&n&&s){const e=null!==(p=null===(g=this._tileContent.getText(b))||void 0===g?void 0:g.content)&&void 0!==p?p:"";E=(await this._indexReadjuster.getReadjustedIndices(n,[E],e,!0))[0];const t=null!==(f=null===(m=this._tileContent.getText(T))||void 0===m?void 0:m.content)&&void 0!==f?f:"";N=(await this._indexReadjuster.getReadjustedIndices(s,[N],t,!0))[0]}if(b.children)for(const e of b.children)E>=e.element.offset&&E<e.element.offset+e.element.span&&(y=e,C=E-e.element.offset);if(T.children)for(const e of T.children)N>=e.element.offset&&N<e.element.offset+e.element.span&&(I=e,S=N-e.element.offset)}return{startParentElement:b,endParentElement:T,isCollapsed:i.isCollapsed,selectedText:i.toString(),startPosition:E,endPosition:N,startParagraphNode:y,endParagraphNode:I,startPositionInParagraphNode:C,endPositionInParagraphNode:S}}},this.getParentTileElement=e=>{let t;for(const i of this._proofingDom.tileNodes){this._tileContent.getContainingElement(i)===e&&(t=i)}return t||((null==e?void 0:e.parentNode)?this.getParentTileElement(e.parentNode):void 0)}}}var N=i(29906),x=i(83010),w=i(27603),L=i(33999),D=i(94526),F=i(39847);let A=class{constructor(e,t,i,n,s){this._proofingDom=e,this.indexReadjuster=t,this.safeWindow=i,this.logger=n,this.targetWindowRef=s,this.attachedToParagraphLevelDivs=!1}getText(e){const t=this.getTextRetriever(e,void 0);if(t)return t.retrieve()}getTextSelection(){return new E(this._proofingDom,this,this.indexReadjuster,this.targetWindowRef).getTextSelection()}getContainingElement(e){return(0,g.C)(e,"HTMLElement")?e:(0,L.ZR)(e)&&(0,D.l)(e)?R(e.parent):R(e)}async insert(e,t,i,n,s,o,r,a){const l=this.getTextWriter(e,t);if(l)return l.insert(i,n,s,o,r,a)}async replace(e,t,i,n,s,o){const r=this.getTextWriter(e,t);if(r)return r.replace(i,n,s,o)}async remove(e,t,i,n,s,o,r,a){const l=this.getTextWriter(e,t);if(l)return l.remove(i,n,o,r,a,s)}async autoCorrect(e,t,i,n,s,o,r){const a=this.getTextWriter(e,t);if(a)return a.autoCorrect(i,n,s,o,r)}async getCritiqueRanges(e,t,i){const n=null!=t?t:R(e);if(!n)return i.map((e=>({critique:e,range:void 0})));const s=this.getTextNodeRangeBuilder(e,t);return s?s.getCritiqueRanges(n,i):i.map((e=>({critique:e,range:void 0})))}async getRangeOfNode(e,t,i,n){const s=null!=t?t:R(e);if(!s)return;const o=this.getTextNodeRangeBuilder(e,t);return o?o.getRangeOfNode(s,i,n,(0,F.$)(e)?e.plainText:void 0):void 0}async getNodeInsertionPosition(e,t,i){const n=R(e);if(!n)return;const s=this.getTextNodeRangeBuilder(e,void 0);return s?s.getNodeInsertionPosition(n,t,i):void 0}getTextNodeRangeBuilder(e,t){const i=this.getTextRetriever(e,t);if(i)return new o((()=>i),this.indexReadjuster)}getTextRetriever(e,t){const i=null!=t?t:R(e);if(!i)return;let n;return n=(0,g.C)(i,"HTMLInputElement")||(0,g.C)(i,"HTMLTextAreaElement")?new r(i):this.attachedToParagraphLevelDivs?new u(i):new a(i),n}getTextWriter(e,t){var i;const n=null!==(i=R(e))&&void 0!==i?i:t,s=this.getTextNodeRangeBuilder(e,t),o=this.getTextRetriever(e,t);if(!n||!s||!o)return;let r;var a,l,d;return l="contenteditable",d="true",r=(a=n).hasAttribute(l)&&a.getAttribute(l)===d||null!==a.closest(`[${l}=${d}]`)?new v(s,this.safeWindow,this.logger):(0,g.C)(n,"HTMLInputElement")||(0,g.C)(n,"HTMLTextAreaElement")?new _:new y((()=>o)),r.setHtmlElement(n),r}};function R(e){return(0,D.l)(e)?e.parent.element:e.element}A=(0,s.__decorate)([(0,N._)(),(0,s.__param)(0,(0,x.W)(T.w)),(0,s.__param)(1,(0,x.W)(I.h)),(0,s.__param)(2,(0,x.W)(C.j)),(0,s.__param)(3,(0,x.W)(S.g)),(0,s.__param)(3,(0,w.l)()),(0,s.__param)(4,(0,x.W)(b.sh)),(0,s.__param)(4,(0,w.l)())],A)},754:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(76729).f)("ITileContent")},43565:(e,t,i)=>{i.d(t,{c:()=>g});var n=i(79490),s=i(88113),o=i(76752),r=i(10138),a=i(52041),l=i(40315),d=i(23943),c=i(29906),u=i(83010),h=i(27603);let g=class extends s.Z{constructor(e,t,i,n,s){super(e,t,n,i,s),this.attachedToParagraphLevelDivs=!0}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(d.w)),(0,n.__param)(1,(0,u.W)(o.h)),(0,n.__param)(2,(0,u.W)(r.g)),(0,n.__param)(3,(0,u.W)(a.j)),(0,n.__param)(4,(0,u.W)(l.sh)),(0,n.__param)(4,(0,h.l)())],g)},46032:(e,t,i)=>{i.d(t,{n:()=>g});var n=i(79490),s=i(59556),o=i(23219),r=i(71924),a=i(68336),l=i(8694),d=i(76729),c=i(29906),u=i(83010),h=i(27603);const g=(0,d.f)("ITextEventPublisher");let p=class extends s.z{constructor(e,t){super(),this._settings=e,this._timer=null!=t?t:new o.k}dispose(){return this._timer.shutDown(),Promise.resolve()}publishTextChangeEvent(e,t){this.publishEvent("textChange",{data:e,messageType:t}),this.scheduleSendIdleTextEvent(e,t)}publishTextStyleEvent(){this.publishEvent("styleChange",{})}scheduleSendIdleTextEvent(e,t){if(this._settings.enableTileNodeAutoReconciliation&&0!==e.length)for(const i of e)i.mutationChangeType!==r.Q0.Code&&(this._timer.clearTimer(i.tileNodeId),this._timer.setTimeout(i.tileNodeId,(()=>{this.publishEvent("textChange",{data:[{tileNodeId:i.tileNodeId,text:i.text,mutationChangeType:r.Q0.Code,rehydrateCritiques:!0,idleReconcileTrigger:!0,optimizedRehydrationEnabled:i.optimizedRehydrationEnabled,useDirtyParagraphReconciliation:this._settings.useDirtyParagraphReconciliation}],messageType:t}),this._timer.clearTimer(i.tileNodeId)}),this._settings.reconcileTileNodeTime))}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(l.k)),(0,n.__param)(1,(0,h.l)()),(0,n.__param)(1,(0,u.W)(a.J))],p)},3033:(e,t,i)=>{function n(e){return e&&(e.formattedRanges||e.attributionRanges)}function s(e,t){const i=e.start<t.start?e:t,n=i===e?t:e;if(!(i.end<n.start))return{start:n.start,end:i.end<n.end?i.end:n.end}}function o(e,t,i){if(!e)return;const n=e.content.substring(t,i);let o;if(e.formattedRanges){o=[];for(const n of e.formattedRanges){const e=s({start:n.start,end:n.start+n.length},{start:t,end:i});e&&o.push(Object.assign(Object.assign({},n),{start:e.start,length:e.end-e.start}))}}return Object.assign(Object.assign({},e),{content:n,formattedRanges:o})}function r(e,t,i){const n=[];for(const s of e){const e=s.start+s.length,o=Math.max(t,s.start),r=Math.min(i,e);r<=o||n.push(Object.assign(Object.assign({},s),{start:o,length:r-o}))}return n}function a(e,t,i){return e.formattedRanges?r(e.formattedRanges,t,i):[]}function l(e,t,i){return{formattedRanges:e.formattedRanges?r(e.formattedRanges,t,i):[],attributionRanges:e.attributionRanges?r(e.attributionRanges,t,i):[]}}i.d(t,{Dt:()=>n,FD:()=>a,Gn:()=>o,V8:()=>h,Wi:()=>l,_E:()=>d,lX:()=>c});const d=2063!=i.j?["queryRange","ipPosition","isColdIp","content","formattedRanges","attributionRanges","objectReferences"]:null;function c(e,t){if(!e!=!t)return!1;if(!e||!t)return!0;const i=u(e);return!!h(i,u(e))&&i.every((i=>e[i]===t[i]))}function u(e){return Object.keys(e).filter((e=>!d.includes(e)))}function h(e,t){return!e==!t&&(!e||!t||e.length===t.length&&e.every(((i,n)=>function(e,t){const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(const n of i)if(Array.isArray(e[n])&&Array.isArray(t[n])){if(!h(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}(e[n],t[n]))))}},99648:(e,t,i)=>{function n(e){let t=e.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t}i.d(t,{F:()=>n})},30318:(e,t,i)=>{if(i.d(t,{q:()=>s}),2063!=i.j)var n=i(44233);function s(e,t){var i;const s=t&&e.getContainingElement(t);if(s)return null!==(i=(0,n.m)(s))&&void 0!==i?i:s}},31055:(e,t,i)=>{function n(e){var t,i,n,s,o,r,a;const{oaSettings:l,serviceSettings:d,hostMetadata:c}=e,{flagAnnotationSettings:u,nudge:h,predictions:g}=null!=d?d:{};return{ecc:{enabled:null!==(t=null==l?void 0:l.isContextualCardEnabled)&&void 0!==t&&t,entities:null==l?void 0:l.entitiesEnabled,bestMatch:null==l?void 0:l.bestMatchConfig,scopes:(null==l?void 0:l.scopesConfig)&&{entities:l.scopesConfig.entities,enabled:l.scopesConfig.enabled,maxResults:l.scopesConfig.maxResults}},flag:{enabled:null!==(i=null==u?void 0:u.enabled)&&void 0!==i&&i,entities:null!==(n=null==u?void 0:u.entityConfigs)&&void 0!==n?n:[]},nudge:{enabled:null!==(s=null==h?void 0:h.enabled)&&void 0!==s&&s,entities:null!==(o=null==h?void 0:h.entityConfigs)&&void 0!==o?o:[]},prediction:{enabled:null!==(r=null==g?void 0:g.enabled)&&void 0!==r&&r,entities:null!==(a=null==g?void 0:g.entityConfigs)&&void 0!==a?a:[],enableMiddleOfSentencePredictions:null==g?void 0:g.allowMiddleOfSentencePredictions,enableMultiPredict:null==g?void 0:g.enableMultiPredict},metadata:{appScenario:null==c?void 0:c.appScenario}}}i.d(t,{e:()=>n})},33355:(e,t,i)=>{i.d(t,{T:()=>n});const n=(0,i(76729).f)("IClientSubscriber")},29839:(e,t,i)=>{i.d(t,{X:()=>n});const n=(0,i(76729).f)("ILanguageDetectionSubscriber")},93721:(e,t,i)=>{i.d(t,{k:()=>w});var n=i(79490),s=i(85665),o=i(1527);const r=e=>{var t,i,n,s;return(null===(t=null==e?void 0:e.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)||(null===(i=null==e?void 0:e.oaSettings)||void 0===i?void 0:i.enablePredictions)||(null===(s=null===(n=null==e?void 0:e.serviceSettings)||void 0===n?void 0:n.flagAnnotationSettings)||void 0===s?void 0:s.enabled)};var a=i(76778),l=i(98970),d=i(10138),c=i(11804),u=i(32177),h=i(21522),g=i(40315),p=i(23943),m=i(82076),f=i(70825);class v{constructor(e,t){this._hostEmitter=e,this._logger=t,this._activationTokens=[]}async activateAnnotationsBase(e,t,i){if(e)if(this._activationTokens.length)this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation which is already initialized.`);else{this._session=e,this._sessionId=t;try{const e=await Promise.all(i());this._activationTokens=e.map((e=>e.token))}catch(e){this._logger.error(508044171,`Trying to activate ${this.annotationListenerType} failed due to an exception.`,e)}}else this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation with no session.`)}async deactivateAnnotations(e){if(!e||!this._activationTokens.length)return!1;try{const t=await Promise.all(this._activationTokens.map((t=>e.releaseAnnotation(t))));return this._activationTokens=[],t.every(Boolean)}catch(e){return this._logger.error(508044170,`Trying to deactivate ${this.annotationListenerType} failed due to an exception.`,e),!1}}async updateAnnotationActivationConfig(e){this._session?this._activationTokens.length?e&&this._activationTokens.map((t=>{var i;return null===(i=this._session)||void 0===i?void 0:i.updateAnnotationConfig(t,e)})):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid token.`):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid session object.`)}}var _=i(55875),y=i(53335),I=i(99614),C=i(18104),S=i(4915);const b={[S.i.Success]:"200",[S.i.NoResults]:"200",[S.i.Cancelled]:"400",[S.i.Timeout]:"408",[S.i.UnexpectedError]:"500",[S.i.EarlyExit]:"200"};class T extends v{constructor(e,t,i,n,s){super(e,t),this._hostEmitter=e,this._logger=t,this._e2eMetric=i,this._queryDetection=n,this._hostSettings=s,this.annotationListenerType="OAAnnotationListener",this._onAnnotationResult=e=>{var t,i,n,s,o,r,l,d,c,u,h,g,p,v,S,T,E,N,x,w,L,D,F;const A=null===(t=e.items[0])||void 0===t?void 0:t.body;if(!A)return;let R;const q=m.h.getTypeNameFor(e);switch(q){case f.Xr.getTypeName():R=C.G.NewData;break;case f.fZ.getTypeName():R=C.G.ChangeData;break;case f.n4.getTypeName():R=C.G.RemoveData;break;default:return void this._logger.logDiagnostics("[OAAnnotationListener]: Unexpected annotation operation",{opType:q})}const P=null!==(i=e.parentPath[e.parentPath.length-1])&&void 0!==i?i:"",O=Number.parseInt(null!==(n=e.parentRevId)&&void 0!==n?n:"0",10);if(_.gh.typeGuard(A)){if(y.Yd.typeGuard(A.result)){if(null===(r=null===(o=null===(s=this._hostSettings)||void 0===s?void 0:s.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===r?void 0:r.augloopPredictionsDisabled)return;const t=A.result;if(this.isValidSuggestionType(t.entityType)){let i=t.entityType;(i===I.c.People&&!t.entityResults||i===I.c.External)&&(i=I.c.PIM);const n=Object.assign(Object.assign({tileId:P,tileVersion:O,annotationId:e.items[0].id},t),{entityType:i,startIndex:t.startIndex>0?t.startIndex:(null!==(d=null===(l=t.context)||void 0===l?void 0:l.length)&&void 0!==d?d:0)+t.startIndex});this._hostEmitter.emit(a.pD.predictionTriggered,{address:this._sessionId,message:{messageType:R,data:n}})}}else if(y.aO.typeGuard(A.result)){const t=A.result;this.isValidSuggestionType(t.entityType)&&this._hostEmitter.emit(a.pD.nudgeTriggered,{address:this._sessionId,message:{messageType:R,data:Object.assign(Object.assign({},t),{tileId:P,tileVersion:O,annotationId:e.items[0].id,entityType:t.entityType})}})}}else if(_.Zx.typeGuard(A)||_.$g.typeGuard(A)){const t=null===(u=null===(c=this._queryDetection)||void 0===c?void 0:c.getCurrentQuery())||void 0===u?void 0:u.queryRange,i={logicalId:A.logicalId||(null===(h=this._queryDetection)||void 0===h?void 0:h.getCurrentQueryLogicalId())||"",conversationId:A.conversationId||(null===(g=this._queryDetection)||void 0===g?void 0:g.getCurrentQueryConversationId())||"",isEmptyQuery:!t||t.length===(null!==(v=null===(p=t.prefix)||void 0===p?void 0:p.length)&&void 0!==v?v:1),isTimeout:!1,queryLength:(null==t?void 0:t.length)?t.length-(null!==(T=null===(S=t.prefix)||void 0===S?void 0:S.length)&&void 0!==T?T:1):0},n=(e=>{if(_.$g.typeGuard(e)){const t=e;if(t.instrumentation&&t.instrumentation.length>0)return t.instrumentation[0].TraceId}})(A),s=n?Object.assign({TraceId:n||""},"number"==typeof A.status?{status:(k=A.status,b[k])}:{}):void 0;let o,r,l;if(this._e2eMetric.addMeasure(i.logicalId,"OAAnnotationResultsReceived",s),_.$g.typeGuard(A)){l=A.resultSummary;const e=A;for(const t of e.entityResults)if((null===(x=null===(N=null===(E=this._hostSettings)||void 0===E?void 0:E.oaSettings)||void 0===N?void 0:N.bestMatchConfig)||void 0===x?void 0:x.enabled)&&(null===(w=e.treatments)||void 0===w?void 0:w.bestMatchEntries))for(const i of e.treatments.bestMatchEntries)for(const e of t.entities)e.entityId===i.entityId&&(e.isBestMatch=!0);o=e.entityResults,r=e.entityResults.map((e=>e.modelInfo.elapsedTime)).filter(Number.isInteger).reduce(((e,t)=>e>t?e:t),0)}else{let e=[];try{(null===(F=null===(D=null===(L=this._hostSettings)||void 0===L?void 0:L.oaSettings)||void 0===D?void 0:D.bestMatchConfig)||void 0===F?void 0:F.enabled)&&(e=>{const t=e.results.findIndex((e=>e.bestMatchEntries&&e.bestMatchEntries.length>0));if(t>-1){const i=e.results[t],n=i.bestMatchEntries;n&&n.length>0&&i.results.forEach((e=>{e.isBestMatch=n.findIndex((t=>t.entityId===e.ReferenceId))>-1}))}})(A);for(const t of A.results)e=e.concat(t.results)}catch(e){this._logger.logDiagnostics("[OAAnnotationListener] unexpected annotation item format")}const t=new Map;for(const i of e){const e=t.get(i.entityType);e?e.entities.push(i):t.set(i.entityType,{entities:[i],entityType:i.entityType})}o=Array.from(t.values())}this._hostEmitter.emit(a.pD.oaRankedAnnotations,{address:this._sessionId,message:{messageType:R,data:{tileId:P,tileVersion:O,annotationId:e.items[0].id,results:o,resultStatus:A.status,resultSummary:l,queryCorrelationKeys:i,latency:r}}})}else _.Vn.typeGuard(A)&&this._hostEmitter.emit(a.pD.oaFlagAnnotationsTriggered,{address:this._sessionId,message:{messageType:R,data:{tileId:P,tileVersion:O,annotationId:e.items[0].id,results:A.results}}});var k},this.isValidSuggestionType=e=>Object.values(I.c).includes(e)}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>{var t,i,n,s;if(!e)return[];const o=[_.Zx];return(null===(i=null===(t=this._hostSettings)||void 0===t?void 0:t.oaSettings)||void 0===i?void 0:i.enableOaClient)?o.push(_.c$):o.push(_.os),(null===(s=null===(n=this._hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===s?void 0:s.enableOaClientPredictions)?o.push(_.Nh):o.push(_.Vm),o.push(_.Vn),o.map((t=>e.activateAnnotation(t.getTypeName(),{callback:this._onAnnotationResult})))}))}}var E=i(31055),N=i(29906),x=i(83010);let w=class{constructor(e,t,i,n,r,a,l){this._hostEmitter=e,this._logger=t,this._hostSettings=i,this._oaMetric=n,this._queryDetection=r,this._proofingDom=a,this.targetDocumentFactory=l,this._oaStartupSignalSeq=0,this._startSignalIntervalId=null,this._lastStartSignalTime=0,this._elementsToProof=[],this._targetWindow=window,this._oaSendALMenuControlSignal=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);this._oaStartupSignalSeq=this._oaStartupSignalSeq+1,null==t||t.submitSignal(new s.I9(e.message),this._oaStartupSignalSeq.toString(),e.message.documentModel)},this._isSameOrDescendantElement=(e,t)=>e===t||(0,o.C)(e,"HTMLDivElement")&&e.contains(t),this._handleDocumentFocusIn=e=>{const t=e.target;if(!(0,o.C)(t,"HTMLElement"))return;this._elementsToProof.some((e=>this._isSameOrDescendantElement(t,e)))&&(this._submitStartupSignal(),this._initStartupSignalTimer())},this._handleDocumentFocusOut=e=>{this._clearStartupSignalTimer()},this._attachFocusEventToProofedElements=async e=>{var t,i;const n=null===(t=this._proofingDom.findNode(e.message))||void 0===t?void 0:t.element;if(!n||!(0,o.C)(n,"HTMLElement"))return;this._elementsToProof.push(n);const s=(null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref())||document;(0,o.C)(s.activeElement,"HTMLElement")&&this._isSameOrDescendantElement(s.activeElement,n)&&(this._submitStartupSignal(),this._initStartupSignalTimer())}}register(e,t){var i;if(!r(this._hostSettings))return;this._sessionsProvider=e,this._augloopDocumentSerializer=t,this._hostEmitter.on(a.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.on(a.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements);const n=(null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref())||document;this._focusInListener=new l.J(n),this._focusInListener.addListener("focusin",this._handleDocumentFocusIn),this._focusOutListener=new l.J(n),this._focusOutListener.addListener("focusout",this._handleDocumentFocusOut),n.defaultView&&(this._targetWindow=n.defaultView)}unregister(){var e,t;this._elementsToProof=[],r(this._hostSettings)&&(this._hostEmitter.off(a.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.off(a.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements),null===(e=this._focusInListener)||void 0===e||e.removeListener("focusin"),this._focusInListener=void 0,null===(t=this._focusOutListener)||void 0===t||t.removeListener("focusout"),this._focusOutListener=void 0),this._clearStartupSignalTimer()}createAnnotationListener(){return new T(this._hostEmitter,this._logger,this._oaMetric,this._queryDetection,this._hostSettings)}onInitialize(e){this._initStartupSignal(e)}onSessionReconnected(e){this._initStartupSignal(e)}onDocumentCreated(e,t){var i,n,o;if(!r(this._hostSettings))return;this._oaStartupSignalSeq=this._oaStartupSignalSeq+1;const a=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.tokenOverride,l=this.getClientConfig(),d=null===(n=l.metadata)||void 0===n?void 0:n.appScenario;this._hostSettings.appId.startsWith("PowerPoint")&&"Copilot"!==d&&this._logger.logDiagnostics(`[OAClientSubscriber] client config for PowerPoint doesn't have correct appScenario: ${d}`),e.submitSignal(new s.c7({sessionConfig:{clientConfig:l,debugConfig:{tokenOverride:a}},parentPath:null===(o=this._augloopDocumentSerializer)||void 0===o?void 0:o.getParentPath(e,t).join("\\")}),this._oaStartupSignalSeq.toString(),t)}get isEnabled(){return!0}getClientConfig(){return(0,E.e)(this._hostSettings)}_submitStartupSignal(){var e;if(!r(this._hostSettings)||!this._currentSession)return;if(!(Date.now()-this._lastStartSignalTime>9800))return;this._oaStartupSignalSeq++;const t=null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.tokenOverride;this._lastStartSignalTime=Date.now(),this._currentSession.submitSignal(new s.ep({debugOptions:{tokenOverride:t}}),this._oaStartupSignalSeq.toString())}_initStartupSignal(e){this._clearStartupSignalTimer(),this._currentSession=e,this._submitStartupSignal()}_initStartupSignalTimer(){this._startSignalIntervalId||(this._startSignalIntervalId=this._targetWindow.setInterval((()=>{this._submitStartupSignal()}),1e4))}_clearStartupSignalTimer(){this._startSignalIntervalId&&(this._targetWindow.clearInterval(this._startSignalIntervalId),this._startSignalIntervalId=null)}};w=(0,n.__decorate)([(0,N._)(),(0,n.__param)(0,(0,x.W)(a.M5)),(0,n.__param)(1,(0,x.W)(d.g)),(0,n.__param)(2,(0,x.W)(c.n)),(0,n.__param)(3,(0,x.W)(u.u)),(0,n.__param)(4,(0,x.W)(h.J)),(0,n.__param)(5,(0,x.W)(p.w)),(0,n.__param)(6,(0,x.W)(g.Ze))],w)},33781:(e,t,i)=>{if(i.d(t,{cl:()=>r,nv:()=>l}),2063!=i.j)var n=i(72622);if(2063!=i.j)var s=i(82076);if(2063!=i.j)var o=i(39869);const r=(0,i(76729).f)("HostCallbacksTransformer");class a{constructor(e,t,i,n,s,o){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=i,this.logger=n,this.clientRuntime=s,this.aggregateLogger=o}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let i=t;for(const t of e)i=t(i,this);return i},this}async build(e,t){try{const e=await this.createClientMetadata(),i=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),n=this.createRuntimeOptions();await this.runPreRuntimeInit(e,n),await this.initClientRuntime(e,i,n);return{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const i=s.h.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:i,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(i,t)}logAnnotationResultItem(e,t){var i;const n=t.body?s.h.getTypeNameFor(t.body):"unknown";null===(i=this.aggregateLogger)||void 0===i||i.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:n,operationType:e}))}async createClientMetadata(){var e,t,i,n,s,o;const r={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(n=null===(i=this.hostSettings.hostMetadata)||void 0===i?void 0:i.appPlatform)&&void 0!==n?n:"Online",releaseAudienceGroup:null===(s=this.hostSettings.hostMetadata)||void 0===s?void 0:s.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId},a=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return a&&(r.flights=a.value),r}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var i;let n;return n=(null===(i=this.hostSettings.orchestratorSettings)||void 0===i?void 0:i.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,n},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(0,o.U)(this.telemetrySink)}}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var i;(null===(i=this.hostSettings.orchestratorSettings)||void 0===i?void 0:i.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((i=>i(e,t))))}async initClientRuntime(e,t,i){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,i)}createSession(e){var t;const i=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new n.L).generate();return this.clientRuntime.createSession({docSessionId:i})}}const l=(e,t,i,n,s,o)=>new a(e,t,i,n,s,o)},47571:(e,t,i)=>{i.d(t,{J:()=>o,a:()=>s});var n=i(76729);const s=(0,n.f)("AugloopSessionFactory"),o=(0,n.f)("IOrchestrator")},58918:(e,t,i)=>{i.d(t,{P:()=>s});var n=i(76729);const s=(0,n.f)("IALSessionFromHost");(0,n.f)("ProofingSettingsRequestTypes")},436:(e,t,i)=>{if(i.d(t,{J:()=>a}),2063!=i.j)var n=i(33355);if(2063!=i.j)var s=i(93721);if(2063!=i.j)var o=i(42385);if(2063!=i.j)var r=i(51152);class a{constructor(){this.imports=[o.E]}get uniqueId(){return(0,r.z)(507918404)}configureRootServices(e){e.bind(n.T).to(s.k)}}},82199:(e,t,i)=>{if(i.d(t,{M:()=>p}),2063!=i.j)var n=i(47571);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(11804);if(2063!=i.j)var r=i(56275);if(2063!=i.j)var a=i(10138);if(2063!=i.j)var l=i(60503);if(2063!=i.j)var d=i(20645);if(2063!=i.j)var c=i(42385);if(2063!=i.j)var u=i(44762);if(2063!=i.j)var h=i(33781);const g=(0,i(76729).f)("IClientRuntime");class p{constructor(){this.imports=[c.E]}get uniqueId(){return(0,s.z)(507918289)}configureRootServices(e){var t;const i=e.get(o.n);(null===(t=i.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&i.orchestratorSettings.augLoopEndpoint&&(e.bind(g).toDynamicValue((()=>(0,u.xB)())),e.bind(n.a).toDynamicValue((e=>(t,i)=>{const n=e.get(o.n),s=e.get(d.o),c=e.get(r.qy),u=e.get(a.g),p=e.getOptional(l.v),m=e.get(g),f=(0,h.nv)(n,s,c,u,m,p),v=e.getAll(h.cl);return f.withHostCallbacksCustomizations(v),f.build(t,i)})))}}},59853:(e,t,i)=>{if(i.d(t,{g:()=>l}),2063!=i.j)var n=i(83471);if(2063!=i.j)var s=i(20645);if(2063!=i.j)var o=i(51152);if(2063!=i.j)var r=i(45462);if(2063!=i.j)var a=i(40143);class l{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918406)}configureRootServices(e){e.bind(r.f).to(a.E),e.bind(s.o).to(n.v)}}},76668:(e,t,i)=>{if(i.d(t,{h:()=>d}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(11804);if(2063!=i.j)var o=i(97446);if(2063!=i.j)var r=i(1509);if(2063!=i.j)var a=i(59853);if(2063!=i.j)var l=i(77645);class d{constructor(){this.imports=[a.g]}get uniqueId(){return(0,n.z)(507918402)}configureRootServices(e){e.bind(r.R9).toDynamicValue((e=>{const t=e.get(s.n);return new r.R9({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(o.S).to(l.M)}}},39869:(e,t,i)=>{i.d(t,{U:()=>o});const n="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",s=(e,t)=>{const i=[];for(const s of Object.keys(e)){if(void 0===e[s]||null===e[s])continue;const o={name:t?`${t}.${s}`:s,dataType:(n=e[s],"string"==typeof n?0:"boolean"==typeof n?1:"number"==typeof n?2:0),value:e[s],classification:4};i.push(o)}var n;return i};function o(e){return(t,i,o,r,a,l,d,c)=>{const u=t===n;let h,g=s(o);if(r){let e=s(a,r.split(".").slice(-1)[0]);u&&(e=[...e,...g],g=[]),h={name:r,dataFields:e}}const p={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:i,dataFields:g,eventFlags:{dataCategories:d,diagnosticLevel:c},eventContract:h};e.sendTelemetryEvent(p)}}},42385:(e,t,i)=>{if(i.d(t,{E:()=>d}),2063!=i.j)var n=i(5923);if(2063!=i.j)var s=i(45634);if(2063!=i.j)var o=i(47571);if(2063!=i.j)var r=i(59853);if(2063!=i.j)var a=i(12366);if(2063!=i.j)var l=i(51152);class d{constructor(){this.imports=[r.g]}get uniqueId(){return(0,l.z)(507918371)}configureRootServices(e){e.bind(o.J).to(a.r),e.bind(n.G).to(s.h)}}},12366:(e,t,i)=>{i.d(t,{r:()=>D});var n=i(79490),s=i(70825),o=i(35813),r=i(13290),a=i(76778),l=i(71924),d=i(18104),c=i(11804),u=i(10138),h=i(55972),g=i(67843),p=i(60503),m=i(40315),f=i(29906),v=i(83010),_=i(66008),y=i(27603),I=i(82076);class C{constructor(e,t,i,n,o,r,l,d){this._sessionId=e,this._logger=t,this._annotationListeners=i,this._session=n,this._aggregateLogger=o,this._augloopDocumentSerializer=r,this._hostEmitter=l,this._clientSubscribers=d,this.sessionWasDisconnected=!1,this.initialize=async()=>{try{this._session.setConnectCallback(this.onSessionConnected),this._session.setDisconnectCallback(this.onSessionDisconnected)}catch(e){this._logger.error(561534362,"Failed to initialize AugLoop session callbacks",e)}try{await this.activateAnnotations(this._annotationListeners.map((e=>e.annotationListenerType)))}catch(e){this._logger.error(508614281,"Failed to initialize AugLoop session annotations",e)}},this.close=()=>{this._session.close()},this.submitDelta=(e,t,i)=>{var n;const o=new s.xU({parentPath:e,items:[{id:e[e.length-1],revId:`${i}`,body:t,sourceTimestamp:Date.now()}]});this._session.submitOperation(o),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512337430,`submitDelta. unit: ${t.unit}`)},this.getSessionId=()=>this._sessionId,this.getSession=()=>this._session,this.updateAnnotationActivationConfig=async()=>{await Promise.all(this._annotationListeners.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325704,`updateAnnotationActivationConfig called for ${e.annotationListenerType}`),e.updateAnnotationActivationConfig()})))},this.activateAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325703,`activateAnnotations called for ${e.annotationListenerType}`),e.activateAnnotations(this._session,this._sessionId)})))},this.releaseAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));return(await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325702,`deactivateAnnotations called for ${e.annotationListenerType}`),e.deactivateAnnotations(this._session)})))).every(Boolean)},this.submitSignal=(e,t,i)=>{var n,o,r;const a=new s.g0({parentPath:this._augloopDocumentSerializer.getParentPath(this,i),items:[{id:t,body:e}]});this._session.submitOperation(a),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512325701,`submitted a signal of type: ${null!==(r=null===(o=e.H_)||void 0===o?void 0:o.T_)&&void 0!==r?r:"unknown"}`)},this.onDocumentCreated=e=>{for(const t of this._clientSubscribers)t.onDocumentCreated(this,e)},this.onSessionDisconnected=()=>{this.sessionWasDisconnected=!0,this._logger.warn(507773218,"Augloop session has disconnected")},this.onSessionConnected=async e=>{if(!e)return;const t=this.sessionWasDisconnected;if(this.sessionWasDisconnected=!1,t){this._logger.warn(508631257,"Augloop session has reconnected"),this._augloopDocumentSerializer.sessionReconnected(this._session),this._augloopDocumentSerializer.submitSeedOperations(this._session);for(const e of this._clientSubscribers)e.onSessionReconnected(this);this._hostEmitter.emit(a.pD.hostModelRehydrateTiles,{address:this._sessionId,message:[]}),this._hostEmitter.emit(a.pD.hostModelRehydrateTilesFinished,{address:this._sessionId,message:[]})}else this._logger.warn(508421253,"Augloop session has initially connected"),this._augloopDocumentSerializer.submitSeedOperations(this._session)}}submitOperation(e){var t,i;this._session.submitOperation(e);const n=I.h.getTypeNameFor(e);null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325706,`_submitItemsOperation called with ${n}`),null===(i=this._aggregateLogger)||void 0===i||i.incrementEventCount(512325705,`items submitted through ${n}`,e.items.length)}}var S=i(47571),b=i(67880),T=i(33355);let E=class{constructor(e){this._clientSubscribers=e,this.hasCreatedDocument=!1}sessionReconnected(e){this.hasCreatedDocument=!1}submitSeedOperations(e){const t={id:"doc",body:new b.yo({isReadonly:!1})},i=new s.Xr({parentPath:["session"],items:[t]});try{e.submitSeedOperations([i])}catch(e){}}getParentPath(e,t){if(!this.hasCreatedDocument){this.hasCreatedDocument=!0;for(const i of this._clientSubscribers)i.onDocumentCreated(e,t)}return["session","doc"]}};E=(0,n.__decorate)([(0,f._)(),(0,n.__param)(0,(0,_.t)(T.T)),(0,n.__param)(0,(0,y.l)())],E);var N=i(58918);const x=(0,i(76729).f)("IAugloopDocumentSerializer");var w=i(82677);class L{constructor(e,t){this.logger=e,this.getOrCreateSession=t,this.pendingDeltas=new Map,this.pendingDeltaMutex=new o.e,this.targetWindow=window,this.sendAttributionRangesIfNecessary=async()=>{this.hasPendingDeltas()&&await this.submitPendingDeltas(this.getOrCreateSession)}}getKeyFromParentPath(e){return e.join()}shouldAttemptMergeDeltas(e,t){return e.modelDelta.tileId===t.modelDelta.tileId&&e.modelDelta.delta.deltaType===t.modelDelta.delta.deltaType}clearPendingTimeout(){this.pendingTimeoutId&&(this.targetWindow.clearTimeout(this.pendingTimeoutId),this.pendingTimeoutId=void 0)}getIndexForRangeMerge(e,t){if(0===t.length||t[t.length-1].start<e.start)return t.length;const i=t.findIndex((t=>t.start>e.start));return-1===i?t.length-1:i}addOrMerge(e,t){if(e.start<0||e.length<0)return void this.logger.error(506033676,"Range to merge has a negative start or length value",{start:e.start,length:e.length});0===t.length&&t.push(e);const i=this.getIndexForRangeMerge(e,t);if(t[i]&&t[i].start===e.start)return void(t[i].length!==e.length&&(t[i].length=e.length,t.splice(i+1)));const n=t[i-1];let s=i,o=0;n&&n.start+n.length>=e.start&&((0,w.G)(n.attribution,e.attribution)?(e.length=e.start-n.start+e.length,e.start=n.start,s=i-1,o=1):(n.length=e.start-n.start,s=n.length<=0?i-1:i)),t[s+1]&&t[s+1].start<e.start+e.length&&(o=Math.max(t.length-s,0)),t.splice(s,o,e)}shutdown(){this.clearPendingTimeout()}setTargetDocument(e){const t=(null==e?void 0:e.deref())||document;t.defaultView&&(this.targetWindow=t.defaultView)}hasPendingDeltas(){return this.pendingDeltas.size>0}async add(e){var t;const i=e.modelDelta.delta.attributionData;if(0===i.ranges.length&&!i.isFullUpdate)return;const n=await this.pendingDeltaMutex.lock();let s=this.pendingDeltas.get(e.address);s||(s=new Map,this.pendingDeltas.set(e.address,s));const o=this.getKeyFromParentPath(e.parentPath);s.has(o)||s.set(o,[]);const r=null!==(t=s.get(o))&&void 0!==t?t:[];if(i.isFullUpdate)s.set(o,[e]);else{const t=r.findIndex((t=>this.shouldAttemptMergeDeltas(t,e)));if(-1!==t){const e=r[t].modelDelta.delta.attributionData.ranges,n=i.ranges;for(const t of n)this.addOrMerge(t,e)}else r.push(e)}this.pendingTimeoutId||(this.pendingTimeoutId=this.targetWindow.setTimeout(this.sendAttributionRangesIfNecessary,1e3)),n()}async submitPendingDeltas(e){const t=await this.pendingDeltaMutex.lock(),i=new Map(this.pendingDeltas);this.pendingDeltas.clear(),this.clearPendingTimeout(),t();for(const[t,n]of i){const i=await e(t);if(i)for(const e of n.values())for(const t of e)i.submitDelta(t.parentPath,t.modelDelta.delta,t.modelDelta.tileVersion)}}}let D=class{constructor(e,t,i,n,c,u,h,g,p,m,f){this._hostEmitter=e,this._hostSettings=t,this._logger=i,this._e2eMetric=n,this._paragraphDeltasEnabled=c,this._clientSubscribers=u,this._sessionOrPromise=h,this._aggregateLogger=g,this._augloopSessionFactory=p,this._targetDocumentFactory=f,this._sessions=new Map,this._runtimeInstances=new Set,this._listenersInitialized=!1,this._fetchALSessionMutex=new o.e,this._pendingAttributionRangeManager=new L(this._logger,(async e=>this.getOrCreateSession(e))),this.initialize=async()=>{var e,t;this._sessionOrPromise||this._augloopSessionFactory||this._logger.error(509694866,"Failed to initialize AugLoop, there is no runtime available"),this._hostSettings.enableOrchestration&&(this._logger.log(570782413,r.q.Info,"Initializing Orchestrator."),this._hostEmitter.on(a.pD.hostModelParagraphTextTiles,this._handleTiles),this._hostEmitter.on(a.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(a.pD.hostModelAttributionDelta,this._handleAttributionDelta),this._hostEmitter.on(a.pD.hostModelFormattingDelta,this._handleDelta),this._hostEmitter.on(a.pD.hostModelTextTile,this._handleTile),this._hostEmitter.on(a.pD.hostModelMoveTextTile,this._handleMove));for(const e of this._clientSubscribers)e.register(this,this._augloopDocumentSerializer);this._listenersInitialized=!0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.setTargetDocument(null===(t=this._targetDocumentFactory)||void 0===t?void 0:t.call(this))},this.shutDown=()=>{var e;this._logger.log(570782414,r.q.Debug,"Shutting down Orchestrator."),this._listenersInitialized||this._logger.log(570782415,r.q.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted.");for(const e of this._clientSubscribers)e.unregister();for(const e of this._sessions.values())e.getSession()!==this._sessionFromHost&&e.close();for(const e of this._runtimeInstances)e.uninitialize();this._sessions.clear(),this._runtimeInstances.clear(),this._listenersInitialized=!1,this._sessionOrPromise=void 0,this._sessionFromHost=void 0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.shutdown(),this._pendingAttributionRangeManager=void 0},this.deactivateAnnotations=async e=>{const t=(await Promise.all([...this._sessions.keys()].map((t=>{var i;return null===(i=this._sessions.get(t))||void 0===i?void 0:i.releaseAnnotations(e)})))).every(Boolean);return t||this._logger.error(526209822,"Some annotations failed to be deactivated."),t},this.activateAnnotations=async e=>{for(const t of this._sessions.values())await t.activateAnnotations(e)},this.getOrCreateSession=async e=>{var t;const i=await this._fetchALSessionMutex.lock(),n=null!==(t=this._sessions.get(e))&&void 0!==t?t:await this._createSession(e);return i(),n},this.getSessions=async e=>{if(!e)return this._sessions;const t=new Map;for(const i of e)t.set(i,await this.getOrCreateSession(i));return t},this._createSession=async e=>{const t=[];for(const e of this._clientSubscribers)t.push(e.createAnnotationListener());let i="function"==typeof this._sessionOrPromise?await this._sessionOrPromise():this._sessionOrPromise;if(i)this._sessionFromHost=i;else{if(!this._augloopSessionFactory)return;{const{session:t,runtime:n}=await this._augloopSessionFactory(this._augloopDocumentSerializer,e);i=t,n&&this._runtimeInstances.add(n)}}if(!i)return;const n=new C(e,this._logger,t,i,this._aggregateLogger,this._augloopDocumentSerializer,this._hostEmitter,this._clientSubscribers);await n.initialize();for(const e of this._clientSubscribers)e.onInitialize(n);return this._sessions.set(e,n),n},this._handleDelta=async e=>{const t=e.message;if(t.sourceType===l.pf.TileNode)return;const i=await this.getOrCreateSession(e.address);i&&(this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i.submitDelta([...this._augloopDocumentSerializer.getParentPath(i,t.documentModel),t.tileId],t.delta,t.tileVersion))},this._handleAttributionDelta=async e=>{var t;const i=e.message;if(i.sourceType===l.pf.TileNode)return;const n=await this.getOrCreateSession(e.address);n&&await(null===(t=this._pendingAttributionRangeManager)||void 0===t?void 0:t.add({address:e.address,parentPath:[...this._augloopDocumentSerializer.getParentPath(n,i.documentModel),i.tileId],modelDelta:i}))},this._handleTiles=async e=>{this._paragraphDeltasEnabled.check()||await this._handleTileMessages(e.address,e.message)},this._handleTile=async e=>{this._paragraphDeltasEnabled.check()&&e.message.data.isTextNode&&await this._handleTileMessages(e.address,[e.message])},this._handleTileMessages=async(e,t)=>{const i=await this.getOrCreateSession(e);if(i)for(const n of t){const t=n.data;let o;switch(n.messageType){case d.G.NewData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),o=new s.Xr({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}],prevId:n.data.prevId,nextId:n.data.nextId});break;case d.G.RemoveData:o=new s.n4({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,sourceTimestamp:Date.now()}]});break;case d.G.ChangeData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),o=new s.fZ({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}]})}i.submitOperation(o),this._hostEmitter.emit(a.pD.hostModelTextTileEmittedToAugloop,{address:e,message:n})}},this._handleMove=async e=>{const t=e.message;await this._handleTileMessages(e.address,[{messageType:d.G.RemoveData,data:{tileId:t.oldTileId,tileVersion:t.tileVersion,documentModel:t.oldDocumentModel,tile:void 0,changeType:l.Q0.Code,isTextNode:!1}},{messageType:d.G.NewData,data:{tileId:t.newTileId,tileVersion:t.tileVersion,documentModel:t.newDocumentModel,tile:t.tile,changeType:l.Q0.Code,isTextNode:!1,prevId:t.prevId,nextId:t.nextId}}])},this._augloopDocumentSerializer=null!=m?m:new E(u)}};D=(0,n.__decorate)([(0,f._)(),(0,n.__param)(0,(0,v.W)(a.M5)),(0,n.__param)(1,(0,v.W)(c.n)),(0,n.__param)(2,(0,v.W)(u.g)),(0,n.__param)(3,(0,v.W)(h.m)),(0,n.__param)(4,(0,v.W)(g.H)),(0,n.__param)(5,(0,_.t)(T.T)),(0,n.__param)(5,(0,y.l)()),(0,n.__param)(6,(0,v.W)(N.P)),(0,n.__param)(6,(0,y.l)()),(0,n.__param)(7,(0,y.l)()),(0,n.__param)(7,(0,v.W)(p.v)),(0,n.__param)(8,(0,y.l)()),(0,n.__param)(8,(0,v.W)(S.a)),(0,n.__param)(9,(0,y.l)()),(0,n.__param)(9,(0,v.W)(x)),(0,n.__param)(10,(0,y.l)()),(0,n.__param)(10,(0,v.W)(m.Ze))],D)},83471:(e,t,i)=>{i.d(t,{v:()=>d});var n=i(79490),s=i(91513),o=i(2915),r=i(11804),a=i(29906),l=i(83010);let d=class{constructor(e,t){this._proofingStore=e,this._hostSettings=t}async buildDescriptors(){var e;const t="FlightIds";let i;try{i=JSON.parse(await this._proofingStore.read(s.l.Descriptors))}catch(e){i=JSON.parse(this._proofingStore.getDefaultValue(s.l.Descriptors))}let n="";if(this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(n=`${n}${this._hostSettings.flightsToTrack.join(";")}`),""!==n){const e=i.find((e=>e.name===t));e?e.value=`${e.value};${n}`:i.push({name:t,value:n})}return(null===(e=this._hostSettings.hostMetadata)||void 0===e?void 0:e.releaseAudienceGroup)&&i.push({name:"Audience",value:c(this._hostSettings.hostMetadata.releaseAudienceGroup)}),i}};function c(e){switch(e){case"Local":case"Staging":case"Dogfood":case"DogFood":return"DogFood";case"Microsoft":return"Microsoft";default:return"Production"}}d=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(o.K)),(0,n.__param)(1,(0,l.W)(r.n))],d)},20645:(e,t,i)=>{i.d(t,{o:()=>n});const n=(0,i(76729).f)("IDescriptorManager")},40143:(e,t,i)=>{i.d(t,{E:()=>T});var n=i(79490),s=i(91513),o=i(68794);const r="IsPaneOpen",a="IsPaneOpenedInSession";var l,d,c=i(59433),u=i(79343),h=i(95523),g=i(76778),p=i(85924),m=i(2915),f=i(10138),v=i(40200),_=i(45242),y=i(65798),I=i(29906),C=i(83010),S=i(27603);!function(e){e.InstrumentationCall="InstrumentationCall"}(l||(l={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(d||(d={}));var b=i(20645);let T=class{constructor(e,t,i,n,s){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=i,this._logger=n,this._paneOpenState=s}async process(e){const t=await this.getRequest(e);return!!t&&(this.emitInstrumentationRequest(t,e),this.logActivity(t),!0)}async getRequest(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext)return{appId:await this._proofingStore.read(s.l.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:o.I.getDefaultLanguageCode(await this._proofingStore.read(s.l.ProofingLanguages)),traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map((e=>e.text)),suggestionText:this.getSuggestionText(e),metadata:this.getMetadata(e),substrateEventCustomFields:e.customProperties}}getSuggestionText(e){const t=e.critique.suggestions.map((e=>e.text));let i=t[e.eventId-4];return e.eventId!==y.xp.Autoreplace&&e.eventId!==y.xp.AutoreplaceUndo||(i=t[0]),e.eventId>=y.xp.ChangeAllSugg0&&e.eventId<=y.xp.ChangeAllSugg2&&(i=t[e.eventId-8]),i}getMetadata(e){var t,i;const n=null!==(i=null===(t=e.critique.metadata)||void 0===t?void 0:t.slice())&&void 0!==i?i:[];this._paneOpenState&&n.push({name:r,value:String(this._paneOpenState.isPaneOpen)},{name:a,value:String(this._paneOpenState.isPaneOpenedInSession)});const o=this._proofingStore.getCachedEntry(s.l.ProofingLanguages).storeEntryValue;return n.push({name:c.o.NumProofingLanguages,value:String(o.length)}),n}emitInstrumentationRequest(e,t){e.critiqueTypeId===u.L9.TopicSuggestion||(0,h.r3)(t.critique)||this._hostEmitter.emit(g.pD.instrumentationRequestV1,{address:void 0,message:e})}logActivity(e){const t=this._logger.getNewActivity(l.InstrumentationCall,_.o.SamplingPolicy.Measure),i=e.substrateEventCustomFields&&"true"===e.substrateEventCustomFields.isPersonalized||!1;t&&(t.dataFields.push(...(0,p.W)(["EventID",e.eventId],["CritiquePriority",e.critiquePriority],["CritiqueTypeId",e.critiqueTypeId],["IsPersonalizedEvent",i])),t.success=!0,t.endNow())}};T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.W)(g.M5)),(0,n.__param)(1,(0,C.W)(m.K)),(0,n.__param)(2,(0,C.W)(b.o)),(0,n.__param)(3,(0,C.W)(f.g)),(0,n.__param)(4,(0,S.l)()),(0,n.__param)(4,(0,C.W)(v.F))],T)},77645:(e,t,i)=>{i.d(t,{M:()=>g});var n=i(79490),s=i(76778),o=i(77322),r=i(11804),a=i(10138),l=i(8447),d=i(1509),c=i(29906),u=i(83010),h=i(93443);let g=class{constructor(e,t,i,n,s,o){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=i,this._hostSettings=n,this._logger=s,this._sessionContextProvider=o}async initialize(){this._hostEmitter.on(s.pD.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const i=await this._sessionContextProvider();return i.sessionId&&(this._editorService.xUserSessionId=i.sessionId),i.composeSessionId&&(this._editorService.xUserComposeSessionId=i.composeSessionId),function(e,t,i){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let n=h.G_.NoLicense;t?n=h.G_.Subscription:i&&(n=i),null==e||e.push({name:"LicenseType",value:n})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(o.e)),(0,n.__param)(1,(0,u.W)(s.M5)),(0,n.__param)(2,(0,u.W)(d.R9)),(0,n.__param)(3,(0,u.W)(r.n)),(0,n.__param)(4,(0,u.W)(a.g)),(0,n.__param)(5,(0,u.W)(l.a))],g)},79034:(e,t,i)=>{i.d(t,{N:()=>n});const n=(0,i(76729).f)("IOrchestratorSettings")},2253:(e,t,i)=>{i.d(t,{u:()=>d});var n=i(8520),s=i(26598),o=i(30833),r=i(90327),a=i(10219);const l=(0,s.F5)({stateStore:o.A.on(r.JY),featureFlagsReader:o.A.on(a.c)}),d=()=>{const{featureFlagsReader:e,stateStore:t}=(0,s.KN)(l),[i,o]=n.useState(void 0);return n.useEffect((()=>(t.subscribe("stateUpdated",o),()=>{t.unsubscribe("stateUpdated",o)})),[t]),i?n.createElement(c,{enableAriaStatusInNonRootIFrames:e.flags.enableAriaStatusInNonRootIFrames,politeUpdates:i.politeUpdates,assertiveUpdates:i.assertiveUpdates,status:i.status,statusSeverity:i.statusSeverity}):null},c=e=>{const{enableAriaStatusInNonRootIFrames:t,politeUpdates:i,assertiveUpdates:s,status:o,statusSeverity:r}=e,a={width:0,height:0,color:"transparent",background:"none",border:"none",outline:"none",overflow:"hidden",pointerEvents:"none"};return window.self===window.top||t?n.createElement(n.Fragment,null,o&&n.createElement("div",{role:"status","aria-live":r,"aria-label":o,style:a}),0!==s.length&&n.createElement("div",{role:"log","aria-live":"assertive",style:a},s),0!==i.length&&n.createElement("div",{role:"log","aria-live":"polite",style:a},i)):null}},90327:(e,t,i)=>{i.d(t,{JY:()=>c,Th:()=>u,yi:()=>h});var n=i(79490),s=i(59556),o=i(98970),r=i(10219),a=i(76729),l=i(29906),d=i(83010);const c=(0,a.f)("IAriaStatusStateStore"),u=(0,a.f)("IAriaStatusStateStoreFactory");let h=class extends s.z{constructor(e){super(),this.featureFlagsReader=e,this.purgeDelay=1e4,this.logPurgeTimeout={},this._politeUpdates=[],this._assertiveUpdates=[],this._status=void 0,this._statusSeverity="off",this.postMessageIfIframe=e=>window.self!==window.top&&(this.featureFlagsReader.flags.enableAriaStatusPostMessage?(window.parent.postMessage(e,"*"),!0):!this.featureFlagsReader.flags.enableAriaStatusInNonRootIFrames),this.reset=(e,t,i)=>{this.postMessageIfIframe({messageType:"msAriaResetMessage",resetStatus:e,resetAssertiveLogs:t,resetPoliteLogs:i})||(e&&(this._status=void 0,this._statusSeverity="off"),t&&(this._assertiveUpdates=[]),i&&(this._politeUpdates=[]),this.publishStateChange())},this.scheduleLogCleanup=e=>{this.cancelScheduledCleanup(e),this.logPurgeTimeout[e]=window.setTimeout((()=>{const t="assertive"===e,i="polite"===e;this.reset(!1,t,i)}),this.purgeDelay)},this.cancelScheduledCleanup=e=>{const t=this.logPurgeTimeout[e];t&&(window.clearTimeout(t),this.logPurgeTimeout[e]=void 0)},this.onMessage=e=>{var t;if(null===(t=e.data)||void 0===t?void 0:t.messageType)if("msAriaSetMessage"===e.data.messageType){const t=e.data;void 0===t.status||"assertive"!==t.severity&&"polite"!==t.severity&&"off"!==t.severity||(Array.isArray(t.status)?this.addPreservedStatuses(t.status,t.severity):this.setStatus(t.status,t.severity,!!t.preserve))}else if("msAriaResetMessage"===e.data.messageType){const t=e.data;void 0!==t.resetAssertiveLogs&&void 0!==t.resetPoliteLogs&&void 0!==t.resetStatus&&this.reset(t.resetStatus,t.resetAssertiveLogs,t.resetPoliteLogs)}}}async initialize(){this.featureFlagsReader.flags.enableAriaStatusPostMessage&&window.self===window.top&&(this.eventListener=new o.J(window),this.eventListener.addListener("message",this.onMessage,{passive:!0,capture:!0}))}shutDown(){var e;null===(e=this.eventListener)||void 0===e||e.removeAllListeners(),this.eventListener=void 0}setStatus(e,t,i=!1){if(!this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:i})){if(i){if("polite"===t||"assertive"===t){const i="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),i.push(e),this.scheduleLogCleanup(t)}}else this._statusSeverity=t,this._status=e;this.publishStateChange()}}addPreservedStatuses(e,t){if(this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:!0}))return;if("off"===t)return;const i="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),i.push(...e),this.scheduleLogCleanup(t),this.publishStateChange()}resetAll(){this.reset(!0,!0,!0)}resetPreserved(){this.reset(!1,!0,!0)}resetStatus(){this.reset(!0,!1,!1)}publishStateChange(){this.publishEvent("stateUpdated",{status:this._status,statusSeverity:this._statusSeverity,politeUpdates:this._politeUpdates,assertiveUpdates:this._assertiveUpdates})}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.c))],h)},18272:(e,t,i)=>{i.d(t,{Jx:()=>n,XG:()=>u,mU:()=>c});var n,s=i(79490),o=i(96571),r=i(90327),a=i(76729),l=i(29906),d=i(83010);!function(e){e[e.KeepOriginal=0]="KeepOriginal",e[e.AutoCorrectAppearance=1]="AutoCorrectAppearance",e[e.AutoCorrectHover=2]="AutoCorrectHover",e[e.SingleIssueOnLine=3]="SingleIssueOnLine",e[e.IssuesOnLine=4]="IssuesOnLine"}(n||(n={}));const c=(0,a.f)("IAriaStatusUniqueProxy");let u=class{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.existingCritiques=new Set,this.completeStatusMessage=(e,t)=>{const i=this.getMessageKey(t);if(!i)return e;let s=this.localizer.getMessage(i,e);return t===n.AutoCorrectHover&&(s=`${s} ${this.localizer.getMessage("ebx_autoCorrectedKeyboardAccess")}`),s},this.getMessageKey=e=>e===n.AutoCorrectAppearance||e===n.AutoCorrectHover?"ebx_autoCorrected":e===n.SingleIssueOnLine?"ebx_issuesOnLineSingular":e===n.IssuesOnLine?"ebx_issuesOnLinePlural":void 0}setStatus(e,t,i=!1,n,s){if(n&&i){if(this.existingCritiques.has(n))return;this.existingCritiques.add(n)}const o=void 0===s?e:this.completeStatusMessage(e,s);this.ariaStatusStateStore.setStatus(o,t,i)}addPreservedStatuses(e,t){const i=e.filter((e=>{const t=this.existingCritiques.has(e.id);return t||this.existingCritiques.add(e.id),!t})).map((e=>void 0===e.messageKind?e.text:this.completeStatusMessage(e.text,e.messageKind)));this.ariaStatusStateStore.addPreservedStatuses([i.join(". ")],t)}setLineNavStatus(e,t,i){e<1||this.setStatus(e.toLocaleString(),t,i,void 0,1===e?n.SingleIssueOnLine:n.IssuesOnLine)}};u=(0,s.__decorate)([(0,l._)(),(0,s.__param)(0,(0,d.W)(r.JY)),(0,s.__param)(1,(0,d.W)(o.H))],u)},17806:(e,t,i)=>{if(i.d(t,{U:()=>g,d:()=>u}),2063!=i.j)var n=i(31335);var s=i(26598),o=i(30833),r=i(14775),a=i(40315),l=i(11804);if(2063!=i.j)var d=i(44528);var c=i(8520);const u=c.createContext(void 0),h=(0,s.F5)({languageScriptDirectionDetector:o.A.on(r.iw).optional(),targetWindowRef:o.A.on(a.sh).optional(),hostSettings:o.A.on(l.n).optional()}),g=e=>{const{hostSettings:t,languageScriptDirectionDetector:i,targetWindowRef:o}=(0,s.SM)(h),r=c.useContext(u),a=null==o?void 0:o.deref();c.useEffect((()=>{var e;return null===(e=null==t?void 0:t.onCalloutOpened)||void 0===e||e.call(t,null,void 0,r),()=>{var e;null===(e=null==t?void 0:t.onCalloutClosed)||void 0===e||e.call(t,null,void 0,r)}}),[t,r,e.target,a]);const l={hostId:r,eventBubblingEnabled:!0};return c.createElement(n.P,Object.assign({dir:null==i?void 0:i.dir(),layerProps:l},e,{target:e.target,doNotLayer:!r&&e.doNotLayer}),void 0===i?e.children:c.createElement(d.K,{rtl:i.isRtl()},e.children))}},70547:(e,t,i)=>{i.d(t,{v:()=>p});var n=i(26598),s=i(30833),o=i(14775),r=i(11804),a=i(40315),l=i(14113),d=i(31043),c=i(44528),u=i(24055),h=i(8520);const g=(0,n.F5)({languageScriptDirectionDetector:s.A.on(o.iw).optional(),hostSettings:s.A.on(r.n).optional(),targetWindow:s.A.on(a.sh).optional()}),p=h.forwardRef(((e,t)=>{var i,s,o,r;const{hostSettings:a,languageScriptDirectionDetector:p,targetWindow:m}=(0,n.SM)(g),f=h.useRef(null),v=(null===(i=e.popover)||void 0===i?void 0:i.positioning).target;return h.useImperativeHandle(t,(()=>({getElementRef:()=>f}))),h.useEffect((()=>{var t;return null===(t=null==a?void 0:a.onCalloutOpened)||void 0===t||t.call(a,null,v,void 0),e.moveFocusIntoModalizer&&setTimeout((()=>{var e,t,i,n;const s=(0,u.OT)(null!==(e=null==m?void 0:m.deref())&&void 0!==e?e:window),o=f.current?null===(n=null===(i=null===(t=null==s?void 0:s.core)||void 0===t?void 0:t.storageEntry)||void 0===i?void 0:i.call(t,f.current))||void 0===n?void 0:n.tabster:void 0;if(!s||!(null==o?void 0:o.modalizer))return;(0,u.Az)(s).setActive(o.modalizer)}),0),()=>{var e;null===(e=null==a?void 0:a.onCalloutClosed)||void 0===e||e.call(a,null,v,void 0)}}),[a,e.moveFocusIntoModalizer,v]),h.createElement(l.A,Object.assign({},e.popover),h.createElement(d.H,Object.assign({},e.surface,{ref:f,dir:null==p?void 0:p.dir(),role:null===(s=e.popover)||void 0===s?void 0:s.ariaRole,"aria-label":null===(o=e.popover)||void 0===o?void 0:o.ariaLabel,"aria-labelledby":null===(r=e.popover)||void 0===r?void 0:r.ariaLabelledBy}),void 0===p?e.children:h.createElement(c.K,{rtl:p.isRtl()},e.children)))}))},63011:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(76729).f)("ICalloutDismissalHandler")},36015:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(76729).f)("ICritiqueCalloutStateStoreBase")},5645:(e,t,i)=>{i.d(t,{x:()=>n});const n=(0,i(76729).f)("IUndoCalloutStateStoreBase")},27523:(e,t,i)=>{i.d(t,{D:()=>o,Y:()=>n});var n,s=i(76729);!function(e){e.critique="critique",e.inlineSuggestions="inlineSuggestions",e.languageAutoDetection="languageAutoDetection"}(n||(n={}));const o=(0,s.f)("IFooterFreStore")},25741:(e,t,i)=>{i.d(t,{z:()=>l});var n=i(79490),s=i(29906),o=i(83010),r=i(85339),a=i(23943);let l=class{constructor(e,t){this._inlineSuggestionsRenderer=e,this._proofingDom=t}filter(e){const t=this._inlineSuggestionsRenderer.getCurrentMenuInfo();if(!t||"InlineSuggestionsResultsUserInitiatedMenuType"!==t.menuType.menuType)return!0;if(e.nodeId===t.tileId){const i=this._proofingDom.findParagraphNode(t.tileId);if((null==i?void 0:i.element)&&"offset"in i.element)return!this.intersects(e.start,e.start+e.length,i.element.offset+t.queryRange.start,i.element.offset+t.queryRange.start+t.queryRange.length)}return!0}intersects(e,t,i,n){return e<=n&&i<=t}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.V)),(0,n.__param)(1,(0,o.W)(a.w))],l)},65197:(e,t,i)=>{i.d(t,{X:()=>p});var n=i(79490),s=i(1527),o=i(11804),r=i(52946),a=i(30318),l=i(754),d=i(39593),c=i(85339),u=i(29906),h=i(83010),g=i(27603);let p=class{constructor(e,t,i,n){this._hostSettings=e,this._oaLogger=t,this._tileContent=i,this._shadowElementsStore=n}async getTargetLocationOfECC(e,t){var i,n,o,r,l,d,u;if((null===(i=t.menuCurrentlyOpen)||void 0===i?void 0:i.enableExpandedECCSearchBar)&&(this._hostSettings.flightsToTrack||[]).includes("mc-editor-attachbutton-searchbar-position")&&t.triggerMethod===c.P.AttachFile){const t=null===(n=(0,a.q)(this._tileContent,e))||void 0===n?void 0:n.parentNode,i=null!==t?t.getBoundingClientRect():void 0;if(i)return{x:i.left,y:i.top}}if(!t.menuCurrentlyOpen)return null;const{targetOffset:h,queryRange:g}=t.menuCurrentlyOpen,p=e.element.offset+g.start;let m=this._tileContent.getContainingElement(e);if((0,s.C)(m,"HTMLInputElement")||(0,s.C)(m,"HTMLTextAreaElement")){const t=null===(o=this._shadowElementsStore)||void 0===o?void 0:o.getShadowElementStore(e.parent.id);t?(await t.updateOverlay(),m=t.container):this._oaLogger.logDiagnostics("Attempted to render ECC on an input/textarea, but no shadow element store was available, so the ECC will most likely be placed in the wrong place.")}const f=await this._tileContent.getRangeOfNode(e.parent,m,p,null!==(l=null===(r=g.prefix)||void 0===r?void 0:r.length)&&void 0!==l?l:1);if(!m)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element could not be determined"),null;if(!m.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element was disconnected"),null;if(!f)return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid range for the menu character could be found"),null;if(!f.startContainer.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range was returned containing a detached HTML node"),null;if((null===(d=this._hostSettings.oaSettings)||void 0===d?void 0:d.atMentionClassName)&&this.hasSomeParentWithAnyClass(f.startContainer,[this._hostSettings.oaSettings.atMentionClassName]))return null;if((null===(u=this._hostSettings.oaSettings)||void 0===u?void 0:u.disabledClassNames)&&this.hasSomeParentWithAnyClass(f.startContainer,this._hostSettings.oaSettings.disabledClassNames))return null;let v=f.getBoundingClientRect();if(0===v.top&&0===v.bottom&&0===v.left&&0===v.right&&0===v.height&&0===v.width){if(f.startContainer!==f.endContainer||!f.startContainer.parentElement)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;if(v=f.startContainer.parentElement.getBoundingClientRect(),0===v.top&&0===v.bottom&&0===v.left&&0===v.right&&0===v.height&&0===v.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found"),null}const _=h?new DOMRect(v.left-h.x,v.top-h.y,v.width+2*h.x,v.height+2*h.y):v;return function(e,t,i){const n=t.commonAncestorContainer.ownerDocument,s=null==n?void 0:n.defaultView;if(!s)return!1;const o={x:e.left+e.width/2,y:e.top+e.height/2};let r=n.elementFromPoint(o.x,o.y),a=!1;do{if(r===i){a=!0;break}r=null==r?void 0:r.parentNode}while(r);if(!a)return!1;return o.x<0||o.y<0||o.x>(s.innerWidth||n.documentElement.clientWidth)||o.y>(s.innerHeight||n.documentElement.clientHeight)}(_,f,m)?null:_}hasSomeParentWithAnyClass(e,t){return!!t.find((t=>{var i;return null===(i=e.className)||void 0===i?void 0:i.split(" ").includes(t)}))||!!e.parentElement&&this.hasSomeParentWithAnyClass(e.parentElement,t)}};p=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(o.n)),(0,n.__param)(1,(0,h.W)(r.m)),(0,n.__param)(2,(0,h.W)(l.d)),(0,n.__param)(3,(0,g.l)()),(0,n.__param)(3,(0,h.W)(d.S))],p)},61703:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(76729).f)("IInlineSuggestionsCalloutPlacement")},72028:(e,t,i)=>{i.d(t,{e:()=>n});const n=(0,i(76729).f)("IInlineSuggestionsCalloutSizeAndDirectionUtils")},85339:(e,t,i)=>{i.d(t,{P:()=>n,V:()=>o});var n,s=i(76729);!function(e){e.AttachFile="AttachFile",e.TriggerChar="TriggerChar",e.Fre="Fre"}(n||(n={}));const o=(0,s.f)("IInlineSuggestionsRenderer")},43230:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(76729).f)("IUserProfilePictureCache")},14899:(e,t,i)=>{i.d(t,{W:()=>He});var n=i(79490),s=i(13263),o=i(67069),r=i(24281),a=i(63088),l=i(921),d=i(99614),c=i(4915),u=i(19064),h=i(76778),g=i(98824),p=i(18104),m=i(71924),f=i(85924),v=i(28401),_=i(98970),y=i(97153),I=i(33511),C=i(59332),S=i(68805),b=i(11804),T=i(52946),E=i(10138),N=i(21711),x=i(32177),w=i(21522),L=i(96571),D=i(10219),F=i(95834),A=i(52041),R=i(14775),q=i(40315),P=i(40200),O=i(45462),k=i(39826),z=i(90327),M=i(63011),j=i(94526),W=i(30318),B=i(99648),U=i(23943),H=i(15168),V=i(754),G=i(67165),Q=i(16087),K=i(9828),$=i(65798),J=i(69811),Z=i(85339),Y=i(60963),X=i(17205),ee=i(29906),te=i(83010),ie=i(27603),ne=i(66008),se=i(62617),oe=i(19728),re=i(87414),ae=i(18309);class le{getPluginCalloutMaxHeight(e,t,i){var n;const s=null!==(n=e.y)&&void 0!==n?n:e.top;if(s)return Math.max(t.innerHeight-s,s)-20}getCalloutDirection(e,t,i,n){return e?ae.A.bottomRightEdge:ae.A.bottomLeftEdge}}var de=i(2010),ce=i(72622),ue=i(74368),he=i(32242),ge=i(31994);class pe{constructor(e,t,i){this._services=e,this._calloutState=t,this.wrapInClearingSearch=i,this._searchBoxQueryUpdated=!1,this._localizer=e.localizer,this._oaLogger=e.oaLogger,this._hostEmitter=e.hostEmitter,this._proofingDom=e.proofingDom,this._oaResultStore=e.oaResultStore,this._queryDetection=e.queryDetection}buildExpandedEccSearchBarConfig(e){return{enableExpandedECCSearchBar:e,onSearchChange:(e="")=>{var t,i;const n=this._calloutState.menuCurrentlyOpen;if(!(null==n?void 0:n.expandedEccSearchBarConfig))return;const s=this._proofingDom.findParagraphNode(n.tileId);if(!(0,j.l)(s))return;const r=n.triggerCharacter,a=r+e,l=e.length+(null!==(t=null==r?void 0:r.length)&&void 0!==t?t:0);null!==(i=this.lastComposingBoxQuery)&&void 0!==i||(this.lastComposingBoxQuery=this._calloutState.queryString),this._calloutState.setSearchBoxQueryString(e),(0,he.A)(this._services,r,a,{start:0,length:l,prefix:r},s,this._queryDetection.getCurrentScope()),this._oaLogger.logActivity(o.h8,void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this._calloutState.setSearchBoxQueryString(""),this.wrapInClearingSearch((()=>this.removeComposingBoxQuery(!0)))}}}initShowMoreEntitiesParagraph(e,t,i){const n=this._calloutState.menuCurrentlyOpen;if(!n)return;const s=this.createSearchBoxTextTile(n);return t&&(this._previouslySpecifiedItemsToDisplay=n.specifiedItemsToDisplay,n.specifiedItemsToDisplay=void 0),this._oaResultStore.updateLoadingStatus(!0,!0),(0,he.A)(this._services,n.triggerCharacter,i,{start:0,length:i.length,prefix:""},s,e?{entityType:e}:void 0),s}buildShowMoreEntitiesConfig(e,t,i,n){var r,a;if(null===(r=this._services.hostSettings.oaSettings)||void 0===r?void 0:r.disableFlagShowMoreEntities)return;const l=(0,ue.e)(e.typeId);if(l===s.z4.File||l===s.z4.Person){const e=l===s.z4.File?d.c.File:d.c.People,r=l===s.z4.File?this._localizer.getMessage("ebx_ECCSearchFileButtonLabel"):this._localizer.getMessage("ebx_ECCSearchPeopleButtonLabel");return Object.assign(Object.assign({},null===(a=this._services.hostSettings.serviceSettings)||void 0===a?void 0:a.showMoreEntitiesSettings),{isShowMoreEntitiesEnabled:!0,showMoreEntitiesButtonLabel:r,searchBoxPlaceHolder:r,onSearchChange:(t="")=>{this.onSearchBoxQueryChange(t,e)},onClickShowMoreEntities:()=>{const t=this._calloutState.searchBoxQueryString;this.initShowMoreEntitiesParagraph(e,!0,t)?this._oaLogger.logActivity(o.tb,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(o.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},onCloseShowMoreEntities:()=>{const e=this._calloutState.menuCurrentlyOpen;e&&(this._previouslySpecifiedItemsToDisplay?(e.specifiedItemsToDisplay=this._previouslySpecifiedItemsToDisplay,this._oaResultStore.updateResults(e.specifiedItemsToDisplay,n.id,0===e.specifiedItemsToDisplay.length?c.i.NoResults:c.i.Success,void 0,void 0,0===e.specifiedItemsToDisplay.length?{NoResults:1}:{Success:1})):(e.specifiedItemsToDisplay=void 0,this._oaResultStore.updateLoadingStatus(!0,!0),(0,he.A)(this._services,e.triggerCharacter,t,i,n,void 0)),this.removeSearchBoxTextTile(e)),this._oaLogger.logActivity(o.mj,void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this.initShowMoreEntitiesParagraph(e,!1,"")?this._oaLogger.logActivity(o.N2,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(o.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},entityType:e})}}getIsSearchBarAvailable(){const e=this._calloutState.menuCurrentlyOpen;return(null==e?void 0:e.enableExpandedECCSearchBar)&&this._calloutState.searchBoxQueryString.length>0||this._searchBoxQueryUpdated}onSearchBoxQueryChange(e,t){var i;this._searchBoxQueryUpdated=!0,this._calloutState.setSearchBoxQueryString(e),null!==(i=this.lastComposingBoxQuery)&&void 0!==i||(this.lastComposingBoxQuery=this._calloutState.queryString);const n=this._calloutState.menuCurrentlyOpen;if(!(null==n?void 0:n.searchBoxGeneratedParagraphId)&&!this.initShowMoreEntitiesParagraph(t,!0,e))return void this._oaLogger.logActivity(o.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu());const s=(null==n?void 0:n.searchBoxGeneratedParagraphId)?this._proofingDom.findParagraphNode(n.searchBoxGeneratedParagraphId):void 0;s?(this._oaResultStore.updateLoadingStatus(!0,!0),(0,he.A)(this._services,null==n?void 0:n.triggerCharacter,e,{start:0,length:e.length,prefix:""},s,t?{entityType:t}:void 0,!0),this._oaLogger.logActivity(o.xe,void 0,this.getDefaultLogDataForMenu())):this._oaLogger.logActivity(o.iI,{error:"Could not find paragraph node for search bar"},this.getDefaultLogDataForMenu())}menuDismissed(e){this.removeSearchBoxTextTile(e),this._searchBoxQueryUpdated=!1,this.lastComposingBoxQuery=void 0}removeSearchBoxTextTile(e){this._previouslySpecifiedItemsToDisplay=void 0,e.searchBoxGeneratedParagraphId&&(this._hostEmitter.emit(h.pD.hostModelTextTile,{address:void 0,message:{messageType:p.G.RemoveData,data:{tileId:e.searchBoxGeneratedParagraphId,tileVersion:0,changeType:m.Q0.Code,isTextNode:!0,tile:new de.Cg({content:""})}}}),e.searchBoxGeneratedParagraphId=void 0)}async removeComposingBoxQuery(e){var t,i,n;try{const s=this._calloutState.menuCurrentlyOpen;if(!s)return;const o=this._proofingDom.findParagraphNode(s.tileId);if(!(0,j.l)(o))return;const r=this._calloutState.triggerMethod!==Z.P.AttachFile&&this._calloutState.triggerMethod!==Z.P.Fre,a=r?1:null!==(i=null===(t=s.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1;if(s.queryRange.length===a&&this._calloutState.triggerMethod!==Z.P.AttachFile)return;const l=o.element.offset+s.initialQueryStartPosition;let d=s.queryRange.length;if(r&&(d=(null!==(n=this.lastComposingBoxQuery)&&void 0!==n?n:this._calloutState.queryString).length+1),r&&d-a==0)return;this._calloutState.triggerMethod===Z.P.AttachFile?(this._queryDetection.setCurrentQueryRange(s.tileId,{start:s.queryRange.start,length:1,prefix:""},!0,this._queryDetection.getCurrentScope()),await this._services.tileContent.replace(o.parent,void 0,l,d," ").then((()=>{var e,t,i,n,s,o,r,a;const l=null===(n=null===(i=null===(t=(e=this._services).targetDocumentFactory)||void 0===t?void 0:t.call(e))||void 0===i?void 0:i.deref())||void 0===n?void 0:n.querySelectorAll(".ms-ecc-callout input[type=search]")[0];l&&(l.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(a=null===(r=null===(o=(s=this._services).targetWindowFactory)||void 0===o?void 0:o.call(s))||void 0===r?void 0:r.deref())||void 0===a||a.requestAnimationFrame((()=>{l.focus()})))}))):await this._services.tileContent.remove(o.parent,void 0,l+a,d-a).then((()=>{var t,i,n,s,o,r,a,l;if(!e)return;this.lastComposingBoxQuery=void 0,this._calloutState.clearQueryString(!0);const d=null===(s=null===(n=null===(i=(t=this._services).targetDocumentFactory)||void 0===i?void 0:i.call(t))||void 0===n?void 0:n.deref())||void 0===s?void 0:s.querySelectorAll(".ms-ecc-callout input[type=search]")[0];d&&(d.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(l=null===(a=null===(r=(o=this._services).targetWindowFactory)||void 0===r?void 0:r.call(o))||void 0===a?void 0:a.deref())||void 0===l||l.requestAnimationFrame((()=>{d.focus()})))})).finally((()=>{var t;if(!e)return;const i=s.triggerCharacter,n=s.tileId;if(!n)return;const o=this._proofingDom.findParagraphNode(n);o&&(0,he.A)(this._services,i,i+"",{start:0,length:null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0,prefix:i},o,this._queryDetection.getCurrentScope())}))}finally{this.lastComposingBoxQuery=void 0}}getDefaultLogDataForMenu(e){const t=null!=e?e:this._calloutState.menuCurrentlyOpen;return t?(0,ge.G)(t,this._services):[]}createSearchBoxTextTile(e){this.removeSearchBoxTextTile(e);const t=this.generateNewParagraphNode();return e.searchBoxGeneratedParagraphId=t.id,t}generateNewParagraphNode(){const e=new j.f(new ce.L,this._proofingDom,{offset:0,span:0});return this._hostEmitter.emit(h.pD.hostModelTextTile,{address:void 0,message:{messageType:p.G.NewData,data:{tileId:e.id,tileVersion:e.eventSeqId,changeType:m.Q0.Local,isTextNode:!0,tile:new de.Cg({content:""})}}}),e}}const me=(0,i(76729).f)("IDefaultInlineSuggestionItems");var fe=i(61703),ve=i(72028),_e=i(43230),ye=i(59556),Ie=i(18640),Ce=i(43061),Se=i(21763),be=i(94147);function Te(e,t,i){const n=null==t?void 0:t.getComponentActiveTheme(i?re.yF.expandedInlineSuggestionComponentName:re.yF.inlineSuggestionComponentName);let s;return e&&(s=JSON.parse(JSON.stringify(e))),s=Ee(s,n),s}function Ee(e,t){if(!e)return t;if(t)for(const i in t){const n=i;"object"==typeof t[n]?e[n]?Ee(e[n],t[n]):e[n]=t[n]:e[n]||(e[n]=t[n])}return e}class Ne extends ye.z{constructor(e,t,i,n){super(),this._inlineSuggestionsCalloutPlacement=t,this._inlineSuggestionsCalloutSizeAndDirectionUtils=i,this.callbackMethods=n,this.keyboardHandlerTarget=new Ce.E,this.queryString="",this.searchBoxQueryString="",this.isError=!1,this.isLoading=!0,this.resultReset=!1,this.hasTargetLocationBeenCalculated=!1,this._suggestions=void 0,this._preloadedSuggestions=void 0,this._triggeringMethod=void 0,this.overrideTargetLocation=void 0,this.menuParentElement=void 0,this.setPreloadedSuggestions=e=>{this._preloadedSuggestions=e,this.isLoading=0===e.length,this.publishUpdateEvent()},this.clearPreloadedSuggestions=()=>{var e;(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(this._preloadedSuggestions=[],this.publishUpdateEvent())},this.setSearchBoxQueryString=e=>{this.searchBoxQueryString=e,this.publishUpdateEvent()},this.inlineSuggestionsStrings=(0,be.$)().getStringsFor("InlineSuggestionStrings"),this.calloutStrings=(0,be.$)().getStringsFor("OnCanvasCalloutStrings"),this.getLocale=()=>this._hostSettings.defaultLocale,this.isFlightEnabled=this.callbackMethods.isFlightEnabled,this.onFeedbackButtonClicked=this.callbackMethods.onFeedbackButtonClicked,this.onFirstRender=this.callbackMethods.onFirstRender,this.onProcessedResults=this.callbackMethods.onProcessedResults,this.onRenderResults=this.callbackMethods.onRenderResults,this.onAction=this.callbackMethods.onAction,this.onFooterAction=this.callbackMethods.onFooterAction,this.onDismissed=this.callbackMethods.onDismissed,this.onPreventDismissOnEvent=this.callbackMethods.onPreventDismissOnEvent,this.onRestoreFocus=this.callbackMethods.onRestoreFocus,this.onSearchBoxQueryChange=this.callbackMethods.onSearchBoxQueryChange,this.onUserInteraction=this.callbackMethods.onUserInteraction,this.onGroupSelected=this.callbackMethods.onGroupSelected,this.onItemSelected=this.callbackMethods.onItemSelected,this.removeComposingBoxQuery=this.callbackMethods.removeComposingBoxQuery,this.handleKeyDown=this.callbackMethods.handleKeyDown,this.getQueryRangeBoundingClientRect=this.callbackMethods.getQueryRangeBoundingClientRect,this.handleEccUploadMenuEvent=this.callbackMethods.handleEccUploadMenuEvent,this.directionalHintCallback=(e,t,i,n)=>this._inlineSuggestionsCalloutSizeAndDirectionUtils.getCalloutDirection(n,e,t,i),this.maxHeightCallback=(e,t,i,n)=>{let s=this._inlineSuggestionsCalloutSizeAndDirectionUtils.getPluginCalloutMaxHeight(e,t,i);return(null==n?void 0:n.maxHeight)&&(s=Math.min(n.maxHeight,null!=s?s:Number.MAX_SAFE_INTEGER)),s},this._queryDetection=e.queryDetection,this._hostSettings=e.hostSettings,this._languageScriptDirectionDetector=e.languageScriptDirectionDetector,this._themeStore=e.themeStore,this._targetWindowFactory=e.targetWindowFactory,this._proofingDom=e.proofingDom,this._oaLogger=e.oaLogger}getCalloutState(){var e,t;if(this.menuCurrentlyOpen)return{calloutProps:this,targetLocation:this.hasTargetLocationBeenCalculated?this.menuCurrentlyOpen.targetLocation:void 0,targetWindow:null!==(t=null===(e=this._targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:new I.O(window),directionalHintCallback:(e,t,i)=>this.directionalHintCallback(e,t,i,this.isRtl),maxHeightCallback:(e,t)=>{var i;return this.maxHeightCallback(e,t,this.queryChar,(0,oe.toJS)(null===(i=this.styles)||void 0===i?void 0:i.containerStyles))}}}updateCurrentMenu(e,t,i){const n=this.menuCurrentlyOpen,s=!n&&e,o=n&&!e;this.menuCurrentlyOpen=e,this.overrideTargetLocation=t,this.isLoading=!0,this.isError=!1,this.resultReset=!0,this._suggestions=[],this.queryString=null!=i?i:"",this.searchBoxQueryString="",this.menuParentElement=o?void 0:this.callbackMethods.menuParentElement,s?(this.hasTargetLocationBeenCalculated=!1,this.publishEvent("menuUpdated",{messageType:p.G.NewData,data:{tileId:e.tileId,queryRange:e.queryRange}})):o?(this.hasTargetLocationBeenCalculated=!1,this._triggeringMethod=void 0,this._queryDetection.removeDetectedQuery(),this.publishEvent("menuUpdated",{messageType:p.G.RemoveData,data:{tileId:n.tileId,queryRange:n.queryRange}})):this.publishUpdateEvent()}publishUpdateEvent(){this.menuCurrentlyOpen&&this.publishEvent("menuUpdated",{messageType:p.G.ChangeData,data:{tileId:this.menuCurrentlyOpen.tileId,queryRange:this.menuCurrentlyOpen.queryRange}})}async calculateTargetLocationAndShow(){if(!this.menuCurrentlyOpen)return;this.menuParentElement=this.callbackMethods.menuParentElement;const e=this._queryDetection.getCurrentQueryLogicalId();let t=this.overrideTargetLocation;if(!t){const i=this._proofingDom.findParagraphNode(this.menuCurrentlyOpen.tileId);if(!(0,j.l)(i))return void this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid parent HTML element could be found");const n=await this._inlineSuggestionsCalloutPlacement.getTargetLocationOfECC(i,this);if(!n)return;if(this._queryDetection.getCurrentQueryLogicalId()!==e)return;t=n}"x"in t&&"InlineSuggestionsResultsFlagMenuType"===this.menuCurrentlyOpen.menuType.menuType&&(t.x=t.x-11);const i=!this.hasTargetLocationBeenCalculated||!function(e,t){if((0,Ie.Pe)(e)&&(0,Ie.Pe)(t))return e.x===t.x&&e.y===t.y;if((0,Ie.K2)(e)&&(0,Ie.K2)(t))return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height;return!1}(this.menuCurrentlyOpen.targetLocation,t);this.menuCurrentlyOpen.targetLocation=t,this.hasTargetLocationBeenCalculated=!0,i&&this.publishUpdateEvent()}setIsLoading(){this.isLoading=!0,this._suggestions=[],this.publishUpdateEvent()}setHadUnexpectedError(){this.isLoading=!1,this.isError=!0,this._suggestions=[],this.publishUpdateEvent()}setHasSuggestions(e,t,i){this.isLoading=!1,this.isError=!1,this.resultReset=t,this._suggestions=e,this.queryString=i,this.publishUpdateEvent()}setQueryString(e){this.queryString!==e&&(this.queryString=e,this.publishUpdateEvent())}setExplicitLoadingState(e,t){var i;const n=this.isLoading!==e||this.resultReset!==t||this.isError||(null===(i=this._suggestions)||void 0===i?void 0:i.length);this.isLoading=e,this.isError=!1,this.resultReset=t,this._suggestions=[],n&&this.publishUpdateEvent()}clearQueryString(e){let t=""!==this.queryString;this.queryString="",e&&(t=t||""!==this.searchBoxQueryString,this.searchBoxQueryString=""),t&&this.publishUpdateEvent()}setTriggerMethod(e){this._triggeringMethod=e}get preloadedSuggestions(){var e;return null!==(e=this._preloadedSuggestions)&&void 0!==e?e:[]}get currentScope(){return this._queryDetection.getCurrentScope()}get menuType(){var e,t;return null!==(t=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.menuType)&&void 0!==t?t:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:[]}}get theme(){var e,t,i;return Te(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.theme,this._themeStore,null!==(i=null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.enableExpandedECC)&&void 0!==i&&i)}get style(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.style}get styles(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.styles}get oaSettings(){return this._hostSettings.oaSettings}get accessibilitySettings(){return this._hostSettings}get enableScopedHeader(){var e,t,i,n;return(void 0===(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableScopedHeader)||this.menuCurrentlyOpen.enableScopedHeader)&&"InlineSuggestionsResultsUserInitiatedMenuType"===(null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType)&&!0===(null===(n=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.scopesConfig)||void 0===n?void 0:n.enabled)}get unsupportedEntities(){return this._queryDetection.getUnsupportedEntities()}get queryChar(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.triggerCharacter}get showMoreEntitiesConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig}get browseThisComputerConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.browseThisComputerConfig}get appGptConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.appGptConfig}get isFeedbackEnabled(){return!0===this._hostSettings.isFeedbackEnabledForEcc}get isFeedbackButtonEnabled(){var e,t;return!0===(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.isFeedbackButtonEnabled)}get enableExpandedECC(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableExpandedECC}get isDividerShown(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.isDividerShown}get isRtl(){var e,t;return null!==(t=null===(e=this._languageScriptDirectionDetector())||void 0===e?void 0:e.isRtl())&&void 0!==t&&t}get expandedEccSearchBarConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.expandedEccSearchBarConfig}get fluentTheme(){var e;return null===(e=this._themeStore)||void 0===e?void 0:e.getExpandedEccFluentTheme()}get triggerMethod(){return this._triggeringMethod}get suggestions(){var e,t,i;if(!this.resultReset&&(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(void 0===this.currentScope||this._preloadedSuggestions.some((e=>{var t;return e.entityType===(null===(t=this.currentScope)||void 0===t?void 0:t.entityType)})))){const e=this._preloadedSuggestions;return[...e,...(null!==(t=this._suggestions)&&void 0!==t?t:[]).filter((t=>!e.some((e=>e.entityType===t.entityType))))]}return null!==(i=this._suggestions)&&void 0!==i?i:[]}get noSuggestionsHeaderInfo(){var e;if(!this.isLoading&&0===this.suggestions.length){if(this.currentScope)return{title:(0,Se.X)(this.currentScope.entityType),isScoped:!0,isScopingEnabled:!0,suggestions:[]};if(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.noSuggestionsHeaderInfo)return Object.assign({},this.menuCurrentlyOpen.noSuggestionsHeaderInfo)}}get expandedECCHeader(){var e;const t=(0,be.$)().getStringsFor("InlineSuggestionStrings"),i=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.supportedEntityTypes;if(!this.enableExpandedECC||!i)return[{type:d.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}];const n=i.map((e=>({type:d.c.Scope,title:(0,Se.X)(e),iconName:e,scopeInfo:{entityType:e},isSelected:1===i.length,id:e})));return i.length>1&&n.unshift({type:d.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}),n}}var xe=i(61579),we=i(76787),Le=i(79343);function De(e,t,i){var n,s;const r=(null===(s=null===(n=e.hostSettings.serviceSettings)||void 0===n?void 0:n.browseThisComputerSettings)||void 0===s?void 0:s.enableBrowseThisComputerOnFileFlags)&&(!i||i.typeId===Le.L9.CIQFlag_File);if(!r)return;const{browseThisComputerSettings:a}=e.hostSettings.serviceSettings||{},l=null==a?void 0:a.fluentMenuConfig,d=null==l?void 0:l.menuItems.map((i=>Object.assign(Object.assign({},i),{onClickHandler:()=>{const n=t(),s=n?(0,ge.G)(n,e):[];e.oaLogger.logActivity(o.pp,void 0,[...s,(0,f.n)("eventType",i.menuItemId||"Unknown")]),i.onClickHandler()}})));return{isBrowseThisComputerEnabled:r,isUploadFileButtonEnabled:!i&&(null==a?void 0:a.isUploadFileButtonEnabled),onClickBrowseThisComputer:()=>{var i;const n=t(),s=n?(0,ge.G)(n,e):[];e.oaLogger.logActivity(o.pp,void 0,[...s,(0,f.n)("eventType","CIQUploadButtonClicked")]),null===(i=null==a?void 0:a.onBrowseThisComputerCallback)||void 0===i||i.call(a)},browseThisComputerButtonLabel:e.localizer.getMessage("ebx_browseThisComputerLabel"),enableCloudPicker:null==a?void 0:a.enableCloudPicker,fluentMenuConfig:l&&Object.assign(Object.assign({},l),{menuItems:d||[]}),eventTarget:null==a?void 0:a.eventTarget}}var Fe=i(25877);const Ae=(e,t,i,n,s,o)=>({ConversationId:t,ImpressionType:n,LocalTime:(new Date).toISOString(),ProviderName:s,Results:o,LogicalId:e,TraceId:i,Version:2});function Re(e,t){const i="TopHits",n={};n[i]=[],e.forEach((e=>{e.entities.forEach((e=>{if(e.isBestMatch)n[i].push(e);else{const t=e.entityType;n[t]?n[t].push(e):n[t]=[e]}}))})),0===n[i].length&&delete n[i];const s=[];let o=1;for(const e in n){const r=n[e];let a=1;s.push(Object.assign({Type:"Group",Name:e===i?i:r[0].entityType,LayoutType:"Vertical",Position:o,ResultsView:n[e].map((e=>({Type:"Entity",EntityType:`${e.entityType}Suggestion`,ReferenceId:e.ReferenceId,Position:a++,PlacementType:"Visible"})))},t&&{MetaData:t})),o++}return s}var qe=i(94600),Pe=i(90512),Oe=i(33900),ke=i(72286),ze=i(59726),Me=i(26946);function je(e,t,i,n,s,o,r,a,l){return function(e){return e.entityType===d.c.People}(e)?We(e,t):function(e){return e.entityType===d.c.File}(e)?function(e,t,i,n){var s;if(!(e.AccessUrl&&e.FileName&&e.FileExtension&&e.FileSourceType))return;const{FileExtension:o,FileName:r,FileSourceType:a,AccessUrl:l}=e,c=(0,Me.u)(r),u=(0,Oe.m)(e,t,n,i);return Object.assign(Object.assign({},e),{type:d.c.File,sourceType:Be(a),fileName:r,hitFileName:c,fileExtension:o,url:l,lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:null!==(s=e.FileSize)&&void 0!==s?s:0,subject:u,titleHitHighlightProperty:"hitFileName",subtitleHitHighlightProperty:"subject"})}(e,i,n,a):function(e){return e.entityType===d.c.Topic}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.TopicId,title:e.DisplayName,subtitle:e.Description,iconName:"Hashtag",tooltip:e.Description})}(e):function(e){return e.entityType===d.c.MessageExtensionApp}(e)?function(e,t){const i=!!t&&t.get(e.AppId);if(!i||(n=i.State,!n||n===qe.jf.NotInstalled))return;var n;return Object.assign(Object.assign({},e),{type:e.entityType,id:e.AppId,title:e.DisplayName,subtitle:i.Description,imageUrl:i.IconUrl,tooltip:i.Description})}(e,r):function(e){return e.entityType===d.c.External}(e)?function(e,t,i){var n,s;const o=function(e,t){let i="";e.SecondaryText?i=e.SecondaryText:e.Authors.length>0?i=1===e.Authors.length?`${t.getMessage("authorLabel")}: ${e.Authors[0]}`:`${t.getMessage("authorsLabel")}: ${e.Authors.join(", ")}`:e.LastModifiedDateTimeUtc&&(i=`${t.getMessage("lastModifiedDateLabel")} ${(0,ke.Z)(new Date(e.LastModifiedDateTimeUtc),new Date)}`);return i}(e,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:i&&null!==(n=e.GroupDisplayName)&&void 0!==n?n:e.entityType,id:e.ItemId,title:e.text,subtitle:o,tooltip:e.text}),!e.IconUrl&&{iconName:null===(s=e.icon)||void 0===s?void 0:s.iconName}),e.IconUrl&&{imageUrl:e.IconUrl}),{subtitleHitHighlightProperty:"ContentDomainName"})}(e,s,l):function(e){return e.entityType===d.c.Event}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,eventId:e.OriginalId||e.entityId||e.text,eventName:e.text,eventStartDateTime:e.Start,eventEndDateTime:e.End,isAllDay:e.IsAllDay,isSeries:!!e.SeriesMasterId,hasRecording:e.HasRecording})}(e):function(e){return e.entityType===d.c.Message}(e)?function(e){var t,i,n,s,o,r;return Object.assign(Object.assign({},e),{type:d.c.Message,id:e.text,subject:e.Subject,sender:null!==(r=null!==(n=null===(i=null===(t=e.From)||void 0===t?void 0:t.EmailAddress)||void 0===i?void 0:i.Name)&&void 0!==n?n:null===(o=null===(s=e.From)||void 0===s?void 0:s.EmailAddress)||void 0===o?void 0:o.Address)&&void 0!==r?r:"",emailId:e.ItemId.Id})}(e):function(e){return e.entityType===d.c.Chat}(e)?function(e){var t,i,n,s,o,r,a,l,d,c;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{id:e.text}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),{type:e.entityType,title:e.Name,name:e.Name,threadId:e.ThreadId,threadType:null!==(s=null===(n=e.ThreadType)||void 0===n?void 0:n.toString())&&void 0!==s?s:"",teamName:e.Name,groupId:e.GroupId,matchingMembers:null!==(r=null===(o=e.MatchingMembers)||void 0===o?void 0:o.map((e=>We(e,void 0))))&&void 0!==r?r:[],chatMembers:null!==(l=null===(a=e.ChatMembers)||void 0===a?void 0:a.map((e=>We(e,void 0))))&&void 0!==l?l:[],totalChatMembersCount:null!==(d=e.TotalChatMembersCount)&&void 0!==d?d:0,lastMessageTime:null!==(c=e.LastMessageTime)&&void 0!==c?c:"",imageUrl:e.IconUrl})}(e):function(e){return e.entityType===d.c.Channel}(e)?function(e,t){var i,n;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,subtitle:t.getMessage("channelOfTeamLabel",e.TeamName),tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(n=null===(i=e.icon)||void 0===i?void 0:i.iconName)&&void 0!==n?n:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e,s):function(e){return e.entityType===d.c.Team}(e)?function(e){var t,i;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e):function(e){return e.entityType===d.c.App}(e)?function(e){return Object.assign(Object.assign({},e),{id:e.CollectorId,type:d.c.App,title:e.Title,imageUrl:e.IconAnonymousUrl})}(e):function(e){return e.entityType===d.c.PIM}(e)?function(e){const t=function(e){let t="PhoneNumber";e===Pe.Nm.Address?t="Location":e===Pe.Nm.Membership&&(t="Member");return t}(e.IntentId),i=function(e){var t;let i="";e.entityType===d.c.PIM?i=null!==(t=e.SecondaryText)&&void 0!==t?t:"":"Phones"in e&&e.Phones&&e.Phones.length>0&&e.Phones[0].Type&&(i=e.Phones[0].Type);return i}(e);return Object.assign(Object.assign({},e),{type:d.c.PIM,id:e.text,title:e.text,tooltip:e.text,subtitle:i,iconName:t})}(e):function(e){return e.entityType===d.c.Scope}(e)?function(e,t){var i,n;const s=e.entityType,o=e.ScopeDisplayName||"";let r;r="Meetings"===e.ScopeDisplayName?"Event":e.ScopeDisplayName;let a=!1;const l=new Date;if(t)for(const n of t){const t=new Date(n[1]);n[0]===(null===(i=e.scopeInfo)||void 0===i?void 0:i.entityType)&&l<=new Date(t.setDate(t.getDate()+14))&&(a=!0)}return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:s,id:null!==(n=e.id)&&void 0!==n?n:e.text,title:o}),!e.IconUrl&&{iconName:r}),e.IconUrl&&{imageUrl:e.IconUrl}),{isNew:a})}(e,o):function(e){var t,i,n;const s=e.entityType,o=e.subtitle,r=null!==(t=e.tooltip)&&void 0!==t?t:"",a=(s===d.c.Scope?e.ScopeDisplayName:e.text)||"";return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:s,id:null!==(i=e.id)&&void 0!==i?i:e.text,title:a,subtitle:o,tooltip:r}),!e.IconUrl&&{iconName:null===(n=e.icon)||void 0===n?void 0:n.iconName}),e.IconUrl&&{imageUrl:e.IconUrl})}(e)}function We(e,t){var i;const n=(0,ze.u)(e);let s=e.imageUrl;s||(s=null==t?void 0:t.fetchCachedProfilePicture(n));const o=e.subtitlePropertyOverride;return Object.assign(Object.assign({},e),{ReferenceId:e.ReferenceId||e.entityId,type:d.c.People,displayName:e.text,primaryEmailAddress:n,subtitleOverride:o?e[o]:void 0,imageUrl:s,titleHitHighlightProperty:"displayName",subtitleHitHighlightProperty:null!==(i=o)&&void 0!==i?i:"primaryEmailAddress"})}function Be(e){switch(e){case"ClassicAttachment":return v.x.ClassicAttachment;case"OneDriveForBusiness":return v.x.OneDriveForBusiness;case"SharepointOnline":return v.x.SharepointOnline;default:return v.x.Undefined}}function Ue(e,t){const{browseThisComputerConfig:i,getQueryRangeBoundingClientRect:n,handleEccUploadMenuEvent:s,handleKeyDown:o,menuParentElement:r,onDismissed:a,onPreventDismissOnEvent:l}=e.calloutProps,d=async e=>{await async function(e,t){const i=await(null==t?void 0:t());if(!i)return!1;return e.clientX>=i.x&&e.clientX<=i.x+i.width&&e.clientY>=i.y&&e.clientY<=i.y+i.height}(e,n)||(0,se.m)(e.target)||!1===e.target.isConnected||a(!1)},c=async e=>{l&&!l(e)&&a(!1)},u=[];if(r){const e=new _.J(r),n=new _.J(r.ownerDocument);let a;e.addListener("keydown",o),n.addListener("mouseup",d,{capture:!0}),t&&n.addListener("scroll",c,{capture:!0}),u.push(e),u.push(n),(null==i?void 0:i.eventTarget)&&s&&(a=new _.J(i.eventTarget),a.addListener("AttachCloudFilesSelected",s),a.addListener("UploadLocalFilesSelected",s)),a&&u.push(a)}return()=>{for(const e of u)e.removeAllListeners()}}let He=class{constructor(e,t,i,n,u,C,S,b,T,E,N,x,w,L,D,F,A,R,q,P,O,k,z,M,B,U,H,V,G,Q,K,ee){var te;this._hostSettings=e,this._oaLogger=t,this._logger=i,this._guidGenerator=n,this._oaMetric=u,this._hostEmitter=C,this._proofingDom=S,this._paragraphTextExtractor=b,this._tileContent=T,this._oaResultStore=E,this._queryDetection=N,this._localizer=x,this._featureFlagsReader=w,this._proofingEmitter=L,this._safeWindow=D,this.languageScriptDirectionDetector=F,this._targetWindowFactory=R,this._targetDocumentFactory=q,this._paneOpenState=P,this._ariaStatusStateStoreFactory=O,this._indicatorStore=k,this._calloutDismissalHandler=z,this._externalSettingsFeature=M,this._instrumentationProcessor=B,this.feedbackStoreFactory=U,this._messageExtensionAppDataProvider=H,this.defaultInlineSuggestionItems=V,this.themeStore=G,this.userProfilePictureCache=Q,this._isMobile=ee,this._menus=new Map,this.resultStatus=void 0,this._isClearingSearch=!1,this._isCIQMentionsEnabled=!0,this._isFirstMenuUpdate=!1,this._fileCount=0,this._queryCorrelationKeys=void 0,this.initialize=async()=>{var e;this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled)&&(this._hostEmitter.on(h.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(h.pD.hostModelTextTile,this._handleTextTile),this._hostEmitter.on(h.pD.nudgeAccepted,this.handleNudgeAccepted),this._hostEmitter.on(h.pD.ciqSettingsChange,this.ciqSettingsChange),this._hostEmitter.on(h.pD.hostModelRehydrateTilesFinished,this.hostModelRehydrateTilesFinished),this._hostEmitter.on(h.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._calloutState.subscribe("menuUpdated",this.onMenuChanged))},this.shutDown=()=>{var e;null===(e=this._menuEventListenersDisposal)||void 0===e||e.call(this),this._menus.clear(),this._calloutState.updateCurrentMenu(void 0,void 0,void 0),this._scrollThrottle=void 0,this._resizeThrottle=void 0,this._calloutState.unsubscribe("menuUpdated",this.onMenuChanged)},this.onMenuChanged=e=>{this._proofingEmitter.emit("eccStateChanged",e)},this.hostModelVisualStateChange=e=>{var t,i;if(this._menuCurrentlyOpen&&e.message.tileId===this._menuCurrentlyOpen.parentTileId)if(e.message.created){this.renderECC(!1),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const e=this._calloutState.getCalloutState();e&&(this._menuEventListenersDisposal=Ue(e,null!==(i=this._hostSettings.useFluentV9)&&void 0!==i&&i))}else this._isMobile||this.dismissECC(!1)},this.renderMenuWithItems=async(e,t,i,n,s,o,r,a,l)=>{const d=this.isFlightEnabled("mc-editor-enable-searchbar");return this.showMenu(e,0,0,void 0,!0,{supportedEntityTypes:void 0,onItemSelected:s,theme:o,style:r,styles:a,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:n,getLocalItems:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(d),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),enableExpandedECCSearchBar:d},i,!1,t)},this.showExistingMenu=async(e,t,i,n,s,o,r,a,l,d,c)=>{const u=this._menus.get(n);return!!u&&this.showMenu(e,t,i,n,s,Object.assign(Object.assign({},u),{shouldRemoveTextOnItemSelection:o,specifiedItemsToDisplay:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(u.enableExpandedECCSearchBar),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),onItemSelected:null!=a?a:u.onItemSelected,supportedEntityTypes:r||l?r:u.supportedEntityTypes,onSuggestionsUpdated:l?void 0:u.onSuggestionsUpdated}),d,c)},this.showMenu=async(e,t,i,n,s,o,r,a,l)=>{var d,c;if(this._menuCurrentlyOpen)return!1;const u=this._proofingDom.findParagraphNode(e);if((0,j.l)(u)){const e=this._paragraphTextExtractor.getParagraphText(u);if(void 0!==e){const h=e.substring(t,t+i),g=h.charAt(0)===n,p={start:t,length:i,prefix:void 0!==n&&g?n:""};return this.setMenuCurrentlyOpen(n,o,u,p,void 0,null!=r?r:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},s,o.shouldRemoveTextOnItemSelection,a,null===(d=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===d?void 0:d.source,l,h),(null===(c=this._calloutState.menuCurrentlyOpen)||void 0===c?void 0:c.specifiedItemsToDisplay)||(0,he.A)(this.getServices(),n,h,p,u,void 0),this.prepareAndRenderECC(u,h)}}return!1},this.showEntityPrediction=async(e,t,i,n,s,o)=>{var r,a;const l=null!==(a=null!==(r=this._menus.get(void 0))&&void 0!==r?r:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==a?a:this.getDefaultMenuInformation();return this.showMenu(e,t,0,void 0,!0,Object.assign(Object.assign({},l),{supportedEntityTypes:void 0,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:i,onItemSelected:(e,t)=>{n(e,t)},onOpen:void 0,onClose:()=>{null==s||s()}}),{menuType:"InlineSuggestionsEntityPredictionMenuType"},!1,o)},this.onSearchBoxQueryChange=(e,t)=>{this._searchBox.onSearchBoxQueryChange(e,t)},this.buildAppGptConfig=()=>{var e;const{appGptConfig:t}=null!==(e=this._hostSettings.serviceSettings)&&void 0!==e?e:{};if(null==t?void 0:t.enableAppGpt)return t},this.showFlag=async(e,t,i,n,o,a,l,d,c)=>{var u,h,p,m,f,v,_;if(!e.nodeId)return!1;this._oaResultStore.clearResults(),this._queryDetection.removeDetectedQuery();const y=null!==(h=null!==(u=this._menus.get(void 0))&&void 0!==u?u:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==h?h:this.getDefaultMenuInformation(),I=(0,ue.e)(e.typeId);if(void 0===I)return this._oaLogger.logDiagnostics("Unable to determine type of flag for critique type: "+e.typeId),!1;const C=this._proofingDom.findParagraphNode(e.nodeId);if((0,j.l)(C)){const u={start:e.start-C.element.offset,length:e.length,prefix:""},h=null!==(p=this._paragraphTextExtractor.getQueryString(C,u))&&void 0!==p?p:"";if(h){let p=!1;return this.setMenuCurrentlyOpen(void 0,Object.assign(Object.assign({},y),{supportedEntityTypes:e.supportedEntityTypes,specifiedItemsToDisplay:null!==(m=e.suggestionItems)&&void 0!==m?m:y.specifiedItemsToDisplay,shouldRemoveTextOnItemSelection:!1,onOpen:void 0,onClose:t=>{var n;t||null===(n=this._instrumentationProcessor)||void 0===n||n.process({critique:(0,oe.toJS)(e),eventId:$.xp.ClickNoAction}),i(void 0,p)},critiqueRange:u,onItemSelected:(n,s)=>{var o;null===(o=this._instrumentationProcessor)||void 0===o||o.process({critique:(0,oe.toJS)(e),eventId:$.xp.ChangeSuggOther}),t(e,n,s),i(!1,!1)},onFooterAction:async t=>{var d,u,h,m;let f;switch(t){case s._R.IgnoreOnce:f=$.xp.Ignore,null==n||n(e);break;case s._R.IgnoreAll:f=$.xp.IgnoreAll,null==o||o(e);break;case s._R.IgnoreRule:f=$.xp.DoNotCheckThisIssue,null==a||a(e);break;case s._R.OpenEditorPane:null===(u=null===(d=this._indicatorStore)||void 0===d?void 0:d.onOpenEditorPane)||void 0===u||u.call(d,r.k.ContextualCard),i(void 0,!1);break;case s._R.Options:null===(h=this._externalSettingsFeature)||void 0===h||h.openSettings(g.kY.dropdown);break;case s._R.Feedback:null==l||l(e);break;case s._R.Next:return p=!0,this.dismissECC(!1),void this.navigateWithDelay(c,1);case s._R.Previous:return p=!0,this.dismissECC(!1),void this.navigateWithDelay(c,-1)}f&&(null===(m=this._instrumentationProcessor)||void 0===m||m.process({critique:(0,oe.toJS)(e),eventId:f})),this.dismissECC(!1)},onSuggestionsUpdated:async(t,i,n,s,o,r,a,l,d,c,u,h,g)=>{let p=t;if(!e.suggestionItems&&y.onSuggestionsUpdated){if(p=await y.onSuggestionsUpdated(t,i,n,s,o,r,a,l,d,c,u,this.logWithMenuData,g),!p)return;e.supportedEntityTypes&&(p=p.filter((t=>{var i;return null===(i=e.supportedEntityTypes)||void 0===i?void 0:i.includes(t.entityType)})))}for(const t of p){e.groupTitle&&(t.groupTitle=e.groupTitle),e.groupSubtitle&&(t.groupSubtitle=e.groupSubtitle);for(const e of t.entities)e.isBestMatch=!1}return p},showMoreEntitiesConfig:this._searchBox.buildShowMoreEntitiesConfig(e,h,u,C),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen),e),appGptConfig:this.buildAppGptConfig(),expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(y.enableExpandedECCSearchBar)}),C,u,{x:0,y:3},{menuType:"InlineSuggestionsResultsFlagMenuType",flag:I,brandingMode:this._hostSettings.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("flag",!1,I!==s.z4.Topic,void 0!==c),critiqueSetSize:d?(0,X.v)(d).length:void 0,critiquePosition:null==d?void 0:d.currentIndex},I!==s.z4.File,!0,!1,null===(f=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===f?void 0:f.source,void 0,h),(null===(v=this._menuCurrentlyOpen)||void 0===v?void 0:v.specifiedItemsToDisplay)||(0,he.A)(this.getServices(),null===(_=this._menuCurrentlyOpen)||void 0===_?void 0:_.triggerCharacter,h,u,C,void 0),this.prepareAndRenderECC(C,h)}}return!1},this.onFooterAction=e=>{var t;(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.onFooterAction)?this._menuCurrentlyOpen.onFooterAction(e):this.runDefaultFooterActionIfAvailable(e)},this.onSuggestionsUpdated=async(e,t,i,n,s,o,r,a,l,d,c,u,h)=>{var g,p,m;if(this._menuCurrentlyOpen)return this._menuCurrentlyOpen.specifiedItemsToDisplay&&(e=await i(this._menuCurrentlyOpen.specifiedItemsToDisplay)),null!==(m=null===(p=(g=this._menuCurrentlyOpen).onSuggestionsUpdated)||void 0===p?void 0:p.call(g,e,t,i,n,s,o,r,a,l,d,c,this.logWithMenuData,h))&&void 0!==m?m:e;this._oaLogger.logDiagnostics("Received suggestions update with no menu open")},this.logWithMenuData=(e,t,i)=>{const n=this.getDefaultLogDataForMenu();n.push(...null!=i?i:[]),this._oaLogger.logActivity(e,t,n)},this.handleNudgeAccepted=e=>{const t=e.message.data.nudge,i={hasEntityResults:void 0!==t.entityResults,entityType:t.entityType};!e.message.data.fromUserAction&&this._menuCurrentlyOpen?(this._menuCurrentlyOpen.wasOpenedViaNudge=!0,this._menuCurrentlyOpen.wasOpenedViaNudgeInfo=i):this._nextMenuOpenIsViaNudge=i},this._handleTextTile=e=>{if(e.message.messageType===p.G.RemoveData){const t=e.message.data.tileId;if(this._menuCurrentlyOpen){const e=t===this._menuCurrentlyOpen.tileId,i=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);(e||!i&&!this._isClearingSearch)&&this.dismissECC(!1)}}},this.ciqSettingsChange=e=>{this._isCIQMentionsEnabled=e.message.isCIQMenuEnabled},this.hostModelRehydrateTilesFinished=()=>{var e;if(!(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.parentTileId)||void 0===this._menuCurrentlyOpen.parentTileOffset)return;if(this._featureFlagsReader.flags.disableECCMenuRecreationOnALReconnection)return;const t=this._proofingDom.findTileNode(this._menuCurrentlyOpen.parentTileId);if(!t)return;const i=this._menuCurrentlyOpen.parentTileOffset+this._menuCurrentlyOpen.queryRange.start;let n;if(t.children)for(const e of t.children)if(e.element&&e.element.offset<=i&&e.element.offset+e.element.span>=i){n=e;break}if(!n)return;this._menuCurrentlyOpen.tileId=n.id;const s=this._paragraphTextExtractor.getQueryString(n,this._menuCurrentlyOpen.queryRange,!0);void 0!==s&&(this._oaResultStore.updateLoadingStatus(!0),(0,he.A)(this.getServices(),this._menuCurrentlyOpen.triggerCharacter,s,this._menuCurrentlyOpen.queryRange,n,this._queryDetection.getCurrentScope()))},this.notifyMenuTriggeringMethod=e=>{this._calloutState.setTriggerMethod(e)},this._handleDelta=async e=>{var t,i,n,s,r,a,l,c,u,h,g,p,f,v,_,y,I,C,S,b,T;const E=e.message;if(E.sourceType===m.pf.TileNode)return;const{changeType:N,delta:x,tileId:w}=E,L="InlineSuggestionsResultsUserInitiatedMenuType"!==(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType);if((x.unit===J.OD.Sentence||x.unit===J.OD.Paragraph)&&(x.deltaType===J.WI.Add||x.deltaType===J.WI.Update)&&((null!==(n=null===(i=x.content)||void 0===i?void 0:i.length)&&void 0!==n?n:0)>1||0===(null===(s=x.content)||void 0===s?void 0:s.length))&&void 0===x.queryRange===(void 0===this._menuCurrentlyOpen||L))return;const D=!this._isClearingSearch;if(N!==m.Q0.Local){if(this._menuCurrentlyOpen){const e=null===(r=this._queryDetection.getCurrentQuery())||void 0===r?void 0:r.queryRange;if(e)this._menuCurrentlyOpen.queryRange=e,this._menuCurrentlyOpen.searchBoxGeneratedParagraphId||(null===(a=x.additionalData)||void 0===a?void 0:a.scopeInfo)||this.tryToUpdatePreloadedItems(x,w,!0);else{if(!D)return void(this._isClearingSearch=!1);this.dismissECC(!1)}}return}(null===(l=this._menuCurrentlyOpen)||void 0===l?void 0:l.shouldDismissOnTyping)&&this.dismissECC(!1);const F=this._proofingDom.findParagraphNode(w),A=null===(c=x.queryRange)||void 0===c?void 0:c.prefix;if(x.queryRange){if(!this._isCIQMentionsEnabled&&!1!==this._hostSettings.isHidingCIQMenuSupported){if((null!==(u=x.queryRange.prefix)&&void 0!==u?u:"@")===(null!==(h=this._hostSettings.ciqTriggeringChar)&&void 0!==h?h:"/"))return}const e=!this._menuCurrentlyOpen,t=!F&&(null===(g=this._menuCurrentlyOpen)||void 0===g?void 0:g.searchBoxGeneratedParagraphId)?x.content:this._paragraphTextExtractor.getQueryString(F,x.queryRange);if(this._menuCurrentlyOpen){if(void 0===t)return void this.dismissECC(!1);this._menuCurrentlyOpen.queryRange=x.queryRange,this._menuCurrentlyOpen.keyStrokes=this._menuCurrentlyOpen.keyStrokes+1,this.updateSpecifiedItemsToDisplay(w,t,!1),null===(f=(p=this._menuCurrentlyOpen).onQueryUpdated)||void 0===f||f.call(p,t),this._oaLogger.logActivity(o.WT,void 0,[...this.getDefaultLogDataForMenu()])}else if((0,j.l)(F)&&void 0!==t){const e=this._menus.get(A),i=this._hostSettings.eccTargetOffset;if(e){if((e.enableExpandedECC||(null===(_=null===(v=this._hostSettings.oaSettings)||void 0===v?void 0:v.scopesConfig)||void 0===_?void 0:_.enabled))&&x.additionalData){let t;(null===(y=this._nextMenuOpenIsViaNudge)||void 0===y?void 0:y.entityType)===d.c.File&&!this._nextMenuOpenIsViaNudge.hasEntityResults&&(null===(C=null===(I=this._hostSettings.serviceSettings)||void 0===I?void 0:I.nudge)||void 0===C?void 0:C.automaticallyScope)&&(t=d.c.File),e.enableExpandedECC&&(null===(S=this._hostSettings.oaSettings)||void 0===S?void 0:S.scopeToPeopleTabInExpandedECC)&&"@"===A&&(t=d.c.People),!e.enableExpandedECC&&(null===(b=this._hostSettings.oaSettings)||void 0===b?void 0:b.scopeToAppGptInlineSuggestion)&&"@"===A&&(t=d.c.App),t&&(this._queryDetection.setCurrentScope({entityType:t},!1),x.additionalData.scopeInfo={entityType:t})}this.setMenuCurrentlyOpen(A,Object.assign(Object.assign({},e),{expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(e.enableExpandedECCSearchBar),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig()}),F,x.queryRange,i,{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",brandingMode:e.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},!1,!0,!1,null===(T=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===T?void 0:T.source,void 0,t),1!==x.queryRange.length&&this._calloutState.menuCurrentlyOpen&&(this._calloutState.menuCurrentlyOpen.keyStrokes=this._calloutState.menuCurrentlyOpen.keyStrokes+1),this.prepareAndRenderECC(F,t),this._oaLogger.logActivity(o.WT,void 0,[...this.getDefaultLogDataForMenu()])}}this.tryToUpdatePreloadedItems(x,w,e)}else D&&this.dismissECC(!1)},this.updatePreloadedItemsDebounced=(0,Y.debounce)(this.updatePreloadedItems,200),this.handleEccUploadMenuEvent=e=>{this._menuCurrentlyOpen&&function(e,t,i){try{const n=i.detail,s=(0,ge.G)(t,e);e.oaLogger.logActivity(o.pp,n,[...s,(0,f.n)("eventType",i.type)])}catch(t){e.logger.error(506557473,`Failed to log uploadMenuEvent ${i.type}`,t)}}(this.getServices(),this._menuCurrentlyOpen,e)},this.handleKeyDown=e=>{(async e=>{var t,i,n,s;if(this._menuCurrentlyOpen){for(const t of[a.m.arrowDown,a.m.arrowUp,a.m.arrowLeft,a.m.arrowRight,a.m.enter,a.m.tab,a.m.end,a.m.home])if((l.x.isKey(e,t)||l.x.isKey(e,t,!0))&&this.handleExternalKeyboardEvents(t,e.altKey))return e.stopPropagation(),void e.preventDefault();if(!l.x.isKey(e,a.m.arrowLeft)&&!l.x.isKey(e,a.m.arrowRight)||await this.isKeyCursorOverParagraph(e)||(0,se.m)(e.target)){if(l.x.isKey(e,a.m.space)&&(null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange.length)===(null===(n=null===(i=this._queryDetection.getCurrentQuery())||void 0===i?void 0:i.queryRange.prefix)||void 0===n?void 0:n.length)&&this._oaLogger.logActivity(o.hf,void 0,[...this.getDefaultLogDataForMenu(),(0,f.n)("interaction",o.RK)]),l.x.isKey(e,a.m.delete)){const e=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,t=await this._tileContent.getTextSelection();(null==t?void 0:t.startPositionInParagraphNode)===e&&this.dismissECC(!1)}l.x.isKey(e,a.m.escape)&&((null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.enableCurrentQueryDismissalOnEscape)&&this._queryDetection.dismissCurrentQuery(!0,o.iL,o.hf,this.getDefaultLogDataForMenu()),this.dismissECC(!1),e.stopPropagation(),e.preventDefault())}else this.dismissECC(!1)}})(e).catch((e=>{this._logger.error(506803665,"handleKeyDown threw an exception",e)}))},this.getQueryRangeBoundingClientRect=async()=>{if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!(0,j.l)(e))return;const t=await this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+this._menuCurrentlyOpen.queryRange.start,this._menuCurrentlyOpen.queryRange.length);return null==t?void 0:t.getBoundingClientRect()},this.dismissMenu=async()=>{this.dismissECC(!1)},this.onDismissed=async e=>{this.dismissECC(e)},this.dismissECC=e=>{var t,i;if(!this._menuCurrentlyOpen)return;this._queryDetection.resetNextDeltaProgramaticallyInserted(),!e&&this._searchBox.getIsSearchBarAvailable()&&this.removeComposingBoxQuery(),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const n=this._menuCurrentlyOpen;this._calloutState.updateCurrentMenu(void 0,void 0,void 0);const s=this._queryDetection.getPreviousQueryCorrelationKeys();this._oaLogger.logActivity(o.fL,void 0,[...(0,f.W)(["keyStrokeToSuccess",n.keyStrokes],["persistTime",n.openTime?Date.now()-n.openTime:0],["accepted",e]),...this.getDefaultLogDataForMenu(n)],s),this._searchBox.menuDismissed(n),null===(i=n.onClose)||void 0===i||i.call(n,e,n.openTime?Date.now()-n.openTime:0),this._queryDetection.removeDetectedQuery();const r=this.isAtTriggeringChar(n);e?this.setAriaStatus(r?"ebx_AtCIQMentionsClosedViaInsertionAriaLabel":"ebx_SlashCIQMentionsClosedViaInsertionAriaLabel"):this.setAriaStatus(r?"ebx_AtCIQMentionsClosedAriaLabel":"ebx_SlashCIQMentionsClosedAriaLabel")},this.renderECC=(e=!1)=>{if(!this._menuCurrentlyOpen)return;const t=()=>{var e;(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.onOpen)&&this._menuCurrentlyOpen.onOpen(this._menuCurrentlyOpen),this._menuCurrentlyOpen&&(this._menuCurrentlyOpen.wasOpenedViaNudge?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByNudgeAriaLabel":"ebx_SlashCIQMentionsOpenedByNudgeAriaLabel"):"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByUserTypingAriaLabel":"ebx_SlashCIQMentionsOpenedByUserTypingAriaLabel",this._menuCurrentlyOpen.queryRange.prefix):"InlineSuggestionsResultsFlagMenuType"===this._menuCurrentlyOpen.menuType.menuType&&this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByFlagAriaLabel":"ebx_SlashCIQMentionsOpenedByFlagAriaLabel"));const t=this._queryDetection.getCurrentQueryLogicalId();t&&this._oaMetric.addMeasure(t,"InlineSuggestionsCalloutDisplay")};this._calloutState.calculateTargetLocationAndShow().then((()=>{e&&t()})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to display callout: ${e}`)}))},this.onAction=e=>{var t,i,n,s,r,a,l;if(this._menuCurrentlyOpen){if(e===v.L.Retry)this.retryQuery();else{this._oaResultStore.clearResults(),(null===(t=this._calloutState.currentScope)||void 0===t?void 0:t.entityType)&&this.resetStateAndUpdateScope(void 0);const a=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!a)return void this._oaLogger.logDiagnostics("No parent found for clearing search");this._oaLogger.logActivity(o.rN,void 0,this.getDefaultLogDataForMenu());const l=null!==(n=null===(i=this._menuCurrentlyOpen.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1,d=this._menuCurrentlyOpen.menuType.menuType,c=this._menuCurrentlyOpen.queryRange.length;if("InlineSuggestionsResultsFlagMenuType"===d){if(c===l)return this._oaLogger.logDiagnostics("ECC query cleared with no query"),this.retryQuery(),void(null===(r=(s=this._menuCurrentlyOpen).onAction)||void 0===r||r.call(s,e));this.wrapInClearingSearch((()=>{var e,t;this._searchBox.initShowMoreEntitiesParagraph(null===(t=null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig)||void 0===t?void 0:t.entityType,!1,""),this._oaLogger.logActivity(o.N2,void 0,this.getDefaultLogDataForMenu())}))}else if(c!==l){const e=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,this._menuCurrentlyOpen.queryRange.start),t=this._menuCurrentlyOpen.queryRange.length-l;this.wrapInClearingSearch((()=>this._tileContent.remove(a,void 0,e+l,t)))}}null===(l=(a=this._menuCurrentlyOpen).onAction)||void 0===l||l.call(a,e)}this._hostEmitter.emit(h.pD.oaAnnotationsTriggered,{address:void 0,message:void 0})},this.onPreventDismissOnEvent=e=>{var t,i,n,s,o;if(!this._menuCurrentlyOpen)return!1;if(this._isClearingSearch)return!0;if("InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType){if(["click","mouseup"].includes(e.type))return!0;if("resize"===e.type&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableResizeDismissal))return!1;if("resize"===e.type)return this.getResizeThrottle()(),!0;if("scroll"===e.type||"wheel"===e.type)return this._hostSettings.useFluentV9?!!(null===(n=(i=e.target).closest)||void 0===n?void 0:n.call(i,".ms-ecc-callout")):(this.getScrollThrottle()(),!0)}return!!(null===(o=(s=this._menuCurrentlyOpen).onPreventDismissCalloutOnEvent)||void 0===o?void 0:o.call(s,e,this._menuCurrentlyOpen))||("focus"===e.type&&"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType||!(!this._calloutDismissalHandler||this._calloutDismissalHandler.shouldDismissCallout(e,"ECC",this._menuCurrentlyOpen)))},this.onRestoreFocus=(e,t)=>{var i;(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onRestoreFocus)?this._menuCurrentlyOpen.onRestoreFocus(e,t):t()},this.telemetryKeptCallback=(e,t)=>{const i=this._oaLogger;e&&setTimeout((()=>{e()&&this._hostSettings.enableKeptMetric&&i.logActivity(o.qS,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(t)])}),3e4)},this.onItemSelected=e=>{var t,i,n,r,a,l,c;if(!this._menuCurrentlyOpen)return;const u=e;if((null===(i=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===i?void 0:i.enabled)&&u.scopeInfo&&u.entityType===d.c.Scope)this.resetStateAndUpdateScope(u.scopeInfo);else if("feedback"!==u.key)if(u.entityType&&u.key){const e=u.entityType;this.resetStateAndUpdateScope(e?{entityType:e}:void 0)}else if(u.type!==d.c.Scope)try{u.wasOpenedViaNudge=this._menuCurrentlyOpen.wasOpenedViaNudge,u.wasOpenedViaNudgeAndHasEntityResults=null===(r=this._menuCurrentlyOpen.wasOpenedViaNudgeInfo)||void 0===r?void 0:r.hasEntityResults,this._oaLogger.logActivity(o.OE,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(u)]);const e=this._searchBox.getIsSearchBarAvailable(),t=null!==(a=this._menuCurrentlyOpen.critiqueRange)&&void 0!==a?a:this._menuCurrentlyOpen.queryRange,i=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,e?this._menuCurrentlyOpen.initialQueryStartPosition:t.start);e&&this._calloutState.searchBoxQueryString.length>0&&this._oaLogger.logActivity(o.Uj,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(u)]);const n=this._menuCurrentlyOpen.onItemSelected,s=e=>this.telemetryKeptCallback(e,u);if(this._menuCurrentlyOpen.shouldRemoveTextOnItemSelection){const o=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!o)return void this._oaLogger.logDiagnostics("No parent found for selecting ECC item.");let r=t.length;r=!e||void 0===this._searchBox.lastComposingBoxQuery&&this._calloutState.triggerMethod!==Z.P.AttachFile&&this._calloutState.triggerMethod!==Z.P.Fre?t.length:(null!==(c=null===(l=this._searchBox.lastComposingBoxQuery)||void 0===l?void 0:l.length)&&void 0!==c?c:0)+(t.prefix?t.prefix.length:1),this._tileContent.remove(o,void 0,i,r).then((e=>{n(u,e,o.element,s)})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to remove text range for ECC application: ${e}`)}))}else if(this._menuCurrentlyOpen.shouldCalculateRemovalRange){const e=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!e)return void this._oaLogger.logDiagnostics("No tile found for selecting ECC item.");this._tileContent.getRangeOfNode(e,void 0,i,t.length).then((t=>{t?n(u,t,e.element,s):this._oaLogger.logDiagnostics("Could not determine Range for the search query after selected ECC item.")})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to determine range for ECC application: ${e}`)}))}else n(u,void 0,void 0,s)}finally{this.dismissECC(!0)}else{const t=null===(n=e.scopeInfo)||void 0===n?void 0:n.entityType;this.resetStateAndUpdateScope(t?{entityType:t}:void 0)}else this.onFooterAction(s._R.Feedback)},this.removeComposingBoxQuery=e=>{this.wrapInClearingSearch((()=>this._searchBox.removeComposingBoxQuery(e)))},this.wrapInClearingSearch=e=>(this._isClearingSearch=!0,Promise.resolve(e()).then((()=>{this._isClearingSearch=!1}))),this.onFeedbackButtonClicked=()=>{var e,t,i,n,s,o;if(!(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.onFeedbackButtonClicked))return;const r=[];this._calloutState.suggestions.map((e=>{e.entities.map((e=>{r.push(e)}))}));const a={conversationId:null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.conversationId,logicalId:null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId,sessionId:null===(s=this._hostSettings.hostMetadata)||void 0===s?void 0:s.sessionId,query:this._calloutState.queryString,tab:null===(o=this._calloutState.currentScope)||void 0===o?void 0:o.entityType,entities:r};this._hostSettings.serviceSettings.ECCFeedbackSettings.onFeedbackButtonClicked(a)},this.isFlightEnabled=e=>(this._hostSettings.flightsToTrack||[]).includes(e),this.setPreloadedSuggestions=(e,t)=>{this._calloutState.setPreloadedSuggestions(this.convertNewSuggestions(e,void 0,t,void 0,!0,!0)),this.resultStatus=c.i.Success},this.handleExternalKeyboardEvents=(e,t)=>{if(!this._menuCurrentlyOpen)return!1;if(t&&!this._menuCurrentlyOpen.enableExpandedECC)return!1;const i=new Map([[a.m.arrowDown,xe.h.ArrowDown],[a.m.arrowUp,xe.h.ArrowUp],[a.m.arrowLeft,xe.h.ArrowLeft],[a.m.arrowRight,xe.h.ArrowRight],[a.m.home,xe.h.Home],[a.m.end,xe.h.End],[a.m.tab,xe.h.Tab],[a.m.enter,xe.h.Enter]]).get(e);return void 0!==i?(this.onUserInteraction(e),this._calloutState.keyboardHandlerTarget.onKeyPressed(i,t)):(this._oaLogger.logDiagnostics("[InlineSuggestionStore] unexpected keyboard event",{key:e}),!1)},this.onGroupSelected=e=>{var t,i,n,s;if(!(null===(i=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===i?void 0:i.enabled))return;const o=e.suggestions[0],r=null==o?void 0:o.entityType,a=e.isScoped;null===(s=null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onGroupSelected)||void 0===s||s.call(n,e);const l=!a&&r?{entityType:r,contentSources:o.GroupContentSources}:void 0;if(this.resetStateAndUpdateScope(l),!this._hostSettings.oaSettings.mockResults){const e={results:[],isLoading:!0,resultStatus:void 0,queryCorrelationKeys:this._queryCorrelationKeys?Object.assign(Object.assign({},this._queryCorrelationKeys),{scopeInfo:l}):void 0,nodeId:void 0,resultReset:!0};this._calloutState.clearQueryString(!0),this.updateState(e)}},this.onUserInteraction=e=>{const t=new Map([[a.m.arrowDown,o.rE],[a.m.arrowUp,o.cc],[a.m.enter,o.hk],[a.m.tab,o.g7],[void 0,o.l1]]).get(e);t&&this._oaLogger.logActivity(o.dm,void 0,[(0,f.n)("interaction",t)],this._queryCorrelationKeys)},this.getCurrentQueryString=()=>{var e;const t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,i=this._queryDetection.getCurrentQueryTileId(),n=t&&i&&this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(i),t)||"";return this._calloutState.searchBoxQueryString||n},this.onFirstRender=()=>{var e,t,i,n,s,r;this._oaLogger.logActivity(o.s1,void 0,(0,f.W)(["numOfSonoraSuggestionsDisplayed",this._calloutState.suggestions.length],["numOfSonoraFileSuggestionsDisplayed",this._fileCount],["triggerCharacter",null!==(t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange.prefix)&&void 0!==t?t:"@"],["isUserInsertion",null===(n=null===(i=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===i?void 0:i.isUserInsertion)||void 0===n||n],["source",null!==(r=null===(s=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===s?void 0:s.source)&&void 0!==r?r:""],[o.JZ,!!this._hostSettings.enableKeptMetric],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===this._calloutState.menuType.menuType],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")])),this.handleOAMetric("InlineSuggestionRendered","add")},this.onProcessedResults=()=>{this.handleOAMetric("InlineSuggestionProcessedResults","add")},this.onRenderResults=()=>{this.handleOAMetric("InlineSuggestionResultsRendered","commit")},this.updateState=e=>{var t,i;e.results.length<1&&!(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.specifiedItemsToDisplay)&&!(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onSuggestionsUpdated)?this.updateInternalState(e,[]):(this._messageExtensionAppDataProvider?this._messageExtensionAppDataProvider.getAppDefinitionIdMap():Promise.resolve(void 0)).then((t=>{var i;const n=this.getCurrentQueryString(),s=this.convertNewSuggestions(e.results,e.queryCorrelationKeys,e.nodeId,t,e.isLocalSuggestion);this.onSuggestionsUpdated(s,n,(i=>Promise.resolve(this.convertNewSuggestions(i,e.queryCorrelationKeys,e.nodeId,t,!0))),e.resultStatus,e.isLoading,this._queryDetection.getCurrentScope(),e.resultReset,e.latency,this._calloutState.menuType,null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.supportedEntityTypes,void 0,this.logWithMenuData,e.resultSummary).then((t=>{var i;t?((null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionUpdated"),this.updateInternalState(Object.assign(Object.assign({},e),{isLoading:!(e.isLoading&&t.length>0)&&e.isLoading,resultStatus:t.length>0?c.i.Success:e.results.length>0&&0===t.length?c.i.NoResults:e.resultStatus}),t,n)):this._calloutState.setQueryString(n)})).catch((e=>this._oaLogger.logDiagnostics(`Failed to convert suggestions: ${e}`)))})).catch((e=>this._oaLogger.logDiagnostics(`Failed to get ME app definitions: ${e}`)))},this.resetStateAndUpdateScope=e=>{var t;this.reset({scope:null==e?void 0:e.entityType,isLoading:!0,resultReset:!0,dueToScope:!0}),this._queryDetection.setCurrentScope(e);const i=this._proofingDom.findParagraphNode(this._queryDetection.getCurrentQueryTileId()||""),n=null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange;if(!i||!n)return;this._hostSettings.oaSettings&&!this._hostSettings.oaSettings.mockResults&&this._oaResultStore.updateLoadingStatus(!0),(0,he.w)(this.getServices(),n,i);const s=(0,W.q)(this._tileContent,i);if(!(null==s?void 0:s.ownerDocument.defaultView))return;const o=new _.J(s.ownerDocument.defaultView);o.addListener("focus",(e=>{e.stopPropagation(),o.removeAllListeners()}),{capture:!0,once:!0}),s.focus()},this.convertNewSuggestions=(e,t,i,n,s,o)=>{var r,a,l,c,u,h,g,p;if(e.length<1)return[];const m=[];for(const p of e){const e=[];for(const m of p.entities){const p=(this._hostSettings.flightsToTrack||[]).includes("mc-editor-enable-files-new-tidbits"),v=je(m,this.userProfilePictureCache,null===(r=this._hostSettings.userId)||void 0===r?void 0:r.userDisplayName,0===this._calloutState.queryString.length,this._localizer,null===(a=this._menuCurrentlyOpen)||void 0===a?void 0:a.newEntityTypes,n,p,null!==(c=null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.enableConnectorGroupHeadings)&&void 0!==c&&c);if(!v)continue;v.logicalId=null==t?void 0:t.logicalId,v.nodeId=i;const _=v.type;if(!o&&(f=_,Object.values(d.c).includes(f))&&(null===(u=this._menuCurrentlyOpen)||void 0===u?void 0:u.supportedEntityTypes)&&!this._menuCurrentlyOpen.supportedEntityTypes.includes(_))continue;const y=new Date,I=v.id?null===(g=null===(h=this._menuCurrentlyOpen)||void 0===h?void 0:h.newItemsById)||void 0===g?void 0:g.get(v.id):void 0;I&&y<I&&(v.isNew=!0),(s||e.length<this.getMaxEntityCount(_,this._queryDetection.getCurrentScope()))&&e.push(v)}m.push(Object.assign(Object.assign({},p),{entities:e}))}var f;return(null===(p=this._queryCorrelationKeys)||void 0===p?void 0:p.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionConvertedSuggestions"),m},this._calloutState=new Ne(this.getServices(),A,null!=K?K:new le,this),this._searchBox=new pe(this.getServices(),this._calloutState,this.wrapInClearingSearch),this._oaResultStore.setOnUpdate(this.updateState),this.reset(),this._throttleManager=new y._(null!==(te=this._targetWindowFactory())&&void 0!==te?te:new I.O(window))}get _menuCurrentlyOpen(){return this._calloutState.menuCurrentlyOpen}getResizeThrottle(){return this._resizeThrottle||(this._resizeThrottle=this._throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this._safeWindow,this.renderECC,25,"After")),this._resizeThrottle}getScrollThrottle(){var e;return this._scrollThrottle||(this._scrollThrottle=(0,C.hQ)(this._safeWindow,null!==(e=this._targetWindowFactory())&&void 0!==e?e:window,this.renderECC,"After")),this._scrollThrottle}getServices(){return{hostSettings:this._hostSettings,localizer:this._localizer,logger:this._logger,oaLogger:this._oaLogger,hostEmitter:this._hostEmitter,proofingDom:this._proofingDom,oaResultStore:this._oaResultStore,queryDetection:this._queryDetection,tileContent:this._tileContent,languageScriptDirectionDetector:this.languageScriptDirectionDetector,themeStore:this.themeStore,targetWindowFactory:this._targetWindowFactory,targetDocumentFactory:this._targetDocumentFactory}}getCurrentMenuInfo(){return this._menuCurrentlyOpen}getCalloutStateStore(){return this._calloutState}enableMenu(e){var t,i,n;const s=e.queryChar;if(this._menus.get(s))throw Error("This character is already being used for menu creation.");this._menus.set(s,Object.assign(Object.assign({},e),{shouldRemoveTextOnItemSelection:null===(t=e.shouldRemoveTextOnItemSelection)||void 0===t||t,browseThisComputerConfig:null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.browseThisComputerSettings,appGptConfig:null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.appGptConfig,enableExpandedECCSearchBar:e.enableExpandedECC&&void 0!==e.enableExpandedMenuSearchBar?e.enableExpandedMenuSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")})),this._queryDetection.registerQueryDetectionStartCharacter(s)}disableInlineSuggestionsMenu(e){if(!e)throw Error("You must specify a query character.");if(!this._menus.get(e))throw Error("This character is not being used for menu creation.");this._menus.delete(e),this._queryDetection.unregisterQueryDetectionStartCharacter(e),this._menuCurrentlyOpen&&this._menuCurrentlyOpen.queryRange.prefix===e&&this.dismissECC(!1)}getMenuInfo(e){return this._menus.get(e)}prepareAndRenderECC(e,t){var i,n;this._isFirstMenuUpdate=!0;const s=this._queryDetection.getCurrentQueryLogicalId();s&&this._oaMetric.addMeasure(s,"InlineSuggestionsRenderer"),this._calloutState.setQueryString(t),null===(i=this._menuEventListenersDisposal)||void 0===i||i.call(this);const o=this._calloutState.getCalloutState();return o&&(this._menuEventListenersDisposal=Ue(o,null!==(n=this._hostSettings.useFluentV9)&&void 0!==n&&n)),this.updateSpecifiedItemsToDisplay(e.id,t,!0),this.renderECC(!0),!0}navigateWithDelay(e,t){setTimeout((()=>{e(t)}),50)}getDefaultMenuInformation(){return{supportedEntityTypes:void 0,onItemSelected:()=>{},shouldRemoveTextOnItemSelection:!0,enableExpandedECCSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")}}async tryToUpdatePreloadedItems(e,t,i=!1){var n;if(!(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.getLocalItems))return void this._calloutState.clearPreloadedSuggestions();const s=this._proofingDom.findParagraphNode(t),o=e.queryRange&&this._paragraphTextExtractor.getQueryString(s,e.queryRange);if(void 0!==o){const n=await this._menuCurrentlyOpen.getLocalItems(o);i?await this.updatePreloadedItems(n,e,t):await this.updatePreloadedItemsDebounced(n,e,t)}}async updatePreloadedItems(e,t,i){var n;const s=null===(n=t.additionalData)||void 0===n?void 0:n.scopeInfo,o=new Set,r=new Set,a=new Set;for(const e of this._calloutState.preloadedSuggestions)for(const t of e.entities)t.entityId&&o.add(t.entityId),t.nodeId&&a.add(t.nodeId);for(const t of e)for(const e of t.entities)e.entityId&&r.add(e.entityId);const l=o.size===r.size&&[...o].every((e=>r.has(e))),d=a.has(i),c=0===e.length&&0!==this._calloutState.preloadedSuggestions.length;l&&d&&!c||s&&!e.some((e=>e.entityType===s.entityType))||this.setPreloadedSuggestions(e,i)}updateSpecifiedItemsToDisplay(e,t,i){var n;if(this._menuCurrentlyOpen){if(i){const e=this._menuCurrentlyOpen.getLocalItems?{isLoading:!1,resultReset:!1}:void 0;this.reset(e)}if(this._menuCurrentlyOpen.specifiedItemsToDisplay){const i=[];for(const e of this._menuCurrentlyOpen.specifiedItemsToDisplay){const n=e.entities.filter((e=>e.text.toLowerCase().includes(t.toLowerCase())));n.length>0&&i.push(Object.assign(Object.assign({},e),{entities:n}))}this._oaResultStore.updateResults(i,e,0===i.length?c.i.NoResults:c.i.Success,void 0,void 0,0===i.length?{NoResults:1}:{Success:1})}else(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.mockResults)||(i?this._oaResultStore.startNewECCMenu():this._oaResultStore.updateLoadingStatus(!0))}}getCurrentPositionInDocument(e,t){var i,n;const s=this._proofingDom.findParagraphNode(e);let o=null!==(n=null===(i=null==s?void 0:s.element)||void 0===i?void 0:i.offset)&&void 0!==n?n:0;return o+=t,o}get menuParentElement(){return this._menuCurrentlyOpen?(0,W.q)(this._tileContent,this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId)):void 0}async isKeyCursorOverParagraph(e){var t;if(!this._menuCurrentlyOpen)return!1;const i=this._menuCurrentlyOpen.queryRange.start,n=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,s=await this._tileContent.getTextSelection();return void 0!==(null==s?void 0:s.startPositionInParagraphNode)&&(null===(t=s.startParagraphNode)||void 0===t?void 0:t.id)===this._menuCurrentlyOpen.tileId&&i!==n&&(s.startPositionInParagraphNode>i&&s.startPositionInParagraphNode<n||(!(s.startPositionInParagraphNode!==i||i===n||!l.x.isKey(e,a.m.arrowRight))||!(s.startPositionInParagraphNode!==n||i===n||!l.x.isKey(e,a.m.arrowLeft))))}isAtTriggeringChar(e){return"@"===e.queryRange.prefix}getTileNode(e){const t=this._proofingDom.findParagraphNode(e);return null==t?void 0:t.parent}clearPreloadedSuggestions(){this._calloutState.clearPreloadedSuggestions()}retryQuery(){if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!e)return;const t=(0,B.F)(e);this._oaLogger.logActivity(o.hG,void 0,this.getDefaultLogDataForMenu()),this._hostEmitter.emit(h.pD.oaMenuControlSignal,{address:void 0,message:{mode:u.O.UserInitiated,retry:!0,documentModel:null==t?void 0:t.documentModel}})}getDefaultLogDataForMenu(e){const t=null!=e?e:this._menuCurrentlyOpen;return t?(0,ge.G)(t,this.getServices()):[]}setAriaStatus(e,t){var i,n;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(n=null===(i=this._ariaStatusStateStoreFactory)||void 0===i?void 0:i.call(this))||void 0===n||n.setStatus(this._localizer.getMessage(e,t),"assertive",!1))}getLogDataForSuggestion(e){var t,i;return e.entityType===d.c.File?(0,f.W)(["selectedType",e.entityType],["fileType",null!==(t=e.FileExtension)&&void 0!==t?t:"Unknown"],["fileSource",e.FileSourceType]):e.entityType===d.c.Loop?(0,f.W)(["selectedType",e.entityType],["loopType",null!==(i=e.id)&&void 0!==i?i:"Unknown"]):[(0,f.n)("selectedType",e.entityType)]}setMenuCurrentlyOpen(e,t,i,n,s,o,r=!1,a=!0,l=!1,d,c,u){var h;const g=Object.assign(Object.assign({triggerCharacter:e},t),{onFooterAction:e=>{var i;this.runDefaultFooterActionIfAvailable(e)||null===(i=t.onFooterAction)||void 0===i||i.call(t,e),this.dismissECC(!1)},targetLocation:{x:0,y:0},targetOffset:s,tileId:i.id,parentTileId:i.parent.id,parentTileOffset:i.element.offset,wasOpenedInBlankTile:i.parent.plainText.length<=(null!=e?e:"@").length,parentTileType:null===(h=i.parent.textFormattingInfo)||void 0===h?void 0:h.tileType,shouldDismissOnTyping:r,shouldCalculateRemovalRange:a,menuType:o,openTime:Date.now(),queryRange:n,initialQueryStartPosition:n.start,close:()=>{this.dismissECC(!1)},getQuery:()=>{if(this._menuCurrentlyOpen){const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);return this._paragraphTextExtractor.getQueryString(e,this._menuCurrentlyOpen.queryRange)}},onQueryUpdated:void 0,wasOpenedViaNudge:!!this._nextMenuOpenIsViaNudge,wasOpenedViaNudgeInfo:this._nextMenuOpenIsViaNudge,keyStrokes:0,wasOpenedViaAutomaticAtMention:l,invocationSource:d});this._nextMenuOpenIsViaNudge=void 0,this._calloutState.updateCurrentMenu(g,c,u)}runDefaultFooterActionIfAvailable(e){var t,i,n,o,a,l,d;if(e===s._R.OpenEditorPane)null===(i=null===(t=this._indicatorStore)||void 0===t?void 0:t.onOpenEditorPane)||void 0===i||i.call(t,r.k.ContextualCard);else if(e===s._R.Options)null===(n=this._externalSettingsFeature)||void 0===n||n.openSettings(g.kY.dropdown);else{if(e!==s._R.Feedback)return!1;null===(a=null===(o=this.feedbackStoreFactory)||void 0===o?void 0:o.call(this))||void 0===a||a.feedbackIconClicked("",null!==(d=null===(l=this._menuCurrentlyOpen)||void 0===l?void 0:l.triggerCharacter)&&void 0!==d?d:"Unknown menu type")}return!0}buildInlineSuggestionsResultsMenuActions(e,t,i,n){var o;const r=[];switch(this._hostSettings.isFeedbackEnabledForEcc&&r.push(s._R.Feedback),this._hostSettings.showOptionsButton&&r.push(s._R.Options),e){case"flag":t&&r.push(s._R.ReadAloud),i&&r.push(s._R.IgnoreRule),this._hostSettings.ignoreAllEnabled&&r.push(s._R.IgnoreAll),this._hostSettings.ignoreOnceEnabled&&r.push(s._R.IgnoreOnce),this._paneOpenState&&(this._paneOpenState.isPaneOpen?n&&(r.push(s._R.Previous),r.push(s._R.Next)):r.push(s._R.OpenEditorPane));break;case"userInitiated":(null===(o=this._paneOpenState)||void 0===o?void 0:o.isPaneOpen)||r.push(s._R.OpenEditorPane)}return r}reset(e){var t,i,n,s;if(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResults)this.resetData(),this.mockAnnotations(null==e?void 0:e.scope);else if((null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.specifiedItemsToDisplay)||(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onSuggestionsUpdated)){this.resetData(e);const t=this.getNewCorrelationKeys(),i={results:[],isLoading:void 0!==(null==e?void 0:e.isLoading)?e.isLoading:this._calloutState.isLoading,resultStatus:this.resultStatus,queryCorrelationKeys:null!==(s=this._queryCorrelationKeys)&&void 0!==s?s:t,nodeId:void 0,resultReset:void 0===(null==e?void 0:e.resultReset)||e.resultReset};this._calloutState.clearQueryString(!(null==e?void 0:e.dueToScope)),this.updateState(i)}else this.resetData(e)}resetData(e){this._fileCount=0,this.resultStatus=void 0,this._calloutState.setExplicitLoadingState(void 0===(null==e?void 0:e.isLoading)||e.isLoading,void 0===(null==e?void 0:e.resultReset)||e.resultReset),this._queryCorrelationKeys=void 0}mockAnnotations(e){var t;switch(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResultState){case"Loading":this._calloutState.setIsLoading();break;case"NoResult":this._calloutState.setHasSuggestions([],!0,"");break;case"Error":this._calloutState.setHadUnexpectedError(),this.resultStatus=c.i.UnexpectedError;break;default:i.e(6008).then(i.bind(i,12393)).then((t=>{this._calloutState.setHasSuggestions(this.convertNewSuggestions(t.mockInlineSuggestions.filter((t=>!e||t.entityType===e)),void 0,void 0,void 0,!0),!0,this.getCurrentQueryString())}))}}handleOAMetric(e,t){const i=this._queryDetection.getCurrentQueryLogicalId();i&&this._queryCorrelationKeys&&("commit"===t?this._oaMetric.commitEntry:this._oaMetric.addMeasure).bind(this._oaMetric)(i,e)}getNewCorrelationKeys(){var e,t,i,n,s;const o=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,r=this._queryDetection.getCurrentQueryCorrelationKeys();if(!o||!r)return{logicalId:"",conversationId:"",isEmptyQuery:!0,queryLength:0};return Object.assign(Object.assign({},r),{isEmptyQuery:o.length===(null!==(i=null===(t=o.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1),isTimeout:!1,queryLength:o.length-(null!==(s=null===(n=o.prefix)||void 0===n?void 0:n.length)&&void 0!==s?s:1)})}_logResultStatus(e,t,i,n){const s=null!=i?i:this._guidGenerator.generate(),r=new Map([["QueryLength",this._calloutState.queryString.length.toString()]]),a=((e,t,i,n,s)=>Object.assign(Object.assign(Object.assign({Version:2,TraceId:e,LocalTime:(new Date).toISOString(),Status:t},n&&{ProviderName:n}),i&&{Latency:i}),s&&{RequestParams:s}))(s,c.i[e],t,n,r);this._oaLogger.logDiagnostics(o.vb,a)}updateInternalState(e,t,i){var s,r,a,l,u,h,g,p,m,v,_,y,I,C,S,b,T,E,N,x,w,L,D,F,A,R,q,P,O,k,z,M,j,W,B,U,H,V,G,Q,K,$,J,Z,Y,X,ee,te,ie,ne;if(!this._menuCurrentlyOpen)return;let se,oe=t;if(this._isFirstMenuUpdate&&(null===(r=null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.scopesConfig)||void 0===r?void 0:r.enabled)&&this._hostSettings.oaSettings.scopesConfig.enableAutomaticScoping){const e=t.filter((e=>e.intent&&e.intent>0)).sort(((e,t)=>{var i,n;return(null!==(i=t.intent)&&void 0!==i?i:0)-(null!==(n=e.intent)&&void 0!==n?n:0)}))[0];e&&(void 0===e.isScopingEnabled||e.isScopingEnabled)&&(null!==(a=e.intent)&&void 0!==a?a:0)>(null!==(l=this._hostSettings.oaSettings.scopesConfig.automaticScopingIntentCutoff)&&void 0!==l?l:.9)&&(this._queryDetection.setCurrentScope({entityType:e.entityType},!1),oe=t.filter((t=>t.entityType===e.entityType)))}if(this._isFirstMenuUpdate=!1,void 0!==i)se=i;else{const e=null===(u=this._queryDetection.getCurrentQuery())||void 0===u?void 0:u.queryRange,t=this._queryDetection.getCurrentQueryTileId();if(e&&t)if(this._searchBox.getIsSearchBarAvailable()&&void 0!==this._searchBox.lastComposingBoxQuery){const i=Object.assign(Object.assign({},e),{prefix:this._menuCurrentlyOpen.triggerCharacter,start:this._menuCurrentlyOpen.initialQueryStartPosition+(null!==(g=null===(h=this._menuCurrentlyOpen.triggerCharacter)||void 0===h?void 0:h.length)&&void 0!==g?g:1),length:this._searchBox.lastComposingBoxQuery.length});se=null!==(p=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),i))&&void 0!==p?p:""}else se=null!==(m=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),e))&&void 0!==m?m:"";else se=""}if(e.resultStatus===c.i.NoResults||e.resultStatus===c.i.Timeout||e.resultStatus===c.i.UnexpectedError)this._logResultStatus(e.resultStatus,e.latency);else if(e.resultStatus===c.i.Success){const t=this._guidGenerator.generate(),i=oe.reduce(((e,t)=>e.concat(t.entities)),[]).filter((e=>e.providerName)).reduce(((e,t)=>{var i;const n=t.providerName;return e[n]||(e[n]=[]),e[n].push({Type:t.entityType,ReferenceId:null!==(i=t.entityId)&&void 0!==i?i:""}),e}),{});for(const[n,s]of Object.entries(i))if(this._logResultStatus(e.resultStatus,e.latency,t,n),n!==o.CL){const i=Ae((null===(v=e.queryCorrelationKeys)||void 0===v?void 0:v.logicalId)||"",(null===(_=e.queryCorrelationKeys)||void 0===_?void 0:_.conversationId)||"",t,o.R7,n,s);this._oaLogger.logDiagnostics(o.AK,Object.assign({logicalId:(null===(y=e.queryCorrelationKeys)||void 0===y?void 0:y.logicalId)||""},i))}}const re=null===(I=this._queryDetection.getCurrentQuery())||void 0===I?void 0:I.queryRange;if(this._queryCorrelationKeys=Object.assign(Object.assign({},e.queryCorrelationKeys),{logicalId:null!==(S=null===(C=e.queryCorrelationKeys)||void 0===C?void 0:C.logicalId)&&void 0!==S?S:"",conversationId:null!==(T=null===(b=e.queryCorrelationKeys)||void 0===b?void 0:b.conversationId)&&void 0!==T?T:"",triggerCharacter:null!==(E=null==re?void 0:re.prefix)&&void 0!==E?E:"@",isEmptyQuery:!re||re.length===(null!==(x=null===(N=re.prefix)||void 0===N?void 0:N.length)&&void 0!==x?x:1),queryLength:re?re.length-(null!==(L=null===(w=re.prefix)||void 0===w?void 0:w.length)&&void 0!==L?L:1):0}),(null===(D=e.queryCorrelationKeys)||void 0===D?void 0:D.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionInternalStateUpdated"),this.resultStatus=e.resultStatus,!e.isLoading&&e.resultStatus!==c.i.UnexpectedError&&e.resultStatus!==c.i.Cancelled&&this.defaultInlineSuggestionItems)for(const e of this.defaultInlineSuggestionItems)for(const t of e(se,this._calloutState.menuType,this._menuCurrentlyOpen.triggerCharacter,this._menuCurrentlyOpen.supportedEntityTypes,this._queryCorrelationKeys.scopeInfo))oe.push(t),this.resultStatus=c.i.Success;if(this._fileCount=oe.filter((e=>e.entityType===d.c.File)).length||0,0!==oe.length||!e.isLoading){const t=oe.reduce(((e,t)=>(e[t.entityType]=t.entities.length,e.total+=e[t.entityType],e)),{total:0}),{total:i}=t,s=(0,n.__rest)(t,["total"]);this._oaLogger.logActivity(o.OY,void 0,(0,f.W)(["numOfSonoraSuggestionsDisplayed",i],["numOfSuggestionsDisplayed",JSON.stringify(s)],["status",null!==(F=e.resultStatus)&&void 0!==F?F:-1],["responseCancelled",null!==(R=null===(A=e.resultSummary)||void 0===A?void 0:A.Cancelled)&&void 0!==R?R:0],["responseEarlyExit",null!==(P=null===(q=e.resultSummary)||void 0===q?void 0:q.EarlyExit)&&void 0!==P?P:0],["responseNoResults",null!==(k=null===(O=e.resultSummary)||void 0===O?void 0:O.NoResults)&&void 0!==k?k:0],["responseSuccess",null!==(M=null===(z=e.resultSummary)||void 0===z?void 0:z.Success)&&void 0!==M?M:0],["responseTimeout",null!==(W=null===(j=e.resultSummary)||void 0===j?void 0:j.Timeout)&&void 0!==W?W:0],["responseUnexpectedError",null!==(U=null===(B=e.resultSummary)||void 0===B?void 0:B.UnexpectedError)&&void 0!==U?U:0],["isError",this._calloutState.isError],["latency",null!==(H=e.latency)&&void 0!==H?H:-1],["triggeringChar",null!==(V=this._queryCorrelationKeys.triggerCharacter)&&void 0!==V?V:"@"],["queryLength",this._calloutState.queryString.length],["scopeType",null!==(Q=null===(G=this._queryCorrelationKeys.scopeInfo)||void 0===G?void 0:G.entityType)&&void 0!==Q?Q:""],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],["hybrid",null!==(J=null===($=null===(K=this._hostSettings.serviceSettings)||void 0===K?void 0:K.hybridAugloop)||void 0===$?void 0:$.enabled)&&void 0!==J&&J]),this._queryCorrelationKeys);const r=(null===(Y=null===(Z=this._hostSettings.oaSettings)||void 0===Z?void 0:Z.scopesConfig)||void 0===Y?void 0:Y.enabled)?{HasClickableScopeHeader:!0}:void 0;this._oaLogger.logDiagnostics(o.Ss,((e,t,i)=>({LogicalId:e,Version:2,LocalTime:(0,Fe.k)(new Date),LayoutType:"Vertical",ResultsView:Re(t,i),PageNumber:0}))(null!==(ee=null===(X=e.queryCorrelationKeys)||void 0===X?void 0:X.logicalId)&&void 0!==ee?ee:"",this._calloutState.suggestions,r)),(null===(te=e.queryCorrelationKeys)||void 0===te?void 0:te.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionAppendedConvertedSuggestions")}e.resultStatus===c.i.UnexpectedError||e.resultStatus===c.i.Cancelled?this._calloutState.setHadUnexpectedError():e.isLoading?this._calloutState.setExplicitLoadingState(!0,null!==(ie=e.resultReset)&&void 0!==ie&&ie):(this._calloutState.setHasSuggestions(oe,null!==(ne=e.resultReset)&&void 0!==ne&&ne,se),this.fetchAndUpdateProfilePictureAndUpdateSuggestionsList(oe))}getMaxEntityCount(e,t){var i,n,s;const o=!!(null==t?void 0:t.entityType),r=o?null===(n=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.scopesConfig)||void 0===n?void 0:n.maxResults:(0,S.Z$)(null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.entitiesEnabled,e);return null!=r?r:o?5:3}async fetchAndUpdateProfilePictureAndUpdateSuggestionsList(e){const t=[];for(const i of e)t.push(...i.entities.filter((e=>e.entityType===d.c.People)));await Promise.all(t.map((async e=>{var t,i,n,s;(null===(t=this._queryCorrelationKeys)||void 0===t?void 0:t.logicalId)&&this._oaMetric.startEntry(this._queryCorrelationKeys.logicalId+e.Id,this._queryCorrelationKeys);const o=(0,ze.u)(e),r=await(null===(i=this.userProfilePictureCache)||void 0===i?void 0:i.fetchProfilePicture(o));e.imageUrl=r,r?(null===(s=this._queryCorrelationKeys)||void 0===s?void 0:s.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Success","ProfilePictureLoadingTime"):(null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Error","ProfilePictureLoadingTime")}))),this._calloutState.setHasSuggestions(this._calloutState.suggestions,!1,this._calloutState.queryString)}};He=(0,n.__decorate)([(0,ee._)(),(0,n.__param)(0,(0,te.W)(b.n)),(0,n.__param)(1,(0,te.W)(T.m)),(0,n.__param)(2,(0,te.W)(E.g)),(0,n.__param)(3,(0,te.W)(N.G)),(0,n.__param)(4,(0,te.W)(x.u)),(0,n.__param)(5,(0,te.W)(h.M5)),(0,n.__param)(6,(0,te.W)(U.w)),(0,n.__param)(7,(0,te.W)(H.b)),(0,n.__param)(8,(0,te.W)(V.d)),(0,n.__param)(9,(0,te.W)(K.C)),(0,n.__param)(10,(0,te.W)(w.J)),(0,n.__param)(11,(0,te.W)(L.H)),(0,n.__param)(12,(0,te.W)(D.c)),(0,n.__param)(13,(0,te.W)(F.o)),(0,n.__param)(14,(0,te.W)(A.j)),(0,n.__param)(15,(0,te.W)(R.aP)),(0,n.__param)(16,(0,te.W)(fe.j)),(0,n.__param)(17,(0,te.W)(q.cg)),(0,n.__param)(18,(0,te.W)(q.Ze)),(0,n.__param)(19,(0,ie.l)()),(0,n.__param)(19,(0,te.W)(P.F)),(0,n.__param)(20,(0,ie.l)()),(0,n.__param)(20,(0,te.W)(z.Th)),(0,n.__param)(21,(0,ie.l)()),(0,n.__param)(21,(0,te.W)(G.y)),(0,n.__param)(22,(0,ie.l)()),(0,n.__param)(22,(0,te.W)(M.J)),(0,n.__param)(23,(0,ie.l)()),(0,n.__param)(23,(0,te.W)(g.In)),(0,n.__param)(24,(0,ie.l)()),(0,n.__param)(24,(0,te.W)(O.f)),(0,n.__param)(25,(0,ie.l)()),(0,n.__param)(25,(0,te.W)(Q.g)),(0,n.__param)(26,(0,ie.l)()),(0,n.__param)(26,(0,te.W)(we.Z)),(0,n.__param)(27,(0,ie.l)()),(0,n.__param)(27,(0,ne.t)(me)),(0,n.__param)(28,(0,ie.l)()),(0,n.__param)(28,(0,te.W)(re.YQ)),(0,n.__param)(29,(0,ie.l)()),(0,n.__param)(29,(0,te.W)(_e.A)),(0,n.__param)(30,(0,ie.l)()),(0,n.__param)(30,(0,te.W)(ve.e)),(0,n.__param)(31,(0,ie.l)()),(0,n.__param)(31,(0,te.W)(k.n))],He)},1240:(e,t,i)=>{i.d(t,{g:()=>c});var n=i(79490),s=i(11804),o=i(52946),r=i(40315),a=i(29906),l=i(83010),d=i(27603);let c=class{constructor(e,t,i){this._hostSettings=e,this._oaLogger=t,this.targetDocumentFactory=i}async getTargetLocationOfECC(e,t){var i,n,s,o,r,a,l,d,c,u,h;const g=null===(n=null===(i=this.targetDocumentFactory)||void 0===i?void 0:i.call(this))||void 0===n?void 0:n.deref(),p=null==g?void 0:g.getElementById(null!==(r=null===(o=null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.enableECCForMobileDevice)||void 0===o?void 0:o.inputBoxId)&&void 0!==r?r:"m365chat-input-formTextBox"),m=null==p?void 0:p.getBoundingClientRect();if(!p||!m||0===m.top&&0===m.bottom&&0===m.left&&0===m.right&&0===m.height&&0===m.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;const f=null!==(d=null===(l=null===(a=this._hostSettings.oaSettings)||void 0===a?void 0:a.enableECCForMobileDevice)||void 0===l?void 0:l.mainAxisOverride)&&void 0!==d?d:0,v=null!==(h=null===(u=null===(c=this._hostSettings.oaSettings)||void 0===c?void 0:c.enableECCForMobileDevice)||void 0===u?void 0:u.crossAxisOverride)&&void 0!==h?h:0,_=new DOMRect(m.left-v,m.top-f,m.width,m.height);return function(e,t,i){const n=null==t?void 0:t.defaultView;if(!n)return!1;const s={x:e.left+e.width/2,y:e.top+e.height/2};let o=t.elementFromPoint(s.x,s.y),r=!1;do{if(o===i){r=!0;break}o=null==o?void 0:o.parentNode}while(o);if(!r)return!1;return s.x<0||s.y<0||s.x>(n.innerWidth||t.documentElement.clientWidth)||s.y>(n.innerHeight||t.documentElement.clientHeight)}(_,g,p)?null:_}};c=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(s.n)),(0,n.__param)(1,(0,l.W)(o.m)),(0,n.__param)(2,(0,d.l)()),(0,n.__param)(2,(0,l.W)(r.Ze))],c)},86283:(e,t,i)=>{i.d(t,{d:()=>r});var n=i(79490),s=i(18309),o=i(29906);let r=class{getPluginCalloutMaxHeight(e,t,i){var n;const s=null!==(n=e.y)&&void 0!==n?n:e.top;if(s)return Math.max(t.innerHeight-s,s)-20}getCalloutDirection(e,t,i,n){return e?s.A.topRightEdge:s.A.topLeftEdge}};r=(0,n.__decorate)([(0,o._)()],r)},76787:(e,t,i)=>{i.d(t,{Z:()=>d});var n=i(79490),s=i(11804),o=i(52946),r=i(29906),a=i(83010);function l(e){return null==e}let d=class{constructor(e,t){this._hostSettings=e,this._oaLogger=t,this._appDefinitionIdMapCacheTTLInMilliseconds=6e4,this._appDefinitionIdMapCacheDisabled=!1,this.getAppDefinitionIdMap=async()=>{var e;if(null===(e=this._messageExtensionAppSuggestionSetting)||void 0===e?void 0:e.enabled)return!this._appDefinitionIdMapCacheDisabled&&this._appDefinitionIdMapLastNetwrokCallTime&&this._appDefinitionIdMapLastNetwrokCallTime+this._appDefinitionIdMapCacheTTLInMilliseconds>(new Date).getTime()?this._appDefinitionIdMap:(this.clearTimeout(),Promise.race([this.getAndAddAppDefinitionIdMapToCache(),this.getTimeoutPromise()]))},this.getAndAddAppDefinitionIdMapToCache=()=>new Promise((e=>this._getAppDefinitionIdMapCallback?this._getAppDefinitionIdMapCallback().then((t=>(this.clearTimeout(),this._appDefinitionIdMapCacheDisabled||(this._appDefinitionIdMap=t,this._appDefinitionIdMapLastNetwrokCallTime=(new Date).getTime()),e(t)))).catch((()=>(this.clearTimeout(),this._oaLogger.logDiagnostics("Failed to get appDefinitionIdMap from Host"),e(void 0)))):e(void 0))),this.getTimeoutPromise=(e=3e3)=>new Promise((t=>{this._timeoutId=setTimeout((()=>(this._oaLogger.logDiagnostics("getAppDefinitionIdMap:: request timeout"),t(void 0))),e)})),this.clearTimeout=()=>{this._timeoutId&&clearTimeout(this._timeoutId)},this.initialize()}initialize(){var e,t;this._messageExtensionAppSuggestionSetting=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.messageExtensionAppSuggestion,(null===(t=this._messageExtensionAppSuggestionSetting)||void 0===t?void 0:t.enabled)&&(this._getAppDefinitionIdMapCallback=this._messageExtensionAppSuggestionSetting.getAppDefinitionIdMapCallback,this._appDefinitionIdMapCacheDisabled=!l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)&&0===this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds,this._appDefinitionIdMapCacheTTLInMilliseconds=l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)?this._appDefinitionIdMapCacheTTLInMilliseconds:this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.n)),(0,n.__param)(1,(0,a.W)(o.m))],d)},67815:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(79490),s=i(11804),o=i(29906),r=i(83010);let a=class{constructor(e){this.hostSettings=e,this._profilePicturesUrlsCache={},this.fetchProfilePicture=async e=>{if(!e)return;if(this._profilePicturesUrlsCache[e])return this._profilePicturesUrlsCache[e];const t=await this.getProfilePictureUrl(e);return this._profilePicturesUrlsCache[e]=t,t},this.fetchCachedProfilePicture=e=>{if(e)return this._profilePicturesUrlsCache[e]},this.getDefaultProfilePictureUrl=e=>`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e}&default=none`}async getProfilePictureUrl(e){var t;if(null==e?void 0:e.includes("@")){if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.getProfilePictureUrl){return await this.hostSettings.oaSettings.getProfilePictureUrl(e)}return this.getDefaultProfilePictureUrl(e)}return""}};a=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.n))],a)},27543:(e,t,i)=>{if(i.d(t,{S:()=>s}),2063!=i.j)var n=i(16720);function s(e){if(e)return(0,n.L)(e)?e:"Cloud"}},32242:(e,t,i)=>{if(i.d(t,{A:()=>d,w:()=>l}),2063!=i.j)var n=i(91538);if(2063!=i.j)var s=i(69811);if(2063!=i.j)var o=i(76778);if(2063!=i.j)var r=i(71924);if(2063!=i.j)var a=i(99648);function l(e,t,i){const o=new n.s({deltaType:s.WI.Update,unit:s.OD.Chars,position:t.start,length:0,content:"",queryRange:t,additionalData:e.queryDetection.getCurrentQueryCorrelationKeys(),userInfo:{userType:s.HS.SessionUser}});c(e.hostEmitter,i,o)}function d(e,t,i,o,r,a,l){const d=e.queryDetection.setCurrentQueryRange(r.id,o,l,a,t);d&&(d.scopeInfo=a);const u=new n.s({deltaType:s.WI.Update,unit:s.OD.Chars,position:o.start,length:o.length,content:i,queryRange:o,additionalData:d,userInfo:{userType:s.HS.SessionUser}});c(e.hostEmitter,r,u)}function c(e,t,i){const n=(0,a.F)(t);e.emit(o.pD.hostModelDelta,{address:void 0,message:{tileId:t.id,tileVersion:t.eventSeqId||0,documentModel:null==n?void 0:n.documentModel,delta:i,sourceType:r.pf.ParagraphNode,changeType:r.Q0.Code,deletedOrReplacedCharacters:void 0}})}},92433:(e,t,i)=>{if(i.d(t,{J:()=>o}),2063!=i.j)var n=i(83915);const s=2063!=i.j?'[\\.\\:\\;\\,\\s-_\\(\\)\\/\\"\\u2018\\u2019\\u201c\\u201d\\xab\\xbb\\!\\?\\#\\&\\+\\\\<\\>\\@\\+\\=\\xa1\\xbf\\xaa\\xba]':null;function o(e,t,i,s){if(t){const o=e.map((e=>(0,n.S)(e))),l=(0,n.S)(t);return 1===e.length&&""===e[0]?[]:function(e,t,i,n){let s;t=t.toUpperCase();const o={};for(const i of e){if(!i)continue;const e=n(i.toUpperCase());for(;s=e.exec(t);)a(i,s,o)}const r=function(e,t){const i=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.push({offset:parseInt(n,10),word:e[n],propertyHit:t});return i.sort(((e,t)=>t.offset-e.offset))}(o,i);r.length&&function(e,t){let i=e[e.length-1].offset+e[e.length-1].word.length;for(let n=e.length-2;n>=0;n--){const s=e[n].offset+e[n].word.length-1;e[n].offset<i?s>i?e[n].offset<i&&(e[n].word=t.substring(i,e[n].offset+e[n].word.length),e[n].offset=i):e.splice(n,1):i=s}}(r,t);return r}(o,l,i,s||r)}return[]}function r(e){return new RegExp("(^|"+s+")"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"ig")}function a(e,t,i){var n;const s=(null===(n=t[1])||void 0===n?void 0:n.length)?t.index+t[1].length:t.index;(!i[s]||i[s].length<e.length)&&(i[s]=e)}},33900:(e,t,i)=>{if(i.d(t,{m:()=>l}),2063!=i.j)var n=i(47623);if(2063!=i.j)var s=i(94147);if(2063!=i.j)var o=i(72286);var r;!function(e){e[e.AuthorName=0]="AuthorName",e[e.EmailSenderName=1]="EmailSenderName",e[e.FallbackValue=2]="FallbackValue",e[e.LastModifiedByUser=3]="LastModifiedByUser",e[e.LastModifiedByContact=4]="LastModifiedByContact",e[e.LastAccessedByUser=5]="LastAccessedByUser",e[e.SentByUser=6]="SentByUser",e[e.DateCreatedByUser=7]="DateCreatedByUser",e[e.UserCreatedBy=8]="UserCreatedBy"}(r||(r={}));const a=e=>{if(!e)return"";const t=e.includes("Z")?e:`${e}Z`;return(0,o.Z)(new Date(t),new Date)},l=(e,t,i,o)=>{var l,d,c,u;const h=(0,s.$)().getStringsFor("FileTidbitStrings"),g=(e,...t)=>{let i=h(e);return t.filter(Boolean).forEach(((e,t)=>{i=i.replace(`{${t}}`,e)})),i},p=((e,t,i,s)=>{var o;const{Author:a,From:l,DateAccessed:d,DateCreated:c,DateModified:u,SharedDateTime:h,propertyHits:g,UserRelationshipType:p}=e;if(i&&s&&p!==n.b.Uploaded)return r.LastAccessedByUser;const m=(a||(null===(o=null==l?void 0:l.EmailAddress)||void 0===o?void 0:o.Name)||"").trim(),f=m===t;if(i){const e=(null==g?void 0:g.includes("EmailSenderName"))||(null==g?void 0:g.includes("EmailSenderAddress")),t=(null==g?void 0:g.includes("Author"))||(null==g?void 0:g.includes("AuthorEmail"));if(p===n.b.Uploaded)return t?r.UserCreatedBy:r.DateCreatedByUser;if(e)return f?r.SentByUser:r.EmailSenderName;if(t)return r.AuthorName;if(p===n.b.None&&(null==l?void 0:l.EmailAddress)&&h)return r.EmailSenderName;if(d){const e=d.includes("Z")?d:`${d}Z`,t=new Date(e),i=new Date;if(Math.floor((i.getTime()-t.getTime())/864e5)<10)return r.LastAccessedByUser;if((null==l?void 0:l.EmailAddress)&&h){const e=h.includes("Z")?h:`${h}Z`;if(new Date(e)>t)return f?r.SentByUser:r.EmailSenderName}return r.LastAccessedByUser}}return(null==l?void 0:l.EmailAddress)&&h?f?r.SentByUser:r.EmailSenderName:u&&m?f?r.LastModifiedByUser:r.LastModifiedByContact:f&&d?r.LastAccessedByUser:m&&c?r.AuthorName:r.FallbackValue})(e,t,i,o),m=e.Author||(null===(d=null===(l=e.From)||void 0===l?void 0:l.EmailAddress)||void 0===d?void 0:d.Name)||"",f=(null===(u=null===(c=e.From)||void 0===c?void 0:c.EmailAddress)||void 0===u?void 0:u.Name)||"";switch(p){case r.AuthorName:return g("userCreatedOnDate",m,a(e.DateCreated));case r.DateCreatedByUser:return g("youCreatedOnDate",a(e.DateCreated));case r.UserCreatedBy:return g("userCreatedBy",m);case r.LastAccessedByUser:return g("youOpenedOnDate",a(e.DateAccessed));case r.LastModifiedByUser:return g("youModifiedOnDate",a(e.DateModified));case r.LastModifiedByContact:return g("userModifiedOnDate",m,a(e.DateModified));case r.EmailSenderName:return g("userSentOnDate",f,a(e.SharedDateTime));case r.SentByUser:return g("youSentOnDate",a(e.SharedDateTime));case r.FallbackValue:return void 0!==e.SecondaryText?e.SecondaryText:g("weFoundThisFile")}}},83915:(e,t,i)=>{function n(e){if(null===o&&function(){o={};for(const e in r)o[e]=new RegExp("["+r[e]+"]","g")}(),e&&!function(e){null===s&&function(){let e="[";for(const t in r)e+=r[t];e+="]",s=new RegExp(e)}();const t=null==s?void 0:s.test(e.toLowerCase());return!t}(e))for(const t in o)e=e.replace(o[t],t);return e}i.d(t,{S:()=>n});let s=null,o=null;const r={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",2:"",3:"",:"",1:"",ae:"",th:"",ss:"",:"",oe:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",pts:"",tm:"",:"",4:"",5:"",6:"",7:"",8:"",9:"",10:"",11:"",12:"",13:"",14:"",15:"",16:"",17:"",18:"",19:"",20:"",0:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",21:"",22:"",23:"",24:"",25:"",26:"",27:"",28:"",29:"",30:"",31:"",32:"",33:"",34:"",35:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",36:"",37:"",38:"",39:"",40:"",41:"",42:"",43:"",44:"",45:"",46:"",47:"",48:"",49:"",50:"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"",hg:"",erg:"",ev:"",ltd:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","0":"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"",hpa:"",da:"",au:"",bar:"",ov:"",pc:"",dm:"",dm2:"",dm3:"",iu:"",:"",:"",:"",:"",:"",pa:"",na:"",a:"",ma:"",ka:"",kb:"",mb:"",gb:"",cal:"",kcal:"",pf:"",nf:"",f:"",g:"",mg:"",kg:"",hz:"",khz:"",mhz:"",ghz:"",thz:"",:"",m:"",d:"",k:"",fm:"",nm:"",m:"",mm:"",cm:"",km:"",mm2:"",cm2:"",m2:"",km2:"",mm3:"",cm3:"",m3:"",km3:"",ms:"",ms2:"",kpa:"",mpa:"",gpa:"",rad:"",rads:"",rads2:"",ps:"",ns:"",s:"",pv:"",nv:"",v:"",mv:"",kv:"",pw:"",nw:"",w:"",mw:"",kw:"",k:"",m:"",am:"",bq:"",cc:"",cd:"",ckg:"",co:"",db:"",gy:"",ha:"",hp:"",in:"",kk:"",kt:"",lm:"",ln:"",log:"",lx:"",mil:"",mol:"",ph:"",pm:"",ppm:"",pr:"",sr:"",sv:"",wb:"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""}},74368:(e,t,i)=>{if(i.d(t,{e:()=>o}),2063!=i.j)var n=i(79343);if(2063!=i.j)var s=i(13263);function o(e){switch(e){case n.L9.CIQFlag_PersonEntityRecognition:return s.z4.Person;case n.L9.CIQFlag_File:return s.z4.File;case n.L9.CIQFlag_LocalBusiness:case n.L9.CIQFlag_Location:case n.L9.CIQFlag_Time:return s.z4.Location;case n.L9.CIQFlag_Topic:return s.z4.Topic;case n.L9.CIQFlag_TaskRecognition:case n.L9.CIQFlag_SatoriEntityRecognition:case n.L9.CIQFlag_DateEntityRecognition:case n.L9.HeadingDetection:return s.z4.Location;default:return}}},31994:(e,t,i)=>{if(i.d(t,{G:()=>o}),2063!=i.j)var n=i(67069);if(2063!=i.j)var s=i(85924);function o(e,t){var i,o,r,a,l,d,c;const u=null!==(r=null!==(o=null===(i=t.queryDetection.getCurrentQuery())||void 0===i?void 0:i.queryRange.prefix)&&void 0!==o?o:e.triggerCharacter)&&void 0!==r?r:"@",h=t.queryDetection.getCurrentScope();return(0,s.W)(["scope",null!==(a=null==h?void 0:h.entityType)&&void 0!==a?a:""],["keyStrokes",e.keyStrokes],["isEmptyQuery",e.queryRange.length===u.length],["wasOpenedViaNudge",e.wasOpenedViaNudge],["triggerCharacter",u],["wasOpenedIsViaNudgeAndHasEntityResults",null!==(d=null===(l=e.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults)&&void 0!==d&&d],["wasOpenedViaAutomaticAtMention",e.wasOpenedViaAutomaticAtMention],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===e.menuType.menuType],["wasOpenedInBlankTile",e.wasOpenedInBlankTile],["parentTileType",null!==(c=e.parentTileType)&&void 0!==c?c:"unknown"],["menuType",e.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],[n.JZ,!!t.hostSettings.enableKeptMetric])}},21763:(e,t,i)=>{if(i.d(t,{X:()=>r}),2063!=i.j)var n=i(99614);if(2063!=i.j)var s=i(90512);if(2063!=i.j)var o=i(94147);function r(e,t){const i=(0,o.$)().getStringsFor("InlineSuggestionStrings");switch(e){case n.c.File:return i("fileEntityLabel");case n.c.People:return i("peopleEntityLabel");case n.c.Loop:return i("loopsEntityLabel");case n.c.Topic:return i("topicsEntityLabel");case n.c.External:return i("externalEntityLabel");case n.c.MessageExtensionApp:return i("appEntityLabel");case n.c.Scope:return i("scopeEntityLabel");case n.c.Event:return i("eventEntityLabel");case n.c.Channel:return i("channelEntityLabel");case n.c.Chat:return i("chatEntityLabel");case n.c.Team:return i("teamEntityLabel");case n.c.Message:return i("emailEntityLabel");case n.c.PIM:return t===s.Nm.Address?i("addressEntityLabel"):t===s.Nm.Membership?i("membershipEntityLabel"):i("phoneEntityLabel");default:return e}}},59726:(e,t,i)=>{if(i.d(t,{u:()=>s}),2063!=i.j)var n=i(19728);function s(e){return(0,n.isObservableArray)(e.EmailAddresses)||Array.isArray(e.EmailAddresses)?e.EmailAddresses[0]:e.EmailAddresses}},72286:(e,t,i)=>{if(i.d(t,{Z:()=>g}),2063!=i.j)var n=i(94147);const s=6e4,o=60*s,r=24*o,a=7,l=24,d=1,c=2,u=.8,h=-10*s;function g(e,t){const i=(0,n.$)().getStringsFor("DateTimeStrings"),g=(e,...t)=>{let n=i(e);return t.filter(Boolean).forEach(((e,t)=>{n=n.replace(`{${t}}`,e)})),n},p=t.getTime()-e.getTime();if(p<0)return p<=h?"":g("justNow");const m=Math.round(p/r),f=Math.round(p/o);if(m>a)return function(e,t){const i=(0,n.$)(),s=i.getStringsFor("MonthsNames"),o=[s("January"),s("February"),s("March"),s("April"),s("May"),s("June"),s("July"),s("August"),s("September"),s("October"),s("November"),s("December")][e.getMonth()],r=`${o} ${e.getDate().toString()}, ${e.getFullYear().toString()}`,a=`${o} ${e.getDate().toString()}`,l=t.getFullYear()===e.getFullYear()?a:r;return l}(e,t);if(f>=l)return m>1?g("daysAgo",m.toString()):g("oneDayAgo");if(f>=c)return f>1?g("hoursAgo",f.toString()):g("oneHourAgo");if(f>=u)return d>1?g("hoursAgo",d.toString()):g("oneHourAgo");const v=Math.round(p/s);return v<=c?g("justNow"):g("minutesAgo",v.toString())}},12393:(e,t,i)=>{i.r(t),i.d(t,{mockInlineSuggestions:()=>o});var n=i(99614),s=i(47623);const o=[{entities:[{entityType:n.c.People,Id:"0",text:"Annie Reid",EmailAddresses:["areid@microsoft.com"],confidence:0},{entityType:n.c.People,Id:"0",text:"Ed Taylor",EmailAddresses:["et@microsoft.com"],confidence:0},{entityType:n.c.People,Id:"0",text:"Clippy",EmailAddresses:["clippy@microsoft.com"],confidence:0}],entityType:n.c.People},{entities:[{entityType:n.c.File,Id:"0",FileSourceType:"Unknown",text:"Feature Spec",FileName:"Feature Spec",FileExtension:"Docx",FileSize:1e3,AccessUrl:"mockFile.gg/FeatureSpec",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"1",FileSourceType:"Unknown",text:"Planning Deck",FileName:"Planning Deck",FileExtension:"pptx",FileSize:1e3,AccessUrl:"mockFile.gg/PlanningDeck",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",isBestMatch:!0,confidence:0},{entityType:n.c.File,Id:"2",FileSourceType:"Unknown",text:"Crunched Numbers",FileName:"Crunched Numbers",FileExtension:"xls",FileSize:1e3,AccessUrl:"mockFile.gg/CrunchedNumbers",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"3",FileSourceType:"Unknown",text:"Some Contract with a very very long name",FileName:"Some Contract with a very very long name",FileExtension:"pdf",FileSize:1e3,AccessUrl:"mockFile.gg/contract",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"4",FileSourceType:"Unknown",text:"Even more files",FileName:"Even more files",FileExtension:"txt",FileSize:1e3,AccessUrl:"mockFile.gg/txt",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0}],entityType:n.c.File},{entities:[{ContentDomainName:"People",ScopeTitle:"Insert People",ScopeDescription:"Search people in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",entityType:n.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",text:"Insert People",scopeInfo:{entityType:"People",contentSource:""},confidence:0},{ContentDomainName:"Files",ScopeTitle:"Insert Files",ScopeDescription:"Search files in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",entityType:n.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",text:"Insert Files",scopeInfo:{entityType:"File",contentSource:""},confidence:0},{ItemId:"Ci7lEZX87y1MfPYPsAnbHw",Title:"FL Desktop 2.0",Url:"https://www.figma.com/file/Ci7lEZX87y1MfPYPsAnbHw",IconUrl:"https://figmaconnector.blob.core.windows.net/assets/icons/figma-logo.svg",ContentDomainId:"nonEssFigmaConnector",Authors:[],LastModifiedDateTimeUtc:"2022-04-26T03:57:42",CreatedTimeUtc:"2022-04-26T03:57:42",Text:"FL Desktop 2.0",PropertyHits:[],ReferenceId:"e60f6f30-9164-8d5e-7451-1da86e66df64.7000.22",entityType:n.c.External,Id:"Ci7lEZX87y1MfPYPsAnbHw",text:"FL Desktop 2.0",confidence:0}],entityType:n.c.Scope},{entities:[{entityType:n.c.Loop,Id:"0",text:"Action Items",icon:{iconName:"FFXCCompleted"},confidence:0},{entityType:n.c.Loop,Id:"0",text:"Bulleted List",icon:{iconName:"FFXCBulletedList"},confidence:0},{entityType:n.c.Loop,Id:"0",text:"Checklist",icon:{iconName:"FFXCChecklist"},confidence:0}],entityType:n.c.Loop},{entities:[{entityType:n.c.MessageExtensionApp,AppId:"ExcelOnline",DisplayName:"Excel",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.1",Id:"ExcelOnline",text:"Excel",confidence:0},{entityType:n.c.MessageExtensionApp,AppId:"f12466e6-a66c-495f-86f5-135938125391",DisplayName:"Azure DevOps (Internal)",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.2",Id:"f12466e6-a66c-495f-86f5-135938125391",text:"Azure DevOps (Internal)",confidence:0}],entityType:n.c.MessageExtensionApp},{entityType:n.c.Event,entities:[{entityType:n.c.Event,confidence:1,text:"Multiday meeting",EventId:{Id:"id1"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",HasRecording:!0,isBestMatch:!0},{entityType:n.c.Event,confidence:1,text:"Sameday meeting",EventId:{Id:"id2"},Start:"2023-05-12T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",isBestMatch:!0},{entityType:n.c.Event,confidence:1,text:"Multiday all day meeting",EventId:{Id:"id3"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",IsAllDay:!0}]},{entityType:n.c.Message,entities:[{entityType:n.c.Message,confidence:1,text:"Error while running Local IIS",Subject:"Error while running Local IIS",From:{EmailAddress:{Name:"John Doe"}},ItemId:{Id:"id1"}},{entityType:n.c.Message,confidence:1,text:"RE: Enable console logging question",Subject:"RE: Enable console logging question",From:{EmailAddress:{Name:"Jane Doe"}},ItemId:{Id:"id2"}}]},{entityType:n.c.Chat,entities:[{entityType:n.c.Chat,confidence:1,text:"Group Chat",Name:"Group Chat",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4,ChatMembers:[{Id:"1",ResultSource:s.F.Server,confidence:1,entityType:n.c.People,text:"John Doe"}]},{entityType:n.c.Chat,confidence:1,text:"Group Chat 2",Name:"Group Chat 2",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:5,ChatMembers:[{Id:"1",ResultSource:s.F.Server,confidence:1,entityType:n.c.People,text:"John Doe"},{Id:"2",ResultSource:s.F.Server,confidence:1,entityType:n.c.People,text:"Jane Doe"}]}]},{entityType:n.c.Channel,entities:[{entityType:n.c.Channel,confidence:1,text:"Developer Channel",Name:"Developer Channel",TeamName:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entityType:n.c.Team,entities:[{entityType:n.c.Team,confidence:1,text:"Editor-SDK",Name:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entities:[{entityType:n.c.App,id:"id",Title:"Sales meetings",text:"",subtitle:"Turned on last week",imageUrl:"https://vivasales.dynamics.com/outlookaddin/manifestimages/appLogoCopilotForSales_64px.png",confidence:0},{entityType:n.c.App,Title:"Bing",subtitle:"Available on Copilot",text:"Turned on last week",imageUrl:"https://content.powerapps.com/resource/powerbiwfe/images/PowerBI96x96.c2c49fdb8eb6008a98b3.png",confidence:0}],entityType:n.c.App}]},26946:(e,t,i)=>{function n(e){if(!e)return"";const t=e.lastIndexOf(".");return t>-1?e.substring(0,t):e}i.d(t,{u:()=>n})},67069:(e,t,i)=>{i.d(t,{AK:()=>b,CL:()=>E,JZ:()=>r,N2:()=>L,OE:()=>o,OY:()=>u,R7:()=>T,RK:()=>I,Ss:()=>C,Uj:()=>A,WT:()=>c,cc:()=>f,dm:()=>s,fL:()=>l,g7:()=>y,h8:()=>F,hG:()=>g,hf:()=>d,hk:()=>v,iI:()=>x,iL:()=>_,l1:()=>p,mj:()=>w,pp:()=>R,qS:()=>a,rE:()=>m,rN:()=>h,s1:()=>n,tb:()=>N,vb:()=>S,xe:()=>D});const n="OAPanelDisplayed",s="OAPanelUserInteraction",o="OAValueInserted",r="keptMetricEnabled",a="OAValueKept",l="OAPanelClosed",d="OACurrentQueryDismiss",c="OAPanelRequestUpdate",u="OAPanelUpdated",h="OAPanelClearQuery",g="OAPanelRetry",p="MouseEntering",m="DownArrow",f="UpArrow",v="Enter",_="Escape",y="Tab",I="Space",C="OAClientLayout",S="OAResponseReceived",b="OAClientDataSource",T="suggestions",E="GraphSearch",N="OAShowMoreEntitiesOpened",x="OAShowMoreEntitiesError",w="OAShowMoreEntitiesClosed",L="OAShowMoreEntitiesSearchCleared",D="OAShowMoreEntitiesSearchChanged",F="ExpandedEccSearchBarTextChaged",A="ExpandedEccSearchBarResultSelected",R="ExpandedEccUploadMenuEvent"},79535:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(76729).f)("IMultilingualFreStore")},75542:(e,t,i)=>{i.d(t,{V:()=>L,S:()=>D});var n=i(79490),s=i(59556),o=i(76778),r=i(85924),a=i(33511),l=i(18104),d=i(71924),c=i(81628),u=i(96571),h=i(11804),g=i(52946),p=i(21522),m=i(10219),f=i(90327),v=i(85339),_=i(68833),y=i(74261),I=i(94526),C=i(23943),S=i(754),b=i(15168);var T=i(69811),E=i(76729),N=i(29906),x=i(83010),w=i(27603);const L=(0,E.f)("INudgeStateStore");let D=class extends s.z{constructor(e,t,i,n,s,c,u,h,g,p,m,f,v){super(),this.localizer=e,this.hostSettings=t,this.hostEmitter=i,this.oaLogger=n,this.proofingDom=s,this.nudgeStore=c,this.tileContent=u,this._queryDetection=h,this.paragraphTextExtractor=g,this._ariaStatusStateStoreFactory=p,this._featureFlagsReader=m,this.inlineSuggestionsRenderer=f,this.predictionStore=v,this._nudgeDisplayTime=void 0,this._nudge=void 0,this._nudgeDisplayLocation=void 0,this._nudgeTargetDocumentRef=void 0,this.enableInlineNudge=!1,this.initialize=async()=>{var e,t;this.hostEmitter.on(o.pD.hostModelDelta,this.handleDelta),this.hostEmitter.on(o.pD.hostModelTextTile,this.handleTextTile),this.enableInlineNudge=!!(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.enableInlineNudge)},this.shutDown=()=>{},this.onNudgeUpdated=async()=>{var e,t,i,n,s,o,a,l,d,c,u,h,g,p,m;const f=this.nudgeStore.getCurrentNudge();if(f){if(this.oaLogger.logActivity("OANudgeReceived",void 0,[(0,r.n)("entityType",f.entityType.toString())],void 0),this.isNudgeDisabledForEntityType(null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge,f.entityType))return void await this.nudgeStore.clearNudge();if((null===(i=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===i?void 0:i.shouldRenderNudge)&&!this.hostSettings.serviceSettings.nudge.shouldRenderNudge(f))return void await this.nudgeStore.clearNudge();if(f.entityResults&&!(null===(s=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===s?void 0:s.entityNudgeClicked))return void await this.nudgeStore.clearNudge();if(f.entityResults&&(null===(l=null===(a=null===(o=this.inlineSuggestionsRenderer)||void 0===o?void 0:o.getCurrentMenuInfo())||void 0===a?void 0:a.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults))return void await this.nudgeStore.clearNudge();if(null===(d=this.predictionStore)||void 0===d?void 0:d.getCurrentPrediction())return void await this.nudgeStore.clearNudge();if(this._nudge&&this._nudge.text===f.text&&this._nudge.tileId===f.tileId&&this._nudge.entityType===f.entityType)return;const v=this.proofingDom.findParagraphNode(f.tileId);if(!(0,I.l)(v))return void await this.nudgeStore.clearNudge();const _=this.paragraphTextExtractor.getTextBetween(v,v,v.element.span-2,v.element.span);if(_&&""!==_){if(" :"===_)return void await this.onNudgeDismiss("space character precedes :");if(_.includes("@"))return void await this.onNudgeDismiss("@ character detected");if(_.includes("/"))return void await this.onNudgeDismiss("/ character detected")}const y=await this.tileContent.getNodeInsertionPosition(v.parent,v.element.offset+f.startIndex,!0);if(!y)return void await this.nudgeStore.clearNudge();if(!await this.isInputPointerAtNudge(f))return void await this.nudgeStore.clearNudge();const C=y.endContainer.parentElement;if(C&&this.containsInvalidNudgeSelector(C,null===(u=null===(c=this.hostSettings.serviceSettings)||void 0===c?void 0:c.nudge)||void 0===u?void 0:u.invalidNudgeSelectors))return void await this.nudgeStore.clearNudge();const S=y.getBoundingClientRect();this.updateNudge(f,null!==(h=null==C?void 0:C.ownerDocument)&&void 0!==h?h:document,S),this.oaLogger.logActivity("OANudgeDisplayed",void 0,[(0,r.n)("entityType",f.entityType.toString())],void 0),null===(m=null===(p=null===(g=this.hostSettings.serviceSettings)||void 0===g?void 0:g.nudge)||void 0===p?void 0:p.onNudgeDisplayed)||void 0===m||m.call(p,f),this.setAriaStatus("ebx_CIQNudgeDisplayed",f.text)}else this.clearNudge()},this.isInputPointerAtNudge=async e=>{var t;const i=await this.tileContent.getTextSelection();return!!i&&(i.startPosition===i.endPosition&&(null===(t=i.startParagraphNode)||void 0===t?void 0:t.id)===e.tileId&&i.endPositionInParagraphNode===e.startIndex)},this.updateNudge=(e,t,i)=>{this._nudge=e,this._nudgeTargetDocumentRef=new a.O(t),this._nudgeDisplayLocation=i,this._nudgeDisplayTime=Date.now(),this.publishStateChange()},this.clearNudge=()=>{this._nudge=void 0,this._nudgeTargetDocumentRef=void 0,this._nudgeDisplayLocation=void 0,this._nudgeDisplayTime=void 0,this.publishStateChange()},this.handleTextTile=e=>{if(this.nudge&&e.message.messageType===l.G.RemoveData){const t=e.message.data.tileId;this.nudge.tileId!==t&&this.proofingDom.findParagraphNode(this.nudge.tileId)||this.onNudgeDismiss("tile removed")}},this.handleDelta=async e=>{var t;const i=e.message;if(i.sourceType===d.pf.TileNode)return;if(!this.nudge)return;const n=await this.tileContent.getTextSelection();if(!this.nudge)return;let s;if((null==n?void 0:n.isCollapsed)&&n.startParagraphNode&&n.startParagraphNode.id===this.nudge.tileId&&n.startPositionInParagraphNode){if(s=await this.tileContent.getNodeInsertionPosition(n.startParentElement,n.startParagraphNode.element.offset+n.startPositionInParagraphNode,!0),!s)return this.oaLogger.logDiagnostics("Nudge text update: could not determine range for nudge insertion"),void await this.onNudgeDismiss("could not determine position");if(i.delta.deltaType===T.WI.Add&&(null===(t=i.delta.content)||void 0===t?void 0:t.includes(":"))&&" "===this.paragraphTextExtractor.getTextBetween(n.startParagraphNode,n.startParagraphNode,i.delta.position-1,i.delta.position))return void await this.onNudgeDismiss(": was proceeded with a space");const e=s.getBoundingClientRect();this._nudgeDisplayLocation&&(this._nudgeDisplayLocation=e,this.publishStateChange())}else(null==n?void 0:n.startParagraphNode)&&n.startPositionInParagraphNode?(n.isCollapsed||await this.onNudgeDismiss("Text range was selected"),0===n.startPositionInParagraphNode?await this.onNudgeDismiss("A new sentence was started"):await this.onNudgeDismiss("Text selection moved to another sentence")):await this.onNudgeDismiss("Unable to determine text selection")},this.nudgeStore.setOnUpdatedNudge(this.onNudgeUpdated)}get nudge(){return this._nudge}get nudgeDisplayLocation(){return this._nudgeDisplayLocation}get nudgeTargetDocumentRef(){return this._nudgeTargetDocumentRef}get insertionCharacter(){var e,t,i;return null!==(i=null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.insertionCharacter)&&void 0!==i?i:"@"}async onNudgeDismiss(e,t){var i,n,s;const o=this.nudgeStore.getCurrentNudge();if(!o)return;const a=this.proofingDom.findParagraphNode(o.tileId);if(!(0,I.l)(a))return void await this.nudgeStore.clearNudge();let l="";if(t){const e=this.paragraphTextExtractor.getTextBetween(a,a,a.element.span-2,a.element.span);l=": "===e?'user pasted text after ": "':(null==e?void 0:e.includes(":"))?'user pasted text after ":"':"user pasted text"}const d=Date.now()-this._nudgeDisplayTime;this.oaLogger.logActivity("OANudgeDismissed",void 0,(0,r.W)(["entityType",o.entityType.toString()],["dismissTrigger",t?l:e],["persistTime",d])),await this.nudgeStore.clearNudge(),null===(s=null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===n?void 0:n.onNudgeDismissed)||void 0===s||s.call(n,o,d,t?l:e)}async onNudgeAccepted(e,t){var i,n,s,a,d,u,h,g,p,m;const f=this.nudgeStore.getCurrentNudge();if(!f)return void this.oaLogger.logDiagnostics("Nudge click: could not find nudge in store");const v=Date.now()-this._nudgeDisplayTime;if(this.oaLogger.logActivity("OANudgeClicked",void 0,(0,r.W)(["entityType",f.entityType.toString()],["persistTime",v],["userAction",e])),null===(s=null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===n?void 0:n.onNudgeAccepted)||void 0===s||s.call(n,f,v,e,t),await this.nudgeStore.clearNudge(),t)if(null===(a=this.hostSettings.oaSettings)||void 0===a?void 0:a.isContextualCardEnabled){const e=this.proofingDom.findParagraphNode(f.tileId);if(!(0,I.l)(e))return void this.oaLogger.logDiagnostics("Nudge click: could not find paragraph node");const i=await this.tileContent.getTextSelection();let n;i||this.oaLogger.logDiagnostics("Nudge click: could not determine text selection");let s=0,r=!1;if((null==i?void 0:i.isCollapsed)&&i.startParagraphNode&&i.startParagraphNode.id===e.id&&i.startPositionInParagraphNode){const t=this.paragraphTextExtractor.getParagraphText(i.startParagraphNode);t&&!c.Yv(t.charCodeAt(i.startPositionInParagraphNode-1))&&(r=!0),s=e.element.offset+i.startPositionInParagraphNode,n=await this.tileContent.getNodeInsertionPosition(i.startParentElement,s,!0)}if(n||(s=e.element.offset+f.startIndex,n=await this.tileContent.getNodeInsertionPosition(e.parent,s,!0)),!n)return void this.oaLogger.logDiagnostics("Nudge click: could not determine range for nudge insertion");if(this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:f,fromUserAction:t},messageType:l.G.NewData},address:void 0}),f.entityResults){if(!(null===(u=null===(d=this.hostSettings.serviceSettings)||void 0===d?void 0:d.nudge)||void 0===u?void 0:u.entityNudgeClicked))return void this.oaLogger.logDiagnostics("Nudge click: entity nudge was clicked, but no callback was provided");if(f.entityResults.entities.length>1&&this.inlineSuggestionsRenderer){const t=[],i=f.entityResults.entities;t.push({entities:i,intent:f.entityResults.intent,entityType:f.entityResults.entityType});const n=s-e.element.offset,o=t=>{this.hostSettings.serviceSettings.nudge.entityNudgeClicked(t,e.parent.element,e.id,n)};await this.inlineSuggestionsRenderer.showExistingMenu(e.id,n,0,null!==(h=this.hostSettings.serviceSettings.nudge.insertionCharacter)&&void 0!==h?h:"@",!0,!1,void 0,o,t)}else this.hostSettings.serviceSettings.nudge.entityNudgeClicked(f.entityResults.entities[0],e.parent.element,e.id,s-e.element.offset)}else this._queryDetection.setNextDeltaProgramaticallyInserted("Nudge"),await this.tileContent.insert(e.parent,void 0,s,(r?" ":"")+(null!==(m=null===(p=null===(g=this.hostSettings.serviceSettings)||void 0===g?void 0:g.nudge)||void 0===p?void 0:p.insertionCharacter)&&void 0!==m?m:"@"),!0,n,!1)}else this.oaLogger.logDiagnostics("Nudge click: ECC was not enabled");else this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:f,fromUserAction:t},messageType:l.G.NewData},address:void 0})}isNudgeDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}containsInvalidNudgeSelector(e,t){var i;let n=!1;if(t)for(const s of t)(e.matches(s)||(null===(i=e.nextElementSibling)||void 0===i?void 0:i.matches(s)))&&(n=!0);return n}setAriaStatus(e,t){var i;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(i=this._ariaStatusStateStoreFactory())||void 0===i||i.setStatus(this.localizer.getMessage(e,t),"assertive",!1))}publishStateChange(){this.publishEvent("stateUpdated",{nudge:this._nudge,nudgeTargetDocumentRef:this._nudgeTargetDocumentRef,nudgeDisplayLocation:this._nudgeDisplayLocation})}};D=(0,n.__decorate)([(0,N._)(),(0,n.__param)(0,(0,x.W)(u.H)),(0,n.__param)(1,(0,x.W)(h.n)),(0,n.__param)(2,(0,x.W)(o.M5)),(0,n.__param)(3,(0,x.W)(g.m)),(0,n.__param)(4,(0,x.W)(C.w)),(0,n.__param)(5,(0,x.W)(_.Y)),(0,n.__param)(6,(0,x.W)(S.d)),(0,n.__param)(7,(0,x.W)(p.J)),(0,n.__param)(8,(0,x.W)(b.b)),(0,n.__param)(9,(0,x.W)(f.Th)),(0,n.__param)(10,(0,x.W)(m.c)),(0,n.__param)(11,(0,w.l)()),(0,n.__param)(11,(0,x.W)(v.V)),(0,n.__param)(12,(0,w.l)()),(0,n.__param)(12,(0,x.W)(y.o))],D)},82007:(e,t,i)=>{i.d(t,{R:()=>d});var n=i(8520),s=i(26598),o=i(30833),r=i(52041);if(2063!=i.j)var a=i(20299);const l=(0,s.F5)({safeWindow:o.A.on(r.j)}),d=e=>{const{safeWindow:t}=(0,s.KN)(l),{store:i}=e,o=i.anchor,r=n.useRef(!1),d=n.useRef(null),c=n.useRef(null),u=n.useRef({top:0,left:0}),h=n.useRef([]),[g,p]=n.useState({container:{display:"none"},overlay:{display:"none"},anchorStyle:{position:"static"}}),m=(0,a.uE)(o,g.overlay.paddingBottom),f=Object.assign({},g.overlay),v=()=>{const e=(0,a.dB)(o,c.current,u),t=(0,a.Cf)(o);u.current={top:e.top,left:e.left},p((()=>((()=>{const e=o.scrollLeft,t=o.scrollTop;d.current&&(d.current.scrollLeft=e,d.current.scrollTop=t)})(),{container:e,overlay:t.overlay,anchorStyle:t.anchor}))),i.setShadowElement(c.current,d.current)},_=()=>{var e;e=v,t.requestAnimationFrame((()=>{r.current||e()}))},y=()=>new Promise((e=>{_(),h.current.push(e)}));return n.useEffect((()=>(_(),i.setUpdateOverlay(y),()=>{r.current=!0})),[]),n.useEffect((()=>{for(const e of h.current)e();h.current=[]}),[g]),o.isConnected?n.createElement("div",{ref:c,style:g.container},n.createElement("div",{style:f,className:"hc-noadjust"},n.createElement("div",{style:m,ref:d},n.createElement("span",{"aria-hidden":"true"},o.value)))):null}},72737:(e,t,i)=>{i.d(t,{T:()=>h});var n=i(26598),s=i(30833),o=i(39593);if(2063!=i.j)var r=i(82007);var a=i(8520),l=i(94329),d=i(1116);const c=2063!=i.j?"\n  @media print {\n    .ms-editor-shadow-container {\n      display:none !important;\n    }\n  }\n  .ms-editor-shadow-container {\n    all: initial;\n  }":null,u=(0,n.F5)({store:s.A.on(o.S)}),h=()=>{const{store:e}=(0,n.KN)(u),[t,i]=a.useState(e.stores);return a.useEffect((()=>{const t=e=>{i(e.stores)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),a.createElement(a.Fragment,null,Array.from(t.values()).map((e=>{var t;return l.createPortal(a.createElement("editor-shadow",{style:{overflow:"auto"}},a.createElement(a.Fragment,null,a.createElement("style",null,c),a.createElement(d.Ay.div,{className:"ms-editor-shadow-container"},a.createElement(r.R,{store:e})))),null!==(t=e.anchor.parentElement)&&void 0!==t?t:window.document.body)})))}},71797:(e,t,i)=>{i.d(t,{F:()=>r});var n=i(79490),s=i(59556),o=i(29906);let r=class extends s.z{constructor(){super(...arguments),this.stores=new Map}setCanvasElement(e,t){this.stores.set(e,new a(t)),this.publishEvent("stateUpdated",{stores:this.stores})}getShadowElementStore(e){return this.stores.get(e)}removeShadowElementStore(e){this.stores.delete(e),this.publishEvent("stateUpdated",{stores:this.stores})}};r=(0,n.__decorate)([(0,o._)()],r);class a extends s.z{constructor(e){super(),this.anchor=e,this.container=void 0,this.overlay=void 0,this._updateOverlay=()=>new Promise((()=>{})),this.updateOverlay=async()=>{await this._updateOverlay()},this.setUpdateOverlay=e=>{this._updateOverlay=e,this.publishStateChange()},this.setShadowElement=(e,t)=>{this.container=e,this.overlay=t,this.publishStateChange()}}publishStateChange(){this.publishEvent("stateUpdated",{anchor:this.anchor,container:this.container,overlay:this.overlay})}}},9097:(e,t,i)=>{i.d(t,{PF:()=>d,Qr:()=>l});var n,s=i(79490),o=i(29906),r=i(76729),a=i(9178);!function(e){e[e.None=0]="None",e[e.Processed=1]="Processed",e[e.SquiggleInitialized=2]="SquiggleInitialized"}(n||(n={}));let l=class{constructor(){this._processedCritiques=new Map,this._invalidatedItems=new Map,this._keystrokesCount=0,this.items=new Map,this.setItem=(e,t)=>{this.items.set(e,t)},this.process=e=>!(!e||this._processedCritiques.has(e))&&(this._processedCritiques.set(e,{status:n.Processed,progress:0}),!0),this.setInitializationProgress=(e,t)=>{if(!e)return!1;const i=this._processedCritiques.get(e);return!(!i||i.status!==n.Processed&&i.status!==n.SquiggleInitialized)&&(this._processedCritiques.set(e,{status:n.SquiggleInitialized,progress:t}),!0)},this.getSquiggleInitializationProgress=e=>{if(!e)return 0;const t=this._processedCritiques.get(e);return(null==t?void 0:t.status)===n.SquiggleInitialized?t.progress:0},this.forEachCritiqueForItems=(e,t)=>{for(const i of e){const e=this.items.get(i);if(!e)return;for(const n of e){const s=n[0];t({squiggles:n[1],key:s,elementCritiques:e,elementId:i})}}},this.removeForCritique=(e,t,i=!1)=>{const n=this.items.get(e);if(!n)return;const s=n.get(t);return s?(i&&this._invalidatedItems.set(t,{squiggles:s,keystrokes:this._keystrokesCount}),n.delete(t),s):void 0},this.isEmpty=e=>void 0===this.items.get(e)&&0===this._invalidatedItems.size,this.checkInvalidatedAutoCorrections=e=>{if(0===this._invalidatedItems.size)return void(this._keystrokesCount=0);if(this._keystrokesCount+=1,!e)return;const t=[];for(const i of this._invalidatedItems.entries()){const n=i[1];this._keystrokesCount-n.keystrokes>a.tB&&t.push(i[0]),e(n.squiggles)&&t.push(i[0])}for(const e of t)this._invalidatedItems.delete(e)}}};l=(0,s.__decorate)([(0,o._)()],l);(0,r.f)("IContentEditableAutoCorrectionCache");const d=(0,r.f)("IFormElementAutoCorrectionCache")},90528:(e,t,i)=>{i.d(t,{QE:()=>C});var n=i(79490),s=i(8520),o=i(27241),r=i(26598),a=i(30833),l=i(40315);const d=(0,r.F5)({targetWindow:a.A.on(l.sh)}),c=e=>{const{targetWindow:t}=(0,r.KN)(d),{autoCorrectProps:i}=e,{critique:n,initializationProgress:a}=i,l=s.useRef(0),[c,u]=s.useState(1-a);return s.useEffect((()=>{const e=()=>{var e;0!==l.current&&(null===(e=t.deref())||void 0===e||e.clearInterval(l.current),l.current=0)},s=()=>{u((t=>t<.01?(e(),0):t-.02)),n.traceId&&i.setInitializationProgress(n.traceId,1-c)};return(()=>{if(c>0){e();const i=t.deref();i&&(l.current=i.setInterval(s,100))}})(),()=>{e()}}),[i,n.traceId,c,t]),s.createElement(o.u,Object.assign({},e,{squigglerId:i.id,squigglesProps:[i],opacity:c,isAutoCorrection:!0,ariaStatusUpdatesOnly:!1}))};var u=i(13533),h=i(67762),g=i(89882),p=i(88390),m=i(9178),f=i(29906),v=i(1159);const _=function(e){return t=>{var i,n;const{critique:o,data:r,element:a,squiggleKind:l,onCallOut:d,closeCallout:c,setInitializationProgress:u,showTooltip:g,closeTooltip:p}=t,f=h.Bn.AutoCorrectSquiggle,v=t.squiggleRef||s.useRef(null),_=null!==(i=a.ownerDocument.defaultView)&&void 0!==i?i:window,y=s.useRef(0),[I,C]=s.useState(1-t.initializationProgress),S=s.useCallback((()=>t.isCaretOver||t.isMouseOver||t.isCalloutOpened),[t.isCaretOver,t.isMouseOver,t.isCalloutOpened]),b=s.useCallback((()=>S()||void 0!==I&&I>0?"ms-squiggle ms-squiggle-autocorrect-hl ":"ms-squiggle ms-squiggle-autocorrect"),[I,S]),[T,E]=s.useState(b());s.useEffect((()=>{E(b())}),[b]);const N=t.useSvgUnderline?h.fQ[f]:0,x=s.useCallback((e=>{var t;d(v.current,o,null!==(t=o.textInContext)&&void 0!==t?t:"","keyboard"===e,(()=>{}),a,l,(0,m.eO)(r),N)}),[o,r,a,N,d,l,v]),w=s.useCallback((()=>{0!==y.current&&(C(void 0),E(b()),_.clearInterval(y.current),y.current=0)}),[b,_]),L=s.useCallback((()=>c(o.traceId)),[c,o.traceId]);s.useEffect((()=>{t.openCalloutOnHover?t.isMouseOver?x("mouse"):t.isCalloutOpened||c(o.traceId):(t.isMouseOver||t.isCaretOver)&&(w(),C(void 0),E(b()))}),[t.isMouseOver,t.isCalloutOpened,t.openCalloutOnHover,x,c,o.traceId,w,b,t.isCaretOver]);const D=t.isCaretOver&&!t.isCalloutOpened;s.useEffect((()=>{D?g(l,v.current,o,"keyboard"):p(o.traceId)}),[p,o,g,l,v,D]);const F=s.useCallback((()=>{C((e=>{let t;return!e||e<.01?(t=void 0,w()):t=e-.02,o.traceId&&u(o.traceId,1-(null!=t?t:0)),t}))}),[w,o.traceId,u]);if(s.useEffect((()=>(w(),y.current=_.setInterval(F,100),()=>{w(),c(o.traceId),p(o.traceId)})),[]),null===(n=t.autoCorrectionBroker)||void 0===n?void 0:n.getAutoCorrectionIsBeingApplied(t.critique))return null;const A=t.openCalloutOnHover?void 0:()=>x("mouse");return e(Object.assign(Object.assign({},t),{patternName:f,className:T,squiggleRef:v,opacity:I,openCalloutPredicate:e=>!e.shiftKey&&!e.altKey&&"Control"===e.key,onClick:A,onNonLeftClick:L,onKeyboardEvent:()=>x("keyboard"),onEscapePress:()=>t.closeTooltip(t.critique.traceId)}))}},y=s.memo(_(u.m),p.I),I=s.memo(_(g.G),p.P);let C=class{constructor(e,t){this.hostSettings=e,this.autoCorrectionBroker=t}getSquiggles(e,t,i,n){if((0,v.v4)(this.hostSettings))return s.createElement(s.Fragment,null,t.map(((e,t)=>s.createElement(c,{key:t.toString(),autoCorrectProps:e,theme:i,forcedHighContrast:n,hostSettings:this.hostSettings}))));{const r=(0,v.l9)(this.hostSettings)&&s.createElement(o.u,{squigglerId:e,squigglesProps:t,theme:i,forcedHighContrast:n,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!0});return s.createElement(s.Fragment,null,r,t.map(((e,t)=>s.createElement(y,Object.assign({key:t.toString()},e,{useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey,autoCorrectionBroker:this.autoCorrectionBroker})))))}}getFormInputSquiggle(e,t,i,n){return s.createElement(I,Object.assign({key:e},t,{initializationProgress:i,setInitializationProgress:n}))}};C=(0,n.__decorate)([(0,f._)()],C)},85326:(e,t,i)=>{i.d(t,{n:()=>L});var n=i(79490),s=i(79343),o=i(81628),r=i(95523),a=i(1527),l=i(76778),d=i(52041),c=i(10138),u=i(91984),h=i(30095),g=i(77247),p=i(93844),m=i(91322),f=i(3049),v=i(94526),_=i(754),y=i(23943),I=i(45311),C=i(22696),S=i(9097),b=i(9178),T=i(1159),E=i(29906),N=i(66008),x=i(83010),w=i(27603);let L=class{constructor(e,t,i,n,d,c,u,g,p,m,_,y,I){this._hostEmitters=e,this.tileContent=t,this.critiqueRangeBuilder=i,this.proofingDom=n,this.safeWindow=d,this._disableCritiqueHandler=c,this.logger=u,this.critiqueStore=g,this.applyCritiqueSuggestionHandler=p,this.applyFlagHandler=m,this.wordDictionary=_,this.editorSettingsManager=y,this._formElementAutoCorrectionCache=I,this.applyCritiqueSuggestion=async(e,t,i,n,r,a,l,d)=>{var c;await this.applySuggestion(e,t,{nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},(async()=>{var i,l,d,c;(null===(i=n.textInContext)||void 0===i?void 0:i.includes(""))&&(n.start+=(n.textInContext.match(new RegExp("^+"))||[""])[0].length,n.length-=(n.textInContext.match(//g)||[]).length,n.textInContext=n.textInContext.replace(//g,""),r.text=r.text.replace(//g,""));let u=!1;if(this.applyCritiqueSuggestionHandler&&this.critiqueRangeBuilder){const i=a||(null===(l=(await this.critiqueRangeBuilder.getCritiqueRanges([n],t))[0])||void 0===l?void 0:l.range);u=!!i&&!!this.applyCritiqueSuggestionHandler.onApplyCritiqueSuggestion(e,n,r,i)}const h=n.nodeId?this.proofingDom.findNode(n.nodeId):n.tileId?this.proofingDom.findNode(n.tileId.nodeId):null;if(h){if(!u){if(!(0,f.qB)(r)&&(0,f.ht)(n))this.tileContent.remove(h,t,n.start,n.length,!0,a);else{let{start:e,length:i}=n,l=r.text,d=a;if(n.textInContext&&n.typeId===s.L9.DoubleSpaceGrammar){const t=o.CC(n.textInContext,l),s=l.length-t.firstDiffRight;t.firstDiffLeft===s&&(e+=t.firstDiffLeft,i=1,l="",d=void 0)}this.tileContent.replace(h,t,e,i,l,d)}(0,f.MG)(n)&&(null===(c=this.wordDictionary)||void 0===c||c.addWordToIgnoreList(r.text))}}else null===(d=this.logger)||void 0===d||d.error(508146699,"Unable to find node while applying critique suggestion")})),!d||l!==b.Ah.autocorrection&&l!==b.Ah.personalizedAutocorrection||null===(c=this._formElementAutoCorrectionCache)||void 0===c||c.removeForCritique(d,n.traceId||"")},this.applyFlagSuggestion=(e,t,i,n,s,o)=>this.applySuggestion(e,t,{nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},(async()=>{var i,r,a;const l=o||!this.critiqueRangeBuilder?o:null===(i=(await this.critiqueRangeBuilder.getCritiqueRanges([n],t))[0])||void 0===i?void 0:i.range;l?this.applyFlagHandler?this.applyFlagHandler.onApplyFlag(e,n,s,l):null===(a=this.logger)||void 0===a||a.error(523633800,"Flag application failed due to no applyFlagHandler"):null===(r=this.logger)||void 0===r||r.error(523633799,"Unable to determine range for flag application")})),this.ignoreCritiqueOnce=(e,t,i,n)=>{var o;!!(null===(o=this.applyCritiqueSuggestionHandler)||void 0===o?void 0:o.onIgnoreCritiqueSuggestion(e,n))||this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},s.$w.IgnoreOnce)},this.ignoreFlagOnce=(e,t,i,n)=>{var o;!!(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreFlag(e,n))||this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},s.$w.IgnoreOnce)},this.ignoreAllOfFlag=(e,t,i)=>{var n,o;const r=this.proofingDom.findParagraphNode(i.nodeId);if(!(0,v.l)(r))return void(null===(n=this.logger)||void 0===n||n.error(507574144,"Unable to find paragraph node while ignoring all flags"));!!(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreAllOfFlag(e,i))||this.callbackOnProofedElement({nodeId:i.nodeId,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},s.$w.IgnoreAll)},this.ignoreAllOfCritique=(e,t,i,n)=>{var s,o,a,l;if(!i)return;let d;d=(0,f.MG)(n)?n.suggestions[0].text:n.textInContext,d&&(null===(s=this.wordDictionary)||void 0===s||s.addWordToIgnoreList(d));const c=this.proofingDom.findParagraphNode(null!==(o=n.nodeId)&&void 0!==o?o:i);(0,v.l)(c)&&(null===(a=this.critiqueStore)||void 0===a||a.updateNode([{critique:(0,r._K)(n),critiqueDiffType:h.K.Delete}],c.parent.id,null!==(l=c.eventSeqId)&&void 0!==l?l:0))},this.disableCritiqueType=async(e,t,i,n)=>{var o,r;i&&(n.typeId&&await(null===(o=this.editorSettingsManager)||void 0===o?void 0:o.stopCheckingForCritiqueType(n.typeId)),this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},s.$w.DisableCritiqueType),await(null===(r=this._disableCritiqueHandler)||void 0===r?void 0:r.disableCritique(n)))},this.disableFlagType=(e,t,i,n)=>{var o;!!(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onDisableFlag(e,n))||this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},s.$w.DisableCritiqueType)},this.applySuggestion=async(e,t,i,n)=>{var o,r,l,d;const c=null!==(o=this.tileContent.getContainingElement(e))&&void 0!==o?o:t;if(!c)return void(null===(r=this.logger)||void 0===r||r.error(508146698,"Unable to find containing element"));const u=(0,T.mH)(c),h=null!==(l=null==u?void 0:u.scrollTop)&&void 0!==l?l:0,g=null!==(d=null==u?void 0:u.scrollLeft)&&void 0!==d?d:0;await n(),this.callbackOnProofedElement(i,s.$w.ApplySuggestion);const p=(0,a.e)(c);this.safeWindow.requestAnimationFrame((()=>{u&&(u.scrollTop=h,u.scrollLeft=g)}),p)},this.callbackOnProofedElement=(e,t)=>{if(e.nodeId)for(const i of this._hostEmitters)i.emit(l.pD.hostModelCritiqueAction,{address:void 0,message:{critiqueInfo:e,actionType:t}})}}};L=(0,n.__decorate)([(0,E._)(),(0,n.__param)(0,(0,N.t)(l.zJ)),(0,n.__param)(1,(0,x.W)(_.d)),(0,n.__param)(2,(0,x.W)(g.s)),(0,n.__param)(2,(0,w.l)()),(0,n.__param)(3,(0,x.W)(y.w)),(0,n.__param)(4,(0,x.W)(d.j)),(0,n.__param)(5,(0,w.l)()),(0,n.__param)(5,(0,x.W)(I.W)),(0,n.__param)(6,(0,x.W)(c.g)),(0,n.__param)(6,(0,w.l)()),(0,n.__param)(7,(0,x.W)(h.$)),(0,n.__param)(7,(0,w.l)()),(0,n.__param)(8,(0,x.W)(p.a)),(0,n.__param)(8,(0,w.l)()),(0,n.__param)(9,(0,x.W)(m.K)),(0,n.__param)(9,(0,w.l)()),(0,n.__param)(10,(0,x.W)(C.s)),(0,n.__param)(10,(0,w.l)()),(0,n.__param)(11,(0,x.W)(u.rI)),(0,n.__param)(11,(0,w.l)()),(0,n.__param)(12,(0,w.l)()),(0,n.__param)(12,(0,x.W)(S.PF))],L)},28811:(e,t,i)=>{i.d(t,{FY:()=>I,hJ:()=>_});var n=i(79490),s=i(8520),o=i(27241),r=i(13290),a=i(79343),l=i(13533),d=i(94900),c=i(9178),u=i(67762),h=i(89882),g=i(88390),p=i(29906),m=i(1159);const f=function(e){return t=>{var i;const{critique:n,squiggleKind:o,closeCallout:l,showTooltip:d,closeTooltip:h,submitTelemetryEvent:g}=t,p=null!==(i=t.squiggleRef)&&void 0!==i?i:s.useRef(null),f=(0,u.H7)(n,!!t.isAutoCorrectionEnabled,c.Ah.critique),v=e=>{var i;const s=t.useSvgUnderline?u.fQ[f]:0;t.onCallOut(p.current,n,null!==(i=n.textInContext)&&void 0!==i?i:"","keyboard"===e,(()=>{}),t.element,c.Ah.critique,(0,c.eO)(t.data),s),y("keyboard"===e?"CritiqueCardShownViaKeyboardAction":"CritiqueCardShownViaLeftClickAction")},_=s.useCallback((()=>l(n.traceId)),[l,n]),y=e=>{null==g||g({telemetryLog:{logType:"Event",eventName:e,level:r.q.Info,data:{critiquePriority:n.priority,critiqueTypeId:n.typeIdRaw,critiqueTraceId:n.traceId,squiggleKind:o}}})},I=n.typeId?"ms-squiggle-"+function(e,t){const i=Object.keys(e).filter((i=>e[i]===t));return i.length>0?i[0]:null}(a.L9,n.typeId):void 0,C=`ms-squiggle ms-squiggle-${n.priority} ${I} ${t.isCalloutOpened||t.isHighlighted?"hl":""} ${t.stealth?"stealth":""}`,S=t.isMouseOver?"mouse":t.isCaretOver?"keyboard":void 0,b=S&&!t.isCalloutOpened;return s.useEffect((()=>{b?d(o,p.current,n,S):h(n.traceId)}),[n,b,p,S,d,o,h]),s.useEffect((()=>()=>{h(n.traceId)}),[h,n]),e(Object.assign(Object.assign({},t),{patternName:f,className:C,squiggleRef:p,openCalloutPredicate:e=>(0,m.iN)()||t.useAltHotkey?!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key:!e.shiftKey&&!e.ctrlKey&&e.altKey&&"ArrowDown"===e.key,onKeyboardEvent:()=>v("keyboard"),onClick:()=>v("mouse"),onContextMenuClick:()=>{h(n.traceId,!0)},closeCalloutOnNonLeftClick:_,onContextMenuKeyUpEvent:()=>{y("ContextMenuKeyUpEventOnSquiggle")},logRightClickEvent:()=>{y("RightClickOnSquiggle")},onEscapePress:()=>h(n.traceId)}))}};const v=s.memo(f(l.m),g.I),_=s.memo(f(d.z),g.I),y=s.memo(f(h.G),g.P);let I=class{constructor(e){this.hostSettings=e}getSquiggles(e,t,i,n){if((0,m.v4)(this.hostSettings))return s.createElement(o.u,{squigglerId:e,squigglesProps:t,theme:i,forcedHighContrast:n,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!1});{const r=(0,m.l9)(this.hostSettings)&&s.createElement(o.u,{squigglerId:e,squigglesProps:t,theme:i,forcedHighContrast:n,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!0});return s.createElement(s.Fragment,null,r,t.map((e=>s.createElement(v,Object.assign({key:e.id},e,{isAutoCorrectionEnabled:this.hostSettings.enableAutoCorrect,squiggleKind:c.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,i,n){return s.createElement(y,Object.assign({key:e},t,{squiggleKind:c.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey}))}};I=(0,n.__decorate)([(0,p._)()],I)},64299:(e,t,i)=>{i.d(t,{i:()=>n});const n=(0,i(76729).f)("ICritiqueApplicationHandler")},9178:(e,t,i)=>{i.d(t,{Ah:()=>s,eO:()=>o,kI:()=>r,tB:()=>n});const n=15;var s;function o(e){return function(e){return void 0!==e.range}(e)?e.range:void 0}function r(e){return e===s.autocorrection||e===s.personalizedAutocorrection}!function(e){e.autocorrection="autocorrection",e.critique="critique",e.personalizedAutocorrection="personalized-autocorrection"}(s||(s={}))},74504:(e,t,i)=>{i.d(t,{C:()=>s,Q:()=>o});var n=i(76729);const s=(0,n.f)("ISquigglerCanvasRenderingState"),o=(0,n.f)("ISquigglerCanvasRenderingStateFactory")},29291:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(76729).f)("ISquigglerUXFactory")},14260:(e,t,i)=>{i.d(t,{B:()=>d});var n=i(79490),s=i(29906),o=i(83010),r=i(70431),a=i(95834),l=i(74504);let d=class{constructor(e,t){this.proofingEventListener=e,this.container=t,this.messages=[],this.uxInitialized=!1,this.onCritiqueForUiEvent=e=>{if(this.uxInitialized){this.container.get(l.C).onCritiqueForUiEvent(e)}else this.messages.push(e)},this.onSquiggleUXReadyEvent=async e=>{const t=this.container.get(l.C);let i;for(;i=this.messages.shift();)await t.onCritiqueForUiEvent(i);this.uxInitialized=!0},this.onRecomputeSquigglesEvent=async e=>{if(!this.uxInitialized)return;this.container.get(l.C).updateSquiggleRanges()}}async initialize(){this.proofingEventListener.on("squiggleUXReadyEvent",this.onSquiggleUXReadyEvent),this.proofingEventListener.on("recomputeSquiggles",this.onRecomputeSquigglesEvent),this.proofingEventListener.on("squiggleDataEvent",this.onCritiqueForUiEvent)}shutDown(){}};d=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(a.o)),(0,n.__param)(1,(0,o.W)(r.p))],d)},88390:(e,t,i)=>{if(i.d(t,{I:()=>s,P:()=>o}),2063!=i.j)var n=i(95089);function s(e,t){const i=e.stealth===t.stealth,s=e.isHighlighted===t.isHighlighted,o=e.isCaretOver===t.isCaretOver,r=e.isMouseOver===t.isMouseOver,a=e.isCalloutOpened===t.isCalloutOpened,l=(0,n.a)(e.data.clientRect,t.data.clientRect);return o&&r&&a&&l&&s&&i}function o(e,t){const i=e.isHighlighted===t.isHighlighted,n=e.isCaretOver===t.isCaretOver,s=e.isMouseOver===t.isMouseOver,o=e.isCalloutOpened===t.isCalloutOpened,r=e.data.start===t.data.start,a=e.data.end===t.data.end,l=e.data.text===t.data.text,d=e.data.overlayCss.height===t.data.overlayCss.height,c=e.data.overlayCss.width===t.data.overlayCss.width;return o&&n&&a&&d&&c&&s&&r&&l&&i}},1159:(e,t,i)=>{function n(e){return!!e.enableCSSHighlightApiSquiggleRendering&&"highlights"in CSS}function s(e){return!!e.enableCSSHighlightApiSquiggleRendering&&"highlights"in CSS}function o(e){return null===e?null:e.scrollHeight>e.clientHeight?e:o(e.parentNode)}function r(){return/Macintosh|Mac OS X/i.test(navigator.userAgent)}i.d(t,{iN:()=>r,l9:()=>s,mH:()=>o,v4:()=>n})},27241:(e,t,i)=>{if(i.d(t,{u:()=>d}),2063!=i.j)var n=i(28811);if(2063!=i.j)var s=i(9178);if(2063!=i.j)var o=i(67762);if(2063!=i.j)var r=i(91622);if(2063!=i.j)var a=i(81703);var l=i(8520);const d=e=>{var t;const{squigglerId:i,squigglesProps:d,theme:u,forcedHighContrast:h,opacity:g,hostSettings:p,isAutoCorrection:m,ariaStatusUpdatesOnly:f}=e,v=CSS.highlights;if(!v)return null;for(const e in o.Bn){const t=o.Bn[e];m===(t===o.Bn.AutoCorrectSquiggle)&&(v.delete((0,r.Mf)(t,i,!1)),v.delete((0,r.Mf)(t,i,!0)))}const _=new Map,y=[];for(const e of d){const n=null!==(t=e.squiggleVerticalAdjustment)&&void 0!==t?t:0,s=(0,o.H7)(e.critique,!!p.enableAutoCorrect,e.squiggleKind),r=c(s,i,!1,_,e.data.range);e.isHighlighted&&c(s,i,e.isHighlighted,_,e.data.range),y.push({id:r,patternName:s,opacity:g,squiggleVerticalAdjustment:n})}for(const[e,t]of _)v.set(e,t);return f?l.createElement(l.Fragment,null):l.createElement(l.Fragment,null,d.map(((e,t)=>l.createElement(n.hJ,Object.assign({key:t.toString()},e,{squiggleKind:s.Ah.critique,useAltHotkey:!!p.useAlternativeSquiggleHotkey})))),l.createElement("style",null,"@media not print {\n        ",y.map((e=>{const{main:t,background:i}=(0,a.q)(e,u,h);return`\n            ::highlight(${e.id}) {\n              ${t}\n            }\n            ::highlight(${e.id}-hl) {\n              ${i}\n            }\n            `})),"}"))};function c(e,t,i,n,s){const o=(0,r.Mf)(e,t,i),a=function(e,t,i,n){let s=i.get(e);if(s)return s.add(n),s;return s=new Highlight(n),s.type=(0,r.pE)(t),s}(o,e,n,s);return n.set(o,a),o}},91622:(e,t,i)=>{function n(e,t){const i=Math.max(0,Math.min(1,t));if(7===e.length){return e+Math.floor(255*i).toString(16).padStart(2,"0")}{const t=parseInt(e.slice(-2),16)/255,n=Math.floor(i*t*255).toString(16).padStart(2,"0");return e.slice(0,-2)+n}}function s(e){switch(e){case"SpellingSquiggle":return"spelling-error";case"GrammarSquiggle":case"AdvancedSquiggle":return"grammar-error";default:return"highlight"}}function o(e,t,i){return e+"-"+t+(i?"-hl":"")}i.d(t,{$v:()=>n,Mf:()=>o,pE:()=>s})},81703:(e,t,i)=>{if(i.d(t,{q:()=>o}),2063!=i.j)var n=i(67762);if(2063!=i.j)var s=i(91622);function o(e,t,i=!1){const{patternName:o,opacity:r,squiggleVerticalAdjustment:a}=e,l=e=>i?"highlight":e;let d="",c="";switch(o){case n.Bn.SpellingSquiggle:d=`text-decoration: ${l(t.highPriorityColors.tile)} wavy underline;\n           text-decoration-skip-ink: none;\n           text-decoration-thickness: 1px;\n           text-underline-offset: ${a}px;`,c=`background-color: ${l(t.highPriorityColors.highlight)};`;break;case n.Bn.GrammarSquiggle:d=`text-decoration: ${l(t.mediumPriorityColors.tile)} double underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${.5+a}px;`,c=`background-color: ${l(t.mediumPriorityColors.highlight)};`;break;case n.Bn.AdvancedSquiggle:d=`text-decoration: ${l(t.lowPriorityColors.tile)} dashed underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${a}px;\n           text-decoration-thickness: 2px;`,c=`background-color: ${l(t.lowPriorityColors.highlight)};`;break;case n.Bn.CIQFlagSquiggle:d=`text-decoration: ${l(t.ciqFlagColors.tile)} dotted underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${1+a}px;\n           text-decoration-thickness: 3px;`,c=`background-color: ${l(t.ciqFlagColors.highlight)};`;break;case n.Bn.HeadingDetectionSquiggle:d=`text-decoration: ${l(t.headingDetectionColors.tile)} dashed underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${a}px;\n           text-decoration-thickness: 2px;`,c=`background-color: ${l(t.headingDetectionColors.highlight)};`;break;case n.Bn.AutoCorrectSquiggle:d=`text-decoration: ${l((0,s.$v)(t.autoCorrectColors.tile,r))} solid underline;\n            background-color: ${l((0,s.$v)(t.autoCorrectColors.highlight,r))};\n            text-decoration-skip-ink: none;\n            text-underline-offset: ${1+a}px;\n            text-decoration-thickness: 1px;`,c=`text-decoration: ${l(t.autoCorrectColors.tile)} solid underline;\n        background-color: ${l(t.autoCorrectColors.highlight)};`}return{main:d,background:c}}},84463:(e,t,i)=>{i.d(t,{M:()=>o});var n=i(8520);if(2063!=i.j)var s=i(19728);const o=e=>{const[t,i]=n.useState(0),o=n.useRef([]);n.useEffect((()=>(0,s.observe)(e.map,(e=>{o.current.push(e.name),i((e=>e+1))}))),[e.map]);const a=o.current;return o.current=[],n.createElement(n.Fragment,null,Array.from(e.map).map((([t,i])=>n.createElement(r,{key:t,id:t,value:i,changedReferences:a,renderEntry:e.renderEntry}))))},r=n.memo((e=>e.renderEntry(e.id,e.value)),((e,t)=>e.id===t.id&&(t.changedReferences.length>0&&!t.changedReferences.includes(e.id))))},12478:(e,t,i)=>{if(i.d(t,{G:()=>s}),2063!=i.j)var n=i(95523);class s{constructor(e,t,i,n){this.calloutStateStore=e,this.inlineSuggestionsRenderer=t,this.undoCalloutStateStore=i,this.logger=n}async showFlagCritique(e){var t,i,s,o,r,a;if(!(0,n.r3)(e.critique))return void(null===(t=this.logger)||void 0===t||t.error(0,"Got a critique that is not a flag critique, but expected a flag critique"));if(!e.onApplyFlag)return void(null===(i=this.logger)||void 0===i||i.error(508909201,"Got flag callout display, but no function for onApplyFlag was specified"));if(!this.inlineSuggestionsRenderer)return void(null===(s=this.logger)||void 0===s||s.error(508909200,"Got flag callout display, but no inlineSuggestionRenderer"));await this.inlineSuggestionsRenderer.showFlag(e.critique,e.onApplyFlag,((e,t)=>{var i,n,s;t?null===(i=this.calloutStateStore)||void 0===i||i.hide():null===(n=this.calloutStateStore)||void 0===n||n.clickNoActionHide(e),null===(s=this.undoCalloutStateStore)||void 0===s||s.hide()}),e.onFlagIgnoreOnce,e.onFlagIgnoreAll,e.onDisableFlag,e.onShowFeedback,null===(o=this.calloutStateStore)||void 0===o?void 0:o.navInfo,null===(r=this.calloutStateStore)||void 0===r?void 0:r.navigate),null===(a=this.calloutStateStore)||void 0===a||a.markAsShown(e.critique,e.onDismiss)}}},13533:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(8520);if(2063!=i.j)var s=i(94900);if(2063!=i.j)var o=i(51193);const r=e=>{const{top:t,left:i,width:r,height:a}=e.data.clientRect,l=e.isVisible?void 0:"none";return n.createElement(n.Fragment,null,n.createElement(s.z,{anchor:e.anchor,disableCalloutOnDoubleClick:e.disableCalloutOnDoubleClick,element:e.element,isCaretOver:e.isCaretOver,isMouseOver:e.isMouseOver,isCalloutOpened:e.isCalloutOpened,openCalloutPredicate:e.openCalloutPredicate,onKeyboardEvent:e.onKeyboardEvent,onClick:e.onClick,onContextMenuClick:e.onContextMenuClick,closeCalloutOnNonLeftClick:e.closeCalloutOnNonLeftClick,logRightClickEvent:e.logRightClickEvent,onContextMenuKeyUpEvent:e.onContextMenuKeyUpEvent,onEscapePress:e.onEscapePress}),n.createElement("span",{role:e.role,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,ref:e.squiggleRef,className:e.className,style:{top:t,left:i,width:r,height:a,zIndex:e.data.zIndex,display:l,opacity:e.opacity}}),e.useSvgUnderline&&n.createElement(o.a,{width:r,left:i,squiggleHeight:t+a,patternName:e.patternName,className:e.className,styleOverrides:{display:l,opacity:e.opacity}}))}},94900:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(8520);if(2063!=i.j)var s=i(98970);if(2063!=i.j)var o=i(99596);var r;!function(e){e[e.MainButtonPressed=0]="MainButtonPressed",e[e.AuxiliaryButtonPressed=1]="AuxiliaryButtonPressed",e[e.SecondaryButtonPressed=2]="SecondaryButtonPressed",e[e.FourthButton=3]="FourthButton",e[e.FifthButton=4]="FifthButton"}(r||(r={}));const a=e=>{const{anchor:t,isCalloutOpened:i,disableCalloutOnDoubleClick:a,element:l,isCaretOver:d,isMouseOver:c,onClick:u,onEscapePress:h,onKeyboardEvent:g,closeCalloutOnNonLeftClick:p,onContextMenuKeyUpEvent:m,logRightClickEvent:f,openCalloutPredicate:v}=e,_=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),y=n.useRef(null);return n.useEffect((()=>{var n;const o=t=>{var i;null===(i=e.onContextMenuClick)||void 0===i||i.call(e)},h=e=>{var t;if(c&&!i){const e=(null!==(t=l.ownerDocument.defaultView)&&void 0!==t?t:window).getSelection();e&&e.focusNode===e.anchorNode&&e.focusOffset===e.anchorOffset&&(null==u||u())}},g=e=>{i?e.button!==r.MainButtonPressed&&(null==p||p()):c&&e.button===r.SecondaryButtonPressed&&(null==f||f())},v=e=>{d&&!i&&"ContextMenu"===e.key&&(null==m||m())};if(a){const e=null!==(n=l.ownerDocument.defaultView)&&void 0!==n?n:window,i=t=>{const i=t;i.button===r.MainButtonPressed?1===i.detail&&(y.current=e.setTimeout(h,200)):null==p||p()},a=()=>{y.current&&(e.clearTimeout(y.current),y.current=null)},d=e=>a(),c=new s.J(t);return c.addListener("contextmenu",o),c.addListener("click",i),c.addListener("dblclick",d),c.addListener("mouseup",g),c.addListener("keyup",v),()=>{c.removeAllListeners(),a()}}{const e=new s.J(t);return e.addListener("contextmenu",o),e.addListener("click",h),e.addListener("mouseup",g),e.addListener("keyup",v),()=>{e.removeAllListeners()}}}),[t,a,l,p,c,i,u]),n.useEffect((()=>{if(d||c||i){const e=(0,o.a2)(t),n=new s.J(e),r=e=>{const t=e;d&&(null==v?void 0:v(t))&&!i?"keyup"===t.type?null==g||g():_(e):"Escape"===t.key&&"keyup"===t.type&&(null==h||h())};return n.addListener("keyup",r),i||(n.addListener("focus",_),n.addListener("blur",_),n.addListener("keydown",r)),()=>{n.removeAllListeners()}}}),[c,d,i,t,v,g,h]),null}},67762:(e,t,i)=>{i.d(t,{Bn:()=>l,H7:()=>d,K3:()=>u,VA:()=>h,fQ:()=>c});var n=i(8520);if(2063!=i.j)var s=i(79343);if(2063!=i.j)var o=i(11864);if(2063!=i.j)var r=i(9178);if(2063!=i.j)var a=i(3049);const l={SpellingSquiggle:"SpellingSquiggle",GrammarSquiggle:"GrammarSquiggle",AdvancedSquiggle:"AdvancedSquiggle",CIQFlagSquiggle:"CIQFlagSquiggle",HeadingDetectionSquiggle:"HeadingDetectionSquiggle",AutoCorrectSquiggle:"AutoCorrectSquiggle",UnknownSquiggle:"UnknownSquiggle"};function d(e,t,i){switch(e.priority){case s.bx.High:return(0,a.MG)(e)&&t&&i!==r.Ah.critique?"AutoCorrectSquiggle":"SpellingSquiggle";case s.bx.Medium:return"GrammarSquiggle";case s.bx.Low:return"AdvancedSquiggle";case s.bx.Informational:return e.typeId===s.L9.HeadingDetection?"HeadingDetectionSquiggle":"CIQFlagSquiggle";default:return"UnknownSquiggle"}}const c={SpellingSquiggle:4,GrammarSquiggle:3,AdvancedSquiggle:2,CIQFlagSquiggle:3,HeadingDetectionSquiggle:2,AutoCorrectSquiggle:1,UnknownSquiggle:0},u={SpellingSquiggle:0,GrammarSquiggle:0,AdvancedSquiggle:0,CIQFlagSquiggle:1,HeadingDetectionSquiggle:0,AutoCorrectSquiggle:0,UnknownSquiggle:0},h=e=>{const{theme:t}=e,i="squiggleHighlightStrokeColor",s="squiggleHighlightFillColor",r=`\n      ${o.Rr} {\n        .${i} {\n          stroke: highlight;\n        }\n        .${s} {\n          fill: highlight;\n        }\n      }`;return n.createElement(n.Fragment,null,n.createElement("style",null,r),n.createElement("svg",{width:"0",height:"0",style:{position:"absolute"}},n.createElement("defs",null,n.createElement("pattern",{id:l.SpellingSquiggle,width:"5",height:c.SpellingSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("path",{d:"M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3",className:i,stroke:t.highPriorityColors.tile,strokeWidth:"1",fill:"transparent"})),n.createElement("pattern",{id:l.GrammarSquiggle,width:"5",height:c.GrammarSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round"},n.createElement("g",{className:i,stroke:t.mediumPriorityColors.tile},n.createElement("path",{d:"M0,0.5 L5,0.5"}),n.createElement("path",{d:"M0,2.5 L5,2.5"})))),n.createElement("pattern",{id:l.AdvancedSquiggle,width:"10",height:c.AdvancedSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M1,1 L5,1",className:i,stroke:t.lowPriorityColors.tile,strokeWidth:"2",strokeLinecap:"round"}))),n.createElement("pattern",{id:l.AutoCorrectSquiggle,width:"5",height:c.AutoCorrectSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none"},n.createElement("path",{d:"M0,0.5 L5,0.5",className:i,strokeWidth:"1",stroke:t.autoCorrectColors.tile}))),n.createElement("pattern",{id:l.CIQFlagSquiggle,width:"6",height:c.CIQFlagSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("circle",{cx:"1.5",cy:"1.5",r:"1.5",className:s,fill:t.ciqFlagColors.tile}))),n.createElement("pattern",{id:l.HeadingDetectionSquiggle,width:"10",height:c.HeadingDetectionSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M1,1 L5,1",className:i,stroke:t.headingDetectionColors.tile,strokeWidth:"2",strokeLinecap:"round"}))))))}},51193:(e,t,i)=>{i.d(t,{a:()=>o});var n=i(8520);if(2063!=i.j)var s=i(67762);const o=e=>{const{className:t,left:i,patternName:o,squiggleHeight:r,styleOverrides:a,width:l}=e,d=s.fQ[o],c=s.K3[o];return n.createElement("svg",{width:l,height:d,viewBox:`0 0 ${l} ${d}`,className:t,style:Object.assign({top:r?r-d+c:void 0,bottom:r?void 0:-1*(d+c),left:i,position:"absolute"},a)},n.createElement("rect",{fill:`url(#${o})`,width:l,height:d}))}},5992:(e,t,i)=>{i.d(t,{$:()=>F});var n=i(8520),s=i(26598),o=i(30833),r=i(4404),a=i(10219),l=i(11804),d=i(52041),c=i(33511),u=i(1527),h=i(65024),g=i(329),p=i(29291),m=i(84463),f=i(9178),v=i(3817);const _=e=>n.createElement(m.M,{map:e.squigglerState.squigglesMap,renderEntry:(t,i)=>n.createElement(y,Object.assign({key:t,squiggles:i,anchorId:t},e))}),y=(0,v.PA)((e=>{const t=[],i=[];let s=0,o=0;for(const n of e.squiggles.values()){const r=n.filter((t=>{var i;return t.isVisible&&e.squigglerState.anchorElement&&(null===(i=e.squigglerState.hostElement)||void 0===i?void 0:i.shouldRenderSquiggle(t.data.range.startContainer,e.squigglerState.anchorElement))})),a=e.squigglerState.getSquiggleProps(r);a.length>0&&a[0].squiggleKind!==f.Ah.critique?i.push(...a):t.push(...a);for(const e of a)s=Math.max(s,e.data.clientRect.right),o=Math.max(o,e.data.clientRect.bottom)}const r=n.createElement(n.Fragment,null,n.createElement(I,Object.assign({},e,{squiggles:t,squiggleKind:f.Ah.critique})),n.createElement(I,Object.assign({},e,{squiggles:i,squiggleKind:f.Ah.autocorrection})));if(e.squigglerState.disableAutoBrowserVirtualizationOfSquiggles)return r;const a=s,l=o;return n.createElement("div",{key:e.anchorId,style:{contentVisibility:"auto",containIntrinsicSize:`${a}px ${l}px`,contain:"strict",position:"absolute",width:a,height:l}},r)})),I=(0,v.PA)((e=>{const t=e.squigglerUXFactory(e.squiggleKind);return n.createElement(n.Fragment,{key:e.squiggleKind},t.getSquiggles(e.squigglerId+e.anchorId,e.squiggles,e.theme,e.forcedHighContrast))}));var C=i(67762),S=i(1159),b=i(51244),T=i(79343),E=i(11864);function N(e,t){switch(e){case h.N.OFFICE:return function(e){return`\n    span.ms-squiggle-${T.bx.High} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.spellingTile};\n    }\n\n    span.ms-squiggle-${T.bx.Medium} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.grammarTile};\n    }\n\n    span.ms-squiggle-${T.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.insightTile};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 1px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      border-image-source: ${e.autoCorrectTile};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t);case h.N.SVG:return function(e){return`\n  span.ms-squiggle-autocorrect-hl, svg.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      box-sizing: border-box;\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-autocorrect, svg.ms-squiggle-autocorrect {\n      opacity: 0%;\n    }\n  `}(t);case h.N.GENERIC:default:return function(e){return`\n    span.ms-squiggle-${T.bx.High} {\n      border-bottom: 4px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.highPriorityColors.tile};\n      border-image-source: ${e.spellingTileBorder};\n    }\n\n    span.ms-squiggle-${T.bx.Medium} {\n      border-bottom: 3px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.mediumPriorityColors.tile};\n      border-image-source: ${e.grammarTileBorder};\n    }\n\n    span.ms-squiggle-${T.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px solid;\n      border-image-slice: 0 1 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.lowPriorityColors.tile};\n      border-image-source: ${e.insightTileBorder};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-image-source: ${e.autoCorrectTileBorder};\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t)}}const x=(e=h.N.GENERIC,t,i,n)=>{const s=N(e,t),o=`\n        span.ms-squiggle {\n            position: absolute;\n            border-radius: 2px;\n            border-image-repeat: repeat;\n            background-clip: content-box;\n            cursor: text;\n            pointer-events: none;\n            box-sizing: ${e===h.N.OFFICE?"content-box":"border-box"};\n        }\n\n        span.ms-squiggle.stealth, svg.ms-squiggle.stealth {\n          opacity: 0%;\n          transition: opacity 0.25s;\n        }\n\n        span.ms-squiggle.stealth.hl, svg.ms-squiggle.stealth.hl {\n          opacity: 100%;\n        }\n\n        ${s}\n        ${function(e){return`\n    span.ms-squiggle-${T.bx.High}.hl {\n      background-color: ${e.theme.highPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${T.bx.Medium}.hl {\n      background-color: ${e.theme.mediumPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${T.bx.Low}.hl:not(.ms-squiggle-TopicSuggestion.hl) {\n      background-color: ${e.theme.lowPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition.hl, .ms-squiggle-CIQFlag_DateEntityRecognition.hl, .ms-squiggle-CIQFlag_SatoriEntityRecognition.hl, .ms-squiggle-CIQFlag_Location.hl, .ms-squiggle-CIQFlag_File.hl, .ms-squiggle-CIQFlag_Time.hl, .ms-squiggle-CIQFlag_Topic.hl, .ms-squiggle-CIQFlag_TaskRecognition.hl, .ms-squiggle-TopicSuggestion.hl, .ms-squiggle-CIQFlag_LocalBusiness.hl {\n      background-color: ${e.theme.ciqFlagColors.highlight};\n    }\n\n    span.ms-squiggle-HeadingDetection.hl {\n      background-color:${e.theme.headingDetectionColors.highlight};\n    }\n  `}(t)}\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n    `,r=`\n        span.hc-noadjust {\n          -ms-high-contrast-adjust: none;\n          forced-color-adjust: none;\n        }\n\n        span.ms-squiggle {\n          forced-color-adjust:none;\n          cursor: text;\n          box-sizing: border-box;\n          pointer-events: none;\n          border-color: highlight;\n          border-image-source: none;\n          background-image: none;\n          position: absolute;\n          border-radius: 0px;\n        }\n\n        ${function(e){return e===h.N.SVG?"":`\n    span.ms-squiggle-${T.bx.High} {\n      border-bottom: 4px solid highlight;\n    }\n\n    span.ms-squiggle-${T.bx.Medium} {\n      border-bottom: 3px double highlight;\n    }\n\n    span.ms-squiggle-${T.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px dashed highlight;\n    }\n\n    span.ms-squiggle-autocorrect {\n      border-bottom: none;\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid highlight;\n    }\n  `}(e)}\n\n        span.ms-squiggle-autocorrect {\n          border-bottom: none;\n        }\n\n        span.hl {\n          outline: 2px solid highlight;\n        }\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n\n        span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition,, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n          background-image: linear-gradient(to right, #3c97dd 33%, rgba(0,0,0,0) 0%);\n          background-position: bottom;\n          background-size: 6px 2px;\n          background-repeat: repeat-x;\n        }\n    `;return i?r:n?`\n    @media not (forced-colors: active) {\n      ${o}\n    }\n    ${E.Rr} {\n      ${r}\n    }`:o};var w=i(94329),L=i(1116);const D=(0,s.F5)({featureFlagsReader:o.A.on(a.c),hostSettings:o.A.on(l.n),squigglerUXFactory:o.A.on(p.g),safeWindow:o.A.on(d.j),highConstrastModeDetector:o.A.on(g.P)});class F extends n.Component{constructor(e){super(e),this.connectSquiggler=()=>{this.squigglerEvents.connectSquiggler()},this.disconnectSquiggler=()=>{this.squigglerEvents.disconnectSquiggler()},this.setSquigglerRef=e=>{this.props.state.setSquigglerRef(e),this.squigglerEvents.updatePositionIfRelative()},this.shouldRender=()=>{var e,t;return null!==(t=null===(e=this.props.state.hostElement)||void 0===e?void 0:e.shouldRender(this.props.state.anchorElement))&&void 0!==t&&t},this.selectorRef=n.createRef();const t=new c.O(this.props.state.anchorElement?(0,u.e)(this.props.state.anchorElement):window);this.squigglerEvents=this.props.state.squigglerEventManager.createEventManager(t,this.props.state,this.props.deps.safeWindow)}componentDidUpdate(e){var t;const i=this.props.state.isVisible,n=e.state.isVisible;i?(this.props.state.reactOnComponentUpdate&&(this.squigglerEvents.updatePositionIfRelative(),this.squigglerEvents.checkHighlight()),n||this.connectSquiggler()):n&&this.disconnectSquiggler(),this.selectorRef.current&&(null===(t=this.props.state.hostElement)||void 0===t||t.squigglerUpdated(this.selectorRef.current))}async componentDidMount(){this.connectSquiggler(),await this.props.state.updateRanges(),this.squigglerEvents.checkHighlight(),this.squigglerEvents.updatePositionIfRelative()}componentWillUnmount(){this.disconnectSquiggler(),this.props.state.disconnectVisibilityTracker(),this.squigglerEvents.dispose()}render(){let e={};const{isRelativePositionEnabled:t,squiggleStyleType:i,id:s,top:o,left:r,anchorElement:a,isVisible:l,parentToRenderTo:d,hostElement:c,theme:u,scaleTransformValue:g,forcedHighContrast:p}=this.props.state;if(!a||!d||!c)return null;e=t?{pointerEvents:"none",position:"relative",flexGrow:0,msHighContrastAdjust:"none",display:"block",top:`${o}px`,left:`${r}px`}:{pointerEvents:"none",position:"absolute",msHighContrastAdjust:"none",flexGrow:0,top:`${o}px`,left:`${r}px`};const m=c.squigglerInlineStyles(a,g),f=i===h.N.SVG,v=x(i,u,p,this.props.deps.highConstrastModeDetector.browserSupportsHighContrastMode),y=n.createElement(_,{squigglerState:this.props.state,squigglerId:s,theme:u.theme,forcedHighContrast:p,squigglerUXFactory:this.props.deps.squigglerUXFactory});return(0,S.v4)(this.props.deps.hostSettings)?l&&this.shouldRender()?y:null:w.createPortal(n.createElement("editor-squiggler",{"aria-hidden":this.props.state.ariaEnabled,tabindex:-1,style:{height:"0px",width:"0px"},ref:this.selectorRef},n.createElement(n.Fragment,null,n.createElement("style",null,"\n  @media print {\n    .ms-editor-squiggler {\n        display:none !important;\n    }\n  }\n  .ms-editor-squiggler {\n    all: initial;\n    display: block !important;\n    height: 0px !important;\n    width: 0px !important;\n  }"),n.createElement(L.Ay.div,{className:"ms-editor-squiggler",ref:this.setSquigglerRef,style:m},n.createElement("style",{type:"text/css"},v),f&&n.createElement(C.VA,{theme:u.theme}),n.createElement("div",{style:e},l&&this.shouldRender()&&y)))),d)}}(0,r.r)((0,b.PA)(F),D)},99596:(e,t,i)=>{i.d(t,{a2:()=>c,pT:()=>a});var n=i(79490),s=i(98970),o=i(59332),r=i(29906);let a=class{createEventManager(e,t,i){return new d(e,t,i)}};a=(0,n.__decorate)([(0,r._)()],a);const l={passive:!1};class d{constructor(e,t,i){var n;this.targetWindowRef=e,this.state=t,this.safeWindow=i,this.isMouseWithinElement=!1,this.disconnectAdditionalHandlers=()=>null,this.connectedEventListeners=[],this.connectSquiggler=()=>{for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[];const e=this.targetWindowRef.deref();if(!e)return;const t=new s.J(e),i=new s.J(e.document);if(this.connectedEventListeners.push(t),this.connectedEventListeners.push(i),t.addListener("resize",this.reRenderDeferred,l),i.addListener("mouseup",this.onDocumentMouseUp,l),i.addListener("pointerup",this.onDocumentMouseUp,l),i.addListener("selectionchange",this.checkHighlight,l),this.state.anchorElement&&this.state.hostElement){const e=new s.J(this.state.anchorElement);if(this.connectedEventListeners.push(e),e.addListener("mouseenter",this.onMouseEnter,l),e.addListener("mouseleave",this.onMouseLeave,l),this.resizeObserver){this.resizeObserver.observe(this.state.anchorElement);for(const e of this.state.hostElement.shouldObserveSize(this.state.anchorElement))e&&this.resizeObserver.observe(e)}const t=c(this.state.anchorElement),i=new s.J(t);this.connectedEventListeners.push(i),i.addListener("input",this.onInputHandler,l),i.addListener("keyup",this.throttleKeyUp,l),this.isScrollable&&(i.addListener("scroll",this.throttleScroll,l),i.addListener("mousewheel",this.throttleScroll,l),i.addListener("touchmove",this.throttleScroll,l)),i.addListener("focusin",this.checkHighlight,l),i.addListener("focusout",this.throttleFocusOut,l),this.disconnectAdditionalHandlers=this.state.hostElement.addHandlers(this.state.anchorElement,this,this.state.proofedElements.map((e=>e.id)))}},this.disconnectSquiggler=()=>{var e;for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[],this.lastMouseMoveEvent=void 0,null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,this.disconnectAdditionalHandlers(),this.disconnectAdditionalHandlers=()=>{}},this.dispose=()=>{this.disconnectSquiggler(),this.throttledCheckCursorHighlight=void 0},this.reRender=()=>{this.state.updateRanges()},this.updatePositionIfRelative=()=>{this.requiresUpdateForRelativePosition()&&this.reRender()},this.checkHighlight=()=>{var e,t;const i=this.targetWindowRef.deref();i&&this.state.anchorElement&&(i.document.activeElement===this.state.anchorElement||this.state.anchorElement.contains(i.document.activeElement)||(null===(e=i.document.activeElement)||void 0===e?void 0:e.contains(this.state.anchorElement)))&&(this.onMouseEnter(),this.checkCaretPosition(),null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this))},this.onMouseEnter=()=>{var e;this.isMouseWithinElement=!0,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.anchorElement&&(this.mouseWithinElementEventListener=new s.J(this.state.anchorElement),this.connectedEventListeners.push(this.mouseWithinElementEventListener),this.mouseWithinElementEventListener.addListener("mousemove",this.onMouseMove,l))},this.onMouseLeave=()=>{var e;this.isMouseWithinElement=!1,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.setLastMousePosition(void 0),this.state.trivializeAllSquiggles("cursor")},this.onFocusOut=()=>{this.state.trivializeAllSquiggles("caret"),this.state.closeTooltip()},this.onInputHandler=()=>{this.onInput()},this.onInput=()=>{(this.getShouldReactToInput()||this.state.isAutoCorrectionOnly||this.requiresUpdateForRelativePosition())&&this.reRender()},this.onKeyup=e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key)?this.checkCaretPosition():("Delete"===e.key||"Backspace"===e.key||this.isTabPressed(e)||this.state.isAutoCorrectionOnly)&&this.onInput()},this.isTabPressed=e=>"Tab"===e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey,this.checkCaretPosition=()=>{var e;const t=((null===(e=this.state.anchorElement)||void 0===e?void 0:e.ownerDocument)||document).getSelection();t&&t.rangeCount>0&&this.state.updateSelectionHighlightState(t)},this.onMouseMove=e=>{var t;this.state.anchorElement&&this.isMouseWithinElement?(this.lastMouseMoveEvent=e,null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this)):this.lastMouseMoveEvent=void 0},this.checkCursorHighlight=()=>{if(this.lastMouseMoveEvent&&this.state.anchorElement){const e={x:this.lastMouseMoveEvent.clientX,y:this.lastMouseMoveEvent.clientY};this.state.setLastMousePosition(e)}this.state.updateCursorHighlightState(),this.lastMouseMoveEvent=void 0},this.onDocumentMouseUp=e=>{this.onMouseClick(e),this.reRenderDeferred()},this.onMouseClick=e=>{const{anchorElement:t,updateCursorHighlightState:i,setLastMousePosition:n}=this.state;if(!t)return;n({x:e.clientX,y:e.clientY}),this.checkCaretPosition(),i()},this.throttleScroll=()=>{this.reRenderDeferred()},this.reRenderDeferred=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRender()),this.targetWindowRef)},this.throttleKeyUp=e=>{this.safeWindow.requestAnimationFrame((()=>this.onKeyup(e)),this.targetWindowRef)},this.throttleFocusOut=()=>{this.safeWindow.requestAnimationFrame((()=>this.onFocusOut()),this.targetWindowRef)},this.throttleUpdateOnResize=()=>{this.safeWindow.requestAnimationFrame((()=>{this.state.updatePosition(this.state.isRelativePositionEnabled),this.reRender()}),this.targetWindowRef)},this.requiresUpdateForRelativePosition=()=>{const{isRelativePositionEnabled:e}=this.state;return e&&this.state.updatePosition(e)},this.determineIfScrollable=e=>{switch(e){case"scroll":return!0;case"hidden":case"visible":return!1;default:return null}};const r=e.deref();if(r&&(this.throttledCheckCursorHighlight=(0,o.hQ)(this.safeWindow,r,this.checkCursorHighlight,"After"),this.state.anchorElement)){if(this.isScrollable=null===(n=this.state.hostElement)||void 0===n?void 0:n.isScrollable(this.state.anchorElement),void 0===this.isScrollable){const e=this.getAnchorElementComputedStyle();this.isScrollable=e&&!(!1===this.determineIfScrollable(e.overflowX)&&!1===this.determineIfScrollable(e.overflowY))}r.ResizeObserver&&(this.resizeObserver=new r.ResizeObserver((()=>this.throttleUpdateOnResize())))}}getAnchorElementComputedStyle(){var e;return this.anchorElementComputedStyle||(this.anchorElementComputedStyle=this.state.anchorElement&&(null===(e=this.targetWindowRef.deref())||void 0===e?void 0:e.getComputedStyle(this.state.anchorElement))),this.anchorElementComputedStyle}getShouldReactToInput(){if(void 0!==this.reactToOnInput)return this.reactToOnInput;const e=this.getAnchorElementComputedStyle();return this.reactToOnInput=["center","right"].includes((null==e?void 0:e.textAlign)||"")||"rtl"===(null==e?void 0:e.direction),this.reactToOnInput}}function c(e){let t=e;if("true"!==t.contentEditable&&t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(t=e)}return t}},85533:(e,t,i)=>{i.d(t,{i:()=>fe});var n=i(79490),s=i(85326),o=i(77247),r=i(30095),a=i(93844),l=i(91322),d=i(68514),c=i(32652),u=i(18272),h=i(754),g=i(23943),p=i(29583),m=i(71417),f=i(16087),v=i(45311),_=i(22696),y=i(76778),I=i(52041),C=i(45462),S=i(11804),b=i(10138),T=i(44170),E=i(91984),N=i(9097),x=i(84032),w=i(8520),L=i(19728),D=i(18574);class F{constructor(e,t,i){this.range=e,this.zIndex=i,this.originalStartContainerOfRange=e.startContainer,this.clientRect=t}isRangeInValidState(){return this.range.startContainer===this.originalStartContainerOfRange&&!this.range.collapsed}updateRange(e){e&&(this.range=e)}}class A{constructor(e,t,i,n,s,o,r,a){this.id=e,this.element=t,this.squiggleKind=i,this.critique=n,this.isVisible=s,this.stealth=o,this.data=r,this.squiggleRef=a,(0,D.Gn)(this)}updateFromRect(e,t){var i;this.isVisible!==e.visible&&(this.isVisible=e.visible),e.visible&&(this.data=new F(t,e,this.data.zIndex));const n=null!==(i=this.critique.isStealth)&&void 0!==i&&i;n!==this.stealth&&(this.stealth=n)}}(0,n.__decorate)([L.observable],A.prototype,"isVisible",void 0),(0,n.__decorate)([L.observable],A.prototype,"stealth",void 0),(0,n.__decorate)([L.observable],A.prototype,"data",void 0),(0,n.__decorate)([L.action],A.prototype,"updateFromRect",null);var R,q=i(59556),P=i(65099),O=i(79343),k=i(63201),z=i(1527),M=i(33511),j=i(65024),W=i(97153);function B(e,t,i,n){return e&&i>=e.top&&i<=e.bottom?t>=e.left&&t<=e.right?R.direct:n&&t>=e.right-n&&t<=e.left?R.indirect:R.line:R.none}function U(e,t){if("Caret"!==t.type||!t.focusNode)return R.none;if(e.isPointInRange(t.focusNode,t.focusOffset))return R.direct;const i=e.getBoundingClientRect(),n=t.getRangeAt(0).getBoundingClientRect();return i.top<=n.top&&i.bottom>=n.bottom?R.line:R.none}function H(e,t){return!("Caret"!==t.type||!t.focusNode)&&e.isPointInRange(t.focusNode,t.focusOffset)}!function(e){e.none="none",e.direct="direct",e.line="line",e.indirect="indirect"}(R||(R={}));var V=i(30392),G=i(9178),Q=i(64652),K=i(41693),$=i(99596),J=i(95089);function Z(e){if(!e||"auto"===e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t+1}function Y(e,t,i,n=1){const s=i,o=t(function(e){if(e.startContainer===e.endContainer)return Array.from(e.getClientRects());const t=e.startContainer.ownerDocument||document,i=t.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ALL),n=[];for(;i.nextNode()&&(0===n.length&&i.referenceNode!==e.startContainer||(n.push(i.referenceNode),i.referenceNode!==e.endContainer)););const s=[],o=t.createRange();for(const t of n)t.nodeType===t.TEXT_NODE&&(o.selectNode(t),t===e.startContainer?o.setStart(t,e.startOffset):t===e.endContainer&&o.setEnd(t,e.endOffset),s.push(...Array.from(o.getClientRects())));let r=!0;for(const e of s)if(e.top!==s[0].top||e.height!==s[0].height){r=!1;break}if(r){return[s.reduce(((e,t)=>new DOMRect(Math.min(e.left,t.left),e.top,Math.max(e.right,t.right)-Math.min(e.left,t.left),e.height)))]}return s}(e),e),r=[];if(o)for(const e of o){const t=(s.right-s.left)/n,i=e.left-s.left,o=Math.min(e.right-s.left,t),a={top:e.top-s.top,left:i,bottom:e.bottom-s.top,right:o,width:o-i,height:e.height,visible:!X(e,s)};r.push(a)}return r}function X(e,t){return e.bottom>t.bottom+e.height/4||e.left>t.right||e.right<t.left||e.bottom<t.top}function ee(e){if(!e)return 0;const t=parseFloat(e);return isNaN(t)?0:t}var te=i(70807),ie=i(3049),ne=i(94526),se=i(44233);const oe=()=>!0,re=(e,t,i,n,s=!0)=>{var o,r,a,l,d,c,u,h,g,p,m,f;const v=i.find((t=>t.match(e))),_=null!==(o=null==v?void 0:v.shouldRender)&&void 0!==o?o:oe,y=null!==(r=null==v?void 0:v.shouldRenderSquiggle)&&void 0!==r?r:oe,I=null!==(a=null==v?void 0:v.shouldObserveSize)&&void 0!==a?a:()=>[],C=null!==(l=null==v?void 0:v.addHandlers)&&void 0!==l?l:()=>()=>null,S=null!==(d=null==v?void 0:v.squigglerInlineStyles)&&void 0!==d?d:()=>{},b=null!==(c=null==v?void 0:v.transformSquiggleRects)&&void 0!==c?c:e=>e,T=null!==(u=null==v?void 0:v.getForbiddenRects)&&void 0!==u?u:()=>[],E=null!==(h=null==v?void 0:v.isScrollable)&&void 0!==h?h:()=>{},N=null!==(g=null==v?void 0:v.squigglerUpdated)&&void 0!==g?g:()=>{},x=e.tagName.toLowerCase(),w="editor-shadow-element"===x?window.document.body:e.parentElement,L=null!==(p=null==v?void 0:v.getSquigglerTopOffset)&&void 0!==p?p:e=>e.getBoundingClientRect().height,D={element:null!==(m=e.parentElement)&&void 0!==m?m:window.document.body,zIndex:null!==(f=null==v?void 0:v.zIndex)&&void 0!==f?f:"auto",shouldRender:_,shouldRenderSquiggle:y,shouldObserveSize:I,addHandlers:C,squigglerInlineStyles:S,transformSquiggleRects:b,getForbiddenRects:T,isScrollable:E,squigglerUpdated:N,getTopOffset:L,disableCalloutOnDoubleClick:null==v?void 0:v.disableCalloutOnDoubleClick};if("body"===x||!w)return D;if(null==v?void 0:v.selector){const t="string"==typeof v.selector?e.closest(v.selector):v.selector(e,null==n?void 0:n.element);if(t)return D.element=t,D}return D.element=s?((e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let i=e.parentElement,n=window.getComputedStyle(i);for(;i&&"relative"!==n.position&&i!==document.body;)i=i.parentElement,n=window.getComputedStyle(i);return i})(e,t()):w,D};var ae=i(15108);class le extends q.z{constructor(e,t,i,n,s,o,r,a,l,d,c,h){var g,p,m,f,v,_,y,C;super(),this.tileContent=t,this.hostSettings=i,this.proofingDom=n,this._squiggleThemeStore=s,this.critiqueApplicationHandler=o,this.critiqueRangeBuilder=r,this.autoCorrectionBroker=a,this.getIsHighContrastTheme=l,this.logger=d,this.upsellStore=c,this.editorSettingsState=h,this.diffPrecision=.01,this.isTooltipShown=!1,this.squigglesMap=new L.ObservableMap,this.autoCorrectDisabledLanguages=[],this.proofedElements=[],this.proofedElementDomRects=[],this.calloutOpenedForCritique=void 0,this.mouseHoveredElement=void 0,this.mouseIndirectlyHoveredElement=void 0,this.disabledCritiqueIdToShowTooltip=void 0,this.caretHoveredElement=void 0,this.scaleTransformValue=1,this.top=0,this.left=0,this.hadUpdateWithoutAnyValidSquiggles=!1,this.recalculateRelativePosition=()=>{this.isRelativePositionEnabledValue=this.calculateRelativePosition()},this.isVisible=!1,this.onCalloutPositionUpdated=(e,t)=>{this.isUndoCalloutAlignedRight=e,this.undoCalloutRect=t},this.setAutoCorrectLanguages=e=>{this.autoCorrectDisabledLanguages=e},this.setCritiques=async(e,t=!1)=>{var i;const n=this.proofedElements.find((t=>t.id===e.id));let s=!0;if(n){if(t){const t=e.critiques.length!==n.critiques.length||!e.critiques.every(((e,t)=>(0,P.gS)(e,n.critiques[t]))),o=(null===(i=this.squigglesMap.get(e.id))||void 0===i?void 0:i.size)!==e.critiques.length;s=t||o||this.hadUpdateWithoutAnyValidSquiggles,this.hadUpdateWithoutAnyValidSquiggles=!1}n.critiques=e.critiques}else this.proofedElements.push(e);s&&await this.updateRanges([e.id])},this.removeCritiques=async e=>{const t=this.proofedElements.findIndex((t=>t.id===e));-1!==t&&(this.squigglesMap.delete(e),this.proofedElements.splice(t,1),await this.updateRanges())},this.updateRanges=async e=>{var t;this.throttledUpdateRanges?(this.throttledUpdateRangesProofedElementsToCheck=e?[...null!==(t=this.throttledUpdateRangesProofedElementsToCheck)&&void 0!==t?t:[],...e]:void 0,await this.throttledUpdateRanges()):await this.updateRangesImmediately(e)},this.updateSquiggles=()=>{this.throttledUpdateSquiggles?this.throttledUpdateSquiggles():this.innerUpdateSquiggles()},this.setVisible=e=>{this.isVisible=e,e&&(this.cancelSetVisibleFrame(),this.setVisibleFrameRequestId=this.safeWindow.requestAnimationFrame((async()=>{await this.updateRanges()}),this.targetWindowRef))},this.setLastMousePosition=e=>{this.lastMousePosition=e},this.disconnectVisibilityTracker=()=>{var e;null===(e=this._visibilityTracker)||void 0===e||e.disconnect()},this.getCritiques=()=>this.proofedElements.reduce(((e,t)=>e.concat(t.critiques)),[]),this.showCallout=(e,t)=>{var i,n;const s=null===(i=this.targetWindowRef)||void 0===i?void 0:i.deref();if(!e.traceId||!s)return;const o=this.findSquiggle(e.traceId);if(o){const i=null!==(n=o.data.range.startContainer.parentElement)&&void 0!==n?n:o.element;this.cancelShowCalloutFrame(),this.showCalloutFrameRequestId=this.safeWindow.requestAnimationFrame((()=>{i.scrollIntoView({behavior:"auto"}),this.clearOnCalloutShownCallbackTimeout(),this.onCalloutShownCallbackTimeout=s.setTimeout((()=>{var i,n;de(o)&&(this.onShowCallout(null!==(n=null===(i=o.squiggleRef)||void 0===i?void 0:i.current)&&void 0!==n?n:null,e,o.data.range.toString(),!0,(()=>{}),o.element,G.Ah.critique),null==t||t())}),100)}),s)}},this.updateSelectionHighlightState=e=>{let t,i=0;this.forEachCritique((n=>{var s,o;for(const r of n.squiggles){if(!r.isVisible)continue;let a=R.none;this.ariaLineNavUpdatesEnabled?a=U(r.data.range,e):H(r.data.range,e)&&(a=R.direct),a===R.direct?(this.caretHoveredCritiqueId=r.critique.traceId,(1===n.squiggles.length||this.checkSquiggleSelection(r,e))&&(this.caretHoveredElement=r.id,de(r)&&this.showTooltipAt(r.squiggleKind,null===(s=r.squiggleRef)||void 0===s?void 0:s.current,r.critique,"keyboard")),t=r,this.caretPosition={node:e.focusNode,offset:e.focusOffset}):(this.caretHoveredElement===r.id&&(this.caretPosition=void 0,null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout()),a===R.line&&(i+=1),this.trivializeSquiggle(r,"caret"))}})),this.updateAriaStatus(i,t)},this.updateSelectionHighlightStateFromCoordinates=e=>{let t,i=0;this.forEachCritique((n=>{var s,o;for(const r of n.squiggles){if(!r.isVisible)continue;const n=B(r.data.clientRect,e.x,e.y);n===R.direct?(this.caretHoveredCritiqueId=r.critique.traceId,this.caretHoveredElement=r.id,de(r)&&this.showTooltipAt(r.squiggleKind,null===(s=r.squiggleRef)||void 0===s?void 0:s.current,r.critique,"keyboard",e),t=r):(n===R.line&&(i+=1),this.caretHoveredElement===r.id&&(this.caretPosition=void 0,null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout()),this.trivializeSquiggle(r,"caret"))}})),this.updateAriaStatus(i,t)},this.startUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=t.setTimeout((()=>{this.lastMousePosition?this.setMouseIndirectlyHoveredElement(void 0):this.clearUndoCardTimeout()}),2e3))},this.clearUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=void 0)},this.isMouseWithinUndoCallout=()=>{if(!this.undoCalloutRect||!this.lastMousePosition||!this.anchorElement)return!1;const e=(e,t,i)=>e>=t&&e<=t+i;return e(this.lastMousePosition.x,this.undoCalloutRect.x,this.undoCalloutRect.width)&&e(this.lastMousePosition.y,this.undoCalloutRect.y,this.undoCalloutRect.height)},this.updateCursorHighlightState=()=>{var e;if(this.lastMousePosition&&this.anchorElement)if(null===(e=this.options)||void 0===e?void 0:e.enableCursorIntersectionObserver){const e=new IntersectionObserver((t=>{(0,L.runInAction)((()=>{this.updateCursorHighlightStateWithAnchorBoundingBox(t[0].boundingClientRect),e.disconnect()}))}));e.observe(this.anchorElement)}else{const e=this.anchorElement.getBoundingClientRect();this.updateCursorHighlightStateWithAnchorBoundingBox(e)}},this.updateCursorHighlightStateWithAnchorBoundingBox=e=>{if(!this.lastMousePosition)return;const{x:t,y:i}=this.lastMousePosition;let n,s=0;this.forEachCritique((o=>{var r,a,l,d;for(const c of o.squiggles){if(!c.isVisible||!this.anchorElement)continue;const o=this.mouseIndirectlyHoveredElement===c.id?null===(r=this.undoCalloutRect)||void 0===r?void 0:r.width:void 0;let u=B({left:c.data.clientRect.left+e.left,top:c.data.clientRect.top+e.top,right:c.data.clientRect.right+e.left,bottom:c.data.clientRect.bottom+e.top,width:c.data.clientRect.width,height:c.data.clientRect.height},t,i,o);const h=(0,G.kI)(c.squiggleKind);if(this.ariaLineNavUpdatesEnabled||u!==R.line||(u=R.none),h)if(this.mouseIndirectlyHoveredElement===c.id)if(u===R.indirect){if(void 0!==this.indirectTimer)continue;this.startUndoCardTimeout()}else this.setMouseIndirectlyHoveredElement(void 0),this.clearUndoCardTimeout();else(null===(a=this.options)||void 0===a?void 0:a.disableOpenAutoCorrectCalloutOnHover)||this.calloutOpenedForCritique!==c.critique.traceId||u!==R.none||this.isMouseWithinUndoCallout()||(null===(l=this.critiqueCalloutHandler)||void 0===l||l.hideCallout(),this.undoCalloutRect=void 0);if(u===R.direct)return n=c,this.mouseHoveredCritiqueId=c.critique.traceId,this.mouseHoveredElement=c.id,this.isUndoCalloutAlignedRight&&this.setMouseIndirectlyHoveredElement(c.id),void(c.squiggleKind===G.Ah.critique&&de(c)&&this.showTooltipAt(c.squiggleKind,null===(d=c.squiggleRef)||void 0===d?void 0:d.current,c.critique,"mouse"));u===R.line&&(s+=1),this.trivializeSquiggle(c,"cursor")}})),this.updateAriaStatus(s,n),n||this.trivializeCursorSquiggle()},this.trivializeAllSquiggles=e=>{"caret"===e?this.trivializeCaretSquiggle():this.trivializeCursorSquiggle()},this.trivializeSquiggle=(e,t,i=!1)=>{"caret"===t?this.trivializeSquiggleCaretHover(e.critique.traceId):this.mouseHoveredCritiqueId!==e.critique.traceId||i&&(0,G.kI)(e.squiggleKind)||(this.trivializeCursorSquiggle(),this.trivializeDisabledCritiqueIdToShowTooltip())},this.trivializeSquiggleCaretHover=e=>{this.caretHoveredCritiqueId===e&&this.trivializeCaretSquiggle()},this.trivializeDisabledCritiqueIdToShowTooltip=()=>{this.disabledCritiqueIdToShowTooltip=void 0},this.trivializeCursorSquiggle=()=>{this.mouseHoveredCritiqueId=void 0,this.mouseHoveredElement=void 0},this.trivializeCaretSquiggle=()=>{this.caretHoveredCritiqueId=void 0,this.caretHoveredElement=void 0},this.flagShowFeedback=(e,t)=>{var i,n,s,o;this.proofedElements.find((t=>t.element===e))&&((null==t?void 0:t.typeId)===O.L9.CIQFlag_Topic?(0,k.z)((0,ae.S)({topicIds:(null===(i=t.suggestionItems)||void 0===i?void 0:i.map((e=>e.entities.map((e=>e.TopicId)))).join(","))||"",topicNames:(null===(n=t.suggestionItems)||void 0===n?void 0:n.map((e=>e.entities.map((e=>e.DisplayName)))).join(","))||"",highlightedText:t.textInContext||"",hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),requestId:t.nodeId,source:"EditorFlag",traceId:t.traceId||""})):this.publishEvent("feedbackIconClicked",{suggestionText:null!==(s=null==t?void 0:t.textInContext)&&void 0!==s?s:"",mode:null!==(o=null==t?void 0:t.typeId)&&void 0!==o?o:""}))},this.scaleTransform=e=>{this.scaleTransformValue=e,this.innerUpdateSquiggles()},this.updateAriaStatus=(e,t)=>{t&&this.isAriaFeatureEnabled(K.j.highlight)?this.isAriaFeatureEnabled(K.j.highlight)?this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:this.getAriaStatusString(t),severity:"assertive",preserve:!1,id:void 0,messageKind:t.squiggleKind===G.Ah.critique?u.Jx.KeepOriginal:u.Jx.AutoCorrectHover}):this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:"",severity:"assertive",preserve:!1,id:void 0}):this.ariaLineNavUpdatesEnabled&&this.publishEvent("ariaStatusUpdated",{eventKind:"lineNav",issuesCount:e,severity:"polite",preserve:!1})},this.updateRangesImmediately=async e=>{var t,i,n,s,o,r,a;if(!this.isVisible)return;const l=new Set(this.squigglesMap.keys()),d=!!(null===(t=this.options)||void 0===t?void 0:t.autoCorrectionEnabled)&&!!this.autoCorrectionCache;let c=!1;const u=new Map;for(const t of this.proofedElements){if(e&&!e.includes(t.id)){l.delete(t.id);continue}const h=[],g=this.squigglesMap.has(t.id),p=null!==(i=this.squigglesMap.get(t.id))&&void 0!==i?i:new L.ObservableMap,m=new Set(p.keys());for(const e of t.critiques)e.traceId&&m.delete(e.traceId),h.push(e);const f=await this.critiqueRangeBuilder.getCritiqueRanges(h,t.element);let v=[];if(h.length>0){const e=this.determineValidSquiggles(f);v=e.validRanges;for(const t of e.critiquesInInvalidRanges)m.add(t)}if(m.size>0&&this.removeCritiquesFromCache(m,p),v.length>0){this.hadUpdateWithoutAnyValidSquiggles=!1;const e=await this.buildSquigglesForCritiques(t.element,v,p,d),i=[];if(this.autoCorrectionBroker){for(let l=e.length-1;l>=0;l-=1){const d=e[l];if(!(null===(n=this.autoCorrectionCache)||void 0===n?void 0:n.process(d.critique.traceId)))continue;const c=null!==(s=d.critique.nodeId)&&void 0!==s?s:null===(o=d.critique.tileId)||void 0===o?void 0:o.nodeId,u=c?this.proofingDom.findNode(c):null;if(!u){null===(r=this.logger)||void 0===r||r.error(508146701,"Unable to find node while applying autocorrection");continue}this.autoCorrectionBroker.setIsApplyingAutoCorrection(d.critique);const h=await this.tileContent.autoCorrect(u,t.element,d.critique.start,d.critique.length,d.suggestion.text,d.range,null===(a=this.options)||void 0===a?void 0:a.autoCorrectionInputCacheEnabled);if(h){i.push({replacedText:h,critique:d.critique});const e=(0,ie.dP)(d.suggestion);this.publishEvent("autoCorrectionTriggered",{critique:d.critique,isPersonalized:e})}else this.autoCorrectionBroker.convertToNormalSquiggle(d.critique)}let l=0;for(let e=i.length-1;e>=0;e-=1)l+=this.autoCorrectionBroker.setIsFinishedApplyingAutoCorrection(i[e].critique,l),c=!0}}else this.hadUpdateWithoutAnyValidSquiggles=h.length>0;g||u.set(t.id,p),l.delete(t.id)}l.size>0&&this.removeMissingElements(l),this.updatePosition(this.isRelativePositionEnabled),u.size>0&&this.squigglesMap.merge(u),c&&await this.updateRangesImmediately(e)},this.getValidCritiques=async e=>{const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.critiques,e.element);return this.determineValidSquiggles(t).validRanges.map((e=>e.critique))},this.removeCritiquesFromCache=(e,t)=>{var i;for(const n of e.keys())t.delete(n),this.calloutOpenedForCritique===n&&(null===(i=this.critiqueCalloutHandler)||void 0===i||i.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.mouseHoveredCritiqueId!==n&&this.caretHoveredCritiqueId!==n||(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle())},this.removeMissingElements=e=>{var t;for(const i of e){const e=this.squigglesMap.get(i);if(e)for(const i of e.values())for(const e of i)null===(t=this._visibilityTracker)||void 0===t||t.unTrackSquiggle(e.data.range.startContainer);this.squigglesMap.delete(i)}},this.buildSquigglesForCritiques=async(e,t,i,n,s=G.Ah.critique)=>{var o,r,a,l,d,c;const u=[];if(this.anchorElement){const h=this.anchorElement.getBoundingClientRect(),g=null===(o=this.anchorElement.ownerDocument.activeElement)||void 0===o?void 0:o.contains(e),p=null===(r=this.targetWindowRef)||void 0===r?void 0:r.deref(),m=p&&(null===(a=this.hostElement)||void 0===a?void 0:a.getForbiddenRects(p)),f=(e,t)=>{var i;return null===(i=this.hostElement)||void 0===i?void 0:i.transformSquiggleRects(e,t,m)},v=[];for(const o of t){if(!o.range||!o.critique.traceId)continue;const t=i.get(o.critique.traceId);let r=null!==(l=null==t?void 0:t[0].squiggleKind)&&void 0!==l?l:s;if(n&&!t&&g){const e=(0,ie.MG)(o.critique);if(e){const t=o.critique;if(this.autoCorrectionBroker&&!this.autoCorrectionBroker.getHasAutoCorrectionBeenConvertedToNormalSquiggle(t))if(this.autoCorrectionBroker.getHasAutoCorrectionBeenApplied(t))r=(null===(c=this.options)||void 0===c?void 0:c.personalizedAutoCorrectionEnabled)&&(0,ie.dP)(e)?G.Ah.personalizedAutocorrection:G.Ah.autocorrection;else{if(this.enableAutoCorrectionForLanguages(e.languages)&&await(null===(d=this._visibilityTracker)||void 0===d?void 0:d.checkImmediateVisibility(o.range.startContainer))&&this.isAutoCorrectApplicable(o.range)){u.push({critique:t,suggestion:e,range:o.range});continue}this.autoCorrectionBroker.convertToNormalSquiggle(t)}}}this.createOrUpdateSquiggleStates(o.critique,o.range,e,i,r,h,t,f).shouldAnnounce&&v.push({critique:o.critique,squiggleKind:r})}v.length&&this.setAriaStatuses(v)}return u},this.isAutoCorrectApplicable=e=>{var t;const i=null===(t=this.targetWindowRef)||void 0===t?void 0:t.deref();if(!i)return!1;const n=i.document.getSelection();if(!(null==n?void 0:n.focusNode)||!n.isCollapsed)return!1;const s=e.comparePoint(n.focusNode,n.focusOffset);if(0===s)return!1;const o=i.document.createRange();return 1===s?(o.setStart(e.endContainer,e.endOffset),o.setEnd(n.focusNode,n.focusOffset)):(o.setStart(n.focusNode,n.focusOffset),o.setEnd(e.startContainer,e.startOffset)),o.toString().length<=G.tB},this.createOrUpdateSquiggleStates=(e,t,i,n,s,o,r,a)=>e.traceId&&this.anchorElement&&this.hostElement?this.updateSquiggle(r,t,e,i,s,o,a,n,e.traceId):{shouldAnnounce:!1},this.setAriaStatuses=e=>{const t=e.map((e=>{if(!this.isAriaFeatureEnabled(K.j.appearance))return;const{critique:t,squiggleKind:i}=e,n=t.textInContext;if(!n)return;const s=i===G.Ah.critique?`${t.categoryTitle} ${n}`:n,o=i===G.Ah.critique?u.Jx.KeepOriginal:u.Jx.AutoCorrectAppearance;return{text:s,id:t.traceId,messageKind:o}}));this.publishEvent("ariaStatusUpdated",{eventKind:"statusList",statuses:t.filter((e=>!!e)),severity:"assertive"})},this.findSquiggle=e=>{let t;for(const i of this.squigglesMap.values()){const n=i.get(e);if(null==n?void 0:n.length){t=n[0];break}}return t},this.onShowCallout=(e,t,i,n,s,o,r,a,l)=>{var d,c,u,h,g;if(!this.isVisible)return;if(this.calloutOpenedForCritique===t.traceId)return;this.calloutOpenedForCritique&&this.onCalloutClosed(s,!1,this.calloutOpenedForCritique),this.closeTooltip(),this.setCalloutOpenedForCritique(t.traceId);const p=this.proofedElements.find((e=>e.element===o));let m=null===(d=null==p?void 0:p.graphNode)||void 0===d?void 0:d.element;if(!m&&t.nodeId){const e=this.proofingDom.findNode(t.nodeId);(0,ne.l)(e)?m=e.parent.element:e&&(m=e.element)}if(!m)return void(null===(c=this.logger)||void 0===c||c.error(508146700,"Unable to find graph node while showing callout"));const f=null!=e?e:a;if(!f)return void(null===(u=this.logger)||void 0===u||u.error(507562183,"Unable to find target location while showing callout"));const v=e&&(0,z.C)(e,"HTMLElement")?e.ownerDocument:null===(h=this.anchorElement)||void 0===h?void 0:h.ownerDocument;null===(g=this.critiqueCalloutHandler)||void 0===g||g.showCallout({critique:t,issueText:i,setInitialFocus:n,target:f,gapSpace:l,targetDocumentRef:v&&new M.O(v),squiggleKind:r,onDismiss:e=>{this.onCalloutClosed(s,e,t.traceId)},onApplySuggestion:async(e,t)=>{var i,n;this.caretPosition=void 0,await this.critiqueApplicationHandler.applyCritiqueSuggestion(m,o,null!==(i=e.nodeId)&&void 0!==i?i:null==p?void 0:p.id,e,t,(null===(n=this.options)||void 0===n?void 0:n.disableRangeWhenApplyingCritiqueSuggestions)?void 0:a,r)},onApplyFlag:async(e,t,i)=>{await this.critiqueApplicationHandler.applyFlagSuggestion(m,o,e.nodeId,e,t,i)},onIgnoreOnce:e=>{var t,i,n;this.critiqueApplicationHandler.ignoreCritiqueOnce(m,o,null!==(n=null!==(t=e.nodeId)&&void 0!==t?t:null===(i=e.tileId)||void 0===i?void 0:i.nodeId)&&void 0!==n?n:null==p?void 0:p.id,e)},onIgnoreAll:e=>{var t;this.critiqueApplicationHandler.ignoreAllOfCritique(m,o,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onFlagIgnoreOnce:e=>{this.critiqueApplicationHandler.ignoreFlagOnce(m,o,e.nodeId,e)},onFlagIgnoreAll:e=>{this.critiqueApplicationHandler.ignoreAllOfFlag(m,o,e)},onDisableFlag:e=>{this.critiqueApplicationHandler.disableFlagType(m,o,e.nodeId,e)},onShowFeedback:e=>{this.flagShowFeedback(o,e)},onDisableCritiqueType:async e=>{var t;await this.critiqueApplicationHandler.disableCritiqueType(m,o,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onCalloutPositionUpdated:this.onCalloutPositionUpdated})},this.setCalloutOpenedForCritique=e=>{this.calloutOpenedForCritique=e},this.setMouseIndirectlyHoveredElement=e=>{this.mouseIndirectlyHoveredElement=e},this.innerUpdateSquiggles=async()=>{const e=[];if(this.forEachCritique((t=>{if(t.squiggles.length)for(const i of t.squiggles)i.data.isRangeInValidState()||e.push(i)})),e.length){const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.map((e=>e.critique)));if(t.length===e.length)for(let i=0;i<e.length;i++)e[i].data.updateRange(t[i].range)}this.innerUpdateSquigglesWithValidRanges()},this.innerUpdateSquigglesWithValidRanges=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();if(!(this.isVisible&&this.anchorElement&&t&&this.hostElement))return;const i=this.anchorElement.getBoundingClientRect(),n=this.hostElement.getForbiddenRects(t),s=(e,t)=>{var i;return null===(i=this.hostElement)||void 0===i?void 0:i.transformSquiggleRects(e,t,n)},o=[];(0,L.transaction)((()=>{this.forEachCritique((e=>{if(!e.squiggles.length)return;const t=e.squiggles[0];this.updateSquiggle(e.squiggles,t.data.range,t.critique,t.element,t.squiggleKind,i,s,e.elementCritiques,e.key).shouldAnnounce&&o.push(t)}))})),o.length&&this.setAriaStatuses(o)},this.updateSquiggle=(e,t,i,n,s,o,r,a,l)=>{var d,c,u,h,g,p;let m=!0;e?m=null===(u=null===(c=this._visibilityTracker)||void 0===c?void 0:c.isSquiggleVisible(t.startContainer))||void 0===u||u:null===(d=this._visibilityTracker)||void 0===d||d.trackSquiggle(t.startContainer);let f=!1;if(m&&this.anchorElement){const d=Y(t,r,o,this.scaleTransformValue);if(e&&d.length===e.length)for(let n=0;n<d.length;n+=1){const s=this.adjustVerticalPosition(d[n]),o=e[n];s.visible===o.isVisible&&(0,J.a)(s,o.data.clientRect)||e[n].updateFromRect(s,t),o.critique.start!==i.start&&(o.critique.start=i.start),o.stealth!==(null!==(h=o.critique.isStealth)&&void 0!==h&&h)&&(o.stealth=null!==(g=o.critique.isStealth)&&void 0!==g&&g)}else{const o=[];for(const e of d){const r=new A((0,te.h)(),n,s,i,e.visible,null!==(p=i.isStealth)&&void 0!==p&&p,new F(t,this.adjustVerticalPosition(e),this.zIndex),w.createRef());o.push(r)}o.length>0&&(e||(f=!0),a.set(l,o))}}else if(e)for(const t of e)t.isVisible&&(t.isVisible=!1);return{shouldAnnounce:f}},this.adjustVerticalPosition=e=>{var t;return void 0!==(null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment)&&(e.bottom+=this.options.squiggleVerticalAdjustment,e.height+=this.options.squiggleVerticalAdjustment),e},this.forEachCritique=e=>{this.forEachCritiqueInCache(this.squigglesMap,e)},this.forEachCritiqueInCache=(e,t)=>{const i=new Map;for(const n of e){const e=n[0],s=n[1],o=[];for(const i of s){const n=i[0],r=i[1];r.length>0&&o.push(r[0].critique),t({squiggles:r,key:n,elementCritiques:s,elementId:e})}i.set(e,o)}return i},this.showTooltipAt=(e,t,i,n,s)=>{var o,r,a,l,d,c;if(!(null===(o=this.options)||void 0===o?void 0:o.tooltipEnabled)||(null===(r=this.upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(i)))return;if(this.calloutOpenedForCritique||(null===(a=this.editorSettingsState)||void 0===a?void 0:a.currentlyOpen))return void this.closeTooltip();const u=(null==t?void 0:t.ownerDocument)||(null===(l=this.anchorElement)||void 0===l?void 0:l.ownerDocument)||document;let h;if("keyboard"===n)if(s)h=this.getTooltipCoordinatesFromLocalPosition(s);else{const e=u.getSelection();if(!(e&&e.rangeCount>0))return;{const t=e.getRangeAt(0);let i;i=t.collapsed&&t.getClientRects().length?t.getClientRects()[0]:t.getBoundingClientRect(),h={x:i.left,y:i.bottom}}}else{if(this.mouseHoveredCritiqueId===this.disabledCritiqueIdToShowTooltip)return;if(!this.lastMousePosition)return;if(this.options.disableSquiggleTooltipOnTextSelection){const e=u.getSelection();if(e&&0!==e.toString().length)return}h=this.getTooltipCoordinatesFromGlobalPoint(this.lastMousePosition)}this.clearTooltipTimeout();const g=(0,se.m)(u.activeElement);this.tooltipTimeout=null===(c=null===(d=this.targetWindowRef)||void 0===d?void 0:d.deref())||void 0===c?void 0:c.setTimeout((()=>{var s;if("keyboard"===n){const e=(0,se.m)(u.activeElement);if(g!==e)return}this.isTooltipShown=!0,null===(s=this.tooltipHandler)||void 0===s||s.showTooltip({squiggleKind:e,critique:i,position:h,origin:null!=t?t:void 0,isAbsolute:void 0,targetDocument:u})}),1e3)},this.getTooltipCoordinatesFromGlobalPoint=e=>({x:e.x+6,y:e.y+16}),this.getTooltipCoordinatesFromLocalPosition=e=>{var t,i,n;const s=null===(t=this.anchorElement)||void 0===t?void 0:t.getBoundingClientRect();return this.getTooltipCoordinatesFromGlobalPoint({x:e.x+(null!==(i=null==s?void 0:s.left)&&void 0!==i?i:0),y:e.y+(null!==(n=null==s?void 0:s.top)&&void 0!==n?n:0)})},this.closeTooltip=(e,t)=>{var i;this.clearTooltipTimeout(),this.isTooltipShown&&(this.isTooltipShown=!1,null===(i=this.tooltipHandler)||void 0===i||i.hideTooltip()),t&&(this.disabledCritiqueIdToShowTooltip=e)},this.onSquigglerVisibilityChange=e=>{this.setVisible(e)},this.onSquigglesVisibilityChange=()=>{this.updateSquiggles()},this.submitTelemetryEvent=e=>{this.publishEvent("telemetryLogEvent",e)},this.isAriaFeatureEnabled=e=>{var t,i;const n=null!==(i=null===(t=this.options)||void 0===t?void 0:t.ariaFeatures)&&void 0!==i?i:K.j.none;return e===K.j.none?n===e:(n&e)===e},this.restoreCaretOnCalloutClose=()=>{var e,t,i,n,s;if((null===(e=this.options)||void 0===e?void 0:e.restoreCaretPosition)&&void 0!==this.caretPosition){const{node:e,offset:o}=this.caretPosition;if(void 0!==e){const r=((null===(t=this.anchorElement)||void 0===t?void 0:t.ownerDocument)||document).getSelection();if(!r||!e)return;const a=null!==(n=null===(i=e.textContent)||void 0===i?void 0:i.length)&&void 0!==n?n:0,l=Math.min(o,a);try{r.removeAllRanges(),r.setPosition(e,l)}catch(e){null===(s=this.logger)||void 0===s||s.error(539824961,"Error while restoring the IP on callout dismissed",e)}}}},this.checkSquiggleSelection=(e,t)=>{var i,n,s;if(!de(e)||t.rangeCount<1)return!1;const o=t.getRangeAt(0);let r;r=o.collapsed&&o.getClientRects().length?o.getClientRects()[0]:o.getBoundingClientRect();const a=null!==(s=null===(n=null===(i=e.squiggleRef)||void 0===i?void 0:i.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==s?s:e.data.range.getBoundingClientRect();return!(a.left>r.right||a.right<r.left||a.top>r.bottom||a.bottom<r.top)},this.onCalloutClosed=(e,t,i)=>{e(),this.calloutOpenedForCritique===i&&this.setCalloutOpenedForCritique(void 0),t?this.restoreCaretOnCalloutClose():this.caretPosition=void 0},this.getAriaStatusString=e=>{const t=e.data.range.toString();return e.squiggleKind===G.Ah.critique?`${e.critique.categoryTitle} ${t}`:t},this.closeCalloutCallback=e=>{var t;e&&this.calloutOpenedForCritique===e&&(null===(t=this.critiqueCalloutHandler)||void 0===t||t.hideCallout())},this.getSquiggleProps=e=>{var t;const i=this.anchorElement;if(!i)return[];const n=!this.isAriaFeatureEnabled(K.j.none),s=n?"none presentation":"status",o=n?"off":"assertive",r=(null===(t=this.options)||void 0===t?void 0:t.squiggleStyleType)===j.N.SVG;return e.map((e=>{var t,a,l,d;const{critique:c,id:u}=e,h=c.traceId===this.caretHoveredCritiqueId||c.traceId===this.mouseHoveredCritiqueId||c.traceId===this.calloutOpenedForCritique;let g=u===this.mouseHoveredElement;(0,G.kI)(e.squiggleKind)&&(g=g||u===this.mouseIndirectlyHoveredElement);const p=Object.assign(Object.assign({},e),{isHighlighted:h,isCaretOver:u===this.caretHoveredElement,isMouseOver:g,isCalloutOpened:c.traceId===this.calloutOpenedForCritique,useSvgUnderline:r,squiggleVerticalAdjustment:null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment,disableCalloutOnDoubleClick:(null===(a=this.options)||void 0===a?void 0:a.disableCalloutOnDoubleClick)&&(null===(l=this.hostElement)||void 0===l?void 0:l.disableCalloutOnDoubleClick),role:s,ariaLive:o,ariaLabel:n?"":this.getAriaStatusString(e),describedBy:Q.y,anchor:i,onCallOut:this.onShowCallout,closeCallout:this.closeCalloutCallback,showTooltip:this.showTooltipAt,closeTooltip:this.closeTooltip,submitTelemetryEvent:this.submitTelemetryEvent});return(0,G.kI)(e.squiggleKind)&&this.autoCorrectionCache?Object.assign(Object.assign({},p),{squiggleKind:e.squiggleKind,initializationProgress:this.autoCorrectionCache.getSquiggleInitializationProgress(e.critique.traceId),setInitializationProgress:this.autoCorrectionCache.setInitializationProgress,openCalloutOnHover:!(!0===(null===(d=this.options)||void 0===d?void 0:d.disableOpenAutoCorrectCalloutOnHover))}):Object.assign(Object.assign({},p),{squiggleKind:G.Ah.critique})}))},this.clearTooltipTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();this.tooltipTimeout&&t&&(t.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=void 0)},this.clearOnCalloutShownCallbackTimeout=()=>{var e;if(!this.onCalloutShownCallbackTimeout)return;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.onCalloutShownCallbackTimeout),this.onCalloutShownCallbackTimeout=void 0)},this.cancelSetVisibleFrame=()=>{this.setVisibleFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.setVisibleFrameRequestId),this.setVisibleFrameRequestId=void 0)},this.cancelShowCalloutFrame=()=>{this.showCalloutFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.showCalloutFrameRequestId),this.showCalloutFrameRequestId=void 0)};const{anchorElement:S,anchorId:b,proofedItem:T,critiqueCalloutHandler:E,tooltipHandler:x,options:q}=e;let X;this.critiqueCalloutHandler=E,this.tooltipHandler=x,this.id=b,this.options=q,this.anchorElement=S,this.proofedElements.push(T),this.targetWindowRef=new M.O((0,z.e)(this.anchorElement)),this.safeWindow=new I.c(i),this.throttleManager=new W._(null!==(g=this.targetWindowRef)&&void 0!==g?g:new M.O(window)),this.squigglerEventManager=new $.pT,this.autoCorrectionCache=new N.Qr;const ee=()=>X||(X=getComputedStyle(S));this.hostElement=re(S,(()=>ee().position),null!==(p=null==q?void 0:q.edgeCases)&&void 0!==p?p:[],T,!1),(null===(m=this.hostElement.element)||void 0===m?void 0:m.parentElement)===this.anchorElement&&(this.anchorElement.firstElementChild===this.hostElement.element?this.top=0:this.top=-1*this.hostElement.getTopOffset(this.anchorElement)),this.zIndex=this.hostElement.zIndex?Z(this.hostElement.zIndex.toString()):Z(ee().zIndex),this.parentToRenderTo=this.hostElement.element,this._visibilityTracker=null!==(f=null==q?void 0:q.visibilityTracker)&&void 0!==f?f:V.Y,this.isVisible=this._visibilityTracker===V.Y,this._visibilityTracker.connect({trackSquiggler:!0,trackSquiggles:null===(_=null===(v=this.options)||void 0===v?void 0:v.visibilityTrackerShouldTrackSquiggles)||void 0===_||_,anchorElement:S,onSquigglerVisibilityChange:this.onSquigglerVisibilityChange,onSquigglesVisibilityChange:this.onSquigglesVisibilityChange}),(null===(y=this.options)||void 0===y?void 0:y.mutationObserverBasedRelativePosition)&&(this.recalculateRelativePosition(),this._relativePositionMutationObserver=new MutationObserver((e=>this.recalculateRelativePosition())),this._relativePositionMutationObserver.observe(this.parentToRenderTo,{attributeFilter:["class","style"]})),(null==q?void 0:q.throttleUpdates)&&(this.throttledUpdateSquiggles=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,this.innerUpdateSquiggles,16,"After"),this.throttledUpdateRanges=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,(()=>{const e=this.throttledUpdateRangesProofedElementsToCheck;return this.throttledUpdateRangesProofedElementsToCheck=void 0,this.updateRangesImmediately(e)}),16,"After")),this.autoCorrectDisabledLanguages=null!==(C=null==q?void 0:q.autoCorrectDisabledLanguages)&&void 0!==C?C:[],(0,D.Gn)(this)}get isAutoCorrectionOnly(){let e=!1;for(const t of this.squigglesMap.values())for(const i of t.values())for(const t of i.values()){if(!(0,G.kI)(t.squiggleKind)||!this.autoCorrectionCache)return!1;e=!0}return e}get squiggles(){const e=[];return this.forEachCritique((t=>{const i=t.squiggles.filter((e=>{var t;return e.isVisible&&this.anchorElement&&(null===(t=this.hostElement)||void 0===t?void 0:t.shouldRenderSquiggle(e.data.range.startContainer,this.anchorElement))}));e.push(...i)})),e}get isRelativePositionEnabled(){return this.isRelativePositionEnabledValue?this.isRelativePositionEnabledValue:this.calculateRelativePosition()}calculateRelativePosition(){if(this.parentToRenderTo){return"static"===(""!==this.parentToRenderTo.style.position?this.parentToRenderTo.style.position:getComputedStyle(this.parentToRenderTo).position)}return!1}get isEmpty(){return 0===this.proofedElements.length}get theme(){return this._squiggleThemeStore}get squiggleStyleType(){var e;return null===(e=this.options)||void 0===e?void 0:e.squiggleStyleType}get reactOnComponentUpdate(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.reactOnComponentUpdate)&&void 0!==t&&t}get disableAutoBrowserVirtualizationOfSquiggles(){var e,t,i;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.disableAutoBrowserVirtualizationOfSquiggles)&&void 0!==t&&t||null!==(i=this.hostSettings.enableCSSHighlightApiSquiggleRendering)&&void 0!==i&&i}get ariaEnabled(){return this.isAriaFeatureEnabled(K.j.none)}get ariaLineNavUpdatesEnabled(){return this.isAriaFeatureEnabled(K.j.lineNavigation)}get forcedHighContrast(){var e,t;return null!==(t=null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))&&void 0!==t&&t}setSquigglerRef(e){this._squigglerElement=e}checkProofingElementsPosition(){let e=this.proofedElementDomRects.length!==this.proofedElements.length;const t=[];return this.proofedElements.forEach(((i,n)=>{const s=i.element.getBoundingClientRect();t.push(s);const o=this.proofedElementDomRects[n],r=!o||!(s.x===o.x&&s.y===o.y&&s.width===o.width&&s.height===o.height);e=e||r})),e&&(this.proofedElementDomRects=t),e}updatePosition(e){var t,i,n,s,o;if(e){if(this._squigglerElement&&this.anchorElement){if((null===(i=null===(t=this.hostElement)||void 0===t?void 0:t.element)||void 0===i?void 0:i.parentElement)===this.anchorElement&&this.anchorElement.firstElementChild===this.hostElement.element&&0===this.top&&0===this.left)return!1;let e=!1;const r=this._squigglerElement.getBoundingClientRect(),a=this.anchorElement.getBoundingClientRect(),l=a.top-r.top-this.top,d=a.left-r.left-this.left;return Math.abs(l)>(null!==(n=this.diffPrecision)&&void 0!==n?n:.01)&&(this.top+=l,e=!0),Math.abs(d)>(null!==(s=this.diffPrecision)&&void 0!==s?s:.01)&&(this.left+=d,e=!0),!e&&(null===(o=this.options)||void 0===o?void 0:o.trackProofingElementsPositionEnabled)&&(e=this.checkProofingElementsPosition()),e}}else if(this.anchorElement)if(this.anchorElement===this.parentToRenderTo)if(["body","html"].includes(this.anchorElement.nodeName.toLowerCase())){const e=function(e){const t=getComputedStyle(e),i=ee(t.marginTop);return{x:ee(t.marginLeft),y:i}}(this.anchorElement);this.left=this.anchorElement.offsetLeft+e.x,this.top=this.anchorElement.offsetTop+e.y}else this.left=0,this.top=0;else["tbody"].includes(this.anchorElement.nodeName.toLowerCase())?(this.left=0,this.top=0):(this.left=this.anchorElement.offsetLeft,this.top=this.anchorElement.offsetTop);return!1}dispose(){var e,t,i,n;this.clearUndoCardTimeout(),this.anchorElement&&(this.cancelSetVisibleFrame(),this.cancelShowCalloutFrame(),this.clearOnCalloutShownCallbackTimeout(),this.clearTooltipTimeout(),this.squigglesMap.clear(),null===(e=this._visibilityTracker)||void 0===e||e.disconnect(),this._visibilityTracker=void 0,null===(t=this._relativePositionMutationObserver)||void 0===t||t.disconnect(),this._relativePositionMutationObserver=void 0,this.proofedElements=[],this.anchorElement=void 0,this.parentToRenderTo=void 0,this.hostElement=void 0,this._squigglerElement=void 0,this.targetWindowRef=void 0,this.throttledUpdateSquiggles=void 0,this.throttledUpdateRanges=void 0,null===(i=this.throttleManager)||void 0===i||i.dispose(),(this.caretHoveredCritiqueId||this.mouseHoveredCritiqueId)&&(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle()),this.calloutOpenedForCritique&&(null===(n=this.critiqueCalloutHandler)||void 0===n||n.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.critiqueCalloutHandler=void 0,this.tooltipHandler=void 0)}determineValidSquiggles(e){var t,i,n,s,o,r,a,l,d,c;const u=[],h=[],g=new Map;for(const p of e){if(!p.range)continue;const e=p.range.commonAncestorContainer.nodeType!==Node.TEXT_NODE&&(0,z.C)(p.range.commonAncestorContainer,"HTMLElement")?p.range.commonAncestorContainer:p.range.commonAncestorContainer.parentElement;if(!e)continue;let m=!0;const f=g.get(e);if(void 0!==f)m=f;else{("a"===e.nodeName.toLowerCase()||!0===(null===(n=null===(i=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.squigglerSettings)||void 0===i?void 0:i.checkSquigglePositionValidity)||void 0===n?void 0:n.call(i,p.critique,p.range))||(null===(o=null===(s=this.hostSettings.serviceSettings)||void 0===s?void 0:s.squigglerSettings)||void 0===o?void 0:o.invalidSquiggleParentSelectors)&&e.closest(this.hostSettings.serviceSettings.squigglerSettings.invalidSquiggleParentSelectors.join(", ")))&&(m=!1);const u=[...null!==(l=null===(a=null===(r=this.hostSettings.serviceSettings)||void 0===r?void 0:r.squigglerSettings)||void 0===a?void 0:a.invalidSquiggleSelectors)&&void 0!==l?l:[],".ms-prediction","a"].join(", ");let h=p.range.startContainer;if((0,z.C)(h,"HTMLElement")?h.closest(u):null===(d=null==h?void 0:h.parentElement)||void 0===d?void 0:d.closest(u))m=!1;else for(;h=this.getNextNode(p.range.startContainer,!1,p.range.endContainer);){((0,z.C)(h,"HTMLElement")?h.closest(u):null===(c=null==h?void 0:h.parentElement)||void 0===c?void 0:c.closest(u))&&(m=!1);break}g.set(e,m)}m?u.push(p):p.critique.traceId&&h.push(p.critique.traceId)}return{validRanges:u,critiquesInInvalidRanges:h}}getNextNode(e,t,i){var n;if(i!==e){if(e.firstChild&&!t)return e.firstChild;if(e.parentNode)return null!==(n=e.nextSibling)&&void 0!==n?n:this.getNextNode(e.parentNode,!0,i)}}enableAutoCorrectionForLanguages(e=[]){return 0===this.autoCorrectDisabledLanguages.length||e.some((e=>!this.autoCorrectDisabledLanguages.includes(e)))}}function de(e){return!e.squiggleRef||!!e.squiggleRef.current}(0,n.__decorate)([L.observable],le.prototype,"squigglesMap",void 0),(0,n.__decorate)([L.observable],le.prototype,"calloutOpenedForCritique",void 0),(0,n.__decorate)([L.observable],le.prototype,"mouseHoveredElement",void 0),(0,n.__decorate)([L.observable],le.prototype,"mouseIndirectlyHoveredElement",void 0),(0,n.__decorate)([L.observable],le.prototype,"caretHoveredElement",void 0),(0,n.__decorate)([L.observable],le.prototype,"scaleTransformValue",void 0),(0,n.__decorate)([L.observable],le.prototype,"top",void 0),(0,n.__decorate)([L.observable],le.prototype,"left",void 0),(0,n.__decorate)([L.computed],le.prototype,"squiggles",null),(0,n.__decorate)([L.observable],le.prototype,"isVisible",void 0),(0,n.__decorate)([L.action],le.prototype,"removeCritiques",void 0),(0,n.__decorate)([L.action],le.prototype,"setVisible",void 0),(0,n.__decorate)([L.action],le.prototype,"updatePosition",null),(0,n.__decorate)([L.action],le.prototype,"updateSelectionHighlightState",void 0),(0,n.__decorate)([L.action],le.prototype,"updateSelectionHighlightStateFromCoordinates",void 0),(0,n.__decorate)([L.action],le.prototype,"updateCursorHighlightState",void 0),(0,n.__decorate)([L.action],le.prototype,"trivializeCursorSquiggle",void 0),(0,n.__decorate)([L.action],le.prototype,"trivializeCaretSquiggle",void 0),(0,n.__decorate)([L.action],le.prototype,"scaleTransform",void 0),(0,n.__decorate)([L.action],le.prototype,"dispose",null),(0,n.__decorate)([L.action],le.prototype,"updateRangesImmediately",void 0),(0,n.__decorate)([L.action],le.prototype,"removeCritiquesFromCache",void 0),(0,n.__decorate)([L.action],le.prototype,"removeMissingElements",void 0),(0,n.__decorate)([L.action],le.prototype,"setCalloutOpenedForCritique",void 0),(0,n.__decorate)([L.action],le.prototype,"setMouseIndirectlyHoveredElement",void 0),(0,n.__decorate)([L.action],le.prototype,"innerUpdateSquigglesWithValidRanges",void 0),(0,n.__decorate)([L.action],le.prototype,"updateSquiggle",void 0);var ce=i(76729),ue=i(29906),he=i(83010),ge=i(66008),pe=i(27603);const me=(0,ce.f)("SquigglerV2StateStoreOptionsToken");let fe=class{constructor(e,t,i,n,r,a,l,d,c,u,h,g,p,m,f,v,_,C,S,b,T,E,N){var x;this.tileContent=t,this.instrumentationProcessor=i,this._hostEmitters=n,this.hostEmitter=r,this.hostSettings=a,this.proofingDom=l,this._squiggleThemeStore=d,this.logger=c,this._tileNodeTraverser=u,this.upsellStore=h,this.editorSettingsState=p,this.feedbackStore=m,this._disableCritiqueHandler=f,this.critiqueStore=v,this.applyCritiqueSuggestionHandler=_,this.applyFlagHandler=C,this.wordDictionary=S,this.editorSettingsManager=b,this._formElementAutoCorrectionCache=T,this.autoCorrectionBroker=E,this.getIsHighContrastTheme=N,this.onFeedbackIconClicked=async e=>{var t;null===(t=this.feedbackStore)||void 0===t||t.feedbackIconClicked(e.suggestionText,e.mode)},this.onAutoCorrectionTriggered=e=>{this.hostEmitter.emit(y.pD.autoCorrectionTriggered);const t={isPersonalized:e.isPersonalized.toString()};this.instrumentationProcessor.process({critique:e.critique,eventId:15,customProperties:t})},this.onAriaStatusUpdated=e=>{if(this.ariaStatusStateStore)switch(e.eventKind){case"status":this.ariaStatusStateStore.setStatus(e.statusText,e.severity,e.preserve,e.id,e.messageKind);break;case"statusList":this.ariaStatusStateStore.addPreservedStatuses(e.statuses,e.severity);break;case"lineNav":this.ariaStatusStateStore.setLineNavStatus(e.issuesCount,e.severity,e.preserve)}},this.autoCorrectLanguagesUpdated=async e=>{this._squigglerCore.setAutoCorrectLanguages(e.message)},this.setCritiques=async(e,t=!1)=>this._squigglerCore.setCritiques(e,t),this.removeCritiques=async e=>this._squigglerCore.removeCritiques(e),this.updateRanges=async e=>this._squigglerCore.updateRanges(e),this.updateSquiggles=()=>this._squigglerCore.updateSquiggles(),this.setVisible=e=>this._squigglerCore.setVisible(e),this.setLastMousePosition=e=>{this._squigglerCore.setLastMousePosition(e)},this.disconnectVisibilityTracker=()=>{this._squigglerCore.disconnectVisibilityTracker()},this.getCritiques=()=>this._squigglerCore.getCritiques(),this.showCallout=(e,t)=>{this._squigglerCore.showCallout(e,t)},this.updateSelectionHighlightState=e=>{this._squigglerCore.updateSelectionHighlightState(e)},this.updateSelectionHighlightStateFromCoordinates=e=>{this._squigglerCore.updateSelectionHighlightStateFromCoordinates(e)},this.updateCursorHighlightState=()=>{this._squigglerCore.updateCursorHighlightState()},this.trivializeAllSquiggles=e=>{this._squigglerCore.trivializeAllSquiggles(e)},this.flagShowFeedback=(e,t)=>{this._squigglerCore.flagShowFeedback(e,t)},this.scaleTransform=e=>{this._squigglerCore.scaleTransform(e)},this.updateRangesImmediately=async e=>this._squigglerCore.updateRangesImmediately(e),this.getValidCritiques=async e=>this._squigglerCore.getValidCritiques(e),this.onShowCallout=(e,t,i,n,s,o,r,a,l)=>{this._squigglerCore.onShowCallout(e,t,i,n,s,o,r,a,l)},this.closeTooltip=(e,t)=>{this._squigglerCore.closeTooltip(e,t)},this.getSquiggleProps=e=>this._squigglerCore.getSquiggleProps(e),this.options=e.options,this.ariaStatusStateStore=(null===(x=this.options)||void 0===x?void 0:x.ariaFeatures)?g:void 0,this.critiqueRangeBuilder=new o.$(this.tileContent,this.proofingDom,this._tileNodeTraverser),this.safeWindow=new I.c(a),this.critiqueApplicationHandler=new s.n(this._hostEmitters,this.tileContent,this.critiqueRangeBuilder,this.proofingDom,this.safeWindow,this._disableCritiqueHandler,this.logger,this.critiqueStore,this.applyCritiqueSuggestionHandler,this.applyFlagHandler,this.wordDictionary,this.editorSettingsManager,this._formElementAutoCorrectionCache),this._squigglerCore=new le(e,this.tileContent,this.hostSettings,this.proofingDom,this._squiggleThemeStore,this.critiqueApplicationHandler,this.critiqueRangeBuilder,this.autoCorrectionBroker,this.getIsHighContrastTheme,this.logger,this.upsellStore,this.editorSettingsState),this.hostEmitter.on(y.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),this._squigglerCore.subscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.subscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.subscribe("feedbackIconClicked",this.onFeedbackIconClicked)}get squigglesMap(){return this._squigglerCore.squigglesMap}get proofedElements(){return this._squigglerCore.proofedElements}get calloutOpenedForCritique(){return this._squigglerCore.calloutOpenedForCritique}get mouseHoveredElement(){return this._squigglerCore.mouseHoveredElement}get mouseIndirectlyHoveredElement(){return this._squigglerCore.mouseIndirectlyHoveredElement}get mouseHoveredCritiqueId(){return this._squigglerCore.mouseHoveredCritiqueId}get disabledCritiqueIdToShowTooltip(){return this._squigglerCore.disabledCritiqueIdToShowTooltip}get id(){return this._squigglerCore.id}get caretHoveredElement(){return this._squigglerCore.caretHoveredElement}get caretHoveredCritiqueId(){return this._squigglerCore.caretHoveredCritiqueId}get scaleTransformValue(){return this._squigglerCore.scaleTransformValue}get top(){return this._squigglerCore.top}get left(){return this._squigglerCore.left}get isAutoCorrectionOnly(){return this._squigglerCore.isAutoCorrectionOnly}get squiggles(){return this._squigglerCore.squiggles}get parentToRenderTo(){return this._squigglerCore.parentToRenderTo}get hostElement(){return this._squigglerCore.hostElement}get isRelativePositionEnabled(){return this._squigglerCore.isRelativePositionEnabled}get isEmpty(){return this._squigglerCore.isEmpty}get theme(){return this._squigglerCore.theme}get isVisible(){return this._squigglerCore.isVisible}get squiggleStyleType(){return this._squigglerCore.squiggleStyleType}get reactOnComponentUpdate(){return this._squigglerCore.reactOnComponentUpdate}get disableAutoBrowserVirtualizationOfSquiggles(){return this._squigglerCore.disableAutoBrowserVirtualizationOfSquiggles}get ariaEnabled(){return this._squigglerCore.ariaEnabled}get ariaLineNavUpdatesEnabled(){return this._squigglerCore.ariaLineNavUpdatesEnabled}get forcedHighContrast(){return this._squigglerCore.forcedHighContrast}get anchorElement(){return this._squigglerCore.anchorElement}get squigglerEventManager(){return this._squigglerCore.squigglerEventManager}setSquigglerRef(e){this._squigglerCore.setSquigglerRef(e)}updatePosition(e){return this._squigglerCore.updatePosition(e)}dispose(){this._squigglerCore.unsubscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.unsubscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.unsubscribe("feedbackIconClicked",this.onFeedbackIconClicked),this._squigglerCore.dispose(),this.hostEmitter.off(y.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated)}};fe=(0,n.__decorate)([(0,ue._)(),(0,n.__param)(0,(0,he.W)(me)),(0,n.__param)(1,(0,he.W)(h.d)),(0,n.__param)(2,(0,he.W)(C.f)),(0,n.__param)(3,(0,ge.t)(y.zJ)),(0,n.__param)(4,(0,he.W)(y.M5)),(0,n.__param)(5,(0,he.W)(S.n)),(0,n.__param)(6,(0,he.W)(g.w)),(0,n.__param)(7,(0,he.W)(x.Vw)),(0,n.__param)(8,(0,pe.l)()),(0,n.__param)(8,(0,he.W)(b.g)),(0,n.__param)(9,(0,pe.l)()),(0,n.__param)(9,(0,he.W)(p.M)),(0,n.__param)(10,(0,pe.l)()),(0,n.__param)(10,(0,he.W)(m.Ey)),(0,n.__param)(11,(0,pe.l)()),(0,n.__param)(11,(0,he.W)(u.mU)),(0,n.__param)(12,(0,pe.l)()),(0,n.__param)(12,(0,he.W)(T.z)),(0,n.__param)(13,(0,pe.l)()),(0,n.__param)(13,(0,he.W)(f.M)),(0,n.__param)(14,(0,pe.l)()),(0,n.__param)(14,(0,he.W)(v.W)),(0,n.__param)(15,(0,pe.l)()),(0,n.__param)(15,(0,he.W)(r.$)),(0,n.__param)(16,(0,pe.l)()),(0,n.__param)(16,(0,he.W)(a.a)),(0,n.__param)(17,(0,pe.l)()),(0,n.__param)(17,(0,he.W)(l.K)),(0,n.__param)(18,(0,pe.l)()),(0,n.__param)(18,(0,he.W)(_.s)),(0,n.__param)(19,(0,pe.l)()),(0,n.__param)(19,(0,he.W)(E.rI)),(0,n.__param)(20,(0,pe.l)()),(0,n.__param)(20,(0,he.W)(N.PF)),(0,n.__param)(21,(0,pe.l)()),(0,n.__param)(21,(0,he.W)(d.m)),(0,n.__param)(22,(0,pe.l)()),(0,n.__param)(22,(0,he.W)(c.A))],fe)},30392:(e,t,i)=>{if(i.d(t,{J:()=>o,Y:()=>r}),2063!=i.j)var n=i(33511);if(2063!=i.j)var s=i(1527);class o{constructor(){this._targetWindow=new n.O(window),this._visibleSquigglesRangeContainers=new Map,this._checkedElements=new Map,this._isAnchorElementVisible=!0,this.connect=e=>{var t;this._targetWindow=new n.O((0,s.e)(e.anchorElement)),(null===(t=this._targetWindow.deref())||void 0===t?void 0:t.IntersectionObserver)&&(this.initSquigglerObserver(e.trackSquiggler,e.anchorElement,e.onSquigglerVisibilityChange),this.initSquigglesObserver(e.trackSquiggles,e.onSquigglesVisibilityChange))},this.disconnect=()=>{this._squigglesVisibilityObserver&&this._squigglesVisibilityObserver.disconnect(),this._squigglerVisibilityObserver&&this._squigglerVisibilityObserver.disconnect(),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.disconnect()},this.trackSquiggle=e=>{var t;let i;if(!this._squigglesVisibilityObserver||!(i=this.getElementFromRange(e)))return;const n=null!==(t=this._visibleSquigglesRangeContainers.get(i))&&void 0!==t?t:{visible:void 0,handles:0};n.handles=n.handles+1,this._visibleSquigglesRangeContainers.set(i,n),this._squigglesVisibilityObserver.observe(i)},this.unTrackSquiggle=e=>{var t;let i;if(!this._squigglesVisibilityObserver||!(i=this.getElementFromRange(e)))return;const n=null!==(t=this._visibleSquigglesRangeContainers.get(i))&&void 0!==t?t:{visible:!1,handles:0};n.handles=n.handles-1,this._visibleSquigglesRangeContainers.set(i,n),n.handles<=0&&this.untrackElement(i)},this.isSquiggleVisible=e=>{const t=this.getElementFromRange(e);if(!t)return;if(!this._visibleSquigglesRangeContainers.has(t))return void this.trackSquiggle(e);const i=this._visibleSquigglesRangeContainers.get(t);return null==i?void 0:i.visible},this.checkImmediateVisibility=async e=>{const t=this.getElementFromRange(e);if(!t)return!1;const i=await this.asyncCheckVisibility(t);return this._checkedElements.delete(t),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.unobserve(t),i},this.asyncCheckVisibility=async e=>new Promise((t=>this.checkVisibility(e,t))),this.asyncVisibilityCallback=e=>{for(const t of e){const e=this._checkedElements.get(t.target);e&&e(t.isIntersecting)}},this.checkVisibility=(e,t)=>{if(!this._asyncVisibilityObserver){const e=this._targetWindow.deref();if(!e)return;this._asyncVisibilityObserver=new e.IntersectionObserver(this.asyncVisibilityCallback,{rootMargin:"0px",threshold:[0,1]})}this._checkedElements.set(e,t),this._asyncVisibilityObserver.observe(e)},this.untrackElement=e=>{var t;null===(t=this._squigglesVisibilityObserver)||void 0===t||t.unobserve(e),this._visibleSquigglesRangeContainers.delete(e)},this.initSquigglerObserver=(e,t,i)=>{if(!e)return;const n=this._targetWindow.deref();n&&(this._squigglerVisibilityObserver=new n.IntersectionObserver((e=>{i(this.getSquigglerIsVisible(e))}),{rootMargin:"0px",threshold:[0,1]}),this._squigglerVisibilityObserver.observe(t))},this.initSquigglesObserver=(e,t)=>{if(!e)return;const i=this._targetWindow.deref();i&&(this._squigglesVisibilityObserver=new i.IntersectionObserver((e=>{t(this.getVisibleSquigglesRangeContainers(e))}),{rootMargin:"0px",threshold:[0,1]}))},this.getVisibleSquigglesRangeContainers=e=>{var t;let i=!1;for(const n of e.values())if(n.target.isConnected){const e=null!==(t=this._visibleSquigglesRangeContainers.get(n.target))&&void 0!==t?t:{visible:!1,handles:1};e.visible=n.isIntersecting,this._visibleSquigglesRangeContainers.set(n.target,e)}else i=!0;return i&&this.removeZombies(),e},this.removeZombies=()=>{for(const e of this._visibleSquigglesRangeContainers.keys())e.isConnected&&this.untrackElement(e)},this.getSquigglerIsVisible=e=>(this._isAnchorElementVisible=e[e.length-1].isIntersecting,this._isAnchorElementVisible),this.getElementFromRange=e=>1===e.nodeType?e:e.parentElement}}const r={connect:()=>null,disconnect:()=>null,isSquiggleVisible:()=>!0,trackSquiggle:()=>null,unTrackSquiggle:()=>null,checkImmediateVisibility:async()=>!0}},41693:(e,t,i)=>{var n;i.d(t,{j:()=>n}),function(e){e[e.none=0]="none",e[e.appearance=1]="appearance",e[e.highlight=2]="highlight",e[e.lineNavigation=4]="lineNavigation",e[e.cssHighlightsAPIAnnouncement=8]="cssHighlightsAPIAnnouncement"}(n||(n={}))},94461:(e,t,i)=>{i.d(t,{f:()=>s,u:()=>o});var n=i(76729);const s=(0,n.f)("ISquigglerStateStoreFactory"),o=(0,n.f)("ContentEditableSquigglerComponent")},26279:(e,t,i)=>{i.d(t,{_:()=>n});const n=(0,i(76729).f)("ISquigglePositioningEdgeCases")},84032:(e,t,i)=>{i.d(t,{Vw:()=>n,pz:()=>s});const n=(0,i(76729).f)("ISquiggleThemeStore"),s={highPriorityColors:{tile:"#EB0000",highlight:"#FF30001A"},mediumPriorityColors:{tile:"#3355FF",highlight:"#0055CC1A"},lowPriorityColors:{tile:"#7160E8",highlight:"#7160E833"},autoCorrectColors:{tile:"#38BA62",highlight:"#5BC55240"},ciqFlagColors:{tile:"#0F6CBD",highlight:"#0F6CBD1A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}};s.autoCorrectColors.tile,s.ciqFlagColors.tile,s.headingDetectionColors.tile,s.mediumPriorityColors.tile,s.highPriorityColors.tile,s.lowPriorityColors.tile},88688:(e,t,i)=>{i.d(t,{$K:()=>o,iV:()=>s});var n=i(76729);(0,n.f)("InputControlsV2ProxyOptionsToken");const s=(0,n.f)("IInputControlsStateStoreFactory"),o=(0,n.f)("InputControlsSquigglerComponent")},20299:(e,t,i)=>{if(i.d(t,{Cf:()=>o,dB:()=>r,uE:()=>a}),2063!=i.j)var n=i(1527);if(2063!=i.j)var s=i(60049);const o=e=>{const t={},i=window.getComputedStyle(e),o=(0,n.C)(e,"HTMLInputElement");if(t.whiteSpace="pre-wrap",t.wordWrap="break-word",["position","direction","boxSizing","writingMode","width","height","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize","display","visibility"].forEach((e=>{t[e]=i[e]})),t.paddingBottom="0px"===t.paddingBottom?0:t.paddingBottom,o){const n=i.boxSizing&&"content-box"!==i.boxSizing?parseFloat(i.height)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderTopWidth)-parseFloat(i.borderBottomWidth):i.height;t.lineHeight=Number.isNaN(Number(n))?n:`${n}px`,t.whiteSpace="pre",t.overflow="hidden",t.height=parseFloat(t.height)+3,"search"===e.getAttribute("type")&&(t.direction&&"ltr"!==t.direction?t.paddingLeft=`${parseFloat(i.paddingLeft||0)+15}px`:t.paddingRight=`${parseFloat(i.paddingRight||0)+15}px`)}const r={anchor:e,computedWidth:t.width,computedOverflow:i.overflowY||"",boxSizing:i.boxSizing,isInput:o};let a="auto";if(i.zIndex&&"auto"!==i.zIndex){const e=parseInt(i.zIndex,10);a=isNaN(e)?0:e+1}return{overlay:Object.assign(Object.assign({},t),{left:0,top:0,position:"absolute",pointerEvents:"none",resize:"unset",backgroundColor:"transparent",borderColor:"transparent",WebkitTextFillColor:"none",color:"transparent",willChange:"contents",outline:"none",zIndex:a,lineHeight:Number.isNaN(t.lineHeight)?"unset":t.lineHeight,height:Number.isNaN(t.height)?"unset":t.height,width:Number.isNaN(t.width)?"unset":(0,s.x)(r)}),anchor:t}},r=(e,t,i)=>{var n;if(!t)return{top:0,left:0};const s=null!==(n=i.current)&&void 0!==n?n:{top:0,left:0},o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),a=o.top-r.top,l=o.left-r.left;return{top:Math.abs(a)>0?s.top+a:s.top,left:Math.abs(l)>0?s.left+l:s.left,position:"relative",height:"0px"}},a=(e,t)=>({width:"100%",overflow:"hidden",height:e.scrollHeight-e.clientHeight==0?`calc(100% + ${null!=t?t:"2px"})`:"calc(100% + 2px)"})},60049:(e,t,i)=>{i.d(t,{x:()=>o});const n=2063!=i.j?[]:null;let s;const o=e=>{s||(s=(()=>{const e=window.document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.top="-9999px",e.style.overflow="scroll",e.style.position="absolute",window.document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return window.document.body.removeChild(e),t})());const t=n.find((e=>{var t;return!!(null===(t=e.search)||void 0===t?void 0:t.test(window.location.href))}));if(!(null==t?void 0:t.getWidth)){const t=!e.isInput&&"hidden"!==e.computedOverflow&&e.anchor.scrollHeight-e.anchor.clientHeight&&"content-box"!==e.boxSizing&&!navigator.platform.startsWith("mac"),i=Number.parseFloat(e.computedWidth);return t?i-s:e.computedWidth}return t.getWidth(e)}},89882:(e,t,i)=>{if(i.d(t,{G:()=>r}),2063!=i.j)var n=i(98970);if(2063!=i.j)var s=i(51193);var o=i(8520);const r=e=>{const t=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1);o.useEffect((()=>{const t=new n.J(e.anchor);return t.addListener("click",(()=>{var t;e.isMouseOver&&!e.isCalloutOpened&&(null===(t=e.onClick)||void 0===t||t.call(e))})),()=>{t.removeAllListeners()}}),[e.isCalloutOpened,e.critique,e.isMouseOver,e.anchor,e.onClick]);const i=i=>{var n,s,o;const r=i;e.isCaretOver&&(null===(n=e.openCalloutPredicate)||void 0===n?void 0:n.call(e,r))&&!e.isCalloutOpened?(t(i),"keyup"===r.type&&(null===(s=e.onKeyboardEvent)||void 0===s||s.call(e))):"Escape"===r.key&&"keyup"===r.type&&(null===(o=e.onEscapePress)||void 0===o||o.call(e))};return o.useEffect((()=>{if(e.isCaretOver||e.isMouseOver){const s=new n.J(e.anchor);return s.addListener("keyup",i),s.addListener("focus",t),s.addListener("blur",t),s.addListener("keydown",i),()=>{s.removeAllListeners()}}}),[e.isCaretOver,e.isMouseOver,e.isCalloutOpened,e.critique,e.anchor,e.openCalloutPredicate,e.onKeyboardEvent,e.onEscapePress]),o.createElement("span",{ref:e.squiggleRef,id:e.id,role:e.role,className:e.className,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,style:{opacity:e.opacity}},o.createElement("span",{"aria-hidden":"true"},e.data.text),e.useSvgUnderline&&o.createElement(s.a,{width:"100%",left:0,patternName:e.patternName,styleOverrides:{opacity:e.opacity}}))}},92729:(e,t,i)=>{i.d(t,{U:()=>g});var n=i(79490);const s=(0,i(76729).f)("ISquiggleThemeFactory");var o=i(19728),r=i(18574),a=i(84032),l=i(32652),d=i(29906),c=i(27603),u=i(83010);const h=e=>`url("data:image/svg+xml,${encodeURIComponent(e.trim())}")`;let g=class{constructor(e,t){this.getIsHighContrastTheme=t,this._grammarTile="",this._grammarTileBorder="",this._insightTile="",this._insightTileBorder="",this._spellingTile="",this._spellingTileBorder="",this._autoCorrectTile="",this._autoCorrectBorder="",this._ciqFlagTile="",this._ciqFlagBorder="",this._headingDetectionTile="",this._headingDetectionBorder="",this.setSquiggleTheme=e=>{this._theme={highPriorityColors:e.highPriorityColors||this._theme.highPriorityColors,mediumPriorityColors:e.mediumPriorityColors||this._theme.mediumPriorityColors,lowPriorityColors:e.lowPriorityColors||this._theme.lowPriorityColors,autoCorrectColors:e.autoCorrectColors||this._theme.autoCorrectColors,ciqFlagColors:e.ciqFlagColors||this._theme.ciqFlagColors,headingDetectionColors:e.headingDetectionColors||this._theme.headingDetectionColors},this.setGrammarTiles(this._theme),this.setInsightTiles(this._theme),this.setSpellingTiles(this._theme),this.setAutoCorrectTiles(this._theme),this.setCiqFlagTiles(this._theme),this.setHeadingDetectionTiles(this._theme)},this.setGrammarTiles=e=>{this._grammarTile=h(`\n      <svg width="5px" height="3px" viewBox="0 0 5 3" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>grammar_double_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="grammar_double_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n            <path d="M0,2.5 L5,2.5" id="Line-2-Copy-11"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._grammarTileBorder=h(`\n    <svg width="15px" height="9px" viewBox="0 0 15 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n      <title>grammar_double_line</title>\n      <desc>Created with Sketch.</desc>\n      <g id="grammar_double_line" stroke="none" stroke-width="3" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n        <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n          <path d="M0,1.5 L15,1.5" id="Line-2-Copy-10"></path>\n          <path d="M0,7.5 L15,7.5" id="Line-2-Copy-11"></path>\n        </g>\n      </g>\n    </svg>\n  `)},this.setInsightTiles=e=>{this._insightTile=h(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._insightTileBorder=h(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this.setSpellingTiles=e=>{this._spellingTile=h(`\n      <svg width="5px" height="4px" viewBox="0 0 5 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="1"></path>\n              <rect id="Rectangle" x="0" y="0" width="5" height="4"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `),this._spellingTileBorder=h(`\n      <svg width="17px" height="9px" viewBox="0 0 17 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M 0,7.5 H 1 C 4.75,7.5 4.75,1.5 8.5,1.5 12.25,1.5 12.25,7.5 16,7.5 H 17" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="3"></path>\n              <rect id="Rectangle" x="0" y="0" width="17" height="9"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `)},this.setAutoCorrectTiles=e=>{this._autoCorrectTile=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._autoCorrectBorder=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `)},this.setCiqFlagTiles=e=>{this._ciqFlagTile=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n          <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `),this._ciqFlagBorder=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n            <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `)},this.setHeadingDetectionTiles=e=>{this._headingDetectionTile=h(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._headingDetectionBorder=h(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this._theme=a.pz;const i=null==e?void 0:e();i&&this.setSquiggleTheme(i),(0,r.Gn)(this)}get theme(){var e,t;return(null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))?(t=this._theme,Object.assign(Object.assign({},t),{highPriorityColors:Object.assign(Object.assign({},t.highPriorityColors),{tile:"highlight"}),mediumPriorityColors:Object.assign(Object.assign({},t.mediumPriorityColors),{tile:"highlight"}),lowPriorityColors:Object.assign(Object.assign({},t.lowPriorityColors),{tile:"highlight"}),autoCorrectColors:Object.assign(Object.assign({},t.autoCorrectColors),{tile:"highlight"}),ciqFlagColors:Object.assign(Object.assign({},t.ciqFlagColors),{tile:"highlight"}),headingDetectionColors:Object.assign(Object.assign({},t.headingDetectionColors),{tile:"highlight"})})):this._theme}get grammarTile(){return this._grammarTile||this.setGrammarTiles(this._theme),this._grammarTile}get grammarTileBorder(){return this._grammarTileBorder||this.setGrammarTiles(this._theme),this._grammarTileBorder}get insightTile(){return this._insightTile||this.setInsightTiles(this._theme),this._insightTile}get insightTileBorder(){return this._insightTileBorder||this.setInsightTiles(this._theme),this._insightTileBorder}get spellingTile(){return this._spellingTile||this.setSpellingTiles(this._theme),this._spellingTile}get spellingTileBorder(){return this._spellingTileBorder||this.setSpellingTiles(this._theme),this._spellingTileBorder}get autoCorrectTile(){return this._autoCorrectTile||this.setAutoCorrectTiles(this._theme),this._autoCorrectTile}get autoCorrectTileBorder(){return this._autoCorrectBorder||this.setAutoCorrectTiles(this._theme),this._autoCorrectBorder}get ciqFlagTile(){return this._ciqFlagTile||this.setCiqFlagTiles(this._theme),this._ciqFlagTile}get ciqFlagTileBorder(){return this._ciqFlagBorder||this.setCiqFlagTiles(this._theme),this._ciqFlagBorder}get headingDetectionTile(){return this._headingDetectionTile||this.setHeadingDetectionTiles(this._theme),this._headingDetectionTile}get headingDetectionTileBorder(){return this._headingDetectionBorder||this.setHeadingDetectionTiles(this._theme),this._headingDetectionBorder}};(0,n.__decorate)([o.observable],g.prototype,"_theme",void 0),(0,n.__decorate)([o.observable],g.prototype,"_grammarTile",void 0),(0,n.__decorate)([o.observable],g.prototype,"_grammarTileBorder",void 0),(0,n.__decorate)([o.observable],g.prototype,"_insightTile",void 0),(0,n.__decorate)([o.observable],g.prototype,"_insightTileBorder",void 0),(0,n.__decorate)([o.observable],g.prototype,"_spellingTile",void 0),(0,n.__decorate)([o.observable],g.prototype,"_spellingTileBorder",void 0),(0,n.__decorate)([o.observable],g.prototype,"_autoCorrectTile",void 0),(0,n.__decorate)([o.observable],g.prototype,"_autoCorrectBorder",void 0),(0,n.__decorate)([o.observable],g.prototype,"_ciqFlagTile",void 0),(0,n.__decorate)([o.observable],g.prototype,"_ciqFlagBorder",void 0),(0,n.__decorate)([o.observable],g.prototype,"_headingDetectionTile",void 0),(0,n.__decorate)([o.observable],g.prototype,"_headingDetectionBorder",void 0),(0,n.__decorate)([o.computed],g.prototype,"theme",null),(0,n.__decorate)([o.computed],g.prototype,"grammarTile",null),(0,n.__decorate)([o.computed],g.prototype,"grammarTileBorder",null),(0,n.__decorate)([o.computed],g.prototype,"insightTile",null),(0,n.__decorate)([o.computed],g.prototype,"insightTileBorder",null),(0,n.__decorate)([o.computed],g.prototype,"spellingTile",null),(0,n.__decorate)([o.computed],g.prototype,"spellingTileBorder",null),(0,n.__decorate)([o.computed],g.prototype,"autoCorrectTile",null),(0,n.__decorate)([o.computed],g.prototype,"autoCorrectTileBorder",null),(0,n.__decorate)([o.computed],g.prototype,"ciqFlagTile",null),(0,n.__decorate)([o.computed],g.prototype,"ciqFlagTileBorder",null),(0,n.__decorate)([o.computed],g.prototype,"headingDetectionTile",null),(0,n.__decorate)([o.computed],g.prototype,"headingDetectionTileBorder",null),(0,n.__decorate)([o.action],g.prototype,"setSquiggleTheme",void 0),g=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.l)()),(0,n.__param)(0,(0,u.W)(s)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(1,(0,u.W)(l.A))],g)},33012:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(76729).f)("IStyleDefinitions")},64652:(e,t,i)=>{i.d(t,{y:()=>n});const n="ms-squiggle-tooltip"},13558:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(76729).f)("ISquiggleTooltipStateStore")},78068:(e,t,i)=>{i.d(t,{F:()=>h});var n=i(8520),s=i(26598),o=i(30833),r=i(96571);if(2063!=i.j)var a=i(98970);var l=i(13558);if(2063!=i.j)var d=i(64652);var c=i(1116);const u=(0,s.F5)({state:o.A.on(l.A),localizer:o.A.on(r.H)}),h=()=>{const{state:e,localizer:t}=(0,s.KN)(u),[i,o]=n.useState(e.isVisible);n.useEffect((()=>{const t=e=>{o(e.visible)};return e.subscribe("tooltipStateUpdated",t),()=>{e.unsubscribe("tooltipStateUpdated",t)}}),[e]);const{styles:r,fontsUrl:l,targetDocumentRef:h}=e,g=n.useCallback((()=>{e.hide()}),[e]),p=n.useCallback((()=>{e.emergencyDismiss("Tooltip dismissed on click.")}),[e]);return n.useEffect((()=>{var e,t;const i=new a.J(h),n=new a.J(null!==(t=null===(e=h.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window);return i.addListener("scroll",g,{capture:!0}),n.addListener("resize",g,{capture:!0}),()=>{i.removeAllListeners(),n.removeAllListeners()}}),[g,h]),n.createElement("div",{style:r.container},l&&n.createElement("link",{rel:"stylesheet",href:l}),n.createElement(c.Ay.div,{style:r.shadowBoundary},(()=>{const{top:s,right:o,left:r,ariaLabel:a,title:l,text:c,styles:u,isEccOpen:h}=e;return!i||h?null:n.createElement("div",{role:"status","aria-live":"polite",id:d.y,style:u.shadowRoot},n.createElement("div",{onClick:p,style:Object.assign(Object.assign({},u.root),{top:s,left:r,right:o}),role:"tooltip","aria-label":t.getMessage("combineSentences",[l,a])},n.createElement("div",{"aria-hidden":!0,style:u.tooltipMain},n.createElement("div",{"aria-hidden":!0,style:u.title},l),n.createElement("div",{"aria-hidden":!0,style:u.text},c))))})()))}},26274:(e,t,i)=>{i.d(t,{X:()=>b});var n=i(79490),s=i(59556),o=i(79343),r=i(33511),a=i(28831),l=i(45242),d=i(85924),c=i(96571),u=i(11804),h=i(10138),g=i(14775),p=i(12676),m=i(85339),f=i(69287),v=i(33012),_=i(29906),y=i(83010),I=i(27603),C=i(9178),S=i(1159);let b=class extends s.z{constructor(e,t,i,n,s,r,a,l){super(),this.localizer=e,this.hostSettings=t,this.presentationDomSettings=i,this.logger=n,this.scriptDirectionDetector=s,this.styleDefinitions=r,this.urlFormatter=a,this.inlineSuggestionsRenderer=l,this._position=void 0,this._title=void 0,this._isVisible=!1,this._targetDocumentRef=void 0,this.getTitleCritique=e=>{var t;switch(e.priority){case o.bx.Low:return e.typeId===o.L9.TopicSuggestion?this.localizer.getMessage("ebx_SquiggleTooltipTopicTitle"):this.localizer.getMessage("ebx_SquiggleTooltipRefinementTitle");case o.bx.Medium:return this.localizer.getMessage("ebx_SquiggleTooltipGrammarTitle");case o.bx.High:return this.localizer.getMessage("ebx_SquiggleTooltipSpellingTitle");case o.bx.Informational:return null!==(t=e.tooltipTitle)&&void 0!==t?t:""}},this.getTitleAutocorrect=()=>this.localizer.getMessage("ebx_SquiggleTooltipAutoCorrectTitle"),this.resetTimeout=()=>{this.originStatusCheckTimer&&(window.clearTimeout(this.originStatusCheckTimer),this.originStatusCheckTimer=void 0)},this.checkOriginState=()=>{var e;null===(null===(e=this.origin)||void 0===e?void 0:e.parentElement)?this.emergencyDismiss("Tooltip dismissed on timeout: the origin is orphaned."):this.setOriginStateCheckTimeout()},this.setOriginStateCheckTimeout=()=>{this.originStatusCheckTimer=window.setTimeout(this.checkOriginState,3e3)}}get fontsUrl(){var e;return null===(e=this.urlFormatter)||void 0===e?void 0:e.getUrl(this.presentationDomSettings.fabricFontsDefinitionPath)}get title(){var e;return null!==(e=this._title)&&void 0!==e?e:""}get text(){if((0,C.kI)(this.squiggleKind))return this.localizer.getMessage("ebx_AutoCorrectTooltipText");{const e=(0,S.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipCombinationMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipCombinationAlt":"ebx_SquiggleTooltipCombination");return`${this.localizer.getMessage("ebx_SquiggleTooltipText")} ${e}`}}get ariaLabel(){return(0,C.kI)(this.squiggleKind)?this.localizer.getMessage("ebx_AutocorrectTooltipAriaText"):(0,S.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipAriaTextMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipAriaTextAlt":"ebx_SquiggleTooltipAriaText")}get isVisible(){return this._isVisible}get top(){return this._position?`${this._position.y}px`:"auto"}get left(){if(!this._position||this.scriptDirectionDetector.isRtl())return"auto";return`calc(min(100vw - ${this._position.x+300}px, 0px) + ${this._position.x}px)`}get right(){return this._position&&this.scriptDirectionDetector.isRtl()?`calc(100vw - max(${this._position.x}px, 300px))`:"auto"}get styles(){return this.styleDefinitions.tooltip}get isEccOpen(){var e;return!!(null===(e=this.inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo())}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new r.O(document)}async initialize(){}shutDown(){this.hide()}show(e,t,i,n,s){this.resetTimeout(),this.squiggleKind=e,this._title=(0,C.kI)(this.squiggleKind)?this.getTitleAutocorrect():this.getTitleCritique(t),this._position=i,this._isVisible=!!this.hostSettings.showSquiggleTooltip,this.origin=n;const o=null!=s?s:null==n?void 0:n.ownerDocument;this._targetDocumentRef=o&&new r.O(o),this.setOriginStateCheckTimeout();const c=this.logger.getNewActivity(a.n.SquiggleTooltipShown,l.o.SamplingPolicy.CriticalExperimentation);c&&(c.dataFields.push((0,d.n)("CritiqueTypeId",t.typeId)),c.success=!0,c.endNow()),this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:this._position})}hide(){this.resetTimeout(),this.origin=void 0,this._targetDocumentRef=void 0,this._isVisible=!1,this._position=void 0,this.squiggleKind=void 0,this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:void 0})}emergencyDismiss(e){this.logger.warn(545910989,e),this.hide()}};b=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,y.W)(c.H)),(0,n.__param)(1,(0,y.W)(u.n)),(0,n.__param)(2,(0,y.W)(f.D)),(0,n.__param)(3,(0,y.W)(h.g)),(0,n.__param)(4,(0,y.W)(g.iw)),(0,n.__param)(5,(0,y.W)(v.$)),(0,n.__param)(6,(0,y.W)(p.n)),(0,n.__param)(6,(0,I.l)()),(0,n.__param)(7,(0,I.l)()),(0,n.__param)(7,(0,y.W)(m.V))],b)},36406:(e,t,i)=>{i.d(t,{z:()=>d});var n=i(79490);const s=(0,i(76729).f)("IIconRegistrable");var o=i(29906),r=i(66008),a=i(27603),l=i(82479);let d=class{constructor(e){this.iconGroups=e}async initialize(){const e={};for(const t of this.iconGroups)for(const i of await t.getIcons())e[i.iconName]=i.icon;(0,l.K1)({icons:e})}shutDown(){}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.t)(s)),(0,n.__param)(0,(0,a.l)())],d)},91264:(e,t,i)=>{if(i.d(t,{w:()=>o}),2063!=i.j)var n=i(90327);if(2063!=i.j)var s=i(51152);class o{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918369)}configureRootServices(e){e.bind(n.Th).toDynamicValue((()=>()=>e.getOptional(n.JY)))}}},76956:(e,t,i)=>{if(i.d(t,{E:()=>d}),2063!=i.j)var n=i(2253);if(2063!=i.j)var s=i(90327);if(2063!=i.j)var o=i(18272);if(2063!=i.j)var r=i(30076);if(2063!=i.j)var a=i(51152);if(2063!=i.j)var l=i(97446);class d{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918365)}configureRootServices(e){e.bind(r.i).toValue(n.u),e.bind(s.JY).to(s.yi),e.bind(l.S).toExisting(s.JY),e.bind(o.mU).to(o.XG)}}},55126:(e,t,i)=>{if(i.d(t,{E:()=>c}),2063!=i.j)var n=i(76956);if(2063!=i.j)var s=i(25449);if(2063!=i.j)var o=i(329);if(2063!=i.j)var r=i(99186);if(2063!=i.j)var a=i(80593);if(2063!=i.j)var l=i(16087);if(2063!=i.j)var d=i(89732);class c{constructor(){this.imports=[a.r,n.E]}configureRootServices(e){e.bind(l.M).to(d.t),e.bind(s.$).to(s.I),e.bind(o.P).to(r.Q)}}},80593:(e,t,i)=>{if(i.d(t,{r:()=>f}),2063!=i.j)var n=i(25643);if(2063!=i.j)var s=i(55689);if(2063!=i.j)var o=i(93844);if(2063!=i.j)var r=i(45331);if(2063!=i.j)var a=i(77247);if(2063!=i.j)var l=i(85326);if(2063!=i.j)var d=i(16087);if(2063!=i.j)var c=i(45311);if(2063!=i.j)var u=i(42286);if(2063!=i.j)var h=i(64299);if(2063!=i.j)var g=i(51152);if(2063!=i.j)var p=i(97446);if(2063!=i.j)var m=i(14260);class f{constructor(){this.imports=[n.v]}get uniqueId(){return(0,g.z)(507918354)}configureRootServices(e){e.bind(d.g).toDynamicValue((e=>()=>e.getOptional(d.M))),e.bind(p.S).to(s.l),e.bind(o.a).to(r.R),e.bind(c.W).to(u.p),e.bind(h.i).to(l.n),e.bind(a.s).to(a.$),e.bind(p.S).to(m.B)}}},18557:(e,t,i)=>{if(i.d(t,{N:()=>S}),2063!=i.j)var n=i(91264);if(2063!=i.j)var s=i(27745);if(2063!=i.j)var o=i(30472);if(2063!=i.j)var r=i(9828);if(2063!=i.j)var a=i(25741);if(2063!=i.j)var l=i(65197);if(2063!=i.j)var d=i(98085);if(2063!=i.j)var c=i(51152);if(2063!=i.j)var u=i(97446);if(2063!=i.j)var h=i(11804);if(2063!=i.j)var g=i(61703);if(2063!=i.j)var p=i(72028);if(2063!=i.j)var m=i(85339);if(2063!=i.j)var f=i(43230);if(2063!=i.j)var v=i(14899);if(2063!=i.j)var _=i(76787);if(2063!=i.j)var y=i(1240);if(2063!=i.j)var I=i(86283);if(2063!=i.j)var C=i(67815);class S{constructor(){this.imports=[s.d,n.w]}get uniqueId(){return(0,c.z)(507918360)}configureRootServices(e){var t,i;e.bind(u.S).to(o.v),e.bind(r.C).to(r.L),e.bind(f.A).to(C.Z),e.bind(m.V).to(v.W),e.bind(u.S).toExisting(m.V),e.bind(_.Z).toSelf();(null===(i=null===(t=e.get(h.n).oaSettings)||void 0===t?void 0:t.enableECCForMobileDevice)||void 0===i?void 0:i.enabled)?(e.bind(g.j).to(y.g),e.bind(p.e).to(I.d)):e.bind(g.j).to(l.X),e.bind(d.D).to(a.z)}}},51787:(e,t,i)=>{if(i.d(t,{F:()=>l}),2063!=i.j)var n=i(30076);if(2063!=i.j)var s=i(39593);if(2063!=i.j)var o=i(71797);if(2063!=i.j)var r=i(72737);if(2063!=i.j)var a=i(51152);class l{get uniqueId(){return(0,a.z)(507918362)}configureRootServices(e){e.bind(s.S).to(o.F),e.bind(n.i).toValue(r.T)}}},70717:(e,t,i)=>{if(i.d(t,{D:()=>u}),2063!=i.j)var n=i(76956);if(2063!=i.j)var s=i(30076);if(2063!=i.j)var o=i(51152);if(2063!=i.j)var r=i(97446);if(2063!=i.j)var a=i(13558);if(2063!=i.j)var l=i(78068);if(2063!=i.j)var d=i(26274);if(2063!=i.j)var c=i(19189);class u{constructor(){this.imports=[n.E,c.f]}get uniqueId(){return(0,o.z)(507918353)}configureRootServices(e){e.bind(a.A).to(d.X),e.bind(r.S).toExisting(a.A),e.bind(s.i).toValue(l.F)}}},19189:(e,t,i)=>{if(i.d(t,{f:()=>c}),2063!=i.j)var n=i(90528);if(2063!=i.j)var s=i(28811);if(2063!=i.j)var o=i(68514);if(2063!=i.j)var r=i(51152);if(2063!=i.j)var a=i(11804);if(2063!=i.j)var l=i(29291);if(2063!=i.j)var d=i(9178);class c{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918356)}configureRootServices(e){e.bind(l.g).toDynamicValue((e=>{const t=e.get(a.n),i=e.getOptional(o.m);return e=>{switch(e){case d.Ah.critique:return new s.FY(t);case d.Ah.autocorrection:case d.Ah.personalizedAutocorrection:return new n.QE(t,i);default:throw new Error("Unknown squiggle kind")}}}))}}},69287:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(76729).f)("IPresentationDomSettings")},32652:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(76729).f)("GetIsHighContrastTheme")},62617:(e,t,i)=>{i.d(t,{m:()=>s});const n=2063!=i.j?[".ms-ecc-callout",".ms-critique-callout","editor-card","ms-cc-overflow",".ms-cc-overflow"]:null;function s(e,t){return!!(e&&"closest"in e&&e.closest((null!=t?t:n).join(", ")))}},17205:(e,t,i)=>{function n(e){if(!e)return[];const t=[];for(const i of e.stores){const e=i.getCritiques();e.sort(((e,t)=>e.start-t.start));for(const n of e){const e={critique:n,store:i};t.push(e)}}return t}i.d(t,{v:()=>n})},5284:(e,t,i)=>{if(i.d(t,{wn:()=>a}),2063!=i.j)var n=i(82479);if(2063!=i.j)var s=i(1527);const o='style[data-merge-styles="true"], style[data-load-themed-styles="true"], style#ms-prediction-style';function r(e,t,i){var n,s;for(const o of e){if(!(o.dataset.bindId?t.head.querySelector(`style[data-bind-id='${o.dataset.bindId}']`):null)&&(null===(n=o.sheet)||void 0===n?void 0:n.cssRules.length)){const e=t.createElement("style");Array.from(o.attributes).forEach((t=>{t.nodeValue&&e.setAttribute(t.nodeName,t.nodeValue)}));const n=o.dataset.bindId||i.generate();o.dataset.bindId=n,e.dataset.bindId=n,t.head.appendChild(e);for(let t=0;t<o.sheet.cssRules.length;t++){const i=o.sheet.cssRules.item(t);i&&(null===(s=e.sheet)||void 0===s||s.insertRule(i.cssText,t))}}}}function a(e,t,i=o,a=document){r(Array.from(a.querySelectorAll(i)),e,t);const l=new MutationObserver((n=>{const o=[],l=Array.from(a.querySelectorAll(i));for(const e of n){const t=Array.from(e.addedNodes).filter((e=>(0,s.C)(e,"HTMLStyleElement")));for(const e of t){const t=l.find((t=>t.isSameNode(e)));t&&o.push(t)}}o.length&&r(o,e,t)}));l.observe(a.head,{childList:!0,subtree:!0});const d=n.nr.getInstance().onInsertRule((()=>{!function(e,t){var i,n;if(e.length)for(const s of e){const e=t.head.querySelector(`style[data-bind-id="${s.dataset.bindId}"]`);if((null===(i=s.sheet)||void 0===i?void 0:i.cssRules.length)&&(null===(n=null==e?void 0:e.sheet)||void 0===n?void 0:n.cssRules.length))for(let t=e.sheet.cssRules.length;t<s.sheet.cssRules.length;t++){const i=s.sheet.cssRules.item(t);i&&e.sheet.insertRule(i.cssText,t)}}}(Array.from(a.querySelectorAll("style[data-bind-id]")),e)}));return()=>{l.disconnect(),d()}}},34645:(e,t,i)=>{if(i.d(t,{WH:()=>r}),2063!=i.j)var n=i(82479);const s='style[data-merge-styles="true"], style[data-make-styles-bucket], style[data-load-themed-styles="true"], style#ms-prediction-style';function o(e,t,i,n){var s,o,r,a;const l=null!=n?n:Array.from(e.querySelectorAll(t)),d=Array.from(i.querySelectorAll(t));for(const e of d)(null===(s=e.originalElement)||void 0===s?void 0:s.isConnected)||(e.originalElement=void 0,e.remove());for(const e of l)if(null===(o=e.sheet)||void 0===o?void 0:o.cssRules.length){const t=d.find((t=>t.originalElement===e));if(null===(r=null==t?void 0:t.sheet)||void 0===r?void 0:r.cssRules.length)for(let i=t.sheet.cssRules.length;i<e.sheet.cssRules.length;i++){const n=e.sheet.cssRules.item(i);n&&t.sheet.insertRule(n.cssText,i)}else{t&&(t.originalElement=void 0,t.remove());const n=i.ownerDocument.createElement("style");n.originalElement=e;for(const t of Array.from(e.attributes))t.nodeValue&&n.setAttribute(t.nodeName,t.nodeValue);i.appendChild(n);for(let t=0;t<e.sheet.cssRules.length;t++){const i=e.sheet.cssRules.item(t);i&&(null===(a=n.sheet)||void 0===a||a.insertRule(i.cssText,t))}}}}function r(e,t=s,i=document){o(i,t,e);const r=new MutationObserver((n=>{const s=[];for(const e of n)s.push(...Array.from(e.addedNodes).concat(Array.from(e.removedNodes)).concat(Array.from([e.target])).map((e=>{var t;return"STYLE"===e.nodeName?e:"STYLE"===(null===(t=e.parentElement)||void 0===t?void 0:t.nodeName)?e.parentElement:void 0})).filter((e=>!!e)));s.length&&o(i,t,e,s)})),a=n.nr.getInstance().onInsertRule((()=>{o(i,t,e)}));return r.observe(i.head,{childList:!0,subtree:!0,attributes:!0}),()=>{a(),r.disconnect();const i=Array.from(e.querySelectorAll(t));for(const e of i)e.originalElement&&(e.originalElement=void 0,e.remove());for(const t of Array.from(e.childNodes))t.originalElement&&(t.originalElement=void 0,t.remove())}}},15108:(e,t,i)=>{i.d(t,{S:()=>n});const n=({topicIds:e,topicNames:t,highlightedText:i,hostMetadata:n,requestId:s,source:o,traceId:r})=>{const a=`&body=${encodeURIComponent(`Tell us about your experience with this topic suggestion. Was the suggestion accurate or helpful?\n    \n\n\n\nEngineering notes:\n_______________________________\n\n    TopicIds: ${e}\n\n    TopicNames: ${t}\n\n    HighlightedText: ${i}\n\n    HostMetadata: ${n}\n\n    KMAPIRequestId: ${s}\n\n    Source: ${o}\n\n    TraceId: ${r}\n_______________________________\n`)}`;return"mailto:projecthedleyfeedback@service.microsoft.com?subject=Viva Topics Editor Suggestion Feedback"+encodeURIComponent(": "+i)+a}},45331:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(79490),s=i(29906);let o=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map}handleApplyCritiqueSuggestion(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyCritiqueSuggestion(e,t,i,n){const s=this._applyHandlerMap.get(t.typeId);return!!s&&s(e,t,i,n)}handleIgnoreCritiqueSuggestion(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreCritiqueSuggestion(e,t){const i=this._ignoreHandlerMap.get(t.typeId);return!!i&&i(e,t)}};o=(0,n.__decorate)([(0,s._)()],o)},33113:(e,t,i)=>{i.d(t,{r:()=>o});var n=i(79490),s=i(29906);let o=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map,this._ignoreAllHandlerMap=new Map,this._disableHandlerMap=new Map}handleApplyFlag(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyFlag(e,t,i,n){const s=this._applyHandlerMap.get(t.typeId);return!!s&&s(e,t,i,n)}handleIgnoreFlag(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreFlag(e,t){const i=this._ignoreHandlerMap.get(t.typeId);return!!i&&i(e,t)}handleIgnoreAllOfFlag(e,t){return this._ignoreAllHandlerMap.set(e,t),()=>this._ignoreAllHandlerMap.delete(e)}onIgnoreAllOfFlag(e,t){const i=this._ignoreAllHandlerMap.get(t.typeId);return!!i&&i(e,t)}handleDisableFlag(e,t){return this._disableHandlerMap.set(e,t),()=>this._disableHandlerMap.delete(e)}onDisableFlag(e,t){const i=this._disableHandlerMap.get(t.typeId);return!!i&&i(e,t)}};o=(0,n.__decorate)([(0,s._)()],o)},55689:(e,t,i)=>{i.d(t,{l:()=>p});var n=i(79490),s=i(76778),o=i(13290),r=i(79343),a=i(10138),l=i(30095),d=i(23943),c=i(29906),u=i(66008),h=i(27603),g=i(83010);let p=class{constructor(e,t,i,n){this._hostEmitters=e,this._critiqueStore=t,this._proofingDom=i,this._logger=n,this.initialize=async()=>{for(const e of this._hostEmitters)e.on(s.pD.hostModelCritiqueAction,this.onHostModelCritiqueActionEvent)},this.shutDown=()=>{},this.onHostModelCritiqueActionEvent=e=>{if(!e.message.critiqueInfo.nodeId)return void this._logger.log(523871251,o.q.Error,`IHostModelCritiqueAction message: Received undefined args. ActionType:${e.message.actionType}`);let t=this._proofingDom.findTileNode(e.message.critiqueInfo.nodeId);if(!t){const i=this._proofingDom.findParagraphNode(e.message.critiqueInfo.nodeId);if(!(null==i?void 0:i.parent))return void this._logger.log(523896789,o.q.Error,"CritiqueActionEventHandler: Received event args with unknown node id.");t=i.parent}if(this._critiqueStore)switch(e.message.actionType){case r.$w.IgnoreOnce:case r.$w.ApplySuggestion:this._critiqueStore.removeCritique(e.message.critiqueInfo.traceId,e.message.critiqueInfo.nodeId);break;case r.$w.DisableCritiqueType:break;case r.$w.IgnoreAll:if(!e.message.critiqueInfo.typeId){this._logger.log(507574115,o.q.Error,"critique is missing typeId");break}if(!e.message.critiqueInfo.textInContext){this._logger.log(507574098,o.q.Error,"critique is missing textInContext");break}this._critiqueStore.removeAllCritiquesOfTypeAndText(e.message.critiqueInfo.typeId,e.message.critiqueInfo.textInContext);break;default:this._logger.log(523896792,o.q.Error,"CritiqueActionEventHandler: Received unexpected actionType.")}else this._logger.log(523896791,o.q.Error,"CritiqueActionEventHandler: No critique store is available.")}}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.t)(s.zJ)),(0,n.__param)(1,(0,h.l)()),(0,n.__param)(1,(0,g.W)(l.$)),(0,n.__param)(2,(0,g.W)(d.w)),(0,n.__param)(3,(0,g.W)(a.g))],p)},77247:(e,t,i)=>{i.d(t,{$:()=>f,s:()=>m});var n=i(79490),s=i(94526),o=i(53861),r=i(25530),a=i(39847),l=i(754),d=i(23943),c=i(29583),u=i(76729),h=i(29906),g=i(83010),p=i(27603);const m=(0,u.f)("ICritiqueRangeBuilder");let f=class{constructor(e,t,i){this._tileContent=e,this._proofingDom=t,this._tileNodeTraverser=i,this.getCritiqueRangeAcrossTileNodes=e=>{const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!t)return Promise.resolve(void 0);let i;return i=e.endNode?this.getParagraphNodeAndOffset(e.endNode.nodeId,e.endNode.end):this.getParagraphNodeAndOffset(e.nodeId,e.length),i?this.getRangeAcrossTileNodes(t.paragraphNode,i.paragraphNode,t.offset,i.offset):Promise.resolve(void 0)},this.getParagraphNodeAndOffset=(e,t)=>{const i=this._proofingDom.findParagraphNode(e);if(i)return{paragraphNode:i,offset:t};const n=this._proofingDom.findTileNode(e);if(!(null==n?void 0:n.children))return;let o;for(const e of n.children)(0,s.l)(e)&&t>=e.element.offset&&t<e.element.offset+e.element.span&&(o=e);return o?{paragraphNode:o,offset:t-o.element.offset}:void 0},this.getRangeAcrossTileNodes=async(e,t,i=0,n=-1)=>{let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let r=null;if(r="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,s.l)(o)&&(0,s.l)(r)){const e=await this._tileContent.getNodeInsertionPosition(o.parent,o.element.offset+i,!0),t=await this._tileContent.getNodeInsertionPosition(r.parent,r.element.offset+(-1===n?r.element.span:n),!1);if(!(null==e?void 0:e.startContainer.ownerDocument)||!(null==t?void 0:t.endContainer.ownerDocument)||e.startContainer.ownerDocument!==t.endContainer.ownerDocument)return;const s=e.startContainer.ownerDocument.createRange();return s.setStart(e.startContainer,e.startOffset),s.setEnd(t.endContainer,t.endOffset),s}},this.ensureNoLeadingOrTrailingWhitespace=e=>{if(e.endNode)return e;const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!(null==t?void 0:t.paragraphNode.element)||!e.nodeId)return e;const i=t.offset-t.paragraphNode.element.offset,n=this._paragraphTextExtractor.getTextBetween(e.nodeId,e.nodeId,i,i+e.length);if(!n)return e;let s=e.start,o=e.length;const r=n.trimStart(),a=n.trimEnd();return n.length!==r.length&&(s+=n.length-r.length,o-=n.length-r.length),n.length!==a.length&&(o-=n.length-a.length),Object.assign(Object.assign({},e),{start:s,length:o})},this._paragraphTextExtractor=new o.o(this._proofingDom,this._tileNodeTraverser)}async getCritiqueRanges(e,t){var i,n,s;const o=new Map;for(const t of e){const e=t.nodeId?this._proofingDom.findNode(t.nodeId):t.tileId?this._proofingDom.findNode(t.tileId.nodeId):null,s=(null==e?void 0:e.nodeType)===r.Z.ParagraphNode?e.parent:(null==e?void 0:e.nodeType)===r.Z.TileNode?e:void 0;if((0,a.$)(s)){const e=null!==(n=null===(i=o.get(s.id))||void 0===i?void 0:i[0])&&void 0!==n?n:[];e.push(t),o.set(s.id,[e,s])}}const l=new Map;for(const[e,i]of o.values()){const n=[],o=[];for(const t of e)if(t.endNode){const e=this._proofingDom.findParagraphNode(t.endNode.nodeId);(null===(s=null==e?void 0:e.parent)||void 0===s?void 0:s.id)!==i.id?o.push(t):n.push(t)}else n.push(t);if(n.length>0){const e=await this._tileContent.getCritiqueRanges(i,t,n.map(this.ensureNoLeadingOrTrailingWhitespace));for(const t of e)l.set(n.find((e=>e.traceId===t.critique.traceId)),t.range)}if(o.length>0)for(const e of o)l.set(e,await this.getCritiqueRangeAcrossTileNodes(this.ensureNoLeadingOrTrailingWhitespace(e)))}return e.map((e=>({critique:e,range:l.get(e)})))}};f=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(l.d)),(0,n.__param)(1,(0,g.W)(d.w)),(0,n.__param)(2,(0,g.W)(c.M)),(0,n.__param)(2,(0,p.l)())],f)},43983:(e,t,i)=>{i.d(t,{U:()=>E});var n=i(79490),s=i(30095),o=i(59556),r=i(18104);var a=i(65099),l=i(79343),d=i(81166);class c extends o.z{constructor(e,t,i){super(),this._settings=e,this._logger=t,this._fre=i,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this._wordBoundaries=new Map,this.removeCritique=(e,t,i)=>{var n,s;const o=null==i?void 0:i(t);if(!o)return void(null===(n=this._logger)||void 0===n||n.error(507900049,"removeCritique - Unable to find tileNode"));const r=this._critiquesByNode.get(o),a=r?this.findCritiqueInCritiques(r,e):void 0;r&&a?(this.removeKnownCritique(a,r,a),this.dispatchCritiquesForNode(o,"Update")):null===(s=this._logger)||void 0===s||s.error(507900048,"removeCritique - Unable to find critique on tile")},this.getCritique=(e,t,i)=>{var n;const s=null==i?void 0:i(t);if(!s)return void(null===(n=this._logger)||void 0===n||n.error(507900049,"getCritique - Unable to find tileNode"));const o=this._critiquesByNode.get(s);return o?this.findCritiqueInCritiques(o,e):void 0},this.dispatchCritiquesForNode=(e,t)=>{const i=this._critiquesByNode.get(e),n=i?this.getCritiquesToDispatch(i):[];this.publishEvent("dispatchCritiques",{critiques:n,nodeId:e,messageType:r.G.NewData,reason:t})},this.removeAllCritiquesOfType=e=>{for(const t of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeFromNode(t,e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{for(const i of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeAndTextFromNode(i,e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{const i=this.getCritiques(e);if(!i)return;const n=[];for(const e of i.critiques.values())e.typeId===t&&n.push(e);if(n.length>0){for(const e of n)this.removeSpecifiedCritique(e,i.critiques);this.dispatchCritiquesForNode(i.tileId,"Clear")}},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,i)=>{const n=this.getCritiques(e);if(!n)return;const s=[];for(const e of n.critiques.values())e.typeId===t&&e.textInContext===i&&s.push(e);if(s.length>0){for(const e of s)this.removeSpecifiedCritique(e,n.critiques);this.dispatchCritiquesForNode(n.tileId,"Clear")}},this.removeSpecifiedCritique=(e,t)=>{for(const i of t.values())if(i.traceId===e.traceId)return this.removeKnownCritique(e,t,i),!0;return!1},this.removeKnownCritique=(e,t,i)=>{(function(e){return"isFlagCritique"in e})(e)&&e.isIgnored||t.delete(i),this.publishEvent("removeCritiques",{critiques:new Set([i])})},this.getOverlappingCritiques=(e,t)=>{var i;const n=[];let s=1/0,o=!1,r=!1;for(const d of e)d.traceId!==t.traceId&&(0,a.tw)(d,t)&&(s=Math.min(s,d.priority),o=o||d.typeId===l.L9.TopicSuggestion,r=r||null!==(i=d.isIgnored)&&void 0!==i&&i,n.push(d));return{shouldOverrideCritiques:!r&&(t.typeId===l.L9.TopicSuggestion||!o&&s>=t.priority),critiques:n}},this.getCritiquesToDispatch=e=>{var t;const i=Array.from(e.values()).filter((e=>e.isVisible&&!e.isIgnored));return null===(t=this._fre)||void 0===t||t.setFor(i),i},this.findCritiqueInCritiques=(e,t)=>{for(const i of e.values())if(i.traceId===t)return i}}clearNode(e){let t=!1;const i=this._critiquesByNode.get(e);i&&(this._critiquesByNode.delete(e),this._wordBoundaries.delete(e),this.publishEvent("removeCritiques",{critiques:i}),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),t=!0),t&&this.publishEvent("dispatchCritiques",{critiques:[],nodeId:e,messageType:r.G.RemoveData,reason:"Clear"})}resetNode(e){this.clearNode(e),this.updateNode([],e,0)}getAllCritiques(){const e=[];for(const t of this._critiquesByNode.keys()){const i=this.getCritiques(t);i&&e.push(i)}return e}getCritiques(e){var t;const i=this._critiquesByNode.get(e);if(i){return{critiques:i,tileId:e,tileVersion:null!==(t=this._latestNodeVersion.get(e))&&void 0!==t?t:0}}}setWordBoundaries(e,t,i,n){var s,o;let r=this._wordBoundaries.get(e);r||(r=new Map,this._wordBoundaries.set(e,r));const a=null!==(o=null===(s=r.get(t.id))||void 0===s?void 0:s.length)&&void 0!==o?o:0,l=t.range.span-a;if(r.set(t.id,{offset:t.range.offset,length:n&&a?a:t.range.span,boundaries:i}),!n)for(const e of r.values())e.offset>t.range.offset&&(e.offset+=l)}removeWordBoundariesByPosition(e,t,i){const n=this._wordBoundaries.get(e);if(!n)return;const s=t+i-1;for(const[e,o]of n)if(o.offset<t){const e=o.offset+o.length-1;e>t&&(o.length-=e-t)}else o.offset>=t&&o.offset+o.length-1<=s?n.delete(e):o.offset>=t&&o.offset<=s?(o.length-=t+i-o.offset,o.offset=t):o.offset-=i}updateNode(e,t,i,n=!1){var o,r;i>=(null!==(o=this._latestNodeVersion.get(t))&&void 0!==o?o:0)&&this._latestNodeVersion.set(t,i);const a=this._critiquesByNode.get(t),l=this._wordBoundaries.get(t);if(a){if(n||(null!==(r=this._settings.enableDispatchCritiquesOnEmptyDiffs)&&void 0!==r?r:e.length>0)){for(const t of e){const e=this.getOverlappingCritiques(a,t.critique);switch(t.critiqueDiffType){case s.K.Add:case s.K.Update:if(e.critiques.length){if(e.shouldOverrideCritiques){for(const t of e.critiques)this.removeSpecifiedCritique(t,a);this.isNotPartialCritique(t.critique,l)&&a.add(t.critique)}}else this.isNotPartialCritique(t.critique,l)&&a.add(t.critique);break;case s.K.Delete:this.removeSpecifiedCritique(t.critique,a);case s.K.Move:}}const i=[];if(i.push(t),c=e,(0,d.A)(c)){const e=function(e,t){const i=[];return i.concat((0,d.o)(e,t)),i}(this._critiquesByNode,!!this._settings.enableStealthSquiggles);for(const t of e)t.nodeId&&i.push(t.nodeId)}for(const e of i)this.dispatchCritiquesForNode(e,"Update")}}else this._critiquesByNode.set(t,new Set);var c}isNotPartialCritique(e,t){if(!0===this._settings.disableWordBoundaries||!t||0===t.size)return!0;for(const i of t.values())if(e.start>=i.offset&&e.start<i.offset+i.length){const t=i.offset;for(const n of i.boundaries){const i=n.start+t,s=n.end+t+1,o=s-i;if(e.start>=i&&e.start+e.length<=s&&e.length<o)return!1}return!0}return!0}setAugLoopProcessingHandler(e){}}const u=(0,i(76729).f)("ICritiquesFre");var h=i(95523),g=i(76778),p=i(11804),m=i(95834),f=i(10138),v=i(25530),_=i(71417),y=i(23943),I=i(67165),C=i(87615),S=i(29906),b=i(83010),T=i(27603);let E=class{constructor(e,t,i,n,s,o,r,a,l){this._hostSettings=e,this._upsellStore=t,this._proofingEmitter=i,this._hostEmitter=n,this._proofingDom=s,this._logger=o,this._indicatorStore=r,this._fre=a,this._sessionTelemetryTracker=l,this.removeCritique=(e,t)=>{this._critiqueStoreCore.removeCritique(e,t,this.nodeIdFinder)},this.getCritique=(e,t)=>this._critiqueStoreCore.getCritique(e,t,this.nodeIdFinder),this.nodeIdFinder=e=>{var t;if(!e)return;const i=this._proofingDom.findNode(e);return(null==i?void 0:i.nodeType)===v.Z.TileNode?i.id:(null==i?void 0:i.nodeType)===v.Z.ParagraphNode?null===(t=i.parent)||void 0===t?void 0:t.id:void 0},this.removeAllCritiquesOfType=e=>{this._critiqueStoreCore.removeAllCritiquesOfType(e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndText(e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeFromNode(e,t)},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,i)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndTextFromNode(e,t,i)},this.onDispatchCritiques=({critiques:e,nodeId:t,messageType:i,reason:n})=>{var s;const o=this._proofingDom.findTileNode(t);if(o){if("VisualStateChange"===n&&0===e.length)return;this._proofingEmitter.emit("squiggleDataEvent",{messageType:i,data:{critiquesToElementsMap:[{elementId:t,element:o.element,critiques:e.map(h.OE)}],isVisualStateChange:"VisualStateChange"===n}}),null===(s=this._sessionTelemetryTracker)||void 0===s||s.update(e,t)}},this.onRemoveCritiques=e=>{var t,i;for(const n of e.critiques.values())null===(t=this._upsellStore)||void 0===t||t.removePremiumCritique(n),null===(i=this._indicatorStore)||void 0===i||i.removePaneCritique(n.traceId,n.categoryTitle)},this._critiqueStoreCore=new c(this._hostSettings,this._logger,this._fre),this._critiqueStoreCore.subscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.subscribe("removeCritiques",this.onRemoveCritiques)}get core(){return this._critiqueStoreCore}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",(e=>{if(e.proofingLanguagesChanged&&!this.augLoopProcessingHandler)for(const e of this._proofingDom.tileNodes)this.resetNode(e.id)})),this._hostEmitter.on(g.pD.hostModelTileStateReset,(e=>{this.augLoopProcessingHandler||this.resetNode(e.message)})),this._hostEmitter.on(g.pD.hostModelVisualStateChange,(e=>{e.message.created&&!this.augLoopProcessingHandler&&this._critiqueStoreCore.dispatchCritiquesForNode(e.message.tileId,"VisualStateChange")}))}shutDown(){this._proofingEmitter.off("proofingLanguageChanged"),this._hostEmitter.off(g.pD.hostModelTileStateReset),this._hostEmitter.off(g.pD.hostModelVisualStateChange),this._critiqueStoreCore.unsubscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.unsubscribe("removeCritiques",this.onRemoveCritiques)}clearNode(e){this.augLoopProcessingHandler?this.augLoopProcessingHandler.clearNode(e):this._critiqueStoreCore.clearNode(e)}resetNode(e){this.augLoopProcessingHandler||this._critiqueStoreCore.resetNode(e)}getAllCritiques(){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getAllCritiques():this._critiqueStoreCore.getAllCritiques()}getCritiques(e){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getCritiques(e):this._critiqueStoreCore.getCritiques(e)}updateNode(e,t,i,n=!1){this.augLoopProcessingHandler?this.augLoopProcessingHandler.updateNode(e,t,i,n):this._critiqueStoreCore.updateNode(e,t,i,n)}setAugLoopProcessingHandler(e){this.augLoopProcessingHandler=e}};E=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.W)(p.n)),(0,n.__param)(1,(0,T.l)()),(0,n.__param)(1,(0,b.W)(_.Ey)),(0,n.__param)(2,(0,b.W)(m.o)),(0,n.__param)(3,(0,b.W)(g.M5)),(0,n.__param)(4,(0,b.W)(y.w)),(0,n.__param)(5,(0,b.W)(f.g)),(0,n.__param)(6,(0,T.l)()),(0,n.__param)(6,(0,b.W)(I.y)),(0,n.__param)(7,(0,T.l)()),(0,n.__param)(7,(0,b.W)(u)),(0,n.__param)(8,(0,T.l)()),(0,n.__param)(8,(0,b.W)(C.H))],E)},69991:(e,t,i)=>{i.d(t,{SF:()=>L});var n=i(79490),s=i(89266),o=i(94526),r=i(90014),a=i(23943),l=i(15168),d=i(65099),c=i(10138),u=i(11804),h=i(2915),g=i(77322),p=i(55972),m=i(10219),f=i(65798),v=i(79343),_=i(81628),y=i(80232),I=i(49243);class C{constructor(e){this.paragraphNode=e}get id(){return this.paragraphNode.id}get range(){var e,t,i,n,s,o,r;return{offset:null!==(t=null===(e=this.paragraphNode.element)||void 0===e?void 0:e.offset)&&void 0!==t?t:0,span:null!==(n=null===(i=this.paragraphNode.element)||void 0===i?void 0:i.span)&&void 0!==n?n:0,textUnit:null===(s=this.paragraphNode.element)||void 0===s?void 0:s.textUnit,validEndBoundary:null===(o=this.paragraphNode.element)||void 0===o?void 0:o.validEndBoundary,enforcedCompleteTileTextUnit:null===(r=this.paragraphNode.element)||void 0===r?void 0:r.enforcedCompleteTileTextUnit}}}class S{constructor(e={enablePhraseTextUnitClientSide:!0,ignoreNonLatinZeroSquiggles:!0,enableSquigglesOnlyOnWholeWords:!0}){this.settings=e}isValid(e,t,i,n,s){var o,r,a,l;if(!e.nodeId||!t)return!1;const d=new y.a;if(this.settings.enablePhraseTextUnitClientSide&&e.priority!==v.bx.High&&!(0,v.oe)(e.typeId)&&t.range.textUnit!==f.fT.Sentence&&t.range.textUnit!==f.fT.Paragraph)return!1;if(this.settings.ignoreNonLatinZeroSquiggles&&(!e.suggestions.length||0===e.suggestions[0].action)&&(0,I.c)(e.textInContext))return!1;null==s||s(e);let c=e.textInContext;c&&(c=c.replace(/\u00A0/g," "));const u=t.range.offset,h=n(e);if(c!==h)return!1;if((e.priority===v.bx.High||e.priority===v.bx.Informational)&&(void 0===e.endNode||e.endNode.nodeId===t.id)&&this.settings.enableSquigglesOnlyOnWholeWords){const t=i;if(!t)return!1;const n=e.start-u,s=n+e.length,c=s===t.length;let[g,p]=function(e,t,i,n,s){if(!e)return["",0];let o=0;(t===n||t+1===n&&_.Yv(e.charCodeAt(t+1)))&&(o+=1);i===s&&(o+=1);return[e.substring(t,i),o]}(t,null!==(r=null===(o=d.getBackwardBreak(t,n+1))||void 0===o?void 0:o.cp)&&void 0!==r?r:0,null!==(l=null===(a=d.getForwardBreak(t,s-1))||void 0===a?void 0:a.cp)&&void 0!==l?l:s,n,s);if(h&&!c&&""===h[h.length-1]&&(p+=1),_._1(g))return!0;if(_.tF(g))return!0;return p===2}return!0}}var b=i(29906),T=i(83010),E=i(27603),N=i(30095),x=i(68514);function w(e,t){var i;const n=e?t.findParagraphNode(e):null;return{paragraphNode:n,htmlElement:null===(i=null==n?void 0:n.parent)||void 0===i?void 0:i.element}}let L=class{constructor(e,t,i,n,s,o,r,a,l,d,c){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=i,this._hostSettings=n,this._proofingPersistedStore=s,this._userInfoStrategy=o,this._e2eMetric=r,this._featureFlagReader=a,this._proofingDom=l,this._paragraphTextExtractor=d,this._autoCorrectionBroker=c,this._websiteProvedOnce=!1}onEvent(e){var t,i;const{added:n,removedIds:s,source:o,tileId:r,tileVersion:a}=e,{paragraphNode:l}=w(r,this._proofingDom),c=null!==(i=null===(t=null==l?void 0:l.parent)||void 0===t?void 0:t.id)&&void 0!==i?i:r,u=this.onCommonCritiquesRemoved(s,o),h=n.filter((e=>{const t=u.findIndex((t=>(0,d.gS)(e,t.critique)));return!(t>=0)||(u.splice(t,1),!1)}));u.push(...this.onCommonCritiquesAdded(h,r)),u.length>0&&this._critiqueStore.updateNode(u,c,a),this._e2eMetric.commitEntry(`${r}--${a}`)}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,(0,s.Q)(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}onCommonCritiquesAdded(e,t){var i,n;if(0===e.length)return[];const{paragraphNode:s}=w(t,this._proofingDom),r=null!==(n=null===(i=null==s?void 0:s.parent)||void 0===i?void 0:i.id)&&void 0!==n?n:t,a=new S({enablePhraseTextUnitClientSide:this._featureFlagReader.flags.enablePhraseTextUnitClientSide,ignoreNonLatinZeroSquiggles:!!this._hostSettings.ignoreNonLatinZeroSquiggles,enableSquigglesOnlyOnWholeWords:this._featureFlagReader.flags.enableSquigglesOnlyOnWholeWords}),l=this._paragraphTextExtractor.getParagraphText(s),c=function(e,t,i,n,s,o,r,a,l,c,u){if(0===e.length)return[];const h=r.getCritiques(i);if(!h)return[];const g=new Map,p=new Set;for(const e of h.critiques)l(e)&&g.set(e.start,e);const m=[];for(const i of e)if(i&&u.isValid(i,t,n,s,a)){const e=g.get(i.start);if(e&&(0,d.gS)(e,i)){e.annotationId=i.annotationId,m.push({critique:e,critiqueDiffType:N.K.Update}),p.add(i.start);continue}if(!o)for(const e of g.values())(0,d.tw)(e,i)&&m.push({critique:e,critiqueDiffType:N.K.Delete});c.applyFilters([i]),m.push({critique:i,critiqueDiffType:N.K.Add})}if(o)for(const e of g.values())p.has(e.start)||m.push({critique:e,critiqueDiffType:N.K.Delete});return m}(e,null===s?null:new C(s),r,l,(e=>{var t,i;const n=null!==(i=null===(t=null==s?void 0:s.element)||void 0===t?void 0:t.offset)&&void 0!==i?i:0;let o="";return o=void 0===e.endNode?this._paragraphTextExtractor.getTextBetween(s,s,e.start-n,e.start-n+e.length):this._paragraphTextExtractor.getTextBetween(s,e.endNode.nodeId,e.start-n,e.endNode.end),o}),this._featureFlagReader.flags.enableForceClearCritiques,this._critiqueStore,(e=>{(0,o.l)(s)&&(e.start=e.start+s.element.offset)}),(e=>((e,t)=>!!(0,o.l)(t)&&e.nodeId!==t.id&&!(e.start>=t.element.offset+t.element.span||t.element.offset>=e.start+e.length))(e,s)),this._critiqueFilterer,a);return c.length>0&&this.logWebsiteProvedOnce(),c}onCommonCritiquesRemoved(e,t){return function(e,t,i,n){if(0===e.length)return[];const s=i.getAllCritiques().reduce(((e,t)=>{for(const i of t.critiques)e.set(i.annotationId,{critique:i,tileId:t.tileId,tileVersion:t.tileVersion});return e}),new Map),o=[];for(const i of e){const e=s.get(i);if(e){if("Augloop"===t&&(null==n?void 0:n.getHasAutoCorrectionBeenApplied(e.critique)))continue;o.push({critique:e.critique,critiqueDiffType:N.K.Delete})}}return o}(e,t,this._critiqueStore,this._autoCorrectionBroker)}};L=(0,n.__decorate)([(0,b._)(),(0,n.__param)(0,(0,T.W)(N.$)),(0,n.__param)(1,(0,T.W)(r.B)),(0,n.__param)(2,(0,T.W)(c.g)),(0,n.__param)(3,(0,T.W)(u.n)),(0,n.__param)(4,(0,T.W)(h.K)),(0,n.__param)(5,(0,T.W)(g.e)),(0,n.__param)(6,(0,T.W)(p.m)),(0,n.__param)(7,(0,T.W)(m.c)),(0,n.__param)(8,(0,T.W)(a.w)),(0,n.__param)(9,(0,T.W)(l.b)),(0,n.__param)(10,(0,E.l)()),(0,n.__param)(10,(0,T.W)(x.m))],L)},60996:(e,t,i)=>{i.d(t,{o:()=>I});var n=i(79490),s=i(13290),o=i(71924),r=i(18104),a=i(76778),l=i(95834),d=i(11804),c=i(10138),u=i(69811),h=i(29906),g=i(66008),p=i(83010),m=i(69991),f=i(47957),v=i(652),_=i(81103),y=i(51007);let I=class{constructor(e,t,i,n,a,l,d,c,h){this._hostEmitters=e,this._proofingEmitter=t,this._critiquesEventHandler=i,this._filteringEventHandler=n,this._nodeEventHandler=a,this._spanEventHandler=l,this._formattingEventHandler=d,this._hostSettings=c,this._logger=h,this.shutDown=()=>{this._logger.log(556372812,s.q.Debug,"Shutting down EventHub.")},this.onFilterChangedEvent=e=>{this._filteringEventHandler.onEvent({eventType:e.messageType})},this.onHostModelCritiquesEvent=e=>{const t={added:e.data.critiquesAdded,removedIds:e.data.critiqueIdsRemoved,eventType:e.messageType,source:e.data.source,tileId:e.data.tileId,tileVersion:e.data.tileVersion};this._critiquesEventHandler.onEvent(t)},this.onHostModelDeltaEvent=e=>{const{delta:t,deletedOrReplacedCharacters:i,sourceType:n,tileId:s,tileVersion:a}=e.message;if(!0===this._hostSettings.sdkV2Enabled||n!==o.pf.TileNode)return;const l={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===u.WI.Add?r.G.NewData:t.deltaType===u.WI.Delete?r.G.RemoveData:r.G.ChangeData,tileId:s,tileVersion:a,deletedOrReplacedCharacters:i};this._spanEventHandler.onEvent(l)},this.onHostModelFormattingDelta=e=>{const t=e.message.delta,i=e.message.tileId,n=e.message.tileVersion,s={formattedRanges:t.formattedRanges,eventType:t.deltaType===u.WI.Add?r.G.NewData:t.deltaType===u.WI.Delete?r.G.RemoveData:r.G.ChangeData,tileId:i,tileVersion:n};this._formattingEventHandler.onEvent(s)},this.onHostModelTextTileEvent=e=>{if(!0===this._hostSettings.sdkV2Enabled)return;const t=e.data.tileId,i=e.data.tileVersion,n={eventType:e.messageType,tileId:t,tileVersion:i};this._nodeEventHandler.onEvent(n)},this.onClearCritiquesForNode=e=>{const t={eventType:r.G.RemoveData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)},this.onRestoreNodeForCritiqueStore=e=>{const t={eventType:r.G.NewData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)}}async initialize(){if(this._logger.log(556372811,s.q.Debug,"Initializing EventHub."),this._hostSettings.enableOrchestration){this._proofingEmitter.on("enabledCritiqueTypesChanged",(e=>this.filterMessageType("enabledCritiqueTypesChanged",e,this.onFilterChangedEvent,void 0,r.G.ChangeData)));for(const e of["eccStateChanged","wordDictionaryEvent"])this._proofingEmitter.on(e,(t=>this.filterMessageType(e,t,this.onFilterChangedEvent,r.G.ChangeData)));for(const e of this._hostEmitters)e.on(a.pD.hostModelCritiques,(e=>this.filterMessageType("hostModelCritiques",e.message,this.onHostModelCritiquesEvent,void 0,r.G.ChangeData))),e.on(a.pD.hostModelFlags,(e=>this.filterMessageType("hostModelFlags",e.message,this.onHostModelCritiquesEvent,void 0,r.G.ChangeData))),e.on(a.pD.hostModelTextTile,(e=>this.filterMessageType("hostModelTextTile",e.message,this.onHostModelTextTileEvent,r.G.ChangeData))),e.on(a.pD.hostModelDelta,this.onHostModelDeltaEvent),e.on(a.pD.clearCritiquesForNode,this.onClearCritiquesForNode),e.on(a.pD.restoreNodeForCritiqueStore,this.onRestoreNodeForCritiqueStore),e.on(a.pD.hostModelFormattingDelta,this.onHostModelFormattingDelta)}}filterMessageType(e,t,i,n,o){o&&t.messageType!==o||n&&t.messageType===n?this._logger.log(556372815,s.q.Warn,`${e} message: Unexpected MessageType.`):i(t)}};I=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.t)(a.zJ)),(0,n.__param)(1,(0,p.W)(l.o)),(0,n.__param)(2,(0,p.W)(m.SF)),(0,n.__param)(3,(0,p.W)(f.F)),(0,n.__param)(4,(0,p.W)(_.l)),(0,n.__param)(5,(0,p.W)(y.bz)),(0,n.__param)(6,(0,p.W)(v.o)),(0,n.__param)(7,(0,p.W)(d.n)),(0,n.__param)(8,(0,p.W)(c.g))],I)},47957:(e,t,i)=>{i.d(t,{F:()=>c});var n=i(79490),s=i(90014),o=i(67165),r=i(29906),a=i(83010),l=i(27603),d=i(30095);let c=class{constructor(e,t,i){this._critiqueStore=e,this._critiqueFilterer=t,this._indicatorStore=i}onEvent(e){var t;const i=this._critiqueStore.getAllCritiques();null===(t=this._indicatorStore)||void 0===t||t.clearPaneCritiques();for(const e of i){const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map((e=>({critique:e,critiqueDiffType:d.K.Update})));t.length>0&&this._critiqueStore.updateNode(t,e.tileId,e.tileVersion)}}};c=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(d.$)),(0,n.__param)(1,(0,a.W)(s.B)),(0,n.__param)(2,(0,l.l)()),(0,n.__param)(2,(0,a.W)(o.y))],c)},652:(e,t,i)=>{i.d(t,{o:()=>l});var n=i(79490),s=i(30095),o=i(29906),r=i(83010),a=i(66464);let l=class{constructor(e){this._critiqueStore=e}onEvent(e){const t=this._critiqueStore.getCritiques(e.tileId);t&&(0,a.d)(t,e.tileVersion)&&this._critiqueStore.updateNode([],e.tileId,e.tileVersion,!0)}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.$))],l)},93844:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(76729).f)("IApplyCritiqueSuggestionHandler")},91322:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(76729).f)("IApplyFlagHandler")},68514:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(76729).f)("IAutoCorrectionBroker")},30095:(e,t,i)=>{i.d(t,{$:()=>o,K:()=>n});var n,s=i(76729);!function(e){e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.Update=2]="Update",e[e.Delete=4]="Delete"}(n||(n={}));const o=(0,s.f)("ICritiqueStore")},81103:(e,t,i)=>{i.d(t,{l:()=>l});var n=i(79490),s=i(18104),o=i(29906),r=i(83010),a=i(30095);let l=class{constructor(e){this._critiqueStore=e}onEvent(e){switch(e.eventType){case s.G.NewData:this._critiqueStore.updateNode([],e.tileId,e.tileVersion);break;case s.G.RemoveData:this._critiqueStore.clearNode(e.tileId)}}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(a.$))],l)},51007:(e,t,i)=>{i.d(t,{bz:()=>y});var n=i(79490),s=i(18104),o=i(10219),r=i(10138);var a=i(81628),l=i(79343),d=i(29906),c=i(83010),u=i(27603),h=i(80232),g=i(66464),p=i(30095),m=i(68514),f=i(22696),v=i(3049),_=i(57595);let y=class{constructor(e,t,i,n,o){this._critiqueStore=e,this._featureFlagsReader=t,this._logger=i,this._wordDictionary=n,this._autoCorrectionBroker=o,this.calcLengths=e=>function(e,t,i,n=!1){var o;let r=null!=t?t:0,a=0;switch(i){case s.G.NewData:a=null!==(o=null==e?void 0:e.length)&&void 0!==o?o:r,n||(r=a);break;case s.G.RemoveData:a=-r;break;case s.G.ChangeData:a=e?e.length-r:a}return{length:r,lengthDiff:a}}(e.content,e.length,e.eventType,this._featureFlagsReader.flags.disableCalcLengthForAddDeltasInPresentation),this.deletedDiff=(e,t,i,n,o,r,a=!1)=>function(e,t,i,n,o,r,a=!1,d,c,u=!0){if(!t&&0===n&&!o)return;const h={offset:e.start,span:e.length},g={offset:i,span:n},m=(!I(t,u)||i===e.start)&&(i!==e.start+e.length||r!==s.G.RemoveData||void 0===o||!I(o,u))&&(a||i+n===e.start||i===e.start+e.length)&&function(e){return!(0,l.oe)(e.typeId)||e.typeId===l.L9.CIQFlag_DateEntityRecognition||e.typeId===l.L9.CIQFlag_PersonEntityRecognition||e.typeId===l.L9.HeadingDetection||e.typeId===l.L9.CIQFlag_TaskRecognition}(e);if(f=h,y=g,!(!f||!y||f.offset>=y.offset+y.span||y.offset>=f.offset+f.span)||m&&function(e,t){return!(!e||!t||e.offset!==t.offset+t.span&&t.offset!==e.offset+e.span)}(h,g)){if((0,v.A_)(e)){if(null==c?void 0:c.getAutoCorrectionIsBeingApplied(e))return;(0,_.yf)(e,d)}return{critique:e,critiqueDiffType:p.K.Delete}}var f,y;return}(e,t,i,n,o,r,a,this._wordDictionary,this._autoCorrectionBroker)}onEvent(e){var t,i;const n=this._critiqueStore.getCritiques(e.tileId);if(!n||!(0,g.d)(n,e.tileVersion))return;const{length:o,lengthDiff:r}=this.calcLengths(e),a=null!==(t=e.position)&&void 0!==t?t:0,l=[];for(const t of n.critiques){const n=this.deletedDiff(t,null!==(i=e.content)&&void 0!==i?i:"",a,o,e.deletedOrReplacedCharacters,e.eventType,e.eventType!==s.G.ChangeData);if(n)l.push(n);else if(t.start>=a&&0!==r){const e=t.start;t.start+=r,l.push({critique:t,critiqueDiffType:p.K.Move,oldStart:e})}}this._critiqueStore.updateNode(l,e.tileId,e.tileVersion)}};function I(e,t){return 1===e.length&&(a.xC(e.charCodeAt(0))||t&&(0,h.B)(e))}y=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(p.$)),(0,n.__param)(1,(0,c.W)(o.c)),(0,n.__param)(2,(0,c.W)(r.g)),(0,n.__param)(3,(0,u.l)()),(0,n.__param)(3,(0,c.W)(f.s)),(0,n.__param)(4,(0,u.l)()),(0,n.__param)(4,(0,c.W)(m.m))],y)},99186:(e,t,i)=>{i.d(t,{Q:()=>d});var n=i(79490),s=i(11864),o=i(87414),r=i(29906),a=i(27603),l=i(83010);let d=class{constructor(e){var t,i;this.themeStore=e,this.browserSupportsHighContrastMode=null!==(i=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"not all and (forced-colors), (forced-colors), not all and (-ms-high-contrast), (-ms-high-contrast)").matches)&&void 0!==i&&i}get enabled(){var e,t;return(null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme)===o.SV.highContrast||(null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,s.Rr.replace("@media ","")).matches)}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.l)()),(0,n.__param)(0,(0,l.W)(o.YQ))],d)},329:(e,t,i)=>{i.d(t,{P:()=>n});const n=(0,i(76729).f)("IHighContrastModeDetector")},941:(e,t,i)=>{i.d(t,{V:()=>y});var n=i(79490),s=i(59556),o=i(14775),r=i(91513),a=i(68794),l=i(70899),d=i(94453),c=i(2915),u=i(11804),h=i(40315),g=i(95834),p=i(19728),m=i(29906),f=i(83010),v=i(27603),_=i(18574);let y=class extends s.z{constructor(e,t,i,n,s,l){super(),this.languageInfoProvider=e,this.languageDetector=t,this.proofingStore=i,this.hostSettings=n,this.targetRenderElement=s,this.emitter=l,this._proofingLanguageDirCache={},this._defaultProofingLanguageDir=o.K3.auto,this._uxLanguageDir=o.K3.auto,this.updateProofingLanguageDir=e=>{this._defaultProofingLanguageDir=this.getLanguageDir(e)},this.updateUxLanguageDir=()=>{const e=this.languageDetector.getUILanguage();this._uxLanguageDir=this.getLanguageDir(e),this.publishEvent("stateUpdated",{uxLanguageDir:this.uxLanguageDir,optionsUxLanguageDir:this.optionsUxLanguageDir})},this.getLanguageDir=e=>{const t=this.languageInfoProvider.getLanguageInfo(e);return t?t.isRtl?o.K3.rtl:o.K3.ltr:o.K3.auto},(0,_.Gn)(this),this.updateUxLanguageDir(),this.proofingStore.read(r.l.ProofingLanguages).then((e=>this.updateProofingLanguageDir(a.I.getDefaultLanguageCode(e)))).catch((()=>{})),this.emitter&&this.emitter.on("proofingLanguageChanged",(async e=>{e.proofingLanguagesChanged&&this.updateProofingLanguageDir(e.data.defaultLanguageCode)}))}get uxLanguageDir(){return this.hostSettings.manageRtlInEditorUx?this._uxLanguageDir:o.K3.auto}get optionsUxLanguageDir(){return this._uxLanguageDir}isRtl(){var e,t;if(this.uxLanguageDir!==o.K3.auto)return this.uxLanguageDir===o.K3.rtl;const i=null===(e=this.targetRenderElement())||void 0===e?void 0:e.deref();return void 0!==i&&(null!==(t=i.ownerDocument.defaultView)&&void 0!==t?t:window).getComputedStyle(i).direction===o.K3.rtl}dir(){return this.isRtl()?"rtl":"ltr"}getProofingLanguageDir(e){if(!this.hostSettings.manageRtlForProofingLanguage)return o.K3.auto;if(!e)return this._defaultProofingLanguageDir;let t=this._proofingLanguageDirCache[e];return t||(t=this.getLanguageDir(e),this._proofingLanguageDirCache[e]=t),t}};(0,n.__decorate)([p.observable],y.prototype,"_uxLanguageDir",void 0),(0,n.__decorate)([p.computed],y.prototype,"uxLanguageDir",null),(0,n.__decorate)([p.action],y.prototype,"updateProofingLanguageDir",void 0),(0,n.__decorate)([p.action],y.prototype,"updateUxLanguageDir",void 0),y=(0,n.__decorate)([(0,m._)(),(0,n.__param)(0,(0,f.W)(l.d)),(0,n.__param)(1,(0,f.W)(d.v)),(0,n.__param)(2,(0,f.W)(c.K)),(0,n.__param)(3,(0,f.W)(u.n)),(0,n.__param)(4,(0,f.W)(h.oA)),(0,n.__param)(5,(0,v.l)()),(0,n.__param)(5,(0,f.W)(g.o))],y)},27745:(e,t,i)=>{if(i.d(t,{d:()=>l}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(52946);if(2063!=i.j)var o=i(85777);if(2063!=i.j)var r=i(32177);if(2063!=i.j)var a=i(46788);class l{get uniqueId(){return(0,n.z)(507918355)}configureRootServices(e){e.bind(s.m).to(o.h),e.bind(r.u).to(a.z)}}},74736:(e,t,i)=>{if(i.d(t,{u:()=>f}),2063!=i.j)var n=i(33113);if(2063!=i.j)var s=i(27745);if(2063!=i.j)var o=i(19953);if(2063!=i.j)var r=i(25643);if(2063!=i.j)var a=i(91322);if(2063!=i.j)var l=i(51152);if(2063!=i.j)var d=i(11804);if(2063!=i.j)var c=i(97446);if(2063!=i.j)var u=i(3482);if(2063!=i.j)var h=i(97668);if(2063!=i.j)var g=i(33717);if(2063!=i.j)var p=i(74515);if(2063!=i.j)var m=i(48303);class f{constructor(){this.imports=[r.v,s.d,o.r]}get uniqueId(){return(0,l.z)(507918358)}configureRootServices(e){var t,i;e.bind(a.K).to(n.r);const s=e.get(d.n);(null===(i=null===(t=s.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.enabled)&&((0,u.iO)(s)&&e.bind(c.S).to(u.lJ),(0,h.U)(s)&&e.bind(c.S).to(h.B),(0,g.p)(s)&&e.bind(c.S).to(g.C),(0,p.f)(s)&&e.bind(c.S).to(p.C),(0,m.f)(s)&&e.bind(c.S).to(m.C))}}},19953:(e,t,i)=>{if(i.d(t,{r:()=>g}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(11804);if(2063!=i.j)var o=i(79343);if(2063!=i.j)var r=i(77854);if(2063!=i.j)var a=i(90223);if(2063!=i.j)var l=i(3482);if(2063!=i.j)var d=i(97668);if(2063!=i.j)var c=i(33717);if(2063!=i.j)var u=i(74515);if(2063!=i.j)var h=i(48303);class g{get uniqueId(){return(0,n.z)(507781790)}configureRootServices(e){var t,i;const n=e.get(s.n);(null===(i=null===(t=n.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.enabled)&&((0,l.iO)(n)&&p(e,o.L9.CIQFlag_DateEntityRecognition,"ebx_DateEntityRecognitionCategoryTitle"),(0,d.U)(n)&&p(e,o.L9.CIQFlag_File,"ebx_CIQFlagFileTooltipTitle"),(0,c.p)(n)&&p(e,o.L9.CIQFlag_PersonEntityRecognition,"ebx_PersonEntityRecognitionCategoryTitle"),(0,u.f)(n)&&p(e,o.L9.CIQFlag_Time,"ebx_CIQFlagTimeCategoryTitle"),(0,h.f)(n)&&p(e,o.L9.CIQFlag_Topic,"ebx_CIQFlagTopicCategoryTitle"))}}function p(e,t,i){e.bind(r.U).toValue((e=>({id:t,name:(0,a.kd)(i,e)})))}},25643:(e,t,i)=>{if(i.d(t,{v:()=>y}),2063!=i.j)var n=i(76308);if(2063!=i.j)var s=i(98085);if(2063!=i.j)var o=i(72082);if(2063!=i.j)var r=i(48145);if(2063!=i.j)var a=i(43983);if(2063!=i.j)var l=i(69991);if(2063!=i.j)var d=i(60996);if(2063!=i.j)var c=i(47957);if(2063!=i.j)var u=i(652);if(2063!=i.j)var h=i(30095);if(2063!=i.j)var g=i(51152);if(2063!=i.j)var p=i(97446);if(2063!=i.j)var m=i(87615);if(2063!=i.j)var f=i(81103);if(2063!=i.j)var v=i(80746);if(2063!=i.j)var _=i(51007);class y{constructor(){this.imports=[n.I]}get uniqueId(){return(0,g.z)(507908322)}configureRootServices(e){e.bind(p.S).to(d.o),e.bind(l.SF).toSelf(),e.bind(c.F).toSelf(),e.bind(u.o).toSelf(),e.bind(f.l).toSelf(),e.bind(_.bz).toSelf(),e.bind(m.H).to(v.y),e.bind(h.$).to(a.U),e.bind(p.S).toExisting(h.$),e.bind(s.D).to(o.H),e.bind(s.D).to(r.o)}}},8532:(e,t,i)=>{if(i.d(t,{k:()=>r}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(21522);if(2063!=i.j)var o=i(43499);class r{get uniqueId(){return(0,n.z)(507917961)}configureRootServices(e){e.bind(s.J).to(o.I)}}},46290:(e,t,i)=>{i.d(t,{K:()=>m});var n=i(79490),s=i(13290),o=i(76778),r=i(18104),a=i(11804),l=i(10138),d=i(96571),c=i(29906),u=i(66008),h=i(83010),g=i(99614),p=i(68833);let m=class{constructor(e,t,i,n,o){this._hostEmitters=e,this._hostSettings=t,this._logger=i,this._nudgeStore=n,this._localizer=o,this.onNudgeEvent=e=>{if(!e.message.data.tileId)return void this._logger.log(510248464,s.q.Error,"INudge message: Received undefined args.");const t=e.message.data;t.text=this.getNudgeMessage(t.entityType);const i=Object.assign(Object.assign({eventType:e.message.messageType},t),{nudge:t});this.onEvent(i)},this.messagePerEntityType={[g.c.File]:"nudgeTextForFile",[g.c.People]:"nudgeTextForPeople",[g.c.Event]:"nudgeTextForMeetings",[g.c.Message]:"nudgeTextForEmails"}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(o.pD.nudgeTriggered,this.onNudgeEvent)}shutDown(){}async onEvent(e){e.eventType===r.G.NewData?await this._nudgeStore.updateNudge(e.nudge):await this._nudgeStore.clearNudge()}getNudgeMessage(e){var t,i,n;const s=null!==(n=null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===i?void 0:i.insertionCharacter)&&void 0!==n?n:"@";return this._localizer.getMessage(this.messagePerEntityType[e],s)}};m=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.t)(o.zJ)),(0,n.__param)(1,(0,h.W)(a.n)),(0,n.__param)(2,(0,h.W)(l.g)),(0,n.__param)(3,(0,h.W)(p.Y)),(0,n.__param)(4,(0,h.W)(d.H))],m)},68833:(e,t,i)=>{i.d(t,{Y:()=>r,h:()=>a});var n=i(79490),s=i(76729),o=i(29906);const r=(0,s.f)("INudgeStore");let a=class{constructor(){this.updateNudge=async e=>{this._currentNudge=e,this._onUpdate&&await this._onUpdate()},this.clearNudge=async()=>{this._currentNudge=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentNudge=()=>this._currentNudge,this.setOnUpdatedNudge=e=>{this._onUpdate=e}}};a=(0,n.__decorate)([(0,o._)()],a)},3482:(e,t,i)=>{i.d(t,{iO:()=>x,lJ:()=>N});var n=i(79490),s=i(8979),o=i(38540),r=i(18104),a=i(76778),l=i(79343),d=i(11804),c=i(10138),u=i(96571),h=i(45462),g=i(68805),p=i(77916),m=i(53335),f=i(99614),v=i(91322),_=i(30095),y=i(23943),I=i(45311),C=i(18558),S=i(29906),b=i(66008),T=i(83010),E=i(27603);let N=class extends C.H{constructor(e,t,i,n,s,a,l,d,c){super(e,t,i,n,a,l,d,c),this._localizer=s,this.onFlagAnnotationUpdate=e=>{var t,i;const n=e.message.messageType,s=e.message.data;if(n===r.G.NewData&&s.results.length>0){const i=[];for(const e of s.results){if(!m.uH.typeGuard(e))continue;if(1!==e.results.length||e.results[0].entityType!==f.c.DateTime||!x(this._hostSettings))continue;const n=e.results[0].subType,r=e.results[0].text;let a,l;try{const e=JSON.parse(r);e.start&&e.end&&("DateRange"===n?(a=w(e.start).getTime(),l=w(e.end).getTime()):(a=Date.parse(e.start),l=Date.parse(e.end)))}catch(e){}a||l||!Date.parse(r)||(a="Date"===n?w(r).getTime():Date.parse(r),l=a);const d=[{entities:[{entityType:f.c.DateTime,text:this.getTextForEntity(n),icon:{iconName:L()},confidence:e.modelMetadata.score,startDateTime:null==a?void 0:a.toString(),endDateTime:null==l?void 0:l.toString(),subType:n}],entityType:f.c.DateTime,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle")}];let c;switch(n){case"Date":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTooltipTitle");break;case"Datetime":case"DateTime":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeTooltipTitle");break;case"DateRange":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeTooltipTitle");break;case"Time":c=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeTooltipTitle");break;case"TimeRange":c=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeTooltipTitle")}const u=s.tileId+e.id;i.push({annotationId:u,traceId:u,languageId:this._hostSettings.defaultLocale,nodeId:s.tileId,nodeVersion:s.tileVersion,textInContext:null!==(t=e.context)&&void 0!==t?t:"",start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore,supportedEntityTypes:[f.c.DateTime],suggestionItems:d,additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:c,categoryTitle:this._localizer.getMessage("ebx_DateEntityRecognitionCategoryTitle")})}this.addFlags(e.address,i)}else if(n===r.G.RemoveData){const t=null===(i=this._annotationIdMap)||void 0===i?void 0:i.get(s.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,s.annotationId)}},this.getTextForEntity=e=>{switch(e){case"Date":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateLabel");case"Datetime":case"DateTime":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeLabel");case"DateRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeLabel");case"Time":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeLabel");case"TimeRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeLabel");default:return""}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(a.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return l.L9.CIQFlag_DateEntityRecognition}};function x(e){var t,i;return(0,g.i$)(null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,f.c.DateTime)}function w(e){const t=e.split(/\D+/).map((e=>parseInt(e,10)));return t[1]=t[1]-1,new Date(t[0],t[1],t[2])}function L(){const e="DateFlag";return(0,p.Z)(e,{regular:s.lHS,filled:s.ThD}),e}N=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.t)(a.zJ)),(0,n.__param)(1,(0,T.W)(d.n)),(0,n.__param)(2,(0,T.W)(y.w)),(0,n.__param)(3,(0,T.W)(c.g)),(0,n.__param)(4,(0,T.W)(u.H)),(0,n.__param)(5,(0,T.W)(_.$)),(0,n.__param)(6,(0,T.W)(I.W)),(0,n.__param)(6,(0,E.l)()),(0,n.__param)(7,(0,T.W)(h.f)),(0,n.__param)(8,(0,E.l)()),(0,n.__param)(8,(0,T.W)(v.K))],N)},30472:(e,t,i)=>{i.d(t,{v:()=>h});var n=i(79490),s=i(76778),o=i(18104),r=i(11804),a=i(21522),l=i(29906),d=i(66008),c=i(83010),u=i(9828);let h=class{constructor(e,t,i,n){this._hostEmitters=e,this._hostSettings=t,this._oaResultsStore=i,this._queryDetection=n,this.onOARankedAnnotationsEvent=e=>{const t=e.message.data,i=Object.assign(Object.assign({},t),{eventType:e.message.messageType,isLoading:!1});this.onEvent(i)},this.oaAnnotationsTriggeredEvent=e=>{this._oaResultsStore.updateLoadingStatus(!0)}}async initialize(){var e;if(this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled))for(const e of this._hostEmitters)e.on(s.pD.oaAnnotationsTriggered,this.oaAnnotationsTriggeredEvent),e.on(s.pD.oaRankedAnnotations,this.onOARankedAnnotationsEvent)}shutDown(){}onEvent(e){const{results:t,tileId:i,latency:n,resultStatus:s,queryCorrelationKeys:r,resultSummary:a}=e;switch(e.eventType){case o.G.NewData:case o.G.ChangeData:this._oaResultsStore.updateResults(t,i,s,r?Object.assign(Object.assign({},r),{scopeInfo:this._queryDetection.getCurrentScope()}):void 0,n,a);break;case o.G.RemoveData:this._oaResultsStore.clearResults()}}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.t)(s.zJ)),(0,n.__param)(1,(0,c.W)(r.n)),(0,n.__param)(2,(0,c.W)(u.C)),(0,n.__param)(3,(0,c.W)(a.J))],h)},97668:(e,t,i)=>{i.d(t,{B:()=>T,U:()=>E});var n=i(79490),s=i(38540),o=i(18104),r=i(76778),a=i(79343),l=i(11804),d=i(10138),c=i(96571),u=i(45462),h=i(68805),g=i(99614),p=i(91322),m=i(30095),f=i(23943),v=i(45311),_=i(15168),y=i(18558),I=i(29906),C=i(66008),S=i(83010),b=i(27603);let T=class extends y.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,a,l,d,u),this._localizer=r,this._paragraphTextExtractor=c,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(r===o.G.NewData&&a.results.length>0){const n=a.results.filter((e=>"GraphSearch"===e.ownerId));if(E(this._hostSettings)){const o=n.filter((e=>e.results[0].entityType===g.c.File)),r=[];for(const e of o){const n={entities:e.results,entityType:g.c.File,groupTitle:this._localizer.getMessage("fileEntityLabel")},o=this._paragraphTextExtractor.getParagraphText(a.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==o?void 0:o.substring(e.range.start,e.range.start+e.range.length),d=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(d)}l&&r.push({annotationId:d,traceId:d,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore,supportedEntityTypes:[g.c.File],suggestionItems:[n],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle")})}this.addFlags(e.address,r)}}else if(r===o.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_File}};function E(e){var t,i;return(0,h.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,g.c.File,"mc-editor-oa-files-flag")}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(l.n)),(0,n.__param)(2,(0,S.W)(f.w)),(0,n.__param)(3,(0,S.W)(d.g)),(0,n.__param)(4,(0,S.W)(c.H)),(0,n.__param)(5,(0,S.W)(m.$)),(0,n.__param)(6,(0,S.W)(v.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(u.f)),(0,n.__param)(8,(0,S.W)(_.b)),(0,n.__param)(9,(0,b.l)()),(0,n.__param)(9,(0,S.W)(p.K))],T)},18558:(e,t,i)=>{i.d(t,{H:()=>h});var n=i(79490),s=i(18104),o=i(76778),r=i(95523),a=i(65798),l=i(38540),d=i(29906),c=i(94526),u=i(19728);let h=class{constructor(e,t,i,n,o,r,l,d){this._hostEmitters=e,this._hostSettings=t,this._proofingDom=i,this._logger=n,this._critiqueStore=o,this._disableCritiqueHandler=r,this._instrumentationProcessor=l,this._applyFlagHandler=d,this._annotationMap=new Map,this._isDisabled=!1,this.shutDownCallbacks=[],this.ignoredStrings=[],this.shutDown=()=>{for(const e of this.shutDownCallbacks)e();this.flagHandlerShutdown()},this.getFlagData=e=>this._annotationMap.get(e),this.onIgnoreAllOfFlag=(e,t)=>{},this.removeFlag=(e,t)=>{const i=this._annotationMap.get(t);if(!i)return;const n=this.getCommonCritiqueById(i.critique.annotationId);n&&n.isIgnored||(this.emitEvent(s.G.RemoveData,[i.critique],i.critique.nodeId,e),this._annotationMap.delete(t))},this.onHostModelCritiques=e=>{for(const t of e.message.data.critiqueIdsRemoved)this._annotationMap.delete(t)},this.getCommonCritiqueById=e=>{let t;for(const i of this._critiqueStore.getAllCritiques())for(const n of i.critiques)n.annotationId===e&&(t=n);return t},this.onApplyFlag_Internal=(e,t,i,n)=>{if(!t.annotationId)return!0;const o=this._annotationMap.get(t.annotationId);if(o){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,c.l)(e))return this._logger.error(508146688,"Unable to find paragraph node while applying flag"),!1;this.onApplyFlag(e,t,i,n),this._annotationMap.delete(t.annotationId),this.emitEvent(s.G.RemoveData,[o.critique],o.critique.nodeId),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.ChangeAllSuggOther})}else this._logger.error(508146659,"Unable to find flag data while applying flag");return!1},this.onIgnoreFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,c.l)(e))return this._logger.error(508146658,"Unable to find paragraph node while ignoring flag"),!1;i.critique.isIgnored=!0,this.onIgnoreFlag(e,t),this._annotationMap.delete(t.annotationId),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.Ignore})}else this._logger.error(508146657,"Unable to find flag data while ignoring flag");return!1},this.onIgnoreAllOfFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,c.l)(e))return this._logger.error(507574145,"Unable to find paragraph node while ignoring all of flag"),!1;if(!t.textInContext)return this._logger.error(507574097,"Unable to find flag textInContext while ignoring all of flag"),!1;this.ignoredStrings.push(t.textInContext),i.critique.isIgnored=!0,this.onIgnoreAllOfFlag(e,t),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.IgnoreAll})}else this._logger.error(507574096,"Unable to find flag data while ignoring all of flag");return!1},this.onDisableFlag_Internal=(e,t)=>{var i;if(!t.annotationId)return!1;this._isDisabled=!0,this.onDisableFlag();for(const e of this._annotationMap.values())this.removeFlag(void 0,e.critique.annotationId);return null===(i=this._disableCritiqueHandler)||void 0===i||i.disableCritique(t),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.DoNotCheckThisIssue}),!1}}async initialize(){if(this._hostSettings.enableOrchestration){for(const e of this._hostEmitters)e.on(o.pD.hostModelCritiques,this.onHostModelCritiques);this._applyFlagHandler&&(this.shutDownCallbacks.push(this._applyFlagHandler.handleApplyFlag(this.getCritiqueType(),this.onApplyFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreFlag(this.getCritiqueType(),this.onIgnoreFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreAllOfFlag(this.getCritiqueType(),this.onIgnoreAllOfFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleDisableFlag(this.getCritiqueType(),this.onDisableFlag_Internal))),this.flagHandlerInitialize()}}addFlags(e,t){const i=new Map;for(const e of t){const t=i.get(e.nodeId);t?t.push(e):i.set(e.nodeId,[e])}for(const[t,n]of i)this.addFlagsInSameTile(e,t,n[0].nodeVersion,n)}addFlagsInSameTile(e,t,i,n){if(this._isDisabled)return;const o=n.map((e=>Object.assign(Object.assign({isFlagCritique:!0},e),{nodeId:t,nodeVersion:i,priority:l.bx.Informational,suggestions:[],typeId:this.getCritiqueType(),isIgnored:!1}))).filter((e=>{var t,i,n,s,o;if(e.annotationId&&this._annotationMap.get(e.annotationId))return!1;if(e.textInContext&&this.ignoredStrings.includes(e.textInContext))return!1;const a=this._proofingDom.findParagraphNode(e.nodeId);return!!(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.element)&&(null===(o=null===(s=null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===n?void 0:n.shouldRenderFlag)||void 0===s?void 0:s.call(n,(0,r.OE)(e),a.parent.element,e.nodeId,e.start,length))||void 0===o||o)}));this.emitEvent(s.G.NewData,o,t,e,i);for(const e of o)this._annotationMap.set(e.annotationId,{tileId:t,critique:e,additionalData:e.additionalData})}addFlag(e,t,i,n,s,o,r,a,l,d,c,u,h,g,p,m,f){this.addFlagsInSameTile(e,s,o,[{annotationId:t,textInContext:r,length:l,start:a,languageId:n,traceId:i,supportedActions:d,supportedEntityTypes:c,suggestionItems:u,groupTitle:g,groupSubtitle:p,tooltipTitle:m,categoryTitle:f,additionalData:h}])}emitEvent(e,t,i,n=void 0,r=0){for(const a of this._hostEmitters)a.emit(o.pD.hostModelFlags,{address:n,message:{messageType:s.G.ChangeData,data:{critiquesAdded:e===s.G.NewData?t:[],critiqueIdsRemoved:e===s.G.RemoveData?t.map((e=>e.annotationId)):[],tileId:i,tileVersion:r,source:"Local"}}})}};h=(0,n.__decorate)([(0,d._)()],h)},33717:(e,t,i)=>{i.d(t,{C:()=>N,p:()=>x});var n=i(79490),s=i(38540),o=i(18104),r=i(85924),a=i(76778),l=i(79343),d=i(11804),c=i(10138),u=i(96571),h=i(45462),g=i(68805),p=i(99614),m=i(91322),f=i(30095),v=i(23943),_=i(45311),y=i(15168),I=i(754),C=i(18558),S=i(29906),b=i(66008),T=i(83010),E=i(27603);let N=class extends C.H{constructor(e,t,i,n,a,l,d,c,u,h,g){super(e,t,i,n,l,d,c,g),this._localizer=a,this._paragraphTextExtractor=u,this._tileContent=h,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(x(this._hostSettings))if(r===o.G.NewData&&a.results.length>0){const n=a.results.filter((e=>e.results.length>0&&e.results[0].entityType===p.c.People)),o=[];for(const e of n){const n=[];for(const t of e.results){if(!t.DisplayName)continue;const e=["JobTitle","Company","Department","OfficeLocation"],i=t;i.PropertyHits&&e.includes(i.PropertyHits[0])?n.push(Object.assign(Object.assign({},t),{subtitlePropertyOverride:i.PropertyHits[0]})):n.push(t)}const r={entities:n,entityType:p.c.People,groupTitle:this._localizer.getMessage("peopleEntityLabel")},l=this._paragraphTextExtractor.getParagraphText(a.tileId),d=null!==(t=e.context)&&void 0!==t?t:null==l?void 0:l.substring(e.range.start,e.range.start+e.range.length),c=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(c)}d&&o.push({annotationId:c,traceId:c,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:d,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore,supportedEntityTypes:[p.c.People],suggestionItems:0===n.length?void 0:[r],additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:this._localizer.getMessage("ebx_CIQFlagPeopleTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_PersonEntityRecognitionCategoryTitle")})}this.addFlags(e.address,o)}else if(r===o.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);if(a&&(this._annotationMap.delete(t.annotationId),null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)){const s=a.additionalData.replacementRange;if(s){const n=s.start-a.additionalData.range.start,o=t.start+n;this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+o,s.length).then((n=>{if(!n)return void this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,r.W)(["FlagTypeId",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",s.start],["ReplacementLength",s.length],["InTextReplacementStart",o]));const l=Object.assign(Object.assign({},t),{start:o,length:s.length});this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,l)})).catch((e=>{this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,r.W)(["Exception",e],["FlagTypeID",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",s.start],["ReplacementLength",s.length],["InTextReplacementStart",o]))}))}else this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t)}},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(a.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return l.L9.CIQFlag_PersonEntityRecognition}};function x(e){var t,i;return(0,g.i$)(null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,p.c.People)}N=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.t)(a.zJ)),(0,n.__param)(1,(0,T.W)(d.n)),(0,n.__param)(2,(0,T.W)(v.w)),(0,n.__param)(3,(0,T.W)(c.g)),(0,n.__param)(4,(0,T.W)(u.H)),(0,n.__param)(5,(0,T.W)(f.$)),(0,n.__param)(6,(0,T.W)(_.W)),(0,n.__param)(6,(0,E.l)()),(0,n.__param)(7,(0,T.W)(h.f)),(0,n.__param)(8,(0,T.W)(y.b)),(0,n.__param)(9,(0,T.W)(I.d)),(0,n.__param)(10,(0,E.l)()),(0,n.__param)(10,(0,T.W)(m.K))],N)},9828:(e,t,i)=>{i.d(t,{C:()=>g,L:()=>p});var n=i(79490),s=i(52946),o=i(11804),r=i(21522),a=i(32177),l=i(13467),d=i(4915),c=i(76729),u=i(29906),h=i(83010);const g=(0,c.f)("IOAResultStore");let p=class{constructor(e,t,i,n){this._oaLogger=e,this._hostSettings=t,this._queryDetection=i,this._oaMetric=n,this._results=[],this._resultsByNode=new Map,this._isLoading=!0,this._isTimeout=!1,this._resultReset=!1,this.setOnUpdate=e=>{this.onUpdate=e},this.updateResults=(e,t,i,n,s,o)=>{var r,a;if(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.mockNoAugloopResults)return;const l=(null==n?void 0:n.logicalId)&&n.logicalId!==this._queryDetection.getCurrentQueryLogicalId();this.logStoreUpdate(e,!!l,i,n),l?this._oaMetric.commitEntry(n.logicalId,"OAAnnotationResultsDropped"):(n&&this._oaMetric.addMeasure(n.logicalId,"OAResultsReceived"),this.cancelTimeout(),this._isLoading=!1,this._isTimeout=!1,this._resultSummary=o,this._resultStatus=i,this._resultReset=!1,this._results=this._results.concat(e),this._resultsByNode.set(t,e),this.update(i,e,null!==(a=null!=n?n:this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==a?a:{conversationId:"",logicalId:""},t,s,o))},this.updateLoadingStatus=(e,t=!1)=>{this._isLoading=e,this._isTimeout=!1,this._resultSummary=void 0,this._resultStatus=void 0,this._resultReset=t,e&&(this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())),this.update()},this.startNewECCMenu=()=>{this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())},this.clearResults=()=>{this._results=[],this._isTimeout=!1,this._isLoading=!0,this._resultReset=!1,this._resultsByNode.clear()},this.getResults=()=>this._results,this.getResultSummary=()=>this._resultSummary,this.getResultStatus=()=>this._resultStatus,this.getLoadingStatus=()=>this._isLoading,this.getTimeoutStatus=()=>this._isTimeout||this._resultStatus===d.i.UnexpectedError,this.timeoutFunc=()=>{var e;this._isTimeout=!0,this._isLoading=!1,this._resultSummary={Timeout:1},this._resultStatus=d.i.Timeout,this._resultReset=!1,this.update(d.i.Timeout,void 0,null!==(e=this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==e?e:{conversationId:"",logicalId:""},void 0,this.getTimeoutThreshold(),this._resultSummary)},this.cancelTimeout=()=>{this._timeoutID&&clearTimeout(this._timeoutID)},this.update=(e=void 0,t=[],i=void 0,n,s,o=void 0)=>{this.onUpdate&&this.onUpdate({results:t,isLoading:this._isLoading,queryCorrelationKeys:i,resultSummary:o,resultStatus:e,resultReset:this._resultReset,nodeId:n,latency:s})}}logStoreUpdate(e,t,i,n){const s={};for(const t of e){s[t.entityType]=t.entities.length}this._oaLogger.logActivity(l.y,{actualLogicalId:null==n?void 0:n.logicalId,actualConversationId:null==n?void 0:n.conversationId,annotationCount:e.length,resultStatus:null!=i?i:-1,annotations:s,dropped:t})}getTimeoutThreshold(){var e;return(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.updateResultsTimeout)||3500}};p=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(s.m)),(0,n.__param)(1,(0,h.W)(o.n)),(0,n.__param)(2,(0,h.W)(r.J)),(0,n.__param)(3,(0,h.W)(a.u))],p)},74515:(e,t,i)=>{i.d(t,{C:()=>w,f:()=>L});var n=i(79490),s=i(38540),o=i(18104),r=i(76778),a=i(79343),l=i(11804),d=i(10138),c=i(96571),u=i(45462);if(2063!=i.j)var h=i(68805);var g=i(77916),p=i(53335),m=i(27563),f=i(99614),v=i(40826),_=i(91322),y=i(30095),I=i(23943),C=i(754),S=i(45311),b=i(18558),T=i(29906),E=i(66008),N=i(83010),x=i(27603);let w=class extends b.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,l,d,c,u),this._tileContent=r,this._localizer=a,this.onFlagAnnotationUpdate=e=>{const t=e.message.messageType,i=e.message.data;if(t===o.G.NewData&&i.results.length>0){const t=[];for(const e of i.results){if(!p.uH.typeGuard(e))continue;if(0===e.results.length)continue;const n=e.results[0];if(!m.f.typeGuard(n))continue;const o=[{entities:[{entityType:f.c.Text,text:n.context+n.hint,subtitle:void 0,icon:{iconName:D()},confidence:1}],entityType:f.c.Text,groupTitle:this._localizer.getMessage("ebx_CIQFlagTimeTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTimeSubtitle")}];t.push({annotationId:i.annotationId,traceId:i.annotationId,languageId:e.language,nodeId:i.tileId,nodeVersion:i.tileVersion,textInContext:n.context,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore,supportedEntityTypes:[f.c.Text],suggestionItems:o,additionalData:n,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTimeTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTimeCategoryTitle")})}this.addFlags(e.address,t)}else t===o.G.RemoveData&&this.removeFlag(e.address,i.annotationId)},this.onApplyFlag=(e,t,i,n)=>{if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),this._tileContent.replace(e.parent,void 0,t.start,t.length,i.text.trim(),n))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{}}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_Time}};function L(e){var t,i;return(0,h.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,f.c.Time,"mc-unified-text-prediction-timezone-perspectives")}function D(){const e="TimeFlag";return(0,g.Z)(e,{regular:v.EEN,filled:v.Aig}),e}w=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,E.t)(r.zJ)),(0,n.__param)(1,(0,N.W)(l.n)),(0,n.__param)(2,(0,N.W)(I.w)),(0,n.__param)(3,(0,N.W)(d.g)),(0,n.__param)(4,(0,N.W)(C.d)),(0,n.__param)(5,(0,N.W)(c.H)),(0,n.__param)(6,(0,N.W)(y.$)),(0,n.__param)(7,(0,N.W)(S.W)),(0,n.__param)(7,(0,x.l)()),(0,n.__param)(8,(0,N.W)(u.f)),(0,n.__param)(9,(0,x.l)()),(0,n.__param)(9,(0,N.W)(_.K))],w)},48303:(e,t,i)=>{i.d(t,{C:()=>T,f:()=>E});var n=i(79490),s=i(38540),o=i(18104),r=i(76778),a=i(79343),l=i(11804),d=i(10138),c=i(96571),u=i(45462),h=i(68805),g=i(99614),p=i(91322),m=i(30095),f=i(23943),v=i(45311),_=i(15168),y=i(18558),I=i(29906),C=i(66008),S=i(83010),b=i(27603);let T=class extends y.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,a,l,d,u),this._localizer=r,this._paragraphTextExtractor=c,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(r===o.G.NewData&&a.results.length>0){const n=a.results.filter((e=>"GraphSearch"===e.ownerId));if(E(this._hostSettings)){const o=n.filter((e=>e.results[0].entityType===g.c.Topic)),r=[];for(const e of o){const n={entities:e.results.map((e=>Object.assign(Object.assign({},e),{icon:{iconName:"Hashtag"}}))),entityType:g.c.Topic,groupTitle:this._localizer.getMessage("ebx_CIQFlagTopicTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTopicSubtitle")},o=this._paragraphTextExtractor.getParagraphText(a.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==o?void 0:o.substring(e.range.start,e.range.start+e.range.length);if(!l)continue;const d=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(d)}r.push({annotationId:d,traceId:d,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore|s.lb.IgnoreAll,supportedEntityTypes:[g.c.Topic],suggestionItems:[n],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle")})}this.addFlags(e.address,r)}}else if(r===o.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;const r=this._annotationMap.get(t.annotationId);r&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(r.additionalData,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_Topic}};function E(e){var t,i;return(0,h.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,g.c.Topic,"mc-editor-oa-topics-flags")}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(l.n)),(0,n.__param)(2,(0,S.W)(f.w)),(0,n.__param)(3,(0,S.W)(d.g)),(0,n.__param)(4,(0,S.W)(c.H)),(0,n.__param)(5,(0,S.W)(m.$)),(0,n.__param)(6,(0,S.W)(v.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(u.f)),(0,n.__param)(8,(0,S.W)(_.b)),(0,n.__param)(9,(0,b.l)()),(0,n.__param)(9,(0,S.W)(p.K))],T)},13467:(e,t,i)=>{i.d(t,{$:()=>s,y:()=>n});const n="OAResultStoreUpdates",s="OAPredictionReceived"},75982:(e,t,i)=>{i.d(t,{Y:()=>v});var n=i(79490),s=i(99614),o=i(13290),r=i(76778),a=i(18104),l=i(11804),d=i(10138),c=i(52946),u=i(4891),h=i(74261),g=i(13467),p=i(29906),m=i(66008),f=i(83010);let v=class{constructor(e,t,i,n,s,r){this._hostEmitters=e,this._hostSettings=t,this._logger=i,this._oaLogger=n,this._predictionStore=s,this._compositionEventHandler=r,this.onPredictionEvent=e=>{if(this.isDisabledOrComposing())return;if(!e.message.data.tileId)return void this._logger.log(510248457,o.q.Error,"IPrediction message: Received undefined args.");const t=e.message.data,i={eventType:e.message.messageType,tileId:t.tileId,tileVersion:t.tileVersion,prediction:t};this.onEvent(i)}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(r.pD.predictionTriggered,this.onPredictionEvent)}shutDown(){}isDisabledOrComposing(){return!this._hostSettings.isTextPredictionEnabled||this._compositionEventHandler.isComposing}async onEvent(e){this.isDisabledOrComposing()||(e.eventType===a.G.NewData?(this._oaLogger.logActivity(g.$,{predictionText:e.prediction.entityType!==s.c.Text?e.prediction.entityType.toString():e.prediction.text,entityType:e.prediction.entityType,replacingExistingPrediction:void 0!==this._predictionStore.getCurrentPrediction()}),e.prediction.isFromAugLoop=!0,await this._predictionStore.updatePrediction(e.prediction)):await this._predictionStore.clearPrediction())}};v=(0,n.__decorate)([(0,p._)(),(0,n.__param)(0,(0,m.t)(r.zJ)),(0,n.__param)(1,(0,f.W)(l.n)),(0,n.__param)(2,(0,f.W)(d.g)),(0,n.__param)(3,(0,f.W)(c.m)),(0,n.__param)(4,(0,f.W)(h.o)),(0,n.__param)(5,(0,f.W)(u.q))],v)},74261:(e,t,i)=>{i.d(t,{X:()=>a,o:()=>r});var n=i(79490),s=i(76729),o=i(29906);const r=(0,s.f)("IPredictionStore");let a=class{constructor(){this.updatePrediction=async e=>{this._currentPrediction=e,this._onUpdate&&await this._onUpdate()},this.clearPrediction=async()=>{this._currentPrediction=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentPrediction=()=>this._currentPrediction,this.setOnUpdatedPrediction=e=>{this._onUpdate=e}}};a=(0,n.__decorate)([(0,o._)()],a)},10965:(e,t,i)=>{i.d(t,{z:()=>n});const n=(0,i(76729).f)("IPresentationSettings")},95089:(e,t,i)=>{function n(e,t){return e===t||s(e.bottom,t.bottom)&&s(e.height,t.height)&&s(e.left,t.left)&&s(e.right,t.right)&&s(e.top,t.top)&&s(e.width,t.width)}function s(e,t,i=.01){return Math.abs(e-t)<i}i.d(t,{a:()=>n})},73522:(e,t,i)=>{function n(e,t,i,n){var s;const o=[];let r=0;const a=new Set;for(const{critique:l}of e){let e=!1;const d=(null===(s=l.textInContext)||void 0===s?void 0:s.toLowerCase())||"";i&&(e=a.has(d)),r<t&&!e?l.isVisible&&(n&&l.isStealth&&(l.isStealth=!1,o.push(l)),a.add(d),r++):e&&l.isVisible?(l.isVisible=!1,o.push(l)):l.isVisible&&(n&&!l.isStealth?(l.isStealth=!0,o.push(l)):n||(l.isVisible=!1,o.push(l)),a.add(d))}return o}i.d(t,{Y:()=>n})},69099:(e,t,i)=>{if(i.d(t,{k:()=>s}),2063!=i.j)var n=i(79343);function s(e){const t=[];return e.forEach((e=>{t.push({confidenceScore:o(e),critique:e})})),t.sort(((e,t)=>t.confidenceScore-e.confidenceScore)),t}function o(e){return e.typeId===n.L9.TopicSuggestion?function(e){let t=0;try{e.suggestions.forEach((e=>{const i=JSON.parse(e.metadataJSON||"{}");t=Math.max(i.annotationScore,t)}))}catch(e){}return t}(e):e.typeId===n.L9.CIQFlag_Topic?function(e){var t;let i=0;return null===(t=e.suggestionItems)||void 0===t||t.forEach((e=>{e.entities.forEach((e=>{i=Math.max(e.confidence,i)}))})),i}(e):0}},66464:(e,t,i)=>{function n(e,t){return t>=e.tileVersion}i.d(t,{d:()=>n})},30076:(e,t,i)=>{i.d(t,{i:()=>n});const n=(0,i(76729).f)("EditorCanvasInjectableComponent")},25449:(e,t,i)=>{i.d(t,{$:()=>l,I:()=>d});var n=i(79490),s=i(76729),o=i(29906),r=i(83010),a=i(10965);const l=(0,s.f)("IContentValidator");let d=class{constructor(e){this.presentationSettings=e}validate(e){if(!e)return"";let t=e;return t.includes("")&&(t=t.replace(//g,"")),t.slice(0,this.presentationSettings.maxServiceContentLengthInChars)}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(a.z))],d)},87615:(e,t,i)=>{i.d(t,{H:()=>n});const n=(0,i(76729).f)("ISessionTelemetryTracker")},80746:(e,t,i)=>{i.d(t,{y:()=>u});var n=i(79490),s=i(28831),o=i(45242),r=i(79343),a=i(85924),l=i(10138),d=i(29906),c=i(83010);let u=class{constructor(e){this._logger=e,this._renderedCritiques=new Map}update(e,t){const i=this._renderedCritiques.get(t)||new Map;for(const t of e){const e=`${t.textInContext}#${t.typeId}`;i.set(e,t)}this._renderedCritiques.set(t,i)}logTelemetry(){const e=this._logger.getNewActivity(s.n.CritiquesShown,o.o.SamplingPolicy.CriticalExperimentation);if(!e)return;let t=[];Array.from(this._renderedCritiques.values()).forEach((e=>{t=t.concat(Array.from(e.values()))}));const i={};try{const e=Array.from(t.values()).reduce(((e,t)=>{if(t.typeId){let i=new Set;t.typeId===r.L9.TopicSuggestion&&(i=t.suggestions.reduce(((e,t)=>{const i=t.metadataJSON;if(i){const t=JSON.parse(i).id;t&&e.add(t)}return e}),new Set)),t.typeId in e?(e[t.typeId].count+=1,i.forEach(e[t.typeId].suggestions.add,e[t.typeId].suggestions)):e[t.typeId]={count:1,suggestions:i}}return e}),{});for(const t in e)i[t]={count:e[t].count,suggestions:[...e[t].suggestions]}}catch(e){this._logger.error(524116174,"Data preparation failed for CritiquesShown",e)}e.dataFields.push((0,a.n)("Critiques",JSON.stringify(i))),e.success=!0,e.endNow()}};u=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(l.g))],u)},49243:(e,t,i)=>{function n(e){if(e){return/[^\u0000-\u007f]/.test(e)}return!1}i.d(t,{c:()=>n})},81166:(e,t,i)=>{if(i.d(t,{A:()=>l,o:()=>d}),2063!=i.j)var n=i(30095);var s=i(79343);if(2063!=i.j)var o=i(69099);if(2063!=i.j)var r=i(73522);const a=[s.L9.TopicSuggestion,s.L9.CIQFlag_Topic];function l(e){return e.some((e=>e.critiqueDiffType!==n.K.Move&&a.includes(e.critique.typeId)))}function d(e,t){const i=[];for(const t of e.values())for(const e of t)a.includes(e.typeId)&&i.push(e);const n=(0,o.k)(i);return(0,r.Y)(n,3,!0,t)}},80233:(e,t,i)=>{var n,s;i.d(t,{G:()=>n,i:()=>s}),function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="wus-001.nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}(n||(n={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(s||(s={}))},1509:(e,t,i)=>{i.d(t,{qq:()=>de,R9:()=>ce});var n={};i.r(n),i.d(n,{BrowserExtensionRequestV1:()=>P,BrowserExtensionResponseV1:()=>j,CommonAppIdProperty:()=>g,CommonAppVersionProperty:()=>F,CommonCritique:()=>N,CommonDescriptorsProperty:()=>I,CommonLanguageIdProperty:()=>v,CommonLanguageUXIdProperty:()=>S,CommonOverriddenCritiqueTypeOptions:()=>T,CommonRequestIdProperty:()=>m,CommonResponseStatusProperty:()=>p,CommonRevisionIdProperty:()=>L,CommonRunOnProfileIdProperty:()=>b,CommonTextUnitProperty:()=>_,CommonTileIdProperty:()=>w,ConfigRequestV2:()=>k,ConfigResponseV2:()=>B,CritiqueCategoryInfo:()=>A,CritiqueTypeInfo:()=>R,CritiqueTypeOption:()=>G,Descriptor:()=>C,EditorServiceConfigV2Headers:()=>J,EditorServiceInstrumentationHeaders:()=>Y,EditorServiceLanguageinfoHeaders:()=>Z,EditorServicePostTileCheckHeaders:()=>$,InstrumentationRequestV1:()=>M,LanguageInfoRequestV1:()=>z,LanguageInfoResponseV1:()=>U,Metadatum:()=>x,Suggestion:()=>E,SupportedActions:()=>D,SupportedLanguage:()=>Q,TileCheckCritique:()=>K,TileCheckRequestV1:()=>O,TileCheckResponseV1:()=>W,TileCheckSpan:()=>H,TileContent:()=>f,TileElement:()=>V,TopologyNode:()=>y,UserIdentity:()=>q});var s=i(17083),o=i(11451);const r="Composite",a="String",l="Number",d="Sequence",c={xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}};function u(e){const t={};for(const a of e)t[(r=a[0],r.charAt(0).toLowerCase()+r.slice(1))]=(i=a[0],n=a[1],s=a[2],o=a[3],{serializedName:i,required:s,defaultValue:o,type:{name:n}});var i,n,s,o,r;return t}function h(e,t){return{type:{name:r,className:e,modelProperties:t}}}const g=h("CommonAppIdProperty",u([["AppId",a]])),p=h("CommonResponseStatusProperty",u([["ResponseStatus",l,!1,0]])),m=h("CommonRequestIdProperty",u([["RequestId",a]])),f=h("TileContent",Object.assign(Object.assign({},u([["TileId",a,!0],["RevisionId",a,!0]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},tileElements:{serializedName:"TileElements",type:{name:d,element:{type:{name:r,className:"TileElement"}}}}})),v=h("CommonLanguageIdProperty",u([["LanguageId",a]])),_=h("CommonTextUnitProperty",u([["TextUnit",l]])),y=h("TopologyNode",Object.assign(Object.assign({},u([["Id",a,!0],["RevisionId",a,!0],["Type",l,!0],["NumberOfChildren",l],["AreChildsOrdered","Boolean",void 0,!1]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"Children",type:{name:d,element:{type:{name:r,className:"TopologyNode"}}}}})),I=h("CommonDescriptorsProperty",{descriptors:{serializedName:"Descriptors",type:{name:d,element:{type:{name:r,className:"Descriptor"}}}}}),C=h("Descriptor",u([["Name",a,!0],["Value",a,!0]])),S=h("CommonLanguageUXIdProperty",u([["LanguageUXId",a]])),b=h("CommonRunOnProfileIdProperty",u([["RunOnProfileId","Uuid"]])),T=h("CommonOverriddenCritiqueTypeOptions",{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:d,element:{type:{name:r,className:"CritiqueTypeOption"}}}}}),E=h("Suggestion",u([["Text",a,!0],["Description",a],["ConfidenceLevel",l],["Source",l],["Action",l,!0],["BucketId",l],["NumberOfInstances",l]])),N=h("CommonCritique",Object.assign(Object.assign({},u([["TraceId","Uuid"],["TypeId","Uuid"],["CategoryTitle",a],["Context",a],["Start",l,void 0,0],["StartInContext",l,void 0,0],["Length",l,void 0,0],["LanguageId",a],["Priority",l]])),{metadata:{serializedName:"Metadata",type:{name:d,element:{type:{name:r,className:"Metadatum"}}}}})),x=h("Metadatum",u([["Name",a,!0],["Value",a,!0]])),w=h("CommonTileIdProperty",u([["TileId",a]])),L=h("CommonRevisionIdProperty",u([["RevisionId",a]])),D=h("SupportedActions",u([["SupportedActions",l]])),F=h("CommonAppVersionProperty",u([["AppVersion",a]])),A=h("CritiqueCategoryInfo",Object.assign(Object.assign({},u([["Id","Uuid",!0],["Name",a,!0],["Priority",l]])),{critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:d,element:{type:{name:r,className:"CritiqueTypeInfo"}}}}})),R=h("CritiqueTypeInfo",Object.assign(Object.assign({},u([["Id","Uuid",!0],["Name",a,!0],["IsBinaryCritiqueType","Boolean"],["DefaultCritiqueValue",l,!0],["CritiquePriority",l],["CritiqueTag",a]])),{critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:d,element:{type:{name:a}}}}})),q=h("UserIdentity",u([["IdentityProvider",l,!0],["Puid",a,!0],["TenantId",a],["Cid",a]])),P=h("BrowserExtensionRequestV1",Object.assign(Object.assign({},g.type.modelProperties),u([["Browser",a],["BrowserVersion",a],["ClientId",a],["Email",a],["ExtensionId",a],["FirstInstallVersion",a],["LanguageId",a],["LanguageUxId",a],["LicenseType",a],["StoreId",a],["TenantId",a]]))),O=h("TileCheckRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),I.type.modelProperties),S.type.modelProperties),b.type.modelProperties),T.type.modelProperties),u([["SessionId",a,!0],["RequestOrderInSession",l]])),{content:{serializedName:"Content",type:{name:d,element:{type:{name:r,className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:r,className:"TopologyNode"}}})),k=h("ConfigRequestV2",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),F.type.modelProperties),I.type.modelProperties),v.type.modelProperties),S.type.modelProperties),b.type.modelProperties)),z=h("LanguageInfoRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),I.type.modelProperties),v.type.modelProperties),S.type.modelProperties),b.type.modelProperties)),M=h("InstrumentationRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),v.type.modelProperties),I.type.modelProperties),u([["TraceId","Uuid",!0],["CritiqueGenerationTime",l],["CritiquePriority",l,!0],["CritiqueTypeId","Uuid",!0],["EventId",l,!0],["OriginalText",a],["PreContextBegin",l],["PostContextEnd",l],["SubstrateEventName",a]])),{flaggedText:{constraints:{MaxLength:2e4,MinLength:1},serializedName:"FlaggedText",required:!0,type:{name:a}},metadata:{serializedName:"Metadata",type:{name:d,element:{type:{name:r,className:"Metadatum"}}}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Dictionary",value:{type:{name:"any"}}}},suggestions:{serializedName:"Suggestions",type:{name:d,element:{type:{name:a}}}},suggestionText:{constraints:{MaxLength:2e4},serializedName:"SuggestionText",type:{name:a}}})),j=h("BrowserExtensionResponseV1",Object.assign(Object.assign(Object.assign(Object.assign({},p.type.modelProperties),m.type.modelProperties),u([["UseTileCheck","Boolean",void 0,!1],["Descriptors",a],["StyleObserverIntervalTime",l,void 0,0],["StyleSampleTime",l,void 0,0],["RootContentMaxLengthInChars",l,void 0,2e3],["SchedulerDefaultWaitingTime",l,void 0,0],["SchedulerDefaultWaitingTimeIncrement",l,void 0,0],["SchedulerDefaultMaxTime",l,void 0,0],["RefreshCritiqueWaitingTime",l,void 0,0],["RequestCritiqueDelay",l,void 0,0],["EnableDirtyRangeAutoRehydration","Boolean",void 0,!1],["TelemetryTenant",a],["LogGroupName",a],["SendToAria","Boolean",void 0,!1],["IntervalForActivityCleanup",l,void 0,0],["MaxAllowedTimeForActivities",l,void 0,0],["CalloutHoverTimeout",l,void 0,0],["MaxSuggestionItemsDisplayNumber",l,void 0,0],["EditorClientState",l],["ConfigurationId",a]])),{disabledWebSites:{serializedName:"DisabledWebSites",type:{name:d,element:{type:{name:a}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:d,element:{type:{name:a}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:d,element:{type:{name:a}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:a}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:a}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"any"}}}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:d,element:{type:{name:a}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:d,element:{type:{name:a}}}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),W=h("TileCheckResponseV1",Object.assign(Object.assign({},p.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:d,element:{type:{name:r,className:"TileCheckCritique"}}}}})),B=h("ConfigResponseV2",Object.assign(Object.assign({},p.type.modelProperties),{critiqueCategoryInfoList:{serializedName:"CritiqueCategoryInfoList",required:!0,type:{name:d,element:{type:{name:r,className:"CritiqueCategoryInfo"}}}}})),U=h("LanguageInfoResponseV1",Object.assign(Object.assign({},p.type.modelProperties),{supportedLanguages:{serializedName:"SupportedLanguages",required:!0,type:{name:d,element:{type:{name:r,className:"SupportedLanguage"}}}}})),H=h("TileCheckSpan",Object.assign(Object.assign(Object.assign({},v.type.modelProperties),u([["Start",l,void 0,0],["Length",l,void 0,"tileElement.Text.Length - span.Start"],["DoNotCheck","Boolean"]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),V=h("TileElement",Object.assign(Object.assign(Object.assign(Object.assign({},v.type.modelProperties),_.type.modelProperties),u([["Text",a,!0],["IsClean","Boolean"]])),{enabledLanguages:{serializedName:"EnabledLanguages",type:{name:d,element:{type:{name:d,element:{type:{name:r,className:"CommonLanguageIdProperty"}}}}}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},spans:{serializedName:"Spans",type:{name:d,element:{type:{name:r,className:"TileCheckSpan"}}}}})),G=h("CritiqueTypeOption",Object.assign(Object.assign({},v.type.modelProperties),u([["Id","Uuid",!0],["Name",a],["TypeName",a],["Value",a,!0]]))),Q=h("SupportedLanguage",Object.assign(Object.assign(Object.assign({},v.type.modelProperties),_.type.modelProperties),u([["SupportedCritiqueTag",a]]))),K=h("TileCheckCritique",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},N.type.modelProperties),w.type.modelProperties),L.type.modelProperties),D.type.modelProperties),u([["BucketId",l],["ExplanationTitle",a],["ExplanationLabel",a],["Explanation",a],["Status",l],["Tag",l]])),{suggestions:{serializedName:"Suggestions",type:{name:d,element:{type:{name:r,className:"Suggestion"}}}}})),$=h("EditorServicePostTileCheckHeaders",c),J=h("EditorServiceConfigV2Headers",c),Z=h("EditorServiceLanguageinfoHeaders",c),Y=h("EditorServiceInstrumentationHeaders",c),X={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},ee={parameterPath:"body",mapper:P},te={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},ie={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},ne={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},se={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},oe={parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}},re={parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},ae={parameterPath:"body",mapper:M};class le extends s.Nl{constructor(e){var t,i;e||(e={});const n="@editor/client-rest-api/2.0.0",r=e.userAgentOptions&&e.userAgentOptions.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${n}`:`${n}`,a=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),e),{userAgentOptions:{userAgentPrefix:r},baseUri:null!==(i=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri)&&void 0!==i?i:"https://nleditor.osi.officeppe.net/NLEditor"});super(a);let l=!1;if((null==e?void 0:e.pipeline)&&e.pipeline.getOrderedPolicies().length>0){l=e.pipeline.getOrderedPolicies().some((e=>e.name===o.uQ))}e&&e.pipeline&&0!=e.pipeline.getOrderedPolicies().length&&l||(this.pipeline.removePolicy({name:o.uQ}),this.pipeline.addPolicy(o.N$({credential:null==e?void 0:e.credential,scopes:`${a.credentialScopes}`,challengeCallbacks:{authorizeRequestOnChallenge:s.fj}}))),this.pipeline.removePolicy({name:o.PR}),this.pipeline.removePolicy({name:o.OD}),this.$host=e.$host||"https://nleditor.osi.officeppe.net/NLEditor"}}class de extends le{browserextension(e,t){return this.sendOperationRequest({body:e,options:t},he)}}class ce extends le{instrumentation(e,t){return this.sendOperationRequest({body:e,options:t},ge)}}const ue=s.rl(n,!1),he={path:"/api/V1/BrowserExtension",httpMethod:"POST",responses:{200:{bodyMapper:j},400:{},500:{}},requestBody:ee,urlParameters:[ie],headerParameters:[X,te,ne,se,oe],mediaType:"json",serializer:ue},ge={path:"/api/V1/Instrumentation",httpMethod:"POST",responses:{200:{headersMapper:Y},400:{},500:{}},requestBody:ae,urlParameters:[ie],headerParameters:[X,ne,se,re,{parameterPath:"authorization",mapper:{serializedName:"Authorization",type:{name:"String"}}},{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],mediaType:"json",serializer:ue}},61643:(e,t,i)=>{function n(e,t,i){const n={};for(const s in i)n[e+"-"+s]=`${t} (${i[s]})`;return n}i.d(t,{p:()=>s});const s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (Namibi)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (Kml)","ak-gh":"Akan (Gaana)","am-et":" ()","ar-001":[" ()",!0],"ar-ae":[" (  )",!0],"ar-bh":[" ()",!0],"ar-dj":[" ()",!0],"ar-dz":[" ()",!0],"ar-eg":[" ()",!0],"ar-er":[" ()",!0],"ar-il":[" ()",!0],"ar-iq":[" ()",!0],"ar-jo":[" ()",!0],"ar-km":[" ( )",!0],"ar-kw":[" ()",!0],"ar-lb":[" ()",!0],"ar-ly":[" ()",!0],"ar-ma":[" ( )",!0],"ar-mr":[" ()",!0],"ar-om":[" ()",!0],"ar-ps":[" ( )",!0],"ar-qa":[" ()",!0],"ar-sa":[" (  )",!0],"ar-sd":[" ()",!0],"ar-so":[" ()",!0],"ar-ss":[" ( )",!0],"ar-sy":[" ()",!0],"ar-td":[" ()",!0],"ar-tn":[" ()",!0],"ar-ye":[" ()",!0],"arn-cl":"Mapudungun (Chile)","as-in":" ()","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (Espaa)","az-cyrl-az":" ()","az-latn-az":"azrbaycan (Azrbaycan)","ba-ru":" ()","bas-cm":"sa (Kmrn)","be-by":" ()","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":" ()","bin-ng":"d (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":" ()","bn-in":" ()","bo-cn":" ()","bo-in":" ()","br-fr":"brezhoneg (Fras)","brx-in":" ()","bs-cyrl-ba":" (  )","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":" ()","ca-ad":"catal (Andorra)","ca-es":"catal (catal)","ca-es-valencia":"valenci (Espanya)","ca-fr":"catal (Frana)","ca-it":"catal (Itlia)","ccp-cakm-bd":" ()","ccp-cakm-in":" ()","ce-ru":" ()","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":" (  )","co-fr":"Corsu (Francia)","cs-cz":"etina (esko)","cu-ru":" ()","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (Grnland)","dav-ke":"Kitaita (Kenya)"},n("de","Deutsch",{at:"sterreich",be:"Belgien",ch:"Schweiz",de:"Deutschland",it:"Italien",li:"Liechtenstein",lu:"Luxemburg"})),{"dje-ne":"Zarmaciine (Nier)","dsb-de":"dolnoserbina (Nimska)","dua-cm":"dul (Cameroun)","dv-mv":[" ( )",!0],"dyo-sn":"joola (Senegal)","dz-bt":" ()","ebu-ke":"Kembu (Kenya)","ee-gh":"Eegbe (Ghana nutome)","ee-tg":"Eegbe (Togo nutome)","el-cy":" ()","el-gr":" ()"}),n("en","English",{"001":"World","029":"Caribbean",150:"Europe",ae:"United Arab Emirates",ag:"Antigua & Barbuda",ai:"Anguilla",as:"American Samoa",at:"Austria",au:"Australia",bb:"Barbados",be:"Belgium",bi:"Burundi",bm:"Bermuda",bs:"Bahamas",bw:"Botswana",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",ch:"Switzerland",ck:"Cook Islands",cm:"Cameroon",cx:"Christmas Island",cy:"Cyprus",de:"Germany",dk:"Denmark",dm:"Dominica",er:"Eritrea",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",gb:"United Kingdom",gd:"Grenada",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gm:"Gambia",gu:"Guam",gy:"Guyana",hk:"Hong Kong SAR",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",je:"Jersey",jm:"Jamaica",ke:"Kenya",ki:"Kiribati",kn:"St. Kitts & Nevis",ky:"Cayman Islands",lc:"St. Lucia",lr:"Liberia",ls:"Lesotho",mg:"Madagascar",mh:"Marshall Islands",mo:"Macao SAR",mp:"Northern Mariana Islands",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mw:"Malawi",my:"Malaysia",na:"Namibia",nf:"Norfolk Island",ng:"Nigeria",nl:"Netherlands",nr:"Nauru",nu:"Niue",nz:"New Zealand",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pn:"Pitcairn Islands",pr:"Puerto Rico",pw:"Palau",rw:"Rwanda",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St Helena, Ascension, Tristan da Cunha",si:"Slovenia",sl:"Sierra Leone",ss:"South Sudan",sx:"Sint Maarten",sz:"Eswatini",tc:"Turks & Caicos Islands",tk:"Tokelau",to:"Tonga",tt:"Trinidad & Tobago",tv:"Tuvalu",tz:"Tanzania",ug:"Uganda",um:"U.S. Outlying Islands",us:"United States",vc:"St. Vincent & Grenadines",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vu:"Vanuatu",ws:"Samoa",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"})),{"eo-001":"esperanto (Mondo)"}),n("es","espaol",{419:"Latinoamrica",ar:"Argentina",bo:"Bolivia",br:"Brasil",bz:"Belice",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",do:"Repblica Dominicana",ec:"Ecuador",es:"Espaa, alfabetizacin internacional",es_tradnl:"Espaa, alfabetizacin tradicional",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"Mxico",ni:"Nicaragua",pa:"Panam",pe:"Per",ph:"Filipinas",pr:"Puerto Rico",py:"Paraguay",sv:"El Salvador",us:"Estados Unidos",uy:"Uruguay",ve:"Venezuela"})),{"et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (Kamrn)","fa-ir":[" ()",!0]}),n("ff-latn","Pulaar",{bf:"Burkibaa Faaso",cm:"Kameruun",gh:"Ganaa",gm:"Gammbi",gn:"Gine",gw:"Gine-Bisaawo",lr:"Liberiyaa",mr:"Muritani",ne:"Nijeer",ng:"Nijeriyaa",sl:"Seraa liyon",sn:"Senegaal"})),{"fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"froyskt (Danmark)","fo-fo":"froyskt (Froyar)"}),n("fr","franais",{"029":"carabes",be:"Belgique",bf:"Burkina Faso",bi:"Burundi",bj:"Bnin",bl:"Saint-Barthlemy",ca:"Canada",cd:"Congo, Rpublique dmocratique du",cf:"Rpublique centrafricaine",cg:"Congo",ch:"Suisse",ci:"Cte dIvoire",cm:"Cameroun",dj:"Djibouti",dz:"Algrie",fr:"France",ga:"Gabon",gf:"Guyane franaise",gn:"Guine",gp:"Guadeloupe",gq:"Guine quatoriale",ht:"Hati",km:"Comores",lu:"Luxembourg",ma:"Maroc",mc:"Monaco",mf:"Saint-Martin",mg:"Madagascar",ml:"Mali",mq:"Martinique",mr:"Mauritanie",mu:"Maurice",nc:"Nouvelle-Caldonie",ne:"Niger",pf:"Polynsie franaise",pm:"Saint-Pierre-et-Miquelon",re:"La Runion",rw:"Rwanda",sc:"Seychelles",sn:"Sngal",sy:"Syrie",td:"Tchad",tg:"Togo",tn:"Tunisie",vu:"Vanuatu",wf:"Wallis-et-Futuna",yt:"Mayotte"})),{"fur-it":"furlan (Italie)","fy-nl":"Frysk (Nederln)","ga-ie":"Gaeilge (ire)","gd-gb":"Gidhlig (An Roghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"Avae (Paragui)","gsw-ch":"Schwiizerttsch (Schwiiz)","gsw-fr":"Elsssisch (Frnkrisch)","gsw-li":"Schwiizerttsch (Lichteschti)","gu-in":" ()","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"lelo Hawaii (Amelika Hui P Ia)","he-il":[" ()",!0],"hi-in":" ()","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbina (Nmska)","hu-hu":"magyar (Magyarorszg)","hy-am":" ()","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Ass Igbo (Najra)","ii-cn":" ()","is-is":"slenska (sland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (Citt del Vaticano)","iu-cans-ca":" ()","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":" ()","jgo-cm":"Ndaa (Kamln)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":" (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":" ()","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"  ()","kkj-cm":"kak (Kamrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":" ()","kn-in":" ()","ko-kp":" ()","ko-kr":"()","kok-in":" ()","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":" ()","ks-deva-in":"","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamrn)","ksh-de":"Klsch (Dotschland)","ku-arab-iq":["  ()",!0],"ku-arab-ir":" ()","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":" ()","la-001":"lingua latna (World)","lag-tz":"Klaangi (Taansana)","lb-lu":"Ltzebuergesch (Ltzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"Lakliyapi (Mlahaska Tamkohe)","ln-ao":"lingla (Angla)","ln-cd":"lingla (Republki ya Kong Demokratki)","ln-cf":"lingla (Repibiki ya Afrka ya Kti)","ln-cg":"lingla (Kongo)","lo-la":" ()","lrc-iq":"  (Iraq)","lrc-ir":"  (Iran)","lt-lt":"lietuvi (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latvieu (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"Kmr (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"meta (Kamalun)","mi-nz":"te reo Mori (Aotearoa)","mk-mk":" ( )","ml-in":" ()","mn-mn":" ()","mn-mong-cn":"  (    )","mn-mong-mn":"  ( )","mni-in":" (India)","moh-ca":"Kanien'kha","mr-in":" ()","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDA (kameru)","my-mm":" ()","mzn-ir":" ()","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokml (Norge)","nb-sj":"norsk bokml (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersasssch (Dtschland)","nds-nl":"Neddersasssch (Nedderlannen)","ne-in":" ()","ne-np":" ()"}),n("nl","Nederlands",{aw:"Aruba",be:"Belgi",bq:"Bonaire, Sint Eustatius en Saba",cw:"Curaao",nl:"Nederland",sr:"Suriname",sx:"Sint-Maarten"})),{"nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"Shw ngiembn (Kmalm)","nqo-gn":[" ( )",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (Frana)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":" ()","os-ge":" ()","os-ru":" ()","pa-arab-pk":[" ()",!0],"pa-in":" ()","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prsiskan (swtai)","prs-af":[" ()",!0],"ps-af":[" ()",!0],"ps-pk":[" ()",!0]}),n("pt","portugus",{ao:"Angola",br:"Brasil",ch:"Sua",cv:"Cabo Verde",gq:"Guin Equatorial",gw:"Guin-Bissau",lu:"Luxemburgo",mo:"RAE de Macau",mz:"Moambique",pt:"Portugal",st:"So Tom e Prncipe",tl:"Timor-Leste"})),{"qps-latn-x-sh":"P Sfh","qps-ploc":"[ () !!! !!]","qps-ploca":"[  ( ) !!! !!! ]","qps-plocm":["[  ( ) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (Per)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"romn (Republica Moldova)","ro-ro":"romn (Romnia)","rof-tz":"Kihorombo (Tanzania)"}),n("ru","",{by:"",kg:"",kz:"",md:"",ru:"",ua:""})),{"rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":" ()","sah-ru":" ()","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":[" ()",!0],"sd-deva-in":" (India)","se-fi":"davvismegiella (Suopma)","se-no":"davvismegiella (Norga)","se-se":"davvismegiella (Ruoa)","seh-mz":"sena (Moambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"Sng (Kdrsse t Bafrka)","shi-latn-ma":"Tasheliyt (lmrib)","shi-tfng-ma":" ()","si-lk":" ( )","sk-sk":"slovenina (Slovensko)","sl-si":"slovenina (Slovenija)","sma-no":"arjelsaemiengele (Nrje)","sma-se":"arjelsaemiengele (Sveerje)","smj-no":"julevusmegiella (Vuodna)","smj-se":"julevusmegiella (Svierik)","smn-fi":"anarkiel (Suom)","sms-fi":"smill (Lddjnnam)","sn-latn-zw":"chiShona (Zimbabwe)"}),n("so","Soomaali",{dj:"Jabuuti",et:"Itoobiya",ke:"Kenya",so:"Soomaaliya"})),{"sq-al":"shqip (Shqipri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (Kosov)"}),n("sr-cyrl","",{ba:"  ",cs:"    ()",me:" ",rs:"",xk:""})),n("sr-latn","srpski",{ba:"Bosna i Hercegovina",cs:"Srbija i Crna Gora (Biva)",me:"Crna Gora",rs:"Srbija",xk:"Kosovo"})),{"ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (land)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)"}),n("sw","Kiswahili",{cd:"Jamhuri ya Kidemokrasia ya Kongo",ke:"Kenya",tz:"Tanzania",ug:"Uganda"})),{"syr-sy":[" ()",!0],"ta-in":" ()","ta-lk":" ()","ta-my":" ()","ta-sg":" ()","te-in":" ()","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":" ()","th-th":" ()","ti-er":" ()","ti-et":" ()","tig-er":" ()","tk-tm":"Trkmen dili (Trkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"Trke (Kbrs)","tr-tr":"Trke (Trkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":" ()","twq-ne":"Tasawaq senni (Nier)","tzm-arab-ma":["   (Morocco)",!0],"tzm-latn-dz":"Tamazit n lala (Djazar)","tzm-latn-ma":"Tamazit n lala (Meuk)","tzm-tfng-ma":" ()","ug-cn":[" (  )",!0],"uk-ua":" ()","ur-in":[" ()",!0],"ur-pk":[" ()",!0],"uz-arab-af":" ()","uz-cyrl-uz":" ()","uz-latn-uz":"ozbek (Ozbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":" ()","ve-za":"Tshivena (South Africa)","vi-vn":"Ting Vit (Vit Nam)","vo-001":"Volapk (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":" ()","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (Kemeln)","yi-001":[" ()",!0],"yo-bj":"d Yorb (Orlde Bn)","yo-ng":"d Yorb (Oril-d Njr)","zgh-tfng-ma":" ()","zh-cn":"()","zh-hk":"()","zh-hans-hk":" ()","zh-hans-mo":" ()","zh-mo":"()","zh-sg":"()","zh-tw":"()","zu-za":"isiZulu (iNingizimu Afrika)"})},5730:(e,t,i)=>{i.d(t,{Y:()=>n});const n={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azrbaycan"],"az-cyrl":["az-Cyrl-AZ"," ()"],"az-latn":["az-Latn-AZ","Azrbaycanl (Latn)"],ba:"ba-RU",bas:["bas-CM","sa"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN",""],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA"," ()"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER",""],ca:"ca-ES",ccp:["ccp-Cakm-BD",""],"ccp-cakm":["ccp-Cakm-BD"," ()"],ce:["ce-RU",""],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU",""],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","dul"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT",""],ebu:["ebu-KE","Kembu"],ee:["ee-GH","Eegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA"," ()"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kak"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN",""],"ks-arab":["ks-Arab-IN"," ()"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","Klsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","Klaangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","Lakliyapi"],ln:["ln-CD","lingla"],lo:"lo-LA",lrc:["lrc-IR"," "],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","Kmr"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","meta"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN",""],mn:["mn-MN",""],"mn-cyrl":["mn-MN"," ( )"],"mn-mong":["mn-Mong-CN","  ( )"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDA"],my:["my-MM",""],mzn:["mzn-IR",""],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersasssch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","Shw ngiembn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE",""],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prsiskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","Sng"],shi:["shi-Tfng-MA",""],"shi-latn":["shi-Latn-MA","Tasheliyt (Latin)"],"shi-tfng":["shi-Tfng-MA"," (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS"," ()"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ",""],"tg-cyrl":["tg-Cyrl-TJ"," ()"],th:"th-TH",ti:"ti-ER",tig:["tig-ER",""],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","Tamazit n lala"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","Tamazit n lala (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF"," ()"],"uz-cyrl":["uz-Cyrl-UZ"," ()"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR",""],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR"," (Vai)"],ve:["ve-ZA","Tshivena"],vi:"vi-VN",vo:["vo-001","Volapk"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET",""],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001",""],yo:"yo-NG",zgh:["zgh-Tfng-MA",""],"zgh-tfng":["zgh-Tfng-MA"," (Tifinagh)"],zh:["zh-CN",""],"zh-hans":"zh-CN","zh-hant":["zh-HK","()"],zu:"zu-ZA"}},65798:(e,t,i)=>{var n,s,o,r,a,l,d,c,u,h,g;i.d(t,{ED:()=>n,fT:()=>s,xp:()=>h}),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(o||(o={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(r||(r={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(d||(d={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(c||(c={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(u||(u={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(h||(h={})),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One"}(g||(g={}))},67402:(e,t,i)=>{i.d(t,{f:()=>o});var n=i(79490),s=i(29906);let o=class{get tooltip(){return{tooltipMain:{background:"window",boxShadow:"none",border:"1px solid windowframe"},title:{color:"windowtext"},text:{color:"windowtext"}}}};o=(0,n.__decorate)([(0,s._)()],o)},73340:(e,t,i)=>{i.d(t,{U:()=>c});var n=i(79490),s=i(89400),o=i(82479),r=i(87414);const a=e=>{let t="'Segoe UI'";if(e)switch(e.toLowerCase()){case"ar":t="'Segoe UI Web (Arabic)'";break;case"bg-bg":case"ru-ru":case"uk-ua":t="'Segoe UI Web (Cyrillic)'";break;case"cs-cz":case"et-ee":case"hr-hr":case"hu-hu":case"lt-lt":case"lv-lv":case"pl-pl":case"lt-sr-sp":case"tr-tr":case"sk-sk":case"kk-kz":t="'Segoe UI Web (East European)'";break;case"el-gr":t="'Segoe UI Web (Greek)'";break;case"he-il":t="'Segoe UI Web (Hebrew)'";break;case"vi-vn":t="'Segoe UI Web (Vietnamese)'";break;case"ja-jp":t="YuGothic, 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka";break;case"ko-kr":t="'Malgun Gothic', Gulim";break;case"ch-zhs":t="'Microsoft Yahei', Verdana, Simsun";break;case"ch-zht":t="'Microsoft Jhenghei', Pmingliu";break;case"hi-in":t="'Nirmala UI'";break;case"th-th":t="'Leelawadee UI Regular', 'Kmer UI'";break;default:t="'Segoe UI Web (West European)'"}return`${t}, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif`};var l=i(29906),d=i(80617);let c=class{constructor(e,t,i){this.uxLanguageCode=e,this.themeStore=t,this.useFluentV9=i,this._calloutZIndex=Number.MAX_SAFE_INTEGER-1}get critiqueCallout(){return{shadowHost:{all:"initial",position:"absolute",zIndex:this._calloutZIndex},calloutMain:{root:{fontFamily:a(this.uxLanguageCode),borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:[{borderRadius:8,MsHighContrastAdjust:"auto",fontFamily:a(this.uxLanguageCode)}]},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get undoCallout(){return{buttonIcon:{borderRadius:"2px"},logoButtonBase:{cursor:"default",pointerEvents:"all",lineHeight:"24px",fontSize:o.s.size12,fontWeight:o.BO.semibold,WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",padding:0,margin:"0 8px",flexGrow:0,whiteSpace:"nowrap",overflow:"visible",color:s.m.palette.blue,alignSelf:"center"},calloutContainer:{height:"40px",borderRadius:"4px",padding:"4px"},calloutMain:{root:{borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:{borderRadius:8,MsHighContrastAdjust:"auto",background:d.L.colorNeutralBackground1}},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get tooltip(){var e,t,i,n,o;const l=this.useFluentV9||null===(e=this.themeStore)||void 0===e?void 0:e.getComponentActiveTheme(r.yF.squiggleTooltipComponentName);return{container:{all:"initial",position:"absolute",zIndex:Number.MAX_SAFE_INTEGER},shadowBoundary:{all:"initial"},shadowRoot:{width:"0px !important",height:"0px !important",overflowX:"hidden"},root:{position:"fixed",maxWidth:300,background:this.useFluentV9?d.L.colorNeutralBackground1:"transparent",border:"none",cursor:"default"},tooltipMain:{msHighContrastAdjust:"none",forcedColorAdjust:"none",fontFamily:a(this.uxLanguageCode),fontSize:"12px",fontWeight:600,background:this.useFluentV9?void 0:null!==(t=null==l?void 0:l.background)&&void 0!==t?t:s.m.palette.white,padding:"6px 12px",display:"inline-block",boxShadow:this.useFluentV9?`0 6.4px 14.4px 0 ${d.L.colorNeutralShadowKey}, 0 1.2px 3.6px 0 ${d.L.colorNeutralShadowAmbient}`:null!==(i=null==l?void 0:l.shadow)&&void 0!==i?i:"0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",border:"none",borderRadius:4},title:{marginBottom:"4px",color:this.useFluentV9?d.L.colorNeutralForeground2:null!==(n=null==l?void 0:l.text)&&void 0!==n?n:s.m.palette.neutralSecondary},text:{color:this.useFluentV9?d.L.colorNeutralForeground3:null!==(o=null==l?void 0:l.altText)&&void 0!==o?o:s.m.palette.black}}}};c=(0,n.__decorate)([(0,l._)()],c)},25686:(e,t,i)=>{i.d(t,{Y:()=>f,bb:()=>y,c$:()=>_});var n=i(79490),s=i(91513),o=i(68794),r=i(2915),a=i(95834),l=i(94453),d=i(329),c=i(19728),u=i(76729),h=i(29906),g=i(83010),p=i(27603),m=i(18574);const f=(0,u.f)("IDefaultStyleDefinitionsFactory"),v=(0,u.f)("IDefaultStyleOverrides"),_=(0,u.f)("IHighContrastStyleOverrides");let y=class{constructor(e,t,i,n,r,a,l){this.highContrastModeDetector=e,this.proofingStore=t,this.emitter=i,this.defaultStyleDefinitionsFactory=r,this.highContrastStyleOverrides=a,this.styleOverrides=l,this.onProofingLanguageChanged=e=>{this.styles=this.defineStyles()},this.defineStyles=()=>{const e=this.defaultStyleDefinitionsFactory(this.uxLanguage);return this.styleOverrides?{critiqueCallout:this.applyOverrides(e.critiqueCallout,this.styleOverrides.critiqueCallout),undoCallout:this.applyOverrides(e.undoCallout,this.styleOverrides.undoCallout),tooltip:this.applyOverrides(e.tooltip,this.styleOverrides.tooltip)}:e},this.getAdjustedStyle=e=>{let t=this.styles[e];return this.highContrastModeDetector.enabled&&this.highContrastStyleOverrides&&(t=this.applyOverrides(t,this.highContrastStyleOverrides[e])),t},this.applyOverrides=(e,t)=>{if(!t)return e;const i={};for(const n of Object.keys(e))i[n]=Object.assign(Object.assign({},e[n]),t[n]);return i},this.uxLanguage=n.getUILanguage(),this.styles=this.defineStyles(),this.proofingStore.read(s.l.ProofingLanguages).then((e=>{this.onProofingLanguageChanged(o.I.getDefaultLanguageCode(e))})).catch((()=>{})),this.emitter.on("proofingLanguageChanged",(async e=>{this.onProofingLanguageChanged(e.data.defaultLanguageCode)})),(0,m.Gn)(this)}get critiqueCallout(){return this.getAdjustedStyle("critiqueCallout")}get undoCallout(){return this.getAdjustedStyle("undoCallout")}get tooltip(){return this.getAdjustedStyle("tooltip")}};(0,n.__decorate)([c.observable],y.prototype,"styles",void 0),(0,n.__decorate)([c.computed],y.prototype,"critiqueCallout",null),(0,n.__decorate)([c.computed],y.prototype,"undoCallout",null),(0,n.__decorate)([c.computed],y.prototype,"tooltip",null),(0,n.__decorate)([c.action],y.prototype,"onProofingLanguageChanged",void 0),y=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(d.P)),(0,n.__param)(1,(0,g.W)(r.K)),(0,n.__param)(2,(0,g.W)(a.o)),(0,n.__param)(3,(0,g.W)(l.v)),(0,n.__param)(4,(0,g.W)(f)),(0,n.__param)(5,(0,p.l)()),(0,n.__param)(5,(0,g.W)(_)),(0,n.__param)(6,(0,p.l)()),(0,n.__param)(6,(0,g.W)(v))],y)},31959:(e,t,i)=>{i.d(t,{l:()=>te});i(42410);var n=i(21683),s=i(18104),o=i(71924),r=i(91513),a=i(2915),l=i(10138),d=i(52946),c=i(21522),u=i(30095),h=i(93844),g=i(5923),p=i(87582),m=i(27634),f=i(87309),v=i(71417),_=i(45311),y=i(16087);const I=(0,i(76729).f)("ICritiqueValueStore");var C=i(67165),S=i(754),b=i(94526),T=i(87414),E=i(77916),N=i(23957),x=i(98824),w=i(58022),L=i(76778),D=i(10219),F=i(98970),A=i(95834),R=i(68794),q=i(40315),P=i(44621),O=i(66717),k=i(77322),z=i(33511),M=i(85924),j=i(58029),W=i(23943),B=i(22696),U=i(47571),H=i(29839),V=i(88923),G=i(87615),Q=i(19728),K=i(48841),$=i(90403),J=i(60140),Z=i(94147);class Y{constructor(e,t,i,n=void 0,s,o,r=new Date){this.hostSettings=e,this.isEditorClientShutdown=!1,this.isInitialized=!1,this.isUXInitialized=!1,this._proofingDisabled=!1,this.isInlineSuggestionsMenuEnabled=!1,this.onWindowUnloaded=()=>{this.shutDown()},this.rootInjector=(0,J.p)(this,e,n,s,t,i,o),this.diContainer=this.rootInjector.container,this.roamingDictionaryFeatureObj=this.diContainer.get(N.Zp),this.externalSettingsFeatureObj=this.diContainer.get(x.In),this.userInfoUpdater=this.diContainer.get(w.M),this.hostEmitter=this.diContainer.get(L.M5),this.logger=this.diContainer.get(l.g),this.proofingDom=this.diContainer.get(W.w),this.proofingPersistedStore=this.diContainer.get(a.K),this.featureFlagReader=this.diContainer.get(D.c),e.enableOrchestration&&(this.orchestrator=this.diContainer.get(U.J)),window.frameElement&&(this.windowEventListener=new F.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnloaded)),this._editorInitializationStartTime=r}registerTextTileEventListener(e){try{return this.hostEmitter.on(L.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983245,"Failed to register hostModelTextTile listener",e),!1}}registerDeltaEventListener(e){try{return this.hostEmitter.on(L.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983244,"Failed to register hostModelDelta listener",e),!1}}registerTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.on(L.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257550,"Failed to register hostModelTextTileEmittedToAugloop listener",e),!1}}unregisterTextTileEventListener(e){try{return this.hostEmitter.off(L.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983243,"Unable to unregister hostModelTextTile listener - no listener registered",e),!1}}unregisterDeltaEventListener(e){try{return this.hostEmitter.off(L.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983242,"Unable to unregister hostModelDelta listener - no listener registered",e),!1}}unregisterTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.off(L.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257549,"Unable to unregister hostModelTextTileEmittedToAugloop listener - no listener registered",e),!1}}async setLocale(e){let t="string"==typeof e?[e]:e;0===t.length&&(t=[this.hostSettings.defaultLocale]);const i=await this.proofingPersistedStore.read(r.l.ProofingLanguages),n=t.toString()!==i.toString();await this.proofingPersistedStore.write(r.l.ProofingLanguages,t),this.diContainer.get(A.o).emit("proofingLanguageChanged",{data:new R.I(t),messageType:s.G.ChangeData,proofingLanguagesChanged:n})}async setMultiLingualProofingLocales(e){await this.setLocale(e)}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.proofingPersistedStore.write(r.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(p.D).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.proofingPersistedStore.read(r.l.EnableSpelling)}async isGrammarEnabled(){return this.proofingPersistedStore.read(r.l.EnableGrammar)}async areRefinementsEnabled(){return this.proofingPersistedStore.read(r.l.EnableRefinements)}async _enableDisableSpelling(e){await this.proofingPersistedStore.read(r.l.EnableSpelling)!==e&&(await this.proofingPersistedStore.write(r.l.EnableSpelling,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableGrammar(e){await this.proofingPersistedStore.read(r.l.EnableGrammar)!==e&&(await this.proofingPersistedStore.write(r.l.EnableGrammar,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableRefinements(e){await this.proofingPersistedStore.read(r.l.EnableRefinements)!==e&&(await this.proofingPersistedStore.write(r.l.EnableRefinements,e),this._emitEnabledCritiqueTypesChanged())}_refreshTileNodes(){this.diContainer.get(g.G).pollNodes(s.G.ChangeData,this.proofingDom.tileNodes,o.Q0.Code,void 0,!0)}clearResources(){const e=this.diContainer.getOptional(B.s);null==e||e.clearIgnoredWords()}shutDown(){var e,t,i,n;if(!this.isEditorClientShutdown)try{this.isEditorClientShutdown=!0,null===(e=this.diContainer.getOptional(G.H))||void 0===e||e.logTelemetry(),this.diContainer.unbind(q.jh),this.diContainer.unbind(q.sh),this.diContainer.unbind(q.q4),this.diContainer.unbind(q.Ze),this.diContainer.unbind(q.cg),this.diContainer.unbind(q.oA),this.clearResources(),this.diContainer.get(K.W).shutDown(),null===(t=this.windowEventListener)||void 0===t||t.removeAllListeners(),this.windowEventListener=void 0,null===(i=this.orchestrator)||void 0===i||i.shutDown(),this.diContainer.get(P.V).shutDown(),this.diContainer.get($.J).clear()}catch(e){this.logger.error(520983241,"error while shutting down the editor client.",e),null===(n=this.onError)||void 0===n||n.call(this,"Error while shutting down the editor client.",e)}}logout(){this.hostEmitter.emit(L.pD.logout,{address:void 0,message:void 0})}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}updateUserInfo(e){this.userInfoUpdater.update(e)}async initialize(e){this.isEditorClientShutdown||(await this.initializeSDK(),await this.initializeUX(e))}async initializeSDK(){var e;if(this.isEditorClientShutdown)return;if(this.isInitialized)return;this.isInitialized=!0,(0,Q.configure)({enforceActions:"observed"});const t=(0,Z.$)();if(await(null==t?void 0:t.loadLocale(this.hostSettings.defaultLocale)),await(null===(e=this.orchestrator)||void 0===e?void 0:e.initialize()),!this.isEditorClientShutdown){await this.diContainer.get(O.H).initializeComponent();try{await this.diContainer.get(k.e).executeAsync(!0)}catch(e){}}}async initializeUX(e){var t,i,n;if(!this.isEditorClientShutdown&&!this.isUXInitialized){this.isUXInitialized=!0;try{this.diContainer.bind(q.jh).toValue(new z.O(null!=e?e:document)),this.diContainer.bind(q.sh).toValue(new z.O(null!==(t=(null!=e?e:document).defaultView)&&void 0!==t?t:window)),await this.diContainer.get(K.W).initializeComponent()}catch(e){this.logger.error(509634378,"Failed to initialize ux",e),null===(i=this.onError)||void 0===i||i.call(this,"Failed to initialize ux.",e)}null===(n=this.diContainer.getOptional(V.$))||void 0===n||n.schedule(1e3,3e5),await this.initLocale(this.hostSettings.defaultLocale),this.languageDetectionSubscriber=this.diContainer.getOptional(H.X),this.logEditorInitializationComplete()}}logEditorInitializationComplete(){const e=new Date,t=(0,M.W)(["initializationEndTime",e.toISOString()],["initializationStartTime",this._editorInitializationStartTime.toISOString()],["initializationTime",e.getTime()-this._editorInitializationStartTime.getTime()],["isCIQEnabled",this.isInlineSuggestionsMenuEnabled&&(this.hostSettings.flightsToTrack||[]).includes("mc-editor-oa")]);if(this.featureFlagReader.flags.enableLoggingModulesAndBindings){const e=this.diContainer.getBindings().map((e=>`${"function"!=typeof e.token?e.token.toString():e.token.name}: [${e.boundServices.map((e=>{var t;return null===(t=e.cache)||void 0===t?void 0:t.constructor.name}))}]`)).toString();t.push(...(0,M.W)(["addedModuleClassNamesSize",this.rootInjector.addedModuleClassNames.size],["addedModuleClassNames",[...this.rootInjector.addedModuleClassNames].join(", ")],["modulesSharingSameModuleKeyButDifferentClassname",[...this.rootInjector.modulesSharingSameModuleKeyButDifferentClassname].join(", ")],["bindings",e]))}this.logger.logActivity("EditorInitializationComplete",void 0,t)}async initLocale(e){await this.setLocale(e)}setAvailableCritiqueTypes(e,t){const i=this.diContainer.getOptional(p.D);i&&(i.setAvailableCritiqueTypes(e,t),this._emitEnabledCritiqueTypesChanged())}async setPaneOnlyOverriddenCritiqueTypeOptions(e){const t=this.diContainer.getOptional(m.M);t&&(await this.proofingPersistedStore.write(r.l.PaneOverriddenCritiqueTypeOptions,e),t.setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}setAvailablePaneOnlyCritiqueTypes(e){const t=this.diContainer.getOptional(m.M);t&&(t.setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}_emitEnabledCritiqueTypesChanged(){this.diContainer.get(A.o).emit("enabledCritiqueTypesChanged",{messageType:s.G.ChangeData})}async disableProofing(){var e;if(this._proofingDisabled)return!0;if(!this.orchestrator)return!1;const t=await this.orchestrator.deactivateAnnotations([j.nL.getTypeName()]);for(const t of this.proofingDom.tileNodes)this.hostEmitter.emit(L.pD.clearCritiquesForNode,{message:{nodeId:t.id,seqId:(null!==(e=t.eventSeqId)&&void 0!==e?e:0).toString()},address:void 0});return this._proofingDisabled=!0,t}async enableProofing(){var e,t;if(!this._proofingDisabled)return;if(null===(e=this.orchestrator)||void 0===e?void 0:e.activateAnnotations([j.nL.getTypeName()])){for(const e of this.proofingDom.tileNodes)this.hostEmitter.emit(L.pD.restoreNodeForCritiqueStore,{message:{nodeId:e.id,seqId:(null!==(t=e.eventSeqId)&&void 0!==t?t:0).toString()},address:void 0});this._refreshTileNodes(),this._emitEnabledCritiqueTypesChanged(),this._proofingDisabled=!1}}addWordsToIgnoreList(e){const t=this.diContainer.getOptional(B.s);null==t||t.addWordsToIgnoreList(e)}setLanguageDetectedCallback(e){var t;null===(t=this.languageDetectionSubscriber)||void 0===t||t.setLanguageDetectedOnSignalCallback(e)}}var X=i(33851),ee=i(85339);class te extends Y{constructor(e,t,i,s=void 0,o,r,a=new Date){super(e,t,i,s,o,r,a),this.critiqueSuggestionClearanceCallbacks=[],this.updateDarkMode=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDarkMode(e)},this.getComponentsSupportedForTheming=()=>{var e,t;return null!==(t=null===(e=this.themeStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.updateDefaultTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDefaultTheme(e)},this.updateCurrentTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateCurrentTheme(e)},this.getComponentsSupportedForStyling=()=>{var e,t;return null!==(t=null===(e=this.styleStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.isPremiumUser=this.diContainer.get(n.r),this.themeStore=this.diContainer.getOptional(T.YQ),this.styleStore=this.diContainer.getOptional(T.UC),this.themeStore&&T.Cx.forEach(((e,t)=>{var i;null===(i=this.themeStore)||void 0===i||i.updateComponentThemes(t,e)})),this.styleStore&&T.w.forEach(((e,t)=>{var i;null===(i=this.styleStore)||void 0===i||i.updateComponentStyle(t,e)}))}async initLocale(e){var t,i;const n=null!==(i=this.hostSettings.isMultilingualProofingEnabled&&(null===(t=this.hostSettings.proofingLocales)||void 0===t?void 0:t.length)?this.hostSettings.proofingLocales:void 0)&&void 0!==i?i:[e];await this.setLocale(n),await this.setUiLocale(e)}async setLocale(e){const t="string"==typeof e?[e]:e;await super.setLocale(t)}async setUiLocale(e){var t;const i=(0,Z.$)().loadLocale(e);await i;const n=this.diContainer.getOptional(X.C);if(n)try{await n.setUiLocale(e)}catch(i){this.logger.error(507885057,"Failed to initialize categories locale for: "+e,i),null===(t=this.onError)||void 0===t||t.call(this,"Failed to initialize categories locale for: "+e,i)}}setLocaleForTile(e,t){const i=this.proofingDom.findTileNode(e);if(!i)return!1;i.specifiedLocale=t,i.resetState();this.diContainer.get(u.$).resetNode(i.id);return this.diContainer.get(g.G).pollNodes(s.G.NewData,[i],o.Q0.Code,void 0,!0),!0}registerCustomIconSet(e){for(const t of Object.keys(e))(0,E.Z)(t,e[t])}async setBothOverrideAndPaneOnlyOverriddenCritiqueTypeOptions(e,t){await this.proofingPersistedStore.write(r.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(p.D).setOverriddenCritiqueTypes(e);const i=this.diContainer.getOptional(m.M);i&&(await this.diContainer.get(a.K).write(r.l.PaneOverriddenCritiqueTypeOptions,t),i.setOverriddenCritiqueTypes(t)),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}setPremiumCritiqueTypes(e){this.diContainer.get(f.g).setPremiumCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}setPreviewCritiquesCount(e,t){const i=this.diContainer.get(v.Ey);i.setPreviewModeActive(!0),i.setPreviewCount(e,!0),i.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(v.Ey).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(v.Ey).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(v.Ey).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(v.Ey).setOnPreviewCritiquesCountChange(e)}onDisableCritique(e){this.diContainer.get(_.W).setOnDisableCritique(e)}onFeedbackIconClicked(e){this.diContainer.get(y.M).setOnFeedbackIconClicked(e)}async setLanguageValueFromConfigResponses(e,t,i){const n=this.diContainer.get(I);await n.setLanguageValueFromConfigResponses(e,t,i)}onApplyCritiqueSuggestion(e,t){const i=this.diContainer.get(h.a).handleApplyCritiqueSuggestion(e,t);this.critiqueSuggestionClearanceCallbacks.push(i)}exp_getActivityLogger(){return this.diContainer.get(l.g)}exp_getOaLogger(){return this.diContainer.get(d.m)}exp_getQueryDetection(){return this.diContainer.get(c.J)}onTryPremiumPreview(e){this.diContainer.get(v.Ey).setOnTryPremiumPreview(e)}onPremiumPreviewExpired(e){this.diContainer.get(v.Ey).setOnPremiumPreviewExpired(e)}getComponentThemes(e){var t;return null===(t=this.themeStore)||void 0===t?void 0:t.getComponentThemes(e)}getDefaultTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.defaultTheme}getCurrentTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme}updateComponentThemes(e,t){var i;null===(i=this.themeStore)||void 0===i||i.updateComponentThemes(e,t)}getComponentStyle(e){var t;return null===(t=this.styleStore)||void 0===t?void 0:t.getComponentStyle(e)}updateComponentStyle(e,t){var i;null===(i=this.styleStore)||void 0===i||i.updateComponentStyle(e,t)}updateFluentThemes(e){var t;null===(t=this.themeStore)||void 0===t||t.updateFluentThemes(e)}setOnCritiqueAdded(e){this.diContainer.get(C.y).setOnCritiqueAdded(e)}enableInlineSuggestionsMenu(e,t,i,n,s,o,r,a,l,d,c,u,h,g,p,m,f,v,_,y,I,C,S,b){if(!t)throw Error("You must specify a query character.");this.enableMenu(Object.assign({queryChar:t,onItemSelected:i,styles:r,onOpen:a,onClose:l,onAction:d,shouldRemoveTextOnItemSelection:c,specifiedItemsToDisplay:n,onSuggestionsUpdated:u,onRestoreFocus:h,onPreventDismissCalloutOnEvent:g,onGroupSelected:p,brandingMode:m,getLocalItems:v,isDividerShown:_,noSuggestionsHeaderInfo:y,newEntityTypes:I,newItemsById:S},C?{enableExpandedECC:!0,enableExpandedMenuSearchBar:b,supportedEntityTypes:null!=e?e:[]}:{enableExpandedECC:!1,supportedEntityTypes:e,enableScopedHeader:f}))}enableMenu(e){var t;if(!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled))return;this.isInlineSuggestionsMenuEnabled=!0;this.diContainer.get(ee.V).enableMenu(e)}disableInlineSuggestionsMenu(e){var t;if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled){this.diContainer.get(ee.V).disableInlineSuggestionsMenu(e),this.isInlineSuggestionsMenuEnabled=!1}}showInlineSuggestionsMenuWithItems(e,t,i,n,s,o,r,a){var l;if(null===(l=this.hostSettings.oaSettings)||void 0===l?void 0:l.isContextualCardEnabled){return this.diContainer.get(ee.V).renderMenuWithItems(e,t,i,n,s,o,r,a)}return Promise.resolve(!1)}async showExistingMenu(e,t,i,n,s,o,r,a,l,d){var c;if(null===(c=this.hostSettings.oaSettings)||void 0===c?void 0:c.isContextualCardEnabled){const c=this.diContainer.get(ee.V);await c.showExistingMenu(e,t,i,n,s,o,r,a,l,d)}}async showExistingMenuAtCursor(e,t,i){var n;if(!(null===(n=this.hostSettings.oaSettings)||void 0===n?void 0:n.isContextualCardEnabled))return;const s=this.diContainer.get(S.d),o=await s.getTextSelection();(null==o?void 0:o.endParagraphNode)&&void 0!==o.endPositionInParagraphNode&&await this.showExistingMenu(o.endParagraphNode.id,o.endPositionInParagraphNode-e,e,t,!1,i)}async insertAndDisplayInlineSuggestionsMenu(e,t,i){var n;if(!e)return!1;if(null===(n=this.hostSettings.oaSettings)||void 0===n?void 0:n.isContextualCardEnabled){const n=this.diContainer.get(S.d);let s,o;if(t&&i){const e=this.proofingDom.findParagraphNode(t);if(!(0,b.l)(e))return!1;s=e.parent,o=await n.getNodeInsertionPosition(s,e.element.offset+i,!0)}else{const e=await n.getTextSelection();if(!e||e.startParentElement.id!==e.endParentElement.id)return!1;s=e.startParentElement,o=e.startPosition===e.endPosition?await n.getNodeInsertionPosition(s,e.startPosition,!0):await n.getRangeOfNode(s,void 0,e.startPosition,e.endPosition-e.startPosition)}return!!o&&(await n.insert(s,void 0,0,e,!0,o,!0),!0)}return!1}shutDown(){try{super.shutDown();for(const e of this.critiqueSuggestionClearanceCallbacks)e();this.critiqueSuggestionClearanceCallbacks=[]}catch(e){this.logger.error(509690076,"error while shutting down the editor client.",e)}}notifyMenuTriggeringMethod(e){this.diContainer.get(ee.V).notifyMenuTriggeringMethod(e)}}},81266:(e,t,i)=>{i.d(t,{M:()=>a});var n=i(79490),s=i(94147);class o{static hash(e){let t=0,i=0;for(;i<e.length;)t=(t<<5)-t+e.charCodeAt(i++)|0;return t>0?t:-1*t}static format(e,...t){const i=t.length;return e.replace(/\{(\d+)\}/g,((e,n)=>n<i?t[n]:e))}static trimLeft(e){return e.replace(/^\s+/,"")}static trimRight(e){return e.replace(/\s+$/,"")}}var r=i(29906);let a=class{getMessage(e,t){const i=(0,s.$)(),n=i.getString("OnCanvasCalloutStrings",e)||i.getString("CopywriterStrings",e)||i.getString("EditorBrowserExtensionStrings",e)||i.getString("AiInsertStrings",e)||i.getString("InlineSuggestionStrings",e)||"";if(void 0===t)return n;const r=Array.isArray(t)?t:[t];return o.format(n,...r)}};a=(0,n.__decorate)([(0,r._)()],a)},33219:(e,t,i)=>{if(i.d(t,{J:()=>a}),2063!=i.j)var n=i(58360);if(2063!=i.j)var s=i(74504);if(2063!=i.j)var o=i(49890);if(2063!=i.j)var r=i(51152);class a{constructor(){this.imports=[n.$,o.k]}get uniqueId(){return(0,r.z)(507918337)}configureRootServices(e){e.bind(s.Q).toDynamicValue((e=>()=>e.getOptional(s.C)))}}},53802:(e,t,i)=>{if(i.d(t,{I:()=>c}),2063!=i.j)var n=i(33219);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(14775);if(2063!=i.j)var r=i(97446);if(2063!=i.j)var a=i(36406);if(2063!=i.j)var l=i(50575);if(2063!=i.j)var d=i(941);class c{constructor(){this.imports=[n.J,l.R]}get uniqueId(){return(0,s.z)(507918214)}configureRootServices(e){e.bind(o.iw).to(d.V),e.bind(r.S).to(a.z)}}},30516:(e,t,i)=>{if(i.d(t,{Q:()=>d}),2063!=i.j)var n=i(436);if(2063!=i.j)var s=i(66932);if(2063!=i.j)var o=i(10250);if(2063!=i.j)var r=i(25254);if(2063!=i.j)var a=i(51152);if(2063!=i.j)var l=i(97446);class d{constructor(){this.imports=[s.B,n.J]}get uniqueId(){return(0,a.z)(507918296)}configureRootServices(e){e.bind(o.Tc).to(r.l),e.bind(l.S).toExisting(o.Tc)}}},50575:(e,t,i)=>{if(i.d(t,{R:()=>d}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(70899);if(2063!=i.j)var o=i(5997);if(2063!=i.j)var r=i(91984);if(2063!=i.j)var a=i(97446);if(2063!=i.j)var l=i(4411);class d{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918307)}configureRootServices(e){e.bind(s.d).to(o.U),e.bind(r.e).to(l.N),e.bind(a.S).toExisting(r.e)}}},88772:(e,t,i)=>{if(i.d(t,{_:()=>u}),2063!=i.j)var n=i(436);if(2063!=i.j)var s=i(30076);if(2063!=i.j)var o=i(66932);if(2063!=i.j)var r=i(10250);if(2063!=i.j)var a=i(41736);if(2063!=i.j)var l=i(56314);if(2063!=i.j)var d=i(51152);if(2063!=i.j)var c=i(97446);class u{constructor(){this.imports=[o.B,n.J]}get uniqueId(){return(0,d.z)(507918305)}configureRootServices(e){e.bind(r.Tc).to(a.O),e.bind(c.S).toExisting(r.Tc),e.bind(s.i).toValue(l.q)}}},20807:(e,t,i)=>{if(i.d(t,{B:()=>l}),2063!=i.j)var n=i(76956);if(2063!=i.j)var s=i(30076);if(2063!=i.j)var o=i(76213);if(2063!=i.j)var r=i(97993);if(2063!=i.j)var a=i(51152);class l{constructor(){this.imports=[r.Q,n.E]}get uniqueId(){return(0,a.z)(507918302)}configureRootServices(e){e.bind(s.i).toValue(o._)}}},10158:(e,t,i)=>{if(i.d(t,{y:()=>v}),2063!=i.j)var n=i(55126);if(2063!=i.j)var s=i(36015);if(2063!=i.j)var o=i(33012);if(2063!=i.j)var r=i(21114);if(2063!=i.j)var a=i(67873);if(2063!=i.j)var l=i(73340);if(2063!=i.j)var d=i(30076);if(2063!=i.j)var c=i(67402);if(2063!=i.j)var u=i(25686);if(2063!=i.j)var h=i(51152);if(2063!=i.j)var g=i(97446);if(2063!=i.j)var p=i(11804);var m=i(87414);if(2063!=i.j)var f=i(76668);class v{constructor(){this.imports=[n.E,f.h]}get uniqueId(){return(0,h.z)(507918293)}configureRootServices(e){e.bind(d.i).toValue(r.r),e.bind(s.v).to(a.b),e.bind(g.S).toExisting(s.v),e.bind(o.$).to(u.bb),e.bind(u.c$).to(c.f),e.bind(u.Y).toDynamicValue((e=>{const t=e.getOptional(m.YQ),i=e.get(p.n);return e=>new l.U(e,t,!!i.useFluentV9)}))}}},24736:(e,t,i)=>{if(i.d(t,{O:()=>a}),2063!=i.j)var n=i(70717);if(2063!=i.j)var s=i(19189);if(2063!=i.j)var o=i(64225);if(2063!=i.j)var r=i(51152);class a{constructor(){this.imports=[o.C,n.D,s.f]}get uniqueId(){return(0,r.z)(507918281)}configureRootServices(e){}}},49890:(e,t,i)=>{if(i.d(t,{k:()=>l}),2063!=i.j)var n=i(81266);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(96571);if(2063!=i.j)var r=i(47048);if(2063!=i.j)var a=i(94147);class l{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918298)}configureRootServices(e){var t;const i=null!==(t=(0,a.$)())&&void 0!==t?t:new r.z;(0,a.Y)(i),e.bind(o.H).to(n.M)}}},4411:(e,t,i)=>{i.d(t,{N:()=>m});var n=i(79490),s=i(68794),o=i(91513),r=i(2915),a=i(10138),l=i(96571),d=i(70899),c=i(50208),u=i(19728),h=i(29906),g=i(83010),p=i(18574);let m=class{constructor(e,t,i,n,r){this._proofingStore=e,this._logger=t,this._settingsEmitter=i,this._localizer=n,this._languageInfo=r,this._languageAddMode=!1,this._actionStatus="",this._selectedKey=null,this.getLocalized=e=>this._localizer.getMessage(e),this.getLanguageName=e=>{var t;const i=this._languageInfo.getLanguageInfo(e);return null!==(t=null==i?void 0:i.languageName)&&void 0!==t?t:e},this.updateProofingLanguages=async()=>{const e=new s.I(await this._proofingStore.read(o.l.ProofingLanguages));(0,u.runInAction)((()=>{this.proofingLanguages=e}))},this.setActionStatus=(e,t)=>{const i=this.getLanguageName(t),n=t===i?t:`${t}. ${i}`,s=this._localizer.getMessage(e,n);this._actionStatus=s},this.proofingLanguages=new s.I(this._proofingStore.getDefaultValue(o.l.ProofingLanguages)),(0,p.Gn)(this)}get languageAddMode(){return this._languageAddMode}get actionStatus(){return this._actionStatus}get canAddLanguage(){return this.proofingLanguages.count<3}get canRemoveLanguage(){return this.proofingLanguages.count>1}get selectedKey(){return this._selectedKey}addSelected(){const e=this._selectedKey;!e||this.proofingLanguages.count>=3||(this.proofingLanguages.add(e),this.setActionStatus("ebx_languageAdded",e),this.setLanguageAddMode(!1))}remove(e){this.proofingLanguages.count>1&&(this.proofingLanguages.remove(e),this.setActionStatus("ebx_languageRemoved",e))}moveUp(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveUp(e),this.setActionStatus("ebx_languageMovedUp",e))}moveDown(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveDown(e),this.setActionStatus("ebx_languageMovedDown",e))}moveToTop(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveToTop(e),this.setActionStatus("ebx_languageMovedToTop",e))}setLanguageAddMode(e){this._languageAddMode=e}async revertChanges(){const e=new s.I(await this._proofingStore.read(o.l.ProofingLanguages));(0,u.runInAction)((()=>{this.proofingLanguages=e}))}async save(){await this._proofingStore.write(o.l.ProofingLanguages,this.proofingLanguages.codesList),this._logger.debug(512242964,`[ProofingLanguageStateStore] Saved proofing languages setting: ${this.proofingLanguages.codesList}`),await this._proofingStore.read(o.l.ProofingLanguageListInitialized)||await this._proofingStore.write(o.l.ProofingLanguageListInitialized,!0)}async initialize(){this._settingsEmitter.on(o.l.ProofingLanguages,this.updateProofingLanguages),this._logger.debug(512242963,"[ProofingLanguageStateStore] Sending load languages request to background script"),this.proofingLanguages=new s.I(await this._proofingStore.read(o.l.ProofingLanguages))}shutDown(){}setSelectedKey(e){this._selectedKey=e}};(0,n.__decorate)([u.observable],m.prototype,"proofingLanguages",void 0),(0,n.__decorate)([u.observable],m.prototype,"_languageAddMode",void 0),(0,n.__decorate)([u.computed],m.prototype,"languageAddMode",null),(0,n.__decorate)([u.observable],m.prototype,"_actionStatus",void 0),(0,n.__decorate)([u.computed],m.prototype,"actionStatus",null),(0,n.__decorate)([u.computed],m.prototype,"canAddLanguage",null),(0,n.__decorate)([u.computed],m.prototype,"canRemoveLanguage",null),(0,n.__decorate)([u.observable],m.prototype,"_selectedKey",void 0),(0,n.__decorate)([u.computed],m.prototype,"selectedKey",null),(0,n.__decorate)([u.action],m.prototype,"addSelected",null),(0,n.__decorate)([u.action],m.prototype,"remove",null),(0,n.__decorate)([u.action],m.prototype,"moveUp",null),(0,n.__decorate)([u.action],m.prototype,"moveDown",null),(0,n.__decorate)([u.action],m.prototype,"moveToTop",null),(0,n.__decorate)([u.action],m.prototype,"setLanguageAddMode",null),(0,n.__decorate)([u.action],m.prototype,"setSelectedKey",null),(0,n.__decorate)([u.action],m.prototype,"setActionStatus",void 0),m=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(r.K)),(0,n.__param)(1,(0,g.W)(a.g)),(0,n.__param)(2,(0,g.W)(c.E)),(0,n.__param)(3,(0,g.W)(l.H)),(0,n.__param)(4,(0,g.W)(d.d))],m)},70129:(e,t,i)=>{i.d(t,{E:()=>l});var n=i(79490),s=i(29906);let o=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise(((t,i)=>{this.execute(e,(e=>(this.lastError?i(this.lastError):t(e),e)))}))}};o=(0,n.__decorate)([(0,s._)()],o);var r=i(11804),a=i(83010);let l=class extends o{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,a.W)(r.n))],l)},47478:(e,t,i)=>{i.d(t,{q:()=>_});var n=i(8520),s=i(26598),o=i(30833);if(2063!=i.j)var r=i(17806);var a=i(30076);if(2063!=i.j)var l=i(56252);var d=i(21711),c=i(14775),u=i(40315),h=i(11804),g=i(87414);if(2063!=i.j)var p=i(86620);if(2063!=i.j)var m=i(6029);if(2063!=i.j)var f=i(62558);const v=(0,s.F5)({editorCanvasInjectableComponents:o.A.onAll(a.i).optional(),guidGenerator:o.A.on(d.G),languageScriptDirectionDetector:o.A.on(c.iw).optional(),targetWindowRef:o.A.on(u.sh),hostSettings:o.A.on(h.n),themeStore:o.A.on(g.YQ)}),_=()=>{const{editorCanvasInjectableComponents:e,guidGenerator:t,hostSettings:i,languageScriptDirectionDetector:o,targetWindowRef:a,themeStore:d}=(0,s.KN)(v),c=n.useRef(t.generate()),[u,h]=n.useState(null==o?void 0:o.uxLanguageDir),[_,y]=n.useState(d.getFluentActiveTheme());n.useEffect((()=>{if(o){const e=e=>{h(e.uxLanguageDir)};return o.subscribe("stateUpdated",e),()=>{o.unsubscribe("stateUpdated",e)}}return()=>{}}),[o]),n.useEffect((()=>{const e=()=>{y(d.getFluentActiveTheme())};return d.subscribe("currentThemeUpdated",e),d.subscribe("defaultThemeUpdated",e),d.subscribe("fluentThemesUpdated",e),()=>{d.unsubscribe("currentThemeUpdated",e),d.unsubscribe("defaultThemeUpdated",e),d.unsubscribe("fluentThemesUpdated",e)}}),[d]);const I=()=>{const t=null==e?void 0:e.map(((e,t)=>n.createElement(e,{key:"injectableComponent"+t})));return n.createElement(l.q,{theme:_},n.createElement(g.O1.Provider,{value:!!i.useFluentV9},n.createElement(m.Q,null,t)))},C=a.deref();return n.createElement("div",{dir:u,style:{all:"initial"}},n.createElement(f.IF,{window:null!=C?C:window},i.renderWithinShadowDOM||!i.useFluentV9&&i.renderWithinSeparateLayer?n.createElement(n.Fragment,null,n.createElement(p.U,{id:c.current,style:{position:"fixed",zIndex:null!==(S=i.editorCardZIndex)&&void 0!==S?S:1e6,inset:0,visibility:"hidden"}}),n.createElement(r.d.Provider,{value:c.current},I())):I()));var S}},11092:(e,t,i)=>{i.d(t,{C:()=>c});var n=i(74504),s=i(94461),o=i(88688),r=i(26598),a=i(30833),l=i(8520);const d=(0,r.F5)({squigglerCanvasRenderingState:a.A.on(n.C),contentEditableSquigglerComponent:a.A.on(s.u).optional(),inputControlsSquigglerComponent:a.A.on(o.$K).optional()}),c=()=>{const{contentEditableSquigglerComponent:e,inputControlsSquigglerComponent:t,squigglerCanvasRenderingState:i}=(0,r.KN)(d),n=[],s=[],[o,a]=l.useState(i);if(l.useEffect((()=>(i.subscribe("stateUpdated",a),()=>{i.unsubscribe("stateUpdated",a)})),[i]),!o.visible)return null;if(e)for(const[t,s]of o.squigglers)i.getTileVisibility(s.proofedElements[0].id)&&n.push(e(t,s));if(t)for(const e of o.inputControlsProxyList)s.push(t(e));return l.createElement(l.Fragment,null,...s,...n)}},13707:(e,t,i)=>{i.d(t,{D:()=>k});var n=i(79490),s=i(59556),o=i(95523),r=i(18104),a=i(33511),l=i(1527),d=i(95834),c=i(21711),u=i(10138),h=i(52041),g=i(11804),p=i(12478),m=i(9178);class f{constructor(e,t,i,n,s,o,r){this.hostSettings=e,this.calloutStateStore=t,this.undoCalloutStateStore=i,this.squiggleTooltipStateStore=n,this.critiqueStore=r,this.squigglerFlagCritiqueHandler=new p.G(t,s,i,o)}hideCallout(){var e;this.calloutStateStore.isVisible&&!this.calloutStateStore.isApplyingCritiqueAction&&(this.calloutStateStore.recordInstrumentationEventId(12),this.calloutStateStore.hide()),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}async showCallout(e){var t,i,n,s;null===(t=this.squiggleTooltipStateStore)||void 0===t||t.hide();const r=null===(i=this.critiqueStore)||void 0===i?void 0:i.getCritique(e.critique.traceId,e.critique.nodeId),a=Object.assign(Object.assign({},e),{critique:r?(0,o.OE)(r):e.critique});if(!(null===(s=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.squigglerSettings)||void 0===s?void 0:s.onSquiggleClicked)||this.hostSettings.serviceSettings.squigglerSettings.onSquiggleClicked(a.critique))if((0,o.r3)(a.critique))await this.squigglerFlagCritiqueHandler.showFlagCritique(a);else{if(this.undoCalloutStateStore&&e.squiggleKind===m.Ah.autocorrection)return this.undoCalloutStateStore.show(a);await this.calloutStateStore.show(a)}}}class v{constructor(e,t,i,n){this.squiggleTooltipStateStore=e,this.calloutStateStore=t,this.undoCalloutStateStore=i,this.hostSettings=n}showTooltip(e){var t,i,n,s,o;const{squiggleKind:r,critique:a,position:l,origin:d,targetDocument:c}=e;if(!(null===(t=this.calloutStateStore)||void 0===t?void 0:t.isVisible)&&!(null===(i=this.undoCalloutStateStore)||void 0===i?void 0:i.isVisible)){if(!d&&!(null===(n=this.hostSettings)||void 0===n?void 0:n.enableCSSHighlightApiSquiggleRendering))return;(null===(s=this.squiggleTooltipStateStore)||void 0===s?void 0:s.isVisible)&&this.squiggleTooltipStateStore.hide(),null===(o=this.squiggleTooltipStateStore)||void 0===o||o.show(r,a,l,d,c)}}hideTooltip(){var e;null===(e=this.squiggleTooltipStateStore)||void 0===e||e.hide()}}var _=i(94461),y=i(88688),I=i(36015),C=i(13558),S=i(64299),b=i(85339),T=i(26279),E=i(5645),N=i(76729);const x=(0,N.f)("ICritiqueCardNativeApi");(0,N.f)("IECCNativeApi");var w=i(30095),L=i(94526),D=i(8694),F=i(23943),A=i(754),R=i(29906),q=i(83010),P=i(27603),O=i(19728);let k=class extends s.z{constructor(e,t,i,n,s,d,c,u,h,g,p,m,_,y,I,C,S,b){super(),this.proofingEventListener=e,this.squigglerStateStoreFactory=t,this.inputControlsStateStoreFactory=i,this.calloutStateStore=n,this.settings=s,this.guidGenerator=d,this.squiggleTooltipStateStore=c,this._logger=u,this.critiqueApplicationHandler=h,this.proofingDom=g,this.safeWindow=p,this.tileContent=m,this.hostSettings=_,this.inlineSuggestionsRenderer=y,this.squigglePositioningEdgeCases=I,this.undoCalloutStateStore=C,this.nativeApi=S,this.critiqueStore=b,this.anchorElements=new Map,this.squigglers=new Map,this.visible=!0,this.tileVisibility=new Map,this.inputControlsProxyList=[],this._inputControlsProxyListCache=[],this.setVisibility=e=>{this.visible=e,this.publishStateChange()},this.setVisibilityForTile=(e,t)=>{var i,n,s,o,r,a,l,d;if(this.tileVisibility.set(e,t),!t){e===(null===(n=null===(i=this.inlineSuggestionsRenderer)||void 0===i?void 0:i.getCurrentMenuInfo())||void 0===n?void 0:n.parentTileId)&&this.inlineSuggestionsRenderer.dismissMenu();const t=null===(s=this.calloutStateStore.critique)||void 0===s?void 0:s.nodeId,c=this.proofingDom.findParagraphNode(null!=t?t:"");e===(null===(o=null==c?void 0:c.parent)||void 0===o?void 0:o.id)&&this.calloutStateStore.hide();const u=null===(a=null===(r=this.undoCalloutStateStore)||void 0===r?void 0:r.critique)||void 0===a?void 0:a.nodeId,h=this.proofingDom.findParagraphNode(null!=u?u:"");e===(null===(l=null==h?void 0:h.parent)||void 0===l?void 0:l.id)&&(null===(d=this.undoCalloutStateStore)||void 0===d||d.hide())}this.publishStateChange()},this.getTileVisibility=e=>{var t;return null===(t=this.tileVisibility.get(e))||void 0===t||t},this.getSquigglerForTile=e=>{const t=this.anchorElements.get(e);return t?this.squigglers.get(t.id):void 0},this.getCritiqueCount=e=>{var t;return!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null!==(t=null==e?void 0:e.getCritiques().length)&&void 0!==t?t:0},this.update=e=>(!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null==e?void 0:e.updateSquiggles()),this.updateSquiggleRanges=e=>{if(e)return void e.updateRanges();if(0===this.squigglers.size)return;const t=new Set(this.squigglers.values());for(const e of t)e.updateRanges()},this.navigate=(e,t)=>{!t&&this.squigglers.size>0&&(t=Array.from(this.squigglers.values())),t&&(this.calloutStateStore.setNavInfo({stores:t,ctr:"contenteditable",currentIndex:0,category:"category",onCloseNavigation:()=>{e()},onNavSuggestionApplied:()=>{this.calloutStateStore.navigate(0)}}),this.calloutStateStore.navigate(0))},this.clearSquiggles=(e,t,i)=>{1===e.proofedElements.length&&e.proofedElements[0].id===t?(this.anchorElements.delete(t),this.squigglers.delete(i),this.publishStateChange(),e.dispose()):e.removeCritiques(t).then((()=>{e.isEmpty&&(this.squigglers.delete(i),this.anchorElements.delete(t),e.dispose()),this.publishStateChange()}))},this.displayFlag=async e=>{const t={critique:e,issueText:"",setInitialFocus:!1,onDismiss(e){},onIgnoreOnce:this.onIgnoreOnce,onIgnoreAll:this.onIgnoreAll,onApplyFlag:this.onApplyFlag};await this.critiqueCalloutHandler.showCallout(t)},this.onApplyFlag=async(e,t,i)=>{await this.applyChange(e,(async(n,s)=>{await n.applyFlagSuggestion(s,void 0,e.nodeId,e,t,i)}))},this.applyChange=(e,t)=>{const i=this.proofingDom.findParagraphNode(e.nodeId);return(0,L.l)(i)&&i.parent.element?t(this.critiqueApplicationHandler,i.parent.element):Promise.resolve()},this.onIgnoreOnce=e=>{(0,o.r3)(e)&&this.applyChange(e,((t,i)=>{t.ignoreFlagOnce(i,void 0,e.nodeId,e)}))},this.onIgnoreAll=e=>{(0,o.r3)(e)&&this.applyChange(e,((t,i)=>{t.ignoreAllOfCritique(i,void 0,e.nodeId,e)}))},this.setSquiggler=(e,t)=>{this.squigglers.set(e,t),this.publishStateChange()},this.notifyHost=e=>{var t,i;const n=e.data.critiquesToElementsMap;if(e.messageType===r.G.NewData)for(const e of n)null===(t=this.nativeApi)||void 0===t||t.critiqueCountChanged(e.critiques.length);else if(e.messageType===r.G.RemoveData)for(const e of n){this.anchorElements.get(e.elementId)&&(null===(i=this.nativeApi)||void 0===i||i.critiqueCountChanged(e.critiques.length))}},this.getAnchorElement=(e,t)=>{var i;let n=this.anchorElements.get(e);if(n){const t=n.elementRef.deref();if(null==t?void 0:t.isConnected)return n;this.clearSquiggler(e),this.anchorElements.delete(e)}let s=t;const o=null===(i=this.squigglePositioningEdgeCases)||void 0===i?void 0:i.getEdgeCases(),r=null==o?void 0:o.find((e=>e.match(t)));if(null==r?void 0:r.getAnchorElement){let i;s=r.getAnchorElement(t);for(const t of this.anchorElements.values())t.elementRef.deref()===s&&(this.anchorElements.set(e,t),i=t);n=i}else{if(t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(s=e)}if("true"===s.getAttribute(this.settings.editorSpellcheckAttribute)){let t;for(const i of this.anchorElements.values())i.elementRef.deref()===s&&(this.anchorElements.set(e,i),t=i);n=t}}return n||(n={id:this.guidGenerator.generate(),elementRef:new a.O(s)},this.anchorElements.set(e,n)),n},this._zoomScale=1,this.updateInputControlsProxyListCache=e=>{0===this._inputControlsProxyListCache.length&&0===e.length||(this._inputControlsProxyListCache=e,this.safeWindow.requestAnimationFrame((()=>{0===this.inputControlsProxyList.length&&0===this._inputControlsProxyListCache.length||(this.inputControlsProxyList=this._inputControlsProxyListCache,this.publishStateChange())})))},this.buildInputAndTextAreaList=e=>{if(!this.inputControlsStateStoreFactory)return;this._inputControlsProxyListCache=this._inputControlsProxyListCache.map((e=>(e.messageItem.changed=!1,e)));const t=e.data.critiquesToElementsMap;for(const e of t){if(!e.element)continue;const t=this.tileContent.getContainingElement(e.element);if(!t)continue;if(!(0,l.C)(t,"HTMLInputElement")&&!(0,l.C)(t,"HTMLTextAreaElement"))continue;const i=this.getAnchorElement(e.elementId,t);if(i){this._inputControlsProxyListCache=this._inputControlsProxyListCache.filter((e=>e.messageItem.anchor.id!==i.id));const t={entry:{elementId:e.elementId,element:e.element,critiques:e.critiques},anchor:{element:i.elementRef.deref(),id:i.id},changed:!0};this._inputControlsProxyListCache.push(this.inputControlsStateStoreFactory({messageItem:t,critiqueCalloutHandler:this.critiqueCalloutHandler,tooltipHandler:this.tooltipHandler,disableClearOnFocusFix:!1}))}}this.updateInputControlsProxyListCache(this._inputControlsProxyListCache)},this.buildContentEditableList=async e=>{if(!this.squigglerStateStoreFactory)return;const t=e.data.critiquesToElementsMap;if(e.messageType===r.G.NewData||e.messageType===r.G.ChangeData)await(0,O.transaction)((async()=>{if(this.squigglerStateStoreFactory)for(const i of t){if(!i.element)continue;const t=this.proofingDom.findTileNode(i.elementId);if(!t)continue;const n=this.tileContent.getContainingElement(i.element);if(!n)continue;if((0,l.C)(n,"HTMLInputElement")||(0,l.C)(n,"HTMLTextAreaElement")||!(0,l.C)(n,"HTMLElement"))continue;const s=this.getAnchorElement(i.elementId,n);let o;if(s&&(o=this.squigglers.get(s.id)),!s||!i.critiques.length){s&&o&&!i.critiques.length&&this.clearSquiggles(o,i.elementId,s.id);continue}const r={id:i.elementId,graphNode:t,element:n,critiques:i.critiques};o?await o.setCritiques(r,e.data.isVisualStateChange):(o=this.squigglerStateStoreFactory(r,s.elementRef.deref(),s.id,this.critiqueCalloutHandler,this.tooltipHandler),1!==this._zoomScale&&o.scaleTransform(this._zoomScale),this.setSquiggler(s.id,o))}}));else if(e.messageType===r.G.RemoveData)for(const e of t)this.clearSquiggler(e.elementId)},this.critiqueCalloutHandler=new f(this.hostSettings,this.calloutStateStore,this.undoCalloutStateStore,this.squiggleTooltipStateStore,this.inlineSuggestionsRenderer,this._logger,this.critiqueStore),this.tooltipHandler=new v(this.squiggleTooltipStateStore,this.calloutStateStore,this.undoCalloutStateStore,this.hostSettings)}async initialize(){this.proofingEventListener.emit("squiggleUXReadyEvent",{messageType:r.G.NewData})}shutDown(){var e;if(this.squigglers.size)for(const e of this.squigglers.values())e.dispose();this.squigglers.clear(),this.anchorElements.clear(),this.calloutStateStore.hide(),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide(),this.publishStateChange()}publishStateChange(){this.publishEvent("stateUpdated",{squigglers:this.squigglers,inputControlsProxyList:this.inputControlsProxyList,visible:this.visible})}clearSquiggler(e){const t=this.anchorElements.get(e);if(!t)return;const i=this.squigglers.get(t.id);i&&this.clearSquiggles(i,e,t.id)}async onCritiqueForUiEvent(e){this.buildInputAndTextAreaList(e),await this.buildContentEditableList(e),this.notifyHost(e)}setZoomScale(e){this._zoomScale=e;for(const[,t]of this.squigglers)t.scaleTransform(e)}};k=(0,n.__decorate)([(0,R._)(),(0,n.__param)(0,(0,q.W)(d.o)),(0,n.__param)(1,(0,P.l)()),(0,n.__param)(1,(0,q.W)(_.f)),(0,n.__param)(2,(0,P.l)()),(0,n.__param)(2,(0,q.W)(y.iV)),(0,n.__param)(3,(0,q.W)(I.v)),(0,n.__param)(4,(0,q.W)(D.k)),(0,n.__param)(5,(0,q.W)(c.G)),(0,n.__param)(6,(0,q.W)(C.A)),(0,n.__param)(6,(0,P.l)()),(0,n.__param)(7,(0,q.W)(u.g)),(0,n.__param)(8,(0,q.W)(S.i)),(0,n.__param)(9,(0,q.W)(F.w)),(0,n.__param)(10,(0,q.W)(h.j)),(0,n.__param)(11,(0,q.W)(A.d)),(0,n.__param)(12,(0,q.W)(g.n)),(0,n.__param)(13,(0,P.l)()),(0,n.__param)(13,(0,q.W)(b.V)),(0,n.__param)(14,(0,P.l)()),(0,n.__param)(14,(0,q.W)(T._)),(0,n.__param)(15,(0,P.l)()),(0,n.__param)(15,(0,q.W)(E.x)),(0,n.__param)(16,(0,P.l)()),(0,n.__param)(16,(0,q.W)(x)),(0,n.__param)(17,(0,P.l)()),(0,n.__param)(17,(0,q.W)(w.$))],k)},97526:(e,t,i)=>{i.d(t,{t:()=>o});var n=i(8520),s=i(81350);class o extends n.Component{constructor(e){super(e),this.retryTimer=0,this.labelErrorStyle={display:"none"},this.tryRecover=()=>{var e;this.props.maxRecoveryRetry>(this.state.retryNumber||0)&&(window.clearTimeout(this.retryTimer),this.retryTimer=window.setTimeout((()=>{var e;const t=(null!==(e=this.state.retryNumber)&&void 0!==e?e:0)+1;this.setState({hasError:!1,retryNumber:t})}),1e3*(null!==(e=this.state.retryNumber)&&void 0!==e?e:1)))},this.state={hasError:!1,retryNumber:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var i;const{logger:n,errorEventName:o,errorMessage:r}=this.props;s.R.logUnhandledError(n,{error:e,errorInfo:t,retryCount:null!==(i=this.state.retryNumber)&&void 0!==i?i:0},o,r)}componentWillUnmount(){window.clearTimeout(this.retryTimer)}componentDidUpdate(){this.state.hasError&&this.tryRecover()}render(){return this.state.hasError?n.createElement("div",{"aria-hidden":"true",style:this.labelErrorStyle,className:"ms-editor-rendering-error"},`${this.state.retryNumber}/${this.props.maxRecoveryRetry}`):this.props.children}}},81350:(e,t,i)=>{if(i.d(t,{R:()=>o}),2063!=i.j)var n=i(13290);if(2063!=i.j)var s=i(45242);class o{static logUnhandledError(e,t,i,o){e.logEvent(508055843,i,n.q.Error,o,s.o.SamplingPolicy.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,i){}}},88500:(e,t,i)=>{i.d(t,{a:()=>a});var n=i(79490),s=i(11804);var o=i(29906),r=i(83010);let a=class{constructor(e){this._hostSettings=e,this._getWorkerUrl=()=>new Promise((e=>{var t;const i=new MessageChannel;i.port1.onmessage=({data:t})=>{var n;i.port1.close(),e(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:null)},null===(t=this._dmp)||void 0===t||t.postMessage(["get-url"],[i.port2])})),this._callworker=(e,t,i)=>new Promise(((n,s)=>{var o;const r=new MessageChannel;r.port1.onmessage=({data:e})=>{r.port1.close(),e.error?s(e.error):n(e.result)},null===(o=this._dmp)||void 0===o||o.postMessage([e,t,i],[r.port2])}))}async initialize(){var e;if(null===(e=this._dmp)||void 0===e||e.terminate(),this._hostSettings.disableInlineWorkerLoader)this._dmp=new Worker(new URL(i.p+i.u(2063),i.b));else{const e=i(15679);this._dmp=new e.default}if(this._hostSettings.validateWorkerUrl){const e=await this._getWorkerUrl();await this._hostSettings.validateWorkerUrl(e)||this.shutDown()}}shutDown(){var e;null===(e=this._dmp)||void 0===e||e.terminate(),this._dmp=void 0}async getReadjustedIndices(e,t,i,n){var s;const o=null!==(s=e.textContent)&&void 0!==s?s:"",r=n?i:o,a=n?o:i;return await this._callworker(r,a,t)}};a=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.n))],a)},41416:(e,t,i)=>{var n=i(23750);const s=new n.diff_match_patch;s.Diff_Timeout=0;const o=(e,t)=>e.index>=0?(e.index=t,e):t;addEventListener("message",(e=>{"get-url"!==e.data[0]?(e=>{try{const i=[],n=e.data[0],r=e.data[1],a=e.data[2],l=s.diff_main(n,r);1===l.length&&0===l[0][0]&&e.ports[0].postMessage({result:a});let d=0,c=0,u=0,h=0,g=0,p=0;for(const e of l){const n=e[0],s=e[1].length;switch(n){case 0:g=s,p=s;break;case 1:g=0,p=s;break;case-1:u+=s;continue}c+=u,u=0;for(let e=d;e<a.length;e+=1){const s=(t=a[e]).index>=0?t.index:t;if(s<h)throw new Error("Indices are not sorted!");if(!(s>=h&&s<h+p))break;i[e]=o(a[e],0===n?s+c-h:c),d+=1}if(d===a.length)break;c+=g,h+=p}for(let e=d;e<a.length;e+=1)i[e]=o(a[e],c);e.ports[0].postMessage({result:i})}catch(t){e.ports[0].postMessage({error:t})}var t})(e):e.ports[0].postMessage({url:self.location.href})}),!1)},50378:(e,t,i)=>{i.d(t,{R:()=>f});var n=i(79490),s=i(35294),o=i(21711),r=i(44621),a=i(2915),l=i(8447),d=i(10138),c=i(10219),u=i(11804),h=i(81350),g=i(29906),p=i(83010),m=i(27603);let f=class{constructor(e,t,i,n,s,o,r){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=i,this._sessionContextProvider=n,this._logger=s,this._featureFlagsReader=o,this._hostSettings=r}async initializeComponent(){let e;await this._featureFlagsReader.refreshFlags();try{this._sessionContextProvider&&(e=await this._sessionContextProvider())}catch(e){}await this._logger.initialize(this._proofingPersistedStore,this._featureFlagsReader,e,void 0,this._hostSettings),this._logger.debug(520984581,"Logger initialized"),h.R.addUnhandledExceptionsListeners(this._logger,s.s.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(520984580,"Initializing telemetry");const t=this._guidGenerator.generate();this._logger.addCorrelationID(t),this._logger.debug(520984579,"Registering listeners"),await this._registrar.initialize()}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(o.G)),(0,n.__param)(1,(0,p.W)(r.V)),(0,n.__param)(2,(0,p.W)(a.K)),(0,n.__param)(3,(0,p.W)(l.a)),(0,n.__param)(3,(0,m.l)()),(0,n.__param)(4,(0,p.W)(d.g)),(0,n.__param)(5,(0,p.W)(c.c)),(0,n.__param)(6,(0,p.W)(u.n))],f)},83485:(e,t,i)=>{i.d(t,{y:()=>n});const n=(0,i(76729).f)("IEditorClient")},48841:(e,t,i)=>{i.d(t,{W:()=>n});const n=(0,i(76729).f)("IReactComponentInitializer")},60140:(e,t,i)=>{i.d(t,{p:()=>c});i(42410);if(2063!=i.j)var n=i(58918);if(2063!=i.j)var s=i(90403);if(2063!=i.j)var o=i(70431);if(2063!=i.j)var r=i(83485);if(2063!=i.j)var a=i(11804);if(2063!=i.j)var l=i(56275);if(2063!=i.j)var d=i(38536);const c=(e,t,i,c,u,h,g)=>{const p=new s.J(t.generateModuleKey),m=p.container;m.bind(o.p).toValue(m),m.bind(o.k).toValue(m.resolveNew),m.bind(s.J).toValue(p),m.bind(r.y).toValue(e),m.bind(a.n).toValue(t),m.bind(d.K).toValue(h),i&&m.bind(n.P).toValue(i),null==g||g(m),"configureRootServices"in c?p.addModule(c):m.bind(l.qy).toValue(c);for(const e of u)p.addModule(e);return p}},38536:(e,t,i)=>{i.d(t,{K:()=>n});i(42410);const n=(0,i(76729).f)("ReactComponentModules")},88397:(e,t,i)=>{if(i.d(t,{s:()=>o}),2063!=i.j)var n=i(33511);const s="__reactEvents";class o{constructor(e){this.element=new n.O(e),this.replacedElements=[],this.ownerDocument=new n.O(e.ownerDocument)}replaceListener(e){var t;if(!e)return;const i=new n.O(e),o=e.addEventListener,r=new n.O(o),a={},l=[];for(const t in e)t.startsWith(s)&&l.push(t);e.addEventListener=(e,t,n)=>{const s=r.deref(),o=i.deref();s&&o&&(e in a||(a[e]=[]),a[e].push({listener:t,options:n}),s.apply(o,[e,t,n]))};null===(t=this.replacedElements)||void 0===t||t.push({element:i,eventHandlers:a,restoreOriginalAddEventListener:()=>{e.addEventListener=o},existingReactEvents:l})}render(e){var t,i;const n=null===(t=this.element)||void 0===t?void 0:t.deref(),o=null===(i=this.ownerDocument)||void 0===i?void 0:i.deref();if(o&&n){this.replaceListener(n),this.replaceListener(n.firstElementChild),this.replaceListener(n.host),this.replaceListener(o),this.replaceListener(o.defaultView);try{return e()}finally{if(this.replacedElements)for(let e=this.replacedElements.length-1;e>=0;e--){const t=this.replacedElements[e],i=t.element.deref(),n=t.restoreOriginalAddEventListener;if(null==n||n(),t.restoreOriginalAddEventListener=void 0,i&&t.existingReactEvents){t.reactEventsToClear=[];for(const e in i)e.startsWith(s)&&!t.existingReactEvents.includes(e)&&t.reactEventsToClear.push(e)}t.existingReactEvents=void 0}}}}cleanup(){var e;if(!this.replacedElements||!this.ownerDocument)return;const t=this.ownerDocument.deref();for(const i of this.replacedElements){for(const n in i.eventHandlers){const s=i.element.deref();for(const o of i.eventHandlers[n])null==s||s.removeEventListener(n,o.listener,o.options),null===(e=null==t?void 0:t.defaultView)||void 0===e||e.removeEventListener(n,o.listener,o.options);if(s&&i.reactEventsToClear)for(const e of i.reactEventsToClear)s[e]=void 0}i.eventHandlers={}}this.replacedElements=void 0,this.ownerDocument=void 0,this.element=void 0}}},35294:(e,t,i)=>{var n;i.d(t,{s:()=>n}),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(n||(n={}))},16946:(e,t,i)=>{if(i.d(t,{b:()=>l}),2063!=i.j)var n=i(74736);if(2063!=i.j)var s=i(25643);if(2063!=i.j)var o=i(436);if(2063!=i.j)var r=i(80593);if(2063!=i.j)var a=i(51152);class l{constructor(){this.imports=[n.u,r.r,s.v,o.J]}get uniqueId(){return(0,a.z)(507918295)}configureRootServices(e){}}},3646:(e,t,i)=>{if(i.d(t,{f:()=>O}),2063!=i.j)var n=i(19189);if(2063!=i.j)var s=i(94461);if(2063!=i.j)var o=i(29291);if(2063!=i.j)var r=i(5992);if(2063!=i.j)var a=i(84032);if(2063!=i.j)var l=i(92729);if(2063!=i.j)var d=i(18272);if(2063!=i.j)var c=i(9097);if(2063!=i.j)var u=i(32652);if(2063!=i.j)var h=i(85533);if(2063!=i.j)var g=i(329);if(2063!=i.j)var p=i(30095);if(2063!=i.j)var m=i(93844);if(2063!=i.j)var f=i(91322);if(2063!=i.j)var v=i(68514);if(2063!=i.j)var _=i(754);if(2063!=i.j)var y=i(23943);if(2063!=i.j)var I=i(29583);if(2063!=i.j)var C=i(71417);if(2063!=i.j)var S=i(16087);if(2063!=i.j)var b=i(45311);if(2063!=i.j)var T=i(22696);if(2063!=i.j)var E=i(51152);if(2063!=i.j)var N=i(52041);if(2063!=i.j)var x=i(10219);if(2063!=i.j)var w=i(11804);if(2063!=i.j)var L=i(45462);if(2063!=i.j)var D=i(10138);if(2063!=i.j)var F=i(76778);if(2063!=i.j)var A=i(44170);if(2063!=i.j)var R=i(91984);if(2063!=i.j)var q=i(6003);var P=i(8520);class O{constructor(){this.imports=[n.f]}get uniqueId(){return(0,E.z)(507847257)}configureRootServices(e){e.bind(s.u).toDynamicValue((e=>{const t=e.get(N.j),i=e.get(x.c),n=e.get(w.n),s=e.get(o.g),a=e.get(g.P);return(e,o)=>P.createElement(r.$,{key:`squiggler-${e}`,state:o,deps:{safeWindow:t,featureFlagsReader:i,hostSettings:n,squigglerUXFactory:s,highConstrastModeDetector:a}})})),e.bind(a.Vw).to(l.U),e.bind(s.f).toDynamicValue((t=>{const i=e.get(_.d),n=e.get(L.f),s=e.get(D.g),o=e.getAll(F.zJ),r=e.get(F.M5),l=e.get(w.n),g=e.get(y.w),E=e.get(a.Vw),N=e.getOptional(I.M),x=e.getOptional(C.Ey),P=e.getOptional(d.mU),O=e.getOptional(A.z),k=e.getOptional(S.M),z=e.getOptional(b.W),M=e.getOptional(p.$),j=e.getOptional(m.a),W=e.getOptional(f.K),B=e.getOptional(T.s),U=e.getOptional(R.rI),H=e.getOptional(c.PF),V=e.getOptional(v.m),G=e.getOptional(u.A);return(t,a,d,c,u,p={})=>new h.i({proofedItem:t,anchorElement:a,anchorId:d,critiqueCalloutHandler:c,tooltipHandler:u,options:e.get(q.z)(p)},i,n,o,r,l,g,E,s,N,x,P,O,k,z,M,j,W,B,U,H,V,G)}))}}},51028:(e,t,i)=>{if(i.d(t,{f:()=>c}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(56275);if(2063!=i.j)var o=i(11804);if(2063!=i.j)var r=i(21711);if(2063!=i.j)var a=i(79323);if(2063!=i.j)var l=i(79204);if(2063!=i.j)var d=i(53357);class c{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918277)}configureRootServices(e){e.getOptional(s.qy)||e.bind(s.qy).toDynamicValue((e=>{var t;const i=e.get(o.n),{sessionId:n=e.get(r.G).generate(),appPlatform:s="DefaultAppPlatform",appName:c="DefaultAppName",appScenario:u="",releaseAudienceGroup:h="",clientVersion:g=""}=null!==(t=i.hostMetadata)&&void 0!==t?t:{},p=[(0,d.m9)("Session.Id",n),(0,d.m9)("App.Platform",s),(0,d.m9)("App.Name",c),(0,d.m9)("App.Scenario",u),(0,d.m9)("Release.AudienceGroup",h),(0,d.m9)("App.Version",g)],m=new a.r(p,{endpointUrl:l.d.PUBLIC});return m.setFullEventsEnabled(!1),m}))}}},36071:(e,t,i)=>{if(i.d(t,{w:()=>r}),2063!=i.j)var n=i(436);if(2063!=i.j)var s=i(18557);if(2063!=i.j)var o=i(51152);class r{constructor(){this.imports=[s.N,n.J]}get uniqueId(){return(0,o.z)(50786e4)}configureRootServices(e){}}},58360:(e,t,i)=>{if(i.d(t,{$:()=>b}),2063!=i.j)var n=i(50378);if(2063!=i.j)var s=i(28825);if(2063!=i.j)var o=i(32652);if(2063!=i.j)var r=i(69287);if(2063!=i.j)var a=i(68241);if(2063!=i.j)var l=i(51152);if(2063!=i.j)var d=i(66717);if(2063!=i.j)var c=i(2915);if(2063!=i.j)var u=i(97446);if(2063!=i.j)var h=i(77322);if(2063!=i.j)var g=i(58022);if(2063!=i.j)var p=i(26420);if(2063!=i.j)var m=i(8694);if(2063!=i.j)var f=i(33931);if(2063!=i.j)var v=i(79034);if(2063!=i.j)var _=i(10965);var y=i(87414);if(2063!=i.j)var I=i(67234);if(2063!=i.j)var C=i(70129);if(2063!=i.j)var S=i(4185);class b{constructor(){this.imports=[a.u]}get uniqueId(){return(0,l.z)(507918284)}configureRootServices(e){e.bind(d.H).to(n.R),e.bind(y.UC).to(y.h1),e.bind(y.YQ).to(y.ZP),e.bind(o.A).toDynamicValue((e=>{const t=e.get(y.YQ);return()=>t.currentTheme===y.SV.highContrast})),e.bind(p.h).to(s.e),e.bind(m.k).toExisting(p.h),e.bind(_.z).toExisting(p.h),e.bind(r.D).toExisting(p.h),e.bind(v.N).toExisting(p.h),e.bind(S.C).toSelf(),e.bind(f.B).toExisting(S.C),e.bind(c.K).to(I.B),e.bind(u.S).toExisting(S.C),e.bind(u.S).toExisting(c.K),e.bind(h.e).to(C.E),e.bind(g.M).toExisting(h.e)}}},97993:(e,t,i)=>{if(i.d(t,{Q:()=>u}),2063!=i.j)var n=i(91264);if(2063!=i.j)var s=i(75542);if(2063!=i.j)var o=i(27745);if(2063!=i.j)var r=i(46290);if(2063!=i.j)var a=i(68833);if(2063!=i.j)var l=i(436);if(2063!=i.j)var d=i(51152);if(2063!=i.j)var c=i(97446);class u{constructor(){this.imports=[o.d,l.J,n.w]}get uniqueId(){return(0,d.z)(507918280)}configureRootServices(e){e.bind(r.K).toSelf(),e.bind(c.S).toExisting(r.K),e.bind(a.Y).to(a.h),e.bind(s.V).to(s.S),e.bind(c.S).toExisting(s.V)}}},6003:(e,t,i)=>{if(i.d(t,{S:()=>u,z:()=>c}),2063!=i.j)var n=i(51152);if(2063!=i.j)var s=i(10219);if(2063!=i.j)var o=i(11804);if(2063!=i.j)var r=i(65024);if(2063!=i.j)var a=i(26279);if(2063!=i.j)var l=i(30392);if(2063!=i.j)var d=i(41693);const c=(0,i(76729).f)("ISquigglerOptionsFactory");class u{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918274)}configureRootServices(e){e.bind(c).toDynamicValue((e=>{const t=e.get(s.c),i=e.get(o.n),n=e.getOptional(a._);return(e={})=>{const s=t.flags.enableSvgSquiggleUnderline?r.N.SVG:i.sessionType===o.d.OWA_New_Email||i.sessionType===o.d.OWA_Draft_Email?r.N.OFFICE:r.N.GENERIC;e.edgeCases=null==n?void 0:n.getEdgeCases(),e.visibilityTracker=t.flags.enableVisibilityTracker?new l.J:l.Y,e.throttleUpdates=t.flags.enableSquigglesUpdateThrottling,e.visibilityTrackerShouldTrackSquiggles=t.flags.visibilityTrackerShouldTrackSquiggles,e.mutationObserverBasedRelativePosition=t.flags.mutationObserverBasedRelativePosition,e.enableCursorIntersectionObserver=t.flags.enableCursorIntersectionObserver,e.disableAutoBrowserVirtualizationOfSquiggles=t.flags.disableAutoBrowserVirtualizationOfSquiggles;let a=d.j.none;t.flags.enableAriaStatusElement&&(t.flags.enableCssHighlightApiAnnouncementsOnly?a|=d.j.cssHighlightsAPIAnnouncement:a|=d.j.appearance|d.j.highlight,t.flags.enableLineNavAriaAnnouncement&&(a|=d.j.lineNavigation));const c=e;return c.restoreCaretPosition=!!i.enableCaretPositionRestore,c.ariaFeatures=a,c.tooltipEnabled=!!i.showSquiggleTooltip,c.disableSquiggleTooltipOnTextSelection=!!i.disableSquiggleTooltipOnTextSelection,c.squiggleStyleType=s,c.autoCorrectionEnabled=i.enableAutoCorrect,c.personalizedAutoCorrectionEnabled=i.enablePersonalizedAutoCorrect,c.autoCorrectionInputCacheEnabled=i.enableAutoCorrect&&t.flags.enableAutoCorrectInputCache,c.trackProofingElementsPositionEnabled=i.dynamicProofingElementsEnabled,c.disableRangeWhenApplyingCritiqueSuggestions=i.disableRangeWhenApplyingCritiqueSuggestions,c.disableOpenAutoCorrectCalloutOnHover=i.disableOpenAutoCorrectCalloutOnHover,c}}))}}},64225:(e,t,i)=>{if(i.d(t,{C:()=>c}),2063!=i.j)var n=i(30076);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(97446);if(2063!=i.j)var r=i(19189);if(2063!=i.j)var a=i(74504);if(2063!=i.j)var l=i(11092);if(2063!=i.j)var d=i(13707);class c{constructor(){this.imports=[r.f]}get uniqueId(){return(0,s.z)(507918273)}configureRootServices(e){e.bind(n.i).toValue(l.C),e.bind(a.C).to(d.D),e.bind(o.S).toExisting(a.C)}}},99534:(e,t,i)=>{if(i.d(t,{H:()=>r}),2063!=i.j)var n=i(48841);if(2063!=i.j)var s=i(81012);if(2063!=i.j)var o=i(51152);class r{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918243)}configureRootServices(e){e.bind(n.W).to(s.M)}}},84045:(e,t,i)=>{if(i.d(t,{e:()=>a}),2063!=i.j)var n=i(76752);if(2063!=i.j)var s=i(51152);if(2063!=i.j)var o=i(97446);if(2063!=i.j)var r=i(88500);class a{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918239)}configureRootServices(e){e.bind(n.h).to(r.a),e.bind(o.S).toExisting(n.h)}}},67234:(e,t,i)=>{i.d(t,{B:()=>v});var n=i(79490),s=i(29815),o=i(52148),r=i(16708),a=i(98448),l=i(50208),d=i(91513),c=i(13290),u=i(11804),h=i(29906),g=i(83010);const p=new Map([[d.l.EnableCopilotInsert,!0],[d.l.EnableCopilotRewrite,!0],[d.l.EnableSpelling,!0],[d.l.EnableGrammar,!0],[d.l.EnableRefinements,!0],[d.l.EnableTelemetry,!0]]),m=new Map([[d.l.AppId,"EditorBX_Online"],[d.l.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}])],[d.l.ProofingLanguages,[]],[d.l.CritiqueValuePerLanguage,JSON.stringify([])],[d.l.DefaultProofingLanguageInitialized,!1],[d.l.ProofingLanguageListInitialized,!1],[d.l.IsLanguageAutoDetectEnabled,!0],[d.l.TonalFREAccepted,!1],[d.l.EnableEditor,!0],[d.l.EnableTextPrediction,!0],[d.l.EnableCIQFlags,!0],[d.l.EnableCIQMenu,!0],[d.l.OverriddenCritiqueTypeOptions,[]],[d.l.OverriddenInlineEditingSettings,[]],[d.l.PaneOverriddenCritiqueTypeOptions,[]],[d.l.StealthOverriddenCritiqueTypeOptions,[]],[d.l.ShowSynonyms,!1],[d.l.EnableSynonymsToggle,!1],[d.l.ConfigurationId,""],[d.l.ClientId,""],[d.l.HashedUserDictionary,[]]]),f=new Map([[d.l.DefaultLoggingLevel,c.q.Info],[d.l.DebugMode,!1]]);let v=class extends s.u{constructor(e,t,i,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i,this._hostSettings=n,this.write(d.l.AppId,this._hostSettings.appId)}populateStoreEntryMap(){const e=new Map;return p.forEach(((t,i)=>{e.set(i,{storeEntry:(0,o.EM)(i,t),isSynced:!0})})),m.forEach(((t,i)=>{e.set(i,{storeEntry:(0,o.EM)(i,t)})})),f.forEach(((t,i)=>{e.set(i,{storeEntry:(0,o.EM)(i,t,!0)})})),e}async initialize(){for(const e of p.keys())await this.read(e);await this.read(d.l.ConfigurationId);const e=Array.from(p.keys());e.push(...Array.from(m.keys())),e.push(...Array.from(f.keys()));for(const t of e)this._emitter.on(t,(()=>this.read(t)))}shutDown(){}async read(e){return e===d.l.AppId?Promise.resolve(this._hostSettings.appId):super.read(e)}async removePersistentKeys(){const e=Array.from(p.keys());e.push(...Array.from(m.keys())),e.push(...Array.from(f.keys())),e.length&&await this.storeEntryWriter.remove(e)}};v=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(r.A)),(0,n.__param)(1,(0,g.W)(a.a)),(0,n.__param)(2,(0,g.W)(l.E)),(0,n.__param)(3,(0,g.W)(u.n))],v)},4185:(e,t,i)=>{i.d(t,{C:()=>g});var n,s=i(79490),o=i(29815),r=i(52148),a=i(16708),l=i(98448),d=i(50208);!function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(n||(n={}));var c=i(29906),u=i(83010);const h=new Map([[n.CourtesyAttributes,["data-gramm"]],[n.RootContentMaxLengthInChars,500]]);let g=class extends o.u{constructor(e,t,i){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i}populateStoreEntryMap(){const e=new Map;return h.forEach(((t,i)=>{e.set(i,{storeEntry:(0,r.Tm)(i,t),isSynced:!1})})),e}async initialize(){for(const e of h.keys())await this.read(e),this._emitter.on(e,(async()=>{await this.read(e)}))}shutDown(){}async removePersistentKeys(){const e=Array.from(h.keys());e.length&&await this.storeEntryWriter.remove(e)}};g=(0,s.__decorate)([(0,c._)(),(0,s.__param)(0,(0,u.W)(a.A)),(0,s.__param)(1,(0,u.W)(l.a)),(0,s.__param)(2,(0,u.W)(d.E))],g)},28825:(e,t,i)=>{i.d(t,{e:()=>d});var n=i(79490),s=i(96753),o=i(11804),r=i(29906),a=i(83010),l=i(65798);let d=class extends s.a{constructor(e){super(),this.hostSettings=e,this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?l.fT.Paragraph:l.fT.Sentence,this.partialTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?l.fT.Sentence:l.fT.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.n))],d)},26420:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(76729).f)("IEditorClientSettings")},81012:(e,t,i)=>{i.d(t,{M:()=>w});var n=i(79490),s=(i(42410),i(8520)),o=i(94329),r=i(10138),a=i(11804),l=i(40315),d=i(33511),c=i(14775),u=i(21711),h=i(98970),g=i(6142),p=i(47478),m=i(97526),f=i(35294),v=i(88397),_=i(8826),y=i(5284),I=i(34645);class C{constructor(e){var t,i,n;this.injector=e,this.render=()=>{var e,t;const i=this.injector.container.get(r.g);o.render(s.createElement(m.t,{errorEventName:f.s.UnhandledContentError,logger:i,maxRecoveryRetry:10,errorMessage:"Unhandled render content script error"},s.createElement(_.U,{injector:this.injector},s.createElement(p.q,null))),null!==(t=null===(e=this.editorCardShadowRoot)||void 0===e?void 0:e.firstElementChild)&&void 0!==t?t:this.editorCard)},this.onWindowUnload=()=>{try{this.shutDown()}catch(e){}};const u=this.injector.container.get(a.n);this.targetDocument=null!==(t=this.injector.container.getOptional(l.jh))&&void 0!==t?t:new d.O(document);const h=this.injector.container.getOptional(c.iw),g=this.targetDocument.deref();g&&(this.editorCard=g.createElement("editor-card"),this.editorCard.setAttribute("style",`position:absolute;top:0px;left:0px;z-index:${null!==(i=u.editorCardZIndex)&&void 0!==i?i:"auto"};display: block !important`),h&&this.editorCard.setAttribute("dir",h.dir()),g.body.appendChild(this.editorCard),this.editorCardShadowRoot=u.renderWithinShadowDOM&&g!==document?this.editorCard.attachShadow({mode:"open"}):void 0,this.editorCardShadowRoot&&(this.editorCardShadowRoot.appendChild(document.createElement("div")),(null===(n=u.disposalSettings)||void 0===n?void 0:n.enableReactEventCleanup)&&(this.reactEventCleanup=new v.s(this.editorCardShadowRoot))))}async initialize(){var e;if(!this.targetDocument||!this.editorCard)return;const t=this.targetDocument.deref();if(!t)return;const i=this.injector.container.get(r.g);i.debug(520984577,"[ReactApp] Render main app view");const n=this.injector.container.get(a.n);if(this.editorCardShadowRoot||!n.disableStyleCopying&&t!==document){const i=this.injector.container.get(u.G);this.disposal=n.enablePersistentStyleCopying?(0,y.wn)(t,i):(0,I.WH)(null!==(e=this.editorCardShadowRoot)&&void 0!==e?e:t.head)}window.frameElement&&(this.windowEventListener=new h.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnload,{once:!0})),this.injector.container.bind(l.q4).toValue(new g.l(this.editorCard,i,"Target render element ref is unavailable")),this.reactEventCleanup?this.reactEventCleanup.render(this.render):this.render()}shutDown(){var e,t,i,n,s,r;try{null===(e=this.disposal)||void 0===e||e.call(this)}catch(e){}if(this.editorCard)try{o.unmountComponentAtNode(null!==(i=null===(t=this.editorCardShadowRoot)||void 0===t?void 0:t.firstElementChild)&&void 0!==i?i:this.editorCard)}catch(e){}null===(n=this.reactEventCleanup)||void 0===n||n.cleanup(),this.reactEventCleanup=void 0,null===(s=this.windowEventListener)||void 0===s||s.removeAllListeners(),this.windowEventListener=void 0,this.disposal=void 0,null===(r=this.editorCard)||void 0===r||r.remove(),this.editorCard=void 0,this.editorCardShadowRoot=void 0,this.targetDocument=void 0}}var S=i(44621),b=i(38536),T=i(29906),E=i(83010),N=i(90403);let x=class{constructor(e){this._injector=e,this._initialized=!1,this._shutDown=!1}async initializeComponent(){if(this._initialized)return;this._initialized=!0;const e=this._injector.container.getOptional(b.K);if(e){const t=e.map((e=>e())),i=await Promise.all(t);for(const e of i)if(Array.isArray(e))for(const t of e)this._injector.addModule(t);else this._injector.addModule(e);await this._injector.container.get(S.V).recheckRegistrables(this._injector.container)}this._shutDown||(this.reactApp=await this.loadReactApp(),this._shutDown?this.reactApp.shutDown():await this.reactApp.initialize())}shutDown(){var e;this._shutDown=!0,null===(e=this.reactApp)||void 0===e||e.shutDown(),this.reactApp=void 0}};x=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,E.W)(N.J))],x);let w=class extends x{async loadReactApp(){return new C(this._injector)}};w=(0,n.__decorate)([(0,T._)()],w)},33008:(e,t,i)=>{var n;i.d(t,{_:()=>n}),function(e){e[e.Remote=0]="Remote",e[e.System=1]="System",e[e.User=2]="User"}(n||(n={}))},52148:(e,t,i)=>{if(i.d(t,{EM:()=>o,Hs:()=>r,Tm:()=>s}),2063!=i.j)var n=i(33008);const s=(e,t)=>({name:e,storeEntryType:n._.Remote,defaultValue:t,lastValueFromStorage:void 0}),o=(e,t,i)=>({name:e,storeEntryType:n._.User,defaultValue:t,lastValueFromStorage:void 0,shouldNotWriteDefaultValue:i});var r;!function(e){e.FeatureFlags="featureFlags",e.DynamicSettings="dynamicSettings"}(r||(r={}))},7427:(e,t,i)=>{i.d(t,{tx:()=>S});var n=i(79490),s=i(59556),o=i(13290),r=i(45242),a=i(10138),l=i(29906),d=i(83010),c=i(93443),u=i(77322),h=i(13441);let g=class extends h.t{constructor(e){super(e)}checkUserInfo(){return void 0===this.ageGroup||this.ageGroup===c.P2.Adult||this.ageGroup===c.P2.MinorNoParentalConsentRequired||this.ageGroup===c.P2.Unknown}};g=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],g);let p=class extends h.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===c.P2.NotAdult}};p=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],p);let m=class extends h.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===c.P2.MinorWithoutParentalConsent||this.ageGroup===c.P2.MinorWithParentalConsent}};m=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],m);var f=i(27603),v=i(51771),_=i(50208),y=i(16708),I=i(52148);const C={enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableOptimizedRehydration:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,enableAriaStatusElement:!1,enableCssHighlightApiAnnouncementsOnly:!1,enableLineNavAriaAnnouncement:!1,enableCSSHighlightApiSquiggleRendering:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,mutationObserverBasedRelativePosition:!1,visibilityTrackerShouldTrackSquiggles:!0,enableCursorIntersectionObserver:!1,isMsitUser:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1,enablePersonalizedAutoCorrect:!1,enableParagraphUpdates:!1,enableForceClearCritiques:!0,enableConditionalSignInMessage:!1,disableCalcLengthForAddDeltasInPresentation:!0,enableAnnotationActivationConfig:!0,enableAutoCorrectInputCache:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!1,enablePhraseTextUnitClientSide:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableParagraphDeltas:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableParagraphDeltasEmptyInitialTile:!1,enableGDocsAnnotatedCanvas:!1,disableTileNodeObserver:!1,enableQueryOnlyOnLocalChange:!1,enableSvgSquiggleUnderline:!1,enableEditorServiceRouting:!1,enableCopywriter:!1,disableCalloutOnDoubleClick:!1,disableAutoBrowserVirtualizationOfSquiggles:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!0,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,enableSquigglesOnlyOnWholeWords:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1,enableAttributionRangeExceptionInFormattedTextDeltas:!1,enableAttributionRangeInAddDelta:!1};let S=class{constructor(e,t,i,n,o,r){this._emitter=e,this._storeEntryReader=t,this._logger=i,this._isAdult=n,this._isMinor=o,this._isChild=r,this._defaultAdultOnlyFeature={enableUpsellFeature:!0},this._defaultMinorAndAboveFeature={enableBxTelemetry:!0,enableRateExtensionPrompt:!0,enableRateExtensionPromptEdge:!0,enableRateExtensionPromptFpsSurvey:!0,enableOcvIntEndpoint:!0,enableOcvFeedbackUi:!0,enableUninstallSurvey:!0},this._defaultFeatureFlags=Object.assign(Object.assign(Object.assign({},this._defaultMinorAndAboveFeature),this._defaultAdultOnlyFeature),C),this._rolloutFeatureFlags=(0,I.Tm)(I.Hs.FeatureFlags,C),this._localFlags=Object.assign({},this._defaultFeatureFlags),this._flagOverrides={},this.updatedAdultOnlyFeatureFlags=e=>{var t;const i=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isAdult)||void 0===t?void 0:t.check()),n=Object.assign({},this._defaultAdultOnlyFeature);for(const t in this._defaultAdultOnlyFeature)n[t]=i&&e[t];return n},this.updateMinorAndAboveFeatureFlags=e=>{var t,i;const n=!this.areAgeGroupPredicatesProvided()||(!!(null===(t=this._isMinor)||void 0===t?void 0:t.check())||!!(null===(i=this._isAdult)||void 0===i?void 0:i.check())),s=Object.assign({},this._defaultMinorAndAboveFeature);for(const t in this._defaultMinorAndAboveFeature)s[t]=n&&e[t];return s},this.areAgeGroupPredicatesProvided=()=>!!(this._isAdult&&this._isChild&&this._isMinor),this._eventPublisher=new s.z}get flags(){return this._localFlags}overrideFlags(e){this._flagOverrides=e,this.applyFlagOverrides()}applyFlagOverrides(){this._localFlags=Object.assign(Object.assign({},this._localFlags),this._flagOverrides)}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(I.Hs.FeatureFlags,(()=>{this.updateFlags()})),await this.updateFlags()}shutDown(){}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutFeatureFlags);let t=Object.assign(Object.assign({},this._defaultFeatureFlags),...Object.entries(e).map((([e,t])=>{return{[e]:(i=t,"string"==typeof i?"true"===i.toLowerCase():!0===i)};var i})));if(t.enableAadc){const e=this.updateMinorAndAboveFeatureFlags(t),i=this.updatedAdultOnlyFeatureFlags(t);t=Object.assign(Object.assign(Object.assign({},t),e),i)}this._localFlags=t,this.applyFlagOverrides(),this.publishEvent("flagsChanged",this.flags)}catch(e){this._logger.logEvent(571318787,v.s.FeatureFlagParsingError,o.q.Error,void 0,r.o.SamplingPolicy.Diagnostics)}}subscribe(e,t){this._eventPublisher.subscribe(e,t)}unsubscribe(e,t){this._eventPublisher.unsubscribe(e,t)}publishEvent(e,t){this._eventPublisher.publishEvent(e,t)}};S=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(_.E)),(0,n.__param)(1,(0,d.W)(y.A)),(0,n.__param)(2,(0,d.W)(a.g)),(0,n.__param)(3,(0,f.l)()),(0,n.__param)(3,(0,d.W)(g)),(0,n.__param)(4,(0,f.l)()),(0,n.__param)(4,(0,d.W)(p)),(0,n.__param)(5,(0,f.l)()),(0,n.__param)(5,(0,d.W)(m))],S)},53939:(e,t,i)=>{i.d(t,{b:()=>a});var n=i(79490),s=i(29906),o=i(83010),r=i(78972);let a=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const i={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1},n={};n[e]=JSON.stringify(i),await this._extensionStorage.set(n)}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.D))],a)},16708:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(76729).f)("IStoreEntryReader")},98448:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(76729).f)("IStoreEntryWriter")},96131:(e,t,i)=>{i.d(t,{t:()=>h});var n=i(79490),s=i(13290),o=i(45242),r=i(10138),a=i(29906),l=i(83010),d=i(51771),c=i(78972),u=i(53939);let h=class extends u.b{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const i=JSON.parse(t.value);return t.manualOverride&&void 0!==i?i:(e.lastValueFromStorage=i,void 0!==i?i:e.defaultValue)}}else try{return e.shouldNotWriteDefaultValue||await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(521479644,d.s.SettingInitializeError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}catch(e){this._logger.logEvent(521479643,d.s.SettingReadError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(521479642,d.s.SettingReadError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.get(e.name);if(t[e.name]){return JSON.parse(t[e.name])}}};h=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(c.D)),(0,n.__param)(1,(0,l.W)(r.g))],h)},16579:(e,t,i)=>{i.d(t,{r:()=>h});var n=i(79490),s=i(13290),o=i(45242),r=i(10138),a=i(29906),l=i(83010),d=i(51771),c=i(78972),u=i(53939);let h=class extends u.b{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let i=!1;const n=await this._extensionStorage.get(e.name);if(n[e.name]){i=JSON.parse(n[e.name]).manualOverride}i?this._logger.logEvent(521479641,d.s.SettingManualOverrideWarning,s.q.Warn,`manual override for store entry ${e.name} - writing skipped`,o.o.SamplingPolicy.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(521479640,d.s.SettingWriteError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async remove(e){await this._extensionStorage.remove(e)}};h=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(c.D)),(0,n.__param)(1,(0,l.W)(r.g))],h)},51771:(e,t,i)=>{var n,s;i.d(t,{M:()=>n,s:()=>s}),function(e){e.RemoteSettingSync="RemoteSettingSync"}(n||(n={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError",e.DynamicSettingsParsingError="RunTimeErrors.DynamicSettingsParsingError"}(s||(s={}))},50208:(e,t,i)=>{i.d(t,{E:()=>n});const n=(0,i(76729).f)("ISettingsEmitterBase")},98880:(e,t,i)=>{i.d(t,{G:()=>a});var n=i(79490);var s=i(29906),o=i(83010),r=i(78972);let a=class{constructor(e){this._browserStorage=e,this.registrations={},this.eventNamesUsed=new Set,this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]={listeners:[]}),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback);for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}_storageChangeDispatcher(e,t){for(const t of Object.keys(e)){const i=JSON.parse(e[t].oldValue),n=JSON.parse(e[t].newValue);(null==i?void 0:i.value)!==(null==n?void 0:n.value)&&this.callListeners(t,e[t].newValue)}}callListeners(e,t){const i=e,n=this.safelyGetRegistration(i);for(const e of n.listeners)e(t)}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0===e)return void(this.registrations={});if(void 0===t)return void(this.registrations[e]={listeners:[]});if(!((e,t)=>{let i=!1;for(let n=0;n<e.length;n+=1)e[n]===t&&(i=!0,e.splice(n,1),n-=1);return i})(this.safelyGetRegistration(e).listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}emit(e,...t){const i=this.safelyGetRegistration(e);for(const e of i.listeners)e(...t)}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.D))],a)},5348:(e,t,i)=>{if(i.d(t,{H:()=>m}),2063!=i.j)var n=i(7427);if(2063!=i.j)var s=i(78972);if(2063!=i.j)var o=i(51152);if(2063!=i.j)var r=i(10219);if(2063!=i.j)var a=i(97446);if(2063!=i.j)var l=i(50208);if(2063!=i.j)var d=i(16708);if(2063!=i.j)var c=i(98448);if(2063!=i.j)var u=i(32120);if(2063!=i.j)var h=i(98880);if(2063!=i.j)var g=i(96131);if(2063!=i.j)var p=i(16579);class m{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918231)}configureRootServices(e){e.bind(r.c).to(n.tx),e.bind(a.S).toExisting(r.c),e.bind(d.A).to(g.t),e.bind(c.a).to(p.r),e.bind(s.D).to(u.h),e.bind(a.S).toExisting(s.D),e.bind(l.E).to(h.G),e.bind(a.S).toExisting(l.E)}}},45746:(e,t,i)=>{if(i.d(t,{p:()=>u}),2063!=i.j)var n=i(1509);if(2063!=i.j)var s=i(28039);if(2063!=i.j)var o=i(51152);if(2063!=i.j)var r=i(11804);if(2063!=i.j)var a=i(97446);if(2063!=i.j)var l=i(88923);if(2063!=i.j)var d=i(5348);if(2063!=i.j)var c=i(65229);class u{constructor(){this.imports=[d.H,s.k]}get uniqueId(){return(0,o.z)(507918238)}configureRootServices(e){e.bind(n.qq).toDynamicValue((e=>{const t=e.get(r.n);return new n.qq({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(l.$).to(c.o),e.bind(a.S).toExisting(l.$)}}},29815:(e,t,i)=>{i.d(t,{u:()=>o});var n=i(79490),s=i(29906);let o=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),i=t.storeEntry;return{storeEntryValue:void 0===i.lastValueFromStorage?i.defaultValue:i.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}async removePersistentKeys(){}};o=(0,n.__decorate)([(0,s._)()],o)},88923:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(76729).f)("IRemoteSettingsSyncer")},65229:(e,t,i)=>{i.d(t,{o:()=>S});var n=i(79490),s=i(65798),o=i(1509),r=i(13290),a=i(45242),l=i(91513),d=i(2915),c=i(10138),u=i(77322),h=i(8447),g=i(21711),p=i(68336),m=i(29906),f=i(83010),v=i(51771),_=i(53939),y=i(78972);function I(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}function C(e){return{descriptors:I(e.descriptors),disabledWebSites:I(e.disabledWebSites),allowedUrls:I(e.allowedUrls),disabledGrammars:I(e.disabledGrammars),editorClientState:I(e.editorClientState),configurationId:I(e.configurationId),featureFlags:I(e.featureFlags),dynamicSettings:I(e.dynamicSettings),intervalForActivityCleanup:I(e.intervalForActivityCleanup),conflictingElements:I(e.conflictingElements)}}let S=class extends _.b{constructor(e,t,i,n,s,o,r,a){super(e),this._editorService=t,this._proofingStore=i,this._logger=n,this._userInfoStrategy=s,this._sessionContextProvider=o,this._guidGenerator=r,this._timer=a,this._timerName="RemoteSettingsSyncerTimer"}async initialize(){}shutDown(){this._timer.clearTimer(this._timerName)}schedule(e,t){this._timer.setIntervalWithDelay(this._timerName,(async()=>this.sync()),t,e)}async sync(){this._logger.debug(537518984,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===s.ED.Success){this.logTelemetry(e);const i=C(t),n=await this.removeManualOverrides(i);if(n)return this._logger.debug(537518985,"Writing remote settings to local storage"),this.writeSettings(n)}}return this._logger.debug(537518986,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.set(e),!0}catch(e){this._logger.logEvent(537518987,v.s.SettingsSyncWriteError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(l.l.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(l.l.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){var e;try{const t=await this._sessionContextProvider();let i,n;const s=await this.fetchClientId(),o=await this._userInfoStrategy.executeAsync(!1);(null==o?void 0:o.userId)?(this._editorService.xUserId=o.userId,i=o.tenantId,n=o.email):this._editorService.xUserId=s;return{appId:await this._proofingStore.read(l.l.AppId),browser:t.browserType,browserVersion:null!==(e=t.browserVersion)&&void 0!==e?e:"",email:n,extensionId:t.extensionVersion,languageUxId:t.languageUxId,storeId:t.extensionStoreId,tenantId:i,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(537518988,v.s.SettingsSyncEditorRequestBuildError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}logTelemetry(e){if(this._lastConfigRequestUserId&&this._lastConfigRequestUserId===this._editorService.xUserId&&this._lastConfigRequest&&this._lastConfigRequest.browserVersion===e.browserVersion&&this._lastConfigRequest.email===e.email&&this._lastConfigRequest.languageUxId===e.languageUxId&&this._lastConfigRequest.tenantId===e.tenantId)return;this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(v.M.RemoteSettingSync,a.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())}async fetchRemoteSettings(e){var t;try{return await this._editorService.browserextension(e,{requestOptions:{customHeaders:{"X-UserId":null!==(t=this._editorService.xUserId)&&void 0!==t?t:""}}})}catch(e){this._logger.logEvent(537518989,v.s.SettingsSyncEditorServiceError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const i=await this._extensionStorage.get(e);for(const n of Object.keys(i)){JSON.parse(i[n]).manualOverride?this._logger.debug(537518990,"Manual override for remote setting",n):t[n]=e[n]}}catch(e){return this._logger.logEvent(537518991,v.s.SettingsSyncReadOverrideError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),void this.setLastError(e)}return t}async removePersistentKeys(){const e=Object.keys(C({}));e.length&&await this._extensionStorage.remove(e)}};S=(0,n.__decorate)([(0,m._)(),(0,n.__param)(0,(0,f.W)(y.D)),(0,n.__param)(1,(0,f.W)(o.qq)),(0,n.__param)(2,(0,f.W)(d.K)),(0,n.__param)(3,(0,f.W)(c.g)),(0,n.__param)(4,(0,f.W)(u.e)),(0,n.__param)(5,(0,f.W)(h.a)),(0,n.__param)(6,(0,f.W)(g.G)),(0,n.__param)(7,(0,f.W)(p.J))],S)},78972:(e,t,i)=>{i.d(t,{D:()=>o});var n,s=i(76729);!function(e){e.LocalStorageApi="LocalStorageApi"}(n||(n={}));const o=(0,s.f)("IBrowserStorageApi")},32120:(e,t,i)=>{i.d(t,{h:()=>a});var n,s=i(79490),o=i(29906),r=i(98970);let a=n=class{constructor(){this.eventListener=new r.J(document)}async initialize(){}shutDown(){this.eventListener.removeAllListeners()}async set(e){const t=Object.keys(e),i={};for(const n of t){const t=e[n];i[n]={oldValue:localStorage.getItem(n),newValue:t};try{localStorage.setItem(n,t)}catch(e){return Promise.reject(e)}}const n=new CustomEvent("storageItemInserted",{detail:i});return document.dispatchEvent(n),Promise.resolve()}async remove(e){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);return Promise.resolve()}async get(e){const t={};if("string"==typeof e)t[e]=n._getItem(e);else if(Array.isArray(e))for(const i of e)t[i]=n._getItem(i);else if(e instanceof Object){const i=Object.keys(e);for(const s of i){const i=n._getItem(s);t[s]=i||e[s]}}return Promise.resolve(t)}addChangeListener(e){this.eventListener.addListener("storageItemInserted",(t=>{t.detail&&e(t.detail,"")}))}removeEventListener(e){this.eventListener.removeAllListeners()}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};a=n=(0,s.__decorate)([(0,o._)()],a)},44233:(e,t,i)=>{function n(e){var t;if(e)return"true"===(null===(t=e.contentEditable)||void 0===t?void 0:t.toLowerCase())?e:n(e.parentElement)}i.d(t,{m:()=>n})},76752:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(76729).f)("IIndexReadjuster")},50635:(e,t,i)=>{i.d(t,{Q:()=>a});var n=i(79490),s=i(29906),o=i(23750),r=i.n(o);let a=class{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):t,this._dmp=new(r()),this._dmp.Diff_Timeout=0}getReadjustedIndices(e,t,i,n){var s;const o=[],r=null!==(s=e.textContent)&&void 0!==s?s:"",a=n?this._dmp.diff_main(i,r):this._dmp.diff_main(r,i);if(1===a.length&&0===a[0][0])return t;let l=0,d=0,c=0,u=0,h=0,g=0;for(const e of a){const i=e[0],n=e[1].length;switch(i){case 0:h=n,g=n;break;case 1:h=0,g=n;break;case-1:c+=n;continue}d+=c,c=0;for(let e=l;e<t.length;e+=1){const n=this.getIndex(t[e]);if(n<u)throw new Error("Indices are not sorted!");if(!(n>=u&&n<u+g))break;o[e]=0===i?this.getNewValue(t[e],n+d-u):this.getNewValue(t[e],d),l+=1}if(l===t.length)break;d+=h,u+=g}for(let e=l;e<t.length;e+=1)o[e]=this.getNewValue(t[e],d);return o}};a=(0,n.__decorate)([(0,s._)()],a)},58046:(e,t,i)=>{if(i.d(t,{O:()=>r}),2063!=i.j)var n=i(76752);if(2063!=i.j)var s=i(50635);if(2063!=i.j)var o=i(51152);class r{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918221)}configureRootServices(e){e.bind(n.h).to(s.Q)}}},61871:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(76729).f)("ITextUnitChunker")},57458:(e,t,i)=>{i.d(t,{b0:()=>r,c0:()=>o,hN:()=>s,pT:()=>a});var n=i(76729);const s=(0,n.f)("ISentenceTextUnitSeparator"),o=(0,n.f)("IParagraphTextUnitSeparator"),r=(0,n.f)("IDefaultTextUnitSeparator"),a=(0,n.f)("IDocumentTextUnitSeparator")},92165:(e,t,i)=>{i.d(t,{t:()=>n});const n=(0,i(76729).f)("IWordCount")},72232:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(76729).f)("IWordCountDetector")},52022:(e,t,i)=>{i.d(t,{a:()=>o});var n=i(79490),s=i(29906);let o=class{findBeginBoundary(e,t,i){const n=e.lastIndexOf("\n",t-1);return-1===n||n<=i?i:n+1}findEndBoundary(e,t,i){const n=e.indexOf("\n",t+1);return-1===n||n>i?-1:n+1}splitInUnits(e){const t=[];let i=-1;do{i=e.indexOf("\n",i+1),-1!==i&&t.push(i+1)}while(-1!==i);return t}};o=(0,n.__decorate)([(0,s._)()],o)},96238:(e,t,i)=>{i.d(t,{F:()=>D});var n=i(79490),s=i(11804),o=i(29906),r=i(83010);const a="[\0-\b\n--\u2028-\u2029]",l="[!-#%-*,-/:-;?-@_{}--------------------------------]",d="[----]",c="[?!.]",u="[]",h="[ -\t]",g="[\"']",p="[)]}]|[]|[]",m="[\u2028\u2029\n\r]",f=`[.]{2,6}|[.]([ ][.]){1,5}|([--])[.]|${`${`(${h}|${a}|${l}|${d})`}((((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]|((([]?[]{1,3}|[][]|[])?([]?[]{1,3}|[][]|[]))|([]?[]{1,3}|[][]|[])|(([]?[]{1,3}|[][]|[])?([]?[]{1,3}|[][]|[]))|([]?[]{1,3}|[][]|[]))[.]|([0-9]{1,4}[.]|[-]{1,4}[.])|([0-9]+(([ao])|((er)[ao]?)|(([][])[]?)|([mdtvn][ao])|([][]))[.]|[A-Za-z]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z]+((STR)|(str))[.]))`}|${`${`(${h}|${a}|${l}|[$+<=>^\`|~------------]|${d}|[0-9-------------------]|[-------])`}((([A-Za-z--------------]|[------------------------------------------------------------------------------------------------]|[--])[.])+|(([------])[.])+)`}`,v=new RegExp(`${c}|${u}`,"ig"),_=new RegExp(`${c}|${u}|${m}`,"ig"),y=new RegExp(f,"g");function I(e,t,i=0){const n=[];let s=t.exec(e);for(;null!==s;){if(s[i]){const e=s.index;n.push({begin:e,end:e+s[i].length})}s=t.exec(e)}return n}const C=`(${c}(${p}|${g}|${h})*${m})`,S=`(${c}(${p})*(${h})+)`,b=`(${u}(${p})*)`,T=`((${m})+)`,E=`(${c}(${p}|${g}|${h})*(${m})+)`,N=[new RegExp(C,"ig"),new RegExp(S,"ig"),new RegExp(b,"ig")],x=[new RegExp(S,"ig"),new RegExp(b,"ig"),new RegExp(T,"ig"),new RegExp(E,"ig")],w=new RegExp(`${C}|${S}|${b}`,"ig"),L=new RegExp(`${S}|${b}\n    |${T}|${E}`,"ig");let D=class{constructor(e){this._hostSettings=e}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?x:N;for(const i of t){const t=I(e,i);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=I(e,y),i=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some((e=>e.end===i))}findBeginBoundary(e,t,i){const n=this._hostSettings.newLineSentenceSeparatorEnabled?_:v,s=e.substring(i,t),o=I(s,n);for(let e=o.length-1;e>=0;e-=1){const t=s.substring(0,o[e].end);if(!this.isEndPuncSpecialCase(t)){const t=s.substring(o[e].begin,s.length),n=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===n:!n)continue;return i+o[e].end+n}}return i}findEndBoundary(e,t,i){const n=e.substring(t,i),s=I(n,this._hostSettings.newLineSentenceSeparatorEnabled?_:v);for(const e of s){const i=n.substring(0,e.end);if(!this.isEndPuncSpecialCase(i)){const i=n.substring(e.begin,n.length),s=this.expandEndRange(i);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===s:!s)continue;return t+e.end+s}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?L:w;return I(e.replace(y,(e=>"#".repeat(e.length))),t).map((e=>e.end))}};D=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.n))],D)},3826:(e,t,i)=>{i.d(t,{_n:()=>l,e:()=>d});var n=i(79490),s=i(29906),o=i(83010),r=i(57458),a=i(65798);let l=class{constructor(e,t,i){this._sentenceSeparator=e,this._paragraphSeparator=t,this._unitySeparator=i}splitInUnitsFromExtendedBoundaries(e,t,i,n){return d(e,t,this.getUnitSeparator(i),n)}extendBoundariesFromDiffBounds(e,t,i){return c(e,t,this.getUnitSeparator(i))}getUnitSeparator(e){switch(e){case a.fT.Sentence:return this._sentenceSeparator;case a.fT.Paragraph:return this._paragraphSeparator;default:return this._unitySeparator}}};function d(e,t,i,n){const s=function(e,t,i,n){if(!i.firstDiffLeft&&!i.firstDiffRight&&!n.offset&&n.span===t.length)return function(e,t){const i=[],n=e.splitInUnits(t);let s=0;for(const e of n)i.push({offset:s,span:e-s,validEndBoundary:-1!==e}),s=e;(!n.length||n.length&&n[n.length-1]!==t.length)&&i.push({offset:s,span:t.length-s,validEndBoundary:!1});return i}(e,t);const s=2,o=t.slice(n.offset,n.offset+n.span),r=i.firstDiffLeft-n.offset,a=i.firstDiffRight-(t.length-n.offset-n.span);let l=0,d=0;const c=[],u=Math.min(o.length,o.length-a+s);do{const t=l;l=e.findEndBoundary(o,Math.max(l,r-s),u),d=-1!==l&&l<u?l:o.length,d-t&&c.push({offset:t+n.offset,span:d-t,validEndBoundary:-1!==l,enforcedCompleteTileTextUnit:n.enforcedCompleteTileTextUnit})}while(d<o.length);return c}(i,e,t,n||c(e,t,i));return!s.length||s[s.length-1].validEndBoundary&&!1!==s[s.length-1].validEndBoundary||(s[s.length-1]=function(e,t,i){if(!1===t.validEndBoundary&&t.span>=2){let n,s=t.span;do{n=e.slice(t.offset+s-2,t.offset+s),s-=1}while(!/\S/.test(n)&&s>=2);t.validEndBoundary=-1!==i.findEndBoundary(n,0,n.length)}return t}(e,s[s.length-1],i)),s}function c(e,t,i){let n,s=0,o=e.length,r=t.firstDiffLeft+1;if(e.length)do{if(r-=1,s=i.findBeginBoundary(e,r,0),o=i.findEndBoundary(e,e.length-t.firstDiffRight,e.length),n=-1!==o,o=-1!==o?o:e.length,r<e.length){if(s===i.findBeginBoundary(e,r+1,0))continue}let a=s,l=0;for(;a&&r===a+l;){l+=1;const t=a;if(a=i.findBeginBoundary(e,a-1,0),a<t-1){s=a;break}}}while(!(o-s));return{offset:s,span:o-s,validEndBoundary:n}}l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.hN)),(0,n.__param)(1,(0,o.W)(r.c0)),(0,n.__param)(2,(0,o.W)(r.b0))],l)},11551:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(79490),s=i(29906);let o=class{findBeginBoundary(e,t,i){return Math.min(t,i)}findEndBoundary(e,t,i){return e.length<i?-1:Math.max(t,i)}splitInUnits(e){return[e.length]}};o=(0,n.__decorate)([(0,s._)()],o)},80232:(e,t,i)=>{i.d(t,{B:()=>g,a:()=>a});var n=i(79490),s=i(29906),o=i(81628);const r=new Set(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\ufeff","","","","",""]);let a=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let i=this.getForwardBreak(e,t);return"WhiteSpace"===(null==i?void 0:i.wordBreakType)&&(i=this.getForwardBreak(e,i.cp)),i?i.cp:e.length}getBackwardBreakByWord(e,t){let i=this.getBackwardBreak(e,t);return"WhiteSpace"===(null==i?void 0:i.wordBreakType)&&(i=this.getBackwardBreak(e,i.cp)),i?i.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){if(t<=1)return;let i=t;for(;i>0;){const t=d(e,i-1);switch(t){case"Undetermined":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(i<=1)return;const n=i-1,s=d(e,n-1);if(t!==s&&l(t,s)&&("Undetermined"!==s||!this.supportsBrowserWordBreaking))return{cp:n,wordBreakType:t};break}}i-=1}}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:d(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,i){const n=[];if(!e)return n;let s,o=t;do{s&&(n.push(s),o=s.cp),s=this.getForwardBreakInternal(e,o,i)}while(s);return n}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,i){return this.getWordCountAndBreaksInRange(e,t,i).wordCount}getWordCountAndBreaksInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);return n.splice(0,0,this.getTextWordBreak(e,t)),{wordCount:this.getWordCount(n,e),wordBreaks:n}}getWordCountWithBoundariesAndBreaksInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);n.splice(0,0,this.getTextWordBreak(e,t));const s=this.getWordCountFromWordBreaks(n,e);return{wordCount:s.wordCount,wordBoundaries:s.wordBoundaries,wordBreaks:n}}getWordCountFromWordBreaks(e,t){const i={browserWordBreakCount:0,wordCount:0,wordBoundaries:[]};let n;for(let s=0;s<e.length;s+=1){const o=e[s];"AlphaNumeric"===o.wordBreakType||"Undetermined"===o.wordBreakType?("Undetermined"===o.wordBreakType&&(i.browserWordBreakCount+=1),c(s,e,t)&&(i.wordCount+=1,n=o.cp)):(void 0!==n&&(i.wordBoundaries.push({start:n,end:o.cp-1}),n=void 0),"Punctuation"!==o.wordBreakType&&"PuncuationWithoutBreak"!==o.wordBreakType||!u(s,e,t)||(i.wordCount+=1))}return void 0!==n&&i.wordBoundaries.push({start:n,end:t.length-1}),i}getForwardBreakInternal(e,t,i){if(t>=i-1)return;let n=t;for(;n<i;){const t=d(e,n);switch(t){case"Undetermined":case"Ignore":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(n>=i-1)return;let s=n+1,o=d(e,s);for(;"Ignore"===o;){if(s+=1,s>=i)return;o=d(e,s)}if(t!==o&&l(t,o)&&("Undetermined"!==o||!this.supportsBrowserWordBreaking))return{cp:s,wordBreakType:o};break}}n+=1}}};function l(e,t){return"PuncuationWithoutBreak"===e&&"AlphaNumeric"!==t||"AlphaNumeric"===e&&"PuncuationWithoutBreak"!==t||("Punctuation"===e||"FootnoteEndnotePunctuation"===e)||"WhiteSpace"===e}function d(e,t){const i=e.charAt(t).toString();return o.Fc(i)?"AlphaNumeric":function(e){const t=e.charCodeAt(0);return t>=0&&t<=31||32===t||t>=127&&t<=159||160===t||t>=8192&&t<=8202||8239===t||8287===t||9248===t||t>=9250&&t<=9252||12288===t||65282===t}(i)?"WhiteSpace":g(i)?"Punctuation":function(e){return"'"===e||""===e||""===e}(i)?"PuncuationWithoutBreak":function(e){return""===e}(i)?"FootnoteEndnotePunctuation":function(e){return""===e||""===e}(i)?"Ignore":"Undetermined"}function c(e,t,i){if(!e)return!0;const n=t[e];if(!n.cp)return!0;const s=t[e-1];let o=!0;if("Punctuation"===s.wordBreakType){let e=!1;for(let t=s.cp;t<n.cp;t+=1){const n=i.charAt(t);if("-"===n){if(e)return!0;e=!0}else e=!1;if(o=h(n),o)return!0}}else if("Undetermined"===s.wordBreakType)return!1;return("Undetermined"!==n.wordBreakType||"WhiteSpace"===s.wordBreakType)&&o}function u(e,t,i){const n=t[e];if(h(i.charAt(n.cp)))return!1;if(!e)return!0;if(!n.cp)return!1;const s=t[e-1];return"WhiteSpace"===s.wordBreakType||"FootnoteEndnotePunctuation"===s.wordBreakType}function h(e){return""===e||""===e}function g(e){return!!r.has(e)||(e>="!"&&e<="$"||e>="("&&e<="/"||e>=":"&&e<="@"||e>="["&&e<="`"||e>="{"&&e<="~"||e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<=""||e>=" "&&e<=""||e>=" "&&e<="")}a=(0,n.__decorate)([(0,s._)()],a)},97029:(e,t,i)=>{i.d(t,{M:()=>l});var n=i(79490),s=i(11804),o=i(29906),r=i(83010),a=i(92165);let l=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,i,n=!1){let s,o=0;n?({wordCount:o,wordBoundaries:s}=this.computeValidWordCountAndBoundariesForRange(i,0,i.length)):o=this.computeValidWordCountForRange(i,0,i.length);const r={isWordCountChanged:!1,wordCount:o,wordBoundaries:s};if(o>0&&0===e.firstDiffLeft&&0===e.firstDiffRight)return r.isWordCountChanged=!0,r;if(e.firstDiffLeft+e.firstDiffRight<=i.length){if(this._wordCount.getWordCountInRange(i,e.firstDiffLeft,i.length-e.firstDiffRight)>1)return r.isWordCountChanged=!0,r}if(t>o)return r.isWordCountChanged=!0,r;const a=this.computeValidWordCountForRange(i,0,i.length-e.firstDiffRight);if(0===a)return r.isWordCountChanged=!1,r;const l=this.computeValidWordCountForRange(i,0,e.firstDiffLeft);return r.isWordCountChanged=a>l,r}getWordCount(e){return this.computeValidWordCountForRange(e,0,e.length)}computeValidWordCountForRange(e,t,i){if(t>=i||t<0||i>e.length)return 0;const{wordCount:n,wordBreaks:s}=this._wordCount.getWordCountAndBreaksInRange(e,t,i);return this.correctWordCountForIncompleteWord(s,e.length,n)}computeValidWordCountAndBoundariesForRange(e,t,i){if(t>=i||t<0||i>e.length)return{wordCount:0,wordBoundaries:[]};const{wordCount:n,wordBreaks:s,wordBoundaries:o}=this._wordCount.getWordCountWithBoundariesAndBreaksInRange(e,t,i);return{wordCount:this.correctWordCountForIncompleteWord(s,e.length,n),wordBoundaries:o}}correctWordCountForIncompleteWord(e,t,i){if(i<=0||0===e.length)return 0;const n=e.length-1;return"WhiteSpace"!==e[n].wordBreakType&&(this._hostSettings.newLineSentenceSeparatorEnabled||this._hostSettings.useParagraphAsTileSeparator||"Punctuation"!==e[n].wordBreakType)&&e[n].cp+1<=t?i-1:i}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(a.t)),(0,n.__param)(1,(0,r.W)(s.n))],l)},11864:(e,t,i)=>{i.d(t,{CJ:()=>a,Rr:()=>r});const n="(-ms-high-contrast: active), (forced-colors: active)",s="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",o="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)",r="@media screen and "+n;class a{get isHighContrastActive(){return window.matchMedia(n).matches}get isHighContrastBlack(){return window.matchMedia(s).matches}get isHighContrastWhite(){return window.matchMedia(o).matches}}new a},921:(e,t,i)=>{i.d(t,{x:()=>o});var n=i(10276),s=i(63088);class o{static createEvaluator(e,t,i,n,s){return r=>o.isKey(r,e,t,i,n,s)}static isKey(e,t,i,s,r,a){if(void 0!==i&&e.altKey!==i||void 0!==s&&e.ctrlKey!==s||void 0!==r&&e.metaKey!==r||void 0!==a&&e.shiftKey!==a)return!1;if(Array.isArray(t))return t.some((t=>o.isKey(e,t,i,s,r,a)));if(e.key===t)return!0;if(t in n.c){const i=n.c[t];return e.which===i||e.keyCode===i}return!1}}o.isEnterKey=e=>{const t=s.m.enter;return o.isKey(e,t)},o.isEnterOrSpaceKey=e=>{const t=s.m.enter,i=s.m.space;return o.isKey(e,[t,i])},o.isEscapeKey=e=>{const t=s.m.escape;return o.isKey(e,t)},o.focusIfEscapeKey=e=>{o.isKey(e,s.m.escape)&&(e.currentTarget.focus(),e.stopPropagation())},o.isSpaceKey=e=>{const t=s.m.space;return o.isKey(e,t)}},63088:(e,t,i)=>{var n;i.d(t,{m:()=>n}),function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.delete="Delete",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(n||(n={}))},24281:(e,t,i)=>{var n;i.d(t,{k:()=>n}),function(e){e[e.ContextualCard=0]="ContextualCard"}(n||(n={}))},70807:(e,t,i)=>{if(i.d(t,{h:()=>s}),2063!=i.j)var n=i(78126);function s(){return(0,n.A)()}},3141:(e,t,i)=>{if(i.d(t,{n:()=>o}),2063!=i.j)var n=i(1270);if(2063!=i.j)var s=i(80078);function o(){const e=new n.m(s.g);return new s.K(e)}},70431:(e,t,i)=>{i.d(t,{k:()=>o,p:()=>s});var n=i(76729);const s=(0,n.f)("IContainer"),o=(0,n.f)("IResolveNew")},80078:(e,t,i)=>{i.d(t,{K:()=>s,g:()=>n});const n={defaultScope:"Singleton",skipBaseClassChecks:!0};class s{constructor(e){this.container=e}bind(e){return new o(this,this.container.bind(e))}rebind(e){return new o(this,this.container.rebind(e))}unbind(e){try{return this.container.unbind(e),!0}catch(e){return!1}}get(e){return this.container.get(e)}getOptional(e){return this.container.isBound(e)?this.container.get(e):void 0}getAll(e){return this.container.isBound(e)?this.container.getAll(e):[]}isBound(e){return this.container.isBound(e)}createChildContainer(){return new s(this.container.createChild(n))}unbindAll(){this.container.unbindAll()}resolveNew(e){return this.container.resolve(e)}getBindings(){const e=(t=this.container,t._bindingDictionary).getMap();var t;const i=[];for(const[t,n]of e)i.push({token:t,boundServices:n});return i}}class o{constructor(e,t){this.container=e,this.bindingTo=t}to(e){this.bindingTo.to(e)}toSelf(){this.bindingTo.toSelf()}toValue(e){this.bindingTo.toConstantValue(e)}toDynamicValue(e){this.bindingTo.toDynamicValue((()=>e(this.container)))}toFactory(e){this.bindingTo.toFactory((()=>e(this.container)))}toExisting(e){this.bindingTo.toService(e)}toTransient(e){this.bindingTo.to(e).inTransientScope()}}},26065:(e,t,i)=>{if(i.d(t,{o:()=>s}),2063!=i.j)var n=i(39112);class s{constructor(e,t,i){this.injectionIdentifier=e,this.isOptional=t,this.isArray=i}resolveFrom(e){if(!this.shouldSkipResolving(e))return this.isArray?this.resolveArray(e):this.resolveSingular(e)}resolveSingular(e){return this.isOptional?e.getOptional(this.injectionIdentifier):e.get(this.injectionIdentifier)}resolveArray(e){if(!this.isOptional&&!e.isBound(this.injectionIdentifier))throw new Error("No matching bindings found for serviceIdentifier: "+this.injectionIdentifier.toString());return e.getAll(this.injectionIdentifier)}isBoundTo(e){return!!e.isBound(this.injectionIdentifier)}setupBinding(e,t){if(this.isArray&&Array.isArray(t))for(const i of t)this.setupSingleBinding(e,i);else this.setupSingleBinding(e,t)}setupSingleBinding(e,t){const i=e.bind(this.injectionIdentifier);(0,n.C)(t)?i.to(t):i.toValue(t)}toString(){const e={};return e.identifier=this.injectionIdentifier instanceof Function?this.injectionIdentifier.name:this.injectionIdentifier.toString(),this.isOptional&&(e.isOptional=this.isOptional),this.isArray&&(e.isArray=this.isArray),`ConfiguredDep(${JSON.stringify(e)})`}shouldSkipResolving(e){return!!this.isOptional&&!this.isBoundTo(e)}}},30833:(e,t,i)=>{if(i.d(t,{A:()=>s}),2063!=i.j)var n=i(26065);class s{constructor(e,t){this._isOptional=!1,this._injectionIdentifier=e,this._isArray=t}static on(e){return new s(e,!1)}static onAll(e){return new s(e,!0)}optional(){return this._isOptional=!0,this}build(){return new n.o(this._injectionIdentifier,this._isOptional,this._isArray)}}},39112:(e,t,i)=>{i.d(t,{C:()=>s});const n=new(i(87218).P);function s(e){if(!(e instanceof Function))return!1;return!!n.getConstructorMetadata(e).compilerGeneratedMetadata}},26598:(e,t,i)=>{if(i.d(t,{F5:()=>o,KN:()=>r,SM:()=>a}),2063!=i.j)var n=i(41103);var s=i(8520);function o(e){const t={};for(const i of Object.keys(e)){const n=e[i];t[i]=n.build()}return t}function r(e){const t=(0,n.G)();return(0,s.useMemo)((()=>{const i={};for(const n of Object.keys(e))i[n]=e[n].resolveFrom(t);return i}),[t,e])}function a(e){const t=(0,n.N)();return(0,s.useMemo)((()=>{const i={};for(const n of Object.keys(e))i[n]=t&&e[n].resolveFrom(t);return i}),[t,e])}},4404:(e,t,i)=>{if(i.d(t,{r:()=>o}),2063!=i.j)var n=i(26598);var s=i(8520);function o(e,t){var i;const o=i=>{const o=(0,n.KN)(t);return i.deps?s.createElement(e,Object.assign({},i)):s.createElement(e,Object.assign({},i,{deps:o}))},r=null!==(i=e.displayName)&&void 0!==i?i:e.name;return o.displayName=`${r}DepsResolver`,o}},36256:(e,t,i)=>{i.d(t,{E:()=>o,r:()=>r});var n=i(85707),s=i(8520);class o extends n.z{constructor(e,t){super(e,t)}onAddModule(e){var t;"configureScopedServices"in e?null===(t=e.configureScopedServices)||void 0===t||t.call(e,this.container):"scopedProviders"in e&&e.scopedProviders&&this.bindProvidersToContainer(this.container,e.scopedProviders)}}const r=(0,s.createContext)(void 0)},85707:(e,t,i)=>{if(i.d(t,{z:()=>o}),2063!=i.j)var n=i(3141);if(2063!=i.j)var s=i(39112);class o{constructor(e,t){this.addedModuleKeys=new Set,this._addedModuleClassNames=new Set,this._modulesSharingSameModuleKeyButDifferentClassname=new Set,this.container=e,this.generateModuleKey=t}static createContainer(e){return e?e.createChildContainer():(0,n.n)()}clear(){this.container.unbindAll(),this.addedModuleKeys.clear(),this._addedModuleClassNames.clear(),this._modulesSharingSameModuleKeyButDifferentClassname.clear()}get addedModuleClassNames(){return this._addedModuleClassNames}get modulesSharingSameModuleKeyButDifferentClassname(){return this._modulesSharingSameModuleKeyButDifferentClassname}addModule(e){var t;const i="function"!=typeof e?e.constructor.name:e.name,n=this.getModuleKey(e);if(this.addedModuleKeys.has(n))return void(this._addedModuleClassNames.has(i)||this._modulesSharingSameModuleKeyButDifferentClassname.add(i));this._addedModuleClassNames.add(i),this.addedModuleKeys.add(n);const s=this.getModuleInstance(e);this.addModules(null!==(t=s.imports)&&void 0!==t?t:[]),this.onAddModule(s)}addModules(e){for(const t of e)t&&(Array.isArray(t)?this.addModules(t):this.addModule(t))}bindProvidersToContainer(e,t){for(const i of t)if(i)if((0,s.C)(i))e.isBound(i)||e.bind(i).toSelf();else{const t=i.provide;if(!i.multiple&&e.isBound(t))throw new Error(`Duplicate provider type: ${String(t)}`);if("useClass"in i)e.bind(t).to(i.useClass);else if("useDynamicValue"in i)e.bind(t).toDynamicValue(i.useDynamicValue);else if("useExisting"in i)e.bind(t).toExisting(i.useExisting);else{if(!("useValue"in i))throw new Error("Unknown provider type");e.bind(t).toValue(i.useValue)}}}getModuleKey(e){var t,i;const n=this.getModuleInstance(e);return n.uniqueId?n.uniqueId:e instanceof Function&&null!==(i=null===(t=this.generateModuleKey)||void 0===t?void 0:t.call(this,e))&&void 0!==i?i:e}getModuleInstance(e){return e instanceof Function?new e:e}}},90403:(e,t,i)=>{i.d(t,{J:()=>o,S:()=>r});var n=i(85707),s=i(8520);class o extends n.z{constructor(e){super(n.z.createContainer(),e)}onAddModule(e){"configureRootServices"in e?e.configureRootServices(this.container):e.providers&&this.bindProvidersToContainer(this.container,e.providers)}}const r=(0,s.createContext)(void 0)},8826:(e,t,i)=>{i.d(t,{U:()=>u});var n=i(36256),s=i(85707),o=i(90403),r=i(41103),a=i(8520);const l=e=>{const t=(0,r.G)();return a.createElement(d,Object.assign({},e,{parentContainer:t}))};class d extends a.Component{constructor(e){super(e),this.state={injector:void 0}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){const e=s.z.createContainer(this.props.parentContainer),t=new n.E(e,this.rootInjector.generateModuleKey);this.props.onConfigureInjector(t),this.setState({injector:t})}render(){const{injector:e}=this.state;return e?a.createElement(n.r.Provider,{value:e},this.props.children):null}}d.contextType=o.S;class c extends a.Component{constructor(e){super(e),this.onConfigureInjector=e=>{e.addModule(this.props.value)},this.state={rootInjectorConfigured:!1}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){this.onConfigureInjector(this.rootInjector),this.setState({rootInjectorConfigured:!0})}render(){return this.state.rootInjectorConfigured?a.createElement(l,{onConfigureInjector:this.onConfigureInjector},this.props.children):null}}c.contextType=o.S;class u extends a.PureComponent{constructor(e){var t;super(e),this.injector=null!==(t=e.injector)&&void 0!==t?t:new o.J,this.entryModule=e.entryModule}render(){return this.entryModule?a.createElement(o.S.Provider,{value:this.injector},a.createElement(c,{value:this.entryModule},this.props.children)):a.createElement(o.S.Provider,{value:this.injector},this.props.children)}}},41103:(e,t,i)=>{if(i.d(t,{G:()=>r,N:()=>a}),2063!=i.j)var n=i(36256);if(2063!=i.j)var s=i(90403);var o=i(8520);function r(){const e=a();if(!e)throw new Error("No Injector context available");return e}function a(){const e=(0,o.useContext)(n.r),t=(0,o.useContext)(s.S),i=null!=e?e:t;return null==i?void 0:i.container}},76729:(e,t,i)=>{function n(e){return Symbol.for(e)}i.d(t,{f:()=>n})},40219:(e,t,i)=>{if(i.d(t,{N:()=>v}),2063!=i.j)var n=i(70825);if(2063!=i.j)var s=i(87532);if(2063!=i.j)var o=i(43109);if(2063!=i.j)var r=i(55875);if(2063!=i.j)var a=i(79002);if(2063!=i.j)var l=i(33345);if(2063!=i.j)var d=i(70108);if(2063!=i.j)var c=i(42389);if(2063!=i.j)var u=i(36452);if(2063!=i.j)var h=i(61183);if(2063!=i.j)var g=i(53718);const p={requiredFlights:["mc-editor-oa","mc-editor-oa-client-ecc"],isFeatureEnabled:(e,t)=>!0===(null==t?void 0:t.some((t=>t===e)))},m={};class f{constructor(e,t,i,n){this.refreshCadence=e,this.augloopSession=t,this.timer=i,this._logger=n}start(){this.timer.setIntervalWithDelay("refreshGraphSearchData",(()=>this.tryRefresh()),this.refreshCadence,this.refreshCadence)}stop(){this.timer.clearTimer("refreshGraphSearchData")}async tryRefresh(){if(this.augloopSession.isClosed)return;const e={parentPath:["session","doc"],items:[{id:"0",body:new s.$9({forceRefresh:!1})}]};this.augloopSession.submitOperation(new n.Xr(e))}onRefreshDone(){this._logger.info(507349215,"Graph search data refresh done")}}class v{constructor(e,t,i){var n,s,o,r,a,l,d,c,u,h;this.timer=i,this.defaultRefreshInterval=3e5,this.annotationListenerType="",this.config=e,this._logger=t,this.requiredSetting(null===(n=this.config.oaSettings)||void 0===n?void 0:n.enableOaClient,"oaSettings.enableOaClient"),this.requiredSetting(null===(o=null===(s=this.config.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===o?void 0:o.enabled,"serviceSettings.hybridAugloop.enabled"),this.requiredSetting(null===(a=null===(r=this.config.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.enableGraphSearchLocal,"serviceSettings.hybridAugloop.enableGraphSearchLocal"),this.requiredSetting(null===(l=this.config.orchestratorSettings)||void 0===l?void 0:l.enableAugLoop,"orchestratorSettings.enableAugLoop"),this.requiredSetting(!!(null===(d=this.config.orchestratorSettings)||void 0===d?void 0:d.substrateAuthTokenCallback),"orchestratorSettings.substrateAuthTokenCallback"),this.checkRequiredFlights(this.config.flightsToTrack),this.cacheGetter=(null===(h=null===(u=null===(c=this.config.serviceSettings)||void 0===c?void 0:c.hybridAugloop)||void 0===u?void 0:u.wasmConfig)||void 0===h?void 0:h.disableModuleCache)?()=>m:void 0,this.config.orchestratorSettings?(this.config.orchestratorSettings.preRuntimeInit=this.config.orchestratorSettings.preRuntimeInit||[],this.config.orchestratorSettings.preRuntimeInit.push(((e,t)=>this.preRuntimeInit(e,t)))):this._logger.error(507349214,"OrchestratorSettings missing. Required for Hybrid ECC"),this.eccEnabled=(e=>{var t;return!!(null===(t=e.oaSettings)||void 0===t?void 0:t.enableOaClient)})(e),this.eccEnabled||this._logger.warn(507349213,"Hybrid ECC workflows are not enabled.  Consider excluding Hybrid plugin support to reduce overall package size.")}get wasmScriptPath(){var e,t,i;return(0,u.Gm)(null===(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.wasmConfig)||void 0===i?void 0:i.scriptPath)}preRuntimeInit(e,t){return t.inferenceServiceFactory=l._.createFactory(this.wasmScriptPath,(0,u.$A)(this.config),this.cacheGetter),t.modelDownloader=new a.$(e.appName,"fs.microsoft.com/fs/augmentationLoop","res.cdn.office.net/polymer/models"),Promise.resolve()}requiredSetting(e,t){e||this._logger.error(507349212,`Required setting ${t} for hybrid wasn't set.`,t)}checkRequiredFlights(e){const t=p.requiredFlights.filter((t=>!p.isFeatureEnabled(t,e)));0!==t.length&&this._logger.error(507349211,`Hybrid requires these flights be enabled: ${t}`,t)}async activateAnnotations(e){if(!e||!this.eccEnabled)return;e.registerLocalWorkflow(h.A);const t=this.wasmScriptPath||"",i=(0,u.uz)(this.config),n={wasmRoot:t,locateFile:e=>(0,u.$A)(this.config,e),cacheModule:!0,wasmModuleCache:this.cacheGetter};e.registerLocalWorkflow((0,d.X8)(i,n)),e.registerLocalWorkflow((0,c.L4)(i,n)),e.activateAnnotation(o.NG.getTypeName()),e.registerLocalWorkflow(g.TE),e.activateAnnotation(r.os.getTypeName()),this.isUpdateSchedulerEnabled()?this.setupGraphSearchDataRefreshScheduler(e):e.activateAnnotation(s.$9.getTypeName())}isUpdateSchedulerEnabled(){var e,t,i;return null!==(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.enablePeriodicUpdates)&&void 0!==i&&i}getUpdateInterval(){var e,t,i;return null!==(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.periodicUpdateInterval)&&void 0!==i?i:this.defaultRefreshInterval}setupGraphSearchDataRefreshScheduler(e){this.graphSearchDataRefreshScheduler&&this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=new f(this.getUpdateInterval(),e,this.timer,this._logger),this.graphSearchDataRefreshScheduler.start(),e.activateAnnotation(s.$9.getTypeName(),{callback:this.graphSearchDataRefreshScheduler.onRefreshDone.bind(this.graphSearchDataRefreshScheduler)})}async deactivateAnnotations(e){return!(!e||!this.eccEnabled)&&(this.graphSearchDataRefreshScheduler&&(this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=void 0),e.releaseAnnotation(o.NG.getTypeName()),e.releaseAnnotation(r.os.getTypeName()),e.releaseAnnotation(s.$9.getTypeName()),!0)}async updateAnnotationActivationConfig(){}}},73282:(e,t,i)=>{i.d(t,{g:()=>c});var n=i(79490),s=i(40219),o=i(11804),r=i(10138),a=i(68336),l=i(29906),d=i(83010);let c=class{constructor(e,t,i){this.isEnabled=!0,this.graphSearchLocalAnnotationListener=new s.N(e,t,i)}onInitialize(){}register(e,t){}unregister(){}createAnnotationListener(){return this.graphSearchLocalAnnotationListener}onSessionReconnected(){}onDocumentCreated(){}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(o.n)),(0,n.__param)(1,(0,d.W)(r.g)),(0,n.__param)(2,(0,d.W)(a.J))],c)},25798:(e,t,i)=>{if(i.d(t,{p:()=>c}),2063!=i.j)var n=i(436);if(2063!=i.j)var s=i(33355);if(2063!=i.j)var o=i(33781);if(2063!=i.j)var r=i(73282);if(2063!=i.j)var a=i(28039);if(2063!=i.j)var l=i(51152);if(2063!=i.j)var d=i(15098);class c{constructor(){this.imports=[n.J,a.k]}get uniqueId(){return(0,l.z)(507918226)}configureRootServices(e){e.bind(s.T).to(r.g),e.bind(o.cl).toDynamicValue((e=>(e,t)=>{var i;const n=(0,d.g)(e,null===(i=t.hostSettings.orchestratorSettings)||void 0===i?void 0:i.substrateAuthTokenCallback);return Object.assign(Object.assign({},e),{isFeatureEnabled:n.isFeatureEnabled,requestAuthToken:n.requestAuthToken})}))}}},15098:(e,t,i)=>{if(i.d(t,{g:()=>o}),2063!=i.j)var n=i(71531);function s(e,t){return async i=>i.TokenType===n.OY.Substrate&&t?{Token:await t(i)}:e(i)}function o(e,t){return{isFeatureEnabled:(i=e.isFeatureEnabled,async(e,t)=>{switch(e){case"Microsoft.Office.AugLoop.AnnotationsOrderingEnabled":case"Microsoft.Office.AugLoop.EarlyJoinCompletionEnabled":return!1;case"Microsoft.Office.AugLoop.DeltaOperationsEnabled":return!0}return i(e,t)}),requestAuthToken:s(e.requestAuthToken,t)};var i}},36452:(e,t,i)=>{i.d(t,{$A:()=>r,Gm:()=>o,uz:()=>a});var n=i(85584);if(2063!=i.j)var s=i(31055);const o=e=>{if(e){try{return new URL(e),"/"===e[e.length-1]?e.substring(0,e.length-1):e}catch(e){}const t=e.split("/").filter((e=>0!==e.length));if(0!==t.length)return["/",t.join("/")].join("")}return e},r=(e,t)=>{var i,n,s,r,a,l;return((e,t)=>["/"===e?"":o(e),t].join("/"))((null===(s=null===(n=null===(i=e.serviceSettings)||void 0===i?void 0:i.hybridAugloop)||void 0===n?void 0:n.wasmConfig)||void 0===s?void 0:s.binaryPath)||(null===(l=null===(a=null===(r=e.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.wasmConfig)||void 0===l?void 0:l.scriptPath),t)},a=e=>{var t,i,o,r,a;const d=(0,s.e)(e);return{emailId:e.userId.email,puid:e.userId.puid,scenarios:[n.Nz.BIZ_CHAT,"PowerPoint"===(null===(t=e.hostMetadata)||void 0===t?void 0:t.appName)?n.Nz.COPILOT_POWERPOINT:n.Nz.WORKPLACE_SEARCH],tenantId:e.userId.tenantId,substrateAuthTokenType:l[e.userId.identityProvider],entityTypes:[],clientConfig:{getConfig:()=>d},prefetchOnly:!1,market:e.defaultLocale,useLocalFileRanker:null===(o=null===(i=e.serviceSettings)||void 0===i?void 0:i.hybridAugloop)||void 0===o?void 0:o.useLocalFileRanker,includeLoopFiles:null===(a=null===(r=e.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.includeLoopFiles}},l=[n.Xe.SUBSTRATE_MSA,n.Xe.SUBSTRATE_AAD]},53664:(e,t,i)=>{if(i.r(t),i.d(t,{GraphSearchLocalAnnotationListener:()=>n.N,HybridModule:()=>s.p,graphSearchLocalOverrideHostCallbacks:()=>r.g,hostConfigToGraphConfig:()=>o.uz}),2063!=i.j)var n=i(40219);if(2063!=i.j)var s=i(25798);if(2063!=i.j)var o=i(36452);if(2063!=i.j)var r=i(15098)},18574:(e,t,i)=>{let n,s;async function o(){try{const e=await Promise.resolve().then(i.bind(i,19728));n=e.makeObservable,s=e.makeAutoObservable}catch(e){}}function r(e,t,i){return n?n(e,t,i):e}i.d(t,{Gn:()=>r,iJ:()=>o})},39129:(e,t,i)=>{if(i.d(t,{t:()=>c}),2063!=i.j)var n=i(95542);if(2063!=i.j)var s=i(6807);if(2063!=i.j)var o=i(13290);if(2063!=i.j)var r=i(78148);if(2063!=i.j)var a=i(55685);if(2063!=i.j)var l=i(94147);if(2063!=i.j)var d=i(4163);class c{constructor(e,t){this._displayLanguage=e,this._stringProvider=t,this._defaultUiLocale="en-us",this._categoryNameToLocalizedName=new Map,this._localizationTableFallbackMapping=(0,d.mO)(),this._localizedNameToCategoryName=new Map,this._nonEditorCategories=new Set([r.s.Perspectives,r.s.TonalRewrite]),this.uiLocale="",this.isCategorySupportedInCurrentUiLanguage=e=>!!this._categoriesForUILocale&&(e in this._categoriesForUILocale&&this._categoriesForUILocale[e].IsImplemented),this.setUiLocale(this._displayLanguage)}async setUiLocale(e){const t=e;this.uiLocale=t?t.toLowerCase():this._defaultUiLocale;const i=this._localizationTableFallbackMapping.get(this.uiLocale);if(i&&(this.uiLocale=i),this._categoriesForUILocale=await(0,a.oZ)(this.uiLocale),!this._categoriesForUILocale)throw Error(`Failed to load categories strings from localization file dynamically: ${this.uiLocale}`);this.cacheLocalizedCategories(this.uiLocale.toLowerCase(),this._categoriesForUILocale)}cacheLocalizedCategories(e,t){for(const i of Object.keys(t))this.cacheCategoryNames(i,t[i].LocalizedName,e)}get NonEditorCategories(){return this._nonEditorCategories}categoryNameToLocale(e,t){var i;const r=t.toLowerCase(),a=null===(i=this._categoryNameToLocalizedName.get(e))||void 0===i?void 0:i.get(r);if(a)return a;if(this._nonEditorCategories.has(e)){const t=this.localizeNonEditorCategoryNameToUiLocale(e);return this.cacheCategoryNames(e,t,r),t}return(0,n.C)().logEvent(571281556,"CategoryLocalizationNotFoundInLocalizationTable",s.h.Host,o.q.Error,{category:e,language:r}),e}toUiLocale(e){return this.categoryNameToLocale(e,this.uiLocale)}async localizedNameToStandardizedName(e,t){if(t===r.s.Spelling||t===r.s.Grammar||this.NonEditorCategories.has(t))return t;const i=this._localizedNameToCategoryName.get(t);if(i)return i;const n=await(0,a.oZ)(null!=e?e:this.uiLocale);if(n){const i=Object.keys(n).find((e=>{const i=n[e];return i&&i.LocalizedName===t}));if(i)return this.cacheCategoryNames(i,t,null!=e?e:this.uiLocale),i}const s=this.mapNonEditorCategoryNameToStandardizedName(t);return s?(this.cacheCategoryNames(s,t,this.uiLocale),s):t}cacheCategoryNames(e,t,i){const n=this._categoryNameToLocalizedName.get(e),s=null==n?void 0:n.get(i),o=this._localizedNameToCategoryName.get(t);if(!s)if(n)n.set(i,t);else{const n=new Map;n.set(i,t),this._categoryNameToLocalizedName.set(e,n)}o||this._localizedNameToCategoryName.set(t,e)}localizeNonEditorCategoryNameToUiLocale(e){var t;const i=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,n=i.getString.bind(i);switch(e){case r.s.Perspectives:return n("CritiqueCategoryStrings","Perspectives");case r.s.TonalRewrite:return n("CritiqueCategoryStrings","TonalRewrite");default:return e}}mapNonEditorCategoryNameToStandardizedName(e){var t;const i=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,n=i.getString.bind(i);switch(e){case n("CritiqueCategoryStrings","Perspectives"):return r.s.Perspectives;case n("CritiqueCategoryStrings","TonalRewrite"):return r.s.TonalRewrite;default:return e}}}},33851:(e,t,i)=>{i.d(t,{C:()=>s});var n=i(76729);(0,n.f)("ICategoryLocalization");const s=(0,n.f)("ICategoryLocalizationSlim")},4163:(e,t,i)=>{var n;i.d(t,{mO:()=>s}),function(e){e.CATALAN="ca",e.CATALANCATALAN="ca-es",e.CHINESE="zh",e.CHINESESIMPLIFIED="zh-hans",e.CHINESETRADITIONAL="zh-hant",e.ENGLISH="en",e.ENGLISH_AUSTRALIA="en-au",e.ENGLISH_CANADA="en-ca",e.ENGLISH_INDIA="en-in",e.ENGLISH_UNITEDKINGDOM="en-gb",e.ENGLISH_UNITEDSTATES="en-us",e.FRENCH="fr",e.FRENCH_CANADA="fr-ca",e.FRENCH_FRANCE="fr-fr",e.GERMAN="de",e.ITALIAN="it",e.JAPANESE="ja",e.PORTUGUESE="pt",e.SPANISH="es",e.SPANISH_MEXICO="es-mx",e.SPANISH_SPAIN="es-es",e.VALENCIAN="ca-es-valencia",e.RUSSIAN="ru",e.BRAZILIAN="br"}(n||(n={}));const s=()=>new Map([[n.ENGLISH_AUSTRALIA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_CANADA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_INDIA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_UNITEDKINGDOM,n.ENGLISH_UNITEDSTATES],[n.FRENCH_CANADA,n.FRENCH_FRANCE],[n.SPANISH_MEXICO,n.SPANISH_SPAIN]]);var o;!function(e){e.Goals="Goals"}(o||(o={}))},78148:(e,t,i)=>{var n;i.d(t,{s:()=>n}),function(e){e.Clarity="Clarity",e.Conciseness="Conciseness",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Vocabulary="Vocabulary",e.TonalRewrite="Tone",e.Synonyms="Synonyms",e.DistinctWords="DistinctWords",e.Readability="Readability",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Similarity="SimilarityCategoryLevel",e.Goals="GoalsCard"}(n||(n={}))},55685:(e,t,i)=>{if(i.d(t,{oZ:()=>l}),2063!=i.j)var n=i(95542);if(2063!=i.j)var s=i(6807);if(2063!=i.j)var o=i(13290);if(2063!=i.j)var r=i(5730);const a=new Map([["es-419","es-MX"]]);async function l(e,t=!1){var d;const c=null!==(d=a.get(e))&&void 0!==d?d:e,u=(0,n.C)();try{return await i(74155)(`./${c.toLowerCase()}.json`)}catch(i){try{if(!t){const t=e.split("-")[0];if(t in r.Y){const e=r.Y[t];return l(Array.isArray(e)?e[0]:e,!0)}}u.logEvent(0,"Diagnostics",s.h.Undefined,o.q.Error,`Failed to load categories strings for locale ${e} from localization file dynamically: ${i}`,void 0,void 0,void 0,"Text_Message")}catch(t){u.logEvent(0,"Diagnostics",s.h.Undefined,o.q.Error,`Failed to load neutral categories strings for locale ${e} from localization file dynamically: ${i}`,void 0,void 0,void 0,"Text_Message")}return}}},21114:(e,t,i)=>{i.d(t,{r:()=>P,h:()=>R});var n=i(8520),s=i(26598),o=i(30833),r=i(4404),a=i(36015),l=i(27523),d=i(63011),c=i(17806),u=i(17205),h=i(70547),g=i(96571),p=i(11804),m=i(98970),f=i(18640),v=i(1527),_=i(24251),y=i(30805),I=i(63088),C=i(11864),S=i(87414),b=i(24852),T=i(5513),E=i(93938),N=i(24413),x=i(71326),w=i(10994);let L;var D=i(82479),F=i(51244);const A="editor-critique-card-id",R=(0,s.F5)({store:o.A.on(a.v),footerFREStore:o.A.on(l.D).optional(),themeStore:o.A.on(S.YQ).optional(),localizer:o.A.on(g.H),calloutDismissalHandler:o.A.on(d.J).optional(),styleStore:o.A.on(S.UC).optional(),hostSettings:o.A.on(p.n)});class q extends n.Component{constructor(e){super(e),this.hasPositioned=!1,this.critiqueCalloutRef=n.createRef(),this.handleKeyDown=e=>{var t;this.store.isVisible&&(e.key===I.m.arrowDown||e.key===I.m.arrowUp?(e.stopPropagation(),e.preventDefault(),null===(t=this.critiqueCalloutRef.current)||void 0===t||t.focus()):"Escape"===e.key&&this.dismiss())},this.renderCallout=()=>n.createElement("div",null,n.createElement(E.N,Object.assign({},null!=L?L:L={settings:{theme:(0,x.I)((0,w.a)())},scopedSettings:{}}),this.renderSharedCallout())),this.emitClick=e=>{const t=new MouseEvent("click",{clientX:e.clientX,clientY:e.clientY});window.document.documentElement.dispatchEvent(t)},this.onAfterRender=()=>{var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),null===(t=this.documentEventListener)||void 0===t||t.addListener("contextmenu",this.emitClick,{capture:!0}),this.parentElement||(this.parentElement=this.store.getParentElement()),this.parentElement&&!this.parentElementEventListener&&(this.parentElementEventListener=new m.J(this.parentElement),this.parentElementEventListener.addListener("keydown",this.handleKeyDown)),this.store.afterRender()},this.dismiss=()=>{var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.store.clickNoActionHide()},this.renderTonalFreCard=()=>{const{themeStore:e,localizer:t}=this.props.deps,{onTonalFreAction:i}=this.store,s=null==e?void 0:e.getComponentActiveTheme(S.yF.tonalFreComponentName);if(s){let t;const i=null==e?void 0:e.getComponentThemes(S.yF.tonalFreComponentName),n=new C.CJ;i&&(n.isHighContrastWhite?t=i.get(S.SV.light):n.isHighContrastBlack&&(t=i.get(S.SV.dark)),t&&(s.iconPrimaryColor=t.highContrast.iconPrimaryColor,s.iconSecondaryColor=t.highContrast.iconSecondaryColor))}return n.createElement(N.Q,{automationId:"tonal_fre_card",onClickAction:i,strings:{cardTitle:t.getMessage("ebx_tonalFreTitle"),textDescription:t.getMessage("ebx_tonalFreDescription"),acceptButtonText:t.getMessage("ebx_tonalFreAcceptButton"),ignoreButtonText:t.getMessage("ebx_tonalFreIgnoreButton"),rejectLinkText:t.getMessage("ebx_tonalFreRejectButton"),rejectionMessage:t.getMessage("ebx_tonalFreRejectMessage"),editorSettingsText:t.getMessage("ebx_tonalFreOpenEditorSettings"),dissmissButtonAccessibilityLabel:t.getMessage("ebx_tonalFreDismissButtonAccessibilityLabel")},theme:s})},this.renderSharedCard=()=>{var e,t;const{deps:i}=this.props,{footerFREStore:s,themeStore:o,styleStore:r,hostSettings:a}=i,{addOnFooterData:d,critiqueSource:h,critiqueType:g,calloutCategory:p,calloutTitle:m,suggestionsToRender:f,showSynonyms:v,dropDownActions:_,navInfo:I,brandingMode:C,explanation:b,explanationTitle:E,onCalloutAction:N,settings:x,isUpsell:w}=this.store,L=null==o?void 0:o.getComponentActiveTheme(S.iN.critiqueCalloutComponentName),D=null==r?void 0:r.getComponentStyle(S.iN.critiqueCalloutComponentName),F=null==r?void 0:r.getComponentStyle(S.iN.footerFreComponentName),A=null===(t=null===(e=a.serviceSettings)||void 0===e?void 0:e.multilingual)||void 0===t?void 0:t.hideFooterFreIcon;L&&w&&(L.addOnFooterBackground=L.upsellFooterColor);const R=null==s?void 0:s.footerProps.get(l.Y.critique);return n.createElement(c.d.Consumer,null,(e=>{var t,i,s,o;return n.createElement(n.Fragment,null,n.createElement(T.n,{ref:this.critiqueCalloutRef,addOnFooterData:(null==R?void 0:R.display)?void 0:d,automationId:"browser_extension",critiqueSource:h,definition:{definitionType:"CritiqueDefinition",critiqueType:g,header:p,subheader:m,contextText:void 0,contextDecorations:void 0,suggestions:f,maximumSuggestions:f.length,showContext:!1,showDescription:v,actions:_,critiqueSetSize:I?(0,u.v)(I).length:void 0,critiquePosition:null==I?void 0:I.currentIndex,brandingMode:C,explanation:b,explanationTitle:E},onAction:N,onAfterUpdate:this.onAfterRender,settings:x,strings:this.getLocalizedSharedStrings(),style:Object.assign(Object.assign({},D),{minWidth:null!==(t=null==D?void 0:D.minWidth)&&void 0!==t?t:300,maxWidth:null!==(i=null==D?void 0:D.maxWidth)&&void 0!==i?i:420,hasBottomAttachment:(null==R?void 0:R.display)&&!R.pages.size}),theme:L,layerHostId:e}),n.createElement(y.b,{target:l.Y.critique,styles:{container:Object.assign({borderRadius:{topStart:0,topEnd:0,bottomStart:2,bottomEnd:2},minWidth:null!==(s=null==D?void 0:D.minWidth)&&void 0!==s?s:300,maxWidth:null!==(o=null==D?void 0:D.maxWidth)&&void 0!==o?o:420},null==F?void 0:F.container),dismissContainerStyle:null==F?void 0:F.dismissContainerStyle,textContainerStyle:null==F?void 0:F.textContainerStyle},hideIcon:A}))}))},this.renderSharedCallout=()=>{var e,t,i;const{localizer:s,themeStore:o}=this.props.deps,{target:r,setInitialFocus:a,shouldShowTonalFre:l,gapSpace:d,styles:u}=this.store,g=null==o?void 0:o.getComponentActiveTheme(S.yF.critiqueCalloutComponentName);if(!0!==this.context){const i=(0,D.Zq)(null===(e=u.calloutMain)||void 0===e?void 0:e.root,{marginLeft:this.state.marginLeft,marginRight:this.state.marginRight,border:(null===(t=null==g?void 0:g.callout)||void 0===t?void 0:t.borderColor)?`1px solid ${g.callout.borderColor}`:void 0});return n.createElement(c.U,{id:A,className:"ms-critique-callout","aria-label":s.getMessage("ebx_brandText"),calloutMaxWidth:450,doNotLayer:!1,gapSpace:d,isBeakVisible:!1,onDismiss:this.dismiss,onPositioned:e=>{e&&!this.hasPositioned&&(this.hasPositioned=!0,e.alignmentEdge===b.x.left?e.elementPosition.left?this.setState({marginLeft:-15,marginRight:0}):this.setState({marginLeft:0,marginRight:15}):e.alignmentEdge===b.x.right?e.elementPosition.left?this.setState({marginLeft:15,marginRight:0}):this.setState({marginLeft:0,marginRight:-15}):this.setState({marginLeft:0,marginRight:0}))},role:"dialog",target:(0,f.KV)(r),preventDismissOnLostFocus:!1,preventDismissOnEvent:this.onPreventDismissCalloutOnEvent,styles:Object.assign(Object.assign({},u.calloutMain),{root:i})},n.createElement(_.Y,{disableFirstFocus:!a,isClickableOutsideFocusTrap:!0},l?this.renderTonalFreCard():this.renderSharedCard()))}{const e=e=>void 0!==(null==e?void 0:e.key),t={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!0,withArrow:!1,open:this.store.isVisible,onOpenChange:(t,i)=>{if((i.open||!this.onPreventDismissCalloutOnEvent(t))&&!i.open){const i=t.nativeEvent;e(i)&&"Escape"===i.key&&this.store.restoreCaretToPreviousPosition(),this.dismiss()}},positioning:{target:(0,f.ug)(r),align:"start",position:"below",offset:e=>({mainAxis:d,crossAxis:"start"===e.alignment?-15:0})},ariaLabel:this.store.ariaLabelToReadWhenCardIsOpened},surface:{className:"ms-critique-callout",style:Object.assign({padding:0,maxWidth:450,border:(null===(i=null==g?void 0:g.callout)||void 0===i?void 0:i.borderColor)?`1px solid ${g.callout.borderColor}`:void 0},u.calloutV9)}};return n.createElement(n.Fragment,null,n.createElement("div",{id:A,"aria-live":"polite","aria-label":this.store.ariaLabelToReadWhenCardIsOpened}),n.createElement(h.v,Object.assign({},t),l?this.renderTonalFreCard():this.renderSharedCard()))}},this.onPreventDismissCalloutOnEvent=e=>{const{deps:t}=this.props,{calloutDismissalHandler:i}=t;if(i&&!i.shouldDismissCallout(e,"CritiqueCallout",void 0))return!0;if("click"===e.type){const t=this.store.target;if((0,v.C)(t,"HTMLElement")){const i=t.getBoundingClientRect();if(n=i,s=e.pageX,o=e.pageY,n.x<=s&&s<=n.x+n.width&&n.y<=o&&o<=n.y+n.height)return!0}}var n,s,o;return!1},this.store=e.deps.store,this.state={marginLeft:-15,marginRight:-15},this.documentEventListener=new m.J(this.store.targetDocumentRef)}componentDidUpdate(e,t,i){var n,s,o,r,a,l,d;this.parentElement||(this.parentElement=this.store.getParentElement()),this.store.isVisible?(null===(n=this.parentElement)||void 0===n||n.setAttribute("aria-activedescendant",A),null===(s=this.parentElement)||void 0===s||s.setAttribute("aria-controls",A),null===(o=this.parentElement)||void 0===o||o.setAttribute("aria-owns",A),this.store.setInitialFocus&&(null===(r=this.critiqueCalloutRef.current)||void 0===r||r.focus())):(null===(a=this.parentElement)||void 0===a||a.removeAttribute("aria-activedescendant"),null===(l=this.parentElement)||void 0===l||l.removeAttribute("aria-controls"),null===(d=this.parentElement)||void 0===d||d.removeAttribute("aria-owns"))}componentWillUnmount(){var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.documentEventListener=void 0,this.parentElement=void 0,null===(t=this.parentElementEventListener)||void 0===t||t.removeAllListeners(),this.parentElementEventListener=void 0}render(){const{styles:e,target:t}=this.store;let i=this.store.isVisible;return(!t||"x"in t&&"y"in t&&0===t.x&&0===t.y||(0,v.C)(t,"HTMLElement")&&!t.isConnected)&&(i=!1),n.createElement("div",{style:e.shadowHost},i?this.renderCallout():null)}getCommonStringsMap(){return{suggestionsGroupNoSuggestionsText:this.store.noSuggestionLabel}}getTextFormattingStringsMap(){const{localizer:e}=this.props.deps,{text:t,textInContext:i}=this.store;return{contextAccessibilityLabelForSpelling:e.getMessage("contextAccessibilityLabelForSpelling",[t,i]),contextAccessibilityLabelForRepeatedWord:e.getMessage("contextAccessibilityLabelForRepeatedWord",[t,i]),contextAccessibilityLabelForGrammar:e.getMessage("contextAccessibilityLabelForGrammar",[t,i]),contextAccessibilityLabelForRefinement:e.getMessage("contextAccessibilityLabelForRefinement",[t,i]),contextAccessibilityLabelForCorrection:e.getMessage("contextAccessibilityLabelForCorrection",[t,i])}}getCritiqueExplanationStringsMap(){const{localizer:e}=this.props.deps;return{explanationTableBefore:e.getMessage("explanationTableBefore"),explanationTableAfter:e.getMessage("explanationTableAfter"),explanationTableSeparator:e.getMessage("explanationTableSeparator"),explanationTableAccessibilityLabel:e.getMessage("explanationTableAccessibilityLabel")}}getCritiqueStringsMap(){var e;const{localizer:t}=this.props.deps,{calloutCategory:i,calloutTitle:n,navInfo:s}=this.store,o=t.getMessage("ebx_asInSynonyms"),r=`{0} ${o} {1}`,a=`{0}, {1} ${o} {2}`,l=s?(0,u.v)(s).length:0,d=null!==(e=null==s?void 0:s.currentIndex)&&void 0!==e?e:0,c=l-d-1;return{previewHeaderLabel:t.getMessage("ebx_previewLabel"),spellingCardHeader:i,repeatedWordCardSubheader:n,grammarCardHeader:i,tonalRewriteCardHeader:t.getMessage("ebx_toneLabel"),deleteRepeatedWord:t.getMessage("ebx_deleteRepeatedWord"),spellingSuggestionDescriptionAccessibilityLabel:r,suggestionWithTagAccessibilityLabel:"{0}, {1}",spellingSuggestionTagAndDescriptionAccessibilityLabel:a,ignoreAll:t.getMessage("ebx_ignoreAllButtonLabel"),ignoreOnce:t.getMessage("ebx_ignoreOnceButtonLabel"),addToDictionary:t.getMessage("ebx_addToDictionaryButtonLabel"),microsoftEditorBranding:t.getMessage("ebx_brandText"),microsoftEditorBrandingAccessibilityLabel:t.getMessage("ebx_brandTextArialLabel"),editorButtonTooltipContent:t.getMessage("ebx_settingsButtonTooltip"),footerSeeMoreActionsAccessibilityLabel:t.getMessage("ebx_moreButtonArialLabel"),changeAll:t.getMessage("ebx_changeAllCommandLabel"),giveFeedbackButtonText:t.getMessage("ebx_giveFeedback"),hideSynonyms:t.getMessage("ebx_hideSynonyms"),showSynonyms:t.getMessage("ebx_showSynonyms"),ignoreRule:t.getMessage("ebx_disableCritiqueButton"),options:t.getMessage("ebx_changeSettingsCommandLabel"),manageLanguages:t.getMessage("ebx_manageLanguages"),nextIssue:t.getMessage("ebx_nextIssueWithCount",c.toString()),nextIssueWithCount:t.getMessage("ebx_nextIssueWithCount",c.toString()),previousIssue:t.getMessage("ebx_previousIssueWithCount",d.toString()),previousIssueWithCount:t.getMessage("ebx_previousIssueWithCount",d.toString()),readAloudOriginalSentenceAccessibilityLabel:t.getMessage("readAloudOriginalSentenceAccessibilityLabel"),explanationFlyoutAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),footerExplanationButtonAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),editorButtonText:t.getMessage("editorButtonText")}}getLocalizedSharedStrings(){const e=this.getCritiqueStringsMap(),t=this.getCommonStringsMap(),i=this.getCritiqueExplanationStringsMap(),n=this.getTextFormattingStringsMap();return{critique:t=>e[t]||"",common:e=>t[e]||"",critiqueExplanation:e=>i[e]||"",textFormatting:e=>n[e]||""}}}q.contextType=S.O1;const P=(0,r.r)((0,F.PA)(q),R)},67873:(e,t,i)=>{i.d(t,{b:()=>le});var n,s,o=i(79490),r=i(90736),a=i(91513),l=i(76729);!function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(n||(n={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(s||(s={}));const d=(0,l.f)("IUpsellFeature");var c=i(13849),u=i(28831),h=i(45242),g=i(85924),p=i(79343),m=i(63201),f=i(81628);const v=(e,t)=>{const i=e.length,n=t.length;let s=0,o=0;for(let r=0;r<Math.min(i,n)&&e.charAt(r)===t.charAt(r);r+=1)s+=1,(0,f.Yv)(e.charCodeAt(r))&&(o=s);return o},_=(e,t)=>{const i=e.length,n=t.length;let s=0,o=0;for(let r=0;r<Math.min(i,n)&&e.charAt(i-r-1)===t.charAt(n-r-1);r+=1)s+=1,(0,f.Yv)(e.charCodeAt(i-r-1))&&(o=s);return o},y=(e,t,i)=>{let n,s;const o=e/2;return t<o&&i<o?(n=t,s=i):t<o?(n=t,s=Math.min(i,e-n)):i<o?(s=i,n=Math.min(t,e-s)):(n=o,s=o),{actualLeftContextLength:n,actualRightContextLength:s}},I=(e,t,i,n)=>{if(n){let n=t;for(;" "!==e.charAt(n)&&n<i;)n+=1;return n}{let n=i;const s=i;for(;" "!==e.charAt(n)&&n>t;)n-=1;return n+1<=s&&(n+=1),n}};var C=i(98824),S=i(33511),b=i(31294),T=i(2915),E=i(96571),N=i(11804),x=i(45462),w=i(10138),L=i(48129),D=i(10219),F=i(40200),A=i(23957),R=i(71417),q=i(3049),P=i(22696),O=i(23943),k=i(754),z=i(16087);const M=(0,l.f)("ITonalFreStore");var j=i(67165),W=i(24281),B=i(18574),U=i(15108),H=i(17205),V=i(9178),G=i(33012),Q=i(90327),K=i(79535),$=i(25449),J=i(68514),Z=i(33851),Y=i(65798),X=i(19728),ee=i(29906),te=i(83010),ie=i(27603),ne=i(13263),se=i(18381),oe=i(59039),re=i(44233),ae=i(41243);let le=class{constructor(e,t,i,o,l,d,f,S,b,T,E,N,x,w,L,D,F,A,P,O,k,z,M,j,G,Q){var K;this.proofingStore=e,this.localizerService=t,this.hostSettings=i,this.wordDictionary=o,this.instrumentationProcessor=l,this.logger=d,this.validator=f,this._showSynonymsFeature=S,this._proofingDom=b,this._tileContent=T,this._upsellFeature=E,this.styleDefinitions=N,this._roamingDictionaryBroker=x,this._upsellStore=w,this._featureFlagsReader=L,this._unSignedInEditorFeature=D,this._ariaStatusStateStore=F,this._feedbackStore=A,this._tonalFreStore=P,this._categoryLocalization=O,this._paneOpenState=k,this._externalSettingsFeature=z,this._roamingDictionaryFeature=M,this._indicatorStore=j,this._multilingualFreStore=G,this._autoCorrectionBroker=Q,this.wasMarkedAsShown=!1,this.enableUpsell=!1,this._setInitialFocus=!1,this._isVisible=!1,this._target=void 0,this.showSynonymsState=!1,this._suggestionsToRender=[],this.isApplyingCritiqueAction=!1,this.navInfo=void 0,this._gapSpace=void 0,this._unsignedInEditorFeatureEnabled=!1,this.show=async e=>{var t,i,o,l,d,u;const{critique:h,setInitialFocus:g,target:p,onDismiss:m,onApplySuggestion:f,onIgnoreOnce:v,onIgnoreAll:_,onDisableCritiqueType:y,onShowFeedback:I,targetDocumentRef:C,gapSpace:S}=e,b=null!==(i=null===(t=this._upsellStore)||void 0===t?void 0:t.reducePreviewCount(h))&&void 0!==i?i:R.nz.Visible,T=null===(o=this._upsellStore)||void 0===o?void 0:o.isSquiggleBeingPreviewed(h);if(b!==R.nz.Hidden&&!T){if(this._unsignedInEditorFeatureEnabled=await this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:r.o9.CalloutShown,sender:r.v$.CritiqueCallout}),this.setSynonymsState(await this.proofingStore.read(a.l.ShowSynonyms)),this._suggestionsToRender=[],this._setInitialFocus=g,this.critique=h,this._targetDocumentRef=C,this.enableUpsell=!!(null===(l=this._upsellFeature)||void 0===l?void 0:l.emitAndEvaluate({eventId:n.CritiqueClicked,sender:s.ShowCritiqueCallout,critique:this.critique})),h.suggestions.length>0)for(const[e,t]of h.suggestions.entries()){if((0,c.gA)(t.action))continue;let i={id:e.toString(),title:this.getSuggestionTitle(t),subtitle:this.getSuggestionDescription(t),tag:this.getLanguageTags(t),actions:[ne._R.Accept]};this.isRewrite&&(i=Object.assign(Object.assign({},i),this.getSuggestionTitleWithDecorations(t))),this.suggestionsToRender.push(i)}this.critique.shouldShowMultilingualFre?null===(d=this._multilingualFreStore)||void 0===d||d.addMultilingualProofingFre():null===(u=this._multilingualFreStore)||void 0===u||u.removeMultilingualProofingFre(),this.onAfterShownCallback=()=>{this._setInitialFocus&&(0,ae.Fy)(!0),this.onAfterShownCallback=void 0},this._gapSpace=S,(0,X.runInAction)((()=>{this._target=p})),this.onApplySuggestion=f,this.onIgnoreOnce=v,this.onIgnoreAll=_,this.onDisableCritiqueType=y,this.onShowFeedback=I,this.setIsVisible(!0),this.onShown(h,m)}},this.setSynonymsState=e=>{this.showSynonymsState=e},this.setIsVisible=e=>{this._isVisible=e,this.wasMarkedAsShown=!1},this.hide=()=>{var e;(this._isVisible||this.wasMarkedAsShown)&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isRewrite&&(null===(e=this._tonalFreStore)||void 0===e||e.checkIfDisableTonalCritiqueInitiatedAndCompleteIt()),this._isVisible=!1,this.wasMarkedAsShown=!1,this.instrumentationEventId=void 0,this.critique=void 0,this._target=void 0,this._targetDocumentRef=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onDisableCritiqueType=void 0,this.footerAction=void 0,this._gapSpace=void 0,this._suggestionsToRender=[],this.onDismiss()},this.onDismiss=()=>{var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this),this.onDismissCallback=void 0},this.afterRender=()=>{var e;null===(e=this.onAfterShownCallback)||void 0===e||e.call(this)},this.onCalloutAction=(e,t,i)=>{this.isApplyingCritiqueAction=!0;try{this.isCritiqueAction(e)?this.onCritiqueAction(e,t):this.onCardAction(e)}finally{this.isApplyingCritiqueAction=!1}},this.onTonalFreAction=e=>{var t;if(this._tonalFreStore){this.isApplyingCritiqueAction=!0;try{let i=!1;switch(e){case oe.h.Accept:this._tonalFreStore.acceptTonalRewriteCritique();break;case oe.h.Ignore:this.ignoreOnce(),i=!0,this._tonalFreStore.logTonalFreIgnored();break;case oe.h.Reject:void 0!==(null===(t=this.critique)||void 0===t?void 0:t.typeId)&&this._tonalFreStore.disableTonalRewriteCritique(this.critique.typeId);break;case oe.h.OpenEditorSettings:this._tonalFreStore.showEditorSettings(),i=!0;break;case oe.h.DismissRejectMessage:i=!0}i&&this.hide()}finally{this.isApplyingCritiqueAction=!1}}},this.changeShowSynonymsState=()=>{const e=!this.showSynonymsState;this.proofingStore.write(a.l.ShowSynonyms,e).then((()=>{this.updateShowSynonyms(e)}))},this.updateShowSynonyms=e=>{this.showSynonymsState=e;const t=this.logger.getNewActivity(this.showSynonyms?u.n.ActionShowSynonymsFromCallout:u.n.ActionHideSynonymsFromCallout,h.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())},this.goPremium=e=>{var t;null===(t=this._upsellFeature)||void 0===t||t.goPremium(s.ShowCritiqueCallout,this.critique,e)},this.tryPremiumPreview=()=>{var e;null===(e=this._upsellStore)||void 0===e||e.tryPremiumPreview(this.critique)},this.signIn=()=>{chrome.runtime.sendMessage({activity:"authentication",type:"msidUserService"});const e=this.logger.getNewActivity(u.n.SignInInitialized,h.o.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push((0,g.n)("Entry","CritiqueCallout")),e.success=!0,e.endNow())},this.clickNoActionHide=()=>{const e=this.shouldShowTonalFre;!this.isVisible&&!this.wasMarkedAsShown||e||this.recordInstrumentationEventId(Y.xp.ClickNoAction),this.hide()},this.notifyAriaStatusChange=e=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(e,"assertive")},this.applySuggestion=(e,t)=>{var i;this.critique&&this.onApplySuggestion&&(null===(i=this._upsellStore)||void 0===i||i.removePremiumCritique(this.critique),this.onApplySuggestion(this.critique,e))},this.ignoreOnce=()=>{var e,t;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&(null===(t=this.onIgnoreOnce)||void 0===t||t.call(this,this.critique))},this.ignoreAll=()=>{var e;this.critique&&(null===(e=this.onIgnoreAll)||void 0===e||e.call(this,this.critique))},this.addToDictionary=()=>{var e;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&this.wordDictionary.addWordToCustomDictionary(this.critique.textInContext)},this.disableCritiqueType=async()=>{var e;const t=this.critique;if(void 0===(null==t?void 0:t.typeId))return void this.logger.error(571326788,"Undefined critique or typeId while trying to disable a critique type");await(null===(e=this.onDisableCritiqueType)||void 0===e?void 0:e.call(this,t));const i=this.logger.getNewActivity(u.n.ActionDisableCritique,h.o.SamplingPolicy.CriticalExperimentation);i&&(i.dataFields.push((0,g.n)("CritiqueTypeId",t.typeId)),t.typeId===p.L9.TopicSuggestion&&i.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(t.metadata))),i.success=!0,i.endNow()),this.recordInstrumentationEventId(Y.xp.DoNotCheckThisIssue),this.notifyAriaStatusChange(t.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",t.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel")),this.hide()},this.onRewriteFeedback=()=>{if(this.isRewrite){const e=this.suggestionsToRender.length>0?this.suggestionsToRender[0].title:"";this._feedbackStore.feedbackIconClicked(e,"tonal"),this.hide()}},this.isCritiqueAction=e=>{switch(e){case ne._R.Accept:case ne._R.IgnoreOnce:case ne._R.IgnoreAll:case ne._R.AddToDictionary:case ne._R.IgnoreRule:return!0;default:return!1}},this.onCritiqueAction=(e,t)=>{var i;if(!this.critique)return void this.logger.error(562438878,`Undefined critique on action: ${e}`);const n=void 0!==t?this.critique.suggestions[t]:void 0;let s,o;switch(e){case ne._R.Accept:n&&void 0!==t?(this.applySuggestion(n,t),s=this.localizer.getMessage("ebx_SuggestionAppliedMessage",n.text),o=this.isSpellingDeletion?Y.xp.Delete:Math.min(t+Y.xp.ChangeSugg0,Y.xp.ChangeSuggOther)):this.logger.error(543495585,`Undefined suggestionIndex or suggestion on Accept: ${t}, ${n}`);break;case ne._R.IgnoreOnce:this.ignoreOnce(),s=this.localizer.getMessage("ebx_GrammarIgnored"),o=Y.xp.Ignore;break;case ne._R.IgnoreAll:this.ignoreAll(),s=this.localizer.getMessage("ebx_SpellingIgnored"),o=Y.xp.IgnoreAll;break;case ne._R.AddToDictionary:this.addToDictionary(),s=this.localizer.getMessage("ebx_AddedToDictionary",this.critique.textInContext),o=Y.xp.AddToDictionary;break;case ne._R.IgnoreRule:this.disableCritiqueType(),s=this.critique.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",this.critique.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel"),o=Y.xp.DoNotCheckThisIssue}void 0!==o?this.recordInstrumentationEventId(o):this.logger.error(562438879,`Undefined actionInstrumentationEventId on action: ${e}`),void 0!==s?this.notifyAriaStatusChange(s):this.logger.error(562438880,`Undefined actionAriaNotification on action: ${e}`),this.hide(),null===(i=this.navInfo)||void 0===i||i.onNavSuggestionApplied()},this.executeActionIfDefined=(e,t)=>{t?t():this.logger.error(561853783,`Undefined action clicked: ${e}`)},this.onCardAction=e=>{var t,i;switch(e){case ne._R.Options:this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide();break;case ne._R.ManageLanguages:this.executeActionIfDefined("manageLanguagesAction",this.manageLanguagesAction),this.hide();break;case ne._R.ShowExplanation:break;case ne._R.Feedback:if(this.isRewrite)this.onRewriteFeedback();else if(this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback){let e;try{e=this.critique.suggestions.map((e=>{var t;return JSON.parse(null!==(t=e.metadataJSON)&&void 0!==t?t:"{}")}))}catch(e){this.logger.error(537778203,"Error parsing topic metadata json.")}(0,m.z)((0,U.S)({topicIds:(null==e?void 0:e.map((e=>e.id)).join(", "))||"",topicNames:(null==e?void 0:e.map((e=>e.displayName)).join(", "))||"",highlightedText:this.critique.textInContext||"",requestId:this.critique.metadata[0].value,hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),source:"EditorFlag",traceId:this.critique.traceId||""}))}else this.executeActionIfDefined("onShowFeedback",this.onShowFeedback);break;case ne._R.ToggleDescription:this.changeShowSynonymsState();break;case ne._R.AddOnFooterAction:this.executeActionIfDefined("footerAction",this.footerAction);break;case ne._R.Next:this.navigate(1);break;case ne._R.Previous:this.navigate(-1);break;case ne._R.OpenEditorPane:this._indicatorStore?null===(i=(t=this._indicatorStore).onOpenEditorPane)||void 0===i||i.call(t,W.k.ContextualCard):this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide()}},this.getSuggestionTitle=e=>!(0,q.qB)(e)&&this.critique&&(0,q.ht)(this.critique)?this.localizer.getMessage("ebx_deleteRepeatedWord"):this.validator.validate(e.text),this.getSuggestionTitleWithDecorations=e=>{var t;if(null===(t=this.critique)||void 0===t?void 0:t.textInContext){const{truncatedPrefix:t,truncatedSubstring:i,truncatedSuffix:n}=((e,t)=>{const i=t.length,n=v(e,t),s=Math.min(_(e,t),Math.min(i,e.length)-n),o=n+s,r=i-o,a=Math.min(130,r),l=Math.min(150-a,o),d=Math.min(l,n),c=Math.min(l,s),{actualLeftContextLength:u,actualRightContextLength:h}=y(l,d,c),g=t.substring(n-u,n),p=t.substring(n,i-s),m=t.substring(i-s,i-s+h);let f=g,C=p,S=m;if(n>u){const e=I(g,0,g.length,!0);f=`...${g.substring(e,g.length)}`}if(p.length>a){const e=I(p,0,a/2,!1),t=I(p,a/2,p.length,!0);C=`${p.substring(0,e)}...${p.substring(t,p.length)}`}if(s>h){const e=I(m,0,m.length,!1);S=`${m.substring(0,e)}...`}return{truncatedPrefix:f,truncatedSubstring:C,truncatedSuffix:S}})(this.critique.textInContext,e.text);return{title:t+i+n,titleDecorations:[{start:e.text.indexOf(i),length:i.length,decorationType:ne.vr.Rewrite}]}}return{title:this.getSuggestionTitle(e),titleDecorations:void 0}},this.getSuggestionDescription=e=>{if(!this.isSynonymsEnabled)return;if(!this.isSynonymsAvailable)return;let t=this.validator.validate(e.description);return this.isTopicSuggestionCritique&&(t=t.slice(0,125),e.description&&e.description.length>t.length&&(t+="...")),t||this.localizer.getMessage("ebx_synonymsNotAvailable")},this.getNeutralLanguageCode=e=>{const t=e.indexOf("-");return(t<0?e:e.slice(0,t)).toUpperCase()},this.getLanguageTags=e=>{const t=this.proofingStore.getCachedEntry(a.l.ProofingLanguages).storeEntryValue;if(!t||t.length<2||!e.languages)return"";const i=[];for(const t of e.languages){const e=this.getNeutralLanguageCode(t);i.includes(e)||i.push(e)}return i.join(", ")},this.setNavInfo=e=>{this.navInfo=e},this.navigate=(e=0)=>{const t=(0,H.v)(this.navInfo),i=t.length;if(!this.navInfo||0===i)return this.resetNavigation(),this.clickNoActionHide(),!1;const n=((this.navInfo.currentIndex+e)%i+i)%i,s=t[n];return this.navInfo=Object.assign(Object.assign({},this.navInfo),{currentIndex:n}),this.hide(),"contenteditable"===this.navInfo.ctr?this.navigateCe(s.store,s.critique):this.navigateV2(s.store,s.critique),!0},this.navigateCe=(e,t)=>{const i=this.navInfo;e.showCallout(t,(()=>{this.setNavInfo(i)}))},this.navigateV2=(e,t)=>{const i=e.messageItem.anchor.element,n=this.navInfo;e.showCallout(t,i,i.innerText,!0,(()=>{this.setNavInfo(n)}),V.Ah.critique)},this.resetNavigation=()=>{var e;null===(e=this.navInfo)||void 0===e||e.onCloseNavigation(),this.navInfo=void 0},this.recordInstrumentationEventId=e=>{var t;this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e),e===Y.xp.ClickNoAction&&this.resetNavigation(),null===(t=this._indicatorStore)||void 0===t||t.userInputEvent()},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,X.toJS)(this.critique),eventId:e})},(0,B.Gn)(this),(null===(K=this._externalSettingsFeature)||void 0===K?void 0:K.openSettings)&&(this.showOptionsAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(C.kY.dropdown)},this.manageLanguagesAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(C.kY.manageLanguages)})}get roamingDictionaryEnabled(){var e,t;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!(null===(t=this._roamingDictionaryFeature)||void 0===t?void 0:t.isReady())}get cloudIconEnabled(){return this.hostSettings.inferenceCritiqueCloudIconEnabled&&!this.isRewrite}get shouldShowAddToDictionary(){return!!this.critique&&(this.roamingDictionaryEnabled&&this.isSpelling&&!(0,q.dt)(this.critique))}get isUpsell(){return this.enableUpsell}get setInitialFocus(){return this._setInitialFocus}get isVisible(){return this._isVisible}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new S.O(document)}getParentElement(){var e,t;if(null===(e=this.critique)||void 0===e?void 0:e.nodeId){const e=this._proofingDom.findParagraphNode(this.critique.nodeId);if(!e)return;const i=this._tileContent.getContainingElement(e);if(i)return null!==(t=(0,re.m)(i))&&void 0!==t?t:i}}get target(){return this._target}get isSynonymsEnabled(){return this._showSynonymsFeature.emitAndEvaluate({eventId:b.OV.GetMoreCommands,sender:b.xr.CritiqueCallout})}get showSynonyms(){return this.showSynonymsState||this.isTopicSuggestionCritique}get brandingMode(){return this.hostSettings.brandingMode}get suggestionsToRender(){return this._suggestionsToRender}get noSuggestionLabel(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.suggestions.length)&&(0,c.gA)(this.critique.suggestions[0].action)?this.critique.suggestions[0].text:""}get calloutTitle(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}return(0,q.dt)(this.critique)?this.localizer.getMessage("ebx_repeatedWordsExplanationTitle"):(0,q.r)(this.critique)?this.localizer.getMessage("ebx_spellingExplanationTitle"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionExplanationTitle"):this.validator.validate(this.critique.explanationTitle)}get text(){var e,t,i;return null!==(i=null===(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)||void 0===t?void 0:t.substring(this.critique.start,this.critique.start+this.critique.length))&&void 0!==i?i:""}get textInContext(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&void 0!==t?t:""}get calloutCategory(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}const e=this.critique.categoryTitle?this._categoryLocalization.toUiLocale(this.critique.categoryTitle):void 0,t=this.isRewrite?this.localizer.getMessage("ebx_toneLabel"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionLabel"):e;return this.validator.validate(t)}get explanation(){var e;return this.hostSettings.critiqueCalloutExplanationFlyout&&this.critique&&null!==(e=this.critique.explanation)&&void 0!==e?e:""}get explanationTitle(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.explanationLabel)&&void 0!==t?t:""}get localizer(){return this.localizerService}get styles(){return this.styleDefinitions.critiqueCallout}get ariaLabelToReadWhenCardIsOpened(){return this.localizer.getMessage("ebx_critiqueCalloutAriaLabel",[this.calloutCategory,this.explanationTitle,this.calloutTitle,this.textInContext])}get isSpelling(){return(0,q.r)(this.critique)}get isRepeatedWords(){return(0,q.dt)(this.critique)}get isRewrite(){return(0,q.r6)(this.critique)}get isTopicSuggestionCritique(){return(0,q.W)(this.critique)}get isAutoCorrection(){var e;return!!(this.hostSettings.enableAutoCorrect&&this.critique&&(0,q.MG)(this.critique)&&(null===(e=this._autoCorrectionBroker)||void 0===e?void 0:e.getHasAutoCorrectionBeenApplied(this.critique)))}get isSpellingDeletion(){return!!this.critique&&(0,q.ht)(this.critique)}get shouldShowTonalFre(){return this.isRewrite&&!!this.hostSettings.tonalFreEnabledForUser&&!!this._tonalFreStore&&!this._tonalFreStore.isTonalFreAccepted}get settings(){const e={RenderFooterIcons:"true"};return this.hostSettings.isFeedbackEnabled&&this.isRewrite&&(e.EnableFeedback="true"),this.hostSettings.ignoreAllEnabled&&(e.EnableIgnoreAll="true"),e}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:4}get critiqueType(){return this.critique&&(0,q.dt)(this.critique)?ne.L9.RepeatedWord:(0,q.r)(this.critique)?ne.L9.Spelling:(0,q.W)(this.critique)?ne.L9.Topic:this.critique&&this.critique.priority===p.bx.Medium?ne.L9.Grammar:this.isRewrite?ne.L9.TonalRewrite:ne.L9.Refinement}get critiqueSource(){if(this.critique&&this.cloudIconEnabled){const e=this.critique.metadata;if(e&&e.length>0)for(const t of e)if("CritiqueSource"===t.name&&"Inference"===t.value)return se.UD.Inference}return se.UD.Unknown}get isSynonymsAvailable(){var e;const t=null===(e=this.critique)||void 0===e?void 0:e.suggestions.find((e=>!!e.description&&!e.description.match(/\[(.*)\]/g)));return(this.isSpelling||this.isTopicSuggestionCritique)&&!this.isAutoCorrection&&!!t}get showDisableCritiqueTypeMenuItem(){return!!this.hostSettings.enableStopCheckingForThis&&!!this.critique&&this.critique.priority!==p.bx.High&&!this.isTopicSuggestionCritique}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}async initialize(){}shutDown(){this._target=void 0,this._targetDocumentRef=void 0,this.onDisableCritiqueType=void 0,this.onDismissCallback=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onAfterShownCallback=void 0,this.onShowFeedback=void 0,this.showOptionsAction=void 0,this.manageLanguagesAction=void 0,this.footerAction=void 0}markAsShown(e,t){this.wasMarkedAsShown=!0,this.onShown(e,t)}onShown(e,t){var i;this.shouldShowTonalFre&&(null===(i=this._tonalFreStore)||void 0===i||i.logTonalFreShown());const n=this.logger.getNewActivity(u.n.ActionShowCallout,h.o.SamplingPolicy.CriticalExperimentation);n&&(n.dataFields.push((0,g.n)("CritiqueTypeId",e.typeId)),e.typeId===p.L9.TopicSuggestion&&n.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata))),n.success=!0,n.endNow()),this.onDismiss(),this.onDismissCallback=t}get dropDownActions(){var e;const t=[];return this.isAutoCorrection?t.push(ne._R.AutoCorrectOptions):this.isSpelling&&!this.isSpellingDeletion?(this.hostSettings.ignoreAllEnabled&&t.push(ne._R.IgnoreAll),this.hostSettings.isMultilingualProofingEnabled&&this.hostSettings.enableManageLanguagesInCritiqueCallout&&t.push(ne._R.ManageLanguages)):this.hostSettings.ignoreOnceEnabled&&t.push(ne._R.IgnoreOnce),this.isTopicSuggestionCritique&&this.hostSettings.ignoreAllEnabled&&t.push(ne._R.IgnoreAll),this.isSynonymsAvailable&&this.isSynonymsEnabled&&!this.isTopicSuggestionCritique&&t.push(ne._R.ToggleDescription),this.hostSettings.showOptionsButton&&t.push(ne._R.Options),(this._featureFlagsReader.flags.enableOcvFeedbackUi||this.hostSettings.isFeedbackEnabled&&this.isRewrite||this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback)&&t.push(ne._R.Feedback),this.showDisableCritiqueTypeMenuItem&&t.push(ne._R.IgnoreRule),!this.isAutoCorrection&&this.shouldShowAddToDictionary&&t.push(ne._R.AddToDictionary),this.navInfo&&(t.push(ne._R.Next),t.push(ne._R.Previous)),(null===(e=this._paneOpenState)||void 0===e?void 0:e.isPaneOpen)||this.brandingMode!==ne.nH.IconButton&&this.brandingMode!==ne.nH.IconAndTextButton||t.push(ne._R.OpenEditorPane),t}get addOnFooterData(){var e,t;if(this.unsignedInEditorFeatureEnabled)return this.footerAction=this.signIn,{actionText:this.localizer.getMessage("ebx_signIntoEditor"),message:`${this.localizer.getMessage("ebx_addGrammarChecking")}${this.localizer.getMessage("ebx_enhancedUpsellCategoriesComma")}`};if(!this.enableUpsell)return;if(!(this.hostSettings.areAdditionalPaneEntryPointsEnabled&&this._indicatorStore))return this.premiumPreviewFooter;this.footerAction=()=>{var e,t;null===(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.onOpenEditorPane)||void 0===t||t.call(e,W.k.ContextualCard),this.hide()};const i=null!==(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.getPremiumCritiquesCount())&&void 0!==t?t:0;return{actionText:this.localizer.getMessage("ebx_openEditorLabel"),message:i>0?this.localizer.getMessage("ebx_editorAdvancedCritiquesLabel",i.toString()):this.localizer.getMessage("ebx_tryEditorLabel"),icon:"Editor"}}get premiumPreviewFooter(){if(!this.hostSettings.enhancedUpsellEnabled||!this._upsellStore)return this.footerAction=()=>this.goPremium("Regular_CCard"),{actionText:this.localizer.getMessage("ebx_goPremiumLinkText"),message:this.localizer.getMessage("ebx_goPremiumLine"),icon:"PremiumDiamond"};const e=this._upsellStore.previewModeActive,t=this.hostSettings.premiumPreviewEnabled,i=this._upsellStore.previewUnit,n=e?this._upsellStore.previewCount:this._upsellStore.premiumCount,s=t&&!e&&n>0;let o="ebx_premiumPreviewGeneralLine";const r=1===n;e&&i===R.mq.Suggestions?o=r?"ebx_premiumPreviewSuggestionsSingular":"ebx_premiumPreviewSuggestionsPlural":e&&i===R.mq.Days?o=r?"ebx_premiumPreviewDaysSingular":"ebx_premiumPreviewDaysPlural":n>0&&(o=r?"ebx_enhancedUpsellLineSingular":"ebx_enhancedUpsellLinePlural");const a=n.toLocaleString(),l=this.localizer.getMessage(o,a);return this.footerAction=s?()=>{var e;return null===(e=this._upsellStore)||void 0===e?void 0:e.tryPremiumPreview(this.critique)}:()=>this.goPremium("ContextualUpsell_CCard"),{actionText:s?this.localizer.getMessage("ebx_tryPremiumPreviewLink"):this.localizer.getMessage("ebx_goPremiumLinkText"),footerDecorations:n>0||e?[{decorationType:ne.vr.PremiumEmphasis,length:a.length,start:l.indexOf(a)}]:void 0,message:l,icon:"PremiumDiamond"}}restoreCaretToPreviousPosition(){var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this,!0)}};(0,o.__decorate)([X.observable],le.prototype,"enableUpsell",void 0),(0,o.__decorate)([X.computed],le.prototype,"isUpsell",null),(0,o.__decorate)([X.observable],le.prototype,"_setInitialFocus",void 0),(0,o.__decorate)([X.computed],le.prototype,"setInitialFocus",null),(0,o.__decorate)([X.observable],le.prototype,"_isVisible",void 0),(0,o.__decorate)([X.computed],le.prototype,"isVisible",null),(0,o.__decorate)([X.observable],le.prototype,"_target",void 0),(0,o.__decorate)([X.computed],le.prototype,"target",null),(0,o.__decorate)([X.observable],le.prototype,"showSynonymsState",void 0),(0,o.__decorate)([X.computed],le.prototype,"showSynonyms",null),(0,o.__decorate)([X.computed],le.prototype,"brandingMode",null),(0,o.__decorate)([X.observable],le.prototype,"_suggestionsToRender",void 0),(0,o.__decorate)([X.computed],le.prototype,"suggestionsToRender",null),(0,o.__decorate)([X.computed],le.prototype,"noSuggestionLabel",null),(0,o.__decorate)([X.observable],le.prototype,"navInfo",void 0),(0,o.__decorate)([X.computed],le.prototype,"calloutTitle",null),(0,o.__decorate)([X.computed],le.prototype,"text",null),(0,o.__decorate)([X.computed],le.prototype,"textInContext",null),(0,o.__decorate)([X.computed],le.prototype,"calloutCategory",null),(0,o.__decorate)([X.computed],le.prototype,"explanation",null),(0,o.__decorate)([X.computed],le.prototype,"explanationTitle",null),(0,o.__decorate)([X.computed],le.prototype,"styles",null),(0,o.__decorate)([X.computed],le.prototype,"ariaLabelToReadWhenCardIsOpened",null),(0,o.__decorate)([X.computed],le.prototype,"shouldShowTonalFre",null),(0,o.__decorate)([X.computed],le.prototype,"settings",null),(0,o.__decorate)([X.observable],le.prototype,"_gapSpace",void 0),(0,o.__decorate)([X.computed],le.prototype,"gapSpace",null),(0,o.__decorate)([X.computed],le.prototype,"critiqueType",null),(0,o.__decorate)([X.computed],le.prototype,"critiqueSource",null),(0,o.__decorate)([X.action],le.prototype,"show",void 0),(0,o.__decorate)([X.action],le.prototype,"setSynonymsState",void 0),(0,o.__decorate)([X.action],le.prototype,"setIsVisible",void 0),(0,o.__decorate)([X.action],le.prototype,"hide",void 0),(0,o.__decorate)([X.action],le.prototype,"onDismiss",void 0),(0,o.__decorate)([X.action],le.prototype,"afterRender",void 0),(0,o.__decorate)([X.action],le.prototype,"onCalloutAction",void 0),(0,o.__decorate)([X.action],le.prototype,"onTonalFreAction",void 0),(0,o.__decorate)([X.computed],le.prototype,"dropDownActions",null),(0,o.__decorate)([X.action],le.prototype,"updateShowSynonyms",void 0),(0,o.__decorate)([X.computed],le.prototype,"addOnFooterData",null),(0,o.__decorate)([X.action],le.prototype,"setNavInfo",void 0),(0,o.__decorate)([X.action],le.prototype,"navigate",void 0),(0,o.__decorate)([X.action],le.prototype,"resetNavigation",void 0),le=(0,o.__decorate)([(0,ee._)(),(0,o.__param)(0,(0,te.W)(T.K)),(0,o.__param)(1,(0,te.W)(E.H)),(0,o.__param)(2,(0,te.W)(N.n)),(0,o.__param)(3,(0,te.W)(P.s)),(0,o.__param)(4,(0,te.W)(x.f)),(0,o.__param)(5,(0,te.W)(w.g)),(0,o.__param)(6,(0,te.W)($.$)),(0,o.__param)(7,(0,te.W)(b.DS)),(0,o.__param)(8,(0,te.W)(O.w)),(0,o.__param)(9,(0,te.W)(k.d)),(0,o.__param)(10,(0,te.W)(d)),(0,o.__param)(10,(0,ie.l)()),(0,o.__param)(11,(0,te.W)(G.$)),(0,o.__param)(12,(0,te.W)(L.C)),(0,o.__param)(12,(0,ie.l)()),(0,o.__param)(13,(0,te.W)(R.Ey)),(0,o.__param)(13,(0,ie.l)()),(0,o.__param)(14,(0,te.W)(D.c)),(0,o.__param)(15,(0,te.W)(r.tq)),(0,o.__param)(16,(0,te.W)(Q.JY)),(0,o.__param)(17,(0,te.W)(z.M)),(0,o.__param)(18,(0,te.W)(M)),(0,o.__param)(18,(0,ie.l)()),(0,o.__param)(19,(0,te.W)(Z.C)),(0,o.__param)(20,(0,ie.l)()),(0,o.__param)(20,(0,te.W)(F.F)),(0,o.__param)(21,(0,ie.l)()),(0,o.__param)(21,(0,te.W)(C.In)),(0,o.__param)(22,(0,ie.l)()),(0,o.__param)(22,(0,te.W)(A.Zp)),(0,o.__param)(23,(0,ie.l)()),(0,o.__param)(23,(0,te.W)(j.y)),(0,o.__param)(24,(0,ie.l)()),(0,o.__param)(24,(0,te.W)(K.j)),(0,o.__param)(25,(0,ie.l)()),(0,o.__param)(25,(0,te.W)(J.m))],le)},80910:(e,t,i)=>{var n;i.d(t,{u:()=>n}),function(e){e.calloutMain="calloutMain",e.moreActions="moreActions"}(n||(n={}))},83342:(e,t,i)=>{i.d(t,{$:()=>y,v:()=>_});var n=i(8520);if(2063!=i.j)var s=i(72982);if(2063!=i.j)var o=i(98141);if(2063!=i.j)var r=i(96713);if(2063!=i.j)var a=i(80617);var l=i(26598),d=i(30833),c=i(5645);if(2063!=i.j)var u=i(17806);if(2063!=i.j)var h=i(70547);if(2063!=i.j)var g=i(24852);if(2063!=i.j)var p=i(38444);var m=i(87414);if(2063!=i.j)var f=i(18640);if(2063!=i.j)var v=i(24136);const _=(0,l.F5)({state:d.A.on(c.x)}),y=()=>{const e=n.useContext(m.O1),{state:t}=(0,l.KN)(_),[i,d]=n.useState(!1);n.useEffect((()=>(t.subscribe("visibilityUpdated",d),()=>{t.unsubscribe("visibilityUpdated",d)})),[t]);const{undoAriaLabel:c,undoTitle:y,localizer:I,target:C,styles:S,showEditorBranding:b,gapSpace:T}=t,E=I.getMessage("ebx_settingsButtonTooltip"),N=I.getMessage("ebx_undoCalloutAriaLabel"),x=n.useCallback((()=>{t.applyUndo()}),[t]),w=n.useCallback((()=>{t.openSettings()}),[t]),L=n.useCallback((e=>{t.updateCalloutPosition((null==e?void 0:e.alignmentEdge)===g.x.right,!1)}),[t]),D=(0,v.I)(),F=n.createElement("div",{style:Object.assign({display:"flex",flexDirection:"row",flexWrap:"nowrap"},S.calloutContainer)},n.createElement(r.$,{icon:n.createElement(s.t2R,{style:e?void 0:S.buttonIcon.icon,className:D.icon}),appearance:"subtle",className:`${p.g.undoButton}`,"data-automation-id":"undo-callout-undo-button",key:"Undo",role:"button",style:S.buttonIcon,title:y,"aria-label":c,onClick:x}),n.createElement(r.$,{icon:n.createElement(o.$Dw,{style:e?void 0:S.buttonIcon.icon,className:D.icon}),appearance:"subtle",className:p.g.settingsButton,key:"Settings","data-automation-id":"undo-callout-settings-button",role:"button",style:Object.assign({marginLeft:2},S.buttonIcon),title:E,"aria-label":E,onClick:w}),b&&n.createElement("span",{role:"none presentation","aria-hidden":!0,style:S.logoButtonBase},I.getMessage("ebx_brandText")));if(e){const e={popover:{trapFocus:t.setInitialFocus,withArrow:!1,open:i,ariaLabel:N,ariaRole:"group",positioning:{target:(0,f.ug)(C),align:"center",position:"above",offset:e=>(t.updateCalloutPosition("end"===e.alignment,!0),{mainAxis:T})}},surface:{style:Object.assign({padding:0,background:a.L.colorNeutralBackground1,borderRadius:8},S.calloutV9)}};return n.createElement(h.v,Object.assign({ref:t.undoCardV9Ref},e),F)}return i?n.createElement(u.U,{ref:t.undoCardRef,isBeakVisible:!1,gapSpace:T,target:(0,f.KV)(C),doNotLayer:!0,role:"group",ariaLabel:N,setInitialFocus:t.setInitialFocus,onRestoreFocus:()=>{},onPositioned:L,styles:S.calloutMain},F):n.createElement(n.Fragment,null)}},24136:(e,t,i)=>{i.d(t,{I:()=>o});var n=i(658),s=i(80617);const o=(0,n.n)({icon:{color:s.L.colorNeutralForeground1}})},38444:(e,t,i)=>{i.d(t,{f:()=>b,g:()=>S});var n=i(79490),s=i(59556),o=i(18640),r=i(98824),a=i(28831),l=i(45242),d=i(96571),c=i(11804),u=i(10138),h=i(10219),g=i(45462),p=i(90327),m=i(33012),f=i(25449),v=i(22696),_=i(29906),y=i(83010),I=i(27603),C=i(8520);const S={undoButton:"ebx_undoButton",settingsButton:"ebx_settingsButton"};let b=class extends s.z{constructor(e,t,i,n,s,a,l,d,c,u){var h;let g;super(),this.localizer=e,this.hostSettings=t,this.externalSettingsFeature=i,this.logger=n,this.wordDictionary=s,this._ariaStatusStateStore=a,this._featureFlagsReader=l,this.validator=d,this.instrumentationProcessor=c,this.styleDefinitions=u,this._undoCardRef=C.createRef(),this._undoCardV9Ref=C.createRef(),this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._unsignedInEditorFeatureEnabled=!1,this.getTargetRect=()=>{var e,t;if(this.target)return(0,o.Pe)(this.target)?{left:this.target.x,right:this.target.x,top:this.target.y,bottom:this.target.y,width:0,height:0}:(0,o.K2)(this.target)?{left:this.target.left,right:null!==(e=this.target.right)&&void 0!==e?e:0,top:this.target.top,bottom:null!==(t=this.target.bottom)&&void 0!==t?t:0,width:this.target.width,height:this.target.height}:this.target.getBoundingClientRect()},this.executeShowOptionsAction=()=>{this.showOptionsAction&&this.showOptionsAction()},this.setShowOptionsAction=e=>{e&&(this.showOptionsAction=e)},this.notifyAriaStatusChange=(e,t)=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(this.localizer.getMessage(e,t),"assertive")},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:this.critique,eventId:e})},(null===(h=this.externalSettingsFeature)||void 0===h?void 0:h.openSettings)&&(g=()=>{var e;null===(e=this.externalSettingsFeature)||void 0===e||e.openSettings(r.kY.dropdown)}),this.setShowOptionsAction(g)}get undoCardRef(){return this._undoCardRef}get undoCardV9Ref(){return this._undoCardV9Ref}get isVisible(){return this._isVisible}get target(){return this._target}get targetRect(){return this._targetRect||(this._targetRect=this.getTargetRect()),this._targetRect}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:0}get setInitialFocus(){var e;return null!==(e=this._setInitialFocus)&&void 0!==e&&e}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}get mainFocusZoneId(){return"calloutMain--undo"}get undoTitle(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,i=this.localizer.getMessage("ebx_autoCorrectRevertTo",t);return this.validator.validate(i)}get undoAriaLabel(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,i=t.split("").join(" "),n=this.localizer.getMessage("ebx_autoCorrectRevertTo",t),s=this.localizer.getMessage("ebx_undoButtonAriaLabel");return this.validator.validate(`${s}, ${n}, ${i}`)}get showEditorBranding(){return!!this.hostSettings.undoCardShowEditorLogo}get styles(){return this.styleDefinitions.undoCallout}checkShowConditions(e){return!!this.hostSettings.enableAutoCorrect}async prepareShowContent(e){const{onApplySuggestion:t,critique:i,onCalloutPositionUpdated:n}=e;this.critique=i,this.onApplySuggestion=t,this.onCalloutPositionUpdated=n}hide(e){this.isVisible&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isVisible&&(this.resetVariablesAfterHide(),this.onDismiss(e))}resetVariablesAfterHide(){this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._gapSpace=void 0,this.instrumentationEventId=void 0,this.onApplySuggestion=void 0,this.critique=void 0,this.publishEvent("visibilityUpdated",this._isVisible)}onDismiss(e){var t;null===(t=this.onDismissCallback)||void 0===t||t.call(this,e),this.onDismissCallback=void 0}async show(e){if(!this.checkShowConditions(e))return;const{setInitialFocus:t,target:i,onDismiss:n,gapSpace:s}=e;this._target=i,this._gapSpace=s,this._setInitialFocus=t,this.onDismiss(!1),this.onDismissCallback=n,await this.prepareShowContent(e),this._isVisible=!0,this.publishEvent("visibilityUpdated",this._isVisible),this.doAfterShow()}doAfterShow(){this.logUndoCalloutOpened()}logUndoCalloutOpened(){const e=this.logger.getNewActivity(a.n.UndoCalloutShown,l.o.SamplingPolicy.CriticalExperimentation);e&&(e.success=!0,e.endNow())}clickNoActionHide(e){this.isVisible&&this.recordInstrumentationEventId(12),this.hide(e)}applyUndo(){if(this.onApplySuggestion&&this.critique&&this.critique.suggestions.length){const e=this.critique.suggestions[0];this.onApplySuggestion(this.critique,e),this.wordDictionary.addWordToIgnoreList(e.text),this.notifyAriaStatusChange("ebx_autoCorrectIgnored",e.text),this.recordInstrumentationEventId(16)}this.hide()}openSettings(){this.executeShowOptionsAction(),this.hide()}updateCalloutPosition(e,t){var i,n,s;if(this.onCalloutPositionUpdated){const o=t?null===(s=null===(n=this._undoCardV9Ref.current)||void 0===n?void 0:n.getElementRef().current)||void 0===s?void 0:s.firstChild:null===(i=this._undoCardRef.current)||void 0===i?void 0:i.firstChild;if(o){const t=o.getBoundingClientRect();this.onCalloutPositionUpdated(e,t)}}}};b=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,y.W)(d.H)),(0,n.__param)(1,(0,y.W)(c.n)),(0,n.__param)(2,(0,I.l)()),(0,n.__param)(2,(0,y.W)(r.In)),(0,n.__param)(3,(0,y.W)(u.g)),(0,n.__param)(4,(0,y.W)(v.s)),(0,n.__param)(5,(0,y.W)(p.JY)),(0,n.__param)(6,(0,y.W)(h.c)),(0,n.__param)(7,(0,y.W)(f.$)),(0,n.__param)(8,(0,y.W)(g.f)),(0,n.__param)(9,(0,y.W)(m.$))],b)},30805:(e,t,i)=>{i.d(t,{b:()=>m});var n=i(8520),s=i(26598),o=i(30833);if(2063!=i.j)var r=i(14438);var a=i(27523),l=i(14775),d=i(87414);if(2063!=i.j)var c=i(44528);if(2063!=i.j)var u=i(94147);const h=e=>{switch(e){case a.Y.critique:return"footer_fre_in_critique_callout";case a.Y.inlineSuggestions:return"footer_fre_in_inline_suggestion_callout";default:return"footer_fre_generic"}},g=()=>{const e=(0,u.$)().getStringsFor("OnCanvasCalloutStrings"),t={nextPageTooltip:e("footerFRE_nextPageTooltip"),paginationTipsText:e("footerFRE_paginationTipsText"),previousPageTooltip:e("footerFRE_previousPageTooltip")};return{footer:e=>t[e]||""}},p=(0,s.F5)({themeStore:o.A.on(d.YQ).optional(),footerFreStore:o.A.on(a.D).optional(),languageScriptDirectionDetector:o.A.on(l.iw).optional()}),m=e=>{const{target:t,styles:i}=e,{footerFreStore:o,languageScriptDirectionDetector:a,themeStore:l}=(0,s.SM)(p),[u,m]=n.useState((()=>null==o?void 0:o.footerProps.get(t)));n.useEffect((()=>{if(!o)return;const e=e=>{const i=e.footerProps.get(t);m(i?Object.assign({},i):void 0)};return o.subscribe("stateUpdated",e),()=>{o.unsubscribe("stateUpdated",e)}}),[o,t]);const[f,v]=n.useState(null==l?void 0:l.getComponentActiveTheme(d.yF.footerFreComponentName,!0));if(n.useEffect((()=>{if(!l)return()=>{};const e=()=>{v(l.getComponentActiveTheme(d.yF.footerFreComponentName,!0))};return l.subscribe("currentThemeUpdated",e),l.subscribe("defaultThemeUpdated",e),l.subscribe("themesUpdated",e),()=>{l.unsubscribe("currentThemeUpdated",e),l.unsubscribe("defaultThemeUpdated",e),l.unsubscribe("themesUpdated",e)}}),[l]),!(null==u?void 0:u.display)||!u.pages.size)return null;const _=n.createElement(r.J,{automationId:h(t),pages:Array.from(u.pages.values()),animated:u.animated,styles:i,strings:g(),theme:f,onDismiss:()=>null==o?void 0:o.setFooterDisplay(t,!1),hideIcon:e.hideIcon});return a?n.createElement(c.K,{rtl:a.isRtl()},_):_}},60152:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(79490),s=i(59556),o=i(29906);let r=class extends s.z{constructor(){super(...arguments),this.footerProps=new Map}publishStateChange(){this.publishEvent("stateUpdated",{footerProps:this.footerProps})}setFooterDisplay(e,t){const i=this.footerProps.get(e);i&&(this.footerProps.set(e,Object.assign(Object.assign({},i),{display:t})),this.publishStateChange())}setFooterAnimated(e,t){const i=this.footerProps.get(e);i&&(this.footerProps.set(e,Object.assign(Object.assign({},i),{animated:t})),this.publishStateChange())}addFooterPage(e,t,i){var n;const s=null!==(n=this.footerProps.get(e))&&void 0!==n?n:{display:!0,pages:new Map,animated:!0};s.pages.set(t,i),s.display=!0,this.footerProps.set(e,s),this.publishStateChange()}removeFooterPage(e,t){const i=this.footerProps.get(e);i&&(i.pages.delete(t),0===i.pages.size&&(i.display=!1),this.footerProps.set(e,i),this.publishStateChange())}};r=(0,n.__decorate)([(0,o._)()],r)},70600:(e,t,i)=>{if(i.d(t,{a:()=>u}),2063!=i.j)var n=i(96713);var s=i(26598),o=i(30833);if(2063!=i.j)var r=i(29638);var a=i(27523),l=i(96571),d=i(8520);const c=(0,s.F5)({localizer:o.A.on(l.H),footerFreStore:o.A.on(a.D)}),u=e=>{var t;const{theme:i,style:o,languageName:l,undoCallback:u,manageLanguagesCallback:h}=e,{localizer:g,footerFreStore:p}=(0,s.KN)(c),m=()=>{p.removeFooterPage(a.Y.languageAutoDetection,r.Id)};return d.createElement("div",{style:Object.assign({color:null!==(t=null==i?void 0:i.textColor)&&void 0!==t?t:"#323130",minWidth:250},o)},d.createElement("div",{style:{marginBottom:12,paddingRight:14}},g.getMessage("autoDetectionFRE_HeadingText",l)),d.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},d.createElement(n.$,{appearance:"transparent",style:{fontSize:12,padding:2,minWidth:"fit-content",height:"revert",minHeight:24},onClick:()=>{u(),m()}},g.getMessage("autoDetectionFRE_UndoButtonText",l)),d.createElement(n.$,{style:{borderRadius:4,marginLeft:8,fontSize:12,height:"fit-content",minHeight:24,textAlign:"left",paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2},onClick:()=>{h(),m()}},g.getMessage("autoDetectionFRE_ManageLanguagesText",l))))}},29638:(e,t,i)=>{i.d(t,{Id:()=>f,lP:()=>v,sy:()=>_});var n=i(26598),s=i(30833);if(2063!=i.j)var o=i(18309);var r=i(27523);if(2063!=i.j)var a=i(17806);if(2063!=i.j)var l=i(70547);if(2063!=i.j)var d=i(98970);if(2063!=i.j)var c=i(18640);if(2063!=i.j)var u=i(30805);var h=i(87414);if(2063!=i.j)var g=i(62558);var p=i(8520);const m=(0,n.F5)({footerFreStore:s.A.on(r.D)}),f="LanguageAutoDetection",v="lang-auto-detect-footer",_=()=>{const{footerFreStore:e}=(0,n.KN)(m),[t,i]=p.useState((()=>e.footerProps.get(r.Y.languageAutoDetection)));return p.useEffect((()=>{const t=e=>{const t=e.footerProps.get(r.Y.languageAutoDetection);i(t?Object.assign({},t):void 0)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),(null==t?void 0:t.display)&&1===t.pages.size?p.createElement(y,null):null},y=()=>{var e,t;const i=p.useContext(h.O1),n=null!==(e=(0,g.ZY)())&&void 0!==e?e:document,s=null!==(t=n.defaultView)&&void 0!==t?t:window,[m,f]=p.useState(I(n)),[_,y]=p.useState(!0),C=p.useCallback((()=>{f(I(n))}),[n,f]);if(p.useEffect((()=>{const e=new d.J(s);return e.addListener("resize",C,{passive:!0,capture:!0}),()=>{e.removeAllListeners()}}),[C,s]),i){const e={popover:{id:v,withArrow:!1,open:_,onOpenChange:(e,t)=>{y(t.open)},positioning:{target:(0,c.ug)(m),align:"center",position:"above",offset:e=>({mainAxis:8})}},surface:{style:{padding:0,background:"transparent",borderRadius:8}}};return p.createElement(l.v,Object.assign({},e),p.createElement(u.b,{target:r.Y.languageAutoDetection}))}return p.createElement(a.U,{id:v,target:m,directionalHint:o.A.topCenter,isBeakVisible:!1,gapSpace:8,style:{borderRadius:8},styles:{root:{borderRadius:8},calloutMain:{background:"transparent"}}},p.createElement(u.b,{target:r.Y.languageAutoDetection}))};function I(e){return{x:e.body.clientWidth-240,y:e.body.clientHeight-13}}},46520:(e,t,i)=>{i.d(t,{Nt:()=>l,cu:()=>d});var n=i(20710),s=i(96686),o=i(33511),r=i(8520),a=i(94329);function l(e,t,i){return new u(e,t,i)}function d(e,t){const i=new c(e);return{element:r.createElement(h,{eccUxReplacement:i,commonOptions:t}),eccUxReplacement:i}}class c{constructor(e){this.iframeElement=e,this.eccStateChanged=e=>{var t;null===(t=this.listener)||void 0===t||t.call(this,e)},this.setListener=e=>{this.listener=e}}dispose(){this.listener&&(this.listener(void 0),this.listener=void 0)}}class u extends c{constructor(e,t,i){super(t),this.editorCard=document.createElement("external-editor-card"),this.editorCard.setAttribute("style","position:absolute;top:0px;left:0px;z-index:auto;display: block !important"),e.appendChild(this.editorCard),a.render(r.createElement(h,{eccUxReplacement:this,commonOptions:i}),this.editorCard)}dispose(){this.editorCard&&(a.unmountComponentAtNode(this.editorCard),this.editorCard.remove(),this.editorCard=void 0),super.dispose()}}const h=e=>{var t;const{iframeElement:i,setListener:a}=e.eccUxReplacement,[l,d]=r.useState(),c=r.useCallback((e=>{d(e)}),[d]);if(r.useEffect((()=>(a(c),()=>{a(void 0)})),[c,a]),!l)return null;const u=function(e,t){var i,n;if(!e||!t||"string"==typeof t)return t;let s=e.getBoundingClientRect();const o=getComputedStyle(e),r=parseFloat(o.borderWidth.replace("px",""));if(s=new DOMRect(s.left+r,s.top+r,s.width-r-r,s.height-r-r),"left"in t&&"top"in t&&t.left&&t.top)return"width"in t&&"height"in t?{left:t.left+s.left,right:t.left+s.left+t.width,top:t.top+s.top,bottom:t.top+s.top+t.height,width:t.width,height:t.height}:{x:(null!==(i=t.left)&&void 0!==i?i:0)+s.left,y:(null!==(n=t.top)&&void 0!==n?n:0)+s.top};if("x"in t&&"y"in t)return{x:t.x+s.left,y:t.y+s.top};return t}(i,l.targetLocation);return u?r.createElement(s.O.Provider,{value:!!(null===(t=e.commonOptions)||void 0===t?void 0:t.useFluentV9)},r.createElement("div",{dir:l.calloutProps.isRtl?"rtl":"ltr",style:{all:"initial"}},r.createElement(n.$,Object.assign({},l,{targetWindow:new o.O(window),targetLocation:u,isMobile:!1,isRtl:l.calloutProps.isRtl})))):null}},24896:(e,t,i)=>{i.d(t,{V:()=>b});var n=i(8520);if(2063!=i.j)var s=i(99614);if(2063!=i.j)var o=i(98970);if(2063!=i.j)var r=i(86999);if(2063!=i.j)var a=i(41519);if(2063!=i.j)var l=i(56252);if(2063!=i.j)var d=i(30805);if(2063!=i.j)var c=i(21763);if(2063!=i.j)var u=i(27543);if(2063!=i.j)var h=i(92433);if(2063!=i.j)var g=i(85339);if(2063!=i.j)var p=i(62617);if(2063!=i.j)var m=i(27523);if(2063!=i.j)var f=i(96686);if(2063!=i.j)var v=i(84801);if(2063!=i.j)var _=i(73758);if(2063!=i.j)var y=i(85096);if(2063!=i.j)var I=i(36427);function C(e,t,i){var n;return i?i.message:null!==(n=null==e?void 0:e.customizedEmptyECCSuggestionsString)&&void 0!==n?n:t("suggestionsGroupNoSuggestionsText")}function S(e,t,i,n){const s={clearSearchLabel:t("clearSearchLabel"),showAvailableSuggestionsLabel:t("showAvailableSuggestionsLabel"),somethingWentWrongLabel:t("somethingWentWrongLabel"),tryAgainLabel:t("tryAgainLabel"),suggestionsGroupSearchResultAccessibilityLabel:t("suggestionsGroupSearchResultAccessibilityLabel"),combineSentences:t("combineSentences"),newTagText:t("newTagText"),discoveryPromoFooterText:t("discoveryPromoFooterText"),emailSentBy:t("emailSentBy"),feedbackText:t("feedbackText"),meetingSeries:t("meetingSeries"),recordText:t("recordText"),tabAriaLabel:t("allTabAriaLabel"),overflowTabAriaLabel:t("overflowTabAriaLabel"),expandedInlineSuggestionsSearchBarPlaceholder:t("expandedInlineSuggestionsSearchBarPlaceholder"),startTypingToSearch:t("startTypingToSearch")},o={ignoreAll:i("ebx_ignoreAllButtonLabel"),ignoreOnce:i("ebx_ignoreOnceButtonLabel"),ignoreRule:i("ebx_disableCritiqueButton"),options:i("ebx_changeSettingsCommandLabel"),giveFeedbackButtonText:i("ebx_giveFeedback"),editorButtonTooltipContent:i("ebx_settingsButtonTooltip"),editorButtonText:i("editorButtonText"),footerSeeMoreActionsAccessibilityLabel:i("ebx_moreButtonArialLabel")},r={suggestionsGroupNoSuggestionsText:C(e,t,n)};return Object.assign(Object.assign({},function(){const e=Array(),t={};for(const i of e)t[i]=e=>"";return t}()),{inlineSuggestions:e=>s[e]||"",common:e=>r[e]||"",critique:e=>o[e]||""})}const b=e=>{var t,i,_,C,b,E,N,x,w,L,D,F,A,R,q,P,O,k;const z=n.useContext(f.O),{calloutProps:M,layerHostId:j,isRtl:W,styles:B}=e,{calloutStrings:U,currentScope:H,enableExpandedECC:V,enableScopedHeader:G,expandedEccSearchBarConfig:Q,getLocale:K,expandedECCHeader:$,inlineSuggestionsStrings:J,isDividerShown:Z,isFeedbackEnabled:Y,isFeedbackButtonEnabled:X,onFeedbackButtonClicked:ee,isFlightEnabled:te,isLoading:ie,oaSettings:ne,onGroupSelected:se,onItemSelected:oe,onProcessedResults:re,onUserInteraction:ae,resultReset:le,suggestions:de,style:ce,theme:ue,handleKeyDown:he,triggerMethod:ge,appGptConfig:pe,unsupportedEntities:me,removeComposingBoxQuery:fe}=M,ve=M.searchBoxQueryString.length>0?M.searchBoxQueryString:M.queryString,_e=null==me?void 0:me.find((e=>e.entityType===(null==H?void 0:H.entityType))),ye=null===(t=null==ne?void 0:ne.bestMatchConfig)||void 0===t?void 0:t.enabled,Ie=null==ne?void 0:ne.enablePrefixHighlighting,Ce=new Map,Se=n.useRef([]),be=[],Te=n.useRef($),[Ee,Ne]=n.useState(null);V&&(Te.current=Te.current.map((e=>{var t,i,n;return Object.assign(Object.assign({},e),{isSelected:!(null==H?void 0:H.entityType)&&!(null===(t=e.scopeInfo)||void 0===t?void 0:t.entityType)||(null==H?void 0:H.entityType)===(null===(i=e.scopeInfo)||void 0===i?void 0:i.entityType)||!H&&e.isSelected&&1===(null===(n=null==ne?void 0:ne.entitiesEnabled)||void 0===n?void 0:n.length)})})),Te.current.length&&!Te.current.some((e=>e.isSelected))&&(Te.current=[Object.assign(Object.assign({},Te.current[0]),{isSelected:!0}),...Te.current.slice(1)]));let xe=!1;if(!ie){const e=de.slice().sort(((e,t)=>{var i,n;return(null!==(i=e.priority)&&void 0!==i?i:0)-(null!==(n=t.priority)&&void 0!==n?n:0)}));let t;for(const n of e)for(const[,o]of n.entities.entries()){xe=xe||o.entityType===s.c.PIM;const r=ye&&o.isBestMatch,a=r?"":null!==(i=n.groupTitle)&&void 0!==i?i:o.entityType===s.c.PIM?(0,c.X)(o.type,o.IntentId):(0,c.X)(o.type);if(o.icon&&(o.icon.iconName=(0,u.S)(o.icon.iconName)),o.entityType===s.c.People&&T(o,W),o.entityType===s.c.Scope&&(null===(_=o.scopeInfo)||void 0===_?void 0:_.entityType)&&o.scopeInfo.entityType!==s.c.External&&(o.title=(0,c.X)(o.scopeInfo.entityType)),Ie&&!o.hitHighlightIndexes){const e=o[null!==(C=o.titleHitHighlightProperty)&&void 0!==C?C:"title"],t=o[null!==(b=o.subtitleHitHighlightProperty)&&void 0!==b?b:"subtitle"];o.hitHighlightIndexes=(0,h.J)([ve],e,"title").concat(t?(0,h.J)([ve],t,"subTitle"):[])}let l=Ce.get(a);if(!l)if(l=Object.assign(Object.assign(Object.assign({title:a,subtitle:n.groupSubtitle,suggestions:[]},(null==H?void 0:H.entityType)===e[0].entityType&&{isScoped:!0}),o.entityType===s.c.Scope&&{isScopingEnabled:!1,showSeparator:!0}),Z&&{showSeparator:!0}),Ce.set(a,l),r)be.unshift(l);else if(n.entityType===s.c.Scope)t=l;else{if(H&&H.entityType!==n.entityType)continue;if(!H&&(null==me?void 0:me.some((e=>e.entityType===n.entityType))))continue;be.push(l)}l.suggestions.push(o)}if(t&&be.push(t),null==ne?void 0:ne.preventAllTabBackfill){const e=!H,t=(null===(E=be[0])||void 0===E?void 0:E.suggestions.length)>0;V&&e&&t&&be.splice(1)}if(null==ne?void 0:ne.gptResultsLengthCap){"App"===(null===(N=be[0])||void 0===N?void 0:N.title)&&(null===(x=be[0])||void 0===x||x.suggestions.splice(ne.gptResultsLengthCap))}be.length&&(be[0].showSeparator=!1),re()}const we=n.useCallback((()=>{ae()}),[ae]),Le=n.useCallback((e=>{if(Ee){if(Q&&ge!==g.P.AttachFile&&ge!==g.P.Fre){const t=Ee.querySelectorAll("input[type=search]")[0];0===(null==t?void 0:t.value.length)&&e.target===t&&setTimeout((()=>{t.value=ve||""}),100)}if(!V&&(0,p.m)(e.target)&&"BUTTON"!==e.target.nodeName&&"INPUT"!==e.target.nodeName){e.preventDefault();const t=e.relatedTarget;null==t||t.focus()}}}),[Ee,V,Q,ve,ge]),[De,Fe]=n.useState(!1),[Ae,Re]=n.useState(!1),qe=n.useRef(!0);n.useEffect((()=>{if(!Ee)return;const e=Ee.ownerDocument,t=Ee.querySelectorAll("input[type=search]")[0],i=e.querySelectorAll('[data-ms-editor="true"]')[0];Q&&t&&(ge===g.P.AttachFile||i&&e.activeElement===i)&&qe.current&&(qe.current=!1,ge===g.P.AttachFile||ge===g.P.Fre?null==fe||fe(""!==ve):t.setAttribute("placeholder",""!==ve?ve:J("expandedInlineSuggestionsSearchBarPlaceholder")))}),[Ee,Q,J,ve,fe,ge]),n.useEffect((()=>{var e;if(!Ee)return;const t=null!==(e=Ee.ownerDocument.defaultView)&&void 0!==e?e:window;function i(){Fe(t.matchMedia("(max-width: 480px)").matches),Re(t.matchMedia("(max-height: 480px)").matches)}i();const n=new o.J(t);n.addListener("resize",i);const s=Ee.closest(".ms-ecc-callout"),r=s&&new o.J(s);return null==r||r.addListener("keydown",he),()=>{n.removeAllListeners(),null==r||r.removeAllListeners()}}),[Ee,he]);const Pe=te("mc-editor-expanded-ecc-responsive"),Oe=te("mc-editor-enable-meeting-banner");(le||!ie||be.length)&&(Se.current=G?(0,I.k)(be):be);const ke=J("managePersonalInfoLinkText"),ze=J("managePersonalInfoLinkUrl"),Me=J("meetingBannerText"),je=null!==(w=null==K?void 0:K())&&void 0!==w?w:"en-US",We={results:Se.current,queryString:ve,onItemSelected:oe,onGroupSelected:se,theme:ue,style:ce,styles:B,isError:M.isError,strings:S(ne,J,U,_e),onAction:M.onAction,isLoading:M.isLoading,keyboardHandlerTarget:V?void 0:M.keyboardHandlerTarget,expandedKeyboardHandlerTarget:V?M.keyboardHandlerTarget:void 0,menuType:M.menuType,onFooterAction:M.onFooterAction,enablePrefixHighlighting:Ie,showMoreEntitiesConfig:M.showMoreEntitiesConfig,browseThisComputerConfig:M.browseThisComputerConfig,layerHostId:j,showDiscoveryPromoFooter:null==ne?void 0:ne.enableDiscoveryPromoFooter,noSuggestionsHeaderInfo:M.noSuggestionsHeaderInfo,locale:je,appGptConfig:pe,enableMeetingBanner:Oe,showMeetingBanner:Oe&&(null==H?void 0:H.entityType)===s.c.Event,meetingBannerText:Me,isUnsupported:!!_e},Be=n.useMemo((()=>(0,v.jI)()?"rtl":"ltr"),[]),Ue=(0,y.Z)(M.menuParentElement,null!==(L=M.enableExpandedECC)&&void 0!==L&&L,M.accessibilitySettings);return n.createElement("div",{ref:Ne,onMouseEnter:we,onFocus:Le},V?n.createElement(l.q,{theme:M.fluentTheme,dir:Be},n.createElement(r._,Object.assign({},We,{scopes:{title:"",isScopingEnabled:!1,suggestions:Te.current},useFURNTabList:z,onItemFocused:Ue,disableTooltips:!0,isFeedbackEnabledForEcc:Y,isFeedbackButtonEnabled:X,onFeedbackButtonClicked:ee,enableResponsiveLayout:Pe,isSmallWindow:Pe&&De,isSmallHeight:Pe&&Ae,expandedEccSearchBarConfig:Q}))):n.createElement(a.x,Object.assign({},We,{onFocus:Ue,enableScopedHeader:G,disableTooltips:null==ne?void 0:ne.disableInlineSuggestionTooltips})),xe?n.createElement("div",{style:{height:"32px",padding:"4px 12px"}},n.createElement("a",{href:ze,target:"_blank",rel:"noreferrer","aria-label":ke,style:{textDecoration:"unset",color:"#0078D4",fontSize:12,lineHeight:"16px"}},ke)):null,n.createElement(d.b,{target:m.Y.inlineSuggestions,styles:{container:{borderRadius:{topStart:0,topEnd:0,bottomStart:null!==(F=null===(D=null==B?void 0:B.containerStyles)||void 0===D?void 0:D.borderRadius)&&void 0!==F?F:8,bottomEnd:null!==(R=null===(A=null==B?void 0:B.containerStyles)||void 0===A?void 0:A.borderRadius)&&void 0!==R?R:8},minWidth:null!==(P=null===(q=null==B?void 0:B.containerStyles)||void 0===q?void 0:q.minWidth)&&void 0!==P?P:300,maxWidth:null!==(k=null===(O=null==B?void 0:B.containerStyles)||void 0===O?void 0:O.maxWidth)&&void 0!==k?k:420}}}))};function T(e,t){e.initials=(0,_.I)(e.displayName,t)}},9539:(e,t,i)=>{i.d(t,{b:()=>h});var n=i(26598),s=i(30833),o=i(11804),r=i(14775),a=i(85339);if(2063!=i.j)var l=i(20710);if(2063!=i.j)var d=i(96686);var c=i(8520);const u=(0,n.F5)({hostSettings:s.A.on(o.n),inlineSuggestionsRenderer:s.A.on(a.V),languageScriptDirectionDetector:s.A.on(r.iw).optional()}),h=()=>{var e,t,i,s,o;const{hostSettings:r,inlineSuggestionsRenderer:a,languageScriptDirectionDetector:h}=(0,n.KN)(u),[g,p]=c.useState(null!==(e=a.getCalloutStateStore().getCalloutState())&&void 0!==e?e:null);return c.useEffect((()=>{const e=a.getCalloutStateStore(),t=()=>{var t;p(null!==(t=e.getCalloutState())&&void 0!==t?t:null)};return e.subscribe("menuUpdated",t),()=>{e.unsubscribe("menuUpdated",t)}}),[a]),(null==g?void 0:g.targetLocation)?c.createElement(d.b.Provider,{value:!!r.useUiCoherence},c.createElement(l.$,Object.assign({},g,{isRtl:null!==(t=null==h?void 0:h.isRtl())&&void 0!==t&&t,isMobile:null!==(o=null===(s=null===(i=r.oaSettings)||void 0===i?void 0:i.enableECCForMobileDevice)||void 0===s?void 0:s.enabled)&&void 0!==o&&o}))):null}},20710:(e,t,i)=>{if(i.d(t,{$:()=>g}),2063!=i.j)var n=i(79490);var s=i(8520);if(2063!=i.j)var o=i(17806);if(2063!=i.j)var r=i(70547);if(2063!=i.j)var a=i(24896);if(2063!=i.j)var l=i(921);if(2063!=i.j)var d=i(63088);var c=i(87414);if(2063!=i.j)var u=i(96686);if(2063!=i.j)var h=i(18640);const g=e=>{var t,i,g,p,m,f,v,_,y,I,C,S,b,T,E,N,x;const w=s.useContext(c.O1),L=s.useContext(u.b),{maxHeightCallback:D,targetLocation:F,isMobile:A}=e,{isLoading:R,isFlightEnabled:q,onDismissed:P,onFirstRender:O,onPreventDismissOnEvent:k,onRenderResults:z,onRestoreFocus:M,style:j,styles:W,theme:B}=e.calloutProps;let U=!0;const[H,V]=s.useState(!0);s.useEffect((()=>{O()}),[O]),s.useEffect((()=>{R||z()}),[R,z]);const G=s.useCallback((e=>{e&&"key"in e&&l.x.isKey(e,d.m.escape)&&(e.preventDefault(),e.stopPropagation()),e&&"focus"===e.type&&(U=!1),P(!1)}),[P]),Q=s.useCallback((e=>{if(!U)return;M(e,(()=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()}))}),[M,U]),K=W||{},{calloutStyles:$}=K,J=(0,n.__rest)(K,["calloutStyles"]),Z=J.containerStyles||{},Y=q("mc-editor-expanded-ecc-responsive"),X=null!==(p=null!==(i=null===(t=null==W?void 0:W.calloutStyles)||void 0===t?void 0:t.borderRadius)&&void 0!==i?i:null===(g=null==B?void 0:B.callout)||void 0===g?void 0:g.borderRadius)&&void 0!==p?p:L?12:8;if(!e.targetLocation)return null;const ee=null==D?void 0:D(e.targetLocation,null!==(m=e.targetWindow.deref())&&void 0!==m?m:window),te=null===(f=e.directionalHintCallback)||void 0===f?void 0:f.call(e,e.targetLocation,null!==(v=e.targetWindow.deref())&&void 0!==v?v:window,ee);let ie,ne="absolute";if(A&&(ne="fixed",ie=!0),w){const t=Y?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(b=null==B?void 0:B.callout)||void 0===b?void 0:b.width},$),i={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!1,withArrow:null!==(E=null===(T=null==B?void 0:B.callout)||void 0===T?void 0:T.isBeakVisible)&&void 0!==E&&E,open:H,onOpenChange:(e,t)=>{!t.open&&(null==k?void 0:k(e))||(V(t.open),t.open||G())},positioning:Object.assign(Object.assign({},(0,h.Sg)(te)),{target:(0,h.ug)(F),strategy:ne,autoSize:ie})},surface:{className:"ms-ecc-callout",style:Object.assign({padding:0,maxWidth:480,maxHeight:ee,overflow:"hidden",border:null===(N=null==B?void 0:B.callout)||void 0===N?void 0:N.border,boxShadow:null===(x=null==B?void 0:B.callout)||void 0===x?void 0:x.shadow},t)}};return s.createElement(r.v,Object.assign({},i),s.createElement(a.V,{calloutProps:e.calloutProps,isRtl:e.isRtl,styles:(null==j?void 0:j.fitToContent)||Z.maxHeight?Object.assign(Object.assign({},J),{containerStyles:Object.assign(Object.assign({},Z),{maxHeight:ee})}):J}))}return s.createElement(o.U,{className:"ms-ecc-callout",target:(0,h.KV)(F),shouldDismissOnWindowFocus:!1,onDismiss:G,preventDismissOnEvent:k,gapSpace:0,doNotLayer:!1,isBeakVisible:null!==(y=null===(_=null==B?void 0:B.callout)||void 0===_?void 0:_.isBeakVisible)&&void 0!==y&&y,directionalHint:te,alignTargetEdge:!0,onRestoreFocus:Q,calloutMaxHeight:ee,style:Y?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(I=null==B?void 0:B.callout)||void 0===I?void 0:I.width},$),styles:{beakCurtain:{borderRadius:X},calloutMain:{overflow:"hidden",border:null===(C=null==B?void 0:B.callout)||void 0===C?void 0:C.border,borderRadius:X,boxShadow:null===(S=null==B?void 0:B.callout)||void 0===S?void 0:S.shadow},root:{borderRadius:X,width:"fit-content",maxHeight:"none !important"}}},s.createElement(o.d.Consumer,null,(t=>s.createElement(a.V,{calloutProps:e.calloutProps,isRtl:e.isRtl,styles:(null==j?void 0:j.fitToContent)||Z.maxHeight?Object.assign(Object.assign({},J),{containerStyles:Object.assign(Object.assign({},Z),{maxHeight:ee})}):J,layerHostId:t}))))}},85096:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(8520);if(2063!=i.j)var s=i(99614);if(2063!=i.j)var o=i(52041);if(2063!=i.j)var r=i(1527);const a=(e,t,i)=>{const a=n.useRef(),l=n.useRef(),d=n.useRef(new o.c({enableClearingOfRequestedAnimationFrames:!0})),c=n.useCallback((()=>{a.current&&(a.current.remove(),a.current=void 0),l.current?(l.current.removeAttribute("aria-activedescendant"),l.current.removeAttribute("aria-controls"),l.current.removeAttribute("aria-owns"),l.current=void 0):(null==e||e.removeAttribute("aria-activedescendant"),null==e||e.removeAttribute("aria-controls"),null==e||e.removeAttribute("aria-owns"))}),[e]),u=n.useCallback(((e,t)=>{d.current.requestAnimationFrame((()=>{var n,s;const o=e.getRootNode(),l=e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`);if(!(null==l?void 0:l.ariaLabel)||!(0,r.C)(o,"ShadowRoot"))return;if(null==i?void 0:i.enableExpandedECCAccessibilityElement){if(a.current)a.current.removeAttribute("aria-label"),a.current.removeAttribute("role");else{a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listBox");const t=e.ownerDocument.querySelector("#inlineSuggestionsEnclosingDiv");a.current.setAttribute("aria-label",(null==t?void 0:t.getAttribute("aria-label"))||"")}a.current.style.cssText="width: 0; height: 0; overflow: hidden;"}a.current||(a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listbox"),a.current.style.cssText="width: 0; height: 0; overflow: hidden;");const d=e.ownerDocument.createElement("button");(null==i?void 0:i.enableExpandedECCAccessibilityElement)?(d.setAttribute("role",l.getAttribute("role")||"option"),d.setAttribute("type",l.getAttribute("type")||"button"),d.id=t.focusedItemHtmlId,d.innerText=l.ariaLabel,d.ariaLabel=l.ariaLabel,l.id.includes("header")||l.id.includes("overflow")?(a.current.setAttribute("aria-label","tablist"),d.ariaPosInSet=String(Number(l.id.substring(l.id.length-1,l.id.length))+1),d.ariaSetSize=String(null===(s=null===(n=l.parentElement)||void 0===n?void 0:n.parentElement)||void 0===s?void 0:s.children.length),d.ariaSelected=l.getAttribute("aria-selected")):(d.ariaPosInSet=l.ariaPosInSet,d.ariaSetSize=l.ariaSetSize,d.ariaSelected="true")):(d.setAttribute("role","option"),d.setAttribute("type","button"),d.id=t.focusedItemHtmlId,d.innerText=l.ariaLabel,d.ariaLabel=l.ariaLabel,d.ariaPosInSet=l.ariaPosInSet,d.ariaSetSize=l.ariaSetSize,d.ariaSelected="true"),a.current.children.length&&a.current.children[0].remove(),a.current.appendChild(d),o.appendChild(a.current)}))}),[null==i?void 0:i.enableExpandedECCAccessibilityElement]),h=n.useCallback((t=>{d.current.requestAnimationFrame((()=>{var i;const n=null==e?void 0:e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`),o=(null===(i=t.selection)||void 0===i?void 0:i.type)===s.c.Scope.toLowerCase();n&&o&&(t.selection&&"scope"in t.selection&&t.selection.scope.isSelected?n.ariaSelected="true":n.ariaSelected="false")}))}),[e]),g=n.useCallback((n=>{if(n.focusedItemHtmlId){if(!e)return;t&&h(n),(null==i?void 0:i.enableDetachedAccessibilityElementForEcc)&&u(e,n),e.setAttribute("aria-activedescendant",n.focusedItemHtmlId),e.setAttribute("aria-controls",n.focusedItemHtmlId),e.setAttribute("aria-owns",n.focusedItemHtmlId),l.current=e}else c()}),[i,t,u,h,e,c]);return n.useEffect((()=>()=>{c()}),[c]),g}},35737:(e,t,i)=>{if(i.d(t,{B:()=>l}),2063!=i.j)var n=i(60152);if(2063!=i.j)var s=i(27523);if(2063!=i.j)var o=i(79535);if(2063!=i.j)var r=i(91528);if(2063!=i.j)var a=i(51152);class l{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918212)}configureRootServices(e){e.bind(s.D).to(n.o),e.bind(o.j).to(r.S)}}},84692:(e,t,i)=>{if(i.d(t,{Q:()=>l}),2063!=i.j)var n=i(30076);if(2063!=i.j)var s=i(9539);if(2063!=i.j)var o=i(18557);if(2063!=i.j)var r=i(76668);if(2063!=i.j)var a=i(51152);class l{constructor(){this.imports=[o.N,r.h]}get uniqueId(){return(0,a.z)(507918216)}configureRootServices(e){e.bind(n.i).toValue(s.b)}}},66932:(e,t,i)=>{if(i.d(t,{B:()=>u}),2063!=i.j)var n=i(91264);if(2063!=i.j)var s=i(27745);if(2063!=i.j)var o=i(75982);if(2063!=i.j)var r=i(74261);if(2063!=i.j)var a=i(51152);if(2063!=i.j)var l=i(97446);if(2063!=i.j)var d=i(4891);if(2063!=i.j)var c=i(69992);class u{constructor(){this.imports=[s.d,n.w]}get uniqueId(){return(0,a.z)(507918222)}configureRootServices(e){e.bind(o.Y).toSelf(),e.bind(l.S).toExisting(o.Y),e.bind(r.o).to(r.X),e.bind(d.q).to(c.L),e.bind(l.S).toExisting(d.q)}}},92325:(e,t,i)=>{i.d(t,{R:()=>u});var n=i(26598),s=i(30833),o=i(79535),r=i(36015),a=i(96571);if(2063!=i.j)var l=i(65450);var d=i(8520);const c=(0,n.F5)({multilingualStore:s.A.on(o.j),critiqueCalloutStateStore:s.A.on(r.v),localizer:s.A.on(a.H)}),u=e=>{var t;const{theme:i,style:s}=e,{critiqueCalloutStateStore:o,multilingualStore:r,localizer:a}=(0,n.KN)(c);return d.createElement("div",{style:Object.assign({color:null!==(t=null==i?void 0:i.textColor)&&void 0!==t?t:"#323130"},s)},d.createElement("div",{style:{marginBottom:8}},d.createElement("b",null,a.getMessage("multilingualFRE_HeadingText"))),a.getMessage("multilingualFRE_DescriptionText")," ",d.createElement("br",null),d.createElement(l.N,{style:{fontSize:12},onClick:()=>{o.hide(),r.showEditorSettings()},"aria-label":a.getMessage("multilingualFRE_DescriptionButtonLinkAriaLabel"),"data-is-focusable":!0},a.getMessage("multilingualFRE_DescriptionButtonLink")))}},91528:(e,t,i)=>{i.d(t,{S:()=>c});var n=i(79490),s=i(8520),o=i(27523),r=i(92325),a=i(29906),l=i(83010);const d="multilingualProofingFre";let c=class{constructor(e){this.footerFreStore=e}addMultilingualProofingFre(){this.footerFreStore.addFooterPage(o.Y.critique,d,{icon:"LocaleLanguage",content:(e,t)=>s.createElement(r.R,{style:e,theme:t})})}removeMultilingualProofingFre(){this.footerFreStore.removeFooterPage(o.Y.critique,d)}setOnShowEditorSettings(e){this._onShowEditorSettings=e}showEditorSettings(){this._onShowEditorSettings&&this._onShowEditorSettings(!0)}};c=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(o.D))],c)},94219:(e,t,i)=>{i.d(t,{a:()=>y});var n=i(8520),s=i(26598),o=i(30833);if(2063!=i.j)var r=i(18309);if(2063!=i.j)var a=i(27543);if(2063!=i.j)var l=i(17806);if(2063!=i.j)var d=i(70547);if(2063!=i.j)var c=i(98970);if(2063!=i.j)var u=i(18640);var h=i(87414);if(2063!=i.j)var g=i(70527);if(2063!=i.j)var p=i(921);if(2063!=i.j)var m=i(63088);if(2063!=i.j)var f=i(80617);const v=5e3,_=(0,s.F5)({styleStore:o.A.on(h.UC).optional(),themeStore:o.A.on(h.YQ).optional()}),y=e=>{var t,i,o,y,I,C,S,b,T,E,N;const x=n.useContext(h.O1),{styleStore:w,themeStore:L}=(0,s.KN)(_),{nudge:D,nudgeDisplayLocation:F,nudgeTargetDocumentRef:A,onAcceptNudgeAction:R,onHideNudge:q,inlineNudge:P,insertionCharacter:O}=e,k=null!==(i=null===(t=A.deref())||void 0===t?void 0:t.defaultView)&&void 0!==i?i:window,[z,M]=n.useState(null==L?void 0:L.getComponentActiveTheme(P?h.yF.inlineNudgeBubbleComponentName:h.yF.nudgeBubbleComponentName));n.useEffect((()=>{if(!L)return()=>{};const e=()=>{M(L.getComponentActiveTheme(P?h.yF.inlineNudgeBubbleComponentName:h.yF.nudgeBubbleComponentName))};return L.subscribe("currentThemeUpdated",e),L.subscribe("defaultThemeUpdated",e),L.subscribe("themesUpdated",e),()=>{L.unsubscribe("currentThemeUpdated",e),L.unsubscribe("defaultThemeUpdated",e),L.unsubscribe("themesUpdated",e)}}),[P,L]);const[j,W]=n.useState(!1),[B,U]=n.useState(!0),H=n.useRef(void 0),V=n.useCallback((e=>{k.clearTimeout(H.current),H.current=e}),[k]),G=n.useCallback(((e,t)=>{k.clearTimeout(H.current),q(e,t)}),[q,k]),Q=n.useCallback((()=>{k.clearTimeout(H.current),W(!0)}),[W,k]),K=n.useCallback((()=>{V(k.setTimeout((()=>{G("timeout 5000")}),v)),W(!1)}),[G,V,k]),$=n.useCallback((()=>R("click",!0)),[R]);n.useEffect((()=>(V(k.setTimeout((()=>{G("timeout 5000")}),v)),()=>{k.clearTimeout(H.current)})),[]);const J=n.useCallback((e=>{p.x.isKey(e,m.m.escape)?(e.stopPropagation(),e.preventDefault(),G(e.key)):p.x.isKey(e,m.m.enter)||p.x.isKey(e,m.m.backspace)?G(e.key):p.x.isKey(e,"v",void 0,!0)?G("user pasted text",!0):(p.x.isKey(e,m.m.tab)||e.key===O)&&(e.stopPropagation(),e.preventDefault(),R(e.key,!0))}),[G,O,R]),Z=n.useCallback((()=>{G("MouseDown")}),[G]),Y=n.useCallback((()=>{G("Scroll")}),[G]),X=n.useCallback((()=>{G("Resize")}),[G]);n.useEffect((()=>{const e=new c.J(A),t=new c.J(k);return e.addListener("keydown",J,{capture:!0}),e.addListener("mouseup",Z),t.addListener("resize",X),t.addListener("scroll",Y,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[J,Z,Y,X,A,k]);const ee=null==w?void 0:w.getComponentStyle(P?h.yF.inlineNudgeBubbleComponentName:h.yF.nudgeBubbleComponentName),te=x?function(e){return e?{background:{resting:f.L.colorNeutralBackground5,hover:f.L.colorNeutralBackground5Hover},text:{resting:f.L.colorNeutralForeground3}}:{background:{resting:f.L.colorNeutralBackground1,hover:f.L.colorNeutralBackground1Hover},text:{resting:f.L.colorNeutralForeground1},highlight:{text:{resting:f.L.colorNeutralForeground1},background:{resting:f.L.colorNeutralBackground3,hover:f.L.colorNeutralBackground3Hover}}}}(P):z,ie=D.entityResults?(0,a.S)(null!==(y=null===(o=D.entityResults.entities[0].icon)||void 0===o?void 0:o.iconName)&&void 0!==y?y:""):void 0,ne=null!==(I=null==ee?void 0:ee.borderRadius)&&void 0!==I?I:P?4:15,se=null!==(C=null==ee?void 0:ee.fontSize)&&void 0!==C?C:"10pt",oe=null==ee?void 0:ee.fontWeight,re=null!==(S=null==ee?void 0:ee.paddingTop)&&void 0!==S?S:2,ae=null!==(b=null==ee?void 0:ee.paddingBottom)&&void 0!==b?b:2,le=null!==(T=null==ee?void 0:ee.paddingLeftRight)&&void 0!==T?T:8,de=null==ee?void 0:ee.lineHeight,ce=P?r.A.rightTopEdge:r.A.bottomCenter,ue=P?"none":null==ee?void 0:ee.boxShadow,he=D.text.split(/(@|\/)/g),ge=P?{align:"center",position:"after",offset:e=>({mainAxis:1})}:{align:"center",position:"below",offset:e=>({mainAxis:8})},pe=n.createElement("div",{style:{borderRadius:ne,display:"flex",cursor:"pointer"}},ie?n.createElement("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8}},n.createElement(g.In,{type:ie,style:{width:void 0,height:void 0},primaryColor:j&&null!==(E=null==te?void 0:te.text.hover)&&void 0!==E?E:null==te?void 0:te.text.resting,fontSize:void 0})):void 0,n.createElement("span",{className:"ms-nudge-text",style:{color:j&&null!==(N=null==te?void 0:te.text.hover)&&void 0!==N?N:null==te?void 0:te.text.resting,fontSize:se,fontWeight:oe,paddingTop:re,paddingBottom:ae,paddingLeft:le,paddingRight:le,textDecoration:"none",userSelect:"none",lineHeight:de}},he.map((e=>{var t,i,s,o;return"@"===e||"/"===e?n.createElement("span",{key:e,style:Object.assign({backgroundColor:(null==te?void 0:te.highlight)?j?te.highlight.background.hover:te.highlight.background.resting:j&&null!==(t=null==te?void 0:te.background.hover)&&void 0!==t?t:null==te?void 0:te.background.resting,color:(null==te?void 0:te.highlight)?j?te.highlight.text.hover:te.highlight.text.resting:j&&null!==(i=null==te?void 0:te.text.hover)&&void 0!==i?i:null==te?void 0:te.text.resting,paddingLeft:null===(s=null==ee?void 0:ee.highlightStyle)||void 0===s?void 0:s.paddingLeftRight,paddingRight:null===(o=null==ee?void 0:ee.highlightStyle)||void 0===o?void 0:o.paddingLeftRight},null==ee?void 0:ee.highlightStyle)},e):n.createElement("span",{key:e},e)}))));if(x||P){const e={popover:{trapFocus:!0,withArrow:!1,open:B,onOpenChange:(e,t)=>{U(t.open)},positioning:Object.assign({target:(0,u.ug)(F)},ge)},surface:{className:"ms-ecc-callout",style:{padding:0,overflowY:"hidden",borderRadius:ne,backgroundColor:j?null==te?void 0:te.background.hover:null==te?void 0:te.background.resting,boxShadow:ue,cursor:"pointer"}}};return n.createElement("div",{role:"button",tabIndex:-1,onMouseOver:Q,onMouseLeave:K,onMouseUp:$,onFocus:Q,onBlur:K},n.createElement(d.v,Object.assign({},e),pe))}return n.createElement(l.U,{target:F,directionalHint:ce,isBeakVisible:!1,gapSpace:8,onMouseOver:Q,onMouseLeave:K,onMouseUp:$,style:{overflowY:"hidden"},styles:{root:{borderRadius:ne,boxShadow:ue,cursor:"pointer"},calloutMain:{borderRadius:ne,backgroundColor:j?null==te?void 0:te.background.hover:null==te?void 0:te.background.resting}}},pe)}},76213:(e,t,i)=>{i.d(t,{_:()=>d});var n=i(26598),s=i(30833),o=i(75542);if(2063!=i.j)var r=i(94219);var a=i(8520);const l=(0,n.F5)({nudgeStateStore:s.A.on(o.V)}),d=()=>{const{nudgeStateStore:e}=(0,n.KN)(l),[t,i]=a.useState(e);a.useEffect((()=>(e.subscribe("stateUpdated",i),()=>{e.unsubscribe("stateUpdated",i)})),[e]);const{nudge:s,nudgeDisplayLocation:o,nudgeTargetDocumentRef:d}=t;return s&&o&&d?a.createElement(r.a,{nudge:s,inlineNudge:e.enableInlineNudge,insertionCharacter:e.insertionCharacter,nudgeTargetDocumentRef:d,nudgeDisplayLocation:o,onAcceptNudgeAction:(t,i)=>{e.onNudgeAccepted(t,i)},onHideNudge:(t,i)=>{e.onNudgeDismiss(t,i)}}):null}},10863:(e,t,i)=>{i.d(t,{I:()=>o});var n=i(44551),s=i(8520);const o=s.memo((e=>{const{children:t,predictionDisplayText:i,shouldShowInsertionHelperText:o,showDropdownChevron:r,localizer:a,isMobile:l,onTextMayOverlapLine:d,onDropdownOpened:c,leftPadding:u,parentElement:h,showIconWithMultipleComponents:g}=e,p=s.useRef(null),m=s.useRef(null),f=s.useCallback((()=>{r&&p.current&&c(p.current)}),[p,c,r]),v=s.useCallback((e=>{"Tab"===e.code&&r&&p.current&&c(p.current)}),[p,c,r]);s.useEffect((()=>{if(!m.current)return;let e=0;const t=m.current.getClientRects();1!==t.length&&(e+=t.length-1),d(e)}));const _=parseInt(window.getComputedStyle(h).fontSize,10);return s.createElement(s.Fragment,null,s.createElement("span",{className:"ms-entity-prediction-wrapper",style:{marginLeft:u?u+"px":void 0},ref:p,onClick:f,onKeyDown:v,role:"combobox"},"",(!r||g)&&s.createElement("span",{className:"ms-entity-prediction-icon"},t),s.createElement("span",{id:"textPrediction",className:"ms-entity-prediction",contentEditable:!1,ref:m},i),r?s.createElement("span",{className:"ms-entity-prediction-dropdown"},s.createElement(n.yuG,{style:{width:_-4,height:_-4}})):s.createElement(s.Fragment,null),""),o?s.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"",a.getMessage(l?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),""):s.createElement(s.Fragment,null))}))},25204:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(10863),s=i(70527),o=i(1818),r=i(8520);const a=r.memo((e=>{var t,i;const{prediction:a,parentElement:l}=e,d=parseInt(window.getComputedStyle(l).fontSize,10),c=null!==(i=null===(t=a.entityResults.entities[0].FileExtension)||void 0===t?void 0:t.toLocaleLowerCase())&&void 0!==i?i:"",u=Object.prototype.hasOwnProperty.call(o.L,c)?o.L[c].iconType:"Cloud";return r.createElement(n.I,Object.assign({},e,{showDropdownChevron:a.entityResults.entities.length>1}),r.createElement(s.In,{type:u,style:{width:d,height:d},fontSize:d}))}))},10250:(e,t,i)=>{i.d(t,{R8:()=>a,Tc:()=>n,Vn:()=>o,XG:()=>r,r7:()=>s});const n=(0,i(76729).f)("IPredictionStateStore"),s=0,o=2063!=i.j?-1:null,r=2063!=i.j?-2:null;var a;!function(e){e[e.NotSeen=0]="NotSeen",e[e.TypeNotMatchingCharacter=1]="TypeNotMatchingCharacter",e[e.ExplicitRejection=2]="ExplicitRejection",e[e.ImplicitRejection=3]="ImplicitRejection"}(a||(a={}))},92120:(e,t,i)=>{i.d(t,{N:()=>a});var n=i(10863),s=i(70527),o=i(27543),r=i(8520);const a=r.memo((e=>{var t,i;const{prediction:a,parentElement:l}=e,d=parseInt(window.getComputedStyle(l).fontSize,10),c=(0,o.S)(null!==(i=null===(t=a.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"");return r.createElement(n.I,Object.assign({},e,{showDropdownChevron:a.entityResults.entities.length>1}),r.createElement(s.In,{type:null!=c?c:"Cloud",style:{width:d,height:d},fontSize:d}))}))},82747:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(10863),s=i(39064),o=i(8520);const r=o.memo((e=>{const{prediction:t,parentElement:i}=e,r=parseInt(window.getComputedStyle(i).fontSize,10);return o.createElement(n.I,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1,showIconWithMultipleComponents:!0}),o.createElement(s.c,{coinSize:r,text:"",imageUrl:t.entityResults.entities[0].imageUrl,imageInitials:t.entityResults.entities[0].imageInitials}))}))},27578:(e,t,i)=>{i.d(t,{X:()=>o});var n=i(10863),s=i(8520);const o=s.memo((e=>{const{prediction:t}=e;return s.createElement(n.I,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1}))}))},64462:(e,t,i)=>{if(i.d(t,{A:()=>s}),2063!=i.j)var n=i(80617);const s=e=>{var t,i,s,o,r,a,l;return`\n  .ms-text-prediction {\n    color: ${null==e?void 0:e.text};\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-ghost-text {\n    color: ${null!==(t=null==e?void 0:e.text)&&void 0!==t?t:n.L.colorNeutralForeground4};\n    position: relative;\n    user-select: none;\n    background: ${null!==(i=null==e?void 0:e.highlightColor)&&void 0!==i?i:n.L.colorNeutralBackground5};\n  }\n\n  .ms-entity-prediction {\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-entity-prediction-wrapper {\n    background: ${null!==(s=null==e?void 0:e.background.resting)&&void 0!==s?s:n.L.colorNeutralBackground3};\n    color: ${null!==(o=null==e?void 0:e.entityText.resting)&&void 0!==o?o:n.L.colorNeutralForeground4};\n    border-radius: 4px;\n    padding: 0px 4px;\n    gap: 4px;\n    user-select: none;\n    display: inline-flex;\n    pointer-events: all;\n    cursor: pointer;\n  }\n\n  .ms-entity-prediction-wrapper:hover {\n    background: ${null!==(r=null==e?void 0:e.background.hover)&&void 0!==r?r:n.L.colorNeutralBackground3Hover};\n    color: ${null==e?void 0:e.entityText.hover};\n  }\n\n  .ms-prediction-tab-hint {\n    align-content: center;\n    border-color: ${null!==(a=null==e?void 0:e.tabBorder)&&void 0!==a?a:null==e?void 0:e.text};\n    border-radius: 2px;\n    border-style: solid;\n    border-width: 1px;\n    box-sizing: border-box;\n    color: ${null!==(l=null==e?void 0:e.tabText)&&void 0!==l?l:n.L.colorNeutralForeground4};\n    display: inline-grid;\n    font-size: 0.630em;\n    height: 1.5em;\n    margin-left: 4px;\n    padding: 1px 4px;\n    position: relative;\n    vertical-align: 10%;\n    white-space: nowrap;\n    width: 2.5em;\n  }\n\n  .ms-entity-prediction-icon {\n    align-self: center\n  }\n\n  .ms-entity-prediction-dropdown {\n    align-self: center\n  }\n  `}},69076:(e,t,i)=>{i.d(t,{p:()=>f});var n=i(79490),s=i(99614),o=i(18104),r=i(71924),a=i(85924),l=i(76778),d=i(81628);var c=i(10250),u=i(69811),h=i(44233),g=i(59726),p=i(29906),m=i(94526);let f=class{constructor(e,t,i,n,l,d,h,p,m,f,v,_,y){this._localizer=e,this._hostSettings=t,this._logger=i,this._oaLogger=n,this._predictionStore=l,this._proofingDom=d,this._paragraphTextExtractor=h,this._tileContent=p,this._hostEmitter=m,this._userProfilePictureCache=f,this._inlineSuggestionsRenderer=v,this._nudgeStore=_,this._proofingEmitter=y,this._isActivelyAddingWrappingNewLines=!1,this._predictionUpdate=0,this._multiPredictionMenuOpen=!1,this.supportsPredictionType=e=>e===s.c.Text||e===s.c.PIM||e===s.c.Topic||this.isEntityPrediction(e),this.isEntityPrediction=e=>e===s.c.File||e===s.c.People||e===s.c.Loop||e===s.c.PIM,this.eccStateChanged=e=>{var t;e.messageType===o.G.RemoveData&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableZeroQueryHintText)&&this._predictionStore.clearPrediction()},this.getPredictionFirstItem=e=>e.entityResults&&e.entityResults.entities[0],this.onPredictionUpdatedInternal=async()=>{var e,t,i,n,s,o,r,a;const l=this._predictionStore.getCurrentPrediction();if(l){if(this.isPredictionDisabledForEntityType(null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions,l.entityType))return void await this._predictionStore.clearPrediction();if((null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.shouldRenderPrediction)&&!this._hostSettings.serviceSettings.predictions.shouldRenderPrediction(l))return void await this._predictionStore.clearPrediction();if(void 0!==(null===(n=this._inlineSuggestionsRenderer)||void 0===n?void 0:n.getCurrentMenuInfo())&&!l.isHelperText)return void(this._multiPredictionMenuOpen||(this._prediction?await this.clearCurrentPrediction(l,"ECC open",c.R8.ImplicitRejection):await this._predictionStore.clearPrediction()));if(this.isEntityPrediction(l.entityType)){if(!(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.predictions)||void 0===o?void 0:o.onInsertEntityPrediction)||!this._inlineSuggestionsRenderer)return void await this._predictionStore.clearPrediction();if(!await this.prepareEntityPredictions(l))return void await this._predictionStore.clearPrediction()}if((null===(r=this._prediction)||void 0===r?void 0:r.context)&&l.context&&l.context+l.text===this._prediction.context+this._prediction.text&&l.context.startsWith(this._prediction.context))return;(null===(a=this._nudgeStore)||void 0===a?void 0:a.getCurrentNudge())&&await this._nudgeStore.clearNudge()}await this.onPredictionUpdated()},this.prepareEntityPredictions=async e=>{var t,i,n;if(e.entityType===s.c.People){if(e.entityResults){if((null===(t=e.context)||void 0===t?void 0:t.endsWith(e.text))||(null===(i=e.context)||void 0===i?void 0:i.endsWith(e.text+" ")))return!1;for(const t of e.entityResults.entities)t.imageUrl=await(null===(n=this._userProfilePictureCache)||void 0===n?void 0:n.fetchProfilePicture((0,g.u)(t)))}}else e.shouldDismissOnTextChange=!0;return!0},this.checkIfEntityPredictionContextIsValid=(e,t,i)=>(e.entityType===s.c.People&&e.entityResults&&(t.endsWith(" ")||this.prepareEntityPredictionForTextUpdate(e,t)),!0),this.prepareEntityPredictionForTextUpdate=(e,t)=>{var i;if(e.entityType===s.c.People){if(null===(i=e.entityResults)||void 0===i?void 0:i.entities){const i=t.substring(e.startIndex);for(const t of e.entityResults.entities)if(t.text.startsWith(i)){e.text=t.text;break}}e.entityResults=void 0}},this.onEntityDropdownOpened=(e,t)=>{var i;if(!this._prediction)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no prediction was available");let n=[];const o=this._prediction.entityType;if(o===s.c.File)n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.File,text:e.FileName,isBestMatch:!1}))),entityType:this._prediction.entityType}];else if(o===s.c.People){const e=this._prediction;if(!e.entityResults)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no people prediction items were available");n=[{entities:e.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.People,text:e.DisplayName,isBestMatch:!1}))),entityType:this._prediction.entityType}]}else o===s.c.Loop?n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.Loop,text:e.text,isBestMatch:!1}))),entityType:this._prediction.entityType}]:o===s.c.PIM&&(n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.PIM,isBestMatch:!1}))),entityType:this._prediction.entityType}]);this._multiPredictionMenuOpen=!0,null===(i=this._inlineSuggestionsRenderer)||void 0===i||i.showEntityPrediction(this._prediction.tileId,this._prediction.startIndex,n,this.onApplyEntityPrediction,(()=>{this._multiPredictionMenuOpen=!1}),t.getBoundingClientRect())},this.onApplyEntityPrediction=e=>{this.applyCurrentPrediction(c.Vn,e)},this.handleTextTile=e=>{if(this._prediction&&e.message.messageType===o.G.RemoveData){const t=e.message.data.tileId;this._prediction.tileId!==t&&this._proofingDom.findParagraphNode(this._prediction.tileId)||this.clearCurrentPrediction(this._prediction,"tile removed",c.R8.ImplicitRejection)}},this.hostModelVisualStateChange=e=>{var t,i;const n=null!==(t=this._prediction)&&void 0!==t?t:this._predictionStore.getCurrentPrediction();if(n&&e.message.created){const t=this._proofingDom.findParagraphNode(n.tileId);if(t&&(n.tileId===e.message.tileId||(null===(i=t.parent)||void 0===i?void 0:i.id)===e.message.tileId)){const e=this._predictionUpdate+1;this._predictionUpdate=e,this.determineIfPredictionIsValidAndApply(n,e)}}},this.handleDelta=e=>{var t,i;const n=e.message;if(n.sourceType===r.pf.TileNode)return;if(this.checkForECCHintTextPrediction())return;if(this._isActivelyAddingWrappingNewLines)return;if(!n.delta||!this._prediction)return void(this.lastPredictedTile&&n.tileId!==this.lastPredictedTile.id&&(this.lastPredictedTile=void 0));if(n.delta.deltaType===u.WI.Add&&!n.delta.content)return;if(n.delta.deltaType===u.WI.Update&&!n.delta.content&&!n.delta.length)return;if(n.delta.deltaType===u.WI.Update&&(n.delta.unit===u.OD.Sentence||n.delta.unit===u.OD.Paragraph)&&"\n"===n.delta.content&&0===n.delta.position)return;if((n.delta.unit===u.OD.Sentence||n.delta.unit===u.OD.Paragraph)&&(n.delta.deltaType===u.WI.Add||n.delta.deltaType===u.WI.Update)&&(null!==(i=null===(t=n.delta.content)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>1)return;const s=this._predictionUpdate+1;this._predictionUpdate=s,this.determineIfPredictionIsValidAndApply(this._prediction,s,this._predictionDisplayText,n.tileId,n.changeType,n.delta,n.deletedOrReplacedCharacters)},this.trimLineEnding=e=>e&&"\n"===e[e.length-1]?e.substring(0,e.length-1):e,this.logDisplayedTelemetry=e=>{var t,i;e.isFromAugLoop&&((null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.onPredictionDisplayed)&&this._hostSettings.serviceSettings.predictions.onPredictionDisplayed(e),this._oaLogger.logActivity("OAPredictionDisplayed",void 0,this.getBasePredictionLogFields(e)))},this.logAcceptedTelemetry=(e,t,i,n,s)=>{var o,r;e.isFromAugLoop&&((null===(r=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===r?void 0:r.onPredictionAccepted)&&this._hostSettings.serviceSettings.predictions.onPredictionAccepted(e,t,i),this._oaLogger.logActivity("OAPredictionApplied",void 0,[...this.getBasePredictionLogFields(e),...(0,a.W)(["charactersTyped",t],["acceptedViaUserAction",i],["keyPressedForAccept",n],["acceptanceTime",(new Date).toISOString()],["isOpeningECCForEntityPrediction",s])]))},this.logDismissedTelemetry=(e,t,i)=>{var n,s;e.isFromAugLoop&&((null===(s=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===s?void 0:s.onPredictionDismissed)&&this._hostSettings.serviceSettings.predictions.onPredictionDismissed(e,e.currentEndIndex?e.currentEndIndex-e.startIndex:0,t),void 0!==this._prediction&&this._oaLogger.logActivity("OAPredictionDismissed",void 0,[...this.getBasePredictionLogFields(e),...(0,a.W)(["charactersTyped",e.currentEndIndex?e.currentEndIndex-e.startIndex:0],["dismissalReason",t],["dismissalType",i],["rejectionTime",(new Date).toISOString()])]))},this._predictionStore.setOnUpdatedPrediction(this.onPredictionUpdatedInternal)}get prediction(){return this._prediction}get predictionDisplayText(){return this._predictionDisplayText}get predictionDisplayLocation(){return this._predictionDisplayLocation}get predictionParentElement(){return this._predictionParentElement}get predictionContentEditableParentElement(){return this._predictionContentEditableParentElement}get multiPredictionMenuOpen(){return this._multiPredictionMenuOpen}get predictionFirstDisplayedTime(){return this._predictionFirstDisplayedTime}get localizer(){return this._localizer}async initialize(){this._hostEmitter.on(l.pD.hostModelDelta,this.handleDelta),this._hostEmitter.on(l.pD.hostModelTextTile,this.handleTextTile),this._hostEmitter.on(l.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._proofingEmitter.on("eccStateChanged",this.eccStateChanged)}shutDown(){this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0}setOnUpdate(e){this._onUpdate=e}async clearCurrentPrediction(e,t,i){this.logDismissedTelemetry(e,t,i),await this._predictionStore.clearPrediction()}isPredictionDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}checkForECCHintTextPrediction(){return!1}async handleRemotePredictionUpdate(e,t,i,n){var s,o,r,a,l;if(e.tileId!==i)return;const d=null!==(s=n.position)&&void 0!==s?s:0,h=e.startIndex+t.length;if(d>=e.startIndex&&d<h)await this.clearCurrentPrediction(e,"remote edit dismissed",c.R8.ImplicitRejection);else{const t=n.deltaType===u.WI.Add?null!==(r=null===(o=n.content)||void 0===o?void 0:o.length)&&void 0!==r?r:0:n.deltaType===u.WI.Delete?-1*n.length:n.deltaType===u.WI.Update?(null!==(l=null===(a=n.content)||void 0===a?void 0:a.length)&&void 0!==l?l:0)-n.length:0,i=this._predictionUpdate+1;this._predictionUpdate=i,await this.determineIfPredictionIsValidAndApply(Object.assign(Object.assign({},e),{startIndex:e.startIndex+t}),i)}}determineIfPredictionTextIsValid(e,t,i){var n,o,r,a,l,g,p,f,v;const _=this._proofingDom.findParagraphNode(e.tileId),y=this.trimLineEnding(this._paragraphTextExtractor.getParagraphText(_)),I=null!==(o=null===(n=this.lastPredictedTile)||void 0===n?void 0:n.predictionContext.length)&&void 0!==o?o:0;if(e.entityType===s.c.Loop&&e.tileId===(null===(r=this.lastPredictedTile)||void 0===r?void 0:r.id)&&e.entityType===this.lastPredictedTile.predictionType&&(null!==(l=null===(a=e.context)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>I+3)return{result:!1};if(t&&e.shouldDismissOnTextChange)return{result:!1};const C=null!==(g=null==t?void 0:t.position)&&void 0!==g?g:0;if(y&&(0,m.l)(_)){const n=y.substring(e.startIndex);t&&this.isEntityPrediction(e.entityType)&&this.prepareEntityPredictionForTextUpdate(e,y);const s=(e.context?e.context.substring(0,e.startIndex):y.substring(0,e.startIndex))+e.text;let o=0;for(let s=0;s<e.text.length;s++){const r=e.text.charAt(s),a=(null==t?void 0:t.deltaType)===u.WI.Delete?1:0;if(s>=n.length||t&&s+e.startIndex>C-a)break;if(t&&t.deltaType===u.WI.Delete&&s+e.startIndex===C-a&&i&&1===i.length&&r===i)break;if(r===n.charAt(s))o++;else{if(!this.allowMiddleOfSentencePredictions()){if(e.shouldDismissOnTextChange)break;return{result:!1}}if(!t)break;if(t.deltaType!==u.WI.Add||!t.content||!(t.content===n.charAt(s)||d.Yv(t.content.charCodeAt(0))&&d.Yv(n.charCodeAt(s))))return{result:!1}}}const r=y.substring(0,e.startIndex+o);if(e.currentEndIndex&&e.currentEndIndex>r.length&&(!t||t.deltaType!==u.WI.Delete||C<e.startIndex))return{result:!1};if(e.currentEndIndex=r.length,e.entityResults&&!this.checkIfEntityPredictionContextIsValid(e,y,o))return{result:!1};if(s.startsWith(r)&&r!==s){const t=r.length,i=this._tileContent.getContainingElement(_);if(!i)return{result:!1,dueToMissingContainingHTMLElement:!0};const n=null!==(p=(0,h.m)(i))&&void 0!==p?p:i;return(null===(f=this.lastPredictedTile)||void 0===f?void 0:f.id)!==e.tileId&&(this.lastPredictedTile={id:e.tileId,predictionType:e.entityType,predictionContext:null!==(v=e.context)&&void 0!==v?v:""}),{paragraphNode:_,paragraphNodeOffset:_.element.offset,insertableTextStart:t,htmlParentElement:i,contentEditableHtmlParentElement:n,predictionText:s}}if(r===s)return this.logAcceptedTelemetry(e,e.text.length,!1,c.r7,!!e.entityResults),{result:!1,dueToEntirePredictionTyped:!0}}return{result:!1}}getBasePredictionLogFields(e){const t=(0,a.W)(["predictionTextLength",e.text.length],["entityType",e.entityType]);return void 0!==this._predictionFirstDisplayedTime&&t.push((0,a.n)("firstDisplayedTime",this._predictionFirstDisplayedTime.toISOString())),t}};f=(0,n.__decorate)([(0,p._)()],f)},27952:(e,t,i)=>{i.d(t,{J:()=>a});var n=i(87414);if(2063!=i.j)var s=i(64462);if(2063!=i.j)var o=i(62558);var r=i(8520);const a=e=>{const{hostSettings:t,themeStore:i}=e,a=(0,o.ZY)(),[l,d]=r.useState(null==i?void 0:i.getComponentActiveTheme(n.yF.predictionContainerComponentName,!0));r.useEffect((()=>{if(!i)return()=>{};const e=()=>{d(i.getComponentActiveTheme(n.yF.predictionContainerComponentName,!0))};return i.subscribe("currentThemeUpdated",e),i.subscribe("defaultThemeUpdated",e),i.subscribe("themesUpdated",e),()=>{i.unsubscribe("currentThemeUpdated",e),i.unsubscribe("defaultThemeUpdated",e),i.unsubscribe("themesUpdated",e)}}),[i]);const c=(0,s.A)(l);return r.useEffect((()=>{if(!t.disableInlineStyleTagInCanvas||!a||!c)return;const e=a.getElementById("ms-prediction-style");if(null===e){const e=a.createElement("style");e.type="text/css",e.id="ms-prediction-style",e.appendChild(a.createTextNode(c)),a.head.appendChild(e)}else e.innerText=c}),[t,a,c]),t.disableInlineStyleTagInCanvas?null:r.createElement("style",{type:"text/css"},c)}},19562:(e,t,i)=>{if(i.d(t,{r:()=>u}),2063!=i.j)var n=i(99614);if(2063!=i.j)var s=i(25204);if(2063!=i.j)var o=i(92120);if(2063!=i.j)var r=i(82747);if(2063!=i.j)var a=i(27578);if(2063!=i.j)var l=i(44528);if(2063!=i.j)var d=i(10628);var c=i(8520);function u(e,t,i,u,h,g,p,m,f,v,_){return c.createElement(l.K,{rtl:i.isRtl()},function(e,t,i,l,u,h,g,p,m,f){var v,_,y,I,C,S,b;return i.entityType===n.c.File&&i.entityResults&&l?c.createElement(s.Z,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(v=i.shouldShowInsertionHelperText)||void 0===v||v,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):i.entityType===n.c.People&&i.entityResults&&l?c.createElement(r.m,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(_=i.shouldShowInsertionHelperText)||void 0===_||_,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):i.entityType===n.c.Loop&&i.entityResults&&l?c.createElement(o.N,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(y=i.shouldShowInsertionHelperText)||void 0===y||y,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):i.entityType===n.c.PIM&&l&&m&&(null!==(C=null===(I=i.entityResults)||void 0===I?void 0:I.entities.length)&&void 0!==C?C:0)>1?c.createElement(a.X,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(S=i.shouldShowInsertionHelperText)||void 0===S||S,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):[n.c.Text,n.c.People,n.c.PIM,n.c.Topic].includes(i.entityType)&&l?c.createElement(d.Y,{predictionDisplayText:l,shouldShowInsertionHelperText:null===(b=i.shouldShowInsertionHelperText)||void 0===b||b,isPIMPrediction:i.entityType===n.c.PIM,leftPadding:p,localizer:e,isMobile:t,onTextMayOverlapLine:g,onDropdownOpened:h,isHelperText:i.isHelperText,appName:f}):c.createElement(c.Fragment,null)}(e,t,u,h,g,p,m,f,v,_))}},10628:(e,t,i)=>{i.d(t,{Y:()=>o});var n=i(8520);const s="textPrediction",o=n.memo((e=>{const{predictionDisplayText:t,shouldShowInsertionHelperText:i,isPIMPrediction:o,isMobile:r,localizer:a,onTextMayOverlapLine:l,leftPadding:d,onDropdownOpened:c,isHelperText:u,appName:h}=e,g=t.split(" "),p=n.useRef({}),m=n.useCallback((()=>{o&&p.current[0]&&c(p.current[0])}),[c]);if(n.useEffect((()=>{if(!p.current[0]||!p.current[g.length-1])return;let e=0,t=0;for(let i=0;i<g.length;i++){if(!p.current[i])continue;const n=0===i,s=i===g.length-1,o=p.current[i].getBoundingClientRect();if(n?e=o.top:o.top!==e&&(t++,e=o.top),s){const e=p.current[i].getClientRects();1!==e.length&&(t+=e.length-1)}}l(t)})),!g)return n.createElement(n.Fragment,null);const f=["BingAtWork","BizChat"].some((e=>null==h?void 0:h.includes(e)))&&u;return n.createElement(n.Fragment,null,g.map(((e,t,o)=>{const l=0===t,c=t+1===o.length,u=e+(c?"":" ");return n.createElement("span",{key:`${s}-${t}`,id:`${s}-${t}`,className:f?"ms-ghost-text":"ms-text-prediction",style:{paddingLeft:l&&d?d+"px":void 0,whiteSpace:c&&i?"nowrap":void 0,borderRadius:l&&f?"4px 0 0 4px":t===o.length-2?"0 4px 4px 0":void 0},contentEditable:!1,ref:e=>{p.current[t]=e},onMouseOver:m,onFocus:m},"",u,"",c&&i?n.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"",a.getMessage(r?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),""):n.createElement(n.Fragment,null))})))}))},25254:(e,t,i)=>{i.d(t,{l:()=>B});var n=i(79490),s=i(71924),o=i(13290),r=i(96571),a=i(11804),l=i(10138),d=i(52946),c=i(76778),u=i(10219),h=i(14775),g=i(95834),p=i(4891),m=i(39826),f=i(29906),v=i(83010),_=i(27603),y=i(99614),I=i(43230),C=i(85339),S=i(90327),b=i(74261),T=i(68833),E=i(23943),N=i(15168),x=i(754),w=i(87414),L=i(98970),D=i(921),F=i(63088),A=i(10250),R=i(27952),q=i(62617),P=i(19562),O=i(8520);const k=O.memo((e=>{var t,i,n,s,o,r,a;const{hostSettings:l,isMobile:d,languageScriptDirectionDetector:c,predictionStateStore:u,themeStore:h}=e,g=u.predictionContentEditableParentElement,p=O.createRef(),[m,f]=O.useState(u.prediction),[v,_]=O.useState(u.predictionDisplayText),I=O.useCallback((()=>{u.prediction&&u.predictionDisplayText&&(f(u.prediction),_(u.predictionDisplayText))}),[u.prediction,u.predictionDisplayText]);O.useEffect((()=>(u.setOnUpdate(I),()=>{u.setOnUpdate(void 0)})),[u,I]);const C=O.useCallback((e=>{u.onEntityDropdownOpened(m,e)}),[u,m]),S=O.useCallback((async e=>{var t,i,n;D.x.isKey(e,F.m.tab)?(e.stopPropagation(),e.preventDefault(),(null===(t=u.prediction)||void 0===t?void 0:t.entityResults)&&u.prediction.entityResults.entities.length>1&&(u.prediction.entityType!==y.c.PIM||(null===(n=null===(i=l.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.enablePimMultiPredict))?p.current&&C(p.current):await u.applyCurrentPrediction(e.keyCode)):D.x.isKey(e,[F.m.arrowLeft,F.m.arrowRight,F.m.escape])?await u.clearCurrentPrediction(m,"invalid key press",A.R8.ExplicitRejection):D.x.isKey(e,[F.m.arrowUp,F.m.arrowDown,F.m.enter])&&(u.multiPredictionMenuOpen||await u.clearCurrentPrediction(m,"invalid key press",A.R8.ExplicitRejection))}),[null===(i=null===(t=l.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.enablePimMultiPredict,C,m,u,p]),b=O.useCallback((async e=>{e.preventDefault(),e.stopPropagation(),d&&await u.applyCurrentPrediction(A.XG)}),[d,u]),T=O.useCallback((async e=>{if(!p.current)return;let t=Array.from(p.current.getClientRects());t=t.map((e=>{return t=e,new DOMRect(t.x-z,t.y-M,t.width+z+z,t.height+M+M);var t})),t.find((t=>{return i=t,n=e.pageX,s=e.pageY,i.x<=n&&n<=i.x+i.width&&i.y<=s&&s<=i.y+i.height;var i,n,s}))&&(e.preventDefault(),e.stopPropagation(),await u.applyCurrentPrediction(A.XG))}),[p,u]),E=O.useCallback((async e=>{m.isHelperText&&((0,q.m)(e.target)||(0,q.m)(e.relatedTarget))||u.multiPredictionMenuOpen||await u.clearCurrentPrediction(m,"lost focus",A.R8.ImplicitRejection)}),[m,u]),N=O.useCallback((async()=>{await u.isInputPointerAtPrediction()||await u.clearCurrentPrediction(m,"input pointer not at prediction",A.R8.ImplicitRejection)}),[m,u]);O.useEffect((()=>{const e={passive:!0,capture:!0},t=g&&new L.J(g),i=new L.J(document);return null==t||t.addListener("keydown",S),null==t||t.addListener("focusout",E,e),i.addListener("selectionchange",N,e),()=>{null==t||t.removeAllListeners(),i.removeAllListeners()}}),[g,S,E,N]),O.useEffect((()=>{if(!p.current)return;const e=new L.J(p.current),t=new L.J(document);return e.addListener("pointerdown",b,{capture:!0}),d&&t.addListener("pointerdown",T,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[T,b,d,p]),O.useEffect((()=>{var e,t,i;null===(i=null===(t=null===(e=l.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onPredictionUpdate)||void 0===i||i.call(t)}),[null===(n=l.serviceSettings)||void 0===n?void 0:n.predictions,v]);const x=O.useCallback((e=>Promise.resolve()),[]);return g?O.createElement("span",{className:"suggestedCompletion",ref:p},O.createElement(R.J,{hostSettings:l,themeStore:h}),(0,P.r)(u.localizer,d,c,m,v,u.predictionParentElement,C,x,m.isHelperText&&"BizChat"===(null===(s=l.hostMetadata)||void 0===s?void 0:s.appName)?4:void 0,null===(r=null===(o=l.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===r?void 0:r.enablePimMultiPredict,null===(a=l.hostMetadata)||void 0===a?void 0:a.appName)):null}));const z=20,M=20;var j=i(69076),W=i(94329);let B=class extends j.p{constructor(e,t,i,n,s,o,r,a,l,d,c,u,h,g,p,m,f,v,_){super(e,t,i,n,s,o,r,a,l,d,c,f,m),this._ariaStatusStateStoreFactory=u,this._featureFlagsReader=h,this._themeStore=g,this.languageScriptDirectionDetector=p,this.compositionEventHandler=v,this._isMobile=_,this.shutDown=()=>{this._predictionHTMLElement=void 0,super.shutDown()},this.isInputPointerAtPrediction=async()=>{var e;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const t=await this._tileContent.getTextSelection();return!!t&&(!!this._prediction&&(t.startPosition===t.endPosition&&(null===(e=t.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&t.endPositionInParagraphNode===this._prediction.currentEndIndex))},this.predictionMayOverlapNextLine=e=>Promise.resolve()}allowMiddleOfSentencePredictions(){var e,t,i;return null!==(i=null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.allowMiddleOfSentencePredictions)&&void 0!==i&&i}async applyCurrentPrediction(e,t){var i,n,s;if(!this._prediction)return;const o=this._prediction;if(o.isHelperText)return;const r=this.determineIfPredictionTextIsValid(o);if("result"in r)return void await this.clearCurrentPrediction(o,"invalid application",A.R8.ImplicitRejection);const{paragraphNode:a,paragraphNodeOffset:l,insertableTextStart:d,predictionText:c}=r,u=c.substring(d);let h;if(h=this.isEntityPrediction(o.entityType)&&o.entityResults&&d!==o.startIndex?await this._tileContent.getRangeOfNode(a.parent,void 0,l+o.startIndex,d-o.startIndex):await this._tileContent.getNodeInsertionPosition(a.parent,l+d,!0),await this._predictionStore.clearPrediction(),this.isEntityPrediction(o.entityType)&&o.entityResults){const e=null!=t?t:this.getPredictionFirstItem(o);e&&h&&(null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(o,e,h,a.parent.element)}else await this._tileContent.insert(a.parent,void 0,l+d,u,!0,h,!1,!1),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(s=this._ariaStatusStateStoreFactory())||void 0===s||s.setStatus(this._localizer.getMessage("ebx_PredictionAppliedMessage",u),"assertive",!1));this.logAcceptedTelemetry(o,d-o.startIndex,!0,e,!!o.entityResults)}async onPredictionUpdated(){var e,t;const i=this._predictionUpdate+1;this._predictionUpdate=i;const n=this._predictionStore.getCurrentPrediction();if(n)await this.determineIfPredictionIsValidAndApply(n,i);else{const i=this._predictionHTMLElement,n=this._predictionParentElement;if(this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionFirstDisplayedTime=void 0,this._predictionHTMLElement=void 0,i)if(W.unmountComponentAtNode(i),null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onDomRemoval)this._hostSettings.serviceSettings.predictions.onDomRemoval(i,n);else{const e=i.parentElement;i.remove(),e&&"div"===e.nodeName.toLowerCase()&&!e.textContent&&0===e.childElementCount&&e.appendChild(e.ownerDocument.createElement("br"))}this._onUpdate&&this._onUpdate()}}async determineIfPredictionIsValidAndApply(e,t,i,n,r,a,l){var d,c,u,h,g,p;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,A.R8.NotSeen);if(void 0!==r&&r!==s.Q0.Local&&a&&n&&i)return void await this.handleRemotePredictionUpdate(e,i,n,a);if(n&&n!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",A.R8.ExplicitRejection);const m=this.determineIfPredictionTextIsValid(e,a,l);if("result"in m){if(m.dueToMissingContainingHTMLElement)return;return void(m.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",A.R8.TypeNotMatchingCharacter))}const{insertableTextStart:f,htmlParentElement:v,contentEditableHtmlParentElement:_,predictionText:y}=m;if(this._prediction=e,this._predictionParentElement=v,this._predictionContentEditableParentElement=_,y.substring(f)!==this._predictionDisplayText){if(this._predictionDisplayText=y.substring(f),!this._predictionHTMLElement){if(null===(d=this.compositionEventHandler)||void 0===d?void 0:d.isComposing)return void(this._predictionHTMLElement=void 0);if(this._predictionHTMLElement=v.ownerDocument.createElement("span"),this._predictionHTMLElement.contentEditable="false",this._predictionHTMLElement.classList.add("ms-prediction"),null===(c=this.compositionEventHandler)||void 0===c?void 0:c.isComposing)return void(this._predictionHTMLElement=void 0);if(t<this._predictionUpdate)return;const i=this._predictionHTMLElement.ownerDocument.getSelection(),n=1===(null==i?void 0:i.rangeCount)?i.getRangeAt(0):void 0;if(!n)return this._logger.log(524882904,o.q.Warn,"Unable to find range of prediction text insertion point in PredictionStateStore."),void await this.clearCurrentPrediction(e,"unable to determine range for prediction",A.R8.NotSeen);{const t=O.createElement(k,{predictionStateStore:this,themeStore:this._themeStore,isMobile:null!==(u=this._isMobile)&&void 0!==u&&u,hostSettings:this._hostSettings,languageScriptDirectionDetector:this.languageScriptDirectionDetector});if(W.render(t,this._predictionHTMLElement),null===(g=null===(h=this._hostSettings.serviceSettings)||void 0===h?void 0:h.predictions)||void 0===g?void 0:g.onDomInsertion){if(!this._hostSettings.serviceSettings.predictions.onDomInsertion(n,this._predictionHTMLElement,v))return void await this.clearCurrentPrediction(e,"host unable to insert prediction",A.R8.NotSeen)}else n.insertNode(this._predictionHTMLElement),i&&i.setBaseAndExtent(n.startContainer,n.startOffset,n.startContainer,n.startOffset)}this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(p=this._ariaStatusStateStoreFactory())||void 0===p||p.setStatus(this._localizer.getMessage(this._isMobile?"ebx_MobilePredictionAvailableMessage":"ebx_PredictionAvailableMessage",e.text),"assertive",!1))}this._onUpdate&&this._onUpdate()}}checkForECCHintTextPrediction(){var e,t,i,n,s,o,r;const a=null===(e=this._inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo();if(!a||a.searchBoxGeneratedParagraphId||"InlineSuggestionsResultsUserInitiatedMenuType"!==a.menuType.menuType||a.queryRange.length!==(null!==(i=null===(t=a.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1)||!(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.enableZeroQueryHintText)&&(!a.enableExpandedECC||!a.enableExpandedECCSearchBar))return!1;const l=this._paragraphTextExtractor.getParagraphText(a.tileId),d=a.queryRange.start+(null!==(o=null===(s=a.queryRange.prefix)||void 0===s?void 0:s.length)&&void 0!==o?o:1),c="BizChat"===(null===(r=this._hostSettings.hostMetadata)||void 0===r?void 0:r.appName)?this.localizer.getMessage("ebx_ECCZeroQueryBizChatHintText")+" ":this.localizer.getMessage("ebx_ECCZeroQueryHintText")+" ";return this._predictionStore.updatePrediction({text:c,context:null==l?void 0:l.substring(0,d),annotationId:"1",tileId:a.tileId,tileVersion:0,entityType:y.c.Text,startIndex:d,length:c.length,shouldDismissOnTextChange:!0,shouldShowInsertionHelperText:!1,isHelperText:!0}),!0}};B=(0,n.__decorate)([(0,f._)(),(0,n.__param)(0,(0,v.W)(r.H)),(0,n.__param)(1,(0,v.W)(a.n)),(0,n.__param)(2,(0,v.W)(l.g)),(0,n.__param)(3,(0,v.W)(d.m)),(0,n.__param)(4,(0,v.W)(b.o)),(0,n.__param)(5,(0,v.W)(E.w)),(0,n.__param)(6,(0,v.W)(N.b)),(0,n.__param)(7,(0,v.W)(x.d)),(0,n.__param)(8,(0,v.W)(c.M5)),(0,n.__param)(9,(0,_.l)()),(0,n.__param)(9,(0,v.W)(I.A)),(0,n.__param)(10,(0,_.l)()),(0,n.__param)(10,(0,v.W)(C.V)),(0,n.__param)(11,(0,v.W)(S.Th)),(0,n.__param)(12,(0,v.W)(u.c)),(0,n.__param)(13,(0,v.W)(w.YQ)),(0,n.__param)(14,(0,v.W)(h.iw)),(0,n.__param)(15,(0,v.W)(g.o)),(0,n.__param)(16,(0,_.l)()),(0,n.__param)(16,(0,v.W)(T.Y)),(0,n.__param)(17,(0,_.l)()),(0,n.__param)(17,(0,v.W)(p.q)),(0,n.__param)(18,(0,_.l)()),(0,n.__param)(18,(0,v.W)(m.n))],B)},56314:(e,t,i)=>{i.d(t,{q:()=>d});var n=i(26598),s=i(30833),o=i(10250);if(2063!=i.j)var r=i(65951);var a=i(8520);const l=(0,n.F5)({predictionStateStore:s.A.on(o.Tc)}),d=()=>{const{predictionStateStore:e}=(0,n.KN)(l),[t,i]=a.useState(),[s,o]=a.useState(),d=()=>{i(e.prediction),o(e.predictionDisplayText)};a.useEffect((()=>(e.setOnUpdate(d),()=>{e.setOnUpdate(void 0)})),[e]);const c=a.useCallback((async t=>{await e.applyCurrentPrediction(t)}),[]),u=a.useCallback((async(t,i)=>{e.prediction&&await e.clearCurrentPrediction(e.prediction,t,i)}),[]),h=a.useCallback((async()=>e.isInputPointerAtPrediction()),[]),g=a.useCallback((async t=>{await e.predictionMayOverlapNextLine(t)}),[]),p=a.useCallback((i=>{e.onEntityDropdownOpened(t,i)}),[]);return t&&e.prediction&&e.predictionDisplayLocation&&e.predictionParentElement&&e.predictionContentEditableParentElement?a.createElement(r.L,{prediction:t,predictionDisplayText:s,targetLocation:e.predictionDisplayLocation,predictionContentEditableParentElement:e.predictionContentEditableParentElement,predictionParentElement:e.predictionParentElement,onApplyCurrentPrediction:c,onClearCurrentPrediction:u,isInputPointerAtPrediction:h,onCurrentPredictionMayOverlapNextLine:g,onEntityDropdownOpened:p}):null}},65951:(e,t,i)=>{i.d(t,{L:()=>b});var n=i(26598),s=i(30833),o=i(96571),r=i(11804),a=i(14775),l=i(52041),d=i(39826),c=i(98970),u=i(10250),h=i(87414),g=i(921),p=i(63088),m=i(20299),f=i(27952);const v=(e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let i=e.parentElement,n=window.getComputedStyle(i);for(;i&&"relative"!==n.position&&i!==document.body;)i=i.parentElement,n=window.getComputedStyle(i);return i},_=()=>!0;var y=i(19562),I=i(8520),C=i(1116);const S=(0,n.F5)({predictionStateStore:s.A.on(u.Tc),localizer:s.A.on(o.H),themeStore:s.A.on(h.YQ).optional(),hostSettings:s.A.on(r.n),languageScriptDirectionDetector:s.A.on(a.iw),safeWindow:s.A.on(l.j),isMobile:s.A.on(d.n).optional()}),b=I.memo((e=>{var t;const{prediction:i,predictionDisplayText:s,targetLocation:o,onApplyCurrentPrediction:r,onClearCurrentPrediction:a,isInputPointerAtPrediction:l,onCurrentPredictionMayOverlapNextLine:d,onEntityDropdownOpened:h,predictionContentEditableParentElement:b,predictionParentElement:T}=e,{hostSettings:E,isMobile:N,languageScriptDirectionDetector:x,localizer:w,predictionStateStore:L,themeStore:D,safeWindow:F}=(0,n.KN)(S),A=I.useRef(null),R=I.useRef(null),q=I.useRef(),P=I.useRef({top:0,left:0}),[O,k]=I.useState({zIndex:"auto",element:void 0,shouldRender:()=>!0,shouldRenderPrediction:()=>!0,shouldObserveSize:()=>[],addHandlers:()=>()=>null,predictionInlineStyles:()=>{},transformPredictionRects:e=>e,getForbiddenRects:()=>[]}),[z,M]=I.useState(!1),[j,W]=I.useState({container:{},overlay:{},anchorStyle:{position:"static"}}),B=Object.assign(Object.assign({},j.overlay),{zIndex:null!==(t=O.zIndex)&&void 0!==t?t:j.overlay.zIndex}),U=I.useCallback((()=>{const e=b.scrollLeft,t=b.scrollTop;A.current&&(A.current.scrollLeft=e,A.current.scrollTop=t)}),[b.scrollLeft,b.scrollTop]),H=I.useCallback((e=>F.requestAnimationFrame(e)),[F]),V=I.useCallback((()=>{const e=(0,m.dB)(b,R.current,P),t=(0,m.Cf)(b);P.current={top:e.top,left:e.left},W((()=>(U(),M(!0),{container:e,overlay:t.overlay,anchorStyle:t.anchor})))}),[b,U]),G=I.useCallback((()=>{H(V)}),[H,V]),Q=()=>(setTimeout((()=>{G(),b.dispatchEvent(new Event("BX-ForceReflow",{bubbles:!0}))}),500),!0),K=()=>{H(U)},$=async e=>{g.x.isKey(e,p.m.tab)?(e.stopPropagation(),e.preventDefault(),await r(e.keyCode)):g.x.isKey(e,[p.m.arrowLeft,p.m.arrowUp,p.m.arrowRight,p.m.arrowDown,p.m.enter,p.m.escape])&&await a("invalid key press",u.R8.ExplicitRejection)},J=async e=>{e.preventDefault(),e.stopPropagation(),N&&await r(u.XG)},Z=()=>{setTimeout((async()=>{L.multiPredictionMenuOpen||await a("lost focus",u.R8.ImplicitRejection)}),100)},Y=()=>{F.requestIdleCallback((async()=>{await X()}),100)},X=async()=>{await l()||await a("input pointer not at prediction",u.R8.ImplicitRejection)};I.useEffect((()=>{G()}),[G]),I.useEffect((()=>{k(((e,t,i=!0)=>{var n;const s=_,o=_,r=()=>[],a=()=>()=>null,l=()=>{},d=e=>e,c=()=>[];return"body"!==e.tagName.toLowerCase()&&e.parentElement?{element:i?v(e,t):e.parentElement,zIndex:void 0,shouldRender:s,shouldRenderPrediction:o,shouldObserveSize:r,addHandlers:a,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:c}:{element:null!==(n=e.parentElement)&&void 0!==n?n:window.document.body,zIndex:"auto",shouldRender:s,shouldRenderPrediction:o,shouldObserveSize:r,addHandlers:a,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:c}})(b,j.anchorStyle.position))}),[j.anchorStyle.position,b]),I.useEffect((()=>{const e={passive:!0,capture:!0},t=new c.J(window),i=new c.J(document),n=new c.J(b);t.addListener("resize",G,e),t.addListener("hashchange",Q,e),t.addListener("popstate",Q,e),i.addListener("mouseup",Q,e),i.addListener("selectionchange",Y,e),n.addListener("paste",Q,e),n.addListener("scroll",K,e),n.addListener("keydown",$),n.addListener("focusout",Z,e),(()=>{if(!q.current&&window.ResizeObserver&&(Q(),q.current=new window.ResizeObserver((()=>{G()}))),q.current){q.current.observe(b);for(const e of O.shouldObserveSize(b))q.current.observe(e)}})();const s=O.addHandlers(b,{queueUpdateOverlay:G,updateOverlayAndNotifyInput:Q});return()=>{t.removeAllListeners(),i.removeAllListeners(),n.removeAllListeners(),q.current&&q.current.disconnect(),s()}}),[]),I.useEffect((()=>{if(!R.current)return;const e=new c.J(R.current);return e.addListener("mousedown",J),()=>{e.removeAllListeners()}}),[R,J]);const ee=I.useCallback((async e=>{await d(e)}),[d]),te=I.useCallback((e=>{h(e)}),[h]),ie=window.getComputedStyle(b),ne=parseInt(ie.paddingLeft,10),se=parseInt(ie.paddingTop,10),oe=(o.x,o.y-se);return O.element?I.createElement(C.Ay.div,{className:"ms-editor-text-prediction"},I.createElement(f.J,{hostSettings:E,themeStore:D}),I.createElement("div",{ref:R,style:j.container},I.createElement("div",{id:"ms-editor-text-prediction-overlay",style:B,className:"hc-noadjust"},I.createElement("div",{style:{paddingTop:oe+"px"}}),z&&(0,y.r)(w,null!=N&&N,x,i,s,T,te,ee,ne)))):null}))},41736:(e,t,i)=>{i.d(t,{O:()=>E});var n=i(79490),s=i(71924),o=i(1527),r=i(96571),a=i(11804),l=i(10138),d=i(52946),c=i(76778),u=i(95834),h=i(29906),g=i(83010),p=i(27603),m=i(99614),f=i(43230),v=i(85339),_=i(74261),y=i(68833),I=i(23943),C=i(15168),S=i(754),b=i(10250),T=i(69076);let E=class extends T.p{constructor(e,t,i,n,s,o,r,a,l,d,c,u,h){super(e,t,i,n,s,o,r,l,a,c,u,h,d),this._predictionHasWrappedOntoNewLineCount=0,this.isInputPointerAtPrediction=async()=>{var e,t;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const i=await this._tileContent.getTextSelection();return!!i&&(!!this._prediction&&(i.startPosition===i.endPosition&&(null===(e=i.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&i.endPositionInParagraphNode===(null===(t=i.endParagraphNode)||void 0===t?void 0:t.element).span-(void 0===this.getNextParagraphAfterPrediction()?0:1)))},this.removeWrappingNewLines=async()=>{var e;const t=this.getNextParagraphAfterPrediction();(null===(e=null==t?void 0:t.parent)||void 0===e?void 0:e.element)&&t.element&&0!==this._predictionHasWrappedOntoNewLineCount&&await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount)},this.insertNewLines=async(e,t,i)=>{let n="";for(let e=0;e<i;e++)n+="\n";this._isActivelyAddingWrappingNewLines=!0,await this._tileContent.insert(e,void 0,t,n,!1,void 0,!0,!1),this._isActivelyAddingWrappingNewLines=!1},this.removeNewLines=async(e,t,i)=>{this._isActivelyAddingWrappingNewLines=!0;for(let n=0;n<i;n++)await this._tileContent.remove(e,void 0,t-1,1,!1,void 0,!0,!1);this._isActivelyAddingWrappingNewLines=!1},this.getNextParagraphAfterPrediction=()=>{var e;if(this._prediction){const t=this._proofingDom.findParagraphNode(this._prediction.tileId);if((null==t?void 0:t.parent)&&t.element&&"offset"in t.element){const i=t.element.offset+t.element.span;let n;return null===(e=t.parent.children)||void 0===e||e.forEach((e=>{e.element&&"offset"in e.element&&e.element.offset>=i&&(!n||n.element&&e.element.offset<n.element.offset)&&(n=e)})),n}}}}allowMiddleOfSentencePredictions(){return!1}async applyCurrentPrediction(e,t){var i,n;if(!this._prediction)return;const s=this._prediction,o=this.determineIfPredictionTextIsValid(s);if("result"in o)return void await this.clearCurrentPrediction(s,"invalid application",b.R8.ImplicitRejection);const{paragraphNode:r,paragraphNodeOffset:a,insertableTextStart:l,predictionText:d}=o,c=d.substring(l);this._predictionHasWrappedOntoNewLineAtStartOfTile&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0);const u=await this._tileContent.getNodeInsertionPosition(r.parent,a+l,!0);if(await this._predictionStore.clearPrediction(),this.isEntityPrediction(s.entityType)){const e=null!=t?t:this.getPredictionFirstItem(s);e&&u&&(null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(s,e,u,r.parent.element)}else r.parent&&await this._tileContent.insert(r.parent,void 0,a+l,c,!0,u,!1,!1);this.logAcceptedTelemetry(s,l-s.startIndex,!0,e,!!s.entityResults)}async predictionMayOverlapNextLine(e){var t,i,n;if(!this._prediction||this._prediction.entityType!==m.c.File&&this._prediction.entityType!==m.c.People){if(this._predictionHasWrappedOntoNewLineAtStartOfTile){if(e>this._predictionHasWrappedOntoNewLineCount){const i=this.getNextParagraphAfterPrediction();(null===(t=null==i?void 0:i.parent)||void 0===t?void 0:t.element)&&i.element&&(await this.insertNewLines(i.parent,i.element.offset,e-this._predictionHasWrappedOntoNewLineCount),this._predictionHasWrappedOntoNewLineAtStartOfTile=i.id,this._predictionHasWrappedOntoNewLineCount=e)}else if(e<this._predictionHasWrappedOntoNewLineCount){const t=this.getNextParagraphAfterPrediction();(null===(i=null==t?void 0:t.parent)||void 0===i?void 0:i.element)&&t.element&&(await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount-e),this._predictionHasWrappedOntoNewLineCount=e)}}else if(0!==e){const t=this.getNextParagraphAfterPrediction();(null===(n=null==t?void 0:t.parent)||void 0===n?void 0:n.element)&&t.element&&(this._predictionHasWrappedOntoNewLineAtStartOfTile=t.id,this._predictionHasWrappedOntoNewLineCount=e,await this.insertNewLines(t.parent,t.element.offset,e))}}else 0!==e&&await this.clearCurrentPrediction(this._prediction,"Entity cannot wrap",b.R8.NotSeen)}async onPredictionUpdated(){const e=this._predictionUpdate+1;this._predictionUpdate=e;const t=this._predictionStore.getCurrentPrediction();t?await this.determineIfPredictionIsValidAndApply(t,e):(this._predictionHasWrappedOntoNewLineAtStartOfTile&&await this.removeWrappingNewLines(),this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionDisplayLocation=void 0,this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0,this._predictionFirstDisplayedTime=void 0,this._onUpdate&&this._onUpdate())}async determineIfPredictionIsValidAndApply(e,t,i,n,r,a,l){var d;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,b.R8.NotSeen);if(void 0!==r&&r!==s.Q0.Local&&a&&n&&i)return void await this.handleRemotePredictionUpdate(e,i,n,a);if(n&&n!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",b.R8.ExplicitRejection);const c=this.determineIfPredictionTextIsValid(e,a,l);if("result"in c){if(c.dueToMissingContainingHTMLElement)return;return void(c.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",b.R8.ExplicitRejection))}const{paragraphNode:u,paragraphNodeOffset:h,insertableTextStart:g,htmlParentElement:p,contentEditableHtmlParentElement:m,predictionText:f}=c,v=this._paragraphTextExtractor.getParagraphText(e.tileId),_=await this._tileContent.getRangeOfNode(u.parent,void 0,h+g-1,1),y=null==_?void 0:_.commonAncestorContainer.parentElement;if(_&&y){const i=_.getBoundingClientRect(),n=p.getBoundingClientRect();let s=0;if((0,o.C)(y,"HTMLElement")){const e=y.getBoundingClientRect(),t=new Range;t.setStart(y,0),t.setEnd(y,1);s=t.getBoundingClientRect().top-e.top}if(this._predictionHasWrappedOntoNewLineAtStartOfTile&&(null===(d=this.prediction)||void 0===d?void 0:d.annotationId)!==e.annotationId&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0),t<this._predictionUpdate)return;if(v!==this._paragraphTextExtractor.getParagraphText(e.tileId)){this._predictionDisplayText=void 0;const t=this._predictionUpdate+1;return this._predictionUpdate=t,void await this.determineIfPredictionIsValidAndApply(e,t)}const r=void 0===this._prediction;if(this._prediction=e,this._predictionParentElement=p,this._predictionContentEditableParentElement=m,this._predictionDisplayLocation={x:i.right-n.left,y:i.top-s-n.top},f.substring(g)===this._predictionDisplayText)return;this._predictionDisplayText=f.substring(g),r&&(this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e)),this._onUpdate&&this._onUpdate()}else await this.clearCurrentPrediction(e,"unable to determine range for prediction",b.R8.NotSeen)}};E=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(r.H)),(0,n.__param)(1,(0,g.W)(a.n)),(0,n.__param)(2,(0,g.W)(l.g)),(0,n.__param)(3,(0,g.W)(d.m)),(0,n.__param)(4,(0,g.W)(_.o)),(0,n.__param)(5,(0,g.W)(I.w)),(0,n.__param)(6,(0,g.W)(C.b)),(0,n.__param)(7,(0,g.W)(c.M5)),(0,n.__param)(8,(0,g.W)(S.d)),(0,n.__param)(9,(0,g.W)(u.o)),(0,n.__param)(10,(0,p.l)()),(0,n.__param)(10,(0,g.W)(f.A)),(0,n.__param)(11,(0,p.l)()),(0,n.__param)(11,(0,g.W)(v.V)),(0,n.__param)(12,(0,p.l)()),(0,n.__param)(12,(0,g.W)(y.Y))],E)},36427:(e,t,i)=>{if(i.d(t,{k:()=>o}),2063!=i.j)var n=i(99614);const s=e=>!(void 0===e.isScopingEnabled&&void 0===e.showSeparator),o=e=>{if(e.length>0&&e.some(s))return e;const t=e.findIndex((e=>{var t;return(null===(t=e.suggestions[0])||void 0===t?void 0:t.type)===n.c.Scope}));return-1!==t?(e[t]=Object.assign(Object.assign({},e[t]),{isScopingEnabled:!1,showSeparator:!0}),e.concat(e.splice(t,1))):e}},42190:(e,t,i)=>{if(i.r(t),i.d(t,{CritiqueCallout:()=>n.r,CritiqueCalloutStateStore:()=>s.b,FOOTER_FRE_PAGE_ID:()=>l.Id,FocusZoneId:()=>o.u,FooterFre:()=>u.b,FooterFreModule:()=>f.B,FooterFreStore:()=>c.o,IPredictionStateStore:()=>C.Tc,InlineSuggestions:()=>g.V,InlineSuggestionsCalloutPortal:()=>p.b,InlineSuggestionsWebUXModule:()=>v.Q,InlineSuggestionsWithCallout:()=>m.$,InsertionPredictionStateStore:()=>S.l,LanguageAutoDetectionFRE:()=>d.a,LanguageAutoDetectionFRECallout:()=>l.sy,LayeredPrediction:()=>b.q,LayeredPredictionStateStore:()=>T.O,MultilingualFre:()=>y.R,MultilingualFreStore:()=>I.S,NudgeCallout:()=>E._,PredictionCoreModule:()=>_.B,PredictionDismissalReason:()=>C.R8,UndoCallout:()=>r.$,UndoCalloutStateStore:()=>a.f,UndoQuerySelectorClass:()=>a.g,critiqueCalloutDeps:()=>n.h,getEccUxReplacement:()=>h.Nt,getEccUxReplacementUX:()=>h.cu,langAutoDetectFooterId:()=>l.lP,undoCalloutDeps:()=>r.v}),2063!=i.j)var n=i(21114);if(2063!=i.j)var s=i(67873);if(2063!=i.j)var o=i(80910);if(2063!=i.j)var r=i(83342);if(2063!=i.j)var a=i(38444);if(2063!=i.j)var l=i(29638);if(2063!=i.j)var d=i(70600);if(2063!=i.j)var c=i(60152);if(2063!=i.j)var u=i(30805);if(2063!=i.j)var h=i(46520);if(2063!=i.j)var g=i(24896);if(2063!=i.j)var p=i(9539);if(2063!=i.j)var m=i(20710);if(2063!=i.j)var f=i(35737);if(2063!=i.j)var v=i(84692);if(2063!=i.j)var _=i(66932);if(2063!=i.j)var y=i(92325);if(2063!=i.j)var I=i(91528);if(2063!=i.j)var C=i(10250);if(2063!=i.j)var S=i(25254);if(2063!=i.j)var b=i(56314);if(2063!=i.j)var T=i(41736);if(2063!=i.j)var E=i(76213)},90223:(e,t,i)=>{if(i.d(t,{kd:()=>s}),2063!=i.j)var n=i(94147);function s(e,t){if(t)return t.OnCanvasCalloutStrings[e];return(0,n.$)().getString("OnCanvasCalloutStrings",e)}},94147:(e,t,i)=>{i.d(t,{$:()=>o,Y:()=>s});const n=(()=>{const e=(()=>{if("undefined"==typeof globalThis){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window}return globalThis})();return void 0===e.Office&&(e.Office={}),void 0===e.Office.Editor&&(e.Office.Editor={}),e})().Office.Editor;function s(e){n.stringProvider=e}function o(){return n.stringProvider}},6807:(e,t,i)=>{var n;i.d(t,{h:()=>n}),function(e){e.Undefined="Undefined",e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.FeatureSuppression="FeatureSuppression",e.AtAGlance="AtAGlance",e.BxPromo="BxPromo",e.ContentCreation="ContentCreation",e.CritiqueUpsell="CritiqueUpsell",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.PremiumSquigglesPreview="PremiumSquigglesPreview",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview",e.TonalRewriteFre="TonalRewriteFre",e.WritersUnblock="WritersUnblock",e.AIFeedback="AIFeedback"}(n||(n={}))},13290:(e,t,i)=>{var n;i.d(t,{q:()=>n}),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(n||(n={}))},30154:(e,t,i)=>{if(i.d(t,{C:()=>o}),2063!=i.j)var n=i(54863);var s=i(58651);class o{constructor(e){this._loggerSettings=e}logData(e){this._loggerSettings.logToConsole&&s.log((0,n.v)(e))}}},84523:(e,t,i)=>{i.d(t,{V:()=>c});var n=i(78185),s=i(53357),o=i(45242),r=i(40705),a=i(6807),l=i(13290),d=i(54863);class c{constructor(e,t,i=!1,s=new n.M){this.kpisEnabled=i,this._oTelTelemetryLogger=s;const{logGroupName:o,tenant:r}=e,{tenantName:a,ariaTenantToken:l,nexusTenantToken:d}=r;this._logGroupName=o,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${a}`,l,d),this._namespace=`Office.${a}.${o}`}logEvent(e,t,i,n,r,u,h,g,p){const m=i===a.h.Undefined?t:`${i}.${t}`;if(n===l.q.Debug)return;const f=[(0,s.Ug)("Tag",e),(0,s.Ug)("Level",n)];r&&f.push((0,s.m9)(null!=p?p:"Data",(0,d.v)(r))),f.forEach((e=>e.classification=o.o.DataClassification.SystemMetadata)),this.uploadEvent(m,f,null!=u?u:c.DEFAULT_SAMPLING_POLICY,null!=h?h:c.DEFAULT_DIAGNOSTIC_LEVEL,null!=g?g:c.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,i,n,a){if(!this.kpisEnabled)return;const l=`KPIs.${e}`,d=[(0,s.m9)("Entity_Id",t),(0,s.LK)("IsPremium",n)];a&&d.push((0,s.m9)("Data",JSON.stringify(a))),d.forEach((e=>e.classification=o.o.DataClassification.SystemMetadata));const c=r.A.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:i});d.push(...c),this.uploadEvent(l,d,o.o.SamplingPolicy.CriticalUsage,o.o.DiagnosticLevel.RequiredServiceData,o.o.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,i,n,s=[]){const o=null!=t?t:c.DEFAULT_SAMPLING_POLICY,r=null!=i?i:c.DEFAULT_DIAGNOSTIC_LEVEL,a=null!=n?n:c.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,s,o,r,a)}createActivity(e,t,i){const n=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(n),eventFlags:null!=i?i:{dataCategories:o.o.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,i,n,s){const r=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:r,dataFields:t,eventFlags:{dataCategories:s,diagnosticLevel:n,costPriority:o.o.CostPriority.Normal,persistencePriority:o.o.PersistencePriority.Normal,samplingPolicy:i}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}}c.DEFAULT_SAMPLING_POLICY=o.o.SamplingPolicy.Measure,c.DEFAULT_DIAGNOSTIC_LEVEL=o.o.DiagnosticLevel.RequiredServiceData,c.DEFAULT_DATA_CATEGORIES=o.o.DataCategories.ProductServiceUsage},54863:(e,t,i)=>{function n(e){return e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e)}i.d(t,{v:()=>n})},95542:(e,t,i)=>{i.d(t,{C:()=>l,L:()=>a});var n=i(81762),s=i(30154);const o=new class{constructor(e=!1){this.useConsoleLogger=e,this._consoleLogger=new s.C({logToConsole:!0})}logEvent(e,t,i,n,s,o,r,a){const l=`${i}.${t}`;this.useConsoleLogger&&this._consoleLogger.logData({message:l,data:s})}logKpi(e,t,i,n,s){const o=`KPIs.${e}`;this.useConsoleLogger&&this._consoleLogger.logData({kpiEvent:`${o}.${t}`,engagement:i,data:s})}logStandaloneMetric(e,t,i,n,s){this.useConsoleLogger&&this._consoleLogger.logData({standaloneMetric:e})}createActivity(e,t){const i=`${t}.${e}`;return this.useConsoleLogger&&this._consoleLogger.logData({activity:i}),{cv:new n.CV(""),setResult:()=>{},endNow:()=>{},createChildActivity:()=>{throw new Error("Not implemented")},telemetryProperties:{},dataFields:[],eventName:"",eventFlags:{}}}};let r;function a(e){r=e}function l(){return r||o}},87414:(e,t,i)=>{i.d(t,{UC:()=>q,YQ:()=>o,h1:()=>W,ZP:()=>se,SV:()=>n,O1:()=>oe.O,w:()=>A,Cx:()=>D,iN:()=>R,yF:()=>F});var n,s=i(76729);!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(n||(n={}));const o=(0,s.f)("IThemeStore"),r=new Map([[n.light,{fill:{color:"#424242"}}],[n.dark,{fill:{color:"#FFFFFF"}}],[n.highContrast,{fill:{color:"#FFFFFF"}}]]),a="CopilotEccIcon",l=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#A19F9D"},border:"#FFFFFF",text:{resting:"#201F1E",disabled:"#A19F9D"},tag:{resting:"#605E5C"},altText:{resting:"#605E5C"},icon:{resting:"#797775",disabled:"#A19F9D"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A4EBC"},rewriteText:{resting:"#5A4EBC"},suggestionMenuHoverBackground:"#F3F2F1",header:"#3B3A39",subheader:"#605E5C",dialogText:"#605E5C",iconText:"#605E5C",contextText:"#605E5C",errorText:"#FF0000",separator:"#E1DFDD",focusRing:"#201F1E",link:"#1651AA",linkPressed:"#13458F",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},addOnFooterBackground:"#F3F2F1",upsellFooterColor:"#EFF6FC",addOnFooterMessage:"#201F1E",premiumEmphasis:"#185ABD",addOnAction:"#185ABD",editorIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",pressed:"#13458F",disabled:"#A19F9D"},focusRing:"#201F1E"}}],[n.dark,{background:{resting:"#1B1A19",hover:"#252423",pressed:"#292827",disabled:"#797775"},border:"#1B1A19",text:{resting:"#FAF9F8",disabled:"#797775"},tag:{resting:"#A19F9D"},altText:{resting:"#A19F9D"},icon:{resting:"#A19F9D",disabled:"#797775"},altIcon:{resting:"#616161",hover:"#82ABF1",pressed:"#82ABF1",disabled:"#797775"},grammarText:{resting:"#99AAF5"},refinementText:{resting:"#ADA2F2"},rewriteText:{resting:"#ADA2F2"},suggestionMenuHoverBackground:"#252423",header:"#C8C6C4",subheader:"#A19F9D",dialogText:"#A19F9D",iconText:"#A19F9D",contextText:"#A19F9D",errorText:"#FF0000",separator:"#484644",focusRing:"#C8C6C4",link:"#3D7CE8",linkPressed:"#598FEC",branding:{type:"IconAndTextButton",background:{resting:"#1B1A19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},addOnFooterBackground:"#252423",upsellFooterColor:"#092C47",addOnFooterMessage:"#FAF9F8",premiumEmphasis:"#598FEC",addOnAction:"#598FEC",editorIcon:"#598FEC",correctionHighlight:"#095E09",helpLink:{text:{resting:"#3D7CE8",hover:"#598FEC",pressed:"#598FEC",disabled:"#797775"},focusRing:"#C8C6C4"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},border:"#FFFFFF",text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tag:{resting:"#FFFFFF",hover:"#000000"},altText:{resting:"#FFFFFF",hover:"#000000"},icon:{resting:"#FFFFFF",disabled:"#FFFFFF"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},grammarText:{resting:"#FFFFFF",hover:"#000000"},refinementText:{resting:"#FFFFFF",hover:"#000000"},rewriteText:{resting:"#FFFFFF"},suggestionMenuHoverBackground:"#000000",header:"#FFFFFF",subheader:"#FFFFFF",dialogText:"#FFFFFF",iconText:"#FFFFFF",contextText:"#FFFFFF",errorText:"#FFFFFF",separator:"#FFFFFF",focusRing:"#1AEBFF",link:"#FFFF01",linkPressed:"#FFFF01",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},addOnFooterBackground:"#000000",upsellFooterColor:"#000000",addOnFooterMessage:"#FFFFFF",premiumEmphasis:"#FFFFFF",addOnAction:"#FFFFFF",editorIcon:"#FFFFFF",correctionHighlight:"#FFFFFF",helpLink:{text:{resting:"#FFFF01",hover:"#FFFF01",pressed:"#FFFF01",disabled:"#FFFF01"},focusRing:"#FFFF01"},callout:{borderColor:"#FFFFFF"}}]]),d="CritiqueCallout";var c=i(13263),u=i(43196);const h=new Map([[n.light,{background:{resting:u.kd.white,hover:"#F5F5F5",pressed:"#CFE4FA"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:u.kd.gray190,disabled:"#707070"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},actionButtonForeground:{resting:"#0078D4"},highlightingBorderColor:u.kd.gray190,branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},highlighting:"#EBF3FC",altText:{resting:u.kd.gray130},shimmer:{shimmerColor:u.kd.gray20,shimmerWaveColor:u.kd.gray30},scroll:{thumbColor:"#676767"},tooltip:{directionHint:c.A8.rightCenter},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#EBEBEB"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}}],[n.dark,{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD"},footerButtonBackground:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},text:{resting:u.kd.white,disabled:"#707070"},highlightingBorderColor:u.kd.white,altText:{resting:"#D6D6D6"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#115EA3",branding:{type:"IconAndTextButton",background:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#FFFFFF80"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF",directionHint:c.A8.rightCenter},tag:{background:"#082338",textColor:"#62ABF5"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#3D3D3D"},meetingBanner:{backgroundColor:"#141414",text:"#ffffff",iconPrimaryColor:"#adadad",borderColor:"#666666"},noSuggestions:{descriptionTextColor:"#707070",item:{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD",disabled:void 0},text:{resting:"#598FEC"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}]]),g="ExpandedInlineSuggestion",p=new Map([[n.light,{background:"linear-gradient(93.85deg, #EEF3FB 58.87%, #EAE9FF 100%)",buttonBackground:"white",textColor:"#323130",linkColor:"#2E6AC5",dismissColor:"#323130",iconColor:"#185ABD",newTag:{shadow:"0px 1.6px 3.56px 0px rgba(0, 0, 0, 0.13)",background:"#FFFFFF",textColor:"#185ABD"},pagination:{textColor:"#185ABD",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#FFFFFF",textColor:"#201F1E"}}],[n.dark,{background:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",buttonBackground:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",textColor:"white",linkColor:"#82ABF1",dismissColor:"white",iconColor:"#82ABF1",newTag:{background:"#82ABF1",textColor:"#0C2145"},pagination:{textColor:"#82ABF1",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#1B1A19",textColor:"#FFFFFF"},shimmer:{shimmerColor:"#052865"}}]]),m="FooterFRE",f=new Map([[n.light,{background:"#0F6CBD",shadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",borderRadius:{default:"4px",disabled:"0px"},display:"flex",width:"32px",height:"32px",color:"#FFFFFF",border:"none",critiqueCategoryText:{fontFamily:"segoeUi",fontSize:"14px",lineHeight:"18px",fontStyle:"normal",padding:"5px",color:"#000000",minWidth:"unset",fontWeight:"600"},critiqueCategoryNumber:{fontFamily:"bahnschrift",font:"bahnschrift",fontSize:"16px",lineHeight:"18px"},indicatorButtonText:{textAlign:"center",fontFamily:"bahnschrift",fontSize:"16px",minWidth:"unset",padding:"12px",fontWeight:"600"},suggestionNumberText:{padding:"3px"}}]]),v="Indicator",_=new Map([[n.light,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[n.dark,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),y="InlineNudgeBubble",I=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:"#201F1E",disabled:"#A19F9D"},altIcon:{resting:"#424242",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},altText:{resting:"#605E5C"},highlightingBorderColor:"#201F1E",actionButtonForeground:{resting:"#0078D4"},highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},noSuggestions:{descriptionTextColor:"#616161",item:{background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},text:{resting:"#185ABD",disabled:"#707070"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5"}}}],[n.dark,{background:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},footerButtonBackground:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#FAF9F8",disabled:"#797775"},highlightingBorderColor:"#FAF9F8",altText:{resting:"#A19F9D"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929",branding:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#D6D6D6"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF"},tag:{background:"#082338",textColor:"#62ABF5"},noSuggestions:{descriptionTextColor:"#D6D6D6",item:{background:{resting:"#1b1a19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#296FE6",disabled:"#707070"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},footerButtonBackground:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},highlightingBorderColor:"#FFFFFF",altText:{resting:"#FFFFFF",hover:"#000000"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},shimmer:{shimmerColor:"#FFFFFF",shimmerWaveColor:"#FFFFFF"},scroll:{thumbColor:"#FFFFFF"},tooltip:{backgroundColor:"#000000",textColor:"#FFFFFF"},callout:{border:"1px solid #FFFFFF"},userAvatarBorderColor:"#FFFFFF",noSuggestions:{descriptionTextColor:"#FFFFFF",item:{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF"}}}]]),C="InlineSuggestion",S=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#f3f2f1"},text:{resting:"#605e5c"}}],[n.dark,{background:{resting:"#333333",hover:"#212121"},text:{resting:"#f4f4f4"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),b="NudgeBubble",T=new Map([[n.light,{background:{resting:"#f5f5f5",hover:"#eee8ff"},text:"#605e5c",entityText:{resting:"#707070",hover:"#8230ff"},tabText:"#707070",highlightColor:"#EBEBEB"}],[n.dark,{background:{resting:"#141414",hover:"#4c0aa8"},text:"#a19f9d",entityText:{resting:"#999999",hover:"#a375ff"},tabText:"#999999"}],[n.highContrast,{background:{resting:"#000000",hover:"#8ee3f0"},text:"#3FF23F",entityText:{resting:"#ffffff",hover:"#263b50"},tabText:"#3FF23F"}]]),E="PredictionContainer",N=new Map([[n.light,{background:"#FFFFFF",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#424242",altText:"#616161"}],[n.dark,{background:"#1B1A19",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#FFFFFF",altText:"#ADADAD"}]]),x="SquiggleTooltip",w=new Map([[n.light,{primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#FFFFFF",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000",highContrast:{iconPrimaryColor:"#000000",iconSecondaryColor:"#FFFFFF"}}],[n.dark,{primaryButtonBackground:{resting:"#2899F5",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#1B1A19",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#1B1A19",hover:"#484644",pressed:"#979593"},defaultButtonText:{resting:"#FAF9F8",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",backgroundColor:"#1B1A19",link:"#2899F5",titleColor:"#FAF9F8",descriptionColor:"#C8C6C4",rejectionTextColor:"#FAF9F8",primaryButtonFocusRing:"#FFFFFF",defaultButtonFocusRing:"#FFFFFF",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#043862",dismissButtonColor:"#FAF9F8",highContrast:{iconPrimaryColor:"#FFFFFF",iconSecondaryColor:"#000000"}}]]),L="TonalFirstRunCard",D=new Map([[d,l],[g,h],[m,p],[C,I],[a,r],[L,w],[b,S],[y,_],[E,T],[x,N],[v,f]]),F={critiqueCalloutComponentName:d,expandedInlineSuggestionComponentName:g,footerFreComponentName:m,inlineSuggestionComponentName:C,copilotEccIconComponentName:a,indicatorComponentName:v,tonalFreComponentName:L,nudgeBubbleComponentName:b,inlineNudgeBubbleComponentName:y,predictionContainerComponentName:E,squiggleTooltipComponentName:x},A=new Map([[b,{}]]),R={critiqueCalloutComponentName:d,footerFreComponentName:m,nudgeBubbleComponentName:b,advancedEditorSettingsDialogComponentName:"AdvancedEditorSettingsDialog"},q=(0,s.f)("IStyleStore");var P=i(79490),O=i(19728);function k(e){return new Map(JSON.parse(JSON.stringify(Array.from(e))))}function z(e){return e&&"object"==typeof e&&Object.keys(e).length?JSON.parse(JSON.stringify(e)):e}var M=i(29906),j=i(18574);let W=class{constructor(){this._styles=new Map,(0,j.Gn)(this)}get components(){return Array.from(this._styles.keys())}getComponentStyle(e){const t=this._styles.get(e);return t&&z(t)}updateComponentStyle(e,t){this._styles.set(e,t)}};(0,P.__decorate)([O.observable],W.prototype,"_styles",void 0),(0,P.__decorate)([O.computed],W.prototype,"components",null),(0,P.__decorate)([O.action],W.prototype,"getComponentStyle",null),(0,P.__decorate)([O.action],W.prototype,"updateComponentStyle",null),W=(0,P.__decorate)([(0,M._)()],W);var B=i(10994);const U=(0,B.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1",inputBackground:"F5F5F5",primaryButtonBackground:"#185ABD",primaryButtonBackgroundHovered:"#1651AA",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),H=(0,B.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#858585",primaryButtonText:"#ffffff",disabledText:"#858585",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA",inputBackground:"#141414",primaryButtonBackground:"#1651AA",primaryButtonBackgroundHovered:"#185ABD",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var V;let G;function Q(){return null!=G?G:G=(0,O.observable)({theme:U})}!function(e){e.Light="Light",e.Dark="Dark"}(V||(V={}));const K=(0,O.action)((e=>{Q().theme=e===V.Dark?H:U}));(0,O.action)((e=>{Q().theme=e}));var $=i(77380),J=i(59556),Z=i(11804),Y=i(83010),X=i(68262),ee=i(97790),te=i(5208),ie=i(54958),ne=i(36982);let se=class extends J.z{constructor(e){super(),this.hostSettings=e,this._defaultTheme=n.light,this._currentTheme=n.light,this._themes=new Map,this._fluentThemes=new Map,this._isDarkMode=void 0,this._useFluentV9=void 0,(0,j.Gn)(this),this._isDarkMode=this.hostSettings.isDarkMode,this._currentTheme=this.hostSettings.isDarkMode?n.dark:n.light,this._currentTheme===n.dark?K(V.Dark):K(V.Light),this._useFluentV9=this.hostSettings.useFluentV9}get isDarkMode(){return this._isDarkMode}get defaultTheme(){return this._defaultTheme}get currentTheme(){return this._currentTheme}get components(){return Array.from(this._themes.keys())}getFluentActiveTheme(){let e={};if(!this._fluentThemes.get(this._currentTheme))switch(this._currentTheme){case n.light:e=X.o;break;case n.dark:e=ee.C;break;case n.highContrast:e=te.e}const t=this._currentTheme===n.light?0:this._currentTheme===n.dark?1:this._currentTheme===n.highContrast?2:0,i=Object.assign(Object.assign(Object.assign({},$.Ks[t]),$.zw[t]),$.nY[t]);return Object.assign(Object.assign({},e),i)}getComponentActiveTheme(e,t=!1){var i;if(this._useFluentV9&&!t)return;const n=this._themes.get(e),s=z(null==n?void 0:n.get(this._currentTheme)),o=z(null==n?void 0:n.get(this._defaultTheme));return null!==(i=null!=s?s:o)&&void 0!==i?i:void 0}getComponentThemes(e){const t=this._themes.get(e);return t&&k(t)}updateDarkMode(e){this._isDarkMode=e,this.hostSettings.isDarkMode=e,this._currentTheme=e?n.dark:n.light,K(e?V.Dark:V.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateDefaultTheme(e){this._defaultTheme=e,this.publishEvent("defaultThemeUpdated",this._defaultTheme)}updateCurrentTheme(e){this._currentTheme=e,e===n.dark?K(V.Dark):K(V.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateComponentThemes(e,t){this._themes.set(e,k(t)),this.publishEvent("themesUpdated",{})}updateFluentThemes(e){this._fluentThemes.clear();for(const[t,i]of e)this._fluentThemes.set(t,i);this.publishEvent("fluentThemesUpdated",{})}getExpandedEccFluentTheme(){switch(this._currentTheme){case n.light:default:return ie.u;case n.dark:return ne.k}}};(0,P.__decorate)([O.observable],se.prototype,"_defaultTheme",void 0),(0,P.__decorate)([O.observable],se.prototype,"_currentTheme",void 0),(0,P.__decorate)([O.observable],se.prototype,"_themes",void 0),(0,P.__decorate)([O.observable],se.prototype,"_fluentThemes",void 0),(0,P.__decorate)([O.observable],se.prototype,"_isDarkMode",void 0),(0,P.__decorate)([O.observable],se.prototype,"_useFluentV9",void 0),(0,P.__decorate)([O.computed],se.prototype,"isDarkMode",null),(0,P.__decorate)([O.computed],se.prototype,"defaultTheme",null),(0,P.__decorate)([O.computed],se.prototype,"currentTheme",null),(0,P.__decorate)([O.computed],se.prototype,"components",null),(0,P.__decorate)([O.action],se.prototype,"updateDarkMode",null),(0,P.__decorate)([O.action],se.prototype,"updateDefaultTheme",null),(0,P.__decorate)([O.action],se.prototype,"updateCurrentTheme",null),(0,P.__decorate)([O.action],se.prototype,"updateComponentThemes",null),(0,P.__decorate)([O.action],se.prototype,"updateFluentThemes",null),se=(0,P.__decorate)([(0,M._)(),(0,P.__param)(0,(0,Y.W)(Z.n))],se);var oe=i(96686)},15679:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});var n=i(41668),s=i.n(n);function o(){return s()('(()=>{var t={750:t=>{var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},n=-1;e.Diff=function(t,e){return[t,e]},e.prototype.diff_main=function(t,n,i,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var s=r;if(null==t||null==n)throw new Error("Null input. (diff_main)");if(t==n)return t?[new e.Diff(0,t)]:[];void 0===i&&(i=!0);var h=i,f=this.diff_commonPrefix(t,n),a=t.substring(0,f);t=t.substring(f),n=n.substring(f),f=this.diff_commonSuffix(t,n);var l=t.substring(t.length-f);t=t.substring(0,t.length-f),n=n.substring(0,n.length-f);var g=this.diff_compute_(t,n,h,s);return a&&g.unshift(new e.Diff(0,a)),l&&g.push(new e.Diff(0,l)),this.diff_cleanupMerge(g),g},e.prototype.diff_compute_=function(t,i,r,s){var h;if(!t)return[new e.Diff(1,i)];if(!i)return[new e.Diff(n,t)];var f=t.length>i.length?t:i,a=t.length>i.length?i:t,l=f.indexOf(a);if(-1!=l)return h=[new e.Diff(1,f.substring(0,l)),new e.Diff(0,a),new e.Diff(1,f.substring(l+a.length))],t.length>i.length&&(h[0][0]=h[2][0]=n),h;if(1==a.length)return[new e.Diff(n,t),new e.Diff(1,i)];var g=this.diff_halfMatch_(t,i);if(g){var o=g[0],c=g[1],u=g[2],p=g[3],d=g[4],_=this.diff_main(o,u,r,s),b=this.diff_main(c,p,r,s);return _.concat([new e.Diff(0,d)],b)}return r&&t.length>100&&i.length>100?this.diff_lineMode_(t,i,s):this.diff_bisect_(t,i,s)},e.prototype.diff_lineMode_=function(t,i,r){var s=this.diff_linesToChars_(t,i);t=s.chars1,i=s.chars2;var h=s.lineArray,f=this.diff_main(t,i,!1,r);this.diff_charsToLines_(f,h),this.diff_cleanupSemantic(f),f.push(new e.Diff(0,""));for(var a=0,l=0,g=0,o="",c="";a<f.length;){switch(f[a][0]){case 1:g++,c+=f[a][1];break;case n:l++,o+=f[a][1];break;case 0:if(l>=1&&g>=1){f.splice(a-l-g,l+g),a=a-l-g;for(var u=this.diff_main(o,c,!1,r),p=u.length-1;p>=0;p--)f.splice(a,0,u[p]);a+=u.length}g=0,l=0,o="",c=""}a++}return f.pop(),f},e.prototype.diff_bisect_=function(t,i,r){for(var s=t.length,h=i.length,f=Math.ceil((s+h)/2),a=f,l=2*f,g=new Array(l),o=new Array(l),c=0;c<l;c++)g[c]=-1,o[c]=-1;g[a+1]=0,o[a+1]=0;for(var u=s-h,p=u%2!=0,d=0,_=0,b=0,v=0,m=0;m<f&&!((new Date).getTime()>r);m++){for(var w=-m+d;w<=m-_;w+=2){for(var x=a+w,M=(E=w==-m||w!=m&&g[x-1]<g[x+1]?g[x+1]:g[x-1]+1)-w;E<s&&M<h&&t.charAt(E)==i.charAt(M);)E++,M++;if(g[x]=E,E>s)_+=2;else if(M>h)d+=2;else if(p){if((k=a+u-w)>=0&&k<l&&-1!=o[k])if(E>=(D=s-o[k]))return this.diff_bisectSplit_(t,i,E,M,r)}}for(var y=-m+b;y<=m-v;y+=2){for(var D,k=a+y,A=(D=y==-m||y!=m&&o[k-1]<o[k+1]?o[k+1]:o[k-1]+1)-y;D<s&&A<h&&t.charAt(s-D-1)==i.charAt(h-A-1);)D++,A++;if(o[k]=D,D>s)v+=2;else if(A>h)b+=2;else if(!p){if((x=a+u-y)>=0&&x<l&&-1!=g[x]){var E;M=a+(E=g[x])-x;if(E>=(D=s-D))return this.diff_bisectSplit_(t,i,E,M,r)}}}}return[new e.Diff(n,t),new e.Diff(1,i)]},e.prototype.diff_bisectSplit_=function(t,e,n,i,r){var s=t.substring(0,n),h=e.substring(0,i),f=t.substring(n),a=e.substring(i),l=this.diff_main(s,h,!1,r),g=this.diff_main(f,a,!1,r);return l.concat(g)},e.prototype.diff_linesToChars_=function(t,e){var n=[],i={};function r(t){for(var e="",r=0,h=-1,f=n.length;h<t.length-1;){-1==(h=t.indexOf("\\n",r))&&(h=t.length-1);var a=t.substring(r,h+1);(i.hasOwnProperty?i.hasOwnProperty(a):void 0!==i[a])?e+=String.fromCharCode(i[a]):(f==s&&(a=t.substring(r),h=t.length),e+=String.fromCharCode(f),i[a]=f,n[f++]=a),r=h+1}return e}n[0]="";var s=4e4,h=r(t);return s=65535,{chars1:h,chars2:r(e),lineArray:n}},e.prototype.diff_charsToLines_=function(t,e){for(var n=0;n<t.length;n++){for(var i=t[n][1],r=[],s=0;s<i.length;s++)r[s]=e[i.charCodeAt(s)];t[n][1]=r.join("")}},e.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(s,r)==e.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonOverlap_=function(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):n<i&&(e=e.substring(0,n));var r=Math.min(n,i);if(t==e)return r;for(var s=0,h=1;;){var f=t.substring(r-h),a=e.indexOf(f);if(-1==a)return s;h+=a,0!=a&&t.substring(r-h)!=e.substring(0,h)||(s=h,h++)}},e.prototype.diff_halfMatch_=function(t,e){if(this.Diff_Timeout<=0)return null;var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;var r=this;function s(t,e,n){for(var i,s,h,f,a=t.substring(n,n+Math.floor(t.length/4)),l=-1,g="";-1!=(l=e.indexOf(a,l+1));){var o=r.diff_commonPrefix(t.substring(n),e.substring(l)),c=r.diff_commonSuffix(t.substring(0,n),e.substring(0,l));g.length<c+o&&(g=e.substring(l-c,l)+e.substring(l,l+o),i=t.substring(0,n-c),s=t.substring(n+o),h=e.substring(0,l-c),f=e.substring(l+o))}return 2*g.length>=t.length?[i,s,h,f,g]:null}var h,f,a,l,g,o=s(n,i,Math.ceil(n.length/4)),c=s(n,i,Math.ceil(n.length/2));return o||c?(h=c?o&&o[4].length>c[4].length?o:c:o,t.length>e.length?(f=h[0],a=h[1],l=h[2],g=h[3]):(l=h[0],g=h[1],f=h[2],a=h[3]),[f,a,l,g,h[4]]):null},e.prototype.diff_cleanupSemantic=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=0,l=0,g=0,o=0;f<t.length;)0==t[f][0]?(r[s++]=f,a=g,l=o,g=0,o=0,h=t[f][1]):(1==t[f][0]?g+=t[f][1].length:o+=t[f][1].length,h&&h.length<=Math.max(a,l)&&h.length<=Math.max(g,o)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,f=--s>0?r[s-1]:-1,a=0,l=0,g=0,o=0,h=null,i=!0)),f++;for(i&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),f=1;f<t.length;){if(t[f-1][0]==n&&1==t[f][0]){var c=t[f-1][1],u=t[f][1],p=this.diff_commonOverlap_(c,u),d=this.diff_commonOverlap_(u,c);p>=d?(p>=c.length/2||p>=u.length/2)&&(t.splice(f,0,new e.Diff(0,u.substring(0,p))),t[f-1][1]=c.substring(0,c.length-p),t[f+1][1]=u.substring(p),f++):(d>=c.length/2||d>=u.length/2)&&(t.splice(f,0,new e.Diff(0,c.substring(0,d))),t[f-1][0]=1,t[f-1][1]=u.substring(0,u.length-d),t[f+1][0]=n,t[f+1][1]=c.substring(d),f++),f++}f++}},e.prototype.diff_cleanupSemanticLossless=function(t){function n(t,n){if(!t||!n)return 6;var i=t.charAt(t.length-1),r=n.charAt(0),s=i.match(e.nonAlphaNumericRegex_),h=r.match(e.nonAlphaNumericRegex_),f=s&&i.match(e.whitespaceRegex_),a=h&&r.match(e.whitespaceRegex_),l=f&&i.match(e.linebreakRegex_),g=a&&r.match(e.linebreakRegex_),o=l&&t.match(e.blanklineEndRegex_),c=g&&n.match(e.blanklineStartRegex_);return o||c?5:l||g?4:s&&!f&&a?3:f||a?2:s||h?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var r=t[i-1][1],s=t[i][1],h=t[i+1][1],f=this.diff_commonSuffix(r,s);if(f){var a=s.substring(s.length-f);r=r.substring(0,r.length-f),s=a+s.substring(0,s.length-f),h=a+h}for(var l=r,g=s,o=h,c=n(r,s)+n(s,h);s.charAt(0)===h.charAt(0);){r+=s.charAt(0),s=s.substring(1)+h.charAt(0),h=h.substring(1);var u=n(r,s)+n(s,h);u>=c&&(c=u,l=r,g=s,o=h)}t[i-1][1]!=l&&(l?t[i-1][1]=l:(t.splice(i-1,1),i--),t[i][1]=g,o?t[i+1][1]=o:(t.splice(i+1,1),i--))}i++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\\s/,e.linebreakRegex_=/[\\r\\n]/,e.blanklineEndRegex_=/\\n\\r?\\n$/,e.blanklineStartRegex_=/^\\r?\\n\\r?\\n/,e.prototype.diff_cleanupEfficiency=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=!1,l=!1,g=!1,o=!1;f<t.length;)0==t[f][0]?(t[f][1].length<this.Diff_EditCost&&(g||o)?(r[s++]=f,a=g,l=o,h=t[f][1]):(s=0,h=null),g=o=!1):(t[f][0]==n?o=!0:g=!0,h&&(a&&l&&g&&o||h.length<this.Diff_EditCost/2&&a+l+g+o==3)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,h=null,a&&l?(g=o=!0,s=0):(f=--s>0?r[s-1]:-1,g=o=!1),i=!0)),f++;i&&this.diff_cleanupMerge(t)},e.prototype.diff_cleanupMerge=function(t){t.push(new e.Diff(0,""));for(var i,r=0,s=0,h=0,f="",a="";r<t.length;)switch(t[r][0]){case 1:h++,a+=t[r][1],r++;break;case n:s++,f+=t[r][1],r++;break;case 0:s+h>1?(0!==s&&0!==h&&(0!==(i=this.diff_commonPrefix(a,f))&&(r-s-h>0&&0==t[r-s-h-1][0]?t[r-s-h-1][1]+=a.substring(0,i):(t.splice(0,0,new e.Diff(0,a.substring(0,i))),r++),a=a.substring(i),f=f.substring(i)),0!==(i=this.diff_commonSuffix(a,f))&&(t[r][1]=a.substring(a.length-i)+t[r][1],a=a.substring(0,a.length-i),f=f.substring(0,f.length-i))),r-=s+h,t.splice(r,s+h),f.length&&(t.splice(r,0,new e.Diff(n,f)),r++),a.length&&(t.splice(r,0,new e.Diff(1,a)),r++),r++):0!==r&&0==t[r-1][0]?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,h=0,s=0,f="",a=""}""===t[t.length-1][1]&&t.pop();var l=!1;for(r=1;r<t.length-1;)0==t[r-1][0]&&0==t[r+1][0]&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)==t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),l=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),l=!0)),r++;l&&this.diff_cleanupMerge(t)},e.prototype.diff_xIndex=function(t,e){var i,r=0,s=0,h=0,f=0;for(i=0;i<t.length&&(1!==t[i][0]&&(r+=t[i][1].length),t[i][0]!==n&&(s+=t[i][1].length),!(r>e));i++)h=r,f=s;return t.length!=i&&t[i][0]===n?f:f+(e-h)},e.prototype.diff_prettyHtml=function(t){for(var e=[],i=/&/g,r=/</g,s=/>/g,h=/\\n/g,f=0;f<t.length;f++){var a=t[f][0],l=t[f][1].replace(i,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(h,"&para;<br>");switch(a){case 1:e[f]=\'<ins style="background:#e6ffe6;">\'+l+"</ins>";break;case n:e[f]=\'<del style="background:#ffe6e6;">\'+l+"</del>";break;case 0:e[f]="<span>"+l+"</span>"}}return e.join("")},e.prototype.diff_text1=function(t){for(var e=[],n=0;n<t.length;n++)1!==t[n][0]&&(e[n]=t[n][1]);return e.join("")},e.prototype.diff_text2=function(t){for(var e=[],i=0;i<t.length;i++)t[i][0]!==n&&(e[i]=t[i][1]);return e.join("")},e.prototype.diff_levenshtein=function(t){for(var e=0,i=0,r=0,s=0;s<t.length;s++){var h=t[s][0],f=t[s][1];switch(h){case 1:i+=f.length;break;case n:r+=f.length;break;case 0:e+=Math.max(i,r),i=0,r=0}}return e+=Math.max(i,r)},e.prototype.diff_toDelta=function(t){for(var e=[],i=0;i<t.length;i++)switch(t[i][0]){case 1:e[i]="+"+encodeURI(t[i][1]);break;case n:e[i]="-"+t[i][1].length;break;case 0:e[i]="="+t[i][1].length}return e.join("\\t").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(t,i){for(var r=[],s=0,h=0,f=i.split(/\\t/g),a=0;a<f.length;a++){var l=f[a].substring(1);switch(f[a].charAt(0)){case"+":try{r[s++]=new e.Diff(1,decodeURI(l))}catch(t){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var g=parseInt(l,10);if(isNaN(g)||g<0)throw new Error("Invalid number in diff_fromDelta: "+l);var o=t.substring(h,h+=g);"="==f[a].charAt(0)?r[s++]=new e.Diff(0,o):r[s++]=new e.Diff(n,o);break;default:if(f[a])throw new Error("Invalid diff operation in diff_fromDelta: "+f[a])}}if(h!=t.length)throw new Error("Delta length ("+h+") does not equal source text length ("+t.length+").");return r},e.prototype.match_main=function(t,e,n){if(null==t||null==e||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,t.length)),t==e?0:t.length?t.substring(n,n+e.length)==e?n:this.match_bitap_(t,e,n):-1},e.prototype.match_bitap_=function(t,e,n){if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(e),r=this;function s(t,i){var s=t/e.length,h=Math.abs(n-i);return r.Match_Distance?s+h/r.Match_Distance:h?1:s}var h=this.Match_Threshold,f=t.indexOf(e,n);-1!=f&&(h=Math.min(s(0,f),h),-1!=(f=t.lastIndexOf(e,n+e.length))&&(h=Math.min(s(0,f),h)));var a,l,g=1<<e.length-1;f=-1;for(var o,c=e.length+t.length,u=0;u<e.length;u++){for(a=0,l=c;a<l;)s(u,n+l)<=h?a=l:c=l,l=Math.floor((c-a)/2+a);c=l;var p=Math.max(1,n-l+1),d=Math.min(n+l,t.length)+e.length,_=Array(d+2);_[d+1]=(1<<u)-1;for(var b=d;b>=p;b--){var v=i[t.charAt(b-1)];if(_[b]=0===u?(_[b+1]<<1|1)&v:(_[b+1]<<1|1)&v|(o[b+1]|o[b])<<1|1|o[b+1],_[b]&g){var m=s(u,b-1);if(m<=h){if(h=m,!((f=b-1)>n))break;p=Math.max(1,2*n-f)}}}if(s(u+1,n)>h)break;o=_}return f},e.prototype.match_alphabet_=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=0;for(n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e},e.prototype.patch_addContext_=function(t,n){if(0!=n.length){if(null===t.start2)throw Error("patch not initialized");for(var i=n.substring(t.start2,t.start2+t.length1),r=0;n.indexOf(i)!=n.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,i=n.substring(t.start2-r,t.start2+t.length1+r);r+=this.Patch_Margin;var s=n.substring(t.start2-r,t.start2);s&&t.diffs.unshift(new e.Diff(0,s));var h=n.substring(t.start2+t.length1,t.start2+t.length1+r);h&&t.diffs.push(new e.Diff(0,h)),t.start1-=s.length,t.start2-=s.length,t.length1+=s.length+h.length,t.length2+=s.length+h.length}},e.prototype.patch_make=function(t,i,r){var s,h;if("string"==typeof t&&"string"==typeof i&&void 0===r)s=t,(h=this.diff_main(s,i,!0)).length>2&&(this.diff_cleanupSemantic(h),this.diff_cleanupEfficiency(h));else if(t&&"object"==typeof t&&void 0===i&&void 0===r)h=t,s=this.diff_text1(h);else if("string"==typeof t&&i&&"object"==typeof i&&void 0===r)s=t,h=i;else{if("string"!=typeof t||"string"!=typeof i||!r||"object"!=typeof r)throw new Error("Unknown call format to patch_make.");s=t,h=r}if(0===h.length)return[];for(var f=[],a=new e.patch_obj,l=0,g=0,o=0,c=s,u=s,p=0;p<h.length;p++){var d=h[p][0],_=h[p][1];switch(l||0===d||(a.start1=g,a.start2=o),d){case 1:a.diffs[l++]=h[p],a.length2+=_.length,u=u.substring(0,o)+_+u.substring(o);break;case n:a.length1+=_.length,a.diffs[l++]=h[p],u=u.substring(0,o)+u.substring(o+_.length);break;case 0:_.length<=2*this.Patch_Margin&&l&&h.length!=p+1?(a.diffs[l++]=h[p],a.length1+=_.length,a.length2+=_.length):_.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(a,c),f.push(a),a=new e.patch_obj,l=0,c=u,g=o)}1!==d&&(g+=_.length),d!==n&&(o+=_.length)}return l&&(this.patch_addContext_(a,c),f.push(a)),f},e.prototype.patch_deepCopy=function(t){for(var n=[],i=0;i<t.length;i++){var r=t[i],s=new e.patch_obj;s.diffs=[];for(var h=0;h<r.diffs.length;h++)s.diffs[h]=new e.Diff(r.diffs[h][0],r.diffs[h][1]);s.start1=r.start1,s.start2=r.start2,s.length1=r.length1,s.length2=r.length2,n[i]=s}return n},e.prototype.patch_apply=function(t,e){if(0==t.length)return[e,[]];t=this.patch_deepCopy(t);var i=this.patch_addPadding(t);e=i+e+i,this.patch_splitMax(t);for(var r=0,s=[],h=0;h<t.length;h++){var f,a,l=t[h].start2+r,g=this.diff_text1(t[h].diffs),o=-1;if(g.length>this.Match_MaxBits?-1!=(f=this.match_main(e,g.substring(0,this.Match_MaxBits),l))&&(-1==(o=this.match_main(e,g.substring(g.length-this.Match_MaxBits),l+g.length-this.Match_MaxBits))||f>=o)&&(f=-1):f=this.match_main(e,g,l),-1==f)s[h]=!1,r-=t[h].length2-t[h].length1;else if(s[h]=!0,r=f-l,g==(a=-1==o?e.substring(f,f+g.length):e.substring(f,o+this.Match_MaxBits)))e=e.substring(0,f)+this.diff_text2(t[h].diffs)+e.substring(f+g.length);else{var c=this.diff_main(g,a,!1);if(g.length>this.Match_MaxBits&&this.diff_levenshtein(c)/g.length>this.Patch_DeleteThreshold)s[h]=!1;else{this.diff_cleanupSemanticLossless(c);for(var u,p=0,d=0;d<t[h].diffs.length;d++){var _=t[h].diffs[d];0!==_[0]&&(u=this.diff_xIndex(c,p)),1===_[0]?e=e.substring(0,f+u)+_[1]+e.substring(f+u):_[0]===n&&(e=e.substring(0,f+u)+e.substring(f+this.diff_xIndex(c,p+_[1].length))),_[0]!==n&&(p+=_[1].length)}}}}return[e=e.substring(i.length,e.length-i.length),s]},e.prototype.patch_addPadding=function(t){for(var n=this.Patch_Margin,i="",r=1;r<=n;r++)i+=String.fromCharCode(r);for(r=0;r<t.length;r++)t[r].start1+=n,t[r].start2+=n;var s=t[0],h=s.diffs;if(0==h.length||0!=h[0][0])h.unshift(new e.Diff(0,i)),s.start1-=n,s.start2-=n,s.length1+=n,s.length2+=n;else if(n>h[0][1].length){var f=n-h[0][1].length;h[0][1]=i.substring(h[0][1].length)+h[0][1],s.start1-=f,s.start2-=f,s.length1+=f,s.length2+=f}if(0==(h=(s=t[t.length-1]).diffs).length||0!=h[h.length-1][0])h.push(new e.Diff(0,i)),s.length1+=n,s.length2+=n;else if(n>h[h.length-1][1].length){f=n-h[h.length-1][1].length;h[h.length-1][1]+=i.substring(0,f),s.length1+=f,s.length2+=f}return i},e.prototype.patch_splitMax=function(t){for(var i=this.Match_MaxBits,r=0;r<t.length;r++)if(!(t[r].length1<=i)){var s=t[r];t.splice(r--,1);for(var h=s.start1,f=s.start2,a="";0!==s.diffs.length;){var l=new e.patch_obj,g=!0;for(l.start1=h-a.length,l.start2=f-a.length,""!==a&&(l.length1=l.length2=a.length,l.diffs.push(new e.Diff(0,a)));0!==s.diffs.length&&l.length1<i-this.Patch_Margin;){var o=s.diffs[0][0],c=s.diffs[0][1];1===o?(l.length2+=c.length,f+=c.length,l.diffs.push(s.diffs.shift()),g=!1):o===n&&1==l.diffs.length&&0==l.diffs[0][0]&&c.length>2*i?(l.length1+=c.length,h+=c.length,g=!1,l.diffs.push(new e.Diff(o,c)),s.diffs.shift()):(c=c.substring(0,i-l.length1-this.Patch_Margin),l.length1+=c.length,h+=c.length,0===o?(l.length2+=c.length,f+=c.length):g=!1,l.diffs.push(new e.Diff(o,c)),c==s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(c.length))}a=(a=this.diff_text2(l.diffs)).substring(a.length-this.Patch_Margin);var u=this.diff_text1(s.diffs).substring(0,this.Patch_Margin);""!==u&&(l.length1+=u.length,l.length2+=u.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=u:l.diffs.push(new e.Diff(0,u))),g||t.splice(++r,0,l)}}},e.prototype.patch_toText=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e.join("")},e.prototype.patch_fromText=function(t){var i=[];if(!t)return i;for(var r=t.split("\\n"),s=0,h=/^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/;s<r.length;){var f=r[s].match(h);if(!f)throw new Error("Invalid patch string: "+r[s]);var a=new e.patch_obj;for(i.push(a),a.start1=parseInt(f[1],10),""===f[2]?(a.start1--,a.length1=1):"0"==f[2]?a.length1=0:(a.start1--,a.length1=parseInt(f[2],10)),a.start2=parseInt(f[3],10),""===f[4]?(a.start2--,a.length2=1):"0"==f[4]?a.length2=0:(a.start2--,a.length2=parseInt(f[4],10)),s++;s<r.length;){var l=r[s].charAt(0);try{var g=decodeURI(r[s].substring(1))}catch(t){throw new Error("Illegal escape in patch_fromText: "+g)}if("-"==l)a.diffs.push(new e.Diff(n,g));else if("+"==l)a.diffs.push(new e.Diff(1,g));else if(" "==l)a.diffs.push(new e.Diff(0,g));else{if("@"==l)break;if(""!==l)throw new Error(\'Invalid patch mode "\'+l+\'" in: \'+g)}s++}}return i},(e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var t,e=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:t="+";break;case n:t="-";break;case 0:t=" "}e[i+1]=t+encodeURI(this.diffs[i][1])+"\\n"}return e.join("").replace(/%20/g," ")},t.exports=e,t.exports.diff_match_patch=e,t.exports.DIFF_DELETE=n,t.exports.DIFF_INSERT=1,t.exports.DIFF_EQUAL=0}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(750);const e=new t.diff_match_patch;e.Diff_Timeout=0;const i=(t,e)=>t.index>=0?(t.index=e,t):e;addEventListener("message",(t=>{"get-url"!==t.data[0]?(t=>{try{const r=[],s=t.data[0],h=t.data[1],f=t.data[2],a=e.diff_main(s,h);1===a.length&&0===a[0][0]&&t.ports[0].postMessage({result:f});let l=0,g=0,o=0,c=0,u=0,p=0;for(const t of a){const e=t[0],s=t[1].length;switch(e){case 0:u=s,p=s;break;case 1:u=0,p=s;break;case-1:o+=s;continue}g+=o,o=0;for(let t=l;t<f.length;t+=1){const s=(n=f[t]).index>=0?n.index:n;if(s<c)throw new Error("Indices are not sorted!");if(!(s>=c&&s<c+p))break;r[t]=i(f[t],0===e?s+g-c:g),l+=1}if(l===f.length)break;g+=u,c+=p}for(let t=l;t<f.length;t+=1)r[t]=i(f[t],g);t.ports[0].postMessage({result:r})}catch(e){t.ports[0].postMessage({error:e})}var n})(t):t.ports[0].postMessage({url:self.location.href})}),!1)})()})();\n//# sourceMappingURL=index-readjuster-worker.worker.js.map',"Worker",void 0,i.p+"index-readjuster-worker.worker.js")}},44275:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Spelling"}}')},10214:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":" ","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":""},"Typing errors":{"LocalizedName":" ","IsImplemented":false},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":" ","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":" "},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":" "},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":" "},"Spelling":{"LocalizedName":" ","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":" "},"Sensitive Geopolitical References":{"LocalizedName":"  ","IsImplemented":false}}')},64240:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},32721:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Orfoqrafiya","IsImplemented":true}}')},55637:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},35289:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},89192:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},411:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Pravopis"}}')},1483:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Ortografia"}}')},62656:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Vstinost","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Konzistentn psan tvary","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Nediskriminujc jazyk"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Peklepy"},"Clarity":{"LocalizedName":"Jasnost","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"Peformulovn","IsImplemented":false},"Error Corrections":{"LocalizedName":"Oprava chyb","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Slovn zsoba","IsImplemented":true},"Grammar":{"LocalizedName":"Gramatika","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Formln vyjadovn"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Interpunkce","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"Pravopis","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Pravopis"},"Resume":{"LocalizedName":"ivotopis","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Citliv geopolitick odkazy"}}')},63966:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Sillafu"}}')},38963:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Kortfattethed","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Konsistente staveformer"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Inkluderende sprog","IsImplemented":true},"Typing errors":{"LocalizedName":"Tastefejl","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":"Klarhed"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Omskrivning"},"Error Corrections":{"LocalizedName":"Fejlkorrigering","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Ordvalg","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammatik"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Formelt sprog","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Tegnstning"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skriftkonventioner"},"Spelling":{"LocalizedName":"Stavekontrol","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Curriculum Vitae"},"Sensitive Geopolitical References":{"LocalizedName":"Flsomme geopolitiske betegnelser","IsImplemented":false}}')},46493:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Prgnanz","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Konsistente Schreibformen","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Neutrale Sprache"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Tippfehler"},"Clarity":{"IsImplemented":true,"LocalizedName":"Verstndlichkeit"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Akronyme"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Umschreibung"},"Error Corrections":{"LocalizedName":"Fehlerkorrigierungen","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Wortwahl","IsImplemented":true},"Grammar":{"LocalizedName":"Grammatik","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formelle Sprache"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Interpunktion","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Schreibkonventionen"},"Spelling":{"LocalizedName":"Rechtschreibung","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Lebenslauf"},"Sensitive Geopolitical References":{"LocalizedName":"Problematische geopolitische Bezeichnungen","IsImplemented":true}}')},39811:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},85811:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"Improves readability","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Sensitive Geopolitical References","IsImplemented":true},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions help make your writing more formal by reducing casual wording."},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Error Corrections"},"Resume":{"IsImplemented":true,"LocalizedName":"Resume"},"Fluency":{"LocalizedName":"Improves flow","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Spelling"},"Inspire Me":{"LocalizedName":"Different phrasing","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":"Different phrasing"},"Punctuation Conventions":{"LocalizedName":"Punctuation Conventions","IsImplemented":true},"Formality":{"IsImplemented":true,"LocalizedName":"Formality"},"Inclusiveness":{"LocalizedName":"Inclusiveness","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"These suggestions provide alternative ways of wording a phrase or sentence.","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording."},"Conciseness":{"LocalizedName":"Conciseness","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"More concise","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Consistent Written Forms","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typing Errors"},"RewriteFormality":{"LocalizedName":"More formal","IsImplemented":false},"ConcisenessFullExplanation":{"LocalizedName":"The goal of these suggestions is to express an idea clearly, without extra words.","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulary"},"Rewrite":{"LocalizedName":"Rewrite","IsImplemented":false},"Perspectives":{"LocalizedName":"Perspectives","IsImplemented":true},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."},"Grammar":{"LocalizedName":"Grammar","IsImplemented":true},"Writing Conventions":{"LocalizedName":"Writing Conventions","IsImplemented":false},"Uncommon Words":{"LocalizedName":"Uncommon Words","IsImplemented":true},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronyms"},"Clarity":{"IsImplemented":true,"LocalizedName":"Clarity"}}')},4058:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":"The goal of these suggestions is to express an idea clearly, without extra words."},"Conciseness":{"IsImplemented":true,"LocalizedName":"Conciseness"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Consistent Written Forms"},"Sentence Inspire Me":{"LocalizedName":"Different phrasing","IsImplemented":false},"Fluency":{"LocalizedName":"Improves flow","IsImplemented":false},"Uncommon Words":{"LocalizedName":"Uncommon Words","IsImplemented":true},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inclusiveness"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typing Errors"},"Clarity":{"LocalizedName":"Clarity","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":"Improves readability"},"Inspire Me":{"IsImplemented":false,"LocalizedName":"Different phrasing"},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronyms"},"Rewrite":{"LocalizedName":"Rewrite","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Error Corrections"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions help make your writing more formal by reducing casual wording."},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulary"},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammar"},"SimplerFullExplanation":{"LocalizedName":"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording.","IsImplemented":false},"Perspectives":{"IsImplemented":true,"LocalizedName":"Perspectives"},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."},"Formality":{"LocalizedName":"Formality","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions provide alternative ways of wording a phrase or sentence."},"Punctuation Conventions":{"IsImplemented":true,"LocalizedName":"Punctuation Conventions"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":"More concise"},"RewriteFormality":{"IsImplemented":false,"LocalizedName":"More formal"},"Writing Conventions":{"LocalizedName":"Writing Conventions","IsImplemented":false},"Spelling":{"LocalizedName":"Spelling","IsImplemented":true},"Resume":{"IsImplemented":true,"LocalizedName":"Resume"},"Sensitive Geopolitical References":{"LocalizedName":"Sensitive Geopolitical References","IsImplemented":true}}')},951:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Concisin","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Coherencia","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Lenguaje no discriminatorio","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Erratas"},"Clarity":{"LocalizedName":"Claridad","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acrnimos"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reformulaciones"},"Error Corrections":{"LocalizedName":"Correccin de errores","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulario"},"Grammar":{"LocalizedName":"Gramtica","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Lenguaje formal","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Puntuacin","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenciones de escritura"},"Spelling":{"LocalizedName":"Ortografa","IsImplemented":true},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Referencias geopolticas sensibles","IsImplemented":true}}')},14278:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Referencias geopolticas sensibles","IsImplemented":true},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correccin de errores"},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ortografa","IsImplemented":true},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Puntuacin"},"Formality":{"IsImplemented":true,"LocalizedName":"Lenguaje formal"},"Inclusiveness":{"LocalizedName":"Lenguaje no discriminatorio","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisin","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Coherencia","IsImplemented":false},"Typing errors":{"LocalizedName":"Erratas","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulario"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reformulaciones"},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramtica"},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenciones de escritura"},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acrnimos"},"Clarity":{"LocalizedName":"Claridad","IsImplemented":true}}')},64018:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"igekirjakontroll"}}')},62157:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true}}')},36475:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},86677:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":"Ytimekkyys"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Yhteninen kirjoitusasu"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Syrjiv kielenkytt","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Lyntivirheet"},"Clarity":{"IsImplemented":true,"LocalizedName":"Selkeys"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Uudelleenkirjoitus"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Virheen korjaukset"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Sanasto","IsImplemented":false},"Grammar":{"LocalizedName":"Kielioppi","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Virallinen kieli","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Vlimerkit"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Kirjoitustyyli"},"Spelling":{"IsImplemented":true,"LocalizedName":"Oikeinkirjoituksen tarkistus"},"Resume":{"LocalizedName":"Ansioluettelo","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Ongelmalliset geopoliittiset viittaukset"}}')},65451:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Rfrences gopolitiques sensibles","IsImplemented":true},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"Correction d\'erreurs","IsImplemented":false},"Resume":{"LocalizedName":"CV","IsImplemented":true},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Orthographe"},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Ponctuation"},"Formality":{"LocalizedName":"Langage formel","IsImplemented":true},"Inclusiveness":{"LocalizedName":"Langage non-discriminant","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concision","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Cohrence"},"Typing errors":{"LocalizedName":"Fautes de frappe","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulaire"},"Rewrite":{"LocalizedName":"Reformulations","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Grammar":{"LocalizedName":"Grammaire","IsImplemented":true},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Conventions"},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronymes"},"Clarity":{"IsImplemented":false,"LocalizedName":"Clart"}}')},69919:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Concision","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Cohrence","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Langage non-discriminant"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Fautes de frappe"},"Clarity":{"LocalizedName":"Clart","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronymes"},"Rewrite":{"LocalizedName":"Reformulations","IsImplemented":false},"Error Corrections":{"LocalizedName":"Correction d\'erreurs","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulaire"},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammaire"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Langage formel"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Ponctuation","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Conventions"},"Spelling":{"LocalizedName":"Orthographe","IsImplemented":true},"Resume":{"IsImplemented":true,"LocalizedName":"CV"},"Sensitive Geopolitical References":{"LocalizedName":"Rfrences gopolitiques sensibles","IsImplemented":true}}')},35169:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Litri"}}')},76227:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Litreachadh","IsImplemented":true}}')},4594:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Ortografa","IsImplemented":true}}')},77280:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},66817:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Sifellin","IsImplemented":true}}')},23716:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":false,"LocalizedName":" "},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":" "},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":" "},"Typing errors":{"IsImplemented":false,"LocalizedName":" "},"Clarity":{"LocalizedName":" ","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":" "},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":"  "},"Grammar":{"LocalizedName":"","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":" "},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":" ","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":" "},"Spelling":{"IsImplemented":true,"LocalizedName":" "},"Resume":{"IsImplemented":false,"LocalizedName":" "},"Sensitive Geopolitical References":{"LocalizedName":" - ","IsImplemented":false}}')},76109:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"IsImplemented":false,"LocalizedName":""},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},70767:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Provjera pravopisa"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},20701:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Tmrsg"},"Consistent Written Forms":{"LocalizedName":"Konzisztens rott alak","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Politikailag korrekt nyelvhasznlat","IsImplemented":true},"Typing errors":{"LocalizedName":"Gpelsi hibk","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"rthetsg"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"trs"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Hiba javts"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Szvlaszts"},"Grammar":{"IsImplemented":true,"LocalizedName":"Nyelvtan"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Nyelvhasznlat","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Kzpontozsi szoksok","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Helyesrsi szoksok"},"Spelling":{"IsImplemented":true,"LocalizedName":"Helyesrs"},"Resume":{"LocalizedName":"nletrajz","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"rzkeny geopolitikai kifejezse","IsImplemented":false}}')},29880:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},54181:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ejaan"}}')},66564:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Nsupe","IsImplemented":true}}')},25567:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Stafsetning","IsImplemented":true}}')},12261:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisione","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Coerenza formale"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Linguaggio inclusivo","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Errori di digitazione"},"Clarity":{"IsImplemented":false,"LocalizedName":"Chiarezza"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Riscrittura"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correzione degli errori"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Scelte lessicali","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammatica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Registro formale","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Punteggiatura"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenzioni di scrittura"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Curriculum Vitae"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Riferimenti geopolitici problematici"}}')},54378:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":true},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":""},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":""},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"IsImplemented":true,"LocalizedName":""},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":true},"Spelling":{"IsImplemented":false,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":true}}')},47043:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},51032:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":" ","IsImplemented":true}}')},10243:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},58855:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":" ","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"  "},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":" ","IsImplemented":false},"Error Corrections":{"LocalizedName":" ","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":" "},"Grammar":{"LocalizedName":"","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":" ","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":" "},"Spelling":{"LocalizedName":"","IsImplemented":true},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"  "}}')},64749:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},64353:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},44210:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Orthographie","IsImplemented":true}}')},4835:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Rayba","IsImplemented":true}}')},63151:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Pareizrakstba","IsImplemented":true}}')},36945:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Takikupu"}}')},28071:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},58679:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},53225:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},41641:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ejaan"}}')},56333:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ortografija"}}')},26408:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Presisjon","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Konsekvente skriftformer","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Inkluderende sprk","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Skrivefeil"},"Clarity":{"IsImplemented":false,"LocalizedName":"Klarhet"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"Omskriving","IsImplemented":false},"Error Corrections":{"LocalizedName":"Feilretting","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Ordvalg"},"Grammar":{"LocalizedName":"Grammatikk","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Formelt sprk"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Tegnsetting"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skriftnormer"},"Spelling":{"IsImplemented":true,"LocalizedName":"Stavekontroll"},"Resume":{"IsImplemented":false,"LocalizedName":"CV"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Geopolitisk sensitive sprkformer"}}')},99750:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},56467:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Beknoptheid"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Consistent taalgebruik"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inclusief taalgebruik"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typefouten"},"Clarity":{"IsImplemented":true,"LocalizedName":"Duidelijkheid"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Herschrijving"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Foutcorrectie"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Woordkeuze","IsImplemented":true},"Grammar":{"LocalizedName":"Grammatica","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formeel taalgebruik"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Interpunctie","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Schrijfregels"},"Spelling":{"LocalizedName":"Spelling","IsImplemented":true},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Gevoelige geopolitieke referenties"}}')},34484:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Stavekontroll"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},82998:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Mopeleto"}}')},1075:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},93594:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},7595:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Zwizo"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Spjno zapisu"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Jzyk rwnociowy","IsImplemented":true},"Typing errors":{"LocalizedName":"Literwki","IsImplemented":false},"Clarity":{"LocalizedName":"Przejrzysto","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Przeformuowanie"},"Error Corrections":{"LocalizedName":"Korekta bdw","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Sownictwo"},"Grammar":{"LocalizedName":"Gramatyka","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Jzyk literacki","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Interpunkcja","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Konwencje zapisu"},"Spelling":{"IsImplemented":true,"LocalizedName":"Pisownia"},"Resume":{"LocalizedName":"yciorys","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Poprawno geopolityczna","IsImplemented":false}}')},54063:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},13183:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Conciso","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Escritura coerente"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Linguagem inclusiva","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Erros de digitao"},"Clarity":{"LocalizedName":"Clareza","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"Reescrita","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correo de erros"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Escolha vocabular","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramtica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Linguagem formal","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Pontuao","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Normas de escrita"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"LocalizedName":"Currculo","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Referncias geopolticas delicadas"}}')},66939:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Conciso","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Escritura coerente"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Linguagem inclusiva","IsImplemented":true},"Typing errors":{"LocalizedName":"Erros de digitao","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Clareza"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reescrita"},"Error Corrections":{"LocalizedName":"Correo de erros","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Escolha vocabular"},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramtica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Linguagem formal"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Pontuao"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Normas de escrita"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Currculo"},"Sensitive Geopolitical References":{"LocalizedName":"Referncias geopolticas delicadas","IsImplemented":false}}')},53403:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},15653:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":false,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Verificare ortografic"},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},98501:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":" ","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":" ","IsImplemented":true},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"LocalizedName":"","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":" ","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"   ","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":" "},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":" "},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"LocalizedName":"  ","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":" "}}')},6581:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Imyandikire"}}')},42278:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},97339:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Pravopis","IsImplemented":true}}')},74914:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":false,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"rkovanje"},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},67714:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Drejtshkrimi"}}')},49058:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},5415:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Pravopis","IsImplemented":true}}')},75e3:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Precision"},"Consistent Written Forms":{"LocalizedName":"Konsekventa skriftformer","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inkluderande sprkbruk"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Skrivfel"},"Clarity":{"IsImplemented":true,"LocalizedName":"Klarhet"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Omskrivning"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Felkorrigering"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Ordval"},"Grammar":{"LocalizedName":"Grammatik","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formellt sprk"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Interpunktion"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skrivregler"},"Spelling":{"LocalizedName":"Stavning","IsImplemented":true},"Resume":{"LocalizedName":"Meritfrteckning","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Knsliga geopolitiska referenser","IsImplemented":false}}')},55301:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Tahajia","IsImplemented":true}}')},58993:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},18853:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},11723:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":""},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},70940:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Mopeleto"}}')},32159:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Yalnlk","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Tutarl yazm biimleri"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Ayrmc dil"},"Typing errors":{"LocalizedName":"Yazm hatalar","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Aklk"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Yeniden yazm"},"Error Corrections":{"LocalizedName":"Hata dzeltmeleri","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Szckler","IsImplemented":true},"Grammar":{"LocalizedName":"Gramer","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":false,"LocalizedName":"Resm dil"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Noktalama iaretleri kurallar"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Yazm kurallar"},"Spelling":{"LocalizedName":"Yazm Denetimi","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"z gemi"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Hassas jeopolitik ifadeler"}}')},41406:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},84185:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},15727:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},47993:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Imlo"}}')},75636:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Chnh t"}}')},23532:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Bindiin","IsImplemented":true}}')},44994:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Upelo"}}')},56972:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"yw y r","IsImplemented":true}}')},78272:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"IsImplemented":true,"LocalizedName":""},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":false,"LocalizedName":""},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},77808:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":false,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},17496:e=>{e.exports=JSON.parse('{"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":""}}')},78129:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Isipelingi"}}')}}]);
//# sourceMappingURL=editor.js.map