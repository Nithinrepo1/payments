"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[3062],{52817:(e,t,s)=>{var o,n,i,r;s.d(t,{Av:()=>i,OY:()=>o,rN:()=>r,ut:()=>n}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop",e[e.LoopAppOnly=104]="LoopAppOnly",e[e.BapLowPrivilege=105]="BapLowPrivilege",e[e.IC3AppPop=106]="IC3AppPop",e[e.PowerPlatformApiGateway=107]="PowerPlatformApiGateway",e[e.OdspNotifyAppPop=108]="OdspNotifyAppPop",e[e.MIPSyncService=109]="MIPSyncService",e[e.RightsManagementServices=110]="RightsManagementServices",e[e.TCAV2AppPop=111]="TCAV2AppPop",e[e.SubstrateLLMLowPrivilege=112]="SubstrateLLMLowPrivilege",e[e.SubstrateSearchLowPrivilege=113]="SubstrateSearchLowPrivilege",e[e.CloudPolicyServiceAppPop=114]="CloudPolicyServiceAppPop",e[e.TCAV2LowPrivilege=115]="TCAV2LowPrivilege",e[e.AiHubServicesAppPop=116]="AiHubServicesAppPop",e[e.TMRAppOnly=117]="TMRAppOnly",e[e.PacmanAppPop=118]="PacmanAppPop",e[e.AugloopAlternativeIdentity=119]="AugloopAlternativeIdentity",e[e.SpoAppOnly=120]="SpoAppOnly",e[e.DataverseLowPrivilege=121]="DataverseLowPrivilege"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(n||(n={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(i||(i={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(r||(r={}))},26341:(e,t,s)=>{var o;s.d(t,{O:()=>o,Q:()=>n}),function(e){e.dev="dev",e.int="int",e.test="test",e.dogfood="dogfood",e.msit="msit",e.prod="prod",e.gcc="gcc",e.dod="dod",e.gccHigh="gcchigh",e.ag08="ag08",e.ag09="ag09",e.gallatin="gallatin"}(o||(o={}));const n={gcc:"fairfax"}},38263:(e,t,s)=>{var o;s.d(t,{Z:()=>o}),function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(o||(o={}))},43992:(e,t,s)=>{s.r(t),s.d(t,{ActivationTier:()=>M.XJ,AsyncBoundaryLoaderKind:()=>r,AsyncBoundaryLoaderType:()=>i,AsyncBoundaryRequest:()=>L,AuthTokenType:()=>n.OY,BillingDomain:()=>M.mk,CoherencyError:()=>E,DataCategories:()=>w.b,DiagnosticLevel:()=>w.E,Environment:()=>a.O,EnvironmentNameTranslation:()=>a.Q,EventStatus:()=>C,ExpectedError:()=>T.D,FilteringAsyncBoundaryRequest:()=>P,GridRangeFilter:()=>p,GridRangeSampleFilter:()=>g,GridSubtreeFilter:()=>u,InputStage:()=>M.RN,ItemCardinality:()=>N,ItemRole:()=>I,LoggingLevel:()=>S.q,ModelIteratingAsyncBoundaryRequest:()=>B,OAuth2GrantFlow:()=>n.Av,OAuth2V2LoginStatus:()=>n.rN,Pattern:()=>f,PrefilterActionType:()=>M.Uy,PrefilterType:()=>M.gd,ProducerWaitPolicy:()=>M.qW,RequestedContextCardinality:()=>M.in,SequentialItemFilter:()=>l,SerializationProfile:()=>v,SetMessagesOperationType:()=>o,TriggerCondition:()=>M.ov,Type:()=>h.Z,UnitType:()=>M.ni,UserType:()=>n.ut,WorkflowCancellationReason:()=>A,WorkflowDefinitionScope:()=>T.T,WorkflowExecutionThrottleResponse:()=>k,WorkflowKind:()=>M.wC,WorkflowStoreType:()=>b,WorkflowVisibility:()=>M.Y$,gatewayType:()=>_,isExceptionMessage:()=>y,stringifyReplacer:()=>d});var o,n=s(52817);!function(e){e[e.Add=1]="Add",e[e.Update=2]="Update",e[e.Delete=3]="Delete"}(o||(o={}));var i,r,a=s(26341),c=s(82076);class l{constructor(e){c.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Interfaces_SequentialItemFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return c.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){c.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridSubtreeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return c.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){c.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridRangeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return c.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){c.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridRangeSampleFilter"}static getBaseTypes(){return["AugLoop_Interfaces_GridRangeFilter","AugLoop_Core_ItemFilter"]}static typeGuard(e){return c.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()},function(e){e[e.MastermindAsyncBoundaryLoader=0]="MastermindAsyncBoundaryLoader",e[e.TruncatedModelIteratingLoader=1]="TruncatedModelIteratingLoader",e[e.ExcelAsyncBoundaryLoader=2]="ExcelAsyncBoundaryLoader"}(i||(i={})),function(e){e[e.Filtering=0]="Filtering",e[e.ModelIterating=1]="ModelIterating"}(r||(r={}));var h=s(38263);const d=(e,t)=>"object"==typeof t&&null!==t&&0==Object.keys(t).length?void 0:t;var m=s(77827);const y=e=>null==e||null==e.messageType||e.messageType==m.G.Exception;var f;!function(e){e[e.PubSub=0]="PubSub",e[e.RequestReply=1]="RequestReply"}(f||(f={}));var T=s(55224);const _="Gateway";var C,v,S=s(93364);!function(e){e[e.Active=0]="Active",e[e.Stopped=1]="Stopped",e[e.Paused=2]="Paused"}(C||(C={})),function(e){e[e.JSONB=0]="JSONB",e[e.JSON=1]="JSON",e[e.JSOND=2]="JSOND",e[e.Disabled=3]="Disabled",e[e.COMPRESSEDJSON=4]="COMPRESSEDJSON",e[e.MESSAGEPACK=5]="MESSAGEPACK",e[e.COMPRESSEDMESSAGEPACK=6]="COMPRESSEDMESSAGEPACK"}(v||(v={}));var A,w=s(30157);!function(e){e[e.Other=0]="Other",e[e.DocumentUpdate=1]="DocumentUpdate",e[e.Timeout=2]="Timeout",e[e.CloseSession=3]="CloseSession",e[e.Purge=4]="Purge"}(A||(A={}));var I,N,b,k,M=s(42713);!function(e){e[e.Input=1]="Input",e[e.Output=2]="Output"}(I||(I={})),function(e){e[e.Single=1]="Single",e[e.Any=-1]="Any",e[e.Optional=-2]="Optional",e[e.Some=-3]="Some"}(N||(N={}));class E extends Error{constructor(e="CoherencyError"){super(e),this.__proto__=E.prototype}}!function(e){e[e.WorkflowSession=0]="WorkflowSession",e[e.User=1]="User"}(b||(b={})),function(e){e[e.NoThrottle=0]="NoThrottle",e[e.SoftThrottle=1]="SoftThrottle",e[e.HardThrottle=2]="HardThrottle"}(k||(k={}));class L{constructor(e){c.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Interfaces_AsyncBoundaryRequest"}static getBaseTypes(){return[]}static typeGuard(e){return c.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class P{constructor(e){c.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Interfaces_FilteringAsyncBoundaryRequest"}static getBaseTypes(){return["AugLoop_Interfaces_AsyncBoundaryRequest"]}static typeGuard(e){return c.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class B{constructor(e){c.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Interfaces_ModelIteratingAsyncBoundaryRequest"}static getBaseTypes(){return["AugLoop_Interfaces_AsyncBoundaryRequest"]}static typeGuard(e){return c.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()}},55224:(e,t,s)=>{var o;s.d(t,{D:()=>n,T:()=>o}),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(o||(o={}));class n extends Error{constructor(e="ExpectedError"){super(e),this.__proto__=n.prototype}}},93364:(e,t,s)=>{var o;s.d(t,{q:()=>o}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(o||(o={}))},30157:(e,t,s)=>{var o,n;s.d(t,{E:()=>n,b:()=>o}),function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(o||(o={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(n||(n={}))},42713:(e,t,s)=>{var o,n,i,r,a,c,l,u,p,g,h;s.d(t,{RN:()=>l,Uy:()=>h,XJ:()=>r,Y$:()=>i,gd:()=>g,in:()=>a,mk:()=>n,ni:()=>p,ov:()=>u,qW:()=>c,wC:()=>o}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(o||(o={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(i||(i={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(r||(r={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(a||(a={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(c||(c={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(l||(l={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(u||(u={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(p||(p={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(g||(g={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(h||(h={}))},74044:(e,t,s)=>{s.d(t,{r:()=>r});const{AugLoopTextEncoder:o,AugLoopTextDecoder:n}=(()=>{if("undefined"==typeof TextEncoder){s(95621);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();var i=s(37542).Buffer;class r{static deserialize(e,t=e=>e){if(e[0]!==r.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let s=1;const o=[],n=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;s<e.byteLength;){if(s+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const t=n.getUint32(s);if(s+t+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");void 0!==i&&i.from?o.push(i.from(e.buffer,e.byteOffset+s+4,t)):o.push(new Uint8Array(e.buffer,e.byteOffset+s+4,t)),s+=4+t}if(o.length<1)throw new Error("Invalid Binary: No fragments found");const a=r.textDecoder.decode(o[0]);return JSON.parse(a,((e,s)=>{if("string"==typeof s){if(s.substring(0,r.BINARYKEYWORD.length)===r.BINARYKEYWORD){const e=parseInt(s.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=o.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(o[e+1])}if(s.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return s.substring(r.ESCAPEKEYWORD.length)}return s}))}static serialize(e){const t=[void 0],s=JSON.stringify(e,((e,s)=>ArrayBuffer.isView(s)?(t.push(s),`${r.BINARYKEYWORD}${t.length-2}`):s&&"Buffer"===s.type&&Array.isArray(s.data)?(t.push(new Uint8Array(s.data)),`${r.BINARYKEYWORD}${t.length-2}`):"string"==typeof s&&s.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+s:s));t[0]=r.textEncoder.encode(s);const o=t.reduce(((e,t)=>e+4+t.byteLength),0),n=new Uint8Array(o+1);n[0]=r.IDENTIFIERBYTE;let i=1;const a=new DataView(n.buffer,n.byteOffset,n.byteLength);for(const e of t)a.setUint32(i,e.byteLength),n.set(e,i+4),i+=4+e.byteLength;return n}}r.IDENTIFIERBYTE=3,r.BINARYKEYWORD=":b",r.ESCAPEKEYWORD=":",r.textDecoder=new n,r.textEncoder=new o},10834:(e,t,s)=>{s.d(t,{v:()=>n});var o=s(343);class n extends o.L{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},33957:(e,t,s)=>{s.d(t,{W:()=>o});class o{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<i;e++)r[e]=n[Math.floor(Math.random()*n.length)];return r.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let s;return s=e.endsWith(".0")?new o(e.substring(0,e.length-2)):new o(e),t&&(s.childCount=t),s}newChild(){return++this.childCount,new o(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i=22,r=new Array(i)},54421:(e,t,s)=>{s.r(t),s.d(t,{AnnotationMetaDataChange:()=>d.v,AnonymizedOperation:()=>w,CorrelationContext:()=>u,CorrelationVector:()=>l.W,CustomBlockListLogger:()=>oe,ExtensionCloseReason:()=>W,ExtensionCloseType:()=>L,HttpRequestQueue:()=>r,HttpSocketList:()=>E,Log:()=>o.tG,LogCategory:()=>o.nh,LoggingAggregator:()=>h.D,Operation:()=>n.I,OutboundHttpRequest:()=>k,PrivacyGuardIssue:()=>B,ProcessIdentification:()=>c,ScenarioStats:()=>S,SessionHealthEvent:()=>m.vf,SessionHealthEventAggregation:()=>T,SessionHealthImpact:()=>m.Pq,SessionHealthReason:()=>m.l6,SessionHealthSource:()=>m.aM,SessionIssue:()=>C,Timer:()=>N,WebSocketConnectionEnd:()=>g,argsToString:()=>o.am,createChildCorrelation:()=>J,enter:()=>$,excelExtensionCloseEventName:()=>D,excelExtensionExpectedCloseEventName:()=>x,excelExtensionExpectedErrorEventName:()=>F,excelExtensionUnexpectedCloseEventName:()=>G,excelKeepAliveAggregationName:()=>O,excelKeepAliveMessageName:()=>R,exit:()=>j,getCorrelation:()=>Q,getCorrelationVectorString:()=>K,getNumLoggers:()=>o.OD,initAsyncHooks:()=>z,now:()=>ee.t,resumeCorrelation:()=>X,startChildCorrelation:()=>Y,startCorrelation:()=>Z,tagIdToString:()=>o.ih});var o=s(25765),n=s(89700),i=s(3834);class r extends i.F{getMetrics(){return{HttpRequestQueueV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpRequestQueue"}}var a=s(46578);class c extends a.m{constructor(){super(...arguments),this.eventName="ProcessIdentification"}}var l=s(33957);class u{get sessionKey(){var e;return null===(e=this.sessionDescriptor)||void 0===e?void 0:e.sessionKey}get interactionSessionId(){return this._interactionSessionId}set interactionSessionId(e){if(this._interactionSessionId&&this._interactionSessionId!==e)throw new Error("InteractionSessionId is already set");this._interactionSessionId=e}get interactionId(){return this._interactionId}set interactionId(e){if(this._interactionId&&this._interactionId!==e)throw new Error("InteractionId is already set");this._interactionId=e}constructor(e,t,s,o){var n;this.cv=e,this.sessionDescriptor=t,this.clientMetadata=s,this.workflow=null==o?void 0:o.workflow,this.joinContextId=null==o?void 0:o.joinContextId,this.performanceEvent=null==o?void 0:o.performanceEvent,this.sessionLogsSampled=void 0,this._interactionId=null==o?void 0:o.interactionId,this._interactionSessionId=null==o?void 0:o.interactionSessionId,this.traceId=null==o?void 0:o.traceId,this.disableLogging=null!==(n=null==o?void 0:o.disableLogging)&&void 0!==n&&n}static deserialize(e){if(e)try{const t=JSON.parse(e),s={appName:t.clientAppName,appPlatform:t.clientAppPlatform,releaseAudienceGroup:t.clientReleaseAudienceGroup,flights:t.clientFlights};return new u(new l.W(t.cv),{sessionKey:t.sessionKey,userId:t.userId,mastermindEndpoint:t.mastermindEndpoint},s,{workflow:t.workflow,joinContextId:t.joinContextId,interactionId:t.interactionId,interactionSessionId:t.interactionSessionId,traceId:t.traceId,disableLogging:t.disableLogging})}catch(t){return new u(new l.W(e))}}static fromExisting(e,t,s,o,n){return new u(t||e.cv,s||e.sessionDescriptor,o||e.clientMetadata,{workflow:(null==n?void 0:n.workflow)||e.workflow,joinContextId:(null==n?void 0:n.joinContextId)||e.joinContextId,performanceEvent:(null==n?void 0:n.performanceEvent)||e.performanceEvent,interactionId:(null==n?void 0:n.interactionId)||e.interactionId,interactionSessionId:(null==n?void 0:n.interactionSessionId)||e.interactionSessionId,traceId:(null==n?void 0:n.traceId)||e.traceId,disableLogging:(null==n?void 0:n.disableLogging)||e.disableLogging})}toString(){var e,t;return`${null===(e=this.clientMetadata)||void 0===e?void 0:e.appName};${null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform};${this.sessionKey};${this.cv}`}serialize(){var e,t,s,o,n;const i=null===(e=this.clientMetadata)||void 0===e?void 0:e.appName,r=null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform,a=null===(s=this.clientMetadata)||void 0===s?void 0:s.releaseAudienceGroup,c=null===(o=this.clientMetadata)||void 0===o?void 0:o.flights;return u.stringify(Object.assign(Object.assign({cv:this.cv.toString()},null!==(n=this.sessionDescriptor)&&void 0!==n?n:{}),{clientAppName:i,clientAppPlatform:r,clientReleaseAudienceGroup:a,clientFlights:c,workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging}))}newChild(){return new u(this.cv.newChild(),this.sessionDescriptor,this.clientMetadata,{workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging})}}u.schema={type:"object",properties:{cv:{type:"string"},clientAppName:{type:"string"},clientAppPlatform:{type:"string"},clientReleaseAudienceGroup:{type:"string"},clientFlights:{type:"string"},sessionKey:{type:"string"},userId:{type:"string"},mastermindEndpoint:{type:"string"},workflow:{type:"string"},joinContextId:{type:"string"},interactionId:{type:"string"},interactionSessionId:{type:"string"},traceId:{type:"string"},disableLogging:{type:"boolean"}}},u.stringify=(u.schema,JSON.stringify);var p=s(4694);class g extends p.D{constructor(e,t){super(e),this.eventName="WebSocketConnectionEnd",t&&(this.ClientApp=null==t?void 0:t.appName,this.ClientAppPlatform=null==t?void 0:t.appPlatform,this.ClientAppVersion=null==t?void 0:t.appVersion,this.ClientReleaseAudienceGroup=null==t?void 0:t.releaseAudienceGroup,this.ClientSessionId=null==t?void 0:t.sessionId)}}var h=s(81768),d=s(10834),m=s(97225),y=s(91102);const f=(e,t)=>"reason"===e?m.l6[t]:"impact"===e?m.Pq[t]:t;class T extends y.Z{constructor(e,t){super({sessionHealthEventName:e,count:t.count,successes:t.successes,failures:t.failures,cancellations:t.cancellations,maxDurationMs:t.maxDurationMs,sumDurationMs:t.sumDurationMs,failureBuckets:JSON.stringify(t.failureBuckets,f),firstFailureReason:t.failureBuckets.length>0?m.l6[t.failureBuckets[0].reason]:"",firstFailureImpact:t.failureBuckets.length>0?m.Pq[t.failureBuckets[0].impact]:""}),this.eventName="SessionHealthAggregation",t.firstEvent&&(this.firstEventAffectedWorkflows=t.firstEvent.affectedWorkflows,this.firstEventCount=t.firstEvent.count,this.firstEventDurationMs=t.firstEvent.durationMs,this.firstEventImpact=t.firstEvent.impact,this.firstEventMessage=t.firstEvent.message,this.firstEventReason=t.firstEvent.reason,this.firstEventReasonDependency=t.firstEvent.reasonDependency,this.firstEventSource=t.firstEvent.source,this.firstEventSuccess=t.firstEvent.success),t.lastEvent&&(this.lastEventAffectedWorkflows=t.lastEvent.affectedWorkflows,this.lastEventCount=t.lastEvent.count,this.lastEventDurationMs=t.lastEvent.durationMs,this.lastEventImpact=t.lastEvent.impact,this.lastEventMessage=t.lastEvent.message,this.lastEventReason=t.lastEvent.reason,this.lastEventReasonDependency=t.lastEvent.reasonDependency,this.lastEventSource=t.lastEvent.source,this.lastEventSuccess=t.lastEvent.success)}}var _=s(34854);class C extends _.Q{getMetrics(){return{"SessionIssue.CountV2":{dimensionNames:()=>C.dimensionNames,dimensionValues:this.getDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="SessionIssue",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.modelItemsCountBucket,this.healthBucket,this.healthReason,this.healthSubreason,this.affectedResource,this.affectedSessions,this.suppressionReason]}}C.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ModelItemsCountBucket","HealthBucket","HealthReason","HealthSubreason","AffectedResource","AffectedSessions","SuppressionReason"];var v=s(37264);class S extends v.A{getMetrics(){return{"ScenarioStats.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getDimensionValues(),value:1},"ScenarioStatsWithSuppressions.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getSuppressionsDimensionValues(),value:1},"ScenarioStatsScenario.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getScenarioDimensionValues(),value:1},"ScenarioStatsScenarioWithSuppressions.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getScenarioSuppressionsDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="ScenarioStats",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucket,this.healthReason]}getSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucketWithSuppressions,this.healthReasonWithSuppressions]}getScenarioDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucket,this.scenarioHealthReason]}getScenarioSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucketWithSuppressions,this.scenarioHealthReasonWithSuppressions]}}S.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","HealthBucket","HealthReason"];var A=s(32206);class w extends A.O{constructor(e){if(super(e),this.eventName="AnonymizedOperation",this.allowListedLogs=[508856344,508688156],!this.allowListedLogs.includes(e.tagId))throw new Error("AnonymizedOperations must be allow-listed and reviewed by AugLoop engineering team. Please include your privacy approval in the review.")}}var I=s(72715);class N{constructor(e){null==e?this.reset():this.start=e}diffInMs(){const e=I.hrtime(this.start),t=1e3*e[0]+e[1]/1e6;return Math.floor(t)}diffInUs(){const e=I.hrtime(this.start),t=1e6*e[0]+e[1]/1e3;return Math.floor(t)}reset(){this.start=I.hrtime()}}var b=s(86707);class k extends b.g{getMetrics(){return{"OutboundHttpRequestV2.Wait":{dimensionNames:()=>k.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.wait},"OutboundHttpRequestV2.DNS":{dimensionNames:()=>k.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.dns},"OutboundHttpRequestV2.TCP":{dimensionNames:()=>k.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.tcp},"OutboundHttpRequestV2.FirstByte":{dimensionNames:()=>k.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.firstByte},"OutboundHttpRequestV2.Download":{dimensionNames:()=>k.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.download},"OutboundHttpRequestV2.Total":{dimensionNames:()=>k.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.total}}}constructor(e){super(e),this.eventName="OutboundHttpRequest"}getDimensionValues(){return[this.host,this.statusCode,this.success]}}k.dimensionNames=["Host","StatusCode","Success"];var M=s(4797);class E extends M.k{getMetrics(){return{HttpSocketListV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpSocketList"}}var L,P=s(67772);class B extends P.F{constructor(e){super(e),this.eventName="PrivacyGuardIssue"}}!function(e){e.UnexpectedClose="UnexpectedClose",e.ExpectedClose="ExpectedClose",e.ExpectedError="ExpectedError"}(L||(L={}));const D="ExcelExtensionClose",R="ExcelKeepAlive",O=`ProcessMessage_${D}`,x=`${D}_${L[L.ExpectedClose]}`,F=`${D}_${L[L.ExpectedError]}`,G=`${D}_${L[L.UnexpectedClose]}`;var W;!function(e){e[e.Unknown=0]="Unknown",e[e.SessionClosedOutside=1]="SessionClosedOutside",e[e.ClosedOutsideBeforeInitialSeedingCompleted=2]="ClosedOutsideBeforeInitialSeedingCompleted",e[e.EcsProxyClose=3]="EcsProxyClose",e[e.EcsProxyFailedToFetchContent=4]="EcsProxyFailedToFetchContent",e[e.EcsProxyFailedToFetchWorkbookMetadata=5]="EcsProxyFailedToFetchWorkbookMetadata",e[e.EcsProxyFailedToRequestWaitForWorkbookChange=6]="EcsProxyFailedToRequestWaitForWorkbookChange",e[e.EcsProxyReconnect=7]="EcsProxyReconnect",e[e.EcsProxyUnexpected=8]="EcsProxyUnexpected",e[e.EcsSessionClosedNotification=9]="EcsSessionClosedNotification",e[e.SessionIdle=10]="SessionIdle",e[e.FailedToProducePubSubMessage=11]="FailedToProducePubSubMessage",e[e.FailedToSetSessionData=12]="FailedToSetSessionData",e[e.FailedToGetSessionData=13]="FailedToGetSessionData",e[e.ReachUnexpectedCode=14]="ReachUnexpectedCode",e[e.RequestIdMismatch=15]="RequestIdMismatch",e[e.SeedingNotRequired=16]="SeedingNotRequired",e[e.ShortAccessTokenTTLReconnect=17]="ShortAccessTokenTTLReconnect"}(W||(W={}));let H=new u(new l.W);const U=[],q=new Map;let V;const $=e=>{U.push(H),H=e},j=e=>{if(H===e)return void(H=U.pop());const t=U.lastIndexOf(e);if(t<0)throw new Error("Context not found");if(0===t)throw new Error("Cannot remove top context");U.splice(t,1)},z=e=>{V||(V=e.createHook({init(t){const s=Q();if(s)q.set(t,s);else if(0===e.executionAsyncId()){const s=e.triggerAsyncId(),o=q.get(s);o&&q.set(t,o)}},before(e){const t=q.get(e);t&&$(t)},after(e){const t=q.get(e);t&&j(t)},destroy(e){q.delete(e)}}),V.enable())},Q=()=>H,K=()=>H&&H.cv&&H.cv.toString()||null,J=()=>{var e,t;return new u((null===(e=null==H?void 0:H.cv)||void 0===e?void 0:e.newChild())||new l.W,null==H?void 0:H.sessionDescriptor,null==H?void 0:H.clientMetadata,{workflow:null==H?void 0:H.workflow,joinContextId:null==H?void 0:H.joinContextId,performanceEvent:null==H?void 0:H.performanceEvent,interactionId:null==H?void 0:H.interactionId,interactionSessionId:H.interactionSessionId,traceId:null==H?void 0:H.traceId,disableLogging:null!==(t=null==H?void 0:H.disableLogging)&&void 0!==t&&t})},Y=e=>{const t=J();return X((t=>e(t&&t.cv||void 0)),t)},Z=(e,t,s,o,n)=>{const i=new u(t&&l.W.fromString(t)||(null==H?void 0:H.cv)||new l.W,s||(null==H?void 0:H.sessionDescriptor),o||(null==H?void 0:H.clientMetadata),{workflow:(null==n?void 0:n.workflow)||(null==H?void 0:H.workflow),joinContextId:(null==n?void 0:n.joinContextId)||(null==H?void 0:H.joinContextId),performanceEvent:(null==n?void 0:n.performanceEvent)||(null==H?void 0:H.performanceEvent),interactionId:(null==n?void 0:n.interactionId)||(null==H?void 0:H.interactionId),interactionSessionId:(null==n?void 0:n.interactionSessionId)||(null==H?void 0:H.interactionSessionId),traceId:(null==n?void 0:n.traceId)||(null==H?void 0:H.traceId),disableLogging:(null==n?void 0:n.disableLogging)||(null==H?void 0:H.disableLogging)||!1});return X(e,i)},X=(e,t)=>{$(t);try{return e(t)}finally{j(t)}};var ee=s(84245),te=s(1427),se=s(72715);class oe{constructor(e,t,s,o,n=5,i){this.severity=e,this.resourceId=t,this.tokenExpirationInMS=s,this.idleDurationInMS=o,this.kAnonUser=n,this.log=i,this.cache=new te.l({idleDurationMs:this.idleDurationInMS,sweepInterval:6e4}),this.kAnonUser=Math.min(5,this.kAnonUser),this.log=i||this.logHits}updateTokenCount(e,t,s){this.flush();const o=Date.now(),n=this.cache.get(e);if(!n)return void this.cache.put(e,{users:[{userId:t,timestamp:o,count:s}]},this.tokenExpirationInMS);const i=n.users.find((e=>e.userId===t));if(i)i.timestamp=o,i.count+=s;else if(n.users.push({userId:t,timestamp:o,count:s}),n.users.length>=this.kAnonUser){const t=n.users.reduce(((e,t)=>e+t.count),0);this.cache.del(e),this.log(e,t)}}logHits(e,t){o.tG.info(508688156,o.nh.CoreSystem,new w({operationName:"BlocklistMatchEvent",key:e,value:t+"",datafield0:this.severity,datafield1:this.resourceId,buildVersion:se.env.BUILD_BUILDNUMBER||"DEV",tagId:508688156}))}flush(){this.cache.forEach((e=>{e.users=e.users.filter((e=>Date.now()<e.timestamp+this.tokenExpirationInMS))}))}getCount(e){this.flush();const t=this.cache.get(e);return t?t.users.reduce(((e,t)=>e+t.count),0):0}shutdown(){this.cache.clear(),this.cache=void 0}}},81768:(e,t,s)=>{s.d(t,{D:()=>r});const o="n~",n=/\|\~/g;class i{constructor(){this.count=0,this.measureSums=new Map}}class r{constructor(e,t,s,r,a){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const s=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])s.push(null);else{let i="";"boolean"==typeof e[t]?i="b~":"number"==typeof e[t]&&(i=o),s.push(`${i}${e[t].toString().replace(n,"_")}`)}const r=s.join("|");let a=this.buckets.get(r);if(!a){a=new i,a.traceLevel=e.traceLevel;for(const e of this.avgMeasures)a.measureSums.set(e,0);this.buckets.set(r,a)}a.count++;for(const t of this.avgMeasures)e[t]&&a.measureSums.set(t,a.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const s={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},n=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=n[e];0===i.indexOf("b~")?s[t]="b~true"===i:0===i.indexOf(o)?s[t]=parseInt(i.slice(2),10):s[t]=i}for(const t of this.avgMeasures)s[t]=Math.round(e.measureSums.get(t)/e.count);this.log(s,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=s,this.avgMeasures=r,a>0&&(this.interval=setInterval(this.flush,1e3*a))}}},25765:(e,t,s)=>{s.d(t,{tG:()=>T,nh:()=>B,am:()=>C,OD:()=>w,ih:()=>L});var o,n=s(93364);!function(e){e.Log="Log"}(o||(o={}));var i=s(72715);const r=void 0!==i&&i.env?i.env.SERVICE_NAME:"client",a="abcdefghijklmnopqrstuvwxyz0123456789",c={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,u=[],p=[],g=e=>null,h=e=>{};const d=new Map,m=new Map,y=new Map,f=new Map;var T;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{u=[],p=[],m.clear(),y.clear()},e.clearAggregators=()=>{d.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),_(m,e))},e.addDecidingLogger=e=>{-1===p.indexOf(e)&&(p.push(e),_(y,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{g=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{k(e,t)})),d.has(e.eventName)?d.get(e.eventName).push(e):d.set(e.eventName,[e])},e.flushAggregators=e=>{d.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const s=P(e);f.set(s,t)},e.resetTagLevelOverrides=()=>{f.clear()},e.error=(e,t,s,o,i,r,a,c,l,u)=>{b(e,t,n.q.error,s,o,i,r,a,c,l,u)},e.warn=(e,t,s,o,i,r,a,c,l,u)=>{b(e,t,n.q.warn,s,o,i,r,a,c,l,u)},e.info=(e,t,s,o,i,r,a,c,l,u)=>{b(e,t,n.q.info,s,o,i,r,a,c,l,u)},e.verbose=(e,t,s,o,i,r,a,c,l,u)=>{b(e,t,n.q.verbose,s,o,i,r,a,c,l,u)},e.debug=(e,t,s,o,i,r,a,c,l,u)=>{b(e,t,n.q.debug,s,o,i,r,a,c,l,u)},e.metric=(e,t,s,o,i,r,a,c,l,u)=>{b(e,t,n.q.metric,s,o,i,r,a,c,l,u)},e.formatMetric=(e,t,s,o)=>{const n={};return n[e]={dimensionNames:s,dimensionValues:o,value:t},n},e.dynamic=e=>{k(e)}}(T||(T={}));const _=(e,t)=>{const s=t.level;Object.keys(n.q).map((e=>n.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=s)).forEach((s=>{e.has(s)?e.get(s).push(t):e.set(s,[t])}))},C=e=>{if("string"==typeof e)return e;let t="";for(let s=0;s<e.length;s++){s>0&&(t+=" ");const o=e[s];o instanceof Error?t+=JSON.stringify({message:o.message,name:o.name,stack:o.stack}):t+="object"==typeof o?JSON.stringify(o):o}return t},v=[],S=["Level","Tag"],A=["Level","Tag","Workflow"],w=e=>I(e).length,I=e=>void 0!==e?m.get(e)||v:u,N=(e,t)=>(void 0!==e?y.get(e)||[]:p).filter((e=>e.shouldLog(t))),b=(e,t,s,n,i,r,a,c,u,p,m)=>{s=f.get(e)||s;const y=I(s),T=N(s,n);if(0==y.length&&0==T.length)return;const _=g(o.Log),v=L(e),w=((e,t,s,o,n,i,r,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const l of[e,t,s,o,n,i,r,a])void 0!==l&&c.push("function"==typeof l?l():l);return c})(n,i,r,a,c,u,p,m);if(M(t))E(w)&&k({eventName:"Metrics",tagId:v,category:`${t.root}.${t.name}`,traceLevel:s,message:"",getMetrics:()=>w},!1,y,T);else if(E(w)){const e=w;e.tagId=v,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=s;const o=d.get(e.eventName);if(o)for(let t=0;t<o.length;++t){const s=o[t];if(s&&s.add(e,t===o.length-1))break}else k(e,!1,y,T)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>S,dimensionValues:[String(s),v],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>A,dimensionValues:[String(s),v,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};k({eventName:"Log",tagId:v,category:`${t.root}.${t.name}`,traceLevel:s,message:C(w),getMetrics:e},!1,y,T)}h(_)},k=(e,t=!1,s,o)=>{var n,i,a,c,u,p,g,h,d,m,y,f;let T;if(null==s&&(s=I(e.traceLevel)),o=o||v,s.length>0||o.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(T={disableLogging:t.disableLogging},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(n=t.clientMetadata)||void 0===n?void 0:n.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(i=t.clientMetadata)||void 0===i?void 0:i.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(a=t.clientMetadata)||void 0===a?void 0:a.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(c=t.clientMetadata)||void 0===c?void 0:c.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(u=t.clientMetadata)||void 0===u?void 0:u.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(p=t.clientMetadata)||void 0===p?void 0:p.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(d=t.clientMetadata)||void 0===d?void 0:d.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(m=t.clientMetadata)||void 0===m?void 0:m.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(y=t.clientMetadata)||void 0===y?void 0:y.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(f=t.clientMetadata)||void 0===f?void 0:f.isClientTelemetrySampled)}for(const t of s)t.log(e,T);for(const t of o)t.log(e)}},M=e=>e.name===B.WorkflowMetricsOnly.name&&e.root===B.WorkflowMetricsOnly.root,E=e=>!Array.isArray(e)&&"object"==typeof e,L=e=>a[e>>24&63]+a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e],P=e=>e&&5===e.length?c[e.charCodeAt(0)]<<24|c[e.charCodeAt(1)]<<18|c[e.charCodeAt(2)]<<12|c[e.charCodeAt(3)]<<6|c[e.charCodeAt(4)]:-1;class B{}B.CoreDefault=T.defineCoreLogCategory("Default"),B.CoreSystem=T.defineCoreLogCategory("System"),B.CoreUnsampled=T.defineCoreLogCategory("Unsampled"),B.WorkflowDefault=T.defineWorkflowLogCategory("Default"),B.WorkflowUnsampled=T.defineWorkflowLogCategory("Unsampled"),B.WorkflowMetricsOnly=T.defineWorkflowLogCategory("MetricsOnly"),B.PrivacyGuardEvent=T.defineCoreLogCategory("PrivacyGuardEvent")},84245:(e,t,s)=>{s.d(t,{t:()=>n});var o=s(72715);const n=void 0!==o&&o.hrtime?()=>{const e=o.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now()},89700:(e,t,s)=>{s.d(t,{I:()=>i});var o=s(70529),n=s(84245);class i extends o.A{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){if(null==t)return;const s=this.dataFields?JSON.parse(this.dataFields):{};s[e]=t,this.dataFields=JSON.stringify(s)}setDataFields(e){this.dataFields?this.dataFields=JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)}start(){return this.startTime=(0,n.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,n.t)()-this.startTime)),this}stop(){const e=(0,n.t)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,s;const o={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":o[this.operationName+".CountV2"]={dimensionNames:i.getOrphanedSessionHealthDimensionNames.bind(i),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":o[this.operationName+".Reason"]={dimensionNames:i.getSessionHealthDimensionNames.bind(i),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(o["Workflow.DurationMs"]={dimensionNames:i.getWorkflowDimensionNames.bind(i),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},o["Workflow.Count"]={dimensionNames:i.getWorkflowDimensionNames.bind(i),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const s=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(s)>=0)&&(o[s]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(s=this.options)||void 0===s?void 0:s.metricCount)||e.indexOf(t)>=0)&&(o[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return o}getDimensionNames(){var e,t;let s=i.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){s=s.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(e)}return s}getDimensionValues(){var e,t;const s=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(this.options.metricCustomDimensions[e]);return s}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}i.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],i.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],i.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],i.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"]},97225:(e,t,s)=>{s.d(t,{Pq:()=>i,aM:()=>o,l6:()=>n,vf:()=>c});var o,n,i,r=s(46565),a=s(84245);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(i||(i={}));class c extends r.R{constructor(e,t){var s,r;super({source:o[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:i[e.impact],success:e.success,durationMs:null!==(s=e.durationMs)&&void 0!==s?s:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(r=e.affectedWorkflows)&&void 0!==r?r:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=o[e],this}setImpact(e){return this.impact=i[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,a.t)(),this}stop(){const e=(0,a.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},11654:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationMetaDataChange=void 0;const o=s(24726);class n extends o.AnnotationMetaDataChangeEvent{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}t.AnnotationMetaDataChange=n},93004:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionHealthSource=t.SessionHealthReason=t.SessionHealthImpact=t.SessionHealthEvent=void 0,n(s(11654),t),n(s(37193),t),n(s(13412),t),n(s(61708),t),n(s(68656),t);var i=s(95709);Object.defineProperty(t,"SessionHealthEvent",{enumerable:!0,get:function(){return i.SessionHealth}}),Object.defineProperty(t,"SessionHealthImpact",{enumerable:!0,get:function(){return i.SessionHealthImpact}}),Object.defineProperty(t,"SessionHealthReason",{enumerable:!0,get:function(){return i.SessionHealthReason}}),Object.defineProperty(t,"SessionHealthSource",{enumerable:!0,get:function(){return i.SessionHealthSource}})},37193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CorrelationVector=void 0;class s{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<n;e++)i[e]=o[Math.floor(Math.random()*o.length)];return i.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new s(e.substring(0,e.length-2)):new s(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new s(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}t.CorrelationVector=s;const o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n=22,i=new Array(n)},61708:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingAggregator=void 0;const s="n~",o=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}t.LoggingAggregator=class{constructor(e,t,i,r,a){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const i=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])i.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n=s),i.push(`${n}${e[t].toString().replace(o,"_")}`)}const r=i.join("|");let a=this.buckets.get(r);if(!a){a=new n,a.traceLevel=e.traceLevel;for(const e of this.avgMeasures)a.measureSums.set(e,0);this.buckets.set(r,a)}a.count++;for(const t of this.avgMeasures)e[t]&&a.measureSums.set(t,a.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},n=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=n[e];0===i.indexOf("b~")?o[t]="b~true"===i:0===i.indexOf(s)?o[t]=parseInt(i.slice(2),10):o[t]=i}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=i,this.avgMeasures=r,a>0&&(this.interval=setInterval(this.flush,1e3*a))}}},13412:(e,t,s)=>{var o=s(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.LogCategory=t.tagIdToString=t.getNumLoggers=t.argsToString=t.Log=void 0;const n=s(43992),i=s(12807),r=void 0!==o&&o.env?o.env.SERVICE_NAME:"client",a="abcdefghijklmnopqrstuvwxyz0123456789",c={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,u=[],p=[],g=e=>null,h=e=>{};const d=new Map,m=new Map,y=new Map,f=new Map;var T;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{u=[],p=[],m.clear(),y.clear()},e.clearAggregators=()=>{d.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),_(m,e))},e.addDecidingLogger=e=>{-1===p.indexOf(e)&&(p.push(e),_(y,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{g=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{N(e,t)})),d.has(e.eventName)?d.get(e.eventName).push(e):d.set(e.eventName,[e])},e.flushAggregators=e=>{d.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const s=M(e);f.set(s,t)},e.resetTagLevelOverrides=()=>{f.clear()},e.error=(e,t,s,o,i,r,a,c,l,u)=>{I(e,t,n.LoggingLevel.error,s,o,i,r,a,c,l,u)},e.warn=(e,t,s,o,i,r,a,c,l,u)=>{I(e,t,n.LoggingLevel.warn,s,o,i,r,a,c,l,u)},e.info=(e,t,s,o,i,r,a,c,l,u)=>{I(e,t,n.LoggingLevel.info,s,o,i,r,a,c,l,u)},e.verbose=(e,t,s,o,i,r,a,c,l,u)=>{I(e,t,n.LoggingLevel.verbose,s,o,i,r,a,c,l,u)},e.debug=(e,t,s,o,i,r,a,c,l,u)=>{I(e,t,n.LoggingLevel.debug,s,o,i,r,a,c,l,u)},e.metric=(e,t,s,o,i,r,a,c,l,u)=>{I(e,t,n.LoggingLevel.metric,s,o,i,r,a,c,l,u)},e.formatMetric=(e,t,s,o)=>{const n={};return n[e]={dimensionNames:s,dimensionValues:o,value:t},n},e.dynamic=e=>{N(e)}}(T||(t.Log=T={}));const _=(e,t)=>{const s=t.level;Object.keys(n.LoggingLevel).map((e=>n.LoggingLevel[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=s)).forEach((s=>{e.has(s)?e.get(s).push(t):e.set(s,[t])}))};t.argsToString=e=>{if("string"==typeof e)return e;let t="";for(let s=0;s<e.length;s++){s>0&&(t+=" ");const o=e[s];o instanceof Error?t+=JSON.stringify({message:o.message,name:o.name,stack:o.stack}):t+="object"==typeof o?JSON.stringify(o):o}return t};const C=[],v=["Level","Tag"],S=["Level","Tag","Workflow"];t.getNumLoggers=e=>A(e).length;const A=e=>void 0!==e?m.get(e)||C:u,w=(e,t)=>(void 0!==e?y.get(e)||[]:p).filter((e=>e.shouldLog(t))),I=(e,s,o,n,r,a,c,u,p,m,y)=>{o=f.get(e)||o;const T=A(o),_=w(o,n);if(0==T.length&&0==_.length)return;const C=g(i.PerformanceEventType.Log),I=(0,t.tagIdToString)(e),M=((e,t,s,o,n,i,r,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const l of[e,t,s,o,n,i,r,a])void 0!==l&&c.push("function"==typeof l?l():l);return c})(n,r,a,c,u,p,m,y);if(b(s))k(M)&&N({eventName:"Metrics",tagId:I,category:`${s.root}.${s.name}`,traceLevel:o,message:"",getMetrics:()=>M},!1,T,_);else if(k(M)){const e=M;e.tagId=I,e.category=`${s.root}.${s.name}`,"Operation"===e.eventName&&"Workflow"===s.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const t=d.get(e.eventName);if(t)for(let s=0;s<t.length;++s){const o=t[s];if(o&&o.add(e,s===t.length-1))break}else N(e,!1,T,_)}else{const e=()=>{var e;return"Core"===s.root?{TraceEventV2:{dimensionNames:()=>v,dimensionValues:[String(o),I],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>S,dimensionValues:[String(o),I,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};N({eventName:"Log",tagId:I,category:`${s.root}.${s.name}`,traceLevel:o,message:(0,t.argsToString)(M),getMetrics:e},!1,T,_)}h(C)},N=(e,t=!1,s,o)=>{var n,i,a,c,u,p,g,h,d,m,y,f;let T;if(null==s&&(s=A(e.traceLevel)),o=o||C,s.length>0||o.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(T={disableLogging:t.disableLogging},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(n=t.clientMetadata)||void 0===n?void 0:n.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(i=t.clientMetadata)||void 0===i?void 0:i.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(a=t.clientMetadata)||void 0===a?void 0:a.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(c=t.clientMetadata)||void 0===c?void 0:c.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(u=t.clientMetadata)||void 0===u?void 0:u.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(p=t.clientMetadata)||void 0===p?void 0:p.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(d=t.clientMetadata)||void 0===d?void 0:d.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(m=t.clientMetadata)||void 0===m?void 0:m.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(y=t.clientMetadata)||void 0===y?void 0:y.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(f=t.clientMetadata)||void 0===f?void 0:f.isClientTelemetrySampled)}for(const t of s)t.log(e,T);for(const t of o)t.log(e)}},b=e=>e.name===E.WorkflowMetricsOnly.name&&e.root===E.WorkflowMetricsOnly.root,k=e=>!Array.isArray(e)&&"object"==typeof e;t.tagIdToString=e=>a[e>>24&63]+a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e];const M=e=>e&&5===e.length?c[e.charCodeAt(0)]<<24|c[e.charCodeAt(1)]<<18|c[e.charCodeAt(2)]<<12|c[e.charCodeAt(3)]<<6|c[e.charCodeAt(4)]:-1;class E{}t.LogCategory=E,E.CoreDefault=T.defineCoreLogCategory("Default"),E.CoreSystem=T.defineCoreLogCategory("System"),E.CoreUnsampled=T.defineCoreLogCategory("Unsampled"),E.WorkflowDefault=T.defineWorkflowLogCategory("Default"),E.WorkflowUnsampled=T.defineWorkflowLogCategory("Unsampled"),E.WorkflowMetricsOnly=T.defineWorkflowLogCategory("MetricsOnly"),E.PrivacyGuardEvent=T.defineCoreLogCategory("PrivacyGuardEvent")},49601:(e,t,s)=>{var o=s(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.now=void 0;t.now=void 0!==o&&o.hrtime?()=>{const e=o.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now()},68656:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Operation=void 0;const o=s(24726),n=s(49601);class i extends o.OperationEvent{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){if(null==t)return;const s=this.dataFields?JSON.parse(this.dataFields):{};s[e]=t,this.dataFields=JSON.stringify(s)}setDataFields(e){this.dataFields?this.dataFields=JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)}start(){return this.startTime=(0,n.now)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,n.now)()-this.startTime)),this}stop(){const e=(0,n.now)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,s;const o={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":o[this.operationName+".CountV2"]={dimensionNames:i.getOrphanedSessionHealthDimensionNames.bind(i),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":o[this.operationName+".Reason"]={dimensionNames:i.getSessionHealthDimensionNames.bind(i),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(o["Workflow.DurationMs"]={dimensionNames:i.getWorkflowDimensionNames.bind(i),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},o["Workflow.Count"]={dimensionNames:i.getWorkflowDimensionNames.bind(i),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const s=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(s)>=0)&&(o[s]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(s=this.options)||void 0===s?void 0:s.metricCount)||e.indexOf(t)>=0)&&(o[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return o}getDimensionNames(){var e,t;let s=i.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){s=s.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(e)}return s}getDimensionValues(){var e,t;const s=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(this.options.metricCustomDimensions[e]);return s}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}t.Operation=i,i.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],i.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],i.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],i.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"]},12807:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceEventType=void 0,function(e){e.Log="Log"}(s||(t.PerformanceEventType=s={}))},95709:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SessionHealth=t.SessionHealthImpact=t.SessionHealthReason=t.SessionHealthSource=void 0;const o=s(24726),n=s(49601);var i,r,a;!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(t.SessionHealthSource=i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(r||(t.SessionHealthReason=r={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(a||(t.SessionHealthImpact=a={}));class c extends o.SessionHealthEvent{constructor(e,t){var s,o;super({source:i[e.source],reason:r[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:a[e.impact],success:e.success,durationMs:null!==(s=e.durationMs)&&void 0!==s?s:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(o=e.affectedWorkflows)&&void 0!==o?o:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=r[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=a[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,n.now)(),this}stop(){const e=(0,n.now)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}t.SessionHealth=c,c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},79002:(e,t,s)=>{s.d(t,{$:()=>l});var o=s(89700),n=s(25765),i=s(43210),r=s(87477);const a="undefined"!=typeof fetch?fetch:r;var c;!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(c||(c={}));class l{constructor(e,t,s,i){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(s),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${s}`:"",this.checkIdbByFeatures=null==i?void 0:i.checkIdbByFeatures;const r=new o.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});r.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,s=0,o=0;const n=new Promise(((t,s)=>{e=setTimeout((()=>{s(new Error("Took longer than 10000 ms"))}),1e4)})),i=this.accessDB().then((e=>{const n=e.transaction(this.osName,"readwrite");return n.objectStore(this.osName).openCursor().then((function e(i){if(o++,i){const o=i.value;let n;return o.timesSinceUsage||(o.timesSinceUsage=0),o.timesSinceUsage++,o.timesSinceUsage>5?(s++,n=i.delete()):(t++,n=i.update(o)),n.then((()=>i.continue())).then(e)}return n.done}))}));this.initPromise=Promise.race([n,i]).catch((e=>{r.success=!1,r.resultDescription+=`${e.message} `})).then((()=>{r.dimension0=`${o}`,r.dimension1=`${t}`,r.dimension2=`${s}`,clearTimeout(e),this.closeDBAndEndLog(r,"initializing idb storage")}))}else r.resultDescription="Incompatible browser for IDB",n.tG.info(538706242,n.nh.CoreDefault,r.stop())})).catch((()=>{r.resultDescription="Issue determining idb compatibility",n.tG.info(536966936,n.nh.CoreDefault,r.stop())}))}getResourceAsArrayBuffer(e,t,s){const n=new o.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:c.ArrayBuffer,dimension1:e,dimension2:t});n.start();const i={};return this.getResource(e,t,s,c.ArrayBuffer,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{const s=e.get(t);return s.arrayBuffer?s.arrayBuffer().then((e=>{i[t]=e})):new Promise(((e,o)=>{const n=new FileReader;n.readAsArrayBuffer(s),n.onload=s=>{const n=s.target.result;n instanceof ArrayBuffer?(i[t]=n,e()):o(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>i))}getKey(e,t,s){return s?`${e}_${t}_${JSON.stringify(Array.from(s.entries()))}`:`${e}_${t}`}updateCache(e,t,s,o){this.modelPathsCache.set(this.getKey(e,t,s),o)}getCache(e,t,s){return this.modelPathsCache.get(this.getKey(e,t,s))}getResourceAsURL(e,t,s){const n=new o.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:c.URL,dimension1:e,dimension2:t});n.start();const i={},r=this.getCache(e,t,s);return r?Promise.resolve(r):this.getResource(e,t,s,c.URL,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{i[t]=URL.createObjectURL(e.get(t))}))))).then((()=>{const o=this.getCache(e,t,s);return o||(this.updateCache(e,t,s,i),i)}))}getResource(e,t,s,o,n,i){return this.getFiles(e,t,s,n).then((e=>i(e))).then((()=>{this.closeDBAndEndLog(n,`retrieving ${e}`)})).catch((t=>{throw n.resultDescription.indexOf(t.message)>=0&&(n.success=!1,n.resultDescription+=`${t.message} `),n.resultSignature=`Issue retrieving from CDN or translating to ${o}`,this.closeDBAndEndLog(n,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const s=globalThis.indexedDB.open(this.dbName,this.dbVersion);s.onsuccess=function(){e(!0)},s.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?this.checkIdbByFeatures&&(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=(0,i.P2)(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,n.tG.info(573329487,n.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,n.tG.error(573329488,n.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,s,o){return this.isBrowserIdbCompatible().catch((e=>(o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue determining idb compatibility",!1))).then((n=>{const i=()=>{if(s){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,s,o,n);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,o,n)};return n?this.getFilesFromIDB(e,t,s,o).catch((e=>(e&&(o.resultDescription.indexOf(e.message)>=0&&(o.success=!1,o.resultDescription+=`${e.message} `),o.resultSignature="Issue retrieving from DB"),i()))):i()}))}getFilesFromIDB(e,t,s,o){return this.initPromise.catch((e=>{o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((n=>{for(const i of n)if(i&&i.model&&i.version==t){if(!this.checkModelFiltersPass(s,i.filters))continue;return this.putModel(e,i.model,t,i.filters,o,i.id),Promise.resolve(i.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var s;for(const o of e){const e=null===(s=t.get(o[0]))||void 0===s?void 0:s.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${o[0]} to exist in metadata file`);if(e.indexOf(o[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,s,o,n){let i;return o.dimension3="Polymer",s||(s=new Map),a(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{var r,a;const c=JSON.parse(n);if(c.name!==e||c.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${c.name} version ${c.version}`);for(const e of c.variants)if(i=new Map(Object.entries(e)),this.checkModelFiltersPass(s,i))return(c.catalog?s.size+2:s.size+1!==i.size)&&(o.success=!1,o.resultDescription+=`Expected ${null===(r=i.keys)||void 0===r?void 0:r.length} # of filters, received ${null===(a=s.keys)||void 0===a?void 0:a.length}`),e.model_files;throw new Error("No model found with given filters")})).then((s=>Promise.all(s.map((s=>a(`${this.polymerBaseURL}/${e}/${t}/${s}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[s,e]))))))).then((s=>{const r=new Map(s);return n?this.putModel(e,r,t,i,o):r}))}downloadFiles(e,t,s,o){return s.dimension3="FS",a(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((s=>{const o=JSON.parse(s),n=`${o.MajorVersion}.${o.MinorVersion}/ModelResources`,i=`${e}/${t}/`;return Promise.all(o.Resources.map((e=>(e.Name.length>i.length&&e.Name.substring(0,i.length)===i&&(e.Name=e.Name.substring(i.length)),a(`${this.baseURL}/${n}/${i}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((n=>{const i=new Map(n);return o?this.putModel(e,i,t,new Map,s):i}))}getModelOptions(e){return this.accessDB().then((t=>{const s=[],o=t.transaction(this.osName,"readonly");return o.objectStore(this.osName).openCursor().then((function t(n){if(n){const o=n.value;return o.modelId==e&&s.push(o),n.continue().then(t)}return o.done})).then((()=>s))}))}putModel(e,t,s,o,n,i){return o||(o=new Map),this.accessDB().then((n=>n.put(this.osName,{modelId:e,model:t,version:s,filters:o,timesSinceUsage:0},i))).catch((e=>{n.resultDescription.indexOf(e.message)>=0&&(n.success=!1,n.resultDescription+=`${e.message} `),n.resultSignature="Issue adding to DB"})).then((()=>t))}}},80446:(e,t,s)=>{s.d(t,{b:()=>xe});var o=s(44762),n=s(56216),i=s(77827);const r={category:n.v.Schema,schema:{name:"Exception",path:"message-schema.proto"}},a=(n.v.Schema,(e,t=!1)=>{if(null==e)return"Invalid message passed";if(null==e.payload)return`${i.K[i.K.NoOutput]}: Payload is null`;if(null==e.payload.exceptionType)return"Payload is not an exception";{let s=i.K[e.payload.exceptionType];return s+=e.payload.message?`: ${e.payload.message}`:": No description",s+=t&&e.payload.data?`\n${e.payload.data.toString()}`:"",s}}),c=(e,t)=>{if(null==e)throw new Error("Cannot set exception on null message");e.payload=t,e.payloadSchema=r,e.messageType=i.G.Exception};var l,u,p=s(89700),g=s(33957),h=s(25765),d=s(59891),m=s(27560),y=s(36515);!function(e){let t,s,o,n,i,r;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(t=e.TileType||(e.TileType={})),function(e){e[e.Generic=0]="Generic",e[e.Title=1]="Title",e[e.SmartArt=2]="SmartArt",e[e.TableCell=3]="TableCell",e[e.TextBox=4]="TextBox",e[e.Notes=5]="Notes"}(s=e.TextTileType||(e.TextTileType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(o=e.TextTileElementUnit||(e.TextTileElementUnit={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered"}(n=e.ListType||(e.ListType={})),function(e){e[e.Undefined=0]="Undefined",e[e.AlphaLcParenBoth=1]="AlphaLcParenBoth",e[e.AlphaUcParenBoth=2]="AlphaUcParenBoth",e[e.AlphaLcParenR=3]="AlphaLcParenR",e[e.AlphaUcParenR=4]="AlphaUcParenR",e[e.AlphaLcPeriod=5]="AlphaLcPeriod",e[e.AlphaUcPeriod=6]="AlphaUcPeriod",e[e.ArabicParenBoth=7]="ArabicParenBoth",e[e.ArabicParenR=8]="ArabicParenR",e[e.ArabicPeriod=9]="ArabicPeriod",e[e.ArabicPlain=10]="ArabicPlain",e[e.RomanLcParenBoth=11]="RomanLcParenBoth",e[e.RomanUcParenBoth=12]="RomanUcParenBoth",e[e.RomanLcParenR=13]="RomanLcParenR",e[e.RomanUcParenR=14]="RomanUcParenR",e[e.RomanLcPeriod=15]="RomanLcPeriod",e[e.RomanUcPeriod=16]="RomanUcPeriod",e[e.CircleNumDbPlain=17]="CircleNumDbPlain",e[e.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain",e[e.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain",e[e.ArabicDbPeriod=20]="ArabicDbPeriod",e[e.ArabicDbPlain=21]="ArabicDbPlain",e[e.Ea1ChsPeriod=22]="Ea1ChsPeriod",e[e.Ea1ChsPlain=23]="Ea1ChsPlain",e[e.Ea1ChtPeriod=24]="Ea1ChtPeriod",e[e.Ea1ChtPlain=25]="Ea1ChtPlain",e[e.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod",e[e.Ea1JpnKorPlain=27]="Ea1JpnKorPlain",e[e.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod",e[e.Arabic1Minus=29]="Arabic1Minus",e[e.Arabic2Minus=30]="Arabic2Minus",e[e.Hebrew2Minus=31]="Hebrew2Minus",e[e.ThaiAlphaPeriod=32]="ThaiAlphaPeriod",e[e.ThaiAlphaParenR=33]="ThaiAlphaParenR",e[e.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth",e[e.ThaiNumPeriod=35]="ThaiNumPeriod",e[e.ThaiNumParenR=36]="ThaiNumParenR",e[e.ThaiNumParenBoth=37]="ThaiNumParenBoth",e[e.HindiAlphaPeriod=38]="HindiAlphaPeriod",e[e.HindiNumPeriod=39]="HindiNumPeriod",e[e.HindiNumParenR=40]="HindiNumParenR",e[e.HindiAlpha1Period=41]="HindiAlpha1Period"}(i=e.ListNumeration||(e.ListNumeration={})),function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(r=e.TextTileEventType||(e.TextTileEventType={}))}(l||(l={})),function(e){let t;!function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(t=e.SlideTileEventType||(e.SlideTileEventType={}))}(u||(u={}));var f=s(71283);class T{constructor(){this.cache=new Map}setReduceTimer(e,t,s,o=500,n=()=>!1,i=5e3){this.cache.has(e)||this.cache.set(e,new Map);const r=this.cache.get(e);r.has(t)&&clearTimeout(r.get(t).timer);const a=()=>{const a=r.get(t),c=Date.now()-a.start;n()&&c<i?a.timer=setTimeout(a.timerCallback,Math.min(o,i-c)):(r.size>1?r.delete(t):this.cache.delete(e),s())};r.set(t,{start:Date.now(),timerCallback:a,timer:setTimeout(a,o)})}clear(e,t){this.cache.forEach(((s,o)=>{e&&e!==o||s.forEach(((e,s)=>{t&&t!==s||clearTimeout(e.timer)}))})),this.cache.clear()}}var _=s(37572);class C{constructor(e=33e5){this.tokenCache=new Map,this.requestMap=new Map,this.requestRecordMap=new Map,this.tokenExpirationMs=e}updateAuthToken(e,t){const s=JSON.stringify(t);let o=this.requestRecordMap.get(s);return(void 0===o||this.isTokenExpired(o))&&(o={requestPromise:e.requestAuthToken(t).then((e=>{if(!e||!e.Token)throw new Error(`No token available for request ${s}`);this.tokenCache.set(s,e.Token)})),requestTime:m.Aq.getCurrentTimeMs()},this.requestRecordMap.set(s,o)),o.requestPromise}getAuthTokenEntries(e,t){return Array.from(this.tokenCache.keys()).map((e=>{let t=this.requestMap.get(e);return void 0===t&&(t=JSON.parse(e),this.requestMap.set(e,t)),{requestKey:e,request:t}})).filter((({request:e})=>!t||e.DocId===t)).map((({requestKey:t,request:s})=>(this.isTokenExpired(this.requestRecordMap.get(t))&&this.updateAuthToken(e,s),{ticket:s.Tickets[0],token:this.tokenCache.get(t)})))}isTokenExpired(e){return m.Aq.getCurrentTimeMs()>e.requestTime+this.tokenExpirationMs}}let v;const S=()=>{v=new C};S();const A=(e,t,s,o,n,r,a,c,l,u)=>{const p={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":n},body:JSON.stringify({payload:t.payload,payloadSchema:s,requestedSchema:o,clientMetadata:r,tokens:v.getAuthTokenEntries(a,l.docId)})};(0,_.OW)(e,p,((p,g)=>{p?u(new Error(`Fetch error in remote lambda request to ${e}: ${p}`)):401===g.status?c>0?(h.tG.info(572838109,h.nh.CoreDefault,"Auth token required for remote lambda request"),g.json().then((e=>v.updateAuthToken(a,{Tickets:[e],DocId:l.docId}))).then((()=>{A(e,t,s,o,n,r,a,c-1,l,u)})).catch((e=>{u({exceptionType:i.K.Authentication,message:e.message})}))):u({exceptionType:i.K.Authentication,message:"Remote lambda request retry with authentication token failed"}):g.ok?g.json().then((e=>{if(Array.isArray(e))if(e.length>0){let s=0;for(const o of e)t.moreResults=++s<e.length,u(null,o)}else u(new Error("No output"));else u(new Error("Did not receive a valid response for remote lambda request"))})).catch((e=>{u({exceptionType:i.K.LambdaThrow,message:e.message})})):u(new Error(`Remote lambda request failed with status ${g.status}`))}))},w=(e,t,s,o,n,r,a,c,l)=>{Array.isArray(c.authTickets)?v.updateAuthToken(a,{Tickets:c.authTickets,DocId:c.docId}).then((()=>{A(e,t,s,o,n.id,r,a,1,c,l)})).catch((e=>{l({exceptionType:i.K.Authentication,message:e.message})})):A(e,t,s,o,n.id,r,a,1,c,l)};var I=s(87045),N=s.n(I);class b{constructor(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.egressMessageCount=0,this.egressByteCount=0,this.isClosing=!1,this.pendingEgress=[]}init(e,t,s,o){this.ws=new(N())(e),this.logOp=new p.I({operationName:b.className,success:!0,dimension1:"V1"}).start(),this.egressTimer=Date.now(),this.egressMessageCountOp=new p.I({operationName:"WSEgressMessageCount",success:!0,dimension1:"V1"}),this.egressByteCountOp=new p.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0,dimension1:"V1"}),this.ingressByteCountOp=new p.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0,dimension1:"V1"});const n=e=>{this.logPingLatencyOp&&(this.logPingLatencyOp.success=e,h.tG.info(507789790,h.nh.CoreDefault,this.logPingLatencyOp.stop()),this.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(e=>{s(),b.logCountLimiter.log((()=>{this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),h.tG.info(507789789,h.nh.CoreDefault,this.logOp.stop())})),this.hasBeenOpened=!0,this.pendingEgress.forEach((e=>{this.egress({obj:e})})),this.pendingEgress=[],this.pingInterval=setInterval((()=>{this.logPingLatencyOp&&(--this.remainingPingFailures,n(!1)),this.remainingPingFailures>0&&this.hasBeenOpened&&this.lastPongTime<this.lastEgressTime&&(this.logPingLatencyOp=new p.I({operationName:"Ping",success:!0,dimension0:this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString().length.toString():void 0,dimension1:"V1"}).start(),this.ws.send(b.pingPongMessage,(e=>{e&&(--this.remainingPingFailures,n(!1))})))}),3e4)})),this.ws.addEventListener("message",(e=>{this.logPingLatencyOp&&"string"==typeof e.data&&1===e.data.length&&e.data[0]===b.pingPongMessage?(n(!0),this.lastPongTime=Date.now()):(this.logIngressCount(e.data),t(e.data))})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,b.logCountLimiter.log((()=>{this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,h.tG.info(507789788,h.nh.CoreDefault,this.logOp.stop())})),this.ws.close()})),this.ws.addEventListener("close",(e=>{b.logCountLimiter.log((()=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,h.tG.info(507789787,h.nh.CoreDefault,this.logOp.stop())})),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),o(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.logEgressCount(t instanceof ArrayBuffer||t instanceof Uint8Array?t.byteLength:t.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,b.logCountLimiter.log((()=>{this.logOp.resourceId="OnFirstEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,h.tG.info(507789786,h.nh.CoreDefault,this.logOp.stop())})))})):this.pendingEgress.push(t)}close(){this.isClosing||(this.isClosing=!0,this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close())}logEgressCount(e){const t=Date.now(),s=t-this.egressTimer;s>1e3&&(this.egressMessageCount>50&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+s.toString(),h.tG.info(507789785,h.nh.CoreDefault,this.egressMessageCountOp.stop())),this.egressByteCount>1e5&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+s.toString(),h.tG.info(507789784,h.nh.CoreDefault,this.egressByteCountOp.stop())),this.egressTimer=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),h.tG.info(507789783,h.nh.CoreDefault,this.ingressByteCountOp.stop()))}}b.className="WebSocketWorker",b.logCountLimiter=new m.yq(b.className),b.pingPongMessage="~";class k{constructor(e,t,s,o,n,i){this.requestId=e,this.correlationId=t,this.schemaName=s,this.data=o,this.callback=n,this.requestTimeoutInMs=i,this.ended=!1,this.startTime=0}startRequest(){this.startTime=m.Aq.getCurrentTimeMs()}getMsUntilTimeout(){const e=m.Aq.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-e}endRequest(e){this.ended||(this.invokeCallback(null,e,!0),this.ended=!0)}addResponseData(e){this.invokeCallback(e,null,!1)}invokeCallback(e,t,s){new Promise((()=>this.callback(e,t,s))).catch((e=>{}))}}let M;const E=()=>{M=new C};E();const L=new class{constructor(e,t,s){this.requestCounter=0,this.activeRequests=[],this.pendingRequests=[],this.requestTimeoutInMs=e,this.workerFactory=t,this.maxActiveRequests=s}testConnection(e,t){let s=!1;const o=new p.I({cv:(new g.W).toString(),operationName:"WebSocketTest",resourceId:(0,d.k$)(e),success:!0}).start();return new Promise((n=>{const i=m.Aq.createHealthCheckRequest(t);e?this.addRequest(e,i,o.cv,"HealthCheckRequest",((e,t,i)=>{t&&(o.success=!1,o.resultSignature="Error",o.resultDescription=t.message||t),e&&"OK"===e.status&&(s=!0),i&&(o.success&&!s&&(o.success=!1,o.resultSignature="NoResponseData"),h.tG.info(556617949,h.nh.CoreDefault,o.stop()),n(o.success))})):(o.success=!1,o.resultSignature="EmptyUrl",h.tG.info(557641870,h.nh.CoreDefault,o.stop()),n(o.success))}))}addRequest(e,t,s,o,n){const i=(this.requestCounter++).toString(),r=new k(i,s,o,t,n,this.requestTimeoutInMs);this.getWorker(e),this.pendingRequests.push(r),this.egressPendingRequests()}egressPendingRequests(){for(;this.pendingRequests.length>0&&this.activeRequests.length<this.maxActiveRequests;){const e=this.pendingRequests.shift();if(this.activeRequests.push(e),1===this.activeRequests.length){const t=e.getMsUntilTimeout();setTimeout(this.onTimeout.bind(this),t)}e.startRequest(),this.worker&&this.worker.egress({obj:this.createRequestMessage(e.data,e.requestId,e.correlationId)})}}createRequestMessage(e,t,s){return JSON.stringify({correlationId:s,requestId:t,body:e})}onTimeout(){for(;this.activeRequests.length>0;){const e=this.activeRequests[0],t=e.getMsUntilTimeout();if(!(t<=0))return void setTimeout(this.onTimeout.bind(this),t);{const t=new Error("Request timed out");e.endRequest(t),this.activeRequests.shift(),this.egressPendingRequests()}}}onMessage(e){try{const t=JSON.parse(e);for(let e=0;e<this.activeRequests.length;e++){const s=this.activeRequests[e];if(s.requestId===t.requestId){t.end?(this.activeRequests.splice(e,1),s.endRequest(t.error),this.egressPendingRequests()):t.body&&s.addResponseData(t.body);break}}}catch(e){h.tG.error(557641871,h.nh.CoreDefault,e)}}onClose(e){const t=new Error(`Connection closed: ${e}`);for(const e of this.activeRequests)e.endRequest(t);this.activeRequests=[];for(const e of this.pendingRequests)e.endRequest(t);this.pendingRequests=[],this.worker=void 0}getWorker(e){return this.worker||(this.worker=this.workerFactory(),this.worker.init(e,this.onMessage.bind(this),(()=>{}),this.onClose.bind(this))),this.worker}}(3e4,(()=>new b),50),P=(e,t,s,o,n,r,a,c,l,u)=>{const p={payload:t.payload,payloadSchema:s,requestedSchema:o,clientMetadata:r,tokens:M.getAuthTokenEntries(a,l.docId)};let g="";o&&o.schema&&(g=o.schema.name);let d=!1;L.addRequest(e,p,n,g,((p,g,m)=>{if(!d)if(d=!0,null!=g)if(g.exceptionType===i.K.Authentication)try{const p=JSON.parse(g.data);c>0?(h.tG.info(572838108,h.nh.CoreDefault,"Auth token required for remote lambda WebSocket request"),M.updateAuthToken(a,{Tickets:[p],DocId:l.docId}).then((()=>{P(e,t,s,o,n,r,a,c-1,l,u)})).catch((e=>{u({exceptionType:i.K.Authentication,message:e.message})}))):u({exceptionType:i.K.Authentication,message:"Remote lambda request retry with authentication token failed"})}catch(e){u({exceptionType:i.K.Authentication,message:e.message})}else u(new Error(`Error in remote lambda WebSocket request to ${e}: ${g}`));else t.moreResults=!1,u(null,p)}))},B=(e,t,s,o,n,r,a,c,l)=>{Array.isArray(c.authTickets)?M.updateAuthToken(a,{Tickets:c.authTickets,DocId:c.docId}).then((()=>{P(e,t,s,o,n.id,r,a,1,c,l)})).catch((e=>{l({exceptionType:i.K.Authentication,message:e.message})})):P(e,t,s,o,n.id,r,a,1,c,l)};class D{constructor(){this.cache=new Map,this.bucketSizes=new Map}setBucketSize(e,t){this.bucketSizes.set(e,t)}setResult(e,t,s){if(!t.primary)return;let o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o));let n=o.get(t.primary);if(n||(n=t.secondary?new Map:[],o.set(t.primary,n)),t.secondary){n.set(t.secondary,s)}else{const t=n;t.length==this.getBucketSize(e)&&t.shift(),t.push(s)}}getResults(e,t){const s=this.cache.get(e);if(s){const e=s.get(t.primary);if(e){if(!t.secondary)return e;const s=Array.from(e.values());if(s.length>0)return s}}return[]}clear(e,t){t?this.cache.forEach(((s,o)=>{if(!e||e===o)if(t.secondary){const e=s.get(t.primary);e&&e.delete(t.secondary)}else s.delete(t.primary)})):e?this.cache.delete(e):this.cache.clear()}getBucketSize(e){return this.bucketSizes.get(e)||10}}var R,O;!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Custom=2]="Custom",e[e.Remote=3]="Remote",e[e.BatchedRemote=4]="BatchedRemote"}(R||(R={}));class x{constructor(){this.throttleInfoMap=new Map}execute(e,t,s){if(t.throttleSettings.shouldBeThrottled&&t.throttleSettings.throttlingInterval>0){const o=this.getWorkflowThrottleInfo(t.name);if(null==o.currentTileId)o.currentTileId=e,o.timeOfPreviousStartedEvent=m.Aq.getCurrentTimeMs(),s();else if(o.currentTileId===e){const e=m.Aq.getCurrentTimeMs(),n=this.delayTime(o,e,t.throttleSettings.throttlingInterval);n>0?(o.latestCallback=s,null==o.lastTimeout&&(o.lastTimeout=setTimeout((()=>{const e=this.getWorkflowThrottleInfo(t.name);e.lastTimeout=void 0,e.timeOfPreviousStartedEvent=m.Aq.getCurrentTimeMs(),e.latestCallback()}),n))):(o.timeOfPreviousStartedEvent=e,s())}else null!=o.lastTimeout&&(clearTimeout(o.lastTimeout),o.latestCallback(),o.lastTimeout=void 0),o.currentTileId=e,o.timeOfPreviousStartedEvent=m.Aq.getCurrentTimeMs(),s()}else s()}delayTime(e,t,s){const o=t-e.timeOfPreviousStartedEvent;return Math.max(s-o,0)}getWorkflowThrottleInfo(e){let t=this.throttleInfoMap.get(e);return t||(t={currentTileId:void 0,timeOfPreviousStartedEvent:-1,latestCallback:()=>{},lastTimeout:void 0},this.throttleInfoMap.set(e,t)),t}}!function(e){e[e.Restricted=0]="Restricted",e[e.Unrestricted=1]="Unrestricted",e[e.Suppressed=2]="Suppressed"}(O||(O={}));class F{constructor(){this.canaryTextTileEventSubmittedByDocSessionId=new Set,this.stateByDocSessionId=new Map,this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map}getOutputSchema(){return this.lambdas[this.lambdas.length-1].outputSchema}scheduleExecution(e,t){const s=this.docSessionIdExtractor?this.docSessionIdExtractor(e):void 0,o=this.getStateForDocSessionId(s);if(o===O.Restricted){const e=this.getExecutionQueueForDocSessionId(s);e.push(t),1===e.length&&t()}else o===O.Unrestricted?t():O.Suppressed}onStart(e){this.incrementExecutionCountForDocSessionId(e)}onFinish(e,t){if(this.decrementExecutionCountForDocSessionId(e),t===i.K.Authentication)this.stateByDocSessionId.set(e,O.Suppressed),this.executionQueueByDocSessionId.delete(e);else if(this.stateByDocSessionId.get(e)===O.Restricted){const s=this.getExecutionQueueForDocSessionId(e);if(s.shift(),void 0===t){this.stateByDocSessionId.set(e,O.Unrestricted),this.executionQueueByDocSessionId.delete(e);for(const e of s)e()}else if(s.length>0){(0,s[0])()}}}onRefresh(e){this.stateByDocSessionId=new Map,this.triggerOnRefresh&&(e?(this.executionQueueByDocSessionId.delete(e),this.executionCountByDocSessionId.delete(e)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map)),this.canaryTextTileEventSubmittedByDocSessionId.delete(e)}getStateForDocSessionId(e){let t=this.stateByDocSessionId.get(e);return void 0===t&&(t=F.executionQueuesEnabled?O.Restricted:O.Unrestricted,this.stateByDocSessionId.set(e,t)),t}getExecutionQueueForDocSessionId(e){let t=this.executionQueueByDocSessionId.get(e);return void 0===t&&(t=[],this.executionQueueByDocSessionId.set(e,t)),t}incrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;this.executionCountByDocSessionId.set(e,t+1)}decrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;t<=1?this.executionCountByDocSessionId.delete(e):this.executionCountByDocSessionId.set(e,t-1)}}F.executionQueuesEnabled=!0;const G=e=>({category:n.v.Schema,schema:{name:e}}),W="Tiling.TextTileEvent",H="ClpSlideTile",U=(e,t)=>e===W&&t&&t.type==l.TextTileEventType.Refresh,q=(e,t)=>e===H&&t&&t.eventType==u.SlideTileEventType.Refresh,V=(e,t)=>U(e,t)||q(e,t),$=(e,t)=>{var s,o;return e===W?null===(o=null===(s=t.tile)||void 0===s?void 0:s.metadata)||void 0===o?void 0:o.docSessionId:e===H?t.docId:void 0};const j=new class{constructor(){this.inputSchemasToWorkflows=new Map,this.inputSchemasToReduceWorkflows=new Map,this.reduceWorkflowsGroupingKeyExtractors=new Map,this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1},this.resultCache=new D,this.reduceTimerCache=new T,this.lookupTableCache=new Map,this.throttling=new x,this.lastTileRefreshSeq=-1,this.lastTileRefreshSeqByDocSessionId=new Map,this.tileRefreshByDocSessionIdEnabled=!0}init(e,t,s){const n=new p.I({operationName:"InitRuntimeALv1",resourceId:(0,d.k$)(e)});n.start(),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=(0,o.HF)()),this.hostCallbacks=s;const i=[];return i.push(this.isFeatureEnabled("DisableWebSocket").then((s=>{if(!!s)return!1;return!(["Outlook Mac","Outlook Win32","PowerPoint Mac","PowerPoint Web","PowerPoint Win32","Word Mac","Word Win32"].indexOf(`${t.appName} ${t.appPlatform}`)>=0)||((e,t)=>L.testConnection(e,t))(m.Aq.convertServiceUrlToWebSocket(e),this.clientMetadata)})).then((t=>{e&&(this.serviceUrl=t?m.Aq.convertServiceUrlToWebSocket(e):e,this.executeRemoteLambda=t?B:w,this.clearRemoteLambdaTokenCache=t?E:S,this.serviceProtocol=this.serviceUrl.split(":")[0].toLowerCase())}))),i.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then((e=>{F.executionQueuesEnabled=!e}))),i.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then((e=>{this.tileRefreshByDocSessionIdEnabled=!e}))),Promise.all(i).then((()=>{this.logOperation(n,!0)})).catch((e=>{this.logOperation(n,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerSchemas(e,t){return Promise.resolve()}registerSimpleLocalWorkflow(e,t,s=this.defaultWorkflowOptions){return t.source=t.source||R.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToWorkflows,s)}registerSimpleRemoteWorkflow(e,t,s,o,n=this.defaultWorkflowOptions){const i=[];return t&&(t.source=R.Custom,i.push(t)),s.source=s.func?R.Custom:R.Remote,i.push(s),o&&(o.source=R.Custom,i.push(o)),this.registerHardcodedWorkflow(e,i,this.inputSchemasToWorkflows,n)}registerMultipleLambdasWorkflow(e,t,s=this.defaultWorkflowOptions){return this.registerHardcodedWorkflow(e,t,this.inputSchemasToWorkflows,s)}registerReduceWorkflow(e,t,s,o=10,n=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t.inputSchema,s),this.resultCache.setBucketSize(t.inputSchema,o),t.source=t.source||R.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToReduceWorkflows,n)}registerMultipleLambdasReduceWorkflow(e,t,s,o=10,n=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t[0].inputSchema,s),this.resultCache.setBucketSize(t[0].inputSchema,o),this.registerHardcodedWorkflow(e,t,this.inputSchemasToReduceWorkflows,n)}submit(e,t,s){this.submitToWorkflows(e,t,s,this.inputSchemasToWorkflows)}getGroupingKey(e,t,s){const o=this.reduceWorkflowsGroupingKeyExtractors.get(s);if(null==o)throw new Error("Reduce workflow does not have a grouping extractor");return o(t,e)}submitToWorkflows(e,t,s,o=this.inputSchemasToWorkflows){if(!this.hostCallbacks)return;let n;n=s?g.W.fromString(s):new g.W,this.handleTileRefresh(e,t,n);const i=o.get(e)||[];for(const s of i)V(e,t)&&!s.triggerOnRefresh||(s.useCanaryTextTile&&e===W&&!s.canaryTextTileEventSubmittedByDocSessionId.has($(e,t))&&(this.submitToWorkflow(W,{type:(r=t).type,tile:{metadata:{docSessionId:r.tile.metadata.docSessionId,docId:r.tile.metadata.docId,seqnoCLPRefresh:r.tile.metadata.seqnoCLPRefresh,tileId:"A56B3127DBDFD0D6"},elements:[{text:"B91153AE828B4E48"}]}},n,s,o),s.canaryTextTileEventSubmittedByDocSessionId.add($(e,t))),this.submitToWorkflow(e,t,n,s,o));var r}submitToWorkflow(e,t,s,o,n){const r={messageType:i.G.Input,correlationVector:s.newChild(),payload:t,payloadSchema:G(o.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},a=new p.I({cv:r.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:o.name});a.setClientMetadata(this.clientMetadata),a.start(),o.scheduleExecution(t,(()=>{try{if(r.payload&&r.payload.tile&&r.payload.tile.metadata&&r.payload.tile.metadata.tileId){const s=r.payload.tile.metadata.tileId;this.throttling.execute(s,o,(()=>this.executeWorkflow(a,r,t,o,e,n)))}else this.executeWorkflow(a,r,t,o,e,n)}catch(e){a.success=!1,a.resultSignature="ExecuteException",a.resultDescription=e?e.message:"(no error)",h.tG.error(559290447,h.nh.CoreDefault,a.stop())}}))}handleTileRefresh(e,t,s){if(!V(e,t))return;const o=this.tileRefreshByDocSessionIdEnabled?$(e,t):void 0,n=((e,t)=>{var s,o;return U(e,t)?null===(o=null===(s=t.tile)||void 0===s?void 0:s.metadata)||void 0===o?void 0:o.seqnoCLPRefresh:(q(e,t),-1)})(e,t);if(this.tileRefreshByDocSessionIdEnabled){const e=this.lastTileRefreshSeqByDocSessionId.get(o);if(e>=0&&n<=e)return}else if(n<=this.lastTileRefreshSeq)return;const i=new p.I({cv:s.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});if(i.start(),this.tileRefreshByDocSessionIdEnabled&&!o)return i.success=!1,i.resultDescription="NoDocSessionId",void h.tG.info(559290448,h.nh.CoreDefault,i.stop());this.inputSchemasToReduceWorkflows.forEach(((e,t)=>{e.some((e=>e.triggerOnRefresh))&&(this.tileRefreshByDocSessionIdEnabled?(this.resultCache.clear(t,{primary:o}),this.resultCache.clear(this.getForcedDocLevelSchema(t),{primary:o}),this.reduceTimerCache.clear(t,o)):(this.resultCache.clear(t),this.resultCache.clear(this.getForcedDocLevelSchema(t)),this.reduceTimerCache.clear(t)),e.some((e=>!e.triggerOnRefresh))&&(i.resultDescription+="X_"),i.resultDescription+=t+" ")})),this.clearRemoteLambdaTokenCache();const r=[];this.inputSchemasToWorkflows.forEach((e=>r.push(...e))),this.inputSchemasToReduceWorkflows.forEach((e=>r.push(...e)));for(const e of r)this.tileRefreshByDocSessionIdEnabled?e.onRefresh(o):e.onRefresh();this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(o,n):this.lastTileRefreshSeq=n,h.tG.info(559290449,h.nh.CoreDefault,i.stop())}executeWorkflow(e,t,s,o,n,r){const c=o.docIdExtractor?o.docIdExtractor(t.payload):void 0,l=o.docSessionIdExtractor(s),u=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(l):this.lastTileRefreshSeq;o.onStart(l);const p=t=>{const c=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(l):this.lastTileRefreshSeq;if(o.triggerOnRefresh&&c!==u)return e.success=!0,e.resultSignature="TileRefreshIgnore",void h.tG.info(559290450,h.nh.CoreDefault,e.stop());const p=t.messageType==i.G.Exception&&t.payload.exceptionType==i.K.NoOutput,g=p&&o.canProduceNullResult,d=g?o.lambdas[o.lambdas.length-1].outputSchema:t.payloadSchema.schema.name,m=g?null:t.payload;t.messageType===i.G.Input||g?(o.shouldSendResultsToHost&&(r===this.inputSchemasToReduceWorkflows?this.hostCallbacks.onResult("Reduce.Input",s,d,m):this.hostCallbacks.onResult(n,s,d,m)),e.success=!0,e.resultSignature=p?"NoOutput":"ValidOutput"):p?(e.success=!0,e.resultSignature="NoOutput"):(e.success=!1,e.resultSignature="Exception",e.resultDescription=a(t)),r!==this.inputSchemasToReduceWorkflows&&this.updateResultCacheForReduceWorkflows(n,s,d,m,t.correlationVector.toString()),t.moreResults||(e.stop(),h.tG.info(559290451,h.nh.CoreDefault,e),o.onFinish(l,t.payload&&t.payload.exceptionType?(e=>null==e||null==e.payload||null==e.payload.exceptionType?i.K.Unknown:e.payload.exceptionType)(t):void 0))};o.preExecutionPromise.then((()=>{const e={lookupTable:this.lookupTableCache.get(o.name),docId:c,docSessionId:l};let s=p;for(let t=o.lambdas.length-1;t>=0;t--)s=this.createLambdaExecutionStep(o.name,o.lambdas[t],e,s,p);s(t)}))}getForcedDocLevelSchema(e){return`~${e}`}updateResultCacheForReduceWorkflows(e,t,s,o,n){const i=this.inputSchemasToReduceWorkflows.get(s);if(i){let r;"docSessionId"===e?(r=this.getGroupingKey(e,t,s),this.resultCache.setResult(this.getForcedDocLevelSchema(s),r,o),r.secondary="*"):(r=this.getGroupingKey(e,t,s),((e,t)=>e===W&&t&&t.type==l.TextTileEventType.Delete||e===H&&t&&t.eventType==u.SlideTileEventType.Delete)(e,t)&&null!=r.primary&&null!=r.secondary?this.resultCache.clear(void 0,r):this.resultCache.setResult(s,r,o));const a=i.some((e=>e.deferReduceUntilIdle)),c=[];this.inputSchemasToWorkflows.forEach((e=>c.push(...e.filter((e=>e.getOutputSchema()===s)))));const p=()=>a&&c.some((e=>e.executionCountByDocSessionId.get(r.primary)>0)),g=i.map((e=>e.deferReduceUntilIdleMaxDelayMs||0)).reduce(((e,t)=>Math.max(e,t)));this.reduceTimerCache.setReduceTimer(s,r.primary,(()=>{const e=this.resultCache.getResults(s,r);if(e.push(...this.resultCache.getResults(this.getForcedDocLevelSchema(s),{primary:r.primary})),Array.isArray(e)){const t={id:r.primary,values:e,isReduceInput:!0};this.submitToWorkflows(s,t,n,this.inputSchemasToReduceWorkflows)}else h.tG.error(559290452,h.nh.CoreDefault,`Cached results have unexpected type "${typeof e}"`)}),500,p,g)}}isFeatureEnabled(e,t=!1,s="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,s).catch((()=>Promise.resolve(t))):Promise.resolve(t)}areLicenseFeaturesEnabled(e){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(e).catch((()=>Promise.resolve(!1))):Promise.resolve(!1)}isWorkflowEnabled(e,t,s,o,n){if(t.some((e=>e.source===R.Remote||e.source===R.BatchedRemote))){if(!this.serviceUrl)return n.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&t.some((e=>(e.source===R.Remote||e.source===R.BatchedRemote)&&!e.canRunInPrivateMode)))return n.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}let i;return(!this.clientMetadata||"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)&&(o=!0,n.resultDescription="Enabled by default due to platform name"),i=o?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+e),i.then((t=>t?this.isFeatureEnabled("WorkflowDisabled."+e).then((e=>e?(n.resultDescription="Disabled because explicitly disabled",!1):!s||this.areLicenseFeaturesEnabled(s).then((e=>(e||(n.resultDescription="Disabled because license check failed"),e))))):(n.resultDescription="Disabled because not explicitly enabled",!1)))}registerHardcodedWorkflow(e,t,s=this.inputSchemasToWorkflows,o){if(!e||e.length>40)throw new Error("Workflow name has invalid length");if(!1===new RegExp(/^[A-Z][a-zA-Z0-9_]+$/).test(e))throw new Error("Workflow name has invalid format");s.forEach((t=>{if(t.some((t=>t.name===e)))throw new Error("Workflow name already registered.")}));const n=new p.I({operationName:"WorkflowRegistration",resourceId:e,success:!0});return n.setClientMetadata(this.clientMetadata),n.start(),this.isWorkflowEnabled(e,t,o.licenseFeatures,o.enabledByDefault,n).then((r=>{if(n.resultSignature=r?"Enabled":"Disabled",n.stop(),h.tG.info(559290453,h.nh.CoreDefault,n),r){const n=t[0].inputSchema;let r=s.get(n);r||(r=[],s.set(n,r));let a=Promise.resolve();o.lookupTableLambda&&(a=new Promise(((t,s)=>{const n=new g.W,r={messageType:i.G.Input,correlationVector:n,payloadSchema:G(o.lookupTableLambda.inputSchema),clientMetadata:this.clientMetadata,payload:{}},a=s=>{s.messageType===i.G.Input&&s.payload&&this.lookupTableCache.set(e,s.payload),t()};this.createLambdaExecutionStep("",o.lookupTableLambda,{},a,a)(r)})));const c=new F;c.name=e,c.lambdas=t,c.canProduceNullResult=o.canProduceNullResult,c.shouldSendResultsToHost=o.shouldSendResultsToHost,c.triggerOnRefresh=o.triggerOnRefresh,c.throttleSettings=o.throttleSettings||this.defaultWorkflowOptions.throttleSettings,c.docIdExtractor=o.docIdExtractor,c.docSessionIdExtractor=e=>e.isReduceInput?e.id:$(n,e),c.deferReduceUntilIdle=o.deferReduceUntilIdle,c.deferReduceUntilIdleMaxDelayMs=o.deferReduceUntilIdleMaxDelayMs,c.useCanaryTextTile=o.useCanaryTextTile,c.preExecutionPromise=a,r.push(c)}}))}logOperation(e,t,s,o){e.stop(),e.success=t,e.resultSignature=s,e.resultDescription=o,h.tG.info(559290454,h.nh.CoreDefault,e)}handleLambdaError(e,t,s,o,n){null!=e.exceptionType?c(t,e):e instanceof Error?c(t,{exceptionType:o,message:e.message}):c(t,{exceptionType:i.K.Unknown,message:e?e.toString():void 0}),this.logOperation(s,!1,"Exception",a(t)),n(t)}handleLambdaOutput(e,t,s,o,n,r){e&&e.exceptionType!==i.K.NoOutput?null!=e.exceptionType?this.handleLambdaError(e,t,s,e.exceptionType,r):e instanceof Error?this.handleLambdaError(e,t,s,i.K.LambdaErrorCallback,r):(t.payload=e,t.payloadSchema=G(o),this.logOperation(s,!0),n(t)):(c(t,{exceptionType:i.K.NoOutput}),this.logOperation(s,!0,"NoOutput"),r(t))}executeCustomLambdaStep(e,t,s,o,n,r){if(null==s.func)c(e,{exceptionType:i.K.LambdaThrow,message:"No lambda function set"}),this.logOperation(t,!1,"Error",a(e)),r(e);else{const a=o=>{this.handleLambdaOutput(o,e,t,s.outputSchema,n,r)},c=(s,o)=>{this.handleLambdaOutput(s,e,t,o,r,r)};try{s.func(e.payload,s.config,o,a,c)}catch(s){this.handleLambdaError(s,e,t,i.K.LambdaThrow,r)}}}executeLocalLambdaStep(e,t,s,o,n){null==this.hostCallbacks.executeLocalLambda?(c(e,{exceptionType:i.K.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(t,!1,"Error",a(e)),n(e)):this.hostCallbacks.executeLocalLambda(s.inputSchema,e.payload,s.outputSchema).then((i=>{this.handleLambdaOutput(i,e,t,s.outputSchema,o,n)})).catch((s=>{this.handleLambdaError(s,e,t,i.K.LambdaThrow,n)}))}executeRemoteLambdaStep(e,t,s,o,n,r){if(this.serviceUrl){t.resourceId+=`.${this.serviceProtocol}`;const a=(o,a)=>{o?this.handleLambdaError(o,e,t,o.exceptionType||i.K.LambdaErrorCallback,r):this.handleLambdaOutput(a,e,t,s.outputSchema,n,r)};if(o.authTickets=s.authTickets,s.source===R.Remote)this.executeRemoteLambda(this.serviceUrl,e,G(s.inputSchema),G(s.outputSchema),e.correlationVector,this.clientMetadata,this.hostCallbacks,o,a);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=new y.Y(((e,t,s)=>{const{remoteLambda:o,lambdaContext:n}=t.context;this.executeRemoteLambda(this.serviceUrl,{messageType:i.G.Input,correlationVector:{id:t.cv},payload:e,payloadSchema:G(o.inputSchema),clientMetadata:this.clientMetadata},G(o.remoteInputSchema),G(o.remoteOutputSchema),{id:t.cv},this.clientMetadata,this.hostCallbacks,n,s)}),!1,!1,((e,t,s)=>{var o;const{lambdaContext:n}=s;this.updateResultCacheForReduceWorkflows("docSessionId",null!==(o=n.docSessionId)&&void 0!==o?o:n.docId,e,t)})));const{batchOptions:t}=s,n=this.normalizeBatchOptions(t),{groupingKeyExtractor:r}=n;n.groupingKeyExtractor=e=>`${s.name}-${r(e)}`;const c={name:s.name,remoteLambda:s,lambdaContext:o};this.batchedRemoteLambdaManager.addBatchItem(e.payload,n,c,e.correlationVector.id.length>127?e.correlationVector.id.substring(0,127)+"!":e.correlationVector.id,void 0,a)}}else c(e,{exceptionType:i.K.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(t,!1,"Error",a(e)),r(e)}createLambdaExecutionStep(e,t,s,o,n){return r=>{const l=new p.I({cv:r.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:t.name,dimension0:e});l.start(),t.source===R.Custom?this.executeCustomLambdaStep(r,l,t,s,o,n):t.source===R.Local?this.executeLocalLambdaStep(r,l,t,o,n):t.source===R.Remote||t.source===R.BatchedRemote?this.executeRemoteLambdaStep(r,l,t,s,o,n):(c(r,{exceptionType:i.K.LambdaThrow,message:"Unknown/No lambda location set"}),this.logOperation(l,!1,"Error",a(r)),n(r))}}normalizeBatchOptions(e){if(!e)throw new Error("Expected batchConfig");const t=Object.assign({},e);return e.estimateSize||(t.estimateSize=f.E),t}};var z=s(79002),Q=s(74444);class K{static createFactory(e,t,s,o,n){return i=>{var r;const a=o||Q.e3;return!K.onnxRetrievalPromise||i?e&&t?((null===(r=a())||void 0===r?void 0:r.ort)&&!i?Promise.resolve():(0,Q.el)(this.createCdnUrl(e,t),a,"ort",s,n)).then((()=>{K.onnxRetrievalPromise=Promise.resolve(new K(a))})).catch((e=>{K.onnxRetrievalPromise=Promise.reject(e)})).then((()=>K.onnxRetrievalPromise)):Promise.reject(new Error("Error: appName and/or version not provided")):K.onnxRetrievalPromise}}static createCdnUrl(e,t){return`https://${e}${t}`}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var s;const o=null===(s=this.getCache())||void 0===s?void 0:s.ort;return(0,Q.kQ)(e,t||"",o)}createInputs(){return(0,Q.In)()}}var J=s(48513),Y=s(72062),Z=s(36835),X=s(60990),ee=s(94727),te=s(82076),se=s(76916),oe=s(26529),ne=s(27420);class ie{constructor(e){te.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return te.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class re{constructor(e){te.h.assign(re,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelWorkbookUpdated"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class ae{constructor(e){te.h.assign(ae,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelAccessTokenRefreshed"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[ae.getTypeName()])}}ae.H_={T_:ae.getTypeName(),B_:ae.getBaseTypes()};class ce{constructor(e){te.h.assign(ce,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelKeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};class le{constructor(e){te.h.assign(le,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelRetrieveModelRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class ue{constructor(e){te.h.assign(ue,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelRetrieveModelResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return te.h.matchesTypesFor(e,[ue.getTypeName()])}}ue.H_={T_:ue.getTypeName(),B_:ue.getBaseTypes()};class pe{constructor(e){te.h.assign(pe,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionDiagnosticsRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[pe.getTypeName()])}}pe.H_={T_:pe.getTypeName(),B_:pe.getBaseTypes()};class ge{constructor(e){te.h.assign(ge,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionDiagnosticsResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return te.h.matchesTypesFor(e,[ge.getTypeName()])}}ge.H_={T_:ge.getTypeName(),B_:ge.getBaseTypes()};class he{constructor(e){te.h.assign(he,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_AdvanceMockGridState"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[he.getTypeName()])}}he.H_={T_:he.getTypeName(),B_:he.getBaseTypes()};class de{constructor(e){te.h.assign(de,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return te.h.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class me{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){te.h.assign(me,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ObserverStatusAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return te.h.matchesTypesFor(e,[me.getTypeName()])}}me.H_={T_:me.getTypeName(),B_:me.getBaseTypes()};class ye{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){te.h.assign(ye,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_FullSeedingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return te.h.matchesTypesFor(e,[ye.getTypeName()])}}ye.H_={T_:ye.getTypeName(),B_:ye.getBaseTypes()};class fe{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){te.h.assign(fe,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_WorkflowProgressAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return te.h.matchesTypesFor(e,[fe.getTypeName()])}}fe.H_={T_:fe.getTypeName(),B_:fe.getBaseTypes()};class Te{constructor(e){te.h.assign(Te,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[Te.getTypeName()])}}Te.H_={T_:Te.getTypeName(),B_:Te.getBaseTypes()};class _e{constructor(e){te.h.assign(_e,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return te.h.matchesTypesFor(e,[_e.getTypeName()])}}_e.H_={T_:_e.getTypeName(),B_:_e.getBaseTypes()};class Ce{constructor(e){te.h.assign(Ce,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return te.h.matchesTypesFor(e,[Ce.getTypeName()])}}Ce.H_={T_:Ce.getTypeName(),B_:Ce.getBaseTypes()};var ve=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))},Se=function(e){return this instanceof Se?(this.v=e,this):new Se(e)},Ae=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=s.apply(e,t||[]),i=[];return o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o;function r(e){n[e]&&(o[e]=function(t){return new Promise((function(s,o){i.push([e,t,s,o])>1||a(e,t)}))})}function a(e,t){try{(s=n[e](t)).value instanceof Se?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}},we=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(s){t[s]=e[s]&&function(t){return new Promise((function(o,n){(function(e,t,s,o){Promise.resolve(o).then((function(t){e({value:t,done:s})}),t)})(o,n,(t=e[s](t)).done,t.value)}))}}};const Ie=(e,t)=>{const s=[];for(const n of Object.keys(e)){if(void 0===e[n]||null===e[n])continue;const i={name:t?`${t}.${n}`:n,dataType:(o=e[n],"string"==typeof o?0:"boolean"==typeof o?1:"number"==typeof o?2:void ne.Hv.sendTraceTag(572838285,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Warning,"Unsupported data field type")),value:e[n],classification:4};s.push(i)}var o;return s},Ne=e=>Promise.resolve(!1);class be{constructor(){this._telemetryAggregationIntervalSec=30,this._eventHandlerDictionary={},this._changeGateEnabledCallback=void 0,this._bridge=null,this._bridgeInterceptor=null,this._sessionCloseReason=null,this._sessionConnectParams=null,this._serverAuthenticationState=J.f.NotAuthenticated,this._connectCallbacks=new Map,this._connectionStateCallbackToken=0,this._claimsChallengeCallbacks=[],this._seedingStatusChangeCallbacks=[],this._bridgeMessageSequenceId=0,this._settings={sendConnectionParamsAcrossBridge:!1,stampBridgeMessageWithSequenceId:!1},this.initialize=e=>{if(this._runtimeInitPromise)return void ne.Hv.sendTraceTag(572838286,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,"Runtime already initialized");ne.Hv.sendTraceTag(572838287,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,"Start and initialize augloop runtime ..."),this.checkParametersAndThrow("initialize",e);const t=[];t.push(this.isFeatureEnabled("ModelDownloaderEbrake","None").then((t=>{t?ne.Hv.sendTraceTag(556376070,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,"Resource downloader not created due to feature gate"):this.modelDownloaderFromCDN=e.appName&&e.downloadBaseUrl||e.downloadPolymerBaseUrl?new z.$(e.appName,e.downloadBaseUrl,e.downloadPolymerBaseUrl):void 0}))),this.inferenceServiceFactory=e.appName&&e.inferenceServiceVersion?K.createFactory(e.appName,e.inferenceServiceVersion):void 0,this.excelServerParameters=e.excelServer,this.powerpointParameters=e.powerpoint;const s={appName:e.appName,appPlatform:"Web",appVersion:e.appVersion,uiLanguage:e.uiLanguage,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseCustomAudience:e.releaseCustomAudience,releaseFork:e.releaseFork,sessionId:e.sessionId,flights:e.flights,privateMode:e.privateMode,disabledServiceGroups:e.disabledServiceGroups,userSystemTimezone:e.userSystemTimezone,isClientTelemetrySampled:e.isClientTelemetrySampled},n={onResult:this.onResult.bind(this),onAnnotationResult:this.onAnnotationResult.bind(this),sendTelemetryEvent:this.sendTelemetryEvent.bind(this),sendDiagnosticTrace:this.sendDiagnosticTrace.bind(this),requestAuthToken:this.requestAuthToken.bind(this),isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this),setSessionData:this.setSessionData.bind(this),areLicenseFeaturesEnabled:Ne,onInitSession:this.onInitSession.bind(this),overrideSessionInitMessage:this.overrideSessionInitMessage.bind(this)};t.push(this.isChangeGateEnabled("SendConnectionParamsAcrossBridge").then((e=>{this._settings.sendConnectionParamsAcrossBridge=e}))),t.push(this.isChangeGateEnabled("StampBridgeMessageWithSequenceId").then((e=>{this._settings.stampBridgeMessageWithSequenceId=e})));const i=Promise.all(t).then((()=>o.fA.init(e.serviceUrl,s,n,{telemetryAggregationIntervalSec:this._telemetryAggregationIntervalSec,modelDownloader:this.modelDownloaderFromCDN,inferenceServiceFactory:this.inferenceServiceFactory,isDeltaGeneratorEnabled:e.isDeltaGeneratorEnabled,disableSyncDeltaSending:e.disableSyncDeltaSending,syncDeltaTimeout:e.syncDeltaTimeout}))).then((()=>j.init(e.serviceUrl,s,n)));let r=e.sessionCreationOptions;r||(r={});const a=r.onServerAuthenticationStateChangeCallback;r.onServerAuthenticationStateChangeCallback=e=>{this._serverAuthenticationState=e,a&&a(e),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Y.wU({serverAuthenticationState:e})})};const c=r.onSessionClose;r.onSessionClose=e=>{this._sessionCloseReason=e.reason,c&&c(e),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:e})};const l=r.onSessionConnect;r.onSessionConnect=(e,t,s,o)=>{l&&l(e,t,s,o),this._connectCallbacks.forEach(((n,i)=>{n(e,t,s,o)})),this._bridge&&(!this._sessionConnectParams&&this._settings.sendConnectionParamsAcrossBridge&&(this._sessionConnectParams={authToken:o,isSeedingRequired:e,sessionUrl:t,origin:s},this.sendSessionInitResponseToBridge("*","*")),this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Y.gy({isSeedingRequired:e,sessionUrl:t,origin:s,authToken:o})}))};const u=r.onSessionReconnect;r.onSessionReconnect=()=>{u&&u(),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Y.lj})};const p=r.onSessionDisconnect;r.onSessionDisconnect=e=>{p&&p(e),this._bridge&&(this._sessionConnectParams=void 0,this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Y.eG({error:e})}))};const g=r.onClaimsChallengeCallback;r.onClaimsChallengeCallback=e=>{g&&g(e),this._claimsChallengeCallbacks.forEach((t=>{t(e)}))};const h=r.onSeedingStatusChangeCallback;r.onSeedingStatusChangeCallback=e=>{h&&h(e),this._seedingStatusChangeCallbacks.forEach((t=>{t(e)}))},this.createSession=()=>{this._runtimeInitPromise=i.then((()=>{const t=r&&r.docSessionId||e.sessionId;return o.fA.createSession(Object.assign(Object.assign({},r),{docSessionId:t}))}))},this.createSession()},this.getSession=()=>this._runtimeInitPromise,this.setULSLogger=e=>{this.checkParametersAndThrow("setULSLogger",e&&e.ulsLogger),ne.Hv.setLogger(e.ulsLogger)},this.setSendOTelEventCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",e&&e.sendOTelEvent,this._sendOTelEventCallback),this._sendOTelEventCallback=e.sendOTelEvent},this.setSendDiagnosticTraceCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendDiagnosticTraceCallback",e&&e.sendDiagnosticTraceCallback,this._sendDiagnosticTraceCallback),this._sendDiagnosticTraceCallback=e.sendDiagnosticTraceCallback},this.setRequestAuthTokenCallback=e=>{this.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",e&&e.requestAuthTokenCallback,this._requestAuthTokenCallback),this._requestAuthTokenCallback=e.requestAuthTokenCallback},this.setIsFeatureEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",e&&e.featureEnabledCallback,this._featureEnabledCallback),this._featureEnabledCallback=e.featureEnabledCallback},this.setIsChangeGateEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsChangeGateEnabledCallback",e&&e.changeGateEnabledCallback,this._changeGateEnabledCallback),this._changeGateEnabledCallback=e.changeGateEnabledCallback},this.registerLocalWorkflow=e=>{const t="registerLocalWorkflow";this.checkParametersAndThrow(t,e&&e.workflow),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.registerLocalWorkflow(e.workflow)}))},this.activateAnnotation=e=>{const t="activateAnnotation",s=this.checkParameters(t,e&&e.annotationType)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{let s;return(e.config||e.handler||e.stateUpdateHandler)&&(s={config:e.config,callback:e.handler,apologyCallback:e.apologyHandler,stateUpdateCallback:e.stateUpdateHandler,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}),t.activateAnnotation(e.annotationType,s)}))},this.updateAnnotationConfig=e=>{const t="updateAnnotationConfig",s=this.checkParameters(t,e&&e.token&&e.config)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{t.updateAnnotationConfig(e.token,e.config)}))},this.releaseAnnotation=e=>{const t="releaseAnnotation",s=this.checkParameters(t,e&&e.token)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.releaseAnnotation(e.token)))},this.submitOperation=e=>{const t="submitOperation";this.checkParametersAndThrow(t,e&&e.operation),this.checkRuntimeInit(t),this._runtimeInitPromise.then((t=>{t.submitOperation(e.operation,e.cv)}))},this.setSessionDataCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionDataCallback",e&&(e.sessionDataCallback||e.handler),this._setSessionDataCallback),e.sessionDataCallback?this._setSessionDataCallback=e.sessionDataCallback:e.handler&&(this._setSessionDataCallback=(t,s,o)=>e.handler(t,s))},this.setAnnotationResultCallback=e=>{const t="setAnnotationResultCallback";if(this.checkParametersAndThrow(t,e&&e.handler),this._annotationResultCallback){const e=`${t} already called`;ne.Hv.sendTraceTag(537401028,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,e)}this._annotationResultCallback=e.handler},this.setAnnotationState=e=>{const t="setAnnotationState";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationState(e.parentPath,e.id,e.value)}))},this.setAnnotationMetadata=e=>{const t="setAnnotationMetadata";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationMetadata(e.parentPath,e.id,e.value)}))},this.setInitSessionCallback=e=>{this.checkParametersAndPropertyAndThrow("setInitSessionCallback",e&&e.initSessionCallback,this._initSessionCallback),this._initSessionCallback=e.initSessionCallback},this.setSessionInitOverrideCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",e&&e.handler,this._sessionInitOverrideCallback),this._sessionInitOverrideCallback=e.handler},this.setMessageBridge=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridge",e&&e.bridge,this._bridge),this._bridge=e.bridge,this._bridge.registerMessageReceivedCallback(this.onBridgeMessage.bind(this))},this.setMessageBridgeToALInterceptor=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridgeToALInterceptor",e&&e.bridge,this._bridgeInterceptor),this._bridgeInterceptor=e.bridge,this._bridgeInterceptor.registerMessageReceivedCallback(this.onBridgeMessageFromInterceptor.bind(this))},this.forceReconnectSession=e=>{const t="forceReconnectSession",s=this.checkParameters(t,e)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>(e.excelServerParameters&&(this.excelServerParameters=e.excelServerParameters),t.forceReconnect())))},this.setSessionCloseCallback=e=>{const t="setSessionCloseCallback",s=this.checkParameters(t,e&&e.callback)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{t.setSessionCloseCallback(e.callback)}))},this.setConnectCallback=e=>{const t=this.getSessionStateCallbackToken("connect");return e.callback&&this._connectCallbacks.set(t,e.callback),t},this.removeConnectionStateCallback=e=>!!this._connectCallbacks.has(e.token)&&(this._connectCallbacks.delete(e.token),!0),this.setSeedingStatusChangeCallback=e=>{this._seedingStatusChangeCallbacks.push(e.callback)},this.submitCustomMessage=e=>{const t="submitCustomMessage",s=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.submitCustomMessage(e.message)))},this.submitLargeBinaryDataMessage=e=>{const t="submitLargeBinaryDataMessage",s=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return s?Promise.reject(s):Y.VR.typeGuard(e.message)?this._runtimeInitPromise.then((t=>t.submitLargeBinaryDataMessage(e.message))):Promise.reject(`${t} only supports MicroSyncMessage`)},this.requestBinaryDataForBlob=e=>{const t="requestBinaryDataForBlob",s=this.checkParameters(t,e&&e.blob)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.requestBinaryDataForBlob(e.blob)))},this.closeSession=()=>{const e=this.checkRuntimeInit("closeSession");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>{e.close()}))},this.startNewSession=()=>{if(!this.createSession){const e="startNewSession called before runtime init";throw ne.Hv.sendTraceTag(537408074,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,e),new Error(e)}this.createSession(),this._sessionCloseReason=null,this._sessionConnectParams=null},this.authenticateInteractive=()=>{const e=this.checkRuntimeInit("authenticateInteractive");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>e.authenticateInteractive()))},this.getAnnotations=e=>{const t="getAnnotations",s=this.checkParameters(t,e&&e.request),o=this.checkRuntimeInit(t),n=s||o;return n?Promise.resolve({[Symbol.asyncIterator](){return Ae(this,arguments,(function*(){yield yield Se({content:void 0,error:{clientError:{code:s?Z.zy.InvalidRequest:Z.zy.RuntimeNotInitialized,error:null==n?void 0:n.message}}})}))}}):this._runtimeInitPromise.then((t=>t.getAnnotations(e.request,e.cancellationToken)))},this.submit=e=>{const t="submit";this.checkParametersAndThrow(t,e&&e.inputSchema&&e.input),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((()=>{j.submit(e.inputSchema,e.input,e.correlationVector)}))},this.addEventHandler=e=>{this.checkParametersAndThrow("addEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName]||[];t.push(e.handler),this._eventHandlerDictionary[e.schemaName]=t},this.removeEventHandler=e=>{this.checkParametersAndThrow("removeEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName];if(!Array.isArray(t))return;const s=t.indexOf(e.handler);s>=0&&t.splice(s,1)},this.registerSimpleRemoteWorkflow=e=>{const t="registerSimpleRemoteWorkflow",s=this.checkParameters(t,e&&e.name&&e.lambdaRemote)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((()=>j.registerSimpleRemoteWorkflow(e.name,e.lambdaBefore,e.lambdaRemote,e.lambdaAfter)))},this.registerSimpleLocalWorkflow=e=>{const t="registerSimpleLocalWorkflow",s=this.checkParameters(t,e&&e.name&&e.lambda)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((()=>j.registerSimpleLocalWorkflow(e.name,e.lambda)))},this.registerReduceWorkflow=e=>Promise.resolve(),this.registerSchemas=e=>Promise.resolve(),this.onResult=(e,t,s,o)=>{const n=this._eventHandlerDictionary[s];if(n)for(const i of n)if(i){i({inputSchema:e,input:t,outputSchema:s,output:o})}},this.onAnnotationResult=(e,t)=>{this._annotationResultCallback&&this._annotationResultCallback(e,t)},this.requestAuthToken=e=>{if(!this._requestAuthTokenCallback)return Promise.resolve({Token:""});return(this._requestAuthTokenCallback(e)||Promise.resolve("")).then((e=>{const t=e||"";return Promise.resolve({Token:t})}))},this.sendTelemetryEvent=(e,t,s,o,n,i,r,a)=>{this._sendOTelEventCallback&&this._sendOTelEventCallback(((e,t,s,o,n,i,r)=>{const a={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:Ie(s),eventFlags:{dataCategories:i,diagnosticLevel:r,samplingPolicy:1}};return o&&(a.eventContract={name:o,dataFields:Ie(n,o.split(".").slice(-1)[0])}),a})(e,t,s,o,n,r,a))},this.sendDiagnosticTrace=(e,t,s)=>{this._sendDiagnosticTraceCallback&&this._sendDiagnosticTraceCallback(e,t,s)},this.isFeatureEnabled=(e,t)=>{if(!e)return Promise.resolve(!1);const s="Microsoft.Office.AugLoop.";if(0===e.indexOf(s)&&this._featureEnabledCallback){const t=e.slice(25);return Promise.resolve(this._featureEnabledCallback(t)||this._featureEnabledCallback(e))}return Promise.resolve(!1)},this.isChangeGateEnabled=e=>e&&this._changeGateEnabledCallback?Promise.resolve(this._changeGateEnabledCallback(e)):Promise.resolve(!1),this.setSessionData=(e,t,s)=>{this._setSessionDataCallback&&this._setSessionDataCallback(e,t,s)},this.overrideSessionInitMessage=e=>this._sessionInitOverrideCallback?this._sessionInitOverrideCallback(e):0===e.clientMetadata.appName.indexOf("Excel")&&this.excelServerParameters?this.overrideExcelSessionInitMessage(e):0===e.clientMetadata.appName.indexOf("PowerPoint")&&this.powerpointParameters?this.overridePowerPointSessionInitMessage(e):e,this.overrideExcelSessionInitMessage=e=>{const t={cluster:this.excelServerParameters.wacCluster,restUrl:this.excelServerParameters.ecsRestUrl,ecsId:this.excelServerParameters.ecsSessionId,ecsOperationUrl:this.excelServerParameters.ecsOperationUrl,workbookMetadataVersion:this.excelServerParameters.metadataVersion,serverEventVersion:this.excelServerParameters.serverEventVersion,permissionFlags:this.excelServerParameters.permissionFlags,configurations:this.excelServerParameters.configurations,collabUserListVersion:this.excelServerParameters.userListVersion,collabStateId:this.excelServerParameters.collabStateId,accessToken:this.excelServerParameters.accessToken,accessTokenTTL:this.excelServerParameters.accessTokenTTL,supportCustomMessages:this.excelServerParameters.supportCustomMessages};for(const s of Object.keys(e))t[s]=e[s];return new Te(t)},this.overridePowerPointSessionInitMessage=e=>{const t={downloadUrl:this.powerpointParameters.downloadUrl,getItemsEndPoint:this.powerpointParameters.getItemsEndPoint,documentOpenType:this.powerpointParameters.documentOpenType};for(const s of Object.keys(e))t[s]=e[s];return new _e(t)},this.onInitSession=()=>this._initSessionCallback?this._initSessionCallback():Promise.resolve(),this.checkParameters=(e,t)=>{if(!t){const t=`${e} called with invalid parameters`;return ne.Hv.sendTraceTag(537408075,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,t),new Error(t)}},this.checkParametersAndThrow=(e,t)=>{const s=this.checkParameters(e,t);if(s)throw s},this.checkParametersAndPropertyAndThrow=(e,t,s)=>{if(this.checkParametersAndThrow(e,t),s){const t=`${e} already called`;throw ne.Hv.sendTraceTag(537408076,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,t),new Error(t)}},this.checkRuntimeInit=e=>{if(!this._runtimeInitPromise){const t=`${e} called before runtime init`;return ne.Hv.sendTraceTag(537408077,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,t),new Error(t)}},this.checkRuntimeInitAndThrow=e=>{const t=this.checkRuntimeInit(e);if(t)throw t},this.sendBridgeMessage=e=>{this._bridge&&(this._settings.stampBridgeMessageWithSequenceId&&(e.seq=this._bridgeMessageSequenceId++),this._bridge.sendMessage(JSON.stringify(new Y.vG(e))))},this.onBridgeMessage=e=>{null!=this._bridgeInterceptor?this._bridgeInterceptor.sendMessage(e):this.handleReceivedBridgeMessage(e)},this.sendSessionInitResponseToBridge=(e,t)=>{if(this._sessionConnectParams&&this._settings.sendConnectionParamsAcrossBridge){const s=this._sessionConnectParams.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new Y.uN({origin:this._sessionConnectParams.origin,sessionKey:s.split("/").pop(),sessionUrlBase:s.split("/").slice(0,-1).join("/"),anonymousToken:this._sessionConnectParams.authToken})})}},this.handleReceivedBridgeMessage=e=>{try{const{bridgeId:t,docSessionId:s,message:o}=JSON.parse(e),n=te.h.getTypeNameFor(o);if(ne.Hv.sendTraceTag(509092291,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,`Received ${n}`),null!=this._sessionCloseReason&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new Y.w9({reason:this._sessionCloseReason})}),Y.n4.typeGuard(o)){const e=this.activateAnnotation({annotationType:o.annotationType,config:o.config,handler:(e,n)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Y.B_({annotationType:o.annotationType,ops:[e],cv:n})})},forceReturnCachedAnnotations:o.forceReturnCachedAnnotations}).then((e=>new Y.PY({messageId:o.messageId,token:e.token})));this.sendResponseAcrossBridge(e,o,t,s)}else if(ee.x5.typeGuard(o))this.handleGetAnnotationsRequestMessage(t,s,o);else if(Y.Tb.typeGuard(o)){for(const e of o.ops)this.submitOperation({operation:e,cv:o.cv});this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new Y.YK({messageId:o.messageId})}),ne.Hv.sendTraceTag(509092288,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,`Responded to ${n}`)}else if(Y.GA.typeGuard(o)){const e=this.releaseAnnotation({token:o.token}).then((e=>new Y.Qq({messageId:o.messageId,lastRelease:e})));this.sendResponseAcrossBridge(e,o,t,s)}else if(Y.g$.typeGuard(o))this.submitCustomMessage({message:o.customMessage}).then((e=>{Y.YK.typeGuard(e)?(e.messageId=o.messageId,ne.Hv.sendTraceTag(508432467,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,`Responded to ${n}`)):ne.Hv.sendTraceTag(508420946,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:e})})).catch((e=>{ne.Hv.sendTraceTag(508436636,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,e.message),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new Y._p({messageId:o.messageId,error:e.message})})}));else if(Y.eE.typeGuard(o))this.sendSessionInitResponseToBridge(t,s),this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Y.wU({serverAuthenticationState:this._serverAuthenticationState})});else if(te.h.matchesTypesFor(o,[X.i2.getTypeName()])){const e=this._runtimeInitPromise.then((e=>e.authenticateInteractive())).then((()=>new Y.YK({messageId:o.messageId})));this.sendResponseAcrossBridge(e,o,t,s)}else if(te.h.matchesTypesFor(o,[X.og.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new X.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{ne.Hv.sendTraceTag(506474634,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else if(te.h.matchesTypesFor(o,[X.tj.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new X.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);this._claimsChallengeCallbacks.push(e),this._runtimeInitPromise.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{ne.Hv.sendTraceTag(506987159,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else ne.Hv.sendTraceTag(509092259,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Warning,`Did not respond to ${n} with Id ${o.messageId}`)}catch(e){ne.Hv.sendTraceTag(509092363,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new Y._p({messageId:"unknown",error:e.message})})}},this.handleGetAnnotationsRequestMessage=(e,t,s)=>{const o={request:{annotationType:s.annotationTypes,sourceInfo:s.sourceInfo,configs:s.configs,transientItems:s.transientItems,maxDelayMs:s.maxDelayMs,cv:s.cv}};this.getAnnotations(o).then((o=>{var n,i,r;return ve(this,void 0,void 0,(function*(){var a,c,l,u,p,g;try{for(n=!0,i=we(o);!(a=(r=yield i.next()).done);n=!0){u=r.value,n=!1;const o=u,i=new ee.rK({content:o.content,errorInfo:null===(p=o.error)||void 0===p?void 0:p.serviceError}),a=new X.wR({messageId:s.messageId,serverResponse:JSON.stringify(i),clientError:null===(g=o.error)||void 0===g?void 0:g.clientError,finalResponse:o.finalResponse});this.sendResponseAcrossBridge(Promise.resolve(a),s,e,t)}}catch(e){c={error:e}}finally{try{n||a||!(l=i.return)||(yield l.call(i))}finally{if(c)throw c.error}}}))}))},this.sendResponseAcrossBridge=(e,t,s,o)=>{e.catch((e=>new Y._p({messageId:t.messageId,error:e.message}))).then((e=>{this.sendBridgeMessage({bridgeId:s,docSessionId:o,response:e}),ne.Hv.sendTraceTag(508937624,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Info,`Responded to ${te.h.getTypeNameFor(t)}`)})).catch((e=>{ne.Hv.sendTraceTag(508937623,se.n.msoulscat_Wac_BrowserGeneral,oe.k.Error,e.message)}))},this.onBridgeMessageFromInterceptor=e=>{this.handleReceivedBridgeMessage(e)}}getSessionStateCallbackToken(e){return e+"-callback-"+this._connectionStateCallbackToken++}}var ke=s(73449);class Me{constructor(e){te.h.assign(Me,this,e)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return te.h.matchesTypesFor(e,[Me.getTypeName()])}}Me.H_={T_:Me.getTypeName(),B_:Me.getBaseTypes()};class Ee{constructor(e){te.h.assign(Ee,this,e)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(e){return te.h.matchesTypesFor(e,[Ee.getTypeName()])}}Ee.H_={T_:Ee.getTypeName(),B_:Ee.getBaseTypes()};class Le{constructor(e){te.h.assign(Le,this,e)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return te.h.matchesTypesFor(e,[Le.getTypeName()])}}Le.H_={T_:Le.getTypeName(),B_:Le.getBaseTypes()};class Pe{constructor(e){te.h.assign(Pe,this,e)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(e){return te.h.matchesTypesFor(e,[Pe.getTypeName()])}}Pe.H_={T_:Pe.getTypeName(),B_:Pe.getBaseTypes()};class Be{constructor(e){te.h.assign(Be,this,e)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(e){return te.h.matchesTypesFor(e,[Be.getTypeName()])}}Be.H_={T_:Be.getTypeName(),B_:Be.getBaseTypes()};var De=s(70825),Re=s(63455);class Oe{static create(e){const t=new Oe(e);return t.activateAnnotation(e.responseType).then((()=>t))}constructor(e){this.config=e,this.nextMessageId=0,this.responseCallbacks=new Map;const t=["session","chats"],s=(0,Re.v4)(),o="messages",n=[...t,s];this.messagesPath=[...n,o],this.config.session.submitOperations([new De.Xr({parentPath:t,items:[{id:s,body:e.chat}]}),new De.Xr({parentPath:n,items:[{id:o,body:new Le}]})])}send(e,t){const s=""+this.nextMessageId++;this.responseCallbacks.set(s,t),this.config.session.submitOperations([new De.Xr({parentPath:this.messagesPath,items:[{id:s,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,{callback:e=>{if(De.Xr.typeGuard(e)&&this.isUnderSubtree(e.parentPath,this.messagesPath))for(const t of e.items){const s=e.parentPath[e.parentPath.length-1],o=this.responseCallbacks.get(s);o&&(o(t.body),this.responseCallbacks.delete(s))}}}).then((({token:e})=>{this.activatedAnnotationToken=e}))}isUnderSubtree(e,t){if(e.length<t.length)return!1;for(let s=0;s<t.length;s++)if(e[s]!==t[s])return!1;return!0}}const xe=new class{constructor(){this._augLoopRuntimeManager=new be}getAugLoopRuntimeManager(){return this._augLoopRuntimeManager}createSingleItemWorkflow(e){return ke.z.create(e)}createChatHelper(e){return this.getAugLoopRuntimeManager().getSession().then((t=>Oe.create(Object.assign({session:t},e))))}createAugLoopRuntimeManager(){return new be}}},33345:(e,t,s)=>{s.d(t,{_:()=>i});var o=s(74444),n=s(64820);class i{static createFactory(e=".",t,s,n){return r=>{var a;const c=s||o.e3;return!i.onnxRetrievalPromise||r?e?((null===(a=c())||void 0===a?void 0:a.ai_outlook)&&!r?Promise.resolve():(0,o.el)(`${e}/ai_outlook.min.js`,c,"ai_outlook",t,n)).then((()=>{i.onnxRetrievalPromise=Promise.resolve(new i(c))})).catch((e=>{i.onnxRetrievalPromise=Promise.reject(e)})).then((()=>i.onnxRetrievalPromise)):Promise.reject(new Error("Error: folderPath not provided")):i.onnxRetrievalPromise}}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var s;const o=null===(s=this.getCache())||void 0===s?void 0:s.ai_outlook;return o?(o.env.wasm.simd=!0,o.env.wasm.numThreads=0,n.Kx.create(e,t||"",o)):Promise.reject(new Error("Error: aiOutlook is undefined"))}createInputs(){return n.G0.create()}}},64820:(e,t,s)=>{s.d(t,{G0:()=>l,Kx:()=>c,fE:()=>a});var o=s(38263),n=s(25765),i=s(89700),r=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function a(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,n.tG.info(540406806,n.nh.CoreDefault,e.stop()),!0)}class c{constructor(e,t,s){this.session=e,this.onnxObject=s,this.modelName=t}static create(e,t,s){return r(this,void 0,void 0,(function*(){const o=new i.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return o.start(),s[e]?(o.resultDescription="Model already existed",n.tG.info(509699716,n.nh.CoreDefault,o.stop()),s[e]):s[e]=this.getInferenceSession(s).create(e).then((e=>(n.tG.info(540406807,n.nh.CoreDefault,o.stop()),new c(e,t,s)))).catch((e=>{throw o.resultDescription=`Error: ${e}`,n.tG.info(540406808,n.nh.CoreDefault,o.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return r(this,void 0,void 0,(function*(){const s=new i.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(s.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),o={};return Object.keys(t).forEach((e=>{const s=t[e];if(Array.isArray(s.values)&&s.values.length>0&&"boolean"==typeof s.values[0]){const t=new Uint8Array(s.values);o[e]=new this.onnxObject.Tensor(t,s.dimensions)}else o[e]=new this.onnxObject.Tensor(s.values,s.dimensions)})),this.session.run(o).then((e=>(n.tG.info(540406809,n.nh.CoreDefault,s.stop()),new u(e)))).catch((e=>{s.resultDescription=`Problem running model. ${e.message}`,n.tG.info(540406810,n.nh.CoreDefault,s.stop())}))}throw s.resultDescription="Unable to run model. Tensor not defined",n.tG.info(540406811,n.nh.CoreDefault,s.stop()),new Error("Tensor is not defined")}))}}class l{constructor(){this.map={}}static create(){return new l}getInputs(){return this.map}add(e,t,s){return this.map[e]={dimensions:t,values:s},this}}class u{constructor(e){for(const t of Object.keys(e))this[t]=new p(t,e[t])}}class p{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return o.Z.Strings;case"int8":return o.Z.Int8s;case"int16":return o.Z.Int16s;case"int32":return o.Z.Int32s;case"bool":return o.Z.Booleans;case"uint8":return o.Z.UnsignedInt8s;case"uint16":return o.Z.UnsignedInt16s;case"uint32":return o.Z.UnsignedInt32s;case"float32":return o.Z.Float32s;case"float64":return o.Z.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===o.Z.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===o.Z.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===o.Z.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===o.Z.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===o.Z.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===o.Z.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===o.Z.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===o.Z.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===o.Z.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===o.Z.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}},74444:(e,t,s)=>{s.d(t,{In:()=>u,e3:()=>r,el:()=>c,kQ:()=>l});var o=s(89700),n=s(25765),i=s(64820);function r(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function a(e,t){e.src=t}function c(e,t,s,r,c){const l=new o.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(l.start(),(0,i.fE)(l)){const e="Browser lacks necessary support for inference service";return l.success=!1,l.resultDescription=e,n.tG.info(540406803,n.nh.CoreDefault,l.stop()),Promise.reject(new Error(e))}return new Promise(((o,n)=>{if("undefined"!=typeof document){const i=document.createElement("script");(c||a)(i,e),i.onload=()=>{p(t,s)?(r&&(t()[s].env.wasm.wasmPaths=r),o()):(i.remove(),n(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},i.onerror=n,document.body.appendChild(i)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[s]=self[s],p(t,s)?(r&&(t()[s].env.wasm.wasmPaths=r),o()):n(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):n(new Error("Unexpected lack of document and importScripts"))})).then((()=>{n.tG.info(540406804,n.nh.CoreDefault,l.stop())})).catch((e=>{throw l.success=!1,l.resultDescription=e.message,n.tG.info(509871835,n.nh.CoreDefault,l.stop()),e}))}function l(e,t,s){return i.Kx.create(e,t,s)}function u(){return i.G0.create()}function p(e,t){const s=globalThis[t];if(s&&s.InferenceSession&&s.Tensor){const o=e();return o&&!o[t]&&(o[t]=s),!0}return!1}},34308:(e,t,s)=>{s.d(t,{wB:()=>k});var o=s(59891),n=s(36571),i=s(88910),r=s(48513),a=s(72062),c=s(60990),l=s(36835),u=s(82076),p=s(39949),g=s(98242),h=s(63455),d=s(25765),m=s(89700),y=s(74044),f=s(93440),T=s.n(f);class _{constructor(e){this.queue=void 0,this.options={},this.maxSize=void 0,this.options=e,this.maxSize=this.options&&this.options.maxSize?this.options.maxSize:void 0,this.queue=new(T())}push(e){this.queue.push(e),this.maxSize&&this.queue.length>this.maxSize&&this.queue.shift()(new Error("TaskQueue Max size reached."))}processAll(){for(;this.queue.length>0;)this.queue.shift()(void 0)}}var C=s(94727),v=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))},S=function(e){return this instanceof S?(this.v=e,this):new S(e)},A=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=s.apply(e,t||[]),i=[];return o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o;function r(e){n[e]&&(o[e]=function(t){return new Promise((function(s,o){i.push([e,t,s,o])>1||a(e,t)}))})}function a(e,t){try{(s=n[e](t)).value instanceof S?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}};const w="cst-";let I=(0,h.v4)(),N=!1,b=null;const k=(e,t)=>{var s;return s=new g.N,N||(b=new o.MP(s),d.tG.addLogger(b),N=!0),new E(e,new g.G,t)};let M=!1;class E{constructor(e,t,s){this.sessionOptions=void 0,this.docSessionId="",this.messageBridge=void 0,this.activationsMapTypeToTokens=new Map,this.activationsMapTokenToCallback=new Map,this.waitingForResponse=new Map,this.messageId=0,this.customMessageSeq=0,this.activationToken=0,this.sessionClosed=!1,this.connectParams=void 0,this.seedGroupSize=0,this.connectionPendingTaskQueue=new _({maxSize:1e4}),this.sessionCloseMessages=[],this.sessionCloseCallbacks=new Map,this.sessionConnectCallbacks=new Map,this.sessionReconnectCallbacks=new Map,this.sessionDisconnectCallbacks=new Map,this.sessionCallbackToken=0,this.currentAuthenticationState=r.f.Pending,this.serverAuthenticationStateChangeCallbacks=[],this.claimsChallengeCallbacks=new Map,this.seedingStatusChangeCallbacks=new Map,this.internalSessionNumber=0,this.getAnnotationsResponseQueue=[],E.internalSessionCounter++,this.internalSessionNumber=E.internalSessionCounter,this.sessionOptions=s,M||(d.tG.addAggregator((0,o.cS)("Operation","operationName",["ProcessMessage","SubmitOperations","SubmitCustomMessage","SendLargeBinaryDataMessage","SendBinaryStreamUploadMessage","RequestBinaryData"],30)),M=!0),this.docSessionId=e,this.messageBridge=t,this.prevMessageInfo={sequenceId:-1},t.registerMessageReceivedCallback((e=>{const t=JSON.parse(e),s=this.createLoggingOperation("ProcessMessage",!0);if(!t)return s.dimension2="ParseFailed",s.success=!1,void d.tG.info(509088289,d.nh.CoreDefault,s.stop());const o=t.message||t.response;if(this.verifyMessageOrder(t,o),!(t.bridgeId!=I&&"*"!=t.bridgeId||t.docSessionId!=this.docSessionId&&"*"!=t.docSessionId)){if(!o)return s.dimension2="NoMessageOrResponse",s.success=!1,void d.tG.info(509088288,d.nh.CoreDefault,s.stop());a.uN.typeGuard(o)?this.handleSessionInitResponse(o):a.B_.typeGuard(o)?this.handleAnnotationResults(o,s):a.w9.typeGuard(o)?this.handleSessionCloseMessage(o):a.gy.typeGuard(o)?this.handleSessionConnectMessage(o):a.lj.typeGuard(o)?this.handleSessionReconnectMessage(o):a.eG.typeGuard(o)?this.handleSessionDisconnectMessage(o):a.wU.typeGuard(o)?this.handleServerAuthenticationStateChange(o):c.Td.typeGuard(o)?this.handleFireClaimsChallengeCallback(o):c.U8.typeGuard(o)?this.handleFireSeedingStatusChangeCallback(o):c.wR.typeGuard(o)?this.handleGetAnnotationsResponse(o,s):a.YK.typeGuard(o)?this.handleResponse(o,s):s.dimension2="UnknownType",s.resourceId=u.h.getTypeNameFor(o),d.tG.info(509088287,d.nh.CoreDefault,s.stop())}}));const n=new a.eE({bridgeId:I,clientMetadata:void 0,protocolVersion:2,messageId:this.getMessageId()});this.sendMessageWithOp("SessionInit",n)}getCallbackToken(e){return e+"-callback-"+this.internalSessionNumber+"-"+this.sessionCallbackToken++}createLoggingOperation(e,t){const s=new m.I({operationName:e,ariaNamespace:"Office_AugLoop_Client_SDX",clientDocSessionId:this.docSessionId,dimension0:I}).start();return s.success=t,s}handleFireClaimsChallengeCallback(e){if(!e.messageId||!e.claimsChallengeMessage)return;const t=this.claimsChallengeCallbacks.get(e.messageId);t&&t(e.claimsChallengeMessage)}handleSessionInitResponse(e){if(this.connectParams={authToken:e.anonymousToken,origin:e.origin,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,isSeedingRequired:!1},b){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);b.setServerSessionKey(e)}this.connectionPendingTaskQueue.processAll()}handleGetAnnotationsResponse(e,t){var s;if(!e.messageId)return t.resultDescription="NoMessageId",void(t.success=!1);const o=JSON.parse(e.serverResponse);this.getAnnotationsResponseQueue.push({content:o.content,error:{serviceError:o.errorInfo,clientError:e.clientError},finalResponse:e.finalResponse}),null===(s=this.responseReceived)||void 0===s||s.call(this,!0),t.dimension1=`Streaming. Final response: ${e.finalResponse}`,t.success=!0}handleResponse(e,t){return e.messageId?this.waitingForResponse.has(e.messageId)?(this.waitingForResponse.get(e.messageId)(e),this.waitingForResponse.delete(e.messageId),void(t.success=!0)):(t.resultDescription="NoResponseCallback",void(t.success=!1)):(t.resultDescription="NoMessageId",void(t.success=!1))}handleAnnotationResults(e,t){const s=this.createLoggingOperation("AugloopClientPerfTracker",!0);s.setDataField("CurrentTimestamp",Date.now().toString());let o=0;t.resultSignature=e.annotationType;const i=this.activationsMapTypeToTokens.get(e.annotationType);if(t.dimension1=e.ops.length.toString(),i)for(const t of i)for(let s=0;s<e.ops.length;s++){const n=this.activationsMapTokenToCallback.get(t);n&&(n.callback(e.ops[s],e.cv),o++)}t.success=!0,t.dimension2=o.toString(),o>0&&(0,n.K)(e)&&(s.cv=e.cv,s.resultSignature="CallbackInHostBridge",s.resourceId=e.annotationType,d.tG.info(506306969,d.nh.CoreDefault,s.stop()))}handleSessionCloseMessage(e){this.sessionClosed=!0,this.sessionCloseMessages.push(e),this.sessionCloseCallbacks.forEach(((t,s)=>{t(e)}))}handleSessionConnectMessage(e){if(this.connectParams={authToken:e.authToken,origin:e.origin,sessionUrl:e.sessionUrl,isSeedingRequired:e.isSeedingRequired},b){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);b.setServerSessionKey(e)}e.isSeedingRequired&&(this.seedGroupSize=0),this.sessionConnectCallbacks.forEach(((t,s)=>{t(e.isSeedingRequired,e.sessionUrl,e.origin,e.authToken)})),this.connectionPendingTaskQueue.processAll()}handleSessionReconnectMessage(e){this.sessionReconnectCallbacks.forEach(((e,t)=>{e()}))}handleSessionDisconnectMessage(e){this.connectParams=void 0,this.sessionDisconnectCallbacks.forEach(((t,s)=>{t(e.error)}))}handleServerAuthenticationStateChange(e){this.currentAuthenticationState!=e.serverAuthenticationState&&(this.currentAuthenticationState=e.serverAuthenticationState,this.serverAuthenticationStateChangeCallbacks.forEach((t=>{t(e.serverAuthenticationState)})))}handleFireSeedingStatusChangeCallback(e){if(!e.messageId||!e.seedingStatusChangeMessage)return;const t=this.seedingStatusChangeCallbacks.get(e.messageId);t&&t(e.seedingStatusChangeMessage)}getMessageId(){return"cl-"+this.internalSessionNumber+"-"+this.messageId++}getNextCustomMessageSeq(){return this.internalSessionNumber+"-"+this.customMessageSeq++}getNextActivationToken(){return"ac-"+I+"-"+this.internalSessionNumber+"-"+this.activationToken++}getServerAuthenticationState(){throw new Error("Method not implemented.")}registerLocalWorkflow(e){throw new Error("Method not implemented.")}registerLocalWorkflows(e){throw new Error("Method not implemented.")}isLocalWorkflowRegistered(e){throw new Error("Method not implemented.")}activateAnnotation(e,t,s){const o=this.getMessageId(),n=this.getNextActivationToken(),i=this.createLoggingOperation("ActivateAnnotation",!0);i.resourceId=e;const r=new Promise(((s,r)=>{this.waitingForResponse.set(o,(o=>a.PY.typeGuard(o)?(t&&(this.activationsMapTypeToTokens.has(e)||this.activationsMapTypeToTokens.set(e,new Set),t.callback&&(this.activationsMapTokenToCallback.set(o.token,{annotationType:e,callback:t.callback}),this.activationsMapTypeToTokens.get(e).add(o.token))),i.resultDescription=`Activated annotation with token ${o.token}`,d.tG.info(509088286,d.nh.CoreDefault,i.stop()),void s(new a.PY({token:o.token}))):a._p.typeGuard(o)?(this.activationsMapTypeToTokens.get(e).delete(n),this.activationsMapTokenToCallback.delete(n),i.success=!1,i.resultDescription=o.error,d.tG.error(509088285,d.nh.CoreDefault,i.stop()),void r(new Error(o.error))):(i.success=!1,i.resultDescription="Unknown Response",d.tG.error(509088284,d.nh.CoreDefault,i.stop()),void r(new Error("Unknown Response")))))})),c=new a.n4({annotationType:e,token:n,config:t?t.config:void 0,bridgeId:I,messageId:o,forceReturnCachedAnnotations:t?t.forceReturnCachedAnnotations:void 0});return this.sendMessage(c,{hostConfig:s}),r}updateAnnotationConfig(e,t){throw new Error("Method not implemented.")}releaseAnnotation(e){const t=this.createLoggingOperation("ReleaseAnnotation",!0);if(t.dimension2=e,!this.activationsMapTokenToCallback.has(e)){const s="AnnotationActivation already released:"+e;return t.success=!1,t.resultDescription=s,d.tG.info(508937629,d.nh.CoreDefault,t.stop()),Promise.reject(new Error(s))}const s=this.activationsMapTokenToCallback.get(e);s&&this.activationsMapTypeToTokens.get(s.annotationType).delete(e),this.activationsMapTokenToCallback.delete(e);const o=this.getMessageId(),n=new a.GA({token:e,messageId:o}),i=new Promise(((e,s)=>{this.waitingForResponse.set(o,(o=>a.Qq.typeGuard(o)?(d.tG.info(508937628,d.nh.CoreDefault,t.stop()),void e(o.lastRelease)):a._p.typeGuard(o)?(t.success=!1,t.resultDescription=o.error,d.tG.error(508937627,d.nh.CoreDefault,t.stop()),void s(new Error(o.error))):(t.success=!1,t.resultDescription="Unknown Response",d.tG.error(508937626,d.nh.CoreDefault,t.stop()),void s(new Error("Unknown Response")))))}));return this.sendMessage(n),i}setAnnotationState(e,t,s){throw new Error("Method not implemented.")}setAnnotationMetadata(e,t,s){throw new Error("Method not implemented.")}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){const s=this.createLoggingOperation("AugloopClientPerfTracker",!0);s.setDataField("CurrentTimestamp",Date.now().toString());const o=new a.Tb({bridgeId:I,ops:e,messageId:this.getMessageId(),cv:t});this.sendMessageWithOpAsync("SubmitOperations",o).catch((e=>{}));const i=(0,n.V)(o);i&&(s.cv=o.cv,s.resultSignature="SubmitInHostBridge",s.resourceId=u.h.getTypeNameFor(i.body),i.contextId&&s.setDataField("ContextId",i.contextId),i.sourceTimestamp&&s.setDataField("SourceTimestamp",i.sourceTimestamp.toString()),d.tG.info(506304458,d.nh.CoreDefault,s.stop()))}submitSeedOperations(e,t){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");const s=new a.Tb({bridgeId:I,ops:e,messageId:this.getMessageId(),cv:t,seq:0});this.sendMessageWithOpAsync("SubmitSeedOperations",s).catch((e=>{}))}submitSeedGroupOperations(e,t,s){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");this.seedGroupSize++;const o=new a.Tb({bridgeId:I,ops:e,messageId:this.getMessageId(),groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0,cv:s,seq:0});this.sendMessageWithOpAsync("SubmitSeedGroupOperations",o).catch((e=>{}))}submitCustomMessage(e){const t=this.createLoggingOperation("SubmitCustomMessage",!0),s=e.messageId;e.messageId=e.messageId?w+e.messageId:w+this.getNextCustomMessageSeq();const o=this.getMessageId(),n=new Promise(((e,n)=>{this.waitingForResponse.set(o,(o=>a.YK.typeGuard(o)?(t.resultDescription="Got response for submitted custom message",d.tG.info(508420945,d.nh.CoreDefault,t.stop()),o.messageId=s,void e(o)):a._p.typeGuard(o)?(t.success=!1,t.resultDescription=o.error,d.tG.error(508420944,d.nh.CoreDefault,t.stop()),void n(new Error(o.error))):(t.success=!1,t.resultDescription="Unknown Response",d.tG.error(508420943,d.nh.CoreDefault,t.stop()),void n(new Error("Unknown Response")))))}));let i;u.h.matchesTypesFor(e,[a.VR.getTypeName()])&&(i=y.r.serialize(e));const r=new a.g$({messageId:o,customMessage:e,binaryMessage:i?Array.from(i):void 0});return this.sendMessage(r),d.tG.info(508436875,d.nh.CoreDefault,t.stop()),n}sendLargeBinaryDataMessageInternal(e,t,s,o){(0,i.A2)(e,t,s,o)}sendBlobUploadStreamMessageInternal(e,t,s,o){(0,i.wM)(e,t,s,o)}submitLargeBinaryDataMessage(e){const t=this.createLoggingOperation("SendLargeBinaryDataMessage",!0),s=new Promise(((s,o)=>{this.connectionPendingTaskQueue.push((n=>{n?o(n):this.sendLargeBinaryDataMessageInternal(this.connectParams,e,t,((e,t)=>{e?o(new Error(e.error)):s(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}submitBinaryStreamUploadMessage(e){const t=this.createLoggingOperation("sendBinaryStreamUploadMessage",!0),s=new Promise(((s,o)=>{this.connectionPendingTaskQueue.push((n=>{n?o(n):this.sendBlobUploadStreamMessageInternal(this.connectParams,e,t,((e,t)=>{e?o(new Error(e.error)):s(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}fetchBlobFromRefInternal(e,t,s,o){(0,i.ZC)(e,t,s,o)}requestBinaryDataForBlob(e){const t=this.createLoggingOperation("RequestBinaryData",!0);if(e.data)return d.tG.info(507646876,d.nh.CoreDefault,t.stop()),Promise.resolve(e.data);if(!e.dataPointer||e.dataPointer.refType===p.J1.None){const e="Blob does not have a data pointer";return t.success=!1,t.resultDescription=e,d.tG.error(507646875,d.nh.CoreDefault,t.stop()),Promise.reject(new Error(e))}const s=new Promise(((s,o)=>{this.connectionPendingTaskQueue.push((n=>{n?o(n):this.fetchBlobFromRefInternal(this.connectParams,e.dataPointer,((e,t)=>{e?o(e):s(t)}),t)}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}requestCacheDump(e){throw new Error("Method not implemented.")}forceReconnect(e){throw new Error("Method not implemented.")}close(){const e=this.createLoggingOperation("CloseSession",!0);this.activationsMapTokenToCallback.forEach(((t,s)=>{this.releaseAnnotation(s).catch((t=>{e.resultDescription+=" "+t.message,e.success=!1}))})),d.tG.info(508937625,d.nh.CoreDefault,e.stop()),d.tG.flushAggregators(!0)}authenticateInteractive(e){return v(this,void 0,void 0,(function*(){const t=new c.i2({messageId:this.getMessageId(),forceUserPrompt:null==e?void 0:e.forceUserPrompt});yield this.sendMessageWithOpAsync("AuthenticateInteractive",t)}))}setConnectCallback(e){const t=this.getCallbackToken("connect");return e&&this.sessionConnectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getCallbackToken("disconnect");return e&&this.sessionDisconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getCallbackToken("reconnect");return e&&this.sessionReconnectCallbacks.set(t,e),t}setSessionCloseCallback(e){const t=this.getCallbackToken("close");return e&&(this.sessionCloseCallbacks.set(t,e),this.sessionClosed&&this.sessionCloseMessages.forEach((t=>{e(t)}))),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.sessionReconnectCallbacks)||t(this.sessionDisconnectCallbacks)||t(this.sessionConnectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallbacks.push(e),e(this.currentAuthenticationState)}setClaimsChallengeCallback(e){if(!e)return;const t=this.getCallbackToken("claimsChallenge");this.claimsChallengeCallbacks.set(t,e);const s=new c.tj({messageId:t});this.sendMessageWithOp("SetClaimsChallengeCallback",s)}setSeedingStatusChangeCallback(e){if(!e)return;const t=this.getCallbackToken("seedingStatus");this.seedingStatusChangeCallbacks.set(t,e);const s=new c.og({messageId:t});this.sendMessageWithOp("SetSeedingStatusChangeCallback",s)}getConnectParams(){return this.connectParams}setOfflineMode(){throw new Error("Method not available.")}getAnnotations(e,t){var s,o;const n=this.createLoggingOperation("GetAnnotations",!0);n.dimension1=null===(s=e.annotationType)||void 0===s?void 0:s.toString(),n.dimension2=null===(o=e.maxDelayMs)||void 0===o?void 0:o.toString(),n.cv=e.cv;const i=new C.x5({annotationTypes:e.annotationType,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:e.cv},messageId:this.getMessageId(),sourceInfo:e.sourceInfo});this.sendMessage(i);const r=this;let a=!1;const c=new Promise(((e,s)=>{if(t){const o=t.cancel.bind(t);t.cancel=()=>{a?e():(o(),s(new Error(E.requestCancelledError)))}}}));return{[Symbol.asyncIterator](){return A(this,arguments,(function*(){for(;!a;)try{0===r.getAnnotationsResponseQueue.length&&(yield S(Promise.race([new Promise((e=>r.responseReceived=e)),c])));const e=r.getAnnotationsResponseQueue.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(E.requestCancelledError);a=null==e?void 0:e.finalResponse,n.resultDescription="OK",d.tG.info(506575007,d.nh.CoreDefault,n.stop()),yield yield S(e)}catch(e){const t=e.message===E.requestCancelledError?l.zy.RequestCancelled:l.zy.Unknown;n.dimension0=`Error code: ${t}`,n.resultDescription=null==e?void 0:e.message,d.tG.info(506575006,d.nh.CoreDefault,n.stop()),yield yield S({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),a=!0;break}}))}}}sendMessage(e,t){const s=new a.vG(Object.assign({bridgeId:I,docSessionId:this.docSessionId,messageType:u.h.getTypeNameFor(e),message:e},t));this.messageBridge.sendMessage(JSON.stringify(s))}sendMessageAsync(e,t){const s=new Promise(((t,s)=>{this.waitingForResponse.set(e.messageId,(e=>{a._p.typeGuard(e)?s(new Error(e.error)):t(e)}))}));return this.sendMessage(e,t),s}sendMessageWithOp(e,t,s){const o=this.createLoggingOperation(e,!0);this.sendMessage(t,s),d.tG.info(507105996,d.nh.CoreDefault,o.stop())}sendMessageWithOpAsync(e,t,s){return v(this,void 0,void 0,(function*(){const o=this.createLoggingOperation(e,!0);try{return yield this.sendMessageAsync(t,s)}catch(e){throw o.success=!1,o.resultDescription=e.message,e}finally{o.success?d.tG.info(507105995,d.nh.CoreDefault,o.stop()):d.tG.error(507105994,d.nh.CoreDefault,o.stop())}}))}verifyMessageOrder(e,t){if(void 0===e.seq)return;const s={sequenceId:e.seq};if(t&&(s.messageType=u.h.getTypeNameFor(t),s.annotationCv=t.cv,a.B_.typeGuard(t))){const e=t;s.annotationType=e.annotationType}if(this.prevMessageInfo.sequenceId>s.sequenceId){const e=this.createLoggingOperation("OutOfOrderBridgeMessage",!1);e.setDataField("prevSeqId",this.prevMessageInfo.sequenceId),e.setDataField("prevMessageType",this.prevMessageInfo.messageType),e.setDataField("prevAnnotation",this.prevMessageInfo.annotationType),e.setDataField("prevAnnotationCv",this.prevMessageInfo.annotationCv),e.setDataField("currSeqId",s.sequenceId),e.setDataField("currMessageType",s.messageType),e.setDataField("currAnnotation",s.annotationType),e.setDataField("currAnnotationCv",s.annotationCv),d.tG.info(506799568,d.nh.CoreUnsampled,e.stop())}this.prevMessageInfo=s}}E.internalSessionCounter=0,E.requestCancelledError="Request cancelled"},98242:(e,t,s)=>{if(s.d(t,{G:()=>n,N:()=>r}),!/^8(654|871)$/.test(s.j))var o=s(78185);class n{constructor(){this.messageCallbackRegistrationReady=void 0}sendMessage(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(!this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback not registered");this.messageCallbackRegistrationReady.then((()=>{OfficeFirstParty.AugLoop.SendMessage(e)})).catch((e=>{throw e}))}registerMessageReceivedCallback(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback already registered");this.messageCallbackRegistrationReady=OfficeFirstParty.AugLoop.onHostMessageReceived((t=>e(t)))}}class i{sendTelemetryEvent(e){if("undefined"==typeof Office)throw new Error("Office global not available in SDX running AL");Office.sendTelemetryEvent(e)}}class r{constructor(){this.telemetryLogger=new o.M,this.telemetryLogger.addSink(new i)}convertTelemetryEvent(e,t,s,o,n,i,r){const a={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:this.convertDataFields(s),eventFlags:{dataCategories:6,diagnosticLevel:110,samplingPolicy:1}};return o&&(a.eventContract={name:o,dataFields:this.convertDataFields(n,o.split(".").slice(-1)[0])}),a}convertDataFields(e,t){const s=[];for(const o of Object.keys(e)){if(void 0===e[o]||null===e[o])continue;const n={name:t?`${t}.${o}`:o,dataType:this.getDataFieldType(e[o]),value:e[o],classification:4};s.push(n)}return s}getDataFieldType(e){return"string"==typeof e?0:"boolean"==typeof e?1:"number"==typeof e?2:void 0}sendTelemetryEvent(e,t,s,o,n,i,r,a){this.telemetryLogger.sendTelemetryEvent(this.convertTelemetryEvent(e,t,s,o,n,r,a))}sendDiagnosticTrace(e,t,s){}addCustomSync(e){this.telemetryLogger.addSink(e)}}},36515:(e,t,s)=>{s.d(t,{Y:()=>c});var o,n=s(25765),i=s(89700),r=s(70825),a=s(77827);!function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(o||(o={}));class c{constructor(e,t,s,o,n){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=o,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=s,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=n}addBatchItem(e,t,s,i,r,a){const{delayMs:c,delayMsMax:l,maxInputSize:u,estimateSize:p,groupingKeyExtractor:g}=t,h=p(e),d=g(e);if(t.split&&h>u){let o;try{o=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(a?a(t):n.tG.error(573366352,n.nh.CoreDefault,t))}if(o&&Array.isArray(o.inputs)&&o.inputs.length>1){let e;const n=[],c=a?(t,s)=>{if(e=e||t,n.push(s),n.length===o.inputs.length){let s;try{s=o.join(n)}catch(t){return void a(new Error("Join error: "+t.message))}a(e,s)}}:void 0;for(let e=0;e<o.inputs.length;e++){const n=o.inputs[e];this.addBatchItem(n,t,s,i,r&&e===o.inputs.length-1,c)}return}}let m=this.batchesByGroupingKey.get(d);if(m&&m.size+h>u&&(this.executeBatch(d,m,t,o.ExceedingMaxSize),m=void 0),m||(m={items:[],size:0,hasItemsWithCallbacks:!1,context:s,creationTime:Date.now()},this.batchesByGroupingKey.set(d,m)),this.batchMessagesEnabled){const t=m.items[m.items.length-1];t&&t.cv===i&&t.callback===a?(t.input=[...t.input,...e],t.size+=h):m.items.push({input:e,size:h,cv:i,callback:a})}else m.items.push({input:e,size:h,callback:a});m.size+=h,m.hasItemsWithCallbacks=m.hasItemsWithCallbacks||!!a,this.batchMessagesEnabled||(m.cv=i),m.groupComplete=r,m.groupComplete?this.executeBatch(d,m,t,o.GroupComplete):(Date.now()-m.creationTime+c<l&&(clearTimeout(m.timeout),m.timeout=void 0),m.timeout||(m.timeout=setTimeout((()=>{this.executeBatch(d,m,t,o.BatchIntervalElapsed)}),c)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new i.I({operationName:"ReduceBatchOperations"}).start();let s=0,o=0,a=0;const c=new Set,l=[],u=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const n of t.input.reverse())if(r.fZ.typeGuard(n)){const t=[];for(const e of n.items){a++;const i=u(n,e);c.has(i)?o++:(t.push(e),c.add(i),s++)}0!==t.length&&(n.items=t,e.push(n))}else if(r.Xr.typeGuard(n)){for(const e of n.items){const t=u(n,e);c.delete(t)}e.push(n)}else e.push(n);0!==e.length&&l.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=l.reverse(),0!=a&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(o)}`,t.dimension1=`noOp: ${0===o}`),t.success=a-o==s,n.tG.info(507839488,n.nh.CoreDefault,t.stop())}maxNumberOfDeltaUpdateOpsPerItemPerBatch(e){const t=(e,t)=>e.parentPath.toString()+"/"+t.id;let s=0;const o=new Map;for(const n of e.input)if(r.xU.typeGuard(n))for(const e of n.items){const i=t(n,e);o.has(i)||o.set(i,0),o.set(i,o.get(i)+1),s=Math.max(s,o.get(i))}return s}executeBatch(e,t,s,o){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const r=t.items,c=new i.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(r.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:o.toString()}).start(),l=(e,s,o)=>{let i;if(s&&s.exceptionType===a.K.NoOutput)c.success=!0,n.tG.info(573366353,n.nh.CoreDefault,c.stop());else{const o=`${e} error: ${s?s.message||s:"Unknown error"}`;i=s||new Error(o),c.success=!1,c.resultDescription=`Batch of ${r.length} items of size ${t.size} with ${o}`,c.resultSignature=`${e} Error`,n.tG.error(573366354,n.nh.CoreDefault,c.stop())}if(t.hasItemsWithCallbacks)for(const e of r)e.callback&&e.callback(i,o)};let u;try{u=s.multiplex(this.batchMessagesEnabled?r:r.map((e=>e.input)))}catch(e){return void l("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(u),!this.batchMessagesEnabled&&"operations"==e&&this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled&&(c.dimension3=this.getOrderOfMagnitudeDimension(this.maxNumberOfDeltaUpdateOpsPerItemPerBatch(u))),this.submit(u.input,t,((e,o)=>{if(e||o&&("exceptionType"in o||o instanceof Error))l("Submit",e||o,o);else if(t.hasItemsWithCallbacks||s.summaryExtractor){let i,a,p;if(t.hasItemsWithCallbacks)try{if(i=u.demultiplex(o),i.length!==r.length)throw new Error("Mismatched output length")}catch(e){return void l("Demultiplex",e)}if(s.summaryExtractor)try{[p,a]=s.summaryExtractor(o)}catch(e){return void l("SummaryExtractor",e)}if(c.success=!0,n.tG.info(573366342,n.nh.CoreDefault,c.stop()),t.hasItemsWithCallbacks)for(let e=0;e<r.length;e++)r[e].callback&&r[e].callback(void 0,i[e]);a&&this.onSummary(p,a,t.context)}else c.success=!0,n.tG.info(573366343,n.nh.CoreDefault,c.stop())}))}}},88910:(e,t,s)=>{s.d(t,{A2:()=>p,ZC:()=>h,wM:()=>g});var o=s(39949),n=s(25765),i=s(87477),r=s(74044),a=s(72062),c=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function l(e,t){return c(this,void 0,void 0,(function*(){const{authToken:s,origin:o,sessionUrl:n}=e,{body:r,cv:a,method:c,requestUrl:l}=t,u=yield(0,i.fetch)(l||n,{method:c,headers:Object.assign({Authorization:`Bearer ${s}`,"x-origin":o,"x-correlationid":a},t.headers),body:r});if(200!==u.status)throw new Error(`Unexpected status code: ${u.status}`);return u}))}const u=(e,t)=>{t?(e.resultDescription=t,e.success=!1,n.tG.error(507646878,n.nh.CoreDefault,e.stop())):n.tG.info(507646877,n.nh.CoreDefault,e.stop())};function p(e,t,s,o){let n;l(e,{headers:{"Content-Type":"application/jsond"},body:r.r.serialize(t),cv:s.cv,method:"POST"}).then((e=>e.json())).catch((e=>{n=new a._p({messageId:t.messageId,error:e.message})})).then((e=>{u(s,n?n.error:void 0),o(n,e)}))}function g(e,t,s,o){let n;l(e,{headers:{"Content-Type":"application/octet-stream"},body:t,cv:s.cv,method:"POST",requestUrl:`${e.sessionUrl}/blob`}).then((e=>e.json())).catch((e=>{n=new a._p({error:e.message})})).then((e=>{u(s,n?n.error:void 0),o(n,e)}))}function h(e,t,s,n){const{sessionUrl:i}=e;let r;l(e,{cv:n.cv,method:"GET",requestUrl:t.refType===o.J1.AlCodedLocation?`${i}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{r=e})).then((e=>{u(n,r?r.message:void 0),s(r,e)}))}},37572:(e,t,s)=>{s.d(t,{_A:()=>a,OW:()=>i,t$:()=>n});var o=s(87477);const n="Request timed out";function i(e,t,s){const n=new o.Request(e,t);return r.add(n,s)}const r=new class{constructor(e,t,s){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=s}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,s]=this.queuedRequests.shift();clearTimeout(s),this.add(e,t)}}add(e,t){if(this.requestInProgress){const s=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,s])}else{this.requestInProgress=!0;new Promise(((t,s)=>{let o=!1;const n=setTimeout((()=>{o=!0,s(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{o||(clearTimeout(n),t(e))})).catch((e=>{o||(clearTimeout(n),s(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}}(o.fetch,2e4,12e4);function a(e,t,s){return new Promise(((i,r)=>{const a=setTimeout((()=>{r(new Error(n))}),t);(0,o.fetch)(e,s||{}).then((e=>{clearTimeout(a),i(e)})).catch((e=>{clearTimeout(a),r(e)}))}))}},36571:(e,t,s)=>{s.d(t,{K:()=>n,V:()=>i});var o=s(82076);const n=e=>{var t;try{const s=e.ops.filter((e=>o.h.matchesTypesFor(e,["AugLoop_Core_AddOperation"])));for(const e of s)for(const s of e.items)if(s.body&&(null===(t=s.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse))return!0;return!1}catch(e){return!1}},i=e=>{try{const t=e.ops.filter((e=>o.h.matchesTypesFor(e,["AugLoop_Signals_SignalOperation"])));for(const e of t)for(const t of e.items)if(t.body&&o.h.matchesTypesFor(t.body,["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Copilot_CopilotInputSignal"]))return t;return}catch(e){return}}},44762:(e,t,s)=>{s.d(t,{xB:()=>Ut,HF:()=>Gt,fA:()=>Ht});var o=s(93364),n=s(89700),i=s(25765),r=s(59891),a=s(87045),c=s.n(a),l=s(72715);const u="object"==typeof l&&"object"==typeof l.versions&&void 0!==l.versions.node;class p{constructor(e){this.networkOverrideOptions=e,this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}init(e,t,s,o,r){var a;if(this.clientMetadata=r,u){const t={};(null===(a=this.networkOverrideOptions)||void 0===a?void 0:a.hostHeader)&&(t.headers={host:this.networkOverrideOptions.hostHeader}),this.ws=new(c())(e,t)}else this.ws=new(c())(e);this.logOp=new n.I({operationName:p.className,success:!0}).start(),this.logOp.setClientMetadata(r,!0),this.ingressByteCountOp=new n.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(r,!0),this.ws.addEventListener("open",(e=>{s(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),i.tG.info(508843801,i.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,i.tG.info(508843800,i.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,i.tG.info(508843799,i.nh.CoreDefault,this.logOp.stop()),o(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,i.tG.info(508843797,i.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),i.tG.info(508843794,i.nh.CoreDefault,this.ingressByteCountOp.stop()))}logWsUndefinedError(e){const t=new n.I({operationName:p.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",i.tG.info(506566722,i.nh.CoreDefault,t.stop())}}p.className="WebSocketWorker";var g,h,d=s(33957),m=s(97225),y=s(50090),f=s(82076),T=s(36835),_=s(72062),C=s(1427),v=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};function S(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let s;for(const o of t)if(0===e.indexOf(o)){s=o;break}if(!s)return"MalformedMessageName";const o="Message",n=e.indexOf(o,e.length-7)===e.length-7;return e.slice(s.length,n?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found",e.TooManyDeltaOperations="SyncMessage with too many delta operations"}(g||(g={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(h||(h={}));class A{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new C.l({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?m.aM.ClientRuntime:m.aM.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){_.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),_.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,s,o=0){var n,r;const a=new m.vf({sessionHealthEventName:"SendMessage",source:this.source,reason:m.l6.Client,impact:this.source===m.aM.ClientRuntime?m.Pq.MissingInput:m.Pq.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:S(f.h.getTypeNameFor(e)),dimension0:o.toString()}).start(),c=()=>{if(a.setClientMetadata(this.clientMetadata),a.success)i.tG.info(572836e3,i.nh.CoreDefault,a.stop());else{const e="ErrorWithoutPendingResponse"===a.resultSignature||"ResponseCallbackException"===a.resultSignature||"We called into done callback"!==a.message;a.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),i.tG.error(572836001,i.nh.CoreDefault,a.stop())}};(0,y.I)("PersistMessageId")?e.messageId=null!==(n=e.messageId)&&void 0!==n?n:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,_.l0.typeGuard(e)&&e.messages.forEach(((t,s)=>t.messageId=e.messageId+"."+s));const l=f.h.getTypeNameFor(e)===_.w9.getTypeName(),u={message:e,logOp:a,logEvent:c,callback:void 0,sendCount:1};if(!s&&!l){u.callback=(s,o)=>{var n;if(s?(0,y.I)("IgnoreUnsupportedMessageErrorForOldClientVersion")&&s.code===T.xv.UnsupportedMessage?(a.resultSignature="Success",a.resultDescription=`Ignore error for ${f.h.getTypeNameFor(e)} message ${e.messageId}${_.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${s.error}`):(a.success=!1,a.resultSignature=s.error,a.resultDescription=`Error for ${f.h.getTypeNameFor(e)} message ${e.messageId}${_.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${s.error}`):a.resultSignature="Success",t)try{a.message="We called into done callback",t(s,o)}catch(e){a.success=!1,a.resultSignature="ResponseCallbackException",a.resultDescription="Web"===(null===(n=this.clientMetadata)||void 0===n?void 0:n.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}c(),this.updateSendMessageStats(a.success,a.durationMs,s?new Error(s.error):void 0)};const s=()=>{u.callback(new _.F_({code:T.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let o=this.config.responseTimeoutMs;if(_.LQ.typeGuard(e)){const t=e;o=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else _.Yp.typeGuard(e)&&(o=null!==(r=e.maxDelayMs)&&void 0!==r?r:12e4);this.pendingResponseCallbacks.put(e.messageId,u,o,s)}this.egress&&this.egress(e,(e=>this.onEgressError(e,u)),o)}onEgressError(e,t){var s,o;if(e){const n=t.message,i=this.pendingResponseCallbacks.get(t.message.messageId);i?(this.pendingResponseCallbacks.del(n.messageId),i.callback(new _._p({messageId:n.messageId,code:T.xv.EgressError,error:e.message}))):_.w9.typeGuard(n)?(t.logOp.success=null!==(o=null===(s=e.message)||void 0===s?void 0:s.endsWith("Client disconnected."))&&void 0!==o&&o,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${f.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${f.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t){this.messageCallbacks.set(e,t)}onMessageAsync(e,t){this.messageCallbacks.set(e,((e,s)=>v(this,void 0,void 0,(function*(){try{const o=yield t(e);_._p.typeGuard(o)?s(o,void 0):s(void 0,o)}catch(e){s(e)}}))))}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(){this.pendingResponseCallbacks.forEach(((e,t)=>{e&&(this.pendingResponseCallbacks.del(t),e.callback(new _._p({messageId:t,code:T.xv.Cancelled,error:"Cancelled"})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new n.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});i.tG.info(572836002,i.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const s=new m.vf({sessionHealthEventName:"ProcessMessage",source:this.source,reason:m.l6.Client,impact:this.source===m.aM.ClientRuntime?m.Pq.MissingOutput:m.Pq.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),o=()=>{if(s.setClientMetadata(this.clientMetadata),s.success)i.tG.info(572836003,i.nh.CoreDefault,s.stop());else{const e="UnsupportedMessage"===s.resourceId||"Timeout"===s.resultSignature||"OnResponseInvokedMoreThanOnce"===s.resultSignature||"MessageCallbackException"===s.resultSignature||"We called into messageCallback"!==s.message;s.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),i.tG.error(572836032,i.nh.CoreDefault,s.stop())}};let n=this.messageCallbacks.get(f.h.getTypeNameFor(e));n?s.resourceId=S(f.h.getTypeNameFor(e)):n=(e,t)=>{s.resourceId=S(f.h.getTypeNameFor(e)),"MalformedMessageName"!==s.resourceId&&(s.resourceId="UnsupportedMessage"),t(new _._p({messageId:e.messageId,code:T.xv.UnsupportedMessage,error:`Message type ${f.h.getTypeNameFor(e)} is not supported`}))};let r=!1;const a=(n,i)=>{r?(s.success=!1,s.resultSignature="OnResponseInvokedMoreThanOnce",s.resultDescription=`Invoked onResponse for ${f.h.getTypeNameFor(e)} message ${e.messageId} more than once`):n?(s.success=!1,s.resultSignature=n.error,void 0!==n.code&&(s.dimension0=T.xv[n.code]),s.resultDescription=`Error for ${f.h.getTypeNameFor(e)} message ${e.messageId}: ${n.error}`):s.resultSignature="Success",r=!0,o(),n&&!f.h.matchesTypesFor(n,[_._p.getTypeName()])&&(n=new _._p({error:"Internal Server Error"})),this.updateProcessMessageStats(s.success,s.durationMs,n?new Error(n.error):void 0),n?(n.messageId=e.messageId,t(n)):i?(i.messageId=e.messageId,t(void 0,i)):t()};try{s.message="We called into messageCallback",n(e,a)}catch(e){s.success=!1,s.resultSignature="MessageCallbackException",s.resultDescription=JSON.stringify({message:e.message,stack:e.stack}),o(),this.updateProcessMessageStats(!1,s.durationMs,e),t()}}processResponse(e){var t;const s=new n.I({operationName:"ProcessResponse"});if(s.success=!0,s.setClientMetadata(this.clientMetadata),s.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),o=null==t?void 0:t.callback;if(o){if(_.i.typeGuard(e)&&!e.finalResponse){const s=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,s)}else this.pendingResponseCallbacks.del(e.messageId);f.h.matchesTypesFor(e,[_._p.getTypeName()])?o(e):o(void 0,e)}else s.resultSignature="NoPendingMessage",s.resultDescription=`${e.messageId}`,s.success=!1}else s.resultSignature="NoMessageIdSetInResponse",_._p.typeGuard(e)?s.resultDescription=e.error:s.resultDescription="MessageId is not available",s.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(s.resourceId=S(f.h.getTypeNameFor(e)),i.tG.info(572836034,i.nh.CoreDefault,s.stop()))}updateSendMessageStats(e,t,s){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||s?e&&s&&i.tG.warn(572836036,i.nh.CoreDefault,"Succeeded send message provided error object."):i.tG.warn(572836035,i.nh.CoreDefault,"Failed send message did not provide error object."),e||(s&&s.message===g.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,s){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||s?e&&s&&i.tG.warn(572836038,i.nh.CoreDefault,"Succeeded process message provided error object."):i.tG.warn(572836037,i.nh.CoreDefault,"Failed process message did not provide error object."),e||(s&&s.message===h.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var w,I=s(9156),N=s(27560),b=s(93440),k=s.n(b);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(w||(w={}));class M{constructor(e){this.logOp=new n.I({operationName:"MessageQueue",success:!0}),this.queue=new(k())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,s){const o=this.queue;if(1e3===o.length){this.logOp.resourceId="QueueFull",this.logOp.durationMs=0,this.logOp.success=!1,i.tG.warn(508843746,i.nh.CoreDefault,this.logOp);const e=o.shift();e.onResponse&&e.onResponse(new _._p({error:w.DroppedAsOldestInQueue}))}o.push({message:e,onResponse:t,timeQueued:N.Aq.getCurrentTimeMs(),attemptNumber:s})}sendOnSessionInitialized(e){const t=this.queue.length;let s=0;if(t>0){const o=N.Aq.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(s++,t.onResponse&&t.onResponse(new _._p({error:w.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${s}`,this.logOp.durationMs=o,this.logOp.success=!0,i.tG.warn(508843745,i.nh.CoreDefault,this.logOp)}}containSequencedSyncMessage(e){return e.message instanceof _.Tb&&f.h.matchesTypesFor(e.message,[_.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof _.l0&&f.h.matchesTypesFor(e.message,[_.l0.getTypeName()])}}var E;!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(E||(E={}));const L=(e,t,s,o)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,o)=>{t||f.h.getTypeNameFor(o)!==_.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),s&&s(t,o)}),void 0,o))},P=(e,t,s,o)=>{t&&(e.messageQueue.push(t,s,o),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new n.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});i.tG.error(508843789,i.nh.CoreDefault,t)})))},B=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{i.tG.error(508843788,i.nh.CoreDefault,`Init failed: ${e}`)})))};class D{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,s,o){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class R extends D{constructor(){super(...arguments),this.stateName=E.Initing,this.possibleNextStates=[E.Running,E.Disconnected,E.Closed]}sendMessage(e,t,s){f.h.matchesTypesFor(e,[_.eE.getTypeName()])?L(this.context,e,t,s):P(this.context,e,t)}sendBytes(e){B(this.context,e)}onConnectionClose(){this.context.setState(E.Disconnected)}}class O extends D{constructor(){super(...arguments),this.stateName=E.Running,this.possibleNextStates=[E.Disconnected,E.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,s,o){L(this.context,e,t,s)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(E.Disconnected)}}class x extends D{constructor(){super(...arguments),this.stateName=E.Disconnected,this.possibleNextStates=[E.Initing,E.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}sendMessage(e,t,s,o){if(f.h.matchesTypesFor(e,[_.eE.getTypeName()]))this.context.setState(E.Initing),L(this.context,e,t,s);else if(f.h.matchesTypesFor(e,[_.w9.getTypeName()]))this.context.setState(E.Closed);else{if(!o)return void P(this.context,e,t,s);t&&t(new _._p({messageId:e.messageId,error:w.DroppedBecauseClientDisconnected}))}}sendBytes(e){B(this.context,e)}}class F extends D{constructor(){super(...arguments),this.stateName=E.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}}var G=s(74044),W=s(37572);const H=3e4;class U{constructor(e,t,s,o){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=o,this.pingPongLogOp=new n.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(s,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultDescription="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,i.tG.info(506795283,i.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===U.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultDescription="close",i.tG.info(506795282,i.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),i.tG.info(506795281,i.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:U.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<H)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?this.ping():(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",i.tG.info(506795280,i.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=H,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),H)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,s,o){var n,r,a,c;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=s,o&&(this.pingPongLogOp.dimension0=null!==(n=o[0])&&void 0!==n?n:"",this.pingPongLogOp.dimension1=null!==(r=o[1])&&void 0!==r?r:"",this.pingPongLogOp.dimension2=null!==(a=o[2])&&void 0!==a?a:"",this.pingPongLogOp.dimension3=null!==(c=o[3])&&void 0!==c?c:""),i.tG.info(507320073,i.nh.CoreDefault,this.pingPongLogOp.stop())}}U.pingPongMessage="~";const q="Request timed out";class V{constructor(e,t,s){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new n.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=s,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new n.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508163399,i.nh.CoreDefault,e.stop()),this.trySendLongPoll(T.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new n.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void i.tG.info(508162497,i.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,i.tG.info(508163398,i.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===q?T.PO.TimeoutResend:T.PO.FailResend;t.error===q||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",i.tG.info(508163397,i.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",i.tG.info(508163401,i.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(T.PO.Regular)}close(){const e=new n.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508162467,i.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new n.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508162496,i.nh.CoreDefault,e.stop()),this.trySendLongPoll(T.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&_.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(T.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new n.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void i.tG.info(507281438,i.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new n.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void i.tG.info(508163396,i.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>6e4&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new n.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void i.tG.info(507278739,i.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new _.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}var $=s(87477);const j=JSON.stringify(new _.ry({error:W.t$}));class z{constructor(e){this.networkOverrideOptions=e,this.isClosed=!1,this.pendingEgress=[]}init(e,t,s,o){const r=new n.I({operationName:"HttpWorkerInit",success:!0}).start(),a=e.split("/?x-origin=");2===a.length?(this.url=N.Aq.convertWebSocketUrlToHttp(a[0]),this.origin=a[1]):(this.url=N.Aq.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=s,this.onClose=o,i.tG.info(507839180,i.nh.CoreDefault,r.stop())}egress(e){const t=new n.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void i.tG.info(508163394,i.nh.CoreDefault,t.stop());const s=this.getRequestInfo(e,t);if(!s.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void i.tG.error(508163393,i.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(s,t):(0,W.OW)(s.url,s.request,((e,s)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):s&&s.ok?s.text().then((e=>{t.success=!0,i.tG.info(508163362,i.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==s?void 0:s.status}: ${null==s?void 0:s.statusText}`)}))}close(){const e=new n.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void i.tG.info(508163360,i.nh.CoreDefault,e.stop());i.tG.info(508163359,i.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,i.tG.error(508163358,i.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let s=e;t||(s=this.formatServerInput(e));const o=e=>{_.uN.typeGuard(e)&&this.onSessionInitResponse(e)};s&&(this.logIngressCount(s),this.ingress(s,o))}onSessionInitResponse(e){const t=new n.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void i.tG.error(507809949,i.nh.CoreDefault,t.stop());i.tG.info(508163357,i.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){(0,W._A)(e.url,2e4,e.request).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",i.tG.info(508163355,i.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===W.t$?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),i.tG.error(508163353,i.nh.CoreDefault,t.stop()),this.ingressInternal(j,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const s=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),o=this.getHeader(e,t);return t.resultSignature=s,{url:s,request:{method:"POST",headers:o,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){var s,o;const n=new $.Headers;return(null==e?void 0:e.isHttpSessionInitMessage)?(n.set("Content-Type","application/json"),this.origin&&n.set("x-origin",this.origin)):this.isConnectedToSession()&&(e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(n.set("Content-Type","application/jsond2"),t.dimension0=e.obj.byteLength.toString().length.toString()):n.set("Content-Type","application/json"),n.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),n.set("x-origin",this.sessionSettings.origin)),(null===(s=this.networkOverrideOptions)||void 0===s?void 0:s.hostHeader)&&n.set("host",null===(o=this.networkOverrideOptions)||void 0===o?void 0:o.hostHeader),n}setSessionSettings(e,t,s,o){const n=o.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:s,sliceUrl:n}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new n.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),i.tG.info(508409622,i.nh.CoreDefault,e.stop())}}}var Q=s(36571),K=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};const J=1e5,Y=1e4,Z=3e6,X=1e3;class ee{constructor(e){var t,s,o;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.pendingQueue=[],this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new n.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.dynamicRateControllerEnabled=null!==(t=null==e?void 0:e.dynamicRateControllerEnabled)&&void 0!==t&&t,this.dynamicRateControllerEnabled&&(this.messageQueue=new(k())),this.reducedPingPongRetryEnabled=null!==(s=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==s&&s,this.startQueueProcessingInOpen=null===(o=null==e?void 0:e.startQueueProcessingInOpen)||void 0===o||o}init(e,t,s,o,n,i){this.worker=e,this.ingress=t,this.queryEgressCacheSize=s,this.clientMetadata=n,this.networkMode=o,this.reliabilityManager=((e,t,s,o,n)=>e instanceof z?new V(e,s,o):new U(e,t,s,n))(this.worker,this.close.bind(this),void 0,i,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.dynamicRateControllerEnabled&&(this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.startQueueProcessingInOpen||this.processQueue()),this.resolveInitPromise()}open(){const e=new n.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.dynamicRateControllerEnabled?this.startQueueProcessingInOpen&&this.processQueue():(this.egressRateControlTimer=setInterval((()=>this.flush()),1e3),this.flush())})).catch((t=>{var s;e.success=!1,e.resultDescription=null!==(s="Catch: "+(null==t?void 0:t.message))&&void 0!==s?s:""})).finally((()=>{i.tG.info(507834384,i.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){if(this.dynamicRateControllerEnabled){const t=new n.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),i.tG.info(507388684,i.nh.CoreDefault,t.stop())}}setRpsBps(e,t){const s=new n.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();s.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.9*e,s.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.9*t,s.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),i.tG.info(507388683,i.nh.CoreDefault,s.stop())}close(){var e,t;return K(this,void 0,void 0,(function*(){const s=new n.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();if(s.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,this.dynamicRateControllerEnabled){null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const o=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();s.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&o&&(yield this.queueProcessingCompletePromise),s.setDataField("QueueSizeAfterFlush",this.messageQueue.length),s.setDataField("IsConnected",o)}this.reliabilityManager?this.reliabilityManager.close():s.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,i.tG.info(507834381,i.nh.CoreDefault,s.stop())}))}clearMessageQueues(){this.pendingQueue=[],this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var s,o,r;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const a=this.getMessageSize(e);if(a>=Z)this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${a}`);else{if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);if(this.validateSyncMessage(e.messageId,e.seqId),this.dynamicRateControllerEnabled){const r=null!==(s=e.messageId)&&void 0!==s?s:"id"+this.emptyMessageId++,a={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:r,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},c=t>0,l=new n.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${c}`}).start();l.setClientMetadata(this.clientMetadata,!0);const u={message:a,logOp:l};if(l.dimension0="Enqueue",c?this.messageQueue.unshift(u):this.messageQueue.push(u),this.messageQueue.length>1e4)throw this.messageQueue.shift(),new Error("MessageQueue max size reached.");i.tG.info(507388547,i.nh.CoreDefault,l.stop()),null===(o=this.resolveQueueNotEmptyPromise)||void 0===o||o.call(this)}else{const t=this.queryEgressCacheSize(),s=this.egressMessageCount>=this.rpsThreshold,o=this.egressByteCount>=this.bpsThreshold,n=t>Y,i=this.reliabilityManager.checkConnection(),a=0!==this.pendingQueue.length,c=this.pendingQueue.length>=1e4;if(!i||s||o||a||c||n){let l="";const u=[];(a||c)&&(l+=c?"Pending queue max exceeded. ":"Pending queue not empty. ",u.push(this.pendingQueue.length.toString().length.toString())),n&&(l+=t>=Y?"Egressed cache max exceeded. ":"",u.push(t.toString().length.toString())),s&&(l+="RPS exceeded. ",u.push(this.egressMessageCount.toString().length.toString())),o&&(l+="BPS exceeded. ",u.push(this.egressByteCount.toString().length.toString())),l+=i?"":"Not connected. ",this.logEgressActivity(!0,`networkMode: ${this.networkMode}`,l,u);const p=null!==(r=e.messageId)&&void 0!==r?r:"id"+this.emptyMessageId++;return void this.pendingQueue.push({obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:p,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage})}this.sendToNetworkWorker(e)}}}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");const t=Date.now();this.worker.egress(e),this.onSendToNetworkWorker(e,t),this.reliabilityManager.postEgress();const s=this.getMessageSize(e);this.logEgressCount(s)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}onSendToNetworkWorker(e,t){if("string"==typeof e.obj)try{const s=new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start();s.setDataField("CurrentTimestamp",Date.now().toString()),s.setDataField("BeforeEgress",t.toString());const o=JSON.parse(e.obj);if(_.Tb.typeGuard(o)){const e=o,t=(0,Q.V)(e);t&&(s.cv=e.cv,s.resultSignature="SendToNetwork",s.resourceId=f.h.getTypeNameFor(t.body),t.contextId&&s.setDataField("ContextId",t.contextId),t.sourceTimestamp&&s.setDataField("SourceTimestamp",t.sourceTimestamp.toString()),i.tG.info(506306967,i.nh.CoreDefault,s.stop()))}}catch(e){}}flush(){if(!this.reliabilityManager){const e=new n.I({operationName:"NetworkRateControllerFlushFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void i.tG.info(507834373,i.nh.CoreDefault,e.stop())}let e=0,t=0;for(;this.pendingQueue.length>0&&this.queryEgressCacheSize()<Y&&e<this.rpsThreshold&&t<this.bpsThreshold&&this.reliabilityManager.checkConnection();){const s=this.pendingQueue.shift();this.sendToNetworkWorker(s),e++,t+=this.getMessageSize(s)}}processQueue(){var e,t,s;return K(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new n.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void i.tG.info(507573643,i.nh.CoreDefault,e.stop())}const o=new n.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){o.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new n.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),i.tG.info(507281410,i.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){o.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){o.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=X)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=Date.now()-this.egressRateControlIntervalStart,t=X-e+100;let s="";this.egressMessageCount>=this.rpsThreshold&&(s+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(s+="BPS exceeded.");const o="rateLimitHit",r=new n.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();r.setClientMetadata(this.clientMetadata,!0),r.success=!0,r.resultDescription=o,r.resultSignature=s,r.dimension0=this.messageQueue.length.toString().length.toString(),r.dimension1="rateLimitHit",r.setDataField("QueueLength",this.messageQueue.length),r.setDataField("RateLimitDelayMs",t),i.tG.info(507281409,i.nh.CoreDefault,r.stop()),this.startRateLimiting(t);break}const e=this.messageQueue.shift();e.logOp.dimension0="Dequeue",this.sendToNetworkWorker(e.message),i.tG.info(507388682,i.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}null===(t=this.resolveQueueProcessingCompletePromise)||void 0===t||t.call(this),this.resolveQueueProcessingCompletePromise=void 0,o.setClientMetadata(this.clientMetadata,!0),o.setDataField("QueueSize",this.messageQueue.length),o.setDataField("IsConnected",null===(s=this.reliabilityManager)||void 0===s?void 0:s.checkConnection()),o.setDataField("IsClosing",this.isClosing),i.tG.info(507368671,i.nh.CoreDefault,o.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new n.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),i.tG.info(507834370,i.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,s,o){var r,a,c,l;const u=new n.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=s,o&&(u.dimension0=null!==(r=o[0])&&void 0!==r?r:"",u.dimension1=null!==(a=o[1])&&void 0!==a?a:"",u.dimension2=null!==(c=o[2])&&void 0!==c?c:"",u.dimension3=null!==(l=o[3])&&void 0!==l?l:""),i.tG.info(507626007,i.nh.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>X&&((this.egressMessageCount>50||this.egressByteCount>J)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>J?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,i.tG.info(508843792,i.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var te;!function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(te||(te={}));class se{constructor(e,t,s,o,a,c,l,u,p,g,h){this.logCountLimiter=new N.yq(se.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=N.Aq.convertWebSocketUrlToHttp(this.globalUrl),s=!e,o=null!=e?e:new n.I({operationName:"HttpsTest",resourceId:(0,r.k$)(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),a={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":o.cv},body:JSON.stringify(N.Aq.createHealthCheckRequest(this.clientMetadata))};(0,W.OW)(t,a,((e,t)=>{e?(o.dimension1="HttpErr",o.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(o.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,s&&(o.success=!0)):(o.dimension1="HttpNoResp",o.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),s&&o.stop(),this.logCountLimiter.log((()=>{i.tG.info(508843780,i.nh.CoreDefault,o)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=s,this.sessionInitializer=o,this.ingress=a,this.queryEgressCacheSize=c,this.onConnectionClose=l,this.onDetectedWSBlock=u,this.sessionCorrelationVector=p,this.httpFallbackEnabled=g.httpFallbackEnabled,this.dynamicRateControllerEnabled=g.dynamicRateControllerEnabled,this.reducedPingPongRetryEnabled=g.reducedPingPongRetryEnabled,this.startQueueProcessingInOpen=g.startQueueProcessingInOpen,this.networkWorkerLogOp=new n.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=h||te.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,s=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const o=()=>{if(s||!this.alreadyLoggedReconnectAttempt){const e=s?se.initialAttemptTimeout:se.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new n.I({operationName:"ConnectionFailingOrSlow",dimension0:s?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});i.tG.info(508843787,i.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!s,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new n.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});i.tG.error(508843786,i.nh.CoreDefault,t)})).then((()=>{o(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),o(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.dynamicRateControllerEnabled&&this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),!this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new n.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});i.tG.info(508843785,i.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,s)=>{let o=0;const n=N.Aq.getCurrentTimeMs()?N.Aq.getCurrentTimeMs()-t:0,i=[1e3,2e3,5e3,1e4,6e4];return o=i[Math.max(0,Math.min(i.length-1,e-1))],o=Math.max(o-n,1e3),o=s&&s>0?Math.min(5e3,o):o,o})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpFallbackEnabled?this.httpTestsSuccessCount:void 0)):this.getNetworkMode()===te.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!f.h.matchesTypesFor(e,[_.eE.getTypeName()]))return void(f.h.matchesTypesFor(e,[_.YK.getTypeName()])||i.tG.error(508843784,i.nh.CoreDefault,new n.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let s,o;if(f.h.matchesTypesFor(e,[_.VR.getTypeName()])?(this.castBinaryData(e),s=G.r.serialize(e)):s=JSON.stringify(e),_.Tb.typeGuard(e)&&(o=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:s});const r=_.eE.typeGuard(e)&&this.getNetworkMode()===te.HttpFallback;this.getNetworkRateController().egress({obj:s,isHttpSessionInitMessage:r,messageId:e.messageId,seqId:o},t)}bypassRateController(e){return _.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):i.tG.error(508843783,i.nh.CoreDefault,new n.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=N.Aq.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const s=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",(0,r.k$)(s)),this.connect(s),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(s,o)=>{if(t.success=!s,t.resourceId=o?(0,r.k$)(o.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===te.HttpFallback?(t.resultDescription=s?`HTTP Error: ${s.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=s?`WS Error: ${s.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),s||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.httpFallbackEnabled?this.getNetworkMode()===te.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=te.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"):0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(this.permanentlyClosed=!0,t.dimension1="WSBlocked",this.onDetectedWSBlock()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"),this.logCountLimiter.log((()=>{i.tG.info(508843782,i.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{i.tG.info(508843781,i.nh.CoreDefault,t.stop())})),o.forceReconnect){this.close();const t=new n.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=o.sliceUrl,this.dynamicRateControllerEnabled&&this.getNetworkRateController().setRpsBps(o.maxRPS,o.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new n.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new ee({dynamicRateControllerEnabled:this.dynamicRateControllerEnabled,reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled,startQueueProcessingInOpen:this.startQueueProcessingInOpen})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>i.tG.info(508372418,i.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,this.queryEgressCacheSize,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===te.JSWebSockets?"WebSocket":"HTTP")}}se.initialAttemptTimeout=1e5,se.reconnectAttemptTimeout=2e4,se.className="NetworkWorkerManager";var oe=s(94727);class ne extends I.EventEmitter{constructor(e,t,s,o,i,r,a,c,l){super(),this.cvParent=new d.W,this.logOp=new n.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new N.yq("SessionState"),this.logRetryTelemetry=!0,this.isImproveRetriesChangeGateEnabled=!0,this.stats=t,this.allStates={[E.Initing]:new R(this),[E.Running]:new O(this),[E.Disconnected]:new x(this),[E.Closed]:new F(this)},this.setState(E.Initing),this.messageEndpoint=new A({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(i),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(_.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new se(e,i,s,o,this.ingress.bind(this),this.messageEndpoint.queryEgressCacheSize.bind(this.messageEndpoint),this.onConnectionClose.bind(this),(()=>{this.onSessionClose(void 0,"WSNotSupported")}),this.getCorrelationVector.bind(this),a,l),this.messageQueue=new M({sendMessage:(e,t,s,o)=>this.state.sendMessage(e,t,s,o),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),o.on("connect",((e,t,s,o,n,i,r)=>{this.setState(E.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,s,o,n,i,r)})),o.on("reconnect",(()=>this.emit("reconnect"))),o.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=r,this.delayBeforeSocketClose=a.delayBeforeSocketClose,this.gateUtils=c,this.gateUtils&&(this.gateUtils.isChangeGateEnabled("LogRetryMessageEvent").then((e=>{this.logRetryTelemetry=e})).catch((()=>{})),this.gateUtils.isChangeGateEnabled("ImproveClientRetries").then((e=>{this.isImproveRetriesChangeGateEnabled=e})).catch((()=>{})))}setState(e,t,s){if(this.state&&e===this.state.stateName)return;const o=this.state?E[this.state.stateName]:"undefined",n=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===E.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${n?E[e]:o}`,this.logOp.resultDescription=`Previous state: ${o}`,this.logOp.dimension0=`Attempted state: ${E[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!n?"Unexpected state change":""),this.logOp.success=n,i.tG.info(508843791,i.nh.CoreDefault,this.logOp)})),n&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(s))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,s){this.retrySendMessage(e,t,ne.maxRetries,s)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){if(this.sendMessage(new _.w9),this.delayBeforeSocketClose)setTimeout((()=>{this.networkWorkerManager.close(!0);const t=e||new _.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new _.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}),100);else{this.networkWorkerManager.close(!0);const t=e||new _.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new _.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}}ingress(e,t){let s;try{s=JSON.parse(e)}catch(e){i.tG.error(508843790,i.nh.CoreDefault,new n.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(s){if(t&&_.YK.typeGuard(s)&&t(s),this.networkWorkerManager.getNetworkMode()===te.HttpFallback&&_.ry.typeGuard(s)){const e=s;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(s,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,s){e&&this.networkWorkerManager.egress(e,s).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(E.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=N.Aq.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,s,o,r){const a=ne.maxRetries-s;this.state.sendMessage(e,((c,l)=>{var u,p,g,h,d,m;r&&(c&&0==s?(r.dimension0=(a+1).toString(),r.success=!1,i.tG.info(507025311,i.nh.CoreDefault,r.stop())):c&&s>0?(r.dimension0=(a+1).toString(),r.dimension1=null!==(p=null===(u=c.code)||void 0===u?void 0:u.toString())&&void 0!==p?p:"NoErrorCode",r.resultSignature=null!==(g=c.error)&&void 0!==g?g:"NoErrorMessage"):(r.success=!0,i.tG.info(507025310,i.nh.CoreDefault,r.stop()))),c&&s>0&&this.canBeRetried(e)&&this.isTransientError(c)?(this.logRetryTelemetry&&!r&&((r=new n.I({operationName:"RetrySendMessage",success:!0,dimension0:(a+1).toString()}).start()).resourceId=f.h.getTypeNameFor(e),r.dimension1=null!==(d=null===(h=c.code)||void 0===h?void 0:h.toString())&&void 0!==d?d:"NoErrorCode",r.resultSignature=null!==(m=c.error)&&void 0!==m?m:"NoErrorMessage",r.resultDescription=`Retrying message with messageId: ${e.messageId}${_.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),f.h.matchesTypesFor(c,[_.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(c),this.retrySendMessage(e,t,s-1,o,r)):t&&t(c,l)}),a,o)}canBeRetried(e){return!f.h.matchesTypesFor(e,[_.eE.getTypeName(),_.VR.getTypeName(),oe.x5.getTypeName()])}isTransientError(e){const t=e.error,s=e.code;return!(this.isImproveRetriesChangeGateEnabled&&s===T.xv.TokenValidationError||s===T.xv.TokenDecryptError||s===T.xv.SyncMessageTooLateOrDuplicate)&&(t!==g.SyncMessageUnsupportedBatch&&t!==g.UnexpectedSeedMessage&&t!==g.UnsupportedSyncMessage&&t!==g.AnnotationTokenNotFound&&t!==w.ArrivedBeforeReseeding&&t!==w.DroppedAsOldestInQueue&&t!==w.DroppedBecauseClientDisconnected)}}ne.maxRetries=2;var ie=s(48513),re=s(70825),ae=s(39949),ce=s(39551),le=s(59586),ue=s(71531);class pe{constructor(e,t,s,o){this.sendMessage=e,this.annotationType=t,this.options=s,this.token=`${t}-${pe.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=o}activate(e,t,s){return new Promise(((o,n)=>{this.sendMessage(new _.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:s}),((e,t)=>{e?n(new Error(e.error)):(_.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),o({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new _.GA({token:this.token}),((s,o)=>{s?t(new Error(s.error)):e(o.lastRelease)}))}))}}pe.nextActivationResultBatchId=1;var ge=s(36515),he=s(52817),de=s(42713);const me=(e,t)=>{const s=[];for(const o of null!=e?e:[])if(void 0===t||t===o.cardinality)for(const e of o.contextTypes)s.push([e,o.cardinality,o.producerWaitPolicy]);return s},ye="\\",fe=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),Te=e=>Array.isArray(e)?5===e.length?`${e[0]}${ye}${e[1]}${ye}${e[2]}${ye}${e[3]}${ye}${e[4]}`:4===e.length?`${e[0]}${ye}${e[1]}${ye}${e[2]}${ye}${e[3]}`:3===e.length?`${e[0]}${ye}${e[1]}${ye}${e[2]}`:2===e.length?`${e[0]}${ye}${e[1]}`:1===e.length?e[0]:e.join(ye):"(malformed path)";var _e;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(_e||(_e={}));class Ce{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var s;const o=this.getLocation(t);return null===(s=this.graphNodeByLocationAndWorkflowId.get(o))||void 0===s?void 0:s.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const s=new n.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void i.tG.error(524300630,i.nh.CoreDefault,s.stop())}const s=this.getLocation(t),o=new ve(e,s);this.addWorkflowAsDependency(o);let r=this.graphNodeByLocationAndWorkflowId.get(s);r||(r=new Map,this.graphNodeByLocationAndWorkflowId.set(s,r)),r.set(e.id,o)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const s of t.values()||[]){const t=this.createWorkflowDefinition(s.workflow);s.workflow.visibility===de.Y$.LocalOnly?this.compressDownstreamWorkflows(t,s):t.outputTypes.push(...s.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),s=this.graphNodeByLocationAndWorkflowId.get(t),o=Array.from((null==s?void 0:s.values())||[]);for(const e of o){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);s.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const s of t.values()||[])e.push(s.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const s of e.values())t.push(s);return t}getLocation(e){return e?_e.External:_e.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const s of t.downstreamWorkflows)if(s.workflow.visibility!==de.Y$.LocalOnly){if(s.workflow.kind!==de.wC.Join||-1!==e.inputTypes.indexOf(s.workflow.collectionScopeType))for(const t of s.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,s)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const s of t.values()){for(const t of s.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,s);for(const t of s.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(s,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class ve{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}const Se=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),Ae=(e,t)=>null!=e&&(null!=t&&(e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))));class we{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,s){return Object.assign(Object.assign(Object.assign({},e),t),s)}mergeWorkflowDefinition(e,t,s){if(s){const o=((e,t,s)=>{let o=e.get(t);return o||(o=s(),e.set(t,o)),o})(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));o.set(s,we.mergeDefinitions(e,o.get(s),t))}else this.workflowDefByWorkflow.set(e.id,we.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var s;let o;return t&&(o=null===(s=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===s?void 0:s.get(t)),o||(o=this.workflowDefByWorkflow.get(e.id)),o||(o=e),o}deleteWorkflowDefinition(e,t){const s=this.workflowDefByWorkflowAndContextId.get(e.id);s&&(s.delete(t),0===s.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}const Ie=new Set([re.Xr.getTypeName(),re.fZ.getTypeName(),re.g0.getTypeName(),re.xU.getTypeName()]);class Ne{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return Ae(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=f.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new n.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return Ie.has(e)}tryLogMessage(e,t,s=!0){e&&(e.success=s,e.resultDescription=t,i.tG.verbose(527308633,i.nh.CoreDefault,e.stop()))}}var be,ke;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(be||(be={}));class Me{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var s;const o=e.contextId;if(o)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(o,[]),this.scopeItemsByContextId.has(o)){if(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.has(o)){const s=new n.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${o} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();i.tG.verbose(527291288,i.nh.CoreDefault,s.stop())}}else this.scopeItemsByContextId.set(o,e)}updateScopeItemPath(e,t,s){var o,n;if(!e)return;const i=this.scopeItemsByContextId.get(e);if(!i)return;const r=i.parentPath;this.scopeItemsByContextId.set(e,fe(t,i));const a=null!==(n=null===(o=this.itemsByWorkflowAndContextId.get(s.id))||void 0===o?void 0:o.get(e))&&void 0!==n?n:[];for(let e=0;e<a.length;e++)a[e]=fe([...t,...a[e].parentPath.slice(0,r.length)],a[e])}getScopeItem(e,t){var s;for(const o of(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.keys())||[])if(Ae(o,e))return this.scopeItemsByContextId.get(o)}addItemToWorkflowList(e,t){const s=e.contextId;if(!s)return;const o=this.itemsByWorkflowAndContextId.get(t.id);if(o)for(const[r,a]of o)if(Ae(r,s)){a.push(e);const s=new n.I({resultDescription:`Items for contextId ${r}: [${a.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();i.tG.info(526403808,i.nh.CoreDefault,s.stop())}}isWorkflowReady(e,t){const s=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=s}getItemsToExecute(e,t){const s=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),s}onWorkflowExecuted(e,t){const s=e.contextId,o=this.itemsByWorkflowAndContextId.get(t.id);o&&(o.delete(s),0===o.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(s)||this.scopeItemsByContextId.delete(s)}getGeneratedItems(e,t){var s;if(!(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.get(e)))return[];const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,o)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const s of t.keys())if(s===e)return!0;return!1}}!function(e){e.JsClient="C",e.Server="S"}(ke||(ke={}));var Ee=s(2010),Le=s(69811),Pe=s(91538);function Be(e,t,s=!1){let o,n,i={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(o=e,n=t):(o=t,n=e),0===n.indexOf(o)?(i.firstDiffLeft=o.length,i.firstDiffRight=0):n.endsWith(o)?(i.firstDiffLeft=0,i.firstDiffRight=o.length):(i=function(e,t,s=!1){const o={firstDiffLeft:0,firstDiffRight:t.length};let n;for(n=0;n<e.length&&n<t.length;n+=1){const o=e.charCodeAt(n),i=t.charCodeAt(n);if(!(o===i||De(o,s)&&De(i,s)))break}for(o.firstDiffLeft=n,n=0;n<e.length&&n<t.length;n+=1){const o=e.charCodeAt(e.length-n-1),i=t.charCodeAt(t.length-n-1);if(!(o===i||De(o,s)&&De(i,s)))break}return o.firstDiffRight=n,o}(e,t,s),i.firstDiffLeft+i.firstDiffRight>o.length&&(i.firstDiffRight=o.length-i.firstDiffLeft)),function(e,t,s){if(e.firstDiffLeft>0){const o=e.firstDiffLeft<t.length&&Re(t,e.firstDiffLeft),n=e.firstDiffLeft<s.length&&Re(s,e.firstDiffLeft);(o||n)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const o=e.firstDiffRight<t.length&&Re(t,t.length-e.firstDiffRight),n=e.firstDiffRight<s.length&&Re(s,s.length-e.firstDiffRight);(o||n)&&(e.firstDiffRight-=1)}}(i,e,t),i}function De(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function Re(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}var Oe=s(97288),xe=s.n(Oe);const Fe=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,Ge=/[.!?]/g;function We(e,t){const s=[],o=Ue(e,t);return o&&s.push(o),s}function He(e,t){const s=[],o=Ue(e,t);o&&s.push(o);const n=function(e,t,s){var o,n,i,r,a,c;const l=e,u=t;if((null==l?void 0:l.ipPosition)===(null==u?void 0:u.ipPosition)&&(null==l?void 0:l.isColdIp)===(null==u?void 0:u.isColdIp))return;if((null==l?void 0:l.isColdIp)===(null==u?void 0:u.isColdIp)&&s)if(s.deltaType===Le.WI.Add){if((null==u?void 0:u.ipPosition)===(null!==(o=s.position)&&void 0!==o?o:0)+(null!==(n=s.length)&&void 0!==n?n:0))return}else if(s.deltaType===Le.WI.Update){if((null==u?void 0:u.ipPosition)===(null!==(i=s.position)&&void 0!==i?i:0)+(null!==(a=null===(r=s.content)||void 0===r?void 0:r.length)&&void 0!==a?a:0))return}else if(s.deltaType===Le.WI.Delete&&(null==u?void 0:u.ipPosition)===(null!==(c=s.position)&&void 0!==c?c:0))return;return new Pe.s({deltaType:Le.WI.CursorUpdate,cursorData:{ipPosition:null==u?void 0:u.ipPosition,isColdIp:null==u?void 0:u.isColdIp}})}(e,t,o);n&&s.push(n);const i=function(e,t,s){var o,n,i,r,a,c,l;const u=e,p=t;if((null===(o=p.formattedRanges)||void 0===o?void 0:o.length)<=(null===(n=u.formattedRanges)||void 0===n?void 0:n.length))if(s){let e=u.formattedRanges?[...u.formattedRanges]:[];const t=function(e,t,s){if(!e)return;if(t.deltaType===Le.WI.Add){const t=e.find((e=>e.start===s&&0===e.length));if(t)return t;s=Math.max(s-1,0)}const o=e.find((e=>0===e.length?e.start===s:e.start<=s&&s<e.start+e.length));return o}(u.formattedRanges,s,s.position),o=t?e.indexOf(t):-1;if(-1!==o&&(s.position+(s.length||0)>t.start+t.length?t.length=s.position+(null!==(i=s.content)&&void 0!==i?i:"").length-t.start:t.length+=(null!==(r=s.content)&&void 0!==r?r:"").length-(s.length||0),e[o]=t),e.length>0){for(const t of e.slice(o+1))t.start<s.position||(s.position+(s.length||0)>t.start?(t.length=t.start+t.length-(s.position+(s.length||0)),t.start=s.position+(null!==(a=s.content)&&void 0!==a?a:"").length):t.start+=(null!==(c=s.content)&&void 0!==c?c:"").length-(s.length||0));e=e.filter((e=>e.length>0))}const n=null!==(l=null==p?void 0:p.formattedRanges)&&void 0!==l?l:[];if(xe()(e,n)||0===e.length&&0===n.length)return}else if(xe()(null==u?void 0:u.formattedRanges,null==p?void 0:p.formattedRanges))return;return new Pe.s({deltaType:Le.WI.FormattingUpdate,formattedRanges:null==p?void 0:p.formattedRanges})}(e,t,o);i&&s.push(i);const r=function(e,t,s){const o=e,n=t;if(!(null==o?void 0:o.attributionRanges)&&!n.attributionRanges&&!(null==s?void 0:s.attributionRanges)||xe()(null==o?void 0:o.attributionRanges,null==n?void 0:n.attributionRanges))return;if(o.attributionRanges&&n.attributionRanges){const e=[];for(const t of n.attributionRanges)o.attributionRanges.some((e=>xe()(e,t)))||e.push(t);if(0===e.length)return;return new Pe.s({deltaType:Le.WI.AttributionUpdate,attributionRanges:e})}return new Pe.s({deltaType:Le.WI.AttributionUpdate,attributionRanges:null==n?void 0:n.attributionRanges})}(e,t,o);r&&s.push(r);const a=function(e,t){const s=e,o=t;let n;const i={};let r=!1;for(n in o)-1===["ipPosition","isColdIp","content","formattedRanges","attributionRanges"].indexOf(n)&&(xe()(o[n],s[n])||(r=!0,i[n]=o[n]));if(r)return new Pe.s({deltaType:Le.WI.OtherNonContentUpdate,otherNonContentData:i});return}(e,t);return a&&s.push(a),s}function Ue(e,t){const s=e.content,o=t.content,n=Be(s,o),i=n.firstDiffLeft,r=s.length-n.firstDiffRight,a=o.length-n.firstDiffRight;let c,l=Le.WI.Update;if(s.length!==o.length)r===i?(l=Le.WI.Add,c=s[s.length-1]):a===i&&(l=Le.WI.Delete,c=o[o.length-1]);else if(s===o)return;let u,p=0;switch(l){case Le.WI.Update:p=r-i,u=o.substring(i,a);break;case Le.WI.Add:u=o.substring(i,a);break;case Le.WI.Delete:p=r-i,u=s.substring(i,r)}const g=function(e,t){const s=Array.from(e.matchAll(Fe));if(Fe.lastIndex=0,0===s.length)return Le.OD.Chars;if(1===s.length){if(0===s[0].index)return t&&Ge.test(t)?Le.OD.Sentence:t&&!Fe.test(t)?Le.OD.Word:Le.OD.Chars;if(s[0].index+1===e.length)return Ge.test(e[s[0].index-1])?Le.OD.Sentence:Fe.test(e[s[0].index-1])?Le.OD.Chars:Le.OD.Word;if(e[s[0].index-1]){const t=e[s[0].index-1];if(Ge.test(t))return Le.OD.Sentence;if(Fe.test(t))return Le.OD.Chars}return Le.OD.Word}const o=Array.from(e.matchAll(Ge));if(Ge.lastIndex=0,0===o.length)return Le.OD.PartialSentence;if(o.length>1)return Le.OD.Paragraph;if(o[0].index+1<=e.length)return Fe.test(e[o[0].index+1])?Le.OD.Sentence:Le.OD.Paragraph;return}(u,c);if(void 0!==g)return new Pe.s({content:l!==Le.WI.Delete?u:void 0,deltaType:l,unit:g,position:i,length:l!==Le.WI.Add?p:0})}class qe{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(Ee.qf.getTypeName(),We),this.registerDeltaBuilderHandler(Ee.Cg.getTypeName(),He)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,s){const o=this.deltaBuilderHandlers.get(e);return o?o(t,s):[]}}const Ve=(e,t)=>t?$e([...t,e]):e,$e=e=>e.join("\\");class je{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var s;const o=new n.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item is undefined",void i.tG.info(524883085,i.nh.CoreDefault,o.stop());if(!e.body)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item has undefined body",void i.tG.info(524883086,i.nh.CoreDefault,o.stop());const n=e.body;if(!Ee.qf.typeGuard(n))return o.success=!1,void(o.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${Ee.qf.getTypeName()}, received ${f.h.getTypeNameFor(n)}`);const r=Ve(e.id,t),a=null!==(s=this.lastSeenTileByTileId.get(r))&&void 0!==s?s:new Ee.qf({content:""}),c=this.createDeltas(a,n);return c&&0!==c.length?(o.dimension0=c.length.toString(),this.lastSeenTileByTileId.set(r,n)):(o.dimension0="0",o.resultDescription="No delta differences found"),i.tG.info(524883087,i.nh.CoreDefault,o.stop()),c}catch(e){return o.success=!1,o.resultDescription=`Error creating text tile delta: ${e}`,void i.tG.info(524883088,i.nh.CoreDefault,o.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new qe}addItemToLocalMap(e,t){const s=Ve(e.id,t),o=e.body;Ee.qf.typeGuard(o)&&!this.lastSeenTileByTileId.has(s)&&this.lastSeenTileByTileId.set(s,o)}deleteItemFromLocalMap(e,t){const s=Ve(e.id,t);this.lastSeenTileByTileId.has(s)&&this.lastSeenTileByTileId.delete(s)}moveItemsInLocalMap(e,t,s){const o=new Set(s),n=$e(t),i=$e(e),r=[],a=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(n)){const s=a(e,n);if(void 0===s||o.has(s)){const s=e.replace(n,i);r.push({item:t,newPathKey:s,prevPathKey:e})}}for(const e of r)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(f.h.getTypeNameFor(t),e,t)}}var ze=s(63455),Qe=s(71283),Ke=s(88910);class Je extends I.EventEmitter{init(){return Promise.resolve()}sendMessage(e,t,s){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new d.W}getNetworkWorkerManager(){}setState(e){}}var Ye=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))},Ze=function(e){return this instanceof Ze?(this.v=e,this):new Ze(e)},Xe=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=s.apply(e,t||[]),i=[];return o={},r("next"),r("throw"),r("return"),o[Symbol.asyncIterator]=function(){return this},o;function r(e){n[e]&&(o[e]=function(t){return new Promise((function(s,o){i.push([e,t,s,o])>1||a(e,t)}))})}function a(e,t){try{(s=n[e](t)).value instanceof Ze?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}};var et,tt;!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(et||(et={})),function(e){e[e.Internal=0]="Internal",e[e.External=1]="External"}(tt||(tt={}));const st=(e,t)=>{t?(e.resultDescription=t,e.success=!1,i.tG.error(509203144,i.nh.CoreDefault,e.stop())):i.tG.info(509203143,i.nh.CoreDefault,e.stop())},ot=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class nt{constructor(e){var t;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=ie.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new Ce,this.workflowDefinitionManager=new we,this.contextIdManager=new Ne(ke.JsClient,this.workflowGraph),this.workflowItemStorage=new Me(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=!1,this.batchMessagesEnabled=!1,this.seedingStatus=T.e9.NotStarted,this.isChangeGateForceUserInteractiveAuth=void 0,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,this.gateUtils=e.gateUtils,e.workflowRuntimeFactory&&(this.workflowRuntime=e.workflowRuntimeFactory(this.sessionManager)),this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.seedingStatusChangeCallbacks=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(_.B_.getTypeName(),this.workflowRuntime?this.onAnnotationResultsFromLocal.bind(this):this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(_.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(_.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(_.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),this.sessionManager.onMessage(_.fr.getTypeName(),this.onSeedingStatusChangeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new n.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===_e.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,i.tG.info(508879493,i.nh.CoreDefault,e.stop())}}initialize(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress).then((()=>(this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this)))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length){if(this.workflowRuntime)for(const t of e)this.workflowRuntime.registerWorkflow(t),this.sendMessageToSession(new oe.Et({workflowDefinition:t}));if(this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new n.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();st(t)}activateAnnotation(e,t,s){var o;const n=new pe(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),i=(t,s)=>{let o=t.get(e);o||(o=new Map,t.set(e,o)),o.set(n.token,s)};(null==t?void 0:t.callback)&&i(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&i(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const r=null!==(o=this.tokensByAnnotationType.get(e))&&void 0!==o?o:[];return-1===r.indexOf(n.token)&&r.push(n.token),this.tokensByAnnotationType.set(e,r),this.annotationActivationTrackers.set(n.token,n),this.activateAnnotationForTracker(n,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateAnnotationForTracker(e,t){const s=new n.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((o=>(s.resultSignature="Ok",s.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,st(s),o))).catch((o=>{throw st(s,`error on activate annotation type ${e.annotationType}: ${o}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),o}))}updateAnnotationConfig(e,t){const s=new _.Ol({token:e,config:t});this.sendMessageToSession(s);const o=this.annotationActivationTrackers.get(e);o&&o.options&&(o.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const s=s=>{const o=s.get(t.annotationType);o&&(o.delete(e),0==o.size&&s.delete(t.annotationType))};return s(this.annotationCallbacks),s(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,s){const o={state:s};this.submitOperation(new re.XP({parentPath:e,items:[{id:t}],M_:o}))}setAnnotationMetadata(e,t,s){this.submitOperation(new re.XP({parentPath:e,items:[{id:t}],M_:s}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var s,o;if(t||(t=this.generateCorrelationId()),this.logTelemetryForSignalOperations(e,t),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[s,o]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(s,t)}const i=e.filter(this.filterOperationsForSession.bind(this)).filter(ot);if(this.workflowRuntime){if(this.onAnnotationsSubmittedEnabled){const[e,s]=this.partitionAnnotationOperations(i);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(s,t)}else this.submitOperationsToSession(i,t);return}const r=[];if(this.deltaGenerator){const e=new n.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of i)if(re.fZ.typeGuard(e))r.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const n of t.items)re.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(n,t.parentPath):re.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(n,t.parentPath):re.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(o=null===(s=e.items)||void 0===s?void 0:s.map((e=>e.id)))&&void 0!==o?o:[]);r.push(e)}st(e)}if(this.onAnnotationsSubmittedEnabled){const[e,s]=this.partitionAnnotationOperations(r.length?r:i);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(s,t)}else this.submitOperationsToSession(r.length?r:i,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===te.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[s,o]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(s,t):this.executeCallbacksOnAnnotationSubmitted(s,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?o:e,!0,t):this.sendMessageToSession(new _.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?o:e}))}submitSeedGroupOperations(e,t,s){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===te.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);s||(s=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[o,n]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,s),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,s):this.executeCallbacksOnAnnotationSubmitted(o,s),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?n:e,!!t,s):(this.seedGroupSize++,this.sendMessageToSession(new _.Tb({cv:s,seq:0,ops:this.onAnnotationsSubmittedEnabled?n:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,s)=>{this.sendMessageToSession(e,((o,n)=>{o?s(new Error(`${o.error}; for message type: ${f.h.getTypeNameFor(e)}`)):t(n)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,s)=>{this.sendMessageToSessionPostEndpoint(e,((e,o)=>{e?s(new Error(e.error)):t(o)}))}))}submitBinaryStreamUploadMessage(e){return new Promise(((t,s)=>{const o=new n.I({operationName:"sendBinaryStreamUploadMessage",success:!0}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,Ke.wM)(this.connectParams,e,o,((e,o)=>{e?s(new Error(e.error)):t(o)}));else{const n=(n=>(0,Ke.wM)(n,e,o,((e,o)=>{e?s(new Error(e.error)):t(o)}))).bind(this);this.pendingConnectCallbacks.push(n)}}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==ae.J1.None?new Promise(((t,s)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,o)=>{e?s(e):t(o)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new _.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.workflowRuntime&&this.workflowRuntime.close(),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(e){return Ye(this,void 0,void 0,(function*(){this.gateUtils&&!this.isChangeGateForceUserInteractiveAuth&&(this.isChangeGateForceUserInteractiveAuth=yield this.gateUtils.isChangeGateEnabled("CGForceUserInteractiveAuth"));if(!(this.isChangeGateForceUserInteractiveAuth&&e&&e.forceUserPrompt)&&this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const t=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(_.D0.typeGuard(t))throw new Error(t.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}setSeedingStatusChangeCallback(e){e(new _.fr({newStatus:this.seedingStatus})),this.seedingStatusChangeCallbacks.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new Je}onAnnotationResults(e,t,s){i.tG.info(508916486,i.nh.CoreDefault,new n.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),s(void 0,new _.YK),t===et.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,s)=>{this.applyOperationForContext(e,s,t)}),((s,o)=>{t===et.ServerWorkflow&&this.logTelemetryForAnnotation(e,"CallbackInRuntimeClient"),this.triggerRegisteredAnnotationCallbacks(s,e.annotationType,o,e.areApologies)}),(e=>{if(t!==et.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(ot);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var s;t(void 0,new _.YK);for(const t of e.updates){const{annotationType:e,state:o}=t;if(!this.tokensByAnnotationType.has(e))continue;let n;n=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):o===T.K7.Idle?T.K7.Pending:T.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(s=e.options)||void 0===s?void 0:s.stateUpdateCallback)&&e.options.stateUpdateCallback(n,o)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const s=e.filter((e=>re.g0.typeGuard(e))),o=e.filter((e=>!re.g0.typeGuard(e)));if(s.length>0&&this.sendMessageToSession(new _.Tb({cv:t,ops:s})),o.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,s)=>{if(e.length){const t=new _.l0;t.messages=[],e.forEach((e=>{t.messages.push(new _.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{s(e?new Error(e.error):void 0)}))}}:(e,t,s)=>{this.sendMessageToSession(new _.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{s(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new ge.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.batchedOperationsManager.addBatchItem(o,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new _.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:o}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),_.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const s=new n.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,Ke.A2)(this.connectParams,e,s,t);else{const o=(o=>(0,Ke.A2)(o,e,s,t)).bind(this);this.pendingConnectCallbacks.push(o)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const s=new n.I({operationName:"RequestBinaryData",success:!0,cv:(new d.W).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,Ke.ZC)(this.connectParams,e,t,s);else{const o=(o=>(0,Ke.ZC)(o,e,t,s)).bind(this);this.pendingConnectCallbacks.push(o)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,s){let o=f.h.getTypeNameFor(e);if(o!=re.Xr.getTypeName()&&o!=re.I.getTypeName()&&o!=re.fZ.getTypeName()&&o!=re.n4.getTypeName())return;o==re.I.getTypeName()&&(o=re.Xr.getTypeName());const n=fe(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),r=Te(n.parentPath);if(o==re.Xr.getTypeName()||o==re.fZ.getTypeName()){if(!n.body)return;const e=f.h.getTypeNameFor(n.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let a=t.get(s);if(a||(a=[],t.set(s,a)),!n.id){if(this.workflowRuntime)throw new Error("Expected item to have id already");this.localWorkflowManager&&(n.id=this.localWorkflowManager.getNextClientAnnotationId())}if(o==re.Xr.getTypeName())0==a.filter((e=>Te(e.parentPath)==r&&e.id==n.id)).length?a.push(n):i.tG.info(540848911,i.nh.CoreDefault,`AddOperation for (${s}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<a.length;e++)if(a[e].id==n.id&&Te(a[e].parentPath)==r){if(a[e].source==n.source){a[e]=n;break}i.tG.warn(540848912,i.nh.CoreDefault,`UpdateOperation for (${s}, ${n.id}, ${n.source}) can't be applied as the context item with provided path and ID has different source: ${a[e].source}`)}else i.tG.warn(540848913,i.nh.CoreDefault,`UpdateOperation for (${s}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(o==re.n4.getTypeName()){if(!n.id)return;this.availableContexts.forEach(((e,t)=>{let o=e.get(s);o&&(o=o.filter((e=>!(Te(e.parentPath)==r&&e.id==n.id))),0==o.length?e.delete(s):e.set(s,o),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const s of e)if(Ie.has(f.h.getTypeNameFor(s)))for(const e of s.items)for(const s of t||[])this.localWorkflowManager.preProcessItemToWorkflow(s,e,this)}}resolveRequestedContexts(e){const t=[];for(const[s,o,n]of me(e.requestedContextTypesRules)){if(!this.availableContexts.has(s)){if(o==de.in.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(s).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${s} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,s)=>s.findIndex((t=>N.Aq.deepEquals(t,e)))===t))}getContextAnnotations(e,t,s,o){var n,i;const r=s?Te(s):void 0;return null===(i=null===(n=this.availableContexts.get(e))||void 0===n?void 0:n.get(t))||void 0===i?void 0:i.filter((e=>!(r&&Te(e.parentPath)!=r||o&&e.source!=o)))}onWorkflowDefinitionOverrideMessage(e){const t=new n.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),s=e=>{throw st(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void s("Not supported by this local SessionProxy instance.");const o=this.localWorkflowManager.getWorkflowDefinitionsByName(this),i=o.get(e.sourceWorkflowId);if(!i)return void s(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=i.id;const r=o.get(e.targetWorkflowId);r&&(r.allowDefinitionOverride?i.definitionOverrideTargetWorkflows&&-1!==i.definitionOverrideTargetWorkflows.indexOf(r.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(r,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,st(t)):s(`Workflow '${i.id}' does not allow workflow definition for workflow '${r.id}'.`):s(`Workflow '${r.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,s,o){if(this.callAnnotationCallbacks(e,t,s,o),this.hostCallbacks.onAnnotationResult)try{o?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,s):this.hostCallbacks.onAnnotationResult(e,s)}catch(e){i.tG.error(540301151,i.nh.CoreDefault,new n.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new _.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new je,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,s;const o=[];i.tG.info(523776396,i.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(s=e.items)||void 0===s?void 0:s.length)>0?e.items[0].id:"(no items)"})`);let n=[...e.parentPath];for(const t of e.items){const s=[],r=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==r?void 0:r.length){for(const o of r){const i=(0,ze.v4)();n=[...e.parentPath,t.id];const r={id:i,revId:t.revId,body:o,contextId:t.contextId,source:t.source};s.push(r)}s.length>0&&(o.push(new re.xU({parentPath:n,items:s})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,n,s))}else i.tG.info(523329632,i.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return o}setupSyncDeltaAfterDelay(e,t,s){var o,n,i;const r=this.syncDeltaTimers.get(e.id);r&&(clearTimeout(r),this.syncDeltaTimers.delete(e.id));const a=s.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===Le.OD.Chars}));if(a){const s=a.body,r={content:"",deltaType:Le.WI.Update,length:0,position:(null!==(o=null==s?void 0:s.position)&&void 0!==o?o:0)+(null!==(i=null===(n=null==s?void 0:s.content)||void 0===n?void 0:n.length)&&void 0!==i?i:0),unit:Le.OD.Sentence},c=Ee.Cg.typeGuard(e.body)?new Pe.s(r):new Pe.Q(r),l={id:(0,ze.v4)(),revId:e.revId,body:c,contextId:e.contextId,source:e.source},u=new re.xU({parentPath:t,items:[l]}),p=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,u,e.id);this.syncDeltaTimers.set(e.id,p)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow(Se(e))}getAnnotations(e,t){var s,o,i;const r=new n.I({operationName:"GetAnnotations",success:!0,dimension1:null===(s=e.annotationType)||void 0===s?void 0:s.toString(),dimension2:null===(o=e.maxDelayMs)||void 0===o?void 0:o.toString(),cv:e.cv}).setClientMetadata(this.clientMetadata).start(),a=this.sessionManager.getCorrelationVector(),c=new oe.x5({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:null!==(i=e.cv)&&void 0!==i?i:a.newChild().toString()}}),l=[];let u;this.sendMessageToSession(c,((e,s)=>{(null==t?void 0:t.IsCancellationRequested)||(l.push({error:e,response:s}),null==u||u(!0))}));const p=this;let g=!1;const h=new Promise(((e,s)=>{if(t){const o=t.cancel.bind(t);t.cancel=()=>{g?e():(o(),s(new Error(nt.requestCancelledError)))}}}));return{[Symbol.asyncIterator](){var e,s,o,n,i;return Xe(this,arguments,(function*(){for(;!g;)try{0===l.length&&(yield Ze(Promise.race([new Promise((e=>u=e)),h])));const a=l.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(nt.requestCancelledError);let c;g=(null===(e=a.response)||void 0===e?void 0:e.finalResponse)||void 0!==a.error,r.dimension3=`final response: ${g}`,a.error?(r.dimension0=`Error code: ${a.error.code}`,st(r,a.error.error),c={serviceError:[{code:T.Qn.ServerError,error:a.error.error,retryable:null==p?void 0:p.canBeRetried(a.error)}]}):(null===(o=null===(s=a.response)||void 0===s?void 0:s.errorInfo)||void 0===o?void 0:o.length)>0?(r.dimension0=`Error code: ${a.response.errorInfo}`,st(r,"Workflow execution error"),c={serviceError:a.response.errorInfo}):(r.resultDescription="OK",st(r)),yield yield Ze({content:null===(n=a.response)||void 0===n?void 0:n.content,error:null!=c?c:void 0,finalResponse:null===(i=a.response)||void 0===i?void 0:i.finalResponse})}catch(e){const t=e.message===nt.requestCancelledError?T.zy.RequestCancelled:T.zy.Unknown;r.dimension0=`Error code: ${t}`,st(r,null==e?void 0:e.message),yield yield Ze({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),g=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==te.JSWebSockets||e.getNetworkMode()!==te.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===T.xv.TooManyRequests||(null==e?void 0:e.code)===T.xv.RequestTimeout}getAuthToken(e,t){const s={Tickets:[]};this.clientMetadata.docSessionId&&(s.DocSessionId=this.clientMetadata.docSessionId);const o=(e=>{if(e===he.OY.Substrate)return ue.OY.Substrate})(e);o&&(s.TokenType=o),this.hostCallbacks.requestAuthToken(s).then((s=>{var o;if(!s)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!s.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,s.Token,{returnedTokenType:e,timeToLiveSec:null===(o=s.TokenProperties)||void 0===o?void 0:o.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,s)=>{t(e)}))}onConnect(e,t,s,o,n,i){this.hasSessionConnected?e&&(this.allowSeed=!0,this.allowGroupSeed=!0,this.seedingStatus=T.e9.NotStarted,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})):this.enableRemoteExecutionNotification&&this.addDownstreamWorkflowsIntoClientGraph(i),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:s,authToken:o},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((n,i)=>{n(e,t,s,o)})),this.serverInputTypes=n}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,s)=>{t(e)}))}onSeedingStatusChangeMessage(e){const t=new n.I({operationName:"SeedingStatusChange",success:!0}).setClientMetadata(this.clientMetadata).start();t.setDataField("Status",T.e9[e.newStatus]),st(t),this.seedingStatus=e.newStatus,this.seedingStatusChangeCallbacks.forEach((t=>{t(e)}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==ie.f.Authenticated&&e==ie.f.Pending)return;const t=new n.I({operationName:"ServerAuthStateChange",dimension0:e.toString(),dimension1:this.serverAuthenticationState.toString(),success:!0}).setClientMetadata(this.clientMetadata).start();t.resultDescription=`Changing Server Authentication State newState: ${e}`,st(t),this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,s,o){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const n=o?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);n&&n.forEach((t=>{t(e,s)}))}getOperationBatchConfig(e){let t;t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]});return{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:Qe.E,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,s){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,s)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const o=new _.l0;o.messages=[],e.forEach((e=>{o.messages.push(new _.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(o,(e=>{s(e?new Error(e.error):void 0)}))}}:(e,t,s)=>{this.seedGroupSize++,this.sendMessageToSession(new _.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{s(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new ge.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},s,t)}onAnnotationResultsFromServer(e,t){this.logTelemetryForAnnotation(e,"ReceiveFromNetwork"),this.onAnnotationResults(e,et.ServerWorkflow,t)}onAnnotationResultsFromLocal(e,t){this.onAnnotationResults(e,et.LocalWorkflow,t)}getLocalRegisteredWorkflows(){return this.workflowRuntime?this.workflowRuntime.getRegisteredWorkflows():this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>Se(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new n.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),s=new _.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(s,((s,o)=>{s?st(t,s.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${o.downstreamRuntimeWorkflows.map((e=>e.id))}`,st(t),this.onWorkflowGraphInitResponse(o))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.workflowRuntime||this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(i.tG.info(540848914,i.nh.CoreDefault,`Replacing user context placeholder for: ${Te(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(i.tG.info(540848915,i.nh.CoreDefault,`Replacing tenant context placeholder for: ${Te(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return!!this.workflowRuntime||(0,N.zX)(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:s,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);s.forEach(((e,s)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,s,t,!1)))})),o.forEach(((e,s)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,s,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],s)=>s.items.some((e=>e.body&&ce.YH.typeGuard(e.body)))?[[...e,s],t]:[e,[...t,s]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:s,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);s.forEach(((e,s)=>{const o=Array.from(e);this.onAnnotationResults(new _.B_({annotationType:s,ops:o,cv:t,areApologies:!1}),et.Submitted,(()=>{}))})),o.forEach(((e,s)=>{const o=Array.from(e);this.onAnnotationResults(new _.B_({annotationType:s,ops:o,cv:t,areApologies:!0}),et.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,s=new Map;for(const o of e)for(const e of o.items)if(e.body&&ce.YH.typeGuard(e.body)){const n=(e,t)=>{const s=e.get(t)||new Set;s.add(o),e.set(t,s)};le.k$.typeGuard(e.body)?n(s,e.body.annotationTypeName):n(t,f.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:s}}onClaimsChallengeMessage(e,t){const s=new n.I({operationName:"OnClaimsChallengeMessage",dimension0:e.claimsVersion.toString(),dimension1:e.error,success:!0}).setClientMetadata(this.clientMetadata).start();s.resultSignature=`HasClaims: ${!!e.claims&&e.claims.length>0}`,s.resultDescription="Received Claims Challenge Message from Server",st(s),e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0}));for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge);t(void 0,new _.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e,t){if(e||!t)return;const s=t.tokenType&&t.tokenType==he.OY.WacUserInfo?ie.f.WacUserInfoAuthenticated:ie.f.Authenticated;this.onServerAuthenticationStateChange(s)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var s;const o=new n.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(s=null==t?void 0:t.interactive)&&void 0!==s&&s}`}).start();o.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const i={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:ue.OY.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(i).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return o.resultSignature="Token",new _.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(o.resultSignature="NoToken",o.dimension2=t.message,new _.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,s)=>{this.sendMessageToSession(e,((n,i)=>{st(o,null==n?void 0:n.error),this.onTokenProvisionResponse(n,i),n?s(new Error(n.error)):(_.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1),t(e))}))}))))}logTelemetryForSignalOperations(e,t){const s=new _.Tb({cv:t,ops:e}),o=(0,Q.V)(s);if(!o)return;const i=new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start();i.setDataField("CurrentTimestamp",Date.now().toString()),i.cv=s.cv,i.resultSignature="SubmitInRuntimeClient",i.resourceId=f.h.getTypeNameFor(o.body),o.contextId&&i.setDataField("ContextId",o.contextId),o.sourceTimestamp&&i.setDataField("SourceTimestamp",o.sourceTimestamp.toString()),st(i)}logTelemetryForAnnotation(e,t){if(!(0,Q.K)(e))return;const s=new n.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start();s.setDataField("CurrentTimestamp",Date.now().toString()),s.cv=e.cv,s.resultSignature=t,s.resourceId=e.annotationType,st(s)}}nt.requestCancelledError="Request cancelled";class it{}var rt;!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(rt||(rt={}));class at{constructor(){this.timers=new Map}scheduleRefresh(e,t,s,o){let n=this.timers.get(e);n||(n={numberOfAttempts:0},this.timers.set(e,n)),n.refreshTimeoutId&&(clearTimeout(n.refreshTimeoutId),n.refreshTimeoutId=void 0),n.expiredTimeoutId&&(clearTimeout(n.expiredTimeoutId),n.expiredTimeoutId=void 0);let i=1e3*t-at.tokenRefreshBufferMs,r=1e3*t-at.tokenExpirationBufferMs;i>0?n.numberOfAttempts=0:(++n.numberOfAttempts,i=at.tokenRefreshBackoffIntervalMs,r=at.tokenExpirationBufferMs),n.numberOfAttempts<=at.tokenRefreshMaximumAttempts&&(n.refreshTimeoutId=setTimeout((()=>{s()}),i)),o&&(n.expiredTimeoutId=setTimeout((()=>{o()}),r))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,s)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(s)}))}}at.tokenRefreshBufferMs=24e4,at.tokenExpirationBufferMs=12e4,at.tokenRefreshBackoffIntervalMs=3e4,at.tokenRefreshMaximumAttempts=3;var ct=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};class lt extends I.EventEmitter{constructor(e,t,s,o,n){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=s,this.sendMessage=o,this.options=n||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=N.Aq.getCurrentTimeMs(),s=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,o=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,a=new n.I({operationName:"SessionInit"}).start(),c={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:s,timeSinceLastSyncMessage:o,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0},l=this.options.overrideSessionInitMessage(new _.eE({protocolVersion:T.mH,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(l,((t,s)=>{if(a.success=!t,a.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",a.resourceId=(0,r.k$)(null==s?void 0:s.sliceUrl),a.setClientMetadata(this.clientMetadata),(null==s?void 0:s.sessionKey)&&c.sessionKey!==s.sessionKey&&(c.sessionKey=s.sessionKey),t&&(c.error=t.error),a.resultDescription=JSON.stringify(c),i.tG.info(508843779,i.nh.CoreDefault,a.stop()),e.onResponse(t,s),t)this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&s.forceReconnect)this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);else{if(!s.anonymousToken||!s.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),void i.tG.error(508843778,i.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=s.anonymousToken,this.onSuccessfulSessionInitOnServerSide(s)}}))}onSuccessfulSessionInitOnServerSide(e){this.tokenRefreshManager.scheduleRefresh(rt.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},this.options.sendTokenFailureMessageChangeGate?this.initHostAuthTokenNew().catch((()=>{})):this.initHostAuthToken();const t=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,t,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows),t&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:ue.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}getAuthTokenNew(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:ue.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new n.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==ue.Pu.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",ie.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void i.tG.info(508843777,i.nh.CoreDefault,t.stop());i.tG.info(508843776,i.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,i.tG.error(508843747,i.nh.CoreDefault,t.stop())}))}}initHostAuthTokenNew(){return ct(this,void 0,void 0,(function*(){const e=this.getAuthTokenNew.bind(this);if(this.options.requestAuthToken&&e){const t=new n.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();let s,o,r=ie.f.NotAuthenticated;try{if(s=yield e(),!s)throw new Error("TokenResponse is not set");if(!s.Token)throw s.TokenError==ue.Pu.TokenMissingInteractionRequired?(r=ie.f.TokenMissingInteractionRequired,new Error("Host auth token provision failed interaction required")):new Error("Host auth token provision failed")}catch(e){o=e.message,this.emit("serverAuthenticationStateChange",r),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`}try{o?this.sendMessage(new _.D0({reason:o,version:lt.initialTokenVersion,clientHandlesResponse:!0})):this.sendTokenProvisionMessage(s.Token)}catch(e){o||(o=e.message,this.emit("serverAuthenticationStateChange",r),t.success=!1,t.resultDescription=`Error happened while attempting to send host token: ${e}`)}finally{o?i.tG.error(506074845,i.nh.CoreDefault,t.stop()):i.tG.info(506074846,i.nh.CoreDefault,t.stop())}}}))}sendTokenProvisionMessage(e){const t=new _.kd({authToken:e,version:lt.initialTokenVersion});this.emit("serverAuthenticationStateChange",ie.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){if(e||!t||!t.tokenExpirationSeconds)return void this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);const s=t.tokenType&&t.tokenType==he.OY.WacUserInfo?ie.f.WacUserInfoAuthenticated:ie.f.Authenticated;this.emit("serverAuthenticationStateChange",s),this.tokenRefreshManager.scheduleRefresh(rt.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))}}lt.initialTokenVersion=1;var ut=s(67880),pt=s(68174),gt=s(92100),ht=s(55224),dt=s(10834);class mt{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=Te(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class yt{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&f.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&f.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new mt(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const ft=[Le.WI.CursorUpdate,Le.WI.FormattingUpdate,Le.WI.OtherNonContentUpdate,Le.WI.AttributionUpdate];function Tt(e,t,s){const o=new n.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return o.success=!1,o.resultDescription="Unable to apply text tile delta, parent tile is undefined",void i.tG.info(538798173,i.nh.CoreDefault,o.stop());if(f.h.getTypeNameFor(t)!==Ee.qf.getTypeName())return o.success=!1,o.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${Pe.Q.getTypeName()}, received ${f.h.getTypeNameFor(t)}`,void i.tG.info(538798174,i.nh.CoreDefault,o.stop());const s=e,n=t.content;let r="";if(void 0===s.position||s.position<0)return o.success=!1,o.resultDescription="Unable to apply text tile delta, invalid text tile position",void i.tG.info(538798175,i.nh.CoreDefault,o.stop());switch(s.deltaType){case Le.WI.Add:r=s.position<n.length?`${n.slice(0,s.position)}${s.content}${n.slice(s.position,n.length)}`:n+s.content;break;case Le.WI.Update:s.content||s.unit!==Le.OD.Sentence||(o.dimension0="1"),r=`${n.slice(0,s.position)}${s.content}${n.slice(s.position+(s.length||0),n.length)}`;break;case Le.WI.Delete:r=`${n.slice(0,s.position)}${n.slice(s.position+(s.length||0),n.length)}`}return i.tG.info(538837071,i.nh.CoreDefault,o.stop()),new Ee.qf({content:r})}catch(e){return o.success=!1,o.resultDescription=`Error applying text tile delta: ${e}`,void i.tG.info(538798176,i.nh.CoreDefault,o.stop())}}function _t(e,t){var s,o,r,a;const c=function(e,t,s){const o=new n.I({operationName:"FindRangeForDelta",success:!0});if(o.start(),!e)return o.resultDescription="No formatted ranges found within the tile, skipping.",void i.tG.info(538798212,i.nh.CoreDefault,o.stop());if(t===Le.WI.Add){const t=e.find((e=>e.start===s&&0===e.length));if(t)return o.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,i.tG.info(538798213,i.nh.CoreDefault,o.stop()),t;s=Math.max(s-1,0)}const r=e.find((e=>0===e.length?e.start===s:e.start<=s&&s<e.start+e.length));r?(o.resultDescription=`Updating formatted range for operation with start: ${r.start} and length: ${r.length}`,i.tG.info(538798214,i.nh.CoreDefault,o.stop())):(o.resultDescription=`Unable to find formatted range for operation at position ${s}, skipping.`,i.tG.info(538798215,i.nh.CoreDefault,o.stop()));return r}(e.formattedRanges,t.deltaType,t.position);let l=e.formattedRanges?[...e.formattedRanges]:[];const u=c?l.indexOf(c):-1;-1!==u&&(t.position+(t.length||0)>c.start+c.length?c.length=t.position+(null!==(s=t.content)&&void 0!==s?s:"").length-c.start:c.length+=(null!==(o=t.content)&&void 0!==o?o:"").length-(t.length||0),l[u]=c);for(const e of l.slice(u+1))e.start<t.position||(t.position+(t.length||0)>e.start?(e.length=e.start+e.length-(t.position+(t.length||0)),e.start=t.position+(null!==(r=t.content)&&void 0!==r?r:"").length):e.start+=(null!==(a=t.content)&&void 0!==a?a:"").length-(t.length||0));return l=l.filter((e=>e.length>0)),l}function Ct(e,t){var s;let o=e.attributionRanges?[...e.attributionRanges]:[];if(!(0,y.I)("updateAttributionRangesInFormattedTextDeltas")||0===o.length&&!t.attributionRanges)return o;o.forEach((e=>{var s,n;if(e.start<t.position&&e.start+e.length>t.position){const n=t.position-e.start,i=!t.length||t.deltaType!==Le.WI.Update&&t.deltaType!==Le.WI.Delete?0:t.length,r=e.length-n-i;e.length=t.position-e.start,r>0&&o.push({start:t.position+(null!==(s=t.content)&&void 0!==s?s:"").length,length:r,attribution:e.attribution})}else if(e.start>=t.position)switch(t.deltaType){case Le.WI.Add:e.start+=t.content.length;break;case Le.WI.Delete:case Le.WI.Update:e.start+=(null!==(n=t.content)&&void 0!==n?n:"").length-(t.length||0);case Le.WI.CursorUpdate:case Le.WI.FormattingUpdate:case Le.WI.OtherNonContentUpdate:case Le.WI.AttributionUpdate:}}));o=o.filter((e=>e.length>0&&!(e=>{if(!t.attributionRanges)return!1;for(const s of t.attributionRanges)if(s.start<=e.start&&s.start+s.length>=e.start+e.length)return!0;return!1})(e))),null===(s=t.attributionRanges)||void 0===s||s.forEach((e=>{o.push(e)})),o.sort(((e,t)=>e.start-t.start));const n=[];for(const e of o){const t=n.length>0?n[n.length-1]:void 0;!t||(r=e,(i=t).attribution.userId!==r.attribution.userId||i.attribution.timestamp!==r.attribution.timestamp||i.attribution.dataSource!==r.attribution.dataSource)||e.start>t.start+t.length?n.push(e):t.length+=Math.max(e.start+e.length-(t.start+t.length),0)}var i,r;return n}function vt(e,t,s){var o,r,a,c;const l=new n.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();l.clientFlights=s;try{if(!t)return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void i.tG.info(538798177,i.nh.CoreDefault,l.stop());if(f.h.getTypeNameFor(t)!==Ee.Cg.getTypeName())return l.success=!1,l.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${Ee.Cg.getTypeName()}, received ${f.h.getTypeNameFor(t)}`,void i.tG.info(538798178,i.nh.CoreDefault,l.stop());const s=t,u=e,p=s.content;let g="";if((void 0===u.position||u.position<0)&&!At(u.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void i.tG.info(538798179,i.nh.CoreDefault,l.stop());if(void 0===u.content&&!At(u.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void i.tG.info(538798208,i.nh.CoreDefault,l.stop());if(u.deltaType===Le.WI.Add&&0!==u.length?i.tG.info(538798209,i.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):At(u.deltaType)&&void 0!==u.content&&i.tG.info(538798210,i.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!St(u.deltaType)){const e=_t(s,u),t=Ct(s,u);let n=s.ipPosition;switch(u.deltaType){case Le.WI.Add:g=u.position<p.length?`${p.slice(0,u.position)}${u.content}${p.slice(u.position,p.length)}`:p+u.content,n=u.position+u.length;break;case Le.WI.Update:u.content||u.unit!==Le.OD.Sentence||(l.dimension0="1"),g=`${p.slice(0,u.position)}${u.content}${p.slice(u.position+(null!==(o=u.length)&&void 0!==o?o:0),p.length)}`,n=u.position+u.content.length;break;case Le.WI.Delete:g=`${p.slice(0,u.position)}${p.slice(u.position+(null!==(r=u.length)&&void 0!==r?r:0),p.length)}`,n=u.position}const a=new Ee.Cg(Object.assign(Object.assign({},s),{ipPosition:n,content:g,formattedRanges:e,attributionRanges:t,queryRange:u.queryRange}));return i.tG.info(538837073,i.nh.CoreDefault,l.stop()),a}if(u.deltaType===Le.WI.CursorUpdate)return new Ee.Cg(Object.assign(Object.assign({},s),{ipPosition:null===(a=u.cursorData)||void 0===a?void 0:a.ipPosition,isColdIp:null===(c=u.cursorData)||void 0===c?void 0:c.isColdIp}));if(u.deltaType===Le.WI.FormattingUpdate)return new Ee.Cg(Object.assign(Object.assign({},s),{formattedRanges:u.formattedRanges}));if(u.deltaType===Le.WI.OtherNonContentUpdate){let e;const t={};for(e in u.otherNonContentData)t[e]=u.otherNonContentData[e];return new Ee.Cg(Object.assign(Object.assign({},s),t))}return u.deltaType===Le.WI.AttributionUpdate?new Ee.Cg(Object.assign(Object.assign({},s),{attributionRanges:Ct(s,u)})):void 0}catch(e){return l.success=!1,l.resultDescription=`Error applying formatted text tile delta: ${e}`,void i.tG.info(538798211,i.nh.CoreDefault,l.stop())}}function St(e){return-1!==ft.indexOf(e)}function At(e){return St(e)||Le.WI.Delete===e}function wt(e){if(!e)return new It([],new Set,new Map,new Map);const t=e.split(";"),s=new Set,o=new Map,n=new Map;for(const e of t){const t=e.trim();if(""===t)continue;s.add(It.normalizeName(t));const[i,...r]=t.split(":"),a=r.join(":"),c=It.normalizeName(i);if(c){o.set(c,a);const e=It.parseName(c);e&&e!==c&&n.set(e,c)}}return new It(t,s,o,n)}class It{constructor(e,t,s,o){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=s,this.parsedFlightsMap=o}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=It.normalizeName(e),s=this.normalizedFlights.has(t),o=this.keyValueFlightsMap.has(t),n=this.parsedFlightsMap.has(t);return s||o||n}getBooleanValue(e,t){var s,o;const n=null===(s=this.getStringValue(e))||void 0===s?void 0:s.toLowerCase(),i=null===(o=this.getStringValue(this.parsedFlightsMap.get(It.normalizeName(e))))||void 0===o?void 0:o.toLowerCase();return"true"===n||"true"===i||"false"!==n&&"false"!==i&&t}getIntValue(e,t){const s=this.getStringValue(e),o=Number.parseInt(s,10);return Number.isNaN(o)?t:o}getStringValue(e,t){var s;return null!==(s=this.keyValueFlightsMap.get(It.normalizeName(e)))&&void 0!==s?s:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,s)=>{const o=null==t?void 0:t.toLowerCase();switch(o){case"true":e.push({name:s,value:!0});break;case"false":e.push({name:s,value:!1});break;default:{const n=Number.parseInt(o,10);Number.isNaN(n)?e.push({name:s,value:t}):e.push({name:s,value:n})}}})),e}}class Nt{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=wt(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}getTokenAsync(e){return new Promise(((t,s)=>{this.getToken(e,((e,o,n)=>{e?s(e):t(Object.assign(Object.assign({},n),{token:o}))}))}))}}class bt{constructor(e,t,s){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,s&&(this.itemsContextId=s.itemsContextId,this.executionState=s.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const s of this.itemsContextId)0===s.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(i.tG.info(520217546,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(i.tG.info(508883415,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,be.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,be.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===be.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[s,o]of t.getExecutionState())o===be.Executed&&Ne.isParentContextId(e,s)&&t.tryToCompleteWorkflowExecution(s)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const s of t.getExecutionState().keys())if(Ne.isParentContextId(s,e))return!1;return!0}}var kt;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(kt||(kt={}));class Mt{constructor(e,t,s){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,s)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,s):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,s)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,s):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,s.enableDeltas&&(this.deltaHandlers=(new Map).set(f.h.getTypeNameFor(Pe.Q),Tt).set(f.h.getTypeNameFor(Pe.s),vt),this.itemsForDelta=new Map),this.enableEarlyJoin=s.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const s=new n.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(me(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),s.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,s)=>{t.push(this.createWorkflowImplementation(e,s))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,s)=>{s.registerContextTypes(me(e.requestedContextTypesRules).map((([e,t])=>e))),s.attachToWorkflowGraph(e)}))),s.success=!0,i.tG.info(572838110,i.nh.CoreDefault,s.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const s=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>s.set(e.workflow.id,e.workflow))),s}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,s){const o=e.getWorkflowNodes(),n=this.executionTrackersByWorkflowNameBySession.get(t),i=(e,o)=>{if(s&&s(e,o),this.enableEarlyJoin){(()=>{for(const e of this.executionTrackersByWorkflowNameBySession.get(t).values())if(e.graphNode.workflow.kind===de.wC.Join)for(const t of e.getExecutionState().keys())if(Ne.isParentContextId(t,o))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())}};for(const e of o){const t=n.get(e.workflow.id),s=new bt(e,i.bind(this),t);n.set(e.workflow.id,s)}for(const e of n.values())this.setDownstreamWorkflowExecutionTrackers(e,n),this.setUpstreamWorkflowExecutionTrackers(e,n)}canActivateWorkflow(e,t){var s;return e.location===_e.Local||!!t.hasConnected&&!((null===(s=e.workflow.requiredTokenTypes)||void 0===s?void 0:s.length)>0&&t.getServerAuthenticationState()===ie.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:s}=e;for(const o of s.downstreamWorkflows||[]){const s=t.get(o.workflow.id);this.setDownstreamWorkflowExecutionTrackers(s,t),e.downstreamWorkflowExecutionTrackers.add(s)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:s}=e;for(const o of s.upstreamWorkflows||[]){const s=t.get(o.workflow.id);this.setUpstreamWorkflowExecutionTrackers(s,t),e.upstreamWorkflowExecutionTrackers.add(s)}}deactivateServerWorkflow(e,t){var s;e.location!==_e.Local&&(null===(s=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===s||s.get(e.workflow.id).clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const s of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(s)),e.attachToWorkflowGraph(s);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,s){const o=this.executionTrackersByWorkflowNameBySession.get(s).get(e.id);e.kind===de.wC.Join&&f.h.matchesTypesFor(t.body,e.inputTypes)&&o.addInputItemToProcess(t.contextId),(e.kind===de.wC.SingleItem&&f.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===de.wC.Join&&f.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&o.beforeWorkflowExecution(t.contextId)}isReadyToEarlyJoin(e,t,s){const o=o=>{var r;const a=Array.from(null!==(r=o.states)&&void 0!==r?r:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),c=new n.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();c.setClientMetadata(s),c.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${o.hasProcessedAllInputItems}, allUpstreamComplete: ${o.allUpstreamComplete}, states: ${a}`,i.tG.info(512550800,i.nh.CoreDefault,c.stop())},r=0===e.countItemsToProcess(t);if(!r)return this.enableEarlyJoin||o({hasProcessedAllInputItems:r}),!1;const{allUpstreamComplete:a,states:c}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?a:(o({hasProcessedAllInputItems:r,allUpstreamComplete:a,states:c}),!1)}areAllUpstreamWorkflowComplete(e,t){const s=new Map;for(const o of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[n,i]of o.getExecutionState())if(e.push([n,i]),Ne.isParentContextId(t,n))return s.set(o.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:s};e.length>0&&s.set(o.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:s}}runLocalWorkflows(e,t,s=!1){var o,r,a;const c=(e,s,o)=>{var r,a;const c=t.getWorkflowItemStorage(),{workflow:l}=e,u=null===(r=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===r?void 0:r.get(l.id),p=l.inputTypes.concat(l.kind===de.wC.Join?l.collectionScopeType:[]),g=new n.I({operationName:"RunLocalWorkflows",success:!0,resourceId:l.id,joinContextId:s.contextId}).start();if(g.setClientMetadata(t.getClientMetadata()),f.h.matchesTypesFor(s.body,p)){const n=fe(o.parentPath,s);if(l.kind===de.wC.Join){if(f.h.matchesTypesFor(n.body,[l.collectionScopeType]))return c.setScopeItem(n,l),g.resultDescription=`Scope item: ${s.id} (${f.h.getTypeNameFor(s.body)})`,i.tG.info(524126153,i.nh.CoreDefault,g.stop()),void this.setScopeExecutionNotification(t,e,n,tt.Internal);{u.removeProcessedInputItem(n.contextId);const e=c.getScopeItem(n.contextId,l);if(!e)return g.resultDescription=`Filtered out join invalidation: out of scope type (${l.collectionScopeType}), item id: ${n.id}`,void i.tG.info(541173894,i.nh.CoreDefault,g.stop());c.addItemToWorkflowList(n,l),g.joinContextId=e.contextId,g.resultDescription=`Input item: ${s.id} (${f.h.getTypeNameFor(s.body)})`}}if(f.h.getBaseTypesFor(n.body).indexOf(ut.W1.getTypeName())>=0){const e=[...n.parentPath,n.id];let s=!0;for(const o of null!==(a=l.outputTypes)&&void 0!==a?a:[])if(!t.getContextAnnotations(o,et.LocalWorkflow,e,l.id)){s=!1;break}if(s)return}const r=()=>{var o;const[a,p]=t.resolveRequestedContexts(l);if(!a)return g.resultDescription=`Required contexts are not ready for ${l.id}. Retrying execution in 500 milliseconds...`,i.tG.info(545837259,i.nh.CoreDefault,g.stop()),void setTimeout(r,500);if(l.kind===de.wC.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:n,inputItems:[n],requestedContexts:p,session:t,orchestrationMode:tt.Internal,triggerReason:kt.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,l,t)}).then((()=>{i.tG.info(509154263,i.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,i.tG.error(572838111,i.nh.CoreDefault,g.stop())}));else if(l.kind===de.wC.Join){const n=s.contextId,r=c.getScopeItem(n,e.workflow);if(!r)return g.resultDescription=`No scope item for ${l.id} workflow from contextId ${n}`,void i.tG.info(526758475,i.nh.CoreDefault,g.stop());const a=this.isReadyToEarlyJoin(u,r.contextId,t.getClientMetadata()),h=a?kt.JoinEarlyCompletion:kt.JoinMaxAnnnotation;if(c.isWorkflowReady(r.contextId,l)||a){if(!(null===(o=this.pendingScopeExecutionNotificationsByWorkflow.get(l.id))||void 0===o?void 0:o.get(r.contextId)))return g.resultDescription=`Workflow ${l.id}, contextId ${r.contextId}, already queued, skipping new scope execution`,void i.tG.info(528048977,i.nh.CoreDefault,g.stop());const s=c.getItemsToExecute(r.contextId,l);this.queueWorkflow({workflowInfo:e,scopeItem:r,inputItems:s,requestedContexts:p,session:t,orchestrationMode:tt.Internal,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,r,l,t)}).then((()=>{i.tG.info(509154262,i.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,i.tG.error(541173895,i.nh.CoreDefault,g.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).delete(r.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(l.id)}}};r()}};let l=e;s&&(l=[new re.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new ut.hD}]}),new re.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new ut.SB}]})],t.getContextIdManager().applyContextIdOnOperations(l),l=l.concat(e));for(const e of l){const s=f.h.getTypeNameFor(e);for(const n of e.items)if(t.applyOperationForContext(e,n,et.Submitted),s!==re.n4.getTypeName()){if(n.body)if(s===re.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(n,e,t);else{null===(r=this.itemsForDelta)||void 0===r||r.set(e.parentPath.concat(n.id).toString(),n);for(const t of this.workflowsWithoutSessionAffinity)c(t,n,e);for(const s of null!==(a=this.workflowsWithSessionAffinity.get(t))&&void 0!==a?a:[])c(s,n,e)}}else null===(o=this.itemsForDelta)||void 0===o||o.delete(e.parentPath.concat(n.id).toString())}}handleLocalDeltaUpdate(e,t,s){const o=new n.I({operationName:"LocalDeltaUpdate",dimension0:f.h.getTypeNameFor(e.body),success:!0});o.start();try{const n=this.deltaHandlers.get(f.h.getTypeNameFor(e.body)),r=this.itemsForDelta.get(t.parentPath.toString());if(n&&r){const a=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,c=n(e.body,r.body);if(c){const t={id:r.id,revId:e.revId,body:c,parentPath:a,delta:e.body,contextId:e.contextId},n=new re.I({parentPath:t.parentPath,items:[t]});i.tG.info(539637591,i.nh.CoreDefault,o.stop()),this.runLocalWorkflows([n],s)}else o.success=!1,o.resultDescription="Failed because the handler did not produce valid updated item",i.tG.info(539637592,i.nh.CoreDefault,o.stop())}else o.success=!1,o.resultDescription="Failed due to lack of handler or parent item",i.tG.info(539637593,i.nh.CoreDefault,o.stop())}catch(e){o.success=!1,o.resultDescription=`Failed to apply delta, error: ${e}`,i.tG.info(539637594,i.nh.CoreDefault,o.stop())}}createWorkflowImplementation(e,t){const s=e.factory();return{workflow:e,workflowLambda:s,initPromise:this.initWorkflow(e.kind,s,t)}}initWorkflow(e,t,s){const o=new Nt({model:void 0,clientMetadata:s?s.getClientMetadata():void 0,userContext:s?s.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===de.wC.SingleItem||e===de.wC.Join?t.init(this.site,o):Promise.resolve()}queueWorkflow(e){return this.executionTrackersByWorkflowNameBySession.get(e.session).get(e.workflowInfo.workflow.id).setExecutionState(e.scopeItem.contextId,be.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.orchestrationMode,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const s of e)t.onAnnotationResults(s,et.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,s,o,r,a,c){return new Promise(((l,u)=>{var p,g,h;const d=[],m=e.workflow,y=new n.I({operationName:"ExecuteWorkflow",resourceId:m.id,joinContextId:null!==(p=null==t?void 0:t.contextId)&&void 0!==p?p:"",resultDescription:null!=c?c:"",success:!0}).setClientMetadata(o.getClientMetadata());y.start();const T=null!==(g=null==t?void 0:t.contextId)&&void 0!==g?g:s[0].contextId,C=null!==(h=null==t?void 0:t.revId)&&void 0!==h?h:s[0].revId,v=(()=>{const e=new Map;if(t&&(t.parentPath||i.tG.error(525382231,i.nh.CoreDefault,`Missing scope item parent. Workflow: ${m.id}. Type: ${f.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(s))for(const t of s)t&&t.body&&(t.parentPath||i.tG.error(525382232,i.nh.CoreDefault,`Missing parent. Workflow: ${m.id}. Type: ${f.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),S=(e,t=y)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",i.tG.error(572838112,i.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;i.tG.info(572838113,i.nh.CoreDefault,t.stop())},A=new Nt({model:new yt(s[0],r),clientMetadata:o.getClientMetadata(),userContext:o.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),w=e=>{S(e?e.message:void 0),e?u(e):l(d)},I={setAnnotations:(r,c,l,p)=>{var g;const h=new n.I({operationName:"SetAnnotations",resourceId:c,joinContextId:null!==(g=null==t?void 0:t.contextId)&&void 0!==g?g:"",success:!0}).setClientMetadata(o.getClientMetadata());h.start();const y=t=>{i.tG.info(555866112,i.nh.CoreDefault,new dt.v({annotationType:c,annotationState:t,workflowId:e.workflow.id}))};for(const e of l)e.metadata=Object.assign(Object.assign({},e.metadata),{state:pt.r.Created}),y(pt.r.Created);const A=v.get(r),w=f.h.getTypeNameFor(A.body),I=(()=>{var e;if(m.kind===de.wC.SingleItem&&s[0].body!==r){const e=`Expected obj to be ${s[0].body} but instead it was ${r}`;return S(e,h),void u(S(e))}let t,n;if(Array.isArray(l))if(!m.outputTypes||m.outputTypes.indexOf(c)<0)t=`Workflow said it would output one of [${m.outputTypes}] but instead output ${c}`;else if(A)for(const e of l)f.h.matchesTypesFor(e,[ce.YH.getTypeName()])?f.h.getTypeNameFor(e)!==c&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${f.h.getTypeNameFor(e)} did not match expected ${c})`):t=`Workflow produced an output that is not an annotation ${f.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return S(t,h),void u(S(t));if(n=p&&p.isSessionAnnotation?["session"]:p&&p.ancestorType?A.parentPath:A.parentPath.concat(A.id),a===tt.External)return;const g=[],d=[];for(const t of l){t.metadata=Object.assign(Object.assign({},t.metadata),{state:pt.r.Sent}),y(pt.r.Sent);const s=t.id,r=s?null===(e=o.getContextAnnotations(c,et.LocalWorkflow,n,m.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==s})):void 0;1==(null==r?void 0:r.length)?1==r.length?d.push({id:r[0].id,source:m.id,revId:C,body:t,contextId:T}):i.tG.error(545837260,i.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${s} found for ${c} and local workflow ${m.id}).`):g.push({id:this.getNextClientAnnotationId(),source:m.id,revId:C,body:t,contextId:T})}const v=[];return g.length>0&&v.push(new re.Xr({parentPath:n,items:g,parentRevId:C})),d.length>0&&v.push(new re.fZ({parentPath:n,items:d,parentRevId:C})),new _.B_({annotationType:c,ops:v})})();I?(p&&p.immediate?o.onAnnotationResults(I,et.LocalWorkflow,(()=>{})):d.push(I),(w==ut.hD.getTypeName()||w==ut.SB.getTypeName()||f.h.matchesTypesFor(A.body,[ut.yo.getTypeName(),ut.I3.getTypeName()]))&&o.submitOperationsToSession(I.ops),i.tG.info(509644822,i.nh.CoreDefault,h.stop())):i.tG.info(509644823,i.nh.CoreDefault,h.stop())},submitSignals:e=>{if(a===tt.External)return void u(S("NYI"));const t=new n.I({operationName:"submitSignalsAction",resourceId:m.id,success:!0}).setClientMetadata(o.getClientMetadata());for(const s of e){const e=f.h.getTypeNameFor(s);f.h.matchesTypesFor(s,[gt.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${f.h.getTypeNameFor(s)})`,i.tG.info(521413954,i.nh.CoreDefault,t)),m.outputTypes&&-1!==m.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${m.outputTypes}] but instead output ${e}`,i.tG.info(521413953,i.nh.CoreDefault,t)),s.timestamp&&(Mt.logTimestampUsageByWorkflowId.has(m.id)||(Mt.logTimestampUsageByWorkflowId.add(m.id),t.resultDescription=`Workflow "${m.id}" sets signal.timeStamp`,i.tG.info(509212803,i.nh.CoreDefault,t)))}const s=e.map((e=>({id:this.getNextClientSignalId(),source:m.id,revId:C,body:e,contextId:T}))),r=new re.g0({parentPath:["session"],parentRevId:C,items:s});o.submitOperations([r])},done:w,overrideWorkflowDefinition:(e,s,n)=>{let r;switch(n){case ht.T.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw i.tG.error(527472289,i.nh.CoreDefault,e),new Error(e)}r=t.contextId;break;case ht.T.Session:r=void 0;break;default:{const e="Defined scope is not supported. "+n;throw i.tG.error(527472290,i.nh.CoreDefault,e),new Error(e)}}const a=new oe.Qr({definition:s,contextId:r,sourceWorkflowId:m.id,targetWorkflowId:e});o.onWorkflowDefinitionOverrideMessage(a)},getDynamicAnnotations:void 0,setBillingDomain:void 0},N=e.workflowLambda;if(m.kind===de.wC.SingleItem){1!==s.length&&w(new Error("Single item workflows expect a single input")),A.delta=s[0].delta,A.deltas=s[0].deltas;try{const t=N;e.initPromise||(e.initPromise=t.init(this.site,A)),e.initPromise.then((()=>{t.execute(s[0].body,A,I)})).catch((e=>{S(e)}))}catch(e){S(e)}}else if(m.kind===de.wC.Join){0===s.length&&w(new Error("Join workflows expect an inputs array")),A.delta=t.delta,A.deltas=t.deltas;try{const o=N;e.initPromise||(e.initPromise=o.init(this.site,A)),e.initPromise.then((()=>{o.execute(t.body,s.map((e=>e.body)),A,I)})).catch((e=>{S(e)}))}catch(e){S(e)}}else S(`Workflow kind ${m.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,s,o){var r,a;const c=Date.now(),l={session:e,workflowImplementation:t,scopeItem:s,startTime:c,minTime:c+(0,N.ZF)(t.workflow.minDelayMs,1e3),maxTime:c+(0,N.ZF)(t.workflow.maxDelayMs,5e3),orchestrationMode:o},u=t.workflow.kind===de.wC.Join?s.contextId:l.scopeItem.parentPath.concat(s.id).join("\\");this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map);if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(u)){const o=new n.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(a=null==s?void 0:s.contextId)&&void 0!==a?a:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();i.tG.info(509727899,i.nh.CoreDefault,o.stop())}else{const o=new n.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(r=null==s?void 0:s.contextId)&&void 0!==r?r:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();i.tG.info(539883075,i.nh.CoreDefault,o.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(u,l)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const s=new Set(Array.from(this.sweepTimers.keys()));for(const[o,r]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[a,c]of Array.from(r.entries())){const{session:r,workflowImplementation:{workflow:l},orchestrationMode:u}=c,p=r.getWorkflowItemStorage(),g=new n.I({operationName:"LocalScopeExecutionNotification",resourceId:l.id,joinContextId:null!==(t=null===(e=c.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(r.getClientMetadata()).start(),h=()=>{if(l.kind===de.wC.Join){const e=Date.now(),{workflow:t}=c.workflowImplementation,s=c.scopeItem.contextId,o=r.getWorkflowDefinition(t,s).maxDelayMs;return p.isWorkflowReady(s,t)?(g.resultDescription=`Join Workflow: ${t.id} queuing by maxAnnotation, contextId: ${s}`,i.tG.info(528048978,i.nh.CoreDefault,g.stop()),{isValid:!0,triggerReason:kt.JoinMaxAnnnotation}):c.startTime+o<e?(g.resultDescription=`Join Workflow: ${t.id} queuing by maxTimeout, contextId: ${s}`,i.tG.info(528048979,i.nh.CoreDefault,g.stop()),{isValid:!0,triggerReason:kt.JoinMaxTimeout}):this.isReadyToEarlyJoin(this.executionTrackersByWorkflowNameBySession.get(r).get(t.id),s,r.getClientMetadata())?(i.tG.info(512550856,i.nh.CoreDefault,`Workflow: ${t.id} queuing by early completion, contextId: ${s}, timeout: ${o}`),{isValid:!0,triggerReason:kt.JoinEarlyCompletion}):{isValid:!1,triggerReason:kt.Unknown}}return{isValid:!0,triggerReason:kt.Unknown}};(()=>{const{isValid:e,triggerReason:t}=h();if(!e)return!1;const[s,o]=r.resolveRequestedContexts(l);if(!s)return!1;try{if(l.kind===de.wC.Join){const e=c.scopeItem.contextId,s=p.getScopeItem(e,l);if(s){const n=p.getItemsToExecute(s.contextId,l);if(0===n.length)return g.resultDescription=`Failed to retrieve items for workflow: ${l.id}, contextId: ${e}, skipping execution`,i.tG.info(527472291,i.nh.CoreDefault,g.stop()),this.onWorkflowExecuted(s,l,r),!0;this.queueWorkflow({workflowInfo:c.workflowImplementation,scopeItem:s,inputItems:n,requestedContexts:o,session:r,orchestrationMode:u,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,s,l,r)}).catch((e=>{g.success=!1,g.resultDescription=e.message,i.tG.error(509092189,i.nh.CoreDefault,g.stop())}))}else g.resultDescription="ContextId no longer exists, skipping workflow execution",i.tG.info(539883076,i.nh.CoreDefault,g.stop())}else g.resultDescription=`Workflow in type ${l.kind} is not supported`,i.tG.error(539883077,i.nh.CoreDefault,g.stop())}catch(e){g.resultDescription=`Trying to execute ${l.id} caused an exception: ${e}`,i.tG.warn(539883078,i.nh.CoreDefault,g.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(o).delete(a),0===this.pendingScopeExecutionNotificationsByWorkflow.get(o).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(o)):s.delete(r)}if(0!==s.size)for(const e of Array.from(s)){const t=new n.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();i.tG.debug(539883079,i.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,s){const o={id:"",parentPath:[],contextId:e},n={id:t};this.onWorkflowExecuted(o,n,s,!1)}onWorkflowExecuted(e,t,s,o=!0){var n;null===(n=this.executionTrackersByWorkflowNameBySession.get(s).get(t.id))||void 0===n||n.afterWorkflowExecution(e.contextId),o&&t.kind===de.wC.Join&&s.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}class Et{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,s)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=Et.Rejected,void s(t)}this.prevSeq=-1}e!=this.prevSeq+1&&i.tG.warn(542712385,i.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const o={seq:e,resolve:t};this.insertItem(o),this.runInOrder(o,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,s=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(s?(s.prev=e,e.next=s):this.lastQueueItem=e);s=t,t=t.prev}while(t);s&&(s.prev=e),e.next=s,this.firstQueueItem=e}runInOrder(e,t,s){let o=this.prevSeq,n=!1;const i=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(o+1!=t.seq&&(!s||t.seq>e.seq))break;o=t.seq,t.timeout&&clearTimeout(t.timeout),i.push(t),e==t&&(n=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}i.length>0&&setTimeout((()=>{for(const e of i)e.resolve(e.seq)}),0),this.prevSeq=o,!n&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}Et.Rejected="SequenceItemRejected";class Lt{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new Et(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}var Pt=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};class Bt{constructor(e=500,t){this.sequencerFactory=null!=t?t:new Lt(e)}sequence(e){var t;return Pt(this,void 0,void 0,(function*(){const s=null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq;if(null==s)return;const o=this.sequencerFactory.create(e);o&&(yield o.sequence(e.M_.seq))}))}}class Dt{constructor(e){this.annotationSequencer=null!=e?e:new Bt}process(e,t,s,o){const n=[];for(const o of e.ops){const i=[];if(null==o?void 0:o.items)for(const e of o.items){const s=this.annotationSequencer.sequence(e.body).then((()=>{t(o,e)}));i.push(s)}n.push(Promise.all(i).then((()=>{s(o,e.cv)})))}Promise.all(n).then((()=>o(e)))}}class Rt{process(e,t,s,o){for(const o of e.ops){if(null==o?void 0:o.items)for(const e of o.items)t(o,e);s(o,e.cv)}o(e)}}class Ot{constructor(e,t,s){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new Dt,this.unorderedAnnotationResultsProcessor=null!=s?s:new Rt}process(e,t,s,o){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,s,o):this.unorderedAnnotationResultsProcessor.process(e,t,s,o)}}var xt=function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};class Ft{constructor(e,t){this.changeGatesInitialized=!1,this.hostCallbacks=e,this.changeGateMap=t||new Map}init(){return xt(this,void 0,void 0,(function*(){const e=[];this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled&&this.changeGateMap.forEach(((t,s)=>{e.push(this.hostCallbacks.isChangeGateEnabled(s).then((e=>{this.changeGateMap.set(s,e)})))})),yield Promise.all(e).then((()=>{this.changeGatesInitialized=!0})).catch((e=>{}))}))}isFeatureEnabled(e,t=!1,s="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled(e,s).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){return xt(this,void 0,void 0,(function*(){return!this.changeGateMap||(this.changeGatesInitialized&&this.changeGateMap.has(e)?this.changeGateMap.get(e):!(!this.changeGatesInitialized&&this.hostCallbacks)||(yield this.hostCallbacks.isChangeGateEnabled(e)))}))}isChangeGatesInitialized(){return this.changeGatesInitialized}getChangeGateMap(){return this.changeGateMap}}const Gt=()=>s(62174).r;class Wt{constructor(e,t,s){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.changeGateList=new Map([["SkipCheckingCachedClaimsChallenge",!0],["LogRetryMessageEvent",!0],["ImproveClientRetries",!0]]),this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,checkIdbByFeatures:!0,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,httpFallbackEnabled:!0,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,dynamicRateControllerEnabled:!1,removeDuplicateFlights:!0,delayBeforeSocketClose:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,startQueueProcessingInOpen:!0,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:!1,sendTokenFailureMessage:!0},this.isDownloaderCompatible=()=>{if(this.settings.checkIdbByFeatures)return"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL;if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;return!(!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0)}return!1},this.workerFactory=e||(e=>e&&e===te.HttpFallback?new z:new p);const o=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||o(...e),this.sessionFactory=s||(e=>new nt(e))}init(e,t,s,a){var c,l,u,p,g,h,d,m,y,f,T;const _=new n.I({operationName:"InitRuntime",resourceId:(0,r.k$)(e),dimension1:this.hasBeenInitialized.toString()});_.start(),this.hasBeenInitialized=!0,this.hostCallbacks=s,this.gateUtils=new Ft(this.hostCallbacks,this.changeGateList),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Gt()),this.telemetryLogger=new r.MP(this.hostCallbacks),this.shouldAddLogger(_)?(i.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(a)):(i.tG.clearLoggers(),i.tG.addLogger(this.telemetryLogger)),Wt.haveCalledInit=!0,this.annotationResultsProcessor=new Ot((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=a.inferenceServiceFactory,_.dimension2=(0,i.OD)(o.q.info).toString();const C=[];e&&(this.defaultServiceUrl=N.Aq.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),C.push(this.gateUtils.init()),C.push(N.Aq.isChangeGateEnabled(this.hostCallbacks,"CheckIdbByFeatures").then((e=>{this.settings.checkIdbByFeatures=e}))),C.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),C.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),C.push(this.isFeatureEnabled("HttpFallbackDisabled").then((e=>{var t;(t=this.settings).httpFallbackEnabled&&(t.httpFallbackEnabled=!e)}))),C.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),C.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),C.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),C.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),C.push(this.isFeatureEnabled("DynamicRateControllerEnabled").then((e=>{this.settings.dynamicRateControllerEnabled=e}))),C.push(N.Aq.isChangeGateEnabled(this.hostCallbacks,"DelayBeforeSocketClose").then((e=>{this.settings.delayBeforeSocketClose=e}))),C.push(N.Aq.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),C.push(N.Aq.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),C.push(N.Aq.isChangeGateEnabled(this.hostCallbacks,"StartQueueProcessingInOpen").then((e=>{var t;(t=this.settings).startQueueProcessingInOpen||(t.startQueueProcessingInOpen=e)}))),C.push(this.isFeatureEnabled("MaxNumberOfDeltaUpdateOpsPerItemPerBatch").then((e=>{var t;(t=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(t.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e)}))),C.push(N.Aq.isChangeGateEnabled(this.hostCallbacks,"SendTokenFailureMessage").then((e=>{this.settings.sendTokenFailureMessage=e})));const v={enableDeltas:!1,enableEarlyJoin:!1};C.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>v.enableDeltas=e)).catch((()=>v.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>v.enableEarlyJoin=e)).catch((()=>v.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new Mt(a.modelDownloader&&this.isDownloaderCompatible()?a.modelDownloader:void 0,this.inferenceServiceFactory,v)})));const S=wt(null!==(c=t.flights)&&void 0!==c?c:"");return this.isDeltaGeneratorEnabled=S.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(l=a.isDeltaGeneratorEnabled)&&void 0!==l&&l),this.disableSyncDeltaSending=S.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(u=a.disableSyncDeltaSending)&&void 0!==u&&u),this.syncDeltaTimeout=S.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",a.syncDeltaTimeout),(p=this.settings).httpFallbackEnabled&&(p.httpFallbackEnabled=!S.getBooleanValue("HttpFallbackDisabled",!1)),(g=this.settings).defaultBatchingEnabled&&(g.defaultBatchingEnabled=!S.getBooleanValue("DefaultBatchingDisabled",!1)),(h=this.settings).batchingWith20msIntervalEnabled&&(h.batchingWith20msIntervalEnabled=!S.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(d=this.settings).reduceBatchOperationsEnabled||(d.reduceBatchOperationsEnabled=S.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(m=this.settings).batchMessagesEnabled||(m.batchMessagesEnabled=S.getBooleanValue("BatchMessagesEnabled",!1)),(y=this.settings).removeDuplicateFlights&&(y.removeDuplicateFlights=S.getBooleanValue("RemoveDuplicateFlights",!0)),(f=this.settings).reducedPingPongRetryEnabled||(f.reducedPingPongRetryEnabled=S.getBooleanValue("ReducedPingPongRetryEnabled",!1)),(T=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(T.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=S.getBooleanValue("maxNumberOfDeltaUpdateOpsPerItemPerBatch",!1)),_.setDataField("Flights",JSON.stringify(this.settings)),a&&a.loggableUrls&&(0,r.sI)(a.loggableUrls),Promise.all(C).then((()=>{this.batchOptions=a.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),a&&a.networkMode&&(a.networkMode===te.HttpFallback&&(a.networkMode=this.settings.httpFallbackEnabled?te.HttpFallback:te.JSWebSockets),this.networkMode=a.networkMode,a.networkMode===te.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new Je)),_.dimension0=JSON.stringify(this.batchOptions),this.logOperation(_,!0)})).catch((e=>{this.logOperation(_,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){i.tG.flushAggregators(e)}createSession(e){var t;const s=e&&e.docSessionId?e.docSessionId:(0,ze.v4)(),o=e&&e.documentId?e.documentId:void 0,i=this.sessionsByDocSessionId.get(s),r=new n.I({operationName:"CreateSession",resourceId:s,dimension1:this.hasBeenInitialized.toString()});if(r.start(),i&&!1===i.isClosed)throw this.logOperation(r,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let a=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;a=N.Aq.convertServiceUrlToWebSocket(a),a||((e=e||{}).networkMode=te.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==te.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=te.HttpFallback),e&&e.networkMode===te.HttpFallback&&(e.networkMode=this.settings.httpFallbackEnabled?te.HttpFallback:te.JSWebSockets);const c=Object.assign({},this.clientMetadata);c.docSessionId=s,o&&(c.documentId=o),e&&e.flights&&(c.flights=c.flights?c.flights+";"+e.flights:e.flights),this.settings.removeDuplicateFlights&&c.flights&&(c.flights=function(e){if(!e)return"";const t=new Set,s=[];for(const o of e.split(";").reverse()){const e=o.split(":")[0],n=It.normalizeName(e);t.has(n)||(t.add(n),s.push(o))}return s.reverse().join(";")}(c.flights)),r.setDataField("Flights",c.flights||"");const l=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(c,a,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:c,userContext:e?e.userContext:void 0,localWorkflowManager:e&&e.enableComplexLocalWorkflows?void 0:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:this.settings.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled,gateUtils:this.gateUtils});return this.sessionsByDocSessionId.set(s,l),e&&(e.onSessionConnect&&l.setConnectCallback(e.onSessionConnect),e.onSessionDisconnect&&l.setDisconnectCallback(e.onSessionDisconnect),e.onSessionReconnect&&l.setReconnectCallback(e.onSessionReconnect),e.onSessionClose&&l.setSessionCloseCallback(e.onSessionClose),e.onServerAuthenticationStateChangeCallback&&l.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e.onClaimsChallengeCallback&&l.setClaimsChallengeCallback(e.onClaimsChallengeCallback),e.onSeedingStatusChangeCallback&&l.setSeedingStatusChangeCallback(e.onSeedingStatusChangeCallback)),this.logOperation(r,!0),l.initialize?l.initialize():Promise.resolve(l)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(Wt.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,i.OD)(o.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,s)=>{if(s&&s.enableComplexLocalWorkflows)throw new Error("NYI");if(s&&s.networkMode==te.LocalWorkflowsOnly)return new Je;const o=new at,n=new it;let r=()=>{i.tG.error(573321615,i.nh.CoreDefault,"Unexpectedly not set sendMessage")};const a=new lt((()=>n),e,o,((e,t,s)=>{r(e,t,s)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==s?void 0:s.enableRemoteExecutionNotification)||!1,sendTokenFailureMessageChangeGate:this.settings.sendTokenFailureMessage}),c=new ne(N.Aq.convertServiceUrlToWebSocket(t),n,this.workerFactory,a,e,o,this.settings,this.gateUtils,null==s?void 0:s.networkMode);return r=c.sendMessage.bind(c),c.on("disconnect",(()=>o.clearRefreshTimeouts())),c.on("connect",((e,t,s,o)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,s,o);const n=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(n)})),c}}isFeatureEnabled(e,t=!1,s="None"){return N.Aq.isFeatureEnabled(this.hostCallbacks,e,t,s)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,s,o){e.stop(),e.success=t,e.resultSignature=s,e.resultDescription=o,i.tG.info(573321622,i.nh.CoreDefault,e)}addLoggingAggregator(e){var t,s,o,n;N.Aq.isChangeGateEnabled(this.hostCallbacks,"AggregateInProductionOnly")&&"Dogfood"===this.clientMetadata.releaseAudienceGroup||(i.tG.addAggregator((0,r.cS)("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet","NetworkRateControllerQueueItem"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),i.tG.addAggregator((0,r.cS)("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(s=e.telemetryAggregationIntervalSec)&&void 0!==s?s:60)),i.tG.addAggregator((0,r.cS)("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:120)),i.tG.addAggregator((0,r.cS)("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)))}uninitialize(){this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,Wt.haveCalledInit=!1,i.tG.clearAggregators(),i.tG.clearLoggers()}}const Ht=new Wt,Ut=()=>new Wt},59891:(e,t,s)=>{s.d(t,{MP:()=>u,cS:()=>a,k$:()=>l,sI:()=>c});var o=s(93364),n=s(30157),i=s(81768);const r=["cloud-dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],a=(e,t,s,o)=>new i.D(e,(e=>e.success&&s.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],o),c=e=>{r.push(...e)},l=e=>{if(!e)return e;for(const t of r)if(e.indexOf(t)>=0)return e;return"**redacted**"};class u{constructor(e){this.level=o.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,s,o,i)=>{let r=t.charAt(0).toUpperCase()+t.slice(1),a={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};s&&(a=Object.assign(Object.assign({},a),JSON.parse(s)));const c=o||u.augLoopAriaTenantToken,l=i||c!=u.augLoopAriaTenantToken?i:u.augLoopAriaNamespace;r=r||u.operationNamePlaceholder;const p={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(c,l?`${l}_${r}`:r,a,"Office.System.Activity",p,!1,n.b.ProductServiceUsage|n.b.ProductServicePerformance,n.E.RequiredServiceDataEvent)},s=(e,t,s)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,s)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const s=e;t(s,s.operationName,s.dataFields,void 0,s.ariaNamespace)}else if("SessionHealth"===e.eventName){t(e,e.sessionHealthEventName)}else if("WorkflowOperation"===e.eventName){const s=e;t(s,s.operationName,s.dataFields,s.ariaTenant,s.ariaNamespace)}else"Log"===e.eventName&&s(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}u.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",u.augLoopAriaNamespace="Office_AugLoop_Client",u.operationNamePlaceholder="OperationNameNotProvided"},27560:(e,t,s)=>{s.d(t,{Aq:()=>g,MY:()=>m,ZF:()=>y,yq:()=>h,zX:()=>f});var o=s(25765),n=s(89700),i=s(56216),r=s(82076),a=s(39551),c=s(92100),l=s(70825),u=s(97288),p=s.n(u);class g{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:i.v.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.v.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,s=!1,o="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,o).catch((()=>Promise.resolve(s))):Promise.resolve(s)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const s=e.split(":");let o=s[0].toLowerCase();return 0==o.indexOf(t?"http":"ws")?(o=t?o.replace("http","ws"):o.replace("ws","http"),s[0]=o,s.join(":")):e}static deepEquals(e,t){return p()(e,t)}static collectTelemetry(e,t,s,n,i,r){var a,c,l,u;e.start(),e.resultSignature=null!=n?n:"",e.resultDescription=null!=i?i:"",e.success=s,r?(e.dimension0=null!==(a=r[0])&&void 0!==a?a:"",e.dimension1=null!==(c=r[1])&&void 0!==c?c:"",e.dimension2=null!==(l=r[2])&&void 0!==l?l:"",e.dimension3=null!==(u=r[3])&&void 0!==u?u:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>o.tG.info(508367457,o.nh.CoreDefault,e.stop())))}}g.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class h{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new n.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});o.tG.warn(572838107,o.nh.CoreDefault,e)}}}const d=[r.h.getTypeName(),a.YH.getTypeName(),c.HN.getTypeName()],m=e=>{const t=new Set;for(const s of e)if("string"==typeof s)-1===d.indexOf(s)&&t.add(s);else for(const e of[s.getTypeName(),...s.getBaseTypes()])-1===d.indexOf(e)&&t.add(e);return Array.from(t)},y=(e,t=0)=>Number.isFinite(e)?e:t,f=(e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(l.xU.typeGuard(e)||l.XP.typeGuard(e))return!0;for(const s of e.items)if(!s.body||r.h.matchesTypesFor(s.body,t))return!0;return!1}},24205:(e,t,s)=>{s.d(t,{a:()=>i});var o=s(42713),n=s(27560);class i{constructor(e,t){var s,n,i,r,a;this.kind=o.wC.Join,this.isStateful=!1,this.maxDelayMs=1e3,this.maxAnnotations=1,this.allowDefinitionOverride=!1,this.id=e,t&&(this.inputTypes=null!==(s=t.inputTypes)&&void 0!==s?s:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(i=t.isStateful)&&void 0!==i?i:this.isStateful,this.maxDelayMs=null!==(r=t.maxDelayMs)&&void 0!==r?r:this.maxDelayMs,this.requestedContextTypesRules=null!==(a=t.requestedContextTypesRules)&&void 0!==a?a:this.requestedContextTypesRules)}static create(e){return new i(e)}setCollectionScopeType(e){return this.collectionScopeType=e,this}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setMaxDelayTime(e){return this.maxDelayMs=e?Math.max(0,e):void 0,this}setMaxAnnotations(e){return this.maxAnnotations=e,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setAllowDefinitionOverride(){return this.allowDefinitionOverride=!0,this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},73449:(e,t,s)=>{s.d(t,{z:()=>i});var o=s(42713),n=s(27560);class i{constructor(e,t){var s,n,i,r,a,c;this.kind=o.wC.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(s=t.inputTypes)&&void 0!==s?s:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(i=t.isStateful)&&void 0!==i?i:this.isStateful,this.requestedContextTypesRules=null!==(r=t.requestedContextTypesRules)&&void 0!==r?r:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(a=t.definitionOverrideTargetWorkflows)&&void 0!==a?a:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(c=t.correlatedSignals)||void 0===c?void 0:c.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new i(e)}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},71531:(e,t,s)=>{var o,n,i;s.d(t,{OY:()=>n,Pu:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(o||(o={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(i||(i={}))},77827:(e,t,s)=>{var o,n;s.d(t,{G:()=>o,K:()=>n}),function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(n||(n={}))},56216:(e,t,s)=>{var o;s.d(t,{v:()=>o}),function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(o||(o={}))},94727:(e,t,s)=>{s.d(t,{Et:()=>n,Qr:()=>h,rK:()=>m,x5:()=>d});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowCancellationRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()}},48513:(e,t,s)=>{var o;s.d(t,{f:()=>o}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(o||(o={}))},60990:(e,t,s)=>{s.d(t,{Td:()=>i,U8:()=>a,i2:()=>c,og:()=>r,tj:()=>n,wR:()=>l});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetClaimsChallengeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireClaimsChallengeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetSeedingStatusChangeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireSeedingStatusChangeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_InteractiveAuthMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsResponseBridgeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},72062:(e,t,s)=>{s.d(t,{$j:()=>I,B_:()=>R,D0:()=>x,F_:()=>g,GA:()=>N,Gs:()=>U,LQ:()=>y,Ol:()=>k,PR:()=>G,PY:()=>w,Qq:()=>b,Sy:()=>te,TV:()=>W,Tb:()=>L,VR:()=>P,YK:()=>i,Yp:()=>a,Zy:()=>T,_p:()=>p,eE:()=>d,eG:()=>Y,fZ:()=>B,fr:()=>q,g$:()=>X,gy:()=>J,i:()=>r,kd:()=>O,l0:()=>E,lj:()=>Z,n4:()=>A,ru:()=>h,ry:()=>f,uN:()=>m,vG:()=>K,w9:()=>C,wU:()=>ee,z_:()=>v});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class w{constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class I{constructor(e){o.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class N{constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class k{constructor(e){o.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class M{constructor(e){o.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class E{constructor(e){o.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class L{constructor(e){o.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class P{constructor(e){o.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class B{constructor(e){o.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(e){o.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class R{constructor(e){o.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class O{constructor(e){o.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class x{constructor(e){o.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class F{constructor(e){o.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class G{constructor(e){o.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class W{constructor(e){o.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class H{constructor(e){o.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class U{constructor(e){o.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class q{constructor(e){o.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SeedingStatusChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class V{constructor(e){o.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class ${constructor(e){o.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class j{constructor(e){o.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class z{constructor(e){o.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class Q{constructor(e){o.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class K{constructor(e){o.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class J{constructor(e){o.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Y{constructor(e){o.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class Z{constructor(e){o.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class X{constructor(e){o.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{constructor(e){o.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{constructor(e){o.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class se{constructor(e){o.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BlobUploadResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class oe{constructor(e){o.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ne{constructor(e){o.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()}},36835:(e,t,s)=>{s.d(t,{K7:()=>l,PO:()=>a,Qn:()=>n,e9:()=>u,mH:()=>o,xv:()=>r,zy:()=>i});const o=2;var n,i,r,a,c,l,u;!function(e){e[e.ServerError=0]="ServerError",e[e.WorkflowDisabled=100]="WorkflowDisabled",e[e.TokenNotReady=101]="TokenNotReady",e[e.FlightNotReady=102]="FlightNotReady",e[e.ContextNotReady=103]="ContextNotReady",e[e.WorkflowExcluded=104]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=105]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=106]="LambdaExecutionError",e[e.UnexpectedOutput=107]="UnexpectedOutput"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.UnprocessableContent=422]="UnprocessableContent",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.SyncMessageTooManyDeltaOperations=2012]="SyncMessageTooManyDeltaOperations",e[e.SyncMessageSessionSizeLimitExceeded=2013]="SyncMessageSessionSizeLimitExceeded",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(r||(r={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(a||(a={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(c||(c={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(l||(l={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Incomplete=2]="Incomplete",e[e.Finished=3]="Finished"}(u||(u={}))},50090:(e,t,s)=>{s.d(t,{I:()=>l});var o=s(97288),n=s.n(o),i=s(25765);class r{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}class a extends r{constructor(e){super(),this.name=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new a(e);const s=a.tryGetConfigProperty(a.currentConfig,e);s.success&&t.updateValue(s.value),this.allSettings.set(e,t)}return t}static setEcsRequestor(e){a.ecsRequestor=e}static getInstanceWithUserId(e,t,s){return a.ecsRequestor?a.ecsRequestor.getECSConfig(t,e,s):(i.tG.info(506228882,i.nh.CoreDefault,"ECS Requestor is not initialized"),Promise.resolve(s))}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new a(e)};const s=a.tryGetConfigPropertyByPattern(a.currentConfig,t.regex);t.setting.updateValue(s),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){a.currentConfig=e,i.tG.info(572837966,i.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),a.allSettings.forEach(((e,t)=>{const s=a.tryGetConfigProperty(a.currentConfig,t).value;e.updateValue(s)&&(i.tG.info(572837967,i.nh.CoreDefault,`Setting new value for ${t}: ${s instanceof Object?JSON.stringify(s):s}`),e.notifyListeners(s))})),a.allPatternSettings.forEach(((t,s)=>{const o=a.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(o)&&(i.tG.info(508432774,i.nh.CoreDefault,`Setting new value for pattern ${s}: ${JSON.stringify(o)}`),t.setting.notifyListeners(o))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:a.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const s=[];if(e){const o=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of o)s.push({name:t,value:a.selectApplicableValue(e[t])})}return s}static setGlobalFilter(e){a.globalFilter=e}static clear(){a.currentConfig=void 0,a.allSettings.clear(),a.allPatternSettings.clear()}static selectApplicableValue(e){let t;if(e){const s=e.find((e=>!a.globalFilter||a.globalFilter(e)));s&&(t=s.value)}return t}getName(){return this.name}getValue(){if(void 0!==globalThis.process&&"true"===(null===(t=null===(e=globalThis.process)||void 0===e?void 0:e.env)||void 0===t?void 0:t.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)&&0===this.listeners.size){const e=new Error("getValue() has been invoked incorrectly for ModuleSettings. Make sure getValue() is called during runtime or there is a listener set up on the setting.");throw e.name="Incorrect usage of getValue()",e}var e,t;return this.value}updateValue(e){return!n()(this.value,e)&&(i.tG.info(572837968,i.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}}a.allSettings=new Map,a.allPatternSettings=new Map;const c=new class extends r{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=a.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueWithUserId(e){return a.getInstanceWithUserId(this.setting.getName(),e,this.defaultValue)}}("disabledChangeGates",[]),l=(e,t,...s)=>{const o=-1===c.getValue().indexOf(e);return t?o?t(...s):void 0:o}},1427:(e,t,s)=>{s.d(t,{l:()=>o});class o{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){o.logIntervalError=e}put(e,t,s,o,n,i,r){if(null==s||s<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const a={value:t,lastUsed:n?Date.now():void 0,expire:s+Date.now(),idleDurationMs:n,expireCallback:o,expiringTriggerTime:i+Date.now(),expiringCallback:r};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,s)=>{e(t.value,s)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,s)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(s),void(this.options.idleCallback&&this.options.idleCallback(s,t.value));t.expire<e&&(this.del(s),t.expireCallback&&t.expireCallback(s,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(s,t.value),t.expiringCallback=void 0)}catch(e){o.logIntervalError&&o.logIntervalError(e)}}))}}},343:(e,t,s)=>{s.d(t,{L:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}())},32206:(e,t,s)=>{s.d(t,{O:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.operationName="",e.prototype.key="",e.prototype.value="",e.prototype.buildVersion="",e.prototype.datafield0="",e.prototype.datafield1="",e.prototype.datafield2="",e.prototype.datafield3="",e.prototype.tagId=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnonymizedOperationEvent"},e}())},3834:(e,t,s)=>{s.d(t,{F:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpRequestQueueEvent"},e}())},4797:(e,t,s)=>{s.d(t,{k:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpSocketListEvent"},e}())},24726:(e,t,s)=>{s.r(t),s.d(t,{AnnotationMetaDataChangeEvent:()=>h.L,AnonymizedOperationEvent:()=>C.O,CircuitBreakerStateChangeEvent:()=>g,HttpRequestQueueEvent:()=>c.F,HttpSocketListEvent:()=>u.k,OperationEvent:()=>o.A,OutboundHttpRequestEvent:()=>l.g,PrivacyGuardIssueEvent:()=>v.F,ProcessIdentificationEvent:()=>r.m,ScenarioStatsEvent:()=>_.A,SessionHealthEvent:()=>y.R,SessionHealthEventAggregation:()=>f.Z,SessionIssueEvent:()=>T.Q,SessionStatsEvent:()=>m,WebSocketConnectionEndEvent:()=>a.D,WorkflowOperationEvent:()=>i});var o=s(70529),n={util:{},roots:{default:{}}},i=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.workflow="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WorkflowOperationEvent"},e}()),r=s(46578),a=s(4694),c=s(3834),l=s(86707),u=s(4797),p={util:{},roots:{default:{}}},g=(p.util,p.roots.default||(p.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.group="",e.prototype.name="",e.prototype.state=0,e.prototype.failurePercent=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/CircuitBreakerStateChangeEvent"},e}()),h=s(343),d={util:{},roots:{default:{}}},m=(d.util,d.roots.default||(d.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.healthy=!1,e.prototype.fullLogs=!1,e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientSessionId="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.isClientTelemetrySampled=!1,e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userOid="",e.prototype.protocolVersion=0,e.prototype.totalDurationMs=0,e.prototype.idleDurationMs=0,e.prototype.closeReason="",e.prototype.firstClientConnectionDurationMs=0,e.prototype.seedMode="",e.prototype.seedSuccess=!1,e.prototype.seedItems=0,e.prototype.seedMessageCount=0,e.prototype.seedBatchSize=0,e.prototype.seedGroupSize=0,e.prototype.seedDurationMs=0,e.prototype.sendMessageCount=0,e.prototype.sendMessageErrors=0,e.prototype.sendMessageWarnings=0,e.prototype.sendMessageDurationMsMax=0,e.prototype.processMessageCount=0,e.prototype.processMessageErrors=0,e.prototype.processMessageWarnings=0,e.prototype.processMessageDurationMsMax=0,e.prototype.syncMessageCount=0,e.prototype.syncMessagesOutOfSequence=0,e.prototype.syncMessagesAbandoned=0,e.prototype.syncMessagesIgnored=0,e.prototype.syncMessageQueueLimitReached=!1,e.prototype.modelItemsMax=0,e.prototype.modelSizeInKb=0,e.prototype.modelConsistencyErrors=0,e.prototype.modelItemsCountBucket="",e.prototype.modelConsistencyErrorsAndWarnings=0,e.prototype.modelConsistencyQuietStateValid=!1,e.prototype.modelConsistencyQuietStateWarnings=0,e.prototype.modelConsistencyQuietStateErrors=0,e.prototype.documentUrlAvailable=!1,e.prototype.documentUrlWasProvided=!1,e.prototype.workflowsRegistered=0,e.prototype.workflowExecutions=0,e.prototype.workflowExecutionErrors=0,e.prototype.workflowExecutionDurationMsMax=0,e.prototype.workflowExecutionInfraErrors=0,e.prototype.annotationTypesActivated=0,e.prototype.annotationsAdded=0,e.prototype.annotationsUpdated=0,e.prototype.annotationsDeleted=0,e.prototype.augLoopLowPrivilegeTokenExistenceStatus="",e.prototype.augLoopLowPrivilegeTokenFirstArrivalDurationMs=0,e.prototype.wacTokenProvisionTokenExistenceStatus="",e.prototype.wacTokenProvisionTokenFirstArrivalDurationMs=0,e.prototype.seedingWorkflowPerformanceTimesValid=!1,e.prototype.timeFromFirstSeedMessageToFirstWorkflowFinishedMs=0,e.prototype.timeFromFirstSeedMessageToFirstAnnotationMs=0,e.prototype.timeFromFirstSeedMessageToLastAnnotationMs=0,e.prototype.timeFromFirstSeedMessageToLastWorkflowFinishedMs=0,e.prototype.timeFromLastSeedMessageToLastAnnotationMs=0,e.prototype.timeFromLastSeedMessageToLastWorkflowFinishedMs=0,e.prototype.syncMessagesWorkflowPerformanceNotMeasured=0,e.prototype.timeToAllWorkflowsFinishedMsMax=0,e.prototype.timeFromSessionStartToLastWorkflowFinishedMs=0,e.prototype.healthBucket="",e.prototype.coreHealthBucket="",e.prototype.coreHealthReason="",e.prototype.coreHealthBucketWithSuppressions="",e.prototype.coreHealthReasonWithSuppressions="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.eventAnalysisFindings="",e.prototype.mappedHealthBucketsToReasons="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionStatsEvent"},e}()),y=s(46565),f=s(91102),T=s(34854),_=s(37264),C=s(32206),v=s(67772)},70529:(e,t,s)=>{s.d(t,{A:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}())},86707:(e,t,s)=>{s.d(t,{g:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.host="",e.prototype.statusCode=0,e.prototype.success=!1,e.prototype.wait=0,e.prototype.dns=0,e.prototype.tcp=0,e.prototype.firstByte=0,e.prototype.download=0,e.prototype.total=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OutboundHttpRequestEvent"},e}())},67772:(e,t,s)=>{s.d(t,{F:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.suspiciousLogTagId="",e.prototype.suspiciousStringIssues="",e.prototype.suspiciousStringValue="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/PrivacyGuardIssueEvent"},e}())},46578:(e,t,s)=>{s.d(t,{m:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Pid=0,e.prototype.ApplicationName="",e.prototype.ServiceName="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ProcessIdentificationEvent"},e}())},37264:(e,t,s)=>{s.d(t,{A:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.resourceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.scenarioHealthBucket="",e.prototype.scenarioHealthReason="",e.prototype.scenarioHealthBucketWithSuppressions="",e.prototype.scenarioHealthReasonWithSuppressions="",e.prototype.activationState="",e.prototype.modelItemsCountBucket="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ScenarioStatsEvent"},e}())},91102:(e,t,s)=>{s.d(t,{Z:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.sessionHealthEventName="",e.prototype.count=0,e.prototype.successes=0,e.prototype.failures=0,e.prototype.maxDurationMs=0,e.prototype.sumDurationMs=0,e.prototype.cancellations=0,e.prototype.failureBuckets="",e.prototype.firstFailureReason="",e.prototype.firstFailureImpact="",e.prototype.firstEventSource="",e.prototype.firstEventReason="",e.prototype.firstEventReasonDependency="",e.prototype.firstEventImpact="",e.prototype.firstEventSuccess=!1,e.prototype.firstEventDurationMs=0,e.prototype.firstEventCount=0,e.prototype.firstEventMessage="",e.prototype.firstEventAffectedWorkflows="",e.prototype.lastEventSource="",e.prototype.lastEventReason="",e.prototype.lastEventReasonDependency="",e.prototype.lastEventImpact="",e.prototype.lastEventSuccess=!1,e.prototype.lastEventDurationMs=0,e.prototype.lastEventCount=0,e.prototype.lastEventMessage="",e.prototype.lastEventAffectedWorkflows="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEventAggregation"},e}())},46565:(e,t,s)=>{s.d(t,{R:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}())},34854:(e,t,s)=>{s.d(t,{Q:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthSubreason="",e.prototype.summarizedFindings="",e.prototype.affectedResource="",e.prototype.affectedSessions="",e.prototype.suppressionReason="",e.prototype.modelItemsCountBucket="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionIssueEvent"},e}())},4694:(e,t,s)=>{s.d(t,{D:()=>n});var o={util:{},roots:{default:{}}},n=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.TerminationReason="",e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.TotalRequestCount=0,e.prototype.LifetimeSec=0,e.prototype.ClientApp="",e.prototype.ClientAppPlatform="",e.prototype.ClientAppVersion="",e.prototype.ClientReleaseAudienceGroup="",e.prototype.ClientSessionId="",e.prototype.ClusterId="",e.prototype.ConnectionSequenceId=0,e.prototype.CorrelationId="",e.prototype.UsageType="",e.prototype.MaxActiveRequestsCount=0,e.prototype.unexpectedTerminationNotSeenInSessionHealth=!1,e.prototype.webSocketCloseCode=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WebSocketConnectionEndEvent"},e}())},7880:(e,t,s)=>{s.d(t,{I:()=>c,MH:()=>a,Sy:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ActionAi_ActionAIAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ActionAi_ActionAIImageAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ActionAi_ActionAIDebugAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ActionAi_AdminControlAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ActionAi_ActionAIAcknowledgeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},26795:(e,t,s)=>{s.d(t,{l:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ActionAi_ActionAISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},72813:(e,t,s)=>{var o;s.d(t,{Z:()=>o}),function(e){e.CREATE="CREATE",e.RETURNINGUSER="RETURNINGUSER",e.NONE="NONE"}(o||(o={}))},80607:(e,t,s)=>{s.d(t,{xj:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_AgentProxyCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_ReviewSyncAgentProxyCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotOutputAnnotation","AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_AgentProxyCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_ReviewSyncAgentProxyCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},87396:(e,t,s)=>{s.d(t,{br:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_AgentProxyCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_ReviewSyncAgentProxyCopilotInputSignal"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotInputSignal","AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_AgentProxyCopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AgentCopilot_ReviewSyncAgentProxyCopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},27708:(e,t,s)=>{var o,n,i,r;s.d(t,{aq:()=>o}),function(e){e.CUSTOMCARD="CustomCard",e.CHATCARD="ChatCard",e.SUMMARYCARD="SummaryCard",e.SUGGESTIONCARD="SuggestionCard"}(o||(o={})),function(e){e[e.VARIABLE=0]="VARIABLE",e[e.CONFIG=1]="CONFIG"}(n||(n={})),function(e){e.Insert="Insert",e.Rewrite="Rewrite",e.Reply="Reply"}(i||(i={})),function(e){e.PROJECTS="PROJECTS",e.QUERIES="QUERIES"}(r||(r={}))},85314:(e,t,s)=>{s.d(t,{R8:()=>n,XV:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_AnswerContentQuestion_AnswerContentQuestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_AnswerContentQuestion_AnswerContentQuestionStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_AnswerContentQuestion_AnswerContentQuestionStreamCompletionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},11730:(e,t,s)=>{s.d(t,{q:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastResponse"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},30645:(e,t,s)=>{s.d(t,{B:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},43916:(e,t,s)=>{var o,n,i,r,a;s.d(t,{f9:()=>o}),function(e){e.Podcast="Podcast",e.Assistant="Assistant"}(o||(o={})),function(e){e.Script="script",e.Ssml="ssml",e.Audio="audio"}(n||(n={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILURE=1]="FAILURE"}(i||(i={})),function(e){e.EN_US="en-us"}(r||(r={})),function(e){e.professional="professional",e.casual="casual"}(a||(a={}))},63679:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Result=void 0,function(e){e.Success="Success",e.BlockedByQualityCheck="BlockedByQualityCheck",e.BlockedByLanguage="BlockedByLanguage",e.UnknownError="UnknownError"}(t.Result||(t.Result={}))},7702:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextAbstractiveSummaryAnnotation=void 0;const o=s(77412);class n{constructor(e){o.SchemaObject.assign(n,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_AzureTextAbstractiveSummarization_TextAbstractiveSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[n.getTypeName()])}}t.TextAbstractiveSummaryAnnotation=n,n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},99062:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenerateTextAbstractiveSummarySignal=void 0;const o=s(77412);class n{constructor(e){o.SchemaObject.assign(n,this,e)}static getTypeName(){return"AugLoop_AzureTextAbstractiveSummarization_GenerateTextAbstractiveSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[n.getTypeName()])}}t.GenerateTextAbstractiveSummarySignal=n,n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},60105:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(63679),t),n(s(87040),t),n(s(7702),t),n(s(99062),t)},87040:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},23091:(e,t,s)=>{s.d(t,{Z:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ByoAgent_BuildYourOwnAgentRuntimeAnnotation"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentRuntimeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ByoAgent_BuildYourOwnAgentProxyCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotOutputAnnotation","AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ByoAgent_BuildYourOwnAgentProxyChatHistoryOutputAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},65160:(e,t,s)=>{s.d(t,{tT:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ByoAgent_BuildYourOwnAgentProxyCopilotInputSignal"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotInputSignal","AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ByoAgent_BuildYourOwnAgentProxyCopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ByoAgent_BuildYourOwnAgentRuntimeSignal"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentRuntimeSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},48065:(e,t,s)=>{s.d(t,{P:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CipManipulate_CipManipulateAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},80334:(e,t,s)=>{s.d(t,{T:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CipManipulate_CipManipulateSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},31016:(e,t,s)=>{var o;s.d(t,{P:()=>o}),function(e){e.CipTree="CipTree",e.TopicTree="TopicTree",e.ContentTree="ContentTree",e.MergedCipTree="MergedCipTree"}(o||(o={}))},2105:(e,t,s)=>{s.d(t,{g:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ContentIntelligencePlatformEvaluation_SemanticTreeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},99174:(e,t,s)=>{s.d(t,{I:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ContentIntelligencePlatformEvaluation_ContentIntelligencePlatformEvaluationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},54329:(e,t,s)=>{var o;s.d(t,{Y:()=>o}),function(e){e[e.Connecting=0]="Connecting",e[e.Listening=1]="Listening",e[e.Thinking=2]="Thinking",e[e.Speaking=3]="Speaking",e[e.Error=4]="Error",e[e.Interrupted=5]="Interrupted",e[e.Disconnected=6]="Disconnected"}(o||(o={}))},97352:(e,t,s)=>{s.d(t,{Wd:()=>n});var o=s(82076),n=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oTranscript"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oProcessingEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_AudioCopilotAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}())},81023:(e,t,s)=>{s.d(t,{x:()=>n});var o=s(82076),n=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ConversationalTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ConversationalCopilot_AudioCopilotTile"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}())},70991:(e,t,s)=>{s.d(t,{CT:()=>n,Pd:()=>r,tP:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_SharedCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistoryErrorOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddMessageOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetAllChatsOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetCurrentChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesInCurrentChatSessionOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_RemoveAllMessagesFromCurrentChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_DeleteChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateMessageOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()}},46996:(e,t,s)=>{s.d(t,{T:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetCurrentChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetAllChatsOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesInCurrentChatSession"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_RemoveAllMessagesFromCurrectChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddMessageOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_DeleteChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateMessageOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},92301:(e,t,s)=>{var o,n,i,r,a,c,l;s.d(t,{CY:()=>r,Go:()=>c,S5:()=>n,gG:()=>i,nW:()=>a,z1:()=>o}),function(e){e.Document="Document",e.Enterprise="Enterprise"}(o||(o={})),function(e){e.GetCurrentChatOperation="GetCurrentChatOperation",e.GetAllChatsOperation="GetAllChatsOperation",e.GetChatOperation="GetChatOperation",e.AddChatOperation="AddChatOperation",e.AddMessageOperation="AddMessageOperation",e.GetMessagesOperation="GetMessagesOperation",e.GetMessagesInCurrentChatSession="GetMessagesInCurrentChatSession",e.RemoveAllMessagesFromCurrentChatOperation="RemoveAllMessagesFromCurrectChatOperation",e.DeleteChatOperation="DeleteChatOperation",e.UpdateMessageOperation="UpdateMessageOperation",e.UpdateChatOperation="UpdateChatOperation"}(n||(n={})),function(e){e.User="User",e.Copilot="Copilot",e.System="System"}(i||(i={})),function(e){e.Canvas="Canvas",e.Pane="Pane"}(r||(r={})),function(e){e.Success="Success",e.Failure="Failure"}(a||(a={})),function(e){e.PlainText="PlainText",e.RichText="RichText",e.AdaptiveCard="AdaptiveCard"}(c||(c={})),function(e){e.AIResponse="AIResponse",e.ContentCreation="ContentCreation"}(l||(l={}))},81429:(e,t,s)=>{s.d(t,{TR:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUIAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_SetTUIEverShownStateOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_GetTUIEverShownStateOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},40002:(e,t,s)=>{s.d(t,{kZ:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_GetTUIEverShownStateOperation"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_SetTUIEverShownStateOperation"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},62635:(e,t,s)=>{var o,n;s.d(t,{H:()=>o,n:()=>n}),function(e){e.GetTUIEverShownState="GetTUIEverShownState",e.SetTUIEverShownState="SetTUIEverShownState"}(o||(o={})),function(e){e.Success="Success",e.Failure="Failure"}(n||(n={}))},43200:(e,t,s)=>{var o;s.d(t,{a:()=>o}),function(e){e[e.Insert=1]="Insert",e[e.Delete=2]="Delete",e[e.Replace=3]="Replace",e[e.Append=4]="Append"}(o||(o={}))},91847:(e,t,s)=>{s.d(t,{Jq:()=>a});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotContentCreation_ContentCreationSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_CopilotContentCreation_ContentCreationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_CopilotContentCreation_ContentCreationStreamChunkAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_CopilotContentCreation_ContentCreationStreamCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},78590:(e,t,s)=>{var o,n,i,r,a,c,l;s.d(t,{su:()=>n}),function(e){e.Success="Success",e.Failure="Failure"}(o||(o={})),function(e){e.Success="Success",e.InvalidRequest="InvalidRequest",e.InternalError="InternalError",e.GptListNotFound="GptListNotFound",e.InvalidGptNotFound="InvalidGpt_NotFound",e.InvalidGptNoAccess="InvalidGpt_NoAccess",e.InvalidGptDeleted="InvalidGpt_Deleted",e.InvalidGptBlocked="InvalidGpt_Blocked",e.GetGPTResponseUndefined="GetGPTResponseUndefined",e.GetGPTListResponseUndefined="GetGPTListResponseUndefined"}(n||(n={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(i||(i={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(r||(r={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(a||(a={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(c||(c={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(l||(l={}))},78447:(e,t,s)=>{s.d(t,{vF:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_CopilotGPTAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTListOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotGpt_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotGpt_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},30900:(e,t,s)=>{s.d(t,{s3:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_CopilotGPTSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTListOperation"}static getBaseTypes(){return["AugLoop_CopilotGpt_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTOperation"}static getBaseTypes(){return["AugLoop_CopilotGpt_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},909:(e,t,s)=>{var o;s.d(t,{S:()=>o}),function(e){e.GetGPTList="GetGPTList",e.GetGPT="GetGPT"}(o||(o={}))},69806:(e,t,s)=>{s.d(t,{Ml:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForBusinessChatAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForIntelligentSearchAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365TeamsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365AppsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CheckCopilotLicenseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForSharePointAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_PlannerPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingOnDemandAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsCopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},53935:(e,t,s)=>{var o;s.d(t,{b:()=>o}),function(e){e.Designer="designer",e.StockImage="stockImage",e.Icon="icon",e.Enterprise="enterprise",e.Banner="banner"}(o||(o={}))},75264:(e,t,s)=>{var o;s.d(t,{J:()=>o}),function(e){e.URL="URL"}(o||(o={}))},78635:(e,t,s)=>{var o,n;s.d(t,{n:()=>o}),function(e){e.Success="Success",e.Failure="Failure"}(o||(o={})),function(e){e.DISMISSED="dismissed",e.COMPLETED="completed",e.EMPTY=""}(n||(n={}))},56786:(e,t,s)=>{s.d(t,{BN:()=>n,T9:()=>a});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_CopilotPluginConfigAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetPluginConfigOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetPluginDefinitionOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetBotResultOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_ReadFreFlagOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_WriteFreFlagOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},6485:(e,t,s)=>{s.d(t,{G:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_CopilotPluginSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},18028:(e,t,s)=>{var o,n;s.d(t,{S:()=>o}),function(e){e.GetPluginConfig="GetPluginConfig",e.GetPluginDefinition="GetPluginDefinition",e.GetBotResult="GetBotResult",e.ReadFreFlag="ReadFreFlag",e.WriteFreFlag="WriteFreFlag"}(o||(o={})),function(e){e.DISMISSED="dismissed",e.COMPLETED="completed"}(n||(n={}))},22282:(e,t,s)=>{var o;s.d(t,{G:()=>o}),function(e){e.Success="Success",e.Failed="Failed"}(o||(o={}))},83355:(e,t,s)=>{s.d(t,{x:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SuggestionAPIResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SubstrateAPIResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},84704:(e,t,s)=>{s.d(t,{G:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SuggestionAPISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SubstrateSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},57817:(e,t,s)=>{var o,n;s.d(t,{p:()=>n,y:()=>o}),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(o||(o={})),function(e){e.Suggestion="Suggestion",e.UserActivity="UserActivity",e.UserPrompts="UserPrompts",e.Link="Link"}(n||(n={}))},98553:(e,t,s)=>{s.d(t,{i:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotWarmupAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},72758:(e,t,s)=>{s.d(t,{P:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotGetUserContextSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},61542:(e,t,s)=>{var o,n,i,r,a,c,l;s.d(t,{Hu:()=>a,yl:()=>c}),function(e){e.None="None",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.DataVerse="DataVerse",e.OpenAIPlugin="OpenAIPlugin"}(o||(o={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Excel=1]="Excel",e[e.Word=2]="Word",e[e.OneNote=3]="OneNote",e[e.Outlook=4]="Outlook",e[e.Teams=5]="Teams",e[e.Event=6]="Event",e[e.Meeting=7]="Meeting",e[e.TeamsMeeting=8]="TeamsMeeting",e[e.SharePoint=9]="SharePoint",e[e.Web=10]="Web",e[e.PDF=11]="PDF",e[e.Zip=12]="Zip",e[e.HTML=13]="HTML",e[e.Visio=14]="Visio",e[e.Image=15]="Image",e[e.Fluid=16]="Fluid",e[e.Video=17]="Video",e[e.Vector=18]="Vector",e[e.Txt=19]="Txt",e[e.ThirdParty=20]="ThirdParty",e[e.Loop=21]="Loop",e[e.Planner=22]="Planner"}(n||(n={})),function(e){e.Word="Word",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Excel="Excel",e.Outlook="Outlook",e.Web="Web",e.Pdf="Pdf",e.Planner="Planner",e.Loop="Loop"}(i||(i={})),function(e){e.BodyText="BodyText",e.Title="Title",e.SubTitle="SubTitle",e.Heading="Heading",e.Table="Table",e.ImageAltText="ImageAltText",e.SmartArtText="SmartArtText",e.Comment="Comment",e.VisualDescription="VisualDescription",e.SlideText="SlideText",e.InkHandwriting="Ink Handwriting"}(r||(r={})),function(e){e[e.Personalization_Indicator=1]="Personalization_Indicator"}(a||(a={})),function(e){e[e.Confirm_Set_Personalization_Profile=1]="Confirm_Set_Personalization_Profile",e[e.Confirm_Delete_Personalization_Profile=2]="Confirm_Delete_Personalization_Profile",e[e.Visual_Summary=3]="Visual_Summary",e[e.PPT_Summary=4]="PPT_Summary"}(c||(c={})),function(e){e.Text="Text",e.Section="Section"}(l||(l={}))},77383:(e,t,s)=>{var o;s.d(t,{b:()=>o}),function(e){e.Insertion="Insertion",e.Deletion="Deletion",e.Formatting="Formatting"}(o||(o={}))},66571:(e,t,s)=>{s.d(t,{j:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Copilot_CopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Copilot_CopilotOutputStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},96944:(e,t,s)=>{s.d(t,{GJ:()=>r});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Copilot_SignalWithQueryId"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Copilot_CopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Copilot_CopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},33675:(e,t,s)=>{var o;s.d(t,{B:()=>o}),function(e){e.OPENED="opened",e.CLOSED="closed",e.LOADING="loading",e.LOADED="loaded",e.UNKNOWN="unknown"}(o||(o={}))},27465:(e,t,s)=>{var o,n,i;s.d(t,{Aw:()=>i,NQ:()=>o,Pf:()=>n}),function(e){e.ResumeInvokeAction="ResumeInvokeAction",e.ResumePluginAuth="ResumePluginAuth",e.CompletePlugin="CompletePlugin"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(n||(n={})),function(e){e.failed="failed",e.success="success",e.cancelled="cancelled"}(i||(i={}))},68174:(e,t,s)=>{var o;s.d(t,{r:()=>o}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(o||(o={}))},90951:(e,t,s)=>{var o,n;s.d(t,{L:()=>o,p:()=>n}),function(e){e[e.LambdaExecutionUnhandledError=0]="LambdaExecutionUnhandledError",e[e.LambdaExecutionError=1]="LambdaExecutionError",e[e.WorkflowExecutionTimeout=2]="WorkflowExecutionTimeout",e[e.NetworkError=3]="NetworkError",e[e.SignalNotGotToExecution=4]="SignalNotGotToExecution",e[e.RequestTruncated=5]="RequestTruncated",e[e.WorkflowWrongAnnotationType=6]="WorkflowWrongAnnotationType",e[e.SequenceOutOfOrder=7]="SequenceOutOfOrder",e[e.WorkflowExecutionThrottled=8]="WorkflowExecutionThrottled",e[e.WorkflowExecutionCancelled=9]="WorkflowExecutionCancelled",e[e.NetworkTimeoutOrWorkflowIsBusy=10]="NetworkTimeoutOrWorkflowIsBusy",e[e.RequiredTokenNotAvailable=11]="RequiredTokenNotAvailable",e[e.InvalidInputQuantityForSingleItemWorkflow=12]="InvalidInputQuantityForSingleItemWorkflow",e[e.ExceededRequestSizeLimit=13]="ExceededRequestSizeLimit",e[e.UnknownAnnotationParent=14]="UnknownAnnotationParent",e[e.AnnotationsNotArray=15]="AnnotationsNotArray",e[e.UnexpectedOutput=16]="UnexpectedOutput",e[e.MixedOutput=17]="MixedOutput",e[e.OutputIsNotAnnotation=18]="OutputIsNotAnnotation",e[e.UnexpectedError=19]="UnexpectedError",e[e.WorkflowNotActivated=20]="WorkflowNotActivated"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.AuthTokenIsMissing=1]="AuthTokenIsMissing",e[e.UserContextIsMissing=2]="UserContextIsMissing",e[e.SeedingNotCompleted=3]="SeedingNotCompleted"}(n||(n={}))},79181:(e,t,s)=>{var o;s.d(t,{m:()=>o}),function(e){e[e.Unknown=0]="Unknown",e[e.CopilotInM365=1]="CopilotInM365",e[e.CopilotPro=2]="CopilotPro",e[e.CopilotEnterprise=3]="CopilotEnterprise"}(o||(o={}))},39551:(e,t,s)=>{s.d(t,{Iz:()=>r,YH:()=>n,h_:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},59586:(e,t,s)=>{s.d(t,{W8:()=>r,ay:()=>i,k$:()=>n,tX:()=>c,u$:()=>a});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},58694:(e,t,s)=>{s.d(t,{J:()=>n,x:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},70825:(e,t,s)=>{s.d(t,{A5:()=>y,B9:()=>i,I:()=>r,Vm:()=>d,XP:()=>u,Xr:()=>c,Z5:()=>m,Zw:()=>h,fZ:()=>p,g0:()=>C,hK:()=>_,hW:()=>l,mX:()=>f,n4:()=>g,sT:()=>n,vg:()=>a,xU:()=>T});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()}},82076:(e,t,s)=>{s.d(t,{h:()=>o});class o{constructor(e){o.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const s=o.getTypeNameFor(e),n=o.getBaseTypesFor(e);for(const e of t){if(e===s)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,s){if(s)for(const e of Object.keys(s))t[e]=s[e];return t.H_=e.H_,t}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},92100:(e,t,s)=>{s.d(t,{HN:()=>n,M_:()=>i,WJ:()=>r});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},67880:(e,t,s)=>{s.d(t,{I3:()=>l,LX:()=>u,Nn:()=>a,QG:()=>T,SB:()=>y,W1:()=>d,YQ:()=>n,hD:()=>m,iS:()=>r,sD:()=>g,u7:()=>f,wX:()=>p,yI:()=>i,yo:()=>c,zB:()=>h});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()}},77412:(e,t,s)=>{if(s.r(t),s.d(t,{AddOperation:()=>p.Xr,Annotation:()=>l.YH,AnnotationState:()=>o.r,Apology:()=>m.k$,AuthTokenIsMissingDetails:()=>m.u$,Binary:()=>d.yI,BinaryClassificationAnnotation:()=>l.h_,Blob:()=>d.YQ,BlobRefType:()=>r.J1,ContextHolder:()=>d.W1,CopilotLicenseType:()=>n.m,DeleteOperation:()=>p.n4,DeltaUpdateOperation:()=>p.xU,DirtyAreaSignal:()=>h.M_,DirtyDocumentSignal:()=>h.WJ,Document:()=>d.yo,DynamicContext:()=>d.zB,EntryPoint:()=>i.$k,Event:()=>u.J,EventsHolder:()=>d.u7,FocusOperation:()=>p.A5,GridCell:()=>d.LX,GridConstants:()=>r.u5,GridNeighborhoodContext:()=>d.wX,ItemChanges:()=>i.Xm,ItemChangesDelta:()=>p.B9,ItemDelta:()=>p.sT,ItemFilter:()=>d.sD,ItemOperation:()=>i.nU,MicroSyncOperation:()=>p.hK,MoveOperation:()=>p.hW,NotActivatedWorkflowApology:()=>m.tX,OpenType:()=>r.h6,Operation:()=>p.I,OperationErrorCode:()=>i.dY,OperationWithSiblingContext:()=>p.vg,PurgeByTypesOperation:()=>p.Z5,PurgeOperation:()=>p.Zw,PurgeSubtreeExceptTypesOperation:()=>p.Vm,Scenario:()=>c.N,SchemaObject:()=>g.h,SecondaryApology:()=>m.ay,Session:()=>d.Nn,Signal:()=>h.HN,SignalOperation:()=>p.g0,StreamAnnotation:()=>l.Iz,SubDocument:()=>d.I3,TenantContextHolder:()=>d.SB,TileGroup:()=>d.iS,UpdateAnnotationMetaDataOperation:()=>p.XP,UpdateOperation:()=>p.fZ,UserCommand:()=>u.x,UserCommandsHolder:()=>d.QG,UserContextHolder:()=>d.hD,VisibilityOperation:()=>p.mX,WorkflowActivationFailureDetails:()=>m.W8,WorkflowExecutionErrorCode:()=>a.L,WorkflowNotActivatedReasonCode:()=>a.p,ecsMetadataBlockHeight:()=>r.Xo,ecsMetadataBlockWidth:()=>r.KY}),!/^8(654|871)$/.test(s.j))var o=s(68174);if(!/^8(654|871)$/.test(s.j))var n=s(79181);if(!/^8(654|871)$/.test(s.j))var i=s(39856);if(!/^8(654|871)$/.test(s.j))var r=s(39949);if(!/^8(654|871)$/.test(s.j))var a=s(90951);if(!/^8(654|871)$/.test(s.j))var c=s(52063);if(!/^8(654|871)$/.test(s.j))var l=s(39551);if(!/^8(654|871)$/.test(s.j))var u=s(58694);if(!/^8(654|871)$/.test(s.j))var p=s(70825);if(!/^8(654|871)$/.test(s.j))var g=s(82076);if(!/^8(654|871)$/.test(s.j))var h=s(92100);if(!/^8(654|871)$/.test(s.j))var d=s(67880);if(!/^8(654|871)$/.test(s.j))var m=s(59586)},39856:(e,t,s)=>{var o,n,i,r;s.d(t,{$k:()=>o,Xm:()=>i,dY:()=>r,nU:()=>n}),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.CopilotChat="CopilotChat",e.Test="Test"}(o||(o={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"}(n||(n={})),function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"}(i||(i={})),function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.MoveToTheSamePath=12]="MoveToTheSamePath",e[e.UnknownOperation=13]="UnknownOperation",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"}(r||(r={}))},52063:(e,t,s)=>{var o;s.d(t,{N:()=>o}),function(e){e.Unknown="Unknown",e.Testing="Testing",e.CopilotSummary="Copilot Summary",e.CopilotCompose="Copilot Compose",e.Rewrite="Copilot Rewrite",e.ChatQnA="Copilot Chat Question & Answer",e.CIQ="Context IQ",e.Editor="Editor"}(o||(o={}))},39949:(e,t,s)=>{s.d(t,{J1:()=>i,KY:()=>n,Xo:()=>o,h6:()=>r,u5:()=>a});const o=512,n=32;var i,r;!function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token"}(i||(i={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(r||(r={}));class a{}a.lowerIndexBound=1,a.maxNumberOfRows=1048576,a.maxNumberOfColumns=16384,a.firstColumnName="A",a.lastColumnName="XFD"},1327:(e,t,s)=>{s.d(t,{d:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditBalanceAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},96468:(e,t,s)=>{s.d(t,{m:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditBalanceSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditDeductionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},84163:(e,t,s)=>{s.d(t,{KJ:()=>n,Ob:()=>i,pK:()=>a});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorStreamCompletionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorSuggestedQnAAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},98808:(e,t,s)=>{s.d(t,{h:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},89563:(e,t,s)=>{var o,n,i;s.d(t,{$n:()=>o,hc:()=>i}),function(e){e.Unknown="Unknown",e.Unlimited="Unlimited",e.Limited="Limited"}(o||(o={})),function(e){e.Unknown="Unknown",e.Substrate="Substrate",e.CopilotAgentBilling="CopilotAgentBilling"}(n||(n={})),function(e){e[e.Success=0]="Success",e[e.BadRequest=1]="BadRequest",e[e.Unauthorized=2]="Unauthorized",e[e.ResourcesNotFound=3]="ResourcesNotFound",e[e.Forbidden=4]="Forbidden",e[e.Timeout=5]="Timeout",e[e.InternalServerError=6]="InternalServerError",e[e.ServiceUnavailable=7]="ServiceUnavailable",e[e.Unknown=8]="Unknown",e[e.ErrorInExecution=9]="ErrorInExecution",e[e.OutOfCredits=10]="OutOfCredits",e[e.BypassDeduction=11]="BypassDeduction",e[e.Overloaded=12]="Overloaded"}(i||(i={}))},86972:(e,t,s)=>{var o,n,i,r;s.d(t,{sT:()=>o}),function(e){e[e.TextChatDavinci002=0]="TextChatDavinci002",e[e.TextDavinci001=1]="TextDavinci001",e[e.TextDavinci002=2]="TextDavinci002",e[e.TextDavinci003=3]="TextDavinci003",e[e.TextCurie001=4]="TextCurie001",e[e.TextBabbage001=5]="TextBabbage001",e[e.TextAda001=6]="TextAda001",e[e.CodeDavinci002=7]="CodeDavinci002",e[e.CodeCushman001=8]="CodeCushman001",e[e.Custom=9]="Custom",e[e.TextSimilarityAda001=10]="TextSimilarityAda001",e[e.TextSimilarityBabbage001=11]="TextSimilarityBabbage001",e[e.TextSimilarityCurie001=12]="TextSimilarityCurie001",e[e.TextSimilarityDavinci001=13]="TextSimilarityDavinci001",e[e.TextSearchAdaDoc001=14]="TextSearchAdaDoc001",e[e.TextSearchAdaQuery001=15]="TextSearchAdaQuery001",e[e.TextSearchBabbageDoc001=16]="TextSearchBabbageDoc001",e[e.TextSearchBabbageQuery001=17]="TextSearchBabbageQuery001",e[e.TextSearchCurieDoc001=18]="TextSearchCurieDoc001",e[e.TextSearchCurieQuery001=19]="TextSearchCurieQuery001",e[e.TextSearchDavinciDoc001=20]="TextSearchDavinciDoc001",e[e.TextSearchDavinciQuery001=21]="TextSearchDavinciQuery001",e[e.CodeSearchAdaCode001=22]="CodeSearchAdaCode001",e[e.CodeSearchAdaText001=23]="CodeSearchAdaText001",e[e.CodeSearchBabbageCode001=24]="CodeSearchBabbageCode001",e[e.CodeSearchBabbageText001=25]="CodeSearchBabbageText001",e[e.TextEmbeddingAda002=26]="TextEmbeddingAda002",e[e.Gpt35Turbo=27]="Gpt35Turbo",e[e.Gpt4_32k=28]="Gpt4_32k",e[e.Gpt4_0203=29]="Gpt4_0203",e[e.Gpt4_0314_4k=30]="Gpt4_0314_4k",e[e.Gpt4_0314_32k=31]="Gpt4_0314_32k",e[e.Gpt4_DV3_FP_Variant=32]="Gpt4_DV3_FP_Variant",e[e.Gpt4_DV3_FP=33]="Gpt4_DV3_FP",e[e.Gpt4_PPO_FP_Variant=34]="Gpt4_PPO_FP_Variant",e[e.Gpt4_PPO_FP=35]="Gpt4_PPO_FP",e[e.GptV=36]="GptV",e[e.Gpt35Turbo16k=37]="Gpt35Turbo16k",e[e.Gpt35TurboInstruct=38]="Gpt35TurboInstruct",e[e.Gpt4Turbo=39]="Gpt4Turbo",e[e.Gpt4=40]="Gpt4",e[e.Gpt4Turbo_0125=41]="Gpt4Turbo_0125",e[e.Gpt35Turbo_1106=42]="Gpt35Turbo_1106",e[e.Gpt35Turbo_0125=43]="Gpt35Turbo_0125",e[e.Gpt35Turbo_Deucalion=44]="Gpt35Turbo_Deucalion",e[e.Gpt4_0613=45]="Gpt4_0613",e[e.TextEmbedding3Small=46]="TextEmbedding3Small",e[e.TextEmbedding3Large=47]="TextEmbedding3Large",e[e.Gpt35Turbo_0613_EditorFineTuned_Japanese=48]="Gpt35Turbo_0613_EditorFineTuned_Japanese",e[e.TextEmbeddingAda002_Substrate=49]="TextEmbeddingAda002_Substrate",e[e.Gpt35Turbo_0125_AOAI=50]="Gpt35Turbo_0125_AOAI",e[e.Gpt4Turbo_0409=51]="Gpt4Turbo_0409",e[e.Gpt4o_0513=52]="Gpt4o_0513",e[e.Gpt4o_AOAI=53]="Gpt4o_AOAI",e[e.Gpt4o_Vision_0513=54]="Gpt4o_Vision_0513",e[e.Gpt4o_Mini=55]="Gpt4o_Mini",e[e.Gpt35Turbo_0125_EditorFineTuned_Japanese=56]="Gpt35Turbo_0125_EditorFineTuned_Japanese",e[e.Gpt4o_0806=57]="Gpt4o_0806",e[e.Gpt4o_Realtime=58]="Gpt4o_Realtime",e[e.GptO1=59]="GptO1",e[e.Dall_e_3=60]="Dall_e_3",e[e.Gpt4o_Canvas=61]="Gpt4o_Canvas",e[e.Phi2=10001]="Phi2",e[e.Mixtral_8x7b_Instruct_V01=10002]="Mixtral_8x7b_Instruct_V01",e[e.Mistral_7b_Instruct_V02=10003]="Mistral_7b_Instruct_V02",e[e.Mistral_7b_v01=10004]="Mistral_7b_v01",e[e.Phi3Mini=10005]="Phi3Mini",e[e.Phi3Medium=10006]="Phi3Medium",e[e.Phi3Small=10007]="Phi3Small",e[e.Phi3Vision=10008]="Phi3Vision",e[e.Phi3Small_PPT=10009]="Phi3Small_PPT",e[e.Phi3Vision_PPT=10010]="Phi3Vision_PPT",e[e.Phi35Mini=10011]="Phi35Mini",e[e.Phi35Moe=10012]="Phi35Moe",e[e.Phi3VisionImageAction=10013]="Phi3VisionImageAction",e[e.Phi3Small_Doc2PPT_FT=11e3]="Phi3Small_Doc2PPT_FT"}(o||(o={})),function(e){e.object="object"}(n||(n={})),function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean"}(i||(i={})),function(e){e.Function="function"}(r||(r={}))},1335:(e,t,s)=>{var o,n,i,r;s.d(t,{lC:()=>o}),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.EnumValueNotInUse=12]="EnumValueNotInUse",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized",e[e.UserThrottled=23]="UserThrottled",e[e.ScenarioThrottled=24]="ScenarioThrottled",e[e.InvalidFormatting=25]="InvalidFormatting",e[e.WorkflowQuotaLimitExceeded=26]="WorkflowQuotaLimitExceeded",e[e.UnsupportedRequirement=27]="UnsupportedRequirement",e[e.UrlPresentInInput=28]="UrlPresentInInput",e[e.DocumentUrlChangeDetected=29]="DocumentUrlChangeDetected",e[e.ExpectedError=30]="ExpectedError",e[e.BlockedByUserPrompt=31]="BlockedByUserPrompt",e[e.PromptDefinedError=32]="PromptDefinedError",e[e.FailedToGetFileContents=33]="FailedToGetFileContents",e[e.OutputBlockedByDynamicBlockList=34]="OutputBlockedByDynamicBlockList",e[e.ProtectedMaterial=35]="ProtectedMaterial",e[e.Skipped=36]="Skipped",e[e.DeferredRaiFailure=37]="DeferredRaiFailure",e[e.OutOfCredits=38]="OutOfCredits",e[e.InputGroundingAttackDetected=39]="InputGroundingAttackDetected",e[e.ToolCalls=40]="ToolCalls"}(o||(o={})),function(e){e.text="text",e.image="image"}(n||(n={})),function(e){e.System="system",e.User="user",e.Assistant="assistant"}(i||(i={})),function(e){e.NotStarted="NotStarted",e.Running="Running",e.Succeeded="Succeeded",e.Failed="Failed"}(r||(r={}))},18516:(e,t,s)=>{s.d(t,{N0:()=>n,NC:()=>p,Xv:()=>i,Z8:()=>l,aD:()=>u,f4:()=>g,hl:()=>a,iU:()=>c,ub:()=>r});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentSuggestion"}static getBaseTypes(){return["AugLoop_SmartCompose_Suggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentPrefilterTriggered"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntent"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentHybrid"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_Prefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_FlagWithIntent"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_EntityPrediction"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},90943:(e,t,s)=>{var o,n;s.r(t),s.d(t,{EntityPrediction:()=>i.f4,FlagWithIntent:()=>i.NC,GraphIntentDetectionBaseSignal:()=>a,GraphIntentDetectionSignal:()=>c,GraphIntentPrefilterTriggered:()=>i.Xv,GraphIntentSuggestion:()=>i.N0,IntentConfidenceLevel:()=>o,IntentScope:()=>n,Prefetch:()=>i.aD,SystemInitiatedRequestSignalHybrid:()=>l,SystemInitiatedWithIntent:()=>i.hl,SystemInitiatedWithIntentBase:()=>i.ub,SystemInitiatedWithIntentClient:()=>i.iU,SystemInitiatedWithIntentHybrid:()=>i.Z8}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(o||(o={})),function(e){e.FirstParty="FirstParty",e.ThirdParty="ThirdParty"}(n||(n={}));var i=s(18516),r=s(82076);class a{constructor(e){r.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return r.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){r.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionSignal"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return r.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){r.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedRequestSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return r.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},43109:(e,t,s)=>{s.d(t,{J_:()=>a,NG:()=>u,VL:()=>r,nm:()=>c,rQ:()=>i,t9:()=>l,xz:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetchCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDeleteCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid"}static getBaseTypes(){return["AugLoop_GraphSearch_SearchSuggestionsAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphSearch_PredictionAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphSearch_NudgeAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphSearch_EccAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_GraphSearch_UserInitiatedAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},87532:(e,t,s)=>{s.d(t,{$9:()=>r,Z5:()=>n,tE:()=>i,zV:()=>a});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsRequest"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphSearch_GraphSearchSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDelete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},47623:(e,t,s)=>{var o,n;s.d(t,{F:()=>o,b:()=>n}),function(e){e[e.Client=0]="Client",e[e.Server=1]="Server"}(o||(o={})),function(e){e.None="None",e.RecentlyAccessed="RecentlyAccessed",e.Frequent="Frequent",e.Trending="Trending",e.Uploaded="Uploaded"}(n||(n={}))},52033:(e,t,s)=>{s.d(t,{dF:()=>r,kp:()=>n,uC:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffOutboundMessage"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessage"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPluginAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},68494:(e,t,s)=>{s.d(t,{Ox:()=>l,vF:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPropertiesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_AppHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInternalMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessageId"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},4260:(e,t,s)=>{var o,n;s.d(t,{Q:()=>o}),function(e){e.GET="Get",e.PROCESSED="Processed"}(o||(o={})),function(e){e.GET="Get",e.STORE="Store"}(n||(n={}))},38151:(e,t,s)=>{var o,n,i,r,a;s.d(t,{Cu:()=>a,Ut:()=>i,Ww:()=>n,pT:()=>r,v1:()=>o}),function(e){e.MARKDOWN="markdown",e.HTML="html",e.TEXT="text",e.JSON="json",e.NONE="none"}(o||(o={})),function(e){e.NONE="none",e.TESTING="testing",e.WORD="word",e.EXCEL="excel",e.POWERPOINT="powerpoint",e.OUTLOOK="outlook",e.BIZ_CHAT="bizchat",e.BING_CHAT="bingchat",e.ONENOTE="onenote",e.FORMS="forms",e.LOOP="loop",e.COPILOTLAB="copilotlab",e.ONEDRIVE="OneDriveForBusiness",e.SHAREPOINT="SharePointPages"}(n||(n={})),function(e){e.NONE="none",e.APP_CHAT="AppChat",e.CANVAS="Canvas",e.NARRATIVE_BUILDER="NarrativeBuilder"}(i||(i={})),function(e){e.NONE="none",e.WEB="Web",e.Win32="Win32",e.MAC="Mac",e.IOS="iOS",e.ANDROID="Android"}(r||(r={})),function(e){e.NONE="default_scenario",e.NEW="new",e.GENERATE="generate",e.OPEN="open",e.INAPP="inapp",e.EDIT="edit",e.GENERATE_AND_OPEN="generate_and_open"}(a||(a={}))},70533:(e,t,s)=>{var o,n;s.d(t,{f:()=>o,h:()=>n}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Jpg=2]="Jpg",e[e.Png=3]="Png",e[e.Bmp=4]="Bmp"}(o||(o={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(n||(n={}))},31376:(e,t,s)=>{s.d(t,{MG:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_InboxIqAgentCopilot_InboxIqAgentRuntimeAnnotation"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentRuntimeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_InboxIqAgentCopilot_InboxIqAgentProxyCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotOutputAnnotation","AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_InboxIqAgentCopilot_InboxIqAgentProxyChatHistoryOutputAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},66019:(e,t,s)=>{s.d(t,{cS:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_InboxIqAgentCopilot_InboxIqAgentProxyCopilotInputSignal"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentProxyCopilotInputSignal","AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_InboxIqAgentCopilot_InboxIqAgentProxyCopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_InboxIqAgentCopilot_InboxIqAgentRuntimeSignal"}static getBaseTypes(){return["AugLoop_AgentCopilot_AgentRuntimeSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},81870:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},87199:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParagraphCount=t.CharacterWithoutSpacesCount=t.CharacterCount=t.WordCount=t.TimeToSpeak=t.TimeToRead=t.ReadabilityScore=t.InsightsAnalyzerData=void 0;const o=s(77412);class n{constructor(e){o.SchemaObject.assign(n,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_InsightsAnalyzerData"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[n.getTypeName()])}}t.InsightsAnalyzerData=n,n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.SchemaObject.assign(i,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_ReadabilityScore"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[i.getTypeName()])}}t.ReadabilityScore=i,i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.SchemaObject.assign(r,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_TimeToRead"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[r.getTypeName()])}}t.TimeToRead=r,r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.SchemaObject.assign(a,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_TimeToSpeak"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[a.getTypeName()])}}t.TimeToSpeak=a,a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.SchemaObject.assign(c,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_WordCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[c.getTypeName()])}}t.WordCount=c,c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.SchemaObject.assign(l,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_CharacterCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[l.getTypeName()])}}t.CharacterCount=l,l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.SchemaObject.assign(u,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_CharacterWithoutSpacesCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[u.getTypeName()])}}t.CharacterWithoutSpacesCount=u,u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.SchemaObject.assign(p,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Insights_ParagraphCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.SchemaObject.matchesTypesFor(e,[p.getTypeName()])}}t.ParagraphCount=p,p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},57220:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(81870),t),n(s(87199),t)},2570:(e,t,s)=>{s.d(t,{L:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_EntityLabelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_SensitivityLabel"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},98653:(e,t,s)=>{s.d(t,{L:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_OAActionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},99614:(e,t,s)=>{var o;s.d(t,{c:()=>o}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(o||(o={}))},85665:(e,t,s)=>{s.d(t,{I9:()=>n,c7:()=>r,ep:()=>i});var o=s(82076),n=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},18305:(e,t,s)=>{s.d(t,{JM:()=>n,VP:()=>i});var o=s(82076),n=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}())},53335:(e,t,s)=>{s.d(t,{KL:()=>i,SM:()=>l,Yd:()=>a,aO:()=>n,k2:()=>c,uH:()=>r});var o=s(82076),n=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}());!function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},55875:(e,t,s)=>{s.d(t,{$g:()=>i,Fe:()=>n,J2:()=>a,Nh:()=>g,Vm:()=>p,Vn:()=>h,Zx:()=>l,c$:()=>c,gh:()=>u,os:()=>r});var o=s(82076),n=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationODSP"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotation","AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),u=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),p=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),g=(function(){function e(t){o.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),h=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},27563:(e,t,s)=>{s.d(t,{f:()=>n});var o=s(82076),n=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_TimeResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},19064:(e,t,s)=>{var o;s.d(t,{O:()=>o}),function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(o||(o={}))},4915:(e,t,s)=>{var o;s.d(t,{i:()=>o}),function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError",e[e.EarlyExit=5]="EarlyExit"}(o||(o={}))},74641:(e,t,s)=>{s.d(t,{H6:()=>n,Vd:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppStreamingAnnotation"}static getBaseTypes(){return["AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppAnnotation","AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},53310:(e,t,s)=>{s.d(t,{i:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppCopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},68471:(e,t,s)=>{var o,n,i,r,a,c,l;s.d(t,{RS:()=>o,d2:()=>a,v1:()=>i}),function(e){e.USER_PROMPT="userPrompt",e.INVOKE_SKILL="invokeSkill",e.GENERATE_TABLE="generateTable",e.GENERATE_SUMMARY="generateSummary",e.GENERATE_CONTENT_LENGTH_SPECIFIED="generateContentLengthSpecified",e.GENERATE_CONTENT="generateContent",e.GENERATE_CONTENT_WITH_EMOJI="generateContentWithEmoji",e.REWRITE_CONTENT="rewriteContent",e.REWRITE_CONTENT_WITH_EMOJIS="rewriteContentWithEmojis",e.REWRITE_CONTENT_WITH_GROUNDING_CONTENT_FROM_FILE="rewriteContentWithGroundingContentFromFile",e.FORMAT_CONTENT="formatContent",e.TRANSLATE_CONTENT="translateContent",e.USER_QUERY="userQuery",e.OPERATE_ON_TABLE="operateOnTable",e.CONTENT_GENERATION_FROM_FILES="contentGenerationFromFiles",e.GENERATE_DATA_VISUALISATION_CHART="generateChartVisualisation",e.GENERATE_IMAGE="generateImage",e.GENERATE_ARTIFACT="generateArtifact",e.GENERATE_ARTIFACT_FROM_FILE="generateArtifactFromFile",e.ORGANIZE_FILES_IN_FOLDER="organizeFilesInFolder",e.REFRESH_DATA="refreshData",e.GENERATE_PODCAST="generatePodcast",e.NOT_KNOWN="notKnown"}(o||(o={})),function(e){e.INSERT="insert",e.UPDATE="update"}(n||(n={})),function(e){e.HTML="html",e.JSON="json",e.XML="xml",e.TEXT="text",e.ERROR_TEXT="error_text",e.MARKDOWN="markdown"}(i||(i={})),function(e){e.WEB_SEARCH_DETERMINATION="webSearchDetermination",e.INTENT_DETECTION="intentDetection",e.CONTENT_GENERATION="contentGeneration",e.CONTENT_EVALUATION="contentEvaluation",e.CONTENT_GENERATION_WITH_WEB_SEARCH="contentGenerationWithWebSearch"}(r||(r={})),function(e){e.INIT_SERVICE="initService",e.FETCH_FILE_LIST="fetchFileList",e.FETCH_CONTENT="fetchContent",e.GENERATE_DATA="generateData",e.GENERATE_CONTENT_WITH_EMOJIS_FROM_CONTENT="generateContentWithEmojisFromContent",e.SERVICE_RESPONSE="serviceResponse",e.CLIENT_ACK="clientAck",e.FETCH_CHAT_HISTORY="fetchChatHistory",e.FETCH_CONTENT_METADATA="fetchContentMetadata",e.GENERATE_SUGGESTIONS="generateSuggestions",e.CLEAN_UP="cleanUp",e.CONVERT_TO_BLOG="convertToBlog",e.SET_CONFIG="setConfig",e.REFRESH_DATA="refreshData",e.EVAL_AND_PERF_METRICS="evalAndPerfMetrics",e.GENERATE_ARTIFACT="generateArtifact",e.GENERATE_ARTIFACT_FROM_FILE="generateArtifactFromFile",e.ORGANIZE_FILES_IN_FOLDER="organizeFilesInFolder",e.PODCAST_CREATION="podcastCreation"}(a||(a={})),function(e){e.DOCX="docx",e.DOC="doc",e.XLSX="xlsx",e.TEXT="txt",e.PDF="pdf",e.PEOPLE="people",e.PPTX="pptx",e.HTML="html",e.JSON="json",e.EMAIL="eml",e.UNKNOWN="unknown",e.MP4="mp4",e.AVI="avi",e.WMV="wmv",e.MP3="mp3",e.PNG="png",e.JPG="jpg",e.CSV="csv",e.EXTENSION_NOT_AVAILABLE="extension_not_available",e.YAML="yaml"}(c||(c={})),function(e){e.SENSITIVE_FILE="Sensitive file",e.METADATA_DOWNLOAD_FAILED="File metadata download failed",e.CONTENT_DOWNLOAD_FAILED="File content download failed",e.ACCESS_DENIED="No permission to access the file."}(l||(l={}))},3311:(e,t,s)=>{var o,n;s.d(t,{i:()=>o}),function(e){e.choose_topic="choose_topic",e.choose_input_files="choose_input_files",e.generate_draft="generate_draft",e.review_draft="generate_review",e.define_objective="define_objective",e.choose_audience="choose_audience",e.publish_draft="publish_draft",e.generate_outline="generate_outline",e.generate_ppt="generate_ppt",e.generate_semantic_tree="generate_semantic_tree",e.generate_artifacts="generate_artifacts"}(o||(o={})),function(e){e.FileSearchFailed="FileSearchFailed",e.CIPGenerationFailed="CIPGenerationFailed",e.DocumentDownloadFailed="DocumentDownloadFailed",e.DeckGenerationError="DeckGenerationError",e.DataValidationError="DataValidationError",e.OutlineGenerationFailed="OutlineGenerationFailed",e.Timeout="Timeout",e.Unknown="Unknown"}(n||(n={}))},52863:(e,t,s)=>{s.d(t,{m:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},90986:(e,t,s)=>{s.d(t,{M5:()=>n,M6:()=>a,XE:()=>r});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_UIStateSyncSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_InvokeSkillSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},62979:(e,t,s)=>{var o,n;s.d(t,{g:()=>o}),function(e){e.ProjectStatusReport="projectstatusreport",e.InternalReport="internalreport",e.Newsletter="newsletter",e.Email="emailcampaign",e.BlogPost="blogpost",e.Unknown="unknown"}(o||(o={})),function(e){e.CIPTree="CIPTree",e.ChosenTopics="ChosenTopics"}(n||(n={}))},9669:(e,t,s)=>{s.d(t,{L:()=>i,c:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputStreamAnnotation","AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffInternalMessage","AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},9473:(e,t,s)=>{s.d(t,{g:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEventsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},33964:(e,t,s)=>{s.d(t,{Cc:()=>c,RN:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEventsInput"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEvent"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResponseReceivedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsRenderedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SearchEntityActionsSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ClientDataSourceSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ClientLayoutSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsView"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsViewEntity"}static getBaseTypes(){return["AugLoop_SubstrateEvents_ResultsView"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsViewGroup"}static getBaseTypes(){return["AugLoop_SubstrateEvents_ResultsView"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_CachedContentRenderedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SearchFeedbackSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()}},99201:(e,t,s)=>{var o,n,i,r,a,c,l,u;s.d(t,{T8:()=>o}),function(e){e[e.EntityClicked=0]="EntityClicked",e[e.RelatedEntityClicked=1]="RelatedEntityClicked",e[e.EntityRefinerClicked=2]="EntityRefinerClicked",e[e.EntityActionTaken=3]="EntityActionTaken",e[e.PreviewOpen=4]="PreviewOpen",e[e.PreviewClose=5]="PreviewClose",e[e.OptionsMenuOpen=6]="OptionsMenuOpen",e[e.OptionsMenuClose=7]="OptionsMenuClose",e[e.MouseHover=8]="MouseHover"}(o||(o={})),function(e){e[e.Suggestions=0]="Suggestions",e[e.Query=1]="Query",e[e.Answers=2]="Answers"}(n||(n={})),function(e){e[e.File=0]="File",e[e.Site=1]="Site",e[e.App=2]="App"}(i||(i={})),function(e){e[e.Link=0]="Link"}(r||(r={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.Grid=2]="Grid"}(a||(a={})),function(e){e[e.Files=0]="Files",e[e.Videos=1]="Videos",e[e.Images=2]="Images",e[e.Office=3]="Office"}(c||(c={})),function(e){e[e.Visible=0]="Visible",e[e.Partial=1]="Partial",e[e.Hidden=2]="Hidden"}(l||(l={})),function(e){e[e.Entity=0]="Entity",e[e.Group=1]="Group"}(u||(u={}))},90512:(e,t,s)=>{var o,n,i,r,a,c,l,u,p,g;s.d(t,{E6:()=>r,Nm:()=>l,O2:()=>a,ck:()=>u}),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(o||(o={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(n||(n={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(i||(i={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(r||(r={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(a||(a={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(c||(c={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(l||(l={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(u||(u={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(p||(p={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(g||(g={}))},2162:(e,t,s)=>{var o,n,i;s.d(t,{in:()=>i}),function(e){e.User="User",e.System="System"}(o||(o={})),function(e){e.None="None",e.File="File",e.Event="Event"}(n||(n={})),function(e){e.People="People",e.File="File",e.Topic="Topic",e.Event="Event",e.Message="Message",e.Chat="Chat"}(i||(i={}))},26940:(e,t,s)=>{var o,n,i,r,a,c,l,u,p,g,h,d,m,y,f,T,_,C,v,S,A,w;s.d(t,{YA:()=>o,gL:()=>l,h2:()=>b,n3:()=>w}),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.TeamsMeeting="TeamsMeeting",e.SharePoint="SharePoint",e.Web="Web",e.PDF="PDF",e.Zip="Zip",e.HTML="HTML",e.Visio="Visio",e.Image="Image",e.Fluid="Fluid",e.Video="Video",e.Vector="Vector",e.Txt="Txt",e.ThirdParty="ThirdParty",e.Topic="Topic",e.Loop="Loop",e.Planner="Planner"}(o||(o={})),function(e){e[e.ChatResponse=0]="ChatResponse",e[e.GetMessagesResponse=1]="GetMessagesResponse",e[e.GetConversationResponse=2]="GetConversationResponse",e[e.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",e[e.CopyConversationResponse=4]="CopyConversationResponse",e[e.SerpCachedResponse=5]="SerpCachedResponse",e[e.CaptchaResponse=6]="CaptchaResponse"}(n||(n={})),function(e){e.Default="Default",e.Early="Early",e.OnUse="OnUse",e.Never="Never"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(r||(r={})),function(e){e.Quiet="0",e.Verbose="1"}(a||(a={})),function(e){e.SharePoint="SharePoint",e.OneDrive="OneDrive",e.OneDriveAndSharePoint="OneDriveAndSharePoint"}(c||(c={})),function(e){e.Unknown="Unknown",e.Success="Success",e.InternalError="InternalError",e.InvalidSession="InvalidSession",e.ConfigurationError="ConfigurationError",e.InvalidRequest="InvalidRequest",e.ProcessingMessage="ProcessingMessage",e.UnauthorizedRequest="UnauthorizedRequest",e.Canceled="Canceled",e.CaptchaChallenge="CaptchaChallenge",e.Throttled="Throttled",e.NotFound="NotFound",e.NoResponseReturned="NoResponseReturned",e.ThrottledByLLM="ThrottledByLLM",e.NoResponseText="NoResponseText",e.ApologyResponseReturned="ApologyResponseReturned",e.NoValidMessageTypePresentInBotResponse="NoValidMessageTypePresentInBotResponse",e.ServiceNotEnabled="ServiceNotEnabled",e.ContentForbidden="ContentForbidden",e.ContentNotFound="ContentNotFound",e.InvalidLicense="InvalidLicense",e.NotEnoughContext="NotEnoughContext",e.OutOfCredits="OutOfCredits"}(l||(l={})),function(e){e.Success="Success",e.Failure="Failure",e.Pending="Pending",e.BotTurnStarting="BotTurnStarting"}(u||(u={})),function(e){e.SearchWeb="SearchWeb",e.EnterpriseFileSearch="EnterpriseFileSearch",e.CodeInterpreter="CodeInterpreter"}(p||(p={})),function(e){e.Error="Error",e.Warning="Warning"}(g||(g={})),function(e){e.MissingName="MissingName",e.TooLongName="TooLongName",e.InvalidCharacterInName="InvalidCharacterInName",e.MissingDescription="MissingDescription",e.TooLongDescription="TooLongDescription",e.InvalidCharacterInDescription="InvalidCharacterInDescription",e.MissingInstructions="MissingInstructions",e.TooLongInstructions="TooLongInstructions",e.InvalidCharacterInInstructions="InvalidCharacterInInstructions",e.InvalidIconUrl="InvalidIconUrl",e.InvalidGptId="InvalidGptId",e.TooManyConversationStarters="TooManyConversationStarters",e.InvalidCharacterInConversationStarter="InvalidCharacterInConversationStarter",e.InvalidConversationStarterImageUrl="InvalidConversationStarterImageUrl",e.TooLongConversationStarter="TooLongConversationStarter",e.MissingPluginShortName="MissingPluginShortName",e.TooLongShortName="TooLongShortName",e.InvalidCharacterInShortName="InvalidCharacterInShortName",e.MissingPluginLongName="MissingPluginLongName",e.TooLongLongName="TooLongLongName",e.InvalidCharacterInLongName="InvalidCharacterInLongName",e.MissingPluginShortDescription="MissingPluginShortDescription",e.TooLongShortDescription="TooLongShortDescription",e.InvalidCharacterInShortDescription="InvalidCharacterInShortDescription",e.MissingPluginFullDescription="MissingPluginFullDescription",e.TooLongFullDescription="TooLongFullDescription",e.InvalidCharacterInFullDescription="InvalidCharacterInFullDescription",e.MissingPluginFunction="MissingPluginFunction",e.MissingFunctionId="MissingFunctionId",e.TooLongFunctionId="TooLongFunctionId",e.InvalidCharacterInFunctionId="InvalidCharacterInFunctionId",e.MissingFunctionTitle="MissingFunctionTitle",e.TooLongFunctionTitle="TooLongFunctionTitle",e.InvalidCharacterInFunctionTitle="InvalidCharacterInFunctionTitle",e.MissingFunctionDescription="MissingFunctionDescription",e.TooLongFunctionDescription="TooLongFunctionDescription",e.InvalidCharacterInFunctionDescription="InvalidCharacterInFunctionDescription",e.MissingParameterName="MissingParameterName",e.TooLongParameterName="TooLongParameterName",e.InvalidCharacterInParameterName="InvalidCharacterInParameterName",e.MissingParameterDescription="MissingParameterDescription",e.TooLongParameterDescription="TooLongParameterDescription",e.InvalidCharacterInParameterDescription="InvalidCharacterInParameterDescription",e.MissingParameterTitle="MissingParameterTitle",e.TooLongParameterTitle="TooLongParameterTitle",e.InvalidCharacterInParameterTitle="InvalidCharacterInParameterTitle",e.InvalidTeamsMessagesCapabilityUrl="InvalidTeamsMessagesCapabilityUrl",e.OffensiveContent="OffensiveContent",e.Jailbreak="Jailbreak",e.RAIViolation="RAIViolation"}(h||(h={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(d||(d={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(m||(m={})),function(e){e.Active="Active",e.Draft="Draft",e.Deleted="Deleted",e.Blocked="Blocked"}(y||(y={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(f||(f={})),function(e){e.AnnRules="AnnRules",e.Apology="Apology",e.BingContent="Bing Content",e.Chitchat="Chitchat",e.NluDirectResponse="NluDirectResponse",e.Qna="Qna",e.TopicChanger="TopicChanger",e.Delighterdluni="Delighterdluni",e.DeepLeo="DeepLeo",e.TransformContent="transform_content",e.LocalPluginRunner="local-plugin-runner",e.ImageChat="image-chat",e.GenerateResponse="generate_response"}(T||(T={})),function(e){e.Image="IMAGE"}(_||(_={})),function(e){e.WebPage="WebPage",e.ClientApp="ClientApp"}(C||(C={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(v||(v={})),function(e){e.Keyboard="Keyboard",e.Speech="Speech"}(S||(S={})),function(e){e.AudioUrl="AudioUrl",e.None="None",e.Simple="Simple",e.Ssml="Ssml"}(A||(A={})),function(e){e.ActionRequest="ActionRequest",e.Ads="Ads",e.AdsQuery="AdsQuery",e.Any="Any",e.AuthError="AuthError",e.ChatCompleted="ChatCompleted",e.CaptchaChallenge="CaptchaChallenge",e.Chat="Chat",e.ChatName="ChatName",e.ConfirmationCard="ConfirmationCard",e.Context="Context",e.Disengaged="Disengaged",e.SearchQuery="SearchQuery",e.Internal="Internal",e.InvokeAction="InvokeAction",e.Suggestion="Suggestion",e.InternalSuggestions="InternalSuggestions",e.InternalSearchResult="InternalSearchResult",e.InternalSearchQuery="InternalSearchQuery",e.InternalReasoningSearchResult="InternalReasoningSearchResult",e.InternalActionMarker="InternalActionMarker",e.InternalStateMarker="InternalStateMarker",e.InternalLoaderMessage="InternalLoaderMessage",e.Progress="Progress",e.GenerateContentQuery="GenerateContentQuery",e.GeneratedCode="GeneratedCode",e.RenderCardRequest="RenderCardRequest",e.RequireHumanInTheLoop="RequireHumanInTheLoop",e.SemanticSerp="SemanticSerp",e.ResumePluginAuth="ResumePluginAuth",e.TriggerPluginAuth="TriggerPluginAuth",e.ResumeInvokeAction="ResumeInvokeAction",e.TriggerConfirmation="TriggerConfirmation",e.InternalContentDescription="InternalContentDescription",e.TriggerPlugin="TriggerPlugin",e.CompletePlugin="CompletePlugin"}(w||(w={}));new Set([w.Chat,w.ChatCompleted,w.Disengaged,w.RenderCardRequest,w.RequireHumanInTheLoop]);var I,N,b,k,M,E,L,P,B,D,R,O;!function(e){e.IncomingBotResponse=void 0}(w||(w={})),function(e){e.Blank="BLANK",e.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",e.BingSkill="BING_SKILL",e.Chitchat="CHITCHAT",e.Infoseeking="INFOSEEKING",e.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",e.InitialQNA="INITIAL_QNA",e.InitialVideos="INITIAL_VIDEOS",e.InitialWebpages="INITIAL_WEBPAGES",e.MedicalHealth="MEDICAL_HEALTH",e.MicrosoftBrands="MICROSOFT_BRANDS",e.NeedEmpathy="NEED_EMPATHY",e.Offensive="OFFENSIVE",e.OpinionGiving="OPINION_GIVING",e.OpinionSeeking="OPINION_SEEKING",e.OUTOFDomain="OUT_OF_DOMAIN",e.QNA="QNA",e.SettingsChange="SETTINGS_CHANGE",e.SettingsCheck="SETTINGS_CHECK",e.SuicideHelp="SUICIDE_HELP",e.TuringBOTSafe="TURING_BOT_SAFE",e.Unhandled="UNHANDLED",e.Videos="VIDEOS",e.Webpages="WEBPAGES"}(I||(I={})),function(e){e.Amount="AMOUNT",e.Setting="SETTING",e.Type="TYPE",e.Unknown="UNKNOWN",e.Unit="UNIT",e.Value="VALUE"}(N||(N={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(b||(b={})),function(e){e.Finished="FINISHED",e.Intermediate="INTERMEDIATE",e.FinishedAwaitingCommit="FINISHED_AWAITING_COMMIT"}(k||(k={})),function(e){e.General="General",e.Internal="Internal"}(M||(M={})),function(e){e.Testing="Testing",e.AdminCenterCopilot="AdminCenterCopilot",e.Assist365Copilot="Assist365Copilot",e.ExcelCopilot="ExcelCopilot",e.ExcelCopilotConsumer="ExcelCopilotConsumer",e.ExcelCopilotConsumerOSv2="ExcelCopilotConsumerOSv2",e.FormsCopilot="FormsCopilot",e.LoopCopilot="LoopCopilot",e.LoopCopilotOnCanvas="LoopCopilotOnCanvas",e.ODSPCopilot="ODSPCopilot",e.OfficeAiAppIncubation="OfficeAiAppIncubation",e.OneNoteCopilot="OneNoteCopilot",e.OneNoteCopilotConsumer="OneNoteCopilotConsumer",e.OneNoteCopilotConsumerOSv2="OneNoteCopilotConsumerOSv2",e.OperaWordCopilot="OperaWordCopilot",e.OutlookCopilot="OutlookCopilot",e.OutlookSearchChatCopilot="outlooksearchchatcopilot",e.PodcastCopilot="PodcastCopilot",e.PPTCopilot="PPTCopilot",e.PPTCopilotConsumer="PPTCopilotConsumer",e.PPTCopilotConsumerOSv2="PPTCopilotConsumerOSv2",e.PlannerCopilot="PlannerCopilot",e.StreamCopilot="StreamCopilot",e.TeamsChatCopilot="TeamsChatCopilot",e.TeamsSerpCopilot="TeamsSerpCopilot",e.TeamsGroupCopilot="TeamsGroupCopilot",e.TeamsMeetingCopilot="teamsmeetingcp",e.TeamsMeetingGroupCopilot="TeamsMeetingGroupCopilot",e.VivaCopilot="VivaCopilot",e.VivaEngageCopilot="VivaEngageCopilot",e.VivaGoalsCopilot="VivaGoalsCopilot",e.WhiteboardCopilotOnCanvas="WhiteboardCopilotOnCanvas",e.WordCopilot="WordCopilot",e.WordCopilotConsumer="WordCopilotConsumer",e.WordCopilotConsumerOsv2="WordCopilotConsumerOSv2",e.WordOnCanvasCopilot="WordOnCanvasCopilot",e.TeamsMessagesSerpAICopilot="TeamsMessagesSerpAICopilot",e.OfficePersonalAgentsCopilot="OfficePersonalAgentsCopilot",e.LegacyDefault="Default"}(E||(E={}));!function(e){e.Creative="Creative",e.Balanced="Balanced",e.Precise="Precise"}(L||(L={})),function(e){e.AppChat="appchat"}(P||(P={})),function(e){e.Default="Default",e.Reasoning="Reasoning",e.Responding="Responding"}(B||(B={})),function(e){e.AdaptiveCard="AdaptiveCard"}(D||(D={})),function(e){e[e.InternalError=-32603]="InternalError",e[e.InvalidParams=-32602]="InvalidParams",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.InvocationError=-32e3]="InvocationError",e[e.InvocationErrorWithException=-32004]="InvocationErrorWithException",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.NoMarshaledObjectFound=-32001]="NoMarshaledObjectFound",e[e.ParseError=-32700]="ParseError",e[e.RequestCanceled=-32800]="RequestCanceled",e[e.ResponseSerializationFailure=-32003]="ResponseSerializationFailure"}(R||(R={})),function(e){e.SUCCESS="success",e.FAILURE="failure"}(O||(O={}))},36568:(e,t,s)=>{s.d(t,{w:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_DiagnosticUploadResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},83248:(e,t,s)=>{s.d(t,{n:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_FeedbackDiagnosticDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},6379:(e,t,s)=>{var o;s.d(t,{Q:()=>o}),function(e){e.BlockedByClassifier="BlockedByClassifier",e.BlockedByLanguage="BlockedByLanguage",e.BlockedByPostfilter="BlockedByPostfilter",e.BlockedByPostfilterProcessError="BlockedByPostfilterProcessError",e.BlockedByPrefilter="BlockedByPrefilter",e.BlockedByQualityCheck="BlockedByQualityCheck",e.DocumentLengthTooShort="DocumentLengthTooShort",e.InvalidRequestForm="InvalidRequestForm",e.NthParagraphSummaryNotSupported="NthParagraphSummaryNotSupported",e.OffensiveContentInUserInput="OffensiveContentInUserInput",e.OutOfScopeRequestInUserInput="OutOfScopeRequestInUserInput",e.ResourceUnavailable="ResourceUnavailable",e.Success="Success",e.Timeout="Timeout",e.UnknownError="UnknownError",e.UnknownErrorInParser="UnknownErrorInParser",e.UserNotAuthorized="UserNotAuthorized",e.RetryLimitExceeded="RetryLimitExceeded",e.UserThrottled="UserThrottled",e.ScenarioThrottled="ScenarioThrottled",e.DocumentContentUnavailable="DocumentContentUnavailable",e.MissingExtractPermission="MissingExtractPermission",e.DoubleKeyEncryptedDocument="DoubleKeyEncryptedDocument",e.TenantBlocked="TenantBlocked",e.UnsupportedSummaryFormat="UnsupportedSummaryFormat",e.UnsupportedDocumentLanguage="UnsupportedDocumentLanguage",e.UnsupportedPromptLanguage="UnsupportedPromptLanguage",e.UnsupportedPromptRequestedLanguage="UnsupportedPromptRequestedLanguage",e.IncorrectOutputLanguage="IncorrectOutputLanguage"}(o||(o={}))},82962:(e,t,s)=>{s.d(t,{AN:()=>c,D9:()=>a,Dt:()=>l,X6:()=>n,ur:()=>i});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummaryStart"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummaryFragment"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummaryKeypointFragment"}static getBaseTypes(){return["AugLoop_TextSummarization_GptSummaryFragment","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummaryParagraphFragment"}static getBaseTypes(){return["AugLoop_TextSummarization_GptSummaryFragment","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummaryComplete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},31125:(e,t,s)=>{s.d(t,{g:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GenerateTextSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_TextSummarization_GptSummarySignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},38540:(e,t,s)=>{var o,n,i,r;s.d(t,{bx:()=>o,lb:()=>n,xv:()=>i}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(o||(o={})),function(e){e[e.NotificationOnly=0]="NotificationOnly",e[e.Delete=1]="Delete",e[e.Ignore=2]="Ignore",e[e.IgnoreAll=4]="IgnoreAll",e[e.IgnoreCritiqueType=8]="IgnoreCritiqueType",e[e.AddToDictionary=16]="AddToDictionary",e[e.ShowDetails=32]="ShowDetails"}(n||(n={})),function(e){e[e.None=0]="None",e[e.ChangeOnce=1]="ChangeOnce",e[e.ChangeAll=2]="ChangeAll",e[e.AutoCorrect=4]="AutoCorrect",e[e.ReadAloud=8]="ReadAloud",e[e.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"}(i||(i={})),function(e){e[e.None=0]="None",e[e.CAT_Spelling=1]="CAT_Spelling",e[e.CAT_Grammar=2]="CAT_Grammar",e[e.CAT_Clarity=3]="CAT_Clarity",e[e.CAT_Conciseness=4]="CAT_Conciseness",e[e.CAT_Formality=5]="CAT_Formality",e[e.CAT_Inclusiveness=6]="CAT_Inclusiveness",e[e.CAT_PunctuationConventions=7]="CAT_PunctuationConventions",e[e.CAT_Resume=8]="CAT_Resume",e[e.CAT_SensitiveGeopoliticalReferences=9]="CAT_SensitiveGeopoliticalReferences",e[e.CAT_Vocabulary=10]="CAT_Vocabulary",e[e.CAT_ConsistentWrittenForms=11]="CAT_ConsistentWrittenForms",e[e.CAT_ErrorCorrections=12]="CAT_ErrorCorrections",e[e.CAT_WritingConventions=13]="CAT_WritingConventions",e[e.CAT_Acronyms=14]="CAT_Acronyms",e[e.CAT_Perspectives=15]="CAT_Perspectives",e[e.CAT_UncommonWords=16]="CAT_UncommonWords",e[e.CAT_TypingErrors=17]="CAT_TypingErrors",e[e.CAT_Rewrite=18]="CAT_Rewrite"}(r||(r={}))},69811:(e,t,s)=>{var o,n,i;s.d(t,{HS:()=>i,OD:()=>n,WI:()=>o}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(o||(o={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n||(n={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(i||(i={}))},58029:(e,t,s)=>{s.d(t,{nL:()=>p});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class f{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class T{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class _{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Text_TextStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()}},91538:(e,t,s)=>{s.d(t,{Q:()=>n,s:()=>i});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},2010:(e,t,s)=>{s.d(t,{Cg:()=>i,qf:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},36135:(e,t,s)=>{var o,n,i,r,a,c,l,u,p,g;s.d(t,{pc:()=>r}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Inline=1]="Inline",e[e.Floating=2]="Floating"}(o||(o={})),function(e){e[e.ThumbsUp=0]="ThumbsUp"}(n||(n={})),function(e){e[e.Active=0]="Active",e[e.Resolved=1]="Resolved",e[e.Closed=2]="Closed"}(i||(i={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered",e[e.Lim=3]="Lim",e[e.Nil=4]="Nil",e[e.Any=5]="Any",e[e.NoList=6]="NoList",e[e.Invalid=7]="Invalid"}(r||(r={})),function(e){e[e.DontCare=1]="DontCare",e[e.Thin=2]="Thin",e[e.ExtraLight=3]="ExtraLight",e[e.Light=4]="Light",e[e.Normal=5]="Normal",e[e.Medium=6]="Medium",e[e.SemiBold=7]="SemiBold",e[e.Bold=8]="Bold",e[e.ExtraBold=9]="ExtraBold",e[e.Heavy=10]="Heavy"}(a||(a={})),function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(l||(l={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None",e[e.JustifyLow=6]="JustifyLow",e[e.Distributed=7]="Distributed",e[e.ThaiDistributed=8]="ThaiDistributed"}(u||(u={})),function(e){e[e.Image=0]="Image",e[e.TextBox=1]="TextBox",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Drawing=4]="Drawing",e[e.EquationObject=5]="EquationObject",e[e.Ink=6]="Ink",e[e.InkSpace=7]="InkSpace",e[e.InkEndOfLine=8]="InkEndOfLine",e[e.LineBreak=9]="LineBreak",e[e.PageBreak=10]="PageBreak",e[e.PageNumbers=11]="PageNumbers",e[e.FootnoteEndnote=12]="FootnoteEndnote",e[e.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark",e[e.Tab=14]="Tab",e[e.UnsupportedObject=15]="UnsupportedObject",e[e.Other=16]="Other",e[e.Person=17]="Person",e[e.Date=18]="Date"}(p||(p={})),function(e){e[e.Initial=0]="Initial",e[e.FirstLine=1]="FirstLine",e[e.Hanging=2]="Hanging"}(g||(g={}))},95364:(e,t,s)=>{s.d(t,{H:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_UserStore_UserProfileResponseAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},91479:(e,t,s)=>{s.d(t,{t:()=>n});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_UserStore_UserProfileSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},91222:(e,t,s)=>{var o;s.d(t,{X:()=>o}),function(e){e.TURN_OFF_PERSONALIZATION="0",e.TURN_ON_PERSONALIZATION="1",e.TOGGLE_PERSONALIZATION="2",e.SET_PROFILE="3",e.GET_PROFILE="4",e.DELETE_PROFILE="5"}(o||(o={}))},39526:(e,t,s)=>{var o,n,i,r,a,c;s.d(t,{$O:()=>i,El:()=>a,Y3:()=>o,o2:()=>n,sP:()=>c,wM:()=>r}),function(e){e.UNKNOWN="Unknown",e.CONNECTION_RETRY="ConnectionRetry",e.CONNECTION_RETRY_FAILURE="ErrorConnectionRetryFailure",e.SPEECH_HANDLER_WS_FAILURE="ErrorSpeechHandlerWebSocketFailure",e.PROTOBUF_DESERIALIZATION_FAILURE="ErrorProtobufDeserializationFailure",e.EXPLICITLY_DISABLED="ExplicitlyDisabled",e.SPEECH_RECOGNITION_CANCELED="ErrorSpeechRecognitionCanceled"}(o||(o={})),function(e){e.INTERMITTENT="Intermittent",e.FINAL="Final"}(n||(n={})),function(e){e.NO_DICTATION="NoDictation",e.NO_COMMANDING="NoCommanding",e.NO_TOKEN="NoPfaToken"}(i||(i={})),function(e){e.version1="1",e.version2="2"}(r||(r={})),function(e){e[e.NoMatch=0]="NoMatch"}(a||(a={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.UPLOADING="UPLOADING",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(c||(c={}))},97104:(e,t,s)=>{s.d(t,{A:()=>n});var o=function(){function e(e){this.mergeDictationSettings(e)}return e.prototype.mergeDictationSettings=function(e){var t=this;Object.keys(e).forEach((function(s){t[s]=e[s]}))},e}(),n=function(){function e(){}return Object.defineProperty(e,"dictationSettings",{get:function(){if(e._instance)return e._instance;throw new Error("Dictation Settings not initialized")},set:function(t){e._instance?e._instance.mergeDictationSettings(t):e._instance=new o(t)},enumerable:!1,configurable:!0}),e}()},48455:(e,t,s)=>{s.d(t,{Al:()=>u,D_:()=>c,Pm:()=>a,U1:()=>p,ZF:()=>i,_K:()=>l,lM:()=>r,mh:()=>n});var o=s(82076),n=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextPartialResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechSessionEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechQualityEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyOutput"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),p=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},20880:(e,t,s)=>{s.d(t,{Qu:()=>r,VR:()=>i,jP:()=>n});var o=s(82076),n=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyInput"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionConversation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},21885:(e,t,s)=>{s.r(t),s.d(t,{AudioMode:()=>c,BaseVoiceCommandResult:()=>T,BaseVoiceCommandSuggestion:()=>w,BatchTranscriptionConversation:()=>y.Qu,BatchTranscriptionErrorCode:()=>u.sP,BatchTranscriptionResult:()=>h.U1,ClientApp:()=>l.jr,CommandSuggestionContextType:()=>n,CommandSuggestionDisplayType:()=>o,DictationEventsType:()=>f.Ff,DictationSettingsManager:()=>p.A,IEventName:()=>l.$O,ISpeechError:()=>l.IZ,QualityStatusCode:()=>l.ZE,SelectionType:()=>r,SelectionWhich:()=>a,SpeechErrorEvent:()=>h.lM,SpeechErrorEventCode:()=>u.Y3,SpeechErrorEventImpact:()=>u.$O,SpeechErrorEventState:()=>u.o2,SpeechQualityEvent:()=>h._K,SpeechSessionEvent:()=>h.D_,SpeechSessionEventIds:()=>f.P_,SpeechToTextFinalResult:()=>h.mh,SpeechToTextPartialResult:()=>h.ZF,SpeechToTextProfile:()=>g.A,TraceLevel:()=>l.kp,UtteranceRecognitionType:()=>i,VoiceCommandError:()=>u.El,VoiceCommandInternalResult:()=>C,VoiceCommandRequest:()=>h.Pm,VoiceCommandResultV2:()=>_,VoiceCommandResultsInternalSignal:()=>v,VoiceCommandSuggestion:()=>I,VoiceCommandSuggestionInternalSignal:()=>S,VoiceCommandSuggestionResult:()=>N,VoiceDictationSessionInitiatedSignal:()=>A,VoiceLatencyInput:()=>y.VR,VoiceLatencyOutput:()=>h.Al,VoiceOperation:()=>m,VoiceResponseVersion:()=>u.wM,VoiceTile:()=>y.jP,WordVoiceCommandIds:()=>f.oJ,WordVoiceCommandValueKeys:()=>f.n4,internalCommandIds:()=>f.XH});var o,n,i,r,a,c,l=s(61644),u=s(39526),p=s(97104),g=s(67941),h=s(48455),d=s(82076),m=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),y=s(20880),f=s(29393);!function(e){e.Persistent="Persistent",e.Discardable="Discardable"}(o||(o={})),function(e){e.NONE="none",e.BLANK="blankDocument",e.PARAGRAPH="paragraph",e.LIST="list",e.TABLE="table",e.WHATCANISAY="whatCanISay"}(n||(n={})),function(e){e.Final="Final",e.Fragment="Fragment",e.Hypothesis="Hypothesis"}(i||(i={})),function(e){e.Paragraph="paragraph",e.Sentence="sentence",e.Character="character",e.Word="word",e.That="that",e.This="this",e.Table="table",e.Row="row",e.Column="column",e.Cell="cell",e.Page="page",e.Bullet="bullet",e.To="to",e.Bcc="bcc",e.Cc="cc",e.Subject="subject",e.EmailBody="emailBody",e.Field="field",e.All="all"}(r||(r={})),function(e){e.Next="next",e.Last="last",e.Previous="previous",e.Current="current",e.Left="left",e.Right="right",e.Above="above",e.Below="below",e.Start="start",e.End="end",e.Up="up",e.Down="down",e.Before="before",e.After="after",e.Beginning="start"}(a||(a={})),function(e){e.Play="play",e.Pause="pause",e.Resume="resume"}(c||(c={}));var T=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),_=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultV2"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),C=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandInternalResult"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),v=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultsInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),S=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),A=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceDictationSessionInitiatedSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),w=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),I=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandSuggestion","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),N=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},61644:(e,t,s)=>{var o,n,i,r,a,c;s.d(t,{$O:()=>r,IZ:()=>i,ZE:()=>a,jr:()=>n,kp:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(n||(n={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(i||(i={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(a||(a={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(c||(c={}))},67941:(e,t,s)=>{var o;s.d(t,{A:()=>o}),function(e){e.Dictation="Dictation",e.Transcription="Transcription",e.ConversationTranscription="ConversationTranscription"}(o||(o={}))},29393:(e,t,s)=>{var o;s.d(t,{Ff:()=>r,P_:()=>i,XH:()=>a,n4:()=>n,oJ:()=>o}),function(e){e.Bold="Word.Editing.Bold",e.CenterJustify="Word.Editing.CenterJustify",e.CreateBulletList="Word.Editing.CreateBulletList",e.CreateNumberedList="Word.Editing.CreateNumberedList",e.Delete="Word.Editing.Delete",e.Deselect="Word.Editing.Deselect",e.Exit="Command.Exit",e.ExitList="Word.Editing.ExitList",e.FullJustify="Word.Editing.FullJustify",e.Highlight="Word.Editing.Highlight",e.SetFont="Word.Editing.SetFont",e.InsertText="Word.Editing.InsertText",e.InsertBullet="Word.Editing.InsertBullet",e.InsertComment="Word.Editing.InsertComment",e.InsertEmoji="Word.Editing.InsertEmoji",e.InsertTable="Word.Editing.Table.Insert",e.DeleteTable="Word.Editing.Table.Delete",e.NavigateTable="Word.Editing.Table.Navigate",e.Navigation="Word.Editing.Navigation",e.InsertSpace="Word.Editing.InsertSpace",e.Italics="Word.Editing.Italics",e.LeftJustify="Word.Editing.LeftJustify",e.NewLine="Word.Editing.NewLine",e.NextBullet="Word.Editing.NextBullet",e.NextLine="Word.Editing.NextLine",e.Pause="Command.Pause",e.Paste="Word.Editing.Paste",e.ReadBack="Word.Editing.ReadBack",e.Redo="Word.Editing.Redo",e.RightJustify="Word.Editing.RightJustify",e.RemoveBold="Word.Editing.RemoveBold",e.RemoveItalics="Word.Editing.RemoveItalics",e.RemoveUnderline="Word.Editing.RemoveUnderline",e.RemoveHighlight="Word.Editing.RemoveHighlight",e.RemoveSuperscript="Word.Editing.RemoveSuperscript",e.RemoveStrikeThrough="Word.Editing.RemoveStrikeThrough",e.RemoveSubscript="Word.Editing.RemoveSubscript",e.RemoveFormatting="Word.Editing.RemoveFormatting",e.Quote="Word.Editing.Quote",e.Select="Word.Editing.Select",e.Superscript="Word.Editing.Superscript",e.Subscript="Word.Editing.Subscript",e.StrikeThrough="Word.Editing.StrikeThrough",e.ShowHelp="Command.ShowHelp",e.ShowCommands="Command.ShowCommand",e.Undo="Word.Editing.Undo",e.Underline="Word.Editing.Underline",e.IncreaseIndent="Word.Editing.IncreaseIndent",e.DecreaseIndent="Word.Editing.DecreaseIndent",e.Backspace="Word.Editing.Backspace",e.VoiceCommand="Command.VoiceCommand",e.Type="Command.Type",e.ShrinkFont="Word.Editing.ShrinkFont",e.GrowFont="Word.Editing.GrowFont",e.AllCaps="Word.Editing.AllCaps",e.SentenceCase="Word.Editing.SentenceCase",e.LowerCase="Word.Editing.LowerCase",e.Tab="Word.Editing.Tab",e.ZoomOut="Word.View.ZoomOut",e.ZoomIn="Word.View.ZoomIn",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ShowOutline="Word.View.ShowOutline",e.PageBreak="Word.Editing.PageBreak",e.ResumeDictation="Word.Editing.ResumeDictation",e.Correction="Word.Editing.Correction",e.Style="Word.Editing.Style",e.CorrectionOption="Word.Editing.CorrectionOption",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions",e.Send="Outlook.Send",e.Cancel="Outlook.Cancel",e.Yes="Outlook.Yes",e.AddRecipient="Outlook.AddRecipient",e.AtMention="Outlook.AtMention",e.FieldEdit="Outlook.FieldEdit",e.MoonshotAbout="Annotation.Document.About",e.MoonshotReadFromBeginning="Annotation.Document.FromBeginning",e.MoonshotKeyPoints="Annotation.Document.KeyPoints",e.MoonshotOutline="Annotation.Document.Outline",e.MoonshotReadInFull="Annotation.Document.ReadInFull",e.MoonshotSummarize="Annotation.Document.Summary",e.MoonshotMicrophoneOff="Audio.MicrophoneOff",e.MoonshotPause="Audio.Pause",e.MoonshotPlay="Audio.Play",e.MoonshotReplay="Audio.Replay",e.MoonshotSlowDown="Audio.SlowDown",e.MoonshotSpeedUp="Audio.SpeedUp",e.MoonshotReadSection="Document.Action.ReadSection",e.MoonshotRepeat="Document.Action.Repeat",e.MoonshotReview="Document.Action.Review",e.MoonshotDocumentAge="Document.Metadata.Age",e.MoonshotDocumentAuthor="Document.Metadata.Author",e.MoonshotDocumentHits="Document.Metadata.Hits",e.MoonshotDocumentLength="Document.Metadata.Length",e.MoonshotDocumentPreview="Document.Metadata.Preview",e.MoonshotDocumentTitle="Document.Metadata.Title",e.MoonshotNo="General.No",e.MoonshotYes="General.Yes",e.MoonshotIntro="intro",e.MoonshotNextDocument="Navigate.Document.Next",e.MoonshotPreviousDocument="Navigate.Document.Previous",e.ExcelIntent="ExcelIntent",e.InternalReadBack="Internal.Word.Editing.ReadBack",e.NoOp="NoOp"}(o||(o={}));var n,i,r,a=new Set([o.InternalReadBack]);!function(e){e.TableColumns="Word.Editing.InsertTable.TableColumns",e.TableRows="Word.Editing.InsertTable.TableRows",e.SelectionType="Word.Editing.ActOnSelection.SelectionType"}(n||(n={})),function(e){e.SpeechRecognitionStarted="SpeechRecognitionStarted",e.SpeechRecognitionStopped="SpeechRecognitionStopped",e.SpeechSessionStarted="SpeechSessionStarted",e.SpeechSessionStopped="SpeechSessionStopped"}(i||(i={})),function(e){e.MicrophoneError="ErrorAudioCaptureAsync"}(r||(r={}))},46086:(e,t,s)=>{s.d(t,{H:()=>n});var o=s(82076);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_WordCopilotApp_WordCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_WordCopilotApp_WordHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffInternalMessage","AugLoop_HandoffSkill_HandoffProperties","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},42265:(e,t,s)=>{s.d(t,{KX:()=>i,ZQ:()=>n,hs:()=>r});var o=s(82076);class n{constructor(e){o.h.assign(n,this,e)}static getTypeName(){return"AugLoop_WordCopilotApp_WordCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_WordCopilotApp_WordCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_WordCopilotApp_WordHandoffMessageId"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffMessageId","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},87099:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AudioStreamPerfTracker=t.RunningAveragesTracker=t.getOffsetAndDurationInMs=void 0;var o=s(93004),n=s(49601);t.getOffsetAndDurationInMs=function(e){return{offsetMs:e.Offset/1e4,durationMs:e.Duration/1e4}};var i=function(){function e(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}return e.prototype.add=function(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)},e.prototype.getAverages=function(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}},e}();t.RunningAveragesTracker=i;var r=function(){function e(e,t){this.finals=new i,this.partials=new i,this.getNow=n.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=null!=t?t:n.now}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),e.prototype.getChunk=function(e){return this.list[e]},e.prototype.track=function(e,t,s){var n={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:s},i=this.list.length-1;if(-1===i||n.audioStart>=this.list[i].audioEnd)this.list.push(n);else if(n.audioEnd<=this.list[0].audioStart)this.list.unshift(n);else{for(;i>0&&n.audioEnd<this.list[i].audioStart;)i--;if(i>=0&&n.audioStart===this.list[i].audioStart)throw new Error("Why are we double tracking the same chunk of audio? newChunk: ".concat(JSON.stringify(n),", existing chunk: ").concat(JSON.stringify(this.list[i])));this.list.splice(i,0,n)}if(this.list.length>this.maxListLength){var r=this.list.length-this.maxListLength;this.list.splice(0,r),o.Log.warn(572662883,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.track: list length has exceeded max by ".concat(r," items!"))}else this.list.length>=this.warnListLength&&o.Log.warn(572662912,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.track: list length: ".concat(this.list.length," approaching max: ").concat(this.maxListLength))},e.prototype.trimBefore=function(e){if(0!==this.list.length){for(var t="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),s=0;s<this.list.length&&this.list[s].audioEnd<e;)s++;s===this.list.length&&o.Log.warn(561628760,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ".concat(e,". List length: ").concat(this.list.length,", audio span: ").concat(t));var n=this.list.splice(0,s),i=n.length>0?"".concat(n[0].audioStart," to ").concat(n[n.length-1].audioEnd):"none",r=this.list.length>0?"".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd):"none";o.Log.info(572662914,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: audioEnd: ".concat(e,", culling ").concat(n.length," chunks (audio span ").concat(i,"), new list.length: ").concat(this.list.length,". Audio span was: ").concat(t,", now: ").concat(r))}else o.Log.info(572662913,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!")},e.prototype.clear=function(){o.Log.info(506045275,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.clear: clearing all ".concat(this.list.length," entries")),this.list.splice(0,this.list.length)},e.prototype.getChunksFrom=function(e,t){for(var s,o,n=e+t,i=0;i<this.list.length&&(!s||!o);){var r=this.list[i];!s&&e>=r.audioStart&&e<=r.audioEnd&&(s=r),!o&&n>=r.audioStart&&n<=r.audioEnd&&(o=r),i++}return[s,o]},e.prototype.measureLatency=function(e,t,s){var n=this.getNow(),i=e+t,r=this.getChunksFrom(e,t),a=r[0],c=r[1];if(!a&&!c)return o.Log.warn(572662915,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ".concat(i," (").concat(e," + ").concat(t,")")),{service:-1,perceived:-1};if(!a||!c){var l=a?"end":"start",u="none",p=NaN;this.list.length>0&&(u="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),p=a?i-this.list[this.list.length-1].audioEnd:i-this.list[0].audioStart),o.Log.warn(572662916,o.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ".concat(l," of audio, for speechEnd: ").concat(i," (").concat(e," + ").concat(t,"), tracked audio span: ").concat(u,", delta: ").concat(p))}var g=n-Math.max((null==a?void 0:a.localEnd)||0,(null==c?void 0:c.localEnd)||0),h=a?this.getLatencyForChunk(a,e,t,n):-1,d=c?this.getLatencyForChunk(c,i,0,n):-1,m={service:g,perceived:Math.max(h,d)};return(s?this.finals:this.partials).add(m),m},e.prototype.getLatencyForChunk=function(e,t,s,o){return o-(e.localEnd-(e.audioEnd-t))-s},e}();t.AudioStreamPerfTracker=r},12268:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechErrorHandler=void 0;var o=s(21885),n=s(93004),i=function(){function e(){}return e.eventToMsg=function(e){switch(e){case"ConnectionRetry":return"Frontdoor Websocket Connection Retry";case"ErrorConnectionRetryFailure":return"Frontdoor Websocket Connection Retry Failed after MaxConnectionRetry";case"ErrorSpeechHandlerWebSocketFailure":return"Frontdoor Speech Handler Websocket Failure";case"ErrorProtobufDeserializationFailure":return"Frontdoor Protobuf Deserialization Failure";case"ErrorSpeechRecognitionCanceled":return"Frontdoor Speech Recognition canceled error";default:return e}},e.eventToErrorCode=function(e){switch(e){case"ConnectionRetry":return o.SpeechErrorEventCode.CONNECTION_RETRY;case"ErrorConnectionRetryFailure":return o.SpeechErrorEventCode.CONNECTION_RETRY_FAILURE;case"ErrorSpeechHandlerWebSocketFailure":return o.SpeechErrorEventCode.SPEECH_HANDLER_WS_FAILURE;case"ErrorProtobufDeserializationFailure":return o.SpeechErrorEventCode.PROTOBUF_DESERIALIZATION_FAILURE;case"ErrorSpeechRecognitionCanceled":return o.SpeechErrorEventCode.SPEECH_RECOGNITION_CANCELED;default:return o.SpeechErrorEventCode.UNKNOWN}},e.sendSpeechErrorEvent=function(e,t,s,i,r){if(e){var a=new o.SpeechErrorEvent({ErrorCode:t,ErrorMsg:s,ErrorState:i,ErrorImpact:r});e.setAnnotations(null,o.SpeechErrorEvent.getTypeName(),[a],{isSessionAnnotation:!0,immediate:!0})}else n.Log.warn(571013264,n.LogCategory.WorkflowDefault,"AL current Actions missing, won't emit SpeechErrorEvent to client.")},e}();t.SpeechErrorHandler=i},45369:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completePromiseWithin=void 0;var o=s(93004);t.completePromiseWithin=function(e,t,s){return e<=0?s:new Promise((function(n,i){var r=!1,a=setTimeout((function(){r||(r=!0,i(new Error("Timeout after ".concat(e,"ms. ").concat(t))))}),e);s.then((function(e){r||(r=!0,clearTimeout(a),n(e))}),(function(e){o.Log.error(539821445,o.LogCategory.WorkflowDefault,e),r||(r=!0,clearTimeout(a),i(e))}))}))}},32130:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedValueTracker=t.completePromiseWithin=t.getOffsetAndDurationInMs=t.AudioStreamPerfTracker=void 0;var i=s(87099);Object.defineProperty(t,"AudioStreamPerfTracker",{enumerable:!0,get:function(){return i.AudioStreamPerfTracker}}),Object.defineProperty(t,"getOffsetAndDurationInMs",{enumerable:!0,get:function(){return i.getOffsetAndDurationInMs}});var r=s(45369);Object.defineProperty(t,"completePromiseWithin",{enumerable:!0,get:function(){return r.completePromiseWithin}});var a=s(54358);Object.defineProperty(t,"SequencedValueTracker",{enumerable:!0,get:function(){return a.SequencedValueTracker}}),n(s(12268),t)},54358:function(e,t,s){var o=this&&this.__spreadArray||function(e,t,s){if(s||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedValueTracker=void 0;var n=s(93004),i=function(){function e(e){this.list=e?o([],e,!0):[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.list.map((function(e){return e.seq}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.list.map((function(e){return e.value}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){if(0!==this.list.length)return this.list[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){if(0!==this.list.length)return this.list[this.list.length-1]},enumerable:!1,configurable:!0}),e.prototype.clear=function(){n.Log.info(528794771,n.LogCategory.WorkflowDefault,"Clearing tracked values. Old length: ".concat(this.length)),this.list=[]},e.prototype.track=function(e,t){var s=this.list.find((function(t){return t.seq===e}));if(s){if(s.value===t)return;throw new Error("Cannot double-track the same sequence: #".concat(e,"! Previous value: ").concat(s.value,", new value: ").concat(t))}var o={seq:e,value:t};if(0===this.list.length||this.last.seq<e)this.list.push(o);else{var i=this.getIndexBefore(e);this.list.splice(i+1,0,o)}n.Log.info(528794772,n.LogCategory.WorkflowDefault,"track #".concat(e,': "').concat(t,'" (new length: ').concat(this.length,")"))},e.prototype.valueAt=function(e){if(null!=e)if(0!==this.list.length){var t=this.getIndexBefore(e);if(!(t<0))return n.Log.info(528794776,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - found: "),this.list[t]),this.list[t];n.Log.info(528794775,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - found nothing prior"))}else n.Log.info(528794774,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - nothing is tracked"));else n.Log.info(528794773,n.LogCategory.WorkflowDefault,"valueAt #".concat(e," - nothing is tracked"))},e.prototype.trimUntil=function(e,t){void 0===t&&(t=!1);var s=this.getIndexBefore(e);t&&s--,n.Log.info(528794777,n.LogCategory.WorkflowDefault,"trimUntil #".concat(e," - preserveLast:").concat(t,", removing up to idx: ").concat(s)),s>=0&&this.list.splice(0,s+1)},e.prototype.getIndexBefore=function(e){for(var t=this.list.length-1;t>=0&&this.list[t].seq>e;)t--;return t},e}();t.SequencedValueTracker=i},21332:(e,t,s)=>{t.pR=t.O7=t.i6=t.Jq=t.wS=t._C=void 0;const o=s(90943);var n,i;!function(e){e[e.Person=0]="Person",e[e.NonPerson=1]="NonPerson",e[e.File=2]="File",e[e.WordDocument=3]="WordDocument",e[e.Powerpoint=4]="Powerpoint",e[e.PDF=5]="PDF",e[e.Excel=6]="Excel",e[e.Meeting=7]="Meeting",e[e.Chat=8]="Chat",e[e.Email=9]="Email",e[e.Unknown=10]="Unknown"}(n||(n={})),function(e){e[e.PastMeeting=0]="PastMeeting",e[e.FutureMeeting=1]="FutureMeeting",e[e.Unknown=2]="Unknown"}(i||(i={}));const r="from";t._C={"whats the latest from":n.Person,"when is my next meeting with":n.Person,"what s the latest from":n.Person,"when s my next meeting with":n.Person,"what did":n.Person,recap:n.Meeting,"draft an email with action items from":n.Meeting,"what are the unresolved issues from":n.Meeting,"help me prepare for my next meeting":n.Meeting,"what were the key takeaways from":n.Meeting,"what are the key takeaways from":n.Meeting,"list key points from":n.File,"create a faq based on":n.File,"propose a new introduction to":n.File,"suggest edits make this more concise":n.File},t.wS={"¿cuáles fueron los problemas abiertos de":i.PastMeeting,"¿cuáles fueron los problemas abiertos de la":i.PastMeeting,"rédige un courriel contenant des notes et des éléments d’action de la":i.PastMeeting,"rédige un e-mail contenant des notes et des éléments d’action de la":i.PastMeeting,"crea una bozza di e-mail con le note e le attività definite durante la":i.PastMeeting,"entwirf eine e-mail mit notizen und aktionselementen aus":i.PastMeeting,"redacta un borrador de correo electrónico con notas y acciones de":i.PastMeeting,使用来自:i.PastMeeting,"draft an email with notes and action items from":i.PastMeeting,"¿cuáles son los elementos de acción de":i.PastMeeting,"elabore um email com anotações e itens de ação":i.PastMeeting,"was waren die offenen fragen in":i.PastMeeting,"what were the open issues from":i.PastMeeting,"quels étaient les problèmes en suspens par rapport à la":i.PastMeeting,"quali sono state le questioni discusse nella":i.PastMeeting,"quais foram os problemas em aberto da":i.PastMeeting,"what are the action items from":i.PastMeeting,"quali sono le attività da svolgere definite nella":i.PastMeeting,"was sind die aktionselemente aus":i.PastMeeting,"quels sont les points d'action issus de la":i.PastMeeting,"quais são os itens de ação da":i.PastMeeting,recap:i.PastMeeting,"resuma a":i.PastMeeting,"récap. la":i.PastMeeting,"resume las conclusiones y elementos de acción de la":i.PastMeeting,"crea un riepilogo della":i.PastMeeting,回顾:i.PastMeeting,récap:i.PastMeeting},t.Jq={"のオープンしている問題は何でしたか?":i.PastMeeting,"を要約し、主要な要点とアクション アイテムを別のセクションとしてまとめ、各責任者を含めます":i.PastMeeting,"中的未解决问题有哪些?":i.PastMeeting,"のアクション アイテムは何ですか?":i.PastMeeting,"中的拟办事项有哪些?":i.PastMeeting,"zusammen, mit ergebnissen/aktionselementen als abschnitten, mit zuständigen.":i.PastMeeting,"のメモとアクション アイテムを含むメールの下書きを作成します":i.PastMeeting},t.i6={"latest from":n.Person,"manager of":n.Person,who:n.Person,"who is":n.Person,message:n.NonPerson,messages:n.NonPerson,summarize:n.NonPerson,concise:n.NonPerson,elaborate:n.NonPerson,"introduction to":n.NonPerson,"points from":n.NonPerson,"items from":n.NonPerson,"issues from":n.NonPerson,"based on":n.NonPerson,in:n.NonPerson,meeting:n.Meeting,event:n.Meeting,meet:n.Meeting,sync:n.Meeting,"sync up":n.Meeting,call:n.Meeting,huddle:n.Meeting,scrum:n.Meeting,conference:n.Meeting,conf:n.Meeting,review:n.Meeting,discussion:n.Meeting,brief:n.Meeting,briefing:n.Meeting,appointment:n.Meeting,recap:n.Meeting,"prepare for":n.Meeting,"prep for":n.Meeting,file:n.File,files:n.File,document:n.WordDocument,documents:n.WordDocument,doc:n.WordDocument,word:n.WordDocument,docx:n.WordDocument,excel:n.Excel,sheet:n.Excel,spreadsheet:n.Excel,"spread sheet":n.Excel,presentation:n.Powerpoint,deck:n.Powerpoint,powerpoint:n.Powerpoint,"power point":n.Powerpoint,ppt:n.Powerpoint,pptx:n.Powerpoint,pdf:n.PDF,email:n.Email,emails:n.Email,"e mail":n.Email,"e mails":n.Email,chat:n.Chat,chats:n.Chat,group:n.Chat,groups:n.Chat,conversation:n.Chat,conversations:n.Chat};const a=new Set(["with","to","by"]);function c(e){let s=n.Unknown;const o=d(e);if(t._C.hasOwnProperty(o))return t._C[o];const i=o.split(" "),c=i[i.length-1];if(t.i6.hasOwnProperty(c)&&(s=t.i6[c]),i.length>=2){const e=i.slice(Math.max(0,i.length-2)).join(" ");t.i6.hasOwnProperty(e)&&(s=t.i6[e]);const o=i[i.length-2];(c===r&&t.i6.hasOwnProperty(o)||a.has(c))&&(s=n.Person)}return s}function l(e,s){const o=e.trim().toLowerCase();if(t.wS.hasOwnProperty(o))return t.wS[o];if(s){const e=s.trim().toLowerCase();if(t.Jq.hasOwnProperty(e))return t.Jq[e]}return i.Unknown}function u(e){const s=d(e).split(" "),o=Math.min(s.length,5),n=s.slice(Math.max(0,s.length-o)).join(" ");for(const e in t.O7)if(n.includes(e))return t.O7[e];return i.Unknown}function p(e){const t=[];if(void 0!==e&&e!==n.Unknown)switch(e){case n.Person:t.push({name:"#people#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.NonPerson:t.push({name:"#people#",scope:o.IntentScope.FirstParty,score:0,confidenceLevel:o.IntentConfidenceLevel.Low,highConfidenceSign:!1});break;case n.File:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.WordDocument:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"doc"},{slotName:"file_type",slotValue:"docx"}],highConfidenceSign:!0});break;case n.Powerpoint:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"ppt"},{slotName:"file_type",slotValue:"pptx"}],highConfidenceSign:!0});break;case n.PDF:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"pdf"}],highConfidenceSign:!0});break;case n.Excel:t.push({name:"#file#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"xls"},{slotName:"file_type",slotValue:"xlsx"}],highConfidenceSign:!0});break;case n.Meeting:t.push({name:"#event#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Chat:t.push({name:"#chat#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Email:t.push({name:"#email#",scope:o.IntentScope.FirstParty,score:1,confidenceLevel:o.IntentConfidenceLevel.High,highConfidenceSign:!0})}return t}function g(e,t,s){const n=function(e,t){let s;if(void 0!==e&&e!==i.Unknown)switch(e){case i.FutureMeeting:s={name:"#event#",scope:o.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?o.IntentConfidenceLevel.High:o.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"future"}],highConfidenceSign:!!t};break;case i.PastMeeting:s={name:"#event#",scope:o.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?o.IntentConfidenceLevel.High:o.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"past"}],highConfidenceSign:!!t}}return s}(e,s);if(void 0===n)return;const r=t.find((e=>e.name===n.name));r?(r.score=Math.max(r.score,n.score),r.confidenceLevel=Math.max(r.confidenceLevel,n.confidenceLevel),r.highConfidenceSign=r.highConfidenceSign||n.highConfidenceSign,r.slots=h(r.slots,n.slots)):t.push(n)}function h(e,t){if(t){if(e){const s=t.filter((t=>!e.some((e=>t.slotName===e.slotName))));return[...e,...s]}return t}return e}function d(e){let t=e.toLowerCase().trim().replace(/[^\w\s]/g," ").trim().toLowerCase();return t=t.replace(/\s+/g," "),t}t.O7={"prepare for":i.FutureMeeting,"prep for":i.FutureMeeting,"prepare me for":i.FutureMeeting,"prep me for":i.FutureMeeting,"next meeting":i.FutureMeeting,"next event":i.FutureMeeting,"next sync":i.FutureMeeting,"next call":i.FutureMeeting,upcoming:i.FutureMeeting,"to be discussed":i.FutureMeeting,recap:i.PastMeeting,"last meeting":i.PastMeeting,"previous meeting":i.PastMeeting,summarize:i.PastMeeting,"summary of":i.PastMeeting,"points from":i.PastMeeting,"items from":i.PastMeeting,"takeaways from":i.PastMeeting,discussed:i.PastMeeting,"issues from":i.PastMeeting,"based on":i.PastMeeting},t.pR=function(e,t){var s,o;if((null!==(s=null==e?void 0:e.length)&&void 0!==s?s:0)<=0&&(null!==(o=null==t?void 0:t.length)&&void 0!==o?o:0)<=0)return;const n=p(c(e)),r=l(e,t);return r!==i.Unknown?g(r,n,!0):g(u(e),n),n}},24951:(e,t,s)=>{var o=s(58651);Object.defineProperty(t,"__esModule",{value:!0}),t.buildEmscriptenCustomContextFromSite=t.buildEmscriptenCustomContext=void 0;const n=s(54421);function i(e,t){function s(e,t,s,o){const n=function(e,t,s){const o=new Headers,n=s.keys();for(let e=0;e<n.size();e++){const t=n.get(e);o.append(t,s.get(t))}const i={};return i.method=e,void 0!==t&&(i.body=t),n.size()>0&&(i.headers=o),n.delete(),i}(t,s,o);let i=0;return fetch(e,n).then((e=>{if(i=e.status,!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((e=>({bufferArray:new Uint8Array(e),length:e.byteLength,isError:!1,statusCode:i}))).catch((e=>{const t=e;return t.isError=!0,t.statusCode=i,t}))}function i(e,t,s){if(e||t&&0!==t.length){if(e){const t=e;return t.isError=!0,t}return{token:t,ttl:s?s.timeToLiveSec:void 0}}return{name:"Missing Token",message:"Unable to fetch token",isError:!0}}function r(e){if(!e)return;const t=new Map,s=e.keys();for(let o=0;o<s.size();o++){const n=s.get(o);t.set(n,e.get(n))}return t}function a(e,t){return new Promise((async(s,o)=>{try{if(!e.run)throw new Error("WorkflowSite is unimplemented.");const o=await e.run(t);if(!o)throw new Error("Outputs returned as undefined.");s(o)}catch(e){const t=e;t.isError=!0,s(t)}}))}function c(e,t,s){if(!e||!e.run){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void s(e)}const o=s.clone();e.run(t).then((e=>{if(!e)throw new Error("Outputs returned as undefined.");o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))}const l={createModel:function(t){return new Promise((async(s,o)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const o=await e.site.createModel(t);o.customRun=a.bind(null,o),o.customRunInCallback=c.bind(null,o),s(o)}catch(e){const t=e;t.isError=!0,s(t)}}))},createModelInCallback:function(t,s){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void s(e)}const o=s.clone();e.site.createModel(t).then((e=>{e.customRun=a.bind(null,e),e.customRunInCallback=c.bind(null,e),o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))},createModelInputs:function(){return new Promise((async(t,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");t(await e.site.createModelInputs())}catch(e){const s=e;s.isError=!0,t(s)}}))},createModelInputsInCallback:function(t){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void t(e)}const s=t.clone();e.site.createModelInputs().then((e=>{s.opcall(e)})).catch((e=>{const t=e;t.isError=!0,s.opcall(t)})).finally((()=>{s.delete()}))}},u={};return u.docSessionId=e.clientMetadata.docSessionId,u.getToken=function(t){return new Promise(((s,o)=>{e.getToken(t,((e,t,o)=>{if(e||t&&0!==t.length)if(e){const t=e;t.isError=!0,s(t)}else s(t);else s({name:"Missing Token",message:"Unable to fetch token",isError:!0})}))}))},u.getTokenWithPropertiesAsync=function(t){return new Promise(((s,o)=>{e.getToken(t,((e,t,o)=>{const n=i(e,t,o);s(n)}))}))},u.getTokenWithPropertiesInCallback=function(t,s){const o=s.clone();e.getToken(t,((e,t,s)=>{const n=i(e,t,s);o.opcall(n),o.delete()}))},u.getResourceAsUrlInCallback=function(t,s,o,n){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void n(e)}const i=n.clone();e.site.getResourceAsURL(t,s,r(o)).then((e=>{const t=Object.entries(e),s=new Map(t);i.opcall(s)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))},u.httpRequest=s,u.httpRequestInCallback=function(e,t,o,n,i){const r=i.clone();s(e,t,o,n).then((e=>{r.opcall(e)})).catch((e=>{})).finally((()=>{r.delete()}))},u.copyUint8ArrayToWasmMemory=function(e,s){t().HEAPU8.set(e,s)},u.copyUint16ArrayToWasmMemory=function(e,s){t().HEAPU16.set(e,s>>1)},u.copyUint32ArrayToWasmMemory=function(e,s){t().HEAPU32.set(e,s>>2)},u.copyInt8ArrayToWasmMemory=function(e,s){t().HEAP8.set(e,s)},u.copyInt16ArrayToWasmMemory=function(e,s){t().HEAP16.set(e,s>>1)},u.copyInt32ArrayToWasmMemory=function(e,s){t().HEAP32.set(e,s>>2)},u.copyFloat32ArrayToWasmMemory=function(e,s){t().HEAPF32.set(e,s>>2)},u.copyFloat64ArrayToWasmMemory=function(e,s){t().HEAPF64.set(e,s>>3)},u.getResourceAsUrl=function(t,s,o){return new Promise((async(n,i)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const i=await e.site.getResourceAsURL(t,s,r(o)),a=Object.entries(i);n(new Map(a))}catch(e){const t=e;t.isError=!0,n(t)}}))},u.getResourceAsByteArray=function(t,s,n){return new Promise((async(i,a)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const a=await e.site.getResourceAsArrayBuffer(t,s,r(n)),c=new Map;for(const[e,t]of Object.entries(a)){o.log(e,t);const s=new Uint8Array(t),n={};n.bufferArray=s,n.length=t.byteLength,c.set(e,n)}i(c)}catch(e){const t=e;t.isError=!0,i(t)}}))},u.site=l,u.context=e,u.logOperationClass=n.Operation,u.logInfoFunction=n.Log.info.bind(null,0,n.LogCategory.WorkflowDefault),u.dummyPromise=Promise.resolve("Success"),u.logDebugTrace=function(e,t){n.Log.debug(e,n.LogCategory.WorkflowDefault,t)},u.logInfoTrace=function(e,t){n.Log.info(e,n.LogCategory.WorkflowDefault,t)},u.logWarnTrace=function(e,t){n.Log.warn(e,n.LogCategory.WorkflowDefault,t)},u.logErrorTrace=function(e,t){n.Log.error(e,n.LogCategory.WorkflowDefault,t)},u.getUserContext=function(){if(!e.userContext)return;const t={UserContextObject:e.userContext};return JSON.stringify(t)},u}t.buildEmscriptenCustomContext=i,t.buildEmscriptenCustomContextFromSite=function(e,t){return i({clientMetadata:void 0,getToken:function(e,t){throw new Error("GetToken not available in init.")},site:e},t)}},48521:function(e,t,s){var o=this&&this.__createBinding||(Object.create?function(e,t,s,o){void 0===o&&(o=s);var n=Object.getOwnPropertyDescriptor(t,s);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,o,n)}:function(e,t,s,o){void 0===o&&(o=s),e[o]=t[s]}),n=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||o(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),n(s(28517),t),n(s(24951),t)},28517:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmWebFromModularizeFunction=void 0;const o=s(54421),n=new Set,i=new Map,r="function"==typeof globalThis.importScripts;function a(e,t){e.src=t}function c(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function l(e,t,s,n,i){if(!n)return!1;const r=i||c;return!!r()[e+"Module"]&&(t.resultDescription="Module Loaded From Cache",o.Log.info(538576341,o.LogCategory.WorkflowDefault,t.stop()),s(r()[e+"Module"]),!0)}t.loadWasmWebFromModularizeFunction=async function(e,t,s,u,p,g,h){const d=new o.Operation({operationName:"LoadWasmWebFromModularizeFunction",success:!0,resourceId:s,resultDescription:""}).start();return new Promise(((m,y)=>{if(l(t,d,m,u,g))return;const f=()=>{if(l(t,d,m,u,g))return;if(!self[t])return d.success=!1,d.resultDescription="ModularizeFunction Missing",o.Log.info(538576343,o.LogCategory.WorkflowDefault,d.stop()),void y(new Error("ModularizeFunction Missing"));const e={};void 0!==p&&(e.locateFile=p),e.onAbort=function(e){const t=new o.Operation({operationName:"WasmCrashHappenedOnAbortCalled",resourceId:s}).start();"string"==typeof e&&(t.resultDescription=e),o.Log.error(509154189,o.LogCategory.WorkflowDefault,t.stop())},self[t](e).then((e=>{!function(e,t,s,n,a,u){var p;if(l(e,t,s,n,u))return;r&&(globalThis.top=self);const g=u||c;n&&(g()[e+"Module"]=a,null===(p=i.get(e))||void 0===p||p.forEach((t=>{t.onSuccess(g()[e+"Module"])})),i.set(e,[])),t.dimension0=n.toString(),o.Log.info(512237901,o.LogCategory.WorkflowDefault,t.stop()),s(a)}(t,d,m,u,e,g)})).catch((e=>{var s,n;d.success=!1,d.resultDescription="ModularizeFunction Failed: "+(null!==(s=e.message)&&void 0!==s?s:"Unknown Error Message"),o.Log.info(512237900,o.LogCategory.WorkflowDefault,d.stop()),null===(n=i.get(t))||void 0===n||n.forEach((t=>{t.onError(e)})),i.set(t,[]),y(e)}))},T=e=>{var s;d.success=!1,d.resultDescription="ScriptLoad Failed: "+("string"==typeof e?e:"Unknown Error Message"),o.Log.info(538706265,o.LogCategory.WorkflowDefault,d.stop()),null===(s=i.get(t))||void 0===s||s.forEach((t=>{t.onError(e)})),i.set(t,[]),y(e)};if(u&&n.has(t)){if(l(t,d,m,u,g))return;let e=i.get(t);void 0===e&&(e=[],i.set(t,e)),e.push({onSuccess:e=>m(e),onError:e=>y(e)})}else!function(e,t,s,o){if(r)try{globalThis.importScripts(e),t()}catch(e){s(e)}else{const n=document.createElement("script");(o||a)(n,e),n.onload=function(){t(),n.remove()},n.onerror=function(e){s(e),n.remove()},document.body.appendChild(n)}}(e,f,T,h);u&&n.add(t)}))}},71283:(e,t,s)=>{s.d(t,{E:()=>o});const o=e=>n(e,Number.POSITIVE_INFINITY),n=(e,t)=>{let s=0;const o=[],n=[e];for(;n.length>0;){const e=n.pop(),i=typeof e;if("boolean"===i)s+=4;else if("string"===i)s+=2*e.length;else if("number"===i)s+=8;else if("object"===i&&e&&-1===o.indexOf(e))if(e instanceof Uint8Array)s+=e.length;else{o.push(e);for(const t in e)n.push(e[t])}if(s>t)return s}return s}},63455:(e,t,s)=>{function o(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}s.d(t,{v4:()=>o})},42389:(e,t,s)=>{s.d(t,{L4:()=>T});var o=s(43109),n=s(87532),i=s(25765),r=s(24205),a=s(82076),c=s(53335),l=s(55875),u=s(18305),p=s(18516),g=s(36712),h=s(85584);const d=e=>"GraphSearchClient"===e.ownerId,m=new Map([["AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid",0],["AugLoop_ObservationalAssistance_EccAnnotationClient",1],["AugLoop_GraphSearch_EccAnnotationHybrid",1],["AugLoop_GraphSearch_PredictionAnnotationHybrid",2],["AugLoop_GraphSearch_NudgeAnnotationHybrid",3]]);class y extends g.c{constructor(e,t){super("GraphSearchJoinWorkflowInstance",e,t)}async execute(e,t,s,n){let r=!1,l=!1;const u=new Date,p=this.startLogOperation("GraphSearchJoinWorkflowExecute",u,t);this.logWasmStats(p);const g=m.get(a.h.getTypeNameFor(t[0]));if(void 0!==g&&p.setDataFields({scenario:g}),2===t.length){if(c.SM.typeGuard(t[0])||c.SM.typeGuard(t[1])){const e=t[d(t[0])?0:1];p.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:s.clientMetadata.sessionId})}if(o.nm.typeGuard(t[0])||o.nm.typeGuard(t[1])){const e=t[d(t[0])?0:1];p.setDataFields({logicalId:e.logicalId,sessionId:s.clientMetadata.sessionId}),"Ignore"===e.entityType&&(l=!0)}}p.setDataFields({dimension0:(new Date).getTime()-u.getTime()}),r=this.executeWorkflowLambda(p,e,s,n,t),l&&!r||i.tG.info(509638786,i.nh.WorkflowDefault,p.stop())}}const f=(e,t)=>new y(e,t),T=(e,t)=>r.a.create("GraphSearchJoinECC").setCollectionScopeType(u.VP.getTypeName()).setInputTypes([c.SM.getTypeName(),o.NG.getTypeName()]).setOutputTypes([l.os.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(f.bind(null,e,t));_=h.aU,C=h.zb,r.a.create("GraphSearchJoinWorkflow").setCollectionScopeType(n.Z5.getTypeName()).setInputTypes([o.J_.getTypeName()]).setOutputTypes([o.VL.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(f.bind(null,_,C));var _,C;((e,t)=>{r.a.create("GraphSearchJoinPrediction").setCollectionScopeType(p.iU.getTypeName()).setInputTypes([o.nm.getTypeName(),o.t9.getTypeName()]).setOutputTypes([c.k2.getTypeName(),c.KL.getTypeName(),l.Vm.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(f.bind(null,e,t))})(h.aU,h.zb),T(h.aU,h.zb)},70108:(e,t,s)=>{s.d(t,{X8:()=>f});var o=s(73449),n=s(25765),i=s(82076),r=s(87532),a=s(43109),c=s(18516),l=s(18305),u=s(53335),p=s(36712),g=s(85584);class h{constructor(e){this.outlookDataHandle=e}getLocalPeopleData(){const e=this.outlookDataHandle.getAllRecipients(),t=[];for(const s of e)t.push({DisplayName:s.displayName,EmailAddresses:[s.emailAddress],Id:s.id,confidence:0,entityType:"",providerName:"",text:""});return t}}const d=new Map([["AugLoop_GraphSearch_SearchSuggestionsRequest",0],["AugLoop_ObservationalAssistance_UserInitiatedRequestClient",1],["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient",2]]);class m extends p.c{constructor(e,t){super("GraphSearchWorkflowInstance",e,t)}async execute(e,t,s){var o;let r=!1,a=!1;const u=new Date,p=this.startLogOperation("GraphSearchWorkflowExecute",u);this.logWasmStats(p);const g=d.get(i.h.getTypeNameFor(e));void 0!==g&&p.setDataFields({scenario:g}),(l.VP.typeGuard(e)||c.iU.typeGuard(e))&&(p.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:t.clientMetadata.sessionId}),c.iU.typeGuard(e)&&0===(null===(o=e.multiIntents)||void 0===o?void 0:o.length)&&(a=!0)),r=this.executeWorkflowLambda(p,e,t,s),a&&!r||n.tG.info(509638755,n.nh.WorkflowDefault,p.stop())}}const y=(e,t)=>new m(e,t),f=(e,t)=>{const s=t.localContext?new h(t.localContext):null;return o.z.create("GraphSearchLocalWorkflowOA").setStateful().setInputTypes([r.$9.getTypeName(),c.iU.getTypeName(),l.VP.getTypeName(),r.zV.getTypeName()]).setOutputTypes([a.nm.getTypeName(),a.t9.getTypeName(),u.SM.getTypeName(),a.NG.getTypeName(),r.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(y.bind(null,{...e,localContext:s},t))};T=g.aU,_=g.zb,o.z.create("GraphSearchLocalWorkflow").setStateful().setInputTypes([r.$9.getTypeName(),r.Z5.getTypeName(),r.zV.getTypeName()]).setOutputTypes([a.J_.getTypeName(),r.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(y.bind(null,T,_));var T,_},36712:(e,t,s)=>{s.d(t,{c:()=>y});var o=s(48521),n=s(85584),i=s(26341),r=s(25765),a=s(89700),c=s(21332);function l(e,t,s){var o;if(!t||void 0===s)return[];const n=t.substring(0,s).trimEnd(),i=t.substring(s+(null!==(o=1+(null==e?void 0:e.length))&&void 0!==o?o:0)).trim();return(0,c.pR)(n,i)||[]}var u=s(87532),p=s(43109),g=s(18305),h=s(4915),d=s(53335),m=s(55875);class y{constructor(e,t,s){this.ariaNamespace="GraphSearch",this.prodAriaToken="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",this.devAriaToken="30d62489eb65462bb3a5c93b0cad786b-0260e5be-afb3-4f7c-a14a-f0b25b00a080-7662",this.isDisposed=!1,this.wasmConfig=s,this.propertyName=e,this.ariaToken=void 0!==t.environment&&t.environment===i.O.dev?this.devAriaToken:this.prodAriaToken;const o=t.scenarios&&t.scenarios.includes(n.Nz.BIZ_CHAT)?{getHeuristicIntents:l}:void 0;this.config={...t,...void 0===t.scenarioLength?{scenarioLength:t.scenarios.length}:{},heuristicIntentsConfig:o};const r=`${s.wasmRoot}/GraphSearchLocalWorkflow.js`;this.wasmConfig={...void 0===s?{}:s,wasmRoot:r}}async init(e,t){var s;const n=this.startLogOperation("GraphSearchWorkflowInstance"===this.propertyName?"GraphSearchWorkflowInit":"GraphSearchJoinWorkflowInit",new Date);n.setDataFields({isPrefetch:this.config.prefetchOnly});try{await this.initializeWasmModule(this.wasmConfig.wasmRoot,this.wasmConfig.locateFile,this.wasmConfig.cacheModule,this.wasmConfig.wasmModuleCache,this.wasmConfig.scriptSrcSetter),this.logWasmStats(n),this.workflowLambda=this.wasmModule[this.propertyName](this.config);const s=t?(0,o.buildEmscriptenCustomContext)(t,(()=>this.wasmModule)):(0,o.buildEmscriptenCustomContextFromSite)(e,(()=>this.wasmModule));this.workflowLambda.init(s)}catch(e){const t=null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:"";n.resultDescription=e&&e.message?`${e.message} // ${t}`:"Unknown error.",n.success=!1}r.tG.info(507573794,r.nh.WorkflowDefault,n.stop())}executeWorkflowLambda(e,t,s,n,i){var a;let c=!1;if(!this.wasmModule||!this.workflowLambda)return e.resultDescription="null lambda",e.success=!1,r.tG.info(507564037,r.nh.WorkflowDefault,e.stop()),"GraphSearchWorkflowInstance"===this.propertyName?this.sendDummyAndTriggerServiceFallback(n,t):this.sendInputAnnotation(n,t,i),!1;try{const e=(0,o.buildEmscriptenCustomContext)(s,this.wasmModule);void 0===i?this.workflowLambda.execute(t,e,n):this.workflowLambda.execute(t,i,e,n)}catch(t){const s=null!==(a=null==t?void 0:t.stack)&&void 0!==a?a:"";e.resultDescription=t&&t.message?`${t.message} // ${s}`:"Unknown error.",e.success=!1,c=!0}return c}dispose(){this.isDisposed=!0,void 0!==this.workflowLambda&&this.workflowLambda.delete(),this.workflowLambda=void 0,this.wasmModule=void 0}async initializeWasmModule(e,t,s=!0,n,i){if(this.wasmModule=await(0,o.loadWasmWebFromModularizeFunction)(e,"createGSWLocalInstance","GraphSearchWorkflowWasm_Prefetch",s,t,n,i),this.isDisposed)throw new Error("Workflow was disposed while initializing WASM module")}startLogOperation(e,t,s){const o=new a.I({operationName:"GraphSearchWorkflowInstance"===this.propertyName?"graphsearchworkflow_ts":"graphsearchjoinworkflow_ts",success:!0,resultDescription:"",ariaTenant:this.ariaToken,ariaNamespace:this.ariaNamespace}).start();return o.setDataFields({msg:e,startTimestamp:t.toISOString(),inputCount:s?s.length:0}),o}logWasmStats(e){this.wasmModule&&e.setDataFields({version:this.wasmModule.version,sdkVersion:this.wasmModule.sdkVersion,wasmModuleHeapSize:this.wasmModule.HEAP8?this.wasmModule.HEAP8.buffer.byteLength:void 0})}sendDummyAndTriggerServiceFallback(e,t){if(g.VP.typeGuard(t)||u.Z5.typeGuard(t)){const s={ownerId:"GraphSearchClient",conversationId:t.conversationId,logicalId:t.logicalId,entityResults:[],status:h.i.Success},o=g.VP.typeGuard(t)?d.SM.getTypeName():p.J_.getTypeName();e.setAnnotations(t,o,[s],{immediate:!0}),e.submitSignals([new u.tE({cachedIntents:[],inputObject:t,entityTypesResolved:this.config.entityTypes})])}}sendInputAnnotation(e,t,s){void 0!==s&&s.length>0&&(d.SM.typeGuard(s[0])?this.sendEccInputAnnotation(e,t,s):p.J_.typeGuard(s[0])&&this.sendSearchSuggestionInputAnnotation(e,t,s))}sendEccInputAnnotation(e,t,s){if(void 0!==s&&s.length>0&&d.SM.typeGuard(s[0])){const o=new m.os({entityResults:s[0].entityResults,status:h.i.Success});e.setAnnotations(t,m.os.getTypeName(),[o],{immediate:!0})}}sendSearchSuggestionInputAnnotation(e,t,s){if(void 0!==s&&s.length>0&&p.J_.typeGuard(s[0])){const o=new p.VL({results:s[0].results,status:h.i.Success});e.setAnnotations(t,p.VL.getTypeName(),[o],{immediate:!0})}}}},85584:(e,t,s)=>{s.d(t,{Nz:()=>o,Xe:()=>n,aU:()=>r,zb:()=>a});var o,n,i=s(90512);!function(e){e[e.OWA_REACT_COMPOSE=0]="OWA_REACT_COMPOSE",e[e.OUTLOOK_WEB_OA=1]="OUTLOOK_WEB_OA",e[e.OWA_PEOPLE_NAME_PRED=2]="OWA_PEOPLE_NAME_PRED",e[e.OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE=3]="OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE",e[e.DYNAMIC_SEARCH_BOX=4]="DYNAMIC_SEARCH_BOX",e[e.WORKPLACE_SEARCH=5]="WORKPLACE_SEARCH",e[e.COPILOT=6]="COPILOT",e[e.COPILOT_POWERPOINT=7]="COPILOT_POWERPOINT",e[e.BIZ_CHAT=1e4]="BIZ_CHAT"}(o||(o={})),function(e){e[e.SUBSTRATE_AAD=0]="SUBSTRATE_AAD",e[e.SUBSTRATE_MSA=1]="SUBSTRATE_MSA"}(n||(n={}));const r={emailId:"",puid:"",scenarios:[o.OWA_REACT_COMPOSE],market:"",tenantId:"",substrateAuthTokenType:n.SUBSTRATE_AAD,entityTypes:[i.ck.People,i.ck.File,i.ck.Scope],prefetchOnly:!1},a={wasmRoot:"graph-search-local"}},61183:(e,t,s)=>{s.d(t,{A:()=>h});var o=s(55875),n=s(4915),i=s(18305),r=s(25765),a=s(73449),c=s(2010),l=s(69811),u=s(78126),p=s(22360);class g{constructor(){this.seqCounter=0,this.lastInput="",this.lastConversationId="",this.lastLogicalId=""}async init(e){}initialize(e){var t,s;!0!==this.initialized&&(this.enableUserInitiatedRequests=null===(t=null==e?void 0:e.flights)||void 0===t?void 0:t.hasFlight("mc-editor-oa-client-ecc"),this.enableSystemInitiatedRequest=null===(s=null==e?void 0:e.flights)||void 0===s?void 0:s.hasFlight("mc-editor-oa-client-predictions"),this.initialized=!0)}async execute(e,t,s){this.executeInner(e,t,s),s.done()}executeInner(e,t,s){var o;if(r.tG.info(526713100,r.nh.WorkflowDefault,"Executing oa-client router workflow"),e&&e.content&&t&&s){if(this.initialize(t),c.Cg.typeGuard(e)||c.qf.typeGuard(e))if(null===(o=null==t?void 0:t.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-router-refactor"))this.processTextTileInput(e.content,e,s,t);else{if(this.tryGenerateUserInitiatedRequest(e.content,e,s,t))return;this.tryGenerateSystemInitiatedRequest(e.content,e,s,t)}}else r.tG.warn(526713101,r.nh.WorkflowDefault,"unexpected inputs, ignoring request")}dispose(){this.seqCounter=0}processTextTileInput(e,t,s,i){var a,c,l,g,h,d,m;const y=(new Date).toISOString(),f=(0,p.K)("Router_UserInitiated",i).start(),T=i.delta,_=null!==(c=null===(a=null==T?void 0:T.additionalData)||void 0===a?void 0:a.conversationId)&&void 0!==c?c:"",C=null!==(g=null===(l=null==T?void 0:T.additionalData)||void 0===l?void 0:l.logicalId)&&void 0!==g?g:"",v=this.getValidUserInitQuery(t,i,f);if(v){const o=null!==(d=null===(h=null==T?void 0:T.additionalData)||void 0===h?void 0:h.scopeInfo)&&void 0!==d?d:void 0,n=void 0===o&&this.sameAsLastUserInitRequest(e,T),i=null!==(m=null==o?void 0:o.entityType)&&void 0!==m?m:"";return f.setDataFields({hasScope:void 0!==o,entityType:i,repeatedReuquest:n}),this.generateUserInitiatedRequest(e,t,s,v,C,_,o,f),void this.finalizeLogging(f,y,C,_)}if(this.enableUserInitiatedRequests){const e=new o.os({conversationId:null!=_?_:"",entityResults:[],logicalId:null!=C?C:"",status:n.i.EarlyExit});s.setAnnotations(t,o.os.getTypeName(),[e]),f.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"}),this.finalizeLogging(f,y,C,_)}else f.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),this.finalizeLogging(f,y,C,_);const S=(new Date).toISOString(),A=(0,p.K)("Router_SystemInitiated",i).start(),w=(0,u.A)();this.isValidSystemInitQuery(t,i,A)?this.generateSystemInitiatedRequest(e,t,s,w,A):this.enableSystemInitiatedRequest?A.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"}):A.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),r.tG.info(508408097,r.nh.WorkflowDefault,`sending SystemInitiatedRequestClient (${this.seqCounter})`),this.finalizeLogging(A,S,w)}finalizeLogging(e,t,s,o){const n=(new Date).toISOString();o&&e.setDataFields({conversationId:o}),e.setDataFields({startTimeStamp:t,endTimeStamp:n,logicalId:s}),r.tG.info(508356445,r.nh.WorkflowDefault,e.stop())}generateUserInitiatedRequest(e,t,s,o,n,r,a,c){if(!this.enableUserInitiatedRequests)return void c.setDataFields({statusDescription:"Request skipped because required flight is missing"});const l=new i.VP({content:this.sanitizeText(e),logicalId:n,conversationId:r,seq:++this.seqCounter,scope:a,...o});s.setAnnotations(t,i.VP.getTypeName(),[l]),c.setDataFields({statusDescription:"User-Initiated request generated"})}generateSystemInitiatedRequest(e,t,s,o,n){if(!this.enableSystemInitiatedRequest)return void n.setDataFields({statusDescription:"Request skipped because required flight is missing"});const r=new i.JM({content:this.sanitizeText(e),logicalId:o,seq:++this.seqCounter});s.setAnnotations(t,i.JM.getTypeName(),[r]),n.setDataFields({statusDescription:"System-Initiated request generated"})}tryGenerateUserInitiatedRequest(e,t,s,a){var c,l,u,g,h,d,m,y;let f=!1;const T=(new Date).toISOString(),_=(0,p.K)("Router_UserInitiated",a).start(),C=a.delta,v=null!==(l=null===(c=null==C?void 0:C.additionalData)||void 0===c?void 0:c.conversationId)&&void 0!==l?l:"",S=null!==(g=null===(u=null==C?void 0:C.additionalData)||void 0===u?void 0:u.logicalId)&&void 0!==g?g:"";if(null===(h=null==a?void 0:a.flights)||void 0===h?void 0:h.hasFlight("mc-editor-oa-client-ecc")){const r=this.getValidUserInitQuery(t,a,_);if(r){const o=null!==(m=null===(d=null==C?void 0:C.additionalData)||void 0===d?void 0:d.scopeInfo)&&void 0!==m?m:void 0,n=void 0===o&&this.sameAsLastUserInitRequest(e,C),a=null!==(y=null==o?void 0:o.entityType)&&void 0!==y?y:"";_.setDataFields({hasScope:void 0!==o,entityType:a,repeatedReuquest:n});const c=new i.VP({content:this.sanitizeText(e),logicalId:S,conversationId:v,seq:++this.seqCounter,scope:o,...r});s.setAnnotations(t,i.VP.getTypeName(),[c]),_.setDataFields({statusDescription:"User-Initiated request generated"}),f=!0}else{const e=new o.os({conversationId:null!=v?v:"",entityResults:[],logicalId:null!=S?S:"",status:n.i.EarlyExit});s.setAnnotations(t,o.os.getTypeName(),[e]),_.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"})}}else _.setDataFields({statusDescription:"Request skipped because required flight is missing"});const A=(new Date).toISOString();return _.setDataFields({startTimeStamp:T,endTimeStamp:A,conversationId:v,logicalId:S}),r.tG.info(508409808,r.nh.WorkflowDefault,_.stop()),f}tryGenerateSystemInitiatedRequest(e,t,s,o){var n;const a=(new Date).toISOString(),c=(0,p.K)("Router_SystemInitiated",o).start(),l=(0,u.A)();if(null===(n=null==o?void 0:o.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-predictions")){if(this.isValidSystemInitQuery(t,o,c)){const o=new i.JM({content:this.sanitizeText(e),logicalId:l,seq:++this.seqCounter});s.setAnnotations(t,i.JM.getTypeName(),[o]),c.setDataFields({statusDescription:"System-Initiated request generated"})}else c.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"});r.tG.info(508409807,r.nh.WorkflowDefault,`sending SystemInitiatedRequestClient(${this.seqCounter})`)}else c.setDataFields({statusDescription:"Request skipped because required flight is missing"});const g=(new Date).toISOString();c.setDataFields({startTimeStamp:a,endTimeStamp:g,logicalId:l}),r.tG.info(508409806,r.nh.WorkflowDefault,c.stop())}sanitizeText(e,t){if("number"!=typeof(null==e?void 0:e.length))return"";"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1));const s=e.replace(/\s/g," ");return t?s.trim():s}sameAsLastUserInitRequest(e,t){var s,o,n,i;const r=null!==(o=null===(s=null==t?void 0:t.additionalData)||void 0===s?void 0:s.conversationId)&&void 0!==o?o:"",a=null!==(i=null===(n=null==t?void 0:t.additionalData)||void 0===n?void 0:n.logicalId)&&void 0!==i?i:"";let c=!1;return e===this.lastInput&&r===this.lastConversationId&&a===this.lastLogicalId&&(c=!0),this.lastInput=e,this.lastConversationId=r,this.lastLogicalId=a,c}getValidUserInitQuery(e,t,s){var o,n;if(!c.Cg.typeGuard(e))return void s.setDataFields({statusDescription:"Invalid input type"});const i=e;if((null===(o=t.delta)||void 0===o?void 0:o.unit)!==l.OD.Chars&&this.sanitizeText(i.content,!0).length<1)return void s.setDataFields({statusDescription:"Ignore empty tile"});const r=t.delta;if(r&&(r.unit!==l.OD.Sentence||r.queryRange&&r.content)){const t=e.content;let o;const i=r.queryRange;if(i){const{length:e,start:s}=i,r=null!==(n=i.prefix)&&void 0!==n?n:g.userInitiatedIntentChar;o={query:this.sanitizeText(t.substring(s+r.length,s+e)),queryChar:r,queryCharIndex:s}}else s.setDataFields({statusDescription:"Invalid or non-existent queryRange provided."});if(o){const e={start:o.queryCharIndex,end:o.queryCharIndex+o.query.length+1};return(r.position>=e.start||r.position+r.content.length>=e.start)&&r.position<=e.end?(s.setDataFields({seqCounter:this.seqCounter,querylength:i.length}),o):void s.setDataFields({statusDescription:"Delta outside of query bounds"})}s.setDataFields({statusDescription:"Invalid query to generate user init request."})}else s.setDataFields({statusDescription:"Delta is undefined. Cannot proceed with query detection logic."})}isValidSystemInitQuery(e,t,s){var o;if(!c.Cg.typeGuard(e))return s.setDataFields({statusDescription:"Invalid input type, ignore"}),!1;const n=e.content,i=this.sanitizeText(n,!0),r=t.delta;if(!r)return s.setDataFields({statusDescription:"Delta is undefined."}),!1;{if(r.unit===l.OD.Sentence||r.unit===l.OD.Paragraph)return!1;if(r.unit!==l.OD.Chars&&i.length<1)return s.setDataFields({statusDescription:"Empty tile, ignore"}),!1;const e=n.endsWith("\n")?n.substring(0,n.length-1):n;if((null===(o=null==t?void 0:t.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-router-refactor"))&&r.position>=e.length-1)return!0;if(r.position>=e.length-1&&g.triggerCharacters.has(i[i.length-1]))return s.setDataFields({statusDescription:"Router should not generate system initiated requests for ECC requests"}),!1}return!0}}g.userInitiatedIntentChar="@",g.triggerCharacters=new Set(["@","/"]);const h=a.z.create("oaClientRouter").setInputTypes([c.qf.getTypeName()]).setOutputTypes([o.os.getTypeName(),i.JM.getTypeName(),i.VP.getTypeName()]).setLambdaType((()=>new g))},53718:(e,t,s)=>{s.d(t,{TE:()=>_});var o=s(99614),n=s(55875),i=s(4915),r=s(2010),a=s(24205),c=s(25765),l=s(22360),u=s(50090);const p=new Map([[o.c.People,1300],[o.c.PeopleInGroup,1250],[o.c.File,1200],[o.c.Event,1100],[o.c.Message,1e3],[o.c.Chat,920],[o.c.Team,910],[o.c.Channel,900],[o.c.MessageExtensionApp,800],[o.c.External,700],[o.c.Topic,600],[o.c.Loop,500],[o.c.Address,400],[o.c.Scope,100],[o.c.App,90],[o.c.Prompt,85],[o.c.CopilotPlugin,80]]),g=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,h=e=>{const t=p.get(e);return void 0===t?(c.tG.error(509743565,c.nh.WorkflowDefault,`unsupported entity type:'${e}'`),1):t},d=(e,t)=>{const s=h(e.entityType),o=h(t.entityType);return s===o?(c.tG.warn(509743564,c.nh.WorkflowDefault,`unexpected priority:'${e.entityType}','${t.entityType}'`),e.entityType.localeCompare(t.entityType)):o-s},m=(e,t,s)=>{t||c.tG.warn(e,c.nh.WorkflowDefault,s)};class y{constructor(){this.seqCounter=0,this.seqCounter=0}async init(e){this.seqCounter=0}async execute(e,t,s,o){const i=(new Date).toISOString();c.tG.info(524066818,c.nh.WorkflowDefault,`Executing oa-client client-server ranker workflow. sequence number : ${this.seqCounter}`),this.seqCounter++;const r=(0,l.K)("Ranker_Ecc",s).start(),a=this.getRankedResults(t,r);a&&o.setAnnotations(e,n.c$.getTypeName(),[a]);const u=(new Date).toISOString();r.setDataFields({startTimeStamp:i,endTimeStamp:u}),c.tG.info(512500928,c.nh.WorkflowDefault,r.stop()),o.done()}dispose(){this.seqCounter=0}getRankedResults(e,t){var s,o,r,a,l,p,h,y,f,T,_,C;if(0===e.length||this.seqCounter<0)return t.success=!1,t.resultDescription="oa-client-server ecc result ranker lambda has no inputs",void c.tG.warn(524066819,c.nh.WorkflowDefault,t.resultDescription);if(e.length>2)return t.success=!1,t.resultDescription="Unexpected. Client-server ranker can never have more than 2 inputs",void c.tG.warn(523854672,c.nh.WorkflowDefault,t.resultDescription);const v=null!==(o=null===(s=e[0])||void 0===s?void 0:s.conversationId)&&void 0!==o?o:"",S=null!==(a=null===(r=e[0])||void 0===r?void 0:r.logicalId)&&void 0!==a?a:"";if(t.setDataFields({conversationId:v,logicalId:S}),0===(e=e.filter((e=>e.status!==i.i.EarlyExit))).length)return t.success=!0,t.resultDescription="oa-client-server ecc result ranker skipping execution due to receiving early-exit annotations only",void c.tG.warn(509112707,c.nh.WorkflowDefault,t.resultDescription);const A=e.length.toString(),w=e.map((e=>e.ownerId)).join(";");let I;if(t.setDataFields({providerCount:A,souces:w}),1===e.length&&e[0].entityResults)I=new n.c$({conversationId:v,entityResults:e[0].entityResults,logicalId:S,status:e[0].status,treatments:e[0].treatments});else{const t=new Map,s=e[0].entityResults.length>=e[1].entityResults.length?0:1,o=(s+1)%2,r=new Set,a=e[s];for(let s=0;s<a.entityResults.length;++s){const n=a.entityResults[s],i=n.entityType;r.add(i);const c=n.entities,l=e[o];let u=n.modelInfo,p=c,g=a.entityResults[s].intent;for(let e=0;e<l.entityResults.length;++e){const t=l.entityResults[e];if(i===t.entityType){const s=l.entityResults[e].intent;s&&(g=Math.max(null!=g?g:0,s)),p=this.getDeDupedEntityList(c,t.entities),u=this.getMergedModelInfo(n.modelInfo,t.modelInfo);break}}const h={entities:p,entityType:i,modelInfo:u,intent:g};t.set(i,h)}const A=e[o];for(let e=0;e<A.entityResults.length;++e){const s=A.entityResults[e],o=s.entityType;r.has(o)||t.set(o,s)}const w=Array.from(t.values()).sort(d),N=[];let b=[],k=!1;if((0,u.I)("UseLocallyGeneratedBM")&&(null===(l=null==a?void 0:a.entityResults)||void 0===l?void 0:l.length)>0&&"GraphSearchClient"===(null==a?void 0:a.ownerId)&&(null===(h=null===(p=null==a?void 0:a.treatments)||void 0===p?void 0:p.bestMatchEntries)||void 0===h?void 0:h.length)>0)b=a.treatments.bestMatchEntries;else if((0,u.I)("UseLocallyGeneratedBM")&&(null===(y=null==A?void 0:A.entityResults)||void 0===y?void 0:y.length)>0&&"GraphSearchClient"===(null==A?void 0:A.ownerId)&&(null===(T=null===(f=null==A?void 0:A.treatments)||void 0===f?void 0:f.bestMatchEntries)||void 0===T?void 0:T.length)>0)b=A.treatments.bestMatchEntries;else{const e=null===(_=null==a?void 0:a.treatments)||void 0===_?void 0:_.bestMatchEntries,t=null===(C=null==A?void 0:A.treatments)||void 0===C?void 0:C.bestMatchEntries;if(e)for(let t=0;t<e.length;t++)N.push(e[t]);if(t)for(let e=0;e<t.length;e++)N.push(t[e]);b=N.sort(((e,t)=>g(t.confidence)-g(e.confidence))).sort(d).slice(0,3),k=((e,t)=>{var s;const o=null===(s=t.find((e=>e.entities.length>0)))||void 0===s?void 0:s.entityType,n=o&&!e.some((e=>e.entityType!=o));return n&&c.tG.info(509662157,c.nh.WorkflowDefault,"Best Match results suppressed"),n})(b,w)}m(520135894,(null==a?void 0:a.conversationId)===(null==A?void 0:A.conversationId),"Unexpected mismatch of conversation id in ranker"),m(520135893,(null==a?void 0:a.logicalId)===(null==A?void 0:A.logicalId),"Unexpected mismatch of logical id in ranker"),I=new n.c$({conversationId:null!=v?v:"",entityResults:w,logicalId:null!=S?S:"",status:0===w.length?i.i.NoResults:i.i.Success,treatments:new n.Fe({bestMatchEntries:k?[]:b})})}var N;return t.setDataFields({entityCount:(N=[I],N.reduce(((e,t)=>{var s;return e+((null===(s=t.entityResults)||void 0===s?void 0:s.reduce(((e,t)=>{var s;return e+((null===(s=t.entities)||void 0===s?void 0:s.length)||0)}),0))||0)}),0).toString())}),I}getDeDupedEntityList(e,t){const s=[],o=new Set;for(let t=0;t<e.length;++t){const n=e[t],i=n.text.toLocaleLowerCase();o.has(i)||(o.add(i),s.push(n))}for(let e=0;e<t.length;++e){const n=t[e];o.has(n.text.toLocaleLowerCase())||s.push(n)}return s}getMergedModelInfo(e,t){return{elapsedTime:Math.max(e.elapsedTime,t.elapsedTime),name:`${e.name}|${t.name}`,version:`${e.version}|${t.version}`}}}const f=()=>new y,T=(e,t)=>a.a.create("OaClientServerEccResultRanker").setCollectionScopeType(r.Cg.getTypeName()).setInputTypes(t).setOutputTypes([n.c$.getTypeName()]).setMaxAnnotations(e).setMaxDelayTime(3400).setLambdaType(f),_=(T(2,[n.J2.getTypeName(),n.os.getTypeName()]),T(2,[n.os.getTypeName()]))},22360:(e,t,s)=>{s.d(t,{K:()=>n});var o=s(89700);const n=(e,t)=>{var s,n;const i=new o.I({operationName:e,success:!0,resultDescription:"",ariaTenant:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ariaNamespace:"Oa_Client"});return i.setClientMetadata(null==t?void 0:t.clientMetadata),i.setUserContext(null==t?void 0:t.userContext),i.setDataFields({contextId:null===(n=null===(s=null==t?void 0:t.model)||void 0===s?void 0:s.scopeItem)||void 0===n?void 0:n.getContextId()}),i}},62174:e=>{e.exports={r:"2.35.1636"}}}]);
//# sourceMappingURL=augloop-chunk.js.map