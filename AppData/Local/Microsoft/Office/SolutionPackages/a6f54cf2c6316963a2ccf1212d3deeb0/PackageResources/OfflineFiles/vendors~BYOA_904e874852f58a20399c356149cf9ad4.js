"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[2701],{79842:(e,t,a)=>{a.r(t),a.d(t,{BYOA:()=>Ne,BYOAgentDataType:()=>n});var n,o,i,r=a(22829),s=a(72241),l=a(8520),u=a(73267),c=a(93176),d=a(62096),p=a(70825),g=a(80607),h=a(87396),y=a(31376),m=a(66019),f=a(53938),k=a(82863),E=a(34377),T=a(13456),S=a(96713),C=a(71348),v=a(88938),A=a(13620);!function(e){e.EDITABLE="EDITABLE",e.NON_EDITABLE="NON_EDITABLE"}(n||(n={})),function(e){e.Skill="Skill",e.Do="Do",e.OverDuration="OverDuration",e.When="When",e.Project="Project",e.Query="Query"}(o||(o={})),function(e){e.Month="Month",e.Day="Day",e.Hour="Hour",e.Minute="Minute",e.Week="Week",e.Second="Second",e.Once="Once"}(i||(i={}));const I="Scrum Master",P="Inbox IQ Agent",D="Convert your ideas to a PPT",b="Sorry, Something went wrong. Please try again.",x=()=>[{type:n.NON_EDITABLE,value:{value:"Build me a"}},{type:n.EDITABLE,value:{key:"AGENT_NAME",value:{key:"summarize_updates_ado",value:"Azure devops updates agent"},placeholder:"Azure devops agent",options:[{key:"summarize_updates_ado",value:"Azure devops updates agent"},{key:"action_items_ado",value:"Azure devops action items agent"},{key:"project_status_report_ado",value:"Project status report agent"}]}},{type:n.NON_EDITABLE,value:{value:"creating a"}},{type:n.EDITABLE,value:{key:"TASK_NAME",value:{key:"create_deck",value:"Quick PPT deck"},placeholder:"Quick PPT deck",options:[{key:"create_deck",value:"Quick PPT deck"},{key:"email",value:"quick email"}]}},{type:n.NON_EDITABLE,value:{value:"over a period of"}},{type:n.EDITABLE,value:{key:"DAYS_HISTORY",value:{key:"3",value:"3 Days"},placeholder:"3 days",options:[{key:"3",value:"3 Days"},{key:"5",value:"5 days"},{key:"10",value:"10 days"}]}},{type:n.NON_EDITABLE,value:{value:"and trigger it at"}},{type:n.EDITABLE,value:{key:"TIME",value:{key:"12 PM",value:"12 PM"},placeholder:"8 AM",options:[{key:"8 AM",value:"8 AM"},{key:"12 PM",value:"12 PM"}]}}],N=(e,t)=>({logicalId:"vikrantshete@microsoft.com",DisplayName:e,EmailAddresses:["ADO skill"],type:t,ResultSource:0,confidence:1,entityType:t,text:e}),O={[o.Skill]:[{entityType:A.ck.People,entities:[{logicalId:"vikrantshete@microsoft.com",DisplayName:"ADO project status report agent",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"ADO project status report agent"},{logicalId:"vikrantshete@microsoft.com",DisplayName:"ADO action items agent",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"ADO action items agent"},{logicalId:"vikrantshete@microsoft.com",DisplayName:"ADO updates on work items agent",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"ADO updates on work items agent"}]}],[o.Do]:[{entityType:A.ck.People,entities:[{logicalId:"vikrantshete@microsoft.com",DisplayName:"Send an email",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"Send an email"},{logicalId:"vikrantshete@microsoft.com",DisplayName:"Create a PPT deck",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"Create a PPT deck"}]}],[o.OverDuration]:[{entityType:A.ck.People,entities:[{logicalId:"vikrantshete@microsoft.com",DisplayName:"a day",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"a day"},{logicalId:"vikrantshete@microsoft.com",DisplayName:"a week",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"a week"}]}],[o.When]:[{entityType:A.ck.People,entities:[{logicalId:"vikrantshete@microsoft.com",DisplayName:"everyday 9AM",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"everyday 9AM"},{logicalId:"vikrantshete@microsoft.com",DisplayName:"everyday 6PM",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"everyday 6PM"}]}],[o.Project]:[{entityType:A.ck.People,entities:[{logicalId:"vikrantshete@microsoft.com",DisplayName:"Office",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"Office"}]}],[o.Query]:[{entityType:A.ck.People,entities:[{logicalId:"vikrantshete@microsoft.com",DisplayName:"OPC Branch Tracking",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"OPC Branch Tracking"},{logicalId:"vikrantshete@microsoft.com",DisplayName:"Active Tasks",EmailAddresses:["ADO skill"],type:A.ck.People,ResultSource:0,confidence:1,entityType:A.ck.People,text:"Active Tasks"}]}]},w={"ADO project status report agent":{key:"AGENT_NAME",value:{key:"project_status_report_ado",value:""}},"ADO updates on work items agent":{key:"AGENT_NAME",value:{key:"summarize_updates_ado",value:""}},"ADO action items agent":{key:"AGENT_NAME",value:{key:"action_items_ado",value:"Azure devops action items agent"}},"Send an email":{key:"TASK_NAME",value:{key:"email",value:""}},"Create a PPT deck":{key:"TASK_NAME",value:{key:"create_deck",value:""}},"a day":{key:"DAYS_HISTORY",value:{key:"1",value:""}},"a week":{key:"DAYS_HISTORY",value:{key:"7",value:""}},"everyday 9AM":{key:"TIME",value:{key:"9 AM",value:""}},"everyday 6PM":{key:"TIME",value:{key:"6 PM",value:""}}},R={hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"Copilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,resultTime:1e4},M=()=>[{type:n.NON_EDITABLE,value:{value:"Build me an"}},{type:n.EDITABLE,value:{key:"AGENT_NAME",value:{key:"inbox_iq",value:"Inbox IQ agent"},placeholder:"Inbox IQ agent",options:[{key:"inbox_iq",value:"Inbox IQ agent"}]}},{type:n.NON_EDITABLE,value:{value:"creating a"}},{type:n.EDITABLE,value:{key:"TASK_NAME",value:{key:"summary_email",value:"summary of emails"},placeholder:"summary of emails",options:[{key:"summary_email",value:"summary of emails"},{key:"summary_email_from",value:"summary of emails from"},{key:"summary_email_topic",value:"summary of emails about"}]}},{type:n.NON_EDITABLE,value:{value:"over a period of"}},{type:n.EDITABLE,value:{key:"DAYS_HISTORY",value:{key:"3",value:"3 Days"},placeholder:"3 days",options:[{key:"3",value:"3 Days"},{key:"10",value:"10 days"}]}},{type:n.NON_EDITABLE,value:{value:"and trigger it at"}},{type:n.EDITABLE,value:{key:"TIME",value:{key:"12 PM",value:"12 PM"},placeholder:"8 AM",options:[{key:"8 AM",value:"8 AM"},{key:"12 PM",value:"12 PM"}]}}],L=[o.Skill,o.Project,o.Query,o.Do,o.OverDuration,o.When];var _=a(98483);const B=e=>({query:e,queryId:(0,_.A)(),createAgent:{templateName:"BuildYourAgent"},agentId:(0,_.A)()}),F=(e,t,a)=>({queryId:(0,_.A)(),query:t,uiStateSync:{jsonPayload:e},agentId:a}),Q=e=>{let t="";return e.map((e=>{e.type===n.NON_EDITABLE?t+=e.value.value+" ":t+=(e.value.value?.value??"")+" "})),t},q=(e,t,a,o,r,s)=>{const l={TASK_LIST:[],RECURRENCE:{frequency:i.Day,interval:1},HEADERS:`Basic ${btoa(`${o}:${t}`)}`},u=e.filter((e=>e.type===n.EDITABLE)).map((e=>e.value)),c=r&&s,d={taskName:u[0].value?.key,params:{QUERY_ID:c?s:"36a2e0b3-92cf-47ab-a1ca-eb5b7051dedc",PROJECT_ID:c?r:"bc6e0ce9-86c2-4c5a-aece-d99afc758a73",ORG_NAME:"office",DAYS_HISTORY:u[2]?.value?.key??1}},p="email"===u[1].value?.key;let g={taskName:"email",params:{sender:a[0],receiver:a}};return p||(g={taskName:u[1].value?.key,params:{pptName:`PPTDeck_${Date.now()}.pptx`,location:"/Documents/OfficeAI/AutoGenerated"}}),l.TASK_LIST=[d,g],JSON.stringify(l)},j=async(e,t,a)=>{if(e===o.Project)return t?(n=t,[{entityType:A.ck.People,entities:n.map((e=>N(e.name,A.ck.People)))}]):[{entityType:A.ck.People,entities:[N("Loading projects...",A.ck.People)]}];var n;if(e===o.Query){if(!a||!t)throw new Error("Project not selected or suggestions not loaded to return queries");return(e=>[{entityType:A.ck.People,entities:e.queries.myQueries.concat(e.queries.sharedQueries).map((e=>N(e.name,A.ck.People)))}])(a)}return O[e]},U=(e,t)=>({key:e,value:{key:t,value:t}});var Y=a(88539),z=a(82479),H=a(658);const $=(0,H.n)((0,Y.f)({chatFreStack:{height:"calc(100vh - 50px)"},chatUiStack:{top:"20px"}})),G=(0,z.l8)({input:{width:"auto",border:"none",outline:"none",borderBottom:"1px solid #C3C3C3",padding:"5px",boxSizing:"border-box","&::-webkit-calendar-picker-indicator":{display:"none !important"}},root:{display:"flex",flexDirection:"column",rowGap:"12px"},textArea:{width:"100%",minHeight:"75px",borderRadius:"5px",padding:"5px",boxSizing:"border-box",fontSize:"inherit",fontStyle:"inherit",fontFamily:"inherit",margin:"10px auto",border:"1px solid #C3C3C3","&:focus":{outline:"none",borderColor:"#C3C3C3"}}}),J=({headerText:e,data:t,disabled:a,onSubmit:o,onClose:i})=>{const[r,s]=l.useState(t);(0,l.useEffect)((()=>{s(t)}),[t]);const u=()=>{o(r)};return a?l.createElement(l.Fragment,null,Q(r)):l.createElement(f.g,{style:{margin:"15px"}},l.createElement(E.B,{className:G.root},l.createElement(E.B,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},l.createElement(T.V,null,e),l.createElement(S.$,{icon:l.createElement(v.LMj,null),onClick:i})),l.createElement(E.B,{horizontal:!0,tokens:{childrenGap:10},wrap:!0},r.map(((e,t)=>{return e.type===n.NON_EDITABLE?l.createElement(C.E,{key:t},l.createElement(l.Fragment,null,e.value.value)):l.createElement("div",{key:`input-wrapper-${t}`},l.createElement("input",{className:G.input,type:"text",placeholder:e.value.placeholder??"",list:`values-${t}`,onChange:(o=t,e=>{const t=[...r],a=t[o].value,n=a.options?.find((t=>t.value.toLowerCase()===e.target.value?.toLowerCase()));n&&(a.value=n,s(t))}),size:(a=e.value,Math.max(a.placeholder?.length??0,a.value?.value?.length??0,5))}),l.createElement("datalist",{id:`values-${t}`},e.value.options?.map(((e,a)=>l.createElement("option",{key:`option-${t}-${a}`,value:e?.value},e?.value)))));var a,o}))),l.createElement(E.B,null,l.createElement(E.B.Item,{align:"end"},l.createElement(k.b,{title:"Send",isDisabled:a,handleClick:u})))))},W=(e,t,a,n,o)=>l.createElement(J,{headerText:e,data:t,disabled:a,onSubmit:n,onClose:o});var V=a(84417);const K=({headerText:e,onClose:t,onSubmit:a,isDisabled:n})=>{const[o,i]=l.useState(""),[r,s]=l.useState(!1);return l.createElement(f.g,{style:{margin:"15px"}},l.createElement(E.B,{className:G.root},l.createElement(E.B,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},l.createElement(T.V,null,e),l.createElement(S.$,{icon:l.createElement(v.iAS,null),onClick:t})),l.createElement(E.B,{horizontal:!0,tokens:{childrenGap:10},wrap:!0},l.createElement("textarea",{className:G.textArea,placeholder:"Enter your ideas here...",disabled:n,value:o,onChange:e=>{i(e.target?.value??"")}})),l.createElement(E.B,{horizontal:!0,horizontalAlign:"space-between"},l.createElement(E.B.Item,{align:"start"},l.createElement(V.S,{label:"Create headless PPT",checked:r,onChange:()=>{s(!r)}})),l.createElement(E.B.Item,{align:"end"},l.createElement(k.b,{title:"Send",isDisabled:n,handleClick:()=>{a(o,r)}})))))};class Z{static generateId(){return Z.operationId++,"AugLoopChatAgent-BYOA"+Z.operationId.toString()}}Z.operationId=0;var X=a(58651);class ee extends u.h{constructor(e,t,a,n,o,i,r,s){super(),this.session=null,this.cardData=[],this.cardHeaderText="",this.onSubmitAgentQuery=e=>{X.log("ReviewerAgent:: onSubmitBYOAgent",e),this.cardData=e,this.copilotChatRef.current?.addChatMessages([{messageType:c._.ChatCardWrapper,body:{user:"human",element:W(this.cardHeaderText,e,!0,this.onSubmitAgentQuery,this.onCloseCard)}}],!1),this.setShouldRenderChatInput(!0),this.sendUISyncSignal()},this.onSubmitPPTIdeasQuery=(e,t)=>{X.log("PPT::Submit button clicked","query:  "+e,"isHeadless: "+t);let a=e;""===e.trim()&&(a="Please provide a valid query. Cannot submit an empty query."),this.copilotChatRef.current?.addChatMessages([{messageType:c._.Default,body:{user:"human",messageHeader:{text:a}}}]),""!==e.trim()&&(this.sendPPTIdeasSignal(e,t),this.copilotChatRef.current?.startLoadingUi(),this.setShouldRenderChatInput(!0))},this.onCloseCard=()=>{X.log("BYOA:: onCloseCard"),this.setShouldRenderChatInput(!0)},this.copilotChatRef=e,this.session=t,this.setShouldRenderChatInput=a,this.patToken=n,this.authorName=i,this.authorEmail=o,this.isInboxIqAgentEnabled=r,this.isIdeasToPPTEnabled=s}static getInstance(e,t,a,n,o,i,r,s){return ee.instance||(ee.instance=new ee(e,t,a,n,o,i,r,s)),ee.instance}getWorkflowsToRegister(){X.log("BYOA:: getWorkflowsToRegister.");const e=[];return this.isInboxIqAgentEnabled&&e.push({workflowAnnotationType:y.MG.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:65e3}),e.push({workflowAnnotationType:g.xj.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:65e3}),X.log("BYOA:: Registered workflows"),e}getAgentCardData(e){return this.cardHeaderText=e,this.isInboxIqAgentEnabled?(this.cardData=M(),W(P,this.cardData,!1,this.onSubmitAgentQuery,this.onCloseCard)):this.isIdeasToPPTEnabled&&e===D?(({headerText:e,onClose:t,onSubmit:a,isDisabled:n})=>l.createElement(K,{headerText:e,onClose:t,onSubmit:a,isDisabled:n}))({headerText:"Ideas to PPT",onClose:this.onCloseCard,isDisabled:!1,onSubmit:(e,t)=>{this.onSubmitPPTIdeasQuery(e,t)}}):(this.cardData=e.includes(I)?x():[{type:n.NON_EDITABLE,value:{value:"Create a deck for"}},{type:n.EDITABLE,value:{value:{key:"ado",value:"Azure DevOps"},options:[{key:"ado",value:"Azure DevOps"},{key:"ado2",value:"Azure DevOps 2"}]}},{type:n.NON_EDITABLE,value:{value:"with"}},{type:n.EDITABLE,value:{value:{key:"10 slides",value:"10 slides"},options:[{key:"10 slides",value:"10 slides"},{key:"20 slides",value:"20 slides"}]}}],W(e,this.cardData,!1,this.onSubmitAgentQuery,this.onCloseCard))}setCallbacks(e){this.applyPPTIdeasODSL=e}sendResponseToClient(e){X.log("BYOA::Sending response to client:",e);const t=e.id;var a;if((!this.annotationId||this.annotationId!==t)&&(this.annotationId&&this.annotationId===t||(this.annotationId=t),0===e.body?.chatResponse?.status)){const t=e.body?.chatResponse?.messages;if(t?.length>=2){const e=(e=>{const t=JSON.parse(e)?.payload;return t?t.agentId:""})(t[1]?.text);e!==this.agentId&&(X.log("BYOA:: Agent Id changed. Sending signal to fetch projects data"),this.agentId=e,this.sendSignalToFetchProjectsData());let n,o=t[0]?.text;try{n=JSON.parse(t[1]?.text);const e=n?.payload?.props?.[0];if("PROJECT_PICKER"===e?.kind){const t=e?.props?.suggestions?.defaultValue;return void(this.projectSuggestions=(a=t,a.filter((e=>e.queries.myQueries.length>0||e.queries.sharedQueries.length>0))))}}catch(e){X.error("Something went wrong while parsing the response JSON",e),o=b}this.copilotChatRef.current?.addResponseMessage({chatCardType:c._.MarkdownCard,chatMessageData:{markDownCardProps:{message:o}},stopLoadingUi:!0})}else if(t.length>0&&t[0]?.text){const e=(e=>{const t=JSON.parse(e)?.payload;return t?t.displayMessage:b})(t[0]?.text);if(this.isIdeasToPPTEnabled){let t;try{t=JSON.parse(e)}catch(e){X.error("Unable to parse display message",e)}if(t&&t.jsonCmdPayload)return void(this.applyPPTIdeasODSL?this.applyPPTIdeasODSL(t.jsonCmdPayload).then((()=>{this.copilotChatRef.current?.addResponseMessage({chatCardType:c._.MarkdownCard,chatMessageData:{markDownCardProps:{message:"Request processed successfully"}},stopLoadingUi:!0})})).catch((e=>{X.error("Error occured while applying odsl",e)})):X.error("Unable to apply odsl. Function applyPPTIdeasODSL is not defined"))}this.copilotChatRef.current?.addResponseMessage({chatCardType:c._.MarkdownCard,chatMessageData:{markDownCardProps:{message:e}},stopLoadingUi:!0})}}}sendEventToClient(e,t){X.log("BYOA:: SendEventToClient.",e),e==d.PV.CopilotChatLoaded&&(X.log("BYOA:: Sending initial signal"),this.sendInitialSignal())}getDefaultSignalOperation(e,t,a,n,o){if(this.isInboxIqAgentEnabled){const t={query:e,queryId:(0,_.A)(),createAgent:{templateName:"SummarizeInbox"},agentId:""},a={operation:new p.g0({parentPath:["Signal",m.cS.getTypeName()],items:[{id:Z.generateId(),body:new m.cS(t)}]}),workflowAnnotationType:y.MG.getTypeName()};return Promise.resolve(a)}const i=B(e),r={operation:new p.g0({parentPath:["Signal",h.br.getTypeName()],items:[{id:Z.generateId(),body:new h.br(i)}]}),workflowAnnotationType:g.xj.getTypeName()};return Promise.resolve(r)}getHostSettings(){return{appName:"Testing",appPlatform:"All",devBuild:!0,environment:d.DF.DEV,sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com"}}getAuthToken(){return Promise.resolve("add auth token here")}async getALSession(){if(X.log("getALSession"),this.session)return this.session;throw new Error("Session is not undefined")}getProjectSuggestions(){return this.projectSuggestions}sendUISyncSignalForCiqSelections(e,t){if(!this.authorEmail||!this.authorName)return;if(e.length<2)return;const a=[{mail:this.authorEmail,displayName:this.authorName}],o=e.filter((e=>"PROJECT"!==e.key&&"QUERY"!==e.key)).map((e=>({value:e,type:n.EDITABLE})));let i,r;for(const t of e)if("PROJECT"===t.key?i=t.value?.key:"QUERY"===t.key&&(r=t.value?.key),i&&r)break;const s=q(o,this.patToken,a,this.authorEmail?.split("@")[0]??"",i,r),l={...F(s,t,this.agentId)};this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",h.br.getTypeName()],items:[{id:Z.generateId(),body:new h.br(l)}]}),workflowAnnotationType:g.xj.getTypeName()}),this.copilotChatRef.current?.addChatMessages([{messageType:c._.Default,body:{user:"human",messageHeader:{text:t}}}]),this.copilotChatRef.current?.startLoadingUi()}sendSignalToFetchProjectsData(){try{if(!this.agentId)throw Error("Agent Id not found. Cannot fetch Projects");const t=(e=this.agentId,{query:"",queryId:(0,_.A)(),agentId:e,fetchUiDataSignal:{agentId:e,fetchUiData:{datatype:"PROJECTS"}}});this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",h.br.getTypeName()],items:[{id:Z.generateId(),body:new h.br(t)}]}),workflowAnnotationType:h.br.getTypeName()})}catch(e){X.error("Something went wrong while fetching the projects...",e)}var e}sendUISyncSignal(){if(!this.authorEmail||!this.authorName)return;if(0===this.cardData.length)return;if(this.cardData.filter((e=>e.type===n.EDITABLE&&!e.value)).length>0)return;const e=Q(this.cardData),t=[{mail:this.authorEmail,displayName:this.authorName}],a=q(this.cardData,this.patToken,t,this.authorEmail?.split("@")[0]??"");if(this.isInboxIqAgentEnabled){X.log("BYOA:: Sending signal for inbox iq agent");const t={...(o=e,i=this.authorEmail,r=this.agentId,{queryId:(0,_.A)(),query:"",createAgent:{templateName:"SummarizeInbox",propValues:JSON.stringify({QUERY:o,USER_EMAIL:i})},agentId:r})};this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",m.cS.getTypeName()],items:[{id:Z.generateId(),body:new m.cS(t)}]}),workflowAnnotationType:y.MG.getTypeName()})}else{const t={...F(a,e,this.agentId)};this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",h.br.getTypeName()],items:[{id:Z.generateId(),body:new h.br(t)}]}),workflowAnnotationType:g.xj.getTypeName()})}var o,i,r;this.copilotChatRef.current?.startLoadingUi()}sendInitialSignal(){if(this.isInboxIqAgentEnabled){const e={...B("create Summarize Inbox agent")};this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",m.cS.getTypeName()],items:[{id:Z.generateId(),body:new m.cS(e)}]}),workflowAnnotationType:y.MG.getTypeName()}),this.copilotChatRef.current?.startLoadingUi()}const e={...B("create BYOA agent")};this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",h.br.getTypeName()],items:[{id:Z.generateId(),body:new h.br(e)}]}),workflowAnnotationType:g.xj.getTypeName()}),this.copilotChatRef.current?.startLoadingUi()}sendPPTIdeasSignal(e,t){const a={TASK_LIST:[{taskName:"create_deck_for_ideas",params:{query:e,receiver:[{displayName:this.authorName,mail:this.authorEmail}]}}],RECURRENCE:{frequency:i.Minute,interval:5},HEADERS:"header"};t||(a.CREATE_DECK_PAYLOAD=!0);const n={...F(JSON.stringify(a),"",this.agentId)};this.copilotChatRef.current?.submitOperation({operation:new p.g0({parentPath:["Signal",h.br.getTypeName()],items:[{id:Z.generateId(),body:new h.br(n)}]}),workflowAnnotationType:g.xj.getTypeName()})}}const te={themePrimary:"#598FEC",themeSecondary:"#8763c2",themeLight:"#0E336A",themeDark:"#464FEB",themeTertiary:"#598FEC",themeDarker:"#353696",themeMedium:"#464FEB",themeDarkAlt:"#3D91FF",themeLighterAlt:"#6CEBE2",themeLighter:"#9270FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondaryAlt:"#FFFFFF",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternaryAlt:"#FFFFFF",neutralDark:"#2461CA",black:"#FFFFFF",white:"#000000"},ae={themePrimary:"#185abd",themeSecondary:"#8763c2",themeLight:"#D2E0F4",themeDark:"#82ABF1",themeTertiary:"#598FEC",themeDarker:"#598FEC",themeMedium:"#82ABF1",themeDarkAlt:"#3D91FF",themeLighterAlt:"#6CEBE2",themeLighter:"#9270FF",neutralLighter:"#f5f5f5",neutralDark:"#1651AA",white:"#FFFFFF"};var ne=a(3858),oe=a(86303),ie=a(98904);class re extends oe.TextNode{static getType(){return"ciq-text-node"}static clone(e){return new re(e.__text,e.__key)}createDOM(e,t){const a=super.createDOM(e,t);return a.innerText=this.getTextContent(),a}}const se=(0,l.forwardRef)((function({onCiqTriggerDetection:e,showQueryCharInSelection:t},a){const[n]=(0,ie.useLexicalComposerContext)(),o=(0,l.useCallback)((e=>{n.getEditorState().read((()=>{const a=(0,oe.$getSelection)()?.getNodes(),o=a?.[a.length-1];n.update((()=>{const a=(n=`${t?"@":""}${e}`,new re(n)).setStyle("background: #DCDCDC; padding: 1px; border-radius: 5px;");var n;o?.insertAfter(a);const i=(0,oe.$createTextNode)(" ");a.insertAfter(i),i.select(1)}))}))}),[n,t]);return(0,l.useImperativeHandle)(a,(()=>({handleCIQSelection:o})),[o]),(0,l.useEffect)((()=>{n.registerNodeTransform(re,(e=>{e.isSelected()&&e.remove()}))}),[n]),(0,l.useEffect)((()=>n.registerNodeTransform(oe.TextNode,(t=>{if(!t.isSelected())return;if(t instanceof re)return;const a=t,n=a.getTextContent().trimEnd().indexOf("@")>-1;a.setTextContent(a.getTextContent().split("@").join("")),a.select(a.getTextContent().length),n&&e()}))),[n]),null}));var le=a(978),ue=a(50904),ce=a(30112),de=a(80617),pe=a(87144),ge=a(16895);const he={color:de.L.colorNeutralForeground4,alignItems:"flex-start",...pe.g.body1,fontStyle:"normal",...ge.Pt.gap("1px"),content:"attr(title)"},ye={color:de.L.colorNeutralForegroundDisabled,"@media (forced-colors: active)":{forcedColorAdjust:"none"}},me={...pe.g.body1,alignItems:"flex-start",fontStyle:"normal",...ge.Pt.gap("1px"),whiteSpace:"pre-wrap",display:"inline-block",width:"100%","&:focus":{...ge.Pt.outline(0)}},fe={userInput:{...me,"&:focus":{...ge.Pt.outline(0)},"&:focus::after":he,"&::after":he}},ke={userInput:{...me,"&:focus":{...ge.Pt.outline(0)}}},Ee={userInput:{"&:focus::after":ye,"&::after":ye}},Te=((0,H.n)(ke),(0,H.n)(fe)),Se=(0,H.n)(Ee),Ce="";var ve=a(58651);const Ae=e=>{const{isDisabled:t=!1,placeholderText:a=Ce,editorProps:n,onItemSelected:o,overrideStyles:i,startInMenuOpenState:r,queryCharToUse:s}=e,u=s??le.O8,c=l.useRef(),d=(0,l.useRef)(!0),[p,g]=l.useState(void 0),h=(0,l.useRef)(null),[y,m]=(0,l.useState)(void 0),[f,k]=(0,l.useState)(a),E=l.useCallback((()=>{if(!t&&n?.handleInChatInput&&n?.editorConfig&&!c.current&&n?.alSession){if(!d.current)return n?.editorConfig?.telemLogger?.logSuccessTelemetry("Editor_Bootstrap_Skipped","ShouldBootStrapEditor is false"),void ve.log("EditorBootstrapping is skipped as shouldBootStrapEditor is false");const t=(new ue.V).createInstance();d.current=!1,t.bootstrap((e=n.editorConfig,a=n.alSession,{...e,augloopSession:a})).then((e=>{c.current=t,g(e)}))}var e,a}),[n?.alSession,n?.handleInChatInput,n?.editorConfig,t]);(0,l.useEffect)((()=>{E()}),[E]),(0,l.useEffect)((()=>()=>{c.current&&(c.current.shutdown(),c.current=void 0,g(void 0),m(void 0),d.current=!0)}),[n?.alSession,n?.handleInChatInput,n?.editorConfig]),(0,l.useEffect)((()=>{if(n?.handleInChatInput&&n?.editorConfig&&!y&&p&&h.current){const t=p.initializeCiq(h.current,{menuTitle:n?.editorConfig.transformFileMenuTitle,menuSubtitle:n?.editorConfig.transformFilePlaceholderText?n?.editorConfig.transformFilePlaceholderText:Ce,queryCharToUse:u,getLocalItems:e.getLocalItems,onItemSelected:async e=>{ve.log(e),o&&o(e.suggestion),ve.log("Item Selected"),n.postCIQItemSelectionHandler&&n.postCIQItemSelectionHandler(e.suggestion)},entitiesEnabled:n?.editorConfig.entitiesSupported,ExpanededECC:n?.editorConfig.isExpandedECCEnabled});m(t)}}),[p,y]);const T=(0,l.useRef)(Se()),S=(0,l.useRef)(Te()),[C,v]=(0,l.useState)(S.current.userInput);(0,l.useEffect)((()=>{t&&v((0,ce.z)(S.current.userInput,T.current.userInput))}),[t]),(0,l.useEffect)((()=>{const e=h.current;r&&p&&e&&y&&(e.innerText=u,e.focus(),e.lastChild?window.getSelection().setPosition(e.lastChild,e.lastChild.textContent.length):e.firstChild&&window.getSelection().setPosition(e.firstChild,e.firstChild.textContent.length),p.forceInvokeCIQMenu(u))}),[h.current,r,p,y]);return l.createElement("span",{className:C,title:f,ref:h,contentEditable:!0,onInput:e=>{e.target.textContent===Ce?k(a):e.target.textContent.length>0&&f!==Ce&&k(Ce)},style:i})};var Ie=a(58651);const Pe=e=>({settings:R,telemLogger:{logError:e=>{Ie.log("Shared Copilot CIQ Error Log: ",e)},logSuccessTelemetry:(e,t)=>{Ie.log("Shared Copilot CIQ Success Log: ",e,t)}},entitiesSupported:e,isExpandedECCEnabled:!1}),De=(e,t,a,n,o)=>[(0,l.useCallback)(((a,i)=>e?l.createElement(Ae,{editorProps:{editorConfig:Pe(t),alSession:e,handleInChatInput:!0},placeholderText:"Select your skill",getLocalItems:o,onItemSelected:e=>{n(e)},overrideStyles:{position:"absolute",top:`${a}px`,left:`${i}px`,maxWidth:"200px",zIndex:"1000"},startInMenuOpenState:!0,queryCharToUse:"@"}):null),[e,n,a,t])];function be(e,t,a,n){const i=(0,l.useRef)(),r=(0,l.useRef)(null),s=(0,l.useRef)(null),[u,c]=(0,l.useState)(!1),[d,p]=(0,l.useState)([]),[g,h]=(0,l.useState)(o.Skill),[y,m]=l.useState(),[f,k]=(0,l.useState)(),E=(0,l.useMemo)((()=>new Map(y?.map((e=>[e.name,e])))),[y]),T=(0,l.useMemo)((()=>new Map(f?.queries.myQueries.concat(f?.queries.sharedQueries).map((e=>[e.name,e])))),[f]),[S]=De(t,[A.ck.People],g,(e=>{if(d.length!==L.length){if(d.length<L.length){if(-1===L.indexOf(g))throw new Error("Invalid CIQValueType. ciqValueType must be present in ciqpValueTypeOrder array.");if(h(L[L.indexOf(g)+1]),g!==o.Project&&g!==o.Query){const t=w[e.text];p([...d,t])}else if(g===o.Project){const t=E.get(e.text);k(t);const a=U("PROJECT",t?.id);p([...d,a])}else if(g===o.Query){const t=T.get(e.text),a=U("QUERY",t?.id);p([...d,a])}}r.current?.handleCIQSelection(e.text),c(!1)}}),(()=>j(g,y,f))),C=(0,l.useCallback)(((t,o)=>{const p=l.createElement(se,{ref:r,onCiqTriggerDetection:()=>{c(!0)},showQueryCharInSelection:n});o.plugins=[...o.plugins||[],p],o.customNodes=[...o.customNodes||[],re],o.handleSubmitButtonClick=(e,t)=>{a.sendUISyncSignalForCiqSelections(d,e)};return l.createElement("div",{ref:s},e((e=>{t.current=e,i.current=e}),o),(()=>{if(!u||!S)return null;const e=(()=>{const e=window.getSelection()?.getRangeAt(0).getBoundingClientRect();return e})(),t=(()=>{const e=s.current?.offsetParent?.getBoundingClientRect();return e})(),a=e?.top?e.top-(t.top??0):0,n=e?.left?e.left-(t.left??0):0;return S(a,n)})())}),[g,L,d,h,u,e,n,S,y]);return(0,l.useEffect)((()=>{m(a.getProjectSuggestions())}),[a.getProjectSuggestions()]),C}var xe=a(58651);const Ne=({session:e,isTestApp:t=!1,patToken:a,authorName:n,authorEmail:o,isDarkModeEnabled:i=!1,isHighContrastModeEnabled:u=!1,featureFlags:c,isInboxIqAgentEnabled:d,applyPPTIdeasODSL:p})=>{const g=l.useRef(null),[h,y]=l.useState(I),[m,f]=l.useState(!0),k=ee.getInstance(g,e,f,a,o,n,d,c.isIdeasToPPTEnabled);k.setCallbacks((async e=>{xe.log("BYOA:: applyPPTIdeasODSLCallback: ",e),p&&await p(e)}));const E=((e,t)=>({isDarkModeEnabled:e,isHighContrastModeEnabled:t,...e?te:ae}))(i,u),T=function(e,t,a){return be(((e,t)=>l.createElement(ne.A,{ref:e,...t})),e,t,a)}(e,k,c?.showCiqSelectionWithQueryChar);return l.createElement(r.zn,{style:$(),platformType:s.Y.web,chatUiProps:{chatInputV2Props:{pluginsInfo:[],chatPlaceholderMessage:"Type a message for Byoa Agent",isVersion3Enabled:!0},changeTopicUiProps:{hideChangeTopicButton:!0},zeroQueryMessageV2Props:{promptSuggestionList:d?[{suggestionCategory:P,suggestionText:Q(M()),iconRegular:()=>null,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!0,notifyClientOnZQMClicked:e=>{y(e.suggestionCategory),f(!1)}}]:[{suggestionCategory:I,suggestionText:Q(x()),iconRegular:()=>null,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!0,notifyClientOnZQMClicked:e=>{y(e.suggestionCategory),f(!1)}},{suggestionCategory:D,suggestionText:"Give instructions on how you want your PPT created or mail it as a headless presentation",iconRegular:()=>null,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!0,notifyClientOnZQMClicked:e=>{y(e.suggestionCategory),f(!1)}}]}},copilotCommunicationHandler:k,useALRuntime:!!t,ref:g,overrideChatInputControl:m?(e=>{if(e?.isCiqChatInputEnabled)return T})(c):()=>k.getAgentCardData(h),theme:E})}}}]);
//# sourceMappingURL=vendors~BYOA.js.map